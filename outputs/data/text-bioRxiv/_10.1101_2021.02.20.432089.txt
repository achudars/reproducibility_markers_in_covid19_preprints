bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

A Multiscale Multicellular Spatiotemporal Model of Local Influenza Infection and Immune
Response
T.J. Sego1*, Ericka D. Mochan2, G. Bard Ermentrout3, James A. Glazier1
1

Department of Intelligent Systems Engineering, Indiana University, Bloomington, IN, USA

2

Department of Analytical, Physical, and Social Sciences, Carlow University, Pittsburgh, PA,
USA
3

Department of Mathematics, University of Pittsburgh, Pittsburgh, PA, USA
*

tjsego@iu.edu

Abstract
Respiratory viral infections pose a serious public health concern, from mild seasonal influenza to
pandemics like those of SARS-CoV-2. Spatiotemporal dynamics of viral infection impact nearly
all aspects of the progression of a viral infection, like the dependence of viral replication rates on
the type of cell and pathogen, the strength of the immune response and localization of infection.
Mathematical modeling is often used to describe respiratory viral infections and the immune
response to them using ordinary differential equation (ODE) models. However, ODE models
neglect spatially-resolved biophysical mechanisms like lesion shape and the details of viral
transport, and so cannot model spatial effects of a viral infection and immune response. In this
work, we develop a multiscale, multicellular spatiotemporal model of influenza infection and
immune response by combining non-spatial ODE modeling and spatial, cell-based modeling. We
employ cellularization, a recently developed method for generating spatial, cell-based, stochastic
models from non-spatial ODE models, to generate much of our model from a calibrated ODE
model that describes infection, death and recovery of susceptible cells and innate and adaptive
responses during influenza infection, and develop models of cell migration and other mechanisms
not explicitly described by the ODE model. We determine new model parameters to generate
agreement between the spatial and original ODE models under certain conditions, where
simulation replicas using our model serve as microconfigurations of the ODE model, and compare
results between the models to investigate the nature of viral exposure and impact of heterogeneous
infection on the time-evolution of the viral infection. We found that using spatially homogeneous
initial exposure conditions consistently with those employed during calibration of the ODE model
generates far less severe infection, and that local exposure to virus must be multiple orders of
magnitude greater than a uniformly applied exposure to all available susceptible cells. This
strongly suggests a prominent role of localization of exposure in influenza A infection. We propose
that the particularities of the microenvironment to which a virus is introduced plays a dominant
role in disease onset and progression, and that spatially resolved models like ours may be important
to better understand and more reliably predict future health states based on susceptibility of
potential lesion sites using spatially resolved patient data of the state of an infection. We can
readily integrate the immune response components of our model into other modeling and
simulation frameworks of viral infection dynamics that do detailed modeling of other mechanisms

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

like viral internalization and intracellular viral replication dynamics, which are not explicitly
represented in the ODE model. We can also combine our model with available experimental data
and modeling of exposure scenarios and spatiotemporal aspects of mechanisms like mucociliary
clearance that are only implicitly described by the ODE model, which would significantly improve
the ability of our model to present spatially resolved predictions about the progression of influenza
infection and immune response.
Introduction
Respiratory viral infections continue to be a serious public health concern, from mild seasonal
influenza strains to the highly pathogenic SARS-CoV-2 pandemic. In recent influenza strains
associated with highly pathogenic outcomes, excess inflammation and cytokine storm tend to be
major causes of mortality (1). Similarly, the recent COVID-19 epidemic has shown this
coronavirus induces a similar cytokine storm in many of the lethal infections (2). A deeper
understanding of the mechanisms involved in the initiation, proliferation, and reduction of the
inflammatory response is key to understanding the reasons why some infections can become lethal.
Spatiotemporal dynamics impact nearly all components of the resolution of a viral infection
both in vitro and in vivo. Viral replication rates, for example, depend on the type of cell the virus
has invaded, the family and strain of the virus, and the strength of the immune response deployed
against the pathogen. Viruses have been theorized to differ in replication rates between mucosal
and bronchial epithelial cells (3). In addition, some viruses have been shown to localize to certain
areas of the lungs rather than spread homogeneously throughout the respiratory tract. For instance,
the 2009 pandemic H1N1 strain has been shown to replicate more extensively throughout the lower
respiratory tract than either seasonal H1N1 or H5N1 (4). Seasonal H1N1 and H3N2 tend to
replicate primarily in the bronchi, while H5N1 replicates largely in alveoli (5). In addition to these
spatial differences, temporal differences in viral replication rates also play a part in differing levels
of pathogenicity between viral strains. Multiple experimental studies have shown that strains
exhibit distinct rates and mechanisms for cell entry, replication, and evasion of immune responses,
allowing certain strains to be more virulent than others (5‚Äì8). The immune response to viral
infection also includes many spatially-resolved biological processes, many of which are poorly
understood, such as the search strategies of CD4+ and CD8+ T cells leading to antigen recognition,
memory and effector T cell differentiation, migration via chemokinesis, chemotaxis and
haptotaxis, and cytotoxic killing of infected cells (9). Heterogeneous spread of virus and infected
cells has been theorized to affect the spread of infection through the lung; clusters of dead cells
near productively-infected cells may prevent the virus from spreading (10). This effect has been
seen after lethal H5N1 infection in ferrets (5); excessive damage in the lower respiratory tract
prevents the virus from spreading further through the lung and limits the peak of the viral load.
Thus, characterizing the spatial spread of the virus through the lung is critical to understanding the
intrahost immune response to the infection.
Mathematical modeling has long been used to explore various details of the immune
response to respiratory viral infections using ordinary differential equation (ODE) models (11‚Äì
14). However, spatial effects cannot be explored in a typical ODE model, as these models are
founded on a well-mixed assumption that neglects spatially resolved biophysical mechanisms
2

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

(e.g., lesion shape). Spatial models of the immune response have been developed in recent years
to explore the effects of the spatial distribution of immune components on the resolution of
infection (10,15‚Äì21). However, to our knowledge, no spatial model exists that describes hostpathogen interactions during influenza infection with cellular resolution while considering detailed
descriptions of local and systemic aspects of both the innate and adaptive immune responses.
In this work, we combine the approaches of non-spatial ODE modeling and spatial, cellbased modeling to develop a multiscale, multicellular model of influenza infection and immune
response. We generate much of our spatial model from a calibrated ODE model that describes
infection, death and recovery of susceptible cells and innate and adaptive responses during
influenza infection (14) using cellularization (22), a recently developed method for generating
spatial, cell-based models from non-spatial ODE models. We develop models of cell migration
and other mechanisms not explicitly described by the ODE model, and determine new model
parameters to generate agreement between the spatial and original ODE models under certain
conditions. We compare results between the models to investigate the nature of viral exposure and
impact of heterogeneous infection on the time-evolution of the viral infection.
Models and Methods
The ODE model of in-host response to influenza A virus from which the spatial model is generated
describes infection and death of susceptible epithelial cells, and inflammatory, innate, adaptive
and humoral responses. Population dynamics consist of explicit expressions for uninfected,
infected and dead epithelial cells (ùêª, ùêº and ùê∑), macrophages (ùëÄ), neutrophils in the blood and
ÃÉ and ùëÅ), antigen presenting cells (APCs, ùëÉ), natural killer (NK) cells (ùêæ), B cells
infected tissue (ùëÅ
(ùêµ), and CD4+ and CD8+ T cells (ùëÇ and ùê∏, respectively). Soluble signals of the model consist of
tumor necrosis factor (TNF, ùëá), interleukins 10 and 12 (IL-10 and IL-12, ùêø and ùëä, respectively),
types I and II interferon (IFN, ùêπ and ùê∫, respectively), and generic chemokines (ùê∂), antibodies (ùê¥)
and reactive oxygen species (ROS, ùëã). We employ the method of cellularization (22) to generate
a multiscale, multicellular, spatiotemporal model of local influenza A infection and immune
response in an epithelial sheet. For details of the complete ODE model and cellularized spatial
model, see Appendix 1 in Supplementary Materials.
Cellularization describes the relationships of measurements of quantity at various scales of
a biological system under well-mixed conditions. For a scalar quantity ùëç of a species at one scale,
a scalar quantity ùëß of the same species at another scale, and a field distribution ùëßÃÉ = ùëßÃÉ (ùë•ùëñ , ùë°) of
which ùëß measures, according to cellularization,
ùëç=

1
1
ùëß = lim ùëßÃÉ ,
ùúÇ
ùúÉ ùê∑ùëç‚Üí‚àû

where ùúÇ and ùúÉ are global and local scaling coefficients, respectively, and ùê∑ùëç is the diffusion
coefficient of ùëßÃÉ for diffusive species. For diffusive species, ùëß is the volume integral of ùëßÃÉ over a
spatial domain, while for discrete objects of a particular type ùëß is the number of instances of the
type of object (e.g., the number of neutrophils). Reaction-diffusion equations for locally
heterogeneous soluble signals are generated from non-spatial descriptions. For a rate equation ùëçÃá =
3

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

ùë£(ùëå, ùëç) + ùë§(ùëå, ùëç)ùëÑ for chemical species ùëå and ùëç and number ùëÑ of a cell type ùëÑÃÇ , the analogous
reaction-diffusion equation for ùëßÃÉ is
‚Ñ¨(ùúè(ùúé, ùë°), ùëÑÃÇ )
ùë¶ÃÖ ùëßÃÖ
ùë¶ÃÉ ùëßÃÉ
ùë§ ( , ).
ùúïùë° ùëßÃÉ = ùúïùëó (ùê∑ùëç ùúïùëó ùëßÃÉ ) + ùúÉùë£ ( , ) +
‚Äñùí±‚Äñ
ùúÉ ùúÉ
ùúÉ ùúÉ
Here ùë¶ÃÉ is the heterogeneous distribution associated with ùëå, ùë¶ÃÖ = ùë¶ÃÖ(ùë†, ùë°) and ùëßÃÖ = ùëßÃÖ(ùë†, ùë°) are the
average value of ùë¶ÃÉ and ùëßÃÉ , respectively, over the domain ùí± = ùí±(ùë†, ùë°) of cell ùë† with type ùúè(ùë†, ùë°),
ùúé = ùúé(ùë•ùëñ , ùë°) = ùë† at every site ùë•ùëñ occupied by cell ùë† at time ùë° (i.e., ùí±(ùë†, ùë°) = {ùë•ùëñ ‚à∂ ùúé(ùë•ùëñ , ùë°) = ùë†}),
and ‚Ñ¨(ùë•, ùë¶) is a Boolean-valued function equal to one when ùë• = ùë¶ and otherwise equal to zero.
Cellularization formulates cell-based stochastic dynamics using the Poisson cumulative
distribution function from reaction kinetics that describe the inflow, outflow, and transitions by
type (e.g., from alive to dead) of cell populations. For a number of cells ùëÑ of cell type ùëÑÃÇ with mean
inflow rate ùëì, mean outflow rate ùëîùëÑ, and mean transition rate ùë¢ùëÑ to cell type ùëÜÃÇ (i.e., ùëÑÃá = ùëì ‚àí
ùëîùëÑ ‚àí ùë¢ùëÑ and ùëÜÃá = ùë¢ùëÜ for ùëÜ cells of type ùëÜÃÇ) over a period [ùë°, ùë° + ‚àÜùë°),
Pr(add ùêΩ ùëÑÃÇ ‚àí type cells) = 1 ‚àí ùëí ‚àíùëì‚àÜùë° ‚àë
0‚â§ùëó‚â§ùêΩ

(ùëì‚àÜùë°)ùëó
,
ùëó!

Pr(remove ùë†|ùúè(ùë†) = ùëÑÃÇ ) = 1 ‚àí ùëí ‚àíùëî‚àÜùë° ,
Pr(ùúè(ùë†, ùë° + ‚àÜùë°) = ùëÜÃÇ|ùúè(ùë†, ùë°) = ùëÑÃÇ) = 1 ‚àí ùëí ‚àíùë¢‚àÜùë° .
Local cell populations can be modeled such that a fraction of the population is explicitly modeled
in a spatial domain, and the rest of the population act homogeneously. Cellularization describes
the cell-based stochastic dynamics of a contact-mediated process with mean rate ùëü (i.e., ùëÜÃá = ‚àíùëüùëÑùëÜ
for ùëÑ and ùëÜ cells of types ùëÑÃÇ and ùëÜÃÇ, respectively) using an equipollent rate ùõæ for cell ùë† in an
aggregate with total available contact surface area ùê¥ùëà . If a process for a cell with total available
contact surface area ùê¥ùë† is mediated by contact with a cell of type ùëÑÃÇ with total available contact
surface area ùê¥ùëÑÃÇ , then for contact area ùê¥ùë†,ùëÑÃÇ of cell ùë† with a ùëÑÃÇ ‚àí type cell,
ùõæ(ùë†; ùëü, ùëÑÃÇ , ùê¥ùëà ) =

ùëüùê¥ùëà
ùê¥ ÃÇ.
ùê¥ùë† ùê¥ùëÑÃÇ ùë†,ùëÑ

Overview of Model Setup, Spatiotemporal Scaling and Cellularization
The milieu of the spatial, cell-based model is constructed by adapting an ODE model of influenza
A infection and immune response (14) to comparable work on multiscale, spatial, cell-based
modeling of viral infection and immune response (21) using cellularization. We consider a quasitwo-dimensional spatial domain in which local infection occurs in a fixed planar sheet of epithelial
cells. Recruitment of various immune cell populations is governed by organismal-level dynamics
coupled with signaling from within the spatial domain, where motile, locally acting immune cells
are recruited from outside the spatial domain and placed on top of the epithelial sheet. Likewise
organismal-level soluble signals are coupled with locally heterogeneous distributions of diffusive
4

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

species in the spatial domain. We refer to model objects whose dynamics are explicitly modeled
in the spatial domain as local, and likewise to those modeled with an ODE as global.
To model the spatial effects of infection, we model extracellular virus and uninfected,
infected and dead cells as local (Figure 1). Type I IFN is modeled as local to model the spatial
effects of antiviral resistance. Macrophages, chemokines and IL-10 are modeled as local to model
the spatial effects of macrophage migration and diffusion in local inflammatory signaling.
Likewise, NK and CD8+ T cells are modeled as local to model the effects of contact-mediated
killing of infected cells in the immune response. B cells and blood neutrophils are not present at
the local site of infection, and so are modeled as global. APCs primarily recruit other immune cell
types according to the ODE model, and so we neglect the spatial aspects of their type I IFN release
and model them as global. It follows that type II IFN, IL-12 and CD4+ T cells are modeled as
global, since they immediately affect global objects. Antibodies, ROS and TNF could reasonably
be modeled as local, however we assume that their rates of diffusion are sufficiently fast to
approximate them as uniform throughout the simulation domain and model them as global. It
follows that tissue neutrophils are modeled as global, since they release global ROS.

Figure 1. Schematic of the cellularizatized model of influenza infection and immune response. Model objects inside the dashed
box labeled ‚ÄúSpatial domain‚Äù are modeled explicitly in the spatial domain, which are shown with dashed boundaries, whereas
other model objects are treated as homogeneously acting due to their absence in the spatial domain (e.g., blood neutrophils) or
their spatial properties (e.g., highly diffusive ROS) and are shown in solid borders. Analogous spatial and cell-based models of
processes within, and across the boundary of, the spatial domain are derived from the ODE model using cellularization.

5

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

To model migration of local immune cells, we use the Cellular Potts model (CPM, or
Glazier-Graner-Hogeweg model). The CPM is a lattice-based hybrid kinetic Monte Carlo method
that represents generalized cells and medium as discrete, deformable, volume-excluding objects
(23). Cell motility in the CPM is modeled as the stochastic exchanging of lattice sites by cells and
medium according to minimization of a system effective energy ‚Ñã, in this work written as,
‚Ñã = ‚àë ùúÜùë£ (‚Äñùí±(ùë†, ùë°)‚Äñ ‚àí ùë£ùëê (ùúè(ùë†, ùë°)))

2

ùë†

+ ‚àë

‚àë

(1 ‚àí ‚Ñ¨(ùúé(ùë¶ùëñ , ùë°), ùúé(ùë¶ùëñ‚Ä≤ , ùë°))) ùêΩ(ùúè(ùúé(ùë¶ùëñ , ùë°), ùë°), ùúè(ùúé(ùë¶ùëñ‚Ä≤ , ùë°), ùë°))

ùë¶ùëñ ‚ààùí∞ ùë¶ùëñ‚Ä≤ ‚ààùí©(ùë¶ùëñ )

+ ‚àë‚àë
ùë¶ùëñ ‚ààùí∞ ùëê

ùúÜùëê (ùúè(ùúé(ùë¶ùëñ , ùë°), ùë°))ùëê(ùë¶ùëñ , ùë°)
.
1 + ùëêùê∂ùëÄ (ùúé(ùë¶ùëñ , ùë°), ùë°)

The first term implements a volume constraint ùë£ùëê in each cell by cell type, the second term models
adhesion at intercellular and cell-medium interfaces by cell type according to contact coefficients
ùêΩ using a neighborhood ùí©(ùë•ùëñ ) of each site, and the third term models logarithmic chemotaxis by
cell type and field distribution according to a chemotaxis parameter ùúÜùëê , local field concentration ùëê
and center-of-mass measurement ùëêùê∂ùëÄ of ùëê. In this work we use a second-order Manhattan
neighborhood for adhesion calculations, while applications of adhesion and chemotaxis modeling
are described in the following section. In general, the CPM randomly selects a pair of neighboring
lattice sites and considers whether the identification at one of the sites copies itself to the other
site, called a copy attempt, which occurs with a probability according to a Boltzmann acceptance
function,
Pr(ùúé(ùë¶ùëñ , ùë°) ‚Üí ùúé(ùë¶ùëñ‚Ä≤ , ùë°)) = ùëí

‚àí max{0,

‚àÜ‚Ñã
}
‚Ñã‚àó .

Here ùúé(ùë¶ùëñ , ùë°) ‚Üí ùúé(ùë¶ùëñ‚Ä≤ , ùë°) denotes the copy attempt where the identification at ùë¶ùëñ‚Ä≤ copies to ùë¶ùëñ , ‚Ñã ‚àó
is the intrinsic random motility that affects the stochasticity of copy attempts, and ‚àÜ‚Ñã is the change
in ‚Ñã due to the copy. One simulation step, called a Monte Carlo step (MCS), consists of having
considered a number of copy attempts equal to the total number of lattice sites.
Particularities of the Cellularization
The ODE model defines a viral resistance ùëÖ of the epithelial cell population due to the presence
of type I IFN. Viral resistance affects a number of uninfected and infected cell behaviors, including
decreased viral release and tissue recovery. Using cellularization, a cell-based viral resistance ùúå =
ùúå(ùë†, ùë°) of each cell ùë† with mean value of type I IFN in its domain ùëì ÃÖ = ùëì(ÃÖ ùë†, ùë°) takes the form,
ùúå = 1 ‚àí ùúå‚Ä≤ =

ùëìÃÖ

.
ùúÉùëéùëüùëì + ùëì ÃÖ

Here ùëéùëüùëì is a model parameter of the ODE model.

6

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

Diffusive transport is assumed to occur in a homogeneous medium, where for extracellular
virus, chemokines, IL-10 and type I IFN we define the diffusion coefficients ùê∑ùëâ , ùê∑ùê∂ , ùê∑ùêø and ùê∑ùêπ ,
respectively. The spatial model describes spatial and cell-based analogues of all mechanisms
described by the ODE model for each heterogeneous species using partial differential equations
(PDEs) of diffusive transport. Diffusive transport modeling of the extracellular virus ùë£ÃÉ includes
general decay, decay by the action of antibodies, mucociliary clearance, uptake by uninfected cells
and release by infected cells; of chemokines ùëêÃÉ includes general decay, and release by macrophages
regulated by TNF and the presence of dead cells; of IL-10 ùëôÃÉ includes general decay, release by
macrophages regulated by TNF and the presence of dead cells, and release by uninfected cells; of
type I IFN ùëìÃÉ includes general decay, release by APCs, and release and uptake by infected cells
(Table 1).
Table 1. PDEs generated from cellularization of the influenza ODE model for virus ùë£ÃÉ, type I IFN ùëìÃÉ, chemokines ùëêÃÉ and IL-10 ùëôÃÉ
according to a general form for reaction-diffusion transport with diffusion coefficient. All symbols with subscripts are parameters
from the ODE model. ùúÇ and ùúÉ are the global and local scaling coefficients, respectively, according to cellularization. ‚Ñ¨(ùë•, ùë¶) is a
binary function equal to one when ùë• = ùë¶ and zero otherwise. ‚Äñùí±(ùúé, ùë°)‚Äñ is the volume of a cell ùúé = ùúé(ùë•ùëñ , ùë°) at ùë•ùëñ and time ùë° with
ÃÇ , infected ùêºÃÇ, macrophage ùëÄ
ÃÇ ). ùëé, ùëë, ùëù and ùëá ‚àó are the total antibodies, dead cells, APCs and TNF in
type ùúè(ùúé, ùë°) (e.g., uninfected ùêª
the spatial domain. ùëßÃÖ is a mean cellular measurement of ùëßÃÉ .

General form
Field
Virus ùë£ÃÉ
Type I IFN ùëìÃÉ
Chemokines ùëêÃÉ

ùúïùë° ùëßÃÉ = (ùê∑ùëç ùúïùëñ2 ‚àí ùëû)ùëßÃÉ + ùëü
Decay rate ùëû
ÃÇ )ùëîùë£‚Ñé
ùëîùë£ùëé ùëé
ùúÉùëîùë£
‚Ñ¨(ùúè(ùúé, ùë°), ùêª
ùúáùë£ +
+
+
ùúÇ
ùëéùë£ ùë£ÃÉ + ùúÉ
ùúÉ‚Äñùí±‚Äñ
‚Ñ¨(ùúè(ùúé, ùë°), ùêºÃÇ)ùëîùëìùëñ
ùúáùëì +
ùúÉ‚Äñùí±‚Äñ
ùúáùëê
ùúáùëô

IL-10 ùëôÃÉ
Auxiliary
forms

ùúÅ = 1+

ùúÇ(ùëî1 ùëô ÃÖ + ùúÉùëî2 )
(ùëé11 ùëá ‚àó + ùëé12 ùëë)(ùëô ÃÖ + ùúÉùëë2 )

Source rate ùëü
‚Ñ¨(ùúè(ùúé, ùë°), ùêºÃÇ)ùëîùë£ùëñ ùúå‚Ä≤
‚Äñùí±‚Äñ
ùúÉùëèùëìùëù ùëù ‚Ñ¨(ùúè(ùúé, ùë°), ùêºÃÇ)ùëèùëìùëñ ùúå‚Ä≤
+
‚Äñùí±‚Äñ
ùúÇ
ÃÇ )ùëèùëê
‚Ñ¨(ùúè(ùúé, ùë°), ùëÄ
‚Äñùí±‚ÄñùúÅ
ÃÇ )ùëèùëô
1 ‚Ñ¨(ùúè(ùúé, ùë°), ùëÄ
ÃÇ )ùúáùëô ùëèùëô‚Ñé ùúå‚Ä≤ )
(
+ ‚Ñ¨(ùúè(ùúé, ùë°), ùêª
‚Äñùí±‚Äñ
ùúÅ
1
ùëßÃÖ =
‚à´
ùëßÃÉ ùëëùëâ
‚Äñùí±(ùúé, ùë°)‚Äñ ùí±(ùúé,ùë°)

The ODE model employs the Allee effect with a critical population of uninfected cells,
above which recovery of uninfected cells occurs, and below which additional death of uninfected
cells occur. We cellularize this mechanism by splitting it into individual stochastic events, of which
a mean rate of death ùëéùê∑ (ùë†) due to the Allee effect is considered for each uninfected cell, and a
mean rate of recovering a dead cell ùëéùêª (ùë†) is considered. The process of cell recovery is
implemented as the transitioning of a dead cell to an uninfected cells (21). By treating both
mechanisms of the Allee effect as contact-mediated and applying the well-mixed conditions (see
Appendix 1 in Supplementary Materials for derivations),
ùëè‚Ñé ùúå‚Ä≤ (ùë†)
ùëè ùúå‚Ä≤ (ùë†)
ùê¥‚àó
ÃÇ , ùêª0 ùê¥ùë† ) max {ùõæ (ùë†; ‚àö ‚Ñé
ÃÇ , ùêª0 ùê¥ùë† ) ‚àí ‚àöùëè‚Ñé ùêª0 ùúå‚Ä≤ (ùë†) ùêª , 0},
ùëéùêª (ùë†) = ùõæ (ùë†; ‚àö
,ùêª
,ùêª
ùêª0
ùêª0
ùê¥ùë†

7

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

ùëéùê∑ (ùë†) = ùõæ (ùë†; ‚àö

ùëè‚Ñé ùúå‚Ä≤ (ùë†)
ùê¥‚àó
ùëè ùúå‚Ä≤ (ùë†)
ÃÇ , ùêª0 ùê¥ùë† ) max {‚àöùëè‚Ñé ùêª0 ùúå‚Ä≤ (ùë†) ùêª ‚àí ùõæ (ùë†; ‚àö ‚Ñé
ÃÇ , ùêª0 ùê¥ùë† ) , 0}.
,ùê∑
,ùêª
ùêª0
ùê¥ùë†
ùêª0

Here ùëè‚Ñé is an ODE model parameter, ùêª0 is the total number of epithelial cells according to the
ODE model parameters and ùê¥‚àóùêª is a critical contact area with uninfected cells derived from the
critical population value above which dead cells can recover, and below which uninfected cells
can die. Using these forms and the cellularization of the remaining ODE model, the stochastic
dynamics of the epithelial sheet occur according to the forms shown in Table 2, including infection
of uninfected cells by extracellular virus, death of uninfected cells by ROS and the Allee effect,
death of infected cells by ROS, contact-mediated killing by NK and CD8+ T cells, recovery of
dead cells by the Allee effect and recruitment of local macrophages and NK and CD8+ T cells.
Each type transition is considered once per simulation step for each cell in simulation, in the order
of dead cells, infected cells, uninfected cells.
Table 2. Stochastic dynamics of the epithelial sheet generated from cellularization of the influenza ODE model for epithelial cells
ÃÇ , infected ùêºÃÇ and dead ùê∑
ÃÇ types and immune cells of macrophage ùëÄ
ÃÇ , NK cell ùêæ
ÃÇ and CD8+ T cell ùê∏ÃÇ types. The transition
of uninfected ùêª
from type ùëåÃÇ to type ùëçÃÇ is denoted ùëåÃÇ ‚Üí ùëçÃÇ. All symbols with subscripts are parameters from the ODE model. Mean cellular
measurement of extracellular virus ùë£ÃÖ is calculated according to the form described in Table 1. ùëê, ùëù and ùë• are the total chemokines,
APCs and ROS in the spatial domain, and ùúå(ùë†) = 1 ‚àí ùúå‚Ä≤ (ùë†) is the resistance of cell ùë†.

Type transition

Transition rate
ùëî‚Ñéùë£ ùë£ÃÖ
ùúÉ
ùëî‚Ñéùë• ùë• ‚Ñéùë•
+ ùëéùê∑
ùë• ‚Ñéùë• + (ùúÇùëé‚Ñéùë• )‚Ñéùë•

ÃÇ ‚Üí ùêºÃÇ
Infection ùêª
ÃÇ‚Üíùê∑
ÃÇ
Uninfected death ùêª
ÃÇ
Infected death ùêºÃÇ ‚Üí ùê∑
ÃÇ‚Üíùêª
ÃÇ
Recovery ùê∑
Local immune type
ÃÇ
Macrophage ùëÄ
ÃÇ
NK cell ùêæ

ùëîùëñùë• ùë• ‚Ñéùë•
ÃÇ , ùêª0 ùê¥ùë† ) + ùõæ(ùë†; ùëîùêºùëí ùúå, ùê∏ÃÇ , ùêª0 ùê¥ùë† ) + ùúáùëñ ùúå‚Ä≤
+ ùõæ(ùë†; ùëîùëñùëò ùúå, ùêæ
ùë• ‚Ñéùë• + (ùúÇùëéùëñùë• )‚Ñéùë•
ùëéùêª
Inflow rate
Outflow rate
ùúáùëö
ùëèùëöùëê ùëê ‚Ñéùëö
ùúÇ( ‚Ñé
+ ùëèùëö ùúáùëö )
ùëê ùëö + (ùúÇùëéùëöùëê )‚Ñéùëö
ùëîùëòùëñ
ùëèùëòùëê ùëê ‚Ñéùëò
ùúáùëò +
‚àë
ùúå(ùë†)
ùúÇ( ‚Ñé
+ ùúáùëò ùëèùëò )
ùúÇ
‚Ñé
ùëê ùëò + (ùúÇùëé ) ùëò
‚Ä≤
ùë†‚àà{ùë† ‚à∂ùúè(ùë†,ùë°)=ùêºÃÇ}

ùëòùëê

CD8+ T cell ùê∏ÃÇ

ùúÇùëèùëíùëù ùëù
ùëù‚Ñéùëí

‚Ñéùëí
‚Ñéùëí

+ (ùúÇùëéùëíùëù )

ùëèùëíùëñ
ùúáùëí +
ùúÇ

‚àë

ùúå(ùë†)

ùë†‚àà{ùë† ‚Ä≤ ‚à∂ùúè(ùë† ‚Ä≤ ,ùë°)=ùêºÃÇ}

Additional Spatial Mechanisms
Beyond the cell-based models that can be generated from the ODE model using cellularization,
the ODE model implicitly describes spatiotemporal aspects of influenza A infection and immune
response that we can infer, impose or propose using additional data, assumptions and hypotheses.
For the simplest case, employing the CPM requires imposing a volume constraint on each cell, the
quantities, but not geometries, of which the ODE model describes. As such, we impose an
approximate cell diameter of 10 ¬µm on all cells according to the typical size of epithelial cells and
simplification of negligible differences in typical volume among cell types (Table 3).

8

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

Table 3. Model parameters of spatial mechanisms used for all simulation.
Parameter
Value
100 ¬µm2
Volume constraint ùë£ùëê
9
Volume multiplier ùúÜùë£
Diffusion coefficients
Extracellular virus
0.0119 ¬µm2 s-1
Chemokines
1.04 ¬µm2 s-1
Type I IFN
0.520 ¬µm2 s-1
Interleukin-10
0.327 ¬µm2 s-1
Chemotaxis parameters ùúÜùëê
Macrophage ‚Äì virus
5,000
NK ‚Äì chemokines
5,000
CD8+ T ‚Äì chemokines
10,000
Adhesion parameters ùêΩ
Uninfected ‚Äì immune
20
Infected ‚Äì immune
10
Dead ‚Äì immune
20
Homotypic immune
25
Heterotypic immune
10

Source/Justification
Chosen for an average cell diameter of 10 ¬µm
(21)
Chosen for a diffusion length of 5 cell diameters (21)
Chosen for a diffusion length of 10 cell diameters (21)
Chosen for a diffusion length of 2 cell diameters for short-range anti-viral signaling
Chosen for a diffusion length equal to that of chemokines
Chosen for strong chemotaxis according to typical field values
Chosen for moderate chemotaxis according to typical field values
Chosen for strong chemotaxis according to typical field values
Chosen for preferential attachment to infected cells
Chosen for preferential attachment to infected cells
Chosen for preferential attachment to infected cells
Chosen to prevent aggregation of immune cells
Chosen to prevent aggregation of immune cells

The ODE model describes the killing of infected cells proportionally to the number of NK
and CD8+ T cells. In the spatial model, we place macrophages and NK and CD8+ T cells at the site
of infection and explicitly model their shape and motility, which provides the opportunity to
generate an explicit description of the spatiotemporal mechanisms involved in local immune cells
locating and eliminating infection. We model immune cell locomotion by introducing chemotaxis
and haptotaxis modeling to the biological objects and processes of the ODE model under the
premise that NK and CD8+ T cells perform contact-mediated killing of infected cells, and that
macrophages perform phagocytosis of virus and release soluble inflammatory signals (Figure 2).
For a complete list of all behaviors, roles and properties of the cell types and fields of the model,
see Appendix 2 in Supplementary Materials.

Figure 2. Local immune response model. A. Schematic of select model objects and processes in the spatial domain associated
with infection, local immune response and local immune cell locomotion. Macrophages ùëÄ chemotax towards extracellular virus

9

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

ùëâ released by infected cells ùêº, and release chemokines ùê∂. NK and CD8+ T cells ùêæ and ùê∏ chemotax towards chemokines, and
haptotax towards and kill infected cells through contact-mediated cytotoxic killing. B. Detailed view of local immune cells over
six hours of simulation. Two CD8+ T cells (annotated ‚Äú1‚Äù and ‚Äú2‚Äù) migrate towards a common target, perform cytotoxic killing
of underlying infected cells (not shown) and then migrate towards different targets. A macrophage is recruited to the local
domain at hour 5 (annotated ‚Äú3‚Äù). Aggregates of immune cells in the bottom left and top right of the detailed view respond to
dense distributions of infected cells. Macrophages, NK cells and CD8+ T cells shown as maroon, cyan and green, respectively.

Based on phagocytosis and inflammatory signaling by macrophages, we model
macrophages as chemotaxing up gradients of extracellular virus, and NK and CD8+ T cells as
chemotaxing up gradients of chemokines. We also model the specialization of CD8+ T cells as
their chemotactic sensitivity being twice that of NK cells. Based on contact-mediated killing of
infected cells, we model stronger adhesion of immune cells to infected cells compared to
uninfected and dead cells. We determined in early computational experiments that generating an
effective local immune response also required preferential attachment that prevents excessive
homotypic aggregation of immune cells but allows both heterotypic aggregates of immune cells
and dispersion of immune cell aggregates according to chemoattractant distributions. As such, we
model adhesion of immune cells to other immune cell types and the medium the same as to infected
cells, and to immune cells of the same type the same as to uninfected and dead cells.
We approximated the diffusive characteristics of local soluble signals by diffusion length
(i.e., ‚àö(ùõø/ùëû) for diffusion coefficient ùõø and decay rate ùëû) in units of cell diameters, using the decay
parameters of the ODE model. Diffusion of extracellular virus and chemokines were approximated
with diffusion lengths of five and ten cell diameters, respectively, based on previous, comparable
modeling work on local infection and immune response (21). The diffusion length of IL-10 was
assumed to be the same as that of chemokines, while type I IFN was modeled with a diffusion
length of two cell diameters to model local anti-viral signaling.
Implementation Details
Simulations were performed with comparable configurations to those in similar modeling work on
local infection and immune response (21). All simulations were executed in CompuCell3D (24)
with either a lattice planar dimension of 0.3 mm or 1.0 mm. Every lattice was discretized with a
discretization length of 2 ¬µm for cells that, on average, occupied 25 sites (Table 4). The local
scaling coefficient ùúÉ = 4√ó10-8 ¬µm-2 was calculated from the total number of epithelial cells
according to the ODE model (250k) and cell volume constraint ùë£ùëê . The local scaling coefficient ùúÇ
was calculated as the ratio of the number of epithelial cells in the simulation domain to those in
the ODE model parameters, and was 0.0049 and 0.04 for lattices with planar dimensions of 0.3
mm and 1.0 mm, respectively. Neumann and periodic conditions were applied to boundaries
parallel and orthogonal, respectively, to the epithelial sheet. Epithelial cells were arranged in a
uniform grid of 5x5 squares. All simulations used a time step of one minute per step, which was
determined to be sufficiently small for numerically stability, particularly of type I IFN signaling.
All ODE model parameters were taken from (14). Scaling was performed by epithelial cell
population for an ODE model epithelial cell population of 250k cells. Using the prescribed volume
constraint, simulations using only the ODE model showed the potential for local immune cells to
exceed the available space in the immune cell layer, an event called overcrowding in
cellularization. To mitigate overcrowding, we employed the cellularization strategy of partially
10

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

homogenizing local immune cell populations, where all macrophages are explicitly represented in
the spatial domain (since they provide directional signaling), while 25% of NK and CD8+ T cells
act homogeneously as scalar-valued functions. All local immune cells were seeded into the
immune cell layer with a seeding fraction of 1% according to field values of their chemoattactrants
(i.e., by virus for macrophages, by chemokines for NK and CD8+ T cells).
Table 4. Implementation parameters used in all simulations.
Parameter
Time step ‚àÜùë°
Lattice width
Intrinsic random motility ‚Ñã ‚àó
Seeding fraction
Local fraction
Macrophages
NK cells
CD8+ T cells

Value
1 min. step-1
2 ¬µm
10
1%

Source/Justification
Chosen for numerical stability
Chosen for epithelial cell size of 5 x 5 sites
(23)
Chosen for efficient local immune response (22)

100%
75%
75%

Chosen to explicitly model directional signaling in immune response
Chosen to mitigate overcrowding according to ODE model results
Chosen to mitigate overcrowding according to ODE model results

Results
In this section we present results from simulations of the spatial, cell-based model of influenza A
infection and immune response. Given the stochasticity of the cell-based models, we simulate
multiple simulation replicas for all initial conditions and parameter sets to demonstrate both their
qualitative dynamical and stochastic features. In all scenarios, we employ one of two types of
initial conditions: initial viral load, where simulations are initialized with a nonzero amount of
virus, which is uniformly applied in the extracellular virus field; or initial infection fraction, where
a fraction of epithelial cells are randomly selected at the beginning of simulation and initialized as
infected. All replicas were executed for two weeks of simulation time at most, and were terminated
early if all epithelial cells were dead (a determined lethal scenario), or if all were uninfected and
total extracellular virus was less than 0.001, which was several orders of magnitude less than
typical values during infection (an assumed non-lethal scenario). To compare results between the
ODE and spatial models, we also simulated all scenarios using the ODE model while scaling
results to the size of the spatial model.
Testing Agreement in Small Epithelial Patches
To evaluate the agreement between the ODE and spatial models using the described cellularization
in Models and Methods, we first simulated fifty replicas of small epithelial patches of area 0.3 mm
x 0.3 mm with high initial infection fraction, which has been shown to mitigate potential spatial
effects of initial infection in cellularized models of viral infection (22). As such, we imposed an
initial infection fraction of 5% comparably to related previous work (25,26).
5% initial infection generated a lethal outcome in all simulation replicas within four days
of simulation time, with marginal stochasticity among simulation replicas (Figure 3). Spatial
distributions of local immune cells showed mostly sparsely distributed macrophages in the first
day of simulation, with some aggregation near groups of infected cells. By one day of simulation
time, NK and CD8+ T cells began arriving at the site of infection and accumulated in locations
with high chemokines. By two days of simulation time, after most, if not all, epithelial cells had
died, local immune cells formed branching patterns and intermixed by type. In general, simulation
11

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

replicas well recapitulated ODE model results. Type I IFN results demonstrated the most notable
differences around the time when the number of infected cells was at its maximum, with
corresponding downstream effects. In particular, paracrine regulation of type I IFN release was
inhibited by diffusion, which lead to greater production of type I IFN and, to a lesser extent,
extracellular virus. Slightly greater extracellular virus resulted in slightly less antibodies and
slightly earlier infection and death of all epithelial cells in some simulation replicas.

Figure 3. Spatial model results for 5% initial infection fraction. A. Spatial distribution of epithelial cells (top) and local immune
cells (bottom) in a simulation replica at 0, 0.25, 0.5, 1, 1.5 and 2 days. Uninfected cells shown as blue, infected cells as red, dead
cells as black, macrophages as maroon, NK cells as cyan, and CD8+ T cells as green. B. Results from 50 simulation replicas of
the spatial model (colored lines) compared to ODE model results (black line) for epithelial cells, extracellular virus, and select
immune cell types and signals.

Disagreement in Large Epithelial Patches
Having shown acceptable agreement between the spatial and ODE models under marginally
stochastic initial infection conditions, we generated a spatial equivalent of the lethal scenario to
12

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

which the ODE model was calibrated by exposing large, uninfected epithelial patches to an initial
viral load. We simulated 50 replicas of 1.0 mm x 1.0 mm epithelial patches, which, for the chosen
spatial model parameters and 250k epithelial cells in the original ODE model simulations,
collectively total two model organisms of the ODE model.
In all simulation replicas, at most, marginal infection occurred, in strong disagreement with
ODE model predictions of a lethal outcome at around ten days (Figure 4). Figure 4A shows spatial
distributions of one representative replica where any notable infection occurred, which consisted
of an isolated lesion of infected and dead cells that recovered within two weeks. During early
progression of such lesions, inflammatory signaling recruited significant numbers of macrophages,
which localized at the lesion and subsequently recruited local NK and CD8+ T cells. Some new,
later infection sites were also observed but well mitigated by present antibodies and quickly
eliminated by the already stimulated immune response. In these cases, present local immune cells
migrated with the general pattern of macrophages chemotaxing towards infected cells, followed
by present, and reinforced by newly recruited, local NK and CD8+ T cells. In many other
simulation replicas, no infection occurred, and the initial viral load decayed with no indication in
the epithelial patch of exposure to virus (Figure 4B).

13

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

Figure 4. Spatial model results for the lethal exposure scenario. A. Spatial distribution of epithelial cells (top), local immune cells
(middle) and extracellular virus (bottom) in a simulation replica at 0, 1, 2, 4, 5 and 10 days. Cell types shown as in Figure 3. The
color bar shows contour levels of the extracellular virus distribution. B. Results from 50 simulation replicas of the spatial model
(colored lines) compared to ODE model results (black line) for uninfected cells (left), extracellular virus (center), and CD8+ T
cells (right).

Only Large Initial Viral Load Produces Agreement
Because the initial viral load in the calibrated lethal scenario of the ODE model did not generate a
lethal outcome in the spatial model, we tested varying initial viral loads to determine at what order
of magnitude of initial viral load the spatial model generates a lethal outcome. Since the ODE
model was calibrated to both non-lethal and lethal scenarios, where the lethal scenario differed
from the non-lethal scenario only by a 10-fold increase in initial viral load, we performed a
logarithmic parameter sweep of initial viral load by beginning with the spatial model equivalent
to the non-lethal scenario, and increasing the initial viral load by a factor of 10 until the spatial
model produced lethal outcomes in twenty simulation replicas.

Figure 5. Results from simulation replicas of the spatial model (colored lines) compared to ODE model results (black line) for
uninfected cells (top), infected cells (top-middle), extracellular virus (bottom-middle), and antibodies (bottom) for initial viral
load multipliers, from left to right, of 1, 10, 100, 1000 and 10000.

14

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

We found that the spatial model begins to generate lethal outcomes when the initial viral
load is at least greater than the initial viral load of the calibrated lethal scenario by a factor of 100
(Figure 5). Increasing the initial viral load of the lethal scenario (Figure 5, initial viral load of 10)
by factors of 10 and 100 did not produce a lethal outcome in any simulation replica over two weeks
of simulation time, though, besides the difference in outcome, the latter produced comparable
predictions to those of the ODE model. A 1k increase in initial viral load from the lethal scenario
produced at least nearly lethal outcomes in all simulation replicas, with the number of uninfected
cells reaching minima at least as low as 10 cells (i.e., 0.1% uninfected). Many simulation replicas
produced no uninfected cells at times as early as three and a half days, compared to about two and
a half days according to the ODE model (i.e., when the number of uninfected cells is less than 1
according to the ODE model). In some replicas, marginal numbers of uninfected cells persisted as
late as twelve and a half days, while two replicas demonstrated recovery of the epithelial patch and
a corresponding non-lethal outcome. For this initial viral load, spatial model results disagreed
otherwise only in amount of extracellular virus for replicas that produced a non-lethal outcome.
We found these differences to be due to the difference in treatment of cell populations (i.e., as
continuous quantities in the ODE model and as discrete quantities in the spatial model), where cell
populations being less than one exhibits no notable effects in the ODE model, whereas discrete
cell populations in the spatial model cease to exhibit any effects by having a number of cells equal
to zero. For the calibrated non-lethal scenario (Figure 5, initial viral load of 1), no infection
occurred in 19 out of 20 replicas, and in the one replica that did experience any infection, the
maximum number of infected was two orders less, and occurred about two days earlier, than that
of the ODE model.
For simulation replicas that did experience significant amounts of infection (e.g., for those
with lethal outcomes), we observed multiple sites of significant infection within the first day after
exposure (Figure 6). These sites were locations of significant recruitment of local macrophages
and subsequent recruitment of local NK and CD8+ T cells, as well as localized type I IFN, which
later became more homogeneous due to production by nonlocal APCs. Spatial distributions of
chemokines and IL-10 showed gradients most apparently at around two days of simulation time,
with IL-10 being greater in regions with significant accumulation of local immune cells, and
became mostly homogeneous by around one week of simulation time when immune cells mostly
covered the epithelial patch. For simulation replicas with the highest initial viral load that
recovered (e.g., as in Figure 6), groups of uninfected epithelial that survived infection and immune
response by around one week of simulation time became the sites of recovery of the epithelial
patch, which became apparent by about two weeks of simulation time as outgrowths of uninfected
cells into a distribution of otherwise dead cells.

15

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

Figure 6. Spatial distribution of, from top to bottom, epithelial cells, local immune cells, and extracellular virus, type I IFN,
chemokines and IL-10 in a simulation replica with 1000 initial viral load at 0, 1, 2, 4, 7 and 14 days. Cell types shown as in
Figure 3. The color bar shows contour levels of diffusive species from zero to the maximum value per field. Each field maximum
shown along the right border.

Only Large Initial Fractions of Infected Cells Produce Agreement
Since much higher initial viral loads were required to generate significant infection in large
epithelial sheets using the spatial model compared to the ODE model, we then tested agreement
between the ODE and spatial models while varying initial infection fraction in 1 mm x 1 mm
epithelial patches. We varied the initial infection fraction in a logarithmic sweep at intervals of
0.1%, 0.5%, 1% and 5% and simulated twenty simulation replicas for each initial infection
fraction. As in Testing Agreement in Small Epithelial Patches, 5% initial infection fraction can
16

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

produce fatal outcomes but in large epithelial sheets, though at times no earlier than about five
days, but can also produce non-fatal outcomes (Figure 7). For all simulation replicas subjected to
5% initial infection fraction, the epithelial patch experienced infection comparably to that
predicted by the ODE model, however in some cases a few uninfected cells survived and initiated
recovery. As initial infection fraction decreased, peak extracellular virus and infected cells in the
spatial model occurred later and with lesser magnitude, and all simulation replicas produced a nonfatal outcome for initial infection fraction less than or equal to 1%, all of which are fatal according
to the ODE model.

Figure 7. Results from simulation replicas of the spatial model (colored lines) compared to ODE model results (black line) for
uninfected cells (top), infected cells (top-middle), extracellular virus (bottom-middle), and antibodies (bottom) for initial
infection fraction, from left to right, of 0.001, 0.005, 0.01 and 0.05.

17

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

Discussion
Our simulation scenario (i.e., the periodic boundary conditions) implies that our simulation
replicas are constituent elements of a patterned system, the collection of which the ODE model
describes. Comparable work using cellularized models of viral infection have shown that this
premise can produce spatial model replicas that are valid spatiotemporal microconfigurations of
an ODE model when initially infected cells are essentially spatially homogeneous (22). We
showed that simulation replicas using the cellularized model and introduced spatial model
mechanisms of this work can also serve as microconfigurations of the original ODE model of
influenza infection and immune response under the same boundary and initial infection conditions.
However, using spatially homogeneous initial exposure conditions consistently with those
employed during calibration of the ODE model generated far less severe infection. This strongly
suggests the role of localization of exposure in influenza A infection, in particular that local
exposure to virus must be multiple orders of magnitude greater than a uniformly applied exposure
to all available susceptible cells. As such, we propose that the particularities of the
microenvironment to which the virus is introduced plays a dominant role in disease onset and
progression. This is particularly important in therapeutics and modeling, alike, in that spatially
resolved patient data of the state of infection may elucidate future health states based on
susceptibility of potential lesion sites, which could be better understood and more reliably
predicted with spatially-resolved models of the type presented in this work.
Differential adhesion and chemotaxis parameters of the introduced spatial model
mechanisms were formulated qualitatively, and only roughly calibrated to recapitulate ODE model
results in Testing Agreement in Small Epithelial Patches. Interestingly, the employed differential
adhesion was necessary to recapitulate ODE model results, the role of which is currently not welldefined. These roles are fairly intuitive when considering the observed temporary aggregation of
NK and CD8+ T cells in simulations. Were the differential adhesion scheme employed such that
NK and CD8+ T cells show a preferential attachment to each other, then the observed aggregations
at sites of infection due to recruitment would result in ineffective subsequent elimination of
infected cells due to the continued aggregation of NK and CD8+ T cells. As such, the model
predicts that aggregation of local cytotoxic immune cells is due to chemotactic signaling and
preferential attachment to infected cells, and that ineffective binding between cytotoxic immune
cells makes their subsequent dispersal and translocation, and thus effective contact-mediated local
immune response mechanisms, possible.
The most prominent differences between the spatial and ODE models all resolve to
localization of type I IFN and recovery. The ODE model, and correspondingly the cellularized
spatial model, describe saturated release of type I IFN, the saturation of which is diffusion-limited
in the spatial model. This leads to differences not only in total over-production of type I IFN in the
spatial models, but also in downstream over-production of virus (i.e., diffusion-limited anti-viral
resistance), with corresponding lesser availability of total antibodies due to interactivity with virus.
However, such differences between the ODE and spatial models were shown to be marginal under
certain exposure conditions (e.g., very high initial viral load or infection fraction) and, as
previously described, to be significant when the lack of representing localization of virus in the
spatial model significantly inhibits the progression of infection (or even its occurrence) in the
18

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

spatial model epithelial patch. The cellularized Allee effect, which was recast to make associated
death and recovery mechanisms dependent on the state and local conditions of individual cells,
also produced differences in ODE and spatial model results by allowing recovery with very few
total uninfected cells in the spatial model. While we found differences in associated cell deaths to
be marginal (and hence, not shown), the spatial model can produce recovery of the epithelial patch
in scenarios where associated cell death and a corresponding fatal outcome occur in the ODE
model (e.g., Figure 5), depending on the state and local conditions of uninfected epithelial cells.
Future Work
The cellularized model of influenza infection and immune response present a number of
opportunities for future model development, integration and application. The components of the
immune response in the cellularized model can be readily integrated into modular frameworks of
viral infection dynamics and immune response that do detailed modeling of other mechanisms like
viral internalization and intracellular viral replication dynamics (21). Such activities present twofold opportunities for novel insights into host-pathogen interactions, in that the immune response
components represented here can be leveraged in other viral applications, and likewise integration
with other modeling work can be inform further development of the cellularized model presented
here. In the case of modeling influenza, detailed modeling of intracellular viral replication while
leveraging simulation capabilities like those available in BioNetGen (27) may provide insights
into the role of the timing of viral internalization and release, and into the meaning of the calibrated
model parameters of the ODE model.
An approach to effectively modeling local features of exposure would significantly
improve the ability of our cellularized model to present spatially resolved predictions about the
progression of influenza infection and immune response, though will likely require considering
mechanisms that are only very implicitly described by the ODE model such as mucociliary
clearance. As such, future work should combine the cellularized model presented here with
available experimental data and modeling of exposure scenarios. Likewise, future work should
further explore and develop a cellular basis for the mechanisms represented by the Allee effect, in
particular what all is represented when imposing an organismal-level property like the number of
a particular cell type onto the fate of individual cells (e.g., levels of growth factors, hormones,
blood pressure).
The current type I IFN model constitutes the overwhelming majority of computational cost
of the spatial model. In particular, calculating a cellular property like resistance ùúå from the mean
value of a local diffusion field requires sufficiently small time steps, since its downstream effects
include regulation of future type I IFN production. We plan to make improvements to cellularized
mechanisms associated with type I IFN production, as well as to CompuCell3D, to permit larger
time steps and better facilitate computational performance. Such improvements are particularly
critical to modeling bigger tissue patches and more complicated tissue geometries, and simulating
longer scenarios.
Lastly, we are particularly interested in further developing other spatial aspects of the
cellularized model to further elucidate associated cellular and spatial aspects of influenza infection
19

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

and immune response, as well as the immune response, in general. We can use in vitro data of cell
migration to refine the proposed locomotion model of local immune cells at a site of infection,
both to better understand how adhesion and chemotaxis affect the effectiveness of the immune
response, and to isolate necessary additional model mechanisms to better represent local aspects
of immune response. At a broader level, we can perform similar activities to this project but for
other sites of interest associated with the ODE model. For example, the ODE model presents
systemic response data that can guide development of spatiotemporal, cell-based models of B cell
maturation, antigen presentation, and antibody production and circulation. We envision a
computational framework consisting of multiple compartments simulating spatiotemporal models
of various sites of interest throughout an organism (e.g., multiple sites of infection, lymph nodes,
thymus), which could be interconnected using the techniques of cellularization in similar fashion
to what was employed in this work.
Conclusion
In this work we developed and employed a multiscale, spatiotemporal, stochastic, cell-based model
of influenza infection and immune response by cellularization of an existing, calibrated ODE
model. We developed spatial models of necessary mechanisms related to differential adhesion and
chemotaxis of local immune cells to recapitulate ODE model results using the spatial model, and
generated a cellularized form of the Allee effect to describe recovery of epithelial cells in terms of
cell state and local conditions. We used the developed spatial model to show how exposure to virus
should be locally concentrated to generate significant infection in an epithelium, while uniform
exposure to virus is likely ineffective. We also used our developed spatial models to elucidate the
necessary roles of differential adhesion and local chemotaxis for an effective local immune
response, both concerning the locating by macrophages, and the eliminating by NK and CD8+ T
cells, of infected cells.
Acknowledgments
TJS and JAG acknowledge funding from National Institutes of Health grants U24 EB028887 and
R01 GM122424 and National Science Foundation grant NSF 1720625. GBE acknowledges
funding from National Science Foundation grant NSF 1951099. This research was supported in
part by Lilly Endowment, Inc., through its support for the Indiana University Pervasive
Technology Institute. The funders had no role in manuscript preparation or the decision to submit
the work for publication.
Competing Interests
JAG is the owner/operator of Virtual Tissues for Health, LLC, which develops applications of
multiscale tissue models in medical applications, and is a shareholder in Gilead Life Sciences.
Supplementary Materials
Appendix 1
This section presents the complete cellularization of the ODE model. The cellularized form of each
ODE is presented along with the original ODE form according to the cellularization scheme
described in Models and Methods. In general, we employ the notation that for a number of cells ùëç
20

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

of cell type ùëçÃÇ according to the scale of the ODE model, the corresponding number of cells of type
ùëçÃÇ in the spatial domain is written as ùëß. The same notation is employed for soluble signals (e.g., ùê¥
measured at the scale of the ODE model is ùëé measured at the scale of the spatial model), with the
exception that we write ùëá ‚àó as the total amount of TNF in the spatial domain (so as not to be
confused with time). For the soluble signals chemokines ùê∂, IL-10 ùêø, type I IFN ùêπ and extracellular
virus ùëâ with explicitly represented spatial distributions ùëêÃÉ , ùëôÃÉ, ùëìÃÉ and ùë£ÃÉ, respectively, the global
amounts ùëê, ùëô, ùëì and ùë£ are calculated as the volume integral of their respective spatial distribution
over the spatial domain. For all other soluble signals, their spatial distribution is treated as uniform
over the spatial domain when appropriate (e.g., for antibodies, ùê¥ = ùúÇ‚àí1 ùëé = ùúÉ ‚àí1 ùëéÃÉ).
The ODE model describes two pro-inflammatory signals Œ£1 and Œ£2 , the first of which
describes dead cells and TNF as stimuli for production of chemokines and IL-10 and stimuli to the
second signal, and the second of which describes the first and extracellular virus as stimuli for
production of TNF. For the first signal,
Œ£1 = ùëé11 ùëá + ùëé12 ùê∑,
and for the second signal,
Œ£2 = Œ£1 +

ùëé21 ùëâ
.
ùëé22 + ùëâ

Both signals are treated as global signals in the spatial model with corresponding values ùúé1 = ùúÇŒ£1
and ùúé2 = ùúÇŒ£2, such that for the first signal,
ùúé1 = ùëé11 ùëá ‚àó + ùëé12 ùëë,
and for the second signal,
ùúé2 = ùúé1 +

ùúÇùëé21 ùë£
.
ùúÇùëé22 + ùë£

Soluble Signals
The model mechanisms for chemokines, IL-10, type I IFN and extracellular virus are described in
Models and Methods, where also a cell-based description of viral resistance ùúå due to type I IFN is
described. In the ODE model, the corresponding model of viral resistance ùëÖ of the epithelial cell
population takes the form,
ùëÖ=

ùêπ
.
ùëéùëüùëì + ùêπ

The rate equation for extracellular virus has the form,
ùëëùëâ
ùëîùë£ ùëâ
= ùëîùë£ùëñ (1 ‚àí ùëÖ)ùêº ‚àí ùëîùë£‚Ñé ùêªùëâ ‚àí ùëîùë£ùëé ùëâùê¥ ‚àí
‚àí ùúáùë£ ùëâ.
ùëëùë°
1 + ùëéùë£ ùëâ
The rate equation for chemokines in the ODE model has the form,

21

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

ùëëùê∂
ùëèùëê Œ£1 ùëÄ
=
‚àí ùúáùëê ùê∂.
ùëëùë° Œ£ + ùëî1 ùêø + ùëî2
1
ùêø + ùëë2
The rate equation for IL-10 in the ODE model has the form,
ùëëùêø
ùëèùëô Œ£1 ùëÄ
=
‚àí ùúáùëô (ùêø ‚àí ùëèùëô‚Ñé (1 ‚àí ùëÖ)ùêª).
ùëëùë° Œ£ + ùëî1 ùêø + ùëî2
1
ùêø + ùëë2
The rate equation for type I IFN has the form,
ùëëùêπ
= ùëèùëìùëñ (1 ‚àí ùëÖ)ùêº + ùëèùëìùëù ùëÉ ‚àí ùëîùëìùëñ ùêºùêπ ‚àí ùúáùëì ùêπ.
ùëëùë°
In the inflammatory response, the ODE model describes production of TNF by the second
pro-inflammatory Œ£2 and macrophages, and regulated by IL-10,
ùëèùë° Œ£2 ùëÄ
ùëëùëá
=
‚àí ùúáùë° ùëá.
ùëëùë° Œ£ + (Œ£ + ùëî1 ùêø + ùëî2 ) ùëò1 ùêø + ùëò2
2
2
ùêø + ùëë2
ùêø + ùëë1
The spatial model treats TNF as uniformly distributed, with the corresponding rate equation,
ùëëùëá ‚àó
=
ùëëùë°

ùëèùë° ùúé2 ùëö
‚àí ùúáùë° ùëá ‚àó .
ùúÇ(ùëî1 ùëô + ùúÇùëî2 ) ùëò1 ùëô + ùúÇùëò2
ùúé2 + (ùúé2 +
)
ùëô + ùúÇùëë2
ùëô + ùúÇùëë1

The ODE model describes production of ROS by tissue neutrophils and its uptake by uninfected
and infected cells,
ùëëùëã
ùëèùë•ùëõ ùëÅ
=
‚àí ùëîùë•ùëñ ùêºùëã ‚àí ùëîùë•‚Ñé ùêªùëã ‚àí ùúáùë• ùëã.
ùëëùë° ùëÅ + ùëéùë•ùëõ
The spatial model treats ROS as uniformly distributed, with the corresponding rate equation,
ùëëùë•
ùúÇùëèùë•ùëõ ùëõ
ùëîùë•ùëñ ùëñùë• ùëîùë•‚Ñé ‚Ñéùë•
=
‚àí
‚àí
‚àí ùúáùë• ùë•.
ùëëùë° ùëõ + ùúÇùëéùë•ùëõ
ùúÇ
ùúÇ
In the immune response, the ODE model describes production of IL-12 by APCs mediated
by CD4+ T cells,
ùëëùëä
ùëèùë§ùëú ùëÇùëÉ
=
‚àí ùúáùë§ ùëä.
ùëÇ + ùëéùë§ùëú
ùëëùë°
The spatial model treats IL-12 as uniformly distributed, with the corresponding rate equation,
ùëèùë§ùëú ùëúùëù
ùëëùë§
=
‚àí ùúáùë§ ùë§.
ùëëùë°
ùëú + ùúÇùëéùë§ùëú
The ODE model describes production of type II IFN by NK and CD4+ T cells mediated by IL-12,
22

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

ùëèùëîùëú ùëäùëÇ
ùëèùëîùëò ùëäùêæ
ùëëùê∫
=
+
‚àí ùúáùëî ùê∫
ùëëùë° ùëä + ùëéùëîùëú ùëä + ùëéùëîùëò
The spatial model treats type II IFN as uniformly distributed, with the corresponding rate equation,
ùëèùëîùëú ùë§ùëú
ùëèùëîùëò ùë§ùëò
ùëëùëî
=
+
‚àí ùúáùëî ùëî.
ùëëùë° ùë§ + ùúÇùëéùëîùëú ùë§ + ùúÇùëéùëîùëò
The ODE model describes production of antibodies by B cells, their reaction with extracellular
virus, and a homeostatic nonzero level,
ùëëùê¥
= ùëèùëé + ùëèùëéùëè ùêµ ‚àí ùëîùëéùë£ ùëâùê¥ ‚àí ùúáùëé ùê¥.
ùëëùë°
The spatial model treats antibodies as uniformly distributed, with the corresponding rate equation,
ùëîùëéùë£ ùë£ùëé
ùëëùëé
= ùúÇùëèùëé + ùëèùëéùëè ùëè ‚àí
‚àí ùúáùëé ùëé.
ùúÇ
ùëëùë°
Epithelial Cell Dynamics
In the epithelial sheet, the ODE model describes, in order, an Allee effect, infection and killing by
ROS, in the dynamics of the uninfected cell population,
ùëëùêª ùëè‚Ñé (1 ‚àí ùëÖ)ùêªùê∑(ùêª ‚àí ùêª ‚àó )
ùëî‚Ñéùë• ùëã‚Ñéùë• ùêª
=
‚àí ùëî‚Ñéùë£ ùëâùêª ‚àí
,
‚Ñé
ùêª0
ùëëùë°
ùëã‚Ñéùë• + ùëé ùë•
‚Ñéùë•

where ùêª ‚àó is a critical population value above which recovery occurs, and below which additional
death of uninfected cells occurs. In the dynamics of the infected cell population, the ODE model
describes, in order, infection and killing by ROS, NK cells, CD8+ T cells and resistance-associated
effects,
ùëëùêº
ùëîùëñùë• ùëã‚Ñéùë• ùêº
= ùëî‚Ñéùë£ ùëâùêª ‚àí
‚àí ùëîùëñùëò ùëÖùêæùêº ‚àí ùëîùêºùëí ùëÖùê∏ùêº ‚àí ùúáùëñ (1 ‚àí ùëÖ)ùêº.
‚Ñé
ùëëùë°
ùëã‚Ñéùë• + ùëé ùë•
ùëñùë•

The Allee effect is split into the discrete, stochastic processes of uninfected cells becoming
dead cells, and of dead cells becoming uninfected cells. Both processes occur due to neighborhood
conditions of individual cells. Using the notation ùê¥ùë†,ùëçÃÇ to denote the contact area between cell ùë† and
ùëçÃÇ ‚àí type cells and ùê¥ùë† to denote the total contact area of cell ùë†, the following equalities are true
under well-mixed conditions,
ùê¥ùë† ùê¥ùë†,ùêªÃÇ ùê¥ùë†,ùê∑ÃÇ ùê¥‚àóùêª
=
=
= ‚àó,
ùêª0
ùêª
ùê∑
ùêª
where ùê¥‚àóùêª is a critical contact area with uninfected cells above which dead cells can recover, and
below which uninfected cells can die. The probability of recovery in each dead cell ùë† then occurs
according to an equipollent recovery rate ùëéùêª = ùëéùêª (ùë†),

23

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

ùëéùêª (ùë†) =

ùëè‚Ñé ùêª0 ùúå‚Ä≤ (ùë†)
ùê¥ùë†,ùêªÃÇ max{ùê¥ùë†,ùêªÃÇ ‚àí ùê¥‚àóùêª , 0}.
ùê¥2ùë†

Likewise the probability of death of an uninfected cell due to the Allee effect occurs according to
an equipollent Allee death rate ùëéùê∑ ,
ùëè‚Ñé ùêª0 ùúå‚Ä≤ (ùë†)
ùëéùê∑ (ùë†) =
ùê¥ùë†,ùê∑ÃÇ max{ùê¥‚àóùêª ‚àí ùê¥ùë†,ùêªÃÇ , 0}.
ùê¥2ùë†
Noting that for epithelial cells, ùê¥ùë† = ùê¥ùêªÃÇ = ùê¥ùê∑ÃÇ , and using the contact-mediated equipollent rate ùõæ
from cellularization, the recovery and Allee death rates can then be written as
ùëè‚Ñé ùúå‚Ä≤ (ùë†)
ùê¥‚àó
ùëè ùúå‚Ä≤ (ùë†)
ÃÇ , ùêª0 ùê¥ùë† ) max {ùõæ (ùë†; ‚àö ‚Ñé
ÃÇ , ùêª0 ùê¥ùë† ) ‚àí ‚àöùëè‚Ñé ùêª0 ùúå‚Ä≤ (ùë†) ùêª , 0},
ùëéùêª (ùë†) = ùõæ (ùë†; ‚àö
,ùêª
,ùêª
ùêª0
ùê¥ùë†
ùêª0

ùëéùê∑ (ùë†) = ùõæ (ùë†; ‚àö

ùê¥‚àó
ùëè ùúå‚Ä≤ (ùë†)
ùëè‚Ñé ùúå‚Ä≤ (ùë†)
ÃÇ , ùêª0 ùê¥ùë† ) max {‚àöùëè‚Ñé ùêª0 ùúå‚Ä≤ (ùë†) ùêª ‚àí ùõæ (ùë†; ‚àö ‚Ñé
ÃÇ , ùêª0 ùê¥ùë† ) , 0}.
,ùê∑
,ùêª
ùê¥ùë†
ùêª0
ùêª0

Applying these cellularized forms of the Allee effect and the other mechanisms described
in the ODE model, the probability of infection and death for each uninfected cell are, respectively,
ÃÇ) = 1 ‚àí ùëí ‚àí
Pr(ùúè(ùë†, ùë° + ‚àÜùë°) = ùêºÃÇ|ùúè(ùë†, ùë°) = ùêª
ÃÇ |ùúè(ùë†, ùë°) = ùêª
ÃÇ) = 1 ‚àí
Pr(ùúè(ùë†, ùë° + ‚àÜùë°) = ùê∑

ùëî‚Ñéùë£ ùë£ÃÖ‚àÜùë°
ùúÉ ,

ùëî ùë•ÃÖ ‚Ñéùë•
‚àí(ùëéùê∑ + ‚Ñé ‚Ñéùë•
)‚àÜùë°
ùë•
ùë•ÃÖ +(ùúÉùëé‚Ñéùë• )‚Ñéùë•
ùëí
,

where ùëî‚Ñéùë£ , ùëî‚Ñéùë• and ùëé‚Ñéùë• are ODE model parameters. The probability of death for each infected
cell is then
ÃÇ |ùúè(ùë†, ùë°) = ùêºÃÇ) = 1 ‚àí
Pr(ùúè(ùë†, ùë° + ‚àÜùë°) = ùê∑

ùëî ùë•ÃÖ ‚Ñéùë•
ÃÇ ,ùêª0 ùê¥ùë† )+ùõæ(ùë†;ùëîùêºùëí ùúå,ùê∏ÃÇ ,ùêª0 ùê¥ùë† )+ùúáùëñ ùúå‚Ä≤ )‚àÜùë°
‚àí( ‚Ñé ùëñùë•
+ùõæ(ùë†;ùëîùëñùëò ùúå,ùêæ
ùë• +(ùúÉùëéùëñùë• )‚Ñéùë•
ùë•ÃÖ
ùëí
,

where ùëîùëñùë• , ùëéùëñùë• , ùëîùëñùëò , ùëîùêºùëí and ùúáùëñ are ODE model parameters. The probability of recovery for each
dead cell is then
ÃÇ |ùúè(ùë†, ùë°) = ùê∑
ÃÇ ) = 1 ‚àí ùëí ‚àíùëéùêª‚àÜùë° .
Pr(ùúè(ùë†, ùë° + ‚àÜùë°) = ùêª
Immune Cell Dynamics
In the inflammatory response, the ODE model describes recruitment of macrophages by
chemokines and a resident macrophage population,
ùëëùëÄ
ùëèùëöùëê ùê∂‚Ñéùëö
=
‚àí ùúáùëö (ùëÄ ‚àí ùëèùëö ).
‚Ñéùëö
ùëëùë°
ùê∂‚Ñéùëö + ùëéùëöùëê
The spatial model explicitly models macrophages in the spatial domain. Inflow of macrophages is
described by the cellularized probability,
24

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

ÃÇ ‚àí type cells) = 1 ‚àí ùëí ‚àíùëéùëÄ ‚àÜùë° ‚àë
Pr(add ùêΩ ùëÄ
0‚â§ùëó‚â§ùêΩ

(ùëéùëÄ ‚àÜùë°)ùëó
,
ùëó!

ùëèùëöùëê ùëê ‚Ñéùëö
ùëéùëÄ = ùúÇ ( ‚Ñé
+ ùëèùëö ùúáùëö ),
ùëê ùëö + (ùúÇùëéùëöùëê )‚Ñéùëö
and outflow of macrophages is described by the cellularized probability,
ÃÇ ) = 1 ‚àí ùëí ‚àíùúáùëö‚àÜùë° .
Pr(remove ùë†|ùúè(ùë†) = ùëÄ
The ODE model describes recruitment of blood neutrophils by TNF regulated by IL-10 and
recruitment of tissue neutrophils from blood neutrophils by chemokines. For blood neutrophils
according to the ODE model,
ÃÉ
ÃÉ
ùëëùëÅ
ùëèùëõùë° ùëá
ùëîùëõùëê ùê∂ùëÅ
ÃÉ,
=
‚àí
‚àí ùúáùëõ ùëÅ
ùëëùë°
ùëá + ùëéùëõùëô ùêø + ùëéùëõùë° ùê∂ + ùëéùëõùëê
and for tissue neutrophils according to the ODE model,
ÃÉ
ùëîùëõùëê ùê∂ùëÅ
ùëëùëÅ
=
‚àí ùúáùëõ ùëÅ.
ùëëùë° ùê∂ + ùëéùëõùëê
The spatial model treats both blood and tissue neutrophils as globally acting populations. As such,
in the spatial model blood and tissue neutrophils are also modeled with an ODE scaled to the size
of the spatial domain. In the spatial model, for blood neutrophils,
ùëëùëõÃÉ
ùúÇùëèùëõùë° ùëá ‚àó
ùëîùëõùëê ùëêùëõÃÉ
= ‚àó
‚àí
‚àí ùúáùëõ ùëõÃÉ,
ùëëùë° ùëá + ùëéùëõùëô ùëô + ùúÇùëéùëõùë° ùëê + ùúÇùëéùëõùëê
and for tissue neutrophils,
ùëîùëõùëê ùëêùëõÃÉ
ùëëùëõ
=
‚àí ùúáùëõ ùëõ.
ùëëùë° ùëê + ùúÇùëéùëõùëê
In the immune response, the ODE model describes the generation of APCs by extracellular
virus and dead infected cells ùê∑ùêº upregulated by type II IFN and a resident population,
ùëîùëùùë£ ùëâ
ùëèùëùùëî ùê∫
ùëëùëÉ
= ùëù0 (
+ ùëîùëùùëñ ùê∑ùêº ) (ùëîùëù +
) ‚àí ùúáùëù (ùëÉ ‚àí ùëèùëù ).
ùëëùë°
ùëâ + ùëéùëùùë£
ùê∫ + ùëéùëùùëî
The spatial model describes APCs as globally acting with a scaled ODE model,
ùëîùëùùë£ ùë£
ùëîùëùùëñ ùëëùêº
ùëèùëùùëî ùëî
ùëëùëù
= ùúÇùëù0 (
+
) (ùëîùëù +
) ‚àí ùúáùëù (ùëù ‚àí ùúÇùëèùëù ).
ùëëùë°
ùë£ + ùúÇùëéùëùùë£
ùúÇ
ùëî + ùúÇùëéùëùùëî
The ODE model describes the recruitment of NK cells by chemokines regulated by resistant
infected cells and a resident population,

25

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

ùëèùëòùëê ùê∂‚Ñéùëò
ùëëùêæ
=
‚àí ùëîùëòùëñ ùëÖùêºùêæ ‚àí ùúáùëò (ùêæ ‚àí ùëèùëò )
ùëëùë° ùê∂ ‚Ñéùëò + ùëé‚Ñéùëò
ùëòùëê
The spatial model explicitly models NK cells in the spatial domain. Inflow of NK cells is described
by the cellularized probability,
ÃÇ ‚àí type cells) = 1 ‚àí ùëí ‚àíùëéùêæ‚àÜùë° ‚àë
Pr(add ùêΩ ùêæ
0‚â§ùëó‚â§ùêΩ

ùëéùêæ = ùúÇ (

(ùëéùêæ ‚àÜùë°)ùëó
,
ùëó!

ùëèùëòùëê ùëê ‚Ñéùëò
+ ùúáùëò ùëèùëò ),
ùëê ‚Ñéùëò + (ùúÇùëéùëòùëê )‚Ñéùëò

and outflow of NK cells is described by the cellularized probability,
ÃÇ ) = 1 ‚àí ùëí ‚àíùëüùêæ‚àÜùë° ,
Pr(remove ùë†|ùúè(ùë†) = ùêæ
ùëüùêæ = ùúáùëò +

ùëîùëòùëñ
ùúÇ

‚àë

ùúå(ùë†).

ùë†‚àà{ùë†‚Ä≤ ‚à∂ùúè(ùë†,ùë°)=ùêºÃÇ}

Note that the effects of infected cells on the NK cell population could also be interpreted as
resulting from NK cell death by contact-mediated interactions, as with killing of infected cells by
NK cells. We instead implement the simpler case here and assume that the infected cell population
has an indirect, inhibitory effect on recruitment of NK cells to the local domain. The ODE model
describes the recruitment of CD4+ T cells by APCs,
ùëèùëúùëù ùëÉ‚Ñéùëú
ùëëùëÇ
=
‚àí ùúáùëú ùëÇ.
‚Ñéùëú
ùëëùë° ùëÉ‚Ñéùëú + ùëéùëúùëù
The spatial model describes CD4+ T cells as globally acting with a scaled ODE model,
ùúÇùëèùëúùëù ùëù‚Ñéùëú
ùëëùëú
=
‚àí ùúáùëú ùëú.
ùëëùë° ùëù‚Ñéùëú + (ùúÇùëé )‚Ñéùëú
ùëúùëù

The ODE model describes the recruitment of CD8+ T cells by APCs regulated by resistant infected
cells,
ùëèùëíùëù ùëÉ‚Ñéùëí
ùëëùê∏
=
‚àí ùëèùëíùëñ ùëÖùêºùê∏ ‚àí ùúáùëí ùê∏
‚Ñéùëí
ùëëùë° ùëÉ‚Ñéùëí + ùëéùëíùëù
The spatial model explicitly models CD8+ T cells in the spatial domain. Inflow of CD8+ T cells
is described by the cellularized probability,
Pr(add ùêΩ ùê∏ÃÇ ‚àí type cells) = 1 ‚àí ùëí ‚àíùëéùê∏ ‚àÜùë° ‚àë
0‚â§ùëó‚â§ùêΩ

(ùëéùê∏ ‚àÜùë°)ùëó
,
ùëó!

26

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

ùëéùê∏ =

ùúÇùëèùëíùëù ùëù‚Ñéùëí
ùëù‚Ñéùëí + (ùúÇùëéùëíùëù )

‚Ñéùëí ,

and outflow of CD8 + T cells is described by the cellularized probability,
Pr(remove ùë†|ùúè(ùë†) = ùê∏ÃÇ ) = 1 ‚àí ùëí ‚àíùëüùê∏ ‚àÜùë° ,
ùëüùê∏ = ùúáùëí +

ùëèùëíùëñ
ùúÇ

‚àë

ùúå(ùë†).

ùë†‚àà{ùë†‚Ä≤ ‚à∂ùúè(ùë†‚Ä≤ ,ùë°)=ùêºÃÇ}

As with NK cells, that the effects of infected cells on the CD8+ T cell population could also be
interpreted as resulting from CD8+ T cell death by contact-mediated interactions. We also
implement the simpler case for CD8+ T cells and assume that the infected cell population has an
indirect, inhibitory effect on recruitment of CD8+ T cells to the local domain. The ODE model
describes the recruitment of B cells by the combined action of IL-12 and APCs and a resident
population,
ùëëùêµ
= ùëèùëè + ùëèùëèùëù ùëäùëÉ(ùëè0 ‚àí ùêµ) ‚àí ùúáùëè ùêµ.
ùëëùë°
The spatial model describes B cells as globally acting with a scaled ODE model,
ùëèùëèùëù ùë§ùëù(ùúÇùëè0 ‚àí ùëè)
ùëëùëè
= ùúÇùëèùëè +
‚àí ùúáùëè ùëè.
ùúÇ2
ùëëùë°
Appendix 2
Table A2.1. Cell types and their mathematical symbols, behaviors and properties in the model. Locally modeled cells are denoted
with (*).

Cell Types
B cell

Symbol
ùêµ

Dead*

ùê∑

CD8+ T cell*

ùê∏

Uninfected*

ùêª

Infected*

ùêº

Behaviors/Properties
- homeostatic population
- releases antibodies ùê¥
- promotes release of TNF ùëá by macrophages ùëÄ
- promotes release of chemokines ùê∂ by macrophages ùëÄ
- promotes release of IL-10 ùêø by macrophages ùëÄ
- recruits APCs ùëÉ
- chemotaxes towards chemokines ùê∂
- haptotaxes towards infected cells ùêº
- kills infected cells ùêº by contact-mediated interaction
- uptakes virus ùëâ
- releases IL-10 ùêø
- uptakes ROS ùëã
- releases virus ùëâ
- releases type I IFN ùêπ
- uptakes type I IFN ùêπ
- uptakes ROS ùëã
- inhibits recruitment of NK cells ùêæ
- inhibits recruitment of CD8+ T cells ùê∏

27

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

NK cell*

ùêæ

Macrophage*

ùëÄ

Tissue neutrophil
Blood neutrophil
CD4+ T cell

ùëÅ
ÃÉ
ùëÅ
ùëÇ

APC

ùëÉ

- chemotaxes towards chemokines ùê∂
- haptotaxes towards infected cells ùêº
- kills infected cells ùêº by contact-mediated interaction
- releases type II IFN ùê∫
- homeostatic resident population at site of infection
- chemotaxes towards virus ùëâ
- haptotaxes towards infected cells ùêº
- releases chemokines ùê∂
- releases IL-10 ùêø
- releases TNF ùëá
- releases ROS ùëã
ÃÉ
- transforms to tissue neutrophils ùëÅ
- promotes release of IL-12 ùëä by APCs ùëÉ
- releases type II IFN ùê∫
- homeostatic population
- releases type I IFN ùêπ
- releases IL-12 ùëä
- recruits CD4+ T cells
- recruits CD8+ T cells
- promotes B cell production

Table A2.2. Fields and their mathematical symbols, roles and properties in the model. Locally modeled fields are denoted with (*).

Fields
Antibodies

Symbol
ùê¥

Chemokines*

ùê∂

Type I IFN*

ùêπ

Type II IFN

ùê∫

IL-10*

ùêø

TNF

ùëá

Roles/Properties
- homeostatic level
- antagonizes virus ùëâ
- chemoattractant for NK cells ùêæ
- chemoattractant for CD8+ T cells ùê∏
- recruits macrophages
ÃÉ
- recruits tissue neutrophils ùëÅ from blood neutrophils ùëÅ
- recruits NK cells ùêæ
- inhibits release of virus ùëâ by infected cells ùêº
- inhibits release of IL-10 ùêø by uninfected cells ùêª
- inhibits release of type I IFN ùêπ by infected cells ùêº
- inhibits Allee effect recovery
- inhibits Allee effect death
- promotes killing of infected cells ùêº by NK cells ùêæ
- promotes killing of infected cells ùêº by CD8+ T cells ùê∏
- inhibits apoptosis by infected cells ùêº
- promotes inhibition of recruitment of NK cells ùêæ by infected cells ùêº
- promotes inhibition of recruitment of CD8+ T cell ùê∏ by infected cells ùêº
- promotes recruitment of APCs ùëÉ by virus ùëâ
- promotes recruitment of APCs ùëÉ by dead cells ùê∑
- inhibits release of chemokines ùê∂ by macrophages ùëÄ
- inhibits release of IL-10 ùêø by macrophages ùëÄ
- inhibits release of TNF ùëá by macrophages ùëÄ
ÃÉ
- inhibits recruitment of blood neutrophils ùëÅ
- promotes release of TNF ùëá by macrophages ùëÄ
- promotes release of chemokines ùê∂ by macrophages ùëÄ

28

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

Virus*

ùëâ

IL-12

ùëä

ROS

ùëã

- promotes release of IL-10 ùêø by macrophages ùëÄ
ÃÉ
- recruits blood neutrophils ùëÅ
- chemoattractant for macrophages ùëÄ
- promotes release of TNF ùëá by macrophages ùëÄ
- cleared by environmental mechanisms
- antagonizes antibodies ùê¥
- infects uninfected cells ùêª
- recruits APCs ùëÉ
- promotes release of type II IFN ùê∫ by NK cells ùêæ
- promotes release of type II IFN ùê∫ by CD4+ T cells ùëÇ
- promotes B cell production
- kills uninfected cells ùêª by diffusion-mediated interaction
- kills infected cells ùêº by diffusion-mediated interaction

References
1. de Jong MD, Simmons CP, Thanh TT, Hien VM, Smith GJD, Chau TNB, et al. Fatal outcome
of human influenza A (H5N1) is associated with high viral load and hypercytokinemia.
Nature Medicine. 2006 Oct;12(10):1203‚Äì7.
2.

Lucas C, Wong P, Klein J, Castro TBR, Silva J, Sundaram M, et al. Longitudinal analyses
reveal immunological misfiring in severe COVID-19. Nature. 2020 Aug;584(7821):463‚Äì9.

3.

Mitchell H, Levin D, Forrest S, Beauchemin CAA, Tipper J, Knight J, et al. Higher Level of
Replication Efficiency of 2009 (H1N1) Pandemic Influenza Virus than Those of Seasonal
and Avian Strains: Kinetics from Epithelial Cell Culture and Computational Modeling. J
Virol. 2011 Jan;85(2):1125‚Äì35.

4.

van den Brand JMA, Stittelaar KJ, van Amerongen G, Rimmelzwaan GF, Simon J, de Wit
E, et al. Severity of pneumonia due to new H1N1 influenza virus in ferrets is intermediate
between that due to seasonal H1N1 virus and highly pathogenic avian influenza H5N1 virus.
J Infect Dis. 2010 Apr 1;201(7):993‚Äì9.

5.

van den Brand JMA, Stittelaar KJ, van Amerongen G, Reperant L, de Waal L, Osterhaus
ADME, et al. Comparison of temporal and spatial dynamics of seasonal H3N2, pandemic
H1N1 and highly pathogenic avian influenza H5N1 virus infections in ferrets. PLoS One.
2012;7(8):e42343.

6.

Zeng H, Goldsmith C, Thawatsupha P, Chittaganpitch M, Waicharoen S, Zaki S, et al. Highly
Pathogenic Avian Influenza H5N1 Viruses Elicit an Attenuated Type I Interferon Response
in Polarized Human Bronchial Epithelial Cells. J Virol. 2007 Nov;81(22):12439‚Äì49.

7.

Shoemaker JE, Fukuyama S, Eisfeld AJ, Zhao D, Kawakami E, Sakabe S, et al. An
Ultrasensitive Mechanism Regulates Influenza Virus-Induced Inflammation. PLoS Pathog
[Internet]. 2015 Jun 5 [cited 2020 Dec 7];11(6). Available from:
https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4457877/

29

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

8.

Simon PF, de La Vega M-A, Paradis √â, Mendoza E, Coombs KM, Kobasa D, et al. Avian
influenza viruses that cause highly virulent infections in humans exhibit distinct replicative
properties in contrast to human H1N1 viruses. Sci Rep [Internet]. 2016 Apr 15 [cited 2020
Dec 7];6. Available from: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4832183/

9.

Krummel MF, Bartumeus F, G√©rard A. T cell migration, search strategies and mechanisms.
Nature Reviews Immunology. 2016 Mar;16(3):193‚Äì201.

10. Beauchemin C. Probing the effects of the well-mixed assumption on viral infection dynamics.
J Theor Biol. 2006 Sep 21;242(2):464‚Äì77.
11. Baccam P, Beauchemin C, Macken CA, Hayden FG, Perelson AS. Kinetics of Influenza A
Virus Infection in Humans. Journal of Virology. 2006 Aug 1;80(15):7590‚Äì9.
12. Hancioglu B, Swigon D, Clermont G. A dynamical model of human immune response to
influenza A virus infection. Journal of Theoretical Biology. 2007 May 7;246(1):70‚Äì86.
13. Pawelek KA, Huynh GT, Quinlivan M, Cullinane A, Rong L, Perelson AS. Modeling WithinHost Dynamics of Influenza Virus Infection Including Immune Responses. PLoS Comput
Biol [Internet]. 2012 Jun 28 [cited 2020 Dec 7];8(6). Available from:
https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3386161/
14. Price I, Mochan-Keef ED, Swigon D, Ermentrout GB, Lukens S, Toapanta FR, et al. The
inflammatory response to influenza A virus (H1N1): an experimental and mathematical
study. J Theor Biol. 2015 Jun 7;374:83‚Äì93.
15. Howat TJ, Barreca C, O‚ÄôHare P, Gog JR, Grenfell BT. Modelling dynamics of the type I
interferon response to in vitro viral infection. J R Soc Interface. 2006 Oct 22;3(10):699‚Äì709.
16. Reperant LA, Kuiken T, Grenfell BT, Osterhaus ADME, Dobson AP. Linking Influenza
Virus Tissue Tropism to Population-Level Reproductive Fitness. PLoS One [Internet]. 2012
Aug
28
[cited
2020
Dec
7];7(8).
Available
from:
https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3429484/
17. Beauchemin C, Samuel J, Tuszynski J. A simple cellular automaton model for influenza A
viral infections. J Theor Biol. 2005 Jan 21;232(2):223‚Äì34.
18. Bouchnita A, Bocharov G, Meyerhans A, Volpert V. Hybrid approach to model the spatial
regulation of T cell responses. BMC Immunol [Internet]. 2017 Jun 21 [cited 2020 Dec
7];18(Suppl 1). Available from: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5499095/
19. Kadolsky UD, Yates AJ. How is the effectiveness of immune surveillance impacted by the
spatial distribution of spreading infections? Philos Trans R Soc Lond B Biol Sci. 2015 Aug
19;370(1675).
20. Wessler T, Joslyn LR, Borish HJ, Gideon HP, Flynn JL, Kirschner DE, et al. A computational
model tracks whole-lung Mycobacterium tuberculosis infection and predicts factors that

30

bioRxiv preprint doi: https://doi.org/10.1101/2021.02.20.432089; this version posted February 20, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY 4.0 International license.

inhibit dissemination. PLoS Comput Biol [Internet]. 2020 May 20 [cited 2020 Dec 7];16(5).
Available from: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7239387/
21. Sego TJ, Aponte-Serrano JO, Gianlupi JF, Heaps SR, Breithaupt K, Brusch L, et al. A
modular framework for multiscale, multicellular, spatiotemporal modeling of acute primary
viral infection and immune response in epithelial tissues and its application to drug therapy
timing and effectiveness. PLOS Computational Biology. 2020 Dec 21;16(12):e1008451.
22. Sego TJ, Aponte-Serrano JO, Gianlupi JF, Glazier JA. Generating Agent-Based Multiscale
Multicellular Spatiotemporal Models from Ordinary Differential Equations of Biological
Systems, with Applications in Viral Infection. bioRxiv. 2021 Jan 29;2021.01.28.428647.
23. Graner F, Glazier JA. Simulation of biological cell sorting using a two-dimensional extended
Potts model. Phys Rev Lett. 1992 Sep 28;69(13):2013‚Äì6.
24. Swat MH, Thomas GL, Belmonte JM, Shirinifard A, Hmeljak D, Glazier JA. Multi-Scale
Modeling of Tissues Using CompuCell3D. Methods Cell Biol. 2012;110:325‚Äì66.
25. Ball SC, Abraha A, Collins KR, Marozsan AJ, Baird H, Qui√±ones-Mateu ME, et al.
Comparing the Ex Vivo Fitness of CCR5-Tropic Human Immunodeficiency Virus Type 1
Isolates of Subtypes B and C. Journal of Virology. 2003 Jan 15;77(2):1021‚Äì38.
26. Qui√±ones-Mateu ME, Ball SC, Marozsan AJ, Torre VS, Albright JL, Vanham G, et al. A
Dual Infection/Competition Assay Shows a Correlation between Ex Vivo Human
Immunodeficiency Virus Type 1 Fitness and Disease Progression. Journal of Virology. 2000
Oct 1;74(19):9222‚Äì33.
27. Blinov ML, Faeder JR, Goldstein B, Hlavacek WS. BioNetGen: software for rule-based
modeling of signal transduction based on the interactions of molecular domains.
Bioinformatics. 2004;20(17):3289‚Äì91.

31

