bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

1

Construction of continuously expandable single-cell

2

atlases through integration of heterogeneous datasets

3

in a generalized cell-embedding space

4
5

Lei Xiong1,2,4, Kang Tian1,2,4, Yuzhe Li1,3, Qiangfeng Cliff Zhang1,2,*

6

1

7

Biology & Frontier Research Center for Biological Structure, Center for Synthetic and

8

Systems Biology, School of Life Sciences, Tsinghua University, Beijing, China 100084

9

2

Tsinghua-Peking Center for Life Sciences, Beijing, China 100084

10

3

Academy for Advanced Interdisciplinary Studies, Peking University, Beijing, China 100871

11

4

Co-first authorship

12

*

Correspondence: qczhang@tsinghua.edu.cn (Q.C.Z.)

MOE Key Laboratory of Bioinformatics, Beijing Advanced Innovation Center for Structural

13
14

ABSTRACT

15

Single-cell RNA-seq and ATAC-seq analyses have been widely applied to decipher

16

cell-type and regulation complexities. However, experimental conditions often confound

17

biological variations when comparing data from different samples. For integrative

18

single-cell data analysis, we have developed SCALEX, a deep generative framework that

19

maps cells into a generalized, batch-invariant cell-embedding space. We demonstrate

20

that SCALEX accurately and efficiently integrates heterogenous single-cell data using

21

multiple benchmarks. It outperforms competing methods, especially for datasets with

22

partial overlaps, accurately aligning similar cell populations while retaining true

23

biological differences. We demonstrate the advantages of SCALEX by constructing

24

continuously expandable single-cell atlases for human, mouse, and COVID-19, which

25

were assembled from multiple data sources and can keep growing through the inclusion

26

of new incoming data. Analyses based on these atlases revealed the complex cellular

1

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

27

landscapes of human and mouse tissues and identified multiple peripheral immune

28

subtypes associated with COVID-19 disease severity.

29
30

INTRODUCTION

31

Single-cell RNA sequencing (scRNA-seq) and assay for transposase-accessible

32

chromatin using sequencing (scATAC-seq) technologies enable decomposition of

33

diverse cell-types and states to elucidate their function and regulation in tissues and

34

heterogeneous systems1-4. Efforts like the Human Cell Atlas project5 and Tabula Muris

35

Consortium6 are constructing a single-cell reference landscape for a new era of highly

36

resolved cell research. With the explosive accumulation of single-cell studies,

37

integrative analysis of data from experiments of different contexts is essential for

38

characterizing heterogenous cell populations7. However, potentially informative

39

biological insights are often confounded by batch effects that reflect different donors,

40

conditions, and/or analytical platforms8,9.

41

Integration methods have been developed to remove batch effects in single-cell

42

datasets10-16. One common strategy is to identify similar cells or cell populations across

43

batches. This includes the mutual nearest neighborhood (MNN) method10 which

44

identifies correspondent pairs of cells between two batches by searching for mutual

45

nearest neighbors in gene expression. Scanorama11 generalizes the process of neighbor

46

searching from within two batches to a multiple-batch manner. Seurat v213 applies

47

canonical correlation analysis (CCA) to identify common cell populations in

48

low-dimensional embeddings across data batches, while Seurat v314 introduces “cell

49

anchors” to mitigate the problem of mixing non-overlapping populations, an issue

50

experienced in Seurat v2. Harmony16 also applies population matching across batches,

51

specifically through a fuzzy clustering algorithm.

2

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

52

It is notable that all of these cell similarity-based methods are local-based,

53

wherein cell-correspondence across batches are identified through the similarity of

54

individual cells or cell anchors/clusters. Accordingly, these methods all suffer from

55

two common limitations. First, they are prone to mixing cell populations that only exist

56

in some batches. This becomes a severe problem for the integration of datasets that

57

contain non-overlapping cell populations in each batch (i.e., partially-overlapping data).

58

Second, these methods can only remove batch effects from the current batches being

59

assessed but cannot manage batch effects from additional, subsequently obtained

60

batches. So each time a new batch is added, it requires an entirely new integration

61

process that again examines the previous batches. This severely limits the capacity to

62

integrate new single-cell sequencing datasets.

63

As an alternative to the cell similarity-based local methods, scVI17 applies a

64

conditional variational autoencoder (VAE)18 framework to model the inherent

65

distribution/structure of the input single-cell data. VAE is a deep generative method

66

that comprises an encoder and a decoder, wherein the encoder projects all

67

high-dimensional input data into a low-dimensional embedding, and the decoder

68

recovers them back to the original data space. The VAE framework can maintain the

69

same global internal data structure between the high- and low-dimensional spaces19.

70

However, scVI includes a set of batch-conditioned parameters into its encoder that

71

restrains the encoder from learning a batch-invariant embedding space, limiting its

72

generalizability with new batches.

73

We previously applied VAE and designed SCALE (Single-Cell ATAC-seq

74

Analysis via Latent feature Extraction) to model and analyze single-cell ATAC-seq

75

data20. We found that the VAE framework in SCALE can disentangle cell-type-related

76

and batch-related features in a low-dimensional embedding space. Here, having

77

redesigned the VAE framework, we introduce SCALEX as a method for integration of

78

heterogeneous single-cell data. We demonstrate that SCALEX integration is accurate,
3

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

79

scalable, and computationally efficient for multiple benchmark datasets from

80

scRNA-seq and scATAC-seq studies. As a specific advantage, SCALEX accomplishes

81

data integration through projecting all single-cell data into a generalized

82

cell-embedding space using a batch-free encoder and a batch-specific decoder. Since

83

the encoder is trained to only preserve batch-invariant biological variations, the

84

resulting cell-embedding space is a generalized one, i.e., common to all projected data.

85

SCALEX is therefore able to accurately integrate partially-overlapping datasets

86

without mixing of non-overlapping cell populations. By design, SCALEX runs very

87

efficiently on huge datasets. These two advantages make SCALEX especially useful

88

for the construction and research utilization of large-scale single-cell atlas studies,

89

based on integrating data from heterogeneous sources. New data can be projected to

90

augment an existing atlas, enabling continuous expansion and improvement of an atlas.

91

We demonstrated these functionalities of SCALEX in the construction and analyses of

92

atlases for human, mouse, and COVID-19 PBMCs.

93
94

RESULTS

95

Projecting single-cell data into a generalized cell-embedding space

96

The central goal of single-cell data integration is to identify and align similar cells

97

across different batches, while retaining true biological variations within and across

98

cell-types. The fundamental concept underlying SCALEX is disentangling

99

batch-related components away from batch-invariant components of single-cell data

100

and projecting the batch-invariant components into a generalized, batch-invariant

101

cell-embedding space. To accomplish this, SCALEX implements a batch-free encoder

102

and a batch-specific decoder in an asymmetric VAE framework18 (Fig. 1a. Methods).

103

While the batch-free encoder extracts only biological-related latent features (z) from

104

input single-cell data ( ), the batch-specific decoder is responsible for reconstructing
4

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

105

the original data from z by incorporating batch information back during data

106

reconstruction.

107

Supplying batch information to the decoder in data reconstruction allows the

108

encoder to learn a batch-invariant data representation for each individual cell during

109

model training, which, as a whole, defines a generalized low-dimensional

110

cell-embedding space. This learning is also facilitated by random slicing of all input

111

single cells from different batches into mini-batches. Each mini-batch is forced into

112

alignment with the same data distribution under the restriction of KL-divergence in the

113

same cell-embedding space21. SCALEX also implements Domain-Specific Batch

114

Normalization (DSBN)22 (Methods), a multi-branch Batch Normalization23, in its

115

decoder to support incorporation of batch-specific variations to reconstruct single-cell

116

data.

117

The design underlying SCALEX renders the encoder to function as a data projector

118

that projects single cells of different batches into a generalized, batch-invariant

119

cell-embedding space. SCALEX thus removes batch-related variations present in

120

single-cell data while preserving batch-invariant biological signals in cell-embedding,

121

making it an enabling tool for integration analyses of diverse single cell datasets,

122

without relying on searching for cell similarities.

123

SCALEX integration is accurate, scalable, and accommodates diverse data types

124

We first evaluated the data integration performance of SCALEX on multiple

125

well-curated scRNA-seq datasets, including human pancreas (eight batches of five

126

studies)24-28, heart (two batches of one study)29 and liver (two studies)30,31; as well as

127

human non-small-cell lung cancer (NSCLC, four studies)32-35 and peripheral blood

128

mononuclear cell (PBMC; two batches assayed by two different protocols)13. For

129

comparison, we included several other methods in the analyses, including Seurat v3,

130

Harmony, Conos, BBKNN, MNN, Scanorama, and scVI (Methods).
5

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

131

We used Uniform Manifold Approximation and Projection (UMAP)36 embeddings

132

to visualize the integration performance of all methods (Methods). Note that all of the

133

raw datasets displayed strong batch effects: cell-types that were common in different

134

batches were separately distributed. Overall, SCALEX, Seurat v3, and Harmony

135

achieved the best integration performance for most of the datasets by merging common

136

cell-types across batches while keeping disparate cell-types apart (Fig. S1). MNN and

137

Conos integrated many datasets but left some common cell populations not well

138

aligned. BBKNN, Scanorama, and scVI often had unmerged common cell-types, and

139

sometimes incorrectly mixed distinct cell-types together. For example, in the PMBC

140

dataset (Fig. 1b), considering the T cell populations between the two batches, while

141

SCALEX, Seurat v3, Harmony, and MMN integrations were effective, Scanorama

142

showed both a larger misalignment and mixed all cell-types together without

143

maintaining clear boundaries.

144

We quantified single-cell data integration performance using a silhouette score37

145

and a batch entropy mixing score10 (Methods). Briefly, the silhouette score assesses the

146

separation of biological distinctions, and the batch entropy mixing score evaluates the

147

extent of mixing of cells across batches. Overall, SCALEX outperformed all of the

148

other methods as assessed by the silhouette score, and tied with Seurat and Harmony as

149

the best-performing methods based on the batch entropy mixing score (Fig. 1c). We

150

note that SCALEX obtained a slightly lower batch entropy mixing score, compared to

151

Seurat v3 and Harmony on the liver dataset, which contains batch-specific cell-types

152

and thus is a partially-overlapping dataset. However, Seurat v3 and Harmony may

153

have obtained a high batch entropy mixing score because of misaligning different

154

cell-types together. Indeed, by only considering the degree of batch mixing but

155

ignoring cell-type differences, the batch entropy mixing score is not ideally suited for

156

assessing batch mixing for partially-overlapping datasets.

6

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

157

We also tested the scalability and computation efficiency of SCALEX on

158

large-scale datasets by applying it to 1,369,619 cells from the human fetal atlas dataset

159

(two data batches, Methods)38,39. SCALEX accurately integrated these two batches,

160

showing good alignment of the same cell-types (Fig. S2, Fig. 1d). We then compared

161

the computational efficiency of different methods using down-sampled datasets (of 10

162

K, 50 K, 250 K, 1 M) from the human fetal atlas dataset. SCALEX consumed almost

163

constant runtime and memory that increased only linearly with data size, whereas MNN,

164

Seurat v3, and Conos consumed runtime and memory that increased exponentially, thus

165

did not scale well beyond 250 K cells. Harmony consumed over 400 gigabytes (GB) of

166

memory in analyzing the 1 M dataset, rendering it unsuitable for integration of datasets

167

at this scale (Fig. 1e). Notably, the deep learning framework of SCALEX enables it to

168

run very efficiently on GPU devices, requiring much reduced runtime (took about 10

169

minutes and 16 GB of memory on the 1 M dataset).

170

Finally, SCALEX can be used to integrate scATAC-seq data as well as

171

cross-modality data (e.g. scRNA-seq and scATAC-seq) (Methods). For example,

172

SCALEX integrated the mouse brain scATAC-seq dataset (two batches assayed by

173

snATAC and 10X)40 very well, aligning common cell subpopulations and separate

174

distinct ones (Fig. 1f). We also integrated the cross-modality PBMC data between

175

scRNA-seq and scATAC-seq41,42, and found that SCALEX could correctly integrate

176

the two types of data, and could distinguish rare cells that are specific to scRNA-seq

177

data, including pDC and platelet cells (Fig. 1g). Thus, SCALEX has broad integration

178

capacity across various types of single-cell data.

179

SCALEX integrates partially-overlapping datasets

180

Partially-overlapping datasets present a major challenge for single-cell data integration

181

for local cell similarity-based methods13,14, often leading to over-correction (i.e.,

182

mixing of distinct cell-types). As a global integration method that project cells into a
7

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

183

generalized cell-embedding space, SCALEX is expected to be immune to this problem.

184

For example, the liver dataset is a partially-overlapping dataset where the hepatocyte

185

population contains multiple subtypes specific to different batches: three subtypes are

186

specific to LIVER_GSE124395, and two other subtypes only appear in

187

LIVER_GSE115469 (Fig. S3). We noticed that SCALEX maintained the five

188

hepatocyte subtypes apart, whereas Seurat v3 mixed all five and Harmony mixed the

189

hepatocyte-SCD and hepatocyte-TAT-AS1 cells (Fig. 2a).

190

To characterize the performance of SCALEX on partially-overlapping datasets, we

191

constructed test datasets with a range of common cell-types, down-sampled from the

192

six major cell-types in the pancreas dataset (Methods). SCALEX integration was

193

accurate for all cases, aligning the same cell-types without over-correction, whereas

194

both Seurat v3 and Harmony frequently mixed the cell-types, particularly for the

195

low-overlapping cases (Fig. 2b, Fig. S4). When there was none common cell-type, both

196

Seurat v3 and Harmony collapsed the six cell-types to three, mixing alpha with gamma

197

cells, beta with delta cells, and acinar with ductal cells in various extent. We repeated

198

the cell-type down-sampling analysis from the 12 cell-types in the PBMC dataset as a

199

more complex partial-overlapping example and observed similar results (Fig. S5),

200

demonstrating that SCALEX is robust in retaining informative biological variations for

201

partially-overlapping datasets.

202

Projection of unseen data into an existing cell-embedding space

203

The accurate, scalable, and efficient integration performance of SCALEX depends on

204

its encoder’s capacity to project cells from various sources into a generalized,

205

batch-invariant cell-embedding space. We speculate that once a cell-embedding space

206

has been constructed after integration of existing data, SCALEX should be able to use

207

the same encoder to project additional (i.e., previously unseen) data onto the same

208

embedding space. To test this hypothesis, we used the pancreas dataset. SCALEX
8

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

209

integration removed the strong batch effect in the raw data and aligned the same

210

cell-types together and kept different cell-types were clearly distinguished (Fig. 3a, Fig.

211

S6a). Cell-types were validated by the expression of their canonical markers, including

212

rare cells such as Schwann cells, epsilon cells (Fig. S6b).

213

We projected three new batches43-45 for pancreas tissues (Fig. 3b) into this

214

“pancreas cell space” using the same encoder trained on the pancreas dataset. After

215

projection, most of the cells in the new batches were accurately aligned to the correct

216

cell-types in the pancreas cell space, enabling their accurate annotation by cell-type

217

label transfer (Fig. 3c, Method). We benchmarked annotation accuracy by calculating

218

the adjusted Rand Index (ARI)46, the Normalized Mutual Information (NMI)47, and the

219

F1 score using the cell-type information in the original studies as a gold standard

220

(Methods). The SCALEX annotations achieved the highest accuracy in comparisons

221

with annotations using three other methods (Seurat v3, Conos, and scmap).

222

Expanding an existing cell space by including new data

223

The ability to project new single-cell data into a generalized cell-embedding space

224

allows SCALEX to readily extend this cell space. To verify this, we projected two

225

additional melanoma data batches (SKCM_GSE72056, SKCM_GSE123139)48,49 onto

226

the previously constructed PBMC space. The common cell-types were correctly

227

projected onto the same locations in the PBMC cell space (Fig. 3d). For the tumor and

228

plasma cells only present in the melanoma data batches, SCALEX did not project these

229

cells onto any existing cell populations in the PBMC space; rather, it projected them

230

onto new locations close to similar cells, with the plasma cells projected to a location

231

near B cells, and the tumor cells projected to a location near HSC cells (Fig. 3e).

232

SCALEX projection enables post hoc annotation of unknown cell-types in the

233

existing cell space using new data. We noted a group of cells previously

234

uncharacterized in the pancreas dataset (Fig. 3a). We found that these cells displayed
9

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

235

high expression levels for known epithelial genes (Methods). We therefore assembled a

236

collection of epithelial cells from the bronchial epithelium dataset50. We then projected

237

these epithelial cells onto the pancreas cell space and found that a group of

238

antigen-presenting airway epithelial (SLC16A7+ epithelial) cells were projected onto

239

the same location of the uncharacterized cells (Fig. 3f). This, together with the

240

observation that both cell populations showed similar marker gene expression (Fig. 3g),

241

indicates that these uncharacterized cells are also SLC16A7+ epithelial cells. SCALEX

242

thus enables discovery science in cell biology by supporting exploratory analysis with

243

large numbers of diverse datasets.

244

SCALEX supports construction of expandable single-cell atlases

245

The ability to combine partially-overlapping data onto a generalized cell-embedding

246

space makes SCALEX a powerful tool to construct a single-cell atlas from a collection

247

of diverse and large datasets. We applied SCALEX integration to two large and

248

complex datasets—the mouse atlas dataset (comprising multiple organs from two

249

studies assayed by 10X, Smart-seq2, and Microwell-seq6,51) (Fig. 4a) and the human

250

atlas dataset (comprising multiple organs from two studies assayed by 10X and

251

Microwell-seq39,52).

252

Despite the strong batch effects in the raw data, SCALEX integrated the three

253

batches of the mouse atlas dataset into a unified cell-embedding space (Fig. 4b,c, Fig.

254

S7a). Common cell-types (including both B, T, and endothelial cells in all tissues and

255

proximal tubule, urothelial, and hepatocytic cells in certain tissues) were well-aligned

256

together at the same position in the cell space. Non-overlapping cell-types (such as

257

sperm, Leydig, and small intestine cells from the Microwell-seq data, keratinocyte stem

258

cells and large intestine cells in the Smart-seq2 data, and oligodendrocytes in the

259

Smart-seq2 and Microwell-seq data) were located separately in the space, indicating

260

that biological variations were preserved well (Fig S7b).
10

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

261

Importantly, atlases generated with SCALEX can be used and further expanded by

262

projecting new single-cell data to support comparative studies of cells both in the

263

original atlas and in the new data. Illustrating this, we projected two additional data

264

batches of aged mouse tissues from Tabula Muris Senis (Smart-seq2 and 10X) 53 and

265

two single tissue datasets (lung and kidney)54 onto the SCALEX mouse atlas space. We

266

found that the same cell-types in the new data batches were correctly projected onto the

267

same locations on the cell-embedding space of the initial mouse atlas (Fig. 4d), which

268

was also confirmed by the accurate cell-type annotations for the new data by label

269

transfer from the corresponding cell-types in the initial atlas (Fig. 4e. Methods). On one

270

way, this mouse atlas then can be used to accurately identify/characterize the cells in

271

the new data based on their projected locations in the cell space; and on the other way,

272

projection of new data enables ongoing (and informative) expansion of an existing

273

atlas.

274

Following the same strategy, we also constructed a human atlas by SCALEX

275

integration of multiple tissues from two studies (GSE134255, GSE159929) (Fig. S8a,b).

276

SCALEX, effectively eliminated the batch effects in the original data and integrated the

277

two datasets in a unified cell-embedding space (Fig. S8c,d). Again, we were able to

278

correctly project two additional human skin datasets (GSE130973, GSE147424)55,56

279

onto the human atlas cell-embedding space (Fig. S8e), and again accurately annotated

280

these projected skin cells (Fig. S8f. Methods). These results illustrate that: i) SCALEX

281

enables researchers to evaluate their project-specific single cell datasets by leveraging

282

existing information in large-scale (and ostensibly well annotated) cell atlases; and ii) it

283

also enables atlas creators to informatively integrate new datasets and attendant

284

biological insights from many research programs.

285

An integrative SCALEX COVID-19 PBMC atlas

11

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

286

Many single-cell studies have been conducted to analyze COVID-19 patient immune

287

responses57-64. However, these studies often suffer from small sample size and/or

288

limited sampling of various disease states58,64. For a comprehensive study, we collected

289

data from multiple COVID-19 PBMC studies, involving 860,746 single cells, and 10

290

batches from 9 studies57-63 (Fig. 5a, Fig. S9a), and used SCALEX to generate a

291

COVID-19 PBMC atlas, identifying 22 cell-types, each of which were supported by

292

canonical marker gene expression (Fig. 5b,c, Fig. S9b,c. Methods). Cells across

293

different studies were integrated accurately with the same cell-types aligned together,

294

confirming integration performance of SCALEX (Fig. 5c, Fig. S9d).

295

We observed that some cell subpopulations were differentially associated with

296

patient status (Fig 5d). A subpopulation of CD14 monocytes (CD14-ISG15-Mono),

297

specifically associated with COIVD-19 patients, was characterized by its high

298

expression of Type I interferon-stimulated genes (ISGs) and genes associated with

299

immune-response-related GO terms (Fig 5e,f). The frequency of CD14-ISG15-Mono

300

cells increased significantly from healthy donors to mild/moderate and severe patients

301

(Fig. 6g, Fig. S9e. Methods). Within the COVID-19 patients, we observed a significant

302

decrease in ISG gene expression in CD14-ISG15-Mono cells between the

303

mild/moderate and severe cases, indicating apparently dysfunctional anti-viral immune

304

response in severe COVID-19 patients (Fig. 5e). Specifically enriched in severe verse

305

mild/moderate patients, a neutrophil subpopulation (NCF1-Immature_Neutrophil)

306

lacked expression of the genes responsible for neutrophil activation but showed

307

elevated expression of genes associated with viral-process-related GO terms (Fig.

308

S10a,b). Also enriched in severe patients, a plasma cell subpopulation (MZB1-Plasma)

309

cells displayed decreased expression for antibody production and were enriched for GO

310

terms of immune and inflammatory responses (Fig. S10c,d). Thus, the SCALEX

311

COVID-19 PBMC atlas, generated by integrating a highly diverse collection of

312

single-cell data from individual studies, identified multiple immune cells-types

313

showing dysregulations during COVID-19 disease progression. Note that these trends
12

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

314

could not have been detected in the small-scale, individual studies that served as the

315

basis for our SCALEX COVID-19 PBMC atlas.

316

Comparative analysis of the SCALEX COVID-19 PBMC atlas and the SC4

317

consortium study

318

Recently, a large-scale effort of the Single Cell Consortium for COVID-19 in China

319

(SC4) has generated a single-cell atlas that contains over 1 million cells (including

320

PBMCs and other tissues) from 171 COVID-19 patients and 25 healthy controls65 (Fig.

321

S11a). We projected the consortium dataset into the cell-embedding space of the

322

SCALEX COVID-19 PBMC atlas, and found that the cell-types of two atlases were

323

well-aligned in the embedding space (Fig. 5h,i, Fig. S11b,c).

324

Our analysis, based on the SCALEX COVID-19 PBMC atlas, yielded findings

325

consistent with two conclusions from the SC4 study65. First, in both analyses diverse

326

immune subpopulations displayed differential associations with COVID-19 severity.

327

The proportions of CD14 monocytes, megakaryocytes, plasma cells, and pro T cells

328

were elevated with increasing disease severity, while the proportion of pDC and mDC

329

cells decreased (Fig. 5g). Second, we confirmed that the megakaryocytes and monocyte

330

populations are associated with cytokine storms triggered by SARS-Cov2 infection and

331

are further elevated in severe patients66, based on calculating the same cytokine score

332

and inflammatory score (defined in the SC4 study) for the cells of our SCALEX

333

COVID-19 PBMC atlas (Fig. 5j. Methods).

334

Integration of the SC4 data further substantially improved both the scope and

335

resolution of the SCALEX COVID-19 PBMC atlas. First, this data added macrophages

336

and epithelial cells to the cell space, enabling investigation of their potential

337

involvement in COVID-19. The integration also supported more precise

338

characterization of specific cell subpopulations. For example, the megakaryocyte

339

population, not distinguished in either single atlas, could be divided into two
13

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

340

subpopulations in the combined atlas (Fig. 5h). An exploratory functional analysis of

341

the differentially expressed genes in these two newly delineated megakaryocyte

342

subpopulations (TUBA8-Mega and IGKC-Mega, Fig. S11d,e) revealed enrichment for

343

the GO terms “humoral immune response” for IGKC-Mega cells yet enrichment for

344

“negative regulation of platelet activation” for TUBA8-Mega cells (Fig. 5k). These

345

results illustrate how the continuously expandable single-cell atlases generated using

346

SCALEX capitalize on existing large-scale data resources and also facilitate discovery

347

of biological and biomedical insights.

348

DISCUSSION

349

SCALEX provides a VAE framework for integration of heterogeneous single-cell data

350

by disentangling batch-invariant components from batch-related variations and

351

projecting the batch-invariant components into a generalized, low-dimensional

352

cell-embedding space. By design, SCALEX models the inherent batch-invariant

353

patterns of single-cell data, distinguishing it from previously reported integration

354

methods based on cell similarities. SCALEX does not rely on the identification of

355

common cell-types across batches, and therefore avoids the problem of cell-type

356

over-correction, a severe problem for partially-overlapping datasets. SCALEX thus

357

also overcomes issues of computational complexity in cell similarity-based methods;

358

that is, the computational time required to identify similar cells may increase

359

exponentially as the cell number increases.

360

These two features make SCALEX particularly useful for construction and

361

integrative analysis of large-scale single-cell atlases based on very heterogenous data

362

(i.e., datasets acquired by different labs and using different single-cell analysis

363

platforms). Our construction of human, mouse, and COVID-19 patient single-cell

364

atlases—which aligned well with previously reported atlases generated from

365

coordinated large-scale consortium efforts—demonstrates the particular ability of
14

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

366

SCALEX to producing large-scale atlases from extant small-scale datasets. SCALEX

367

achieves data integration by projecting all single cells into a generalized

368

cell-embedding space using a universal data projector (i.e., the encoder). This data

369

projector only needs to be trained once, and then can be used without retraining to

370

continuously integrate new incoming data into an existing single-cell atlas. This

371

continuous growth ability makes a SCALEX atlas an elastic resource, allowing the

372

integration of many single-cell studies to support ongoing, very large-scale research

373

programs throughout the life sciences and biomedicine.

374

While the number of single-cell studies is increasing enormously each year, best

375

practices for experimental design and sample processing are not established, and there

376

is no obviously dominant data-acquisition platform. SCALEX’s ability to

377

informatively combine data from heterogenous studies and platforms makes it

378

particularly suitable for the current era of single-cell biological research. Finally, the

379

ability to conduct exploratory analysis within a generalized cell space supports that

380

SCALEX should be particularly useful for large-scale integrative (e.g., pan-cancer)

381

studies. We speculate that use of SCALEX to project single-cell datasets (including

382

for example scATAC-seq and scRNA-seq) from highly diverse cancer types to

383

construct a pan-cancer single-cell atlas may lead to the discovery of previously

384

unknown cell types that are common to divergent carcinomas and that function in

385

pathogenesis, malignant progression, and/or metastasis.

386
387

REFERENCES

388
389
390
391
392
393
394

1

2
3

Kolodziejczyk, A. A., Kim, J. K., Svensson, V., Marioni, J. C. & Teichmann,
S. A. The technology and biology of single-cell RNA sequencing. Mol Cell 58,
610-620, doi:10.1016/j.molcel.2015.04.005 (2015).
Papalexi, E. & Satija, R. Single-cell RNA sequencing to explore immune cell
heterogeneity. Nat Rev Immunol 18, 35-45, doi:10.1038/nri.2017.76 (2018).
Tanay, A. & Regev, A. Scaling single-cell genomics from phenomenology to
mechanism. Nature 541, 331-338, doi:10.1038/nature21350 (2017).
15

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434

4

5
6
7
8

9

10

11

12
13

14
15

16
17

18
19

Satpathy, A. T. et al. Massively parallel single-cell chromatin landscapes of
human immune cell development and intratumoral T cell exhaustion. Nature
Biotechnology 37, 925-936, doi:10.1038/s41587-019-0206-z (2019).
Regev, A. et al. The Human Cell Atlas. Elife 6, doi:10.7554/eLife.27041
(2017).
Tabula Muris, C. et al. Single-cell transcriptomics of 20 mouse organs creates
a Tabula Muris. Nature 562, 367-372, doi:10.1038/s41586-018-0590-4 (2018).
Lahnemann, D. et al. Eleven grand challenges in single-cell data science.
Genome Biol 21, 31, doi:10.1186/s13059-020-1926-6 (2020).
Leek, J. T. et al. Tackling the widespread and critical impact of batch effects
in high-throughput data. Nat Rev Genet 11, 733-739, doi:10.1038/nrg2825
(2010).
Hicks, S. C., Townes, F. W., Teng, M. & Irizarry, R. A. Missing data and
technical variability in single-cell RNA-sequencing experiments. Biostatistics
19, 562-578, doi:10.1093/biostatistics/kxx053 (2018).
Haghverdi, L., Lun, A. T. L., Morgan, M. D. & Marioni, J. C. Batch effects in
single-cell RNA-sequencing data are corrected by matching mutual nearest
neighbors. Nat Biotechnol 36, 421-427, doi:10.1038/nbt.4091 (2018).
Hie, B., Bryson, B. & Berger, B. Efficient integration of heterogeneous
single-cell transcriptomes using Scanorama. Nat Biotechnol,
doi:10.1038/s41587-019-0113-3 (2019).
Polanski, K. et al. BBKNN: fast batch alignment of single cell transcriptomes.
Bioinformatics 36, 964-965, doi:10.1093/bioinformatics/btz625 (2020).
Butler, A., Hoffman, P., Smibert, P., Papalexi, E. & Satija, R. Integrating
single-cell transcriptomic data across different conditions, technologies, and
species. Nat Biotechnol 36, 411-420, doi:10.1038/nbt.4096 (2018).
Stuart, T. et al. Comprehensive Integration of Single-Cell Data. Cell 177,
1888-1902 e1821, doi:10.1016/j.cell.2019.05.031 (2019).
Barkas, N. et al. Joint analysis of heterogeneous single-cell RNA-seq dataset
collections. Nat Methods 16, 695-698, doi:10.1038/s41592-019-0466-z
(2019).
Korsunsky, I. et al. Fast, sensitive and accurate integration of single-cell data
with Harmony. Nat Methods, doi:10.1038/s41592-019-0619-0 (2019).
Lopez, R., Regier, J., Cole, M. B., Jordan, M. I. & Yosef, N. Deep generative
modeling for single-cell transcriptomics. Nat Methods 15, 1053-1058,
doi:10.1038/s41592-018-0229-2 (2018).
Kingma, D. P. & Welling, M. Auto-Encoding Variational Bayes.
arXiv:1312.6114 (2013).
Rezende, D. J., Mohamed, S. & Wierstra, D. Stochastic Backpropagation and
Approximate Inference in Deep Generative Models. doi:abs/ (2014).

16

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474

20

21
22

23
24

25

26
27

28

29
30
31

32

33
34

Xiong, L. et al. SCALE method for single-cell ATAC-seq analysis via latent
feature extraction. Nat Commun 10, 4576, doi:10.1038/s41467-019-12630-7
(2019).
Kullback, S. & Leibler, R. A. On Information and Sufficiency. Ann. Math.
Statist. 22, 79-86, doi:10.1214/aoms/1177729694 (1951).
Chang, W.-G., You, T., Seo, S., Kwak, S. & Han, B. Domain-Specific Batch
Normalization for Unsupervised Domain Adaptation. arXiv:1906.03950
(2019).
Ioffe, S. & Szegedy, C. Batch Normalization: Accelerating Deep Network
Training by Reducing Internal Covariate Shift. arXiv:1502.03167 (2015).
Lawlor, N. et al. Single-cell transcriptomes identify human islet cell signatures
and reveal cell-type-specific expression changes in type 2 diabetes. Genome
Res 27, 208-222, doi:10.1101/gr.212720.116 (2017).
Segerstolpe, A. et al. Single-Cell Transcriptome Profiling of Human
Pancreatic Islets in Health and Type 2 Diabetes. Cell Metab 24, 593-607,
doi:10.1016/j.cmet.2016.08.020 (2016).
Muraro, M. J. et al. A Single-Cell Transcriptome Atlas of the Human Pancreas.
Cell Syst 3, 385-394 e383, doi:10.1016/j.cels.2016.09.002 (2016).
Grun, D. et al. De Novo Prediction of Stem Cell Identity using Single-Cell
Transcriptome Data. Cell Stem Cell 19, 266-277,
doi:10.1016/j.stem.2016.05.010 (2016).
Baron, M. et al. A Single-Cell Transcriptomic Map of the Human and Mouse
Pancreas Reveals Inter- and Intra-cell Population Structure. Cell Syst 3,
346-360 e344, doi:10.1016/j.cels.2016.08.011 (2016).
Litvinukova, M. et al. Cells of the adult human heart. Nature 588, 466-472,
doi:10.1038/s41586-020-2797-4 (2020).
Aizarani, N. et al. A human liver cell atlas reveals heterogeneity and epithelial
progenitors. Nature 572, 199-204, doi:10.1038/s41586-019-1373-2 (2019).
MacParland, S. A. et al. Single cell RNA sequencing of human liver reveals
distinct intrahepatic macrophage populations. Nat Commun 9, 4383,
doi:10.1038/s41467-018-06318-7 (2018).
Lambrechts, D. et al. Phenotype molding of stromal cells in the lung tumor
microenvironment. Nat Med 24, 1277-1289, doi:10.1038/s41591-018-0096-5
(2018).
Song, Q. et al. Dissecting intratumoral myeloid cell plasticity by single cell
RNA-seq. Cancer Med 8, 3072-3085, doi:10.1002/cam4.2113 (2019).
Zilionis, R. et al. Single-Cell Transcriptomics of Human and Mouse Lung
Cancers Reveals Conserved Myeloid Populations across Individuals and
Species. Immunity 50, 1317-1334 e1310, doi:10.1016/j.immuni.2019.03.009
(2019).

17

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516

35

36

37

38
39
40
41
42
43
44

45

46
47

48

49

50

Kim, N. et al. Single-cell RNA sequencing demonstrates the molecular and
cellular reprogramming of metastatic lung adenocarcinoma. Nat Commun 11,
2285, doi:10.1038/s41467-020-16164-1 (2020).
McInnes, L., Healy, J. & Melville, J. UMAP: Uniform Manifold
Approximation and Projection for Dimension Reduction. arXiv:1802.03426
(2018).
Rousseeuw, P. J. Silhouettes: A graphical aid to the interpretation and
validation of cluster analysis. Journal of Computational and Applied
Mathematics 20, 53-65, doi:https://doi.org/10.1016/0377-0427(87)90125-7
(1987).
Cao, J. et al. A human cell atlas of fetal gene expression. Science 370,
doi:10.1126/science.aba7721 (2020).
Han, X. et al. Construction of a human cell landscape at single-cell level.
Nature 581, 303-309, doi:10.1038/s41586-020-2157-4 (2020).
Fang, R. et al. Comprehensive analysis of single cell ATAC-seq data with
SnapATAC. Nat Commun 12, 1337, doi:10.1038/s41467-021-21583-9 (2021).
Genomics, X. 10k Peripheral blood mononuclear cells (PBMCs) from a
healthy donor, Single Cell ATAC Dataset by Cell Ranger 1.0.1. (2018).
Genomics, X. 10k PBMCs from a Healthy Donor (v3 chemistry), Single Cell
Gene Expression Dataset by Cell Ranger 3.0.0. (2018).
Wang, Y. J. et al. Single-Cell Transcriptomics of the Human Endocrine
Pancreas. Diabetes 65, 3028-3038, doi:10.2337/db16-0405 (2016).
Enge, M. et al. Single-Cell Analysis of Human Pancreas Reveals
Transcriptional Signatures of Aging and Somatic Mutation Patterns. Cell 171,
321-330 e314, doi:10.1016/j.cell.2017.09.004 (2017).
Xin, Y. et al. Pseudotime Ordering of Single Human beta-Cells Reveals States
of Insulin Production and Unfolded Protein Response. Diabetes 67, 1783-1794,
doi:10.2337/db18-0365 (2018).
Hubert, L. & Arabie, P. Comparing partitions. Journal of Classification 2,
193-218, doi:10.1007/BF01908075 (1985).
Amelio, A. & Pizzuti, C. in Proceedings of the 2015 IEEE/ACM International
Conference on Advances in Social Networks Analysis and Mining 2015
1584–1585 (Association for Computing Machinery, Paris, France, 2015).
Tirosh, I. et al. Dissecting the multicellular ecosystem of metastatic melanoma
by single-cell RNA-seq. Science 352, 189-196, doi:10.1126/science.aad0501
(2016).
Li, H. et al. Dysfunctional CD8 T Cells Form a Proliferative, Dynamically
Regulated Compartment within Human Melanoma. Cell 176, 775-789.e718,
doi:https://doi.org/10.1016/j.cell.2018.11.043 (2019).
Plasschaert, L. W. et al. A single-cell atlas of the airway epithelium reveals
the CFTR-rich pulmonary ionocyte. Nature 560, 377-381,
doi:10.1038/s41586-018-0394-6 (2018).
18

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557

51
52

53

54

55

56

57

58

59

60

61

62

63

64

Han, X. et al. Mapping the Mouse Cell Atlas by Microwell-Seq. Cell 172,
1091-1107 e1017, doi:10.1016/j.cell.2018.02.001 (2018).
He, S. et al. Single-cell transcriptome profiling of an adult human cell atlas of
15 major organs. Genome Biol 21, 294, doi:10.1186/s13059-020-02210-0
(2020).
Tabula Muris, C. A single-cell transcriptomic atlas characterizes ageing
tissues in the mouse. Nature 583, 590-595, doi:10.1038/s41586-020-2496-1
(2020).
Kimmel, J. C. et al. Murine single-cell RNA-seq reveals cell-identity- and
tissue-specific trajectories of aging. Genome Res 29, 2088-2103,
doi:10.1101/gr.253880.119 (2019).
Sole-Boldo, L. et al. Single-cell transcriptomes of the human skin reveal
age-related loss of fibroblast priming. Commun Biol 3, 188,
doi:10.1038/s42003-020-0922-4 (2020).
He, H. et al. Single-cell transcriptome analysis of human skin identifies novel
fibroblast subpopulation and enrichment of immune subsets in atopic
dermatitis. J Allergy Clin Immunol 145, 1615-1628,
doi:10.1016/j.jaci.2020.01.042 (2020).
Schulte-Schrepping, J. et al. Severe COVID-19 Is Marked by a Dysregulated
Myeloid Cell Compartment. Cell 182, 1419-1440.e1423,
doi:10.1016/j.cell.2020.08.001 (2020).
Lee, J. S. et al. Immunophenotyping of COVID-19 and influenza highlights
the role of type I interferons in development of severe COVID-19. Sci
Immunol 5, doi:10.1126/sciimmunol.abd1554 (2020).
Wilk, A. J. et al. A single-cell atlas of the peripheral immune response in
patients with severe COVID-19. Nat Med 26, 1070-1076,
doi:10.1038/s41591-020-0944-y (2020).
Guo, C. et al. Single-cell analysis of two severe COVID-19 patients reveals a
monocyte-associated and tocilizumab-responding cytokine storm. Nat
Commun 11, 3924, doi:10.1038/s41467-020-17834-w (2020).
Yao, C. et al. Cell-Type-Specific Immune Dysregulation in Severely Ill
COVID-19 Patients. Cell Rep 34, 108590, doi:10.1016/j.celrep.2020.108590
(2021).
Zhang, J. Y. et al. Single-cell landscape of immunological responses in
patients with COVID-19. Nat Immunol 21, 1107-1118,
doi:10.1038/s41590-020-0762-x (2020).
Ballestar, E. et al. Single cell profiling of COVID-19 patients: an international
data resource from multiple tissues. medRxiv, 2020.2011.2020.20227355,
doi:10.1101/2020.11.20.20227355 (2020).
Bernardes, J. P. et al. Longitudinal Multi-omics Analyses Identify Responses
of Megakaryocytes, Erythroid Cells, and Plasmablasts as Hallmarks of Severe

19

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582

65
66

67
68

69

70

71
72

COVID-19. Immunity 53, 1296-1314 e1299,
doi:10.1016/j.immuni.2020.11.017 (2020).
Ren, X. et al. COVID-19 immune features revealed by a large-scale single-cell
transcriptome atlas. Cell, doi:10.1016/j.cell.2021.01.053 (2021).
Chen, G. et al. Clinical and immunological features of severe and moderate
coronavirus disease 2019. J Clin Invest 130, 2620-2629,
doi:10.1172/JCI137244 (2020).
Kingma, D. P. & Ba, J. Adam: A Method for Stochastic Optimization.
arXiv:1412.6980 (2014).
Danese, A., Richter, M. L., Fischer, D. S., Theis, F. J. & Colomé-Tatché, M.
EpiScanpy: integrated single-cell epigenomic analysis. bioRxiv,
doi:10.1101/648097 (2019).
Wolf, F. A., Angerer, P. & Theis, F. J. SCANPY: large-scale single-cell gene
expression data analysis. Genome Biol 19, 15,
doi:10.1186/s13059-017-1382-0 (2018).
Stuart, T., Srivastava, A., Lareau, C. & Satija, R. Multimodal single-cell
chromatin analysis with Signac. bioRxiv, doi:10.1101/2020.11.09.373613
(2020).
Abdi, H. & Williams, L. J. Principal component analysis. WIREs Comput. Stat.
2, 433-459, doi:10.1002/wics.101 (2010).
Traag, V. A., Waltman, L. & van Eck, N. J. From Louvain to Leiden:
guaranteeing well-connected communities. Scientific Reports 9, 5233,
doi:10.1038/s41598-019-41695-z (2019).

20

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

843

Figures

844

Fig. 1 | The design and performance of SCALEX for single-cell data integration.

845

a, SCALEX models the global structure of single-cell data using a variational

846

autoencoder (VAE) framework. b, UMAP embeddings of the PBMC dataset before

847

and after integration using SCALEX, Seurat v3, Harmony, Conos, or Scanorama

848

integration, colored by batch and cell-type. c, Scatter plot showing a quantitative

849

comparison of the silhouette score (y-axis) and the batch entropy mixing score (x-axis)

850

on the benchmark datasets. d, UMAP embeddings of the SCALEX integration of the

851

human fetal atlas dataset, colored by batch and cell-type. e, Comparison of

852

computation efficiency on datasets of different sizes sampled from the whole human

853

fetal atlas dataset) including runtime (left) and memory usage (right). f, UMAP

854

embeddings of the mouse brain scATAC-seq dataset before (left) and after integration

855

(middle, right); colored by data batch or Leiden clustering. g, UMAP embeddings of

856

the PBMC cross-modality dataset before (left) and after integration (middle, right);

857

colored by batch or cell-type.

858

Fig. 2 | Comparison of integration performance over partially-overlapping

859

datasets by different methods. a, Comparison over the liver dataset. b, Comparison

860

over simulated datasets with different numbers of common cell-types (obtained by

861

down-sampling the pancreas dataset). Misalignments are highlighted with red circles.

862

Fig. 3 | Projecting heterogenous data into a generalized cell-embedding space. a,

863

UMAP embeddings of the pancreas dataset after integration by SCALEX, colored by

864

cell-type. b, UMAP embeddings of three projected pancreas data batches projected

865

onto the pancreas space, colored by cell-types; the light gray shadows represent the

866

original pancreas dataset. c, Confusion matrix between ground truth cell-types and

867

those annotated by different methods. ARI, NMI and F1 scores (top) measure the

868

annotation accuracy. d, UMAP embeddings of the PBMC dataset after integration and
33

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

869

the two projected melanoma data batches onto the PBMC space, colored by cell-types

870

with light gray shadows represent the original PBMC dataset. e, The PBMC space that

871

includes the original PBMC dataset and the two projected melanoma data batches. f,

872

Annotating an uncharacterized small cell population in the pancreas dataset by

873

projection of the bronchial epithelium data batches into the pancreas cell space. Only

874

the uncharacterized cells in the pancreas dataset (left) and the SLC16A7+ epithelial

875

cells in the bronchial epithelium data batches (right) are colored. g, Heatmap showing

876

the normalized expression of the top-10 ranking specific genes for the uncharacterized

877

cell population in different cell-types.

878

Fig. 4 | Construction of an expandable mouse single-cell atlas. a, Datasets acquired

879

using different technologies (Smart-seq2, 10X, and Microwell-seq) covering various

880

tissues used for construction of the mouse atlas. b, UMAP embeddings of the mouse

881

atlas dataset colored by batch and tissue. c, UMAP embeddings of the mouse atlas

882

after SCLAEX integration, labeld with and colored by cell-type. d, Two Tabula Muris

883

Senis data batches and two mouse tissues (lung and kidney) data are projected onto

884

the cell space of the mouse atlas, with the same cell-type color as in c. e, Confusion

885

matrix of the cell-type annotations by SCALEX and those in the original studies.

886

Color bar represents the percentage of cells in confusion matrix Cij known to be

887

cell-type i and predicted to be cell-type j.

888

Fig. 5 | Construction and expansion of a COVID-19 single-cell atlas. a, COVID-19

889

dataset composition, including healthy controls and influenza patients, as well as

890

mild/moderate, severe, and convalescent COVID-19 patients. b,c UMAP embeddings

891

of COVID-19 PBMC atlas after SCLAEX integration colored by batch (b), and by

892

cell-types (c). d, UMAP embeddings of the COVID-19 PBMC atlas separated by

893

disease state. e, Stacked violinplot of differentially-expressed ISGs among CD14

894

monocytes across disease states. f, GO terms enriched in the differentially-expressed

895

genes for CD14-IL1B-Mono and CD14-ISG15-Mono cells. g, Cell-type frequency
34

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

896

across healthy and influenza controls, and among mild/moderate, severe, and

897

convalescent COVID-19 patients. Dirichlet-multinomial regression was used for

898

pairwise comparisons, ***p<0.001, **p<0.01, *p<0.05. h, United UMAP

899

embeddings of the SCALEX COVID-19 PBMC atlas and the SS4 atlas (from the

900

Single Cell Consortium for COVID-19 in China, projected onto the cell space of the

901

SCALEX COVID-19 PBMC atlas). Left: the SCALEX COVID-19 PBMC atlas,

902

middle: SC4 colored by cell clusters in the original study, right: Expanded atlas

903

combining the SCALEX COVID-19 PBMC atlas and the SC4 atlas. i, Similarity

904

matrix of meta-cell representations for cell-types between the SCALEX COVID-19

905

PBMC atlas and SC4 in the generalized cell-embedding space after SCALEX

906

integration. Color bar represents the Pearson correlation coefficient between the

907

average meta-cell representation of two cell-types from a respective data batch. j,

908

UMAP embeddings of the SCALEX COVID-19 PBMC atlas colored by the cytokine

909

score

910

differentially-expressed genes for TUBA8-Mega and IGKC-Mega cells.

911

Supplementary figures

912

Fig. S1 | Comparison of integration performance on benchmark datasets. UMAP

913

embeddings for benchmark datasets grouped by batches and cell-types, before and

914

after integration by different methods. Misalignments are highlighted with red circles.

915

Fig. S2 | The human fetal atlas. a, UMAP embeddings of the human fetal atlas

916

dataset colored by batch before integration. b, Similarity matrix of meta-cell

917

representations for different cell-types in the two data batches in the generalized

918

cell-embedding space. Color bar represents the Pearson correlation coefficient

919

between the average meta-cell representation of two cell-types from a respective data

920

batch. c, Comparison of computation efficiency on datasets of different sizes

and

the

inflammatory

score.

35

k,

GO

terms

enriched

in

the

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

921

(sampled from the whole human fetal atlas dataset), including runtime (left) and

922

memory usage (right), in log scale.

923

Fig. S3 | Canonical marker genes of different cell-types and UMAP embeddings

924

of the liver dataset. a, Dotplot of canonical marker genes for each cell-type. Dot

925

color represents average expression level, while dot size represents the proportion of

926

cells in the group expressing the marker. b, UMAP embeddings of the liver dataset,

927

colored by batch (left) and cell-type (right) after SCALEX integration. c, Normalized

928

marker gene expression on the UMAP embeddings of the five hepatocyte subtypes.

929

Color bar represents the expression level.

930

Fig. S4 | Integration over partially-overlapping datasets down-sampled from the

931

pancreas dataset. Partially-overlapping datasets were generated by down-sampling

932

the pancreas dataset, consisted of common cell-types with a decreased overlapping

933

number (ranging from 0 to 6). Integration results for SCALEX, Seurat, and Harmony

934

are shown in the UMAP embeddings colored by batches (left) and cell-types (right)

935

respectively (overlapping number decreases from 6 to 0). Misalignments are

936

highlighted with red circles.

937

Fig. S5 | Integration over partially-overlapping datasets down-sampled from the

938

PBMC dataset. Partially-overlapping datasets were generated by down-sampling the

939

PBMC dataset, consisted of common cell-types with a decreased overlapping number

940

(ranging from 0 to 6). Integration results for SCALEX, Seurat and Harmony are

941

shown in the UMAP embeddings colored by batches (left) and cell-types (right)

942

respectively (overlapping number decreases from 6 to 0). Misalignments are

943

highlighted with red circles.

944

Fig. S6 | The pancreas dataset and the additional data batches. a, UMAP

945

embeddings of the pancreas dataset, the three additional pancreas data batches and

946

the bronchial epithelium data batches (data from three donors), grouped by batch. b,
36

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

947

Dot plot of canonical markers of cell-types of reference pancreas dataset; dot color

948

represents average expression level, while dot size represents the proportion of cells

949

in the group expressing the marker.

950

Fig. S7 | The SCALEX mouse atlas. a, UMAP embeddings of the mouse atlas data

951

before integration, colored by batch. b, UMAP embeddings of three mouse atlas data

952

batches (Smart-seq2, 10X, and Microwell-seq) after integration, colored by cell-type;

953

the light gray shadows represent the original mouse atlas dataset. c, Dotplot of the top

954

5 cell-type-specific genes for each cell-type in the mouse atlas dataset. Dot color

955

represents average expression level, while dot size represents the proportion of cells

956

in the group expressing the marker.

957

Fig. S8 | The SCALEX human atlas. a, The human atlas dataset acquired using

958

different technologies (Smart-seq2, 10X, and Microwell-seq) covering various tissues

959

used for construction of the human atlas. b-c, UMAP embeddings of the human atlas

960

dataset colored by batch and cell-type, before (b) and after integration (c). d,

961

Similarity matrix of meta-cell representations for cell-types in the two data batches in

962

the generalized cell-embedding space after SCALEX integration between two batches.

963

Color bar represents the Pearson correlation coefficient between the average meta-cell

964

representation of two cell-types from a respective data batch. e, UMAP embeddings

965

of the human atlas and two additional projected data batches colored by cell-type. f,

966

Confusion matrix of the cell-type annotations by SCALEX and those in the original

967

study. Color bar represents the percentage of cells in confusion matrix Cij known to be

968

in cell-type i and predicted to be in cell-type j.

969

Fig. S9 | COVID-19 immune landscape. a, UMAP embeddings of the raw

970

COVID-19 PBMC dataset before integration. b, UMAP embeddings of the

971

COVID-19 PBMC atlas colored by condition and Leiden clustering after SCALEX

972

integration. c, Dotplot of canonical marker genes for each cell-type. Dot color
37

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

973

represents average expression level, while dot size represents the proportion of cells

974

in the group expressing the marker. d, UMAP embeddings of the COVID-19 PBMC

975

atlas in individual batches after SCALEX integration, colored by cell-type; the light

976

gray shadows represent the other batches of COVID-19 PBMC atlas. e, Frequency of

977

cell distributions across healthy people and influenza patient controls, and among

978

mild/moderate, severe, and convalescent COVID-19 patients. Dirichlet-multinomial

979

regression was used for pairwise comparisons, ***p<0.001, **p<0.01, *p<0.05.

980

Fig. S10 | COVID-19 heterogeneous dysfunctional immune response. a, Stacked

981

violin plot of differentially-expressed genes between PNPLA2-Immature_Neutrophil

982

and

983

differentially-expressed

984

NCF1-Immature_Neutrophil cells. c, Stacked violinplot of differentially-expressed

985

genes between PRDM1-Plasma and MZB1-Plasma. d, GO terms enriched in the

986

differentially-expressed genes for PRDM1-Plasma and MZB1-Plasma cells.

987

Fig S11 | Projection of the SC4 dataset onto the SCLAEX COVID-19 PBMC

988

atlas. a-b, UMAP embeddings of the SC4 dataset before integration (a) and after

989

projection onto the SCLAEX COVID-19 PBMC space (b). c, Separate UMAP

990

embeddings of each SC4 data batch, after being projected onto the SCALEX

991

COVID-19 PBMC space, colored by cell-type. d, UMAP embeddings of the

992

TUBA8-Mega

993

differentially-expressed genes of TUBA8-Mega and IGKC-Mega cells.

NCF1-Immature_Neutrophil

and

genes

IGKC-Mega

cells.

b,

for

PNPLA2-Immature_Neutrophil

cells.

994

38

e,

GO

terms

UMAP

enriched

embeddings

in

the
and

of

the

Fig 1
a

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version c
posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
pancreas

0.6

heart

0.6

0.4

liver

0.6

0.4

0.4

0.2

0.2

Silhouette Score

0.2

BN(batch 1)
BN(batch 2)
BN(batch 3)

...
BN(batch n)

0.0

0.2

0.4

0.0

0.6

NSCLC

0.6

batch-specific
decoder

0.0

0.0

0.2
0.0
0.2

0.3

0.4

0.0

0.5

0.2

0.2

0.4

raw
SCALEX
Seurat v3
Harmony
MNN
Conos
BBKNN
Scanorama
scVI

0.4

0.2

batch-invariant
space

0.0

0.4

PBMC

0.6

0.4

batch-free
encoder

0.2

0.4

0.6

Batch Entropy Mixing Score

b

batch

Raw

cell-type

SCALEX

batch

Seurat v3

batch

cell-type

cell-type

pbmc_3p
pbmc_5p

Harmony

cell-type

MNN

batch

Scanorama

batch

cell-type

cell-type
B
CD4 T
CD4 naive T
CD8 T
CD8 naive T
DC
HSC
Megakaryocyte
NK
monocyte-CD14
monocyte-FCGR3A
pDC

UMAP2

batch

UMAP1

UMAP2

e

cell-type

Acinar cells
Adrenocortical cells
Alveolar cells
Cardiomyocytes
Chromaffin cells
Endocrine cells
Endothelial cells
Erythroblasts
Extravillous trophoblasts
Eye cells
Goblet cells
Hepatoblasts
Intestinal epithelial cells
Mesangial cells
Metanephric cells
Myeloid cells
Skeletal muscle cells
Stromal cells
T

GSE156793
GSE134355

Total runtime

15
10

128

0

64
32
0
10K

50K

before integration

1M

g

before integration

SCALEX
Scanorama

scVI

10K

Number of Cells

clustering

after integration

250K

50K

250K

14

1M

Number of Cells

after integration

cell-type
CD8 Naive

9
12

SCALEX
Seurat v3
Harmony
MNN
Conos
BBKNN
Scanorama
scVI

256

5

UMAP1

f

Maximum memory usage

512

20

Memory(GB)

batch

Time(h)

d

2

Double negative T cell CD4 Naive
CD4 Memory
CD8 effector
NK dim
NK bright

5

1
15
7

10

pDC

4
13

Platelet
CD14+ Monocytes
Dendritic cell

3
11

CD16+ Monocytes

6

UMAP2

0

10X
snATAC
UMAP1

10X
snATAC

8

ATAC
RNA

ATAC
RNA

B cell progenitor
pre-B cell

Fig 2
a

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
Harmony
SCALEX
Seurat v3 All rights reserved. No reuse allowed
was not certified by peer review) is the author/funder.
without permission.

UMAP2

batch

cell-type

batch

cell-type

batch

cell-type

batch

cell-type

batch

cell-type

GSE115469
GSE124395

B
NK-GNLY_high
NK-GNLY_low
T
cholangiocytes
endothelial
erthyroid
hepatocyte-CXCL1
hepatocyte-CYP2A13
hepatocyte-GSTA1
hepatocyte-SCD
hepatocyte-TAT-AS1
kupffer
mature B
stellate

UMAP1

b

SCALEX

Overlap_4

batch

UMAP2

Overlap_0

Overlap_1

Overlap_2

pancreas_celseq
pancreas_smartseq2

UMAP1

Harmony

Seurat v3

cell-type

acinar
alpha
beta
delta
ductal
gamma

Fig 3
a

b Projected: pancreas_GSE114297
bioRxiv preprint
doi: https://doi.org/10.1101/2021.04.06.438536
; this version
postedpancreas_GSE81547
April 8, 2021. The copyright
holderpancreas_GSE83139
for this preprint (which
Projected:
Projected:
pancreas
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
ductal

acinar

beta
beta_er

gamma

uncharacterized
mast
macrophage
schwann
delta
quiescent_stellate
epsilon activated_stellate

alpha_er

endothelial

UMAP2

alpha

UMAP1

Seurat v3: ARI:0.948 NMI:0.913 F1:0.968

0.93

0.80

0.32

0.12
0.98

0.99

0.15
0.90

0.24

0.97

0.99
0.71

0.71

0.97

0.99

1.00

0.99
0.92

0.58
0.25

0.67

0.19

0.73

0.89

0.87

Scmap: ARI:0.926 NMI:0.902 F1:0.966
0.97

0.98
0.81

SLC16A7+ epithelial

uncharacierized
0.98

1.00

UMAP2

0.96

0.97

0.28

0.83

0.11

SLC16A7

1.00

0.98

MAB21L3
0.95

0.97

UMAP1

UMAP1

g

0.17

0.6

TMEM212

0.94

0.94

IKZF3

0.99

0.99

CCDC142

0.92

0.97

0.18

0.97
0.33

0.11

0.58

SLC31A1

0.97
0.94

0.67

0.2

KREMEN1
ZNF793

0.67

CYP20A1

tiv
ac

a

_e
de r
lta
un en duc
ch do ta
ar the l
ac li
te al
riz
ep ed
si
lo
m
n
ac
ro
qu
p
ie
ha
sc
ge
en
t_ ma
st s
el t
l
sc at
hw e
an
n

at

SL

m

m

ta

ed ac
_s in
te ar
lla
al te
ph
be a
t
de a
en du lta
do ct
th al
ep elia
l
m ga silo
ac m n
qu
ro m
ie
ph a
sc
ag
en
t_ ma e
st s
e
sc lla t
hw te
an
n
ac
tiv
at
ed ac
_s in
te ar
lla
al te
ph
be a
t
de a
en du lta
do ct
th al
ep elia
l
m ga silo
ac m n
qu
ro m
ie
ph a
sc
ag
en
t_ ma e
st s
e
sc lla t
hw te
an
n

ta

be

ga

be

0.87

0.95

C
16
A7
ed ac +
_s ina
te r
lla
t
a e
al lph
ph a
a_
er

0.18

0.89

0.4

TFDP2

0.71

0.82

tiv
ac

bronchial epithelium

pancreas

0.12
0.99

1.00

Conos: ARI:0.936 NMI:0.901 F1:0.963
acinar
activated_stellate
alpha
beta
delta
ductal
endothelial
epsilon
gamma
macrophage
mast
quiescent_stellate
schwann

f

0.98

0.99

at

Prediction

SCALEX: ARI:0.972 NMI:0.951 F1:0.984
acinar
activated_stellate
alpha
beta
delta
ductal
endothelial
epsilon
gamma
macrophage
mast
quiescent_stellate
schwann

UMAP2

c

Cell-type

d

SCALEX PBMC

Projected: SKCM_GSE72056

NK

NK

CD8 naive T
CD4 T
CD4 naive T

UMAP2

DC
monocyte-CD14
monocyte-FCGR3A
UMAP1

B

Treg

CD8 T
naive T
CD8 naive T
CD4 T
Treg Tfh
CD4 naive T

naive T
Tfh
Treg

naive T
pDC

endothelial
tumor
CAF

B

pDC

tumor
osteoclast

plasma

macrophage
DC
macrophage

SCALEX PBMC + Projected
NK

CD8 T
Tfh

pDC

e

NK

CD8 T

CD8 T

HSC
Megakaryocyte

Projected: SKCM_GSE123139

DC
monocyte-CD14
monocyte-FCGR3A

B

pDC

tumor plasma
endothelial
HSC osteoclast
CAF
Megakaryocyte
DC
macrophage
monocyte-CD14
monocyte-FCGR3A

B

Fig 4
a

c

20000

Smart-seq2

SCALEX mouse atlas

12500
10000
7500
5000

Number of Cells

17500
10X
bioRxiv preprint doi:Microwell-seq
https://doi.org/10.1101/2021.04.06.438536; this
version posted April 8, 2021. The copyright holder for this preprint (which
15000
urothelial
was not certified by peer review) is the author/funder.
All rights reserved. No reuse allowed
without permission.

stomach

hepatocyte

2500

UMAP2

mesenchymal stem

tissue

Aorta
Bladder
BoneMarrow
Brain
Brain_Myeloid
Brain_Non-Myeloid
Diaphragm
Fat
Heart
Heart_and_Aorta
Kidney
Large_Intestine
Limb_Muscle
Liver
Lung
Mammary_Gland
Marrow
Muscle
Ovary
Pancreas
PeripheralBlood
Prostate
Skin
SmallIntestine
Spleen
Stomach
Testis
Thymus
Tongue
Trachea
Uterus

10X
Smart-seq2
Microwell-seq

mesenchymal

pro-B

B

Kupffer cell
dendritic

UMAP2

batch

hepatic sinusoid

stromal

bladder
fibroblast

0

Aorta
Bladder
BoneMarrow
Brain
Brain_Myeloid
Brain_Non-Myeloid
Diaphragm
Fat
Heart
Heart_and_Aorta
Kidney
Large_Intestine
Limb_Muscle
Liver
Lung
Mammary_Gland
Marrow
Muscle
Ovary
Pancreas
PeripheralBlood
Prostate
Skin
SmallIntestine
Spleen
Stomach
Testis
Thymus
Tongue
Trachea
Uterus

b

uterus
endothelial

small intestine
large intestine
secretory alveoli
luminal

myofibroblast

myeloid

keratinocyte

basal of epidermis

pancreatic ductal
keratinocyte stem
acinar AT2
collecting duct
T
skeletal muscle satellite
cardiac muscle
immature T
basal
neuron
ovary
oligodendrocyte precursor
monocyte progenitor
astrocyte
multipotent progenitor
leydig

proximal tubule

granulocyte

erythroblast

sperm
pancreatic endocrine

microglial

oligodendrocyte

UMAP1

UMAP1

d Projected: tabula_muris_senis_smartseq2

Projected: tabula_muris_senis_10X

Projected: mouse_kidney

Projected: mouse_lung

proximal tubule

UMAP2

AT2

UMAP1

e

Projected: tabulas_muris_senis_10x

ARI:0.905 NMI:0.905 F1:0.871

ARI:0.886 NMI:0.900 F1:0.907

Projected: mouse_lung
ARI:0.885 NMI:0.843 F1:0.863

1.00

0.99

AT2 0.48
0.99

0.98

B

0.83

0.85

0.99

0.98

0.98

T

0.76
1.00

0.99

0.83

0.66

granulocyte

0.75

0.99

1.00

0.13

luminal 0.51

0.99

0.96

0.41

0.92

0.65

0.99

0.78

stromal

1.00
0.21

0.97
0.96

en
do T
t
gr hel
ia
an
l
ul
oc
yt
e
lu
m
in
m al
ye
lo
i
st d
ro
m
al

B

AT
2
0.98

0.29

0.68

0.61 0.34

0.87

0.99

1.00

0.88

0.93

Projected: mouse_kidney
ARI:0.949 NMI:0.911 F1:0.939

0.40

0.99
0.83

0.22

0.12

0.99

0.98

0.11

myeloid

0.81

0.97

0.13

0.18
0.44

0.98

0.10

0.99

0.31
0.98

0.97

1.00

endothelial
0.86

0.97

Prediction

0.48

0.99 0.11

0.88
0.83

0.99

B

0.57

0.32

0.8

0.6

0.99

0.51

0.15 0.97
0.14

T

0.39 0.14 0.91

0.93

1.00

0.87

1.00

collecting duct

0.95

0.88

1.00

1.00

1.00

0.99

0.94

endothelial

0.93

0.94

0.4
1.00

mesenchymal stem

0.96

0.2

0.95

myeloid

0.60

T

do
th
e
ch
ym lial
al
st
em
m
pr
ye
ox
lo
im
id
al
tu
bu
le

ct
du

in
g

en

ct

Ku A
pf T2
fe
r B
a ce
l o stro ll
f e cy T
co pid baste
lle b ermal
c l
e tin ad is
er ndog dder
yt th uc
h e t
he g fibrob lia
pa ra roblas l
tic nu la t
he sinlocy st
ke im patusote
ra ke ma oc id
tin ra tu yte
la oc tino re
rg yt c T
e e y
m
es m int stete
en es l es m
u t
m
c
on hyenc miine
oc m hy na
yt m al mal
e ic st l
pr ro em
o g
o my ge lia
paligo ofi my nito l
b e
d
n
pa
c e r lo r
nc rea nd oblaid
sk
r
el rea tic ocy st
et p tic du te
al ro e
c
m xi nd protal
us m o -B
cl al cri
e tu ne
sa b
st telule
o li
s m te
ur troach
ot m
he al
lia
l
Ku A
pf T2
fe
rcB
ba
sa as ell
l o tro
f e cy T
co pid baste
lle b ermal
c l
e tin ad is
er ndog dder
yt th uc
h e t
he g fibrob lia
pa ra roblas l
tic nu la t
he sinlocy st
ke im patusote
ra ke ma oc id
tin ra tu yt
la oc tino re e
rg yt c T
e e y
m
es m int stete
e e e m
m nc senlumstin
on hy c i e
oc m hy na
yt m al mal
e ic st l
pr ro em
o g
o my ge lia
paligo ofi my nito l
pa nc de broelo r
nc rea nd blaid
sk
r
el rea tic ocy st
et p tic du te
al ro e
c
m xi nd protal
us m o -B
cl al cri
e tu ne
sa b
st telule
o li
s m te
ur troach
ot m
he al
lia
l
sa

ba

Cell-type

1.00

en

1.00

0.98

0.99

proximal tubule

es

0.93

0.97

m

0.10

B

1.00

lle

0.96

co

AT2
B
Kupffer cell
T
astrocyte
basal
basal of epidermis
bladder
collecting duct
endothelial
erythroblast
fibroblast
granulocyte
hepatic sinusoid
hepatocyte
immature T
keratinocyte
keratinocyte stem
large intestine
luminal
mesenchymal
mesenchymal stem
microglial
monocyte progenitor
myeloid
myofibroblast
oligodendrocyte
pancreatic ductal
pancreatic endocrine
pro-B
proximal tubule
skeletal muscle satellite
stomach
stromal
urothelial

Projected: tabulas_muris_senis_smartseq2

0.0

Fig 5
a

b

c

batch

d

cell-type

mild/moderate

healthy control

severe

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
NK reserved. No reuse allowed without permission.
was not certified by peer review) is the author/funder. All rights
healthy control (n=31)
CD8 T

PRDM1-Plasma

B

Pro T

MZB1-Plasma

mild/moderate (n=46)
UMAP2

UMAP2

pDC

convalescent (n=12)

GSE149689
GSE150728
GSE150861
GSE154567
HRA000150
00803_MGH_Broad
AirwayWash-PBMC
EGAS00001004571_10X
EGAS00001004571_BD_Rhapsody
immunodeficiency_PMBCs

convalescent

influenza
B
CD4 T
CD8 T
Pro T
CD14-CD16-Mono
CD14-IL1B-Mono
CD14-IL32-Mono
CD14-ISG15-Mono
CD14-PPBP-Mono
CD16-Mono
Eosinophil

Progenitor
Megakaryocyte

UMAP1

UMAP1

influenza (n=5)

CD4 T

mDC
CD14-IL1B-Mono
CD16-Mono
Neutrophil
CD14-CD16-Mono
CD14-ISG15-Mono
NCF1-Immature_Neutrophil
CD14-IL32-Mono
PNPLA2-Immature_Neutrophil
Erythrocyte

UMAP2

severe (n=50)

Eosinophil
CD14-PPBP-Mono

Erythrocyte
Megakaryocyte
NK
Neutrophil
NCF1-Immature_Neutrophil
PNPLA2-Immature_Neutrophil
MZB1-Plasma
PRDM1-Plasma
Progenitor
mDC
pDC

UMAP1

f

ISG15

IFI27

MX1

h

0.2

0.4

CD14-ISG15-Mono
(severe)

CD14-IL1B-Mono

CD14-ISG15-Mono
(mild/moderate)

0.0

6

0

neutrophil chemotaxis
regulation of ERK1 and ERK2 cascade
positive regulation of cell proliferation
positive regulation of cell motility
regulation of cell proliferation
regulation of cell migration
lymphocyte chemotaxis
positive regulation of leukocyte chemotaxis
cellular response to cytokine stimulus
cytokine-mediated signaling pathway
6

12

18

24

30

36

Projected: SC4 atlas

Megakaryocyte

PRDM1-Plasma
MZB1-Plasma

CD4 T

CD14-IL1B-Mono

Pro T

CD14-PPBP-Mono
mDC
CD8 T
CD16-Mono
Eosinophil
Neutrophil CD14-CD16-Mono
CD14-IL32-Mono
Megakaryocyte
NK
Progenitor
CD14-ISG15-Mono

UMAP2

10

2.5

8

30

2.0

2.0

20

1.5

1.5

1.0

1.0

0.5

0.5

0.0

0.0

10

4
2
0
MZB1-Plasma

Megakaryocyte

4

4

2.0

3

1.5

2

1.0

2

1

0.5

1

0

0.0

***

3

***

healthy control
mild/moderate
severe
convalescent
influenza

***

0
pDC

Pro T

42

6

NCF1-Immature_Neutrophil

CD14-ISG15-Mono

pDC

Erythrocyte

UMAP1

mDC

B
PRDM1 Plasma
MZB1 Plasma
CD4 T
CD8 T
Pro T
NK
CD14-IL1B Mono
CD14-ISG15 Mono
CD14-PPBP Mono
CD14-IL32 Mono
CD14-CD16 Mono
CD16 Mono
mDC
pDC
Neutrophil
NCF1 Immature Neutrophil
PNPLA2 Immature Neutrophil
Megakaryocyte
Eosinophil
Erythrocyte
Progenitor

B_c01-TCL1A

Mono_c1-CD14-CCL3

T_CD4_c08-GZMK-FOS_h

B_c02-MS4A1-CD27

Mono_c2-CD14-HLA-DPB1

T_CD4_c09-GZMK-FOS_l

B_c03-CD27-AIM2

Mono_c3-CD14-VCAN

T_CD4_c10-IFNG

B_c04-SOX5-TNFRSF1B

Mono_c4-CD14-CD16

T_CD4_c11-GNLY

B_c05-MZB1-XBP1

Mono_c5-CD16

T_CD4_c12-FOXP3

B_c06-MKI67

NK_c01-FCGR3A

T_CD4_c13-MKI67-CCL5_l

DC_c1-CLEC9A

NK_c02-NCAM1

T_CD4_c14-MKI67-CCL5_h

DC_c2-CD1C

NK_c03-MKI67

T_CD8_c01-LEF1

DC_c3-LAMP3

Neu_c1-IL1B

T_CD8_c02-GPR183

DC_c4-LILRA4

Neu_c2-CXCR4(low)

T_CD8_c03-GZMK

Epi-AT2
Epi-Ciliated
Epi-Secretory
Epi-Squamous
Macro_c1-C1QC

Neu_c3-CST7

T_CD8_c04-COTL1

Neu_c4-RSAD2

T_CD8_c05-ZNF683

SCALEX COVID-19 PBMC atlas + SC4 atlas
PNPLA2-Immature_Neutrophil
NCF1-Immature_Neutrophil

B

PRDM1-Plasma
MZB1-Plasma

Neu_c5-GSTP1(high)OASL(low)

T_CD8_c06-TNF

Neu_c6-FGF23

T_CD8_c07-TYROBP

T_CD4_c01-LEF1

T_CD8_c08-IL2RB

Macro_c2-CCL3L1

T_CD4_c02-AQP3

T_CD8_c09-SLC4A10

Macro_c3-EREG

T_CD4_c03-ITGA4

T_CD8_c10-MKI67-GZMK

Macro_c4-DNAJB1

T_CD4_c04-ANXA2

T_CD8_c11-MKI67-FOS

Macro_c5-WDR74

T_CD4_c05-FOS

T_CD8_c12-MKI67-TYROBP

Macro_c6-VCAN

T_CD4_c06-NR4A2

T_CD8_c13-HAVCR2

Mast
Mega

T_CD4_c07-AHNAK

T_gdT_c14-TRDV2

CD14-IL1B-Mono

0.910.85

Pro T

CD14-PPBP-Mono
mDC
CD8 T
CD16-Mono
Eosinophil
Neutrophil CD14-CD16-Mono
CD14-IL32-Mono

CD14-ISG15-Mono

0.55
0.960.97

0.510.550.60

CD4 T

Epi-Squamous

0.990.980.970.97
0.520.520.54

Megakaryocyte
pDC

Megakaryocyte
Epi
Progenitor

Macro

NK

Erythrocyte

1.0

0.66
0.61

0.540.53
0.950.970.950.950.970.870.870.780.860.78

0.58

0.53

0.510.620.560.830.770.94

0.57

0.740.64

0.750.970.87
0.510.55

0.54

0.52

0.55

0.66

0.65

0.88

0.9

0.870.88
0.61

0.740.910.980.680.980.830.82
0.960.930.960.730.600.720.94
0.760.920.840.61

0.73

0.510.560.59

0.58

0.61

0.610.950.940.920.870.760.76

0.920.950.85

0.52

0.670.770.790.660.500.63

0.57

0.66

0.730.59

0.720.78

0.760.60

0.580.640.720.62

0.78

0.740.680.580.750.63

0.72

0.8

0.510.56
0.93
0.650.900.900.850.590.90

0.690.610.580.77

0.640.890.980.680.680.68

0.670.690.57

0.560.690.59

0.850.870.53

0.590.670.81

0.770.750.780.740.630.57

0.530.56

0.80

0.520.53

0.52

0.7
0.98

0.56

0.970.910.870.880.80

0.75

0.50

0.740.550.63

0.56

0.6

0.56
0.94
0.57

0.570.51
0.51

0.72

0.570.54

0.61
0.56

0.650.690.60
0.62

0.650.570.59

0.5

B_c01-TCL1A
B_c02-MS4A1-CD27
B_c03-CD27-AIM2
B_c04-SOX5-TNFRSF1B
B_c05-MZB1-XBP1
B_c06-MKI67
T_CD4_c01-LEF1
T_CD4_c02-AQP3
T_CD4_c03-ITGA4
T_CD4_c04-ANXA2
T_CD4_c05-FOS
T_CD4_c06-NR4A2
T_CD4_c07-AHNAK
T_CD4_c08-GZMK-FOS_h
T_CD4_c12-FOXP3
T_CD4_c09-GZMK-FOS_l
T_CD4_c10-IFNG
T_CD4_c11-GNLY
T_CD4_c13-MKI67-CCL5_l
T_CD4_c14-MKI67-CCL5_h
T_CD8_c13-HAVCR2
T_CD8_c01-LEF1
T_CD8_c02-GPR183
T_CD8_c03-GZMK
T_CD8_c04-COTL1
T_CD8_c05-ZNF683
T_CD8_c06-TNF
T_CD8_c09-SLC4A10
T_CD8_c10-MKI67-GZMK
T_CD8_c11-MKI67-FOS
T_CD8_c12-MKI67-TYROBP
T_CD8_c07-TYROBP
T_CD8_c08-IL2RB
T_gdT_c14-TRDV2
NK_c01-FCGR3A
NK_c02-NCAM1
NK_c03-MKI67
Mono_c1-CD14-CCL3
Mono_c3-CD14-VCAN
Mono_c2-CD14-HLA-DPB1
Mono_c4-CD14-CD16
Mono_c5-CD16
Macro_c4-DNAJB1
Macro_c5-WDR74
Macro_c1-C1QC
Macro_c3-EREG
Macro_c6-VCAN
Macro_c2-CCL3L1
DC_c2-CD1C
DC_c1-CLEC9A
DC_c3-LAMP3
DC_c4-LILRA4
Neu_c5-GSTP1(high)OASL(low)
Neu_c3-CST7
Neu_c1-IL1B
Neu_c2-CXCR4(low)
Neu_c6-FGF23
Neu_c4-RSAD2
Mast
Mega
Epi-Squamous
Epi-AT2
Epi-Secretory
Epi-Ciliated

SCALEX COVID-19 PBMC atlas

3.0

2.5

***

0

PNPLA2-Immature_Neutrophil
NCF1-Immature_Neutrophil

i

3.0

40

-log10(Adjusted P-value)

SCALEX COVID-19 PBMC atlas

B

**

Frequency

complement activation, classical pathway
regulation of immune effector process
regulation of complement activation
regulation of humoral immune response
regulation of acute inflammatory response
regulation of B cell activation
positive regulation of lymphocyte activation
B cell receptor signaling pathway
phagocytosis
positive regulation of B cell activation
type I interferon signaling pathway
cellular response to type I interferon
negative regulation of viral genome replication
negative regulation of viral life cycle
Median expression
regulation of viral genome replication
in group

IFITM1

g

CD14-IL1B-Mono vs CD14-ISG15-Mono

Frequency

e

B

Plasma

CD4 T

NK

CD8 T

Monocyte Macrophage

DC

Neutrophil

Epithelial

SC4 atlas
Cytokines score

j

healthy control

UMAP1

mild/moderate

0.6

0.6

severe

0.6

k

IGKC-Mega vs TUBA8-Mega

0.5

0.5

0.5

0.4

0.4

0.4

nucleosome assembly

0.3

0.3

0.3

nucleosome organization

0.2

0.2

0.2

regulation of blood coagulation

0.1

0.1

0.1

negative regulation of blood coagulation

0.0

0.0

negative regulation of platelet activation

0.0

protein-DNA complex assembly

positive regulation of respiratory burst

Inflammatory score
healthy control

mild/moderate

2.5

2.5

severe

humoral immune response mediated by circulating immunoglobulin

2.5

antigen receptor-mediated signaling pathway
2.0

2.0

1.5

1.5

1.0

1.0

0.5

0.5

0.5

0.0

0.0

0.0

1.5

UMAP2

1.0

UMAP1

UMAP2

2.0

complement activation, classical pathway
phagocytosis, engulfment
plasma membrane invagination
8

6
4
2
0
2
-log10(Adjusted P-value)

Supplementary Fig 1
pancreas

heart

liver

PBMC

NSCLC

UMAP2

scVI

Scanorama

BBKNN

Conos

MNN

Harmony

Seurat

SCALEX

raw

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

UMAP1
pancreas_indrop1
pancreas_indrop2
pancreas_indrop3
pancreas_indrop4
pancreas_celseq
pancreas_celseq2
pancreas_fluidigmc1
pancreas_smartseq2

acinar
activated_stellate
alpha
alpha_er
beta
beta_er
delta
ductal
endothelial
epithelial
epsilon
gamma
macrophage
mast
quiescent_stellate
schwann

Harvard-Nuclei
Sanger-Nuclei

Adipocytes
Atrial_Cardiomyocyte
Endothelial
Fibroblast
Lymphoid
Mesothelial
Myeloid
Neuronal
Pericytes
Smooth_muscle_cells
Ventricular_Cardiomyocyte

LIVER_GSE115469
LIVER_GSE124395

B
NK-GNLY_high
NK-GNLY_low
T
cholangiocytes
endothelial
erthyroid
hepatocyte-CXCL1_high
hepatocyte-CYP2A13_high
hepatocyte-GSTA1_high
hepatocyte-SCD_high
hepatocyte-TAT-AS1_high
kupffer
mature B
stellate

NSCLC_EMTAB6149
NSCLC_GSE117570
NSCLC_GSE127465
NSCLC_GSE131907

B
CD4T
CD8T
Endothelial
Fibroblasts
M1
M2
Mast
Monocyte
NK
Neutrophils
Oligodendrocytes
Plasma
pDC
tumor clone 1
tumor clone 2
tumor clone 3
tumor clone 4
tumor clone 5
tumor clone 6
tumor clone 7

pbmc_3p
pbmc_5p

B
CD4 T
CD4 naive T
CD8 T
CD8 naive T
DC
HSC
Megakaryocyte
NK
monocyte-CD14
monocyte-FCGR3A
pDC

Supplementary Fig 2
bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

a

b

UMAP2

GSE156793

batch

Acinar cells
Adrenocortical cells
Alveolar cells
Cardiomyocytes
Chromaffin cells
Endocrine cells
Endothelial cells
Erythroblasts
Extravillous trophoblasts
Eye cells
Goblet cells
Hepatoblasts
Intestinal epithelial cells
Mesangial cells
Metanephric cells
Myeloid cells
Skeletal muscle cells
Stromal cells
T

0.9
0.8
0.7
0.6
0.5
0.4
0.3

Ad
re A
no c
co ina
r r
C Alv tica ce
ar e l lls
C dio ola ce
hr m r lls
E om yo cel
Ex
E ndo aff cy ls
tra ndo cri in c tes
n e
vi
llo E thel e c lls
us ryt ial ell
tro hro ce s
ph bla lls
In
o s
te
E bl ts
st
in HGobye asts
al e l c
M ep pa et cells
et ith to e
Sk ane eli bla lls
el M ph al c sts
et y r e
al e ic lls
m loi ce
St usc d c lls
ro le ell
m ce s
al ll
ce s
lls
T

GSE156793
GSE134355

1.0

UMAP1

GSE134355

c

Total runtime

Maximum memory usage

10

Memory(GB)

Time(h)

100

1

0.1

10

SCALEX
Seurat v3
Harmony
MNN
Conos
BBKNN
Scanorama
scVI

1

0.01

10K 50K

250K

Number of Cells

1M

10K 50K

1M

250K

Number of Cells

Supplementary Fig 3

stellate

mature B

kupffer

hepatocyte-CXCL1
hepatocyte-CYP2A13
hepatocyte-GSTA1
hepatocyte-SCD
hepatocyte-TAT-AS1

erthyroid

endothelial

cholangiocytes

T

NK-GNLY_low

NK-GNLY_high

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

B

a

B
NK-GNLY_high
NK-GNLY_low
T
cholangiocytes
endothelial
erthyroid
hepatocyte-CXCL1
hepatocyte-CYP2A13
hepatocyte-GSTA1
hepatocyte-SCD
hepatocyte-TAT-AS1
kupffer
mature B
stellate

Fraction of cells
in group (%)

20 40 60 80 100

RBP1

ACTA2

COL1A1

CD79B

LTB

CD37

MS4A1

MAFB

VSIG4

CD163

SCD

TAT-AS1

GSTA1

CXCL1

CYP2A13

CA1

ALAS2

HBB

LIFR

FLT1

TM4SF1

DNASE1L3

KRT7

KRT18

EPCAM

TRAC

CD2

CD3D

GNLY

KLRD1

NKG7

GNLY

KLRD1

NKG7

IGKC
UMAP2

b

MZB1

Mean expression
in group
0.0

0.5

cell-type

batch

B
NK-GNLY_high
NK-GNLY_low
T
cholangiocytes
endothelial
erthyroid
hepatocyte-CXCL1
hepatocyte-CYP2A13
hepatocyte-GSTA1
hepatocyte-SCD
hepatocyte-TAT-AS1
kupffer
mature B
stellate

GSE115469
GSE124395

UMAP1

c

UMAP2

CXCL1

UMAP1

1.0

CYP2A13

1.0

GSTA1

1.0

SCD

1.0

TAT-AS1

1.0

0.8

0.8

0.8

0.8

0.8

0.6

0.6

0.6

0.6

0.6

0.4

0.4

0.4

0.4

0.4

0.2

0.2

0.2

0.2

0.2

0.0

0.0

0.0

0.0

0.0

Supplementary Fig 4

UMAP2

Overlap_0

Overlap_1

Overlap_2

Overlap_3

Overlap_4

Overlap_5

Overlap_6

v3 posted April 8, 2021. The copyright holder
Harmony
bioRxiv preprintSCALEX
doi: https://doi.org/10.1101/2021.04.06.438536; Seurat
this version
for this preprint (which
was not certified
by peer review) is the author/funder.
All rightscell-type
reserved. No reuse allowedbatch
without permission. cell-type
batch
cell-type
batch

UMAP1

pancreas_celseq
pancreas_smartseq2

acinar
alpha
beta
delta
ductal
gamma

Supplementary Fig 5

UMAP2

Overlap_0

Overlap_1

Overlap_2

Overlap_3

Overlap_4

Overlap_5

Overlap_6

SCALEX
Seurat
Harmony
bioRxiv preprint doi:
https://doi.org/10.1101/2021.04.06.438536; this
versionv3
posted April 8, 2021. The copyright holder
for this preprint (which
by peer review) is the author/funder.
All rights cell-type
reserved. No reuse allowed without
batch was not certified
batch permission. cell-type
cell-type
batch

UMAP1

pbmc_3p
pbmc_5p

B
CD4 T
CD4 naive T
CD8 T
CD8 naive T
DC
HSC
Megakaryocyte
NK
monocyte-CD14
monocyte-FCGR3A
pDC

Supplementary Fig 6
bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version posted April 8, 2021. The copyright holder for this preprint (which
batch
was
not certified by peer review)
is the author/funder. All rights
b reserved. No reuse allowed without permission.
epithelium_donor1

pancreas_celseq
pancreas_celseq2
pancreas_fluidigmc1
pancreas_GSE81547
pancreas_GSE83139
pancreas_GSE114297
pancreas_indrop1
pancreas_indrop2
pancreas_indrop3
pancreas_indrop4
UMAP1

pancreas_smartseq2

0.8

0.6

0.4

0.2

CPA1
COL1A1
GCG
PPP1R15A
INS
DDIT3
SST
KRT19
FLT1
SLC16A7
GHRL
PPY
CD68
KIT
RGS5
NGFR

epithelium_donor3

acinar
activated_stellate
alpha
alpha_er
beta
beta_er
delta
ductal
endothelial
epithelial
epsilon
gamma
macrophage
mast
quiescent_stellate
schwann

cell-type

epithelium_donor2

UMAP2

a

0.0

100%
80%
60%
40%
20%

c
hepatocyte

pancreatic ductal
pancreatic endocrine
pro-B
proximal tubule
secretory alveoli
skeletal muscle satellite
small intestine

AT2

proximal tubule

collecting duct

sperm

leydig

multipotent progenitor
myeloid
myofibroblast
neuron
oligodendrocyte
oligodendrocyte precursor
ovary

pancreatic endocrine

neuron

acinar

ovary

cardiac muscle

oligodendrocyte precursor

large intestine
leydig
luminal
mesenchymal
mesenchymal stem
microglial
monocyte progenitor

astrocyte

oligodendrocyte

immature T

T

multipaaotent progenitor

fibroblast
granulocyte
hepatic sinusoid
hepatocyte
immature T
keratinocyte
keratinocyte stem

erythroblast

monocyte progenitor

granulocyte

pro-B

B

basal of epidermis
bladder
cardiac muscle
collecting duct
dendritic
endothelial
erythroblast

dendritic

Kupffer cell

myeloid

microglial

AT2
B
Kupffer cell
T
acinar
astrocyte
basal

hepatic sinusoid

endothelial

keratinocyte

UMAP2

Smart-seq2
10X
Microwell-seq

basal of epidermis

urothelial

keratinocyte stem

basal

secretory alveoli

luminal

pancreatic ductal

small intestine

large intestine

stomach

skeletal muscle satellite

myofibroblast

mesenchymal stem

fibroblast

bladder

stromal

uterus

mesenchymal

a

Mgp
Sparc
Bgn
Serpinh1
Gsn
Dcn
Col1a2
Col6a1
Col1a1
Sparc
Mgp
Bgn
Gsn
Igfbp7
Sod3
Col1a2
Dcn
Col3a1
Serping1
Col1a1
Gsn
Serping1
Dcn
Igfbp7
Mgp
Serpinf1
Serping1
Dpt
Rnase4
Ctsl
Cald1
Sparcl1
Sparc
Myl9
Igfbp7
Gpx3
Sdc4
Cd63
Mt2
Cebpd
Fxyd3
Car2
Gsto1
Krt8
Gsta4
Epcam
Krt8
Lgals4
Cldn7
Cldn3
Krt8
Lgals4
Cox6b1
Cldn7
Cox7b
Clu
Spp1
Krt8
Krt18
Apoe
Krt8
Krt18
Krt19
Epcam
Spint2
Rpl26
Krt18
Ly6e
Krt8
Rpl14
Acta2
Apoe
Krt14
Tpm2
Tagln
Krt5
Perp
Apoe
Krt15
Lgals7
Gsta4
Wfdc2
Gstm1
Ly6d
Krt7
Lmna
Lgals7
Cd9
Krt5
Perp
Lgals7
S100a14
Dmkn
Perp
Sfn
Esam
Egfl7
Ly6c1
Eng
Pecam1
Dnase1l3
Igfbp7
Clec4g
Ehd3
Aqp1
Hexb
C1qb
C1qa
C1qc
Ctsd
Tyrobp
Ctss
Fcer1g
Tmsb4x
Laptm5
B2m
Tmsb4x
Apoe
Tyrobp
Fth1
Tmsb4x
B2m
Cd74
Rpl26
Fth1
Cd74
Cd79a
H2-Ab1
H2-Aa
H2-Eb1
Vpreb3
Cd79a
Ptprcap
Cd79b
Cd24a
S100a9
S100a8
Pglyrp1
Tmsb4x
Hp
Plac8
Prtn3
Mpo
Ctsg
Gpx1
Car2
Stmn1
Atpif1
Car1
Tuba1b
Cmtm7
Lmo2
H2afy
Ctla2a
Ptprcap
B2m
Cd52
Tmsb4x
Coro1a
Rac2
Lat
Cd3g
Dntt
Lck
Coro1a
Plp1
Cldn11
Cnp
Aplp1
Gatm
Ckb
Apoe
Aldoc
Clu
Ndrg2
Ckb
Pllp
Gpm6b
Gpr37l1
Cpe
Slc25a4
Cryab
Cox6a2
Tpm1
Cox7a1
Rpl26
Akr1cl
Rpl34
Rpl41
Rps27
Cela2a
Zg16
Cela1
Prss2
Ctrb1
Rtn1
Ckb
Ttc3
Bex2
Stmn3
Chga
Pcsk2
Cpe
Scg5
Scg2
Insl3
Meig1
Ptgds
Ldhc
Lcn2
Meig1
Ldhc
Fabp9
Ropn1l
Gm5617
Atp1b1
Ldhb
Atp1a1
Fxyd2
Chchd10
Fxyd2
Aldob
Gpx3
Miox
Akr1c21
Sftpc
Sftpa1
Sftpb
Sftpd
Cxcl15
Serpina1c
Apoa2
Serpina1b
Serpina1a
Apoc3

Supplementary Fig 7
b
bioRxiv preprint doi:
https://doi.org/10.1101/2021.04.06.438536
this version posted April mouse
8, 2021.
for this
preprint
(which
mouse atlas ;Smart-seq2
atlas
Microwell-seq
atlasThe
10X copyright holdermouse
batch
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

sperm
stomach
stromal
urothelial
uterus

UMAP1

mesenchymal
uterus
stromal
bladder
fibroblast
mesenchymal stem
myofibroblast
skeletal muscle satellite
stomach
large intestine
small intestine
pancreatic ductal
luminal
secretory alveoli
basal
keratinocyte stem
urothelial
basal of epidermis
keratinocyte
endothelial
hepatic sinusoid
microglial
myeloid
Kupffer cell
dendritic
B
pro-B
granulocyte
monocyte progenitor
erythroblast
multipotent progenitor
T
immature T
oligodendrocyte
astrocyte
oligodendrocyte precursor
cardiac muscle
ovary
acinar
neuron
pancreatic endocrine
leydig
sperm
collecting duct
proximal tubule
AT2
hepatocyte

20 40 60 80100

Fraction of cells
in group (%)

0.0

Mean expression
in group
0.5

Supplementary Fig 8
a

bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536; this version
holder for this preprint (which
b posted April 8, 2021. The copyright
batch
was not certified by peer review) is the author/funder.
All rights reserved. No reuse allowed
without permission.
GSE134355
GSE159929

UMAP2

Adipose
AdrenalGland
Artery
Bladder
Blood
BoneMarrow
Cerebellum
Cervix
Colon
Duodenum
Epityphlon
Esophagus
Fallopiantube
Gallbladder
Heart
Ileum
Kidney
Liver
Lung
Lymph.node
Marrow
Muscle
Omentum
Pancreas
Pleura
Prostate
Rectum
Skin
Small.intestine
Spleen
Stomach
TemporalLobe
Thyroid
Trachea
Ureter
Uterus

GSE134355
GSE159929

c

5000

batch

10000 15000 20000 25000

d

cell-type
Neuron
Melanocyte

Fasciculata cell
Fibroblast Macrophage
Smooth muscle cell
Chondrocyte
Pancreas exocrine
Endothelial
Dendritic cell
Thyroid follicular cell
Mast cell
Neutrophil Monocyte
Sinusoidal endothelial
Alveolar cell
Loop of Henle
Erythroid cell
Epithelial
T
Keratinocyte
Basal cell
B
Enterocyte progenitor
Plasma

UMAP1

Enterocyte

Goblet cell
Gastric chief cell

UMAP1

B
Basal cell
Endothelial
Enterocyte
Enterocyte progenitor
Epithelial
Erythroid cell
Fasciculata cell
Fibroblast
Goblet cell
Keratinocyte
Macrophage
Mesothelial cell
Monocyte
Neuron
Pancreas exocrine
Plasma
Sinusoidal endothelial
Smooth muscle cell
T

1.0

0.9

0.8

0.7

0.6

0.5

Al
ve
ol
ar
C Ba ce
ho s ll
D
En
en nd al c B
d ro e
te
ro En riti cy ll
cy E do c c te
te nt th el
pr er el l
og oc ial
FaEry Ep eniyte
sc thr ith tor
G icu oidelia
as F la c l
tri ib ta ell
c ro ce
Lo G chiebla ll
op ob f c st
M o let el
a f c l
M cro He ell
es M p nl
ot a ha e
he s ge
M liat ce
Pa
on l c ll
Si ncr N N ocyell
nu ea e e te
u u
Smsoid s e tro ron
xo ph
o a
Th othl en Pl crin il
yr m do asme
oi
u
s th a
d
fo cleelia
llic c l
ul ell
ar T
ce
ll

UMAP2

UMAP2

Mesothelial cell

GSE134355
GSE159929

UMAP1

GSE159929

0

GSE134355

Neuron
Melanocyte
Mesothelial cell
Fibroblast
ChondrocyteFasciculata cell
Smooth muscle cell
Macrophage
Endothelial Pancreas exocrine

NeutrophilDendritic cell Alveolar cell
Thyroid follicular cell
Monocyte
Mast cell
Sinusoidal endothelial
Loop of Henle
Erythroid cell
T
Basal cell Epithelial
Keratinocyte
B

UMAP2

Enterocyte progenitor
Plasma
Goblet cell
Enterocyte Gastric chief cell

UMAP1

Projected: skin_GSE130973

Projected: skin_GSE147424

Erythroid cell
Fibroblast
Keratinocyte
Basal cell
Endothelial
Dendritic cell
Macrophage
Melanocyte
Neuron
Smooth muscle cell
Epithelial
T
Alveolar cell
B
Chondrocyte
Enterocyte
Enterocyte progenitor
Fasciculata cell
Gastric chief cell
Goblet cell
Loop of Henle
Mast cell
Mesothelial cell
Monocyte
Neutrophil
Pancreas exocrine
Plasma
Sinusoidal endothelial
Thyroid follicular cell

Projected: human_skin
1.00
0.89
0.31
0.48
0.88 0.71
0.54
0.31

0.8

0.21
0.40
0.85
0.68
0.11

0.92

0.16

0.6

0.4

0.2

0.0

Erythrocytes
Fibroblasts
Keratinocytes
Vascular endothelial cells
Lymphatic endothelial cells
Macrophages/Dendritic cells
Melanocytes
Pericytes/vSMC
Sweat gland cells
T cells

SCALEX human atlas

f

Prediction

e

Cell-type

Supplementary Fig 9
a

condition

leiden

batch
bioRxiv preprint
doi: https://doi.org/10.1101/2021.04.06.438536
b ; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.
2

1

00803_MGH_Broad
AirwayWash-PBMC
EGAS00001004571_10X
EGAS00001004571_BD_Rhapsody
GSE149689
GSE150728
GSE150861
GSE154567
HRA000150
immunodeficiency_PMBCs

6

10

11

20
18

pDC

mDC

Progenitor

Neutrophil

NK

Megakaryocyte

Plasma

Immature_Neutrophil

13

Fraction of cells
in group (%)
20 40 60 80100
Mean expression
in group
0.0

MS4A1
CD79B
CD79A
BANK1
CD3D
CD3E
CD4
CCR7
MAL
CD8B
CD8A
GZMA
GZMH
STMN1
HMGB2
MKI67
CD14
S100A12
FCGR3A
CSF1R
GATA2
CLC
HDC
CPA3
RUNX1
HBB
HBA1
HBD
HBA2
ALAS2
PPBP
PF4
SPARC
ITGA2B
GNG11
CAVIN2
CLEC1B
CTSA
NKG7
GNLY
GZMB
CTSW
KLRD1
NAMPT
BASP1
BCL2A1
FCGR3B
LCN2
LTF
RETN
S100P
MZB1
ITM2C
XBP1
IGHA1
IGLC2
CDK6
SOX4
EGFL7
CLEC10A
FCER1A
CD1C
IRF8
TCF4
TSPAN13
LGMN

AirwayWash-PBMC

00803_MGH_Broad

GSE149689

0

19

healthy control
mild/moderate
severe
convalescent
influenza
unknown

Erythrocyte

Eosinophil

CD16-Mono

CD14-Mono

Pro T

CD8 T

CD4 T

9
5

B
CD4 T
CD8 T
Pro T
CD14-CD16-Mono
CD14-IL1B-Mono
CD14-IL32-Mono
CD14-ISG15-Mono
CD14-PPBP-Mono
CD16-Mono
Eosinophil
Erythrocyte
Megakaryocyte
NK
Neutrophil
NCF1-Immature_Neutrophil
PNPLA2-Immature_Neutrophil
MZB1-Plasma
PRDM1-Plasma
Progenitor
mDC
pDC

d

12
4

8

UMAP2

B

17

15 7
16
3

UMAP1

c

14

21

EGAS00001004571_10X

GSE154567

EGAS00001004571_BD_Rhapsody

GSE150861

HRA000150

immunodeficiency_PMBCs

B
CD4 T
CD8 T
Pro T
CD14-CD16-Mono
CD14-IL1B-Mono
CD14-IL32-Mono
CD14-ISG15-Mono
CD14-PPBP-Mono
CD16-Mono
Eosinophil
Erythrocyte
Megakaryocyte
NK
Neutrophil
NCF1-Immature_Neutrophil
PNPLA2-Immature_Neutrophil
MZB1-Plasma
PRDM1-Plasma
Progenitor
mDC
pDC

UMAP2

GSE150728

0.5

UMAP1

e
40

0.4

3.0

Frequency

30

8

0.3

2.0

6

10

2.5

12

25

4

10

20

3

8

6
1.5

20

0.2
4

1.0
10
0

0.1

0.5
0.0

B

0.0

PNPLA2-Immature_Neutrophil

2.0

20

2.0

1.5

15

1.5

15

1
0

Neutrophil
70

Erythrocyte
80

10

***

**

5

2

5

0

0

CD14-CD16-Mono
50

Frequency

1.0

10

1.0

0.5

5

0.5

0

0.0

Eosinophil

CD14-PPBP-Mono

0

6

20

20

CD14-IL32-Mono

8

40

30

4

20

CD4 T

0

***
***

10

30

40

10

10
0.0

12

40

60

0

NK

CD14-IL1B-Mono

0

PRDM1-Plasma

14

60
50

10

15

4

0

20
*

***

6

2

2

Progenitor

30

14

5

2
0

CD8 T

CD16-Mono

healthy control
mild/moderate
severe
convalescent
influenza

Supplementary Fig 10
a

b
bioRxiv preprint doi: https://doi.org/10.1101/2021.04.06.438536
; this version posted April 8, 2021. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder.
All rights reserved. No
allowed without permission.
PNPLA2-Immature_Neutrophil
vsreuse
NCF1-Immature_Neutrophil2
ALDOA

PNPLA2
SCARNA9
PRKCD
NCF1
IGKC
Median expression

IGHA1

in group

IGLC2
IGLC3

0.0

0.5

regulation of B cell activation
phagocytosis, engulfment
B cell receptor signaling pathway
viral gene expression
viral transcription
positive regulation of B cell activation
positive regulation of lymphocyte activation
phagocytosis
viral process
complement activation, classical pathway
humoral immune response mediated by circulating immunoglobulin

NCF1-Immature_Neutrophil
PNPLA2-Immature_Neutrophil

cellular protein modification process
transmembrane receptor protein tyrosine kinase signaling pathway
regulation of platelet aggregation
regulation of ERK1 and ERK2 cascade
Fc receptor mediated stimulatory signaling pathway
Fc-gamma receptor signaling pathway
Fc-gamma receptor signaling pathway involved in phagocytosis
neutrophil mediated immunity
neutrophil degranulation
neutrophil activation involved in immune response

15

c

d

12 9
6
3
0
3
-log10(Adjusted P-value)

6

PRDM1-Plasma vs MZB1-Plasma

MZB1

neutrophil activation involved in immune response

MALAT1

neutrophil degranulation
inflammatory response

IGLC2

cytokine-mediated signaling pathway
POU2AF1

cellular response to cytokine stimulus

PIM2

platelet degranulation

CD38

regulation of inflammatory response
positive regulation of defense response

COX8A

positive regulation of interleukin-8 secretion

LMAN1

positive regulation of inflammatory response

FKBP11

cellular defense response
ER to Golgi vesicle-mediated transport

PRDM1

Golgi vesicle transport

SLAMF7

Median expression

retrograde vesicle-mediated transport, Golgi to ER

in group

mitochondrial respiratory chain complex assembly

XBP1
IRF4
MZB1-Plasma
PRDM1-Plasma

0.0

mitochondrial respiratory chain complex I assembly

0.5

mitochondrial respiratory chain complex I biogenesis
NADH dehydrogenase complex assembly
mitochondrial electron transport, NADH to ubiquinone
respiratory electron transport chain
mitochondrial ATP synthesis coupled electron transport
16

12

8

4
0
4
8 12
-log10(Adjusted P-value)

16

20

Supplementary Fig 11
b

a

bioRxiv
doi: https://doi.org/10.1101/2021.04.06.438536
; this version posted April 8, 2021. The copyright holder for this preprint (which
after integraion
beforepreprint
integration
was not certified by peer review) is the author/funder. All rights reserved. No reuse allowed without permission.

UMAP2

UMAP2

Beijing_10X 5'
Chongqing_10X 5'
Guangzhou_10X 3'
Harbin_10X 5'
Hefei_10X 3'
Huanggang_10X 5'
Shandong_10X 5'
Shanghai_10X 5'
Shenzhen_10X 5'
Suihua_10X 5'
Wuhan_10X 3'
Wuhan_10X 5'
Zhuhai_10X 5'
UMAP1

UMAP1

Beijing_10X 5'

Chongqing_10X 5'

Guangzhou_10X 3'

Harbin_10X 5'

Hefei_10X 3'

Huanggang_10X 5'

Shandong_10X 5'

Shanghai_10X 5'

Shenzhen_10X 5'

Suihua_10X 5'

Wuhan_10X 3'

Wuhan_10X 5'

Zhuhai_10X 5'

B_c01-TCL1A
B_c02-MS4A1-CD27
B_c03-CD27-AIM2
B_c04-SOX5-TNFRSF1B
B_c05-MZB1-XBP1
B_c06-MKI67
DC_c1-CLEC9A
DC_c2-CD1C
DC_c3-LAMP3
DC_c4-LILRA4
Epi-AT2
Epi-Ciliated
Epi-Secretory
Epi-Squamous
Macro_c1-C1QC
Macro_c2-CCL3L1
Macro_c3-EREG
Macro_c4-DNAJB1
Macro_c5-WDR74
Macro_c6-VCAN
Mast
Mega

UMAP2

c

UMAP1

d

UMAP2

cell-type

TUBA8-Mega
IGKC-Mega

UMAP1

e

TUBA8

0.8

CDKN1A

0.8

IGKC

Mono_c1-CD14-CCL3
Mono_c2-CD14-HLA-DPB1
Mono_c3-CD14-VCAN
Mono_c4-CD14-CD16
Mono_c5-CD16
NK_c01-FCGR3A
NK_c02-NCAM1
NK_c03-MKI67
Neu_c1-IL1B
Neu_c2-CXCR4(low)
Neu_c3-CST7
Neu_c4-RSAD2
Neu_c5-GSTP1(high)OASL(low)
Neu_c6-FGF23
T_CD4_c01-LEF1
T_CD4_c02-AQP3
T_CD4_c03-ITGA4
T_CD4_c04-ANXA2
T_CD4_c05-FOS
T_CD4_c06-NR4A2
T_CD4_c07-AHNAK

0.8

T_CD4_c08-GZMK-FOS_h
T_CD4_c09-GZMK-FOS_l
T_CD4_c10-IFNG
T_CD4_c11-GNLY
T_CD4_c12-FOXP3
T_CD4_c13-MKI67-CCL5_l
T_CD4_c14-MKI67-CCL5_h
T_CD8_c01-LEF1
T_CD8_c02-GPR183
T_CD8_c03-GZMK
T_CD8_c04-COTL1
T_CD8_c05-ZNF683
T_CD8_c06-TNF
T_CD8_c07-TYROBP
T_CD8_c08-IL2RB
T_CD8_c09-SLC4A10
T_CD8_c10-MKI67-GZMK
T_CD8_c11-MKI67-FOS
T_CD8_c12-MKI67-TYROBP
T_CD8_c13-HAVCR2
T_gdT_c14-TRDV2

CTSD

0.8

0.7

0.7

0.7

0.7

0.6

0.6

0.6

0.6

0.5

0.5

0.5

0.5

0.4

0.4

0.4

0.4

0.3

0.3

0.3

0.3

0.2

0.2

0.2

0.2

0.1

0.1

0.1

0.1

0.0

0.0

0.0

0.0

