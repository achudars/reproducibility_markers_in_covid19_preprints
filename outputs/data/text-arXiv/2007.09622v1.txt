arXiv:2007.09622v1 [q-bio.PE] 19 Jul 2020

From individual-based epidemic models to
McKendrick-von Foerster PDEs: A guide to modeling
and inferring COVID-19 dynamics
Félix Foutel-Rodier?,1,2
François Blanquart1,3
Philibert Courau1
Peter Czuppon1,4
Jean-Jil Duchamps1,2
Jasmine Gamblin1
Élise Kerdoncuff1,5
Rob Kulathinal1,6
Léo Régnier1
Laura Vuduc1
Amaury Lambert??,1,2
Emmanuel Schertzer??,1,2
July 21, 2020

?
??

first author
co-last authors

1

SMILE Group, Center for Interdisciplinary Research in Biology (CIRB), Collège de
France, CNRS UMR 7241, INSERM U 1050, PSL Research University, Paris, France
2

Laboratoire de Probabilités, Statistique & Modélisation (LPSM), Sorbonne Université,
CNRS UMR 8001, Université de Paris, Paris, France
3

Infection, Antimicrobials, Modeling, Evolution (IAME), Université de Paris, INSERM
UMR 1137, Paris, France
4

Institute of Ecology and Environmental Sciences of Paris (IEES), Sorbonne Université,
UPEC, CNRS UMR 7618, IRD, INRA, Paris, France
5

Institut de Systématique, Biodiversité, Évolution (ISYEB), Muséum National d’Histoire
Naturelle (MNHN), CNRS UMR 7205, Paris, France
6

Department of Biology, Temple University, Philadelphia, PA, USA

1

Abstract
We present a unifying, tractable approach for studying the spread of viruses
causing complex diseases that require to be modeled using a large number of types
(e.g., infective stage, clinical state, risk factor class). We show that recording each
infected individual’s infection age, i.e., the time elapsed since infection,
1. The age distribution n(t, a) of the population at time t can be described by
means of a first-order, one-dimensional partial differential equation (PDE)
known as the McKendrick-von Foerster equation.
2. The frequency of type i at time t is simply obtained by integrating the probability p(a, i) of being in state i at age a against the age distribution n(t, a).
The advantage of this approach is three-fold. First, regardless of the number of types,
macroscopic observables (e.g., incidence or prevalence of each type) only rely on a
one-dimensional PDE “decorated” with types. This representation induces a simple
methodology based on the McKendrick-von Foerster PDE with Poisson sampling to
infer and forecast the epidemic. We illustrate this technique using a French data
from the COVID-19 epidemic.
Second, our approach generalizes and simplifies standard compartmental models
using high-dimensional systems of ordinary differential equations (ODEs) to account
for disease complexity. We show that such models can always be rewritten in our
framework, thus, providing a low-dimensional yet equivalent representation of these
complex models.
Third, beyond the simplicity of the approach, we show that our population model
naturally appears as a universal scaling limit of a large class of fully stochastic
individual-based epidemic models, where the initial condition of the PDE emerges
as the limiting age structure of an exponentially growing population starting from
a single individual.

Contents
1 Introduction
1.1 Challenges posed by complex diseases
1.2 Generic model assumptions . . . . .
1.3 Statement of results and outline . . .
1.4 Natural extensions . . . . . . . . . .
1.5 Compartmental ODE models . . . .
1.6 Relation with previous works . . . .

such as COVID-19
. . . . . . . . . . .
. . . . . . . . . . .
. . . . . . . . . . .
. . . . . . . . . . .
. . . . . . . . . . .

2 Two Feynman-Kac formulae
2.1 Assumptions and notation . . . . . . . . . . . . . . . .
2.2 McKendrick-von Foerster PDE: Weak solutions . . . .
2.3 A forward Feynman-Kac formula . . . . . . . . . . . .
2.4 Dual CMJ process and backward Feynman-Kac formula
3 Two laws of large numbers

.
.
.
.

.
.
.
.
.
.

.
.
.
.

.
.
.
.
.
.

.
.
.
.

.
.
.
.
.
.

.
.
.
.

.
.
.
.
.
.

.
.
.
.

.
.
.
.
.
.

.
.
.
.

.
.
.
.
.
.

.
.
.
.

.
.
.
.
.
.

.
.
.
.

.
.
.
.
.
.

.
.
.
.

.
.
.
.
.
.

3
. 3
. 4
. 5
. 7
. 8
. 10

.
.
.
.

11
11
13
14
18

.
.
.
.

20

2

4 Inference
4.1 Case study: the French COVID-19 epidemic
4.2 The model . . . . . . . . . . . . . . . . . . .
4.3 Parametrization of the model . . . . . . . .
4.4 Fitting the model to incidence data . . . . .

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

25
25
25
26
27

A Maximum likelihood method

37

B Best fitting prevalence curves under admission model

37

1
1.1

Introduction
Challenges posed by complex diseases such as COVID-19

The transmission of pathogens between species is a global concern [1, 2]. As such zoonotic
episodes are expected to become increasingly common in humans, it is critical to develop
analytic tools that can quickly transform epidemiological observations into informed public
policy in order to mitigate and control epidemics.
A novel coronavirus, SARS-CoV-2, has recently crossed the species barrier into humans
and, within months, has rapidly spread to all corners of our planet [3]. The sheer scale
of this pandemic has overburdened our medical infrastructure, caused fatalities estimated
well into the hundreds of thousands, and shut down entire economies. Remarkably, the
rapid spread of COVID-19 and its consequences can be attributed to the unique life cycle
of a 30,000 base pair single-stranded virus. SARS-CoV-2 is an airborne pathogen transmitted by both symptomatic and asymptomatic carriers in close proximity to non-infected
individuals. Milder COVID-19 symptoms include a dry cough, fever, and/or shortness
of breath while more serious cases include respiratory failure and eventual death. With
millions of infections and hundreds of thousands of documented deaths and recoveries, the
COVID-19 pandemic is providing a wealth of independent estimates of important clinical
characteristics that can help predict health outcomes specific for a country or region.
It quickly became understood that accurate descriptions of the life cycle of this disease
needed to distinguish between several stages of the disease, referred to as compartments,
depending on whether an infected individual is infectious or not, symptomatic or not,
hospitalized, etc. However it remains unclear to what extent making precise predictions
of the dynamics of such a complex disease requires to have a precise knowledge of clinical
features such as incubation period, generation time, and duration times between infection,
symptom establishment, hospitalization, recovery and death, to know how these durations
correlate and what are the exact probabilities of transition between stages.
In this work, we consider a fully stochastic, generic epidemiological model with an
arbitrary number of compartments, that encompasses life cycles of most complex diseases
and that of COVID-19 in particular. We show how structuring the infected population
by its infection age, i.e., time elapsed since infection, allows us to decouple dependencies
between stages and to time. More specifically, when the population size is large enough,
the joint evolution of all compartment sizes can be described by means of a linear, firstorder partial differential equation (PDE) known as the McKendrick-von Foerster equation
describing the number n(t, a) of infecteds of (infection) age a at time t. The boundary
condition at age 0 is driven by the infection rate from infecteds of age a averaged over all
3

life cycles and the number of individuals of age a in compartment i at time t is obtained
by thinning n(t, a) by a factor p(a, i) which is the probability of being in compartment i
conditional on having age a, averaged over all life cycles.
In the case of COVID-19, we display a simple procedure to infer these parameters,
some from the biological literature and most from time series of numbers of severe cases,
hospitalized cases, discharged patients and deaths that can be applied easily to any regional or national dataset. We also allow for time inhomogeneity in the infection rate to
account for temporary mitigation measures such as lockdowns or social distancing. We
apply this procedure to French COVID-19 data from March to May 2020 and estimate
various parameters of interest including R0 in different phases of the epidemic (before,
during, and after lockdown) and biological parameter values that we compare to empirical
estimates.

1.2

Generic model assumptions

We consider a population model of the SIR fashion where each individual goes through
successive stages, starting from stage S (susceptible) and ending in one of two states:
R (recovered) or D (dead). Depending on disease complexity, the number of stages in
this life cycle can vary. In the SARS-CoV-2 example, typical intermediate stages are A
(asymptomatic) or P (presymptomatic), I (mild case) or C (severe case), H (hospitalized),
U (intensive care unit). These stages are sometimes called compartments, types, classes,
stages or simply states. See Figure 4 for an illustration.
We assume that S individuals are always in excess (branching assumption) and that
each individual infects new S individuals at successive times of a random point process,
one at a time. We further assume that upon infection, an S individual immediately
changes state and never returns to state S (ruling out multiple infections in particular).
More formally,
• The set of all possible states is denoted S and a stochastic process (X(a); a ≥ 0)
with values in S gives the state of a typical individual of age a, where here age
means age of infection, i.e., time elapsed since infection. For the sake of simplicity,
we will assume that S is a discrete space.
• A random point measure P describes the times of secondary infections. Due to the
previous assumptions, atoms of P all have mass 1 and only charge (0, ∞).
• We can (and will) superimpose time heterogeneity to this process by means of a
suppression function (c(t); t ≥ 0) valued in [0, 1] thinning the infection process.
More precisely, if t is a potential time of infection for individual x (i.e., t is an
atom of its infection point process Px ), we ignore the event with probability 1 −
c(t). This suppression function can model the effect of vaccination, of densitydependence (i.e., relaxing the branching assumption due to an excess of removed
or of deceased individuals), or of governmental mitigation measures (i.e., social
distancing, lockdown).
The population is thus described by a Crump-Mode-Jagers branching process, where all
individuals x are characterized by independent copies (Px , Xx ) of the pair (P, X) describing, respectively, the process of infection and the life cycle. In the branching process
literature, X is often referred to as a random characteristic of individual x [4, 5, 6].
4

Remark 1. A typical infection measure is a Poisson Point Process with intensity λ killed
at an independent exponential random variable with parameter γ. (By killing we mean
that we erase all atoms of the PPP after the killing time.) This corresponds to the classical
SIR process with rate of infection λ and recovery rate γ. More generally, we can construct
a SEIR process (E for exposed) as follows. Let L be a random variable and consider ξ
be a Poisson Point Process with an intensity measure λ(x)dx. Then define P([a, b]) =
ξ([(a − L)+ , (b − L)+ ]) so that no infection occurs during the incubation period [0, L].
Remark 2. P and X are generally not independent. As a simple example, since (most)
diseases cannot be transmitted by deceased individuals, no atom of P is allowed once X has
reached the end-state D. In the same spirit, one could assume that the infection potential
of a given individual is reduced once in the hospital and that individuals with many atoms
in their infection process P (high infectiosity) are identified and isolated.
Remark 3. Classes such as P , I or H must sometimes be refined to account for additional structuring variables like general health condition, (real) age, spatial position or
previous exposure to similar pathogen. Knowledge of such variables can help predict more
accurately the outcome of the infection and parametrize more precisely the infection process. Regarding this last point, note that the assumptions in force here allow for any
implicit or explicit structure provided that transmission from an individual of type i to
an individual of type j does not depend on j (but may depend on i, as we have seen).
Relaxing this assumption would result in describing the large population limit by a multidimensional PDE instead of a one-dimensional PDE (see Section 1.4). Also, note that
ignoring structuring by a hidden variable such as spatial position or health condition can
lead to difficulties in estimating sojourn times in each compartment (such as P , I or H)
from clinical data, due to over- or under-representation in this compartment of subsets of
individuals carrying certain values of the hidden variable.

1.3

Statement of results and outline

The stochastic epidemic models we consider here are fairly general and can exhibit quite
complex dependencies (i) between states and time, due to the lack of any Markov-type
assumption, (ii) between states, due to possibly hidden structuring variables impacting
the life cycle, (iii) between state and infection rate, and (iv) between past and future
infection events. The main message of this note is that despite this apparent complexity,
most of this complexity vanishes when the size of the population is large. More specifically,
we show that in the limit of large populations (obtained by starting from a large initial
population or as a consequence of natural exponential growth), the population of infecteds
structured by age (of the infection) can be described by a one-dimensional PDE that only
depends on
(a) The average infection rate
τ (da) := E(P(da)),
and
(b) The 1d marginals of the life-cycle process
p(a, i) := P(X(a) = i).
5

Large initial population. Let us start with N infected individuals and define the
empirical measure µN
t describing the ages and types of infected individuals present at
time t
X
:=
µN
(da
×
{i})
1σx <t δ(t−σx ,Xx (t−σx )) (da × {i}),
(1)
t
x

where the sum is taken over all individuals x having ever lived and σx denotes the birth
(infection) time of x. According to our first result (Theorem 7), starting from N infected
individuals at time 0 with i.i.d. infection ages with law g, we have the a.s. convergence
1 N
µt (da × {i}) = n(t, a)p(a, i)da,
N →∞ N
lim

where n(t, a) solves the McKendrick-von Foerster PDE
∀t, a > 0, ∂t n(t, a) + ∂a n(t, a) = 0
Z

∞

∀t > 0, n(t, 0) = c(t)

τ (da)n(t, a),

(2)

0

∀a ≥ 0, n(0, a) = g(a).
After lockdown. Our second result (Theorem 8) displays a similar, but more subtle,
convergence in the case when the process is supercritical, where natural growth leads
by itself to large population sizes. Let Z(t) denote the total population size at time t
and assume that Z(0) = 1, i.e., we start from a single individual. By a slight abuse of
notation, denote by µttK the empirical measure of ages and types as in (1), but under the
assumption that the suppression function at time t is equal to c(t − tK ) where c is equal
to 1 for negative arguments, and tK is some large, random time. We are motivated by
modeling a situation where the infection is separated into two distinct phases:
(Phase 1) We let the epidemic develop until a certain random time tK . For instance, tK could
be the time at which the number of recorded deaths exceeds a large threshold K.
We assume no suppression before tK ;
(Phase 2) We let the suppression function vary after time tK , e.g., due to mitigation measures
and/or behavioral changes (i.e., lockdown phase).
Conditional on non-extinction, letting (tK ) be any sequence of stopping times such that
tK → ∞ on the non-extinction event, we have the following convergence in probability
µttK
K +t
= n(t, a)p(a, i)da.
lim
K→∞ Z(tK )
Now n(t, a) solves the McKendrick-von Foerster PDE with the same boundary condition
as previously, but with initial condition n(0, a) = αe−αa , where α > 0 is the exponential
growth rate of Z(t) for t ≤ tK , also called Malthusian parameter. This second result can
be seen as a refinement of limit theorems for exponentially growing populations counted
with random characteristics, where here the characteristic of a typical individual is the
number of her descendants in class i of age a, born at least s time units after her birth
(summed over sx = tK − σx ). In particular, taking t = 0 in the statement yields the
6

convergence to the exponential stable age distribution decorated by the 1d marginals p
of X. The way we state the result nicely displays dependencies between characteristics
corresponding to different t’s.
To summarize: (1) the macroscopic infection process is characterized by the sole intensity measure τ and dictates an explicit age structure of the population, and (2) the
class structure is deduced by averaging the life-cycle process against the limiting age profile. In order to validate our approach, we use those deterministic approximations to
infer epidemiological parameters (R0 before and during lockdown) from recent empirical
observations, and show that our findings are in accordance with the current literature.
Outline. The paper is organized as follows. In Section 2, we study the McKendrickvon Foerster equation (2). After providing a precise description of the branching process
that we are considering in Section 2.1, we give the definition of a weak solution to (2) in
Section 2.2. Then, we give two probabilistic representations of these weak solutions. We
first show in Section 2.3 that the weak solution to (2) corresponds to the first moment
of the branching process that we are studying, when viewed as a random measure on the
ages of infection. Second, Section 2.4 provides a construction of the weak solution using a
dual genealogical process. The two laws of large numbers are proved in Section 3. Finally
the inference in carried out in Section 4. Section 4.2 and Section 4.3 describe our choice
of parametrization and the inference results are discussed in Section 4.4.

1.4

Natural extensions

Some of the assumptions underlying the previous models can be relaxed and our general
framework can be adapted to more complex and realistic populations.
Contact matrix. So far, infectious individuals infect new individuals uniformly at random. In general, a contact matrix specifies the contact rate, depending on contact location
(household, school, work...) or individual types of source and target (real age, susceptibility...) [7, 8]. More precisely, each individual now belongs to one class, and we denote
by C the (finite) set of all classes. An individual in class j ∈ C is characterized by a
multi-dimensional process (X j , P j,1 , . . . , P j,C ) where the atoms of P j,k provide the age
at which this individual infects a new individual of type k ∈ C, and (X j (a); a ≥ 0) is a
S-valued process whose distribution can depend on j.
We define the mean contact matrix as
∀j, k ∈ C, τ jk (du) := E(P j,k (du)).
The population is again described by a multi-type Crump-Mode-Jagers branching process.
Analogously to (1), µN,j
denotes the empirical measure of j individuals starting with
t
N = (N j )j∈C infected individuals at time t = 0. Assume that there exists a constant N
such that for all j ∈ C, N j /N → y j as N → ∞. Under the usual technical conditions
(the matrix τ is irreducible and Malthusian, x log(x) type condition, see [9]),
∀j ∈ C, ∀i ∈ S,

1 N,j
µt (da × {i}) =⇒ nj (t, a)P(X j (a) = i)da
j
N

7

where (nj )j∈C satisfies the multidimensional McKendrick-von Foerster equation
∂t nj (t, a) + ∂a nj (t, a) = 0
Z
X
j
kj
∀t > 0, n (t, 0) =
c (t)

∞

τ kj (da)nk (t, a),

(3)

0

k∈C
j j

∀a ≥ 0, nj (0, a) = y g (a).
where g j describes the initial age profile of class j and cjk (t) is a matrix at time t generalizing the suppression function of the previous section. Following Theorem 8, it is natural
to consider the initial condition
g j (u) = α exp(−αu)φj
where α is the Malthusian parameter, i.e. the unique α such that the largest eigenvalue
of the matrix
Z
exp(−αu)τ (du)
is equal to 1 and (φj )j∈C is its Perron-Frobenius left eigenvector with (positive) entries
summing up to 1. As in Theorem 8, such initial condition can be justified by starting with
a single individual and let the population grow up to a large random time tK conditional
on non-extinction [9].
Shortage of susceptibles. Another natural extension consists in taking into account
saturation of infected in the population. Start with a finite, but large population of size N
with a fraction of infected individuals x ∈ (0, 1) with an age profile g at time t = 0. Here
infection is only effective if the target individual is susceptible, which thins infection rate
by the fraction of susceptibles in the population. At the limit, this saturation translates
into a non-linear McKendrick-von Foerster equation
∀t, a > 0, ∂t n(t, a) + ∂a n(t, a) = 0
Z
∀t > 0, n(t, 0) = S(t)c(t)

∞

τ (da)n(t, a),

(4)

0

∀a ≥ 0, n(0, a) = xg(a),
where we have defined

Z

∞

S(t) := 1 −

n(t, a)da,
0

and the limiting empirical measure is given by n(t, a)p(a, j)da. Convergence results to
this limiting PDE are addressed by some of the present authors in [10].

1.5

Compartmental ODE models

An important special case of our model is when the process (X(a); a ≥ 0) is a Markov
process and infections from individual x occur at a rate that only depends on the current
state of x.
Under these assumptions, the McKendrick-von Foerster PDE reduces to a finite set
of ODEs. Similar sets of ODEs have been widely used to model the SARS-CoV-2 epidemic [11, 12, 13, 14], and in that sense, taking into account explicitly the (infection) age
8

structure of the population allows us to incorporate all these models into the same general
framework.
More precisely, for i ∈ S define
Z ∞
n(t, a)p(a, i)da
∀t ≥ 0, Ni (t) =
0

to be the number of individuals in state i. We will assume that (X(a); a ≥ 0) is a
Markov process with transitions (λij )i,j∈S . Moreover, we suppose that conditional on
(X(a); a ≥ 0), the infection process Px from individual x is a Poisson point process with
intensity rate τi when x is in state i. Then a direct computation shows the following
result.
Proposition 1. Suppose that (X(a); a ≥ 0) is a Markov process with transitions (λij )i,j∈S ,
and that conditional on (X(a); a ≥ 0), P is a Poisson point process with intensity
(τX(a) ; a ≥ 0). Then, if (n(t, a)) denotes the solution to (4), (Ni (t); t ≥ 0)i∈S solves
the following set of ODE:
X
X
X
∀i ∈ S, Ṅi =
λji Nj − Ni
λij +
aji Nj S,
(5)
j∈S

where aji := τj p(0, i) and S := 1 −

j∈S

P

i∈S

j∈S

Ni .

Proof. Recall that
Z

∞

n(t, a)p(a, i)da.

Ni (t) =
0

By differentiating both sides with respect to time we get
Z ∞
Z ∞
∂a n(t, a)p(a, i)da
∂t n(t, a)p(a, i)da = −
Ṅi (t) =
0
Z0 ∞
n(t, a)∂a p(a, i)da + n(t, 0)p(0, i).
=
0

By using the boundary condition and the fact that (X(a))a≥0 is a Markov process, we
obtain that
Z ∞
Z ∞
X

X
n(t, a)
τj p(a, j)da.
n(t, a)
λji p(a, j) − λij p(a, i) da + S(t)p(0, i)
Ṅi (t) =
0

=

X

0

j∈S

λji Nj (t) − Nj (t)

j∈S

X
j∈S

λij +

X

j∈S

aji S(t)Nj (t),

j∈S

which ends the proof.
Conversely, let us consider from the start the system of ODEs (5). Here, λij is interpreted as the rate at which a type i individual turns into type j and aij as the rate at
which a type i individual gives birth to a type j individual. If the contact matrix with
generic entries aij has rank 1 and non-negative entries, it can always be decomposed as
aij = τi p(0, j) where τi ≥ 0 and (p(0, j)) is a probability vector. The vectors (τi ) and
(p(0, j)) can be recovered by
X
aij
τi =
aij and p(0, j) =
(∀i, j).
τ
i
j∈S
9

Note that here aij = λ(i)p(0, j), so that actually a type i individual gives birth at rate
λ(i) and her offspring has type independently distributed according to p(0, ·). As a result,
the contact matrix with generic entries aij has rank 1, and λ and p(0, ·) can be recovered
by
X
aij
(∀i, j).
λ(i) =
aij and p(0, j) =
λ(i)
j∈S
Then one can define (X(a); a ≥ 0)Pas the S-valued process with rates given by the matrix
Λ (with diagonal entries λii = − j6∈S λij ) and initial distribution (p(0, i)). Denote as in
the rest of the text
p(a, i) = P(X(a) = i),
so that the row matrix p(a, ·) can be computed as the product p(0, ·) exp(aΛ).
Now let us consider the solution (Ni (t); t ≥ 0) to (5) and assume there is some age
distribution g (integrable but possibly not summing to 1) such that
Z ∞
Ni (0) =
g(a)p(a, i)da.
(6)
0

Then by uniqueness of (Ni ) and thanks to Proposition 1, for all i ∈ S,
Z ∞
n(t, a)p(a, i)da,
Ni (t) =
0

where n is the solution to the McKendrick-von Foerster PDE with initial condition g and
boundary condition
Z
∞

τ (a)n(t, a)da,

n(t, 0) =
0

P
where τ (a) := j∈S τj p(a, j). This shows that the solution to any linear system of ODEs
of the form (5) has a simple representation in terms of the solution to the McKendrickvon Foerster PDE decorated with types, provided there is a representation of the initial condition in the form (6). Note that this last property is not necessarily fulfilled.
For example, if X is ergodic and started in its stationary probability distribution, then
p(a, i) = p(0, i) and (6) would only hold if (ni (0))i∈S were proportional to (p(0, i))i∈S .
If the matrix with generic entries aij does not have rank 1, one could derive a similar
representation of the solutions to (5), but using the multi-dimensional version of the
McKendrick-von Foerster equation (3).

1.6

Relation with previous works

Non-Markov epidemic models have already been investigated, see e.g. [15, 16, 17, 18].
The idea of representing a general branching population by its age structure has a rich
history in probability theory [19, 20, 21, 22, 23, 24, 25, 26] and the connection with
the McKendrick-von Foerster PDE has been acknowledged several times [20, 24]. In the
latter two works, the authors allow for birth and death rates that may depend not only
on abundances of each type, but also on the whole age structure of the population. This
impressive level of generalization comes at the cost of assuming that the process describing
the evolution of the empirical measure on ages and types is Markovian. In particular, birth
and death rates are not allowed to depend on past individual birth events. The Markov
property then allows the use of a generator for the empirical measure and with some
10

extra finite second moment assumptions on the intensity measure, this approach allows
the authors to obtain a law of large numbers and a central limit theorem.
We acknowledge that the current work is certainly not as mathematically challenging
as the works alluded to above, and that some of our results are almost implicit in some
of the previous works. However, we believe that our point of view (1d PDE decorated
with types) does deserve to be highlighted in the current sanitary crisis since it provides
a natural and efficient inference methodology. More than 70,000 publications related to
the COVID-19 crisis have appeared since the onset of the pandemic, with many different
modeling approaches. One of the modest aims of the present note is to convey the idea
that individual-based stochastic models suggest a simple and tractable framework for
tackling some of the complex features of the disease. Furthermore, since we ignore finite
population effects, our proofs are quite elementary compared to [20, 24] and should be
accessible to a much wider audience interested in such a modeling approach.
Finally, we already pointed out that the connection between branching processes and
McKendrick-von Foerster PDE has been discussed in previous works. However, as far
as we can tell, the duality result exposed in Section 2.4 is new and can presumably be
extended to more general branching processes where birth and death rates are allowed to
be frequency-dependent. In [10], some of the authors of the present work show that this
duality result has a natural counterpart in a model with a finite but large population.

2
2.1

Two Feynman-Kac formulae
Assumptions and notation

CMJ branching process with suppression. Recall that the infection process is modeled by a Crump-Mode-Jagers (CMJ) branching process [19, 4] with no death, starting
from one individual called the progenitor (or root of the tree). Each individual x is
characterized by an independent pair (Px , Xx ) embodying respectively the processes of
secondary infection events from x and of types carried by x. Each pair (Px , Xx ) is a copy
of the pair (P, X) with law L, except when x is the root, where it is distributed as (P̃, X̃)
with law L̃ (more on that below).
Also recall some infection events can be suppressed using a suppression function
(c(t); t ≥ 0). Given a realization of the CMJ tree, for each branching point occurring
at time t, we trim the tree by independently pruning the subtree stemming from it with
probability c(t). See Figure 1.
For simplicity, we will assume that the suppression function c is a piecewise rightcontinuous function, and that for any t ≥ 0, the process (X(a); a ≥ 0) is a.s. continuous
at t. Define the average infection measure (that is, the intensity measure of the point
process P) as
τ (du) := E(P)(du).
We assume that τ is absolutely continuous w.r.t. the Lebesgue measure in such a way
that there exists a measurable non-negative function β such that
Z ∞
τ (du) = β(u)du and R0 :=
β(u)du < ∞.
(7)
0

11

t=0

Figure 1: The initial individual (P̃, X̃) is represented by a black segment. In Section 2.1,
we assume that at time t = 0, the age of the initial individual (length of the grey segment)
is distributed according to a probability density g. If a branching event is observed at
time t (see e.g., black dots), the infection occurs with probability c(t). In the CMJ, this
amounts to prune the corresponding subtree with probability c(t) (dotted red tree).
We also assume that there exists a unique parameter α ∈ R (the so-called Malthusian
parameter of the CMJ process) such that
Z
exp(−αu)τ (du) = 1.
(8)
The parameter α can be either positive (supercritical) or negative (subcritical). Finally,
we will also enforce the Kesten and Stigum criterium [27]

E Rα log+ (Rα ) < ∞,
(9)
where

Z
Rα :=

∞

exp(−αt)P(dt).
0

Initial shifted law. For any finite measure m on R+ , we define θt ◦ m as the measure
shifted by t, i.e.,
Z ∞
Z ∞
f (u − t)m(du),
f (u)θt ◦ m(du) =
0

t

where f is any measurable, bounded function f on R+ . For any measurable function
F : R+ → S, we similarly define θt ◦ F by θt ◦ F (u) = F (u + t). (We make a slight abuse
of notation by using the same symbol for the shift operator on measures and functions.)
Let g be a probability density on R+ . We now specify the law L̃g of the pair (P̃, X̃)
characterizing the root. In order to connect the CMJ process with the McKendrickvon Foerster equation, we will focus on the case where (P̃, X̃) is identical in law to
(θA ◦ P, θA ◦ X), where A is a r.v. independent of (P, X) and distributed according to g.
The distribution L̃g will be referred to as the shifted law. In particular, we have
Z ∞

τ̃ (da) := E(P̃(da)) =
β(x + a)g(x)dx da.
0

12

Notation. We assume that individuals are indexed by the standard Ulam-Harris labeling. Namely, individuals are indexed in I = ∪n (N∗ )n . If x ∈ I, then xi (the concatenation
of x and i) is interpreted as the i-th child of x. Children are ranked according to their
birth time: (x, 1) is the oldest child of x, (x, 2) the second oldest, etc. (Since we assumed
that τ has a density, there is no simultaneous births and the atoms of P are distinct a.s.)
We denote by σx the date of birth of x with the convention that σx = ∞ if the individual
is never born. For instance, if σx < ∞ and x has k children, then σxj = ∞ for j > k.
Finally, ∅ will denote the root of the tree.

2.2

McKendrick-von Foerster PDE: Weak solutions

In this section, we consider the time-inhomogeneous, linear McKendrick-von Foerster
PDE (2). The first line in (2) is the transport equation with unit velocity, i.e., ages
of individuals increase at rate 1. The second line gives the number of newly infected
individual (age 0) at time t.
In order to motivate our definition of weak solutions, we start by giving a formal
resolution of the PDE using the method of characteristics. Fix a > 0. Let
A(t) = a − t
Then
d
n(t − s, A(s)) = −∂t n(t − s, A(s)) − ∂a n(t − s, A(s)) = 0,
ds
so that s 7→ n(t − s, a − s) is conserved along the characteristics, i.e.,
∀s < a, n(t, a) = n(t − s, a − s).
It follows that
(
g(a − t) when a > t
n(t, a) =
b(t − a) when a ≤ t

(10)

R∞
where b(t) = c(t) 0 τ (da)n(t, a). We now determine the function b. Injecting the previous expression into the ‘spatial’ boundary condition of the PDE, we obtain a delayed
equation for b: for every t > 0
Z t
Z ∞
b(t) = c(t)
τ (da)b(t − a) + c(t)
τ (da)g(a − t).
(11)
0

t

Lemma 2. There exists a unique solution b to (11) which is locally integrable. Moreover,
for any δ ≥ 0 such that δ > α we Rhave b ∈ L1,δ , where L1,δ denotes the set of all functions
∞
f : R+ → R such that kf kL1,δ := 0 e−δt |f (t)| dt < ∞.
Proof. Fix δ > α and denote by L1,δ the space L1,δ quotiented by the relation ∼δ , where
f ∼δ g if kf − gkL1,δ = 0. Then define the linear operator Φ : L1,δ → L1,δ by
Z t
Φf : t 7→ c(t)
f (t − u)β(u)du.
0

13

Then we have
Z

∞

∞

Z

−δt

Z

−δt

t

Φf (t)dt =
e c(t)
f (t − u)β(u)dudt
0
0
0
Z ∞
Z ∞
−δu
β(t − u)e−δ(t−u) c(t)dtdu.
e f (u)
=

kΦf kL1,δ =

e

u

0

Now using that

∞

Z

β(t − u)e

−δ(t−u)

Z

∞

c(t)dt ≤

β(t)e−δt dt < 1

0

u

we obtain that kΦk < 1. Define
Ψ := Id −Φ.
Then Ψ is invertible with inverse

P

Φk . Note that equation (11) can be written as

k≥0

Ψ(b) = F,
where

Z

∞

β(a)g(t − a)da.

F : t 7→ c(t)
t

The proof ends noting that F ∈ L1,δ as
Z ∞
Z ∞Z
−δt
e F (t)dt ≤
0

0

∞

β(a)g(t − a)dadt < ∞.

t

We have thus proved existence and uniqueness of the solution b to (11) in L1,δ . Now for
any two functions b1 and b2 such that b1 ∼δ b2 and b1 and b2 both satisfy (11), we have
b1 = b2 (i.e., there is a single element in the equivalence class of b). This shows uniqueness
of the solution b to (11) in L1,δ .
Since all elements of L1,δ are locally integrable, this also shows the existence of a
locally integrable solution to (11). Its uniqueness can be proved following the exact
same reasoning as previously, replacing integrations on [0, ∞) by integration on compact
intervals.
Definition 3. We say that (n(t, a); a, t ≥ 0) is the L1,loc weak solution to the McKendrickvon Foerster PDE with initial condition g if it satisfies the relation (10) where (b(t); t ≥ 0)
is the unique locally integrable solution to (11) displayed in the previous lemma.

2.3

A forward Feynman-Kac formula

Define
Z(t) :=

X

1(σx ∈ (0, t]), B(t) := E Z(t)



x

where
R ∞ Z(t) is interpreted as the number of infections between 0 and t. Recall that R0 :=
β(u)du < ∞ guarantees that B(t) < ∞ for all t ≥ 0. Finally, B is non-decreasing
0
and we denote by dB the Stieljes measure associated to B.
Lemma 4. There exists a locally integrable function (b(t); t ≥ 0) such that
dB(t) = b(t)dt.
Further, b coincides with the unique locally integrable solution of the delayed equation (11).
14

Proof. The fact that dB has a density easily follows from the fact that τ has a density.
The fact that B(t) < ∞ ensures that b is locally integrable.
Define P̄x the infection measure obtained from Px after random thinning by the function (c(t); t ≥ 0). Namely, conditional on σx and the atoms a1 < a2 < · · · of Px , we
remove independently each of the atoms with respective probabilities 1 − c(σx + a1 ), 1 −
c(σx + a2 ) . . . , whereas the other atoms remain unchanged.
Fix t > 0. Let k ≤ n ∈ N. Define Tk,n (Px ) as the measure obtained from Px as
follows. Conditional on the atoms a1 < a2 < · · · of Px , we remove independently each of
the atoms with respective probabilities
1−

max

k k+1
,t n ]
z∈(t n

c(z + a1 ), 1 −

max

k k+1
z∈(t n
,t n ]

c(z + a2 ) · · ·

and leave other atoms unchanged. Note that the thinning procedure is now independent
of the starting time σx . Further, if σx ∈ (t nk , t k+1
], the point measure Tk,n (Px ) dominates
n
P̄x .
We decompose the births on (0, t] into two parts: individuals stemming from the root
∅ and a second part from subsequent births. Using the fact that for every individual x,
the (un-suppressed) random measureRPxR is independent of its birth time σx (see second
t ∞
equality below), and setting M (t) := 0 0 g(a)β(a + u)c(u)dadu, we get

 Z
 
n−1 X
X
k k+1
P̄x (da) + M (t)
]
B(t) =
E 1 σx ∈ (t , t
n
n
[0,t−σx ]
k=0 x
!

Z
n−1 X
X
k k+1
E 1 σx ∈ (t , t
≤
]
Tk,n (Px )(da) + M (t)
k
n
n
[0,t−t n ]
k=0 x



Z

n−1
XX
k k+1
k,n
E 1 σx ∈ (t , t
]
E
T (P)(da) + M (t)
=
k
n
n
[0,t−t
]
x
n
k=0
!  Z

n−1
X
X 
k k+1
k,n
E
1 σx ∈ (t , t
E
=
]
T (P)(da) + M (t)
k
n
n
[0,t−t
]
x
n
k=0
 Z

n−1 
X
k+1
k
k,n
=
B(t
) − B(t ) E
T (P)(da) + M (t)
k
n
n
[0,t−t
]
n
k=0


Z
n−1
X
k
k+1
) − B(t )
ck,n (u)β(u)du + M (t).
=
B(t
k
n
n
[0,t−t n ]
k=0
with ck,n (y) = maxv∈(t k ,t k+1 ] c(y + v). In particular, if tk/n → x, and x + y is a continuity
n
n
point of c, we have ck,n (y) → c(x + y). We will pass to the limit n → ∞ in the latter
inequality. Recall that c is bounded (and valued in [0, 1]) and that c is right-continuous.
The first term on the RHS can be written under the form
 Z t−[x]n
Z t
n−1 
X
k+1
k
k,n
B(t
) − B(t )
c (u)β(u)du =
f n (x)dB(x),
n
n
0
0
k=0
where
f

(n)

Z
(x) =

t−[x]n

sup
0

c(v + u)β(u)du and [x]n =

v∈([x]n , [xn ]+ nt ]

15

t
bnx/tc.
n

We will now apply twice the Bounded Convergence Theorem. On the one hand, for a
fixed value of x, as n → ∞

1[0,t−[x]n ] (u)

sup
v∈([x]n ,[x]n + nt ]

c(v + u)β(u) → 1[0,t−x] (u)c(x + u)β(u) Lebesgue a.e.

Further, the latter Rterm (i.e., the integrand in the integral defining f n ) is uniformly
∞
bounded by β and 0 β(u)du < ∞. A first application of the Bounded Convergence
Theorem implies that for every x, as n → ∞
Z t−x
n
c(x + u)β(u)du.
f (x) →
0

R∞
On the other hand, the uniform bound, f n (x) ≤ R0 = 0 β(u)du for all x, n, allows us
to again apply the Bounded Convergence Theorem, so we get
Z
Z tZ ∞
Z t
b(x)dx
c(x + u)β(u)du +
g(a)β(a + u)c(u)dadu.
B(t) ≤
0

[0,t−x]

0

0

By an analog argument, one can establish the same lower bound and strengthen the latter
inequality into an equality. After a simple change of variable and interchanging the order
of integration, this yields
Z t
Z v
Z tZ ∞
B(t) =
c(v)
β(v − x)b(x)dxdv +
g(a)β(a + u)c(u)dadu.
0

0

0

0

Finally, differentiating with respect to t yields the desired result.
Corollary 5 (Forward Feynman-Kac formula). For every t ≥ 0, define
µ̄t (da × {i}) := n(t, a) × P(X(a) = i)da,
where n is the unique L1,loc weak solution to the McKendrick-von Foerster PDE with initial
condition g. Then
X

µ̄t (da × {i}) = E
1σx <t δ(t−σx ,Xx (t−σx )) (da × {i})
(12)
x

where the expected value is taken with respect to a CMJ process starting with one individual
with infection and life-process distributed according to the shifted law L̃g .
Proof. Define
µ̄0t (da

X

× {i}) := E
1σx <t δ(t−σx ,Xx (t−σx )) (da × {i})
x

We need to check that µ̄0t = µ̄t on the space of finite measures. Let F be a measurable,
non-negative, bounded, continuous function on R × R × S with compact support on
R+ × R+ × S. As in the previous lemma, we have

Z
X Z
0
E
F (s, s − σx , Xx (s − σx )) 1(σx < s)ds
F (s, a, i)µ̄s (da, di)ds =
x6=∅
∞

Z

Z

+

∞

E (F (t, t + a, X(t + a)) g(a)dadt.
0

0

16

Let (I) be the first term on the RHS. For every n ∈ N∗

XX Z
k k+1
(I) =
E
F (s, s − σx , Xx (s − σx )) 1(σx > s, σx ∈ ( ,
])ds
n n
k≥0 x

XX Z s
k k+1
≤
E
max F (s, s − u, Xx (s − u)) 1(σx ∈ ( ,
])ds
k k+1
n
n
u∈( n
, n ]
0
x
k≥0
 

XXZ s 
k k+1
=
E
max F (s, s − u, X(s − u)) P σx ∈ ( ,
] ds
k k+1
n n
u∈( n
, n ]
0
k≥0 x
 

XZ s 
k+1
k
=
E
max F (s, s − u, X(s − u))
B(
) − B( ) ds
k k+1
n
n
u∈( n
, n ]
0
k≥0
By reasoning along the same lines as in Lemma 4 (i.e., applying the Bounded Convergence
Theorem several times) and using the almost sure continuity at every fixed time of the
process X, one can show that the RHS converges to

Z ∞Z s 
E F (s, s − u, X(s − u)) b(u)duds
s=0

u=0

as n → ∞ and thus

Z
Z ∞Z s 
0
E F (s, s − u, X(s − u)) b(u)duds
F (s, a, i)µ̄s (da, di)ds ≤
s=0 u=0
Z ∞Z ∞
+
E (F (t, t + a, X(t + a)) g(a)dt.
0

0

By a similar argument, the inequality can be strengthened into an equality. Moreover we
have
Z
Z
F (s, a, i)µ̄t (da, di)ds = F (s, a, i)n(t, a)P(X(a) ∈ di)dads
Z aZ
Z ∞Z
=
F (s, a, i)b(s − a)P(X(a) ∈ di)dads +
F (s, a, i)g(a − s)P(X(a) ∈ di)dads
0

so that

a

Z

Z
F (s, a, i)µ̄t (da, di) =

F (s, a, i)µ̄0t (da, di).

Now take F (s, a, i) = h(s)f (a, i) with h measurable, bounded, compact support on
R+ and f bounded continuous. We get
Z
Z
h(s) hµ̄s , f i ds = h(s) hµ̄0s , f i ds.
On the other hand it is easy to check that the two functions s → hµ̄s , f i and s → hµ̄0s , f i
are both continuous. As a consequence, we have hµ̄s , f i = hµ̄0s , f i for every test function
f , concluding the proof.

17

2.4

Dual CMJ process and backward Feynman-Kac formula

We end this section by making a connection between a dual process – interpreted as an
ancestral process – and the (PDE) method of characteristics. In addition, this approach
provides a probabilistic proof of uniqueness for the PDE.
Let M be any random point measure with intensity measure τ (du). Fix a, T > 0. We
now construct a dual process using the measure M, which can be seen as a generalized
Bellman-Harris branching process (individuals have a finite lifetimes, births only occur
upon death). Let us first describe the process with no suppression (i.e., c = 1).
• Start with a single particle at time t = 0. Assume that the residual lifetime of this
original particle is a, so that this particle dies out at time a.
• As in a Bellman-Harris process, the number of offspring of an individual and their
lifetime durations are independent of the parent’s characteristics.
• Upon death, each individual x is endowed with an independent copy Mx of M: the
number of offspring of x is given by the number of atoms of Mx and their lifetime
durations are given by the positions of the atoms in Mx .
The dual process with suppression c 6= 1 can be coupled with the case c = 1. Given a
realization of the process, if a branching occurs at time t, the children are killed independently with probability c(T − t). (Note that as in the original CMJ process, suppression
translates into trimming the dual tree.)
Remark 4. We note that there are as many dual processes as there are point processes
with intensity measure τ . Here are a few natural choices:
1. M = P.
2. Let M be a Poisson Point Process with intensity measure τ (du). In this particular
case, the dual process is a Bellman-Harris branching process (i.e., the offspring
lifetime durations are independent conditional on offspring number). We note that
τ (du) appears naturally when considering the ancestral spine of a critical CMJ, see
e.g. [28]. The measure τ can be obtained by size-biasing P (i.e. biasing by the total
mass of P) and then recording the age of the individual at a uniformly chosen birth
event.
Let (Yt ; t ≥ 0) be the stochastic process valued in ∪n∈N Rn+ recording the residual life(1)
(n)
times at time t listed in increasing order, i.e. if Yt = (Yt , · · · , Yt ) there are n particles
(k)
(1)
(n)
alive at time t and Yt is the residual life-time of the k th -individual with Yt < · · · < Yt .
(We assumed that τ has a density so that the residual lifetimes are distinct a.s.). In
particular, the particle labelled 1 at any given time t will be the first to expire, and at
(1)
death time t + Yt a random number of children is produced. We let dim(YT ) denote the
number of particules alive at time t, i.e., the dimension of the vector Yt .
Finally, we will say that n is a right-continuous version to the McKendrick-von Foerster
equation, if n is a L1,loc weak solution and for every T, x ≥ 0 the function s → n(T −s, x−s)
is right-continuous on [0, x].

18

Proposition 6 (Backward Feynman-Kac formula). Assume that the suppression function
(c(t); t ≥ 0) is right-continuous. Then there is a unique right-continuous solution to the
McKendrick-von Foerster equation, and for every a, T ≥ 0
!
X
(i)
ba
n(T, a) = E
g(Y )
(13)
T

i≤dim(YT )

b a is the distribution of the process (Yt ; t ≥ 0) starting with an individual with
where E
residual lifetime a.
Proof. We first assume that there exists a right-continuous solution to the PDE. Let
t1 < · · · < tk < · · · be the successive branching times of the dual branching process.
Since τ has a density, there is a single branching particle at the successive branching
times t1 , · · · . Define the càdlàg process
X
Zs :=
n(T − s, Ys(i) )
i≤dim(Ys )

See also Figure 2.4 for a pictorial representation of the process. It is plain from the
definition that n is preserved along the characteristics of the PDE, i.e., that for every x
the function s → n(T − s, x − s) remains constant on [0, x). As a consequence, (Zs , s ≥ 0)
remains constant on every interval [tn , tn+1 ), with the convention t0 = 0. Define zn := Ztn
the value of the process (Zt ; t ≥ 0) at the n-th branching time. Let (Fn , n ∈ N) be the
filtration induced by the process (zn ; n ∈ N). For every n > 1
Z ∞
X
(i)
n(T − tn , a)τ (da)
Êa (zn | Fn−1 ) =
n(T − tn , Ytn ) + c(T − tn )
0

2≤i≤dim(zn )

=

X

(i)

n(T − tn , Ytn ) + n(T − tn , 0)

2≤i≤dim(zn )

= zn−1 ,
where the second equality follows from the spatial boundary of the McKendrick-von Foerster equation. As already mentioned, the process (Zs ; s ≥ 0) is constant between two
branching times. As a consequence, (Zs ; s ≥ 0) is a martingale (w.r.t. its natural filtration) so for every s ≥ 0,
 X

(i)
n(T, a) = Êa
n(T − s, Ys ) .
i≤dim(Ys )

Relation (13) follows by taking s = T in the latter expression.
The proof ends by checking that when c is right-continuous, the RHS of (13) indeed
is a right-continuous solution to the PDE. This elementary step is left to the interested
reader.

19

t

(a,T)

T-𝙩1

T-𝙩2

T-𝙩3

a

Figure 2: Graphical representation of the process (Zs ; s ≥ 0). We start with a single
individual with residual lifetime a. In this picture, time flows downwards for the branching
process. The residual lifetime of the initial individual decreases linearly until reaching 0
(this corresponds to time T − t1 in our representation). At this time, the particle dies
and produces 2 red particules. Residual lifetimes travel along the characteristics of the
McKendrick-von Foerster PDE until reaching the spatial boundary condition {a = 0}
where a new branching occurs.

3

Two laws of large numbers

Theorem 7 (N individuals). Start with N individuals at time 0 with independent infection
and life-processes distributed according to the initial shifted law L̃g . Define the empirical
random measure for ages and types at time t
X
:=
µN
1σx <t δ(t−σx ,Xx (t−σx )) (da × {i}).
(14)
(da
×
{i})
t
x

As in Corollary 5, let
µ̄t (da × {i}) = n(t, a) × P(X(a) = i)da
where n is the unique L1,loc weak solution to the McKendrick-von Foerster PDE with
initial condition g. For every t > 0,
1 N
µ −−−→ µ̄t a.s.
N t N →∞
where the convergence is meant in the weak topology.
Proof. We have
µN
t (da

N
1 X 1,(i)
× {i}) =
µ (da × {i})
N i=1 t

20

(15)

1,(i)

where {µt } are independent copies of µ1t . Let f be an arbitrary measurable and bounded
function on R+ × S. The L.L.N. combined with Corollary 5 implies that


1 N
µ , f → hµ̄t , f i a.s.
N t
which ends the proof.
In the following, we are motivated by modeling a situation where the infection is
separated into two distinct phases. We start from a single individual.
(Phase 1) We let the epidemic develop until a certain random time tK . For instance, tK could
be the time at which the number of recorded deaths exceeds a large threshold K.
We assume no suppression before tK ;
(Phase 2) We let the suppression function vary after time tK , e.g., due to mitigation measures
and/or behavioral changes (i.e., lockdown phase).
We will see in Theorem 8 below that the dynamics after time tK converge to the same
solution as in Theorem 7 but with an exponential initial age density (g(x) = α exp(−αx))
and a (large) random number of initial infected individuals.
Let us now provide a more formal set-up. First ignore suppression and consider a plain
CMJ process starting from one individual with shifted law L̃g . Let us now assume that the
Malthusian parameter α of the CMJ process is strictly positive (supercritical assumption).
We assume that g is chosen in such a way that there is a positive probability of nonextinction (to avoid trivialities).S
Let Ft = σ ({(Px , Xx ) : x ∈ n Nn , σx < t}) be the σ-field generated by the observation of the infection and life-cycle processes of the individuals born before time t (including
the root ∅). Let {tK } be a sequence of stopping times (w.r.t. (Ft ; t ≥ 0)) with tK → ∞
a.s. on the non-extinction event.
Now we assume that the suppression function cK ≡ c of the CMJ depends on K and
that cK (t) := C(t − tK ), where (C(t); t ∈ R) is a piecewise continuous function in [0, 1]
such that C(t) = 1 for all t ≤ 0. Finally, µttK is again the empirical measure of ages and
types (as defined in (14)) w.r.t. the suppression function cK .
Example 1. Take
tK = inf{t > 0 : #{x ∈ ∪n Nn : σx < t, Xx (t − σx ) = D} ≥ K},
i.e., tK is the first time that the accumulated number of deaths reaches level K.
Further take C(t) = 1 if t ≤ 0 and C(t) = r < 1 if t > 0. This corresponds to a
lockdown strategy where transmission is reduced by a factor r upon reaching K deaths.
Theorem 8 (One individual). Conditional on non-extinction
• There exists a r.v. W∞ such that W∞ > 0 a.s. and
X
1(0 < σx < tK ) exp(−αtK ) −−−→ W∞
tK →∞

x

21

a.s. and in L1

• Fix t ≥ 0. We have
exp(−αtK )µttK
===⇒ W∞ µ̄t
K +t
tK →∞

in probability,

where the convergence is meant in the weak topology, and
µ̄t (da × {i}) = n(t, a) × P(X(a) = i)da
with n the unique L1,loc weak solution to the McKendrick-von Foerster PDE with
initial condition g(a) = α exp(−αa) and suppression function (C(t); t ≥ 0).
Proof. We recall some basic facts about the method of random characteristics. We consider a plain CMJ with no death (no suppression function, no types). Every individual
is characterized by an independent pair of random variables (P, χ). As before, P is the
infection measure recording the times of secondary infections. Now χ is a general stochastic process indexed by the age of the individual called a random characteristic with the
convention χ(−a) = 0 for a ≥ 0. In great generality, P and χ may exhibit a non-trivial
correlation. Define
X
Z χ (T ) =
χx (T − σx )
x

the branching process counted by the random characteristic χ at time T . We now recall
one of the main results of Jagers and Nerman [5] (see also Theorem 5, Appendix A in
[6]). On top of all the assumptions above, we make the two following extra assumptions
(a) There exists α0 < α such that


0
E sup exp(−α T )χ(T ) < ∞.

(16)

T ≥0

(b) T → E(χ(T )) is continuous a.e. with respect to the Lebesgue measure.
Then there exists a positive r.v. W∞ (independent of the choice of χ) such that conditional
on non-extinction
Z ∞
χ
Z (T ) exp(−αT ) → W∞
α exp(−αt)E(χ(t))dt a.s. and in L1 (dx) as T → ∞.
0

(Note that the L1 convergence holds thanks to the x log(x) condition (9).)
To illustrate the method, we recall that if we take χ(T ) = 1R+ (T ) then Z χ (T ) coincides with B(T ), the total number of births before time T . For this particular choice of
(deterministic) characteristic, the two properties above are immediately satisfied (recall
that α > 0), so that conditional on non-extinction
X
1(0 < σx < u) exp(−αu) → W∞ a.s. and in L1 (dx) as u → ∞.
(17)
x

The a.s. convergence ensures that the first item of our theorem is satisfied.
Next, the second part of the theorem requires a choice of characteristic, called ‘general
characteristic’, that depends on the descendance of each extant individual at time tK .
Because we need to prove an a.s. convergence result, whereas limit theorems on branching
processes counted with general characteristics only hold in distribution, we have to design
22

T+t

T+s

T

Figure 3: The individual x with characteristic (Px , Xx ) under consideration is represented
by a black segment. We graft independent (P ∗ , X ∗ )-CMJ processes with suppression
function t 7→ C(t − T ) to the atoms of Px occurring at time T + s, independently with
probability C(s) if s ≥ 0 and 0 if s < 0. We ignore all other atoms and their descendances
(lower dotted red tree s < 0, upper dotted tree s > 0).
by hand an individual characteristic that has the same distribution as the requested
general characteristic.
In order to define our next random characteristics, we start with some definition. Let
∗
(P , X ∗ ) be a pair of infection and life-cycle processes (that may or may not be identical
to (P, X) in distribution). One can construct a collection (Z (∆) ; ∆ ≥ 0) of (P ∗ , X ∗ )-CMJ
processes starting at respective times ∆ and with a suppression mechanism C, i.e.,
• Z (∆) is a (P ∗ , X ∗ )-CMJ process starting at time ∆ with one progenitor.
• The suppression function applied to infection events is C.
• The previous rule applies at time t = ∆, that is, Z (∆) is identically empty with
probability 1 − C(∆).
For any t ≥ ∆, we let ν (∆) (t) denote the empirical measure for ages and types of Z (∆) (t).
(∆)
Finally, we define {(νi ; ∆ ≥ 0)}i∈N∗ as the collection made of independent copies of the
collection (ν (∆) ; ∆ ≥ 0).
We are now ready to construct our random characteristics by enlarging the initial
CMJ process in the following way. Fix t ∈ R+ and f a bounded non-negative continuous
function on R × S with compact support in R+ × S. Consider a typical individual ∅, with
infection and life processes (P, X). Denote by (ri ) the atoms of P listed in increasing
order. For any T ≥ 0, define the individual random characteristic χ(t,f ) (T ), by
D
E
X
(r −T )
χ(t,f ) (T ) := f (T + t, X(T + t)) +
νi i (t), f ,
i:ri ∈P∩[T,T +t]

See Figure 3 for a intuitive constructing of the random characteristics.
From now on, we assume that (P ∗ , X ∗ ) is identical in law to (P, X), which implies
the following two crucial facts.
23

R∞
(i) E( 0 χ(t,f ) (a)g(a)da) = hµ̄t , f i where µ̄t is defined as in Corollary 5 with initial
condition g and suppression function C.
(ii) Let us now count our branching process by its random characteristic
X
(t.f )
)
Z χ (T ) =
χ(t,f
(T − σx ).
x
x

Since tK is a stopping time with respect to the filtration (Ft ; t ≥ 0), the branching
(t,f )
property implies that Z χ (tK ) is identical in distribution to µttK
, f where we
K +t
tK
remember that µt is the empirical measure w.r.t. the CMJ process with suppression
function cK : t 7→ C(t − tK ).
In order to apply the aforementioned result of Jagers and Nerman, we need to check
that condition (a), (b) above are satisfied. Condition (b) easily follows from the fact
that τ has a density. We now check the first condition. Consider a (P, X)-CMJ process,
assuming that the initial individual is un-shifted. For every s, let vs (da×{i}) the empirical
measure of ages and types at time s. We assumed f to be non-negative and thus


E sup hvs , f i ≤ kf k∞ B(t).
s∈[0,t]

Let a1 < a2 < · · · be the atoms of P between T and T + t. The random characteristic
under consideration is obtained by attaching independent (suppressed) CMJ processes
between T and T + t to the ai ’s and by summing up the respective empirical measures at
time T + t − ai . By construction, T ≤ T + t − ai ≤ T + t so that
! 



Z
T +t

E sup exp(−α0 T )χ(T )
T ≥0

≤E

sup hvs , f i E sup exp(−α0 T )
T ≥0

s∈[0,t]



0

Z

T +t

= kf k∞ B(t)E sup exp(−α T )
T ≥0

P(du)
T


P(du)

T

≤ R0 B(t)kf k∞ .
This shows that property (a) is satisfied for any 0 ≤ α0 < α. This shows that as v → ∞,
conditional on non-extinction

Z ∞
(t,f )
χ(t,f )
α exp(−αu)χ (u)
a.s.
Z
(v) exp(−αv) → W∞ E
0

As already pointed out in (i),
Z ∞

(t,f )
E
α exp(−αu)χ (u)du = hµ̄t , f i
0

where µ̄t is defined as in Corollary 5 with initial condition α exp(−αt) and suppression
(t,f )
function (C(t); t ≥ 0). Since the latter convergence is a.s. and Z χ (tK ) is identical in
law with µttK
, f (see (ii) above), the result follows.
K +t

24

4
4.1

Inference
Case study: the French COVID-19 epidemic

In this section, we illustrate how to use our framework to make inferences from macroscopic observables of the epidemic, e.g., incidence of positively tested patients, hospital or
ICU (intensive care unit) admissions, deaths, etc. We show how to use those observables
to extract the underlying age structure of the population, estimate model parameters and
forecast the future of the epidemic.
We focused on a longitudinal case study in France. From March 18 2020, the French
government has provided daily reports of the numbers of ICU and hospital admissions, of
deaths, of discharged patients, and of occupied ICU and hospital beds. Moreover, several
theoretical studies have already been conducted on the same dataset. This allowed us
to fix the values of some crucial biological parameters that had already been estimated
and to carry out a comparison with our method. We want to emphasize that the aim
of this section is to provide a mathematical framework in which convergence results can
be rigorously proved while remaining flexible enough for other applications. Our goal is
not to provide new estimates of epidemiological parameters for France, as many robust
estimates are already available. For instance we do not provide confidence intervals for
our estimates, and neither do we conduct a sensibility analysis.
The remainder of the section is laid out as follows. In Section 4.2 we identify the
mathematical quantities that impact the dynamics of the epidemic for large population
sizes. Section 4.3 then presents the choice of distribution we made for these quantities
and the parameters that need to be estimated. Finally, estimation of these parameters
from the French incidence data is performed in Section 4.4. We start by fitting a simple
model and then show how this model can be made more complex to account for more
complex incidence data.

4.2

The model

As mentioned previously, the age structure of the population cannot be directly accessed.
What is observed is a subset of the population with some characteristic of interest, for
instance individuals that have been tested positively, deceased individuals or discharged
patients. Recall that under the assumptions stated in Section 3, the number of individuals
that are in a given state i at time t converges to
Z ∞
n(t, a)P(X(a) = i)da,
0

where (n(t, a)) is the solution to the McKendrick-von Foerster equation. Note that the
assumptions of Theorem 8 are in essence that the epidemic has been ongoing for a long
enough time at the lockdown onset for the infected population to be large, which we
assume to hold true for France as the number of infected individuals on March 16 2020
was on the order of tens of thousands of individuals.
The McKendrick-von Foerster equation is determined by two quantities: (i) the average
infection measure τ defined in 2.1 and (ii) an initial condition, which is of the form
∀a ≥ 0,

n(0, a) = W αe−αa

25

for some initial number of infected individuals W and a parameter α which corresponds
to the exponential growth rate of the epidemic before the lockdown onset.
Therefore, using Theorem 8 to obtain a theoretical prediction for some observables
under consideration requires the knowledge of:
1. The intensity measure τ of secondary infections;
2. The initial number of infected W and the parameter α;
3. For each state i of interest the probability P(X(a) = i).
The next section exposes how we have parametrized these quantities.

4.3

Parametrization of the model

Average infection measure. Recall the definition of τ from Section 2.1. Let us further
define
τ (da)
,
R0 = τ ([0, ∞)),
τ̂ (da) =
τ ([0, ∞))
so that τ can be expressed as
τ (da) = R0 τ̂ (da).
The total mass of τ , R0 , is the mean number of secondary infections induced by a single
infected individual. Thus R0 corresponds to the basic reproduction number of the epidemic, and we leave it as a parameter to infer. The epidemiological interpretation of the
probability measure τ̂ is the following. Consider a large population of infected individuals.
Then, as the size of that population goes to infinity, the distribution of the time between
the infection of a uniformly sampled individual and the infection of its “parent” converges
to τ̂ . Therefore, τ̂ is the distribution of the so-called generation time of the epidemic,
which has already been estimated in several previous studies. We used the estimation
of [29], and assumed that τ̂ is a Weibull distribution, that is
τ̂ (da) =

k  a k−1 −(a/λ)k
e
da,
λ λ

(18)

where the values of the shape parameter k and scale parameter λ are recalled in Table 1.
Initial condition. The growth rate α is defined implicitly through equation (8). Moreover, we know that α corresponds to the exponential growth rate of any of the observables
of the epidemic before the lockdown onset. We chose to estimate α from the cumulative
number of deaths, which appeared to be more reliable than the number of positive tests
as the number of tests that have been conducted in the early phase of the epidemic in
France varied greatly. We simply estimated α using a linear regression on the logarithm
of the number of deaths from March 7 to March 20, 2020. The estimated α as well as the
corresponding R0 pre-lockdown are shown in Table 1. The number of infected individuals
at the time of lockdown was left as a parameter to infer.

26

Life-cycle. The last quantities that need to be defined are the one-dimensional marginals
of the life-cycle process (X(a); a ≥ 0). From now on, we assume that the sequence of states
visited by (X(a); a ≥ 0) is a Markov chain and that the sojourn times in each state is
Gamma distributed.
More specifically, we suppose that we are given a global dispersion parameter γ > 0
and that for each state i ∈ S, the time Di spent in state i follows a Gamma distribution
with expectation ti > 0 and variance ti /γ,
• E(Di ) = ti
• Var(Di ) = ti /γ
This assumption has the following consequence. Let i1 , . . . , ik be a possible sequence of
states of (X(a); a ≥ 0), and denote by Ti1 , . . . , Tik the respective entrance times in these
states. Then conditional on (X(a); a ≥ 0) successively visiting the states i1 , . . . , ik in this
order, we have
(Ti1 , . . . , Tik ) ∼ (0, Yt1 , . . . , Yt1 +···+tk−1 )
where (Yt )t≥0 is a Gamma process such that
Yt ∼

γ γt γt−1 −γa
a
e da.
Γ(γt)

Another advantage of this parametrization is that the 1d marginals of (X(a); a ≥ 0) can
be computed efficiently, while only requiring one parameter for each state of interest, and
a global dispersion parameter.

4.4

Fitting the model to incidence data

In this section, we fit six time series of the French epidemic: the number of ICU and
hospital admissions, the number of deaths, the number of occupied ICU and hospital
beds and the number of discharged patients. We provide two examples of Markov chains
that we use to fit these data. The first Markov chain is only used to fit the first three
curves, that we will call incidence curves, i.e., the daily number of ICU admissions, of
hospital admissions and of deaths. With the parametrization of the previous section, the
predictions of our model for these time series only involves the delay between infection
and death, ICU, or hospital admissions. We do not need to estimate the time between
hospitalization and discharge, which makes the model and the inference procedure easier.
Then we show how this model can be made more complex to fit the last three curves,
that we call prevalence curves. All parameter estimations were realized using the data
from March 18 to May 11, 2020. This time frame corresponds to the lockdown period in
France.
Fitting incidence data. In order to fit the incidence curves, we considered the simplest
model that can account for these three time series. The model is illustrated in Figure 4.
Upon infection, with probability 1 − phosp , an individual develops a mild form of
COVID-19 and is placed in state I, which encompasses all cases that do not require a
hospitalization. With probability phosp the individual has a severe infection and is placed
in state C. Individuals in state C are eventually hospitalized and moved to state H.
27

pICU
phosp

H

C

S

1-pICU

I

hospital
admission

TH

TU

R
ICU admission

R

infection

1-phosp

U

TD

1-pdeath

D

R

death

pdeath

age of
infection

Figure 4: Illustration of the admission model.
Then, with probability pICU individuals in state H are admitted in ICU and move to state
U . Otherwise they eventually recover and are discharged. Finally, individuals in state
U die with probability pdeath , or recover with probability 1 − pdeath . In this model, only
individuals in ICU may die.
As we are fitting the number of individuals that enter a state, and not the number of
individuals that are currently in that state, we only need to track the times TH , TU , and TD
elapsed between infection and hospital admission, ICU admission and death, respectively.
We will refer to this model as the admission model.
Estimations for phosp , pICU and of death probability conditional on hospitalization
(equal in our setting to pICU × pdeath ) in France have already been conducted in [11].
We used these estimates and considered the values of phosp , pICU and pdeath to be fixed.
All other parameters were estimated using a maximum likelihood procedure which is
described in Appendix A. The parameter estimations are provided in Table 2, and the
corresponding predicted values for the time series under consideration are displayed in
Figure 5. Overall, our simple model seems to match the observed data. Note however
that the model overestimates the number of ICU admissions in the second part of the
lockdown. This is likely due to a temporal reduction in the ICU admission probability
which has been reported in [11].
Our estimation of the basic reproduction number during the lockdown period is R0 =
0.745. This suggests that lockdown has reduced the basic reproduction number by a factor
0.23 compared to the beginning of the epidemic. Moreover, we estimated that 9.85 × 105
infections have occurred in France before March 17th. Both these values are in line with
previous estimates for France [30, 11].
We did not impose that TH < TU in the inference procedure. Interestingly we found
that the data are best explained by assuming that the mean of TH is 14.4 days, whereas
the mean of TU is 11.4 days. This indicates that the delay between infection and hospital
28

Figure 5: Best fit of the admission model. Solid line correspond to the number of hospital
admissions, ICU admissions and deaths predicted by the admission model. The dots are
the corresponding observed values.
Notation

Description

Value

Source

α

Pre-lockdown exponential growth rate

0.315

E

Rpre

Basic reproduction number before lockdown

3.25

E

k

Shape parameter of the generation time

2.83

[29]

λ

Scale parameter of the generation time

5.67

[29]

Table 1: Parameter values common to both models. In the “Source” column, “E” indicates
that the parameter has been estimated in the present work.
admission is shorter for individuals that end up in ICU, compared to the average time
between infection and hospitalization. Therefore it would be more appropriate to allow
individuals to have an admission to hospital delay that is different depending on whether
they will end up in ICU or not, modeling the fact that they have a more severe form of
the disease. We estimated the mean of TD , the time between infection and death, to be
18.6 days. This estimate is lower than but consistent with previous estimates based on
the study of individual-case data [3, 31, 32].
Fitting prevalence data. A first attempt to fit the prevalence curves could be to keep
the admission model of Figure 4 and to estimate the time between hospital admission
and discharge using the observed number of occupied ICU, hospital beds, and discharged
patients. However this only yields a poor fit of the data (see Appendix B). We identified
two main reasons for this discrepancy. First, we assumed that all individuals are admitted
to ICU prior to death. Using the probability estimated in [11] then yields that the
probability of dying conditional on being in ICU is 0.953. This value is unrealistically
high, and we need to assume that a fraction of hospital deaths occur without going through
the ICU. Second, under the admission model, the delay between hospital admission and
discharge is almost unimodal. However, the observed number of occupied hospital beds
rises fast but falls slowly. Such a shape cannot be easily accounted for by a unimodal
distribution for the time spent in hospital.
Taking into account the previous two points required us to make the model more com29

Notation

Description

Value

Source

R0

Basic reproduction number during
lockdown

0.745

E

W

Total number of infections before 9.85 × 105
March 17 2020

E

phosp

Probability of being hospitalized

0.036

[11]

pICU

Probability of entering ICU conditional
on being at the hospital

0.19

[11]

pICU · pdeath

Death probability conditional on being
hospitalized

0.181

[11]

TH

Delay between infection and hospital
admission

14.4 days

E

TU

Delay between infection and ICU admission

11.4 days

E

TD

Delay between infection and death

18.6 days

E

0.463

E

γ

Scale parameter common to all Gamma
distributions

Table 2: Inferred parameter set for the admission model. The values indicated for the
durations correspond to the means of the Gamma distributions. In the “Source” column,
“E” indicates that the parameter has been estimated in the current work.
plex. The resulting model, referred to as the occupancy model, is illustrated in Figure 6.
We now consider that upon infection, individuals go to one of three states depending on
the severity of their infection:
• The state Cu which gathers critical infections that lead to death or ICU admission.
The probability of having a critical infection is denoted by pcrit .
• The state Ch which corresponds to severe infections that require a hospitalization
but are not critical. Such infections occur with probability psev .
• The I state which consists of all mild infections that do not lead to a hospital
admission, and occur with probability 1 − pcrit − psev .
Individuals in state Ch are admitted to hospital after a duration DCh . Then, with
probability pshort they are discharged after a duration Dshort , while with probability 1 −
pshort they are discharged after a duration Dlong .
Critically infected individuals are admitted to hospital after a duration DCu . Upon
arrival at hospital, they die immediately with probability dhosp , or go to ICU after a
duration DHu . Individuals in ICU die with probability dICU after a delay DD . Otherwise
they are discharged after a stay of length DU .

30

1-dhosp

H

C

u

D

U
dicu

dhosp

1-pshort

H

C

h

pshort

I

DC h

discharge

ICU
admission

hospital
admission

infection

DC u

R
R

R
hospital
admission

1-psev-pcrit

D

DD

DU

Dshort

discharge

psev

S

R

death

pcrit

1-dicu

DU
Dlong

age of
infection

Figure 6: Illustration of the occupancy model
In our model, the probability of hospital admission is pcrit + psev , the probability of
ICU admission is pcrit (1 − dhosp ) and that of death is pcrit (dhosp + (1 − dhosp )dICU ). We
have fixed these three values to those estimated in [11], and we only had one remaining
parameter out of 4 (pcrit , psev , dshort , dICU ) to estimate from the data. We have fixed the
time DU to 1.5 days as estimated in [11]. All other parameters were estimated using the
same likelihood method as previously, which is described in Section A. The estimated
parameter set is shown in Table 3, while Figure 7 shows the best-fitting model.
The estimated parameters provide a good fit of the six observed time series. Again,
the model has a tendency to overestimate the ICU admissions in the second part of the
lockdown, which has the same interpretation as before.
Under the occupancy model, we estimated that R0 = 0.734, and W = 9.52×105 . These
estimates are extremely close to those made with the admission model. The estimated
mean time between infection and death or hospital, ICU admission are respectively 19.5
days, 13.7 days and 12.5 days. Again we see that these estimates in the more complex
model are consistent with those of the simple model. The mean recovery time from
hospital is 19.4 days for severe infections, and 28.2 days for critical infections. This
yields an overall mean recovery time of 20.0 days. Finally, we estimated that the death
probability conditional on being in ICU is 0.709. This yields that in our model a fraction
0.256 of all deaths occur shortly after hospital admission. This result is consistent with [11]
that estimated that a fraction 0.15 of all deaths occurred within the first day after hospital
admission. However, it has been reported in [33] that the death probability of ICU patients
is 0.23. Our estimated value is thus unrealistically high. This indicates that there is a
fraction of hospital deaths that occur without any ICU admission, and not quickly after
hospital admission, that our model is not accounting for.
31

Figure 7: Best fit of the admission model. The solid lines correspond to the number
of deaths, discharges, occupied ICU and hospital beds and ICU and hospital admissions
predicted by the occupancy model. The dots are the corresponding observed values.
Our estimates, though they are not the key message of the present paper, can nevertheless draw attention to potential heterogeneities in the infected population. We estimated
that the mean time between infection and ICU admission is shorter than that between
infection and hospital admission. This suggests that the time between infection and severe symptom onset is shorter for critical infection, that lead to ICU admission, than for
milder ones. Moreover, fitting the prevalence time series required to divide the hospital
and death compartments in two subcompartments, indicating that the data are not well
explained by a simple homogeneous model, as seen in Figure 8. Such heterogeneity could
originate from underlying structuring variables, such as comorbidity or (real) age, that we
are not accounting for. Many estimates of clinical features, such as the incubation period,
are obtained from a pooled dataset that does not take heterogeneity in the population
into account [34, 31, 35, 36, 37, 38, 14]. When estimating the total number of infected
individuals using only a fraction of the detected cases, e.g., using the hospital admissions
or deaths, it is interesting to keep in mind that the time periods estimated from pooled
studies could be inaccurate for the fraction of infected individuals under consideration.
Acknowledgements. The authors thank the Center for Interdisciplinary Research in
Biology (CIRB) for funding and the taskforce MODCOV19 of the INSMI (CNRS) for
their technical/scientific support during the epidemic. P.C. has received funding from
the European Union’s Horizon 2020 research and innovation program under the Marie
Skłodowska-Curie grant agreement PolyPath 844369.

32

Notation

Description

Value

Source

R0

Basic reproduction number during
lockdown

0.734

E

W

Total number of infections before 9.52 × 105
March 17 2020

E

pcrit + psev

Probability of being hospitalized

0.036

[11]

pcrit (1−dhosp )
pcrit +psev

Probability of entering ICU conditional
on being at the hospital

0.19

[11]

dhosp +(1−dhosp )dICU
1+psev /pcrit

Death probability conditional on being
hospitalized

0.181

[11]

dICU

Probability of death conditional on being in ICU

0.709

E

pshort

Probability of a short stay at hospital

0.701

E

DCh

Delay between severe infection and hospital admission

14.5 days

E

Dshort

Delay between hospital admission and
quick discharge

7.36 days

E

Dlong

Delay between hospital admission and
slow discharge

47.5 days

E

DCu

Delay between critical infection and
hospital admission

11.0 days

E

DH

Delay between hospital admission and
ICU admission

1.5 days

[11]

DU

Delay between ICU admission and discharge

28.2 days

E

DD

Delay between ICU admission and
death

9.90 days

E

γ

Scale parameter common to all Gamma
distributions

0.316

E

Table 3: Inferred parameter set for the occupancy model. The values indicated for the
durations correspond to the means of the Gamma distributions. In the “Source” column,
“E” indicates that the parameter has been estimated in the current work.

33

References
[1] H. Krauss. Zoonoses : infectious diseases transmissible from animals to humans.
ASM Press, 2003.
[2] Dorothy H. Crawford. Deadly companions: how microbes shaped our history. Oxford
University Press, second edition, 2018.
[3] Joseph T. Wu, Kathy Leung, Mary Bushman, Nishant Kishore, Rene Niehus,
Pablo M. de Salazar, Benjamin J. Cowling, Marc Lipsitch, and Gabriel M. Leung.
Estimating clinical severity of COVID-19 from the transmission dynamics in Wuhan,
China. Nature Medicine, 26(4):506–510, 2020.
[4] Olle Nerman. On the convergence of supercritical general (C-M-J) branching processes. Zeitschrift für Wahrscheinlichkeitstheorie und Verwandte Gebiete, 57(3):365–
395, 1981.
[5] Peter Jagers and Olle Nerman. The growth and composition of branching populations. Advances in Applied Probability, 16(2):221–259, 1984.
[6] Ziad Taïb. Branching Processes and Neutral Evolution, volume 93 of Lecture Notes
in Biomathematics. Springer Berlin Heidelberg, Berlin, Heidelberg, 1992.
[7] Tom Britton, Frank Ball, and Pieter Trapman. The disease-induced herd immunity
level for COVID-19 is substantially lower than the classical herd immunity level.
arXiv preprint arXiv:2005.03085, 2020.
[8] Tom Britton. Epidemics in heterogeneous communities: estimation of R0 and secure
vaccination coverage. Journal of the Royal Statistical Society: Series B (Statistical
Methodology), 63(4):705–715, 2001.
[9] Harry Cohn. Multitype finite mean supercritical age-dependent branching processes.
Journal of applied probability, 26(2):398–403, 1989.
[10] Jean-Jil Duchamps, Felix Foutel-Rodier, and Emmanuel Schertzer. From individualbased epidemic models to McKendrick-von Foerster PDE’s: the non-linear case. In
progress, 2020.
[11] Henrik Salje, Cécile Tran Kiem, Noémie Lefrancq, Noémie Courtejoie, Paolo Bosetti,
Juliette Paireau, Alessio Andronico, Nathanaël Hozé, Jehanne Richet, Claire-Lise
Dubost, Yann Le Strat, Justin Lessler, Daniel Levy-Bruhl, Arnaud Fontanet, Lulla
Opatowski, Pierre-Yves Boelle, and Simon Cauchemez. Estimating the burden of
SARS-CoV-2 in France. Science, 369(6500):208–211, 2020.
[12] Lionel Roques, Etienne K Klein, Julien Papaix, Antoine Sar, and Samuel Soubeyrand.
Using early data to estimate the actual infection fatality ratio from COVID-19 in
France. Biology, 9(5):97, 2020.
[13] Theodoros Evgeniou, Mathilde Fekom, Anton Ovchinnikov, Raphael Porcher,
Camille Pouchol, and Nicolas Vayatis. Epidemic models for personalised COVID19 isolation and exit policies using clinical risk predictions. medRxiv, 2020.
34

[14] Ramses Djidjou-Demasse, Yannis Michalakis, Marc Choisy, Micea T Sofonea, and
Samuel Alizon. Optimal COVID-19 epidemic control until vaccine deployment.
medRxiv, 2020.
[15] Thomas Sellke. On the asymptotic distribution of the size of a stochastic epidemic.
Journal of Applied Probability, 20(2):390–394, 1983.
[16] Guodong Pang and Etienne Pardoux. Functional limit theorems for non-Markovian
epidemic models. arXiv preprint arXiv:2003.03249, 2020.
[17] Frank Ball. A unified approach to the distribution of total size and total area under
the trajectory of infectives in epidemic models. Advances in Applied Probability,
18(2):289–310, 1986.
[18] Andrew D Barbour. The duration of the closed stochastic epidemic. Biometrika,
62(2):477–482, 1975.
[19] Peter Jagers. Branching processes with biological applications. Wiley, 1975.
[20] Jie Yen Fan, Kais Hamza, Peter Jagers, and Fima Klebaner. Convergence of the age
structure of general schemes of population processes. Bernoulli, 26(2):893–926, 2020.
[21] Peter Jagers and Olle Nerman. Limit theorems for sums determined by branching and
other exponentially growing processes. Stochastic Processes and their Applications,
17(1):47–71, 1984.
[22] Peter Jagers and Fima C Klebaner. Population-size-dependent, age-structured
branching processes linger around their carrying capacity. Journal of Applied Probability, 48(A):249–260, 2011.
[23] Peter Jagers and Fima C Klebaner. Population-size-dependent and age-dependent
branching processes. Stochastic Processes and their Applications, 87(2):235–254,
2000.
[24] Kais Hamza, Peter Jagers, and Fima C Klebaner. The age structure of populationdependent general branching processes in environments with a high carrying capacity.
Proceedings of the Steklov Institute of Mathematics, 282(1):90–105, 2013.
[25] Viet Chi Tran. Large population limit and time behaviour of a stochastic particle
model describing an age-structured population. ESAIM: Probability and Statistics,
12:345–386, 2008.
[26] Regis Ferriere and Viet Chi Tran. Stochastic and deterministic models for agestructured populations with genetically variable traits. In ESAIM: Proceedings, volume 27, pages 289–310. EDP Sciences, 2009.
[27] Peter Olofsson. The x log x condition for general branching processes. Journal of
applied probability, 35(3):537–544, 1998.
[28] Emmanuel Schertzer and Florian Simatos. Height and contour processes of CrumpMode-Jagers forests (I): general distribution and scaling limits in the case of short
edges. Electronic Journal of Probability, 23:43pp., 2018.
35

[29] Luca Ferretti, Chris Wymant, Michelle Kendall, Lele Zhao, Anel Nurtay, Lucie
Abeler-Dörner, Michael Parker, David Bonsall, and Christophe Fraser. Quantifying SARS-CoV-2 transmission suggests epidemic control with digital contact tracing.
Science, 368(6491), 2020.
[30] Mircea T. Sofonea, Bastien Reyné, Baptiste Elie, Ramsès Djidjou-Demasse, Christian Selinger, Yannis Michalakis, and Samuel Alizon. Epidemiological monitoring
and control perspectives: application of a parsimonious modelling framework to the
COVID-19 dynamics in France. medRxiv, 2020.
[31] Natalie M. Linton, Tetsuro Kobayashi, Yichi Yang, Katsuma Hayashi, Andrei R.
Akhmetzhanov, Sung-mok Jung, Baoyin Yuan, Ryo Kinoshita, and Hiroshi Nishiura.
Incubation period and other epidemiological characteristics of 2019 novel coronavirus
infections with right truncation: A statistical analysis of publicly available case data.
Journal of Clinical Medicine, 9(2):538, 2020.
[32] Robert Verity, Lucy C. Okell, Ilaria Dorigatti, Peter Winskill, Charles Whittaker,
Natsuko Imai, Gina Cuomo-Dannenburg, Hayley Thompson, Patrick G. T. Walker,
Han Fu, Amy Dighe, Jamie T. Griffin, Marc Baguelin, Sangeeta Bhatia, Adhiratha
Boonyasiri, Anne Cori, Zulma Cucunubá, Rich FitzJohn, Katy Gaythorpe, Will
Green, Arran Hamlet, Wes Hinsley, Daniel Laydon, Gemma Nedjati-Gilani, Steven
Riley, Sabine van Elsland, Erik Volz, Haowei Wang, Yuanrong Wang, Xiaoyue Xi,
Christl A. Donnelly, Azra C. Ghani, and Neil M. Ferguson. Estimates of the severity
of coronavirus disease 2019: a model-based analysis. The Lancet Infectious Diseases,
20(6):669–677, 2020.
[33] Santé Publique France. COVID-19 : point épidémiologique du 4 juin 2020, 2020.
[34] Jantien A. Backer, Don Klinkenberg, and Jacco Wallinga. Incubation period of 2019
novel coronavirus (2019-nCoV) infections among travellers from Wuhan, China, 20-28
January 2020. Eurosurveillance, 25(5), 2020.
[35] Stephen A Lauer, Kyra H Grantz, Qifang Bi, Forrest K Jones, Qulu Zheng, Hannah R
Meredith, Andrew S Azman, Nicholas G Reich, and Justin Lessler. The incubation
period of coronavirus disease 2019 (COVID-19) from publicly reported confirmed
cases: Estimation and application. Annals of internal medicine, 172(9):577–582,
2020.
[36] Lauren Tindale, Michelle Coombe, Jessica E Stockdale, Emma Garlock, Wing
Yin Venus Lau, Manu Saraswat, Yen-Hsiang Brian Lee, Louxin Zhang, Dongxuan
Chen, Jacco Wallinga, and Caroline Colijn. Transmission interval estimates suggest
pre-symptomatic spread of COVID-19. medRxiv, page 2020.03.03.20029983, 2020.
[37] Qifang Bi, Yongsheng Wu, Shujiang Mei, Chenfei Ye, Xuan Zou, Zhen Zhang, Xiaojian Liu, Lan Wei, Shaun A Truelove, Tong Zhang, Wei Gao, Cong Cheng, Xiujuan
Tang, Xiaoliang Wu, Yu Wu, Binbin Sun, Suli Huang, Yu Sun, Juncen Zhang, Ting
Ma, Justin Lessler, and Teijian Feng. Epidemiology and transmission of COVID-19
in Shenzhen China: Analysis of 391 cases and 1,286 of their close contacts. medRxiv,
2020.

36

[38] Clément Massonnaud, Jonathan Roux, and Pascal Crépey. COVID-19: Forecasting
short term hospital needs in France. medRxiv, 2020.
[39] Santé Publique France. Données hospitalières relatives à l’épidémie de COVID-19,
2020.

A

Maximum likelihood method

The incidence and prevalence data for France were taken from [39]. For a fixed set
of parameters, the solution n(t, a) to the McKendrick-von Foerster equation was solved
numerically using a Euler scheme and spatial boundary condition making use of τ = R0 τ̂
specified by (unknown, to be estimated) R0 and τ̂ fixed as in (18). The predicted number
of deaths, discharges, and ICU/hospital occupied beds were then computed numerically
using
Z
∞

∀t ≥ 0,

n(t, a)p(a, i)da,

ni (t) =
0

where ni (t) is the size of the subpopulation in state i at time t and p(a, i) = P(X(a) = i),
where X is the life process of a typical individual. The predicted incidence in state i
between time t and s, denoted by ñi (t, s), can be obtained using the expression
X
ñi (t, s) = ni (s) − ni (t) +
nj (s) − nj (t),
j

where the sums is taken over all states j such that the process (X(a))a≥0 can reach state
j after having visited state i. The predicted number of ICU/hospital admissions was
computed using this expression.
We considered a Poisson likelihood. More precisely, given the predicted values displayed previously, we assumed that the observed values follow a Poisson distribution
whose mean is the corresponding predicted values. We supposed that Poisson observations were independent among days, and among time series. This yields a product-form
expression for the likelihood of the data. We then looked for the parameter set that
maximizes this likelihood.
The maximum likelihood parameter set was obtained using the minimize function
of the Python scipy.optimize module, using a Nelder-Mead algorithm. We selected
as initial point of the optimization algorithm a set of parameters that were close to the
existing estimates in the literature, or which seemed realistic if such estimates did not
exist.

B

Best fitting prevalence curves under admission model

Recall the admission model from Section 4.4. By adding two parameters to the model,
one for the mean time between hospital admission and discharge, the other for the mean
time between ICU admission and discharge, we can derive an expression for the likelihood
of the prevalence and incidence time series under the admission model. The best-fitting
values for these two parameters were obtained by maximizing the likelihood with all
other parameters values fixed to those estimated in Table 2. The corresponding model is
displayed in Figure 8.
37

Figure 8: Best fit of the admission model for prevalence data.

38

