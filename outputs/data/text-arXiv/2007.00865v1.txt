System inference for the spatio-temporal evolution of infectious

arXiv:2007.00865v1 [q-bio.PE] 2 Jul 2020

diseases: Michigan in the time of COVID-19
Z. Wang, X. Zhang, G.H. Teichert, M. Carrasco-Teja & K. Garikipati∗
Mechanical Engineering, Mathematics and the Michigan Institute for Computational
Discovery & Engineering, University of Michigan
July 3, 2020

Abstract
We extend the classical SIR model of infectious disease spread to account for time dependence
in the parameters, which also include diffusivities. The temporal dependence accounts for
the changing characteristics of testing, quarantine and treatment protocols, while diffusivity
incorporates a mobile population. This model has been applied to data on the evolution of the
COVID-19 pandemic in the US state of Michigan. For system inference, we use recent advances;
specifically our framework for Variational System Identification (Wang et al., Comp. Meth. App.
Mech. Eng., 356, 44-74, 2019; arXiv:2001.04816 [cs.CE]) as well as Bayesian machine learning
methods.

1

Background

Starting from their origins in the the work of Kermack & McKendrick[1], the use of differential
equation models of the course of infectious diseases has grown to become one of the more accessible
instances of the reach of mathematics. The current COVID-19 Pandemic has brought them into the
common parlance. Even before this, however, the baseline Susceptible-Infected-Recovered (SIR)
model had been extended to include Exposed (E) and Deceased (D) compartments and applied with
considerable success to influenza, ebola, malaria, cholera, tuberculosis and several other infectious
diseases[2–5]. (Some of this literature also includes agent-based models, which we do not consider
here.) During the COVID-19 Pandemic, the widespread availability of data in the public domain [6–
11] has served to attract methods of mathematics, computation and data science to analyzing this
information, inferring the disease’s dynamics and making projections. The present communication
is in this spirit, and brings our recent work in large scale computations of partial differential
equations (PDEs), system inference and machine learning to this problem [12–17].
∗

Corresponding author, krishna@umich.edu

1

Of particular interest to us are two lines of enquiry: The first is that for a rapidly evolving
disease such as COVID-19, with its public health, population-based, political, travel and economic
manifestations, the classical SIR model of ordinary differential equations (ODEs) with constant
coefficients seems inadequate. Driven by data that extends the compartments to the deceased
(D), we have adopted the SIRD model. The first extension that we have undertaken is to allow
the ODE coefficients to vary in time to reflect the evolving contours of testing, quarantine and
treatment protocols. This is not necessarily novel, and has been addressed in other work [2, 18],
although perhaps not with the inference approach of Variational System Identification (VSI) and
ODE-constrained optimization that we have adopted.
The second is the fact of a mobile population. Population mobility has been addressed through
metapopulation models that characterize how diseases move between population hubs, across countries, or even internationally. The most widely known are gravity models (e.g. [19]), and network
and agent based models [20]. Given the prominence that quarantine protocols–adorned with the
current-day euphemism of “social distancing”–have played in the COVID-19 Pandemic, it appears
natural to seek an extension of the SIRD model to a spatio-temporal PDE model. As the world
went into lockdown, but at different rates and degrees of rigor, and then began to emerge from
it, the detection of patterns of mobility in space and time presents a compelling avenue for investigation. Such an extension also has been considered–chiefly in the setting of the mathematical
analysis of reaction-diffusion systems [21–23]. Our contribution to this aspect of the mathematical
treatment is to also allow the diffusivity of the S, I and R sub-populations to vary with time.
To these tasks we have brought the abundance of high-quality, public domain, data on the
evolution of the various compartment pertaining to the SIRD model in the US state of Michigan.
The temporal resolution by days and spatial resolution by the 85 counties of Michigan has allowed
us to apply our methods of Variational System Identification [12, 13], PDE-constrained optimization
and machine learning [14–17] to these data.
In Section 2 we review the foundational SIRD ODE model. Section 3 is on data preparation.
The application of system identification and machine learning to the ODE system are, respectively,
in Sections 4 and 5. The results for inferred parameters and forward simulation prediction are
presented in Section 6. The extension to inferring mobility via reaction-diffusion systems is in
Section 7. Our conclusions appear in Section 8.

2

The compartmental model of infectious disease dynamics

We use the SIRD version of compartmental epidemiology models. The population, taken to remain
constant at N , is divided into four disjoint compartments with time-dependent sub-populations:
S(t) for susceptible, I(t) for infected, R(t) for recovered and D(t) for deceased individuals. The

2

governing ODEs are:
dS
β
= − SI + γR
dt
N

(1)

dI
β
= SI − µI − αI
dt
N

(2)

dR
= µI − γR
dt

(3)

dD
= αI
dt

(4)

N = S(t) + I(t) + R(t) + D(t).

(5)

This is the canonical form of the model where the sub-populations are assumed to be well-mixed so
that spatial variations can be ignored over the domain of interest. Here β(t) is the infection rate,
µ(t) is the recovery rate, γ(t) is the rate of immunity loss, and α(t) is the death rate–all allowed to
vary with time. Using the natural temporal unit of one day, we note that 1/µ(t) is also the number
of days an individual remains infectious. It follows that β(t)/µ(t) is the effective reproduction rate:
the total number of the susceptible population that an infectious individual passes the disease to.
This quantity is commonly denoted by R0 , but we use r0 (t) = β(t)/µ(t), to distinguish it from the
recovered population, and emphasizing that it, too, varies with time.
We reiterate what we have outlined in the Background (Section 1). Given the rapidly varying
nature of testing, reporting, treatment protocols and quarantine conditions over the course of an
epidemic, it is natural to allow the coefficients in the SIRD model, Equations (1-4) to vary with
time. Such variation is evident in epidemiological data. The reader may be familiar with the time
varying nature of such factors over the course of the COVID-19 Pandemic. It is a central feature
of data preparation in the following section.

3

Data preparation

Counts of new confirmed infected cases I(t) and deaths D(t) were reported in the public domain
on a daily basis by the state of Michigan for each county [25], while total recovered cases in the
state R(t) were reported weekly [26]. See Figure 1 for the counties and regions that Michigan is
partitioned into. Since county specific recovery data was not reported, the distribution of recovered
cases across counties was approximated to be the same as the distribution of cumulative infected
Rt
cases, 0 I(τ )dτ across counties. Estimates for the populations of Michigan’s counties [27] were
used to determine the susceptible population, S(t), from Equation (5).
Some amount of data smoothing was necessary, particularly to account for the weekly instead
of daily reporting of the number of recovered cases. To compare the effect of the smoothing method
3

8

7
6

4
1
5

2
3

Figure 1: The map of Michigan delineating the counties and regions (modified from [24]).
on the data, a moving average filter was applied using 7, 11, and 15-day windows, guided by the
week-long period of oscillation in the raw data for daily new infections I(t) − I(t − 1). The 7-day
window was applied one, two, and three times. As seen in Figure 2, the method of smoothing has
little effect on the trends of the data. However, and as expected, there is a strong effect on the
numerical time derivatives (see Figure 3). It is clear that multiple passes of the filter are required to
remove jumps in dR/dt and dI/dt. Since the additional smoothing is helpful for system inference
in Section 4 and does not negatively affect the data, the 7-day moving average filter applied three
times was used for data smoothing.
The lockdown in Michigan began on March 23, 2020. For brevity, we use C for the date when
the outdoor construction industry was allowed to resume on May 1, 2020, M for the restart of
some manufacturing on May 7, 2020, R for reopening of research laboratories on May 15, 2020, O

4

0

20

40

S

60

80

100

0

7days_1x
7days_2x
7days_3x
11days_1x
14days_1x

9870000
9860000

60

80

100

7days_1x
7days_2x
7days_3x
11days_1x
14days_1x

20000
15000
10000

9830000

5000

Lockdown
(Mar 23)
0

30000

I

25000

9840000

40000

40

30000

9850000

50000

20

C M
20

40

R

R

O
(Jun 1)
60

E
80

Lockdown
(Mar 23)

100

6000

7days_1x
7days_2x
7days_3x
11days_1x
14days_1x

5000
4000

20

40

R

D

O
(Jun 1)
60

E
80

100

7days_1x
7days_2x
7days_3x
11days_1x
14days_1x

3000

20000

2000

10000
0
Lockdown
(Mar 23)

0

C M

1000
C M

R

O
(Jun 1)

0
Lockdown
(Mar 23)

E

C M

R

O
(Jun 1)

E

Figure 2: Cumulative data with different kernel widths and multiples of application of the smoothing
filter: 7days 1× represents a 7-day filter applied once. Important dates are marked with the
lockdown on March 23, reopening of construction and real estate sites (C) on May 1, reopening
of manufacturing sites (M) on May 7, permission. to restart laboratory research (R) on May 15,
lifting of stay-at-home order (O) on June 1, and the end of our data collection (E) on June 28.
for broader opening of most other activities and lifting of the stay at home order on June 1, 2020
(albeit with distancing guidelines in place), and E for the end of the data period that we considered
(June 28, 2020). This notation is used for the rest of this communication.

5

0

0

20

40

S
t

60

80

0

7days_1x
7days_2x
7days_3x
11days_1x
14days_1x

200
400

20

40

I
t

60

80
7days_1x
7days_2x
7days_3x
11days_1x
14days_1x

1000
500

600

0

800
500

1000
1200
Lockdown
(Mar 23)
0
1200
1000
800

C M
20

40

R
R
t

O
(Jun 1)
60

1000
Lockdown
(Mar 23)

E
80

0

7days_1x
7days_2x
7days_3x
11days_1x
14days_1x

20

40

R
D
t

O
(Jun 1)
60

E
80
7days_1x
7days_2x
7days_3x
11days_1x
14days_1x

140
120
100
80

600

60

400

40

200
0
Lockdown
(Mar 23)

C M

20
C M

R

O
(Jun 1)

0
Lockdown
(Mar 23)

E

C M

R

O
(Jun 1)

E

Figure 3: Time derivatives (daily change) of sub-population data with different kernel widths and
multiples of application of the smoothing filter. Important dates are marked with the lockdown on
March 23, reopening of construction and real estate sites (C) on May 1, reopening of manufacturing
sites (M) on May 7, permission. to restart laboratory research (R) on May 15, lifting of stay-athome order (O) on June 1, and the end of our data collection (E) on June 28.

4

System Identification and ODE-constrained optimization

The SIRD model, Equations (1-4) was time-discretized using the Backward Euler method and
written as:
d − Sd
Sm
β d d
m−1
d
+ Sm
Im − γRm
=0
∆t
N

(6)

d − Id
Im
β d d
m−1
d
d
− Sm
Im + µIm
+ αIm
=0
∆t
N

(7)

d − Rd
Rm
m−1
d
d
− µIm
+ γRm
=0
∆t

(8)

d − Dd
Dm
m−1
d
− αIm
=0
∆t

(9)

6

d , I d , Rd , D d are the corresponding data (smoothed as in Section 3) at time t (the end
where Sm
m
m
m
m
th
d
d
d
d
of the m day), ∆t = 1 day and Equation (5) holds: Sm = N − Im − Rm − Dm .
The system identification problem is to infer the time-dependent coefficients β(t), γ(t), µ(t), α(t),
which we choose to expand in a polynomial basis (other choices of bases are admissible).

β(t) = θ0 + θ1 t + θ2 t2 + θ3 t3

(10)

γ(t) = θ4 + θ5 t + θ6 t2 + θ7 t3

(11)

µ(t) = θ8 + θ9 t + θ10 t2 + θ11 t3

(12)

α(t) = θ12 + θ13 t + θ14 t2 + θ15 t3

(13)

The parameters to be inferred are collected into a vector θ = hθ0 , . . . , θ15 iT . Since the data are
known the label vector can be constructed as:
 d d

Sm −Sm−1 



 d ∆td




 Im −Im−1 

∆t
ym =
(14)
d
d
Rm −Rm−1 





∆t


d −D d


 Dm
m−1 
∆t

and a matrix can be assembled from the reaction terms in the time-discretized SIRD equations
(6-9):

 d d
Sm Im
2 3
d h1 t t2 t3 i
−Rm
h0 0 0 0i
h0 0 0 0i
m m m
N h1 tm tm tm i

 Sd I d
d h1 t t2 t3 i
2 t3 i 
 − m m h1 tm t2m t3m i
h0
0
0
0i
I
I
h1
t
t
m
m
m
m
m
m
m
m
N
 (15)
Ξm = 


d h1 t t2 t3 i
d h1 t t2 t3 i
h0 0 0 0i
Rm
−Im
h0 0 0 0i


m m m
m m m
d
2
3
h0 0 0 0i
h0 0 0 0i
h0 0 0 0i
−Im h1 tm tm tm i
The columns of Ξm can be regarded as discretized versions of the basis operators that appear as
reaction terms on the right hand-side of the SIRD model (1-4). The label vectors and matrices of
basis operators at times t0 , . . . tM are collected into






Ξ
y
0


0


 . 
..
. 
, Ξ= 
(16)
y=
.
 . 




 y 
ΞM
M
| {z }
| {z }
4(M +1)×1

4(M +1)×16

and the residual vector is defined:
R(θ) = y − Ξθ

7

(17)

Our approach to inference combines system identification by stepwise regression [12, 13] and
ODE-constrained optimization using adjoints. We define a loss function that incorporates penalization on θ (leading to ridge regression below):
1
`(θ) = |R(θ)|2 + λ|θ|2
2

(18)

Our stepwise regression techniques incorporate two algorithms listed next:
Algorithm 1: Model selection by Stepwise regression:
j = 0, Q = 0,
While j ≤ P − 1 − Q do
Step 0:
Establish target vector y and matrix of bases Ξ.
Step 1:
Solve for θ j by ridge regression:

e
θ j = arg min `(θ)
e
θ

−1 T
= ΞT Ξ + λ1
Ξ y

(19)

Calculate the loss function at this iteration, `j .
Step 2:
Apply the F -test introduced below.
IF F -test eliminates an operator
THEN Set Q = Q + 1
Set to zero the corresponding component of θ.
GOTO Step 1. %Loss function remains small (`j ∼ `j−1 ); solution may
be overfit.
ENDIF

Step 3:
Stop if the F -test does not allow elimination of any more basis
operators.
% Beyond this, the loss function increases dramatically for any
further reduction.
There are several possible criteria for eliminating basis terms. Here, we adopt a widely used
statistical criterion called the F -test, also used by us previously [12, 13]. The significance of the
8

change between the model at iterations j and j − 1 is evaluated by:
F =

`j −`j−1
pj−1 −pj
lj−1
P −pj−1

(20)

where pj is the number of bases at iteration j and P = 16 is the total number of operator bases.
The F -test is achieved through the following algorithm:
Algorithm 2: Application of the F -test:
Step 1: %Find the least significant basis
i=0
While i ≤ P − 1 − Q
Tentatively eliminate each basis corresponding to
non-zero coefficients in θ
Set the corresponding coefficient to zero in θ.
Evaluate the loss function followed by ridge regression on the
reduced basis set.
Compute the F -value on the reduced basis set with smallest loss
function. Label this coefficient θk
Step 2:
IF F < α
THEN formally eliminate the term corresponding to θk in matrix Ξ, by
deleting the corresponding column.
ENDIF
Model selection thus finds θ consisting of a minimal set of non-zero components, ensuring that
the coefficients β(t), . . . , α(t) admit a parsimonious representation as polynomials in t. For clarity,
we collect this set of non-zero coefficients into another vector, ϑ0 . Using dim(•) to represent the
dimension of a Euclidean vector, we have dim(ϑ0 ) ≤ dim(θ).
The next step is to further refine the values of the non-zero polynomial coefficients using ODEe Im (ϑ),
e Rm (ϑ),
e Im (ϑ)
e
constrained optimization starting from the initial guess ϑ0 , and regarding Sm (ϑ),
as the forward solution to the discretized SIRD model (22-25) with coefficient β(t), . . . , α(t) values
e
drawn from ϑ:
!2
!2
!2
!2
M
d
d
d
X
e
e
e
e − Sd
I
(
ϑ)
−
I
R
(
ϑ)
−
R
D
(
ϑ)
−
D
Sm (ϑ)
m
m
m
m
m
m
m
+
+
+
ϑ = arg min
W
W
W
W
e
1
2
3
4
ϑ
m=0
(21)

9

Subject to the discretized SIRD model:
∀ m ∈ {0, . . . , M }
e − Sm−1 (ϑ)
e
Sm (ϑ)
β
e m (ϑ)
e − γRm (ϑ)
e =0
+ Sm (ϑ)I
∆t
N

(22)

e − Im−1 (ϑ)
e
Im (ϑ)
β
e m (ϑ)
e + µIm (ϑ)
e + αIm (ϑ)
e =0
− Sm (ϑ)I
∆t
N

(23)

e − Rm−1 (ϑ)
e
Rm (ϑ)
e + γRm (ϑ)
e =0
− µIm (ϑ)
∆t

(24)

e − Dm−1 (ϑ)
e
Dm (ϑ)
e =0
− αIm (ϑ)
∆t

(25)

where
d
d
W1 = max Sm
− min Sm
m

m

d
d
W2 = max Im
− min Im
m

m

d
d
W3 = max Rm
− min Rm
m

m

d
d
W4 = max Dm
− min Dm
m

m

The ODE-constrained optimization problem is solved iteratively, and requires the gradient of
e We adopt the classical approach requiring a single
the ODE constraint (22-25) with respect to ϑ.
solution of the adjoint equation of the original ODE-constraint in each iteration. In this work
we use the L-BFGS-B optimization algorithm from SciPy[28] and the dolfin-adjoint software
library [29] to compute the gradient.

5

Deep and Bayesian neural networks

We also explore multilayer feedforward neural networks (NNs), which are universal function apd , I d , Rd , D d at discrete times
proximators [30], to learn the disease’s dynamics via the data Sm
m
m
m
and to infer the coefficients in Equations (1-4), as an alternative to the approach presented in
Section 4. Specifically, we construct two NNs to represent the data, with one as a deterministic
d , Rd , D d ∆t} as features and
model and the other being a probabilistic model. Both NNs take {Im
m
m
d
d
d
{Im+k
, Rm+k
, Dm+k
} as labels. Thus, the two NNs make predictions on case numbers at day m + k
based on case numbers reported at day m. In this work, k is chosen to vary from 1 to M − m,
10

d and S d
where M = 97 is the number of days that we used data for. In both types of NNs, Sm
m+k
are computed based on the constraint Equation (5).
The deterministic model is a deep neural network (DNN) that consists of multiple fully connected layers, whose model parameters (i.e. weights and bias) can be obtained in a straightforward
manner by minimizing the loss function

LDNN = MSE

(26)

through an optimization algorithm, such as stochastic gradient descent, via backpropagation. The
probabilistic model is a Bayesian neural network (BNN), which also consists of multiple fully
connected layers, but with its model parameters (i.e. weights and bias) being sampled from a
posterior distribution P (θ|D) that is computed based on Bayes’ theorem
P (θ|D) =

P (D|θ)P (θ)
,
P (D)

(27)

where D denote the i.i.d. observations (training data) and P represents the probability density
function. In Equation (27), P (D|θ) is the likelihood, P (θ) is the prior probability, and P (D)
is the evidence, respectively. The posterior distribution of θ is computed based on variational
inference (VI), which approximates the exact posterior distribution P (θ|D) with a more tractable
distribution Q(θ) by minimizing the Kullback-Leibler (KL) divergence [31–33]
Q∗ = arg min KL(Q(θ)||P (θ|D)).

(28)

The KL divergence is computed as
KL(Q(θ)||P (θ|D)) = E[log Q(θ)] − E[log P (θ, D)] + log P (D),

(29)

which requires computing the logarithm of the evidence, logP (D) in Equation (27) [32]. Since
P (D) is hard to compute, it is challenging to directly evaluate the objective function in Equation
(28). Alternately, we can optimize the evidence lower bound (ELBO) defined as
ELBO(Q) = E[log P (θ, D)] − E[log Q(θ)],

(30)

which is equivalent to the KL-divergence up to an additive constant coming from the evidence.
Thus, maximizing the ELBO is equivalent to minimizing the KL-divergence. The loss function for
the BNN has the following form:
LBNN = ω1 MSE + ω2 ELBO,

(31)

where ω1 and ω2 are weighting parameters, with ω1 = 50 and ω2 = 1 being chosen in this work. A
specific weight perturbation method, known as Flipout [34], is followed to infer Q(θ) by minimizing

11

Layer type

Description
DNN
d , Rd , D d ∆t
Im
m
m
neurons = 40 (Sigmoid)
neurons = 40 (Sigmoid)
d
d
d
Im+k
, Rm+k
, Dm+k
(Softplus)

Input layer (features)
Dense layer
Dense layer
Output Dense Layer (labels)
BNN
Input layer (features)
DenseFlipout layer
DenseFlipout layer
Output DenseFlipout Layer (labels)

d , Rd , D d ∆t
Im
m
m
neurons = 40 (Sigmoid)
neurons = 40 (Sigmoid)
d
d
d
Im+k
, Rm+k
, Dm+k
(Softplus)

Table 1: Model architecture for the DNN and BNN. Note: Dense and DenseFlipout refer to
specific NN architectures (layers) used in the TensorFlow Library.
Equation (31) through mini-batch training via backpropagation with stochastic optimization algorithms. Flipout has been implemented in the TensorFlow Probability Library. The architectures
of both NNs are summarized in Table 1. Both NNs were trained by using the Adam optimizer
following an exponentially decaying learning rate


Ntotal
lr = lr0 · pow vdecay ,
(32)
Ndecay
with an initial learning rate lr0 = 0.001, a decay rate vdecay = 0.91, a decay step Ndecay = 100, and
a final Ntotal = 10000 epochs.

6

Results

Because of the extremely nonuniform distribution of the population of Michigan, we first studied the
SIRD model for the entire state consisting of the lower and upper peninsulas (Figure 1). Following
this, the SIRD models were inferred for the eight Regions (also shown in Figure 1) individually as
one direct approach to study the effect of spatial variations in the populations and sub-populations
corresponding to the model’s compartments.

6.1

System identification and ODE-constrained optimization

Figure 4 shows the progression of stepwise regression to infer the active time-dependent terms in
Equations (10-13) via Algorithms 1 and 2. The stem-and-leaf plots on the left illustrate the fate of
the terms θ0 − θ15 t3 over eight iterations of stepwise regression. Each stem-and-leaf represents one
term out of θ0 − θ15 t3 and the values are scaled to 1 (active) or 0 (inactive) for each iteration. On
12

the right is the loss, which remains low until Iteration 10 and increases dramatically in Iteration 11,
if any further terms are eliminated. Following the F -test used in Algorithm 2, the large increase in
loss after Iteration 10 exceeds the threshold for acceptable model error. Thus system identification
converges to the inferred model in ten iterations.

Figure 4: Left: Stem-and-leaf plot illustrating system identification of active time-dependent SIRD
parameters using data for the entire state of Michigan. Each stem-and-leaf represents one term of
θ0 , . . . θ15 t3 , scaled to 1 (active) or 0 (inactive). Right: The changing loss as terms are eliminated
from the set of time-dependent coefficients. System identification converges at Iteration 10 as the
loss increases dramatically for further elimination of terms.
Figure 5 shows, on the left, the evolution of SIRD model parameters and, on the right, a comparison of the predictions of the inferred model versus the data after ODE-constrained optimization
that follows the system identification step. It is important to recall that these results are representative of the population of the entire state of Michigan. The SIRD model, having only four
compartments, and applied to data that are the outcome of changing characteristics of testing,
quarantine and treatment protocols, does not resolve many details of the public health aspects of
the epidemic. The immunological characteristics of the disease itself are accounted for only in a
very aggregated sense.
In Figure 5, the important dates when the lockdown was imposed, and its gradual lifting are
indicated by vertical lines to aid an understanding of the results. We first draw attention to the
conclusion that γ(t) = 0; the inference indicates that recovery from COVID-19 confers permanent
immunity–an important conclusion, that remains to be confirmed by immunologists. As may be
expected, the population’s infection rate, β(t), declined as the initially higher rates of positive
diagnoses fell with fewer infected individuals. However, it began to rise again upon the opening of
construction activities (C), and continued to do so through the lifting of stay at home orders (O).
The recovery rate, µ(t), showed a long initial increase as growing numbers of infected individuals
recovered. Our interpretation of the initially high death rate, α(t), is that many of the early cases
13

already had advanced progression of the disease. Its rapid decline can be attributed to the ramp
up of the public health campaign, hospitalization and emergency response of the medical system.
The success that the state of Michigan gained by mandating an aggressive lockdown of nearly
all societal, educational, commercial and industrial activity is best reflected in the rapid decline
of the effective reproduction rate, r0 (t). According to the inference presented here, r0 (t) < 1.0
for m > 32 (April 24, 2020), after which the typical infected individual passed the disease on to
less than one other person. The death rate increased over the last few days for which data were
obtained, perhaps as some number of individuals who had been infected for a longer time failed to
recover. This affected the recovery rate as well, which fell. The close match between the simulations
with the inferred ODE SIRD model and data (Figure 5, right plot) validate the systems inferred.
Such validation against the data holds for all the inferred results presented in this communication,
although the non-uniqueness of inverse problems does not preclude the existence of multiple sets
of inferred coefficients.
0.10

0

(t)

50

100

0

r0(t)
50

100

S

50

9860000

2

0.05

0

9840000

Lockdown
(Mar 23)
0

CM R O
(Jun 1)

(t)

50

0
Lockdown
(Mar 23)

100

0

CM R

(t)

O
(Jun 1)

50

E

Lockdown
(Mar 23)

100

0
50000

0.004

0.1
0.0
Lockdown
(Mar 23)

E

CM R O
(Jun 1)

0.002
E
Lockdown
(Mar 23)

25000
CM R O
(Jun 1)

0
Lockdown
(Mar 23)

E

100
0
prediction 30000
data
20000
10000

CM R O
(Jun 1)

R

50

E

Lockdown
(Mar 23)

100

0

prediction
data
CM R O
(Jun 1)

I

50

100

prediction
data
CM R O
(Jun 1)

D

50

E
100

5000
2500
E

0
Lockdown
(Mar 23)

prediction
data
CM R O
(Jun 1)

E

Figure 5: Left: The time-dependent SIRD parameters after tuning by ODE-constrained optiization
following. system identification are: β(t) = 0.0756 − 0.0029t + 3.33 × 10−5 t3 , γ(t) = 0, µ(t) = 1.78 ×
10−5 t2 , α(t) = 0.0053 − 2.8 × 10−6 t2 + 2.93 × 10−8 t3 . Right: Simulation of the four compartments
using the inferred ODE SIRD model, in comparison with the data.
Figures 6 and 7 illustrate the time-dependent SIRD coefficients and comparison between data
and simulated (with the inferred ODE SIRD model) of the disease for Regions 1-8 delineated in
Figure 1. This is an important step toward a more fine-grained understanding of the geographical
distribution of the disease in the state. The Southeastern part of the state is more heavily populated,
especially Regions 2 and 3, which also bore the greatest burden of the disease. The city of Detroit,
at the Western tip of Region 3, was the worst affected, reflecting its well-known socio-economic
challenges. By contrast, Washtenaw County, about 50 km to the East, but also in Region 3, bore
among the lowest burdens, per capita. At the risk of stating the obvious, we note that Regions
1-4, which account for nearly 80% of the state’s population displayed very similar characteristics
in the evolution of the data, as well as in SIRD coefficients and forward simulation results. We do
14

not enter a more detailed analysis of these results here, deferring a different approach to spatial
aspects of the spread of the disease to Section 7.

6.2

Deep and Bayesian neural networks

To infer the coefficients β(t), γ(t), µ(t), α(t), we first compute the time derivatives of S(t), I(t), R(t), D(t)
by using the automatic differentiation API from TensorFlow. The coefficients are then computed
by inverting Equations (1-4) at each time instant. For DNNs, we obtained deterministic results for
all the coefficients. With BNNs, a Monte Carlo Sampling is performed to compute the mean and
the standard deviation of the coefficients.
d from I d , Rd , D d . This ensures that the
The constraint Equation (5) is used to obtain Sm
m
m
m
discrete time derivatives in Equations (22-25) satisfy
d − Sd
d
d
d
Sm
I d − Im−1
Rd − Rm−1
Dd − Dm−1
m−1
=− m
− m
− m
(33)
∆t
∆t
∆t
∆t
The constraint Equation (5) also has been imposed in the DNN and BNN representations by
training networks for I, R and D and then defining the network for S by this conservation of
total population. Therefore, in using Equations (1-4) to invert the DNN/BNN representations for
β(t), γ(t), µ(t), α(t) at each time instant, a linear dependence is encountered: The summed left
and right hand-sides of (2-4) exactly equal the left and right hand-side of (1), respectively. A
unique solution for β(t), γ(t), µ(t), α(t) is not possible due to linear dependence introduced by the
population constraint. To circumvent this indeterminacy, we endow the system with additional
information by requiring that γ(t) = 0. This represents the conferral of immunity on the recovered
population, and importantly, is detected by our inference results using system identification and
ODE-constrained minimization, as discussed in Section 6.
The inferred values, extended to a 30-day prediction (until July 28, 2020) for β(t), µ(t), α(t), r0 (t)
and S(t), I(t), R(t), D(t) obtained from both DNNs and BNNs for Michigan are presented in Figures
8 and 9, while the results for the eight Regions are given in Appendix A.1 and A.2. One can observe
that these time-dependent coefficients in Figures 8(a) and 9(a) have a similar initial trend as those
inferred by the system inference approach in Figure 5. The effective reproduction rate r0 (t) < 1
for m > 30 (April 23), in good agreement with its value obtained via system inference in Figure 5.
As polynomial approximation is used by the system inference approach, the inferred coefficients in
Figure 5 are very smooth, whereas inversion using the NN approach captures the detailed fluctuation
of these coefficients, particularly, the rising infection rate after the open of the lockdown on June
1, 2020. In Figure 9, the band around the inferred coefficients and the NN predictions shows the
mean ± one standard deviation of the corresponding results. Note the high standard deviation in
parameters at early times, due to the noise in the data at small numbers. The regional results in
Appendix A.1 and A.2 indicate that an accelerating infection rate for all the regions after the open
of the lockdown. In particular, Region 7 and 8 have a predicted r0 (t) value that is greater than 1.

15

0.075

0

(t)

50

100

0

r0(t)
50

100

0.075

2

0.050
0.025
Lockdown
(Mar 23)
0

(t)

50

0.050

(t)

50

0
Lockdown
(Mar 23)

E

100
0
0.004

CM R

(t)

O
(Jun 1)

50

E

Lockdown
(Mar 23)

100

0

CM R O
(Jun 1)

E

CM R O
(Jun 1)

(t)

50

(t)

50

100

CM R O
(Jun 1)

0

CM R O
(Jun 1)

0

CM R O
(Jun 1)

(t)

50

r0(t)
50

100

0

CM R

(t)

O
(Jun 1)

(t)

50

50

100

0

Lockdown
(Mar 23)

CM R O
(Jun 1)

(t)

100

0.08

0

(t)

50

100

0.04
Lockdown
(Mar 23)
0

CM R O
(Jun 1)

E

r0(t)
50

100

0.10

0

(t)

50

CM R O
(Jun 1)

(t)

50

0
Lockdown
(Mar 23)

E
100

0

CM R

(t)

O
(Jun 1)

50

E

Lockdown
(Mar 23)

0

0.000
Lockdown
(Mar 23)

100

100

0

CM R O
(Jun 1)

(t)

50

CM R O
(Jun 1)

E

r0(t)
50

100

CM R

(t)

O
(Jun 1)

50

E
100

CM R O
(Jun 1)

E

0

r0(t)
50

100

100

CM R O
(Jun 1)

0.025

0.000
E
Lockdown
(Mar 23)

CM R O
(Jun 1)

0.000
Lockdown
(Mar 23)

E

(t)

50

100

0.10

0

r0(t)
50

100

0

(t)

50

100

0

CM R

(t)

O
(Jun 1)

50

E

Lockdown
(Mar 23)

100

0

0.01

0.2

0.00
Lockdown
(Mar 23)

0.00
Lockdown
(Mar 23)

0.0
Lockdown
(Mar 23)

E

O
(Jun 1)

50

E
100

Lockdown
(Mar 23)

CM R O
(Jun 1)

E

(t)

50

100

CM R O
(Jun 1)

E

(g) Region 7

0

r0(t)
50

100

2

0.05
CM R O
(Jun 1)

E

0.1

0.05
E

(t)

0.002
CM R O
(Jun 1)

0.2

0
Lockdown
(Mar 23)

0

CM R

(f) Region 6

2

CM R O
(Jun 1)

0
Lockdown
(Mar 23)

E

0.003

(e) Region 5

0

100

2

0.002

0.00
Lockdown
(Mar 23)

50

E

(d) Region 4

0.050

0

O
(Jun 1)

0.05

0.05
0.00
Lockdown
(Mar 23)

(t)

0.005

2

0.06

CM R

0.010

0.00
Lockdown
(Mar 23)

E

0

0
Lockdown
(Mar 23)

E

0.05

0.002

50

100

CM R O
(Jun 1)

(c) Region 3
0

100

2

0.025
Lockdown
(Mar 23)

E

0.004
E

0

0.002
Lockdown
(Mar 23)

0.050

100
0
0.006

CM R O
(Jun 1)

E

0.075

0
Lockdown
(Mar 23)

E

0.05
0.00
Lockdown
(Mar 23)

50

(b) Region 2

0.025
Lockdown
(Mar 23)

r0(t)

0.004

0.000
Lockdown
(Mar 23)

E

2

0.050

100

0.025

0.000
Lockdown
(Mar 23)

0
Lockdown
(Mar 23)

E

0.050

0.002

0

0
2

(a) Region 1
0.075

100

0.025
CM R O
(Jun 1)

0.05
0.00
Lockdown
(Mar 23)

0

CM R O
(Jun 1)

(t)

50

E

0
Lockdown
(Mar 23)

100

0

CM R

(t)

O
(Jun 1)

50

E
100

0.04
0.02
CM R O
(Jun 1)

E

0.00
Lockdown
(Mar 23)

CM R O
(Jun 1)

E

(h) Region 8

Figure 6: Parameters of time-dependent SIRD coefficients, β(t), µ(t), α(t), and the effective reproduction rate, r0 (t), for Regions 1-8 (see Figure 1) of Michigan.

16

0

S

50

100
prediction
data

1064000
1063000
1062000
Lockdown
(Mar 23)
0

1000

R

50

E

1000
0
Lockdown
(Mar 23)

E

0

S

50

2195000

CM R O
(Jun 1)

D

0

50

E

2190000
Lockdown
(Mar 23)

100

0

prediction
data

0
Lockdown
(Mar 23)

CM R O
(Jun 1)

0
Lockdown
(Mar 23)

E

100
0
prediction 10000
data
5000

CM R O
(Jun 1)

R

50

100

S

50

2310000

100
prediction
10000
data

2300000
Lockdown
(Mar 23)
0
20000

CM R O
(Jun 1)

R

50

E
100

prediction
data

10000

0
Lockdown
(Mar 23)

50

D

50

1146000

E
100

0
4000

E

S

50

CM R O
(Jun 1)

0
Lockdown
(Mar 23)

E

CM R O
(Jun 1)

R

50

S

50

100

948000
946000
Lockdown
(Mar 23)
0

CM R O
(Jun 1)

R

50

E

0
Lockdown
(Mar 23)

100

E

0

D

0

S

50

100
prediction
data

439600
439400
Lockdown
(Mar 23)
0
400
200
0
Lockdown
(Mar 23)

300

50

E
100

0

200

2500
0
Lockdown
(Mar 23)

E

R

50

E

I

50

Lockdown
(Mar 23)

100

100

0

CM R O
(Jun 1)

D

50

311350
311300
311250

E

20

CM R O
(Jun 1)

E

0
Lockdown
(Mar 23)

0

E

I

50

100

prediction
data

Lockdown
(Mar 23)

CM R O
(Jun 1)

D

0

50

E
100

prediction
data

0
Lockdown
(Mar 23)

CM R O
(Jun 1)

E

100

CM R O
(Jun 1)

R

50

50

100

2000
1000
E

prediction
data

Lockdown
(Mar 23)

100

D

50

E
100

prediction
data

100
E

CM R O
(Jun 1)

0
200

CM R O
(Jun 1)

I

0

0
Lockdown
(Mar 23)

CM R O
(Jun 1)

E

100
100

CM R O
(Jun 1)

50
0
Lockdown
(Mar 23)

E

(g) Region 7

50

100

prediction
data

0

prediction
data

S

I

0

50

100

40

Lockdown
(Mar 23)

40

prediction
data

CM R O
(Jun 1)

(f) Region 6

prediction
data

100
CM R O
(Jun 1)

E

prediction
data

5000

CM R O
(Jun 1)

0

100
prediction
data

200

50

(e) Region 5

439800

1000

prediction
data

1442500
Lockdown
(Mar 23)

prediction
data

0
Lockdown
(Mar 23)

50

400

S

1445000

CM R O
(Jun 1)

0
100

CM R O
(Jun 1)

100

prediction
data

Lockdown
(Mar 23)

0

E

2000

E

CM R O
(Jun 1)

1447500

500

prediction
data

2000

50

1000

prediction
data

D

(d) Region 4
I

0

CM R O
(Jun 1)

0

100

(c) Region 3
0

prediction
data

0
Lockdown
(Mar 23)

100

prediction
data

2000

prediction
data

0
Lockdown
(Mar 23)

E

prediction
data

1142000
Lockdown
(Mar 23)

2000

CM R O
(Jun 1)

0

1144000

CM R O
(Jun 1)

1000

0
Lockdown
(Mar 23)

100

prediction
data

0

2000

100

(b) Region 2
I

0

0
Lockdown
(Mar 23)

I

50

1000

CM R O
(Jun 1)

(a) Region 1
0

E

prediction
data

10000

100

CM R O
(Jun 1)

100

prediction
data

Lockdown
(Mar 23)

100

prediction
data

2000

50

2200000

500
CM R O
(Jun 1)

I

0

20

CM R O
(Jun 1)

R

50

E

0
Lockdown
(Mar 23)

100

prediction
data
E

CM R O
(Jun 1)

D

0
10

CM R O
(Jun 1)

prediction
data

50

E
100

prediction
data

0
Lockdown
(Mar 23)

CM R O
(Jun 1)

E

(h) Region 8

Figure 7: Comparison of the simulation using inferred SIRD parameters (Figure 6) for Regions 1-8
of Michigan.

17

0

50

(t)

100

0.20
0.15
0.10
0.05
Lockdown CMR O E
(Mar 23)
(Jun 1)
0

50

(t)

3

0.1
0.0
Lockdown CMR O E
(Mar 23)
(Jun 1)

r0(t)

50

0

100

50

S

100
prediction
data

2

9960000

1

9940000

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

9920000
Lockdown CMR O E
(Mar 23)
(Jun 1)

100

0.2

0

0

50

(t)

100

60000

0.005
0.004
0.003
0.002
Lockdown CMR O E
(Mar 23)
(Jun 1)

30000

0

50

I

100
prediction
data

20000
10000

0

50

R

100

40000

0
Lockdown CMR O E
(Mar 23)
(Jun 1)
6000

0

50

D

100

4000

20000

prediction
data

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(a) time-dependent coefficients

2000

prediction
data
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(b) DNN prediction

Figure 8: (a) Time-dependent coefficients identified by DNNs, where an increased infection rate
after the open (O) of lockdown on June 1st is observed. (b) DNNs learned S(t), I(t), R(t), D(t)
based on the full extent of data point, and made a 30-day prediction.
0

50

(t)

100

0.15
0.10
0.05
Lockdown CMR O E
(Mar 23)
(Jun 1)
0
0.20
0.15
0.10
0.05
0.00

0

50

50

(t)

3

r0(t)

50

0

100

50

S

100
prediction
data

2

9960000

1

9940000

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

9920000
Lockdown CMR O E
(Mar 23)
(Jun 1)

100

100

0

0

50

(t)

100

60000

0.004

40000

0.002

20000

0.000
Lockdown CMR O E
(Mar 23)
(Jun 1)

50

I

30000

100
prediction
data

20000
10000

0

50

R

100

0
Lockdown CMR O E
(Mar 23)
(Jun 1)
6000

0

50

D

100

4000
prediction
data

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(a) time-dependent coefficients

0

2000

prediction
data
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(b) BNN prediction

Figure 9: (a) Time-dependent coefficients identified by BNNs, where an increased infection rate
after the opening (O) on June 1st is observed. (b) BNNs learned S(t), I(t), R(t), D(t) based on the
full extent of data point, and made a 30-day prediction. Bands correspond to ± standard deviation
over the mean.
In addition, we observed that the BNN inferred coefficients in the regional results have a narrower
range compared to those from DNN.
More broadly, we note the difference in trends between the inferred time-dependent coefficients
with the DNNs and BNNs in Figures 8 and 9 in comparison with those in Figure 5. This is due to
18

the local inversion at each data point to infer the coefficients with the DNNs and BNNs versus the
global optimization of losses for system inference in Section 6. As was referred to above, inverse
problems allow non-unique solutions. It will be instructive to compare the predictions made by the
DNN and BNN representations with the data when they become available.
A result that is consistent across all inference methods: system identification with ODEconstrained optimization, DNNs and BNNs, and for the state as a whole as well as its Regions
is the following: The infection rate, β(t), initially fell with the public health campaign, especially
driven by the lockdown orders. However, it began to rise with the first step of opening (C), and
even accelerated as more aspects of public, recreational, commercial and industrial activities were
relaxed (M, R, O). Yet, every one of the versions of forward simulations with corresponding and
consistently inferred systems matched very well with the data, which confirm that the state has
largely controlled the pandemic, and continues to do so. As the number of remaining infected
individuals, I(t), has fallen steeply, there are fewer conveyors of infection, and even the higher
β(t) has not yet led to another explosion of infection. This also can be seen by the sharply rising
recovery rate, µ(t), and is verified by the effective reproduction rate r0 (t) falling below 1.0 after
April 20 or 23 (the later date according to the DNN and BNN inference methods). A warning bell,
however, must be rung as the results also indicate that r0 (t) → 1.0 from below as we approach the
end of our data and the time of writing. Michigan’s numbers for I(t) are rising, although not yet
exponentially. See Figures 5-9, and Sections A.1, A.2.

7

Two dimensional SIRD model with diffusion

Classical epidemiological models hold in the well-mixed limit, which is reflected in the compartments and sub-populations, S, I, R, D being being total numbers over some geographical region.
Spatial effects have been introduced by simply resolving smaller regions and treating them individually, as demonstrated here with our inference of SIRD coefficients over the regions of Michigan’s
lower peninsula (Figures 6 and 7). However, while affording a spatially finer-grained treatment, this
approach cannot, of course, address the mobility of the population. This is an important consideration, especially in light of the imposition and lifting of quarantines. In the COVID-19 Pandemic,
the effects of social distancing, and the possibility of surges with their lifting revolve on the question of the time (and spatially) varying mobility of the population. At the finest resolution, this
must be approached via agent-based models refined to resolve individuals. However, an intriguing
question to explore is whether simple reaction-diffusion models can detect the evidence of mobility
in these data. With our approach to model inference, we have access to methods of identifying
mechanisms from data in which their action, while weak, may hold the key to important insights
to the system. In this section, we embark down such a path, while noting that reaction-diffusion
models of epidemiology have been considered previously from the perspective of analysis of the
corresponding PDEs [21–23].
19

We now extend the SIRD model to PDEs in two spatial dimensions using the same compartments. However, the population variables are now replaced with spatio-temporally varying
b t), I(x,
b t), R(x,
b
b
densities, S(x,
t), D(x,
t) defined as numbers per unit area.

β
∂ Sb
b
= DS ∇2 Sb − SbIb + γ R
b
∂t
N

(34)

∂ Ib
β
= DI ∇2 Ib + SbIb − µIb − αIb
b
∂t
N

(35)

b
∂R
b + µIb − γ R
b
= DR ∇2 R
∂t

(36)

b
∂D
= αIb
∂t

(37)

Where DS , DI , DR are diffusivities of the corresponding compartments, and represent the mobility
c = (•)/ R dA where Ω is the domain of the lower
of the population via random walks. We define (•)
Ω
peninsula of Michigan, to which we restrict our PDE SIRD studies. Furthermore the population
R
R
R
R
R
b dA =
b
b
b
b
constraint holds: Ω N
S(t)dA
+
I(t)dA
+
R(t)dA
+
Ω
Ω
Ω
Ω D(t)dA.

7.1

Inference on the PDE form of the SIRD model

We adopt the weak form, and specifically, the finite element framework for inference on the above
system of PDEs. For a generic, finite-dimensional field uh , the problem is stated as follows: Find
uh ∈ S h ⊂ S , where S h = {uh ∈ H 1 (Ω) | uh = ū on Γu }, such that ∀ wh ∈ V h ⊂ V , where
V h = {wh ∈ H 1 (Ω) | wh = 0 on Γu }, the finite-dimensional (Galerkin) weak form of the problem
is satisfied. The variations wh and trial solutions uh are defined component-wise using a finite
number of basis functions,
h

w =

nb
X

a

a

h

c N ,

u =

a=1

nb
X

da N a ,

(38)

a=1

where nb is the dimensionality of the function spaces S h and V h , and N a represents the basis
functions. To obtain the Galerkin weak forms, we multiply each strong form by the corresponding
weighting function, use Backward Euler method for time-discretized, integrate by parts and apply

20

boundary conditions appropriately, leading to:


Z
Z
Z
bh
bh
β
h
h Sm − Sm−1
h
h
h
h
h
b
w1
w1
ds = − DS ∇w1 · ∇Sbm ds −
Sb Ib + γ R
m ds
b m m
∆t
N
Ω
Ω
Ω
Ibh
w2h m

Z
Ω

Z
Ω

w3h

h
− Ibm−1
ds = −
∆t

Z

DI ∇w2h

·

h
∇Ibm
ds

Ω

Z
+
Ω

w2h




β bh bh
h
h
S I − µIbm − αIbm ds
b m m
N

Z
Z


bh − R
bh
R
m
m−1
h
h
h
bm
bm
ds = − DR ∇w3h · ∇R
ds +
w3h µIbm
− γR
ds
∆t
Ω
Ω

(39)

(40)

(41)

Z
b m−1
−D
h
w4h αIbm
ds
(42)
ds =
∆t
Ω
Ω
Where, boundary terms disappear because we assume that the populations do not cross the state
boundary, or into the upper peninsula. The system identification problem is to infer the timedependent coefficients DS (t), DI (t), DR (t), and we also choose to expand them in a polynomial
basis
Z

Dm
w4h
b

Ds (t) = θ16 + θ17 t + θ18 t2 + θ19 t3

(43)

Di (t) = θ20 + θ21 t + θ22 t2 + θ23 t3

(44)

Dr (t) = θ24 + θ25 t + θ26 t2 + θ27 t3

(45)

along with the time-dependent coefficients β(t), γ(t), µ(t), α(t) shown in Equation (10-13). We
expect that the effect of mobility on the evolution of population densities is small over the course
of the COVID-19 Pandemic. However, our interest is in inferring the presence of this effect in the
data following the relaxation of lockdown orders. In order to identify the diffusivities despite the
expected dominance of the reaction terms in the data obeying Equations (42), we adopt two stage
Variational System Identification [13].
We define Stage 1 by choosing wih = 1, i = 1, .., 4, yielding:
Z
Z
Z bh
h
Sm − Sbm−1
1 bh bh
bh dA
dA = −β
S I ds − γ
R
(46)
b
∆t
Ω N
Ω
Ω
Z bh
Z
Z
Z
h
Im − Ibm−1
1 bh bh
ds = β
S I ds −
µIbh ds − α Ibh dA
b
∆t
Ω N
Ω
Ω
Ω

(47)

(48)

Ω

Z
Z
bh − R
bh
R
m
m−1
bh ds
ds = µ Ibh ds − γ
R
∆t
Ω
Ω

(49)

Ω

Z
bh − D
bh
D
m
m−1
ds = α Ibh dA
∆t
Ω

Z

Z

21

The diffusion operators vanish since, for a constant weighting function, ∇w = 0. In order to
avoid a proliferation of superscripts and subscripts, we simply denote the data interpolated over the
c d , dispensing with the superscipt (•)h for the finite-dimensional
finite element mesh at time m by (•)
m
fields The label vector and matrix of bases can be constructed as:
 R bd bd

Sm −Sm−1


dA


∆t
Ω




d −Ibd
R
b


I


m
m−1
dA
∆t
Ω
ym =
(50)
d −R
bd
 R Rbm

m−1


dA


∆t
Ω




d −D d

 R Dm
m−1
dA
∆t
Ω
bd Ibd
S
2 3
m m
Ω N dsh1 tm tm tm i
R
bd Ibd
S
2 3
m m
Ω − N dsh1 tm tm tm i

 R


=



R

2 3
bd
Ω −Rm dsh1 tm tm tm i

h0 0 0 0i

h0 0 0 0i

R
R d
2 3
bm dsh1 tm t2m t3m i
I
Ω Im dsh1 tm tm tm i
Ξm
RΩ d
2 3
b
h0 0 0 0i
h0 0 0 0i
Ω −Im dsh1 tm tm tm i R
2 3
d
b
h0 0 0 0i
h0 0 0 0i
Ω −Im dsh1 tm tm tm i
(51)
Once the reaction terms are identified, we return to the original weak forms Equations (39-42).
Accounting for the arbitrariness of wh in V h , the finite-dimensionality leads to a system of residual
equations for each degree of freedom (DOF):


d
d
d
Ri = Fi Sm−1
, Sm
, ∇Sm
, ..., Ds h1 tm t2m t3m i, ..., N, ∇N... ,
(52)
h0 0 0 0i
R
2 3
d
b
Ω Rm dsh1 tm tm tm i
h0 0 0 0i

where Ri is the ith component of the residual vector. The diffusion terms can then be identified by
the two stage approach to Variational System Identification detailed in [12].

7.2

Data preparation on the 2D map of Michigan

We first construct a two-dimensional mesh that fully resolves the counties as shown in Figure
10. Recall that only the lower peninsula, consisting of Regions 1-7 was included in the PDE
d , Rd , D d at
inference problem. The data are available as cumulative sub-population numbers Im
m
m
the county level (Michigan’s lower peninsula has 68 counties). We use a uniform density of each
d ,R
bd , D
b d within the county, and applied Gaussian filtering to smooth
sub-population to compute Ibm
m
m
the discontinuities between counties. Note that the discrete Gaussian filter can not be applied in a
straightforward manner to unstructured meshes. Here we start with continuous Gaussian filtering
over the infinite domain:
Z ∞
u(x0 ) =
G(x0 , x)uraw (x)dv
(53)
−∞

Z
=

G(x0 , x)uraw (x)dv
Ω

22

(54)








Figure 10: A finite element mesh of the map of Michigan delineating the counties. Only Regions
1-7 were used in the PDE inference problem.

23

||x||2
−
1
2σ 2
is the
where u could be any of the four sub-population densities, and G(x0 , x) = 2πσ
2e
two dimensional Gaussian distribution function. The parameter σ is the standard deviation of
the Gaussian distribution which is related to the kernel size in the discrete Gaussian filter. Since
R
Ω GdA < 1 we scale up the filtered displacement at each node:
R∞
Z
−∞ G(x0 , x)dv
R
u(x0 ) =
G(x0 , x)uraw (x)dv
(55)
Ω
Ω G(x0 , x)dv

1
=R
Ω G(x0 , x)dv

Z
G(x0 , x)uraw (x)dv

(56)

Ω

The spatio-temporal evolution of these fields was used in PDE inference via two-stage Variational System Identification as described in Section 7.1 followed by optimization constrained by
the PDEs in (39-42) using adjoints. Stem-and-leaf plots and the losses for Stage 1 of Variational System Identification appear in Figure 11. Recall that in this stage only the reaction terms
β(t), γ(t), µ(t), α(t) are identified. These inference results for active coefficients should be compared
with the ODE SIRD model in Figure 5. This is followed by Stage 2 of Variational System Identification with stem-and-leaf plots and losses appearing in Figure 12. Note that the diffusivities of
the susceptible and recovered populations, DS = 0 and DR = 0. However, the infected population
has a time-varying diffusivity DI that declines.

7.3

Results of system identification of two dimensional SIRD model with diffusion

Figure 13 shows the inference (two stage Variational System Identification followed by PDEconstrained optimization) for the coefficients β(t), µ(t), α(t), the effective reproduction rate, r0 (t) as
well as the diffusivity DI (t) in the PDE SIRD model. On comparing with Figure 5 some differences
are revealed in the time dependence of β(t), µ(t), r0 (t), α(t). This is to be expected in adopting the
PDE SIRD model over the ODE form. The inference of time-dependent diffusion in the mobility
of the infected sub-population, DI , naturally affects the other quantities. While the preliminary
nature of these warrants caution, it is worth noting the inference of decreasing mobility of the
infected sub-population in DI . Figure 14 compares data and the forward simulation with inferred
quantities for the distribution of the infected and recovered sub-populations on days corresponding
to the initial lockdown, the maximum spread of the infected sub-population (May 2), and at the
end of our data collection. Notably, the restriction of the high density of the infected population, Ib
to Southeastern Michigan reflects the success, to date, of the state’s public health response. While
the correspondence is reasonable, the statewide sub-populations S(t), I(t), R(t), D(t) obtained by
integrating the corresponding densities over the lower peninsula, show a poorer match in Figure
15. While the trends are reproduced, there are notable errors over time. A major improvement
is possible in the PDE SIRD model by allowing the coefficients β, γ, µ, α, DS , . . . , DR to also vary
24

Figure 11: Left: stem-and-leaf plot illustrating system identification of active reaction parameters
in the PDE SIRD model in Stage 1 of Variational System Identification. Each stem and leaf
represents one term of θ0 , . . . θ15 t3 , scaled to 1 (active) or 0 (inactive). Right: The changing loss as
terms are eliminated from the set of time-dependent coefficients. System identification converges
at Iteration 10 as the loss increases dramatically for further elimination of terms.
over space. This would allow better representation of the system, in keeping with the inferred
difference in β(t), µ(t), r0 (t), α(t) over the eight Regions in Figure 6, which led to the excellent
agreement between data and the forward ODE SIRD simulations in Figure 7. From a purely data
representation standpoint, the greater number of parameters will allow lower errors.
The code used for the inference, machine learning and forward simulations is available in the
mechanoChem and mechanoChemML libraries at https://github.com/mechanoChem/.

8

Conclusion

We have brought machine learning inference techniques to bear upon the data on progression of
COVID-19 across the state of Michigan by applying three distinct approaches: (a) Our methods
of system identification to delineate the operational mechanisms, followed by (b) adjoint-based
model-constrained optimization for refinement of the parameters, and (c) deep and Bayesian neural
networks. Our interest in this study has been two-fold.
The first has been to seek to infer the time-dependence of the coefficients in the classical
ODE SIRD model, motivated by the evolving characteristics of testing, quarantine and treatment
protocols over the 97-day course of the pandemic as reflected in the data. As discussed in Section
6, our inference methods reveal the course of rates of infection, recovery and death over the state
and its eight regions, assuming uniform mixing in each case. Notably, our methods suggest that
recovery confers immunity, but we hasten to add that this is a very preliminary conclusion. More
detailed and fine-grained studies need to be undertaken to verify it, and of course, immunology will
25

Figure 12: Left: stem-and-leaf plot illustrating system identification of active diffusion parameters
in the PDE SIRD model in Stage 2 of Variational System Identification. Each stem and leaf
represents one term of θ16 , . . . θ27 t3 , scaled to 1 (active) or 0 (inactive). Right: The changing loss as
terms are eliminated from the set of time-dependent coefficients. System identification converges
at Iteration 8 as the loss increases dramatically for further elimination of terms.
have the final say here. Also of note are our conclusions that while the infection rate has increased
after an initial decline, as the state relaxed restrictions, the lower numbers of infectious individuals
has meant a lower overall extent of transmission. This is also seen in the effective reproduction rate,
which, while below one, has trended dangerously closer to that threshold of exponential growth.
The uncertainty in our inference, given the data, is reflected in the results of the Bayesian neural
networks in the same section. Of some interest here are the predictions made by BNNs for 30 days
beyond the end of the data we have considered; that is until July 28, 2020.
The second facet of our interest is to try and infer spatial dependence by extending the SIRD
models to PDEs by incorporating the population’s mobility via diffusion. This is a different, and
potentially intriguing, approach that complements the resolution of the problem down to the smaller
Regions of the state as we did with the ODE SIRD model. On this front, we note that the inference
needs to be extended to our methods of two-stage Variational System Identification followed by
PDE-constrained optimization. Here, it is of note that the susceptible and recovered populations
were found to have vanishing diffusivities (mobilities), while the infected population had a diffusivity
that declined over the 97-day extent of the data that we used. This first extension to system
inference of the PDE SIRD model returned reasonable comparisons with data on distributions of
the sub-population densities, although the total numbers integrated over the state were not as
well reproduced. As suggested by the notable differences in the ODE SIRD model coefficients for
the eight regions of the state, the PDE SIRD model with spatially varying coefficients may be a
better representation. Building on these initial results, we see many possibilities for analysis and
prediction of the future course and geographical spread of the COVID-19 Pandemic using the PDE
26

0

(t)

50

100

0.0075

0

r0(t)
50

100

2.2

2

0.0050
0.0025
Lockdown
(Mar 23)
0

CM R O
(Jun 1)

(t)

50

0.2

100

40

DI

60

80

100

0

1.8
CM R

(t)

O
(Jun 1)

50

1.6

E

1.4

100

1.2

0.005

1.0

0.1
0.0
Lockdown
(Mar 23)

20

2.0

0
Lockdown
(Mar 23)

E

0

0.8
CM R O
(Jun 1)

0.000
E
Lockdown
(Mar 23)

CM R O
(Jun 1)

E

Lockdown
(Mar 23)

C M

R

O
(Jun 1)

E

Figure 13: Left: The time-dependent reaction parameters in 2D SIRD model after tuning by
PDE-constrained optiization: β(t) = 0.00798 − 1.82 × 10−4 t + 1.49 × 10−6 t2 , γ(t) = 0, µ(t) =
2.65 × 10−5 t2 , α(t) = 2.82 × 10−4 t − 2.83 × 10−6 t2 . Right: The sole time-dependent diffusivity is
for the infected sub-population: DI = 2.146 − 8.12 × 10−5 t2 − 7.914 × 10−7 t3 .
SIRD model.

Acknowledgements
We acknowledge the support of Defense Advanced Research Projects Agency (DARPA) under
Agreement No. HR0011199002, “Artificial Intelligence guided multi-scale multi-physics framework
for discovering complex emergent materials phenomena”

References
[1] W.O. Kermack and A.G. McKendrick. A contribution to the mathematical theory of epidemics.
Proceedings of the Royal Society of London, Series A, 115:700–721, 1927.
[2] M.C. Eisenberg, J.N.S. Eisenberg, J.P. D’Silva, E.V. Wells, S. Cherng, Yu-H. Kao, and
R. Meza. Forecasting and uncertainty in modeling the 2014-2015 ebola epidemic in west
africa. 2015.
[3] Marisa Eisenberg, Gregory Kujbida, Ashleigh R. Tuite, David N. Fisman, and Joseph H.
Tien. Examining rainfall and cholera dynamics in haiti using statistical anddynamic modeling
approaches. Epidemics, 5:197–207, 2013. doi: 10.1016/j.epidem.2013.09.004.
[4] Amy Wesolowski, Nathan Eagle, Andrew J. Tatem, David L. Smith, Abdisalan M. Noor,
Robert W. Snow, and Caroline O. Buckee. Quantifying the impact of human mobility on
malaria. Science, 338:267–270, 2012. doi: 10.1126/science.1223467.

27

(a) Infected sub-population: data

(b) Infected sub-population: PDE SIRD simulation

(c) Recovered sub-population: data

(d) Recovered sub-population: PDE SIRD simulation

Figure 14: Comparison of the data on distributions of the infected (a) and recovered (c) subpopulations against forward PDE SIRD simulations with inferred quantities, (b) and (d), respectively. Data and simulation results are shown for Day 0 (lockdown, March 23), Day 40 (May 2,
when the infected sub-population had its greatest spread across the state, but still restricted to
Southeastern Michigan) and Day 96 (end of our data range, June 28, 2020).
[5] Vittoria Colizza, Alain Barrat, Marc Barthelemy, Alain-Jacques Valleron, and Alessandro
Vespignani. Modeling the worldwide spread of pandemic influenza: Baseline case and containment interventions. PLoS Medicine, 4:e13, 2007. doi: 10.1371/journal.pmed.0040013.
[6] 1Point3Acres.com. URL https://coronavirus.1point3acres.com/en.
[7] Tong Yang, Kai Shen, Sixuan He, Enyu Li, Peter Sun, Pingying Chen, Lin Zuo, Jiayue Hu,
Yiwen Mo, Weiwei Zhang, Haonan Zhang, Jingxue Chen, and Yu Guo. Covidnet: To bring
data transparency in the era of covid-19, 2020.
[8] Johns Hopkins University of Medicine. COVID-19 dashboard by the Center for Systems Science
and Engineering (CSSE) at Johns Hopkins University (JHU). URL https://coronavirus.
jhu.edu/map.html.
[9] Michigan State Coronavirus Data. URL https://www.michigan.gov/coronavirus/.
[10] The New York Times. Coronavirus in the U.S.: Latest Map and Case Count - The New York
Times. URL https://www.nytimes.com/interactive/2020/us/coronavirus-us-cases.
html.

28

0

S

50

0
prediction
20000
data

9480000
9460000
Lockdown
(Mar 23)
0
40000
20000
0
Lockdown
(Mar 23)

CM R

R

0
Lockdown
(Mar 23)

O
E
(Jun 1)

50

0

prediction
data

I

50
prediction
data
CM R

D

50

4000
prediction
data

2000
CM R

O
E
(Jun 1)

0
Lockdown
(Mar 23)

O
E
(Jun 1)

CM R

O
E
(Jun 1)

Figure 15: Simulation of the four compartments using the inferred PDE SIRD model, in comparison
with the data.
[11] The Institute for Health Metrics and Evaluation. COVID-19 Projections. URL https://
covid19.healthdata.org/united-states-of-america.
[12] Z. Wang, X. Huan, and K. Garikipati. Variational system identification of the partial differential equations governing the physics of pattern-formation: Inference under varying fidelity
and noise. Computer Methods in Applied Mechanics and Engineering, 356:44 – 74, 2019. ISSN
0045-7825. doi: https://doi.org/10.1016/j.cma.2019.07.007.
[13] Z. Wang, X. Huan, and K. Garikipati. Identification of the partial differential equations governing microstructure evolution in materials: Inference over incomplete, sparse and spatially
non-overlapping data. arXiv:2001.04816.
[14] G. Teichert and K. Garikipati. Machine learning materials physics: Surrogate optimization
and multi-fidelity algorithms predict precipitate morphology in an alternative to phase field
dynamics. Computer Methods in Applied Mechanics and Engineering, 2018. To appear.
[15] Gregory H Teichert, AR Natarajan, A Van der Ven, and Krishna Garikipati. Machine
learning materials physics: Integrable deep neural networks enable scale bridging by learning free energy functions. Computer Methods in Applied Mechanics and Engineering, 353:
201 – 216, 2019. ISSN 0045-7825. doi: https://doi.org/10.1016/j.cma.2019.05.019. URL
http://www.sciencedirect.com/science/article/pii/S0045782519302889.
[16] G.H. Teichert, A.N. Natarajan, A. Van der Ven, and K. Garikipati. Scale bridging materials

29

physics: Active learning workflows and integrable deep neural networks for free energy function
representations in alloys. arXiv:2001.05646, 2020.
[17] Xiaoxuan Zhang and Krishna Garikipati. Machine learning materials physics: Multi-resolution
neural networks learn the free energy and nonlinear elastic response of evolving microstructures.
arXiv:2001.01575, 2020.
[18] H. Jo, H. Son, H.J. Hwang, and S.Y. Jung. Analysis of covid-19 spread in south korea using
the sir model withtime-dependent parameters and deep learning. 2020. doi: https://doi.org/
10.1101/2020.04.13.20063412. medRxiv.
[19] James Truscott and Neil M. Ferguson. Evaluating the adequacy of gravity models as a description of human mobility for epidemic modelling. PLoS Computational Biology, 8(10):e1002699,
2012. doi: 10.1371/journal.pcbi.1002699.
[20] Elizabeth Hunter, Brian Mac Namee, and John Kelleher. A taxonomy for agent-based models
in human infectious disease epidemiology. Journal of Artificial Societies and Social Simulation,
20(3):2, 2017. doi: 10.18564/jasss.3414. URL http://jasss.soc.surrey.ac.uk/20/3/2.
html.
[21] Settapat Chinviriyasit and Wirawan Chinviriyasit. Numerical modelling of an sir epidemic model with diffusion. Applied Mathematics and Computation, 216(2):395 – 409,
2010. ISSN 0096-3003. doi: https://doi.org/10.1016/j.amc.2010.01.028. URL http://www.
sciencedirect.com/science/article/pii/S009630031000041X.
[22] C. Gai, D. Iron, and T. Kolokolnikov. Localized outbreaks in an s-i-r model with diffusion.
Journal of Mathematical Biology, 80:13891411, 2020.
[23] Jose Angulo, Hwa-Lung Yu, Andreas Langousis, Alexander Kolovos, Jinfeng Wang, Ana Esther Madrid, and George Christakos. Spatiotemporal infectious disease modeling: a bme-sir
approach. PLoS ONE, 8(9):e72168, 2013. doi: 10.1371/journal.pone.0072168.
[24] U.S. Census Bureau, Census 2000, Michigan Counties map. U.S. Census Bureau, Census 2020. URL https://www2.census.gov/geo/maps/general_ref/stco_outline/cen2k_
pgsz/stco_MI.pdf.
[25] Michigan Data: Cases by County by Date. https://www.michigan.gov/coronavirus, 2020.
[26] The
COVID
Tracking
Project:
https://covidtracking.com/data/state/michigan, 2020.

Daily

Michigan

Data.

[27] Annual Estimates of the Resident Population for Counties in Michigan: April 1, 2010 to July
1, 2019 (CO-EST2019-ANNRES-26). U.S. Census Bureau, Population Division, March 2020.
30

[28] Pauli Virtanen, Ralf Gommers, Travis E. Oliphant, Matt Haberland, Tyler Reddy, David
Cournapeau, Evgeni Burovski, Pearu Peterson, Warren Weckesser, Jonathan Bright, Stéfan J.
van der Walt, Matthew Brett, Joshua Wilson, K. Jarrod Millman, Nikolay Mayorov, Andrew
R. J. Nelson, Eric Jones, Robert Kern, Eric Larson, CJ Carey, İlhan Polat, Yu Feng, Eric W.
Moore, Jake Vand erPlas, Denis Laxalde, Josef Perktold, Robert Cimrman, Ian Henriksen,
E. A. Quintero, Charles R Harris, Anne M. Archibald, Antônio H. Ribeiro, Fabian Pedregosa,
Paul van Mulbregt, and SciPy 1. 0 Contributors. SciPy 1.0: Fundamental Algorithms for
Scientific Computing in Python. Nature Methods, 17:261–272, 2020. doi: https://doi.org/10.
1038/s41592-019-0686-2.
[29] Sebastian K. Mitusch, Simon W. Funke, and Jrgen S. Dokken. dolfin-adjoint 2018.1: automated
adjoints for fenics and firedrake. Journal of Open Source Software, 4(38):1292, 2019. doi:
10.21105/joss.01292. URL https://doi.org/10.21105/joss.01292.
[30] Kurt Hornik, Maxwell Stinchcombe, Halbert White, et al. Multilayer feedforward networks
are universal approximators. Neural networks, 2(5):359–366, 1989.
[31] Qiang Liu and Dilin Wang. Stein variational gradient descent: A general purpose Bayesian
inference algorithm. Advances in Neural Information Processing Systems, pages 2378–2386,
2016.
[32] David M. Blei, Alp Kucukelbir, and Jon D. McAuliffe. Variational Inference: A Review for
Statisticians. Journal of the American Statistical Association, 112:859–877, 2017.
[33] Alex Graves. Practical variational inference for neural networks. Advances in Neural Information Processing Systems 24: 25th Annual Conference on Neural Information Processing
Systems 2011, NIPS 2011, pages 1–9, 2011.
[34] Yeming Wen, Paul Vicol, Jimmy Ba, Dustin Tran, and Roger Grosse. Flipout: Efficient
pseudo-independent weight perturbations on mini-batches. 6th International Conference on
Learning Representations, ICLR 2018 - Conference Track Proceedings, pages 1–16, 2018.

31

A

Additional regional results

This appendix contains the inferred time-dependent coefficients and the NN prediction results for
the eight regions of the Michigan state.

A.1

DNN results for different regions

A.2

BNN results for different regions

32

0

50

(t)

100

2

3

0

r0(t)

50

100

6

0

50

(t)

100

r0(t)

0

3

50

100

2

4

2

1

1

2

1

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0

50

(t)

100

0

50

(t)

100

6

0.03

2

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

50

(t)

0.01

2

0.00
Lockdown CMR O E
(Mar 23)
(Jun 1)

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(a) region 1
0

50

(t)

100

0

3

1.5

r0(t)

50

100

0

0.0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

100

1.5

(t)

0

50

(t)

100

0.00
Lockdown CMR O E
(Mar 23)
(Jun 1)

0

50

(t)

(t)

100

3

0.4

2

0.2

1

Lockdown CMR O E
(Mar 23)
(Jun 1)
0.6

0

50

(t)

0.4
0.2
0.0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0

r0(t)

50

100

0

50

(t)

50

(t)

100

(t)

50

0.025
Lockdown CMR O E
(Mar 23)
(Jun 1)

100

0.15

0.04
0.03
0.02
0.01
0.00
Lockdown CMR O E
(Mar 23)
(Jun 1)

r0(t)

50

0

50

(t)

2

2

1

1

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(t)

100

0.05
0.00
Lockdown CMR O E
(Mar 23)
(Jun 1)

1.5
1.0
0.5
0.0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0

50

(t)

100

300

0

r0(t)

50

100

0
Lockdown CMR O E
(Mar 23)
(Jun 1)
0

50

(t)

100

0.004
0.003
0.002
0.001
Lockdown CMR O E
(Mar 23)
(Jun 1)

50

(t)

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

100

0

50

(t)

0.0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0

50

(t)

100

50

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(g) region 7

100

100

100

0.5

r0(t)

50

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

100

200

1.0

0

1

100

1.5

3
2

200

0

3

100

0.10

100

3

50

(t)

0
50
100
0.20
0.15
0.10
0.05
0.00
Lockdown CMR O E
(Mar 23)
(Jun 1)

(f) region 6

3

0

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

1

0.050

0

100

2

0.075

(e) region 5
0

100

0.100

0

50

(d) region 4

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

100

100

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(c) region 3
50

r0(t)

0

3

1

5

0.01

0.0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0

100

2

10

0.5

0.6

100

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0.02

1.0

50

5

1

50

(t)

50

Lockdown CMR O E
(Mar 23)
(Jun 1)

10

0.5

0

0
0.020
0.015
0.010
0.005

(b) region 2

2

1.0

(t)

100

4

0.02

1

0

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(h) region 8

Figure 16: Regions 1-8: Time-dependent coefficients identified by DNNs, where an increased infection rate after the open (O) of lockdown on June 1st is observed.

33

S

0
50
100
1085000
prediction
data
1084000
1083000
1082000
1081000
Lockdown CMR O E
(Mar 23)
(Jun 1)
0

50

R

100

prediction
data

4000
2000

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

1500

0

50

I

100

0

50

S

1000

2280000

500

2275000

prediction
data

2270000
Lockdown CMR O E
(Mar 23)
(Jun 1)

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

D

0
50
100
200
150
100
prediction
50
data
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0

50

R

0

50

S

100
prediction
data

2250000

0

0

50

R

50

I

100

0

prediction
data

10000

20000
10000

prediction
data

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

50

S

1096000

0

50

D

1094000
Lockdown CMR O E
(Mar 23)
(Jun 1)

100

0

2000

4000

1000

2000

prediction
data
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

50

R

0

50

S

100
prediction
data

Lockdown CMR O E
(Mar 23)
(Jun 1)
0

50

R

2000

0

50

I

100

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

50

D

50

S

50

S

1534000
1532000
1530000
1528000

Lockdown CMR O E
(Mar 23)
(Jun 1)

R

100

0
50
100
8000
prediction
6000
data
4000
2000
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

100

prediction
445000
data
444800
444600
444400
444200
Lockdown CMR O E
(Mar 23)
(Jun 1)
0
600
400

50

R

0

50

I

100

0

prediction
data

200

200

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

100

50

I

100

prediction
data

Lockdown CMR O E
(Mar 23)
(Jun 1)
0

50

D

100

200
100

prediction
data
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

100

100

0

prediction
data

200

50

R

I

100
prediction
data

0
75

50

D

100

prediction
data

50
25

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(g) region 7

50

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

100

prediction
data

100

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0

20

prediction
data

Lockdown CMR O E
(Mar 23)
(Jun 1)

100

200

0
2000
1500
1000
500

40

298600

D

S

298700

0
Lockdown CMR O E
(Mar 23)
(Jun 1)
50

50

298800

100

0

D

(f) region 6

300

100

prediction
data

50

prediction
data
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

100
prediction
data

(e) region 5
0

0

200

0

100

1000

100

(d) region 4

prediction
data

200

I

50

400

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

1000
750
500
prediction
250
data
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

100

prediction
data

3000

0

0

prediction
2000
data
1500
1000
500
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

100

prediction
data

(c) region 3
964000
963000
962000
961000

D

0
50
100
2000
1500
1000
prediction
500
data
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

100
prediction
data

1098000

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

100

I

0
50
100
10000
prediction
data
7500
5000
2500
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(b) region 2

5000

2240000
Lockdown CMR O E
(Mar 23)
(Jun 1)

100

15000
10000
prediction
5000
data
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(a) region 1

2260000

100
prediction
data

2285000

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(h) region 8

Figure 17: Regions 1-8: DNNs learned S(t), I(t), R(t), D(t) based on the existing discrete data
point, where a 30-day prediction is made by DNNs.

34

0

50

(t)

100

0.06

0

r0(t)

50

(t)

100

0
50
100
0.20
0.15
0.10
0.05
0.00
Lockdown CMR O E
(Mar 23)
(Jun 1)

2

0.04

1

0.02
Lockdown CMR O E
(Mar 23)
(Jun 1)
0
0.100
0.075
0.050
0.025
0.000

3

50

(t)

100

0
Lockdown CMR O E
(Mar 23)
(Jun 1)
0.003

0

50

(t)

100

100

0

50

0.0

0.000
Lockdown CMR O E
(Mar 23)
(Jun 1)

100

(a) region 1
0

50

(t)

100

3

0

r0(t)

50

100

2
1

0.00
Lockdown CMR O E
(Mar 23)
(Jun 1)

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0

50

100

0.006

0

50

(t)

0

50

100

(t)

0
0.20
0.15
0.10
0.05
0.00

Lockdown CMR O E
(Mar 23)
(Jun 1)

(t)

0

50

(t)

100

0.10
0.05
0.00

0

50

100

3

50

(t)

0

50

(t)

100

0.3
0.2
0.1
0.0
Lockdown CMR O E
(Mar 23)
(Jun 1)
0

50

(t)

100

50

r0(t)

50

100

0

50

(t)

100

50

(t)

0
0.100
0.075
0.050
0.025
0.000

50

(t)

100

0

50

(t)

100

0.003
0.002
0.001
0

50

100

r0(t)

50

100

0

50

(t)

100

4

Lockdown CMR O E
(Mar 23)
(Jun 1)

2

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

50

(t)

100

4
3
2
1
0

0.00
Lockdown CMR O E
(Mar 23)
(Jun 1)

(g) region 7

3

0

r0(t)

50

100

2

1

0.05

100

(f) region 6

2

0.10

50

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

Lockdown CMR O E
(Mar 23)
(Jun 1)

100

r0(t)

0

1

0.025

Lockdown CMR O E
(Mar 23)
(Jun 1)

0

100

0.000
Lockdown CMR O E
(Mar 23)
(Jun 1)

0.050

0

(t)

(d) region 4

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0.1
100

100

1

3

50

0.002
0

2

0

100

0.004

0.075

0.2

50

0

2

0.15

0

100

3

0.004
0.003
0.002
0.001
0.000

r0(t)

50

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0.100

0.3

0.0

0

3

0.006

(e) region 5
0

100

1

(c) region 3
0
50
100
0.100
0.075
0.050
0.025
0.000
Lockdown CMR O E
(Mar 23)
(Jun 1)

(t)

0
50
100
0.006
0.004
0.002
0.000
0.002
Lockdown CMR O E
(Mar 23)
(Jun 1)

2

100

0.000

0.00

50

0.00
Lockdown CMR O E
(Mar 23)
(Jun 1)

0.002

0.05

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0.05

0.004

0.10

100

1

0.10

0

r0(t)

50

2

0.15

0.05

0.15

0

(b) region 2

0.10

(t)

100

0.1

0.001
50

50

0.2

0.002

0

0

(t)

3

1

0

50

0

50

(t)

100

100

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(t)

0
50
100
1.00
0.75
0.50
0.25
0.00
Lockdown CMR O E
(Mar 23)
(Jun 1)

(h) region 8

Figure 18: Regions 1-8: Time-dependent coefficients identified by BNNs, where an increased infection rate after the open (O) of lockdown on June 1st is observed. Bands correspond to ± standard
deviation over the mean.
35

0

50

S

100
prediction
data

1085000
1084000

50

I

100

0

prediction
data

1000

Lockdown CMR O E
(Mar 23)
(Jun 1)
0

50

R

0

50

D

Lockdown CMR O E
(Mar 23)
(Jun 1)

100

0

prediction
data

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

50

R

10000

50

5000

prediction
data

prediction
data
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(a) region 1
0

50

S

100
prediction
data

2260000
2255000
2250000
2245000

0

0

50

R

50

I

100

0

prediction
data

10000

20000
prediction
data

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

S

0

50

D

Lockdown CMR O E
(Mar 23)
(Jun 1)

100

0

1000

prediction
data
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

50

R

0

50

S

100
prediction
data

963000
962000
961000

Lockdown CMR O E
(Mar 23)
(Jun 1)
0

50

R

2000

1000
750
500
250

50

I

2000

200

0

50

D

50

S

Lockdown CMR O E
(Mar 23)
(Jun 1)

100

0

50

R

prediction
data
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(e) region 5
0

50

S

100
prediction
data

444800

Lockdown CMR O E
(Mar 23)
(Jun 1)
0

50

R

100

400
prediction
data

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

50

D

100

50

2000
1500
1000
500

I

100

prediction
data

Lockdown CMR O E
(Mar 23)
(Jun 1)
0

50

D

100

200
100

prediction
data
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(f) region 6
50

I

300

100

0

prediction
data

200
100

444600

200

0

0

100

prediction
6000
data
4000
2000
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

50

445000

100

prediction
data
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

100
prediction
data

1534000
1532000
1530000
1528000

100

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0
400

100

150

1000

I

50

(d) region 4

prediction
data

0

100

prediction
data
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

Lockdown CMR O E
(Mar 23)
(Jun 1)

100

prediction
data

3000

0

0

prediction
2000
data
1500
1000
500
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

4000

(c) region 3
964000

D

0
50
100
2000
1500
1000
prediction
500
data
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

100
prediction
data

1096000

2000

10000

50

1098000

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

100

I

0
50
100
10000
prediction
data
7500
5000
2500
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(b) region 2

5000

Lockdown CMR O E
(Mar 23)
(Jun 1)

100

15000

100

1000

100
prediction
data

2275000

150

2000

S

2280000

Lockdown CMR O E
(Mar 23)
(Jun 1)

100

50

2285000

500

1083000

3000

0

50

S

100
40

298700

20

prediction
data
298600
Lockdown CMR O E
(Mar 23)
(Jun 1)

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

D

0
50
100
80
prediction
data
60
40
20
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

0

50

R

50

I

100
prediction
data

0
Lockdown CMR O E
(Mar 23)
(Jun 1)

100

200
prediction
data
150
100
50
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(g) region 7

0

298800

0
30
20

50

D

100

prediction
data

10
0
Lockdown CMR O E
(Mar 23)
(Jun 1)

(h) region 8

Figure 19: Region 1-8: BNNs learned S(t), I(t), R(t), D(t) based on the existing discrete data point,
where a 30-day prediction is made by BNNs. Bands correspond to ± standard deviation over the
mean.
36

