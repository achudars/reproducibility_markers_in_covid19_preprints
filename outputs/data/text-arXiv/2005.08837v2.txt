arXiv:2005.08837v2 [stat.AP] 3 Jun 2020

When and How to Lift the Lockdown?
Global COVID-19 Scenario Analysis and Policy
Assessment using Compartmental Gaussian Processes

Zhaozhi Qian∗,1 , Ahmed M. Alaa∗,2 , and Mihaela van der Schaar1,2
1
University of Cambridge, 2 UCLA

Abstract
The coronavirus disease 2019 (COVID-19) global pandemic has led many countries
to impose unprecedented lockdown measures in order to slow down the outbreak.
Questions on whether governments have acted promptly enough, and whether lockdown measures can be lifted soon have since been central in public discourse. Datadriven models that predict COVID-19 fatalities under different lockdown policy scenarios are essential for addressing these questions and informing governments on future policy directions. To this end, this paper develops a Bayesian model for predicting the effects of COVID-19 lockdown policies in a global context — we treat each
country as a distinct data point, and exploit variations of policies across countries
to learn country-specific policy effects. Our model utilizes a two-layer Gaussian
process (GP) prior — the lower layer uses a compartmental SEIR (Susceptible,
Exposed, Infected, Recovered) model as a prior mean function with “country-andpolicy-specific” parameters that capture fatality curves under “counterfactual” policies within each country, whereas the upper layer is shared across all countries,
and learns lower-layer SEIR parameters as a function of a country’s features and its
policy indicators. Our model combines the solid mechanistic foundations of SEIR
models (Bayesian priors) with the flexible data-driven modeling and gradient-based
optimization routines of machine learning (Bayesian posteriors) — i.e., the entire
model is trained end-to-end via stochastic variational inference. We compare the
projections of COVID-19 fatalities by our model with other models listed by the
Center for Disease Control (CDC), and provide scenario analyses for various lockdown and reopening strategies highlighting their impact on COVID-19 fatalities.

1

Introduction

The ongoing coronavirus disease 2019 (COVID-19) global pandemic poses immense threats not only
to public health, but also to the stability of healthcare infrastructures and economies around the world.
In an attempt to slow down the outbreak, many countries have imposed unprecedented lockdown and
social distancing measures that were eventually proven to be effective in downscaling the volume of
COVID-19 fatalities [1, 2] — however, the instigation of such measures gave rise to various “What if?”
questions that have become central to public discourse, e.g., what the number of deaths would have
been had the government acted earlier? Would lifting the lockdown cause a second wave of infections?
Data-driven models that predict the effects of (lockdown) policies on the trajectory of COVID-19
fatalities are crucial for answering these questions; they are also necessary for informing governments
and decision-makers on what policy directions to follow at different stages of the pandemic [3, 4].
In response to calls for data-driven policy-informing models, the academic community has produced
various models for forecasting COVID-19 fatalities [5, 6, 7] — these models have been used by public
health organizations, such as the WHO and the CDC [22], to advise local authorities on what policy
∗

Equal contribution.

Preprint. Under review.

(a) Upper-layer Gaussian process

(b) Lower-layer Gaussian process
Training data

No Lockdown

Fatality forecasts

COVID-19 fatalities

Reproduction number

Lockdown

Lockdown

No lockdown

SEIR prior

Country feature

Days since the first COVID-19 fatality

Figure 1: Pictorial illustration of compartmental Gaussian processes. (a) The upper-layer GP fU maps country features and lockdown policies to a predicted R0 . Here we depict a simplified binary policy indicator (lockdown or no lockdown). (b) The lower-layer GP fL maps time to number of COVID-19 fatalities. The mean function is an SEIR model modulated by the upper-layer GP. Projections are obtained using the GP posteriors.

directions to follow. (For instance, the IHME model developed by the University of Washington [5]
has been repeatedly cited by the White House in press conferences on COVID-19.2 ) Despite a plethora
of epidemiological models for COVID-19 spread, models that can predict the effect of “counterfactual”
lockdown policies on COVID-19 fatalities — which is crucial for conducting scenario analyses and
policy planning — are still lacking. Moreover, despite the prospects of machine learning (ML) as a key
tool for developing such models [8], existing models have been based primarily on epidemiological
approaches, with ML techniques being used merely for parameter optimization [9, 10].
In this paper, we develop one of the first ML models for learning lockdown policy effects on COVID19 fatalities in a global context — i.e., we treat each country hit by the pandemic as a distinct data
point, and exploit the variations in policies followed by different countries to learn country-specific
policy effects. We characterize each country with a feature vector that comprises economic, social,
demographic, environmental and public health indicators; “counterfactual” fatality curves under a
hypothetical policy for a given country are thus inferred from “factual” fatality curves of countries
“similar” in features wherein this policy was actually implemented. (For example, our model would
use data from Sweden to predict what the number of fatalities in Norway would have been under a
“herd immunity” policy [11].) We envision that our model would be used by policy-makers to conduct
scenario analyses by assessing the volume of COVID-19 fatalities under different possible policies —
this is especially timely as governments seek policies for gradual lifting of lockdown measures [12].
How does our model work? How is it different? A high-level pictorial illustration of our model is
provided in Fig. 1. We follow a Bayesian approach to jointly model COVID-19 fatalities across many
countries through the following hierarchical, two-layer Gaussian process (GP) prior:
Upper-layer GP: fU = R0 (Country features, Policy indicators),
Lower-layer GP: fL = COVID-19 fatalities over time at a given R0 .
The lower-layer GP fL (.) models the COVID-19 fatality curve over time within each country — it uses
a compartmental SEIR (Susceptible, Exposed, Infectious, Recovered) model [13] as its prior mean
function, parameterized with the reproduction number R0 which characterizes the rate by which the
pandemic spreads, i.e., how many people (on average) does each new patient infect [14]. The upperlayer GP fU (.) models the R0 parameter as a function of country features and policy indicators, allowing the model to share data and parameters across different countries that experimented with different
policies (e.g., different lockdown timing). Our model captures uncertainty in both the inferred parameters and the predicted COVID-19 fatalities through the posterior variance across the two layers.
Because of the rarity of pandemics in our modern condition, little related work has been done within
the machine learning community to address this problem. In what follows, we provide a brief overview
of previous works — an elaborate discussion of the related literature is provided in Appendix A. Previous works prior to the current pandemic have been primarily focused on learning contagion (diffusion)
processes on networks, e.g., [15, 16]; unfortunately, these models do not apply to the pandemic as
information on social network structures underlying disease spread is hard to obtain. In response to the
COVID-19 pandemic, two strands of research work have emerged: (a) methods for devising optimal
2

edition.cnn.com/2020/05/20/health/model-on-masks-coronavirus

2

control (lockdown) policies to contain disease spread [17, 18, 19], and (b) models for forecasting the
disease spread and its expected fatalities [5, 6, 7, 9, 10, 20, 21]. Our paper belongs to category (b) in
that the developed model is trained to forecast the future number of fatalities. But unlike existing
models in category (b), our model predicts fatalities under arbitrary lockdown policy choices, hence
it can be used for research in category (a) to derive optimal policies.
The most prominent models in category (b) — developed by various academic institutions — have
been recognized by the CDC and used to issue national forecasts of COVID-19 fatalities within the
United States [22]. Most of these models (e.g., the “UCLA” model [9], the “MIT” model [21] and the
IHME model [5]) are SEIR models fit for individual countries, with ideas from “machine learning”
being used only to optimize the basic SEIR parameters via gradient descent. Our model differs
from these models in that it: (1) jointly models fatalities across all of the 170 countries affected
by the pandemic, (2) incorporates individual country features to learn how disease dynamics and
policy effects vary across countries, (3) enables evaluating future projections under alternative policy
scenarios, and (4) combines both mechanistic SEIR models and data-driven machine learning models.
Hierarchical modeling has been previously used in the “Imperial” model developed in [20] (which
was fit across 11 European countries). This model can be viewed as a special case of ours as it assumes
policy effects to be fixed across all countries in its upper layer with no machine learning components to
model heterogeneity, and its lower layer uses a serial interval distribution to predict short-term deaths
only. A detailed table of comparison between all models is provided in Appendix A.

2

Problem Setup: Global COVID-19 Scenario Analysis

Setup and background. Let Yi (t) ∈ N ∪ {0} be the number of reported COVID-19 deaths in a given
geographical area i on the tth day since the beginning of the outbreak. Throughout this paper, we assume that a geographical area corresponds to a country, and consider a set of N countries hit by the
pandemic.3 Each country i is characterized by a feature vector Xi ∈ Rd comprising its economic, social, demographic, environmental and public health indicators. Because the number of confirmed daily
COVID-19 cases depends greatly on the testing capabilities and strategies within each country [23], we
use the reported daily deaths as a more concrete indicator of disease spread.
We model the COVID-19 lockdown policy of each country i over days t to t0 through the sequence
Pi [t : t0 ] , {pi (t), . . . , pi (t0 )} ,

(1)

where pi (t) ∈ {0, 1}K is a K-dimensional policy indicator variable, reflecting whether country i applies each of K different COVID-19 containment and social distancing measures (e.g., school closure,
sheltering in place, travel bans, etc) on day t. To build our model, we used data for N = 170 countries,
each with d = 35 features and K = 9 policy indicators (See Section 4 and Appendix C for details).
COVID-19 scenario analysis. Our key objective is to address the following question: “How would
different lockdown policies affect future COVID-19 fatalities?” To this end, we build a data-driven
model to learn lockdown policy effects on COVID-19 deaths. We envision this model to be trained and
applied in a global context, where data capturing variations in lockdown policies applied in different
countries enables us to learn counterfactual policy effects within each country. Predictions made by our
model can be used to conduct scenario analyses that inform government policy.
To build our model, we consider a data set DN,t for N countries covering a period of t days, i.e.,
N

DN,t , {Xi , Yi [1 : t], Pi [1 : t]}i=1 ,

(2)

where Yi [t : t0 ] , {Yi (t), . . . , Yi (t0 )}. For each country i, we forecast the trajectory of the number of
COVID-19 deaths within a future time horizon of T days under a given lockdown policy, i.e.,
h
i
Ybi [t : t + T ] = E Yi [t : t + T ] pi (t), pi (t + 1), . . . , pi (t + T ), DN,t .
(3)
|
{z
}
Future policy Pi [t : t + T ]

In addition to point predictions, we also estimate a sequence of uncertainty intervals Cbi [t : t + T ] that
cover the true trajectory of future COVID-19 fatalities, i.e., Yi [t : t + T ], with high probability.
3

Due to the vast heterogeneity of infection profiles and shelter-in-place policies among US states [18], we
consider each state as a distinct geographical area and aggregate state models to obtain national projections.

3

3

Compartmental Gaussian Processes

In this Section, we develop a Bayesian model for the effects of lockdown policies on future COVID-19
fatalities. We provide our model’s specification in Section 3.1, and then develop the corresponding
model training and parameter learning algorithms in Section 3.2.
3.1

Model Specification

Two-layer GP prior. We assume a (hierarchical) two-layer Gaussian process (GP) [24, 25] prior on
the COVID-19 fatality curves {Yi (t)}i for the N countries under consideration as follows:
Upper-layer GP:

fU ∼ GP(mα (X, p), Kα ((X, p), (X 0 , p0 ))),

Lower-layer GP: fL,i ∼ GP(Dθi (t), Kθi (t, t0 )), θi = v(fU (Xi , pi )),

(4)

for i ∈ {1, . . . , N }, where v(.) is a transformation function (described later this Section), α and θi are
the hyper-parameter sets for the upper- and lower-layer (associated with country i) GPs, respectively.
The model in (4) assumes that the fatality curve Yi (t) for each country i is a noisy draw from a GP prior
with a mean function Dθi and kernel function Kθi . The prior on lower-layer parameters θi is specified
via the upper-layer GP — the function fU maps country i’s features Xi and its adopted policy pi to a
parameter θi . The mean function mα for the upper-layer GP is assumed to be a constant, and a Matérn
kernel is selected for both layers. Because the upper-layer GP shares its parameters α across all countries, countries with “similar” features and policies will share similar parameters, and hence similar
fatality profiles. The graphical model for (4) is provided in Fig. 2 (a).
(a) Graphical model for CGP

(b) Compartmental mean function
Susceptible

(c) Lockdown policy effects

Policy
Reproduction number

Upper-layer GP
Exposed

Contact rate

1.0

Infected
threshold

Policy
stringency

Lower-layer GP
Recovered

Deceased

Country feature

Figure 2: Illustration for the CGP model. (a) Graphical model for CGP. (b) Block diagram for the SEIR model
underlying the CGP compartmental prior. (c) Policy effects as function of country features and policy indicators.

Compartmental priors. With little data available at the early stages of the pandemic, our prior knowledge on the expected COVID-19 fatality curves are limited to mathematical models for the spread of infectious diseases. Thus, we model the prior mean function Dθi (t) in (4) trough a compartmental SEIR
(Susceptible, Exposed, Infectious, Recovered) model [26], with parameters (βi (t), σ, γi , µi ), i.e.,
Dθi (t) = SEIR(βi (t), σ, γi , µi ),

(5)

where βi is the contact rate (average number of contacts per person per unit time), σ is the virus’s incubation rate, γi is the patient recovery rate, and µi is the mortality rate. With the exception of σ, all of
the other SEIR parameters are country-specific since they depend on population demographics (e.g.,
contact rates depend on social mobility and mortality rates depend on age distribution [27]). The parameter set θi for the lower-layer GP comprises the SEIR parameters, in addition to the length-scale `L
of the kernel function in (4), i.e., the lower-layer parameter set is θi = (`L , βi (t), σ, γi , µi ).
In an SEIR model, individuals within the population of country i are assigned to 5 compartments: Susceptible Si (t), Exposed Ei (t), Infectious Ii (t), Recovered Ri (t) or Deceased Di (t) — each individual progresses through these compartments as dictated by the following differential equations [28, 29]:
dSi
βi Si Ii dEi
βi Si Ii
dIi
= µi (ni − Si ) −
,
=
− (µi + σ) Ei ,
= σ Ei − (γi + µi ) Ii , (6)
dt
ni
dt
ni
dt
with dRi /dt = γi Ii − µi Ri , and dDi /dt = µi Ii , where ni is the population size of country i. In (6),
we assume that each country’s contact rate βi (t) is time-dependent in order to account for the impact of
4

(lockdown) policy changes over time. The death compartment Di obtained by solving (6) is set as the
prior mean function Dθi (t) for the lower-layer GP in (4). Our choice of the SEIR model as the prior
fatality curve is motivated by the dynamics of the SARS-CoV-2 virus that causes COVID-19; since
the SEIR model captures incubation rates [29], it more accurately represents SARS-CoV-2 dynamics
— compared to other SIR variants — which are known to exhibit significant incubation periods [30].
Note that while we select an SEIR model as our prior, other compartmental models can be used as
well. A block diagram describing the compartmental prior mean function is given in Fig. 2 (b).
The Bayesian nature of our model enables combining the rigorous mechanistic foundation of compartmental models with the data-driven (nonparameteric) nature of GPs. That is, at the early stages of the
pandemic, the early fatality forecasts would be dominated by the prior mean function Dθi (t) derived
from the SEIR prior — as more data on COVID-19 fatalities are collected over time, the GP posterior
will refine the SEIR forecasts based on observed patterns in the data. Because of its hybrid nature, we
call our model a compartmental Gaussian process (CGP).
Modeling policy effects. Governments decide on (lockdown) policies over time in order to control the
basic reproduction number (R0 ) of COVID-19, i.e., the rate by which the pandemic spreads [14]. The
reproduction number within country i as represented by the SEIR prior in (6) is given by [28]:
R0,i (t) =

βi (t)
σ
·
,
µi + σ µi + γi

(7)

where R0,i (t) is the reproduction number in country i at time t. An R0,i (t) of a value less than 1 means
that country i’s fatality curve Yi (t) is “flattening” — the policy pi (t) aims at driving R0,i (t) below 1
by imposing social distancing measures that would minimize the contact rate βi (t) in (7).
Because different countries with comparable features apply different policies, the upper-layer GP function fU (X, p) in (4) will learn counterfactual fatality curves for each country under alternative policies
that have been tried in other countries (See Fig 2(c)). For instance, we can learn the fatality curves
for Scandinavian countries (such as Norway and Denmark) under a hypothetically less restrictive
lockdown policy using data from Sweden, which adopted less stringent policy measures [11].
The lower-layer parameters are linked to the upper layer as follows: fU is specified as a multi-output
GP; each output corresponding to a distinct parameter in θi = (`L , βi (t), σ, γi , µi ). The transformation function v(.) in (4) is an identity map for all outputs corresponding to parameters (`L , σ, γi , µi ),
except for the contact rate parameter βi (t) where it performs the following mapping:
βi (t) = v(fU (Xi , pi (t))) = 2 β̄ Sigmoid(fU (Xi , pi (t))),

(8)

where β̄ is a reference value for the contact rate obtained using early data from Wuhan province [31].
Scenario analysis via posterior inference. What is the expected number of COVID-19 fatalities in
country i given a future lockdown policy scenario Pi [t : t + T ]? To answer this question, we compute
the posterior distribution of Yi [t : t + T ] given the data DN,t and the policy scenario Pi [t : t + T ], i.e.,
Z



P Yi [t : t + T ] Pi [t : t + T ] = Pθ Yi [t : t + T ] Yi [1 : t] · dPα θ DN,t , Pi [t : t + T ] ,
|
{z
} |
{z
}
Lower layer

Upper layer

where conditioning on DN,t in the left hand side was omitted for brevity. Here, the lower- and upperlayer posteriors are computed analytically using the closed-form expression for GP posteriors [24], and
the integral is evaluated via a Monte Carlo approximation. Point estimates and uncertainty intervals are
obtained by evaluating the mean and variance of the resulting distribution.
3.2

Learning via Stochastic Variational Inference

Accurate posterior inferences of Yi [t : t+T ] requires training the CGP model by optimizing the parameter α of the upper-layer GP using the observed data DN,t by maximizing the model’s log-likelihood:
Z Y
N


L(DN,t | α) , log
P Yi [1 : t] θi · P θi Xi , Pi [1 : t], α dθi ,
(9)
i=1
∗

with α = arg maxα L(DN,t | α). Because the integral in (9) is intractable, we resort to a variational
inference approach for optimizing the model’s likelihood [32, 33, 34, 35]. That is, to train our model,
5

we minimize the Evidence lower bound (ELBO) on (9) given by:




log P Yi [1 : t] α ≥ ELBOi (α, φ) = EQ log P Yi [1 : t], θi α − log Q θi Yi [1 : t], φ ,
where Q(.) is the variational distribution with parameters φ, and conditioning on Xi and Pi [1 : t] is
suppressed for notational brevity. We choose a normal distribution for Q(.) — this renders analytic
evaluation of the ELBO objective and its gradients possible. We use stochastic gradient descent via
ADAM algorithm to optimize the ELBO objective [36], and update the lower-layer parameters in
each gradient iteration by solving the SEIR differential equations in (6) use Euler’s method [37]. A
pseudo-code for our training algorithm is provided in Appendix B.
March 28 forecasts
(Before the peak)

April 11 forecasts
(During the peak)

April 25 forecasts
(After the peak)

7 days

14 days

7 days

14 days

7 days

14 days

YYG
Imperial
LANL
MIT-DELPHI
Gompertz curve
Vanilla SEIR

—
-881
—
—
—
2,723

—
—
—
—
—
4,822

-6,470
-1,757
-6,010
—
2,174
-11,328

-10,528
—
-3,161
—
4,689
-24,189

-662
14
-2,018
-2,054
-2,728
-9,696

-1,458
—
-2,989
549
-7,062
-21,314

IHME

-1,999

-2,289

-6,134

-10,129

-3,623

-9,999

—

—

-2,739

-8,188

-4,244

-5,091

-642
-867

-4,380
-1,396

-3,182
-1,906

-8,260
-4,518

-560
-439

-881
611

Model

CDC-ensemble
CPG (US data only)
CPG

Table 1: Accuracy of predicted cumulative deaths at different stages of the pandemic in the United States.

4

Experiments

In this Section, we use our CGP model to forecast COVID-19 fatalities in various countries around the
world, taking into account the lockdown policies within these countries. We compare the projections of
our model with other models listed by the Center for Disease Control (CDC) (Section 4.2), and show
how our model can be used to analyze counterfactual policy scenarios (Section 4.3).
4.1

Experimental Setup

Data description. We collated the data set DN,t = {Xi , Yi , Pi }N
i=1 for N = 170 countries affected
by the COVID-19 pandemic using three data sources: (1) published World Bank reports4 were used to
extract a set of d = 35 features Xi for each country, (2) the COVID-19 CSSE data repository at Johns
Hopkins University [38] was used to extract each country’s fatality time-series Yi , and (3) the Oxford
COVID-19 Government Response Tracker (OxCGRT) — curated by the Blavatnik School of Government at Oxford University [39] — was used to extract K = 9 policy indicators Pi for each country
over time. Our data set covered the period spanning from January 22, 2020 to May 8, 2020.
Each country’s features included a comprehensive set of economic, demographic, environmental, social and health indicators (e.g., population density, prevalence of obesity, air transport frequency, median age, prevalence of hand-washing facilities, health expenditure, etc). Policy indicators included:
information on school and workplace closure, public events’ cancellation, travel restrictions, public
transport closure, etc. A complete list of variables included in our model is provided in Appendix C.
Implementation. We implemented our CGP model using Pyro [40], a auniversal probabilistic programming language in Python supported by a PyTorch backend. The variational inference algorithm
in Section 3.2 was implemented using ADAM with 1000 iterations and a learning rate of 0.01. Further
details on hyper-parameter tuning is provided in Appendix C. Projections from all baselines involved
in our comparisons were obtained from the official CDC website [22].
Baselines. We considered the most prominent baseline models listed by the CDC [22]: the “UCLA”
model [9], the “MIT-DELPHI” model [21], the Los Alamos National Laboratory “LANL” model [43],
4

https://data.worldbank.org/

6

April 25 - May 1 Forecasts

Country
United Kingdom
Italy
Germany
Spain
Brazil
Sweden
France
Netherlands
Romania
Iran
Turkey
Mexico
Japan
South Korea
Egypt
South Africa

April 25 - May 7 Forecasts

IHME

YYG

Imperial

CGP

IHME

YYG

Imperial

CGP

-981
-1,082
-420
1,104
—
311
-501
512
-96
—
—
—
—
—
—
—

-3,479
451
244
167
-283
107
803
172
-1
40
177
-82
—
—
—
—

-182
1,804
-417
-499
—
-102
-2,415
265
—
—
—
—
—
—
—
—

-131
294
104
317
-105
24
-79
-21
-32
9
118
-56
-3
3
-47
-8

658
-2,591
-661
102
—
693
-1,412
360
-236
—
—
—
—
—
—
—

-3,433
732
628
76
-768
256
1,601
363
-2
79
394
-518
—
—
—
—

-29
1,600
-288
712
—
-35
-1,974
228
—
—
—
—
—
—
—
—

761
901
179
50
-298
-7
-485
-47
-64
9
488
-315
-74
11
-93
-34

Table 2: Accuracy of cumulative deaths predicted by different baselines in various countries around the world.

the “Imperial” model [20], the IHME model [5], the “YYG” model [10] which was found to be the best
performing CDC-listed model in recent weeks [42], in addition to the CDC-ensemble, which issues a
national-level forecast for the United States by combining the predictions of 16 individual models [22].
The UCLA, MIT-DELPHI, LANL, YYG and IHME models are all variants of the SEIR model — the
IHME has been the most influential of these models, having been often cited during White House press
briefings on COVID-19 modeling efforts [44]. In addition to these models, we consider a vanilla SEIR
model and a standard Gompertz curve fitting approach as baseline models for fatality curves [41].
4.2

Forecasting Accuracy

Forecasting Accuracy for the United States. We start off by comparing the accuracy of fatality projections by our model with the baselines for the United States. In Table 1, we evaluate the accuracy of
the 7-day and 14-day projections issued at three stages of the pandemic: before the peak of infections
(March 28), in the midst of the peak (April 11) [38], and in the “plateauing” stage (April 25). Accuracy
was evaluated by computing the
P difference between true and predicted cumulative deaths throughout
the forecasting horizon, i.e., Tk=1 (Yi (t + k) − Ybi (t + k)) for T = 7 and T = 14. For each forecast,
only data preceding the forecast date was used for training our model. The results are summarized in
Table 1, with the best performing model in each forecast highlighted via an underlined bold font.
As we can see in Table 1, our model consistently outperforms the CDC-ensemble and the prominent
IHME models at all forecasts; most notably the CGP predictive accuracy is an order of magnitude better in the current plateau stage of the pandemic. Our model also performs consistently well across all
forecasts — its performance is comparable to the best model for each forecast. Note that, as mentioned
earlier in Section 1, the Imperial model provides a competitive performance on short-term predictions
because it is tailored to inferences based on short-term transmission dynamics, but it falls short when it
comes to long-term forecasts, which can be crucial for anticipating the timing of the peak.
The benefits of joint (global) modeling across multiple countries are demonstrated through an ablated
version of our model that uses United States (US) data only for training. The global version of our
model consistently achieves a significant performance gains compared to the version that uses US data
only; similar patterns were found in other countries (See Appendix C). This shows the value of using
machine learning to capture country-specific disease spread parameters based on country features.
Accuracy of global projections. In Table 2, we compare the forecasting accuracy of our model with
the CDC-listed baselines that offer projections for countries other than the US (IHME, Imperial and
YYG). We evaluated the performance of all baselines in 10 countries that were significantly affected by
7

(b) Counterfactual scenario analysis within the UK

(a) Heterogeneity of policy effects

What could have
happened?

Reproduction Number

2.5

What could happen?
Strict policy

COVID-19
Fatalities

2.0

1.5

Loose policy
Actual policy
Policy-making
window

1,000 deaths

1.0
United Kingdom
Italy

0.5

0

20

40

60

80

100

March

Policy stringency index

April

May

June

July

August

Timeline

Figure 3: Policy effects learned by the CGP model. (a) Regression slopes for the impact of lockdown policy stringency on R0 . (b) Counterfactual COVID-19 fatality curves for the UK under different lockdown policies.

the pandemic in Europe, Asia, Africa, and the Americas. (Note that ours is the only model that covers
all countries and spans all continents.) Since these countries were at different stages of the pandemic at
any given time, we evaluated the 7-day and 14-day forecasts on April 25, 2020, when all countries have
had a significant number of infections. As we can see in Table 2, our model outperforms the baselines
in almost all countries on both forecasting horizons. Central to the accuracy of our model is its hierarchical GP structure which shares data across countries based on their “ feature similarity”, enabling
accurate predictions even when little data is available for individual countries.
Our model does not only learn the fatality curves within each country, but also the country-specific effects of lockdown. Since the same policy would naturally yield different effects in different countries,
this is a major source of performance gain for our model compared to others (e.g., Imperial model)
which assume fixed policy effects. To demonstrate the heterogeneity of policy effects, Fig. 3 (a) shows
the inferred R0 in the United Kingdom (UK) against the stringency of the policy applied at different
points of time. We quantify the policy stringency through the stringency index defined in [39], which
collapses all policy indicators into a single number between 0 and 100 — a higher index corresponds
to a stricter policy. The regression slope in Fig. 3(a) reflects the policy effects, i.e., how much a unit
increase in policy stringency reduces R0 . As we can see, the lockdown effects learned by our model
differs among countries based on their features; here we compare policy effects for the UK and Italy
as an exemplar. We specify the country features most relevant to policy effects in Appendix C.
4.3

Counterfactual Analysis

As we have seen in Section 4.2, our model performs favorably compared to existing models in terms of
predicting COVID-19 fatalities, but how can it be used to inform decision-making? Here, we use our
model to analyze the lockdown policy of the UK in the early stages of the pandemic, which sparked
controversies within the British society [45, 46, 47], and provide projections for future COVID-19
fatalities under the gradual re-opening plan announced by the UK government [48].
In Fig. 3 (b) we display the predictions and counterfactual inferences of our model from the policymaker’s perspective in the period spanning from May 8 until the end of May, when a lockdown lifting
policy was being planned for. At this point of time, the policy-maker can be presented with counterfactual fatality curves of what would have happened before May 8 had lockdown been implemented 1
week earlier (blue curve) or 1 week later (red curve). Our model predicts that 13,827 lives would
have been saved with an earlier lockdown, and 22,405 more deaths would have occured under a later
one. Looking into the future, our model predicts that under the current UK government re-opening
plan (black curve), daily deaths would stabilize around 200. Maintaining the current lockdown (blue
curve) would lead daily deaths to fall under 100 in Augusts, which would save 6,215 more lives
compared to the current re-opening plan. On the other hand, a complete re-opening in June (red
curve) would result in a second peak in August-September although there is large uncertainty about
the volume of the second peak. Similar analyses for other countries are provided in Appendix C.
We envision our model to be used by governments to make measured decisions that might impact the
lives of millions of people all over the world. We hope that our model exemplifies the importance of
machine learning-based decision-making for public health in the post-coronavirus world.
8

References
[1] K. Prem, et al. “The effect of control strategies to reduce social mixing on outcomes of the
COVID-19 epidemic in Wuhan, China: a modelling study.” The Lancet Public Health, 2020.
[2] N. M. Ferguson, D. Laydon, G. Nedjati-Gilani, et al. “Impact of non-pharmaceutical interventions (NPIs) to reduce COVID-19 mortality and healthcare demand.” Imp Coll COVID-19
Response Team, 2020.
[3] T. Hale, A. Petherick, T. Phillips, and S. Webster. “Variation in government responses to
COVID-19.” Blavatnik School of Government Working Paper, 2020.
[4] F. E. Alvarez, D. Argente, and F. Lippi. “A simple planning problem for covid-19 lockdown.”
National Bureau of Economic Research, 2020.
[5] IHME COVID-19 health service utilization forecasting team and Christopher J. Murray. “Forecasting the impact of the first wave of the COVID-19 pandemic on hospital demand and deaths
for the USA and European Economic Area countries.” medRxiv, 2020.
[6] J. Lourenço, et al. “Fundamental principles of epidemic spread highlight the immediate need
for large-scale serological surveys to assess the stage of the SARS-CoV-2 epidemic.” medRxiv,
2020.
[7] P. Teles. “A time-dependent SEIR model to analyse the evolution of the SARS-covid-2 epidemic
outbreak in Portugal.” Bull World Health Organ, 2020.
[8] D. S. W. Ting, L. Carin, V. Dzau, and T. Y. Wong. “Digital technology and COVID-19.” Nature
Medicine, no. 26, vol. 4, pp. 459-461, 2020.
[9] D. Zou, L. Wang, P. Xu, J. Chen, W. Zhang and Q. Gu. “Epidemic Model Guided Machine
Learning for COVID-19 Forecasts in the United States.” medRxiv, 2020.
[10] Y. Gu. “COVID-19 Projections Using Machine Learning.” covid19-projections.com,
2020.
[11] A. L. Andersen, et al. “Pandemic, Shutdown and Consumer Spending: Lessons from Scandinavian Policy Responses to COVID-19.” arXiv preprint arXiv:2005.04630, 2020.
[12] M. Gilbert, M. Dewatripont, E. Muraille, J. P. Platteau and M. Goldman. “Preparing for a
responsible lockdown exit strategy.” Nature Medicine, vol. 26, no. 5, pp. 643-644, 2020.
[13] M. Y. Li and J. S. Muldowney. “Global stability for the SEIR model in epidemiology.” Mathematical biosciences, vol. 125, no .2, pp. 155-164, 1995.
[14] K. Dietz. “The estimation of the basic reproduction number for infectious diseases.” Statistical
methods in medical research, pp. 23-41, 1993.
[15] R. Lemonnier, et al. “Tight bounds for influence in diffusion networks and application to bond
percolation and epidemiology.” Advances in Neural Info. Process. Systems (NeurIPS), 2014.
[16] D. B. Neill, and A. W. Moore. “A fast multi-resolution method for detection of significant
spatial disease clusters.” Advances in Neural Information Processing Systems (NeurIPS), 2004.
[17] G. Zaman, Y. H. Kang and I. H. Jung. “Optimal treatment of an SIR epidemic model with time
delay.” BioSystems, vol. 98, no. 1, pp. 43-50, 2009.
[18] D. M. Dave, A. I. Friedson, K. Matsuzawa and J. J. Sabia. “When do shelter-in-place orders
fight COVID-19 best? Policy heterogeneity across states and adoption time.” National Bureau
of Economic Research, 2020.
[19] D. Acemoglu, V. Chernozhukov, I. Werning and M. D. Whinston. “A Multi-Risk SIR Model
with Optimally Targeted Lockdown.” National Bureau of Economic Research, 2020.
[20] S. Flaxman, et al. “Estimating the number of infections and the impact of non-pharmaceutical
interventions on COVID-19 in 11 European countries.”, arXiv preprint, 2020.
[21] COVIDAnalytics Team, “Overview of DELPHI Model V2.0.” covidanalytics.io/
DELPHI_documentation_pdf, 2020.
[22] www.cdc.gov/coronavirus/2019-ncov/covid-data/forecasting-us.html, last accessed: June 1,
2020.
[23] R. Li, S. Pei, B. Chen, et al. “Substantial undocumented infection facilitates the rapid dissemination of novel coronavirus (SARS-CoV2).” Science, 2020.
9

[24] C. E. Rasmussen, “Gaussian processes in machine learning.” Springer, 2003.
[25] J. Q. Shi, R. Murray-Smith, and D. M. Titterington. “Hierarchical Gaussian process mixtures
for regression.” Statistics and computing, 2005.
[26] W. O. Kermack, and A. G. McKendrick. “A contribution to the mathematical theory of epidemics.” Proceedings of the Royal Society of London, pp. 700-721, 1927.
[27] J. T. Wu, et al. “Nowcasting and forecasting the potential domestic and international spread of
the 2019-nCoV outbreak originating in Wuhan, China: a modelling study.” The Lancet, 2020.
[28] H. W. Hethcote, “The mathematics of infectious diseases.” SIAM review, pp. 599-653, 2000.
[29] A. Osemwinyen and A.Diakhaby. “Mathematical Modelling of the Transmission Dynamics of
Ebola Virus.” Applied and Computational Mathematics, 2015.
[30] S. A. Lauer, et al. “The incubation period of coronavirus disease 2019 (COVID-19) from
publicly reported confirmed cases: estimation and application.” Annals of internal medicine,
vol. 172, no. 9, pp. 577-582, 2020.
[31] A. J. Kucharski, T. W. Russell, C. Diamond, et al. “Early dynamics of transmission and control
of COVID-19: a mathematical modeling study.” Lancet Infect Dis, 2020.
[32] M. D. Hoffman, D. M. Blei, C. Wang and J. Paisley. “Stochastic variational inference.” The
Journal of Machine Learning Research, vol. 14, no. 1, pp. 1303-1347, 2013.
[33] D. Wingate and T. Weber. “Automated variational inference in probabilistic programming.”
arXiv preprint arXiv:1301.1299, 2013.
[34] R. Ranganath, S. Gerrish, and D. M. Blei. “Black Box Variational Inference.” In Proceedings of
the International Conference on Artificial Intelligence and Statistics (AISTATS), 2014.
[35] D. P. Kingma and M. Welling. “Auto-encoding Variational Bayes.” arXiv preprint, 2013.
[36] D. P. Kingma and J. Ba. “Adam: A method for stochastic optimization.” arXiv preprint, 2014.
[37] M. Hutzenthaler, A. Jentzen, and P. E. Kloeden. “Strong and weak divergence in finite time
of Euler’s method for stochastic differential equations with non-globally Lipschitz continuous
coefficients.” Proceedings of the Royal Society A: Mathematical, Physical and Engineering
Sciences, vol. 467, no. 2130, pp. 1563-1576, 2011.
[38] JHU CSSE. 2019 Novel Coronavirus COVID-19 (2019-nCoV) Data Repository by Johns
Hopkins CSSE. GitHub. 2020 (https://github.com/CSSEGISandData/COVID-19).
[39] T. Hale, A. Petherick, T. Phillips, and S. Webster. “Variation in government responses to
COVID-19.” Blavatnik School of Government Working Paper, 2020.
[40] E. Bingham, et al. “Pyro: Deep universal probabilistic programming.” The Journal of Machine
Learning Research, vol. 20, no .1, pp. 973-978, 2019.
[41] C. P. Winsor. “The Gompertz curve as a growth curve.” Proceedings of the National Academy
of Sciences of the United States of America, vol. 18, no. 1, 1932.
[42] www.economist.com/early-projections-of-covid-19-in-america-underestimated-its-severity
[43] https://covid-19.bsvgateway.org/, last accessed: June 1, 2020.
[44] A Azad. “Model cited by white house says 82,000 people could die from coronavirus by august,
even with social distancing.”, CNN, 2020. https://www.cnn.com/2020/03/30/health/coronavirusus-ihme-model-us/index.html, last accessed: June 1, 2020.
[45] https://www.bbc.co.uk/news/health-52849691, last accessed: June 1, 2020.
[46] https://www.bbc.co.uk/news/uk-52858392, last accessed: June 1, 2020.
[47] https://www.telegraph.co.uk/global-health/science-and-disease/road-lockdown-sage-minutesreveal-best-worst-whitehall/ , last accessed: June 1, 2020.
[48] https://www.gov.uk/government/publications/our-plan-to-rebuild-the-uk-governments-covid19-recovery-strategy/, last accessed: June 2, 2020.

10

