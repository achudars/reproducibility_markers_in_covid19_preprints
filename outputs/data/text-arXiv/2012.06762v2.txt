Semiparametric causal mediation analysis under unmeasured
mediator-outcome confounding
BaoLuo Sun
Department of Statistics and Applied Probability, National University of Singapore

arXiv:2012.06762v2 [stat.ME] 28 Dec 2020

Abstract
Although the exposure can be randomly assigned in studies of mediation effects, any form
of direct intervention on the mediator is often infeasible. As a result, unmeasured mediatoroutcome confounding can seldom be ruled out. We propose semiparametric identification of
natural direct and indirect effects in the presence of unmeasured mediator-outcome confounding by leveraging heteroskedasticity restrictions on the observed data law. For inference, we
develop semiparametric estimators that remain consistent under partial misspecification of the
observed data model. We illustrate the robustness of the proposed estimators through both
simulations and an application to evaluate the effect of self-efficacy on fatigue among health
care workers during the COVID-19 outbreak.

Keywords: Causal Inference; Natural direct effect; Natural indirect effect; Unmeasured confounding; Doubly robust.

1

Introduction

It is often of interest in the health and social sciences to investigate not only the total effect of a
point exposure on an outcome, but also separate the indirect effect operating through a given postexposure mediating variable from the direct effect of the exposure not through the mediator. Since
the seminal work of Baron and Kenny (1986) in the context of linear structural equation models,
the notions of natural indirect and direct effects have been formalized under the potential outcome framework (Robins and Greenland, 1992; Pearl, 2001), which allows parametric and semiparametric identification and inference for these causal estimands of interest (Imai et al., 2010b;
Tchetgen Tchetgen and Shpitser, 2012; VanderWeele, 2015). Identification of natural indirect and
direct effects typically require no unmeasured confounding of the exposure-mediator, exposureoutcome and mediator-outcome relationships (Robins and Greenland, 1992; Pearl, 2001; Robins,
2003; van der Laan and Petersen, 2008; Imai et al., 2010b). Although in principle one can rule out
unmeasured confounding of the exposure-mediator and exposure-outcome relationships by design
when the exposure assignment is randomized, it is often infeasible to directly manipulate the mediator. As a result, numerous researchers have developed sensitivity analysis (Imai et al., 2010a;
VanderWeele, 2010; Tchetgen Tchetgen and Shpitser, 2012; Ding and Vanderweele, 2016) and
bounds (Sjölander, 2009; Robins and Richardson, 2010) to assess the impact of departures from
the no unmeasured mediator-outcome confounding assumption.
Identification of causal mediation mechanisms under unmeasured mediator-outcome confounding can sometimes be achieved through the principal stratification approach (Gallop et al., 2009;
Mattei and Mealli, 2011) or by leveraging ancillary variables that satisfy certain exclusion restrictions (Imai et al., 2013; Burgess et al., 2015; Frölich and Huber, 2017). A major strand of work in
1

the health sciences uses baseline covariates interacted with random exposure assignment as instrumental variables for the effect of the mediator on the outcome (Ten Have et al., 2007; Dunn and
Bentall, 2007; Albert, 2008; Small, 2012; Zheng and Zhou, 2015); see also the commentary by
Ogburn (2012). The method requires the effect of the exposure on the mediator to vary, but that the
direct effect of the exposure on the outcome does not vary (exclusion restriction), within strata of
the chosen baseline covariates. These assumptions may be plausible under specific settings based
on subject matter expertise, although in general exclusion restriction is not empirically verifiable
without further assumptions (VanderWeele, 2015).
Recently, there has been growing interest in econometrics and health sciences to use higherorder moment restrictions as a source of identification in linear structural models without exclusion restrictions (Rigobon, 2003; Klein and Vella, 2010; Lewbel, 2012; Tchetgen Tchetgen et al.,
2020). However, to date few work has been done to extend the framework to causal mediation
analysis under unmeasured mediator-outcome confounding. An exception is Fulcher et al. (2019),
who considered estimation of the natural indirect effect under correctly modeled propensity score
(Rosenbaum and Rubin, 1983). In this paper, we consider semiparametric identification of the natural indirect and direct effects by leveraging heteroscedasticity of the mediator with respect to the
exposure. We propose doubly robust G-estimators (Robins, 1994) which remain consistent when
various strict subsets of the nuisance parameters are correctly modeled, and illustrate the robustness through both simulations and a real data example. Although the proposed framework may be
considered when valid instruments cannot be established on substantive grounds, it does impose
untestible outcome and mediator structural restrictions. As such, it is also important to supplement
any inference with sensitivity analysis, which we discuss in section 5.

2

Model and assumptions

Suppose that (O1 , . . . , On ) are independent and identically distributed observations of O = (Y, D,
M, X) from a population of interest, where Y is an outcome variable, D is a binary variable
encoding the presence (D = 1) or absence of exposure (D = 0), and X is a vector of measured
baseline covariates not affected by the exposure. In addition, let U denote a set of unmeasured
baseline covariates not affected by the exposure. We are interested in the indirect effect of D on Y
through the mediating variable M . Let Y, D, M, X and U denote the support of the distributions
of Y , D, M , X and U respectively. We use the potential outcomes framework (Neyman, 1923;
Rubin, 1974) to define the mediation effects of interest. Let Ydm denote the potential outcome that
would be observed if D = d ∈ D and M = m ∈ M. Similarly, let Md denote the potential
mediator value that would be observed when exposure takes value D = d. The potential outcomes
are related to the observed data via the consistency assumptions Y = Ydm if D = d and M = m,
and M = Md if D = d. Robins and Greenland (1992), Pearl (2001) and Robins (2003) defined
what are now often called the population natural indirect and direct effects, given by
ψnie = E(Y1M1 − Y1M0 ),

ψnde = E(Y1M0 − Y0M0 );

(1)

respectively. The natural indirect and direct effects are particularly relevant for describing the
underlying mechanism by which the exposure operates, as their sum equals the population total
effect E(Y1M1 − Y0M0 ).
2

To uniquely identify the mediation estimands in (1) from the observed data law, Pearl (2001)
assumed that for all d, d∗ ∈ D and m ∈ M,
Ydm ⊥ D|X,

Md ⊥ D|X,

Ydm ⊥ M |(D, X),

Ydm ⊥ Md∗ |X,

(2)

under which
ZZ
E(Y |D = d, M = m, X = x)dFM |D=d∗ ,X=x (m)dFX (x),

E(YdMd∗ ) =

(3)

M×X

where FX , FM |D,X denote the distribution function of X and the conditional distribution function
of M given (D, X) respectively (Pearl, 2001; Imai et al., 2010b; VanderWeele, 2015). Although
the first two assumptions in (2) generally hold when the exposure is randomly assigned given
values of X, the third and fourth assumptions in (2) may be violated in practice, as it is often
infeasible to randomize or intervene on the mediator. Following Ding and Vanderweele (2016), we
assume that (X, U ) jointly ensures (2) while the exposure is randomized within strata of X, either
by design or through some natural experiments (Hernán and Robins, 2006).
Assumption 1 (Latent ignorability). For all d, d∗ ∈ D and m ∈ M,
Ydm ⊥ D|(X, U ),

Md ⊥ D|(X, U ),

Ydm ⊥ M |(D, X, U ),

Ydm ⊥ Md∗ |(X, U ),

(4)

and the conditional independence U ⊥ D|X holds.
Figure 1 depicts the causal diagram for such a scenario. Under Assumption 1,
ZZZ
E(YdMd∗ ) =
E(Y |D = d, M = m, X = x, U = u)×
(5)

M×X ×U

× dFM |D=d∗ ,X=x,U =u (m)dFX,U (x, u),
which clearly cannot be identified from the observed data law without further assumptions. Ding
and Vanderweele (2016) developed a sensitivity technique that yields sharp bounds on the mediation effects without any assumptions on U . Ten Have et al. (2007) considered identification and
estimation of direct effects under the the rank preserving outcome structural model
Y = βM + γD + γ ∗ (X, U, ε),

(β, γ)T ∈ IR2 ,

ε ⊥ (D, M, X, U ),

(6)

which has been generalized by Small (2012) and Zheng and Zhou (2015) to accommodate effect
heterogeneity. In this paper, we consider identification of both the indirect and direct natural effects
under the following pair of outcome and mediator structural models.
Assumption 2 (Structural models).
E(M |D = d, X = x, U = u) = α(x)d + α∗ (x, u),
E(Y |D = d, M = m, X = x, U = u) = β(x)m + γ(x)d + γ ∗ (x, u),
where (α, α∗ , β, γ, γ ∗ ) are unknown measurable and square-integrable functions.
3

(7)

We note that (6) is a special case of the outcome structural model in (7). The effect parameters
(α, β, γ) in (7) are unrestricted except that they do not vary with U on the mean additive scale,
an assumption which is closely related to the notion of “no essential heterogeneity” in the econometrics literature (Heckman et al., 2006). As discussed in Zheng and Zhou (2015), no essential
heterogeneity may be more realistic than (2) in many applications where U is more likely to have
main effects rather than interaction effects on the mediator and outcome. Nonetheless, Assumption 2 cannot be settled a priori in practical settings, and we describe a semiparametric sensitivity
analysis framework in section 5. Under Assumptions 1 and 2, ψnie equals
ZZZ
β(x)m{dFM |D=1,X=x,U =u (m) − dFM |D=0,X=x,U =u (m)}dFX,U (x, u) = E{α(X)β(X)},
M×X ×U

and similarly ψnde = E{γ(X)}.
Remark 1. The proposed framework also accommodates a general exposure, in which case
E{α(X)β(X)} and E{γ(X)} encode the natural indirect and direct effects per unit increase in
the exposure under Assumptions 1 and 2. These estimands provide useful summary of the mediation effects, as interventions at any two levels d, d∗ ∈ D may not be practicable in causal mediation
analysis with a general (e.g. continuous) exposure.

D

M

Y

U
Figure 1: Causal diagram with unmeasured mediator-outcome confounding within strata of X.

3

Identification

Structural model (2) yields the observed data models
E(M |D = d, X = x) = α(x)d + ᾱ(x) ≡ µm (d, x)
E{Ỹ (O; β)|D = d, X = x} = γ(x)d + γ̄(x) ≡ µy (d, x),

(8)

where Ỹ (O; β) ≡ Y − β(X)M , ᾱ(x) ≡ E{α∗ (X, U )|D, X = x} and γ̄(x) =
E{γ ∗ (X, U )|D, X = x}. To ease notation, let δm (O; µm ) = M − µm (D, X) and δy (O; β, µy ) =
Ỹ (O; β) − µy (D, X) denote the mediator and outcome disturbance functions respectively. The
following lemma states the implications on the observed data law due to the structural assumptions
discussed in section 2.
4

Lemma 1. Under Assumptions 1 and 2, the conditional moment restrictions
E{δm (O; µm )|D, X} = 0,

E{δy (O; β, µy )|D, X} = 0,

(9)

and the conditional mean independence restriction
E{δy (O; β, µy )δm (O; µm )|D, X} = ρ(X);

(10)

hold almost surely, where ρ is a square-integrable function mapping X to IR.
Remark 2. The parameter ρ(x) = cov(γ ∗ (X, U ), α∗ (X, U )|D, X = x) may be interpreted
as encoding the degree of mediator-outcome unmeasured confounding within the subpopulation
{X = x}, i.e. ρ(x) = 0 for all x ∈ X when either γ ∗ or α∗ does not vary with U . A related parameter encoding the correlation between errors in the outcome and mediation regression models
has previously been used in sensitivity analysis under unmeasured mediator-outcome confounding
by Imai et al. (2010a).
Remark 3. An alternative identification approach based on (9) is to restrict the parameter space
of (α, γ) under the instrumental variable framework. In this paper the parameters (µm , µy , β)
are unrestricted, and therefore identification may be established even in the absence of observed
baseline covariates.
Once β is identified, (µm (FO ), µy (FO )) can be identified through (9) and (10) as explicit functionals of the observed data distribution FO . The following assumption ensures that the solution to
(10) is unique.
Assumption 3 (Heteroscedasticity). σ 2 (D, X)
σ 2 (d, x) ≡ var(M |D = d, X = x).

6=

E{σ 2 (D, X)|X} almost surely, where

Necessary conditions for assumption 3 to hold are heteroscedasticity, σ(0, X)2 6= σ(1, X)2 ,
and non-degeneracy, pr(D = 1|X) ∈ (, 1−) for some  ∈ (0, 1/2), almost surely. Heteroscedasticity generally holds when there is a latent source of heterogeneity, independent of (X, U ), in the
exposure effect on the mediator (Tchetgen Tchetgen et al., 2020). Non-degeneracy may hold by
design when the exposure is randomly assigned.
Theorem 1. Under model A defined by Assumptions 1–3 and consistency, the parameters
(µm , µy , β) are identified. Accordingly, the mediation estimands ψnie = E{α(X)β(X)} and
ψnde = E{γ(X)} are identified.

4

Semiparametric inference

We construct estimating functions based on restriction (10), by following the G-estimation approach derived by Robins (1994) in the context of additive and multiplicative structural mean
models. Our proposed G-estimator for ψnie is based on the augmented unconditional form
0 = E[h(X){D − π(X)}{Ỹ (O; β)δm (O; µm ) − ρ(X)}];

5

(11)

where h is an arbitrary square-integrable function mapping X to IR and π(x) ≡ pr(D = 1|X = x)
denotes the propensity score. Because E{µy (D, X)δm (O; µm )|D, X} = 0, we do not have to
specify in (11) the nuisance parameter µy which encodes the direct effect of D on Y . On the other
hand, we consider estimation of ψnde based on the augmented unconditional moment restriction
0 = E[h(X){D − π(X)}{δy (O; β, µy )M − ρ(X)}];
which does not involve the mediator
E{δy (O; β, µy )µm (D, X)|D, X} = 0.

4.1

regression

nuisance

parameter

(12)
µm

since

Estimation of natural indirect effect

P
Throughout let Ê(·) denote the empirical mean operator Ê{G(O)} = n−1 ni=1 G(Oi ) for a
square-integrable function G(·), and let ω ∗ denote the probability limit of an estimator ω̂. To
construct a method of moments estimator based on the sample analogue of (11), we specify
the parametric working models Mnie = {β(x; θβ ), µm (d, x; θm ), ρ(x; θρ ), π(x; θπ ) : θnie =
T
(θβT , θm
, θρT , θπT )T ∈ Θnie ⊂ IRdim(θnie ) }, where dim(θnie ) < ∞ and Θnie is assumed to be a compact
set. Let


{fπ (X)(D − π(X; θπ )), fm (D, X)δm (O; θm )}T
,
fρT (X){Ỹ (O; θβ )δm (O; θm ) − ρ(X; θρ )}
(13)
ϕnie (O; θnie ) = 
T
fβ (X)(D − π(X; θπ )){Ỹ (O; θβ )δm (O; θm ) − ρ(X; θρ )}
where fv (x) = ∂v(x; θv )/∂θv for v ∈ {π, β, ρ} and fm (d, x) = ∂µm (d, x; θm )/∂θm . The proposed
T
G-estimator of ψnie is ψ̂nie (θ̂nie ) = Ê{α(X; θ̂m )β(X; θ̂β )}, where θ̂nie = (θ̂βT , θ̂m
, θ̂ρT , θ̂πT )T solves
0 = Ê{Gnie (O; θnie )}. The uniqueness of the solution to E{ϕnie (O; θnie )} can be partly justified
by the linearity of the first three components in ϕnie (·), which serve as estimating functions for the
regression parameters (θπ , θm , θρ ). For the last component, we require the matrix E{fβT (X)(D −
∗
π(X; θπ∗ ))M δm (O; θm
)fβ (X)} to have full rank. If the models in Mnie are correctly specified, then
this matrix is equivalent to E{fβT (X)(D −π(X))σ 2 (D, X)fβ (X)}, which can be non-singular due
to Assumption 3. More generally, we assume that the following condition holds.
∗
∗
E{Gnie (O; θnie )} = 0 only if θnie = θnie
, and θnie
lies in the interior of Θnie .

(14)

Proposition 4.1. Suppose condition (14) holds. Then under standard regularity conditions (Newey
and McFadden, 1994), ψ̂nie is consistent and asymptotically normal in model A if either (i)
{β, µm , π} ⊂ Mnie or (ii) {β, µm , ρ} ⊂ Mnie .
Remark 4. Under model A,
ρ(x) = E{Ỹ (O; β)δm (O; µm )|D, X = x} = E{δy (O; β, µy )M |D, X = x}.
It follows that the parameterizations for π(x) and ρ(x) are variation independent in Propositions
4.1 and 4.2 below.
Remark 5. Inferences based on the propensity score-based estimator of the natural indirect effect
proposed by Fulcher et al. (2019) may be viewed as special instances of ψ̂nie obtained under the
particular model specification ρ(x; θρ ) = 0.
6

An appealing feature of ψ̂nie is that the nuisance parameter µy which encodes the direct exposure effect can be left unspecified, although we need to specify low-dimensional parametric
models for the separate set of nuisance parameters (π, ρ). Remark 4 shows that it is possible for
either working model to be correct a priori, thus giving the analyst two genuine opportunities, instead of one, to obtain valid inferences (Robins and Rotnitzky, 2001). In principle, we can also
implement the estimator proposed by Fulcher et al. (2019) using a flexible data-adaptive estimator
π̂ of the propensity score and solve the sample version of
g(O; π̂, θβ , θm ) = {fm (D, X)δm (O; θm ), fβ (X)(D − π̂(X))Ỹ (O; θβ )δm (O; θm )}T .

(15)

However, the mean square convergence rate of π̂ will typically be Op (n−r ) with r < 1/2 due to
T T
bias from regularization and overfitting , and the resulting estimator (θ̂βT , θ̂m
) which solves the
empicial version of (15) cannot attain root-n consistency.
Recent work by Chernozhukov et al. (2018, 2020) shows that adding the the influence function
φ(O; π, ρ) = {0, −fβ (X)(D − π(X))ρ(X)}T associated with nonparametric estimation of π to
(15) can dampen the local effect of the first-step estimation of π. The impact of regularization
bias and over-fitting is further mitigated by cross-fitting. We briefly describe the construction of
such a debiased G-estimator. Let (I` )L`=1 be a L-fold random partition of the observation indices
{1, 2, ..., n}, and let π̂` and ρ̂` be estimators that are constructed using all observations not in I` .
T T
The debiased G-estimator of ψnie is ψ̃nie = Ê{α(X; θ̃m )β(X; θ̃β )}, where (θ̃βT , θ̃m
) solves
L

1 XX
{g(Oi ; π̂` , θβ , θm ) + φ(Oi ; π̂` , ρ̂` )}.
0=
n `=1 i∈I

(16)

`

It can be shown that ψ̃nie is asymptotically normal under mild mean square consistency assumptions for π̂` and ρ̂` separately, as well as the rate condition ||π̂` − π||||ρ̂` − ρ|| = op (n−1/2 )
where || · || denotes the mean square norm, even when the complexity of the nuisance parameter space is not tractable by standard empirical process methods (e.g. Vapnik-Chervonenkis and
Donsker classes). Such rates are achievable for many highly data-adaptive machine learning methods, including Lasso (Tibshirani, 1996), gradient boosting trees (Friedman, 2001), random forests
(Breiman, 2001; Wager and Athey, 2018) or ensembles of these methods.

4.2

Estimation of natural direct effect

Estimation of ψnde based on (12) entails working models for the outcome regression, Mnde =
{β(x; θβ ), µy (x; θy ), ρ(x; θρ ), π(x; θπ ) : θnde = (θβT , θyT , θρT , θπT )T ∈ Θnde ⊂ IRdim(θnde ) }. Let



{fπ (X)(D − π(X; θπ )), fy (D, X)δy (O; θβ , θy )}T
.
fρT (X){δy (O; θβ , θy )M − ρ(X; θρ )}
ϕnde (O; θnde ) = 
T
fβ (X)(D − π(X; θπ )){δy (O; θβ , θy )M − ρ(X; θρ )}

(17)

The proposed G-estimator of ψnde is ψ̂nde (θ̂nde ) = Ê{τα (X; θ̂y )}, where θ̂nde solves 0 =
Ê{ϕnde (O; θnde )}. For identification, we assume
∗
∗
E{ϕnde (O; θnde )} = 0 only if θnde = θnde
, and θnde
lies in the interior of Θnde .

7

(18)

Proposition 4.2. Suppose condition (18) holds. Then under standard regularity conditions (Newey
and McFadden, 1994), ψ̂nde is consistent and asymptotically normal in model A if either (i)
{β, µy , π} ⊂ Mnde or (ii) {β, µy , ρ} ⊂ Mnde .

5

Semiparametric sensitivity analysis

In this section we describe a semiparametric framework to assess the sensitivity of inferences to
departures from the anchor scenario of no essential heterogeneity in Assumption 2. Suppose there
is reason to believe that the exposure effect α(x, u) on the mediator varies with (X, U ). Then (10)
no longer holds, but instead
E{δy (O; β, µy )δm (O; µm )|D, X = x} = ρ(x) + λ(x)D;
where λ(x) = cov(α(X, U ), γ ∗ (X, U )|D, X = x). Inference about the natural indirect and direct
effects can proceed by assuming that λ(x) is known. Consider the parametric family of violations
{λ(x; θλ ) : θλ } indexed by a finite dimensional parameter θλ with λ(x; 0) = 0. For a fixed value
θλ? , we implement the doubly robust estimator ψ̂nie (θλ? ) based on the estimating function


{fπ (Xi )(D − π(X; θπ )), fm (D, X)δm (O; θm )}T
,
fρT (X){Ỹ (O; θβ )δm (O; θm ) − ρ(X; θρ )}
ϕnie (O; θnie , θλ? ) = 
fβT (X)(D − π(X; θπ )){Ỹ (O; θβ )δm (O; θm ) − ρ(X; θρ ) − λ(X; θλ? )D}
and ψ̂nde (θλ∗ ) based on an analogous modification of estimating function (17). A sensitivity
analysis is then obtained by repeating this process and then reporting the sets {ψ̂nie (θλ ) : θλ },
{ψ̂nde (θλ ) : θλ } with the associated confidence intervals. This framework may be readily extended
to investigate departures from Assumption 2 for any (combination) of the causal effects (α, β, γ).

6

Simulations

We perform simulations to study the pointwise properties of ψ̂nie and its associated confidence intervals. We generate the covariates X1 ∼ N(0, 1) and X2 ∼ N(0, 1) independently. To investigate
the impact of model misspecification, we also construct standardized versions of the transformed
variables Xj∗ = Xj + {max(Xj , 0)}2 for j = 1, 2, which ensures a one-to-one mapping between
Xj and Xj∗ . Consider the following scenarios:
(i) Generate
U |X ∼ N{0, σ 2 = exp(−1.2 + 0.8X1 − 0.2X2 )},
D|X ∼ Bernoulli{p = (1 + exp(1 − 1.5X1 + 0.3X2 ))−1 },
M = 1 + (1.5 + εm )D + 0.5U, Y = 1 + D + 2M + U ;
where U is an unmeasured factor that induce mediator-outcome dependence, and the latent
effect heterogeneity εm ∼ N (0, 1) is generated independently.
(ii) Generate (D, M, Y ) as in (i), but generate U |X ∼ N{0, σ 2 = exp(−1.2 + 0.8X1∗ − 0.2X2∗ )}.

8

Figure 2: Boxplots of estimates of ψnie relative to 3.
Table 1: Coverage proportions based on 1000 replicates (n = 600).
Scenario (i)
ψ̂nie

ψ̂ps

ψ̂bk

Scenario (ii)
ψ̂nie

ψ̂ps

ψ̂bk

Scenario (iii)
ψ̂nie

ψ̂ps

ψ̂bk

Scenario (iv)
ψ̂nie

ψ̂ps

ψ̂bk

Cov90 .891 .892 .028 .902 .894 .017 .901 .871 .027 .770 .540 .016
Cov95 .944 .946 .064 .947 .943 .043 .958 .948 .060 .844 .684 .038
Note: Cov90 or Cov95 is the coverage proportion of the 90% or 95% Wald confidence intervals.

(iii) Generate (U, M, Y ) as in (i), but generate D|X ∼ Bernoulli{p = (1 + exp(1 − 1.5X1∗ +
0.3X2∗ ))−1 }.
(iv) Generate (M, Y ) as in (i), but generate U |X ∼ N{0, σ = exp(−1.2 + 0.8X1∗ − 0.2X2∗ )},
D|X ∼ Bernoulli{p = (1 + exp(1 − 1.5X1∗ + 0.3X2∗ ))−1 }.
We implement the following estimators of ψnie = 3 with the working models in Mnie correctly
specified under scenario (i): the proposed doubly robust estimator ψ̂nie , the propensity score-based
estimator ψ̂ps (Fulcher et al., 2019) and the product of coefficients estimator ψ̂bk (Baron and Kenny,
1986) which does not account for unmeasured mediator-outcome confounding. The working models can be classified as follows in the other scenarios: (ii) ρ(x; θρ ) is incorrect, (iii) π(x; θπ ) is
incorrect and (iv) both models {ρ(x; θρ ), π(x; θπ )} are incorrect. Standard errors are obtained using the empirical sandwich estimator for generalized method of moments (Newey and McFadden,
1994).
We simulate 1000 replicates with sample size n = 600 for each scenario and summarize the
results with bias boxplots in Fig. 2 as well as the coverage proportions of the Wald confidence
intervals in Table 1. The estimators ψ̂nie and ψ̂ps perform similarly to each other in terms of
absolute bias, variance and coverage in scenarios (i) and (ii), but ψ̂nie yields noticeably smaller
absolute biases and better coverage than ψ̂ps in (iii) with incorrect propensity score model. The
estimator ψ̂bk shows large bias with coverage proportions below nominal values across scenarios
(i)–(iv), in agreement with theory.
9

7

A data application

We apply the proposed methods in reanalysing an observational study investigating the mediating
effect of posttraumatic stress disorder (PTSD) symptoms in the association between self-efficacy
and fatigue among health care workers during the COVID-19 outbreak (Hou et al., 2020). The
cross-sectional data was collected between March 13 and 20, 2020, from n = 527 health care
workers in Anqing City, Anhui Province, China, which borders Hubei province, the epicenter of the
COVID-19 outbreak. We refer interested readers to Hou et al. (2020) for further details on the study
design. For this illustration, the exposure D takes on value 1 if self-efficacy is above the sample
median of total scores on the General Self-Efficacy Scale, and 0 otherwise. PTSD symptoms (M )
and fatigue (Y ) are standardized total scores on the PTSD Checklist-Civilian Version and 14-item
Fatigue Scale respectively. The vector of observed baseline covariates X consists of age, gender,
marital status, education level, work experience (in years) and seniority, as well as level of negative
coping dichotomized at the sample median.
We specify the working models π(x; θπ ) = {1 + exp(−θπT x)}−1 and ρ(x; θρ ) = exp(θρT x)
for the nuisance parameters. Due to the limited sample size and because negative coping (Xnc )
has been hypothesised as an important effect modifier of the exposure’s effects on both the meT
T
x,
(1, xnc )T d + θm2
diator and outcome (Hou et al., 2020), we further specify µm (d, x; θm ) = θm1
T
T
T
µy (d, x; θy ) = θy1 (1, xnc ) d+θy2 x and β(x; θβ ) = θβ . The Breusch-Pagan test for heteroskedasticity (Breusch and Pagan, 1979) based on the working model µm (d, x; θm ) and the same linear model
for conditional variance, σ 2 (d, x; θσ2 ) = θσT2 ,1 (1, xnc )T d + θσT2 ,2 x, yields a p-value of 8.77 × 10−7
under the null hypothesis H0 : θσT2 ,1 = 0. Table 2 shows various estimates of the indirect and
direct effects of self-efficacy on fatigue. The regression approach of Baron and Kenny (1986)
yields an indirect effect estimate with 95% confidence interval −.272 ± .084. This result suggests
a significant mediating effect via PTSD symptoms in reducing fatigue, which is consistent with
the original findings by Hou et al. (2020). The proposed doubly robust approach yields an indirect
effect estimate close to 0, and the concomitant 95% confidence interval .049 ± .300 includes 0.
This suggests that we cannot rule out a null indirect effect after accounting for possible unmeasured common causes of PTSD and fatigue. The propensity-score based approach proposed by
Fulcher et al. (2019) gives similar results. We illustrate the sensitivity analysis described in section
5 under the parametric family {λ(x; θλ ) = θλ }, by evaluating ψ̂nie (θλ ) over a range of values for
θλ as shown in Fig. 3.
Table 2: Estimates of indirect and direct effects of selfefficacy on fatigue mediated though PTSD symptoms.
DR
ψnie
ψnde

PS

BK

.049 ± .300
.047 ± .294 −.272 ± .084
−.779 ± .342 −.776 ± .336 −.426 ± .146

Note: Estimate ± 1.96×standard error. DR denotes the proposed doubly robust estimators ψ̂nie and ψ̂nde . PS denotes
the propensity score-based variants by setting ρ(x; θρ ) = 0.
BK denotes the product of coefficients method of Baron and
Kenny (1986).

10

Figure 3: Plot of ψ̂nie (θλ ) versus θλ (solid), with 95% pointwise confidence intervals (dashes).

8

Extensions

The proposed semiparametric framework extends to a binary mediator under the following loglinear structual model.
Assumption 20
log{pr(M = 1|D = d, X = x, U = u)} = α(x)d + α∗ (x, u),
E(Y |D = d, M = m, X = x, U = u) = β(x)m + γ(x)d + γ ∗ (x, u).

(19)

Under Assumptions 1 and 20 , ψnie equals
ZZ
β(x){pr(M = 1|D = 1, X = x, U = u) − pr(M = 1|D = 0, X = x, U = u)}dFX,U (x, u)
= E[β(X){exp(α(X)) − 1} exp(α∗ (X, U ))] = E[β(X){exp(α(X)) − 1}α̃(X)],
where α̃(x) = E[exp{α∗ (X, U )}|X = x] = E[M exp{−α(X)D}|X = x], and ψnde =
E{γ(X)}. Let δ̃m (O; α, α̃) = M exp{−α(X)D} − α̃(X). Doubly robust G-estimation of
(ψnie , ψnde ) may proceed based on the following identifying restrictions, using methods analogous
to those described in section 4.
Lemma 2. Under Assumptions 1 and 20 , the conditional moment restrictions
E{δ̃m (O; α, α̃)|D, X} = 0,

E{δy (O; β, µy )|D, X} = 0,

(20)

and the conditional mean independence restriction
E{δy (O; β, µy )δ̃m (O; α, α̃)|D, X} = E{δy (O; β, µy )δ̃m (O; α, α̃)|X};

(21)

hold almost surely.
Extension to binary outcome under a log-linear structual model, in which case the mediation estimands of interest are the natural indirect and direct effects on the risk ratio scale (VanderWeele
11

and Vansteelandt, 2010; Valeri and VanderWeele, 2013), is not straightforward as building upon
the existing methods typically require FM |D,X,U to be a normal distribution function with constant
variance, in which case Assumption 3 fails to hold. A possible remedy is to focus on the mediation
effects on the risk difference scale. The proposed framework can also be extended in several other
important directions, including mediation analysis with survival data and multiple mediators under
unmeasured mediator-outcome confounding, which we plan to pursue in future research.

Acknowledgement
BaoLuo Sun’s work is supported by the National University of Singapore Start-Up Grant (R-155000-203-133).

References
Albert, J. M. (2008). Mediation analysis via potential outcomes models. Statistics in medicine,
27(8):1282–1304.
Baron, R. M. and Kenny, D. A. (1986). The moderator–mediator variable distinction in social psychological research: Conceptual, strategic, and statistical considerations. Journal of personality
and social psychology, 51(6):1173.
Breiman, L. (2001). Random forests. Machine learning, 45(1):5–32.
Breusch, T. S. and Pagan, A. R. (1979). A simple test for heteroscedasticity and random coefficient
variation. Econometrica: Journal of the Econometric Society, pages 1287–1294.
Burgess, S., Daniel, R. M., Butterworth, A. S., Thompson, S. G., and Consortium, E.-I. (2015).
Network mendelian randomization: using genetic variants as instrumental variables to investigate mediation in causal pathways. International journal of epidemiology, 44(2):484–495.
Chernozhukov, V., Chetverikov, D., Demirer, M., Duflo, E., Hansen, C., Newey, W., and Robins, J.
(2018). Double/debiased machine learning for treatment and structural parameters. The Econometrics Journal, 21(1):C1–C68.
Chernozhukov, V., Escanciano, J. C., Ichimura, H., Newey, W. K., and Robins, J. M. (2020).
Locally robust semiparametric estimation.
Ding, P. and Vanderweele, T. J. (2016). Sharp sensitivity bounds for mediation under unmeasured
mediator-outcome confounding. Biometrika, 103(2):483–490.
Dunn, G. and Bentall, R. (2007). Modelling treatment-effect heterogeneity in randomized controlled trials of complex interventions (psychological treatments). Statistics in Medicine,
26(26):4719–4745.
Friedman, J. H. (2001). Greedy function approximation: a gradient boosting machine. Annals of
statistics, pages 1189–1232.
12

Frölich, M. and Huber, M. (2017). Direct and indirect treatment effects-causal chains and mediation analysis with instrumental variables. Journal of the Royal Statistical Society: Series B
(Statistical Methodology), 79(5):1645–1666.
Fulcher, I. R., Shi, X., and Tchetgen Tchetgen, E. J. (2019). Estimation of natural indirect effects
robust to unmeasured confounding and mediator measurement error. Epidemiology, 30(6):825–
834.
Gallop, R., Small, D. S., Lin, J. Y., Elliott, M. R., Joffe, M., and Ten Have, T. R. (2009). Mediation
analysis with principal stratification. Statistics in medicine, 28(7):1108–1130.
Heckman, J. J., Urzua, S., and Vytlacil, E. (2006). Understanding instrumental variables in models
with essential heterogeneity. The Review of Economics and Statistics, 88(3):389–432.
Hernán, M. A. and Robins, J. M. (2006). Instruments for causal inference: an epidemiologist’s
dream? Epidemiology, pages 360–372.
Hou, T., Dong, W., Zhang, R., Song, X., Zhang, F., Cai, W., Liu, Y., and Deng, G. (2020). Selfefficacy and fatigue among health care workers during covid-19 outbreak: A moderated mediation model of posttraumatic stress disorder symptoms and negative coping. Preprint.
Imai, K., Keele, L., and Tingley, D. (2010a). A general approach to causal mediation analysis.
Psychological methods, 15(4):309.
Imai, K., Keele, L., and Yamamoto, T. (2010b). Identification, inference and sensitivity analysis
for causal mediation effects. Statistical science, pages 51–71.
Imai, K., Tingley, D., and Yamamoto, T. (2013). Experimental designs for identifying causal
mechanisms. Journal of the Royal Statistical Society: Series A (Statistics in Society), 176(1):5–
51.
Klein, R. and Vella, F. (2010). Estimating a class of triangular simultaneous equations models
without exclusion restrictions. Journal of Econometrics, 154(2):154–164.
Lewbel, A. (2012). Using heteroscedasticity to identify and estimate mismeasured and endogenous
regressor models. Journal of Business & Economic Statistics, 30(1):67–80.
Mattei, A. and Mealli, F. (2011). Augmented designs to assess principal strata direct effects.
Journal of the Royal Statistical Society: Series B (Statistical Methodology), 73(5):729–752.
Newey, K. and McFadden, D. (1994). Large sample estimation and hypothesis. Handbook of
Econometrics, IV, Edited by RF Engle and DL McFadden, pages 2112–2245.
Neyman, J. (1923). Sur les applications de la théorie des probabilités aux experiences agricoles:
Essai des principes. Roczniki Nauk Rolniczych, 10:1–51.
Ogburn, E. L. (2012). Commentary of “mediation analysis without sequential ignorability: using
baseline covariates interacted with random assignment as instrumental variables”. Journal of
Statistical Research, 46:105–111.
13

Pearl, J. (2001). Direct and indirect effects. In Proceedings of the Seventeenth Conference on Uncertainty in Artificial Intelligence, UAI’01, pages 411–420, San Francisco, CA, USA. Morgan
Kaufmann Publishers Inc.
Rigobon, R. (2003). Identification through heteroskedasticity. Review of Economics and Statistics,
85(4):777–792.
Robins, J. M. (1994). Correcting for non-compliance in randomized trials using structural nested
mean models. Communications in Statistics-Theory and methods, 23(8):2379–2412.
Robins, J. M. (2003). Semantics of causal dag models and the identification of direct and indirect
effects. Oxford Statistical Science Series, pages 70–82.
Robins, J. M. and Greenland, S. (1992). Identifiability and exchangeability for direct and indirect
effects. Epidemiology, pages 143–155.
Robins, J. M. and Richardson, T. (2010). Alternative graphical causal models and the identification
of direct effects. In Shrout, P., Keyes, K., and Ornstein, K., editors, Causality and Psychopathology: Finding the Determinants of Disorders and Their Cures, pages 103–58. Oxford University
Press, Oxford, UK.
Robins, J. M. and Rotnitzky, A. (2001). Comment on the bickel and kwon article,“inference for
semiparametric models: Some questions and an answer”. Statistica Sinica, 11(4):920–936.
Rosenbaum, P. R. and Rubin, D. B. (1983). The central role of the propensity score in observational
studies for causal effects. Biometrika, 70(1):41–55.
Rubin, D. B. (1974). Estimating causal effects of treatments in randomized and nonrandomized
studies. Journal of educational Psychology, 66(5):688.
Sjölander, A. (2009). Bounds on natural direct effects in the presence of confounded intermediate
variables. Statistics in Medicine, 28(4):558–571.
Small, D. S. (2012). Mediation analysis without sequential ignorability: using baseline covariates
interacted with random assignment as instrumental variables. Journal of Statistical Research,
46:91–103.
Tchetgen Tchetgen, E. J. and Shpitser, I. (2012). Semiparametric theory for causal mediation
analysis: efficiency bounds, multiple robustness, and sensitivity analysis. Annals of statistics,
40(3):1816.
Tchetgen Tchetgen, E. J., Sun, B., and Walter, S. (2020). The genius approach to robust mendelian
randomization inference. Statistical Science, in press.
Ten Have, T. R., Joffe, M. M., Lynch, K. G., Brown, G. K., Maisto, S. A., and Beck, A. T. (2007).
Causal mediation analyses with rank preserving models. Biometrics, 63(3):926–934.
Tibshirani, R. (1996). Regression shrinkage and selection via the lasso. Journal of the Royal
Statistical Society: Series B (Methodological), 58(1):267–288.
14

Valeri, L. and VanderWeele, T. J. (2013). Mediation analysis allowing for exposure–mediator
interactions and causal interpretation: theoretical assumptions and implementation with sas and
spss macros. Psychological methods, 18(2):137.
van der Laan, M. J. and Petersen, M. L. (2008). Direct effect models. The international journal of
biostatistics, 4(1).
VanderWeele, T. J. (2010). Bias formulas for sensitivity analysis for direct and indirect effects.
Epidemiology (Cambridge, Mass.), 21(4):540.
VanderWeele, T. J. (2015). Explanation in causal inference: methods for mediation and interaction. Oxford University Press.
VanderWeele, T. J. and Vansteelandt, S. (2010). Odds ratios for mediation analysis for a dichotomous outcome. American journal of epidemiology, 172(12):1339–1348.
Wager, S. and Athey, S. (2018). Estimation and inference of heterogeneous treatment effects using
random forests. Journal of the American Statistical Association, 113(523):1228–1242.
Zheng, C. and Zhou, X.-H. (2015). Causal mediation analysis in the multilevel intervention and
multicomponent mediator case. Journal of the Royal Statistical Society: Series B: Statistical
Methodology, pages 581–615.

15

Semiparametric causal mediation analysis under unmeasured
mediator-outcome confounding

Appendix
Proof of Lemma 1
The conditional moment restrictions (9) hold by definition. Taking iterated expectation of (10) with
respect to (D, M, X, U ) followed by (D, X, U ) yields
E{(γ ∗ (X, U ) − γ̄(X))(α∗ (X, U ) − ᾱ(X))|D, X} = cov{γ ∗ (X, U ), α∗ (X, U )|D, X} = ρ(X),
where the last equality holds by the conditional independence U ⊥ D|X.

Proof of Theorem 1
Let m(O; t) = E{δy (O; t, µy )δm (O; µm )|D, X} − E{δy (O; t, µy )δm (O; µm )|X}. By Lemma 1,
m(O; β) = 0 almost surely. Suppose another square-integrable function β̃ mapping X to IR
satisfies m(O; β̃) = 0 almost surely. Then m(O; β) − m(O; β̃) = {β(X) − β̃(X)}{σ 2 (D, X) −
E(σ 2 (D, X)|X)} = 0 almost surely, which under Assumption 3 implies that β(X) = β̃(X) almost
surely.

Proof of Propositions 4.1 and 4.2
Proposition 4.1
Suppose the conditions in Theorem 3.4 of Newey and McFadden (1994) hold for ϕnie (O; θnie ).
Using Taylor expansion,
)−1
(
∂ϕ
(O;
θ
)
nie
nie
∗
∗
n1/2 Ê{ϕnie (O; θnie
)} + op (1),
n1/2 (θ̂nie − θnie
) = −E
∂θnie
θnie =θ∗
nie

where H −1 denotes the inverse of H. In case (i), π(x; θπ∗ ) = π(x) but possbily ρ∗ (x) = ρ(x; θρ∗ ) 6=
ρ(x) for at least one value x ∈ X . Because the solution to E{ϕnie (O; θnie )} = 0 is unique,
∗
) − ρ∗ (X))}
E{fβT (X)(D − π(X))(Ỹ (O; θβ∗ )δm (O; θm
∗
= E{fβT (X)(D − π(X))(Ỹ (O; θβ∗ )δm (O; θm
) − ρ(X) + ρ(X) − ρ∗ (X))}
∗
= E{fβT (X)(D − π(X))(Ỹ (O; θβ∗ )δm (O; θm
) − ρ(X))} = 0,
∗
implies Ỹ (O; θβ∗ ) = Ỹ (O; β) and δm (O; θm
) = δm (O; µm ). On the other hand, in case (ii)
∗
∗
ρ(x; θρ ) = ρ(x) but possibly π (x) = π(x; θπ∗ ) 6= π(x) for at least one value x ∈ X . Then
similarly
∗
E{fβT (X)(D − π ∗ (X))(Ỹ (O; θβ∗ )δm (O; θm
) − ρ(X))}
∗
= E{fβT (X)(D − π ∗ (X))(E(Ỹ (O; θβ∗ )δm (O; θm
)|D, X) − ρ(X))}
∗
= E{fβT (X)(D − π ∗ (X))(E(Ỹ (O; θβ∗ )δm (O; θm
)|X) − ρ(X))} = 0,

16

∗
implies Ỹ (O; θβ∗ ) = Ỹ (O; β) and δm (O; θm
) = δm (O; µm ). Let τ (x; θnie ) = α(x; θm )β(x; θβ ).
Under sufficient smoothness conditions for the parametric models in Mnie , the asymtotic normality
of ψ̂nie follows from the Taylor expansion
(
)
∂τ (X; θnie )
∗
∗
∗
∗
n1/2 (ψ̂nie − ψnie
) =n1/2 Ê{τ (X; θnie
) − ψnie
}−E
n1/2 (θ̂nie − θnie
) + op (1),
∂θnie
θnie =θ∗
nie

by Slutsky’s Theorem and the Central Limit Theorem.
Proposition 4.2
The proof is similar, by noting that
E{fβT (X)(D − π(X))(δy (O; θβ∗ , θy∗ )M − ρ∗ (X))}
= E{fβT (X)(D − π(X))(δy (O; θβ∗ , θy∗ )M − ρ(X) + ρ(X) − ρ∗ (X))}
= E{fβT (X)(D − π(X))(δy (O; θβ∗ , θy∗ )M − ρ(X))} = 0,
and
E{fβT (X)(D − π ∗ (X))(δy (O; θβ∗ , θy∗ )M − ρ(X))}
= E{fβT (X)(D − π ∗ (X))(E(δy (O; θβ∗ , θy∗ )M |D, X) − ρ(X))}
= E{fβT (X)(D − π ∗ (X))(E(δy (O; θβ∗ , θy∗ )M |X) − ρ(X))} = 0.

Proof of Lemma 2
Taking iterated expectation of the first equation in (20) with respect to (D, X, U ) yields
E[exp{α(X)D + α∗ (X, U ) − α(X)D} − α̃(X)|D, X] = E[exp{α∗ (X, U )}|D, X] − α̃(X) = 0.
Taking iterated expectation of (21) with respect to (D, M, X, U ) followed by (D, X, U ) yields
E{(γ ∗ (X, U ) − γ̄(X))(exp{α∗ (X, U )} − α̃(X))|D, X} = cov{γ ∗ (X, U ), exp{α∗ (X, U )}|D, X}
= cov{γ ∗ (X, U ), exp{α∗ (X, U )}|X}.
The last equalities in both of the above equations hold by the conditional independence U ⊥ D|X.

17

