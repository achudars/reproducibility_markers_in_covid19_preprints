C OVID 19

AND A
PER

WAVELET A NALYSIS OF THE T OTAL D EATHS
M ONTH IN B RAZIL SINCE 2015

arXiv:2009.00648v1 [eess.SP] 1 Sep 2020

A P REPRINT
Alexandre Barbosa de Lima
Member, IEEE
School of Engineering, University of S√£o Paulo
Department of Energy and Automation ‚Äì Researcher
alexandreblima@usp.br

September 3, 2020

A BSTRACT
We investigate the historical series of the total number of deaths per month in Brazil since 2015 using
the wavelet transform, in order to assess whether the COVID-19 pandemic caused any change point
in that series. Our wavelet analysis shows that the series has a change point in the variance. However,
it occurred long before the pandemic began.
Keywords COVID-19 ¬∑ Wavelet analysis ¬∑ change point

1

Introduction

Until the time of this writing, the Brazilian Federal Ministry of Health has recorded 3,846,153 Sars-CoV-2 case reports
and 120, 462 deaths caused by the COVID-19 pandemic [1] , [2].
According to the Coronavirus Resource Center of the Johns Hopkins University (JHU) [3], Brazil is the second country
most affected by COVID-19 in the world, both in number of cases and in number of deaths.
This article aims to investigate the historical series of the total number of deaths using the wavelet transform, which
is a powerful time-frequency domain signal processing tool [4]. From now on, such series will be referred simply as
historical series or signal .
Wavelet analysis is capable of solving problems, such as the detection of the change point in a signal (a transient
phenomena [5], [6]), which are difficult to approach with tools such as the Windowed Fourier Transform (WFT) [7].
A signal is any sequence of observations associated with an ordered independent variable t, which can be discrete or
continuous [4].
The signal is interrogated using wavelet analysis in order to answer the following questions: i) Does the series present
any change point(s)? ii) If there is a change point, what is its type (change in level, variance, etc. )? iii) If there is a
change point, did it occur during the COVID-19 pandemic?
The database used is that made available online by the Transparency Portal of the Civil Registry Offices of Brazil
[8], which consolidates the amount of birth, marriage and death certificates available in Brazil. Online data has been
available since January 2015. Brazilian registries are regulated by the National Council of Justice (CNJ), which is a
public institution headquartered in Bras√≠lia, Federal District, that aims to improve the work of the Brazilian judicial
system, especially with regard to administrative and procedural control and transparency [9]. The president of the
Brazilian Supreme Court also presides the CNJ.
The analysis was performed using the R software, version 4.0.2 [10] and the MATLAB¬© R2015a Wavelet Toolbox. The
R and MATLAB¬© codes, as well as the database in Excel spreadsheet format, are available for public consultation and
auditing on GitHub [11].

Covid 19 and A Wavelet Analysis of the Total Deaths per Month in Brazil since 2015

A P REPRINT

The remainder of the paper is organized as follows. Section 2 presents an overview of the Continuous and Discrete
Wavelet Transforms for the reader who is not familiar with the subject. If the reader is familiar with the theory of
wavelets, he or she may proceed to Section 3, which presents the experimental results. Finally, section 4 presents our
conclusions and and highlights some topics for further work.

2
2.1

Wavelets
The Continuous Wavelet Transform

The Fourier Transform (FT) of a signal x(t), t ‚àà R (t denotes time), if exists, is defined as
Z

‚àû

x(t)e‚àíj2œÄŒΩt dt

X(ŒΩ) = TF{x(t)} =

(1)

‚àí‚àû

in which ŒΩ denotes the frequency in cycles/second [Hz].
Gabor [12] has shown that it is possible to represent the local spectral content of a signal x(t) around an instant of time
œÑ by the Windowed Fourier Transform (WFT).
Z

‚àû

x(t)gT (t ‚àí œÑ )e‚àíj2œÄŒΩt dt ,

XT (ŒΩ, œÑ ) =

(2)

‚àí‚àû

in which gT (t) is a window of finite duration support T and ŒΩ denotes frequency.
The WFT is a two-dimensional representation defined on the time-frequency domain (or plane) as it depends on the ŒΩ
and œÑ parameters. The WFT would be equivalent to a kind of continuous ‚Äúsheet music‚Äù description of x(t).
According to the Heisenberg‚Äôs uncertainty principle [13, p.52], a signal whose energy content is quite well localized
in time has this energy quite spread out in the frequency domain. As the window of (2) has a fixed size T , we may
conclude that the WFT is not good to analyze (or identify) behaviors of x(t) occurring in time intervals much smaller
or much larger than T , as, for example, transient phenomena of duration ‚àÜt << T or cycles that exist in periods larger
than T .
A wavelet œà0 (t) (sometimes also called mother wavelet), t ‚àà R, is a function that satisfies three conditions [4], [14].
1. Its Fourier transform Œ®(ŒΩ), ‚àí‚àû < ŒΩ < ‚àû, is such that exists a finite constant Cœà that obeys the admissibility
condition
Z ‚àû
|Œ®(ŒΩ)|2
0 < Cœà =
dŒΩ < ‚àû .
(3)
ŒΩ
0
2. The integral of œà0 (t) is null:
Z

‚àû

œà0 (t) dt = 0 .

(4)

|œà0 (t)|2 dt = 1 .

(5)

‚àí‚àû

3. Its energy is unitary:
Z

‚àû

‚àí‚àû

Figure 1 shows four examples of wavelet functions: Haar, Daubechies, Coiflet and Symmlet. As the name suggests, a
wavelet is a ‚Äòsmall wave‚Äô. A small wave grows and decays in a limited time period. On the other hand, an example of a
‚Äòbig wave‚Äô is the cosine function cos t, which is ‚Äòeternal‚Äô, i. e., keeps oscilating up and down for all t.
The wavelet transform is a relatively new tool for the analysis of signals, given that his mathematical theory was
formalized in the 1980s [15]. The wavelet transform has been originally developed as an analysis and synthesis tool of
continuous time energy signals [16], [17], [18], [19], [15], [20].
An energy signal x(t), obeys the constraint
2

Z

‚àû

kxk = hx, xi ‚â°

|x(t)|2 dt < ‚àû,

‚àí‚àû

i. e., x(t) that obeys the constraint (6) belongs to the squared summable functions space L2 (R).
2

(6)

Covid 19 and A Wavelet Analysis of the Total Deaths per Month in Brazil since 2015

A P REPRINT

Figure 1: four examples of wavelet functions.

Presently, the wavelet transform has also been used as an analysis tool of discrete time signals.
There are continuous time and discrete time wavelet decompositions designate by Continuous Wavelet Transform
(CWT) and Discrete Wavelet Transform (DWT).
The CWT of a signal x(t) consists of a set C = {Wœà (s, œÑ ), s ‚àà R+ , œÑ ‚àà R}, in which
‚Ä¢ œÑ is the time localization parameter,
‚Ä¢ s represents scale, and
‚Ä¢ œà denotes a wavelet function,
of wavelet coefficients on the continuous time-scale plane (also known as time-frequency plane) given by
Z

‚àû

Wœà (s, œÑ ) = œà0(s,œÑ ) , x =
‚àí‚àû

1
‚àö œà0‚àó
s



Œª‚àíœÑ
s


x(Œª)dŒª

(7)


œà0(s,œÑ ) (t) = s‚àí1/2 œà0 t‚àíœÑ
denotes a dilated and shifted version of the ‚Äúmother‚Äù wavelet œà0 (t).
s
‚àö
The factor 1/ s in (7) provides all functions of the class

W=

1
‚àö œà0
s



t‚àíœÑ
s




‚ààR

(8)

have the same energy (norm).
The basic idea of the CWT defined by (7) is to correlate1 a signal x(t) with shifted (by œÑ ) and dilated (by s) versions
of a mother wavelet (that has a pass-band spectrum). The CWT is a two parameters function. So, it is a redundant
transform, because it consists on mapping an one-dimension signal on the time-scale plane.
1

Measure the similarity.

3

Covid 19 and A Wavelet Analysis of the Total Deaths per Month in Brazil since 2015

A P REPRINT

Differently from the WFT, where the reconstruction is made from the same family of functions as that used in the
analysis, in the CWT the synthesis is made with functions œàÃÉs,œÑ that have to satisfy
œàÃÉs,œÑ (t) =

1 1
œàs,œÑ (t) .
Cœà s2

(9)

So, x(t) is completely recovered by the Inverse Continuous Wavelet Transform (ICWT):
x(t) =

1
Cœà

Z

‚àû

Z

0

‚àû

1
Wœà (s, œÑ ) ‚àö œà
s
‚àí‚àû



t‚àíœÑ
s




dœÑ

ds
.
s2

(10)

The fundamental difference between the CWT and the WFT consists of the fact that the functions œàs,œÑ undergo dilations
and compressions [13]. The analysis on refined scales of time (small values of s) requires ‚Äúfast‚Äù œàs,œÑ functions, i. e., of
a small support, while the analysis on aggregate scales of time (large values of s) requires ‚Äúslower‚Äù œàs,œÑ functions, i. e.,
of a wider support.
 As already mentioned, the internal product defined by (7) is a measure of similarity between the
wavelet œà t‚àíœÑ
and the signal x(t) on a certain instant of time œÑ and on a determined scale s. For a fixed œÑ , large
s
values of s correspond to a low-frequency analysis, while small values of s are associated to a high-frequency analysis.
Therefore, the wavelet transform has a variable time resolution (i. e., the capacity of analyzing a signal from close ‚Äúzoom in‚Äù - or from far - ‚Äúzoom out‚Äù), being adequate to analyze phenomena that occur in different time scales.
Figure 2 provides an example of a CWT.

Figure 2: Analysis of an exponential discontinuity. The image on the bottom part of the figure is the CWT Wœà (s, œÑ ) of
the signal on the top part. The parameters œÑ = b and s = a vary along the horizontal and vertical axes, respectively.
Large (positive) values of wavelet coefficients are indicated in white. Note that the discontinuity produces large
coefficients in its respective cone of influence, which converge to the location of the singularity.
2.2

Multiresolution Analysis and the Discrete Wavelet Transform

There are two kinds of DWT:
‚Ä¢ the DWT for discrete time signals; and
‚Ä¢ the DWT for continuous time signals.
4

Covid 19 and A Wavelet Analysis of the Total Deaths per Month in Brazil since 2015

A P REPRINT

The DWT may be formulated for discrete time signals (as it is done, for example, by Percival and Walden [4]) without
establishing any explicit connection with the CWT. On the other hand, we should not understand the term ‚Äúdiscrete‚Äù of
the DWT for continuous time signals as meaning that this transform is defined over a discrete time signal. But only that
the coefficients produced by this transform belong to a subset D = {wj,k = Wœà (2j , 2j k), j ‚àà Z, k ‚àà Z} of the set C
[14, p.105], [21].
In fact, the DWT coefficients for continuous time signals can also be directly obtained by means of the integral
wj,k

E Z
D
= œà0(2j ,2j k) , x =

‚àû

2‚àíj/2 œà0‚àó (2‚àíj Œª ‚àí k)x(Œª) dŒª ,

(11)

‚àí‚àû

in which the indices j and k are called scale and localization, respectively, does not involve any discrete time signal, but
the continuous time signal x(t).
Equation (11) shows that the continuous time DWT corresponds to a critically sampled version of the CWT defined by
(7) in the dyadic scales s = 2j , j = . . . , ‚àí1, 0, 1, 2, . . ., in which the instants of time in the dyadic scale s = 2j are
separated by multiples of 2j . The function œà0 of (11) must be defined from a Multiresolution Analysis (MRA) of the
signal x(t) [4], [20], [22]. Observe that the continuous time MRA theory is similar to that of discrete time.
In this paper, we decided, for mere convenience, to present the continuous time MRA version based on the spectral
analysis of a ‚Äúfictitious‚Äù signal {xÃÉt , t ‚àà R} that is associated to the discrete time series {xn , n ‚àà Z} [21].
Figure 3 shows the critical sampling of the time-scale plane by means of the CWT parameters (s = 2j e œÑ = 2j k)
discretization.

Figure 3: Critical sampling of the time-scale plane by means of the CWT parameters (s = 2j e œÑ = 2j k) discretization.
A MRA is, by definition, a sequence of closed subspaces {Vj }j‚ààZ of L2 (R) such that [4, p.462], [20]:
1. . . . V2 ‚äÇ V1 ‚äÇ V0 ‚äÇ V‚àí1 ‚äÇ V‚àí2 ‚äÇ . . .;
T
2. j‚ààZ Vj = {};
S
3. j‚ààZ Vj = L2 (R);
4. x(t) ‚àà Vj ‚áî x(2j t) ‚àà V0 , j > 0 (in which t denotes time and x(t) is an energy signal);
5. There is a function œÜj (t) = 2‚àíj/2 œÜ0 (2‚àíj t) in Vj , called scale function, such that the set {œÜj,k , k ‚àà Z} is an
orthonormal basis of Vj , with œÜj,k (t) = 2‚àíj/2 œÜ0 (2‚àíj t ‚àí k) ‚àÄj, k ‚àà Z.
The subspace Vj is known as the approximation space associated to the time scale sj = 2j (assuming that V0 is the
approximation space with unit scale).
If the x(t) projection on Vj is represented by the scale coefficients
Z

‚àû

uj,k = hœÜj,k , xi =

2‚àíj/2 œÜ‚àó0 (2‚àíj t ‚àí k)x(t) dt,

‚àí‚àû

then properties 1 and 3 assure that lim

j‚Üí‚àí‚àû

P

k

œÜj,k (t)uj,k = x(t), ‚àÄ x ‚àà L2 (R).

Property 4 implies that the subspace Vj is a scaled version of subspace V0 (multiresolution).
5

(12)

Covid 19 and A Wavelet Analysis of the Total Deaths per Month in Brazil since 2015

A P REPRINT

The orthonormal basis mentioned in property 5 is obtained by time shifts of the low-pass function œÜj .
Consider the successive approximations sequence (also known in the literature as wavelet smooths [4]) of x(t)
X
Sj (t) =
œÜj,k (t)uj,k j = . . . , ‚àí1, 0, 1, . . . .

(13)

k

As Vj+1 ‚äÇ Vj , Sj+1 (t) is a coarser approximation of x(t) than Sj (t).
This fact illustrates the MRA‚Äôs fundamental idea, that consists in examining the loss of information when one goes from
Sj (t) to Sj+1 (t):
Sj (t) = Sj+1 (t) + ‚àÜxj+1 (t).

(14)

‚àÜxj+1 (t) (called detail of xj (t)) belongs to the subspace Wj+1 , named detail space [4] that is associated to the
fluctuations (or variations) of the signal in the more refined time scale sj = 2j and that corresponds to the orthogonal
complement of Vj+1 in Vj 2 .
The MRA shows that the detail signals ‚àÜxj+1 (t) = Dj+1 (t) may be directly obtained by successive projections of the
original signal x(t) over wavelet subspaces Wj .
Besides, the MRA theory shows that exists a function œà0 (t), called ‚Äúmother wavelet‚Äù , that is obtained from œÜ0 (t), in
which œàj,k (t) = 2‚àíj/2 œÜ0 (2‚àíj t ‚àí k) , k ‚àà Z, is an orthonormal basis of Wj .
The detail Dj+1 (t) is obtained by the equation
Dj+1 (t) =

X

œàj+1,k (t) hœàj+1,k (t), x(t)i .

(15)

k

The internal product hœàj+1,k (t), x(t)i = wj+1,k denotes the wavelet coefficient associated to scale j + 1 and discrete
time k and {œàj+1,k (t)} is a family of wavelet functions that generates the subspace Wj+1 , orthogonal to subspace Vj+1
(Wj+1 ‚ä•Vj+1 ), i. e.,
hœàj+1,n , œÜj+1,p i = 0 , ‚àÄn, p.
(16)
Therefore, the detail signal Dj+1 (t) belongs to the complementary subspace Wj+1 of Vj , because
Vj = Vj+1 ‚äï Wj+1 .

(17)

That is, Vj is given by the direct addition of Vj+1 and Wj+1 , and this means that any element in Vj may be determined
from the addition of two orthogonal elements belonging to Vj+1 and Wj+1 . Iterating (17), we have
Vj = Wj+1 ‚äï Wj+2 ‚äï . . .

.

(18)

wi,k œài,k (t) .

(19)

Eq. (18) says that the approximation Sj (t) is given by
Sj (t) =

‚àû X
X
i=j+1 k

The MRA of a continuous time signal x(t) is initiated by determining the coefficients3 u0 (k) = hœÜ0,k (t), x(t)i, in
which k = 0, 1, . . . , N ‚àí 1, that are associated to the projection of x(t) on the approximation subspace V0 .
Following, the sequence {u0 (k)} is decomposed by filtering and sub-sampling by a factor of 2 (downsampling) in
two sequences: {u1 (k)} and {w1 (k)}, each one with N/2 points. This filtering and sub-sampling process is repeated
several times, producing the sequences
{{u0 (k)}N , {u1 (k)} N , {u2 (k)} N , . . . , {uj (k)} Nj , . . . , {uJ (k)} NJ }
2

4

2

2

(20)

2

Besides, Wj+1 is contained in the subspace Vj .
The sequence u0 (k) is obtained sampling the filter‚Äôs output whose impulse response is œÜ‚àó (‚àít) (matched filter with a function
œÜ0 (t) = œÜ(t)) at instants k = 0, 1, 2, . . ., i. e., u0 (k) = x(t) ? œÜ‚àó (‚àít) for k = 0, 1, 2, . . ., in which ? denotes convolution.
3

6

Covid 19 and A Wavelet Analysis of the Total Deaths per Month in Brazil since 2015

A P REPRINT

and
{{w1 (k)} N , {w2 (k)} N , . . . , {wj (k)} Nj , {wJ (k)} NJ } .

(21)

The literature calls the set of coefficients [21], [23]
n
o
{w1 (k)} N , {w2 (k)} N , . . . , {wJ (k)} NJ , {uJ (k)} NJ

(22)

2

2

4

2

4

2

2

2

as the DWT of the x(t) signal.
Fig. 4 illustrates a 3-level DWT (decomposition in scales j = 1, 2, 3) associated to 1024 samples of the discrete time
signal x(t) = sin (3t) + sin (0.3t) + sin (0.03t), that corresponds to the superposition of 3 sinusoids in frequencies
f1 ‚âà 0.004775 cycle/sample, f2 ‚âà 0.04775 cycle/sample and f3 ‚âà 0.4775 cycle/sample. Fig. 5 shows the Power
Spectral Density (PSD) of this signal.

Figure 4: An illustration of the 3-levels DWT of the discrete time signal x(t) = sin (3t) + sin (0.3t) + sin (0.03t).
The graph concatenates the sequences of the scale coefficients {u3 (t)}128 and of the wavelet coefficients {w3 (t)}128 ,
{w2 (t)}256 e {w1 (t)}512 from left to right, i. e., the first 128 points correspond to the sequence {u3 (t)}128 ; then follow
the 128 points of the sequence {w3 (t)}128 , the 256 points of the sequence {w2 (t)}256 and 512 points of the sequence
{w1 (t)}512 .

Figure 5: PSD of the signal x(t) = sin (3t) + sin (0.3t) + sin (0.03t).
The reconstruction of x(t) is implemented by filtering and oversampling by a factor of 2 (upsampling) of the sequences
(20) and (21), obtaining an approximation of x(t) in the subspace V0
S0 (t) = SJ (t) + D1 (t) + D2 (t) + ¬∑ ¬∑ ¬∑ + DJ (t)
7

(23)

Covid 19 and A Wavelet Analysis of the Total Deaths per Month in Brazil since 2015

A P REPRINT

or
x(t) ‚âà

X

u(J, k)œÜJ,k (t) +

J X
X

wj,k œàj,k (t) .

(24)

j=1 k

k

Eq. (24) defines the Inverse Discrete Wavelet Transform (IDWT).
We say that the function œÜ0 (t) = œÜ(t) determines a MRA of x(t) according to (23), if it obeys the following conditions:
1. intra-scale orthonormality (property 5)
hœÜ(t ‚àí m), œÜ(t ‚àí n)i = Œ¥m,n ,

(25)

in which Œ¥m,n is the Kronecker‚Äôs delta (Œ¥m,n = 1 if m = n, Œ¥m,n = 0 for m 6= n). Eq. (25) imposes an
orthonormality condition at scale j = 0.
2. unit mean

Z

‚àû

œÜ(t) dt = 1 .

(26)

‚àí‚àû

3.

X
1
t
‚àö œÜ( ) =
gn œÜ(t ‚àí n) ,
2 2
n

(27)

as several œÜ(t ‚àí k) fit in œÜ( 2t ) (is a consequence of property (1) of the MRA).
Equation 27 may be rewritten as
œÜ(t) =

X‚àö

2gn œÜ(2t ‚àí n) ,

(28)

n

known as Dilation Equation, n ‚àà Z.
Equations 27 and 28 may be written, respectively, in the frequency domain as
‚àö

2Œ¶(2ŒΩ) = G(ŒΩ)Œ¶(ŒΩ) ,

(29)

and

1
ŒΩ
Œ¶(ŒΩ) = ‚àö G(ŒΩ)Œ¶( ) ,
(30)
2
2
P
in which Œ¶(ŒΩ) is the FT of œÜ(t) and G(ŒΩ) = n gn e‚àíj2œÄŒΩn , known as scale filter (low-pass), represents a periodic
filter in ŒΩ.
As the subspace Wj+1 is orthogonal to Vj+1 and is in Vj , we have
X
1
t
‚àö œà( ) =
hn œÜ(t ‚àí n) ,
2 2
n
or
œà(t) =

X‚àö

2hn œÜ(2t ‚àí n) ,

(31)

(32)

n

that is the Wavelet Equation.
Applying the FT to (31) and (32) we get, respectively,
p
and

(2)Œ®(2ŒΩ) = H(ŒΩ)Œ¶(ŒΩ) ,

1
ŒΩ
Œ®(ŒΩ) = ‚àö H(ŒΩ)Œ¶( ) .
2
2

in which H(ŒΩ) is the wavelet filter (high-pass).
8

(33)
(34)

Covid 19 and A Wavelet Analysis of the Total Deaths per Month in Brazil since 2015

A P REPRINT

Rewriting (16) in terms of the frequency domain and using (29) and (33) results the orthogonality condition
Z

‚àû

G(ŒΩ)H ‚àó (ŒΩ)|Œ¶(ŒΩ)|2 dŒΩ = 0 ,

(35)

‚àí‚àû

that the filter H has to obey so the family {œà1,k (t)} is orthogonal to the family {œÜ1,k (t)}.
We may show that the condition [13, p.150], [4, p.75]
hn = (‚àí1)n gL‚àí1‚àín ,

H(z) = ‚àíz ‚àíL+1 G(‚àíz ‚àí1 ) ,

‚Üî

(36)

in which L denotes the length of a Finite Impulse Response (FIR) filter gn , H(z) and G(z) denote the z-transform of
sequences hn and gn , respectively, is sufficient to (35) to hold.
We say that gn e hn are Quadrature Mirrored Filters (QMF) when they are related by (36).
Figure 6 shows the QMF filters frequency response related to a Daubechies wavelet of order 10 (db10).

Figure 6: QMF filters frequency response.
According to (28), the MRA departs from a definition (from several possible) of the scale function œÜ(t), that is related
to the scale filter gn by (27). Eq. (36) says that the choice of a FIR-type filter {gn } implies a {hn } that is also FIR. At
last, the wavelet function is determined by (31).
The scale œÜ(t) and wavelet œà(t) functions associated to the FIR filters {gn } and {hn } have compact support, thus
offering the time resolution functionality. The simplest scale function that satisfies (25) is the characteristic function of
the interval I = [0, 1), that corresponds to the Haar‚Äôs scale function:

œÜ

(H)


(t) = œá[0,1) (t) =

1, if 0 ‚â§ t < 1
0, otherwise.

(37)

In this case (Haar MRA), the associated Haar scale filter is given by
‚àö
‚àö
gn = {. . . , 0, g0 = 1/ 2, g1 = 1/ 2, 0, . . .} ,

(38)

‚àö
‚àö
hn = {. . . , 0, h0 = g1 = 1/ 2, h1 = ‚àíg0 = ‚àí1/ 2, 0, . . .}

(39)

the Haar wavelet filter by

and the Haar wavelet function by
œà (H) (t) = œá[0,1/2) (t) ‚àí œá[1/2,1) (t) .
9

(40)

Covid 19 and A Wavelet Analysis of the Total Deaths per Month in Brazil since 2015

A P REPRINT

Figure 7 shows the Daubechies‚Äô scale and wavelet functions with N = 2, 3, 4 vanishing moments
Z

‚àû

tm œà(t) dt = 0, m = 0, 1, . . . , N ‚àí 1 .

(41)

‚àí‚àû

Ingrid Daubechies [15] was the first one to propose a method for building sequences of transfer functions
(N )
{G(N ) (z)}N =1,2,3,... and {H (N ) (z)}N =1,2,3,... , in which G(N ) (z) is associated to the low-pass FIR filter gn and
(N )
H (N ) (z) to the high-pass filter hn . The corresponding scale and wavelet functions have support in [0, 2N ‚àí 1]. The
first member of the sequence is the Haar system œÜ(1) = œÜ(H) , œà (1) = œà (H) . The Daubechies‚Äô filters are generalizations
of the Haar system for N ‚â• 2 [13].

Figure 7: The graphs in the lower part show the Daubechies‚Äô wavelets with N = 2, 3, 4 vanishing moments, from left to
right, respectively. The corresponding scale functions are in the upper part.
We can demonstrate that [17]:
uj (n) =

X

g(k ‚àí 2n)uj‚àí1 (k)

(42)

h(k ‚àí 2n)uj‚àí1 (k) .

(43)

k

and that
wj (n) =

X
k

According to (42) and (43), we can obtain the coefficients uj (n) and wj (n) from the scale coefficients uj‚àí1 (m) by
means of decimation operation of the sequence {uj‚àí1 (m)} by a factor of 2. The decimation consists in cascading a
low-pass filter g(‚àím) (with a transfer function GÃÑ(z) = G(1/z) and frequency response G‚àó (f )) or a high-pass h(‚àím)
(with transfer function HÃÑ(z) = H(1/z) and frequency response H ‚àó (f )) with a compressor (or decimator) by a factor
of 2. Decimate a signal by a factor D is the same as to reduce its sampling rate by D times.
The MRA is implemented by a low-pass and high-pass analysis filter banks G‚àó (f ) and H ‚àó (f ) adequately positioned
for separating the scale and wavelet coefficients sequences. This is known in the literature as the pyramid algorithm
presented by Mallat [17]. Later, it is possible to rebuild the original signal using dual QMF reconstruction filter banks,
low-pass G(f ) and high-pass H(f ).
It is important to emphasize that the pyramid algorithm‚Äôs complexity is O(N ) (assuming we want to evaluate the DWT
of N samples), while the direct evaluation of the DWT (that involves matrices multiplication) is O(N 2 ) [4].
Figure 8 shows the QMF analysis filter banks G‚àó (f ) (low-pass) and H ‚àó (f ) (high-pass) with decimation (downsampling)
by a factor of 2. Figure 9 shows the QMF reconstruction filter banks with interpolation (upsampling) by a factor of 2.
Observe that are used dual low-pass and high-pass filters, G(f ) and H(f ).
10

Covid 19 and A Wavelet Analysis of the Total Deaths per Month in Brazil since 2015

A P REPRINT

Figure 8: QMF analysis filter banks G‚àó (f ) (low-pass) and H ‚àó (f ) (high-pass) with decimation (downsampling) by a
factor of 2.

Figure 9: QMF reconstruction filter banks with interpolation (upsampling) by a factor of 2. Observe that are used dual
low-pass and high-pass filters, G(f ) and H(f ).

Figure 10 presents the flow diagram that shows the initial projection of a signal x(t) on V0 followed by the decomposition
in W1 , W2 and V2 .

Figure 10: Flow diagram that shows the initial projection of a signal x(t) on V0 followed by the decomposition in W1 ,
W2 and V2 .
Figure 11 shows the flow diagram that illustrates the approximate synthesis of x(t) from W1 , W2 and V2 .
Figure 12 presents a block diagram that shows that the DWT works as a sub-bands codification scheme. The spectrum
U0 (f ) of the signal u0 (n) is subdivided in three frequency bands (that cover two octaves): 0 ‚â§ f < 1/8, 1/8 ‚â§ f < 1/4
and 1/4 ‚â§ f ‚â§ 1/2.
11

Covid 19 and A Wavelet Analysis of the Total Deaths per Month in Brazil since 2015

A P REPRINT

Figure 11: Flow diagram that illustrates the approximate synthesis of x(t) from W1 , W2 and V2 .

Figure 12: The spectrum U0 (f ) of the signal u0 (n) is subdivided in three frequency bands (that cover two octaves):
0 ‚â§ f < 1/8, 1/8 ‚â§ f < 1/4 and 1/4 ‚â§ f ‚â§ 1/2.

3

Experimental Results

In section 2, we described how the DWT can be applied to a signal x(t). However, the purpose of this study requires that
we think of x(t) as a realization of a stochastic process {x(t)}, so that we can be able to realize a statistical assessment
of the change point. The reader interested in the definition of a stochastic process can consult the reference [24] for
more information.
Figure 13 shows the historical series in Brazil from January 2015 to July 2020 (67 samples).

Figure 13: Historical series in Brazil from January 2015 to July 2020.
12

Covid 19 and A Wavelet Analysis of the Total Deaths per Month in Brazil since 2015

A P REPRINT

In the paper [24], we showed that the signal of Fig. 13 obeys a model of the type [25][p. 58]
x(t) = ¬µ(t) + y(t),

(44)

where x(t) are the observations, y(t) is a stationary process, and ¬µ(t) denotes a linear trend given by the regression
model
¬µ(t) = Œ≤0 + Œ≤1 t

(45)

in which Œ≤0 and Œ≤1 are the intercept and the slope parameters. We also estimated an autoregressive model of order 11
(AR(11)) for y(t). An AR(11) is said to exhibit short-range dependence, as the Power Spectral Density (PSD) of the
signal does not have 1/f behavior for frequencies near to zero (Long Range Dependence (LRD)).
In [24], we conclude that there are no change points in the slope of the historical series and in the mean of the series
that corresponds to the first difference of the historical series.
Table 1 shows the estimated coeffcientes for (45) and its p-values. Figure 14 shows the historical series with the
superimposed linear regression model.
Table 1: Estimated model for ¬µt .
c
c0
c1
c1
Œ≤0
p-value of Œ≤
Œ≤
p-value of Œ≤
‚àí16
‚àí16
68, 036.6
< 2.2e
674.7
< 2.2e

Figure 14: Historical series with the superimposed linear regression model.
As in [24], the first step in wavelet analysis requires that the deterministic trend of the historical series be removed, in
order to perform the time-frequency domain analysis [25][p. 58]. There are two alternatives: remove the line estimated
by the regression or take the first difference in the series. As our goal is to coerce the data to (a possible) stationarity,
then differencing may be more appropriate [25][p. 61]. The first two samples of the historical series were discarded so
that the series corresponding to the first difference has 64 points, that is, 26 points, which is appropriate for a wavelet
analysis with the DWT.
The first difference can be denote as
‚àÜx(t) = x(t) ‚àí x(t ‚àí 1) = r(t).

(46)

Figure 15 shows the series r(t) (we also demeaned it).
Now, as far as a qualitative analysis is concerned, we have to focus our wavelet (graphical) analysis on the most refined
scales of the time-frequency doman, where possible changes in variance can be localized. This is the intuition behind
13

Covid 19 and A Wavelet Analysis of the Total Deaths per Month in Brazil since 2015

A P REPRINT

Figure 15: first difference series.

the statistical test of homogeneity of variance proposed by Percival and Walden [4, p. 380]. The null hypothesis at level
j of the DWT is given by
H0 :

0

0

var{wj (Lj )} = var{wj (Lj + 1)} = . . . = var{wj (Nj ‚àí 1)},
0

0

(47)

0

where we assume that r(t) has Nj nonboundary wavelet coefficients wj (Lj ), wj (Lj + 1), . . . , wj (Nj ‚àí 1), in which
0
0
Nj = Nj ‚àí Lj .
Figs. 16 and 17 show the LA(8) DWT of signal rt and its wavelet tree, respectively. The wavelet coefficients of the node
(1, 1) of the tree in Fig.17 are between the frequencies 1/4 and 1/2. The change point is indicated by the blue arrow
(t = 22) in Fig. 16. Note that this point is localized just before the maximum value of the set of coefficients {w1 (k)} 64
.
2
The LA(8) wavelet has an approximate linear phase, which facilitates the alignment of the wavelet coefficients with the
signal of interest. Thus, this strategy is often a good choice when we want to detect a change point in the signal [4, p.
136].
Here is a noteworthy example of an important advantage of wavelet analysis over Fourier. Should the same signal had
been analyzed by the FT, we would not have been able to detect the instant of the change point, whereas it is clearly
observable here.
Now, let us compare the plot of the raw data along with the level-one wavelet detail signal (D1) in Fig. 18 (LA(8)
MRA), which indicates the existence of a change in variance
t = 22 (2017/jan), see the red arrow. Remember
 around

that the detail signal D1 is located in the frequency band 14 , 12 . Fig. 19 illustrates the Haar MRA. Note that we can
also see change in variance around t = 22 (2017/jan) in the level-one wavelet detail signal.
Now we can confirme our qualitative analysis using the function wvarchg() (MATLAB¬© R2015a Wavelet Toolbox),
which calculates the optimal positioning and (potentially) number of changepoints. As the signal r(t) is SRD, there is
no need to be concerned with the question of sampling of the variance of the wavelet coefficients, which is problematic
for long memory process [4, p. 380].
The test confirms that there is a change point in variance in t = 22.

4

Conclusions and Future Work

In this paper, we presented an overview of the Continuos and Discrete Wavelet Transforms, and a wavelet analysis of
the historical series of the total number of deaths per month in Brazil since 2015. Our preliminary results indicate that:
‚Ä¢ the variance of the signal changed in january of 2017; however, this change point occurred before the outbreak
of the COVID-19 pandemic; and
14

Covid 19 and A Wavelet Analysis of the Total Deaths per Month in Brazil since 2015

Figure 16: LA(8) DWT of signal rt (four levels).

15

A P REPRINT

Covid 19 and A Wavelet Analysis of the Total Deaths per Month in Brazil since 2015

Figure 17: Wavelet tree of the LA(8) DWT (four levels).

Figure 18: LA(8) MRA analysis of signal rt (four levels).

16

A P REPRINT

Covid 19 and A Wavelet Analysis of the Total Deaths per Month in Brazil since 2015

A P REPRINT

Figure 19: Haar MRA analysis of signal rt (four levels).
‚Ä¢ there is no evidence that COVID-19 provoked a change in the stochastic process that generates the historical
series, as there are no change points in this signal after the outbreak of COVID-19 in Brazil, which happened
in the beginning of march, 2020.
There is no doubt that COVID-19 has caused the deaths of many people around the world. Many who survived will
have to live with sequelae in the brain, kidneys, lungs and heart. In addition, the world population is being subjected to
a high degree of stress, due to fear of the new coronavirus, economic/financial problems, etc.
However, our results suggest that COVID-19 did not cause any change point in the brazilian series of the total number of
deaths per month in Brazil since 2015 so far. What would be a plausible explanation for this strange result? Answering
this question requires a multidisciplinary approach, as it involves several areas of knowledge such as medicine, signal
processing, statistics etc.
Nevertheless, researchers in the area must continue to monitor the behavior of the historical series in Brazil.
In future work, we suggest the application of the Maximal Overlap Discrete Wavelet Transform (MODWT) and the
Discrete Wavelet Packet Transform (DWPT) [4] to the brazilian historical series. We would also like to analyze the
series from other countries affected by COVID-19.

References
[1] Brazilian Federal Ministry of Health (Minist√©rio da Sa√∫de do Brasil). COVID-19 no Brasil, 2020.
[2] World Health Organization. Coronavirus disease (COVID-19) pandemic, 2020.
[3] Johns Hopkins University. COVID-19 Dashboard by the Center for Systems Science and Engineering (CSSE) at
Johns Hopkins University (JHU), 2020.
[4] D. B. Percival and A. T. Walden. Wavelet Methods for Time Series Analysis. Cambridge University Press, 2000.
[5] J. Chen and A. K. Gupta. Parametric statistical change point analysis. Birkhauser, 2000.
17

Covid 19 and A Wavelet Analysis of the Total Deaths per Month in Brazil since 2015

A P REPRINT

[6] R. Killick, I. A. Eckley, and P. Jonathan. A wavelet-based approach for detecting changes in second order structure
within nonstationary time series. Electron. J. Statist., 7:1167‚Äì1183, 2013.
[7] Alexandre Barbosa de Lima and Jos√© Roberto de Almeida Amazonas. Internet Teletraffic Modeling and Estimation.
Gistrup: Rivers Publishers, 2013.
[8] Civil Registry Offices of Brazil (Cart√≥rios de Registro Civil do Brasil). Transparency Portal (Portal da Transpar√™ncia), 2020.
[9] CNJ. Conselho Nacional de Justi√ßa, 2020.
[10] R Core Team. The R Project for Statistical Computing, 2020.
[11] Alexandre B. de Lima. Code and Data, 2020.
[12] D. Gabor. Theory of communication. J. Inst. Eletr. Eng., 93(III):429‚Äì457, 1946.
[13] G. Kaiser. A Friendly Guide to Wavelets. Birkh√§user, Boston, Mass., 1994.
[14] Ramazan Gen√ßay, Faruk Sel√ßuk, and Brandon Whitcher. An Introduction to Wavelets and Other Filtering Methods
in Finance and Economics. Academic Press, 2001.
[15] Ingrid Daubechies. Orthonormal bases of compactly supported wavelets. Comm. Pure Appl. Math., 41:909‚Äì996,
1988.
[16] A. Grossmann and J. Morlet. Decomposition of hardy functions into square integrable wavelets of constant shape.
SIAM J. Math., 15:723‚Äì736, 1984.
[17] S. G. Mallat. A theory for multiresolution signal decomposition: The wavelet representation. IEEE Transactions
on Pattern Analysis and Machine Intelligence, 11:674‚Äì693, 1989.
[18] S. G. Mallat. Multiresolution approximations and wavelet orthonormal bases of l2 (R). Transactions of the
American Mathematical Society, 315:69‚Äì87, 1989.
[19] S. G. Mallat. Multifrequency channel decompositions of images and wavelet models. IEEE Transactions on
Acoustics, Speech, and Signal Processing, 37:2091‚Äì2110, 1989.
[20] I. Daubechies. Ten Lectures on Wavelets. SIAM, Philadelphia, 1992.
[21] D. Veitch, M. S. Taqqu, and P. Abry. Meaningful MRA initialization for discrete time series. Signal Processing,
80:1971‚Äì1983, 2000.
[22] S. Mallat. A Wavelet Tour of Signal Processing. Academic Press, second edition, 1999.
[23] P. Abry and D. Veitch. Wavelet analysis of long-range dependent traffic. IEEE Transactions on Information
Theory, 4(1):2‚Äì15, 1998.
[24] Alexandre barbosa de Lima. An exploratory time series analysis of total deaths per month in Brazil since 2015.
2020.
[25] Robert H. Shumway and David S. Stofer. Time Series Analysis and Its Applications with R Examples. Springer,
2nd edition, 2006.

18

