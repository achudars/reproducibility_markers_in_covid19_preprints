Robust inference for nonlinear regression
models from the Tsallis score: application to
Covid-19 contagion in Italy

arXiv:2004.03187v2 [stat.AP] 9 Apr 2020

Paolo Girardi 1, Luca Greco 2, Valentina Mameli 3,
Monica Musio 4, Walter Racugno 4, Erlis Ruli 5 and
Laura Ventura 5
1

Department of Developmental Psychology and Socialisation, University of Padova,
Padova, Italy

2

Department of Law, Economics, Management and Quantitative Methods, Sannio
University, Benevento, Italy

3

Department of Economic and Statistical Sciences, University of Udine, Udine, Italy

4

Department of Mathematics and Informatics, University of Cagliari, Cagliari, Italy

5

Department of Statistical Sciences, University of Padova, Padova, Italy

Address for correspondence: Laura Ventura, Department of Statistical Sciences,
Via C. Battisti 241, 35121 Padova, Italy.
E-mail: ventura@stat.unipd.it.
Phone: (+39) 049 8274177.
Fax: +39) 049 8274170.

2

Paolo Girardi et al.

Abstract:

We discuss an approach for fitting robust nonlinear regression models,

which can be employed to model and predict the contagion dynamics of the Covid-19
in Italy. The focus is on the analysis of epidemic data using robust dose-response
curves, but the functionality is applicable to arbitrary nonlinear regression models.

Key words: Influence function; Model misspecification; Nonlinear regression; SARS
CoV-2 disease; Scoring rules.

1

Introduction

We aim to discuss a robust model which can be useful to model and predict the spread
of the Coronavirus disease SARS CoV-2 (Covid-19) in Italy. In particular, we focus on
a statistical model for daily deaths and cumulated intensive care unit hospitalizations
and that can help to understand when the peak and the upper asymptote of contagion
is reached, so that preventive measures (such as mobility restrictions) can be applied
and/or relaxed. For these data robust procedures are particularly useful since they
allow us to deal at the same time with model misspecifications and data reliability.
Nonlinear regression is an extension of classical linear regression, in which data are
modeled by a function, which is a nonlinear combination of unknown parameters and
depends on an independent variable. A relevant application of non-linear regression
models concerns the modeling of so called dose-response relation, useful in toxicology, pharmacology and in the analysis of epidemic data. In these frameworks, the
parameters of the model have a relevant interpretation, such as the upper limit and
the inflection point.

Robust inference for nonlinear regression models

3

A normal non-linear regression model is obtained by replacing the linear predictor
xT β by a known non-linear function µ(x, β), called the mean function. The model
(see, e.g., Bates and Watts, 2007)
yi = µ(xi , β) + εi ,

with i = 1, . . . , n,

(1.1)

is called a non-linear regression model, where xi is a scalar covariate, β is an unknown
p-dimensional parameter, and εi are independent and identically distributed N (0, σ 2 )
random variables.
Likelihood inference is the usual approach to deal with nonlinear models. The loglikelihood function for θ = (β, σ 2 ) is
n
1 X
n
2
[yi − µ(xi , β)]2 ,
`(θ) = − log (2πσ ) − 2
2
2σ i=1

(1.2)

and all likelihood quantities (maximum likelihood estimates, tests, confidence intervals, prediction, etc) can be easily derived. In practice, using the statistical environment R, the package drc (Ritz et al., 2015) provides a user-friendly interface to
specify the model assumptions about the nonlinear relationship and comes with a
number of extractors for summarizing fitted models and carrying out inference on
derived parameters.
A large number of more or less well-known model functions are available (log-logistic,
Weibull, Gamma, etc, see for instance Ritz et al., 2015, Table 1). These models are
parameterized using a unified structure with a coefficient b denoting the steepness of
the curve, c and d the lower and upper asymptotes or limits of the response, and,
for some models, e the inflection point. For instance, the five parameter log-logistic
model assumes
µ(xi , β) = c +

d−c
,
(1 + exp(b(log(x) − log(e))))f

with β = (b, c, d, e, f ).

(1.3)

4

Paolo Girardi et al.

However, in the presence of model misspecifications or deviations in the observed data,
classical likelihood inference may be innacurate (see, e.g., Huber and Ronchetti, 2009,
and references therein). The aim of this paper is to discuss the use of robust inference
on nonlinear regression models. In particular, we discuss a general approach based
on the Tsallis score (Basu et al., 1988, Ghosh and Basu, 2013, Dawid et al., 2016,
Mameli et al., 2018).

2

Tsallis score

To deal with model misspecifications, useful surrogate likelihoods are given by proper
scoring rules (see Dawid et al., 2016, and references therein). A scoring rule is a loss
function which is used to measure the quality of a given probability distribution for
a random variable Y , in view of the result y of Y .
When working with a parametric model with probability density function f (y; θ),
with θ ∈ Θ ⊆ IRd , an important example of proper scoring rules is the log-score,
which corresponds to minus the log-likelihood function (Good, 1952). In this paper,
to deal with robustness, we focus on the Tsallis score (Tsallis, 1988), given by
Z
S(y; θ) = (γ − 1)

f (y; θ)γ dy − γf (y; θ)γ−1 ,

γ > 1.

(2.1)

The density power divergence dα of Basu et al. (1998) is just (2.1), with γ = α + 1,
multiplied by 1/α. The Tsallis score gives in general robust procedures (Ghosh and
Basu, 2013, Dawid et al., 2016), and the parameter γ is a trade-off between efficiency
and robustness.

Robust inference for nonlinear regression models

5

For the nonlinear regression model (1.1), the total Tsallis score for θ = (β, σ 2 ) is
S(θ) =

n
X

"


−γ

√

i=1

+

2.1

(γ − 1)
√

γ(2πσ 2 )

(γ−1)

1
2πσ 2
#

(γ−1)
2



(γ − 1)
exp −
(yi − µi (xi , β))2
2
2σ

.



(2.2)

Inference

The validity of inference about θ = (β, σ 2 ) using scoring rules can be justified by
invoking the general theory of unbiased M -estimating functions. Indeed, inference
based on proper scoring rules is a special kind of M -estimation (see, e.g., Dawid et
al., 2016, and references therein). The class of M -estimators is broad and includes
a variety of well-known estimators. For example it includes the maximum likelihood
estimator (MLE) and robust estimators (see e.g. Huber and Ronchetti, 2009) among
others.
Let s(y; θ) be the gradient vector of S(y; θ) with respect to θ, i.e. s(y; θ) = ∂S(y; θ)/∂θ.
Under broad regularity conditions (see Mameli and Ventura, 2015, and references
therein), the scoring rule estimator θ̃ is the solution of the unbiased estimating equaP
tion s(θ) = ni=1 s(yi ; θ) = 0 (see Dawid et al., 2016) and it is asymptotically normal,
with mean θ and covariance matrix V (θ)/n, where
V (θ) = K(θ)−1 J(θ)(K(θ)−1 )T ,

(2.3)

where K(θ) = Eθ (∂s(Y ; θ)/∂θT ) and J(θ) = Eθ (s(Y ; θ)s(Y ; θ)T ) are the sensitivity
and the variability matrices, respectively. The matrix G(θ) = V (θ)−1 is known as the
Godambe information and its form is due to the failure of the information identity
since, in general, K(θ) 6= J(θ).

6

Paolo Girardi et al.

Asymptotic inference on the parameter θ can be based on the Wald-type statistic

wS (θ) = n(θ̃ − θ)T V (θ̃)−1 (θ̃ − θ),

(2.4)

which has an asymptotic chi-square distribution with d degrees of freedom; see Dawid
et al. (2016). In contrast, the asymptotic distribution of the scoring rule ratio statistic
n
o
WS (θ) = 2 S(θ) − S(θ̃) is a linear combination of independent chi-square random
variables with coefficients related to the eigenvalues of the matrix J(θ)K(θ)−1 (Dawid
Pd
2
et al., 2016). More formally, WS (θ) ∼
˙
j=1 µj Zj , with µ1 , . . . , µd eigenvalues of
J(θ)K(θ)−1 and Z1 , . . . , Zd independent standard normal variables. Adjustments of
the scoring rule ratio statistic have received consideration in Dawid et al. (2016),
extending results of Pace et al. (2011) for composite likelihoods. In particular, using
the rescaling factor A(θ) = (s(θ)T J(θ)s(θ))/(s(θ)T K(θ)s(θ)), we have (Dawid et al.,
2016, Theorem 4) WSadj (θ) = A(θ)WS (θ) ∼
˙ χ2d .
A consistent estimate of V (θ) can be obtained by using a parametric bootstrap; see
Varin et al. (2011) for a detailed discussion of the issues related to the estimation
of J(θ) and K(θ). However, for Tsallis score (2.2) the matrices K(θ) and J(θ) can
be derived analitically. Indeed, under the same assumptions of Theorem 3.1 in Gosh
and Basu (2013), it is possibile to show that


ξα ∂µ T ∂µ
 n ∂β ∂β

K(θ) = 

where

∂µ T
∂β

0


0
,
ςα

n
1
= ( ∂µ
, · · · , ∂µ
) is a p × n matrix, with µi = µ(xi , β), i = 1, . . . , n,
∂β
∂β

and ξα and ςα are the same as given in Gosh and Basu (2013) for the linear regression model (see Sect.6), namely ξα = (2π)−α/2 σ −(α+2)/2 (1 + α)−3/2 and ςα =

Robust inference for nonlinear regression models

7

2+α2
1
(2π)−α/2 σ −(α+4)/2 (1+α)
5/2 .
4

Moreover, the computation of J(θ) leads to


ξ2α ∂µ T ∂µ
0
 n ∂β ∂β

J(θ) = 
.
2
α
0
ς2α − 4 ξα

These matrices can then be used in (2.3) to derive the asymptotic distribution of θ̂.
Note that β̂ and σ̂ 2 are asymptotically independent.

2.2

Influence function

From the general theory of M -estimators, the influence function (IF ) of the estimator
θ̃ is given by
IF (y; θ̃) = K(θ)−1 s(y; θ),

(2.5)

and it measures the effect on the estimator θ̃ of an infinitesimal contamination at the
point y, standardised by the mass of the contamination. The estimator θ̃ is B-robust
if and only if s(y; θ) is bounded in y (see Hampel et al., 1986). Note that the IF of the
MLE is proportional to the score function; therefore, in general, MLE has unbounded
IF , i.e. it is not B-robust. Sufficient conditions for the robustness of the Tsallis score
are discussed in Basu et al. (1998) and Dawid et al. (2016).
For the Tsallis score (2.2), straightforward calculation show that the IF for the Tsallis
estimator of the regression coefficients becomes


∂µ(x, β)
(γ − 1)
2
IF (y; β̃) ∝ (y − µ(x, β))
exp −
(y − µ(x, β))
∂β
2σ 2
and that the IF for the Tsallis estimator of the error variance becomes



(γ − 1)
1
(γ − 1)
(γ − 1)
2
2
2
IF (y; σ̃ ) ∝ γ exp −
(y
−
µ(x,
β))
−
(y
−
µ(x,
β))
−
.
√
2σ 2
σ γ−3
2σ γ−5
γσ γ−3
Since the functions s exp{−s2 } and s2 exp{−s2 } are bounded in s ∈ IR, than both
the influence functions IF (y; β̃) and IF (y; σ̃ 2 ) are bounded in y for all γ > 1.

8

Paolo Girardi et al.

3

Application to Covid-19 contagion dynamics in Italy

We illustrate statistical modelling of daily deaths (DD) and cumulative intensive care
unit hospitalizations (ICU) in Italy and in the italian region Lombardia using the
Tsallis scoring rule. Following Dawid et al. (2016), for DD and ICU data the Tsallis
score (2.2) represents a composite scoring rule, based on only marginals. In particular,
it can be interpreted as an independent scoring rule (see also Varin et al., 2011, for
composite likelihoods).
In Italy Covid-19 epidemic reported the presence of first positive cases to swab in
February 20 in well-defined villages of Lombardia and Veneto, immediately followed
by other regions. Note that, due to a large increase of cases, the Italian Government
introduced on March 8 a new law decree with strong restrictions on mobility regarding Lombardia and other provinces. A further decree on March 9 and subsequent
measures protracted restrictions to all regions of Italy until April 13.
We aim to build a data-driven model which can provide support to policy makers
engaged in contrasting the spread of the Covid-19. In particular, we have applied
robust inference for the model (1.1) to the available data, which cover the period from
January 20 to April 4, 2020. The data sources are the daily report of the Protezione
Civile (opendatadpc.maps.arcgis.com/ apps/opsdashboard/index.html).
The reader is also pointed to the work of the StatGroup-19 research group that models
the mean function by using the five parameters Richards curve (Divino et al., 2020).
Here, we consider two independent applications to:

• Daily Deaths (DD) for Covid-19, deaths confirmed by the Istituto Superiore di

Robust inference for nonlinear regression models

9

Sanitá (ISS);
• Cumulative Intensive Care Unit (ICU) hospitalizations with positive Covid-19
swab; this data can be interpreted as a ”department use index”.

Here we model the considered data in two different geographical extensions: Italy and
Lombardia. However, the proposed methodology has been applied to all the italian
regions.
Figures 1–4 present the robust fitted models for, respectively, the daily deaths (DD)
and cumulative intensive care unit hospitalizations (ICU) in Italy and Lombardia. In
each plot, black points are the observed data and red curves are the estimates/forecasts
with our robust nonlinear models. Furthermore, the plots on the left and centre show
the cumulated data and the ones on the right show the daily data (new hospitalizations and new deaths, every day).
We remark that in all the figures the models fit well the observed data. Moreover, it
can be also noted that with respect to the DD the peaks have been reached few day
ago, while for the expected number of daily ICU we are on to the peaks. The peak is
not a single day; it is a stabilization period that can last even several days, before a
stable decrease.

The robust fits (Tsallis estimates and 95% confidence intervals) of the parameters e
(inflection point) and d (upper asymptote) for the models are summarized in Tables
1 and 2 for DD and ICU, respectively. With respect to DD data the estimated

10

Paolo Girardi et al.

Italy

Italy

400

Expected number of daily DD

15000

Cumulative number of DD
Mar 01

Mar 15

Apr 01

0

0

0

5000

200

5000

10000

Cumulative number of DD

10000

600

20000

25000

15000

800

Italy

Mar

Apr

Mag

Giu

Mar

Apr

Mag

Giu

Figure 1: Fitted nonlinear robust models for the daily deaths in Italy.

Italy

Italy

Mar 15

Apr 01

1000
0

0
Mar 01

2000

Expected number of daily ICU

100000

Cumulative number of ICU

50000

40000
0

20000

Cumulative number of ICU

3000

60000

150000

4000

80000

Italy

Mar

Apr

Mag

Giu

Mar

Apr

Mag

Giu

Figure 2: Fitted nonlinear robust models for cumulated intensive care unit hospitalizations
in Italy.

Lombardia

Lombardia

300
200

Expected number of daily deaths

10000
Cumulative number of deaths
Mar 01

Mar 15

Apr 01

0

0

0

100

2000

5000

4000

Cumulative number of deaths

6000

8000

400

15000

Lombardia

Mar

Apr

Mag

Giu

Mar

Apr

Mag

Giu

Figure 3: Fitted nonlinear robust models for the daily deaths in Lombardia.

Robust inference for nonlinear regression models
Lombardia

Lombardia

Expected number of daily ICU

40000

Cumulative number of ICU

15000
0

0

0

5000

20000

500

10000

Cumulative number of ICU

20000

1000

60000

25000

30000

1500

Lombardia

11

Mar 01

Mar 15

Apr 01

Mar

Apr

Mag

Giu

Mar

Apr

Mag

Giu

Figure 4: Fitted nonlinear robust models for cumulated intensive care unit hospitalizations
in Lombardia.

Tsallis estimate e

IC e

Tsallis estimate d

IC d

Italy DD

39.9

(39.0;40.8)

29392

(28530;30881)

Lombardia DD

38.0

(36.8;39.2)

15157

(14141;16173)

Table 1: Robust estimates (and 95% confidence intervals) of the parameters e and d
for the models for daily deaths.

inflection point has been reached in Italy (day 39 corresponds to April 2, 2020) and
in Lombardia. On the contrary, with respect to the cumulated ICU data the inflection
point will be reached from the end of April 2020 (day 61 corresponds to April 24,
2020). Note that the inflection point corresponds to the median of the curves of the
daily data in Figures 1–4, while the peak corresponds to the mode.

Tsallis estimate e

IC e

Tsallis estimate d

IC d

Italy ICU

61.0

(59.9;62.2)

489456

(489336;489575)

Lombardia ICU

74.5

(62.2;84.7)

274213

(263057;285369)

Table 2: Robust estimates (and 95% confidence intervals) of the parameters e and d
for the models for cumulative intensive care unit hospitalizations.

12

Paolo Girardi et al.

MLE

0.0025

estimative density cumulated ICU

0.006

estimative density DD

MLE

Tsallis

0.000

0.0000

0.001

0.0005

0.002

0.0010

0.003

0.0015

0.004

0.0020

0.005

Tsallis

15900

16000

16100

16200

16300

81800

82000

82200

82400

82600

82800

83000

Figure 5: Estimative predictive densities based on the Tsallis and the ML estimators for
DD and cumulated ICU.

3.1

Estimative density and simulation study

In the simplest instance of prediction, the object of inference is a future or a yet
unobserved random variable Z. Let pZ (z; θ) be the density of Z. The basic frequentist
approach to prediction of Z, on the basis of the observed y from Y , consists in using
the estimative predictive density function

pe (z) = pZ (z; θ̂),
obtained by substituting the unknown θ with a consistent estimator of θ, such as
the Tsallis estimator or the MLE. Figure 5 reports the estimative predictive densities based on both the estimators for DD and cumulated ICU. Note the the Tsallis
estimative predictive density is shifted on the right and exhibits a larger variability.
To compare the predictive performances of the Tsallis method with respect to the
MLE, a simulation study has been performed, based on N = 10000 Monte Carlo
replications. Figure 6 reports the boxplots of point estimators of the mean µ(z, β)
for the future observation z based on the predictive density estimated with the MLE
and of the predictive density estimated with the Tsallis scoring rule, both under the

13

23550

20000

22000

23600

24000

23650

26000

23700

28000

23750

Robust inference for nonlinear regression models

mle

tsallis

mle

tsallis

Figure 6: Boxplot of point estimators of the mean µ(z, β) for the future observation z under
the central model (left) and under the contaminated model (right) based on the MLE and
on the Tsallis scoring rule.

central model (left) and under a contaminated model (right).
We note that, under the central model, the two estimators present a similar behaviour.
On the contrary, under the contaminated model, only the Tsallis estimator present
a robust performance. The values of the bias (and sd) are quite similar under the
central model, on the contrary of the contaminated model.

4

Final remarks

To conclude, we believe that our procedure can constitute a useful statistical tool
in modelling Italian Covid-19 contagion data. Indeed, the Tsallis robust procedures
allow us to take into account for the inevitable inaccuracy of the Italian Covid-19 data,
which are often underestimated. And example are those deaths of patients who died
with symptoms compatible with Covid-19 but who have not had a tampon, or what
has been described by many media regarding the growing number of elderly people
who remain in their homes while needing to be hospitalized in intensive care. Thus,

14

Paolo Girardi et al.

for these data robust procedures are particularly useful since the allow us to deal at
the same time with model misspecifications (with respect to the normal assumption,
independence or with respect to homoschedasticicy) and data reliability.
With respect to the italian Covid-19, we are now exploring the Bayesian approach
(see Giummolé et al., 2019), since it allow us to include prior information on the
parameters of the model. Moreover, the plots of the posterior distributions for the
parameters of the model and of the predictive distibutions may be quite useful in
practice.
As a final remarks, since the variables are daily counts we will investigate the use of
the Tsallis scoring rule in the context of nonlinear Poisson regression models.
Updates on the results and on the Italian regions may be found in the web page of
the Robbayes-C19 research group:
https://homes.stat.unipd.it/lauraventura/content/ricerca.

Acknowledgements
This research work was partially supported by University of Padova (BIRD197903)
and by PRIN 2015 (Grant 2015EASZFS003).

References
Basu, A., Harris, I.R., Hjort, N.L., Jones, M.C. (1998). Robust and efficient estimation
by minimising a density power divergence. Biometrika, 85, 549–559.

Robust inference for nonlinear regression models

15

Bates, D.M., Watts, D.G. (2007). Nonlinear regression analysis and its applications.
Wiley, New York.
Dawid, A.P., Musio, M., Ventura, L. (2016). Minimum scoring rule inference. Scand.
J. Statist., 43, 123–138.
Divino, F., Farcomeni, A., Jona Lasinio, G., Lovison, G., Maruotti, A. (2020) available at http://afarcome.altervista.org/growthGLM.pdf
Ghosh, M., Basu, A. (2013). Robust estimation for independent non-homogeneous
observations using density power divergence with applications to linear regression.
Electr. J. Statist., 7, 2420–2456.
Ghosh, M., Basu, A. (2016). Robust Bayes estimation using the density power divergence. Ann. Inst. Stat. Math., 68, 413–437.
Giummolé, F., Mameli, V., Ruli, E., Ventura, L. (2019). Objective Bayesian inference
with proper scoring rules. Test, 28, 728–755.
Huber, P.J., Ronchetti, E.M. (2009). Robust Statistics. Wiley, New York.
Mameli, V., Musio, M., Ventura, L. (2018), Bootstrap adjustments of signed scoring
rule root statistics, Comm. Stat. Simul. Comput., 47, 1204–1215.
Mameli, V., Ventura, L. (2015). Higher-order asymptotics for scoring rules. J. Statist.
Plann. Inf., 165, 13–26.
Ritz, C., Baty, F., Streibig, J.C., Gerhard, D. (2015). Dose-Response Analysis using
R. PLoS ONE 10(12): e0146021.
Tsallis, C. (1988). Possible generalization of Boltzmann-Gibbs statistics. J. Statist.
Physics, 52, 479–487.

16

Paolo Girardi et al.

Varin, C., Reid, N., Firth, D. (2011). An overview of composite likelihood methods.
Statist. Sinica, 21, 5–42.
Ventura, L., Racugno, W. (2016). Pseudo-likelihoods for Bayesian inference. In: Topics on methodological and applied statistical inference, series studies in theoretical
and applied statistics, pp. 205–220. Springer, Berlin.

References

