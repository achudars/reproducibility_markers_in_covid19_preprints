Estimation of temporal covariances in pathogen dynamics using Bayesian
multivariate autoregressive models
Colette Mair1,2* , Sema Nickbakhsh1 , Richard Reeve2 , Jim McMenamin3 , Arlene Reynolds3 , Rory N.
Gunson4 , Pablo R. Murcia1 , Louise Matthews2

arXiv:1611.09063v4 [stat.ME] 13 Apr 2019

1 MRC-University of Glasgow Centre for Virus Research, Institute of Infection, Immunity and
Inflammation, College of Medical, Veterinary and Life Sciences, University of Glasgow, Glasgow, UK.
2 Boyd Orr Centre for Population and Ecosystem Health, Institute of Biodiversity, Animal Health and
Comparative Medicine, College of Medical, Veterinary and Life Sciences, University of Glasgow, Glasgow,
UK.
3 Health Protection Scotland, NHS National Services Scotland, Glasgow, UK.
4 West of Scotland Specialist Virology Centre, NHS Greater Glasgow and Clyde, Glasgow, UK.
* Colette.Mair@glasgow.ac.uk

Abstract
It is well recognised that animal and plant pathogens form complex ecological communities of interacting
organisms within their hosts. Although community ecology approaches have been applied to determine
pathogen interactions at the within-host scale, methodologies enabling robust inference of the
epidemiological impact of pathogen interactions are lacking. Here we developed a novel statistical
framework to identify statistical covariances from the infection time-series of multiple pathogens
simultaneously. Our framework extends Bayesian multivariate disease mapping models to analyse
multivariate time series data by accounting for within- and between-year dependencies in infection risk and
incorporating a between-pathogen covariance matrix which we estimate. Importantly, our approach
accounts for possible confounding drivers of temporal patterns in pathogen infection frequencies, enabling
robust inference of pathogen-pathogen interactions. We illustrate the validity of our statistical framework
using simulated data and applied it to diagnostic data available for five respiratory viruses co-circulating in
a major urban population between 2005 and 2013: adenovirus, human coronavirus, human
metapneumovirus, influenza B virus and respiratory syncytial virus. We found positive and negative
covariances indicative of epidemiological interactions among specific virus pairs. This statistical framework

1

enables a community ecology perspective to be applied to infectious disease epidemiology with important
utility for public health planning and preparedness.

Author summary
Disease-causing microorganisms, including viruses, bacteria, protozoa and fungi form complex ecological
communities within the animals and plants they inhabit. These microorganisms can coexist harmoniously
or even beneficially, or they may competitively interact for host resources. Well-studied examples include
interactions between viruses and bacteria in the gut and respiratory tract of mammals. Whilst previous
experimental and epidemiological studies have revealed that some pathogens do interact within their hosts,
demonstrating their epidemiological significance is challenging. This is in part due to a lack of large-scale
data describing the infection patterns of multiple pathogens within single populations over long time
frames. Methods for evaluating whether infection frequencies of different pathogens fluctuate together or
not over time do not readily adjust for alternate explanations. For example, human pathogens may have
similar or different seasonal patterns depending on the age groups they infect and the weather conditions
they survive in, and not because they are directly or indirectly interacting. We developed a robust
statistical framework that allows pathogen-pathogen interactions to be identified from population scale
diagnostic data. This framework provides new insights into pathogen interactions and will have important
consequences for public health preparedness and the design of effective disease control interventions.

Introduction
Animals and plants are exposed to a diverse community of pathogenic organisms that co-circulate in time
and space. When multiple pathogens infect the same tissue, they effectively share an ecological niche that
provides the opportunity for interspecific interactions [1, 2, 3]. It is known that pathogen interactions may
alter the within-host dynamics of infection with consequences for the population transmission of some
common infections. Interactions among microorganisms include the promoting or inhibiting effects of gut
microbiota on invading pathogenic bacteria in the gastrointestinal tract [4]; the enhanced carriage of
pneumococcal bacteria following influenza infection in the respiratory tract [5]; and immune-driven
enhancement of Zika virus infection following Dengue virus exposure [6]. The complex ecology of pathogen
communities therefore has potentially important implications for the control of infectious diseases and
public health preparedness.

2

While some interactions between pathogens have been suggested by anecdotal epidemiological
observations, statistical support for their occurrence and impact on the pathogen population dynamics is
lacking. This is owing in part to a paucity of appropriate long-term time series data for many disease
systems that describe infection frequencies for multiple pathogens simultaneously. Moreover, although
several statistical methods are available for multivariately analysing health-related time series data
(including cross-correlation, generalized linear models, wavelet decomposition and spectral analyses
[7, 8, 9, 10]) retrospectively inferring non-independent patterns among multiple time series has not been
the primary focus.
Bayesian disease mapping models represent a class of regression model that has received much attention
in recent years for the analysis of spatial distributions of incidence data routinely collected by public health
bodies [11, 12]. These models are typically applied to incidence data to estimate spatial patterns of disease
risk over a geographical region with several models proposed to capture spatial autocorrelations [9] using
conditional autoregressive priors [13, 14]. While extensions to disease mapping models have been made to
include temporal patterns [15, 13] and space-time interactions [16, 17], most disease mapping applications
focus on spatial structures [18] with temporal dependencies in disease incidence often being overlooked
[19, 20]. However, multivariate forms of disease mapping models provide a suitable framework for
estimating temporal dependencies between pathogens as they naturally incorporate a between-disease (or
pathogen) covariance matrix [21].
Modelling multiple pathogens simultaneously allows assessment of specific patterns and
non-independencies of infections risk among different pathogens. By estimating the between-pathogen
covariance matrix, we aimed to develop a statistical tool that readily enables the joint estimation of
pathogen dependencies on the temporal dimension and distinguishes simple correlations from genuine
pathogen-pathogen interactions. To validate this method we used two simulations studies and diagnostic
data on five respiratory viruses (adenovirus [AdV], coronavirus [Cov], human metapneumovirus [MPV],
influenza B virus [IBV] and respiratory syncytial virus [RSV]) from the patient population of a major
urban UK population (Glasgow, United Kingdom) over a period of nine years. We chose this particular
group of pathogens because i) respiratory viruses are obligate intracellular pathogens that have a strong
predilection for the cells of the respiratory tract (i.e. they share the same ecological niche); ii)
contemporary diagnostic tests based on multiplex real-time PCR (qPCR) technology allow the detection of
multiple respiratory viruses; and iii) multiplex qPCR was routinely used to diagnose respiratory viruses in
the patient population of Glasgow from 2005.

3

Materials and methods
Respiratory virus infection time series data
Our dataset derives from clinical samples tested for respiratory viruses by the West of Scotland Specialist
Virology Center (WoSSVC) for Greater Glasgow and Clyde Health Board between January 2005 and
December 2013. Each sample was tested by multiplex real-time RT-PCR and test results (virus positive or
negative) were available for five groups of respiratory viruses: adenovirus [AdV]; coronavirus [CoV]; human
metapneumovirus [MPV]; influenza B virus [IBV]; and respiratory syncytial virus [RSV] [22]. Sampling
date, patient age, patient gender, the sample origin (hospital or general practice submission that we used
as a proxy for infection severity) were recorded. Multiple samples from the same patient received within a
30-day period were aggregated into a single episode of respiratory illness resulting in 28,647 patient
episodes. A patient was considered virus-positive during an episode if at least one clinical sample was
positive during the 30-day window. We refer the reader to Nickbakhsh et al. [23] for a full description of
these data.
Whilst data are available at the individual level, we are predominantly interested in estimating
non-independent patterns in temporal patterns between the five viruses at the population level. Therefore,
for each virus, data were aggregated into monthly infection counts across the time frame of this study.
From the 28,647 patient episodes, 4,759 were positive to at least one virus group and detection was
most common in children aged between 1 and 5 years [23]. Detection of any virus in a given clinical sample
was most common in December and least common in August. We observed differing patterns between the
five viruses (Fig 1, black lines). IBV, RSV and CoV were more prevalent in winter, AdV was generally less
common with a slight increase prevalence in spring and MPV shifts from winter peaks to summer peaks
after 2010 [23].
Relative risks identify time points where observed counts are higher or lower than expected, with
expected counts accounting for expected seasonality and risk factors associated with respiratory infection
[23]. Conventionally, relative risk would measure the risk of infection, if exposed to a risk factor, relative to
the risk if unexposed. In this context, relative risk measures the risk of infection of a virus relative to an
estimated expected risk. Thus the relative risks measure the excess risk of viral infection that cannot be
explained by seasonality or patient demographics. Therefore, by inferring dependencies between viral
species in terms of excess risks, we can directly infer viral interactions. We provide a full description of the
estimated expected risks in the expected count section.

4

2011

2012

2013

2012

2013

2010

2011

2009

2008

2007

2006

2010

2009

2008

Obs
Exp

2005

2013
2013

0
2012

0

2012

39

2011

14

2010

78

2009

27

2008

116

2007

40

2006

IBV

155

2007

MPV
Obs
Exp

2005

Obs
Exp

2005

2013

2012

0
2011

0
2010

18

2009

15

2008

37

2007

30

2006

56

2005

45

54

CoV

74

Obs
Exp

2006

AdV

60

RSV

196

Obs
Exp

147
98
49

2011

2010

2009

2008

2007

2006

2005

0

Figure 1: Observed versus expected counts. Observed (Obs) and expected (Exp) counts of the five
groups of respiratory viruses between 2005 and 2013 (black and grey lines respectively). A full description
of the estimated expected counts is given in the expected count section.

Multivariate Spatio-temporal model
Conditional autoregressive models are extensively used in the analysis of spatial data to model the relative
risk of a virus or more generally a disease [24, 25]. The class of Bayesian model typically used in this
context is given by
Yi |Ei , RRi ∼ Poisson(Ei RRi )
log(RRi ) = α + φi
where Yi , Ei and RRi are the observed count, expected count, derived from available patient demographic
data (refer to expected counts section), and relative risk for some index i (for example, location or time
interval) [14] and φ = {φ1 , . . . , φI } spatial random effects modelled jointly through a conditional
autoregressive (CAR) distribution [26]

φ ∼

MVN(0, (τ (D − λW ))−1 ).

5

Matrix W is a proximity matrix, λ a smoothing parameter, τ a measure of precision and D a diagonal
P
matrix such that Di = i0 Wii0 .
Extending this model to multiple viruses, or more generally multiple pathogens, then
Yiv |Eiv , RRiv ∼ Poisson(Eiv RRiv )
log (RRiv ) = αv + φiv
where Yiv , Eiv and RRiv are the observed count, expected count and relative risk of virus v and αv a virus
specific intercept term. A multivariate CAR (MCAR) distribution can jointly model φ by incorporating a
between virus covariance matrix Λ−1 of dimension V × V (where V is the total number of viruses):

φ

∼ MVN(0, [Ω ⊗ Λ]−1 ).

In this case, Ω = D − λW , φ = {φ.1 , . . . , φ.V } and φ.v = {φ1v , . . . , φIv } [27, 28].
Temporal autocorrelations may be induced in this model, at time point j, through the conditional
expectation of φj |φj−1

φj |φj−1

∼

MVN(sφj−1 , [Ω ⊗ Λ]−1 ).

The parameter s controls the level of temporal autocorrelation such that s = 0 implies no autocorrelation
whereas s = 1 is equivalent to a first order random walk [16]. Typically, where temporal autocorrelations
are modelled through the conditional expectation, spatial autocorrelations are modelled through the
precision matrix [16].

Modelling multivariate time series data
We aim to model monthly time series count data from multiple viruses simultaneously over a nine year
period. We index over monthly time intervals and so monthly autocorrelations are modelled in terms of the
precision matrix and yearly autocorrelations are modelled in terms of the conditional expectation in a
similar fashion to the multivariate spatial-temporal model detailed above. The observed count of virus v in
month m of year t, Ymtv is modelled in terms of the expected count Emtv and relative risk RRmtv :
Ymtv |Emtv , RRmtv ∼ Poisson(Emtv RRmtv )
log(RRmtv ) = αv + φmtv

6

with αv an intercept term specific to virus v and φ.t. = {φ.t1 , . . . , φ.tV } a vector of random effects
modelled conditionally through a MCAR prior

φ.t. |φ.t−1.

∼ MVN(sv φ.t−1. , [Ω ⊗ Λ]−1 ).

This parameterisation of a MCAR model captures both the seasonal trends of each virus via Ω and
long-term temporal trends via s1 , . . . , sV . The conditional expectation of φ.t. depends on the previous year
φ.t−1. , capturing long term temporal tends. By allowing dependencies between neighbouring months, we
account for seasonality in viral infection frequencies.

Inferring viral interactions
We focus primarily on the estimation of covariance matrix Λ−1 in order to infer potential temporal
b −1 are significantly different from zero, we
dependencies. By formally testing which off-diagonal entries of Λ
can explicitly provide statistical support for viral interactions.

MCAR prior specification
The covariance structure of the MCAR distribution used to model random seasonal-temporal effects is the
Kronecker product of precision matrices Ω and Λ.
The between-virus precision matrix Λ accounts for dependencies between viral relative risks in terms of
monthly trends. Wishart priors can be used for unstructured precision matrices such as Λ [29], however,
we employed a modified Cholesky decomposition to estimate covariance matrix Λ−1 :

Λ−1

ΣΓΓT Σ

=

where Σ was a diagonal matrix with elements proportional to viral standard deviations and Γ a lower
triangular matrix relating to viral correlations [30]. This parameterisation ensured the positive-definiteness
of Λ−1 , although we note that other parameterisations are available [31].
Matrix Ω captures seasonal trends in terms of monthly dependencies defined through a proximity
matrix W . We will consider two possible constructions of W .

7

Neighbourhood structure
Assuming neighbouring months are more similar than distance months, W can be defined such that
wij = 1 if months i and j are neighbouring months and wij = 0 if months i and j are not neighbouring
months. In this paper, neighbours were fixed as the previous and subsequent three months. Taking a
neighbourhood approach, we set

Ωneigh

= D − λWneigh

where λ is a smoothing parameter and D a 12 × 12 diagonal matrix with Di =

P

j

wneighij . The total

number of nearest neighbours of month i [27, 32].

Autoregressive structure
Under this construction, W was defined through an autogressive process and the corresponding matrix
denoted by Wauto . We set the ijth entry of Wauto (i =
6 j) to be ρdij with dij the distance between months
i and j and ρ a temporal correlation parameter satisfying ρ < 1. We defined distance as the number of
months between i and j.
Taking an autoregressive approach, we set

Ωauto

with D a diagonal matrix with Di =

P

j

= D − λWauto

wautoij . We note that these formulations can easily be extended

to other MCAR structures [27, 33].

Expected counts
We required expected counts of each virus at each time point in this study. Since individual level data were
available, a series of logistic regressions were used to estimate the probability of testing positive for a virus
at a given time point. For month of the year m, the log odds of virus v, logit(pmv ), was estimated through
fixed effects of age, sex and severity (estimated by hospital or general practice submission) and a yearly
random effect. The standardised probability of virus v in month m, psmv , was estimated as
bsmv
p

=

X Naslt pbmv
aslt
.
Nmv

a,s,l,t

8

where Naslt was the number of people of age a, sex s and infection severity l in year t; pbmvaslt the
estimated probability of a person of age a, sex s with infection severity l in year t testing positive for virus
v in month m; and Nmv the number of swabs tested for virus v in month m. The estimated probabilities
of each virus in each month are therefore standardised for age, sex and severity and account for yearly
differences in circulation.
The expected count for virus v in month m of year t was then

Emtv = Nmtv b
psmv
with Nmtv the number of of swabs tested for virus v in month m in year t.
Full model
Let Ymtv denote the observed count of virus v during the mth month of year t, V the total number of
viruses and T the number of years. We modelled Ymtv in terms of the expected count Emtv and relative
risk RRmtv and used a Cholesky decomposition to estimate covariance matrix Λ−1 [34] (Fig 2).
This model was implemented in jags [35] using the R2jags package [36] in R [37]. All results are
averaged across five independent chains. In each chain, we took 50,000 thinned draws across 500,000
iterations after a burn-in period of 300,000 iterations. Our R code used to model these data and an
example of simulated are available upon request to the first author. We note that the multivariate intrinsic
Gaussian CAR prior distribution is fully specified in GeoBUGS [38]. However, our approach allows for
other parameterisations of the MCAR distribution providing more flexibility in separating monthly and
yearly temporal dependencies.

Simulation Studies
The specific aim of this paper was to estimate the between-virus covariance matrix Λ−1 . We show the
validity of our proposed model (Fig 2) in modelling multivariate time series data through a three-virus
simulation and that this model can accurately and precisely estimate Λ−1 through a five-virus simulation.

Three-virus example
We first present an analysis of simulated data for three viruses; virus 1, virus 2 and virus 3. Seasonal
effects were assigned such that virus 1 peaked in winter, virus 2 peaked in summer and virus 3 had no

9

0, 1

0, 1

0, 1

~

~
~

ρ

~

dij

~

diag (Σ v , Σv , ... , Σ v )
1

=

[W ]ij

v 1 , ..., vV

i > j ϵ 1,…,v
2

V

[ Γv v ]
i

j

D−λ W neigh

=
=

i gh
Ne
e st r
u ctu

Λ =Σ ΓΓT Σ
−1

e
tur
uc
s tr

ssiv

od

e gre

ho
ur

Aut
or

bo

D −λW auto

re

0, 1

v
~

sv ϕ .t-1v

t >1

μ . tv ,[Ω⊗Λ]

=

−1

0, 1000
~

v
~

. tv

exp (α v + ϕmtv )
=

mtv

Emtv RR mtv
~

mtv

Ymtv
Figure 2: Full model. Full model used to estimate pairwise relative risk covariances. The diagram should
be read from the bottom (starting with Ymtv ) to the top. All prior choices have been fully specified.
Numbers in dark blue indicate hyperparameter choices, for instance, mean and variance in the normal
distribution, lower and upper bound in the uniform distributions and shape and rate in the gamma
distribution. Numbers in red indicate all relevant subscripts month m = 1, . . . , 12, year t = 1, . . . , 9
and virus v = 1, . . . , 5. Green areas refer to the neighbourhood structure and maroon areas refer to the
autoregressive structure.
seasonal pattern (Fig 3). Virus 1 and virus 2 were negatively correlated (Λ12 = −0.5) and both viruses
were independent of virus 3 (Λ13 = Λ23 = 0).
The probabilities and expected counts of each virus in each month were estimated using the method
described in Expected counts. Individual level data were simulated in order to reflect the virological
diagnostic data. We simulated 200 samples per month per virus over a four year period. For each sample,
an age, sex and severity were drawn from the observed virological diagnostic data distributions [23].
Regression coefficients used to estimate the probability of each virus were drawn such that βintercept = 0,

10

Standardised Probability
0
0.1
0.2
0.3

1
Effect Size
-0.5
0
0.5

Jan
Feb
Mar
Apr
May
Jun
Jul
Aug
Sep
Oct
Nov
Dec

Jan
Feb
Mar
Apr
May
Jun
Jul
Aug
Sep
Oct
Nov
Dec

-1

(a)
virus 1

(b)

virus 3
80
60
20

Year 4

Year 3

Year 2

Year 1

Year 4

Year 3

Year 2

Year 1

0

20

Year 4

Year 3

Year 2

Year 1

0

20
0

Obs
Exp

40

Count

60

80

Count

40

110

80

140

100

100

virus 2

50

Count

virus 1
virus 2
virus 3

(c)

Figure 3: Three virus simulation. (a) Monthly effect sizes of virus 1, black, virus 2, red, and virus 3,
green. (b) estimated monthly standardised probabilities of virus 1, black, virus 2, red, and virus 3, green.
(c) simulated expected (grey lines) and observed (black lines) counts of virus 1, virus 2 and virus 3 in three
virus simulation.
βage ∼ N (0, 0.1), βgender ∼ N (0, 0.1) and βseverity ∼ N (0, 0.1) and standardised probabilities of each virus
in each month were estimated (example shown in Fig 3). Expected counts were taken as the product of the
standardised probabilities and the number of samples (i.e. 200) (example shown in Fig 3c, grey lines).
Random effects φ were drawn from multivariate normal distributions with yearly smoothing parameters
and monthly smoothing parameter (s1 , s2 , s3 and λ) set at 0.5. Seasonal dependencies were simulated
through neighbourhood matrix Wneigh defined in MCAR prior specification. We set virus specific
intercept terms α1 = α2 = α3 = 0 and calculated the relative risks of each virus at each time point.
Finally, observed counts were taken as the product of relative risks and expected counts (example shown in
Fig 3c, black lines).
We fitted both models (Fig 2, neighbourhood and autoregressive structure) to data simulated only
through the neighbourhood structure and estimated higher posterior density intervals (HPDI) for each
covariance parameter (Λ̂12 ,Λ̂13 and Λ̂23 ). Posterior probabilities were then estimated to assess the

11

Table 1: Type 1 error and power. Higher posterior density intervals for covariance parameters Λ12 ,Λ13
and Λ23 from simulated data estimated under the neighbourhood structure and autoregressive structure
before and after a correction for multiple comparisons (mcc).

Λ̂12
Λ̂13
Λ̂23

Neighbourhood
1 − Pr{0 ∈ HP DI}
0.98 (0.95, 1.00)
0.13 (0.06, 0.20)
0.11 (0.04, 0.16)

1 − Pr{0 ∈ HP DImcc }
0.94 (0.89, 0.99)
0.05 (0.01, 0.09)
0.04 (0.00, 0.08)

Autoregressive
1 − Pr{0 ∈ HP DI}
0.87 (0.81, 0.94)
0.07 (0.02, 0.12)
0.10 (0.04, 0.15)

1 − Pr{0 ∈ HP DImcc }
0.71 (0.62, 0.80)
0.03 (0.00, 0.06)
0.04 (0.001, 0.07)

probability of zero being included in each interval, synonymous to Bayesian p-values defined in terms of
lower tail posterior probabilities [39, 40]. Covariance parameters with a posterior probability less than 0.05
were deemed different from zero [39]. In order to control for multiple comparisons, covariance parameters
with an adjusted probability, controlling the false discovery rate [39, 41], less than 0.05 were deemed
different from zero and used as support for a significant covariance between the corresponding viruses.
Generally, significant negative covariances were estimated between virus 1 and virus 2 and
non-significant covariances between virus 1 and virus 3 and between virus 2 and virus 3 using both the
neighbourhood and autoregressive constructions.
Under the neighbourhood structure, the probability of correctly identifying a non-zero covariance was
0.98 (Table 1, Λ̂12 1 − Pr{0 ∈ HP DI}). However, the probabilities of falsely identifying a non-zero
covariance were 0.13 and 0.1 (Table 1, Λ̂13 and Λ̂23 1 − Pr{0 ∈ HP DI}).
Under the autoregressive structure, the probability of correctly identifying a non-zero covariance was
0.87 (Table 1, Λ̂12 1 − Pr{0 ∈ HP DI}). However, the probabilities of falsely identifying a non-zero
covariance were 0.07 and 0.1 (Table 1, Λ̂13 and Λ̂23 1 − Pr{0 ∈ HP DI}).
Correcting for multiple comparisons (mcc) reduced the probabilities of falsely identifying a non-zero
covariance to 0.05 and 0.04 under the neighbourhood structure and 0.03 and 0.04 under the autoregessive
structure (Table 1, Λ̂13 and Λ̂23 1 − Pr{0 ∈ HP DImcc }).
Power estimates under the neighbourhood structure were reduced to 0.94 and 0.71 under the
autogressive structure (Table 1, Λ̂12 1 − Pr{0 ∈ HP DImcc }). A higher estimated power was expected
under the neighbourhood structure since all data were simulated under the neighbourhood structure.
Reducing the covariance between virus 1 and virus 2 (Λ12 = −0.25) decreased the power from 0.94
(under the neighbourhood structure with the multiple comparisons correction) to 0.64 and a further
reduction to Λ12 = −0.1 reduced the corresponding power to 0.22. Therefore, as expected, this test has
high power to detect strong associations but lacks the ability to detect an association between viruses with
a small dependency.

12

This simulation study illustrates our method can powerfully and accurately estimate the relative risk of
each virus across the time frame of the simulation whilst controlling the familywise error rate and is an
important new tool in modelling multivariate time series data.

Five-virus example
To test the accuracy of the full model in estimating the between virus covariance matrix, we simulated
data from five viruses over a 15 year period (Fig 4) with


Λ

−1

1



 −0.5


=
 0


 0

0

−0.5
1
0
0
0

0

0

0





0 0
0 


1 0
0 
.


0 1 0.5 

0 0.5 1

Since temporal variances within each virus were set to 1 (diagonal entries of Λ ∗ −1), we refer to virus
covariances within this section as correlations. Virus 1 and virus 2 were negatively correlated (such that
when the prevalence of one virus increases, the prevalence of the other decreases), virus 4 and virus 5 were
positively correlated and virus 3 circulated independently.
Data from the first three viruses were simulated under identical conditions to those described in the
three-virus example. Seasonal effects were assigned such that virus 4 and virus 5 peaked in autumn (Fig 4,
observed counts). The probabilities and expected counts of virus 4 and virus 5 in each month were
estimated using the method described in Expected counts. Likewise, regression coefficients were drawn
such that βintercept = 0, βage ∼ N (0, 0.1), βgender ∼ N (0, 0.1) and βseverity ∼ N (0, 0.1) . Random effects
φ were drawn from multivariate normal distributions with yearly smoothing parameters and monthly
smoothing parameter (s1 , s2 , s3 , s4 , s5 and λ) set as 0.5. Seasonal dependencies were simulated through
neighbourhood matrix Wneigh defined in MCAR prior specification. We set virus specific intercept terms
α1 = α2 = α3 = α4 = α5 = 0 and calculated the relative risks of each virus at each time point. Finally,
observed counts were taken as the product of relative risks and expected counts (Fig 4, grey lines).
Using the full model with the neighbourhood construction, we initially estimated Λ−1 using only the
first year of data (Fig 5, Year 1). We then combined the first two years of data to estimated Λ−1 (Fig 5,
Year 2). This process was repeated, adding the current year’s data at each iteration, until all fifteen years
of data were combined to estimate Λ−1 .

13

virus 2

Count

Year 1
Year 2
Year 3
Year 4
Year 5
Year 6
Year 7
Year 8
Year 9
Year 10
Year 11
Year 12
Year 13
Year 14
Year 15

virus 4

Year 1
Year 2
Year 3
Year 4
Year 5
Year 6
Year 7
Year 8
Year 9
Year 10
Year 11
Year 12
Year 13
Year 14
Year 15

Year 1
Year 2
Year 3
Year 4
Year 5
Year 6
Year 7
Year 8
Year 9
Year 10
Year 11
Year 12
Year 13
Year 14
Year 15

0

Count

0

20 40 60 80

virus 3

Count
15 30 45 60 75

Year 1
Year 2
Year 3
Year 4
Year 5
Year 6
Year 7
Year 8
Year 9
Year 10
Year 11
Year 12
Year 13
Year 14
Year 15

0

Count

30 60 90
0

20 40 60 80

virus 1
Obs
Exp

45
30

Year 1
Year 2
Year 3
Year 4
Year 5
Year 6
Year 7
Year 8
Year 9
Year 10
Year 11
Year 12
Year 13
Year 14
Year 15

0

15

Count

60

virus 5

Figure 4: Five virus simulation. Simulated observed (black lines) and expected (grey lines) virus counts
from five viruses over fifteen years.
For each pair of viruses, at each iteration, we assessed deviations of each parameter from zero (Fig 5,
pre-mcc) and applied the multiple comparison correction (Fig 5, post-mcc). Using data from the Year 1,
we estimated non-significant correlation between all pairs of viruses (Fig 5, Year 1). Using data from Year
2 onwards, we found varying degrees of significance in the correlation between virus 1 and virus 2, Λ−1
1,2 ,
−1
virus 2 and virus 4, Λ−1
2,4 , and virus 4 and virus 5, Λ4,5 (Fig 5, Year 2 onwards).

Following the multiple comparison correction, we found significant correlations between virus 1 and
−1
virus 2 (Λ−1
1,2 ), virus 4 and virus 5 (Λ4,5 ) from year 9 onwards (Fig 5, solid navy and green lines) validating

our model for long term time series data. We found no significant correlation between virus 2 and virus 4
from year 9 onwards. We found very similar results using Wauto (results not shown).
This example shows this method can precisely and accurately estimate the between virus covariance
matrix given long term time series data.

14

1

^ −1
Λ
12
^ −1
Λ

pre-mcc
post-mcc

24
−1

^
Λ
45

Correlation Estimate

0.5

0

-0.5

Year 15

Year 14

Year 13

Year 12

Year 11

Year 9

Year 10

Year 8

Year 7

Year 6

Year 5

Year 4

Year 3

Year 2

Year 1

-1

Figure 5: Estimated correlations over 15 years. Estimated correlation parameters significantly
different from zero using data from year 1 through to year 15. Grey dots show point estimates of all
correlation parameters at each time point. Solid vertical lines show parameters significantly different from
zero once multiple comparison correction (mcc) was applied. Dotted vertical lines show parameters only
significantly different from zero before multiple comparison correction (pre-mcc).

Results
Application to virological diagnostic data
We applied our model (Fig 2) to monthly infection count data from five respiratory viruses (AdV, Cov,
MPV, IBV and RSV) across nine years in order to infer interactions between these viruses.
For comparison, we applied the full model assuming all five viruses to be independent by setting
Λ−1 = I5 . Under the neighbourhood structure, we found that allowing dependencies between viruses
(Λ−1 6= I5 ) provided a better fit to these data (DIC=2795.6 compared to DIC=3583.8). However, the
autoregressive structure with Λ−1 6= I5 minimised DIC (DIC=2686.4).
Estimating RR and Λ−1
Expected counts were estimated for each virus as described in Expected counts (Fig 1, grey lines). The
risk of AdV infection remained relatively high between 2005 to 2010 but decreased during the summer and
autumn months of 2011, 2012 and 2013 . We found an increased risk of IBV infection during the autumn
and winter periods of 2005/2006, 2010/2011 and 2012/2013 . During the second half of 2009, we found a
heightened risk of RSV and MPV infections. More generally, the risk of RSV infection peaked during late
summer through to autumn from 2008 onwards whereas the risk of MPV infection shifted from winter,

15

between 2005 and 2008, to summer, from 2011 onwards.
Under the neighbourhood structure, we found a positive covariance between RSV & MPV and negative
covariances between IBV & MPV, Cov & MPV and Adv & IBV (Table 2, Wneigh ) whereas we found
significant covariances between RSV & MPV and a negative covariance between IBV & AdV using the
autoregressive structure (Table 2, Wauto ). Under this construction, we found adjusted p-values for the
covariances between IBV & MPV and Cov & MPV to be 0.075 and 0.073 respectively.
Table 2: Posterior density interval estimates of covariancess between adenovirus [AdV], coronavirus [Cov],
human metapneumovirus [MPV], influenza B virus [IBV] and respiratory syncytial virus [RSV]. Covariances
different from zero after multiple comparison correction are highlighted in bold.

Adv

Cov

MPV
IBV

Cov
MPV
IBV
RSV
MPV
IBV
RSV
IBV
RSV
RSV

Wneigh
(-0.27, 045)
(-0.35, 0.22)
(-0.67, -0.16)
(-0.37, 0.29)
(-0.66, -0.11)
(-0.23, 0.45)
(-0.28, 0.32)
(-0.66 -0.13)
(0.32, 0.71)
(-0.51, 0.05)

Wauto
(-0.31, 0.41)
(-0.35, 0.20)
(-0.68, -0.15)
(-0.32, 0.41)
(-0.66, -0.08)
(-0.18, 0.43)
(-0.32, 0.29)
(-0.64, -0.07)
(0.18, 0.67)
(-0.54, 0.04)

Discussion
Humans, animals and plants are exposed to a plethora of cocirculating pathogens, which creates frequent
opportunity for ecological interactions between them. We adapted Bayesian multivariate disease mapping
methods to provide a powerful statistical tool for inferring pathogen-pathogen interactions from diagnostic
and/or surveillance time series data. Whilst standard multivariate disease mapping frameworks investigate
the joint spatial distribution of multiple diseases coinfecting a population simultaneously, our method
instead analyses the joint temporal distribution of multiple infections. Because multivariate disease
mapping naturally incorporates a between-disease covariance matrix, these methods conveniently lend
themselves to the inference of temporal signatures of pathogen-pathogen interactions when adapted to
analyse temporal dependencies.
By applying our framework to extensive diagnostic data accrued over a nine-year period from a well
defined patient population, our analysis provides evidence of epidemiological interactions among
respiratory viruses. This is particularly important because acute respiratory infections are the most
common cause of illness and mortality and are primarily attributed to a group of viruses that occupy a

16

shared ecological niche in the respiratory tract. Although observational data [42, 43, 44, 45] and univariate
regression models [46, 44, 47, 48] indicate the potential for interactions among these common pathogens,
limited evidence exists of their impact on epidemiological infection dynamics.
A recent study used wavelet decomposition to infer temporal correlations in the time series of a set of
respiratory viruses [?]. However, as those statistical methods do not enable different causal hypotheses to
be tested, the authors were unable to determine whether pathogen-pathogen interactions were the
consequence of cross-immunity or of other drivers of seasonal correlation. Under the autoregressive
structure which provided a better fit to these data, our analysis provides robust evidence of a positive
covariance between RSV and MPV and a negative covariance between IBV and AdV.
In summary, we adapted a multivariate disease mapping framework to retrospectively infer
pathogen-pathogen interactions in a statistically robust fashion. Applying this approach to time series data
of pathogens that co-circulate in a given population will lead to a better understanding of the joint
epidemiological dynamics of diseases. It is anticipated that these inferences will enhance the understanding
of linked pathogen dynamics and inform forecasting of disease incidence and improve public health
preparedness. In addition, they will result in better ways to evaluate the impact of public health
interventions thus aiding the design of measures to control infectious diseases.

Acknowledgments
This work was funded by the Medical Research Council of the United Kingdom (Grant number
MC UU 12014/9). We are grateful for support from National Science Foundation DEB1216040, BBSRC
grants BB/K01126X/1, BB/L004070/1, BB/L018926/1, BB/N013336/1, BB/L004828/1, BB/H009302/1,
BB/H009175/1, the Foods Standards Agency FS101055 and the Scottish Government Rural and
Environment Science and Analytical Services Division, as part of the Centre of Expertise on Animal
Disease Outbreaks (EPIC). We thank Paul Johnson and Theo Pepler for their helpful comments on the
manuscript.

17

Bibliography
1. Telfer S, Lambin X, Birtles R, Beldomenico P, Burthe S, Paterson S, et al. Species interactions in a
parasite community drive infection risk in a wildlife population. Science (New York, NY).
2007;330(6001):243–6.
2. Rynkiewicz EC, Pedersen AB, Fenton A. An ecosystem approach to understanding and managing
within-host parasite community dynamics. Trends in Parasitology. 2015;31(5):212 – 221.
doi:https://doi.org/10.1016/j.pt.2015.02.005.
3. Seabloom EW, Borer ET, Gross K, Kendig AE, Lacroix C, Mitchell CE, et al. The community
ecology of pathogens: coinfection, coexistence and community composition. Ecology
Letters;18(4):401–415. doi:10.1111/ele.12418.
4. Bumler A, Sperandio V. Interactions between the microbiota and pathogenic bacteria in the gut.
Nature. 2016;535(7610):85–93.
5. Mina MJ, Klugman KP. The role of influenza in the severity and transmission of respiratory
bacterial disease. The Lancet Respiratory Medicine. 2014;2(9):750 – 763.
doi:https://doi.org/10.1016/S2213-2600(14)70131-6.
6. Dejnirattisai W, Supasa P, Wongwiwat W, Rouvinski A, Barba-Spaeth G, Duangchinda T, et al.
Dengue virus sero-cross-reactivity drives antibody-dependent enhancement of infection with zika
virus. Nature Immunology. 2016;17(9):1102–8.
7. Dominici F. On the Use of Generalized Additive Models in Time-Series Studies of Air Pollution and
Health. American Journal of Epidemiology. 2002;156:193–203. doi:10.1093/aje/kwf062.
8. Bishop Y. Statistical methods for hazards and health. Environmental Health Perspectives.
1977;20:149–157.

18

9. Pascual M, Rodó X, Ellner SP, Colwell R, Bouma MJ. Cholera Dynamics and El Niño-Southern
Oscillation. Science. 2000;289(5485):1766–1769. doi:10.1126/science.289.5485.1766.
10. Cazelles B, Chavez M, Magny G, Gugan J, Hales S. Time-dependent spectral analysis of
epidemiological time-series with wavelets. Journal of The Royal Society Interface. 2007;4(15):625–36.
11. Lawson A, Lee D, MacNab Y. Editorial. Statistical Methods in Medical Research. 2016;25(4):1079.
12. Lawson A, Williams F. An introductory Guide to Disease Mapping. UK: John Wiley & Sons, Ldt;
2001.
13. Knorr-Held L, Besag J. Modelling risk from a disease in time and space. Statistics in Medicine.
1998;17(18):2045–2060. doi:10.1002/(SICI)1097-0258(19980930)17:18¡2045::AID-SIM943¿3.0.CO;2-P.
14. Lee D. A comparison of conditional autoregressive models used in Bayesian disease mapping. Spatial
and Spatio-temporal Epidemiology. 2011;2(2):79 – 89. doi:https://doi.org/10.1016/j.sste.2011.03.001.
15. Robertson C, Nelson TA, MacNab YC, Lawson AB. Review of methods for spacetime disease
surveillance. Spatial and Spatio-temporal Epidemiology. 2010;1(23):105 – 116.
doi:https://doi.org/10.1016/j.sste.2009.12.001.
16. Rushworth A, Lee D, Mitchell R. A spatio-temporal model for estimating the long-term effects of air
pollution on respiratory hospital admissions in Greater London. Spatial and Spatio-temporal
Epidemiology. 2014;10:29 – 38. doi:https://doi.org/10.1016/j.sste.2014.05.001.
17. Knorr-Held L. Bayesian Modelling of Inseparable Space-Time Variation in Disease Risk. Statistics
in Medicine. 2000;19:2555–2567.
18. Martnez-Beneito MA, Lopez-Quilez A, Botella-Rocamora P. An autoregressive approach to
spatio-temporal disease mapping. Statistics in Medicine. 2008;27(15):2874–2889.
doi:10.1002/sim.3103.
19. Richardson S, Abellan JJ, Best N. Bayesian spatio-temporal analysis of joint patterns of male and
female lung cancer risks in Yorkshire (UK). Statistical Methods in Medical Research.
2006;15(4):385–407. doi:10.1191/0962280206sm458oa.
20. Held L, Paul M. Modeling seasonality in space-time infectious disease surveillance data. Biometrical
Journal. 2012;54(6):824–843. doi:10.1002/bimj.201200037.

19

21. Manda S, Feltbower R, Gilthorpe M. Review and empirical comparison of joint mapping of multiple
diseases. Southern African Journal of Epidemiology and Infection. 2012;27(4):169–182.
doi:10.1080/10158782.2012.11441505.
22. Gunson RN, Collins TC, Carman WF. Real-time RT-PCR detection of 12 respiratory viral
infections in four triplex reactions. Journal of Clinical Virology. 2005;33:341–344.
23. Nickbakhsh S, Thorburn F, Wissmann BV, McMenamin J, Gunson R, Murcia P. Extensive
multiplex PCR diagnostics reveal new insights into the epidemiology of viral respiratory infections.
Epidemiol Infect. 2016;144:2064–2076.
24. Lawson A. Bayesian Disease Mapping Hierarchical Modeling in Spatial Epidemiology. Boca Raton:
Chapman & Hall/CRC; 2009.
25. Oliveira VD. Bayesian analysis of conditional autoregressive models. Ann Inst Stat Math.
2012;64:107–133.
26. Martinez-Beneito MA. A general modelling framework for multivariate disease mapping. Biometrika.
2013;100(3):539. doi:10.1093/biomet/ast023.
27. Jin X, Carlin B, Banerjee S. Generalized Hierarchical Multivariate CAR Models for Areal Data.
Biometrics. 2005;61:950–961.
28. MacNab YC. On Bayesian shared component disease mapping and ecological regression with errors
in covariates. Statistics in Medicine. 2010;29(11):1239–1249. doi:10.1002/sim.3875.
29. MacNab YC. Mapping disability-adjusted life years: a Bayesian hierarchical model framework for
burden of disease and injury assessment. Statistics in Medicine. 2007;26(26):4746–4769.
doi:10.1002/sim.2890.
30. Chen Z, Dunson D. Random Effects Selection in Linear Mixed Models. Biometrics. 2003;59:762–769.
31. Pourahmadi M. Covariance Estimation: The GLM and Regularization Perspectives. Stat Sci.
2011;26:369–387.
32. Wall MM. A close look at the spatial structure implied by the CAR and SAR models. Journal of
Statistical Planning and Inference. 2004;121(2):311–324.
33. MacNab Y. On identification in Bayesian disease mapping and ecological-spatial regression models.
Stat Methods Med Res. 2014;23:134–155.

20

34. Kruschke J. Doing Bayesian Data Analysis. 2nd ed. Amsterdam: Academic Press; 2001.
35. Plummer M. JAGS: A program for analysis of Bayesian graphical models using Gibbs sampling;
2003.
36. Su Y, Yajima M. R2jags: A Package for Running ‘JAGS’ from R; 2015.
37. R Core Team. R: A Language and Environment for Statistical Computing; 2015. Available from:
http://www.R-project.org/.
38. Thomas A, Best N, Lunn D, Arnold R, Spiegelhalter D. GeoBUGS User Manual; 2004.
39. Matz MV, Wright RM, Scott JG. No Control Genes Required: Bayesian Analysis of qRT-PCR Data.
PLOS ONE. 2013;8(8):1–12.
40. Lin Y, Lipsitz S, Sinha D, Gawande AA, Regenbogen SE, Greenberg CC. Using Bayesian p-values in
a 2 × 2 table of matched pairs with incompletely classified data. Journal of the Royal Statistical
Society: Series C (Applied Statistics). 2009;58(2):237–246.
41. Benjamini Y, Hochberg Y. Controlling the false discovery rate: a practical and powerful approach to
multiple testing. J R Stat Soc Series B Stat Methodol. 1995;57:289300.
42. Anestad G. Interference between outbreaks of respiratory syncytial virus and influenza virus
infection. The Lancet. 1982; p. 502.
43. Anestad G, Vainio K, Hungnes O. Interference between outbreaks of epidemic viruses. Scandinavian
Journal of Infectious Diseases. 2007;39:653–654.
44. Casalegno JS, Ottmann M, Duchamp MB, Escuret V, Billaud G, Frober E, et al. Rhinovirus
delayed the circulation of the pandemic influenze A (H1N1) 2009 virus in France. European Journal
of Clinical Microbiology and Infectious Diseases. 2010;16:326–329.
45. van Asten L, Bijkerk P, Fanoy E, van Ginkel A, Suijkerbuijk A, van der Hoek W, et al. Early
occurrence of influenza A epidemics coincided with changes in occurrence of other respiratory virus
infections. Influenza and Other Respiratory Viruses. 2016;10(1):14–26.
46. Greer RM, McErlean P, Arden KE, Faux CE, Nitsche A, Lambert SB, et al. Do rhinoviruses reduce
the probability of viral co-detection during acute respiratory tract infections? Journal of Clinical
Virology. 2009;45(1):10–15.

21

47. Pascalis H, Temmam S, Turpin M. Intense Co-Circulation of Non-Influenza Respiratory Viruses
during the First Wave of Pandemic Influenza pH1N1/2009: A Cohort Study in Reunion Island.
PLoS ONE. 2012;7:e44755.
48. Unkel S, Farrington CP, Garthwaite PH, Robertson C, Andrews N. Statistical methods for the
prospective detection of infectious disease outbreaks: a review. Journal of the Royal Statistical
Society: Series A (Statistics in Society). 2012;175(1):49–82. doi:10.1111/j.1467-985X.2011.00714.x.

22

