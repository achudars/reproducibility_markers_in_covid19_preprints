Beyond just “flattening the curve”: Optimal control of
epidemics with purely non-pharmaceutical interventions
Markus Kantner and Thomas Koprucki

arXiv:2004.09471v3 [q-bio.PE] 14 Jul 2020

July 15, 2020

(First version: April 17, 2020)

Abstract When effective medical treatment and vaccination are not available, nonpharmaceutical interventions such as social distancing, home quarantine and far-reaching
shutdown of public life are the only available strategies to prevent the spread of epidemics.
Based on an extended SEIR (susceptible-exposed-infectious-recovered) model and
continuous-time optimal control theory, we compute the optimal non-pharmaceutical
intervention strategy for the case that a vaccine is never found and complete containment
(eradication of the epidemic) is impossible. In this case, the optimal control must meet
competing requirements: First, the minimization of disease-related deaths, and, second,
the establishment of a sufficient degree of natural immunity at the end of the measures,
in order to exclude a second wave. Moreover, the socio-economic costs of the intervention
shall be kept at a minimum. The numerically computed optimal control strategy is a
single-intervention scenario that goes beyond heuristically motivated interventions and
simple “flattening of the curve”. Careful analysis of the computed control strategy reveals,
however, that the obtained solution is in fact a tightrope walk close to the stability
boundary of the system, where socio-economic costs and the risk of a new outbreak
must be constantly balanced against one another. The model system is calibrated to
reproduce the initial exponential growth phase of the COVID-19 pandemic in Germany.
Keywords Mathematical epidemiology · optimal control · non-pharmaceutical
interventions · reproduction number · dynamical systems · COVID-19 · SARS-CoV2
MSC (2010) 92D30 · 37N25 · 37N40 · 93C10 · 49N90 · 34B15
1 Introduction
Preventing the spread of new diseases, to which there is no immunity in the population,
is a huge problem, since there are often neither vaccines nor other effective medical
treatments available in the early stages. In this case, non-pharmaceutical interventions
(NPIs) such as intensive hand hygiene, home quarantine and measures of social distancing, e.g. closure of schools, universities and shops, prohibition of mass events up to
M. Kantner · T. Koprucki
Weierstrass Institute for Applied Analysis and Stochastics (WIAS)
Mohrenstr. 39, 10117 Berlin, Germany
E-mail: kantner@wias-berlin.de, koprucki@wias-berlin.de

2

M. Kantner and T. Koprucki

curfew and shutdown of entire territories, are the only available measures. The NPIs
are aimed at “flattening the curve”, i.e., a reduction of the transmission rate in order to
break the exponential growth of the epidemic.
In the case of the currently spreading COVID-19 pandemic caused by the new
SARS-CoV2 coronavirus [1, 2], the fundamental concern of the mitigation measures
is not to exceed the available number of intensive care unit (ICU) beds, in particular
for respiratory support or extracorporeal membrane oxygenation, in order to prevent
actually avoidable deaths [3]. Since the outbreak of the epidemic, a large number
of simulation studies have been conducted using mathematical models to assess the
efficacy of different NPIs and to estimate the corresponding demands on the health
care system [4–12]. Moreover, mathematical models are employed to deduce important
epidemiological parameters [13–15] and to evaluate the effect of particular measures
from empirical data [16, 17].
The vast majority of research papers on the control of COVID-19 examines the
impact of rather simple intervention schemes such as bang-bang control or cascaded
on-off (i.e., repeated lockdown and release) strategies [12, 18–20]. Instead, however,
intervention strategies derived from continuous-time optimal control theory [21] following
a variational principle are actually preferable. There is a large number of studies on
the application of optimal control theory following Pontryagin’s maximum principle
[22] in mathematical epidemiology, see Refs. [23–27] and references therein. The by far
largest part of these works deals with optimal control of epidemics through vaccination
and immunization [28–31], medical treatment [32, 33] and combinations thereof [34–
39]. Significantly fewer papers are concerned with the optimal control of transmission
dynamics and the mitigation of epidemics through social distancing measures. The paper
by Behncke [25] studies the optimal control of transmission dynamics via optimally
steered health-promotion campaigns and seems to be one of the first works devoted to
this problem. During the current COVID-19 pandemic, the control of the disease by
NPIs has moved into the focus of attention and a number of recent papers are devoted
to this problem. Djidjou-Demasse et al. [40] investigated the optimal control of the
epidemic via social distancing and lockdown measures until a vaccine becomes available.
They propose to delay the peak of the epidemic by increasingly strict interventions and
finally to relax the measures in such a way that a significant burden on the health care
system only occurs when the availability of a vaccine is already expected. A similar
problem has been considered by Perkins and España [41], who studied the optimal
implementation of NPIs under the assumption that an effective vaccine would become
available in about one year after the outbreak of the epidemic. The paper by Kruse and
Strack [42] is devoted to the analysis of the optimal timing of social distancing measures
under the constraint that the overall (temporal) budget for NPIs is limited. Ketcheson
[43] presented a detailed analysis for optimal transmission control in a SIR (susceptibleinfected-recovered) epidemic model with the aim of achieving a stable equilibrium (“herd
immunity”) within a fixed finite time interval while simultaneously avoiding hospital
overflow. A similar problem (including a simple state-dependent mortality rate) was
studied by Alvarez et al. [44], who focussed on minimizing the lockdown costs and
included further economic aspects such as the assumed value of statistical life. An
extension of the optimal transmission control problem to an age-structured model has
been presented by Bonnans and Gianatti [45], who proposed a different temporal course
of the contact reduction for the high and low risk sub-populations. Köhler et al. [46]
have applied model predictive control to social distancing measures with the objective
of minimizing the fatalities over a fixed period of time of two years. Next to adaptive

Beyond just “flattening the curve”: Optimal control of epidemics ...

3

feedback strategies for iterative loosening of the social distancing policies after an initial
lockdown, the authors also examined the possibility of eradicating the virus. All of these
papers on optimal control deal with deterministic epidemiological models, in particular
the basic SIR model [25, 42–44, 47] or various extended SEIR-type models [40, 41, 46].
We remark that this survey on optimal control of COVID-19 is not exhaustive.
The objective of this paper is the investigation of the optimal control of epidemics
in the (hopefully unlikely) case in which an effective vaccine is impossible or never
found and the epidemic must be controlled with purely non-pharmaceutical measures.
Furthermore, we exclude the possibility of complete containment (“eradication of the
virus”). Then, optimal control must pursue competing objectives: On the one hand, the
number of disease-related deaths shall be minimized by strictly avoiding an overload of
the intensive care treatment capacities. On the other hand, however, sufficient natural
immunity must be established in the population in the long run to prevent a second
outbreak of the epidemic (“herd immunity”). Moreover, the socio-economic costs of
the intervention shall be kept at a minimum. We compute the optimal solution to
this problem by applying Pontryagin’s Maximum Principle to an extended SEIR-type
model tailored to specific aspects of COVID-19. Our main result is the optimal time
course of the mean contact reduction (and the corresponding time-dependent effective
reproduction number) that serves as a guideline on how to optimally enter and finally
exit the lockdown. The corresponding NPI policy is a single-intervention scenario
that can be divided into three distinct phases: (1) a strict initial lockdown, (2) a
long lasting period (“critical period”) during which the number of active cases is kept
approximately constant and (3) a moderate tightening of the measures towards the
end of the intervention. We present a detailed analysis of the numerically computed
result and develop an analytical understanding of its distinct features. Moreover, we
show that our numerically computed optimal control obeys two fundamental stability
criteria, which impose an upper limit on the transmission rate and its rate of change
on the way out of the initial lockdown. The precise structure of the optimal control
(i.e., three phases of the intervention) obtained in this paper differs from the results
described in similar works [42–44]. After the initial submission of this paper, the preprint
by Charpentier et al. [48] appeared, who studied a similar optimization problem on
the basis of an extended SIR-type model with parameters adjusted to the COVID-19
pandemic in France. Their independently obtained results are comparable to those
presented in this paper, which demonstrates the robustness of the obtained optimal
intervention strategy with respect to model and parameter variations.
The mathematical model for the progression of the epidemic and the estimation
of the demand for intensive care resources is described in Sec. 2. The optimal control
problem is derived in Sec. 3 and the results are described in Sec. 4. We close with a
critical discussion of our findings in Sec. 5. The model has been calibrated to reproduce
the exponential growth phase of the COVID-19 pandemic in Germany. Details on the
parameter adjustment are described in the Appendix.

2 Modeling of Disease Spreading and Demand for Intensive Care Units
Mathematical modeling of the spread of epidemics is an indispensable tool to project the
outcome of an epidemic, estimate important epidemiological parameters and to make
predictions for different intervention scenarios. Compartment models [49–51], where the
population is divided into different macroscopic sub-populations, such as susceptible,

4

M. Kantner and T. Koprucki

(a)

(b)

Fig. 1 (a) Schematic illustration of the compartmental epidemic model (1). The function
u (t) describes a modification of the transmission dynamics due to NPIs. (b) State-dependent
mortality rate f as a function of the number of patients in a critical state requiring intensive
care. The mortality rate grows rapidly if the number of critical patients exceeds the number of
available ICUs C0 . Inset: The solid line is the regularized mortality rate (4b) that is used in
the computations throughout the paper.

infectious, recovered etc., are a simple but effective tool to model the progression of
epidemics. In contrast to complex (but more realistic) stochastic agent-based models
[52, 53], deterministic mean-field models are limited to the description of the average
infection dynamics in macroscopic (sub-)populations, but allow for fast parameter scans
and a straightforward application of continuous-time optimal control theory [21].

2.1 Model equations
In this paper, an extended SEIR model, similar to that proposed by Neher et al.
[54, 55], is used to model the spread of an epidemic and to estimate the number of
patients in a critical state that require intensive care. Similar models are described in
Refs. [14, 46, 56]. For the sake of simplicity, vital dynamics (except for disease-related
deaths), seasonality effects [57], dispersion of transmission [58] and any effects caused
by population heterogeneity (different age and risk groups) are neglected. The total
population is divided into distinct compartments: susceptible S, exposed E, infectious
I, hospitalized H (severely ill), critical C, recovered R (i.e., immune) and deceased D.
The model equations read
IS
,
N
IS
Ė = βu (t)
− γl E,
N
I˙ = γl E − γi I,

(1b)

Ḣ = (1 − m) γi I + (1 − f (C/C0 )) γc C − γh H,

(1d)

Ċ = cγh H − γc C,

(1e)

Ṙ = mγi I + (1 − c) γh H,

(1f)

Ḋ = f (C/C0 ) γc C.

(1g)

Ṡ = −βu (t)

(1a)

(1c)

The group of initially healthy and not yet infected (susceptible, S) is vulnerable to
infection through contact with infectious (I), who may transmit the disease to the
susceptible population. The infection probability is determined by the transmission

Beyond just “flattening the curve”: Optimal control of epidemics ...

(b)

1.0
0.8

×10-3

6

0.6

4

0.4

2
0

0.2
0

40

60

ICU
overflow

40 60 80 100

80 100 120 140
time [d]

share of total population

share of total population

(a)

5

March 9

100
10-2
10-4
10-6
10-8

0

20

40
60
time [d]

80

100

Fig. 2 (a) Evolution of the epidemic without interventions (u = 1). The number of available
ICUs was set to C0 = 30 000. The inset shows the overflow in ICU demand, which leads during
a period of about 57 days to an increased mortality rate according to Eq. (4). (b) Same as
in (a) but on a logarithmic scale. The markers indicate the estimated number of cumulative
cases (see Appendix C) and the reported numbers for ICU demand and deaths during the early
phase of the COVID-19 pandemic in Germany. The first disease-related fatalities were reported
on March 9, 2020 (day number 20 in the simulation). Social distancing measures, which came
into force nationwide in mid-March [16], have flattened the initial exponential growth.

rate β, and the share of the susceptible and infectious population on the total (living)
population N = N (t), which is given as
N = S + E + I + H + C + R.

(2)

The newly infected (exposed, E) become infectious themselves only after a latency
period γl−1 (which must not be confused with the incubation time). The infectious
either recover or turn severely ill after an average period γi−1 . Severely ill (H) can
either deteriorate into a critical state (C) or recover after a period γh−1 . The recovered
population (R) is assumed to be immune against new infections. Patients in a critical
state either stabilize to the severely ill state or die from the disease on a time scale γc−1 .
The disease-related deaths reduce the size of the population
Ṅ = −Ḋ,

(3)

such that, assuming initially D (0) = 0, it holds N (t) = N (0) − D (t). Moreover, m is
the share of infectious that are asymptomatic or have at most mild symptoms, c is the
fraction of severely ill that become critical and f is the fraction of critically ill that are
going to die from the disease. Finally, the time-dependent function u (t) describes a
modification of the transmission rate (mean contact reduction) due to NPIs. Here, u = 1
means no intervention, and u = 0 corresponds to the extreme case of total isolation of
the whole population. The model system is illustrated in Fig. 1 (a). A rescaled version
of the dynamical system (1), where the sub-populations are considered in terms of their
relative share of the initial population N (0), is given in Eq. (23) in the Appendix D.

6

M. Kantner and T. Koprucki
symbol
R0
N (0)
γl−1
γi−1
γh−1
γc−1
β
m
c
f
f0
f1
C0
T

value
2.7
83 × 106
2.6 d
2.35 d
4.0 d
7.5 d
(1.15 d)−1
0.92
0.27
see Eq. (4)
0.31
2 f0 = 0.62
variable
10 × Tcrit

description
basic reproduction number
initial population size
average latency time between exposure and infectious period
average infectious period before recovery or hospitalization
average period before severely ill patients turn critical or recover
average period before critical patients recover or die
transmission rate
fraction of infected with at most mild symptoms
fraction of hospitalized patients that turn critical
fraction of critical patients that turn fatal
mortality of a critical patient with ICU
mortality of a critical patient without ICU
number of ICUs/ max. number of simultaneously critical cases
final time of the simulation, for Tcrit see Eq. (17)

Table 1 List of parameters used in the simulations. See Appendix C for details.

2.2 State-dependent fatality rate
The disease-related mortality grows tremendously as soon as the number of critically
ill exceeds the capacity limit C0 of the health care system (number of available ICUs).
This is modeled by a state-dependent average fatality rate


f =f

C
C0

(


=

for C ≤ C0 ,

f0
f1 −

C0
C

(f1 − f0 ) for C > C0 .

(4a)

As long as every critical patient can be served with an ICU (C ≤ C0 ), the fatality rate
is a constant f = f0 . As soon as the ICU resources are exceeded, an increasing fraction
of the critical patients dies with a higher rate f1 > f0 , which on average results in the
state-dependent fatality rate (4a). Here, f1 = 2f0 is assumed. In the following, the
regularization
f (x) → f (x) = f0 +


x + 1.1




x−1
log 1 + exp
(f 1 − f 0 )


(4b)

with 0 <   1, of Eq. (4a) is used, in order to avoid problems due to the nondifferentiability at C = C0 . The function f (C/C0 ) is plotted in Fig. 1 (b).

2.3 Basic and effective reproduction number
The basic reproduction number [59]
R0 = β/γi

(5)

can be thought of as the expected number of cases (without intervention, u = 1) that
is directly generated by one case in a population where all individuals are susceptible
to infection. The effective reproduction number
Reff (t) = R0 u (t) S (t) /N (t)
depends on time and includes the impact of intervention measures.

(6)

Beyond just “flattening the curve”: Optimal control of epidemics ...

0.5
0

1.0

excluded

1.0

(b) 1.5

-1

0.5
0

1

2

3

0

0.005

0.01

excluded

(a) 1.5

0.02

0.94 0.96 0.98 1.0

7

Fig. 3 Plot of the cost functions for (a) minimal intermediate costs and (b) the enforcement of herd immunity at the
end of the intervention for different values of ε. We use the short
notation X = R0 S (T ) /N (T ).
The shaded region corresponds
to unstable terminal states.

2.4 Numerical results for the uncontrolled epidemic (COVID-19 in Germany)
Figure 2 shows the progression of an uncontrolled epidemic starting from an initially
small fraction of exposed population. The initial conditions are listed in Appendix D.
The parameters are adjusted (see Appendix C) to reproduce the initial exponential
growth phase of the COVID-19 disease in Germany (late February – mid March 2020)
and are summarized in Tab. 1. The numerical solution was obtained by a 4th order
Runge–Kutta method. Without intervention, the peak number of simultaneously active
cases is about 23 million and the peak number of patients in a critical state exceeds
the number of ICUs by a factor of about Cmax /C0 ≈ 16.7, see inset of Fig. 2 (a). The
simulated value Cmax ≈ 5.0 × 105 is in very good agreement with the projection by
Khailaie et al. [14]. Due to the increased fatality in the period with ICU overflow, see
Eq. (4), the epidemic terminates with a very high number of deaths D (T ) ≈ 1.0 × 106 ,
which is in line with previous studies [11].

3 Optimal Control
In the scenario outlined in Sec. 1, where an effective vaccine is never found, the optimal
transmission control due to NPIs is required (i) to avoid ICU overflow (more patients
in a critical state than available ICUs) but at the same time (ii) exclude a second wave
of the epidemic after the end of the measures. The optimal solution is computed by
minimizing the index functional
T

Z
J [u] = ϕ (x (T )) +

dt C (u (t))

(7a)

0

where
ϕ (x (T )) = P D (T ) + C

 
1
ε

1 − R0

S (T )
N (T )


(7b)

is the terminal cost function. The first term in Eq. (7b) describes the number of diseaserelated deaths D (T ) at the end of the epidemic, which should be minimized. As the
increment of the disease-related deaths depends on the state-dependent fatality rate,
see Eq. (1g), this condition implies that the ICU capacities must not be exceeded. The
second term in Eq. (7b) controls the size of the of susceptible population S (T ) at the
end of the epidemic. In order to approach a stable, disease-free stationary state (“herd
1
immunity”), the share of susceptibles on the total population must be less than R−
0 at
the end of the intervention, see Appendix A. The term in Eq. (7b) enforces a final state
slightly below the stability boundary (just in the stable regime), where 0 < ε  1 is a

8

M. Kantner and T. Koprucki

small parameter. We use ε = 10−2 in the numerical simulations throughout this paper.
The function
C (x) = x log (x) − x + 1
(8)
is convex on the whole domain x ∈ [0, ∞). It appears also in the last term of Eq. (7a)
as an intermediate cost function, which provides an abstract measure for the total
socio-economic costs caused by the intervention. The term is minimal and zero if no
intervention is applied C (1) = C 0 (1) = 0, see Fig. 3. The advantage of using (8) over the
commonly used quadratic cost functions is that “unphysical” negative values of u are a
priori excluded. The control parameter P balances between the competing objectives of
minimal disease-related deaths (first term), while attaining at the same time a minimum
number of cases to enforce S (T ) slightly below the stability boundary (second term).
Ramping up P puts an increasing emphasis on minimizing the disease-related deaths.
The time interval [0, T ] of the simulation is chosen sufficiently large, such that the
results are practically independent from the chosen final time T , see Tab. 1.
From the augmented index functional [21]
J¯ [u] = ϕ (x (T )) +

Z

T



dt C (u (t)) + λ (t) · (F (x (t) , u (t)) − ẋ (t)) ,

0

where x = (S, E, I, H, C, R, D) is the state vector, ẋ = F (x, u) is the dynamical
system (1) and λ (t) is a vector of time-dependent Lagrange multipliers (also denoted
as co-state variables) λ = (λS , λE , λI , λH , λC , λR , λD ), one obtains the Hamiltonian
function
H (x, u, λ) = C (u) + λ · F (x, u) .
(9)
Following Pontryagin’s maximum principle [21, 22], the optimality condition reads
∂H
=0
∂u


⇔

u = exp β (λS − λE )



IS
.
N

(10)

Finally, the co-state equations and the final time conditions are obtained as
λ̇ (t) = −∇x H,
λ (T ) = ∇ x ϕ (x )| T .

(11)
(12)

Together with the initial conditions x (0), the system (1), (11)–(12) represents a nonlinear
two-point boundary value problem. The full set of equations is given in Appendix D.
Numerical solutions are obtained by using Matlab’s built-in routine bvp4c [60] in
combination with an analytic Jacobian matrix and a step-size adaptive homotopy
method, where the control parameter P is gradually ramped up while always using
the result of the previous step as initialization. The procedure is initiated from the
numerical solution of the initial value problem (1) without interventions, see Fig. 2.

4 Results
4.1 Structure of the optimal intervention strategy
With optimal control of the transmission rate (in the sense of Sec. 3) via accordingly
steered NPIs, the epidemic develops dramatically different from the uncontrolled case.
The whole intervention is shown in Fig. 4 and can be structured into three phases:

Beyond just “flattening the curve”: Optimal control of epidemics ...

(b) 2.75
2.5

1.0
0.8
0.6
0.4

effective reproduction number

share of population/ control

(a)

0.2

0.006
0.004
0.002
0

0

(c)

×10-2
15

100 200 300 400 500 600
time [d]
×10-3
15

10

10

5

5

0

9

0

0.5

1.0

0

1.0
0.9

2.25
2.0

1.75
1.5

0.7
0.6
0.5

0.7
40

1.25
1.0

100 0.4

0.3

0.75
0.5

0.8

1.1
1.0

0

0.2
100 200 300 400 500 600
time [d]
1.0
ICUs on
full load

0.5

0

0.5

1.0

0

0

0.5

1.0

Fig. 4 Optimal transmission control for C0 = 30 000 available ICUs. (a) Temporal evolution
of the optimally controlled epidemic. The susceptible population terminates slightly below the
critical value R−1
0 , which guarantees herd immunity and rules out a second wave of the epidemic.
Moreover, the optimal control ensures that the available number of ICUs is not exceeded by
the critically ill: C (t) < C0 for all t ∈ [0, ∞). A more detailed plot of the ICU load is given
in Fig. 5 (c). (b) Effective reproduction number (6) corresponding to the optimally steered
intervention. The optimal mean contact reduction u (t) is shown for comparison. (c) Comparison
of the trajectories of the uncontrolled (dashed lines) and the optimally controlled epidemic
(solid lines) in different projections of the state space. The arrows indicate the direction of time.
The grey shaded region highlights the critical period.

1. The intervention begins with a strict initial “lockdown” that is built up over a
period of about 25 days (starting around day 25), see Fig. 4 (a, b). The effective
reproduction number (6) must be held below one Reff < 1 for about 13 days, see
Fig. 4 (b) and Fig. 5 (b). This strict initial intervention breaks the early exponential
growth and damps the peak number of infected such that an overshoot of the
critically ill population beyond C0 is just barely avoided, see Fig. 4 (a) and Fig. 5 (c).
2. The initial lockdown is followed by a long period (about 300 days in the case of
C0 = 30 000), which is denoted as the “critical period” in the following, during which
the number of simultaneously active cases is kept approximately constant. This
corresponds to an effective reproduction number Reff ≈ 1, see Fig. 4 (b). During
this phase, the intensive care system is constantly stressed by slightly less than C0
patients in a critical state. This situation must of course be avoided in reality by
all means, in particular, since stochastic fluctuations of the case number are not
included in the deterministic model (1) at all. During this period, the NPIs are
relaxed on a gradually increasing rate, but initially (when the disease is not yet

10

M. Kantner and T. Koprucki

widespread in the population) only very slowly, see Fig. 4 (b). The duration of the
critical period scales with C0−1 . Further details are discussed in Sec. 4.3 below.
3. After the critical period, i.e., when the number of active cases starts to decay, a final
moderate tightening of the measures is required. This is reflected by a notable dip
in the transmission control function and a reduction of the effective reproduction
number below one, see Fig. 4 (b). This final intervention reflects the requirement
to meet the herd immunity threshold towards the end of the intervention. An
unnecessarily wide overshooting into the stable regime would result in additional
infections and deaths, see Sec. 4.4. Finally, the measures are lifted on a gradually
decreasing rate while the system slowly approaches the herd immunity threshold.
Figure 4 (c) shows the trajectories of the controlled and the uncontrolled epidemic
in different state space projections. By controlling the transmission of infection, the
enormous excursion of the trajectory is prevented and the optimal path to a stable
disease-free stationary state is taken. Note that the uncontrolled epidemic terminates
1
far in the stable regime (S (T )/N (T )  R−
0 ), whereas in the optimally controlled case
1
the final state is just slightly below the stability threshold S (T )/N (T ) > R−
0 .
We point out that the optimal transmission control described above differs from the
results obtained for similar optimization problems considered in Refs. [43, 44, 47], which
do not exhibit the distinct structural features of the intervention (initial lockdown,
critical period, final phase intervention) presented here. A comparable result was
described in Ref. [48], where the intervention was divided into four different phases
which essentially coincide with our findings. Merely the lockdown was further subdivided
into a “quick activation of a strong lockdown” and a “light lockdown release.”

4.2 Dependence on the allowed maximum number of simultaneously critical cases
The state-dependent mortality rate (4) effectively imposes a state-constraint that strictly
enforces C < C0 for P → ∞, i.e., a maximum number of simultaneously infected in a
critical condition. In principle, this allows to investigate the optimal control of other (less
extreme) scenarios, where the maximum number of simultaneously critically infected
should be held far below the number of available ICUs (i.e., the meaning of C0 will be
reinterpreted). In this case, the increased mortality rate f1 is an artificial parameter that
penalizes the excess of the critically infected population over a freely chosen threshold
of C0 . By ramping up the control parameter P, an optimal solution with C (t) < C0
for all t ∈ [0, ∞) is found, that is independent of f1 .
Figure 5 shows the optimal control for different values of C0 . The time course of
the optimally controlled transmission rate is qualitatively the same for all considered
values of C0 , see Fig. 5 (a, b). Most notably, the time scale of the entire intervention
scenario is governed by the duration of the critical period, during which the number of
critical patients is held at C > C0 , see Fig. 5 (c). We characterize this time scale by
the full width half maximum (FWHM) time TFWHM = t2 − t1 , where t1 and t2 > t1
are the two points in time at which the number of critically infected equals half the
allowed maximum value: C (t1 ) = C (t2 ) = C0 /2. As shown in Fig. 5 (d), the FWHM
time scales inversely with the peak number of simultaneously infected in a critical state:
TFWHM ∼ C0−1 . The minimization of the disease-related deaths is controlled by the
parameter P in the terminal cost function (7b). Figure 5 (e) displays the progression
of the optimization routine into the targeted optimal state (i.e., without excess of C0 )
while P is ramped up. At a certain value of P, which depends on C0 , the routine reaches

Beyond just “flattening the curve”: Optimal control of epidemics ...

(a)

1.0

(b) 0.6

0.8

0.5

0.6
0.4
see Fig. (b)

0.2
0

2
3
time [years]

4

0.4
0.3
5

6
(d)

50 k

[years]

(c)

1

50 000
40 000
30 000
20 000
10 000

40 k

8

10
12
time [weeks]

3

14

(analytical)

2
1
10 k

30 k
(e)

20 k

20 k

30 k

40 k

50 k
×101
15

×105
8
7

0

total deaths

10 k

0

1

2
3
time [years]

4

5

10

6

5

5
4

103

104
control parameter

105

0

costs of intervention

number of critically ill patients

11

Fig. 5 (a) Optimal time evolution of the transmission control function u (t) for different values
of C0 . The value of C0 is color-coded. In all scenarios, the interventions start with a strict
lockdown, where u (t) is reduced below R−1
for about 10 to 12 days. This initial lockdown is
0
followed by a long “critical period” during which the measures are gradually relaxed. The length
of this period is determined by the peak number of simultaneously critically infected C0 . Towards
the end of the intervention, a moderate tightening of the NPIs is required. (b) Same as (a), but
zoomed on the region with u (t) < R−1
0 . (c) By optimal transmission control, the number of
patients in a critical state C is kept below the limiting value C0 at all times. (d) Characteristic
time span TFWHM of the critical period during which the peak number of simultaneously
infected must be held constant. The dashed line shows the analytical approximation Tcrit given
in Eq. (17). (e) Total number of disease-related deaths (solid lines) and total costs of the
measures (dashed lines) at the end of the epidemic vs. the control parameter P (see Sec. 3).
The optimized transmission function minimizes the number of disease-related deaths to a
C0 -independent value for P → ∞, but to a high cost in the case of low C0 . The squares indicate
the minimal values of P that guarantee C(t) < C0 for all times.

12

M. Kantner and T. Koprucki

a plateau where both the number of disease-related deaths as well as the total costs of
RT
the intervention measures 0 dt C (u (t)) become constant. The corresponding values
of P, which correspond to the scenario that fully avoids excess of critically ill over
C0 , are located on that plateau and are marked by square symbols in Fig. 5 (e). The
optimized transmission function minimizes the number of disease-related deaths to a
C0 -independent value Dmin (T ) for P → ∞, but at total cost that scales with C0−1 . An
analytical estimate of the minimum attainable number of deaths is given in Eq. (18).
Within the present model, further reduction of disease-related deaths below Dmin (T )
can only be achieved by pharmaceutical interventions, in particular by vaccination. The
result of the C0 -independent number of deaths at the end of the epidemic is an artifact
of the simplified modeling framework, in which a homogeneous population with an
averaged set of parameters is considered. Since the mortality rate typically strongly
depends on age and health condition, it might be advisable to extend the model and
divide the compartments into several age or risk groups as in Refs. [11, 45, 54, 61].
The so-extended model features a matrix-valued transmission rate, which describes
the infections caused by contacts within and between different groups, that could be
further optimized by intra- and intergroup-specific measures. This is, however, beyond
the scope of this paper.

4.3 Analysis of the critical period
The numerical results shown in Fig. 4 (a, b) indicate that during the critical period the
populations S, R, and D change approximately linear, while the active cases (E, I, H,
C) are practically constant. To gain further insights, we consider the ansatz (for t > t∗ )
S (t) ≈ N (0) − γS (t − t∗ ),

R (t) ≈ γR (t − t∗ ),

D (t) ≈ γD (t − t∗ ),

where t∗ is a reference time that depends on the initial conditions, γS , γR , γD are
initially unknown rates and the infected sub-populations (E, I, H, C ) ≈ (E ∗ , I ∗ , H ∗ , C0 )
are constant. From substituting the ansatz into the model equations (1), one obtains
by a straightforward calculation analytical expressions for the rates
γS =

1 − c (1 − f0 )
γc C0 ,
(1 − m) c

γR =

1 − c (1 − mf0 )
γc C0 ,
(1 − m) c

γD = f0 γc C0 ,

and the constants
E∗ ≈

1
γl

γS ,

I∗ ≈

1
γi

H∗ ≈

γS ,

1 1
γh cf0

γD .

The rate of new infections per day γS during the critical period depends only on
the parameters of the disease and the maximum capacity C0 . Note that it holds
γS = γR + γD , i.e., the number of active cases remains constant since susceptibles
become infected at the same rate on which active cases either recover or die. The
number of active cases in this dynamical equilibrium is a multiple of C0 :
∗
Nact
= E∗ + I ∗ + H ∗ + C∗ =



1 − c (1 − f0 )
c (1 − m)



1
γl

+

1
γi


γc +

1 γc
c γh


+ 1 C0 .

∗
With the parameters listed in Tab. 1, we find Nact
≈ 28.3 C0 , i.e., one out of about
thirty infections turns critical.

Beyond just “flattening the curve”: Optimal control of epidemics ...

(a) 1.0

Fig. 6 (a) Analysis of the optimal mean contact reduction u (t)
during the critical period, where
the number of simultaneously infected must be kept constant (the
plot is for C0 = 10 000). The numerically exact result is plotted
along with the stability boundary
R−1
0 N (t) /S (t) (blue dashed line)
and the analytical approximation
(13) (red dotted line). The inset
shows that the optimal control respects the stability requirement
(14) during the critical period.
(b) Plot of effective reproduction
number Reff (t) corresponding to
the optimal control. Throughout
the critical period, Reff (t) is kept
slightly below one.

exact

0.8

analytical

0.6
0.4
0.2
(b)

2.5

critical period

2.0
1.5
1.0
0.5

0

200

400

600

13

800 1000 1200 1400 1600

time [d]

Let us now come to the major results of this section. The ansatz stated above yields
an instantaneous relationship between the current value of the transmission control
function and the share of the susceptibles on the total population S (t)/N (t), which is

u (t ) ≈

1 N (t)
1
≈
R0 S (t)
R0


1−

γS
(t − t∗ )
N (0)

 −1


=

R0 − (R0 − 1)

t − t∗
Tcrit

 −1
(13)

for a certain range of t in t∗ < t < Tcrit with Tcrit defined below. Here, we approximated
N (t) ≈ N (0) (since γD  γS ). Note that Eq. (13) implies Reff ≈ 1 during the critical
period. This approximate relation is an interesting result, as it hints that the obtained
optimal control steers the system’s trajectory close to the stability boundary. Comparison
with the stability criterion for the disease-free stationary state R0 < N̄ /S̄, see Eq. (19),
suggests that during the critical period one must make sure that Reff (t) < 1, i.e.,
u (t ) <

1 N (t )
.
R0 S (t)

(14)

This allows to have a stable control of the number of active cases, while the intervention
measures can be gradually relaxed. Stable means that sufficiently small fluctuations
of the number of infected are damped and do not lead to a new exponential outbreak
of the epidemic. Indeed, substituting u (t) = (1 + ε) N (t) /(R0 S (t)) into the model
equations (1) yields a linear, autonomous dynamical system (up to the state-dependent
mortality rate (4)), which is easily seen to evolve close to a stable dynamical equilibrium
for ε < 0 and |ε|  1, see Appendix B. The optimal transmission control function is
shown in Fig. 6 along with the analytical approximation (13), the stability criterion
(14) and the corresponding effective reproduction number for the critical period.
We formulate the stability criterion (14) once again in a different way. Since it
holds S (t) ≈ N (0) − Ncases (t), where Ncases (t) is the cumulative number of cases

14

M. Kantner and T. Koprucki

that includes next to the active cases also the recovered and deceased population
Ncases (t) = Nact (t) + R (t) + D (t), the stability criterion (14) can be written as



1

u (t) <

1−

R0

Ncases (t)
N (0)

−1
.

(15)

Hence, since the optimal control depends solely on the cumulative number of cases,
it is crucial to have an accurate estimate of Ncases at any time during the critical
period. Next, we derive an upper limit for the admissible rate of change of u(t). By
differentiating Eq. (14), using Eq. (1a) and approximating N (t) ≈ N (0) as well as
I (t) ≈ I ∗ (see above), we obtain
u̇ (t) <

1
R0



N (t )
Ḋ (t)
− 2
−
Ṡ (t)
S (t )
S (t )



γ i I (t )
N (t)
u (t)
<
<
S (t)
N (t )



N (t )
R0 S (t)

2

R0 γ S
.
N (0)

Using the approximation (13), the rate on which the measures can be relaxed is limited
by the square of the current value of the control function. It holds
u̇ (t) <

R0 γS 2
u (t ) .
N (0)

(16)

The numerically computed optimal control obeys the criteria (15)–(16), see Fig. 6, and is
therefore (weakly) stable against small perturbations. The merely weak stability reflects
the demand for minimal socio-economic costs, see Sec. 3. The two rules (15)–(16) for the
optimal and stable steering of the transmission control function are widely independent
of the details of the current model system. Equivalent results for a stable dynamical
equilibrium with a constant number of infected cases are easily obtained for the much
simpler SIR model.
The characteristic duration Tcrit of the critical period is estimated from Eq. (13)
and the condition u (t∗ + Tcrit ) ≈ 1. One obtains
Tcrit ≈

N (0)
γS





N (0)
1
1
1−
∝
1−
,
R0

C0

(17)

R0

which is in excellent agreement with the numerically obtained values for the FWHM
time plotted in Fig. 5 (d). Finally, we estimate of the total number of disease-related
deaths from D (T ) ≈ D (t∗ + Tcrit ) ≈ γD Tcrit as
D (T ) ≈ N (0)

γD
γS


1−

1
R0


= N (0)

(1 − m) cf0
1 − c (1 − f0 )


1−

1
R0


,

(18)

which is independent of C0 , cf. Sec. 4.2 and Fig. 5 (e).

4.4 Remarks on the final intervention phase
Finally, we briefly discuss the moderate tightening of the measures in the last (third)
phase of the intervention. To this end, we compare the optimal intervention scenario
with a nearly optimal control, which lacks the last intervention phase as shown in
Fig. 7. In the case of nearly optimal control, the mean contact reduction after the initial
lockdown continuously follows the course of the stability boundary (19), which leads
to an excess of infections beyond the required herd immunity threshold, see Fig. 7 (a).

Beyond just “flattening the curve”: Optimal control of epidemics ...

share of population/ control

(a)

1.0
0.8
0.6
0.4

(b) 3.0

4×10-4

1.5

2×10

optimal
near optimal

2.5
2.0
1.0

-4

0

0

15

100 200 300 400 500 600
time [d]

0.5

0

100 200 300 400 500 600
time [d]

Fig. 7 (a) Comparison of the optimal (dashed) and near optimal (dotted) control of the
mean contact reduction. In the near optimal control, the strengthening of the measures in
the final phase of the intervention is omitted. Instead, the near optimal control adheres to
the stability boundary (19) and causes an overshoot of the susceptible population below the
stability threshold (S (T ) < N (T ) /R0 ), (b) Plot of the corresponding effective reproduction
number.

The final state therefore is considerably further in the stable region than required.
This implies that more infections than necessary are passed through, which results in
exceeding the minimum number of deaths (not shown), cf. Eq. (18). In order to prevent
this, the measures must be slightly tightened towards the end of the intervention such
that the number of active cases is diminished and thus an unnecessary decrease of the
susceptible population below the herd immunity threshold is avoided.

5 Summary and Conclusions
Non-pharmaceutical measures to control the spread of infectious diseases and to prevent
a potential collapse of the health care system must be precisely coordinated in terms
of timing and intensity. Based on well-calibrated mathematical models, the optimal
intervention strategy for specific scenarios and objectives can be computed using
continuous-time optimal control theory.
In this paper, an extended SEIR model was calibrated to reproduce the data of the
initial exponential growth phase of the COVID-19 pandemic in Germany. Optimal control
theory has been applied for the scenario in which an effective vaccine is impossible or
will never be found and the epidemic must be controlled with purely non-pharmaceutical
measures. We have computed the optimal control of the transmission rate that satisfies
competing objectives: First, the minimization of the disease-related deaths by strictly
avoiding an overflow of intensive care resources and, second, the suppression of a
second outbreak by establishing sufficient natural immunity at the end of the measures.
Moreover, the total costs of the intervention shall be kept at a necessary minimum for
socio-economic reasons.
The optimal control obtained in this paper is a single-intervention scenario that
exhibits several notable features, which allow to structure the whole intervention into
three distinct phases: (i) strict initial lockdown, (ii) critical period and (iii) moderate
tightening of measures in the final phase. The obtained control differs from the results
described in related works [43, 44, 47], but is comparable to the NPI strategy presented
in Ref. [48]. We have shown that our optimized time-resolved NPI policy is robust under
parameter variation and developed a qualitative understanding of its distinct phases.

16

M. Kantner and T. Koprucki

The comparison of the computed optimal transmission control function with the
stability criteria (15)–(16) reveals, however, that the obtained solution is in fact a
tightrope walk close to the stability boundary of the system, where socio-economic
costs and the risk of a new outbreak must be constantly balanced against one another.
Furthermore, our analysis clearly shows that the goal of achieving herd immunity via
natural infections is either extremely expensive (in terms of socio-economic costs due
to measures maintained over a long period of time) or extremely dangerous (due to the
constantly high load on intensive care resources just below the stability limit). Note
that the values of C0 considered in the computations are relatively high throughout. In
any case, in view of the long duration and the enormous number of infections that this
route entails, as well as the uncertain role of sequelae and the uncertain prospects for
appropriate vaccines, it is strongly advisable to consider other strategies, in particular
the attempt to reduce the number of cases to a level that is manageable for case tracking
[62] or to eradicate the epidemic completely [63].

Beyond just “flattening the curve”: Optimal control of epidemics ...

0.2

Fig. 8 The stability of the disease-free stationary state depends on the size of the
susceptible population S̄ and the basic reproduction number R0 . For S̄/N < R−1
0 ,
the outbreak of an epidemic is suppressed by
a sufficiently high degree of herd immunity.

eigenvalues

0
-0.2
-0.4

stable

-0.6

17

unstable

-0.8
-1.0

0

0.2

0.4

0.6

0.8

1.0

A Stability Analysis of the Disease-Free Stationary State
Without intervention, i.e. u = 1, the system (1) has a family of disease-free stationary states
x̄ = S̄, 0, 0, 0, 0, R̄, D̄ . The stability of a stationary state with respect to small perturbations
x̄ → x̄ + δx (t) is determined by the sign of the real parts of the eigenvalues η of the linearized
system’s coefficient matrix
0
0

0

A (x̄) =  0

0
0
0


0
−β S̄/N̄
0
0
−γl β S̄/N̄
0
0
γl
−γi
0
0
0 (1 − m) γi
−γh
(1 − f0 ) γc
0
0
cγh
−γc
0
mγi
(1 − c) γh
0
0
0
0
f0 γc

0
0
0
0
0
0
0


0
0

0

0.

0
0
0

with N̄ = S̄ + R̄. From the characteristic polynomial
0 = χ (η) = det (A (x̄) − ηI) ,
one obtains the eigenvalues


q
1
(1)
η± =
− (γi + γl ) ± (γi − γl )2 + 4R0 γi γl S̄/N̄ ,
2


q
1
(2)
− (γc + γh ) ± (γc − γh )2 + 4c (1 − f0 ) γc γh ,
η± =
2
(2)

and the threefold degenerate eigenvalue η (0) = 0. Since c (1 − f0 ) < 1, it holds η± < 0. The
leading eigenvalue is

(1)
η+ ,

which is negative for
S̄/N̄ < R−1
0 ,

(19)

see Fig. 8. Hence, the disease-free stationary state is unstable if the susceptible population
size exceeds a critical threshold value that is given by the inverse basic reproduction number
(5). For S̄/N̄ < R−1
an epidemic outbreak is suppressed by a sufficiently high degree of herd
0
immunity.

B Dynamical Equilibrium and Stability during the Critical Period
For the stability analysis of the dynamical equilibrium during the critical period it is sufficient
to consider the (S, E, I)-block of the system (1), which drives the remaining equations. At first,
Ṡ = −βu (t)

IS
,
N

Ė = βu (t)

IS
− γl E,
N

I˙ = γl E − γi I,

18

M. Kantner and T. Koprucki

is a nonlinear and non-autonomous dynamical system. Substituting the control function
u (t) = (1 + ε)

1 N (t)
,
R0 S (t)

yields a linear and autonomous system
Ṡ = − (1 + ε) γi I,

Ė = (1 + ε) γi I − γl E,

I˙ = γl E − γi I.

For ε = 0, it is easily seen that Ė + I˙ = 0, such that there exists a dynamical equilibrium
with a constant number of actively infected: E ∗ + I ∗ = const., where E ∗ = (1 + γi /γl ) I ∗ . The
corresponding susceptible population is linearly decreasing on a rate γS = γi I ∗ . The stability of
the dynamical equilibrium (E ∗ , I ∗ ) is determined by the roots of the characteristic polynomial
0 = Λ2 + (γl + γi ) Λ − γl γi ε
that are easily obtained as
Λ±

γl + γi
±
=−
2

s

γl + γi
2

2
+ γl γi ε.

Clearly, for ε > 0, the dynamical equilibrium becomes unstable due to Λ+ > 0. The stability
boundary is given by ε = 0, on which the dynamical equilibrium exists. The optimal control
obtained in the main text drives the system slightly below the stability boundary (ε < 0,
|ε|  1), see Fig. 6 (a). In this case it holds Λ± < 0, such that the system is weakly stable
against small perturbations, because the number of active cases is constantly decreasing.

C Parameter Adjustment
The parameters are adjusted such that the model reproduces the data of the early exponential
growth phase of the COVID-19 pandemic in Germany. It is of course questionable to calibrate
an epidemic model to a single country, but in a scenario with extensive border closures this
seems to be justified. In the exponential growth phase of the epidemic, all sub-populations grow
exponentially with the same rate, see Fig. 2 (b). This observation can be exploited to derive a
series of algebraic equations (which hold approximately in the initial phase of the epidemic)
that relate all state variables to each other. On the basis of empirical data (reported number of
cases and deaths etc.), several missing model parameters can be directly determined from the
algebraic relations. The number of reported cases and deaths used in this study is based on the
figures provided by the Robert Koch-Institute [64, 65].
One starts with the ansatz
I (t) ≈ I (0) eΓ t ,

S (t) ≈ N (0)

(20)

where Γ is the initial exponential growth rate that is estimated from reported data (see Fig. 2 (b))
as Γ ≈ 0.26 d−1 (doubling time of infections within Γ −1 log (2) ≈ 2.67 d). Substituting Eq. (20)
in Eqs. (1b)–(1c) yields
1
E (t) ≈
(Γ + γi ) I (t)
γl
and the relation between the growth rate and R0 :



Γ
Γ
1+
= R0 .
(21)
1+
γl
γi
(1)

Note that Eq. (21) is equivalent to the equation for the leading eigenvalue η+ if the whole
(1)
η+ |S̄=N (0)

population is susceptible, i.e. Γ =
(see Appendix A). Hence, Eq. (21) implies
that the exponential growth rate Γ changes sign at R0 = 1, i.e., the epidemic recedes for
R0 < 1. The mean incubation period was reported to be 5.1 d, but there are indications that
the latency time may be shorter [66]. Assuming the onset of infectiousness 2.5 d before the

number per disease-related deaths

Beyond just “flattening the curve”: Optimal control of epidemics ...

104
103
102
101
100

10-1

0

10

20

30 40
time [d]

50

60

19

Fig. 9 Ratio of the state variables in the initial exponential growth phase and the number
of disease related deaths. The numerically exact solution (solid lines) is plotted along with
an analytical approximation (solid lines) that
holds in the early stage of the epidemic. The
corresponding algebraic relations are used to describe ratios between different sub-populations
to facilitate the parameter adjustment. Symbols indicate the reported number of diseaserelated deaths (black), estimated number of
cases (grey) and estimated ICU load (purple)
of the COVID-19 pandemic in Germany. See
the text for details. During mid-March, strict
social distancing measures were implemented,
that flattened the initial exponential growth.

onset of symptoms, this implies an average latency period of γl−1 = 2.6 d, i.e., the latency
period is assumed to equal roughly half of the incubation period. The reported values of the
basic reproduction number R0 are heavily scattered. According to the Robert Koch Institute,
serious estimates range between 2.4 and 3.3 [67]. In the following R0 = 2.7 shall be used,
which is situated approximately in the middle of the interval in question. From Eq. (21), the
corresponding average infectious period is obtained as γi−1 ≈ 2.35 d.
The overall infection fatality rate of COVID-19 was estimated as 0.66 % [68], such that
(1 − m) cf0 = 0.0066. On April 8, the Robert Koch Institute reported that a fraction of f0 = 0.31
patients in a critical state died (without ICU overflow) [69]. Finally, the fraction of infected
with at most mild symptoms is estimated as m = 0.92, such that c = 0.0213/ (1 − m) ≈ 0.266.
Substituting the exponential ansatz (20) in Eqs. (1d)–(1g), yields
(1 − m) γi 
γc 
(1 − m) c γi γh
H (t) ≈
1+
I (t) ,
C (t) ≈
I (t) ,
K
Γ
Γ
K
Γ2


γi
γc 
(1 − m) cf0 γi γc γh
(1 − m) (1 − c) γh 
R (t) ≈
1+
I (t) , D (t) ≈
I (t)
m+
Γ
K
Γ
Γ
K
Γ3
with K = 1 + (γh + γc ) /Γ + γc γh (1 − (1 − f0 ) c) /Γ 2 . The analytically obtained ratio between
all sub-population and deaths (which are believed to be the most reliably reported data)
are plotted along with the corresponding numerically exact result for the initial uncontrolled
epidemic in Fig. 9 (b). The analytical results imply the relation
D (t) /C (t) = γc f0 /Γ.

(22)

Unfortunately, there is only little data available on the demand for ICUs in the early phase
of the epidemic. In mid-March 2020, i.e. near the end of the initial exponential growth phase,
the German Interdisciplinary Association for Intensive Care and Emergency Medicine (DIVI)
initiated a register that reports on the availability of ICUs in Germany [70]. On March 27, 687
out of 1 160 hospitals with ICUs contributed to the register and reported a total number of
939 COVID-19 patients in a critical state receiving intensive care [71]. At the same day, 253
disease-related deaths were reported. From the estimated ratio C/D ≈ 6.3 (the actual number
of critical patients was estimated based on the ratio of contributing and non-contributing
hospitals as C ≈ 1 586), the average period after which patients in a critical state either recover
or die, is estimated from Eq. (22) as γc−1 ≈ 7.5 d.
Finally, assuming that only r = 2/3 of all cases have been discovered initially and an assumed
average time delay between infection and report of cases of ∆tr = 5 d, the number of actual
est (t) = r −1 N rep (t + ∆t ) =
cases is estimated from the number of reported cases as Ncases
r
cases
rep
rep
r−1 eΓ ∆tr Ncases
(t) ≈ 5.5 Ncases
(t). This yields a good agreement between the simulated
est
number of cases (Ncases = E + I + H + C + R + D) and Ncases
before measures came
into force, see Fig. 2 (a) and Fig. 9. The average time between infection and death ∆td can
est (t) /D (t) ≈ 2370 (see Fig. 8 (b)) and N est (t − ∆t ) =
be estimated from the ratio Ncases
d
cases
est (t) e−Γ ∆td = D (t) as ∆t ≈ 29.9 d.
Ncases
d

20

M. Kantner and T. Koprucki

D Two-Point Boundary Value Problem
Rescaling the populations x = (S, E, I, H, C, R, D) subject to the dynamical system (1) by
the initial population size N (0) and using N (t) = N (0) − D (t), see Eq. (3), we obtain the
equations of motion for the rescaled sub-populations x̃ (t) = x (t) /N (0) as
I˜S̃
,
1 − D̃
I˜S̃
Ẽ˙ = βu (t)
− γl Ẽ,
1 − D̃
˜
I˜˙ = γl Ẽ − γi I,


H̃˙ = (1 − m) γi I˜ + 1 − f (C̃/C̃0 ) γc C̃ − γh H̃,

(23b)

C̃˙ = cγh H̃ − γc C̃,

(23e)

R̃˙ = mγi I˜ + (1 − c) γh H̃,

(23f)

˙ = f (C̃/C̃ )γ C̃,
D̃
0 c

(23g)

S̃˙ = −βu (t)

(23a)

(23c)
(23d)

where C̃0 = C0 /N (0). The co-state equations of the optimal control problem considered in
Sec. 3 for the rescaled Lagrange multipliers λ̃ (t) = N (0) λ (t) read
˙
λ̃S (t) = L + β (λ̃S − λ̃E ) u

I˜
1 − D̃

,

˙
λ̃E (t) = L + γl (λ̃E − λ̃I ),
˙
λ̃I (t) = L + β (λ̃S − λ̃E ) u

S̃



+ γi λ̃I − λ̃H + m (λ̃H − λ̃R ) ,

1 − D̃


˙
λ̃H (t) = L + γh λ̃H − λ̃R + c (λ̃R − λ̃C ) ,
!
C̃
C̃ 0
˙
λ̃C (t) = L + γc (λ̃C − λ̃H ) + γc f
+
f
C̃0
C̃0

!!

C̃

(λ̃H − λ̃D ),

C̃0

˙
λ̃R (t) = L,
˙
λ̃D (t) = 0,
with
L=−

u log (u)
1 − D̃

,

u = exp

β (λ̃S − λ̃E )

I˜S̃
1 − D̃

!
.

The initial conditions are taken as
S̃ (0) = 1 − Ẽ (0) ,

Ẽ (0) = 2.41 × 10−7 ,

I˜ (0) = H̃ (0) = C̃ (0) = R̃ (0) = D̃ (0) = 0,

and the final time conditions (12) read
"
#!
1
R0 S̃ (T )
,
1−
ε
1 − D̃ (T )
1 − D̃ (T )
"
#!
1
R0 S̃ (T )
R0
S̃ (T )
1
λ̃E,I,H,C,R (T ) =
1−
log
,
ε 1 − D̃ (T ) 1 − D̃ (T )
ε
1 − D̃ (T )
λ̃S (T ) = −

1
R0
ε 1 − D̃ (T )

1−

S̃ (T )

!

log

λ̃D (T ) = N (0) P.
The choice of the initial time conditions guarantees u (0) = 1 (no intervention) at the beginning
of the scenario.

Beyond just “flattening the curve”: Optimal control of epidemics ...

21

References
1. Zhu, N., Zhang, D., Wang, W., Li, X., Yang, B., Song, J., Zhao, X., Huang, B., Shi, W.,
Lu, R., Niu, P., Zhan, F., Ma, X., Wang, D., Xu, W., Wu, G., Gao, G.F., Tan, W.: A novel
coronavirus from patients with pneumonia in China. N. Engl. J. Med. 382(8), 727–733
(2020). DOI 10.1056/NEJMoa2001017
2. Wu, F., Zhao, S., Yu, B.e.a.: A new coronavirus associated with human respiratory disease
in China. Nature 579, 265–269 (2020). DOI 10.1038/s41586-020-2008-3
3. Phua, J., Weng, L., Ling, L., Egi, M., Lim, C.M., Divatia, J.V., Shrestha, B.R., Arabi,
Y.M., Ng, J., Gomersall, C.D., Nishimura, M., Koh, Y., Du, B.: Intensive care management
of coronavirus disease 2019 (COVID-19): Challenges and recommendations. Lancet Resp.
Med. (2020). DOI 10.1016/s2213-2600(20)30161-2
4. Ferguson, N.M., Laydon, D., Nedjati-Gilani, G.e.a.: Impact of non-pharmaceutical interventions (NPIs) to reduce COVID-19 mortality and healthcare demand. Imperial College
Lond (16-03-2020) (2020). DOI 10.25561/77482
5. Flaxman, S., Mishra, S., Gandy, A., Unwin, H.J.T., Mellan, T.A., Coupland, H., Whittaker,
C., Zhu, H., Berah, T., Eaton, J.W., Monod, M., Imperial College COVID-19 Response
Team, Ghani, A.C., Donnelly, C.A., Riley, S.M., Vollmer, M.A.C., Ferguson, N.M., Okell,
L.C., Bhatt, S.: Estimating the effects of non-pharmaceutical interventions on COVID-19
in Europe. Nature (2020). DOI 10.1038/s41586-020-2405-7
6. Chang, S.L., Harding, N., Zachreson, C., Cliff, O.M., Prokopenko, M.: Modelling transmission and control of the COVID-19 pandemic in Australia. arXiv:2003.10218 (2020)
7. Ng, K.Y., Gui, M.M.: COVID-19: Development of a robust mathematical model and
simulation package with consideration for ageing population and time delay for control
action and resusceptibility. Physica D: Nonlinear Phenomena 411, 132599 (2020). DOI
10.1016/j.physd.2020.132599
8. Bouchnita, A., Jebrane, A.: A hybrid multi-scale model of COVID-19 transmission dynamics
to assess the potential of non-pharmaceutical interventions. Chaos, Solitons & Fractals
138, 109941 (2020). DOI 10.1016/j.chaos.2020.109941
9. Jia, J., Ding, J., Liu, S., Liao, G., Li, J., Duan, B., Wang, G., Zhang, R.: Modeling the
control of COVID-19: Impact of policy interventions and meteorological factors. Electronic
Journal of Differential Equations (23), 1–24 (2020)
10. Kucharski, A.J., Russell, T.W., Diamond, C., Liu, Y., Edmunds, J., Funk, S., Eggo, R.M.,
Sun, F., Jit, M., Munday, J.D., Davies, N., Gimma, A., van Zandvoort, K., Gibbs, H.,
Hellewell, J., Jarvis, C.I., Clifford, S., Quilty, B.J., Bosse, N.I., Abbott, S., Klepac, P.,
Flasche, S.: Early dynamics of transmission and control of COVID-19: A mathematical
modelling study. Lancet Infect. Dis. 20(5), 553–558 (2020). DOI 10.1016/S1473-3099(20)
30144-4
11. Barbarossa, M.V., Fuhrmann, J., Heidecke, J., Vinod Varma, H., Castelletti, N., Meinke,
J.H., Krieg, S., Lippert, T.: A first study on the impact of current and future control
measures on the spread of COVID-19 in Germany. medRxiv (2020). DOI 10.1101/2020.04.
08.20056630
12. Kissler, S.M., Tedijanto, C., Goldstein, E., Grad, Y.H., Lipsitch, M.: Projecting the transmission dynamics of SARS-CoV-2 through the postpandemic period. Science 368(6493),
860–868 (2020). DOI 10.1126/science.abb5793
13. Sesterhenn, J.L.: Adjoint-based data assimilation of an epidemiology model for the Covid-19
pandemic in 2020. arXiv:2003.13071 (2020). DOI 10.5281/zenodo.3732292
14. Khailaie, S., Mitra, T., Bandyopadhyay, A., Schips, M., Mascheroni, P., Vanella, P.,
Lange, B., Binder, S., Meyer-Hermann, M.: Estimate of the development of the epidemic
reproduction number Rt from coronavirus SARS-CoV-2 case data and implications for
political measures based on prognostics. medRxiv (2020). DOI 10.1101/2020.04.04.20053637
15. Engbert, R., Rabe, M.M., Kliegl, R., Reich, S.: Sequential data assimilation of the stochastic
SEIR epidemic model for regional COVID-19 dynamics. medRxiv (2020). DOI 10.1101/
2020.04.13.20063768
16. Dehning, J., Zierenberg, J., Spitzner, F.P., Wibral, M., Neto, J.P., Wilczek, M., Priesemann, V.: Inferring change points in the spread of COVID-19 reveals the effectiveness of
interventions. Science (2020). DOI 10.1126/science.abb9789
17. Brauner, J.M., Mindermann, S., Sharma, M., Stephenson, A.B., Gavenčiak, T., Johnston,
D., Salvatier, J., Leech, G., Besiroglu, T., Altman, G., Ge, H., Mikulik, V., Hartwick, M.,
Teh, Y.W., Chindelevitch, L., Gal, Y., Kulveit, J.: The effectiveness and perceived burden

22

18.

19.
20.

21.
22.
23.
24.
25.
26.

27.
28.
29.
30.

31.
32.
33.
34.

35.
36.
37.
38.

39.

40.

41.
42.

M. Kantner and T. Koprucki
of nonpharmaceutical interventions against COVID-19 transmission: A modelling study
with 41 countries. medRxiv (2020). DOI 10.1101/2020.05.28.20116129
Tsay, C., Lejarza, F., Stadtherr, M.A., Baldea, M.: Modeling, state estimation, and optimal
control for the US COVID-19 outbreak. Sci. Rep. 10, 10711 (2020). DOI 10.1038/
s41598-020-67459-8
Tarrataca, L., Dias, C.M., Haddad, D.B., Arruda, E.F.: Flattening the curves: on-off
lock-down strategies for COVID-19 with an application to Brazil. arXiv:2004.06916 (2020)
Bin, M., Cheung, P., Crisostomi, E., Ferraro, P., Lhachemi, H., Murray-Smith, R., Myant,
C., Parisini, T., Shorten, R., Stein, S., Stone, L.: On fast multi-shot COVID-19 interventions
for post lock-down mitigation. arXiv:2003.09930 (2020)
Lewis, F.L., Vrabie, D., Syrmos, V.L.: Optimal control. John Wiley & Sons (2012).
DOI 10.1002/9781118122631
Pontryagin, L.S., Boltyanskii, V.G., Gamkrelidze, R.V., Mishchenko, E.F.: The Mathematical Theory of Optimal Processes. John Wiley & Sons, New York, London (1962)
Wickwire, K.: Mathematical models for the control of pests and infectious diseases: A
survey. Theor. Popul. Biol. 11(2), 182–238 (1977). DOI 10.1016/0040-5809(77)90025-9
Sharomi, O., Malik, T.: Optimal control in epidemiology. Ann. Oper. Res. 251(1-2), 55–71
(2015). DOI 10.1007/s10479-015-1834-4
Behncke, H.: Optimal control of deterministic epidemics. Optim. Control Appl. Meth.
21(6), 269–285 (2000). DOI 10.1002/oca.678
Nowzari, C., Preciado, V.M., Pappas, G.J.: Analysis and control of epidemics: A survey of
spreading processes on complex networks. IEEE Control Syst. Mag. 36(1), 26–46 (2016).
DOI 10.1109/MCS.2015.2495000
Lenhart, S., Workman, J.T.: Optimal Control Applied to Biological Models. Chapman &
Hall/CRC Press, Boca Raton (2007). DOI 10.1201/9781420011418
Morton, R., Wickwire, K.H.: On the optimal control of a deterministic epidemic. Adv.
Appl. Probab. pp. 622–635 (1974). DOI 10.1017/s0001867800028482
Abakuks, A.: Optimal immunisation policies for epidemics. Adv. Appl. Probab. 6(3),
494–511 (1974). DOI 10.2307/1426230
Zaman, G., Han Kang, Y., Jung, I.H.: Stability analysis and optimal vaccination of an
SIR epidemic model. Biosystems 93(3), 240–249 (2008). DOI https://doi.org/10.1016/j.
biosystems.2008.05.004
Kar, T., Batabyal, A.: Stability analysis and optimal control of an SIR epidemic model with
vaccination. Biosystems 104(2), 127–135 (2011). DOI 10.1016/j.biosystems.2011.02.001
Zaman, G., Kang, Y.H., Jung, I.H.: Optimal treatment of an SIR epidemic model with
time delay. Biosystems 98, 43–50 (2009). DOI 10.1016/j.biosystems.2009.05.006
Liddo, A.D.: Optimal control and treatment of infectious diseases. The case of huge
treatment costs. Mathematics 4(2), 21 (2016). DOI 10.3390/math4020021
Gaff, H., Schaefer, E.: Optimal control applied to vaccination and treatment strategies for
various epidemiological models. Math. Biosci. Eng. 6, 469–492 (2009). DOI 10.3934/mbe.
2009.6.469
Hansen, E., Day, T.: Optimal control of epidemics with limited resources. J. Math. Biol.
62(3), 423–451 (2011). DOI 10.1007/s00285-010-0341-0
Iacoviello, D., Stasio, N.: Optimal control for sirc epidemic outbreak. Comput. Methods
Programs Biomed. 110(3), 333–342 (2013). DOI 10.1016/j.cmpb.2013.01.006
Bolzoni, L., Bonacini, E., Soresina, C., Groppi, M.: Time-optimal control strategies in SIR
epidemic models. Math. Biosci. 292, 86–96 (2017). DOI 10.1016/j.mbs.2017.07.011
Barro, M., Guiro, A., Ouedraogo, D.: Optimal control of a SIR epidemic model with general
incidence function and a time delays. CUBO Mathematical Journal 20(2), 53–66 (2018).
DOI 10.4067/s0719-06462018000200053
Bolzoni, L., Bonacini, E., Della Marca, R., Groppi, M.: Optimal control of epidemic
size and duration with limited resources. Math. Biosci. 315, 108232 (2019). DOI
10.1016/j.mbs.2019.108232
Djidjou-Demasse, R., Michalakis, Y., Choisy, M., Sofonea, M.T., Alizon, S.: Optimal
COVID-19 epidemic control until vaccine deployment. medRxiv (2020). DOI 10.1101/2020.
04.02.20049189
Perkins, T.A., España, G.: Optimal control of the COVID-19 pandemic with nonpharmaceutical interventions. medRxiv (2020). DOI 10.1101/2020.04.22.20076018
Kruse, T., Strack, P.: Optimal control of an epidemic through social distancing. SSRN
Electronic Journal p. 3581295 (2020). DOI 10.2139/ssrn.3581295

Beyond just “flattening the curve”: Optimal control of epidemics ...

23

43. Ketcheson, D.I.: Optimal control of an sir epidemic through finite-time non-pharmaceutical
intervention. arXiv:2004.08848 (2020)
44. Alvarez, F.E., Argente, D., Lippi, F.: A simple planning problem for COVID-19 lockdown.
Tech. rep., National Bureau of Econmic Research, Cambridge, MA (2020). NBER Working
Paper No. 26981
45. Bonnans, J.F., Gianatti, J.: Optimal control techniques based on infection age for the
study of the COVID-19 epidemic. HAL-02558980v2 (2020)
46. Köhler, J., Schwenkel, L., Koch, A., Berberich, J., Pauli, P., Allgöwer, F.: Robust and
optimal predictive control of the COVID-19 outbreak. arXiv:2005.03580 (2020)
47. Miclo, L., Spiro, D., Weibull, J.: Optimal epidemic suppression under an ICU constraint.
arXiv:2005.01327 (2020)
48. Charpentier, A., Elie, R., Laurière, M., Tran, V.C.: COVID-19 pandemic control: balancing
detection policy and lockdown intervention under ICU sustainability. arXiv:2005.06526
(2020)
49. Kermack, W.O., McKendrick, A.G., Walker, G.T.: A contribution to the mathematical
theory of epidemics. Proc. Roy. Soc. Lond. A-CONTA 115(772), 700–721 (1927). DOI
10.1098/rspa.1927.0118
50. Hethcote, H.W.: The mathematics of infectious diseases. SIAM Review 42(4), 599–653
(2000). DOI 10.1137/s0036144500371907
51. Brauer, F.: Compartmental models in epidemiology. In: Mathematical epidemiology, pp.
19–79. Springer (2008). DOI 10.1007/978-3-540-78911-6_2
52. Epstein, J.M.: Modelling to contain pandemics. Nature 460, 687 (2009). DOI 10.1038/
460687a
53. Rahmandad, H., Sterman, J.: Heterogeneity and network structure in the dynamics of
diffusion: Comparing agent-based and differential equation models. Manage. Sci. 54(5),
998–1014 (2008). DOI 10.1287/mnsc.1070.0787
54. Neher, R., Aksamentov, I., Noll, N., Albert, J., Dyrdak, R.: COVID-19 scenarios. Online
(2020). URL https://github.com/neherlab/covid19_scenarios. Accessed on April 16,
2020
55. Noll, N.B., Aksamentov, I., Druelle, V., Badenhorst, A., Ronzani, B., Jefferies, G., Albert,
J., Neher, R.: COVID-19 scenarios: An interactive tool to explore the spread and associated
morbidity and mortality of SARS-CoV-2. medRxiv (2020). DOI 10.1101/2020.05.05.
20091363
56. Wilson, N., Telfar Barnard, L., Kvalsig, A., Verrall, A., Baker, M.G., Schwehm, M.:
Modelling the potential health impact of the COVID-19 pandemic on a hypothetical
European country. medRxiv (2020). DOI 10.1101/2020.03.20.20039776
57. Neher, R.A., Dyrdak, R., Druelle, V., Hodcroft, E.B., Albert, J.: Potential impact of
seasonal forcing on a SARS-CoV-2 pandemic. Swiss Med. Wkly. 150, w20224 (2020).
DOI 10.4414/smw.2020.20224
58. Lloyd-Smith, J.O., Schreiber, S.J., Kopp, P.E., Getz, W.M.: Superspreading and the
effect of individual variation on disease emergence. Nature 438, 355–359 (2005). DOI
10.1038/nature04153
59. Diekmann, O., Heesterbeek, J.A.P., Metz, J.A.J.: On the definition and the computation
of the basic reproduction ratio R0 in models for infectious diseases in heterogeneous
populations. J. Math. Biol. 28, 365–382 (1990). DOI 10.1007/bf00178324
60. Shampine, L.F., Gladwell, I., Shampine, L., Thompson, S.: Solving ODEs with Matlab.
Cambridge University Press (2003). DOI 10.1017/cbo9780511615542
61. Richard, Q., Alizon, S., Choisy, M., Sofonea, M.T., Djidjou-Demasse, R.: Age-structured
non-pharmaceutical interventions for optimal control of COVID-19 epidemic. medRxiv
(2020). DOI 10.1101/2020.06.23.20138099
62. Meyer-Hermann, M., Pigeot, I., Priesemann, V., Schöbel, A.: Adaptive Strategien zur
Eindämmung der COVID-19-Epidemie. Tech. rep. (2020). URL https://www.mpg.de/
14760567/28-04-2020_Stellungnahme_Teil_02.pdf. Accessed on July 13, 2020
63. Wiestler, O.D., Marquardt, W., Heinz, D., Meyer-Hermann, M.: Stellungnahme der
Helmholtz-Initiative "Systemische Epidemiologische Analyse der COVID-19-Epidemie"
(April 13, 2020) (2020). URL https://www.helmholtz.de/fileadmin/user_upload/01_
forschung/Helmholtz-COVID-19-Papier_02.pdf. Accessed on April 17, 2020
64. Robert Koch-Institute: Archiv der Situationsberichte des Robert Koch-Instituts zu
COVID-19. Online (2020). URL https://www.rki.de/DE/Content/InfAZ/N/Neuartiges_
Coronavirus/Situationsberichte/Archiv.html. Accessed on April 15, 2020

24

M. Kantner and T. Koprucki

65. NPGEO Corona : RKI COVID19. Online (2020). URL https://npgeo-corona-npgeo-de.
hub.arcgis.com/datasets/dd4580c810204019a7b8eb3e0b329dd6_0/. Accessed on April 16,
2020
66. Lauer, S.A., Grantz, K.H., Bi, Q., Jones, F.K., Zheng, Q., Meredith, H.R., Azman, A.S.,
Reich, N.G., Lessler, J.: The incubation period of coronavirus disease 2019 (COVID-19)
from publicly reported confirmed cases: Estimation and application. Ann. Intern. Med.
172(9), 577–582 (2020). DOI 10.7326/M20-0504
67. Robert Koch-Institute: SARS-CoV-2 Steckbrief zur Coronavirus-Krankheit-2019 (COVID19).
Online (2020).
URL https://www.rki.de/DE/Content/InfAZ/N/Neuartiges_
Coronavirus/Steckbrief.html. Accessed on April 14, 2020
68. Verity, R., Okell, L.C., Dorigatti, I., Winskill, P., Whittaker, C., Imai, N., CuomoDannenburg, G., Thompson, H., Walker, P.G.T., Fu, H., Dighe, A., Griffin, J.T., Baguelin,
M., Bhatia, S., Boonyasiri, A., Cori, A., Cucunubá, Z., FitzJohn, R., Gaythorpe, K., Green,
W., Hamlet, A., Hinsley, W., Laydon, D., Nedjati-Gilani, G., Riley, S., van Elsland, S., Volz,
E., Wang, H., Wang, Y., Xi, X., Donnelly, C.A., Ghani, A.C., Ferguson, N.M.: Estimates
of the severity of coronavirus disease 2019: A model-based analysis. Lancet Infect. Dis.
20(6), 669–677 (2020). DOI 10.1016/s1473-3099(20)30243-7
69. Robert Koch-Institute: Täglicher Lagebericht des RKI zur Coronavirus-Krankheit-2019
(COVID-19): April 8, 2020. Online (2020). URL https://www.rki.de/DE/Content/InfAZ/
N/Neuartiges_Coronavirus/Situationsberichte/2020-04-08-de.pdf. Accessed on April
14, 2020
70. German Interdisciplinary Society for Intensive Care Medicine (DIVI): DIVI Intensivregister.
URL https://www.divi.de/register/intensivregister
71. Robert Koch-Institute: Täglicher Lagebericht des RKI zur Coronavirus-Krankheit-2019
(COVID-19): March 27, 2020. Online (2020). URL https://www.rki.de/DE/Content/
InfAZ/N/Neuartiges_Coronavirus/Situationsberichte/2020-03-27-de.pdf. Accessed
on April 14, 2020

