Risk Measures Estimation Under Wasserstein
Barycenter
arXiv:2008.05824v1 [stat.AP] 13 Aug 2020

M. ANDREA ARIAS-SERNA
Faculty of Engineering
University of Medellin, Colombia
marias@udem.edu.co

JEAN-MICHEL LOUBES
Toulouse Mathematics Institute
University Paul Sabatier, France
loubes@math.univ-toulouse.fr

FRANCISCO J. CARO-LOPERA
Faculty of Basic Sciences
University of Medellin, Colombia
fjcaro@udem.edu.co

Abstract
Randomness in financial markets requires modern and robust multivariate models of risk measures. This paper proposes a new approach for modeling multivariate
risk measures under Wasserstein barycenters of probability measures supported on
location-scatter families. Simple and advanced copulas multivariate Value at Risk
models are compared with the derived technique. The performance of the model
is also checked in market indices of United States generated by the financial crisis
due to COVID-19. The introduced model behaves satisfactory in both common and
volatile periods of asset prices, providing realistic VaR forecast in this era of social
distancing.
keywords Wasserstein Barycenter; Value at Risk; Conditional Value-at-risk;
Location-scatter family; Transportation Cost.

1

Intoduction

When the well known univariate risk measure analysis is generalized into the multivariate
setting, a number of complex theoretical and applied problems appear. This emerging
theory just extends the univariate case for VaR estimate by using copulas, theory of extreme value, Monte Carlo method, historical simulation, variance and covariance analysis,
1

historical simulation, among many others. However, some of the univariate translations
became unrealistic and are based on inappropriate assumptions. For example, under the
restriction of a perfect dependence, the simple summation method computes the total
risk by summation of the stand alone risks; a preservative method with statical benefit
(see for example, [Embrechts et al. (2013)] and [Li et al. (2015)]). In a similar way, for a
large number of assets, the variance covariance method fails, because the estimation of the
corresponding matrix is extremely cumbersome due to the high amount of correlations,
see [McNeil and Embrechts (2015)].
Now, in the context of risk management, the multivariate theory of the extreme
value (EVT) (see [McNeil (1999)]) and the popular technique of multivariate copulas (see
[Embrechts et al. (2002)]) are useful in some scenarios for VaR estimation in portfolios.
In particular, copulas method attains a robust structure for dependence in financial time
series by producing joint distributions with known non gaussian marginal distributions.
Modelling the marginal distributions via copulas allows VaR computations with a better
performance than the classical methods; but it involves some untractable assumptions
in the context of risk measures which are difficult to elucidate; a similar quotation for
the multivariate extreme value theory are also addressed by [Jin and Lehnert (2018)] and
[Barone et al.(2015)].
Inspired by the above discussions and some interesting insights collected by [Jianping et al. (2012)]
for risk models in banking industry, this work proposes risk measures based on the Wasserstein barycenter. The new method considers a reliable risk measure based on distances
among probabilistic models. The underlying suitable probability laws obey for example, opinions, beliefs and estimates of data sources, in the context of the financial risk.
Explicitly, a far away concept in probability theory is brought into the financial models
by proposing the named Fréchet risk measures; which are calibrated by certain metrization of the probability measure space. In this case, the well studied metric of Wasserstein supports the method and provides fundamental connections for the rising concept of
barycenter in the sense of Agueh and Carlier in [1]. A seminal work for a number of generalizations and applications, see for example, [Bigot et al. (2018)], [Alvarez et al. (2018)],
[Le Gouic and Loubes (2017)] and the references therein. A crucial aspect underlies here
for the new method: the proposed barycenter remains invariant under a class of location
and scatter set of (finite or infinite) set of probabilities.
The Wasserstein metric has enriched notably the risk management literature, see for
example [Kiesel et al. (2016)] and [Feng Yu and Erik Schlogl (2018)]. In particular, as a
canonical metric under well defined assumptions, the named robust risk management has
been studied under the Wasserstein metric. As a consequence, this work represents risk
measures via statistical functionals by hybridizing robustness and continuity under the
Wasserstein metric. Then, several financial applications of the Wasserstein metric can be
obtained in real time series, where the classical methods provide an excellent scenario for
the correctness of the predictions.
The above discussion is organized in this paper as follows: preliminaries about Wasserstein barycenter are given in Section 2, in order to establish the existence and uniqueness
theorem for barycenter of distributions under a class of location and scatter distributions.
Then Section 3 defines the Wasserstein Barycenter in risk measures and results for VaR
and CVaR estimation are given under the addressed family of scale and location distributions. Finally, Section 4 applies the the results in a portfolio consisting of two assets
2

(the Nasdaq and the S&P500 stock indices).

2

Barycenters in the Wasserstein space: General results

This apart provides the necessary background about the barycenter in a Wasserstein
space. First the quadratic transportation cost is presented, in order to introduce the
2-Wasserstein distance. Then, the basic multivariate Value At Risk models are revisited
in terms of the Wasserstein barycenter. Finally, following [Alvarez et al. (2018)] and
[Cédric Villani. (2008)], the fundamental results on Wasserstein barycenters for measures
under a class of scatter and location distributions are provided.
Start with P2 (Rd ) as the set of all probability measures defined on Rd with a finite
second order moment. Denote P2,ac (Rd ) as the subset of absolutely continuous measures
and consider (Ω, σ, P ) as a generic probability space. If µ, ν in P (Rd ), are two measures,
then P(µ, ν) will denote the set of all probability measures π in the product set Rd × Rd .
Here, µ and ν are the corresponding first and second marginals.
Now, for two measures µ, ν in P(Rd ), the quadratic transportation cost between
µ and ν (also referred as the transportation cost with a quadratics cost function) is defined
as follows
Z
T2 (µ, v) = infπ∈P(µ,v)
d(x, y)2dπ(x, y).
R×R

The transportation cost with quadratics cost function endows the set P2 (Rd ) with the
metric called 2-Wasserstein distance or Monge-Kantorovich distance metric, which is
given by
1
W2 (µ, υ) = T2 (µ, ν) 2 .
When d = 1, the 2-Wasserstein distance in the real line is just given by the quantile-like
expression:
Z 1
2
W2 (µ, υ) =
|Fν−1 (x) − Fµ−1 (x)|2 dx,
0

Fν−1

Fµ−1 )

here
and
are the quantile function of ν and µ, respectively.
Now, in the Euclideam space, the barycenter of points x1 , ...xN with weights λ1 , ..., λN , λj ≥
PN
0, j=1 λj = 1, is defined as
b=

N
X

λJ xj .

j=1

In fact, is the unique minimizer
E(y) =

N
X
j=1

λj |xj − y|2

Motivated by the Euclidean version, the Wasserstein barycenter can be defined as
follows.
3

Definition 2.1. Let µ1 , ..., µN P
be random probability measures over Rd , endowed with
d
positive weights λ1 , ...λN , with N
j=1 λj = 1. The measure µ ∈ P2 (R ) is a Wasserstein
barycenter, if µ is a minimizer of the functional
E(µ) =

N
X

λj W22 (µ; µj )

(1)

j=1

This fact will be denoted by µB (λ) ∈ Bar((µj , λj )1≤j≤N )
Definition 2.2. We say that the measure µ ∈ P2 (Rd ) is a Wasserstein barycenter for the
randomPprobability measures µ1 , ..., µN over Rd , endowed with positive weights λ1 , ...λN ,
where N
j=1 λj = 1, if µ is a minimizer of
E(µ) =

N
X

λj W22 (µ; µj )

(2)

j=1

We will write µB (λ) ∈ Bar((µj , λj )1≤j≤N )
Empirical consistency of the Wasserstein barycenter has been studied in [Agueh and Carlier (2011)],
[Boissard et al. (2015)] and [Le Gouic and Loubes (2017)].
For introducing a fundamental result, we recall the definition of a location-scatter
class.
+
Definition 2.3. If Md×d
denotes the set of d × d positive definite matrices and X0 is a
random vector with measure µ0 ∈ P2,ac (Rd ), then the set F(µ0 ) of probability laws defined
by
+
F(µ0 ) := {l(AX0 + m) : A ∈ Md×d
, m ∈ Rd }

is a location-scatter family induced by positive definite affine transformations from µ0 .
The Wasserstein barycenters of measures on a location-scatter family satisfies the
following remarkable property, see [Alvarez et al. (2018)].
Lemma 2.1 (Theorem 3.10., [Alvarez et al. (2018)]). Let µ0 ∈ P2,ac (Rd ), and µ ∈
W2 (P2 (Rd )), assume that for every ω ∈ Ω, the measure µω ∈ F(µ0R). Then the unique
barycenter, µ of µ also belongs to F(µ0 ). The mean of µ̂ is m := mω P (dω), and the
covariance matrix, Σ, is the only positive definite root of the equation
Z
1
1 1
Σ = (Σ 2 Σ1 ωΣ 2 ) 2 P (dω)
This result means that the Wasserstein barycenters are closed respect the locationscatter class.
An interesting case follows for N Gaussian measures on Rd :
Lemma 2.2 (Theorem 2.5., [Alvarez et al. (2018)]). Consider N Gaussian measures
µ1 , ..., µN on Rd with corresponding means m1 , ..., mN P
and positive definite covariances
N
Σ1 , ..., ΣN , and let λ1 , ..., λN be positive weights with
j=1 λj = 1. Then the unique
barycenter of the normal measures µ1 , ..., µN is the Gaussian distribution with mean
4

PN
mλ =
j=1 λj mj and covariance matrix Σ, which is the only positive definite root of
the equation
N
X
1
1 1
Σ=
λi (Σ 2 Σi Σ 2 ) 2
i=1

According to [Alvarez et al. (2018)], Wasserstein barycenters inherits the strong computational problems of the classical optimal transportation. However, in the real line
some explicit distributions can be obtained.

Proposition 2.3. Let F1−1 , ..., FN−1 be the quantile functions corresponding to µ1 , ..., µN
in
PNthe real−1line. Thus the barycenter of µ1 , ..., µN is the probability
PN with quantile function
j=1 λj Fi , where λ1 , ..., λN are positive weights such that
j=1 λj = 1.

Finally, using proposition 2.3, withPN GaussianPdistributions, N(mi , σi2 ), i = 1, ..., k,
N
2
on R, then barycenter is Gaussian N( N
j=1 λj mj , (
j=1 λj σj ) ).
This notable aspect will be used in the context of risk measures.

3

Wasserstein Barycenter Risk Measures

This section proposes the Wasserstein Barycenter Risk Measures at a confidence level
α. The research considers risk measures such as Value
PN at Risk and Conditional Value
+
at Risk for a loss random variable defined by X = i=1 ωi Xi . Here X1 , ..., XN are loss
random
P variables attributed to risk types endowed with positive weights ω1 , ...ωN (such
+
that N
j=1 ωj = 1) and over a fixed time period T. Now, for computation of V aRα (X ),
′
a joint law for the random vector (X1 , ..., XN ) is required. The Wasserstein barycenter
can be regarded as the aggregate model for certain set of probability measures. It is also
suitable for reaching an ”average” distribution. The procedure also considers and optimal
selection for the positive weights. They are connected with the source credibility for every
prior. Moreover, the weights must be chosen equal when all priors remains acceptable.
The equality also holds under unknowing performance reliability of the competing laws.
We are in position for definition of the Wasserstein Barycenter Value-at-Risk.
Definition 3.1. Given the aggregate position X + , a set of measures M = (µ1 , ..., µN ),
a set of weights λ = (λ1 , ..., λN ) ∈ RN −1 and a set of quantiles F = (Fµ−1
, ..., Fµ−1
) with
1
N
α ∈ (0, 1). The Wasserstein Barycenter Value-at-Risk is defined as:
V aRα (X + , λ) = Fµ−1
(α)
B (λ)

(3)

Where Fµ−1
is the quantile function of Wasserstein barycenter µB (λ) of µ1 , ..., µN with
B (λ)
P
weights λ1 , ...λN ∈ R, where λj ≥ 0, 1 ≤ j ≤ N, N
j=1 λj = 1.

3.1

Wasserstein Barycenter risk measures for location and scale
distributions

Next we use the notable property that the barycenter of distributions of location and
scale families belongs to the same class. This allows to derive a closed-form formulas for
5

the Wasserstein Barycenter risk measures for location and scale distributions.
Theorem 3.1. Let µ1 , ..., µN be location and scale measures with corresponding means
m1 , ..., mN and standard deviations σ1 , ..., σN ; then the Wasserstein Barycenter Value-atRisk (V aRα (X + , λ)) is given by
V aRα (X + , λ) = mλ + σλ G−1
Z (α),

(4)

λ
, GZ (.) is the cumulative distribution functions of the standard random
where Z = xq −m
σλ
PN
PN
P
variable, mλ = j=1 λj mj , σλ = N
j=1 λj = 1.
j=1 λj σj , and λj ≥ 0, 1 ≤ j ≤ N,

Proof. It follows straightforwardly from 3.1 and 2.3.

The Wasserstein Barycenter Conditional Value-at-Risk is established next:
Theorem 3.2. Let µ1 , ..., µN be location and scale measures with corresponding means
m1 , ..., mN and standard deviations σ1 , ..., σN , then the Wasserstein Barycenter Conditional Value-at-Risk (T CV aRα (X + , λ)) is given by
+

T CV aRα (X , λ) = mλ +

1
g (G−1
Z (α))
σλ Z

1−α

σλ 2 σZ2 .

(5)

λ
, gZ (.) and GZ (.) are the density and cumulative distribution functions of
where Z = xq −m
σλ
P
PN
the standard random variable, mλ = N
j=1 λj mj , σλ =
j=1 λj σj ,and λj ≥ 0, 1 ≤ j ≤ N,
PN
j=1 λj = 1.

Proof. Note that
1
T CV aRα (X + , λ) =
1−α
and by letting Z =

x−mλ
,
σ

Z

∞

c
x. g
σ
V aRα (X + )

1
2



x − mλ
σλ

2 !

dx

we have

1
T CV aRα (X , λ) =
1−α

Z

∞

1
= mλ + σλ
1−α

Z

∞

+

= mλ +

c(mλ + zσλ )g

Zq

cz.g
Zq

1
g (G−1
Z (α))
σλ Z

1−α






1 2
z dz
2


1 2
z dz
2

σλ 2 σZ2 .

We now illustrate Theorems 3.1 and 3.2 under the Gaussian distribution.

6

Normal Distribution: Let µ1 , ..., µN be Normal measures with corresponding means
m1 , ..., mN and standard deviations σ1 , ..., σN ; then the V aRα (X + , λ) and the T CV aRα (X + , λ)
are given by
V aRα (X + , λ) = mλ + σλ Φ−1 (α),
T CV aRα (X + , λ) = mλ + σλ

φ(Φ−1 (α))
,
1−α

(6)
(7)

−1
here φ stands for the standard Gaussian
distribution
PN
PNand Φ is the inverse of the standard Gaussian distribution, mλ = j=1 λj mj , σλ = j=1 λj σj , and λj ≥ 0, 1 ≤ j ≤ N,
PN
j=1 λj = 1.

4

Empirical Analysis: Portfolio Risk under normal
Model

Randomness in financial markets has promoted important research about robust measures
of market risk. This problem motivates a profuse study about market risk. An issue
involving the risk of loss for an investment under multifactor movements in a market.
Some dynamical risk factors consider the interest and exchange rates, commodity risks
and capital, among others. Thus, this section focus on estimation of the aggregation VaR
for a risk portfolio ruled by Nasdaq and S&P500 stock indices. The Nasdaq log-returns
and the S&P500 log-returns will be denoted as X1 and X2 , respectively. In this case,
the portfolio log-return, X + , has the form X + = λ1 X1 + λ2 X2 . Here λ = (λ1 , λ2 ) and
λ1 and λ2 are the portfolio weighs of the assets 1 and 2, X1 and X2 . Without loss of
generality, a portfolio under equal weights, in both indices, is considered. However, it is
not a strict restriction and they can change freely. Finally, for the marginal returns a
normal distribution is proposed and a one-day period VaR will be considered.

4.1

Results of Wasserstein Barycenter approach

Next, the Wasserstein Barycenter VaR is computed by using 6. In this case, each
stock is ruled by Normal distribution. We follow the 2972 daily closing prices given
by [Landsman et al.(2003)]; a database ranged from January 2nd, 1992 to October 1st,
2003. The dataset is divided into two parts: in sample period and test period. Sample
period starts on January 3rd, 1995 and ends with December 7th, 2000. It consist of 750
daily returns of each stock index and offers the historical information needed for estimating VaR. The test period starts on December 8th, 2000 to December 4th, 2004. VaR
estimate accuracy is measured by using the Kupiec test for backtesting the method in
small quantiles α = 0.1, 0.05, 0.01, 0.005. Software R is used for all computations. Table
1 shows the descriptive statistics of both series.

7

Table 1: Descriptive statistics for log-returns series of daily Nasdaq and S&P500 stock
indices
Statistics
Mean
Mean (annualized)
Standard Deviation
Min.
Median
Max.
Excess of Kurtosis
Asymmetry

Nasdaq
0.00038
10.141%
0.01694
-0.1016800
0.00122
0.13255
4.91481
0.01490

S&P500
0.00030
7.857%
0.01076
-0.0711275
0.00028
0.05574
3.78088
-0.10267

According to Table 1, the return series distributions of Nasdaq and S&P500 have
small asymmetry, but strong kurtosis, in particular the first one. Note also that both
series present positive means (annualized).
Thus, the results of Section 3 can be used for estimation of the the aggregation Valueat-Risk by using the equation
V aRα (X + , λ) = −mλ − σλ Φ−1 (α),

where Φ−1 holds for the inverse of the standard Gaussian
distribution, andPthe mean
P
N
λ
and the standard deviation are computed via mλ = N
j=1 j mj , and σλ =
j=1 λj σj ,
respectively.
The model computation includes both ”unfiltered” and ”filtered” forms. The filtered
model case has also considered the volatility changes of the instrument. Such model will
be referred as Normal*. In the unfiltered Normal VaR (Normal), all the σj ’s, j = 1, , , N
receive the same value of the sample standard deviation. But in the filtered Normal VaR
(Normal*) the σj ’s are
a Exponentially Weighted Moving Average (Ewma)
p estimated with
2
model, where σt = (1 − ζ)x2i + ζσt−1
.
Kupiec test evaluates the performance by computing the exceptions number in the
corresponding test period. In this case, H0 : represents the null hypothesis and 1 − α is
the probability of an exception occurrence. If m is the number of observations for the test
x
period and x denotes the expected frequency of exceptions, then h = m
is the difference
between the observed frequency of losses and VaR. The test statistics,
The corresponding test statistics is given by,

.

LR = −2[ln(px (1 − pm−x )) − ln(hx (1 − h)m−x )] ∼ χ2 (1)

It rejects the null hypothesis, with a 95% confidence level, for LR > χ2 (1). In that
case, the VaR estimations are not statistical meaningful generated by the particular VaR
model, see [McNeil (1999)].

8

The dataset under consideration is now divided into sample and test periods, with
a selected window of 750 observations; and since there are 2971 observations available,
then 2220 VaR tests can be performed at each level can be performed. The corresponding
results are presented in Table 2.
Table 2: Wasserstein Barycenter Value-at-Risk, for t = 751 to 2971, number of exceptions
(in brackets) where the estimated VaR was exceeded by the portfolio loss with α =
0.01, 0.05, 0.01, 0.005. P-values of tests.
Model
Wasserstein Barycenter-N
Number of exceptions
P-Value
VaR Model rejected
Wasserstein Barycenter-N*
Number of exceptions
P-Value
VaR Model rejected

0.1 (222)
0.0489
225
0.8323
No
0.0387
207
0.2837
No

0.05 (111)
0.0442
130
0.0713
No
0.0349
110
0.9223
No

0.01 (22)
0.0312
46
9.1307e-06
Yes
0.0247
23
0.8653
No

0.005 (11)
0.0243
30
2.7020e-06
Yes
0.0192
16
0.1668
No

For all the α levels, the Wasserstein Barycenter-N* model showed the best performance
in the VaR estimation. Moreover, for α = 0.1, 0.05, the Wasserstein Barycenter-N model
also provided a satisfactory behavior. In terms of the Kupiec test, applied to the number
of exceptions for the Wasserstein Barycenter-N * model, the null hypothesis were not
rejected for all the α levels under consideration. In particular, high p values of 0.2837,
0.9223, 0.8653 and 0.1668 were obtained for Wasserstein Barycenter-N * model, and 0.8323
and 0.07130 for the Wasserstein Barycenter-N model at α = 0.1, 0.05 levels.

4.2

Comparisons

According to [Jianping et al. (2012)], most of the banks consider simple methods for
assessing risk. Complex methods involving copulas, simulation, hybrids models and advanced probability theory are implemented by few large banks.
Next apart will provide a summary of the variance-covariance and simple summation
methods. Then a performance comparison with the proposed model is given. At the end,
the new method is also confronted with the sophisticated hybrid copulas methodology
given by [Landsman et al.(2003)].
4.2.1

Basic Multivariate VaR Models

In the referred context of [Jianping et al. (2012)], a research by the IFRI and CRO Forum’s24 showed that 60% or more of the studied banks consider simple approaches as
the var-cov method in order to aggregate risk. And at least a little more advanced approaches (such as the supported methods by simulation) were used by only 20% or less of
the financial institutions in the survey. In fact, the summation setting prevails in most of
9

the banks, a general model including variance-covariance method and simple summation.
In the latest case the risks can be seen as explicitly weighted, meanwhile for the simple
integration, the risks appear implicitly weighted.
This section computes the total VaR aggregated under several methods and different
confidence levels. For correctness of our results different performances with published
results were studied. The methodology starts with a series of univariate portfolio returns;
then by the use of simple sum and variance-covariance methods, the aggregate VaR is
estimated. These results are briefly described in the next lines.
Simple Summation method: The integration of N risks is intuitively reached by
aggregating the risks under summation of the particular V aRα (Xi ) of each risk Xi , i =
1, . . . , N. Then the total aggregated VaR, V aRα (X + ), is expressed as:
+

V aRα (X ) = −

N
X

V aRα (Xi ),

(8)

i=1

see [Embrechts et al. (2013)] and [Li et al. (2015)].
Now, as usual, the Gaussian model supports several methods in probability and statistics studies. In particular, the VaR of multivariate Gaussian laws are a common parametric method for multivariate VaR models. The technique supposes a multivariate Gaussian
distribution (with mean µ and covariance Σ ) for the returns of the components in the
portfolio. The method is characterized as follows:
√
Variance-Covariance method: If σ+ = λΣλ′ . and µ+ = λµ are respectively the
deviation and expected portfolio return, then, the estimation of the Value at Risk for the
corresponding multivariate Gaussian distribution returns is given by

−1

V aRα (X + ) = −µ+ − σ+ Φ−1 (α),

(9)

as before, Φ represents the inverse of the standard Gaussian distribution.
The covariance matrix and the mean vector in the Var-Cov approach are frequently
unknown, then the model requires extra estimates taken from the current observations,
see [Jianping et al. (2012)] and [Li et al. (2015)].
Table 3: Value-at-Risk for t = 751 to 2971, number of exceptions (in brackets) where the
estimated VaR was exceeded by the portfolio loss with α = 0.01, 0.05, 0.01, 0.005.
Model
Simple summation
Wasserstein Barycenter-N*
Wasserstein Barycenter-N
Var-Covar

0.1 (222)
0.0978 (30)
0.0387 (207)
0.04891 (225)
0.0477 (248)

A summary of the results are given next:

10

0.05 (111)
0.0884 (14)
0.0349 (110)
0.0442 (130)
0.0430 (145)

0.01 (22)
0.0625 (4)
0.0247 (23)
0.03123 (46)
0.0304 (52)

0.005 (11)
0.0487(3)
0.0192 (16)
0.0243 (30)
0.0237(38)

• According Kupiec test, the basic multivariate VaR approaches does not predict
future losses properly. Exception number in the test period is small under the
Simple Summation; a fact explaining future loss overestimation. In contrast, the
exception number under the variance-covariance method is large; promoting an
underestimation of the future losses.
• The Wasserstein Barycenter-N* and Wasserstein Barycenter-N model exhibits a remarkable performance for future losses predictions. Moreover, Wasserstein Barycenter methods are stronger respect the other VaR models, because in the same reference time they provide a small exception probability and then a high-level capital
reserve is not required.
In the set of the analyzed methods, the VaR Forecasting at all confidence levels were achieved in high performance by the proposed Wasserstein Barycenter-N*
model. In fact, the Wasserstein Barycenter-N exhibited a better VaR forecasting
than Var-Covar and Simple Summation methods in all the confidence levels. Empirical results also demonstrated the known fact that the Simple Approach provides
an upper bound for the true VaR. In particular, for a confidence level of 0.1%,
a VaR of 0.0387 derived by Wasserstein Barycenter-N* was the third part of the
value 0.0978 based on the Simple Summation method. In such comparison context,
our approach provides a number of possibilities for a wide bank class. Thus, under a conservative Wasserstein Barycenter VaR compared with the general average,
the proposed method, indexed by different types of weights, allow several criteria
in order to improve the results. In contrast, the Var-covar method is preferably
optimistic. Finally, the notable closed property for the barycenter in the class of
location-scale distribution, just require a profuse knowledge of the prior barycenter under the selected distribution. Then, in the Gaussian case, an exact formula
for the value at risk Wasserstein Barycenter can be derived and applied into the
complete reference class of distributions. This opens an interesting perspective for
manage risk studies of series based on non Gaussian models, because a complete
mathematical description of the Wasserstein Barycenter VaR can be found under
the selected prior distribution.
4.2.2

Others Aggregate VaR models

Robust multivariate methods including Copulas and ARCH models also involve VaR estimation. However, under a big number of assets, such models produces biased parameter
estimations and demand a high computational cost. For completeness we contrast our
methods with those derived by [Jianping et al. (2012)].

11

Table 4: Value-at-Risk for t = 751 to 2971, number of exceptions (in brackets) where the
estimated VaR was exceeded by the portfolio loss with α = 0.01, 0.05, 0.01, 0.005.
Model
Wasserstein Barycenter-N*
Wasserstein Barycenter-N
SJC Copula + GARCH-E
Bivariate GARCH (BEKK)
Bivariate GARCH (DCC)
EWMA (Bivariate)
GARCH-N (Portfolio)
GARCH-t (Portfolio)
EWMA (Portfolio)
H.S. (Portfolio)

0.1 (222)
0.0387 (207)
0.0489 (225)

0.05 (111)
0.0349 (110)
0.0442 (130)
0.0558 (124)
0.0819 (182)
0.0432 (96)
0.0387 (86)
0.0666 (148)
0.0693 (154)
0.0527 (117)
0.1220 (271)

0.01 (22)
0.0247 (23)
0.0312 (46)
0.0104 (23)
0.0338 (75)
0.0140 (31)
0.0144 (32)
0.0207 (46)
0.0131 (29)
0.0135 (30)
0.0293 (65)

0.005 (11)
0.0192 (16)
0.0243 (30)
0.0041 (9)
0.0248 (55)
0.0113 (25)
0.0104 (23)
0.0144 (32)
0.0104 (23)
0.0099 (22)
0.0144 (32)

Note that the Wasserstein Barycenter-N* model gives a satisfactory VaR estimation
for α = 0.1, α = 0.05 and α = 0.01. When α = 0.01 the estimation equals the result of
the hibrid SJC Copula + GARCH-E method; for α = 0.005 it is near to the hibrid SJC
Copula + GARCH-E model, which was proposed by [Jianping et al. (2012)] as the best
approach. In fact, note that SJC Copula + GARCH-E method succeeds in the VaR forecasting at a 99.5% confidence level, but it fails for 90% and 95%. Now, kupiec test given
in Table 2 highlights that our methods show a high performance in all the confidence levels. Moreover, inclusion of GARCH models should improved our methods, but for space
reasons, we will leave that study for a future work. Given the robustness of GARCH
models, the VaR estimation will require a few violentios and then a minor capital reserve
should be demand.

4.3

COVID-19: 2020 Stock Market Crashs

We end this section by showing the behavior of our method in a crucial modern problem.
Explicitly, we will research the impact of COVID-19 in the 2020 Stock Market Crashs
measured in the Wall Street indexes of NASDAQ Composite, S&P 500 and Dow Jones
Industrial Average. These indexes reported historical loss levels, only registered in the
financial crisis of 2008.
As usual, the complete data set is split in sample and test periods. Sample data ranges
from January 4th, 2010 to December 31st, 2018. The 2264 daily return for every each
stock index also refers as the required historical data for a plausible VaR estimation. The
test data, for detecting the performance of the value at risk models, ranges from January
2nd, 2019 to July 31st, 2020. The VaR is estimated for each day in the test period (399
days), with the information offered by the 2663 observations ahead of it. Finally, the
performance of the VaR model is measured by a comparison of the current loss and the
estimated value at risk. The division for the sample and test periods are summarized in
12

Table 5: Sample and test periods
Period
Date
Number of observations

In-sample period
test period
Total
4/1/2010-31/12/2018 2/1/2019-31/7/2020
2264
399
2663

Table 6: Descriptive statistics for daily log-returns of Nasdaq, S&P500 and Dow Jones
during 2010-2019.
Statistics
Mean
Median
Standard Deviation
Min.
Max.
Excess of Kurtosis
Asymmetry

Dow Jones
0.00040
0.00058
0.00887
-0.057061
0.04864
4.04009
-0.47697

S&P500
0.00042
0.00060
0.00932
-0.06896
0.04840
4.59922
-0.49677

Nasdaq Composite
0.00055
0.00093
0.01076
-0.07149
0.05672
3.43256
-0.45537

Table 5.
Basic descriptive statistics analysis for the interval 2010-2019 and the 2020 year are
given in Tables 6 and 7, respectively.
Note that 2020 exhibits extremal high volatilities, in fact all the indexes highlight
a notorious difference between that year and the interval 2010-2019. In addition, the
minimum returns of the three indicators were reached on March 16th, 2020.
Next we compare the forecasting performance of the Wasserstein Barycenter-N* method
with the basic multivariate VaR models. The best challenge for both methods resides in
the financial market behavior of the 2020 year and its high volatility. First, Figure 1
Table 7: Descriptive statistics for daily log-returns of Nasdaq, S&P500 and Dow Jones in
2020
Statistics
Mean
Median
Standard Deviation
Min.
Max.
Excess of Kurtosis
Asymmetry

Dow Jones
-0,00052
0,00109
0,02929
-0,13841
0.10764
5,52874
-0,64012

13

S&P500
0,00008
0,00284
0,02718
-0.12765
0.08968
5,40858
-0,69653

Nasdaq Composite
0,00123
0,00427
0,02703
-0.13149
0.08935
5,62956
-0,90154

0.10
0.05
0.00
−0.05

Portfolio Return / VaR

−0.10

Simple summation
Varianza−Covarianza
Wassertein Barycenter Normal*

0

100

200

300

400

Observation

Figure 1: Daily Return series and VaR estimates
shows the forecast of the next trading day VaR for 2019 and 2020 by using both methods.
Under a one day holding period, the models were computed for a 99% confidence level.
As it can be seen the basic multivariate VaR models provide poor estimates for future
losses. The VaR estimates rises improperly VaR estimates and unacceptable test period
exceptions. However, the VaR estimation given by the Wasserstein Barycenter-N* VaR
model is highly accurate. The new approach fits the volatile movements of the returns
and predicts future losses notably, in comparison with the basic multivariate VaR approach. Moreover, according to Figure 1 the variance-covariance approach cannot follow
the strong volatility since February 2020; and always presents underestimation. In terms
of Simple Summation model, the test period shows lower violations but a strong conservative characteristic is noted. Finally, our proposed methods reach satisfactory VaR
forecast in normal periods and extremal periods for high volatility of the periods perform
The results indicate that the proposed approach provides satisfactory forecasts of VaR
not only for the ”normal periods” but also for the periods of high volatility due to the
COVID-19 stock market influence.
14

5

Concluding remarks

This work has proposed a new multivariate risk measure model based on the Wasserstein
barycenters of probability measures under a location and scatter class. The method was
compared with basic and sophisticated models under a portfolio characterized by S&P500
and Nasdaq stock indices. The new model was also compared in United States market
indices of high volatility during the current COVID-19. Kupiec test was used for assessing
the performance of the existing and new methods.
The new approach is based on a notable property: Wasserstein barycenters of measures
supported on location and scatter family belong to the same class. Then the paper
proposed exact formulae for the Wasserstein Barycenter Value at Risk and the Wasserstein
Barycenter Conditional Value at Risk for the addressed location and scatter family. This
promotes a new setting for building robust risk measures and aggregation of different
VaR in multiple financial markets. The closed form formulae are easily programmed for
applications.
The technique can be used for non Gaussian distributions, opening an interesting future research for more robust risk measures.

acknowledgements
The authors wish to express their gratitude to the Doctorate in Mathematics (Doctoral
School of Mathematics, IT and Telecommunications, University of Toulouse, Toulouse,
France) and to the Doctorate in Modelling and Scientific Computing (Faculty of Basic
Sciences, University of Medellin, Medellin, Colombia).

Conflict of interest
The authors declare that they have no conflict of interest.

References
[Agueh and Carlier (2011)] M. Agueh and G. Carlier. (2011) Barycenters in the Wasserstein space. SIAM J. Math. Anal., 43(2). 904–924.
[Alvarez et al. (2018)] Alvarez-Esteban, P. del Barrio, E., Cuesta-Albertos, J., & Matrán,
C. (2018). Wide consensus aggregation in the Wasserstein space. Application to
location-scatter families. Bernoulli. 24. 3147-3179.
[Barone et al.(2015)] Barone-Adesi, Giovanni & Giannopoulos, Kostas & Vosper, Les.
(2015). Estimating the Joint Tail Risk Under the Filtered Historical Simulation. An
Application to the CCP’s Default and Waterfall Fund. SSRN Electronic Journal.
[Bigot et al. (2018)] Bigot J, Gouet R, Klein T, López A. (2018). Upper and lower risk
bounds for estimating the Wasserstein barycenter of random measures on the real line.
Electron. J. Stat. 12: 2253–2289.
15

[Boissard et al. (2015)] Emmanuel Boissard, Thibaut Le Gouic, Jean-Michel Loubes.
(2015) Distributions template estimate with Wasserstein metrics. Bernoulli, 21(2):
740–759.
[Cédric Villani. (2008)] Cédric Villani. (2008). Optimal transport: old and new, volume
338. Springer Science & Business Media.
[Embrechts et al. (2002)] Embrechts P, McNeil A. J. and D Straumann (2002), Correlation and dependence proprieties in risk management: proprieties and pitfalls, in
M Demster ed Risk Management: Value at Risk and Beyond, Cambridge University
Press.
[Embrechts et al. (2013)] Embrechts P., Giovanni P., Rüschendorf L.(2013). Model uncertainty and VaR aggregation, Journal of Banking & Finance, 37(8): 2750–2764.
[Feng Yu and Erik Schlogl (2018)] Feng Yu and Erik Schlogl. (2018). Model Risk Measurement Under Wasserstein Distance. No 393. Research Paper Series, Quantitative
Finance Research Centre. University of Technology. Sydney.
[Forum (2010)] Forum Joint (2010) Developments in modelling risk aggregation. Bank
for International Settlements, Basel.
[Landsman et al.(2003)] Landsman, Z. M., and E. A. Valdez (2003). Tail conditional expectations for elliptical distributions. North Amer. Actuar. J. 7(4): 55–71.
[Le Gouic and Loubes (2017)] Le Gouic, T., Loubes, J.M. Existence and consistency of
Wasserstein barycenters. Probab. Theor. Related Fields 168(34): 901–917
[Li et al. (2015)] Li, J., Zhu, X., Lee, C.-F., Wu, D., Feng, J., and Shi, Y. (2015). On the
aggregation of credit, market and operational risks. Review of Quantitative Finance
and Accounting, 44(1): 161–189.
[Jianping et al. (2012)] Jianping Li, Jichuang Feng , Xiaolei Sun, Minglu Li. (2012). Risk
integration mechanisms and approaches in banking industry. International Journal of
Information Technology & Decision Making. 11(06): 1183–1213.
[Jin and Lehnert (2018)] Jin, X. & Lehnert, T. (2018). Large portfolio risk management
and optimal portfolio allocation with dynamic elliptical copulas. Dependence Modeling, 6(1): 19-46.
[Kiesel et al. (2016)] Kiesel, R., Ruhlicke, R., Stahl, G., Zheng, J. (2016). The Wasserstein Metric and Robustness in Risk Management. Risks. 4, 32.
[McNeil (1999)] McNeil, A. J., (1999). Extreme Value Theory for risk managers, mimeo,
ETH Zurich.
[McNeil and Embrechts (2015)] McNeil, A. J., Frey, R. and Embrechts, P., (2015). Quantitative risk management: Concepts, techniques and tools. Princeton, New Jersey:
Princeton university press.

16

[Wagalath and Zubelli (2018)] Wagalath, L. and Zubelli, J. (2018) A liquidation risk adjustment for value at risk and expected shortfall. International Journal of Theoretical
and Applied Finance, 21 (3): 1-21.

17

