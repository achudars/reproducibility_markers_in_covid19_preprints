STSIR: Spatial Temporal Pandemic Model with Mobility Data

arXiv:2012.03509v1 [cs.CE] 7 Dec 2020

A COVID-19 Case Study
Wang Pan

Qipu Deng

Jiadong Li

Tsinghua-Berkeley Shenzhen
Institute, Tsinghua University
Pengcheng Laborotory
China
pw18@mails.tsinghua.edu.cn

Tsinghua-Berkeley Shenzhen
Institute, Tsinghua University
Pengcheng Laborotory
China
dqp18@mails.tsinghua.edu.cn

Tsinghua-Berkeley Shenzhen
Institute, Tsinghua University
Pengcheng Laborotory
China
lijd18@mails.tsinghua.edu.cn

Zhi Wang

Wenwu Zhu

Department of Computer Science
and Technology, Tsinghua University
Pengcheng Laborotory
China
wangzhi@sz.tsinghua.edu.cn

Department of Computer Science
and Technology, Tsinghua University
Pengcheng Laborotory
China
wwzhu@tsinghua.edu.cn

ABSTRACT
With the outbreak of COVID-19, how to mitigate and suppress
its spread is a big issue to the government. Department of public
health need powerful models to model and predict the trend and
scale of such pandemic. And models that could evaluate the eÔ¨Äect
of the public policy are also essential to the Ô¨Åght with the COVID19.
A main limitation of existing models is that they can only evaluate the policy by calculating ùëÖ0 after infection happens instead
of giving observable index. To tackle this, based on the transmission character of the COVID-19, we preposed a novel framework
Spatial-Temporal-Susceptible-Infected-Removed (STSIR) model. In
particular, we merged both intra-city and inter-city mobility index
with the traditional SIR dynamics and make it a dynamic system.
And we proved that the STSIR system is a closed system which
makes the system self-consistent. And Ô¨Ånally we proposed a MultiStage Simulated Annealing (MSSA) algorithm to Ô¨Ånd optimal parameter of the system. In our experiments, based on Baidu Mobility
dataset [1], and China pandemic dataset provided by Dingxiangyuan[2],
our model can eÔ¨Äectively predict the total scale of the pandemic
and also gives clear policy analysis with observable index.

KEYWORDS
pandemic, dynamic model, spatial-temporal model
ACM Reference Format:
Wang Pan, Qipu Deng, Jiadong Li, Zhi Wang, and Wenwu Zhu. 2020. STSIR:
Spatial Temporal Pandemic Model with Mobility Data : A COVID-19 Case
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proÔ¨Åt or commercial advantage and that copies bear this notice and the full citation on the Ô¨Årst page. Copyrights for components of this work owned by others than
ACM must be honored. Abstracting with credit is permitted. To copy otherwise, or republish, to post on servers or to redistribute to lists, requires prior speciÔ¨Åc permission
and/or a fee. Request permissions from permissions@acm.org.
Conference‚Äô17, July 2017, Washington, DC, USA
¬© 2020 Association for Computing Machinery.
ACM ISBN 978-x-xxxx-xxxx-x/YY/MM. . . $15.00
https://doi.org/10.1145/nnnnnnn.nnnnnnn

Study. In Proceedings of ACM Conference (Conference‚Äô17). ACM, New York,
NY, USA, 9 pages. https://doi.org/10.1145/nnnnnnn.nnnnnnn

1 INTRODUCTION
Building accurate models to predict and quantify the eÔ¨Äect of infectious diseases is very important to today‚Äôs public health. The
classic SI, SIR and SEIR models [3] have been proposed and used
for a long time. However, with the development of modern transportation, the range and the eÔ¨Äect of infectious disease are widely
ampliÔ¨Åed, which traditional SI, SIR and SEIR models become insuÔ¨Écient to describe the transmission characteristics of new infectious diseases accurately. For example, the outbreak of the new
COVID-19 pandemic has caused nearly 20 million infections and
hundreds of thousands of deaths nowadays. We have not expected
so much loss that such disease can cause, which urge us to build
better infectious disease models to analyze and monitor the pandemic‚Äôs development. And we can expect to rely on such tools to
help us understand the epidemic transmission characters and make
correct and reasonable epidemic prevention policies to save lives.
In order to better Ô¨Åt and analyze the spread of such infectious diseases, various scholars have conducted diÔ¨Äerent new methods. On
one hand, several scholars add new transiting phases (eg. Asymptomatic, Hospitalized, etc.) in infectious models[4‚Äì7]. However, the
method of simply adding phases has several shortcomings. Firstly,
the abundant parameters make parameter calculation very laborious. Secondly, after adding multiple phases, the model focus on
only simulates a single city or region, and cannot model the Ô¨Çow
of people between multiple regions. The transmission characters
between regions have been ignored. Thirdly, with the diÔ¨Äerent definition of diÔ¨Äerent phases, properly categorizing patients to those
phases is diÔ¨Écult.
To make the model be able to model multiple regions, other scholars have added transportation statistics such as civil aviation and
railways data to model pandemic evolution[5, 8‚Äì11]. Nevertheless,
the information granularity of civil aviation and railway statistics
are too coarse to give the intercity information accurately, such

Conference‚Äô17, July 2017, Washington, DC, USA

modeling can only give a rough pandemic trend, with low predicting accuracy. Such models considered the inter-region transmission from the origin of the pandemic outbreak to other major
cities. But with the development of modern transportation. New
situations such that infected people may travel not only from the
outbreak city to the Ô¨Årst destination but also from the Ô¨Årst destination to the second one are also crucial for the trend analysis, which
has not been considered by the current models. Furthermore, the
basic reproduction number ùëÖ0 is essential in modeling. However,
such a parameter can only be calculated based on infected numbers after infection happens. The model can only analyze the effect of our quarantine or intervention policy by heuristically imagining how low the policy can suppress the ùëÖ0 to without giving
any quantiÔ¨Åable index that we can monitoring[7, 10]. A systematic Ô¨Åne-grained spatial-temporal model that can better describe
the trend of the pandemic and give quantiÔ¨Åable indexes to make
policies aim to mitigate pandemic spread is desperately needed.
To achieve this target, combining mobility data with classical
infectious models is an insightful idea. With the prevalence of mobile phones and mobile apps, mobility data provided by large companies gives an accurate and timely overview of the migration of
people[12]. The near real-time and Ô¨Åne-grained data are undoubtedly helpful in building new pandemic modeling frameworks[13,
14]. Multiple researches have shown that non-pharmaceutical interventions have obvious eÔ¨Äects to mobility activities[15, 16]. For
example, Baidu and Tencent provide an apparent migration curve
of people between regions[1], through the data collected from various apps (Figure2). Moreover, due to the accuracy of positioning
and ITS development, the trajectory information generated by people when they travel within the city also allows us to obtain a
description of the degree of intra-city activities.(Figure 3) During
the pandemic, compared with the Ô¨Åxed and extensive civil aviation railway statistics, mobility data gave a more Ô¨Åne-grained
transportation overview from inter-region and intra-region perspectives.
With the considerations list above, we proposed the STSIR framework. A succinct, accurate, quantiÔ¨Åable framework that gives pandemic trend prediction and quantiÔ¨Åable indexes could help mitigate the pandemic spread. Generally, the STSIR model contains a
system of diÔ¨Äerential equations in which we have designed two
novel parts to model the spread of infectious diseases intra-regionally
and inter-regionally. We set one day as a time segment. We only
need the initial information when the outbreak started to give a
pandemic evolving curve by fusing the intra-city activity index and
the inter-city activity index.

2

RELATED WORKS

With the outbreak of the COVID-19, numerous studies related to
such infectious disease are emerged. New models adopted new
transmission character of the COVID-19 in order to get better model
performance
Initially, Wu et al.[10] integrated inter-regional traÔ¨Éc originated
from Wuhan with SEIR model to catch the pandemic‚Äôs transmission character. However, inter-regional transmission between other

Wang Pan, Qipu Deng, Jiadong Li, Zhi Wang, and Wenwu Zhu

big cities has been ignored. Such a model has not considered latent infection transmission between big cities except the initial outbreak point. Followed by this research, Wang et al. [7] tried to give
an analysis of the pandemic by intuitively adjusting the ùëÖ0 . Such
a method gives an overview of the pandemic with diÔ¨Äerent ùëÖ0 s.
However, no observable indexes related to ùëÖ0 are mentioned in
such a model, which gives diÔ¨Éculties in evaluating our policy‚Äôs effect. Furthermore, Gatto et al. [4] and Zhou [5] added a new asymptomatic phase into the pandemic evolving procedure. Gatto et al.
[4] also added pre-symptomatic and hospitalized phases to give a
more accurate dynamic of COVID-19. Nevertheless, with the diÔ¨Äerent deÔ¨Ånitions of the diÔ¨Äerent phases, accurately categorizing patients into phases is quite diÔ¨Écult. Lau et al.‚Äôs work[9] tried to use
air traÔ¨Éc statistics to model transmission traits. However, the granularity of the statistic data limits the model performance. Ting et
al. [12], Ienca et al.[14] and Buckee et al.[13] pointed out the importance of the mobility data in Ô¨Åghting COVID-19. With such insight,
combined with mobility data, Jia et al. [17] gave out a model that
could help analyze the risk distribution of the pandemics. Gatto
et al. [4] and Wu et al. [10] also enhance their works with interregional mobility data. Nevertheless, the mobility activities within
each region are not considered thoroughly.

3 PROPOSED MODEL
3.1 Preliminaries
In this subsection, we present the fundamental concepts about basic epidemiology models. We start with pure SI and SIR models.
Moreover, we analyzed its usefulness in today‚Äôs COVID-19 cases.
As the analysis goes on, we derive our new STSIR framework from
the basic models.
Susceptible-Infected (SI) model. The most basic epidemiology
model is Susceptible-Infected(SI) model. As shown in Ô¨Ågure 4, there
are two transiting phases in the dynamic model.
And the whole dynamics will be running based on the following
equations:

with initial condition:

Ô£±
ùúïùëÜ
ùëÖ0 ùêºùëÜ
Ô£¥
Ô£¥
Ô£¥
Ô£≤
Ô£¥ ùúïùë° = ‚àí ùê∑ùê∏ ùëÅ
ùúïùêº
ùëÖ0 ùêºùëÜ
Ô£¥
Ô£¥
Ô£¥
Ô£¥ ùúïùë° = ùê∑ ùëÅ
Ô£≥
ùê∏


(1)
(2)

ùëÜ (0) = ùëÅ ‚àí ùêº 0

(3)

ùêº (0) = ùêº 0

(4)

Susceptible-Infected-Removed (SIR) model. A transformation of the SI model is Susceptible-Infected-Removed (SIR) model.
As shown in the Ô¨Ågure 5 there are three transiting phases in the
dynamic model. A new Removed phase is included to describe
the people who are recovered, dead, or quarantined, which do not
aÔ¨Äect the infecting procedure.

STSIR: Spatial Temporal Pandemic Model with Mobility Data

140

beijing-shanghai
beijing-tianjin
beijing-chongqing
beijing-guangzhou
beijing-shenzhen

120
100
80

Conference‚Äô17, July 2017, Washington, DC, USA

shanghai-beijing
shanghai-tianjin
shanghai-chongqing
shanghai-guangzhou
shanghai-shenzhen

35
30
25

tianjin-beijing
tianjin-shanghai
tianjin-chongqing
tianjin-guangzhou
tianjin-shenzhen

120
100
80

20

60

15

40

10

20

5

0

60
40
20

0
06

13

20

27

Jan
2020

03

10

17

24

Feb

02

06

Mar

10

13

20

27

Jan
2020

chongqing-beijing
chongqing-shanghai
chongqing-tianjin
chongqing-guangzhou
chongqing-shenzhen

12

0

09

03

10

17

24

Feb

02

09

06

Mar
guangzhou-beijing
guangzhou-shanghai
guangzhou-tianjin
guangzhou-chongqing
guangzhou-shenzhen

80

13

20

27

Jan
2020

03

10

17

24

Feb

02

09

Mar
shenzhen-beijing
shenzhen-shanghai
shenzhen-tianjin
shenzhen-chongqing
shenzhen-guangzhou

100
80

60

8

60

6

40
40

4
20

2

20

0

0
06

13

20

27

Jan
2020

03

10

17

24

Feb

02

0

09

06

Mar

13

20

27

Jan
2020

03

10

17

24

Feb

02

09

06

Mar

13

20

27

Jan
2020

03

10

17

Feb

24

02

09

Mar

Figure 1: Inter-city mobility index between the major cities in China

14

wuhan-beijing
wuhan-shanghai
wuhan-tianjin
wuhan-chongqing
wuhan-guangzhou
wuhan-shenzhen

12

beijing
shanghai
tianjin
chongqing
guangzhou
shenzhen

7

6

5

10
4

8
3

6

2

4

1
2020-01-01

2

0
06
Jan
2020

13

20

27

03
Feb

10

17

24

02

09

2020-01-11

2020-01-21

2020-01-31

2020-02-10
date

2020-02-20

2020-03-01

2020-03-11

Figure 3: Intra-city mobility index of major cities in China

Mar

Figure 2: Inter-city mobility index between the outbreak origin Wuhan and other major cities in China
And the whole dynamics will be running based on the following
equations:
Ô£±
ùëÖ0 ùêºùëÜ
ùúïùëÜ
Ô£¥
Ô£¥
=‚àí
(5)
Ô£¥
Ô£¥
ùê∑ùê∏ ùëÅ
Ô£¥ ùúïùë°
Ô£¥
Ô£¥
Ô£≤ ùúïùêº
Ô£¥
ùëÖ0 ùêºùëÜ
=
‚àí ùõæ1 ùêº
(6)
Ô£¥
ùúïùë°
ùê∑
ùê∏ùëÅ
Ô£¥
Ô£¥
Ô£¥
Ô£¥
ùúïùëÖ
Ô£¥
Ô£¥
= ùõæ1ùêº
(7)
Ô£¥
Ô£≥ ùúïùë°

Susceptible

Infected

Figure 4: The transiting phases of SI model
Susceptible

Infected

Removed

Figure 5: The transiting phases of SIR model
with initial condition:
ùëÜ (0) = ùëÅ ‚àí ùêº 0
Ô£±
Ô£¥
Ô£≤
Ô£¥
ùêº (0) = ùêº 0
Ô£¥
Ô£¥
Ô£≥ ùëÖ(0) = 0

(8)
(9)
(10)

Conference‚Äô17, July 2017, Washington, DC, USA

Wang Pan, Qipu Deng, Jiadong Li, Zhi Wang, and Wenwu Zhu

Other model with new phases During this COVID-19 pandemic,
clinical reports [18] have shown that people may show no symptoms or just mild symptoms after they get infected. However, such
people also get the ability to infect others. This kind of character makes this virus can be easily spread widely. As shown in Ô¨Ågure 6, numerous scholars added new phases to enrich the dynamic
model.
Although these models increased the granularity of the transiting

Infected

Q?@ABnCEFGI

M  

e

S

Susceptible

H123456789:;

R+,-./0d

s

O p



D<=>

! "#$%&'

JKLNP RTUVWX

e()*

YZ[\

Figure 6: The transiting phases of SIR+ model
phases due to the implicit and diÔ¨Äerent deÔ¨Ånitions of each phase,
clearly categorized patients to the model phases are tricky. To get
a clear deÔ¨Ånition of each phase and a succinct model, we choose to
adopt the SIR model as our primary model and focus more on the
pandemic‚Äôs transmission character.

3.2

Spatial-Temporal-Susceptible-InfectedRemoved (STSIR)
Model
√§√•√¶√ß√®√© √™√´

N
o


√∂√∑√∏√π√∫√ª √º√Ω

√¨√≠√Æ√Ø√∞√±√≤√≥√¥√µ

√æ√ø

I 

¬©¬™¬´¬¨¬≠¬Æ¬Ø ¬∞¬±¬≤¬≥¬¥¬µ¬∂¬∑¬∏

]^_`abcdfgh

ijklmoqrtuv

¬∑¬∑¬∑¬∑¬∑¬∑

wxyz{|}~¬Ä¬Å

B
$%&'(
im
)*+,-./0123
!"#
¬Ç¬É¬Ñ ¬Ü¬á¬à¬â ¬ä¬ã¬å¬ç¬é

¬è¬ê¬ë¬í¬ì¬î¬ï¬ñ ¬ó¬ò¬ô¬ö¬õ

45678 9:;<=>?@ACD
PEFGHJKLMO

QRSTUVWXYZ [\]s^_`

¬∑¬∑¬∑¬∑¬∑¬∑

¬ú¬ù¬û¬ü ¬°¬¢¬£ ¬§¬•¬¶¬ß¬®

¬π¬∫¬ª¬º¬Ω¬æ¬ø√Ä √Å√Ç√É√Ñ√Ö

abcd

√Ü√á√à√â√ä√ã√å√ç√é√è √ê√ë√í√ì√î

√ï√ñ√ó√ò√ô√ö√õ√ú√ù√û √ü√†√°√¢√£

Figure 7: Whole framework of the STSIR system
STSIR Framework As shown in Ô¨Ågure 7, the whole framework is consist of several STSIR Layers. Each layer models the
daily infection and transmission procedure of the pandemic. With
an input of the initial infection and necessary information, the
framework can give out the simulated infection numbers based on
the corresponding mobility index.

Mobility Index To better describe the pandemic‚Äôs transmission
character, We adopt two kinds of mobility index in the model. Intracity index and Inter-city index. The intra-city index describes the
activity density within the city. The inter-city index describes the
movement between regions. As shown in Ô¨Ågure 2, since the government shut down Wuhan, the origin of the outbreak, the intercity mobility originated from Wuhan to other big cities in China
dropped from a high value to near 0. However, there is still transmission between other big cities, as we can see from Ô¨Ågure 1, which
means that there are possibilities that those who get infected can
move to multiple big cities and seed the transmission of the pandemic there.
Furthermore, as we can see from Ô¨Ågure 3, the intra-city index has
dropped dramatically when quarantine and stay-home policy begins. However, there are still low-level activities within the city,
which give chances of the infection. So both inter-city and intracity index should be included in our model.
STSIR Layer After considering the problems list above we propose the STSIR Layer which contains a dynamic model shown in
follow equations:
Ô£±
ùúïùë∫ (ùíï)
ùë∞ (ùíï) ‚äô ùë∫ (ùíï)
Ô£¥
Ô£¥
= ‚àí ùõø 1 ¬∑ Tùêº (ùë°)
Ô£¥
Ô£¥
ùúïùë°
ùëµ
Ô£¥
Ô£¥
Ô£¥
Ô£¥
ùë∫
(ùíï)
Ô£¥
Ô£¥
¬Æ ‚äô
+ ùõø 2 ¬∑ Tùë∂ (ùíï)
‚àí ùõø 2 ¬∑ (Tùë∂ (ùíï)ùëá 1)
Ô£¥
Ô£¥
Ô£¥
ùëµ
Ô£¥
Ô£¥
Ô£≤ ùúïùë∞ (ùíï)
Ô£¥
ùë∞ (ùíï) ‚äô ùë∫ (ùíï)
=ùõø 1 ¬∑ Tùêº (ùë°)
‚àí ùõæ 1 ùë∞ (ùíï)
Ô£¥
ùúïùë°
ùëµ
Ô£¥
Ô£¥
Ô£¥
Ô£¥
ùë∞ (ùíï)
Ô£¥
¬Æ ‚äô
Ô£¥
‚àí ùõø 2 ¬∑ (Tùë∂ (ùíï)ùëá 1)
+ ùõø 2 ¬∑ Tùë∂ (ùíï)
Ô£¥
Ô£¥
ùëµ
Ô£¥
Ô£¥
Ô£¥
Ô£¥
ùúïùëπ (ùíï)
Ô£¥
Ô£¥
= ùõæ 1 ùë∞ (ùíï)
Ô£¥
Ô£≥ ùúïùë°

ùë∫ (ùíï)
ùëµ

ùë∞ (ùíï)
ùëµ

(11)

(12)

(13)

with initial condition:

ùë∫ (0) = ùëµ ‚àí ùë∞0
Ô£±
Ô£¥
Ô£≤
Ô£¥
ùë∞ (0) = ùë∞0
Ô£¥
Ô£¥
Ô£≥ ùëπ (0) = 0

(14)
(15)
(16)

Given ùëò cities in the system, here ùë∫ (ùíï), ùë∞ (ùíï), ùëπ (ùíï) are the system
susceptible, infectious and recovered vectors with the shape of [ùëò, 1]
at time ùë° respectively. ùëµ denotes the population vector of each city
with the shape of [ùëò, 1]. ùõø 1 represents the city-wise multiplier for
the contribution of intra-city activity to the pandemic transmission. ùõø 2 is a uniÔ¨Åed multiplier to denote the transmission between
multiple cities. ùõæ 1 denotes the removing coeÔ¨Écient, which shows
the removing rate of the infectious people. Tùêº (ùë°) and TùëÇ (ùë°) are
Intra-city mobility index with shape the of [ùëò, 1] at time ùë° and Intercity mobility index with the shape of [ùëò, ùëò] at time ùë° respectively.
Detailed meanings can be checked from table 1.
Now we show the derivation of such system models. For each
city ùëñ, we consider the transition procedure for each phase, respectively. For the susceptible phase, the change of the number can be
consist of three parts:
‚Ä¢ The people who were susceptible get infected within the
city
‚Ä¢ The people who are susceptible coming from other cities
‚Ä¢ The people who are susceptible moving to other cities

STSIR: Spatial Temporal Pandemic Model with Mobility Data

Conference‚Äô17, July 2017, Washington, DC, USA

Table 1: Notations
Notations

Meanings

ùëÅ
Tùêº (ùë°)
TùëÇ (ùë°)
ùëÜ (ùë°)
ùêº (ùë°)
ùëÖ(ùë°)
ùõæ1
ùõø1
ùõø2

Total number of people
Intra-city mobility index at time ùë°
Inter-city mobility index at time ùë°
Susceptible people at time ùë°
Infectious people at time ùë°
Recovered people at time ùë°
Removing coeÔ¨Écient denoting the removing rate of infected people
Multiplier for intra-city mobility index
Multiplier for inter-city mobility index

With the same idea, we can know the four parts of changes of the
infectious number:
‚Ä¢ The people who were susceptible get infected within the
city
‚Ä¢ The people who are infectious coming from other cities
‚Ä¢ The people who are infectious going to other cities
‚Ä¢ The people who are quarantined, dead, or recovered thus
removed from the system.
Then for each city ùëñ, we can have a single dynamic system as follows:
ùúïùëÜ (ùë°)ùëñ
ùêº (ùë°)ùëñ ùëÜ (ùë°)ùëñ
Ô£±
Ô£¥
= ‚àí ùõø 1 ¬∑ Tùêº (ùë°)ùëñ
Ô£¥
Ô£¥
Ô£¥
ùúïùë°
ùëÅùëñ
Ô£¥
Ô£¥
Ô£¥
Ô£¥
(17)
ùëò
ùëò
Ô£¥
√ï
√ï
Ô£¥
Ô£¥
Ô£¥
T
(ùë°)
T
(ùë°)
‚àí
ùõø
ùëÜ
(ùë°)
+
ùõø
ùëÜ
(ùë°)
ùëóùëñ
ùëñ
ùëó
2
ùëñ
2
ùëñ
Ô£¥
ùëÇ
ùëÇ
Ô£¥
Ô£¥
Ô£¥
ùëó=1
ùëó=1
Ô£¥
Ô£¥
Ô£¥
Ô£≤ ùúïùêº (ùë°)ùëñ
Ô£¥
ùêº (ùë°)ùëñ ùëÜ (ùë°)ùëñ
=ùõø 1 ¬∑ Tùêº (ùë°)ùëñ
‚àí ùõæ 1 ùêº (ùë°)ùëñ
Ô£¥
ùúïùë°
ùëÅùëñ
Ô£¥
Ô£¥
Ô£¥
Ô£¥
(18)
ùëò
ùëò
Ô£¥
√ï
√ï
Ô£¥
Ô£¥
Ô£¥
+
ùõø
ùêº
(ùë°)
T
(ùë°)
‚àí
ùõø
ùêº
(ùë°)
T
(ùë°)
Ô£¥
2
ùëñ
ùëñùëó
2
ùëñ
ùëóùëñ
ùëÇ
ùëÇ
Ô£¥
Ô£¥
Ô£¥
ùëó=1
ùëó=1
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£¥
ùúïùëÖ(ùë°)ùëñ
Ô£¥
Ô£¥
(19)
Ô£≥ ùúïùë° = ùõæ 1 ùêº (ùë°)ùëñ
with initial condition
ùëÜ (0)ùëñ = ùëÅùëñ ‚àí ùêº 0,ùëñ
(20)
Ô£±
Ô£¥
Ô£≤
Ô£¥
ùêº (0)ùëñ = ùêº 0,ùëñ
(21)
Ô£¥
Ô£¥
(22)
Ô£≥ ùëÖ(0)ùëñ = 0
And we can aggregate ùëò cities with above dynamics together to get
the format of the dynamics shown in equation (11) to (16)

Theorem 1. Each STSIR Layer is a Self-consistent system, which
means there are no new members introduced to the system. The total
population of the whole system always remains the same.

And for each ‚ñ≥ùëÅ (ùë°)ùëñ we can add them together for k cities. We
have:
ùëò
√ï

ùëÅ (ùë°)ùëñ =ùõø 2 ùëÜ (ùë°)ùëñ

ùëñ=1 ùëó=1

ùëñ=1

+ ùõø 2 ùêº (ùë°)ùëñ

‚ñ≥ùëÅ (ùë°)ùëñ =ùõø 2 ùëÜ (ùë°)ùëñ

ùëò
√ï

TùëÇ (ùë°)ùëñ ùëó ‚àí ùõø 2ùëÜ (ùë°)ùëñ

ùëó=1

+ ùõø 2 ùêº (ùë°)ùëñ

ùëò
√ï
ùëó=1

ùëò
√ï

TùëÇ (ùë°) ùëóùëñ

ùëó=1

TùëÇ (ùë°)ùëñ ùëó ‚àí ùõø 2 ùêº (ùë°)ùëñ

ùëò
√ï
ùëó=1

(23)
TùëÇ (ùë°) ùëóùëñ

ùëò
√ï

(

ùëó=1

ùëò
√ï

TùëÇ (ùë°)ùëñ ùëó ‚àí

=ùõø 2 ùëÜ (ùë°)ùëñ (

ùëò √ï
ùëò
√ï

TùëÇ (ùë°)ùëñ ùëó ‚àí

ùëñ=1 ùëó=1

+ ùõø 2 ùêº (ùë°)ùëñ (

ùëò √ï
ùëò
√ï

ùëò
√ï

TùëÇ (ùë°) ùëóùëñ )

ùëó=1

ùëñ=1 ùëó=1

ùëò √ï
ùëò
√ï

TùëÇ (ùë°) ùëóùëñ )

(24)

ùëñ=1 ùëó=1

TùëÇ (ùë°)ùëñ ùëó ‚àí

ùëñ=1 ùëó=1

ùëò √ï
ùëò
√ï

TùëÇ (ùë°) ùëóùëñ )

ùëñ=1 ùëó=1

=ùõø 2 ùëÜ (ùë°)ùëñ ‚àó 0 + ùõø 2 ùêº (ùë°)ùëñ ‚àó 0
=0
Based on equation (24), the inter-city transmission mechanism implement no change of the total population.

Parameter Learning There are several parameters in the STSIR
model ùúÉ = {ùõø 1, ùõø 2, ùõæ 1 }. Because of the asymptomatic state of the
COVID-19 and the complexity of the case test, we consider the
oÔ¨Écial announced cases is a delayed expression of the genuine
situation. Instead of Ô¨Åtting the oÔ¨Écially conÔ¨Årmed curve, we aim
to train the model to be able to give a trend of the pandemic by
simulating. Given two time sequences, ùêºùë† (ùë°) and ùêºùë° (ùë°), which denote simulated numbers of daily infections and oÔ¨Écially conÔ¨Årmed
numbers of daily infections respectively, we want to minimize the
gap between total number of cases by simulation and the real conÔ¨Årmed numbers after the test delay, which can be deÔ¨Åned as following optimization problem:
‚à´ ùë°‚àíùëëùëíùëôùëéùë¶
‚à´ ùë°
ùëöùëñùëõùëñùëöùëñùëßùëí ùêøùëúùë†ùë† (
ùêºùë† (ùúÉ, ùë°)ùëëùë° ‚àí
ùêºùë° (ùë°)ùëëùë°)
(25)
ùúÉ

Proof. For each layer at time ùë° we can add (17), (18) and (19)
together. We can get:

ùëò √ï
ùëò
ùëò
√ï
√ï
(
TùëÇ (ùë°)ùëñ ùëó ‚àí
TùëÇ (ùë°) ùëóùëñ )

0

0

To get the parameters of such a multi-system model, we developed
a Multi-Stage Simulated Annealing algorithm. Simulated Annealing [19] algorithm has been used for multiple optimization
tasks[20], including both single objective and multiple objective
optimization problems. It has shown its eÔ¨Äectiveness in optimizing parameters. However, traditional simulated annealing is not
suitable to optimize a dynamic model with multiple inter-reacting
systems. So based on our problem, we use Multi-Stage Simulated

Conference‚Äô17, July 2017, Washington, DC, USA

Annealing algorithm to Ô¨Ånd our optimal parameters for the model.
The algorithm is described in Algorithm 1.
Algorithm 1: Multi-Stage Simulated Annealing
Parameters: ùúÉ = {ùúπ 1, ùõø 2, ùú∏ 1 }
Data: Training set ùë•
1 Initializing Parameters..
2 while (current epoch<epochs) or (other ending conditions) do
3
ùëôùëúùë†ùë†1 = ùëôùëúùë†ùë† (ùëöùëúùëëùëíùëô (ùë•))
// Stage 1 update intra-city parameters
4
for each ùëù ‚àà {ùúπ 1, ùú∏ 1 } do
5
ùëùùëëùëíùëôùë°ùëé = ùë¢ùëõùëñ ùëì ùëúùëüùëö (‚àí0.5, 0.5)
6
ùëù = ùëù + ùëùùëëùëíùëôùë°ùëé ‚àó ùëôùëü ùë†ùë°ùëéùëîùëí // randomly update
parameters
7
ùëôùëúùë†ùë†2 = ùëôùëúùë†ùë† (ùëöùëúùëëùëíùëôùëõùëíùë§ (ùë•)) // Accept the new
parameters if ùëôùëúùë†ùë†2 < ùëôùëúùë†ùë†1, accept the
new parameters with probability if
ùëôùëúùë†ùë†2 > ùëôùëúùë†ùë†1
8
if (ùëôùëúùë†ùë†2 > ùëôùëúùë†ùë†1) then

Wang Pan, Qipu Deng, Jiadong Li, Zhi Wang, and Wenwu Zhu

Table 2: Dataset Description of Baidu Mobility Dataset
Name

Value

# Administrative areas
Internal Ô¨Çow time range
# Internal Ô¨Çow Records

388
2020-01-01 2020-03-15
75
2019-01-12 2019-04-12
2020-01-01 2020-03-15
128816

Migration Ô¨Çow time range
# Migration Ô¨Çow Records

80000

Total confirmed cases of China

60000

40000

ùëôùëúùë†ùë† 2‚àíùëôùëúùë†ùë† 1

9
10

11
12
13

14

15

if ùë¢ùëõùëñ ùëì ùëúùëüùëö (0, 1) > ùëí ùë°ùëíùëöùëù then
restore ùëöùëúùëëùëíùëô .ùëúùëôùëëùëùùëéùëüùëéùëöùë†// restore old
parameters if update is bad
// Stage 2 update inter-city parameter
ùëù = ùõø2
ùëùùëëùëíùëôùë°ùëé = ùë¢ùëõùëñ ùëì ùëúùëüùëö (‚àí0.5, 0.5)
ùëù = ùëù + ùëùùëëùëíùëôùë°ùëé ‚àó ùëôùëü ùë†ùë°ùëéùëîùëí // randomly update
parameters
ùëôùëúùë†ùë†2 = ùëôùëúùë†ùë† (ùëöùëúùëëùëíùëôùëõùëíùë§ (ùë•)) // Accept the new
parameters if ùëôùëúùë†ùë†2 < ùëôùëúùë†ùë†1, accept the new
parameters with probability if ùëôùëúùë†ùë†2 > ùëôùëúùë†ùë†1
if (ùëôùëúùë†ùë†2 > ùëôùëúùë†ùë†1) then
ùëôùëúùë†ùë† 2‚àíùëôùëúùë†ùë† 1

17

if ùë¢ùëõùëñ ùëì ùëúùëüùëö (0, 1) > ùëí ùë°ùëíùëöùëù then
restore ùëöùëúùëëùëíùëô .ùëúùëôùëëùëùùëéùëüùëéùëöùë†// restore old
parameters if update is bad

18

ùë°ùëíùëöùëù = ùë°ùëíùëöùëù ‚àó ùëêùëúùëúùëôùëñùëõùëîùëüùëéùë°ùëí// cooling temperature

16

4

EXPERIMENTS

To evaluate the eÔ¨Äectiveness of STSIR model, we conduct experiments on with Baidu Mobility dataset [1] and China pandemic
dataset provided by Dingxiangyuan [2]. We will then provide a
brief data description in Section 4.1. In Section 4.2, we will analyze
the data we have, and illustrate our experiment settings. In Section
4.3, we demonstrate the strong predicting power of our model. In
section 4.4, we analyze how great the model can help us analyze
the eÔ¨Äect of diÔ¨Äerent policies in pandemic transmission.

4.1

Data Description

Baidu Mobility Dataset Baidu Mobility dataset [1] is provided
by the Baidu company. Baidu search engine, as well as its various
applications, owns over 1 billion users in China. Every time an

20000

0
2020-01-01

2020-01-21

2020-02-10

2020-03-01

2020-03-21

2020-04-10

2020-04-30

Figure 8: The oÔ¨Écial conÔ¨Årmed cases of COVID-19 in China.

application is launched, Baidu collects the IP address of the end
device. Thus, Baidu could know how the crowd moves from one
place to another based on the changes of the IP address. The information is represented as a mobility index, of which a higher
number means a more frequent movement of the crowd. The data
is fully anonymized and collected according to the terms and conditions of Baidu for privacy concerns.
The dataset contains two kinds of mobility data of 388 administrative areas. The administrative areas are four municipalities, 343
prefecture-level cities, and 41 province directly governed counties
(including Hong Kong, Macau, and Taiwan). The two kinds of mobility data, intra-city index and inter-city index, are two Ô¨Çoat numbers representing the activity strength within the city and between
cities per day, respectively. The record ranges from 2020-01-01 to
2020-03-15. Since the range covers the Chinese New Year, the dataset
also provides a historical intra-city index of the same period based
on Lunar Calendar for reference. Table 1 summarizes the statistics
of the dataset.
DingXiangYuan COVID-19 Dataset Dingxiangyuan[2] COVID19 dataset contains COVID-19/2019-nCov time series infection data
in China. The data source is Ding Xiang Yuan. Ding Xiang Yuan is
a professional medical website in China, and its data is authorized
and used by mainstream media in China, such as CCTV and China
Daily. The dataset contains the overall infected number in 388 administrative areas, including four municipalities, 343 prefecturelevel cities, and 42 province directly governed counties. The time
ranges from 2020-01-01 to 2020-05-19. The data, which is an integer

STSIR: Spatial Temporal Pandemic Model with Mobility Data

xiangyang

3000

1000

500

800

400

2000
1500
1000

Confirmed Cases

1200

2500

600
400

0

0
0

20

40

60
80
Days

100

120

140

20

40

wuhan

100

120

140

0

20

40

60
80
Days

100

120

140

huanggang

3000

1200

2500

30000
20000
10000
0
0

20

40

60
80
Days

100

120

140

Confirmed Cases

1000
Confirmed Cases

Confirmed Cases

60
80
Days

suizhou

40000

200

0
0

50000

300

100

200

500

xiantao

600

3500

Confirmed Cases

Confirmed Cases

xiaogan

Conference‚Äô17, July 2017, Washington, DC, USA

800
600
400

2000
1500
1000

200

500

0

0
0

20

40

60
80
Days

100

120

140

Official Confirmed Cases
Simulated Total Cases
0

20

40

60
80
Days

100

120

140

Figure 9: Prediciton results of the STSIR model in major cities in Hubei Province.
Table 4: Prediction Accuracy

Table 3: Dataset Description of DXY COVID-19
Name

Value

Framework

Overall MAE

# Administrative areas
Internal Ô¨Çow time range
# Internal Ô¨Çow Records
Average Increase per day nationwide

388
2020-01-01 2020-05-19
139
597.95

STSIR

7.76

4.3 Prediction Performance
number, presents the overall infected number per day per administrative area. Table 2 summarizes the statistics of the dataset.

4.2

Experiments settings

As China has conducted a strict policy of distancing and quarantine, the whole pandemic in China become relatively stable (Figure
8) during late February, which enables us to test our model by training our model at an early stage, and then feed it with the mobility
index to give the simulated Ô¨Ånal scale of the pandemic. We will
calculate the MAE (Mean Absolute Error) with the genuine Ô¨Ånal
scale of the pandemic by:
ùëò

1 √ï
|ùë¶ùëñ ‚àí ùë•ùëñ |
ùëÄùê¥ùê∏ = ( )
ùëõ ùëñ=1

(26)

In this section, we demonstrate how well our model gives the Ô¨Ånal predictions of the real data. Moreover, the experiments show
the model performs well in giving predictions of the total conÔ¨Årmed cases. As shown in the optimization problem (25), we want
the model can give the current transmission situation based on
the concurrent conÔ¨Årmed cases are given. Because of the asymptomatic character of the COVID-19, there always a delay between
the tested conÔ¨Årmed cases and the real infected cases. During the
experiment, we set the outbreak that has been passed for 50 days,
and the delay between the test and real infection is 20 days. We
then train the model at this stage and try to give the total conÔ¨Årmed
case at the 70 days, based on real intra-city activity and inter-city
activity. As shown in 4, the STSIR model achieves an overall MAE
of 7.76 in predicting the Ô¨Ånal scale of the pandemic, which denotes
its prediction power. As shown in 9, we can see the gap between
the real conÔ¨Årmed cases and the simulated curve. It shows the delay eÔ¨Äect of the case test. When quarantine and distancing policy

Conference‚Äô17, July 2017, Washington, DC, USA

Wang Pan, Qipu Deng, Jiadong Li, Zhi Wang, and Wenwu Zhu

is conducted, the transmission tends to be stopped, and the model
can predict the Ô¨Ånal scale of the pandemic well.

4.4

Policy Analysis

In this section, we conduct experiments on what if there is no
"quarantine" and "shut down" policies are made how severe the
pandemic will go in China. Since the transportation system will be
really activated during the Chinese New Year, the pandemic will
go really mad if no such policies are made. We insert the mobility index last year in the model to see what will happen in Huber
Province. As shown in Figure 10, if we do not shut down Wuhan,
there will be massive infected populations moving to cities near
Wuhan and causing massive infections.

5

CONCLUSION

To tackle the spread of COVID-19, we introduce the STSIR model
to quantify the scale of the pandemic and help to analyze the eÔ¨Äect
of the policies by introducing diÔ¨Äerent mobility indexes. The system is designed to be self-consistent, and a new MSSA algorithm
is introduced to learn the model parameters. Experimental results
verify the eÔ¨Äectiveness of our study. It shows outstanding predicting power and excellent analysis capability.

REFERENCES
[1] Baidu. Inc. Baidu migration data. http://qianxi.baidu.com/.

xiaogan

12000

xiangyang

xiantao
1000

4000

6000
4000

Confirmed Cases

800

8000

Confirmed Cases

Confirmed Cases

10000

3000
2000
1000

2000
0
20

40

60
80
Days

100

120

140

600
400
200

0
0

0
0

20

40

wuhan

60
80
Days

100

120

140

0

20

40

suizhou

50000

60
80
Days

100

120

140

huanggang
7000

25000

6000

40000
30000
20000

15000
10000

10000

5000

0

0
0

20

40

60
80
Days

100

120

140

Confirmed Cases

20000
Confirmed Cases

Confirmed Cases

[2] BlankerL.
Covid-19/2019-ncov infection time series data warehouse.
https://github.com/BlankerL/DXY-COVID-19-Data.
[3] William Ogilvy Kermack and Anderson G McKendrick. A contribution to the
mathematical theory of epidemics. Proceedings of the royal society of london. Series A, Containing papers of a mathematical and physical character, 115(772):700‚Äì
721, 1927.
[4] Marino Gatto, Enrico Bertuzzo, Lorenzo Mari, Stefano Miccoli, Luca Carraro,
Renato Casagrandi, and Andrea Rinaldo. Spread and dynamics of the covid-19
epidemic in italy: EÔ¨Äects of emergency containment measures. Proceedings of
the National Academy of Sciences, 117(19):10484‚Äì10491, 2020.
[5] Can Zhou. Evaluating new evidence in the early dynamics of the novel coronavirus covid-19 outbreak in wuhan, china with real time domestic traÔ¨Éc and
potential asymptomatic transmissions. medRxiv, 2020.
[6] Deqiang Li, Zhicheng Liu, Qinghe Liu, Zefei Gao, Junkai Zhu, Junyan Yang, and
Qiao Wang. Estimating the eÔ¨Écacy of traÔ¨Éc blockage and quarantine for the
epidemic caused by 2019-ncov (covid-19). medRxiv, 2020.
[7] Huwen Wang, Zezhou Wang, Yinqiao Dong, Ruijie Chang, Chen Xu, Xiaoyue
Yu, Shuxian Zhang, Lhakpa Tsamlag, Meili Shang, Jinyan Huang, Ying Wang,
Gang Xu, Tian Shen, Xinxin Zhang, and Yong Cai. Phase-adjusted estimation of
the number of coronavirus disease 2019 cases in wuhan, china. Cell Discovery,
6(1):10, 2020.
[8] Oon-Tek Ng, Kalisvar Marimuthu, Po-Ying Chia, Vanessa Koh, Calvin J. Chiew,
Liang De Wang, Barnaby E. Young, Monica Chan, Shawn Vasoo, Li-Min Ling,
David C. Lye, Kai-qian Kam, Koh-Cheng Thoon, Lalitha Kurupatham, Zubaidah
Said, Ethan Goh, Constance Low, Soon-Kok Lim, Pream Raj, Olivia Oh, Valerie T.J. Koh, Cuiqin Poh, Tze-Minn Mak, Lin Cui, Alex R. Cook, Raymond T.P.
Lin, Yee-Sin Leo, and Vernon J.M. Lee. Sars-cov-2 infection among travelers returning from wuhan, china. New England Journal of Medicine, 382(15):1476‚Äì1478,
2020.
[9] Hien Lau, Veria Khosrawipour, Piotr Kocbach, Agata Mikolajczyk, Hirohito Ichii,
Maciej Zacharksi, Jacek Bania, and Tanja Khosrawipour. The association between international and domestic air traÔ¨Éc and the coronavirus (covid-19) outbreak. Journal of Microbiology, Immunology and Infection, 2020.
[10] Joseph T Wu, Kathy Leung, and Gabriel M Leung. Nowcasting and forecasting the potential domestic and international spread of the 2019-ncov outbreak

5000
4000
3000
2000
1000

Official Confirmed Cases
Simulated Total Cases

0
0

20

40

60
80
Days

100

120

140

0

20

40

60
80
Days

Figure 10: Policy evaluating results of the STSIR model in major cities in Hubei Province.

100

120

140

STSIR: Spatial Temporal Pandemic Model with Mobility Data

[11]
[12]
[13]

[14]
[15]
[16]

originating in wuhan, china: a modelling study. The Lancet, 395(10225):689‚Äì697,
2020.
Pai Liu, Payton Beeler, and Rajan K Chakrabarty. Covid-19 progression timeline
and eÔ¨Äectiveness of response-to-spread interventions across the united states.
medRxiv, 2020.
Daniel Shu Wei Ting, Lawrence Carin, Victor Dzau, and Tien Y. Wong. Digital
technology and covid-19. Nature Medicine, 26(4):459‚Äì461, 2020.
Caroline O. Buckee, Satchit Balsari, Jennifer Chan, Merc√® Crosas, Francesca Dominici, Urs Gasser, Yonatan H. Grad, Bryan Grenfell, M. Elizabeth Halloran,
Moritz U. G. Kraemer, Marc Lipsitch, C. Jessica E. Metcalf, Lauren Ancel Meyers,
T. Alex Perkins, Mauricio Santillana, Samuel V. Scarpino, Cecile Viboud, Amy
Wesolowski, and Andrew Schroeder. Aggregated mobility data could help Ô¨Åght
covid-19. Science, 368(6487):145‚Äì146, 2020.
Marcello Ienca and EÔ¨Äy Vayena. On the responsible use of digital data to tackle
the covid-19 pandemic. Nature Medicine, 26(4):463‚Äì464, 2020.
Raquel P√©rez Arnal, David Conesa, Sergio Alvarez-Napagao, Toyotaro Suzumura, Mart√≠ Catal√†, Enric Alvarez, and Dario Garcia-Gasulla. Private sources
of mobility data under covid-19. arXiv preprint arXiv:2007.07095, 2020.
Emanuele Pepe, Paolo Bajardi, Laetitia Gauvin, Filippo Privitera, Brennan Lake,
Ciro Cattuto, and Michele Tizzoni. Covid-19 outbreak response, a dataset to

Conference‚Äô17, July 2017, Washington, DC, USA

[17]
[18]

[19]
[20]

assess mobility changes in italy following national lockdown. ScientiÔ¨Åc Data,
7(1):230, 2020.
Jayson S. Jia, Xin Lu, Yun Yuan, Ge Xu, Jianmin Jia, and Nicholas A. Christakis.
Population Ô¨Çow drives spatio-temporal distribution of covid-19 in china. Nature,
582(7812):389‚Äì394, 2020.
Qun Li, Xuhua Guan, Peng Wu, Xiaoye Wang, Lei Zhou, Yeqing Tong, Ruiqi Ren,
Kathy S.M. Leung, Eric H.Y. Lau, Jessica Y. Wong, Xuesen Xing, Nijuan Xiang,
Yang Wu, Chao Li, Qi Chen, Dan Li, Tian Liu, Jing Zhao, Man Liu, Wenxiao Tu,
Chuding Chen, Lianmei Jin, Rui Yang, Qi Wang, Suhua Zhou, Rui Wang, Hui
Liu, Yinbo Luo, Yuan Liu, Ge Shao, Huan Li, Zhongfa Tao, Yang Yang, Zhiqiang
Deng, Boxi Liu, Zhitao Ma, Yanping Zhang, Guoqing Shi, Tommy T.Y. Lam,
Joseph T. Wu, George F. Gao, Benjamin J. Cowling, Bo Yang, Gabriel M. Leung,
and Zijian Feng. Early transmission dynamics in wuhan, china, of novel coronavirus‚Äìinfected pneumonia. New England Journal of Medicine, 382(13):1199‚Äì
1207, 2020. PMID: 31995857.
Scott Kirkpatrick, C Daniel Gelatt, and Mario P Vecchi. Optimization by simulated annealing. science, 220(4598):671‚Äì680, 1983.
Balram Suman and Prabhat Kumar. A survey of simulated annealing as a tool
for single and multiobjective optimization. Journal of the operational research
society, 57(10):1143‚Äì1160, 2006.

250
200
150
100
50
Official Confirmed Cases
Simulated Total Cases

0
0

20

40

60

80

100

120

140

huanggang
3000

Confirmed Cases

2500
2000
1500
1000
500
Official Confirmed Cases
Simulated Total Cases

0
0

20

40

60

Days

80

100

120

140

1600
1400
1200
1000
800
600
400
200

Official Confirmed Cases
Simulated Total Cases

0
0

20

40

60

80

100

120

140

wuhan
50000

Confirmed Cases

40000
30000
20000
10000
Official Confirmed Cases
Simulated Total Cases

0
0

20

40

60

Days

80

100

120

140

xiaogan
3500

Confirmed Cases

3000
2500
2000
1500
1000
500

Official Confirmed Cases
Simulated Total Cases

0
0

20

40

60

Days

80

100

120

140

800
600
400
200
Official Confirmed Cases
Simulated Total Cases

0
0

20

40

60

80

100

120

140

