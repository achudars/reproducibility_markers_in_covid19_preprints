arXiv:2106.07919v1 [eess.SP] 15 Jun 2021

A STOCHASTIC METAPOPULATION STATE - SPACE APPROACH TO
MODELING AND ESTIMATING C OVID -19 SPREAD

Yukun Tan
Department of Electrical and Computer Engineering
Texas A&M University
College Station, TX, 77843
yukuntan@tamu.edu
Martial Ndeffo-Mbah
Veterinary Integrative Biosciences
College of Veterinary Medicine and Biomedical Sciences
Texas A&M University
College Station, TX, 77843
mndeffo@cvm.tamu.edu

Durward Cator III
Department of Electrical and Computer Engineering
Texas A&M University
College Station, TX, 77843
tac464@tamu.edu
Ulisses Braga-Neto ∗
Department of Electrical and Computer Engineering
Texas A&M University
College Station, TX, 77843
ulisses@tamu.edu

June 16, 2021

A BSTRACT
Mathematical models are widely recognized as an important tool for analyzing and understanding
the dynamics of infectious disease outbreaks, predict their future trends, and evaluate public
health intervention measures for disease control and elimination. We propose a novel stochastic
metapopulation state-space model for COVID-19 transmission, based on a discrete-time spatiotemporal susceptible/exposed/infected/recovered/deceased (SEIRD) model. The proposed framework
allows the hidden SEIRD states and unknown transmission parameters to be estimated from noisy,
incomplete time series of reported epidemiological data, by application of unscented Kalman filtering
(UKF), maximum-likelihood adaptive filtering, and metaheuristic optimization. Experiments using
both synthetic data and real data from the Fall 2020 Covid-19 wave in the state of Texas demonstrate
the effectiveness of the proposed model.
Keywords epidemic model · SEIRD model · nonlinear stochastic model · unscented Kalman filter · maximum
likelihood · adaptive filtering · parameter estimation

1

Introduction

Infectious disease outbreaks remain a major threat to global health. This is especially the case for highly pathogenic and
transmissible diseases with pandemic potential. These global threats were recently exemplified by the 2009 swine flu
outbreak and the ongoing COVID-19 pandemic caused by the novel Severe Acute Respiratory Syndrome coronavirus
2 (SARS-CoV-2). To effectively mitigate and control the spread of an epidemic, it is paramount for public health
decision-making to be informed by an accurate understanding of the dynamics of disease transmission and the potential
impact of intervention measures. To this end, epidemic models have become an important tool to help better understand
epidemic dynamics, predict its future trends, evaluate the effectiveness of intervention measures, such as lock-down or
vaccination, and ultimately control the epidemic.
Mathematical epidemiology models can be broadly divided into two main types: compartmental models and agent-based
models. An agent-based model is a very detailed stochastic model where the agent represent single individuals within
a population Degli Atti et al. [2008], Perez and Dragicevic [2009], Hunter et al. [2018], Chang et al. [2020], Chao
∗

Corresponding author

et al. [2020], Koo et al. [2020], Kretzschmar et al. [2020], Kerr et al. [2020]. Such models are generally complex and
computationally expensive. In compartmental models, the population is subdivided into epidemiological compartments
with each compartmental generally representing a health or disease progression stage Balcan et al. [2010], Dukic et al.
[2012], Osthus et al. [2017], Sebastian and Victor [2017], Keeling et al. [2020], Sameni [2020], Godio et al. [2020],
Kobayashi et al. [2020]. Thus compartmental models are computationally simple, scalable, and capable of describing
the dynamics of the number of people in each compartment throughout the course of an epidemic. In this work, we
propose a nonlinear state-space compartmental model.
Compartmental model date back to the early twentieth century, most notably to the work by Kermack and McKendrick
[1927], whose susceptible/infected/recovered (SIR) model was used for modeling the plague (London 1665-1666,
Bombay 1906) and cholera (London 1865) epidemics Dukic et al. [2012]. More specifically, it is a weighted directed
graph representation of a dynamic system. The susceptible refers to those healthy people who are susceptible to the
disease and may get infected; the infected refers to those under infection; the recovered refers to those who recovered
from infection and will be temporarily or permanently immune to the disease. However, there are several drawbacks in
the original SIR model:
1) It is a deterministic model, meaning the model always performs the same for a given initial condition, which
cannot explain the unknowable randomness in the observations Sebastian and Victor [2017], Hooker et al.
[2011], Kobayashi et al. [2020];
2) It is only a temporal model, which does not consider the spread in geographical regions, e.g. human interaction
induced by modern transportation Zhong et al. [2009];
3) It assumes that all the parameters are known, which is not realistic. Parameter estimation from noisy
observations is needed for better understanding and forecasting epidemics Hooker et al. [2011].
Many variants SIR models have been proposed to address some of these issues, but accurate state and parameter
estimation from partial and noisy observations remains an open problem. To‘ handle this issue, our proposed framework
embeds the classical compartmental model within a nonlinear state-space model. The state model is a spatial-temporal
stochastic dynamic model that allows hidden states in a given location to change over time and the disease dynamics in
one location to affect neighbouring locations through human movements between locations. The proposed framework
consists of a multinomial state model based on a variant of the SIR model — the SEIRD model Rapolu et al. [2020],
Piccolomiini and Zama [2020], Korolev [2021] — and an observation model to allow the assimilation of publicly
available data, including daily testing rate, daily test positivity rate, specificity and sensitivity of the tests. In addition,
the model considers the differential testing rate between symptomatic patients and asymptomatic and healthy individuals.
The proposed framework is employed to estimate i) the hidden epidemic state vector X t = (S t , E t , I t , Rt , Dt ) and ii)
epidemiological parameters, such as infection rate and the average infectious period, using noisy incomplete time series
epidemic data. Accurate estimation of the true epidemic state and parameters is paramount for designing and evaluating
the effectiveness of control strategies.

2
2.1

Mathematical model
Classical SEIRD model

The SEIRD model predicts the time evolution of epidemic. It models the dynamic interaction of people between five
different compartments, namely, the susceptible (S), the exposed (E), the infected (I), the recovered (R) and the deceased
(D). The classic continuous-time SEIRD model can be described by the following equations:
dS(t)
= −λS S(t)I(t)
dt
dE(t)
= λS S(t)I(t) − λE E(t)
dt
dI(t)
(1)
= λE E(t) − (λR + λD )I(t)
dt
dR(t)
= λR I(t)
dt
dD(t)
= λD I(t)
dt
with S(t) + E(t) + I(t) + R(t) + D(t) = 1, where S(t), E(t), I(t), R(t), D(t) are the fraction of the population
(the size of which is assumed to be constant over the time interval of interest) at time t that, respectively, S is not yet
2

infected with the disease; E has been exposed to the virus but does not show symptoms yet; I is infective after the virus
incubation period; R has been infected and then recovered; and D is deceased due to the epidemic.
The model is governed by the following parameters:
• λS is the infection rate, which is the probability that an individual moves from the S to the E compartment.
The nonlinear term λS I(t)S(t) models the infection speed, which depends not only on the infection rate, but
also on the fraction of susceptible and infected people at time t;
• λE is the probability that an individual moves from the E to the I compartment. It can be understood as the
inverse of the average incubation time;
• λR is the recovery rate, which is the probability than an individual moves from the I to the R compartment. It
can be understodd as the inverse of the average recovery time;
• λD is the mortality rate, which is the probability than an individual moves from the I to the D compartment.
2.2

Covid-19 epidemic metapopulation state-space model

Given the complexity and reality of epidemics, many different implementations of the classical SEIRD model have
been proposed Loli Piccolomini and Zama [2020], Korolev [2021], Tiwari et al. [2020], Rapolu et al. [2020]. Two clear
drawbacks of the classical SEIRD model is the inability to model variation over a geographic area, and the fact that
that the SEIRD values are assumed to be directly observable. In this paper, we address these drawbacks by means of a
novel nonlinear metapolulation state-space framework, where the state process provides a spatial-temporal discrete-time
stochastic model of the evolution of the number of individuals in the SEIRD compartments over several geographical
regions, while the observation process models noisy time series of reported epidemiological data, considering the
accuracy of tests and different testing rates for symptomatic and asymptomatic people.
2.2.1

State model

Consider a discrete-time state process {Xti ; i = 1, . . . , G; t = 0, 1, . . . }, where Xti = (Sit , Eit , Iit , Rit , Dit ) is a state
vector, containing the number of individuals in the SEIRD compartments in geographical area i at time t, where the unit
of time is typically day or week. At time t, the total number of individuals in region i is Ni = Sit + Eit + Iit + Rit + Dit .
We assume that this number stays constant over the time interval of interest (e.g., no significant amounts of migration is
assumed to occur during the time interval of interest; plus , births and non-specific deaths are assumed to approximately
balance out). This results in a good approximation provided that the interval of time in consideration consists of weeks
or a few months, especially in the case of a full-blown outbreak when, the impact of migration is negligible.
Before proceeding, we recall the definition of the binomial and multinomial probability distributions. A random variable
Z has a binomial distribution with parameters n ≥ 1 and 0 < p < 1, denoted by Z ∼ Binomial(n, p), if
n!
P (Z = k) =
pk (1 − p)n−k , k = 0, . . . , n .
(2)
k!(n − k)!
where n! = n × n − 1 × · · · 1, with 0! = 1. Variable Z is the number of k occurrences of an outcome among n
identical independent trials that can result in the outcome with probability p. The expected value and variance of
this variable are E[Z] = np and Var(Z) = np(1 − p), respectively. More generally, we define a random
P vector
(Z1 , . . . , ZM ) to have a multinomial distribution with parameters n ≥ 1 and p1 , . . . , pM ≥ 0 such that
pi ≤ 1,
denoted by (Z1 , . . . , ZM ) ∼ Multinomial(n, p1 , . . . , pM ), if
n!
P (Z1 = k1 , . . . , ZM = kM ) =
pk1 · · · pkMM (1−Σpi )n−Σki , k1 , . . . , kM ≥ 0, Σki ≤ n . (3)
k1 ! · · · kM !(n−Σki )! 1
Variables Z1 , . . . , ZM are the number of occurrences of each of M outcomes over n identical independent trials
that can result in outcome m with probability pm . It is clear that Zm ∼ Binomial(n, pm ), for m = 1, . . . , M (thus
E[Zm ] = npm and Var(Zm ) = npm (1 − pm )). In addition, the case M = 1 results in the binomial distribution.
In our model, the state vector Xti = (Sit , Eit , Iit , Rit , Dit ) is assumed to evolve according to the following nonlinear
stochastic model:
Sit+1 = Sit − Σj NSt i,j
Eit+1 = Eit + Σj NSt i,j − NEt i
t
Iit+1 = Iit + NEt i − NRt i − ND
i

Rit+1 = Rit + NRt i
t
Dit+1 = Dit + ND
i

3

(4)

for t = 0, 1, . . ., where NSt i,j is the number of susceptible individuals at time t in region i who will become exposed at
time t + 1 due to contact with an infective individual from region j, NEt i is the number of exposed people at time t in
t
region i who will become infective at time t + 1, while NRt i and ND
are the numbers of infected people at time t in
i
region i who will become recovered or deceased at time t + 1, respectively.
We assume that each susceptible individual in region i becomes exposed due to contact with an infective individual
from region j at time t independently with a probability λS cij Ijt /Nj (these parameters are explained below). Therefore,
the distribution of the numbers of new infections over the regions is multinomial:
!
t
ci1 I1t
ciG IG
t
t
t
(NSi,1 , . . . , NSi,G ) ∼ Multinomial Si , λS
, . . . , λS
.
(5)
N1
NG
The infection rate λS > 0 is disease-specific, but also affected by public policies, such as mask wearing and social
distancing. We assume that these factors are constant over the geographical area (e.g., a single political unit, such as
a state or country) and time interval in the study, so that λS is the same for all regions. If i = j, then the contact is
internal to region i, and cii = 1. If i 6= j, then 0 ≤ cij ≤ 1 models the relative amount of transient interchange of
individuals between regions i and j, due to commuting, tourism, and so on. If regions i and j are far apart, or one of
them is not economically important, then cij is close to zero. Note that cij = cji . The specific values of cij are selected
in our study based on the gravity model Zipf [1946], Truscott and Ferguson [2012], Chen et al. [2021]; Finally, the
ratio Ijt /Nj indicates that if there are more infective individuals in region j, they will spread the disease with higher
probability. Note that the expected value of the (normalized) j-th flux is E[NSt i,j /Ni ] = λS cij (Sit /Ni )(Ijt /Nj ). This
may be contrasted to the flux λS S(t)I(t) in the classical case.
In our model, an exposed individual in region i becomes infective at time t, independently of the other regions, with
probability λE . Hence,
NEt i ∼ Binomial(Eit , λE ) .
(6)
The expected number of exposed individuals who become infective at time t is thus E[NEt i ] = λE Eit . Note also that
the distribution of the total time until an exposed individual becomes infective is geometric with parameter λE , so that
the expected number of time units until an exposed individual becomes infective is λ−1
E .
Finally, each infective individual in region i becomes recovered or deceased at time t, independently of the other regions,
with probabilities λR and λD , respectively. Hence,
t
(NRt i , ND
) ∼ Multinomial(Iit , λR , λD ) .
i

(7)

The expected numbers of infective individuals who become recovered or deceased at time t are E[NRt i ] = λR Iit and
t
E[ND
] = λD Iit , respectively. The expected numbers of time units until an infective individual becomes recovered or
i
−1
deceased are λ−1
R and λD , respectively.
2.2.2

Observation model

The observation model is a major contribution of this work. We model reported epidemiological data, namely confirmed
new cases and cumulative recorded deaths, as noisy observations on the true state of the pandemic, as defined in the
previous section. The proposed observation model addresses the uncertainty introduced by imperfect testing and the
imbalance in testing of symptomatic and asymptomatic individuals (the former cohort is tested more Allen et al. [2020]).
We model the reported data as a time series {Yit ; i = 1, . . . , G; t = 0, 1, . . . } where Yit = (Pit , Qti ) contains the
numbers Pit and Qti of new confirmed cases and deaths, respectively, in geographical area i at time t. The number of
reported new cases contain both false and true positives,
Pit = NTt Pi + NFt Pi ,

(8)

for t = 0, 1, , . . ., where NTt Pi and NFt Pi are the number of false and true testing positives, respectively. Let α and β
be the false positive and true positive rates, respectively, of the Covid-19 test under consideration (multiple tests of
different accuracy can be introduced by splitting the populations according to the test received). True positives come
from the exposed and infective populations. In addition, a percentage of the infective population is asymptomatic; we
assume that those are tested at a smaller rate than the symptomatic ones. Accordingly, we split the number of new
true positives at time t as the sum of the number of positive-tested symptomatic infective people and the number of
positive-tested asymptomatic infective and exposed individuals:
NTt Pi ∼ Binomial(εt2 (1 − εt4 )Iit , β) + Binomial(εt1 (εt4 Iit + Eit ), β) ,
4

(9)

where εt1 and εt2 are the testing rates of asymptomatic and symptomatic individuals at time t, respectively, while εt4 is
the percentage of infective individuals who are asymptomatic at time t. These parameters are assumed to be the same
over all regions. As shown later, these parameters can be calculated from the overall testing and positivity rates, which
are available from public records.
Similarly, the false positives come from the susceptible and recovered populations, and here we have to distinguish
between symptomatic individuals (who are not infected by Covid-19 but instead by other similar viruses, such as
Influenza) and asymptomatic individuals:
NFt Pi ∼ Binomial(εt1 (1 − εt3 )(Sit + Rit ), α) + Binomial(εt2 εt3 (Sit + Rit ), α) ,

(10)

where εt3 is the percentage of non-specific symptomatic individuals at time t.
Finally, we assume that the reported cumulative recorded deaths in each region is a fraction of the true number Dit ,
according to
Qti ∼ Binomial(Dit , β) .
(11)
Even though there might be a number of non-Covid-19 deaths falsely reported as Covid-19, we are assuming that this
number is small and can be ignored. Notice that (11) implies that Covid-19 deaths are underreported, which is widely
assumed to be the case.
t
Let RTt be the testing rate, i.e., the percentage of the population that is tested at time t, and let RP
the positivity rate at
time t. Both these parameters are reported by health authorities. Next, we show how the parameters εt1 , εt2 , εt3 , and εt4
t
can be calculated from RTt and RP
t
The test positivity rate (RP
) is the percentage of positive tests P t over the total number of tests NTt in a given region; it
can be written as
Pt
εt Aα + εt2 Bα + εt2 Cβ + εt1 Dβ
t
RP
= t = 1 t
(12)
NT
ε1 A + εt2 B + εt2 C + εt1 D

where A = (1 − εt3 )(S t + Rt ), B = εt3 (S t + Rt ), C = (1 − εt4 )I t , and D = εt4 I t + E t .
Similarly, the testing rate RTt is the percentage of total tests over the total population, which can be written as
RTt =

NTt
εt1 A + εt2 B + εt2 C + εt1 D
=
Nt
A+B+C +D

(13)

Using the previous two equations, we can solve for εt1 and εt2 in terms of εt3 and εt4 :
εt1 =

(S t + E t + I t + Rt )RTt (RP t (εt3 (S t + Rt ) + (1 − εt4 )I t ) − αεt3 (S t + Rt ) − β(1 − εt4 )I t )
(β − α)(εt3 (S t + Rt )(εt4 I t + E t ) − (1 − εt3 )(S t + Rt )(1 − εt4 )I t )

εt2 =

(S t + E t + I t + Rt )RTt
×
β−α

(14)

α(1 − εt3 )(S t + Rt ) + β(εt4 I t + E t ) − RP t ((1 − εt3 )(S t + Rt ) + (εt4 I t + E t ))
εt3 (S t + Rt )(εt4 I t + E t ) − (1 − εt3 )(S t + Rt )(1 − εt4 )I t
Now, εt1 and εt2 are the testing rates of asymptomatic and symptomatic individuals at time t, and can be related to each
other. According to Allen et al. [2020], we have
εt2 = ζεt1 ,
(15)
where ζ is uniformly distributed in the interval [2, 4.3] to account for various non-specific symptoms (e.g., fever, cough,
loss of taste/smell) that are shared by Covid-19 and other common viral diseases. Substituting (15) into (14) results,
after some algebra, in the following expression for εt3
εt3 =

t
t
t
(β − RP
)(εt4 I t + E t ) + ζ(1 − εt4 )I t (β − RP
) − (S t + Rt )(RP
− α)
t − α)
(ζ − 1)(S t + Rt )(RP

(16)

In addition, according to Buitrago-Garcia et al. [2020], the percentage of asymptomatic infective people εt4 is around
0.2 and from this the other parameters εt1 , εt2 , εt3 can be calculated.
5

3

Covid-19 epidemic state and parameter estimation

In this section, we describe state-of-the-art estimators for the state and parameters of the metapopulation state-space
model introduced in the previous section. These estimators use an input the noisy time series Yit = (Pit , Qti ) of reported
new cases and deaths in the several geographical regions in the study. The state vector Xti = (Sit , Eit , Iit , Rit , Dit ) is
estimated at each time t by using the Unscented Kalman Filter (UKF) Wan and Van Der Merwe [2000], which is the
state-of-the-art estimator for stochastic nonlinear state-space models, while the parameters λS , λR , λD are estimated by
maximum-likelihood, by using the metaheuristic optimization - fish school search algorithm Bastos Filho et al. [2008],
Bastos-Filho and Nascimento [2013], Tan et al. [2020].
First, we write the state-space model in the previous section in the standard form
Xt+1
= f (Xti ) + nti
i

(17)

Yit = h (Xti ) + vit

where f and h are nonlinear mappings, and {nti ; i = 1, . . . , G; t = 0, 1, . . . } and {vit ; i = 1, . . . , G; t = 0, 1, . . . } are
white-noise (i.e., uncorrelated in time) transition and observation noise processes, respectively, which are independent
of each other and independent of the initial state {X0i ; i = 1, . . . , G}.
The proposed state-space model can be put in the standard form (17) by rewriting the state equations as:


Sit+1 = 1 − λS Σj cij Ijt /Nj × Sit + ntSi


Eit+1 = (1 − λE ) × Eit + λS Σj cij Ijt /Nj × Sit + ntEi
Iit+1 = (1 − λR − λD ) × Iit + λE × Eit + ntIi

(18)

Rit+1 = Rit + λR × Iit + ntRi
Dit+1 = Dit + λD × Iit + ntDi
where the transition noise terms are:


ntSi = −Σj NSt i,j − E[NSt i,j ]


= −Σj NSt i,j − λS cij Sit Ijt /Nj



ntEi = − NEt i − E[NEt i ] + Σj NSt i,j − E[NSt i,j ]



= − NEt i − λE Eit + Σj NSt i,j − λS cij Sit Ijt /Nj
ntIi =
=
ntRi =
ntDi =

(19)


t
t
NEt i − E[NEt i ] − NRt i − E[NRt i ] − ND
− E[ND
]
i
i



t
NEt i − λE Eit − NRt i − λR Iit − ND
− λD Iit
i


NRt i − E[NRt i ] = NRt i − λR Iit


t
t
t
ND
− E[ND
] = ND
− λD Iit
i
i
i




Similarly, the observation model can be rewritten in the standard form (17):


Pit = β εt2 1 − εt4 Iit + β εt1 εt4 Iit + Eit



+ α εt1 1 − εt3 Sit + Rit + α εt2 εt3 Sit + Rit + vPt i

(20)

t
Qti = β Dit + vQ
i

where the observation noise terms are:
vPt i = NTt Pi − E[NTt Pi ] + NFt Pi − E[NFt Pi ]
= NTt Pi − β (εt2 (1 − εt4 )Iit + εt1 (εt4 Iit + Eit ))
+ NFt Pi − α (εt1 (1 − εt3 )(Sit + Rit ) + εt2 εt3 (Sit + Rit ))
t
vQ
= DTt Pi − E[DTt Pi ] = DTt Pi − β Dit
i

6

(21)

3.1

Unscented Kalman filter

With the state-space model in the standard format (17), one can apply the Unscented Kalman Filter (UKF) algorithm
Wan and Van Der Merwe [2000], Simon [2006], Särkkä [2013] to estimate the state variables (Sit , Eit , Iit , Rit , Dit ) from
the noisy data (Pit , Qti ) of new cases and cumulative deaths in geographical area i at time t. The UKF assumes that the
statistics of the state variables at time t = 0 are known (in practice, these values need to be only very roughly guessed
since, as the time t increases, the UKF generally “forgets” the information in the initial state). It also assumes that all
the parameters are known; however, in the next section we describe a methodology to estimate the parameters from the
data as well.
In the UKF algorithm, mt|t and Pt|t denote the estimates at time t of the mean and error covariance
matrix, respectively, of the state vector Xt = (S t , E t , I t , R, Dt ) using all observed data up to
time t (for brevity, the subscript i used previously to discriminate the region is omitted throughout this
section, since the same process is applied to all regions separately). We initalize the mean vector via
E[I 0 ] = E[E 0 ] = P 0 , E[R0 ] = 0, E[D0 ] = Q0 /β, and E[S 0 ] = N − E[I 0 + E 0 + R0 + D0 ], while the
covariance matrix is initialized to the identity matrix. The UKF estimate of the state Xt is mt|t , with uncertainty given
by Pt|t . These estimates are computed by the following iteration:
Initialization: Given the initial observation Y0 = (P 0 , Q0 ), let
m0|0 = (N − 2P 0 − D0 /β, P 0 , P 0 , 0, Q0 /β) ,

P0|0 = I .

(22)

For t = 1, 2, . . . repeat:
Prediction:
1) Generate (2n+1) sigma points,
z0t−1|t−1 = mt−1|t−1 ,
zit−1|t−1 = mt−1|t−1 +


q
nPt−1|t−1 ,

i = 1, . . . , n ,

i

zi+n
t−1|t−1

q

= mt−1|t−1 −
nPt−1|t−1

,

(23)

i = n + 1, . . . , 2n ,

i−n

where

hp

nPt−1|t−1

i
i

is the i-th column of the matrix square root.

2) Propagate the sigma points through the state equation:
xit = f (zit−1|t−1 ) ,

i = 0, . . . , 2n

(24)

3) Compute predicted mean and predicted error covariance:
2n

mt|t−1 =

1 X i
x̂ ,
2n i=0 t

(25)

2n

Pt|t−1

1 X i
=
(x̂ − mt|t−1 ) × (x̂it − mt|t−1 )T + Qt−1 ,
2n i=0 t

where Qt−1 is the covariance matrix of the transition noise (see the Appendix for its derivation).
Update:
7

1) Update sigma points based on the predicted mean and error covariance:
z0t|t−1 = mt|t−1 ,
zit|t−1

= mt|t−1 +

q


nPt|t−1

,

i = 1, . . . , n ,

i

zi+n
t|t−1 = mt|t−1 −

q

(26)


nPt|t−1

,

i = n + 1, . . . , 2n .

i−n

2) Propagate the sigma point through the observation equation:
ŷti = h(zit|t−1 ) ,

i = 0, . . . , n .

(27)

3) Compute predicted measurement mean, measurement covariance matrix, and cross-covariance matrix:
2n

µt =

1 X i
ŷ ,
2n i=0 t

St =

1 X i
(ŷ − µt )(ŷti − µt )T + Rt ,
2n i=0 t

Ct =

1 X i
(z
− mt|t−1 )(ŷti − µt )T ,
2n i=0 t|t−1

2n

(28)

2n

where Rt−1 is the covariance matrix of the observation noise (see the Appendix for its derivation).
4) Compute the filter gain and new state error covariance matrix. Assimilate the observation Yt at time t to find new
state mean vector mt|t :
Kt = Ct S−1
t ,
mt|t = mt|t−1 + Kt (Yt − µt ),

(29)

Pt|t = Pt|t−1 − Kt St KTt .
3.2

Maximum-likelihood adaptive filtering

The UKF algorithm requires that all parameter values be known. The parameters that govern the proposed model in
(18) and (8) are λS , λE , λR , λD , α, β, ε1 , ε2 , ε3 , and ε4 . Of these, α and β are known, while ε1 through ε4 can be
obtained using the procedure described in Section 2.2.2. Among the λ parameters, some may be known a priori, but
others may be unknown. Let θ be a vector containing these parameters. Accurate estimation of θ from the observed
data is key to make the proposed methodology useful in practice. We estimate θ using maximum-likelihood method in
combination with the UKF, which is known as maximum-likelihood adaptive filtering Ito and Xiong [2000], Wu et al.
[2006], Kokkala et al. [2015].
Let Y0:t = {Y0 , Y1 , . . . , Yt } denote the observed data up to time t. The log-likelihood of the model parameters θ at
time t is given by:
h
i
Lt (θ) = log pθ (Y0:t ) = log pθ (Yt | Y0:t−1 )pθ (Yt−1 | Y0:t−2 ) · · · pθ (Y1 | Y0 )pθ (Y0 )
(30)
= Lt−1 (θ) + log pθ (Yt | Y0:t−1 ) ,
where

1
1
(31)
log |2π St (θ)| − VtT (θ) S−1
t (θ) Vt (θ) ,
2
2
with Vt = Yt − µt . The quantities µt and St are calculated in the UKF recursion. Then, the target is to maximize the
log-likelihood Lt (θ),
θ̂M L = arg max Lt (θ) .
(32)
pθ (Yt | Y0:t−1 ) = −

θ

There are several possible ways to address this optimization problem. For example, one can apply the ExpectationMaximization (EM) algorithm, which is especially effective when there is a closed-form solution for the “M”
8

maximization step, which avoids recursive gradient calculation. However, there is no such closed-form solution
in our case. Other gradient-based optmization methods did not produce good results. Instead, we used biology-inspired
metaheuristic optimization, in this case, the Fish School Search (FSS) algorithm Bastos Filho et al. [2008], Bastos-Filho
and Nascimento [2013], which we had already applied with success in our previous work Tan et al. [2020]. For the
details about the FSS algorithm, please see Bastos Filho et al. [2008], Bastos-Filho and Nascimento [2013], Tan et al.
[2020].

4

Numerical experiments

In this section, we present the results of numerical experiments, using synthetic and real data from the state of Texas in
the United States. We divided Texas into 11 regions, based on the Texas Health and Human Services (HHS) regional
map.
Sections 4.1 and 4.2 assume the parameter values displayed in Table 1 (unless stated otherwise). The COVID-19 test
false positive rate α and false negative rate 1 − β are based on Asai [2020]; the infection rate λS , mean incubation
period 1/λE , and mean recovery time 1/λR are consistent with CDC data; while the mortality rate λD is based on
publicly reported data in Texas. The values for εt1 through εt4 are computed as described in Section 2.2.2. On the other
hand, in Section 4.3, the methodology was applied to real Covid-19 epidemic data.
Table 1: Parameter values for numerical experiments (section 4.1, 4.2)
Parameter
Value
Test false positive rate (α)
0.01
Test false negative rate (1 − β)
0.15
Infection rate (λS )
0.4
Mean incubation period (1/λE )
10 (days)
Mean recovery time (1/λR )
14 (days)
Mortality rate (λD )
0.01
εt1 , εt2 , εt3 , εt4
0.03, 0.1, 0.1, 0.2
4.1

Forward prediction of epidemic dynamics

Here we illustrate the proposed model’s ability to predict the spatial and temporal dynamics of epidemic, assuming the
parameter values displayed in Table 1. We ran the model for a period of 200 days. Fig 1 displays the results at day 1,
day 60, day 90, and day 100. In this simulation, the epidemic is assumed to have originated in region 1 with only a few
infective individuals, as can be seen in the upper left diagram of Fig 1. After 60 days, the pandemic has spread to other
regions, but it is still very limited. However, after 90 days, i.e., only 30 days after the previous snapshot, the epidemic
has spread much more widely, especially in the originating region 1, as well as regions with large populational density,
e.g. region 3 and region 6, which is where Dallas and Houston are located, respectively. Finally, after only another 10
days, the number of infected individuals has almost doubled. These results show that the epidemic may be easier to
control at an early stage. They also show that if the epidemic is allowed to run its course, it will spread at an exponential
rate after a period of time. These predictions underscore the need for early-stage public health interventions, such as
social distancing, mask wearing, or a limited lockdown in the critical originating region 1.
4.2

State and parameter estimation from synthetic data

In this section, we investigate the ability of the proposed maximum-likelihood adaptive filtering methodology in
recovering both the hidden state and all unknown parameters of the pandemic from a synthetic time series of reported
new cases and deaths. The synthetic data allow us to evaluate the performance of the methodology against the simulated
ground truth.
In the first experiment, we assume that the parameter values (see Table 1) are known and we evaluate the ability of
the filtering methodology to recover the hidden SEIRD state from the synthetic times series. Although in practice
not all parameters would be known, this experiment allows us to evaluate the pure state estimation capabilities of the
algorithm. Figure 2 displays the results over region 1 (the behavior was similar over all other regions). We can see that
the maximum-likelihood adaptive filter can track the state evolution remarkably well.
In the second experiment, we remove the assumption that the infection rate, mean recovery time, and mortality rate
parameters are known, and evaluate the performance of the methodology in recovering the values of these parameters.
9

Figure 1: Prediction of Covid-19 spread over the state of Texas after 1, 60, 90, and 100 days from initial infection.
This is a difficult problem, since the states are also unknown, and the algorithm must perform simultaneous state and
parameter estimation. Table 2 shows that the algorithm produced estimated parameter values that are close to the
groundtruth values. Figure 3 displays state estimation results when the estimated parameters are plugged in for the
unknown parameters. We can see that the results are not quite as good as the case where all parameters are known, in
Figure 2, but the proposed methodology is still able to track the state evolution well.
Table 2: Parameter estimation with synthetic data.
Parameter
Groundtruth
Estimated Value
Infection rate (λS )
0.4
0.451
Mean recovery time (1/λR )
14 (days)
12.05 (days)
Mortality rate (λD )
0.01
0.0121
4.3

State and Parameter Estimation using Johns Hopkins University Covid-19 Data

In this experiment, we demonstrate the performance of the algorithm on Texas Covid-19 data from the Center for
Systems Science and Engineering (CSSE) at Johns Hopkins University Dong E. Due to the presence of delayed
reporting, there is often incorrect data in the early part of the week and corrections at the end of the week. To address
this, we consider the time unit to be week, not day, and average the daily reported data (from Sunday to Saturday) to
produce one data point for the week. The data used in this experiment is from the week of Oct 4th, 2020 to the week
10

Figure 2: State estimation in region 1 with all parameter values known.

Figure 3: State estimation in region 1 using estimated parameter values.

11

Figure 4: Prediction of new cases using JHU Covid-19 data over region 3. The blue line represents the actual observed
data, the red dashed line are the predicted values in the time interval where the observed data is known.
of Feb 1st, 2021, which is from the third (Fall 2020) wave of the COVID-19 epidemic in the United States. In this
experiment, we only use data from four big regions (3, 6, 7, 8), which contain Dallas, Houston, Austin and San Antonio,
which are the most reliable data available.
We assume that only the test false positive rate, false negative rate and the mean incubation time are known. However,
the value of the latter in Table 1 is based on a daily time unit, so here the value used is 10/7, or λE = 0.7. All estimated
rates obtained by the algorithm in this experiment can be divided by 7 in order to obtain daily rates.
Table 3: Estimated parameters for Texas Fall 2020 wave using JHU Covid-19 data
Parameter
Region 3
Region 6
Region 7
Region 8
Infection rate (λS )
0.16
0.16
0.16
0.16
Mean recovery time (1/λR )
9.92 (days) 10.52 (days) 10.85 (days) 10.95 (days)
Mortality rate (λD )
0.0111
0.00992
0.0135
0.0112
In addition, unlike in the experiment with synthetic data, we have no groundtruth for the states or parameters. In order
to evaluate the performance of the algorithm, we use the estimated values of states and parameters to predict the time
series of observed data and check its agreement with the actual JHU data. These plots are displayed in Figures 4 and
5 over region 3. They indicate that our model can accurately estimate the hidden states and unknown parameters.
Table 3 displays the estimated values of the parameters. The value for the infection rate is the same over all regions, by
assumption; however, Figures 4 and 5 provide evidence that this is a reasonable assumption.
4.4

Discussion

Compared with the standard SEIRD model, which assumes that the states of the epidemic can be observed directly, our
stochastic state-space model realistically treats these states as hidden and only indirectly observed from the reported
data. The proposed methodology is also able to incorporate detailed information about the testing procedure, such
as false positive and false negative test rates and differential testing rate between symptomatic and asymptomatic
12

Figure 5: Prediction of cumulative deaths using JHU Covid-19 data over region 3. The blue line represents the actual
observed data, the red dashed line are the predicted values in the time interval where the observed data is known.

patients. Our model provides a more accurate estimate of unknown/unobserved epidemiological parameters, such as the
time-varying reproductive number, which are paramount for monitoring disease transmission dynamics and evaluating
the effectiveness of ongoing control strategies. Moreover, our state-space model is more suitable for designing robust
optimal control strategies and providing more accurate predictions of the future trends of an epidemic, based on the
noisy reported time series data, than standard epidemic models.
Our model has limitations, which can be addressed by future work. First, our model does not consider vital dynamics
such as birth and death from other causes. Provided that the model is run over a short interval of time, such as an
isolated wave in the epidemic, the results will not be affected too much; in addition, new born play an insignificant
role in Covid-19 spread. Second, we assume that individuals infected with COVID-19 will develop life-long immunity.
Though some epidemiological data have indicated evidence of COVID-19 reinfections, in most cases immunity persist
for at least eight months. Therefore, we believe that this assumption has a marginal impact on our results, provided once
again that the model is run over a short enough time interval. Third, our model ignored the impact of age on COVID-19
epidemiological parameters such as infection rate, disease severity (symptomatic vs asymptomatic), mortality rate,
recovery rate, and testing rate. Age-specific infection rate and disease-induced complications have been observed
during the ongoing COVID-19 pandemic and considered to play an import role in disease transmission and the design
of public health policies. Fourth, our model in it current form assumes that connection between the different regions
can be modeled with a simple gravity commuting model Zipf [1946], Truscott and Ferguson [2012], Chen et al. [2021].
This limitation can be addressed by using empirical population mobility data. Finally, Our model did not consider
potential temporal changes of parameters over time, e.g. the mortality rate may be be high and recovery rate low at the
beginning of an outbreak because of lack of effective treatments, or public behavior, such as social distancing and mask
wearing, may vary over time. Also, in the case of the Fall 2020 wave, it is known that mass vaccination began at the end
of this wave (December 2020), which very likely had a major impact in the disease transmission parameters. Hence, the
estimated parameter values reflect average rates over the time interval in consideration.
13

5

Conclusion

We proposed a novel stochastic metapopulation state-space model for COVID-19 transmission, based on a discrete-time
SEIRD model, which is able to estimate the hidden epidemic states and transmission parameters from a noisy time
series of reported epidemiological data, by applying unscented Kalman filtering (UKF), Maximum Likelihood (ML)
adaptive filtering, and metaheuristic optimization. We reported results from a comprehensive set of experiments, using
synthetic data and real epidemic data to demonstrate that our model can estimate parameters and predict future trends
accurately and effectively. The proposed framework was applied to the state of Texas in the United States, using data
from the Center for Systems Science and Engineering (CSSE) at Johns Hopkins University. It can also be applied to
any city/state/nation by providing the necessary time series data (e.g. reported cases, deaths, and testing rates). The
proposed methodology may provide a valuable tool for revealing the current epidemic status through accurate estimated
states and disease transmission parameters, improving the ability of authorities to make informed decisions on public
health measures to contain the disease.

Conflict of interest
The authors declare that they have no conflicts of interest.

Acknowledgements
Martial Ndeffo-Mbah acknowledges funding from the National Science Foundation RAPID Award [grant number
DEB-2028632].

References
Marta Luisa Ciofi Degli Atti, Stefano Merler, Caterina Rizzo, Marco Ajelli, Marco Massari, Piero Manfredi, Cesare
Furlanello, Gianpaolo Scalia Tomba, and Mimmo Iannelli. Mitigation measures for pandemic influenza in italy: an
individual based model considering different scenarios. PloS one, 3(3):e1790, 2008.
Liliana Perez and Suzana Dragicevic. An agent-based approach for modeling dynamics of contagious disease spread.
International journal of health geographics, 8(1):1–17, 2009.
Elizabeth Hunter, Brian Mac Namee, and John Kelleher. An open-data-driven agent-based model to simulate infectious
disease outbreaks. PloS one, 13(12):e0208775, 2018.
Sheryl L Chang, Nathan Harding, Cameron Zachreson, Oliver M Cliff, and Mikhail Prokopenko. Modelling transmission
and control of the covid-19 pandemic in australia. Nature communications, 11(1):1–13, 2020.
Dennis L Chao, Assaf P Oron, Devabhaktuni Srikrishna, and Michael Famulare. Modeling layered non-pharmaceutical
interventions against sars-cov-2 in the united states with corvid. medRxiv, 2020.
Joel R Koo, Alex R Cook, Minah Park, Yinxiaohe Sun, Haoyang Sun, Jue Tao Lim, Clarence Tam, and Borame L
Dickens. Interventions to mitigate early spread of sars-cov-2 in singapore: a modelling study. The Lancet Infectious
Diseases, 20(6):678–688, 2020.
Mirjam Kretzschmar, Ganna Rozhnova, and Michiel van Boven. Isolation and contact tracing can tip the scale to
containment of covid-19 in populations with social distancing. Available at SSRN 3562458, 2020.
Cliff C Kerr, Robyn M Stuart, Dina Mistry, Romesh G Abeysuriya, Gregory Hart, Katherine Rosenfeld, Prashanth
Selvaraj, Rafael C Nunez, Brittany Hagedorn, Lauren George, et al. Covasim: an agent-based model of covid-19
dynamics and interventions. medRxiv, 2020.
Duygu Balcan, Bruno Goncontcalves, Hao Hu, José J Ramasco, Vittoria Colizza, and Alessandro Vespignani. Modeling
the spatial spread of infectious diseases: The global epidemic and mobility computational model. Journal of
computational science, 1(3):132–145, 2010.
Vanja Dukic, Hedibert F Lopes, and Nicholas G Polson. Tracking epidemics with state-space seir and google flu trends.
Unpublished manuscript, 2012.
Dave Osthus, Kyle S Hickmann, Petrucontta C Caragea, Dave Higdon, and Sara Y Del Valle. Forecasting seasonal
influenza with a state-space sir model. The annals of applied statistics, 11(1):202, 2017.
Elizabeth Sebastian and Priyanka Victor. A state space approach for sir epidemic model. International Journal of
Difference Equations, 12(1):79–87, 2017.
14

Matt J Keeling, T Deirdre Hollingsworth, and Jonathan M Read. Efficacy of contact tracing for the containment of the
2019 novel coronavirus (covid-19). J Epidemiol Community Health, 74(10):861–866, 2020.
Reza Sameni. Mathematical modeling of epidemic diseases; a case study of the covid-19 coronavirus. arXiv preprint
arXiv:2003.11371, 2020.
Alberto Godio, Francesca Pace, and Andrea Vergnano. Seir modeling of the italian epidemic of sars-cov-2 using
computational swarm intelligence. International Journal of Environmental Research and Public Health, 17(10):3535,
2020.
Genya Kobayashi, Shonosuke Sugasawa, Hiromasa Tamae, and Takayuki Ozu. Predicting intervention effect for
covid-19 in japan: state space modeling approach. BioScience Trends, 2020.
William Ogilvy Kermack and Anderson G McKendrick. A contribution to the mathematical theory of epidemics.
Proceedings of the royal society of london. Series A, Containing papers of a mathematical and physical character,
115(772):700–721, 1927.
Giles Hooker, Stephen P Ellner, Laura De Vargas Roditi, and David JD Earn. Parameterizing state–space models for
infectious disease dynamics by generalized profiling: measles in ontario. Journal of The Royal Society Interface, 8
(60):961–974, 2011.
ShaoBo Zhong, QuanYi Huang, and DunJiang Song. Simulation of the spread of infectious diseases in a geographical
environment. Science in China Series D: Earth Sciences, 52(4):550–561, 2009.
Taarak Rapolu, Brahmani Nutakki, T Sobha Rani, and S Durga Bhavani. A time-dependent seird model for forecasting
the covid-19 transmission dynamics. medRxiv, 2020.
Elena Loli Piccolomiini and Fabiana Zama. Monitoring italian covid-19 spread by an adaptive seird model. MedRxiv,
2020.
Ivan Korolev. Identification and estimation of the seird epidemic model for covid-19. Journal of econometrics, 220(1):
63–85, 2021.
Elena Loli Piccolomini and Fabiana Zama. Monitoring italian covid-19 spread by a forced seird model. PloS one, 15
(8):e0237417, 2020.
Vipin Tiwari, Nandan Bisht, and Namrata Deyal. Mathematical modelling based study and prediction of covid-19
epidemic dissemination under the impact of lockdown in india. medRxiv, 2020.
George Kingsley Zipf. The p 1 p 2/d hypothesis: on the intercity movement of persons. American sociological review,
11(6):677–686, 1946.
James Truscott and Neil M Ferguson. Evaluating the adequacy of gravity models as a description of human mobility for
epidemic modelling. PLoS Comput Biol, 8(10):e1002699, 2012.
Qun Chen, Jiao Yan, Helai Huang, and Xi Zhang. Correlation of the epidemic spread of covid-19 and urban population
migration in the major cities of hubei province, china. Transportation Safety and Environment, 3(1):21–35, 2021.
William E Allen, Han Altae-Tran, James Briggs, Xin Jin, Glen McGee, Andy Shi, Rumya Raghavan, Mireille Kamariza,
Nicole Nova, Albert Pereta, et al. Population-scale longitudinal mapping of covid-19 symptoms, behaviour and
testing. Nature Human Behaviour, 4(9):972–982, 2020.
Diana Buitrago-Garcia, Dianne Egli-Gany, Michel J Counotte, Stefanie Hossmann, Hira Imeri, Aziz Mert Ipekci,
Georgia Salanti, and Nicola Low. Occurrence and transmission potential of asymptomatic and presymptomatic
sars-cov-2 infections: A living systematic review and meta-analysis. PLoS medicine, 17(9):e1003346, 2020.
Eric A Wan and Rudolph Van Der Merwe. The unscented kalman filter for nonlinear estimation. In Proceedings
of the IEEE 2000 Adaptive Systems for Signal Processing, Communications, and Control Symposium (Cat. No.
00EX373), pages 153–158. Ieee, 2000.
Carmelo JA Bastos Filho, Fernando B de Lima Neto, Anthony JCC Lins, Antonio IS Nascimento, and Marilia P Lima.
A novel search algorithm based on fish school behavior. In Systems, Man and Cybernetics, 2008. SMC 2008. IEEE
International Conference on, pages 2646–2651. IEEE, 2008.
CJA Bastos-Filho and DO Nascimento. An enhanced fish school search algorithm. In Computational Intelligence and
11th Brazilian Congress on Computational Intelligence (BRICS-CCI & CBIC), 2013 BRICS Congress on, pages
152–157. IEEE, 2013.
Yukun Tan, Fernando Lima Neto, and Ulisses Braga-Neto. Pallas: Penalized maximum likelihood and particle swarms
for inference of gene regulatory networks from time series data. IEEE/ACM Transactions on Computational Biology
and Bioinformatics, 2020.
Dan Simon. Optimal state estimation: Kalman, H infinity, and nonlinear approaches. John Wiley & Sons, 2006.
15

Simo Särkkä. Bayesian filtering and smoothing. Number 3. Cambridge University Press, 2013.
Kazufumi Ito and Kaiqi Xiong. Gaussian filters for nonlinear filtering problems. IEEE transactions on automatic
control, 45(5):910–927, 2000.
Yuanxin Wu, Dewen Hu, Meiping Wu, and Xiaoping Hu. A numerical-integration perspective on gaussian filters. IEEE
Transactions on Signal Processing, 54(8):2910–2921, 2006.
Juho Kokkala, Arno Solin, and Simo Särkkä. Sigma-point filtering and smoothing based parameter estimation in
nonlinear dynamic systems. arXiv preprint arXiv:1504.06173, 2015.
Takashi Asai. Covid-19: accurate interpretation of diagnostic tests—a statistical point of view, 2020.
Gardner L Dong E, Du H. An interactive web-based dashboard to track covid-19 in real time. Lancet Inf Dis., 20(5):
533–534. doi:10.1016/S1473-3099(20)30120-1.

Appendix
Calculation of the covariance matrix Q of the process noise.
Covariance matrix Qt is a 5 by 5 square matrix giving the covariance between each pair of elements of the state process
noise vector (ntSi , ntEi , ntIi , ntRi , ntDi ) for a specific region i at time t.
Diagonal elements of the covariance matrix contain the variances of each variable, which are calculated as:


t
V ar(ntSi ) = V ar ΣG
j=1 NSi,j
= Σj Sit

cij λS Ijt
cij λS Ijt
cij1 λS Ijt1 cij2 λS Ijt2
,
(1 −
) − Σj1 Σj2 Sit
Nj
Nj
Nj 1
Nj2

j1 6= j2

(33)

cij λS Ijt
cij1 λS Ijt1 cij2 λS Ijt2
− Σj1 Σj2 Sit
Nj
Nj1
Nj2


t
t
V ar(ntEi ) = V ar ΣG
j=1 NSi,j + V ar(NEi )
= Σj Sit

= Σj Sit

cij1 λS Ijt1 cij2 λS Ijt2
cij λS Ijt
− Σj1 Σj2 Sit
+ Eit λE (1 − λE )
Nj
Nj1
Nj2

(34)

t
t
V ar(ntIi ) = V ar(NEt i ) + V ar(NRt i ) + V ar(ND
) + 2Cov(NRt i , ND
)
i
i

= Eit λE (1 − λE ) + Iit λR (1 − λR ) + Iit λD (1 − λD ) − 2Iit λR λD
= Eit λE (1

− λE ) +

Iit (λR

(35)

+ λD )(1 − (λR + λD ))

V ar(ntRi ) = V ar(NRt i ) = Iit λR (1 − λR )

(36)

t
V ar(ntDi ) = V ar(ND
) = Iit λD (1 − λD )
i

(37)

The off-diagonal elements contain the covariances of each pair of variables, which are calculated as:
Cov(ntSi , ntEi ) = −V ar(ntSi )

(38)

Cov(ntEi , ntIi ) = −V ar(NEt i )

(39)

t
Cov(ntIi , ntRi ) = − V ar(NRt i ) − Cov(NRt i , ND
)
i

= − Iit λR (1 − λR ) + Iit λR λD
=−

Iit λR (1
16

− (λR + λD ))

(40)

t
t
Cov(ntIi , ntDi ) = − V ar(ND
) − Cov(NRt i , ND
)
i
i

= − Iit λD (1 − λD ) + Iit λR λD
=−

Iit λD (1

(41)

− (λR + λD ))

Cov(ntRi , ntDi ) = −Iit λR λD

(42)

The remaining elements will be zero.
Covariance of the observation noise (R)
Covariance matrix Rt is a 2 by 2 square matrix giving the covariance between each pair of elements of the observation
noise vector (vp ti , vq ti ) for a specific region i at time t.
Similarly, diagonal elements of the covariance matrix contain the variances of each variable, but all the off-diagonal
elements will be zero.
var(vp ti ) = εt1 (1 − εt3 )(Sit + Rit )α(1 − α) + εt2 εt3 (Sit + Rit )α(1 − α)
+ εt2 (1 − εt4 )Iit β(1 − β) + εt1 (εt4 Iit + Eit )β(1 − β)
var(vq ti ) = Dit β(1 − β)

17

(43)

