arXiv:2006.05733v1 [math.OC] 10 Jun 2020

Optimal immunity control by social distancing for
the SIR epidemic model
P.-A. Bliman∗

M. Duprez†

Y. Privat‡

N. Vauchelet§

Abstract
Until a vaccine or therapy is found against the SARS-CoV-2 coronavirus, reaching herd
immunity appears to be the only mid-term option. However, if the number of infected individuals decreases and eventually fades only beyond this threshold, a significant proportion of
susceptible may still be infected until the epidemic is over. A containment strategy is likely
the best policy in the worst case where no vaccine or therapy is found. In order to keep the
number of newly infected persons to a minimum, a possible strategy is to apply strict containment measures, so that the number of susceptible individuals remains close to herd immunity.
Such an action is unrealistic since containment can only last for a finite amount of time and
is never total. In this article, using a classical SIR model, we determine the (partial or total)
containment strategy on a given finite time interval that maximizes the number of susceptible
individuals over an infinite horizon, or equivalently that minimizes the total infection burden
during the curse of the epidemic. The existence and uniqueness of the optimal strategy is
proved and the latter is fully characterized. If applicable in practice, such a strategy would
lead theoretically to an increase by 30% of the proportion of susceptible on an infinite horizon,
for a containment level corresponding to the sanitary measures put in place in France from
March to May 2020. We also analyze the minimum intervention time to reach a fixed distance
from herd immunity, and show the relationship with the previous problem. Simulations are
provided that illustrate and validate the theoretical results.

Keywords: optimal control, SIR epidemic model, herd immunity, lockdown policy.
AMS classification: 34H05, 49J15, 49K15, 92D30, 93C15.

1

Introduction

Important efforts have been devoted to the application of optimal control theory to the control of
infectious diseases. Many works have considered the simple SIR model without demography that
recently became even more famous in a broad community worldwide. Such a model reads
Ṡ = −βSI,
˙
I = βSI − νI,
Ṙ = νI,

S(0) = S0 ,
I(0) = I0 ,
R(0) = R0 .

(1a)
(1b)
(1c)

∗ Inria, Sorbonne Université, Université Paris-Diderot SPC, CNRS, Laboratoire Jacques-Louis Lions, équipe
Mamba, Paris, France. (pierre-alexandre.bliman@inria.fr).
† CEREMADE, Université Paris-Dauphine & CNRS UMR 7534, Université PSL, 75016 Paris, France
(mduprez@math.cnrs.fr).
‡ Université de Strasbourg, CNRS UMR 7501, INRIA, Institut de Recherche Mathématique Avancée (IRMA), 7
rue René Descartes, 67084 Strasbourg, France (yannick.privat@unistra.fr).
§ LAGA, UMR 7539, CNRS, Université Sorbonne Paris Nord, 99 avenue Jean-Baptiste Clément, 93430 Villetaneuse, France (vauchelet@math.univ-paris13.fr).

1

The state variables S, I, R correspond respectively to the proportions of susceptible, infected and
removed individuals in the population. Notice that the sum of the derivatives of the three state
variables is zero, so the sum of the variables remains equal to 1 if initially S0 + I0 + R0 = 1. One
may therefore describe the system solely with the equations (1a)-(1b). The total population is
constant and no demographic effect (births, deaths) is modeled, as they are not relevant to the
time scale to be taken into account in reacting to an outbreak. The positive parameter β in the
infection term βSI accounts at the same time for the rate of encounters between the individuals
and the probability of transmitting the infection during each of theses encounters. The positive
parameter ν describes the rate at which the infected are removed (typically by recovery) by time
unit. Cured people are supposed to have acquired permanent immunity.
An important issue, abundantly discussed these days, is herd immunity. The latter occurs
naturally when a large proportion of the population has become immune to the infection. Mathematically, it is defined as the value of S below which the number of infected decreases. For the
SIR model (1), one has I˙ = (βS − ν)I, and this number reads
Sherd :=

ν
.
β

(2)

While the number of infected decreases when S(·) 6 Sherd , epidemics continue to consume susceptible and to generate new infections once the immunity threshold has been crossed.
1
The basic reproduction number R0 := β/ν = Sherd
governs the behaviour of the system departing from its initial value. When R0 < 1, no epidemic may occur, whereas when R0 > 1 epidemic
occurs if S0 > R10 . In such a case, I reaches a peak and then goes to zero due to the immunity
effect previously presented. From now on, we assume S0 > Sherd and
R0 =

β
> 1.
ν

Obviously, every solution of (1) is nonnegative and thus, Ṙ > 0 > Ṡ at any instant, so S may
only decrease,
R +∞ while R may only increase. We infer that S remains bounded and therefore, the
integral 0 βS(t)I(t) dt converges, and in any case the following limit exists:
S∞ := lim S(t) ∈ [0, Sherd],
t→+∞

lim I(t) = 0.

t→+∞

(3)

We remark that, after passing the collective immunity threshold, that is while t is large enough,
one has
Sherd > S(t) > S∞ .
(4)
In order to illustrate herd immunity, Table 1 displays, for several values of R0 , the value of
the herd immunity threshold and the number of susceptibles that remain after the fading out of
the outbreak, in the case of an initially naive population (S0 ≃ 1). The proportion of infections
occurred after the overcome of the immunity is also shown.
Apart from medical treatment, there are generally speaking three main methods to control
human diseases. Each of them, alone or in conjunction with the others, gave rise to applications of
optimal control. We introduce a modified SIR system, where the control inputs u1 (·), u2 (·), u3 (·)
materialize these three methods.
Ṡ = −u3 βSI − u1 ,
I˙ = u3 βSI − νI − u2 ,
Ṙ = νI + u1 + u2 ,
2

S(0) = S0 ,
I(0) = I0 ,
R(0) = R0 .

(5a)
(5b)
(5c)

R0
Sherd
S∞
Sherd − S∞
1 − S∞

1.5
0.67
0.42

2
0.50
0.20

2.5
0.40
0.11

2.9
0.34
0.067

3
0.33
0.059

3.5
0.29
0.034

43%

37%

33%

30%

29%

27%

Table 1: Herd immunity level Sherd and asymptotic susceptible proportion S∞ for initial value
S0 ≃ 1 for several values of the basic reproduction number R0 . The value of Sherd comes from (2),
and S∞ may be deduced from the fact that S∞ − R10 ln S∞ ≈ 1, see Lemma 2 below. The ratio
Sherd −S∞
represents the proportion of susceptible that occur after passing the collective immunity
1−S∞
threshold. The column in bold corresponds to R0 found in [SKL+ 20] for the SARS-CoV-2 in
France before the lockdown of March-May 2020.

A first class of interventions consists in vaccination or immunization [Aba74, MW74, DB80,
Gre88, Beh00, GS09, HD11, HZ13, AER+ 14, YWZZ15, LT15, BBSG17, BBDMG19, Shi19]. It
consists in transferring individuals from the S compartment to the R one: this is the effect of the
additive input u1 in (5). The members of the latter may not be anymore “recovered” stricto sensu,
but the key point in the model is that they are excluded from the infective process. A second class
of measures corresponds to screening and quarantining of infected [Aba73, Wic75, Wic79, Beh00,
AI12, ZWW13, BBSG17, BBDMG19]. It may be modelled by transfer of individuals from the I
compartment to the R one, as done by the input u2 in (5). Last, it is possible to reduce transmission
through health promotion campaigns or lockdown policies [Beh00, BBSG17, MRPL20], as done by
the multiplicative input u3 in (5). Of course these methods may be employed jointly [HD11].
Other modelling frameworks have also been considered. More involved models called SEIR and
SIRS have been analyzed in [Beh00, GS09], and SIR model structured by the infection age in [AI12].
Constraints on the number of infected persons that the public health system can accommodate
or on available resources, particularly in terms of vaccination, were studied [ZWW13, YWZZ15,
BBSG17, BBDMG19]. Economical considerations may be aggregated to the epidemiological model
[KS20, PS20, AAL20]. Ad-hoc models for tackling emergence of resistance to drugs issues have
been introduced [JDM13, JDHWM13], as well as framework allowing to study revaccination policies
[KGZ15, KZ16]. Optimization of vaccination campaigns for vector-borne diseases have also been
considered [Shi19]. The references cited above are limited to deterministic differential models, but
discrete-time models and stochastic models have also been used e.g. in [Aba73, Aba74, Gre88].
The costs considered in the literature are usually integral costs combining an “outbreak size”
(the integral of the number of infected, or of the newly infected term, or the largest number
of infected) and the input variable on a given finite time horizon. Some minimal time control
problems have also been considered [AER+ 14, BBSG17, BBDMG19]. Few results consider infinite
horizon [Beh00]. Qualitatively, optimal solutions attached to the vaccination or isolation protocols
are in general bang-bang1 , with an intervention from the very beginning. Bounds on the number
of switching times between the two modes (typically zero or one) are sometimes provided. By
contrast, protocols of the third type (health promotion campaigns or lockdown policies) usually
provide bang-bang optimal solutions with transmission reduction beginning after a certain time.
The present article is dedicated to the optimal control issue of obtaining, by enforcing social
distancing, the largest value for S∞ , the limit number of susceptible individuals at infinity. This
means that we act on System (5) through the function u3 (·) and set u1 (·) = u2 (·) = 0. This aim
R +∞
is also equivalent to minimize the total infection burden 0 βu3 (t)S(t)I(t) dt or, equivalently, to
1 In

other words, they only take a.e. two different values.

3

RT
minimize the final number of removed ν 0 I(t)dt, see (5a)-(5b). We thus seek here to determine
how close to the herd immunity threshold it is possible to stop the spread of the disease, in the
case where no vaccine or treatment is found to modify its evolution.
In the case of interventions on a infinite horizon, a possible action is to let the susceptible
proportion reach the collective immunity level (u3 = 1), and then impose total lockdown (u3 = 0).
This situation is illustrated in Figure 1 (right) for parameters of the Covid-19 in France in 2020
borrowed from [SKL+ 20] and given in Table 2 below. We will focus here on interventions on a given
finite horizon through possibly partial lockdown, i.e. with u3 bounded from below. This setting
is a prototypal problem, voluntarily unrealistic since for instance, no constraint on the peak value
of the number of infected is considered. In a nutshell, the aim is to determine what best result
may be obtained in terms of reduction of the total cumulative number of infected individuals,
by applying lockdown of given maximal intensity and duration, in the worst conditions where no
medical solution is discovered to stop earlier the epidemic spread. This models public interventions
on the transmission rate by measures like social distanciation, restraining order, lockdown and so
on, imposed on finite time horizon.
1

1
S
I
R
u3
S∞

0.8
0.6
0.4

0.6
0.4

0.2

0.2

0

0
0

50

100
150
Time (days)

S
I
R
u3
Sherd

0.8

200

0

50

100
150
Time (days)

200

Figure 1: Numerical simulation of the SIR model (5) with the numerical parameters given in Table
2 and u1 (·) = u2 (·) = 0. Left: no action (u3 (·) = 1). Right: bang-bang action with one switch at
the epidemic peak (u3 (·) = 1 on (0, 62) and u3 (·) = 0 otherwise).
For better readability, all results are exposed in Section 2. It is shown in Section 2.1 that, at
least for strong enough lockdown measures and long enough intervention time T , it is possible to
stop the epidemics arbitrarily close past the herd immunity. In Section 2.2, we provide and analyze
the optimal control law that leads asymptotically, through an intervention of duration T , to the
largest number of susceptible individuals. Last, we show in Section 2.3 that this optimal strategy
coincides with a time minimal policy. For the sake of readability, all the proofs are postponed to
Section 3. These results are numerically illustrated in Section 4.

2

Main results

For the sake of clarity, the demonstrations of all the results of this section are postponed to
Section 3.
According to the introduction in the previous section, we consider in the sequel the following
“SIR type” system
Ṡ(t) = −u(t)βS(t)I(t),
t>0
(6)
˙ = u(t)βS(t)I(t) − νI(t), t > 0
I(t)
4

complemented with nonnegative initial data S(0) = S0 , I(0) = I0 such that S0 + I0 6 1. For given
T > 0 and α ∈ [0, 1), the input control u will be assumed to belong to the so-called admissible set
Uα,T defined by
Uα,T := {u ∈ L∞ ([0, +∞)), α 6 u(t) 6 1 if t ∈ [0, T ], u(t) = 1 if t > T }.
The constant T characterizes the duration of the intervention, and α its intensity (typically the
strength of a lockdown procedure).

2.1

Toward an optimal control problem: reachable asymptotic immunity
levels

The following result assesses the question of stopping the evolution exactly at, or arbitrarily close
to, the herd immunity Sherd defined by (2).
Proposition 1. Let α ∈ [0, 1) and T > 0. Assume that S0 > Sherd and consider
α :=

Sherd
(ln S0 − ln Sherd ).
S0 + I0 − Sherd

(7)

(i) If α 6 α, then, for all ε ∈ (0, Sherd), there exist T > 0 and a control u ∈ Uα,T such that the
solution S to (6) associated to u satisfies
Sherd > lim S(t) > Sherd − ε.
t→+∞

(ii) If α > α, then for all u ∈ Uα,T the solution S to (6) associated to u satisfies
lim S(t) 6 lim S α (t) < Sherd ,

t→+∞

t→+∞

where S α is the solution to (6) associated to u ≡ α.
Moreover, the map α 7→ limt→+∞ S α (t) is strictly decreasing.
(iii) There is no T ∈ (0, +∞) and u ∈ Uα,T such that the solution S to (6) associated to u satisfies
lim S(t) = Sherd .

t→+∞

The proof of Proposition 1 is given in Section 3.2.
Remark 1. The values given in Table 2, which correspond to the sanitary measures put in place
in France during the March to May 2020 containment period, satisfy S0 > Sherd and α 6 α.
According to Table 1, there thus exists a containment strategy that increases the limit proportion
of susceptible by 30%.
Conclusion of this section. To tackle the issue of reaching the closest state to the threshold of
herd immunity with the help of control functions u(·), it seems relevant to maximize the limit of
S(t) when t → +∞ for a given duration T of the intervention. This leads to consider the optimal
control problem
sup S∞ (u)
(Pα,T )
u∈Uα,T

where
S∞ (u) := lim S(t),
t→∞

5

with (S, I) the solution to (6) associated to u.
We now make an observation, which will be crucial in the analysis (see details in Section 3.3). It
turns out that the quantity S + I − R10 ln(S) is constant on any time interval on which u(·) = 1 (see
Lemma 2). Therefore, using the fact that lim I(t) = 0 and the monotonicity of x 7→ x − R10 ln x,
t→+∞

the optimal control problem (Pα,T ) is indeed equivalent to
inf

u∈Uα,T

S(T ) + I(T ) −

1
ln(S(T ))
R0

where (S, I) is the solution to (6) associated to u.

2.2

Optimal immunity control

This section is devoted to the analysis results of the optimal control problem (Pα,T ).
The first result of this section reduces the study of the complete problem to that of a one
dimensional optimization problem, whose unknown denoted T0 stands for a switching time. For
simplicity, given α ∈ [0, 1], T > 0 and T0 ∈ [0, T ], we define the function uT0 ∈ Uα,T by
uT0 = 1[0,T0 ] + α1[T0 ,T ] + 1[T,+∞) .

(8)

Also, we denote (S T0 , I T0 ) the solution of (6) with u = uT0 .
Theorem 1. Let α ∈ [0, 1) and T > 0. Problem (Pα,T ) admits a unique solution u∗ . Furthermore,
∗
(i) the maximal value S∞,α,T
:= max{S∞ (u) : u ∈ Uα,T } is nonincreasing with respect to α and
nondecreasing with respect to T .

(ii) there exists a unique T0 ∈ [0, T ) such that u∗ = uT0 (in particular, the optimal control is
bang-bang).
The proof of Theorem 1 is given in Section 3.3.
u(t)
1
α
0

T0

T

t

At this step, the result above proves that the optimal control belongs to a family of bang-bang functions
parametrized by the switching time T0 . This reduces
the study to a rather simple one-dimensional optimization problem, at least from the numerical point
of view.

Figure 2: Opt. control
We deduce that the switching time associated to the optimal solution of Problem (Pα,T ) solves
the 1D optimization problem
eα,T )
sup j(T0 )
(P
T0 ∈[0,T )

where j(T0 ) := S∞ (uT0 ), and uT0 is defined by (8). The next result characterizes the optimal T0
for (Peα,T ) whenever α ∈ [0, 1]. To state it, one needs to introduce the function ψ given by
ψ : T0 ∋ [0, T ] 7→ (1 − α)βI T0 (T )

Z

T

T0

where (S T0 , I T0 ) denotes the solution to (6) with u = uT0 .
6

S T0 (t)
dt − 1,
I T0 (t)

(9)

Theorem 2. Let T > 0, α ∈ [0, 1) and T0∗ the unique optimal solution to Problem (Peα,T ) (hence
uT0∗ is the optimal solution to Problem (Pα,T ) with the notation (8)). One has the following
characterization:
• if ψ(0) 6 0, then T0∗ = 0.
• if ψ(0) > 0, then T0∗ is the unique solution on (0, T ) to the equation
ψ(T0 ) = 0.

(10)

Moreover S T (T0∗ ) > Sherd , i.e. T0∗ 6 (S T )−1 (Sherd ), where, in agreement with (8), S T denotes the
solution to System (6) with u = uT ≡ 1.
S0
, and in that case,
In the particular case α = 0, one has T0∗ > 0 if, and only if T > ν1 ln S0 −S
herd
∗
T0 is the unique solution to the equation
S T0 (T0 ) =

Sherd
.
1 − eν(T0 −T )

Moreover the functional j is increasing on (0, T0∗ ), then decreasing on (T0∗ , T ) whatever the value
of α ∈ [0, 1] be.
eα,T ) and this characterization of the optimal T0∗ conThe reduction to the optimal control (P
stitute useful tools to refine the numerical search of optimal controls.
Ongoing work. We conclude this part by underlying that the optimal control problem we have
solved is a prototypal one. In particular, it does not appear completely relevant since it does not
take into account a cost related to the occupancy of hospital beds and the fact that this number
of beds is limited. This leads, as a first approximation, to add to the problem of optimal control
a constraint on the total number of infected persons. This will be the main topic of future work.

2.3

Relations with the minimal time problem

We have shown (see Theorem 1) that, provided that α is sufficiently small, there exists for every
ε > 0 a time of control T such that, by acting on [0, T ], we have limt→+∞ S(t) > Sherd − ε, i.e. at
a distance ε of the herd immunity threshold. Then, we may wonder what is the minimal time of
action such that the final value of susceptible is at a given distance of this threshold. This amounts
to solve the following optimal control problem.
Minimal time problem: for ε > 0, determine the minimal time of action T ∗ > 0
such that the optimal final number of susceptible individuals satisfies
∗
S∞,α,T
∗ > Sherd − ε.
∗
We recall that S∞,α,T
is defined in Theorem 1. The following result answers to this question
by noting that solving this problem is equivalent to solve Problem (Pα,T ).

Theorem 3. Assume α 6 α (defined in (7)) and let ε > 0.
Let Tε∗ > 0 be the solution to the minimal time problem above and denote u∗ε the corresponding
control function. Then, u∗ε is the unique solution of Problem (Pα,T ) determined in Theorems 1
and 2 associated to T = T ∗ .
∗
Conversely, let T > 0 and S∞,α,T
the maximum of Problem (Pα,T ). Then, T is the minimal
∗
time of intervention such that S∞ (u) > S∞,α,T
for some u ∈ Uα,T .
7

3

Proofs of the main results

3.1

Preliminary results

Before proving the main results, we will provide some useful elementary properties of the state
variables (S, I) solving (6) whose role in the sequel will be central. To this aim, it is convenient to
introduce the function Φγ defined for any γ > 0
Φγ : R∗+ × R+ ∋ (S, I) 7−→ S + I −

1
ln S.
γ

(11)

Let us start with a preliminary result regarding the value of Φγ along the trajectories of System (6).
Lemma 1. For any u ∈ L∞ ([0, +∞), [0, 1]) and γ ∈ R, one has


β
d
[Φγ (S(t), I(t))] =
u(t) − ν I
dt
γ

(12)

along any trajectory of system (6). In particular, if u is constant on a non-empty, possibly unbounded, interval, then the function ΦR0 u (S(·), I(·)) is constant on this interval along any trajectory
of System (6).
Proof. The proof of (12) follows from straightforward computations. Indeed along every trajectory
of (6), one has



 

1
d
d
1
β
˙
S + I − ln S = 1 −
Ṡ + I =
[Φγ (S(t), I(t))] =
u(t) − ν I.
dt
dt
γ
γS
γ
The second part of the statement is an obvious byproduct of this property, by setting γ = R0 u.
Lemma 1 allows to characterize the value of the limit of S at infinity, as now stated.
Lemma 2. Let u ∈ Uα,T . For any trajectory of (6), the limit S∞ (u) of S(t) at infinity exists and
is the unique solution in the interval [0, 1/R0 ] of the equation
ΦR0 (S∞ , 0) = ΦR0 (S(T ), I(T )),

(13)

where ΦR0 is given by (11).
Proof. Any input control u from Uα,T is equal to 1 on [T, +∞). Hence, applying Lemma 1 with
u = 1 on this interval yields (13), by continuity of ΦR0 and because of (3). Moreover, Eq. (13)
has exactly two roots. Indeed, this follows by observing that the mapping S 7→ ΦR0 (S, 0) is first
decreasing and then increasing on (0, +∞), with infinite limit at 0+ and +∞, and minimal value
at S = 1/R0 = Sherd , equal to R10 (1 + ln R0 ). We conclude by noting that the limit S∞ (u) cannot
be larger than Sherd : otherwise there would exist ε > 0 such that I˙ > ε > 0 and Ṡ < −εβS for T
large enough, so that S would tend to zero at infinity, yielding a contradiction. It follows that the
value of S∞ (u) is thus the smallest root of (13).
Remark 2 (On the control in infinite time). Notice that, in the quite unrealistic situation where
one is able to act on System (6) up to an infinite horizon of time, then the optimal strategy
to maximize S∞ (u) is to consider the constant control function uα (·) = α on [0, +∞). Indeed,
according to Lemma 1,


d
ν
β
u(t) − ν I(t) = (u(t) − α)I(t) > 0,
[ΦαR0 (S(t), I(t))] =
dt
αR0
α
8

for all t ∈ [0, T ]. Hence, ΦαR0 (S0 , I0 ) 6 ΦαR0 (S∞ (u), 0), with equality if, and only if u = uα = α
a.e. on R+ . Since S∞ (u) is maximal whenever ΦαR0 (S∞ (u), 0) is minimal, we get that the optimal
strategy in that case corresponds to the choice u = uα = α a.e. on R+ . Moreover, it is notable
that this maximal value S∞ (uα ) is computed by solving the nonlinear equation ΦαR0 (S∞ , 0) =
ΦαR0 (S0 , I0 ). Therefore, an easy application of the implicit functions theorem yields that the
mapping α 7→ S∞ (uα ) is decreasing.

3.2

Proof of Proposition 1

Let us start with (iii). According to (6), one has I˙ > −νI, thus I(t) > I0 e−νt > 0 for all t > 0.
Then, Ṡ < 0 and S is decreasing. Assume by contradiction that, for all t > 0, we have Sherd < S(t).
Since I satisfies (6), it follows that I˙ > 0 on (T, +∞) and then, Ṡ 6 −βI(T )S on (T, +∞). We
thus infer that S(t) 6 e−βI(T )(t−T ) S(T ) for t > T , and thus S(t) → 0 as t → +∞, which is a
contradiction.
Let us now show (i). For all α ∈ [0, 1), we denote by uα (·) the control equal to α on (0, ∞).
Thanks to the same argument by contradiction as above, one has S∞ (uα ) 6 1/(αR0 ). Let us
denote by (S uα , I uα ) the solution to System (6) associated to uα . Lemma 1 shows that the
function t 7→ ΦαR0 (S uα (t), I uα (t)) is conserved, and we infer that S∞ (uα ) solves the equation
ΦαR0 (S0 , I0 ) = ΦαR0 (S∞ (uα ), 0).
Using the expression of α,
ΦαR0 (Sherd , 0) = ΦαR0 (S0 , I0 ) = ΦαR0 (S∞ (uα ), 0).
1
), we deduce that S∞ (uα ) = Sherd. It follows that
Since x 7→ ΦαR0 (x, 0) is bijective on (0, αR
0
for η > 0 small enough, there exists T > 0 such that for each t > T , I˙uα (t) 6 (βα(1 + η) βν −
ν)I uα (t) < 0. By using a Gronwall lemma, one infers that I uα (t) → 0 as t → +∞. Then, for
all k ∈ N∗ , there exists Tk > 0, such that |S uα (Tk ) − Sherd | 6 1/k and I uα (Tk ) 6 1/k. Consider
uk := α1(0,Tk ) + 1(Tk ,∞) and let us denote by (S uk , I uk ) the solution to System (6) associated to
uk . By continuity of ΦR0 ,

ΦR0 (S∞ (uk ), 0) = ΦR0 (S uk (Tk ), I uk (Tk )) −→ ΦR0 (Sherd , 0).
k→∞

Thus S∞ (uk ) −→ Sherd .
k→∞

Let us finally prove (ii). We show that α 7→ S∞ (uα ) is strictly decreasing. Let α1 , α2 ∈ [0, 1)
such that α1 < α2 and (S uα1 , I uα1 ) and (S uα2 , I uα2 ) the solutions to System (6) associated to uα1
and uα2 , respectively. Using Lemma 1, t 7→ Φα1 R0 (S uα2 (t), I uα2 (t)) is strictly increasing, hence
Φα1 R0 (S∞ (uα1 ), 0) = Φα1 R0 (S0 , I0 ) < Φα1 R0 (S∞ (uα2 ), 0).
Thanks to the equations satisfied by (S uα1 , I uα1 ) and (S uα2 , I uα2 ), one has S∞ (uα1 ), S∞ (uα2 ) 6
Sherd /α1 . Since x 7→ Φα1 R0 (x, 0) in strictly decreasing on (0, Sherd /α1 ), we deduce that S∞ (uα2 ) <
S∞ (uα1 ). This concludes the proof since S∞ (uα ) = Sherd.

3.3

Proof of Theorem 1

Solving (Pα,T ) involves the resolution of an ODE system on an infinite horizon, and it is quite
convenient to consider an equivalent version of this problem involving an ODE system on a bounded
horizon. A key point for this is that, according to Lemma 2, S∞ solves Eq. (13). Furthermore, since
the mapping [0, 1/R0 ] ∋ S 7→ ΦR0 (S, 0) is decreasing, maximizing S∞ is equivalent to minimize
9

ΦR0 (S∞ , 0). Combining all these observations yields that the optimal control problem is equivalent
to the following version we will investigate hereafter:
inf

u∈Uα,T

Φ
(Pα,T
)

JΦ (u),

where
JΦ (u) := ΦR0 (S(T ), I(T ))
and (S, I) solves the controlled system (6) associated to the control function u(·).
Proof of Theorem 1. For better readability, the proof of Theorem 1 is decomposed into several
steps.
Step 1: existence of an optimal control We will prove the existence of an optimal control for
Φ
Φ
the equivalent problem (Pα,T
). Let (un )n∈N be a maximizing sequence for Problem (Pα,T
). Since
(un )n∈N is uniformly bounded, we may extract a subsequence still denoted (un )n∈N with a slight
abuse of notation, converging towards u∗ for the weak-star topology of L∞ (0, T ). It is moreover
standard that Uα,T is closed for this topology and therefore, u∗ belongs to Uα,T . For n ∈ N, let
us denote (Sn , In ) the solution to the SIR model (6) associated to u = un . A straightforward
application of the Cauchy-Lipschitz theorem yields that (Ṡn , I˙n )n∈N is uniformly bounded. By
applying Ascoli’s theorem, we may extract a subsequence still denoted (Sn , In )n that converges
towards (S ∗ , I ∗ ) in C 0 ([0, T ]). As usually, we consider an equivalent formulation of System (6),
where (Sn , In ) can be seen as the unique fixed point of an integral operator. We then pass to
the limit and show that (S ∗ , I ∗ ) solves the same equation where u has been replaced by u∗ . By
combining all these facts with the continuity of ΦR0 , we then infer that (JΦ (un ))n∈N converges up
to a subsequence to JΦ (u∗ ), which gives the existence.
Step 2: optimality conditions and bang-bang property We will again establish these
Φ
). In what follows, for the sake of simplicity, we will
properties for the equivalent problem (Pα,T
Φ
consider and denote by u a solution to Problem (Pα,T
) and by (S, I), the associated pair solving
System (6). Observe first that integrating (12) in Lemma 1, one has
Z T
(u(t) − 1)I(t) dt.
JΦ (u) = ΦR0 (S(T ), I(T )) = ΦR0 (S0 , I0 ) + ν
0

It is standard to write the first order optimality conditions for such kind of optimal control
problem. To this aim, we use the so-called Pontryagin maximum principle (see e.g. [LM67]) and
introduce the Hamiltonian H defined on R4 by
H(S, I, pS , pI ) =
=

[−pS βuS + pI (βuS − ν) − ν(u − 1)] I
ν(1 − pI )I + (β(pI − pS )S − ν)Iu.

There exists an absolutely continuous mapping (pS , pI ) : [0, T ] → R2 called adjoint vector such
that the extremal ((S, I), (pS , pI ), u) satisfies a.e. in [0, T ]:
Adjoint equations and transversality conditions:
ṗS = βuI(pS − pI ),

ṗI = βuSpS − (βuS − ν)pI + ν(u − 1),

pS (T ) = 0,

pI (T ) = 0.

Maximization condition: for a.e. t ∈ [0, T ], u(t) solves the problem
max (β(pI (t) − pS (t))S(t) − ν)I(t)v

α6v61

10

(14a)
(14b)

and therefore, by using that I is nonnegative on [0, T ], one has
w>−

1
1
1
on {u = α}, w < −
on {u = 1}, w = −
on {α < u < 1},
R0
R0
R0

(15)

where w denotes the Lipschitz-continuous switching function given by w = S(pS − pI ).
By using (6), one computes
ẇ

=

−βuSI(pS − pI ) + S(−βuI(pI − pS ) + βuS(pI − pS ) − νpI − ν(u − 1))

=

−S (βuw + ν(pI + u − 1)) .

We will now prove that the optimal control can be written as uT0 defined in (8), for some
T0 ∈ [0, T ). From (14b), one has pS (T ) = pI (T ) = 0, and thus w(T ) = 0 > − R10 . According to
(15), this implies u(·) = α on a certain maximal interval [T0 , T ], for some T0 ∈ (0, T ), by continuity
of w. By inserting the relation w > − R10 holding on (T0 , T ) in the equation (14a) satisfied by pI ,
we deduce that ṗI > ν(pI − 1) on (T0 , T ). Since pI (T ) = 0, the Gronwall lemma yields
pI (t) 6 1 − eν(t−T ) ,

t ∈ [T0 , T ].

(16)

Then, either T0 = 0, in which case, u = u0 = α1[0,T ] + 1[T,+∞) (see (8)) or T0 > 0. Let us now
address this latter case. Since the interval (T0 , T ) is maximal by assumption and w is continuous,
one has necessarily w(T0 ) = −1/R0 . On the other hand, S and pI are continuous, with pI (T0 ) < 1
according to (16). Consequently, for any ε in the non-empty open interval (0, νS(T0 )(1 − pI (T0 )),
there exists a neighborhood VT0 of T0 on which


1
+ νS(1 − pI )
ẇ = −βuS w +
R0
∈ [νS(T0 )(1 − pI (T0 )) − ε, νS(T0 )(1 − pI (T0 )) + ε] a.e.
Since ε ∈ (0, νS(T0 )(1 − pI (T0 )), this implies that w is strictly increasing in VT0 . Therefore, there
exists a maximal open interval (T1 , T0 ) with T1 ∈ [0, T0 ) on which w < − R10 , and therefore on
which u = 1. As a consequence, the left-derivative of w at T0 exists and reads


1
−
ẇ(T0 ) = −βS(T0 ) w(T0 ) +
pI (T0 ) > 0.
(17)
R0
We will in fact show that T1 = 0. In other words, the control u can be written as (8).
To this aim, let us assume by contradiction that there exists T1 ∈ (0, T0 ) such that w(T1 ) =
− R10 = w(T0 ) and w < − R10 on (T1 , T0 ). Observing that w is differentiable on (T1 , T0 ) and using
Rolle’s theorem yields the existence of τ ∈ (T1 , T0 ) such that ẇ(τ ) = 0.
Note that, according to (14a), one has ẇ = −S ṗI , a.e. in (0, T ). Since S(τ ) > 0, one has also
ṗI (τ ) = 0. Using the fact that u = 1 on (T1 , T0 ), this means that the point (pI (τ ), w(τ )) is a
steady-state of the system
ẇ = −βSw − νSpI ,

ṗI = βw + νpI .

According to the Cauchy-Lipschitz theorem, we infer that (pI , w) is constant on [τ, T0 ] and therefore, ṗI (T0− ) = ẇ(T0− ) = 0, which is in contradiction with (17). As a conclusion, T1 = 0, and u
can be written as (8).

11

∗
Step 3: monotonicity of S∞,α,T
Let T > 0 and 0 6 α 6 α̃ < 1. It is straightforward that
∗
∗
Uα̃,T ⊂ Uα,T , and then S∞,α,T > S∞,
α̃,T . It follows that the map [0, 1) ∋ α 7→ maxu∈Uα,T S∞ (u)
is nonincreasing.
Let us show that the map T 7→ maxu∈Uα,T S∞ (u) is nondecreasing. Let 0 < T 6 T̃ , 0 6 α < 1,
∗
and denote by u∗ ∈ Uα,T the control realizing the maximum S∞,α,T
. Since u∗ = 1 in (T, T̃ ), one
has u∗ ∈ Uα,T̃ . Thus
∗
∗
.
S∞,α,
> S∞ (u∗ ) = S∞,α,T
T̃

Step 4: uniqueness of the optimal control The demonstration of the uniqueness of the
optimal control is achieved in the proof of Theorem 2 below, by demonstrating the uniqueness
of the optimal switching point T0 . Except this point, the demonstration of Theorem 1 is now
complete.

3.4

Proof of Theorem 2

Let us decompose this proof into several steps. We assume that α > 0, the case α = 0 will be
considered in the last step. In the whole proof, we will deal with control functions uT0 as defined
in formula (8).
Step 1: necessary first order optimality conditions on T0 Let u = uT0 be an optimal
control for problem (Pα,T ), with T0 be the associated optimal switching time. Let us introduce
the criterion jΦ given by
ν
jΦ (T0 ) := ΦR0 (S T0 (T ), I T0 (T )) = I T0 (T ) + S T0 (T ) − ln S T0 (T ),
β
where (S T0 , I T0 ) is the solution corresponding to the control uT0 , as previously defined. For the
sake of simplicity, we omit these subscripts in the sequel. Again, it is equivalent to maximize j
and to minimize jΦ . By using Lemma 2, one has
I(t) + S(t) −
I(t) + S(t) −
where c0 = I0 + S0 −

ν
β

ν
β ln S(t) = c0
ν
αβ ln S(t) = I(T0 )

+ S(T0 ) −

ν
αβ

ln S(T0 )

in [0, T0 ],
in [T0 , T ],

(18)

ln S0 . According to (18), we infer that S solves the system

ν
in (0, T0 ),
Ṡ = −βS(c0 − S + ln S),
β




ν
1
ν
Ṡ = −αβS c0 +
1−
ln S(T0 ) − S +
ln S ,
β
α
αβ

(19a)
in (T0 , T ),

with the initial data S(0) = S0 . Using (18), one gets
jΦ (T0 ) =
=
=

ν
ln S(T )
β


ν 1
ν
ln S(T0 ) +
− 1 ln S(T )
I(T0 ) + S(T0 ) −
αβ
β α


ν
ν
ν 1
c0 + ln S(T0 ) −
ln S(T0 ) +
− 1 ln S(T ),
β
αβ
β α

I(T ) + S(T ) −

so that the cost function reads
jΦ (T0 ) = c0 +

ν
β




 
1
S(T )
.
− 1 ln
α
S(T0 )
12

(19b)

The next lemma allows to compute the derivative of jΦ with respect to T0 . For the sake of
clarity, its proof is postponed to the end of this section.
\
b and S(T
Lemma 3. For all t ∈ [T0 , T ], the derivative S(t)
0 ) of the function S(·) and S(T0 ) with
∂S(t)
∂[S(T0 )]
2
\
b
respect to T0 , in other words S(t) = ∂T0 and S(T0 ) = ∂T0 , are given by


Z t
ds
b
S(t) = (α − 1)βS(t)I(t) 1 + νI(T0 )
T0 I(s)
and

\
S(T
0 ) = −βS(T0 )I(T0 ).

Thanks to this result, we may compute
!

 b
\
ν 1
S(T ) S(T
0)
′
jΦ (T0 ) =
−1
−
β α
S(T ) S(T0 )
!
!


Z T
ds
1
(α − 1)I(T ) 1 + νI(T0 )
+ I(T0 )
−1
= ν
α
T0 I(s)
!


Z T
1
I(T )
1
I(T )
= ν
.
− 1 I(T0 )(α − 1)
+ν
ds −
α
I(T0 )
1−α
T0 I(s)
By noting that
Z T
Z T ˙
Z T
Z T
ν
1
1
αβS(t) − ν + ν
1
I(t)
S(t)
dt
+
dt =
dt =
dt
2
I(t)
αβ
I(t)
αβ
I(t)
αβ
I(t)
T0
T0
T0
T0
!
Z T
1
1
1
1
−
+ν
dt ,
=
αβ I(T0 ) I(T )
T0 I(t)
we have for the function ψ defined in (9):
ψ(T0 ) =

1

α

−1



I(T )
+ν
I(T0 )

Z

T

T0

I(T )ds
1
−
I(s)
1−α

!

.

(20)

′
We deduce that jΦ
(T0 ) = 0 is equivalent to

ψ(T0 ) = 0.

(21)

′
Step 2: Zeros of jΦ
and uniqueness of the optimal switching
time According to (6), one

Rt
has for any t ∈ (T0 , T ), I(t) = I(T0 ) exp T0 (αβS(s) − ν) ds . Then, using the expression of ψ
given in (20), it follows that
!
Z T

1
− 1 exp
ψ(T0 ) =
(αβS(s) − ν) ds
α
T0
!
Z T
1
 Z T
1
+
exp
−1 ν
(αβS(s) − ν) ds dt − .
α
α
T0
t
2 To avoid any misunderstanding about the differentiability of S(·) with respect to T , let us make the use of S
b
0
precise. This function stands for the derivative of the function [0, T ] ∋ T0 7→ S(·, T0 ) ∈ C 0 ([T0 , T ]), where S(·, T0 )
is defined as the unique solution to (19b) on [T0 , T ], where S(T0 ) is defined as the value at T0 of the unique solution
to (19a). Defined in this way, the differentiability of this mapping is standard.

13

R

T
Introducing ϕ : [0, T ] → R defined by ϕ(s) = exp s (αβS(s) − ν) ds , the last expression writes
simply

1
 Z T
1
1
ϕ(t) dt − .
− 1 ϕ(T0 ) +
−1 ν
ψ(T0 ) =
α
α
α
T0
Differentiating this identity with respect to T0 yields
ψ ′ (T0 ) =

=

1

α

−1



−αβS(T0 ) + ν +

Z

T
T0

!

b ds ϕ(T0 )
αβ S(s)

!

1
Z T Z T
b
−ν
− 1 ϕ(T0 ) + ν
−1
αβ S(s) ds ϕ(t) dt
α
α
T0
t
!
Z T
1

b ds ϕ(T0 )
αβ S(s)
−1
−αβS(T0 ) +
α
T0
!
Z T Z T
1
b
−1
αβ S(s) ds ϕ(t) dt.
+ν
α
T0
t
1

As a consequence of Lemma 3, both terms in the previous formula are negative, and ψ ′ (T0 ) < 0.
The function ψ is thus decreasing on (0, T0 ). Moreover, ψ(T ) = −1 < 0. Therefore, if ψ(0) < 0,
′
then (21), or equivalently jΦ
(T0 ) = 0, has no solution, and thus T0∗ = 0. Conversely, if ψ(0) > 0,
then (21) admits a unique solution T0∗ which is the unique critical point of jΦ , and of j. In
particular, in the case ψ(0) = 0, one has T0∗ = 0.
We also deduce that the function jΦ is nonincreasing on (0, T0∗ ) and increasing on (T0∗ , T ), and
so is j.
Step 3: Upper bound on T0 Let us now prove that S T (T0∗ ) > Sherd, where, in accordance
with the notation defined after (8), (S T , I T ) is the solution to System (6) for u(·) = 1. Assume
by contradiction that S T (T0∗ ) < Sherd , i.e. T0∗ > (S T )−1 (Sherd ). Since I is non-increasing on
((S T )−1 (Sherd ), ∞), we have
I T ((S T )−1 (Sherd )) > I T (T0∗ ).
Due to the fact (obtained from Lemma 1) that
ΦR0 (S T ((S T )−1 (Sherd )), I T ((S T )−1 (Sherd ))) = ΦR0 (S T (T0∗ ), I T (T0∗ )),
we deduce that
Sherd −

1
1
ln(Sherd ) > S T (T0∗ ) −
ln(S T (T0∗ )).
R0
R0

(22)

Since S T (T0∗ ) ∈ (0, Sherd ) and x 7→ x − R10 ln(x) is decreasing on (0, Sherd), the inequality (22)
implies that S T (T0∗ ) > Sherd , which leads to a contradiction. We have thus demonstrated that
S T (T0∗ ) > Sherd .
Step 4: The case α = 0 Let us finally deal with the case “α = 0”. Using the fact that S is
constant on (T0 , T ), we deduce that pS (t) = 0 and pI (t) = 1 − eν(T0 −T ) for all t ∈ (T0 , T ). A
commutation occurs at T0 if, and only if,
Sherd = w(T0 ) = S(T0 )(1 − eν(T0 −T ) ).

(23)

Sherd
The function S is nonincreasing, thus there exists T0 > 0 satisfying this relation only if S0 > 1−e
−νT
S0
1
which is equivalent to T > ν ln S0 −Sherd . If this is the case, then, since t 7→ S(t) is nonincreasing

14

herd
is increasing, there exists a unique T0 satisfying the relation (23). We also
and T0 7→ 1−eSν(T
0 −T )
remark that (23) is equivalent to (21).
To achieve the proof of Theorem 2, it now remains to prove Lemma 3.

Proof of Lemma 3. Using the notation S T0 previously defined, one has (see (19b)) on (T0 , T )




ν
ν
1
1−
ln(S T0 (T0 )) − S T0 +
Ṡ T0 = −αβS T0 c0 +
ln S T0 ,
β
α
αβ
and, at T0 , S T0 (T0 ) is defined thanks to (19a) by
Z

S T0 (T0 )
S0

dv
βv(c0 − v +

ν
β

ln v)

= −T0 .

(24)

By differentiating (24) with respect to T0 , one infers


ν
T0
T0
T0
\
T
0
S (T0 ) = −βS (T0 ) c0 − S (T0 ) + ln(S (T0 )) = −βS T0 (T0 )I T0 (T0 ),
β
which is the second identity in Lemma 3.
Furthermore, using (19b), one has
Z

S T0 (t)

S T0 (T0 )

v(c0 +

ν
β

1−

1
α



dv
ln(S T0 (T0 )) − v +

ν
αβ

ln v)

= αβ(T0 − t),

t ∈ [T0 , T ].

Differentiating this relation with respect to T0 yields for all t ∈ (T0 , T ]
αβ =

S T0 (t)(c0 +

ν
β

1−

1
α



d
T0 (t)
S
ln S T0 (T0 ) − S T0 (t) +

ν
αβ

ln S T0 (t))

T0 (T )
S\
0
ln S T0 (T0 ) − S T0 (T0 ))
0 )(c0 +

 T
Z S T0 (t)
0 (T )
ν
1 S\
dv
0

−
1−
β
α S T0 (T0 ) S T0 (T0 ) v(c0 + βν 1 − α1 ln S T0 (T0 ) − v +

−

S T0 (T

ν
β

ν
αβ

ln v)2

.

Let us simplify this latter identity. Observe first that, because of (18), one has for all t ∈ (T0 , T ]


ν
1
ν
1−
ln S T0 (T0 ) = I T0 (t) + S T0 (t) −
ln S T0 (t).
c0 +
β
α
αβ

By using at the same time the change of variable v = S(t) and the identity c0 + βν 1 − α1 ln S(T0 )−
ν
S(t) + αβ
ln S(t) = I(t), holding true for any t ∈ (T0 , T ], we infer that
Z

S T0 (t)

S T0 (T0 )

βv(c0 +

ν
β

=



dv
ln S T0 (T0 ) − v +

ν
αβ

ln v)2
Z t
Z t
1
−αS T0 (s)I T0 (s)
ds
T0
Ṡ (s) ds =
ds = −α
.
T0 (s)(I T0 (s))2
T0 (s)
βS T0 (s)(I T0 (s))2
S
I
T0
T0

1−
Z t
T0

1
α

15

Combining all these facts leads to, for all t ∈ (T0 , T ],
αβ =

Z t
d
T0 (t)
ds
S
T0
(T
)
+
β
−
ν(1
−
α)βI
.
0
T
T
T
0
0
0
S (t)I (t)
T0 I (s)

Therefore, we arrive at, for all t ∈ (T0 , T ],

Z
T0
T0
T0
d
T
0
S (t) = (α − 1)βS (t)I (t) 1 + νI (T0 )

t

T0

ds
I T0 (s)



,

which is the first identity of the statement. This achieves the proof of Lemma 3, and consequently
of Theorem 2.

3.5

Proof of Theorem 3

Let T ∗ be the minimal time associated to the Minimal time problem. Let u∗α,T ∗ be the unique
solution of Problem (Pα,T ) associated to T = T ∗ . Assume by contradiction that u∗α,T ∗ does not
solve the minimal time problem, i.e. S∞ (u∗α,T ∗ ) < Sherd − ε. Then for each u ∈ Uα,T ∗ one has
S∞ (u) 6 S∞ (u∗α,T ∗ ) < Sherd − ε,
which is in contradiction with the fact that T ∗ solves the minimal time problem.
∗
. Let
Conversely, let T > 0 and u∗ realizing the maximum of (Pα,T ), i.e. S∞ (u∗ ) = S∞,α,T
∗
∗
T be the minimal time of intervention such that S∞ (u) > S∞,α,T for some u ∈ Uα,T ∗ . Since
∗
S∞ (u∗ ) = S∞,α,T
, we necessarily have T ∗ 6 T . By definition of T ∗ , there exists u ∈ Uα,T ∗ such
∗
that S∞ (u) > S∞,α,T . Consider v := u1(0,T ∗ ) + 1(T ∗ ,T ) . One has v ∈ Uα,T and
∗
S∞ (v) = S∞ (u) > S∞,α,T
.
∗
Hence, by definition of S∞,α,T
, one has v = u∗ . But v does not have the form of the minimal
solution in Theorem 1, unless T ∗ = T .

4

Numerical illustrations

This section is devoted to numerical illustrations around the optimal control problem (Pα,T ). The
codes are available on:
https://github.com/michelduprez/optimal-immunity-control.git
We use the parameter values given in Table 2, coming from [SKL+ 20] and corresponding to
the lockdown conditions in force in France between March 17th and May 11th 2020. We suppose
that, on the total population of 6.7e7 persons in France, there are no removed individuals and 1000
infected individuals at the initial time, i.e. R0 = 0 and I0 = 1e3/6.7e7.
Solutions to ODEs are computed with the help of a Runge-Kutta fourth-order method and the
research of the optimal controls is conducted thanks to the Algorithms described below.
Our approach rests upon the use of gradient like algorithms needing the computation of the
differential of S∞ in an admissible direction3 h. According to the proof of Theorem 1 (see below
3 More precisely, we call “admissible direction” any element of the tangent cone T
u,Uα,T to the set Uα,T at u. The
cone Tu,Uα,T is the set of functions h ∈ L∞ (0, T ) such that, for any sequence of positive real numbers εn decreasing
to 0, there exists a sequence of functions hn ∈ L∞ (0, T ) converging to h as n → +∞, and u + εn hn ∈ Uα,T for
every n ∈ N.

16

Parameter
β
ν
αlock
N
S0
I0
R0

Name
Probability of transmission
Rate at which the infected are removed
Lockdown in France (March-May 2020)
Total population in France
Initial proportion of susceptible
Initial proportion of infected
Initial proportion of removed

Value
0.29
0.1
0.231
6.7e7
1 − I0
1e3/N
0

Table 2: Value of the parameters used for system (1a)-(1b) (see [SKL+ 20])

Section 3.3), this differential reads
DS∞ (u) · h =

Z

T

(ν − βS(pI − pS ))Ih dt,

0

where (pS , pI ) denotes the adjoint state, solving the backward adjoint system (14a)-(14b). Thanks
to this expression of DS∞ (u) · h, we deduce a simple projected gradient algorithm to solve numerΦ
), then (Pα,T ). The algorithm is described in Algorithm
ically the optimal control problem (Pα,T
1. The projection operator PUα,T is given by
PUα,T u(t) = min{max{u(t), α}, 1},

for a.e. t ∈ [0, T ].

Algorithm 1 Solving Problem (Pα,T ) by projected gradient descent
Require: u0 ∈ Uα,T , ε > 0
1: while |S∞ (uk+1 ) − S∞ (uk )| > ε do
2:
Compute (Sk , Ik ) solution to the primal system (6)
3:
Compute (pS,k , pI,k ) solution to the dual system (14a)-(14b)
4:
Compute uk+1 := PUα,T (uk − ρk DS∞ (uk )) where ρk is the step, chosen variable such that
S∞ (uk+1 ) − S∞ (uk ) < 0.
5: end while
6: return uk+1
We recall that it is equivalent to maximize j and to minimize jΦ . According to Theorem 1,
eα,T , respectively, satisfy u∗ = uT ∗ , moreover jΦ is decreasing
solutions u∗ and T0∗ to (Pα,T ) and P
0
∗
∗
on (0, T0 ) and increasing on (T0 , T ). Taking advantage of this property, we also test a second
algorithm based on the bisection method. This method is described in Algorithm 2.
Let us compare the numerical solutions obtained with these approaches for each problem (Pα,T )
eα,T ). Optimal trajectories denoted respectively (S u∗ , I u∗ , Ru∗ ) and (S T0∗ , I T0∗ , RT0∗ ) associand (P
ated to the optimal control problems (Pα,T ) and (Peα,T ) are provided on Figures 3 and 4 for the
parameter choices α ∈ {0, αlock } and T = 100. To capture the full behavior of the trajectories, the
computation window is [0, 200]. One recovers all the theoretical results: the solutions to (Pα,T )
eα,T ) are as expected and do coincide.
and (P
∗
By using Lemma 2, it is easy to determine numerically the optimal value S∞,α,T
by solving the
equation
∗
∗
∗
ν
ν
∗
∗
− ln S∞,α,T
.
S u (T ) + I u (T ) − ln S u (T ) = S∞,α,T
β
β
17

eα,T ) (then (Pα,T )) by bisection method
Algorithm 2 Solving Problem (P

Require: k ∈ N∗
1: Initialization: T0,min,0 = 0 and T0,max,0 = T
2: for i = 1, . . . , k do
3:
T0,left = T0,min,i + (T0,max,i − T0,min,i )/3
4:
T0,right = T0,min,i + 2(T0,max,i − T0,min,i )/3
5:
Compute (Sleft , Ileft ), (Sright , Iright ) solutions to (5) for uT0,left , uT0,right
6:
if jΦ (T0,left ) > jΦ (T0,left ) then
7:
T0,min,i+1 = T0,left and T0,max,i+1 = T0,max,i
8:
else
9:
T0,min,i+1 = T0,min,i and T0,max = T0,right
10:
end if
11: end for
12: return T0,k+1 := (T0,max,k+1 + T0,min,k+1 )/2, uk+1 := uT0,k+1

∗
This allows to investigate numerically on Fig. 5 and 6 the dependency of S∞,α,T
and T0∗ with
respect to the parameters T and α. On Fig. 5, for T = 400, we observe numerically that the lower
bound α given in Proposition 1 and below which S can get as close as we want to Sherd over an
infinite horizon, is optimal (α ≈ 0.56). In particular, for lockdown conditions similar to the ones
in effect in France between March and May 2020 (α ≈ 0.231), it appears that it is possible to come
as close as we want to the optimal bound Sherd of inequality (4). Interestingly, we observe on Fig.
6-left that when α is not small enough we have T0 = 0 for T large enough.
We also mention that Fig 5-left gives the solution to the minimal time problem. Indeed, from
Theorem 3, a control u∗ is optimal for (Pα,T ) iff it is optimal for the minimal time problem. Then,
given ε > 0 and α 6 α, the minimal time of action such that the final value of susceptible is at a
distance ε of Sherd is obtained by computing the intersection of the curves in Fig 5-left with the
horizontal line Sherd − ε. As expected, when α is too large, i.e. when the lockdown is insufficient,
the solution stays far away from Sherd (see Fig 5-right).
Figure 7 represents the function jΦ for different values of α and T . We recover the fact that jΦ
is decreasing then increasing stated in Theorem 2. The fact that jΦ is non-convex highlights the
difficulty of the considered optimal control problem.

18

∗

Su
∗
Iu
u∗
R
Sherd

1
0.8

∗

S T0
∗
I T0
T0∗
R

1
0.8

0.6

0.6

0.4

0.4

0.2

0.2

0

0
0

50

100
150
Time (days)

u∗
uT0∗
0

200

50

100
150
Time (days)

200

∗
∗
∗
∗
∗
∗
Figure 3: Solutions (S u , I u , Ru , u∗ ) and (S T0 , I T0 , RT0 , uT0∗ ) to Problems (Pα,T ) and (Peα,T ) for
∗
α = 0.0 and T = 100 on the time interval [0, 200]. In this case S∞
= 0.282 and T0∗ = 61.9.

∗

Su
∗
Iu
u∗
R
Sherd

1
0.8

∗

S T0
∗
I T0
T0∗
R

1
0.8

0.6

0.6

0.4

0.4

0.2
0.2

u∗
uT0∗

0
0

50

100
150
Time (days)

0

200

0

50

100
150
Time (days)

200

Figure 4: Solutions (S u , I u , Ru , u∗ ) and (S T0 , I T0 , RT0 , uT0∗ ) to Problems (Pα,T ) and (Peα,T ) for
∗
α = αlock and T = 100 on the time interval [0, 200]. In this case S∞
= 0.259 and T0∗ = 59.2
∗

∗

∗

∗

∗

∗

Acknowledgments
The authors express their sincere acknowledgment to working groups Maths4Covid19 and OptimCovid19 for fruitful discussions and in particular their colleagues Luis Almeida (CNRS UMR
7598, LJLL, France), Emmanuel Franck (INRIA Grand-Est and IRMA Strasbourg, France), SidiMahmoud Kaber (Sorbonne Université, LJLL, France), Grégoire Nadin (CNRS UMR 7598, LJLL,
France), Benoı̂t Perthame (Sorbonne Université, LJLL, France).

19

α = 0 (opt.)
α = αlock (opt.)
α = 0.7 (opt.)
α = 0.8 (opt.)
Sherd

α = 0 (theo.)
α = αlock (theo.)
α = 0.7 (theo.)
α = 0.8 (theo.)

T = 100 (opt.)
T = 200 (opt.)
T = 400 (opt.)
Sherd

0.3

∗
S∞,α,T

∗
S∞,α,T

0.3

T = 100 (theo.)
T = 200 (theo.)
T = 400 (theo.)

0.2

0.2

0.1
0.1

0

50

100

150 200
T

250

0

300

0

0.2

0.4

0.6
α

0.8

1

∗
Figure 5: Graph of S∞,α,T
for Problem (Pα,T ) with respect to T for α ∈ {0, αlock , 0.7, 0.8} (left)
and with respect to α for T ∈ {100, 200, 400} (right) (opt.: Algo 2; theo.: Formula (10)).

References
[AAL20]

Fernando E Alvarez, David Argente, and Francesco Lippi, A simple planning problem
for covid-19 lockdown, Tech. report, National Bureau of Economic Research, 2020.

[Aba73]

Andris Abakuks, An optimal isolation policy for an epidemic, Journal of Applied
Probability 10 (1973), no. 2, 247–262.

[Aba74]

, Optimal immunisation policies for epidemics, Advances in Applied Probability 6 (1974), no. 3, 494–511.

[AER+ 14]

M Alkama, M Elhia, Z Rachik, M Rachik, and E Labriji, Free terminal time optimal
control problem of an SIR epidemic model with vaccination, International journal of
science and research 3 (2014), 227.

[AI12]

B Ainseba and M Iannelli, Optimal screening in structured SIR epidemics, Mathematical Modelling of Natural Phenomena 7 (2012), no. 3, 12–27.

[BBDMG19] Luca Bolzoni, Elena Bonacini, Rossella Della Marca, and Maria Groppi, Optimal control of epidemic size and duration with limited resources, Mathematical biosciences
315 (2019), 108232.
[BBSG17]

Luca Bolzoni, Elena Bonacini, Cinzia Soresina, and Maria Groppi, Time-optimal
control strategies in SIR epidemic models, Mathematical biosciences 292 (2017), 86–
96.

[Beh00]

Horst Behncke, Optimal control of deterministic epidemics, Optimal control applications and methods 21 (2000), no. 6, 269–285.

[DB80]

G Di Blasio, A synthesis problem for the optimal control of epidemics, Numerical
Functional Analysis and Optimization 2 (1980), no. 5, 347–359.

20

α = 0 (opt.)
α = αlock (opt.)
α = 0.7 (opt.)
α = 0.8 (opt.)

α = 0 (theo.)
α = αlock (theo.)
α = 0.7 (theo.)
α = 0.8 (theo.)

T = 100 (opt.)
T = 200 (opt.)
T = 400 (opt.)

60

40

40
T0∗

T0∗

60

T = 100 (theo.)
T = 200 (theo.)
T = 400 (theo.)

20

0

20

0

50

100

150
T

200

250

0

300

0

0.2

0.4

0.6

0.8

1

α

Figure 6: Graph of T0∗ for Problem (Pα,T ) with respect to T for α ∈ {0.0, αlock , 0.7, 0.8} (left) and
with respect to α for T ∈ {100, 200, 400} (right) (opt.: Algo 2; theo.: Formula (10)).

0.9

0.9
α = 0.0 T0∗ = 62.6
α = 0.2 T0∗ = 60.6
α = 0.4 T0∗ = 56.6
α = 0.6 T0∗ = 34.3
α = 0.8 T0∗ = 10.1
α = 1.0 T0∗ = 0.0

0.8

0.7
0

50

100
T0

150

jΦ

1

jΦ

1

α = 0.0 T0∗ = 63.6
α = 0.2 T0∗ = 60.6
α = 0.4 T0∗ = 57.6
α = 0.6 T0∗ = 15.2
α = 0.8 T0∗ = 0.0
α = 1.0 T0∗ = 0.0

0.8

0.7

200

0

50

100

150
T0

200

250

300

Figure 7: Graph of the optimal value jΦ with respect to T0 for T = 200 (left) and T = 300 (right).
[Gre88]

David Greenhalgh, Some results on optimal control applied to epidemics, Mathematical Biosciences 88 (1988), no. 2, 125–158.

[GS09]

Holly Gaff and Elsa Schaefer, Optimal control applied to vaccination and treatment
strategies for various epidemiological models, Mathematical Biosciences & Engineering 6 (2009), no. 3, 469.

[HD11]

Elsa Hansen and Troy Day, Optimal control of epidemics with limited resources,
Journal of mathematical biology 62 (2011), no. 3, 423–451.

[HZ13]

Qingwen Hu and Xingfu Zou, Optimal vaccination strategies for an influenza epidemic model, Journal of Biological Systems 21 (2013), no. 04, 1340006.

[JDHWM13] Majid Jaberi-Douraki, Jane M Heffernan, Jianhong Wu, and Seyed M Moghadas,
Optimal treatment profile during an influenza epidemic, Differential Equations and
Dynamical Systems 21 (2013), no. 3, 237–252.

21

[JDM13]

Majid Jaberi-Douraki and Seyed M Moghadas, Optimality of a time-dependent treatment profile during an epidemic, Journal of biological dynamics 7 (2013), no. 1,
133–147.

[KGZ15]

Igor D Kolesin, Elena Gubar, and Ekaterina Zhitkova, Optimal regime of double vaccination, 2015 International Conference ”Stability and Control Processes” in Memory
of VI Zubov (SCP), IEEE, 2015, pp. 248–251.

[KS20]

Thomas Kruse and Philipp Strack, Optimal control of an epidemic through social
distancing, Tech. report, April 2020.

[KZ16]

Igor D Kolesin and Ekaterina M Zhitkova, Optimization of immunocorrection of
collective immunity, Automation and Remote Control 77 (2016), no. 6, 1031–1040.

[LM67]

E. B. Lee and L. Markus, Foundations of optimal control theory, Wiley New York,
1967 (English).

[LT15]

Laetitia Laguzet and Gabriel Turinici, Globally optimal vaccination policies in the
SIR model: smoothness of the value function and uniqueness of the optimal strategies,
Mathematical biosciences 263 (2015), 180–197.

[MRPL20]

Dylan H Morris, Fernando W Rossine, Joshua B Plotkin, and Simon A Levin, Optimal, near-optimal, and robust epidemic control, arXiv preprint arXiv:2004.02209
(2020).

[MW74]

Richard Morton and Kenneth H Wickwire, On the optimal control of a deterministic
epidemic, Advances in Applied Probability 6 (1974), no. 4, 622–635.

[PS20]

Facundo Piguillem and Liyan Shi, The optimal COVID-19 quarantine and testing
policies, Tech. report, Einaudi Institute for Economics and Finance (EIEF), 2020.

[Shi19]

Eunha Shim, Optimal dengue vaccination strategies of seropositive individuals, Mathematical Biosciences and Engineering 16 (2019), no. 3, 1171–1189.

[SKL+ 20]

Henrik Salje, Cécile Tran Kiem, Noémie Lefrancq, Noémie Courtejoie, Paolo Bosetti,
Juliette Paireau, Alessio Andronico, Nathanaël Hozé, Jehanne Richet, Claire-Lise
Dubost, et al., Estimating the burden of SARS-CoV-2 in France, Science (2020).

[Wic75]

KH Wickwire, Optimal isolation policies for deterministic and stochastic epidemics,
Mathematical biosciences 26 (1975), no. 3-4, 325–346.

[Wic79]

K Wickwire, Optimal immunization rules for an epidemic with recovery, Journal of
Optimization Theory and Applications 27 (1979), no. 4, 549–570.

[YWZZ15]

Kuan Yang, Ermei Wang, Yinggao Zhou, and Kai Zhou, Optimal vaccination policy
and cost analysis for epidemic control in resource-limited settings, Kybernetes (2015).

[ZWW13]

Yinggao Zhou, Jianhong Wu, and Min Wu, Optimal isolation strategies of emerging
infectious diseases with limited resources, Math Biosci Eng MBE 10 (2013), 1691–
1701.

22

