arXiv:2009.12649v5 [stat.AP] 21 Jan 2021

Estimation of the incubation time
distribution for COVID-19
Piet Groeneboom
Delft Institute of Applied Mathematics, Delft University of Technology
Abstract
We consider smooth nonparametric estimation of the incubation time distribution of COVID-19, in connection with the investigation of researchers from
the National Institute for Public Health and the Environment (Dutch: RIVM)
of 88 travelers from Wuhan: Backer et al. (2020). The advantages of the smooth
nonparametric approach w.r.t. the parametric approach, using three parametric
distributions (Weibull, log-normal and gamma) in Backer et al. (2020) is discussed.
It is shown that the typical rate of convergence of the smooth estimate of
the density is n2/7 in a continuous version of the model, where n is the sample
size. The (non-smoothed) nonparametric maximum likelihood estimator (MLE)
itself is computed by the iterative convex minorant algorithm (Groeneboom and
Jongbloed (2014)). All computations are available as R scripts in Groeneboom
(2020a).

Keywords: incubation time, smooth nonparametric density estimation, nonparametric
MLE, Weibull distribution, iterative convex minorant algorithm
Running headline: incubation time distribution

incubation time distribution

1

Introduction

Researchers from the Centre for Infectious Disease Control and Prevention of the National Institute for Public Health and the Environment (Dutch: RIVM) analyze in
Backer et al. (2020) a data set of 88 travelers who are assumed to have picked up the
COVID-19 virus in Wuhan. The distribution of their incubation times is estimated
using certain simple distributions, like Weibull, log-normal and gamma. If the only
thing we know about the start of the incubation time is that it belongs to an interval
[0, Ei ], the log likelihood for one observation is:
Z
log
g(Si ‚àí t) dFi (t).
t‚àà[0,Ei ]

Here Ei would be the upper bound for the exposure interval, for which we take (looking
back) 0 as the left point for the ith individual (see Britton and Scalia Tomba (2019)),
Si is the time where the person becomes symptomatic (note that both Si ‚â§ Ei and
Si > Ei can occur), and Fi would be the distribution function of the time of a possible
contact with an infector. The exit times and times of becoming symptomatic of the 88
Wuhan travelers are shown in Table 1.
i Ei
1
5
2 30
3 21
4
1
5
1
6
8
7
4
8
3
9 33
10 33
11 8
12 1
13 20
14 20
15 30
16 35
17 3

Si
5
33
22
4
6
8
4
3
34
34
8
4
21
28
32
38
7

i Ei
45 39
46 35
47 2
48 36
49 38
50 1
51 38
52 38
53 38
54 11
55 36
56 11
57 40
58 36
59 36
60 36
61 27
2

Si
40
42
6
37
39
8
41
41
39
11
39
11
41
37
41
39
31

incubation time distribution
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44

35
36
31
34
29
36
3
7
38
30
28
35
33
3
2
2
5
36
31
41
41
3
38
39
39
39
33

37
38
38
35
31
37
8
9
39
36
36
36
34
8
4
5
5
37
35
42
42
4
39
41
41
41
39

62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88

38
36
40
41
37
1
40
40
31
40
40
41
41
4
4
40
36
36
40
36
38
2
38
37
41
40
40

40
42
43
43
43
7
42
42
39
41
41
42
43
5
5
41
40
40
42
42
43
9
43
43
42
43
43

Table 1: Exit times and times of becoming symptomatic of the 88 Wuhan travelers
after shifting the entrance times to 0.
It is clear that, without further assumptions, g and Fi are not identifiable. To
remedy this, we assume, as in Backer et al. (2020) (see also Reich et al. (2009)), that Fi
is the uniform distribution on [0, Ei ]. If we want to use maximum likelihood, we have

3

incubation time distribution
to maximize
n
X

Z

Ei

g(Si ‚àí t) dt/Ei ,

log

i=1



t=0

and since the Ei do not matter in the maximization problem, we end up with the
problem of maximizing
Z Ei

n
X
log
g(Si ‚àí t) dt
(1)
i=1

t=0

where g is the density of the incubation time.
So we deal with the following model. We have an exit time Ei for the exposure
interval, an infection time Vi and an incubation time Wi . The time of becoming symptomatic is denoted by Si , and Si is assumed to be the independent sum of Vi and Wi .
Our observations are
(Ei , Si , ‚àÜi ) ,

i = 1, . . . , n,

(2)

where n is the sample size and where the indicator ‚àÜi is defined by
‚àÜi = 1{Si ‚â§Ei } ,

i = 1, . . . , n.

(3)

Using the present notation, the log likelihood for the incubation time distribution function G becomes
`(G) =

n
X

[‚àÜi log G(Si ) + (1 ‚àí ‚àÜi ) log {G(Si ) ‚àí G(Si ‚àí Ei )}] .

(4)

i=1

Note that the time of becoming symptomatic is still in Wuhan if ‚àÜi = 1.
The algorithms we used for analyzing the data set can be found on Groeneboom
(2020a). We describe the data files given there. The original data file is data Wuhan tsv,
which gives details on the persons in the sample and which can be found in Backer et al.
(2020). This was transformed into a data file transformed data Wuhan.txt, consisting of three columns, giving, respectively, the arrivals in (if available) and departures
from Wuhan and the time the person became symptomatic. If the arrival time was
not available (possibly because the person was a Wuhan resident), this time was set to
‚àí18, which means 18 days before December 31, 2019, which is the zero on the time
4

incubation time distribution
scale. For traveler number 67, who apparently had a connecting flight, the duration of
stay in Wuhan was changed from 0 to 1 day. This, in turn, was transformed into the
input file inputdata Wuhan.txt, where the time, spent in Wuhan, was shifted making
the left point equal to zero, and consists of two columns: the first colums contains the
data Si ‚àí Ei (time of becoming symptomatic minus exit time from Wuhan) and Si ,
time of becoming symptomatic, where all times are shifted to have entrance time zero.
If the person became symptomatic in Wuhan we put Ei equal to Si , so Si ‚àí Ei = 0.
Assuming that the distribution of the possible time of infection is uniform on the exposure interval, and estimating the distribution function G by the Weibull distribution,
parametrized as
G(x) = Ga,b (x) = 1 ‚àí exp {‚àíbxa } ,

x > 0,

(5)

we get as our maximum likelihood estimaters of the parameters a and b:
aÃÇ = 3.03514,

bÃÇ = 0.002619.

(6)

Using the Weibull maximum likelihood method, the estimate was computed by
two methods. One is a very simple method using Weibull.cpp, which is used in
analysis EM.R and analysis ICM.R, where also the nonparametric estimate to be
discussed in the next sections is computed. For this ‚Äúpattern search‚Äù algorithm for
looking for the parameters of the Weibull distribution one does not have to compute
the derivatives of the log likelihood. It is based on the Hooke-Jeeves algorithm. The
other one can be found in R Weibull Estimation.R, where we use the R package lbfgs,
and where the gradient (derivatives of the log likelihood) has to be provided.
The results obtained for the Weibull distribution approach of the two algorithms
are remarkably similar. The values in (6) were produced by the R script in Groeneboom
(2020a), using the Hooke-Jeeves algorithm. For a convergence proof of the Hooke-Jeeves
algorithm and interesting further discussion of the pattern search algorithms, see Kolda
et al. (2003) and Torczon (1997).
The aim of the present paper, however, is to draw attention to the nonparametric
maximum likelihood estimator (the MLE) of the incubation time distribution, which is
often also denoted by NPMLE (Nonparametric Maximum Likelihood Estimator). This
is the distribution function GÃÇn , maximizing (4) over all distribution functions G. The
problem of maximizing (4) over all distribution functions G instead of just Weibull, lognormal or gamma distribution functions is non-trivial and discussed in Section 2. We
5

incubation time distribution

1.0

0.8

0.6

0.4

0.2

0.0
0

2

4

6

8

10

12

14

Figure 1: The nonparametric maximum likelihood estimate (MLE) GÃÇn of the incubation
time distribution function (blue), and the MLE using the Weibull distribution (red,
dashed), for the data set analyzed in Backer et al. (2020).
also discuss the smooth estimators based on the MLE, the so-called SMLE (Smoothed
Maximum Likelihood Estimator) and the nonparametric density estimator, based on
the MLE.
When we want to get an idea of properties of the incubation time distribution,
there are (at least) three approaches.
1. We ‚Äúfit‚Äù the data with a parametric distribution from a well-known famiily of
distributions like the Weibull, log-normal or gamma distributions. The big disadvantage of this approach is that one usually does not have a good argument for
choosing one of these distributions and that important aspects of the data might
be completely hidden by the choice of such a distribution.
Convincing examples of this situation are given in Chapter 1 of Silverman (1986).
If one fits the multimodal distribution of the eruptions of the Old Faithful Geyser
in Yellowstone Park, Wyoming, by a unimodal distribution, one will only see
one mode instead of the multiple modes that really are there. In that chapter
also other interesting examples of how special aspects of the data are revealed by
6

incubation time distribution
nonparametric density estimation are given.
In fact, estimates of the simple parametric type such as the Weibull, etc. will
usually be inconsistent: no matter how many observations one has, there will
not be convergence to the right distribution. The ubiquitous appearance of the
normal distribution has a completely different origin: the central limit theorem.
But this reasoning will generally not apply in the same way for fitting with the
Weibull, etc. distribution.
Another disadvantage which clearly shows up if people use this method (as in
Backer et al. (2020)) is that one usually has to introduce several families of distributions (gamma, log-normal, Weibul . . . ), because there is no compelling reason
to pick one of these.
2. We compute the nonparametric MLE. The result for the Wuhan data is shown in
Figure 1 and the bar chart of the point masses of the MLE is shown in Figure 2
(the values of the point masses are shown in Table 2).
This is what one gets if one makes no assumptions at all about the distribution
function and this is the ‚Äúantipode‚Äù of the fitting with the Weibull etc. distribution. Figure 2 clearly shows a bimodal discrete density, but one wonders: is this
bimodality due to chance fluctuations or is it real? Note that this discrete density
is rather different from the density estimation of Silverman (1986), mentioned in
point 1. In the latter case one assumes the existence of a (continuous) density
with respect to Lebesgue measure instead of a discrete density.
How do we view the distribution of the incubation time? My own inclination is
to assume the existence of a continuous density with respect to Lebesgue measure
for the incubation time distribution and to use methods as in Silverman (1986),
which entails smoothing. Which takes us to:
3. We estimate the density of the incubation time with respect to Lebesgue measure in a nonparametric way. In this case we also need an extra parameter, the
smoothing parameter or bandwidth. Now one could argue (as has been done):
‚ÄúAh, you objected in point 1 to the use of parametric distributions such as for
example the Weibull distribution, but now you introduce a parameter again, the
bandwidth!‚Äù. Fair enough, but: ‚ÄúThe bandwidth is a parameter of a totally different nature than the parameters of the Weibull distribution!‚Äù. With the bandwidth
one tries to mediate between the noise and the bias, something we cannot do with
the nonparametric estimate, introduced in point 2. Moreover, we can do this in
7

incubation time distribution
a data-adaptive way, to create independence of a priori assumptions, a type of
independence we cannot achieve with the estimates in point 1 above.
We must add, however, that the density estimation problem here is considerably more difficult than the density estimation problems considered in Silverman
(1986). This is caused by the fact that our observations are indirect; we assume
that the infection took place during the stay in Wuhan, but we do not know
when. We only have an interval for this infection time. For this situation we have
to use the so-called interval censoring model, which is for example discussed in
Groeneboom and Jongbloed (2014). In fact, we have to deal with a combination
of interval censoring (the infection time is contained in an interval, we cannot
observe it directly) and deconvolution, since we have to extract the information
from the sum of the infection time and the incubation time. For this reason we
get slower rates of convergence of the density estimate: n2/7 instead of the usual
rate of convergence in density estimation, which is n2/5 (see Silverman (1986) for
the latter rate). An additional complication is that the observations are usually
discretized, but we analyze in the sequel both the continuous model just described
in Section 4 and the discretized model for which we cannot hope to achieve rate
n2/7 at each point.
Similar considerations hold for the SMLE, estimating the distribution function.
In this case we also need a bandwidth (smaller than the bandwidth for the density
estimate) and the rate will be n2/5 , which is the rate in ordinary density estimation. So in this sense the SMLE is comparable to an ordinary density estimate
and the density estimate for the incubation time distribution is comparable to
the ordinary estimate of the derivative of a density.
In this paper we focus on the method, described under point 3 above and give
algorithms for computing the estimators. R scripts for all these methods are given in
Groeneboom (2020a).
It should be noted that the asymptotic distribution of the MLE itself is unknown.
In the continuous (not discretized) model it is expected to have the Chernoff limit
distribution (location of the maximum of two-sided Brownian motion minus a parabola),
but at present this is unknown, as it also is for the related limit distribution of the
MLE in the so-called interval censoring, case 2, model (see Groeneboom and Jongbloed
(2014)).
But we do not need the limit distribution of the MLE itself for deriving the (nor8

incubation time distribution
mal) limit distributions of the SMLE and density estimate, based on the MLE. As an
example, we give the derivation for the limit distribution of the density estimate in
the simulation model discussed in Section 4 in the appendix (Section 6). The fit of
the variances, predicted by the asymptotic theory and the variances coming from the
simulation study is remarkably good, see Table 3 and Figure 9.

2

Algorithms for computing the nonparametric maximum likelihood estimator

The EM iterations for the MLE maximizing (1), without making this parametric restriction, are in this case given by:
p0j = pj n‚àí1

n
X

1{j‚àà(Si ‚àíEi ,Si ]}

i=1

.

X

pk ,

(7)

k‚àà(Si ‚àíEi ,Si ]

where the ratios are zero if the denominators are zero. The implementation of this
algorithm for the present situation can be found in analysis EM.R in Groeneboom
(2020a).
The EM iterations were started with the discrete uniform distribution on the 43
points 1, . . . , 43, which corresponds to the range of values (days) in Table 1, but withdrew its mass after 10, 000 iterations to the 7 points 3, . . . , 9, which leads to the discrete
distribution function, shown in Figure 1. A bar chart of the corresponding probability
masses is shown in Figure 2. It is seen that this is a bimodal discrete probability distribution with modes at resp. 4 and 9 days, with the highest value at the second mode.
This discrete probability distribution is also given in Table 2.
The iteration steps (7) folllow from the so-called self-consistency equations, which
are derived by differentiating the criterion function
Ô£±
Ô£º
( m
)
n
Ô£≤
Ô£Ω
X
X
X
n‚àí1
log
pj ‚àí Œª
pj ‚àí 1 ,
(8)
Ô£≥
Ô£æ
i=1

j‚àà(Si ‚àíEi ,Si ]

j=1

w.r.t. pi , where in this case m = 43, and Œª is a nonnegative Lagrange multiplier, chosen

9

incubation time distribution

0.25

0.20

0.15

0.10

0.05

0.00
3

4

5

6

7

8

9

Figure 2: Bar chart of the probability masses of the nonparametric MLE
in such a way that
m
X

pj = 1.

(9)

j=1

This yields
n‚àí1

n
X
i=1

1{j‚àà(Si ‚àíEi ,Si ]}

.

X

pk = Œª,

j = 1, . . . m,

(10)

k‚àà(Si ‚àíEi ,Si ]

and multiplying these relations with pj and summing over j yields Œª = 1, using the side
condition (9). But the relations (10) only hold for the active (in this case 7) parameters
pi > 0 of the solution; in the iterations (7) the inactive parameters pi will tend to zero.
For more details, see, e.g., Groeneboom and Jongbloed (2014), Section 7.2.
Because of the monotonicity of the distribution function G, maximizing the log
likelihood over all distribution functions G is an isotonic regression problem, which can
be solved by specific isotonic methods. In the present case we can apply the iterative
convex minorant algorithm, discussed in Groeneboom and Jongbloed (2014), Section
7.3.
10

incubation time distribution
Number of days
3
4
5
6
7
8
9

pi
0.0463850922
0.2466837048
0.0024858945
0.1126655228
0.1347501680
0.2058210187
0.2512085991

Table 2: Probability masses of the nonparametric MLE.
As discussed in Section 1, the log likelihood is of type:
f (y) =

m
X

ki log (G(Ui ) ‚àí G(Ti )) ,

(11)

i=1

where ki is the number of observations (Ti , Ui ), and where
(Ti , Ui ) = (0, Vi + Wi ) 1{Vi +Wi ‚â§Ei } + (Vi + Wi ‚àí Ei , Vi + Wi ) 1{Vi +Wi >Ei }

i = 1, . . . , n,
(12)

where n = 88, and where Vi is the infection time, Wi the incubation time and, as before,
Ei the exit time of the travelers from Wuhan, where all observations are centred by
subtracting the entrance time.
We first make the so-called preliminary reduction to reduce the problem to a maximization problem in the interior of a convex cone of type

y = (y1 , . . . , ym )T : 0 < y1 ‚â§ ¬∑ ¬∑ ¬∑ ‚â§ ym .
For the Wuhan data set it can be checked that, without loss of generality, G(i) = 0,
i ‚â§ 2, and G(i) = 1, i ‚â• 9, since in this case values strictly between 0 and 1 can only
make the likelihood smaller. If we make this preliminary reduction, the log likelihood
for the ordered parameters yi , representing the values of the distribution function G at
the observation points, becomes:
X
Nij log (yj ‚àí yi ) ,
(13)
f (y) =
0‚â§i<j‚â§7

11

incubation time distribution
where yi = G(i + 2), i = 0, . . . , 7, y0 = 0, y7 = 1, and where the triangular array (Nij ),
0 ‚â§ i < j ‚â§ 7, is given by:
1 3 4 0
2 1 0
0 1
1

0
0
1
0
1

2
0
0
2
0
1

0
9
4
3
6
3
3

We have to maximize (11) under the restriction 0 < y1 ‚â§ ¬∑ ¬∑ ¬∑ ‚â§ y6 ; by the preliminary reduction, we lost the additional condition y6 < 1. Let y = (y1 , . . . , y6 )T . The
(Fenchel) sufficient and necessary conditions for the solution are:
6
X
‚àÇ
f (y) ‚â§ 0,
‚àÇy
j
j=i

i = 1, . . . , 6,

(14)

and
6
X
i=1

yi

‚àÇ
f (y) = 0,
‚àÇyi

(15)

where f is defined by (11). Since the values yi are strictly between 0 and 1, (15) can
only hold if also
6
X
‚àÇ
f (y) = 0,
‚àÇyi
i=1

and we can therefore turn (14) into
i
X
‚àÇ
f (y) ‚â• 0,
‚àÇy
j
j=1

i = 1, . . . , 6.

(16)

The resulting (nonparametric) MLE FÃÇn is shown in Figure 1, together with the MLE
assuming that G is a Weibull distribution. The EM algorithm and the iterative convex
minorant (ICM) algorithm give exactly the same solutions, but the ICM algorithm
12

incubation time distribution
needs less iterations (106 in this case; the EM algorithm needs between 1000 and
10, 000 iterations).
To compute the MLE via the iterative convex minorant algorithm, we have to
construct so-called cusum (cumulative sum) diagrams. The cusum diagram consists of
the point (0, 0) and the points

i 
X
‚àÇ
f (y) + wj yj ,
i = 1, . . . , 6,
(17)
wj ,
‚àÇy
j
j=1
where
wj = ‚àí

‚àÇ2
f (y).
‚àÇyj2

j = 1, . . . , 6.

(18)

At each iteration step the left derivative vector y 0 of the greatest convex minorant of
the cusum diagram is computed on the basis of the current value y, and the stationary
point of this iteration is the solution of the optimization problem. We perform line
search in case the full step to y 0 would not lead to improvement or would go out of
bounds. For more theory, see Groeneboom and Jongbloed (2014).
As in Groeneboom and Jongbloed (2014), section 1.2, we can compute the smoothed
maximum likelihood estimator (SMLE) and also an estimate of the density. The SMLE
is defined by
Z
GÃÉnh (t) = K((t ‚àí y)/h) dGÃÇn (y),
(19)
where h > 0 and K is an integrated kernel
Z x
K(x) =
K(u) du.

(20)

‚àí‚àû

Here K is a symmetric kernel with support [‚àí1, 1], for example the triweight kernel
3
35
1 ‚àí u2 1[‚àí1,1] (u).
(21)
K(u) =
32
We estimate the density by
Z
‚àí1
K((t ‚àí y)/h) dGÃÇn (y).
(22)
gÃÉnh (t) = h
For the present analysis we took h = 3.6 in (19) and h = 4.6 in (22); these bandwidths
were chosen by a bootstrap method, explained in Section 3. The resulting estimates
are shown in Figure 3.
13

incubation time distribution

1.0
0.15
0.8

0.6

0.10

0.4
0.05
0.2

0.0

0.00
0

2

4

6

8

10

12

14

0

(a)

2

4

6

8

10

12

14

(b)

Figure 3: (a): The smoothed nonparametric maximum likelihood estimate (SMLE)
of the incubation time distribution function (blue), and the MLE using the Weibull
distribution (red, dashed), for the data set analyzed in Backer et al. (2020) and (b):
the smoothed nonparametric maximum likelihood estimate of the incubation time density function (blue), and the MLE of the density using the Weibull distribution (red,
dashed), for the data set analyzed in Backer et al. (2020).

3

Data-adaptive bandwidth choice for the density
estimate and the SMLE

Let the random variables Ei with values on the integers (‚Äúdays‚Äù) on the interval [1, 43]
represent the exit times. Furthermore, let Vi denote the (unknown) infection time,
which we take, conditionally on Ei , to be uniform on [0, Ei ], and let Wi denote the
(again unkown) incubation time. Our observations are the triples (Ei , Si , ‚àÜi ), given by
(2).
To determine the bandwidth h of our density estimator
Z
gÃÇnh (t) = Kh (t ‚àí y) dGÃÇn (y),

(23)

where GÃÇn is the MLE of the distribution function G of the incubation time, we follow
a method somewhat similar to the method used in Sen and Xu (2015).
14

incubation time distribution

0.021

0.020

0.019

0.018

0.017

0.016
3

4

5

6

7

ÀÜ g (h), given by (24), as function of h.
Figure 4: MSE
We take B = 10, 000 bootstrap samples of observations (Ei , Si‚àó , ‚àÜ‚àói ), corresponding
to the observations (Ei , Si , ‚àÜi ). The Si‚àó are generated as the sums (rounded to the
nearest integer) of a Uniform(0, Ei ) random variable Vi‚àó and a random variable Wi‚àó ,
generated from the density gÃÇnh0 by rejection sampling for a fixed h0 , for which we took
h0 = 4 in the present case. The ‚àÜ‚àói are given by
‚àÜ‚àói = 1{Vi‚àó +Wi‚àó ‚â§Ei } .
Note that we keep the Ei the same as in the original sample, somewhat analogously
to the procedure followed in Sen and Xu (2015), which relieves us from the duty to
estimate the exit time distribution.
Next we computed
ÀÜ g (h) = B ‚àí1
MSE

B Z
X

‚àó
{gÃÇnh
(x) ‚àí gÃÇnh0 (x)}2 dx.

(24)

b=1

ÀÜ g (h) is shown in Figure 4, which gave as the minimizing
The resulting loss function MSE
bandwidth hÃÇ ‚âà 4.6. Taking h0 = 3 in our function of reference gÃÇnh0 gave the same
15

incubation time distribution
minimizing value. The (approximate) independence of the starting value h0 was also
observed for the analogous bandwidth selection procedure in Sen and Xu (2015).
Similarly, we computed
ÀÜ G (h) = B
MSE

‚àí1

B Z n
X

GÃÇ‚àónh (x) ‚àí GÃÇnh0 (x)

o2

dx,

(25)

b=1

as a function of h by the same bootstrap procedure, where GÃÇ‚àónh was computed for
the bootstrap samples. The integrals were approximated by Riemann sums with step
size 0.1 on the interval [0, 14]. The R scripts for this procedure can again be found
on Groeneboom (2020a). The method used here is called the ‚Äúsmoothed bootstrap‚Äù,
because we generate the bootstrap samples from the smooth estimate gÃÇnh0 of the density
of the incubation time (added to a uniform[0, Ei ] random variable) instead of just
resampling with replacement from the data (Ei , Si , ‚àÜi ), as one would do in the ordinary
bootstrap.
A perhaps slightly unorthodox variant of the present method is the smooth bootstrap where we do not round the sums of Vi‚àó and Wi‚àó to the nearest integer, but just
use them as continuous variables (for more information on the continuous model see
the next session). The unorthodox aspect is that, in our bootstrap experiment, we
do not recreate exactly the same situation as in our original setting, where the data
are integers. In fact, we create data for the continuous model, where we can easier
compare bias and variance. We tried this out for the density estimates, and it actually
gave exactly the same minimizing bandwidth h = 4.6 for the least squares criterion.
More research on this method is necessary, though.

4

The continuous model

Applying the method of the preceding section to the discrete data, where one only uses
days on the time axis, is somewhat dubious, since, in fact, we do not have information
on a finer scale, which would allow us to let the bandwidth (and therefore the bias)
tend to zero. It is conceivable that we have information on a finer scale, for example
the time of the outgoing flight or the time of day of becoming symptomatic. Presently
both times are interval censored (where one day is the interval). We could therefore
introduce another assumption, for example that the time of becoming symptomatic is
uniformly distributed over a day. In any case, there seems to be enough reason to study
16

incubation time distribution
the continuous model, where one would have (approximately) continuous observations,
and to analyze what can be expected in this case.
We define as before the indicator ‚àÜ by
‚àÜ = 1{S‚â§E} ,

(26)

where E is again the exit time and S is the time of becoming symptomatic, and consider
the following simulation experiment. Ei is uniform[0, M ], the time of infection Vi is a
Uniform random variable on [0, Ei ], conditionally on Ei , and the incubation time Wi is a
truncated Weibull(a, b) distribution, where a and b have the same values as the estimates
aÃÇ and bÃÇ in (6), respectively, and where the truncation interval [0, M1 ] is contained in the
interval [0, M ]. In the present simulation, we took M1 = 20 and M = 30. In this way
the upper bound for the observations Si is equal to 50, which is somewhat comparable
with the upper bound 43 of the observations Si for the Wuhan travelers. This means
that Si = Vi + Wi , where we assume that Vi and Wi are independent, and that our
observations are the triples (Ei , Si , ‚àÜi ).
The MLE of the incubation time, where Ei and Si are known, looks rather different
from the MLE based on the discretized observations shown in Figure 1. An example
of such an MLE is shown in Figure 5 for a sample of n = 1000. Since in this case the
MLE can have more jumps, it has the possibility to be much closer to the continuous
distribution function. It maximizes again expression (1), but this time the variables Ei
and Si are not discretized.
In this setup, the SMLE will, in the interior of the interval [0, M1 ], pointwise have
the n2/5 rate and the corresponding nonparametric density estimate the n2/7 rate of
convergence, and the pointwise limit distributions will be normal in both cases (see
Section 6 of the present paper and Groeneboom and Jongbloed (2014), section 11.4).
For the density estimate in the present simulation model we get the following result.
Theorem 1. Let gÃÉn,hn be the estimate of the density, defined by
Z
Z
‚àí1
gÃÉn,hn (t) = h
K((t ‚àí y)/hn ) dGÃÇn (y) = Khn (t ‚àí y) dGÃÇn (y),
where hn ‚àº cn‚àí1/7 , for some c > 0. Let the score function Œ∏t,h,G be defined by
Œ∏t,h,G (e, s, Œ¥) = Œ¥

œÜ(s) ‚àí œÜ(s ‚àí e)
œÜ(s)
+ (1 ‚àí Œ¥)
,
G(s)
G(s) ‚àí G(s ‚àí e)}
17

(27)

incubation time distribution
where Œ¥ is the indicator Œ¥ = 1{s‚â§e} and where œÜ solves the integral equation

Z w 
1
œÜ(w) ‚àí œÜ(w ‚àí e)
œÜ(w)
1 œÜ(w + e) ‚àí œÜ(w)
log(M/w) +
‚àí
de
‚àí
M G(w)
M e=0 e G(w + e) ‚àí G(w) G(w) ‚àí G(w ‚àí e)
Z M
1
1 œÜ(w + e) ‚àí œÜ(w)
+
de
M e=w e G(w + e) ‚àí G(w)
‚àÇ
=
Kh (w ‚àí t),
(28)
‚àÇw
defining 0/0 = 0. Let Pn be the empirical probability measure of a sample (E1 , S1 , ‚àÜ1 ),
. . . , (En , Sn , ‚àÜn ). Then we have, taking h = hn ‚àº cn‚àí1/7 , for a c > 0, and G = G0
(the underlying incubation time distribution) in (27) and (28),


Z
Z

D
2/7
2/7
n
gÃÉn,hn (t) ‚àí Khn (t ‚àí y) dG0 (y) = n
Khn (t ‚àí y) d GÃÇn ‚àí G0 (y) ‚àí‚Üí N (0, œÉ 2 ),
(29)
where N (0, œÉ 2 ) is a normal distribution with mean zero and variance œÉ 2 given by:


Z
2
2/7
œÉ = lim var n
Œ∏t,hn ,G0 (e, s, Œ¥) dPn (e, s, Œ¥) .
n‚Üí‚àû

A sketch of the proof is given in the Appendix and the rather good fit of the
simulated variance and the variances predicted by this asymptotic result is shown in
Table 3 and Figure 9. We do not have an explicit expression for the function œÜ, but
could solve the integral equation numerically. In the present simulation study, G0 is
given by the truncated Weibull distribution function with parameters given by (6).
This means that we can apply the same techniques as in Groeneboom and Hendrickx (2017b) and the R-package Groeneboom and Hendrickx (2017a), and for example
compute pointwise bootstrap confidence intervals for the density. The bandwidth was
determined by taking bootstrap samples of size m = 50, using bandwidths of size
cm‚àí1/7 and using the optimal constant cÃÇ over the east squares criterion in the bandwidth cÃÇn‚àí1/7 = 3.51991, where n = 1000, for the density in the original sample, where
we compare with the density estimate with bandwidth h = 3 in the original sample.
This follows the procedure shown in the vignette of the R-package Groeneboom and
Hendrickx (2017a). For the motivation for taking bootstrap samples of a smaller sample
size, see Groeneboom and Hendrickx (2017b). The method goes back to Hall (1990).
18

incubation time distribution

1.0

1.0

0.8

0.8

0.6

0.6

0.4

0.4

0.2

0.2

0.0

0.0
0

2

4

6

8

10

12

14

0

(a)

5

10

15

(b)

Figure 5: (a): The nonparametric maximum likelihood estimate (MLE) GÃÇn of the
incubation time distribution function (blue) for a sample of size n = 1000, and the
truncated Weibull distribution function (red, dashed) with parameters a and b, in the
simulation model where the variables are not discretized. (b): The MLE (black) and the
SMLE (blue), for the same sample, and the truncated (on [0, M1 ]) Weibull distribution
function (red, dashed). The bandwidth of the SMLE is h = 3.
Since we have a simulation model here, we can also compute the real minimizing h, in
a comparison with the truncated Weibull density. This yielded h = 3.4 in the present
case, which is a value not far from the bandwidth found by the bootstrap sampling. In
the pictures of this section, we took h = 3.4.
The bootstrap 95% confidence intervals for the density are shown for a sample of
size n = 1000 in Figure 7. These computations can again be checked on Groeneboom
(2020a). For these intervals just 1000 bootstrap samples were taken, resampling with
replacement from the original sample of triples (Ei , Si , ‚àÜi ), computing the density estimate again in the bootstrap samples and determining the 2.5% and 97.5% percentiles
of the values of the density estimates in the 1000 bootstrap samples. To get really good
intervals it is probably necessary to use an asymptotic pivot though, based on Theorem
1. This matter is subject to further investigation.

19

incubation time distribution

0.15

0.10

0.05

0.00
0

5

10

15

Figure 6: The nonparametric estimate of the density of the incubation time (blue, solid),
based on a sample of size n = 1000, based on the truncated Weibull distribution, where
we use bandwidth h = 3.4. The red dashed curve is the truncated Weibull density with
parameters a and b of (6).

5

Concluding remarks

We offered an alternative nonparametric approach to the estimation of the incubation
time distribution which was estimated by parametric methods in Backer et al. (2020) for
a data set of travelers from Wuhan. In this way we do not have to choose a parametric
distribution, like the Weibull, log-normal or gamma, as in Backer et al. (2020), but
compute a nonparametric maximum likelihood estimate instead which does not need
the arbitrary choice of parameters at all.
However, to give a smooth estimate of the distribution function and (continuous)
density, we have to choose a bandwidth parameter. For this choice a smoothed bootstrap approach was suggested. We also considered the model where the observations
are not discretized and discussed rates of convergence, bootstrap confidence intervals
and a limit theorem in that case. The present paper can be considered to be the technical companion of the column Groeneboom (2020b). All numerical computations are
given as R scripts in Groeneboom (2020a).
20

incubation time distribution

0.15

0.10

0.05

0.00
0

2

4

6

8

10

12

14

Figure 7: Density estimate (blue) and pointwise bootstrap 95% confidence intervals
for the density of the incubation time distribution for a sample of size n = 1000 (same
sample as in Figures 5 and 6). The truncated Weibull density is given by the red dashed
curve.

Acknowledgements
I want to thank Guus Balkema, Ronald Geskus and Siem Heisterkamp and a referee
for their comments.

6

Appendix

Using the notation of p. 330 of Groeneboom and Jongbloed (2014), we define the score
function Œ∏t,h,G by:


Œ∏t,h,G (e, s, Œ¥) = E a(W )|(E, S, ‚àÜ) = (e, s, Œ¥)
R
R
a(w) dG(w)
a(w) dG(w)
w‚àà(s‚àíe,s]
w‚â§s
=Œ¥
+ (1 ‚àí Œ¥)
,
(30)
G(s)
G(s) ‚àí G(s ‚àí e)

21

incubation time distribution
where Œ¥ = 1{s‚â§e} . We assume G(M1 ) = 1, where G is the distribution function of the
incubation time and M1 is the upper bound of the support of the distribution (taken
to be M1 = 20 in the simulations).
Defining, as in for example the interval censoring model,
Z
œÜ(u) =
a(y) dG(y),
y‚â§u

we get:
Œ∏t,h,G (e, s, Œ¥) = Œ¥

œÜ(s) ‚àí œÜ(s ‚àí e)
œÜ(s)
+ (1 ‚àí Œ¥)
,
G(s)
G(s) ‚àí G(s ‚àí e)}

(31)

where we define 0/0 = 0. Note that œÜ is absolutely continuous w.r.t. G and that
L02 (G) is the space of
œÜ(s) = 0, s ‚â• M1 , since we assume, as usual, a ‚àà L02 (G), where
R
square integrable functions f w.r.t. dG, with the property f (x) dG(x) = 0.
In the present model, the infection time is uniform on [0, E] and E is Uniform[0, M ].
So we get the following integral equation for the estimation of the density if w ‚àà [0, M ),
E [Œ∏t,h,G (E, S, ‚àÜ)|W = w]


Z
Z
Z
Z
1
œÜ(s)
1
œÜ(s) ‚àí œÜ(s ‚àí e)
=
ds de +
ds de
e‚àà[w,M ] M e
e‚àà[w,M ] M e
s‚àà[w,e] G(s)
s‚àà[e,w+e] G(s) ‚àí G(s ‚àí e)
Z

Z
1
œÜ(s) ‚àí œÜ(s ‚àí e)
+
ds de
e‚àà(0,w] M e
s‚àà[w,w+e] G(s) ‚àí G(s ‚àí e)
= Kh (w ‚àí t).

(32)

Differentiation w.r.t. w yields for the density estimate:

Z w 
1
1 œÜ(w + e) ‚àí œÜ(w)
œÜ(w) ‚àí œÜ(w ‚àí e)
œÜ(w)
‚àí
log(M/w) +
‚àí
de
M G(w)
M e=0 e G(w + e) ‚àí G(w) G(w) ‚àí G(w ‚àí e)
Z M
1
1 œÜ(w + e) ‚àí œÜ(w)
+
de
M e=w e G(w + e) ‚àí G(w)
‚àÇ
=
Kh (w ‚àí t),
(33)
‚àÇw
So we get the representation
Z
Z

Kh (t ‚àí y) d GÃÇn ‚àí G0 (y) = Œ∏t,h,GÃÇn (e, s, Œ¥) dP0 (e, s, Œ¥),
22

incubation time distribution
where GÃÇn is the MLE and œÜ solves (32) for G = GÃÇn (compare to (11.44), p. 331 of
Groeneboom and Jongbloed (2014)).

0.15

0.10

0.05

0.00

-0.05

-0.10

-0.15

-0.20
0

5

10

15

20

Figure 8: The function œÜ (red, solid), for h = 3.4, the triweight kernel K, and t = 6.
‚àÇ
The blue dashed curve is the function w 7‚Üí ‚àÇw
Kh (w ‚àí t).
This leads to
Z
Z

2/7
2/7
n
Kh (t ‚àí y) d GÃÇn ‚àí G0 (y) ‚àº n
Œ∏t,h,G0 (e, s, Œ¥) (Pn ‚àí P0 ) (e, s, Œ¥),

(34)

where Œ∏t,h,G0 is defined by (31), where G = G0 , the underlying distribution function of
the incubation time, and œÜ is the solution of the equation (32) and satisfies œÜ(M1 ) = 0.
Moreover, (34) would imply:
Z

D
2/7
Khn (t ‚àí y) d GÃÇn ‚àí G0 (y) ‚àí‚Üí N (0, œÉ 2 ),
n
(35)
where


Z
2/7
œÉ = lim var n
Œ∏t,hn ,G0 (e, s, Œ¥) dPn (e, s, Œ¥) ,
2

n‚Üí‚àû

23

incubation time distribution
and n1/7 hn ‚Üí c > 0. A picture of the function œÜ, solving (32), is shown in Figure 8.
This can be found by a simple iteration procedure for the integral equation (33) or a
matrix equation after discretization, which can also be found in Groeneboom (2020a).
Rs
Note that, letting Œ¶(s) = 0 œÜ(u) du, and defining 0/0 = 0.
E Œ∏t,h,G (E, S, ‚àÜ)


Z
Z
1
1
1 œÜ(s)
1 œÜ(s) ‚àí œÜ(s ‚àí e)
G(s) de ds +
{G(s) ‚àí G(s ‚àí e)} de ds
=
M s‚â§e e G(s)
M e<s e G(s) ‚àí G(s ‚àí e)
Z
Z
1
1
1
1
=
œÜ(s) de ds +
{œÜ(s) ‚àí œÜ(s ‚àí e)} de ds
M s‚â§e e
M e<s e
Z M
Z M
1
1
1
1
=
Œ¶(e) de +
{Œ¶(M1 ) ‚àí Œ¶(e) ‚àí Œ¶(M1 ) + Œ¶(0)} de
M e=0 e
M e=0 e
Z M
Z M
1
1
1
1
=
Œ¶(e) de ‚àí
Œ¶(e) de = 0,
M e=0 e
M e=0 e
using œÜ(s) = 0, s ‚â• M1 , were M1 is the upper bound of the support of the density of the
incubation time. Note that we use M ‚â• M1 , where [0, M ] is the interval containing the
exit times (assumed to be uniformly distributed on [0, M ] in the simulation experiment).
In Figure 8 we have M1 = 20 and M = 30. For the asymptotic variance, we get:
E Œ∏t,h,G (E, S, ‚àÜ)2

2
Z
Z
1
1 œÜ(s)2
1
1 œÜ(s) ‚àí œÜ(s ‚àí e)
G(s) de ds +
{G(s) ‚àí G(s ‚àí e)} de ds
=
M s‚â§e e G(s)2
M s>e e G(s) ‚àí G(s ‚àí e)
Z
Z
œÜ(s)2
{œÜ(s) ‚àí œÜ(s ‚àí e)}2
1
1
=
de ds +
de ds.
(36)
M s‚â§e e G(s)
M s>e e{G(s) ‚àí G(s ‚àí e)}
Note that:




Z
Z
2/7
2/7
var n
Kh (t ‚àí y) dGÃÇn (y) ‚àº var n
Œ∏t,h,G0 (e, s, Œ¥) dPn (e, s, Œ¥)
= n‚àí3/7 E Œ∏t,h,G (E, S, ‚àÜ)2 .
A table for the variances of the density estimates at t = 2, 3, . . . , 11, as computed
from 1000 samples of size n = 1000 and from n‚àí3/7 E Œ∏t,h,G (E, S, ‚àÜ)2 , as given by (36).
The table is given graphically in Figure 9.
24

incubation time distribution
t simulation variances
2
0.001524376
3
0.002652881
4
0.003535091
5
0.004193696
6
0.004351735
7
0.004238654
8
0.004073332
9
0.003385165
10
0.002352065
11
0.001402003

n‚àí3/7 E Œ∏t,h,G (E, S, ‚àÜ)2
0.001528899
0.002551415
0.003457335
0.004037131
0.004275926
0.004226677
0.003842444
0.003076003
0.002082613
0.001165108

Table 3: A comparison of variances, given by a simulation of 1000 samples of size
n = 1000 and the right-hand side of (36). The bandwidth h = 3.4 and G is the
distribution function of the Weibull distribution, truncated on the interval [0, 20].

0.0040

0.0035

0.0030

0.0025

0.0020

0.0015

2

4

6

8

10

12

Figure 9: Plot of Table 3. The variances in the simulation are given by the blue curve
and the red curve gives the values n‚àí3/7 E Œ∏t,h,G (E, S, ‚àÜ)2 , for t = 2, 3, . . . , 11, h = 3.4,
where G is the truncated Weibull distribution function.

25

incubation time distribution

References
Backer, J. A., Klinkenberg, D., and Wallinga, J. (2020). Incubation period of 2019
novel coronavirus (2019-nCov) infections among travellers from Wuhan, China, 2028 january 2020. Euro Surveill., 25.
Britton, T. and Scalia Tomba, G. (2019). Estimation in emerging epidemics: bases and
remedies. J. R. Soc. Interface, 16.
Groeneboom, P. (2020a).
incubationtime.

Incubationtime.

https://github.com/pietg/

Groeneboom, P. (2020b). The Netherlands in Times of Corona (in Dutch). Nieuw
Archief voor Wiskunde, 21:181‚Äì184.
Groeneboom, P. and Hendrickx, K. (2017a). curstatCI. R package. Version 0.1.1.
Groeneboom, P. and Hendrickx, K. (2017b). The nonparametric bootstrap for the
current status model. Electron. J. Stat., 11(2):3446‚Äì3484.
Groeneboom, P. and Jongbloed, G. (2014). Nonparametric Estimation under Shape
Constraints. Cambridge Univ. Press, Cambridge.
Hall, P. (1990). Using the bootstrap to estimate mean squared error and select smoothing parameter in nonparametric problems. J. Multivariate Anal., 32:177‚Äì203.
Kolda, T. G., Lewis, R. M., and Torczon, V. (2003). Optimization by direct search:
new perspectives on some classical and modern methods. SIAM Rev., 45(3):385‚Äì482.
Reich, N. G., Lessler, J., Cummings, D. A. T., and Brookmeyer, R. (2009). Estimating
incubation period distributions with coarse data. Stat. Med., 28(22):2769‚Äì2784.
Sen, B. and Xu, G. (2015). Model based bootstrap methods for interval censored data.
Comput. Statist. Data Anal., 81:121‚Äì129.
Silverman, B. (1986). Density estimation for statistics and data analysis, volume 26.
CRC press.
Torczon, V. (1997). On the convergence of pattern search algorithms. SIAM J. Optim.,
7(1):1‚Äì25.

26

