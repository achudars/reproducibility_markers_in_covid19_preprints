Stochastic sampling effects favor manual over digital contact tracing
Marco Mancastroppa,1, 2 Claudio Castellano,3 Alessandro Vezzani,4, 1 and Raffaella Burioni1, 2
1

arXiv:2010.03399v2 [physics.soc-ph] 30 Mar 2021

Dipartimento di Scienze Matematiche, Fisiche e Informatiche,
Università degli Studi di Parma, Parco Area delle Scienze, 7/A 43124 Parma, Italy
2
INFN, Sezione di Milano Bicocca, Gruppo Collegato di Parma,
Parco Area delle Scienze, 7/A 43124 Parma, Italy
3
Istituto dei Sistemi Complessi (ISC-CNR), Via dei Taurini 19, I-00185 Roma, Italy
4
Istituto dei Materiali per l’Elettronica ed il Magnetismo (IMEM-CNR),
Parco Area delle Scienze, 37/A-43124 Parma, Italy
Isolation of symptomatic individuals, tracing and testing of their nonsymptomatic contacts are
fundamental strategies for mitigating the current COVID-19 pandemic. The breaking of contagion
chains relies on two complementary strategies: manual reconstruction of contacts based on interviews and a digital (app-based) privacy-preserving contact tracing. We compare their effectiveness
using model parameters tailored to describe SARS-CoV-2 diffusion within the activity-driven model,
a general empirically validated framework for network dynamics. We show that, even for equal probability of tracing a contact, manual tracing robustly performs better than the digital protocol, also
taking into account the intrinsic delay and limited scalability of the manual procedure. This result is
explained in terms of the stochastic sampling occurring during the case-by-case manual reconstruction of contacts, contrasted with the intrinsically prearranged nature of digital tracing, determined
by the decision to adopt the app or not by each individual. The better performance of manual
tracing is enhanced by heterogeneity in agent behavior: superspreaders not adopting the app are
completely invisible to digital contact tracing, while they can be easily traced manually, due to their
multiple contacts. We show that this intrinsic difference makes the manual procedure dominant in
realistic hybrid protocols.
I.

INTRODUCTION

The current COVID-19 pandemic is impacting daily
life worldwide at an unprecedented scale. Among the
features that have contributed to transform the emerging
diffusion of SARS-CoV-2 coronavirus into such a global
scale crisis, a prominent role is played by the high rates
of virus transmission mediated by presymptomatic and
asymptomatic individuals [1–6]. Given the absence of effective pharmaceutical interventions, this feature makes
the mitigation of the pandemic a highly nontrivial task,
that has been tackled with various strategies, none of
them devoid of drawbacks.
Initially, governments resorted to very restrictive limitations of non strictly necessary activities (lock-downs) to
curb the diffusion of the infection. Such measures turned
out to be effective from an epidemiological point of view,
but exceedingly costly in other respects, for their economic and social consequences [7, 8]. Recently, such restrictive measures have been progressively lifted, and we
now rely on other tools to contain the pandemic: social
distancing, reinforced hygiene and the use of individual
protection devices. Along with these provisions, aimed
at preventing single virus transmission events, another
set of measures points at breaking contagion chains: the
isolation of infected individuals (symptomatic or found
via some testing), followed by the tracing of their contacts (contact tracing, CT), the testing of the latter and
the possible isolation of the infected [9–12].
This CT procedure has proven effective in the past
in various contexts [13–16] but it comes, in its standard
manual implementation, with important limitations [17].

It requires the set up of a physical infrastructure, needed
to find infected individuals, interview them and reconstruct their contacts in a temporal window, call these
contacts, convince them to get tested and eventually isolated. Apart from the evident problems of practical feasibility and economic cost, the manual CT procedure intrinsically implies a delay between the moment an individual is found infected (and isolated) and the time
her contacts are tested and possibly isolated. For an
epidemic such as COVID-19, characterized by a rather
long presymptomatic infectious stage and a high relevance of transmission by asymptomatics, the delay implied by manual CT risks to undermine the effectiveness
of the whole procedure.
For this reason the additional strategy of a digital CT
procedure, based in particular on the installation of apps
on smartphones (app-based), has been proposed alongside manual CT [2]. The rationale is that proximity sensors installed on these ubiquitous devices allow the detection of contacts of epidemiological significance among individuals. When an individual is found infected, the app
permits to instantaneously trace all contacts in the recent past, thus allowing for much quicker testing and isolation. A quantitative comparison between manual and
digital CT applied to an epidemiological model describing COVID-19 diffusion suggested that already a delay
of the order of 3 days completely spoils the ability of
manual CT to prevent the initial exponential growth of
the epidemic [2]. The conclusion was that only a digital
CT avoiding this delay could be a viable strategy to control the current epidemic. The proposal for digital CT
rapidly gained momentum, leading to the development

2
of technical solutions [18–20] and to the deployment of
app-based CT infrastructures in many countries [21].
Many works have scrutinized the actual validity of this
solution and investigated the possible shortcomings of
app-based CT, casting doubts over many of the assumptions underlying such strategy [22–24]: there are too few
modern enough smartphones; Bluetooth based proximity
measurements are unreliable; co-location is not always a
good proxy for epidemiological contact. The potential
risks for privacy breaches have also been exposed.
Other papers have tried to evaluate the impact of digital CT on the current COVID-19 epidemic, attempting
to precisely determine, by means of detailed data-driven
epidemiological models, to what extent such a strategy
is able to suppress virus diffusion [25–29]. A critical role
is played by the fraction f of individuals in a population
that actually use the app. Fairly high values of f (of
the order of 60%) are required for the digital CT protocol to lead to global protection [2, 9, 23]. These values
are in striking contrast with the low app adoption rates
observed so far in most countries [30–32].
In this paper we take a different approach. We compare
the effectiveness of the two CT protocols in exactly the
same conditions, i.e., in the very same realistic epidemiological scenario, without making claims on their absolute
performance, and we estimate their relative contribution
in realistic hybrid protocols, where the two strategies
are complementary. We consider a sensible epidemiological model incorporating all main ingredients of the current epidemic, with parameters tuned to values derived
from empirical observations about COVID-19 spreading.
Within this single framework we consider the impact of
both manual and digital CT strategies, working in similar
manner but with their own specific features: delayed isolation of contacts, limited scalability and imperfect recall
for the manual procedure; dependence on the predetermined app adoption decision for the digital CT.
The comparison reveals that even when the number of
reconstructed contacts is the same, manual CT performs
better than digital CT in practically all realistic cases.
The manual protocol is more efficient in increasing the
epidemic threshold (i.e., the value of the effective infection rate above which the infection spreads diffusely), in
limiting the height of the epidemic peaks and in reducing
the number of isolated individuals. This surprising result
is due to the stochastic annealed nature of the manual CT
procedure, in which each symptomatic node randomly recalls a fraction of her contacts, in contrast with the digital CT where the traced nodes belong deterministically
to the prearranged quenched fraction of the population
adopting the app. In the latter case, the individuals not
adopting the app can never be reached by the CT protocol, while the entire population is potentially detectable
through the stochastic sampling of the manual procedure.
The better performance of manual CT is already evident
in homogeneous populations and it is strongly enhanced
in the presence of a heterogeneous distribution of contacts. Superspreaders not adopting the app are invisible

to the digital tracing while they are very likely to be detected by a manual tracing originating from one of their
many contacts. In a realistic setup where both protocols
are adopted simultaneously, manual CT leads to a considerable reduction of the transmission even considering
delays and scalability, while the digital protocol produces
a relevant contribution only for large adoption rates, as
suggested by previous literature.
II.
A.

RESULTS

Epidemic spreading on heterogeneous
dynamical networks

We consider an activity-driven network model with attractiveness, taking into account both the temporal dynamics of social contacts and the heterogeneity in the
propensity to establish social ties [33–36]. Each susceptible node S is assigned with an activity aS and an attractiveness parameter bS , drawn from the joint distribution
ρ(aS , bS ): the activation rate aS describes the Poissonian activation dynamics of the node; the attractiveness
bS sets the probability pbS ∝ bS for a node to be contacted by an active agent. At the beginning all nodes
are disconnected and when a node activates it creates m
links with m randomly selected nodes (hereafter we set
m = 1); then all links are destroyed and the procedure
is iterated. The functional form of ρ(aS , bS ) encodes the
correlations between activity and attractiveness in a population with a given distribution of activity. It has been
observed that several social systems feature positive correlations between activity and attractiveness and a broad
power-law distribution of activity [33–39]:
−(ν+1)

ρ(aS , bS ) ∼ aS

δ(bS − aS )

(1)

with ν typically ranging between 0.5 and 2.
On top of the activity-driven dynamics, we consider a
compartmental epidemic model which includes the main
phases of clinical progression of the SARS-CoV-2 infection [6, 40–42], also applicable to other infectious diseases with asymptomatic and presymptomatic transmission. The model is composed by five compartments:
S susceptible, P presymptomatic, A infected asymptomatic, I infected symptomatic, R recovered. A contagion process (see Fig. 1a) occurs with probability λ
when a link is established between an infected (either P ,
A and I) and a susceptible node S (contact-driven transition): a node has probability δ to become presymptomatic after infection and probability (1 − δ) to beλδ

λ(1−δ)

come asymptomatic, thus S −→ P and S −−−−→ A. A
presymptomatic node spontaneously develops symptoms
with rate γP = 1/τP , thus with a Poissonian process
γP
P −−→ I; both asymptomatic and symptomatic nodes
spontaneously recover respectively with rate µ = 1/τ
and with rate µI = µγP /(γP − µ), so that the average infectious period for both symptomatic and asymptomatic

3

a

P

I

S
b

A

R

2.4
2.2
2
1.8
1.6
1.4
1.2
1
0

20

40

60

80

– sets the transition point between the absorbing and the
active phase of the epidemic. The increase in the value of
rC is an indicator of the effectiveness of mitigation strategies. Within the adaptive activity-driven framework, the
epidemic threshold can be calculated analytically via a
mean-field approach (see Methods).
The effect of isolating symptomatic nodes as the only
containment measure is shown in Fig. 1b. We compare
the epidemic threshold rC , obtained with the isolation
of symptomatic nodes only, with the epidemic threshold
NA
rC
of the non-adaptive (NA) case, in which no containment measures are taken on infected individuals, as
a function of γP /µ (see Methods for the explicit expression). In the case of instantaneous symptoms development (γP /µ → ∞), the threshold is increased by a factor
of 1/(1 − δ), while for smaller γP /µ the gain is reduced.
For example, for (1 − δ) = 0.43, that is 43% of asymptomatic individuals, τP = 1.5 days and τ = 14 days as
observed for SARS-CoV-2 (see Methods for details on
the parameters used in all figures), the threshold is doubled by the isolation of symptomatic nodes. This is the
baseline reference for the evaluation of the performance
of CT strategies.

100

FIG. 1: Epidemic model without contact tracing. a
Diagram of the compartmental epidemic model without CT.
b We plot, as a function of γP /µ, the ratio between the epiSY M P T O
when symptomatic nodes are isodemic threshold rC
lated and the epidemic threshold of the non-adaptive case
NA
. The horizontal dashed orange line indicates the value
rC
NA
SY M P T O
for γP = ∞ (instantaneous onset of symp/rC
of rC
toms). The vertical red dash-dotted line indicates the value
of γP /µ we consider in the rest of the paper. We set
ρ(aS , bS ) = ρS (aS )δ(bS − aS ). The curve does not depend
on the specific form of ρS (aS ).

is τ . We neglect states of hospitalization and consider
recovery without death: this choice does not affect the
infection dynamics.
Adaptive behavior of populations exposed to epidemics can be modelled within the activity-driven network framework: infected nodes experience a reduction in activity, due to isolation or the appearance of
symptoms; similarly, other individuals undertake selfprotective behavior to reduce the probability of contact
with an infected node, and this is modelled as a reduction in the attractiveness of infected nodes [43–45].
We assume that symptomatic infected nodes I are immediately isolated (aI , bI ) = (0, 0), therefore not being able to infect anymore. On the contrary, we assume that recovered R, asymptomatic A and presymptomatic P individuals behave as when they were susceptible (aA , bA ) = (aP , bP ) = (aR , bR ) = (aS , bS ). The
adaptive behavior is implemented without affecting the
activity of nodes which are not isolated [44].
The control parameter r = λ/µ is the effective infection rate, whose critical value rC – the epidemic threshold

B.

Manual and digital contact tracing protocols

The CT protocols differ in their practical implementation as well in their exploration properties.
Manual tracing is performed by personnel who,
through interviews, collects information, contacts individuals who may have been infected and arranges for
testing. In manual CT, as soon as an individual develops
symptoms (i.e. P → I), her contacts in the previous TCT
days are traced with recall probability ε(aS ), where aS
is the activity of the symptomatic individual. A traced
contact is tested and, if found in state A (infected asymptomatic), isolated (a = b = 0): the average time between
the isolation of the symptomatic individual and the isolation of her asymptomatic infected contacts is τC . Such
delay can be quite large, due to the time required for
the collection of the diary, the execution of the diagnostic test and the subsequent isolation [2, 17]. Moreover,
the manual protocol depends on ε(aS ), which takes into
account the limited resources allocated for tracing and
the limited memory/knowledge of symptomatic individuals in reconstructing their contacts. Low activity nodes
make few contacts over time and a fraction of their contacts will be traced; on the other hand high activity nodes
will only remember a finite number of their contacts so
that, also because of limitations of the tracing capacity,
we expect that at most a number kc of contacts can be
traced [46, 47]. This translates into the limited scalability
property:
(
ε∗ ,
ε(aS ) =
∗
ε∗ aaS =

if aS ≤ a∗
kc
∗
2TCT aS , if aS > a

(2)

4

a

same app. We assume that each of the individuals has
a probability f to download the app before the epidemic
starts. As soon as an individual develops symptoms (i.e.
P → I), if she downloaded the app, her contacts are
traced only if they downloaded the app as well. A traced
contact is tested and, if found in state A (infected asymptomatic), is isolated (a = b = 0). The time passing between the isolation of a symptomatic individual and the
isolation of her asymptomatic infected contacts is taken
to be 0, thus assuming an idealized scenario of instantaneous notification and isolation. We finally consider a
more realistic scenario where the two procedures are combined into a hybrid protocol in which digital CT supports
manual CT, potentially reaching individuals not traced
manually [19, 25, 29]. See Methods for details on the
implementation of the CT protocols.

7
1.2

6
1.1

5
1

0

0.5

1

4

3

2

Manual CT
App-based CT

0

0.2

0.4

0.6

0.8

1

b
A

S[I]

Manual CT:

C.

Stochastic vs. prearranged sampling

App-based CT:
S[I]
Manual CT:

A
S[I]

App-based CT:

FIG. 2: Stochastic vs. prearranged sampling in contact tracing. a Plot, as a function of ε = f 2 , of the ratio
between the epidemic threshold rC in the presence of CT protocols and the epidemic threshold of the non-adaptive case
NA
. In the inset we plot the ratio between the epidemic
rC
M AN U AL
and that of the appthreshold of the manual CT rC
AP P
based CT rC , as a function of ε = f 2 . We consider homogeneous activity and attractiveness, setting ρ(aS , bS ) =
δ(aS − a)δ(bS − b). b If an asymptomatic node A infects a
single susceptible node S (which subsequently becomes symptomatic, I), the infector is traced with probability ε in the
manual CT and with probability f 2 in the digital CT. Thus
the probability is the same if we impose f 2 = ε. However, if
an asymptomatic node infects two susceptible nodes (which
subsequently become symptomatic), the probability of tracing
the infector with the manual protocol is 1−(1−ε)2 = 2f 2 −f 4
(still considering ε = f 2 ). This value is always larger than
that of the digital protocol f (1 − (1 − f )2 ) = 2f 2 − f 3 .

where a∗ = kc /2TCT ε∗ . Manual CT also suffers from
a global scalability limitation. Indeed in the active phase
with a large number of infected individuals, the tracing
system could be ineffective due to the excessive number
of contacts to be followed. However, here we focus on
the epidemic threshold and we evaluate the features
of the CT procedure that keep the epidemic spreading
under control before widespread diffusion occurs.
Digital CT is based on the download of an app which
allows the tracing of close contacts equipped with the

We first compare the manual and digital CT protocols
in the case of a population with homogeneous activity
and attractiveness, ρ(aS , bS ) = δ(aS − a)δ(bS − b), without delay even in manual CT, i.e., τC = 0. We set ε = f 2
so that the probability that a single contact is traced in
the two protocols is the same. However, it should be emphasized that typical values of f 2 range between 0.01 and
0.1 in many countries [30–32], while ε is usually larger
(≈ 0.3 − 0.5), since typically 30% − 50% of contacts are
close and occur at home, at work or at school and thus are
easily traceable [48, 49]. An exact analytical estimate of
the epidemic threshold is obtained through a linear stability analysis around the absorbing state (see Methods
for explicit expressions and Supplementary Method 1 for
detailed derivation): in Fig. 2a we compare the threshold for manual and app-based CT, compared to the nonadaptive case (NA), for realistic COVID-19 parameters.
Both protocols feature the same epidemic threshold when
ε = f = 0 and ε = f = 1: indeed the former corresponds
to the isolation of symptomatic individuals only, without CT, while the latter limit corresponds to the case in
which all contacts are traced. For intermediates values of
ε = f 2 , manual tracing is strongly and surprisingly more
effective than digital tracing, as it increases significantly
the epidemic threshold, compared to the app-based protocol. Since we are considering no heterogeneity or delays, the difference is due only to sampling effects in the
CT dynamics. In practice, in app-based CT the population to be tested is prearranged, based on whether or not
the app was downloaded before the outbreak started. On
the contrary, manual CT performs a stochastic sampling
of the population: the random exploration can potentially reach the entire population, since anyone who has
come in contact with a symptomatic node can be traced.
The simplest example of the difference in tracing multiple infections processes in the two protocols is illustrated
in Fig. 2b.

5
a

7
6.5
6
5.5
5
4.5
4
3.5
3
2.5
2

b
Manual CT
App-based CT
w/o CT

1.6
1.4
1.2
1

2

4

0.5 1 1.5 2 2.5 3 3.5 4 4.5 5

c

7
6.5
6
5.5
5
4.5
4
3.5
3
2.5
2

1.6

9
8

1.4

=1
=1.5
=3
=5

1.6
1.4

7 1.2
1.2

2

4

6

1

0

0.5

1

5
Manual CT
App-based CT
w/o CT

0.5 1 1.5 2 2.5 3 3.5 4 4.5 5

4
3
2
0

Manual CT
App-based CT

0.2

0.4

0.6

0.8

1

FIG. 3: Effects of heterogeneity. a Plot, as a function of the exponent ν, of the ratio between the epidemic threshold rC in
NA
the presence of CT protocols and the epidemic threshold of the non-adaptive case rC
. We set ε = f 2 = 0.1 (f ≈ 0.316). In
M AN U AL
AP P
the inset we plot the ratio between the epidemic threshold of the manual CT rC
and that of the app-based CT rC
,
NA
as a function of ν. b Same plot as a with ε = f 2 = 0.6 (f ≈ 0.775). c The ratio rC /rC
is plotted as a function of ε = f 2 for
M AN U AL
AP P
both CT protocols, with ν = 1.5. In the inset we plot the ratio rC
/rC
as a function of ε = f 2 for several ν values.
In all panels the distribution ρ(aS , bS ) is given by Eq. (1).

D.

Effects of heterogeneous activity

We now consider a heterogeneous activity distribution,
as observed in several human systems, and we consider a
positive activity-attractiveness correlation, as defined in
Eq. (1) [33–35, 37–39]. The power-law distribution for
the activity implies the presence of hubs with high activity and high attractiveness. We investigate the pure effect
of heterogeneities in contact tracing [12, 27] setting now
ε(aS ) = ε, ∀aS and not considering delays in manual CT,
τC = 0. We perform again a mean-field approach, obtaining an analytical closed form for the epidemic threshold
(see Methods and Supplementary Method 1): in Fig. 3
we compare the epidemic threshold with the two protocols as a function of the exponent ν of the activity
distribution, for realistic parameters and setting an average activity aS = 6.7 days−1 [43, 48]. Both protocols
are more effective in heterogeneous populations, that is
at ν ∼ 1 − 1.5. Note that due to the cut-offs and the
constraint on the average, the fluctuations of the activity distribution are maximum for ν = 1, and the epidemic thresholds depend both on activity fluctuations
and higher order moments of ρS (aS ) (see Methods and
Supplementary Method 1 for details). However heterogeneity greatly amplifies stochastic effects, further increasing the advantage of the manual tracing over the
app-based prearranged protocol. Indeed, in heterogeneous populations nodes with high activity and attractiveness (super-spreaders) drive and sustain the spread of
the epidemic. Manual CT is far more effective in identifying and isolating them than app-based CT: in digital CT,
hubs which have not downloaded the app will never be
traced, despite the high number of their contacts. On the
contrary, manual CT is very effective in tracing superspreaders, because they are engaged in many contacts

and are traced very effectively by stochastic exploration.

E.

Limited scalability and delay in manual contact
tracing

We now consider some features of manual CT that
can reduce its effectiveness: the limited scalability of the
tracing capacity [46, 47] and the delays in CT and isolation [2, 23, 28]. We set ε(aS ) as in Eq. (2) and consider a large delay τC = 3 days [2] in manual CT. In
Fig. 4 we compare the epidemic threshold for the two CT
protocols, setting equal
R probabilities of tracing a contact
ε = f 2 , where ε = daS ε(aS )ρS (aS ). For small values
of ε (note that this√
however corresponds to a quite large
adoption rate f = ε ≈ 0.316) manual CT is still more
effective (see Fig. 4a): the delay in isolation and the limited scalability are not able to significantly reduce the
advantage provided by the stochastic exploration of contacts. Fig. 4b shows that digital CT can become more
effective than manual CT, but this occurs only for very
large values of f 2 and τC . This indicates that for realistic
settings, the advantage of the manual protocol over the
app-based protocol is robust even including delays and
limited scalability. Fig. 4c further illustrates for which
(unrealistically large) values of f 2 and τC , digital CT
outperforms manual CT. Note that realistic values of f
correspond to f 2 at most of the order of 0.1. Hence, an
extremely high adoption of the app is necessary in order
to obtain an effective advantage of the digital CT.

6
a

b

3.2

1.3
1.2

3

c

4.5

7

Manual CT
App-based CT

4

6

1.5
1
0

1.1

3.5

2.8

5

10

5

1

C

2

2.6

3

Manual CT
App-based CT

2.4
2.2

4

1

2

3

4

4

0.9

C
C

0.8

2.5

5

2

3

0.7

C

2

1

2

3

C

4

=0 d
=1 d
=3 d
=5 d
=7 d

App CT

4

5

2
0

0.2

0.4

0.6

0.8

1

FIG. 4: Effects of limited scalability and isolation delay in manual contact tracing. a Plot, as a function of the
exponent ν, of the ratio between the epidemic threshold rC in the presence of CT protocols and the epidemic threshold of the
NA
non-adaptive case rC
, with limited scalability and delay in manual CT. We set ε = f 2 = 0.1 (f ≈ 0.316), τC = 3 days. In
M AN U AL
AP P
the insets we plot the ratio between the epidemic threshold of the manual CT rC
and that of the app-based CT rC
,
2
NA
as a function of ν. b Same plot as a with ε = f = 0.6 (f ≈ 0.775), τC = 5 days. c Plot of the ratio rC /rC as a function of
AP P
M AN U AL
as a
/rC
ε = f 2 for both CT protocols, setting ν = 1.5 and for several values of τC . In the inset we plot the ratio rC
function of τC for several ε values. In all panels the distribution ρ(aS , bS ) is given by Eq. (1).

F.

Manual and app-based CT in the epidemic
phase

We now explore with numerical simulations (see Methods, Supplementary Method 2) the effects of manual and
digital CT protocols in the active phase of the epidemic.
We consider an optimistic value of f = 0.316, setting
ε = f 2 = 0.1 that is a very low value for the recall
probability, and we consider the system above the epidemic threshold r > rc , in the conditions of Fig. 4a.
Fig. 5 shows that the infection peak with manual tracing
is lower than the app-based one. Moreover, in the manual
CT the duration of the epidemic is reduced: this strongly
impacts on the final epidemic size, which is about half of
the one observed in the app-based CT. We also plot the
temporal evolution of the average activity of the system
ha(t)i and of the fraction of isolated nodes Iso(t) (see
inset). In general, the average activity ha(t)i features a
minimum, however its value remains very large (about
98% of the case without any tracing measure). This implies that both protocols do not disrupt the functionality
of the system. Interestingly, the fraction of isolated nodes
is coherent with the infection peak, and in particular it
is lower when the infection peak is lowered. This means
that the most effective procedure, i.e. manual CT for
realistic values of the parameters, not only lowers the infection peak but it is also able to isolate a smaller number
of nodes, a key feature of any effective CT strategy.
G.

Robustness

In the Supplementary Notes we show that the advantage of the manual CT is robust with respect to the relaxation of several assumptions and to changes of param-

eters. In particular, we consider the case where all nodes
have equal attractiveness ρ(aS , bS ) = ρS (aS )δ(bS −b), we
take into account very long delays τC and we change the
maximum number of traceable contacts kc . We also show
that the advantage of manual contact tracing in the presence of heterogeneous activity is robust, if one takes into
account that contacts belonging to the close social circle of the index case (same household) are always traced
and isolated manually, also in the digital protocol. This
can be verified by using a hybrid procedure with a fixed
small number of contacts always traced (see Supplementary Notes).

H.

Hybrid contact tracing protocols: manual plus
digital CT

We now consider the implementation of a realistic hybrid CT protocol with manual and digital contact tracing
working at the same time. We assume that each individual has downloaded the app with probability f before the
epidemic starts. As soon as an individual with activity
aS develops symptoms (i.e. P → I), contact tracing is
activated with reference to the previous TCT days: if the
infected individual and also her contact downloaded the
app, the contacted agent is immediately traced and isolated with no delay. Otherwise, the contact can only be
traced manually, with probability ε(aS ) (as in Eq. (2))
and, if found in state A, the contact is isolated with a
delay τC . We set a realistically large delay τC = 3 days.
The threshold in the hybrid case can be determined
through the solution of a complex set of equations, that
we solve numerically in Supplementary Method 1. In
the presence of heterogeneous activity (i.e. superspreaders), starting form a purely digital protocol (Fig. 6b,c)

7

6

10 -3
10-3
1

5

1

0.5

4

0.99
0.98

0

3

0

2

100

200

Inf(t) Manual CT
R(t) Manual CT
Inf(t) App-based CT
R(t) App-based CT

1
0
50

100

150

200

FIG. 5: Effects of manual and digital contact tracing
on the epidemic active phase. We plot the temporal evolution of the fraction of infected nodes Inf(t), i.e. infected
asymptomatic and infected symptomatic, and of the fraction
of removed nodes R(t), for both manual and digital CT. In
the inset we plot the temporal evolution of the fraction of
isolated nodes Iso(t) (right y-axis) and of the average activity of the population ha(t)i (left y-axis), normalized with aS .
All curves are averaged on several realizations of the disorder
and of the temporal evolution. We set ε = f 2 = 0.1, τC = 3
NA
= 3.1 and N = 5 103 . The distribution ρ(aS , bS )
days, r/rC
is given by Eq. (1), with ν = 1.5. The curves for digital
and manual CT are averaged respectively over 554 and 681
realizations and the errors, evaluated through the standard
deviation, are smaller or comparable with the curves thickness.

the addition of manual contact tracing rapidly increases
the threshold, leading to an improvement by a large
factor (about 80%), for realistic values ε & 0.3. Instead, starting from a realistic manual contact tracing
setup ε & 0.3, a significant improvement (i.e. a 50% of
threshold increase) is obtained by implementing a digital contact tracing only if f & 0.60 − 0.75 (Fig. 6a,c).
These values are consistent with other results in the literature [2, 9, 23]; however, in most countries, the app
adoption rates do not reach these values [30–32].

III.

DISCUSSION

Our results indicate that manual CT, despite its drawbacks, can be an efficient protocol in heterogeneous populations, more efficient than its digital counterpart, due
to its specific sampling properties. This conclusion is robust with respect to variations in several model assumptions, including correlations between activity and attractiveness or the limited scalability of the manual CT pro-

tocol. However, epidemic propagation and strategies to
mitigate it are very complex processes and several of their
features have been left out from our modelling scheme.
Some of these features (the possibility that isolation is
non complete, that some individuals do not report symptoms or the existence of testing campaigns detecting infected nonsymptomatic individuals) act similarly on both
types of CT and hence do not modify the relative performance. Other more realistic features (the presence of
delays even in digital CT and the existence of additional
sources of heterogeneity in viral shedding [50], recovery
rates [51] and activity temporal patterns [52]) would even
reduce the relative performance of digital CT.
Our results put forward several directions to increase
the effectiveness of tracing. An important aspect is the
correlation between app adoption rates and activity of
nodes: our analysis in the Supplementary Notes shows
that, as expected, in heterogeneous populations a positive correlation strongly increases the success of digital
CT. This is a direction that could be pursued in campaigns aimed at driving app adoption among potential
superspreaders. However, this represents a challenge for
policy makers. Evidence is currently emerging that those
who download the app are individuals who adopt very
cautious behavior, i.e. f and aS are typically anticorrelated [53, 54]. Another road that could enhance the
efficacy of CT protocols is to follow chains of transmissions along multiple steps, so that when a traced contact
is found infected also her contacts are reconstructed and
tested. This additional step improves the overall effectiveness of CT protocols, but also increases the delay
associated to the manual procedure with respect to the
digital one. Digital CT allows in principle to extend the
tracing procedure to an arbitrary number of steps, however, strong concerns related to privacy issues [55] make
this path difficult to follow.
In summary, even if additional features of CT can be
considered, the weakness of digital CT, originated by the
nature of the sampling of contacts and worsened by heterogeneities, seems to be an intrinsic unavoidable property of the procedure. The manual CT protocol, with
its higher intrinsic stochasticity, does not suffer from this
problem and samples contacts effectively, especially in realistic heterogeneous populations: thus, digital CT cannot be considered simply as a cheaper and more rapid
way of implementing standard contact tracing and should
only be considered in combination with manual protocols. Manual CT must necessarily play an important role
in any strategy to mitigate the current pandemic. Considerations about costs and practical feasibility of the
two approaches (which have not been taken into account
here) suggest that a careful integration of the two protocols may be the key for more effective mitigation strategies. As suggested in the last part of our results, an
optimal set up should include both procedures, adopted
simultaneously. In this respect, the availability of detailed data about the rates of app adoption in various
population groups (and correlations with age or activity

8
a

b

8

3

c

5

0.8

0.5

1

7

0.6

0.8

1

3

0.2

0.4

0.6

0.8

3

4

6.5

0.4

3.
5

5

0.2

2
0

5.5

3

0.1

0.25 0.5 0.75

5
4.

0

7

1

0.2

4

4

6

2.5

0.3

6.5

1.5

5

5

3

0.4

4.5

2

4

5

3.5

6

0.5

5.5

0

7

1

6

6

6.5

0.6

4

5

2

6

0.7
4.5

7

7
5.5

4.5

3.5

4 4.5

5 5.5

6

0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8

FIG. 6: Effects of hybrid contact tracing protocol. a Plot, as a function of f 2 , of the ratio between the epidemic threshold
M AN U AL+AP P
NA
in the presence of a hybrid CT protocol, rC
, and the epidemic threshold of the non-adaptive case, rC
, for realistic
M AN U AL+AP P
and the epidemic threshold
values of ε (see legend). In the inset we plot, as a function of f 2 , the ratio between rC
M AN U AL+AP P
M AN U AL
NA
when only manual CT is implemented, rC
. b Plot of the ratio rC
/rC
as a function of ε, for realistic app
M AN U AL+AP P
adoption levels f (see legend). In the inset we plot, as a function of ε, the ratio between rC
and the epidemic
M AN U AL+AP P
NA
AP P
/rC is plotted as a function of f 2 and
threshold when only app-based CT is implemented, rC . c The ratio rC
ε, through a heat map: the red dash-dotted lines are plotted for ε = 0.3 and f = 0.2, i.e. they correspond to the red dashed
curves of panel a and b. In all panels the distribution ρ(aS , bS ) is given by Eq. (1), the manual CT features a delay of τC = 3
days and limited scalability is considered.

levels), as well as more precise estimates of other parameters, such as the recall probability, would be highly
beneficial. The design of optimal hybrid CT protocols,
including decisions on how to allocate resources and how
to target recommendations for app adoption, is a very
promising direction for future work.

IV.
A.

METHODS

Mean-field equations and implementation of CT
protocols

We consider an activity-attractiveness based meanfield approach, dividing the population into classes of
nodes with the same activity aS and attractiveness bS
and treating them as if they were statistically equivalent. For each class (aS , bS ) we consider the probability
that at time t a node is in one of the epidemic compartments. For arbitrary ρ(aS , bS ) distribution and arbitrary
functional form of f (aS ) and ε(aS ) we build the meanfield equations which describe the temporal evolution of
the network, the epidemic spreading and the adaptive behavior due to isolation and CT. In particular, in order to
model the manual and app-based CT we introduce two
further compartments: T traced asymptomatic and Q
isolated asymptomatic. An asymptomatic individual became traced T when infected by a presymptomatic node
or when she infects a susceptible node that eventually
develops symptoms. In the manual case the tracing is
effective with probability ε(a). In the app-based case,
tracing occurs only if both nodes involved in the con-

tact downloaded the app. A traced node is still infective
(aT , bT ) = (aS , bS ) and with rate γA = 1/τA  µ it
γA
is quarantined, T −−→ Q; while a quarantined node is
no more infective since (aQ , bQ ) = (0, 0). In order to
take into account the delay in the manual CT we set:
τA = τC + τP for the manual case and τA = τP for the
app-based process. See Supplementary Method 1 for the
detailed equations of manual, digital and hybrid CT protocols.
B.

Epidemic thresholds

We perform a linear stability analysis of the mean field
equations around the absorbing state obtaining the conditions for its stability and then the epidemic threshold rC (see Supplementary Method 1 for details). For
the non-adaptive case (NA), when infected individuals
do not modify their behavior, the threshold is equal
to the one obtained in Refs. [35, 44]. Indeed, setting
ρ(aS , bS ) = ρS (aS )δ(bS − aS ) we obtain:
NA
rC
=

aS

(3)

2a2S

If only symptomatic nodes are isolated as soon as
they develop symptoms, we obtain, setting ρ(aS , bS ) =
ρS (aS )δ(bS − aS ):
SY M P T O
rC

=

NA
rC

γP
µ

δ + (1 − δ) γµP

(4)

For the case with CT on homogeneous population, we set
ρ(aS , bS ) = δ(aS − a)δ(bS − b), ε(aS ) = ε and no delay

9
in manual CT τC = 0. We obtain the epidemic threshold

M AN U AL
rC
=

AP P
rC
=

δ + (1 − δ − εδ) γµP

δ + (1 − δ − f δ) γµP +

q

N A γP
2rC
µ
q
+ (δ + (1 − δ − εδ) γµP )2 + 4δ 2 ε γµP
N A γP
2rC
µ

(δ + (1 − δ − f δ) γµP )2 + 4δf γµP (δ +

The more general case of populations with arbitrary distribution ρ(aS , bS ), arbitrary delays τC and general form
of ε(aS ) and f (aS ), is reported in Supplementary Method
1. In Supplementary Method 1 we also report the derivation of the epidemic threshold for the hybrid protocol. Its
values are derived from the stability conditions of a complex set of 22 differential equations, that we can solve
numerically.
C.

for both the manual and digital CT:

Model parameters

Figures present results where one of the model parameters is varied and all the others are fixed. Here we report
the parameter values used throughout the paper, unless
specified otherwise. They are tailored to describe the
current COVID-19 pandemic.
The fraction of infected individuals who develop symptoms is δ = 0.57 [1]. The time after which a presymptomatic individual spontaneously develops symptoms is
τP = 1.5 days [6, 41, 49], while infected individuals recover on average after τ = 14 days [42, 50]. The time window over which contacts are reconstructed is TCT = 14
days [49]: it is fixed equal to τ to track both nodes infected by the index case in the pre-symptomatic phase
(forward CT) and the primary case who infected the
index case (backward CT) [12]. The maximum number of contacts engaged in TCT by a single individual
that can be reconstructed with the manual CT procedure is kC = 130, according to reasonable estimates
of the number of contacts manually traced for very ac-

[1] Lavezzo, E. et al. Suppression of a sars-cov-2 outbreak
in the italian municipality of vo’. Nature 584, 425–429
(2020).
[2] Ferretti, L. et al. Quantifying sars-cov-2 transmission
suggests epidemic control with digital contact tracing.
Science 368, eabb6936 (2020).
[3] Rothe, C. et al. Transmission of 2019-ncov infection from
an asymptomatic contact in germany. N. Engl. J. Med.

γP
µ

(1 − f )(1 − δ))

(5)

(6)

tive individuals [49]. Moreover, fixing kC = 130 and
for realistic ε ∼ 0.1 − 0.5 [48], the average number of
traced contacts for each index case is approximatively
10 − 60, consistently with reported data on manual CT
and with estimates for resources allocation [46, 49, 56, 57]
(see Supplementary Notes for the distribution P (kT ) of
contacts kT traced manually by each index case). The
activity-driven network parameters are fixed so that the
average value of the activity is always the same, i.e.
aS = 6.7 days−1 [43, 48]. In particular for a power−(ν+1)
law distribution ρS (aS ) ∼ aS
, the values of aS are
constrained between a minimum and a maximum value
(am < aS < aM ). We keep aM = 103 am and then we
tune am to set aS .

D.

Numerical simulations

We perform numerical simulations of the epidemic
model on the adaptive activity-driven network: the network dynamics and epidemic spreading are implemented
by a continuous time Gillespie-like algorithm. We consider an activity-driven network of N nodes. The results
are averaged over several realizations of the disorder and
of the dynamical evolution, so that the error on the infection peak height is lower than 6%. The initial conditions
are imposed by infecting the node with the highest activity aS and the CT protocols are immediately adopted.
A detailed description of the simulations is reported in
Supplementary Method 2.

382, 970–971 (2020).
[4] Pinotti, F. et al. Tracing and analysis of 288 early sarscov-2 infections outside china: A modeling study. PLOS
Med. 17, 1–13 (2020).
[5] Li, R. et al. Substantial undocumented infection facilitates the rapid dissemination of novel coronavirus (sarscov-2). Science 368, 489–493 (2020).
[6] Wei, W. E. et al. Presymptomatic transmission of sars-

10

[7]
[8]

[9]
[10]

[11]

[12]

[13]

[14]

[15]
[16]

[17]
[18]
[19]

[20]
[21]
[22]
[23]

[24]

[25]

[26]

cov-2—singapore, january 23–march 16, 2020. Morb.
Mortal. Wkly. Rep. 69, 411 (2020).
Bonaccorsi, G. et al. Economic and social consequences of
human mobility restrictions under covid-19. Proc. Natl.
Acad. Sci. U.S.A. 117, 15530–15535 (2020).
Nicola, M. et al. The socio-economic implications of the
coronavirus pandemic (covid-19): A review. Int. J. Surg.
78, 185 – 193 (2020).
Eames, K. T. & Keeling, M. J. Contact tracing and disease control. Proc. Royal Soc. B 270, 2565–2571 (2003).
Fraser, C., Riley, S., Anderson, R. M. & Ferguson, N. M.
Factors that make an infectious disease outbreak controllable. Proc. Natl. Acad. Sci. U.S.A. 101, 6146–6151
(2004).
Klinkenberg, D., Fraser, C. & Heesterbeek, H. The effectiveness of contact tracing in emerging epidemics. PLOS
ONE 1, 1–7 (2006).
Kojaku, S., Hébert-Dufresne, L., Mones, E., Lehmann,
S. & Ahn, Y.-Y.
The effectiveness of backward contact tracing in networks.
Nat. Phys.
https://doi.org/10.1038/s41567-021-01187-2 (2021).
McLean, E. et al. Pandemic (h1n1) 2009 influenza in the
uk: clinical and epidemiological findings from the first
few hundred (ff100) cases. Epidemiol. Infect. 138, 1531–
1541 (2010).
Crook, P. et al. Lack of secondary transmission of ebola
virus from healthcare worker to 238 contacts, united
kingdom, december 2014. Emerg. Infect. Dis. 23, 2081
(2017).
Bell, D. M., on International, W. H. O. W. G. & of SARS,
C. T. Public health interventions and sars spread, 2003.
Emerg. Infect. Dis. 10, 1900–1906 (2004).
Wilder-Smith, A., Chiew, C. J. & Lee, V. J. Can we
contain the covid-19 outbreak with the same measures
as for sars? Lancet Infect. Dis. 20, e102–e107 (2020).
Hellewell, J. et al. Feasibility of controlling covid-19 outbreaks by isolation of cases and contacts. Lancet Glob.
Health 8, e488 – e496 (2020).
Privacy-preserving contact tracing. https://covid19.
apple.com/contacttracing (2020).
Troncoso, C. et al. Decentralized privacy-preserving
proximity tracing. IEEE Data Eng. Bull. 43, 36–66
(2020).
Oliver, N. et al. Mobile phone data for informing public
health actions across the covid-19 pandemic life cycle.
Sci. Adv. 6, eabc0764 (2020).
Ahmed, N. et al. A survey of covid-19 contact tracing
apps. IEEE Access 8, 134577–134601 (2020).
Sapiezynski, P., Pruessing, J. & Sekara, V.
The
fallibility of contact-tracing apps.
Preprint at
https://arxiv.org/abs/2005.11297 (2020)
Braithwaite, I., Callender, T., Bullock, M. & Aldridge,
R. W. Automated and partly automated contact tracing:
a systematic review to inform the control of covid-19.
Lancet Digital Health 2, e607–e621 (2020).
Zastrow, M. Coronavirus contact-tracing apps: can
they slow the spread of covid-19? Nature - Technology
Feature https://doi.org/10.1038/d41586-020-01514-2 (19
May 2020).
Cencetti, G. et al. Digital proximity tracing on empirical
contact networks for pandemic control. Nat. Commun.
12, 1655 (2021).
Almagor, J. & Picascia, S. Exploring the effectiveness
of a covid-19 contact tracing app using an agent-based

model. Sci. Rep. 10, 22235 (2020).
[27] Nielsen, B. F., Sneppen, K., Simonsen, L.
& Mathiesen, J.
Social network heterogeneity is essential for contact tracing.
Preprint at
https://doi.org/10.1101/2020.06.05.20123141 (2020)
[28] Kretzschmar, M. E. et al. Impact of delays on effectiveness of contact tracing strategies for covid-19: a modelling study. Lancet Public Health 5, e452 – e459 (2020).
[29] Barrat, A., Cattuto, C., Kivelä, M., Lehmann,
S. & Saramäki, J.
Effect of manual and digital contact tracing on covid-19 outbreaks:
a
study on empirical contact data
Preprint at
https://doi.org/10.1101/2020.07.24.20159947 (2020)
[30] Alessandro, L. Immuni è efficace? gli ultimi numeri, le
luci e le ombre dell’app per il covid-19. Sole24Ore (2020).
09-09-2020.
[31] O’Neill, P. H., Ryan-Mosley & Johnson, B. A flood of
coronavirus apps are tracking us. now it’s time to keep
track of them. MIT Technology Review (2020). Tech
policy/Privacy: 09-29-2020.
[32] MIT Technology Review. Covid tracing tracker. https:
//docs.google.com/spreadsheets/d/1ATalASO8KtZMx_
_zJREoOvFh0nmB-sAqJ1-CjVRSCOw/edit#gid=0 (2020).
Accessed on: 09-29-2020.
[33] Perra, N., Gonçalves, B., Pastor-Satorras, R. & Vespignani, A. Activity driven modeling of time varying networks. Sci. Rep. 2, 469 (2012).
[34] Ubaldi, E. et al. Asymptotic theory of time-varying social
networks with heterogeneous activity and tie allocation.
Sci. Rep. 6, 35724 (2016).
[35] Pozzana, I., Sun, K. & Perra, N. Epidemic spreading on
activity-driven networks with attractiveness. Phys. Rev.
E 96, 042310 (2017).
[36] Tizzani, M. et al. Epidemic spreading and aging in temporal networks with memory. Phys. Rev. E 98, 062315
(2018).
[37] Ghoshal, G. & Holme, P. Attractiveness and activity in
internet communities. Physica A 364, 603 – 609 (2006).
[38] Ubaldi, E., Vezzani, A., Karsai, M., Perra, N. & Burioni,
R. Burstiness and tie activation strategies in time-varying
social networks. Sci. Rep. 7, 46225 (2017).
[39] Starnini, M., Baronchelli, A. & Pastor-Satorras, R. Modeling human dynamics of face-to-face interaction networks. Phys. Rev. Lett. 110, 168701 (2013).
[40] Guan, W.-j. et al. Clinical characteristics of coronavirus
disease 2019 in china. N. Engl. J. Med. 382, 1708–1720
(2020).
[41] Di Domenico, L., Pullano, G., Sabbatini, C. E., Boëlle,
P.-Y. & Colizza, V. Impact of lockdown on covid-19 epidemic in ı̂le-de-france and possible exit strategies. BMC
Med. 18, 240 (2020).
[42] World Health Organization.
Report of the
who-china
joint
mission
on
coronavirus
disease
2019
(covid-19).
https://www.who.
int/docs/default-source/coronaviruse/
who-china-joint-mission-on-covid-19-final-report.
pdf (2020). Accessed on: 09-29-2020.
[43] Van Kerckhove, K., Hens, N., Edmunds, W. J. & Eames,
K. T. D. The Impact of Illness on Social Networks: Implications for Transmission and Control of Influenza. Am.
J. Epidemiol. 178, 1655–1662 (2013).
[44] Mancastroppa, M., Burioni, R., Colizza, V. & Vezzani,
A. Active and inactive quarantine in epidemic spreading
on adaptive activity-driven networks. Phys. Rev. E 102,

11
020301 (2020).
[45] Fenichel, E. P. et al. Adaptive human behavior in epidemiological models. Proc. Natl. Acad. Sci. U.S.A. 108,
6306–6311 (2011).
[52]
[46] European Center for Disease Prevention and Control.
Resource estimation for contact tracing,
quarantine and monitoring activities for covid19 cases in the eu/eea.
https://www.ecdc.
[53]
europa.eu/sites/default/files/documents/
COVID-19-resources-for-contact-tracing-2-March-2020.
pdf (2020). Accessed on: 09-29-2020.
[54]
[47] Centers for Disease Control and Prevention. Scaling
up staffing roles in case investigation and contact tracing.
https://www.cdc.gov/coronavirus/2019-ncov/
php/contact-tracing/contact-tracing-plan/
[55]
scaling-staff.html (2020).
Accessed on: 09-292020.
[48] Mossong, J. et al. Social contacts and mixing patterns
[56]
relevant to the spread of infectious diseases. PLOS Med.
5, 1–1 (2008).
[49] Keeling, M. J., Hollingsworth, T. D. & Read, J. M. Efficacy of contact tracing for the containment of the 2019
novel coronavirus (covid-19). J. Epidemiology Community Health 74, 861–866 (2020).
[57]
[50] Liu, Y. et al. Viral dynamics in mild and severe cases of
covid-19. Lancet Infect. Dis. 20, 656–657 (2020).
[51] de Arruda, G. F., Petri, G., Rodrigues, F. A. & Moreno,

Y. Impact of the distribution of recovery rates on disease spreading in complex networks. Phys. Rev. Res. 2,
013046 (2020).
Mancastroppa, M., Vezzani, A., Muñoz, M. A. & Burioni, R. Burstiness in activity-driven networks and the
epidemic threshold. J. Stat. Mech. Theory Exp. 2019,
053502 (2019).
von Wyl, V. et al. Drivers of acceptance of covid-19 proximity tracing apps in Switzerland: panel survey analysis.
JMIR Public Health Surveill. 7, e25701 (2021).
Saw, Y. E., Tan, E. Y., Liu, J. S. & Liu, J. C. Predicting public uptake of digital contact tracing during the
covid-19 pandemic: results from a nationwide survey in
Singapore. J. Med. Internet Res. 23, e24730 (2021).
Firth, J. A. et al. Using a real-world network to model
localized covid-19 control strategies. Nat. Med. 26, 1616–
1622 (2020).
European Center for Disease Prevention and Control.
Contact tracing for covid-19: current evidence, options
for scale-up and an assessment of resources needed.
https://www.ecdc.europa.eu/sites/default/files/
documents/COVID-19-Contract-tracing-scale-up.
pdf (2020). Accessed on: 09-29-2020.
Visontay, E. Victoria’s contact-tracing effort buckles under the weight of covid-19 cases. The Guardian (2020).
08-04-2020.

Supplementary Information for ”Stochastic sampling effects favor manual over
digital contact tracing”
Marco Mancastroppa and Raffaella Burioni
Dipartimento di Scienze Matematiche, Fisiche e Informatiche,
Università degli Studi di Parma, Parco Area delle Scienze, 7/A 43124 Parma, Italy and
INFN, Sezione di Milano Bicocca, Gruppo Collegato di Parma,
Parco Area delle Scienze, 7/A 43124 Parma, Italy

Claudio Castellano
Istituto dei Sistemi Complessi (ISC-CNR), Via dei Taurini 19, I-00185 Roma, Italy

arXiv:2010.03399v2 [physics.soc-ph] 30 Mar 2021

Alessandro Vezzani
Istituto dei Materiali per l’Elettronica ed il Magnetismo (IMEM-CNR),
Parco Area delle Scienze, 37/A-43124 Parma, Italy and
Dipartimento di Scienze Matematiche, Fisiche e Informatiche,
Università degli Studi di Parma, Parco Area delle Scienze, 7/A 43124 Parma, Italy

Contents
I. Supplementary Method 1: Mean-field equations and analytical derivation of the epidemic
thresholds
1
A. Manual CT
2
B. Digital CT
5
C. Hybrid CT
9
D. Limit cases
11
1. Non-adaptive case (NA)
11
2. Isolation of only symptomatic nodes
11
3. Homogeneous case without delays and without limited scalability
12
4. Heterogeneous case
12
II. Supplementary Method 2: Continuous time Gillespie-like algorithm for network dynamics
and epidemic evolution
13
III. Supplementary Notes: Robustness of the results
A. Activity-attractiveness distribution, limited scalability parameters and delays
B. Epidemic active phase
C. Deterministic household CT
D. Correlation between probability of app adoption and individual activity

14
14
14
15
16

In this supplementary information we derive the mean-field equations for the temporal evolution of the
epidemic model on adaptive activity-driven networks. We also derive analytically the epidemic threshold and
we describe the scheme of the continuous-time Gillespie-like algorithm used for the numerical approach to the
temporal evolution of the network and of the epidemic. Finally, we discuss in detail the robustness of the
results, relaxing assumptions in activity distribution, changing most CT parameters in the modelling scheme,
introducing further realistic features such as deterministic household CT and correlation between app adoption
and individual activity.

I.

Supplementary Method 1: Mean-field equations and analytical derivation of
the epidemic thresholds

We consider the epidemic model proposed in the main text evolving on an adaptive activity-driven network
in the presence of contact tracing of asymptomatic nodes.
The epidemic model proposed is a Susceptible-Infected-Recovered (SIR) model, with a further distinction for
the states of infection I. The distinction is based on the presence of symptoms, on tracing and isolation and
it models changes in social behaviour depending on nodes’ health status. We do not consider here burstiness
effects [1] nor memory [2].

2

P

S

I

A

R

T

Q

Supplementary Fig. 1: Epidemic model with contact tracing. We plot the scheme of the epidemic model with the
transitions for CT. The rates for the infection events (emanating from S) and for the CT events are not indicated, as
the relevant events, indicated in the text, are complicated.

A.

Manual CT

We first focus on the manual CT. In the original epidemic model, individuals can be in states S (susceptible),
P (infected presymptomatic), I (infected symptomatic), A (infected asymptomatic) and R (recovered). In
the presence of CT, two additional compartments appear: T (asymptomatic traced) and Q (asymptomatic
quarantined). The possible transitions among these states are depicted in Supplementary Fig. 1.
There are two types of events related to CT: an asymptomatic individual A becomes traced T when infected
by a presymptomatic node P (forward CT) or when she infects a susceptible node that eventually develops
symptoms (backward CT). A traced individual remains infectious (aT , bT ) = (aS , bS ) until the presymptomatic
starts developing symptoms. Only after that moment she enters quarantine (aQ , bQ ) = (0, 0). For this reason,
the rate for the transition T → Q is γA = 1/τA , with τA = τP + τC , where τP = 1/γP and τC is the delay in
manual CT.
In the manual case the tracing is effective with probability ε(aS ), with aS activity of the index case. The
infection and CT transitions are as follows:
λδ

λδε

λδε

P + S −→ P + P

A + S −−→ T + P

T + S −−→ T + P

(1)

P + S −−−−−→ P + T

A + S −−−−→ A + A

T + S −−−−→ T + A

(2)

P + S −−−−−−−−→ P + A

A + S −−−−−→ A + P

T + S −−−−−→ T + P

(3)

λ(1−δ)ε

λ(1−δ)(1−ε)

λ(1−δ)

λ(1−δ)

λδ(1−ε)

λδ(1−ε)

while the spontaneous transitions are:
γP

µ

µI

P −−→ I

A−
→R

I −→ R

(4)

T −−→ Q

T −
→R

Q−
→R

(5)

γA

µ

µ

λδε

Notice that in the event A + S → T + P both individuals change state; in the event T + S −−→ T + P the
individual T is traced two times (the second time from the individual she infects while already traced), but this
has actually no consequences.
We apply an activity-attractiveness based mean-field approach, dividing the population in classes of nodes
with same (aS , bS ) and considering them statistically equivalent. The model is an exact mean-field since
local correlations are continuously destroyed due to link reshuffling: thus the epidemic threshold of the SIR
and SIS epidemic models are the same [2]. Therefore, to obtain the epidemic threshold we consider the
mean-field equations for the SIS version of the model, in which the recovered nodes become susceptible again
without gaining immunity. We assign initially to each node the status of symptomatic (with probability δ) or
asymptomatic (with probability 1 − δ), instead of assigning it at the time of infection. This choice is completely
equivalent to the epidemic model described and allows us to write the mean-field equations in a simpler way.
Thus, at the mean-field level, the epidemic dynamics is described by the probabilities:
• PaS ,bS (t) for a symptomatic node to be infected pre-symptomatic at time t;
• IaS ,bS (t) for a symptomatic node to be infected symptomatic at time t;
• 1 − IaS ,bS (t) − PaS ,bS (t) to be susceptible at time t, for a node which will develop symptoms;

3
• AaS ,bS (t) for an asymptomatic node to be infected asymptomatic at time t;
• TaS ,bS (t) for an asymptomatic node to be infected traced at time t;
• QaS ,bS (t) for an asymptomatic node to be infected isolated at time t;
• 1−AaS ,bS (t)−QaS ,bS (t)−TaS ,bS (t) to be susceptible at time t, for a node which will not develop symptoms.
In this case
R the average attractiveness at time t is hb(t)i = bS − (1 − δ)bS Q(t) − δbS I(t) where we define in
general g = daS dbS ρ(aS , bS )gaS ,bS . We consider the system in the thermodynamic limit. The probabilities
previously introduced evolve accordingly to the following equations:
∂t PaS ,bS (t) = −γP PaS ,bS (t) + λaS (1 − IaS ,bS (t) − PaS ,bS (t))
+ λbS (1 − IaS ,bS (t) − PaS ,bS (t))

δbS P (t) + (1 − δ)[bS T (t) + bS A(t)]
bS − (1 − δ)bS Q(t) − δbS I(t)

δaS P (t) + (1 − δ)[aS T (t) + aS A(t)]
bS − (1 − δ)bS Q(t) − δbS I(t)

(6)

where the first term on right hand side accounts for symptoms onset; the second and third terms account for
contagion processes of a susceptible node who engages a contact with a pre-symptomatic or a non-isolated
asymptomatic infected node, respectively for the activation of the susceptible and of the infected node. Both
terms are averaged over all the activity-attractiveness classes of the infected node.
∂t IaS ,bS (t) = −µI IaS ,bS (t) + γP PaS ,bS (t)

(7)

where the first term on the right hand side accounts for spontaneous recovery and the second term for spontaneous symptoms development.
∂t AaS ,bS (t) = −µAaS ,bS (t) + λaS (1 − AaS ,bS (t) − TaS ,bS (t) − QaS ,bS (t))
+ λbS (1 − AaS ,bS (t) − TaS ,bS (t) − QaS ,bS (t))
− λaS δAaS ,bS (t)

δ[bS P (t) − εbS P (t)] + (1 − δ)[bS T (t) + bS A(t)]
bS − (1 − δ)bS Q(t) − δbS I(t)

δ[aS P (t) − εaS P (t)] + (1 − δ)[aS T (t) + aS A(t)]
bS − (1 − δ)bS Q(t) − δbS I(t)

εbS − εbS I(t) − εbS P (t)
εaS − εaS I(t) − εaS P (t)
− λbS δAaS ,bS (t)
bS − (1 − δ)bS Q(t) − δbS I(t)
bS − (1 − δ)bS Q(t) − δbS I(t)
(8)

where the first term on right hand side accounts for spontaneous recovery; the second and third terms account
for contagion processes of a susceptible node who engages a contact with a non-isolated asymptomatic infected
node or with a pre-symptomatic node and their contact is not traced ((1 − ε(a0S )), with a0S activity of the
pre-symptomatic node). Both terms are averaged over all the activity-attractiveness classes of the infected
node. The fourth and fifth terms correspond to contact tracing of infected asymptomatic due to infection of a
susceptible symptomatic and effective CT of the link (ε(a0S ), with a0S activity of the pre-symptomatic node).
Both terms are averaged over all the activity-attractiveness classes of the susceptible node.

∂t TaS ,bS (t) = −(µ + γA )TaS ,bS (t) + λbS (1 − AaS ,bS (t) − TaS ,bS (t) − QaS ,bS (t))
+ λaS (1 − AaS ,bS (t) − TaS ,bS (t) − QaS ,bS (t))
+ λbS δAaS ,bS (t)
+ λaS δAaS ,bS (t)

δεaS P (t)
bS − (1 − δ)bS Q(t) − δbS I(t)

δεbS P (t)
bS − (1 − δ)bS Q(t) − δbS I(t)

εaS − εaS I(t) − εaS P (t)
bS − (1 − δ)bS Q(t) − δbS I(t)

εbS − εbS I(t) − εbS P (t)
bS − (1 − δ)bS Q(t) − δbS I(t)

(9)
where the first term on right hand side accounts for isolation and recovery. The second and third terms account
for contagion processes of a susceptible node who engage a contact with a pre-symptomatic node and their
contact is traced (ε(a0S ), with a0S activity of the pre-symptomatic node). Both terms are averaged over all the
activity-attractiveness classes of the infected node. The fourth and fifth terms correspond to contact tracing of
infected asymptomatic due to infection of a susceptible symptomatic and effective CT of the link (ε(a0S ), with
a0S activity of the pre-symptomatic node). Both terms are averaged over all the activity-attractiveness classes
of the susceptible node.
∂t QaS ,bS (t) = −µQaS ,bS (t) + γA TaS ,bS (t)

(10)

4
where the first term on right hand side accounts for spontaneous recovery and the second term for isolation of
traced asymptomatic infected nodes.
This set of equations admits as a stationary state the absorbing state, a configuration where all the population
is susceptible. To obtain the condition for the stability of the absorbing state, i.e. the epidemic threshold, we
apply a linear stability analysis around the absorbing state.
Let us now consider the case of realistic correlations between the activity and attractiveness [3, 4]: ρ(aS , bS ) =
ρS (aS )δ(bS −aS ), with generic ρS (aS ). If we average the equations on all activity classes, we obtain the temporal
evolution of the average probabilities P (t), I(t), A(t), T (t), Q(t); similarly we obtain the temporal evolution of
aS T (t), aS A(t), aS P (t) and εaS P (t) multiplying the equations for aS ρS (aS ) or ε(aS )aS ρS (aS ) and integrating.
Neglecting second order terms in probabilities, we obtain a linearized set of 9 differential equations:
∂t I(t) = −µI I(t) + γP P (t)

(11)

∂t Q(t) = −µQ(t) + γA T (t)

(13)

∂t P (t) = −γP P (t) + 2λ[δaS P (t) + (1 − δ)(aS T (t) + aS A(t))]

(12)

εaS
∂t T (t) = −(µ + γA )T (t) + 2λδεaS P (t) + 2λδaS A(t)
aS

(14)

∂t A(t) = −µA(t) + 2λ[δ(aS P (t) − εaS P (t)) + (1 − δ)(aS T (t) + aS A(t))] − 2λδaS A(t)
∂t aS P (t) = −γP aS P (t) + 2λ

a2S
[δaS P (t) + (1 − δ)(aS T (t) + aS A(t))]
aS

∂t εaS P (t) = −γP εaS P (t) + 2λ

εa2S
[δaS P (t) + (1 − δ)(aS T (t) + aS A(t))]
aS

∂t aS T (t) = −(µ + γA )aS T (t) + 2λδ
∂t aS A(t) = −µaS A(t) + 2λ

εaS
aS

a2S
εaS
εaS P (t) + 2λδa2S A(t)
aS
aS

a2S
εaS
[δ(aS P (t) − εaS P (t)) + (1 − δ)(aS T (t) + aS A(t))] − 2λδa2S A(t)
aS
aS

(15)
(16)
(17)
(18)
(19)

The linearized equations for the dynamic evolution of anS A(t) and anS T (t) always involve terms like an+1
A(t),
S
due to the contact tracing terms. This would produce an infinite set of coupled linear differential equations: to
close the equations and obtain a complete set of linearized equations, we express a2S A(t) in terms of the other
R
average probabilities. By definition a2S A(t) = daS ρS (aS )a2S AaS (t): since we are interested in studying the
absorbing steady state, we consider Eq. (8) for ρ(aS , bS ) = ρS (aS )δ(bS − aS ), linearized around the absorbing
state and near the stationary condition ∂t AaS (t) ∼ 0:
AaS (t) '

2λaS [δ(aS P (t) − εaS P (t)) + (1 − δ)(aS T (t) + aS A(t))]
µaS + 2λδaS εaS

(20)

Thus, setting r = λ/µ and replacing Eq. (20) into the definition of a2S A(t) we obtain:
a2S A(t) '
where K =

a3S
1+2rδaS

εaS
aS

=

R

2r
[δ(aS P (t) − εaS P (t)) + (1 − δ)(aS T (t) + aS A(t))]K
aS

daS ρS (aS )

a3S
1+2rδaS

εaS
aS

(21)

.

In this way we obtain the following linearized equations for aS T (t) and aS A(t), near the absorbing stationary
state:

∂t aS T (t) = −(µ + γA )aS T (t) + 2λδ

a2S
εaS
εaS P (t) + 4λr 2 δK[δ(aS P (t) − εaS P (t)) + (1 − δ)(aS T (t) + aS A(t))]
aS
aS

(22)
∂t aS A(t) = −µaS A(t) + 2λ

a2S

[δ(aS P (t) − εaS P (t)) + (1 − δ)(aS T (t) + aS A(t))]
aS
εaS
− 4λr 2 δK[δ(aS P (t) − εaS P (t)) + (1 − δ)(aS T (t) + aS A(t))]
aS

(23)

5
We focus on the Jacobian matrix of this set of 9 linearized equations:

−µI γP
0
0
0
0
 0 −γP 0
0
0
2λδ

 0
0 −µ
γA
0
0

 0
0
0
−µ
−
γ
0
0
A

J =
0
0
0
0
−µ
2λδ

 0
0
0
0
0 −γP + ∆

 0
0
0
0
0
φ

 0
0
0
0
0
θ
0
0
0
0
0
∆−θ
a2

a2

where ∆ = 2λδ aSS , Γ = 2λ(1−δ) aSS , φ = 2λδ


0
0
0

0
2λ(1 − δ)
2λ(1 − δ)


0
0
0

εaS
 

2λδ
0
2λδ aS

A(5x5) C(5x4)
S
=
−2λδ
2λ(1 − δ) 2λ(1 − δ) − 2λδ εa
aS 
O(4x5) B(4x4)

0
Γ
Γ


−γP
Φ
Φ


∆ − θ −µ − γA + Ψ
Ψ
θ−∆
Γ−Ψ
−µ + Γ − Ψ
(24)
εa2S
aS ,

Φ = 2λ(1−δ)

εa2S
aS ,

θ = 4λrδ 2 aεaSS2 K and Ψ = 4λrδ(1−δ) aεaSS2 K.

The Jacobian matrix is a block matrix and the condition for the stability of the absorbing state is obtained
imposing all eigenvalues to be negative. We can consider separately the two blocks on the diagonal: for the
first block A it is evident that the eigenvalues are ξ1,2 = −µ, ξ3 = −µI , ξ4 = −γP , ξ5 = −µ − γA , all negative.
Therefore, it is sufficient to study block B, which is a matrix 4x4. The characteristic polynomial of B is a
polynomial of degree 4, thus we apply the Descartes’ rule of signs to impose all roots to be negative and we
obtain the condition for the stability of the absorbing state:
"
#
εa2S εaS
a3S
a3S
γP
γA
γA
2
2
2
8r δ (1 − δ)
− 4r δ(1 − δ) εaS aS +
εaS
εa
εa
S
S
aS 1 + 2rδaS a µ
µ
µ
1 + 2rδaS aS
S





γA
γP
γP γA
+ 2ra2S aS
+1
δ+
(1 − δ) − aS 2
+1 <0
µ
µ
µ
µ
3 2

(25)

By setting the equality, the equation allows to obtain a closed relation for estimating the epidemic threshold
rC . The epidemic threshold obtained with the mean-field approach is exact and it holds for manual contact
tracing, with arbitrary delay τC (encapsulated in γA ), for arbitrary ρS (aS ) and ε(aS ).

B.

Digital CT

We now focus on the digital CT. Each individual is either endowed or not with the app in the initial condition
(with a probability f (aS ) depending on her activity). This implies that there are different compartments for
individuals without the app (S, I, P , etc.) and with the app (denoted with the superscript α : S α , I α , P α ,
etc.). Notice that, for pure digital CT, necessarily T = 0 and Q = 0. We nevertheless write here the transitions
involving them, that may play a role for hybrid protocols.
The spontaneous transitions do not depend on whether the individual has the app or not, but the difference
with respect to the manual protocol is that τC = 0 so that γA = γP . The infection events are instead as follows.
Those involving both individuals without the app (in such a case no new traced individual is generated):
λδ

λδ

λδ

P + S −→ P + P

A + S −→ A + P

T + S −→ T + P

(26)

P + S −−−−→ P + A

A + S −−−−→ A + A

T + S −−−−→ T + A

(27)

λ(1−δ)

λ(1−δ)

λ(1−δ)

Those involving only one individual with the app (in such a case no new traced individual is generated):
λδ

λδ

λδ

P α + S −→ P α + P

Aα + S −→ Aα + P

T α + S −→ T α + P

(28)

P α + S −−−−→ P α + A

Aα + S −−−−→ Aα + A

T α + S −−−−→ T α + A

(29)

P + S −→ P + P α

A + S −→ A + P α

T + S −→ T + P α

(30)

λ(1−δ)

α λδ

α λ(1−δ)

P + S −−−−→ P + A

α

λ(1−δ)

α λδ

α λ(1−δ)

A + S −−−−→ A + A

α

λ(1−δ)

α λδ

α λ(1−δ)

T + S −−−−→ T + A

α

(31)

Those involving both individuals with the app (in such a case new traced individuals can be generated):
λδ

λδ

λδ

P α + S α −→ P α + P α

Aα + S α −→ T α + P α

T α + S α −→ T α + P α

(32)

P α + S α −−−−→ P α + T α

Aα + S α −−−−→ Aα + Aα

T α + S α −−−−→ T α + Aα

(33)

λ(1−δ)

λ(1−δ)

λ(1−δ)

Analogously to the manual CT we apply the activity-attractiveness based mean-field approach to the app-based
CT. At the mean-field level, the epidemic dynamics is described by the probabilities:

6
• PaS ,bS (t) for a symptomatic node without app to be infected pre-symptomatic at time t;
• IaS ,bS (t) for a symptomatic node without app to be infected symptomatic at time t;
• 1 − PaS ,bS (t) − IaS ,bS (t) to be susceptible at time t, for a node without app and which will develop
symptoms;
• AaS ,bS (t) for an asymptomatic node without app to be infected asymptomatic at time t;
• 1 − AaS ,bS (t) to be susceptible at time t, for a node without app and which will not develop symptoms;
• PaαS ,bS (t) for a symptomatic node with app to be infected pre-symptomatic at time t;
• IaαS ,bS (t) for a symptomatic node with app to be infected symptomatic at time t;
• 1 − PaαS ,bS (t) − IaαS ,bS (t) to be susceptible at time t, for a node with app and which will develop symptoms;
• Aα
aS ,bS (t) for an asymptomatic node with app to be infected asymptomatic at time t;
• TaαS ,bS (t) for an asymptomatic node with app to be infected traced at time t;
• Qα
aS ,bS (t) for an asymptomatic node with app to be infected isolated at time t;
α
α
• 1 − Aα
aS ,bS (t) − QaS ,bS (t) − TaS ,bS (t) to be susceptible at time t, for a node with app and which will not
develop symptoms.

In this case the average attractiveness at time t is hb(t)i = bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t)).
We consider the system in the thermodynamic limit: the probabilities previously introduced evolve according
to the following equations, obtained analogously to those for manual CT:
∂t IaS ,bS (t) = −µI IaS ,bS (t) + γP PaS ,bS (t)

(34)

∂t PaS ,bS (t) = − γP PaS ,bS (t)

+ λaS (1 − IaS ,bS (t) − PaS ,bS (t))
+ λbS (1 − IaS ,bS (t) − PaS ,bS (t))

δ(f bS P α (t) + (1 − f )bS P (t)) + (1 − δ)(f bS T α (t) + f bS Aα (t) + (1 − f )bS A(t))
δ(f aS

P α (t)

bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

+ (1 − f )aS P (t)) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))
bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

∂t IaαS ,bS (t) = −µI IaαS ,bS (t) + γP PaαS ,bS (t)
∂t PaαS ,bS (t) = − γP PaαS ,bS (t)

(35)
(36)

+ λaS (1 − IaαS ,bS (t) − PaαS ,bS (t))

δ(f bS P α (t) + (1 − f )bS P (t)) + (1 − δ)(f bS T α (t) + f bS Aα (t) + (1 − f )bS A(t))

+ λbS (1 − IaαS ,bS (t) − PaαS ,bS (t))

δ(f aS P α (t) + (1 − f )aS P (t)) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))

bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

(37)

∂t AaS ,bS (t) = − µAaS ,bS (t)
+ λaS (1 − AaS ,bS (t))
+ λbS (1 − AaS ,bS (t))

δ(f bS P α (t) + (1 − f )bS P (t)) + (1 − δ)(f bS T α (t) + f bS Aα (t) + (1 − f )bS A(t))
δ(f aS

P α (t)

bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

+ (1 − f )aS P (t)) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))
bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

(38)

α
∂t Aα
aS ,bS (t) = − µAaS ,bS (t)
α
α
+ λaS (1 − Aα
aS ,bS (t) − TaS ,bS (t) − QaS ,bS (t))
α
α
+ λbS (1 − Aα
aS ,bS (t) − TaS ,bS (t) − QaS ,bS (t))

− λδaS Aα
aS ,bS (t)
− λδbS Aα
aS ,bS (t)

f bS − f bS

bS − (1 − δ)f bS

Qα (t)

P α (t)

δ(1 − f )bS P (t) + (1 − δ)(f bS T α (t) + f bS Aα (t) + (1 − f )bS A(t))
bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))
bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

− f bS I α (t)

− δ(f bS I α (t) + (1 − f )bS I(t))

f aS − f aS P α (t) − f aS I α (t)

bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

(39)

7
α
α
∂t Qα
aS ,bS (t) = −µQaS ,bS (t) + γP TaS ,bS (t)
α
α
∂t TaS ,bS (t) = − (µ + γP )TaS ,bS (t)

(40)
(41)

α
α
+ λaS (1 − Aα
aS ,bS (t) − TaS ,bS (t) − QaS ,bS (t))
α
α
+ λbS (1 − Aα
aS ,bS (t) − TaS ,bS (t) − QaS ,bS (t))

+ λδaS Aα
aS ,bS (t)
+ λδbS Aα
aS ,bS (t)

f bS − f bS

P α (t)

δf bS P α (t)
bS − (1 − δ)f bS
bS − (1 − δ)f bS
− f bS

Qα (t)

− δ(f bS I α (t) + (1 − f )bS I(t))

δf aS P α (t)

Qα (t)

I α (t)

− δ(f bS I α (t) + (1 − f )bS I(t))

bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))
f aS − f aS P α (t) − f aS I α (t)

bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

This set of equations admits as a stationary state the absorbing state, a configuration where all the population
is susceptible. To obtain the condition for the stability of the absorbing state, i.e. the epidemic threshold, we
apply a linear stability analysis around the absorbing state.
Let us now consider the case of realistic correlations between the activity and attractiveness: ρ(aS , bS ) =
ρS (aS )δ(bS − aS ), with general ρS (aS ). If we average on all activity classes, we obtain the temporal evolution
of the average probabilities P (t), I(t), A(t), P α (t), I α (t), Aα (t), Qα (t), T α (t); similarly we obtain the temporal
evolution of f aS P α (t), f aS T α (t), aS Aα (t), f aS Aα (t), (1 − f )aS P (t), (1 − f )aS A(t), multiplying the equations
for f (aS )aS ρS (aS ) or aS ρS (aS ) or (1 − f (aS ))aS ρS (aS ) and integrating over all activity classes. We neglect the
terms of second order in probabilities obtaining a linearized set of 14 differential equations:
∂t I(t) = −µI I(t) + γP P (t)

(42)

∂t P (t) = −γP P (t) + 2λ[δ(f aS

P α (t)

+ (1 − f )aS P (t)) + (1 − δ)(f aS

T α (t)

+ f aS

Aα (t)

+ (1 − f )aS A(t))]

∂t I α (t) = −µI I α (t) + γP P α (t)
∂t

P α (t)

= −γP

P α (t)

+ 2λ[δ(f aS

(43)
(44)

P α (t)

+ (1 − f )aS P (t)) + (1 − δ)(f aS

T α (t)

+ f aS

Aα (t)

+ (1 − f )aS A(t))]
(45)

∂t A(t) = −µA(t) + 2λ[δ(f aS P α (t) + (1 − f )aS P (t)) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))] (46)

∂t Qα (t) = −µQα (t) + γP T α (t)

(47)

∂t T α (t) = −(µ + γP )T α (t) + 2λδf aS P α (t) + 2λδaS Aα (t)

f aS
aS

∂t Aα (t) = − µAα (t) + 2λ[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]
− 2λδaS Aα (t)

(48)
(49)

f aS
aS

∂t aS Aα (t) = − µaS Aα (t) + 2λ

a2S
[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]
aS

f aS
aS
α
α
∂t f aS P (t) = − γP f aS P (t)

(50)

− 2λδa2S Aα (t)

(51)

f a2
+ 2λ S [δ(f aS P α (t) + (1 − f )aS P (t)) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]
aS

∂t (1 − f )aS P (t) = − γP (1 − f )aS P (t)
+ 2λ

(1 − f )a2S
[δ(f aS P α (t) + (1 − f )aS P (t)) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]
aS
(52)

∂t (1 − f )aS A(t) = − µ(1 − f )aS A(t)
+ 2λ

(1 − f )a2S
[δ(f aS P α (t) + (1 − f )aS P (t)) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]
aS
(53)

∂t f aS T α (t) = −(µ + γP )f aS T α (t) + 2λδ
∂t f aS Aα (t) = − µf aS Aα (t) + 2λ
− 2λδf a2S Aα (t)

f a2S
f aS
f aS P α (t) + 2λδf a2S Aα (t)
aS
aS

f a2S
[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]
aS

(54)
(55)

f aS
aS

Similarly to the manual CT, in order to close the equations and obtain a complete set of linearized equations,
we express f a2S Aα (t) and a2S Aα (t) in terms of the other average probabilities using their own definition. By

8
R
R
2 α
daS ρS (aS )a2S Aα
definition f a2S Aα (t) = daS ρS (aS )f (aS )a2S Aα
aS (t) and aS A (t) =
aS (t): since we are interested
in studying the steady state and its stability, we consider the Eq. (39) for ρ(aS , bS ) = ρS (aS )δ(bS −aS ), linearized
around the absorbing state and near to the stationary condition ∂t Aα
aS (t) ∼ 0:
Aα
aS (t) '

2λaS [δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]
µaS + 2λδaS f aS

(56)

Thus,
2
r[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]H
aS
2
a2S Aα (t) '
r[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]Z
aS

f a2S Aα (t) '

where H =

f a3S
fa
1+2rδaS a S
S

=

R

daS ρS (aS )

f (aS )a3S
fa
1+2rδaS a S
S

,Z=

a3S
1+2rδaS

f aS
aS

(57)
(58)

.

In this way we obtain the following linearized equations for f aS T α , f aS Aα and aS Aα near the absorbing
stationary state:

∂t aS Aα (t) = − µaS Aα (t) + 2λ
− 4λrδ

a2S
[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]
aS

(59)

f aS
[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]Z
aS 2

∂t f aS T α (t) = − (µ + γP )f aS T α (t) + 2λδ
+ 4λrδ

(60)

f aS
[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]H
aS 2

∂t f aS Aα (t) = − µf aS Aα (t) + 2λ
− 4λrδ

f a2S
f aS P α (t)
aS

f a2S
[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]
aS

f aS
[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]H
aS 2

(61)

Focusing on the Jacobian matrix of this set of 14 linearized equations:

−µI γP
0
0
0
0
0
0
0
0
0
0
0
0
0
−γ
0
0
0
0
0
0
0
2λδ
2λδ
2λ(1
−
δ)
2λ(1
−
δ)
2λ(1
−
δ)


P


0 −µI γP
0
0
0
0
0
0
0
0
0
0
 0



0
0
0
−γ
0
0
0
0
0
2λδ
2λδ
2λ(1
−
δ)
2λ(1
−
δ)
2λ(1
−
δ)


P
 0
0
0
0 −µ 0
0
0
0
2λδ
2λδ
2λ(1 − δ)
2λ(1 − δ)
2λ(1 − δ) 


 0

0
0
0
0 −µ
+γP
0
0
0
0
0
0
0




f aS
 0

0
0
0
0
0 −µ − γP 0
2λδ aS
2λδ
0
0
0
0


J =
f aS
0
0
0
0
0
0
−µ −2λδ aS
0
2λδ
2λ(1 − δ)
2λ(1 − δ)
2λ(1 − δ) 

 0

Z
Z
Z
Z
 0

0
0
0
0
0
0
0
−µ
0
∆ + φ − ΦH
θ + Γ − ΨH
θ + Γ − ΨH
θ + Γ − ΨH


0
0
0
0
0
0
0
0
−γP + ∆
∆
Γ
Γ
Γ

 0


0
0
0
0
0
0
0
0
0
φ
−γ
+
φ
θ
θ
θ


P


0
0
0
0
0
0
0
0
φ
φ
−µ + θ
θ
θ

 0

 0
0
0
0
0
0
0
0
0
∆
Φ
Ψ
−µ − γP + Ψ
Ψ
0
0
0
0
0
0
0
0
0
0
∆−Φ
Γ−Ψ
Γ−Ψ
−µ + Γ − Ψ


A(9x9) C(9x5)
=
O(5x9) B(5x5)
(62)


where ∆ = 2λδ

f a2S
aS ,

Γ = 2λ(1 − δ)

f a2S
aS ,

φ = 2λδ

(1−f )a2S
,
aS

θ = 2λ(1 − δ)

(1−f )a2S
,
aS

Φ = 4λrδ 2 faaSS2 H and Ψ =

4λrδ(1 − δ) faaSS2 H.
The Jacobian matrix is a block matrix and we can consider separately the two blocks on the diagonal: for
the first block A it is evident that the eigenvalues are ξ1,2 = −µI , ξ3,4,5,6 = −µ, ξ7,8 = −γP , ξ9 = −µ − γP , all
negative. Therefore, it is sufficient to study block B, which is a matrix 5x5. The characteristic polynomial of

9
B is a polynomial of degree 5: we apply the Descartes’ rule of signs, to impose all roots to be negative and we
obtain the condition for the stability of the absorbing state:


2 fa
3
3
2
f
a
f
a
f
a
γ
γ
S
P
P
S
S
 γP
− 4r2 δ(1 − δ) f a2S +
f aS
8r3 δ 2 (1 − δ) S
f
a
f
a
S
S
aS
µ
µ
1 + 2rδaS aS µ
1 + 2rδaS aS





γP
γP
γP γP
+ 2ra2S aS
+1
δ+
(1 − δ) − aS 2
+1 <0
µ
µ
µ
µ

(63)

By setting the equality, the equation allows to obtain a closed relation for an estimate of the epidemic
threshold. The epidemic threshold obtained with the mean-field approach is exact and it holds for digital
contact tracing, with arbitrary ρS (aS ) and f (aS ).

C.

Hybrid CT

We now focus on the hybrid CT, with simultaneous implementation of both digital and manual CT. The
transitions occurring in this case can be deduced starting from the transitions described above for manual and
α
digital CT. A relevant difference is the need to consider an additional compartment, TM
, indicating individual
endowed with the app that are nevertheless traced manually, so that their transition to the Qα state occurs with
a rate γA . In a manner analogous to the previous cases, we apply the activity-attractiveness based mean-field
approach to the hybrid CT. At the mean-field level, the epidemic dynamics is described by the probabilities
defined for the digital CT, with these additional/redefined probabilities:
• TaαS ,bS |M (t) for an asymptomatic node with app to be infected and traced manually;
• TaS ,bS (t) for an asymptomatic node without the app to be infected and traced manually;
• QaS ,bS (t) for an asymptomatic node without the app to be isolated;
• 1 − AaS ,bS (t) − QaS ,bS (t) − TaS ,bS (t) to be susceptible at time t, for a node without app and which will
not develop symptoms;
α
α
α
• 1 − Aα
aS ,bS (t) − QaS ,bS (t) − TaS ,bS (t) − TaS ,bS |M (t) to be susceptible at time t, for a node with app and
which will not develop symptoms;

We consider the system in the thermodynamic limit and for ρ(aS , bS ) = ρS (aS )δ(bS − aS ): in this case the
average attractiveness at time t is hb(t)i = aS −(1−δ)(f aS Qα (t)+(1 − f )aS Q(t))−δ(f aS I α (t)+(1 − f )aS I(t)).
The probabilities introduced evolve according to the following equations, obtained analogously to those for
manual and digital CT:
∂t PaS (t) = −γP PaS (t) + 2λ(1 − PaS (t) − IaS (t))

aS
[δ(aS f P α (t) + aS (1 − f )P (t))
hb(t)i

α (t) + a (1 − f )T (t) + a (1 − f )A(t))]
+ (1 − δ)(aS f Aα (t) + aS f T α (t) + aS f TM
S
S

∂t IaS (t) = −µI IaS (t) + γP PaS (t)

aS
∂t PaαS (t) = −γP PaαS (t) + 2λ(1 − PaαS (t) − IaαS (t))
[δ(aS f P α (t) + aS (1 − f )P (t))
hb(t)i

(64)

(65)
(66)

α (t) + a (1 − f )T (t) + a (1 − f )A(t))]
+ (1 − δ)(aS f Aα (t) + aS f T α (t) + aS f TM
S
S

∂t IaαS (t) = −µI IaαS (t) + γP PaαS (t)

(67)
aS
α
∂t AaS (t) = − µAaS (t) + 2λ(1 − AaS (t) − TaS (t) − QaS (t))
[δ(aS (1 − ε)f P (t) + aS (1 − ε)(1 − f )P (t))
hb(t)i

α (t) + a (1 − f )T (t) + a (1 − f )A(t))]
+ (1 − δ)(aS f Aα (t) + aS f T α (t) + aS f TM
S
S
aS
α
α
− 2λδAaS (t)
[(aS εf − aS εf P (t) − aS εf I (t)) + (aS ε(1 − f ) − aS ε(1 − f )P (t) − aS ε(1 − f )I(t))]
hb(t)i
(68)
aS
∂t TaS (t) = − (µ + γA )TaS (t) + 2λδ
(1 − AaS (t) − TaS (t) − QaS (t))[aS εf P α (t) + aS ε(1 − f )P (t)]
hb(t)i
aS
+ 2λδAaS (t)
[(aS εf − aS εf P α (t) − aS εf I α (t)) + (aS ε(1 − f ) − aS ε(1 − f )P (t) − aS ε(1 − f )I(t))]
hb(t)i
(69)

∂t QaS (t) = −µQaS (t) + γA TaS (t)

(70)

10
α
α
α
α
α
∂t Aα
aS (t) = − µAaS (t) + 2λ(1 − AaS (t) − TaS (t) − TaS |M (t) − QaS (t))

aS
[δaS (1 − ε)(1 − f )P (t)
hb(t)i

α (t) + a (1 − f )T (t) + a (1 − f )A(t))]
+ (1 − δ)(aS f Aα (t) + aS f T α (t) + aS f TM
S
S
aS
α
α
α
− 2λδAaS (t)
[(aS f − aS f P (t) − aS f I (t)) + (aS ε(1 − f ) − aS ε(1 − f )P (t) − aS ε(1 − f )I(t))]
hb(t)i
(71)
a
S
α
α
α
α
(72)
∂t TaαS (t) = −(µ + γP )TaαS (t) + 2λδ
(1 − Aα
aS (t) − TaS (t) − TaS |M (t) − QaS (t))aS f P (t)
hb(t)i
aS
+ 2λδAα
[aS f − aS f P α (t) − aS f I α (t)]
aS (t)
hb(t)i
aS
α
α
α
(73)
∂t TaαS |M (t) = −(µ + γA )TaαS |M (t) + 2λδ
(1 − Aα
aS (t) − TaS (t) − TaS |M (t) − QaS (t))aS ε(1 − f )P (t)
hb(t)i
aS
+ 2λδAα
[aS ε(1 − f ) − aS ε(1 − f )P (t) − aS ε(1 − f )I(t)]
aS (t)
hb(t)i
α
α
α
(74)
∂t Qα
aS (t) = −µQaS (t) + γP TaS (t) + γA TaS |M (t)

This set of equations admits as a stationary state the absorbing state: to obtain the epidemic threshold,
we apply a linear stability analysis around the absorbing state. We consider the temporal evolution of the
probabilities averaged on the activity (eventually multiplied by combinations of aS , ε(aS ) and f (aS )), obtaining
a closed and complete set of 22 non-linear differential equations. The set of equations can be linearized obtaining
the following Jacobian matrix:

J=



A(13x13) C(13x9)
O(9x13) B(9x9)

(75)

where O is the zero matrix.


−µI γP
0
0
0
0
0 0
0
0
0
0
0
0
0
0
0 0
0
0
0
0
0
 0 −γP 0

 0

0 −µI γP
0
0
0 0
0
0
0
0
0


 0

0
0 −γP 0
0
0 0
0
0
0
0
0


 0

0
0
0 −µ
γA
0 0
0
0
0
0
0


aS ε

 0
0
0
0
0
−µ
−
γ
0
0
0
0
0
2λδ
0
A


aS


0
0
0
0
0
0
−µ 0
0
0
0 −2λδ aaSSε
 0

A=

0
0
0
0
0
0 −µ
γP
γA
0
0
0
 0



aS f
 0

0
0
0
0
0
0 0 −µ − γP
0
0
0
2λδ aS




aS ε(1−f )
 0

0
0
0
0
0
0 0
0
−µ − γA 0
0
2λδ aS


aS f +aS ε(1−f ) 
 0
0
0
0
0
0
0 0
0
0
−µ
0
−2λδ


aS
 0

0
0
0
0
0
0 0
0
0
0
−µ
0
0
0
0
0
0
0
0 0
0
0
0
0
−µ
(76)


0
0
0
0
0
0
0
0
0
 0
0
2λδ
2λδ
2λ(1
−
δ)
2λ(1
−
δ)
2λ(1
−
δ)
2λ(1
−
δ)
2λ(1
− δ)


 0

0
0
0
0
0
0
0
0


 0
0
2λδ 2λδ 2λ(1 − δ) 2λ(1 − δ) 2λ(1 − δ) 2λ(1 − δ) 2λ(1 − δ)


 0

0
0
0
0
0
0
0
0


0
0
0
0
0
0
0
 2λδ 2λδ



C = −2λδ −2λδ 2λδ 2λδ 2λ(1 − δ) 2λ(1 − δ) 2λ(1 − δ) 2λ(1 − δ) 2λ(1 − δ)
(77)
 0

0
0
0
0
0
0
0
0


 0

0
0 2λδ
0
0
0
0
0


 2λδ

0
0
0
0
0
0
0
0


−2λδ
0
2λδ 0 2λ(1 − δ) 2λ(1 − δ) 2λ(1 − δ) 2λ(1 − δ) 2λ(1 − δ)


 −Ψδ −Ψδ Ψδ Ψδ Ψ(1 − δ) Ψ(1 − δ) Ψ(1 − δ) Ψ(1 − δ) Ψ(1 − δ) 
−θδ
0
θδ 0 θ(1 − δ) θ(1 − δ) θ(1 − δ) θ(1 − δ) θ(1 − δ)

11
a2

a2

)+aS f
J, K =
with Ψ = 2λ aSS − 4λrδ aaSS 2ε K, θ = 2λ aSS − 4λrδ aS ε(1−f
aS 2

a3S
1+2raS δ

aS ε
aS

and J =

a3S
aS f +aS ε(1−f )
1+2raS δ
aS

.


−γP
0
Ξδ
Ξδ
Ξσ
Ξσ
Ξσ
Ξσ
Ξσ
 0 −γP
Πδ
Πδ
Πσ
Πσ
Πσ
Πσ
Πσ 


 0
0 −γP + ∆δ
∆δ
∆σ
∆σ
∆σ
∆σ
∆σ 


0
βδ
−γP + βδ
βσ
βσ
βσ
βσ
βσ 
 0


φδ
φδ
−µ − γA + φσ
φσ
φσ
φσ
φσ 
B =  Ωδ Ωδ

 −Γδ 0
Γδ
βδ
Γσ
−µ
−
γ
+
Γσ
Γσ
Γσ
Γσ


P
 Σδ
0
Φδ
0
Φσ
Φσ
−µ − γA + Φσ
Φσ
Φσ 


−Ωδ −Ωδ
Ωδ
Ωδ
Ωσ
Ωσ
Ωσ
−µ + Ωσ
Ωσ 
−Λδ 0
Λδ
0
Λσ
Λσ
Λσ
Λσ
−µ + Λσ
(78)


with σ = (1 − δ), Ξ = 2λ

)
Φ = 4λrδ aS ε(1−f
Y, H =
aS 2

a2S ε(1−f )
,
aS
(1−f )a3S
1+2rδaS

Π = 2λ

aS ε
aS

,Y =

a2S εf
aS ,

∆ = 2λ

1+2rδaS

a2S (1−f )
,
aS

f a3S
aS ε(1−f )+aS f
aS

β = 2λ

a2S f
aS ,

φ = 4λrδ aaSS 2ε H, Γ = 4λrδ aaSS f2 Y ,

, Ω = ∆ − φ, Σ = β − Φ and Λ = −Γ − Φ + β.

The Jacobian matrix is a block matrix and we can consider separately the two blocks on the diagonal: the
first block A is triangular and the eigenvalues are ξ1,2 = −µI , ξ3,4,5,6,7,8 = −µ, ξ9,10 = −γP , ξ11 = −µ − γP ,
ξ12,13 = −µ − γA all negative. Therefore, it is sufficient to study block B, which is a matrix 9x9. The epidemic
threshold in the hybrid case is therefore obtained by numerically diagonalizing the matrix B and imposing all
its eigenvalues to be negative: this allows to obtain analytically the epidemic threshold for the hybrid CT for
arbitrary ρS (aS ), ε(aS ) and f (aS ).

D.

Limit cases

The obtained closed relations for the stability of the absorbing state in the manual and digital CT hold
for arbitrary ρS (aS ), for completely general f (aS ) and ε(aS ) and for general delays: this allows to introduce
complicated effects, such as delay in isolation, activity heterogeneities and limited scalability of the system.
Due to the complicated structure of the equations for the stability (Eq. (25) and Eq. (63)), it is possible
to derive the epidemic threshold rC only by solving the equation numerically. However, there are some simple
limit cases in which the equations are considerably simplified, allowing to obtain the epidemic threshold in an
explicit analytic form.
1.

Non-adaptive case (NA)

Here we consider the non-adaptive case, in which no adaptive behaviour are implemented, i.e. infected nodes
behave as if they were susceptible, with (aI , bI ) = (aS , bS ). Thus, in this case f (aS ) = ε(aS ) = 0, ∀aS and
γP /µ = 1. Replacing these values either in Eq. (25) or in Eq. (63) we obtain, as expected:
2ra2S aS − aS 2 = 0
So we obtain an explicit form for the epidemic threshold rC in the non-adaptive case:
NA
rC
=

aS
2a2S

(79)

which is the Eq. (3) in the main paper. It reproduces the results previously obtained in Refs. [3, 5].
2.

Isolation of only symptomatic nodes

Here we consider the case in which only symptomatic nodes are isolated as soon as they develops symptoms,
i.e. no CT is implemented. Thus, in this case f (aS ) = ε(aS ) = 0, ∀aS , while (aI , bI ) = (0, 0) . Replacing these
values either in Eq. (25) or in Eq. (63) we obtain, as expected:


γP
γP
2ra2S aS δ + (1 − δ)
− aS 2
=0
µ
µ
So we obtain an explicit form for the epidemic threshold rC :

12

SY M P T O
NA
rC
= rC

γP
µ

(80)

δ + (1 − δ) γµP

which is the Eq. (4) in the main paper. For instantaneous symptoms development γP /µ → ∞ it reproduces
the results previously obtained in Ref. [5], and for γP /µ = 1 it reproduces the NA case (Eq. (79)).
3.

Homogeneous case without delays and without limited scalability

Here we consider the case in which the population is homogeneous, i.e. ρ(aS , bS ) = δ(aS − a)δ(bS − b), with
constant probability of downloading the app in digital CT, i.e. f (aS ) = f , and constant probability for a contact
to be traced in manual CT, i.e. ε(aS ) = ε. Moreover we assume τC = 0, that is γA = γP . Replacing these
values in the Eq. (25), for the manual CT we obtain a quadratic equation in r:

γP
γP
4a δ εr + 2a δ +
(1 − δ − δε) r −
=0
µ
µ
2 2



2

The equation can be solved and we obtain:

M AN U AL
NA
rC
= rC

δ + (1 − δ − εδ) γµP

2 γµP
q
+ (δ + (1 − δ − εδ) γµP )2 + 4δ 2 ε γµP

(81)

which is the Eq. (5) in the main paper.
Analogously, replacing the values in the Eq. (63) for the digital CT we obtain an equation of second degree
in r:
4a2 δf





γP
γP
γP
δ+
(1 − δ)(1 − f ) r2 + 2a δ +
(1 − δ − δf ) r −
=0
µ
µ
µ

The equation can be solved and we obtain:

AP P
NA
rC
= rC

δ + (1 − δ − f δ) γµP

which is the Eq. (6) in the main paper.
4.

2 γµP
q
+ (δ + (1 − δ − f δ) γµP )2 + 4δf γµP (δ +

γP
µ

(1 − f )(1 − δ))

(82)

Heterogeneous case

Hereafter and in the main text we consider a realistic heterogeneous population, i.e. a power-law activity
distribution:
−(ν+1)

ρ(aS , bS ) ∼ aS

δ(bS − aS )

(83)

with aS ∈ [am , aM ] and η = aM /am , where am and aM are respectively activity lower and upper cut-off.
Supplementary Fig. 2 shows that the considered distribution is maximally broad for ν = 1: indeed, the ratio
a2S /aS 2 , which we plot, provides a estimate of the heterogeneity and fluctuations of the distribution and it is
maximized for ν = 1. On the contrary for ν → 0 the distribution is counterintuitively more homogeneous, due
to cut-off effects and constraints imposed on the distribution (aS and η fixed), which thus set the maximum
heterogeneous condition at ν = 1.
In this heterogeneous case it is possible to derive the epidemic threshold rC only numerically, due to the
complex structure of the equations for the stability (Eq. (25) and Eq. (63)). Fig. 3(a,b) and Fig. 4(a,b)
of the main text show that both manual and digital CT protocols are more effective when the population is
heterogeneous, indeed the maximum gain in the epidemic threshold is for ν ∼ 1 − 1.5. However, the maximum
does not occur exactly at ν = 1, i.e. when the distribution is maximally broad. Indeed, the epidemic thresholds
do not depend solely on activity fluctuations, i.e. a2S , but also on higher order moments (as a3S ), as shown
by Eq. (25) and Eq. (63). Thus, the CT protocols are more effective in heterogeneous populations and the
maximum gain in rC also depends on higher order moments of ρS and on other model parameters, as shown in
Supplementary Fig. 3(b-c).

13
25

20

15

10

5

0
0

1

2

3

4

5

Supplementary Fig. 2: Heterogeneity of the activity distribution. We plot the ratio a2S /aS 2 as a function of
exponent ν, considering ρ(aS , bS ) given by Eq. (83) with aS ∈ [am , aM ], η = aM /am and fixing η = 103 .

II.

Supplementary Method 2: Continuous time Gillespie-like algorithm for network dynamics and epidemic evolution

The network dynamics is performed by a continuous-time Gillespie-like algorithm [6]: we assign to each node
the activity aS and attractiveness bS drawn from the joint distribution ρ(aS , bS ). Initially, the network evolves
in the absorbing state, i.e. all nodes are susceptible and infection does not propagate, up to a relaxation time
t0 , to reach the equilibrium of activation dynamics:
i

1. The first activation time, ti , of each node i is drawn from ΨaiS (ti ) = aiS e−aS ti at time t = 0.
2. The node i with the lowest ti activates and connects m randomly-selected nodes, with probability proportional to their attractiveness bS .
3. The next activation time ti for node i is set to ti + τ , with τ inter-event time drawn from ΨaiS (τ ).
4. All links are destroyed and the process is iterated from point 2.
Then we start the epidemic and contact tracing dynamics as follows:
1. At time t = t0 the population is divided into a configuration of susceptible (S) and infected (P or A) nodes,
moreover each node has an activation time ti > t0 = t obtained from the initial relaxation dynamics.
2. Node i with the lowest ti activates. Asymptomatic (A, T and Q) and symptomatic nodes (I) at time
t recover at ti with probability respectively 1 − e−µ(ti −t) and 1 − e−µI (ti −t) : recovered nodes change
their activity and attractiveness into (aR , bR ) = (aS , bS ). Traced nodes at time t are isolated at ti with
probability 1 − e−(ti −t)/τC (with τC > 0 for manual CT and τC = 0 for digital CT) and set their activity
and attractiveness to zero (aQ , bQ ) = (0, 0).
3. Pre-symptomatic nodes at time t develop symptoms at ti with probability 1 − e−γP (ti −t) : they set to zero
their activity and attractiveness (aI , bI ) = (0, 0) and the contact tracing is activated.
Manual CT: the protocol is enabled for every symptomatic node. Every contact made in the last TCT
period has ε(aS ) probability of being identified and tested, with aS activity of the symptomatic node.
Every node tested and found infected asymptomatic A becomes traced T .
Digital CT: the protocol is enabled only if the symptomatic node has downloaded the app. Each contact
made in the last TCT period with an individual who downloaded the app is identified and tested. Every
node tested and found infected asymptomatic A becomes traced T .
4. We set the actual time t = ti and the active agent i generates exactly m links with m nodes randomlychosen with probability proportional to their attractiveness b at time t (depending on their status and

14
isolation). The contacts are registered in the contact list of both nodes engaged in the connection. If the
link involves a susceptible and an infected node (P , A or T ), a contagion can occur with probability λ
and the susceptible node becomes pre-symptomatic with probability δ or asymptomatic with probability
1 − δ.
5. The new activation time of node i is ti = t + τ and it is obtained drawing the inter-event time τ from the
i
inter-event time distribution Ψai (τ ) = ai e−a τ , where ai is the activity of node i at time t. All the links
are deleted and the process is iterated from point 2.

III.

Supplementary Notes: Robustness of the results

The advantage of the manual CT is robust relaxing many assumptions and changing most parameters in the
modelling scheme.

A.

Activity-attractiveness distribution, limited scalability parameters and delays

Supplementary Fig. 3(a) shows the distribution P (k) of the number of contacts made by an individual over a
TCT period and the distribution P (kT ) of the number of contacts kT traced by an index case with manual CT
in the presence of limited scalability (recall probability as Eq.(2) of the main paper with kc = 130 [7]), for a
realistically heterogeneous population. The average number of contacts traced by an index case is approximately
10 − 60 (depending on ε ∼ 0.1 − 0.5), consistent with the reported data [7, 8]. Analogous contact patterns are
generated by changing kC or other parameters of the activity distribution.
The results on the comparison between manual and digital CT are robust to changes in the maximum number
of traceable contacts kc in the manual CT: an increase in kc reduces the effects of limited scalability; similarly, its
reduction makes the effects of limited scalability stronger. However, modifying kc with realistic values changes
only slightly the epidemic threshold of the manual contact tracing protocol, without changing qualitatively
the results, since the manual protocol remains more effective than the digital one, for small ε = f 2 values
(Supplementary Fig. 3(b)).
The results are also robust when considering changes in the social properties of the population, i.e. assuming
a different functional form of the ρ(aS , bS ) distribution. For example, we can assume that all nodes feature
equal attractiveness b and different activity: ρ(aS , bS ) = ρS (aS )δ(bS − b). In this case the correlations between
activity and attractiveness are removed: however, again the manual CT is more effective than the digital one
in heterogeneous populations and for small ε = f 2 (Supplementary Fig. 3(c)). The differences between the two
methods are reduced, compared to the case with correlations (see the inset of Supplementary Fig. 3(c)), due
to the reduction in heterogeneities, since homogeneous terms are introduced assuming all the nodes having the
same attractiveness. However, differences between the two protocols remain evident, even in the presence of
delays τC > 0 and limited scalability in the manual CT.
Similarly, the advantage of manual contact tracing holds also considering limited scalability and stronger
delays in manual contact tracing τC : even for a delay of 7 days the manual CT remains more effective than the
digital one, for small ε = f 2 and in heterogeneous populations (Supplementary Fig. 3(d)).

B.

Epidemic active phase

The results are also robust when considering the effects of contact tracing on the active phase of the epidemic:
as expected from the analysis on the epidemic threshold, the differences between the two methods are reduced
increasing τC , however even with considerable delays τC the manual CT for small values of ε = f 2 is more
effective in flattening the infection peak and in lowering the epidemic final-size (Supplementary Fig. 4). Indeed,
its effectiveness, compared to the digital CT, is maximized for τC = 0 (Supplementary Fig. 4(a)); the differences
are reduced but still present considering strong delays in manual CT, such as τC = 5 days (Supplementary
Fig. 4(b)). The differences remain even if we consider the system deeply in the active phase, that is for r  rC :
in this case the differences are sightly reduced due to the high infectivity of the system, however again the
manual method for small ε is more effective than digital CT (Supplementary Fig. 4(c)). Finally, as observed for
the epidemic threshold, for very large ε = f 2 = 0.6 and strong delays τC = 5 days, the digital protocol becomes
more effective in reducing the impact of the epidemic, further flattening the infection peak and reducing the
epidemic final-size (Supplementary Fig. 4(d)). This again confirms that the effects of the protocols on the active
phase are similar to those observed on the epidemic threshold, including the differences in the two approaches.

15
b)

a)

3.4
1.3

0.8

3.2

0.7

1.2

3

0.6

1.1

0.5

2.8
1

0.4

1

2

3

2.6
0.3

2.4

0.2

Manual CT - kc=130

0.1

Manual CT - w/o scalability
App-based CT
Manual CT - kc=65

2.2

0
015
15
-3
0
30
-4
5
45
-6
0
60
-7
5
75
-9
0
90
-1
0
10 5
512
0
>1
20

2

Manual CT - kc=260

1

1.5

2

2.5

3

3.5

d)

c)
3.2

2.9

1.3

Manual CT
App-based CT

2.8

1.2

1.2

3

2.7
1.1

1.1

2.6

2.8
1

2.5
2

2.6

1

4

2.4
2

4

2.3
2.4
2.2
2.2

1

2

3

4

5

2.1

1

2

3

4

5

Supplementary Fig. 3: Robustness of the results for the epidemic threshold. In panel (a) we plot the distribution
P (k) of contacts made by an individual over a TCT period and the distribution P (kT ) of contacts traced by an index
case with manual CT in the presence of limited scalability (kC = 130) for fixed ε (see legend) and for ρ(aS , bS ) given by
Eq. (83) with ν = 1. In panels (b)-(d) we plot the ratio between the epidemic threshold rC in the presence of contact
NA
. The ratio is plotted for both manual and
tracing protocols and the epidemic threshold of the non-adaptive case rC
digital contact tracing, as a function of ν. In all the insets we plot the ratio between the epidemic threshold of the
AP P
M AN U AL
, as a function of ν. In panel (b) the
and that of the app-based contact tracing rC
manual contact tracing rC
ratio for the manual CT is plotted for several values of kc and also when scalability is not considered (legend), setting
−(ν+1)
τC = 3 days and ρ(aS , bS ) given by Eq. (83). In panel (c) the ratio is plotted both for ρ(aS , bS ) ∼ aS
δ(bS − aS ) and
−(ν+1)
for ρ(aS , bS ) ∼ aS
δ(bS − b) (legend), setting τC = 3 days and kc = 130. In panel (d) the ratio is plotted for ρ(aS , bS )
given by Eq. (83) setting τC = 7 days and kc = 130. In all panels aS ∈ [am , aM ] with aM /am = 103 , aS = 6.7 days−1 ,
TCT = 14 days, and in panels (b)-(d) ε = f 2 = 0.1, δ = 0.57, τP = 1.5 days, τ = 14 days.

C.

Deterministic household CT

Typically when an individual becomes an index case, developing symptoms, her household is always traced
and isolated, regardless of the CT protocol implemented. To take into account this effect, we augment both CT
protocols with a deterministic contribution: a number of contacts, corresponding to the household, is always
traced, both in digital and in manual CT. The augmented digital tracing is implemented by means of the hybrid
CT formalism, assuming that the index case manually traces at least s contacts (household size) or, if she has
had less, traces them all. The recall probability of this manual part is εh (aS ) defined as in Eq. (2) of the main
∗
paper, with kC = s and
R εh = 1. The probability of tracing a contact within this augmented digital protocol is
2
f + εh (where εh = daS εh (aS )ρS (aS )): thus, to compare its efficacy with the manual CT, we fix the same
probability to trace a contact, that is ε = f 2 + εh . In this way, even for the manual CT at least the tracing of

16
a)

b)

10-3

9

10-3

2

8
7

1.5

6

1

5

0.5

10-3

6

Inf(t) Manual CT
R(t) Manual CT
Inf(t) App-based CT
R(t) App-based CT

1.01

5

1
Manual CT
App-based CT
Manual CT
App-based CT

0.99

4
10-3

0.98

3
4

0

0

0.97
200

100

2

3
Inf(t) Manual CT
R(t) Manual CT
Inf(t) App-based CT
R(t) App-based CT

2
1
0

0

c)

50

100

150

0.5

0

0

200

0

50

4

10

4

Manual CT
App-based CT
Manual CT
App-based CT

0

50

0.99

0.97

0

0.96
150

0

50

100

100

150

150

200

1
Manual CT
App-based CT
Manual CT
App-based CT

1

2

0.98

1

0.98
150

100

10-3

1

2

0

50

Inf(t) Manual CT
R(t) Manual CT
Inf(t) App-based CT
R(t) App-based CT

1.5

3

5

0

100

3
10-3

0.99

10-3

5

Inf(t) Manual CT
R(t) Manual CT
Inf(t) App-based CT
R(t) App-based CT

0.995

0.985

d)

15

Manual CT
App-based CT
Manual CT
App-based CT

1

10-3
20

1

1

0.99
0.98

0.5

1
0

200

0

0

50

0

100

100

0.97
200

150

200

Supplementary Fig. 4: Robustness of the results for the epidemic active phase. In all panels we plot the
temporal evolution of the fraction of infected nodes Inf (t), i.e. infected asymptomatic and infected symptomatic, and
of the fraction of removed nodes R(t), for both manual and digital CT. In the insets we plot the temporal evolution
of the fraction of isolated nodes Iso(t) (right y-axis) and of the average activity of the population ha(t)i (left y-axis),
normalized with aS . All curves are averaged on several realization of disorder and temporal evolution. In panel (a) we
NA
set τC = 0, ε = f 2 = 0.1, r/rC
= 4.0 and the curves for digital and manual CT are averaged respectively over 379 and
NA
445 realizations; in panel (b) we set τC = 5 days, ε = f 2 = 0.1, r/rC
= 3.1 and the curves for digital and manual CT
NA
are averaged respectively over 554 and 604 realizations; in panel (c) we set τC = 5 days, ε = f 2 = 0.1, r/rC
= 7.0 and
the curves for digital and manual CT are averaged respectively over 311 and 348 realizations; in panel (d) we set τC = 5
NA
days, ε = f 2 = 0.6, r/rC
= 4.5 and the curves for digital and manual CT are averaged respectively over 552 and 469
realizations. In all panels ρ(aS , bS ) is given by Eq. (83) with aS ∈ [am , aM ], aM /am = 103 , ν = 1.5, aS = 6.7 days−1 ,
N = 5 103 , δ = 0.57, τP = 1.5 days, τ = 14 days, kc = 130, TCT = 14 days and the errors, evaluated through the
standard deviation, are smaller or comparable with the curves thickness.

the household is necessarily performed.
Supplementary Fig. 5(a)-(c) shows that for low values of ε = f 2 + εh (i.e. small f 2 ) manual CT is more
advantageous than the digital one, even taking into account the deterministic tracing of contacts in the household. The digital protocol becomes more effective only for high app adoption rates and unrealistic long delays:
therefore, our results are robust to the addition of this deterministic household CT contribution.

D.

Correlation between probability of app adoption and individual activity

We considered the probability of downloading the app uniform over the population, since economic and
personal factors can produce opposite forces which correlate and anticorrelate the probability of downloading
the app with the individuals’ activity. Moreover personal data of CT app users are not available, due to privacy

17
a)

b)

5
4.5

Manual CT
App-based CT
w/o CT

1.1
1.05

4

5

0.9

1.15

4.5

0.8

4

0.7
2

1

2

3.5

3.5

3

3

2.5

2.5

2

c)

4

1

2

3

4

2

5

d)

7

1.5

Manual CT
App-based CT
w/o CT

1

2

3

4

5

0.8

1

2.2
2

1

6

4

1.8
0.5

5

0

5

1.6
1.4

4
App-based CT App-based CT App-based CT -

3

Manual CT Manual CT Manual CT -

2

0

0.2

0.4

0.6

C
C
C

C
C

=0 d
=3 d

1.2

=5 d
C

=0 d

1

=3 d
=5 d

0.8

0.8

0

0.2

0.4

0.6

Supplementary Fig. 5: Effects of deterministic household contact tracing and effects of correlations between
app adoption and activity. In panels (a) and (b) we plot, as a function of the exponent ν, the ratio between the
NA
, with limited
epidemic threshold rC for both CT protocols and the epidemic threshold of the non-adaptive case rC
scalability, delay in manual CT and the additional deterministic household CT. In the insets we plot the ratio between
AP P
M AN U AL
, and that of the augmented app-based CT, rC
, as a
the epidemic threshold of the augmented manual CT, rC
function of ν. In panel (a) f 2 = 0.1 and τC = 3 days, while in panel (b) f 2 = 0.6 and τC = 5 days. In panel (c) we plot
NA
the ratio rC /rC
as a function of ε = f 2 + εh for both augmented CT protocols, setting ν = 1.5 and for several values
M AN U AL
AP P
of τC : in the inset we plot the ratio rC
/rC
as a function of τC for several f 2 values. In all panels (a)-(c) we
fix s = 3 (size of household) and ε∗h = 1, corresponding to εh = 0.028. In panel (d) we plot, as a function of f , the
M AN U AL+AP P
M AN U AL
ratio between rC
, the epidemic threshold when the hybrid CT protocol is implemented, and rC
, the
epidemic threshold when only the manual CT is implemented. The curves correspond to the uncorrelated, positively
correlated and negatively correlated f (aS ) (see legend), and are obtained fixing ε = 0.4, τC = 3 days, ν = 1.5. In all
panels the distribution ρ(aS , bS ) is given by Eq. (83), aM /am = 103 , aS = 6.7 days−1 , δ = 0.57, τP = 1.5 days, τ = 14
days, kc = 130, TCT = 14 days.

issues. However, evidences are currently emerging that those who download the app are individuals who engage
very cautious behaviors, i.e. f and aS are anticorrelated [9, 10].
We implement the hybrid CT protocolRon a heterogeneous population, investigating the effectiveness of digital
CT varying the app adoption level f = daS f (aS )ρS (aS ) and the correlations between f and aS . We consider
three extreme cases of correlations: the uncorrelated case in which f (aS ) = f = f ∀aS ; the completely positively
correlated case f (aS ) = θ(aS − ap0 ), with θ(x) the Heaviside step function; the completely negatively correlated
case f (aS ) = θ(an0 − aS ). These borderline cases are hardly realistic, however they allow to obtain useful
information on the role of correlations: more realistic shapes of f (aS ) are interesting directions for future work.
To compare these three cases, we set the thresholds an0 and ap0 by fixing f : Supplementary Fig. 5(d) shows
that correlations have a strong impact on the effectiveness of digital CT. If the app is downloaded from all hubs

18
(positive correlations) a low level of adoption f ∼ 0 is enough to obtain a significant increase in the epidemic
threshold; on the contrary, if the app is downloaded only by very cautious people (negative correlations) the
effect of the digital CT becomes significant only for very high adoption level f ∼ 1, worse than the uncorrelated
case.
The effects of correlations in app adoption further strengthens our results, highlighting the dominant role of
manual CT in the current situation of negative correlations [9, 10]. Furthermore these results suggest future
directions to make digital CT more effective exploiting heterogeneities.

Supplementary References
[1] Mancastroppa, M., Vezzani, A., Muñoz, M. A. & Burioni, R. Burstiness in activity-driven networks and the epidemic
threshold. J. Stat. Mech.: Theory Exp 2019, 053502 (2019).
[2] Tizzani, M. et al. Epidemic spreading and aging in temporal networks with memory. Phys. Rev. E 98, 062315
(2018).
[3] Pozzana, I., Sun, K. & Perra, N. Epidemic spreading on activity-driven networks with attractiveness. Phys. Rev. E
96, 042310 (2017).
[4] Ghoshal, G. & Holme, P. Attractiveness and activity in internet communities. Physica A 364, 603 – 609 (2006).
[5] Mancastroppa, M., Burioni, R., Colizza, V. & Vezzani, A. Active and inactive quarantine in epidemic spreading on
adaptive activity-driven networks. Phys. Rev. E 102, 020301 (2020).
[6] Gillespie, D. T. A general method for numerically simulating the stochastic time evolution of coupled chemical
reactions. J. Comput. Phys. 22, 403 – 434 (1976).
[7] Keeling, M. J., Hollingsworth, T. D. & Read, J. M. Efficacy of contact tracing for the containment of the 2019 novel
coronavirus (covid-19). J. Epidemiology Community Health 74, 861–866 (2020).
[8] Visontay, E. Victoria’s contact-tracing effort buckles under the weight of covid-19 cases. The Guardian (2020).
08-04-2020.
[9] von Wyl, V. et al. Drivers of acceptance of covid-19 proximity tracing apps in Switzerland: panel survey analysis.
JMIR Public Health Surveill. 7, e25701 (2021).
[10] Saw, Y. E., Tan, E. Y., Liu, J. S. & Liu, J. C. Predicting public uptake of digital contact tracing during the covid-19
pandemic: results from a nationwide survey in Singapore. J. Med. Internet Res. 23, e24730 (2021).

