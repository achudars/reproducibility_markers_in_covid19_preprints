SEMIPARAMETRIC BAYESIAN INFERENCE FOR THE
TRANSMISSION DYNAMICS OF COVID-19 WITH A
STATE-SPACE MODEL

TIANJIAN ZHOU1 AND YUAN JI2

arXiv:2006.05581v2 [stat.ME] 2 Jul 2020

Department of Public Health Sciences, University of Chicago
Abstract. The outbreak of Coronavirus Disease 2019 (COVID-19) is an ongoing
pandemic affecting over 200 countries and regions. Inference about the transmission dynamics of COVID-19 can provide important insights into the speed of disease
spread and the effects of mitigation policies. We develop a novel Bayesian approach
to such inference based on a probabilistic compartmental model using data of daily
confirmed COVID-19 cases. In particular, we consider a probabilistic extension
of the classical susceptible-infectious-recovered model, which takes into account
undocumented infections and allows the epidemiological parameters to vary over
time. We estimate the disease transmission rate via a Gaussian process prior, which
captures nonlinear changes over time without the need of specific parametric assumptions. We utilize a parallel-tempering Markov chain Monte Carlo algorithm
to efficiently sample from the highly correlated posterior space. Predictions for
future observations are done by sampling from their posterior predictive distributions. Performance of the proposed approach is assessed using simulated datasets.
Finally, our approach is applied to COVID-19 data from six states of the United
States: Washington, New York, California, Florida, Texas, and Illinois. An R package BaySIR is made available at https://github.com/tianjianzhou/BaySIR for
the public to conduct independent analysis or reproduce the results in this paper.

1. Introduction
The outbreak of Coronavirus Disease 2019 (COVID-19), caused by Severe Acute
Respiratory Syndrome Coronavirus 2 (SARSCoV2), was declared a pandemic on
March 11, 2020 by the World Health Organization. As of July 2, 2020, the number of
confirmed COVID-19 cases worldwide has exceeded 10.6 million, and the death toll
has surpassed 516,000. In order to control the spread of the virus, countries around
the world have implemented unprecedented non-pharmaceutical interventions, such
as case isolation, closure of schools, stay-at-home orders, banning of mass gatherings,
and local and national lockdowns. At the same time, social distancing and mask
wearing by the public also contribute to the containment of COVID-19.
E-mail address: 1 tjzhou@uchicago.edu, 2 yji@health.bsd.uchicago.edu.
Key words and phrases. Effective reproduction number; Forecasting; Gaussian process; Infectious
disease; Parallel tempering; SIR model.
1

2

T. ZHOU AND Y. JI

Researchers have made substantial efforts to study the transmission dynamics of
COVID-19, evaluate the effects of government interventions, and forecast infection
and death counts. These works include Aguilar et al. (2020); Chen and Qiu (2020);
Flaxman et al. (2020); Giordano et al. (2020); Gomez et al. (2020); Gu et al. (2020);
IHME COVID-19 health service utilization forecasting team and Murray (2020); Li
et al. (2020a,b); Pan et al. (2020); Sun et al. (2020); Wang et al. (2020a,b); Woody
et al. (2020); Wu et al. (2020); Zhang et al. (2020), among many others. The modeling approaches taken by these works can be broadly categorized into three groups: (i)
curve fitting, (ii) compartmental modeling, and (iii) agent-based modeling. Curve fitting approaches fit a curve to the observed number of confirmed cases or deaths. For
example, IHME COVID-19 health service utilization forecasting team and Murray
(2020) use a Gaussian error function to model the cumulative death rate at a specific location. Compartmental modeling approaches (e.g., Li et al., 2020b) consider
a partition of the population into compartments corresponding to different stages of
the disease, and characterize the transmission dynamics of the disease by the flow of
individuals through compartments. Finally, agent-based modeling approaches (e.g.,
Gomez et al., 2020) use computer simulations to study the dynamic interactions
among the agents (e.g., people in epidemiology) and between an agent and the environment.
In this paper, we develop a novel semiparametric Bayesian approach to modeling
the transmission dynamics of COVID-19, which is critical for characterizing disease
spread. We aim to address a few issues related to the COVID-19 pandemic. First, we
provide estimation of key epidemiological parameters, such as the effective reproduction number of COVID-19. The Bayesian framework allows us to elicit informative
priors for parameters that are difficult to estimate due to lack of data based on clinical characteristics of COVID-19, and also offers coherent uncertainty quantification
for the parameter estimates. Our second goal is to make predictions about the future
trends of the spread of COVID-19 (e.g., future case counts), which will be done by calculating the posterior predictive distributions for the future observations. Although
such predictions are technically straightforward, we avoid overinterpretation of the
predictions because they rely on extrapolation of highly unpredictable human behaviors and the number of diagnostic tests that will be deployed. Nevertheless, such
predictions may be useful for the public and decision makers to understand the trends
and future impacts of COVID-19 based on current rates of transmission. We shall

BAYESIAN INFERENCE FOR THE TRANSMISSION DYNAMICS OF COVID-19

3

see this in our case studies later. Our analysis will be based on a probabilistic compartmental model motivated by the classical susceptible-infectious-recovered model
(Kermack and McKendrick, 1927). We will use data of daily confirmed COVID-19
cases reported by the Center for Systems Science and Engineering at Johns Hopkins
University (JHU CSSE) (Dong et al., 2020). We provide an R package BaySIR, available at https://github.com/tianjianzhou/BaySIR, that can be used to conduct
independent analysis of COVID-19 data or reproduce the results in this paper.
The proposed Bayesian approach attempts to improve COVID-19 modeling in at
least four aspects. First, we explicitly model the number of undocumented infections,
which is only considered by some, but not all, existing works. Due to the potentially
limited testing capacity and the existence of pre-symptomatic and asymptomatic
COVID-19 cases (Rothe et al., 2020; He et al., 2020), many infected individuals may
not have been detected as having the disease. Therefore, modeling of undocumented
infections is essential for accurate inference. Second, we estimate the disease transmission rate via Gaussian process regression (GPR), a semiparametric regression method.
The GPR approach is highly flexible and captures nonlinear and non-monotonic relationships without the need of specific parametric assumptions. Third, we develop
a parallel-tempering Markov chain Monte Carlo (PTMCMC) algorithm to efficiently
sample from the posterior distribution of the epidemiological parameters, which leads
to improvements in convergence and mixing compared to a standard MCMC procedure. We find that standard MCMC cannot produce reliable inference due to poor
mixing. Lastly, we rigorously assess our approach through simulation studies, sensitivity analyses, cross-validation and goodness-of-fit tests. Such validations provide
insights into the modeling of COVID-19 data, not only for our approach, but also for
others based on similar assumptions such as the popular compartmental modeling
approaches.
The remainder of the paper is organized as follows. In Section 2, we provide a
brief review of the susceptible-infectious-recovered (SIR) compartmental model. In
Section 3, we develop a probabilistic state-space model for COVID-19 motivated by
the classical SIR model. In Section 4, we present strategies for posterior inference. In
Section 5, we carry out simulation studies to assess the performance of our method
in estimating the epidemiological parameters. In Section 6, we apply our method to
COVID-19 data from six states of the United States (U.S.): Washington, New York,
California, Florida, Texas, and Illinois. We conclude with a discussion in Section 7.

4

T. ZHOU AND Y. JI

2. Review of the Susceptible-Infectious-Recovered Model
We start with a review of the susceptible-infectious-recovered (SIR) model (Kermack and McKendrick, 1927; Weiss, 2013), a simple type of compartmental model.
The purpose of this review is to introduce the reader to the basics of epidemic modeling and motivate our proposed approach.
Consider a closed population of size N . Here, “closed” means that N does not
vary over time. It is a good approximation for a fast-spreading and less fatal pandemic like COVID-19. The SIR model divides the population into the following three
compartments:
(S) Susceptible individuals: those who do not have the disease but may be infected;
(I) Infectious individuals: those who have the disease and are able to infect the
susceptible individuals;
(R) Recovered/removed individuals: those who had the disease but are then removed
from the possibility of being infected again or spreading the disease. Here, the
removal can be due to several possible reasons, including death, recovery with
immunity against reinfection, and quarantine and isolation from the rest of the
population.
At time t (t ≥ 0), denote by St , It and Rt the numbers of individuals in the S, I and
R compartments, respectively, and write Vt = (St , It , Rt ). We have St + It + Rt ≡ N .
2.1. Deterministic SIR Models. The classical SIR model (Kermack and McKendrick, 1927) describes the flow of people from S to I to R via the following system
of differential equations:
(1)

β
dSt
= − St It ,
dt
N

dIt
β
= St It − αIt ,
dt
N

dRt
= αIt .
dt

Here, β is the disease transmission rate, and α is the removal rate. The rationale
behind the first equation in (1) is as follows: suppose each infectious individual makes
effective contacts (sufficient for disease transmission) with β others per unit time;
therefore, βS/N of these contacts are with susceptible individuals per unit time, and
as a result, I infectious individuals lead to a rate of new infections (βS/N ) · I. The
third equation in (1) describes that the infectious individuals leave the infective class
at a rate of αI. The second equation in (1) follows immediately from the first and
third equations. The parameters β and α are determined according to the natural
history of the disease. The quantities R0 = β/α and Re = (βS0 )/(αN ) are referred

BAYESIAN INFERENCE FOR THE TRANSMISSION DYNAMICS OF COVID-19

5

to as the basic reproduction number and effective reproduction number, respectively,
where S0 is the initial number of susceptibles at time t = 0.
In some applications, it may be convenient to consider a discrete-time approximation of the differential equations in Equation (1), which can be expressed as follows:
St = St−1 − βSt−1 It−1 /N,
It = (1 − α)It−1 + βSt−1 It−1 /N,

(2)

Rt = Rt−1 + αIt−1 ,
for t = 1, 2, . . .. This discretization replaces the derivatives in Equation (1) by the
differences per unit time.
The SIR models given by Equation (1) and (2) are both deterministic models,
meaning that their behaviors are completely determined by their initial conditions
and parameter values.
2.2. Stochastic SIR Models. The deterministic SIR models are appealing due to
their simplicity. However, the spread of disease is naturally stochastic. The disease
transmission between two individuals is random rather than deterministic. Therefore,
a stochastic formulation of the SIR model may be preferred for epidemic modeling,
because it allows one to more readily capture the randomness of the epidemic process.
In a stochastic SIR model, {Vt : t ≥ 0} is treated as a stochastic process. A
commonly used formulation is as follows (Gibson and Renshaw, 1998; ONeill and
Roberts, 1999; Andersson and Britton, 2000). Suppose that an infectious individual
makes effective contacts with any given individual in the population at times given
by a Poisson process of rate β/N , and assume all these Poisson processes are independent of each other. Therefore, the expected number of effective contacts made
by each infectious individual is β per unit time. Furthermore, suppose each infectious individual remains so (before being removed) for a period of time, known as
the infectious period. Lastly, assume that the length of the infectious period for each
individual is independent and follows an exponential distribution with mean α−1 . It
can be shown that {Vt : t ≥ 0} is a Markov process with transition probabilities:
Infection:

Pr[Vt+δ = (s − 1, i + 1, r) | Vt = (s, i, r)] = βsiδ/N + o(δ),

Removal:

Pr[Vt+δ = (s, i − 1, r + 1) | Vt = (s, i, r)] = αiδ + o(δ).

(3)

Here, δ is a small increment in time.

6

T. ZHOU AND Y. JI

2.3. State-space SIR Models. There are, of course, other ways to model the uncertainty of the epidemic process. Probabilistic state-space modeling approaches that
build on deterministic models have recently been popular in the statistics literature
(Dukic et al., 2012; Osthus et al., 2017, 2019). A state-space SIR model typically
consists of two components: an evolution model for the epidemic process, and an
observation model for the data. As an example, the model in Osthus et al. (2017)
has the form

Evolution: Vt ∼ p[Vt | f (Vt−1 , β, α), κ],
Observation: I˜t ∼ p(I˜t | It , λ),

for t = 1, 2, . . .. In the evolution model, f (Vt−1 , β, α) is the solution to Equation (1)
at time t with a initial value of Vt−1 at time (t − 1) and parameters β and α, and Vt is
assumed to be centered at f (·) with its variance characterized by κ. In other words,
κ measures the derivation of Vt from the solution given by the deterministic model.
In the observation model, I˜t is the number of patients seen with the disease reported
by healthcare providers, which can be thought of as a proxy to the true number
of infectious individuals It . The observation I˜t is assumed to be centered at It with
variance characterized by λ. State-space epidemic models are quite flexible and are in
general more computationally manageable compared to stochastic epidemic models
as in Equation (3).
The SIR model can be extended in many different ways, such as by considering
vital dynamics (births and deaths) and demographics, adding more compartments to
the model, and allowing more possible transitions across compartments. For example, the susceptible-exposed-infectious-recovered (SEIR) model includes an additional
compartment for exposed individuals who are exposed to the disease but are not yet
infectious, and the susceptible-infectious-recovered-infectious (SIRS) model allows
recovered individuals to return to a susceptible state. These extensions may better
capture the characteristics of the disease under consideration. For a comprehensive
review of deterministic epidemic models, see, for example, Anderson and May (1991),
Hethcote (2000) or Brauer (2008). For a comprehensive review of stochastic epidemic
models, see, for example, Becker and Britton (1999), Andersson and Britton (2000)
or Allen (2008).

BAYESIAN INFERENCE FOR THE TRANSMISSION DYNAMICS OF COVID-19

7

3. Proposed Model for COVID-19
We now turn to our proposed model for the COVID-19 data, which belongs to the
state-space model category (Section 2.3). Our approach integrates the discrete-time
deterministic SIR model (Equation 2) and semiparametric Bayesian inference. To
capture some unique features of COVID-19, we consider the following extensions of
the classical SIR model. First, we split the infectious individuals into two subgroups:
undocumented infectious individuals and documented infectious individuals. The
reason is that many people infected with SARS-CoV-2 have not been tested for the
virus thus are not detected or reported as having the infection (Li et al., 2020b).
Second, we allow some epidemiological parameters (such as the disease transmission
rate β) to be time-varying to reflect the impact of mitigation policies such as stay-athome orders and the change of public awareness of the disease over time. We discuss
details next.

3.1. Model for the Epidemic Process. Consider the transmission dynamics of
COVID-19 in a specific country or region (e.g., a state, province or county). For
simplicity, we consider a closed population (with no immigration and emigration)
and also ignore nature births and deaths. Let N denote the population size. At any
time point, we assume that each individual in the population precisely belongs to one
of the following four compartments:
(S) Susceptible individuals who do not have the disease but are susceptible to it;
(UI) Undocumented infectious individuals who have the disease and may infect the
susceptible individuals. However, they have not been detected as having the disease for several possible reasons. For example, they may have limited symptoms
and are thus not tested for the disease;
(DI) Documented infectious individuals who have been confirmed as having the disease and are capable of infecting the susceptible individuals;
(R) Removed individuals who had the disease but are then removed from the possibility of being infected again or spreading the disease.
We further assume that the infectious individuals (including both the UI- and DIindividuals) infect the S-individuals with a transmission rate of β. After being infected, a S-individual first becomes an UI-individual before being detected as a DIindividual. All the infectious (UI- and DI-) individuals recover or die with a removal
rate of α. Those UI-individuals who have not been removed are diagnosed with the

8

T. ZHOU AND Y. JI

disease with a diagnosis rate of γ. In total, there are four possible transitions across
compartments: S to UI, UI to R, UI to DI, and DI to R. See Figure 1. Note that it is
possible to assume different transmission rates for the UI- and DI-individuals, or to
further split the UI and DI compartments into smaller subgroups (e.g., quarantined,
hospitalized, etc.) with each subgroup having its distinct transmission rate. It is also
possible to consider an extra compartment for the exposed (but not yet infectious) individuals as in the SEIR model. Here, we use a more parsimonious model without the
exposed compartment for simplicity and characterize the average transmission rate
for all infectious individuals with a single parameter β (β depends on time, which
will be clear later). Finally, we assume recovery from COVID-19 confers immunity to
reinfection, although there is only limited evidence for this assumption (Long et al.,
2020; Kirkcaldy et al., 2020).

𝛼𝐼 #
Susceptible 𝑆

Undocumented
Infectious 𝐼 #

𝛽𝑆 𝐼 # + 𝐼 $ /𝑁

Documented
Infectious 𝐼 $

𝛾 1 − 𝛼 𝐼#

Removed 𝑅
𝛼𝐼 $

Figure 1. Compartmental model for COVID-19. We consider four
compartments and four possible transitions across compartments. The
number under each arrow indicates the transition rate between two
compartments.

We define day t = 0 as the date when the 100th case is confirmed in the country/region under consideration, and index subsequent dates by t = 1, 2, . . . , T , where
T is the current date. The reason for choosing day 0 in this way is because we believe
the transmission dynamics of the disease is more trackable after a sufficient number
of infectious individuals are reported in the country/region, although the choice of
“the 100th case” is arbitrary and can be modified. Denote by St , ItU , ItD and Rt the
numbers of individuals belonging to compartments S, UI, DI and R on day t, respectively. We have St + ItU + ItD + Rt ≡ N . The transmission rate and diagnosis rate
are allowed to vary over time and are hereafter denoted by βt and γt , respectively.
The number of individuals diagnosed with the disease between day (t − 1) and day
t is observed and is denoted by Bt−1 . This is our data. We propose modeling the

BAYESIAN INFERENCE FOR THE TRANSMISSION DYNAMICS OF COVID-19

9

transmission dynamics of COVID-19 over time by the following equations:
U
D
St = St−1 − βt−1 St−1 (It−1
+ It−1
)/N,

(4)

U
U
D
ItU = (1 − α)It−1
+ βt−1 St−1 (It−1
+ It−1
)/N − Bt−1 ,
D
ItD = (1 − α)It−1
+ Bt−1 ,
U
D
Rt = Rt−1 + α(It−1
+ It−1
),

for t = 1, . . . , T . Denote by Vt = (St , ItU , ItD , Rt ). The epidemic process, {Vt , t =
0, 1, . . . , T }, is determined by its initial value V0 , the parameters {βt , α}, and the observations {Bt }. Rigorously speaking, Vt should be a vector of non-negative integers,
but for computational convenience, we relax this restriction and only require it to
be a vector of non-negative real numbers. Model (4) is a simple extension of (2) by
adding a component of I U , the undocumented infections, and by incorporating the
observed daily new cases Bt−1 into the equations. Later, we introduce a model for
the observation Bt−1 to complete the state-space model.
With time-varying disease transmission rates, the basic reproduction number and
effective reproduction number are also functions of time. That is, R0 (t) = βt /α and
Re (t) = (βt St )/(αN ).
Here, Re (t) is interpreted as the rate of secondary infections generated by each infectious case at time t, scaled by the length of the infectious period (α−1 ). If Re (t) < 1
for t ≥ t∗ , then the number of infectious individuals (ItU + ItD ) will monotonically
decrease after time t∗ , because each infectious individual will only be able to infect
less than 1 other during the course of his/her infectious period. In other words, an
Re (t) < 1 indicates containment of the disease. Due to the important role of Re (t)
in characterizing disease spread, we consider the estimation of Re (t) as our main
interest.
3.2. Model for the Observed Data. Our observations only consist of the daily
new confirmed COVID-19 cases, Bt . Assume that on day t, the UI-individuals who
have not been removed are diagnosed with the disease with a diagnosis rate of γt .
Mathematically, this means Bt = γt (1 − α)ItU , where γt is between 0 and 1. We
consider the logit transformation of γt , γ̃t = logit(γt ) , log[γt /(1 − γt )]. Other
transformations, such as the probit and complementary log-log transformations, can
also be specified in the BaySIR package. Empirically we find the proposed model

10

T. ZHOU AND Y. JI

to be robust to different specifications of the link function (See Appendix C). We
assume a prior transformation,
(5)

γ̃t ∼ N(yt> η, σγ2 ),

where yt is a vector of covariates that are thought to be related to the diagnosis rate.
In other words, the sampling model for Bt can be written as


Bt
logit
(6)
| ItU , α ∼ N(yt> η, σγ2 ).
(1 − α)ItU
In the simulation studies and real data analyses, we use a simple choice of yt =
1, assuming the mean diagnosis rate is a constant. It is possible to include other
covariates in yt , such as the number of tests, but empirically we find it hard to detect
the effects of these covariates. In the BaySIR package, the user has the option to
include any covariates. The parameters η and σγ2 are the regression coefficients and
variance term, respectively, where σγ2 captures random fluctuations of confirmed case
counts and report errors.
For some countries and regions, the numbers of recoveries and deaths are also
available, and one may think of using them as the observed number of removed
individuals. We choose not to use these data for two reasons. First, many infected
individuals, even with confirmed disease, are not hospitalized, and their recoveries
are not recorded. In other words, the reported number of recoveries and deaths is a
significant underestimate of the size of the removed population. Second, according to
Wölfel et al. (2020) and He et al. (2020), the ability of a COVID-19 patient to infect
others becomes negligible several days before the patient recovers or dies, suggesting
that “removal” in our application is not equivalent to “recovery or death”.
3.3. Prior Specification. In what follows, we discuss prior specification for the initial condition and parameters. Due to the limited amount of observable information,
many latent variables and parameters in the proposed model are unidentifiable. See
Appendix A for a detailed discussion with an example showing that two epidemic
processes with distinct parameters lead to exactly the same observed data. We note
that this problem is pervasive in most existing methods, and a typical solution to the
problem is to prespecify some parameter values based on prior knowledge. Here, we
elicit informative priors for some parameters based on the clinical characteristics of
COVID-19, which favor more clinically plausible estimates.

BAYESIAN INFERENCE FOR THE TRANSMISSION DYNAMICS OF COVID-19

11

Initial condition. The initial condition of the epidemic process refers to the vector
V0 = (S0 , I0U , I0D , R0 ). We assume that there are no removed individuals on day 0,
i.e., R0 = 0. As a result, the number of DI-individuals on day 0, I0D , equals to
the cumulative number of confirmed cases on that day and is observed. We further
assume
I0U /I0D ∼ Ga(ν1 , ν2 ),
where Ga(ν1 , ν2 ) refers to a gamma distribution with shape and rate parameters
ν1 and ν2 , respectively. We set ν1 = 5 and ν2 = 1, such that E(I0U /I0D ) = 5.
This choice is based on the findings in Li et al. (2020b) that 86% of all infections
were undocumented at the beginning of the epidemic in China. Lastly, note that
S0 = N − I0U − I0D − R0 .
Transmission rate. The disease transmission rate βt must be non-negative. We consider β̃(t) = log(βt ) and assume
β̃(t) ∼ GP[m(t), C(t, t0 )],
where GP[m(t), C(t, t0 )] refers to a Gaussian process (GP) with mean function m(t)
and covariance function C(t, t0 ). The GP (Rasmussen and Williams, 2006) is a very
flexible prior model for a stochastic process. It enables one to capture potential nonlinear relationships between t and β̃(t) without the need to impose any parametric
assumptions. Specifically, for any t1 , . . . , tn ≥ 0, the vector (β̃(t1 ), . . . , β̃(tn ))> follows
a multivariate Gaussian distribution with mean (m(t1 ), . . . , m(tn ))> and covariance
matrix C with the (i, j)-th entry being C(ti , tj ). For applications of GP to epidemic
modeling, see, for example, Xu et al. (2016) and Kypraios and ONeill (2018).
We specify m(t) and C(t, t0 ) as below:
(7)

m(t) = x>
t µ,

0

C(t, t0 ) = σβ2 ρ|t−t | .

Here, xt is a vector of covariates that are thought to be related to the transmission
rate, and µ is a vector of regression coefficients. In the simulation studies and real
data analyses, we use xt = (1, t)> , which contains an intercept term and the time.
Other covariates, such as indicators for mitigation policies at time t, may also be
included in xt . Nevertheless, in practice, we find our GP model with a time trend is
sufficient to capture the change of β̃(t) over time and the potential effects of mitigation
policies and public awareness. Users of our software may include other covariates
using the R package BaySIR. The variance parameter σβ2 characterizes the amplitude

12

T. ZHOU AND Y. JI

of the difference between β̃(t) and m(t), and the correlation parameter ρ characterizes
the correlation between β̃(t) and β̃(t0 ) for any t and t0 . We note that based on our
specification of the covariance function, our GP model is equivalent to a first-order
autoregressive model. Indeed, autoregressive models of any orders are discrete-time
equivalents of GP models with Matérn covariance functions (Roberts et al., 2013).
We place the following priors on µ, σβ and ρ:
µ ∼ N(µ∗ , Σµ ),

σβ2 ∼ Inv-Ga(11, 1),

ρ ∼ Beta(4, 1),

such that E(σβ2 ) = 0.1 and E(ρ) = 0.8. Here, Inv-Ga(·, ·) refers to an inverse gamma
distribution, and Beta(·, ·) refers to a beta distribution. The prior choices for σβ2
and ρ shrink β̃(t) toward its mean function (i.e., a linear regression model) and
impose a strong prior correlation between the transmission rates for two consecutive
days. For the prior of µ, we use µ∗ = (−1.31, 0)> and Σµ = diag(0.32 , 12 ), where
diag(·) represents a diagonal matrix. In this way, the prior median of the basic
reproduction number on day 0 is 2.5 (with 95% credible interval 1.4 to 4.5), assuming
the infectious period is 9.3 days. This is based on the findings in Li et al. (2020a)
and Wu et al. (2020). The prior also induces a mild shrinkage (towards 0) for the
regression coefficient of the time trend.
Removal rate. The removal rate is between 0 and 1. The inverse of the removal rate,
α−1 , corresponds to the average time to removal after infection. We assume
α−1 ∼ Ga(ν1α , ν2α ) · 1(α−1 ≥ 1).
We take ν1α = 325.5 and ν1α = 35, such that E(α−1 ) = 9.3 with prior 95% credible
interval between 8.3 and 10.3 days. The mean infectious period of 9.3 days is chosen
based on the findings in He et al. (2020), who estimated that the infectiousness of
COVID-19 starts from around 2.3 days before symptom onset and declines quickly
within 7 days after symptom onset.
Diagnosis rate. We place the following standard weakly informative priors on η and
σγ2 , the regression coefficients and variance term in the diagnosis rate model (Equation
5):
η ∼ N(η ∗ , Ση ),

σγ2 ∼ Inv-Ga(1, 1).

When yt only has an intercept term, we use η ∼ N(0, 12 ).

BAYESIAN INFERENCE FOR THE TRANSMISSION DYNAMICS OF COVID-19

13

4. Inference
4.1. Posterior Sampling. Let θ = {I0U , β, α, µ, σβ , ρ, η, σγ2 } denote all model parameters and hyperparameters, where β = (β0 , β1 , . . . , βT ), and let B = (B0 , B1 , . . . , BT )
be the vector of daily increments in confirmed cases. The joint posterior distribution
of θ is given by
"
π(θ | B, I0D ) ∝

T
Y

#
φ(γ̃t | yt> η, σγ2 ) · π ∗ (θ)

t=0

where φ(· | µ, σ 2 ) denotes the density function of a normal distribution with mean µ
and standard deviation σ 2 , and π ∗ (θ) represents the prior density of θ. Recall that

γ̃t = logit Bt /[(1 − α)ItU ] .
We use a Markov chain Monte Carlo (MCMC) algorithm (see, e.g., Liu, 2008), in
particular the Gibbs sampler, to simulate from the posterior distribution and implement posterior inference. Metropolis-Hastings steps are used when the conditional
posterior distribution of a parameter is not available in closed form. The regular
Gibbs sampler is not very efficient in our application because of the strong correlations among the model parameters. This issue was also noted by Osthus et al. (2017).
We therefore use parallel tempering (PT) to improve the convergence and mixing of
the Markov chains (Geyer, 1991). Consider J parallel Markov chains with a target
distribution of
"
πj (θj |

B, I0D )

∝

T
Y

#1/∆j
φ(γ̃t,j |

2
yt> ηj , σγ,j
)

· π ∗ (θj )

t=0

for the j-th chain, where ∆j is the temperature. The temperatures {∆1 , ∆2 , . . . , ∆J }
are decreasing with ∆J = 1. Thus the target distribution of the J-th chain is the
original posterior π(θ | B, I0D ). At each MCMC iteration, we first independently
update all J chains based on Gibbs transition probabilities. Then, for j = 1, 2, . . . , J−
1, we propose a swap between θj and θj+1 and accept the proposal with probability
# ∆1 − ∆ 1
"T
2
Y φ(γ̃t,j+1 | yt> ηj+1 , σγ,j+1
) j j+1
pswap (θj , θj+1 ) = 1 ∧
.
2
φ(γ̃t,j | yt> ηj , σγ,j
)
t=0
The draws from the J-th chain are kept. A chain with a higher temperature can
more freely explore the posterior space, and the swap proposal allows interchange of
states between adjacent chains. Therefore, the PT scheme helps the Markov chain
avoid getting stuck at local optima. In Appendix B, we demonstrate the advantage
of the PT scheme with an example.

14

T. ZHOU AND Y. JI

In the simulation studies and real data analyses, we run J = 10 parallel Markov
chains with a temperature of ∆j = 1.510−j for the j-th chain. We run MCMC
simulation for 50,000 iterations, discard the first 20,000 draws as initial burn-in, and
keep one sample every 30 iterations. This leaves us a total of 1,000 posterior samples.
4.2. Predictive Inference. In addition to the estimation of epidemiological parameters, one may be interested in the prediction of a future observation, which can be
achieved by sampling from its posterior predictive distribution. As an example, let
B ∗ = (BT +1 , . . . , BT +T ∗ ) denote the vector of daily confirmed cases for future days
t = T + 1, . . . , T + T ∗ . The posterior predictive distribution of B ∗ is given by
Z
∗
D
(8)
π(B | B, I0 ) = π(B ∗ | θ, B, I0D ) · π(θ | B, I0D ) dθ.
Sampling from (8) involves computing π(β̃ ∗ | B, I0D ) =

R

π(β̃ ∗ | β̃) · π(β̃ | B, I0D ) dβ̃

for β̃ ∗ = (β̃T +1 , . . . , β̃T +T ∗ ). We have
h
i
∗
∗
∗ −1
∗∗
∗ −1 ∗
β̃ | β̃ ∼ N X µ + C C (β̃ − Xµ), C − C C C ,
where X = (x0 , . . . , xT )> , X∗ = (xT +1 , . . . , xT +T ∗ )> , C∗ is a T ∗ ×(T +1) matrix with
the (i, j)-th entry being C(T + i, j − 1), and C∗∗ is a T ∗ × T ∗ matrix with the (i, j)-th
entry being C(T + i, T + j). This is based on a GP prediction rule (Rasmussen and
Williams, 2006).
5. Simulation Studies
We assess the performance of the proposed method in estimating the epidemiological parameters by applying it to simulated epidemic time series. Consider a closed
population of size N = 20, 000, 000. We assume the initial condition on day 0 is
I0D = 100, I0U = 800, R0 = 0, and S0 = N − I0D − I0U . We set the removal rate
α = 9.3−1 . For the transmission rate, we consider the following three scenarios:
(Scn. 1) βt = b · α/[(t + 1)c − a], where a, b and c are chosen such that R0 (0) = 3,
R0 (14) = 2 and R0 (49) = 1;
(Scn. 2) βt = α · exp [a · sin(0.2t) − bt + c], where a, b and c are chosen such that
R0 (0) = 2.5, R0 (14) = 2.2 and R0 (49) = 1;


(Scn. 3) βt = α · exp log(2.5) − 0.4 · b(t/20)c , where bac represents the largest
integer that is smaller than a.
Recall that R0 (t) = βt /α. In all the scenarios, R0 (t) → 0+ as t → ∞. For scenario 2,
R0 (t) is non-monotonic, and for scenario 3, R0 (t) is discontinuous. Next, we generate

BAYESIAN INFERENCE FOR THE TRANSMISSION DYNAMICS OF COVID-19

15

γ̃t ∼ N [logit(0.2), 0.252 ] and γt = 1 − exp(− exp(γ̃t )). Finally, for each scenario, we
generate a hypothetical epidemic process for 80 days according to Equation (4) with
Bt = γt (1 − α)ItU . We keep B = (B0 , . . . , BT ) and I0D as our observations (T = 79).
The simulated datasets, shown in Figure 2 (upper panel), are similar to a real COVID19 dataset (e.g., Figure 4).
We fit the proposed model to the simulated datasets using the PTMCMC algorithm. Figure 2 (lower panel) shows a comparison of the estimated time-varying
effective reproduction numbers with the simulation truth. The simulation truth is
nicely recovered, and the 95% credible intervals of Re (t)’s always cover the true

3000

2000

1000

0

0

10

20

30

40

50

60

Daily Confirmed Cases

Daily Confirmed Cases

Daily Confirmed Cases

values.

6000
4000
2000
0

70

0

10

20

30

Day

60

2500
0

70

0

10

20

30

40

50

60

70

Day

4

3
2
1
0

10

20

30

40

50

60

70

4

Eff. Reprod. No.

Eff. Reprod. No.

Eff. Reprod. No.

50

5000

Day

4

0

40

7500

3
2
1
0

0

10

20

30

Day

(a) Scenario 1

40

50

60

Day

(b) Scenario 2

70

3
2
1
0

0

10

20

30

40

50

60

70

Day

(c) Scenario 3

Figure 2. The upper panel shows the simulated daily confirmed cases
for the three scenarios. The lower panel shows the estimated timevarying effective reproduction numbers (solid black line), 95% credible
intervals (grey band), and simulation truth (dashed red line) for the
three scenarios.

We also carry out sensitivity analyses to explore how the choice of the link function
(Equation 6) and priors can affect the performance of the proposed method. Details
of the sensitivity analyses are reported in Appendix C. In general, our method is
robust to different specifications of the link function. The choice of the priors, on the
other hand, may have an impact on the parameter estimates, because of parameter
unidentifiability issues (see Appendix A).

16

T. ZHOU AND Y. JI

6. Case Studies
To illustrate the practical application of the proposed method, we carry out data
analysis based on daily counts of confirmed COVID-19 cases reported by JHU CSSE.
This is the Bt in our model. We limit our analysis to six U.S. states (Washington,
New York, California, Florida, Texas, and Illinois) to keep the paper in reasonable
length. The reader can carry out independent analysis for other states, countries or
regions using the R package BaySIR. The populations of these states are obtained
from U.S. Census Bureau.

6.1. Estimation of the Effective Reproduction Number. Figure 3 shows the
estimated Re (t) for the six states. The start dates of statewide stay-at-home orders
and state reopening plans are also displayed in the figure for reference (data source:
Mervosh et al., 2020 and Washington Post Staff, 2020). The estimated initial Re
ranges from 2.5 to 4.0. Specifically, Re (0) = 2.8, 3.7, 2.6, 3.3, 2.7 and 3.1 for Washington, New York, California, Florida, Texas and Illinois, respectively. During the
early stage of the outbreak, the Re generally has a decreasing trend. We suspect that
the decline in Re may be associated with the implementation of mitigation policies
(e.g., statewide stay-at-home orders, shown in Figure 3) and the increase of public
awareness. Starting from April, the Re for these states is maintained around or below
1, indicating (partial) containment of the disease. However, with the gradual lift of
stay-at-home orders and reopening of businesses, we can clearly observe rebounds of
Re for some states (e.g., Florida) since May. For all the states, we can observe local
fluctuations of Re over time, which may potentially be attributed to some unobserved
factors such as social distancing fatigue. Our analysis is preliminary and does not
lead to definitive conclusions about whether a specific intervention is effective in controlling disease spread. Due to the issue of (potentially unmeasured) confounding, it
is very challenging to draw causal inference about the effectiveness of an intervention.
Nevertheless, our analysis can shed light on the transmission dynamics of COVID-19
and may be used as a reference for decision-makers.
6.2. Test of Fit. We carry out the Bayesian χ2 test (Johnson, 2004) to assess the
goodness-of-fit of our model using Illinois data as an example. First, we choose quantiles 0 ≡ a0 < a1 < · · · < aG−1 < aG ≡ 1, with pg = ag − ag−1 , g = 1, . . . , G.
As suggested by Johnson (2004), we use (a0 , . . . , a5 ) = (0, 0.2, 0.4, 0.6, 0.8, 1), so

BAYESIAN INFERENCE FOR THE TRANSMISSION DYNAMICS OF COVID-19
Washington

New York

17

California

10
5

7

7

/2

7

/1

06

06

8

/0
06

8

/2

8

/1

05

05

8

/0

8

/2

05

8

/1
04

04

9

/0

9

/2

04

9
03

/0

6

6
06

/2

6

/1

7

/0

06

06

7

/2

7

7

/0

/1

05

Date

Illinois

Date

1

Date

5

5
/1

/2
06

5

6

/0

06

06

6

/2
05

/1
05

6
/0
05

6

6

/2
04

04

/1

6

7
/2

/0
04

7

5

5

/2
06

5

/1
06

/0
06

6

6

/2
05

/1
05

6
/0
05

6

6
/1

/2
04

04

6

7
/2

/0
04

7
/1

2

0
03

4
06

/2

4

4
/0

5

/1
06

06

5

/2
05

05

/1

5

5

/0
05

/2
04

5
/1
04

/2

/0
04

03

5

0
6

0

1

3

/1

1

2

4

03

2

3

03

Eff. Reprod. No.

3

Eff. Reprod. No.

4

03

Eff. Reprod. No.

1

Date

4

6

2

Texas

5

/1

05

7

/2

05

7

/1

04

8

/0

04

8
/1

/2

04

03

8
03

Date

Florida

03

3

0

/0

5

5

/2
06

5

/1

6

/0

06

06

6

/2

6

/1

05

05

6

/0

6

/2

05

04

6

/1

7

/0

04

/2

04

/1

03

/0

03

03

7

0

7

0

4

/1

1

15

03

2

Eff. Reprod. No.

3

03

Eff. Reprod. No.

4

20

03

Eff. Reprod. No.

5

Date

Figure 3. Estimated time-varying effective reproduction numbers
(solid black line) for six U.S. states: Washington, New York, California, Florida, Texas, and Illinois. The start date in each graph is the
date when the 100th case is confirmed in the state. The grey band
represents the 95% posterior credible interval. The dashed vertical
lines correspond to the start dates of statewide stay-at-home orders
and state reopening plans. The dashed horizontal line represents an
Re of 1.
pg ≡ 0.2 and G = 5. Next, let θ (`) be a posterior sample of the model param
eters θ, and let mg θ (`) denote the number of observations (i.e., Bt ’s) such that
n
o
U (`)
logit Bt /[(1 − α(`) )It ] falls between the ag−1 and ag quantiles of the distribution


(`)2
. Let
N yt> η (`) , σγ

ω θ


(`)

"
#2

G
X
mg θ (`) − (T + 1) · pg
p
=
.
(T + 1) · pg
g=1

Then, under the null hypothesis of a good model fit, the statistic ω should follow a
χ2 -distribution with G − 1 = 4 degrees of freedom. A quantile-quantile plot of the
posterior samples of ω against the expected order statistics from a χ24 distribution
(Appendix Figure D) shows that ω plausibly comes from a χ24 distribution. In addition, we find the proportion of posterior samples of ω exceeding the 95% quantile of
a χ24 distribution to be 0.053. There is no evidence of a lack of fit.
6.3. Forecasts.
Retrospective forecasts. As described in Section 4.2, the proposed method can be
used to predict a future observation based on its posterior predictive distribution.

18

T. ZHOU AND Y. JI

To evaluate the forecasting performance of the proposed model, we conduct withinsample forecasts using Illinois as an example. Specifically, we split the observations
B into a training set B tr and a testing set B te , where B tr = (B0 , B1 , . . . , Bt∗ ) and
B te = (Bt∗ +1 , Bt∗ +2 , . . . , BT ). We consider three different scenarios, t∗ ∈ {19, 39, 59},
so that the training set consists of observations for 20, 40 and 60 days, respectively.
We first sample from the posterior distribution of the parameters evaluated on the
training set, π(θ | B tr , I0D ), and then sample from the posterior predictive distribution

Date

(a) 20-day training data

/1
5

/2
5

06

/0
5

06

/2
6

06

/1
6

05

/0
6

05

/2
6

05

/1
6

04

/0
6

04

/2
7

03

/2
5

1

4
3
2
1

Date

(b) 40-day training data

06

06

/0
5

/2
6

06

05

/1
6

/0
6

05

/2
6

05

04

/1
6

/0
6

04

/2
7

04

/1
7

/2
5
06

/1
5
06

/0
5
06

/2
6
05

/1
6

/0
6

05

05

/2
6
04

/1
6
04

/0
6

/2
7

0
04

/1
7

/1
5

Eff. Reprod. No.

2

03

/2
5

06

/1
5

06

/0
5

06

/2
6

05

/1
6

05

/0
6

05

/2
6

04

/1
6

04

04

Daily Confirmed Cases

/1
7
03

/2
5

/1
5

06

/0
5

06

/2
6

06

/1
6

3

0
/0
6

0.0
/2
7

0

03

2.5

04

1000

03

Eff. Reprod. No.

5.0

03

2000

Date

4

03

Eff. Reprod. No.

3000

5

5

7.5

/1
7

4000

Date

10.0

03

05

/0
6

Date

05

/2
6

05

/1
6

04

04

03

/0
6

0

/2
5

/1
5

1000

06

/0
5

06

/2
6

06

/1
6

05

/0
6

05

/2
6

05

/1
6

04

/0
6

04

04

03

03

/2
7

0

2000

/2
7

1000

3000

03

2000

4000

04

Daily Confirmed Cases

3000

/1
7

4000

/1
7

Daily Confirmed Cases

of the testing observations, π(B te | B tr , I0D ).

Date

(c) 60-day training data

Figure 4. Within-sample forecasts for Illinois using 20-day, 40-day
or 60-day training data. The upper panel shows the observed daily
confirmed cases (solid red line), and posterior medians (dashed line)
and 95% credible intervals (grey band) for (B te | B tr , I0D ). The upper bounds of the credible intervals are truncated for better display.
The lower panel shows the posterior medians (solid red line) and 95%
credible intervals (red band) for [Re (0), . . . , Re (t∗ ) | B tr , I0D ], and posterior medians (dashed line), posterior draws (thin grey lines) and 95%
credible intervals (blue band) for [Re (t∗ + 1), . . . , Re (T ) | B tr , I0D ].
Figure 4 shows the forecasting results for the three scenarios. The 97.5% percentile
of π(B te | B tr , I0D ) (i.e., the upper bound of the 95% credible interval) is truncated
in the figure for better display, because it becomes huge with exponential growth.
To better understand the forecasting behavior of the proposed model, the predictions of future Re (t)’s are also displayed. Using 20-day training data, the median of
π(B te | B tr , I0D ) underestimates the actual observations, although the 95% credible

BAYESIAN INFERENCE FOR THE TRANSMISSION DYNAMICS OF COVID-19

19

interval covers the observed values. In general, prediction of an epidemic process is
challenging, especially when the epidemiological parameters vary over time. To see
this, notice that there is a rebound of Re (t) around April 21, which cannot be captured by the GP prediction rule with 20-day training data. Since the stay-at-home
order is still in effect on April 21, this rebound can neither be captured by policyrelated covariates. To summarize, future predictions are made based on extrapolation
of the current trend, and if the trend changes unexpectedly, the predictions will be
inaccurate.
With more training data, the prediction accuracy improves, as seen in Figure 4(b,
c). Using 60-day training data, the median of π(B te | B tr , I0D ) matches well with
the actual observations. Lastly, the short-term predictions (within, say, the next 10
days) are reasonably accurate in all the scenarios.
Prospective forecasts. To make future predictions, we first sample from π(θ | B, I0D )
and then sample from π(B ∗ | B, I0D ); recall that B ∗ = (BT +1 , . . . , BT +T ∗ ). Figure
5 shows the projected daily confirmed cases and Re (t)’s for Illinois in the next 30
days (i.e., T ∗ = 30). The projections are based on the assumption that the decreasing
trend of Re (t) continues. With the lift of the stay-at-home order and the reopening of
businesses, it is possible that Re (t) will rebound, thus caution is needed in interpreting
the forecasting results.

7. Discussion
We developed a Bayesian approach to statistical inference about the transmission
dynamics of COVID-19. We proposed to estimate the disease transmission rate using GPR, which captures nonlinear and non-monotonic trends without the need of
specific parametric assumptions. A PTMCMC algorithm was used to efficiently sample from the posterior distribution of the epidemiological parameters. Case studies
based on the proposed method revealed the overall decreasing trend of Re in six U.S.
states (Washington, New York, California, Florida, Texas, and Illinois), which may
be associated with the implementation of mitigation policies and the increasing public awareness of the disease. Projections for future case counts can be made based on
extrapolation, although caution is needed in interpreting the forecasting results.
Extensions of the proposed compartmental model can be made in a number of ways.
As described in Section 3.1, it is possible to further split the UI and DI compartments and to incorporate an exposed compartment. We may also split the removed

T. ZHOU AND Y. JI

Eff. Reprod. No.

4000
3000
2000
1000

4
3
2
1
0

03
/1
03 7
/2
04 7
/0
04 6
/1
04 6
/2
05 6
/0
05 6
/1
05 6
/2
06 6
/0
06 5
/1
06 5
/2
07 5
/0
07 5
/1
07 5
/2
5

0
03
/1
03 7
/2
04 7
/0
04 6
/1
04 6
/2
05 6
/0
05 6
/1
05 6
/2
06 6
/0
06 5
/1
06 5
/2
07 5
/0
07 5
/1
07 5
/2
5

Daily Confirmed Cases

20

Date

(a) Projected daily confirmed cases

Date

(b) Projected Re (t)

Figure 5. Out-of-sample forecasts for Illinois in the next 30 days. (a)
Observed daily confirmed cases (solid red line), and posterior medians
(dashed line) and 95% credible intervals (grey band) for (B ∗ | B, I0D ).
(b) Posterior medians (solid red line) and 95% credible intervals (red
band) for [Re (0), . . . , Re (T ) | B, I0D ], and posterior medians (dashed
line), posterior draws (thin grey lines) and 95% credible intervals (blue
band) for [Re (T + 1), . . . , Re (T + T ∗ ) | B tr , I0D ]

compartment into recovered and deceased compartments. See, for example, Giordano et al. (2020), Zhang et al. (2020) and Aguilar et al. (2020). Considering more
compartments will make the model more realistic. However, by adding complexity
to the current parsimonious model, sampling, estimation and model unidentifiability problems are likely exacerbated (Capaldi et al., 2012; Osthus et al., 2017). A
possible way out could be to utilize more observable information, such as numbers
of recoveries and hospitalizations. Nevertheless, not every country/region has these
data (or accurate measurements of these data) available, and we chose to model only
daily confirmed cases to keep our method general enough and applicable to most
countries/regions.
The proposed model as in Equation (4) is a state-space model motivated by a
deterministic SIR model. A future direction is to consider a stochastic epidemic
model. For example, a model similar to Lekone and Finkenstädt (2006) may be used,

St = St−1 − At−1 ,

U
ItU = It−1
+ At−1 − Bt−1 − Ct−1 ,

D
ItD = It−1
+ Bt−1 − Dt−1 ,

Rt = Rt−1 + Ct−1 + Dt−1 ,

BAYESIAN INFERENCE FOR THE TRANSMISSION DYNAMICS OF COVID-19

21

where
i
h
U
D
At ∼ Bin St , 1 − e−βt (It +It )/N ,

Ct ∼ Bin(ItU , 1 − e−α ),

Bt | Ct ∼ Bin(ItU − Ct , 1 − e−γt ),

Dt ∼ Bin(ItD , 1 − e−α ).

Compared to Equation (4), this model may better reflect the stochastic nature of the
epidemic process. The cost is increased computational complexity.
In our models for the diagnosis rate (Equation 5) and transmission rate (Equation
7), we allow incorporation of covariates. Currently, we only considered an intercept
term and a time trend, because empirically we found it hard to identify the effects
of other covariates. Due to Ockham’s razor (Jefferys and Berger, 1992), we preferred
the simpler model. More efficient ways to incorporate covariates, potentially based
on model selection or variable selection techniques, are worth further investigation.
Our data analysis was carried out separately for each country/region. A nature
extension is to model multiple countries/regions jointly using a hierarchical model to
achieve borrowing of information, which usually leads to improvements in parameter estimations. We assumed that the population in each country/region is closed,
ignoring immigration and emigration. Arguably, a more realistic model should take
into account spatial spread of the disease, as seen in Li et al. (2020b). Again, the
main drawbacks to these extensions would be increased computation time.
As discussed in Appendix A, the parameters in model (4) are unidentifiable with
only daily confirmed cases (Bt ) observed, thus parameter estimates are sensitive to
prior choices and modeling assumptions. Many existing models for COVID-19 share
the same situation, which could partially explain why different studies may lead to
substantially different estimates. For example, some consider the infectious period
as the time from infection to recovery or death, which is around 20–30 days (Verity
et al., 2020). Under this definition, the estimated effective reproduction numbers
would be higher (e.g., Aguilar et al., 2020). Therefore, when interpreting the results,
it is important to recognize their reliance on underlying assumptions.
Lastly, since the proposed model (4) is a state-space model, it is of interest to
further explore online and sequential algorithms for posterior sampling, such as sequential Monte Carlo (Doucet et al., 2001; Dukic et al., 2012). In that way, when data
at more time points become available, one can update the posterior in an efficient
way rather than re-fitting the model to the complete data.

22

T. ZHOU AND Y. JI

References
Aguilar, J. B., Faust, J. S., Westafer, L. M., and Gutierrez, J. B. (2020). Investigating
the impact of asymptomatic carriers on COVID-19 transmission. medRxiv.
Allen, L. J. (2008). An introduction to stochastic epidemic models. In Brauer, F.,
van den Driessche, P., and Wu, J., editors, Mathematical Epidemiology, pages 81–
130. Springer Berlin Heidelberg, Berlin, Heidelberg.
Anderson, R. M. and May, R. M. (1991). Infectious Diseases of Humans: Dynamics
and Control. Oxford University Press, Oxford.
Andersson, H. and Britton, T. (2000). Stochastic Epidemic Models and Their Statistical Analysis, volume 151 of Lecture Notes in Statistics. Springer Science &
Business Media, New York.
Becker, N. G. and Britton, T. (1999). Statistical studies of infectious disease incidence. Journal of the Royal Statistical Society: Series B (Statistical Methodology),
61(2):287–307.
Brauer, F. (2008). Compartmental Models in Epidemiology, pages 19–79. Springer
Berlin Heidelberg, Berlin, Heidelberg.
Capaldi, A., Behrend, S., Berman, B., Smith, J., Wright, J., and Lloyd, A. L. (2012).
Parameter estimation and uncertainty quantication for an epidemic model. Mathematical Biosciences and Engineering, 9(3):553–576.
Chen, X. and Qiu, Z. (2020). Scenario analysis of non-pharmaceutical interventions
on global COVID-19 transmissions. arXiv preprint arXiv:2004.04529.
Dong, E., Du, H., and Gardner, L. (2020). An interactive web-based dashboard to
track COVID-19 in real time. The Lancet Infectious Diseases, 20(5):533–534.
Doucet, A., De Freitas, N., and Gordon, N. (2001). An introduction to sequential
Monte Carlo methods. In Doucet, A., De Freitas, N., and Gordon, N., editors, Sequential Monte Carlo Methods in Practice, pages 3–14. Springer Science & Business
Media, New York.
Dukic, V., Lopes, H. F., and Polson, N. G. (2012). Tracking epidemics with Google
flu trends data and a state-space SEIR model. Journal of the American Statistical
Association, 107(500):1410–1426.
Flaxman, S., Mishra, S., Gandy, A., Unwin, H. J. T., Coupland, H., Mellan, T. A.,
Zhu, H., Berah, T., Eaton, J. W., Guzman, P. N., et al. (2020). Report 13: Estimating the number of infections and the impact of non-pharmaceutical interventions
on COVID-19 in 11 European countries. Technical report.

BAYESIAN INFERENCE FOR THE TRANSMISSION DYNAMICS OF COVID-19

23

Geweke, J. (1991). Evaluating the Accuracy of Sampling-based Approaches to the Calculation of Posterior Moments, volume 196. Federal Reserve Bank of Minneapolis,
Research Department Minneapolis, MN, USA.
Geyer, C. J. (1991). Markov chain Monte Carlo maximum likelihood. In Computing
Science and Statistics, Proceedings of the 23rd Symposium on the Interface, pages
156–163, Fairfax Station, VA. Interface Foundation of North America.
Gibson, G. J. and Renshaw, E. (1998). Estimating parameters in stochastic compartmental models using Markov chain methods. Mathematical Medicine and Biology:
A Journal of the IMA, 15(1):19–40.
Giordano, G., Blanchini, F., Bruno, R., Colaneri, P., Di Filippo, A., Di Matteo, A.,
and Colaneri, M. (2020). Modelling the COVID-19 epidemic and implementation
of population-wide interventions in Italy. Nature Medicine. Forthcoming.
Gomez, J., Prieto, J., Leon, E., and Rodriguez, A. (2020). INFEKTA: A general
agent-based model for transmission of infectious diseases: Studying the COVID-19
propagation in Bogotá-Colombia. medRxiv.
Gu, J., Yan, H., Huang, Y., Zhu, Y., Sun, H., Zhang, X., Wang, Y., Qiu, Y., and
Chen, S. (2020). Better strategies for containing COVID-19 epidemics—a study of
25 countries via an extended varying coefficient SEIR model. medRxiv.
He, X., Lau, E. H., Wu, P., Deng, X., Wang, J., Hao, X., Lau, Y. C., Wong, J. Y.,
Guan, Y., Tan, X., et al. (2020). Temporal dynamics in viral shedding and transmissibility of COVID-19. Nature Medicine, 26(5):672–675.
Hethcote, H. W. (2000). The mathematics of infectious diseases. SIAM Review,
42(4):599–653.
IHME COVID-19 health service utilization forecasting team and Murray, C. J. (2020).
Forecasting COVID-19 impact on hospital bed-days, ICU-days, ventilator-days and
deaths by US state in the next 4 months. MedRxiv.
Jefferys, W. H. and Berger, J. O. (1992). Ockham’s razor and Bayesian analysis.
American Scientist, 80(1):64–72.
Johnson, V. E. (2004). A Bayesian χ2 test for goodness-of-fit. The Annals of Statistics, 32(6):2361–2384.
Kermack, W. O. and McKendrick, A. G. (1927). A contribution to the mathematical theory of epidemics. Proceedings of the Royal Society of London, Series A,
115(772):700–721.

24

T. ZHOU AND Y. JI

Kirkcaldy, R. D., King, B. A., and Brooks, J. T. (2020). COVID-19 and postinfection
immunity: Limited evidence, many remaining questions. JAMA. Forthcoming.
Kypraios, T. and ONeill, P. D. (2018). Bayesian nonparametrics for stochastic epidemic models. Statistical Science, 33(1):44–56.
Lekone, P. E. and Finkenstädt, B. F. (2006). Statistical inference in a stochastic
epidemic SEIR model with control intervention: Ebola as a case study. Biometrics,
62(4):1170–1177.
Li, Q., Guan, X., Wu, P., Wang, X., Zhou, L., Tong, Y., Ren, R., Leung, K. S., Lau,
E. H., Wong, J. Y., et al. (2020a). Early transmission dynamics in Wuhan, China,
of novel coronavirus–infected pneumonia.

New England Journal of Medicine,

382:1199–1207.
Li, R., Pei, S., Chen, B., Song, Y., Zhang, T., Yang, W., and Shaman, J. (2020b).
Substantial undocumented infection facilitates the rapid dissemination of novel
coronavirus (SARS-CoV-2). Science, 368(6490):489–493.
Liu, J. S. (2008). Monte Carlo Strategies in Scientific Computing. Springer Science
& Business Media.
Long, Q.-X., Liu, B.-Z., Deng, H.-J., Wu, G.-C., Deng, K., Chen, Y.-K., Liao, P.,
Qiu, J.-F., Lin, Y., Cai, X.-F., et al. (2020). Antibody responses to SARS-CoV-2
in patients with COVID-19. Nature Medicine. Forthcoming.
Mervosh, S., Lu, D., and Swales, V. (2020). See which states and cities have told residents to stay at home. The New York Times. URL: https://www.nytimes.com/
interactive/2020/us/coronavirus-stay-at-home-order.html, accessed June
30, 2020.
Osthus, D., Gattiker, J., Priedhorsky, R., and Del Valle, S. Y. (2019). Dynamic
Bayesian influenza forecasting in the United States with hierarchical discrepancy
(with discussion). Bayesian Analysis, 14(1):261–312.
Osthus, D., Hickmann, K. S., Caragea, P. C., Higdon, D., and Del Valle, S. Y. (2017).
Forecasting seasonal influenza with a state-space SIR model. The Annals of Applied
Statistics, 11(1):202–224.
ONeill, P. D. and Roberts, G. O. (1999). Bayesian inference for partially observed
stochastic epidemics. Journal of the Royal Statistical Society: Series A (Statistics
in Society), 162(1):121–129.

BAYESIAN INFERENCE FOR THE TRANSMISSION DYNAMICS OF COVID-19

25

Pan, A., Liu, L., Wang, C., Guo, H., Hao, X., Wang, Q., Huang, J., He, N., Yu,
H., Lin, X., Wei, S., and Wu, T. (2020). Association of public health interventions with the epidemiology of the COVID-19 outbreak in Wuhan, China. JAMA,
323(19):1915–1923.
Rasmussen, C. E. and Williams, C. K. (2006). Gaussian Process for Machine Learning. MIT press.
Roberts, S., Osborne, M., Ebden, M., Reece, S., Gibson, N., and Aigrain, S. (2013).
Gaussian processes for time-series modelling. Philosophical Transactions of the
Royal Society A: Mathematical, Physical and Engineering Sciences, 371:20110550.
Rothe, C., Schunk, M., Sothmann, P., Bretzel, G., Froeschl, G., Wallrauch, C.,
Zimmer, T., Thiel, V., Janke, C., Guggemos, W., et al. (2020). Transmission
of 2019-nCoV infection from an asymptomatic contact in Germany. New England
Journal of Medicine, 382(10):970–971.
Sun, H., Qiu, Y., Yan, H., Huang, Y., Zhu, Y., Gu, J., and Chen, S. X. (2020).
Tracking reproductivity of COVID-19 epidemic in China with varying coefficient
SIR model. Journal of Data Science. Forthcoming.
Verity, R., Okell, L. C., Dorigatti, I., Winskill, P., Whittaker, C., Imai, N., CuomoDannenburg, G., Thompson, H., Walker, P. G., Fu, H., et al. (2020). Estimates
of the severity of coronavirus disease 2019: a model-based analysis. The Lancet
Infectious Diseases, 20(6):669–677.
Wang, L., Wang, G., Gao, L., Li, X., Yu, S., Kim, M., Wang, Y., and Gu, Z. (2020a).
Spatiotemporal dynamics, nowcasting and forecasting of COVID-19 in the United
States. arXiv preprint arXiv:2004.14103.
Wang, L., Zhou, Y., He, J., Zhu, B., Wang, F., Tang, L., Eisenberg, M. C., and Song,
P. X. (2020b). An epidemiological forecast model and software assessing interventions on COVID-19 epidemic in China. Journal of Data Science. Forthcoming.
Washington Post Staff (2020). Where states are reopening after the U.S. shutdown.
The Washington Post.

URL: https://www.washingtonpost.com/graphics/

2020/national/states-reopening-coronavirus-map/, accessed June 30, 2020.
Weiss, H. (2013). The SIR model and the foundations of public health. Materials
Matemàtics, 2013(3):1–17.
Wölfel, R., Corman, V. M., Guggemos, W., Seilmaier, M., Zange, S., Müller, M. A.,
Niemeyer, D., Jones, T. C., Vollmar, P., Rothe, C., et al. (2020). Virological
assessment of hospitalized patients with COVID-2019. Nature, 581(7809):465–469.

26

T. ZHOU AND Y. JI

Woody, S., Tec, M. G., Dahan, M., Gaither, K., Lachmann, M., Fox, S., Meyers,
L. A., and Scott, J. G. (2020). Projections for first-wave COVID-19 deaths across
the US using social-distancing measures derived from mobile phones. medRxiv.
Wu, J. T., Leung, K., and Leung, G. M. (2020). Nowcasting and forecasting the
potential domestic and international spread of the 2019-nCoV outbreak originating
in Wuhan, China: A modelling study. The Lancet, 395(10225):689–697.
Xu, X., Kypraios, T., and O’Neill, P. D. (2016). Bayesian non-parametric inference
for stochastic epidemic models using Gaussian processes. Biostatistics, 17(4):619–
633.
Zhang, Y., You, C., Cai, Z., Sun, J., Hu, W., and Zhou, X.-H. (2020). Prediction of
the COVID-19 outbreak based on a realistic stochastic model. medRxiv.

BAYESIAN INFERENCE FOR THE TRANSMISSION DYNAMICS OF COVID-19

27

Appendix A. Parameter Identifiability
With only daily confirmed cases observed, the parameters in model (4) are unidentifiable. To see this, consider the following two epidemic processes (indexed by j = 1
and 2),
D
U
)/N,
+ Ij,t−1
Sj,t = Sj,t−1 − βj,t−1 Sj,t−1 (Ij,t−1
U
D
U
U
U
)/N − γj,t−1 (1 − αj )Ij,t−1
,
+ Ij,t−1
+ βj,t−1 Sj,t−1 (Ij,t−1
= (1 − αj )Ij,t−1
Ij,t
D
D
U
Ij,t
= (1 − αj )Ij,t−1
+ γj,t−1 (1 − αj )Ij,t−1
,
U
D
Rj,t = Rj,t−1 + αj (Ij,t−1
+ Ij,t−1
),

for t = 1, . . . , T . The observation is the daily increment in confirmed cases, Bj,t =
U
. These two processes give rise to identical observations B1,t and B2,t
γj,t (1 − αj )Ij,t

for all t, if
(9)

U
U
γ1,0 (1 − α1 )I1,0
= γ2,0 (1 − α2 )I2,0
,

and


U
U
D
(10) γ1,t (1 − α1 ) (1 − α1 )(1 − γ1,t−1 )I1,t−1
+ β1,t−1 S1,t−1 (I1,t−1
+ I1,t−1
)/N =


U
U
D
γ2,t (1 − α2 ) (1 − α2 )(1 − γ2,t−1 )I2,t−1
+ β2,t−1 S2,t−1 (I2,t−1
+ I2,t−1
)/N ,
for t = 1, . . . , T . In other words, different sets of parameters can lead to exactly the
D
U
D
U
, R2,0 )
, I2,0
, R1,0 ) = (S2,0 , I2,0
, I1,0
same observed data. Even if we restrict that (S1,0 , I1,0

(same initial conditions), γ1,t ≡ γ1 , and γ2,t ≡ γ2 (constant diagnosis rate), for any
α1 6= α2 we can still solve Equations (9) and (10) and get distinct {γ1 , β1,t } and
{γ2 , β2,t } that lead to the same observed data.
A specific example is given below. Consider a population size of N = 20, 000, 000.
U
=
Suppose there are two epidemic processes with the same initial conditions, I1,0
U
D
D
I2,0
= 800, I1,0
= I2,0
= 100, R1,0 = R2,0 = 0, and S1,0 = S2,0 = N − 900. Suppose

further α1 = 0.3, α2 = 0.05, γ1,t ≡ γ1 = 0.2, and γ2,t ≡ γ2 = γ1 · (1 − α1 )/(1 − α2 ) =
0.147. Then, the parameters β1,t and β2,t can be chosen (Figure A(a)) such that
{B1,t } and {B2,t } are identical (Figure A(b)). The resulting effective reproduction
numbers for the two epidemic processes, Rje (t) = (βj,t Sj,t )/(αj N ), are shown in Figure
A(c) and are quite different. This example highlights that the parameters in (4) are
unidentifiable in the absence of strong prior information.

0

20

40

60

80

12
8
0

0

day

(a) β1,t and β2,t

4

Eff. Reprod. No.

150000
50000
0

0.4

0.8

Daily Confirmed Cases

T. ZHOU AND Y. JI

0.0

Transmission Rate

28

20

40

60

80

day

(b) B1,t and B2,t (identical)

0

20

40

(c) R1e (t) and R2e (t)

Figure A. An example of two epidemic processes giving rise to identical observations. Panel (a) shows the distinct transmission rates for
the two processes. Panel (b) shows the identical observations given by
the two processes. Panel (c) shows the distinct effective reproduction
numbers for the two processes.

60

day

80

BAYESIAN INFERENCE FOR THE TRANSMISSION DYNAMICS OF COVID-19

29

Appendix B. Posterior Sampling: Parallel Tempering
To demonstrate the advantage of the PT scheme, we show in Figure B the Markov
chains for I0U and η generated using or not using PT based on a simulated dataset.
We evaluate the convergence of the chains using Geweke’s diagnostic (Geweke, 1991).
Under the null hypothesis of chain convergence, Geweke’s z-score should follow a
standard normal distribution. The z-score indicates lack of convergence for the chains

500

600

1200

1500

1800

generated without PT.

0

200

400

600

800

1000

0

200

400

600

800

1000

(b) I0U not using PT, zG = 4.46

−2.4

−2.5

−1.8

−1.5

−1.2

(a) I0U using PT, zG = 0.38

0

200

400

600

800

(c) η using PT, zG = −0.30

1000

0

200

400

600

800

1000

(d) η not using PT, zG = −5.90

Figure B. Markov chains for I0U and η using (a, c) or not using (b,
d) parallel tempering. The posterior correlation of I0U and η is −0.82.
The value zG refers to Geweke’s z-score for convergence diagnostic. All
chains are based on 50,000 iterations (discarding first 20,000 iterations
as burn-in and keeping 1 draw every 30 iterations).

30

T. ZHOU AND Y. JI

Appendix C. Simulation Studies: Sensitivity Analysis
We carry out sensitivity analyses to explore how the choice of the link function
(Equation 6) and priors can affect the performance of the proposed method. We
consider the following four settings:
(Set. 1) Replacing the default logit link for γt by the probit link;
(Set. 2) Replacing the default logit link for γt by the complementary log-log link;
(Set. 3) Replacing the default prior on α−1 by α−1 ∼ Ga(46.5, 5)1(α−1 ≥ 1). This
leads to a larger prior variance for α−1 compared to the default. Recall that
the default prior is α−1 ∼ Ga(325.5, 35)1(α−1 ≥ 1);
(Set. 4) Replacing the default prior on α−1 by α−1 ∼ Ga(700, 35)1(α−1 ≥ 1). This
leads to a different prior mean for α−1 compared to the default.
We fit our model to the Simulation Scenario 1 dataset. Figure C shows the estimated
time-varying effective reproduction numbers under the four settings. The estimates
are robust to the choice of the link function (Figure C(a, b)). Also, increasing the prior
variance for α−1 does not lead to much change in the estimates (Figure C(c)). Lastly,
altering the prior mean for α−1 can lead to substantially different estimates (Figure
C(d)). This is due to parameter unidentifiability issues (Appendix A). Multiple
solutions may explain the observed data equally well, thus the solutions that are
more consistent with the prior would be preferred. Under Setting 4, the prior for α−1
is centered around 20, while the true α−1 = 9.3. As a result, the parameter estimates
deviate from the simulation truth.

BAYESIAN INFERENCE FOR THE TRANSMISSION DYNAMICS OF COVID-19

Eff. Reprod. No.

Eff. Reprod. No.

4
5
4
3
2
1
0

0

10

20

30

40

50

60

3
2
1
0

70

0

10

20

30

Day

40

50

60

70

Day

(a) Probit link

(b) Complementary log-log link
Eff. Reprod. No.

Eff. Reprod. No.

8
4
3
2
1
0

0

10

20

30

40

50

60

70

Day

(c) Larger prior variance for α−1

6
4
2
0

0

10

20

30

40

50

60

70

Day

(d) Different prior mean for α−1

Figure C. Simulation Scenario 1. Estimated time-varying effective
reproduction numbers (solid black line) with different link functions
and priors for α−1 . The grey band represents the 95% posterior credible
interval, and the dashed red line shows the simulation truth.

31

32

T. ZHOU AND Y. JI

Appendix D. Case Studies: Test of Fit
We carry out the Bayesian χ2 test (Johnson, 2004) to assess the goodness-of-fit of
our model using Illinois data as an example. Under the null hypothesis of a good
model fit, the statistic ω should follow a χ24 distribution. Figure D shows a quantilequantile plot of posterior samples of ω against expected order statistics from a χ24

15
10
5
0

Sorted ω values

20

distribution. There is no evidence that ω deviates from a χ24 distribution.
●

●
●●
●●●
●●
●●●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

0

5

10

●

●

15

20

Expected order statistics

Figure D. Quantile-quantile plot of posterior samples of the test
statistic ω against expected order statistics from a χ24 distribution for
the Bayesian χ2 test

