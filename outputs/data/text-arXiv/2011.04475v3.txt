arXiv:2011.04475v3 [cs.CV] 18 Nov 2020

Deep Transfer Learning for Automated Diagnosis of
Skin Lesions from Photographs

Doyoon Kim∗
Cleveland High School
California, US

Emma Rocheteau†∗
Department of Computer Science and Technology
University of Cambridge, UK
ecr38@cam.ac.uk

Abstract
Melanoma is not the most common form of skin cancer, but it is the most deadly.
Currently, the disease is diagnosed by expert dermatologists, which is costly and
requires timely access to medical treatment. Recent advances in deep learning
have the potential to improve diagnostic performance, expedite urgent referrals and
reduce burden on clinicians. Through smart phones, the technology could reach people who would not normally have access to such healthcare services, e.g. in remote
parts of the world, due to financial constraints or in 2020, COVID-19 cancellations.
To this end, we have investigated various transfer learning approaches by leveraging
model parameters pre-trained on ImageNet with finetuning on melanoma detection.
We compare EfficientNet, MnasNet, MobileNet, DenseNet, SqueezeNet, ShuffleNet, GoogleNet, ResNet, ResNeXt, VGG and a simple CNN with and without
transfer learning. We find the mobile network, EfficientNet (with transfer learning)
achieves the best mean performance with an area under the receiver operating
characteristic curve (AUROC) of 0.931±0.005 and an area under the precision
recall curve (AUPRC) of 0.840±0.010. This is significantly better than general
practitioners (0.83±0.03 AUROC) and dermatologists (0.91±0.02 AUROC).

1

Introduction

Melanoma is the most common cause of skin cancer related deaths worldwide [28]. In the United
States alone, it is estimated that there will be 100,350 cases and 6,850 melanoma-related deaths in
2020 [2]. Initially, it develops in melanocytes where genetic mutations lead to unregulated growth
and the ability to metastasise to other areas of the body [39]. Like many cancers, early detection
is key to successful treatment. If melanoma is detected before spreading to the lymph nodes, the
average five-year survival rate is 98%. However, this drops to 64% if it has spread to regional lymph
nodes, and 23% if it has reached distant organs.
Currently, melanoma is diagnosed by professional medical examination [14]. A meta-analysis
conducted by Phillips et al. [24] showed that when distinguishing between melanoma and benign
skin lesions, primary care physicians (10 studies) achieve an area under the receiver operating
characteristic curve (AUROC) of 0.83±0.03, and dermatologists (92 studies) achieve 0.91±0.02.
Recent advances in deep learning have the potential to improve diagnostic performance and improve
access to care for those in need [5]. Through mobile application technology, it will soon be possible
to diagnose, refer and provide follow-ups to patients in the community. However, worrying findings
from Kassianos et al. [12] suggest the majority (if not all) diagnostic applications on app stores have
not been clinically validated. As a result, clinicians are becoming increasingly concerned about misleading applications [36]. However, we believe that when models are developed collaboratively with
∗

Equal contribution, †Corresponding author

Machine Learning for Mobile Health Workshop at NeurIPS 2020, Vancouver, Canada.

clinicians, and when they are rigorously evaluated with significance testing and model interpretability,
useful tools can be produced to support health in the community.
In this work, we investigate transfer learning with various Convolutional Neural Networks (CNNs)
on the binary classification task of classifying melanoma and benign skin lesions. In addition, we
perform post-hoc visualisation of the feature attributions using integrated gradients [32].

2

Related Work

Recent work by Raghu et al. [25] cast doubt on the usefulness of transfer learning (TL) for medical
imaging. However, a few TL works have achieved success on the problem of melanoma detection [8,
21, 22, 26, 38, 40] (although they do not necessarily compare the model with and without TL). We did
not find an extensive survey on existing TL models such as ours. The highest AUROC for melanoma
detection that we found on photographs was 0.880 in Bisla et al. [3], which is still lower than the
performance for professional dermatologists found in Phillips et al. [24].

3

Methods

Our task is to classify between benign nevi and malignant melanomas. For each patient we have
a dermatoscopic photograph in RBG format, x ∈ R3×224×224 and static features, s ∈ R3 (age,
gender and location on the body) and the binary label y ∈ R1 . Figure 1 shows the basic architecture
of all models. Our code is publicly available at https://github.com/aimadeus/Transfer_
learning_melanoma.

Prediction

Age
Gender
Location

Figure 1: Model architecture. The CNN component (indicated in brackets) is different in each experiment. The
static data is processed separately and concatenated to the CNN output before a final prediction is made.

3.1

Transfer Learning

Transfer Learning (TL) is a machine learning method where the weights of a trained model are used to
initialise another model on a different task [34]. In our case, we investigate several CNN architectures
using pre-training on ImageNet [4] (a database containing over 14 million images). The last fully
connected layer is replaced with one that has a binary output, and whose weights are initialised
using Kaiming initialisation [7]. Further description of the various CNN architectures are provided
in Appendix A. We also train a standard 5-layer CNN with no transfer learning (hyperparameter
optimisation and further implementation details are provided in Appendix B and C respectively).

4
4.1

Experiments
Data

We use the International Skin Imaging Collaboration (ISIC) 2020 dataset [27] (released August
2020), containing labelled photographs taken from various locations on the body (see Table 3 in the
Appendix). We noted a significant class imbalance with only 2% of the data containing melanoma.
To improve this ratio, we added a second dataset with additional malignant cases [1], which brought
the total to 37,648 skin lesion images. The data was split such that 60%, 20% and 20% was used
for training, validating and testing respectively. Data Augmentation was performed on the training
2

data to introduce small variations in the form of random rotations, horizontal and vertical flipping,
resizing, brightness, and saturation shifts. This means the training data is subtly altered each time it
is presented to the model. Figure 2 shows two examples of raw and augmented images respectively.

Figure 2: Example photographs in the training data. In each pair of images, the raw data is shown on the left and
an augmented image example is shown on the right.

4.2

Results

Table 1 shows the test performance of all the models ((a) without and (b) with transfer learning).
Eight of the ten CNN models performed significantly better with TL across all 4 metrics, and none of
the models are significantly harmed by TL on any metric, demonstrating a clear benefit of transfer
learning for melanoma detection. The best performing models are EfficientNet [17] and MnasNet [35],
which significantly outperform dermatologists [24] on AUROC. From the ROC curves shown in
Figure 3, we see that the EfficientNet can achieve a true positive rate of 0.95 while only conceding
0.1 to the false positive rate.
Table 1: Performance of the models averaged over 10 independent training runs. Tables (a) and (b) show the
performance without and with transfer learning respectively. The error margins are 95% confidence intervals
(CIs). We report the accuracy, area under the receiver operating characteristic curve (AUROC), area under
the precision recall curve (AUPRC) and the F1 Score. Within each table, the results are ordered from least
to best performance. In table (b), if the result is statistically better than the model without transfer learning
in a one-tailed t-test (p < 0.05∗ and p < 0.001∗∗ ), then it is indicated with stars. Results that significantly
outperform general practitioners and dermatologists on AUROC (determined by a recent meta-analysis† [24])
are indicated in green and blue respectively (p < 0.05).

(a)

(b)

Model

Accuracy

AUROC

AUPRC

F1 Score

Standard CNN
General Practitioners†
VGG [30]
SqueezeNet [10]
ResNeXt [37]
DenseNet [9]
GoogleNet [33]
ResNet-50 [6]
MobileNet [29]
MnasNet [35]
ShuffleNet [18]
EfficientNet [17]
Dermatologists†

0.914±0.004
0.943±0.004
0.949±0.003
0.952±0.009
0.957±0.003
0.957±0.004
0.959±0.003
0.963±0.003
0.963±0.008
0.965±0.004
0.967±0.002
-

0.759±0.030
0.83±0.03
0.832±0.018
0.860±0.014
0.878±0.022
0.859±0.015
0.861±0.018
0.869±0.016
0.889±0.013
0.900±0.010
0.892±0.016
0.900±0.009
0.91±0.02

0.484±0.026
0.643±0.025
0.687±0.011
0.712±0.035
0.733±0.021
0.732±0.024
0.744±0.018
0.769±0.019
0.771±0.039
0.777±0.025
0.794±0.013
-

0.633±0.035
0.765±0.023
0.801±0.008
0.818±0.023
0.824±0.018
0.824±0.022
0.835±0.016
0.856±0.014
0.859±0.023
0.861±0.018
0.872±0.010
-

General Practitioners†
VGG [30]
ResNet-50 [6]
ShuffleNet [18]
SqueezeNet [10]
DenseNet [9]
Dermatologists†
MobileNet [29]
ResNeXt [37]
GoogleNet [33]
MnasNet [35]
EfficientNet [17]

0.959±0.003∗∗
0.962±0.004
0.963±0.006
0.963±0.004∗∗
0.966±0.003∗∗
0.969±0.002∗∗
0.971±0.001∗∗
0.973±0.002∗∗
0.974±0.002∗
0.975±0.002∗∗

0.83±0.03
0.874±0.013∗∗
0.880±0.014
0.896±0.024
0.902±0.015∗∗
0.904±0.011∗∗
0.91±0.02
0.916±0.007∗∗
0.918±0.006∗∗
0.921±0.006∗∗
0.928±0.005∗∗
0.931±0.005∗∗

0.740±0.016∗∗
0.763±0.022
0.769±0.040
0.771±0.020∗∗
0.786±0.018∗∗
0.806±0.015∗∗
0.819±0.009∗∗
0.831±0.013∗∗
0.832±0.013∗∗
0.840±0.010∗∗

0.835±0.013∗∗
0.849±0.017
0.857±0.028
0.861±0.015∗∗
0.870±0.011∗∗
0.884±0.009∗∗
0.891±0.005∗∗
0.898±0.008∗∗
0.901±0.007∗∗
0.906±0.006∗∗

3

Figure 3: ROC curves of TL models and Standard CNN (we Figure 4: A test set image and corresponding
magnify the top left part of the curves in the right plot).
integrated gradient attributions for the standard
CNN model.

4.3

Visualisation

We used the integrated gradients method [32] to calculate feature attributions. This method computes
the importance scores φIG
by accumulating gradients interpolated between a baseline b input
i
(intended to represent the absence of data, in our case this is a black image) and the current input x.
acc. local grad.
diff. from baseline

φIG
i (ψ, x, b) =

z
}|
{
z }| {
δψ(b + α(x − b))
(xi − bi ) ×
dα
δxi
α=0
Z

1

(1)

The CNN model is represented as ψ 2 . We observed that the models tend to focus primarily on the
edges of the skin lesions (Figure 4). This aligns with our expectation, since uneven or notched edges
are common in melanoma [19]. Secondary to the edges, there is some importance to the lesion
itself and surrounding skin. This is significant because melanomas can also show uneven texture or
colour [19].

5

Conclusion

We have conducted an extensive investigation of transfer learning for the task of melanoma detection
from photographs. We have demonstrated the benefit of transfer learning with ImageNet pretraining [4] for melanoma detection on the ISIC 2020 dataset [27]. Furthermore, we show that the
best performing neural networks are EfficientNet and MnasNet, which are capable of outperforming
dermatologists when distinguishing melanoma from benign skin lesions. In particular, we note that
these networks have been specifically designed for mobile devices [17, 35]. This may be important
when it comes to data privacy and medical data regulations (as the classification can be performed
locally on the user’s personal device).
In future work, we aim to extend the binary classification task to classify other skin lesions such as
benign keratosis, basal cell carcinoma, actinic keratosis, vascular lesions and dermatofibroma. Secondly, we would like to extend our interpretability study such that we can visualise the learnt features
in the intermediate layers of the models. To do this we can leverage the approach of Mordvintsev et al.
[20] whereby we obtain inputs designed to maximise the activation of hidden layers of the network.
This will provide further insights as to why certain models outperform others in melanoma detection.
Finally, we can validate the diagnostic technology in the community with an implementation study.

6

Broader Impact

The automated diagnosis technology could be used to screen, triage, refer and follow-up patients
in the community. It also has potential to reach patients who would not normally have access to
dermatologists e.g. in remote areas or the developing world. The high AUROC of EfficientNet (high
true positive rate coinciding with a low false positive rate) would make it well-suited to this purpose.
Such a system could significantly reduce the cost and resources needed to screen and treat as it
reduces the pool of patients needing to see the dermatologist.
2

The background and intuition behind the method is explained clearly in Sturmfels et al. [31].

4

Acknowledgements
The authors would like to thank Horizon Academic for facilitating this research.

References
[1] melanoma external malignant 256, 2020.
melanoma-external-malignant-256.

URL https://www.kaggle.com/nroman/

[2] American Cancer Society.
Key statistics for melanoma skin cancer, 2020.
URL
https://www.cancer.org/cancer/melanoma-skin-cancer/about/keystatistics.html#:~:text=Overall.
[3] Devansh Bisla, Anna Choromanska, Jennifer A. Stein, David Polsky, and Russell S. Berman.
Skin lesion segmentation and classification with deep learning system. CoRR, abs/1902.06061,
2019. URL http://arxiv.org/abs/1902.06061.
[4] J. Deng, W. Dong, R. Socher, L.-J. Li, K. Li, and L. Fei-Fei. ImageNet: A Large-Scale
Hierarchical Image Database. In CVPR09, 2009.
[5] Y. Fujisawa, S. Inoue, and Y. Nakamura. The Possibility of Deep Learning-Based, ComputerAided Skin Tumor Classifiers. Front. Med., 2019.
[6] K. He, X. Zhang, S. Ren, and J. Sun. Deep residual learning for image recognition. arXiv
1512.03385, 12 2015.
[7] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. Delving deep into rectifiers:
Surpassing human-level performance on imagenet classification. CoRR, abs/1502.01852, 2015.
URL http://arxiv.org/abs/1502.01852.
[8] Khalid M. Hosny, Mohamed A. Kassem, and Mohamed M. Foaud. Classification of skin
lesions using transfer learning and augmentation with alex-net. PLOS ONE, 14(5):1–17, 05
2019. doi: 10.1371/journal.pone.0217293. URL https://doi.org/10.1371/journal.
pone.0217293.
[9] G. Huang, Z. Liu, L. van der Maaten, and K. Q. Weinberger. Densely connected convolutional
networks, 2018.
[10] F. N. Iandola, S. Han, M. W. Moskewicz, W. J. Dally K. Ashraf, and Kurt Keutzer. Squeezenet:
Alexnet-level accuracy with 50x fewer parameters and <0.5mb model size. arXiv:1602.07360,
02 2016.
[11] Y. Bengio J. Bergstra. Random search for hyper-parameter optimization. J. Mach. Learn. Res.,
13:281–305, 02 2012. ISSN 1532-4435.
[12] A.P. Kassianos, J.D. Emery, P. Murchie, and F.M. Walter. Smartphone applications for melanoma
detection by community, patient and generalist clinician users: a review. British Journal of
Dermatology, 05 2015. doi: 10.1111/bjd.13665.
[13] Diederik P. Kingma and Jimmy Ba. Adam: A method for stochastic optimization. CoRR,
abs/1412.6980, 2014.
[14] H. Kittler, H. Pehamberger, K. Wolff, and M. Binder. Diagnostic accuracy of dermoscopy.
Database of Abstracts of Reviews of Effects (DARE): Quality-assessed Reviews [Internet], 2002.
URL https://www.ncbi.nlm.nih.gov/books/NBK69394/.
[15] Alex Krizhevsky, Ilya Sutskever, and Geoffrey E Hinton. Imagenet classification with deep
convolutional neural networks. In F. Pereira, C. J. C. Burges, L. Bottou, and K. Q. Weinberger, editors, Advances in Neural Information Processing Systems 25, pages 1097–1105.
Curran Associates, Inc., 2012. URL http://papers.nips.cc/paper/4824-imagenetclassification-with-deep-convolutional-neural-networks.pdf.
[16] Mingchen Li, Mahdi Soltanolkotabi, and Samet Oymak. Gradient descent with early stopping
is provably robust to label noise for overparameterized neural networks, 2019.
5

[17] Q. V. Le M. Tan. Efficientnet: Rethinking model scaling for convolutional neural networks.
arXiv:1905.11946, 05 2019.
[18] N. Ma, X. Zhang, H. Zheng, and J. Sun. Shufflenet v2: Practical guidelines for efficient cnn
architecture design. 2018.
[19] Collette McCourt, Olivia Dolan, and Gerry Gormley. Malignant melanoma: a pictorial review. The Ulster medical journal, 83(2):103–110, may 2014. ISSN 20464207. URL https://pubmed.ncbi.nlm.nih.gov/25075139https://www.ncbi.nlm.
nih.gov/pmc/articles/PMC4113154/.
[20] Alexander Mordvintsev, Christopher Olah, and Mike Tyka. Inceptionism: Going deeper into neural networks, 2015. URL https://research.googleblog.com/2015/06/inceptionismgoing-deeper-into-neural.html.
[21] Dennis H. Murphree and Che Ngufor. Transfer learning for melanoma detection: Participation
in ISIC 2017 skin lesion classification challenge. CoRR, abs/1703.05235, 2017. URL http:
//arxiv.org/abs/1703.05235.
[22] Zabir Al Nazi and Tasnim Azad Abir. Automatic skin lesion segmentation and melanoma
detection: Transfer learning approach with u-net and dcnn-svm. In Mohammad Shorif Uddin and
Jagdish Chand Bansal, editors, Proceedings of International Joint Conference on Computational
Intelligence, pages 371–381, Singapore, 2020. Springer Singapore. ISBN 978-981-13-7564-4.
[23] Adam Paszke, Sam Gross, Francisco Massa, et al. PyTorch: An Imperative Style, HighPerformance Deep Learning Library. In Advances in Neural Information Processing Systems
32, pages 8024–8035. Curran Associates, Inc., 2019.
[24] Michael Phillips, Jack Greenhalgh, Helen Marsden, and Ioulios Palamaras. Detection of Malignant Melanoma Using Artificial Intelligence: An Observational Study of Diagnostic Accuracy.
Dermatology practical & conceptual, 10(1):e2020011–e2020011, dec 2019. ISSN 2160-9381.
doi: 10.5826/dpc.1001a11. URL https://pubmed.ncbi.nlm.nih.gov/31921498https:
//www.ncbi.nlm.nih.gov/pmc/articles/PMC6936633/.
[25] Maithra Raghu, Chiyuan Zhang, Jon Kleinberg, and Samy Bengio. Transfusion: Understanding transfer learning for medical imaging.
In H. Wallach, H. Larochelle,
A. Beygelzimer, F. d'Alché-Buc, E. Fox, and R. Garnett, editors, Advances in Neural Information Processing Systems 32, pages 3347–3357. Curran Associates, Inc.,
2019.
URL http://papers.nips.cc/paper/8596-transfusion-understandingtransfer-learning-for-medical-imaging.pdf.
[26] A. Romero Lopez, X. Giro-i-Nieto, J. Burdick, and O. Marques. Skin lesion classification
from dermoscopic images using deep learning techniques. In 2017 13th IASTED International
Conference on Biomedical Engineering (BioMed), pages 49–54, 2017.
[27] Veronica Rotemberg, Nicholas Kurtansky, Brigid Betz-Stablein, Liam Caffery, Emmanouil
Chousakos, Noel Codella, Marc Combalia, Stephen Dusza, Pascale Guitera, David Gutman,
Allan Halpern, Harald Kittler, Kivanc Kose, Steve Langer, Konstantinos Lioprys, Josep Malvehy,
Shenara Musthaq, Jabpani Nanda, Ofer Reiter, George Shih, Alexander Stratigos, Philipp
Tschandl, Jochen Weber, and H. Peter Soyer. A patient-centric dataset of images and metadata
for identifying melanomas using clinical context, 2020.
[28] Eiko Saito and Megumi Hori. Melanoma skin cancer incidence rates in the world from the
Cancer Incidence in Five Continents XI. Japanese Journal of Clinical Oncology, 48(12):
1113–1114, 11 2018. ISSN 1465-3621. doi: 10.1093/jjco/hyy162. URL https://doi.org/
10.1093/jjco/hyy162.
[29] M. Sandler, A. Howard, M. Zhu, A. Zhmoginov, and L. Chen. Mobilenetv2: Inverted residuals
and linear bottlenecks. 2019.
[30] Karen Simonyan and Andrew Zisserman. Very deep convolutional networks for large-scale
image recognition. arXiv 1409.1556, 09 2014.
6

[31] Pascal Sturmfels, Scott Lundberg, and Su-In Lee. Visualizing the impact of feature attribution baselines. Distill, 5(1):e22, 2020. URL https://distill.pub/2020/attributionbaselines/.
[32] Mukund Sundararajan, Ankur Taly, and Qiqi Yan. Axiomatic attribution for deep networks. In
Proceedings of the 34th International Conference on Machine Learning - Volume 70, ICML’17,
page 3319–3328. JMLR.org, 2017.
[33] C. Szegedy, W. Liu, Y. Jia, P. Sermanet, S. Reed, D. Anguelov, D. Erhan, V. Vanhoucke, and
A. Rabinovich. Going deeper with convolutions. 2014.
[34] C. Tan, F. Sun, T. Kong, W. Zhang, C. Yang, and C. Liu. A survey on deep transfer learning.
Artificial Neural Networks and Machine Learning - ICANN 2018, Lecture Notes in Computer
Science, vol 11141:270–279, 2018. URL https://doi.org/10.1007/978-3-030-014247_27.
[35] M. Tan, B. Chen, R. Pang, V. Vasudevan, Mark S., A. Howard, and Q. V. Le. Mnasnet:
Platform-aware neural architecture search for mobile, 2019.
[36] J.A. Wolf, J.F. Moreau, O. Akilov, J.C. English 3rd T. Patton, J. Ho, and L. K. Ferris.
Diagnostic inaccuracy of smartphone applications for melanoma detection. 2013. doi:
10.1001/jamadermatol.2013.2382.
[37] S. Xie, R. Girshick, P. Dollár, Z. Tu, and K. He. Aggregated residual transformations for deep
neural networks, 2017.
[38] L. Yu, H. Chen, Q. Dou, J. Qin, and P. Heng. Automated melanoma recognition in dermoscopy
images via very deep residual networks. IEEE Transactions on Medical Imaging, 36(4):
994–1004, 2017.
[39] Blazej Zbytek, J Andrew Carlson, Jacqueline Granese, Jeffrey Ross, Martin C Mihm Jr,
and Andrzej Slominski. Current concepts of metastasis in melanoma. Expert review
of dermatology, 3(5):569–585, oct 2008. ISSN 1746-9872. doi: 10.1586/17469872.3.
5.569. URL https://pubmed.ncbi.nlm.nih.gov/19649148https://www.ncbi.nlm.
nih.gov/pmc/articles/PMC2601641/.
[40] Hasib Zunair and A. Hamza. Melanoma detection using adversarial training and deep transfer
learning. 04 2020.

7

A

Transfer Learning Architectures

VGG VGG [30] is an advancement of a previous deep neural network, AlexNet [15]. The model
uses small receptive fields of 3x3 with five max-pooling layers. In our paper, we use VGG16.
GoogleNet GoogleNet [33] was developed in 2014 to solve the problem of overfitting by building
an Inception Module, using filters of multiple sizes. Three filter sizes of 1x1, 3x3, and 5x5 are
simultaneously used; whereby the 1x1 convolution is used to shrink the dimensions of the model. The
GoogleNet architecture consists of 9 Inception Modules, with each module connected to an average
pooling layer.
ResNet ResNet [6] short for “Residual Network”, is a deep learning model developed in 2015 and
was the winner of the ImageNet Competition [4]. In our research, we use ResNet50, a variant of
the ResNet Model. The model consists of 48 Convolutional layers, 1 Max Pooling and 1 Average
Pooling layer. ResNet addresses the vanishing-exploding gradients by leveraging skip connections
for identity mapping, simplifying the network.
SqueezeNet SqueezeNet [10] uses fewer parameters while preserving similar performance to
AlexNet [15]. There are several architectural features worth noting: the use of 1x1 convolution filters,
decreased number of input channels, and down-sampling later in the network.
DenseNet DenseNet [9] is similar to the architecture of ResNet but with “DenseBlocks”. Each
DenseBlock consists of a convolution layer, pooling layer, batch normalisation, and non-linear
activation layer.
ResNeXt Built on the Residual Network and VGG, ResNeXt [37] uses a similar split-transformmerge strategy with an additional cardinality dimension (size of a set of transformations). The models
borrows the repeating layers strategy from VGG and ResNet and according to the researchers, has
better performance than ResNet [6] but with only 50% complexity.
MobileNet MobileNet [29] was developed for devices with smaller computational power such
as smartphones. Unlike bigger deep learning networks such as VGG, MobileNet uses depthwise
separable convolution, performing convolution on the input channels separately and then by pointwise
convolution. This way low latency models can be developed, which are applicable to mobile devices.
ShuffleNet ShuffleNet [18] was also designed for mobile devices with small computational power.
The model uses 1x1 convolution and channel shuffle, designed specifically for small networks.
ShuffleNet has efficient computation while obtaining an accuracy similar to and thirteen times faster
than AlexNet [15].
MnasNet MnasNet [35] is another mobile network designed for efficient performance using a
multi-objective neural architecture search approach that considers accuracy and latency. The network
also uses a hierarchical search space, achieving speeds faster than MobileNet [29].
EfficientNet EfficientNet [17] is a recent mobile network developed in 2018, which applies a
compound coefficient for improved accuracy. Rather than scaling up the CNN model by an arbitrary
amount, the authors use a grid search to find correlation in scaling based on the AutoML neural
architecture search.

B

Hyperparameter Optimisation

For the standard CNN model, values in a range were tested for dropout, batch size, kernel size,
learning rate, number of layers, pool size, and number of convolution filters using random search,
which is a more efficient method of hyperparameter optimisation than grid or manual search [11].
The search ranges and final values are shown in Table 2.
8

Hyperparameter

Value

Lower

Upper

Scale

Dropout
Batch Size
Kernel Size
Learning Rate
Number of Layers
Pool Size
Convolution Filters

0.4
8
4
0.00977
5
3
11

0.0
4
2
0.001
5
3
6

0.5
512
5
0.01
10
4
12

Linear
log2
Linear
log10
Linear
Linear
Linear

Table 2: Hyperparameter search ranges and final values.

C

Implementation

All deep learning methods were implemented in PyTorch [23] and were optimised using Adam [13].
The models were trained using Tesla P100 GPUs. Each model was trained over 10 independent
training runs with early stopping [16] for a maximum of 15 epochs (the patience constant was set to
3). We used step decay in the learning rate (the decay was set to 0.4 with a learning patience of 1).

D

Additional Tables and Figures
Location

Normal

Melanoma

Torso
Lower extremity
Upper extremity
Head/neck
Palms/soles
Oral/genital

17106
8293
4872
1781
370
120

257
124
111
74
5
4

Table 3: Distribution of normal and melanoma skin lesion samples based on location of body.

9

