COVID-CXN ET: D ETECTING COVID-19 IN F RONTAL C HEST
X- RAY I MAGES USING D EEP L EARNING

arXiv:2006.13807v2 [eess.IV] 29 Jul 2020

A P REPRINT
Arman Haghanifar
Div. of Biomedical Engineering
University of Saskatchewan
arman.haghanifar@usask.ca
Younhee Choi
International Road Dynamics, Canada
younhee.choi@irdinc.com

Mahdiyar Molahasani Majdabadi
Department of Electrical & Computer Engineering
University of Saskatchewan
m.molahasani@usask.ca
S. Deivalakshmi
National Institute of Technology, Trichy, India
deiva@nitt.edu

Seokbum Ko
Department of Electrical & Computer Engineering
University of Saskatchewan
seokbum.ko@usask.ca

July 30, 2020

A BSTRACT
One of the primary clinical observations for screening the novel coronavirus is capturing a chest x-ray
image. In most patients, a chest x-ray contains abnormalities, such as consolidation, resulting from
COVID-19 viral pneumonia. In this study, research is conducted on efficiently detecting imaging
features of this type of pneumonia using deep convolutional neural networks in a large dataset. It
is demonstrated that simple models, alongside the majority of pretrained networks in the literature,
focus on irrelevant features for decision-making. In this paper, numerous chest x-ray images from
various sources are collected, and the largest publicly accessible dataset is prepared. Finally, using
the transfer learning paradigm, the well-known CheXNet model is utilized to develop COVID-CXNet.
This powerful model is capable of detecting the novel coronavirus pneumonia based on relevant and
meaningful features with precise localization. COVID-CXNet is a step towards a fully automated and
robust COVID-19 detection system.
Keywords COVID-19 · Chest X-ray Radiograph · Convolutional Neural Networks · CheXNet · Imaging Features

1

Introduction

Being declared as a pandemic, novel coronavirus is now a major emergency worldwide. The virus is transmitted
person-to-person by respiratory droplets or close contact with a contaminated surface [1]. The most common symptoms
are fever, cough, and dyspnea, which may appear 2-14 days after exposure to the virus. The standard diagnosis method,
highly specific but with inconstant sensitivity [2], is based on reverse transcription polymerase chain reaction (RT-PCR)
[3]. The RT-PCR test has certain shortcomings, such as availability and time-consumption. It needs special test-kits,
which may not be widely available in some regions [4], and the results are generally available within hours to days
[5]. A diagnostic guideline proposed by Zhongnan Hospital of Wuhan suggests that the disease could be assessed by
detecting clinical symptoms as well as radiological findings of pneumonia [6]. Furthermore, Ai et al. show that chest
computed tomography (CT) scans have high sensitivity for COVID-19 diagnosis and can be considered as the primary
diagnostic tools in epicenters [7].

COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

Chest x-rays (CXRs) and CT scans have been used for COVID-19 screening and disease progression evaluation in
hospital admitted cases [8]. Despite offering superior sensitivity to thoracic abnormality detection [9], using CT has
several challenges. CT scanners are non-portable and require sanitizing of the equipment and imaging room between
patients. Besides, their radiation dose is considerably higher than x-rays [10]. On the contrary, portable x-ray units are
widely available and can be easily accessed in most primary hospitals. Moreover, x-ray imaging can be operated in
more isolated rooms with less staff exposure to the virus. In many cases, the patient’s clinical situation does not allow a
CT scan; hence, CXRs are a better choice for the initial assessment.
Since radiologists visit many patients every day and the diagnosis process takes significant time, errors may increase
notably. As a result, there might be many more false negatives that will cost a lot to the patient and the medical staff.
Therefore, automated computer-aided diagnostic (CAD) tools are of utmost importance. Automated deep learning-based
CAD tools have previously shown promising results in pulmonary disease detection [11].
In this study, firstly, we collect a dataset of CXRs from COVID-19 patients from multiple publicly accessible sources.
Our collected dataset is the largest source of COVID-19 CXRs, containing 780 images. We then investigate the
possibility of disease detection by an individual Convolutional Neural Network (CNN) model. On the next step,
performance of prominent pretrained CNN models for fine-tuning on the dataset is investigated. Afterwards, the
CheXNet pretrained model on the same type of medical images is introduced, and its efficiency is discussed. Finally,
we develop our model based on the CheXNet and design a lung segmentation module to improve the model localization
of lung abnormalities. Class activation map (CAM) is our main visualization leverage to compare our models. Main
contributions can be summarized as:
• Collecting the largest public dataset of COVID-19 CXR images from different sources
• Developing a robust detection model by training on a large dataset of COVID-19 pneumonia CXRs
• Precisely evaluating model performance by visualizing the results using CAMs

2

Related Works

Identifying COVID-19 pneumonia using different types of medical images is a fast-growing topic of interest. MLbased methods, along with manual feature extraction algorithms, are used in a few articles to diagnose the disease
[12, 13, 14, 15, 16]. However, most studies are utilizing DL-based techniques. Researchers have tried to tackle the
problem using CT images, reaching high scoring metrics and precise abnormality localization [17, 18]. Contrarily, even
though many studies have claimed to achieve excellent classification accuracy scores using CXRs, such as [19] and
[20], none of them have reported visualization results. Because pneumonia diagnosis is more challenging in CXRs and
the available COVID-19 pneumonia CXR datasets are small, we investigate those studies with visual interpretability
used as their metric.
Zhang et al. used a dataset including 100 CXRs from COVID-19 cases and developed a ResNet-based model with
pretrained weights from ImageNet as the backbone [21]. Their best model achieved an f-score of ≈ 0.72 in classifying
COVID-19 pneumonia from CAP. Li et al. applied their multi-player model called COVID-MobileXpert on a dataset
of 537 images equally divided into normal, CAP, and COVID-19 pneumonia samples [22]. Their main goal was to
achieve acceptable accuracy using lightweight networks, such as SqueezeNet, for pneumonia detection on mobile
devices capturing noisy snapshots. Rajaraman et al. collected a more expanded dataset containing 313 COVID-19
pneumonia CXRs from two different sources [23]. Lung segmentation was then applied using a U-Net-based model.
Finally, an ensemble of different fine-tuned models was implemented and pruned iteratively to reduce parameters.
Their best single pruned architecture was Inception-V3, and their best ensemble model was by weighted averaging
strategy. They have achieved f-scores of 0.9841 and 0.99 detecting COVID-19 pneumonia from CAP and normal CXRs,
respectively. However, their final generated visualization maps are not precisely discussed, and their model suffers
some implementation drawbacks due to the significant number of parameters.
In a more advanced effort, COVID-Net was introduced by Wang and Wong [24]. It was trained on COVIDx, a dataset
with 358 CXR images from 266 COVID-19 patient cases. Their architecture was first trained on ImageNet and then
achieved a best f-score of 0.9480 in three-class classification. Their model visualization is not properly presented
nevertheless. A most recent similar research study was CovidAID conducted by Mangal et al. [25]. CovidAID is a
DenseNet model built upon CheXNet weights. They compared their results with COVID-Net on the same test set.
Their findings suggest that CovidAID surpassed COVID-Net with a notable margin, 0.9230 f1 score, compared with
0.3591. CovidAID image visualization shows more precise performance compared to previous studies. Consequently,
developed models suffer a lack of robustness, mainly related to the insufficient number of images.
2

COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

3

Data and preprocessing

The most common imaging technique used as the first clinical step for chest-related diseases is CXR [26]. Hence, more
CXRs could be collected publicly than CT images. A batch of randomly selected samples from the dataset with frontal
view, also known as anteroposterior (AP) or posteroanterior (PA), is shown in Fig. 1.

Figure 1: Randomly selected frontal CXR images from different sources
There is another CXR imaging view called L, standing for Lateral, which is an adjunct for the main frontal view image.
Lateral CXR is performed when there is diagnosis uncertainty using frontal CXR [27]. Thus it is not as common as
frontal CXR, and due to its different angle, it is excluded from our data.
3.1

Dataset Sources

Since COVID-19 is a novel disease, the number of publicly available x-rays is relatively small. There are different
databases, regularly updated day by day, which our dataset is constructed upon them:
1. Radiopaedia 1 : open-edit radiology resource where radiologists submit their daily cases.
2. SIRM 2 : the website of the Italian Society of Medical and Interventional Radiology, which has a dedicated
database of COVID-19.
3. EuroRad 3 : a peer-reviewed image resource of radiological case reports.
4. Figure1 4 : an image-based social forum that has dedicated a COVID-19 clinical cases section.
5. COVID-19 image data collection [28]: a GitHub repository by Dr. Cohen et al., which is a combination of
some of the mentioned resources and other images.
6. Twitter COVID-19 CXR dataset 5 : a twitter thread of a cardiothoracic radiologist from Spain who has shared
high-quality positive subjects.
7. Peer-reviewed papers: papers which have shared their clinical images, such as [29] and [30].
8. Hannover Medical School dataset [31]: a GitHub repository containing images from the Institute for Diagnostic
and Interventional Radiology in Hannover, Germany.
9. Social media: images collected from Instagram pages6 .
Four resources were considered to collect normal CXRs:
1

https://radiopaedia.org
https://sirm.org/category/senza-categoria/covid-19/
3
https://eurorad.org/
4
https://figure1.com/covid-19-clinical-cases
5
http://twitter.com/ChestImaging/
6
https://www.instagram.com/theradiologistpage and https://www.instagram.com/radiology_case_reports/
2

3

COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

1. Pediatric CXR dataset [32]: AP-view CXRs of children collected from Guangzhou Medical Center, including
normal, bacterial pneumonia, and viral pneumonia cases.
2. NIH CXR-14 dataset [33]: Curated by the National Institute of Health (NIH), this large dataset has more than
100,000 images of normal chests and different abnormal lungs, including pneumonia and consolidation.
3. Radiopaedia: Other than infected cases, healthy CXRs taken for the purpose of medical check-ups are also
available in Radiopaedia.
4. Tuberculosis Chest X-ray Image Datasets [34]: Provided by U.S. National Library of Medicine, it has two
datasets containing 406 normal x-rays.
Currently, 780 images of COVID-19 patients are collected in different sizes and formats. All collected images are
publicly accessible in the dedicated repository7 . The dataset includes 5,000 normal CXRs as well as 4,600 images of
patients with CAP collected from the NIH CXR-14 dataset.

3.2

Preprocessing and Enhancements

Due to the small number of images in positive class, image augmentation is utilized to prevent overfitting. Images are
also normalized and downsized to (320, 320) to prevent resource exhaustion and decrease RAM usage. There are various
image enhancement methods based on histogram equalization that increase image contrast to make non-linearities more
distinguishable. Radiologists also use manual contrast improvement to diagnose mass and nodules better. An example
of enhancement algorithms applied on a marker-annotated CXR is shown in Fig. 2.

(a)

(b)

(c)

(d)

Figure 2: Different image enhancement methods. (a) is the main image, (b) is the image with histogram equalization
(HE), (c) is adaptive histogram equalization (AHE) applied on the image, and (d) is the image with contrast limited
AHE

As expected, Contrast Limited Adaptive Histogram Equalization (CLAHE) has better revealed nodular-shaped opacity
related to COVID-19 pneumonia. CLAHE is one of the most popular enhancement methods in different image types
[35]. Another histogram equalization-based algorithm is Bi-histogram Equalization with Adaptive Sigmoid Function
(BEASF) [36]. BEASF adaptively improves image contrast based on the global mean value of the pixels. It has a
hyperparameter γ to define the sigmoid function slope. Fig. 3 depicts the output of BEASF with different γ values.

7

COVID-19 Chest X-ray Image Data Collection. Available on: https://github.com/armiro/COVID-CXNet

4

COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

(a) Main image

(b) BEASF (γ = 0.5)

(c) BEASF (γ = 1.0)

(d) BEASF (γ = 1.5)

(e) BEASF (γ = 2.0)

(f) CLAHE

Figure 3: BEASF with different hyperparameter values compared with original image and CLAHE
Although BEASF did not result in opacity detection improvement in all of the images, it could compliment the CLAHE
method. Therefore, a BEASF-enhanced image with a γ = 1.5 is concatenated with CLAHE-enhanced and the main
images to be fed into the model.

Segmentation procedure

A U-Net based semantic segmentation [37] is also utilized to extract lung pixels from the body and the background.
A collection of CXRs with manually segmented lung masks from Shenzhen Hospital Dataset [38] and Montgomery
County Dataset [39] are used for training. The diagram of the ROI extraction block is shown in Fig. 4.

AHE

U-Net

Dilation

Crop &
Resize

Figure 4: The segmentation approach based on the U-Net
Using model checkpoints, best weights are used to generate final masks. Afterwards, edge preservation is considered by
applying dilation as well as adding margins to the segmented lung ROIs. Lung-segmented CXR is then used as the
model input.

4

Proposed Method

In this section, model development is explained in different steps. At first, a base convolutional model is designed
and trained on different portions of the dataset. Then, pretrained models based on the ImageNet dataset are discussed.
Finally, a pretrained model on a similar image type is explained.
4.1

Base Model

The base model consists of 5 convolutional layers, followed by a flatten layer and three fully connected layers. No batch
normalization or pooling layers are used for this implementation stage. Fig. 5 illustrates the base model architecture.
5

Base model diagram
COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

Conv2D

Conv2D

Conv2D

Flatten

Conv2D

Conv2D

FC

FC

Output

Figure 5: A high-level illustration of the base model
Convolution layers have 32 filters, each of which has a kernel size of 3 × 3. The activation function is set as a rectified
linear unit (ReLU), which adds non-linearity to images helping the model with better decision making. Fully connected
layers have 10 neurons, and the last layer has one neuron, which demonstrates the probability of the input image
belonging to the normal class (p = 0.0) or pneumonia class (p = 1.0).
4.2

Pretrained Models

DenseNet diagram

Transfer learning is to benefit from a pretrained model in a new classification task. Some pretrained models are trained
on millions of images for many epochs and achieved high accuracy on a general task. We experimentally selected
DenseNet and ResNet architectures pretrained on the ImageNet. A high-level illustration of the DenseNet-based model
is shown in Fig. 6.

Dense Block

Conv2D

Conv2D

Conv2D

Dense Block

Dense Block
FC

Output

DenseNet

Figure 6: DenseNet-121-based model; Input shape is (224, 224, 3) and weights are from ImageNet
It is worth mentioning that pretrained models are used for fine-tuning, training on target datasets for a small number of
epochs, instead of retraining for many epochs. Since ImageNet images and labels are different from the CXR dataset, a
pretrained model on the same data type should also be considered.
CheXNet is trained on CXR-14, a large publicly available CXR dataset with 14 different diseases such as pneumonia
and edema [40]. CheXNet claims to have a radiologist-level diagnosis accuracy, has better performance than previous
related research studies [33], [41], and has simpler architecture than later approaches [42]. CheXNet is based on
DenseNet architecture and has been trained on frontal CXRs. It also could be used as a better option for the final model
backbone. According to [33], pneumonia is correlated to other thoracic findings shown in Fig. 7.
Pneumonia

Figure 7: Co-occurrence of different CXR findings as a circular diagram by [33]
Considering these correlations, we can use a combination of CheXNet output neurons to use as the classifier without
any fine-tuning.
6

COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

4.3

The Proposed Model: COVID-CXNet

The proposed COVID-CXNet is a CheXNet-based model, fine-tuned on the COVID-19 CXR dataset with 431 layers
and ≈ 7M parameters. The architecture of the COVID-CXNet is presented in Fig. 8.

DenseNet-121
Backbone

Global Avg Pooling

Input

FC

CheXNet

DenseNet-121

Extraction

Backbone

FC

Drop Out

ROI

Output

Figure 8: COVID-CXNet model architecture based on the DenseNet-121 feature extractor as the backbone

Our proposed network uses the DenseNet-121 as its backbone. There are different architectures utilized to build
CheXNet, out of which the DenseNet has shown better capabilities for detecting pulmonary diseases [40]. COVIDCXNet has a FC layer consisting of 10 nodes followed by a dropout layer with a 0.2 dropping rate to prevent overfitting.
The activation function of the last layer is changed from SoftMax to Sigmoid because the task is a binary classification.
Our proposed model’s advantage over the base model or other custom networks is the training speed as we are finetuning a backbone with pretrained weights. In comparison with other CheXNet-based models, COVID-CXNet is
benefiting from a lung segmentation module and different image enhancements algorithms within the preprocessing
section. Moreover, fine-tuning on a larger dataset along with several overfitting-prevention methods such as dropout
layer and label smoothing will help our model outperform in terms of correctly localizing pneumonia in CXRs.

5

Experimental Results

To evaluate the performance, several metrics are considered. Accuracy score is the primary metric used for statistical
classification, which is required but inadequate here as we are more interested in efficiently classifying positive samples.
Thus, f1-score for the positive class is also measured. The main metric here is visualization heatmaps because the small
number of positive samples make the model prone to overfitting by deciding based on the wrong features. The most
common manifestations of COVID-19 pneumonia in CXRs are air-space opacities in different forms, such as GGOs or
consolidations. Opacities are identified as opaque regions (whiter than usual) in CXRs. They are mostly distinguished
as bilateral, involving both lungs, and multifocal opacifications. Rare findings happen in the late stages of disease
course, which may include pleural effusion and pneumothorax [29].
5.1

Base Model

In order to train the base model, the optimizer is set to “adam” with the optimal learning rate obtained using exponentially
learning rate increasing method [43]. The best learning rate is where the highest decreasing slope happens (≈ 0.0001).
Training the base model using 300 samples resulted in an accuracy of 96.72% on the test-set within 100 epochs. As the
dataset extended, fluctuations in the curves damped gradually. With a training-set of 480 images, it reaches a reasonable
accuracy on the test-set of 120 images. Model loss curves on the training-set and the validation-set (which is test-set
here) on different dataset sizes are plotted in Fig. 9.
7

COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

(a)

(b)

Figure 9: Learning Curves for base model trained on (a) 450 images, and (b) 600 images
The base model hit accuracy of 96.10%, relatively high compared to the number of images in the training-set, and
complexity of pneumonia identification in CXRs. To validate the performance, CNN architecture is demystified. A
popular technique for CNN visual explanation is Gradient-weighted Class Activation Mapping (Grad-CAM). GradCAM concept is to use the gradients of any target concept, flowing into the last convolutional layer to produce a
coarse localization map with a concentration on important regions in the image for predicting the class [44]. Another
visualization is Local Interpretable Model-Agnostic Explanations (LIME). LIME performs local interpretability on
input images, training local surrogate models on image components to find regions with the highest impact on the
decision [45]. Grad-CAM of the base model for images of both normal and infected classes is illustrated in Fig. 10.
pred=0.9861

label=1

pred=0.9906

label=1

pred=0.9782

label=1

pred=0.9488

label=1

pred=0.9996

label=1

pred=0.9999

label=1

Figure 10: Grad-CAM heatmaps of the base model for 6 images of positive class. Important regions are wrong in most
images, while classification scores are notably high
Although classification is successfully implemented with high accuracy score, extracted imaging features are wrong.
One possible reason could be the fact that normal CXRs are mostly for pediatrics. To go further about the problem of
the model and to prove whether it is because of the normal CXR dataset, the model was evaluated on a small external
dataset of 60 images. The confusion matrix in Table 1 shows that the model is not consistent regarding normal cases.
Table 1: Confusion matrix of the base model on external test-set
Predicted
Base Model
Normal COVID-19
Normal
21
9
Actual
COVID-19
3
27
8

COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

According to the results, recollecting CXRs from adult lungs is essential. The largest dataset containing normal cases is
the NIH CXR-14 dataset, with almost 17,000 images. Then, we increased the number of normal CXRs in the dataset to
prevent overfitting. The model is trained on a dataset of 3,400 images, 3,000 from normal and 400 from COVID-19
pneumonia classes. It is worth mentioning that classes are weighted in loss function calculation to deal with class
imbalance. The results are presented in Fig. 11 and Table 2.

(a)

(b)

(c)

Figure 11: Results of the base model trained on 3,400 images; (a) training loss changes, (b) training accuracy score
changes, and (c) receiver operating characteristic (ROC) plot

Table 2: Confusion matrix of the base model on the 683 samples
Predicted
Base Model
Normal COVID-19
Normal
598
5
Actual
COVID-19
4
76

The base model has achieved a high area under the curve (AUC) of 0.9984 and an accuracy of 98.68% while reaching
a reasonable f-score of 0.94. Model visualization shows better performance; however, there are still various wrong
regions in image explanations illustrated in Fig. 12.

(b)

(a)

Figure 12: Model interpretability visualization by (a) Grad-CAM and (b) LIME image explanation

In LIME explanation, green super-pixels contribute to current predicted class, and red super-pixels are most contributing
to the other class [45]. In Grad-CAM visualization, region importance decreases from red to blue areas.
5.2

Pretrained Models

DenseNet-121 is fine-tuned on the training-set containing normal pediatric cases for 20 epochs. The learning curve is
plotted in Fig. 13.
9

COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

Figure 13: DenseNet-121 fine-tuning curve over 10 epochs

Demonstrating bad results, the model is incapable of learning while fine-tuning only the last FC layer and freezing
feature extraction layers and overfits to the data if retrained for more epochs. As expected, ImageNet categories are
everyday objects which have somewhat non-similar features as pneumonia imaging patterns in CXRs. Hence, although
transfer learning techniques from ImageNet-pretrained models have remarkably improved segmentation accuracy thanks
to their capability of handling complex conditions, applying them for classification is still challenging due to the limited
size of annotated data and a high chance of overfitting [46]. ResNet-50 has also produced almost the same results.
Regarding CheXNet pretrained model, we first probe to see if it is capable of correctly classifying COVID-19 pneumonia
with no further improvements. Fig. 14 shows results for two sample CXRs from both classes.

(a)

(b)

Figure 14: CheXNet probabilities of different classes for (a) a COVID-19 positive case, and (b) a normal case

Extracted heatmaps reveal that CheXNet correctly marks chest lobes to determine each class probability. The output of
each class is slightly higher in positive cases for most of the diseases as well. Some of the drawbacks are extremely
high predictions for infiltration in most of the dataset images, getting stuck in regions outside lung boundaries and
predominantly in corners, and missing some of the opacities particularly in lower lobes.
5.3

COVID-CXNet

To overcome the aforementioned issues and force the model’s attention to the correct regions of interest (ROIs), we
introduce the COVID-CXNet. Our model is initialized with the pretrained weights from CheXNet. A dataset of 3,628
images, 3,200 normal CXRs and 428 COVID-19 CXRs, are divided into 80% as training-set and 20% as test-set. Batch
size is set to 16, rather than 32 in previous models, regarding memory constraints. Grad-CAMs of the COVID-CXNet
for random images are plotted in Fig. 15.
10

COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

Figure 15: Grad-CAM visualization of the proposed model over sample cases

More Grad-CAMs are available in Appendix A. Heatmaps are more accurate than previous models, while an accuracy
of 99.04% and an f-score of 0.96 are achieved. Table 3 is the confusion matrix of the proposed model.
Table 3: Confusion matrix of COVID-CXNet
Predicted
COVID-CXNet
Normal COVID-19
Normal
641
4
Actual
COVID-19
3
78

Proposed CheXNet-based model is capable of correctly classifying images. In many cases, it can localize pneumonia
findings more precisely than the CheXNet. An example is illustrated in Fig. 16.

(a)

(b)

(c)

Figure 16: Comparison between the CheXNet and the proposed model; (a) is the image with patchy opacities in the
upper left zone, (b) and (c) are heatmaps of the CheXNet and the proposed COVID-CXNet, respectively.
11

COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

Fig. 16 shows a CXR with an infiltrate in the upper lobe of the left hemithorax [47]; while CheXNet missed the region
of pneumonia, the proposed model correctly uncovered the infiltration area. One concern about COVID-CXNet results
is that it has pointed into other irrelevant regions, even outside the lungs. The same problem happens when there are
frequently-appeared texts and signs, such as dates, present in the image. Fig. 17 shows how text removal can improve
model efficiency.

(a)

(b)

(c)

(d)

Figure 17: Text removal effect on model results. Images on the right have dates and signs, which are concealed in the
images on the left.
While text removal methods can prevent overfitting, we can simply force the model to look into the lungs in order to
address both problems in one effort. To accomplish this task, a U-Net based segmentation illustrated in Fig. 4 is applied
to the input images before enhancements. Visualization results for COVID-CXNet with the ROI-segmentation block
are shown in Fig. 18.

Figure 18: Grad-CAM visualization of the proposed model, trained with lung-segmented CXRs, over sample cases.
A figure with more Grad-CAMs is attached in Appendix B. From Fig. 18, it can be observed that COVID-CXNet with
ROI-segmentation has delivered superior performance regarding the localization of pneumonia features. Worthwhile
to mention that image augmentation is expanded by adding zoom-in, zoom-out, and brightness adjustment. Label
smoothing is also applied to the loss function.
12

COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

The proposed method has shown a negligible drop in metric scores; accuracy is decreased by 0.42%, and f-score is
declined by 0.02. This decrease is a result of training with a larger dataset and accurately segmented ROIs, which means
it has become more robust against unseen samples. There is a trade-off between catching good features and higher
metric scores; while better features result in a more generalized model, high metric scores may indicate overfitting.
As an extra step, we expanded COVID-CXNet for multiclass classification between normal, COVID-19 pneumonia
(CP), and non-COVID pneumonia to examine its performance regarding the differentiation between two types of
pneumonia. CP is often appeared with bilateral findings, whereas non-COVID pneumonia or CAP mostly has unilateral
consolidations. Since most images are collected from the CXR-14 dataset, a histogram matching is applied to adjust
histograms according to a base image. The output layer is changed to have three neurons with the SoftMax activation
function. Confusion matrix is shown in Table 4.
Table 4: Confusion matrix of multiclass COVID-CXNet
Predicted
COVID-CXNet
Normal CAP CP
Normal
671
44
9
Actual
CAP
205
451
16
CP
6
12
126

Accuracy score is 81.04%, with f-scores of 0.85 and 0.76 for CP and CAP classes, respectively. In a number of
cases, especially in the first stages of virus progression, CP has unilateral findings. Also, CAP may cause bilateral
consolidations. Therefore, some cases are expected to be misclassified between CP and CAP. From the confusion
matrix, it could be seen that a relatively high number of images are misclassified between CAP and normal. A potential
reason for this issue is considered to be related to wrong labeling. Besides, some CAP CXRs are from patients with
early-stage disease development. To confirm the model performance, Grad-CAMs are plotted in Fig. 19.
pred=0.6134 pred_label= Normal

label=CAP

pred=0.5980 pred_label= CP

label=CP

pred=0.9785 pred_label= CAP

label=CAP

pred=0.8582 pred_label= CAP

label=CAP

pred=0.7725 pred_label= Normal

label=Normal

pred=0.6096 pred_label= CP

label=CAP

Figure 19: COVID-CXNet multiclass classification visualization results

The model is properly looking at one lobe for detecting CAP and both lobes for CAP and normal images. There
are some wrong labels, nevertheless. A figure containing more visualizations is found in Appendix C. To further
enhance statistical scores, a hierarchical approach is implemented. In the first level, we classify images into normal and
pneumonia classes. In the second level, pneumonia images are categorized into CP and CAP. Final confusion matrix is
illustrated in Table 5.
A slight improvement is observed. Overall accuracy is 87.21%, while f-scores are 0.92 for CP class and 0.85 for
CAP class. Although visualizations and metrics demonstrate promising performance, the effect of dataset bias is
non-negligible for wrong predictions between CAP and normal images. A dataset of 7,700 images containing 700 CP,
3,500 CAP and 3,500 normal CXRs is used in both multiclass approaches.
13

COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

Table 5: Confusion matrix of hierarchical multiclass COVID-CXNet
Predicted
COVID-CXNet
Normal CAP CP
Normal
689
32
3
Actual
CAP
143
524
5
CP
3
11
130

6

Discussions

Throughout this study, several model architectures are introduced and applied to different amounts of images. Bias to
pediatric CXRs and lung segmentation module are also addressed in different models. A comparison between these
models is shown in Table 6.
Table 6: Comparison between investigated models throughout this paper (F-score is provided for CP class only)
Dataset Pediatric
Lung
Num
Accuracy
Confidence
F-score
Model
Size
Bias
Segmentation Epochs Score (avg)
Intervals
(avg)
Base Model v1
600
Yes
No
100
96.10%
91.40 – 97.10
0.82
Base Model v2
3,400
No
No
120
98.68%
94.00 – 99.30
0.94
COVID-CXNet v1
3,628
No
No
10
99.04%
96.43 – 99.54
0.96
COVID-CXNet v2
3,628
No
Yes
10
98.62%
97.14 – 99.28
0.94
Flat Multiclass
7,700
No
Yes
30
81.04%
80.25 – 84.86
0.85
COVID-CXNet
Hierarchical Multiclass
7,700
No
Yes
10+20
87.21%
86.03 – 89.12
0.92
COVID-CXNet

Accuracy score ranges are achieved by running models ten different times. With the expansion of the dataset, confidence
intervals shrink, and metric scores slightly decline while pneumonia symptoms localization improves. Furthermore, the
proposed model is compared to other research studies discussed in section 2 regarding several criteria, such as dataset
size and f-score. The comparison is illustrated in Table 7.

Model
Zhang et al [21]
Li et al [22]
Khan et al [20]
Rajaraman et al [23]
Wang and Wang [24]
Mangal et al [25]
Proposed Model

Table 7: Comparison between proposed model and related works
Num CP Pediatric Pretrained
CP Class
Architecture
Images
Bias
Weights
F-score
Yes,
100
No
ResNet
0.72
ImageNet
Yes,
Multiple
179
No
ImageNet
Best: ShuffleNetV2
Yes,
284
Yes
Xception
0.9560
ImageNet
Yes,
Multiple (Ensemble)
313
No
0.9841
ImageNet
Best: InceptionV3
COVID-Net
358
No
No
0.9480
(Custom Architecture)
Yes,
358
Yes
DenseNet
0.9230
CheXNet
Yes,
700
No
DenseNet
0.9221
CheXNet

Lung
Segmentation
No
No
No
Yes, U-Net
No
No
Yes, U-Net

While other models have higher f-scores, they have different issues. For example, CoroNet [20] has a small dataset in
which most images are from pediatrics. The pruned ensemble method [23] also suffers from overparameterization and a
lack of proper visualization discussion in the paper. Considering the significant number of parameters of the model and
their small dataset, Grad-CAM visualizations must be investigated to a certain extent. Our proposed model is the only
study to use a lung segmentation module with a CheXNet-based fine-tuning on a relatively large dataset of CP CXRs.
14

COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

Besides, our model benefits from different approaches, such as label smoothing and hierarchical strategy, to enhance its
performance and prevent overfitting.
6.1

Dataset

Data: While DL-based methods have demonstrated promising results in medical image classification, a significant
challenge is data shortage. Since COVID-19 diagnosis using CXR images is recently becoming an interesting topic,
accessible data is limited. Data augmentation is an essential method of coping with data shortcomings. However,
designing a pneumonia detection model still needs much more CXR data. Most COVID-19 pneumonia detection
articles have very small datasets. Although [33] has claimed to introduce the largest open-access dataset of 385 CXRs,
to the best of our knowledge, our dataset of 780 COVID-19 CXRs has the most number of images.
Pediatric Bias: Many research papers have benefited from databases built upon the proposed dataset by [32]. Children
have different pulmonary anatomy. Hence, developed models based on normal pediatric and adult pneumonia images
are highly vulnerable to the "right decision with wrong reason" problem. Besides, previous studies have proved that
using various datasets containing images from different hospitals improves the pneumonia-detection results [48]. To
prevent pediatric bias, we not only collected normal CXRs from different sources. Furthermore, COVID-19 pneumonia
CXRs were collected from 9 different sources to improve cross-dataset robustness.
In the future, other information regarding patient status can be used alongside x-rays. Clinical symptoms can remarkably
help radiologists in COVID-19 differential diagnosis. Metadata could be concatenated with the input CXR and be
fed into the model to help increase its decision certainty. Providing the metadata, it is possible to have more detailed
predictions, e.g. the chance of patient survival, based on clinical symptoms and the severity of pneumonia features
presented by CXR.
6.2

Architecture

Metrics: In section 4.1 we introduced a simple base model. The purpose was to show how it can achieve very high
accuracy scores. Digging into explainability, the model revealed wrong features responsible for its excellent metric
scores. Therefore, high accuracy scores of sophisticated models from a small number of CXRs, which have high texture
complexity, are tricky. Investigation of model performance based upon confusion matrices and accuracy scores could
not be usually validated unless demonstrating appropriate localization of imaging features.
Transfer Learning: Using pretrained models with ImageNet weights, some studies such as [23] showed acceptable
heatmaps, but only a few images were visualized. While these pretrained models may help, having small dataset
sizes suggested us to fine-tune models previously trained on similar data. Our CheXNet-based model shows better
performance over ImageNet-pretrained models, while not hindered by problems like overparameterization. Besides,
lung segmentation was also performed by a U-Net based architecture previously trained on similar frontal CXRs.
Among studies conducted, there was only one article to use CheXNet as its backbone [25], which applied the model on
a fewer number of images and without lung segmentation as its image preprocessing procedure.
CheXNet: CheXNet is trained on a very large dataset of CXRs and has been used for transfer learning by some other
thoracic disease identification studies [49, 50]. However, it has its own deficiencies, such as individual sample variability
as a result of data ordering changes [51] and vulnerability to adversarial attacks [52]. Enhancing thoracic abnormality
detection in CXRs using CheXNet requires the development of ensemble models, which is currently prone to overfitting
due to the number of images from COVID-19 positive patients.

7

Conclusion

In this paper, we firstly collected a dataset of CXR images from normal lungs and COVID-19 infected patients. The
constructed dataset is made from images of different datasets from multiple hospitals and radiologists and is the largest
public dataset to the best of our knowledge. Next, we designed and trained an individual CNN and also investigated the
results of ImageNet-pretrained models. Then, a DenseNet-based model is designed and fine-tuned with weights initially
set from the CheXNet model. Comparing model visualization over a batch of samples as well as accuracy scores, we
denoted the significance of Grad-CAM heatmaps and its priority to be considered the primary model validation metric.
Finally, we discussed several points like data shortage and the importance of transfer learning for tackling similar
tasks. A final CP class f-score of 0.94 for binary classification and 0.85 for three-class classification are achieved. The
proposed model development procedure is visualization-oriented as it is the best method to confirm its generalization as
a medical decision support system.
15

COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

Data and Code Availability
A dataset of COVID-19 positive CXR images, used in this study, as well as source codes and the pretrained network weights are hosted on a public repository on GitHub to help accelerate further research studies.
https://github.com/armiro/COVID-CXNet

References
[1] WHO. (2020) Coronavirus disease 2019 (covid-19): situation report, 51. [Online]. Available: https:
//apps.who.int/iris/bitstream/handle/10665/331475/nCoVsitrep11Mar2020-eng.pdf
[2] J. P. Kanne, B. P. Little, J. H. Chung, B. M. Elicker, and L. H. Ketai, “Essentials for radiologists on covid-19: an
update—radiology scientific expert panel,” 2020.
[3] D. C. Rio, “Reverse transcription-polymerase chain reaction,” Cold Spring Harbor Protocols, vol. 2014, no. 11,
pp. pdb–prot080 887, 2014.
[4] H. X. Bai, B. Hsieh, Z. Xiong, K. Halsey, J. W. Choi, T. M. L. Tran, I. Pan, L.-B. Shi, D.-C. Wang, J. Mei et al.,
“Performance of radiologists in differentiating covid-19 from viral pneumonia on chest ct,” Radiology, p. 200823,
2020.
[5] H. Brueck. (2020) There is only one way to know if you have the coronavirus, and it involves machines full of spit and mucus. [Online]. Available:
https://www.businessinsider.com/
how-to-know-if-you-have-the-coronavirus-pcr-test-2020-1
[6] Y. H. Jin et al., “A rapid advice guideline for the diagnosis and treatment of 2019 novel coronavirus (2019-ncov)
infected pneumonia (standard version),” Military Medical Research, vol. 7, no. 1, p. 4, 2020.
[7] T. Ai et al., “Correlation of chest ct and rt-pcr testing in coronavirus disease 2019 (covid-19) in china: a report of
1014 cases,” Radiology, p. 200642, 2020.
[8] G. D. Rubin, C. J. Ryerson, L. B. Haramati, N. Sverzellati, J. P. Kanne, S. Raoof, N. W. Schluger, A. Volpi, J.-J.
Yim, I. B. Martin et al., “The role of chest imaging in patient management during the covid-19 pandemic: a
multinational consensus statement from the fleischner society,” CHEST, 2020.
[9] M. Cellina, M. Orsi, T. Toluian, C. Pittino, and G. Oliva, “False negative chest x-rays in patients affected by
covid-19 pneumonia and corresponding chest ct findings,” Radiography, 2020.
[10] B. Furlow, “Radiation dose in computed tomography,” Radiologic Technology, vol. 81, no. 5, pp. 437–450, 2010.
[11] P. Lakhani and B. Sundaram, “Deep learning at chest radiography: automated classification of pulmonary
tuberculosis by using convolutional neural networks,” Radiology, vol. 284, no. 2, pp. 574–582, 2017.
[12] M. Barstugan, U. Ozkaya, and S. Ozturk, “Coronavirus (covid-19) classification using ct images by machine
learning methods,” arXiv preprint arXiv:2003.09424, 2020.
[13] A. E. Hassanien, L. N. Mahdy, K. A. Ezzat, H. H. Elmousalami, and H. A. Ella, “Automatic x-ray covid-19 lung
image classification system based on multi-level thresholding and support vector machine,” medRxiv, 2020.
[14] N. Dey, V. Rajinikant, S. J. Fong, M. S. Kaiser, and M. Mahmud, “Social-group-optimization assisted kapur’s
entropy and morphological segmentation for automated detection of covid-19 infection from computed tomography
images,” Preprints, 2020.
[15] D. Al-Karawi, S. Al-Zaidi, N. Polus, and S. Jassim, “Ai based chest x-ray (cxr) scan texture analysis algorithm for
digital test of covid-19 patients,” medRxiv, 2020.
[16] J. C. Gomes, V. A. de Freitas Barbosa, M. A. de Santana, J. Bandeira, M. J. S. Valenca, R. E. de Souza, A. M.
Ismael, and W. P. dos Santos, “Ikonos: An intelligent tool to support diagnosis of covid-19 by texture analysis of
x-ray images,” medRxiv, 2020.
[17] F. Shan, Y. Gao, J. Wang, W. Shi, N. Shi, M. Han, Z. Xue, D. Shen, and Y. Shi, “Lung infection quantification of
covid-19 in ct images with deep learning,” arXiv preprint arXiv:2003.04655, 2020.
[18] O. Gozes, M. Frid-Adar, H. Greenspan, P. D. Browning, H. Zhang, W. Ji, A. Bernheim, and E. Siegel, “Rapid
ai development cycle for the coronavirus (covid-19) pandemic: Initial results for automated detection & patient
monitoring using deep learning ct image analysis,” arXiv preprint arXiv:2003.05037, 2020.
[19] R. M. Pereira, D. Bertolini, L. O. Teixeira, C. N. Silla Jr, and Y. M. Costa, “Covid-19 identification in chest x-ray
images on flat and hierarchical classification scenarios,” Computer Methods and Programs in Biomedicine, p.
105532, 2020.
16

COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

[20] A. I. Khan, J. L. Shah, and M. M. Bhat, “Coronet: A deep neural network for detection and diagnosis of covid-19
from chest x-ray images,” Computer Methods and Programs in Biomedicine, p. 105581, 2020.
[21] J. Zhang, Y. Xie, Y. Li, C. Shen, and Y. Xia, “Covid-19 screening on chest x-ray images using deep learning based
anomaly detection,” arXiv preprint arXiv:2003.12338, 2020.
[22] X. Li, C. Li, and D. Zhu, “Covid-mobilexpert: On-device covid-19 screening using snapshots of chest x-ray,”
2020.
[23] S. Rajaraman, J. Siegelman, P. O. Alderson, L. S. Folio, L. R. Folio, and S. K. Antani, “Iteratively pruned deep
learning ensembles for covid-19 detection in chest x-rays,” arXiv preprint arXiv:2004.08379, 2020.
[24] L. Wang and A. Wong, “Covid-net: A tailored deep convolutional neural network design for detection of covid-19
cases from chest radiography images,” arXiv preprint arXiv:2003.09871, 2020.
[25] A. Mangal, S. Kalia, H. Rajgopal, K. Rangarajan, V. Namboodiri, S. Banerjee, and C. Arora, “Covidaid: Covid-19
detection using chest x-ray,” arXiv preprint arXiv:2004.09803, 2020.
[26] M. Zompatori, F. Ciccarese, and L. Fasano, “Overview of current lung imaging in acute respiratory distress
syndrome,” 2014.
[27] A. M. Ittyachen, A. Vijayan, and M. Isac, “The forgotten view: Chest x-ray-lateral view,” Respiratory Medicine
Case Reports, vol. 22, pp. 257–259, 2017.
[28] J. P. Cohen, P. Morrison, and L. Dao, “Covid-19 image data collection,” arXiv 2003.11597, 2020. [Online].
Available: https://github.com/ieee8023/covid-chestxray-dataset
[29] A. Jacobi, M. Chung, A. Bernheim, and C. Eber, “Portable chest x-ray in coronavirus disease-19 (covid-19): A
pictorial review,” Clinical Imaging, 2020.
[30] L. Qian, J. Yu, and H. Shi, “Severe acute respiratory disease in a huanan seafood market worker: Images of an
early casualty,” Radiology: Cardiothoracic Imaging, vol. 2, no. 1, p. e200033, 2020.
[31] H. B. Winther, H. Laser, S. Gerbel, S. K. Maschke, J. B. Hinrichs, J. Vogel-Claussen, F. K.
Wacker, M. M. Höper, and B. C. Meyer, “Covid-19 image repository,” 2020. [Online]. Available:
https://github.com/ml-workgroup/covid-19-image-repository
[32] D. S. Kermany, M. Goldbaum, W. Cai, C. C. Valentim, H. Liang, S. L. Baxter, A. McKeown, G. Yang, X. Wu,
F. Yan et al., “Identifying medical diagnoses and treatable diseases by image-based deep learning,” Cell, vol. 172,
no. 5, pp. 1122–1131, 2018.
[33] X. Wang, Y. Peng, L. Lu, Z. Lu, M. Bagheri, and R. M. Summers, “Chestx-ray8: Hospital-scale chest x-ray
database and benchmarks on weakly-supervised classification and localization of common thorax diseases,” in
Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition, 2017, pp. 2097–2106.
[34] S. Jaeger, S. Candemir, S. Antani, Y.-X. J. Wáng, P.-X. Lu, and G. Thoma, “Two public chest x-ray datasets for
computer-aided screening of pulmonary diseases,” Quantitative Imaging in Medicine and Surgery, vol. 4, no. 6, p.
475, 2014.
[35] S. M. Pizer, E. P. Amburn, J. D. Austin, R. Cromartie, A. Geselowitz, T. Greer, B. ter Haar Romeny, J. B.
Zimmerman, and K. Zuiderveld, “Adaptive histogram equalization and its variations,” Computer Vision, Graphics,
and Image Processing, vol. 39, no. 3, pp. 355–368, 1987.
[36] E. F. Arriaga-Garcia, R. E. Sanchez-Yanez, and M. Garcia-Hernandez, “Image enhancement using bi-histogram
equalization with adaptive sigmoid functions,” in 2014 International Conference on Electronics, Communications
and Computers (CONIELECOMP). IEEE, 2014, pp. 28–34.
[37] O. Ronneberger, P. Fischer, and T. Brox, “U-net: Convolutional networks for biomedical image segmentation,” in
International Conference on Medical Image Computing and Computer-assisted Intervention. Springer, 2015, pp.
234–241.
[38] S. Stirenko, Y. Kochura, O. Alienin, O. Rokovyi, Y. Gordienko, P. Gang, and W. Zeng, “Chest x-ray analysis of
tuberculosis by deep learning with segmentation and augmentation,” in 2018 IEEE 38th International Conference
on Electronics and Nanotechnology (ELNANO). IEEE, 2018, pp. 422–428.
[39] S. Candemir, S. Jaeger, K. Palaniappan, J. P. Musco, R. K. Singh, Z. Xue, A. Karargyris, S. Antani, G. Thoma,
and C. J. McDonald, “Lung segmentation in chest radiographs using anatomical atlases with nonrigid registration,”
IEEE Transactions on Medical Imaging, vol. 33, no. 2, pp. 577–590, 2013.
[40] P. Rajpurkar, J. Irvin, K. Zhu, B. Yang, H. Mehta, T. Duan, D. Ding, A. Bagul, C. Langlotz, K. Shpanskaya
et al., “Chexnet: Radiologist-level pneumonia detection on chest x-rays with deep learning,” arXiv preprint
arXiv:1711.05225, 2017.
17

COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

[41] L. Yao, E. Poblenz, D. Dagunts, B. Covington, D. Bernard, and K. Lyman, “Learning to diagnose from scratch by
exploiting dependencies among labels,” arXiv preprint arXiv:1710.10501, 2017.
[42] E. Ranjan, S. Paul, S. Kapoor, A. Kar, R. Sethuraman, and D. Sheet, “Jointly learning convolutional representations
to compress radiological images and classify thoracic diseases in the compressed domain,” in 11th Indian
Conference on Computer Vision, Graphics and Image Processing (ICVGIP), 2018.
[43] L. N. Smith, “Cyclical learning rates for training neural networks,” in 2017 IEEE Winter Conference on Applications of Computer Vision (WACV). IEEE, 2017, pp. 464–472.
[44] R. R. Selvaraju, M. Cogswell, A. Das, R. Vedantam, D. Parikh, and D. Batra, “Grad-cam: Visual explanations
from deep networks via gradient-based localization,” in Proceedings of the IEEE International Conference on
Computer Vision, 2017, pp. 618–626.
[45] M. T. Ribeiro, S. Singh, and C. Guestrin, “"why should i trust you?" explaining the predictions of any classifier,”
in Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining,
2016, pp. 1135–1144.
[46] R. Godasu, D. Zeng, and K. Sutrave, “Transfer learning in medical image classification: Challenges and opportunities,” in Proceedings of the 15th Annual Conference of the Midwest Association for Information Systems, 2020,
pp. 28–2020.
[47] L. T. Phan, T. V. Nguyen, Q. C. Luong, T. V. Nguyen, H. T. Nguyen, H. Q. Le, T. T. Nguyen, T. M. Cao, and Q. D.
Pham, “Importation and human-to-human transmission of a novel coronavirus in vietnam,” New England Journal
of Medicine, vol. 382, no. 9, pp. 872–874, 2020.
[48] A. Tilve, S. Nayak, S. Vernekar, D. Turi, P. R. Shetgaonkar, and S. Aswale, “Pneumonia detection using deep
learning approaches,” in 2020 International Conference on Emerging Trends in Information Technology and
Engineering (ic-ETITE). IEEE, 2020, pp. 1–8.
[49] M. Almuhayar, H. H.-S. Lu, and N. Iriawan, “Classification of abnormality in chest x-ray images by transfer
learning of chexnet,” in 2019 3rd International Conference on Informatics and Computational Sciences (ICICoS).
IEEE, 2019, pp. 1–6.
[50] A. Sze-To and Z. Wang, “tchexnet: Detecting pneumothorax on chest x-ray images using deep transfer learning,”
in International Conference on Image Analysis and Recognition. Springer, 2019, pp. 325–332.
[51] J. R. Zech, J. Z. Forde, and M. L. Littman, “Individual predictions matter: Assessing the effect of data ordering in
training fine-tuned cnns for medical imaging,” arXiv preprint arXiv:1912.03606, 2019.
[52] S. G. Finlayson, H. W. Chung, I. S. Kohane, and A. L. Beam, “Adversarial attacks against medical deep learning
systems,” arXiv preprint arXiv:1804.05296, 2018.

18

COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

Appendices
A

More Grad-CAMs of the COVID-CXNet Model

Figure 20: Grad-CAMs from COVID-CXNet

19

COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

B

More Grad-CAMs of the COVID-CXNet Model with Lung Segmentation Preprocessing

Figure 21: Grad-CAMs from COVID-CXNet with lung segmentation module

20

COVID-CXNet: Detecting COVID-19 in Frontal Chest X-ray Images using Deep Learning A P REPRINT

C

More Grad-CAMs of the Multiclass COVID-CXNet from Different Classes
pred=0.6708 pred_label= Normal

label=Normal

pred=0.9639 pred_label=CP

label=CP

pred=0.7925 pred_label= CAP

label=CAP

pred=0.9996 pred_label= CAP

label=CAP

pred=0.9853 pred_label=CP

label=CP

pred=0.9481 pred_label=CP

label=CP

pred=0.9236 pred_label=CP

label=CP

pred=0.9678 pred_label= CAP

label=CAP

pred=0.9661 pred_label= CP

label=CAP

pred=0.6225 pred_label=CP

label=CP

Figure 22: Grad-CAMs from multiclass COVID-CXNet

21

