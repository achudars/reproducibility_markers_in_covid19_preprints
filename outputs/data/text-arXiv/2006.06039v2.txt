Activity-based contact network scaling and epidemic propagation in
metropolitan areas

arXiv:2006.06039v2 [physics.soc-ph] 31 Jul 2020

Nishant Kumar1 , Jimi B. Oke2 , and Bat-hen Nahmias-Biran3
1
2

ETH Zurich, Future Resilient Systems, Singapore-ETH Centre, Singapore 138602
Department of Civil and Environmental Engineering, University of Massachusetts,
Amherst, MA 01003, United States
3
Department of Civil Engineering, Ariel University, Ariel 40700, Israel
August 3, 2020

Abstract
Given the growth of urbanization and emerging pandemic threats, more sophisticated models are required to understand disease propagation and investigate the impacts of intervention strategies across various city types. We introduce a fully mechanistic, activity-based and
highly spatio-temporally resolved epidemiological model which leverages on person-trajectories
obtained from integrated mobility demand and supply models in full-scale cities. Simulating
COVID-19 evolution in two full-scale cities with representative synthetic populations and mobility patterns, we analyze activity-based contact networks. We observe that transit contacts are
scale-free in both cities, work contacts are Weibull distributed, and shopping or leisure contacts
are exponentially distributed. We also investigate the impact of the transit network, finding
that its removal dampens disease propagation, while work is also critical to post-peak disease
spreading. Our framework, validated against existing case and mortality data, demonstrates the
potential for tracking and tracing, along with detailed socio-demographic and mobility analyses
of epidemic control strategies.

1

Introduction
As the COVID-19 pandemic caused by the SARS-CoV-2 virus continues to ravage populations
worldwide, there is a dire need to better understand the propagation of epidemics in order to
mitigate its inimical effects in various communities. Cities, in particular, have been hit hard
due to their population density and extensive mass transit systems [1]. Governments across the
world have responded by imposing varying levels of mobility restrictions and social distancing [2].
Large amounts of data have been generated to track the spread of the disease (infection, recovery
and death rates). Given the mixed results from these interventions, more sophisticated tools are
required to enable decisionmakers to accurately predict the trajectory of the disease, as well as
model the unknown effects of mitigating strategies. Hence, agent-based simulations (ABMs) are
critical to this effort. With modern computational advances, ABMs have demonstrated great
potential in accurately tracking the spread of an epidemic at multiple levels [3]. Many of the
prior agent-based models were low-resolution and relied on broad approximations regarding the
trajectories of the populations being represented [3]. Recent high-resolution efforts, however, have
taken advantage of detailed cellphone data, as well as miscroscopic traffic simulations [4]. With a
granular representation of agent movements, more realistic epidemic simulations can be conducted.
Modeling epidemic spreading using an agent-based approach pursues the progression of a disease
through each individual, and tracks the contacts of each individual with others in the relevant social
and geographical networks [5].
Agent-based models capture the complexity of human mobility and social patterns more richly
than the classical approaches [2, 3]. Mesoscopic and microscopic transportation models provide an
even more detailed representation of the activity behavior and physical network [6]. Only recently
have these models been utilized in the study of disease propagation [3]. While the transportationbased model in [3] reasonably approximated the observed event (seasonal influenza in 2016/2017),
socio-demographic factors were not considered with regard to susceptibility. Likewise, the agent interactions during public transport usage were not considered and only a small scale demonstration
was performed (1% of the actual population of Zurich). Most recently, [4] created a contact network
from the trajectories obtained from cellphone data to study the impact of various epidemic mitigation scenarios related to COVID-19. However, they could not perform detailed contact tracing, and
only a sample of the population was used. Notably, a recent effort modeled the spatial patterns of
the Switzerland 2003/04 influenza epidemic [7]. Susceptibility varied according to two age groups
but contact duration and intensity were not included in the model. Thus, the time-resolution was
only at the day level and estimates were made regarding contacts by activity (using only a subset
of the potential contacts encountered by each individual). The spread of COVID-19 in Wuhan,
China, has also been simulated using an age and location-specific model [8]. However, this effort
did not account for the effects of transit and actual person movements.
In this study, we close the gap identified in previous efforts. We layer a mechanistic agent-based
epidemiological model (PanCitySim) onto highly time-resolved and spatially disaggregated daily
person-trajectories obtained from a microscopic travel demand and mesoscopic supply simulator,
SimMobility [6] (see Figure 1). This framework provides a realistic representation of person and vehicle movements in an average day for a full-scale city [9]. We generate activity-specific five-minute
contact graphs for the entire population and explore their scaling properties. We demonstrate how
PanCitySim can be used to not only predict the spatio-temporal dynamics of an epidemic, but
also provide detailed contact-tracing and individual-level analyses of disease impacts. The epidemiological framework is fully stochastic, taking into account the latest measurements of relevant
parameters, such as the incubation period, duration of infectiousness, and age-dependent likelihood of symptomaticity and mortality [4, 8, 10, 11]. Thus, we exploit the rich activity simulation
2

to represent the activity-based impacts of disease transmission. With PanCitySim, the impacts
of a variety of interventions can be evaluated, e.g. employment-based or age-based restrictions,
reduction in mass-transit services, night-time curfews, among others. Our framework is responsive to changes in demand and supply availabilities [12] and is thus useful for decisionmakers in
understanding and mitigating epidemic spreading in metropolitan areas.

Figure 1. PanCitySim framework. The activity- and agent-based simulator takes as an input land use
information, demographic and economic factors, as well as road and transit network information, and produces
daily activity schedules which are performed on the network to provide multi-modal trajectories for each person.
From the 5-minute person-trajectories, activity-based contact graphs are constructed. Transmission events are
simulated at this resolution. Other transitions in the SEIRD model are simulated at the end of each day.

3

Results
A recent study identified 12 urban typologies based on 69 mobility, socio-demographic, environmental and network structure obtained from over 300 cities [9]. The two auto-dependent typologies
consisting of cities largely in the US/Canada were used as the test beds for this study: Auto Sprawl
(86% car mode share) and Auto Innovative (78% car mode share). Auto Sprawl (e.g. Baltimore,
Tampa, Raleigh) typifies the lower-density US/Canada cities with low transit usage (∼4%), while
Auto Innovative (e.g. Washington D.C., Atlanta, Boston) are denser cities with an average of 11%
transit mode share. Prototype cities representing the population, land-use and mobility demand
and supply outcomes in both typologies were synthesized (see Methods and [13]). Both prototype
cities are built on actual road and transit networks, population microdata and land use categories
from representative (or archetype) cities close to the centroid of their respective typologies. For
Auto Sprawl, the archetype chosen is the Baltimore Metropolitan Area (population 2.77 × 106 ,
density 4.11 × 102 km−2 ), while for Auto Innovative, it is Greater Boston (population 4.6 × 106 ,
density 5.09 × 102 km−2 ). However, the demand and supply models for both prototype cities were
calibrated to fit average typology values, in order to ensure representativeness of overall mobility
outcomes. The spatio-temporal activity and mobility patterns of each city are shown in Figure 2.

Analysis of contact network structure
We generate an activity-based contact network for the population in each city every 5 minutes
(see Methods). The Union contact network comprises all activities for each individual: Work,
Education, Shopping, Other and Transit. In this paper, the Transit activity comprises waiting
and the duration of time spent on a bus or trrain. The spatial resolution of each contact is at
the node level (activity location) or in transit vehicle (bus/train) partitions. Figure 3a shows the
degree distribution for the Union contact network at selected times in both cities. Further, we
plot the average degree hki for each activity contact network, including the Union. We observe
that Work is responsible for the maximum average number of contacts, peaking at 10 AM with 90
contacts in Auto Sprawl and 120 in Auto Innovative. In Auto Sprawl, the activity responsible for
the second highest average number of contacts per time step is Transit with 70 contacts on average
at morning peak (8 AM) and almost 80 contacts on average at evening peak (3 PM). In Auto
Innovative, however, the activity responsible for second greatest peak contact average is Shopping
with 110 contacts per person between 4 and 5 PM.
We also plot the average weighted degree distribution hkw i (Figure 3c), weighting each edge
1
by dnm
, where dnm is the estimated distance between persons n and m at a given node at a time
step. The distribution of hkw i reveals that Transit is responsible for the closest contacts, and that
Shopping is less important than Work in terms of proximity. The difference between the average
separation of contacts in Auto Sprawl is close to two orders of magnitude. The disparity is less
stark (less than one order of magnitude) in Auto Innovative, given its greater population density).
The maximum number of people who are in contact at any given time of the day is represented by
the maximum clique size of the contact graph as shown in Figure 3d. On average, the maximum
number of contacts created in Auto Sprawl is more than 1600 between 10 and 11 AM, while for
Auto Innovative the maximum number of contacts is twice as high during the same time.

Scaling properties of time-dependent contact graphs
In order to gain further insights into the contact network structure, we plot the complementary
cumulative distribution functions (CCDF) for each time step (5 minutes) in both cities (Figure 4).

4

a

b

c

Auto Sprawl

Auto Innovative

d

Figure 2. Activity and mobility patterns in prototype cities. Spatial distribution of activity locations in a
Auto Sprawl, and b Auto Innovative. The radii of heat maps are the same across both the cities; c Number of
trips starting at various 30-minute intervals during the day; d Mode share for the two cities. Daily number of
trips in Auto Sprawl is 9.72 × 106 , while in Auto Innovative it is 16 × 106 . Both cities have a similar trip
generation rate of 3.5 per person.

5

a

Auto Sprawl

Auto Innovative

b

c

d

Figure 3. Contact network structure. a Degree distributions of the Union contact network for selected times
of day; b The average degree hki for both cities are shown over the course of the day; c The average weighted
degree hkw i for both cities are shown over the course of the day using log scale). Contacts are weighted by
average inverse distances between persons at each node; d Diameter (maximum clique size). We see that Work
accounts for the greatest number of contacts per person, particularly during the middle of the day. However, the
distribution of hkw i indicates that Transit, more than any other activity, accounts for the closest of contacts.
For clarity, plots are smoothed using a moving average of five time steps.

6

The CCDFs are shown for the Union contact graphs, as well as for each of the activities including
Transit. There are no clear patterns in the union contact graphs, but we hypothesize that the Work
β
contact network follows a Weibull distribution pk ∝ e(−λk) , while the Transit contact network
obeys the power law, p(k) ∝ k −α . Contact networks for Shopping and Other activities appear to
follow an exponential distribution pk ∝ e−λk . In order to test these null hypotheses, we conduct
Kolmogorov-Smirnov (KS) tests to determine if alternative distributions provide better fits [14].
The KS tests produce p-values based on loglikehood ratios between the alternative and null fits.
In all cases, there was no sufficient evidence to reject the null hypothesis. The fitted distributions
are assumed to be valid from a minimum degree k̂min , which is determined by minimizing the
KS-distance between observed and predicted values based on the power law fit. While this k̂min is
biased, it facilitates a consistent comparison between candidate distributions [15]. Other alternative
distributions considered were the lognormal and truncated power law.
The scale-free Transit contact graphs are fitted to pk ∝ k −α̂ , with a cut-off at k = 150. Between
8 AM and 8 PM, α̂ ≈ 1.4 in both cities. The parameter k̂min is largely time-invariant, averaging 2.4
in Auto Sprawl and 2.2 in Auto Innovative (Figure 5d). This indicates that fitted scaling patterns
take effect with a minimum of two or three contacts. For Shopping, which follows an exponential
distribution, λ̂ is similar for both cities at the same time periods. In the case of Other, however,
while the trends in Auto Sprawl and Auto Innovative are similar, λ̂ tends to be higher in Auto
Sprawl. The fitted Weibull parameters for Work diverge between both cities (Figure 5c).

Spatio-temporal evolution and age-specific impacts
We calibrated Auto Sprawl and Auto Innovative to fit the expected early dynamics of COVID-19
[8, 16, 17, 18] (see Methods). We considered the basic reproductive rate R0 (average number of
secondary infections per index case), which ranged from 2.29 to 2.57 in Auto Sprawl, and from 3.03
to 3.35 in Auto Innovative. Given the uncertainty about R0 , we also considered the time-dependent
reproduction number Rt (average number of new daily infections per infectious individuals). We
compute the five-day average of Rt as a measure of the early propagation of the epidemic, which is
0.77 in both cities (see Methods). Given these starting assumptions, we simulate the epidemic for
270 days in both cities. The peak number of infections occurs at day 27 in Auto Sprawl and at day
34 in Auto Innovative, dissipating after 150 days and 250 days, respectively. At the peak, there
are 9.21 × 104 infections (both exposed and infectious individuals) in Auto Sprawl and 1.27 × 105
infections in Auto Innovative (Figure 6b).
We plot the daily infection and mortality rates, along with Rt in Figure 6c. The infection
rate is given by the number of daily new infections as a proportion of the entire population. The
mortality rate is defined as the number of daily deaths also with respect to the entire population.
While both Auto Sprawl and Auto Innovative have similar early onset dynamics, we observe that
disease propagation diverges rapidly between both cities. In Auto Sprawl, Rt peaks at day 9, with
an average rate of change of 1.78 × 10−1 day−2 from onset to peak. Post-peak, however, the rate of
change is −9.61 × 10−3 day−2 . Furthermore, the slope of the infection rate from onset to peak (day
18) in Auto Sprawl is 5.15 × 102 day−2 . Post-peak, the rate is 4.25 × 101 day−2 . In Auto Innovative,
however, Rt peaks at day 13, with a slope of 1.99 × 10−1 day−2 from onset. Rt then dissipates
more slowly at a rate of −3.94 × 10−3 day−2 . The infection rate peaks at day 26 in Auto Innovative
(twice the amount of time as in Auto Sprawl) at a rate of 4.52 × 102 day−2 , and dissipates at a rate
of −5.44 × 101 day−2 . From onset to peak, the mortality rate is similar in both cities: 1.34 day−2
in Auto Sprawl (peak: day 28) and 1.34 day−2 in Auto Innovative (peak: day 34).
Given that we used age-specific probabilities (for symptomaticity and mortality) in our SEIRD
model, we can also observe the evolution of COVID-19 by age group in Figure 7a-d. Susceptibilities
7

a

b

Figure 4. Activity-based contact networks. Complementary cumulative distribution (CCDF) plots of
time-dependent contacts (clockwise): Union, Work, Education, Transit, Other and Shopping. a Auto Sprawl; b
Auto Innovative.

8

a

b

c

d

Figure 5. Contact network scaling. Fitted contact network degree distributions (dashed lines) compared to
observed distributions from simulation (solid lines) shown for the respective activities: Work, Shopping, Other
and Transit. Only hourly fits are displayed for clarity. a Auto Sprawl; b Auto Innovative. c Fitted parameters
for Auto Sprawl (square markers ) and Auto Innovative (diamond markers ♦). Work follows a Weibull
distribution, while Shopping and Other are fitted to exponential distributions. Transit is fitted to a power law.
Parameters are only significant within time periods shown. d Fitted k̂min for each activity (Work, Shopping,
Other and Transit). Time-dependence is exhibited for all activities except Transit.

9

are distributed as expected, with the oldest age category facing the highest fatalities. We also
consider the evolution of the epidemic by activity (Figure 7e-f). At the onset of the epidemic,
Transit activity is responsible for most of the transmissions, more so trains than buses. At peak
infection, Transit remains responsible for the greatest share of transmissions in Auto Sprawl, while
Home and Work have the greatest share in Auto Innovative (Figure 7f). In the latter stages, we
find that the greatest share of infections occurs during Work. Education is also significant in Auto
Innovative and Shopping in Auto Sprawl. The lowest impact activity is Bus transit.
We observe the spatial evolution of the epidemic in both cities (Figure 8). In Auto Sprawl, at
the onset of the epidemic, we identify several hubs, mostly located outside of the city center. These
quickly migrate to the city center by the second week, becoming stronger there, with the peak of
the disease being observed in the sixth week. In Auto Innovative, a denser city with greater transit
usage, the onset of the epidemic begins in city center, grows rapidly and spreads out to the suburbs.
The peak of epidemic observed between weeks 5 and 7, after which there is a gradual decline of in
the numbers throughout the city. We observe that towards the end of the simulation, the rate of
decline is the number of cases is much slower for Auto Innovative compared to Auto Sprawl. At the
end of our simulation period, Auto Innovative had around 10 times more active cases compared to
Auto Sprawl.

Impact of transit network on disease propagation
To test the effect of the physical transit network on the propagation of the epidemic, we remove the
Transit activity from the contact network construction in both Auto Sprawl and Auto Innovative.
Then, we simulate the same COVID-19 dynamics on these no-transit models. We compare the
SEIRD model outputs and time-dependent reproductive rates (Figure 6c). Results indicate that
Rt peaks on the first day in Auto Sprawl (average value in the first five days is 1.40), dissipating at
the rate of −7.65 × 10−3 day−2 . The removal of transit thus effectively dampens the reproduction
of the epidemic from the onset in Auto Sprawl. In Auto Innovative, Rt peaks at day 25 (compared
to day 13 in the full case), but its slope is now 4.29 × 10−2 day−2 , five times smaller than in the full
network. Thus, the force of the epidemic is also lessened in Auto Innovative by transit removal.
This effect is even more apparent when we consider the infection rates. In Auto Sprawl, the
infection rate peaks at day 86 with 1.49 × 103 per day (compared to day 18 in the full network case,
with 9.93 × 104 infections/day). Its slope (onset to peak) is 1.16 × 101 day−2 (44 times smaller than
in the full case). Meanwhile, in Auto Innovative, the infection rate peaks at day 61 with 4.54 × 103
per day (compared to day 18 in the full network cases with 1.25 × 104 infections/day). It changes
at a rate of 7.12 × 101 day−2 (6.4 times smaller than in the full case).
The force of mortality is also slowed, as daily deaths peak on day 62 in Auto Sprawl (compared
to day 28 in the full case) and on day 78 in Auto Innovative (compared to day 34 in the full case).
These results illustrate the importance of modeling the Transit contact network in detail, and the
central role that public transportation plays in spreading the virus.

Discussion
In order to establish future epidemic protection programs in large metropolitan areas, it is necessary to analyze the effectiveness of multiple interventions and epidemic control policies on a large
urban scale as well as among different communities and groups. For that purpose, we developed a
flexible and dynamic framework, PanCitySim, which is built on a modified SEIRD model combined
with an activity-based mechanistic model, which represents the urban environment and simulates

10

a

Auto Sprawl

Auto Innovative

b

c

Figure 6. Simulated evolution of COVID-19 across two prototype cities. a Log y-axis of population
states. b Exposed, infected (both asymptomatic and symptomatic cases) and deceased (cumulative). c
Time-dependent (daily) reproductive rate Rt , infection and mortality rates. The curves are smoothed with a
moving average over 5 days. The infection rate and death rate are expressed per 100,000 persons.

11

Auto Sprawl

Auto Innovative

Figure 7. Propagation of COVID-19 by age.

population mobility and human interactions. We then introduced a modified SEIRD model incorporating the latest understanding of the propagation of COVID-19. The epidemiological model
enables a computation of infection dynamics of the entire population in the city during their activities (including transit) at a 5-minute resolution. We demonstrate the use of PanCitySim and the
rich output it provides in two prototype cities representative of most urban areas in the US and
Canada (both auto dependent, but one with higher population density and greater share of mass
transit).
Crucially, we generate 5-minute activity-based contact networks for entire synthetic populations. We found the largest average contacts per individual is 90 (in Auto Sprawl) and 120 (in Auto
Innovative). We analyze the degree distributions of these networks, gaining important insights
into the mixing of populations across two prototype cities representative of the US and Canada.
Furthermore, we find that the activity contact networks follow well-known distributions describing
complex systems. Contact networks for four activity types were fitted. Significantly, Transit contacts obey the power law (α̂ ∼ 1.4 up to a maximum of 150 contacts), which is time-invariant and
constant in two distinct city types. Shopping and Other follow exponential distributions that are
also largely time-invariant. Work, on the other hand, follows a Weibull (stretched exponential) distribution with time-dependent parameters differing by city. While Work accounts for the greatest
number of contacts per person, particularly during the middle of the day, Transit, more than any
other activity, accounts for the closest of contacts.
The inclusion of demographic variables, such as gender and age, introduces levels of susceptibility in different groups of individuals which is critical for a better understanding of disease
propagation. We observed the dynamics of COVID-19 for 270 days in both cities, and found that
even if the index cases begin on the outskirts of the city, the epidemic rapidly spreads to the city
center. In both cities the epidemic peaks between days 27 and 34 with more than 9 × 104 infections,
dissipating slowly after 150 days if the city is sparse or after 250 days for a denser typology with
12

a

Day 7

Day 14

Day 21

Day 28

Day 35

Day 42

Day 49

Day 56

Day 63

Day 70

Day 77

Day 84

Day 91

Day 98

Day 105

Day 112

Day 119

Day 126

Day 133

Day 140

Day 147

Day 154

Day 161

Day 168

Day 7

Day 14

Day 21

Day 28

Day 35

Day 42

Day 49

Day 56

Day 63

Day 70

Day 77

Day 84

Day 91

Day 98

Day 105

Day 112

Day 119

Day 126

Day 133

Day 140

Day 147

Day 154

Day 161

Day 168

b

Figure 8. Spatial evolution of COVID-19. Heatmap of infected (exposed and infectious) individuals every
seven days: a Auto Sprawl; b Auto Innovative. As expected, the prevalence is greatest in city centers, regardless
of the location of index cases. In Auto Innovative, the hubs are evident.

13

more than 1.3 × 105 exposed or infected individuals.
Further, we found that at the onset of the epidemic it is crucial to restrict mass transit services
or focus interventions (such as enforcing mask-wearing by passengers) on this activity. Post-peak,
however, restrictions should be targeted towards work areas, as well as shopping centers or schools in
less dense car-oriented cities. Our approach, which is fully mechanistic and highly spatio-temporally
resolved, offers insights into the contact network structure and the importance of having a detailed
representation of population mobility. With PanCitySim, scenarios can be realistically modeled
and targeted to specific activities, ages, and employment types. We can detect the emergence of
super-spreading events and show how urban activity patterns affects the spreading of such events.
Further, there is a need to investigate the effects of network topology and reproduction rates R0
and Rt . Future work also needs to be done to understand how index case locations affects disease
propagation in urban areas.

Methods
Activity-based simulation model and city data
The simulation of the prototype cities is performed in SimMobility, an open-source platform for
microscopic demand and mesoscopic supply dynamic traffic assignment modeling [6]. It is calibrated
for modeshares, activity patterns and speeds in the cities we discuss. The calibration and validation
details are available in [13]. The activity- and agent-based simulator takes as inputs: land use,
demographic and economic factors, as well as road and transit networks. A discrete choice modeling
framework then simulates daily activity schedules (DAS) for each individual in a given synthetic
population. Parameters for population (including age, gender, employment, vehicle ownership
and household characteristics), land use and road/transit networks are obtained from a real-world
archetype city in the typology. The DAS is a high level plan, including only important choices,
which are translated into trip chains. Lower level choices are made during the day when those plans
are executed. During the day, agents are either performing an activity (Home, Work, Education,
Shopping or Other ) or executing a trip. During an activity, agents are stationary at one location
and then, at the beginning of each trip, agents further detail their plan. Once the detailed plan
is made and the start time is reached, the supply simulator moves the agent accordingly. Given
the path of each traveler, the supply simulator produces the actual movement trajectory of each
heterogeneous vehicle type and pedestrian (passenger) movements, which are performed on the
network to provide event-driven trajectories for each person.
From the 5-minute person-trajectories, activity-specific contact graphs are constructed. Transmission events are simulated at this resolution. Other disease state transitions are simulated at
the end of each day. PanCitySim is a flexible framework that can be readily integrated with other
activity-based mobility simulators. The pseudocode for the framework is provided in SI Note 6.

SEIRD model
We define the following states in our susceptible-exposed-infectious-recovered-deceased (SEIRD)
model: susceptible (S), exposed, i.e. infected but not contagious (E), infectious and symptomatic
(I S ), infectious but asymptomatic I A ), recovered (R) and deceased (D). We assume that symptomatic cases are automatically quarantined by the end of the day.

14

The transitions to each of these states are governed by the following probabilities:
φn,t = 1 − e(−Θ

P

m qm,t ·inm,t ·τnm,t

)

(1)

− d1
L

(2)

− d1
I

(3)

κn,d = 1 − e

γn,d = 1 − e

− d1

µn,d = 1 − e

D

(4)

φ is the probability of infection, where Θ is a parameter to be calibrated. Using the mechanistic
framework [4, 5], q is a measure of viral shedding rate [m3 ] and i the contact intensity [1/m3 ]. τ
is the duration of contact. The indices are m (susceptible population), n (infectious) and t (time
step). κ is the daily probability of transitioning from exposed E to infectious I {A,S} and dL is
the incubation period [8]. Furthermore, dL ∼ Lognormal(µ = 1.62, σ 2 = 0.42) [11]. The median
incubation period is taken as 5 days [11]. ρ is the probability an infectious person is symptomatic.
Thus, the transition to state I S is governed by the probability ρκ. Further, α is the proportion
of infectious people who are symptomatic, γ is the daily probability that a person recovers (dI is
the duration of infectiousness, also lognormally distributed) and µ is the mortality rate. Evidence
suggests that ρ and µ are highly age-dependent [8]. Given that case fatality rates have been shown
to differ significantly by age group, we use the values estimated by [10] to infer the number of days
from symptom onset to death dD , which is lognormally distributed with age-specific parameters.
Details of the age-specific estimation of dD (along with other SEIRD model explanations) are given
in SI Note 1.

Contact intensity
The transmission probability is explicitly dependent on the separation distance and shedding rate
[5]. With regard to distance, the contact intensity i has an inverse cube relationship. For simplicity,
we assume the shedding rate (q0 ) remains constant, but estimate the separating distance dn,m at
time step t between two persons n and m at a given physical node V based on locations which
are assumed to be normally distributed about the respective node center. We then calibrate for
a fixed contact intensity i0 , which we then scale by d31 per node and time step. For agents in
nm
transit, we partition the vehicles into squares, randomly assign passengers to each square partition,
and estimate the expected distance between randomly selected passenger pairs. When agents are
at home, we use the expected distance between inhabitants based on the average square footage of
homes in the city. Thus, the probability of transmission is given by:
(
)
X 1
φn,t = 1 − exp −Θq0 i0
· τnm,t
(5)
d3n,m
m
Further details on the modeling and estimation of inter-person distances in transit vehicles and at
activity locations are given in SI Note 2.

Contact network generation
A contact network is a collection of several contact graphs at different times of day. We generate
contact graphs at 5 minute time steps for the entire population. For generation of graphs, we use the
outputs from activity-based simulated trajectories from calibrated models of two cities. The contact
graph, at any 5 minute time window, is created by a union of three sub graphs- home, activity
15

or transit. The Home graph consists of agents who share a home during the time window. The
activity graph comprises individuals who are performing an activity (Work, Education, Shopping
or Other ). The Transit graph consists of individuals who are traveling in a bus or train or waiting
for the same. We assume that motorists make no contacts while en route to their destinations,
hence they are not modeled in our contact graph. To facilitate an efficient representation of the
contact graphs, we employ a hub-and-spoke transformation, which leverages on the sparseness of
the graphs. Details of the construction of the contact network are found in SI Note 3.

Calibration
To find Θ, we calibrate in order to achieve a basic reproductive number (average number of secondary cases caused by an infected person in the early stage of the epidemic) of R0 = 2.5 using:
R0 =

X S

P
1 XX
0
1 − e−Θ m τnm
X m n

(6)

where Θ0 = Θq0 i0 , and X is the set of index cases while S the set of secondary cases [5]. We
define R0 as the average number of new infections per initially infected person. We calibrate R0
over a period of 5 days on the full population, as this is the median duration of incubation [11].
Post calibration, R0 was equal to 2.43 ± 0.14 in case of Auto Sprawl and 3.19 ± 0.16 in case of
Auto Innovative using 30 samples for both cases (errors are 95% confidence intervals). The fiveday average of Rt (daily reproductive rate), however was 0.77 in both cities. Further calibration
considerations are noted in SI Note 4.

Validation
We partially validate the output from PanCitySim. The partial nature of the validation is due to
two facts. First, the data available for the number of infections are only partially observed. This
is attributed to the overstretching of health facilities, many cases going undetected and the cause
of death not being attributed to COVID-19 due to several reasons. Second, as soon as the general
population and the government are aware of the epidemic, several interventions are put in place to
counter the spread. Since the testing of such mitigation measures as scenarios was out of the scope
of this study, we do not fully match the reported case and mortality numbers.
We compare our prototype city simulation results with data reported from cities in the respective typologies: Auto Sprawl and Auto Innovative. Our findings are summarized in Figure 9. We
also note that these contact networks are based on weekday activity models. However, since the
framework is simulator agnostic, we can account for differences in weekend activity patterns by
incorporating relevant travel models. Finally, to improve the prediction capabilities of this framework, weather patterns should be accounted for in order to reflect appropriate multimodal impacts
on mobility and activity patterns.

Data availability
The full data set used for this study is publicly available. Given that the sizes of the data files
used in our experiments are large, we have created a demonstration data set with 30000 individuals
chosen randomly from Auto Sprawl, which can be downloaded from our Github repository for
PanCitySim: https://github.com/pancitysim/PanCitySim. The links to the file-server hosting
the full data set will also be maintained in the same location.

16

a

b

Figure 9. We compare simulation results to reported data on cases and mortalities. (a) Auto Sprawl
(simulation) compared to other U.S. metropolitan areas in the same typology (e.g. Baltimore, Austin,
Indianapolis). (b) Auto Innovative (simulation) compared to other U.S. metropolitan areas in the same typology
(e.g. Boston, Chicago, San Francisco) Validation start dates were matched with earliest record of the first death.
Data was obtained from the New York Times repository (https://github.com/nytimes/covid-19-data).

Code availability
An end-to-end working Python notebook with code and documentation of the epidemiological model
is available for public download at https://github.com/pancitysim/PanCitySim. We discuss the
computational performance of PanCitySim in SI Note 5, and provide pseudocode for the framework
in SI Note 6.

References
[1] A. R. Sahin, A. Erdogan, P. Mutlu Agaoglu, Y. Dineri, A. Y. Cakirci, M. E. Senel, R. A.
Okyay, and A. M. Tasdogan, “2019 Novel Coronavirus (COVID-19) Outbreak: A Review of
the Current Literature,” EURASIAN JOURNAL OF MEDICINE AND ONCOLOGY, vol. 4,
no. 1, pp. 1–7, 2020.
[2] W. J. McKibbin and R. Fernando, “The Global Macroeconomic Impacts of COVID-19: Seven
Scenarios,” SSRN Scholarly Paper ID 3547729, Social Science Research Network, Rochester,
NY, Mar. 2020.
[3] J. Hackl and T. Dubernet, “Epidemic Spreading in Urban Areas Using Agent-Based Transportation Models,” Future Internet, vol. 11, p. 92, Apr. 2019.
[4] S. A. Muller, M. Balmer, A. Neumann, and K. Nagel, “Mobility traces and spreading of
COVID-19,” medRxiv, p. 2020.03.27.20045302, Mar. 2020.
[5] T. Smieszek, “A mechanistic model of infection: Why duration and intensity of contacts should
be included in models of disease spread,” Theoretical Biology and Medical Modelling, vol. 6,
p. 25, Nov. 2009.
[6] M. Adnan, F. C. Pereira, C. L. Azevedo, K. Basak, M. Lovric, S. Raveau, Y. Zhu, J. Ferreira,
C. Zegras, and M. Ben-Akiva, “SimMobility: A Multi-scale Integrated Agent-Based Simulation
Platform,” in Transportation Research Board 95th Annual MeetingTransportation Research
Board, no. 16-2691, 2016/00/00.
17

[7] T. Smieszek, M. Balmer, J. Hattendorf, K. W. Axhausen, J. Zinsstag, and R. W. Scholz, “Reconstructing the 2003/2004 H3N2 influenza epidemic in Switzerland with a spatially explicit,
individual-based model,” BMC infectious diseases, vol. 11, p. 115, May 2011.
[8] K. Prem, Y. Liu, T. W. Russell, A. J. Kucharski, R. M. Eggo, N. Davies, S. Flasche, S. Clifford,
C. A. B. Pearson, J. D. Munday, S. Abbott, H. Gibbs, A. Rosello, B. J. Quilty, T. Jombart,
F. Sun, C. Diamond, A. Gimma, K. van Zandvoort, S. Funk, C. I. Jarvis, W. J. Edmunds,
N. I. Bosse, J. Hellewell, M. Jit, and P. Klepac, “The effect of control strategies to reduce
social mixing on outcomes of the COVID-19 epidemic in Wuhan, China: A modelling study,”
The Lancet Public Health, vol. 0, Mar. 2020.
[9] J. B. Oke, Y. M. Aboutaleb, A. Akkinepally, C. L. Azevedo, Y. Han, P. C. Zegras, J. Ferreira,
and M. E. Ben-Akiva, “A novel global urban typology framework for sustainable mobility
futures,” Environmental Research Letters, vol. 14, p. 095006, Sept. 2019.
[10] R. Verity, L. C. Okell, I. Dorigatti, P. Winskill, C. Whittaker, N. Imai, G. Cuomo-Dannenburg,
H. Thompson, P. G. T. Walker, H. Fu, A. Dighe, J. T. Griffin, M. Baguelin, S. Bhatia,
A. Boonyasiri, A. Cori, Z. Cucunubá, R. FitzJohn, K. Gaythorpe, W. Green, A. Hamlet,
W. Hinsley, D. Laydon, G. Nedjati-Gilani, S. Riley, S. van Elsland, E. Volz, H. Wang, Y. Wang,
X. Xi, C. A. Donnelly, A. C. Ghani, and N. M. Ferguson, “Estimates of the severity of coronavirus disease 2019: A model-based analysis,” The Lancet Infectious Diseases, vol. 0, Mar.
2020.
[11] S. A. Lauer, K. H. Grantz, Q. Bi, F. K. Jones, Q. Zheng, H. R. Meredith, A. S. Azman,
N. G. Reich, and J. Lessler, “The Incubation Period of Coronavirus Disease 2019 (COVID-19)
From Publicly Reported Confirmed Cases: Estimation and Application,” Annals of Internal
Medicine, Mar. 2020.
[12] B.-h. Nahmias-Biran, J. B. Oke, N. Kumar, C. Lima Azevedo, and M. Ben-Akiva, “Evaluating
the impacts of shared automated mobility on-demand services: An activity-based accessibility
approach,” Transportation, Apr. 2020.
[13] J. B. Oke, A. P. Akkinepally, S. Chen, Y. M. Aboutaleb, Y. Xie, C. L. Azevedo, C. Zegras,
J. Ferreria, and M. Ben-Akiva, “Evaluating the systemic effects of automated mobility-ondemand services via large-scale agent-based simulation of auto-dependent prototype cities,”
2019.
[14] J. Alstott, E. Bullmore, and D. Plenz, “Powerlaw: A Python Package for Analysis of HeavyTailed Distributions,” PLOS ONE, vol. 9, p. e85777, Jan. 2014.
[15] A. D. Broido and A. Clauset, “Scale-free networks are rare,” Nature Communications, vol. 10,
p. 1017, Mar. 2019.
[16] A. J. Kucharski, T. W. Russell, C. Diamond, Y. Liu, J. Edmunds, S. Funk, R. M. Eggo, F. Sun,
M. Jit, J. D. Munday, N. Davies, A. Gimma, K. van Zandvoort, H. Gibbs, J. Hellewell, C. I.
Jarvis, S. Clifford, B. J. Quilty, N. I. Bosse, S. Abbott, P. Klepac, and S. Flasche, “Early
dynamics of transmission and control of COVID-19: A mathematical modelling study,” The
Lancet Infectious Diseases, vol. 0, Mar. 2020.
[17] G. Lin, A. T. Strauss, M. Pinz, D. A. Martinez, K. K. Tseng, E. Schueller, O. Gatalo, Y. Yang,
S. A. Levin, E. Y. Klein, and F. t. C. M.-H. Program, “Explaining the Bomb-Like Dynamics of
18

COVID-19 with Modeling and the Implications for Policy,” medRxiv, p. 2020.04.05.20054338,
Apr. 2020.
[18] D. Gunzler and A. R. Sehgal, “Time-Varying COVID-19 Reproduction Number in the United
States,” medRxiv, p. 2020.04.10.20060863, Apr. 2020.

Acknowledgments
The authors acknowledge the support of the University of Massachusetts Amherst, Ariel University
and Singapore-ETH Centre in providing resources for carrying out this work. The authors would
also like to acknowledge the support of Prof. Martin Raubal, ETH Zurich.

Author contributions
B. N-B., J.O. and N. K. designed the study and implemented the method. N. K. implemented the
simulations. J.O. and B. N-B. supported with data acquisition. B. N-B., J.O. and N. K. analyzed
the results and wrote the manuscript.

Competing interests
The authors declare no competing interests.

19

