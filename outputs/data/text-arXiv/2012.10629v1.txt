arXiv:2012.10629v1 [stat.AP] 19 Dec 2020

Translation-invariant functional clustering on
COVID-19 deaths adjusted on population risk
factors
Amay SM Cheam1 , Marc Fredette2 , Matthieu Marbac3 , and Fabien
Navarro4
1,2

3,4

HEC Montreal, Quebec, Canada
Univ. Rennes, Ensai, CNRS, CREST - UMR 9194, F-35000 Rennes,
France
December 22, 2020

Abstract
The COVID-19 pandemic has taken the world by storm with its high infection rate.
Investigating its geographical disparities has paramount interest in order to gauge its
relationships with political decisions, economic indicators, or mental health. This paper focuses on clustering the daily death rates reported in several regions of Europe and
the United States over eight months. Several methods have been developed to cluster
such functional data. However, these methods are not translation-invariant and thus
cannot handle different times of arrivals of the disease, nor can they consider external
covariates and so are unable to adjust for the population risk factors of each region.
We propose a novel three-step clustering method to circumvent these issues. As a first
step, feature extraction is performed by translation-invariant wavelet decomposition
which permits to deal with the different onsets. As a second step, single-index regression is used to neutralize disparities caused by population risk factors. As a third step,
a nonparametric mixture is fitted on the regression residuals to achieve the region clustering. Supplementary materials for this article, including a standardized description
of the materials available for reproducing the work, are available online.

Keywords: Functional data; Mixture models; Semiparametric models; Single-index regression; Wavelets;

1

1

Introduction

In March of 2020, the World Health Organization (WHO) declared pandemic status for the
novel coronavirus SARS-Cov-2, denoted COVID-19, indicating that it has reached a critical
level of spread and severity worldwide. The global nature of COVID-19 pandemic has resulted in plenty of heterogeneity of the data, aggravated further by lack of prior knowledge or
coordinated mitigation strategies which impeded research efforts. For instance, the assumption that the first occurrence emerged concurrently everywhere is improper. Additionally,
the number of confirmed cases depends on the amount of tests that are being performed
in a region. Hence, a region that has tested very few people can only report very few confirmed cases. Alternatively, the number of COVID-19 deaths is more systematically recorded:
countries are asked to follow the ‘cause of death’ classifications from the WHO’s International Classification of Diseases guidelines (World Health Organization, 2016). Though each
country is responsible to provide their own guidance on how and when COVID-19 deaths
should be recorded, this metric remains more reliable. Undoubtedly, the rapid propagation
of this acute infectious respiratory disease has posed governmental challenges. Government
responses to contain the virus’s spread were multiple (social distancing, travel restrictions,
lockdowns, etc.) and their efficiency needs to be investigated. To better understand this
virus, it is profoundly useful to cluster regions similarly affected by COVID-19.
In this paper, we focus on clustering regions of the European Union (EU) and the United
States of America (USA) based on the daily COVID-19 deaths recorded over eight months.
Previous investigations of geographical disparities of COVID-19 (Tang et al., 2020; Chen
et al., 2020) only focus on specific geographical regions (e.g., USA). When considering regions of Europe and North America, a difficulty arises: COVID-19 outbreaks started at
different times. The misalignment of the first occurrence between regions should not be
neglected, whether between continents or within a country. Another problem to acknowledge is that the mortality occurs at different rates under different population risk factors
(Williamson et al., 2020). Hence the necessity to adjust these region-specific risk factors is
intrinsic to allow regions to be compared fairly. Furthermore, by adjusting the population
2

risk factors, we are able to detect regions more susceptible to COVID-19 and perhaps identify
the disparity factors between clusters. For instance, it allows for a retrospective assessment
of the effectiveness and the quality of government responses, a concurrent analysis of the economic indicators, and a prospective perception of mental health during this unprecedented
period.
Traditionally, clustering may be achieved through finite mixture models (McLachlan and
Peel, 2004). When the family of distributions for each cluster is unknown, nonparametric
mixtures can be considered to avoid unjustified parametric assumptions (Chauveau et al.,
2015). A classical approach among these methods is to define the density of each mixture component as a product of univariate densities (Hall and Zhou, 2003; Kasahara and
Shimotsu, 2014). The data we analyze are functional and thus raise the problem of data
dimension (Ferraty and Vieu, 2006; Ramsay and Silverman, 2007). To circumvent the curse
of dimensionality, many model-based clustering approaches approximate the observed functions in some functional basis then perform clustering on the coefficients related to the basis
(see the review of Jacques and Preda (2014) or Cheam and Fredette (2020)). For instance,
Bouveyron et al. (2015) proposed to approximate the curves into a Fourier basis expansion
coefficients and then perform clustering on the obtained coefficients with a Gaussian mixture. Alternatively, feature extraction can also be accomplished via an orthogonal wavelet
basis (Antoniadis et al., 2013).
In this article, we propose a novel three-step approach that circumvents the issues of
the region clustering based on COVID-19 dataset: the varying times of arrivals of the virus
and the need to incorporate the population risk factors. This approach is named Clustering Regression residuals of Features given by Translation Invariant Wavelets (CRFTIW).
The first step of CRFTIW consists of feature extraction using a multiscale approach based on
translation-invariant (TI) wavelets (Coifman and Donoho, 1995), which allows the shifted
onsets of COVID-19 to be tackled by avoiding any pre-processing step for curve alignment
(see Wang and Gasser (1997) and the references cited in Jacques and Preda (2014, Section
2.3)). The objective to construct clusters that are invariant to time-shifts is somewhat dif-

3

ferent from conventional clustering in that it permits us to answer slightly different scientific
questions about the data. Standard clustering (no time-shifts) will identify regions that peak
at the same period, while TI clustering recovers regions that react in similar behavior patterns that unravel across time. The features are defined as the logarithm of the norm of the
TI wavelet coefficients at each scale. The second step of CRFTIW integrates the population
characteristics with a single-index regression of the features on the population risk factors.
This approach has the benefits of the nonparametric regression but does not suffer from the
curse of dimensionality. Moreover, the empirical likelihood (Qin and Lawless, 1994; Owen,
2001) permits the significance of the estimators to be investigated (Zhu and Xue, 2006), even
when dependency between observations occurs (Du Roy de Chaumaray et al., 2020). We
show that the residuals of the regression preserve the cluster information. As the third step
of CRFTIW, clustering of the regions is achieved by fitting a nonparametric mixture on the
regression residuals. The only assumption made at this step is to define the density of each
component as a product of univariates densities.
The remainder of this article is organized as follows. Section 2 presents the data. Section 3
defines the new approach CRFTIW. Section 4 illustrates, with numerical experiments, the
relevance of CRFTIW. In Section 5, we analyze the geographical disparities of the COVID19 by investigating the regression coefficients, by describing the clusters according to the
diseases and by illustrating the use of the clusters to investigate policy strategies. Section 6
presents some concluding remarks.

2

Description of the data

For this ongoing COVID-19 dataset, we consider n = 78 regions between two continents: the
26 countries within the EU plus the United Kingdom and the 50 states of the USA plus the
District of Columbia. There are differences in time of arrival of the peak death rates between
regions. This is illustrated by Figure 1 which shows that New Hampshire and Pennsylvania
have noticeably more delayed peaks than France and United Kingdom.
Our focus is on the curve Wi = (Wi(1) , . . . , Wi(T ) )> recording the daily rate of the number
4

Daily CoVid-19 death rate per million

region

France

New Hampshire

Pennsylvania

United Kindgom

15

10

5

0
2020 Apr 01

2020 Jul 01

2020 Oct 01

Figure 1: Illustration of different arrivals of the COVID-19 among the different regions.
of deaths per million people in each region i for a total of T = 256 days (between March 14
to November 24, 2020, inclusively), where Wi(t) denotes the death rate recorded for region
i at time t. Data were extracted from the Center for Systems Science and Engineering at
Johns Hopkins’ Github repository (Badr et al., 2020) and a 7-day moving average has been
performed due to the discrepancy of the data recorded by each region. For instance, this
can account for days in the week where data may not be available, such as weekends.
Early findings suggested that differences in COVID-19 disease prevalence and severity
may be associated with certain risk factors (Williamson et al., 2020). For each region i, we
store in Xi ∈ R4 the indicator of four population risk factors based on WHO statements:
Overweight, Diabetes, Pulmonary and Kidney. Overweight indicates the crude prevalence
of overweight adults defined by the body mass index (Kang et al., 2020) while Diabetes
indicates the age-adjusted prevalence of diabetes (Barron et al., 2020; Holman et al., 2020).
Both data, expressed as a percentage of the population and recorded in 2016, can be accessed
from the Center for Disease Control and Prevention (2020) and World Health Organization
(2020), respectively for the US and the EU. Pulmonary indicates the prevalence of chronic
obstructive pulmonary disease (COPD). Although Attaway et al. (2020) found no significant
increases in the rate of COVID-19 between COPD and non-COPD patients, the authors

5

noticed significantly higher rates of hospitalization, ICU admissions and invasive mechanical
ventilation in COPD patients. Finally, Kidney indicates the prevalence of chronic kidney
disease. Williamson et al. (2020) demonstrated that patients with severe form of chronic
kidney disease have higher rates of COVID-19-related deaths than the other known high-risk
groups. Pulmonary and Kidney are available on the Global Burden of Disease Collaborative
Network (2020)’s database, were age-adjusted and given in percentages for 2019. For ease
of interpretation, the population risk factors have been scaled.

3

Method

3.1

Outline of the three-step method

The daily COVID-19 death curves of the n regions W1 , . . . , Wn are supposed to independently
arise from L different clusters. The cluster membership of region i is defined by the latent
variable Zi = (Zi1 , . . . , ZiL )> where Zi` = 1 if region i belongs to cluster ` and Zi` = 0
otherwise. The model assumes that, conditionally on the cluster `, each Wi is defined as a
product between a noisy version of δi -lagged values of an unobserved curve u` and the effect
of the population risk characteristics µ(Xi ) > 0, where Xi denotes population risk factors
of region i and where we set E[µ(Xi )] = 1, for identifiability reasons. The deterministic
functions u` do not depend on the covariates Xi . Moreover the noises εi` and the covariates
Xi are independent. Thus, given the cluster membership and the population risk factors of
region i, we have
Wi =

L
X

(δ )

(δ )

zi` µ(xi )(u` i + εi` i ),

(1)

`=1
(δ )

(δ )

where u` i and εi` i are δi -lagged versions of u` and εi` , and the distribution of each εi` follows
a centered distribution having a finite variance defined by the density f` (i.e., Ef` [εi` ] = 0
and Ef` [ε2i` ] < ∞). Thus, the conditional distribution of Wi given Xi = xi is defined by the
density
f (wi | xi ) =

L
X


π` f `

`=1

6


wi
(δi )
− u`
,
µ(xi )

(2)

where π` > 0 is the proportion of cluster ` with

PL

`=1

π` = 1.

Despite the model defined by (2) permitting a clustering of the regions based on the
daily COVID-19 death curves with respect to the population risk factors, the estimation
the multivariate densities f` is highly complex. Thus, we achieve the clustering with the
following three-step approach:
1. Perform feature extraction of the daily COVID-19 death curves Wi to obtain Yi ∈ RJ+1
using TI wavelets (see Section 3.2).
2. Fit single-index regressions of the features Yi on the population risk factors Xi and
consider the residuals ξˆi ∈ RJ+1 (see Section 3.3).
3. Use the nonparametric mixture to cluster the regions based on the residuals ξˆi (see
Section 3.4).
This approach is relevant since the specific feature extraction reduces the dimension, permits
us to deal with lagged values and keeps the main cluster information. Moreover, the singleindex regression keeps the cluster information of the features, allows for adjustment on
population risk factors, and provides meaningful parameters used for detecting protective or
compounding effects of the population characteristics and odd ratios.

3.2

Feature extraction and time misalignment

A wavelet basis is a set of functions obtained as translations and dilatations of two specific
functions: a scaling function denoted by φ and a mother wavelet denoted by ψ. For the
purpose of this paper, we use Daubechies wavelets and in particular the Symmlet family.
Such wavelets are optimal in the sense that they have minimal support for a given number
of null moments. We present the essentials below; more details can be found in Daubechies
(1992) or Mallat (2008).
The decomposition of the observations in a given wavelet basis is defined by
j

Wi (t) = αi,0,0 φ0,0 (t) +

J−1 2X
−1
X
j=0 k=0

7

βi,j,k ψj,k (t),

t ∈ [1, T ].

√ RT
with J = log2 (T ), φj,k (t) = 2j/2 φ(2j t−k), ψj,k (t) = 2j/2 ψ(2j t−k), αi,0,0 ≈ T 1 Wi (t)φ0,k (t)dt
√ RT
and βi,j,k ≈ T 1 Wi (t)ψj,k (t)dt are the empirical wavelet coefficients of the ith individual.
A discrete wavelet transform (DWT) corresponds to the computation of these coefficients. In
practice, a fast wavelet decomposition and reconstruction algorithm can be computed using
the algorithm proposed by Mallat (1989) (in only O(T ) operations). As mentioned in the
introduction, a simple shift in the observed function will potentially result in a significant
change in the DWT. Since we use the latter for feature extraction and the observed curves
can start at different times, such behavior is not suitable.
In the TI case, we consider the fast translation-invariant discrete wavelet transform
(TIDWT) developed by Coifman and Donoho (1995), in a denoising framework. The main
difference with the orthogonal case is that the dictionary is now a tight frame instead of an
orthonormal basis (see (Mallat, 2008, Chapter 5)) and the number of coefficients per scale
is no longer dyadic but of length T (see Coifman and Donoho (1995) for more details). This
wavelet transform is called translation-invariant since the whole dictionary is invariant under
circular translation. More precisely, for a vector w of size T , let Sh denotes the circulant
shift by h defined by (Sh w)(t) = w(t + h) modulo T . As in the traditional case, TIDWT
is calculated by a series of decimation and filtering operations, only the additional circulant
shift Sh is added and the corresponding wavelet dictionary is obtained by sampling the locations more finely (i.e., one location per sample point). TIDWT consists of calculating the
DWT of the shifted data for each shift h ∈ {0, . . . , T − 1}. Coifman and Donoho (1995)
propose an algorithm to perform this transformation in O(T log2 T ) operations (we used
the R package rwavelet which provides an implementation Navarro and Chesneau (2020)).
The invariance property of their construction is formally expressed in terms of the circulant
matrix containing the wavelet coefficients (see (Coifman and Donoho, 1995, eq. (3))). In
other words, for a curve Wi translated by h the wavelet coefficients at each scale will be the
same up to some permutation. Thus the norm of the latter is preserved scale by scale.
The redundancy of TIDWT makes it possible to detect the presence of hidden information such as stationary or non-stationary patterns as well as their location, making it

8

particularly suitable for clustering purposes. This type of invariant representation has been
exploited in many applications (such as denoising Coifman and Donoho (1995) or texture
image classification and segmentation Unser (1995)). In addition, the use of wavelets allows
to compress the information contained in the time series into a small number of wavelet coefficients. Following Antoniadis et al. (2013), we characterize each time series by the vector of
the energy contribution of their wavelet coefficients at each scale with the difference that the
coefficients are calculated by TIDWT instead of DWT. This extension is possible because
the expansion being in a tight frame, the norm is also conserved (see (Mallat, 2008, Chapter
11) for more details). More precisely, using Parseval’s identity, we have
kWi k22

−J

=2

T −1
X

2
αi,0,k

k=0

+

J
X
j=1

−j

2

T −1
X

2
βi,j,k

−J

=2

kθi0 k22

+

J
X

2−j kθij k22 ,

(3)

j=1

k=0

where θij = (αi,0,0 , . . . , αi,0,T −1 , βi,j,0 , . . . , βi,j,T −1 )> and the factor 2−j is used to compensate
for the redundancy of this representation. Thus, denoting by yij the log total norm at scale
j for the ith individual, we have
yij = ln (kθij k2 ) ,

∀j = 0, . . . , J,

i = 1, . . . , n.

(4)

Clustering will therefore be carried out on the basis of the log norm of the TI wavelet
coefficients at each scale. Thus, this criterion is not sensitive to the origin of the curves, so
it seems relevant given the nature of the data motivating this work.

3.3

Adjustment on the population risk factors

In this section, we consider the regressions of the features extracted by the wavelet decomposition on the population risk factors. The following lemma shows that the noises of these
regressions retain the cluster information given by the daily COVID-19 death curves and
permit the information of the population risk factors to be considered in the clustering procedure. Note that the same nonparametric function is used for the regression of each feature
(i.e., j = 0, . . . , J). Thus, the lemma shows how the regression function is estimated based
on the n × (J + 1) observations.
9

Lemma 1. Let data arise from (2) and features are defined by (4). Defines the noise of the
regression ξi = (ξi1 , . . . , ξid )> for j = 0, . . . , J as
yij? = m(xi ) + ξij ,

(5)

with
E[m(Xi )] = 0 and E[ξij ] = 0,
where xi and ξij are independent, yij? = yij − ∆j , m(xi ) = ln µ(xi ) − E[ln µ(Xi )], ∆j =
P
E[ln µ(Xi )] + L`=1 π` E[ 12 ln kv`j + ε?i`j k22 ], and v`j and ε?i`j are the features of u` and εi` , respectively (their formal definition is given in the proof of the lemma presented in Apprendix).
Then, the noises ξi follow a mixture model with latent variable Zi defined by the density
g(ξi ) =

L
X

π` g` (ξi − λ` ),

`=1

where λ` = (λ`1 , . . . , λ`J )> , λ`j = E[ 12 ln kv`j + ε?i`j k22 ] − ∆j + E[ln µ(Xi )] and g1 , . . . , g` are
densities of centered distributions.
We consider the single-index regression defined by
m(xi ) := ν(x>
i γ).

(6)

This semiparametric approach is flexible, and avoids the assumptions of the parametric approaches that can be violated and the curse of dimensionality of the full nonparametric
approaches. The parameter of the index γ permits population characteristics having a protective or compounding effect to be detected. Moreover, considering two sets of covariates
Xi and Xi0 , the difference ν(Xi> γ) − ν(Xi>0 γ) can be interpreted as the logarithm of an odd
ratio.
The single-index approach requires a methodology for estimating γ and m, with m being
in a function space. A common approach, that avoids a simultaneous search involving an
infinite-dimensional parameter, is the profiling (Severini and Wong, 1992; Liang et al., 2010),
which defines ν(x>
i γ) := νγ with
νγ (t) = E[Yij? | Xi> γ = t],

j ∈ {0, . . . , J} and t ∈ R.
10

(7)

Hence, one expects that, for each xi , the true value of the parameter, denoted by γ realizes
the minimum of
γ 7→

J
X

2
E[{Yij? − νγ (x>
i γ)} | Xi = xi ].

(8)

j=0

However, even if mγ is well defined for any γ ∈ Rd , the vector γ is not identifiable and only
its direction could be consistently estimated. Thus, there are two common approaches to
restrict γ for identification purposes: either fix one component equal to 1 (Ma and Zhu, 2013),
or set the norm of γ equal to 1 and fix the sign of its first component to be positive (Zhu
and Xue, 2006). The estimation of the single-index regressions is performed by considering
the empirical counterpart of (7) and (8)
γ̂ = arg min
γ

n
1X
?
ŷij = yij −
yij ,
n i=1

n
X

2
ŷij? − ν̂γ (Xi> γ) ,

i=1

and ν̂γ (u) =

 >

Xi γ−u
?
ŷ
K
i=1 ij
h
 >
 ,
P
Xi γ−u
n
1
K
i=1
nh
h

1
nh

Pn

where K is a kernel and h a bandwidth. The estimation procedure is implemented in the
R package regpro (Klemela, 2016). The clustering of the regions is also performed on the
residuals ξˆi = (ξˆi0 , . . . , ξˆiJ )> defined by
ξˆij = ŷij? − ν̂γ̂ (Xi> γ̂).

3.4

Nonparametric clustering of the regions

A wide range of literature focuses on models assuming that, conditionally on knowing the
particular cluster the subject i came from, its features are independent (Chauveau et al.,
2015). Thus, we consider that the conditional distribution of the ξˆi given cluster membership
is defined as a product of univariate densities. Note that this assumption imposes non-explicit
constraints on the distribution of the noises εi defined in (1). Therefore, the clustering of
the region is performed by considering the marginal density defined by
g(ξˆi ; λ) =

L
X

π`

`=1

11

J
Y
j=1

g`j (ξˆij ),

(9)

where λ groups the mixing proportions π1 , . . . , πL (where π` > 0 and

PL

`=1

π` = 1) and the

univariate densities g`j . The model (9) is identifiable, up to a swapping of the cluster labelling, if the densities g`j are linearly independent (see Theorem 8 of Allman et al. (2009)).
Considering a multivariate kernel defined as a product of J univariate kernels K, the maximum smoothed log-likelihood estimator λ̂ (MSLE) is obtained by maximizing the smoothed
log-likelihood `(λ) (Levine et al., 2011), such that
λ̂L = arg max `(λ; L)
λ

and
`(λ; L) =

n
X

ln

( L
X

i=1

where
N g`j (ξˆij ) = exp

π`

Ωj

1
K
hj

)
N g`j (ξˆij ) ,

j=1

`=1

(Z

J
Y

ξˆij − u
hj

!

)
ln g`j (u)du ,

and h1 , . . . , hJ are the bandwidths (i.e., hj > 0 and hj = o(1) for j = 1, . . . , J). Considering
the MSLE is more convenient than considering the maximum likelihood estimate because
the MSLE can be obtained by a Majorization-Minimization algorithm (see Levine et al.
(2011) for details on the algorithm and Zhu and Hunter (2016) for recent developments)
implemented in the R package mixtools Benaglia et al. (2009).
Clustering is achieved by computing the MSLE because this estimator permits a soft
assignment where the conditional probability that subject i belongs to cluster `, denoted by
ti` (λ̂), can be obtained
N ĝ`j (ξˆij )
.
QJ
ˆ
`0 =1 π̂`0
j=1 N ĝ`0 j (ξij )

ti` (λ̂L ) = PL

π̂`

QJ

j=1

Moreover, a hard assignment can be achieved by applying the maximum a posteriori rule
(leading that ẑi` = 1 if ` = arg max`0 ti` (λ̂) and ẑi` = 0 otherwise).

4

Numerical experiments

Simulation set-up Data are independently generated from (1), (2) and (6) with T = 256,
K = 3 and unequal proportions such that Zi ∼ M(0.5, 0.25, 0.25), a function characterizing
12

class k defined by
u`(t) = r`(t) 1{r`(t) >0} with r`(t)



t
,
= a`(t) sin b` π
T

with a1(t) = 1, b1 = 2.5, a2(t) = (1 + ς), b2 = 2.5, a3(t) = (1 + ς1{t>128} ) and b3 = 2.5 − ς
where ς = 0.3. In the attempt to replicate regions’ patterns, we devise the three components
such that each represents the severity level of COVID-19: moderate throughout, heavy
throughout, and moderate during the first wave but drastically more affected in the second
wave. Moreover, the lapse between the two waves of the disease is shorter for class 3. We
use a heteroscedastic noise defined by εik(1) ∼ N (0, 0.22 ), where the conditional distribution
of εi`(t) | Fi , with Fi the natural filtration, is equal to the conditional distribution of εi`(t) |
εi`(t−1) where


εi`(t) | εi`(t−1) ∼ N 0, 0.2 +

2
0.2ε2i`(t−1)



.

The bivariate vector of covariates Xi = (Xi1 , Xi2 )> is composed of two independent standard
√
√
Gaussian random variables and µ(Xi ) := ν(Xi> γ) with γ = [1/ 2 1/ 2]> . To illustrate
the benefits of CRFTIW, we consider the following three scenarios, where the first mimics the
situation of the COVID-19 daily death curves:
• Scenario 1 (translations and covariates): there is a shift and an effect of the covariates
since we set δi = 50 with probability 0.5 and δi = 0 otherwise, and ν(a) = (1+ς(a2 −1)).
• Scenario 2 (only covariates): there is no shift but an effect of the covariates since we
set δi = 0 and ν(a) = (1 + ς(a2 − 1)).
• Scenario 3 (only translations): there is a shift but no effect of the covariates since we
set δi = 50 with probability 0.5 and δi = 0 otherwise, and ν(a) = 1.
For each scenario, we generate 100 replicas by considering three sample sizes: 50, 100 and
250. All nonparametric estimations are done using a Gaussian kernel with a bandwidth
Cn−1/5 where C represents the empirical standard deviation of the variable considered by
the kernel.

13

Method comparison Results of CRFTIW are compared to those of the following methods:
• depIntra is similar to CRFTIW but clustering is performed by a mixture considering
the within component dependencies (Zhu and Hunter, 2019). This model challenges
the assumption of a product decomposition of the component densities made in (9).
• noTI is similar to CRFTIW but the feature extraction is performed with orthogonal
wavelets commonly used for wavelet-based clustering (Antoniadis et al., 2013). This
model allows to illustrate the advantages of TI wavelets.
• noCov is similar to CRFTIW but considers that µ(xi ) = 1. This model illustrates the
importance of considering the population risk factors.
• adjustFirst fits the estimators (µ̄, γ̄) of the regression of W̄i =

1
T

PT

t=1

Wi(t) on

Xi , then uses (9) to cluster the features provided by Step 1 of CRFTIW applied on
Wi /µ̄(x>
i γ̄). This model justifies the relevance of the order between Steps 1 and 2 of
CRFTIW.
• funFEM is a standard approach to cluster functional data (Bouveyron et al., 2015)
implemented in the R package funFEM (Bouveyron, 2015). We use this approach
on the curves adjusted with the covariates Wi /µ̄(x>
i γ̄), a decomposition in a Fourier
basis with 25 elements and the arguments of the function funFEM are model=’AkjBk’,
init=’kmeans’, lambda=0 and disp=TRUE. Thus, this model investigates the relevance
of the order between Steps 1 and 2 of CRFTIW, and the choice of a nonparametric
clustering.
Clustering accuracy In all scenarios considered, clustering accuracy of the competing
methods is measured using the Adjusted Rand Index (ARI, Hubert and Arabie (1985))
between the estimated partition and the true partition shown in Figure 2. The results show
that by considering a more complex model than (9) for clustering is not relevant. Indeed,
CRFTIW and depIntra provide similar results for large samples but CRFTIW is more accurate
for small samples. Recall that for our COVID-19 study, the sample size is 78 regions and we
14

50

100

250
Scenario 1
Scenario 2

ARI

Sample size
1.00
0.75
0.50
0.25
0.00
1.00
0.75
0.50
0.25
0.00
1.00
0.75
0.50
0.25
0.00

Scenario 3

CRFTIW

DepIntra

noTI

noCov

adjustFirst

funFEM

Method

Figure 2: Boxplot of the ARI obtained by the competing methods.
can argue that the model given by (9) is more suitable than a complex model. From Scenarios
1 and 3, the method noTI reveals that it is imperative to consider a feature extraction that is
invariant to time-shifts. Thus, CRFTIW can handle remarkably well situations with different
arrival times. When considering the case of population risk factors, such as Scenarios 1 and
2, it is essential to take into account the effects of covariates to fit the partition (see the
poor results of noCov under these scenarios). Moreover, it seems to be more pertinent to
estimate the covariate effects after performing the feature extraction in presence of timevarying arrivals (i.e., CRFTIW outperforms adjustFirst and funFEM under Scenarios 1 and
3).
Covariate effect accuracy The estimation of the covariate effects is a major issue for
the COVID-19 application. Indeed, it is essential to properly adjust the covariate effects in
order to obtain accurate clusters. Moreover, the parameters and the shape of the function µ
make it possible to assert the impact of population risk factors on the death rates. Indeed,
the parameters of the index facilitate the interpretation of the population characteristics by
distinguishing whether it has a protective or compounding effect. Figure 3(a) shows the
dispersion of the estimators of γ1 around the true value of these parameters, for Scenarios 1
15

and 2. These results illustrate the consistency of the procedure. Note that, as shown by the
results of adjustFirst, the accuracy of the regression parameters is slightly better when
they are obtained directly from the original data and not from the features given by the
wavelet decomposition.
50

100

Sample size

250

50

100

250
scenario 1

0.10
0.05
0.00
-0.05
-0.10
-0.15

0.3
scenario 1

0.2
0.1

eν̂,γ̂

0.3

0.10
0.05
0.00
-0.05
-0.10
-0.15

scenario 2

γ̂1 − γ1

Sample size

0.2
0.1

scenario 3

scenario 2

0.09
0.06
0.03

CRFTIW

noTI

adjustFirst

CRFTIW

method

noTI

adjustFirst

method

(a) scenarios with covariate effect

(b) the three scenarios

Figure 3: Boxplot of γ̂1 − γ1 (a) and eν̂,γ̂ (b) obtained by the competing methods.
Considering two sets of covariates Xi and Xi0 , the difference ν(Xi> γ) − ν(Xi>0 γ) can be
interpreted as the logarithm of an odds ratio. To investigate the accuracy of the estimator
ν̂(x>
i γ̂), we consider the quantity em̂,γ̂ defined by
eν̂,γ̂

n
n

2
1 XX
>
>
>
= 2
ν̂(x>
γ̂)
−
ν̂(x
γ̂)
−
ν(x
γ)
−
ν(x
.
γ)
0
0
i
i
i
i
n i=1 i0 =1

Figure 3(b) depicts the boxplots of eν̂,γ̂ obtained from the three scenarios. Thus, the results
reflect the consistency of the approach. Moreover, when there is no effect of the covariates,
the convergence of the estimators is much faster. However, in the presence of covariate effects, the accuracy of estimators remains the same with or without a translation. Therefore,
we conclude that the translation does not increase the difficulty of the estimation of covariates. Finally, note that despite adujstFirst having slightly better parameter estimates, the
effects of the covariates (parameters and nonparametric functions) are better estimated with
CRFTIW.
16

5

Investigating geographical disparities for COVID-19

The proposed approach allows risk factors to be taken into account. This is a major issue
when comparing regions with respect to COVID-19 daily deaths. Indeed, the adjustment
on population risk factors enables us to confirm its role (protective or compounding; see
Section 5.1). Moreover, this adjustment permits similarities and disparities of the disease
impacts to be detected, conditionally on the population characteristics (see Section 5.2).
Finally, it allows an a posteriori comparison of the clusters with respect to different policy
decisions. (e.g., lockdown characteristics; see Section 5.3).

5.1

Population risk factors

The estimated coefficients of the single-index regression are given in Table 1 (row γ̂ ). To
investigate their significance (i.e., coefficients are not zero), we use an empirical likelihood
(EL) approach. Indeed, from Du Roy de Chaumaray et al. (2020), Wilks’ theorem holds
for the empirical likelihood ratio for semiparametric regressions with weakly dependent data
(note that we have n = 78 groups of 8 dependent data because each region provides 8
observations used for the coefficient estimation). Thus, we fit the parameters by assuming
that one coefficient is zero, then we test the estimated value with the EL approach (see
Tests 1-4). Results claim that all the coefficients are significant. All the coefficients in γ̂ are

Table 1: Estimator of γ obtained considering all coefficients as significant (γ̂) and estimators
obtained assuming that one coefficient is zero (Tests 1-4) with p-value obtained by EL.
Overweight

Diabetes

Pulmonary

Kidney

p-value

γ̂

0.626

0.581

0.431

0.291

0.194

Test 1

0.000

0.490

0.611

0.622

0.000

Test 2

0.595

0.000

0.580

0.557

0.000

Test 3

0.693

0.490

0.000

0.529

0.000

Test 4

0.470

0.785

0.403

0.000

0.000

17

0.6

1.25

1.00

density

µ̂(Xi> γ̂)

0.4

0.75

0.2
0.50
0.0
-1

0

1

-1

Xi> γ̂

0

1

Xi> γ̂

Figure 4: Estimator of the impact of the population risk factors µ̂ (on the left) and density
of the index Xi> γ̂ (on the right).

positive. We need to draw the estimated function µ̂ to interpret the impact of these factors
on the COVID-19 daily deaths.
Figure 4 shows the estimator of the µ̂ and the density of the index for a range of the
index covering 90% of the observed index (this trimming, only performed for this plot, avoids
over-interpretation of the curve due to extreme points). This figure confirms that overweight
BMI classification, diabetes, COPD and kidney diseases are factors increasing the COVID-19
mortality. These results are in agreement with the main mortality risk factors identified in
medical publications (see Zhou et al. (2020, Table 1) and Gupta et al. (2020, Figure 2)).
We now illustrate the impact of the adjustment on the population risk factors. Table 2
shows the population risk factors and the index of three regions: France, United Kingdom
and Ireland. For example, France and Ireland have a population that is less at risk than
the United Kingdom. Taking population risk factors into consideration is vital in order to
properly compare the impact of the disease on different regions. Considering the population
risk factors is a major key point to compare the impact of the disease on different regions.
Figure 5 shows the COVID-19 daily death curves without considering the population risk
factors (on the left) and when considering the population risk factors (on the right). Thus,
if population characteristics were neglected, one can claim that the first wave of the disease

18

Table 2: Population risk factors, index and effect of the population risk factors of three

Region

Overweight

Diabetes

Pulmonary

Kidney

Xi> γ̂

µ̂

France

1.90

-0.53

-2.02

-1.82

-0.52

0.69

United Kingdom

0.81

-0.71

0.86

-2.02

-0.13

1.05

Ireland

0.27

-0.95

0.50

-1.00

-0.46

0.74

region

FRA

GBR

15

10

5

0
2020 Apr 01

2020 Jul 01

region

IRL

Daily CoVid-19 death rate with covariates adjustment

Daily CoVid-19 death rate without covariates adjustment

regions (France, United Kingdom and Ireland).

2020 Oct 01

FRA

GBR

IRL

20

15

10

5

0
2020 Apr 01

2020 Jul 01

2020 Oct 01

Figure 5: COVID-19 death curves without considering the population risk factors (left) and
by considering the population risk factors (right) for France, United Kingdom and Ireland.

(April-May 2020) is similar for these three regions. However, considering the population
risk factors, we see that France and Ireland were impacted more greatly than the United
Kingdom.

5.2

Clustering of the regions

Clustering is performed by considering a number of clusters between one and ten. Selecting
the number of clusters is still a difficult task in nonparametric mixtures. Indeed, despite
recent works (Kasahara and Shimotsu, 2014; Kwon and Mbakop, 2020) presenting elegant
methods for selecting the number of clusters based on the constraint of linear independence

19

between the univariate densities required for model identifiability (Allman et al., 2009), these
methods require large samples to perform well (see Section 5 of Kwon and Mbakop (2020)).
Because we only have 78 regions, we cannot use these methods and thus select the number
of clusters by looking for an elbow in the values of the smoothed log-likelihood. These values
are presented in Table 3; we focus on the five-clusters partition (note that the difference of
`(λ̂L ; L) obtained with consecutive L is greater than 17 if L < 5, otherwise these differences
are less than 13; however other number of clusters could be considered).
Table 3: Maximum smoothed log-likelihood `(λ̂L ; L) with respect to the number of clusters.
L

1

2

3

4

5

6

7

8

9

10

`(λ̂L ; L)

-1034

-894

-815

-791

-774

-767

-754

-743

-733

-734

NO

IS
FI

ME

WA
VT

ND

MT

MN

NH
NY

OR

WI
ID

SE

SD

MA
RI
CT

EE

MI
WY

PA
IA
NE

NV

IN
WV

CO
KS

IE

VA

KY

MO

NL

CA

NC
TN
OK
AZ

NM

DK

GB

MD
DC DE

OH
IL

UT

LV

NJ

Cluster

SC

AR

BE
LU

AL

GA

CZ
AT

1

MS

PL

DE

FR

2

CH

SI

LA

HR

3

TX

4
FL

IT

5

AK

RO
RS

PT

ES
GR

HI

CY

Figure 6: Clustering results.

We now describe the clusters based on summary statistics presented in Table 4 and the
curves adjusted with the population risk factors (Wi /µ̂(Xi> γ̂)). Figure 6 presents the cluster
memberships of each region and Figure 7 presents the curve for one region per cluster and to
illustrate our cluster interpretation. The labels of clusters are ordered by the impact of the
20

Daily COVID-19 death rate
with covariates adjustment

region

Cluster-1

Cluster-2

Cluster-3

Cluster-4

Cluster-5

30

20

10

0
2020 Apr 01

2020 Jul 01

2020 Oct 01

Figure 7: Example of COVID-19 daily death curves adjusted with covariates adjustment
Wij /µ̂(Xi> γ̂). One example per cluster: Maine (Cluster 1), Germany (Cluster 2), Missouri
(Cluster 3), France (Cluster 4), New Jersey (Cluster 5).

COVID-19 during the studied period. Thus, cluster 1 has the smallest mean of COVID-19
daily death rates over the studied period and cluster 5 has the highest mean. These results
Table 4: Statistics per cluster
cluster

proportion

Normalized deaths

Covariate effect

π`

mean

sd.

mean

sd.

1

0.12

206.88

144.21

0.98

0.28

2

0.25

363.05

155.64

0.87

0.36

3

0.41

636.17

202.51

1.08

0.26

4

0.16

813.50

267.38

0.92

0.28

5

0.07

1314.06

203.31

1.21

0.08

were expected because the distribution of µ̂(Xi> γ̂) is supposed to be the same among clusters.
Clusters can be interpreted, as follows:
• Cluster 1 contains only nine regions that are mainly unaffected from the disease (five
countries of EU and four states of USA).

21

• Cluster 2 contains eighteen regions (seven countries of EU and twelve states of USA)
weakly affected by the disease over the whole period except the end where the number
of deaths starts to increase.
• Cluster 3 contains 33 regions (eight countries of EU and twenty-five states of USA)
moderately impacted by the disease as only one wave of high-death rate is observed.
• Cluster 4 contains thirteen regions strongly impacted by the disease (six countries of
EU and seven states of USA). The waves of the high death rate period are characterized
by a slow decreasing of the number of deaths when the peak is reached.
• Cluster 5 contains five regions dramatically impacted by the disease (Belgium and four
states of USA) especially during the first wave of the disease whose peak is characterized
by an abrupt increase of the rate of death.

5.3

Clusters analysis example: disparities and policy decisions

Amid unforeseen difficulties related to COVID-19, policymakers have resorted to various
interventions in attempts to curb the spread of the coronavirus. As seen in Sections 5.1
and 5.2, by adjusting the risk factors, the proposed approach allows us to detect vulnerable
regions and compare them fairly. Additionally, the homogeneity within cluster enables us to
analyze the disparities in factors between clusters; for instance, in this paper, we are looking
at the government responses. Note that one may also be interested to study the COVID-19’s
impact on the population mental health or the economic indicators.
Figure 8(a) shows the distribution of the value for each indicator, i.e., containment
health, government response and stringency, with respect to its clusters. As we observe,
the difference between the first four clusters is not noticeable for each indicator, but the
indicators take larger values for regions of cluster 5 (containing the most impacted regions).
The same phenomenon is observed for the specific measures adopted by the governments
presented in Figure 8(b).

22

1

2

3

4

cluster

5
3

70

2

value

value

cluster
80

60

1

2

3

4

5

1

50
0
40
-1
Containment health Government response

Stringency

C1

index

C2

C3

H2

H3

index

(a)

(b)

Figure 8: Boxplot of the overall indicator values for each cluster (a) and for specific measures
adopted for each cluster (b): School closing (C1), Workplace closing (C2), Cancel public
events (C3), Testing policy (H2) and Contact tracing (H3).
Cluster 5, which was strongly affected by the virus, seems to take more stringent measures
than the other regions. One plausible explanation is that the policymakers may abruptly
enforce restrictive countermeasures in hopes to lower the increasing mortality rate, thus the
observed steep descent. Hence, the effectiveness of government response may depend on the
timing of the measure’s implementation, the duration and the stringency (Cheng et al., 2020;
Haug et al., 2020). To further understand the relationship between the mortality rate and
the various policies adopted in reaction to the COVID-19, a more precise analysis can be
achieved by fitting a model for multivariate non-stationary time series per clusters (the time
series being the daily death rate and the index mentioned above). Thus, a description of the
relation between the government responses and the COVID-19 death curve can be done using
the model parameters. This can be achieved by modelling the dependencies between the time
series (Molenaar et al., 1992; Sanderson et al., 2010) or by a multiple change-point detection
(Cho and Fryzlewicz, 2015). Moreover, a comparison of the government interventions to
COVID-19 can be conducted by comparing the models fitted for each cluster.

23

6

Conclusion

This paper introduces CRFTIW, a new method to cluster functional data when observations
are shifted and external covariates are allowed to have a scale effect. CRFTIW is a three-step
approach developed for the purpose of analyzing geographical disparities of the COVID-19
impact (measured by the daily number of deaths per million people).
As a first step of CRFTIW, feature extraction is performed with TI wavelets. While
providing an adapted and compact representation of the data, it also permits us to deal
with the different times of arrivals of the disease. The main limitation of this approach lies
in the dyadic data constraint of the considered sample. This issue could be overcome, for
example, by using second generation wavelets and in particular the lifting scheme (Sweldens
(1998)), but would lose the property of translation-invariance. However, extending this
construction, while preserving both the property of translation-invariance and the property
of conservation of the norm of the coefficients, seems to be an open question that we leave
for future work.
As a second step of CRFTIW, the effect of the population risk factors on the extracted
feature is estimated and thus regions can be compared as if they have the same sensitivity of
the population to the disease. This step is crucial because we aim to investigate the impact
of policy decisions. Obviously, if the purpose is to investigate geographical disparities of
the impact of the disease, then no adjustment on the population risk factors should be
considered. In such case, CRFTIW can still be used by considering µ(Xi> γ) = 1. In the
analysis of COVID-19, we consider four main factors of comorbidity (overweight, diabetes,
chronic pulmonary and kidney diseases). These factors are well-known to increase the risk
of COVID-19 mortality, (Zhou et al., 2020; Gupta et al., 2020) and Wilks’ theorem for the
empirical likelihood permits us to conclude on the significance of the estimated coefficients.
However, we advise considering factors already known to be compounded for the disease, and
not to use CRFTIW to investigate the impact of population risk factors. Indeed, CRFTIW does
not perform variable selection of the population risk factors and does not permit concluding
on causality of the factors.
24

As a third step of CRFTIW, a nonparametric mixture is used to achieve the clustering
with the assumption that the density of the component is defined as a product of univariate
densities. Numerical experiments presented in the paper suggested that considering a more
complex model deteriorated the results when the sample size is small (like in the COVID-19
application). However, if the data to be analyzed are composed of several observations, more
advanced models could be used (Mazo and Averyanov, 2019; Zhu and Hunter, 2019).
Through the COVID-19 dataset, we had illustrated the importance of adjusting the
population risk factors, allowing us to compare regions with a ‘standard’ comorbidity. Thus,
CRFTIW found five clusters justified by the mortality rate and curvature. Regions within
clusters are varied geographically with different onsets, validating the property of translationinvariance of the proposed method. In addition, as we illustrated, investigations on the
effectiveness and agility of government response, the consequences on economic indicators
or the impact on human mental health, could be achieved by studying disparities of the
indicators between clusters.
Driven by the COVID-19 dataset, we developed this novel approach. However, its application is not limited only to COVID-19. For instance, the problem of time-shifts is also
observed in electrocardiogram heartbeat, which Annam et al. (2011) tackle when clustering
heartbeat abnormalities. Our approach could not only handle the time-shift issue, but also
allow for adjusting with regards to plausible factors that may influence the heart-beat. Further, this could extend beyond medical settings: in motion capture (Li and Prakash, 2011),
there is interest in categorizing types of motion. This could be used for fitness applications
to identify whether a person is running or walking, where the motions may begin at different
times on separate observed sequences showing a need for the TI property. Since motion can
come from different participants, covariate adjustment could also be beneficial for such data.

References
Allman, E. S., Matias, C., and Rhodes, J. A. (2009). Identifiability of parameters in latent
structure models with many observed variables. The Annals of Statistics, 37:3099–3132.
25

Annam, J. R., Mittapalli, S. S., and Bapi, R. S. (2011). Time series clustering and analysis
of ecg heart-beats using dynamic time warping. In 2011 Annual IEEE India Conference,
pages 1–3.
Antoniadis, A., Brossat, X., Cugliari, J., and Poggi, J.-M. (2013). Clustering functional data
using wavelets. Int. J. Wavelets Multiresolution Inf. Process., 11:1350003.
Attaway, A., Zein, J., and Hatipouglu, U. (2020). Sars-cov-2 infection in the copd population
is associated with increased healthcare utilization: An analysis of cleveland clinic’s covid19 registry. EClinicalMedicine, 26:100515.
Badr, H. S., Zaitchik, B. F., Kerr, G. H., Colston, J. M., Hinson, P., Chen, Y., Nguyen, N. H.,
Kosek, M., Du, H., Dong, E., Marshall, M., Nixon, K., and Gardner, L. M. (2020). Unified
covid-19 dataset. https://github.com/CSSEGISandData/COVID-19 Unified-Dataset.
Barron, E., Bakhai, C., Kar, P., Weaver, A., Bradley, D., Ismail, H., Knighton, P., Holman,
N., Khunti, K., Sattar, N., Wareham, N., Young, B., and Valabhji, J. (2020). Associations of type 1 and type 2 diabetes with covid-19-related mortality in england: A
whole-population study. The Lancet Diabetes Endocrinology, 8:813–822.
Benaglia, T., Chauveau, D., Hunter, D., and Young, D. (2009). mixtools: An r package for
analyzing finite mixture models.
Berkner, K. and Wells Jr., R. O. (2002). Smoothness estimates for soft-threshold denoising
via translation-invariant wavelet transforms. Appl. Comput. Harmon. Anal., 12:1–24.
Bouveyron, C. (2015). funfem: clustering in the discriminative functional subspace.
Bouveyron, C., Côme, E., and Jacques, J. (2015). The discriminative functional mixture
model for a comparative analysis of bike sharing systems. Ann. Appl. Stat., 9:1726–1760.
Center for Disease Control and Prevention (2020). Data & statistics. available at https:
//www.cdc.gov/DataStatistics.

26

Chauveau, D., Hunter, D. R., and Levine, M. (2015). Semi-parametric estimation for conditional independence multivariate finite mixture models. Statistics Surveys, 9:1–31.
Cheam, A. S. and Fredette, M. (2020). On the importance of similarity characteristics of
curve clustering and its applications. Pattern Recognition Letters, 135:360 – 367.
Chen, J., Yan, J., and Zhang, P. (2020). Clustering us states by time series of covid-19 new
case counts with non-negative matrix factorization.
Cheng, C., Barceló, J., Hartnett, A., Kubinec, R., and Messerschmidt, L. (2020). Covid-19
government response event dataset (coronanet v.1.0). Nat. Hum. Behav., 4:756–768.
Cho, H. and Fryzlewicz, P. (2015). Multiple-change-point detection for high dimensional
time series via sparsified binary segmentation. J. R. Stat. Soc. Ser. B Methodol., pages
475–507.
Coifman, R. R. and Donoho, D. L. (1995). Translation-invariant de-noising, pages 125–150.
Springer New York, New York, NY.
Daubechies, I. (1992). Ten lectures on wavelets, volume 61. Siam.
Du Roy de Chaumaray, M., Marbac, M., and Patilea, V. (2020). Wilks’ theorem for semiparametric regressions with weakly dependent data.
Ferraty, F. and Vieu, P. (2006). Nonparametric functional data analysis. Springer Series in
Statistics, New York.
Global Burden of Disease Collaborative Network (2020). The global health data exchange.
http://ghdx.healthdata.org/gbd-results-tool. Seattle, United States.
Gupta, S., Hayek, S. S., Wang, W., Chan, L., Mathews, K. S., Melamed, M. L., Brenner,
S. K., Leonberg-Yoo, A., Schenck, E. J., Radbel, J., et al. (2020). Factors associated with
death in critically ill patients with coronavirus disease 2019 in the us. JAMA Intern. Med,
180:1436–1446.
27

Hall, P. and Zhou, X.-H. (2003). Nonparametric estimation of component distributions in a
multivariate mixture. The Annals of Statistics, 31:201–224.
Haug, N., Geyrhofer, L., Londei, A., Dervic, E., Desvars-Larrive, A., Loreto, V., Pinior,
B., Thurner, S., and Klimek, P. (2020). Ranking the effectiveness of worldwide covid-19
government interventions. Nat. Hum. Behav., 4:1303–1312.
Holman, N., Knighton, P., Kar, P., O’Keefe, J., and Curley, M. (2020). Risk factors for covid19 related mortality in people with type 1 and type 2 diabetes in england: a populationbased cohort study. Lancet Diabetes Endocrinology, 8:823–833.
Hubert, L. and Arabie, P. (1985). Comparing partitions. Journal of Classification, 2:193–218.
Jacques, J. and Preda, C. (2014). Functional data clustering: a survey. Advances in Data
Analysis and Classification, 8:231–255.
Kang, Z., Luo, S., Gui, Y., Zhou, H., Zhang, Z., Tian, C., Zhou, Q., Wang, Q., Hu, Y.,
Fan, H., and Hu, D. (2020). Obesity is a potential risk factor contributing to clinical
manifestations of covid-19. International Journal of Obesity, 44:2479–2485.
Kasahara, H. and Shimotsu, K. (2014). Non-parametric identification and estimation of the
number of components in multivariate mixtures. J. R. Stat. Soc. Ser. B Methodol., pages
97–111.
Klemela, J. (2016). regpro: Nonparametric regression. R package version 0.1.1.
Kwon, C. and Mbakop, E. (2020). Estimation of the number of components of non-parametric
multivariate finite mixture models. Annals of Statistics (to appear).
Levine, M., Hunter, D. R., and Chauveau, D. (2011). Maximum smoothed likelihood for
multivariate mixtures. Biometrika, 18:403–416.
Li, L. and Prakash, B. A. (2011). Time series clustering: Complex is simpler! In ICML.

28

Liang, H., Liu, X., Li, R., and Tsai, C.-L. (2010). Estimation and testing for partially linear
single-index models. Ann. Statist., 38(6):3811–3836.
Ma, Y. and Zhu, L. (2013). Doubly robust and efficient estimators for heteroscedastic
partially linear single-index model allowing high-dimensional covariates. J. R. Stat. Soc.
Ser. B Methodol., 75:305–322.
Mallat, S. G. (1989). A theory for multiresolution signal decomposition: the wavelet representation. IEEE transactions on pattern analysis and machine intelligence, 11:674–693.
Mallat, S. G. (2008). A wavelet tour of signal processing: the sparse way. Academic press.
Mazo, G. and Averyanov, Y. (2019). Constraining kernel estimators in semiparametric copula
mixture models. Computational Statistics & Data Analysis, 138:170–189.
McLachlan, G. J. and Peel, D. (2004). Finite mixture models. John Wiley & Sons.
Molenaar, P. C., De Gooijer, J. G., and Schmitz, B. (1992). Dynamic factor analysis of
nonstationary multivariate time series. Psychometrika, 57(3):333–349.
Navarro, F. and Chesneau, C. (2020). R package rwavelet: Wavelet analysis. Version 0.4.1.
Owen, A. B. (2001). Empirical likelihood. Chapman and Hall/CRC.
Qin, J. and Lawless, J. (1994). Empirical likelihood and general estimating equations. The
Annals of Statistics, 22:300–325.
Ramsay, J. O. and Silverman, B. W. (2007). Applied functional data analysis: methods and
case studies. Springer.
Sanderson, J., Fryzlewicz, P., and Jones, M. (2010). Estimating linear dependence between nonstationary time series using the locally stationary wavelet model. Biometrika,
97(2):435–446.
Severini, T. A. and Wong, W. H. (1992). Profile likelihood and conditionally parametric
models. The Annals of Statistics, 20:1768–1802.
29

Sweldens, W. (1998). The lifting scheme: A construction of second generation wavelets.
SIAM Journal on Mathematical Analysis, 29:511–546.
Tang, C., Wang, T., and Zhang, P. (2020). Functional data analysis: An application to
covid-19 data in the united states.
Unser, M. (1995). Texture classification and segmentation using wavelet frames. IEEE
Transactions on Image Processing, 4:1549–1560.
Wang, K. and Gasser, T. (1997). Alignment of curves by dynamic time warping. The Annals
of Statistics, 25:1251–1276.
Williamson, E., Walker, A., Bhaskaran, K., et al. (2020). Factors associated with covid-19related death using opensafely. Nature, 584:430–436.
World Health Organization (2016). Icd-10 : International statistical classification of diseases
and related health problems : tenth revision.
World

Health

Organization

(2020).

The

global

health

observatory.

https://www.who.int/data/gho/data/indicators.
Zhou, F., Yu, T., Du, R., Fan, G., Liu, Y., Liu, Z., Xiang, J., Wang, Y., Song, B., Gu,
X., Guan, L., Wei, Y., Li, H., Wu, X., Xu, J., Tu, S., Zhang, Y., Chen, H., and Cao, B.
(2020). Clinical course and risk factors for mortality of adult inpatients with covid-19 in
wuhan, china: A retrospective cohort study. The Lancet, 395:1054–1062.
Zhu, L. and Xue, L. (2006). Empirical likelihood confidence regions in a partially linear
single-index model. J. R. Stat. Soc. Ser. B Methodol., 68:549–570.
Zhu, X. and Hunter, D. R. (2016). Theoretical grounding for estimation in conditional
independence multivariate finite mixture models. J. Nonparametr. Stat., 28:683–701.
Zhu, X. and Hunter, D. R. (2019). Clustering via finite nonparametric ica mixture models.
Advances in Data Analysis and Classification, 13:65–87.

30

A

Proof of Lemma 1

Proof of Lemma 1. We consider the matrix representation for the discrete wavelet transform.
For the orthogonal case, the discrete transform of a vector w ∈ RT is represented by an T ×T
orthogonal matrix M (see, e.g., Mallat (2008)).
>



φ(1) ψ0,0 (1) . . . ψJ−1,2J −1 (1)


..
..
 .

M =  ..
 .
.
.


φ(T ) ψ0,0 (T ) . . . ψJ−1,2J −1 (T )
In the translation-invariant case, the downsampling of the locations k is discarded at each
scale j, and the decomposition can thus be written as follows
Wi (t) =

T −1
X

αi,0,k φ0,k (t) +

J−1 X
T −1
X

βi,j,k ψj,k (t),

t ∈ [1, T ],

i = 1, . . . , n.

j=0 k=0

k=0

The matrix representation is therefore given by an (J +1)T ×T matrix M which corresponds
to the row-wise concatenation of the J, T × T matrices which yield the wavelet coefficients
at scale j plus the matrix which produces the scaling coefficients (see, e.g., Berkner and
Wells Jr. (2002); Coifman and Donoho (1995) for a full representation, in terms of filters).
The representation at scale j for Wi given zi is defined by Mj Wi where Mj denotes either
the T × 2j or the T × T wavelet transform matrix at scale j, for j = 0, . . . J. Thus, we have
Mj Wi =

L
X

i
h
(δ )
(δ )
zi` Mj µ(xi )(u` i + εi` i .

`=1

Therefore, the logarithm of the total energy at scale j for Wi given zi is given by
!
" L
#
L
X
X
1
π` kv`j + ε?i`j k22 ,
yij = ln µ2 (xi )
zi` kv`j + ε?i`j k22 = ln µ(xi ) + ln
2
`=1
`=1
(δ )

(δ )

where v`j = Mj u` i and ε?i`j = Mj εij i . Considering the centered version of the elements
leads to (5). Noting that the noise of the regression follows a mixture model where the
latent variable is zi (i.e., the same latent variable that the one use to defined the marginal
distribution of Wi ), permits to conclude that clustering the noise of the regression obtained
31

for the different scale is relevant to cluster the curves Wi . Finally, noting that by assumption
Xi is independent to Zi and εi` and that ε?i`j is defined as a combination of the original εi`
permits to concluded on the independence between Xi and ε?i`j .

32

