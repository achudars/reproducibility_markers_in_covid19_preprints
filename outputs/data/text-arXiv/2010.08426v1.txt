arXiv:2010.08426v1 [q-bio.PE] 13 Oct 2020

The impact of school reopening strategies during
COVID-19: A case study of São Paulo, Brazil
E. H. M. CRUZ 1∗ , J. M. MACIEL1 , C. CLOZATO1 ,
M. S. SERPA2 , P. O. A. NAVAUX2 , E. MENESES3,4 ,
M. ABDALAH3 , M. DIENER5
1
2

Campus Paranavaı́, Federal Institute of Parana (IFPR), Paranavaı́, Brazil

Informatics Institute, Federal University of Rio Grande do Sul (UFRGS), Porto Alegre, Brazil
3
Costa Rica National High Technology Center, Costa Rica
4
5

∗

Costa Rica Institute of Technology, Costa Rica

University of Illinois at Urbana-Champaign, USA

To whom correspondence should be addressed; E-mail: eduardo.cruz@ifpr.edu.br

Address: IFPR Campus Paranavaı́ – Rua José Felipe Tequinha, 1400 – Jardim das Nações
Paranavaı́-PR, Brazil – Postal code 87703-536

COVID-19 School Reopening Strategies

1

During the COVID-19 pandemic, many countries opted for strict public health
measures, including closing schools. They have now started relaxing some of
those restrictions. To avoid overwhelming health systems, predictions for the
number of new COVID-19 cases need to be considered when choosing a school
reopening strategy. Using computer simulation, we analyze different strategies to reopen schools in the São Paulo Metropolitan Area, including the official reopening plan. Our results indicate that reopening schools with all students at once has a big impact on the number of new COVID-19 cases, which
could cause a collapse of the health system. On the other hand, a controlled
school reopening avoids the collapse of the health system, with a maximum
ICU occupancy between 48.8% and 97.8%, depending on how people attending school follow sanitary measures. Postponing the schools’ return date for
after a vaccine becomes available can save up to 37,753 lives just in the São
Paulo Metropolitan Area.

2

Introduction
In December 2019, a novel coronavirus disease (COVID-19) emerged in Wuhan, China [1],
and has since spread out to the rest of the world, evolving into a pandemic [2]. Due to its
high infection rate, the virus SARS-CoV-2 is not only causing mortality, but it is also stressing
national health systems due to the large number of infected people that need hospitalization,
also causing a profound economic impact [3–5]. In the absence of a vaccine or an effective
treatment for COVID-19, the role of public health measures mostly comprehends the so-called
non-pharmaceutical interventions (NPIs) [6], including social distancing and isolation, reducing economic activities, enforcing home office, moving to remote classes and closing social
venues where people tend to agglomerate in close proximity. Initially, sanitary authorities opted
for strict NPIs. As the pandemic evolved, other factors emerged and started an interplay with
the health crisis. Therefore, measures were revisited and, oftentimes, relaxed. However, a critical question is still unresolved: What is the impact of reopening the school system for in-person
classes [7, 8]?
When to start reopening schools and the reopening policy are particularly important questions for multiple reasons: i) education is a basic human necessity; ii) in-person classes enable
other economic activities because parents can go to work while their children are at school [9],
besides other markets associated with schools, such as transportation, food, clothing, among
others; iii) in-person classes are often hard to replace with online learning, especially in developing countries and for impoverished families, due to lower availability of broadband Internet
and fast laptop computers with cameras; iv) due to the relatively long time children spend in
proximity to each other in schools, the potential for exposure is much higher, requiring several
workarounds to reduce the transmission rate [10], especially because young people tend to be
asymptomatic while carrying high viral loads [11], which increases the chances of an exponen-

3

tial transmission growth, thereby requiring additional quarantines to prevent a health system
collapse; and v) a well-crafted policy for returning to school may help preventing new waves
of the pandemic, save lives, and reduce the amount of psychological stress due to the health
crisis [12]. To understand the impact of the pandemic on schools and develop policies to deal
with it, mathematical and computer simulation modeling is crucial [13].
In this work, we set out to evaluate a range of strategies for opening the school system of
the São Paulo Metropolitan Area (SPMA) using computer simulation. We chose this region as
a case study because Brazil is one of the current epicenters of the pandemic [14, 15], and the
SPMA is the most relevant of the country due its huge population and economical importance.
The region contains 39 cities and 21.7 million inhabitants, representing about 10% of Brazil’s
population [16]. We analyze 3 different strategies of school reopening: (i) reopen schools with
all students at once; (ii) reopen schools following a strategy based on the official plan of the São
Paulo government [17], which consists of 3 stages, carefully increasing the amount of students
in each stage; and (iii) reopen schools only when a vaccine becomes available. We show results
regarding the total amount of COVID-19 cases, critical cases and number of deaths.

Materials and Methods
Most models to analyze pandemics employ compartmental models, such as SIS, SIR, SEIR or
SEIHR [18]. However, the assumptions of homogeneous random mixing in those models can
lead to wrong projections. Also, the effects of non-pharmaceutical interventions (NPIs) [6] are
difficult to implement in those models. To overcome these issues, we developed a heterogeneous
and dynamic network stochastic model [19–21]. The model was implemented as a simulator
written in the C++ language, which was chosen due its high performance, low overhead and
powerful object-oriented features. The network was modeled as an undirected graph G =
(V, E), in which the vertices V represent the people and the edges E the relations between
4

people, which have an infection rate. Given two people v1 and v2 , such that v1 ∈ V and v2 ∈ V ,
if we have an edge e ∈ E such that e = (v1 , v2 ), the person v1 can infect the person v2 . To
support heterogeneous infection rates, we color the edges of the graph, such that we can attribute
different infection rates for each color. The color represents the type of relation. Although it is
possible to have any kind of relations modeled, for this work we modeled the following relation
types: home, community, workplace, schools and Inter-city.
Since our model supports heterogeneous networks, it can provide a better representation of
the population [22]. Each person can have an arbitrary number of edges in the graph, and the
relation type (color) of each edge is also arbitrary. Therefore, as in real life, each person can
have different infection rates depending on the number of relations they have, as well as the
type of each relation. Since each person has a different infection rate, each person also has a
different basic reproduction rate (R0 ). Therefore, to set the overall R0 , we calibrate the infection
rates over the entire network such that the average R0 among all people is equal to the target
value. As our model supports dynamic networks, we can change relations at any time during
the simulation. We are able to modify the infection rates, as well as add and remove edges from
the graph. This is useful to implement sanitary interventions.
We based our model in the SEIR compartmental model [18], but extended it to support more
compartments. Each person can be in one of the following states:
Susceptible The person can be infected.
Infected The person is currently infected. An infected person can have different sub-states, as
we will explain later.
Immune The person is immune, either from recovering from the disease or from taking a
vaccine. The person will not contract the disease anymore.
Dead The person died.

5

As for infected people, each one can be in the following sub-states:
Incubation The person was infected but has not developed any symptoms yet and is not contagious.
Unreported The person is contagious but either is asymptomatic or has such light symptoms
that it does not receive any health care. This person, in real life, would not be part of any
official statistics, hence a sub-notified case.
Pre-symptomatic The person is contagious, but did not develop any symptoms yet.
Mild The person has mild symptoms and can recover at home.
Severe The person has severe symptoms and requires health care in a hospital.
Critical The person has critical symptoms and requires health care in an Intensive Care Unit
(ICU). After recovering from critical symptoms, the state is set to severe.
The disease spreads from infected people to susceptible people according to the infection
rate of each edge in the graph, which is evaluated using a Monte Carlo based approach. The
probability of a susceptible person p to get infected in a simulation cycle is given by Equations 1
to 4. Equation 3 defines the number of neighbors of each vertex (person) that are infected –
N (p). In Equation 4, the function Inf ectRate(p, n) returns the infection rate between p and n
in the network.
G = (V, E)

(1)

p∈V

(2)

v ∈ V | ∃e ∈ E, e = (v, p), state(v) = inf ected
Y
Inf ectP robability(p) = 1 −
(1 − Inf ectRate(p, n))

(3)

N (p) =

[

(4)

n∈N (p)

In the simulation, we consider all the cities and population that comprehend the SPMA,
including the demographic distribution. Data used to set the simulation parameters were ex6

tracted from the literature and official available data. Since our model is stochastic, each execution of the program generates a different network and a different disease transmission sample
path. Therefore, our results derive from 10 executions and are shown within a 95% confidence
interval following Student’s t-distribution. A comprehensive discussion on the simulation parameters, how we generate the relation network and handle sanitary interventions, as well as
figures containing additional results, can be found in the supplementary material.

Results and discussion
In the first strategy, we evaluate what could happen if all students went back to school at once,
but following sanitary measures, such as wearing masks and frequently washing their hands.
Figure 9 presents the results for this scenario. In the left column, we show results regarding
the general population of SPMA. In the right column, we show results regarding only people
that attend school, students and teachers. Results considering the sub-population of teachers and
families of people that attend school can be found in the supplementary material. Predicting how
much the infection rate in schools differs from the infection rate in the community is a difficult
task. Similarly, it is nearly impossible to predict how strictly students will follow the sanitary
measures. Consequently, we evaluate two different infection rates in schools: a best case and
a worst case scenario, in which the school infection rates are 2 and 4 times the community
infection rate, respectively. Also, for these results, we consider a 50% social isolation level
inside the same classroom (we consider two students as isolated when they do not have any
contact with each other, and therefore have no relation between them in the network). We show
results regarding the expected number of reported COVID-19 cases, critical cases, which require
intensive care units (ICU) for their treatment, and number of deaths. In the simulations, we
consider that the health system is always able to handle the demand, such that we can evaluate
the peak ICU usage; thereby, no one dies from health system collapse. In all results, day 0
7

corresponds to February 26th, 2020, which is the date corresponding to the first documented
case in Brazil. School reopening is set to day 224, which corresponds to October 7th, 2020,
which is when the São Paulo State plans to open schools.
Opening schools without any kind of constraint on the number of students per classroom,
using its total capacity, can increase the number of reported COVID-19 cases by up to 835,639,
and 40,860 more deaths occur compared to when schools do not reopen, with a peak of 12,748
people in critical condition that will require ICU treatment. In the SPMA, there are about 5,000
ICUs available for COVID-19 [23]. Therefore, the health care system would collapse in case all
students returned to school at once. By analyzing the data only in the school sub-population, we
first note that the ratio of critical patients and deaths are small compared to the entire population.
While the average death rate of infected people in the population was 5.3%, the death rate in the
school sub-population was only 0.2%. This is because most students are young and, according
to the official COVID-19 statistics, younger people have a smaller probability to develop the
critical symptoms of the disease. Nevertheless, we can observe that the COVID-19 reported
cases among people that frequent schools increase to up to 3.6× when compared to the scenario
where schools do not reopen. This result shows that, although the opening of schools with full
capacity does not present a huge risk for the students, students act as vectors of the virus, causing
a big impact in the entire metropolitan area. It is also important to note that, if we consider that
people in critical state that do not receive ICU treatment dies, the amount of deaths would be
much higher, since the health system would collapse if this strategy were adopted.
In the second strategy, we analyze a school opening strategy based on the plan of the São
Paulo state government [17]. The plan consists of 3 stages. In the first stage, about a third
of the students per class attend school each day. In the second stage, about two thirds of the
students go to school. In the last stage, all students go back to school. Every student and
professional must obey sanitary measures such as wearing masks and frequently washing their
8

hands. In our evaluation, stage 1 lasts 4 weeks and stage 2 lasts 17 weeks. The results of using
this strategy are depicted in Figure 10, following the same organization of the previous strategy
(Figure 9). For this experiment, we consider an isolation level of 50%. Compared to when all
students go to school, we can observe that the total number of reported infected people, in the
worst case, reduces by 96,216. This translates to 4,437 fewer deaths, as well as reduction of the
critical patients peak to 4,890 (after schools opened), which represents an ICU occupancy of
only 97.8%. In the best case, the maximum ICU occupancy is 48.8% after schools open.
Results only considering the school sub-population follow the same trend of the general
results. Considering the worst case, we can reduce the number of reported cases by 29,200
people and the number of deaths by 54 people compared to when all students go to school.
Regarding the deaths expected for the worst case, there would be a total of 541 deaths inside
the school sub-population, in which 356 deaths correspond to teachers, representing 65.8% of
school-related deaths. Although there are many more students than teachers, teachers are older
than the students, and hence have a higher mortality rate. If students strictly follow the sanitary
measures, as considered by the best case, the difference between opening the schools with all
students or with São Paulo’s plan is lower, but still very significant. Overall, results show that,
although the difference in the number of cases is low compared to when all students come back
at once, using an opening strategy with several phases avoids the health system collapse, which
would have a big impact in the actual number of deaths.
In Figure 11, we analyze several isolation levels for the São Paulo strategy. An isolation
level of 100% means that students inside the same classroom have no interaction between each
other, while an isolation level of 0% means that each student is able to infect any other student
inside the same classroom. As in previous experiments, we evaluate two different rates. If
students follow the social distancing and sanitary measures very strictly, with a 100% isolation,
there would be up to 678,729 less reported cases than students have a 0% of isolation, reflecting
9

in 32,817 fewer deaths. Although 0% and 100% isolation levels may be infeasible, there is no
way to predict which isolation level would be achieved. If we compare an 80% isolation to
a 20% isolation, we reduce the number of deaths by up to 16,844. While comparing a range
from 60% isolation to a 40% isolation, we still reduce the number of deaths significantly, by
up to 4,748. Even with a 0% isolation, although the amount of deaths is higher, the maximum
number of required ICUs was 5,212 after schools opened, only a little higher than the capacity
of SPMA. As expected, results show that student behavior is a key factor for the success of this
strategy. The major problem is that there is no way to predict how students are going to behave.
The last strategy we evaluate, shown in Figure 4, is to return to classes and open schools
only on day 341, which corresponds to February 1st, 2021. We consider that all students return
to school but follow sanitary measures (masks and hygiene). For this strategy, we analyze
two different scenarios: (1) no vaccines are available; (2) vaccines are available since day 310
(January 1st, 2020). For the vaccines scenario, the vaccines are administered with a procedure
divided into four phases, in the following order: people who are over 50 years old, teachers,
students and, finally, the rest of the population. We consider that 300,000 people can receive
the vaccine per day with 90% effectiveness rate and the vaccine takes 14 days to generate the
individual immune response.
The most important thing to note is that, in the scenario without vaccines, regardless if
schools open on day 224 or 341, opening schools with all students at once has a deep impact in
the number of cases, deaths and health care system. On the other hand, with the vaccines, we can
observe that schools can be reopened without any major concerns about ICU beds availability.
In this case, up to 37,753 lives could be saved compared to the previous controlled reopen
strategy. Besides the overall immunity of the population, by prioritizing teachers and students,
we are able to cut the transmission chain of COVID-19 inside the schools.

10

Conclusions
By analyzing all strategies, we conclude that opening schools with all students at once is a
strategy that imposes a high risk, such that any government that adopts it, regardless if this or
next year, should proceed very carefully. It can lead to a collapse of the health care system and
thereby to the need of further quarantine periods, which could have a catastrophic impact on
economics. It is also important to note that the students, due to their age, are the least affected
by the opening of schools. However, they can act as infection vectors, causing massive spreads
to more sensitive people, such as their family and teachers. Adopting a controlled reopening,
with several stages, carefully increasing the number of students, it is notorious that it is able to
reduce the speed of the spread of the virus, with a maximum ICU usage peak between 48.8%
and 97.8% depending on how much people that attend the school follow the sanitary measures
(considering a 50% isolation), such that the health care system is able to handle the demand of
new cases. Finally, by opening schools only when vaccination campaigns be available, within
the SPMA alone, up 37,753 lives could be saved compared to a controlled strategy. Since we
are likely within a few months of a vaccine, we consider the last the most appropriate strategy.

References
1. D. S. Hui, et al., The continuing 2019-nCoV epidemic threat of novel coronaviruses to
global health — The latest 2019 novel coronavirus outbreak in Wuhan, China, International
Journal of Infectious Diseases 91, 264 (2020).
2. M. Worobey, et al., The emergence of SARS-CoV-2 in Europe and North America, Science
eabc8169 (2020).
3. I. F. Miller, A. D. Becker, B. T. Grenfell, C. J. E. Metcalf, Disease and healthcare burden
of COVID-19 in the United States, Nature Medicine 26, 1212 – 1217 (2020).
11

4. J. Phua, et al., Intensive care management of coronavirus disease 2019 (COVID-19): challenges and recommendations, The Lancet Respiratory Medicine 8, 506 (2020).
5. W. Kawohl, C. Nordt, COVID-19, unemployment, and suicide, The Lancet Psychiatry 7,
389 (2020).
6. N. M. Ferguson, et al., Impact of non-pharmaceutical interventions (npis) to reduce covid19 mortality and healthcare demand, Tech. rep., Imperial College London (2020).
7. R. Lordan, G. A. FitzGerald, T. Grosser, Reopening schools during COVID-19, Science
369, 1146 (2020).
8. J. Panovska-Griffiths, et al., Determining the optimal strategy for reopening schools, the
impact of test and trace interventions, and the risk of occurrence of a second COVID-19
epidemic wave in the UK: a modelling study, The Lancet Child and Adolescent Health
(2020).
9. R. M. Viner, et al., School closure and management practices during coronavirus outbreaks
including COVID-19: a rapid systematic review, The Lancet Child and Adolescent Health
4, 397 (2020).
10. S. H. Vermund, V. E. Pitzer, Asymptomatic transmission and the infection fatality risk
for COVID-19: Implications for school reopening, Clinical Infectious Diseases (2020).
Ciaa855.
11. H. Hildenwall, et al., Paediatric COVID-19 admissions in a region with open schools during the two first months of the pandemic, Acta Paediatrica 109, 2152 (2020).
12. T. L. Psychiatry, Isolation and inclusion, The Lancet Psychiatry 7, 371 (2020).

12

13. C. J. E. Metcalf, D. H. Morris, S. W. Park, Mathematical models to guide pandemic response, Science 369, 368 (2020).
14. L. G. Barberia, E. J. Gómez, Political and institutional perils of Brazil’s COVID-19 crisis,
The Lancet 396, 367 (2020).
15. T. Mellan, et al., Report 21: Estimating covid-19 cases and reproduction number in brazil,
Tech. rep., Imperial College London (2020).
16. SUS, Datasus – portal da saúde. http://www2.datasus.gov.br/DATASUS/index.php, sistema
Único de saúde, ministério da saúde, [accessed sept. 16th, 2020] (2020).
17. SP, Plano de Retorno da Educação – Plano São Paulo - Governo do Estado de São Paulo.
https://www.saopaulo.sp.gov.br/planosp/, [accessed Sept. 21st, 2020] (2020).
18. A. Abou-Ismail, Compartmental Models of the COVID-19 Pandemic for Physicians and
Physician-Scientists, SN Comprehensive Clinical Medicine 2, 852 (2020).
19. J. Enright, R. R. Kao, Epidemics on dynamic networks, Epidemics 24, 88 (2018).
20. F. Brauer, Mathematical epidemiology: Past, present, and future, Infectious Disease Modelling 2 (2017).
21. M. Graham, T. House, Dynamics of stochastic epidemics on heterogeneous networks, Journal of mathematical biology 68 (2013).
22. T. Britton, F. Ball, P. Trapman, A mathematical model reveals the influence of population
heterogeneity on herd immunity to SARS-CoV-2, Science 369, 846 (2020).
23. SEADE, Repositório de dados sobre casos e óbitos decorrentes do covid-19 nos municı́pios
do estado de são paulo e sobre leitos e internações por departamento regional de saúde;
13

https://github.com/seade-R/dados-covid-sp, seade, secretaria de estado da saúde de são
paulo, [accessed sept. 16th, 2020] (2020).
24. IBGE, Censo 2010 – microdados. https://www.ibge.gov.br/estatisticas/sociais/populacao/
22827-censo-2020-censo4.html?=&t=microdados, instituto brasileiro de geografia e estatistica - brazil, [accessed sept. 16th, 2020] (2010).
25. IBGE, Indicadores ibge – pesquisa nacional por amostra de domicı́lios contı́nua. trimestre
móvel out. - dez. 2019, Tech. rep., Instituto Brasileiro de Geografia e Estatistica - Brazil
(2020).
26. IBGE, Pnad contı́nua: taxa de desocupação é de 11.0% e taxa de subutilização é de
23.0% no trimestre encerrado em dezembro. https://agenciadenoticias.ibge.gov.br/agenciasala-de-imprensa/2013-agencia-de-noticias/releases/26740-pnad-continua-taxa-dedesocupacao-e-de-11-0-e-taxa-de-subutilizacao-e-de-23-0-no-trimestre-encerrado-emdezembro, instituto brasileiro de geografia e estatistica - brazil, [accessed sept. 16th, 2020]
(2020).
27. E. M. Rees, et al., COVID-19 length of hospital stay: a systematic review and data synthesis, BMC Medicine 18, 270 (2020).
28. SUS, Sus – opendata. https://opendatasus.saude.gov.br/, sistema Único de saúde, ministério
da saúde, [accessed sept. 16th, 2020] (2020).
29. R. Li, et al., Substantial undocumented infection facilitates the rapid dissemination of novel
coronavirus (SARS-CoV-2), Science 368, 489 (2020).

14

Acknowledgments
This research was partially supported by a machine allocation on the Kabré supercomputer at
the Costa Rica National High Technology Center. We would like to thank Marco A. Amato for
reviewing an earlier version of this manuscript.
Financial support
This work received no direct funding.
Conflict of interest
Conflicts of Interest: None.
Data and materials availability
In case the paper gets accepted for publication, we will fully disclose all data underlying the
study in a public repository.

15

Figures
Schools closed

Reopen − best case

Schools closed

330,000

schools reopen

1,500,000

Number of cases

Number of cases

1,800,000

Reopen − worst case

1,200,000
900,000
600,000
300,000

220,000
165,000
110,000
55,000

90 180 270 360 450 540 630 720
Days since start of pandemic

0

(a) General – accumulated reported cases.
Reopen − best case

15,000

Reopen − worst case

schools reopen

12,500
10,000
ICU capacity

5,000
2,500

90 180 270 360 450 540 630 720
Days since start of pandemic

(b) Schools – accumulated reported cases.
Schools closed

Number of critical cases

Schools closed

Number of critical cases

schools reopen

0
0

0

720

Reopen − best case

Reopen − worst case

schools reopen

600
480
360
240
120
0

0

90 180 270 360 450 540 630 720
Days since start of pandemic

0

(c) General – critical cases (ICU).
Schools closed

108,000

Reopen − best case

Reopen − worst case

Schools closed

720

schools reopen

90,000
72,000
54,000
36,000
18,000
0

90 180 270 360 450 540 630 720
Days since start of pandemic

(d) Schools – critical cases (ICU).

Number of deaths

Number of deaths

Reopen − worst case

275,000

0

7,500

Reopen − best case

Reopen − best case

Reopen − worst case

schools reopen

600
480
360
240
120
0

0

90 180 270 360 450 540 630 720
Days since start of pandemic

(e) General – accumulated deaths.

0

90 180 270 360 450 540 630 720
Days since start of pandemic

(f) Schools – accumulated deaths.

Figure 1: Curves of infected people when schools reopen with all students at once.
16

Schools closed

Reopen − best case

Schools closed

270,000

1,375,000

Number of cases

Number of cases

1,650,000

Reopen − worst case

schools reopen

1,100,000
825,000
550,000
275,000

180,000
135,000
90,000
45,000
0

90 180 270 360 450 540 630 720
Days since start of pandemic

(a) General – accumulated reported cases.

Number of critical cases

Schools closed

Reopen − best case

ICU capacity

0

Reopen − worst case

schools reopen

5,000
4,000
3,000
2,000
1,000

90 180 270 360 450 540 630 720
Days since start of pandemic

(b) Schools – accumulated reported cases.
Schools closed

Number of critical cases

0

0

270

Reopen − best case

Reopen − worst case

schools reopen

225
180
135
90
45
0

0

90 180 270 360 450 540 630 720
Days since start of pandemic

0

(c) General – critical cases (ICU).
Schools closed

90,000

Reopen − best case

Schools closed

600

schools reopen

75,000
60,000
45,000
30,000
15,000
0

90 180 270 360 450 540 630 720
Days since start of pandemic

(d) Schools – critical cases (ICU).

Reopen − worst case

Number of deaths

Number of deaths

Reopen − worst case

schools reopen

225,000

0

6,000

Reopen − best case

Reopen − best case

Reopen − worst case

schools reopen

500
400
300
200
100
0

0

90 180 270 360 450 540 630 720
Days since start of pandemic

(e) General – accumulated deaths.

0

90 180 270 360 450 540 630 720
Days since start of pandemic

(f) Schools – accumulated deaths.

Figure 2: Curves of infected people when schools reopen following São Paulo’s strategy.

17

Reopen − worst case

Reopen − best case

1,680,000

310,000

1,520,000

270,000

Number of cases

Number of cases

Reopen − best case

1,360,000
1,200,000
1,040,000
880,000
720,000
20
40
60
80
Isolation percentage

190,000
150,000
110,000

100

(a) General – accumulated reported cases.
Reopen − best case

0

20
40
60
80
Isolation percentage

100

(b) Schools – accumulated reported cases.

Reopen − worst case

Reopen − best case

Reopen − worst case

330
Peak of critical cases

5,500
Peak of critical cases

230,000

70,000
0

4,900
4,300
3,700
3,100
2,500
1,900

275
220
165
110
55
0

0

20
40
60
80
Isolation percentage

100

(c) General – peak of critical cases (ICU) after schools reopen.
Reopen − best case

0

Reopen − worst case

640

80,000

560

64,000
56,000
48,000
40,000

40
60
80
Isolation percentage

Reopen − best case

88,000

72,000

20

100

(d) Schools – peak of critical cases (ICU) after schools reopen.

Number of deaths

Number of deaths

Reopen − worst case

Reopen − worst case

480
400
320
240
160

0

20
40
60
80
Isolation percentage

(e) General – accumulated deaths.

100

0

20

40
60
80
Isolation percentage

100

(f) Schools – accumulated deaths.

Figure 3: Curves of infected people when schools reopen following São Paulo’s strategy, evaluating different isolation levels.

18

Schools closed

Reopen − best case

Schools closed

900,000

schools reopen

1,500,000

Number of cases

Number of cases

1,800,000

Reopen − worst case

1,200,000
900,000
600,000
300,000

600,000
450,000
300,000
150,000

90 180 270 360 450 540 630 720
Days since start of pandemic

(a) No vaccine – accumulated reported cases.
Reopen − best case

10,500

0

Reopen − worst case

schools reopen

8,750
ICU capacity

5,250
3,500
1,750

90 180 270 360 450 540 630 720
Days since start of pandemic

(b) With vaccine – accumulated reported cases.
Schools closed

Number of critical cases

Schools closed

Number of critical cases

schools reopen

0
0

0

4,500

Reopen − best case

vaccination starts

Reopen − worst case

schools reopen

3,750
3,000
2,250
1,500
750
0

0

90 180 270 360 450 540 630 720
Days since start of pandemic

0

(c) No vaccine – critical cases (ICU).
Schools closed

96,000

Reopen − best case

Reopen − worst case

Schools closed

48,000

schools reopen

80,000
64,000
48,000
32,000
16,000
0

90 180 270 360 450 540 630 720
Days since start of pandemic

(d) With vaccine – critical cases (ICU).

Number of deaths

Number of deaths

vaccination starts

Reopen − worst case

750,000

0

7,000

Reopen − best case

Reopen − best case

vaccination starts

Reopen − worst case

schools reopen

40,000
32,000
24,000
16,000
8,000
0

0

90 180 270 360 450 540 630 720
Days since start of pandemic

(e) No vaccine – accumulated deaths.

0

90 180 270 360 450 540 630 720
Days since start of pandemic

(f) With vaccine – accumulated deaths.

Figure 4: Curves of infected people when schools reopen with all students on day 341.

19

Supplementary Material

The supplementary Material includes:
Materials and Methods
Figs. 5 to 11
Tables 1 to 4
References
Other Supplementary Materials for this manuscript include the following:
Repository address of the simulator source code and input data: Will be disclosed upon paper
approval.

20

1
1.1

Materials and Methods
Generating the Relation Network

The initial network was created in 5 stages. Note that the initial network considers a normal
scenario with no pandemic and interventions. We explain how we handle the interventions in
Section 1.2. The initial network was created as follows:
Home relations The number of people in the same home follows a distribution described in
Table 1 and Figure 5a, which was derived from the microdata of the last official census
from the Brazilian Institute of Geography and Statistics (IBGE) [24]. Inside the same
home, every person is connected to all other people within the same home.
Community relations The number of relations of each person follows a distribution described
in Table 1 and Figure 5b.
Workplace relations The number of people per company follows a distribution described in
Table 1 and Figure 5c. We only model as workplace relations jobs that involve agglomeration of people, such as people that work in the commerce, offices, industry and public
sectors. Other jobs, such as people that are autonomous workers or people that work with
agriculture, are indirectly modeled in the community relations. The data regarding the
number of employed people and per job type was extracted from IBGE [24–26]. In summary, 64% of people with 18 years old or above work. Among people that work, 45%
were modeled using workplace relations. Also, inside the same workplace, we consider
that the probability of two people to be connected in the network as 50%.
School relations The number of students inside the same class and the number of students
within each school follow the distributions described in Table 1, Figure 5d and Figure 5e.
For the relations between students from different classrooms, two students have a 0.5%
of probability of having a relation in the network. For the relations between students
21

within the same classroom, two students have a 50% of probability of having relation in
the network. We add one teacher for each classroom, in which the teacher has a relation
to all the students of the same class in the network. According to the census [24], 77.8%
of people with 18 years old or below frequent the school.
Inter-city relations The number of people that routinely travel between the different cities
relations was gathered from the census [24], which indicates a 17.8% of mobility between
cities in the metropolitan region of São Paulo. However, the data does not show the cities,
only if the person goes to a different city. To overcome this issue, we assume that 90%
of the traffic from satellite cities go to the capital, and the rest is divided between the
other cities in proportion to their population size. Regarding the traffic from the capital to
satellite cities, the traffic is divided proportionally to their population size.

1.2

Handling Interventions

To handle interventions, we can modify the infection rates, as well as add and remove edges
from the graph. Different types of intervention require different modifications. We handled the
interventions evaluated in the paper as follows:
Quarantine To implement the quarantine, we first reduce the infection rates inside schools
to zero. Afterwards, we remove the workplace relations corresponding to 50% of the
workplaces. The 50% of the relations that are left correspond to essential services that
can not be interrupted. Finally, we reduce the infection rate of community, workplace
and inter-city relations to match the reduced reproduction rate, which also simulates other
sanitary measures such as wearing masks. Home relations are not affected by quarantines.
Re-opening of economic activities During the quarantine, we zeroed the infection rate of half
of the workplaces. To re-open the economic activities, we just increase the infection rate
of such edges.
22

Re-opening schools with all students We only increase the infection rate of school relations,
which was zeroed by the quarantine.
Re-opening schools with the São Paulo government strategy We first remove all school relations from the graph, backing up the data regarding which students and teachers belonged to the same classroom. We create 3 more relation types to represent each group
of students. Afterwards, we divide each classroom in 3 and re-create the edges using the
newly created relation types. To select which students go to school in a day, we just need
to adjust the infection rates of the new relations, zeroing the relations corresponding to
the students that will not go to school that day.
Vaccine To simulate the vaccines, we only need to change the state of the person being vaccinated to the immune state, carefully considering that it takes some time to the vaccine to
make effect, and that not everyone that gets vaccinated will be immunized.

1.3

Other Simulations Parameters

Several simulation parameters can be found in Table 2 [4, 16, 24–28]. The frequency distributions found in the table can be seen in Figure 6.
In Table 3, we present the probabilities of an infected person to develop symptoms per-age.
The biggest challenge to generate this information is that there is no official data regarding the
number of unreported cases per age, as expected by the own definition of unreported. Therefore, we need to make several transformations with the reported data to take into account the
unreported cases in the simulation. We now describe how we generated these information of
Table 3.
We first define some functions and variables that return the input data of the algorithm:
• Function people(age) returns the number of people of age age in the entire population,
which we extracted from the census [16].
23

• Functions reportedM ild(age), reportedSevere(age) and reportedCritical(age) should
return the number of people with mild, severe and critical symptoms per age, respectively.
We extracted this information from the microdata published by the Health Ministry [28].
• Variable globalRatioU nreported is the ratio of unreported cases in the entire population. We set it to 0.85 in this paper, since the vast majority of COVID infections are
unreported [29].
Next, we define some variable and functions to be used later.
totalReportedM ild =

9
X

reportedM ild(age)

(5)

reportedSevere(age)

(6)

reportedCritical(age)

(7)

age=0

totalReportedSevere =

9
X
age=0

totalReportedCritical =

9
X
age=0

reported(age) = reportedM ild(age) + reportedSevere(age) + reportedCritical(age)
(8)
totalReported =

9
X

reported(age)

(9)

age=0

To calculate the probability of a person to be unreported, we first calculate the ratio of
reported cases:
reportedM ild(age)
reported(age)
reportedSevere(age)
ratioReportedSevere(age) =
reported(age)
reportedCritical(age)
ratioReportedCritical(age) =
reported(age)
ratioReportedM ild(age) =

(10)
(11)
(12)

Then, we use Equation 14, which finds a value u that forces the mean number of unreported
people to the desired value. In the equation, weight(age) returns the proportion of people of
age age that should be unreported. Since there is no data for unreported (as expected by the
24

own definition of unreported), we assume that weight has the same ratio of mild cases per age,
as it is the softer symptom recorded by official data.
Find u, such that:
weight(age) = ratioReportedM ild(age)
P9
u·

(13)

weight(age) · people(age)
= globalRatioU nreported
P9
people(age)
age=0

age=0

(14)

After finding u, we calculate a temporary ratio of unreported cases by age, just used to
calculate the symptomatic ratios:
tmpRatioU nreported(age) = weight(age) · u

(15)

Now that we know the ratio of unreported cases by age, we can calculate the relative proportion (weight) of symptomatic people:
weightM ild(age) = ratioReportedM ild(age) · (1 − tmpRatioU nreported(age))

(16)

weightSevere(age) = ratioReportedSevere(age) · (1 − tmpRatioU nreported(age))
(17)
weightCritical(age) = ratioCriticalM ild(age) · (1 − tmpRatioU nreported(age)) (18)
Now we define our target averages for the ratio of mild, severe and critical cases relative to
the entire population (not only relative to reported cases).
totalReportedM ild
· (1 − globalRatioU nreported)
totalReported
totalReportedSevere
targetSevereRatio =
· (1 − globalRatioU nreported)
totalReported
totalReportedCritical
targetCriticalRatio =
· (1 − globalRatioU nreported)
totalReported
targetM ildRatio =

(19)
(20)
(21)

Then, we use Equations 22, 23 and 24, which find values m, s and c that force the mean
ratio of people to the target value.
25

Find m, such that:
P9

Find s, such that:
P9
s·

(22)

weightSevere(age) · people(age)
= targetSevereRatio
P9
age=0 people(age)

(23)

weightCritical(age) · people(age)
= targetCriticalRatio
P9
age=0 people(age)

(24)

age=0

Find c, such that:
P9
c·

weightM ild(age) · people(age)
= targetM ildRatio
P9
people(age)
age=0

age=0

m·

age=0

Finally, we calculate the ratios relative to the entire population:
ratioM ild(age) = weightM ild(age) · m

(25)

ratioSevere(age) = weightSevere(age) · s

(26)

ratioCritical(age) = weightCritical(age) · c

(27)

ratioU nreported(age) = 1 − ratioM ild(age) − ratioSevere(age) − ratioCritical(age)
(28)
Our model allows us to put different infection rates depending on the patient symptoms. For
patients with severe and critical symptoms, we reduce the infection rate by 50% to simulate the
more controlled environments inside hospitals. For any symptomatic patients, we zero the infection rates to school and workplace relations. For patients with severe and critical symptoms,
we zero the infection rates to home relations.
Table 4 shows the death probability of each person depending on the symptoms and age.
As we can observe, the age of each person has a deep impact on the symptoms and death
rate. Due to that, we use real demographic data from the census [16]. Since the last census
is from 2010, we scale the number of people per age such that the total number of people
corresponds to the estimated population size in 2019 [16]. The demographic data of the entire
São Paulo Metropolitan Area can be seen in Figure 7.
26

1.4

Calibrating the Simulation to Match Real-World Behavior

Figure 8 contains a comparison of the simulator behavior to the real-world data of the São Paulo
Metropolitan Area. The calibration process involves setting the interventions, as explained in
Section 1.2, as well as manipulating the infection rates. In Figure 8a, we compare the estimated
number of people in the infected state at a day (do not confuse with the number of newly
infected people per day). In Figure 8b, we compare the accumulated number of people in the
infected state. In Figure 8c, we compare the number of critical patients, which represents the
ICU occupancy. It is important to mention that a perfect match between simulator and realworld behavior is impossible, mostly because of the fact that the vast majority of cases are
unreported [29], such that it is impossible to accurately measure real behavior with the official
published data. Nevertheless, we were able to configure the simulation parameters to reflect the
real behavior with a reasonable precision, as can be seen in the figures.

27

28

Figs. 5 to 11
0.05
0.04
Frequency

Frequency

0.2

0.1

0.03
0.02
0.01

0.0

0.00
0.0

2.5

5.0

7.5

10.0

0

Number of people per home

10

20

30

40

50

Number of community relations per person

(a) Home.

(b) Community.
0.04

Frequency

Frequency

0.075
0.050
0.025

0.03
0.02
0.01

0.000

0.00
0

10

20

30

40

50

0

Number of people per company

10

20

30

40

50

Number of students per classroom

(c) Workplace.

(d) School – classroom.

Frequency

0.0015

0.0010

0.0005

0.0000
0

1000

2000

3000

4000

Number of students per school

(e) School – total.

Figure 5: Frequency distributions used to create the network of relations of the population.
29

0.06

Frequency

Frequency

0.15

0.10

0.05

0.00

0.04

0.02

0.00
0

5

10

0

20

Days

40

60

Days

(a) COVID-19 incubation time.

(b) ICU length of stay (critical cases).
0.04

0.09
Frequency

Frequency

0.03
0.06
0.03

0.02
0.01

0.00

0.00
0

20

40
Days

(c) Infirmary length of stay (severe cases).

60

0

20

40
Years

(d) Age of teachers.

Figure 6: Frequency distributions of the parameters of Table 2.

30

60

2,100,000
1,800,000

1,200,000
900,000
600,000
300,000

Age

Figure 7: Demographic data of the population of the São Paulo metropolitan area.

31

80+

75−79

70−74

65−69

60−64

55−59

50−54

45−49

40−44

35−39

30−34

25−29

20−24

15−19

10−14

5−9

0
0−4

Number of people

1,500,000

Reported infected people

Real behavior

Simulation behavior

35,000
30,000
25,000
20,000
15,000
10,000
5,000
0
0

20

40

60

80

100

120

140

160

180

200

180

200

Days since start of pandemic
Accumulated reported infected people

(a) Estimated number of reported infected people.
Real behavior

Simulation behavior

600,000
500,000
400,000
300,000
200,000
100,000
0
0

20

40

60

80

100

120

140

160

Days since start of pandemic

(b) Accumulated number of reported infected people.

Number of critical cases

Real behavior

Simulation behavior

4,000
3,500
3,000
2,500
2,000
1,500
1,000
500
0
80

100

120

140

160

180

200

Days since start of pandemic

(c) Critical cases – number of required ICUs.

Figure 8: Comparison of simulator behavior to the real-world behavior.

32

Schools closed

Reopen − best case

Reopen − worst case
Schools closed

schools reopen

27,000

750,000
Number of cases

Number of cases

900,000

600,000
450,000
300,000
150,000

13,500
9,000
4,500

Reopen − best case

9,000

0

7,500
ICU capacity

4,500
3,000
1,500

Schools closed

0

180

Reopen − best case

Reopen − worst case

schools reopen

150
120
90
60
30
0

0

90 180 270 360 450 540 630 720
Days since start of pandemic

0

(c) Student’s families – critical cases (ICU).
Schools closed

60,000

Reopen − best case

Reopen − worst case

Schools closed

540

schools reopen

50,000
40,000
30,000
20,000
10,000
0

90 180 270 360 450 540 630 720
Days since start of pandemic

(d) Teachers – critical cases (ICU).

Number of deaths

Number of deaths

90 180 270 360 450 540 630 720
Days since start of pandemic

(b) Teachers – accumulated reported cases.

Reopen − worst case

schools reopen

6,000

0

Number of critical cases

Number of critical cases

Schools closed

schools reopen

18,000

90 180 270 360 450 540 630 720
Days since start of pandemic

(a) Student’s families – accumulated reported
cases.

Reopen − worst case

22,500

0
0

Reopen − best case

Reopen − best case

Reopen − worst case

schools reopen

450
360
270
180
90
0

0

90 180 270 360 450 540 630 720
Days since start of pandemic

(e) Student’s families – accumulated deaths.

0

90 180 270 360 450 540 630 720
Days since start of pandemic

(f) Teachers – accumulated deaths.

Figure 9: Curves of infected people when schools reopen with all students at once.

33

Schools closed

Reopen − best case

Reopen − worst case
Schools closed

schools reopen

21,000

650,000
Number of cases

Number of cases

780,000

520,000
390,000
260,000
130,000

10,500
7,000
3,500
0

3,300

Reopen − best case

0

Reopen − worst case

schools reopen

2,750
2,200
1,650
1,100
550

Schools closed

0

60

Reopen − best case

Reopen − worst case

schools reopen

50
40
30
20
10
0

0

90 180 270 360 450 540 630 720
Days since start of pandemic

0

(c) Student’s families – critical cases (ICU).
Schools closed

48,000

Reopen − best case

Reopen − worst case

Schools closed

420

schools reopen

40,000
32,000
24,000
16,000
8,000
0

90 180 270 360 450 540 630 720
Days since start of pandemic

(d) Teachers – critical cases (ICU).

Number of deaths

Number of deaths

90 180 270 360 450 540 630 720
Days since start of pandemic

(b) Teachers – accumulated reported cases.

Number of critical cases

Number of critical cases

Schools closed

schools reopen

14,000

90 180 270 360 450 540 630 720
Days since start of pandemic

(a) Student’s families – accumulated reported
cases.

Reopen − worst case

17,500

0
0

Reopen − best case

Reopen − best case

Reopen − worst case

schools reopen

350
280
210
140
70
0

0

90 180 270 360 450 540 630 720
Days since start of pandemic

(e) Student’s families – accumulated deaths.

0

90 180 270 360 450 540 630 720
Days since start of pandemic

(f) Teachers – accumulated deaths.

Figure 10: Curves of infected people when schools reopen following São Paulo’s strategy.

34

Reopen − best case

Reopen − worst case

Reopen − best case

650,000
575,000
500,000
425,000
350,000
0

20
40
60
80
Isolation percentage

Reopen − best case

16,000
13,500
11,000
8,500
0

20
40
60
80
Isolation percentage

100

(b) Teachers – accumulated reported cases.

Reopen − worst case

Reopen − best case

Reopen − worst case

60
Peak of critical cases

3,350
Peak of critical cases

18,500

6,000

100

(a) Student’s families – accumulated reported
cases.

2,950
2,550
2,150
1,750
1,350
950

50
40
30
20
10
0

0

20
40
60
80
Isolation percentage

100

(c) Student’s families – peak of critical cases
(ICU) after schools reopening.
Reopen − best case

0

Reopen − worst case

420

45,000

370

35,000
30,000
25,000
20,000

40
60
80
Isolation percentage

Reopen − best case

50,000

40,000

20

100

(d) Teachers – peak of critical cases (ICU) after
schools reopening.

Number of deaths

Number of deaths

Reopen − worst case

21,000

725,000
Number of cases

Number of cases

800,000

Reopen − worst case

320
270
220
170
120

0

20
40
60
80
Isolation percentage

100

(e) Student’s families – accumulated deaths.

0

20

40
60
80
Isolation percentage

100

(f) Teachers – accumulated deaths.

Figure 11: Curves of infected people when schools reopen following São Paulo’s strategy,
evaluating different isolation levels.
35

Tables 1 to 4
Relation

Description

Type

Mean

StdDev

Min

Max

Home
Community
Workplace
School – classroom
School – total

Number of people per home
Number of community relations per person
Number of people per company
Number of people per classroom
Number of people per school

Gamma
Gamma
Gamma
Gamma
Gamma

3.3
15.0
8.0
30.0
500.0

1.7
10.0
7.0
10.0
500.0

1
5
2
15
300

10
50
50
50
4,000

Table 1: Frequency distributions used to generate the relation network.

36

Parameter

Value

R0 (basic reproduction rate)
Pre-symptomatic time
Time for which people with unreported
and mild symptoms are contagious
Incubation time
Time from symptomatic to hospitalization
Days in ICU for critical patients
Days in hospital for severe patients (infirmary)
Age of the teachers

3.0 (at the start of the pandemic).
1 day.
4 days.
Gamma, mean:
5 days.
Gamma, mean:
Gamma, mean:
Gamma, mean:

Vaccine – time to be effective
Vaccine – number of people vaccinated per day
Vaccine – immunity rate

14 days.
300,000 people per day.
90%.

Infection rate – home

×3.0 the community rate considering the beginning
of the pandemic (not changed by any intervention).
×1.5 the community rate.
We evaluated both ×2 and ×4 the community rate.
Equal to the community rate.
We calculate it such that the average reproduction rate
among all people matches the target reproduction rate.

Infection rate – workplace
Infection rate – school
Infection rate – inter-city
Infection rate – community

4.6 days, Stddev: 3.2, Min: 1, Max: 14.
15.0 days, Stddev: 15.0, Min: 1, Max: 60.
6.5 days, Stddev: 5.5, Min: 1, Max: 60.
41.2 years, Stddev: 9.9, Min: 20, Max: 70.

Table 2: Other simulation parameters.

37

Age

Unreported

Mild

Severe

Critical

0-10
10-20
20-30
30-40
40-50
50-60
60-70
70-80
80-90
90+

0.8916
0.9613
0.9447
0.8987
0.8340
0.7211
0.5560
0.5079
0.4939
0.4931

0.1051
0.0384
0.0545
0.0985
0.1577
0.2513
0.3379
0.1459
0.2276
0.2283

0.0024
0.0003
0.0006
0.0022
0.0064
0.0202
0.0737
0.2274
0.1854
0.1901

0.0008
0.0001
0.0002
0.0006
0.0019
0.0074
0.0323
0.1188
0.0930
0.0886

Mean

0.8500

0.1235

0.0182

0.0084

Table 3: Probability of an infected person to develop specific symptoms depending on the age.

38

Age

Death (severe cases)

Death (critical cases)

0-10
10-20
20-30
30-40
40-50
50-60
60-70
70-80
80-90
90+

0.0109
0.0304
0.0217
0.0347
0.0574
0.1035
0.1804
0.2643
0.3944
0.5230

0.0649
0.1405
0.1545
0.1601
0.2214
0.3086
0.4349
0.5128
0.5549
0.5576

Mean

0.1518

0.3742

Table 4: Probability of a person to die depending on their symptoms and age.

39

