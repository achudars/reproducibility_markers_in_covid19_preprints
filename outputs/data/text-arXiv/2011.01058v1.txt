BAYESIAN INFERENCE OF HETEROGENEOUS EPIDEMIC
MODELS: APPLICATION TO COVID-19 SPREAD ACCOUNTING
FOR LONG-TERM CARE FACILITIES ∗

arXiv:2011.01058v1 [stat.ME] 2 Nov 2020

PENG CHEN† , KEYI WU‡ , AND OMAR GHATTAS§
Abstract. We propose a high dimensional Bayesian inference framework for learning heterogeneous dynamics of a COVID-19 model, with a specific application to the dynamics and severity
of COVID-19 inside and outside long-term care (LTC) facilities. We develop a heterogeneous compartmental model that accounts for the heterogeneity of the time-varying spread and severity of
COVID-19 inside and outside LTC facilities, which is characterized by time-dependent stochastic
processes and time-independent parameters in ∼1500 dimensions after discretization. To infer these
parameters, we use reported data on the number of confirmed, hospitalized, and deceased cases with
suitable post-processing in both a deterministic inversion approach with appropriate regularization
as a first step, followed by Bayesian inversion with proper prior distributions. To address the curse
of dimensionality and the ill-posedness of the high-dimensional inference problem, we propose use
of a dimension-independent projected Stein variational gradient descent method, and demonstrate
the intrinsic low-dimensionality of the inverse problem. We present inference results with quantified
uncertainties for both New Jersey and Texas, which experienced different epidemic phases and patterns. Moreover, we also present forecasting and validation results based on the empirical posterior
samples of our inference for the future trajectory of COVID-19.
Key words. COVID-19, Bayesian inference, epidemics, long-term care facility, compartmental
model, forecast under uncertainty
AMS subject classifications. 62F15, 62F30, 65C35, 60G15, 34F05

1. Introduction. The coronavirus disease 2019 (COVID-19) and resulting pandemic has had a massive impact on worldwide public health (1.2 million deaths and 46
million reported infections as of 31 October 20201 ), nations’ economies (a projected
4.5% reduction in global GDP in 2020 despite over $18 trillion in stimulus2 ), and the
downstream consequences on human welfare.
Since SARS-CoV-2, the virus underling COVID-19, is a novel virus, much remains
uncertain about its transmission and spread. Computer modeling is thus fundamental to the projections needed to inform decision making and policy. A hallmark of
the COVID-19 pandemic is that it is characterized by severe heterogeneities across
populations: in infectiousness and susceptibility, in age- and co-morbidity-dependent
morbidity and mortality rates, in human behavior and government policy, in medical
care, and so on. Standard compartment-type population models in the form of systems of ordinary differential equations assume well-mixed homogeneous populations
[29] and thus are poorly suited to modeling strongly heterogeneous disease spread.
∗ Submitted

to the editors DATE.
Funding: This work was partially funded by the Department of Energy, Office of Science,
Office of Advanced Scientific Computing Research, Mathematical Multifaceted Integrated Capability
Centers (MMICCS) program under award DE-SC0019303; and the National Science Foundation,
Division of Mathematical Sciences under award DMS-2012453.
† Oden Institute for Computational Engineering & Sciences, The University of Texas at Austin,
Austin, TX. (peng@oden.utexas.edu).
‡ Department
of Mathematics, The University of Texas at Austin, Austin, TX.
(keyiwu@math.utexas.edu).
§ Oden Institute for Computational Engineering & Sciences, Department of Geological Sciences,
Jackson School of Geosciences, Walker Department of Mechanical Engineering, The University of
Texas at Austin, Austin, TX. (omar@oden.utexas.edu).
1 https://coronavirus.jhu.edu/map.html
2 https://www.oecd.org/economic-outlook/
1

2

P. CHEN, K. WU, AND O. GHATTAS

Fully accounting for heterogeneities in infectious disease models, on the other hand,
introduces numerous parameters. Solution of the resulting large scale inverse problems presents challenges due to the typically noisy, sparse, and inconsistently reported
epidemiological data.
Moreover, due to the uncertainties in both models and data, quantification of uncertainties in parameter inference and subsequent predictions is paramount. Adopting
the framework of Bayesian inference to account for these uncertainties leads to a high
dimensional Bayesian inverse problem governed by (for example) differential equations. The twin curses of high dimensionality of parameter space and complexity of
the forward model have historically made Bayesian inversion governed by differential
equation models prohibitive. However, a number of theoretical and algorithmic advances over the past decade are making large-scale (partial) differential equation-based
Bayesian inversion tractable, based on exploitation of the geometric structure and
intrinsic low dimensionality of the posterior. These include geometrically-informed
MCMC methods [3, 7, 20, 21, 22, 36, 38, 45] as well as more recent Stein variational
methods [9, 10, 17, 23]. These methods have made Bayesian inversion feasible for complex problems in ice sheet dynamics and global seismology with as many as O(106 )
parameters [4, 6, 27].
Our goal in this paper is to specialize such methods—in particular Stein variational methods, which are particularly appropriate for highly nonlinear parameter-toobservable maps—to high-dimensional heterogeneous infectious disease models, with
specific application to modeling COVID-19 accounting for long-term care (LTC) facilities. A large percentage (over 40%3 ) of COVID-19 deaths have occurred in nursing
homes and other LTC facilities in the United States (and many other countries), despite the small percentage (∼0.7%) of the population in these facilities. Modeling,
inference, and prediction under uncertainty of the spread and severity of COVID19—while distinguishing between populations both inside and outside LTC facilities
as well as their interactions—is crucial for implementing optimal strategies to contain
and mitigate the disease through both non-pharmaceutical and pharmaceutical interventions. We endow our COVID-19 epidemiological model (see below) with a large
number of uncertain parameters to account for variations in transmission, testing,
hospitalization ratio, and fatality ratio over time, as well as other fixed parameters.
This results in a challenging Bayesian inverse problem governed by ODEs with ∼1500
parameters, for which we employ the recently developed projected Stein variational
gradient descent method [9]. The success of this method is predicated on the existence of an intrinsic low-dimensional subspace on which the parameters influence the
observables. We investigate whether the inference problem for COVID-19 dynamics
satisfies this property for our model.
There have been several different classes of epidemiological models developed to
infer the dynamics of COVID-19 and make forecasts4 , including classical compartmental models in the form of ordinary differential equations [34, 37, 41] and partial
differential equations [28, 32, 43], network models [18, 33], statistical regression models [19, 42, 46], agent-based models [24, 39], etc. See [26, 29, 30] for general references
on mathematical modeling of infectious diseases. Various strategies to account for
heterogeneities in models of the dynamics of COVID-19 have been considered, including age, underlying health condition, connectivity, susceptibility, infectiousness,
3 https://www.nytimes.com/interactive/2020/us/coronavirus-nursing-homes.html
4 See

forecasts in https://www.cdc.gov/coronavirus/2019-ncov/covid-data/forecasting-us.html,
and https://projects.fivethirtyeight.com/covid-forecasts/

BAYESIAN INFERENCE OF HETEROGENEOUS EPIDEMIC MODEL

3

and spatial heterogeneity. However, given the significant expense of Bayesian inversion in high dimensions with complex models, a common approach to inference of
parametrized models from data has been to invoke a low dimensional ansatz on the
form of the parametric variation (such as assuming the variation in time of the basic
reproduction number is represented by a sigmoid function), resulting in just a handful
of parameters. One of our aims is to show that one can relax such assumptions to
better capture the complex dynamics by accounting for the time dependent parameter uncertainties via stochastic processes, and attack the high dimensional inverse
problem that results upon discretization with specialized methods such as projected
Stein variational gradient descent.
Contributions. In this work, we propose to address the challenging ill posed
inverse problem of Bayesian inference of COVID-19 models with high dimensional parameter spaces from noisy data, by exploiting the intrinsic low-dimensionality of the
parameter-to-observable map and through the use of the recently developed projected
Stein variational gradient descent method [9], which requires a number of model solutions that is independent of the parameter dimension. We show that it is feasible
to infer models of COVID-19 dynamics in very high parameter dimensions by aggressively exploiting problem structure. As a testbed application that is important in its
own right, we model heterogeneity and severity of COVID-19 accounting for disease
dynamics inside and outside LTC facilities and their interactions. We are not aware of
any model in the literature that specifically address the heterogeneity associated with
LTCs and the general population. We employ a heterogeneous compartmental model
with the compartments of susceptible, exposed, infectious, recovered, hospitalized, deceased, confirmed, and unconfirmed cases to describe the epidemics both inside and
outside LTC facilities. To better capture the dynamics, we consider a subset of model
parameters to be continuously varying in time; these include (1) an effective virus
transmission reduction factor that represents a compound effect of, e.g., social distancing, isolation, quarantining, and mask wearing; (2) an infection confirmation ratio
that reflects the testing capacity and strategy; (3) an infection hospitalization ratio,
and (4) a hospitalization fatality ratio, the latter two of which relate to time dependent changes in hospital capacity (ICU beds, ventilators), effectiveness of treatment,
infection variations with age and health condition of the population, etc. This gives
rise to an infinite dimensional Bayesian inverse problem [40], which when discretized
in time, results in a high dimensional problem.
To infer the model parameters, including the ∼1500 time-dependent parameters,
we use reported data including the daily number of deceased cases from inside and
outside LTC facilities separately, as well as the daily number of confirmed cases and
the number of currently hospitalized cases for both inside and outside LTC facilities
combined. We present both a deterministic inversion approach with a suitable regularization, and a Bayesian inference approach with proper prior distributions to learn
these parameters with quantified uncertainties. We present the results of inference for
both approaches, with data from both New Jersey and Texas that represent different development stages of COVID-19. Our model can capture well all reported data
with 90% credible intervals covering the 7-day averaged data. Moreover, we present
a future forecast and validation of the number of confirmed, infected, hospitalized,
and deceased cases using our inference results. In a follow-on article, we use these
posterior predictives as a basis for stochastic optimal control to determine optimal
mitigation strategies for COVID-19 under uncertainty.
The paper is structured as follows. We present the heterogeneous compartment
model in Section 2, followed by presentation of the available data and their post-

4

P. CHEN, K. WU, AND O. GHATTAS

processing in Section 3. Section 4 is devoted to presentation of a deterministic inversion formulation with appropriate regularization of the parameters and the inference
results. This serves as a first step for a Bayesian inference formulation with proper
prior distributions in Section 5. We introduce the projected Stein variational gradient descent method for the Bayesian inference problem and the results in Section 5.
Finally, we draw some conclusions and perspectives in Section 6.
2. Model. To learn the epidemics of COVID-19 both inside and outside longterm care facilities (LTC), we present a data-driven modeling of the epidemics, where
the model is constructed by the principle of (1) being able to explain the available
reported data, specifically the number of daily deaths inside and outside LTC for a
certain period of time, the number of currently hospitalized cases, and the number
daily confirmed cases, and (2) as simple as possible to avoid over-parametrization and
overfitting. Under such principle, we consider the following compartmental model, as
shown in Figure 1, with two groups to describe the epidemics of COVID-19 inside and
outside LTC within a time period t ∈ (tstart , tend ]

(2.1)

dSi (t)
dt
dEi (t)
dt
dIi (t)
dt
dHi (t)
dt
dRi (t)
dt
dDi (t)
dt
dPic (t)
dt
dPiu (t)
dt

= −βi Ci (t)Si (t),
= βi Ci (t)Si (t) − σi Ei (t),
= σi Ei (t) − πi (t)ηi Ii (t) − (1 − πi (t))γiI Ii (t),
= πi (t)ηi Ii (t) − νi (t)µi Hi (t) − (1 − νi (t))γiH Hi (t),
= (1 − πi (t))γi Ii (t) + (1 − νi (t))γiH Hi (t),
= νi (t)µi Hi (t),
= τi (t)σi Ei (t),
= (1 − τi (t))σi Ei (t),

where the compartmental variables Si , Ei , Ii , Hi , Ri , Di represent the number of susceptible, exposed, infectious, hospitalized, recovered, and deceased cases inside LTC
(i = 1) and outside LTC (i = 2), and Pic and Piu represent the accumulated number
of positive (infected) cases that are confirmed/reported by viral test or medical diagnosis, and unconfirmed/unreported inside LTC (i = 1) and outside LTC (i = 2). The
effective transmission factor Ci (t) is given by
(2.2)

Ci (t) = (1 − αi (t))

X
i

Cij

Ij (t)
.
Nj

Here the numbers of population inside LTC and outside LTC are represented by
N1 and N2 . The time-dependent parameter αi (t) ∈ (0, 1) accounts for an effective
reduction of the transmission at time t for group i due to, e.g., social distancing,
isolation, and quarantine. The contact matrix C ∈ R2×2 represents the number of
contacts inside (C11 ) and outside (C22 ) LTC, as well as the interactions between
them (C12 and C21 ) through LTC and hospital staff, and family visitors to LTC.

BAYESIAN INFERENCE OF HETEROGENEOUS EPIDEMIC MODEL

S

β1

E

σ1

I
π1η1

1 − α1

H

C

H

1 − α2

π2η2

S

β2

(1 − π1)γ1I

E

σ2

I

R

S

susceptible

(1 − ν1)γ1H

E

exposed

I

infectious

R

recovered

H

hospitalized

D

deceased

C

contacts

ν1μ1
ν2 μ2
(1 −

(1 − π2)γ2I

D
D
ν2)γ2H

R

5

Fig. 1. Diagram of a compartment model for the epidemics of COVID-19 inside and outside
long-term care facilities.

Specifically, C12 represents the number of contacts between susceptible LTC residents
and infectious others, while C21 represents the number of contacts between infectious
LTC residents and susceptible others. The parameters βi , σi , ηi , µi , γiI , γiH are the
transmission rate, the latency rate, the hospitalization rate, the deceased rate, and
the recovery rate from infectious and hospitalized stages, which are the inverse of
the transmission period, the latency period (exposed but not infectious yet), from
infectious to hospitalized period, from hospitalized to deceased period, from infectious
to recovery (not infectious) period, and from hospitalized to recovery (leaving hospital)
period. The parameter πi (t) is related to the infection hospitalization ratio (IHR)
denoted as ζi (t) ∈ (0, 1), i.e., the proportion of the infected cases that are hospitalized
(2.3)

πi (t)ηi
ζi (t)
γiI ζi (t)
=⇒
π
(t)
=
=
,
i
1 − ζi (t)
(1 − πi (t))γiI
ηi + (γiI − ηi )ζi (t)

where we assume that the IHR is time dependent possibly due to (1) the dynamic
change of the severity of the infected population (e.g., age and health condition) and
(2) hospital availability. Similarly, the parameter νi (t) is related to the hospitalization
fatality ratio (HFR) denoted as ξi (t) ∈ (0, 1), i.e., the proportion of the hospitalized
cases that are deceased
(2.4)

νi (t)µi
ξi (t)
γiH ξi (t)
=
=⇒
ν
(t)
=
,
i
1 − ξi (t)
(1 − νi (t))γiH
µi + (γiH − µi )ξi (t)

where we assume that the HFR is also time dependent possibly due to (1) the dynamic
change of the severity of the hospitalized population (e.g., age and health condition)
and (2) medical resources (e.g., ICU bed, ventilator, and new drugs). Finally, the
parameter τi (t) represent the infection confirmation ratio (ICR), or the proportion of
infected cases that are confirmed/reported positive by viral test or medical diagnosis,
which depends on the test strategy and capacity.
3. Data. We choose the data of New Jersey (NJ) and Texas (TX) as two examples, whose LTC share of total COVID deaths are about 50% and 31% as of August

6

P. CHEN, K. WU, AND O. GHATTAS

31. The LTC share of New Jersey is close to the US average and that in many European countries. The LTC share of Texas is close to 50% early on and decreasing
to 31% when the LTC became strongly protected. Moreover, the two states have
distinctive development of the epidemics: New Jersey experienced fast outbreak in an
early stage (March and April) with a large number of deaths, and has since flatten the
curve by implementing strict mitigation policy of lockdown, social distancing, etc.,
while Texas had slower spread of the virus than New Jersey early on (March and
April) with a much smaller number of deaths, yet turned to an accelerated increase
of cases after quickly relaxing the mitigation (from May to July) and flattened the
curve since mid-July. These epidemic developments can be observed in Figure 2 for
New Jersey and Figure 3 for Texas.
The number of COVID deaths inside and outside LTC by state of US is reported
in Nursing Home/LTC COVID Deaths By State 5 for a certain period of time. The
bottom-right part of Figure 2 displays the reported number of accumulated and daily
deaths inside LTC in New Jersey from April 17 to August 31. The number of daily
deceased cases has some negative values and is very oscillatory showing a 7 day periodic pattern with much smaller number of deaths reported during the weekend than
during the week. We treat this oscillatory pattern as report error due to report delay,
and possibly incompleteness and incorrectness. To correct the report error and make
the daily numbers smoother in a given time interval (t1 , t2 ), we compute a seven day
moving average dri , i = 1, 2, from the reported daily data d˜ri , as
dri (t) =

(3.1)

t+3
1 X ˜r
di (k),
7
k=t−3

where we set d˜ri (k) = d˜ri (t1 ) if t − 3 <= t1 and d˜ri (k) = d˜ri (t2 ) if t + 3 >= t2 .
The smoothed data by seven day moving average are also shown in Figure 2.
Note that the number of daily deceased cases is already relatively big on the first
day of report, which can not reflect earlier stage of the epidemics. To learn the early
dynamics, we use another set of data from the COVID19 Tracking project6 , as shown
in the other three figures in Figure 2, which reports the number of daily deceased
cases, infected cases that are confirmed by viral test or medical diagnosis from early
March, as well as the number of currently hospitalized cases. Note that these data
are aggregated for two groups of inside and outside LTC, which are not available
separately. To smooth these oscillatory data, we also compute a seven day moving
average pr (t), dr (t), and H r (t) for the number of daily confirmed cases p̃r (t), daily
deceased cases d˜r (t), and currently hospitalized cases H̃ r (t). As the two sets of data
are slightly inconsistent for the reported number of deceased cases, we use dr1 (t) for the
number of deaths inside LTC, and dr2 (t) = dr (t) − dr1 (t) as that outside LTC to keep
a consistent dr (t) in the entire time period. We denote the number of accumulated
confirmed and deceased cases for the smoothed data as
(3.2)

P r (t) =

t
X
s=tstart

pr (s),

Dr (t) =

t
X
s=tstart

dr (s),

and Dir (t) =

t
X

dri (s).

s=tstart

4. Deterministic inversion. As the compartmental variables of the dynamic
model (2.1) is very sensitive to the parameters due to their exponential growth in time,
5 https://docs.google.com/spreadsheets/d/1ETm51GayRjlnoaRVtUOWfkolEeAQZ-zPhXkCbVe4
ik/edit#gid=435667374
6 https://github.com/COVID19Tracking

7

# total confirmed

105

# daily confirmed

BAYESIAN INFERENCE OF HETEROGENEOUS EPIDEMIC MODEL

103

# confirmed in New Jersey

# hospitalized in New Jersey
currently hospitalized
moving average

total confirmed
moving average

101
Mar

Apr

May

Jun

Jul

Aug

Sep

2020

# hospitalized

103

103

102
daily confirmed
moving average

101
100

Mar

Apr

May

Jun

Jul

Aug

Sep

Apr

2020

total deceased
moving average

# daily deceased

Apr

May

Jun

Jul

Aug

2020

101
10

1

daily deceased
moving average
Apr

May

Jun

Jul

Aug

Jul

Aug

Sep

2020

6 × 103
4 × 103
3 × 103

Sep

2020

total deceased
moving average

2 × 103

Sep

102
100

# total deceased

103
101

Jun

# LTC deceased in New Jersey

# daily deceased

# total deceased

# deceased in New Jersey

May

22May

22 Jun

22 Jul

22 Aug
22 Sep
2020-Sep
daily deceased
moving average

22May

22 Jun

22 Jul

22 Aug

102
101

22 Sep

2020-Sep

Fig. 2. The number of total (accumulated) and daily confirmed cases (top-left), and deceased
cases (bottom-left), and the number of currently hospitalized cases (top-right), as well as their seven
day moving average. Bottom-right: the number of total and daily deceased cases, and their seven
day moving average in long-term care (LTC) facilities. All the data are presented in logarithmic
scale, which shows an early exponential growth.

the uncertainty on the (pre-inferred) parameters would lead to large uncertainty or
even blowup in the model output. To avoid such blowup, we first deterministically
infer the parameters at which the model can optimally fit the data in this section,
and then quantify the uncertainty for the inferred parameters in next section. We
formulate the deterministic inversion problem, and present the results for New Jersey
and Texas.
4.1. Formulation. To infer the parameters in (2.1) given data presented above,
we minimize an objective function with respect to the parameters, which consists of a
misfit function between the model output and the data, and a penalty function that
imposes certain constraints on the parameters.
By D(t) at t ∈ [tstart , tend ] we denote the number of total deaths from the model
(2), given as
(4.1)

D(t) = D1 (t) + D2 (t).

Then we compute the number of daily deaths from the model (2) at t ∈ [tstart +1, tend ]
as
(4.2) d1 (t) = D1 (t)−D1 (t−1), d2 (t) = D2 (t)−D2 (t−1), and d(t) = D(t)−D(t−1).
Similarly, we denote P c (t) as the number of total infected cases that are confirmed,

8

P. CHEN, K. WU, AND O. GHATTAS

103
total confirmed
moving average

101
Mar

# daily confirmed

# hospitalized in Texas
currently hospitalized
moving average

104

Apr

May

Jun

Jul

Aug

Sep

2020

103

# hospitalized

# total confirmed

# confirmed in Texas
105

103

daily confirmed
moving average

101
Mar

Apr

May

Jun

Jul

Aug

Sep

Apr

2020

May

total deceased
moving average

# daily deceased

Apr

May

Jun

Jul

Aug

100

2020

daily deceased
moving average
Apr

May

Jun

Jul

Aug

Sep

2020

Aug

total deceased
moving average
103

Sep

102
101

# total deceased

103
101

Jul

# LTC deceased in Texas

15
# daily deceased

# total deceased

# deceased in Texas

Jun

Sep

2020

Jun

15

Jul

15

Aug

15

102
101
100

Sep

2020-Sep

daily deceased
moving average
15

Jun

15

Jul

15

Aug

15

Sep

2020-Sep

Fig. 3. The same as in Figure 2 for Texas here. The increase of the number of confirmed,
deceased, and hospitalized cases in Texas was slower than that of New Jersey in the early stage, and
got accelerated before flattened lately.

given by

(4.3)

P c (t) = P1c (t) + P2c (t),

and the number of daily confirmed cases as

(4.4)

pc (t) = P c (t) − P c (t − 1).

As the early data (deaths and confirmed cases) are subject to randomness of the
epidemics in the early stage, we use the data from the time when the numbers are
relatively big. Let tp1 denote the first day that the number of total confirmed cases
surpassed 100, th1 denote the first day that the number of currently hospitalized cases
surpassed 10, td1 denote the first day that the number of total deaths surpassed 10, td2
denote the day before the number of LTC deaths is reported, and tend the last day

9

BAYESIAN INFERENCE OF HETEROGENEOUS EPIDEMIC MODEL

the data is available. To this end, we define the misfit function as

(4.5)
F (θ) =

tend
X

2

(log(H(t, θ)) − log(H r (t)))

t=th
1

+

tend
X

2

(log(P c (t, θ)) − log(P r (t))) + 0.1

t=tp
1

+

d

r

+

t2
X

2

(log(D(t, θ)) − log(D (t))) + 0.1

t=td
1
2
X

2

(log(pc (t, θ)) − log(pr (t)))

t=tp
1 +1

d

t2
X

tend
X

2

(log(d(t, θ)) − log(dr (t)))

t=td
1 +1
tend
X

i=1 t=td
2 +1

(log(Di (t, θ)) −

2
log(Dir (t)))

+ 0.1

tend
2
X
X

2

(log(di (t, θ)) − log(dri (t))) ,

i=1 t=td
2 +2

where we use a small weight 0.1 for the daily data as they are more oscillatory thus
hard to match and probably less reliable than the accumulated data. Moreover, these
weights are roughly proportional to the inverse of the standard deviation of the data
(the difference between the reported number and seven day averaged number) that
reflects the uncertainty or reliability of the reported data.
The aggregated parameter set θ in (4.5) collects all the parameters appearing in
model (2.1) as
(4.6)
2
[

θ=
(αi (t))t∈tset , (τi (t))t∈tset , (ζi (t))t∈tset , (ξi (t))t∈tset , βi , σi , ηi , µi , γiI , γiH , Ci1 , Ci2 ,
i=1

where tset = (t0 , t1 , . . . , tk ) is a sequence of equispaced time points with step size δt.
The parameters αi (t), τi (t), ζi (t), ξi (t) at other time t ∈
/ tset are obtained by piecewise
linear interpolation using values of (αi (t))t∈tset , (τi (t))t∈tset , (ζi (t))t∈tset , (ξi (t))t∈tset .
Such an interpolatory definition with a relatively big step size, e.g., δt = 7, is employed to prevent over-parametrization that may lead to daily oscillatory and large
variation in the transmission reduction effect, which plays a role of regularization in
the deterministic inversion by solving a relatively low-dimensional optimization problem. The optimizer can be interpolated and used as an initial guess to refine the
optimization with smaller step size, e.g., δt = 1, which is often easier than directly
solving a high-dimensional optimization problem. In the misfit function defined in
(4.5), we use data of the number of both accumulated and daily confirmed and deceased cases, as we find that the accumulated data can prevent over-fitting for the
oscillatory (even after smoothing by moving average) daily data. Since these numbers
are different by several orders of magnitude, we use their logarithmic scale to make
them comparable. Moreover, we explicitly write θ as one argument for the quantities
in the misfit function (4.5) that depends on θ through the model (2.1).

10

P. CHEN, K. WU, AND O. GHATTAS

We consider the following penalty for the parameters
(4.7)
G(θ) =

2
2 X
k 
X
αi (tj ) − αi (tj−1 )
δt

i=1 j=1

+

2
2 X
k 
X
τi (tj ) − τi (tj−1 )
δt

i=1 j=1

+

+

δt

+

δt

2
2 
X
βi − β̄i
i=1

+

2 
X
i=1

sβ̄i

+

2
2 X
k 
X
τi (tj ) − τ̄i

δt +

δt +

sσ̄i

+

2 
X
i=1

+

st

2
2 
X
ηi − η̄i
sη̄i
2 X
2 
X

i=1


H 2

γiH − γ̄i
sγ̄iH

st

2
2 X
k 
X
ξi (tj ) − ξ¯i

2
2 
X
σi − σ̄i
i=1

st

2
2 X
k 
X
ζi (tj ) − ζ̄i

i=1 j=0


I 2

γiI − γ̄i
sγ̄iI

δt +

i=1 j=0

2
2 X
k 
X
ξi (tj ) − ξi (tj−1 )
i=1 j=1

2

α1 (tj−1 ) − α1 (tj )
δt +
δt
max 0,
δt
j=1

i=1 j=0

2
2 X
k 
X
ζi (tj ) − ζi (tj−1 )
i=1 j=1

k
X

+

i=1 j=1

+

δt

δt

δt

2
2 
X
µi − µ̄i
sµ̄i

i=1

Cij − C̄ij
sC̄ij

2
,

where the first term in the first line represents the change of the transmission
reducRt
tion factor αi (t) in time t, an approximation to the variational integral t0k (dαi (t))2 dt
by a trapezoidal rule, which is penalized to prevent its large variation; the second term
in the first line is used to penalize decreasing α1 (t), which reflects an increasing transmission reduction inside LTC as strict mitigation policy has been implemented and
likely maintained in preventing excessive death that has accounted for a significant
proportion of total deaths despite a small population, about 0.7% of total population
in average in US. Similar penalizations on the change of the ICR, IHR, HFR in time
are considered. In addition, we consider a penalization on the deviation of ICR, IHR,
HFR from their reference values weighted by a scaling parameter st > 0, which is
set to be large that reflects less confidence and allows relatively large deviation from
their reference values. In the last two lines of of the penalty function (4.7), the deviation of βi , σi , ηi , µi , γiI , γiH , Cij from their reference values β̄i , σ̄i , η̄i , µ̄i , γ̄iI , γ̄iH , C̄ij is
penalized, which is weighted with a relative scaling parameter s > 0.
Given the misfit function (4.5) and the penalty function (4.7), we define an objective function
(4.8)

J(θ) = F (θ) + λ G(θ),

where λ > 0 is a scaling parameter that balances the two terms. The deterministic
inversion problem can then be formulated as the optimization problem: find θ∗ ∈ Θ,
such that
(4.9)

θ∗ = argmin J(θ),
θ∈Θ

where Θ is an admissible parameter range. We start the optimization with a relatively big step size δt = 7, which leads to a 224-dimensional parameter θ for both
New Jersey and Texas, including dimension 26 for each of the time dependent variables, and dimension 16 for the rest of the time independent parameters. To refine

BAYESIAN INFERENCE OF HETEROGENEOUS EPIDEMIC MODEL

11

the optimization with smaller step size δt = 1, we use the interpolated optimizer
as the initial guess, which leads to a 1520-dimensional parameter θ for New Jersey
(1488 for Texas), including dimension 188 for New Jersey (184 for Texas) for each of
time dependent variables. To solve the high-dimensional optimization problem (4.9)
with bounded constraint on the parameter θ ∈ Θ, we use a Python implementation
of an optimizer SLSQP, a Sequential Least SQuares Programming algorithm, which
is a gradient-based quasi Newton method with a BFGS update for the approximation of the Hessian [31]. The gradient of the objective function J(θ) with respect
to the high-dimensional parameter θ is computed by automatic differentiation using
an Autograd 7 library. We also develop an accelerated computation of the gradient
by an adjoint approach, for which the expressions of involved derivatives are first
symbolically computed by a symbolic library SymPy 8 and then accelerated by a high
performance Python compiler Numba 9 . See an abstract formulation of the adjointbased computation of the gradient in Appendix A, which is used in next section for
Bayesian inference, about 100X faster than the automatic differentiation by Autograd.
4.2. Results. We present the setup and the results of the deterministic inversion
for New Jersey and Texas. We initialize the model (2.1) with the number of susceptible cases S1 and S2 the same as the population inside and outside LTC; we set E1 = 1
exposed case inside LTC and E2 = 100 exposed cases outside LTC, and all other compartments as zero. To initialize the parameters, we set α1 (t) = α2 (t) = 0, , t ∈ tset ,
and set a bound as αi (t0 ) ∈ [0, 0.1] to have a small transmission reduction at the
beginning, and αi (t) ∈ [0, 0.9], t = t1 , . . . , tk , where the upper bound 0.9 assumes
that the transmission can not be completely prevented by the mitigation policy. For
the reference values of the parameters presented in the following, besides a few assumptions, we consider those available from [24, 33, 42], CDC COVID-19 Pandemic
Planning Scenarios 10 and references therein. More specifically, we initialize ICR
τ1 (t) = 40% and τ2 (t) = 10%, IHR ζ1 (t) = 25% and ζ2 (t) = 5%, HFR ξ1 (t) = 40%
and ξ2 (t) = 10%, which lead to an initial infection fatality ratios (IFR = IHR×HFR)
10% inside LTC and 0.5% outside LTC. We also use these values as the reference
values in the penalty term (4.7). We consider the bound [ρ̄/4, 2ρ̄] ⊂ [0, 1], with ρ̄ representing the initial values of the ratios τi (t), ζi (t), ξi (t). For the rest of parameters in
θ, we initialize them at their reference values ρ̄ as reported in Table 1, and consider
the bound [ρ̄/2, 2ρ̄] to reflect relatively large uncertainty. Specifically, for the latency
rate we use σ1 = σ2 = 1/4 (inverse of the latency period, exposed but not infectious
yet, 4 days), for hospitalization rates we use η1 = η2 = 1/8 (inverse of the period from
hospitalization to death, 8 days), for the recovery rates we use γ1I = γ2I = 1/5 (inverse
of the infectious period, 5 days) and γ1H = γ2H = 1/7 (inverse of the hospital stay period, 7 days). For the contact matrix we use C11 = 4, C12 = 0.5, C21 = 0.1, C22 = 2,
which reflect relatively more frequent contacts inside LTC than outside LTC, and
larger infection influence of people from outside to inside LTC than those from inside to outside LTC. The contact matrix is rescaled by the transmission parameters
β1 = β2 = 0.3 such that the initial doubling time of infection and death is about 2 ∼ 3
days.
We solve the optimization problem (4.9) for deterministic inversion of the parameters with the scaling parameter λ = 100 to balance the misfit and penalty terms.
7 https://github.com/HIPS/autograd
8 https://www.sympy.org/en/index.html
9 https://numba.pydata.org/
10 https://www.cdc.gov/coronavirus/2019-ncov/hcp/planning-scenarios.html

12

P. CHEN, K. WU, AND O. GHATTAS

Table 1
Reference values and optimal values of the time independent parameters in θ collected in (4.6).
The optimal values are obtained by solving the deterministic inversion problem (4.9)

θ
βi
σi
ηi
µi
γiI
γiH
Ci1 /Ci2

reference values
i=1
i=2
0.30
0.30
0.25
0.25
0.13
0.13
0.13
0.13
0.20
0.20
0.14
0.14
4.00/0.50 0.10/2.00

optimal values (NJ)
i=1
i=2
0.39
0.28
0.30
0.27
0.12
0.13
0.13
0.13
0.19
0.22
0.15
0.17
5.15/0.50 0.11/1.62

May

Jun

Jul

Aug

103
102

Apr

May

Jun

Jul

Aug

Sep
2020
data
model

103

Sep

Apr

2020

# deceased in New Jersey

104

102

data
model
Apr

May

Jun

Jul

Aug

102

Sep
2020
data
model

101
Apr

May

Jun

Jul

Aug

May

Jun

Jul

Aug

Sep

2020

# LTC deceased in New Jersey

103
101

# hospitalized

data
model

103

Sep

2020

# total deceased

# daily confirmed
# total deceased

data
model

104

Apr

# daily deceased

# hospitalized in New Jersey

104

6 × 103
4 × 103
3 × 103

data
model

2 × 103

# daily deceased

# total confirmed

# confirmed in New Jersey
105

optimal values (TX)
i=1
i=2
0.30
0.33
0.28
0.28
0.13
0.12
0.13
0.13
0.21
0.21
0.15
0.16
4.09/0.51 0.10/2.10

22May

22 Jun

22 Jul

22 Aug

22May

22 Jun

22 Jul

22 Aug

102

22 Sep
2020-Sep
data
model

101
22 Sep

2020-Sep

Fig. 4. The same as in Figure 2. The data here is the same as the seven day moving average
data in Figure 2. The model output is the result of model (2.1) at the optimal parameter value
obtained by deterministic inversion.

We use relatively large scaling parameters st = 10, s = 5 in the penalty term (4.7)
such that the optimal parameters can be easily deviated from the reference values.
We run the SLSQP optimization algorithm and stop it at 100 iterations, when the
objective function (4.8) does not decrease much (less than 10−4 compared to the decrease at the first step). We plot the comparison between the model output and the
smoothed data (with seven day moving average) in Figure 4 for New Jersey and Figure 5 for Texas. An overall very high match between the model and all the data can

13

BAYESIAN INFERENCE OF HETEROGENEOUS EPIDEMIC MODEL

# hospitalized in Texas

105

data
model

104

103
102
104
103

Apr
May
data
model

Jun

Apr

Jun

Jul

Aug

Sep

2020

# hospitalized

104

103

102
May

Jul

Aug

Sep

May

# deceased in Texas

104

# total deceased

102
Apr

102

May
data
model

Jun

Jul

Aug

May

Jun

Jul

Jul

Aug

Sep

2020

Aug

data
model
103

Sep

2020

101
Apr

Jun

# LTC deceased in Texas

data
model

103

101

Apr

2020

Sep

2020

# daily deceased

# daily deceased

# total deceased

# daily confirmed

# total confirmed

# confirmed in Texas
data
model

15
Jun
data
model

15

Jul

15

Aug

15

15

15

Jul

15

Aug

15

Sep

2020-Sep

101
Jun

Sep

2020-Sep

Fig. 5. The same as in Figure 3. The data here is the same as the seven day moving average
data in Figure 3. The model output is the result of model (2.1) at the optimal parameter value
obtained by deterministic inversion.

be observed for both states, thanks to the flexibility of the parametrization especially
in the time dependent transmission reduction factors, infection confirmation ratios,
infection hospitalization ratios, and hospitalization fatality ratios for both inside and
outside of LTC, whose optimal values are shown in Figure 6 for New Jersey and Figure 7 for Texas. This demonstrates the effectivity of both the parametrization and
the optimization algorithm in the framework of deterministic inversion. We remark
that some data and model mismatch can be observed, e.g., the LTC deceased cases
in both states can be probably accounted by the poor quality of the data due to delay or misreport, which can be supported by the very oscillatory (already smoothed
by 7 day moving average) and the abruptly changed (in early July) number of daily
deaths especially in Texas. This slight mismatch can also be explained by the use of
the relatively small weight for the daily data in the misfit function (4.5), which is to
prevent catching the artifact of oscillation and overfitting that may lead to too much
and unrealistic oscillation in the time dependent parameters. Nevertheless, the data
and model output are matched rather well for the number of accumulated confirmed
and deceased cases. We also remark that the data and model match for the number
of hospitalized cases is very high, even for the sharp change, e.g., in mid-April and
late August in New Jersey, and in early April, mid-June and late July in Texas.
We make a few observations and comments for the deterministic inversion results
of parameters. The optimal transmission reduction factor inside and outside LTC are
shown in the top-left part of Figure 6 for New Jersey and Figure 7 for Texas. We

14

P. CHEN, K. WU, AND O. GHATTAS

1.0
0.8

transmission reduction factor in New Jersey
inside LTC
outside LTC

1.0
0.8

0.6

0.6

0.4

0.4

0.2

0.2

0.0

1.0
0.8

Mar

Apr

May

Jun

Jul

Aug

Sep

0.0

2020

infection hospitalization ratio in New Jersey
inside LTC
outside LTC

1.0
0.8

0.6

0.6

0.4

0.4

0.2

0.2

0.0

Mar

Apr

May

Jun

Jul

Aug

Sep

2020

0.0

infection confirmation ratio in New Jersey
inside LTC
outside LTC

Mar

Apr

May

Jun

Jul

Aug

Sep

2020

hospitalization fatality ratio in New Jersey
inside LTC
outside LTC

Mar

Apr

May

Jun

Jul

Aug

Sep

2020

Fig. 6. Optimal time dependent parameters inside and outside LTC in New Jersey by deterministic inversion (4.9).

can see a sharp increase in late March and early April for both inside and outside
LTC in both states, when increasingly stricter mitigation policy was implemented,
e.g., school closure, prohibitive large group gathering, lockdown, limited or prohibitive family visiting to LTC, increasing use of personal protective equipment (PPE)
inside LTC. The transmission reduction is relaxed by the gradual lift of the strict
mitigation measures with several phases starting from May. However, it is observed
that the lift was faster in Texas than in New Jersey in May and June outside LTC,
which led to the sharp increase of the number of confirmed and hospitalized cases
in Texas, and continuing decrease in New Jersey. The transmission reduction factor
is increased in July in Texas probably because the lift of effective mitigation measures were reversed, while wearing masks was suggested and later mandated. We
remark that the relatively more effective transmission reduction inside LTC than outside has been maintained probably by large-scale testing and widely use of PPE.
We observe that the infection hospitalization ratios and hospitalization fatality ratios outside LTC in both states has decreased from their initial values, which may
be explained by the shift of the new infections from the general population to the
younger and healthier population, which is built into the penalization (4.7). We remark that the unexpected increase of the hospitalization fatality ratio in Texas from
mid-July is probably due to the change of the reported fatality from July 27 and
on.11 The optimal values for the other time independent parameters are reported
11 https://dshs.texas.gov/news/releases/2020/20200727.aspx

15

BAYESIAN INFERENCE OF HETEROGENEOUS EPIDEMIC MODEL

1.0

transmission reduction factor in Texas

0.8

0.8

0.6

0.6

0.4

0.4

0.2
0.0

1.0
0.8

inside LTC
outside LTC
Mar

Apr

May

Jun

Jul

Aug

Sep

0.2
0.0

2020

infection hospitalization ratio in Texas
inside LTC
outside LTC

0.4

0.4

0.2

0.2
Apr

May

Jun

Jul

Aug

Sep

2020

0.0

Apr

May

Jun

Jul

Aug

Sep

2020

hospitalization fatality ratio in Texas
inside LTC
outside LTC

0.8
0.6

Mar

Mar

1.0

0.6

0.0

infection confirmation ratio in Texas
inside LTC
outside LTC

1.0

Mar

Apr

May

Jun

Jul

Aug

Sep

2020

Fig. 7. Optimal time dependent parameters inside and outside LTC in Texas by deterministic
inversion (4.9).

in Table 1, some of which are evidently different from the reference values. The
slightly different values between New Jersey and Texas imply slightly different transmission/confirmation/hospitalization/death/recovery pattern. However, we caution
that these optimal values may differ from the reality even though they provide the
best fit for the data because (1) the inference problem is ill-posedness, i.e., the data
are noisy, limited, and can only effectively inform the most data sensitive parameters,
(2) the model is inadequate that may not capture the heterogeneity in age and health
condition, different susceptibility, infectivity, and symptoms of different people, and
(3) the partial information embedded in the penalization on the model parameters
may not represent the reality.
5. Bayesian inference. In learning the epidemics through assimilating the
available data to the model (2.1) by solving the optimization problem (4.9), various
inevitable uncertainties are neglected, including the parameter uncertainty and data
uncertainty, besides the uncertainty in the model itself. Without accounting for these
uncertainties, the parameters inferred from the smoothed data may not capture the
reality, which may lead to incorrect forecast results for the future transmission of the
virus and ineffective optimal mitigation design based on the deterministic inversion.
In this section, we deal with the parameter and data uncertainties in a Bayesian framework for statistical inference of the parameters equipped with probability distributions
and provide confidence for the model output. In particular, to solve the Bayesian inference problem with high-dimensional and heterogeneous parameters (time-dependent

16

P. CHEN, K. WU, AND O. GHATTAS

and time-independent), we employ our recently developed pSVGD method [9], which
exploits the intrinsic low dimensionality of the parameter-to-observable map and efficiently draw samples from the posterior distribution by solving an optimal transport
problem with parameter projection into low-dimensional subspaces.
5.1. Formulation. The parameter θ defined in (4.6) is a set of heterogeneous
parameters, including the discrete sequences of the four types of time dependent
parameters (αi (t))t∈tset , (τi (t))t∈tset , (ζi (t))t∈tset , (ξi (t))t∈tset , i = 1, 2, the time independent parameters βi , σi , ηi , µi , γiI , γiH , i = 1, 2, and a contact matrix C. We present
prior probability distributions for these parameters. For simplicity, we assume that
these parameters are independently distributed.
We construct the prior distributions for (τi (t))t∈tset , (ζi (t))t∈tset , (ξi (t))t∈tset in
the same way as for (αi (t))t∈tset , and only present it for (αi (t))t∈tset for simplicity. The
sequences (αi (t))t∈tset are obtained as a temporal discretization of the transmission
reduction factor αi (t) for t ∈ (t0 , tk ). To equip a prior probability distribution for
αi (t) ∈ (0, 1), we assume that it is given by the form
(5.1)

αi (t) =

1
(tanh(gi (t)) + 1) ,
2

where tanh is the hyperbolic tangent function so that the constraint αi (t) ∈ (0, 1) is
always satisfied. Moreover, the time-dependent function gi (t) ∈ N (gi∗ , Cg ) is assumed
to be a Gaussian process with mean gi∗ and covariance Cg . We set the mean as
(5.2)

gi∗ (t) = arctanh(2αi∗ (t) − 1),

where αi∗ (t) for t ∈ (t0 , tk ) is defined as piecewise linear interpolation of the optimal
sequences (αi∗ (t))t∈tset , which is obtained as the solution of the optimization problem
(4.9) for deterministic inversion. We assume the covariance Cg is given by
Cg = B −1 ,

(5.3)

where B is an elliptic differential operator in time domain (t0 , tk ) given by
B = −sg ∆t + sI I,

(5.4)

equipped with homogeneous boundary condition, where sg > 0, sI > 0 are scaling
parameters, ∆t is the Laplacian in time, and I is identity. Such a covariance (5.3) is
often used in defining Gaussian process/random field with sg and sI controlling its
correlation length and variance. By a temporal discretization at equispaced points
t0 , . . . , tk using finite difference, we have
(5.5)

∆t g(t) ≈

g(t − δt) − 2g(t) + g(t + δt)
,
(δt)2

for any twicely differentiable function g : [t0 , tk ] → R, we obtain a discrete Laplacian
L with homogeneous Neumann boundary condition, i.e., g 0 (t0 ) = g 0 (tk ) = 0, such
that
2
k 
X
g(tj ) − g(tj−1 )
T −1
T
(5.6)
g Cg g = g (−sg L + sI I)g = sg
+ sI ||g||22 ,
δt
j=1
for g = (g(t0 ), . . . , g(tk ))T , where the first term has the same form as that in the
penalty term (4.7) up to a constant. To this end, we obtain the prior distribution for

BAYESIAN INFERENCE OF HETEROGENEOUS EPIDEMIC MODEL

17

the vector g i = (gi (t0 ), . . . , gi (tk ))T from the discretization of the Gaussian process
gi ∼ N (gi∗ , Cg ), as g i ∼ N (g ∗i , Cg ) with the mean vector g ∗i = (gi∗ (t0 ), . . . , gi∗ (tk )) and
covariance matrix Cg = (−sg L + sI I)−1 .
By slight abuse of notation, we denote g as a collection of all the 4 × 2 (4 for
different ratios, 2 for inside and outside LTC) time dependent parameters, with a
total dimension of 8(k + 1). Meanwhile, by slight abuse of notation we denote Cg as
a block diagonal covariance matrix, where each of the eight blocks is the covariance
matrix (−sg L + sI I)−1 .
For the time independent parameters, including the scalar parameters of various
rates βi , σi , ηi , µi , γiI , γiH , i = 1, 2, and the contact matrix C, we collect them as a
vector of parameters
(5.7)

f = (β1 , β2 , σ1 , σ2 , η1 , η2 , µ1 , µ2 , γ1I , γ2I , γ1H , γ2H , C11 , C12 , C21 , C22 )T ,

and assume that it has a prior distribution as
(5.8)

log(f ) = h ∼ N (h∗ , Ch ),

where h∗ = log(f ∗ ) for f ∗ defined as the optimal values of f obtained from the
deterministic inversion problem (4.9). For the covariance Ch , we assume that it is
diagonal with the diagonal entries given as the entries of the vector (sh h∗ )2 with a
scaling parameter sh > 0. Under this assumption, we have
2
22 
X
hl − h∗l
∗
,
(5.9)
(h − h∗ )T C−1
(h
−
h
)
=
h
sh h∗l
l=1

which has the same form as that in the penalty term (4.7) up to a constant. Finally,
we collect all the parameters as x = (g, h) ∈ Rdx of dimension dx . Then the prior
density of x, denoted as p0 (x), satisfies


1
1
∗ T −1
∗
∗ T −1
∗
(5.10)
p0 (x) ∝ exp − (g − g ) Cg (g − g ) − (h − h ) Ch (h − h ) .
2
2
Note that − log(p0 (x)) has similar form as part of that in the penalty term (4.7).
However, the parameter x here, after the nonlinear transformation by the function in
(5.1) and the logarithmic function in (5.8), is different from θ in (4.7). We remark that
the deterministic inversion problem (4.9) can also be formulated as an optimization
problem with respect to the transformed parameter x. However, we observe from tests
that it is much more difficult to solve than the one with respect to the parameter θ,
mainly due to the stiffness of the nonlinear transformation, especially (5.1), in a major
part of the whole parameter space. Nevertheless, by defining the prior distribution
of x centered at the transformed optimal values of the parameter θ, and use a proper
covariance for x, the stiffness can be effectively alleviated in the Bayesian inference
problem.
Based on the above definition of the transformed parameter x and its prior distribution, we assume that the data and model output can be formulated as
(5.11)

y = u(x) + ω,

where the data y represents a collection of all the data as given in the misfit function
(4.5), i.e.,

y = {log(H r (t))}, {log(P r (t))}, {0.1 log(pr (t))},

(5.12)
{log(Dr (t))}, {0.1 log(dr (t))}, {log(Dir (t))}, {0.1 log(dri (t))} ,

18

P. CHEN, K. WU, AND O. GHATTAS

and the parameter-to-observable map u(x) is given by

u(x) = {log(H(t, x))}, {log(P c (t, x))}, {0.1 log(pc (t, x))},

(5.13)
{log(D(t, x))}, {0.1 log(d(t, x))}, {log(Di (t, x))}, {0.1 log(di (t, x))} ,
where each set of data in y and model output in u(x) has a time span corresponding to
that in (4.5). Note that in u(x) the model output depends on the parameter x through
θ by the transformation (5.1) and (5.8), as well as the model (2.1) which depends on
the parameter θ. For simplicity, we assume that the additive noise ω ∼ N (0, Cω )
with zero mean and a symmetric positive definite covariance matrix Cω . Then the
likelihood function, denoted as f (x), satisfies


1
T −1
(5.14)
f (x) ∝ exp − (y − u(x)) Cω (y − u(x)) .
2
By Bayes’ rule, the posterior density of the parameter x is given by
(5.15)

p(x) =

1
f (x)p0 (x),
Z

where Z is a normalization constant given by
Z
f (x)p0 (x)dx,
(5.16)
Z=
Rdx

which is typically intractable to compute, especially for a large dimension n. The
tasks of Bayesian inference is to draw samples of the parameter x from its posterior
distribution, and compute some statistical quantity of interest, e.g., mean, variance,
and confidence interval of the parameter and the model output. Several challenges
are faced for these tasks, including (1) curse of dimensionality — the computational
complexity grows rapidly (typically exponentially) for conventional methods with respect to the parameter dimension, and (2) the geometry of the posterior density is
complex, e.g., non Gaussian, multimodal, concentrating in local regions, etc. We
have developed several approaches to address the curse of dimensionality, including
[9, 10, 12, 13, 14, 15, 17] that exploit the sparsity, low dimensionality, and geometry
of the parameter-to-observable map. In this work, we employ our recently developed projected Stein variational gradient descent (pSVGD) method [9], which can
break or considerably alleviate the curse of dimensionality by exploiting the intrinsic
low-dimensionality of the inference problem using gradient information matrix, and
effectively deal with the complex geometry by transporting samples in parallel from
the prior distribution to the posterior through optimization.
5.2. pSVGD. We briefly present SVGD from [35] and then introduce the projected SVGD from [9] to tackle high-dimensional inference problems. As a variational
inference method, SVGD seeks an approximate density q ∈ Q in a density function
space Q for the posterior density p by minimizing a Kullback–Leibler (KL) divergence
that measures the difference between two densities, i.e.,
(5.17)

q ∗ = argmin DKL (q|p),
q∈Q

where DKL (q|p) = Ex∼q [log(q/p)], which vanishes when q = p. A specific function
class is Q = {T] p0 : T ∈ T }, where T] is a pushforward map that pushes the prior

BAYESIAN INFERENCE OF HETEROGENEOUS EPIDEMIC MODEL

19

density to a new density q := T] p0 through a transport map T (·) : Rdx → Rdx defined
in a space T . For
(5.18)

T (x) = x + φ(x),

where φ : Rdx → Rdx is a differentiable perturbation map, and  > 0 is a learning
rate, there holds
(5.19)

∇ DKL (T] p0 |p)

=0

= −Ex∼p0 [trace(Ap φ(x))],

where Ap is the Stein operator given by
(5.20)

Ap φ(x) = ∇x log p(x)φ(x)T + ∇x φ(x).

A practical SVGD algorithm was obtained by choosing T = (Hdx )dx = Hdx ×· · ·×Hdx ,
a tensor product of a reproducing kernel Hilbert space (RKHS) Hdx with kernel
k(·, ·) : Rdx × Rdx → R, which push the samples x01 , . . . , x0N drawn from the prior p0
step by step as
(5.21)

`
∗ `
x`+1
m = xm + l φ̂` (xm ),

m = 1, . . . , N, ` = 0, 1, . . .

where φ̂∗` (x`m ) is an approximate steepest direction given by
(5.22)

φ̂∗` (x`m ) =

N
1 X
∇ ` log p(x`n )k(x`n , x`m ) + ∇x`n k(x`n , x`m ).
N n=1 xn

The kernel k plays a critical role in pushing the samples to the posterior. One choice
is Gaussian


||x − x0 ||22
(5.23)
k(x, x0 ) = exp −
,
hx
where hx is a bandwidth, e.g., h = med2 / log(N ) with med representing the median
of sample distances [35]. However, it is known that the kernel suffers from the curse
of dimensionality for large dimension dx , which leads to the samples that are not
representative of the posterior, as observed in [9, 17, 44, 47].
To address the curse of dimensionality, we exploit the property that the subspace
in which the posterior differs from the prior is low dimensional due to the ill-posedness
of the inference problem, as proven for some model problems and numerically demonstrated for many others [1, 2, 5, 8, 9, 15, 16, 17, 25, 27, 36]. We project the parameter
x into this subspace spanned by r basis functions Xr = span(ψ1 , . . . , ψr ) as
(5.24)

Pr x :=

r
X

ψi ψiT x = Ψr w,

∀x ∈ Rdx ,

i=1

where the matrix Ψr := (ψ1 , . . . , ψr ) ∈ Rdx ×r represents the projection matrix and
the vector w := (w1 , . . . , wr )T ∈ Rr is the coefficient vector with element wi := ψiT x
for i = 1, . . . , r. The basis functions ψ1 , . . . , ψr are obtained as the eigenvectors for
the generalized eigenvalue problem
(5.25)

Hψi = λi Cx ψi ,

20

P. CHEN, K. WU, AND O. GHATTAS

where (λi , ψi )ri=1 represent the dominant eigenpairs of (H, Cx ) correspond to the r
largest eigenvalues λ1 ≥ · · · ≥ λr . The matrix Cx is the prior covariance of the
parameter x = (g, h), i.e., Cx = diag(Cg , Ch ), a block diagonal matrix with each
diagonal block representing the covariance of g and h. The matrix H is chosen as a
gradient information matrix, which is defined as the average of the outer product of
the gradient of the log-likelihood w.r.t. the posterior, i.e.,
Z
(∇x log f (x))(∇x log f (x))T p(x)dx,
(5.26)
H=
Rdx

which is evaluated by sample average approximation to be specified later. By the
projection (5.24), we consider a decomposition of the prior for the parameter x =
xr + x⊥ , where xr = Pr x, as
⊥ r
p0 (x) = pr0 (xr )p⊥
0 (x |x ),

(5.27)

r
⊥
where pr0 and p⊥
0 are marginal and conditional densities for x and x . Moreover, we
define a marginal likelihood function (an optimal approximation of the full likelihood
function [9]) as
Z
r
r
(5.28)
fr (x ) =
f (xr + x̃)p⊥
0 (x̃|x )dx̃,
X⊥

where X⊥ is the complement of the subspace Xr . Since the uncertainty in xr = Pr x =
Ψr w can be fully represented by the coefficient w, we consider the prior and posterior
density for w, given by
(5.29)

π0 (w) = pr0 (Ψr w),

and π(w) =

1
fr (Ψr w)π0 (w),
Zw

where the normalization constant Zw = Ew∼π0 [g(Ψr w)].
To sample from the posterior π in (5.29), we employ the SVGD method presented above for the projection coefficient. Specifically, pSVGD pushes the samples
0
from π0 (w) as
w10 , . . . , wN
(5.30)

`+1
`
`
wm
= wm
+ l φ̂r,∗
` (wm ),

m = 1, . . . , N, ` = 0, 1, . . . ,

with a step size l and an approximate steepest direction
(5.31)

`
φ̂r,∗
` (wm ) =

N
1 X
`
`
∇ ` log π(wn` )k r (wn` , wm
) + ∇wn` k r (wn` , wm
),
N n=1 wn

where the kernel k r is specified as


1
(5.32)
k r (w, w0 ) = exp − (w − w0 )T (Λ + I)(w − w0 ) .
hw
where the metric matrix Λ+I with eigenvalues Λ = diag(λ1 , . . . , λr ) of (5.25) are used
to account for data impact in different directions ψ1 , . . . , ψr . The pSVGD algorithm is
presented in Algorithm 5.1, which is implemented in parallel with samples distributed
in multiple cores.
We remark that the projected likelihood in (5.29) can be approximated by its
definition (5.28) as
(5.33)

fr (Ψr wn` ) ≈ f (Ψr wn` + x⊥
n ),

BAYESIAN INFERENCE OF HETEROGENEOUS EPIDEMIC MODEL

21

Algorithm 5.1 pSVGD in parallel
1: Input: samples {x0n }N
n=1 in each of K cores, basis Ψr , maximum iteration Lmax ,
tolerance wtol .
N
2: Output: posterior samples {x∗
n }n=1 in each core.
0
T 0
⊥
0
, and communicate for {wn0 }N
3: Set ` = 0, project wn = Ψr xn , xn = x0n − Ψr wn
n=1 .
4:
5:
6:
7:
8:
9:
10:

repeat
Compute gradients ∇wn` log π(wn` ) for n = 1, . . . , N , and communicate.
`
`
Compute the kernel values k r (wn` , wm
) and their gradients ∇wn` k r (wn` , wm
) for
n = 1, . . . , N K, m = 1, . . . , N , and communicate for them.
`+1
`
Update samples wm
from wm
by (5.30) and (5.31) for m = 1, . . . , N , with
0 N
N K samples used for SAA in (5.31), and communicate for {wm
}m=1 .
Set ` ← ` + 1.
`
`−1
until ` ≥ Lmax or mean(||wm
− wm
||2 ) ≤ wtol .
∗
`
Reconstruct samples xn = Ψr wn + x⊥
n.

since its variation in X⊥ is negligible. We adaptively construct the projector Pr with
basis Ψr for Algorithm 5.1, for which we evaluate H in (5.26) by the sample average
approximation
(5.34)

Ĥ :=

M
1 X
∇x log f (x`m )(∇x log f (x`m ))T ,
M m=1

where the samples x`1 , . . . , x`M are adaptively transported from the prior samples
x01 , . . . , x0M by pSVGD. This procedure is summarized in Algorithm 5.2. We remark
that by the adaptive construction, we push the samples to their posterior in each
subspace Xr`x spanned by (possibly) different basis Ψ`rx with different r for different
`x , during which the frozen samples x⊥
n in Algorithm 5.1 are also updated at each
step `x of Algorithm 5.2.
Algorithm 5.2 Adaptive pSVGD in parallel
w
x
1: Input: samples {x0n }N
n=1 in each of K cores, Lmax , Lmax , xtol , wtol .
∗ N
2: Output: posterior samples {xn }n=1 in each core.
3: Set `x = 0.
4: repeat
5:
Compute ∇x log f (x`nx ) in (5.34), n = 1, . . . , N in each core, and communicate.
6:
7:

Solve (5.25) with H approximated as in (5.34), to get bases Ψ`rx .
Apply the pSVGD Algorithm 5.1, i.e.,
`x N
`x
w
{x∗n }N
n=1 = pSVGD({xn }n=1 , Ψr , Lmax , wtol ).

8:
9:

Set `x ← `x + 1 and x`nx = x∗n , n = 1, . . . , N .
until `x ≥ Lxmax or mean(||x`mx − x`mx −1 ||X ) ≤ xtol .

5.3. Results. We set the the scaling parameter sg = 1000 and sI = 1 in the
prior covariance (5.3) for g, and sh = 1/10 for the prior covariance (5.9) for h, and

22

P. CHEN, K. WU, AND O. GHATTAS

set the observation noise covariance matrix Cω as the identity matrix. This leads to
sufficient variation of the parameters that result in large variation (and no blowup)
of the model output at different samples drawn from the prior distribution, as can be
observed in the left part of Figure 12 and 14 for New Jersey and Texas. We run the
adaptive pSVGD Algorithm 5.2 with N = 125 samples in each of K = 8 cores, so 1000
samples in total. We stop the algorithm at 10 × 10 iterations, where the projection
basis functions Ψ`rx are updated for each 10 iterations. We remark that the move of
the samples already becomes small towards the end of the iteration. We choose the
dimension r such that the eigenvalue λr+1 < 10−1 . The decay of the eigenvalues at
different pSVGD iterations are shown in Figure 8 for both states, from which we can
observe a significant reduction of the eigenvalues by several orders of magnitude for
the first few dimensions, which implies that the data informed parameter subspace
is intrinsically low-dimensional, e.g., the first 10 dimension (out of the total 1520 for
New Jersey and 1488 for Texas) catches over 99% difference of the prior and posterior
distribution measured by the KL divergence (5.17).

log10(| r|)

4
3
2
1
0

6

=0
= 10
= 20
= 30
= 40
= 50
= 60
= 70
= 80
= 90

5
4

log10(| r|)

=0
= 10
= 20
= 30
= 40
= 50
= 60
= 70
= 80
= 90

5

3
2
1
0

1

1
0

10

20

r

30

40

0

10

20

r

30

40

50

Fig. 8. Decay of the eigenvalues (in logarithmic scale) of the generalized eigenvalue problem
(5.25) at different iterations ` of pSVGD sample update, where H is approximated by Ĥ in (5.34).
Left: New Jersey. Right: Texas.

Figure 9 displays the statistics of the posterior samples, including their mean
and 90% credible interval, in which 90% samples fall, as well as the optimal values
obtained from the deterministic inversion for the time independent parameters, while
Figures 10 and 11 display these quantities for the time dependent parameters. We
observe that the posterior sample mean is close to the optimal values obtained by the
deterministic inversion. Meanwhile, it is evident from the large 90% credible interval
of the posterior samples that there are uncertainties in the parameters that can not
be ignored. These uncertainties become crucial for reliable forecast of new infected,
hospitalized, and deceased cases into the future based on the model output, as well
as for risk-averse optimal mitigation design to flatten the curve.
Finally, we show the comparison of the statistics (mean and 90% credible interval)
of the model outputs at the prior samples and the posterior samples in Figures 12 and
14 for confirmed and hospitalized cases, and in Figures 13 and 15 for deceased cases.
From these figures we can observe that the variation of the model outputs is considerably reduced from the prior to the posterior samples. Moreover, most of the data,
except for a few data points that is largely uncertain or possibly incorrect/outlier,
fall inside the 90% credible interval of the model outputs, which demonstrate the
reliability and advantage of the Bayesian inference that account for the parameter

23

BAYESIAN INFERENCE OF HETEROGENEOUS EPIDEMIC MODEL

2

time independent parameters for New Jersey

time independent parameters for Texas

posterior mean
deterministic
log(parameters)

1
log(parameters)

posterior mean
deterministic

1

0
1

0
1
2

2
1

2

1

2

1

2

1

2

I
1

I
2

H
1

H
2 C11 C12 C21 C21

1

2

1

2

1

2

1

2

I
1

I
2

H
1

H
2 C11 C12 C21 C21

Fig. 9. Optimal values by deterministic inversion, and sample mean and 90% credible interval
(90% samples fall in this interval) of the posterior samples by Bayesian inference for time independent parameters. Note that the values are shown for h in (5.8), i.e., logarithm of the parameters,
to have better visualization. Left: New Jersey. Right: Texas.

1.0
0.8
0.6
0.4
0.2
0.0
1.0
0.8
0.6
0.4
0.2
0.0

1.0
0.8
0.6
0.4
0.2
0.0
1.0
0.8
0.6
0.4
0.2
0.0

transmission reduction factor in New Jersey

posterior mean
deterministic
Mar

Apr

May

Jun

Jul

Mar

Apr

May

Jun

Jul

Aug
Sep
2020
posterior mean
deterministic

Aug

Sep

2020

infection hospitalization ratio in New Jersey
posterior mean
deterministic

Mar

Apr

May

Jun

Jul

Mar

Apr

May

Jun

Jul

Aug
Sep
2020
posterior mean
deterministic

Aug

1.0
0.8
0.6
0.4
0.2
0.0
1.0
0.8
0.6
0.4
0.2
0.0

Sep

2020

1.0
0.8
0.6
0.4
0.2
0.0
1.0
0.8
0.6
0.4
0.2
0.0

infection confirmation ratio in New Jersey
posterior mean
deterministic

Mar

Apr

May

Jun

Jul

Mar

Apr

May

Jun

Jul

Aug
Sep
2020
posterior mean
deterministic

Aug

Sep

2020

hospitalization fatality ratio in New Jersey
posterior mean
deterministic

Mar

Apr

May

Jun

Jul

Mar

Apr

May

Jun

Jul

Aug
Sep
2020
posterior mean
deterministic

Aug

Sep

2020

Fig. 10. Optimal sample by deterministic inversion, posterior sample mean, and 90% credible
interval (90% samples fall in this interval) of the posterior samples by Bayesian inference for the
time dependent parameters inside LTC (top) and outside LTC (bottom) in New Jersey.

and data uncertainties. Despite this ability in quantifying the uncertainties in both
the parameters and model outputs, we caution that the credible intervals of different
parameters and model outputs are evidently different, e.g., the credible intervals for
the number of total confirmed and deceased cases are much smaller than that of the

24

P. CHEN, K. WU, AND O. GHATTAS

transmission reduction factor in Texas

1.0
0.8
0.6
0.4
0.2
0.0
Mar
1.0
0.8
0.6
0.4
0.2
0.0
Mar

posterior mean
deterministic
Apr

May

Jun

Jul

Aug

Sep

2020

posterior mean
deterministic
Apr

May

Jun

Jul

Aug

Sep

2020

infection hospitalization ratio in Texas

1.0
0.8
0.6
0.4
0.2
0.0
Mar
1.0
0.8
0.6
0.4
0.2
0.0
Mar

posterior mean
deterministic

Apr

May

Jun

Jul

Apr

May

Jun

Jul

Aug
Sep
2020
posterior mean
deterministic

Aug

Sep

2020

1.0
0.8
0.6
0.4
0.2
0.0
Mar
1.0
0.8
0.6
0.4
0.2
0.0
Mar
1.0
0.8
0.6
0.4
0.2
0.0
Mar
1.0
0.8
0.6
0.4
0.2
0.0
Mar

infection confirmation ratio in Texas
posterior mean
deterministic

Apr

May

Jun

Jul

Apr

May

Jun

Jul

Aug
Sep
2020
posterior mean
deterministic

Aug

Sep

2020

hospitalization fatality ratio in Texas
posterior mean
deterministic

Apr

May

Jun

Jul

Apr

May

Jun

Jul

Aug
Sep
2020
posterior mean
deterministic

Aug

Sep

2020

Fig. 11. The same as in Figure 10 for Texas.

hospitalized, and daily confirmed and deceased cases, while the credible intervals for
the number of LTC deceased cases are relatively larger than that of the total number
of deceased cases, etc., which may bring in over or under confidence on the inference
results. This is probably due to the relatively simple choice of the prior distribution
of the parameters and the distribution of the observation noise.
5.4. Forecast under uncertainty. In this section, we compare the model forecast under uncertainty and compare the forecast results with the data. We divide the
data into two parts, one part including all but the last four weeks, which are used for
parameter inference, and the other part including only the last four weeks, which are
used for comparison with the forecast. We run pSVGD for Bayesian inference of the
parameters with 1000 samples for 100 iterations. We use the 1000 samples at the end
of iteration to make forecast for the last four weeks, during which the time dependent parameters are assigned with values at the end of the inference period, i.e., one
day before the last four weeks. The inference and forecast results for the confirmed,
hospitalized, and deceased cases are shown in Figure 16 for New Jersey and Figure
17 for Texas. We can observe a relatively good agreement of most of the data and
the model forecast at both the optimal parameters by deterministic inversion and the
sample posterior mean. However, some of the model forecast evidently depart from
the data, e.g., the hospitalized cases in Texas with sharp change, due to the evident
dynamic change of epidemics reflected by the time dependent parameters (e.g., IHR
and HFR outside LTC) in the last four weeks, see Figure 11. Nevertheless, the data
still fall in the 90% credible interval of the forecast. We can also observe that the

25

BAYESIAN INFERENCE OF HETEROGENEOUS EPIDEMIC MODEL

104

data
deterministic
posterior mean

103
102

Apr

May

Jun

Jul

Aug

2020

data
deterministic
posterior mean
May

Jun

Jul

Aug

# hospitalized in New Jersey

Sep

104

102

Apr

May

Jun

Jul

Apr

May

Jun

Jul

103
102

Aug
Sep
2020
data
deterministic
posterior mean

Aug

# hospitalized in New Jersey

Sep

2020

data
deterministic
posterior mean

104

# hospitalized

103

data
deterministic
posterior mean

103

2020

data
deterministic
posterior mean

104

105

Sep

103
101

# total confirmed

105

Apr

# hospitalized

# confirmed in New Jersey

# daily confirmed

# daily confirmed

# total confirmed

# confirmed in New Jersey

103

101
100
Apr

May

Jun

Jul

Aug

Sep

2020

Apr

May

Jun

Jul

Aug

Sep

2020

Fig. 12. Comparison of the data and model outputs for confirmed and hospitalized cases by both
the deterministic inversion and the Bayesian inference. The data here are the same as the seven
day moving average data in Figure 2. The deterministic model outputs are the results of model (2.1)
at the optimal parameter value obtained by the deterministic inversion (4.9). The sample mean and
90% credible interval (90% samples fall in this interval) of the model outputs are obtained as the
results of model (2.1) at the prior samples (left) and Bayesian posterior samples (right).

longer the forecast is, the larger the uncertainty of the forecast results become.
6. Conclusions. We have proposed a Bayesian inference framework for learning
the dynamics of COVID-19, with application to the spread and outcome inside and
outside LTC facilities, which have experienced about 40% of total COVID-19 caused
and/or related deaths. We designed an LTC stratified SEIR compartmental model
with extended compartments of confirmed and unconfirmed positive infections, hospitalization, and death to account for the available data on the number of positively
confirmed, hospitalized, and deceased cases, as well as the number of deceased cases
inside LTC facilities. To estimate the parameters in the model, including the timedependent transmission reduction factors, various epidemic rates and proportions, as
well as the contact matrix—and more importantly quantify the uncertainties in the
parameters, model outputs, and data—we investigated both a deterministic inversion
and a Bayesian inference approach that builds on the deterministic result. The deterministic inversion with our model was demonstrated to effectively capture the main
dynamics, while the Bayesian inference method was demonstrated to achieve reliable
quantification of various uncertainties, in particular providing tight 90% credible intervals that sufficiently cover the data. The high dimensional Bayesian inversion was
made tractable by our pSVGD method’s ability to exploit the two orders of magnitude effective dimensionality reduction inherent in inferring the model parameters

26

P. CHEN, K. WU, AND O. GHATTAS

103
101
10

1

Apr

May

# total deceased

104

Jun

Jul

Aug

May

Jun

Jul

Aug

# LTC deceased in New Jersey

22May

22 Jun

22 Jul

22 Aug

2

22 Jun

22 Jul

22 Aug

103
101

22 Sep

2020-Sep

Apr

May

Jun

Jul

Aug

Sep

Jun

Jul

Aug

Sep

2020

102
101

data
deterministic
posterior mean
Apr

May

# LTC deceased in New Jersey
6 × 103
4 × 103
3 × 103
2 × 103

22 Sep

2020-Sep

data
deterministic
posterior mean

102

2020

data
deterministic
posterior mean
22May

104

Sep

data
deterministic
posterior mean

102

10

2020

data
deterministic
posterior mean

103

100

Sep

# daily deceased

101

# total deceased

data
deterministic
posterior mean

102

# total deceased

103

Apr

# daily deceased

# deceased in New Jersey

22 Jun

22 Jul

22 Aug

22 Jul

22 Aug

102
101
100

2020

data
deterministic
posterior mean
22May

# daily deceased

# daily deceased

# total deceased

# deceased in New Jersey
104

22 Sep

2020-Sep

data
deterministic
posterior mean
22May

22 Jun

22 Sep

2020-Sep

Fig. 13. The same as in Figure 12 for total deceased cases (top) and deceased cases inside LTC
(bottom) in New Jersey.

from the available data. The posterior predictives produced by the Bayesian inference
play a critical role in a solution of a risk-averse stochastic optimal control problem to
find optimal mitigation strategies for COVID-19, which are presented in a follow-on
article [11].
Limitations of this work include: (1) The data we use inevitably include incorrect
and delayed numbers, as discussed for the data in Figure 2 and 3. We accounted
for these flaws only by smoothing the data using seven day moving averages. If they
were available, additional data could improve the results of the inferences, e.g., the
number of daily confirmed cases inside LTC, state dependent hospitalization ratios,
time-dependent positive/negative ratio of the viral test, etc. (2) The model we constructed is, as mentioned in Section 2, as simple as possible for our target of learning
the dynamics inside and outside LTC. Though it would have been straightforward to
incorporate in our model, we did not account for the age- and risk-dependent heterogeneities in infection hospitalization and fatality ratios; their effect can be observed
in the widening misfit in the number of deaths in recent months, probably due to the
shift of infections toward a younger and healthier population.
Acknowledgement. We thank Nick Alger, Amal Alghamdi, Joshua Chen, Ionut
Farcas, Longfei Gao, Dingchen Luo, Thomas O’Leary-Roseberry, and Bassel Saleh for
helpful discussions.
References.
[1] A. Alexanderian, N. Petra, G. Stadler, and O. Ghattas, A-optimal

27

BAYESIAN INFERENCE OF HETEROGENEOUS EPIDEMIC MODEL

data
deterministic
posterior mean

103
May

Jun

Jul

Aug

2020

data
deterministic
posterior mean

102
Apr

May

Jun

Jul

Aug

# hospitalized in Texas

data
deterministic
posterior mean

103
Apr

Jul

Aug

Apr

May

Jun

Jul

Aug

# hospitalized in Texas

# hospitalized

Sep

2020

data
deterministic
posterior mean

102

Sep

2020

data
deterministic
posterior mean

104

103

Jun

103

2020

104

May

104

Sep

data
deterministic
posterior mean
# hospitalized

105

Sep

104
103

# total confirmed

105

Apr
# daily confirmed

# confirmed in Texas

# daily confirmed

# total confirmed

# confirmed in Texas

103

102
Apr

May

Jun

Jul

Aug

Sep

2020

Apr

May

Jun

Jul

Aug

Sep

2020

Fig. 14. The same as in Figure 12 for Texas here.

[2]

[3]

[4]

[5]

[6]

design of experiments for infinite-dimensional Bayesian linear inverse problems
with regularized `0 -sparsification, SIAM Journal on Scientific Computing, 36
(2014), pp. A2122–A2148, https://doi.org/10.1137/130933381.
O. Bashir, K. Willcox, O. Ghattas, B. van Bloemen Waanders, and
J. Hill, Hessian-based model reduction for large-scale systems with initial condition inputs, International Journal for Numerical Methods in Engineering, 73
(2008), pp. 844–868.
A. Beskos, M. Girolami, S. Lan, P. E. Farrell, and A. M.
Stuart, Geometric MCMC for infinite-dimensional inverse problems, Journal of Computational Physics, 335 (2017), pp. 327 – 351, https://doi.
org/https://doi.org/10.1016/j.jcp.2016.12.041, http://www.sciencedirect.com/
science/article/pii/S0021999116307033.
T. Bui-Thanh, C. Burstedde, O. Ghattas, J. Martin, G. Stadler, and
L. C. Wilcox, Extreme-scale UQ for Bayesian inverse problems governed by
PDEs, in SC12: Proceedings of the International Conference for High Performance Computing, Networking, Storage and Analysis, 2012.
T. Bui-Thanh and O. Ghattas, Analysis of the Hessian for inverse scattering
problems. Part I: Inverse shape scattering of acoustic waves, Inverse Problems,
28 (2012), p. 055001, https://doi.org/10.1088/0266-5611/28/5/055001.
T. Bui-Thanh, O. Ghattas, J. Martin, and G. Stadler, A computational framework for infinite-dimensional Bayesian inverse problems Part I: The
linearized case, with application to global seismic inversion, SIAM Journal on
Scientific Computing, 35 (2013), pp. A2494–A2523, https://doi.org/10.1137/

28

P. CHEN, K. WU, AND O. GHATTAS

103

Apr

# total deceased

Jun

Jul

Aug

Sep

2020

102
data
deterministic
posterior mean

101
Apr

May

Jun

Jul

Aug

# LTC deceased in Texas

104
103

Jun

15

Jul

15

Aug

15

102
101

15

Jun

15

Jul

15

Aug

15

Sep

2020-Sep

data
deterministic
posterior mean

102
101

Apr

May

Jun

Jul

Aug

Sep

2020

102
data
deterministic
posterior mean

101
Apr

May

Jun

Jul

Aug

# LTC deceased in Texas

Sep

2020

data
deterministic
posterior mean

103

Sep

data
deterministic
posterior mean

100

103

2020

2020-Sep

# deceased in Texas

104

Sep

data
deterministic
posterior mean

102
15

# daily deceased

May

# daily deceased

101

# total deceased

data
deterministic
posterior mean

102

# total deceased

103

15
# daily deceased

# daily deceased

# total deceased

# deceased in Texas
104

Jun

15

Jul

15

Aug

15

102

Sep

2020-Sep

data
deterministic
posterior mean

101
15

Jun

15

Jul

15

Aug

15

Sep

2020-Sep

Fig. 15. The same as in Figure 12 for total deceased cases (top) and deceased cases inside LTC
(bottom) in Texas.

12089586X.
[7] T. Bui-Thanh and M. A. Girolami, Solving large-scale PDE-constrained
Bayesian inverse problems with Riemann manifold Hamiltonian Monte Carlo,
Inverse Problems, 30 (2014), p. 114014.
[8] P. Chen and O. Ghattas, Hessian-based sampling for high-dimensional model
reduction, International Journal for Uncertainty Quantification, 9 (2019).
[9] P. Chen and O. Ghattas, Projected stein variational gradient descent, Advances in Neural Information Processing Systems, (2020).
[10] P. Chen and O. Ghattas, Stein variational reduced basis Bayesian inversion,
arXiv preprint arXiv:2002.10924, (2020).
[11] P. Chen and O. Ghattas, Stochastic optimization of heterogeneous epidemic
models: Application to COVID-19 spread accounting for LTC facilities, preprint,
(2020).
[12] P. Chen and C. Schwab, Sparse-grid, reduced-basis Bayesian inversion, Computer Methods in Applied Mechanics and Engineering, 297 (2015), pp. 84 – 115.
[13] P. Chen and C. Schwab, Adaptive sparse grid model order reduction for fast
Bayesian estimation and inversion, in Sparse Grids and Applications-Stuttgart
2014, Springer, 2016, pp. 1–27.
[14] P. Chen and C. Schwab, Sparse-grid, reduced-basis Bayesian inversion:
Nonaffine-parametric nonlinear equations, Journal of Computational Physics,
316 (2016), pp. 470 – 503.
[15] P. Chen, U. Villa, and O. Ghattas, Hessian-based adaptive sparse quadra-

29

BAYESIAN INFERENCE OF HETEROGENEOUS EPIDEMIC MODEL

data
deterministic
posterior mean

103
102

Apr

May

Jun

Jul

Aug

2020

103
102

data
deterministic
posterior mean
May

Jun

Jul

Aug

Sep

101

# total deceased

data
deterministic
posterior mean

102
Apr

May

Jun

Jul

Aug

2020

data
deterministic
posterior mean
Apr

May

Jun

Jul

Aug

104

Sep

2020

May

Jun

Jul

Aug

# LTC deceased in New Jersey

6 × 103
4 × 103
3 × 103
2 × 103

Sep

102
101

data
deterministic
posterior mean
Apr

2020

104
103

103

102

# deceased in New Jersey
# total deceased

Sep

# hospitalized

104

104

Apr

# daily deceased

# hospitalized in New Jersey

22 Jun

22 Jul

22 Aug

22 Jul

22 Aug

102
101
100
10 1

Sep

2020

data
deterministic
posterior mean
22May

# daily deceased

# daily confirmed

# total confirmed

# confirmed in New Jersey
105

22 Sep

2020-Sep

data
deterministic
posterior mean
22May

22 Jun

22 Sep

2020-Sep

Fig. 16. Comparison of the data and model outputs for confirmed cases (top-left), hospitalized
cases (top-right), total deceased cases (bottom-left), and deceased cases inside LTC (bottom-right)
by both the deterministic inversion and the Bayesian inference using data except for the last four
weeks, as well as forecast results in the last four weeks, which are separated by the dashed line. The
data here are the same as the seven day moving average data in Figure 2. The deterministic model
outputs are the results of model (2.1) at the optimal parameter value obtained by the deterministic
inversion (4.9). The sample mean and 90% credible interval (90% samples fall in this interval) of
the model outputs are obtained as the results of model (2.1) at the prior samples (left) and posterior
samples (right) from the Bayesian inference.

[16]

[17]

[18]

[19]

[20]

ture for infinite-dimensional Bayesian inverse problems, Computer Methods in
Applied Mechanics and Engineering, 327 (2017), pp. 147–172, https://doi.org/
10.1016/j.cma.2017.08.016.
P. Chen, U. Villa, and O. Ghattas, Taylor approximation and variance reduction for PDE-constrained optimal control under uncertainty, Journal of Computational Physics, 385 (2019), pp. 163–186, https://arxiv.org/abs/1804.04301.
P. Chen, K. Wu, J. Chen, T. O’Leary-Roseberry, and O. Ghattas, Projected Stein variational Newton: A fast and scalable Bayesian inference method
in high dimensions, Advances in Neural Information Processing Systems, (2019).
M. Chinazzi, J. T. Davis, M. Ajelli, C. Gioannini, M. Litvinova,
S. Merler, A. P. y Piontti, K. Mu, L. Rossi, K. Sun, et al., The effect
of travel restrictions on the spread of the 2019 novel coronavirus (COVID-19)
outbreak, Science, 368 (2020), pp. 395–400.
I. COVID, C. J. Murray, et al., Forecasting COVID-19 impact on hospital
bed-days, ICU-days, ventilator-days and deaths by US state in the next 4 months,
MedRxiv, (2020).
T. Cui, K. Law, and Y. Marzouk, Dimension-independent likelihood-

30

P. CHEN, K. WU, AND O. GHATTAS

data
deterministic
posterior mean
May

Jun

104

Jul

Aug

103

2020

May

Jun

Jul

Aug

Sep

data
deterministic
posterior mean

102
103

# total deceased

103

Apr

May

Jun

Jul

Aug

2020

data
deterministic
posterior mean
Apr

May

Jun

Jul

Aug

Sep

2020

May

Jun

Jul

Aug

# LTC deceased in Texas

104

Sep

2020

data
deterministic
posterior mean

103

Sep

102
101

Apr

2020

104

101

103

data
deterministic
posterior mean

102

# deceased in Texas
# total deceased

Sep

104

# hospitalized

103

Apr

# daily deceased

data
deterministic
posterior mean

105

Apr
# daily confirmed

# hospitalized in Texas

# daily deceased

# total confirmed

# confirmed in Texas

102

15
Jun 15
data
deterministic
posterior mean

Jul

15

Aug

15

15

Jul

15

Aug

15

Sep

2020-Sep

101
Jun

15

Sep

2020-Sep

Fig. 17. The same as in Figure 16 for Texas here.

informed MCMC, Journal of Computational Physics, 304 (2016), pp. 109–137.
[21] T. Cui, J. Martin, Y. M. Marzouk, A. Solonen, and A. Spantini,
Likelihood-informed dimension reduction for nonlinear inverse problems, Inverse
Problems, 30 (2014), p. 114015, http://stacks.iop.org/0266-5611/30/i=11/a=
114015.
[22] T. Cui, Y. Marzouk, and K. Willcox, Scalable posterior approximations for
large-scale bayesian inverse problems via likelihood-informed parameter and state
reduction, Journal of Computational Physics, 315 (2016), pp. 363–387.
[23] G. Detommaso, T. Cui, Y. Marzouk, A. Spantini, and R. Scheichl, A
stein variational Newton method, in Advances in Neural Information Processing
Systems, 2018, pp. 9187–9197.
[24] N. Ferguson, D. Laydon, G. Nedjati Gilani, N. Imai, K. Ainslie,
M. Baguelin, S. Bhatia, A. Boonyasiri, Z. Cucunuba Perez, G. CuomoDannenburg, et al., Report 9: Impact of non-pharmaceutical interventions
(NPIs) to reduce COVID19 mortality and healthcare demand, (2020).
[25] P. H. Flath, L. C. Wilcox, V. Akçelik, J. Hill, B. van Bloemen Waanders, and O. Ghattas, Fast algorithms for Bayesian uncertainty quantification in large-scale linear inverse problems based on low-rank partial Hessian approximations, SIAM Journal on Scientific Computing, 33 (2011), pp. 407–432,
https://doi.org/10.1137/090780717.
[26] H. W. Hethcote, The mathematics of infectious diseases, SIAM review, 42
(2000), pp. 599–653.
[27] T. Isaac, N. Petra, G. Stadler, and O. Ghattas, Scalable and effi-

BAYESIAN INFERENCE OF HETEROGENEOUS EPIDEMIC MODEL

[28]

[29]
[30]
[31]
[32]
[33]

[34]

[35]

[36]

[37]

[38]

[39]

[40]
[41]

[42]

31

cient algorithms for the propagation of uncertainty from data through inference
to prediction for large-scale problems, with application to flow of the Antarctic
ice sheet, Journal of Computational Physics, 296 (2015), pp. 348–368, https:
//doi.org/10.1016/j.jcp.2015.04.047.
P. K. Jha, L. Cao, and J. T. Oden, Bayesian-based predictions of COVID-19
evolution in Texas using multispecies mixture-theoretic continuum models, Computational Mechanics, (2020), pp. 1–14.
M. J. Keeling and P. Rohani, Modeling infectious diseases in humans and
animals, Princeton University Press, 2011.
I. Z. Kiss, J. C. Miller, P. L. Simon, et al., Mathematics of epidemics on
networks, Cham: Springer, 598 (2017).
D. Kraft et al., A software package for sequential quadratic programming,
(1988).
W. Lee, S. Liu, H. Tembine, W. Li, and S. Osher, Controlling Propagation
of epidemics via mean-field games, arXiv preprint arXiv:2006.01249, (2020).
R. Li, S. Pei, B. Chen, Y. Song, T. Zhang, W. Yang, and J. Shaman,
Substantial undocumented infection facilitates the rapid dissemination of novel
coronavirus (SARS-CoV-2), Science, 368 (2020), pp. 489–493.
K. Linka, M. Peirlinck, and E. Kuhl, The reproduction number of COVID19 and its correlation with public health interventions, Computational Mechanics,
66 (2020), pp. 1035–1050.
Q. Liu and D. Wang, Stein variational gradient descent: A general purpose
Bayesian inference algorithm, in Advances In Neural Information Processing Systems, 2016, pp. 2378–2386.
J. Martin, L. C. Wilcox, C. Burstedde, and O. Ghattas, A stochastic
Newton MCMC method for large-scale statistical inverse problems with application to seismic inversion, SIAM Journal on Scientific Computing, 34 (2012),
pp. A1460–A1487, https://doi.org/10.1137/110845598.
S. M. Moghadas, A. Shoukat, M. C. Fitzpatrick, C. R. Wells, P. Sah,
A. Pandey, J. D. Sachs, Z. Wang, L. A. Meyers, B. H. Singer, et al.,
Projecting hospital utilization during the COVID-19 outbreaks in the United
States, Proceedings of the National Academy of Sciences, 117 (2020), pp. 9122–
9126.
N. Petra, J. Martin, G. Stadler, and O. Ghattas, A computational
framework for infinite-dimensional Bayesian inverse problems: Part II. Stochastic Newton MCMC with application to ice sheet flow inverse problems, SIAM
Journal on Scientific Computing, 36 (2014), pp. A1525–A1555.
R. J. Rockett, A. Arnott, C. Lam, R. Sadsad, V. Timms, K.-A. Gray,
J.-S. Eden, S. Chang, M. Gall, J. Draper, et al., Revealing COVID-19
transmission in Australia by SARS-CoV-2 genome sequencing and agent-based
modeling, Nature medicine, (2020), pp. 1–7.
A. M. Stuart, Inverse problems: A Bayesian perspective, Acta Numerica, 19
(2010), pp. 451–559, https://doi.org/10.1017/S0962492910000061.
B. Tang, X. Wang, Q. Li, N. L. Bragazzi, S. Tang, Y. Xiao, and J. Wu,
Estimation of the transmission risk of the 2019-nCoV and its implication for
public health interventions, Journal of clinical medicine, 9 (2020), p. 462.
R. Verity, L. C. Okell, I. Dorigatti, P. Winskill, C. Whittaker,
N. Imai, G. Cuomo-Dannenburg, H. Thompson, P. G. Walker, H. Fu,
et al., Estimates of the severity of coronavirus disease 2019: a model-based
analysis, The Lancet infectious diseases, (2020).

32

P. CHEN, K. WU, AND O. GHATTAS

[43] A. Viguerie, A. Veneziani, G. Lorenzo, D. Baroli, N. Aretz-Nellesen,
A. Patton, T. E. Yankeelov, A. Reali, T. J. Hughes, and F. Auricchio,
Diffusion–reaction compartmental models formulated in a continuum mechanics framework: application to COVID-19, mathematical analysis, and numerical
study, Computational Mechanics, 66 (2020), pp. 1131–1152.
[44] D. Wang, Z. Zeng, and Q. Liu, Stein variational message passing for continuous graphical models, in International Conference on Machine Learning, 2018,
pp. 5206–5214.
[45] K. Wang, T. Bui-Thanh, and O. Ghattas, A randomized maximum a posteriori method for posterior sampling of high dimensional nonlinear Bayesian
inverse problems, SIAM Journal on Scientific Computing, 40 (2018), pp. A142–
A171, https://doi.org/10.1137/16M1060625.
[46] S. Woody, M. G. Tec, M. Dahan, K. Gaither, M. Lachmann, S. Fox,
L. A. Meyers, and J. G. Scott, Projections for first-wave COVID-19 deaths
across the US using social-distancing measures derived from mobile phones,
medRxiv, (2020).
[47] J. Zhuo, C. Liu, J. Shi, J. Zhu, N. Chen, and B. Zhang, Message passing Stein variational gradient descent, in International Conference on Machine
Learning, 2018, pp. 6018–6027.
Appendix A. Adjoint-based computation of the gradient.
Without loss of generality, we consider a system of parametric ordinary differential
equations
(
yt (t) = f (t, y(t), θ) t ∈ (0, T ],
(A.1)
y(0) = y0 ,
where the state y(t) ∈ Rn , with initial condition y0 that does not depend on the
d
y(t) represents the time derivative of y(t).
parameter θ ∈ Rd . The term yt (t) = dt
The right hand side f : R × Rn × Rd → Rn . Suppose we have an objective function
J(θ) to minimize w.r.t. θ, which can be written as
Z
(A.2)

J(θ) =

T

g(t, y(t), θ)dt,
0

where y(t) implicitly depends on the parameter θ through the ODE system (A.1),
g : R × Rn × Rd → R may explicitly depend on the parameter θ, e.g., through a
regularization term. The goal is to compute the gradient of the objective ∇θ J(θ),
subject to the ODE system (A.1). We introduce the adjoint variables λ : [0, T ] → Rn
and write
Z T
Z T
(A.3)
J(θ) =
g(t, y(t), θ)dt +
λT (t)(yt (t) − f (t, y(t), θ))dt
t=0

t=0

where the last two terms are zeros since (A.1) hold. Note that y implicitly depends
on θ, we have
Z

T

∇θ J(θ) =

∂y g(t, y(t), θ)∂θ y(t) + ∂θ g(t, y(t), θ)dt
t=0
Z T

(A.4)
+

t=0

λT (t)(∂θ yt (t) − ∂y f (t, y(t), θ)∂θ y(t) − ∂θ f (t, y(t), θ))dt

BAYESIAN INFERENCE OF HETEROGENEOUS EPIDEMIC MODEL

33

d
∂θ y(t) under the assumption that y is continuous in the domain
Note that ∂θ yt (t) = dt
of t and θ. Using integration by parts for the first term in the second line, we have

Z

T

(A.5)


λT (t)∂θ yt (t)dt = λT (t)∂θ y(t)

t=0

T
0

Z

T

−

λTt (t)∂θ y(t)dt.

t=0

Reorganizing (A.4) by putting the terms with ∂θ y(t) together we obtain
Z

T

∇θ J(θ) =
(A.6)

Z


−λTt (t) − λT (t)∂y f (t, y(t), θ) + ∂y g(t, y(t), θ) ∂θ y(t)dt

t=0
T

+


∂θ g(t, y(t), θ) − λT (t)∂θ f (t, y(t), θ) dt

t=0

+ λT (T )∂θ y(T )
To eliminate the terms with ∂θ y(t) and ∂θ y(T ), we set the adjoint ODE system
(
λTt (t) = −λT (t)∂y f (t, y(t), θ) + ∂y g(t, y(t), θ), t ∈ [0, T ),
(A.7)
λ(T ) = 0,
which leads to the final result
Z T

(A.8)
∇θ J(θ) =
∂θ g(t, y(t), θ) − λT (t)∂θ f (t, y(t), θ) dt
t=0

for which we need to solve the ODE system (A.1) for y(t), then solve the adjoint
ODE system (A.7) for λT (t), and finally compute (A.8). Note that the gradient
∂y f (t, y(t), θ) ∈ Rn×n , ∂y g(t, y(t), θ) ∈ Rn , ∂θ g(t, y(t), θ) ∈ Rd , and ∂θ f (t, y(t), θ) ∈
Rn×d can be obtained using symbolic differentiation when f and g have complicated
dependence on y and θ.

