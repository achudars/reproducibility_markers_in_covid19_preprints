On the Interplay of Regional Mobility,
Social Connectedness, and the Spread of
COVID-19 in Germany
Cornelius Fritz and Göran Kauerman
Department of Statistics, LMU Munich

arXiv:2008.03013v2 [stat.AP] 16 Feb 2021

February 17, 2021

Abstract
Since the primary mode of respiratory virus transmission is person-to-person
interaction, we are required to reconsider physical interaction patterns to mitigate
the number of people infected with COVID-19. Since non-pharmaceutical interventions (NPI) had an evident impact on national mobility patterns, we investigate
the relative regional mobility behaviour to assess the effect of human movement on
the spread of COVID-19. In this paper, we, therefore, explore the impact of human
mobility and social connectivity derived from Facebook activities on the weekly rate
of new infections in Germany between March 3rd and June 22nd, 2020. Our results confirm that reduced social activity lowers the infection rate, accounting for
regional and temporal patterns. The extent of social distancing, quantified by the
percentage of people staying put within a federal administrative district, has an
overall negative effect on the incidence of infections. Additionally, our results show
spatial infection patterns based on geographic as well as social distances.
Keywords – COVID-19, Infectious Disease Modelling, Semiparametric Regression,
Spatial Network Data, Social Connectedness, Social Networks

1

1

Introduction

The COVID-19 virus outbreak originating in mainland China (Wu et al., 2020) leapt
over to Europe and quickly evolved to a global pandemic in March 2020 (WHO, 2020).
Only through strict non-pharmaceutical interventions (NPI), most national health systems
could react to this new threat rapidly. In numerous scientific efforts, physical distancing measures were discovered to be the most effective interventions (Prem et al., 2020;
Flaxman et al., 2020) and found to be necessary maybe until 2022 (Kissler et al., 2020).
Such measures’ effectiveness emanates from researchers confirming that the main form
of virus transmission is person-to-person interaction (Chan et al., 2020). In particular,
the virus can be spread by inhaling microscopic aerosol particles that contain COVID-19
and remain viable in the air with a half-life of about 1 hour (Van Doremalen et al., 2020;
Asadi et al., 2020) or direct contact through the exchange of virus-containing droplets
with infected individuals (Guan et al., 2020; Li et al., 2020). Since also, many cases are
asymptomatic (Lavezzo et al., 2020) and get infected by asymptomatic cases (Li et al.,
2020), human mobility can explain the spread of COVID-19 to no small extent (Kraemer
et al., 2020).
Stemming from the consequential need to account for contact patterns when investigating the spread of COVID-19, Oliver et al. (2020) list multiple possibilities how one
may utilise mobile phone data in the data analysis. To enable this type of research,
Facebook extended the Data for Good program to a broader audience of researchers and
provided so-called Disease Prevention Maps for multiple countries (Maas et al., 2019).
This database includes measurements on quantities like co-location, Facebook population, and movement range derived from information of more than 26 million Facebook
users. These data are available on a regional level. Additionally, a measure for the social
connectedness between geographic regions is supplied (Bailey et al., 2018). In various
studies, the data were employed to demonstrate how the impact of lock-down measures
in Italy was more severe for municipalities with higher fiscal capacities (Bonaccorsi et al.,
2020), quantify social and geographic spillover effects from relaxations of shelter-in-place
orders (Holtz et al., 2020), and predict the number of infections on a fine spatiotemporal
resolution using contact tracing data (Lorch et al., 2020).
In this article, we use the Facebook data to analyse how regional differences in mobility
patterns and friendship proximity affect the spread of COVID-19 in Germany. While
NPIs, e.g., the nationwide shutdown in Germany that started March 22nd, had an evident
impact on the nationwide human mobility and ceased the exponential spread of the virus
(Flaxman et al., 2020), the effect of the relative movement between regional districts was
not yet fully assessed. So far studies concerning human movements during the current
pandemic are largely focused on how the lock-down affected national human mobility
(Galeazzi et al., 2020) or specific regions regarding their economical status (Bonaccorsi
et al., 2020). To fill this gap, we derive covariates from the mobility data to quantify the
overall dispersion of meeting patterns and compliance with social distancing. Through
weekly standardisation of the covariates, we control for the dynamics therein, which are,
in turn, driven by NPIs. Therefore, our research enables a quantitative assessment of
different mobility strategies relative to the national average. Also, we infer positions of
the federal administrative regions in a social space from the information on the relative
friendship links among them (Bailey et al., 2018) using multidimensional scaling (Cox and
Cox, 2000; Borg et al., 2013). Subsequently, we relate the processed data to the weekly
rate of COVID-19 infections in Germany between March 3rd and June 22nd, 2020. This
2

time frame permits the analysis of the dynamic spread starting with the WHO declaring
COVID-19 a pandemic (WHO, 2020).
We employ a spatio-temporal regression model for the ratio of local COVID-19 infections that takes autoregressive structures, age and sex-specific effects, contagion by nearby
districts in the geographic and social space, as well as latent heterogeneities between the
districts into account. Our method is closely related to the surveillance model introduced
by Held et al. (2005). They extend generalised linear models to analyse surveillance data
from epidemic outbreaks. This approach was expanded to handle multivariate surveillance data (Paul et al., 2008), control for seasonality and spatial heterogeneity (Held and
Paul, 2012), and include neighbourhood information from social contact data (Meyer and
Held, 2017). In contrast to this type of model, our model’s objective is to investigate the
connection between mobility patterns, social connectivity, and the spread of COVID-19
in an interpretable manner. While forecasting infections is certainly a central objective in
epidemic surveillance, this is not the main focus of our work (see also Held et al., 2017).
The rest of the article will be structured as follows: We discuss the data sources,
its measures on social interaction as well as mobility and propose an imputation model
for missing onset dates in Section 2. In Section 3, we propose a semiparametric spatiotemporal model for the ratio of local COVID-19 infections. The results of the analysis
are presented in Section 4. Lastly, Section 5 concludes the article.

2
2.1

Data Description
Data on Social Activity during COVID-19

For Germany, the data are generated from approximately 10 million Facebook users,
who enabled geolocation features accessible by Facebook on their devices. To abide by
the privacy policies, the observations are anonymised through aggregation onto tile bing
polygons (Microsoft, 2020), censoring if not enough users were observed in the spatial
region, as well as randomisation using additional noise and spatial smoothing (Maas et al.,
2019). Considering that the aim is to draw conclusions on the regional level, we aggregate
the polygons to the 401 federal administrative districts in Germany (we set n = 401 and a
complete list is given by the German Federal Statistical Office). We propose the following
measures describing social interaction and mobility. All measures are taken on a weekly
level, where simple averaging is used for quantities that are available at a finer temporal
resolution.
Co-location: Co-location in week t is measured by the probability pi j,t of a random
person from district i to be located in the same 0.6km × 0.6km square as another random
person from district j (Iyer et al., 2020). These probabilities are then used to construct
a district-wise quantity for the concentration of meeting patterns using the Gini index,
which is given by:
xi,t,gini =

P

|pim,t − pil,t |
2n j6=i pi j,t

m,l6=i

P

If we were to observe the maximal value of 1 in xi,t,gini , all people within federal district
i would only meet people (i.e. Facebook users) from only one further district. This
behaviour is exemplary of extremely restricted mobility. Conversely, a lower value heuristically indicates dispersed meeting patterns. Due to this intuitive interpretation, we opt
for the Gini index as a measure of concentration. The Gini indices’ temporal paths for
3

(a)

(b)
Normalized Gini Index per District

Gini Index per District

1.00

0.95

0.90

0

−2

−4

03
−
03 03
−
03 10
−
03 17
−
03 24
−
04 31
−
04 07
−
04 14
−
04 21
−
05 28
−
05 05
−
05 12
−
05 19
−
06 26
−
06 02
−
06 09
−1
6

03
−
03 03
−
03 10
−
03 17
−
03 24
−
04 31
−
04 07
−
04 14
−
04 21
−
05 28
−
05 05
−
05 12
−
05 19
−
06 26
−
06 02
−
06 09
−1
6

0.85

2

Week

Percentage of People Staying Put

(c)
0.40
0.35
0.30
0.25
0.20

03
−
03 03
−
03 10
−
03 17
−
03 24
−
04 31
−
04 07
−
04 14
−
04 21
−
05 28
−
05 05
−
05 12
−
05 19
−
06 26
−
06 02
−
06 09
−1
6

0.15

(d)
4

2

0

−2

03
−
03 03
−
03 10
−
03 17
−
03 24
−
04 31
−
04 07
−
04 14
−
04 21
−
05 28
−
05 05
−
05 12
−
05 19
−
06 26
−
06 02
−
06 09
−1
6

Normalized Percentage of People Staying Put

Week

Week

States

Baden−Württemberg
Bavaria
Berlin
Brandenburg

Week
Bremen
Hamburg
Hesse
Lower Saxony

Mecklenburg Western Pomerania
North Rhine−Westphalia
Rhineland Palatinate
Saarland

Saxony
Saxony−Anhalt
Schleswig Holstein
Thuringia

Figure 1: (a): Gini indices for each district over time. (b): Standardised Gini indices for
each district over time. (c): Percentages of people staying put for each district over time.
(d): Standardised percentages of the people staying put. The colour of the lines indicate
the state in which each state is located and the dates (mm:dd) are the first day of the
corresponding week.
the 401 districts in Germany are depicted in Figure 1 (a). Overall, the meeting patterns
become more concentrated on a few other districts as the crisis evolves. This behaviour
contrasts rather dispersed practices before the pandemic. An upward trend is visible
until the nationwide lock-down on 22nd of March, 20201 . Thereupon, meeting patterns
continue to be overall condensed, although the indices slowly decline. To enable a meaningful comparison between the respective estimates in the regression setting of Section 3,
we standardise the Gini indices per week. The standardised covariate x̃i,t,gini is shown in
Figure 1 (b) and given by
x̃i,t,gini =
1

xi,t,gini − µ̂t,gini
,
σ̂t,gini

In Bavaria the lock-down started already on the 16th of March, 2020.

4

(1)

(a)

(b)

2

Dimension 2

Berlin

0

−2

−2

States

0
Dimension 1
Baden−Württemberg
Bavaria
Berlin
Brandenburg

2

Bremen
Hamburg
Hesse
Lower Saxony

Mecklenburg Western Pomerania
North Rhine−Westphalia
Rhineland Palatinate
Saarland

Saxony
Saxony−Anhalt
Schleswig Holstein
Thuringia

Figure 2: (a): Coordinates representing the friendship distances. The colour of the points
indicate the state in which each state is located. (b): Map representing the colour legend.
P

q

P

n
1
2
where µ̂t,gini = 1n nj=1 x j,t,gini and σ̂t,gini = n−1
j=1 (x j,t,gini − µ̂t,gini ) .
Percentage Staying Put: Besides the relative attribution of co-location probabilities
to other districts, we investigate a measure that expresses how people (Facebook users)
comply with social distancing. We quantify this concept by the covariate xi,t,sp , which
is defined as the average percentage of people in district i staying put during week t.
Respective data were collected using geolocation traces of mobile devices and users are
defined to be staying put, if they are only observed in one 0.6km×0.6km square throughout
a day (Facebook, 2020). In Figure 1 (c) clear break-points are visible, giving evidence of
the temporary lock-down that started between the 17th and 24th of March. During the
following weeks, the observed values gradually level off around pre-lock-down values. We
also observe some peaks in the weeks starting on the 7th and 28th of April, which we
traced back to the different mobility behaviour during national holidays, namely Good
Friday on the 10th of April and Labour Day on the 1st of May 2020.
Similarly to the treatment of the Gini index, we standardise the percentages in the
regression setting. While the visual impression from 1 (c) insinuates that the dynamics of
people staying put are similar between districts, the standardised paths, given in Figure
1 (d), reveal local differences between them. For instance, the early look-down in Bavaria
resulted in a substantial relative increase of the respective districts between the 10th and
17th of March, see the yellow-green lines.
Friendship Distance: Spatial distance is found to be strongly associated with the
spread between regions (Kang et al., 2020). Beyond the geographic proximity, Cho et al.
(2011) argued that friendship ties explain specifically long-distance mobility. This type
of travel is fundamental for understanding the early spread of the pandemic (Chinazzi
et al., 2020). To accommodate this possible line of infection, we include a measure for the

5

strength of friendship ties between the districts of Germany. More precisely, we employ
the social connectedness index proposed by Bailey et al. (2018), which is based on an
anonymised snapshot of all active Facebook users and their friendship networks from
April 2020. For the administrative district i and j the time-invariant measure xi j,soc is
given by:
xi j,soc =

#{Friendship Ties between users in district i and j}
∀ i, j ∈ {1, . . . , n}.
#{Users in district i}#{Users in district j}

(2)

In a note, Kuchler et al. (2021) uncover high correlations between the social connectedness indices and the spread of COVID-19. This index is further processed to provide a
spatial allocation based on social instead of Euclidean distances. To do so, we first transform social connectedness to social distance dsoc by taking the reciprocal of connectedness,
1
i.e., di j,soc = xi j,soc
. Consecutively, we process these distances to coordinates using multidimensional scaling (Borg et al., 2013). In our application, this procedure’s result is a
two-dimensional representation of each district in the network defined through (2) that is
only identifiable up to the scale and rotation. Technical details on the procedure are given
in Annex A. Using Procrustes analysis, we map the rotation of the inferred coordinates
in the friendship space to be most similar to the geographic coordinates (Cox and Cox,
2008). The outcome of the algorithm for each district i is denoted by xi,soc and gives the
geo-coordinates in the friendship space as shown in Figure 2. Robust connectivity within
federal states and neighbouring districts are visible in the friendship coordinates. We also
observe that the capital, Berlin, is situated in the very centre, reflecting its unique and
highly connected position. One can also detect a persisting corridor between districts
located in former East- and West-Germany. Next to the social coordinates, we incorporated each district’s geographic coordinates xi,coord , i.e., the longitude and latitude of each
districts centroid, in our application.
Population Size: We obtained district-,age- and gender-specific population data
from the German Federal Statistical Office. To guarantee a consistent definition of agegroups, we categorised the data according to the two primary age groups by which the
infection data are reported, namely people between 15-35 and 36-59 years old. The
respective covariate is denoted for age/gender-group g in district i by xi,g,pop .

2.2

Data on Infections

The Robert-Koch-Institute provides timely data on the daily number of COVID-19 infections in Germany. We limit the present analysis to individuals, that are between 15
and 59 years old, due to the age structure in the Facebook population. Besides, the given
surveillance counts are stratified by age group (15-35 and 36-59) and gender. For each
entry, dates of symptom onset and reporting are given, although the onset date is partially
missing. Our principal analysis is based on the disease onset date since it ensures more
valid information on the infection incidence (Günther et al., 2020). Imputation of the
missing values is required and we present our method subsequently. By yi,g,t we denote
the observed (and partially imputed) counts of new onsets within district i, age/gendergroup g and week t. For completeness, we define with xi,g the corresponding indicator for
the age/gender group.
The observed rates are visualised in Figure 3 colour-coded according to the different states. Two districts, namely Guetersloh and Warendorf (North Rhine-Westphalia),
experience a local outbreak in the last weeks of the observational period (Kottasová,
6

Weekly Rate of Infections per District

150

100

50

03

−0
03 3
−1
03 0
−1
03 7
−2
03 4
−3
04 1
−0
04 7
−1
04 4
−2
04 1
−2
05 8
−0
05 5
−1
05 2
−1
05 9
−2
06 6
−0
06 2
−0
06 9
−1
6

0

Date

States

Baden−Württemberg
Bavaria
Berlin
Brandenburg

Bremen
Hamburg
Hesse
Lower Saxony

Mecklenburg Western Pomerania
North Rhine−Westphalia
Rhineland Palatinate
Saarland

Saxony
Saxony−Anhalt
Schleswig Holstein
Thuringia

Figure 3: Observed Rate of Weekly Infections for each federal district.
2020). Once the first peak of infections could be overcome, the cases in the aftermath
are increasingly attributed to these local outbreaks. For example, the local outbreak in
North Rhine-Westphalia encompasses 48% of new infections with disease onset in the
week starting on the 16th of June.

2.3

Imputation of Test Delay

In Figure 4 the proportions of missing disease onset per reporting weeks are given. Since
approximately 30 % of the onset dates are missing, a complete-case analysis could lead
to biased findings. Therefore, we propose a method to impute missing disease onset
dates under the assumption of missing at random (Little and Rubin, 2002). First, we
disaggregate the given surveillance counts to the patient level. For each complete case l,
the data includes the age/gender group indicator (xl,g ), an indicator whether the reporting
date was during a weekend (xl,weekend ), and the state (xl,state ) and district (xl,district ) in which
it was observed. We also have the date of disease onset (tl,o ) and its reporting (tl,r ).
Following Günther et al. (2020) and Glöckner et al. (2020), we use the subset of the
data without any missing dates to fit a regression model for the time span between onset
of disease and its reporting through a positive test, which we define as dl = tl,r − tl,o .
As covariates we include dummy covariates xl = (xl,g , xl,weekend , xl,state , xl,district ) and the
metric covariate tl,r itself to account for changing testing strategies, e.g. during the early
spread the test capacities were limited and patients needed to wait longer for a test to
be conducted. We assume that dl is a realisation of random variable Dl , which follows a

7

Disease Onset

Missing

Observed

Observed Counts

20000

15000

10000

5000

03
−
03 03
−
03 10
−
03 17
−
03 24
−
04 31
−
04 07
−
04 14
−
04 21
−
05 28
−
05 05
−
05 12
−
05 19
−
06 26
−
06 02
−
06 09
−1
6

0

Reporting Week

Figure 4: Count of missing and observed disease onset dates per reporting week.
Covariable
Intercept
Male
A35-A59
A35-A59:Male
Weekend

Parameter
µl
σl
(Standard Error) (Standard Error)
1.852
−1.011
(< 0.01)
0.022
0.005
−0.069
(< 0.01)
(0.024)
0.017
0.101
(< 0.01)
(0.02)
0.038
−0.027
(< 0.01)
(0.030)
−0.034
−0.049
(< 0.01)
(0.017)

Table 1: Estimates of linear effects from the imputation model.The reference group are
female individuals aged between 15 and 35 living in Baden-Württemberg.

Negative Binomial model:


Dl | xl , tl,r ∼ NB µl = exp

n

θµ> xl

o

+ f µ (tl,r ) , σl =

exp{θσ> xl

o

+ fσ (tl,r )

,

(3)

where E(Dl | xl ) = µl and Var(Dl | xl ) = µl + σl µl2 holds. A discrete-valued distribution
appears most suitable, since the patient-level data are available on a daily basis, making
the test delay inherently discrete. As indicated in (3), we model the location and scale
parameter of the distribution by separate partially linear predictors. Therefore the model
lies within the family of generalised additive models for location, scale and shape (Rigby
and Stasinopoulos, 2005). While all components of xl have a linear effect, we parametrise
the trend effect of the reporting date tl,r by penalised splines (see Eilers and Marx, 1996
8

for details). The district-specific effects are assumed to be Gaussian random effects. After
having obtained the estimates, we calculate µ̂l and σ̂l for the observations with missing
disease onset. We can now simulate Dl from (3) to acquire a full data set. This procedure
builds a single complete data set, which is repeated K times for the multiple imputation
scheme detailed in Section 3.3.
Through the software packages gamlss and mgcv, we get estimates for the parameters
of the imputation model (Stasinopoulos et al., 2020; Wood, 2017). The results are given
in Table 1 and should be interpreted regarding the mean and dispersion parameter of
the period between disease onset date and reporting date, which we define as test delay.
Lastly, we aggregate the data again to the original weekly scale. In the Supplementary
Material, we provide additional details on this imputation procedure.

3

Model Formulation

3.1

Age- and Gender-Structured Spatio-Temporal Model

To model the number of infections, we apply a negative binomial ‘observation-driven’
model for count data (Cox, 1981). By doing so, we assume




Yi,g,t | xi,g,t−1 , yi,g,t−1 , ai , bi ∼ NB µi,g,t , σ , ∀ i ∈ {1, ..., 401}, g ∈ G, and t = 2, ..., T,

(4)

where xi,g,t = (t, xg , xi,g,pop , xi,t,gini , xi,t,sp , xi,coord , xi,soc ) are the joint covariates derived in Section 2 and G denotes the set of age/gender groups used from the data. Further, let T be
the final week of data we use in the analysis. We parametrise the scale parameter σ only
by an intercept term since we are interested in drawing conclusions about the effect of
the covariates on µi,g,t . We assume in (4) that the random variable Yi,g,t follows a negative
binomial distribution conditional on xi,g,t to compensate overdispersion in the observed
counts (Ver Hoef and Boveng, 2007). Aligned with models for the spread of infectious
diseases, we decompose µi,g,t into an endemic and epidemic component:
END
EPI
µi,g,t = exp{νi,g,t
+ νi,g,t
},

(5)

where each part is parametrized as follows:
EPI
νi,g,t
=θAR(1) log(ỹi,g,t−1 + c)
END
νi,g,t

(6)

=θt + θsex I(xi,sex = “Male”) + θage I(xi,age = “36-59”)+

(7)

+ θage:sex I(xi,sex = “Male”) · I(xi,age = “36-59”) + θt,gini xi,t−1,gini
+ θt,sp xi,t−1,sp + fcoord (xi,coord ) + fsoc (xi,soc ) + ai + bi I(t = T ) + log(xi,g,pop ),
i,g,t−1
in (6) denotes the rate of infections among 10.000 inhabitants in
ỹi,g,t−1 = 10.000y
xi,g,pop
district i, group g, and week t. We include a first-order autoregressive term of this rate,
since path dependencies and self-exciting behaviour are common with infectious diseases
and should therefore be accounted for (Held et al., 2005). In addition, we transform the
respective term by h(x) = log(x + c) to bypass problems with absorbing states of the
implied counting process when ỹi,g,t−1 = 0 (see Fahrmeir and Tutz, 2001; Fokianos and
Tjøstheim, 2011). The value c ∈ (0, 1] is estimated from the data. More general types of
these autoregressive models are proposed by Zeger and Qaqish (1988).
As is evident from (5), we constitute that both the epidemic and endemic components
have a multiplicative effect on the observed infection rates. As an alternative, Held et al.

9

(2005) replace the log link by an identity link, although Fokianos and Tjøstheim (2011)
and Fokianos et al. (2020) argue for the logarithmic link implied in (5) if additional
covariates are available. They further derive theoretical properties, such as ergodicity, in
the case of Poisson-distributed target variables under the condition θAR(1) < 1.
For the endemic part (7), the temporal trend is reflected by piecewise constant fixed
effects separately for each week, θt . By means of group-specific covariates we control for
gender- and age-related effects and their interaction, θsex , θage , and θage:sex (Walter and
Mcgregor, 2020). The principal covariates, Gini Index and Percentage Staying Put, are
modelled by piecewise constants in each week for maximal flexibility. To account for
the stylised fact, that the incubation period, i.e., the time between being infected and
symptom onset, for COVID-19 is around 5 days (Linton et al., 2020; Li et al., 2020), we
lag the information on Gini Index and Percentage Staying Put by one week as indicated
in (7).
The bivariate functions fcoord (xi,coord ) and fsoc (xi,soc ) display the effects of geographic
coordinates and social coordinates on the incidence rate. Details on the type of splines
used are given in Section 3.2.
Because super spreader events such as carnival sessions (Streeck et al., 2020) or local
outbreaks in major slaughterhouses (Dyal et al., 2020) lead to unobserved heterogeneities,
our model comprises two district-specific Gaussian random effects. The random effect
ai governs long-term heterogeneities, while short-term dependencies, i.e., sudden locally
confined outbreaks as visible in the last week of Figure 3, are captured by bi . We assume
a = (a1 , . . . , an )> ∼ N(0, In τa2 ) and b = (b1 , . . . , bn )> ∼ N(0, In τb2 ). Relying on the duality
between semiparametric regression and random effects (Ruppert et al., 2003), we can
equivalently write the random effects as semiparametric terms. Hence we may replace ai
and bi by fa (i) = (a1 , ..., an )> Xa and fb (i) = (b1 , ..., bn )> Xb , respectively, and introduce a
ridge penalty for each coefficient vector. In this context, the design matrices Xa and Xb
each consist of n dummy variables indicating to which district a specific observation refers.
As a result of this reformulation, we can estimate the additional parameters τa and τb as
tuning parameters in semiparametric regression (see Annex B for further information).
Implicitly it is assumed in our model that the entire population is susceptible. This is
reasonable when taking into account the current low prevalence of COVID-19 in Germany.
Emanating from this observation, the term log(xi,g,pop ) is included as an offset in (7). Put
differently, the inclusion of this offset term allows us to model infections rates Ỹi,g,t that
relate to the counts through Yi,g,t = Ỹi,g,t xi,g,pop via regression for count data (note how we
now do not regard rate among 10.000 inhabitants but the percentage of infected people).
The model is also applicable in later stages of the disease by replacing this offset with the
number of susceptible inhabitants in each region.

3.2

Isotropic Smooth Effects

In order to properly incorporate xi,coord and xi,soc in our regression framework, we propose
the usage of isotropic splines. These kind of flexible functions were proposed by Duchon
(1977) to model multiple covariates by a multivariate term as an alternative to anisotropic
tensor products. Isotropic smoothers have the property of giving the identical predictions
of the response under arbitrary rotation and reflection of the respective covariates (Wood,
2017). This characteristic is commonly reasonable when working with geographic coordinates xi,coord and in accordance with the uniqueness of the multidimensional scaling results,
thus also for xi,soc . With respect to the form of the smooth terms, we follow Wood (2003)
10

and use a low-rank approximation of the thin-plate splines introduced in Duchon (1977).
To obtain a smooth fit, we impose a penalty that is controlled by τsoc and τcoord for the
respective isotropic splines.

3.3

Estimation

We first state how we estimate θ and c under complete observations through a two-stage
maximum penalised likelihood approach and then sketch how one can account for the
uncertainty due to missing values via multiple imputation (Rubin, 1987). Generally, we
condition on the observations in t = 1, i.e., the week between the 3rd and 9th of March,
in our estimation.
Given a complete dataset, we first consider θ to be a nuisance parameter and find c via
a profile likelihood approach (Held and Sabanés Bové, 2020). Here the profile likelihood
is given by
LPro f ile (c) = max L(c, θ ) = L(c, θ̂ (c)),
θ

where L(c, θ ) is the joint likelihood resulting from (4) and θ̂ (c) is the maximum likelihood
estimator of θ for a fixed value of c. For any c we can find θ̂ (c) by carrying out the
estimation as explained in Annex B, hence it is straightforward to evaluate LPro f ile (c).
Given this result, we use standard optimisation software, i.e., the optimise routine within
the software environment R (R Core Team, 2018), to obtain ĉ = arg max LPro f ile (c). In
c

the consecutive step, we fix c at ĉ to get θ̂ again by following Annex B.
Since about 30% of the onset dates are being imputed, we use Rubin’s rule to correct for
the multiple imputation (Rubin, 1987). At first, we sample K complete datasets according
to Section 2.3. Consecutively, let ϑ̂(k) = (θ̂(k) , ĉ) be the resulting estimator from the twostage maximum profile likelihood procedure explained in the previous paragraph given
the complete dataset from the k-th imputation step. We denote by V̂(k) the corresponding
variance estimate that results from Bayesian large sample properties (Wood, 2013). We
P
then average the coefficients over all K iterations to obtain ϑ̂MI = K1 Kk=1 ϑ̂(k) and estimate
the variance of ϑ̂MI through:
ˆ ϑ̂MI ) = V̄ + (1 + K −1 )B̄,
Var(

where its components are given by
V̄ =
B̄ =

K
1X
V̂(k)
K k=1

K 

>
1 X
ϑ̂(k) − ϑ̂MI ϑ̂(k) − ϑ̂MI .
K − 1 k=1

In our application, setting K = 20 proved to be sufficient since the estimates of different
imputed datasets varied only marginally.

4
4.1

Results
Trend Effect

To start, the estimate of θt is shown in Figure 5. The progression of the weekly estimates confirms generally decreasing infection rates over time. Due to the standardisation
11

Week
−8

●

●

●

−9

●

θ^t

●

●

●
●
●

−10

●
●
●
●
●

03
−
03 09
−
03 16
−
03 23
−
04 30
−
04 06
−
04 13
−
04 20
−
05 27
−
05 04
−
05 11
−
05 18
−
06 25
−
06 01
−
06 08
−1
5

●

Week (t)

Figure 5: Time-varying baseline intensity θt . The estimates are accompanied by the 95%
confidence interval.
Covariable
Male
A35-A59
Male:A35-A59
log(ỹi,g,t−1 + c)

Estimate
exp{Estimate}
(Standard Error) (Standard Error)
−0.03
0.97
(0.015)
(0.014)
−0.031
0.969
(0.014)
(0.013)
−0.071
0.931
(0.02)
(0.017)
0.623
1.865
(0.009)
( 0.031)

Table 2: Estimates of linear time-constant effects.The reference group are female individuals aged between 15 and 35. By use of the delta rule we approximated the standard
errors of the transformed coefficients in the third row. The value c is estimated at 0.499
with a standard error of 0.027.

employed for the principal covariates in the analysis, the temporal trend can be interpreted as the log-transformed expected infection rate of female individuals aged between
15 and 35 in a district where the standardised Gini Index and Percentage Staying Put
are zero. Since observing a zero in the standardised covariates translates to the mean observed values where we observed most information, the standard errors are also extremely
narrow.

4.2

Sociodemographic and Epidemic Effects

The linear time-constant estimates are given in Table 2 and exhibit in general a negative
effect on male patients compared to female patients, 3% in the younger and 9.6% in
12

(a) Gini Index

(b) Percentage Staying Put

0.2

0.2
●

●

0.0

●

●

●

●

●

●

●
●

●
●
●

−0.2

●

θ^t,sp

●

θ^t,gini

●

0.0

●

●

●

●
●

●

●
●

●
●

−0.2

●

●
●

●

03
03−09
03−16
03−23
04−30
04−06
04−13
04−20
05−27
05−04
05−11
05−18
06−25
06−01
06−08
−1
5

−0.4

03
03−09
03−16
03−23
04−30
04−06
04−13
04−20
05−27
05−04
05−11
05−18
06−25
06−01
06−08
−1
5

−0.4

Week (t)

Week (t)

Figure 6: (a): Time-varying effects of the Gini index θ̂t,gini . (b): Time-varying effects
of the Percentage of People Staying Put θ̂t,sp . All estimates are accompanied by 95%
confidence interval.
the older age cohort. According to its partial effect, we also predict that the older age
group has a lower infection rate than the younger group encompassing individuals aged
between 15 and 35, for men 9.7% and women 3.1%. The autocorrelation coefficient θAR(1)
expresses that one more infection among 10.000 inhabitants in a district during the past
week almost doubles the predicted infections for the present week. This dominant finding
confirms strong path dependencies in the data. In this context, we need to remark that
the coefficients are partial effects and do not necessarily translate to the raw numbers.

4.3

Mobility Effects

The time-varying estimates regarding the relative mobility pattern are displayed in Figure
6. Overall, the estimated effects of the measures proposed in Section 2 on the rate of local
COVID-19 infections are negative. In regards to relative importance, both variables rank
similarly during the lock-down period that persists until early May. Subsequently, the
Gini Index in a region gains weight, while the effect of People Staying Put fades. The
temporal changes of the respective estimates illustrate a non-linear trend in the estimates,
which would not have been sufficiently captured by linear effects.
Gini Index: Given all other covariates, Figure 6 (a) suggests that inhabitants with
meeting patterns that are centred around a few other districts entail reduced infection
rates for a specific district. This tendency is only suspended in the week starting on March
17th during the early lock-down in Bavaria . The corresponding estimate is positive and
significant. Once the national lock-down is ordered, the effect is not significant for one
week. The estimated effects remain low but negative until the German government introduces compulsory masks in public areas on April 22nd (Mitze et al., 2020). Thereupon,
the effect has a clear downwards tendency. Once policymakers slowly lift the lock-down
measures, the estimate rises in absolute terms until its maximum in the penultimate week
13

Schleswig Holstein
Mecklenburg Western
Pomerania

North RineWestphalia

Hesse

Thuringia

−2

−1

0

Figure 7: Estimated smooth spatial effect fcoord .
of our observational period. This development may be viewed as evidence that a more
focussed attribution of co-location probabilities in a district becomes more crucial over
time.
Percentage Staying Put: If the percentage of inhabitants in a district staying
put is large in relation to the national tendency, we expect the incidence of infections
throughout the lock-down period to be lower. We deduce this result from the largely
negative estimates in Figure 6 (b) for the weeks between March 10th and May 18th.
Once the orders are relaxed, on the other hand, the influence of the respective covariate
largely vanishes. A possible explanation for this phenomenon is that when daily infections
decline, most diseases are related to local outbreaks (as already stated in Section 2). These
breakouts, in turn, can not be associated with the percentage of people staying put. One
exception to this trend is the estimate in the week starting on May 26th, where we
encounter a significant positive effect.

4.4

Spatial and Social Connectedness Effects

In our model specification, we incorporate the friendship coordinates and geographic coordinates as two spatial effects. In combination with the two unstructured latent variables,
we can disentangle separate influences on the local infection rates of spatial and friendship
proximity as well as short- and long-term district-specific deviations from it.
Spatial Effects: Let us start with the smooth spatial effect in Figure 7. Overall,
the geographic effects within federal states, indicated by the black borders in Figure 7,
are mostly heterogeneous. To give some examples, an almost uniformly augmented risk
of infections is estimated in most parts of Hesse and Thuringia. At the same time, we
remark a negative spatial effect in Germany’s northern districts, i.e., Schleswig Holstein
14

(a) Social Space

(b) Geographic Space

●
●
● ●
● ● ●●
●
● ●
●
● ●
● ● ●● ●
● ●●
● ●●●●●
●
●
●
●
●
●
●● ●
●
●●
●●●● ●
●
●● ● ●
●
●
●●● ●
● ●●
● ●● ●
●●
●
●
●●● ●
●
●
●
●● ●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●●
●
●
●
●●
●
● ●
● ●
●
●
●●
●●● ● ●
●
●
●
●
●
●●
●
● ●
● ●●
●
● ●●
●
●
● ●●
●
●●
●
●
●
●
●●
●●
● ●
●
●●
●
●
●
●
●
●
● ●●
● ●
●
●
●
● ●●
●
● ● ●●
●●
●
●●
●
●
●●
●
●
●
●
●
●
●
●
●
●
●
● ●
●
●
●●
●
●
●
● ●
● ●
●
●
●
●
●
●
●
●
●
●●
●
● ●
●
●
● ●
● ●
●●●
●
●
● ●
●
● ●
●●● ● ●
● ●
● ●●
● ●
●
●
●●
●●
●
●
●
●● ●
●●●
●
●
●
●
●
●●
●
● ●
●
●●
● ●●●
●
● ●●
● ●●
●
●
● ●● ●● ●
●
● ● ●●
●● ● ●
●
●
●● ●
●
●● ● ● ● ●
●
●
●
●
●
●
●
●
●
●
●
●● ●●
● ●●● ●
●
● ●
● ●
●
●
●
●●
●
●
●●
●
●
●● ●
● ●
● ●●
●●
●
●
●●
● ● ●
●●
●●
● ●
●
●
●
● ●
●
● ●
●● ●

●

●

Dimension 2

2

0

−2

●

−2

0
Dimension 1

●

Hamburg
Lower
Saxony

●
●
●

●

●
●
● ●●
●
●
●
●
●
●
●
●
●
●

● ●●

●●

●
● ●
●
●
●
●● ●
●
● ● ●

●

●

●
●
●
●

●

●

●
●

Berlin

●

●
●
●
●
●
●
●
●
●
●
●
●
● ●
●
● ● ● ● ●
●
● ● ●
●
●
●
● ●
●
●
●
● ●●
●
●
● ●
●
●
●
●
● ●
●
● ●● ●
●
●
●
●
●
● ●
● ● ●
● ●
●●● ●●
●
●
●
●
●
●
●●●●
●●
●
●
●
●
●
●
● ● ●●●●● ●
● ●
●
●
●
●
●
● ● ●●
●
●
●
●
●● ●
●
●
●
● ●
● ●●
●
●
● ● ●
●●
● ● ●●
●
●
●
●
●
●
●
●
●
●
● ●
●●
●
● ● ●
● ● ● ●
●
●
● ● ●● ●
●
●● ●
●
●
●
●
●
●
●●● ●●
●
● ●
●
●
●
●
● ●● ●
● ●
●
●
●● ●
●
●
●
● ● ●● ●
● ●
●
●
●
●
●
●
●
● ● ● ●
●
● ●
●
●
●
● ● ●●
●
●
●
●
●
●
●●
● ●● ●
●
● ●
●● ●
●
●
● ●● ●
●●
●
● ●
● ●
●
●
●
● ●
●
●
●
●
● ● ●
●
●
●
●
●
● ●
● ●
● ● ●●
● ●
● ● ● ●
●
●
●
●
●
●
●
● ● ● ● ●● ● ● ●
● ●
● ●
●
● ●
●
● ●
●
●
●
●
● ●
●● ● ● ●
●●
●
● ●
●
●
●
● ● ● ● ●
●
● ●
●
● ●
●

North RhineWestphalia

●

●

●

●

Bavaria

●

2

−0.50 −0.25 0.00 0.25

Figure 8: (a): Coordinates of the districts in the friendship space with the smooth partial
effect of fsoc in the background. We only show the predictions in the range of observed
values. (b): Coordinates of the districts in the geometric space with the smooth partial
effect of fsoc again shown in the background for each district.
and Mecklenburg Western Pomerania. On the other hand, the fit for districts in BadenWürttemberg varies between positive, negative, and no effect.
We visualise the result of the friendship coordinates in two manners. One may plot
the smooth bivariate function in the friendship space, Figure 8 (a), or map the smooth
fit on the geographic space, Figure 8 (b). The re-mapping allows for sharp edges in the
geographic coordinates. Broadly, the fit differentiates between districts allocated in former
East-Germany (corresponding to MDS coordinates located in the first quadrant in Figure
8 (a)) and former West-Germany. We observe that the predicted infections are ceteris
paribus lower if a district is situated in former East-Germany. Districts allocated in the
second and fourth quadrant of Figure 8 (a) (mainly including districts from the states
Bavaria, North Rhine-Westphalia and parts of Lower Saxony) are negatively affected by
social proximity. Figure 8 (b) demonstrates how the partial effects sometimes change
abruptly between large cities and neighbouring districts. For instance, Berlin’s central
position is unrelated to the infection rates compared to the negative effect evaluated in
Brandenburg. We observe the same phenomenon for Hamburg when contrasting its partial
effect with surrounding districts in Schleswig Holstein and Lower Saxony.
Unobserved Heterogeneity Effect: In Figure 9 the posterior modes of both random effects evince strong heterogeneities between districts and underpin local differences
in the spread of COVID-19. Noticeable estimates of the long-term random effects, Figure 9 (a), reflect early outbreaks in the districts Greiz (Thuringia) and Coesfeld (North
Rhine-Westphalia). Some estimates may also be related to heterogeneous testing practices
between the districts.
15

(a) Long Term Effect

(b) Short Term Effect

Coesfeld

Warendorf

Guethersloh

Greiz

−0.25 0.00 0.25 0.50

−1

0

1

2

Figure 9: (a): Maximum posterior modes of the long-term random effects ai . (b) Maximum posterior modes of the short-term random effects bi .
We can trace back most high estimates of the short-term random effect to locally
confined outbreaks, for instance, Guethersloh and Warendorf (North Rhine-Westphalia).
As already stated in Section 2 the proportion of infections attributed to these local events
rises once the general level of new cases declines. This finding is supported by the different
scales of the two types of random effects and apparent in the estimates τ̂a = 0.234 < τ̂b =
0.827. Therefore, the posterior modes of the short-term effects exhibit higher variances
and are larger in absolute terms than the long-term effects.

4.5

Model Assessment

We compare various alternative model specifications to check the robustness of our findings. In particular, we estimate separate models, adding dummy covariates for each state
and leaving out one of the spatial terms, the Gini index, the Percentage of People Staying
Put, all Facebook-related covariates, and random effects. For this endeavour, we utilize
the corrected Akaike Information Criterion (cAIC) introduced by Wood et al. (2016) since
the effective degrees of freedom need to adjusted for the additionally estimated variance
components if random effects are included (we average the respective values over all imputed datasets). The results in Table 3 support the appropriateness of our final model
since the corresponding cAIV value is the lowest. Besides, the change in the cAIC value
to the model (4), denoted by ∆ cAIC, permits an evaluation of the variable importance of
each eliminated covariate. We can conclude from Table 3 that the exclusion of the Gini
Index induces the highest loss in cAIC value. Concerning the different types of distances,
the friendship distance is more important than the geographic distance.
For further validation, we plot one draw of the randomised quantile residuals in Figure
16

Model Description
Our Model
With State Effect
Without Geographic Distance
Without Friendship Distance
Without Age:Gender Interaction
Without Percentage Staying Put
Without Gini Index
Without Facebook Covariates
Without Long-Term Effect
Without Short-Term Effect
Without Long- and Short-Term Effect

cAIC (Model)
87534.03
87534.68
87539.07
87541.33
87544.27
87570.17
87817.13
87866.54
88303.85
88747.46
89499.23

∆ cAIC (Model)
–
0.644
5.039
7.296
10.239
36.134
283.097
332.510
769.816
1213.424
1965.192

Table 3: Alternative model specifications with resulting corrected AIC value and change
in corrected AIC value when compared to our model from Section 3.
10 (a). Dunn and Smyth (1996) proposed this type of residual based on the result that
evaluating the cumulative distribution function at all observed values of yi,g,t under the
estimated parameters should yield uniformly distributed random variables. Transforming
these uniform values by the quantile function of the standard normal gives the quantile
residuals. To obtain continuous residuals, the values are randomised since the negative
binomial distribution in (4) has discrete support. On average, the empirical quantiles are
close to the theoretical expectations and do not indicate problems regarding the statistical fit. At the right tail of the distribution, about 25 (out of 24.060) observations exhibit
higher deviations from the normal quantiles. The underlying counts are mainly credited
to local outbreaks that could not be completely captured by the random effects, namely
Coesfeld (Thuringia), Cuxhaven (Lower Saxony), Aichach-Friedberg (Bavaria), Guetersloh, and Warendorf (North Rhine-Westphalia). Additionally, we assess the predictions of
the final model through plotting the predicted infections against the observed infections,
Figure 10 (b), and a rootogram proposed by Kleiber and Zeileis (2016), Figure 10 (b).
Both visualisations confirm a strong fit of the presented model and proof that the model
can sufficiently capture the observed counts of infected individuals. Due to the multiple
imputation scheme introduced in Section 2.3 and 3.3, we carry the model assessment out
for each imputation separately and report the averaged results.

17

(c) Rootogram
Observed

Expected

sqrt(Frequency)

75

50

25

0
0

10

20
30
Number of Infections

40

50

Figure 10: (a): QQ Plot of randomised quantile residuals. (b): Scatter plot of the
observed and predicted infection count. (c): Rootogram comparing the observed and
expected counts.The grey barplot specifies the observed counts, while the red line gives
the expected values under (4).

5

Conclusion

In this writing, our contributions are twofold. Firstly, we used state-of-the-art regression models to quantify the importance of human mobility for understanding the spread
of COVID-19 on a local level accounting for their temporal dynamic, latent effects and
other covariates. Concerning the relative importance, the Gini index of meeting probability attribution proved to be a primary driver of the infection rates. Secondly, we
used methods from multivariate statistics to derive friendship coordinates for the federal
districts in Germany. Consecutively, we coupled the result with a regression model via
isotropic splines and, thereby, revealed a perpetual clustering of communities in former
East- and West Germany, that remains existent for COVID-19 infections because the social geographic system proves to be an essential regressor in our application. Moreover,
our findings enable an evaluation of the district-wise policies undertaken between March
and June 2020. The results corroborate the usefulness of interventions limiting trans18

district movements and concentrating meeting patterns. Especially during the last weeks
of this study, local lock-downs could mitigate further national outbreaks.
Still, we need to address some limitations of our work, which require additional investigation. The data sources for the infection data include all individuals in Germany that
tested positive on COVID-19. During the peak phase in March, these tests were mainly
carried out with patients who showed symptoms or had contact with an infected individual. Due to an unknown dark figure of infected persons missing in the public records
(Lavezzo et al., 2020), the observed data are a proxy for the current epidemiological situation. To control for this possible bias, further research on the prevalence of COVID-19 in
Germany and the representability of the official statistics of the real infection occurrence
akin to the REACTOR-1 Study in England (Riley et al., 2020) would be necessary.
Even with these caveats, the combination of infection, mobility, and connectivity data
can serve for a fruitful application of other methods as well. Contrasting our approach,
one may tackle the regression task in Section 3 by generalised estimation equations to
circumvent distributional assumptions (Zeger et al., 1988) or incorporate the spatial dependencies directly in the correlation structure, as is done in the literature on spatial
econometric models (LeSage and Pace, 2009). One may also employ novel clustering algorithms that naturally exploit different proximity dimensions, such as the geographical
and social space, to identify similar districts while taking into account spatial dependencies (D’Urso et al., 2019; D’Urso and Vitale, 2020). Further, the research questions posed
in this article would greatly benefit from an examination through the lens of analytical
sociology (Hedström and Bearman, 2011). Nevertheless, this type of analysis usually necessitates individual-level data, which are not readily available. Therefore, we can only
verify some of the theoretical results of Block et al. (2020) on the macro scale, which
does not necessarily translate to the micro scale (Stadtfeld, 2018). Therefore, additional
empirical work on the implications of individual behaviour on the spread of COVID-19
is still needed. Nevertheless, our work can give valuable pointers in that regard contingent on the assumption that the corresponding district average adequately represents the
mobility patterns of an individual.

Acknowledgement
We thank the anonymous reviewers for their careful reading and constructive comments.
The project was supported by the European Cooperation in Science and Technology
[COST Action CA15109 (COSTNET)]. This work has been funded by the German Federal
Ministry of Education and Research (BMBF) under Grant No. 01IS18036A. The authors
of this work take full responsibility for its content.

References
Asadi, S., N. Bouvier, A. S. Wexler, and W. D. Ristenpart (2020). The coronavirus
pandemic and aerosols: Does COVID-19 transmit via expiratory particles? Aerosol
Science and Technology 54 (6), 635–638.
Bailey, M., R. Cao, T. Kuchler, J. Stroebel, and A. Wong (2018). Social connectedness: Measurement, determinants, and effects. Journal of Economic Perspectives 32 (3),
259–280.
19

Block, P., M. Hoffman, I. J. Raabe, J. Beam Dowd, C. Rahal, R. Kashyap, and M. C.
Mills (2020). Social network-based distancing strategies to flatten the COVID-19 curve
in a post-lockdown world. Nature Human Behavior 4, 588–596.
Bonaccorsi, G., F. Pierri, M. Cinelli, A. Flori, A. Galeazzi, F. Porcelli, A. L. Schmidt,
C. M. Valensise, A. Scala, W. Quattrociocchi, and F. Pammolli (2020). Economic and
social consequences of human mobility restrictions under COVID-19. Proceedings of
the National Academy of Sciences 117 (27), 15530–15535.
Borg, I., P. J. F. Groenen, and P. Mair (2013). Applied multidimensional scaling. New
York: Springer.
Brandes, U. and C. Pich (2007). Eigensolver methods for progressive multidimensional
scaling of large data. In Graph Drawing 14th International Symposium, pp. 42–53.
Brandes, U. and C. Pich (2009). An Experimental Study on Distance-Based Graph
Drawing. In Graph Drawing 16th International Symposium, pp. 218–229.
Cailliez, F. (1983). The analytical solution of the additive constant problem. Psychometrika 48 (2), 305–308.
Chan, J. F. W., S. Yuan, K. H. Kok, K. K. W. To, H. Chu, J. Yang, F. Xing, J. Liu,
C. C. Y. Yip, R. W. S. Poon, H. W. Tsoi, S. K. F. Lo, K. H. Chan, V. K. M. Poon, W. M.
Chan, J. D. Ip, J. P. Cai, V. C. C. Cheng, H. Chen, C. K. M. Hui, and K. Y. Yuen (2020).
A familial cluster of pneumonia associated with the 2019 novel coronavirus indicating
person-to-person transmission: a study of a family cluster. The Lancet 395 (10223),
514–523.
Chinazzi, M., J. T. Davis, M. Ajelli, C. Gioannini, M. Litvinova, S. Merler, A. Pastore y
Piontti, K. Mu, L. Rossi, K. Sun, C. Viboud, X. Xiong, H. Yu, M. Elizabeth Halloran,
I. M. Longini, and A. Vespignani (2020). The effect of travel restrictions on the spread
of the 2019 novel coronavirus (COVID-19) outbreak. Science 368 (6489), 395–400.
Cho, E., S. A. Myers, and J. Leskovec (2011). Friendship and Mobility: User Movement In
Location-Based Social Networks. In KDD ’11: Proceedings of the 17th ACM SIGKDD
international conference on Knowledge discovery and data mining.
Cox, D. R. (1981). Statistical Analysis of Time Series: Some Recent Developments.
Scandinavian Journal of Statistics 8 (2), 93–115.
Cox, M. and T. Cox (2008). Multidimensional Scaling. In C. Chen, W. K. Härdle, and
A. Unwin (Eds.), Handbook of Data Visualization, pp. 315–347. Berlin: Springer.
Cox, T. and M. Cox (2000). Multidimensional Scaling. Boca Raton: CRC.
Duchon, J. (1977). Splines minimizing rotation-invariant semi-norms in Sobolev spaces.
In W. Schempp and K. Zeller (Eds.), Constructive Theory of Functions of Several
Variables, pp. 85–100. Berlin: Springer.
Dunn, P. K. and G. K. Smyth (1996). Randomized Quantile Residuals. Journal of
Computational and Graphical Statistics 5 (3), 236–244.

20

D’Urso, P., L. De Giovanni, M. Disegna, and R. Massari (2019). Fuzzy clustering with
spatial–temporal information. Spatial Statistics 30, 71–102.
D’Urso, P. and V. Vitale (2020). A robust hierarchical clustering for georeferenced data.
Spatial Statistics 35, 1–33.
Dyal, J. W., M. P. Grant, K. Broadwater, A. Bjork, M. A. Waltenburg, J. D. Gibbins, C. Hale, M. Silver, M. Fischer, J. Steinberg, C. A. Basler, J. R. Jacobs, E. D.
Kennedy, S. Tomasi, D. Trout, J. Hornsby-Myers, N. L. Oussayef, L. J. Delaney, K. Patel, V. Shetty, K. E. Kline, B. Schroeder, R. K. Herlihy, J. House, R. Jervis, J. L.
Clayton, D. Ortbahn, C. Austin, E. Berl, Z. Moore, B. F. Buss, D. Stover, R. Westergaard, I. Pray, M. DeBolt, A. Person, J. Gabel, T. S. Kittle, P. Hendren, C. Rhea,
C. Holsinger, J. Dunn, G. Turabelidze, F. S. Ahmed, S. DeFijter, C. S. Pedati, K. Rattay, E. E. Smith, C. Luna-Pinto, L. A. Cooley, S. Saydah, N. D. Preacely, R. A. Maddox,
E. Lundeen, B. Goodwin, S. E. Karpathy, S. Griffing, M. M. Jenkins, G. Lowry, R. D.
Schwarz, J. Yoder, G. Peacock, H. T. Walke, D. A. Rose, and M. A. Honein (2020).
COVID-19 Among Workers in Meat and Poultry Processing Facilities — 19 States,
April 2020. MMWR. Morbidity and Mortality Weekly Report 69 (18), 557–561.
Eilers, P. H. and B. D. Marx (1996). Flexible smoothing with B-splines and penalties.
Statistical Science 11 (2), 89–102.
Facebook (2020). GeoInsights Help. https://www.facebook.com/help/geoinsights.
Fahrmeir, L. and G. Tutz (2001). Multivariate Statistical Modelling Based on Generalized
Linear Models. Cham: Springer.
Flaxman, S., S. Mishra, A. Gandy, H. J. T. Unwin, T. A. Mellan, H. Coupland, C. Whittaker, H. Zhu, T. Berah, J. W. Eaton, M. Monod, Imperial College COVID-19 Response
Team, A. C. Ghani, C. A. Donnelly, S. M. Riley, M. A. C. Vollmer, N. M. Ferguson,
L. C. Okell, and S. Bhatt (2020). Estimating the effects of non-pharmaceutical interventions on COVID-19 in Europe. Nature 584, 257–261.
Fokianos, K. and B. Kedem (2004). Partial Likelihood Inference For Time Series Following
Generalized Linear Models. Journal of Time Series Analysis 25 (2), 173–197.
Fokianos, K., B. Støve, D. Tjøstheim, and P. Doukhan (2020). Multivariate count autoregression. Bernoulli 26 (1), 471–499.
Fokianos, K. and D. Tjøstheim (2011). Log-linear Poisson autoregression. Journal of
Multivariate Analysis 102 (3), 563–578.
Galeazzi, A., M. Cinelli, G. Bonaccorsi, F. Pierri, A. L. Schmidt, A. Scala, F. Pammolli,
and W. Quattrociocchi (2020). Human Mobility in Response to COVID-19 in France,
Italy and UK. arXiv preprint.
Glöckner, S., G. Krause, and M. Höhle (2020). Now-casting the COVID-19 epidemic:
The use case of Japan, March 2020. medRxiv preprint.
Guan, W.-j., Z.-y. Ni, Y. Hu, W.-h. Liang, C.-q. Ou, J.-x. He, L. Liu, H. Shan, C.-l. Lei,
D. S. Hui, B. Du, L.-j. Li, G. Zeng, K.-Y. Yuen, R.-c. Chen, C.-l. Tang, T. Wang, P.-y.
Chen, J. Xiang, S.-y. Li, J.-l. Wang, Z.-j. Liang, Y.-x. Peng, L. Wei, Y. Liu, Y.-h. Hu,
21

P. Peng, J.-m. Wang, J.-y. Liu, Z. Chen, G. Li, Z.-j. Zheng, S.-q. Qiu, J. Luo, C.-j. Ye,
S.-y. Zhu, and N.-s. Zhong (2020). Clinical Characteristics of Coronavirus Disease 2019
in China. New England Journal of Medicine 382 (18), 1708–1720.
Günther, F., A. Bender, K. Katz, H. Küchenhoff, and M. Höhle (2020). Nowcasting the
covid-19 pandemic in bavaria. Biometrical Journal (OnlineFirst).
Hedström, P. and P. Bearman (2011). What is Analytical Sociology All About? An
Introductory Essay. In P. Bearman and P. Hedström (Eds.), The Oxford Handbook of
Analytical Sociology. Oxford: Oxford University Press.
Held, L., M. Höhle, and M. Hofmann (2005). A statistical framework for the analysis of
multivariate infectious disease surveillance counts. Statistical Modelling 5 (3), 187–199.
Held, L., S. Meyer, and J. Bracher (2017). Probabilistic forecasting in infectious disease
epidemiology: the 13th Armitage lecture. Statistics in Medicine 36 (22), 3443–3460.
Held, L. and M. Paul (2012). Modeling seasonality in space-time infectious disease surveillance data. Biometrical Journal 54 (6), 824–843.
Held, L. and D. Sabanés Bové (2020). Likelihood and Bayesian Inference. Berlin: Springer.
Holtz, D., M. Zhao, S. G. Benzell, C. Y. Cao, M. A. Rahimian, J. Yang, J. Allen, A. Collis,
A. Moehring, T. Sowrirajan, D. Ghosh, Y. Zhang, P. S. Dhillon, C. Nicolaides, D. Eckles, and S. Aral (2020). Interdependence and the cost of uncoordinated responses to
COVID-19. Proceedings of the National Academy of Sciences of the United States of
America 117 (33), 19837–19843.
Iyer, S., B. Karrer, D. Citron, F. Kooti, P. Maas, Z. Wang, E. Giraudy, P. A. Dow, and
A. Pompe (2020). Large-scale measurement of aggregate human colocation patterns for
epidemiological modeling. medRxiv preprint.
Kang, D., H. Choi, J. H. Kim, and J. Choi (2020). Spatial epidemic dynamics of the
COVID-19 outbreak in China. International Journal of Infectious Diseases 94, 96–102.
Kimeldorf, G. S. and G. Wahba (1970). A Correspondence Between Bayesian Estimation on Stochastic Processes and Smoothing by Splines. The Annals of Mathematical
Statistics 41 (2), 495–502.
Kissler, S. M., C. Tedijanto, E. Goldstein, Y. H. Grad, and M. Lipsitch (2020). Projecting the transmission dynamics of SARS-CoV-2 through the postpandemic period.
Science 368 (6493), 860–868.
Kleiber, C. and A. Zeileis (2016). Visualizing Count Data Regressions Using Rootograms.
The American Statistician 70 (3), 296–303.
Kottasová, I. (2020). Germany reports 650 new coronavirus cases in a meat processing
plant - CNN. https://edition.cnn.com/2020/06/18/europe/germany-meat-processingplant-coronavirus-cases-intl.
Kraemer, M. U., C. H. Yang, B. Gutierrez, C. H. Wu, B. Klein, D. M. Pigott, L. du Plessis,
N. R. Faria, R. Li, W. P. Hanage, J. S. Brownstein, M. Layan, A. Vespignani, H. Tian,
C. Dye, O. G. Pybus, and S. V. Scarpino (2020). The effect of human mobility and
control measures on the COVID-19 epidemic in China. Science 368 (6490), 493–497.
22

Kuchler, T., D. Russel, and J. Stroebel (2021). The geographic spread of covid-19 correlates with the structure of social networks as measured by facebook. Journal of Urban
Economics (OnlineFirst).
Lavezzo, E., E. Franchin, C. Ciavarella, G. Cuomo-Dannenburg, L. Barzon, C. Del
Vecchio, L. Rossi, R. Manganelli, A. Loregian, N. Navarin, D. Abate, M. Sciro,
S. Merigliano, E. De Canale, M. C. Vanuzzo, V. Besutti, F. Saluzzo, F. Onelia,
M. Pacenti, S. Parisi, G. Carretta, D. Donato, L. Flor, S. Cocchio, G. Masi, A. Sperduti, L. Cattarino, R. Salvador, M. Nicoletti, F. Caldart, G. Castelli, E. Nieddu, B. Labella, L. Fava, M. Drigo, K. A. Gaythorpe, K. E. Ainslie, M. Baguelin, S. Bhatt,
A. Boonyasiri, O. Boyd, L. Cattarino, C. Ciavarella, H. L. Coupland, Z. Cucunubá,
G. Cuomo-Dannenburg, B. A. Djafaara, C. A. Donnelly, I. Dorigatti, S. L. van Elsland, R. FitzJohn, S. Flaxman, K. A. Gaythorpe, W. D. Green, T. Hallett, A. Hamlet,
D. Haw, N. Imai, B. Jeffrey, E. Knock, D. J. Laydon, T. Mellan, S. Mishra, G. NedjatiGilani, P. Nouvellet, L. C. Okell, K. V. Parag, S. Riley, H. A. Thompson, H. J. T.
Unwin, R. Verity, M. A. Vollmer, P. G. Walker, C. E. Walters, H. Wang, Y. Wang,
O. J. Watson, C. Whittaker, L. K. Whittles, X. Xi, N. M. Ferguson, A. R. Brazzale,
S. Toppo, M. Trevisan, V. Baldo, C. A. Donnelly, N. M. Ferguson, I. Dorigatti, and
A. Crisanti (2020). Suppression of a SARS-CoV-2 outbreak in the Italian municipality
of Vo’. Nature 584, 425–429.
LeSage, J. and R. K. P. Pace (2009). Introduction to Spatial Econometrics. Boca Raton:
CRC.
Li, Q., X. Guan, P. Wu, X. Wang, L. Zhou, Y. Tong, R. Ren, K. S. Leung, E. H. Lau,
J. Y. Wong, X. Xing, N. Xiang, Y. Wu, C. Li, Q. Chen, D. Li, T. Liu, J. Zhao, M. Liu,
W. Tu, C. Chen, L. Jin, R. Yang, Q. Wang, S. Zhou, R. Wang, H. Liu, Y. Luo, Y. Liu,
G. Shao, H. Li, Z. Tao, Y. Yang, Z. Deng, B. Liu, Z. Ma, Y. Zhang, G. Shi, T. T. Lam,
J. T. Wu, G. F. Gao, B. J. Cowling, B. Yang, G. M. Leung, and Z. Feng (2020). Early
Transmission Dynamics in Wuhan, China, of Novel Coronavirus–Infected Pneumonia.
New England Journal of Medicine 382 (13), 1199–1207.
Li, R., S. Pei, B. Chen, Y. Song, T. Zhang, W. Yang, and J. Shaman (2020). Substantial
undocumented infection facilitates the rapid dissemination of novel coronavirus (SARSCoV2). Science 368 (6490), 489–493.
Linton, N. M., T. Kobayashi, Y. Yang, K. Hayashi, A. R. Akhmetzhanov, S.-m. Jung,
B. Yuan, R. Kinoshita, and H. Nishiura (2020). Incubation Period and Other Epidemiological Characteristics of 2019 Novel Coronavirus Infections with Right Truncation: A
Statistical Analysis of Publicly Available Case Data. Journal of Clinical Medicine 9 (2),
1–9.
Little, R. J. A. and D. B. Rubin (2002). Statistical Analysis with Missing Data. New
York: Wiley.
Lorch, L., W. Trouleau, S. Tsirtsis, A. Szanto, B. Schölkopf, and M. Gomez-Rodriguez
(2020). A Spatiotemporal Epidemic Model to Quantify the Effects of Contact Tracing,
Testing, and Containment. arXiv preprint.
Maas, P., I. Shankar, A. Gros, P. Wonhee, L. Mcgorman, C. Nayak, and A. P. Dow
(2019). Facebook Disaster Maps: Aggregate Insights for Crisis Response & Recovery.
In Proceedings of the 16th ISCRAM Conference, pp. 1–12.
23

Mardia, K. V. (1978). Some properties of clasical multi-dimesional scaling. Communications in Statistics-Theory and Methods 7 (13), 1233–1241.
Meyer, S. and L. Held (2017). Incorporating social contact data in spatio-temporal models
for infectious disease spread. Biostatistics 18 (2).
Microsoft (2020). Bing Maps Tile System - Bing Maps. https://docs.microsoft.com/enus/bingmaps/articles/bing-maps-tile-system.
Mitze, T., R. Kosfeld, J. Rode, and K. Walde (2020, dec). Face masks considerably reduce
COVID-19 cases in Germany. Proceedings of the National Academy of Sciences of the
United States of America 117 (51), 32293–32301.
Oliver, N., B. Lepri, H. Sterly, R. Lambiotte, S. Delataille, M. De Nadai, E. Letouzé,
A. A. Salah, R. Benjamins, C. Cattuto, V. Colizza, N. de Cordes, S. P. Fraiberger,
T. Koebe, S. Lehmann, J. Murillo, A. Pentland, P. N. Pham, F. Pivetta, J. Saramäki,
S. V. Scarpino, M. Tizzoni, S. Verhulst, and P. Vinck (2020). Mobile phone data
for informing public health actions across the COVID-19 pandemic life cycle. Science
Advances 6 (23), 1–6.
Paul, M., L. Held, and A. M. Toschke (2008). Multivariate modelling of infectious disease
surveillance data. Statistics in Medicine 27 (29), 6250–6267.
Prem, K., Y. Liu, T. W. Russell, A. J. Kucharski, R. M. Eggo, N. Davies, S. Flasche,
S. Clifford, C. A. Pearson, J. D. Munday, S. Abbott, H. Gibbs, A. Rosello, B. J. Quilty,
T. Jombart, F. Sun, C. Diamond, A. Gimma, K. van Zandvoort, S. Funk, C. I. Jarvis,
W. J. Edmunds, N. I. Bosse, J. Hellewell, M. Jit, and P. Klepac (2020). The effect of
control strategies to reduce social mixing on outcomes of the COVID-19 epidemic in
Wuhan, China: a modelling study. The Lancet Public Health 5 (5), e261–e270.
R Core Team (2018). R: A Language and Environment for Statistical Computing.
Rigby, R. A. and D. M. Stasinopoulos (2005). Generalized additive models for location,
scale and shape. Journal of the Royal Statistical Society: Series C (Applied Statistics) 54 (3), 507–554.
Riley, S., O. Eales, C. E. Walters, H. Wang, K. Ainslie, C. Atchison, C. Fronterre, P. Diggle, D. Ashby, C. Donnelly, G. Cooke, W. Barclay, H. Ward, A. Darzi, and P. Elliott
(2020). React-1 round 8 final report: high average prevalence with regional heterogeneity of trends in sars-cov-2 infection in the community in england during january 2021.
https://spiral.imperial.ac.uk/handle/10044/1/85703.
Rubin, D. B. (1987). Multiple Imputation for Nonresponse in Surveys. New York: Wiley.
Ruppert, D., M. Wand, and R. J. Carroll (2003). Semiparametric regression. Cambridge:
Cambridge University Press.
Stadtfeld, C. (2018). The Micro–Macro Link in Social Networks. Emerging Trends in the
Social and Behavioral Sciences (OnlineFirst).
Stasinopoulos, M., B. Rigby, V. Voudouris, and D. Kiose (2020). gamlss.add: Extra Additive Terms for Generalized Additive Models for Location Scale and Shape. R package
version 5.1-6.
24

Streeck, H., B. Schulte, B. Kuemmerer, E. Richter, T. Hoeller, C. Fuhrmann, E. Bartok, R. Dolscheid, M. Berger, L. Wessendorf, M. Eschbach-Bludau, A. Kellings,
A. Schwaiger, M. Coenen, P. Hoffmann, M. Noethen, A.-M. Eis-Huebinger, M. Exner,
R. Schmithausen, M. Schmid, and B. Kuemmerer (2020). Infection fatality rate of
SARS-CoV-2 infection in a German community with a super-spreading event. Nature
Communications 11 (5829).
Van Doremalen, N., T. Bushmaker, D. H. Morris, M. G. Holbrook, A. Gamble, B. N.
Williamson, A. Tamin, J. L. Harcourt, N. J. Thornburg, S. I. Gerber, J. O. Lloyd-Smith,
E. De Wit, and V. J. Munster (2020). Aerosol and surface stability of SARS-CoV-2 as
compared with SARS-CoV-1. New England Journal of Medicine 382 (16), 1564–1567.
Ver Hoef, J. M. and P. L. Boveng (2007). Quasi-poisson vs. negative binomial regression:
How should we model overdispersed count data? Ecology 88 (11), 2766–2772.
Walter, L. A. and A. J. Mcgregor (2020). Sex-and Gender-specific Observations and
Implications for COVID-19. Western Journal of Emergency Medicine 21 (3), 507–509.
WHO (2020).
Coronavirus disease (COVID-2019) situation reports.
https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports.
Wood, S. N. (2003). Thin plate regression splines. Journal of the Royal Statistical Society.
Series B (Statistical Methodology) 65 (1), 95–114.
Wood, S. N. (2011). Fast stable restricted maximum likelihood and marginal likelihood
estimation of semiparametric generalized linear models. Journal of the Royal Statistical
Society: Series B (Statistical Methodology) 73 (1), 3–36.
Wood, S. N. (2013). On p-values for smooth components of an extended generalized
additive model. Biometrika 100 (1), 221–228.
Wood, S. N. (2017). Generalized additive models: An introduction with R. Boca Raton:
CRC.
Wood, S. N., N. Pya, and B. Säfken (2016). Smoothing parameter and model selection
for general smooth models. Journal of the American Statistical Association 111 (516),
1548–1563.
Wu, Y.-C., C.-S. Chen, and Y.-J. Chan (2020). The outbreak of COVID-19. Journal of
the Chinese Medical Association 83 (3), 217–220.
Young, G. and A. S. Householder (1938). Discussion of a set of points in terms of their
mutual distances. Psychometrika 3 (1), 19–22.
Zeger, S. L., K.-Y. Liang, and P. S. Albert (1988). Models for Longitudinal Data: A
Generalized Estimating Equation Approach. Biometrics 44 (4), 1049–1060.
Zeger, S. L. and B. Qaqish (1988). Markov Regression Models for Time Series: A QuasiLikelihood Approach. Biometrics 44 (4), 1019–1031.

25

A

Multidimensional Scaling

In order to determine the information given in the pairwise social connectedness indices
xsoc = (xi j,soc )i, j=1,...,n for explaining the spread of COVID-19 in Germany, we use techniques from multivariate statistics (Cox and Cox, 2000). Thereby, we can derive a lowdimensional representation of the network on the actor level and guarantee interpretable
as well as transparent results. More specifically, we apply metric multidimensional scaling (MDS) to represent dissimilarity matrices in a lower-dimensional geometric space
that preserves the dissimilarities through euclidean distances (Borg et al., 2013). Related
methods are also used as a visualisation tool to draw networks (see Brandes and Pich,
2007, 2009). To illustrate the application of this algorithm, one can think of MDS as
a technique to reverse engineer geographic coordinates that are unique up to scale and
rotation from distances between cities (Young and Householder, 1938).
At first, we transform the similarities expressed by the counts of friendship ties between
the districts xs oc to dissimilarities. In our application, the measure of dissimilarity is given
1
)i6= j=1,...,n and dii,soc = 0. Since the dissimilarity matrix is symmetric and
by dsoc = ( xi j,soc
non-negative, but there is no general guarantee that the entries of d are euclidean, we
add the constant c to the off-diagonal elements to ensure that the distances between the
found coordinates are euclidean (Cailliez, 1983; Mardia, 1978). In order to derive these
p-dimensional coordinates xi = (xi,1 , ..., xi,p ) ∀ i = 1, ..., n from the dissimilarity matrix d,
the objective is to minimise the squared error between the entries of d and the euclidean
distances calculated with the respective coordinates:
X

x = (x1> , . . . , xn> ) = argmin
x̃∈R p×n

i6= j

1/2

(di j,soc + c − kx̃i − x̃ j k2 )

(8)

,

in our case we set p = 2. See Cox and Cox (2000); Borg et al. (2013) for methods to find
x such that (8) holds. Since the resulting coordinates, represented by xi,soc ∀ i ∈ {1, ..., },
can only be determined up to the location, rotation, and reflection, we additionally use
Procrustes Analysis (Cox and Cox, 2008) to use the rotation most similar to the geographic
coordinates in Figure 8 and the subsequent analysis. This does not change the estimates
or inference, since we apply isotropic smooth terms (further details are given in Section
3.2).

B

Estimation of θ given c and complete data

From (4) we construct a partial likelihood for each district and age/gender group tuple
(similar to a semiparametric version of Fokianos and Kedem, 2004). Combining these
separate contributions under independence leads to a joint logarithmic likelihood, which
is given by:
!

φ
Γ (φ + yi,g,t )
+ φ log
`(θ , c) ∝
log
yi,g,t !Γ (yi,g,t )
φ + µi,g,t
i=1 g∈G t=1
n XX
T
X

!

µi,g,t
+ yi,g,t log
φ + µi,g,t

!

,

(9)

note that φ is the dispersion parameter of the negative binomial distribution and that
the likelihood of the imputation model from (3) in Section 2.3 has the same form with
φ −1 = σl . Suppose we plug µi,g,t as defined in (5) into (9) and fix the value of c. In
that case, we observe that the result is a function of θ and resembles the likelihood of a
generalised additive model with negative binomial distributed target variables and denote
26

the likelihood by `(θ |c) (Ruppert et al., 2003). To obtain a smooth fit of θ , we extend
this likelihood by an additive penalisation component:
` p (θ |c) = `(θ |c) + τ > S,

(10)

where τ = (τa , τb , τcoord , τsoc ) are smoothing parameters weighting the term-specific penalties S = (Sa , Sb , Scoord , Ssoc ). The choice of these penalties differs between the random
effects and bivariate spacial effects. For the random effects, we follow Ruppert et al.
P
(2003) and define Sa and Sb through ridge penalties, hence, for instance, Sa = 2i=1 a2i .
In the case of the isotropic semiparametric terms, we chose the penalty terms in accordance with Duchon (1977). Here, Scoord penalises the roughness of the bivariate function fcoord (xi,coord ) = fcoord (xi,coord,1 , xi,coord,2 ), where xi,coord,p denotes the pth dimension of
xi,coord ∀ p ∈ {1, 2}, here the longitude and latitude of district i. Given this notation, we
can state the functional form of the penalty term:
Scoord =

Z

∂2

fcoord (xi,coord )2 + 2

∂2
fcoord (xi,coord )2 +
∂ xi,coord,1 ∂ xi,coord,2

∂ 2 xi,coord,1
∂2
fcoord (xi,coord )2 dxi,coord,1 dxi,coord,2 .
∂ 2 xi,coord,2

Besides we ensure identifiability of all smooth effects by incorporating a sum-to-zero
P
constraint per term, which translates to ni=1 fcoord (xi,coord ) = 0 for fcoord (xi,coord ) (Wood,
2017).
To maximise (10) in terms of θ and τ, we follow the nested optimisation approach of
Wood (2011). Hence, we find τ̂ in an outer iteration and θ̂ consecutively in an inner iteration, which exploit the finding that θ̂ is the posterior mode of θ |y under the assumption
that θ follows a zero-mean normal prior with improper variance (Kimeldorf and Wahba,
1970). Thereby, we view θ as random coefficients and can estimate all smoothing parameters τ via restricted maximum likelihood estimation. More specifically, we set up f (y, θ |c)
given `(θ |c) and f (θ ). Through integrating θ out of f (y, θ |c) by deploying a Laplace
approximation we obtain an approximate REML criterion, which is a function of τ and
φ , the dispersion parameter from (9). Maximising the derived function results in τ̂ and
φ̂ (see Wood, 2011 for additional details). Given the tuning parameters, we consecutively
find θ̂ through standard penalised iterative re-weighted least squares estimates (PIRLS,
Wood, 2017) in the inner iteration. We repeat this iterative scheme until convergence to
obtain θ̂ and τ̂ given a fixed value of c. The implementation of this routine is available
within the software package mgcv (Wood, 2017).

27

Supplementary Material
On the Interplay of Regional Mobility,
Social Connectedness, and the Spread of
COVID-19 in Germany
Cornelius Fritz and Göran Kauerman
Department of Statistics, LMU Munich

arXiv:2008.03013v2 [stat.AP] 16 Feb 2021

February 17, 2021

Contents
1 Analysis of Representativeness of Facebook Data
2 Further Information on the Imputation of the Test Delay
2.1 Stochasticity of Missings . . . . . . . . . . . . . . . . . . . .
2.2 Missing at Random Analysis . . . . . . . . . . . . . . . . . .
2.3 Complete Estimates . . . . . . . . . . . . . . . . . . . . . . .
2.4 Sensitivity Analysis of Disease Onset Imputation . . . . . .

1

2
.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

4
4
5
5
8

1

Analysis of Representativeness of Facebook Data
e12

Facebook Population

e11

e10

e9

e8

e7
e11

e12
e13
e14
General Population

e15

Figure 1: Scatter-plot of the Facebook population that opted in the geolocation features
and the general population for each district.
To guarantee robust estimates, we investigate to what extent the mobility data provided by Facebook in the context of the Data for Good program (Maas et al., 2019; Iyer
et al., 2020) are representative of the general German population and in line with other
mobility data. We carry out the respective assessment in three parts:
1. Compare the spatial distribution of Facebook users that opted in geolocation features
with the general population for each district.
2. Contrast the age structure of Facebook users with the demographic pyramid in Germany.
3. Check if mobility data from other providers, i.e., Apple and Google, measure similar
information as the Facebook data.
Spatial Distribution: Besides mobility data, the datasets made available by Facebook also include the daily counts of Facebook users who enabled geolocation features in
each federal district. For this assessment, we only look at the average of users per district over the study period from the 3rd of March to the 16th of June 2020 and calculate
the same quantity for the general population provided by the German Federal Statistical
Office. Figure 1 is a scatter-plot of 401 points representing the general and Facebook
population measured for each federal district. We can conclude from this plot that the
spatial distribution of Facebook users is positively correlated with official statistics, i.e.,
the estimated Pearson correlation is 0.98.
Age Representation: In addition to people’s spatial distribution, we want to compare the age structure of general Facebook users and the general German population.
The Facebook users’ age structure that turned on the geolocation features is unknown
due to differential privacy. As a possible proxy for this information, we compile in2

Gender

M Facebook

M General

W Facebook

W General

0.4

Proportion

0.2

0

0.2

18−24

25−34

34−54
Age Groups

35−44

55−64

Figure 2: Comparison of the age- and gender-structure within Facebook and in the general
population of Germany.
formation about the age structure of the entire Facebook population in Germany from
Facebook Audience Insights. Unfortunately, Facebook’s age-groups are not following the
age groups given by the RKI. As can be seen in Figure 2, the Facebook population is
younger than the general population. While we can conclude that the age groups 18-24,
35-54 are adequately represented in the Facebook sample, there is a surplus of people in
the 25-to-34-year-old cohort. Simultaneously, the age group of the oldest individuals is
in relative terms less populated than the general population. Still, this finding does not
necessarily indicate a bias in the mobility data that we use in the principal analysis. Due
to the standardisation of the mobility-related covariates given in Formula (1) of the main
paper, the covariates are robust to a nation-wide under- and over-representation of older
and younger individuals. In that case, the measurement bias would only be a constant,
and hence the standardised covariates would be the same. We cannot quantify with the
available data whether the percentage compositions of those age structures vary within
each district. However, the promising results of the spatial representativeness make it
reasonable to assume that this is not the case.
Mobility Measurement from other Sources: We now contrast the mobility data
provided by two other major technology companies, namely Apple1 and Google2 , with
the data made available by Facebook. We use the Google Community Mobility Reports,
including relative mobility trends in retail or grocery stores, transit stations, and places
of work. Similarly, Mobility Trends Reports from Apple use information on the relative
requests for directions to walk, drive or use transit transportation in Apple Maps to
measure the mobility trends. Since solely the Percentage of People Staying Put relates to
absolute movements in the Facebook data, we investigate the Pearson correlation matrix
of all given mobility indices in Figure 3. The high correlations in the first row and column
are conclusive in that the Percentage of People Staying Put captures the information of
all other variables reasonably well since the absolute correlation coefficients range from
0.88 to 0.97.

1
2

https://covid19.apple.com/mobility
https://www.google.com/covid19/mobility/

3

1

Apple Transit

Apple Driving

Apple Walking

Google Residential

Google Workplaces

Google Transit

Google Grocery

Google Retail

Facebook Staying Put
Facebook Staying Put

1

−0.95 −0.9 −0.95 −0.93 0.97 −0.88 −0.88 −0.91
0.8

Google Retail −0.95

1

Google Grocery −0.9 0.83

0.83 0.98 0.92 −0.98 0.89 0.88 0.97
1

Google Transit −0.95 0.98 0.85

0.85 0.93 −0.89 0.62 0.63 0.74
1

Google Workplaces −0.93 0.92 0.93 0.95

0.95 −0.99 0.85 0.82 0.96
1

Google Residential 0.97 −0.98 −0.89 −0.99 −0.97

−0.97 0.71
1

Apple Walking −0.88 0.89 0.62 0.85 0.71 −0.85
Apple Driving −0.88 0.88 0.63 0.82

0.7

0.86

−0.85 −0.84 −0.95
1

0.7 −0.84 0.98

Apple Transit −0.91 0.97 0.74 0.96 0.86 −0.95 0.93

0.98 0.93
1

0.9

0.9

1

0.6
0.4
0.2
0
−0.2
−0.4
−0.6
−0.8
−1

Figure 3: Correlation matrix of the weekly national mobility indicators from Facebook,
Google, and Apple.

2

Further Information on the Imputation of the Test
Delay

The imputation procedure given in the main article relies on all observations to be missing
at random (MAR,Little and Rubin, 2002). To check this assumption, we first argue for
stochasticity of the mechanism driving the binary indicator whether the target variable,
i.e., the date of disease onset, is missing. In a second step, we perform a missing at
random analysis to discover which covariates affect this mechanism. We consecutively
employ the detected covariates in the imputation procedure introduced in Section 2.3 of
the main article and report the full estimates. Finally, we conduct a sensitivity analysis
to check whether our findings change if we only regard cases with observed disease onset.

2.1

Stochasticity of Missings

Each registered COVID-19 case can be characterised by three dates representing distinct
stages of the disease, namely the time of infection, disease onset, and registration at local
health authorities. This progression is illustrated in Figure 4. While we do not observe
the disease onset date for some cases, we can still argue that all samples progress through
the same three stages, although the second date is in some cases latent. Hence under
the assumption that the incubation period from the infection date to the (observed or
latent) disease onset date is stochastic, it is also appropriate to assume that the same
holds for the test delay, defined as the time-span between disease onset and registration
4

Test Delay
(Partially Observed)

Incubation Period
(Not Observed)

Infection

Disease Onset

Registration

Figure 4: Illustrative temporal path of a COVID-19 infection, collected surveillance data
and resulting delays.
Model
Model
Model
Model
Model
Model
Model

1
2
3
4
5
6
7

Time Trend
X
X
X
X
X
X

Age
X
X
X
X
X
X

Gender Age:Gender District State
X
X
X
X
X
X
X
X
X
X
X
X
X
X
X
X
X
X
X
X
X
X
X
X

cAIC
Rank
121082.6
1
121085.1
2
142111.7
7
126562
6
121106.9
3
121217.2
5
121189.7
4

Table 1: Different specifications of the missing at random process. The sign X signals
the inclusion of a specific covariate in the respective model. In the last two rows the
corresponding corrected AIC (cAIC) values and their rankings are given.
date. Given this argument, it is legitimate to impute the test delay through a stochastic
model. We can then use this information to project the disease onset date back from the
registration date for all cases given the observed data. Besides, we carry out a sensitivity
analysis in Section 2.4 to check for structural differences in the dynamics of infection rates
of cases with a disease onset and all cases. The estimates excluding all observations with
missing disease onset date are in accordance with our findings of the main article.

2.2

Missing at Random Analysis

Having established that the missing values are random, we need to identify the covariates
driving the missing values’ mechanism. To do that, we generate a binary indicator of
whether the test delay was observed for each case l. In the consecutive step, we take
this binary indicator to be the target variable of a logistic regression with seven different
sets of covariates given in Table 1, which we compare utilising the corrected AIC values
(Wood et al., 2016). Further, we include all categorical effect by dummy-coding them.
All effects are fixed beside the Gaussian random district-specific effects. We parametrise
the temporal trend by a penalised spline (Eilers and Marx, 1996). In the final row of
Table 1, the corresponding cAIC values indicate that Model 1 is the best specification of
the missing at random process; hence we employ the corresponding set of covariates in
our imputation model.

2.3

Complete Estimates

Originating from the missing at random analysis of Section 2.2, our imputation model
incorporates a random district-specific effect, a temporal trend, and dummy covariates
for the age, gender, and state cohort as well as an interaction between age and gender
groups. In our proposed imputation procedure, we parametrise not only the mean of the
5

● µ ● σ

0.6
0.4

●

●

●

0.2
●

●
●

●
●
●

Saarland

Rhineland Palatinate

Northrhine−Westphalia

Mecklenburg Western Pomerania

Hesse

Lower Saxony

Hamburg

Bremen

Berlin

●

Brandenburg

●

●

●

●

−0.2

●
●

●
●

●

●

Schleswig Holstein

●

●
●

Thuringia

●

●

Saxony

●

●

Saxony−Anhalt

●

0.0

●

●

Bavaria

State Coefficients with 95% CI

Modeled Parameter

Figure 5: Linear State Effects of the test delay model on µ and σ . The reference category
is Baden-Württemberg, hence the respective coefficient is fixed at zero.
test delay (µ) but also its scale factor (σ ). Therefore, we provide the full estimates of
the corresponding model defined in Formula (2) of the main article separately for each
coefficient. Besides, we decompose all reported effects into linear, non-linear, and random
effects.
Fixed Terms: In addition to the demographic covariates discussed in the main article,
we included a fixed effect for each state. For the results shown in Figure 5, we use BadenWürttemberg as the reference category. Hence, all estimates should be interpreted relative
to Baden-Württemberg. The state effects on µ in Figure 5 (a) indicate that the average
test delay in eastern states, e.g., Saxony-Anhalt and Saxony, is lower than in the reference
category. The test delay volatility also varies significantly between the states, as shown
in Figure 5 (b), e.g., it is the highest in Mecklenburg Western Pomerania and Hamburg.
Smooth Terms: We observe a negative temporal trend for reporting dates during the
beginning of March. But once we see more reported cases in April, the average test delay
lengthens. During this period, the σ parameter is higher, leading to a higher variance of
the respective observations. After May, the average delay decreases but increases again
during the last week of this study.
Random Terms: The district-specific intercept effects for µ are given in Figure 7
(a), while Figure 7 (b) shows them for σ .

6

(a), µ

(b), σ
0.5

f(Reporting Date)

f(Reporting Date)

0.2

0.0

−0.2

0.0

−0.5

−1.0
−0.4
Mar

Apr
May
Jun
Reporting Date

Jul

Mar

Apr
May
Jun
Reporting Date

Jul

Figure 6: Smooth temporal trends of the µ (a) and σ (b) parameter of the test delay
model.
(a), µ

−0.50 −0.25 0.00

(b), σ

0.25

−0.5

0.0

0.5

Figure 7: Random district-specific effects regarding µ (a) and σ (b) parameter of the test
delay model.

7

(a) Gini Index

(b) Percentage Staying Put

0.2

●

0.2

●

●

θ^t,sp

θ^t,gini

●

0.0

●
●

●
●

●

●

●

0.0

●
●

●

●
●

●

●
●

●

●

●

●

●

●

●

−0.2

−0.2

●
●

●

●

03
03−09
03−16
03−23
04−30
04−06
04−13
04−20
05−27
05−04
05−11
05−18
06−25
06−01
06−08
−1
5

−0.4

03
03−09
03−16
03−23
04−30
04−06
04−13
04−20
05−27
05−04
05−11
05−18
06−25
06−01
06−08
−1
5

−0.4

Week (t)

Week (t)

Figure 8: Temporal Effect with 95% confidence interval of the Gini index and the percentage of people staying put when excluding all imputed disease onset dates.

2.4

Sensitivity Analysis of Disease Onset Imputation

We carry out a sensitivity analysis of the imputation procedure introduced in Section
4 of the main manuscript to check whether our findings differ if we only regard cases
with observed disease onset. In Figures 8 to 11, the model results are given if we only
include the cases where the disease onset date is recorded in the surveillance data. All
findings of the principal analysis are robust to the imputation method used; hence we see
no structural differences that arise due to including all cases rather than only the cases
with an observed disease onset.

8

(a) Social Space

(b) Geographic Space

●
●
● ●
● ● ●●
●
● ●
●
● ●
● ● ●● ●
● ●●
● ●●●●●
●
●
●
●
●
●
●● ●
●
●●● ● ●●
●
●
●● ● ●
●
●
●●● ●
● ●●
● ●● ●
●●
●
●
●●● ●
●
●
●● ●●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●●
●
●
●● ●
●●
●
● ●
●
●
●●
●●● ● ●
●
●
●
●
●
●●
●
● ●
● ●●
●
● ●●
● ●
●
●
●
● ●● ●
●
●
●
●●
● ●
● ●
●
●●●
●
●
●
●
●
● ●●
● ●
●
●
●
● ●●
●
● ● ●●
●●
●
●●
●
●
●●
●
●
●
●
●
●
●
●
●
●
●
● ●
●
●
● ●
●
●
●
● ●
● ●
●
●
●
●
●
●
●
●
●
●●
●
● ●
●
●
● ●
● ●
●●●
●
●
● ●
●
● ●
●●● ● ●
●
●
● ●●
● ●
●
●
●●
●●
●
●
●
●● ●
●●●
●
●
●
●
●
●●
●
● ●
●
●●
● ●●●
●
● ●●● ●●
●
●
● ●● ●● ●
●
●
● ● ●●
●● ● ●
●
●
●● ●
●
●
●● ● ●
●
●
●
●
●
●
●
●
●
●
●
●● ●●
● ●●● ●
●
● ●
● ●
●
●
●
●●
●●
●●
●
●
●● ●
● ●
● ●●
●●
●
●
●●
● ● ●
●●
● ●
● ●
●
●
● ●
●
● ●
● ● ●●

●

●

Dimension 2

2

0

−2

●

−2

0
Dimension 1

●

●

●
●
● ●●
●
●
●
●
●
●
●
●
●
●

●

●

● ●●

●●

●
● ●
● ●
●
●
●● ●
●
●
● ● ●

●

●
●

●
●

●

●
●

●

●

●
●
●

●
●
●
●

●
●

●

●

●
●
●
●
●
● ●
● ● ●
●
●● ●
●
●
●
●
●
●
●
● ●●
●
●
● ●
●
●
●
●
● ●
●
● ●● ●
●
●
●
●
●
●
● ●
● ●
● ●
●
●
●
●●●● ●●
●
●
●●● ●
●●
●
●
●
●
●
●
● ● ●● ●●● ●
● ●
●
●
●
●
●
● ● ●●
●
●
●
●
●● ●
●
●
●
● ●
● ●●
●
●
● ● ●
●●
● ● ●●
●
●
●
●
●
●
●
●
●
●
● ●
● ●
●
● ● ●
● ● ● ●
●
●
● ● ●● ●
●
●●●
●
●
●
●
●
●
●●● ●●
●
● ●
●
●
●
●
● ●● ●
● ●
●
●
●● ●
●
●
●
● ● ●● ●
● ●
●
●
●
●
●
●
●
● ● ● ●
●
● ●
●
●
● ● ● ●● ● ●
●
●
●
●
●
●
●●
●
●
● ●
● ● ●●
●
●
● ●● ●
●●
●
● ●
● ●
●
●
●
● ●
●
●
●
●
● ● ●
●
●
●
●
●
● ●
● ●
● ● ●●
● ●
● ● ● ●
●
●
●
●
●
●
●
● ● ● ● ●● ● ● ●
● ●
● ●
●
● ●
●
● ●
●
●
●
●
● ●
●● ● ● ●
●●
●
● ●
●
●
●
● ● ● ● ●
●
● ●
●
● ●
●
●

●

●

●
●

2

−0.8

−0.4

0.0

0.4

Figure 9: Coordinates of the districts in the friendship distance (a) and transferred to
the geographic (b) space. The colour in the background represents the estimates of the
smooth fit when excluding all imputed disease onset dates. Only the predictions in the
range of observations are shown in (a).

−0.50 −0.25 0.00

0.25

Figure 10: Estimates of the spatial effect when excluding all imputed disease onset dates.

9

(c) Long Term Random Effect

(d) Short Term Random Effect

−1.5 −1.0 −0.5 0.0 0.5 1.0

−1

0

1

2

3

Figure 11: Estimates of the spatial and random effects when excluding all imputed disease
onset dates.

References
Eilers, P. H. and B. D. Marx (1996). Flexible smoothing with B-splines and penalties.
Statistical Science 11 (2), 89–102.
Iyer, S., B. Karrer, D. Citron, F. Kooti, P. Maas, Z. Wang, E. Giraudy, P. A. Dow, and
A. Pompe (2020). Large-scale measurement of aggregate human colocation patterns for
epidemiological modeling. medRxiv preprint.
Little, R. J. A. and D. B. Rubin (2002). Statistical Analysis with Missing Data. New
York: Wiley.
Maas, P., I. Shankar, A. Gros, P. Wonhee, L. Mcgorman, C. Nayak, and A. P. Dow
(2019). Facebook Disaster Maps: Aggregate Insights for Crisis Response & Recovery.
In Proceedings of the 16th ISCRAM Conference, pp. 1–12.
Wood, S. N., N. Pya, and B. Säfken (2016). Smoothing parameter and model selection
for general smooth models. Journal of the American Statistical Association 111 (516),
1548–1563.

10

