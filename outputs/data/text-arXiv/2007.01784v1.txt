Submitted to the Annals of Statistics

UNIFIED STATISTICAL INFERENCE FOR A NOVEL
NONLINEAR DYNAMIC FUNCTIONAL/LONGITUDINAL
DATA MODEL

arXiv:2007.01784v1 [stat.ME] 3 Jul 2020

By Lixia Hu∗ , Tao Huang† and Jinhong You†
Shanghai Lixin University of Accounting and Finance∗ and
Shanghai University of Finance and Economics†
In light of recent work studying massive functional/longitudinal
data, such as the resulting data from the COVID-19 pandemic, we
propose a novel functional/longitudinal data model which is a combination of the popular varying coefficient (VC) model and additive
model. We call it Semi-VCAM in which the response could be a functional/longitudinal variable, and the explanatory variables could be
a mixture of functional/longitudinal and scalar variables. Notably
some of the scalar variables could be categorical variables as well.
The Semi-VCAM simultaneously allows for both substantial flexibility and the maintaining of one-dimensional rates of convergence.
A local linear smoothing with the aid of an initial B spline series
approximation is developed to estimate the unknown functional effects in the model. To avoid the subjective choice between the sparse
and dense cases of the data, we establish the asymptotic theories of
the resultant Pilot Estimation Based Local Linear Estimators (PEBLLE) on a unified framework of sparse, dense and ultra-dense cases
of the data. Moreover, we construct unified consistent tests to justify whether a parsimony submodel is sufficient or not. These test
methods also avoid the subjective choice between the sparse, dense
and ultra dense cases of the data. Extensive Monte Carlo simulation
studies investigating the finite sample performance of the proposed
methodologies confirm our asymptotic results. We further illustrate
our methodologies via analyzing the COVID-19 data from China and
the CD4 data.

1. Introduction. Increasingly, data is recorded continuously over an
interval of time (spatial location, or wavelength and so on) or intermittently
at several discrete points in time due to progress in modern computation
technology. As a result, the data in which each individual has multiple observations becomes more and more common in almost all scientific, societal
and economic fields. Obviously, a recent example of this kind of data is the
COVID-19 data: the daily confirmed diagnoses, death toll and suspected
MSC 2010 subject classifications: Primary 60G08, 60G05; secondary 60G20
Keywords and phrases: Unified Inference, Semi Varying-coefficient Additive Models,
Longitudinal Data, Local Linear Estimators, Sparse and Dense

1

2

LIXIA HU, TAO HUANG AND JINHONG YOU

cases of different countries are recorded and made available. When a variable is measured or observed at different times, the variable is usually treated
as a function of time. As a result, the variable is called a functional variable,
the data for the variable are called functional data and the related statistical
analysis is called functional data analysis (FDA) ([38]). The functional data
and corresponding FDA have been successfully applied to explore the interactions and co-movements among a group of temporally evolving subjects.
Several monographs by [31], [32] and [9] provide comprehensive discussions
on the methods and applications. More recent work about FDA could refer
to [38].
According to [38], usually, the functional data could be divided into two
cases: sparse and dense. Sparse functional data usually occurs in longitudinal studies where subjects are measured at different time points and the
number of measurements for each subject is often bounded away from infinity. Inversely, in the dense functional data the number of measurements
of each subject tends towards to infinity. In theory, the difference between
sparse (longitudinal) and dense function data is clear. However, due to the
limitations of humans, the observations in real data sets could not be infinite and are definitely finite. Therefore, the edge of sparse (longitudinal)
and dense function data in practice is vague in some scenarios, especially
when the number of measurement of each subject is moderate or different
subjects have different numbers of measurements.
In many functional/longitudinal studies, repeated measurements within
each subject are possibly correlated with each other, but different subjects
can be supposed to be independent. One approach to take intra-subject
variation into account is the mixed-effects model [42], which decomposes
regression function into a fixed population mean and a subject-specific random trajectory with zero mean. For sparse and dense functional data, [19]
considered a mixed-effects nonparametric regression model absence of covariates, and showed that the asymptotic distributions of kernel estimators
are essentially different in these two situations. Therefore, a subjective choice
between sparse and dense cases may lead to erroneous conclusion. To evade
this problem, they proposed a self-normalized method, which can deal with
sparse and dense functional data in a unified framework. Furthermore, [4]
generalized the results of [19] to a mixed-effects VCM presence of covariates
with sparse or dense functional data. Lately, [47] provided a comprehensive
perspective that deals with a general weighing scheme on a unified paltform
for all types of sampling plan, including sparse, dense and ultra dense case.
Motivated by a monotone relationship between gray matter volume and age
in the older population, [5] considered sparse and dense cases on a unified

UNIFIED STATISTICAL INFERENCE

3

framework under monotone constraint of the mean function. The research
work of [47, 5] has focused on the statistical inference about mean function
of the underlying process. To the best of our knowledge, there exists no further development about unified inference parallel to [47] for nonparametric
regression model presence of covariates, a common case in practice.
In the analysis of longitudinal data, a varying-coefficient models (VCM)
enjoying flexibility, parsimony and interpretability, is a widely-used nonparametric regression method. One can refer to [8, 10, 12, 15, 16, 17, 29, 35]. An
additive model (AM) is another popular nonparametric regression method,
which has been studied by [1, 3, 25, 27, 28, 30, 43, 44, 34]. Recently,
[13, 14, 46, 48] have investigated a novel nonparametric regression method,
named the varying-coefficient additive model (VCAM), which can be viewed
as a generalization of the VCM and AM. Let Tij be the observation time
when the jth measurement of the ith subject is made, Yij and Xi (Tij ) := Xij
be the response and p-covariates for the ith subject at time Tij , respectively. Then {(Yij , Xij , Tij ) ; i = 1, ..., n; j = 1, ..., mi } constitutes a longitudinal/functional sample from n randomly selected subjects with mi repeated
measurements of the ith subject. The VCAM for longitudinal/functional
data is proposed by [14] as below
(1.1)

Yij = α0 (Tij ) +

p
X

αk (Tij ) βk (Xijk ) + νi (Tij ) + εij ,

k=1

with the abuse of notations. Here νi (Tij ) is the subject-specific random
trajectory at observation time Tij , and {εij } are i.i.d. random measurement
errors. The multiplicative factors αk (k = 1, ..., p) and βk (k = 1, ..., p) are
called to be varying-coefficient component functions and additive component
functions, respectively, and α0 is a trend term. Obviously, the VCAM (1.1)
reduces to an AM provided that each αk (k = 0, ..., p) is time-invariant,
whilst it becomes a VCM if each βk (k = 1, ..., p) has a simple linear form.
Therefore, it can be said that the VCAM is a kind of hybird of an AM
and a VCM, enjoying more flexibility, which can greatly decrease the bias
of model misspecification. On the other hand, it is hard to address how to
choose between an AM and a VCM in practice. The general type of a VCAM
provides a data-driven method to decide which model may be more suitable
for the real-life data at hand.
However, the product forms of αk and βk in (1.1) exclude the discrete
covariates from this model. It will vastly limit the scope of applications
because categorical variables are often important influence factors in the
practical fields. To accommodate both discrete and continuous covariates in
regression model, in this paper we consider a mixed-effects semi varying-

4

LIXIA HU, TAO HUANG AND JINHONG YOU

coefficient additive model (Semi-VCAM) to analyze longitudinal data. Let
Zi (Tij ) := Zij = (1, Zij,1 , ..., Zij,q )τ be a {q + 1}-vector of discrete covariates
observed at time Tij , and α0 (t) = (α00 (t) , α01 (t) , ..., α0q (t))τ is the vector
of varying-coefficient functions for Z that is i.i.d. with Zi , and α00 denotes
the trend function. Then, we generalize the VCAM (1.1) to a Semi-VCAM
as below,
(1.2)

Yij = Zτij α0 (Tij ) +

p
X

αk (Tij ) βk (Xijk ) + νi (Tij ) + σ (Tij ) εij ,

k=1

where the subject-specific random trajectory νi (t) satisfies E [νi (t)] = 0
and covariance function γ (t, t′ ) = E [νi (t) νi (t′ )], {εij } are random errors
such that E (εij ) = 0 and E(ε2ij ) = 1, and σ (t) is a smooth standard deviation function of process ε (t). Note that (1.2) allows a mixture of functional/longitudinal predictors and scalar covariates, and it reduces to a partial linear additive model (PLAM), if each varying-coefficient function is
time-invariant. Compared with the model (1.1) studied in [14], (1.2) allows
categorical covariates and heteroscedasticity as time elapsed. Meanwhile, in
this paper we also take into account intra-subject correlation, which was
merged into random errors in [14]. Therefore, Semi-VCAM is a more refined
nonparametric model than VCAM (1.1) in the analysis of longitudinal data.
As a global smoothing technique, spline method is widely used to fit a
smooth nonparametric function because of its merit of cost saving. But it
usually has no asymptotic distribution due to absence of decomposition of
bias part and variance part, unless the asymptotic bias is smaller of high
order than the asymptotic variance. All of the existing research literatures
about VCAM are based upon a spline method, [46, 48] provide no asymptotic
distributions of estimators, whilst [13, 14] obtain the asymptotic distributions under the condition that the asymptotic bias can be ignored. Alternatively, kernel method is a local smoothing tool, based upon which we can
construct the involved asymptotic distribution presence of asymptotic bias,
and make statistical inference on certain interested function. Specially, local
linear smoothing is popular due to its nice properties, such as design adaption, good boundary performance, and statistical efficiency in an asymptotic
minimax sense, see [7] for more details.
In this paper, we build a pilot estimation based local linear estimator
(PEBLLE) for varying-coefficient component functions and additive component functions, respectively. The proposed estimation method has wide
applicability, including sparse data and dense data, and the data presence
of functional/longitudinal covariates and scalar variables. We have shown the
consistency of PEBLLE, and as a main contributor of this paper, we con-

UNIFIED STATISTICAL INFERENCE

5

struct the asymptotic distributions on a unified framework for sparse, dense
and ultra dense data. For the convenience of concise presentation, we only
consider the same weight to each subject (SUBJ), and our theoretical results
can be viewed as a generalization of [47] to nonparametric regression model
presence of covariates with SUBJ scheme. Another intriguing question is
how to judge a general Semi-VCAM or a submodel is sufficient. To this end,
we develop two hypothesis testing to decide whether each varying-coefficient
component functions is time-invariant (i.e., a PLAM or especially, an AM
if absence of Z covariates), or whether each additive component function
has linear form (i.e., a VCM). It has been shown that the proposed testing
procedure is consistent on a unified framework of sparse, dense and ultra
dense case of data.
In the empirical studies, we consider the new coronavirus disease (COVID19) breaking out in December 2019, and apply our method to analyze the
growth rate of cumulative confirmed (GRCC) cases in China except Hubei
Province, Tibet, Macao, Taiwan and Hong Kong. We collect the data from
https://github.com/CSSEGISandData/COVID-19, and take sample period
from January 22th, 2020 and April 8th, 2020. To model GRCC, four function
covariates and one scalar covariate (population size) are chosen. The testing
procedures show that a Semi-VCAM is necessary for this dataset. Another
example is CD4 data from the Multicenter AIDS Cohort Study (a data
set in the R package “timereg”), which has been studied by [15, 45]. In
this model, smoke status (1 for smoker and 0 for nonsmoker) is included.
Employing Semi-VCAM, the testing procedure shows a VCM is sufficient,
which verifies the rationality of the research results in [15].
The rest of this paper is organized as follows. Section 2 proposes a pilot
estimation based local linear smoothing method and Section 3 presents a
series of the asymptotic theories. In Section 4, we propose a testing procedure to justify whether a VCM or a PLAM is sufficient or not, and show
its asymptotic properties. Section 5 speaks about the implementation of the
proposed method. Extensive simulation studies investing the finite-sample
performance and real data applications illustrating our methodologies are
considered in Section 6. Brief remarks are concluded in Section 7. The requirements for validity of the asymptotic theories are presented in the Appendix, and the main proofs are relegated to the Supplementary Material.
2. Estimation Method. We assume that observation time {Tij } are
i.i.d. copies of T , which has a density function fT with a bounded support,
say [a, b]. The vector of covariates Xi = (Xi1 , ..., Ximi )τ for the i-th subject
is randomly drawn from a p-dimension stochastic process X(T ), of which

6

LIXIA HU, TAO HUANG AND JINHONG YOU

the k-th element Xk (T ) has a marginal density function fXk with support
Sk . To identify the trend term and product terms in model (1.2), we impose
the conditions E [αk (T )] = 1 and E [βk (Xk )] = 0 (k = 1, ..., p), a similar
practice with [48, 14].
In this section, we develop pilot estimation based local linear estimators (PEBLLEs) for αk and βk . Suppose that βk ’s are known, then SemiVCAM (1.2) become a VCM, and the LLE of αk ’s are easily obtained. Let
a0t = {a00 (t) , ..., a0q (t)}, at = {a1 (t) , ..., ap (t)}τ , b0t = {b00 (t) , ..., b0q (t)},
bt = {b1 (t) , ..., bp (t)}, where t is any interior point on the interval [a, b]. We
solve the optimization problem as below
Q1 (ât , b̂t ) = min Q (at , bt )
t∈(a,b)

q
mi h
n
X
X
1 X
Yij −
Zijl {a0l (t) + b0l (t) (Tij − t)}
=
mi
i=1

j=1
p
X

−

(2.1)

k=1

l=0

{ak (t) + bk (t) (Tij − t)} βk (Xijk )

i2

khC (Tij − t) ,

where kh (·) = k (·/h) /h for certain kernel function k. Then the LLE of
varying-coefficient component functions are given by α̂0l (t) = â0l for l =
0, ..., q and α̂k (t) = âk for k = 1, ..., p.
On the other hand, if αk ’s are known, then Semi-VCAM reduces to an
AM. Suppose that we have got estimation of additive component functions
except βk , denoted as β̃l for l 6= k, and consider the following minimum
problem
Q2 (âx , b̂x ) = min Q2 (ax , bx )
Sk

=

n
X
i=1

1
mi

mi h
X
j=1

i2
Ŷij,−k − αk (Tij ) {ax + bx (Xijk − x)} khA (Xijk − x) ,

where x is any interior point of support Sk of Xk , and Ŷij,−k = Yij −
P
Zτij α0 (Tij ) − l6=k αl (Tij )β̃l (Xijl ). Then, the LLE of βk is given by β̂k (x) =
âx .
However, both αk and βk are unknown, implying the above-mentioned
estimation methods are infeasible. To this end, we propose pilot estimations
of additive component functions. Similar to [14], we view multiplicative term
αk (t) βk (x) as a general bivariate function, say gk (t, x), and estimate it using tensor B-spline method. Specifically, for any given t and x, the tensor

UNIFIED STATISTICAL INFERENCE

7

product is defined as T (t, x) = Bk,A (x) ⊗ bC (t), where ⊗ means the Kronecker product of matrices or vectors, and bC (t) and Bk,A (x) denote the
B-spline basis approximating αk (t) and βk (x), respectively.
Then, we approximate α0l (t) ≈ γ τ0l bC (t) for l = 0, ..., q, and gk (t, xk ) ≈
τ
γk Tk (t, xk ) for k = 1, ..., p. Solving the following optimization problem
(2.2)

"
#2
p
mi
n
X
X
1 X
τ
τ
Yij − γ 0 Zij ⊗ bC (Tij ) −
γk Tk (Tij , Xijk ) ,
min
γ
mi
i=1

j=1

k=1

we got he estimator of gk as ĝk (t, xk ) = γ̂kτ Tk (t, xk ), where γ̂k is given
by (2.2). Furthermore, the identification condition E[αk (Tij )] = 1 implies
Rb
βk (x) = a gk (t, x)f (t)dt. Hence, a pilot estimator of additive component
function βk can be given by
(2.3)

β̂k,P (x) =

n mi
1 XX
γ̂kτ Tk (tij , x) ,
N

k = 1, ..., p,

i=1 j=1

Pn
where N =
i=1 mi is total observation, and subscript ‘P’ means pilot
estimator.
Now, we can define the PEBLLEs of varying-coefficient component functions and additive component functions.
• Substituting the pilot estimators β̂k,P (k = 1, ..., p) into the objective
function Q1 , we obtain the PEBLLE of α0l for l = 0, ..., q and αk for
k = 1, ..., p, and still denote them as α̂0l and α̂k , respectively.
• In the objective function Q2 , we take the PEBLLEs of varying-coefficient
component functions as their pilot estimations, and β̂l,P (l 6= k) as the
pilot estimators of additive component functions, and yield the PEBLLE of βk , still write as β̂k .
Remark 1. Compared to the spline-based estimators of [14], the PEBLLE can provide asymptotic distribution with the specific expression of
asymptotic bias, and make inference on the confidence interval of component
functions. Meanwhile, our estimation methodologies adapt to both sparse
and dense longitudinal/functional data, and have wide application in the
real word.
3. Asymptotic Results. In this section, we will present the asymptotic distribution and convergence rate of PEBLLE on a unified platform
for different sampling plans.

8

LIXIA HU, TAO HUANG AND JINHONG YOU

3.1. Asymptotic
Properties
of Varying-coefficient Component Functions.
−1
P
be the harmonic mean of {m1 , ..., mn }, and denote
Let N̄H = n1 ni=1 m1i
the interior knots number of B-spline basis bC (t) and Bk,A (x) (k = 1, ..., p)
as KC and KA , respectively. Then, based upon the result of Proposition
1 presented in Supplement A, Theorem 3.1 shows the uniform convergence
rates of PEBLLEs of varying-coefficient component functions.
Theorem 3.1. Under Assumption (A1) – (A6) and (A9), if KC KA =


−r+1/2
o nN h4C and KA
+ KC−r = o h2C , then we obtain that
sup |α̂0l (t) − α0l (t)| = Op

p

−r
+
h2C + KA KC−r + KA

sup |α̂k (t) − αk (t)| = Op

p

−r
h2C + KA KC−r + KA
+

t∈(a,b)

t∈(a,b)

s

log n
n


1+

1
N̄H hC

!

,

s

log n
n


1+

1
N̄H hC

!

,

where l = 0, ..., q and k = 1, ..., p.
Remark 2. From Theorem 3.1, we notice that the variance term obtains a nonparametric rate of convergence log n/(nN̄H hC ) provided that
 1
1
N̄H /n 2r → 0 and KC ≍ nN̄H 2r+1 , where “a ≍ b” means that a and b
have the same order. On the other hand, a parametric rate of convergence
1
1
1
is implied if N̄H /n 2r → C (0 < C < ∞) and KC ≍ n 2r or N̄H /n 2r → ∞
1
and KC = o(n 2r ).
Remark 3. Similar to [47], we split data into sparse, dense or ultra
1
dense according to the ratio N̄H /n 2r tends to 0, a nonzero constant or ∞ as
n → ∞. In fact, we give a more general method of partitioning data in the
sense that the same split with [47] is used if r = 2.
Let α (t) = {α00 (t) , α01 (t) , ..., α0q (t) , α1 (t) ..., αp (t)}τ , and α̂ (t) the
PEBLLE of α (t). Furthermore, we introduced the following symbols:
Fij =

τ
τ τ
τ
τ
Z ,β
with β ij = {β1 (Xij1 ) , ..., βp (Xijp )} , Ξ (t) = E Fij Fij |Tij =
 ij ij

t := [v1 (t) v2 (t)] and G (t, t) = limt′ →t G (t, t′ ) with G (t, t′ ) = E Fij Fτij ′ |Tij =

R
R
t, Tij ′ R= t′ . In addition, Rwe define κ = K 2 (v) dv, κ2 = v 2 K (v) dv,
κ4 = v 4 K (v) dv, κ22 = v 2 K 2 (v) dv, and g ′′ denotes the second derivative of function g.
Theorem 3.2 presents a unified asymptotic normality of α̂ (t), which can
be applied to sparse, dense and ultra dense cases of the data.

9

UNIFIED STATISTICAL INFERENCE

Theorem 3.2.
max

n

1

n3 h2C

Pn

Under the assumption of (A1) – (A9), if

1
1
i=1 m2i , n3 hC

h

Pn

Pn 
(mi − 1) , n13 i=1 1 −
i3/2

+ n1 1 − N̄1H

1
i=1 m2i

1
nN̄H hC

1
mi



1−

2
mi

o

holds. Then, for any an interior t in (a, b), we obtain the asymptotic distribution of α̂(t) as below:
 D
(t) α̂ (t) − α (t) − 12 h2C κ2 Ξ−1 (t) ρ1 (t) −
→ N (0, Ip+q+1 ) ,
P
P
where ρ1 (t) = ql=0 α′′0l (t) v1l (t) + pk=0 α′′k (t) v2k (t) with v1l (t) being the
lth column of v1 (t) and v2k (t) being the kth column of v2 (t), and


1
1
κ
1−
Σ1,S (t) +
ΓC (t) =
Σ1,D (t)
n
nN̄H hC fT (t)
N̄H

with Σ1,S = Ξ−1 (t) γ (t, t) + σ 2 (t) and Σ1,D = Ξ−1 (t) γ (t, t) G (t, t) Ξ−1 (t).

(3.1)

−1/2

ΓC

According to the method of partitioning data defined in Remark 3 and
(3.1), Corollary 1 lists the asymptotic distributions for sparse, dense and
ultra dense cases of the data as follows.
Corollary 1. Suppose that the conditions of Theorem 3.2 hold and t
is a fixed interior point on the interval (a, b).
−1/(2r+1)
1
, then
(i) Sparsity Case (N̄H /n 2r → 0). If hC ≍ nN̄H
(3.2)

q
 D
nN̄H hC fT (t) α̂ (t) − α (t) − 12 h2C κ2 Ξ−1 (t) ρ1 (t) −→ N (0, κΣ1,S ) .


1
(ii) Dense Case (N̄H /n 2r → C1 < ∞). If hC = O n−1/(2r) , then
(3.3)

 D
√
n α̂ (t) − α (t) − 12 h2C κ2 Ξ−1 (t) ρ1 (t) −→ N 0,


κ
Σ1,S + Σ1,D .
fT (t)C1


1
(iii) Ultra Dense Case (N̄H /n 2r → ∞). If hC = o n−1/(2r) , then
(3.4)

 D
√
n α̂ (t) − α (t) − 21 h2C κ2 Ξ−1 (t) ρ1 (t) −→ N (0, Σ1,D ) .

Let Ξ̂−1 (t), ρ̂1 (t), γ̂ (t, t), σ̂ 2 (t), fˆT (t), Ĝ (t, t), v̂1l (t) and v̂2l (t) are
kernel smoothing of Ξ−1 (t), ρ1 (t) , γ (t, t), σ 2 (t), fT (t), G (t, t), v1l (t)
and v2l (t). Then, the naive consistent estimators of asymptotic bias ρ1 (t)

10

LIXIA HU, TAO HUANG AND JINHONG YOU

P
and
variance ΓC (t) are given by ρ̂1 (t) = ql=0 α̂′′0l (t) v̂1l (t) +
Pp asymptotic
′′
k=1 α̂k (t) v̂2k (t) and


1
1
κ
Σ̂1,D (t) ,
Σ̂1,S (t) +
1−
Γ̂C (t) =
n
N̄H
nN̄H ĥC fˆT (t)

where Σ̂1,S = Ξ̂−1 (t) γ̂ (t, t) + σ̂ 2 (t) and Σ̂1,D = Ξ̂−1 (t) γ̂ (t, t) Ĝ (t, t) Ξ̂−1 (t).
Based upon (3.1), we can construct a (1 − α) % confidence interval of
varying-coefficient component functions as below




1/2
α̂0l (t) − 12 h2C κ2 Ξ̂−1 (t) ρ̂1 (t)
± z1−α/2 Γ̂C (t)
,
l+1
l+1,l+1




(3.5)
1/2
± z1−α/2 Γ̂C (t)
,
α̂k (t) − 21 h2C κ2 Ξ̂−1 (t) ρ̂1 (t)
q+1+k

q+k+1,q+k+1

where z1−α/2 is the 1−α/2 standard normal quantile, the subscript k denotes
the k-th element of involved vector, and the subscript (k, k) means the k-th
diagonal element of a given matrix. Note that (3.5) is a unified confidence
interval suitable for sparse, dense and ultra dense cases of the data.
3.2. Asymptotic Properties of Additive Component Functions. In this
subsection, we focus on the asymptotic results of PEBLLE of additive component functions. Theorem 3.3 gives the uniform rates of convergence of
β̂k .
Theorem
3.3. Suppose that (A1) – (A6) and (A9) hold. If KC KA =

−r
+ KC−r = o h2C , and x is any interior in Sk , then
o nN h4C and KA
supx∈Sk |β̂k (x) − βk (x) | is bounded by
Op

h2A + h2C +

p


−r

KA KC−r + KA

+

s

log n
n



1
1+
N̄H hA

!

.






Denote µk = E α2k (Tij ) , ψk,1 = Eα2k (Tij ) γ (Tij , Tij ) + σ 2 (Tij ) and
ψk,2 = E αk (Tij ) αk Tij ′ γ Tij , Tij ′ . Theorem 3.4 presents the asymptotic normality of β̂k on a unified formwork for different types of data.
Theorem 3.4.
max

n

1
n3 h2A

Pn

Under the condition (A1) – (A9), if hC = o (hA ) and

1
1
i=1 m2i , n3 hA

h

Pn

Pn 
(mi − 1) , n13 i=1 1 −

i3/2
+ n1 1 − N̄1H

1
i=1 m2i

1
nN̄H hA

1
mi



1−

2
mi

o

11

UNIFIED STATISTICAL INFERENCE

hold. Then, for any an interior x in Sk , we have


D
−1/2
→ N (0, 1) ,
(3.6)
ΓA (x) β̂k (x) − βk (x) − 12 βk′′ (x) h2A κ2 /µk −
where ΓA,k (x) =

κψk,1
nN̄H hA fX (x)
k

+

1
n


1−

1
N̄H



ψk,2
.
µ2k

As a corollary, we get different asymptotic results for sparse, dense and
ultra dense data.
Corollary 2. Suppose that the conditions of Theorem 3.4 hold and x
is a fixed interior point in Sk .
− 1
(i) Sparsity Case. If hA ≍ nN̄H 2r+1 , then it follows that
(3.7)
q


D
nN̄H hA fXk (x) β̂k (x) − βk (x) − 12 βk′′ (x) h2A κ2 /µk −→ N (0, κψk,1 ) .

 1
(ii) Dense Case. If hA = O n− 2r , then

(3.8)


√ 
D
2
1 ′′
n β̂k (x) − βk (x) − 2 βk (x) hA κ2 /µk −→ N 0,

κψk,1
ψk,2
+ 2
fXk (x) C1
µk



.

 1
(iii) Ultra Dense Case. If hA = o n− 2r , then
(3.9)



√ 
D
n β̂k (x) − βk (x) − 21 βk′′ (x) h2A κ2 /µk −→ N 0, ψk,2 /µ2k .

Let µ̂k , fˆXk (x) and ψ̂k,j , j = 1, 2 be consistent estimators of µk , fXk (x)
and ψk,j . Then, the asymptotic variance ΓA (x) can be consistently estimated
by
κψ̂k,1
1  ψ̂k,2
1
1−
+
,
Γ̂A (x) =
N̄H µ̂2k
nN̄H ĥA fˆX (x) n
k

which gives a (1 − α)% pointwise confidence interval of βk in a unified forms
for sparse, dense and ultra dense data. That is,
(3.10)

−1/2

β̂k (x) − 21 βk′′ (x)h2A κ2 /µ̂k ± z1−α/2 Γ̂A

(x).

4. Testing of Model Specification. For the sake of parsimony, it
is essential to test time-varying property of varying-coefficient component
functions and to test linearity of additive component functions.

12

LIXIA HU, TAO HUANG AND JINHONG YOU

4.1. Time-varying Testing of Varying-coefficient Component Functions.
In this subsection, we propose a consistent testing to judge whether the
varying-coefficient component functions are really time-varying or not. It is
a problem of model selection between a general Semi-VCAM and a submodel
PLAM or an AM in the practical applications.
We denote δij = νi (Tij ) + εij in Semi-VCAM (1.2), and consider a mixedeffect nonparametric model Yij = m (Tij , Zij , Xij ) + δij , where m (t, z, x) =
E [Yij |Tij = t, Zij = z, Xij = x]. The time-varying testing postulates m as
τ

m (t, z, x) = z a0 +

p
X

ak βk (xk ) := g0 (z, x; a, β (x))

k=1

under null hypothesis H0,C , where a = (aτ0 , a1 , ..., ak )τ is a unknown constant
vector, and β (x) = (β1 (x1 ), ..., βp (xp ))τ . Whilst under alternative hypothesis H1,C , m is the regression function of Semi-VCAM (1.2), denoted as
g (t, z, x; α (t) , β (x)). Then, the interested hypothesis is given as below
(4.1)

H0,C : m (t, z, x) = g0 (t, z, x; α, β (x)) a.s.
↔ H1,C : m (t, z, x) = g (t, z, x; α (t) , β (x)) a.s.

Under H0,C , we replace βk (x) with PEBLLE β̂k (x), and obtain the parametric estimator of vector a as follows
!−1 n
n
X
X
τ
(4.2)
ã =
Ŝi Ŝi
Ŝi Yi ,
i=1

i=1

τ
where Ŝi = (Ŝi1 , ..., Ŝimi )τ with Ŝij = Zτij , β̂1 (Xij1 ), ..., β̂p (Xijp ) , and
Yi = (Yi1 , ..., Yimi )τ .
For the i-th subject and the j-th subject, we introduce the weight ma(l,v) 
(l,v)
trix Wij = wij m ×m , where wij = khC (Til , Tjv ) KhA (Xil , Xjv ), with
i
j

and Kh (x1 , x2 ) = Πpi=1 kh (x1i , x2i ) for xk = (xk1 , ..., xkp ),
kh (t, z) = k t−z
h
k = 1, 2. Let êij = Yij − g0 (Tij , Zij , Xij ; ã, β̂ (Xij )), and we propose a testing
statistic based upon the quadratic form of residuals as follows
n

(4.3)

Jˆn =

n

XX
1
êτi Wij êj ,
2
2
n N̄H |H| i=1
j6=i

where êi = (êi1 , ..., êimi )τ and |H| = hC hpA .
Furthermore, we assumes additional conditions as follows.

13

UNIFIED STATISTICAL INFERENCE

P
(T1) limn→∞ n1 ni=1 E [Si Siτ ] = Ω, and kΩkF is bounded away from zero
and infinity, where Si is the analogue of Ŝi after β̂k being replaced by
βk , and k·kF is the
p involved matrix.
pFrobenius norm of the
(T2) N̄H2 |H| → 0, nN̄H |H| → ∞ and nN̄H |H|h4A → 0.
P
Let N̄2 = n1 ni=1 m2i , Theorem 4.1 and 4.2 present the asymptotic distribution of the proposed test statistic Jˆn under H0,C and H1,C , respectively.
Theorem 4.1.
holds that

under H0,C , where

Under Assumption (A1) – (A8) and (T1) – (T2), it
p
n2 N̄H2
D
p
|H|Jˆn /σ̂1 −
→ N (0, 1)
2
N − nN̄2
n

σ̂12

n

m

mj

i X


XXX
1
(l,v) 2
ê2il ê2jv wij
= 2
n N̄H |H| i=1
v=1

j6=i l=1

2

2

n N̄
is a consistent estimator of the asymptotic variance of √ 2 H

i.e.,

N −nN̄2



σ12 = κp+1 E {γ (T, T ) + σ 2 (T )}2 fT (T ) Πpk=1 E [fk (Xk )] .

p

|H|Jˆn ,

Theorem
conditions of Theorem 4.1, If H1,C holds, then
p 4.2. Under the

ˆ
P r nN̄H |H|Jn /σ̂1 ≥ Mn → 1 as n → ∞, where Mn is any non-stochastic
p 
positive sequence such that Mn = o nN̄H |H| .

4.2. Linearity Testing of Additive Component Functions. In this subsection, we check whether each additive component function in Semi-VCAM
(1.2) reduces to a linear form, which
Pyields a more parsimonious VCM.
Let h0 (t, z, x; α(t)) = zτ α0 (t) + pk=1 αk (t)xk . It is expected to test
(4.4)

H0,A : m (t, z, x) = h0 (t, z, x; α (t)) a.s.

↔ H1,A : m (t, z, x) = g (t, z, x; α (t) , β (x)) a.s.

Denote α̃ (t) as the LLE of α (t) under null hypothesis H0,A . Then, the
testing statistics is given by
n

(4.5)

Iˆn =

n

XX
1
ςˆτi Wij ςˆj ,
n2 N̄H2 |H| i=1
j6=i

where ςˆi = (ˆ
ςi1 , ..., ςˆimi )τ with ςˆij = Yij − h0 (Tij , Zij , Xij ; α̃ (Tij )). The
asymptotic distributions of Iˆn under H0,A and H1,A are presented in the
following two theorems.

14

LIXIA HU, TAO HUANG AND JINHONG YOU

Under the conditions of Theorem 4.1, it follows that

Theorem 4.3.

n2 N̄H2
p

under H0,A .

N2

− nN̄2

p

D

→ N (0, 1)
|H|Iˆn /σ̂1 −

Theorem 4.4. Suppose that
p the conditions of Theorem 4.1 holds. Then
under H1,A , we have P r(nN̄H |H|Iˆn /σ̂1 ≥ En ) → 1 as n → p
∞, where En
is any non-stochastic positive sequence such that En = o(nN̄H |H|).
5. Implementation. In this section, we address the practical issues
that arise in the newly-proposed methodologies.
• B-spline method of pilot estimation
As a common practice in spline smoothing, we predetermine the order of
the B-spline functions and then select optimal interior knots number through
BIC criterion
BIC (KC , KA ) = log (RSS) + N log n/n,
2

p
i
τ
τ
where RSS = n1 ni=1 m1i m
k=1 γk Tk (Tij , Xijk )]
j=1 [Yij − γ 0 Zij ⊗ bC (Tij ) −
and N = (q + 1) JC + pJC JA , with JC and JA being the dimension of Bspline basis space bC (t) and Bk,A (xk ). Then the optimal interior knots
number is given by (K̂C , K̂A ) = arg min BIC (KC , KA ).

P

P

P

• LLE based on pilot estimation
In local linear
smoothing, we use Epanechnikov kernel function k (u) =

2
0.75 1 − u I|u|≤1 , and select the optimal bandwidths using “leave-one-out”
cross-validation procedure suggested by [33]. Define the subject-based crossvalidation (CV) criterion as below
"
#2
p
mi
n
X
X
1 X
τ
CV (hC , hA ) =
Yij − Zij α̂0,−i (Tij ) −
α̂k,−i (Tij ) β̂k,−i (Xijk ) ,
mi
i=1

j=1

k=1

where the subscript “−i” represents the estimator using the data with all
repeated measurements except the ith subject. The optimal bandwidth is
the unique minimizer of CV(hC , hA ).

15

UNIFIED STATISTICAL INFERENCE

In simulation studies, we also can use the average squared error (ASE) as
follows
p
mi h
n
X
X
1 X
τ
Zij (α0 (Tij ) − α̂0 (Tij )) +
αk (Tij ) βk (Xijk )
ASE (hC , hA ) =
mi
i=1

j=1

k=1

−

(5.1)

p
X
k=1

α̂k (Tij ) β̂k (Xijk )

i2

.

Similar to Remark 2.3 of [40], it is not difficult to show that the CV bandwidths approximately minimize ASE.
6. Numerical Studies.
6.1. Simulation Studies. In this subsection, we consider simulation examples to investigate the finite-sample performance of the proposed estimation method in Section 2 and the testing procedure in Section 4.
Example 1. Here we consider a mixed-effects Semi-VCAM. Let Tij are
uniformly distributed on [0, 1], Zij are i.i.d. Bernoulli random variable with
the probability of success p = 0.5, and
 Xij = Ui (1 + Tij ) + ϑij , where
Ui ∼ U (−0.4, 0.4) and ϑij ∼ N 0, 0.22 . The response Yij is generated by a
mixed-effects Semi-VCAM as below
Yij = α00 (Tij ) + α01 (Tij ) Zij + α1 (Tij ) β1 (Xij ) + νi (Tij ) + εij ,
for i = 1, ..., n and j = 1, ..., m, where the measurement error εij are i.i.d
from N (0, 1), and √
the subject-specific random trajectory νi (Tij ) = ηi1 +
√
2ηi2 sin (2πTij ) + 2ηi3 cos (2πTij ) with ηij ∼ N (0, wj ) for j = 1, 2, 3 and
(w1 , w2 , w3 ) = (0.6, 0.2, 0.2). The univariate smooth component functions
are given by α00 (t) = 6t, α01 (t) = 2.5 cos (2πt), α1 (t) = R 1t(1−t) and
0

t(1−t)dt

β (x) = 4.5 sin (0.4πx) − E [4.5 sin (0.4πX)].
We select 20 equally-spaced points on the range of Tij and Xij , and define
the mean prediction integrated squared error (MPISE) based on Q replications,
Q Z
i2
1 X hˆ
fq (u) − f (u) du,
MPISE (f ) =
Q q=1
where fˆq is the PEBLLE of the estimated function f in the q-th replication.
Under different combinations of n and m, based upon Q = 300 Monte Carlo
replications, Table 1 gives the MPISEs of PEBLLE of component functions,

16

LIXIA HU, TAO HUANG AND JINHONG YOU

and the standard deviation is shown in parentheses. We also list the optimal
bandwidths according to (5.1). The result exhibits a good finite-sample performance whatever the data is sparse or dense. It is also found that MPISEs
decrease markedly as the total observations increase.
Table 1
The MPISEs(standard deviation in parentheses) of component functions in Example 1.
n

50

100

m

ĥC

ĥA

5

0.1763

0.4132

10

0.1600

0.3950

30

0.1447

0.3500

50

0.1237

0.3395

100

0.1132

0.2921

10

0.1553

0.3553

30

0.1500

0.2831

60

0.1111

0.2278

100

0.0550

0.2200

150

0.0556

0.1778

α̂00
0.0880

α̂01
0.1794

α̂1
0.0048

β̂
0.1529

(0.0605)

(0.1129)

(0.0028)

(0.1122)

0.0603

0.0986

0.0028

0.0957

(0.0400)

(0.0585)

(0.0016)

(0.0646)

0.0278

0.0439

0.0019

0.0821

(0.0194)

(0.0245)

(0.0012)

(0.0574)

0.0276

0.0278

0.0016

0.0662

(0.0193)

(0.0137)

(0.0010)

(0.0516)

0.0264

0.0182

0.0014

0.0641

(0.0263)

(0.0092)

(0.0010)

(0.0441)

0.0311

0.0655

0.0023

0.0657

(0.0200)

(0.0369)

(0.0013)

(0.0395)

0.0193

0.0318

0.0016

0.0597

(0.0153)

(0.0129)

(0.0009)

(0.0405)

0.0174

0.0170

0.0009

0.0553

(0.0147)

(0.0075)

(0.0008)

(0.0443)

0.0157

0.0088

0.0006

0.0365

(0.0110)

(0.0033)

(0.0004)

(0.0284)

0.0144

0.0063

0.0006

0.0275

(0.0013)

(0.0026)

(0.0006)

(0.0180)

Figure 1 visualizes the PEBLLE for (n, m) = (100, 10). The solid curve
plots true component function, the dashed line figures the PEBLLE, and
the dash-dotted lines give 95% confidence bands based on the asymptotic
distribution. The figure shows that our estimator is close to the true function
even under the medium total observations N = 1000.
We also investigate the performance of asymptotic distribution given in
Theorems 3.2 and 3.4. After doing 300 Monte Carlo replications, we compare
the average empirical coverage percentages (AECPs) based on four methods,
that is, the unified method (U) given in (3.1) and (3.6), sparse method (S) in
(3.2) and (3.7), dense method (D) in (3.3) and (3.8), and ultra dense method
(UD) in (3.4) and (3.9). We take n = 50, 100 and m = 5, 10, 30, 80, 200.
Table 2 and 3 list the AECPs and the average empirical length (AEL) of
confidence interval under the significance level 90% and 95%, respectively.
From the resultant tables, we make a conclusion that:

17

6

3

5

2

4

1

α01

α00

UNIFIED STATISTICAL INFERENCE

3

2

0

-1

1

-2

0

-3
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

0

0.1

0.2

0.3

0.4

t

0.5

0.6

0.7

0.8

0.9

1

t

(a) Estimation of α00 (t)

(b) Estimation of α01 (t)
6

1.6
4

1.4
1.2

2

β1

α1

1
0.8
0.6

0

-2

0.4
-4
0.2
0

-6
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

-1.5

-1

-0.5

0

0.5

1

t

x

(c) Estimation of α1 (t)

(d) Estimation of β1 (x)

1.5

Fig 1. Estimation of component functions in Example 1. The solid curve represents the
true function, and the dashed line plots the PEBLLE, and the dash-dotted lines gives the
95% pointwise confidence bands based on (3.5) and (3.10).

(1) the AECPs of unified method (bold tags in tables) are superior to the
other three methods, whatever the data is sparse, dense or ultra dense;
(2) the AECPs of sparse method decrease as m grows, and they are inferior
to the unified method even for sparse data;
(3) the AECPs of dense and ultra dense method increase as m grows, and
they are comparable to that of the unified method.
Example 2. Now we investigate the performance of hypothesis testing
constructed in Section 4. To this end, we consider the following two DGP:
• DGP I: In this case, we test the time-varying property of varyingcoefficient component functions, that is to decide whether a PLAM
is sufficient. We take the same settings with Example 1 for Tij , Xij ,
Zij , εij , νi and β1 (x). The time-varying testing of conditional mean
function m (t, z, x) is as follows
(6.1)

H0 : m (t, z, x) = g0 (z, x) a.s. ↔ H1 : m (t, z, x) = g1 (t, z, x) a.s.,

18

LIXIA HU, TAO HUANG AND JINHONG YOU

Table 2
The AECPs and AELs (in parentheses) of four methods with level 90% in Example 1.
m

Fun
α00
α01

5
α1
β1
α00
α01
10
α1
β1
α00
α01
30
α1
β1
α00
α01
80
α1
β1
α00
α01
200
α1
β1

n = 50
U(%)

S(%)

D(%)

n = 100
UD(%)

U(%)

S(%)

D(%)

UD(%)

87.63

80.98

80.93

64.08

88.63

83.97

81.05

60.80

(0.9016)

(0.7539)

(0.7671)

(0.5309)

(0.7384)

(0.6467)

(0.6142)

(0.3958)

86.57

79.32

79.22

62.23

86.83

81.52

78.63

57.37

(1.2580)

(1.0501)

(1.0721)

(0.7443)

(1.0919)

(0.9576)

(0.9068)

(0.5814)

86.08

79.00

79.52

64.42

87.82

85.80

81.17

58.14

(0.3500)

(0.2909)

(0.2994)

(0.2092)

(0.3007)

(0.2626)

(0.2508)

(0.6510)

87.53

85.67

81.68

44.95

88.02

86.48

84.88

38.95

(1.0994)

(1.0530)

(0.9188)

(0.3071)

(1.0756)

(1.0301)

(0.9057)

(0.2154)

88.40

72.55

85.88

77.98

88.48

74.90

84.88

75.50

(0.7374)

(0.4958)

(0.6884)

(0.5648)

(0.5533)

(0.3873)

(0.5049)

(0.4048)

86.63

68.90

83.28

73.93

87.20

70.90

82.95

72.35

(1.0573)

(0.7118)

(0.9868)

(0.8088)

(0.7926)

(0.5556)

(0.7229)

(0.5788)

88.00

71.70

85.35

76.75

88.15

74.65

84.85

75.08

(0.2770)

(0.1871)

(0.2584)

(0.2114)

(0.2057)

(0.1435)

(0.1880)

(0.1512)

88.25

84.43

81.15

52.58

88.68

83.58

85.25

60.63

(0.8836)

(0.8200)

(0.7146)

(0.3007)

(0.4573)

(0.3999)

(0.4129)

(0.2228)

88.90

50.65

88.20

84.35

89.58

53.10

89.25

85.53

(0.6279)

(0.2601)

(0.6218)

(0.5762)

(0.4638)

(0.1965)

(0.4611)

(0.4235)

88.15

47.75

87.75

84.20

88.63

46.37

88.37

84.10

(0.8892)

(0.3691)

(0.8805)

(0.8156)

(0.6545)

(0.2773)

(0.6506)

(0.5975)

88.05

52.70

87.40

85.20

88.82

54.35

88.47

85.75

(0.2374)

(0.0984)

(0.2352)

(0.2180)

(0.1688)

(0.0715)

(0.1678)

(0.1542)

88.50

71.65

85.60

77.85

88.63

72.62

84.85

75.30

(0.4139)

(0.2755)

(0.3775)

(0.3110)

(0.3014)

(0.2089)

(0.2761)

(0.2190)

89.01

39.67

88.42

87.16

89.61

38.70

88.88

87.85

(0.5937)

(0.1793)

(0.5851)

(0.5667)

(0.4408)

(0.1309)

(0.4365)

(0.4203)

89.49

38.71

89.07

87.93

89.87

35.09

89.56

89.11

(0.8367)

(0.2523)

(0.8248)

(0.7988)

(0.6178)

(0.1835)

(0.6118)

(0.5891)

88.71

41.89

88.13

87.07

88.90

40.00

88.41

87.63

(0.2198)

(0.0662)

(0.2167)

(0.2098)

(0.1593)

(0.0475)

(0.1578)

(0.1519)

88.91

55.58

88.20

85.93

89.40

53.54

88.70

86.72

(0.3471)

(0.1583)

(0.3315)

(0.3105)

(0.2444)

(0.1080)

(0.2390)

(0.2204)

89.50

28.40

89.20

89.05

89.75

32.45

89.55

89.30

(0.5926)

(0.1166)

(0.5849)

(0.5618)

(0.4192)

(0.0979)

(0.4072)

(0.4097)

89.47

34.73

89.25

89.13

89.60

34.80

89.55

89.25

(0.8311)

(0.1636)

(0.8238)

(0.7959)

(0.6050)

(0.1376)

(0.5968)

(0.5539)

89.20

29.93

88.90

88.70

89.65

36.35

89.30

89.05

(0.2069)

(0.0406)

(0.2056)

(0.2032)

(0.1419)

(0.0368)

(0.1412)

(0.1384)

89.60

38.60

89.13

89.04

89.80

43.15

89.35

89.20

(0.3219)

(0.0986)

(0.3163)

(0.3072)

(0.2358)

(0.0917)

(0.2111)

(0.2003)

19

UNIFIED STATISTICAL INFERENCE

Table 3
The AECPs and AELs (in parentheses) of of four methods with level 95% in Example 1.
m

Fun
α00
α01

5
α1
β1
α00
α01
10
α1
β1
α00
α01
30
α1
β1
α00
α01
80
α1
β1
α00
α01
200
α1
β1

n = 50
U(%)

S(%)

D(%)

n = 100
UD(%)

U(%)

S(%)

D(%)

UD(%)

93.15

88.93

88.23

72.70

93.68

90.45

88.50

69.23

(1.0818)

(0.9006)

(0.9160)

(0.6467)

(0.8599)

(0.7479)

(0.7303)

(0.4270)

92.68

87.73

87.03

70.88

93.08

88.22

86.12

66.52

(1.5106)

(1.2561)

(1.2804)

(0.9062)

(1.2863)

(1.1242)

(1.0779)

(0.6945)

91.60

87.12

85.92

71.92

93.12

90.10

87.65

70.23

(0.4249)

(0.3520)

(0.3613)

(0.2573)

(0.3540)

(0.3082)

(0.2979)

(0.1945)

92.30

91.00

87.95

52.08

93.30

92.25

90.18

43.37

(1.2933)

(1.2373)

(1.0916)

(0.3655)

(0.9537)

(0.9195)

(0.8595)

(0.2563)

93.50

81.28

89.93

82.13

94.13

85.53

89.35

81.13

(0.9012)

(0.6247)

(0.8171)

(0.6706)

(0.6933)

(0.5056)

(0.6030)

(0.4853)

93.50

82.28

89.98

82.40

93.90

86.60

90.65

82.18

(1.2926)

(0.8966)

(1.1718)

(0.9611)

(0.9955)

(0.7274)

(0.8649)

(0.6946)

93.15

82.48

90.40

82.73

93.23

84.05

88.58

80.50

(0.3390)

(0.2357)

(0.3072)

(0.2516)

(0.2561)

(0.1862)

(0.2232)

(0.1801)

93.63

90.15

87.68

60.20

94.33

90.53

92.43

70.48

(0.9368)

(0.8567)

(0.7700)

(0.3599)

(0.5288)

(0.4582)

(0.4908)

(0.2658)

93.88

68.25

92.12

89.30

94.15

64.30

94.00

90.75

(0.7657)

(0.3638)

(0.7305)

(0.6761)

(0.5495)

(0.2506)

(0.5376)

(0.4906)

93.90

67.45

92.90

90.20

94.05

59.25

93.05

90.05

(1.0900)

(0.5187)

(1.0402)

(0.9621)

(0.7753)

(0.3535)

(0.7585)

(0.6922)

93.80

72.90

92.05

89.75

94.20

68.75

93.15

89.95

(0.2952)

(0.1404)

(0.2818)

(0.2605)

(0.2012)

(0.0916)

(0.1969)

(0.1798)

94.10

81.00

92.20

86.00

94.55

82.05

92.45

83.85

(0.4793)

(0.3082)

(0.4438)

(0.3708)

(0.3590)

(0.2498)

(0.3256)

(0.2602)

94.45

45.35

93.80

92.80

94.60

49.25

93.30

92.05

(0.7298)

(0.2136)

(0.7207)

(0.6933)

(0.5183)

(0.1602)

(0.5107)

(0.4924)

94.25

52.80

94.20

93.80

94.75

51.40

94.35

93.70

(1.0268)

(0.3003)

(1.0141)

(0.9440)

(0.7273)

(0.2250)

(0.7165)

(0.6908)

94.10

51.70

92.75

91.65

94.65

52.90

93.05

91.85

(0.2635)

(0.0769)

(0.2602)

(0.2525)

(0.1966)

(0.0609)

(0.1937)

(0.1867)

94.50

58.15

94.00

92.45

94.80

65.40

94.00

93.15

(0.4093)

(0.1845)

(0.3938)

(0.3674)

(0.2902)

(0.1313)

(0.2805)

(0.2601)

94.50

30.95

94.30

94.10

94.85

34.25

94.65

94.45

(0.7169)

(0.1342)

(0.7132)

(0.6843)

(0.5122)

(0.1005)

(0.4998)

(0.4827)

94.80

39.65

94.40

94.25

94.95

40.70

94.85

94.40

(1.0003)

(0.1876)

(0.9950)

(0.9325)

(0.7217)

(0.1407)

(0.7083)

(0.6885)

94.35

35.20

94.15

94.00

94.75

41.45

94.55

94.30

(0.2517)

(0.0507)

(0.2503)

(0.2469)

(0.1842)

(0.0353)

(0.1834)

(0.1809)

94.75

47.40

94.30

94.15

94.85

47.35

94.60

94.35

(0.3838)

(0.1116)

(0.3778)

(0.3580)

(0.2712)

(0.0809)

(0.2683)

(0.2595)

20

LIXIA HU, TAO HUANG AND JINHONG YOU

where g0 (z, x) = 6 + 2.5z + β1 (x) and
g1 (t, z, x) = g0 (z, x) + θ (t + z cos (2πt) + t (1 − t) β1 (x)) ,
with θ = 0.2, 0.4, 0.6, 0.8, 1.0.
• DGP II: Here we consider the linearity testing of additive component
functions to judge whether a VCM is sufficient. Let Tij , Zij , α00 (t)
R1
and α01 (t) be given in Example 1, α1 (t) = sin (πt)/ 0 sin (πt)dt, and
Xij = Ui (1 + Tij ) + ϑij , where Ui ∼ U (−0.5, 0.5) and ϑij ∼ N (0, 1).
The interested hypothesis is given by
(6.2) H0 : m (t, z, x) = h0 (t, z, x) a.s. ↔ H1 : m (t, z, x) = h1 (t, z, x) a.s.,

where h0 (t, z, x) = α00 (t) + α01 (t) z + α1 (t) x and h1 (t, z, x) =
h0 (t, z, x) + 1.5θα1 (t) sin (πx) with θ = 0.2, 0.4, 0.6, 0.8, 1.0.
We consider different combinations of n = 30, 50, 100 and m = 5, 10, 30,
60, 100, and generate Q = 300 Monte Carlo replications and B = 300 bootstrap samples for each simulated data set. Under 5% and 10% significance
levels, based upon bootstrap critical value, Table 4 and 5 present power of
hypothesis (6.1) and (6.2) for different deviation parameters θ ranging from
0 to 1 with the span of 0.2, respectively. The results show that the proposed
testing procedure all performs well for sparse, dense and dense data. In fact,
the power for θ = 0 is size of hypothesis, which is close to the theoretical
significance level 0.05 or 0.1. As expected, the power increases to one as θ
ascends whatever significance levels and sampling plans. Moreover, Figures
2 and 3 plot the rejection rates of testing (6.1) and (6.2) at the 5% and 10%
significance levels for some combinations of n and m, respectively.
6.2. Real Data Analysis.
Example 3. Now we apply our method to the new coronavirus disease (COVID-19) mentioned in Section 1. We collected the daily cumulative confirmed cases (Zi,t ) and the daily cumulative cured cases from
https://github.com/CSSEGISandData/COVID-19, the daily movement population from Wuhan to other provinces (https://qianxi.baidu.com/), the
maximum daily temperature (http://www.weather.com.cn) and the population data (https://zh.wikipedia.org/wiki/).
The response variable GRCC, denoted by Yi,t , is measured by log (Zi,t ) −
log (Zi,t−1 ), which is presented in Figure 4 (a) for 29 provinces in China from
January 23th to April 8th. We notice that the big values of GRCC (above
0.5) mainly concentrate on the period from January 23th to February 3th.

21

UNIFIED STATISTICAL INFERENCE

Table 4
Power of testing (6.1) under confidence level α = 5% and 10%.
α

5%

10%

(n, m)

θ
0
0.2
0.4
0.6
0.8
1.0
0
0.2
0.4
0.6
0.8
1.0

(50,5)

(50,10)

(100,5)

(100,10)

(50,30)

(30,60)

(30,100)

0.067
0.233
0.500
0.830
0.970
0.997
0.113
0.333
0.610
0.857
0.980
1.000

0.055
0.300
0.690
0.955
1.000
1.000
0.095
0.410
0.755
0.965
1.000
1.000

0.050
0.265
0.725
0.985
1.000
1.000
0.095
0.360
0.815
0.990
1.000
1.000

0.040
0.370
0.885
1.000
1.000
1.000
0.085
0.505
0.930
1.000
1.000
1.000

0.055
0.270
0.875
1.000
1.000
1.000
0.100
0.345
0.920
1.000
1.000
1.000

0.060
0.225
0.710
0.995
1.000
1.000
0.085
0.290
0.765
0.995
1.000
1.000

0.050
0.230
0.770
1.000
1.000
1.000
0.090
0.240
0.810
1.000
1.000
1.000

Table 5
Size and power of test (6.2) under confidence level α = 5% and 10%.
α

5%

10%

(n, m)

θ
0
0.2
0.4
0.6
0.8
1.0
0
0.2
0.4
0.6
0.8
1.0

(50,5)

(50,10)

(100,5)

(100,10)

(50,30)

(30,60)

(30,100)

0.047
0.107
0.203
0.653
0.920
0.997
0.080
0.157
0.303
0.740
0.947
0.997

0.057
0.120
0.557
0.983
1.000
1.000
0.083
0.197
0.670
0.990
1.000
1.000

0.050
0.173
0.477
0.937
1.000
1.000
0.083
0.250
0.610
0.967
1.000
1.000

0.045
0.205
0.825
1.000
1.000
1.000
0.090
0.350
0.925
1.000
1.000
1.000

0.040
0.200
0.907
1.000
1.000
1.000
0.0933
0.327
0.933
1.000
1.000
1.000

0.045
0.200
0.850
0.990
1.000
1.000
0.090
0.360
0.930
1.000
1.000
1.000

0.060
0.180
0.807
0.993
1.000
1.000
0.100
0.260
0.873
1.000
1.000
1.000

22

LIXIA HU, TAO HUANG AND JINHONG YOU
1

1

α=0.05
α=0.10

0.9

1

α=0.05
α=0.10

0.9
0.8

0.8

0.7

0.7

0.7

0.6

0.6

0.6

0.5

0.5

0.5

0.4

0.4

0.4

0.3

0.3

0.3

0.2

0.2

0.2

0.1

0.1

0

0.1
0

0
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

0

(a) Power for (n, m) = (50, 5)

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

0

1

(b) Power for (n, m) = (50, 30)

1.2

1

=0.05
=0.10

0.9

0.8

0.2

0.4

0.6

0.8

1

(c) Power for (n, m) = (30, 60)

1.4

1.4

1.2

1.2

1

1

0.8

0.8

0.6

0.6

0.4

0.4

0.2

0.2

0.8

0.6

0.4

0.2

0
-2

-1.5

-1

-0.5

0

0.5

1

1.5

2

2.5

′

(a ) Density for (n, m) = (50, 5)

0
-1.5

-1

-0.5

0

0.5

1

1.5

2

′

(b ) Density for (n, m) = (50, 30)

0
-1.5

-1

-0.5

0

0.5

1

1.5

2

′

(c ) Density for (n, m) = (30, 60)

Fig 2. Power of time-varying testing (6.1) in Example 2. For three combinations of n and
m, (a) -(c) figure power at the level α = 0.05 and 0.1; whist (a′ ) -(c′ ) give the simulated
density of standardized test statistics (thick black) and five bootstrap approximations (thin).

1

1

α=0.05
α=0.10

0.9

1

α=0.05
α=0.10

0.9
0.8

0.8

0.7

0.7

0.7

0.6

0.6

0.6

0.5

0.5

0.5

0.4

0.4

0.4

0.3

0.3

0.3

0.2

0.2

0.2

0.1

0.1

0

0.1

0
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

0

1

0

(a) Power for (n, m) = (100, 10)
1.4

α=0.05
α=0.10

0.9

0.8

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

0

(b) Power for (n, m) = (50, 30)
2.5

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

(c) Power for (n, m) = (30, 100)
4
3.5

1.2
2

3

1

2.5

1.5

0.8

2
0.6

1

1.5

0.4

1
0.5

0.2

0
-1.5

′

0.5

-1

-0.5

0

0.5

1

1.5

2

(a ) Density for (n, m) = (100, 10)

0
-0.8

′

-0.6

-0.4

-0.2

0

0.2

0.4

0.6

0.8

1

(b ) Density for (n, m) = (50, 30)

0
-0.5

0

′

0.5

(c ) Density for (n, m) = (30, 100)

Fig 3. Power of linearity testing (6.2) in Example 2. For three combinations of n and
m, (a) -(c) figure power at the level α = 0.05 and 0.1; whist (a′ ) -(c′ ) give the simulated
density of standardized test statistics (thick black) and five bootstrap approximations (thin).

UNIFIED STATISTICAL INFERENCE

23

It is a strong evidence that the intervention policy of China’s government
plays a positive role in controlling the spread of Coronavirus disease.
To explore the influence factor of GRCC, we used five covariates: X1,it
being the movement population from Wuhan (MPFW), which is measured
by the proportion of the population moving from Wuhan to the ith province
out of moving out population at day t − 14; X2,it the daily cumulative
cured cases (CUCC) at day t − 1; X3,it the daily cumulative confirmed cases
(CFCC) at day t − 1; X4,it the maximum daily temperature at day t, and
X5,i the population of ith province.
We normalize the covariate X1,it , and make the logarithm transformation
for Xk,it , k = 2, 3 and X5,i . Based on 500 bootstrap sampling, we do the
time-varying testing (4.1) and linearity testing (4.4), obtaining the p values
0.028 and 0.038, respectively. Therefore, we reject the AM and VCM at
significant level 0.05, and adopt the general model as below:
(6.3)

Yit = α0 (t/T ) +

4
X

αk (t/T ) βk (Xk,it ) + α5 (t/T ) β5 (X5,i ) ,

k=1

where i = 1, ..., 29, t = 1, ..., T with T = 77. Figure 4 gives the PEBLLE
of component functions, and 95% pointwise confidence bands according to
(3.5) and (3.10).
From Figure 4, we conclude that the trend term α0 , varying-coefficient
function α1 for MPFW, α3 for CCFC and α4 for MDT have similar properties, i.e., they drop rapidly until about February 29th, and then maintain on
the level close to zero; α2 for CUCC decreases until about February 22th,
and increases until about March 9th, and thereafter levels near zero; α5 for
POP decreases slowly until about February 9th, then increases until about
February 29th, and decreases thereafter.
For the medium values of the normalized MPFW, the effect increases as
MPFW grows, and some fluctuations appears for the large value (above 2),
since large MPFW usually takes place in the early stage and the period of
work resumption. The influence of CUCC increases as it grows, and the rate
of increases become slower above 2; while the effect of CCFC ascends as
it increases, and levels out above 3. The effect of MDT drops under 0℃,
and increases until 10℃, and almost no influence between 10℃and 20℃,
then ascends rapidly above 20℃. The trend of effect of POP grows as the
population size ascends, especially when log-POP is larger than 7.5.
Example 4. We revisit a CD4 data from the Multicenter AIDS Cohort
Study, which contains 1817 observations from 283 homosexual men infected
with HIV between 1984 and 1991. [4, 15] have analyzed this data set using a

24

LIXIA HU, TAO HUANG AND JINHONG YOU

2

for MPFW

0.5

1.2

0.4

1

0.3

0.8
0.6

1

1

0.6

1.4

0.5

0.2

2

1.5

1.6

for CCUC

2.5

0.1

0.4

0

0.2

-0.1

0

-0.2

0
-0.2
01/23

02/02

02/12

02/22

03/03

03/13

03/23

04/02

04/12

-0.3
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

0.1

0.2

0.3

0.4

0.5

t

(a) GRCC

(c) α1

0.3

3

0.25

2

0.6

0.7

0.8

0.9

1

t

(d) α2
0.03

0.02
1

0.2

0.01
0
2

1

0

0.15
-1

0

0.1
-2
-0.01
0.05

-3
-0.02

0

-4

-0.05
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

-5
-1

1

-0.03
0

1

2

t

3

4

5

6

7

8

0

1

2

3

4

MPFW

(c′ ) β1

(b) α0
2

5

6

7

8

CCUC

(d′ ) β2
0.15

3

0.1

2.5
1.5

0.05

0.5

for POP

for MDT

1.5

0
-0.05

5

1

4

3

for CCFC

2

1

-0.1
0.5

-0.15

0
0

-0.5

-0.2

-0.5
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

-0.25
0.1

0.2

0.3

0.4

t

0.5

0.6

0.7

0.8

0.9

1

0.1

0.2

0.3

0.4

0.5

t

(e) α3

(f) α4

1

0

0.6

0.7

0.8

0.9

1

t

(g) α5

0.12

0.06

0.1

0.04
0.02

0.08
-1

0

0.06

-0.02

-2

5

4

3

0.04
-0.04

0.02

-3

-0.06
0

-0.08

-4
-0.02
-5

-0.1

-0.04

-6
0

1

2

3

4

5

6

7

-0.06
-20

-0.12
-0.14
-10

0

10

20

30

40

6

6.5

7

7.5

8

CCFC

MDT

POP

(e′ ) β3

(f ′ ) β4

(g ′ )β5

8.5

9

Fig 4. Analysis Results for COVID-19 Data

VCM. Now, we apply our method to this dataset. The response variable Yij
is the i-th subject’s CD4 percentage at time Tij . Following the covariates of
[15], we let X1i be the i-th subject’s smoke status, a dichotomous variable,
X2i the i-th subject’s centred age, and X3i the i-th subject’s centred preinfection CD4 percentage. The relationship between response and covariates

9.5

UNIFIED STATISTICAL INFERENCE

25

are modeled by a Semi-VCAM as below
(6.4)

Yij = α0 (Tij ) + α1 (Tij ) X1i + α2 (Tij ) β1 (X2i ) + α3 (Tij ) β2 (X3i ) ,

where the covariates are all time-invariant.
Based on 500 bootstrap sampling, we do the time-varying testing (4.1)
and the linearity testing (4.4), obtaining the p values 0.028 and 0.457, respectively. That means, at significant level 0.05, VCM is a reasonable choice,
which verifies that the model used in [15] is appropriate.
7. Concluding Remarks. In this paper, we have considered a SemiVCAM for the functional/longitudinal data with different sampling plan.
The Semi-VCAM is an extension of the existing VCAM. We have developed
a pilot estimation based local linear estimation for the Semi-VCAM and
have presented asymptotic distribution on a unified platform for sparse,
dense and ultra dense cases of the data. The virtue of unified asymptotic
results is to help us avoid deciding the types of data in advance, which is
a subjective choice and may lead to wrong conclusions. From the viewpoint
of model parsimony, we also have developed consistent testing procedures
to justify whether a VCM or PLAM, especially an AM is sufficient for the
real-life data. These test methods also avoid the subjective choice between
the sparse, dense and ultra dense cases of the data.
Our model and inference methods may be extended in various directions.
We close the paper by outlining some of them. In many application areas,
data may be collected on a count or binary response. For example, daily
death toll, suspected and confirmed cases of COVID-19. As a result, it is
useful to extend our proposed model and inference to the generalized SemiVCAM to accommodate the discrete functional/longitudinal responses. Data
in the form of samples of densities or distributions are increasingly encountered in practice and same as [11] there is a need for flexible regression
models that accommodate random densities as responses. We believe our
proposed model could also be used to model the data in which the responses
are random densities. In addition, due to the fact that the proposed test
method in our paper is based on the local smoothing, it may suffer the
curse of dimensionality, struggle to maintain the significance level and lose
its power to an extent as the dimension of explanatory variables increases.
Same as [20] and [22], we may use projection technique, or bridging between
local smoothing and global smoothing methods to avoid this. Due to the
complication of our model, extending the methods in [20] and [22] to our
scenario is not simple.

26

LIXIA HU, TAO HUANG AND JINHONG YOU

APPENDIX A: APPENDIX SECTION
A.1. Appendix subsection. A function m defined on the interval
[a, b] is called to be Lipschitz-continuous, if there exists a fixed constant
C > 0, such that |m (x) − m (x′ ) | ≤ C|x − x′ | for any x, x′ ∈ [a, b]. Denote
Cr [a, b] as the space of all functions m (x) defined on [a, b], such that m is
differentiable of r − 1 order, and m(r−1) is Lipschitz-continuous, where m(l)
means the l-th order derivative of m.
The necessary conditions to validate asymptotic properties are as follows.
(A1) The observation time points Tij ’s are drawn from an unknown distribution, which has a density fT (t) with the support T , and is continuously
differentiable in a neighbourhood of t and is uniformly bounded away
from 0 and infinity.
(A2) Xi ’s are independent realizations of stochastic process X(t), and Xi ’s
are independent of Tij ’s. The marginal density function fXk (·) of covariates Xk is continuously differentiable in a neighbourhood of x and
is uniformly bounded away from 0 and infinity.
(A3) Zi ’s are independent realizations of stochastic process Z (T ), and Zi ’s
are independent of Tij ’s. The eigenvalues of E [Z (T ) Z (T )τ ] are bounded
from 0 and infinity uniformly in T ∈ T . In addition, there exists a positive constant M such that |Zk (T ) | ≤ M uniformly for T ∈ T and
k = 1, ..., q, where Zk i.i.d. with Zij,k , a random sample of k-th covariate.
(A4) αk ∈ Cr [a, b] for k = 0, ..., p and βk ∈ Cr [ak , bk ] for k = 1, ..., p.
(A5) {νi (·)}i , {Tij }ij , {εij }ij are independent and identically distributed
and mutually independent. {xij }i are independent and identically distributed. Moreover, {νi (·)}i , {xij }ij and {εij }ij are mutually independent.
(A6) σ 2 (·) < ∞ is continuously differentiable. γ(t, t′ ) is continuously differentiable and γ(t, t) = limt′ →t γ(t, t′ ) < ∞.
(A7) E{|νi (·) + σ(·)εij |ν } is continuous and bounded from infinity for ν ≤ 4.
(A8) k(·) is bounded and symmetric probability density function with a
bounded
support and a bounded derivative.
√
−r
2 K /n = o(1).
+ KC−r } = o(1) and KA
(A9) KA {KA
C
Remark 4. Assumptions A1 and A2 involve the distributions of time
points Tij and k-th covariate Xk . Assumption A3 relates to covariates Z, a
similar conditions with [4]. Assumption A4 specifies the degree of smoothness of varying-coefficient component functions and additive component
functions. Assumptions A5–A7 are necessary for constructing asymptotic
distribution, a common conditions with [4]. Assumption A8 is a standard

27

UNIFIED STATISTICAL INFERENCE

condition of kernel function in local polynomial smoothing, and A9 is about
the number of interior knots in pilot spline estimation.
ACKNOWLEDGEMENTS
SUPPLEMENTARY MATERIAL
Supplement A: Preliminary Results
(http://www.e-publications.org/ims/support/dowload/imsart-ims.zip).
Proposition 1.
that
sup
x∈[ak ,bk ]

Under Assumption (A1) – (A6) and (A9), it follows


|β̂k,I (x) − βk (x)| = Op 

p

−r
+ KC−r ) +
KA (KA

REFERENCES

s

2
KC KA

nN̄H

+



KA 
.
n

[1] Berhane, K. and Tibshirani, R.J. (1998). Generalized additive models for longitudinal data. Canad. J. Statist. 26 517–535.
[2] Breiman, L. and Friedman, J. H. (1985). Estimating optimal transformations for
multiple regression and correlation. With discussion and with a reply by the authors.
J. Amer. Statist. Assoc. 80 580–619. MR0803258
[3] Carroll, R.J., Maity, A., Mammen, E., and Yu, K. (2009). Nonparametric additive
regression for repeatedly measured data. Biometrika. 96 383–398.
[4] Chen, Y. and Yao, W. (2017). Unified inference for sparse and dense longitudinal
data in time-varying coefficient models. Scand. J. Stat. 44 268–284. MR3619705
[5] Chen, Z., Gao, Q., Fu, B. and Zhu, H. (2019). Montone nonparametric regression
for functional/longitudinal data. Statist. Sinica., 29(4), 2229–2249.
[6] Diggle, P. J., Liang, K. Y. and Zeger, S. L. (1994). Analysis of longitudinal data.
Oxford, U.K.: Oxford University Press.
[7] Fan, J. and Gijbels, I. (1996). Local polynomial modelling and its applications.
Chapman & Hall, London. MR1383587
[8] Fan, J. and Zhang, J. T. (2000). Two-step estimation of functional linear models
with applications to longitudinal data. J. Roy. Statist. Soc. Ser. B. 62(2) 303–322.
[9] Ferraty, F. and Vieu, P. (2006). Nonparametric functional data analysis. Springer,
New York.
[10] Guo, W. (2002). Functional mixed effects models. Biometrics. 58 (1) 121–128.
[11] Han, K., Müller, H. G. and Park, B. U. (2019). Additive functional regression
for densities as responses. Accepted by J. Amer. Statist. Assoc. 1-24.
[12] Hastie, T. and Tibshirani, R. (1993). Varying-coefficient models. With discussion
and a reply by the authors. J. Roy. Statist. Soc. Ser. B. 55 757–796. MR1229881
[13] Hu, L., Huang, T., and You, J. (2019). Estimation and identification of a varyingcoefficient additive model for locally stationary processes. J. Amer. Statist. Assoc.
114(527), 1191–1204.
[14] Hu, L., Huang, T., and You, J. (2019). Robust inference in Varyingcoefficient additive models for longitudinal/functional data. Statist. Sinica.,
doi:10.5705/ss.202018.0483.

28

LIXIA HU, TAO HUANG AND JINHONG YOU

[15] Huang, J., Wu, C. and Zhou, L. (2002). Varying-coefficient models and basis function approximations for the analysis of repeated measurements. Biometrika. 89 (1),
111–128.
[16] Huang, J. Z., Wu, C. O. and Zhou, L. (2004). Polynomial spline estimation and
inference for varying coefficient models with longitudinal data. Statist. Sinica. 14 763–
788. MR2087972
[17] Hoover, D., Rice, J., Wu, C., and Yang, L. (1998). Nonparametric smoothing
estimates of time-varying coefficient models with longitudinal data. Biometrika. 85
(4), 809–822.
[18] Jun, S. J. and Pinkse, J. (2012). Testing under weak identification with conditional
moment restrictions. Econometric Theory. 28 1229–1282. MR2998471
[19] Kim, S. and Zhao, Z. (2013). Unified inference for sparse and dense longitudinal
models. Biometrika. 100 203–212. MR3034333
[20] Lavergne, P. and Patilea, V. (2008). Breaking the curse of dimensionality in
nonparametric testing. Journal of Econometrics. 143(1), 103–122.
[21] Lederman, M. M., Connick, E. and Landay, A. et al. (1998). Immunologic responses associated with 12 weeks of combination antiretroviral therapy consisting of
zidovudine, lamivudine, and ritonavir: results of AIDS Clinical Trials Group Protocol
315. Journal of Infectious Diseases. 178(1), 70–79.
[22] Li, L. and Zhu, L. (2017). Specification testing for regressions: an approach
bridging between local smoothing and global smoothing methods. arXiv preprint
arXiv:1710.05263.
[23] Li, Y. and Hsing, T. (2010). Uniform convergence rates for nonparametric regression
and principal component analysis in functional/longitudinal data. Ann. Statist. 38
3321–3351. MR2766854
[24] Liang, H., Wu, H. and Carroll R J. (2003). The relationship between virologic and
immunologic responses in AIDS clinical research using mixed-effects varying-coefficient
models with measurement error. Biostatistics. 4(2) 297–312.
[25] Lin, X., and Zhang, D. (1999). Inference in generalized additive mixed models by
using smoothing splines. J. R. Stat. Soc. Ser. B Stat. Methodol. 61, 381–400.
[26] Liu, R. and Yang, L. (2010). Spline-backfitted kernel smoothing of additive coefficient model. Econometric Theory. 26 29–59. MR2587102
[27] Luo, R., and Qi, X. (2017). Function-on-function linear regression by signal compression. J. Amer. Statist. Assoc. 112 (518) 690–705.
[28] Luo, R., Qi, X. and Wang, Y. (2016). Functional wavelet regression for linear
function-on-function models. Electron. J. Stat. 10(2), 3179–3216.
[29] Morris, J.S. and Carroll, R.J. (2006). Wavelet-based functional mixed models.
J. R. Stat. Soc. Ser. B Stat. Methodol.68 (2), 179–199.
[30] Qi, X. and textscLuo, R. (2018). Function-on-function regression with thousands of
predictive curves. J. Multivariate Anal. 163 51–66.
[31] Ramsay, J.O. and Silverman, B.W. (2002). Applied functional data analysis: methods and case studies. Springer.
[32] Ramsay, J.O. and Silverman, B.W. (2005). Functional data analysis. Springer,
New York,second edition.
[33] Rice, J. A. and Silverman, B. W. (1991). Estimating the mean and covariance
structure nonparametrically when the data are curves. J. R. Stat. Soc. Ser. B Stat.
Methodol. 53(1), 233–243.
[34] Scheipl, F., Staicu, A.-M., and Greven, S. (2015). Functional additive mixed
models. J. Comput. Graph. Statist. 24 (2) 477–501.
[35] Sentürk, D., and Nguyen, D.V. (2011). Varying coefficient models for sparse noise-

UNIFIED STATISTICAL INFERENCE

29

contaminated longitudinal data. Statist. Sinica. 21 (4), 1831–1856.
[36] Song, Q. and Yang, L. (2010). Oracally efficient spline smoothing of nonlinear
additive autoregression models with simultaneous confidence band. J. Multivariate
Anal. 101 2008–2025. MR2671198
[37] Stone, C. J. (1985). Additive regression and other nonparametric models. Ann.
Statist. 13 689–705. MR0790566
[38] Wang, J.L., Chiou, J. and Müller, H.G. (2016). Functional data analysis. Ann.
Rev. Statist. Its Appl. 3, 257–295.
[39] Wang, L. and Yang, L. (2007). Spline-backfitted kernel smoothing of nonlinear
additive autoregression model. Ann. Statist. 35 2474–2503. MR2382655
[40] Wu, C. O. and Chiang, C. T. (2000). Kernel smoothing on varying coefficient
models with longitudinal dependent variable. Statistica Sinica. 433–456.
[41] Wu H. and Liang H. (2004). Backfitting random varying-coefficient models with
time-dependent smoothing covariates. Scandinavian Journal of Statistics. 31(1) 3–
19.
[42] Wu, H. and Zhang, J. (2002). Local polynomial mixed-effects models for longitudinal data. J. Amer. Statist. Assoc. 97 883–897. MR1941417
[43] Xue, L., Qu, A. and Zhou, J. (2010). Consistent model selection for marginal generalized additive model for correlated data. J. Amer. Statist. Assoc. 105(492), 1518–
1530.
[44] You, J. and Zhou, H. (2007). Two-stage efficient estimation of longitudinal nonparametric additive models. Statist. Probab. Lett. 77, 1666–1675.
[45] Zhang, X., Park, B. U. and Wang J. (2013). Time-varying additive models for
longitudinal data. J. Amer. Statist. Assoc. 108, 983–998.
[46] Zhang, X. and Wang, J. (2015). Varying-coefficient additive models for functional
data. Biometrika. 102 15–32. MR3335093
[47] Zhang, X. and Wang, J. (2016). From sparse to dense functional data and beyond.
Ann. Statist. 44 2281–2321. MR3546451
[48] Zhang, X., Zhong, Q., and Wang, J. L. (2020). A new approach to varyingcoefficient additive models with longitudinal covariates. Computational Statistics &
Data Analysis. 106912.
School of Statistics and Mathematics
Shanghai Lixin University of
Accounting and Finance
Shanghai, 201209 China
E-mail: hulx18sufe@163.com

School of Statistics and Management
Shanghai University of Finance and
Economics, Shanghai, 200433 China
E-mail: huang.tao@mail.shufe.edu.cn
johnyou07@163.com

