arXiv:2101.00422v1 [econ.EM] 2 Jan 2021

COVID-19 spreading in financial networks: A
semiparametric matrix regression model∗
Monica Billio†
Roberto Casarin‡
Michele Costola§
Matteo Iacopini¶
January 5, 2021
Abstract
Network models represent a useful tool to describe the complex set of financial relationships
among heterogeneous firms in the system. In this paper, we propose a new semiparametric
model for temporal multilayer causal networks with both intra- and inter-layer connectivity.
A Bayesian model with a hierarchical mixture prior distribution is assumed to capture
heterogeneity in the response of the network edges to a set of risk factors including the
European COVID-19 cases. We measure the financial connectedness arising from the
interactions between two layers defined by stock returns and volatilities. In the empirical
analysis, we study the topology of the network before and after the spreading of the COVID19 disease.
Keywords: multilayer networks; financial markets; COVID-19;
JEL Classification: C11; C58; G10.

∗

We thank the participants at the 14th International Conference Computational and Financial
Econometrics (CFE 2020) for the provided comments. We also thank Maurizio La Mastra for the
excellent research assistant. This research used the SCSCF and the HPC multiprocessor cluster systems
provided by the Venice Centre for Risk Analytics (VERA) at University Ca’ Foscari of Venice. Matteo
Iacopini acknowledges financial support from the Marie Sklodowska-Curie Actions, European Union, Seventh
Framework Program HORIZON 2020 under REA grant agreement n. 887220.
†
Ca’ Foscari University of Venice, Email: billio@unive.it. (corresponding author)
‡
Ca’ Foscari University of Venice, Email: r.casarin@unive.it.
§
Ca’ Foscari University of Venice, Email: michele.costola@unive.it.
¶
Vrije Universiteit Amsterdam, Email: m.iacopini@vu.nl.

1

Introduction

The recent outbreak of the COVID-19 disease has severely affected the economy and the
financial markets due to the consequences of the lockdowns and travel limitations. According
to the International Monetary Fund (IMF, 2020), the world growth in 2020 is projected to
have a contraction of 4.4%. During February-March of 2020, the global financial market has
suffered multiple crashes having the largest drop of around 13% on 16 March 2020. To ensure
the financial stability and avoid the breakdown of the markets, central banks supported the
functioning of the system with asset purchase programs. While the global financial crisis has
been originated by the vulnerabilities of the US mortgage market, which in turn has been
the root of the European sovereign debt crisis, the COVID-19 pandemic has represented
an (unprecedented) exogenous shock to the financial system that could not be reasonably
foreseen and hence, priced by the financial markets. The analysis the financial connectedness
through the network modeling can provide interesting insights to policy makers on the effect
of the COVID-19 on the financial system.
The literature of financial connectedness and network modeling has rapidly increased
after the recent financial crisis both in theoretical (i.e., Elliott et al., 2014; Acemoglu et al.,
2015) and empirical analyses (i.e., Billio et al., 2012; Diebold and Yılmaz, 2014). Regarding
the econometric methods, the methodologies proposed for extracting unobserved networks
have been particularly flourishing, especially in the Bayesian framework. Ahelegbey et al.
(2016a,b) combine a Bayesian graphical approach with vector autoregressive (VAR) models
where the contemporaneous and temporal causal structures of the model are represented by
means of two distinct graphs. In a graphical model framework, Bianchi et al. (2019) propose a
Markov-switching graphical SUR model to investigate changes in systemic risk. The authors
show that connectivity increases in during 1999-2003 and in 2008-2009. Using a time-varying
parameter vector autoregressive model (TVP-VAR), Geraci and Gnabo (2018) estimate a
dynamic Granger Network in the S&P 500 market and find a gradual decrease in network
connectivity not detectable using a rolling window approach. Similarly, in the framework
1

of forecast variance error decomposition (Diebold and Yilmaz, 2009; Diebold and Yılmaz,
2014). In high-dimensional multivariate time-series, Billio et al. (2019) propose a Bayesian
nonparametric Lasso prior for VAR models. The causal networks are extracted through
clustering and shrinking effects, and well describe real-world networks features. Bernardi
and Costola (2019) propose a shrinkage and selection methodology for network inference
through a regularised linear regression model with spike-and-slab prior on the parameters.
The financial linkages are expressed in terms of inclusion probabilities resulting in a weighted
directed network. Referring to econometric models for networks, Billio et al. (2018b) propose
a dynamic linear regression model for tensor-valued response variables and covariates with
a parsimonious parametrization based on the parallel factor decomposition. Billio et al.
(2018a) propose a Bayesian Markov-switching regression model for multidimensional arrays
(tensors) of binary time series. The coefficient tensor can switch between multiple regimes
in order to capture time-varying sparsity patterns of the network structure.
In this paper we propose a new semiparametric model for temporal multilayer causal
networks. A Bayesian model with mixture prior distribution is assumed in order to model
heterogeneity in the response of the network edges to a set of exogenous variables.
Recently, the literature has focused on multilayer networks where different channels
of relationships, defined as layers, characterize a given set of nodes (system).

The

study of connectedness involving the interdependence among these layers can improve the
measurement of the network topology. For instance, Wang et al. (2020) consider a multilayer
Granger causality network composed by mean spillover, volatility spillover, and extreme
risk spillover layers. The authors show that significant changes in connectivity on extreme
risk and volatility spillover layers before a general financial turmoil. Casarin et al. (2020)
propose a Bayesian graphical vector autoregressive model to extract multilayer network in
the international oil market and show that oil production network is a lagged driver for
prices.
In this paper, we follow this stream of literature and consider multilayer networks with

2

both intra- and inter-layer connectivity. We measure the financial connectedness arising
from the interactions between two layers defined by assets returns and volatilities. These
connectivity effects are represented at four levels: (i) return linkages (returns causes returns);
(ii) volatility linkages (volatility causes volatility); (iii) risk premium linkages (volatility
causes returns); and (iv) leverage linkages (return causes volatility).
To investigate the role of selected risk factors on the dynamic evolution of the multilayer
financial network, we propose a novel semiparametric model for panels of matrix-valued
data. The use of matrix-valued statistical models in time series econometrics has become
increasingly popular over the last decades. In the seminal paper by Harrison and West
(1999), matrix-valued distributions were exploited for representing state space models.
More recently, Carvalho and West (2007); Wang and West (2009) used the matrix normal
distribution in Bayesian dynamic linear models while Carvalho et al. (2007) applied the
hyper-inverse Wishart distribution in a Gaussian graphical model. Other applications of
matrix-variate distributions include stochastic volatility (Uhlig, 1997; Gouriéroux et al.,
2009; Golosnoy et al., 2012), classification of longitudinal datasets (Viroli, 2011), models
for network data (Zhu et al., 2017, 2019), and factor models (Chen et al., 2019). With
respect to the existing literature, our approach proposes two main contributions. First, we
extend the matrix-valued linear model to panels of matrix-valued data. Second, we propose
a hierarchical mixture prior to cope with overfitting and loss of efficiency in high-dimensional
settings. This prior choice allows for a semiparametric model that grants higher flexibility in
investigating the impact of covariates on matrix-valued response variables. Our model and
inference are well suited for the analysis of multilayer temporal networks, where the intraand inter-layer connectivity at each point in time is encoded by a cross section of adjacency
matrices.
Finally, an original application to a European financial network among 412 firms based
in Germany, France, and Italy, shows that the proposed framework scales well in highdimensions (i.e., hundreds of nodes) and can be successfully used to provide new insights on

3

shock transmission in financial markets. Inspired by the causality definition between return
and volatility (i.e., Bekaert and Wu, 2000), we label the intra-connectivity risk premium
according to the time-varying risk premium hypothesis (volatility causes returns) and the
leverage according to the leverage hypothesis (return shocks lead to changes in volatilities).
In the proposed model, each adjacency matrix related to the four levels of connectivity is
modelled as a function of a set of risk factors, including market returns, implied volatility,
corporate credit risk, and the number of COVID-19 new confirmed European cases. In the
empirical analysis, we study the topology of the European financial network before and after
the spreading of the COVID-19 disease.
Our findings highlight that COVID-19 is the most relevant factor in explaining the
connectivity of the European financial network at firm and sector level, in particular
industrial, real estate, and health care. The probabilities of volatility and risk premium
linkages are the most positively affected by the COVID-19, which at the same time has a
negative effect on leverage linkages. Moreover, we find evidence of a positive relationship
between firm centrality and the number of its linkages that are impacted by the COVID-19,
across all layers except leverage.
The remaining of the paper is structured as follows.

Section 2 introduces a novel

econometric framework for matrix-valued panel data, then Section 3 presents the Bayesian
inference procedure. Section 4 illustrates the empirical analysis and our major results.
Finally, Section 5 concludes.

2

Network model

Let Gt = (G11t , G22t , G12t , G21t , E) a two-layer temporal network (Boccaletti et al., 2014),
where Gijt ⊂ E × E is the connectivity graph between layers i and j, E = {1, . . . , N } is the
set of nodes (firms). In the proposed framework, each node represents a firm, the two layers
are given by firm stock return (layer 1) and volatility (layer 2). Four graphs encode the

4

connectivity between and within layers. Here, we focus on causal financial network where
each adjacency matrix is directed and hence, asymmetric. This implies that each element of
the matrix indicates a causal relationship between two nodes. The connectivity is represented
through the intra-layer adjacency matrices Y11,t and Y22,t and inter-layer adjacency matrices
Y12,t and Y21,t .
For the intra-connectivity graphs, we label return linkages the sub-network Y11,t (returns
causes returns) and volatility linkages the sub-network Y22,t (volatility causes volatility).
Regarding the inter-connectivity graphs, we label the two graphs inspired by the causality
definition in asset pricing between return and volatility as discussed in Bekaert and Wu
(2000). The label risk premium linkages for the sub-network Y11,t refers to the time-varying
risk premium hypothesis (volatility causes return) while the label leverage linkages for the
sub-network Y22,t is based on the leverage hypothesis (return causes volatilities).
We propose the following matrix-variate linear model for studying the impact of a set of
R covariates (f1,t , . . . , fR,t ) on the linkages

Y11,t =
Y22,t =
Y12,t =
Y21,t =

R
X
r=1
R
X
r=1
R
X
r=1
R
X

B11,r fr,t + E11,t ,

E11,t ∼ MN n,n (O, Σ1,11 , Σ2,11 )

B22,r fr,t + E22,t ,

E22,t ∼ MN n,n (O, Σ1,22 , Σ22,2 )
(1)

B12,r fr,t + E12,t ,

E12,t ∼ MN n,n (O, Σ12,1 , Σ12,2 )

B21,r fr,t + E21,t ,

E21,t ∼ MN n,n (O, Σ21,1 , Σ21,2 )

r=1

where Blk,r are (n × n) matrices of coefficients and MN n,n (O, Σ1 , Σ2 ) denotes the zero-mean
matrix normal distribution (see Gupta and Nagar, 1999, Ch.2, for further details) with two
variance/covariance matrices Σ1 and Σ2 . If the (n × p) random matrix X is distributed as
a matrix normal with mean M and covariance matrices Σ1 , Σ2 , with Σ1 of size (n × n) and

5

Σ1 of size (p × p), written X ∼ MN n,p (M, Σ1 , Σ2 ), then
 1

0 −1
(X
−
M
)
. (2)
(X
−
M
)
Σ
P (X|M, Σ1 , Σ2 ) = (2π)−np/2 |Σ2 |−p/2 |Σ1 |n/2 exp − tr Σ−1
1
2
2
2
2
For identification purposes, we assume Σlk,1 = In and Σlk,2 = diag(σ1,lk
, . . . , σn,lk
), for each

l, k = 1, 2.

3
3.1

Bayesian Inference
Prior specification

As regards the prior assumption on the model parameters, we choose the following
independent mixture of Normal distributions for the coefficients bij,lk,r , for i, j = 1, . . . , n
(with i 6= j), l, k = 1, 2, and r = 1, . . . , R

2
bij,lk,r |plk , µlk , γlk

∼

2
p1,lk N (bij,lk,r |0, γ1,lk
)

+

Mb
X

2
pm,lk N (bij,lk |µm,lk , γm,lk
).

(3)

m=2

To solve the label switching problem, we impose the identification constraint µ2,lk < µ3,lk <
2
2
) we assume
, . . . , σn,lk
. . . < µMb ,lk . As regards the prior distribution for the variances (σ1,lk

the following mixture of Inverse Gamma distributions

2
σi,lk,r
|qlk , αlk , βlk

∼

Mσ
X

2
qm,lk IG(σi,lk
|αm,lk , βm,lk ),

(4)

m=1

and impose the identification constraint on the mean by assuming β1,lk /(α1,lk − 1) <
β2,lk /(α2,lk − 1) < . . . < βMσ ,lk /(αMσ ,lk − 1). Finally, for the hyper-parameter of the mixture
prior, we assume the following Dirichlet prior and Normal-Inverse Gamma prior distributions:

(p1,lk , p2,lk , . . . , pMb ,lk ) ∼ Dir(φb , φb , . . . , φb )

(5)

(q1,lk , q2,lk , . . . , qMσ ,lk ) ∼ Dir(φσ , φσ , . . . , φσ )

(6)

6

µ1,lk = 0,

(7)

2
∼ Ga(a0 , b0 ),
γ1,lk

(8)

µm,lk ∼ N (0, s2 ),

m = 2, . . . , Mb

(9)

2
γm,lk
∼ IG(a1 , b1 ),

m = 2, . . . , Mb

(10)

αm,lk ∼ Ga(a2 , b2 ),

m = 1, . . . , Mσ

(11)

βm,lk ∼ Ga(a3 , b3 ),

m = 1, . . . , Mσ ,

(12)

which is a standard choice in Bayesian mixture modeling (Frühwirth-Schnatter, 2006). The
first component of the mixture prior for coefficients bij,lk,r is a Bayesian Lasso (Park and
Casella, 2008) distribution, that corresponds to setting a0 = 1. This prior specification
strategy overcomes overparametrization and overfitting issues by clustering coefficients into
groups and by shrinking the coefficients in the first group toward zero, thus improving
the estimation efficiency in high-dimensions.

The proposed hierarchical mixture prior

distribution naturally induces a mixture model for the matrix-valued observations. For
each matrix Ylk,t , with l, k = 1, 2 and t = 1, . . . , T , by integrating out the parameters in the
likelihood, one obtains the following marginal likelihood.
n2

n

2
P (Ylk,t |µlk , γlk
, αlk , βlk ) =

Mσ Mb
X
X
m0 =1

b
σ
p̃m,lk q̃m0 ,lk P (Ylk,t |θ̃m,lk
, θ̃m
0 ,lk ),

(13)

m=1

b
2
σ
where θ̃m,lk
= (µ̃m,lk , γ̃m,lk
), θ̃m,lk
= (α̃m0 ,lk , β̃m0 ,lk ), and

b
σ
P (Ylk,t |θ̃m,lk
, θ̃m
0 ,lk ) =
ZZ
2
2
b
2
σ
=
P (Ylk,t |Blk,1 , . . . , Blk,R , σlk
)P (σlk
|θ̃m
0 ,lk )P (Blk,1 , . . . , Blk,R |θ̃m,lk ) dBlk,1 · · · dBlk,R dσlk .

See the Appendix for a proof. We summarize our Bayesian semiparametric model in the
Directed Acyclic Graph representation of Figure 1.

7

a0

s

2
γ1,lk

µm,lk

a1

b0

b1

2
γm,lk

φb

a2

a3

b2

αm,lk βm,lk

plk

φσ

b3
qlk

2
σi,lk

Blk,r
Ylk,t

ft

Figure 1: Directed Acyclic Graph of the proposed Bayesian semiparametric model
for multilayer networks.
It exhibits the conditional independence structure of the
observation model for Ylk,t with covariates ft = (f1,t , . . . , fR,t )0 (grey circles), the
2
, the componentparameters plk = (p1,lk , . . . , pMb ,lk ), qlk = (q1,lk , . . . , qMσ ,lk ), Blk,r , σi,lk
2
specific parameters µm,lk , γm,lk , αm,lk , βm,lk (white solid circles) and the fixed hyperparameters
s, a0 , b0 , a1 , b1 , a2 , b2 , a3 , b3 (white dashed circles). The directed arrows show the causal
dependence structure of the model.

3.2

Posterior approximation

b
, for i, j = 1, . . . , n, l, k = 1, 2,
Start by introducing two set of allocation variables Dij,lk,r
σ
r = 1, . . . , R, and Di,lk
, for i = 1, . . . , n, l, k = 1, 2. Denote the collection of all parameters
2
2
with θ = (Blk,1 , . . . , Blk,R , σ1,lk
, . . . , σn,lk
)0 , and let Y, f be the collection of all observed
2
2
2
networks and risk factors, respectively. Letting σlk
= (σ1,lk
, . . . , σn,lk
)0 , the likelihood of the

model in Eq. (1) is

P (Y, f |θ) =

T Y
2 Y
2
Y

2 /2

(2π)−n

2 −n/2
| diag(σlk
)|
|In |n/2

t=1 l=1 k=1
R
R
X
X
0 −1

1 
2 −1
Blk,r fr,t In Ylk,t −
Blk,r fr,t
· exp − tr diag(σlk ) Ylk,t −
2
r=1
r=1



−2n2 T

= (2π)

2 Y
2
Y

l=1 k=1
2 X
2
X

1
· exp − tr
2


2 −nT /2
| diag(σlk
)|

l=1 k=1

2 −1
diag(σlk
)

T
X
t=1

8

Ylk,t −

R
X
r=1

Blk,r fr,t

0

Ylk,t −

R
X
r=1

Blk,r fr,t



.

Since the joint posterior distribution is not tractable, we implement an MCMC approach
based on a Gibbs sampling algorithm to sample from the posterior distribution and to
approximate all posterior quantities of interest. The Gibbs sampler iterates over the following
steps:
1. Draw (bij,lk,1 , . . . , bij,lk,R ) from the Normal distribution P (bij,lk,r |−).
2
2
|−).
from Inverse Gamma distribution P (σi,lk
2. Draw σi,lk

3. Draw the allocations (db11,lk,r , . . . , dbn1,lk,r , db12,lk,r , . . . , dbn2,lk,r , db1n,lk,r , . . . , dbnn,lk,r ) from
the discrete distribution P (dbij,lk,r |−).
4. Draw the allocations (dσ1,lk , . . . , dσn,lk ) from the discrete distribution P (dσi,lk |−).
5. Draw (p1,lk , . . . , pMb ,lk ) from the Dirichlet distribution P (plk |−).
6. Draw (q1,lk , . . . , qMσ ,lk ) from the Dirichlet distribution P (qlk |−).
7. Draw the hyperparameters:
a) µm,lk , for m = 2, . . . , Mσ , from the Normal distribution P (µm,lk |−).
2
2
b) γ1,lk
from the Generalized Inverse Gaussian distribution P (γ1,lk
|−).
2
2
c) γm,lk
, for m = 2, . . . , Mb , from the Inverse Gamma distribution P (γm,lk
|−).

d) αm,lk , for m = 1, . . . , Mσ , from the distribution P (αm,lk |−).
e) βm,lk , for m = 1, . . . , Mσ , from the Gamma distribution P (βm,lk |−).

4

Empirical Analysis

In this section, we first describe the firms’ dataset and the set of risk factors (source:
Bloomberg and Eikon/Datastream), then we illustrate the network extraction procedure
by means of Granger causality tests. Finally, we discuss the results of the proposed network
model.
9

4.1

Data description

The European firms. The dataset includes 412 European firms (176 German, 162 French,
74 Italian) belonging to 11 GICS sectors: Financials (43 firms), Communication Services (38
firms), Consumer Discretionary (61 firms), Consumer Staples (17 firms), Health Care (48
firms), Energy (9 firms), Industrials (88 firms), Information Technology (45 firms), Materials
(24 firms), Real Estate (22 firms), Utilities (12 firms), and not classified in a specific GICS
sector (5 firms).1
The data sample ranges from the 4th of January 2016 to the 30th of September 2020, at
weekly frequency (Friday-Friday), thus including the period before and after the outbreak
of the COVID-19. The weekly logarithmic return for firm i, ri,t , is obtained from the total
returns series, whereas the weekly volatility is computed using the estimator of the variance
proposed by Garman and Klass (1980):
2
σ̂i,t
= 0.511(Hi,t − Li,t )2 − 0.383(Ci,t − Oi,t )2

(14)

− 0.019[(Ci,t − Oi,t )(Hi,t + Li,t − 2Oi,t ) − 2(Hi,t − Oi,t )(Li,t − Oi,t )],
where Hi,t is the weekly logarithmic high price, Li,t is the weekly logarithmic low price, Oi,t
is the weekly logarithmic opening price, and Ci,t is the logarithmic closing price. The weekly
prices have been obtained by taking in a given week the maximum among the daily high
prices (weekly High Price), the minimum among the daily low prices (weekly Low Price),
the opening price of the first available day in a week (weekly Opening Price), and the closing
prices of the last available day in a week (weekly Closing Price).

The risk factors. We consider the following risk factors: (i) the log-returns on the Euro
STOXX 50 index (SX5E), (ii) the implied volatility on the Euro STOXX 50 index (V2X),
(iii) the Bloomberg Barclays EuroAgg Corporate Average OAS (LECPOAS) as a proxy for
1

The list of the firms, the countries, and the information about their GICS sectors and industries are
available upon request to the Authors.

10

corporate credit risk, and (iv) the new European COVID-19 cases (NCOVEUR). Figure 2
reports the plots of the risk factors time series for the period under investigation and shows
an abrupt change on the financial factors during the COVID-19 outbreak (bottom-right

LECPOAS

NCOVEUR

V2X

SX5E

panel).

Figure 2: The considered risk factors in the analysis: the returns on the Euro STOXX
50 index (top-left), the implied volatility on the Euro STOXX 50 index (top-right), the
Bloomberg Barclays EuroAgg Corporate Average OAS (bottom-left) and the new European
COVID-19 cases (bottom-right) for the considered European firms over time.

4.2

Network extraction

We estimate the dynamic networks of European financial institutions using pairwise Grangercausality (e.g., see Billio et al., 2012). In this respect, we make use of a rolling window
approach (104 observations, that is 2 years) and consider the intra- and inter-connectivity,
namely, the return linkages, the volatility linkages, the risk premium linkages, and the
leverage linkages:

xi,t =
xj,t =

m
X

b11l xi,t−l +

m
X

l=1

l=1

m
X

m
X

b21l xi,t−l +

l=1

l=1

11

b12l xj,t−l + εit
(15)
b22l xj,t−l + εjt

Y22,t
leverage
Y12,t
risk premium

Y11,t
return
Y21,t
volatility
return,
volatility

leverage,
risk premium

Figure 3: The network densities (solid blue line) at 1% level of statistical significance for
the return linkages (top-left), the volatility linkages (bottom-left), the leverage linkages (topright), and the risk premium (bottom-right) for the considered European firms over time.

Figure 4: The network densities at 1% level of statistical significance from the 21st of
February 2020 to the 1st of May 2021 (same scale). The return linkages (solid line), the
volatility linkages (dashed line), the leverage linkages (dashed-dotted line) and the risk
premium (dotted line) for the considered European firms over time.
where i, j = 1, . . . , k and x = {r, σ̂}. Each entry (i, j) of the adjacency matrix Ylk,t associated
to layer lk, with l, k = 2, is defined as Yij,lk,t = pval(bij ) for i 6= j. Therefore, the
element Yij,lk,t represents the observed probability that the relationship between xi,t and
xj,t is statistically different from zero. We estimate a total of 145 × 4 adjacency matrices,
145 matrices for each layer, covering the period from the 29th of December 2017 to the 20th
of October 2020.2
Figure 3 provides the density of the four sub-networks over time at 1% level of statistical
2

The estimation algorithm has been parallelized and implemented in MATLAB on two nodes at the High
Performance Computing (HPC) cluster (VERA - Ca’ Foscari University). Each node has 2 CPUs Intel Xeon
with 20 cores 2.4 Ghz and 768 GB of RAM.

12

significance3 .

Despite sharing some similarities, the dynamics of the intra- and inter-

connectivity linkages can provide different signals on shock propagation in the financial
markets. This calls for a joint modeling of the four connectivity layers. On average, the
density is higher for the volatility linkages (0.16) followed by the risk premium linkages
(0.045), the return linkages (0.035), and the leverage linkages (0.006). The density on the
return linkages (top-left plot of Figure 3) shows two peaks on the 20th of March 2020 and
the 5th of June 2020, respectively, with a reversion towards the mean after the first peak.
Conversely, the density on the volatility linkages (bottom-left) shows a jump on the 27th of
March 2020 with a new persistent higher level. Interestingly, the leverage linkages (returns
causes volatility) have an opposite behaviour with an abrupt drop of the density in March
2020. Finally, the risk premium linkages (volatility causes returns) exhibit a drop in the
same month followed by a peak in April 2020. The four sub-networks (i.e., layers) highlight
that shocks on return and volatility have played different roles with heterogeneous timing
during the outbreak of COVID-19 and its aftermath, thus affecting in different manner the
intra- and inter-connectivity.
The latter stylized fact can be better visualized by zooming in the period from the 21st
of February 2020 to the 1st of May 2021. Accordingly, Figure 4 reports the plot of the
four densities on the same scale for this sub-period. The density of the returns linkages
(solid line) increases until the 20th of March 2020, whereas that of inter-linkages decreases
(dashed-dotted and dotted lines). The volatility linkages (dashed line) slowly decrease until
the 13th of March 2020, then suddenly jumps reaching the peak on the 27th of March 2020.
At the same time, the density on the risk-premium linkages increases following a similar, but
lagged, pattern as for the volatility linkages, whereas the leverage linkages start to slowly
increase. This indicates that shocks on returns have been followed by shocks on volatility,
where the latter have brought a persistent change in the level of connectivity.
For the sake of completeness, we include in Figures 5-6 the intra- and inter-layer directed
3

The density of the network is defined as the total number of observed linkages over the total number of
possible linkages. If the density is 0, no connections exist, while if density is 1, the network is fully connected.

13

Y11
return

Y11
return
Y22
volatility

Y22
volatility

Figure 5: The intra-layer directed networks: returns linkages (top) and volatility linkages
(bottom) on the 17th of January 2020 (left) and the 27th of March 2020 (right). Edges
are clockwise directed. Node size: proportional to the total degree averaged over time
within each regime. Edge color according to the Industry of the source node: Financials
(light green), Communication Services (violet), Consumer Discretionary (pink), Consumer
Staples (orange), Health Care (light blue), Energy (light orange), Industrials (olive green),
Information Technology (dark orange), Materials (green), Real Estate (dark pink), Utilities
(blue), and not classified in a specific GICS sector (dark green). For exposition purposes,
we drop edges with p-value larger than 0.1%.

14

Y12
risk premium

Y12
risk premium
Y21
leverage

Y21
leverage

Figure 6: The inter-layer directed networks: risk premium linkages (top) and leverage
linkages (bottom) on the 17th of January 2020 (left) and the 27th of March 2020 (right).
Edges are clockwise directed. Node size: proportional to the total degree averaged over time
within each regime. Edge color according to the Industry of the source node: Financials
(light green), Communication Services (violet), Consumer Discretionary (pink), Consumer
Staples (orange), Health Care (light blue), Energy (light orange), Industrials (olive green),
Information Technology (dark orange), Materials (green), Real Estate (dark pink), Utilities
(blue), and not classified in a specific GICS sector (dark green). For exposition purposes,
we drop edges with p-value larger than 0.1%.

15

networks on the 17th of January 2020 (one week before the first European COVID-19 case)
and the 27th of March 2020. As shown in the Figures, the connectivity increases in the intralayer networks for the return linkages and especially, on the volatility linkages. Regarding the
inter-layer directed networks, the connectivity of the risk premium linkages increase while
it decreases significantly in the leverage linkages. It is therefore interesting to apply the
proposed network model to measure the impact of the COVID-19 and the other risk factors,
on the intra- and inter-linkages of the considered European firms.

4.3

Results

In this section, we apply the model and inference proposed in Sections 2-3 to estimate the
impact of the risk factors on the multilayer European financial network. Since our analysis
is focused on investigating the role of COVID-19, we describe the effects of the other risk
factors (returns on the Euro STOXX 50 index, the implied volatility on the Euro STOXX 50
index, and the Bloomberg Barclays EuroAgg Corporate Average OAS) on financial linkages
in the Appendix. Figure 7 reports the impact of COVID-19 on each linkage (i, j), from firm
j to firm i, across all layers. In particular, we report only non-null effects, that is coefficients
such that zero is not included in the corresponding 95% posterior high probability density
interval (HPDI). The blue color indicates a positive impact on the probability of an edge
from firm j to firm i, while the red color indicates a negative impact. Since our response
variable is an increasing transformation of the p-value of Granger causality test performed
on a pair (i, j) of time-series, a negative (positive) COVID-19 coefficient implies an increase
(decrease) in the p-value, hence in the probability to observe a linkage from j to i. As shown
in the Figure, the COVID-19 has a weaker effect on return linkages in terms of magnitude
and number of impacted linkages. Conversely, it increases the probability of volatility and
risk premium linkages, whereas, in most of the cases, it reduces the probability of leverage
linkages. Overall, among the selected risk factors, the COVID-19 has the greatest impact
on the European financial networks. The other risk factors, such as the market returns,
16

the implied volatility, and the corporate credit risk, have some effect on the volatility and
leverage linkages and very weak effect on return and risk premium linkages (see Figure 11
in the Appendix).
5

4

4

3

3

2

2

0
-1

volatility

-2

1
0
-1
-2

-3

-3

-4

-4

-5

-5

5

5

4

4

3

3

2

2

1

1

0
-1

leverage

return

1

risk premium

5

0
-1

-2

-2

-3

-3

-4

-4

-5

-5

Figure 7: Impact of COVID-19 on financial linkages for intra-layer (left column) and interlayer (right column) networks. In each plot, the coefficient in position (i, j) refers to the
impact of COVID-19 on the edge from firm j to firm i. Only non-null coefficients are
reported: blue indicates positive impact on edge existence, red indicates negative impact on
edge existence. A coefficient is considered null if its posterior HPDI contains zero.
Figure 8 shows the net effect of COVID-19 on the linkages between sectors. In each
panel, the block in position (i, j) refers to the number of linkages (net effect) from sector j
to sector i impacted by COVID-19. The main empirical findings are the following:
• there is evidence of a heterogeneous net impact on return and risk premium linkages, of
a substantial increase in volatility linkages, and of a decrease in the leverage linkages;
17

• the Industrial sector plays a pivotal role in the connectivity structure of the multilayer
network. In return linkages, risk premium, and volatility linkages, there is an increase
in the connectivity from and to the other sectors (except for Consumer Staples, Energy,
and Utilities). The Industrial sector exhibits the largest increase in the connectivity
level within sector (except in the leverage layer);
• in the return linkages, the Financial sectors shows the largest decrease in the
connectivity to the other sectors (red squares in the column). Conversely, in the risk
premium and volatility linkages, there is an increase in the connectivity to the other
sectors (except for Utilities);
• utilities are the unique sector that exhibits a decrease in the connectivity from other
sectors in the risk premium linkages, especially from the Industrial sector. A similar
behavior can be found also in the return linkages for the Financial, Real Estate, and
Utilities sectors;
• energy is the only sector that does not affect and is not unaffected by COVID-19 in all
the multilayer network (except for the incoming connectivity in the return linkages);
• the Health Care and the information technology are the sectors that show the largest
decrease in the connectivity from other sectors in the leverage linkages.
In conclusion, the results discussed above show that the COVID-19 has affected the
connectivity of the European financial network between the sectors. We further investigate
the relationship between the impact of COVID-19 on financial linkages and the centrality of
each firm in the network.
Centrality is measured either by in-/out-degree or betweenness centrality. Betweenness
centrality quantifies the number of times a node acts as a bridge along the shortest path
between two other nodes. Firms with large betweenness contribute to spreading contagion
in the networks, thus requiring to be monitored for the stability of the financial system. We

18

Communication Services

20

Communication Services

Consumer Discretionary

10

Consumer Discretionary

0

s
tie

Re

al

Es

ta

er
ial
at
M

Ut
ili

s

te

y

ial
s

log

str

no
ch

du
In

Te

s

re

ial

Ca
h

alt

Co

rm
at

ns

ion

um

He

ar

s

-400

ion

rv
ice

re
t

Se
n

sc

tio

Consumer Staples

Di
er

ica

um

un

-200

Consumer Discretionary

In

Co

fo

ns

Co
m
m

fo
In

Co

-300

s
tie

Re

al

Es

ta

er
ial
at
M

Ut
ili

s

te

y

ial
s

log
no

str
du

Co

rm
at

ns

ion

Te

In

ch

s
ial

Ca
h

alt
He

Fi

um

re

er
gy

nc

En

ap
St

er

na

y

les

s

ar
ion

rv
ice

re
t

Se
n

sc

tio

Di
er

ica

um

un

Utilities

-80

ns

Co
m
m

-250

Real Estate

Communication Services

Communication Services

500

Consumer Discretionary

450

Consumer Staples

400

Energy

350

Financials

300

Health Care

250

Energy
-600

Financials
-800

Health Care
Industrials

-1000

Information Technology

leverage

volatility

-200

Materials

-70

Utilities

Information Technology

er
gy

-60

nc

-50

Materials

En

Information Technology

-150

Industrials

na

-40

Fi

Industrials

-100

Financials
Health Care

y

-30

les

-20

ap

Financials
Health Care

-50

Energy

St

-10

er

Energy

Real Estate

0

Consumer Staples

risk premium

return

Consumer Staples

Industrials

-1200

Materials
Real Estate

-1400

200

Information Technology

150

Materials

100

Real Estate
50

ies
ilit

ta
Es
al

Re

Ut

s

te

y

er
at
M

ch

no

str
du
In

ion

Te

ial

log

s
ial

re

ial
He

alt

h

nc
na

Ca

s

gy
er
En

St
er

Fi

ap

les

ry

at
rm
fo
In

Co

ns

Di
er
um

ns
Co

m
m
Co

um

n
tio
ica
un

at
rm
fo
In

re

Se

tio

rv

na

ice

s

ies
ilit

ta
Es
al

Ut

te

y

s
er
at

ion

M

Re

no

ial

log

s
ial
str
du

ch

In

Te

ial
He

alt

h

nc

Ca

s

re

gy
er
En

na

St
er

um

Co

ns

Fi

ap

na
tio
re

sc
Di
er

um
ns

Co

les

ry

s
ice
rv
Se
n
tio
ica
un
m
m
Co

Utilities

-1600

sc

Utilities

Figure 8: Impact of COVID-19 on sector linkages for intra-layer (left column) and inter-layer
(right column) networks. In each plot, the block in position (i, j) refers to the number of
linkages (net effect) from sector j to sector i impacted by COVID-19. Blue (red) indicates
an increase (decrease) of the number of linkages.
return

risk premium

leverage

volatility

Figure 9: Number of edges impacted by COVID-19, across layers (columns), for the nodes’
total degree. In each scatterplot: node total degree on the 27th March 2020 (horizontal
axis) versus the number of non-null coefficients. Only non-null coefficients are reported:
blue indicates positive impact on edge existence, red indicates negative impact on edge
existence. A coefficient is considered null if its posterior HPDI contains zero.

19

measure the impact by considering the sum of the negative (blue) and positive (red) node
coefficients of a risk factor, that is:
b̃IN,+
i,lk,r

=

n
X

b̃IN,−
i,lk,r

b̂ij,lk,r I(b̂ij,lk,r > 0),

j=1
T,+
=
b̃OU
i,lk,r

n
X

W,+
b̃BT
i,lk,r

=

W,−
b̃BT
=
i,lk,r

T,−
b̃OU
=
i,lk,r

b̂ji,lk,r I(b̂ji,lk,r > 0),

b̂ji,lk,r I(b̂ji,lk,r < 0),

j=1

b̂ij,lk,r I(b̂ij,lk,r > 0) +

n
X

j=1

j=1

n
X

n
X

j=1

b̂ij,lk,r I(b̂ij,lk,r < 0),

j=1
n
X

j=1
n
X

=

n
X

b̂ij,lk,r I(b̂ij,lk,r < 0) +

(16)

b̂ji,lk,r I(b̂ji,lk,r > 0),
b̂ji,lk,r I(b̂ji,lk,r < 0).

j=1

Figure 9 shows the number of linkages of each firm which are impacted by COVID-19 versus
the firms’ total degree. We find evidence, across the different inter- and inter-layer networks,
of a positive relationship between firm centrality and the effect of COVID-19, except for
leverage linkages. In particular, in the risk premium and volatility layer, almost half of the
linkage of each node have been impacted by the COVID-19.
Figure 10 shows the node centrality on the 27th March 2020 versus the sum of the
negative (blue) and positive (red) node coefficients. In each plot, the triangles indicate
the firms with an increased betweenness centrality after the outbreak of the COVID-19.
More specifically, we identify the firms which moved from the 1st tercile of the betweenness
centrality distribution on the 17th January 2020 to the 3rd tercile on the 27th March 2020.
The negative impact of COVID-19 on edge existence (red color) uniformly affects the
firms with low and high centrality in the multilayer networks. This is also true for the
positive impact of COVID-19 (blue color) in the leverage linkages. The most interesting
findings concern the leverage and risk premium linkages. In the volatility linkages, there is
a positive relationship between the COVID-19 coefficients and the IN degree (last column
in the first row) which indicates that the connectivity of firms with higher IN degree is less
affected by COVID-19. Conversely, there is a negative relationship between the COVID-19

20

risk premium

leverage

volatility

betweenness

OUT degree

IN degree

return

Figure 10: Impact of the COVID-19 factors on financial linkages versus firm centrality,
across layers (columns) and centrality measures (rows). In each scatterplot: node centrality
on the 27th March 2020 (horizontal axis) versus the sum of the negative (blue) and positive
(red) node coefficients of a given variable (vertical axis). Filled triangles indicate firms that
moved from the 1st tercile of the betweenness centrality distribution on the 17th January
2020 to the 3rd tercile on the 27th March 2020. Only non-null coefficients are reported: blue
indicates positive impact on edge existence, red indicates negative impact on edge existence.
A coefficient is considered null if its posterior HPDI contains zero.
coefficients and the OUT degree (last column in the second row) which indicates that the
connectivity of firms with higher OUT degree is more affected by the COVID-19. Therefore,
firms with higher OUT degree become more prone in transmitting volatility shocks to the
system (last column, second row), with impact on other firms’ volatility and returns (second
column). Similar conclusions can be drawn by considering the effect of COVID-19 on firms
with large betweenness centrality (last column, last row).

21

5

Conclusion

In this paper, we have proposed a novel semiparametric framework for matrix-valued panel
data. The model has been applied to study multilayer temporal networks among European
financial firms (France, Germany, Italy). We measure the financial connectedness arising
from the interactions between two layers defined by assets returns and volatilities. The
connectivity effects are represented at four levels: (i) return linkages; (ii) volatility linkages;
(iii) risk premium linkages; and (iv) leverage linkages.
We have investigated the impact of COVID-19 on the structure of the network, which
represents an unprecedented case since no previous disease outbreak had affected the real
economy and the financial markets as the COVID-19 pandemic. There is evidence of the
explanatory power of COVID-19 for the connectivity of the European financial network
at firm and sector level (e.g., Industrial, Real Estate, and Health Care). The COVID-19
has a heterogeneous effect across layers, increasing the probabilities of volatility and risk
premium linkages while decreasing the probability of leverage linkages. Finally, our results
show a positive relationship between firm centrality and the number of its linkages that are
impacted by the COVID-19.
The network modeling of financial connectedness is a useful tool for policy-makers and
other authorities in monitoring the financial system. Moreover, despite being motivated by
and applied to a European financial network, the proposed econometric framework is general
and can be of interest for studying a wide spectrum of matrix-variate datasets emerging in
several fields of data science.

References
Acemoglu, D., Ozdaglar, A., and Tahbaz-Salehi, A. (2015). Systemic risk and stability in
financial networks. American Economic Review, 105(2):564–608.
Ahelegbey, D. F., Billio, M., and Casarin, R. (2016a).
22

Bayesian graphical models for

structural vector autoregressive processes. Journal of Applied Econometrics, 31(2):357–
386.
Ahelegbey, D. F., Billio, M., and Casarin, R. (2016b). Sparse graphical vector autoregression:
A Bayesian approach. Annals of Economics and Statistics, (123/124):333–361.
Bekaert, G. and Wu, G. (2000). Asymmetric volatility and risk in equity markets. The
Review of Financial Studies, 13(1):1–42.
Bernardi, M. and Costola, M. (2019). High-dimensional sparse financial networks through a
regularised regression model. SAFE Working Paper.
Bianchi, D., Billio, M., Casarin, R., and Guidolin, M. (2019). Modeling systemic risk with
Markov switching graphical sur models. Journal of Econometrics, 210(1):58–74.
Billio, M., Casarin, R., and Iacopini, M. (2018a).

Bayesian Markov switching tensor

regression for time-varying networks. University Ca’ Foscari of Venice, Dept. of Economics
WP N., 14.
Billio, M., Casarin, R., Kaufmann, S., and Iacopini, M. (2018b). Bayesian dynamic tensor
regression. University Ca’ Foscari of Venice, Dept. of Economics WP N., 13.
Billio, M., Casarin, R., and Rossini, L. (2019). Bayesian nonparametric sparse VAR models.
Journal of Econometrics, 212(1):97–115.
Billio, M., Getmansky, M., Lo, A. W., and Pelizzon, L. (2012). Econometric measures of
connectedness and systemic risk in the finance and insurance sectors. Journal of Financial
Economics, 104(3):535–559.
Boccaletti, S., Bianconi, G., Criado, R., Del Genio, C. I., Gómez-Gardenes, J., Romance,
M., Sendina-Nadal, I., Wang, Z., and Zanin, M. (2014). The structure and dynamics of
multilayer networks. Physics Reports, 544(1):1–122.

23

Carvalho, C. M., Massam, H., and West, M. (2007). Simulation of hyper-inverse Wishart
distributions in graphical models. Biometrika, 94(3):647–659.
Carvalho, C. M. and West, M. (2007). Dynamic matrix-variate graphical models. Bayesian
Analysis, 2(1):69–97.
Casarin, R., Iacopini, M., Molina, G., ter Horst, E., Espinasa, R., Sucre, C., and Rigobon, R.
(2020). Multilayer network analysis of oil linkages. The Econometrics Journal, 23(2):269–
296.
Chen, E. Y., Tsay, R. S., and Chen, R. (2019).

Constrained factor models for high-

dimensional matrix-variate time series. Journal of the American Statistical Association,
(forthcoming).
Diebold, F. X. and Yilmaz, K. (2009). Measuring financial asset return and volatility
spillovers, with application to global equity markets. The Economic Journal, 119(534):158–
171.
Diebold, F. X. and Yılmaz, K. (2014). On the network topology of variance decompositions:
Measuring the connectedness of financial firms. Journal of Econometrics, 182(1):119–134.
Elliott, M., Golub, B., and Jackson, M. O. (2014). Financial networks and contagion.
American Economic Review, 104(10):3115–53.
Frühwirth-Schnatter, S. (2006). Finite mixture and Markov switching models. Springer
Science & Business Media.
Garman, M. B. and Klass, M. J. (1980). On the estimation of security price volatilities from
historical data. Journal of Business, 53(1):67–78.
Geraci, M. V. and Gnabo, J.-Y. (2018). Measuring interconnectedness between financial
institutions with Bayesian time-varying vector autoregressions. Journal of Financial and
Quantitative Analysis, 53(3):1371–1390.
24

Golosnoy, V., Gribisch, B., and Liesenfeld, R. (2012). The conditional autoregressive Wishart
model for multivariate stock market volatility. Journal of Econometrics, 167(1):211–223.
Gouriéroux, C., Jasiak, J., and Sufana, R. (2009). The Wishart autoregressive process of
multivariate stochastic volatility. Journal of Econometrics, 150(2):167–181.
Gupta, A. K. and Nagar, D. K. (1999). Matrix variate distributions. CRC Press.
Harrison, J. and West, M. (1999). Bayesian forecasting & dynamic models. Springer.
IMF (2020). World Economic Outlook, October 2020: A long and difficult ascent. Technical
report.
Park, T. and Casella, G. (2008). The Bayesian Lasso. Journal of the American Statistical
Association, 103(482):681–686.
Uhlig, H. (1997). Bayesian vector autoregressions with stochastic volatility. Econometrica,
65:59–73.
Viroli, C. (2011). Finite mixtures of matrix normal distributions for classifying three-way
data. Statistics and Computing, 21(4):511–522.
Wang, G.-J., Yi, S., Xie, C., and Stanley, H. E. (2020). Multilayer information spillover
networks: Measuring interconnectedness of financial institutions. Quantitative Finance,
pages 1–23.
Wang, H. and West, M. (2009). Bayesian analysis of matrix normal graphical models.
Biometrika, 96(4):821–834.
Zhu, X., Pan, R., Li, G., Liu, Y., and Wang, H. (2017). Network vector autoregression. The
Annals of Statistics, 45(3):1096–1123.
Zhu, X., Wang, W., Wang, H., and Härdle, W. K. (2019). Network quantile autoregression.
Journal of Econometrics, 212(1):345–358.
25

A
A.1

Proof of the results in the paper
Model properties

Proof of Eq. 13.

2
P (Ylk,t |µlk , γlk
, αlk , βlk )

ZZ
=

2
2
2
P (Ylk,t |Blk,1 , . . . , Blk,R , σlk
)P (σlk
|αlk , βlk , qlk ) dσlk

2
· P (Blk,1 , . . . , Blk,R |µlk , γlk
, plk ) dBlk,1 . . . dBlk,R
ZZ
Mσn
X
2
2
2
|α̃m0 ,lk , β̃m0 ,lk ) dσlk
q̃m0 ,lk P (σlk
)
=
P (Ylk,t |Blk,1 , . . . , Blk,R , σlk
m0 =1
2
Mbn

·

X

2
p̃m,lk P (Blk,1 , . . . , Blk,R |µ̃m,lk , γ̃m,lk
) dBlk,1 . . . dBlk,R

m=1
n

=

n2

Mσ Mb
X
X

2
p̃m,lk q̃m0 ,lk P (Ylk,t |α̃m0 ,lk , β̃m0 ,lk , µ̃m,lk , γ̃m,lk
).

m0 =1 m=1

Since:

2
P (σlk
|αlk , βlk , qlk )

=

=

=

n
Y

2
P (σi,lk
|αlk , βlk , qlk )

i=1
n X
Mσ
Y

2
qm,lk P (σi,lk
|αm,lk , βm,lk )

i=1 m=1
Mσ
Mσ
X
X

...

i1 =1

n
Y

2
qiu ,lk P (σu,lk
|αiu ,lk , βiu ,lk ).

in =1 u=1

By relabeling the indices using the inverse lexicographic order:

u=1+

n
X
(i` − 1)Mσ`−1
`=1

one obtains
n

2
P (σlk
|αlk , βlk , qlk )

=

Mσ
X

2
q̃m0 ,lk P (σlk
|α̃m0 ,lk , β̃m0 ,lk ),

m0 =1

26

where

2
|α̃m0 ,lk , β̃m0 ,lk ) =
P (σlk

n
Y

2
|απ(i,m0 ),lk , βπ(i,m0 ),lk )
P (σi,lk

i=1

q̃m0 ,lk =

n
Y

qπ(i,m0 ),lk

i=1

with π mapping the pair of indices (i, m0 ) 7→ m, and m ∈ [1, Mσ ]. A similar argument applies
2
to P (Blk,1 , . . . , Blk,R |µlk , γlk
, plk ).

A.2

Posterior distributions

In the following, we provide the derivation of the full conditional distribution using the Gibbs
sampler.
The combination of the likelihood of the model in Eq. (1) and the mixture priors in
Eqs. (3)-(4) yields a high-dimensional integral with no closed-form solution. To address
this issue, we follow the data-augmentation principle and introduce two sets of latent
allocation variables in the set of observations, Dblk,r = {dbij,lk,r for i, j = 1, . . . , n}, for
l, k = 1, 2, r = 1, . . . , R, and Dσlk = {dσi,lk for i = 1, . . . , n}, for l, k = 1, 2. Denote
2
=
with αlk = (α1,lk , . . . , αMσ ,lk )0 , βlk = (β1,lk , . . . , βMσ ,lk )0 , µlk = (µ1,lk , . . . , µMb ,lk )0 , γlk
2
2
(γ1,lk
, . . . , γM
)0 . Thus, we obtain the data-augmented joint posterior distribution for the
b ,lk
2
parameters of the likelihood, Blk,r and σlk
, the first stage hyper-parameters αlk , βlk , µlk ,
2
and γlk
, the latent allocation variables Dblk,r , Dσlk , and the mixing probabilities, plk and qlk ,

with l, k = 1, 2, and r = 1, . . . , R, as:
2 Y
2 Y
Mσ
Y

P (αm,lk )P (βm,lk )P (qm,lk )

l=1 k=1 m=1
2 Y
n
2 Y
Y

·

Mb
Y

2
P (µm,lk )P (γm,lk
)P (pm,lk )

m=1
2
P (σi,lk
|αlk , βlk , dσi,lk )P (dσi,lk |qlk )

j=1 r=1

l=1 k=1 i=1

·

2 Y
2 Y
T
Y

n Y
R
Y

2
P (Ylk,t |ft , Blk,1 , . . . , Blk,R , σlk
)

l=1 k=1 t=1

27

2
P (bij,lk,r |µlk , γlk
, dbij,lk,r )P (dbij,lk,r |plk )

Full conditional distribution of bij,lk,r

The full conditional distributions of the
P
coefficients are given as follows. For each entry (i, j), define ij,lk,r,t = yij,lk,t − r0 6=r bij,lk,r0 fr0 ,t ,
thus obtaining


P (bij,lk,r |−) ∝ exp −

T
(bij,lk,r − µdbij,lk,r )2  Y

2γd2b

exp

 (

ij,lk,r,t

t=1

ij,lk,r

− bij,lk,r fr,t )2 
2
2σi,lk

∝ N (µ, γ 2 )

where

2

γ =

1



γd2ij,lk,r

T
2 −1
X
fr,t
+
σ2
t=1 i,lk

2
Full conditional distribution of σi,lk

 PT f 
µdij,lk,r 
t=1 r,t ij,lk,r,t
µ=γ
+
2
σi,lk
γd2ij,lk,r
2

The full conditional distributions of the noise

variances are given by
 βdσ 
exp − 2i,lk
σi,lk
T
R
R
 1
Y
X
X

2
2 −1
−n/2
0
· (σi,lk )
exp − tr diag(σlk ) (Ylk −
Blk,r fr,t ) (Ylk −
Blk,r fr,t )
2
t=1
r=1
r=1

2
2
P (σi,lk
|−) ∝ (σi,lk
)

−αdσ

i,lk

−1

T


1X
Tn
, βd˜i,lk ,lk +
Eii,lk,t
∝ IG αd˜i,lk ,lk +
2
2 t=1


where Elk,t = (Ylk,t −

P

r

Blk,r fr,t )0 (Ylk,t −

P

r

Blk,r fr,t ).

Full conditional distribution of dbij,lk,r and dσi,lk

The full conditional distributions of

the allocation variables are given by

2
P (dbij,lk,r = m|−) ∝ pm,lk N (bij,lk,r |µm,lk , γm,lk
)
2
P (dσi,lk = m|−) ∝ qm,lk IG(σi,lk
|αm,lk , βm,lk )

28

Full conditional distribution of pm,lk and qm,lk

The full conditional distribution of the

mixing probabilities for each mixture are


X
X
P (plk |−) ∝ Dir φb +
I(dbij,lk,r = 1), . . . , φb +
I(dbij,lk,r = Mb )
i,j,r

i,j,r



X
X
σ
σ
P (qlk |−) ∝ Dir φσ +
I(di,lk = 1), . . . , φσ +
I(di,lk = Mσ )
i

i

Full conditional distribution of µm,lk

For each m = 2, . . . , Mb , the posterior

distributions of the component-specific means are obtained as
µ2m,lk 
P (µm,lk |−) ∝ exp −
2s2


(bij,lk,r − µm,lk )2 
exp −
2
2γm,lk


Y
{i,j,r:dbij,lk,r =m}

∝ N (µ, s2 )

where

µ=s

2

X
{i,j,r:dbij,lk,r =m}

bij,lk,r
2
γm,lk

2

s =

2
Full conditional distribution of γm,lk

1
s2

+

1 −1

X
{i,j,r:dbij,lk,r =m}

2
γm,lk

For m = 1, since µ1,lk = 0, the posterior

distributions of the component-specific variances are obtained as
 γ2 
 b2

Y
1,lk
ij,lk,r
2
2
2
P (γ1,lk
|−) ∝ (γ1,lk
)a0 −1 exp −
(γ1,lk
)−1/2 exp − 2
b0
2γ1,lk
{i,j,r:dbij,lk,r =1}
P
b


X
2
i,j,r I(dij,lk,r = 1)
∝ GiG a0 −
, ,
b2ij,lk,r
2
b0
b
{i,j,r:dij,lk,r =1}

Instead, for each m = 2, . . . , Mb , the posterior distributions are
2
P (γm,lk
|−)

∝

2
(γm,lk
)−a1 −1



exp −

b1 
2
γm,lk

Y

2
(γm,lk
)−1/2

{i,j,r:dbij,lk,r =m}

29

(bij,lk,r − µm,lk )2 
exp −
2
2γm,lk


X
I(dbij,lk,r = m)
(bij,lk,r − µm,lk )2 
, b1 +
2
2
{i,j,r:dbij,lk,r =m}
P
b


X
i,j,r I(dij,lk,r = m)
∝ GiG − a1 −
, 0, 2b1 +
(bij,lk,r − µm,lk )2
2
b


P

i,j,r

∝ IG a1 +

{i,j,r:dij,lk,r =m}

Full conditional distribution of αm,lk

For m = 1, . . . , Mσ , the posterior distributions of

the component-specific shapes are obtained as
α

P (αm,lk |−) ∝

a2 −1
αm,lk

m,lk
αm,lk  βm,lk #{i:dσi,lk =m} 
exp −
b2
Γ(αm,lk )



Y

2
σi,lk

−αm,lk

{i:dσ
i,lk =m}

we sample from this distribution using an adaptive RWMH with proposal.

Full conditional distribution of βm,lk

For m = 1, . . . , Mσ , the posterior distributions of

the component-specific scales are given by

 β
a3 −1
m,lk
P (βm,lk |−) ∝ βm,lk
exp −
b3

Y
{i:dσ
i,lk =m}


 β
αm,lk
m,lk
βm,lk
exp − 2
σi,lk


∝ Ga a3 + αm,lk · #{i : dσi,lk = m}, b3 +

X
{i:dσ
i,lk =m}

B

Additional results

30

2
σi,lk



volatility

leverage

risk premium

return

SX5E

V2X

LECPOAS

NCOVEUR

5

5

5

5

4

4

4

4

3

3

3

3

2

2

2

2

1

1

1

1

0

0

0

0

-1

-1

-1

-1

-2

-2

-2

-2

-3

-3

-3

-3

-4

-4

-4

-4

-5

-5

-5

-5

5

5

5

5

4

4

4

4

3

3

3

3

2

2

2

2

1

1

1

1

0

0

0

0

-1

-1

-1

-1

-2

-2

-2

-2

-3

-3

-3

-3

-4

-4

-4

-4

-5

-5

-5

-5

5

5

5

5

4

4

4

4

3

3

3

3

2

2

2

2

1

1

1

1

0

0

0

0

-1

-1

-1

-1

-2

-2

-2

-2

-3

-3

-3

-3

-4

-4

-4

-4

-5

-5

-5

-5

5

5

5

5

4

4

4

4

3

3

3

3

2

2

2

2

1

1

1

1

0

0

0

0

-1

-1

-1

-1

-2

-2

-2

-2

-3

-3

-3

-3

-4

-4

-4

-4

-5

-5

-5

-5

Figure 11: Impact of risk factors (column) on financial linkages of the multilayer network.
In each plot, the coefficient in position (i, j) refers to the impact of the risk factor in column
on the edge from institution j to institution i. Only non-null coefficients are reported: blue
indicates positive impact on edge existence, red indicates negative impact on edge existence.
A coefficient is considered null if its posterior HPDI contains zero.

31

