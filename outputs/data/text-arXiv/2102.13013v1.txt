Optimising the mitigation of epidemic spreading through targeted adoption of contact
tracing apps
Aleix Bassolas,1, ∗ Andrea Santoro,1, ∗ Sandro Sousa,1 Silvia Rognone,1 and Vincenzo Nicosia1

arXiv:2102.13013v1 [physics.soc-ph] 25 Feb 2021

1

School of Mathematical Sciences, Queen Mary University of London, London E1 4NS, United Kingdom
(Dated: February 26, 2021)
The ongoing COVID-19 pandemic is the first epidemic in human history in which digital contacttracing has been deployed at a global scale. Tracking and quarantining all the contacts of individuals
who test positive to a virus can help slowing-down an epidemic, but the impact of contact-tracing
is severely limited by the generally low adoption of contact-tracing apps in the population. We
derive here an analytical expression for the effectiveness of contact-tracing app installation strategies
in a SIR model on a given contact graph. We propose a decentralised heuristic to improve the
effectiveness of contact tracing under fixed adoption rates, which targets a set of individuals to
install contact-tracing apps, and can be easily implemented. Simulations on a large number of realworld contact networks confirm that this heuristic represents a feasible alternative to the current
state of the art.
Keywords: SIR, contact tracing, optimal mitigation, dynamics on networks, distributed systems

Since the first human infection towards the end of
2019, the spread of the SARS-COV-2 virus has caused
an unprecedented shock around the world, with serious
repercussions in all aspects of our social and economic
activities [1–3], and a number of casualties that has already passed the two millions figure and is unfortunately
due to rise further in the near future [4]. The initial
efforts to curb the spread of the disease focused on nonpharmaceutical interventions including travel bans, lockdowns, and curfews[5]. These measures are able to drastically reduce the opportunities of contacts between infected and susceptible people and thus the spread of a
virus [6–10], but also have non-negligible effects on the
economy and social life [11–13]. After the first wave of
infections in February-May 2020 and thanks to a better
understanding of the specific transmission dynamics of
SARS-COV-2 [14–19], many countries have implemented
some sort of “test-trace-treat” system based on digital
contact tracing [20, 21]. Some of these systems consist
on deploying contact tracing (CT) apps on mobile phones
which allow to identify and isolate individuals who have
been in contact with infected ones, thus disrupting secondary infections paths as early as possible. With contact tracing in place, many countries have been able to
partially re-open several sectors of their economy and to
diminish the damage of prolonged disruptions [22–29]
An effective digital contact tracing strategy should aim
at maximising the probability of detecting contacts between infected and susceptible individuals, and it would
completely eradicate contagion in the ideal case where
CT apps are installed by the totality of a population [30–
39]. However, throughout the SARS-COV-2 pandemic
the percentage of the population with CT apps installed
has remained quite low, between 5% and 20% in most
countries [40], resulting in a dramatically decreased efficiency of contact-tracing.

∗

These authors contributed equally to this paper

Here we focus on the problem of determining the set of
nodes which should install CT apps in order to optimise
the effect of contact tracing, i.e., to maximally slow-down
spreading and reduce the incidence of a disease, under the
assumption that the rate of CT app adoption is fixed. We
provide an analytic derivation to quantify the decrease of
the basic reproduction number caused by a generic CT
installation strategy, and we show that uniform random
installation – which is the strategy implicitly adopted by
governments when people are simply asked to install a
CT app – has the worst performance of all. We find
that relatively simple targeting strategies based on the
structure of the contact network are significantly more
efficient in reducing the number of secondary infections
at low adoption rates, in both synthetic and real-world
systems.

RESULTS

In Fig. 1 we report a sketch of a fictious contact network, where some individuals are infected (pink), some
other are susceptible (black), and some have a CT app
installed (indicated by the mobile icon). A perfect lockdown would remove almost all the links in that graph
(with the only exception of those among people belonging to the same household), so that infected individuals
will eventually be unable to find any susceptible person
to pass the disease on. When only contact tracing is in
place, instead, some infections are still unavoidable, either due to a limited app adoption rate or to a delay in
the notification of test results and in isolation of subjects
exposed to infected ones. As made evident by Fig. 1,
maximising the impact of contact tracing corresponds to
maximising the probability that the potential transmission of the disease between two individuals is detected,
since only contacts among people with CT apps installed
can be detected and traced back. This intuitively corresponds to maximising the number of edges among the

2

Susceptible
Infected

Figure 1. Effect of contact-tracing apps on secondary
infections on a contact network. Contact tracing apps
can only detect potential contagious contacts if both the infected and the susceptible individual have a CT app installed.
In this case, A can in principle infect any of his direct neighbours, including B who has a CT app installed as well, and
the CT app cannot do anything to avoid this. However, if the
CT system detects a contact between A and B and then A
tests positive, then B can be contacted and put into quarantine, thus disrupting all the potential infection paths to the
direct contacts of B (solid green lines). If C has a contact
with A, instead, C has no way of knowing whether the contact resulted in an infection or not, he will not be notified
when A tests positive, and he will not go into quarantine.
In this case, all the neighbours of C are at risk of catching
the disease (solid red lines). Similarly, the fact that B has a
CT app installed cannot safeguard her from being infected by
D (who does not have a CT app installed) and passing the
infection to her neighbours while she has no symptoms.

individuals with CT app installed, i.e., the density of the
subgraph induced by the nodes with CT apps, under the
constraint that only a fraction r of the population will
have the CT app installed.
Reduction of R0 in a SIR+CT dynamics. We
consider here a SIR+CT model, which is a classical
Susceptible-Infected-Recovered (SIR) model on a static
contact graph [10], with the addition of ideal contact
tracing. This means that any susceptible node with installed CT app is quarantined (recovered) as soon as one
of their contacts with CT app installed gets infected. The
parameters of the model are the probability β that an infected individual passes the disease to each of its susceptible neighbours, and the probability µ that an infected
individual is removed (due to either recovery or death).
We call the contact graph G(V, E), with N = |V | nodes
and K = |E| edges, and we denote by G0 (V 0 , E 0 ) the subgraph of G induced by CT app installations, i.e., such
that V 0 is the set of nodes in G with CT apps and E 0
is the set of edges among nodes in V 0 . We quantify the
effect of the installation of CT apps in a certain subset

V 0 of nodes by computing the reduction of the basic reproduction number R0 , that is the expected number of
secondary infections caused by a single contagion event.
Let us assume that the generic node ` is infected and
has passed the disease to its neighbour i. The expected
number Ri of secondary infections caused by i while it remains infected depends on whether i is in V 0 , and on how
many of its ki neighbours are in V 0 as well. In particular,
if i ∈
/ V 0 , Ri = βµ (ki −1) as in the classical SIR (we have to
remove ` from the count, hence the ki − 1) [10]. If i ∈ V 0 ,
instead, there are two possible cases: a) if ` ∈
/ V 0 , the
contact between ` and i remains undetected, and i can
potentially infect Ri = βµ (ki − 1) more nodes, as in the
classical SIR. b) If instead ` ∈ V 0 as well, then the contact
with i gets detected by the CT system and i goes into
self-isolation immediately, thus avoiding any secondary
infection. If we denote by ki0 the degree of node i in G0 ,
the expected number of infections potentially caused by
the infection of i is equal to
Ri =

β
ki − ki0
(ki − 1)
µ
ki

and the average number of secondary infections potentially caused by each node infected by ` is given by:
R` =

ki − ki0
β 1 X
a`i (ki − 1)
µ k` i
ki

where a`i are the entries of the adjacency matrix of the
contact graph G. By averaging R` over all the nodes of
G we obtain the value of the basic reproduction number
in presence of contact tracing (see Methods for details):
R00 = R0 −

1 β
N µ

1
` k`

P

P

i

k0

a`i kii (ki − 1)

(1)

where R0 is the basic reproduction number of the classical SIR dynamics on G [10]. As made clear by Eq. (1),
we can minimise the value of R00 by using a generic optimisation algorithm to compute:
max
0
G

F(G0 ) =

X 1 X k0
a`i i (ki − 1)
k` i
ki

(2)

`

over the ensemble of possible choices of G0 . Notice that
if the entire population installs CT apps (i.e., if ki0 =
ki ∀i ∈ V ) we trivially get R00 = 0 (see Methods and
Supplementary Note 1 for details).
CT targeting strategies. If we assume that we can install the contact tracing app only to a fraction r ∈ [0, 1]
of “willing” individuals, Eq. (2) states that a good CT
installation strategy should include in G0 nodes having
a high degree in G (so that the ratio (kik−1)
is as large
i
as possible), and, at the same time, a high number of
connections to other nodes in G0 (i.e., so that ki0 is as
large as possible). The most basic strategy to select a
fraction r of the N individuals to install CT apps consists in asking the population to install a CT app in their

3

RND

6

a

DEG

DEG theo

DTI

b

k0
0.0 0.2 0.4 0.6 0.8 1.0

r

(k 0)2

4

R00 /R0

1.0
0.8
0.6
0.4
0.2
0.0

RND theo

2
0

0.0 0.2 0.4 0.6 0.8 1.0

r

80
60
40
20
0

SA

c

0.0 0.2 0.4 0.6 0.8 1.0

r

Figure 2. Effect of different CT strategies on the induced subgraph as a function of app adoption rate r. (a) The
ratio R00 /R0 as a function of the CT adoption rate r for the Random (RND), degree-based (DEG), distributed targeting (DTI),
and Simulated Annealing (SA) strategies, calculated using Eq. (1). (b) Average degree of G0 as a function of the adoption
rate r for each of the strategies. The theoretical predictions for the RND and DEG strategies (solid lines) were obtained using
Eq. (7) and Eq. (17), respectively. (c) Second moment of the degree distribution of G0 as a function of the adoption rate r for
each of the strategies. The plots correspond to an ensemble of configuration model graphs with degree distribution P (k) ∼ k−3
and N = 104 nodes. Results averaged over 100 realisations.

mobile phones, under the assumption that each individual will comply with probability equal to r, irrespective
of any of their specific social or behavioural characteristics. In this case, the total number of installations will
be distributed according to a Binomial, with mean equal
to rN . In the following, we call this strategy “uniform
random installation” (RND).
A second strategy consists in explicitly targeting all
the potential super-spreaders [41, 42]. In practice, we
ask the rN individuals with the largest number of contacts (links) in G to install the app, assuming that they
will all comply with probability 1. This strategy is indeed
utopistic since it requires full knowledge of the contact
network and full compliance by the selected nodes. In
the following, we call this strategy “degree-based installation” (DEG).
Here we propose and study a constructive strategy to
maximise Eq. (2) that does not require detailed global
information on G, and is thus amenable to a distributed
implementation. We start from a CT set that contains
only the node with the largest degree in G. Then, at
each subsequent step t we add to the CT set one of the
neighbours i of any of the nodes in V 0 , with probability
proportional to the total number of neighbours of that
node that are already in V 0 (see Methods for details).
This creates a “social pressure” on individuals with no
CT app installed which is proportional to the number
of their contacts already in V 0 . We call this strategy
“distributed targeting installation” (DTI).
R0

In Fig. 2(a) we plot the ratio R00 as a function of
the CT adoption rate r for the RND, DEG, and DTI
strategies, on an ensemble of configuration model graphs
with power-law degree distributions. As a reference, we
also report the results obtained by optimising Eq. (2)
by means of Simulated Annealing (SA). It is worth not-

ing that RND is the worst-performing strategy overall,
characterised by a much slower decrease of R00 with r.
Conversely, degree-based installation is close to the theoretical limit established by SA, and produces a noticeable
decrease of R0 already for quite small values of r. Remarkably, the performance of DTI is quite close to that of
DEG, although DTI is not using any global information
about the structure of G. In Fig. 2(b-c) we show how
the first and second moment of the degree distribution
Pe(k 0 ) of the subgraph G0 vary with r for each of the four
strategies. More details on the derivation of the full degree distribution of G0 in RND and DEG are reported in
Methods, while Supplementary Fig. 1 shows the perfect
agreement between the empirical and analytical degree
distributions for these two strategies.
It is worth noting that under the DEG strategy hk 0 i
increases very sharply with r and is already quite similar
to the value of hki in G for very small values of r. On
the other hand, in RND hk 0 i increases only linearly with r
(see Methods for details), while the performance of DTI is
in between those two. However, these plots make it clear
that the sheer density of G0 is not the only important
ingredient for CT app installation. Indeed, SA can attain
R0
consistently lower values of R00 than DEG, although the
values of hk 0 i produced by SA are almost identical to that
provided by DEG (see Fig. 2b).
SIR+CT in real-world graphs. In Fig. 3 we show the
ratio of infected nodes I(t) for the four strategies with
different values of r on two real-world contact networks,
respectively the network of friendship in a high school
(top panels) and at a workplace (bottom panels)[43]. In
the inset of each panel we report a typical composition
of V 0 for each strategy. It is evident that, even at low
adoption rates, the DEG and DTI strategy can heavily
mitigate the incidence of the disease better than RND.

4

r = 0.3
No App
App

Figure 3. Impact of CT strategy and adoption rate on the epidemic peak of SIR+CT in real-world networks.
The evolution of the disease in a SIR+CT model (here for β = 0.1, µ = 0.05) depends heavily on the adoption rate r and on
the strategy used to select which individuals will have a CT app installed. We show here the results on two real-world social
networks, namely, the high-resolution face-to-face contact data respectively recorded in a high school (a-d) and a workplace
(e-h). We have applied a threshold to both contact networks: keeping only contacts larger than 240 seconds for the High School
and 10% of the links with the largest weight for the Workplace (See Methods for details). At adoption rates r & 0.4, the RND
strategy (a, e) displays a higher percentage of infected compared to DTI (b, f), DEG (c, g) and SA (d, h). These differences are
likely linked to the structure of the subgraph induced by each CT strategy. Typical examples of those graphs for each strategy
and r = 0.3 are shown in the insets, where the size of each node is proportional to its degree and nodes with CT app installed
are indicated in blue.

This is most probably because DEG and DTI are targeting different sets of nodes than RND, and in general
end up selecting nodes with high degree which result in
a higher edge density in G0 .
The dynamics of SIR+CT in the two systems exhibits some noticeable qualitative differences when distinct strategies are adopted, with respect to the height
of the infection peak (the maximum incidence of the disease), the actual position of the peak (the time at which
it occurs), and the overall duration of the epidemic. Interestingly, the position of the peak shifts to the right
(delays) at small values of r for the DEG, DTI and SA
strategies. Conversely, the peak starts to recede (it is anticipated) with respect to the baseline when r becomes
larger than a certain threshold, which depends on the
particular structure of the contact network. While low
values of r lead to a delay in the dynamics – the peak
shifts to the right – large enough values of r effectively
break the network into a number of disconnected components, resulting in a considerable disruption of the
spreading – shift to the left.
To better understand these qualitative differences, we
look at three key properties of the epidemic curve, namely
the total number of individuals recovered R∞ , the maximum number of individuals infected across the duration
of the epidemic I(tpeak ) and the time to reach the infection peak tpeak . In particular, we compute the relative performance of each strategy s (being it either DEG,

DTI, and SA) with respect to RND using the quantities:
s
=1−
∆R∞

∆I s (tpeak ) = 1 −
∆tspeak

=1−

s
R∞
RND
R∞
Its

peak

I RND (tpeak)
tspeak
tRND
peak

(3)

The results are shown in Fig. 4. We found that in the
high school network an adoption rate of r = 0.2 can decrease the number of infected individuals at the peak by
as much as 40% (Fig. 4b) for all the three strategies.
At the same adoption rate, the total number of infected
individuals decreases by 20% (Fig. 4a) and the peak is
delayed by approximately 40% (Fig. 4c). For r = 0.5
we witness a substantially stronger mitigation, where the
peak is reduced by up to 70% and the total number of
infected is reduced by up to 80%. The effectiveness of
targeting strategies is somehow less pronounced in the
workplace graph at similar adoption rates (bottom panels). Interestingly, in both networks the DTI strategy
performs similarly to DEG and SA, as can be observed
in the insets in Fig. 4, which show the raw values of R∞ ,
I(tpeak ) and tpeak .
We simulated SIR+CT in 84 unique real-world contact network data sets, filtered by applying two different
thresholds, for a total of 168 undirected graphs [43–50]
(See Methods for details). In Fig. 5(a-c), we report for
the RND, DEG and DTI strategies, and several adoption
rates r, the spearman correlation between the analytical
R00 and the epidemiological indicators R∞ , I(tpeak ) and

5

0.4

0.6

0.8

d

1.0
0.5
0.0

0.4

0.0

0.4

I(tpeak)

R

0.6

0.8

0.2
0.0

0.0

0.2

0.4

r

0.6

0.8

0.8

0.0

0.0

0.2

0.4

tpeak
0.0

0.4

0.6

0.8

0.6

0.8

1.0

e

0.6

0.5

0.3
0.0

0.4

0.0

0.4

0.8

0.2
0.0

1.0

20

0.0

0.2

0

0.4

0.0

0.6

0.4

0.8

0.8

f

30
15
0

0.0

0.0

0.4

0.8

0.5
0.0

0.2

0.4

r

0.6

0.8

1.0

0.0

High School 2011

0.0

0.8

40

0.5

0.2

Workplace-InVS15

0.2

0.4

0.2

0.0

tpeak

R
0.0

0.0

R

0.8

0.0

0.4

tpeak

0.0

0.4

0.4

tpeak

0.2

c

0.5

0.6
I(tpeak)

0.8

1.0

b

0.8

I(tpeak)

0.4

I(tpeak)

0.6

R

a

RND
DEG
DTI
SA

0.8

0.2

0.4

r

0.6

0.8

Figure 4. Comparison of epidemic indicators under different CT strategies. Relative decrease with respect to random
s
installations of the total number of recovered ∆R∞
, height of the infection peak ∆I s (tpeak ) and position of the peak ∆tspeak
(see Eq. (3)) for DTI, DEG, and SA targeted installation, in the same contact networks shown in Fig. 3. The inset of each
panel reports the plot of the raw variable, respectively R∞ (panel a and d), I(tpeak ) (panel b and e) and tpeak (panel c and f).

tpeak . The correlation with both R∞ and I(tpeak ) is high
for the three strategies confirming the analytical predictions of Eq. (1) despite the small size of the graphs and
the presence of degree-degree correlations. Still, as r increases we observe a decrease in the correlations, likely
due to finite size effects. The correlation between R00 and
tpeak displays a much richer behaviour: we start with
a significant but negative correlation for small r, which
changes sign until it reaches a maximum. We conjecture that the change of sign is related to the movement
of the peak: while in the small-r regime lower values of
R00 contribute to a delay of the peak, for larger values
of r we observe a stronger anticipation of the peak. The
value rpeak at which the correlation peaks depends on the
strategy in use, the more efficient it is, the lower is the
value of rpeak . The concrete value of rpeak seems thus
related to a certain structural cutoff of the graphs.
In a realistic scenario, in which the adoption rate is
not fixed but needs to be promoted, we might be more
interested in the minimum adoption rate r∗ needed on
each network to obtain a given reduction of the infection
peak with respect to the absence of contact tracing. In
Fig. 5(d-f) we report the histograms of the value of r∗
in DTI and RND across the 168 networks when we set
a reduction in the peak I(tpeak ) of 10%, 30% and 50%,
respectively. We found that DTI can achieve a reduction of 30% of the peak in 85% of the networks with an
adoption rate smaller than 0.3 (panel e), while the RND
strategy would need an adoption rate of 0.5 to achieve
an equivalent reduction.
While the strategies analysed here require some level
of global information and full compliance by individuals
to install the app, we have obtained qualitatively similar
results with other decentralised strategies based on local

information, and with a tunable level of compliance (see
Supplementary Note 2 and Supplementary Figs. 2-7 for
details). Moreover, qualitatively similar results are also
obtained when considering a SIR+CT with maximum
delay, i.e., where an individual with the CT app installed
goes into quarantine only when it becomes infected (see
Supplementary Note 3 and Supplementary Figs. 7-9).
Conclusion. We have shown here that the random CT
app installation – considered in recent studies on the
topic [36–38] and adopted by many governments – is the
less effective strategy to mitigate the effects of a pandemic through contact tracing. The theoretical argument
presented here, which links the reduction of R0 to the
structure of the subgraph G0 induced by CT, holds for
any graph under any CT strategy. In particular, Eq. 1
provides a concrete recipe to maximise the effectiveness
of a CT app deployment as we have shown in real-world
systems.
The reduction of a disease incidence attainable by the
DTI strategy is comparable with degree-based targeting, which performs similarly to the optimal targeting
obtained through simulated annealing. A notable advantage of using DTI over DEG is that it does not require
any global information about the graph G and it can be
implemented on a distributed manner. For instance, one
could ask every new individual who installs the CT app
to broadcast a message to all his contacts, asking them
to install it as well. By doing so, each contact with no
app installed will be subject to a level of “social pressure”
linearly proportional to the number of contacts who already have the CT app installed (in agreement with the
heuristic algorithm of which DTI is based), consequently
increasing the likelihood that he will also install it.
Although several effective vaccines have been made

6

RND

Spearman

1.0 a
0.6
0.2
0.2
0.6

DEG

c

R
I(tpeak)
tpeak
0.2

0.4

0.8 d

r

0.6

0.8

10% peak reduction
RND
DTI

0.6

P(r )

DTI

b

0.2

e

0.4

r

0.6

0.8

30% peak reduction

0.2

f

0.4

r

0.6

0.8

50% peak reduction

0.4
0.2
0.0
0.0

0.2

0.4

r

0.6

0.8

0.0

0.2

0.4

r

0.6

0.8

0.0

0.2

0.4

r

0.6

0.8

Figure 5. Correlations with network structural measures and performance of CT strategies to mitigate an
epidemic. For the 168 real-world contact networks analysed, panels (a-c) report as a function of r the Spearman rank
s
correlation between the analytical value of R00 (Eq. (1)) and the epidemiological indicators R∞
(purple), I s (tpeak ) (orange) and
tspeak (blue) for the RND (a), DEG (b) and DTI (c) strategies. Panels (d-f) show the distribution of minimum adoption ratios
r∗ needed to produce a 10% (d), 30% (e) and 50% (f) for the DTI (red) and RND (green) strategies. Overall, DTI largely
outperforms RND, which is the strategy currently adopted by many governments.

available recently [51], mass vaccination campaigns are
at their initial stage in many countries and might last
for several months before a sufficient percentage of the
population is vaccinated. Moreover, SARS-COV-2 variants may develop vaccine resistance and prolong the duration of the epidemic, creating an unsustainable loop of
vaccine updates and vaccination campaigns. Hence, reducing the spreading of the virus by detecting potential
infected individuals and limiting their contacts – through
digital contact tracing – is still essential [52]. The results
shown here suggest that governments could significantly
improve the effectiveness of contact tracing programs by
implementing targeting CT app installations, not only for
the ongoing COVID-19 but any major epidemic event in
the future.

METHODS
Distributed Targeting Installation strategy

The proposed heuristic constructive algorithm to optimise Eq. (1), denominated DTI, starts with a set V 0 (t =
0) containing the node of largest degree in G. At each
step t, we consider the set S(t) of nodes which have at
least one neighbour in V 0 (t), then, a node i is selected at

t + 1 from S(t) and added to V 0 (t) with probability:
P
j ∈ V 0 (t)aij
P
P (i; t) = P
(4)
i∈S(t)
j∈V 0 (t) aij
i.e., node i is selected linearly proportional to the number
of neighbours it has in V 0 (t).
Properties of the subgraph induced by app
installation

We provide here a sketch of the derivation of the first
two moments of the degree distribution of the subgraph
G0 obtained from a graph G by considering only the
nodes which have the contact-tracing app installed and
the edges among them. The full derivations are provided
in Supplementary Note 1. In the case of random installation strategy, the probability that a node installs the
contact tracing app is uniform across all nodes. As a consequence, the probability that a node with degree k in G
has degree k 0 in G0 is given by the Binomial distribution:
 
0
k k0
0
0
P rob(ki = k |ki = k) =
r (1 − r)k−k .
(5)
0
k
This means that the expected degree in G0 of a node that
has degree k in G is just:
E [ki0 ] = rki

(6)

7
The degree distribution of the subgraph G0 can be obtained by summing the probability in Eq. (5) over all
possible values of k, from which we obtain:
PeRND (k 0 ) =

N
−1 
X
k=0


0
k k0
r (1 − r)k−k
k0

Pe(k 0 ) =

N
−1
X

j PeRND (j) = rhkiG

(7)

j=0

and:
2

hk iRND =

N
−1
X

1
PeDEG (k 0 ) = Pe(k 0 )
r

j PeRND (j) = r2 hk 2 iG +r(1−r)hkiG . (8)

j=0

To compute the degree distribution of G for degreebased installations, we start from the observation that
a node is in G0 only if its degree is ki ≥ e
k, where e
k is
obtained by solving the inequality:
P (k) ≥ r

(9)

rN
−1
X

where P (k) is the degree distribution of G. Now, the
probability that one of the ki neighbours of i is in G0 is
equal to:
N
−1
X

P (k|ki )

(10)

k=e
k

k0 =0

qk = re ∀i

(11)

k=e
k

In the absence of degree-degree correlations, the probability of any two nodes to be connected does not depend
on their degree, by definition. Hence, the probability
that a node of G0 has a degree equal to k 0 is given again
by the Binomial distribution:
 
0
k k0
0
0
P rob(ki = k |ki = k) =
re (1 − re)k−k , k ≥ e
k
k0
(12)
0
0
e
while P rob(ki = k |ki = k) = 0 if k < k. In particular,
this means that the expected value E [ki0 ] is equal to:
E [ki0 ] = reki

k =0

k=e
k

N −1
1 X
=
P (k) = 1
r
k=e
k

(16)
The average degree in the induced graph is obtained
as follows:
hkiDEG =

rN
−1
X

k 0 PeDEG (k 0 )

k0 =0

where P (k|ki ) is the conditional probability of finding in
G a node with degree k by following one of the edges of a
node with degree ki , chosen uniformly at random. In the
special case of graphs with no degree-degree correlations,
(k)
= qk , so we have:
P (k|k 0 ) = kPhki
N
−1
X

(15)

 
rN −1 N −1
0
0
k
1 X X
PeDEG (k 0 ) =
P (k) 0 rek (1 − re)k−k
k
r 0
k =0 k=e
k
rN
−1  
N
−1
X
X
0
k k0
1
re (1 − re)k−k
P (k)
=
0
k
r
0

e
k

Qek (i) =

(14)

It is easy to show that PeDEG (k 0 ) is correctly normalised:

0

Qek (i) =

 
0
0
k
P (k) 0 rek (1 − re)k−k
k

Here Pe(k 0 ) represents the probability to find a node of
G which has degree k 0 in the subgraph induced by app
installations. To obtain the actual degree distribution in
the induced subgraph, i.e., the probability that one of the
nodes of G0 has degree k 0 , we must rescale Pe(k 0 ) to the
nodes in G0 , i.e., we consider the probability distribution:

2

N
X

N
−1
X
k=e
k

Finally, for the first two moments of PeRND (k 0 ) we get:
hkiRND =

Notice that re has the same role that r has in the equations
for uniform random installation. With an argument in all
similar to that used for random installation, we obtain:

rN
−1  
N −1
X
0
0
k
1 X
k 0 0 rek (1 − re)k−k
P (k)
=
k
r
0

=

1
r

k=e
k
N
−1
X

k =0

P (k)ke
r=

k=e
k

N −1
re X
re2
kP (k) = hki
r
r
k=e
k

(17)
PN −1
where we have used the fact that k=ek kP (k) = rehki
as per the definition of re in Eq. (11). Similarly, for the
second moment we obtain:
hk 2 iDEG =

N
−1
X

2
k 0 PeDEG (k 0 )

k0 =0

 
N −1
rN
−1
X
0
0
1 X
02 k
=
P (k)
k
rek (1 − re)k−k
0
r
k
0
k=e
k

k =0

N −1


1 X
P (k) ke
r + k(k − 1)e
r2
=
r
k=
 ek

N
−1
2
X
re 
=
(1 − re)hki +
k 2 P (k)
r
k=e
k

(13)

(18)

8
Reduction of R0 under ideal CT.

We derive here a general expression for the effective
value of the expected number of secondary infections
caused by a single infection in a graph with perfect contact tracing, under the assumption that a fraction r of the
nodes has installed a CT app. Assuming that a generic
node ` is infected, we want to estimate what is the number of secondary infections caused by a node i infected
by `. The number of neighbours Ri that can be infected
by i depends on whether i has the CT app installed, and
on how many of its neighbours have their app installed.
In particular, if i does not have the app, Ri = βµ (ki − 1),
since we have to remove the neighbour from which i got
the disease. If i has a CT app installed, instead, there
are two possible cases:
1. If the node ` who infected i has the CT app, then
the infection has been “detected” by the app and
i goes into self-isolation immediately. If this happens, i will not produce any secondary infection in
the graph
2. If i got infected by a neighbour without CT app,
then the infection remains undetected, and i can
potentially infect Ri = βµ (ki − 1) more nodes.
So in the end, the expected number of infections potentially caused by the infection of i is:
Ri =

β
ki − ki0
(ki − 1)
µ
ki

(19)

k −k0

where the term iki i is the probability that the infection
of node i does not get detected by the CT system. Hence,
the expected number of secondary infections potentially
caused by ` is given by:
β 1 X
ki − ki0
R` =
a`i (ki − 1)
(20)
µ k` i
ki
where a`i are the entries of the adjacency matrix of G.
By averaging R` over all the nodes of the graph we get
the value of the basic reproduction number with contact
tracing:
β X 1 X
R00 =
a`,i Ri
µN
k` i
`
β X 1 X
ki − ki0
=
a`i (ki − 1)
µN
k` i
ki
"`
(21)
X
X
1
β
a`i (ki − 1)−
=
µN
k` i
`
#
X 1 X k0
i
a`i (ki − 1)
k` i
ki
`

This equation holds in general for any graph with any
CT strategy. Notice that the quantity:
1 X 1 X
a`i (ki − 1)
(22)
N
k` i
`

is the expected excess degree of the neighbours of a randomly sampled node of G. In other words, it is equal to
hknn (i)i − 1, where knn (i) is the average degree of the
neighbours of node i. The basic reproduction number of
the original graph G is equal to
R0 =

β 1 X 1 X
a`i (ki − 1)
µN
k` i

(23)

`

that is, the average degree of the neighbours of a randomly selected nodes of G, multiplied by βµ . Hence we
can conveniently rewrite Eq. (21) as:
R00 = R0 −

1 β X 1 X ki0
a`i (ki − 1)
Nµ
k` i
ki

(24)

`

In the special case when G has no degree-degree correlations, we have:
hknn (i)i =

hk 2 i
hki

∀i

(25)

hence we can write:


β hk 2 i
−1
R0 =
µ hki
nc

(26)

and we can rewrite Eq. (21) as:
"
#
2
1 X 1 X ki0
0 nc β hk i
−1−
a`i (ki − 1) (27)
R0 =
µ hki
N
k` i
ki
`

As expected, the effect of contact tracing is to reduce
the basic reproduction number of the original graph. In
general, Eq. (24) (or Eq. (27) in uncorrelated graphs)
provides a recipe to maximise the impact of CT app installation. Indeed, given a certain adoption rate r, we can
use any optimisation algorithm to maximise the fitness
function
X 1 X k0
0
max
F(G
)
=
a`i i (ki − 1)
(28)
G0
k` i
ki
`

over the ensemble of of the possible choices of G0 . Notice
that F(G0 ) can be decomposed in two terms. The first
one is
X 1 X
a`i ki0
(29)
k` i
`

that is, the sum of the expected degrees in the induced
subgraph G0 of the neighbours of nodes in G, while the
second one is:
X 1 X k0
a`i i
(30)
k` i
ki
`

i.e., the sum of the average fraction of degree in G0 and
degree in G of all the neighbours of nodes in G. In the following we denote the fraction of degree in G0 and degree
k0
in G for node i by ci = kii

9
Data description and set of networks studied

In this work we considered 84 unique contact network
data sets constructed from two different types of data:
(i) temporal network data, which provide information
regarding the different contacts between individuals and
the duration of each interaction; (ii) static network data,
where the contacts have been already aggregated for the
whole duration and a corresponding weight is associated
to each link. We reconstructed each network considering
two distinct filtering thresholds by either time – in seconds for type (i) – or by fraction of links retained – weight
values for type (ii) –, resulting in 168 unique graphs.
For the networks of type (i), we considered a hospital [45] and a high school [53] temporal data sets, from
which we filtered the contacts by applying thresholds of
240 and 360 seconds, i.e., each temporal snapshots resulted in a distinct network. For an art gallery [54] we
used the thresholds of 0 and 20 seconds. Notice that
we selected these threshold values since they provide the
largest connected component for each network. The type
(ii) networks obtained from the “Sociopatterns” project
include the contacts between individuals with a weight
that corresponds to either the number of contacts or their
duration [43, 47, 48]. Given that most type (ii) networks
are densely connected and a significant proportion of the
weights have small values, we filter the networks by keeping the top 25% and 10% links with the largest weights.

[1] McKibbin, W. & Fernando, R. The economic impact
of covid-19. Economics in the Time of COVID-19 45
(2020).
[2] McKibbin, W. J. & Fernando, R. The global macroeconomic impacts of covid-19: Seven scenarios (2020).
[3] Holman, E. A., Thompson, R. R., Garfin, D. R. & Silver,
R. C. The unfolding covid-19 pandemic: A probabilitybased, nationally representative study of mental health in
the united states. Science advances 6, eabd5390 (2020).
[4] Mega, E. R. Covid has killed more than one million
people. how many more will die? Nature (2020).
[5] Perra, N. Non-pharmaceutical interventions during the
covid-19 pandemic: A review. Physics Reports (2021).
URL https://www.sciencedirect.com/science/article/pii/S0370157321000624.
[6] Balcan, D. et al. Multiscale mobility networks and the
spatial spreading of infectious diseases. Procs. Natl.
Acad. Sci. U.S.A. 106, 21484–21489 (2009).
[7] Riley, S. Large-scale spatial-transmission models of infectious disease. Science 316, 1298–1301 (2007).
[8] Ferguson, N. M. et al. Strategies for containing an emerging influenza pandemic in southeast asia. Nature 437,
209–214 (2005).
[9] Colizza, V., Barrat, A., Barthelemy, M., Valleron, A.J. & Vespignani, A. Modeling the worldwide spread of
pandemic influenza: baseline case and containment interventions. PLoS Medicine 4 (2007).

A list of all networks considered here is reported in Supplementary Material Table 1.

ACKNOWLEDGEMENTS

A.B. and V.N. acknowledge support from EPSRC New
Investigator Award grant no. EP/S027920/1. A.S.
and V.N. acknowledge support from the EPSRC Impact
Acceleration Award – Large Award Competition programme. This work made use of the MidPLUS cluster, EPSRC grant no. EP/K000128/1. This research
used Queen Mary’s Apocrita HPC facility, supported by
QMUL Research-IT. doi.org/10.5281/zenodo.438045.

AUTHOR CONTRIBUTIONS

All the authors conceived the study. A.B. and A.S. performed the numerical simulations, analysed the results,
and prepared the figures. S.S. and S.R. contributed to
the methods for the analysis of the results and prepared
the figures. V.N. provided methods for the analysis of
the results and performed the analytical derivations. All
the authors wrote the manuscript and approved it in its
final form.
COMPETING INTERESTS

The authors declare no competing interests.

[10] Pastor-Satorras, R., Castellano, C., Van Mieghem, P. &
Vespignani, A. Epidemic processes in complex networks.
Rev. Mod. Phys. 87, 925–979 (2015). URL https://link.aps.
org/doi/10.1103/RevModPhys.87.925.
[11] Flaxman, S. et al. Estimating the effects of nonpharmaceutical interventions on covid-19 in europe. Nature 584, 257–261 (2020).
[12] Cowling, B. J. et al.
Impact assessment of nonpharmaceutical interventions against coronavirus disease
2019 and influenza in hong kong: an observational study.
The Lancet Public Health (2020).
[13] Peak, C. M., Childs, L. M., Grad, Y. H. & Buckee,
C. O. Comparing nonpharmaceutical interventions for
containing emerging epidemics. Proceedings of the National Academy of Sciences 114, 4023–4028 (2017).
[14] Arenas, A. et al. Modeling the spatiotemporal epidemic
spreading of covid-19 and the impact of mobility and
social distancing interventions. Physical Review X 10,
041055 (2020).
[15] Chang, S. et al. Mobility network models of covid-19 explain inequities and inform reopening. Nature 1–8 (2020).
[16] Di Domenico, L., Pullano, G., Sabbatini, C. E., Boëlle,
P.-Y. & Colizza, V. Impact of lockdown on covid-19 epidemic in ı̂le-de-france and possible exit strategies. BMC
medicine 18, 1–13 (2020).
[17] Wiersinga, W. J., Rhodes, A., Cheng, A. C., Peacock,
S. J. & Prescott, H. C. Pathophysiology, transmis-

10

[18]

[19]
[20]

[21]

[22]

[23]

[24]
[25]

[26]

[27]
[28]

[29]

[30]

[31]

[32]

[33]

[34]

[35]

sion, diagnosis, and treatment of coronavirus disease 2019
(covid-19): a review. Jama 324, 782–793 (2020).
Haug, N. et al. Ranking the effectiveness of worldwide
covid-19 government interventions. Nature human behaviour 4, 1303–1312 (2020).
Aguilar, J. et al. Impact of urban structure on covid-19
spread. arXiv preprint arXiv:2007.15367 (2020).
Rodrı́guez, P. et al. A population-based controlled experiment assessing the epidemiological impact of digital
contact tracing. Nature Communications 12, 1–6 (2021).
Bradshaw, W. J., Alley, E. C., Huggins, J. H., Lloyd,
A. L. & Esvelt, K. M. Bidirectional contact tracing could
dramatically improve covid-19 control. Nature communications 12, 1–9 (2021).
Aleta, A. et al. Modelling the impact of testing, contact tracing and household quarantine on second waves
of covid-19. Nature Human Behaviour 4, 964–971 (2020).
Panovska-Griffiths, J. et al. Determining the optimal
strategy for reopening schools, the impact of test and
trace interventions, and the risk of occurrence of a second
covid-19 epidemic wave in the uk: a modelling study. The
Lancet Child & Adolescent Health 4, 817–827 (2020).
Cohen, J. & Kupferschmidt, K. Countries test tactics in
‘war’against covid-19 (2020).
Abueg, M. et al. Modeling the combined effect of digital exposure notification and non-pharmaceutical interventions on the covid-19 epidemic in washington state.
medRxiv (2020).
Jiang, T. et al. A survey on contact tracing: the
latest advancements and challenges. arXiv preprint
arXiv:2011.02094 (2020).
Kerr, C. C. et al. Controlling covid-19 via test-tracequarantine. medRxiv (2020).
Kucharski, A. J. et al. Effectiveness of isolation, testing, contact tracing, and physical distancing on reducing
transmission of sars-cov-2 in different settings: a mathematical modelling study. The Lancet Infectious Diseases
20, 1151–1160 (2020).
Smith, L. E. et al. Adherence to the test, trace and isolate system: results from a time series of 21 nationally
representative surveys in the uk (the covid-19 rapid survey of adherence to interventions and responses [corsair]
study). medRxiv (2020).
Eames, K. T. & Keeling, M. J. Contact tracing and disease control. Proceedings of the Royal Society of London.
Series B: Biological Sciences 270, 2565–2571 (2003).
Klinkenberg, D., Fraser, C. & Heesterbeek, H. The effectiveness of contact tracing in emerging epidemics. PloS
one 1, e12 (2006).
Kretzschmar, M. E. et al. Impact of delays on effectiveness of contact tracing strategies for covid-19: a modelling study. The Lancet Public Health 5, e452–e459
(2020).
Ferretti, L. et al. Quantifying sars-cov-2 transmission
suggests epidemic control with digital contact tracing.
Science 368 (2020).
Keeling, M. J., Hollingsworth, T. D. & Read, J. M. Efficacy of contact tracing for the containment of the 2019
novel coronavirus (covid-19). J Epidemiol Community
Health 74, 861–866 (2020).
Park, Y. J. et al. Contact tracing during coronavirus
disease outbreak, south korea, 2020. Emerging infectious
diseases 26, 2465–2468 (2020).

[36] Barrat, A., Cattuto, C., Kivelä, M., Lehmann, S. &
Saramäki, J. Effect of manual and digital contact tracing on covid-19 outbreaks: a study on empirical contact
data. MedRxiv (2020).
[37] Reyna-Lara, A. et al. Virus spread versus contact tracing: two competing contagion processes. arXiv preprint
arXiv:2010.01867 (2020).
[38] Kryven, I. & Stegehuis, C. Contact tracing in configuration models. Journal of Physics: Complexity (2020).
[39] Bianconi, G., Sun, H., Rapisardi, G. & Arenas, A. A
message-passing approach to epidemic tracing and mitigation with apps. arXiv preprint arXiv:2007.05277
(2020).
[40] Statista.com statistics on Contact-tracing app adoption
rates, as of July 2020. https://www.statista.com/statistics/1134669/
share- populations- adopted- covid- contact- tracing- apps- countries/ (2020). [Online; accessed 2021-01-27].
[41] Gómez-Carballa, A., Bello, X., Pardo-Seco, J., MartinónTorres, F. & Salas, A. Mapping genome variation of sarscov-2 worldwide highlights the impact of covid-19 superspreaders. Genome Research 30, 1434–1448 (2020).
[42] Miller, S. L. et al. Transmission of sars-cov-2 by inhalation of respiratory aerosol in the skagit valley chorale
superspreading event. Indoor air (2020).
[43] DATASETS SocioPatterns.org.
http://www.sociopatterns.org/
datasets/ (2016). [Online; accessed 2020-09-30].
[44] Starnini, M., Machens, A., Cattuto, C., Barrat, A. &
Pastor-Satorras, R. Immunization strategies for epidemic
processes in time-varying contact networks. Journal of
theoretical biology 337, 89–100 (2013).
[45] Vanhems, P. et al. Estimating potential infection transmission routes in hospital wards using wearable proximity
sensors. PloS one 8, e73970 (2013).
[46] Barrat, A., Cattuto, C., Tozzi, A. E., Vanhems, P. &
Voirin, N. Measuring contact patterns with wearable
sensors: methods, data characteristics and applications
to data-driven simulations of infectious diseases. Clinical
Microbiology and Infection 20, 10–16 (2014).
[47] Génois, M. et al. Data on face-to-face contacts in an office
building suggest a low-cost vaccination strategy based on
community linkers. Network Science 3, 326–347 (2015).
URL http://journals.cambridge.org/article_S2050124215000107.
[48] Génois, M. & Barrat, A. Can co-location be used as a
proxy for face-to-face contacts? EPJ Data Science 7, 11
(2018). URL https://doi.org/10.1140/epjds/s13688- 018- 0140-1.
[49] Gadár, L., Kosztyán, Z. T., Telcs, A. & Abonyi, J. A
multilayer and spatial description of the erasmus mobility
network. Scientific Data 7, 1–11 (2020).
[50] Sapiezynski, P., Stopczynski, A., Lassen, D. D. &
Lehmann, S. Interaction data from the copenhagen networks study. Scientific Data 6, 1–10 (2019).
[51] Jeyanathan, M. et al. Immunological considerations for
covid-19 vaccine strategies. Nature Reviews Immunology
1–18 (2020).
[52] Gozzi, N., Bajardi, P. & Perra, N. The importance
of non-pharmaceutical interventions during the covid-19
vaccine rollout. medRxiv (2021).
[53] Salathé, M. et al. A high-resolution human contact
network for infectious disease transmission. Proceedings
of the National Academy of Sciences 107, 22020–22025
(2010).
[54] Isella, L. et al. What’s in a crowd? analysis of face-toface behavioral networks. Journal of theoretical biology
271, 166–180 (2011).

11

Supplementary Information for
“Optimising the mitigation of epidemic spreading through targeted
adoption of contact tracing apps”
Supplementary Note 1.

PROPERTIES OF THE SUBGRAPHS INDUCED BY APP
INSTALLATION.

We provide here the full derivation of the degree distribution of the subgraph G0 induced by a specific set of app
installations, i.e., the subgraph of G obtained by considering only the nodes which have installed the app and the
edges among them. We consider both the case of uniform random and degree-based installation.
Uniform random installation

We start by considering the case of uniform random installation on a graph G with assigned degree distribution
P (k), i.e., when a fraction r of the N nodes, chosen uniformly at random, installs the app. The probability that a
given node i that has installed the app has degree k 0 in G0 given the fact that it has degree k in the original graph G
can be expressed as:
 
0
k k0
0
0
P (ki = k |ki = k) =
r (1 − r)k−k .
(1)
0
k
Indeed, since app installation is performed uniformly at random with probability r, the probability that a specific
neighbour j of a node i has installed the app is just r, and does not depend on whether i has installed the app or
not. Consequently, the probability that exactly k 0 of the neighbours of i have installed the app is given by a Binomal
distribution with success probability r. This also implies that the expected degree of node i in G0 across the ensemble
of realisations of random installation is:
E[ki0 ] = rki

(2)

By using Eq. (1), we can express the probability distribution PeRND (k 0 ) that a generic node with app installed has k 0
neighbours which have installed the app as:
 
N
−1
X
0
0
k
0
e
PRND (k ) =
P (k) 0 rk (1 − r)k−k
(3)
k
k=0

Notice that this equation holds independently of the specific degree distribution of G and of other local properties
of the graph, such as the presence of degree-degree correlations or clustering. We can derive the value of hkiRND by
using the definition:
 
N
−1
N
−1 N
−1
N
−1
N
−1  
X
X
X
X
X
j k
j k
j−k
e
k PRND (k) =
k
P (j)
P (j)
k
hkiRND =
r (1 − r)
=
r (1 − r)j−k
k
k
j=0
k=0
k=0
j=k
k=0
 
j
N
−1
N
−1
X
X
X
j k
(4)
=
P (j)
k
r (1 − r)j−k =
P (j)rj
k
j=0
j=0
k=0

= rhkiG
2

Similarly, for hk iRND we obtain:
hk 2 iRND =
=

N
−1
X
k=0
N
−1
X
j=0

k 2 PeRND (k) =

N
−1
X

k2

k=0

P (j)

j
X
k=0

N
−1
X
j=k

 
 
N
−1
N
−1
X
X
j k
j k
P (j)
r (1 − r)j−k =
P (j)
k2
r (1 − r)j−k
k
k
j=0

 
N
−1
X


2 j
k
j−k
k
r (1 − r)
=
P (j) j(j − 1)r2 + rj
k
j=0

= r2 hk 2 iG + r(1 − r)hkiG

k=0

(5)

12
Degree-based strategy and rich-club coefficient

For degree-targeted app installations, i.e., when the top rN nodes in the ranking by degree have their app installed,
Eq. (1) does not hold, since the probability of a node being in G0 is not uniform and depends instead on its degree in
G. If we call e
k the smallest of the degrees of the nodes in G0 , the subgraph induced by app installation corresponds
to the subgraph among nodes whose degree is ≥ e
k. The fraction of existing edges among nodes with degree ≥ e
k is,
by definition, the (unnormalised) rich-club coefficient [1] of G:
φ(k) =

2e≥k,≥k
N≥k (N≥k − 1)

(6)

computed for k = e
k. Here we denote by N≥k the number of nodes whose degree is larger than or equal to k, and by
e≥k,≥k the number of edges among those nodes. Consequently, the average degree of G0 can be written as:
hkiDEG = (N≥ek − 1)φ(e
k)

(7)

The general expression for the rich club in networks depends only on the joint degree-degree distribution P (k1 , k2 ),
i.e., the probability of finding an edge between two nodes having degree k1 and k2 , and reads [2, 3]:
N hki

PN −1

,k2 =k P (k1 , k2 )
ik1h

i
φ(k) = h P
PN −1
N −1
N k1 =k P (k1 )
N k1 =k P (k1 ) − 1

(8)

So in the case of degree-based targeting, even the first moment of the degree distribution of G0 depends heavily on
the presence of degree-degree correlation in G, at stark difference with the case of uniformly random installation seen
above.
In the special case of uncorrelated random graphs, such as in the configuration model ensemble, the joint degreedegree distribution factorises as:
nc

P (k1 , k2 ) = qk1 qk2 =

k1 k2 P (k1 )P (k2 )
hki2

(9)

and it is easy to show that the rich club coefficient can be written as:
PN −1
PN −1
k1 =k k1 P (k1 )
k2 =k k2 P (k2 )
h
i
h
i
φ (k) =
PN −1
PN −1
hki
P
(k
)
N
P
(k
)
−
1
1
2
k1 =k
k2 =k
nc

(10)

By using Eq. (7) we obtain:
i2
k1 P (k1 )
hP
i
= N
P (k1 ) − 1 φnc (e
k) =
N −1
P (k1 )
hki
k1 =e
k
k =e
k


hkinc
DEG

hP

N −1
k1 =e
k



N
−1
X

(11)

1

It is quite interesting to find that the first moment of the degree distribution of G0 is indeed connected with the
rich-club coefficient of the graph at the critical degree.
It is actually possible to compute the full degree distribution of G0 in the case of degree-based installation. If a
node i is in G0 , then we have ki ≥ e
k. Now, the probability that one of the ki neighbours of i is in G0 is equal to:
Qek (i) =

N
−1
X

P (k|ki )

(12)

k=e
k

where P (k|ki ) is the conditional probability of finding a node of degree k by following one of the edges of a node
of degree ki . In the special case of graphs with no degree-degree correlations, P (k|ki ) does not depend on ki , and
factorises as:
nc

P (k|ki ) =

kP (k)
= qk
hki

(13)

13
so we have:
nc

Qek (i) =

N
−1
X

qk = re ∀i

(14)

k=e
k

In the absence of degree-degree correlations, the probability of any two specific nodes to be connected does not depend
on their degree, by definition. Hence, the probability that a node of G0 has a degree equal to k 0 is given again by the
Binomial distribution:
 
0
k k0
re (1 − re)k−k , k ≥ e
k
(15)
Pe(ki0 = k 0 |ki = k) =
0
k
while Pe(ki0 = k 0 |ki = k) = 0 if k < e
k. Notice that re has the same role that r has in the equations for random
assignment. In particular, this means that the expected value E [ki0 ] across all the configuration model graphs with a
pre-assigned degree sequence is equal to:
E [ki0 ] = reki

(16)

With an argument in all similar to that used for random installation, we obtain:
 
N
−1
X
0
0
k
0
e
P (k ) =
P (k) 0 rek (1 − re)k−k
k

(17)

k=e
k

Notice that Pe(k 0 ) represents the probability to find a node of G which has degree k 0 in the subgraph induced by
app installations. To obtain the actual degree distribution in the induced subgraph, i.e., the probability that one of
the nodes of G0 has degree k 0 , we must rescale Pe(k 0 ) to the nodes in G0 , i.e., we consider the probability distribution:
 
N −1
0
0
k
1 X
1
P (k) 0 rek (1 − re)k−k
(18)
PeDEG (k 0 ) = Pe(k 0 ) =
k
r
r
k=e
k

It is important to stress here that the expression for PeDEG (k 0 ) provided above is valid only in uncorrelated graphs,
due to the assumption we made in Eq. (13) and Eq. (14).

P(k 0)

In Supplementary Fig. 1 we report the the empirical degree distributions of the subgraph G0 induced by the random
(RND) and degree-based (DEG) CT strategies when considering three different adoption rates r = 0.1, 0.3, 0.5,
respectively. We considered here an ensemble of configuration model graphs with degree distribution P (k) ∼ k −3 and
N = 104 nodes. Notice that the numerical simulations are in perfect agreement with the analytical predictions in
Eq. (3) and Eq. (18)

10

1

10

3

10

5

10

7

10

9

a

r = 0.1

r = 0.3

b

r = 0.5

c

RND
RNDtheo
DEG
DEGtheo

0

20

k0

40

0

20 40 60 80 0 20 40 60 80

k0

k0

Supplementary Figure 1. Empirical and theoretical degree distributions of the induced subgraph for different
values of adoption rate r. We report the comparison between the empirical degree distributions of the induced subgraph
G0 for the random (RND) and degree-based (DEG) strategies when considering three different adoption rates r. Solid lines
represent the theoretical predictions for the RND and DEG strategies calculated using Eq. (3) and Eq. (18), respectively. The
plots correspond to an ensemble of configuration model graphs with degree distribution P (k) ∼ k−3 and N = 104 nodes.
Results averaged over 104 realisations.

14
Simulated annealing

The simulated annealing (SA) procedure is commonly used to find the global optimum of a certain cost/energy
function. In a SA algorithm, an energy function usually attributes certain values to each configuration of the system.
The best configuration, which is the one that optimises the energy function, is usually identified by searching the
phase space of the system considering Markov Chain Monte Carlo moves that allow to switch from one configuration
to another. In our context, we are interested on finding the maximum of the following cost function:
F(G0 ) =

X 1 X k0
a`i i (ki − 1)
k` i
ki

(19)

`

Hence, for a given app adoption rate r, the SA algorithm tries to find the nodes which provide the maximum value of
F in order to reduce the expected number of secondary infections caused by a single contagion in presence of contact
tracing. Each configuration is represented by the couple {A, f }, where A is set of nodes ID which adopts the CT app
in the network, while f is the energy associated with the configuration, i.e., the value computed using Eq. 19.
For a given app adoption rate r, we start at time t = 0 from a random configuration A0 and evaluate the corresponding energy f0 . Then, at each step t of the algorithm, we randomly replace a node i of the set At−1 with a
randomly selected node j that does not belong to the same set, i.e. At = (At−1 ∪ {j}) \ {i}. After calculating the
energy ft of the new configuration, we accept it with probability:
(
1
if ft > f
p=
f −f
− T t
otherwise
e
where T has the role of temperature in the simulated annealing procedure. In particular, the initial temperature for
the simulations was set to Tmax = 1 and in every step it was reduced by δT until Tmin = 0.01 was reached. A step
of δT = 10−7 was used for all our numerical simulations.

15

Supplementary Note 2.

CONTACT TRACING STRATEGIES BASED ON LOCAL
INFORMATION

We report in Supplementary Table 1 the real-world networks analysed in the main manuscript along with the
thresholds values used for filtering nodes or edges in the networks and basic statistics (resulting number of nodes and
edges). For each of the 84 unique graphs analysed, we report the thresholds used and the resulting number of links
with larger weights.
Network
contacts-Hospital
highschool-2011
gall-2009-04-28
gall-2009-04-29
gall-2009-05-01
gall-2009-05-02
gall-2009-05-05
gall-2009-05-06
gall-2009-05-09
gall-2009-05-10
gall-2009-05-13
gall-2009-05-14
gall-2009-05-16
gall-2009-05-17
gall-2009-05-20
gall-2009-05-21
gall-2009-05-23
gall-2009-05-24
gall-2009-05-27
gall-2009-05-28
gall-2009-05-30
gall-2009-05-31
gall-2009-06-03
gall-2009-06-04
gall-2009-06-06
gall-2009-06-07
gall-2009-06-10
gall-2009-06-11
gall-2009-06-13
gall-2009-06-14
gall-2009-06-17
gall-2009-06-18
gall-2009-06-20
gall-2009-06-21
gall-2009-06-24
gall-2009-06-25
gall-2009-06-27
gall-2009-06-28
gall-2009-07-01
gall-2009-07-02
gall-2009-07-04
gall-2009-07-05
gall-2009-07-08
gall-2009-07-09
gall-2009-07-11
gall-2009-07-12
gall-2009-07-15
gall-2009-07-16
InVS13
InVS15
LyonSchool
SFHH
bt
call
Hospital
sms

Thres.
240 sec.
360 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
25%
10%
25%
10%
25%
10%
25%
10%

Nodes
67
111
190
112
201
89
78
37
216
138
166
54
241
172
89
38
238
10
116
100
127
22
62
37
142
113
35
13
102
105
72
23
149
123
79
31
35
35
167
21
127
30
186
61
161
114
410
250
93
208
240
384
634
5
67
6

Edges
291
252
703
231
558
163
147
65
993
242
590
134
1504
470
507
107
1075
13
395
495
397
56
174
137
696
203
74
44
264
181
212
66
495
244
369
152
99
71
814
39
526
40
820
121
673
215
2765
567
967
1656
6637
7048
18727
5
284
5

Network
contacts-Hospital
highschool-2012
gall-2009-04-28
gall-2009-04-30
gall-2009-05-01
gall-2009-05-03
gall-2009-05-05
gall-2009-05-07
gall-2009-05-09
gall-2009-05-12
gall-2009-05-13
gall-2009-05-15
gall-2009-05-16
gall-2009-05-19
gall-2009-05-20
gall-2009-05-22
gall-2009-05-23
gall-2009-05-26
gall-2009-05-27
gall-2009-05-29
gall-2009-05-30
gall-2009-06-02
gall-2009-06-03
gall-2009-06-05
gall-2009-06-06
gall-2009-06-09
gall-2009-06-10
gall-2009-06-12
gall-2009-06-13
gall-2009-06-16
gall-2009-06-17
gall-2009-06-19
gall-2009-06-20
gall-2009-06-23
gall-2009-06-24
gall-2009-06-26
gall-2009-06-27
gall-2009-06-30
gall-2009-07-01
gall-2009-07-03
gall-2009-07-04
gall-2009-07-07
gall-2009-07-08
gall-2009-07-10
gall-2009-07-11
gall-2009-07-14
gall-2009-07-15
gall-2009-07-17
InVS13
LH10
LyonSchool
Thiers13
bt
enterprise
Hospital
student

Thres.
360 sec.
240 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
10%
25%
10%
25%
10%
25%
10%
25%

Nodes
63
171
61
144
37
305
18
194
156
56
58
241
216
49
75
131
208
131
45
93
70
16
16
88
127
74
18
58
21
67
48
125
109
57
22
78
10
128
127
121
103
220
159
157
102
275
351
221
87
62
225
326
617
84
44
1452

Edges
228
496
127
486
60
1847
26
801
312
114
82
1301
577
112
276
864
396
513
118
272
121
61
46
267
324
238
49
158
40
391
81
412
203
128
40
152
17
435
336
321
214
1187
356
776
188
1633
1205
1073
391
339
2654
10873
7449
183
110
17134

Network
highschool-2011
highschool-2012
gall-2009-04-29
gall-2009-04-30
gall-2009-05-02
gall-2009-05-03
gall-2009-05-06
gall-2009-05-07
gall-2009-05-10
gall-2009-05-12
gall-2009-05-14
gall-2009-05-15
gall-2009-05-17
gall-2009-05-19
gall-2009-05-21
gall-2009-05-22
gall-2009-05-24
gall-2009-05-26
gall-2009-05-28
gall-2009-05-29
gall-2009-05-31
gall-2009-06-02
gall-2009-06-04
gall-2009-06-05
gall-2009-06-07
gall-2009-06-09
gall-2009-06-11
gall-2009-06-12
gall-2009-06-14
gall-2009-06-16
gall-2009-06-18
gall-2009-06-19
gall-2009-06-21
gall-2009-06-23
gall-2009-06-25
gall-2009-06-26
gall-2009-06-28
gall-2009-06-30
gall-2009-07-02
gall-2009-07-03
gall-2009-07-05
gall-2009-07-07
gall-2009-07-09
gall-2009-07-10
gall-2009-07-12
gall-2009-07-14
gall-2009-07-16
gall-2009-07-17
InVS15
LH10
SFHH
Thiers13
call
enterprise
sms
student

Supplementary Table 1. Networks analysed and main statistics.

Thres.
240 sec.
360 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
0 sec.
20 sec.
25%
10%
25%
10%
25%
10%
25%
10%

Nodes
117
158
198
59
213
211
176
72
168
11
132
127
187
13
43
65
31
57
141
65
89
11
53
32
155
21
77
25
138
48
74
64
166
19
79
9
107
34
60
32
95
166
114
103
148
195
318
180
217
42
392
69
12
50
19
956

Edges
332
372
736
132
966
513
745
204
625
15
620
334
1347
23
193
183
68
183
1054
132
267
41
382
56
563
70
161
101
433
198
275
112
676
31
321
13
397
55
180
60
314
477
373
359
580
566
1441
405
4150
116
17709
1223
11
66
18
6670

16
Some of the strategies studied in the main manuscript, such as degree-based targeting, require global and accurate
information about the contact network. Unfortunately, this requirement can represent a major challenge in a realistic
scenario, as one normally has access only to partial or local information about a node and/or about its immediate
neighbours. To mitigate this problem, we explored two decentralised strategies inspired by the friendship paradox in
social networks [4, 5] and previously considered for efficient vaccination [6–8]. The paradox is that, on average, in any
graph each individual is more likely to have fewer friends than its own friends do, which corresponds to the saying
that “your friends are more social than you are”. We leverage this concept to construct node rankings based on a
simple “voting” system. In particular, we assume that each node i in the network has the possibility to indicate one
of its neighbours as a candidate for app installation. Then, we rank each node i according to the total number of
votes vi it received.
Although the voting system requires each node to have access to just local information, it is easy to show that if
the graph has no degree-degree correlations, then the number of votes received by a node i is actually proportional to
its degree ki . In particular if the probability that a node j casts a vote to a neighbour i is 1/kj , the number of votes
received by a node i is given by:
vi = k i

X

Aji

j

1
,
kj

(20)

where aji are the entried of the adjacency matrix of the graph. Despite the number of votes received is proportional to
the degree of a node, the inflow also plays a very significant role – similarly to what happens in PageRank – which can
lead to some nodes with higher degree actually receiving a smaller number of votes than nodes with a lower degree.
In Supplementary Fig. 2 we compare the average number of votes received by each of the nodes in an ensemble of
configuration model graphs with degree distribution P (k) ∼ k −3 and N = 104 nodes and the theoretical prediction
provide by Eq. (20). The agreement between the simulations and the prediction is perfect, and confirms that indeed
the number of votes received by a node is somehow proportional to its degree.

20

vi

15

10

5

0

0

5

10
ki j Ajik1j

15

20

Supplementary Figure 2. Comparison between the votes received by a node and the theoretical prediction
when each node casts a single vote. We considered an ensemble of configuration model graphs with degree distribution
P (k) ∼ k−3 and N = 104 nodes. The votes received, and the theoretical prediction, have been averaged over all the nodes with
the same degree and the black line indicates a perfect match between both.

The assumption that individuals will install the CT app if they are directly targeted, and with probability equal
to 1, is rather simplistic and difficult to achieve in real-world systems. Thus, we also explored how effective the
mitigation of an epidemic would be when instead of following a strict adoption based on rankings, a node i has a
certain probability σi to adopt the app, which depends on the number of votes it has received. One of the simplest
approaches to model the adoption of technologies is based on the usage of sigmoid adoption functions [9–11] in the

17

r = 0.3
No App
App

Supplementary Figure 3. Impact of CT strategy and adoption rate on the epidemic trajectory in real-world
networks. The evolution of the disease in a SIR model with contact tracing depends heavily on the adoption rate and on
the strategy considered to select the nodes with CT apps. Here, we show the results on two real-world systems, namely,
the high-resolution face-to-face contact data recorded for a high school (a-c) and a workplace network (d-f). The strategies
analysed are the recommendation-based (a,d), the sigmoids σi (vi , a = 1) (b,e), and σi (vi , a = 5) (c,f). For these simulations
we set β = 0.1 and µ = 0.05.

form:
σi (vi , a) =

1
1 + exp(−a(vi − hvi))

(21)

where hvi is the average number of votes received by nodes in a given realisation, vi is the number of votes received
by node i, and a tunes the intensity of the sigmoid. In our simulations we considered either P
a = 1 or a = 5.
It is important to note that the function σi (v, a) needs to be properly normalised by
i σi (vi , a) to obtain a
probability function. In Supplementary Fig. 3(a-c) and (d-f), we report the temporal evolution of the number of
infected individuals I(t) for the recommendation-based strategy, respectively for the high school and the workplace
network analysed in the main manuscript.
In the high school network we observe a more drastic reduction of cases and larger difference between the strategies
as the level of app adoption increases. Furthermore, even though the mitigation effect with the sigmoids is less
pronounced than the best case scenarios relying on global information, we still observe a drastic reduction when
compared to the random case. In particular, to obtain a strong decrease in the total number of infected individuals
we need to consider an adoption rate r above 0.5. To complement the previous results, Fig. 4 displays the relative
improvement over RND for the recommendation-based strategy and the two sigmoids as a function of r for the
same two networks. In particular, we focus on the total number R∞ of people who got the disease, the maximum
number I(tpeak ) of infected across the duration of the epidemic, and the time tpeak at which that number is achieved.
Remarkably, for the high school network there are no strong differences in performance between σi (vi , a = 5) and an
assignment based on the ranking of votes received. Finally, the position of the peak does not seem heavily affected
by the sigmoid strategies, so that there is still a visible shift of the epidemic peak towards the left for high values of
r in the high school network.
In the following, we refer to the local strategy based on the number of votes v received by a node at the
recommendation-based strategy (REC). Considering the 168 networks, Supplementary Fig. 5(a-c) reports the reREC
sults with the correlations between the epidemiological indicators ∆R∞
, ∆I REC (tpeak ) and ∆tREC
peak and structural
measures as a function of the adoption rate r. Overall, for low/moderate values of r, the performance of the REC
REC
strategy – measured by ∆R∞
and ∆I REC (tpeak ) – displays a moderate correlation only with the density and global
efficiency of the contact networks. Conversely, the rich club coefficient and number of maximal cliques show a higher
correlation only when considering ∆tREC
peak . As done for the DTI, we have also compared how the REC strategy is
able to mitigate I(tpeak ) when compared to RND, as can be seen in Supplementary Fig. 5(d-f) where we report the
distribution of r∗ needed for a reduction of of 10%, 30% and 50%, respectively.

18

0.6

0.2

0.4

0.6

0.8

0.0

R

0.0

0.0

0.4

I(tpeak)

R

0.5

0.4

0.8

0.2
0.0

0.6

d

1.0

tpeak

0.2

0.0

0.4

0.4

0.6

0.8

0.4

0.0

0.0

0.4

0.8

0.2

0.5

0.2

0.4

0.6

r

0.8

0.2

0

0.4

0.0

0.6

0.4

0.8

0.8

f

30
15
0

0.0

0.0

0.4

0.8

0.5

0.0
0.0

0.0

1.0

e

0.3

20

1.0

0.8

0.6

tpeak

0.0

0.8

0.0

0.2

0.4

0.6

r

0.8

High School 2011

0.4

40

1.0

0.0

0.2

0.4

0.6

r

Workplace-InVS15

0.0

0.0

0.0
0.5

0.2

tpeak

0.0

c

0.5

tpeak

0.0

R

0.0

0.4

I(tpeak)

0.6
0.4

0.2

I(tpeak)

0.2

1.0

b

0.4

I(tpeak)

R

a

REC
(REC, 5)
(REC, 1)

0.4

0.8

Supplementary Figure 4. Comparison of epidemic indicators under different CT strategies. Relative decrease with
respect to random installations of the total number of recovered R∞ , height of the infection peak I(tpeak ) and position of the
peak tpeak for the recommendation-based, the sigmoids σi (vi , a = 1), and σi (vi , a = 5) installation strategies in the high school
(a-c) and workplace networks (d-f). The inset of each panel reports the plot of the raw variable, respectively R∞ (panel a and
d), I(tpeak ) (panel b and e) and tpeak (panel c and f).

R2

Finally, to compare all the different decentralised CT strategies presented in this work, we report in Supplementary
Fig. 6 the epidemic trajectory for the two real-world systems analysed in the main manuscript when considering
different CT adoption rates r. Overall, DT I is the best performing decentralised strategy, which provides a significant

1.0 a
0.8
0.6
0.4
0.2
0.0

R REC
Density
Global Efficiency
Rich Club Coefficient
Num. Maximal Cliques

0.2

0.8 d

0.4

r

0.6

10% peak reduction
RND
REC

0.6

P(r )

0.8

1.0 b
0.8
0.6
0.4
0.2
0.0

IREC(tpeak)
0.6

REC
tpeak

c

0.4
0.2
0.2

e

0.4

r

0.6

0.8

30% peak reduction

0.0

0.2

f

0.4

r

0.6

0.8

50% peak reduction

0.4
0.2
0.0
0.0

0.2

0.4

r

0.6

0.8

0.0

0.2

0.4

r

0.6

0.8

0.0

0.2

0.4

r

0.6

0.8

Supplementary Figure 5. Correlations with network structural measures and performance of CT strategies to
mitigate an epidemic. For the 168 real-world contact networks analysed, panels (a-c) report the correlation (R2 ) between the
REC
epidemiological indicators ∆R∞
(a), ∆I REC (tpeak ) (b) and ∆tREC
peak (c) and the network density (red), the global efficiency
(blue), the rich club coefficient (purple) and the number of maximal cliques (orange) for different values of r. All measures
were computed considering the full graphs. In panels (d-f), we report the distribution of minimum adoption ratios r∗ needed
to produce a 10% (d), 30% (e) and 50% (f) for the REC (red) and RND (green) strategies. Overall, the REC strategy performs
better than RND and requires lower adoption ratios to produce an equivalent reduction of the peak.

19
reduction with respect to the random case both in terms of the evolution of the epidemic spreading and for the height
of the peak even for low values of installation rate r. Such effect is notably visible in the high school network.

Comparison between decentralised strategies

a

High School 2011

0.35

0.9
0.7 0.8
0.6
0.4 0.5
0.3
0.2
r
0.0 0.1

I(t)

I(t)

0.25

RND
(REC, 1)
(REC, 5)
REC
DTI

0.15
0.05

0

100

t

200

b

Workplace-InVS15

0.7
0.5
0.3
0.1

0

100

t

0.2
0.0 0.1

200

0.3 0.4

r

RND
(REC, 1)
(REC, 5)
REC
DTI
0.7
0.5 0.6

0.8 0.9

Supplementary Figure 6. Mitigation of the epidemic trajectories using decentralised CT strategies. We report
the epidemic trajectory when considering different decentralised CT strategies and levels of app adoption r for the two realworld systems considered in the main text. Overall, the CT decentralised strategies consistently lead to a significant reduction
of the epidemic trajectory with respect to the random case even for small values installation rate r, with DT I being the
best-performing strategy.

20

Supplementary Note 3.

SIR MODEL WITH MAXIMUM DELAY

The SIR model with the ideal contact tracing presented in the main manuscript is based on the assumption that any
susceptible node with CT app installed is immediately quarantined (recovered) as soon as one of their contacts with
CT app installed gets infected. However, such assumption seems too simplistic when applied to real-world systems.
Indeed, people may receive the app notification after several hours/days from an infectious contact, or worse, they
may ignore the app notification and continue to have contacts with their acquaintances until they develop symptoms.
As a result, in this section we report the results obtained when considering a different variant of the SIR model
−SIRd − which accounts for the maximum delay in self-isolation, so that the neighbours of an infected node only
get recovered if an infection event takes place. In other words, if a node i and its neighbour j have both the contact
tracing app installed, j will only become recovered if i succeeds into infecting j. This mimics the fact that people are
in general unwilling to move into self-isolation if they have no symptoms, and represents the maximum possible delay
between a positive test and self-isolation of it contacts.
To compare the two SIR variants across the 168 real-world networks analysed in the main manuscript, we report
in Supplementary Fig. 7 the RND and DTI distributions of app installation rates r∗ required to respectively observe
a 10, 30, 50% peak reduction with respect to having no contact tracing in place. Interestingly, also when considering
the SIRd model, the DTI strategy consistently performs better than the RND. However, all things being equal, on
average we need slightly higher CT adoption rates r to achieve similar performances in the peak reduction when
considering the SIRd model.
Furthermore, to easily investigate the impact of the contact tracing strategies when considering the SIRd model,
we ran our simulations on the same two real-world systems considered in the main manuscript, the high school and
workplace networks. In particular, in Supplementary Fig. 8 we report the comparison of three different epidemic
indicators for the SIRd model. Overall, the results are in agreement with the one presented in the main manuscript,
so that we observe a great improvement of the targeted CT strategies with respect to the random case in all the three
epidemic indicators even for low values of adoption rate r. However, we need higher adoption rates to reach levels of
reduction of total number of infected and infected in the peak similar to the results presented in the main manuscript,

0.8 a

10% peak reduction

c

30% peak reduction

50% peak reduction

RND
DTI

0.6

P(r )

b

SIR with ideal CT

0.4
0.2
0.0
0.0

0.2

0.8 d

0.4

0.6

0.8

0.2

0.4

0.6

0.8

0.0

SIRd SIR with maximum delay

10% peak reduction

e

30% peak reduction

0.2

f

0.4

0.6

0.8

50% peak reduction

RND
DTI

0.6

P(r )

0.0

0.4
0.2
0.0
0.0

0.2

0.4

r

0.6

0.8

0.0

0.2

0.4

r

0.6

0.8

0.0

0.2

0.4

r

0.6

0.8

Supplementary Figure 7. Performance of CT strategies in mitigating the epidemics for the two variants of the
SIR model. For the 168 real-world networks analysed, we report the distribution of app installation ratios r? required to
observe a 10, 30, and 50% peak reduction with respect to no contact tracing for the DTI (red) and RND (green) strategies
in the SIR model with ideal contact tracing (a-c) and in the SIR model with delay (d-f). Overall, the DTI strategy performs
far better than the RND as it requires lower values of r to induce a similar reduction of the peak in both SIR model variants.
However, panels (d-f) clearly show that we need slightly higher CT adoption rates r to achieve similar performances in the
peak reduction with the SIRd model.

21

0.2

0.4

0.6

0.8

0.8

d

1.0
0.5

0.0

0.0

0.4

0.2

I(tpeak)

R

0.0

0.8

0.4

0.6

r

0.8

0.00
1.00
0.75
0.50
0.25
0.00

0.0

0.0

0.2

0.4

tpeak
0.0

0.6

0.4

0.8

0.8

1.5

e

0.6
0.3
0.0

0.0

0.0

0.4

0.8

0.2

0.4

r

0.6

0.8

0.5

40
20

0.0

0.2

0.4

0

0.0

0.6

0.4

0.8

0.8

f

30
15
0

0.0

0.4

0.8

0.5
1.5

0.0

0.2

0.4

r

0.6

High School 2011

0.4

0.2

Workplace-InVS15

R
0.0

0.0

R

1.00
0.75
0.50
0.25
0.00

0.0

0.4

0.25

c

tpeak

0.00

0.4

0.50

1.0
0.5
0.0
0.5
1.0

tpeak

0.25

0.75

tpeak

0.8

b

1.00

I(tpeak)

0.50

I(tpeak)

0.75

R

a

RND
DEG
DTI
SA

I(tpeak)

1.00

0.8

Supplementary Figure 8. Comparison of epidemic indicators under different CT strategies for the SIR model
with delay. Relative decrease with respect to random installations of the total number of recovered R∞ , height of the infection
peak I(tpeak ) and position of the peak tpeak for DTI, DEG, and SA targeted installation when considering the SIR model with
delay. For all the three synthetic indicators, the targeted strategies provide a level of reduction similar to the one presented in
the main paper, yet achieved with a slightly higher values of adoption rate r (10% increase). The inset of each panel reports
the plot of the raw variable, respectively R∞ (panel a and d), I(tpeak ) (panel b and e) and tpeak (panel c and f).

at least 10% difference of installation rate respectively.
Finally, we show that, even in the SIRd model, the decentralised strategies presented in the main paper (DTI) and
in the previous sections (REC and variants) allow to obtain a substantial reduction of the epidemic trajectory with
respect to the random case. We report in Supplementary Fig. 9 the comparison between the decentralised strategies
when considering the SIRd model for the two real-world systems considered in the main manuscript. Remarkably,
even for low values of adoption rate r and also when considering the maximum delay model SIRd , the decentralised
CT strategies provide a consistent reduction in the epidemic trajectory in respect to the random case.

Comparison between decentralised strategies

a

High School 2011

0.35

0.8 0.9
0.7
0.6
0.4 0.5
0.3
0.2
r
0.0 0.1

I(t)

I(t)

0.25

RND
(REC, 1)
(REC, 5)
REC
DTI

0.15
0.05

0

100

t

200

b

Workplace-InVS15

0.7
0.5
0.3
0.1

0

100

t

0.0

200

0.3 0.4
0.2
r
0.1

RND
(REC, 1)
(REC, 5)
REC
DTI
0.7
0.5 0.6

0.8 0.9

Supplementary Figure 9. Mitigation of the epidemic using decentralised strategies in the SIR model with delay.
We report the epidemic trajectory when considering different CT decentralised strategies and levels of adoption rate r for
the two real-world systems considered in the main manuscript using the SIRd model. Interestingly, the CT decentralised
strategies consistently lead to a significant reduction of the epidemic trajectory with respect to the RND, with DT I being the
best-performing strategy.

22

[1] Colizza, V., Flammini, A., Serrano, M. A. & Vespignani, A. Detecting rich-club ordering in complex networks. Nature
physics 2, 110–115 (2006).
[2] Latora, V., Nicosia, V. & Russo, G. Complex networks: principles, methods and applications (Cambridge University Press,
2017).
[3] Newman, M. Networks (Oxford university press, 2018).
[4] Feld, S. L. Why your friends have more friends than you do. American Journal of Sociology 96, 1464–1477 (1991).
[5] Eom, Y.-H. & Jo, H.-H. Generalized friendship paradox in complex networks: The case of scientific collaboration. Scientific
reports 4, 1–6 (2014).
[6] Cohen, R., Havlin, S. & Ben-Avraham, D. Efficient immunization strategies for computer networks and populations.
Physical review letters 91, 247901 (2003).
[7] Lelarge, M. Efficient control of epidemics over random networks. ACM SIGMETRICS Performance Evaluation Review
37, 1–12 (2009).
[8] Christakis, N. A. & Fowler, J. H. Social network sensors for early detection of contagious outbreaks. PloS one 5, e12948
(2010).
[9] Stoneman, P. Intra-firm diffusion, bayesian learning and profitability. The Economic Journal 91, 375–388 (1981).
[10] Button, K., Ngoe, N. & Hine, J. Modelling vehicle ownership and use in low income countries. Journal of Transport
Economics and Policy 51–67 (1993).
[11] Tsur, Y., Sternberg, M. & Hochman, E. Dynamic modelling of innovation process adoption with risk aversion and learning.
Oxford Economic Papers 42, 336–355 (1990).

