Epidemic Spreading in a Social Network with
Facial Masks wearing Individuals
Duan-Shin Lee, Senior Member, IEEE, and Miao Zhu

arXiv:2011.00190v1 [physics.soc-ph] 31 Oct 2020

Abstract
In this report, we present a susceptible-infected-recovered (SIR) model with individuals wearing facial masks and individuals
who do not. The disease transmission rates, the recovering rates and the fraction of individuals who wear masks are all time
dependent in the model. We develop a progressive estimation of the disease transmission rates and the recovering rates based
on the COVID-19 data published by John Hopkins University. We determine the fraction of individual who wear masks by
a maximum likelihood estimation, which maximizes the transition probability of the susceptible-infected-recovered model. The
transition probability is numerically difficult to compute if the number of infected individuals is large. We develop an approximation
for the transition probability based on central limit theorem and mean field approximation. We show through numerical study
that our approximation works well. We develop a bond percolation analysis to predict the eventual fraction of population who are
infected, assuming that parameters of the SIR model do not change anymore.
We predict the outcome of COVID-19 pandemic using our theory.

keywords:bond percolation; epidemic network; susceptible-infected-recovered model; masks; COVID-19
I. I NTRODUCTION
In December of 2019 a few patients of a new infectious respiratory disease were detected in Wuhan, China. This disease
has been called coronavirus disease 2019 (COVID-19) and the virus that causes COVID-19 has been named SARS-CoV-2 by
the World Health Organization (WHO). WHO declared the outbreak a public health emergency of international concern at the
end of January 2020, and a pandemic on March 11, 2020. Since the outbreak, most countries have adopted various measures
in an attempt to contain the pandemic. These measures include restriction of traveling, shutting down schools, restaurants and
businesses, canceling large gatherings such as concerts, sports and religious activities, and even city lockdowns where residents
are not allowed to leave home unless emergencies. Clearly these measures seriously affect daily lives and are devastating to
the economics. The purpose of this report is to show that wearing facial masks is a simple and inexpensive measure to contain
the spread of COVID-19. In fact, we shall show that if a relatively small fraction of population wears facial masks, the disease
can be contained.
Facial masks have been shown in labs to be effective to limit the spread of droplets or aerosols if a wearer coughs [1]–[4].
This ability is measured by a quantity called the outward mask filter efficiency of masks. Facial masks also protect their wearers
from inhaling droplets or aerosols from a nearby cougher, if the cougher does not wear a mask. This ability is measured by a
quantity called the inward mask filter efficiency of masks. Thus, facial masks can be particularly useful to confine the spreading
of diseases that transmit through droplets or aerosols. However, the effect of wearing facial masks to the epidemic spreading
has never been studied in a network level. In this report we present an epidemic network study to justify this argument.
Specifically, we propose a time dependent susceptible-infected-recovered (SIR) model with two types of individuals. Type 1
individuals wear a facial mask and type 2 individuals do not. A randomly selected individual from a population is a type 1
individual with probability p, and is of type 2 with probability 1 − p. There are four types of contacts between two individuals
depending on whether the two individuals wear a facial mask or not. These four types of contacts have four different disease
transmission rates. From the data published by John Hopkins University [5] we progressively estimate the time dependent
disease transmission rates and the recovery rates of the SIR model.
For parameter p, we propose a stochastic version of the SIR model. We derive the transition probability of the number of
infected individuals from one time slot to the next. We propose a maximum likelihood estimation of p that maximizes the
transition probability. The transition probability is expressed in terms of binomial distributions. Parameters of the binomial
distributions corresponding to real data published in [5] are typically very large. That makes the transition probability
numerically difficult to compute. We propose an approximation of the transition probability based on central limit theorem and
mean field approximation. Through numerical studies, we show that the approximation works well. We derive a percolation
analysis of the maximum number of individuals that can eventually be infected. We incorporate the maximum likelihood
estimation and the percolation analysis into the progressive estimation. That is, based on the data published by John Hopkins
University, we progressively estimate the disease transmission rates and the recovery rates. We then find p from the maximum
The authors are with the Institute of Communications Engineering, National Tsing Hua University, Hsinchu 30013, Taiwan, R.O.C. Email: lds@cs.nthu.edu.tw,
xmzhumiao11111@hotmail.com. This research was supported in part by the Ministry of Science and Technology, Taiwan, R.O.C., under Contract 109-2221E-007-093-MY2.

likelihood estimation. Finally, using percolation analysis, we predict the maximum number of individuals that can eventually
be infected.
The outline of this report is as follows. In Section II, we present a time dependent SIR model. We present a progressive
estimation of the disease transmission rates and the recovery rates of the model. In Section III, we present a maximum likelihood
method to estimate p. In Section IV we present a percolation analysis. In Section V we present results of numerical study and
simulation. We present the conclusions in Section VI.
II. T IME D EPENDENT SIR M ODEL
In this section we present a discrete-time susceptible-infected-recovered (SIR) model. Time is divided into periods of equal
lengths. There are two types of individuals. Type 1 individuals wear a facial mask and type 2 individuals do not. A randomly
selected individual from a population is a type 1 individual with probability p(t) in period t. A randomly selected individual
is of type 2 with probability 1 − p(t). Let s(t) and r(t) be the number of susceptible and recovered individuals, respectively,
at time t. Similarly, let xi (t) be the number of infected type i individuals in period t for i = 1, 2. In this model, the disease
transmission rates are time dependent. Let βij (t) be the expected number of type j susceptible individuals who receive the
disease from one type i infected individual per unit time in period t. Let γ(t) be the recovering rate of the disease in period
t. We assume that both types of infected individuals have the same recovering rate.
In this report we assume that the length of a time unit in the discrete-time SIR model is τ days. The dynamics of this
discrete-time SIR model is as follows. The existing infected individuals at time t− transmit the disease to newly infected
individuals. Those infected individuals existed at time t− become recovered at time (t + 1)−. It is easy to derive the following
set of difference equations for the SIR model.
s(t + 1) − s(t)
=−

2
X

!
xi (t)[βi,1 (t)p(t) + βi,2 (t)(1 − p(t))]

i=1

x1 (t + 1) − x1 (t) = x1 (t)β11 (t)

s(t)
n

s(t)p(t)
n

s(t)p(t)
− γ(t)x1 (t)
n
s(t)(1 − p(t))
x2 (t + 1) − x2 (t) = x1 (t)β12 (t)
n
s(t)(1 − p(t))
+ x2 (t)β22 (t)
− γ(t)x2 (t)
n
r(t + 1) − r(t) = γ(t)(x1 (t) + x2 (t)),
+ x2 (t)β21 (t)

(1)

where
n = s(t) + x1 (t) + x2 (t) + r(t)
is the size of the population. We assume that the epidemics is in the early stage. That is, we assume that s(t) ≈ n. Under this
assumption, the difference equations for x1 (t) and x2 (t) reduce to
x1 (t + 1) − x1 (t) = (x1 (t)β11 (t) + x2 (t)β21 (t))p(t)
− γ(t)x1 (t)

(2)

x2 (t + 1) − x2 (t) = (x1 (t)β12 (t) + x2 (t)β22 (t))(1 − p(t))
− γ(t)x2 (t).

(3)

We now determine parameters βij (t) and p(t). We reduce the number of parameters. Previous study [2] suggested that
β12 (t) = (1 − η1 )β22 (t)

(4)

β21 (t) = (1 − η2 )β22 (t),

(5)

where η1 and η2 are outward and inward efficiencies of masks, respectively. Study [4] suggested that η1 > η2 . In addition, we
assume that
β11 (t) = (1 − η1 )(1 − η2 )β22 (t).

(6)

Thus, we only need to determine β22 (t). The other three parameters are determined according to Eqs. (4), (5) and (6).
Substituting (4), (5) and (6) into (2) and (3), we obtain
x1 (t + 1) = β22 (t)[x1 (t)(1 − η1 )(1 − η2 )
+ x2 (t)(1 − η2 )]p(t) + (1 − γ(t))x1 (t)

(7)

x2 (t + 1) = β22 (t)[x1 (t)(1 − η1 ) + x2 (t)](1 − p(t))
+ (1 − γ(t))x2 (t).

(8)

Now we determine the values of parameters γ(t), β22 (t) and p(t) based on the data published by John Hopkins University
[5]. Note that John Hopkins University publishes total number of daily newly infected individuals and the number of recovered
individuals. From the published data, one can easily compute r(t) for each t. The website does not distinguish between infected
individuals who wear masks or who do not. Thus, we must determine β22 (t) and p(t) based on the total number of infected
individuals
x(t) = x1 (t) + x2 (t)
at time t. From the data published by John Hopkins University, we estimate γ(t), β22 (t) and p(t). We develop in section IV
a percolation analysis to determine the ultimate size of infected population, if these parameters do not change.
Recovering rate is simple to determine. From (1) we have
γ(t) =

r(t + 1) − r(t)
.
x(t)

(9)

Next, we determine β22 (t). To determine the value of β22 (t) in period t, we let x(t) be the total number of infected individuals
in period t, i.e.
Adding Eqs. (7) and (8) and solving for β22 (t), we obtain
β22 (t) =

x(t + 1) − (1 − γ(t))x(t)
x1 (t)[(1 − η1 )(1 − η2 )p(t) + (1 − η1 )(1 − p(t))] + x2 (t)[(1 − η2 )p(t) + (1 − p(t))]

(10)

To determine the value of β22 (t) at time t, we use x(t + 1) published in [5]. We assume that x1 (t) and x2 (t) and p(t) are
available for t. We use (10) to determine β22 (t). The value of p(t) is determined by a maximum likelihood estimation method.
We shall present this method in Section III. After β22 (t) at time t is determined, we use (7) and (8) to determine x1 (t + 1)
and x2 (t + 1). Note that the sum of x1 (t + 1) and x2 (t + 1) determined in this way agrees with x(t + 1).
We summarize the algorithm that determines parameters of the time-dependent SIR model in Algorithm 1.
Algorithm 1 Estimation and prediction
Inputs: Sequences {x(t) : t = 1, 2, . . .}, {r(t) : t = 1, 2, . . .} and parameters η1 , η2
Outputs: p(t), β22 (t), x1 (t), x2 (t), S(t)
1:
2:
3:
4:
5:
6:
7:
8:
9:
10:

Initially at t = 1, set p(1) = 0, x1 (1) = 0, x2 (1) = y(1);
Compute γ(1) using Eq. (9);
Compute β22 (1) using Eq. (10);
for t = 2, 3, . . . do
Find p(t) = p̂(t) by solving the optimization problem in Eq. (37) using parameter β22 (t − 1);
Compute γ(t) using Eq. (9);
Find β22 (t) using Eq. (10) and p(t), x1 (t), x2 (t) and y(t + 1);
Compute x1 (t + 1) and x2 (t + 1) by Eqs. (7) and (8);
Find predicted giant component size S(t) using Eq. (V);
end for
III. M AXIMUM L IKELIHOOD E STIMATION OF p(t)

In this section we present a maximum likelihood estimation method to determine the value p(t) based on x(t), x(t + 1) and
β22 (t − 1). This estimation will be progressively used by Algorithm 1 in periods t = 2, 3, . . .. Thus, in the rest of this report
we simplify the notation by eliminating the dependency of time from p(t) and γ(t) and simply use p and γ, respectively.
Recall that x(t) and x(t + 1) are the total number of infected individuals in periods t and t + 1. We would like to determine
the value of p such that the likelihood of this sample path is maximized. To determine the likelihood function, we propose
a probabilistic version of the SIR model. This probabilistic SIR model is based on independent cascade models. Independent

cascade models are popular not only in the study of epidemic spreading but also in the influence maximization problems of
viral marketing [6], [7]. In an independent cascade model, each infected node has exactly one opportunity to transmit the
disease to its neighbors. Whether the transmissions are successful or not depend on independent events. In our model, we
distinguish between nodes that have used their opportunity to transmit the disease from those who have not. Our model is a
discrete time model. Let Xt be the total number of currently infected individuals in period t. Let Yt be the number of individual
who contract the disease in period t. In our model, we assume that those who contract the disease in period t have ability to
transmit the disease to their neighbors, and lose the ability in periods t + 1, t + 2, . . . and so on. Thus, in period t there are
Xt − Yt infected individuals who can not transmit the disease to others. Those who are infected but cannot transmit the disease
to others in period t can remain infected in subsequent periods or become recovered. A graphical illustration of the model is
shown in Figure 1. It is clear that this model is a discrete time Markov chain. We shall derive the transition probability
P(Xt+1 = x(t + 1), Yt+1 = y(t + 1)|Xt = x(t), Yt = y(t))

(11)

and find p̂(t) such that
p̂(t) = argmax log(P(Xt+1 = x(t + 1), Yt+1 = y(t + 1)|
0≤p≤1

Xt = x(t), Yt = y(t))).

(12)

We now specify more details of the probabilistic SIR model. Each individual can be of type 1, or of type 2. Each infectious
individual has k contacts, to whom he or she can transmit the disease. A type i infectious individual can transmit the disease
to a type j susceptible individual with probability φij , where i, j = 1, 2. Parameter φij is related to β22 (t) and γ through
βij (t)/γ
.
(13)
k
Let C be the number of type 1 individuals among the Yt infectious individuals in period t. Conditioning on event {C = i},
one can express Yt+1 in terms of Yt , i.e.
φij =

Yt+1 =

ik
X

Yt k
X

1{Uj =1} +

1{Vj =1} ,

(14)

j=i+1

j=1

where {Uj , j = 1, 2, . . .} and {Vj , j = 1, 2, . . .} are two independent and identically distributed (i.i.d.) sequences of Bernoulli
random variables with success probabilities p1 and p2 , respectively. The two sequences are independent to anything else. Event
{Uj = 1} indicates a type 1 infectious individual successfully transmits the disease to a neighboring node. This occurs with
probability p1 , where
p1 = φ11 p + φ12 (1 − p)
(15)
Similarly, event {Vj = 1} indicates a type 2 infectious individual successfully transmits the disease to a neighboring node with
probability p2 , where
p2 = φ21 p + φ22 (1 − p).

(16)

An infected individual becomes recovered with probability γ, and remains infected otherwise. Hence,
Xt+1 = Yt+1 +

Xt
X

1{Wj =1} ,

(17)

j=1

where {Wj , j = 1, 2, . . .} is an i.i.d. sequence of Bernoulli random variable independent of anything else. The success
probability of Wj is 1 − γ.
We now derive an expression for the transition probability in (11) as a function of p. Let
I1 =

ik
X

1{Uj =1}

(18)

j=1

I2 =

Yt k
X

1{Vj =1}

(19)

1{Wj =1} .

(20)

j=i+1

I3 =

Xt
X
j=1

Fig. 1. A probabilistic SIR model. Nodes shown in solid line are infectious. Nodes shown in dashed line are infected, but not infectious. Each infectious root
node has exactly k contact leaves. Infected nodes that are not infectious can remain infected in the next period, or become recovered.

We can rewrite (14) and (17) in terms of I1 , I2 and I3 , i.e.
Yt+1 = I1 + I2
Xt+1 = Yt + I3 .
Conditioning of event {C = i}, we have
P(Xt+1 = x(t + 1), Yt+1 = y(t + 1)|Xt = x(t),
Yt = y(t), C = i) =
P(I3 = x(t + 1) − y(t), I1 + I2 = y(t + 1)|Xt = x(t),
Yt = y(t), C = i)

(21)

Conditioning on {C = i}, random variables I1 , I2 and I3 all have binomial distributions. Define binomial probability mass
function
 

n

rx (1 − r)n−x x = 0, . . . , n
def
x
b(x, n, r) =

0
otherwise.
The conditional distributions of I1 , I2 and I3 are
P(I1 = i|Xt = x(t), Yt = y(t), C = i) = b(i, ik, p1 )

(22)

P(I2 = i|Xt = x(t), Yt = y(t), C = i)
= b(i, (y(t) − i)k, p2 )

(23)

P(I3 = i|Xt = x(t), Yt = y(t), C = i) = b(i, x(t), γ).

(24)

Substituting (22), (23) and (24) into (21) and noticing that I1 , I2 and I3 are independent, we obtain
P(Xt+1 = x(t + 1), Yt+1 = y(t + 1)|Xt = x(t),
Yt = y(t), C = i) =




min(y(t+1),ik)

X


b(i1 , ik, p1 )b(y(t + 1) − i1 , (y(t) − i)k, p2 )

i1 =0

× b(x(t + 1) − y(t), x(t), γ)

(25)

In addition,
P(C = i|Yt = y(t)) = b(i, y(t), p).

(26)

Taking average to (25) with respect to event {C = i} using (26), we have
P(Xt+1 = x(t + 1), Yt+1 = y(t + 1)|Xt = x(t), Yt = y(t))


y(t)
min(y(t+1),ik)
X
X

=
b(i1 , ik, p1 )b(y(t + 1) − i1 , (y(t) − i)k, p2 ) b(x(t + 1) − y(t), x(t), γ)b(i, y(t), p).
i=0

i1 =0

(27)

Eq. (25) is very complicated to evaluate and it is difficult to be directly used in the optimization problem (12) when y(t),
y(t + 1) or both are large. We now propose an approximation method to simplify (27). First, we take logarithm on (27) to
obtain
log P(Xt+1 = x(t + 1), Yt+1 = y(t + 1)|Xt = x(t), Yt = y(t))


y(t) min(y(t+1),ik)
X
X
= log 
b(i1 , ik, p1 )b(y(t + 1) − i1 , (y(t) − i)k, p2 )b(i, y(t), p) + log(b(x(t + 1) − y(t), x(t), γ)). (28)
i=0

i1 =0

From the De Moivre–Laplace central limit theorem we approximate binomial distributions by normal distributions. Let
N (z, µ, σ 2 ) denote the probability density function (pdf) of a normal random variable with mean µ and variance σ 2 , i.e.,


2
exp −(z−µ)
2
2σ
√
.
N (z, µ, σ 2 ) =
2πσ
First, we approximate probability mass function b(i, y(t), p) in (25) by a normal distribution. Specifically,
P(C ∈ (z, z + dz)) = b(z, y(t), p)
≈ N (z, µ2 , σ22 ) dz,

(29)

where
µ2 = y(t)p
σ22 = y(t)p(1 − p).
Next, recall that conditioning on event {C ∈ (z, z+dz)}, I1 and I2 are independent binomial random variables. We approximate
them by normal pdf’s with means
zkp1 , (y(t) − z)kp2

(30)

zkp1 (1 − p1 ), (y(t) − z)kp2 (1 − p2 ),

(31)

and variances

respectively. Since I1 and I2 are conditionally independent, we have
P(I1 + I2 ∈ (y(t + 1) − 1/2, y(t + 1) + 1/2) | C ∈ (z, z + dz))
≈ N (y(t + 1), zkp1 + (y(t) − z)kp2 ,
zkp1 (1 − p1 ) + (y(t) − z)kp2 (1 − p2 )).

(32)

We propose to further simplify Eq. (32). We apply a mean-field approximation [8], [9] to replace z, which is the sample
value of C, in (30) and (31) with the expectation E[C] = y(t)p. Specifically, let
µ̃1 = y(t)k(pp1 + (1 − p)p2 )
= y(t)R0
σ̃12

= y(t)k(pp1 (1 − p1 ) + (1 − p)p2 (1 − p2 )),

(33)

where
R0 = [φ11 p2 + (φ12 + φ21 )p(1 − p) + φ22 (1 − p)2 ]k
is the basic reproduction number of the branching process. We further approximate σ̃1 defined in (33) by
σ̃12 = y(t)k(pp1 (1 − p1 ) + (1 − p)p2 (1 − p2 ))
≈ y(t)k(pp1 + (1 − p)p2 )
= y(t)R0
assuming that p1 and p2 are small. With these approximations, the logarithmic transition probability reduces to

(34)

log P(Xt+1 = x(t + 1), Yt+1 = y(t + 1)|Xt = x(t), Yt = y(t))



2
1)
exp − (y(t+1)−µ̃
2σ̃12
 + log(b(x(t + 1) − y(t), x(t), γ))
p
≈ log 
2πσ̃12



2
0)
exp − (y(t+1)−y(t)R
2y(t)R0
 + log(b(x(t + 1) − y(t), x(t), γ)).
p
≈ log 
2πy(t)R0

(35)

Since the second term on the right side of the preceding equation is independent of p, maximizing the logarithmic transition
probability is equivalent to maximizing the first term on the right side. Define
(y(t + 1) − y(t)R0 )2
1
− log(2πy(t))
2y(t)R0
2
1
− log(R0 ).
2

def

f (R0 ) = −

(36)

We approximate the optimization problem in (12) by the following optimization problem
p̂(t) = argmax f (R0 ).

(37)

0≤p≤1

To study the extrema of f we differentiate f , i.e.
1
(y(t)R02 − R0 + y(t + 1)2 /y(t))
2R02


1
R0
y(t + 1)2
f 00 (R0 ) = 3
−
.
R0
2
y(t)
f 0 (R0 ) =

(38)

Note that f 0 (R0 ) has a unique positive root, which is
R0 =

−1 +

p
1 + 4y(t + 1)2
.
2y(t)

(39)

The last expression gives the most probable basic reproduction number that produces the sample path (y(t), y(t + 1)). At this
root, the second derivative is negative, i.e.


1
1
y(t + 1)2
00
f (R0 ) = 3
R0 −
R0 2
y(t)


1
R0
= 3 −y(t)R02 −
R0
2
< 0.
Thus,
log P(Xt+1 = x(t + 1), Yt+1 = y(t + 1)|Xt = x(t), Yt = y(t))
achieves maximum when Eq. (39) holds. We solve p from (34) and (39). Recall that we assume (4), (5) and (6). Under these
assumptions, (39) can have a unique root in [0, 1], in which case, the unique root is the solution of the optimization problem
(37). Eq. (39) can have no roots in [0, 1], in which case the solution of (37) is p̂(t) = 0 or p̂(t) = 1. We summarize the solution
of the optimization problem (37) in the following proposition. The proof of the proposition is presented in the appendix at the
end of this report.
Proposition 1. Eq. (39) has two real roots. Either Eq. (39) has exactly one root in interval [0, 1], or it has no root in this
interval. If Eq. (39) has exactly one root in [0, 1], it is the smaller root (denoted by p? ) of the two roots. In this case, the
optimal solution of (37) is p? . If Eq. (39) has no roots in [0, 1], either p? < 0 or p? > 1. In the former case, the optimal
solution is p̂(t) = 0. In the latter case, the optimal solution is p̂(t) = 1.

IV. P ERCOLATION A NALYSIS
In this section we consider a random contact network, in which a disease transmitted by droplets or aerosols spreads according
to an independent cascade model. That is, the disease transmits from a node at one end of an edge to the node at the other
end with a probability. In addition, the transmissions along all edges are independent. We shall present a percolation analysis
of this model and obtain percolation thresholds and sizes of giant components.
We now describe our model. Consider a random graph (G, V, E). Randomly select a node from the graph. Let Z be the
degree of this node. Let g0 (z) denote the probability generating function of Z, i.e.,
g0 (z) =

∞
X

P(Z = k)z k .

(40)

k=0

Now randomly select an edge. Let Y be the excess degree of a node reached along the randomly selected edge. Let g1 (z) be
the probability generating function of Y , i.e.
∞
X
g1 (z) =
P(Y = k)z k .
k=0

Every node in this graph can be one of two types. A type 1 node denotes an individual who wears a facial mask and a type
2 node denotes an individual who does not. A randomly selected node is of type 1 with probability p and is of type 2 with
probability 1 − p. Assume that this event is independent of anything else. As mentioned before, an infectious disease spreads
in this network according to an independent cascade model. Consider a randomly selected edge connecting two nodes, say
node V1 and node V2 . Let φij be the conditional probability that the disease transmits from node V1 to node V2 , given that
the types of nodes V1 and V2 are i and j, respectively, where i, j = 1, 2.
We now present a percolation analysis of the random network model described above. Percolation analysis has been a
useful tool to study resilience of communication networks [10], [11] and epidemic networks [12]–[15]. There are two types
of percolation models, bond percolation and site percolation, depending on whether edges or nodes, respectively, are removed
randomly [8]. Our model is a form of bond percolation, where edges are randomly removed. Removed edges imply that diseases
can not be transmitted from one end of these edges to the other end. The size of the largest component in the percolated
network is the maximum fraction of possibly infected population in the network.
Randomly select an edge. Let V1 and V2 be the two nodes at the two ends of the edge. Suppose that the type of node V1
is i. Let Ei be the event that along the selected edge from V1 , one can not reach a giant component. Let ui = P(Ei ). Now
we condition on the event that the type of node V1 is j. Event Ei will occur, if the randomly selected edge is removed. This
occurs with probability 1 − φij . With probability φij the randomly selected edge is present. Let Y be the number of neighbors
of node V2 , not including V1 . Event Ei will occur, if one can not reach a giant component along any one these Y edges.
Combining these arguments, we have
!
!
∞
∞
X
X
ui = p 1 − φi1 + φi1
P(E1 |Y = k)P(Y = k) + (1 − p) 1 − φi2 + φi2
P(E2 |Y = k)P(Y = k)
k=0

= p 1 − φi1 + φi1

k
∞ X
X

k=0

!
P(E1 |Y = k, C = `) × P(C = `|Y = k)P(Y = k)

k=0 `=0

+ (1 − p) 1 − φi2 + φi2

∞ X
k
X

!
P(E2 |Y = k, C = `) × P(C = `|Y = k)P(Y = k) ,

(41)

k=0 `=0

where C is the number of type 1 nodes connected to node V2 not including V1 . The distribution of C conditioning on Y = k
is binomial. Thus, Eq. (41) becomes
!


∞ X
k
X
k
k−`
`
`
k−`
ui = p 1 − φi1 + φi1
(u1 · u2 ) ×
p (1 − p) P(Y = k)
`
k=0 `=0
!


∞ X
k
X
k
+ (1 − p) 1 − φi2 + φi2
(u`1 · uk−`
)×
p` (1 − p)k−` P(Y = k)
2
`
k=0 `=0

= p(1 − φi1 + φi1 g1 (pu1 + (1 − p)u2 )) + (1 − p)(1 − φi2 + φi2 g1 (pu1 + (1 − p)u2 ))
= 1 − (pφi1 + (1 − p)φi2 )(1 − g1 (pu1 + (1 − p)u2 ))
for i = 1, 2. Eq. (42) is a system of nonlinear equations, from which we can solve for u1 and u2 .

(42)

Once we have u1 and u2 we can compute the giant component size of the percolated network. Randomly select a node
from the network. Let Si , where i = 1, 2, be the conditional probability that the randomly selected node is connected with a
giant component, given that the selected node is of type i. Let X be the degree of the randomly selected node. The node is
connected with a giant component if along at least one of its edges one can reach a giant component. Conditioning on X = k,
let I be the number of type 1 nodes among the k neighbors. Combining all these arguments, we have
Si = 1 −

∞ X
k
X

P(X
uj1 uk−j
2


= k)

k=0 j=0

k
j



pj (1 − p)k−j

= 1 − g0 (pu1 + (1 − p)u2 )
for i = 1, 2. By taking average on the conditional probabilities, a randomly selected node is connected to a giant component
with probability
S = pS1 + (1 − p)S2 .

(43)

This is also the expected size of the giant component.
A. Percolation Threshold
Let u be a 2 × 1 vector over the set of real numbers R. Specifically, let
u = (u1 , u2 )T ,
where symbol T denotes transposition of vectors. Let f be a vector-valued function mapping from R2 to R2 , i.e.,
f (x) = (f1 (x), f2 (x))T =


1 − (pφ11 + (1 − p)φ11 )(1 − g1 (px1 + (1 − p)x2 ))
,
1 − (pφ21 + (1 − p)φ22 )(1 − g1 (px1 + (1 − p)x2 ))

(44)

where x = (x1 , x2 ). Eq. (42) implies that u is a root of
x = f (x).

(45)

The roots of equations of the form (45) are also called the fixed points of function f . It is clear that function f always has
fixed point 1 = (1, 1)T . Lee et al. [16] established that f has an additional fixed point if the dominant eigenvalue of the
Jacobian matrix evaluated at 1 is greater than one. In addition, this fixed point is attractive. The Jacobian matrix for function
f evaluated at x = a is defined as
!
∂f1 (x)
∂x1
∂f2 (x)
∂x1

∂f1 (x)
∂x2
∂f2 (x)
∂x2

(46)
x=a

The Jacobian matrix for the function f defined in (44) evaluated at (1, 1)T is


φ11 p φ12 (1 − p)
J = E[Y ]
,
φ21 p φ22 (1 − p)

(47)

where E[Y ] = g10 (1) is the expected excess degree of a node reached by a randomly selected edge. It is easy to derive the
eigenvalues of J . Denote the two eigenvalues of J by λ1 and λ2 , Then,
√ 
E[Y ] 
pφ11 + (1 − p)φ22 + ∆
2
√ 
E[Y ] 
λ2 =
pφ11 + (1 − p)φ22 − ∆ ,
2

λ1 =

(48)

where
2

∆ = (pφ11 − (1 − p)φ22 ) + 4(1 − p)pφ21 φ12 .
Note that both eigenvalues are real, and λ1 > λ2 . Thus, spectral radius or the dominant eigenvalue of J is λ1 . It is also this
eigenvalue that controls the percolation threshold of the epidemic network.

Fig. 2. Distance between the solution of the constraint optimization using exact transition probability in (27) and the approximated transition probability in
(37).

V. N UMERICAL AND S IMULATION R ESULTS
In this section we present numerical and simulation results. We first verify the accuracy of (35) to approximate the transition
probability in (27). We select an arbitrary set of parameters:
k = 3, x0 = 5, φ22 = 0.8.
According to [2], the efficiency of a typical mask is in the range from 0.58% to 85%. Since masks are typically more efficient
to stop viral transmission if sources wear masks [4], we set η1 = 0.8 and η2 = 0.65. We select a value for p between 0 and
1. We randomly generate ten thousand values for y(t). We perform simulation to generate ten thousand values for y(t + 1)
based on y(t) and p. We solve (12) based on (27) and (37) for the ten thousand values of y(t) and y(t + 1). We calculate the
average distance between the two solutions. The result is shown in Figure 2. This shows that the approximation method works
quite well.
Next, we use the data published by John Hopkins University [5] to predict the spread of the COVID-19 pandemic using
our model. Due to large infection rates of some countries, we assume that k = E[Y ] = 500 in order to have φ22 ≤ 1. We
choose τ = 5 days as the width of a time slot in the time dependent SIR model. We first execute Algorithm 1 on the number
of infected and recovered individuals in the mainland of China. The time functions of β22 (t) and p(t) are shown in Figure
3. The maximum fraction of population who will be infected predicted at time t is also shown in the figure. The epidemic
started from the People’s Republic of China from January, 2020. The authority managed to contain the epidemic very well
by the end of February. However, there are several significant events between January and August of 2020. In mid April, the
Chinese authority revised the way that death toll is calculated [17]. In mid June, Beijing faced a second wave of infections
[18] In mid July, there was a surge of infected number of individuals in Xinjiang [19]. At the end of July, there was a surge in
Dalian [20]. From Figure 3, we see that β22 (t) is large initially in January, and is controlled to reach a small value by the end
of February. The value of β22 (t) again rises and drops before and after the events described above. From Figure 3, note that
p(t) also rises and drops before and after the events. However, function p(t) lags behind function β22 (t). This correlation has
a nice interpretation. Rise in β22 (t) usually manifests itself in the rise of infected number of individuals. As the population
sees a rise in the infected number of individuals, more people wear masks to protect themselves. On the other hand, decreases
of β22 (t) result in less number of newly infected individuals. People typically see this as sign of a safe community. Thus, less
people wear masks in public places. As β22 (t) rises, the predicted size of giant component S(t) also increases. However, as
p(t) catches up and rises, S(t) decreases. Notice that the time sequence β22 (t) reflects a joint efforts of many measures to
contain the epidemic. Wearing facial masks is a measure in the personal level. Shutting down schools, businesses, and keeping
people at home is a measure in the government level. In this paper, we consider only the measure of wearing masks and ignore
other measures. Thus, p(t) in Figure ?? may be higher than the actual fraction of population who wear masks, as it reflects a
joint effect of many measures to contain the epidemic.
Next we study the epidemics of the United States of America, India and France. We execute Algorithm 1 to compute β22 (t),
p(t) and S(t). The time functions of β22 (t), p(t) and S(t) for the three countries are shown in Figure 4, Figure 5 and Figure
6, respectively. We present p(t) and S(t) of the three countries in Figure 5 and Figure 6. Since these functions fluctuate a lot,

Fig. 3. Time functions β22 (t), p(t), S(t) of mainland China.

Fig. 4. β22 (t) of the U.S., India and France.

we use a built-in Matlab function to compute the polynomial regression of these functions in order to show a general trend.
Note that India has a smaller infection rate β22 (t) than that of the U.S.A. However, India has a much smaller predicted size
of giant component than that of the U.S.A. This is because India has a very large recovery rate [21], [22]. We also note that
around July France has a β22 (t) comparable with that of the US. However, France has a high predicted S(t) after August. It
is worth noting that p(t) of France in mid August is not close to 1. By raising p(t), France may have a better control of the
epidemics.
VI. C ONCLUSIONS
In this report, we presented a time dependent SIR model, in which some individuals wear facial masks and some do not.
Based on the number of infected individuals and the number of recovered individuals published by J. H. University, we estimate
the disease infection rates and recovery rates. We proposed a probabilistic version of the SIR model. We derived the transition

Fig. 5. p(t) of the U.S., India and France..

Fig. 6. Predicted size of giant component of the U.S., India and France.

probability of this random SIR model. By maximizing the transition probability, we estimate the most probable value of the
fraction of population who wear masks. This transition probability numerically difficult to compute, if the states of model
are large. Based on central limit theorem, we proposed an approximation. Through numerical and simulation study, we show
that the approximation works well. Finally we carried out a percolation analysis to predict the eventual fraction of population
who will be infected with the disease. We proposed a progress analysis of the epidemics. Using results from the progressive
analysis, we analyzed the epidemics of four countries.

Appendix
In this appendix, we prove Proposition 1.
Proof of Proposition 1. We rewrite R0 defined in (34) to show dependency with p explicitly, i.e.
R0 (p) = kφ22 (η1 η2 p2 − (η1 + η2 )p + 1).

(49)

In (49) we have assumed (4), (5) and (6). Note that η1 < 1 and η2 < 1. Since the right side of (49) is a quadratic polynomial
in p, it is easy to establish the following results.
1) R0 (0) > R0 (1) > 0.
2) R00 (0) = kφ22 (−η1 − η2 ) < 0.
3) R00 (1) = kφ22 (η1 (η2 − 1) + η2 (η1 − 1)) < 0.
4) The minimum of R0 (p) occurs at
1
1
+
.
p=
2η1
2η2
This point is greater than one, since η1 < 1 and η2 < 1.
5) The minimum of R0 (p) is
η1 η2 (η1 − η2 )2
−kφ22
,
4η12 η22
which is negative.
From the results above and the fact that the right side of (39) is positive, it follows that (39) must have two real roots. It also
follows from the results above that R0 (p) is monotonically decreasing and (39) can not have two roots in [0, 1]. Since R0 (p)
is decreasing for p ∈ [0, 1], it follows that if (39) has exactly one root in [0, 1], the root is p? . It is also quite clear that if (39)
has a unique root in [0, 1], the root is the optimal solution of (37).
Now we analyse cases, in which (39) does not have roots in [0, 1]. Since R0 (p) is decreasing for p ∈ [0, 1], it follows that
either both roots of (39) are greater than 1, or p? < 0 and the other root is greater than 1. We now analyze these two cases
separately. We first note that we have treated R0 as an independent variable in (37). Thus, the derivative f 0 (R0 ) is with respect
to R0 . In the two cases in which Eq. (39) has no roots in [0, 1], we have to treat the objective function in (37) as a function
of p. Specifically, the derivative of the objective function with respect to p is
d
f (R0 (p)) = f 0 (R0 )R00 (p),
dp

(50)

where f 0 (R0 ) is given in (38). We claim that in the first case the objective function of (37 is increasing for all p ∈ [0, 1]. Thus,
the optimal solution of (37) is p̂(t) = 1. We also claim that in the second case, the objective function of (37 is decreasing for
all p ∈ [0, 1]. Thus, the optimal solution of (37) is p̂(t) = 0.

We now prove the two claims. From (38) and (50),
d
1
h(R0 )R00 (p),
f (R0 (p)) =
dp
2R02
where
h(R0 ) = −y(t)R02 − nR0 +

(51)

y(t + 1)2
.
y(t)

Note that h is a quadratic and concave function of R0 with h(0) = y(t + 1)2 /y(t) > 0. Function h has a zero at R0 = c,
where c is the right side of (39), i.e.
p
−n + n2 + 4y(t + 1)2
c=
.
2y(t)
If c < R0 (1), both roots of (39) are greater than 1. This corresponds to the first case. If c > R0 (0), then p? < 0 and the other
root is greater than 1. This corresponds to the second case. In the first case,
R0 (p) > c
for all p ∈ [0, 1]. Thus,
h(R0 (p)) < g(c) = 0
for all p ∈ [0, 1]. From (51), it follows that df (R0 (p))/dp > 0, since R00 (p) < 0 for all p ∈ [0, 1]. This proves the first claim.
In the second case,
R0 (p) < c
for all p ∈ [0, 1]. Thus,
h(R0 (p)) > g(c) = 0
for all p ∈ [0, 1]. From (51), it follows that df (R0 (p))/dp < 0. This proves the second claim.
R EFERENCES
[1] A. C. K. Lai, C. K. M. Poon, and A. C. T. Cheung, “Effectiveness of facemasks to reduce exposure hazards for airborne infections among general
populations,” Journal of the Royal Society Interface, vol. 9, no. 70, p. 938, 2012.
[2] N. C. J. Brienen, A. Timen, J. Wallinga, J. E. V. Steenbergen, and P. F. M. Teunis, “The effect of mask use on the spread of influenza during a pandemic,”
Risk Analysis, vol. 30, no. 8, pp. 1210–1218, 2010.
[3] A. Davies, K.-A. Thompson, K. Giri, G. Kafatos, J. Walker, and A. Bennett, “Testing the efficacy of homemade masks: Would they protect in an
influenza pandemic?” Disaster medicine and public health preparedness, vol. 7, pp. 413–418, August 2013.
[4] R. B. Patel, S. D. Skaria, M. M. Mansour, and G. C. Smaldone, “Respiratory source control using a surgical mask: An in vitro study,” Journal of
Occupational & Environmental Hygiene, 2016.
[5] CSSEGISandData and J. H. University, Covid-19, 2020. [Online]. Available: https://github.com/CSSEGISandData/COVID-19
[6] D. Kempe, J. Kleinberg, and E. Tardos, “Maximizing the spread of influence through a social network,” 2003, pp. 137–146.
[7] D. Easley and J. Kleinberg, Networks, crowds and markets reasoning about a highly connected world. Cambridge University Press, 2010.
[8] M. Newman, Networks: An Introduction. New York: Oxford University Press, 2010.
[9] A. Wipf, “Statistical approach to quantum field theory : An introduction,” Lect.Notes Phys., vol. 864, pp. 1–390, Nov 2012.
[10] R. Cohen, K. Erez, D. ben Avraham, and S. Havlin, “Resilence of the internet to random breakdowns,” Phys. Rev. Lett., vol. 85, pp. 4626–4628, 2000.
[11] Y. Hu, B. Ksherim, R. Cohen, and S. Havlin, “Percolation in interdependent and interconnected networks: Abrupt change from second- to first-order
transitions,” Phys. Rev. E., vol. 84, p. 066116, 2011.
[12] L. Sander, C. Warren, I. Sokolov, C. Simon, and J. Koopman, “Percolation on heterogeneous networks as a model for epidemics,” Mathematical
Biosciences, vol. 80, pp. 293–305, November-December 2002.
[13] C. Moore and M. Newman, “Epidemics and percolation in small-world networks,” Phys. Rev. E, vol. 61, p. 5678, 2000.
[14] J. Cardy and P. Grassberger, “Epidemic models and percolation,” J. Phys. A: Math. Gen., vol. 18, no. 6, 1985.
[15] M. Á. Serrano and M. Boguná, “Percolation and epidemic thresholds in clustered networks,” Physical review letters, vol. 97, no. 8, p. 088701, 2006.
[16] D.-S. Lee, C.-S. Chang, M. Zhu, and H.-C. Li, “A generalized configuration model with degree correlations and its percolation analysis,” Applied
Network Science, vol. 4, no. 1, p. 124, Dec 2019. [Online]. Available: https://doi.org/10.1007/s41109-019-0240-2
[17] The death toll in Wuhan was revised from 2579 to 3869 (4/17), 2020. [Online]. Available: http://www.china.org.cn/china/Off the Wire/2020-04/17/
content 75943843.htm
[18] Wikipedia, COVID-19 pandemic in Beijing, 2020. [Online]. Available: https://en.wikipedia.org/wiki/COVID-19 pandemic in Beijing#June
[19] ——, COVID-19 pandemic in Xinjiang, 2020. [Online]. Available: https://en.wikipedia.org/wiki/COVID-19 pandemic in Xinjiang#July 2020
[20] en.people.cn, Officials rule out domestic transmission as origin of Dalian COVID-19 cluster, 2020. [Online]. Available: http://en.people.cn/n3/2020/
0803/c90000-9717687.html
[21] T.
of
India,
Coronavirus
recovery:
What
do
India’s
high
COVID
recovery
numbers
really
mean?
We
explain,
2020.
[Online].
Available:
https://timesofindia.indiatimes.com/life-style/health-fitness/health-news/
coronavirus-recovery-what-do-indias-high-covid-recovery-numbers-really-mean-we-explain/photostory/78102510.cms
[22] H. Times, India’s Covid-19 recovery rate surges past 78%, one of the highest globally: Govt, 2020. [Online]. Available: https://www.hindustantimes.
com/india-news/india-s-covid-19-recovery-rate-surges-past-78-one-of-the-highest-globally-govt/story-wU8YaDW6qG6WEBieTzoD7J.html

