COVID-19 infectivity proﬁle
correction
Peter Ashcroft1* , Jana S. Huisman1 , Sonja Lehtinen1 , Judith A. Bouman1 , Christian
L. Althaus2 , Roland R. Regoes1 , Sebastian Bonhoeffer1*
*For correspondence:
peter.ashcroft@env.ethz.ch (PA);

1 Institute

of Integrative Biology, ETH Zürich, Zürich, Switzerland; 2 Institute of Social and

arXiv:2007.06602v1 [q-bio.PE] 13 Jul 2020

seb@env.ethz.ch (SB)

Preventive Medicine, University of Bern, Bern, Switzerland

Abstract The infectivity proﬁle of an individual with COVID-19 is attributed to the paper Temporal
dynamics in viral shedding and transmissibility of COVID-19 by He et al., published in Nature Medicine
in April 2020. However, the analysis within this paper contains a mistake such that the published
infectivity proﬁle is incorrect and the conclusion that infectiousness begins 2.3 days before
symptom onset is no longer supported. In this document we discuss the error and compute the
correct infectivity proﬁle. We also establish conﬁdence intervals on this proﬁle, quantify the
difference between the published and the corrected proﬁles, and discuss an issue of normalisation
when ﬁtting serial interval data. This infectivity proﬁle plays a central role in policy and decision
making, thus it is crucial that this issue is corrected with the utmost urgency to prevent the
propagation of this error into further studies and policies. We hope that this preprint will reach all
researchers and policy makers who are using the incorrect infectivity proﬁle to inform their work.

Introduction
While investigating the results of the paper Temporal dynamics in viral shedding and transmissibility of
COVID-19 (He et al., 2020), we have found an erroneous step in the likelihood calculation which is
cause for concern. The consequence of this step is that two datapoints with negative serial interval
are dropped from the calculation, without any explicit mentioning in the text of the manuscript.
The inclusion of these datapoints results in an infectiousness proﬁle that is substantially different
from the one shown in Figure 1C of your original publication. As a result, the infectiousness starts
signiﬁcantly before the reported 2.3 days before the onset of symptoms. We still ﬁnd, however, a
presymptomatic infection fraction of ∼ 45% in agreement with the conclusion of He et al. (2020).
Given that the estimate of 2.3 days of infectiousness before symptom onset is highly relevant to the
implementation of contact tracing, we believe it is of very high importance to clarify this situation.
Our reanalysis suggests that tracing contacts of infected index cases as far back as 2 or 3 days
before symptom onset in the index case might not be suﬃcient to ﬁnd all secondary cases. In
addition, we remark on a less consequential issue with the normalisation of the likelihood, which

1 of 5

awards higher weight to transmission pairs with more uncertain symptom onset times of the index
case, but does not affect the results signiﬁcantly. Due to the central position this study currently
has in the ﬁeld, there is a high probability that these errors propagate in future studies. Therefore,
a fast response towards this issue is crucial. We note that detecting this issue was only possible
thanks to the availability and accessibility of the code and data that accompany the publication.
With this letter we address the following three points:
1. The infectivity proﬁle is computed without erroneously dropping datapoints and we compare
this corrected proﬁle with the published proﬁle;
2. Conﬁdence intervals via likelihood proﬁling are provided for the infectivity proﬁle;
3. An issue relating to the normalisation of the likelihood over serial interval ranges is discussed.

Results

B 100%

0.3

cumulative infectivity

A
infectivity

He et al.
corrected

0.2

0.1

0.0
−10

−5

0

5

days after symptom onset

10

75%

50%

25%

0%
−10

−5

0

5

10

days after symptom onset

Figure 1. The infectivity proﬁles extracted from the serial interval data and the log-normally distributed
incubation period, as performed in He et al. (2020). Here we use an adaptive grid search to reconstruct the
likelihood landscape over the three parameters of the shifted gamma distribution. The conﬁdence intervals are
the range of the infectivity proﬁles which have a likelihood-ratio test statistic within 95% of a 𝜒 2 distribution with
3 degrees of freedom when compared to the maximum likelihood estimate. Panel A shows the probability
density function and is analogous to Figure 1C of He et al. (2020). The blue dashed line is the maximum
likelihood estimate using the method from He et al. (2020), while the solid orange line is the corrected
maximum likelihood estimate. Panel B shows the corresponding cumulative density functions.

The infectivity proﬁle, 𝑝(𝑡), describes the infectiousness of an individual at a time 𝑡 relative to
the onset of their symptoms. When this is convolved with an incubation period distribution 𝑔(𝑡)
[from Li et al. (2020)], one recovers the serial interval distribution, describing the time between
symptom onsets in a transmission pair. This approach was used in (He et al., 2020), with a ﬁxed
incubation period distribution and empirical serial interval distribution, to infer the infectivity proﬁle
for COVID-19.
The optimisation procedure maximises the likelihood of observing the empirical serial interval
distribution under a model, which is speciﬁed by the parameters of the infectivity proﬁle. This
proﬁle is parametrised as a shifted gamma distribution. Full details of this procedure can be found
in He et al. (2020).

2 of 5

In the ﬁtting procedure used in the script Fig1c_Rscript.R (available at https://github.com/
ehylau/COVID-19), the following condition is used in the return line of the likelihood function:
return(-sum(lli[!is.infinite(lli)]))
This condition will erroneously drop any datapoint that has a probability of zero (and hence a
log-probability of −∞) under the current model parameters. As the optimisation is initiated with
a shift value of 2.5 days, two datapoints (54 and 68) are dropped from the beginning of the ﬁt
procedure. This then leads to an erroneous maximum likelihood infectiousness proﬁle, which is
displayed in Figure 1C of the original manuscript (He et al., 2020). Initiating the ﬁtting procedure at
a shift of 4 days shows convergence to a very different optimum infectiousness proﬁle.
Here we use an adaptive grid search algorithm to scan the three-dimensional parameter space
of the shifted gamma distribution which describes the infectiousness proﬁle. We compute the
log-likelihood with and without the return condition in the likelihood function at each point in
parameter space to construct likelihood surfaces. The maximum likelihood parameter values that
we ﬁnd are enumerated in Table 1.
parameter

He et al.

corrected

shape

1.56250

97.18750

rate

0.53125

3.71875

shift (days)

2.12500

25.62500

Table 1. Maximum likelihood parameter estimates based on our adaptive grid search approach using the
method of (He et al., 2020) and the corrected computation.

We construct conﬁdence intervals around the distribution via likelihood ratio tests, compared to
the maximum likelihood estimate (also known as likelihood proﬁling). This leads to the optimum
infectivity proﬁles and conﬁdence intervals shown in Figure 1. We also ﬁnd a presymptomatic
infection fraction of 45.6% [23.8%,75.8%] using the He et al. (2020) method and 43.7% [26.4%,64.5%]
using the corrected proﬁle, where numbers in square brackets represent the 95% conﬁdence
interval.
The correct optimum ﬁts in Figure 1 are smoother than the ones which drop the data points.
Although there is some asymmetry in the proﬁles within the conﬁdence interval, the correct
optimum solution has a very large shape parameter and approaches a normal distribution. We can
also use these ﬁtted distributions to reconstruct the serial interval (Fig. 2), the distribution of which
is broader when all datapoints are taken into account.
To further quantify the difference between the published and corrected infectivity proﬁles,
we can use an example based on contact tracing. We use the infectivity proﬁles to answer the
following question: What fraction of presymptomatic infections are traced if we look back 𝑡 days
from symptom onset? Formally, this fraction is deﬁned as
0

𝑓 (𝑡) =

∫−𝑡 𝑝(𝑡′ )d𝑡′
0

.

(1)

∫−∞ 𝑝(𝑡′ )d𝑡′

3 of 5

0.15

probability

corrected
He et al.

0.10

0.05

0.00
−10

0

10

20

serial interval (days)
Figure 2. Using the maximum likelihood estimates of the infectivity proﬁle from Fig. 2 we can reconstruct the
serial interval. We sample 106 infection times from the infectivity proﬁle, and add this to samples from the
log-normally distributed incubation period to generate samples of the serial interval. We then plot the
probability density of these serial intervals (ﬁlled density proﬁles). We compare this to the serial interval data
used in He et al. (2020), where we have added points for each day in the possible serial interval range.

These values are enumerated in Table 2. We see that while the published infectivity proﬁle suggests
98% of presymptomatic infections occur within two days symptom onset, the corrected distribution
suggests on 61% of presymptomatic infections will be traced. Thus the published proﬁle overestimates the eﬃcacy of contact tracing, while the corrected distribution tells us we need to look back
at least 4 days to catch 90% of presymptomatic infections.
time (days)

He et al.

corrected

1

50% [37%,100%]

33% [19%,51%]

2

98% [87%,100%]

61% [40%,83%]

3

100% [100%,100%]

80% [57%,96%]

4

100% [100%,100%]

91% [71%,99%]

5

100% [100%,100%]

97% [82%,100%]

Table 2. The fraction of presymptomatic infections that are traced if we look back 𝑡 days from symptom onset
using the published and corrected infectivity proﬁles. The computed quantity 𝑓 (𝑡) is described in Eq. 1. Values
in brackets represent 95% conﬁdence intervals of 𝑓 (𝑡) when accounting for the uncertainty in the infectivity
proﬁles.

A second less-consequential problem in the methodology of He et al. (2020) is that a normalisation factor is missing in the likelihood function when considering transmission pairs with
serial interval estimates speciﬁed by a range. Ignoring this normalisation awards higher weight to
transmission pairs with more uncertain symptom onset times of the index case.
Concretely, the probability under model 𝜃 to observe a window of symptom onset of the index
case (𝑡𝑆1𝑙 , 𝑡𝑆1𝑢 ) and symptom onset in the secondary case on day 𝑡𝑆2 is deﬁned in the original
manuscript as
𝐿(𝑡𝑆1𝑢 , 𝑡𝑆1𝑙 , 𝑡𝑆2 |𝜃) =

𝑡𝑆1𝑢

𝑡𝑆2

∫𝑡𝑆1𝑙 ∫−∞

𝑝(𝑡𝐼 − 𝑡𝑆1 )𝑔(𝑡𝑆2 − 𝑡𝐼 )d𝑡𝐼 d𝑡𝑆1 ,

(2)

where 𝑝(𝑡) is the infectivity proﬁle and 𝑔(𝑡) is the incubation period distribution. The outer integral

4 of 5

over the symptom onset window of the index case should include an accompanying probability to
observe the onset time 𝑡𝑆1 , Pr(𝑡𝑆1 ). I.e.
𝑡

𝐿(𝑡𝑆1𝑢 , 𝑡𝑆1𝑙 , 𝑡𝑆2 |𝜃) =

𝑡

𝑆2
∫𝑡 𝑆1𝑢 Pr(𝑡𝑆1 ) ∫−∞
𝑝(𝑡𝐼 − 𝑡𝑆1 )𝑔(𝑡𝑆2 − 𝑡𝐼 )d𝑡𝐼 d𝑡𝑆1
𝑆1𝑙

𝑡

∫𝑡 𝑆1𝑢 Pr(𝑡𝑆1 )d𝑡𝑆1

.

(3)

𝑆1𝑙

Assuming a uniform distribution for Pr(𝑡𝑆1 ), this simpliﬁes to
𝑡

𝐿(𝑡𝑆1𝑢 , 𝑡𝑆1𝑙 , 𝑡𝑆2 |𝜃) =

𝑡

𝑆1𝑢
𝑆2
1
𝑝(𝑡𝐼 − 𝑡𝑆1 )𝑔(𝑡𝑆2 − 𝑡𝐼 )d𝑡𝐼 d𝑡𝑆1 .
𝑡𝑆1𝑢 − 𝑡𝑆1𝑙 ∫𝑡𝑆1𝑙 ∫−∞

(4)

We ﬁnd that including this normalisation has little effect on the location of the optimum ﬁt. However,
these full details should have been included in the optimisation procedure.

Footnotes
The code used to generate these results is archived at https://zenodo.org/badge/latestdoi/278170144.

References
He X, Lau EHY, Wu P, Deng X, Wang J, Hao X, Lau YC, Wong JY, Guan Y, Tan X, Mo X, Chen Y, Liao B, Chen W, Hu F,
Zhang Q, Zhong M, Wu Y, Zhao L, Zhang F, et al. Temporal Dynamics in Viral Shedding and Transmissibility of
COVID-19. Nat Med. 2020 May; 26(5):672–675. doi: 10.1038/s41591-020-0869-5.
Li Q, Guan X, Wu P, Wang X, Zhou L, Tong Y, Ren R, Leung KSM, Lau EHY, Wong JY, Xing X, Xiang N, Wu Y,
Li C, Chen Q, Li D, Liu T, Zhao J, Liu M, Tu W, et al. Early Transmission Dynamics in Wuhan, China, of
Novel Coronavirus–Infected Pneumonia. New England Journal of Medicine. 2020; 382(13):1199–1207. doi:
10.1056/NEJMoa2001316.

5 of 5

