Equilibrium Oil Market Share under the COVID-19 Pandemic
Xiaojun Chena,∗, Yun Shib , Xiaozhou Wanga

arXiv:2007.15265v1 [math.OC] 30 Jul 2020

a

Department of Applied Mathematics, The Hong Kong Polytechnic University, Hong Kong, China
b
Blue Balloon Innovative Limited, Charmhill Center, Tsimshatsui, Hong Kong, China

Abstract
Equilibrium models for energy markets under uncertain demand and supply have attracted considerable attentions. This paper focuses on modelling crude oil market share
under the COVID-19 pandemic using two-stage stochastic equilibrium. We describe the
uncertainties in the demand and supply by random variables and provide two types of
production decisions (here-and-now and wait-and-see). The here-and-now decision in
the first stage does not depend on the outcome of random events to be revealed in the
future and the wait-and-see decision in the second stage is allowed to depend on the
random events in the future and adjust the feasibility of the here-and-now decision in
rare unexpected scenarios such as those observed during the COVID-19 pandemic. We
develop a fast algorithm to find a solution of the two-stage stochastic equilibrium. We
show the robustness of the two-stage stochastic equilibrium model for forecasting the oil
market share using the real market data from January 2019 to May 2020.
Keywords: Two-stage stochastic equilibrium, oil market share, COVID-19 pandemic,
uncertain demand and supply.

1. Introduction
In this paper, we consider the two-stage stochastic equilibrium model under uncertain
demand and supply for forecasting the market share in an oligopoly market. This model
is developed based on noncooperative game theory which allows us to investigate how
the market share of one product (oil, electricity, steel, etc.) depends on the strategies
of a few agents whose decisions against and affect each other. A Nash-equilibrium for
oligopolies is expected, in which costs and benefits are balanced so that no agent can
gain by changing only their own strategies. The uncertainties in the future events are
represented by random variables in the model. The COVID-19 pandemic has significant
impact on the global energy industry and arouse great challenging in maintaining market
stability. Whether we can expect a Nash-equilibrium for crude oil market share during
the COVID-19 pandemic is an interesting question.
In traditional oil industry, each producer has normally two strategies for maximizing
its profits. One is to limit supply which leads to high oil price and this approach allows
high-cost producers to remain profitable. The other is to drive up production and squeeze
out high-cost producers, e.g., US shale oil, under expected low price market environment.
It has been shown that under certain conditions, one strategy can be more appropriate
∗

Corresponding author
Email addresses: maxjchen@polyu.edu.hk (Xiaojun Chen), admin@bbinnovative.com (Yun Shi),
xzhou.wang@connect.polyu.hk (Xiaozhou Wang)

Preprint submitted to Elsevier

July 31, 2020

than the other [2]. However, the change in production had inconsistent market responses
due to the complex and uncertain nature of oil market [24, 34]. Furthermore, it has been
observed that even during the periods of violently volatile in oil market, the relative
market share remained stable. See Tables 3-4 for monthly oil market share from January
2019 to May 2020.
The industry of oil is no stranger to volatilities in price, supply and demand [26, 45].
Economic growth can be largely affected by oil volatility, and certain countries may be
more sensitive than the others [30, 33, 42]. Most of these changes, the so-called oil
shocks, were caused by the occurrence of major events of global economics and dramatic
trends shifting that affects supply or/and demand sides in the crude oil market, and the
situation was no different in the latest oil shock during COVID-19 pandemic. Events
of the crude oil market are capable of delivering significant impact on energy markets
as well as non-energy markets [23, 27, 32]. It is believed, however, despite different
causes of oil shock, their consequences for economy are very similar [22]. The most
apparent observation on oil uncertainty is its price, and it is naturally assumed as of
certain importance to market participants. However, being an oligopoly market implies
that the price is largely manipulated by major producers. In particular, these producers
may choose to sell greater quantity of oil at a lower price over the strategies of limiting
supply to boost price, because the former can be more profitable in long run. There are
many attempts on predicting crude oil price recently using tools of machine learning and
artificial intelligence [1, 3, 43].
To analyze the oil market share under uncertain supply and demand, we model the
production decisions as a solution of a two-stage stochastic game. The two-stage stochastic game is suitable to reflect the complexity of the trading process while market demand
needs to be predicted/estimated at the second stage to guide the production at the first
stage for a certain period of time in the future. In the two-stage stochastic game, we
have two types of decisions: “here-and-now” and “wait-and-see” for each agent. Endowed
with market data of production, supply, demand, cost and price of the commodity, each
agent chooses its here-and-now decision and wait-and-see decision with and without observation of uncertainties in the future events, respectively. For each agent, the objective
of the first stage is to maximize its expected utilities under capacity constraints, and
the objective of the second stage is to maximize its utilities subject to constraints endowed with its here-and-now decision and recourse term for almost every realization.
The structure of the two-stage stochastic game is a natural way to represent the equilibrium state under uncertain environment. Each agent must make a here-and-now decision
for a production plan before knowing the future events. The here-and-now decision will
affect future revenues, cost and feasibilities over the decision horizon. The wait-and-see
decision is made by taking the uncertain demand, supply and price in the future market
into account. Assuming that the utility functions at both stages are concave and continuously differentiable, we can derive the equivalent two-stage stochastic equilibrium
model by the first-order optimality condition, which is a special case of the two-stage
stochastic variational inequalities (SVI).
Variational inequalities play a central role in operations research and optimization,
which model equilibrium problems in engineering and economics [16] and represent the
optimality conditions of the optimization problems [39]. Stochastic variational inequalities (also called one-stage SVI ) [4, 15, 17, 20, 21, 28, 29, 37] consider a here-and-now
solution in an uncertain environment using expectation of random functions. Compared
with the one-stage SVI, the two-stage SVI consider a pair of a here-and-now solution and
a wait-and-see solution, which have inherently dynamic components that involve uncer2

tain information and whose solutions depend on the outcome of random events to be
revealed in the future. In the last few years, the two-stage SVI and multi-stage SVI have
attracted considerable attention [5, 7, 6, 9, 10, 25, 35, 40, 41]. Chen, Pong and Wets [5],
and Rockafellar and Wets [40] introduced the the two-stage SVI and multi-stage SVI with
examples including the first-order optimality conditions for stochastic programs, Walras
equilibrium problems with an incomplete financial market and stochastic Wardrop traffic
flow equilibrium problems. The existence and uniqueness of solutions of the two-stage
SVI, and convergence of its sample average approximation have been investigated in
[6, 7]. The Progressive Hedging Algorithm (PHA) [38] for scenarios and policy aggregation in optimization under uncertainty has been extended to solve monotone two-stage
SVI in [41].
Our contributions in this paper are twofold. We develop new optimization theory
and algorithms for the two-stage SVI arising from an oligopoly market. Furthermore,
we apply the new optimization results to show the existence of a Nash-equilibrium for
oil production game in an uncertain environment. In particular, we model the game of
crude oil production with a few agents as the two-stage SVI, and show the existence and
uniqueness of solutions of the two-stage SVI. Moreover, we develop a fast algorithm to
find a solution of the two-stage SVI, which is used to analyze and forecast oil market
share under the CODVI-19 pandemic.
This paper is organized as follows. In section 2, we present the two-stage SVI arising
from two-stage stochastic games. In section 3, we show the existence and uniqueness of
the solution of the two-stage SVI and provide perturbation error bounds for the solution.
In section 4, we develop a fast algorithm called Alternation Block Algorithm (ABA) to
find a solution of the two-stage stochastic equilibrium. The computational cost of the
ABA is much less than the popular PHA. We show outperformance of the ABA over the
PHA using large-scale numerical examples. In section 5, we apply the two-stage SVI,
our new theory and algorithm to study the impact and the production responses of oil
producers during COVID-19 on oil market share. Our numerical results with real market
data from January 2019 to May 2020 show the efficiency of our methods for modelling
oil market share.
2. Two-stage stochastic quadratic games
We consider an oligopolistic market where J agents compete to supply a homogeneous
product noncooperatively in the future. Each agent needs to make a decision on the
quantity of production based on the anticipated future market demand and supply and
other agents’ decision in an uncertain environment. The uncertainties are represented
by a random variable ξ : Ω → Ξ ⊂ Rm defined in the probability space (Ω, F, P) with a
support set Ξ and the space Y of measurable functions from Ξ to RJ .
We define the variables and functions for each agent i, i = 1, . . . , J.
xi ∈ R, the production quantity
θi : R → R, the cost function of the production
yi (ξ) ∈ R, the supply quantity
ϕi : R × Ξ → R, the cost function for supplying a quantity
The uncertain
market supply and demand are characterized by a random total supply
PJ
η(ξ) =
y
(ξ)
to the market and a random inverse demand function p(η(ξ), ξ) :
i=1 i
R × Ξ → R. Here p(η(ξ), ξ) can be regarded as the spot price of trading in the future.
Each agent aims to maximize its profit and make its decision in two stages. The
first stage is to make optimal decision on production quantity based on the average of
3

random demand, and the second stage is to make optimal decision on supply quantity
based on the observation of the uncertainty in the future. The first stage decision is
called “here-and-now” and the second stage decision is called “wait-and-see”.
For each realization of random variable ξ and a nonnegative vector x ∈ RJ , agent i
wants to find an optimal decision yi (ξ) by solving the following problem
p(yi (ξ) + y−i (ξ), ξ)yi (ξ) − ϕi (yi (ξ), ξ)

Fi (x, ξ) := max
yi (ξ)

s.t. 0 ≤ yi (ξ) ≤ xi ,

a.e. ξ ∈ Ξ.

(1)

Moreover, agent i has to make an optimal decision before knowing the future events by
solving
max E[Fi (x, ξ)] − θi (xi , xi−1 )
xi

(2)

0 ≤ xi .

s.t.

Here x−i and y−i are decision variables of the agents other than the agent i.
Problem (2) is the first stage, and problem (1) is the second stage of the two-stage
stochastic games [6, 7, 25, 36]. We call (x∗ , y ∗ ) ∈ RJ × Y an optimal solution of the
two-stage stochastic games, if for i = 1, . . . , J, (x∗i , yi∗ (ξ)) is the optimal solution of the
two-stage optimization problem
max E[Fi (xi , x∗−i , ξ)] − θi (xi , x∗i−1 )
xi

s.t.

(3)

0 ≤ xi ,

∗ (ξ), ξ)y (ξ) − ϕ (y (ξ), ξ)
Fi (xi , x∗−i , ξ) := max p(yi (ξ) + y−i
i
i i
yi (ξ)

s.t.

0 ≤ yi (ξ) ≤ xi ,

a.e. ξ ∈ Ξ.

(4)

In this paper, we consider the case where the objective functions in (1)-(2) are
quadratic concave in the following forms
J

X
1
θi (xi , x−i ) = ci x2i + ai xi + ri xi
xj ,
2

(5)

j=1

p(yi (ξ) + y−i (ξ), ξ) = α(ξ) − γ(ξ)

J
X

yj (ξ),

(6)

j=1

1
ϕi (yi (ξ), ξ) = hi (ξ)yi2 (ξ) + βi (ξ)yi (ξ),
(7)
2
where ci > 0, γ(ξ) > 0, hi (ξ) > 0, ai , ri , α(ξ) and βi (ξ) are real given numbers. In such
setting, the function
Fi (x, ξ) = max (α(ξ) − γ(ξ)
yi (ξ)

s.t.

J
X
j=1

0 ≤ yi (ξ) ≤ xi ,

1
yj (ξ))yi (ξ) − hi (ξ)yi2 (ξ) − βi (ξ)yi (ξ)
2
a.e. ξ ∈ Ξ

is continuously differentiable with respect to (w.r.t.) xi for xi > 0 and
∇xi Fi (x, ξ) = si (ξ),
4

where si (ξ) ≥ 0 are Lagrange multipliers for the constraints yi (ξ) ≤ xi . If xi = 0, then
the optimal solution of the optimization problem (4) is yi (ξ) ≡ 0 for any ξ ∈ Ξ, and the
subdifferential ∂xi Fi (x, ξ) of Fi (x, ξ) is
{si (ξ) | si (ξ) ≥ max(0, α(ξ) − βi (ξ) − γ(ξ)eT y(ξ)), E[si (ξ)] ≤ ri eT x + ai }.
The Karush-Kuhn-Tucker (KKT) conditions of problems (1)-(2) with the functions
defined in (5)-(7) derive the following two-stage stochastic linear complementarity problem (LCP)

 

x
(C + reT )x − E[s(ξ)] + a
0 ≤ y(ξ) ⊥ (H(ξ) + γ(ξ)eeT )y(ξ) + s(ξ) + ρ(ξ) ≥ 0,
(8)
s(ξ)
x − y(ξ)
for almost every ξ ∈ Ξ, where
x = (x1 , . . . , xJ )T ,

a = (a1 , . . . , aJ )T ,

y(ξ) = (y1 (ξ), . . . , yJ (ξ))T ,

r = (r1 , . . . , rJ )T ,

s(ξ) = (s1 (ξ), . . . , sJ (ξ))T ,

ρ(ξ) = (−α(ξ) + β1 (ξ), . . . , −α(ξ) + βJ (ξ))T ,
C = diag(c1 + r1 , . . . , cJ + rJ ),

H(ξ) = diag(h1 (ξ) + γ(ξ), . . . , hJ (ξ) + γ(ξ)),

RJ

and e ∈
is the vector with all elements being 1.
When the matrix C + reT is positive definite, problems (1)-(2) with the functions
defined in (5)-(7) are equivalent to problem (8) in the sense that if (x∗ , y ∗ (·)) is a solution
of problems (1)-(2), then there is s∗ (·) such that (x∗ , y ∗ (·), s∗ (·)) is a solution of (8);
conversely, if (x∗ , y ∗ (·), s∗ (·)) is a solution of (8), then (x∗ , y ∗ (·)) is a solution of problems
(1)-(2). A sufficient condition for the matrix C + reT being positive definite is
J

1X
ci + 2ri >
|rj + ri |,
2

i = 1, . . . , J.

(9)

j6=i

Condition (9) implies that C + 12 (reT + erT ) is a symmetric diagonally dominate matrix
with positive diagonally elements and thus a positive definite matrix.
Let




H(ξ) + γ(ξ)eeT I
y(ξ)
2J
v(ξ) =
∈ R , M (ξ) =
∈ R2J×2J ,
(10)
−I
0
s(ξ)
It is easy to see that for any x ∈ RJ , v ∈ R2J ,
 
 
x
x
T
T
T
T 1
T
(x , v )Q(ξ)
= (x , v ) (Q(ξ) + Q(ξ) )
≥ 0,
(11)
v
v
2



C + reT −B
where Q(ξ) =
∈ R3J×3J and B = 0 I ∈ RJ×2J .
B
M (ξ)
Note that we cannot apply [7, Proposition 2] for the existence of solutions of the
two-stage stochastic LCP (8), since the condition that there exists a positive continuous
function κ(ξ) with E[κ(ξ)] < ∞ such that
 
x
T
T
(x , v )Q(ξ)
≥ κ(ξ)(kxk2 + kvk2 ), ∀x ∈ RJ , v ∈ R2J ,
(12)
v
fails for any x = 0, v = (0, s)T , s ∈ RJ and s 6= 0.
In the next section, we will establish the existence of solutions of the two-stage
stochastic LCP (8) with a finite number of realizations of the random variable.
5

3. Existence, uniqueness and robustness of solutions
We first consider the following LCP(M (ξ), q(x, ξ))
0 ≤ v(ξ) ⊥ M (ξ)v(ξ) + q(x, ξ) ≥ 0,
for
fixed x ≥ 0 and ξ ∈ Ξ, where M (ξ) and v(ξ) are defined in (10) and q(x, ξ) =
 a
ρ(ξ)
∈ R2J .
x
The matrix M (ξ) is positive semi-definite, but not positive definite, since
1
v(ξ)T M (ξ)v(ξ) = v(ξ)T (M (ξ) + M (ξ)T )v(ξ) = y(ξ)T (H(ξ) + γ(ξ)eeT )y(ξ) ≥ 0
2
and v(ξ)T M (ξ)v(ξ) = 0 if y(ξ) = 0 and s(ξ) 6= 0.
Note that the matrix M (ξ) is not a P -matrix. Thus the existence and uniqueness
of the solution of the LCP(M (ξ), q(x, ξ)) and the error bound in [11, 12, 14] cannot
be guaranteed for any q(x, ξ). For example, if there is i such that xi < 0, then the
LCP(M (ξ), q(x, ξ)) does not have a solution; if x = 0, then any v(ξ) with y(ξ) = 0 and
s(ξ) ≥ −ρ(ξ) is a solution of the LCP(M (ξ), q(x, ξ)).
Let SOL(M (ξ), q(x, ξ)) be the solution set of the LCP(M (ξ), q(x, ξ)). Since M (ξ)
is a positive semi-definite matrix, SOL(M (ξ), q(x, ξ)) is a convex set [14]. A vector
v ∗ (ξ) is called a least norm solution of the LCP(M (ξ), q(x, ξ)) if it is the solution of the
optimization problem
min kvk2

s.t. v ∈ SOL(M (ξ), q(x, ξ)),

where k · k is the Euclidean norm.
The following lemma gives the form of the least norm solution of the LCP(M (ξ), q(x, ξ))
and shows that it is the unique solution of the LCP(M (ξ), q(x, ξ)) when x > 0.
Lemma 3.1. For any x ≥ 0 and ξ ∈ Ξ, the LCP(M (ξ), q(x, ξ)) has the least norm
solution v ∗ (ξ) = (y ∗ (ξ), s∗ (ξ))T with
y ∗ (ξ) = Π[0,x] (y ∗ (ξ) − ρ(ξ) − (H(ξ) + γ(ξ)eeT )y ∗ (ξ)),

(13)

s∗ (ξ) = max(0, −ρ(ξ) − (H(ξ) + γ(ξ)eeT )y ∗ (ξ)),

(14)

where Π[0,x] (z) is the projection from z to the set [0, x]. Moreover, the least norm solution
is the unique solution of the LCP(M (ξ), q(x, ξ)) if x > 0.
Lemma 3.1 shows that for a fixed vector x ≥ 0, the least norm solution of the
LCP(M (ξ), q(x, ξ)) is uniquely defined by H(ξ), ρ(ξ) and γ(ξ). In real applications,
noise may be presented in the data set and we consider the perturbation bound of the
solution regarding noise in H(ξ), ρ(ξ) and γ(ξ).
Let us consider the following LCP(M̄ , q̄) with


 
H̄ + γ̄eeT I
ρ̄
M̄ =
, q̄ =
.
−I
0
x
From Lemma 3.1, the LCP(M̄ , q̄) with x ≥ 0 has the least norm solution v̄ = (ū, t̄)T
in the following form
ū = Π[0,x] (ū − ρ̄ − (H̄ + γ̄eeT )ū)

and t̄ = max(0, −ρ̄ − (H̄ + γ̄eeT )ū).

The following theorem provides the distance ky ∗ (ξ) − ūk regarding the noise in data
ρ(ξ), H(ξ), γ(ξ).
6

Theorem 3.1. Suppose that x ≥ 0 and let Γ > 0 such that Γγ(ξ) ≥ 1. Then the least
norm solution of the LCP(M (ξ), q(x, ξ)) is continuous with respect to H(ξ), ρ(ξ) and
γ(ξ). Moreover, we have the following perturbation error bound
ky ∗ (ξ) − ūk ≤ Γ(kρ(ξ) − ρ̄k + kxkkH(ξ) − H̄k + Jkxkkγ(ξ) − γ̄k).

(15)

4. A new Alternating Block Algorithm (ABA)
In this section, we consider how to efficiently solve problem (8) with a finite number
of realizations of the random variable. For Ξν = {ξ1 , . . . , ξν }, the probability for each
realization is 1/ν. For simplicity, we set B = (0, I) ∈ RJ×2J , %(ξ) = (ρ(ξ), 0)T ∈ R2J ,
n = J + 2Jν and




C + reT − ν1 B . . . − ν1 B
a


 %(ξ1 ) 
BT
M (ξ1 )




M=
∈ Rn×n , q =  .  ∈ Rn .

..
.
.
.


 . 
.
.
BT
M (ξν )
%(ξν )
In such setting, problem (8) is the standard LCP(M,q) and the progressive hedging
algorithm for the LCP(M,q) is as follows.
Algorithm 1: Progressive Hedging Algorithm (PHA) [41]
Step 0. Given an initial point x0 ∈ RJ , let x0` = x0 ∈ RJ , v`0 ∈ R2J and w`0 ∈ RJ , for
` = 1, . . . , ν, such that ν1 Σν`=1 w`0 = 0. Set the initial point z 0 = (x0 , v10 , . . . , vν0 )T . Choose
a step size t > 0. Set k = 0.
Step 1. For ` = 1, . . . , ν, find (x̂k` , v̂`k ) that solves the LCP
0 ≤ x` ⊥(C + reT )x` − Bv` + a + w`k + t(x` − xk` ) ≥ 0,
0 ≤ v` ⊥B T x` + M (ξ` )v` + %(ξ` ) + t(v` − v`k ) ≥ 0.
Let x̄k+1 =

1
ν

Pν

k
`=1 x̂` ,

(16)

and for ` = 1, . . . , ν, update

),
= x̄k+1 , v`k+1 = v̂`k , w`k+1 = w`k + t(x̂k` − xk+1
xk+1
`
`
to get point z k+1 = (x̄k+1 , v1k+1 , . . . , vνk+1 )T .
Step 2. Set k := k + 1; go back to Step 1.
Theorem 4.1. The LCP(M,q) has at least one solution v∗ , and has at most one solution
with x∗ > 0. Moreover, the sequence {z k } generated by the PHA converges to a solution
of the LCP(M,q).
The PHA has been widely used for solving stochastic optimization problems and
stochastic variational inequalities. Due to the special structure of the M, we propose a
new algorithm for solving the LCP(M,q), which is called Alternating Block Algorithm
(ABA). At each iteration of the PHA, we need to solve ν linear complementarity problems in 3J dimension. At each iteration of the ABA, we only need to solve ν strongly
convex quadratic programs with a simple constraint in J dimension and one linear complementarity problem in J dimension. Hence the computation cost of the ABA is much
less than that of the PHA.

7

Algorithm 2: Alternating Block Algorithm (ABA)
Step 0. Given an initial point x0 ∈ RJ with x0 ≥ 0. Set k = 0.
Step 1. For ` = 1, . . . , ν, find y`k that solves quadratic program
min
s.t.

1 T
2 y (H(ξ` )

+ γ(ξ` )eeT )y + ρ(ξ` )T y
0 ≤ y ≤ xk .

(17)

Set
sk` = max(0, −ρ(ξ` ) − (H(ξ` ) + γ(ξ` )eeT )y`k ).

(18)

Step 2. Find xk+1 that solves the LCP problem
ν
1X k
0 ≤ x⊥(C + re )x −
s` + a ≥ 0.
ν
T

`=1

Set k := k + 1; go back to Step 1.
Let C2 ∈ RJ×J be the symmetric positive definite matrix such that C2T C2 = C +
+ erT ). Let
ν
1X
−1
σ` ,
σ` =
max kM (ξ` )K k, σ =
ν
K⊆{1,...,2J}

1
T
2 (re

`=1

where M (ξ` )K is the nonsingular principal submatrix of M (ξ` ) whose entries of M (ξ` )
are indexed by the set K ⊆ {1, . . . , 2J}.
Theorem 4.2. Suppose kC2−1 k2 σ < 1 and the first J component x∗ of the solution of the
LCP(M,q) is positive. Then there is neighborhood of x∗ such that for any initial point
x0 in the neighborhood, the sequence generated by the ABA converges to the solution
of the LCP(M,q).
Now we use randomly generated problems to compare the performance of the PHA
and ABA. With uniform distribution, we randomly generate each element of vectors
a, c, β̄ on [0, 1], h̄ on [2, 3], and numbers γ̄ on [0, 0.5] and ᾱ on [5, 10]. Let r = 0.5e
and Cii = 10 + ci + (rT e + (J − 2)ri ). We generate sample ξ1 , ξ2 , . . . , ξν from uniform
distribution on [1, 2] and set
β(ξ` ) = ξ` β̄, h(ξ` ) = ξ` h̄, γ(ξ` ) = ξ` γ̄, α(ξ` ) = ξ` ᾱ,

` = 1, . . . , ν.

Then, we let


M (ξ` ) =

ρ(ξ` ) = (−α(ξ` )e + β(ξ` )), H(ξ` ) = diag(h(ξ` ) + γ(ξ` )e),



H(ξ) + γ(ξ` )eeT I
ρ(ξ` )
, %(ξ` ) =
, ` = 1, . . . , ν.
−I
0
0

We terminate the two algorithms when one of the following three stop criteria is met:
The number of iterations reaches 400, or kvk − vk−1 k ≤ 10−6 , or
Res := k min(Mv + q, v)k ≤ 10−6 .
The initial points for PHA and ABA are v0 = ((−(C + reT )−1 a)+ , 0, . . . , 0)T and
= −(C + reT )−1 a)+ , respectively. The step size t in the PHA is set to t = 1.
We choose J = 5, 15, 20, and increase the sample size ν from 5 to 1000. The dimension
of the corresponding LCP(M, q) ranges from 55 to 30015. For each J, ν, we randomly
x0

8

J, ν, J(2ν + 1)
5 5 55
5 50 505
5 100 1005
5 500 5005
5 1000 10005
10 5 110
10 50 1010
10 100 2010
10 500 10010
10 1000 20010
15 5 165
15 50 1515
15 100 3015
15 500 15015
15 1000 30015

iter
15.60
18.40
21.70
22.30
22.00
20.10
20.60
25.20
25.10
23.00
14.50
20.70
20.10
17.80
21.60

ABA
CPU
0.02
0.06
0.11
0.55
1.11
0.05
0.21
0.67
2.34
6.31
0.04
0.69
1.26
3.91
11.31

Res
6.40e-7
7.62e-7
6.13e-7
6.82e-7
6.37e-7
8.03e-7
7.18e-7
7.12e-7
5.88e-7
5.95e-7
6.85e-7
6.76e-7
5.69e-7
5.56e-7
1.02e-6

iter
294.10
342.90
371.20
379.00
387.20
383.10
399.20
400.00
400.00
400.00
400.00
400.00
400.00
400.00
400.00

PHA
CPU
0.09
0.58
1.18
5.92
12.06
0.22
1.66
3.63
17.75
34.80
0.40
3.66
9.97
48.55
100.23

Res
9.76e-7
9.91e-7
1.23e-6
2.25e-6
2.16e-6
5.36e-6
1.64e-5
4.22e-5
9.66e-5
9.27e-5
1.21e-5
1.74e-4
1.62e-4
3.11e-4
7.26e-4

Initial Res
5.37e+1
1.69e+2
2.68e+2
5.80e+2
8.38e+2
7.29e+1
2.42e+2
3.18e+2
8.13e+2
1.01e+3
9.31e+1
2.69e+2
3.78e+2
9.02e+2
1.41e+3

Table 1: Comparison of the PHA and the ABA

generate 10 problems following the description above. The ABA and PHA methods are
used to solve these 10 problems. The results reported in Table 1 are the average of
iterations, cpu times(seconds), residuals and initial residuals. Table 1 shows that the
ABA can solve the LCP(M, q) with all J and ν efficiently. Another advantage of the
ABA is that the iteration numbers remain almost the same when J and ν increase,
and the cpu time is roughly linearly increasing as ν increases. Moreover Table 1 shows
that although the PHA can solve the problems with small J and ν, it fails to solve the
problems with large J or ν within 400 iterations.
5. Impact of COVID-19 on oil market share
In this section, we use the real data of oil price, demand and the market share of 14
major oil producers in the last 17 months to demonstrate the predicability of the twostage stochastic LCP model with adaptive parameters in the cost functions. Moreover,
the model and the simulation results rationalize decisions made by major producers
during COVID-19 pandemic.
Since its first identification, COVID-19 has become a pandemic across all continents
of the globe. To fight back the disease, large portions of social and commercial activities have been restricted if not suspended entirely. It seemed, during the worst of the
outbreak, the whole world had come to a halt, so did the consumption of oil.
This far reaching global event contributed to an already fragile market of oil. As a
result of the pandemic, demand in transportation and factory output fell, which leads to
decrease in overall demand for oil. Consequently, it caused oil prices to fall deeply. The
last straw happened on 6 March 2020, when Russia rejected the demand of OPEC on
further production cuts in response to the demand shrinkage. The oil price fell following
the Russian announcement.

9

5.1. Modelling oil market share as a two-stage stochastic game
We treat the oligopoly market of oil as a two-stage stochastic game where oil producers compete for profit by deciding the optimal production at the first stage of the game.
In particular, we consider 15 oil producers in the following list as 15 agents in the game.
1 Saudi Arabia, 2 Russia, 3 USA, 4 Iraq, 5 China, 6 Canada, 7 United Arab
Emirates (UAE), 8 Iran, 9 Kuwait, 10 Nigeria, 11 Mexico, 12 UK, 13 Venezuela,
14 Indonesia, 15 other.
Producer i makes a decision on its oil production quantity xi , based on its predicted
further characteristics of the oil market at a later time, where the trading actually occurs.
We suppose the trading occurs at the second stage where producer i supplies part if not
all of its produced quantity in the first stage to generate revenue. The spot price of the
trading is uncertain at the time of production decision, and is mainly depended on the
demand supply relation at the second stage. To be more precise, supply quantity yi (ξ)
of producer i is uncertain being further event at the time of production decision.
To simulate the effect of excessive supply on price, we adapt a simple supply and
demand relation and express the inverse demand function as:
p(y(ξ), ξ) = p0 (ξ) − γ(ξ)

J
X


yj (ξ) − D(ξ) ,

j=1

where p0 (ξ) is the benchmark price and γ(ξ) > 0 represents the negative effect on price if
there is excessive supply of oil with respect to the observed demand D(ξ) at the second
stage.
Traditionally, for the production of every barrel of crude oil, producers need to explore
oil fields before building the extraction site, even after the oil is extracted refinement and
shipment require both time and labour not to mention the cost that involves. The nature
of the oil production has been evolving with the technological advance which enables, e.g.,
extraction from oil sands. There exist fundamental differences in energy infrastructures
between traditional producers and oil sands producers, e.g., US, Canada [31], and it is
expected to be reflected at the first stage in choosing production strategies.
In this paper, we assume that the costs in both stages are quadratic as expressed in
(5) and (6) where the parametersP
ci , ai , hi (ξ), γ(ξ) are to be learned from market data.
We also include an extra term (ri Jj=1 xj )xi in the first stage to represent the strategic
PJ
concern of producer i in response to global production quantity
j=1 xj . Note that
we have no restriction on the sign of ri and when it is positive it represents the fact
that producer i is willing to decrease its production when the global production is high.
Typical of such agents are often price setters, since the action would give a boost to the
oil price and may be more profitable despite the production cuts. In reality, Russia’s
refusal to production cuts agreement triggered huge volatility of the market during the
COVID-19 pandemic. To express it with our model, it means that Russia adapted its
value of ri to be negative given the market prediction back in March 2020. That is to
say, Russia made a “squeeze” strategy and decided that if the price drop caused by over
supplying is under control, the maintained market share is potentially more important
for long term profitability. Other notable decisions of producers during the COVID19 pandemic include that Russia refused to production cut on 6th March 2020; Saudi
Arabia offered price discount on 8th March and increased production; U.S. demanded
production cuts on 2nd April 2020; OPEC and Russia cut production on 9th April 2020.
10

We will use our model to show that most decisions of producers were reasonable from
the prospective of the producers, since they had different tolerance on low oil prices, and
they all attempted the best action for their own benefits.

5.2. Numerical simulation and parameter setting
The market data used in our study are obtained from the following sources.
(i) Statistical Review of World Energy1 , latest publish in June 2020 by bp. Inc;
This data set provides average daily production quantities of major oil-producing
countries, and the percentage of their production of the total production is regarded
as their market shares respectively.
(ii) Oil Price Dynamics Report2 , weekly by Federal Reserve Bank of New York;
This data set reports the crude oil price change and the supply/demand relation
contributing to the change. It shows supply contribution, demand contribution
and other contribution called residual contribution.
(iii) U.S. Energy Information Administration3 , weekly and daily spot price of Brent.
For the model (1)-(2) with (5)-(7), parameters in the first stage are taken as follows:
• ci : This parameter represents the quadratic production cost of producer i. For
the traditional producers, this contributes to the cost of exploration, site building
and equipment setting up, etc. For oil sand producers, the financial cost can
also be regarded as non-linear with respect to production quantity. However, all
major producers should have similar scale of values to maintain profitable. In our
simulation of in-sample and out-of-sample, we took
c1 = 0.11/Λ1 , c2 = 0.115/Λ2 , c3 = 0.095/Λ3 , ci = 0.1/Λi , i = 4, . . . , 15
c1 = 0.11/Λ01 , c2 = 0.115/Λ02 , c3 = 0.095/Λ03 , ci = 0.1/Λ0i , i = 4, . . . , 15
respectively, where Λi and Λ0i are market share of producer i in the current month
and previous month for simulation of 2019, and market shares of January 2020
and December 2019 for simulation of 2020. The data of market share are given in
Tables 3-4.
• ai : This parameter represents the linear production cost of producer i. It is widely
agreed that traditional producers have very low unit cost of oil production. As for
the oil sand producers, the unit cost is much higher. In our simulation,
ai = ci , i = 1, 2, 4, 5, 7, . . . , 15, a3 = 6c3 , a6 = 2c6 .
• ri : This parameter represents producer i’s response to the total of production by all
producers. Before the pandemic, it was widely agreed that supply should be kept
in accordance to the demand but little preference was taken till Russia’s refusal to
further production cuts. In our simulation, ri = 0 for all producers in 2019, and ri
were given in Table 2 for different producers in 2020.

11

2020
Saudi Arabia
Russia
USA
Iraq
China
Canada
UAE
Iran
Kuwait
Nigeria
Mexico
UK
Venezuela
Indonesia
other

Jan
0
-0.01
-0.01
0
0
0
0
0
0
0
0
0
0
0
-0.01

Feb
0.01
0
0
0
0
0
0
0
0
0
0
0
0
0
0

Mar
0
0
-0.02
0
0.01
-0.02
-0.02
-0.02
-0.01
-0.01
0
-0.1
-0.1
-0.1
0.005

Apr
-0.022
-0.008
-0.04
-0.01
-0.01
-0.03
-0.05
-0.045
-0.045
-0.08
-0.065
-0.16
-0.23
-0.23
0.005

May
0
0.01
0
0
0
0
0
0
0
-0.06
-0.045
-0.08
-0.13
-0.13
-0.005

Table 2: Values of r for numerical simulation of January-May 2020

These are basic production cost parameters restricted by technological advance and
complicated operations, and we do not expect them to change over short periods of
time for all producers. For the purpose of forecasting current year production, these
parameters are revised monthly taken based on the market share of the month before.
The stochastic parameters are the risk-adjusted spot price ρi (ξ) = α(ξ) − βi (ξ) and
H(ξ) = diag(hi (ξ) + γ(ξ)), where α(ξ) is benchmark price, γ(ξ) is stochastic supply
discount, αi and βi are the supply cost coefficients.
For our experiments, we randomly choose ζ ∈ [0.05, 0.1], and let hi = βi = ζ × ai
representing 5% to 10% of the unit production cost. The data (ii) gives the crude oil
price change due to different factors of contributions, namely contribution of demand ∆D,
supply ∆S and the residual contribution ∆R. Then, price change ∆price is computed
as follows:
∆price = ∆D + ∆S + ∆R.
These contributions ∆D, ∆S and ∆R over certain period of time are uncertain. We assume that it can be described by random variable ξ with unknown distribution, written
as d(ξ), s(ξ) and r(ξ). For the purpose of our numerical tests, we formulate empirical
distributions of historical data and use them as an approximation to the unknown distributions of different factors of contribution respectively. Recall that in our model the
price is given by
J
X
p(y(ξ), ξ) = α(ξ) − γ(ξ)
yj (ξ),
j=1

in which the demand D(ξ) is ignored as it would be a constant term and has no effect
1

https://www.bp.com/en/global/corporate/energy-economics/statistical-review-of-worldenergy.html
2
https://www.newyorkfed.org/research/policy/oil price dynamics report
3
https://www.eia.gov

12

Saudi Arabia
Russia
USA
Iraq
China
Canada
UAE
Iran
Kuwait
Nigeria
Mexico
UK
Venezuela
Indonesia
other

Jan
10.31
11.54
11.95
4.72
3.86
4.20
3.09
2.71
2.73
1.70
1.63
1.08
1.04
0.77
38.65

Feb
10.22
11.52
11.75
4.61
3.91
4.19
3.08
2.77
2.73
1.62
1.72
1.13
0.86
0.76
39.15

Mar
9.82
11.46
11.96
4.37
3.88
4.29
3.06
2.80
2.73
1.66
1.70
1.12
0.60
0.76
39.79

Apr
9.77
11.45
12.27
4.68
3.93
4.21
3.09
2.68
2.72
1.80
1.70
1.13
0.66
0.71
39.19

May
10.00
11.31
12.33
4.75
3.95
4.18
3.11
2.34
2.75
1.60
1.69
1.13
0.82
0.77
39.27

Jun
10.10
11.42
12.25
4.72
4.04
4.33
3.09
2.29
2.68
1.65
1.70
0.97
0.79
0.73
39.24

Jul
10.12
11.38
11.98
4.70
4.05
4.31
3.11
2.28
2.68
1.71
1.69
0.91
0.76
0.75
39.56

Aug
10.34
11.47
12.49
4.73
3.90
4.30
3.09
2.22
2.63
1.81
1.70
0.83
0.74
0.74
39.03

Sep
9.39
11.67
12.83
4.84
3.94
4.26
3.16
2.24
2.73
1.86
1.75
0.97
0.73
0.75
38.89

Oct
10.36
11.29
12.74
4.59
3.90
4.27
3.09
2.17
2.65
1.70
1.66
0.93
0.70
0.74
39.21

Nov
9.91
11.26
12.93
4.58
3.89
4.39
3.07
2.11
2.71
1.68
1.71
1.03
0.70
0.73
39.29

Dec
9.64
11.23
12.76
4.50
3.85
4.49
3.04
2.11
2.71
1.64
1.70
1.04
0.71
0.73
39.87

Table 3: Average of daily market shares of producers in each month of 2019

Saudi Arabia
Russia
USA
Iraq
China
Canada
UAE
Iran
Kuwait
Nigeria
Mexico
UK
Venezuela
Indonesia
other

Jan
9.72
11.26
12.72
4.25
3.88
4.36
2.98
2.10
2.66
1.61
1.72
0.97
0.73
0.73
40.32

Feb
9.75
11.30
12.85
4.53
3.87
4.41
2.99
2.05
2.66
1.67
1.75
0.95
0.75
0.72
39.75

Mar
10.23
11.33
12.76
4.54
3.92
4.42
3.54
2.01
2.90
1.88
1.77
1.02
0.73
0.72
38.24

Apr
11.57
11.42
12.28
4.49
3.90
3.74
3.88
1.96
3.13
1.75
1.75
1.00
0.71
0.72
37.68

May
9.44
10.44
11.23
4.59
4.32
3.66
2.72
2.17
2.42
1.65
1.83
1.05
0.76
0.79
42.93

Table 4: Average of daily market shares of producers in each month of January-May 2020

on solution. Then, for any realization of αk (ξ` ) of k-th day, it corresponds to
αk (ξ` ) = α0k (ξ` )(1 + dk (ξ` ) + rk (ξ` )),
where α0k is the known price of prior day given in (iii), dk (ξ` ) and rk (ξ` ) are random
scenarios taken from empirical distributions of d(ξ) and r(ξ), respectively.
It follows that, we can generate a set of data of stochastic supply discount γ(ξ` )
γ(ξ` ) =

|αk (ξ` ) − α0k |
,
ξ` η̄

where absolute value | · | ensures that increase in quantity has a negative influence on
price, ξ` ∈ [0.99, 1.01] is uniformly distributed and η̄ is the total supply obtained from
data (i). We chose sample size ν = 800 of random variable ξ for both in-sample and
out-of-sample in the numerical simulation.
For long-term prediction (yearly market shares prediction), we refer interested readers
to [25] for more details. Here, we focus on short-term prediction, namely the monthly
in-sample and out-of-sample market shares. Table 3 gives average of daily market shares
of producers in each month of 2019. Figures 1 and 2 display results for the recovered
monthly market shares in 2019. For each month, the first column is the real market
share, while the second and third column are the in sample and out sample recovered
results, respectively. They show that our two-stage stochastic LCP model recovers and
predicts the short-term real market shares from January 2019 to May 2020 very well.
Although global oil demand has been hit hard by COVID-19 and oil price has fell to
historically low, our results show that a Nash-equilibrium for the global oil market share
during the COVID-19 pandemic can be expected.
13

Canada
4.20%
United Arab Emirates
3.09%
Iran
2.71%
Kuwait
2.73%
Nigeria
1.70%
Mexico
1.63%
United Kingdom1.08%
Venezuela
1.04%
Indonesia
0.77%
other
38.65%

4.19%
3.08%
2.77%
2.73%
1.62%
1.72%
1.13%
0.86%
0.76%
39.15%

4.29%
3.06%
2.80%
2.73%
1.66%
1.70%
1.12%
0.60%
0.76%
39.79%

4.21%
3.09%
2.68%
2.72%
1.80%
1.70%
1.13%
0.66%
0.71%
39.19%

4.18%
3.11%
2.34%
2.75%
1.60%
1.69%
1.13%
0.82%
0.77%
39.27%

4.33%
3.09%
2.29%
2.68%
1.65%
1.70%
0.97%
0.79%
0.73%
39.24%

4.31%
3.11%
2.28%
2.68%
1.71%
1.69%
0.91%
0.76%
0.75%
39.56%

4.30%
3.09%
2.22%
2.63%
1.81%
1.70%
0.83%
0.74%
0.74%
39.03%

Saudi Arabia

100%
Russia
90%

USA

80%

Iraq

70%

China

60%

Canada

50%

United Arab
Emirates
Iran

40%

Kuwait

30%

Nigeria
20%

Mexico

10%

United
Kingdom
Venezuela

0%

Indonesia
other

Figure 1: Real, in sample and out sample monthly market shares of Jan to Jun in 2019
Saudi Arabia
100%

Russia

90%

USA

80%

Iraq

70%

China
Canada

60%

United Arab
Emirates
Iran

50%

40%

Kuwait

30%

Nigeria

20%

Mexico

10%

United
Kingdom
Venezuela

0%
Indonesia

other

Figure 2: Real, in sample and out sample monthly market shares of Jul to Dec in 2019

14

Saudi Arabia

100%

Russia
90%

USA

80%

Iraq

70%

China
Canada

60%

United Arab
Emirates
Iran

50%
40%

Kuwait

30%

Nigeria

20%

Mexico

10%

United
Kingdom
Venezuela

0%

Indonesia

other

Figure 3: Real, in sample and out sample monthly market shares of Jan to May in 2020

Of particular interests are what had happened in March and April among Russia,
Saudi Arabia and U.S.A. In particular, the Brent spot price fell from around $70 per
barrel to about $50 since the identification of the pandemic and was believed to decrease
further. If no actions of change were taken by the major producers, what could have
happened is that the high-cost producers would be forced to cut production because
they are more vulnerable in low price environment. On one hand, if the production cut
is significant, the price will boost and the non-limited producers can be more profitable.
On the other hand, if the oil price continues to fall, the optimal production decision
has little to change for the traditional producers with low unit cost, e.g., Russian, Saudi
Arabia. In indeed, with our model of two-stage stochastic game, the estimated market
share given no strategic changes can be seen in accordance with the description above.
It is, given the estimated market share, the most rational decision for Russia is to refuse
the production cut agreement. Saudi Arabia, who believed to have the lowest unit
production cost, followed the strategy of Russia immediately by offering price discount
and increased its production. For both countries, the low price environment has little
effects in the sense of maintaining their market share respectively. The same cannot be
said for U.S.A., who has high cost in unit oil production, and is estimated to loss its
market share if not to change its production strategy, presented by choosing non-zero r
in our model. It is most apparent from Table 2, that all the major producers responded
in choosing their strategies to increase production quantities. The reality was counter
intuitive at first glance, but those were in fact all rational decisions and can be forecasted
by our model

15

6. Conclusion
In this paper, we model the oil market share using the two-stage stochastic LCP
(8) via the two-stage stochastic games (1)-(2) with quadratic concave utility functions
(5)-(7). We show the existence and uniqueness of a Nash-equilibrium for the oil market
share by the solution of the two-stage stochastic LCP (8). Moreover, we propose the
Alternating Block Algorithm (ABA) to find a solution of the two-stage stochastic LCP
(8) with finite realizations. We derive the convergence theorems of the ABA and the
PHA for solving (8) with finite realizations and show the ABA is much faster than the
PHA by randomly generated problems. We apply the new theoretical results and the
ABA to the analysis of the oil market share from January 2019 to May 2020. Simulation
results show that our model is effective for forecasting the oil market share under an
uncertain environment of COVID-19 pandemic.
Acknowledgements
Xiaojun Chen would like to thank Hong Kong Research Grant Council for grant
PolyU153001/18P.
References
References
[1] Barunḱ, J, Malinská, B. Forecasting the term structure of crude oil futures prices with neural
networks. Applied energy, 2016; 164: 366-379. https://doi.org/10.1016/j.apenergy.2015.11.051
[2] Behar A, Ritz R. OPEC vs US shale oil: Analyzing the shift to a market-share strategy.
Enegy Econ 2017;63:185-98. https://doi.org/10.1016/j.eneco.2016.12.021.
[3] Chiroma, H, Abdulkareem, S, Herawan, T. Evolutionary Neural Network model for
West Texas Intermediate crude oil price prediction. Applied Energy, 2015; 142; 266-273.
https://doi.org/10.1016/j.apenergy.2014.12.045
[4] Chen X, Fukushima M. Expected residual minimization method for stochastic
linear
complementarity
problems.
Math
Oper
Res
2005;30:1022–38.
https://doi.org/10.1287/moor.1050.0160.
[5] Chen X., Pong TK, Wets RJB. Two-stage stochastic variational inequalities: an ERM-solution
procedure. Math Program 2017;165:71-111. https://doi.org/10.1007/s10107-017-1132-9.
[6] Chen X, Shapiro A, Sun H. Convergence analysis of sample average approximation of two-stage stochastic generalized equations. SIAM J Optim 2019;29:135-61.
https://doi.org/10.1137/17M1162822.
[7] Chen X, Sun H, Xu H. Discrete approximation of two-stage stochastic and distributionally robust linear complementarity problems. Math Program 2019;177:255-89.
https://doi.org/10.1007/s10107-018-1266-4.
[8] Chen X, Wang Z. Computational error bounds for differential linear variational inequality.
IMA J Numer Anal 2012;32:957-82. https://doi.org/10.1093/imanum/drr009.
[9] Chen X, Wets RJB. eds, Stochastic Equilibrium and Variational Inequalities. Math Program
2017;165.
[10] Chen X, Wets RJB, Zhang Y. Stochastic variational inequalities: Residual minimization smoothing sample average approximations. SIAM J Optim 2012;22:649–73.
https://doi.org/10.1137/110825248.

16

[11] Chen X, Xiang S. Computation of error bounds for P-matrix linearcomplementarity problem.
Math Program 2006;106:513-25. https://doi.org/10.1007/s10107-005-0645-9.
[12] Chen X, Xiang S. Perturbation bounds of P-matrix linear complementarity problems. SIAM
J Optim 2007;18:1250-65. https://doi.org/10.1137/060653019.
[13] Chen X, Xiang S. Newton iterations in implicit time-stepping scheme for differential linear
complementarity systems. Math Program 2013;138:579-606. https://doi.org/10.1007/s10107012-0527-x.
[14] Cottle RW, Pang JS, Stone RE. The Linear Complementarity Problem. New York: Academic
Press; 1992.
[15] Ehrenmann A, Smeers Y. Generation capacity expansion in a risky environment: a stochastic
equilibrium analysis. Oper Res 2011;59:1332–46. https://doi.org/10.1287/opre.1110.0992.
[16] Ferris M, Pang JS. Engineering and economic applications of complementarity problems.
SIAM Rev 1997;39:669–713. https://doi.org/10.1137/S0036144595285963.
[17] Gürkan G, Özge AY, Robinson SM. Sample-path solution of stochastic variational inequalities. Math Program 1999;84:313–33. https://doi.org/10.1007/s10107980038a.
[18] Gürkan G, Ozdemir O, Smeers Y. Generation capacity investments in electricity markets: perfect competition. CentER Discussion Paper; Tilburg: Econometrics 2013;045.
http://dx.doi.org/10.2139/ssrn.2314862.
[19] Gürkan G, Pang JS. Approximations of Nash equilibria. Math Program 2009;117:223–53.
https://doi.org/10.1007/s10107-007-0156-y.
[20] Genc TS, Reynolds SS, Sen S. Dynamic oligopolistic games under uncertainty:
a stochastic programming approach. J Econ Dyn Control 2007;31:55–80.
https://doi.org/10.1016/j.jedc.2005.09.011.
[21] Gabriel SA, Fuller JD. A Benders decomposition method for solving stochastic complementarity problems with an application in energy. Comput Econ 2010;35:301–29.
https://doi.org/10.1007/s10614-010-9200-8.
[22] Hamilton JD. Causes and Consequences of the Oil Shock of 2007-08. Brookings Papers
on Economic Activity, Economic Studies Program, The Brookings Institution 2009;40:215-83.
https://doi.org/10.3386/w15002.
[23] Ji Q, Fan Y. How does oil price volatility affect non-energy commodity markets?. Applied
Energy 2012;89:273-80. https://doi.org/10.1016/j.apenergy.2011.07.038.
[24] Ji Q, Guo JF. Oil price volatility and oil-related events: An Internet concern study perspective. Applied Energy 2015;137:256-64. https://doi.org/10.1016/j.apenergy.2014.10.002.
[25] Jiang J, Shi Y, Wang X, Chen X. Regularized two-stage stochastic variational inequalities for Cournot-Nash equilibrium under uncertainty. J Comp Math 2019;37:813-42.
https://doi.org/10.4208/jcm.1906-m2019-0025.
[26] Juvenal L, Petrella I. Speculation in the oil market. J Appl Econ 2015;30:621-49.
https://doi.org/10.1002/jae.2388.
[27] Kan S, Chen B, Chen G. Worldwide energy use across global supply
chains:
Decoupled from economic growth?. Appl Energy 2019;250:1235-45.
https://doi.org/10.1016/j.apenergy.2019.05.104.
[28] Kannan A, Shanbhag UV, Kim HM. Strategic behavior in power markets under uncertainty.
Energy Syst 2011;2:115–41. https://doi.org/10.1007/s12667-011-0032-y.

17

[29] Kannan A, Shanbhag UV, Kim HM. Addressing supply-side risk in uncertain power markets: stochastic Nash models, scalable algorithms and error analysis. Optim Methods Softw
2013;28:1095–138. https://doi.org/10.1080/10556788.2012.676756.
[30] Engemann KM, Owyang MT, Wall HJ. Where is an oil shock?. Journal of Regional Science
2014;54:169C185. https://doi.org/10.1111/jors.12071.
[31] Lazzaroni EF, Elsholkami M, Arbiv I, Martelli E, Elkamel A, Fowler M. Energy infrastructure modeling for the oil sands industry: Current situation. Appl Energy 2016;181:435-45.
https://doi.org/10.1016/j.apenergy.2016.08.072
[32] Narayan PK, Narayan S, Zheng X. Gold and oil futures markets: Are markets efficient?.
Appl energy 2010;87:3299-303. https://doi.org/10.1016/j.apenergy.2010.03.020.
[33] Nordhaus WD. Who’s afraid of a big bad oil shock?. Brookings Papers on Economic Activity
2007;2007:219-38. https://doi.org/10.1353/eca.2008.0013.
[34] Panda D, Ramteke M. Preventive crude oil scheduling under demand uncertainty using structure adapted genetic algorithm. Appl Energy 2019;235:68-82.
https://doi.org/10.1016/j.apenergy.2018.10.121.
[35] Pang JS, Sen S, Shanbhag UV. Two-stage non-cooperative games with risk-averse players.
Math Program 2017;165:119–47. https://doi.org/10.1007/s10107-017-1148-1.
[36] Ralph D, Xu H. Convergence of stationary points of sample average two stage
stochastic programs: a generalized equation approach. Math Oper Res 2011;36:568-92.
https://doi.org/10.1287/moor.1110.0506.
[37] Ravat U, Shanbhag UV. On the characterization of solution sets of smooth
and nonsmooth convex stochastic Nash games. SIAM J Optim 2011;21:1168–99.
https://doi.org/10.1137/100792644.
[38] Rockafellar RT, Wets RJB. Scenarios and policy aggregation in optimization under uncertainty. Math Oper Res 1991;16:235–90. https://doi.org/10.1287/moor.16.1.119.
[39] Rockafellar RT, Wets RJB. Variational Analysis. Springer-Verlag Berlin Heidelberg; 1998.
[40] Rockafellar RT, Wets RJB. Stochastic variational inequalities: single-stage to multistage.
Math Program 2017;165:331–60. https://doi.org/10.1007/s10107-016-0995-5.
[41] Rockafellar RT, Sun J. Solving monotone stochastic variational inequalities and
complementarity problems by progressive hedging. Math Program 2018;174:453–71.
https://doi.org/10.1007/s10107-018-1251-y.
[42] Eyden RV, Difeto M, Gupta R, Wohar ME. Oil price volatility and economic growth:
Evidence from advanced economies using more than a centurys data. Appl Energy
2019;233C234:612-21. https://doi.org/10.1016/j.apenergy.2018.10.049.
[43] Wang M, Zhao L, Du R, Wang C, Chen L, Tian L, Stanley, HE. intelligence algorithms.
Applied Energy, 2018; 220: 480-495. https://doi.org/10.1016/j.apenergy.2018.03.148
[44] Yao J, Adler I, Oren SS. Modeling and computing two-settlement oligopolistic equilibrium in a congested electricity network. Oper Res 2008;56:34–47.
https://doi.org/10.1287/opre.1070.0416.
[45] Yao T, Zhang YJ, Ma CQ. How does investor attention affect international crude oil prices?.
Appl Energy 2017;205:336-44. https://doi.org/10.1016/j.apenergy.2017.07.131.

Appendix, Proofs of Lemma 3.1, Theorems 3.1, 4.1, 4.2
Proof of Lemma 3.1
18

Proof. It is easy to see that v(ξ) = (x, |ρ(ξ)|)T ≥ 0 and M (ξ)v(ξ) + q(x, ξ) ≥ 0, that is,
(x, |ρ(ξ)|)T is a feasible solution of the LCP(M (ξ), q(x, ξ)). Hence from the feasibility and
the positive semi-definiteness of M (ξ), the LCP(M (ξ), q(x, ξ)) has at least one solution
[14, Theorem 3.1.2].
The LCP(M (ξ), q(x, ξ)) is the first order optimality condition of the strongly convex
quadratic program
min
s.t.

1
T
2 y(ξ) (H(ξ)

+ γ(ξ)eeT )y(ξ) + ρ(ξ)T y(ξ)
0 ≤ y(ξ) ≤ x.

(A.1)

Because of the strong convexity, the first order optimality condition is necessary and
sufficient for the unique optimal solution y ∗ (ξ) of problem (A.1), which is a fixed point
of the fixed point problem
y(ξ) = Π[0,x] (y(ξ) − ρ(ξ) − (H(ξ) + γ(ξ)eeT )y(ξ)).
Hence, y ∗ (ξ) has the form of (13).
By the definition of the projection, we can easily obtain
(ρ(ξ) + (H(ξ) + γ(ξ)eeT )y ∗ (ξ))i

 =0
≤0

≥0

if (y ∗ (ξ) − ρ(ξ) − (H(ξ) + γ(ξ)eeT )y ∗ (ξ))i ∈ (0, xi )
if (y ∗ (ξ) − ρ(ξ) − (H(ξ) + γ(ξ)eeT )y ∗ (ξ))i ≥ xi
otherwise.

Hence, the multiplier s∗ (ξ) in (14) with y ∗ (ξ) in (13) is a solution of the LCP(M (ξ), q(x, ξ)),
where for the case yi∗ (ξ) < xi it is from s∗i (ξ) = (ρ(ξ) + (H(ξ) + γ(ξ)eeT )y ∗ (ξ))i = 0 and
s∗i (ξ)(xi − yi∗ (ξ)) = 0, and for the case yi∗ (ξ) = xi , it is from yi∗ (ξ)(s∗i (ξ) + (ρ(ξ) + (H(ξ) +
γ(ξ)eeT )y ∗ (ξ))i ) = 0.
If yi∗ (ξ) = xi > 0, s∗i (ξ) in (14) is uniquely defined. If yi∗ (ξ) = xi = 0, then s∗i (ξ) =
max(0, −(ρ(ξ) + (H(ξ) + γ(ξ)eeT )y ∗ (ξ))i ) = 0. Hence v ∗ (ξ) = (y ∗ (ξ), s∗ (ξ))T defined in
(13)-(14) is the least norm solution of the LCP(M (ξ), q(x, ξ)) and the unique solution of
LCP(M (ξ), q(x, ξ)) if x > 0. We complete the proof.
Proof of Theorem 3.1
Proof. We first prove (15). Let
w(ξ) = (H(ξ) + γ(ξ)eeT )y ∗ (ξ) + ρ(ξ)

and w̄ = (H̄ + γ̄eeT )ū + ρ̄.

Then we have
y ∗ (ξ) = Π[0,x] (y ∗ (ξ) − w(ξ))

and ū = Π[0,x] (ū − w̄),

which implies
mid(y ∗ (ξ), y ∗ (ξ) − x, w(ξ)) = 0

and

mid(ū, ū − x, w̄) = 0,

where “mid” is the componentwise median operator. Following the proof of Lemma 2.1
in [8], there is a diagonal matrix D =diag(d1 , . . . , dJ ) with 0 ≤ di ≤ 1 such that
0 = (I − D)(y ∗ (ξ) − ū) + D(w(ξ) − w̄).

19

Hence we obtain
(I − D + D(H(ξ) + γ(ξ)eeT ))(y ∗ (ξ) − ū) = −D(ρ(ξ) − ρ̄ + (H(ξ) − H̄ + (γ(ξ) − γ̄)eeT )ū).
(A.2)
Since H(ξ) + γ(ξ)eeT is symmetric positive definite, by Theorem 2.7 in [12], we have
max k(I − D + D(H(ξ) + γ(ξ)eeT ))−1 Dk = k(H(ξ) + γ(ξ)eeT ))−1 k

d∈[0,1]J

≤ γ(ξ)−1 k(I + eeT )−1 k.
Therefore, using k(I + eeT )−1 k = 1, keeT k = J, γ(ξ)−1 ≤ Γ and 0 ≤ ū ≤ x, we obtain
(15) from (A.2).
Next we show the continuity of the last J-components of the least norm solution of the
LCP(M (ξ), q(x, ξ)). Without loss of generality, assume that σ = {i ∈ {1, . . . , J} | yi∗ (ξ) <
xi } =
6 ∅. From (15), for any 0 <  < mini∈σ xi − yi∗ (ξ), there is δ > 0 such that if
kρ(ξ) − ρ̄k + kH(ξ) − H̄k + kγ(ξ) − γ̄k < δ, then ky ∗ (ξ) − ūk < . This implies for i ∈ σ,
xi − ūi ≥ xi − yi∗ (ξ) − |yi∗ (ξ) − ūi | > 0. Hence, we have t̄i = s∗i (ξ) = 0.
For i 6∈ σ, that, is, yi∗ (ξ) = xi , we have s∗i (ξ) = −(ρ(ξ) + (H(ξ) + γ(ξ)eeT )y ∗ (ξ))i ≥ 0.
If t̄i = 0, then −(ρ̄ + (H̄ + γ̄eeT )ū)i ≤ 0, otherwise t̄i = −(ρ̄ + (H̄ + γ̄eeT )ū)i ≥ 0. Hence,
using (15), we have
|s∗i (ξ) − t̄i |
≤ |(ρ(ξ) + (H(ξ) + γ(ξ)eeT )y ∗ (ξ))i − (ρ̄ + (H̄ + γ̄eeT )ū)i |
≤ kρ(ξ) − ρ̄k + (kH(ξ)k + γ(ξ)J)ky ∗ (ξ) − ūk + kxk(Jkγ(ξ) − γ̄k + kH(ξ) − H̄k)
≤ (L + (kH(ξ)k + γ(ξ)J)Γ)(kρ(ξ) − ρ̄k + kH(ξ) − H̄k + kγ(ξ) − γ̄k)),
where L ≥ max{1, Jkxk}. Hence, the solution of the LCP(M (ξ), q(x, ξ)) is continuous
with respect to H(ξ), ρ(ξ) and γ(ξ). We complete the proof.
Proof of Theorem 4.1
Proof. Let Λ =diag(ν, 1, . . . , 1) ∈ Rn×n . It is ease to verify that v∗ is a solution of the
LCP(ΛM,Λq) if and only if v∗ is a solution of the LCP(M,q).
Since z T (ΛM+(ΛM)T )z ≥ 0 for any z ∈ Rn , the matrix ΛM isP
positive semi-definite.
1
T
Moreover, v = (x, x, |ρ(ξ1 )|, . . . , x, |ρ(ξν )|) with xi > max{0, ( ν ν`=1 |ρ(ξ` )| − a)i /ci },
i = 1, . . . , J is a feasible solution of the LCP(ΛM,Λq). Hence the feasibility implies that
LCP(ΛM,Λq) has at least one solution v∗ [14]. If v∗ has the component x∗ > 0, then by
Lemma 3.1, the component (v ∗ (ξ` ), . . . , v ∗ (ξν )) of v∗ is uniquely dependent on x∗ > 0.
Moreover, we have
(C + reT )x∗ +

ν
1X
D` (ρ(ξ` ) + (H(ξ` ) + γ(ξ` )eeT )x∗ ) + a = 0,
ν
i=`

where D` is a diagonal matrix with diagonal elements being 0 or 1. Since C + reT
and H(ξ` ) + γ(ξ` )eeT are positive definite, x∗ is the unique solution of this system of
equations. Hence, the LCP(ΛM,Λq) has at most one solution with x∗ > 0.
For any z ∈ Rn , we can easily find


ν
1 T
1X T
C + reT
−B
T
z (ΛM + (ΛM) )z =
z`
z`T ≥ 0,
BT
M (ξ` )
ν
ν
`=1

20


C + reT
−B
where z` = (x, v(ξ`
for ` = 1, . . . , ν. Moreover, the matrix
BT
M (ξ` )
is positive semi-definite for any ξ` . Hence from [41], the sequence {z k } generated by
Algorithm 1 converges to a solution of the LCP(ΛM,Λq). We complete the proof.


))T

Proof of Theorem 4.2
Proof. From Step 2 of Algorithm 2 and the definition of a solution, we have
0 ≤ xk+1 ⊥(C +reT )xk+1 −

ν
1X k
s` +a ≥ 0
ν

0 ≤ x∗ ⊥(C +reT )x∗ −

and

`=1

ν
1X ∗
s` +a ≥ 0,
ν
`=1

which imply
0 ≥ (x

k+1

∗ T

T

− x ) ((C + re )(x

k+1

ν
1X k
−x )+
(s` − s∗` )
ν
∗

`=1

≥ kC2 (x

k+1

∗

2

− x )k − kC2 (x

k+1

−x

∗

1
)kkC2−1 k
ν

ν
X

ksk` − s∗` k.

`=1

Let µ > 0 such that Ω := {x | kC2 (x − x∗ )k ≤ µ} ⊂ RJ++ . By Theorem 2.1 in [13]
and Lemma 3.1, for any xk ∈ Ω, the LCP(M (ξ` ), q(xk , ξ` )) has a unique solution v`k =
(y`k , sk` )T , which is a Lipschitz continuous function with the Lipschitz constant σ` of x.
Hence, from q(x, ξ) = (ρ(ξ), x)T , we have
ksk` − s∗` k ≤ kv`k − v ∗ k ≤ σ` kq(xk , ξ` ) − q(x∗ , ξ` )k = σ` kxk − x∗ k
and
kC2 (x

k+1

∗

− x )k ≤
≤

1
kC2−1 k
ν

ν
X

ksk`

`=1
−1 2
kC2 k σkC2 (xk

−

s∗` k

≤

1
kC2−1 k
ν

ν
X

σ` kxk − x∗ k

`=1

∗

− x )k.

Since kC2−1 k2 σ < 1, we obtain xk+1 ∈ Ω, and the convergence of {xk } to x∗ . Using
Lemma 3.1 again, the sequence (xk , y1k , sk1 , . . . , yνk , skν )T generated by the ABA converges
to the solution of the LCP(M,q).

21

