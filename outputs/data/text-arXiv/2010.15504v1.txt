arXiv:2010.15504v1 [math.NA] 29 Oct 2020

A stochastic θ-SEIHRD model: adding randomness to the
COVID-19 spread
Álvaro Leitao and Carlos Vázquez
Department of Mathematics and CITIC, Universidade da Coruña, Spain
October 30, 2020
Abstract
In this article we mainly extend the deterministic model developed in [10] to a stochastic
setting. More precisely, we incorporated randomness in some coefficients by assuming that
they follow a prescribed stochastic dynamics. In this way, the model variables are now
represented by stochastic process, that can be simulated by appropriately solve the system of
stochastic differential equations. Thus, the model becomes more complete and flexible than
the deterministic analogous, as it incorporates additional uncertainties which are present
in more realistic situations. In particular, confidence intervals for the main variables and
worst case scenarios can be computed.

1

Introduction

The coronavirus disease 2019, renamed as COVID-19, is an infectious disease produced by the
virus SARS-CoV-2, which was declared pandemic by the World Health Organization (WHO) in
March 11, 2020. This disease has posed many novel scientific challenges, ranging from contagious
patterns, medical treatments or vaccine developments, to data analytics, spread modelling or
evolution forecast. The research on all of these topics has been intensive in the last few months,
as so will be in the near future. Thus, many disciplines from interconnected fields, like biosciences, mathematical and statistical modelling or artificial intelligence, will be involved and
they will play an important role to rapidly overcome this exceptional emergency situation.
From the mathematical modelling point of view, epidemiological compartmental models have
been often used to understand and analyze the behaviour of the contagious diseases, with the article [12] being the pioneering work. These models provide useful tools to make predictions about
the future evolution of the epidemic and control its propagation. In the literature of epidemic
modelling, many examples of general-purpose models have been proposed (see [8], for a review),
each of them accounting for some specific characteristics of the diseases, like the well-known examples SIR (Susceptible-Infected-Recovered), SEIR (Susceptible-Exposed-Infected-Recovered)
or SIS (Susceptible-Infected-Susceptible) models.
Typically, the compartmental models are originally formulated following a deterministic approach, i.e., in terms of a system of Ordinary Differential Equations (ODEs), although usually
they are readily extended to an stochastic version. There are two common approaches to include
stochasticity into a deterministic model, relying on either the Continuous Time Markov Chain
(CTMC) or Stochastic Differential Equations (SDEs), see [1] and the references therein. Here,
we will focus on the latter. The stochastic models allow to capture many kinds of circumstances

1

including uncertainty that may influence the compartments dynamics: behavioural effects, public interventions, seasonal patterns, environmental factors, etc. Furthermore, the solution of
a deterministic model is given by a set of functions of time uniquely dependent on the initial
data, while the solution of the stochastic model is a set of stochastic processes, containing much
more information than the deterministic analogous. In fact, at each time instant we can exploit
the information provided by the probability distribution associated to the underlying random
variable. An statistical analysis can therefore be performed, producing useful outcomes like
quartiles or worst case scenarios.
In this work we present an stochastic extension of the deterministic compartmental model in
[10], that has been proposed as an ad hoc model for the COVID-19 disease. Unlike to the classical
models (SIR, SEIR, SIS), this model is adapted to the specific characteristics of the COVID-19,
taking into account, besides the usual factors, the undetected infectious cases, the hospitalized
population or the deaths, for example. Thus, the so-called θ-SEIHRD model proposed in [10]
was developed as a very general and sophisticated model (based on a previously introduced
model [11]) in order to be able to study the spread of the disease worldwide. In the same work,
the authors proposed a simplified version which reduces the mathematical complexity towards a
more tractable model, but yet preserving the ability to capture the most relevant features. Other
recent studies addressing the mathematical or statistical modelling in the context of the COVID19 include [14, 21, 20, 17], for example. As the literature focusing on COVID-19 modelling is
increasing a lot during last months and weeks, it results quite difficult for the authors to select
a list of the more relevant papers more recently arising in the topic, surely some of them being
developed in parallel to this contribution.
As mentioned before, we will follow the SDE approach where the randomness is typically
achieved by incorporating a Brownian motion, also known as Wiener process, to the ODEs of
the deterministic system. There are two common ways of addressing this stochastic extension.
On the one hand, an arbitrary random noise can be added to some of the equations in the ODE
system, thus transforming them into SDEs. On the other hand, one (or more) of the existing
model parameters can be perturbed, meaning that it (they) becomes a random variable or a
stochastic process. Although both approaches have been well investigated, recent examples are
[7, 15] for the random noise approach and [6, 5, 2] for the parameter perturbation, here we
prefer the second alternative. When adding random noise to an equation, it often comes with
an extra parameter to control the level of volatility, which might have no biological interpretation. However, in practice, the uncertainty will have impact on a particular model component,
typically represented by a model parameter. Therefore, a randomly perturbed parameter can
be reasonably explained in terms of the variability produced by the source of the considered
uncertainty.
In this work, we will consider a randomly perturbed disease contact rates. The approach
proposed here is however conceptually different than the ones typically found in the literature,
aiming to deal with some of the observed inconsistencies in the COVID-19 context. As a
natural choice, many stochastic SIR-like models rely on a normally distributed perturbation for
the disease contact rate parameters (see [6, 2], for example). However, this approach allows
negative values for the rates, which is biologically non-sensical, potentially appearing when the
rate is close to zero, as it is seen in practice for the COVID-19 [16]. This issue is overcome in
[5], by employing an exponential Ornstein-Uhlenbeck (OU) process to model the contact rate.
Although this process indeed ensures positiveness, it presents another undesirable feature: an
increasing variance in time. When analysing the disease transmission dynamics, there is not an
objective evidence of more variability in the disease contact rates in the long-term [19]. Actually,
one can expect more control of the disease spread patterns over the course of the epidemic.
For all the reasons mentioned above, we propose to model the contact disease rates by means

2

of the so-called CIR process, named after its authors Cox, Ingersoll and Ross [3]. The CIR
process is widely employed to simulate the evolution of interest rates in the quantitative finance
framework. In some sense, the interest rates in computational finance and the disease contact
rates in epidemiology present a rather similar behaviour: positiveness, controlled variability and
long-term stability.
The article is organized as follows. In Section 2 we introduce the proposed mathematical
model. Section 3 is describes the numerical methods for solving the model. Section 4 contains
the obtained results and their numerical and statistical analysis. Finally, Section 5 points out
some conclusions and possible future research lines.

2

A stochastic θ-SEIHRD model of the COVID-19

As mentioned in the previous introduction, we base our approach in the model in [10], which
provides an advanced extension of the classical SIR-like models that adds to the usual compartments in the SEIR model the very specific ones for COVID-19: undetected infectious, hospitalized and deaths. In [10], the authors first presented a very sophisticated, well motivated and
general model, with a significant amount of free parameters allowing an enormous flexibility,
including several territories. In order to make the model more practically tractable, the authors
also proposed a simplified version, by imposing several assumptions: single territory, regular
natality/mortality is neglected, and no imported/exported cases. Furthermore, some predefined
forms for the open parameters of the model are adopted.
Thus, the simplified θ-SEIHRD model proposed in [10] is therefore given by
dS
S(t)
(t) = −
(mE (t)βE E(t) + mI (t)βI I(t) + mIu (t)βIu (θ(t))Iu (t))
dt
N
S(t)
(mHR (t)βHR (t)HR (t) + mHD (t)βHD (t)HD (t)) ,
−
N
S(t)
dE
(t) =
(mE (t)βE E(t) + mI (t)βI I(t) + mIu (t)βIu (θ(t))Iu (t))
dt
N
S(t)
(mHR (t)βHR (t)HR (t) + mHD (t)βHD (t)HD (t)) − γE E(t),
+
N
dI
(t) = γE E(t) − γI (t)I(t),
dt
dIu
(t) = (1 − θ(t))γI (t)I(t) − γIu (t)Iu (t),
dt


dHR
ω(t)
γI (t)I(t) − γHR (t)HR (t),
(t) = θ(t) 1 −
dt
θ(t)
dHD
(t) = ω(t)γI (t)I(t) − γHD (t)HD (t),
dt
dRd
(t) = γHR (t)HR (t),
dt
dRu
(t) = γIu (t)Iu (t),
dt
dD
(t) = γHD (t)HD (t).
dt

(1)

Note that the last three equations of the system (1) are uncoupled with previous ones, so that

3

the expression of their solution can be obtained by
Z t
γHR (s)HR (s)ds,
Rd (t) = Rd (t0 ) +
t0
t

Ru (t) = Ru (t0 ) +
D(t) = D(t0 ) +

Z

Z

γIu (s)Iu (s)ds,
t0
t

γHD (s)HD (s)ds,

t0

once the first six ones have been solved in a first stage. Thus, only the first six coupled equations
need to be solved. The system (1) is completed with the initial data S(t0 ), E(t0 ), I(t0 ), Iu (t0 ),
HR (t0 ), HD (t0 ), Rd (t0 ), Ru (t0 ) and D(t0 ).
The model includes a number of open parameters, the model parameters, which are often
determined either from the available data/literature or by calibration. In the following, a detailed
explanation of each parameter is provided:
• Efficiency of the control measures mE , mI , mIu , mHR , mHD ∈ [0, 1](%). Here, only one
control measure is assumed (mobility restrictions, for example), implemented at date λ1
and represented by a decaying function
(
1,
if t ∈ [0, λ1 ],
mE (t) = mI (t) = mIu (t) = mHR (t) = mHD (t) =
exp (−κ1 (t − λ1 )) , if t ∈ [λ1 , T ],
with the parameter κ1 ∈ [0, 0.2] entering in the calibration procedure. The generalization
to more/individualized control measures is straightforward.
• The fatality rate ω(t) ∈ [ω, ω] ⊂ [0, 1], for which the following form is proposed
ω(t) = mI (t)ω + (1 − mI (t))ω,
with ω and ω being the fatality rate limits with and without control measures, respectively.
As ω ≥ ω, its value is defined in terms of a displacement w.r.t the lower limit, i.e. ω =
ω + δω , whose values are calibrated.
• The fraction of infected individuals which are detected and documented by the authorities,
θ. Assuming that all deaths are detected i.e. θ ∈ [ω, 1] and it changes in time,

if t ∈ [t, λ1 ],

θ,
θ(t) = linear continuous, if t ∈ [λ1 , λ2 ],


θ,
if t ∈ [λ2 , T ],
with θ, θ, λ1 , λ2 inferred from the data.

• The disease contact rates βE , βI , βIu , βHR , βHD ∈ R+ . The parameter βI is assumed to
be given, calibrated to the available data, and a relation between it and the rest of the
contact rates exists,
βE = CE βI ,

βIu (t) = β I +

βI − β I
1 − ω(t)

4

(1 − θ(t)),

βHR = βHD = CH (t)βI ,

(2)

where β I = Cu βI , with CE , CH (t) and Cu ∈ [0, 1]. Parameters CE and Cu are also
obtained by calibration, while CH (t) is determined by employing the data of the infection
transmissions within hospitals, usually available, as


β (t)
I
+ γEβE(t) + (1 − θ(t)) γIIu (t)
αH γIβ(t)
u



CH (t) =
ω(t)
ω(t)
1
(1 − αH )βI θ(t) 1 − θ(t) γH (t) + θ(t) γH 1 (t)
R

R

with αH being the percentage of cases (healthcare workers) infected by individuals in
compartments HR or HD .

• The compartment transition rates γE , γI , γIu , γHR , γHD ∈ (0, +∞). They are constructed
in accordance to the recent literature, based on the average duration (in days) of an
individual in each infectious compartment, denoted by dE , dI , dIu , dHR and dHD . Lets
assume that dIu = dHR and dHD = dHR + δR , δR > 0. Thus,
γI =

1
,
dE

γI (t) =

1
,
dI − g(t)

γIu (t) = γHR (t) =

dIu

1
,
+ g(t)

γHD (t) =

dIu

1
,
+ g(t) + δR

where g(t) = dg (1 − mI (t)) represents the decrease of the duration of dI due to the
application of control measures at time t, and dg is the maximum number of days that
dI can be decreased due to the control measures. The parameter δR is included in the
calibration.
Our aim is to introduce stochasticity to the simplified θ-SEIHRD model above. For this
purpose, to keep the interpretability of the model, we will add some randomness to a set of
parameters. In our approach, we will add randomness on the disease contact rates, β’s. More
precisely, as in the simplified deterministic version proposed in [10] all the β’s depend on βI , as
indicated in (2), it is sufficient to add uncertainty in the model parameter βI by turning it into
a stochastic process, i.e a random variable at each time instant.
Thus, we start by writing the model in terms of βI . From the Equation (2), we have the
following relations:
βE = βI AE , βIu = βI AIu , βHR = βI AHR , βHD = βI AHD ,
where

AE = CE ,
(1 − Cu )(1 − θ(t))
,
1 − ω(t)


AIu (t)
E
αH γI1(t) + A
γE + (1 − θ(t)) γIu (t)
.

AHR (t) = AHD (t) =
ω(t)
1
1
)
+
(1 − αH )θ(t) (1 − ω(t)
θ(t) γH (t)
θ(t) γH (t)
AIu (t) = Cu +

R

5

D

By using the previous notation, the simplified θ-SEIHRD model in (1) can be rewritten as,
dS
S(t)M (t)
(t) = −βI
,
dt
N
S(t)M (t)
dE
(t) = βI
− γE E(t),
dt
N
dI
(t) = γE E(t) − γI I(t),
dt
dIu
(t) = (1 − θ(t))γI I(t) − γIu Iu (t),
dt


ω(t)
dHR
γI I(t) − γHR HR (t),
(t) = θ(t) 1 −
dt
θ(t)
dHD
(t) = ω(t)γI I(t) − γHD HD (t),
dt
dRd
(t) = γHR (t)HR (t),
dt
dRu
(t) = γIu (t)Iu (t),
dt
dD
(t) = γHD (t)HD (t),
dt

(3)

M (t) = mE AE E(t) + mI I(t) + mIu AIu Iu (t) + mHR AHR HR (t) + mHD AHD HD (t).

(4)

where

We now incorporate a stochastic component into the model by, as mentioned, by replacing
the constant parameter βI of the deterministic model by a stochastic process.
Lets then assume that, instead of considering a constant value βI , the disease contact rate
in compartment I follows a newly introduced stochastic process β̃I (t). In order to preserve the
positiveness in the parameter definition (imposed by its biological interpretation), we choose
the well-known CIR process [3]. The main advantage of the CIR process is that it theoretically
ensures the spacial states to be non-negative. Further, the CIR process is a mean-reverting
process meaning that, in the long term, the dynamics of the process tend to a prescribed value
(the average). This can have a biological interpretation since, at the early stages of the disease,
the contacts between people are less controlled, so more volatile. In the mid-long term, the
individual contacts and the disease spread patterns are more studied and the variability in its
estimation ranges is reduced. Accordingly, the dynamics of β̃I read
q
(5)
dβ̃I (t) = νβI (µβI − β̃I (t))dt + σβI β̃(t)dW (t)
where νβI is the mean reverting speed, µβI is the long-term average, σβI is the volatility and
dW (t) is a Brownian motion increment.
Therefore, the corresponding system of SDEs governing the stochastic θ-SEIHRD model is

6

given by,
S(t)M (t)
dt
dS(t) = β̃I (t)
N


S(t)M (t)
dE(t) = β̃I (t)
− γE E(t) dt
N
dI(t) = (γE E(t) − γI I(t)) dt,

dIu (t) = ((1 − θ(t))γI I(t) − γIu Iu (t)) dt,




ω(t)
γI I(t) − γHR HR (t) dt,
dHR (t) = θ(t) 1 −
θ(t)

(6)

dHD (t) = (ω(t)γI I(t) − γHD HD (t)) dt,
dRd (t) = γHR (t)HR (t)dt,
dRu (t) = γIu (t)Iu (t)dt,
dD(t) = γHD (t)HD (t)dt,
dβ̃I (t) = νβI (µβI − β̃I (t))dt + σβI

q
β̃(t)dW (t).

with M (t) as defined in Equation (4). Although only one source of randomness is introduced,
the solution of the whole system becomes a set of stochastic processes, due to the dependence
of the remaining equations on the first equations for S and E, and their own dependence on
β̃I . Note also that we could add more time dependency to β̃I both in the deterministic model
(which is not the case in [10]) as well as in the stochastic version (by considering either νβI , µβI
or σβI time dependent).
Note that our approach could be generalized to a setting where some of the parameters
were independent, in this case we would consider each one as a Gaussian random variable and
possible correlations between some or all of them. In this more general setting, a certain number
of different (possibly correlated) Brownian motion processes would come into place.

3

Numerical solution

For a set of constant initial data S(0), E(0), I(0), Iu (0), HR (0), HD (0), Rd (0), Ru (0), D(0) and
β̃I (0), the system of SDEs (6) has a unique strong solution. This follows from the fact that the
coefficients of the SDEs are locally Lipchitz continuous and the initial condition is a constant
value (see [13], for example).
Although in the stochastic θ-SEIHRD model (6) the solution is a finite set of stochastic
processes, we maintain the same notation we used for the finite set of real valued functions
representing the solution of the deterministic θ-SEIHRD model.
As the system of SDEs (6) is nonlinear, it is not possible to obtain a closed-form expression
for the solution, as it also happens with the deterministic version. Therefore, the use of numerical
methods for solving (6) becomes mandatory. Here, we adopt the following strategy. First, we
perform a simulation of the dynamics of β̃I (t), in accordance with the CIR process. After, we
solve the resulting ODE system for each simulated path of β̃I (t). In this way, we obtain a set
of random walks for each stochastic process representing a model variable.
The CIR process is a well-studied dynamics often employed in computational finance (see [18]
for example), which satisfies the SDE in Equation (5). From the mathematical point of view,
one of its relevant features is that the underlying distribution is known analytically, relying
on the non-central chi-squared distribution. Thus, given two time points, s and t, s < t, the

7

conditional distribution of β̃I defined in Equation (5) reads
β̃I (t)|β̃I (s) ∼ c(t, s) · χ
where
c(t, s) =

2

!
e−νβI (t−s)
d,
β̃I (s) ,
c(t, s)


σβ2I 
1 − e−νβI (t−s) ,
4µβI

d=

4νβI µβI
,
σβ2I

and χ2 (a, b) is the non-central chi-squared distribution with a degrees of freedom and noncentrality parameter b. This form the basis for an exact simulation scheme, which can be used
to obtain realizations of β̃I . Given a set of m + 1 time points, {ti }m
0 , where the solution will be
computed, we have, for i = 0, . . . , m − 1,
c(ti+1 , ti ) =


σβ2I 
1 − e−νβI (ti+1 −ti ) ,
4µβI

β̃I (ti+1 ) = c(ti+1 , ti )χ
with the constant parameter d =

4νβI µβI
2
σβ

!
e−νβI (ti+1 −ti )
d,
β̃I (ti )
c(ti+1 − ti )

2

and some initial value β̃I (t0 ) = β̃I (0). By employing

I

this scheme, we generate n simulated discrete sample paths of β̃I .
Once the sample paths of β̃I have been obtained, we numerically solve n ODE systems,
one for each of these paths. For this purpose, we choose the explicit Runge-Kutta method of
order 5(4), known as RK45, RKDP or Dormand–Prince method, see [4]. Note that the time
discretization needs to include the time points used in the simulation of β̃I . Alternatively,
the whole system in Equation (6) can be solved by the Euler-Maruyama scheme (see [13], for
example), which is the stochastic version of the classical Euler scheme for solving ODE systems.
Although this choice would provide faster solutions, it involves discretization errors, giving rise
to some lack of precision and robustness.
In order to illustrate the potential of the stochastic version of θ-SEIHRD model, in Figures 1,
2 and 3 we present the solution of the deterministic model versus a number of possible scenarios
(simulations) obtained by the stochastic model. We can clearly observe that the outcomes by
the stochastic model provide much more information about the future evolution of each model
compartment, while the deterministic one seems to be somehow an averaged version of the
stochastic formulation. This gives just an initial insight of the potential of the newly introduced
model, which will be completed in the next section with a more detailed analysis.

4

Numerical and statistical analysis

The experiments have been conducted in a computer system with the following characteristics:
CPU Intel Core i7-4720HQ 2.6GHz, 16GB RAM memory and GPU GeForce GTX 970M. The
numerical codes have been implemented in Python programming language. We consider a
equally spaced time grid, i.e. ∆t := ti+1 − ti , ∀i, with time step ∆t = 16 (around 4 hours).
In this section, we perform a numerical and statistical study of the proposed stochastic
model. As mentioned, the solution of the system of SDEs in (6) is a set of stochastic processes,
meaning that we can “extract” a random variable at each time point. Doing so, not only a
single value (like for the deterministic case), but also some statistics can be provided given a
prescribed time. In this work, we consider the mean, the interquartile interval, [Q1 , Q3 ], with
8

+1.4e9

+1.4e9

Average scenario

805000

805000
S(t)

810000

S(t)

810000

800000

800000

795000

795000

790000

0

20

40

60
t

80

100

790000

120

0

20

40

80

100

120

(b) S(t)

5000

5000

4000

4000

3000

3000

E(t)

E(t)

(a) S(t)

60
t

2000

2000

1000

1000

Average scenario

0

0
0

20

40

60
t

80

100

0

120

20

40

(c) E(t)

60
t

80

100

120

(d) E(t)

3000

3000

2500

2500

2000

2000
I(t)

3500

I(t)

3500

1500

1500

1000

1000

500

500

Average scenario

0

0

0

20

40

60

80

100

0

120

t

(e) I(t)

20

40

60
t

80

100

120

(f) I(t)

Figure 1: Deterministic vs. Stochastic: νβI = 1, µβI = βI and σβI = 0.1, with n = 8 Monte
Carlo simulations.
Q1 and Q3 being the first and the third quartiles, respectively, and a worst case scenario (WS),
applied to both the evolution of the model variables and the possible model outputs.

9

Average scenario

3000

3000
Iu(t)

4000

Iu(t)

4000

2000

2000

1000

1000

0

0

0

20

40

60

80

100

0

120

20

40

t

4000

4000

3000

3000

2000

1000

100

120

Average scenario

2000

1000

0

0

0

20

40

60
t

80

100

120

0

20

(c) HR (t)

40

60
t

80

100

120

(d) HR (t)

250

250

200

200

150

150

Average scenario

HD(t)

HD(t)

80

(b) Iu (t)

HR(t)

HR(t)

(a) Iu (t)

60
t

100

100

50

50

0

0

0

20

40

60
t

80

100

120

0

(e) HD (t)

20

40

60
t

80

100

120

(f) HD (t)

Figure 2: Deterministic vs. Stochastic: νβI = 1, µβI = βI and σβI = 0.1, with n = 8 Monte
Carlo simulations.
Here we take advantage of the experiments conducted in [10], referred to the case of China.
In Tables 1 and 2 the reported values for the open coefficients are presented, distinguishing

10

10000

8000

8000

6000

6000
Rd(t)

Rd(t)

10000

4000
2000

Average scenario

4000
2000

0

0

0

20

40

60
t

80

100

120

0

20

40

(a) Rd (t)

60
t

80

100

120

80

100

120

80

100

120

(b) Rd (t)

10000

8000

8000

6000

6000

Ru(t)

Ru(t)

Average scenario

10000

4000

4000

2000

2000

0

0

0

20

40

60
t

80

100

120

0

20

40

(c) Ru (t)

60
t

(d) Ru (t)

400

400

300

300
D(t)

D(t)

Average scenario

200
100

200
100

0

0

0

20

40

60
t

80

100

120

0

(e) D(t)

20

40

60
t

(f) D(t)

Figure 3: Deterministic vs. Stochastic: νβI = 1, µβI = βI and σβI = 0.1, with n = 8 Monte
Carlo simulations.
between the ones extracted from the literature or by experience, and the ones obtained by a
calibration procedure in [10], respectively. The initial data is given by S(t0 ) = N − 1, E(t0 ) = 1

11

Notation
N
t0
T
λ1
λ2
θ
θ
αH
dE
dI
dIu
dg
Co
p(t)

Value
1400812636
1-12-2019
29-3-2020
23-1-2020
8-2-2020
14%
65%
2.75%
5.5
6.7
14 − dI = 7.3
6
14
1

Description
Total population.
Initial date.
Final date.
Date when travel restrictions were imposed in Wuhan.
Inflexion date.
Percentage of documented cases at λ1 .
Percentage of documented cases at λ2 .
Percentage of infection produced by hospitalized people.
Average days in compartment E.
Average days in compartment I.
Average days in compartment Iu .
Maximum reduction of dI due to the control measures.
The period of convalescence.
Fraction of the infected people hospitalized.

Table 1: Parameters extracted from the experience and/or literature.
Notation
βI
CE
Cu
δR
δω
ω
κ1

Value
0.2887
0.3643
0.4010
7.0000
0.0206
0.0157
0.1082

Description
Disease contact rate of a person in compartment I.
Reduction factor of the disease contact rate βE w.r.t βI .
Reduction factor of the disease contact rate β I w.r.t βI .
Difference between days in compartment HR and HD .
Difference between ω and ω.
Lower bound of the fatality rate.
Efficiency of the control measures.

Table 2: Parameters obtained by calibration to the data.
and I(t0 ) = Iu (t0 ) = HR (t0 ) = HD (t0 ) = Rd (t0 ) = Ru (t0 ) = D(t0 ) = 0.

4.1

Model variables

We firstly test the evolution of the model variables. Thus, we extract some simulation-based
statistics at a couple of time instants, the 8th February (inflection point) and the 29th March
(final point). Furthermore, the impact of different levels of uncertainty is also reported by
considering several representative values for σβI , reflecting situations of no uncertainty (σβI = 0),
low uncertainty (σβI = 0.1) and high uncertainty (σβI = 0.5). In all cases, the long-term mean
of the perturbation is set to the calibrated value of βI for the deterministic model, i.e. µβI = βI .
The mean reverting speed parameter is chosen as νβI = 1, thus representing a regular (not too
high, not too low) reversion speed. In Table 3, the obtained results are presented. We can
clearly observe the significant impact of the uncertainty in the disease evolution. In the case of
higher uncertainty, the number of infections, in average, is almost doubled and, the worst case
scenario multiplies this value by six. Even when a lower volatility is considered, the increment
of cases and deaths in the worst scenario becomes important, up to 50%.
Next to the previous experiment, in Figure 4 we present the histograms for the model variable
I(t) to give an insight of the impact of the uncertainty in the infection evolution. First, we clearly
observe that the produced distribution is skewed with a fatter right tail. Secondly, the bigger
the volatility of process β̃I (t), i.e. σβI , is, the fatter the right tail becomes, thus indicating more

12

E(t)
I(t)
Iu (t)
HR (t)
HD (t)
Rd (t)
Ru (t)
D(t)

σβI = 0
Mean
2993
1340
3854
3252
214
1846
4296
131

E(t)
I(t)
Iu (t)
HR (t)
HD (t)
Rd (t)
Ru (t)
D(t)

σβI = 0
Mean
1
0
173
232
30
8460
9969
417

Mean
3067
1376
3945
3328
219
1888
4390
134

8th February, 2020
σβI = 0.1
[Q1 , Q3 ]
WS (95%)
[2506, 3519]
4510
[1125, 1578]
2017
[3249, 4505]
5724
[2732, 3806]
4854
[181, 250]
318
[1559, 2153]
2726
[3656, 4985]
6238
[112, 152]
190

(t = 69)

Mean
1
0
177
237
30
8662
10198
426

29th March, 2020 (t = 119)
σβI = 0.1
σβI = 0.5
[Q1 , Q3 ]
WS (95%) Mean
[Q1 , Q3 ]
WS (95%)
[1, 1]
2
2
[0, 3]
10
[0, 0]
0
0
[0, 0]
1
[146, 203]
259
309
[63, 314]
1075
[194, 272]
348
416
[83, 420]
1458
[25, 35]
45
53
[11, 54]
186
[7118, 9910]
12624
15087 [3101, 15287]
52651
[8442, 11616]
14681
17386 [3862, 17941]
59616
[353, 486]
614
728
[161, 751]
2502

Mean
5401
2419
6811
5799
377
3231
7301
222

σβI = 0.5
[Q1 , Q3 ]
WS (95%)
[1049, 5415]
18970
[476, 2423]
8522
[1434, 6940]
23728
[1182, 5863]
20340
[80, 386]
1311
[701, 3317]
11168
[1738, 7690]
24654
[53, 235]
747

Table 3: Variables of the Stochastic θ-SEIHRD model: νβI = 1, µβI = βI and n = 215 Monte
Carlo simulations. Columns: mean, interquartile interval ([Q1 , Q3 ]) and worst case scenario
(WS).
probability of extreme events.

0.00025

0.0012

0.00020
Histogram I(t)

Histogram I(t)

0.0010
0.0008
0.0006

0.00015
0.00010

0.0004
0.00005

0.0002
0.0000

500

1000

1500

2000

2500
x

3000

3500

0.00000

4000

(a) σβI = 0.1

0

20000 40000 60000 80000 100000 120000 140000 160000
x

(b) σβI = 0.5

Figure 4: Histogram of I(t). Setting: νβI = 1 and µβI = βI , with n = 215 Monte Carlo
simulations.

13

4.2

Outputs

In [10], the authors proposed a set of possible outputs that can be useful for the authorities
to plan the resources allocation, like the number of clinical beds, for example, among other
indicators. These outputs are:
• The cumulative number of COVID-19 cases, cm (t), at time t:
cm (t) = HR (t) + HD (t) + Rd (t) + D(t) = cm (t0 ) +

Z

t

θ(s)γI (s)I(s)ds.
t0

• The cumulative number of deaths due to the COVID-19, at time t: dm (t) = D(t).
• The basic reproduction number, R0 , and the effective reproduction number, Re (t), at time
t, where R0 = Re (t0 ), and
Re (t) =

Ue (t)
S(t)
,
γE γI (t)γHR (t)γHD (t)γIu (t) N

with1
Ue (t) = (((mIu βIu (1 − θ)γHR + mHR βHR γIu (θ − ω))γI + mI βI γHR γIu ) γE + mE βE γI γHR γIu ) γHD
+ mHD βHD ωγE γI γHR γIu .
• Hospitalized people, Hos(t), at time t:
Hos(t) = HD (t) + p(t) (HR (t) + Rd (t) − Rd (t − Co )) ,
where p(t) is the fraction of people in compartment HR that are hospitalized and Co is
the period of convalescence.
• Maximum number of hospitalized people in the interval [t0 , t]:
MHos(t) = max Hos(τ ).
τ ∈[t0 ,t]

• The number of individuals infected by others belonging to compartments E, Iu and H =
HR + HD :
Z t
S(s)
ds,
mE (s)βE E(s)
ΓE (t) =
N
t0
Z t
S(s)
mIu (s)βIu Iu (s)
ΓIu (t) =
ds,
N
t0
Z t
S(s)
(mHR (s)βHR HR (s) + mHD (s)βHD HD (s))
ΓH (t) =
ds,
N
t0
respectively.
We therefore perform a similar statistical analysis as before, although now reporting the
model outputs. The results are shown in Table 4. Again, it is clear that the uncertainty can
significantly affect the disease evolution, and it should be taken into consideration. For example,

14

cm (t)
dm (t)
Re (t)
Hos(t)
MHos(t)
ΓE (t)
ΓIu (t)
ΓH (t)

σβI = 0
Mean
5440
131
0.3363
4040
4040
5012
4550
198

cm (t)
dm (t)
Re (t)
Hos(t)
MHos(t)
ΓE (t)
ΓIu (t)
ΓH (t)

σβI = 0
Mean
9140
417
0.0013
306
4558
5259
5388
229

Mean
5571
134
0.3364
4134
4134
5126
4646
202

8th February, 2020 (t = 69)
σβI = 0.1
σβI = 0.5
[Q1 , Q3 ]
WS (95%) Mean
[Q1 , Q3 ]
[4586, 6362]
8088
9631
[2026, 9812]
[112, 152]
190
222
[53, 235]
[0.3151, 0.3562]
0.3891
0.3367 [0.2245, 0.4149]
[3395, 4727]
6026
7197
[1471, 7273]
[3395, 4727]
6026
7197
[1471, 7273]
[4255, 5833]
7337
8625
[1979, 9013]
[3864, 5285]
6640
7600
[1764, 7976]
[168, 230]
288
328
[78, 346]

WS (95%)
33466
747
0.6340
25262
25262
29414
25755
1106

Mean
9358
426
0.0013
314
4671
5379
5504
234

29th March, 2020 (t = 119)
σβI = 0.1
σβI = 0.5
[Q1 , Q3 ]
WS (95%) Mean
[Q1 , Q3 ]
[7691, 10704]
13631
16286
[3358, 16526]
[353, 486]
614
728
[161, 751]
[0.0012 , 0.0014]
0.0015
0.0013 [0.0009, 0.0016]
[257, 360]
459
549
[111, 555]
[3832, 5347]
6816
8195
[1662, 8258]
[4464, 6122]
7705
9070
[2073, 9465]
[4570, 6264]
7886
9082
[2080, 9479]
[195, 266]
334
384
[89, 402]

WS (95%)
56752
2502
0.0024
1927
28681
30925
30911
1298

Table 4: Outputs of the Stochastic θ-SEIHRD model: νβI = 1, µβI = βI and n = 215 Monte
Carlo simulations. Columns: mean, interquartile interval ([Q1 , Q3 ]) and worst case scenario
(WS).
the people requiring hospitalization may vary from around 4500 with no stochasticity included,
to around 30000 including randomness.
As previously pointed out, one of the major advantages of the θ-SEIHRD model is that it
accounts for important aspects of the COVID-19 pandemic, directly affecting the population or
the healthcare systems. Particularly, the evolution of some curves, infected, hospitalized and
deaths, is typically reported by the authorities, in both cumulative and daily fashion. In Figures
5 and 6, we show the model outcomes for these specific curves, considering two uncertainty levels,
σβI = 0.1 and σβI = 0.5, respectively. Again, we present the mean, the interquartile interval
and the worst case scenario. From this experiment, an interesting observation can be extracted.
Looking at the different patterns in the restults w.r.t. the volatility parameter, we can see that
an increasing uncertainty pushes the mean close to the third quartile, Q3 , meaning that the
disease evolves, in average, according to the 75% worst scenario. This fact gives an insight of
how important the randomness can be and why it is crucial to include it in the modelling.

5

Discussion and conclusions

We have extended the model developed in [10] by incorporating randomness to some relevant
coefficients and we have shown the importance of considering this uncertainty. In this way,
1 The dependence of the coefficients on the time t has been omitted for notational purposes. All the coefficients
take their particular values at day t.

15

14000

Mean

Mean
14000

Interquartile interval

Interquartile interval

Worst case scenario (95%)

Worst case scenario (95%)
Undetected cumulative cases

Reported cumulative cases

12000

10000

8000

6000

4000

2000

12000

10000

8000

6000

4000

2000

0

0

0

20

40

60

80

100

120

0

20

40

t

800

Interquartile interval

Reported daily infected

Hospitalized cases

120

Mean

700

5000
4000
3000
2000
1000

Worst case scenario (95%)

600

500

400

300

200

100

0

0

0

20

40

60
t

80

100

120

0

40

60

80

100

120

(d) Reported daily infected

Mean

Mean

Interquartile interval
15.0

20

t

(c) Hospitalized

Interquartile interval

400

Worst case scenario (95%)

Worst case scenario (95%)

Reported daily recovered

Reported daily deaths

100

(b) Undetected cumulative

Mean
Interquartile interval
Worst case scenario (95%)

6000

80

t

(a) Reported cumulative

7000

60

12.5

10.0

7.5

5.0

300

200

100

2.5

0.0

0

0

20

40

60

80

100

120

0

t

20

40

60

80

100

120

t

(e) Reported daily deaths

(f) Reported daily recovered

Figure 5: Epidemic curves: mean, interquartile interval and worst case scenario. Setting: νβI =
1, µβI = βI and σβI = 0.1, with n = 215 Monte Carlo simulations.
besides the information provided by the deterministic model (which allows to obtain a proxy
to the average of the main variables), we can take advantage of a more complete modelling

16

Mean

Mean

60000

Interquartile interval

Interquartile interval

Worst case scenario (95%)

Worst case scenario (95%)
Undetected cumulative cases

Reported cumulative cases

50000

40000

30000

20000

10000

50000

40000

30000

20000

10000

0

0

0

20

40

60

80

100

120

0

20

40

t

100

120

(b) Undetected cumulative

30000

3500
Mean

Mean

Interquartile interval

25000

Interquartile interval
3000

Worst case scenario (95%)

Reported daily infected

cases

80

t

(a) Reported cumulative

Hospitalized

60

20000
15000
10000
5000

Worst case scenario (95%)

2500

2000

1500

1000

500

0

0

0

20

40

60
t

80

100

120

0

60

80

100

120

(d) Reported daily infected

Mean

Mean
1750

Interquartile interval

Interquartile interval

Worst case scenario (95%)

60

40

t

(c) Hospitalized

70

20

Worst case scenario (95%)

Reported daily recovered

Reported daily deaths

1500

50

40

30

20

10

1250

1000

750

500

250

0

0

0

20

40

60

80

100

120

0

t

20

40

60

80

100

120

t

(e) Reported daily deaths

(f) Reported daily recovered

Figure 6: Epidemic curves: mean, interquartile interval and worst case scenario. Setting: νβI =
1, µβI = βI and σβI = 0.5, with n = 215 Monte Carlo simulations.
approach, which allows not only to compute confidence intervals for these variables in this new
random setting but also to obtain the worst case scenario. The information about the model

17

variables in this worst case scenario allows to develop more conservative policies in the actions
against the results of the COVID-19, as for example to plan larger health resources to take
care of a larger number of people requiring hospitalization at different levels. The differences
between the deterministic and stochastic models in terms of the information contained in the
output variables has been clearly illustrated in the previous section.
However, we also understand that research in this line can be extended. A fist possible
extension comes from making the parameters independent among each other and use different
stochastic processes to characterize their dynamics. In this first approach, as in [10], we consider
that all parameters depend on βI . Also, it seems possible to incorporate randomness to the more
recent model in [9] that mainly incorporate a new compartment of persons in quarantine (Q) to
model the situation in certain countries like Italy.

Acknowledgements
This work was funded by Xunta de Galicia grant ED431C2018/033, including FEDER funding. Both authors also acknowledge the support received from the Centro de Investigación de
Galicia “CITIC”, funded by Xunta de Galicia and the European Union (European Regional
Development Fund- Galicia 2014-2020 Program), by grant ED431G 2019/01.
Álvaro Leitao acknowledges the financial support from the Spanish Ministry of Science,
Innovation and Universities, through the Juan de la Cierva-formación 2017 (FJC17) grant in
the framework of the national programme for R&D 2013-2016.

References
[1] Linda J.S. Allen. A primer on stochastic epidemic models: Formulation, numerical simulation, and analysis. Infectious Disease Modelling, 2(2):128 – 142, 2017.
[2] Siyang Cai, Yongmei Cai, and Xuerong Mao. A stochastic differential equation SIS epidemic
model with two independent Brownian motions. Journal of Mathematical Analysis and
Applications, 474(2):1536 – 1550, 2019.
[3] John C. Cox, Jonathan E. Ingersoll, and Stephen A. Ross. A theory of the term structure
of interest rates. Econometrica, 53(2):385–407, 1985.
[4] John R. Dormand and P.J. Prince. A family of embedded Runge-Kutta formulae. Journal
of Computational and Applied Mathematics, 6(1):19 – 26, 1980.
[5] Joseph Dureau, Konstantinos Kalogeropoulos, and Marc Baguelin. Capturing the timevarying drivers of an epidemic using stochastic dynamical systems. Biostatistics, 14(3):541–
555, 01 2013.
[6] A. Gray, D. Greenhalgh, L. Hu, X. Mao, and J. Pan. A stochastic differential equation SIS
epidemic model. SIAM Journal on Applied Mathematics, 71(3):876–902, 2011.
[7] Xiaofeng Han, Fei Li, and Xinzhu Meng. Dynamics analysis of a nonlinear stochastic SEIR
epidemic system with varying population size. Entropy, 20(5), 2018.
[8] Herbert W. Hethcote. The mathematics of infectious diseases. SIAM Review, 42(4):599–
653, 2000.

18

[9] Benjamin Ivorra, Miriam R. Ferrández, Marı́a Vela-Pérez, and Ángel M. Ramos.
A simple but complex enough θ−SIR type model to be used with (COVID-19)
real data. Application to the case of Italy., 2020.
Available at ResearchGate:
https://doi.org/10.13140/RG.2.2.32466.17601.
[10] Benjamin Ivorra, Miriam R. Ferrández, Marı́a Vela-Pérez, and Ángel M. Ramos. Mathematical modeling of the spread of the coronavirus disease 2019 (COVID-19) taking into
account the undetected infections. The case of China. Communications in Nonlinear Science and Numerical Simulation, 88:105303, 2020.
[11] Benjamin Ivorra, Diène Ngom, and Ángel Ramos. Be-CoDiS: A mathematical model to
predict the risk of human diseases spread between countries-validation and application to
the 2014-2015 Ebola virus disease epidemic. Bulletin of Mathematical Biology, 77:1668–
1704, 09 2015.
[12] William Ogilvy Kermack, A. G. McKendrick, and Gilbert Thomas Walker. A contribution
to the mathematical theory of epidemics. Proceedings of the Royal Society of London. Series
A, Containing Papers of a Mathematical and Physical Character, 115(772):700–721, 1927.
[13] Peter E. Kloeden and Eckhard Platen. Numerical Methods for Stochastic Differential Equations. Springer, Berlin, 1992.
[14] Adam Kucharski, Timothy Russell, Charlie Diamond, Yang Liu, John Edmunds, Sebastian
Funk, Rosalind Eggo, Fiona Sun, Mark Jit, James Munday, Nicholas Davies, Amy Gimma,
Kevin Zandvoort, Hamish Gibbs, Joel Hellewell, Christopher Jarvis, Samuel Clifford, Billy
Quilty, Nikos Bosse, and Stefan Flasche. Early dynamics of transmission and control of
COVID-19: a mathematical modelling study. The Lancet Infectious Diseases, 20, 03 2020.
[15] Fei Li, Xinzhu Meng, and Xinzeng Wang. Analysis and numerical simulations of a stochastic
SEIQR epidemic system with quarantine-adjusted incidence and imperfect vaccination.
Computational and Mathematical Methods in Medicine, 2018.
[16] Ruiyun Li, Sen Pei, Bin Chen, Yimeng Song, Tao Zhang, Wan Yang, and Jeffrey Shaman.
Substantial undocumented infection facilitates the rapid dissemination of novel coronavirus
(SARS-CoV-2). Science, 368(6490):489–493, 2020.
[17] Alex Lipton and Marcos López de Prado. Mitigation strategies for COVID-19: lessons from
the K-SEIR model, 2020. Available at SSRN: https://ssrn.com/abstract=3623544.
[18] Cornelis W. Oosterlee and Lech A. Grzelak. Mathematical Modeling and Computation in
Finance. World Scientific (Europe), 2019.
[19] World Health Organization. Coronavirus disease (COVID-2019) situation reports, 2020.
[20] Eckhard Platen. Stochastic modelling of the COVID-19 epidemic, 2020. Available at SSRN:
https://ssrn.com/abstract=3586208.
[21] K. Roosa, Y. Lee, R. Luo, A. Kirpich, R. Rothenberg, J.M. Hyman, P. Yan, and G. Chowell.
Real-time forecasts of the COVID-19 epidemic in China from february 5th to february 24th,
2020. Infectious Disease Modelling, 5:256 – 263, 2020.

19

