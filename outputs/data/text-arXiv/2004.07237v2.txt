Digital Herd Immunity and COVID-19
Vir B. Bulchandani,1 Saumya Shivam,2 Sanjay Moudgalya,2 and S. L. Sondhi2

arXiv:2004.07237v2 [cond-mat.stat-mech] 26 May 2020

1

Department of Physics, University of California, Berkeley, Berkeley CA 94720, USA
2
Department of Physics, Princeton University, Princeton, New Jersey 08544, USA
(Dated: May 27, 2020)

A population can be immune to epidemics even if not all of its individual members are immune
to the disease, just as long as sufficiently many are immune—this is the traditional notion of herd
immunity. In the smartphone era a population can be immune to epidemics even if not a single
one of its members is immune to the disease—a notion we propose to call “digital herd immunity”, which is similarly an emergent characteristic of the population. This immunity arises because
contact-tracing protocols based on smartphone capabilities can lead to highly efficient quarantining
of infected population members and thus the extinguishing of nascent epidemics. When the disease
characteristics are favorable and smartphone usage is high enough, the population is in this immune
phase. As usage decreases there is a novel “contact tracing” phase transition to an epidemic phase.
We present and study a simple branching-process model for COVID-19 and show that digital immunity is possible regardless of the proportion of non-symptomatic transmission. We believe this is
a promising strategy for dealing with COVID-19 in many countries such as India, whose challenges
of scale motivated us to undertake this study.

I.

INTRODUCTION

Recent events have challenged the public health infrastructure worldwide for controlling the spread of contagious diseases. This difficulty is partly due to the novel
pathogen involved and partly due to some unusual characteristics of COVID-19 [1]. Specifically, the infection
appears to be transmitted through a large number of
asymptomatic and pre-symptomatic cases [1, 2].
This leaves two approaches to controlling an exponential growth in the number of infected people. The first
is continuous monitoring of entire populations via regular testing, which can identify new infections already
during their latent phase and thus end non-symptomatic
transmission. The second is the established method of
“contact tracing” [3], in which people who have been exposed to newly identified infected people are isolated before they have a chance to infect others. In principle,
either approach is capable of ending the epidemic.
Population-level testing is not possible as we write this.
Traditional contact tracing, done by teams of health officials relying on interviews with newly identified cases,
is also not up to the task today, as it fails if nonsymptomatic transmission is too frequent [3, 4]. Fortunately, we live in the smartphone era, and it has been
noted that using these devices to record contacts can
make the task of tracing them entirely solvable by automating it. This idea has been spelled out in a series
of papers [5, 6] (see also [7–9]) and is the basis for a
rapidly expanding set of contact-tracing apps and the recent announcement by the Apple-Google duopoly of their
intention to build the technology into their operating systems [10].
In this paper we contribute to this emerging field of
infectious disease control along two axes.
First, we present a simple model of the early stages
of the spread of COVID-19, which allows us to obtain
estimates, as a function of a varying amount of non-

symptomatic transmission, of the fraction of the population that needs to participate in a digital contact-sharing
network in order to prevent new epidemics. Our interest
in this question was seeded by the very practical question of whether a country like India can use this technology to achieve epidemic control today. Indeed, India
is now launched on this enterprise [11]. While modeling with various differences from our own became available while we were working on this problem [5, 12], we
feel that our approach has the virtue of making the existence and values of the estimated compliance thresholds
transparent. Our estimates for the fraction of the population that needs to own a contact-tracing app to avert a
COVID-19 epidemic range from 75% − 95% for R0 = 3,
depending on the fraction of asymptomatic transmission,
θ = 20% − 50%, that takes place. For smaller R0 produced by social distancing this fraction is lower.
Our second contribution is to frame the overall discussion in a language more familiar to physicists and
students of complex phenomena more generally—that of
phases, phase transitions and emergent properties. The
bottom line here is the idea that the immunity of a population to epidemic growth is an emergent, or collective,
property of the population. For traditional vaccination
or epidemic-induced “herd immunity”, this feature gets
conflated with the fact that individuals can be immune
to the disease at issue. But mass digital contact tracing
now makes it possible for the population to be immune
to epidemic growth even as no individual has immunity
to the underlying disease. We propose to refer to this
as the existence of a “digital herd immunity”. This fits
well into the general idea of an emergent property, which
does not exist at the level of the microscopic constituents
but exists for the collective [13, 14]. We would be remiss
if we did not note that epidemiologists have previously
referred to this state of affairs as “herd protection” and
“sustained epidemic control” [5]. Our intention with the
proposed terminology is both to frame a public health

2
goal by including the word digital and to emphasize the
emergent nature of a herd immunity.
Our application of ideas from statistical physics to the
theory of contact tracing yields three main dividends
compared to earlier approaches. First, we are able to
analytically quantify the effectiveness of contact tracing
for any recursive depth n, from the limit of traditional,
manual contact tracing, for which n = 1, to perfect digital tracing, for which n = ∞ in principle. Describing this crossover, which was beyond existing theoretical techniques [3, 15, 16], allows us to sharply formulate
an important, general principle of disease control: for
any proportion of non-symptomatic transmission, tracing
and isolation based on a sufficiently widespread contacttracing network, of sufficient recursive depth, can prevent epidemic spread. The second insight gained through
our approach is a point of principle that has been neglected in the public discourse surrounding this issue,
namely that with effective contact-tracing protocols in
place, nascent epidemics can be extinguished with probability one. Third, our study of the universal properties of
the contact-tracing phase transition allows us to capture
the full probability distribution for epidemic sizes as the
critical threshold for epidemic control is approached. Our
results imply that the contact-tracing phase boundary is
not even visible at the resolution of previous studies for
COVID-19 [12], that attempted to estimate the critical
threshold for contact tracing by numerically simulating
the epidemic-size distribution function.
In the balance of this paper we do the following. We
begin by summarizing the case for contact tracing as an
effective strategy for combating COVID-19. We then introduce a simple branching-process model for the spread
of this disease, that incorporates the key features of
asymptomatic transmission, pre-symptomatic transmission and recursive contact tracing. We find that there
is always a critical fraction 0 ≤ φc < 1 of app ownership, such that take-up of contact-tracing apps by a
fraction φ > φc of the population is sufficient to prevent
epidemic spread. We provide an analytical formula for
this threshold, which is verified against detailed numerical simulations, and characterize the universal features of
the resulting “contact-tracing phase transition”. Finally,
we address the applicability of our results to the specific
context of India.

II.

A.

A MODEL FOR APP-BASED CONTACT
TRACING
Motivation and relevance to COVID-19

Traditional contact tracing is a multi-stage process.
First, one identifies symptomatic, infected individuals.
Next, one finds the people they came into close contact
with during their infectious period. Finally, one treats
or isolates these people before they can go on to infect
others. Manual contact tracing becomes difficult for in-

fections that have a period before the onset of symptoms when an exposed person is contagious (the Ω period). Further delay in finding the symptomatic person
and their contacts could lead to tertiary infections, making it difficult to control an outbreak. For COVID-19,
the incubation period is thought to be around 5-6 days,
while the Ω period is estimated to be 1-3 days [2]. The
time before becoming contagious, or the latent period L,
is around 4 days. Stochasticity of these times aside, it is
reasonable to expect that if Ω < L on average, and if the
exposed contacts of an individual can be traced before
they become infectious, then an epidemic could be prevented. However, the delays typical for manual contact
tracing, even just one or two days, can render contact
tracing completely ineffective for COVID-19, given the
typical L and Ω periods; this conclusion is supported by
detailed numerical simulations [5, 12].
This is where digital contact tracing comes in. A
smartphone application could enable instant isolation of
an infected person and their network of contacts. This
halts the transmission chain, because infected contacts
cannot infect others during their latent period. The question immediately arises of how widespread such tracing
needs to be in order to prevent an epidemic, and this
question is the focus of our paper. Below we present a
simple model that captures the essential features of disease spread necessary to tackle this problem.
To place our work in context, the classic quantitative analyses of the efficacy of contact tracing [3, 4],
from before the smartphone era, showed that traditional,
manual contact-tracing protocols become useless when
the rate of non-symptomatic spreading, θ, is too high.
By contrast, app-based approaches allow for “recursive”
contact tracing, whereby contacts of contacts can be
traced to an arbitrary recursive depth, at no additional
cost. The effectiveness of recursive contact tracing has
been studied in previous work; mathematically rigorous results exist in simple limits [16, 17] and detailed
numerical simulations have been performed in analytically inaccessible regimes [15]. Some recent works have
provided quantitative estimates for the effectiveness of
non-recursive contact-tracing in the specific context of
COVID-19 [5, 6, 12]. Our results should be viewed as
complementary to these studies. One advantage of the
model that we propose is its simplicity; this allows for a
more thorough analytical understanding of the contacttracing phase transition than in previous works, for any
recursive depth, 0 ≤ n ≤ ∞.

B.

A branching-process model

Suppose we have an epidemic spreading through an
infinite population of susceptibles, in discrete time, and
infecting a number R of the population at each time step
(here, R is an “effective reproduction number” that depends on the detailed properties of the epidemic spread,
including the basic reproduction number R0 ). This is a

3
a)

CA

b)
CA
CS

CS

CA

CA

NS

NS

CA

CS

NS

CS

CA

NA

CS

c)
CA

CS

CS

CA

CA

NS

CA

NS

CS

NA

CS

FIG. 1. An illustrative realization of our branching-process
model. a) An in-network asymptomatic individual (CA) infects R0 = 3 people, whose category of infection is chosen independently and uniformly subject to parameters θ, the fraction of the population that presents asymptomatic cases, and
φ, the fraction of the population using a contact-tracing app.
b) A CS infection triggers an alert on the contact network,
but the CS individual and everybody else in their generation is still able to infect people before the contact network
is triggered (while we depict RS = 2, we also simulate more
realistic values RS = 0, 1). The arrows show the alerts sent
to everyone connected to the CS individual by the contact
network. c) Once the alert is sent out, everybody in the
contact-network-connected component of the CS individual
can be quarantined immediately (thick circles) without giving rise to further disease spread, since they are in the latent
(non-contagious) periods of their infections. Meanwhile, every
individual off the contact network continues to transmit the
disease freely. The “recursive” aspect of such contact tracing
corresponds to the arrow going back in time in Fig. (1b); the
middle branch of infections would be missed by a traditional,
non-recursive approach.

generic model for a spreading epidemic at short times.
The total number of infections I tot scales as
(
1
R<1
tot
(1)
I ∝ 1−R
∞
R ≥ 1,
and if R < 1, the epidemic has been controlled.
We want to understand which R best captures the effect of mobile-phone-based contact tracing. From a statistical physics perspective, R is the single relevant parameter controlling the epidemic spread, and drives a
phase transition from an “epidemic phase” to an “immune phase” as R decreases below R = 1, which we shall
elaborate on below. For the purposes of modelling epidemic spread, the key question is which “microscopic”

degrees of freedom must be included to obtain a realistic
estimate for R.
To this end, we consider three parameters that implicitly determine R : the fraction of the population that will
present asymptomatic cases (θ), the fraction of the population using a contact-tracing application (φ), and the
basic reproduction number for an individual who eventually shows symptoms (RS ). RS is a combined measure
of the number of pre-symptomatic infections and the efficacy of quarantine: in the limit of perfect isolation after
showing symptoms, RS is precisely the number of people that a symptomatic individual infects during their Ω
period, as defined above. We assume that RS is independent of whether a symptomatic individual is on the
contact-tracing network or not.
The effects of these parameters on the growth of the
epidemic (or R) are studied using a simple branchingprocess model, where all infectious individuals are either
symptomatic (S) or asymptomatic (A), and either on the
app-based contact tracing network (C) or not (N). In an
an uncontrolled setting, all types of infectious cases are
assumed to proliferate with R0 = 3, which is a reasonable estimate [18] for COVID-19 [19]. Suppose that the
outbreak starts from a single infected individual at time
t = 0 (“Patient Zero”). In our discrete time (generational) model, Patient Zero infects R0 other people at
time t = 1, and each new infection is assigned to one of
the categories {CA, CS, N A, N S} randomly, with probabilities that are determined by the values of θ and φ.
Individuals infected at the beginning of each generation
are assumed not to infect anyone else after that generation has elapsed. Whenever a symptomatic individual
on the contact network (CS) is encountered during this
branching process, the contact network is triggered, and
all people connected to the CS individual by the network,
through either past or present infections, are placed in
quarantine. As discussed earlier, since pre-symptomatic
infections are common for COVID-19, our model includes
the possibility that a CS individual infects RS people by
the time they trigger the contact network. As a consequence, non-CS individuals in the same generation are
also allowed to infect the next generation before the activation of the contact network (see Fig. 1c). A few timesteps of the model are illustrated explicitly in Fig. 1,
together with the implementation of recursive contact
tracing via removing connected components of the contact graph. Different combinations of the parameters θ,
φ and RS lead to an effective reproduction number R distinct from the bare reproduction number R0 , and we expect epidemic growth to be suppressed whenever R < 1.
Numerical simulations of this model were performed
on 10, 000 nodes with 100 initial infections, without replacement; the results are summarized in Fig. 2. The
location of the phase boundaries were verified to be independent of both doubling the system size and doubling the number of samples averaged per point shown
on the phase diagram, to within the resolution of the
phase diagram. Our numerics are consistent with the

4
sion are taken into account, the rate of app coverage necessary to prevent an epidemic can be rather high. Some
practical implications of this point are raised in the final
discussion.

C.

FIG. 2. Top: Phase diagrams of epidemic control for R0 = 3,
where the tuning parameters are θ, the rate of asymptomatic
transition, and φ, the fraction of contact-tracing app ownership among the population. RS denotes the basic reproduction number for pre-symptomatic transmission. Each phase
diagram was generated from 4000 microscopic simulations of
20 generations of disease evolution on 10, 000 nodes, of which
100 nodes were initially infected at random. A black square
denotes epidemic control (average growth in the cumulative
number of infections over the generations 16 − 20 is less than
0.25% of total population). This is grayscaled continuously
to white for late-time growth exceeding 2.5% per generation
or full epidemic spread before 20 generations have elapsed.
Dashed red curves show exact results for 10-step contact tracing, while dashed blue curves show an easy-to-use approximation to the exact result. Both formulae are presented in
Sec. II C. The exact critical point for θ = 0 and RS = 2, derived in Appendix A, is marked by a cyan arrow. Bottom:
Sample simulations from the encircled region in the RS = 0
phase diagram. Curves (solid) denote cumulative number of
infections as a percentage of total population, averaged over
10 samples (dashed), with θ = 0.5 fixed and φ varied from
φ = 0.6 to φ = 0.9.

hypothesis that for any given fraction of asymptomatic
transmission 0 ≤ θ < 1, and any presymptomatic reproduction number 0 ≤ RS ≤ R0 , there is a critical point
φc (θ), corresponding to the onset of “digital herd immunity”: epidemic control occurs for a fraction of app
owners φc (θ) < φ ≤ 1. For realistic COVID-19 parameter values, R0 = 3, RS = 1 and θ = 0.2 − 0.5
[5, 18], we find that φc (θ) = 75% − 95%, illustrating that
when both presymptomatic and asymptomatic transmis-

The contact-tracing phase transition

We now describe the sense in which our branchingprocess model exhibits a phase transition. Consider the
disease dynamics seeded by a single initial infection, Patient Zero, at t = 0. As the disease spreads, there are
two possibilities: either the epidemic seeded by Patient
Zero terminates at some finite time, or it continues to
spread indefinitely. In branching process theory [20], this
dichotomy is captured by the “probability of ultimate extinction”, q, which is the probability that the epidemic
seeded by Patient Zero terminates at some t < ∞.
To make the connection with statistical physics, consider the quantity ρ = 1 − q, which is the probability
that the epidemic seeded by Patient Zero spreads for all
time. This defines an order parameter for the epidemicto-immune phase transition, in the following sense. If
ρ > 0, an epidemic can spread with non-zero probability,
and the population is in an “epidemic phase”. If ρ = 0,
epidemics are almost surely contained, and the population is in an “immune phase”. In fact, ρ is precisely
the order parameter for a site percolation phase transition [21] on the infinite, rooted, Cayley tree with bulk
co-ordination number z = 1 + R0 .
We argued above that the epidemic-to-immune phase
transition is driven by a single relevant parameter, the
effective reproduction number, R. Let us now make this
statement precise. For simple epidemic models, the underlying branching process is Markovian, and we can define R to be the mean number of new infections generated
by an infected node. It is then a rigorous result that ρ = 0
for R ≤ 1 and ρ > 0 otherwise [20]. For such models,
the connection between epidemic spread and percolation
transitions has been known for some time [22–24]. By
contrast, for the model studied in this paper, the possibility of tracing successive contacts means that the disease
dynamics is no longer Markovian; there are correlations
between generations that preclude a simple definition of
R, and earlier theoretical results do not apply.
The main technical innovation in our work is surmounting this breakdown of the Markov property: we
develop generating function methods that allow for exact summation of non-Markovian contact-tracing processes, to any desired order. We show that despite intergenerational correlations, the critical behaviour is determined by a function Rn (φ, θ), which can be viewed as a
“mean number of new infections”, suitably averaged over
time. In particular, Rn (φ, θ) controls the ultimate fate
of the epidemic, and the critical line for n-step contact
tracing is given by an implicit equation
Rn (φ, θ) = 1

(2)

5
in φ and θ; details of the calculation and a full expression
for Rn (φ, θ) are presented in the Supplementary Material. Taking the limit as n → ∞ yields the exact critical
line for contact tracing to arbitrary recursive depth; however, for any n ≥ 1, this does not seem to be expressible
in closed form, except at its endpoints. Fortunately, the
function Rn is found to converge rapidly in its arguments
with increasing n. Fig. 2 depicts results from Eq. (2)
with ten-step contact tracing, n = 10, and shows excellent agreement with stochastic numerical simulations.
We now discuss the universal properties of this phase
transition. For concreteness, let us parameterize the critical line as (φc (θ), θ). For fixed θ in the domain of φc , a
transition from an epidemic to an immune phase occurs
as φ → φc (θ)− . We call this transition the “contacttracing phase transition”, because it is controlled by the
population fraction on the contact-tracing network. To
capture the universal properties of this transition, it is
helpful to consider the random variable |C|, which is the
size of the infected cluster seeded by Patient Zero in a
single realization of the branching process. On the immune side of the transition, |C| is almost surely finite,
and the risk of epidemics is captured by the mean cluster size, Eφ,θ (|C|). On the epidemic side of the transition, the mean cluster size diverges, and the order parameter ρφ,θ = Pφ,θ (|C| = ∞) better quantifies the risk
of epidemic spread. In the vicinity of the critical point
φ = φc (θ), both of these quantities are characterized by
universal critical exponents,
ρφ,θ ∼ (φc (θ) − φ)β , φ → φc (θ)− ,
1
Eφ,θ (|C|) ∼
, φ → φc (θ)+ .
(φ − φc (θ))γ

(3)
(4)

In the Supplementary Material, we show that γ = β = 1
for any finite n, demonstrating that the contact-tracing
phase transition lies in the universality class of mean-field
site percolation [25]. The scaling theory of percolation
transitions then implies a universal scaling form for the
distribution of epidemic sizes,
Pφ,θ (|C| = N ) ∼ N −3/2 f (N/Nξ ),

φ → φc (θ),

n=3
A

n=2

A

A

A
A

A
A

A

n=1
A

A
A

A

A

A

S

FIG. 3. The non-locality of the branching-process dynamics
increases with the contact-tracing depth, n. The figure depicts a growing cluster of asymptomatic infections that are
all on the contact network. As the recursion depth n for contact tracing increases, a single symptomatic infection allows
for isolation of increasingly large asymptomatic clusters, up to
a size that grows exponentially in n. In the limit n → ∞, this
results in a discontinuous phase transition at (φ, θ) = (1, 1);
see Appendix C for details.

We therefore present a simpler, approximate formula
for R = R∞ (φ, θ), based on linear interpolation and
a “mean-field” assumption, whereby inter-generational
correlations are neglected. The resulting approximation
to R, derived in Appendix D, is given by
 


1
2
φ2 . (6)
R ≈ RS (1 − θ)(1 − φ ) + R0 θ 1 − 1 −
R0
In Fig. 2, the critical threshold R = 1 predicted by Eq.
(6) is compared to the exact result, Eq. (2), for 10-step
contact tracing, and shows reasonably good quantitative
agreement.

(5)

where f is a scaling function with exponentially decaying tails, and the cluster correlation length Nξ ∼
(φ − φc (θ))−2 as φ → φc (θ).
As the recursive tracing depth n → ∞, we find that
such mean-field behaviour breaks down at the endpoint
of the critical line (φ, θ) = (1, 1), which exhibits a discontinuous phase transition, reflecting the non-locality
of the underlying branching process; see Fig. 3. The
emergence of a discontinuous percolation transition on
the Bethe lattice is highly unusual, and suggests that the
non-local character of the n = ∞ contact-tracing transition fundamentally distinguishes it from the percolationtype phase transitions that have arisen in related settings [22–24, 26, 27]
Although Eq. (2) is exact, the full expression for
Rn is a little cumbersome to rapidly adapt and use.

III.

DISCUSSION

We have introduced a simple branching-process model
for early-stage epidemic spread, which both retains a
degree of analytical and numerical tractability and is
sufficiently expressive to model complicated features
of COVID-19 spreading and control, for example presymptomatic transmission, as distinct from asymptomatic transmission, and recursive contact tracing. Using this model, we have obtained predictions for the app
take-up fraction needed to provide digital herd immunity
as a function of R0 and the asymptomatic transmission
frequency θ.
We now consider the practical applicability of our results to India, whose particular challenges provided the
initial stimulus for this work. India’s overall smartphone

6
coverage is around 40% [28]. However, this percentage
is much higher in the major cities which are the primary
challenge and since the start of the epidemic R0 has not
gone much higher than 2. Further almost 90% [28] of
Indians use some sort of wireless phone, which can be included on a digital contact tracing network to various
degrees using cell tower based triangulation and SMS
broadcast. So when compared with the challenges of
manual contact tracing, it is clear that the digital route is
much more scalable. Indeed, India has had considerable
success with this strategy already, with over 100 million
downloads and 100, 000 contacts traced.

infectious disease control one should start to think of the
herd immunity of a population as deriving from a combination of natural immunity, vaccination and digital immunity. For example, it seems realistic to aim at greatly
reducing the annual incidence of influenza worldwide by
adding digital control to the existing toolkit.

ACKNOWLEDGMENTS

We end with some comments towards the future. In
terms of statistical mechanics, it would be useful to generalize our computations to take real-world heterogeneity
of R0 into account [29] and to examine the course of epidemics on realistic graphs when φ < φc . In terms of

We would like to thank the Principal Scientific Adviser
to the Government of India, Professor K. VijayRaghavan, for interesting us in this question and for discussions of India’s Aarogya Setu contact tracing app, Professor Bryan Grenfell for sharing his wisdom regarding
epidemiology at an extremely hectic time and Dr. Shoibal
Chakravarty for continuing discussions on all aspect of
India’s COVID-19 challenges.

[1] P. G. Auwaerter, Coronavirus COVID-19 (SARS-CoV2), Johns Hopkins ABX Guide, The Johns Hopkins University, 2017 (2020).
[2] W. Wei, Z. Li, C. Chiew, S. Yong, and M. Toh, Presymptomatic Transmission of SARS-CoV-2 Singapore, January 23March 16, 2020, MMWR Morb Mortal Wkly Rep
69:411415 (2020).
[3] C. Fraser, S. Riley, R. M. Anderson, and N. M. Ferguson,
Factors that make an infectious disease outbreak controllable, Proceedings of the National Academy of Sciences
101, 6146 (2004).
[4] K. T. Eames and M. J. Keeling, Contact tracing and disease control, Proceedings of the Royal Society of London.
Series B: Biological Sciences 270, 2565 (2003).
[5] L. Ferretti, C. Wymant, M. Kendall, L. Zhao, A. Nurtay, L. Abeler-Dörner, M. Parker, D. Bonsall, and
C. Fraser, Quantifying SARS-CoV-2 transmission suggests epidemic control with digital contact tracing, Science 10.1126/science.abb6936 (2020).
[6] M. Faggian, M. Urbani, and L. Zanotto, Proximity: a
recipe to break the outbreak (2020), arXiv:2003.10222
[cs.CY].
[7] M. Salathé, M. Kazandjieva, J. W. Lee, P. Levis, M. W.
Feldman, and J. H. Jones, A high-resolution human contact network for infectious disease transmission, Proceedings of the National Academy of Sciences 107, 22020
(2010).
[8] E. Yoneki and J. Crowcroft, Epimap: Towards quantifying contact networks for understanding epidemiology in
developing countries, Ad Hoc Networks 13, 83 (2014).
[9] G. Gartner and H. Huang, Progress in Location-Based
Services 2014 , Lecture Notes in Geoinformation and Cartography (Springer International Publishing, 2014).
[10] Apple and Google partner on COVID-19 contact tracing
technology, Apple Press Release (2020).
[11] Aarogya Setu Mobile App, Government Of India (2020).
[12] J. Hellewell, S. Abbott, A. Gimma, N. I. Bosse, C. I.
Jarvis, T. W. Russell, J. D. Munday, A. J. Kucharski,
W. J. Edmunds, F. Sun, et al., Feasibility of con-

trolling COVID-19 outbreaks by isolation of cases and
contacts, The Lancet Global Health 10.1016/S2214109X(20)30074-7 (2020).
P. W. Anderson, More Is Different, Science 177, 393
(1972).
J.-Y. Moon and E. LaRock, On emergence from the
perspective of physical science (2017), arXiv:1705.11075
[physics.hist-ph].
D. Klinkenberg, C. Fraser, and H. Heesterbeek, The effectiveness of contact tracing in emerging epidemics, PloS
one 1 (2006).
J. Müller, M. Kretzschmar, and K. Dietz, Contact tracing
in stochastic and deterministic epidemic models, Mathematical biosciences 164, 39 (2000).
A. Okolie and J. Mller, Exact and approximate formulas for contact tracing on random trees, Mathematical
Biosciences 321, 108320 (2020).
A. J. Kucharski, T. W. Russell, C. Diamond, Y. Liu,
J. Edmunds, S. Funk, R. M. Eggo, F. Sun, M. Jit, J. D.
Munday, et al., Early dynamics of transmission and control of COVID-19: a mathematical modelling study, The
Lancet Infectious Diseases (2020).
There are also some higher estimates in the literature,
e.g. based on the early epidemic dynamics in Wuhan [?
]. Given the greatly increased state of awareness of the
disease at this point it seems reasonable to assume that
such higher values are not relevant to disease dynamics
today.
G. Grimmett and D. Welsh, Probability : An Introduction
(Oxford University Press, 2014).
To see this, first designate all nodes of this tree “empty”,
except for the root. Next, embed the branching processes
model in this tree in the natural way, with Patient Zero
at the root, and “occupy” nodes according to their probability of infection. The the probability of formation of
an infinite cluster of infections, ρ, is precisely the probability that occupied sites percolate on the Cayley tree,
which is usually taken as the order parameter in percolation theory [25].

[13]
[14]

[15]

[16]

[17]

[18]

[19]

[20]
[21]

7
[22] P. Grassberger, On the critical behavior of the general
epidemic process and dynamical percolation, Mathematical Biosciences 63, 157 (1983).
[23] J. L. Cardy, Field theoretic formulation of an epidemic
process with immunisation, Journal of Physics A: Mathematical and General 16, L709 (1983).
[24] J. L. Cardy and P. Grassberger, Epidemic models and
percolation, Journal of Physics A: Mathematical and
General 18, L267 (1985).
[25] G. Grimmett, Percolation (Springer Berlin Heidelberg,
1999).

[26] B. Drossel and F. Schwabl, Self-organized critical forestfire model, Phys. Rev. Lett. 69, 1629 (1992).
[27] B. Drossel and F. Schwabl, Forest-fire model with immune trees, Physica A: Statistical Mechanics and its Applications 199, 183 (1993).
[28] Telecom subscription data, Telecom Regulatory Authority of India (2020).
[29] J. O. Lloyd-Smith, S. J. Schreiber, P. E. Kopp, and W. M.
Getz, Superspreading and the effect of individual variation on disease emergence, Nature 438, 355 (2005).
[30] M. E. Fisher and J. W. Essam, Some cluster size and
percolation problems, Journal of Mathematical Physics
2, 609 (1961), https://doi.org/10.1063/1.1703745.

Appendix A: Critical behaviour along the line θ = 0

In this appendix, we derive the critical behaviour along the line θ = 0. Since all infections on this line are
symptomatic, we denote RS ≡ R. As we demonstrate below, the exact critical point can be obtained in closed form,
and is found to be
p
R − 1 + (R − 1)(R + 3)
, R ≥ 1,
(A1)
φc =
2R
which matches our numerical phase diagram to within the resolution of the plot; see Fig. 2 for an example with R = 2.
Let us now summarize some basic facts about the critical behaviour of percolation-type transitions. Recall [25]
that standard site percolation on the Bethe lattice exhibits five metric-independent critical exponents, which we may
denote {α, β, γ, δ, ∆}. The three scaling relations imply that only two of these are independent. There are three more
metric-dependent critical exponents, {ν, ρ, η}, which can be expressed in terms of the previous exponents using the
hyperscaling relations in six dimensions.
We will focus on the two independent exponents γ and β, since these are the easiest to calculate. They control
the critical behaviour of the mean cluster size Ep (|C|) and the percolation probability Pp (|C| = ∞) (probability of
formation of an infinite cluster) respectively. In terms of the site occupation probability p and its critical value pc ,
they are defined by
Ep (|C|) ∼

1
,
(pc − p)γ

β
p → p−
c , and Pp (|C| = ∞) ∼ (p − pc ) ,

p → p+
c .

(A2)

Site percolation on the Bethe lattice with z ≥ 3 lies in the universality class of mean-field percolation, and exhibits
critical exponents γ = β = 1 [25].

1.

Mean cluster size

To compute the mean cluster size, we follow a method introduced by Fisher and Essam for counting clusters of a
given size in the Bethe lattice [30]. We define a probability generating function for the cluster size
B(φ, x) =

∞
X

Pφ (|C| = s | initial node infected)xs , φ > φc ,

(A3)

s=1

where |C| denotes the cluster size and Pφ (|C| = s | initial node infected) denotes the probability of obtaining a cluster
of size s from an initial infected node. Since susceptible individuals are on the network (C) with probability φ and
off the network (N ) with probability (1 − φ), B(φ, x) can be expressed as
B(φ, x) = φBC (φ, x) + (1 − φ)BN (φ, x),

BC/N (φ, x) =

∞
X

Pφ (|C| = s | initial node infected and C/N )xs .

(A4)

s=1

Using Eq. (A4), the expression for the mean cluster size reads
Eφ (|C|) = ∂x B

x=1

= φ ∂ x BC

x=1

+ (1 − φ)∂x BN

x=1

.

(A5)

8
If a node of type C infects another node of type C, the latter cannot transmit infection further. However, a node of
type N can infect other nodes freely. This implies the recurrence relations
R

BC = x [φx + (1 − φ)BN ] ,

(A6)

R

R

BN = x [φBC + (1 − φ)BN ] = xB ,

(A7)

for the coefficients of each probability generating function. Differentiating at x = 1, and using the normalization
constraint BC/N (φ, x = 1) = 1, we obtain

∂x BC x=1 = 1 + R φ + (1 − φ) ∂x BN x=1

∂x BN x=1 = 1 + R φ ∂x BC x=1 + (1 − φ) ∂x BN x=1 .
(A8)
Solving these linear equations, we find that
∂x BC

x=1

∂x BN

x=1

R2 φ2 − R(R − 1)φ + 1
,
− R(R − 1)φ − (R − 1)
R2 φ2 + Rφ + 1
.
= 2 2
R φ − R(R − 1)φ − (R − 1)
=

(A9)

R 2 φ2

(A10)

Thus, using Eqs. (A10) and (A5), we obtain the mean cluster size:
Eφ (|C|) =

Rφ + 1
.
R2 φ2 − R(R − 1)φ − (R − 1)

Denoting the roots of the denominator by
φ± =

p

(R − 1)(R + 3)
,
2R

(A11)

Rφ + 1
.
R2 (φ − φ+ )(φ − φ− )

(A12)

R−1±

we may write
Eφ (|C|) =

Since 0 ≤ φ ≤ 1, it follows that the mean cluster size has a simple pole at φ = φ+ , and assumes a physical, positive
value only when φ > φ+ . Thus, the exact critical point lies at φc = φ+ . (The unphysical, negative value in Eq.
(A12) in the percolating regime φ < φc reflects the divergence of the mean cluster size due to the infinite cluster.
Meaningful results in the percolating regime can be recovered by conditioning on the event {|C| < ∞} [25], but we
will not pursue this here.)
In the vicinity of the critical point φc = φ+ , we obtain
Eφ (|C|) ∼

Rφc + 1
1
p
,
(φ
−
φc )
R (R − 1)(R + 3)

φ → φ+
c ,

(A13)

from which the critical exponent γ = 1 can be read off.
2.

Percolation probability

To derive β, we define the probabilities of infinite cluster formation from a source infection that is respectively on
or off the contact network:
ρC/N (φ) = Pφ (|C| = ∞| initial node infected and C/N ),

φ ≤ φc .

(A14)

We now derive recurrence relations to compute ρC and ρN . Since a C node can give rise to an infinite cluster only
through infecting an N node, we can obtain an expression for ρC in terms of ρN as follows. Note that (1 − (1 − φ)ρN )
is the probability that an infected N node does not lead to an infinite cluster, and hence (1 − (1 − φ)ρN )R is the
probability that none of the R infected nodes lead to infinite clusters. Thus, the probability that at least one of the
nodes infected by an initial C node leads to an infinite cluster is given by
R

ρC = 1 − (1 − (1 − φ)ρN ) .

(A15)

9
Similarly, noting that an N node can lead to an infinite cluster via either C or N nodes, the probability that at least
one of the infected nodes leads to an infinite cluster is given by
R

ρN = 1 − [1 − (1 − φ)ρN − φρC ] .

(A16)

Eqs. (A15) and (A16) reduce to a single equation for ρN :

R
ρN = 1 − 1 − φ − (1 − φ)ρN + φ[1 − (1 − φ)ρN ]R .

(A17)

Expanding to second order in ρN yields
(R(1 − φ)(1 + Rφ) − 1)ρN =



R(R − 1)
(1 − φ)2 R2 φ2 + 3Rφ + 1 ρ2N + O ρ3N .
2

(A18)

In terms of the roots defined in Eq. (A11), we have
R2 (φ+ − φ)(φ − φ− )ρN =



R(R − 1)
(1 − φ)2 R2 φ2 + 3Rφ + 1 ρ2N + O ρ2N .
2

(A19)

Note that in Eq. (A19), since ρN ≥ 0, the only physical solution for φ ≥ φ+ is ρN = 0, whereas ρN > 0 if φ < φ+ .
Hence we recover the result φc = φ+ . It further follows that
1=

R−1
R2 φ2 + 3Rφ + 1
(1 − φ)2
ρN [1 + O (ρN ) + . . .] .
2R
(φc − φ)(φ − φ− )

(A20)

Taking limits as φ → φ−
c yields
lim−

φ→φc

R2 φ2 + 3Rφ + 1
R−1
(1 − φ)2
ρN = 1,
2R
(φc − φ)(φ − φ− )

(A21)

which implies
ρN
2
lim
=
(φ
−
φ)
R
φ→φ−
c
c

r

1
1
R+3
,
R + 1 (R + 2)φc + 1 (1 − φc )2

(A22)

and consequently that
ρN

2
∼
R

r

1
1
R+3
(φc − φ),
R + 1 (R + 2)φc + 1 (1 − φc )2

φ → φ−
c ,

(A23)

which suggests a critical exponent β = 1. To confirm this exponent, we define the probability of formation of an
infinite cluster from a single infected site, ρ = φρC + (1 − φ)ρN . Since ρN is small in the vicinity of φc , we can linearize
Eq. (A15),
ρC = R(1 − φ)ρN + O(ρ2N ),

(A24)

to obtain
2
ρ(φ) ∼
R

r

R + 3 Rφc + 1
1
(φc − φ),
R + 1 (R + 2)φc + 1 (1 − φc )

φ → φ−
c ,

(A25)

from which the critical exponent β = 1 is immediate.

Appendix B: Exact critical line for digital herd immunity

Here, we derive the exact critical line for digital herd immunity using two complementary approaches. In App. B 1,
we obtain recurrence relations for the full probability generating function for the size of infected clusters, which allows
us to identify when the mean size of an infected cluster diverges. In App. B 2, we study the processes involved in the
cluster growth and determine when the percolation probability of the infected cluster approaches zero.

10
1.

Mean cluster size approach

First, it is useful to define one probability generating function per type of initial node:
Bα (φ, θ, x) =

∞
X

Pφ,θ (|C| = s| initial node infected and type α)xs ,

(B1)

s=1

where α ∈ {CA, CS, N A, N S}. The probability generating function for cluster sizes, given any type of infected initial
node, is then
B(φ, θ, x) =

∞
X

Pφ,θ (|C| = s| initial node infected)xs

s=1

≡

X

pα (φ, θ)Bα (φ, θ, x).

(B2)

α∈{CA,CS,N A,N S}

We shall find the exact critical line for n-step contact tracing by determining when the mean size of an infected cluster,
Eφ,θ (|C|) = ∂x B(φ, θ, x) x=1 , diverges.
We first obtain exact recurrence relations for the generating functions Bα by enumerating possibilities at a given
node. When the initial infected node is off the contact network, i.e. of type N A or N S, we obtain
BN A = xB R0 , BN S = xB RS ,

(B3)

since nodes off the network can infect any other type of node (cf. Eq. (A7)).
When the initial infected node is of type CS, any infections in the next generation that are on the network will be
detected (cf. Eq. (A6)), and we obtain
RS
BCS = x(pN A BN A + pN S BN S + (pCA + pCS )x)RS ≡ xBD
,

(B4)

BD ≡ BN + pC x, BN ≡ pN A BN A + pN S BN S , pC ≡ pCA + pCS .

(B5)

where it is useful to define

The analogous result for BCA is rather more involved. The essential difficulty is that for n-step contact tracing,
the recurrence relation for BCA involves n generations beyond the initial node, rather than just one. This is because
the possibility arises of multi-generational clusters of CA nodes, that escape detection until they infect a CS node at
some later generation 1 < m ≤ n. (Put differently, the underlying branching process is not Markovian.) The simplest
way to proceed is to study all the configurations of clusters originating from an initial infected node of type CA, and
organize the sum according to the generation in which the CA cluster connected to the initial CA node is detected,
schematically


n
X
BCA = x {no detection, gens. j ≤ n} +
{first detection in gen. j} .
(B6)
j=1

We first define a function and its composition to recursively “propagate” the generating function from one generation
to the next, after the addition of a CA node:


j=0
y
R0
(j)
(B7)
f (x, y) = (BN + pCA xy) , f (x, y) = f (x, f (x, . . . f (x, y) . . .)) j ≥ 1 .

{z
}
|
j times

The generating function for the processes without detection in generations j ≤ n reads
{no detection, gens. j ≤ n} = f (n−1) (x, g (1) ), g (1) = (BN + pCA BCA )R0

(B8)

where g (1) is the generating function for all processes that do not lead to a CS node in one generation of disease
spread. Similarly the generating function for all processes that end in detection in generation j, reads
{first detection in gen. j} = (f (j) (x, g (2) ) − f (j) (x, g (3) )),
R0 R0
R0 R0
g (2) = (BN + pCS BCS + pCA xBD
) , g (3) = (BN + pCA xBD
) ,

(B9)

11
where g (2) (resp. g (3) ) are generating functions for all processes that lead to (resp. do not lead to) creation of a
CS node in generation j, and the subtraction ensures that only processes that give rise to at least one CS node in
generation j are included. Using Eqs. (B6), (B8), and (B9), we find that


n−1
X
BCA = x f (n−1) (x, g (1) ) +
(f (j) (x, g (2) ) − f (j) (x, g (3) )) .
(B10)
j=0

It can be verified that BCA is correctly normalized, i.e. that BCA x=1 = 1. To compute the mean cluster size, we
first compute derivatives of the generating functions Bα . Noting that Bα x=1 = 1 and using Eqs. (A7) and (B4), we
obtain
∂x BN A
∂x BCS

x=1

= 1 + R0 ∂x B

x=1

= 1 + RS ∂x BD

Eliminating all variables other than ∂x B

x=1

x=1

x=1

, ∂ x BN S

x=1

= 1 + RS ∂x B

= 1 + RS (pC + pN A ∂x BN A

x=1

,

+ pN S ∂x BN S

x=1

x=1

).

(B11)

, we can write the derivative of BCA in the form

∂x BCA

x=1

= En + Fn ∂x B

x=1

,

(B12)

and in terms of these coefficients {En , Fn }, the mean cluster size reads
Eφ,θ (|C|) = ∂x B

x=1

=

1 − pCA + pCS RS + pCA En
,
1 − (Rn + pCS RS Rn + pCA Fn )

(B13)

where is is useful to define
Rn = pN A R0 + pN S RS ,

RC = pCA R0 + pCS RS .

(B14)

It is clear that the mean cluster size diverges when
Rn + pCS RS Rn + pCA Fn = 1.

(B15)

It remains to compute Fn , as defined in Eq. (B12). To this end, let us introduce functions
(i)

cj = ∂x f (j) (x, y)

(B16)

x=1,y=g (i) (1)

of φ and θ, with arguments other than x suppressed. By the chain rule, these satisfy the recurrence relations
(i)

cj+1 = ∂x f (x, f (j) (x, y))
= ∂x f (1, f

(j)

= R0 (∂x BN

x=1,y=g (i) (1)

(i)

(1, g (1))) + ∂y f (1, f (j) (1, g (i) (1)))∂x f (j) (1, g (i) (1)))
(i)

x=1

(i)

+ pCA aj )(pN + pCA aj )R0 −1 + R0 pCA (BN

(i)

x=1

(i)

+ pCA aj )R0 −1 cj ,

(i)

where we defined aj = f (j) (1, g (i) (1)). Since we are only concerned with the coefficient of ∂x B
let us write
recurrence

(i)
cj

=

(i)
dj

+

(i)
bj ∂x B x=1 ,

x=1

(B17)

in ∂x BCA

x=1

,

as in Eq. (B12). Upon making this substitution in Eq. (B17), we obtain the

(i)

(i)

(i)

bj+1 = R0 (pN + pCA aj )R0 −1 (Rn + pCA bj )

(B18)

(i)

for the terms bj of interest. Combining the above expressions, we find
(1)

Fn = bn−1 +

n−1
X

(2)

(3)

bj − bj



,

(B19)

j=0
(i)

where the bj are defined recursively for j > 0 via
(i)

(i)

(i)

bj+1 = R0 (pN + pCA aj )R0 −1 (Rn + pCA bj ),
(i)

(i)

aj+1 = (pN + pCA aj )R0 ,

(B20)

12
with
(1)

b0 = R0 (1 − pCS )R0 −1 (1 − pCS RS Rn ),
(2)

b0 = R0 Rn (1 + RC ),
(3)

b0 = R0 Rn (1 + pCA R0 )(1 − pCS )R0 −1 ,

(B21)

and
(1)

(3)

a0 = a0 = (1 − pCS )R0 ,

(2)

a0 = 1.

The exact critical line for n-step contact tracing is thus given by the implicit equation


n−1


X
(1)
(2)
(3)
Rn (φ, θ) = Rn + pCS RS Rn + pCA bn−1 +
bj − bj  = 1

(B22)

(B23)

j=0

for φ and θ.

2.

Percolation probability approach

We now outline a procedure to obtain the critical line using the percolation probability of an infected initial node.
The probability of formation of an infinite cluster is given by
ρ≡

X

pα ρα ,

(B24)

α∈{CA,CS,N A,N S}

where ρα is the probability of formation of an infinite cluster starting from a node of type α. Since nodes off the
network (N S and N A) can infect any type of node, we obtain the recurrence relations
ρN S = 1 − (1 − ρ)RS ,

ρN A = 1 − (1 − ρ)R0 .

(B25)

Further, since the CS node can only infect anyone outside the network, we obtain
ρCS = 1 − (1 − ρN )RS , ρN ≡ pN S ρN S + pN A ρN A .

(B26)

Similar to the case of the generating function in the previous section, obtaining the recurrence relation for ρCA is more
involved. We proceed by enumerating the minimum number of processes such that the expression for the formation
of an infinite cluster ρCA can be expressed in terms of the ρα ’s. For depth n contact tracing, this yields a term that
schematically reads
ρCA = {no detection, gens. j ≤ n} +

n
X

{first detection in gen. j}.

(B27)

j=1

To determine the critical line, it is sufficient to linearize the recurrence relations for {ρα } similar to the calculation in
App. A. We thus obtain
ρN S = RS ρ + O(ρ2 ), ρN A = R0 ρ + O(ρ2 ), ρCS = RS ρN + O(ρ2 ) = RS Rn ρ + O(ρ2 ),

(B28)

where Rn is defined in Eq. (B14). To count the different kind of processes that enter Eq. (B27), we divide all processes
of j generations into three types, which we denote as follows.
C (j) : {Processes with at least one CA in generation j}
E (j) : {Processes with no CA or CS in generation j}
T (j) : {Processes with at least one CS in generation j}.

(B29)

Note that processes in C (j) and E (j) lead to no detection in generation j and T (j) leads to a detection in generation

13
CA

CA

NS

CA

NS

CA

NA

CA

NS

NA

CA

CA

NA

NS

NS

CA

NA

a)

CA

CA

NS

NA

NA

NS

CS

NS

NA

CA

NS

b)

CA

NA

c)

FIG. 4. Examples of processes that appear in the recursive expression for ρCA . Processes shown in (a), (b), and (c) belong to
the sets C (2) , E (2) , and T (2) respectively (see Eq. (B29)). ρCA can be expressed in terms of the probabilities of formation of
infinite clusters starting from the nodes on the edge of the processes.

j that activates the contact network. Examples of these processes for j = 2 are shown in Fig. 4. To linear order in p,
we find that the terms in ρCA in Eq. (B27) can be expressed as

{no detection, gens. j ≤ n} =

{first detection in gen. j} =



n X
X
X
X
1  X
Pτ
nα (τ )ρα +
Pτ
nα (τ )ρα  + O(ρ2 )

pCA
α
j=1 τ ∈E (j)
τ ∈C (n)


X
1  X
(D)
Pτ nCA (τ )ρCA +

pCA

τ ∈T (j)

α


nα (τ )ρα  + O(ρ2 ),

(B30)

α∈{CS,N S,N A}

where τ runs over all the processes in the sets described in Eq. (B29), α is summed over all types of nodes unless other
(D)
wise stated, and we have defined nα (τ ), Pτ , and ρCA as follows. nα (τ ) denotes the number of nodes of the type α on
the edge of a process τ . Pτ is the probability of having a process τ , i.e. the product of the individual probabilities
{pα } of all the nodes in the process including the root CA node, and in Eq. (B30) we divide by a factor of pCA in
(D)
order to determine the probabilities of the processes given that the root is of type CA. ρCA is the probability of
formation of an infinite cluster due a CA that has been detected due to a CS node in the same generation, which
reads
(D)

ρCA = 1 − (1 − ρN )R0 = R0 ρN + O(ρ2 ) = R0 Rn ρ + O(ρ2 ),

(B31)

where we have used Eq. (B28).
To evaluate the terms in Eq. (B30), we define generating functions corresponding to each of the processes in
Eq. (B29) as

C (j) ({zα }) ≡

X
τ ∈C (j)

Pτ

Y
zαnα (τ ) ,
α

E (j) ({zα }) ≡

X
τ ∈E (j)

Pτ

Y
zαnα (τ ) ,
α

T (j) ({zα }) ≡

X
τ ∈T

(j)

Pτ

Y
zαnα (τ ) .
α

(B32)

14
These generating functions can be enumerated recursively as

R0 
R0 
n−1
n−1
X
X


C (n) = pCA C (n−1) +
E (j)  − 
E (j)  
j=0



R0

n−1
X


E (n) = pCA 

E (j) 

R0 

E (j)  



n−2
X

−

j=0

j=0

T (n)

j=0


R0 
R0 
n−1
n−1
X
X


= pCA C (n−1) + T (n−1) +
E (j)  − C (n−1) +
E (j)  
j=0

(B33)

j=0

with
C (0) = pCA zCA , E (0) = pN S zN S + pN A zN A , T (0) = pCS zCS .

(B34)

In terms of these generating functions, Eq. (B30) reads
{no detection, gens. j ≤ n} =

{first detection in gen. j} =



n
X
X
1
ρα ∂zα C (n) +
E (j) 

pCA α

1  (D)
ρCA ∂zCA T (j) +

pCA

{zα =1}

+ O(ρ2 )

j=1


X

ρα ∂zα T (j) 

{zα =1}

+ O(ρ2 ).

(B35)

α∈{CS,N S,N A}

Using Eqs. (B24), (B28), (B31), and (B35), we finally obtain an expression for ρ of the form
ρ = Rn (φ, θ)ρ + O(ρ2 ),

(B36)

Rn (φc , θc ) = 1.

(B37)

using which we identify the critical line to be

While we are not able to derive a more explicit expression for Rn (φ, θ) using this approach, we have verified using
Mathematica that it yields the same critical line of Eq. (B23) for several values of n. That is, we find that


n−1

X  (2)
(1)
(3)
Rn (φ, θ) = Rn + pCS RS Rn + pCA bn−1 +
bj − bj  .
(B38)
j=0

3.

Critical exponents

Following the derivation of critical exponents in App. A, it is clear that for any finite n, the critical exponents β and
γ are controlled by the behaviour of the function near the critical line Rn (θ, φ) = 1. Unfortunately, it does not seem
possible to obtain Rn (φ, θ) in closed form. However, since Rn (φ, θ) is analytic for any finite n, the critical behaviour
on the transition line is expected to be determined by the leading terms in its Taylor expansion, which are linear in φ
for given θ and vice versa. Numerically, we find that this is indeed the case; see Fig. 5. The numerical data suggests
that γ = β = 1 everywhere except on the line φ = 1, whose critical behaviour is discussed below.

Appendix C: Critical behaviour along the line φ = 1

Here, we study the critical behaviour along the line φ = 1. In the limit of infinite tracing depth, we find that there
is a discontinuous phase transition at θc = 1. However, for any finite contact-tracing depth n, the critical point θc < 1,
and the transition shows the same critical exponents as mean-field percolation.

15
= 0.25
= 0.5
= 0.75
= 0.9

1.4

1.2
rn ( , )

rn ( , )

1.2

1.4

1.0

1.0

0.8

0.8

0.6

0.6

0.0

0.2

0.4

0.6

0.8

= 0.25
= 0.5
= 0.75
= 0.9

0.5

1.0

0.6

0.7

0.8

0.9

1.0

FIG. 5. Behaviour of Rn (φ, θ) near the critical line Rn (φ, θ) = 1 for various fixed φ and continuously varying θ, and vice versa.
It is clear that Rn (φ, θ) behaves linearly in θ and φ near the critical line Rn = 1. Results are shown for a contact-tracing depth
n = 100 and parameter values R0 = 3, RS = 1; the summation was checked to be well-converged already for n = 10.

1.

Infinite tracing depth

When the tracing depth is infinite, there is a discontinuous transition as θ → 1− , in the sense that the “order
parameter”, i.e. the probability ρ(θ) of formation of an infinite infected cluster, jumps discontinuously from 0 to 1 at
θc = 1. To see this, note that when φ = 1, the evolution of an asymptomatic cluster from an asymptomatic source is
described by the following branching process
X0A = 1,
A
Xn+1

A
X1A = Z0,1
,
h
i
A
A
A
= Zn,1
+ Zn,2
+ . . . + Zn,X
A 1X A =Rn ,
n
0
n

(C1)

where XnA denotes the total number of new asymptomatic infections in generation n, the indicator functions
reflect the fact that a single symptomatic case will terminate the branching process, and
A
Zi,j
∼ Bin(R0 , θ)

i.i.d.

1XnA =R0n
(C2)

The probability generating function of XnA then satisfies the recurrence relation
A

Fn+1 (y) = E[y Xn+1 ]
h
i
A
= E E[y Xn+1 |XnA ]
=1−

P(XnA

=

R0n )

+

P(XnA

=

R0n )E

 P n

R0
A
Zn,j
j=1
y
n

= 1 − P(XnA = R0n ) + P(XnA = R0n )f (y)R0 ,

(C3)

where f (y) is the probability generating function for the descendants of a single asymptomatic node,
f (y) = (θy + (1 − θ))R0 .

(C4)

Using these results, it can be shown by induction that
2

n−1

Fn (y) = 1 − θR0 +R0 +...+R0

2

n−1

+ θR0 +R0 +...+R0

n−1

f (y)R0

.

(C5)

(1 − θ)R0 .

(C6)

The probability that the branching process is extinct in generation n is then
2

n−1

Fn (0) = 1 − θR0 +R0 +...+R0

2

n−1

+ θR0 +R0 +...+R0

n

The extinction probability is thus
(
q = lim Fn (0) =
n→∞

1
0

θ<1
.
θ=1

(C7)

16
It follows that the critical point occurs at θ = θc = 1, and that the probability of formation of an infinite cluster,
which is usually regarded as the order parameter for percolation transitions, behaves like
(
0 θ<1
ρ=1−q =
.
(C8)
1 θ=1
Such discontinuous behaviour of the order parameter indicates that the transition has a first-order character. For
example, at θ = 1 all asymptomatic clusters are infinite and the critical exponent δ is not even defined. However,
several other critical exponents are defined, a scenario reminiscent of one-dimensional site percolation, which also has
a critical probability pc = 1 and a mixture of continuous and discontinuous behaviour as p → p−
c .
2.

Finite tracing depth

For any finite tracing depth n, the exact critical point along the line φ = 1 is found to lie at
1


1 R0 +R02 +...+R0n
θc (n, R0 ) =
,
R0n

(C9)

with mean-field critical exponents, γ = β = 1. While this can be obtained from the results of App. B, we provide an
intuitive explanation here. When φ = 1, all nodes are on the contact network, and hence only two types need to be
considered: symptomatic (S) and asymptomatic (A), which occur with probabilities (1 − θ) and θ respectively. Since
any infinite cluster must consist entirely of A nodes, we can directly obtain the recurrence relation for the probability
ρ of formation of an infinite cluster. For contact tracing with recursive depth n, the only event that does not rule
out the existence of an infinite cluster is the formation of an n-generation tree in which every node is asymptomatic.
This occurs with probability θNn , where
Nn = R0 + R02 + · · · + R0n ,

(C10)

where Nn is the total number of nodes in such a tree excluding the root node.
Given such a tree, infinite clusters can originate from any of the R0n asymptomatic leaves in generation n. This
yields the following recurrence relation for ρ:


n
ρ = θNn 1 − (1 − ρ)R0 .
(C11)
Expanding Eq. (C11) to second order in ρ, it is straightforward to derive Eq. (C9) and that
ρ∼

2Nn
(θ − θc ).
(R0n − 1)θc

(C12)

Thus, β = 1 for any finite n. A similar argument yields the mean cluster size
Eθ (|C|) ∝

1
,
1 − R0n θNn

θ < θc ,

(C13)

which has the same critical point as the percolation probability, and yields a critical exponent γ = 1, since
Eθ (|C|) ∼

1
,
(θc − θ)

θ → θc− .

(C14)

Appendix D: Mean-field-like estimate for the critical line

In this section, we derive a simple, approximate formula for R = R∞ (φ, θ), based on linear interpolation and a
“mean-field” assumption, whereby inter-generational correlations are neglected. It is first helpful to label the possible
types of infected individual by α ∈ {CA, CS, N A, N S}, and note that susceptible individuals of each type occur with
the independent probabilities given in Table D1:
Type α
pα
CA
φθ
CS
φ(1 − θ)
NA
(1 − φ)θ
NS (1 − φ)(1 − θ)

(D1)

17
Now suppose that there are no correlations between generations. Then the effective reproduction number is simply
an average over the possible types of node:
X
R=
pα Rα .
(D2)
α∈{CA,CS,N A,N S}

Here, the probabilities pα are given as in Table D1, while RN A = R0 , RN S = RS , and RCS = RS (1−φ), corresponding
to the average number of live nodes generated by a symptomatic individual on the contact network. However, RCA is
essentially undetermined in this approach, since discarding correlations in time also discards contact tracing, to which
the effective value of RCA is highly sensitive. We will therefore treat RCA as a variational parameter, to be estimated
self-consistently. In the “best” case, asymptomatic transmission within the network is completely suppressed, and
RCA = (1 − φ)R0 . In the “worst” case, asymptomatic transmission within the network is not suppressed at all, and
RCA = R0 . A simple way to proceed is to solve for the unique linear interpolation between these cases that passes
through the known endpoint (φ, θ) = (1, 1) of the non-perturbative critical line (see Appendix C). The resulting
approximation to R is given by
 


1
2
R ≈ RS (1 − θ)(1 − φ ) + R0 θ 1 − 1 −
φ2 .
(D3)
R0

