An Optimal Predictive Control Strategy for COVID-19
(SARS-CoV-2) Social Distancing Policies in Brazil

arXiv:2005.10797v1 [q-bio.PE] 21 May 2020

Marcelo M. Moratoa , Saulo B. Bastosb , Daniel O. Cajueirob,c,d , Julio E.
Normey-Ricoa
a Renewable

Energy Research Group ( GPER), Departamento de Automação e Sistemas
( DAS),
Universidade Federal de Santa Catarina, Florianópolis, Brazil.
b Departamento de Economia, FACE, Universidade de Brası́lia (UnB), Campus
Universitário Darcy Ribeiro, 70910-900, Brası́lia, Brazil.
c Nacional Institute of Science and Technology for Complex Systems (INCT-SC).
d LAMFO, FACE - Universidade de Brası́lia (UnB), Campus Universitário Darcy Ribeiro,
70910-900, Brası́lia, Brazil.

Abstract
The global COVID-19 pandemic (SARS-CoV-2 virus) is the defining health crisis of our century. Due to the absence of vaccines and drugs that can help to fight
it, the world solution to control the spread has been to consider public social
distance measures that avoids the saturation of the health system. In this context, we investigate a Model Predictive Control (MPC) framework to determine
the time and duration of social distancing policies. We use Brazilian data in the
period from March to May of 2020. The available data regarding the number
of infected individuals and deaths suffers from sub-notification due to the absence of mass tests and the relevant presence of the asymptomatic individuals.
We estimate variations of the SIR model using an uncertainty-weighted LeastSquares criterion that considers both nominal and inconsistent-data conditions.
Moreover, we add to our versions of the SIR model an additional dynamic state
variable to mimic the response of the population to the social distancing policies
determined by the government that affects the speed of COVID-19 transmission.
Our control framework is within a mixed-logical formalism, since the decision
variable is forcefully binary (the existence or the absence of social distance policy). A dwell-time constraint is included to avoid harsh shifting between these
two states. Finally, we present simulation results to illustrate how such optimal
control policy would operate. These results point out that no social distancing
should be relaxed before mid August 2020. If relaxations are necessary, they
should not be performed before the beginning this date and should be in small
periods, no longer than 25 days. This paradigm would proceed roughly until January/2021. The second peak of infections, which has a forecast to the
beginning of October, can be reduced if the periods of no-isolation days are

Email address: marcelomnzm@gmail.com (Marcelo M. Morato)

Preprint submitted to Annual Reviews in Control

May 22, 2020

shortened.
Keywords: COVID-19, Model Predictive Control, On-Off Control, Social
Distancing, Brazil.

1. Introduction
The COVID-19 pandemic seems to be the global health crisis of our time.
Scientist first identified this virus (SARS-CoV-2) in humans in Wuhan, in the
province of Hubei, China by December 2019. It causes severe acute respiratory
syndrome which can become potentially fatal. The WHO estimated by the
end of March that the number confirmed cases was reaching the order 70000,
with more than 33000 confirmed deaths. Now, by the end of April, it has
already spread to almost every country of the world, infecting 3,019,246 and
killing more than 208,112 people World Heath Organization (2020). Its spread
is rapid and efficient and it seems that to tackle this pandemic, global scientific
efforts are necessary Bedford et al. (2019). Since vaccines have not yet been
developed, most countries have adopted measures to ensure social distancing,
aiming to avoid the spread Adam (2020). It seems that the COVID-19 has posed
an unique question regarding what are the viable public policies necessary to
handle its spread.
The idea behind social distance is to prevent health systems from becoming
saturated due to large amounts of COVID-19 patients being treated at the same
time. Therefore, with social distancing policies, the health systems do not have
to deal with hospital bed shortages associated with a large peak of infections,
since the demands for treatment become distributed over time. Figure 1 illustrates the evolution of symptomatic individuals due to the SARS-CoV-2 virus
with respect to no isolation and hard social isolation policies. The threshold
represents an estimate for the number of available Intense Care Unit (ICU)
hospital beds.
106

Number of Infected Individuals

2.5

Symptomatic Individuals
Threshold
No Social Isolation
Hard Social Isolation

Peak
2

1.5

1

0.5

0

Reduced Peak

0

50

100

150

200

250

300

350

Time (days)

Figure 1: Necessity of Social Isolation

However, social distancing measures exhibit at least three ambiguous sideeffects, which policy makers should take into account:

2

1. If the governments interrupt the social distancing policy before the correct
time, the measure is only able to shift the pattern of contamination to the
future, which does not help diminishing the problem of saturating the
health system due to excessive demand for ICU beds. This topic has been
throughly discussed by Hellewell et al. (2020);
2. Countries that implement rigid social distancing measures have seen devastating economic effects. The recent papers by Eichenbaum et al. (2020);
Gormsen & Koijen (2020) elaborate on this issue;
3. A large part of the population may not be immunized and might suffer
from future waves of COVID-19 infections, after the social distancing measures take place. Furthermore, recurrent wintertime outbreaks of SARSCoV-2 virus will probably occur after this initial pandemic dissemination
Kissler et al. (2020).
Therefore, it becomes of fundamental importance to predict the correct time
and the duration of social distancing interventions. Well-designed social distance
policies may help to control the evolution of the disease, to avoid the saturation
of the heath systems and to minimize the economic side effects caused by them.
In this paper, the Brazilian context is taken into account Werneck & Carvalho (2020). Brazil is a continent-sized tropical1 country and it has already
been facing many issues due to the COVID-19 pandemic. The country has 26
federated states, which have been choosing different social distancing measures
since mid-March2 . The federal government is reluctant to implement nationwide policies, disclaiming that the negative economic effects are too steep and
that social distancing is an erroneous choice The Lancet (2020); the government suggests that the economy cannot stop and that herd immunity could be
a solution to this pandemic. The expected impacts of the disease in Brazil are
catastrophic Ismael et al.; Rocha Filho et al. (2020). Moreover, due to lack of
testing, Brazil is only accounting for patients with severe symptoms or those how
have died; therefore, a huge percentage of sub-notification (over 90 %) has been
reported Silva et al. (2020); Rocha Filho et al. (2020); Delatorre et al. (2020).
The daily reports (”measurements”) delivered by the Ministry of Health, collecting number of infected and deceased patients, only gives an impression of
the virus spread of past moment, since, in average, a person will exhibit acute
symptoms only 20 days of the infection.
The first death due to the SARS-CoV-2 virus in Brazil was registered in
March 17, while the first case was officially notified in February 26. Nonetheless,
recent papers Delatorre et al. (2020); Rodriguez-Morales et al. (2020) point out
that the virus was already present in Brazil since the end of January, before
the Carnival festivals. Through inferential statistics, Delatorre et al. (2020)
1 Recent research point out that high temperatures may favor the spread of this virus; see
the work by Auler et al. (2020).
2 Throughout this paper, the Year/Month/Day notation is used.

3

acknowledge that community transmission has been ongoing in the state of
São Paulo since the beginning of February (over one month before the official
reports).
Even though a strong public health system is available in Brazil, as of April
30, many states were already exhibiting a near-collapse situation, with over 95 %
of ICU beds occupied with COVID-19 patients. This is illustrated in Figure 2,
which show the ICU occupancy rate and the number of available in many states
Brazilian Federal Medicine Council (2020). Clearly, the situation is already
border-lining.

Figure 2: ICU Beds and occupancy rate in Brazil, per state (20/04/30).

Motivated by the previous discussion, in this paper we investigate the problem of controlling the evolution of the COVID-19 pandemic in Brazil using optimal social distancing policies, which are designed through a Model Predictive
Control (MPC) framework.
The MPC framework is a widespread optimal control method for the control
of processes subject to constraints Camacho & Bordons (2013). MPC allows
to explicitly consider the effect of input, output and state constraints in the
control design procedure, which is rather convenient. As any standard discrete
control method Skogestad & Postlethwaite (2007), MPC-formulated laws stand
for piece-wise-constant signals for sampled-data systems, which is clearly the
scope of the COVID-19 dissemination process, since it is measured daily through
the number of infected and deceased individuals.
The frameworks to predict and control the complex dynamics of the SARSCoV-2 virus spread are definitely mixed discrete-continuous problems under
multiple objectives due to the nature of the problem (daily measurements and
piece-wise constant control). MPC certainly fits this context.
4

We must remark that many research papers have demonstrated the application and validation of this control tool for health-related, biological and ecological regulation purposes Ionescu et al. (2008); Zurakowski et al. (2004); MoscosoVásquez et al. (2016); de Ávila-Simas et al. (2019). Thus, MPC fits naturally to
COVID-19 social distancing control problem. Any possible COVID-19 control
framework should take into account social distancing constraints and goal of
minimizing the peak of infected individual, which is viable through the MPC
paradigm. The main contributions of this paper are the following:
• We present two modified versions of the Susceptible-Infected-Recovered
(SIR) model Kermack & McKendrick (1927), embedding the effects of
social distancing measures in the evolution of the disease;
• We propose an additional dynamic state variable, which models the response of the population to social distancing measures enforced by the
government. We also use this state variable to forecast the reduction of
the speed of transmission of the virus, with respect to enacted distancing
policy;
• Due to the fact that large error margins have been reported regarding
the available COVID-19 data and statistics in Brazil (see Bhatia et al.
(2020)), we perform an uncertainty-weighted Least-Squares criterion to
estimate the parameters of the virus infection/spread model, considering
both nominal and inconsistent-data conditions.
• Based on these uncertain models, we propose an MPC-based control framework to determine in real time whether to apply or not the social distancing policy. This control strategy resides in the solution of a Mixed-Integer
Dynamic Programming Problem, at each sampling instant (day), according to new available datasets (number of infected and deaths). The constraints of the MPC procedure are given with respect to the number of
available ICU hospital beds in the country. The MPC also accounts for
a minimal dwell-time on each control action (no isolation, complete lockdown), so that frequent social distancing policy shifting does not happen.
Note that, for the sake of practical purposes, we estimate model parameters
and distancing policies using real data from the Brazilian Ministry of Health,
in a fashion similar to the estimation scheme presented by Bastos & Cajueiro
(2020).
Our paper relates to some other recent papers that investigate the COVID19 pandemic from a control viewpoint. There are some recent works that have
also inserted a control variable in the available epidemiological model in order to
emulate the control of infections using strategies such as vaccination, isolation,
culling and self-isolation Bolzoni et al. (2017); Piunovskiy et al. (2020); Piguillem
et al. (2020). In particular, we state that the recent paper Piguillem et al. (2020)
has also addressed the issue of optimal social distancing COVID-19 policies.
A case study regarding Belgium has been presented in Alleman et al. (2020),

5

considering a continuous MPC policy; a robust MPC method, regarding the
COVID-19 spread in Germany, has been investigated by Köhler et al. (2020).
We must stress that this paper differs from Piguillem et al. (2020); Alleman
et al. (2020) and Köhler et al. (2020) in three main points:
(i) We consider the possibility of large amounts of uncertainty regarding the
infected/deaths measurements (which stands true for the Brazilian case,
which is ours). The previous papers considered relatively small parametric
uncertainties added to the model (identified with real data). In our case,
we consider large amounts of uncertainty and use uncertainty-embedded
models derived through a series of identification runs.
(ii) As in Alleman et al. (2020); Köhler et al. (2020), we design and synthetize
an optimal control strategy with a Model Predictive Control formalism,
that holds recursive feasibility and stabilization properties and has wide
industrial practice. Anyhow, the MPC design in this paper follows a
mixed-integer approach and embeds a dwell-time constraint, which had
not been tested in the previous paper. Furthermore, the chosen control
input differs: in Alleman et al. (2020), the control input is the actual isolation parameter, while in Köhler et al. (2020) it directly affects the infection
and transmission rates. In this paper, the control input stands for a new
model variable which indicates the government enacted social distancing
policy, which affects the average isolation observed in the population, that
then meddles with the transmission and infection dynamics.
(iii) We model the response of the population to these social isolation rules
with an additional dynamic variable (and fit our variations of the SIR
models accordingly).
(iv) The considered dwell-time constraint ensures that the social distancing
policy remains constant for at least Nm days, avoiding frequent shifting
between isolation and non-isolation states (which obviously would cause
ambiguity and confusion to the population).
This work is organized as follows: In Section 2, we introduce the SIR models
used in this work and the modifications we make in order to model people’s
response to the social distancing policies. In Section 3, we present the approach
used to estimate the parameters of the models; therein, we also present the
model-data fitting results. Section 4 presents the optimal control scheme used
to harness the evolution of the disease along time. Finally, Section 5 presents
the main conclusions of the work.
2. Epidemiological models
Recent literature Peng et al. (2020); Kucharski et al. (2020) shows that
the infection rate and evolution dynamics of the SARS-CoV-2 virus can be
adequately described by Susceptible-Infected-Recovered (SIR) models, which
were originally presented by Kermack & McKendrick (1927).
6

In this Section, we present two modified versions of the SIR model that take
into account the effects of social distancing measures and embedded them to the
evolution dynamic of the disease. The new variables account for the dynamics
of the population response to such social distancing measures (enacted by local
governments).
2.1. Original SIR Model and Modifications Regarding COVID-19
The SIR describes the spread of a given disease with respect to a population
split into three non-intersecting classes, which stand for:
• Susceptible individuals (S), who are prone to contract the disease;
• Infected individuals (I), which currently have the disease;
• Recovered individuals (R), who have already recovered from the disease.
Due to the evolution of the spread of the disease, the size of each of these
classes change over time and the total population size N is the sum of these
three classes, as follows:
N (t) = S(t) + I(t) + R(t) .

(1)

In the SIR model, the parameter β stands for the average number of contacts
that are sufficient for transmission of the virus from one individual, per unit of
time t. Therefore, βI(t)/N (t) determines the average number of contacts that
are sufficient for transmission from infected individuals, per unit of time, to
one susceptible individual; and (βI(t)/N (t))S(t) determines the number of new
cases per unit of time due to the amount of S(t) susceptible individuals (they
are “available for infection”).
Furthermore, the parameter γ stands for the recovery rate, which is the rate
that each infected individual recovers (or dies). This parameter characterizes
the amount of individuals that “leaves” the infected class, considering a constant
probability quota per unit of time.
Based on these definitions, the SIR dynamics are:
dS
(t)
dt
dI
(t)
dt
dR
(t)
dt

βI(t)S(t)
N (t)
βI(t)S(t)
− γI(t)
N (t)

= −
=

[SIR].

(2)

= γI(t)

Since the SIR model is used herein to describe a short-term pandemic outbreak, we do not consider the effects of demographic variations. Despite recent
discussion regarding the possibilities of reinfectionDel Rio & Malani (2020), we
assume that the recovered individuals will not be reinfected (at least for simplicity purposes), i.e. an individual does not contract the disease twice. We will not
implement this first SIR model, it is only included for the sake of referencing.
7

Indeed, the model should also include the dynamic relationships that appear
due to the fraction of people that unfortunately die from the disease. Thus, we
include a parameter ρ, which stands for the probability of an individual form
the infected class I(t) dying from infection before recovering, as suggested in
Keeling & Rohani (2011). In this case, the following set of Equations arise:
βI(t)S(t)
dS
(t) = −
dt
N (t)
dI
βI(t)S(t)
ρ
βI(t)S(t) γI(t)
(t) =
− γI(t) −
γI(t) =
−
dt
N (t)
1−ρ
N (t)
1−ρ
dR
(t) = γI(t)
dt
ρ
dD
(t) =
γI(t)
dt
1−ρ

[SIRD],

(3)
ρ
where 1−ρ
γI(t) stands for the number of people from the population that die
due to the disease, per unity of time; and D(t) is the number of people that
die due to the disease. Note that, in this case, the number of individuals in the
population reduces due to the infection according to
dN
ρ
(t) = −
γI(t) .
dt
1−ρ
For the ease of reference, this adaptation of the SIR model is named hereafter
as the “SIRD” (Susceptible-Infected-Recovered-Dead) model.
Since, in the case of the SARS-CoV-2 virus, there is a relevant percentage
of the infected individuals that are asymptomatic, we split the class of infected
individuals into the classes of symptomatic and asymptomatic individuals, as
suggested in Robinson & Stilianakis (2013); Arino et al. (2008); Longini-Jr.
et al. (2004):
dS
(t)
dt
dIA (t)
dt
dIS
(t)
dt
dRA
(t)
dt
dRS
(t)
dt
dD
(t)
dt

= −(βA IA (t) + βS IS (t))
=

S(t)
N (t)

(1 − p)(βA IA (t) + βS IS (t))

S(t)
− (γA )IA (t)
N (t)

S(t)
= p(βA IA (t) + βS IS (t)) N
(t) −

γS IS (t)
1−ρ

[SIRASD],
= γA IA (t)
= γS IS (t)
=

ρ
γS IS (t)
1−ρ
(4)

8

where IA (RA ) is the number of asymptomatic infected (recovered) individuals,
IS (RS ) is the number of symptomatic infected (recovered) individuals and p
is the proportion of individuals who develop symptoms. For ease of reference,
this latter model is named hereafter as the “SIRASD” (Susceptible-InfectedRecovered-Asymptomatic-Symptomatic-Dead) model. The SIRASD model has
been widely used in the recent literature to describe the COVID-19 pandemics
Piguillem et al. (2020). Just like with SIRD model, the original condition that
N (t) is constant over time form the SIR model no longer holds. Therefore,
to evaluate the variation of the population size N (t) over time, one needs to
integrate
ρ
dN
(t) = −
γS IS (t) .
dt
1−ρ
2.2. The New Control-Embedded Models
In order to design and synthesize effective control strategies for social distancing (public) policies, to be oriented to the population by local governments,
these previous SIRD and SIRASD models must be adapted to include the dynamics and effects of social distancing.
Therefore, a new differential equation is proposed to the response of population to such social distancing rules. These new dynamic is appended to those
of S(t), I(t) and D(t), which also become affected by the amount of social
distancing at a present time.
We will denote ψ(t) as this varying parameter which account for the population response: ψ = 0 stands for the case of a complete lock-down (in a
hypothetical and unachievable sense that there would not be any more contact
between individuals in the population), while ψ = 1 stands for a no-isolation
state, where the population is behaving “as usual”, with regular activities as
before the pandemic. The differential equation which models the evolution of
ψ(t) is the following:
dψ
(t)
dt

=

αOff (1 − ψ(t)) (1 − u(t)) + αOn (Kψ (t)ψinf − ψ(t)) u(t)

[C].

(5)
where u(t) is a binary variable which determines the social isolation policy
regulated by the government (this signal will be later on determined by the
proposed optimal controller): for the cases when social isolation is determined,
an ”On” state is set, with u = 1; when the government does not enact an
isolation measure, an ”Off” state is set, with u = 0. Note that αOn and αOff are
settling-time parameters which relate to the average time the population takes
to respond to the enacted social isolation measures.
The dynamic equation above [C] accounts for these two ”On”/”Off” possibilities:
• “Off”) if the government determines no isolation is necessary, it follows
5
that u = 0 and dψ
dt (t) = αOff (1 − ψ(t)), meaning that roughly after αOff

9

days, ψ converges3 to 1;
• “On”) if the government determines that a hard isolation is needed, it
follows that u = 1 and dψ
dt (t) = αOn (Kψ (t)ψinf − ψ(t)), meaning that
5
roughly after αOn
days, ψ converges4 to Kψ ψinf , where ψinf stands for
the ”hardest” isolation observed in practice (which is usually > 0); Kψ is
a static gain. In practice, [C] includes a time-varying gain Kψ (t) which
holds the limit property limt→ α 5 Kψ (t) → Kψ . This term is included to
On
represent the relationship between the actual observed isolation ψ and the
”hardest” isolation ψinf .
Remark 1. Since [C] represents a first-order differential system, the settlingtime constants αOn and αOff determine the convergence speed of ψ(t). Notice
that, for an arbitrary system dx
dt (t) = αx (xf − x(t)), x(t) reaches 0.99xf in
5/αx units of time, since the solution for this differential equation is x(t) =
(1 − e−αx t ) xf , with αx > 0, for which x(5/αx ) = 0.99xf .
Since ψ(t) is the average people’s response to public policies to reduce the
spread of the virus (such as isolation measures or incentive to wear masks), it
affects the transmission factors and, thus, we replace β in the SIRD model by
ψ(t)β and βA and βS in the SIRASD model, respectively, by ψ(t)βA and ψ(t)βS .
It is worth mentioning that the population response to the On-Off isolation
policy control may depend on factors such as the incremental number of deaths
and the amount of information they known about the disease. Anyhow, since
this factor depends on people’s choices, and thus becomes rather difficult to
quantify, we opt for the simplicity of the previous differential equation [C], since
we may partially estimate its parameters with the available data.
Finally, we include these new dynamics into the SIRD and SIRASD models
as discussed. In this case, we get the following models that we denote SIRDC


dψ
(t)
 dt
dψ
limt→∞ dt (t)

3 Note

that limt→∞

4 Note

that


= αOff (1 − ψ(t)) → (ψ → 1).


= αOn (Kψ (t)ψinf − ψ(t)) → ψ → Kψ ψinf .

10

(Susceptible-Infected-Dead-with Control) model:
dS
(t)
dt
dI
(t)
dt
dR
(t)
dt
dD
(t)
dt
dψ
(t)
dt
Kψ (t)

ψ(t)βI(t)S(t)
N (t)
ψ(t)βI(t)S(t) γI(t)
−
N (t)
1−ρ

= −
=

= γI(t)
=

[SIRDC];

ρ
γI(t)
1−ρ

= αOff (1 − ψ(t)) (1 − u(t)) + αOn (Kψ (t)ψinf − ψ(t)) u(t)
ρ I(t)
.
= 1 − γK γ
1 − ρ N (t)

(6)
and SIRASDC (Susceptible-Infected-Asymptomatic-Symptomatic-Dead-with
Control):
dS
(t)
dt
dIA
(t)
dt
dIS
(t)
dt
dRA
(t)
dt
dRS
(t)
dt
dD
(t)
dt
dψ
(t)
dt
Kψ (t)

S(t)
N (t)

=

−ψ(t)(βA IA (t) + βS IS (t))

=

(1 − p)ψ(t)(βA IA (t) + βS IS (t))

=

S(t)
− (γA )IA (t)
N (t)
S(t)
γS IS (t)
pψ(t)(βA IA (t) + βS IS (t))
−
N (t)
1−ρ

=

γA IA (t)

=

γS IS (t)

=

ρ
γS IS (t)
1−ρ

[SIRASDC],

=
=

αOff (1 − ψ(t)) (1 − u(t)) + αOn (Kψ (t)ψinf − ψ(t)) u(t)
ρ IA (t)
1 − γK γA
1 − ρ N (t)
(7)

which will be used for identification and control purposes.
3. Tuning of the SIRDC / SIRASDC Models
In this Section, we present the results concerning the estimation of the epidemiological parameters of Eq. (7).
We must, at first, re-affirm that recent literature regarding the Brazilian
COVID-19 context has raised attention to the large amount of sub-notification
in the country Bhatia et al. (2020); The Lancet (2020); Silva et al. (2020);
Rocha Filho et al. (2020); Rodriguez-Morales et al. (2020). Therefore, we
progress by embedding the uncertainty regarding the available datasets to the
identification procedure.
11

The following identification is based the real data provided by the Ministry of
Health of Brazil from February 25, 2020 to May 8, 2020. Specifically, we consider
the cumulative number of infected individuals (Z(t) = I(t) + R(t) + D(t)) and
the number of deaths D(t).
To incorporate the issue of sub-notification, we assume that the data provided by the Ministry of Health is corrupted. Instead of using the original data,
we assume:

Z

Dnominal (t)
(t) − D(t)

nominal

= qD D(t) ,
= qI (Z(t) − D(t)) ,

(8)
(9)

where the instances of Z nominal (t) and Dnominal (t) represent the data provided
by Ministry of Health. The parameters qI ∈ [0, 1] and qD ∈ [0, 1] are uncertainty measures that provide a relationship between the nominal (observed)
data and the real (latent) variable. We estimate all parameters of our models
by minimizing the square-error between the integrated variables and their real
values, according to regular identification methodologies Bard (1974); Brauer
et al. (2019). We proceed by following an hierarchical procedure as done in
Bastos & Cajueiro (2020).
Our identification procedure also includes a limit5 to the parameter values,
as follows: β, βS , βA ∈ [1/20, 2], γ, γS , γA ∈ [1/14, 1/2], ρ, ρS ∈ [0.001, 0.2],
αOn ∈ [0, 1] and ψInf ∈ [0.3, 0.7]. These limits are in accordance with those
presented by Werneck & Carvalho (2020); Bastos & Cajueiro (2020).
3.1. Least Square Procedures
Firstly, we use the estimation of the infection, transmission and death probability, β, γ and ρ, respectively, of the SIRD model in Eq. (3). This is done
using the data without any enacted the social distancing policy, as observerd
in the country from February 25, 2020 to March 22, 2020; Bastos & Cajueiro
(2020) present a through discussion on this matter. The transmission rate parameter γ is then fixed for all the subsequent identification procedures, since
this parameter is characteristic of the disease. We refer to the β value of this
step as b1 .
Secondly, we assume that γK = 0 during this first period (no social distancing) and estimate the parameters of the SIRDC model from Eq. (6) by
minimizing the following square-error:

i2 h 
i2 
P h 
ˆ + R̂(t))
f
(Z(t)
−
D(t))
−
(
I(t)
+
f
D(t)
−
D̂(t)
,
minβ,ρ,αOn ,ψinf 21
t
(10)
where Zt and Dt represent the data provided by the Ministry of Health of Brazil
embedded with uncertainty, as gave Eqs. (8)-(9), and Iˆt , R̂ D̂t are estimated
parameter values using the SIRD model. Note that we use the nonlinear function
5 If

more restrictive bounds are used, we mention them explicitly.

12

f (z) = ln (1 + z) to correct the exponential characteristic of the series so that
the errors of the last values of the series do not dominate the minimization. We
assume that there are no recovered individuals at the beginning of the series,
and also that ψ0 = 1 (no-isolation state). We refer to the parameters values
(q ,q )
(q ,q )
(q ,q )
(q ,q )
of this step as β = b2 I D , ρ = r2 I D , αOn = a2 I D and ψInf = i2 I D .
We limit β in [(1 − δβ )b1 , (1 + δβ )b1 ], with δβ = 0.5. For the models with
(1,1)
(1,1)
uncertainty, αOn and ψInf are also limited in [(1 − δαOn )a2 , (1 + δαOn )a2 ]
(1,1)
(1,1)
and [(1 − δψInf )i2 , (1 + δψInf )i2 ], with δαOn = 0.9 and δψInf = 0.3, that is,
these values under uncertainty are limited by a range defined by the simulation
without uncertainty.
Thirdly, we estimate the complete SIRASD model. For such, we assume
that asymptomatic infected comprise all individuals without symptoms and also
those with mild symptoms (that do not need ICU beds), and that symptomatic
infected are individuals with moderate to severe symptoms. This line of thought
follows the orientation given by the Brazilian Ministry of Health, that incentives
people to only seek medical attention if symptoms are moderate or severe, and
to stay home otherwise. Therefore, we suppose that γS = γ and βS = β, which
corresponds to the simulation with uncertainty only upon the number of deaths
(i.e. qD 6= 1 and qI = 1). Since the uncertainty for the number of infected is
also related to the asymptomatic individuals, we use p = qI . We use this values
for the infection probability as constant, so that the initial condition for the
asymptomatic infected is IA,0 = IS,0 (1 − qI )/qI . In this context, we estimate
the parameters βA , γA , ρS , αOn and ψInf in order to minimize the following
square-error:

minβA ,γA ,ρ,αOn ,ψinf

1
2


i2 h 
i2 
P h 
ˆ
+
f
D
−
D̂
f
(Z
−
D
)
−
(
I
+
R̂
)
,
t
t
t
t
S,t
S,t
t
(11)

where IˆS,t and D̂t represent the values obtained with the SIRASD model.
3.2. Obtained Models
The previous identification procedure was realized for a large number of
possibilities of uncertainty (qD and qI ). Through the sequel, for simplicity, we
consider only three SIRASDC models:
• The ”Nominal” model, which is tuned for qD = qI = 1;
• The ”Uncertain 1” model, which is derived from the identification procedure considering 50 % more sub-notified deaths and 30 times more infected
individuals than reported (qD = 2/3 and qI = 1/30);
• And the ”Uncertain 2” model, which is likewise found through the identification procedure for 50 % more sub-notified deaths and 15 times more
infected individuals than reported (qD = 2/3 and qI = 1/15).
The respective model parameters, found through the identification procedure
detailed in Section 3, are presented in Table 1.
13

Table 1: Control Simulation: Considered Model Parameters.

Model
Nominal
Uncertain 1
Uncertain 2

βA
0.44
0.3690
0.4307

γA
0.1272
0.0952
0.1395

βS
0.4230
0.4307
0.3723

γS
0.0695
0.1395
0.0985

p
0.016
0.066
0.0322

ρ
0.049
0.1462
0.1461

3.3. Some results

200,000
Ministry of Health
Nominal
Uncertain 1
Uncertain 2

100,000

Deaths

Infected cases
(symptomatic)

0
60,000
40,000
20,000
0
20,000
10,000

20

20

-0
5

-0
6

-2
6
-0
4
20
20

20

20

-0
4

-0
6
20

-0
4

-2
7
-0
3
20
20

-1
6

0

20

Cumulative number
of infected cases
(symptomatic)

To conclude this Section, we show some short-term simulation results in
Figure 3. This Figure represents the SIRASDC model running with respect
to known data, from 20/03/27 until 20/05/08. The differences between the
speed of the COVID-19 spread considering nominal and uncertain conditions
are considerable.
This Figure depicts the differences between the models and also marks how
the nominal model perfectly fits the dataset from the Ministry of Healthy.
Clearly, the amount of sub-notification plays a significant role in the analysis
of this pandemic. If one does not take the uncertainty into account, wrong and
rash decisions may be performed. We must stress that an increase on the number
of infected individuals (larger sub-notification) means that the mortality rate
of the disease decreases, while it increases for a larger sub-notification margin
with respect to the number of deaths.

Figure 3: Short-term simulation for the SIRASD model: Nominal vs. Uncertain

14

4. The Predictive Control Strategy
In this Section, we develop the second main contribution of this work, i.e.
the optimal control strategy aiming to mitigate the impacts of the COVID-19
pandemic. In practice, the resulting control law which should be implemented
by the means of social distancing policies, conducted through orientation by the
local government.
For this goal, we consider the control-appended models (SIRDC and SIRASDC), which are now regulated under a closed-loop scheme. In fact, the
proposed control strategy is formulated with respect to SIRASDC model, as
explained in the sequel.
We must consider that the predictive control strategy is to be synthesized
based on a model that a priori encompasses the dataset mismatches (uncertainty
in terms of sub-notification). Taking into account a model that considered
that all measures (deaths, infections) are not exact can further improve the
outcome of the control policy, since it will be more conservative with respect
to social isolation measures. In some sense, this kinds of strategy is a robust
MPC feedback procedure, because it is based on a worst-case pandemic level.
The application of the MPC feedback without the uncertain realization of the
model can lead to performances which may borderline the use of the available
ICU beds in the country, i.e. the nominal prediction model may give a result in
terms of infections which is less than what is observed in practice. This situation
would lead to necessity of possibly longer periods of social isolation. Then, such
robust MPC procedure is able to avoid this kind of situation and it can be able
to significantly reduce the number of fatalities.
4.1. Control Objectives
As previously discussed, social isolation measures are necessary since they
are able to ”flatten” the COVID-19 spread curve. Figure 1 illustrates this issue,
which shows a simulation for the evolution of symptomatic individuals Is (t)
over time with no social isolation ψ(t) = 1 and hard social isolation (ψ = 0,
which represents a complete lock-down situation). Clearly, when social isolation
policies are implied (mathematically, for ψ < 1), the infection peak is postponed
and reduced.
Therefore, the control objectives regarding COVID-19 isolation policies are
the following:
• To reduce the peak of symptomatic individuals, as much as possible;
• To ensure that the peak is smaller than the number of available ICU beds
(a tolerance factor can be included);
• To determine isolation policies for as little time as possible (in order to
mitigate the effects of isolation on economy);
• And to avoid shifting between states (isolation or not), maintaining a
minimal period of Nm days in each condition.
15

These objectives can be mathematically expressed, respectively, as follows:
(a) By minimizing the amount of symptomatic individuals IS ;
(b) By ensuring that IS ≤ nICU (1 + ξ) for all t, where nICU represents the
amount of ICU beds and ξ ∈ (0 , 1) a tolerance factor (which should also
be minimized);
(c) By minimizing the isolation policy u(t), which should be 0 (no isolation)
for as long as possible;
(d) To ensure that u(t) is piece-wise constant and maintained at each state (0
or 1) for Np samples, where k = Tts stands for the sampling unit and Ts
the sampling period. We denote this as a dwell-time constraint on u.
4.2. Control Law
As remarked by Silveira & Pagano (2005), the implementation of any feedback control policy derived from u(t) to real biological system may light upon
two complicating issues:
1. Feedback control in the continuous time-domain t would require the measurement of the involved variables at every instant of time, which is obviously not possible. Anyhow, since the COVID-19 spread has ”slow” dynamics, discretized versions of the SIRDC / SIRASDC continuous models
can be used. Given that new measurements are available each day, the
discrete sampling is of Ts = 1day;
2. The control signal should, essentially, model the human action on the studied ecosystem. As previously argued, the human correspondence to the
isolation policies have already been included to the SIRDC and SIRASDC
models, through the dynamics of ψ(t).
Remark 2. The discretization method used in this paper is very usual: all
derivative functions dx
dt (t) are approximated by the deviance along on sam(x(k+1)−x(k))
pling period, this is: dx
. This is usually referred to as
dt (t) ≈
Ts
Euler/forward discretization Skogestad & Postlethwaite (2007).
Henceforth, this paper considers a piece-wise constant control signal u(t),
generated from periodic measurements, every Ts = 1 day. Considering control
increments denoted ∆u(k), it is implied that:
u(k)

=

u(k − 1) + ∆u(k) .

(12)

The actual control law that the controller applies to the system is u(t) =
u(kTs ) for the whole time during each sampling period interval, i.e. ∀t | kTs ≤
t ≤ (k + 1)Ts . This is clearly a piece-wise constant signal due to Eq. (12).
Apart from being piece-wise constant, the control law u must obey another
main restriction, in order to be implementable in practice: it must depart from
u(0) = 1, which is the last observed social distancing policy (the country is still
in an isolation condition). It must be noted that t = 0 stands for the instant
corresponding to the last sampled field data (infected, deaths dating 29 April).
16

4.3. The Optimal On-Off Control Framework
To design an optimal controller which determines the On-Off control policy
u(t) according to the previous discussion, we will follow the Model Predictive
Control formalism.
Sometimes named moving/sliding horizon control, the MPC concept is quite
straightforward for the optimal control of constrained system. The basic MPC
formulation resides in the solution of an optimization problem with respect to
a sequence of control actions Uk , at each discrete instant. This optimization
is written in terms of a process prediction model, performance goals and constraints, which are handled explicitly.
Therefore, we consider an well-posed quadratic function J which is minimized seeking to accomplish objectives (a) and (c) (reducing infections and
reducing the social isolation periods) presented in Section 4.1. This cost function is analytically expressed as:
 Np −1
Np
X
X
IS (k + j|k)T QI IS (k + j|k)
u(k + j|k)T Qu u(k + j|k)(13)
,
+
J =
max )2
(I
S
j=0
j=1
where Np is a given prediction horizon, and Qu and QI are weighting matrices.
The notation (k + j|k) stands for a model-based prediction for instant k + j
made at instant k. The constant ISmax stands for the maximal possible value
of IS , with respect to open-loop simulations (as in Figure 1); we include this
constant to ensure that the magnitude of the first and second term of J are the
same (i.e. normalization).
The vector of control efforts inside the prediction horizon Uk (to be optimized) is also presented:

T
u(k|k) u(k + 1|k) . . . u(k + Np − 1|k)
Uk =
.
(14)
From this control sequence, at each sampling instant k, one takes the first entry
u(k) and applies the control signal according to Eq. (12) to the controlled
COVID-19 spread process (SIRDC / SIRASDC models).
Notice that if one simply minimized the previous cost function J, at each
sampling instant k, with respect to a control sequence Uk , the results would be
a control sequence Uk which provides a trade-off (according to weights QI and
Qu ) between the minimization of infected individuals and control effort (u gets
closer to 0 and, thus, less isolation is implied).
Anyhow, for an appropriate application of this paradigm, the constraints of
each u(k + j|k), as given in Section 4.2, should be taken into account by the
optimization procedure. It follows that:
IS (k + j|k) ≤
0 ≤ u(k + j|k) ≤

nICU (1 + ξ) ∀j = 1, . . . , Np ,
1

∀j = 0, . . . , Np − 1 ,

(15)
(16)

u(k + j + 1|k)

=

u(k + j|k) + ∆u(k + j|k) ∀j = 0, . . . , Np − 1 ,

∆u(k + j|k)

is

binary

∆u(k + m|k)

=

0 if k∆u(k + j + 1|k) − ∆u(k + j|k)k = 1 ∀m = j, . . . , j + N
(19)
m.

∀j = 0, . . . , Np − 1 ,

17

(17)
(18)

Notice that:
• Eq. (15) ensures that the peak of infections is reduced and does not
surpass nICU (1 + ξ);
• Eq. (16) ensures the control signal is bounded within the social isolation limits, Eq. (17) ensures that this law is piece-wise constant and Eq.
(18) implied that the variation is binary (so that the control is, in fact,
”On”/”Off”);
• Eq. (19) implies that a minimal dwell-time of Nm samples must be accounted for, i.e. the control determines that u stays at a given state ”On”
or ”Off” for a minimal period of Nm days. It is implied that Np > Nm .
Notice that the slack/tolerance variable ξ defined in in Section 4.1 should
also be minimized, which means that a ξ T QI ξ is included to the cost function
J, as follows:
J

 Np −1
Np
X
X
IS (k + j|k)T QI IS (k + j|k)
u(k + j|k)T Qu u(k + j|k) + ξ T Q(20)
=
+
Iξ .
max
2
(I
)
S
j=1
j=0

Therefore, bearing in mind this previous discussion, the MPC approach to
mitigate the effect of COVID-19 spread consists in minimizing the cost function
J at every discrete-time step k, with respect to the previously discussed constraints and taking into account a discretized version of the SIRASDC model,
with Ts = 1 day. One can mathematically express this problem as follows:
min
Uk

J

(21)


 Discrete SIRASDC Model, Eqs. (22)-(27)
Peak reduction constraint: Eq. (15)
subject to:

Control signal constraints: Eqs. (16)-(19)
Note that the discrete SIRASDC model is found by applying the discretization method detailed in Remark 2 to Eq. (7). This discretized model is then
extended as a prediction model, describing future instants (k + j) with respect

18

to the information at (k), this is:
S(k + j + 1)

=

IA (k + j + 1)

=
+

IS (k + j + 1)

=
+

D(k + j + 1)

=

ψ(k + j + 1)

=
+

Kψ (k + j)

=

S(k + j)
(22),
N (k + j)
IA (k + j) − Ts γA IA (k + j)
(23)
S(k + j)
,
Ts (1 − p)ψ(k + j) (βA IA (k + j) + βS IS (k + j))
N (k + j)
γS IS (k + j)
IS (k + j) − Ts
(24)
1−ρ
S(k + j)
Ts pψ(k + j) (βA IA (k + j) + βS IS (k + j))
,
N (k + j)
ρ
D(k + j) + Ts
γS IS (k + j) ,
(25)
1−ρ
ψ(k + j) + Ts αOff (1 − ψ(k + j))(1 − u(k + j))
(26)

S(k + j) − Ts ψ(k + j) (βA IA (k + j) + βS IS (k + j))

Ts αOn (Kψ (k + j)ψinf − ψ(k + j)) u(k + j) ,
ρ IA (k + j)
.
1 − γK
1 − ρ N (k + j

(27)

5. Simulation Results, Forecasts and Discussion
In this Section, we present simulation forecasts using the SIRDC/SIRASDC
with parameters identified in Section 3. The following results were obtained
with the aid of Matlab software, Yalmip toolbox and BNB solver.
In the sequel, the baseline threshold in the IS curves represent the number of
available ICU beds in the country (see Figure 2). The maximal threshold stands
for an incremented number of ICUs (twice the baseline value), accounting for
field hospitals and emergency ICUs that have been made specifically for the
COVID-19 pandemic.
The following control results were obtained considering the SIRASD models
(Nominal, Uncertain 1 and Uncertain 2), as presented in Section 3.
Before presenting the actual results, we must affirm that the forecasts and
arguments that we present in the sequel should not understood by the reader as
incontrovertible truths. These forecast are model-based simulations which depend on a number of factors and initial conditions. Furthermore, we must stress
that we have aggregated the whole set of Brazilian data in order to provide a
general view of the country. However, if anyone intends to use the proposed
method to help the formulation of public health policies, we suggest its application to datasets of smaller regions, that share the same hospital chain. We
note, as illustrated in Figure 2, that different regions of the country are facing
different levels of the pandemic.
As evidenced in Section 3, the used models grasp the behaviors the SARSCoV-2 virus dynamics quite accurately, but this does not means that the future
predictions are unmistakable. For a fact, we cannot ensure that the social
isolation measures will be strictly followed by the population, as we cannot
19

ensure that other factors may come to help ease the spread of the disease (such
as vaccines). What we mean by this is that the goal of this work is guide public
policies regarding social isolation specially by taking into account the role of
uncertainty and sub-notification.
Due to the fact that the proposed model cannot exactly predict the pandemic
dynamics, to apply some control polcy conceived based on a nominal model
may lack conservatism. This could lead to catastrophic results, risking high
levels of mortality. Any possible control policy that the government implements
through social distancing measures must be based on recurrent (worst-case)
model parameter estimations and recalculations of the optimization problem.
One cannot use the models derived with the parameters presented in Table 1 as
if they would not change along time. The correct measure is to take into account
uncertainty-embedded models, performing the identification procedure detailed
in Section 3 every day (when new datasets are available). Such adaptive control
procedure (with model tuning and model-based control optimization) would
be much more prudent, requiring constant measuring, monitoring, parameter
estimation and control computations. As discussed by Köhler et al. (2020),
feedback is utterly necessary to ensure a reliable handling of the SARS-CoV-2
outbreak. This is especially critical in Brazil, due to the high level of uncertainty
on the datasets.
Through the sequel, the dashed lines represent the results with uncertainty
(solid dash, Uncertain 1 model; dot dash, Uncertain 2 model), while the solid
lines account for nominal conditions.
Considering these models, Figure 4 shows the simulation for roughly one
year dating from the last data sample (20/03/17), considering a total lockdown condition (u = 1) and a no-isolation (u = 0) case. The first 52 samples
represent the known dataset, whereas the following samples stand for predicted
data. Clearly, even if a hard isolation is enacted, the Brazilian health system
will still face issues with large amounts of COVID-19 patients, with a nominal
peak forecast to 26th of May. The nominal collapse of the healthy system
(threshold) dates very soon, May 23. The amount of deaths expected with the
uncertain model is unprecedented. Of course, each life matters and 2 million
deceased individuals is a lot to bare. Psychological and social traumas will
mark the country. A hard isolation could be able to save more than one million
lives, taking into account the results achieved with the worst-case uncertainty
scenario.
With respect to the forecasts presented in Figure 4, we must also stress that
the possibility of herd immunity must be discarded. These results corroborate
the conclusions presented by Köhler et al. (2020), which indicate that neither
a complete eradication of the virus nor herd immunity are possible options to
attenuate the COVID-19 pandemics without the availability of a vaccine. These
results also go along the lines of Hellewell et al. (2020).
Considering control results, the MPC optimization procedure from Eq. (21)
is solved for different cases of Nm (minimal amount of days in each state: isolation, no isolation). For such, the weighting matrices QI and Qu are taken to
imply an adequate trade-off between peak reduction and social isolation. Since
20

2

106
Known Data

# People

1.5

Threshold: Baseline
Threshold: Max
No Isolation: Nominal
No Isolation: Uncertain 1
No Isolation: Uncertain 2
Hard Isolation: Nominal
Hard Isolation: Uncertain 1
Hard Isolation: Uncertain 2

Nominal peak 20/05/26

1

0.5

0
2

106

50

100

150

200

250

300

350

400

Deaths
Time (days)

# People

1.5

1

0.5

0
20/03/17

First Death

50
20/05/08

100

150
20/08/14

200

Time (days)

250

300
21/01/11

350

400
21/04/21

Figure 4: Necessity of Social Isolation 2: Model-based Forecasts

the occupancy rate of ICU beds in the country dating 20/05/08 is considerably
high, we chose QI = 0.9 and Qu = 0.1, which means that the MPC makes ”more
effort” to reduce the amount of infected individuals then to restore a no-isolation
policy, which is reasonable considering the observed situation. The control horizon is fixed as Np = 60 days (the MPC makes predictions for two-months ahead
of each sampled k, day).
Firstly, we show the results for Nm = 2, 5 and 7 days of the minimal days in
each state condition. The decision by the MPC optimization and the resulting
enacted social isolation measure (ψ) are shown in Figure 5. The resulting effects
on the amount of symptomatic individuals is shown in Figure 6. We must state
that, for Nm ≤ 7 days, the amount of shifting in the observed social isolation
variable is quite intense. Furthermore, the obtained results with these values for
Nm were not enough to reduce the infection peak, as observed. Note that this
kind of policy would hardly ever be implementable, since a confusing message
would be passed to the society. The frequent changing between isolation or noisolation would not be strictly followed, which is certainly unwanted. Therefore,
these results are not considered as practical or viable.

21

Observed Social Isolation
1
2 Days
5 Days
7 Days

0.8

0.6

0.4

50

100

150

200

250

300

350

400

300

350

400

Time (days)
Control Action: On / Off State
1
0.8
On State:
0.6 Social Isolation
0.4
Off State:
No Isolation

0.2
0

50

100

150

200

250

Time (days)

Figure 5: Control Policy, Nm = 2, 5 and 7 Days, Excessive Shifting

2

106

1.8

Infected with Symptoms
Threshold Baseline
Threshold Limit
2 Days: Nominal
2 Days: Uncertain 1
2 Days: Uncertain 2
5 Days: Nominal
5 Days: Uncertain 1
5 Days: Uncertain 2
7 Days: Nominal
7 Days: Uncertain 1
7 Days: Uncertain 2

Known Data

1.6
1.4

# People

1.2
1
0.8
0.6
0.4
0.2
0
20/03/17

50
20/05/08

100

150
20/08/14

200

Time (days)

250

300
21/01/11

Figure 6: Nm = 2, 5 and 7 days, Resulting regulation

22

350

400
21/04/21

Then, Figure 7 presents the obtained control results for Np = 10, 14, 20, 25, 30, 40
and 60 days, regarding the IS curve. This Figure contains a lot of information,
which we try to explain by parts:
• If social isolation is not maintained until roughly August 14, even the
shortest ”openings” (days in reduced isolation policies) could be catastrophic. Any possible reduction of the hard social isolation measures,
before this date, would result in an infection peak which would surpass
the amount of available ICU beds in the country in over seven times (considering the worst-case uncertainty). This is very significant and thus, any
possible social isolation reduction should not proceed before the initial infection curve starts to decay (in both nominal and uncertain conditions);
• Therefore, smallest peaks of infections occurs if the isolation measure is
kept at least until August 14. After this date, when relaxations in these
measures are enacted, a second infection peak will certainly appear. This
second peak is due to the fact that social isolation is reduced by the MPC
law after the decay of IS running from first peak (August 14). This second
peak dates roughly October 3.
• The second peak of infection is reduced with a smaller number of days in
a no-isolation mode. This means that, after August 14, the MPC control
action which results in the smallest values for IS are those with, at most,
periods of 25 days in the no-isolation mode. The smallest amount of
”open” periods, better the results, as expected.
• Note that as Nm increases, this second peak of infection also increases
because the amount of minimal days determined for a no-isolation (or
reduced-isolation) policy forces a peak increase, which is later treated by
a total isolation after its decay. The amount of deaths are given in Figure 9.
Depending on the amount of days in a no-isolation condition, the amount
of deaths may range from 0.13 to 1.88 million individuals, according to
the uncertain models.
Regarding these obtained results, it seems reasonable to us to ponder the
following issues:
• The uncertain model forecasts quite harsh infection scenarios. Even though
the considered uncertainty is quite high (15, 30 times more cases), it offers
us a worst-case forecast to determine public policies. With such uncertain
model in mind, it seems evident why social distancing measures are so
important right now and why they should not be dropped, despite their
possible economical side-effects. It seems extremely necessary for public
policies to offer alternative solutions to those without jobs or economically
suffering due to the social isolation.
• No social distancing measures should be relaxed before mid-August (20/08/14).
This would definitely help in avoiding the collapse of the Brazilian health
system.
23

2

106

Infected with Symptoms

Threshold Baseline
Threshold Limit
10 Days: Nominal
10 Days: Uncertain 1
10 Days: Uncertain 2
14 Days: Nominal
14 Days: Uncertain 1
14 Days: Uncertain 2
20 Days: Nominal
20 Days: Uncertain 1
20 Days: Uncertain 2
25 Days: Nominal
25 Days: Uncertain 1
25 Days: Uncertain 2
30 Days: Nominal
30 Days: Uncertain 1
30 Days: Uncertain 2
40 Days: Nominal
40 Days: Uncertain 1
40 Days: Uncertain 2
60 Days: Nominal
60 Days: Uncertain 1
60 Days: Uncertain 2

Known Data
1.8

15

10

4

Smallest Second Peak:
25 Days at most

Peaks due to early
1.6 openings (up to 20 days)
10

Smallest peak:
Social isolation
until 20/08/14

1.4

# People

1.2
5

1
Second Peak

0.8

0
160

170

180

190

200

210

220

230

240

250

0.6
0.4
Number of Days
0.2
0
20/03/17

50
20/05/08

100

150
20/08/14

200

Time (days)

250
20/11/22

300
21/01/11

350

400
21/04/21

Figure 7: Nm = 10, 14, 20, 25, 30, 40 and 60 Days: Infected with Symptoms

• If social distancing is to be relaxed, this should not be done before the first
infection peak starts to decay (beginning of August) and the no-isolation
periods should be the minimal amount of days possible. To ensure heath
safety, a conservative measure indicates that such paradigm of recurrent
short periods of reduced isolation, followed by hard isolation periods would
proceed until roughly 2021/01/21. This paradigm would be helpful to
ensure that the SARS-CoV-2 virus does not cause further infection peaks
and to mitigate the amount of deaths.
The resulting control policies from the MPC procedure, for the different
values for Nm , are shown in Figure 8. These curves indicate, roughly, when to
determine social isolation measures and when to set them off. In fact, the actual
implemented policy would depend on a daily update of the MPC results with
measured datasets. Anyhow, these results indicate a forecast of roughly when
to determine or call off these measures. The best result, in terms of infections,
would be to follow the Social Isolation state until mid-August, an then relax
this measure with small periods (that should definitely not surpass 25 days).
It seems, mathematically speaking, that even if the SIRASD model has a
new degree-of-freedom (which is the decision variable u, to determine when to
determine social isolation), the resulting optimization points out that the best
option is to maintain isolation for as long as possible. Even if allowing social
contact for a while, the optimization finds minima solutions of J for the smallest
number of days with contact and, then, once again determines isolation.
The COVID-19 is quite worrisome and presents devastating social and economic effects. Biology literature points out that social isolation is necessary.
Using mathematical models and optimization, the answer is the same.

24

Observed Social Isolation
1
10 Days
14 Days
20 Days
25 Days
30 Days
40 Days
60 Days

0.9
0.8
0.7
0.6
0.5
0.4

50

100

150

200

250

300

350

400

Time (days)
Control Action: On / Off State
1
0.8
On State:
0.6 Social Isolation
0.4
Off State:
No Isolation

0.2
0
20/03/17

50
20/05/08

100

150
20/08/14

200

250

Time (days)

300
21/01/11

350

400
21/04/21

Figure 8: Control Policy: Nm = 10, 14, 20, 25, 30, 40 and 60 Days of Social Isolation

2

106

1.8
1.6
1.4

# People

1.2
1
0.8
0.6
0.4

Deaths
No Isol: Nominal
No Isol: Uncertain 1
No Isol: Uncertain 2
10 Days: Nominal
10 Days: Uncertain 1
10 Days: Uncertain 2
14 Days: Nominal
14 Days: Uncertain 1
14 Days: Uncertain 2
20 Days: Nominal
20 Days: Uncertain 1
20 Days: Uncertain 2
25 Days: Nominal
25 Days: Uncertain 1
25 Days: Uncertain 2
30 Days: Nominal
30 Days: Uncertain 1
30 Days: Uncertain 2
40 Days: Nominal
40 Days: Uncertain 1
40 Days: Uncertain 2
60 Days: Nominal
60 Days: Uncertain 1
60 Days: Uncertain 2

0.2
0
20/03/17

50
20/05/08

100

150
20/08/14

200

Time (days)

250

300
21/01/11

Figure 9: Nm = 10, 14, 20, 25, 30, 40 and 60 Days: Deaths

25

350

400
21/04/21

6. Conclusions
In this paper, we investigate an optimization-based solution for social isolation measures of the COVID-19 spread for the Brazilian context. Since recent
works have warned against the large order of sub-notification in Brazil, we take
uncertainty into account to determine nominal and uncertainty dynamic models
of the COVID-19 pandemics. Such uncertainty-embedded models are SIR-kind
equations which also consider a new variable, which accounts for the average
response of the population to social distancing measures (as determined by the
government). A robust Model Predictive Control framework is designed for the
regulation of the COVID-19 through the means of such social isolation policies.
The MPC is derived as an optimal On-Off social distancing planner.
In this paper, we have tried to expose some essential insights regarding subnotification and how possible relaxations of social distancing can be performed
in the future. Below, we summarize the main findings of this paper, enlightening
the key points:
• The presented results corroborate the hypothesis formulated in Hellewell
et al. (2020) and also discussed in The Lancet (2020), with respect to
the Brazilian scenario: herd immunity cannot be considered a plausible
solution, offering great risk and leading to elevated fatality. Furthermore,
as illustrate Silva et al. (2020); Rocha Filho et al. (2020); RodriguezMorales et al. (2020), vertical isolation is also not an option for the time
being, since we do not have the means to formulate an efficient public
policy to separate the population at risk from those with reduced risk,
due to multiple social-economical issues of the country.
• Since the spread of the SARS-CoV-2 virus is inherently complex and varies
according to multiple factors (some which are possibly unmodelled and external), exact prediction of the pandemic dynamics is not possible. Therefore, the correct control procedure should be based on a recurrent (daily)
model tuning and re-calculation of the control law, always taking into
account the uncertainty margins.
• The simulation forecasts found through the MPC optimization procedure,
which accounts for the uncertainty in the spread of the disease, indicate
that, at least for now, only one answer is available: maintain social isolation for as long as possible, without relaxing it before mid August 2020.
This is a rather strict suggestion, but seems to be the sole possible way
to attenuate the (already high) levels of the virus in Brazil. The forecasts
also indicate a prediction for the infection peak in the country dating very
soon, May 26, with a second (and larger) peak possibly arising in October. The control policy, in terms of social isolation, shows that relaxations
(loosening the isolation measures) should be performed in, at most, periods of 25 days of reduced-isolation, after the first infection peaks has
passed, until roughly January 2021.

26

Synthetically, we must stress that this paper presents only qualitative results
of how an optimization-based On-Off strategy can be formulated regarding the
COVID-19 spread, regarding the Brazilian context. Since the country as been
experiencing an unwillingness to formally start harder social isolation measures
The Lancet (2020), the social and economic costs of the pandemic might be
brutal. The Authors hope that the proposition herein formalised can serve to
help determining adequate public health policies from now on.
Acknowledgment
D. O. C. and J. E. N. acknowledge the financial support of CNPQ under
respective grants 302629/2019 − 0 and 304032/2019 − 0.
Notes
The authors report no financial disclosure nor any potential conflict of interests.
References
Adam, D. (2020). The simulations driving the worlds response to covid-19. how
epidemiologists rushed to model the coronavirus pandemic? Nature, April .
Alleman, T., Torfs, E., & Nopens, I. (2020).
COVID-19:
from
model prediction to model predictive control. https://biomath. ugent.
be/sites/default/files/2020-04/Alleman etal v2. pdf, accessed April , 30 , 2020.
Arino, J., Brauer, F., van-den Driessche, P., Watmough, J., & Wu, J. (2008).
How will country-based mitigation measures influence the course of the
COVID-19 epidemic? Journal of Theoretical Biology, 253 , 118–130.
Auler, A., Cássaro, F., da Silva, V., & Pires, L. (2020). Evidence that high
temperatures and intermediate relative humidity might favor the spread of
COVID-19 in tropical climate: A case study for the most affected brazilian
cities. Science of The Total Environment, (p. 139090).
de Ávila-Simas, S., Morato, M. M., Reynalte-Tataje, D. A., Silveira, H. B.,
Zaniboni-Filho, E., & Normey-Rico, J. E. (2019). Model-based predictive
control for the regulation of the golden mussel limnoperna fortunei (dunker,
1857). Ecological Modelling, 406 , 84–97.
Bard, Y. (1974). Nonlinear Parameter Estimation.
Bastos, S. B., & Cajueiro, D. O. (2020). Modeling and forecasting the early evolution of the covid-19 pandemic in brazil. arXiv preprint arXiv:2003.14288 ,
.

27

Bedford, J., Farrar, J., Ihekweazu, C., Kang, G., Koopmans, M., & Nkengasong,
J. (2019). A new twenty-first century science for effective epidemic response.
Nature, 575 , 130–136.
Bhatia, S., Cori, A., Parag, K. V., Mishra, S., Cooper, L. V., Ainslie, K.
E. C., Baguelin, M., Bhatt, S., Boonyasiri, A., Boyd, O., Cattarino, L.,
Cucunub, Z., Cuomo-Dannenburg, G., Dighe, A., Dorigatti, S., Ilaria vanElsland, FitzJohn, R., Fu, H., Gaythorpe, K., Green, W., Hamlet, A., Haw,
D., Hayes, S., Hinsley, W., Imai, N., Jorgensen, D., Knock, E., Laydon, D.,
Nedjati-Gilani, G., Okell, L. C., Riley, S., Thompson, H., Unwin, J., Verity, R., Vollmer, M., Walters, C., Wang, H. W., Walker, P. G., Watson, O.,
Whittaker, C., Wang, Y., Winskill, P., Xi, X., Ghani, A. C., Donnelly, C. A.,
Ferguson, N. M., & Nouvellet, P. (2020). Short-term forecasts of COVID19 deaths in multiple countries.
URL: https://mrc-ide.github.io/
covid19-short-term-forecasts/index.html#authors [Online; Accessed
29-April-2012].
Bolzoni, L., Bonacini, E., Soresina, C., & Groppi, M. (2017). Time-optimal
control strategies in sir epidemic models. Biosciences, 292 , 86–96.
Brauer, F., Castillo-Chavez, C., & Feng, Z. (2019). Mathematical Models in
Epidemiology.
Brazilian Federal Medicine Council (2020). Icu beds in brazil. https://portal.
cfm.org.br/images/PDF/leitosdeutiestados2018.pdf. Accessed: 202003-30.
Camacho, E. F., & Bordons, C. (2013). Model predictive control . Springer
Science & Business Media.
Del Rio, C., & Malani, P. N. (2020). Covid-19new insights on a rapidly changing
epidemic. Jama, .
Delatorre, E., Mir, D., Graf, T., & Bello, G. (2020). Tracking the onset date of
the community spread of SARS-CoV-2 in western countries. medRxiv , .
Eichenbaum, M. S., Rebelo, S., & Trabandt, M. (2020). The macroeconomics
of epidemics. Working Paper 26882 National Bureau of Economic Research.
URL: http://www.nber.org/papers/w26882. doi:10.3386/w26882.
Gormsen, N. J., & Koijen, R. S. J. (2020). Coronavirus: Impact on stock prices
and growth expectations. Working Paper of the University of Chicago, (pp.
1–27).
Hellewell, J., Abbott, S., Gimma, A., Bosse, N. I., Jarvis, C. I., Russell, T. W.,
Munday, J. D., Kucharski, A. J., Edmunds, W. J., Sun, F. et al. (2020). Feasibility of controlling COVID-19 outbreaks by isolation of cases and contacts.
The Lancet Global Health, .

28

Ionescu, C. M., De Keyser, R., Torrico, B. C., De Smet, T., Struys, M. M.,
& Normey-Rico, J. E. (2008). Robust predictive control strategy applied for
propofol dosing using BIS as a controlled variable during anesthesia. IEEE
Transactions on biomedical engineering, 55 , 2161–2170.
Ismael, C., Silva, P. A. I. A., da Silva, C. M., de Melo, M. S. V., Neto, B. A. F.,
de Melo, J. V., Macario, R., de Souza, V. A., Moura, L. M., & Domenge,
C. (). Universal screening of SARS-CoV-2 of oncology healthcare workers a
Brazilian experience. SciELO Preprints, .
Keeling, M. J., & Rohani, P. (2011). Modeling Infectious Diseases in Humans
and Animals.
Kermack, W. O., & McKendrick, A. G. (1927). A contribution to the mathematical theory of epidemics. Proceedings of the Royal Society A, 115 , 700–721.
Kissler, S. M., Tedijanto, C., Goldstein, E., Grad, Y. H., & Lipsitch, M. (2020).
Projecting the transmission dynamics of sars-cov-2 through the postpandemic
period. Science, . doi:10.1126/science.abb5.
Köhler, J., Schwenkel, L., Koch, A., Berberich, J., Pauli, P., & Allgöwer, F.
(2020). Robust and optimal predictive control of the COVID-19 outbreak.
arXiv preprint arXiv:2005.03580 , .
Kucharski, A. J., Russell, T. W., Diamond, C., Liu, Y., Edmunds, J., Funk, S.,
Eggo, R. M., Sun, F., Jit, M., Munday, J. D. et al. (2020). Early dynamics
of transmission and control of COVID-19: a mathematical modelling study.
The lancet infectious diseases, .
Longini-Jr., I. M., Halloran, M. E., Nizam, A., & Yang, Y. (2004). Containing
pandemic influenza with antiviral agents. American Journal of Epidemiology,
159 , 623–633.
Moscoso-Vásquez, M., Colmegna, P., & Sánchez-Peña, R. S. (2016). Intrapatient dynamic variations in type 1 diabetes: A review. In IEEE Conference
on Control Applications (pp. 416–421). IEEE.
Peng, L., Yang, W., Zhang, D., Zhuge, C., & Hong, L. (2020). Epidemic
analysis of COVID-19 in China by dynamical modeling. arXiv preprint
arXiv:2002.06563 , .
Piguillem, F., Shi, L. et al. (2020). The optimal covid-19 quarantine and testing policies. Technical Report Einaudi Institute for Economics and Finance
(EIEF).
Piunovskiy, A., Plakhov, A., & Tumanov, M. (2020).
Optimal
impulse control of a sir epidemic.
Optimal Control Applications and Methods, 41 , 448–468. URL: https://onlinelibrary.
wiley.com/doi/abs/10.1002/oca.2552.
doi:10.1002/oca.2552.
arXiv:https://onlinelibrary.wiley.com/doi/pdf/10.1002/oca.2552.
29

Robinson, M., & Stilianakis, N. I. (2013). A model for the emergence of drug
resistance in the presence of asymptomatic infections. Mathematical Biosciences, 243 , 163–177.
Rocha Filho, T. M., dos Santos, F. S. G., Gomes, V. B., Rocha, T. A., Croda,
J. H., Ramalho, W. M., & Araujo, W. N. (2020). Expected impact of COVID19 outbreak in a major metropolitan area in brazil. medRxiv , .
Rodriguez-Morales, A. J., Gallego, V., Escalera-Antezana, J. P., Mendez, C. A.,
Zambrano, L. I., Franco-Paredes, C., Suárez, J. A., Rodriguez-Enciso, H. D.,
Balbin-Ramon, G. J., Savio-Larriera, E. et al. (2020). COVID-19 in latin
america: the implications of the first confirmed case in brazil. Travel medicine
and infectious disease, .
Silva, R. R., Velasco, W. D., da Silva Marques, W., & Tibirica, C. A. G. (2020).
A bayesian analysis of the total number of cases of the COVID-19 when only
a few data is available. a case study in the state of Goias, Brazil. medRxiv , .
Silveira, H. B., & Pagano, D. J. (2005). Piecewise-constant control signal for
predator-prey systems: Application to ecological recovery. In Proceedings 16th
IFAC World Congress, Prague, Czech Republic.
Skogestad, S., & Postlethwaite, I. (2007). Multivariable feedback control: analysis and design volume 2. Wiley New York.
The Lancet (2020).
Covid-19 in brazil: so what?.
The Lancet,
395 , 1461. URL: http://www.sciencedirect.com/science/article/
pii/S0140673620310953. doi:https://doi.org/10.1016/S0140-6736(20)
31095-3.
Werneck, G. L., & Carvalho, M. S. (2020). The COVID-19 pandemic in brazil:
chronicle of a health crisis foretold.
World Heath Organization (2020).
Coronavirus disease 2019 (covid19)situation report 96. https://www.who.int/docs/default-source/
coronaviruse/situation-reports/20200425-sitrep-96-covid-19.pdf?
sfvrsn=a33836bb_2.
Zurakowski, R., Messina, M. J., Tuna, S. E., & Teel, A. R. (2004). HIV treatment scheduling via robust nonlinear model predictive control. In 2004 5th
Asian Control Conference (IEEE Cat. No. 04EX904) (pp. 25–32). IEEE volume 1.

30

