Modeling Epidemic Spreading through Public Transit using Time-Varying
Encounter Network
Baichuan Moa,∗, Kairui Fengb,∗, Yu Shenc,∗∗, Clarence Tamd , Daqing Lie , Yafeng Yinf , Jinhua Zhaog
a Department

of Civil and Environmental Engineering, Massachusetts Institute of Technology, Cambridge, MA 02139
of Civil and Environmental Engineering, Princeton University, Princeton, NJ 08540
c Key Laboratory of Road and Traffic Engineering of the Ministry of Education, Tongji University, Shanghai 201804, China
d Saw Swee Hock School of Public Health, National University of Singapore, Singapore 117549
e School of Reliability and Systems Engineering, Beihang University, Beijing 100191, China
f Department of Civil and Environmental Engineering, University of Michigan, Ann Arbor, MI 48108
g Department of Urban Studies and Planning, Massachusetts Institute of Technology, Cambridge, MA 02139

arXiv:2004.04602v2 [physics.soc-ph] 22 Nov 2020

b Department

Abstract
Passenger contact in public transit (PT) networks can be a key mediate in the spreading of infectious
diseases. This paper proposes a time-varying weighted PT encounter network to model the spreading of
infectious diseases through the PT systems. Social activity contacts at both local and global levels are
also considered. We select the epidemiological characteristics of coronavirus disease 2019 (COVID-19) as
a case study along with smart card data from Singapore to illustrate the model at the metropolitan level.
A scalable and lightweight theoretical framework is derived to capture the time-varying and heterogeneous
network structures, which enables to solve the problem at the whole population level with low computational
costs. Different control policies from both the public health side and the transportation side are evaluated.
We find that people’s preventative behavior is one of the most effective measures to control the spreading
of epidemics. From the transportation side, partial closure of bus routes helps to slow down but cannot
fully contain the spreading of epidemics. Identifying ”influential passengers” using the smart card data and
isolating them at an early stage can also effectively reduce the epidemic spreading.
Keywords: Public transit encounter; Epidemics; Time-varying complex network; COVID-19

1. Introduction
Infectious diseases spread through repetitive social contacts (Smieszek, 2009; Smieszek et al., 2009), such
as at schools (Salathé et al., 2010; Litvinova et al., 2019), conferences (Stehlé et al., 2011) or workplaces
(Potter et al., 2015). Past studies proved that human mobility networks—like air transportation (Hufnagel
et al., 2004; Colizza et al., 2006; Balcan et al., 2009) or waterways (Mari et al., 2012; Gatto et al., 2012)—
reconstruct the geometry distance by transporting pathogens or contagious individuals more effectively to
widespread locations (Brockmann and Helbing, 2013), leading to the outbreak of epidemics. Recently,
the outbreak of coronavirus disease 2019 (COVID-19) confirmed the strong connection between human
mobility network and disease dynamics. The first case of COVID-19 was reported in Wuhan, China, at the
beginning of Dec. 2019, and has then quickly spread to the rest of China through airlines and high-speed rail
∗ Both

authors contributed to this paper equally.
author
Email addresses: baichuan@mit.edu (Baichuan Mo), kairuif@princeton.edu (Kairui Feng), yshen@tongji.edu.cn (Yu
Shen), clarence.tam@nus.edu.sg (Clarence Tam), daqingl@buaa.edu.cn (Daqing Li), yafeng@umich.edu (Yafeng Yin),
jinhua@mit.edu (Jinhua Zhao)
∗∗ Corresponding

Preprint submitted to Elsevier

November 24, 2020

networks during the Spring Festival travel season (Wu et al., 2020). Besides the transmissions of pathogens
to destination local communities via human mobility network, the densely populated urban public transit
(PT) network, however, may also become a key mediate in the spreading of influenza-like epidemics with
public transport carriers being the location of transmission (Sun et al., 2013).
The PT system in large metropolitan areas plays a key role in serving the majority of urban commuting
demand between highly frequented locations, as human trajectories present a high degree of spatiotemporal
regularity following simple, reproducible patterns (Gonzalez et al., 2008). By the end of 2017, the annual
patronage of urban metro systems worldwide increased from 44 billion in 2013 to 53 billion, and in Asia, the
systems carry more than 26 billion passengers a year (International Association of Public Transport (UITP),
2018). The urban PT system is often framed as a key solution for building sustainable cities with concerns of
environment, economy, and society’s effectiveness (Miller et al., 2016). But the indoor environment created
by crowded metro carriages or buses can also make an infected individual easily transmit the pathogen to
others via droplets or airborne routes (Xie et al., 2007; Yang et al., 2009). In recent years, scholars began to
turn their attention to the spreading of the epidemic through the urban PT network.
Rooted in people’s daily behavior regularity, individuals with repeated encounters in the PT network are
found to be strongly connected over time, resulting in a dense contact network across the city (Sun et al.,
2013). Such mobility features lead to great risks for the outbreak of infectious diseases through bus and
metro networks to the whole metropolitan area (Sun et al., 2014; Liu et al., 2019). Based on the contact
network developed by Sun et al. (2013), a variation of human contact network structures has been proposed
to characterize the movement and encounters of passengers in the PT system, which are then used to model
the epidemic spreading among passengers (Bóta et al., 2017a,b; Hajdu et al., 2019; El Shoghri et al., 2019).
However, previous studies focusing on the human contacts in PT systems often use a static passenger
contact network, discarding the time-varying nature of encounters. The aggregation of the time-varying
edges into a static version of the network offers useful insights but can also introduce bias (Perra et al., 2012;
Coviello et al., 2016). Recently, Müller et al. (2020) simulated complete individual mobility trajectories
based on mobile phone data and calculated the spreading risks of COVID-19 over dynamic encounters in
transportation and buildings. They found that successful contact tracing can reduce the reinfection rate by
about 30 to 40%, which suggests the importance in considering time-varying human interactions for epidemic
modeling. However, their research mainly focused on testing the effects of general control strategies at the
government level (e.g., closing schools, limiting outdoor activities). From the transportation perspective, the
operation strategies by transport authorities (especially PT agencies) may also play an important role in
controlling epidemics. Recently, a variety of epidemic control strategies in PT systems have been implemented
to respond to the outbreak of COVID-19 since late January 2020. For example, in Wuhan, almost all PT
services have been shut down since Jan. 24th. In Wuxi, another Chinese big city, except the 22 arterial bus
routes kept running with shortened operation hours, all other PT services (roughly 92% of bus routes) were
suspended since Feb. 1st. In Milan, Italy, the PT services were still in operation, but the suspension of PT
has been officially proposed with the rapid surge of COVID-19 cases in the Lombardy area. The impacts
of these strategies and other possible PT operation strategies (e.g., distributing passengers’ departure time,
limiting maximum bus load), however, have seldom been carefully explored.
To fill these gaps, this study proposes a time-varying weighted PT encounter network (PEN) to model
the spreading of the epidemic through urban PT systems. The social activity contacts at both local and
global levels are also considered. We select the epidemiological characteristics of COVID-19 as the case study
along with high-resolution smart card data from Singapore to illustrate the model at the metropolitan level.

2

Different control policies from both the public health side and the transportation side are evaluated.
In this work, we do not attempt to reproduce or predict the patterns of COVID-19 spreading in Singapore,
where a variety of outbreak prevention and control measures have been implemented (Ministry of Health
(MOH), 2020) and make most of epidemic prediction models invalid. Instead, since the PT systems in many
cities share the similar contact network structure despite the differences in urban structures, PT network
layouts and individual mobility patterns (Qian et al., 2020), this study aims to employ the smart card
data and the PT network of Singapore as proximity to the universal PEN to better understand the general
spatiotemporal dynamics of epidemic spreading over the PT system, and to evaluate the potential effects of
various measures for epidemic prevention in the PT systems, especially from the PT operation angle.
The main contribution of this paper is threefold:
• Propose a PT system-based epidemic spreading model using the smart card data, where the timevarying contacts among passengers at an individual level are captured.
• Propose a novel theoretical solving framework for the epidemic dynamics with time-varying and heterogeneous network structures, which enables to solve the problem for the whole population with low
computational costs.
• Evaluate various potential epidemic control policies from both public health side (e.g., reducing infectious rate) and transportation side (e.g., distributing departure time, closing bus routes)
The rest of the paper is organized as follows. In Section 2, we elaborate on the methodology of establishing
contact networks and solving the epidemic transmission model. Section 3 presents a case study using the
smart card data in Singapore to illustrate the general spatiotemporal dynamics of epidemic spreading through
the PT system. In Section 4, conclusions are made and policy implications are offered.
2. Methodology
2.1. Network representation
Epidemic spreading is usually modeled based on individual’s contact network. The contact network is a
undirected graph where the node is individual and the edge shows the potential infection intensity between
corresponding individuals. The majority of previous studies investigated the epidemic process in a static
network, where the spreading of the disease is virtually frozen on the time scale of the contagion process.
However, static networks are only approximations of the real interplay between time scales. Considering
daily mobility patterns, no individual is in contact with all the friends simultaneously all the time. On
the contrary, contacts are changing in time, often on a time scale that is shorter than the whole spreading
process. Real contact networks are thus inherently dynamic, with connections appearing, disappearing, and
being rewired with different characteristic time scales, and are better represented in terms of a temporal or
time-varying network. Therefore, modeling the epidemic process on PT should be based on a time-varying
contact network.
Although we focus on the contagion process through PT, passengers’ social-activity (SA) contacts besides
riding the same vehicles are not neglectable. In this study, two components of the contact network are
considered: 1) a PEN that is designated to capture the interaction of passengers on PT, 2) and an SA
contact network that captures all other interactions among people.

3

2.1.1. PT encounter network
PT encounters are defined as those who have ever stayed in the same vehicle in a PT system. PT
passengers’ encounter patterns have been studied by Sun et al. (2013) through an encounter network, which
is an undirected graph with each node representing a passenger and each edge indicating the paired passengers
that have stayed in the same vehicle. The network is constructed by analyzing the smart card data, which
includes passengers’ tap-in/tap-out time, location, and corresponding bus ID. We assume passengers staying
in a same vehicle are close enough to trigger infections. Since PEN provides direct encounter information of
passengers, it is an ideal tool to investigate the epidemic spreading through PT.
Extending the work by Sun et al. (2013), we propose a time-varying weighted PEN to model the epidemic
process. We first evenly divide the whole study period into different time intervals t = 1, ..., T . The
length of each interval is τ . For a specific time interval t, consider a weighted graph Gt (N , Et , Wt ), where
N = {i : i = 1, .., N } is the node set with each node representing an individual, N is the total number of
passengers in the system; Et is the edge set and Wt is the weight set. The edge between i and j ( i, j ∈ N ),
denoted as etij , exists if i and j have stayed in the same vehicle during the time interval t. The weight of etij ,
t
t
denoted as wij
, is defined as wij
=

dtij
τ ,

where dtij is the duration of i, j staying in the same vehicle during

t
time interval t. By definition, we have 0 ≤ wij
≤ 1. The weight is used to capture the fact that epidemic

transmission is related to the duration of contact.
2.1.2. Social-activity contact network
In addition to contacts during rides on the PT, passengers may also contact each other during their
daily social activities. Given the heterogeneity of passengers’ spatial distributions, people may have various
possibilities to contact with different people. However, capturing the real connectivity of passengers in social
activities requires a richer dataset (e.g., mobile phone, GPS data), which is beyond the scope of this research.
In this study, we made the following assumptions to build the SA contact network.
• Global interaction: Passengers may interact with any other individuals in the system during a time
interval of t with a uniform probability of θg .
• Local interaction: Passengers with same origins or destinations of PT trips may interact with each
other during time interval t with a uniform probability θ` . Since local interaction is more intense than
global interaction, we have θ` > θg .
For the global interaction, we assume that the contact time for all connected individuals is τ for a specific
time interval if there are no PT and local contacts between them. Otherwise, the contact time should be
subtracted by the PT and local contact duration (CD) at that time interval. For the local interaction, the
contact time calculation is illustrated by the following example. Consider passenger i with PT trip sequence
{(Oti1 , Dti2 ), (Oti3 , Dti4 )}, where tk is the time when the passenger board or alight the vehicles. Otik and Dtik0
are the trip origin and destination, respectively. The trip sequence is defined as a sequence of consecutive
PT trips where every adjacent trip pair has an interval of fewer than 24 h (e.g., t3 − t2 < 24 h). We call
the interval between two consecutive PT trips (e.g., [t2 , t3 ]) as activity time hereafter. Since passengers may
not stay in the same place between two consecutive trips, we may have Dti2 6= Oti3 . We further assume that
from time t2 to t3 , the passenger spends half of the activity time at Dti2 and half of the activity time at Oti3 .
Suppose passenger j has a trip sequence {(Otj0 , Dtj0 ), (Otj0 , Dtj0 )}, and Dtj0 = Oti3 ; and the overlapping
1

2

3

4

2

time between intervals [t2 , t3 ] and [t02 , t03 ] are not zero. This means passengers i and j may have local
contact because they have stayed in the same place Dtj0 = Oti3 (by definition, the probability of having local
2

4

contact is θ` ). Recall that we assume that passengers spend half of the activity time at a specific origin or
destination. If they have a local contact, then the CD between passengers i and j is calculated as half of
the overlapping time between interval [t2 , t3 ] and interval [t02 , t03 ]. This calculation gives us the total CD of
i and j at the local interaction level. For example, if t2 < t02 < t3 < t03 , the total local CD between i and j is
1
0
2 (t3 − t2 ). Analogizing to the PEN, the total local CD can be mapped to each time interval. For example,
if t∗ is the time boundary for time interval t and time interval t + 1, and t∗ − τ < t02 < t∗ < t3 < t∗ + τ .
Denote the local CD between i and j for time interval t as d˜`,t (0 ≤ d˜`,t ≤ τ ). Then we have d˜`,t = t∗ − t0
ij

ij

ij

2

= t3 − t∗ .
and d˜`,t+1
ij
We denote the SA contact network as G̃t (N , Ẽtg , Ẽt` , W̃tg , W̃t` ), where Ẽtg is the edge set of global interaction; Ẽt` is the edge set of local interaction. The edge of global interaction between any i and j, denoted as
g
ẽg,t
ij , exists with probability θ for all i, j ∈ N . When i and j share the same PT trip origins or destinations
g
`
during time interval t, the edge of local interaction between i and j ( ẽ`,t
ij ) exists with probability θ . W̃t

and W̃t` are the weight set for global and local interaction edges, respectively. By the discussion above, we
`,t
have w̃ij
=

d˜`,t
ij
τ

`,t
g,t
`,t
g,t
t
for all w̃ij
∈ W̃t` and w̃ij
= 1 − w̃ij
− wij
for all w̃ij
∈ W̃tg . By definition, the contacts

from three sub-networks (local, global, and PT) are mutually exclusive.
It is worth noting that though some macroscopic simplification is applied, the SA contact network proposed in this paper is capable to deal with passengers’ full activity trajectories. Once the exact travel data
of each individual is given, we can construct the contact networks based on their locations and contact duration. Therefore, though the local and global contacts in this study are simplified, the proposed framework
is general and still works for more detailed data sources.
2.1.3. Examples
To illustrate the proposed epidemic contact network, we present a five-passenger system with a single
bus route (N = 5) in Figure 1. We consider the time period from 7:00 to 10:00 with τ = 1 h. For illustrative
purpose, we neglect the global interaction and set the local interaction insensitivity θ` = 1. The top of the
graph shows the overall time-varying contact networks (i.e. PEN+local) for three time intervals (t = 1, 2, 3).
The orange (green) edges represent there are SA (PT) contacts between corresponding passengers. The
middle of the graph shows the duration of passenger’s activity. The orange (green) bar indicates the duration
at local activities (at PT trips). The bottom of the graph shows the passengers trajectories along the bus
route.
In the time interval t = 1, at 7:30, passengers 1,2, and 5 board the bus; since they share the same origin
and also are in the same bus during t = 1, they are connected by the edges of PEN (colored green) and
edges of local SA interaction network (colored orange). Accordingly, we have d112 = d125 = d115 = 0.5 h. The
1
1
1
weights are calculated as w12
= w25
= w15
= 0.5/1 = 0.5. In the meanwhile, from the trajectories at t = 2,

we noticed passengers 3 and 4 also share the same origin. Thus, we also have an SA contact edge between
3 and 4 at t = 1. It is worth noting that before 7:00, passengers 1, 2, 5 and passengers 3, 4 may also have
the local SA contacts because they share the same origin at 7:30 and we assume they have stayed around
the origin from last bus trips (see Section 2.1.2 for more details).
1
2

1
˜`,1
˜`,1
The local CD for passengers 1,2, and 5 at time interval t = 1 is d˜`,1
12 = d25 = d15 = 2 × 0.5 = 0.25 h. The
comes from the assumption that these passengers only spend half of their time around this bus station

`,1
`,1
`,1
(see Section 2.1.2). Hence, the corresponding weights for the SA contact network are w̃12
= w̃25
= w̃15
=
`,1
`,1
1
˜
0.25/1 = 0.25. Similarly, we have d34 = 2 × 1 = 0.5 and w̃34 = 0.5. The weights for t = 2 and t = 3 are

calculated in the same way.

5

Figure 1: Network representation of a five-passenger system

2.2. Epidemic transition model
The epidemic transition model is independent of the network representation. We can model various
infectious diseases based on the proposed PEN using different epidemic transition frameworks. For the
case study we considered (COVID-19), we employed the Susceptible-Exposed-Infectious-Removed (SEIR)
diagram in this study. The SEIR model is generally used to model influenza-like illness and other respiratory
infections. For example, Small and Tse (2005) used this model to numerically study the evolution of the
severe acute respiratory syndrome (SARS), which shares significant similarities with the COVID-19.
2.2.1. SEIR diagram
We first divided the population into four different classes/compartments depending on the stage of the
disease (Anderson et al., 1992; Diekmann and Heesterbeek, 2000; Keeling and Rohani, 2007): susceptibles
(denoted by S, those who can contract the infection), exposed (E, those who have been infected by the
disease but cannot yet transmit it or can only transmit with a low probability), infectious (I, those who
contracted the infection and are contagious), and removed (R, those who are removed from the propagation
process, either because they have recovered from the disease with immunization or because they have died).
By definition, we have N = S ∪ E ∪ I ∪ R, where N is the set of the whole population.
The diagram of the SEIR model is shown in Figure 2. The diagram shows how individuals move through
each compartment in the model. The infectious rate, β, controls the rate of spread and is associated with the
probability of transmitting disease between a susceptible (S) and an exposed individual (E). The incubation
rate, γ, is the rate of exposed individuals (E) becoming infectious (I). Removed rate, µ, is the combination
of recovery and death rates. The SEIR model typically assumes the recovered individuals will not be infected
again, given the immunization obtained. It is worth noting that this study focuses on the early stage of an
epidemic process, where the impact of outside factors on N (e.g., birth and natural death) are not considered.

6

Figure 2: Diagram of SEIR

For the epidemic process models, people are concerned about the steady-state, epidemic threshold and
reproduction number. According to Pastor-Satorras et al. (2015), the number of infected individuals in the
SEIR model always tends to zero after a long term (see Figure 3a). This is obvious from the diagram of
SEIR (Figure 2), where there is only one recurrent state R. The basic reproduction number, denoted by
R0 , is defined as the average number of secondary infections caused by a primary case introduced in a fully
susceptible population (Anderson et al., 1992). In the standard SEIR model, we have R0 =

β
µ.

Epidemic

threshold, in many cases, is defined based on the value of R0 . When R0 < 1, the number of infectious
individuals tends to decay exponentially; thus, there is no epidemic. However, if R0 > 1, the number of
infectious individuals could grow exponentially with an outbreak of epidemic (see Figure 3b).

(a) Number of individuals in different classes (R0 >
1)

(b) Illustration of epidemic threshold

Figure 3: Illustration of SEIR model (adapted from Karong’oi et al. (2018); Pastor-Satorras et al. (2015))

2.2.2. Individual-based approach
Epidemic modeling can be classified into compartment models and network models. The typical compartment models assume the population are homogeneous and well-mixed, which is not suitable in this study.
Thus, the network models are used.
The modeling of epidemic on networks falls into two different categories (Pastor-Satorras et al., 2015): the
individual-based approach and the degree-based approach. Generally, the individual-based approach models
the epidemic transmission at the individual level (Smieszek et al., 2011). While the degree-based approach
captures the infection process at the group level, where each group includes a set of nodes (individuals)
with the same degree and these nodes are assumed to be statistically equivalent (Pastor-Satorras et al.,
2015). Since in the PEN, passengers with the same degree are not necessarily similar, the individual-based
framework is used in this study.
We denote Si,t , Ii,t , Ei,t , and Ri,t as the Bernoulli random variable that describes whether individual i is in
class S, I, E, and R at time interval t, respectively (Yes = 1). By definition we have Si,t +Ii,t +Ei,t +Ri,t = 1
P X
for all i and t. Let P(Xi,t = 1) = pX
i,t , where X ∈ {S, I, E, R} and
X pi,t = 1.
Since the contact network is defined in discrete time, we can describe the epidemic process of the SEIR
7

model as a discrete Markov process with specific transition probabilities. To match with the epidemiological
characteristics of COVID-19, we assume that the exposed individual can also infect others based on the
recent finding (Rothe et al., 2020), which may not be the common case in the SEIR model.
Let βI be the probability of a susceptible individual i ∈ S getting infected by an infected individual j ∈ I
at a time interval t if i and j contact each other (either by PT or SA) for the entire time interval. Since the
actual transmission probability is related to the interaction duration, we can write the actual probability of
I
) as
i getting infected by j (βi,j,t
`,t
g,t
g,t
I
t
βi,j,t
= atij · h(wij
, βI ) + ã`,t
ij · h(w̃ij , βI ) + ãij · h(w̃ij , βI )

∀i ∈ S, j ∈ I.

(1)

where h(·, ·) is a function to describe the transmission probability with respect to CD. It can be a form of
survival function (e.g., exponential, Weibull) or a linear function (i.e., h(w, β) = wβ, which is used in the case
g,t
`,t
g,t
t
study). atij (ã`,t
ij , ãij ) is an indicator variable showing whether eij (ẽij , ẽij ) exists. It is worth noting that
g,t
`,t
t `
atij is a known constant but ã`,t
ij and ãij are random variables with Bernoulli distribution: ãij ∼ B(Lij θ )
g
t
t
and ãg,t
ij ∼ B(θ ), where Lij = 1 if i and j share the same origin or destination at time interval t and Lij = 0

otherwise (see Section 2.1.2 for details). Therefore, we have
`,t
g,t
I
t
βi,j,t
= atij · h(wij
, βI ) + Ltij · θ` · h(w̃ij
, βI ) + θ` · h(w̃ij
, βI )

∀i ∈ S, j ∈ I.

(2)

Similarly, we define βE as the probability of a susceptible individual i ∈ S getting infected by an exposed
individual j ∈ E at time interval t if i and j contact each other for the entire time interval (βE  βI ). The
actual transmission probability considering interaction duration is
`,t
g,t
E
t
βi,j,t
= atij · h(wij
, βE ) + Ltij · θ` · h(w̃ij
, βE ) + θ` · h(w̃ij
, βE )

∀i ∈ S, j ∈ E.

(3)

Note that if i and j have been in contact, we assume the transmission probability only depends on the CD.
The variation of transmission probability due to spatial distribution is neglected in the case study because
it requires a more dedicated physical infection model and assumptions about passenger spatial distribution
in a vehicle, which is beyond the scope of this study. However, the proposed method can be extended to
t
capture the spatial effect by replacing h(wij
, βI ) with a dedicated transmission models (e.g., Wells–Riley

model (Wells et al., 1955)) and taking the distance between i and j into consideration. For example, one can
t
t
replace h(wij
, βI ) with h(wij
, stij , βI ), where stij is the distance between i and j in time interval t, and it is a

function of vehicle loads, vehicle types (e.g., double-decker vs. smallish normal buses), seating distributions,
etc.
Let γ be the probability of E → I, which is unrelated to the network. µ is the probability of I → R and
µ = µr + µd , where µr and µd are the probability of infectious people getting cured and dying, respectively.
Both of them are unrelated to the network. We summarize the transition graph for individual i at time
interval t in Figure 4.

8

Figure 4: Transition graph of individual i at time interval t

The notations and epidemic transmission mechanism allow us to write the following system equations:
pSi,t+1 = pSi,t −

X

E
βi,j,t
P(Si,t = 1, Ej,t = 1) −

j∈N
E
pE
i,t+1 = pi,t +

X

X

I
βi,j,t
P(Si,t = 1, Ij,t = 1)

(4)

I
βi,j,t
P(Si,t = 1, Ij,t = 1) − pE
i,t γ

(5)

j∈N
E
βi,j,t
P(Si,t = 1, Ej,t = 1) +

j∈N

X
j∈N

pIi,t+1 = pIi,t − pIi,t (µr + µd ) + pE
i,t γ

(6)

pR
i,t+1

(7)

=

pR
i,t

+

pIi,t (µr

+ µd )

Eq. 4 means that the infection probability of an individual in S equals to the probability of infected by
surrounding people in I plus the probability of infected by surrounding people in E. This comes from the
typical assumption of discrete Markov chain that in a time interval the probability of more than one events
happening is zero, which holds for this study because the probability of infected by both people in I and
people in E in a time interval is small.
Calculating P(Si,t = 1, Xj,t = 1) requires the joint distribution of Si,t and Xj,t , which is usually unavailable. According to the individual-based mean-field approximation, we can assume that the state of neighbors
is independent (Hethcote and Yorke, 2014; Chakrabarti et al., 2008; Sharkey, 2008, 2011). Hence, this leads
to
P(Si,t = 1, Ej,t = 1) = pSi,t pE
j,t

(8)

P(Si,t = 1, Ij,t = 1) = pSi,t pIj,t

(9)

By plugging Eqs. 8 and 9 into Eqs. 4 and 5, we can get a new group of solvable system equations.
2.3. Simulation-based solving framework
Different from the typical SEIR model, the proposed epidemic model with the individual-based PEN has
two challenges. First, the infection rate in a typical SEIR model is defined at the population level (i.e.,
homogeneous network assumption). However, in the proposed framework, we consider one-to-one contagious
behaviors at the individual level with heterogeneous contact networks. The heterogeneity is difficult to
characterize by probabilistic models (e.g., degree distributions) because contact structures are known from
the smart card data. Second, the proposed framework lies on a time-varying network, for which the contagious
behaviors and interacted individuals vary over time.
One of the solution methods for Eqs. 4 - 7 is simulation. Similar to many other complex stochastic
process, simulation can output approximate values for pX
i,t for all X ∈ {S, I, E, R} and t. The simulation
process is described in Algorithm 1, where p̄X
t (X ∈ {S, I, E, R}) is the proportion of people in class X for
time interval t. Initialization can assign some seed infectious people in the system. At each time step t, we
9

I
E
calculate the one-to-one transmission probability βi,j,t
and βi,j,t
for each person in class S, where the time

complexity is O(N 2 ). Therefore, the total time complexity of simulation is O(N 2 T ), where T is the total
number of time intervals considered. The model also requires to store the network structures and individual
states at each time step, where the space complexity is also O(N 2 T ).
Algorithm 1 Simulation-based solving algorithm
1:
2:
3:
4:
5:
6:
7:
8:
9:
10:
11:
12:
13:
14:
15:
16:

Initialize Si,0 , Ei,0 , Ii,0 , Ei,0 for all i = 1, 2, ..., N .
for t = 1, 2, ..., T do
for i = 1, 2, ..., N do
if Si,t−1 = 1 then
I
E
Calculate βi,j,t
and βi,j,t
P
P
I
E
Assign Ei,t = 1 with probability j∈I βi,j,t
+ j∈E βi,j,t
.
Let Si,t = 1 − Ei,t , and Ii,t = 0, Ri,t = 0.
else if Ei,t−1 = 1 then
Assign Ii,t = 1 with probability γ.
Let Ei,t = 1 − Ii,t , and Si,t = 0, Ri,t = 0.
else if Ii,t−1 = 1 then
Assign Ri,t = 1 with probability µ = µr + µd
Let Ii,t = 1 − Ri,t , and Si,t = 0, Ei,t = 0.
else
Assign Ri,t = 1, and Ii,t = 0, Ri,t = 0, Si,t = 0.
P
X
p̄t = (1/N ) i∈N Xi,t for all X ∈ {S, I, E, R}.
return p̄X
t for all t ∈ {1, 2, ..., T }, and X ∈ {S, I, E, R}.
Given the O(N 2 T ) of time and space complexity, the simulation-based solving framework is hard to scale

up to the whole population level (4.7 million in our case study). As we code the calculation process by
matrix operation (to improve computing efficiency), large N will easily occupy large memory and makes the
matrix operation unavailable. According to the numerical results, N ≥ 300k would cause memory errors to
a 32 GB RAM personal computer.
It is worth noting that there exists a sparse representation of the contact network (i.e. only storing the
edges (i, j) when i and j are interacted, rather than the whole network). In this way, we only have the
space and time complexity of O(hkiN T ), where hki is the average degree of the contact network, which may
simplify the simulation. However, generating this sparse representation needs a merge or join operation of
two lists of all individuals. And this operation still requires a space complexity in O(N 2 T ). Hence, future
research can be done on optimizing the algorithms of constructing contact networks for large sample sizes.
2.4. Theoretical framework
Considering computational costs, a scalable and lightweight theoretical model is proposed to handle the
epidemic calculation. The theoretical model, though simplified from agent-level simulation, can retain the
flexibility to capture the behavioral, mechanical, networked, and dynamical features of the simulation-based
models.
The framework is separated into three steps. 1) We first build up a multi-particle dynamics model for the
epidemic process to represent the individual-based model. 2) Considering properties of contact network and
multi-particle dynamics (Gao et al., 2016), an effective model is employed to represent the multi-dimensional
dynamics (individual-based) into one-dimension (mean-based). 3) Previous effective models are developed
for static network structure. To fit with the time-varying contact network, we innovatively combine the

10

effective model with a temporal network model by adding energy flow into the equations, from which we can
capture the impact of the time-varying contact networks on the entire dynamical system.
For the multi-particle dynamics model, we focus on the early stage of the epidemic process, where the
percent of susceptible people is almost 100%, and recovered people are 0%. Hence, we could use Taylor
expansion to simplify the four-dimension (S,E,I, and R) individual dynamical epidemic process described
in Eq. (4 - 7) to two dimensions (E and I):
E
pE
i,t+1 − pi,t =

X

X

E
βi,j,t
pE
j,t +

j∈N

I
βi,j,t
pIj,t − pE
i,t γ

(10)

j∈N

pIi,t+1 − pIi,t = −pIi,t (µr + µd ) + pE
i,t γ

(11)

E
In this formula, we embedded the dynamical network structure into two tensors [βi,j,t
]i,j,t ∈ RN ×N ×T and
I
[βi,j,t
]i,j,t ∈ RN ×N ×T .
I
[βi,j,t
]i,j ∈ RN ×N and

These two tensors are non-negative, and each temporal slice of these tensors (i.e., βtI =
E
βtE = [βi,j,t
]i,j ∈ RN ×N ) are symmetric due to the property of infection. According

to the previous studies (Gao et al., 2016; Tu et al., 2017), the infectious burst in this canonical system
could be captured by a one-dimensional simplification of the individual-based model. This simplification
is based on the fact that in a network environment, the state of each node is affected by the state of its
immediate neighbors. More details on the simplification can be found in Gao et al. (2016) and Tu et al.
(2017). Therefore, we can characterize the effective state of the system using the average nearest-neighbor
activity:
pE
eff,t =

1T βtE pE
t
=
1T βtE 1

P

1T βtI pIt
=
1T βtI 1

P

pIeff,t =

i∈N

j∈N

i,j∈N

i∈N

E
βi,j,t
pE
j,t

P

P

E
βi,j,t
I
βi,j,t
pIj,t

P

j∈N

P

i,j∈N

I
βi,j,t

(12)
(13)

E
N
(pIt = [pIi,t ]i ∈ RN ) is the vector of individuals’ exposed (infectious) probability.
where pE
t = [pi,t ]i ∈ R
I
1 ∈ RN is the unit vector. pE
eff,t ∈ R (peff,t ∈ R) is the effective proportion of exposed (infectious) people

in the system at time interval t. If we assume that all individuals hold a uniform probability to come into
I
E
I
I
E
contact with each other, pE
eff,t and peff,t are good proxies for p̄t and p̄t , where p̄t and p̄t are the actual
P
P
1
1
E
I
I
proportion of exposed and infectious population (i.e., p̄E
t = N
i∈N pi,t and p̄t = N
i∈N pi,t ). However,

this assumption may not hold in reality. The relaxation of the assumption will be described later. pE
eff,t and
pIeff,t allow us to reduce the individual-based equations (Eq. 10 and 11) to an effective mean-based equations:
E
E
E
I
I
E
pE
eff,t+1 − peff,t = βeff,t · peff,t + βeff,t · peff,t − peff,t γ

(14)

pIeff,t+1

(15)

−

pIeff,t

=

−pIeff,t (µr

+ µd ) +

pE
eff,t γ

where:
P

X
βeff,t

i,j∈N
= P

X
(βi,j,t
)2

i,j∈N

X
βi,j,t

,

∀X ∈ {E, I}

(16)

Considering that people’s interaction probabilities are actually heterogeneous, in practice, to relax the
uniform contact assumption, we further consider the dynamics of the mobility network on the multi-particle
P
X
systems based on Li et al. (2017), which recommends adding the energy flow ftX = (1/N 2 ) i,j∈N (βi,j,t
)2

11

(X ∈ {E, I}) into the general dynamical process:
E
E
E
I
I
E
E
E
E
I
pE
eff,t+1 − peff,t = βeff,t · peff,t + βeff,t · peff,t − peff,t γ + kE · ft + kI · ft

(17)

pIeff,t+1

(18)

−

pIeff,t

=

−pIeff,t (µr

+ µd ) +

pE
eff,t γ

+

I
kE

·

ftE

+

kII

·

ftI

E
I
where K = [kE
, kIE , kE
, kII ] are parameters to be estimated. The energy flow and corresponding parameters

are expected to capture the heterogeneous contacts in the network.
The theoretical model is calibrated from a two-layer regression method. In the first layer, given a
I
E
I
E I
trajectory of epidemic process: [(p̄E
t , p̄t )]t=1,...,T , we can replace peff,t , peff,t with p̄t , p̄t in Eq. 17 and 18.

This leads to a linear regression problem with a total of T samples:
E
E
E
I
I
E
E
E
E
I
p̄E
t+1 − p̄t = βeff,t · p̄t + βeff,t · p̄t − p̄t γ + kE · ft + kI · ft

p̄It+1

−

p̄It

=

−p̄It (µr

+ µd ) +

p̄E
t γ

+

I
kE

·

ftE

+

kII

·

ftI

t = 1, 2, ..., T

(19)

t = 1, 2, ..., T

(20)

X
where the only unknown parameters are K; βeff,t
and ftX are calculated from the constructed contact network,

and p̄X
t is given (X ∈ {E, I}). Therefore, K can be obtained for every given epidemic trajectory. The
epidemic trajectory is generated using the simulation-based solving framework for a small sample size (e.g.,
100k).
In the second layer, we aim to obtain the relationship between K and epidemic/mobility parameters (i.e.,
Θ = [βE , βI , γ, µr , µd , θ` , θg ]). For every combination of Θ, we can use the simulation model to generate
a trajectory and thus to estimate K (as we described above, the first layer regression). Therefore, based
on different values of Θ, we can estimate a series of K. Then, we assume a linear relationship between Θ
and K, and use a linear regression model to fit the relationship based on the generated Θ, K pairs. After
the two-layer regression, the theoretical model can be used to flexibly predict the epidemic process under
different policy conditions (i.e., different Θ, β E , or β I ).
E
,
The theoretical model can smoothly consider different sizes of the studied population by scaling βeff,t
I
βeff,t
, and energy flows ftI , ftE . Those parameters can be obtained once the contact network was constructed

(see Eq. 16). The scale factor can be computed empirically by comparing the dynamics (i.e. epidemic
trajectories) established on sample passengers and the whole population. A time-based pair-wisely scaling
E
I
technique is applied for each yt ∈ Φt = {βeff,t
, βeff,t
, ftI , ftE }. Let the corresponding parameters calculated

in sample passengers be yt (Sample) and in whole population be yt (Pop), where yt ∈ Φt . Then the empirical
scaling factor for yt can be calculated as:
st (yt ) =

yt (Pop)
yt (Sample)

for all yt ∈ Φt and t = 1, 2, ..., T

(21)

The empirical scaling factor is not directly the sampling rate, but also depend on the dynamical processes
and co-variances between individual travel behaviors. It is worth noting that though the generation of yt (Pop)
may be computational inefficient, it only needs to be calculated once. After obtaining st (yt ) and enforcing
this scaling to different policy experiments, we can obtain different dynamical behaviors of infectious from a
small sampled data set (i.e. using sample data to generate yt (Sample) and scale it).
Thus, this model can efficiently test different policy combinations with a low computational cost. According to the numerical test, it can evaluate one-million policy combinations for the full population (4.7
million) within seconds. The memory and computational complexity are both O(T ). This allows us to find

12

the optimal policy to control the contagion.
2.5. Reproduction number (R0 )
In epidemiology, the basic reproduction number (expressed as R0 ) of the infection can be viewed as the
expected number of cases directly generated by one case in a population where all individuals are susceptible
to infection (Fraser et al., 2009). The most important use of R0 is to determine whether an emerging
infectious disease would spread throughout the population. In a common infection model, if R0 > 1, the
infection starts to spread throughout the population, but not if R0 < 1 (see Figure 3b). In general, the
larger the value of R0 , the more difficult it is to control the epidemic (Fine et al., 2011).
In the ideal SEIR model where diseases spread uniformly over time and people have a uniform contact
probability, R0 is easy to define. To match with the discrete-time expression in this study, let β̂ be the
average number of people infected by one infectious person within one time interval in the ideal SIR system,
and µ̂ be the probability that the infectious people (I) are removed (R) within one time interval (Note that
in continuous time context, β̂ and µ̂ represents infectious rate and removal rate, respectively). The basic
reproduction number for ideal SEIR model is calculated as
∞

R0 =

∞

X
X It+1 − It
β
=
β(1 − µ)t =
(1 − µ)t
µ
I
t
t=0
t=0

where It is the number of infectious people at time interval t. Note that

It+1 −It
It

(22)

= β, ∀t only holds under

the ideal SEIR system.
In heterogeneous populations, the definition of R0 is more subtle. The definition must take into account
the fact that the contact between people is not uniform. One person may only contact a small group of
friends and be isolated from the rest of the population. On the temporal evolving side, people’s mobility
patterns may vary every day, resulting in time-varying contact networks. This defeats ideal SEIR system
assumptions. To consider the network heterogeneity Damgaard et al. (1995), we define R0 as ”the expected
number of secondary cases of a typical infected person in the early stages of an epidemic”, which focuses on
the expected direct infected population for each time step at the early stage
Let Et and It be the number of exposed and infectious people at time interval t. Given a trajectory of
epidemic process [(Et , It )]t=1,...,T (either from the simulation model or the theoretical model), we define the
equivalent reproduction number for time period T (R0 (T )) as:
R0 (T ) =

T
X
Et+1 − Et
t=0

We assume that the incubation period

1
γ

It

· (1 − µ)t

(23)

is much longer than a time interval, which holds true for most of

the diseases (e.g., in our case study, 4 days  1 h). Therefore, Et+1 − Et in this study is a good proxy for
It+1 − It in the ideal SEIR model. Comparing with the original definition in Eq. 22, if we take T to ∞ and
assume that

Et+1 −Et
It

is a constant for all t, Eqs. 23 and 22 are equivalent. This property illustrates the

reasonableness of the defined equivalent R0 .
The equivalent R0 enables flexible and fair comparison of different epidemic processes with heterogeneous
contact and time-varying networks. In the following sections, we will use the defined equivalent R0 as a major
epidemic measure for different policy discussions.

13

3. Case study
We use the Singapore bus system as a proximity to demonstrate the dynamics of epidemic spreading
through a PT network. The time-varying PEN is constructed based on daily mobility patterns in the bus
system and the epidemiological characteristics of COVID-19 is used as the case disease. A series of disease
control policies are evaluated to exhibit the sensitivity of the developed approach.1
3.1. Mobility patterns in Singapore bus system
Singapore is a city-state country where inter-city land transportation is relatively small. This provides
an ideal testbed to focus on epidemic spreading through intra-city transportation, especially for bus systems,
which count for a high proportion of modes shared in Singapore (Mo et al., 2018; Shen et al., 2019). According
to Singapore Land Transport Authority (LTA) (2018), the average daily ridership of buses is around 3.93
million, accounting for almost half of all travel modes. There are more than 368 scheduled bus routes
operated by four different operators. A total of approximately 5,800 buses are currently in operation. In the
case study, the mass rapid transit (MRT) system is neglected because a) passengers’ contacts in a bus are
more conducive for epidemic transmission compared to the MRT system, given the limited space in a bus;
b) smart card data can provide exact bus ID to identify the direct contact of passengers. The direct contact
in trains is, however, difficult to obtain from smart card data because the transactions are recorded at the
station level. To identify the car that passengers boarded on, a transit assignment or simulation model is
required (Zhu et al. (2017); Mo et al. (2020), which is beyond the scope of this study.
Though we neglected the MRT system in the case study, our proposed approach focuses on a general
modeling framework for virus spreading over PT systems. It is capable for modeling the MRT system once
the boarded-trains for each passenger are identified. Moreover, to provide a more meaningful discussion for
the omission of the MRT system, we estimate the corresponding impact in Appendix B.
3.1.1. Usage of the system
The smart card data used in this study are from August 4th (Monday) to August 31st (Sunday), 2014,
with a length of four weeks. The dataset contains 109.2 million bus trip transaction records from 4.7 million
individual smart cardholders. Given that the population of Singapore in 2014 is around 5.5 million, the
smart card data is representative of the population (accounting for 84% of the population) and can model
the epidemic spreading for the whole city. Figure 5 shows the hourly ridership distribution for one week
(average of four weeks). The ridership of weekdays shows highly regular and recurrent patterns with morning
(8:00-9:00 AM) and evening peaks (18:00-19:00). While the ridership distributions on weekends are different
from those on weekdays, there are no prominent peaks observed.
1 To facilitate future research, we uploaded the codes of this work to a GitHub repository: https://github.com/mbc96325/
Epidemic-spreading-model-on-public-transit.

14

Figure 5: Demand distribution. Numbers in x-axis represent the hour ID (e.g., 1 represents 0:00-1:00 AM). The number in
brackets at the top of each sub-graph indicates the total daily ridership

The usage of bus systems is related to daily activities, which represent mobility patterns of metro travelers
in Singapore and can influence the epidemic spreading. Figure 6a shows the distribution of trip duration
(P (T D)) in four weeks, where T D means trip duration. Most trips have a duration of fewer than 40 min.
From the inset of Figure 6a, we found the tail of P (T D) can be well characterized by an exponential function:
− TD

when T D ≥ 10 min, we have P (T D) ∼ e λtd , where λtd = 11.94 min calculated by regression. As people
tend to use MRT for long-distance travel, the duration of bus trips is relatively short. On average, the
duration of bus trips is 14.55±12.51 min (mean±standard deviation).

(a) Trip duration distribution

(b) Trip frequency distribution

Figure 6: Distribution of trip duration and trip frequency (data of 4 weeks, the inset plots are in semi-log scale). Values in
x-axis are rounded up in minute. For example, TD = 20 min includes all values from 19 to 20 min.

Figure 6b presents the trip frequency (number of trips per week) distribution for all 4.7 million smart
card holders. The similar long tail attribute is observed, which can also be quantified by an exponential
function: P (f ) ∼ e

− λf

tf

, where f is the trip frequency and λtf = 5.66 per week. On average, trip frequency

in Singapore is around 6.34±5.94 per week
In summary, Singapore has an intense usage of bus systems with high ridership and user frequency,
though the trip duration is relatively small. This implies that for highly infectious diseases that can be
infected by short-term exposure, the bus system may play a crucial platform for the epidemic spreading.

15

3.1.2. Contact networks
As discussed in Section 2.1, the PEN and local interaction network (LIN) highly depend on passengers’
mobility patterns and present time-varying properties. Figure 7 shows example networks of 100 passengers
extracted from real-world data (7:00-10:00 AM). The length of time interval τ = 1 h is used in this study.
For better visualization, these passengers are chosen from the same bus, and θ` = 1 is used for LIN. Both
these networks show high dependency on time, with various network structures across time. In PEN, only
about half of the passengers are connected during a time interval, and the connectivity changes dramatically
over time. This highlights the importance of considering time-varying networks in modeling epidemics.

(a) 7:00 - 8:00 AM (PT)

(b) 8:00 - 9:00 AM (PT)

(c) 9:00 - 10:00 AM (PT)

(d) 7:00 - 8:00 AM (Local)

(e) 8:00 - 9:00 AM (Local)

(f) 9:00 - 10:00 AM (Local)

Figure 7: Example of time-varying PEN and LIN (100 sample passengers who have used the same bus, θ` = 1)

The property of the contact network is essential for analyzing the epidemic spreading. Figure 8 summarizes the degree and CD distribution of PEN and LIN. Note that the global interaction network is, by
definition, a simple random graph with homogeneous structures. Hence, we did not plot it. Given the
time-varying properties of networks, we consider three different time intervals: morning peak (8:00-9:00
AM), noon off-peak (12:00-13:00), and evening peak (18:00-19:00). Figures 8a and 8b show that the degree
distribution of PEN displays a exponential tail (P (k) ∼ e

− λk

k

, where k is the degree), implying a significant

degree heterogeneity. Most of the nodes are of low or medium degree. The number of super-nodes with a
high degree is limited, and the maximum degree is bounded, which is reasonable given the limited capacity of

16

buses. These properties are consistent with the findings in Qian et al. (2020). Although the shapes of P (k)
for different times are similar, the exact values are still time-dependent. On weekdays, P (k) for morning
and evening peaks are similar but different from the off-peak curve. PENs in peak hours also have a larger
degree of nodes. On weekends, however, the degree distributions in the three time intervals are similar.
Figures 8c and 8d show the complementary cumulative distribution function (CCDF) of the degree for
the LIN (θ` = 1 × 10−3 is used to correspond to the case study in the following sections). CCDF is
P∞
defined as F (k) = i=k0 P (k 0 ). The reason for showing F (k) instead of P (k) is to avoiding the information
loss due to binning and reducing the noise impacts at high degree regions (Barabási et al., 2016). We
observe that the degree distribution can be approximately characterized with a truncated power low: P (k) ∼
k
(k + ksat )−γ exp(− kcut
) (dashed lines are the fitted CCDFs), where ksat accounts for low-degree saturation

and kcut accounts for high-degree cutoff. Low-degree saturation is a common deviation, which indicates that
we have fewer small degree nodes (i.e. isolated individuals in terms of social activities) than expected for a
pure power law. High-degree cutoff appears as a rapid drop in P (k) for k > kcut , indicating that we have
fewer high-degree nodes (i.e. extremely active individuals in social activities) than expected in a pure power
law.

(a) Degree (PT, weekday)

(b) Degree (PT, weekend)

(c) Degree (Local, weekday)

(d) Degree (Local, weekend)

(e) CD (PT, weekday)

(f) CD (PT, weekend)

(g) CD (Local, weekday)

(h) CD (Local, weekend)

Figure 8: Degree and contact duration (CD) distributions of PEN and LIN (data of all Singapore, θ` = 1 × 10−3 ). Note that
all figures except for (c) and (d) are empirical probability density functions. While (c) and (d) are CCDFs. The dot and dash
lines in (c) and (d) indicate empirical and fitted CCDFs, respectively. The red squares in (g) and (d) represent the value of
P (CD = 30 min) and P (CD = 60 min).

The Figures 8e and 8f, show that the contact time of PEN follows an exponential tail (P (CD) ∼ e

CD
−λ
cd

),

which is similar to the trip duration distribution (Figure 6a). There are more contacts with duration less
than 10 min in noon off-peak compared to morning and evening peaks on weekdays, while P (CD) for the
three time intervals on weekends are similar. By definition, the contact time of time-varying PEN is bounded
by 60 min (same for the LIN).
17

Figures 8g and 8h present the CD distribution of LINs. We observe a huge concentration on CD = 30 min
and CD = 60 min (see the red squares). This is because people are not traveling most of the day-time. Thus,
for a specific time interval, the duration of local interactions, for most individuals, would cover the whole
time interval given our definition of LINs. However, since we assume people only spend half of their time on
a specific origin or destination of a PT trip (see Section 2.1.2), the local CD for two people without travel
within the time interval is either 30 min (if two individuals only share a single origin or destination) or 60
min (if two individuals share both origin and destination). Therefore, there are two concentrations with
CD = 30 min and CD = 60 min. As P (CD = 30) > P (CD = 60), most people will only locally interact
with others in one place (e.g., either at home or workplace).
We also find that other local CD values are nearly uniformly distributed. Since local interaction duration
that does not equal 30 or 60 min indicates that the trip occurs or ends in this time interval, the uniform
distribution implies a Poisson start and end time of bus trips within the time interval.
3.2. Coronavirus disease 2019
COVID-19, also known as 2019-nCoV, is an infectious disease caused by ”SARS-CoV-2”, a virus closely
related to the Severe Acute Respiratory Syndrome (SARS) virus (Centers for Disease Control and Prevention
(CDC), 2020). The disease is the cause of the 2019–2020 coronavirus outbreak. Cases were initially identified
in Wuhan, China, and soon spread all over the world. The World Health Organization (WHO) declared
the outbreak of COVID-19 as a Public Health Emergency of International Concern (PHEIC) on Jan 30,
2020, and later characterized the coronavirus as a pandemic on Mar 11, 2020. Figure 9 shows the number
of confirmed (infectious), cured, and dead people from Jan 24 to Feb 20, 2020, in Wuhan. Up to Feb 20,
there are more than 40 thousand confirmed COVID-19 cases. The total number of healed and dead patients
is around 6,000 and 2,000, respectively. The sudden increase in confirmed cases on Feb 12 is due to the
revision of diagnosis criteria (adding the cases of clinical diagnosis).

Figure 9: Number of confirmed, cured and dead people in Wuhan (Jan 24 to Feb 2020; Data sources: Ding Xiang Yuan (2020)).
The inset plot is the zoom-in of the number of cured and dead people.

We select COVID-19 as the case study for the following reasons: a) COVID-19 is extremely contagious.
It is primarily spread between people via respiratory droplets from infected individuals when they cough or
sneeze. According to CDC (2020), anyone who has been within approximately 2 m of a person with COVID19 infection for a prolonged period (more than 1 or 2 min) is considered risky to get infected. Therefore, PT
18

can play a significant intermediary for such a highly contagious disease. b) Even when authors are writing
this article, COVID-19 is a big threat to global public health. Singapore is also experiencing the impact
of COVID-19 (Ministry of Health (MOH), 2020). The case study of COVID-19 can provide disease control
suggestions from the transportation side, which adds real-time value to this research.
The SEIR model parameters are chosen based on the epidemiological characteristics of COVID-19. Time
from exposure to onset of symptoms (latent or incubation period) is generally between 2 to 14 days for
COVID-19. Read et al. (2020) suggested setting the latent period as 4 days. We, therefore, have γ =
1
24×4

= 0.0104 (probability from E to I per h). According to Read et al. (2020), the transmission rate of

COVID-19 in the static SEIR model is 1.96 day−1 , which can be seen as the number of people that one
infectious person can infect per day in a well-mixed network. Therefore, assuming one person, on average,
has close contact with 100 others per day, we can calculate the hourly one-to-one infectious probability as
βI =

1.96
24×100

= 8.17 × 10−4 . Although recent studies show βE > 0 for COVID-19 (Rothe et al., 2020),

calibrating the exact value of βE is difficult due to lack of data. Since people in the latent period (group
E) usually have extremely lower probability of transmission, we arbitrarily set βE = 0.01βI . We calculate
µr and µd using data from Wuhan. Figure 10 shows the daily cure and death rate (number of cured/dead
people per day divided by the total number of confirmed people on that day) in Wuhan. The reason for the
high value on the first day may be the inaccurate data. From Figure 10, we observe the average daily cure
and death rate are approximately 1% at the early stage. Therefore, we can calculate the hourly cured and
death probability as µr = µd =

0.01
24

= 4.17 × 10−4 .

Figure 10: Daily cure and death rate in Wuhan (data sources: Ding Xiang Yuan (2020))

θ` = 1 × 10−3 is used for the status quo analysis. This value is calculated as follows. Consider a
community with 10,000 people, assume each person may have close contact with another 10 people on
average per hour locally. We therefore have θ` =

10
10,000

= 1 × 10−3 . The global interaction captures

individual’s probability of close contact with people outside his/her community. Given that the population
of Singapore is around 5.6 million, we assume one person, on average, can closely contact 10 people per day
globally. Then θg =

10
5.6×106 ×24

= 7.44 × 10−8 . Note that the number 24 in the denominator is used to get

the hourly probability.
Table 1 summarizes all parameters of the status quo analysis, which can be seen as the reference scenario.
The sensitivity analysis column indicates whether this value will be changed in the following policy analysis
sections. Specifically, the sensitivity analysis for βI , βE , µr and µd is shown in Section 3.5.1, for θg and θ`
19

is shown in Section 3.5.2.
Table 1: Parameters value for status quo analysis (reference scenario)

Category

Parameters

Value
−4

Sources

Sensitivity analysis

Epidemic

βI
βE
γ
µr
µd

8.17 × 10
8.17 × 10−6
0.0104
4.17 × 10−4
4.17 × 10−4

Read et al. (2020)
Authors assumption
Read et al. (2020)
Ding Xiang Yuan (2020)
Ding Xiang Yuan (2020)

True
True
False
True
True

Human mobility

θ`
θg

1 × 10−3
7.44 × 10−8

Authors assumption
Authors assumption

True
True

3.3. Theoretical model calibration
We first calibrate the theoretical model using the generated epidemic dynamics from the simulation model.
320 cases with different combination of parameters (Table 2) for 100k sample passengers are simulated. These
cases are fed into a regression model to obtain the parameters for the theoretical model. Figure 11 shows
the comparison of the number of infectious and exposed people between the simulation and the calibrated
theoretical model. We observe a high goodness-of-fit for the theoretical models, which implies the proposed
theoretical framework can capture the epidemic spreading through PT and SA contacts.
Figure 12 shows the comparison of the number of infectious and exposed people by time for the five
selected cases. Generally, the simulation and theoretical models show a similar number of infectious people
over time. For the number of exposed people, the two models show similar dynamic fluctuations with only
a slight difference for some periods.
After model calibration, we also calculate the scaling factors based on Eq. 21. The individual-level policy
experiments (Section 3.5.3,3.5.4,3.5.5, and 3.5.6) are evaluated based on scaled 100k sample passengers.
Table 2: Parameters value space for theoretical model calibration

Category

Epedimic

Human mobility

Parameters
βI
βE
γ
µr
µd
θ`
θg

Value space
[8.17 × 10−4 , 1 × 10−4 , 1 × 10−5 , 1.5 × 10−3 , 1 × 10−6 ]
0.01βI
0.0104
[4.17 × 10−4 , 8 × 10−4 , 1 × 10−3 , 5 × 10−3 ]
4.17 × 10−4
[1 × 10−3 , 1 × 10−2 , 1 × 10−4 , 0]
[7.44 × 10−8 , 1 × 10−7 , 1 × 10−9 , 0]

20

(a) Comparison on infectious people

(b) Comparison on exposed people

Figure 11: Comparison between simulation model and calibrated theoretical model (100k sample passengers). One dot represents
# of infectious/exposed people in a specific time interval.

(a) Comparison on infectious people

(b) Comparison on exposed people
Figure 12: Comparison of infectious/exposed people by time for 5 cases (100k sample passengers)

21

3.4. Status quo analysis
Based on the parameters in Table 1, we evaluate the epidemic process in Singapore for all smart cardholders (4.7 million) using the calibrated theoretical model. Figure 13 shows the dynamics of the number of
infectious and exposed people. We randomly assign 30 initial infectious passengers in the system. Results
show that if there are no control policies for the disease, the number of infectious people will increase to
more than 3,000 (100 times the initial value) after four weeks. This is consistent with Liu et al. (2020)’s
results on early human-to-human transmission of COVID-19 in Wuhan. The equivalent R0 is 2.667, which
is consistent with many previous estimates: 2.0–3.3 (Majumder and Mandl, 2020); 2.6 (Imai et al., 2020);
2.92 (Liu et al., 2020).
The inset plot shows the intra-day dynamics of the number of exposed people in week 4, from which we
observe the high intensity of infections from 7:00 to 22:00. The sudden increases in morning and evening
peaks for weekdays (Day 22-26) highlights the transmissibility through PT. During the weekends (Day 27
and 28), the number of exposed people shows a decreasing trend, which implies lower transmission rates on
weekends.
It is worth noting that, the increasing trends of infection is not as dramatic as many standard SEIR
models with exponential rates. The reasons may be as below. First, this case study focuses on the early
stage of the epidemic process (first month). According to the Taylor seris, exp(x) ≈ 1 + x when x is close
to zero. This explains the approximately linear trend at the early stage. Second, we consider the specific
individual-level passengers contacts. According to Sun et al., (2013), passengers usually meet with repeated
PT encounters. Therefore, the infected passengers may continue to meet with same passengers every day.
These “repeated encounters” delayed the actual transmission of virus because the probability of meeting
new people is smaller than the typical SEIR model where the population is assumed to be well-mixed.

Figure 13: Epidemic process in status quo scenario (whole population). The inset plot shows the zoom-in of the number of
exposed people from Day 22 (Monday) to Day 28 (Sunday).

3.5. Evaluation of control policies
Motivated by current epidemic control strategies worldwide in PT systems, especially the control policies
of COVID-19 exemplified in Appendix A, we can hardly find the general criteria to determine whether,
when, and where to suspend the urban PT services. The individual-based PEN developed in this work
contributes to better understanding of the spatiotemporal impacts of various PT operation strategies for
epidemic control, to facilitate the decision-making process for PT operation adjustments.

22

3.5.1. Impact of βI and µ
We first evaluate the impact of βI and µ. βI is related to people’s preventive behavior, such as wearing
masks and sanitizing hands, which results in a decrease of βI . µ is related to the hospital’s medical behavior,
such as increasing cure rate and developing vaccines, which leads to an increase in µ.
Figure 14 shows the impact of βI and µ on equivalent R0 . βI is scaled from 10−2 to 101 and µ is scaled
from 10−1 to 102 . We fixed βE = 0.01βI for all testing. Figure 14b shows that the epidemics would fade
out (equivalent R0 < 1) if transmissibility was reduced to less than 10−1 of current value. However, Figure
14c suggests that even if the cure rate is increased by 100 times, the epidemics would still happen, though
the process would be lagged (with smaller R0 ). This implies reducing transmissibility is more effective than
increasing the cure rate for COVID-19. In Figure 14a, we show the joint impact of βI and µ and the critical
bound of equivalent R0 . If βI was decreased to 32% and µ was enlarged tenfold, the equivalent R0 would be
decreased to less than 1. If the cost of controlling each parameter is given, this graph can help to optimize
the controlling strategies with limited costs.

(b) Impact of βI

(a) Joint impact of βI and µ

(c) Impact of µ

Figure 14: Impact of βI and µ on equivalent R0 . The scale of a parameter means multiples of the parameter with respect
to the status quo scenario. For example, ”scale of βI ” = 10 means 10 times βI of the status quo scenario (i.e., the new
βI = 10 × 8.17−4 = 8.17−3 )

3.5.2. Impact of trip occurrence rate
One of the typical control strategies for the epidemic is decreasing the trip occurrence rate in a city.
At the average level, this is equivalent to reducing the total contact time, and total squared contact time2 .
Figure 15 shows the impact of different control percentage of trips (i.e., reducing the percentage of total
contact and squared contact time). We observe that controlling one trip (PT or local or global) cannot
eliminate the epidemic. Based on current parameter settings, reducing PT trips contribute more to the
control of the epidemic process than the other two. The impact of reducing trips to R0 is generally linear
unless the reduction percentage is sufficiently large. When all trips are reduced by more than 80%, the
2 Let x , and y be the average number of trips and the average contact time per trip at time interval t, respectively. Then
t
t
the total contact time at t is xt yt ; total squared contact time is c × xt yt2 , where c is used to capture the difference of squared
sum and sum of squares. If we reduce the number of trips to αxt (α < 1), the total contact time will be reduced to αxt yt . The
total square contact time will be reduced to αc × xt yt2 . Hence, the trip occurrence rate is roughly linear with the total contact
and squared contact time.

23

reduction rate for R0 starts to accelerate. When all trips were decreased by 98%, the spreading process
would fade out, which implies travel control can only be effective at an extreme level. This is corresponding
to Wu et al. (2020)’s statement that a 50% reduction in inter-city mobility in Wuhan has a negligible effect
on the COVID-19 epidemic dynamics.

Figure 15: Impact of controlling trip occurrence rate (whole population)

3.5.3. Impact of distributing departure time
From a transportation perspective, the trip concentration in morning and evening peaks can strengthen
people’s interaction in PT. It is possible to reduce people’s contact time on PT by distributing their departure
time. The distributing process is as follows. Given the departure time flexibility constraints (e.g., ±30 min),
we generate new departure time for passengers so that passengers with the same boarding stops are assigned
to different buses as dispersed as possible.
Figure 16 shows the influence of distributing departure time with different flexibility (from 0 to ±110
min). We observe a decline in equivalent R0 as the departure time flexibility increases. This is because
higher flexibility allows more dispersed riding on the bus; thus, fewer contacted passengers. However, the
effectiveness of distributing passengers is very limited. With ±110 min flexibility, there is only a 2.2%
decrease in R0 (from 2.667 to 2.607).

Figure 16: Impact of spreading departure time

24

3.5.4. Impact of closing bus routes
As what has been summarized in Section 1, the closure of bus routes is an in-practice implemented
strategy from the transportation side to reduce people’s close-contacts during the outbreak of COVID-19.
We assume that the suspension of bus service is a sign of travel restrictions on the corresponding bus routes.
While keeping the SA contact network the same, we evaluate four different strategies of closing various
percentages of bus routes (from 10% to 90%): a) Close from high demand to low demand routes (H-L). b)
Close from low demand to high demand routes (L-H). c) Close by randomly picking bus routes (Random).
d) Close by different local planning areas. We assume that passengers who originally take these closed bus
routes will change to alternative routes if available; otherwise, they will cancel their trips.
Figure 17 shows the effect of closing different percentage of bus routes. We observe that the H-L policy
shows a convex curve on R0 while the L-H policy shows a concave curve. Under the same percentage of
closed bus routes, closing high demand routes brings a larger controlling effect on R0 . Closing the top 40%
high-demand bus routes can reduce the equivalent R0 by 15.3%.
It is also important to look at how many passengers are affected by each strategy. The affected passengers
are defined as those who cannot find alternative bus routes when the original routes are closed. As expected,
for the same closing percentage of bus routes, the H-L strategy affected more passengers than the other
two policies. However, we find that the H-L strategy is more effective in terms of R0 reduction per affected
passengers. If we fix the percentage of affected passengers at approximately 22% (black dashed line), the
H-L strategy can reduce R0 to 2.25, while random and L-H strategies can only reduce R0 to 2.41 and 2.50,
respectively. This may be because passengers in high demand bus routes are more influential (e.g., with
a higher degree in the PEN) in the system. Therefore, to control the epidemic with fewer people getting
affected, PT agencies should close buses from high to low demand routes.

Figure 17: Impact of closing bus routes. The black dashed lines are auxiliary lines to analyze the effectiveness of different
polices under same number of affected people

Figure 18a shows the percentage of reduction in R0 resulting from the closure of bus routes by planning
areas, while Figure 18b shows the corresponding percentage of affected PT passengers. Generally, the high
reduction in R0 is the result of a high number of affected passengers. Closing bus routes in the main business
and residential areas in the Southern part of Singapore Island leads to higher controlling effects of epidemics
than closing other areas. However, to minimize the impact on passengers’ daily travel, PT agencies should
first close bus routes in regions with relatively high R0 reduction and a low number of affected passengers,

25

such as core central business district (CBD) areas. Passengers who take buses crossing core CBD areas can
easily find alternative routes. Thus, the concentrated demands at CBD areas can be distributed to other
less crowded routes, which leads to a R0 reduction and less number of affected passengers.

(a) Reduction in percentage of equivalent R0

(b) Percentage of affected PT passengers
Figure 18: Impacts of closing bus routes by planning areas

3.5.5. Impact of limiting maximum bus load
Although closing bus routes can postpone the epidemic spreading, it also brings huge inconvenience to
society, for example, decreasing people’s accessibility to hospitals. A moderate alternative way is preserving
the PT supplies but limiting the maximum bus load to reduce passengers’ interaction. Figure 19 shows the
impact of this policy. We test the maximum bus load from 26 to 5. Passengers who cannot board the bus
due to this policy are assumed to cancel their trips (these passengers are called affected passengers). To
compare with closing bus routes strategies, the x-axis is set as the percentage of affected passengers. Only
26

the H-L strategy is plotted as it is the most effective one among all closing bus routes strategies. We find
the policy of limiting the maximum bus load can only take effects when the available maximum bus load is
small. With the same percentage of affected passengers, it is not as effective as closing bus routes from high
demand to low demand. However, since this policy preserves the city’s mobility capacity, it can be seen as
a more moderate way to control epidemics compared with directly closing bus routes.

Figure 19: Impact of limiting maximum bus load. MBL: maximum bus load. CP: close percentage of the H-L strategy

3.5.6. Impact of isolating critical passengers
Ideally, a more precise pandemic policy goes into the individual-level. The government could find out
those influential passengers who are potential to spread viruses considerably and get them isolated at an early
stage. Individual-based policies can outperform region-based or population-level policies in effectiveness and
flexibility. However, due to the computational cost, it is hard to optimize the isolation options for each
individual directly. Hence, we employed an isolation method based on k-core decomposition. Different from
traditional degree-based methods, k-core method shows higher impacts on the dynamics of multi-particle
systems (Kitsak et al., 2010; Morone et al., 2019; Borge-Holthoefer and Moreno, 2012; Yang et al., 2017).
A k-core of a graph G is a maximal connected subgraph of G in which all vertices have a degree of at
least k. Each vertex in a k-core is connected to at least k other nodes (i.e., has a degree of at least k). A
high k number represents the highly concentrated structure of the local network, which indicates the most
clustered part in the whole network. Nodes in a core with larger k usually have larger degrees on average
(Dorogovtsev et al., 2006). In the context of infectious diseases, if one node in a high k-core is infected, it
has, on expectation, > k 2 times chances to spread the disease to other nodes in that core in one-time step
compared to an arbitrary node (if the network is under scaling law) (Serrano and Boguná, 2006). Therefore,
we designed the policy by first limiting the nodes in high k-cores, which means limiting the more influential
nodes. The population in a higher k-core is always lower than that in a lower k-core. Thus, by applying this
policy, we can isolate a small portion of people to limit the spreading of the disease.
Figure 20 shows the impact of isolating passengers in different k-cores and the corresponding number
of isolated passengers. For comparison purposes, we also evaluate a random policy. For each k-core, the
random policy isolates the same number of randomly picked passengers in the system, which corresponds to
implementing isolation at the population level. Since the number of passengers with a core number greater
than 5 is low, the reduction in R0 is not significant. However, isolating all 4-core passengers, which accounts
for 5% of the whole population, the equivalent R0 is reduced from 2.667 to 2.446 (8.3%), which shows higher
27

effectiveness than any other region-based or route-based policies in Section 3.5.4. We also observe that the
k-core isolating method can outperform the benchmark random isolating method.

Figure 20: Impact of isolating critical passengers. ”base” and ”k-core” scenarios indicate no isolation and isolation of people of
core number ≥ k in the PEN, respectively.

4. Conclusion and discussion
This paper proposed a general time-varying weighted PEN to model the spreading of infectious diseases
over the PT system. The social-activity contacts at both local and global level are also considered. The
network is constructed using smart card data as an undirected graph, in which a node refers to a PT
passenger; an edge refers to a pair of passengers staying in the same vehicle; the weight of an edge captures
the CD. We employ the SEIR diagram—a general diagram to model the influenza-like disease—to model the
disease dynamics using the recent global outbreak of COVID-19 as a case study. A scalable and lightweight
theoretical framework is derived to capture the time-varying and heterogeneous network structures, which
enables to solve the problem at the whole population level with low computational costs.
We use the PT smart card data from Singapore as a proximity to understand the general spatiotemporal
dynamics of epidemic spreading over the PT networks in one month. The status-quo analysis shows that
the COVID-19 infected population is expected to increase by 100 times of their initial value by the end of
the month without any disease control enforcement. A series of disease control and prevention scenarios are
envisioned from both public health policy and PT operations sides. From the public health side, the model
sheds light on people’s preventative behavior. Wearing face masks and sanitizing hands, are considered
the most effective measures to control the spreading of the epidemic; however, an increased cure rate can
only postpone the outbreak of the disease. From the perspective of PT operation adjustments, several
policies are evaluated, including reducing trip occurrences, enlarging departure time flexibility, closing bus
routes, limiting maximum bus loads, and isolating critical passengers. In general, the control of the epidemic
process starts to take effect, with over 80% of all trips being canceled. The equivalent R0 can be reduced
to 1 if over 98% of trips are banned. In terms of bus operation policies, distributing departure times and
limiting maximum bus loads can slightly decelerate the spreading process. Closing high-demand bus routes,
especially in the main business areas, is more effective than the closure of low-demand bus routes. The most
effective approach is isolating influential passengers at the early stage, in which the epidemic process can be
significantly reduced with a small proportion of people being affected.

28

4.1. Policy implications
Many policy implications can be derived from the case study. On the public health side, the government
should encourage people to take preventative behaviors, such as wearing face masks and sanitizing hands,
to reduce the transmission probability. The travel restriction policy can take effect—with an equivalent R0
less than 1—only at the extreme travel, such as in Hubei Province, China, where all travels were banned
during the outbreaks of COVID-19 in Feb 2020.
On the PT operation side, according to our models, partial closure of bus routes and limiting the maximum
bus load can postpone the spreading of epidemics. The most effective way is closing bus routes with high
demands, especially those crossing the CBD areas. In practice, a (partially) shutdown of PT services is a
serious decision for authorities, many related issues, such as equity and accessibility, should be considered
to determine how to design the suspension of PT services in the pandemics.
The influential passengers with large core numbers can be identified based on smart data and they should
be suggested to isolate themselves or reduce travels for prevention purpose. In addition, all entities should
cancel events with a high number of participants to avoid generating large k-core contact networks. However,
the identification and privacy projection of influential passengers are the two ends of the balance for epidemic
control. The government should also carefully achieve the trade-off between privacy and urgency in fighting
against the spreading of epidemics.
4.2. Limitations and future works
Several limitations of this study are as follows: 1) Some parameters of the model (e.g., θ` , θg ) are
determined by the authors’ assumptions, which hurts the credibility of the results. Although we end up with
a reasonable R0 , suggesting the values of these parameters are reasonable, more parameter calibration jobs
should be done in the future. 2) Policy evaluations are based on some ideal assumptions. In the real world,
many unexpected results can happen. For example, closing bus routes may decrease people’s accessibility to
the hospital, thus, decrease the cure rate. The government should think cautiously from multiple perspectives
before applying any control strategies. 3) This study did not model the contacts of passengers at trains due
to difficulties in identifying the vehicles that passengers belong to. Future research can incorporate a transit
assignment model (e.g., Zhu et al., 2017; Mo et al., 2020) to infer passengers’ boarding trains and construct
the PEN by trains. Meanwhile, due to the large space in a train, the variation of transmission probability
due to passengers’ spatial distribution should also be captured. 4) Other modes of transmission than contact
transmission are not considered (e.g., infectious passengers contaminating surfaces), which may result in
under-estimation of transmissibility of PT systems. 5) Population infected and mobility heterogeneity is
neglected in this study. In reality, the infectious probability may depend on age, gender and health conditions.
And people with different occupations may have various mobility characteristics (e.g., in Singapore, working
pass holders and maids may not use PT frequently). The demographics distribution can be incorporated in
the future.
Future works include the following: 1) Elaborate on the SA contacts based on other data sources (e.g.,
mobile phone data) and extend N to the whole population. Due to a lack of data, the contacts of social
activities are simplified and N is assumed to be PT users in this paper. Though PT users in Singapore account
for 84% of the population, future research can combine different data sources to model the SA contacts for
the whole population in more details (Wang et al., 2018). Given the challenges in collecting real-world
trajectory data at the population level, future research can also model the epidemic spreading based on
synthetic trajectory data. The synthetic data can be generated by combining household travel surveys and

29

mobile phone data (Müller et al., 2020). And the data can include individual’s socio-demographic information
to model infection heterogeneity. 2) Incorporate spatial effect and model transmission probability more finely.
The current transmission probability between two individuals only depends on the contact duration. The
contact distance, passenger density, and distribution on a vehicle can be considered in future research. 3)
Conduct case studies in cities with COVID-19 outbreaks (e.g., Wuhan, New York City) to validate the
model. These case studies can calibrate the model based on ground truth data, quantify the contribution
of disease transmission by PT systems, predict the epidemic spreading, and evaluate the effects of different
policies. 4) Incorporate the time-varying epidemic and mobility parameters to better predict the reality.
Although this study does not attempt to predict and reproduce the COVID-19 spreading, the proposed
model can potentially better fit the epidemic process, given the more fine-grained framework. However, the
complexity in the real-world lies on the time-varying mobility and epidemic patterns. Future research can
make the epidemic parameters (Θ) as time-dependent (Θ(t)), instead of constant, to better fit the reality.
5) Propose a generative contact network construction model. One of the computational bottle network in
this paper is to construct individual-level contact network using smart card data. Future study can propose
a generative network construction model with compressed demand and supply information. This can be
used to easily conduct PT-based policy evaluation and scenario testing without heavily constructing actual
contact network.
5. Author Statement
The authors confirm contribution to the paper as follows: study conception: B. Mo, K. Feng, Y. Shen;
experiments design: B. Mo, K. Feng, J. Zhao, D. Li, C. Tam, Y. Yin; data collection: B. Mo, Y. Shen;
analysis and interpretation of results: B. Mo, K. Feng; draft manuscript preparation: B. Mo, K. Feng Y.
Shen. All authors reviewed the results and approved the final version of the manuscript.
6. Acknowledgements
The research is sponsored by the Natural Science Foundation of China (71901164) and the Natural Science
Foundation of Shanghai (19ZR1460700). The study is also supported by the National Research Foundation,
the Prime Minister’s Office of Singapore under the CREATE programme, and the SMART’s Future Urban
Mobility IRG. Yu Shen is sponsored by Shanghai Pujiang Program (2019PJC107). Yafeng Yin would like to
acknowledge partial support from National Science Foundation, U.S. (CMMI-1854684). The authors thank
Prof. Caroline Buckee from Harvard T.H. Chan School of Public Health for her comments on this work.
Appendix A. Worldwide COVID-19 control policies in urban PT systems
In practice, since the outbreak of COVID-19 in late January 2020, a variety of epidemic control strategies
in PT systems, such as the requirement of PT riders to wear face masks, the sterilization of bus and metro
carriages, the adjustment of PT operation schedules, the closure of bus routes, etc., have been implemented
during the outbreak of COVID-19.
In China, the requirement of wearing face masks in PT systems has been successively implemented in
many provinces since late January of 2020. In addition, a variety of PT operation control strategies have
also been enforced in many cities. In cities of Hubei Province, especially in Wuhan, along with the lockdown
policies to control the spreading of COVID-19, almost all PT services have been shut down since Jan. 23rd

30

and 24th, whereas the patients with severe symptoms are transported by ambulance. After the lockdown
and travel restrictions of Hubei Province, the PT operation adjustment strategies implemented in other
Chinese cities were largely diverse. Different from Wuxi with only 8% of arterial bus routes kept running, in
Nanjiang, another major city of Jiangsu Province, the PT services were still in operation but with shortened
operation hours and dispatching frequencies. In Shanghai, both inter-provincial PT services and the bus
services between rural districts like Qingpu and Jinshan were closed from Jan. 27th, but most of the urban
PT services remained in operation by limiting the maximum passenger loads.
Outside China, in Italy, where the reported COVID-19 cases dramatically increased in March 2020, the
suspension of PT has been officially proposed in the Lombardy area, where the urban PT service (such as in
Milan) was still in normal operation. In London, The Transport for London (TfL) is running reduced service
across the network in London, closing up to 40 stations. No services of Waterloo and City line was provided
since March 30, 2020. Many US cities have seen reduced services, including Boston and Washington D.C.,
In cities of other countries with fewer COVID-19 reported cases (such as Singapore), the PT services were
kept normal with more frequent sterilization.
Appendix B. Impact of neglecting the MRT system
In the case study, we neglect the passengers’ interaction in the MRT system since the smart card data
cannot provide the direct contacts of passengers in the train. To capture the contact at the train, an
detailed transit assignment model is needed to identify which train the passengers boarded given the origin,
destination, and train schedule information. This is beyond the scope of this study. However, we can analyze
the demand patterns of the MRT system and provide a simplified estimation for the impact of MRT system
in the epidemic spreading.
Figure B.21 shows the demand distribution of MRT trips. Compared to the bus trips (Figure 5), the
temporal distribution patterns are very similar while the average demand of MRT is around 67% of the bus
demand. For the MRT trip duration and frequency distributions (Figure B.22), both of them follow the
exponential tail. The average trip duration for MRT is 26.88 min (14.55 min for bus), and the average trip
frequency is 4.26 per week (6.34 per week for bus).
According to Eq. 3 and 2, the infection probability between two individuals are proportional to the
contact duration (i.e., h(w, β) is a linear function). Based on the theoretical solution method (Eq. 17
P
X
and 18), the epidemic spreading process can be quantified by the total contact duration ( i,j∈N βi,j,t
)
P
X
2
and total squared contact duration ( i,j∈N (βi,j,t ) ). As the demand patterns of MRT and bus trips are
similar, we assume the contact time of passengers in the MRT is proportional to the trip duration (i.e., the
average contact duration of MRT is 1.85 times that of bus). Therefore, the total contact duration in MRT
is around 0.67 × 1.85 = 1.24 times that of bus, and the total squared contact duration in MRT is around
0.67 × 1.852 = 2.29 times that of bus.
To estimate the impact of ignorance MRT, we add the inferred passengers’ contact duration in MRT to
the total contact and squared contact duration, and calculate the new R0 for the status quo scenario. We test
the add-MRT scenario. The estimated R0 is 3.192 (compared to 2.667 for the scenario without considering
MRT). Therefore, the omission of MRT reduces the R0 by around 16.3% based on the simplified estimation.
Future research should capture passengers’ interaction on MRT to better model the epidemic process.

31

Figure B.21: MRT demand distribution. Numbers in x-axis represent the hour ID (e.g., 1 represents 0:00-1:00 AM). The number
in brackets at the top of each sub-graph indicates the total daily ridership

(a) MRT Trip duration distribution

(b) MRT Trip frequency distribution

Figure B.22: Distribution of MRT trip duration and trip frequency (data of 4 weeks, the inset plots are in semi-log scale)

References
Anderson, R.M., Anderson, B., May, R.M., 1992. Infectious diseases of humans: dynamics and control.
Oxford university press.
Balcan, D., Colizza, V., Gonçalves, B., Hu, H., Ramasco, J.J., Vespignani, A., 2009. Multiscale mobility
networks and the spatial spreading of infectious diseases. Proceedings of the National Academy of Sciences
106, 21484–21489.
Barabási, A.L., et al., 2016. Network science. Cambridge university press.
Borge-Holthoefer, J., Moreno, Y., 2012. Absence of influential spreaders in rumor dynamics. Physical Review
E 85, 026116.
Bóta, A., Gardner, L.M., Khani, A., 2017a. Identifying critical components of a public transit system for
outbreak control. Networks and Spatial Economics 17, 1137–1159.
Bóta, A., Gardner, L.M., Khani, A., 2017b. Modeling the spread of infection in public transit networks: A
decision-support tool for outbreak planning and control, in: Transportation research board 96th annual
meeting.
Brockmann, D., Helbing, D., 2013. The hidden geometry of complex, network-driven contagion phenomena.
science 342, 1337–1342.

32

CDC, 2020. Interim u.s. guidance for risk assessment and public health management of healthcare personnel
with potential exposure in a healthcare setting to patients with 2019 novel coronavirus (2019-ncov). URL:
https://www.cdc.gov/coronavirus/2019-ncov/hcp/guidance-risk-assesment-hcp.html.
Centers for Disease Control and Prevention (CDC), 2020. Coronavirus disease 2019 (covid-19) situation
summary. URL: https://www.cdc.gov/coronavirus/2019-ncov/summary.html.
Chakrabarti, D., Wang, Y., Wang, C., Leskovec, J., Faloutsos, C., 2008. Epidemic thresholds in real networks.
ACM Transactions on Information and System Security (TISSEC) 10, 1–26.
Colizza, V., Barrat, A., Barthélemy, M., Vespignani, A., 2006. The role of the airline transportation network
in the prediction and predictability of global epidemics. Proceedings of the National Academy of Sciences
103, 2015–2020.
Coviello, L., Franceschetti, M., Garcı́a-Herranz, M., Rahwan, I., 2016. Predicting and containing epidemic
risk using friendship networks, in: 2016 Information Theory and Applications Workshop (ITA), IEEE. pp.
1–7.
Damgaard, B., Wettergren, A., Kirkegaard, P., 1995. Social and sexual function following ileal pouch-anal
anastomosis. Diseases of the colon & rectum 38, 286–289.
Diekmann, O., Heesterbeek, J.A.P., 2000. Mathematical epidemiology of infectious diseases: model building,
analysis and interpretation. volume 5. John Wiley & Sons.
Ding Xiang Yuan, 2020. Covid-19 real-time data. URL: https://ncov.dxy.cn/ncovh5/view/pneumonia.
Dorogovtsev, S.N., Goltsev, A.V., Mendes, J.F.F., 2006. K-core organization of complex networks. Physical
review letters 96, 040601.
El Shoghri, A., Liebig, J., Gardner, L., Jurdak, R., Kanhere, S., 2019. How mobility patterns drive disease
spread: A case study using public transit passenger card travel data, in: 2019 IEEE 20th International
Symposium on” A World of Wireless, Mobile and Multimedia Networks”(WoWMoM), IEEE. pp. 1–6.
Fine, P., Eames, K., Heymann, D.L., 2011. “herd immunity”: a rough guide. Clinical infectious diseases 52,
911–916.
Fraser, C., Donnelly, C.A., Cauchemez, S., Hanage, W.P., Van Kerkhove, M.D., Hollingsworth, T.D., Griffin,
J., Baggaley, R.F., Jenkins, H.E., Lyons, E.J., et al., 2009. Pandemic potential of a strain of influenza a
(h1n1): early findings. science 324, 1557–1561.
Gao, J., Barzel, B., Barabási, A.L., 2016. Universal resilience patterns in complex networks. Nature 530,
307–312.
Gatto, M., Mari, L., Bertuzzo, E., Casagrandi, R., Righetto, L., Rodriguez-Iturbe, I., Rinaldo, A., 2012.
Generalized reproduction numbers and the prediction of patterns in waterborne disease. Proceedings of
the National Academy of Sciences 109, 19703–19708.
Gonzalez, M.C., Hidalgo, C.A., Barabasi, A.L., 2008. Understanding individual human mobility patterns.
nature 453, 779–782.
Hajdu, L., Bóta, A., Krész, M., Khani, A., Gardner, L.M., 2019. Discovering the hidden community structure
of public transportation networks. Networks and Spatial Economics , 1–23.
Hethcote, H.W., Yorke, J.A., 2014. Gonorrhea transmission dynamics and control. volume 56. Springer.
Hufnagel, L., Brockmann, D., Geisel, T., 2004. Forecast and control of epidemics in a globalized world.
Proceedings of the National Academy of Sciences 101, 15124–15129.
Imai, N., Cori, A., Dorigatti, I., Baguelin, M., Donnelly, C.A., Riley, S., Ferguson, N.M., 2020. Report 3:
Transmissibility of 2019-ncov. Reference Source .
International Association of Public Transport (UITP), 2018. Statistics brief - World metro figures 2018.

33

URL: https://www.uitp.org/sites/default/files/cck-focus-papers-files/Statistics%20Brief%
20-%20World%20metro%20figures%202018V4 WEB.pdf.
Karong’oi, A.N., et al., 2018. Comparing different approaches of epidemiological modeling .
Keeling, M., Rohani, P., 2007. Stochastic dynamics. Modeling Infectious Diseases in Humans and Animals
, 190–230.
Kitsak, M., Gallos, L.K., Havlin, S., Liljeros, F., Muchnik, L., Stanley, H.E., Makse, H.A., 2010. Identification
of influential spreaders in complex networks. Nature physics 6, 888–893.
Land Transport Authority (LTA), 2018.
ridership.

Public transport utilisation: Average daily public transport

URL: https://data.gov.sg/dataset/public-transport-utilisation-average-public-

transport-ridership.
Li, A., Cornelius, S.P., Liu, Y.Y., Wang, L., Barabási, A.L., 2017. The fundamental advantages of temporal
networks. Science 358, 1042–1046.
Litvinova, M., Liu, Q.H., Kulikov, E.S., Ajelli, M., 2019. Reactive school closure weakens the network of
social interactions and reduces the spread of influenza. Proceedings of the National Academy of Sciences
116, 13174–13181.
Liu, K., Yin, L., Ma, Z., Zhang, F., Zhao, J., 2019. Investigating physical encounters of individuals in urban
metro systems with large-scale smart card data. Physica A: Statistical Mechanics and its Applications ,
123398.
Liu, T., Hu, J., Xiao, J., He, G., Kang, M., Rong, Z., Lin, L., Zhong, H., Huang, Q., Deng, A., et al., 2020.
Time-varying transmission dynamics of novel coronavirus pneumonia in china. bioRxiv .
Majumder, M., Mandl, K.D., 2020. Early transmissibility assessment of a novel coronavirus in wuhan, china.
China (January 23, 2020) .
Mari, L., Bertuzzo, E., Righetto, L., Casagrandi, R., Gatto, M., Rodriguez-Iturbe, I., Rinaldo, A., 2012.
Modelling cholera epidemics: the role of waterways, human mobility and sanitation. Journal of the Royal
Society Interface 9, 376–388.
Miller, P., de Barros, A.G., Kattan, L., Wirasinghe, S., 2016. Public transportation and sustainability: A
review. KSCE Journal of Civil Engineering 20, 1076–1083.
Ministry of Health (MOH), 2020. Past update on covid-19 local situation). URL: https://www.moh.gov.sg/
covid-19/past-updates.
Mo, B., Ma, Z., Koutsopoulos, H., Zhao, J., 2020. Capacity-constrained network performance model for
urban rail systems. Transportation Research Record. .
Mo, B., Shen, Y., Zhao, J., 2018. Impact of built environment on first-and last-mile travel mode choice.
Transportation research record 2672, 40–51.
Morone, F., Del Ferraro, G., Makse, H.A., 2019. The k-core as a predictor of structural collapse in mutualistic
ecosystems. Nature physics 15, 95–102.
Müller, S.A., Balmer, M., Charlton, B., Ewert, R., Neumann, A., Rakow, C., Schlenther, T., Nagel, K.,
2020. Using mobile phone data for epidemiological simulations of lockdowns: government interventions,
behavioral changes, and resulting changes of reinfections. medRxiv .
Pastor-Satorras, R., Castellano, C., Van Mieghem, P., Vespignani, A., 2015. Epidemic processes in complex
networks. Reviews of modern physics 87, 925.
Perra, N., Baronchelli, A., Mocanu, D., Gonçalves, B., Pastor-Satorras, R., Vespignani, A., 2012. Random
walks and search in time-varying networks. Physical review letters 109, 238701.
Potter, G.E., Smieszek, T., Sailer, K., 2015. Modeling workplace contact networks: The effects of organiza-

34

tional structure, architecture, and reporting errors on epidemic predictions. Network Science 3, 298–325.
Qian, X., Sun, L., Ukkusuri, S.V., 2020. Scaling of contact networks for epidemic spreading in urban transit
systems. arXiv preprint arXiv:2002.03564 .
Read, J.M., Bridgen, J.R., Cummings, D.A., Ho, A., Jewell, C.P., 2020. Novel coronavirus 2019-ncov: early
estimation of epidemiological parameters and epidemic predictions. medRxiv .
Rothe, C., Schunk, M., Sothmann, P., Bretzel, G., Froeschl, G., Wallrauch, C., Zimmer, T., Thiel, V., Janke,
C., Guggemos, W., et al., 2020. Transmission of 2019-ncov infection from an asymptomatic contact in
germany. New England Journal of Medicine .
Salathé, M., Kazandjieva, M., Lee, J.W., Levis, P., Feldman, M.W., Jones, J.H., 2010. A high-resolution
human contact network for infectious disease transmission. Proceedings of the National Academy of
Sciences 107, 22020–22025.
Serrano, M.Á., Boguná, M., 2006. Percolation and epidemic thresholds in clustered networks. Physical
review letters 97, 088701.
Sharkey, K.J., 2008. Deterministic epidemiological models at the individual level. Journal of Mathematical
Biology 57, 311–331.
Sharkey, K.J., 2011. Deterministic epidemic models on contact networks: Correlations and unbiological
terms. Theoretical population biology 79, 115–129.
Shen, Y., Mo, B., Zhang, X., Zhao, J., 2019. Built environment and autonomous vehicle mode choice: A
first-mile scenario in singapore, in: Transportation Research Board 98th Annual Meeting.
Small, M., Tse, C.K., 2005. Small world and scale free model of transmission of sars. International Journal
of Bifurcation and Chaos 15, 1745–1755.
Smieszek, T., 2009. A mechanistic model of infection: why duration and intensity of contacts should be
included in models of disease spread. Theoretical Biology and Medical Modelling 6, 25.
Smieszek, T., Balmer, M., Hattendorf, J., Axhausen, K.W., Zinsstag, J., Scholz, R.W., 2011. Reconstructing
the 2003/2004 h3n2 influenza epidemic in switzerland with a spatially explicit, individual-based model.
BMC infectious diseases 11, 115.
Smieszek, T., Fiebig, L., Scholz, R.W., 2009. Models of epidemics: when contact repetition and clustering
should be included. Theoretical biology and medical modelling 6, 11.
Stehlé, J., Voirin, N., Barrat, A., Cattuto, C., Colizza, V., Isella, L., Régis, C., Pinton, J.F., Khanafer, N.,
Van den Broeck, W., et al., 2011. Simulation of an seir infectious disease model on the dynamic contact
network of conference attendees. BMC medicine 9, 87.
Sun, L., Axhausen, K.W., Lee, D.H., Cebrian, M., 2014. Efficient detection of contagious outbreaks in
massive metropolitan encounter networks. Scientific reports 4, 5099.
Sun, L., Axhausen, K.W., Lee, D.H., Huang, X., 2013. Understanding metropolitan patterns of daily
encounters. Proceedings of the National Academy of Sciences 110, 13774–13779.
Tu, C., Grilli, J., Schuessler, F., Suweis, S., 2017. Collapse of resilience patterns in generalized lotka-volterra
dynamics and beyond. Physical Review E 95, 062307.
Wang, J., Wang, X., Wu, J., 2018. Inferring metapopulation propagation network for intra-city epidemic
control and prevention, in: Proceedings of the 24th ACM SIGKDD International Conference on Knowledge
Discovery & Data Mining, pp. 830–838.
Wells, W.F., et al., 1955. Airborne contagion and air hygiene. an ecological study of droplet infections.
Airborne Contagion and Air Hygiene. An Ecological Study of Droplet Infections. .
Wu, J.T., Leung, K., Leung, G.M., 2020. Nowcasting and forecasting the potential domestic and international

35

spread of the 2019-ncov outbreak originating in wuhan, china: a modelling study. The Lancet .
Xie, X., Li, Y., Chwang, A., Ho, P., Seto, W., 2007. How far droplets can move in indoor environments–
revisiting the wells evaporation-falling curve. Indoor air 17, 211–225.
Yang, Y., Nishikawa, T., Motter, A.E., 2017. Small vulnerable sets determine large network cascades in
power grids. Science 358, eaan3184.
Yang, Y., Sugimoto, J.D., Halloran, M.E., Basta, N.E., Chao, D.L., Matrajt, L., Potter, G., Kenah, E.,
Longini, I.M., 2009. The transmissibility and control of pandemic influenza a (h1n1) virus. Science 326,
729–733.
Zhu, Y., Koutsopoulos, H.N., Wilson, N.H., 2017. A probabilistic passenger-to-train assignment model based
on automated data. Transportation Research Part B: Methodological 104, 522–542.

36

