From individual-based epidemic models to
McKendrick-von Foerster PDEs: A guide to modeling
and inferring COVID-19 dynamics

arXiv:2007.09622v2 [q-bio.PE] 9 Jul 2021

Félix Foutel-Rodier∗1,2 , François Blanquart1,3 , Philibert Courau1 ,
Peter Czuppon1,4 , Jean-Jil Duchamps5 , Jasmine Gamblin1 ,
Élise Kerdoncuff1,6 , Rob Kulathinal1,7 , Léo Régnier1 , Laura Vuduc1 ,
Amaury Lambert†1,2 , and Emmanuel Schertzer†8
1

SMILE Group, Center for Interdisciplinary Research in Biology UMR 7241,
Collège de France, CNRS, INSERM U 1050,
PSL Research University, Paris, France
2

Laboratoire de Probabilités, Statistique & Modélisation UMR 8001,
Sorbonne Université, CNRS, Université de Paris, Paris, France
3

4

Infection, Antimicrobials, Modeling, Evolution UMR 1137,
Université de Paris, INSERM, Paris, France

Institute for Evolution and Biodiversity, University of Münster, 48149 Münster, Germany
5

Laboratoire de mathématiques de Besançon UMR 6623,
Université Bourgogne Franche-Comté, CNRS, F-25000 Besançon, France
6

7

Institut de Systématique, Biodiversité, Évolution UMR 7205,
Muséum National d’Histoire Naturelle, CNRS, Paris, France

Department of Biology, Temple University, Philadelphia, PA, USA
8

Faculty of Mathematics, University of Vienna,
Oskar-Morgenstern-Platz 1, 1090 Wien, Austria

Abstract
We present a unifying, tractable approach for studying the spread of viruses
causing complex diseases that require to be modeled using a large number of types
(e.g., infective stage, clinical state, risk factor class). We show that recording each
infected individual’s infection age, i.e., the time elapsed since infection,
1. The age distribution n(t, a) of the population at time t can be described by
means of a first-order, one-dimensional partial differential equation (PDE)
known as the McKendrick-von Foerster equation.
2. The frequency of type i at time t is simply obtained by integrating the probability p(a, i) of being in state i at age a against the age distribution n(t, a).
The advantage of this approach is three-fold. First, regardless of the number of types,
macroscopic observables (e.g., incidence or prevalence of each type) only rely on a
one-dimensional PDE “decorated” with types. This representation induces a simple
∗
†

First author.
Co-last authors.

1

methodology based on the McKendrick-von Foerster PDE with Poisson sampling to
infer and forecast the epidemic. We illustrate this technique using French data from
the COVID-19 epidemic.
Second, our approach generalizes and simplifies standard compartmental models
using high-dimensional systems of ordinary differential equations (ODEs) to account
for disease complexity. We show that such models can always be rewritten in our
framework, thus, providing a low-dimensional yet equivalent representation of these
complex models.
Third, beyond the simplicity of the approach, we show that our population model
naturally appears as a universal scaling limit of a large class of fully stochastic
individual-based epidemic models, where the initial condition of the PDE emerges
as the limiting age structure of an exponentially growing population starting from
a single individual.

Contents
1 Introduction
1.1 Challenges posed by complex diseases such as COVID-19
1.2 Decorated age-structured epidemic models . . . . . . . .
1.3 Generic stochastic model assumptions . . . . . . . . . . .
1.4 Statement of the main results . . . . . . . . . . . . . . .
1.5 Inference on the French COVID-19 epidemic . . . . . . .
1.6 Connection with ODE models . . . . . . . . . . . . . . .
1.7 Relation with previous works and outline . . . . . . . . .
2 Two Feynman-Kac formulæ
2.1 Assumptions and notation . . . . . . . . . . . . . . . .
2.2 McKendrick-von Foerster PDE: Weak solutions . . . .
2.3 A forward Feynman-Kac formula . . . . . . . . . . . .
2.4 Dual CMJ process and backward Feynman-Kac formula

.
.
.
.

.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.

3
3
4
6
7
10
11
14

.
.
.
.

15
15
17
18
22

3 Proofs of the main results

23

4 Inference procedure
4.1 Deriving the likelihood . . . . . . .
4.2 Parametrization of the model . . .
4.3 Inference with the admission model
4.4 Inference with the occupancy model

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

26
27
27
29
30

A Appendix
A.1 Numerical simulation of the PDE . . . . . . . . . . .
A.2 Predicted number of entrances in a state . . . . . . .
A.3 Likelihood computation . . . . . . . . . . . . . . . .
A.4 Best fitting prevalence curves under admission model

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

39
39
40
40
41

2

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

1
1.1

Introduction
Challenges posed by complex diseases such as COVID-19

The transmission of pathogens between species is a global concern [11, 36]. As such
zoonotic episodes are expected to become increasingly common in humans, it is critical
to develop analytic tools that can quickly transform epidemiological observations into
informed public policy in order to mitigate and control epidemics.
A novel coronavirus, SARS-CoV-2, has recently crossed the species barrier into humans and, within months, has rapidly spread to all corners of our planet [57]. The
sheer scale of this pandemic has overburdened our medical infrastructure, caused fatalities estimated well into millions, and shut down entire economies. Remarkably, the rapid
spread of COVID-19 and its consequences can be attributed to the unique life cycle of a
30,000 base pair single-stranded virus. SARS-CoV-2 is an airborne pathogen transmitted by both symptomatic and asymptomatic carriers in close proximity to non-infected
individuals. Milder COVID-19 symptoms include a dry cough, fever, and/or shortness
of breath while more serious cases include respiratory failure and eventual death. With
millions of infections and hundreds of thousands of documented deaths and recoveries, the
COVID-19 pandemic is providing a wealth of independent estimates of important clinical
characteristics that can help predict health outcomes specific for a country or region.
It quickly became understood that accurate descriptions of the life cycle of this disease
needed to distinguish between several stages of the disease, referred to as compartments,
depending on whether an infected individual is infectious or not, symptomatic or not,
hospitalized, etc. However it remains unclear to what extent making precise predictions
of the dynamics of such a complex disease requires to have a precise knowledge of clinical
features such as incubation period, generation time, and duration times between infection,
symptom establishment, hospitalization, recovery and death, to know how these durations
correlate and what are the exact probabilities of transition between stages.
In this work, we consider a fully stochastic, generic epidemiological model with an
arbitrary number of compartments, that encompasses life cycles of most complex diseases
and that of COVID-19 in particular. We show how structuring the infected population
by its infection age, i.e., time elapsed since infection, allows us to decouple dependencies
between stages and to time. More specifically, when the population size is large enough,
the joint evolution of all compartment sizes can be described by means of a linear, firstorder partial differential equation (PDE) known as the McKendrick-von Foerster equation
describing the number n(t, a) of infecteds of (infection) age a at time t. The boundary
condition at age 0 is driven by the infection rate from infecteds of age a, averaged over
all possible courses of infection, and the number of individuals of age a in compartment
i at time t is obtained by thinning n(t, a) by a factor p(a, i) which is the probability of
being in compartment i conditional on having age a, averaged over all possible courses of
infection.
In the case of COVID-19, we display a simple procedure to infer these parameters,
some from the biological literature and most from time series of numbers of severe cases,
hospitalized cases, discharged patients and deaths that can be applied easily to any regional or national dataset. We also allow for time inhomogeneity in the infection rate to
account for temporary mitigation measures such as lockdowns or social distancing. We
apply this procedure to French COVID-19 data from March to May 2020 and estimate
various parameters of interest including the reproduction number in different phases of
3

the epidemic (before, during, and after lockdown) and biological parameter values that
we compare to empirical estimates.

1.2

Decorated age-structured epidemic models

The large population size limit of our stochastic model is a PDE “decorated” with compartments. This point of view extends the usual sets of ODEs used in epidemiology,
and allows us to represent in the same framework a large class of deterministic epidemic
models. Before describing the stochastic model underlying such decorated PDEs, let us
illustrate this notion by recalling the well-known derivation of the classic SIR set of ODEs
from an age-structured model.
Consider the solution (n(t, a); t, a ≥ 0) to the following partial differential equation:
∂t n + ∂a n = 0
Z
∀t ≥ 0, n(t, 0) = S(t)

∞

n(t, a)τ (a)da
0

∀a ≥ 0, n(0, a) = x0 g(a)
Z ∞
∀t ≥ 0, S(t) = 1 −
n(t, a)da.

(1)

0

where 0 ≤ x0 ≤ 1, and g, τ ≥ 0 fulfill
Z ∞
g(a)da = 1,

Z

∞

τ (a)da < ∞.
0

0

Equation (1) was first proposed to describe the dynamics of an epidemic where infected individuals are structured by their age of infection, and is known as the KermackMcKendrick model [34]. In this context, the age of an individual refers to the time elapsed
since its infection, and not to its actual age. Then, n(t, a) is the density at time t of all
individuals with age (of infection) a, and S(t) the density of individuals still susceptible
to the disease. The differential term describes the aging process: the age of an individual
increases linearly with time at rate one. The interpretation of the age boundary condition
of (1) is that individuals with age a infect susceptible individuals at a rate τ (a) that only
depends on their age.
Remark 1. It is important to note that n(t, a) counts all individuals that have been
infected at time t − a, and not only infective individuals with age a. Thus, Eq. (1)
lacks the usual recovery term. Moreover, τ (a) is not the average rate at which infective
individuals with age a yield infections, but the average infection rate of any individual
with age a. (The former is obtained from the latter by discounting all individuals with age
a that are not infectious anymore.)
In order to recover the SIR model, suppose that τ is given by
∀a ≥ 0,

τ (a) = βe−γa ,

for some γ, β > 0. Further define
Z ∞
∀t ≥ 0, I(t) =
n(t, a)e−γa da,
0

Z
R(t) =
0

4

∞

n(t, a)(1 − e−γa )da,

Then a simple calculation shows that (S, I, R) solves the following well-known system of
ODEs:
Ṡ = −βIS
(2)
I˙ = βIS − γI
Ṙ = −γI.
The previous expressions have an interesting probabilistic interpretation. Consider a
Markov process (X(a); a ≥ 0) with two states I and R. Suppose that it starts from I
and jumps to R at rate γ. The process (X(a); a ≥ 0) can be interpreted as describing
the sequence of states (infective then recovered) visited by a typical individual in the
microscopic model underlying (2). Then, clearly
p(a, I) := P(X(a) = I) = e−γa ,
so that

Z

p(a, R) := P(X(a) = R) = 1 − e−γa ,

∞

Z
n(t, a)p(a, I)da,

I(t) =

∞

n(t, a)p(a, R)da.

R(t) =

(3)

0

0

Furthermore, suppose that a typical infected individual yields new infections at constant
rate β while it is in state I. Then, the mean number of new infections occurring in the
time interval [a, a + da] is
βe−γa da = τ (a)da.
The picture that emerges from this simple calculation is that, instead of keeping track
of the number of individuals in each compartment, one can consider the age structure of
the population, given by Eq. (1). The dynamics of the age structure is uniquely prescribed
by the average number τ (a) of infections that an individual yields at age a. The individual
counts in each compartment can then be recovered by integrating against the age structure
the one-dimensional marginals of a process (X(a); a ≥ 0) that describes the sequence of
compartments visited by a typical individual in the population. We say that the PDE
is “decorated” with compartments, as the process (X(a); a ≥ 0) is used to recover the
counts in the compartments, and only influences the dynamics of the infection which is
described by the sole Eq. (1) through the average infection rate τ (a).
This viewpoint has several advantages compared to the usual ODE setting of (2).
First, we can make sense of (3) for any process (X(a); a ≥ 0). If this process is not
Markovian, the number of individuals in each compartment no longer solves a system of
ODEs similar to (2). Hence, this approach allows to go beyond the usual ODE framework.
This generalization is of great modeling interest since a hypothesis underlying sets of
ODEs is that the sojourn times in each compartment and the time between successive
infections are exponentially distributed. In particular they cannot account for sojourn
time distributions that are peaked around a value, which have been reported for instance
for COVID-19 [39, 55].
Second, regardless of the number of compartments, the age structure of the population
is described by the same one-dimensional PDE. This is particularly valuable when models
have a large number of compartments, as in the context of COVID-19 [12, 17, 19, 47],
as it avoids the use of high-dimensional systems of ODEs that are cumbersome to study
mathematically. However, this requires to work with the PDE (1) rather than with ODEs,
resulting in a mild computational cost.
Third, Eq. (1) only involves the mean number of infections τ (a) induced by individuals
at age a averaged over all compartments. In particular, it is unnecessary to assess to which
5

compartments individuals belong when they yield new infections. This is in contrast with
the usual ODE framework, where for each compartment an infection rate needs to be
prescribed. As we will see, τ (a) relates to well-known epidemiological quantities that can
be assessed directly from the data.
The main contribution of our work is to show that such decorated age-structured
models arise naturally as the law of large numbers limit of a wide class of general stochastic
epidemic models that we now introduce.

1.3

Generic stochastic model assumptions

We consider a population model in which individuals are either susceptible, if they have
not yet met the disease, or infected. Our definition of infected is broader than usual: an
individual is infected if it has been infected in the past. In particular, individuals that
have recovered or died from the disease are still infected, even if they are not infective
anymore. At any point in time, an infected individual is in one of several states, that will
also be referred to as compartments, types, classes, or stages. The set of all such states
is denoted by S and is assumed to be finite. Depending on the disease complexity, the
number of stages can vary. In the SARS-CoV-2 example, typical stages are asymptomatic,
mild case, severe case, hospitalized, intensive care unit, recovered, and dead (see Figure 5).
We assume that upon infection a susceptible individual immediately changes state and
never becomes susceptible anymore (ruling out multiple infections, in particular), and
that it will eventually end in one of two states: recovered or dead. The sequence of states
visited by an individual x is then encoded by a stochastic process Xx := (Xx (a); a ≥ 0)
valued in S, where the random variable Xx (a) is the state of x at age of infection a. We
call (Xx (a); a ≥ 0) the life-cycle process.
Each individual is further endowed with a random point process Px on [0, ∞), called
the infection point process. Each atom of Px gives the age at which x produces a secondary
infection. The pair (Px , Xx ) characterizes the course of the infection of individual x. We
assume that these pairs, for all individuals x, are i.i.d. copies of the same pair (P, X) that
describes the infection of a typical individual in the population.
In order to make the mathematical treatment of the model easier, we make the simplifying assumption that susceptible individuals are always in excess (branching assumption),
and that more than two secondary infections cannot occur simultaneously. The epidemic
is then described by a Crump-Mode-Jagers process [29, 51]: an individual x infected at
time σx will produce Nx new secondary infections at times σx + A1 , . . . , σx + ANx , where
(A1 , . . . , ANx ) are the atoms of Px , that is ,
Px =

Nx
X

δA i .

i=1

(This branching hypothesis is relaxed in a recent work by some of the authors [18].)
Lastly, we superimpose time heterogeneity to this process by means of a contact rate
(c(t); t ≥ 0) valued in [0, 1] thinning the infection process. More precisely, if t is a potential
time of infection for individual x, we ignore the infection with probability 1 − c(t). This
contact rate can model the effect of vaccination, or density-dependence (i.e., relaxing
the branching assumption due to an excess of removed or of deceased individuals), or of
governmental mitigation measures (i.e., social distancing, lockdown).
The infection process is more formally constructed in Section 2.1.
6

Remark 2. As already discussed in the previous section, in the SIR example S = {I, R},
and (X(a); a ≥ 0) is a Markov process started from I that jumps to R at rate γ. Moreover,
the infection point process is given by
X
P=
δAi 1{X(Ai )=I}
Ai ∈P

where P is a homogeneous Poisson point process on [0, ∞) with intensity β.
Remark 3. We emphasize that the pairs (Px , Xx ) are assumed to be independent, but
not the variables Px and Xx . In the simple SIR example they are not independent since
there can be no atoms of Px after the recovery time. In the same spirit, one could assume
that the infection potential of a given individual is reduced once in the hospital and that
individuals with many atoms in their infection process Px (high infectiosity) are identified
and isolated.

1.4

Statement of the main results

The stochastic epidemic models we consider here are fairly general and can exhibit quite
complex dependencies (i) between states and time, due to the lack of any Markov-type
assumption, (ii) between states, due to possibly hidden structuring variables impacting the
life cycle, (iii) between state and infection rate, and (iv) between past and future infection
events. The main result of this work is that despite this apparent complexity, most of this
complexity vanishes when the size of the population is large. More specifically, we show
that in the limit of large populations (obtained by starting from a large initial population
or as a consequence of natural exponential growth), the population of infected individuals
structured by age (of the infection) can be described by means of a one-dimensional PDE,
and that the counts in each compartment are recovered by decorating this PDE with the
life-cycle process. The limiting expression only depends on:
1. The average infection rate
τ (da) := E(P(da)),
formally defined as the intensity measure of P. We make the simplifying assumption
that τ has a density w.r.t. the Lebesgue measure and, with a slight abuse of notation,
we still denote it by τ (a).
2. The one-dimensional marginals of the life-cycle process
p(a, i) := P(X(a) = i).
We prove two main theorems that are two laws of large numbers for the age and compartment structure in the population: one started from a large number of individuals, and
the other from a single individual.
Large initial population. Let us start the population with a large number N of infected individuals at time t = 0, with i.i.d. initial infection ages with law g. (See Section 2.1 for a formal definition of the initial age.) Define the empirical measure of ages
and compartments at time t as
X
µN
δ(t−σx ,Xx (t−σx )) (da × {i}),
(4)
t (da × {i}) :=
σx <t

7

where σx denotes the infection time of x, and the sum is taken over all individuals x
infected before time t. The measure µN
t is a random point measure that encodes the ages
and compartments of all individuals that have been infected before time t.
Let us also introduce nN
i (t), the number of individuals in compartment i at time t,
defined as
X

:=
nN
(t)
1{Xx (t−σx )=i} = µNt [0, ∞) × {i} .
i
σx <t

Theorem 1 (N individuals). Start the population with N individuals with i.i.d. initial
ages distributed according to g. Then, for any t > 0, the following convergence holds in
the weak topology
1 N
µ (da × {i}) −→ n(t, a)p(a, i)da a.s.
N →∞
N t
where (n(t, a); t, a ≥ 0) is the solution to
∂t n + ∂a n = 0
Z

∞

n(t, a)τ (a)da

(5)

n(t, a)p(a, i)da a.s.

(6)

∀t ≥ 0, n(t, 0) = c(t)
0

∀a ≥ 0, n(0, a) = g(a).
As a consequence, for any t > 0,
1 N
n (t) −→
N →∞
N i

Z

∞

0

The limiting age structure of the population is thus described by Eq. (5), which is a
linear version of Eq. (1), known as the McKendrick-von Foerster equation. Note that it
also has an additional c(t) term accounting for the reduced contact rate, resulting in a
time heterogeneity. As in Section 1.2, the number of individuals in each compartment
is recovered by decorating the PDE with the one-dimensional marginals of the life-cycle
process.
After lockdown onset. Our second result displays a similar, but more subtle, convergence in the case when the process is supercritical, where natural growth leads by itself
to large population sizes. We say that the process is supercritical if
Z ∞
τ (a)da > 1,
0

in which case there exists α > 0 such that
Z ∞
e−αa τ (a)da = 1.
0

(The parameter α is the Malthusian parameter of the CMJ process when c ≡ 1.) Let
Z(t) denote the total population size at time t and assume that Z(0) = 1, i.e., we start
from a single individual. Suppose that (tK ; K ≥ 0) is a sequence of stopping times (with
respect to the natural filtration of the process, see Section 3) such that tK → ∞ on the
non-extinction event. By a slight abuse of notation, denote by µK
t the empirical measure
of ages and types as in (4), but under the assumption that the contact rate at time t is
equal to c(t − tK ) where c is equal to 1 for negative arguments. We are motivated by
modeling a situation where the infection is separated into two distinct phases:
8

1. The epidemic develops until a certain random time tK . For instance, tK could be
the time at which the number of recorded deaths exceeds a large threshold K. We
assume no suppression before tK .
2. We let the contact rate vary after time tK according to the function (c(t−tK ); t ≥ 0),
e.g., due to mitigation measures and/or behavioral changes (i.e., lockdown phase).
In this setting, we can derive the following version of the law of large numbers for ages
and compartments.
Theorem 2 (One individual). Suppose that the process is supercritical and that the population is started from one individual. Conditional on non-extinction:
1. There exists a r.v. W∞ such that W∞ > 0 a.s. and
X
e−αtK −→ W∞ in probability.
σx <tK

K→∞

2. For any t > 0, we have
e−αtK µK
tK +t (da × {i}) −→ W∞ n(t, a)p(a, i)da
K→∞

in probability for the weak topology, where (n(t, a); t, a ≥ 0) is the solution to (5)
with initial condition g(a) = αe−αa .
This result states that, when the large population size is obtained by natural population growth, the population has an exponentially distributed initial age profile with a
random size W∞ determined by the early infection events. Moreover, the parameter of
the exponential distribution corresponds to the exponential growth rate of the epidemic
prior to the enforcement of control measures. This result can prove useful in applications,
as the exponential growth rate can be readily estimated from incidence data, whereas
the age structure of the population can hardly be directly assessed. It is a quite generic
phenomenon that the macroscopic behavior of population models started from a few individuals is described by a deterministic system, with a random initial condition resulting
from the stochasticity of the initial population growth [2, 4].
Summary. The macroscopic behavior of the epidemic is characterized by the sole intensity measure τ and dictates an explicit age structure of the population. The class
structure is deduced by integrating the life-cycle process against the limiting age profile.
This suggests an alternative point of view on epidemic models, as age-structured models
decorated with classes.
In order to validate our approach, we use those deterministic approximations to infer
epidemiological parameters (reproduction number before and during lockdown) from recent empirical observations, and show that our findings are in accordance with the current
literature.

9

Figure 1: Best fit of the admission model. Solid lines correspond to the number of hospital
admissions, ICU admissions and deaths predicted by the admission model. The dots are
the corresponding observed values. The dispersion of the observations is mainly due to
unreported data during the weekends, that are only reported at the start of the following
week.

1.5

Inference on the French COVID-19 epidemic

We have illustrated the practical interest of our approach by carrying out parameter
inference on data from the early French COVID-19 epidemic. We focus on two important
inference aspects of this epidemic: providing estimates for key epidemiological quantities,
such as the reproduction number that allows to assess the impact of control measures;
and predicting the number of individuals in ICU and hospital to monitor the pressure on
the healthcare system.
In our framework, the first task only requires a simple and parsimonious model that
can be adjusted on incidence data, whereas fitting the number of individuals in ICU
requires a more complex model that better accounts for the population heterogeneity.
The early COVID-19 epidemic in France. After a rapid increase in the number
of detected cases and deaths, the French government issued a first nation-wide lockdown
from March 17 2020 to May 11 2020. From March 18 2020, it has provided publicly
available daily reports of the number of ICU and hospital admissions, hospital deaths, as
well as the number of occupied ICU and hospital beds, and discharged individuals. The
daily number of detected cases was also reported, but was considered as unreliable during
this period due to the high variation in the number of tests performed. No additional
control measure was enforced during this period.
Estimating epidemiological parameters from incidence data. In order to estimate the impact of lockdown we consider a parsimonious model that requires to estimate
few parameters. It is illustrated in Figure 5, and we refer to it as the admission model.
Upon infection, individuals either develop a mild form of COVID-19 from which they will
recover, or a more severe form that will eventually lead to a hospital admission. Then,
hospitalized individuals either recover and are discharged after some amount of time, or
are moved to ICU. Finally, individuals in ICU either die or recover. A more detailed
description of the model and its parameters is given in Section 4.3.
We have fitted this model to the following three time series: daily number of admissions
in hospital and ICU, and daily deaths. Fitting such “incidence” time series only requires
to estimate the entrance time in each compartment, and not the corresponding sojourn
times. The best fitting model is represented in Figure 1, and the inference procedure is
10

described in Section 4. We see that our simple model reproduces quite well the shapes
of the three incidence time series. The estimated reproduction number after lockdown
is Rpost = 0.745, and that before lockdown is Rpre = 3.25. Thus we estimate that the
lockdown yielded a reduction of the reproduction number by a factor 4.36. Moreover, the
estimated number of infections having occurred before March 18 2020 is W = 9.85 × 105 .
All these estimates are in line with that of other studies on the same dataset [47, 50].
Fitting prevalence data. Our second objective is to fit three additional time series:
the number of occupied hospital and ICU beds, and the number of discharged individuals.
Using the simple admission model only yields a poor fit of these new times series, see
Figure 7. We have identified two main causes for this discrepancy. First, we have made
the simplifying assumption that individuals are always admitted to ICU prior to death.
However, it has been reported that a large fraction of deaths do not involve a preliminary
ICU admission [38], and our assumption leads to a fraction of deaths among ICU patients
much higher than that previously reported. Second, there are many heterogeneities in
the population, such as the (actual) age, that are known to play an important role in the
severity of the symptoms of COVID-19 and that are not accounted for.
Thus, we used a more detailed model to reproduce all six time series, which is illustrated in Figure 6 and referred to as the occupancy model. Again, a detailed description
of the model and its parameters is available in Section 4.4. The main two differences with
the admission model are that a fraction of individuals die shortly after hospital admission,
and that we distinguish between individuals who recover fast after their admission and
individuals who recover slowly. The best-fitting model is displayed in Figure 2. Again,
it reproduces quite well the shapes of all the time-series. Under the occupancy model,
the estimated reproduction number after lockdown is Rpost = 0.734 and the estimated
number of infections before March 17 2020 is W = 9.52 × 105 . These estimates are close
to those obtained under the admission model, indicating that the predictions made by
the simple admission model are quite robust to the addition of model details.
Overall, our inference work suggests that a simple model can be used to determine
“global” epidemiological parameters, such as the reproduction number and total number
of infections, whereas obtaining a prediction for the number of individuals in hospital or
ICU requires to use a more detailed model that accounts for population heterogeneity.
Moreover, it demonstrates that decorated age-structured models can be readily used to
carry out parameter inference in the context of COVID-19, even when the underlying
compartment structure is quite complex.
Section 4 contains a detailed description of the inference procedure, as well as a comparison of the various estimates that we obtain with estimates currently available in the
literature.

1.6

Connection with ODE models

Section 1.2 shows that the SIR model can be seen as a decorated age-structured model,
with well-chosen Markov life-cycle process and Poisson infection point process. This
section extends this representation to a broader class of ODE models. We will be interested

11

Figure 2: Best fit of the admission model. The solid lines correspond to the number
of deaths, discharges, occupied ICU and hospital beds and ICU and hospital admissions
predicted by the occupancy model. The dots are the corresponding observed values.

in solutions to the following set of ODEs:
∀i ∈ S,

ṅi (t) = S(t)

X

βji nj (t) +

j∈S

j∈S

S(t) = 1 −

X

X

nj (t).

qji nj (t)
(7)

j∈S

The parameter βij ≥ 0 gives the rate of new infections from individuals in compartment
i such that the newly infected individual starts in compartment j. The matrix T with
entries (βij ) is referred to as the transmission matrix. For i 6= j, qij ≥ 0 corresponds to
transition rate from compartment i to compartment j. The transition matrix with entries
(qij ) is denoted by Q, and we further impose that
X
qij .
∀i ∈ S, qii = −
j6=i

This class of ODE models encompasses many common epidemic models, including the
SIR and SEIR models, as well as all models described in [8, Chapter 4] for instance.
Proposition 3.
1. Suppose that (X(a); a ≥ 0) is a Markov process with jump matrix
Q = (qij ; i, j ∈ S), and that conditional on the life-cycle process, P is a Poisson
point process with rate λi when X(a) = i. Then, if (n(t, a); t, a ≥ 0) is a solution
to (1),
Z
∞

n
ei (t) =

n(t, a)p(a, i)da

(8)

0

solves (7) with βij = λi p(0, j).
2. The solution of (7) with transmission and transition matrices T and Q can be
written as (8) if and only if rank(T ) = 1.
12

Proof. By differentiating both sides of (8) w.r.t. time, we obtain
Z ∞
Z ∞
d
∂a n(t, a)p(a, i)da
∂t n(t, a)p(a, i)da = −
n
ei (t) =
dt
0
0
Z ∞
n(t, a)∂a p(a, i)da.
= n(t, 0)p(0, i) +
0

By using the boundary condition of (1) and the fact that (X(a); a ≥ 0) is a Markov
process with generator Q we get
Z ∞
Z ∞
X
X
d
n(t, a)
qji p(a, j)da
n(t, a)
λj p(a, i)da +
n
ei (t) = p(0, i)S(t)
dt
0
0
j∈S
j∈S
X
X
= S(t)
p(0, i)λj n
ej (t) +
qji n
ej (t)
j∈S

j∈S

from which the first item follows.
It is clear that if βij = λi p(0, j) then rank(T ) = 1. Fix some T and Q. If rank(T ) = 1,
then it can be decomposed as
∀i, j ∈ S,

βij = λi pj

where (pj ; j ∈ S) is a probability vector and λi ≥ 0. This decomposition can for instance
be recovered from
X
βij
βij , pj =
λi =
.
λ
i
j∈S
Consider a Markov process (X(a); a ≥ 0) with transition matrix Q and X(0) distributed
as (pj ; j ∈ S). If P is such that infections occur at rate λi when X(a) = i, the first item
proves that (7) can be written as (8).
The previous result provides a simple criterion for a system of ODEs to be represented
as a decorated age-structured PDE. This criterion has already been proposed previously
and is referred to as the “separable mixing” assumption [14, 16]. A direct consequence of
this result is that not all ODE models can be represented using a single decorated agestructured PDE. However many models fulfill the requirement that rank(T ) = 1, including
models with a single infectious state, those where new infected individuals always start
in the same state, and all classical models exposed in [8, Chapter 4]. In that sense, our
framework greatly extends the usual systems of ODEs widely used in epidemic modeling.
An important situation where rank(T ) > 1 is that of heterogeneous contact rates
in the population. For instance, the contact rate could depend heavily on the (actual)
age group to which individuals belong, and more contacts are made within the same
age class than between classes. A second example is that of spatial heterogeneity, where
contacts are more likely to occur between spatially close individuals. It remains possible
to derive a representation of (7) in the case rank(T ) > 1 using an age-structured model,
but this would require to use a multi-dimensional version of (1), which is a straightforward
extension of this model.

13

1.7

Relation with previous works and outline

Deterministic epidemic models where the infectivity depends on the individuals’ age of
infection were first introduced in [34], and their mathematical properties have been further
studied thoroughly [13, 45, 52], see [28] for a recent account. However, these models have
received surprisingly little attention in applications compared to their ODE counterpart,
which have been widely used for instance in the context of COVID-19 [12, 17, 19, 46, 47].
In this direction, let us mention [23] where an epidemic model with memory is applied
to the French COVID-19 data. We hope that our work illustrates well the practical
potential of such general models. The relation between age-structured and ODE epidemic
models exposed in Section 1.2 is known since their very introduction [34], and has been
acknowledged multiple times since then [7, 15, 28, 41].
In the most general formulation of a CMJ process, individuals can carry a trait valued
in an abstract measure space that encodes all the information about their infection [29, 51].
We have restricted this information to the sequence of compartments visited by each
individual, but we could have included some additional details, such as the evolution of the
viral load for instance, which could be modeled as a continuous trait following a diffusion.
Our result would carry over to the general setting, with a modified limiting equation
in Theorem 1 which has already been proposed in [41, Eq. (2.5)] and [42, Chapter IV,
Section 1.3]. (Note that none of these works is concerned with the underlying stochastic
model.) However, we believe that our current formalism, where the state of an infected
individual can be described by a discrete set of compartments, is flexible enough for
applications, while being easier to grasp than the general case.
Non-Markov epidemic models have already been investigated, see e.g. [3, 5, 44, 49].
The idea of representing a general branching population by its age structure has a rich
history in probability theory [20, 22, 27, 29, 30, 31, 32, 54] and the connection with
the McKendrick-von Foerster PDE has been acknowledged several times [20, 27]. In the
latter two works, the authors allow for birth and death rates that may depend not only
on abundances of each type, but also on the whole age structure of the population. This
impressive level of generalization comes at the cost of assuming that the process describing
the evolution of the empirical measure on ages and types is Markovian. In particular, birth
and death rates are not allowed to depend on past individual birth events. The Markov
property then allows the use of a generator for the empirical measure and with some
extra finite second moment assumptions on the intensity measure, this approach allows
the authors to obtain a law of large numbers and a central limit theorem.
Even if the current work is not as mathematically challenging as that alluded to
above, we believe that our point of view does deserve to be highlighted in the current
sanitary crisis since it provides both a general modeling framework and an efficient inference methodology. Furthermore, since we ignore finite population effects, our proofs
are quite elementary compared to [20, 27] and should be accessible to a much wider audience interested in such a modeling approach. Finally, as far as we can tell, the duality
result exposed in Section 2.4 is new and can presumably be extended to more general
branching processes where birth and death rates are allowed to be frequency-dependent.
In [18], some of the authors of the present work show that this duality result has a natural
counterpart in a model with a finite but large population.
Outline. The remainder of the paper is organized as follows. Section 2 is devoted to the
study of Eq. (5). After providing a formal construction of the branching process that we
14

consider in Section 2.1, the definition of a weak solution to (5) is given in Section 2.2. Then,
we derive two probabilistic representations of this solution: we show in Section 2.3 that
it corresponds to the first moment of the branching process that we are studying, when
viewed as a random measure on the ages of infection; Section 2.4 provides a construction
of the weak solution using a dual genealogical process. The two laws of large numbers are
proved in Section 3. Finally, Section 4 describes the inference procedure, and compares
the estimates that we obtain to known estimates from the literature.

2
2.1

Two Feynman-Kac formulæ
Assumptions and notation

CMJ branching process with suppression. Recall that the infection process is modeled by a Crump-Mode-Jagers (CMJ) branching process [29, 43] with no death, starting
from one individual called the progenitor (or root of the tree). It can be briefly constructed
as follows.
Using the Ulam-Harris labeling, the population can be indexed by
U := {∅} ∪

∞
[

Nn .

n≥1

The set U encodes a tree where xi := (x, i) is the i-th child of x. Each individual x ∈ U
is characterized by a pair (Px , Xx ) embodying respectively the processes of secondary
infection events from x and of types carried by x. Each pair (Px , Xx ) is an i.i.d. copy of
the pair (P, X) with law L , except when x is the root, where it is distributed as (P̃, X̃)
with law L˜ (more on that below).
An infection time σx can be assigned to all individuals inductively as follows, with
the convention that σx = ∞ for individuals that are not infected. Set σ∅ = 0. Then, if
σx < ∞ has been defined, let A1 , . . . , ANx denote the atoms of Px in increasing order.
That is,
Nx
X
Px =
δA i
i=1

with A1 < · · · < ANx . Set σxi = ∞ for i > Nx , and, independently for each i ≤ Nx , set
(
σx + Ai with probability c(σx + Ai )
σxi =
∞
with probability 1 − c(σx + Ai ),
where we recall that (c(t); t ≥ 0) is the contact rate. This amounts to trimming the tree
by pruning the subtree stemming from x with probability 1 − c(σx ), see Figure 3.
Initial shifted law. In order to connect the distribution of the CMJ to the McKendrickvon Foerster equation, we allow the progenitor to have an initial age with an arbitrary
distribution. Let A be a r.v. distributed according to some density g. Define the infection
time of ∅ as σ∅ = −A. The secondary infections induced by the progenitor occur at some
e1 , . . . , σ∅ + A
e e , where (A
e1 , . . . , A
e e ) are the atoms of a point process P
e defined
times σ∅ + A
N
N
as
X
e=
P
1{Ai >A} δAi ,
Ai ∈P

15

t=0

Figure 3: The initial individual (P̃, X̃) is represented by a black segment. In Section 2.1,
we assume that at time t = 0, the age of the initial individual (length of the blue segment)
is distributed according to a probability density g. If a branching event is observed at time
t (see e.g., black dots), the infection occurs with probability c(t). In the CMJ, this amounts
to prune the corresponding subtree with probability c(t) (dotted red tree).

e is obtained from P by erasing
where the pair (P, X) has law L . The point process P
e = X∅ , and let L˜ be
all atoms that would lead to an infection before t = 0. Define X
e X).
e We refer to L˜ as the initial shifted law. The infection times
the distribution of (P,
(σx ; x ∈ U \ {∅}) are then defined recursively as above, from i.i.d. pairs (Px , Xx ; x ∈
U \ {∅}) with the original law L .
Assumptions. The following assumptions will be made implicitly in the remainder of
our work. For simplicity, we assume that the contact rate (c(t); t ≥ 0) is a piecewise rightcontinuous function, and that for any a ≥ 0, the process (X(a); a ≥ 0) is a.s. continuous
at a.
Recall that the intensity measure of the point process P is denoted by τ , and implicitly
defined as


hτ, f i = E hP, f i
R
for any test function f , where we used the notation hµ, f i = f dµ. We assume that τ has
a density w.r.t. the Lebesgue measure that we still denote by (τ (a); a ≥ 0), and assume
that
Z ∞
R0 :=
τ (a)da < ∞.
0

We also assume that there exists a unique parameter α ∈ R, the so-called Malthusian
parameter of the (untrimmed) CMJ process, such that
Z ∞
exp(−αa)τ (a)da = 1.
(9)
0

The parameter α can be either positive (supercritical case) or negative (subcritical case).

16

2.2

McKendrick-von Foerster PDE: Weak solutions

This section provides the existence and uniqueness of weak solutions to Eq. (5). Even if
similar results are well-known for the time-homogeneous McKendrick-von Foerster equation [28, Chapter 1], we derive them briefly here for the sake of completeness.
In order to motivate our definition of weak solutions, we start by giving a well-known
formal resolution of the PDE using the method of characteristics. Fix a > 0. Let
A(t) = a − t
Then
d
n(t − s, A(s)) = −∂t n(t − s, A(s)) − ∂a n(t − s, A(s)) = 0,
ds
so that s 7→ n(t − s, a − s) is conserved along the characteristics, i.e.,
∀s < a, n(t, a) = n(t − s, a − s).
It follows that
(
g(a − t) when a > t
n(t, a) =
b(t − a) when a ≤ t
where

(10)

∞

Z

n(t, a)τ (a)da

b(t) = c(t)
0

is the number of new infections at time t. We now determine the function b. Injecting
the previous expression into the “age” boundary condition of the PDE, we obtain a delay
equation for b: for every t > 0
Z ∞
Z t
g(a − t)τ (a)da.
(11)
b(t − a)τ (a)da + c(t)
b(t) = c(t)
t

0

Lemma 4. There exists a unique solution b to (11) which is locally integrable. Moreover,
for any δ ≥ 0 such that δ > α we have Rb ∈ L 1,δ , where L 1,δ denotes the set of all
∞
functions f : R+ → R such that kf kL1,δ := 0 e−δt |f (t)|dt < ∞.
Proof. Fix δ > α and denote by L1,δ the space L 1,δ quotiented by the relation ∼δ , where
f ∼δ g if kf − gkL1,δ = 0. Then define the linear operator Φ : L1,δ → L1,δ by
Z t
Φf : t 7→ c(t)
f (t − u)τ (u)du.
0

Then we have
Z
kΦf kL1,δ =

∞

Z

−δt

∞
−δt

Z

t

Φf (t)dt =
e c(t)
f (t − u)τ (u)dudt
0
0
0
Z ∞
Z ∞
−δu
=
e f (u)
τ (t − u)e−δ(t−u) c(t)dtdu.
e

0

u

17

Now using that

Z

∞
−δ(t−u)

τ (t − u)e

Z

∞

c(t)dt ≤

u

τ (t)e−δt dt < 1

0

we obtain that kΦk < 1. Define
Ψ := Id −Φ.
Then Ψ is invertible with inverse

P

k≥0

Φk . Note that equation (11) can be written as
Ψ(b) = F,

where

∞

Z

τ (a)g(t − a)da.

F : t 7→ c(t)
t

Noting that F ∈ L1,δ as
Z ∞
e

−δt

Z

∞

Z

∞

F (t)dt ≤

0

τ (a)g(t − a)dadt < ∞
0

t

proves existence and uniqueness of the solution b to (11) in L1,δ . Now for any two functions
b1 and b2 such that b1 ∼δ b2 and b1 and b2 both satisfy (11), we have b1 = b2 (i.e., there is a
single element in the equivalence class of b verifying (11) for all t). This shows uniqueness
of the solution b to (11) in L 1,δ .
Since all elements of L 1,δ are locally integrable, this also shows the existence of a
locally integrable solution to (11). Its uniqueness can be proved following the exact
same reasoning as previously, replacing integrations on [0, ∞) by integration on compact
intervals.
Definition 5. We say that (n(t, a); t, a ≥ 0) is the weak solution to the McKendrickvon Foerster PDE with initial condition g if it satisfies the relation (10) where (b(t); t ≥ 0)
is the unique locally integrable solution to (11) displayed in the previous lemma.

2.3

A forward Feynman-Kac formula

Consider a CMJ with initial shifted law and define
X

1{σx ∈(0,t]} , B(t) := E Z(t)
Z(t) :=
x

where
R ∞ Z(t) is interpreted as the number of infections between 0 and t. Recall that R0 =
τ (u)du < ∞ guarantees that B(t) < ∞ for all t ≥ 0. Finally, B is non-decreasing and
0
we denote by dB the Stieljes measure associated to B.
Lemma 6. There exists a locally integrable function (b(t); t ≥ 0) such that
dB(t) = b(t)dt.
Further, b coincides with the unique locally integrable solution of the delay equation (11).

18

Proof. The fact that dB has a density easily follows from the fact that τ has a density.
The fact that B(t) < ∞ ensures that b is locally integrable.
Define P̄x the infection measure obtained from Px after random thinning by the function (c(t); t ≥ 0). Namely, conditional on σx and the atoms A1 < A2 < · · · of Px , we
remove independently each of the atoms with respective probabilities 1 − c(σx + A1 ), 1 −
c(σx + A2 ), . . . , whereas the other atoms remain unchanged.
Fix t > 0. Let k ≤ n ∈ N. Define Tk,n (Px ) as the measure obtained from Px as
follows. Conditional on the atoms A1 < A2 < · · · of Px , we remove independently each
of the atoms with respective probabilities
1−

max

k k+1
,t n ]
z∈(t n

c(z + A1 ), 1 −

max

k k+1
z∈(t n
,t n ]

c(z + A2 ), · · ·

and leave other atoms unchanged. Note that the thinning procedure is now independent
], the point measure Tk,n (Px ) dominates
of the starting time σx . Further, if σx ∈ (t nk , t k+1
n
P̄x .
We decompose the births on (0, t] into two parts: individuals stemming from the root
∅ and a second part from subsequent births. Using the fact that for every individual x,
the (un-suppressed) random measureRPxR is independent of its birth time σx (see second
t ∞
equality below), and setting M (t) := 0 0 g(a)τ (a + u)c(u)dadu, we get

n−1 X  
 k k + 1 i Z t−σx
X
P̄x (da) + M (t)
B(t) =
E 1 σx ∈ t , t
n
n
0
k=0 x6=∅

n−1 X  
 k k + 1 i Z t−t nk
X
k,n
≤
E 1 σx ∈ t , t
T (Px )(da) + M (t)
n
n
0
k=0 x6=∅

n−1 X  
 k k + 1 i  Z t−t nk
X
k,n
E
T (P)(da) + M (t)
=
E 1 σx ∈ t , t
n
n
0
k=0 x6=∅

n−1
 k k + 1 i  Z t−t nk
X X 
k,n
E
1 σx ∈ t , t
=
T (P)(da) + M (t)
E
n
n
0
k=0
x6=∅

n−1  
 k   Z t−t nk
X
k + 1
k,n
T (P)(da) + M (t)
=
B t
−B t
E
n
n
0
k=0
n−1
 k  Z t−t nk
X   k + 1
=
B t
−B t
ck,n (u)τ (u)du + M (t).
n
n
0
k=0
with ck,n (y) = maxv∈(t k ,t k+1 ] c(y + v). In particular, if tk/n → x, and x + y is a continuity
n
n
point of c, we have ck,n (y) → c(x + y). We will pass to the limit n → ∞ in the latter
inequality. Recall that c is bounded (and valued in [0, 1]) and right-continuous. The first
term on the RHS can be written under the form
Z t
n−1  
 k  Z t−t nk
X
k + 1
k,n
B t
−B t
c (u)τ (u)du =
f (n) (y)dB(y),
n
n
0
0
k=0
where
f

(n)

Z
(y) =

t−[y]n

τ (u)
0

sup
v∈([y]n , [y]n + nt ]

c(v + u)du and [y]n =

19

t
bny/tc.
n

We will now apply twice the Bounded Convergence Theorem. On the one hand, for a
fixed value of y, as n → ∞

1[0,t−[y]n ] (u)τ (u)

sup
v∈([y]n ,[y]n + nt ]

c(v + u) −→ 1[0,t−y] (u)τ (u)c(y + u) Lebesgue a.e.

(n)
Further, the latter term
R ∞ (i.e., the integrand in the integral defining f ) is uniformly
bounded by τ and 0 τ (u)du < ∞. A first application of the Bounded Convergence
Theorem implies that for every y, as n → ∞
Z t−y
(n)
c(y + u)τ (u)du.
f (y) →
0

R∞
On the other hand, the uniform bound, f (n) (y) ≤ R0 = 0 τ (u)du for all y, n, allows us
to again apply the Bounded Convergence Theorem, so we get
Z t−y
Z tZ ∞
Z t
b(y)
c(y + u)τ (u)dudy +
g(a)τ (a + u)c(u)dadu.
B(t) ≤
0

0

0

0

By an analog argument, one can establish the same lower bound and strengthen the latter
inequality into an equality. A simple change of variable v = u + y and interchanging the
order of integration yields
Z tZ ∞
Z v
Z t
g(a)τ (a + u)c(u)dadu.
τ (v − y)b(y)dydv +
c(v)
B(t) =
0

0

0

0

Finally, differentiating with respect to t yields the desired result.
Corollary 7 (Forward Feynman-Kac formula). For every t ≥ 0, define
µ̄t (da × {i}) := n(t, a) × P(X(a) = i)da,
where n is the unique weak solution to the McKendrick-von Foerster PDE with initial
condition g. Then
X

µ̄t (da × {i}) = E
1{σx <t} δ(t−σx ,Xx (t−σx )) (da × {i})
(12)
x

where the expected value is taken with respect to a CMJ process starting with one individual
with infection and life-process distributed according to the shifted law L˜g .
Proof. Define
µ̄0t (da

X

:=
× {i})
E
1{σx <t} δ(t−σx ,Xx (t−σx )) (da × {i})
x

We need to check that µ̄0t = µ̄t on the space of finite measures. Let F be a non-negative,
bounded, continuous function on R+ × S and h a non-negative, continuous function with
compact support in R+ . As in the previous lemma, we have
Z ∞
Z

X Z ∞

0
E
h(t)F t − σx , Xx (t − σx ) 1{σx <t} dt
h(t) F (a, i)µ̄t (da, di)dt =
0

x6=∅
∞

Z

0
∞

Z


h(t)E F (t + a, X(t + a) g(a)dadt.

+
0

0

20

Let (I) be the first term on the RHS. For every n ∈ N∗
 k k + 1 i 
XX Z ∞
 
(I) =
E
h(t)F t − σx , Xx (t − σx ) 1 σx ∈
,
dt
n
n
σ
x
k≥0 x6=∅
 k k + 1 i 
XX Z ∞
 
=
E
h(t + σx )F t, Xx (t) 1 σx ∈
,
dt
n
n
0
k≥0 x6=∅
 k k + 1 i 
XX Z ∞
 
,
dt
≤
E
max h(t + u)F t, Xx (t) 1 σx ∈
k k+1
n n
, n ]
u∈( n
0
k≥0 x6=∅

 
 k k + 1 i
XXZ ∞

=
max h(t + u)E F t, X(t) P σx ∈
,
dt
k k+1
n
n
u∈( n
, n ]
0
k≥0 x6=∅

 
 k 
XZ ∞

k + 1
=
B
−B
dt.
max h(t + u)E F t, X(t)
k k+1
n
n
, n ]
u∈( n
0
k≥0
By reasoning along the same lines as in Lemma 6 (i.e., applying the Bounded Convergence
Theorem several times), one can show that the RHS converges to
Z ∞Z ∞


h(t + y)E F t, X(t) b(y)dtdy
0

0

as n → ∞ and thus
Z ∞
Z
Z
0
h(t) F (a, i)µ̄t (da, di)dt ≤

∞

∞

Z



h(t + y)E F t, X(t) b(y)dtdy
0
Z ∞ 
Z 0∞

E F t + a, X(t + a) g(a)dadt.
h(t)
+

0

0

0

By a similar argument, the inequality can be strengthened into an equality. After some
simple changes of variables we get
Z t 
Z
Z ∞
Z ∞

0
E F a, X(a) b(t − a)dadt
h(t)
h(t) F (a, i)µ̄s (da, di)dt =
0
0
Z ∞ 0 Z ∞ 

E F t + a, X(t + a) g(a)dadt.
+
h(t)
0

Moreover we have
Z ∞
Z
XZ
h(t) F (a, i)µ̄t (da, di)dt =
0

i∈S

=

∞

∞

Z
h(t)

F (a, i)n(t, a)p(a, i)dadt

0

0

XZ
i∈S

0

∞

t

Z

F (a, i)b(t − a)p(a, i)dadt

h(t)

0

0
∞

Z
+

Z
h(t)

0

so that

Z

∞

Z
h(t)

Z
F (a, i)µ̄t (da, di)dt =

0

∞


F (a, i)g(a − t)p(a, i)dadt

t

Z
h(t)

∞

F (a, i)µ̄0t (da, di)dt.

0

It is easy to check that the two functions t 7→ hµ̄t , F i and t 7→ hµ̄0t , F i are both continuous.
As a consequence, we have hµ̄t , F i = hµ̄0t , F i for every test function F , concluding the
proof.
21

2.4

Dual CMJ process and backward Feynman-Kac formula

We end this section by making a connection between a dual process – interpreted as an
ancestral process – and the (PDE) method of characteristics. In addition, this approach
provides a probabilistic proof of uniqueness for the PDE.
Let M be any random point measure with intensity measure τ (du). Fix a, T > 0. We
now construct a dual process using the measure M, which can be seen as a generalized
Bellman-Harris branching process (individuals have a finite lifetimes, births only occur
upon death). Let us first describe the process with no suppression (i.e., c ≡ 1).
• Start with a single particle at time t = 0. Assume that the residual lifetime of this
original particle is a, so that this particle dies out at time a.
• As in a Bellman-Harris process, the number of offspring of an individual and their
lifetime durations are independent of the parent’s characteristics.
• Upon death, each individual x is endowed with an independent copy Mx of M: the
number of offspring of x is given by the number of atoms of Mx and their lifetime
durations are given by the positions of the atoms in Mx .
The dual process with suppression c 6≡ 1 can be coupled with the case c ≡ 1. Given a
realization of the process, if a branching occurs at time t, the children are killed independently with probability c(T − t). (Note that as in the original CMJ process, suppression
translates into trimming the dual tree.)
Remark 4. We note that there are as many dual processes as there are point processes
with intensity measure τ . Here are a few natural choices:
1. Take M = P.
2. Let M be a Poisson Point Process with intensity measure τ (du). In this particular
case, the dual process is a Bellman-Harris branching process (i.e., the offspring
lifetime durations are independent conditional on offspring number). We note that
τ (du) appears naturally when considering the ancestral spine of a critical CMJ, see
e.g. [48]. The measure τ can be obtained by size-biasing P (i.e. biasing by the total
mass of P) and then recording the age of the individual at a uniformly chosen birth
event.
Let (Yt ; t ≥ 0) be the stochastic process valued in ∪n∈N Rn+ recording the residual
(1)
(n)
life-times at time t listed in increasing order, i.e. if Yt = (Yt , · · · , Yt ) there are n
(k)
particles alive at time t and Yt is the residual life-time of the k-th individual with
(1)
(n)
Yt < · · · < Yt . (We assumed that τ has a density so that the residual lifetimes are
distinct a.s.) In particular, the particle labelled 1 at any given time t will be the first
(1)
to expire, and at death time t + Yt a random number of children is produced. We let
dim(YT ) denote the number of particules alive at time t, i.e., the dimension of the vector
Yt .
Proposition 8 (Backward Feynman-Kac formula). For any probability density g, we have
!
X
(i)
ba
n(T, a) = E
g(Y )
(13)
T

i≤dim(YT )

22

where (n(t, a); t, a ≥ 0) is the unique solution to the McKendrick-von Foerster equation
b a is the distribution of the process (Yt ; t ≥ 0) starting with an
started from g, and E
individual with residual lifetime a.
Proof. Let t1 < · · · < tk < · · · be the successive branching times of the dual branching
process. Since τ has a density, there is a single branching particle at the successive
branching times t1 , . . . Define the process
X
Zs :=
n(T − s, Ys(i) )
i≤dim(Ys )

See also Figure 4 for a pictorial representation of the process. It is plain from the definition
that n is preserved along the characteristics of the PDE, i.e., that for every x the function
s → n(T − s, x − s) remains constant on [0, x). As a consequence, (Zs ; s ≥ 0) remains
constant on every interval [tn , tn+1 ), with the convention t0 = 0. Define zn := Ztn the
value of the process (Zt ; t ≥ 0) at the n-th branching time. Let (Fn ; n ∈ N) be the
filtration induced by the process (zn ; n ∈ N). For every n > 1
Z ∞
X
(i)
b a (zn | Fn−1 ) =
E
n(T − tn , Ytn ) + c(T − tn )
n(T − tn , a)τ (da)
0

2≤i≤dim(zn−1 )

=

X

(i)

n(T − tn , Ytn ) + n(T − tn , 0)

2≤i≤dim(zn−1 )

= zn−1 ,
where the second equality follows from the spatial boundary of the McKendrick-von Foerster equation. As already mentioned, the process (Zs ; s ≥ 0) is constant between two
branching times. As a consequence, (Zs ; s ≥ 0) is a martingale (w.r.t. its natural fltration)
so for every s ≥ 0,
 X

(i)
ba
n(T, a) = E
n(T − s, Y ) .
s

i≤dim(Ys )

Relation (13) follows by taking s = T in the latter expression.

3

Proofs of the main results

In this section, we provide the proofs of the two laws of large numbers stated in Section 1.4.
The proof of Theorem 1 is a direct consequence of the results of the previous section.
Proof of Theorem 1. Recall the definition of the empirical measure µN
t . It can be written
as
N
1 X 1,(k)
(da
×
{i})
=
µN
µ
(da × {i})
(14)
t
N k=1 t
1,(k)

where (µt ; k ≥ 1) are independent copies of µ1t . Let f be an arbitrary continuous and
bounded function on R+ ×S. The law of large numbers combined with Corollary 7 implies
that
1 N
µ , f −→ hµ̄t , f i a.s.
N t
which ends the proof.
23

t
T

(a, T)

T - t1

T - t2

T - t3

a

Figure 4: Graphical representation of the process (Zs ; s ≥ 0). We start with a single
individual with residual lifetime a. In this picture, time flows downwards for the branching
process. The residual lifetime of the initial individual decreases linearly until reaching 0 (this
corresponds to time T −t1 in our representation). At this time, the particle dies and produces
2 red particules. Residual lifetimes travel along the characteristics of the McKendrick-von
Foerster PDE until reaching the spatial boundary condition {a = 0} where a new branching
occurs.

We now turn our attention to the proof of Theorem 2, the law of large number started
from a single individual. Let us briefly recall the setting of this result.
We consider a sequence (tK ; K ≥ 0) of random times with tK → ∞ a.s. on the nonextinction event. We assume that the process starts from a single individual infected at
time t = 0 and that the contact rate cK of the CMJ depends on K in the following way:
cK (t) := C(t − tK ), where (C(t); t ∈ R) is a piecewise continuous function in [0, 1] such
that C(t) = 1 for all t < 0.
Proof of Theorem 2. The result will follow by viewing the population at time tK + t as
an adequate random characteristic of the population at time tK . Let us recall some basic
facts about random characteristics of CMJ processes in our context. We refer to [32, 51]
for a more thorough account on this notion.
We consider a plain CMJ with no contact rate or initial shifted law. Every individual
is characterized by an independent pair of random variables (Px , Xx ). A random characteristic is a real-valued stochastic process (χ(a); a ≥ 0) that can be constructed from the
collection (Px , Xx ; x ∈ U ). (More formally it is a càdlàg process measurable w.r.t. the
σ-field induced by these variables.) By convention, it is extended to a process defined on
the whole real line by setting χ(a) := 0 for a < 0.
For an individual x ∈ U let us write χx for the random characteristic constructed from
the collection (Pxy , Xxy ; y ∈ U ). It is the characteristic constructed from the tree rooted
at x of all descendants of x. The branching process counted by the random characteristic
24

χ is then defined as
Z χ (t) =

X

χx (t − σx ).

x∈U

We now recall one of the main results of Jagers and Nerman [33], namely Theorem 5.8
(see also Theorem 4, Appendix A in [51]). On top of all the assumptions above, we make
the two following extra assumptions
(a) The characteristic fulfills
X
n≥0

sup
n≤u≤n+1

e−αu E(χ(u)) < ∞.

(b) The map a 7→ E(χ(a)) is continuous a.e. with respect to the Lebesgue measure.
Then there exists a positive r.v. W∞ (independent of the choice of χ) such that conditional
on non-extinction
Z ∞
χ
Z (t) exp(−αt) → W∞
αe−αa E(χ(a))da in probability as t → ∞.
0

To illustrate the method, we recall that if we take χ(a) = 1R+ (a) then Z χ (t) coincides
with Z(t), the total number of births before time t. For this particular choice of (deterministic) characteristic, the two properties above are immediately satisfied (recall that
α > 0), so that conditional on non-extinction
X
1{σx <t} exp(−αt) → W∞ in probability.
x

This convergence ensures that the first item of our theorem is satisfied.
To prove the second item, let us set
P∅ =

N∅
X

δA i ,

i=1
(i)

for the atoms of the infection point process of the ancestor P∅ . Further denote by µt the
empirical measure of ages and compartments at time t of the progeny of the i-th child of
the ancestor, thinned by the contact rate (c(t); t ≥ 0), i.e.,
X
(i)
∀t ≥ 0, µt =
1{eσix <t} δ(t−eσix ,Xix (t−eσix )) ,
x∈U

where σ
ex refers to the infection time of x once the tree has been thinned. (That is,
σ
ex = σx if x remains infected after the thinning, or σ
e = ∞ otherwise.) Our characteristic
of interest can now be defined as
χ

(t,f )

(a) = f (a + t, X∅ (a + t)) +

N∅
X

(i)
1{Ai ∈[a,a+t]} hµa+t
, f i.

i=1

for a fixed time t ≥ 0 and a fixed bounded continuous function f . On the one hand, it
should be clear that
(t,f )
(d)
Z χ (tK ) = hµK
(15)
tK +t , f i.
25

To see this, note that the process Z χ
is obtained from a plain CMJ with no thinning,
so that only infections after time tK are removed due to the contact rate.
On the other hand, χ(t,f ) (a) can be obtained by starting from an initial individual with
age −a, removing all atoms from its infection point process before time 0, and integrating
the empirical measure of the resulting CMJ at time t against f . This is the description
of the CMJ with initial shifted law L˜ conditional on A = a, so that
Z ∞

E
g(a)χ(t,f ) (a)da = hµ̄t , f i,
(16)
(t,f )

0

where in µ̄t the age of the initial ancestor is distributed according to g.
Therefore, up to checking (a) and (b), Theorem 5.8 in [32] shows that, as K → ∞,
Z ∞

K
−αa (t,f )
hµtK +t , f i −→ W∞ E
αe χ (a)da
0

in probability, which in combination with (16) proves the result.
All what remains to be shown is that (a) and (b) are fulfilled. That a 7→ E(χ(t,f ) (a))
is continuous a.e. follows directly from the fact that τ has a density. Condition (b) is a
consequence of the following stochastic domination
χ

(t,f )



(a) ≤ kf k∞ 1 +

N∅
X


Z (i) (t)

i=1

where (Z (i) (t); t ≥ 0) are i.i.d. copies of the CMJ without thinning, independent of P∅ .

4

Inference procedure

In this section, we illustrate how to use our framework to make inferences from macroscopic observables of the epidemic, e.g., incidence of positively tested patients, hospital or
ICU (intensive care unit) admissions, deaths, etc. We show how to use those observables
to extract the underlying age structure of the population, estimate model parameters,
and forecast the future of the epidemic.
We focused on a longitudinal case study in France. From March 18 2020, the French
government has provided daily reports of the numbers of ICU and hospital admissions, of
deaths, of discharged patients, and of occupied ICU and hospital beds. Moreover, several
theoretical studies have already been conducted on the same dataset. This allowed us
to fix the values of some crucial biological parameters that had already been estimated
and to carry out a comparison with our method. We want to emphasize that the aim
of this section is to provide a mathematical framework in which convergence results can
be rigorously proved while remaining flexible enough for other applications. Our goal is
not to provide new estimates of epidemiological parameters for France, as many robust
estimates are already available. For instance we do not provide confidence intervals for
our estimates, and neither do we conduct a sensibility analysis.
The remainder of the section is laid out as follows. In Section 4.1 we identify the
mathematical quantities that impact the dynamics of the epidemic for large population
sizes, and show how to turn them into a likelihood. Section 4.2 then presents the choice of
distribution we made for these quantities and the parameters that need to be estimated.
26

Finally, estimation of these parameters from the French incidence data is performed in
Section 4.3 and Section 4.4. We start by fitting a simple model in Section 4.3 and then
show how this model can be made more complex to account for more complex data in
Section 4.4.

4.1

Deriving the likelihood

Under the assumptions of Theorem 2, the number of individuals in a given state i at time
t converges to
Z
∞

n(t, a)p(a, i)da,

ni (t) =

(17)

0

where (n(t, a); t, a ≥ 0) is the solution to (5). The required assumptions are in essence
that the epidemic has been ongoing for a long enough time at the lockdown onset for the
infected population to be large, which we assume to hold true for France as the number
of cases on March 16 2020 was on the order of thousands of individuals.
Therefore, we take (17) as the predicted number of individuals in state i in our model.
In order to turn (17) into a likelihood, we assume that the observed number of individuals
in state i at time t is distributed according to some discrete law centered on the predicted
value, which we take to be a Poisson distribution. Then, the likelihood for the whole time
period is obtained by assuming that the observations are independent across states and
time. The explicit expression for the likelihood is provided in Section A.3.
Remark 5. The assumption that observations are independent is obviously not met. For
instance, the number of occupied hospital beds is cumulative, so that any error is propagated from one day to the other. Moreover, there is a clear weekly effect in data that is
not accounted for here. As deriving robust estimates is not the main purpose of this work,
we prefer to keep this independence assumption that leads to simple expressions for the
likelihood, while being aware of its limitation.
Under our assumptions, the likelihood only depends on (17), which is in turn determined by four quantities that need to be parametrized:
1. The intensity measure of the infection point process (τ (a); a ≥ 0).
2. The initial number of infected individuals and their age profile.
3. The contact rate after lockdown (c(t); t ≥ 0).
4. The one-dimensional marginals of the life-cycle process (p(a, i); a ≥ 0) for i ∈ S.

4.2

Parametrization of the model

Average infection measure. Recall the definition of τ and R0 from Section 2.1 and
further define
τ (a)
.
∀a ≥ 0, τ̂ (a) =
R0
The total mass of τ , R0 , corresponds to the mean number of secondary infections induced
by a single infected individual if c ≡ 1. Thus R0 is the basic reproduction number at the
start of the epidemic, when no control measure is enforced. In order to distinguish it from
27

Notation

Value

Source

Pre-lockdown exponential growth rate

0.315

E

Basic reproduction number before lockdown

3.25

E

k

Shape parameter of the generation time

2.83

[21]

λ

Scale parameter of the generation time

5.67

[21]

α
Rpre

Description

Table 1: Parameter values common to both models. In the “Source” column, “E” indicates
that the parameter has been estimated in the present work.

the reproduction number during lockdown, it will be denoted by Rpre . We leave it as a
parameter to infer.
The function (τ̂ (a); a ≥ 0) is the density of a probability measure known as the
generation time distribution [9, 56]. This distribution has been estimated shortly after
the epidemic onset by several studies [10, 21, 26]. We use the estimation of [21], and
assume that τ̂ is a Weibull distribution, that is
∀a ≥ 0,

τ̂ (a) =

k  a k−1 −(a/λ)k
e
,
λ λ

(18)

where the values of the shape parameter k and scale parameter λ are recalled in Table 1.
Initial condition. According to Theorem 2, the initial age structure of the population
is
∀a ≥ 0, n(0, a) = W αe−αa ,
where α is the Malthusian parameter of the epidemic prior to implementation of control
measures, and W is the number of infected individuals at t = 0, that is, at the lockdown
onset. The parameter α corresponds to the exponential growth rate of any observable of
the epidemic during this period. We chose to estimate it from the cumulative number
of deaths, which appeared to be more reliable than the number of detected cases as the
number of tests conducted in the early phase of the epidemic in France varied greatly. It
was estimated using a linear regression on the logarithm of the number of deaths from
March 7 to March 20 2020, and the corresponding basic reproduction number before
lockdown, Rpre , was computed using the Euler-Lotka equation (9) assuming that the
generation time distribution is given by (18). Both estimates are shown in Table 1.
Contact rate. The contact rate (c(t); t ≥ 0) accounts for the temporal variations in
transmissions after the lockdown onset. As we focus on the period from March to May
2020 where no additional control measure has been enforced in France, we will assume
that (c(t); t ≥ 0) is constant and denote by c0 its value, that is, c ≡ c0 . The reproduction
number after the lockdown is denoted by Rpost := c0 Rpre .
Life-cycle. The last quantities that need to be defined are the one-dimensional marginals
of the life-cycle process (X(a); a ≥ 0). These could be directly estimated from hospital
patient pathways as in [38, 39, 55]. However, when such data is not available they need
28

to be estimated from individual counts in each compartment. In this case, we propose
the following parametrization of the process (X(a); a ≥ 0) based on Gamma-distributed
sojourn times.
Let us denote by (Xn ; n ≥ 0) the sequence of states visited by (X(a); a ≥ 0). We
assume that (Xn ; n ≥ 0) is a Markov chain on S, and that it ends either in a “dead” or
“recovered” state, that are assumed to be absorbing.
For i ∈ S, the sojourn time in i is supposed to be Gamma-distributed with mean mi
and variance mi /γ, for some global dispersion parameter γ shared across all states. More
precisely, let (Dn ; n ≥ 0) denote the sequence of sojourn times of (X(a); a ≥ 0), that
is, Dn is the sojourn time in state Xn . We assume that conditional on (Xn ; n ≥ 0), the
variables (Dn ; n ≥ 0) are independent. Moreover, if Xn = in , then Dn follows a Gamma
distribution with mean min and variance min /γ, that is,
Dn ∼

γ γmin γmin −1 −γu
u
e du.
Γ(γmin )

Thus, the one-dimensional marginals are parametrized by the transitions of a Markov
chain (Xn ; n ≥ 0) on S, as well as by one parameter mi for each i ∈ S, and a global
parameter γ. Under this parametrization the one-dimensional marginals can be efficiently
computed, while only requiring one parameter for the sojourn time in each state. Two
concrete examples of Markov chains (Xn ; n ≥ 0) are discussed in the next sections.

4.3

Inference with the admission model

The first model that we consider, the admission model, is a parsimonious model designed
to obtain estimates of the reproduction number during lockdown, and of the number of
infections in France in early March. It is illustrated in Figure 5. We fit it to the three
“incidence” time series: the daily number of admissions in hospital and ICU, and the daily
number of deaths.
Description of the model. Upon infection, with probability 1 − phosp , an individual
develops a mild form of COVID-19 and is placed in state I, which encompasses all cases
that do not require a hospitalization. With probability phosp the individual has a severe
infection and is placed in state C. Individuals in state C are eventually hospitalized and
moved to state H. Then, with probability pICU individuals in state H are admitted in ICU
and moved to state U . Otherwise they eventually recover and are discharged. Finally,
individuals in state U die with probability pdeath , or recover with probability 1 − pdeath .
In this model, only individuals in ICU may die.
As we are fitting the number of individuals that enter a state, and not the number of
individuals that are currently in that state, we only need to track the times TH , TU , and TD
elapsed between infection and hospital admission, ICU admission and death, respectively.
Inference results. Estimations of phosp , pICU and of the death probability conditional
on hospitalization (equal in our setting to pICU × pdeath ) in France have already been
conducted in [47]. We used these estimates and considered the values of phosp , pICU and
pdeath as fixed. All other parameters were estimated using a maximum likelihood procedure
described in Section A.3. The parameter estimations are provided in Table 2, and the
corresponding predicted values for the time series under consideration are displayed in
29

pICU
phosp

H

C

S

1-pICU

I

hospital
admission

TH

TU

R
ICU admission

R

infection

1-phosp

U

TD

1-pdeath

D

R

death

pdeath

age of
infection

Figure 5: Illustration of the admission model.

Figure 1. Overall, our simple model seems to match the observed data. Note however
that the model overestimates the number of ICU admissions in the second part of the
lockdown. This is likely due to a temporal reduction in the ICU admission probability
which has been reported in [47].
Our estimation of the basic reproduction number during the lockdown period is Rpost =
0.745. This suggests that lockdown has reduced the basic reproduction number by a
factor c0 = 0.23 compared to the beginning of the epidemic. Moreover, we estimated that
W = 9.85 × 105 infections have occurred in France before March 17. Both these values
are in line with previous estimates for France [47, 50].
We did not impose that TH < TU in the inference procedure. Interestingly we found
that the data are best explained by assuming that the mean of TH is 14.4 days, whereas
the mean of TU is 11.4 days. This indicates that the delay between infection and hospital
admission is shorter for individuals that end up in ICU, compared to the average time
between infection and hospitalization. Therefore it would be more appropriate to allow
individuals to have an admission to hospital delay that is different depending on whether
they will end up in ICU or not, modeling the fact that they have a more severe form of
the disease. We estimated the mean of TD , the time between infection and death, to be
18.6 days. This estimate is lower than but consistent with previous estimates based on
the study of individual-case data [39, 55, 57].

4.4

Inference with the occupancy model

We now consider a model aimed at providing predictions for the number of hospitalized
individuals and ICU patients. The model is fitted to the three “incidence” time-series,
and to three additional “prevalence” time-series: the number of occupied hospital and
ICU beds, and the number of discharged hospital patients.
A first attempt to fit the prevalence curves could be to keep the admission model of
30

Notation
Rpost
W

Description
Reproduction number during lockdown

Value

Source

0.745

E

Total number of infections before March 17 9.85 × 105
2020

E

phosp

Probability of being hospitalized

0.036

[47]

pICU

Probability of entering ICU conditional on
being at the hospital

0.19

[47]

pICU · pdeath

Death probability conditional on being hospitalized

0.181

[47]

TH

Delay between infection and hospital admission

14.4 days

E

TU

Delay between infection and ICU admission

11.4 days

E

TD

Delay between infection and death

18.6 days

E

0.463

E

γ

Scale parameter common to all Gamma distributions

Table 2: Inferred parameter set for the admission model. The values indicated for the
durations correspond to the means of the Gamma distributions. In the “Source” column,
“E” indicates that the parameter has been estimated in the current work.

Figure 5 and to estimate the time between hospital admission and discharge using the
observed number of occupied ICU, hospital beds, and discharged patients. However this
only yields a poor fit of the data (see Section A.4). We identified two main reasons for
this discrepancy. First, we assumed that all individuals are admitted to ICU prior to
death. Using the probability estimated in [47] then yields that the probability of dying
conditional on being in ICU is 0.953. This value is unrealistically high, and we need to
assume that a fraction of hospital deaths occur without going through the ICU. Second,
under the admission model, the delay between hospital admission and discharge is almost
unimodal. However, the observed number of occupied hospital beds rises fast but falls
slowly. Such a shape cannot be easily accounted for by a unimodal distribution for the
time spent in hospital.
Description of the model. Taking into account the previous two points required us to
make the model more complex. The resulting model, referred to as the occupancy model,
is illustrated in Figure 6. We now consider that upon infection, individuals go to one of
three states depending on the severity of their infection:
• The state Cu which gathers critical infections that lead to death or ICU admission.
The probability of having a critical infection is denoted by pcrit .
• The state Ch which corresponds to severe infections that require a hospitalization
but are not critical. Such infections occur with probability psev .
31

1-dhosp

H

C

u

D

U
dicu

dhosp

S

1-pshort

H

C

h

pshort

I

DC h

discharge

ICU
admission

hospital
admission

infection

DC u

R
R

R
hospital
admission

1-psev-pcrit

D

DD

DU

Dshort

discharge

psev

R

death

pcrit

1-dicu

DU
Dlong

age of
infection

Figure 6: Illustration of the occupancy model

• The I state which consists of all mild infections that do not lead to a hospital
admission, and occur with probability 1 − pcrit − psev .
Individuals in state Ch are admitted to hospital after a duration DCh . Then, with
probability pshort they are discharged after a duration Dshort , while with probability 1 −
pshort they are discharged after a duration Dlong .
Critically infected individuals are admitted to hospital after a duration DCu . Upon
arrival at hospital, they die immediately with probability dhosp , or go to ICU after a
duration DHu . Individuals in ICU die with probability dICU after a delay DD . Otherwise
they are discharged after a stay of length DU .
Inference results. In our model, the probability of hospital admission is pcrit + psev ,
the probability of ICU admission is pcrit (1 − dhosp ) and that of death is pcrit (dhosp + (1 −
dhosp )dICU ). We have fixed these three values to those estimated in [47], and we only
had one remaining parameter out of 4 (pcrit , psev , dshort , dICU ) to estimate from the data.
We have fixed the time DU to 1.5 days as estimated in [47]. All other parameters were
estimated using a maximum likelihood method described in Section A.3. The estimated
parameter set is shown in Table 3, while Figure 2 shows the best-fitting model.
The estimated parameters provide a good fit of the six observed time series. Again,
the model has a tendency to overestimate the ICU admissions in the second part of the
lockdown, which has the same interpretation as for the admission model.
Under the occupancy model, we estimated that Rpost = 0.734, and W = 9.52 × 105 .
These estimates are extremely close to those made with the admission model. The estimated mean time between infection and death or hospital, ICU admission are respectively
19.5 days, 13.7 days and 12.5 days. Again we see that these estimates in the more complex
32

model are consistent with those of the simple model. The mean recovery time from hospital is 19.4 days for severe infections, and 28.2 days for critical infections. This yields an
overall mean recovery time of 20.0 days. Finally, we estimated that the death probability
conditional on being in ICU is 0.709. This yields that in our model a fraction 0.256 of
all deaths occur shortly after hospital admission. This result is consistent with [47] that
estimated that a fraction 0.15 of all deaths occurred within the first day after hospital
admission. However, it has been reported in [25] that the death probability of ICU patients is 0.23. Our estimated value is thus unrealistically high. This indicates that there
is a fraction of hospital deaths that occur without any ICU admission, and not quickly
after hospital admission, that our model is not accounting for.
Our estimates, though they are not the key message of the present paper, can nevertheless draw attention to potential heterogeneities in the infected population. We estimated
that the mean time between infection and ICU admission is shorter than that between
infection and hospital admission. This suggests that the time between infection and severe symptom onset is shorter for critical infection, that lead to ICU admission, than for
milder ones. Moreover, fitting the prevalence time series required to divide the hospital
and death compartments in two subcompartments, indicating that the data are not well
explained by a simple homogeneous model, as seen in Figure 7. Such heterogeneity could
originate from underlying structuring variables, such as comorbidity or (actual) age, that
we are not accounting for. Many estimates of clinical features, such as the incubation
period, are obtained from a pooled dataset that does not take heterogeneity in the population into account [1, 6, 17, 37, 39, 40, 53]. When estimating the total number of infected
individuals using only a fraction of the detected cases, e.g., using the hospital admissions
or deaths, it is interesting to keep in mind that the time periods estimated from pooled
studies could be inaccurate for the fraction of infected individuals under consideration.

Acknowledgements
The authors thank the Center for Interdisciplinary Research in Biology (CIRB) for funding and the taskforce MODCOV19 of the INSMI (CNRS) for their technical/scientific support during the epidemic. P.C. has received funding from the European Union’s Horizon
2020 research and innovation program under the Marie Skłodowska-Curie grant agreement
PolyPath 844369.

References
[1] Jantien A. Backer, Don Klinkenberg, and Jacco Wallinga. Incubation period of 2019
novel coronavirus (2019-nCoV) infections among travellers from Wuhan, China, 2028 January 2020. Eurosurveillance, 25(5), 2020. ISSN 15607917. doi:10.2807/15607917.ES.2020.25.5.2000062.
[2] J. Baker, P. Chigansky, K. Hamza, and F. C. Klebaner. Persistence of small noise
and random initial conditions. Advances in Applied Probability, 50(A):67–81, 2018.
doi:10.1017/apr.2018.71.
[3] Frank Ball. A unified approach to the distribution of total size and total area under
the trajectory of infectives in epidemic models. Advances in Applied Probability, 18
(2):289–310, 1986. doi:10.2307/1427301.
33

Notation
Rpost
W

Description
Reproduction number during lockdown

Value

Source

0.734

E

Total number of infections before March 17 9.52 × 105
2020

E

pcrit + psev

Probability of being hospitalized

0.036

[47]

pcrit (1−dhosp )
pcrit +psev

Probability of entering ICU conditional on
being at the hospital

0.19

[47]

dhosp +(1−dhosp )dICU
1+psev /pcrit

Death probability conditional on being hospitalized

0.181

[47]

dICU

Probability of death conditional on being in
ICU

0.709

E

pshort

Probability of a short stay at hospital

0.701

E

DCh

Delay between severe infection and hospital
admission

14.5 days

E

Dshort

Delay between hospital admission and quick
discharge

7.36 days

E

Dlong

Delay between hospital admission and slow
discharge

47.5 days

E

DCu

Delay between critical infection and hospital
admission

11.0 days

E

DH

Delay between hospital admission and ICU
admission

1.5 days

[47]

DU

Delay between ICU admission and discharge

28.2 days

E

DD

Delay between ICU admission and death

9.90 days

E

0.316

E

γ

Scale parameter common to all Gamma distributions

Table 3: Inferred parameter set for the occupancy model. The values indicated for the
durations correspond to the means of the Gamma distributions. In the “Source” column,
“E” indicates that the parameter has been estimated in the current work.

34

[4] A. D. Barbour, P. Chigansky, and F. C. Klebaner. On the emergence of random
initial conditions in fluid limits. Journal of Applied Probability, 53(4):1193–1205,
2016. doi:10.1017/jpr.2016.74.
[5] Andrew D Barbour. The duration of the closed stochastic epidemic. Biometrika, 62
(2):477–482, 1975.
[6] Qifang Bi, Yongsheng Wu, Shujiang Mei, Chenfei Ye, Xuan Zou, Zhen Zhang,
Xiaojian Liu, Lan Wei, Shaun A Truelove, Tong Zhang, Wei Gao, Cong Cheng,
Xiujuan Tang, Xiaoliang Wu, Yu Wu, Binbin Sun, Suli Huang, Yu Sun, Juncen
Zhang, Ting Ma, Justin Lessler, and Teijian Feng. Epidemiology and transmission of COVID-19 in Shenzhen China: Analysis of 391 cases and 1,286 of their
close contacts. medRxiv, 2020. doi:10.1101/2020.03.03.20028423. URL https:
//www.medrxiv.org/content/10.1101/2020.03.03.20028423v2.
[7] Fred Brauer. The Kermack–McKendrick epidemic model revisited. Mathematical
Biosciences, 198:119–131, 2005. doi:10.1016/j.mbs.2005.07.006.
[8] Fred Brauer, Carlos Castillo-Chavez, and Zhilan Feng. Mathematical Models in
Epidemiology. Texts in Applied Mathematics. Springer-Verlag New York, 2019.
doi:10.1007/978-1-4939-9828-9.
[9] Tom Britton and Gianpaolo Scalia Tomba. Estimation in emerging epidemics: biases and remedies. Journal of The Royal Society Interface, 16:20180670, 2019.
doi:10.1098/rsif.2018.0670.
[10] D. Cereda, M. Tirani, F Rovida, V Demicheli, M Ajelli, P Poletti, F Trentini,
G Guzzetta, V Marziano, A Barone, M Magoni, S Deandrea, G Diurno, M Lombardo, M Faccini, A Pan, R Bruno, E Pariani, G Grasselli, A Piatti, M Gramegna,
F Baldanti, A Melegaro, and S Merler. The early phase of the COVID-19 outbreak
in Lombardy, Italy. 2020.
[11] Dorothy H. Crawford. Deadly companions: how microbes shaped our history. Oxford
University Press, second edition, 2018. ISBN 9780192552976.
[12] Laura Di Domenico, Giulia Pullano, Chiara E. Sabbatini, Pierre-Yves Boëlle, and
Vittoria Colizza. Impact of lockdown on COVID-19 epidemic in île-de-france and
possible exit strategies. BMC Medicine, 18:240, 2020. doi:10.1186/s12916-020-016984.
[13] Odo Diekmann. Limiting behaviour in an epidemic model. Nonlinear Analysis:
Theory, Methods & Applications, 1:459–470, 1977. doi:10.1016/0362-546X(77)900116.
[14] Odo Diekmann, J. A. P. Heesterbeek, and J. A. J. Metz. On the definition and
the computation of the basic reproduction ratio R0 in models for infectious diseases
in heterogeneous populations. Journal of Mathematical Biology, 28:365–382, 1990.
doi:10.1007/BF00178324.
[15] Odo Diekmann, J.A.J. Metz, and J.A.P. Heesterbeek. The legacy of Kermack and
McKendrick. In D. Mollison, editor, Epidemic Models: Their Structure and Relation
35

to Data. Cambridge University Press, Cambridge, 1995. URL http://pure.iiasa.
ac.at/id/eprint/4339/.
[16] Odo Diekmann, Hans Heesterbeek, and Tom Britton. Mathematical Tools for Understanding Infectious Disease Dynamics. Princeton Series in Theoretical and Computational Biology. Princeton University Press, 2013.
[17] Ramses Djidjou-Demasse, Yannis Michalakis, Marc Choisy, Micea T Sofonea, and
Samuel Alizon. Optimal COVID-19 epidemic control until vaccine deployment.
medRxiv, 2020.
[18] Jean-Jil Duchamps, Félix Foutel-Rodier, and Emmanuel Schertzer. General epidemiological models: Law of large numbers and contact tracing. arXiv preprint
arXiv:2106.13135, 2021.
[19] Theodoros Evgeniou, Mathilde Fekom, Anton Ovchinnikov, Raphael Porcher,
Camille Pouchol, and Nicolas Vayatis.
Epidemic models for personalised
COVID-19 isolation and exit policies using clinical risk predictions. medRxiv,
2020. doi:10.1101/2020.04.29.20084707. URL https://www.medrxiv.org/content/
early/2020/05/12/2020.04.29.20084707.
[20] Jie Yen Fan, Kais Hamza, Peter Jagers, and Fima Klebaner. Convergence of the age
structure of general schemes of population processes. Bernoulli, 26(2):893–926, 2020.
[21] Luca Ferretti, Chris Wymant, Michelle Kendall, Lele Zhao, Anel Nurtay, Lucie
Abeler-Dörner, Michael Parker, David Bonsall, and Christophe Fraser. Quantifying SARS-CoV-2 transmission suggests epidemic control with digital contact tracing.
Science, 368(6491), 2020. ISSN 0036-8075. doi:10.1126/science.abb6936.
[22] Regis Ferriere and Viet Chi Tran. Stochastic and deterministic models for agestructured populations with genetically variable traits. In ESAIM: Proceedings, volume 27, pages 289–310. EDP Sciences, 2009.
[23] Raphaël Forien, Guodong Pang, and Étienne Pardoux. Estimating the state of the
COVID-19 epidemic in France using a model with memory. Royal Society Open
Science, 8:202327, 2021. doi:10.1098/rsos.202327.
[24] Santé Publique France. Données hospitalières relatives à l’épidémie de COVID-19,
2020. URL https://www.data.gouv.fr/.
[25] Santé Publique France. COVID-19 : point épidémiologique du 4 juin 2020, 2020.
URL https://www.santepubliquefrance.fr.
[26] Tapiwa Ganyani, Cécile Kremer, Dongxuan Chen, Andrea Torneri, Christel Faes,
Jacco Wallinga, and Niel Hens. Estimating the generation interval for coronavirus
disease (COVID-19) based on symptom onset data, March 2020. Eurosurveillance,
25:2000257, 2020. doi:10.2807/1560-7917.ES.2020.25.17.2000257.
[27] Kais Hamza, Peter Jagers, and Fima C Klebaner. The age structure of populationdependent general branching processes in environments with a high carrying capacity.
Proceedings of the Steklov Institute of Mathematics, 282(1):90–105, 2013.
36

[28] Hisashi Inaba. Age-Structured Population Dynamics in Demography and Epidemiology. Springer Singapore, Singapore, 2017. doi:10.1007/978-981-10-0188-8.
[29] Peter Jagers. Branching processes with biological applications. Wiley, 1975.
[30] Peter Jagers and Fima C Klebaner. Population-size-dependent and age-dependent
branching processes. Stochastic Processes and their Applications, 87(2):235–254,
2000.
[31] Peter Jagers and Fima C Klebaner. Population-size-dependent, age-structured
branching processes linger around their carrying capacity. Journal of Applied Probability, 48(A):249–260, 2011.
[32] Peter Jagers and Olle Nerman. Limit theorems for sums determined by branching and
other exponentially growing processes. Stochastic Processes and their Applications,
17(1):47–71, 1984. ISSN 03044149. doi:10.1016/0304-4149(84)90311-9.
[33] Peter Jagers and Olle Nerman. The growth and composition of branching populations. Advances in Applied Probability, 16(2):221–259, 1984. ISSN 0001-8678.
doi:10.2307/1427068.
[34] William O. Kermack and Anderson G. McKendrick. A contribution to the mathematical theory of epidemics. Proceedings of the Royal Society of London. Series
A, Containing Papers of a Mathematical and Physical Character, 115(772):700–721,
1927. doi:10.1098/rspa.1927.0118.
[35] Mi-Young Kim. Long-time stability of numerical solutions to Gurtin–MacCamy equations by method of characteristics. Applied Mathematics and Computation, 176:
552–562, 2006. doi:10.1016/j.amc.2005.10.050.
[36] H. Krauss. Zoonoses : infectious diseases transmissible from animals to humans.
ASM Press, 2003. ISBN 1555812368.
[37] Stephen A Lauer, Kyra H Grantz, Qifang Bi, Forrest K Jones, Qulu Zheng, Hannah R
Meredith, Andrew S Azman, Nicholas G Reich, and Justin Lessler. The incubation
period of coronavirus disease 2019 (COVID-19) from publicly reported confirmed
cases: Estimation and application. Annals of internal medicine, 172(9):577–582,
2020. ISSN 1539-3704. doi:10.7326/M20-0504.
[38] Noémie Lefrancq, Juliette Paireau, Nathanaël Hozé, Noémie Courtejoie, Yazdan
Yazdanpanah, Lila Bouadma, Pierre-Yves Boëlle, Fanny Chereau, Henrik Salje,
and Simon Cauchemez. Evolution of outcomes for patients hospitalised during the
first 9 months of the SARS-CoV-2 pandemic in France: A retrospective national
surveillance data analysis. The Lancet Regional Health - Europe, 5:100087, 2021.
doi:10.1016/j.lanepe.2021.100087.
[39] Natalie M. Linton, Tetsuro Kobayashi, Yichi Yang, Katsuma Hayashi, Andrei R.
Akhmetzhanov, Sung-mok Jung, Baoyin Yuan, Ryo Kinoshita, and Hiroshi Nishiura.
Incubation period and other epidemiological characteristics of 2019 novel coronavirus
infections with right truncation: A statistical analysis of publicly available case data.
Journal of Clinical Medicine, 9:538, 2020. doi:10.3390/jcm9020538.
37

[40] Clément Massonnaud, Jonathan Roux, and Pascal Crépey.
COVID19:
Forecasting short term hospital needs in France.
medRxiv, 2020.
doi:10.1101/2020.03.16.20036939.
URL https://www.medrxiv.org/content/
early/2020/03/20/2020.03.16.20036939.
[41] J. A. J. Metz. The epidemic in a closed population with all susceptibles equally
vulnerable; some results for large susceptible populations and small initial infections.
Acta Biotheoretica, 27:75–123, 1978. doi:10.1007/BF00048405.
[42] J. A. J. Metz and Odo Diekmann. The Dynamics of Physiologically Structured
Populations. Lecture Notes in Biomathematics. Springer, Berlin, Heidelberg, 1986.
doi:10.1007/978-3-662-13159-6.
[43] Olle Nerman. On the convergence of supercritical general (C-M-J) branching processes. Zeitschrift für Wahrscheinlichkeitstheorie und Verwandte Gebiete, 57(3):365–
395, 1981. ISSN 00443719. doi:10.1007/BF00534830.
[44] Guodong Pang and Etienne Pardoux. Functional limit theorems for non-Markovian
epidemic models. arXiv preprint arXiv:2003.03249, 2020.
[45] Joannes Reddingius. Notes on the mathematical theory of epidemics. Acta Biotheoretica, 20:125–157, 1971. doi:10.1007/BF01556687.
[46] Lionel Roques, Etienne K Klein, Julien Papaix, Antoine Sar, and Samuel Soubeyrand.
Using early data to estimate the actual infection fatality ratio from COVID-19 in
France. Biology, 9(5):97, 2020.
[47] Henrik Salje, Cécile Tran Kiem, Noémie Lefrancq, Noémie Courtejoie, Paolo Bosetti,
Juliette Paireau, Alessio Andronico, Nathanaël Hozé, Jehanne Richet, Claire-Lise
Dubost, Yann Le Strat, Justin Lessler, Daniel Levy-Bruhl, Arnaud Fontanet, Lulla
Opatowski, Pierre-Yves Boelle, and Simon Cauchemez. Estimating the burden
of SARS-CoV-2 in France. Science, 369(6500):208–211, 2020. ISSN 0036-8075.
doi:10.1126/science.abc3517.
[48] Emmanuel Schertzer and Florian Simatos. Height and contour processes of CrumpMode-Jagers forests (I): general distribution and scaling limits in the case of short
edges. Electronic Journal of Probability, 23:43pp., 2018.
[49] Thomas Sellke. On the asymptotic distribution of the size of a stochastic epidemic.
Journal of Applied Probability, 20(2):390–394, 1983.
[50] Mircea T. Sofonea, Bastien Reyné, Baptiste Elie, Ramsès Djidjou-Demasse, Christian Selinger, Yannis Michalakis, and Samuel Alizon. Epidemiological monitoring
and control perspectives: application of a parsimonious modelling framework to the
COVID-19 dynamics in France. medRxiv, 2020. doi:10.1101/2020.05.22.20110593.
[51] Ziad Taïb. Branching Processes and Neutral Evolution, volume 93 of Lecture Notes
in Biomathematics. Springer Berlin Heidelberg, Berlin, Heidelberg, 1992. ISBN 9783-540-55529-2. doi:10.1007/978-3-642-51536-1. URL http://link.springer.com/
10.1007/978-3-642-51536-1.

38

[52] Horst R. Thieme. Renewal theorems for some mathematical models in epidemiology.
Journal of Integral Equations, 8(3):185–216, 1985.
[53] Lauren Tindale, Michelle Coombe, Jessica E Stockdale, Emma Garlock, Wing
Yin Venus Lau, Manu Saraswat, Yen-Hsiang Brian Lee, Louxin Zhang, Dongxuan
Chen, Jacco Wallinga, and Caroline Colijn. Transmission interval estimates suggest
pre-symptomatic spread of COVID-19. medRxiv, page 2020.03.03.20029983, 2020.
doi:10.1101/2020.03.03.20029983.
[54] Viet Chi Tran. Large population limit and time behaviour of a stochastic particle
model describing an age-structured population. ESAIM: Probability and Statistics,
12:345–386, 2008.
[55] Robert Verity, Lucy C. Okell, Ilaria Dorigatti, Peter Winskill, Charles Whittaker,
Natsuko Imai, Gina Cuomo-Dannenburg, Hayley Thompson, Patrick G. T. Walker,
Han Fu, Amy Dighe, Jamie T. Griffin, Marc Baguelin, Sangeeta Bhatia, Adhiratha
Boonyasiri, Anne Cori, Zulma Cucunubá, Rich FitzJohn, Katy Gaythorpe, Will
Green, Arran Hamlet, Wes Hinsley, Daniel Laydon, Gemma Nedjati-Gilani, Steven
Riley, Sabine van Elsland, Erik Volz, Haowei Wang, Yuanrong Wang, Xiaoyue Xi,
Christl A. Donnelly, Azra C. Ghani, and Neil M. Ferguson. Estimates of the severity
of coronavirus disease 2019: a model-based analysis. The Lancet Infectious Diseases,
20(6):669–677, 2020. ISSN 1473-3099. doi:10.1016/S1473-3099(20)30243-7.
[56] Jacco Wallinga and Marc Lipsitch. How generation intervals shape the relationship
between growth rates and reproductive numbers. Proceedings of the Royal Society
B: Biological Sciences, 274:599–604, 2007. doi:10.1098/rspb.2006.3754.
[57] Joseph T. Wu, Kathy Leung, Mary Bushman, Nishant Kishore, Rene Niehus,
Pablo M. de Salazar, Benjamin J. Cowling, Marc Lipsitch, and Gabriel M. Leung.
Estimating clinical severity of COVID-19 from the transmission dynamics in Wuhan,
China. Nature Medicine, 26(4):506–510, 2020. doi:10.1038/s41591-020-0822-7.

A
A.1

Appendix
Numerical simulation of the PDE

Computing the likelihood of our model requires to obtain an expression for the solution
(n(t, a); t, a ≥ 0) of the PDE (5). This equation was solved numerically using a backward
difference scheme based on the method of characteristics [35].
For h > 0, we approximate the value of (n(t, a); t, a ≥ 0) on the lattice {(ih, kh); i ≤
∗
T , k ≤ A∗ } by the array (u(k, i); k, i) defined as follows:
∀k ≤ T ∗ − 1, i ≤ A∗ − 1, u(k + 1, i + 1) = u(k, i)
∀i ≤ A∗ , u(0, i) = x0 g(ih)
∗

∗

∀k ≤ T − 1,

u(k + 1, 0) = h

A
X
i=1

39

τ (ih)u(k + 1, i).

Note that individuals with age larger than hA∗ are discarded. This maximal age was
chosen so that individuals with age greater than hA∗ have negligible infection rate, and
belong to the dead or recovered compartment with high probability.

A.2

Predicted number of entrances in a state

Theorem 2 provides an expression for the number of individuals ni (t) in compartment i
at time t. As we want to fit “incidence” data, that is, the number of individuals that enter
a given compartment, we need to derive an expression for this quantity. To this aim, for
two compartments i, j ∈ S, let us write i  j if an individual must visit i before it gets
to j. For instance, in the admission model we have C  H  I  D. Then, the number
of entrances ei (t, t + s) in i between t and t + s is given by
X
ei (t, t + s) = ni (t + s) − ni (t) +
nj (t + s) − nj (t).
(19)
ji
j6=i

The last term in the previous sum corresponds to the number of individuals who leave
compartment i during [t, t+s]. Expression (19) can be readily used to derive the predicted
number of entrance in i from (n(t, a); t, a ≥ 0) and (p(a, j); a ≥ 0).
It is interesting to note that (19) only depends on the distribution of the entrance time
Ti of (X(a); a ≥ 0) in i, defined as:
Ti := inf{a ≥ 0 : X(a) = i}
with the convention inf ∅ = ∞. To see this, one can write
Z ∞

 X
ei (t, t + s) =
n(t + s, a) − n(t, a)
pj (a) da
0

Z
=

ji
∞


n(t + s, a) − n(t, a) P(Ti ≤ a)da.

0

From an inference perspective, this is quite convenient since computing ei (t, t + s) only
requires to infer the distribution of Ti .

A.3

Likelihood computation

The daily incidence and prevalence data for France between March 18 and May 11 were
taken from [24]. The days during this time period are indexed by {1, 2, . . . , tmax }, where
day 1 is March 18 and day tmax is May 11.
For i ∈ {H, U, D}, we denote by eobs
i (t) the reported number of admissions to hospital,
ICU, or the number of deaths on day t, respectively. Moreover, for i ∈ {H, U, R}, we
denote by nobs
i (t) the reported number of occupied beds in hospital, ICU, or the number
of discharged patients on day t, respectively. Let us further denote by
π(k; λ) = e−λ

λk
k!

the probability mass function of a Poisson distribution with parameter λ.
40

Then, the likelihood of a parameter set θ under the admission model is given by
Lad (θ) =

Y

tY
max


π eobs
i (tk ); ei (tk−1 , tk ) .

i∈{H,U,D} k=1

The predicted number of entrances in state i, ei (tk−1 , tk ), is computed using (19) with the
one-dimensional marginals of the admission model and the numerical approximation of
(5) described in Section A.1.
For the occupancy model, the likelihood of the parameter set θ is given by
Loc (θ) =

Y

tY
max

π

eobs
i (tk ); ei (tk−1 , tk )

i∈{H,U,D} k=1



×

Y

tY
max


π nobs
i (tk ); ni (tk ) .

(20)

i∈{H,U,R} k=1

Again, the value of ei (tk−1 , tk ) is computed using (19) and that of ni (tk ) using (17), but
using the one-dimensional marginals of the occupancy model. Note that under this more
complex model, there are two pathways to hospital (critical and severe infection), two
pathways to death (with or without hospital admission), and three pathways to hospital
discharge (fast discharge, slow discharge, or discharge of ICU patients). The predicted
values for the number of individuals in each of these compartments is obtained by summing
over all pathways leading to the corresponding state.
For both models, we looked for the parameter set θ maximizing the likelihood. It was
obtained using the minimize function of the Python scipy.optimize module, using a
Nelder-Mead algorithm. We selected as initial point of the optimization algorithm a set
of parameters that were close to the existing estimates in the literature, or which seemed
realistic if such estimates did not exist.

A.4

Best fitting prevalence curves under admission model

Recall the admission model from Section 4.3. By adding two parameters to the model, one
for the mean time between hospital admission and discharge, the other for the mean time
between ICU admission and discharge, we can derive an expression for the likelihood of
the prevalence and incidence time series under the admission model, similar to (20). The
best-fitting values for these two parameters were obtained by maximizing the likelihood
with all other parameters values fixed to those estimated in Table 2. The corresponding
model is displayed in Figure 7.

41

Figure 7: Best fit of the admission model for prevalence data.

42

