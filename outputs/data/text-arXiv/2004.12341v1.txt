Predictive data assimilation through Reduced Order
Modeling for epidemics with data uncertainty
T. Chacón Rebollo∗

D. Franco Coronil†

April 28, 2020

arXiv:2004.12341v1 [q-bio.PE] 26 Apr 2020

Abstract
In this article, we develop a data assimilation procedure to predict the evolution of
epidemics with data uncertainty, with application to the Covid-19 pandemic. We construct
a vademecum of solutions by solving the SIR epidemic model for a set of data neighboring
the estimated real (or official) ones. A reduced basis is constructed from this vademecum
through Proper Orthogonal Decomposition (POD). The reduced POD base is then applied
to assimilate the pandemic data (infected, recovered, deceased) during the period in which
data are known, by a least squares procedure. The fitted curves are then used to predict
the evolution of the pandemic in the next days. Validation tests for Andalusia region
(Spain), Italy and Spain show accurate predictions for 7 days that improve as the number
of assimilated data increases.

Keywords Proper Orthogonal Decomposition; SIR model; Covid19 pandemic; Data assimilation, Pandemic prediction

1

Introduction

One of the largest difficulties when dealing with predictive estimates of the evolution of the
Covid-19 pandemic is the lack of reliable data on real number of infected people, as well as
infection, recovery and death rates. There are, however, reference data that present some
variability from a country or region to another. Moreover these parameters in each actual
country or region may vary in time due to the relaxation of the population in the respect of
the lockdown measures or changes in the availability of health care resources, among other
factors. Moreover, there is a number of reliable data, essentially the recovered and deceased
populations.
The use of standard mathematical models of the epidemic thus faces important incertitudes.
These may be afforded with statistical techniques, that should be based upon medical tests,
and are scarce in some countries. Also with least squares techniques, that allow to recover
estimates for the lacking parameters.
We afford here the use of Reduced Order Modeling (ROM) to approximate the evolution of
the pandemic and predict its future evolution. ROM allows to extract the dominant patterns
of parametric systems, providing approximating spaces of very low dimension and excellent
accuracy properties.
Our approach is based upon the construction of a vademecum of solutions if the SIR model,
for values of the parameters neighboring the reference ones and long time periods of evolution
1

Dpto. EDAN & IMUS, University of Seville, Campus de Reina Mercedes, 41012 Sevilla (Spain), e-mail:
chacon@us.es
2
Dpto. EDAN, University of Seville, Campus de Reina Mercedes, 41012 Sevilla (Spain), e-mail: franco@us.es

1

of the pandemic. A reduced basis is then constructed by the Proper Orthogonal Decompostion
(POD), that approximates with good accuracy all the solutions in the vademecum. Least
squares is then used to approximate on this reduced space the reliable data for a time period
in which these are known. This circumvents the need of accurate values for the parameters to
obtain evolution curves of the pandemic. The fitted curves are then used to estimate the future
evolution of the pandemic.
We perform some validation tests with data of the evolution of the pandemic with analytic
functions and solutions of the SIR model, that show that the procedure provides quite accurate
fitting if the number of data is large enough. Also that assimilating data in a small time
interval to a very small number of POD modes provides a qualitative good approximation of the
evolution of the epidemic with relatively few elements in the vademecum. This approximation
becomes fairly accurate if the vademecum is conveniently enriched. We apply the procedure to
predict the evolution of the Covid-19 pandemic in Andalusia region, Spain and Italy. In despite
of the fact that the official data on active infected people are well known to be far from the
real ones, we obtain good accuracy in the prediction of the pandemic evolution in the next 7
days, with relative errors in infected, recovered and deceased populations typically below 4%,
that are smaller for larger numbers of assimilated data increase.
The paper is organized as follows. The construction of the vademecum of solution is described in Section 2, the assimilation method is described in Section 3 and the least squares
procedure in Section 4. Section 5 deals with the validation of the procedure, while finally
Section 6 presents some conclusions.

2

Vademecum of model solutions

We start form the basic SIR model, with variable infection rate, that we assume to correctly
describe the pandemic:

S


I,
S 0 = −α(t)


S∞
S
(1)
0
I
=
α(t)
I − β I,


S∞

 0
R = β I.
Here S, I, and R respectively are the number of susceptible, infected and recovered individuals;
S∞ is the total population, α is the transmission rate, that we assume variable in time, and β
is the recovery rate. The function α(t) and the parameter β respectively are the inverse of the
characteristic infection Ti (t) and recovery times Tr . If we consider the basic reproduction rate
r0 (t) =
we write the model as

α(t)
Tr
=
,
β
Ti (t)


S

S 0 = −β R0 (t)
I,



S∞


S
0
I = β r0 (t)
− 1 I,


S∞

 0
R = β I.

(2)

This model should be complemented with initial conditions
I(0) = I0 ,

R(0) = R0 ,

S(0) = S0 = S∞ − I0 − R0 .

(3)

In practice we shall approximate r0 by piecewise constant functions, taking into consideration the relaxation of the lockdown restriction as times goes on.
2

We know reference values for r0 for the Covid-19 epidemic, ranging from 0.5 when the
lockdown measures take place for time enough, and up to 3 if no protection measures are
taken. Also, a reference values for the recovery time Tr is 15 (cf. Gutiérrez and Varona [5],
Jiwei et al. [6]).
The real amount of infected people I0 is far from being known, there are several estimates
that give factors of around 15 times the official values. For instance in France the value of
initially infected possibly is nearly 14 times the official one (cf. Roque et al. [8]). However we
shall take as reference values for I0 , and for R0 , the official number of infected and recovered
people, respectively, at the initial time of our computation. As we shall see it will not be
necessary to provide accurate approximations of the initial values of infected population to
obtain good approximations of the recovered and deceased populations, which are the ones
that affect the health care systems.
To construct our vademecum of solutions we define r0 as

rref,1 if 0 < t < T1 ,
r0 (t) =
(4)
rref,2 if T1 ≤ t < T,
where rref,1 and rref,2 are reference values for r0 in the time intervals [0, T1 ] and [T1 , T ]. The first
time interval corresponds to the initial phase of the lockdown with strict fitting of protection
measures by the people (21 days). The second one correspond to a second phase in which there
is some relaxation of the lockdown measures. We have taken rref,1 = 1.1 and rref,2 = 0.8.
We do not consider the initial phase of the epidemic in which no protection measures are
taken, this period can be skipped as the data during the time interval [0, T ] are known. Our
purpose is to use these data to predict the evolution of the epidemic in times later than T .
We build the vademecum of solutions by solving the SIR model (2) for a set of discrete values
of the parameters rref,1 , rref,2 , Tr , I0 and R0 neighboring the reference values. We typically take
4 for both the initial conditions and for the parameters, equally spaced. The computation time
T is large enough to let the epidemic reach its steady state for all set of parameters considered.
We use the ODE45 Mathlab solver to perform the computations, with a time step of 0.01 days.
We denote the vademecum of solutions as {Ip }Pp=1 , {Rp }Pp=1 , where P is the total number of
runs generated by combining the different discrete values of the parameters. We assume that
we know Ip and Rp at discrete times tn = n ∆t, n = 0, 1, · · · , M , so that T = M ∆t, and denote
Ipn = Ip (tn ) and similarly Rpn . In practice we take ∆t = 1 day.

3

Construction of Reduced Basis

To build the reduced basis we apply the Proper Orthogonal Decomposition (POD) to the
vademecum of solutions computed as described in the preceding section. Our claim is that if
the true parameters that govern the epidemic lie within the range of parameters that we consider
to build the vademecum, then the essential patterns of the epidemic will be well approximated
by the linear space spanned by the vademecum solutions. Indeed, the solution of the initial
value problem (2)-(3) depends continuously on the initial data, parameter β and reproduction
rate r0 (t). If we denote its solution by FF0 ,β,r0 (t) with FF0 ,β,r0 (t) = (S(t), I(t), R(t)) ∈ R3 ,
F0 = (S0 , I0 , R0 ) ∈ R3 , then it holds
Lemma 3.1. Assume that S0 ≥ 0, I0 ≥ 0, R0 ≥ 0, that β, β 0 lie in a bounded set B ⊂ R and
that r0 , r00 lie in a bounded set R ⊂ L∞ (0, T ). Then
kFF0 ,β,r0 (t) − FF00 ,β 0 ,r00 (t)kR3 ≤ kF0 − F00 kR3 ea t +

3


b at
e −1
a

∀t ∈ [0, T ],

where
a = (2 + (S∞ + 1) R) B,

b = 2(S∞ + 1) R |β − β 0 | + S∞ B kr0 − r00 kL∞ (0,T ) ,

with
B = max |β|,
β∈B

R = max kr0 kL∞ (0,T ) .
r0 ∈R

Proof: The proof is standard by Gronwall’s Lemma, using that S, I and R are non-negative
and bounded by S∞ .
.
Then if our discretization of the parameters space is fine enough, we will obtain a good
approximation of the epidemic evolution in the space spanned by the solution of the SIR
model.
As a consequence, in principle a least-squares fitting of the true epidemic data on the space
spanned by the parametric solutions of the SIR model could give a good approximation of the
evolution of the epidemic. However the grassmaniann matrices associated to the vademecum
are singular up to computer precision.
Instead we consider a reduced order approximation of the parametric solutions space. The
POD allows to construct a reduced basis that retains the dominant patterns in the vademecum,
and generate a space that provides a good approximation of the one spanned by the vademecum
functions.
The Proper Orthogonal (or Karhunen-Loève) decomposition provides a technique to obtain
low-dimensional approximations of parametric functions. To describe it in our framework (cf.
Azaı̈ez et al.[4]), let us consider a Hilbert space H of finite dimension, endowed with a scalar
product (·, ·)H , and a parameter measure space G endowed with a measure µ. In our case
H = RK (for some K that we shall specify in the sequel) endowed with the discrete l2 (0, tK )
inner product,
K
X
um wm , ∀u, w ∈ H;
(u, w)H = ∆t
m=0

and G = {1, 2, · · · , P } endowed with the discrete measure given by
µ(S) = card(S),

∀S ⊂ G,

where card(S) denotes the cardinal of the set S. Let us consider a function f ∈ L2 (G, H; dµ),
and introduce the POD operator
Z
A : H 7→ H,

Aψ =

f (γ) (f (γ), ψ)H dµ(γ) =
G

P
X

fp ∆t

p=1

K
X

fpi ψi

for ψ ∈ H,

i=1

where we denote fp = f (p) and fp = (fp1 , · · · , fpK ) ∈ H, for all p ∈ G. The POD operator is
trivially linear and bounded. Moreover it is self-adjoint and non-negative, as A = B ∗ B, where
B : H 7→ L2 (G; dµ) and its adjoint operator B ∗ : L2 (G; dµ) 7→ H are given by (cf. Muller [7],
Chapter 2)
(Bϕ)(γ) = (f (γ), ϕ)H

for ϕ ∈ H,

B ∗ v = (v, f )L2 (G;dµ)

for v ∈ L2 (G; dµ).

(5)

Consequently, there exists an orthonormal basis of H formed by eigenvectors {v m }m≥0 of A,
associated to non-negative eigenvalues {λm }m≥0 .
The main interest of the POD is the following best-approximation property (cf. [7], Chapter
2):

4

Lemma 3.2. Let Vl = Span(v 1 , · · · , v l ) ⊂ H. Let Wl be any sub-space of H of dimension l.
Then
Z
Z
2
dH (f (γ), Vl ) dγ ≤
dH (f (γ), Wl )2 dγ,
G

G

where
dH (ϕ, Wl ) = inf kϕ − ψkH
ψ∈Wl

for ϕ ∈ H

denotes the distance from the element ϕ ∈ H to the sub-space Wl .
In other words, the space spanned by the first l eigenfunctions of the POD operator provides the best approximation to f in parametric mean distance, among all subspaces of H of
dimension l (or smaller).
From a practical standpoint, to construct the POD of the vademecum (for instance for
infected people) it turns out that the correlation matrix C ∈ RN ×N relative to the euclidean
product in the parameter space,
Cij = ∆t

P
X

Ipi Ipj ,

i, j = 1, · · · , K

p=1

is the representation matrix of the POD operator A with respect to the canonical basis of H =
RK . Therefore, if we consider the diagonalization of matrix C,
C = V t DV,
–where D ∈ RN ×N is a diagonal matrix and V ∈ RN ×N is an orthogonal matrix–, then the
diagonal elements of D are the eigenvalues of the POD operator A (that we assume to be
ordered in decreasing value), and the columns of V are the associated eigenvectors.
Then we extract as reduced basis the set {v 1 , · · · , v N } with N such that λN < ε for a preset
threshold ε. Typically we take ε = 10−6 . This amounts to N ranging from 2 to 13, the reduced
basis really has a very small dimension if we consider that typically the vademecum contains
several thousand functions.

4

Data assimilation by least squares fitting

The last step of the procedure to obtain a prediction of the evolution of the epidemic is to
approximate the real epidemic data by least squares fitting on the reduced space
SN = Span{v 1 , · · · , v M }.
If the data are known in the discrete times t1 , · · · , tk (with tk < T ), we use the discrete L2 (0, tk )
norm to assimilate the data:
kvk2a = ∆t

k
X

|vm |2 ,

∀v ∈ RM .

m=0

We thus search for IN ∈ SN such that
kID − IN ka ≤ kID − Jka , ∀J ∈ SN ,
where ID ∈ Rk+1 are the data for infected people at times t0 , · · · , tk . The same procedure is
used to assimilate the data RD of recovered people.
5

As the solution IN is defined for all times tk for k = 0, · · · , N , the values INi for i > k are
i
used to estimate the values of infected people at later times. Similarly the values RN
for i > k
are used to estimate the future values of recovered people.
The length of the time period during which these estimates will be accurate will depend on
the time smoothness of the function to fit (either I or R), on the accuracy of the approximation
of the parametric solutions of the SIR model provided by our discretization of the parameter
set, on wether our parameter set contains the parameters governing the epidemic evolution,
and finally on how accurately the SIR model approximates the evolution of the pandemic.

5

Validation

Test 1: Validation with analytic functions
We have initially considered some analytic functions to validate the data assimilation procedure,
and determine the range of time in which it may provide a good approximation, beyond the
time interval used to assimilate the data. These are a trigonometric and a Gaussian function,
fT (t) = sin(t) + cos(t)
2 !

t − t0 − 1.5
fG (t) = exp −
10

(6)
(7)

We have respectively used the following vademecums to fit them:
F2k−1 (t) = sin(k t), F2k (t) = cos(k t) for k = 1, · · · , m;

2 !
t − t0 − l
Fl,k (t) = exp −
for l = −m, · · · , m, k = 5, · · · , m + 5,
k

(8)
(9)

for a given integer m ≥ 1.
We present in Figures 1 and 2 the results for the first case. We intend to approximate
function fT in [0, 2 π]. As fT belongs to the vademecum, it should be exactly approximated
when we provide data enough. We set m = 5, then the vademecum contains P = 10 functions,
and provide the values of these functions at equally spaced discrete times tk with step 2 π/100.
We provide data to assimilate for k = 1, · · · , 16. We observe that for N = 10 eigenvectors the
fitting is quite accurate in the whole interval [0, 2 π], while for N = 9 there is a large error.
Providing data for larger times (k ≥ 17) for N = 10 yields a perfect fitting in the interval
[0, 2 π], but it only slightly improves the fitting for N ≤ 9. However if the data grid is refined,
this behavior improves: Figure 2 displays the fitting with 9 eigenfunctions with a grid of half
step, using data in the interval [0, 6 π/5].
In all cases the fitting in the time interval were data are provided is quite accurate.
Figures 3 and 4 display the results for the second analytic test (7)-(9). We intend to
approximate the function fG in the interval [0, 120]. We set t0 = 55 and m = 3, what yields
P = 28 vademecum functions. We provide the values of the vademecum functions at equally
spaced discrete times tk with step 120/100. We provide tk for relatively small intervals [0, 57] and
[0, 60]. We observe that the fitting improves as the interval where data are provided increases,
and a large gain in accuracy can be obtained with few more data (Figure 3). However if this
interval is not large enough (Figure 4) the fitting does not improve as the number of eigenmodes
increases. For a relatively reduced interval where data are provided, the best fit is provided by
a moderate number of eigenmodes. Furthermore, large oscillations of the fitting appear when
the number of eigenmodes is excessive. This possibly occurs because the large frequencies are
not well fitted.
6

POD assimilation of trigonometric function, data provided in [0,8 pi/25]

POD assimilation of trigonometric function. Data provided in [0, 8 pi/25]
1.5

2
Data, f(t)=sin(t)+cos(t)

Data, f(t)=cos(t)+sin(t)

Fitting with 9 eigenfunctions

Fitting with 10 eigenfunctions
1

1

0.5
0

0

-1
-0.5

-2
-1

-3

-1.5
0

1

2

3

4

5

6

7

0

1

2

3

4

5

6

7

Figure 1: Test 1: Data assimilation for trigonometric function

POD assimilation of trigonometric function with refined mesh, data provided in [0,6 pi/5]
1.5
Data, f(t)=sin(t)+cos(t)
Fitting with 9 eigenfunctions
1

0.5

0

-0.5

-1

-1.5
0

1

2

3

4

5

6

7

Figure 2: Test 1: Data assimilation for trigonometric function. Refined mesh data.
In both tests we have observed that large oscillations of the fitting function, beyond the
interval in which data are given, appear when the number of assimilated data is not large
enough for a given amount of eigenfunctions.

Test 2: SIR model solution
This test is intended to analyze the ability of the ROM assimilation procedure to accurately
predict the solution of the SIR model.
With this purpose we have constructed the vademecum by solving model (2) in the time
interval [0, 1100] and time step 1 day, with data S∞ = 47.100.396 (official Spanish population
in 2020), and I0 , R0 , r0 and Tr respectively ranging in the sets {800, 900, 1000}, {50, 60, 70},
{0.6, 0.8, 1.1, 1.3}, and {5, 10, 20, 25}. We have tested the length of the time interval in which
data must be feed to the assimilation algorithm, as well as the number of modes needed to
obtain accurate results.

7

POD assimilation of Gaussian function, data provided in [0,57]

POD assimilation of Gaussian function, data provided in [0,60]
1

1.5
Data, f(t)=exp(-(t-51.5)/10)^2

Data, f(t)=exp(-(t-51.5)/10)^2

Fitting with 5 eigenfunctions

Fitting with 5 eigenfunctions
0.8

1
0.6

0.4

0.5

0.2
0
0

-0.5

-0.2
0

20

40

60

80

100

120

0

20

40

60

80

100

120

Figure 3: Test 1: Data assimilation for Gaussian function. Fitting with 5 eigenfunctions.
Figure 4 shows the assimilation to N = 1 (dominant mode) and N = 4 modes, of the data
for infected people with different intervals of data assimilation. The qualitative behavior of
the pandemic is roughly well approximated when N = 1, with estimated number of maximum
number of infected people between 70% and 130% of those given by the SIR model. In addition,
the estimation of the time at which the number of infected people reach its maximum is well
approximated when N = 4, with increasing global accuracy as the time data interval increases.
Assimilating data with as few data as t1 to t4 (and not less) allows to reproduce the overall
features of the pandemic. This provides data to be assimilated for 4 discrete times, right the
number of parameters on which depends problem (2). However gaining in accuracy for this
vademecum requires a large amount of data, at least for [0, 550], which is almost half of the
time interval in which the epidemic experiences appreciable changes (see Table 1).
Data interval Numer of modes
Relative error
[0, 3]
4
65’55%
11
99’92%
12
Singular Gram Matrix
[0, 550]
4
13’2%
11
10’7%
12
11’4%
[0, 750]
4
8’7%
11
16’9%
12
27’8%
[0, 1.100]
4
5’4%
11
2’3%
12
1’9%
Table 1: Test 2: Errors for data assimilation for SIR model solution to several number of POD
modes and increasing time data intervals. The relative error is calculated in discrete l2 (0, 1.100)
norm
Figure 5 exhibits the comparison of the fitting provided for several number of modes on a
8

SIR Model solution. R_0=1.2, T_R=15. Assimilation of data to 1 (dominant) mode

SIR Model solution. R_0=1.2, T_R=15. Assimilation of data to 4 modes
1.2e+06

1e+06
SIR Model

SIR Model

Data in [0,3]

Data in [0,3]

Data in [0,100]

Data in [0,100]

Data in [0,400]
800000

Data in [0,400]

1e+06

Data in [0,600]

Data in [0,600]

Data in [0,800]

Data in [0,800]
800000

Infected

Infected

600000

600000

400000
400000

200000
200000

0

0
0

200

400

600
Time (days)

800

1000

1200

0

200

400

600
Time (days)

800

1000

1200

Figure 4: Test 2: Data assimilation for SIR model solution to N = 1 (left) and N = 4 (right)
POD modes.
single time interval of data, and for N = 4 modes with different data assimilation intervals. We
observe that in all cases the accuracy is improved with respect to the fitting with 1 mode for a
number of modes between 1 and 4. However a number of modes above 4 produce less accurate
approximations, in some cases with negative values. This is likely due to the high frequency
components that are not well fitted unless the data are provided in a large enough interval,
similarly to what happened in Test 1. The best result correspond to a relatively reduced number
of modes (N = 4). Increasing the fitting data interval progressively decreases the error, that
also is smaller for larger number of modes, decaying to values below 2%. This may also be
observed in Table 1. Note that the error for N = 12 modes is larger than the one for N = 11
modes until the time interval is nearly the full computation time interval.
An alternative, and feasible, way to increase the accuracy is to enrich the vademecum with
additional solutions of the SIR model, for finer grids of data. We have assimilated the SIR
solution data obtained for I0 = 850, R0 = 55, r0 = 1.2 and Tr = 15, as before, but now on
the reduced POD space constructed with the vademecum corresponding to the data I0 = 850,
R0 = 55 and r0 and Tr respectively ranging in the sets {0.6, 0.65, · · · , 1.15} ∪ {1.25, 1.30}, and
{5, 5.5, · · · , 14.5} ∪ {15.5, 16, · · · , 24.5, 25}. Figure 6 displays the assimilation of just 4 data
values, at times t1 to t4 . A good accuracy for the overall evolution of infected and recovered
population is obtained, if the data are assimilated to as low as N = 3 POD eigenmodes. Figure
7 shows the 3 dominant eigenmodes, note that the shape of the first eigenmode retains the
dominant pattern of the pandemic evolution.
In all tests performed up to now we have observed that large oscillations of the fitting
function, beyond the interval in which data are given, appear when the number of data is not
large enough for a given amount of eigenfunctions. This anomalous behavior will be used as
an indicator to avoid un-accurate fitting.

Test 3: Covid-19 pandemic
We have applied the ROM data assimilation procedure to the Covid-19 pandemic with data
from Italy, Spain and the Andalusia region in Spain.
As starting time we take the day when the lockdown took place in each area (March 9 2020
in Italy and March 16 in Andalusia and Spain). To construct the vademecum, as we mentioned
9

SIR Model solution, R_0=1.2, T_r=15. Data assimilation on interval [0,550]

SIR Model solution, R_0=1.2, T_r=15. Data assimilation to 4 modes
700000

800000
Infected, SIR Model

Infected, SIR Model

Estimated infected, 4 modes

Estimated, Data int. [0,550]

Estimated infected, 7 modes

Estimated, Data int. [0,650]

600000

Estimated infected, 12 modes

Estimated, Data int. [0,750]

600000
500000

400000
400000

300000
200000

200000
0
100000

-200000

0
0

200

400

600
Time (days)

800

1000

1200

0

200

400

600
Time (days)

800

1000

1200

Figure 5: Test 2: Data assimilation for SIR model solution to several number of POD modes
on fixed data assimilation interval (left), and to a fixed number of modes on variable data
assimilation intervals (right).
in Section 2 we typically take 4 values for the initial conditions for the parameters, equally
spaced, neighboring the reference values. We also assume the basic reproductive rate r0 to take
two values in different time intervals, as indicated in (4), to take into account the relaxation in
meeting the lockdown measures. The reference times T1 corresponds to the days in which the
lockdown measures appeared to relax in each country or region: T1 = April 4 for Andalusia
Region and March 30 for Italy and Spain. The initial data have been taken at March 17 for
Andalusia and March 9 for Italy and Spain. The computation time T is twice the time in which
assimilation data are provided.

Area
Andalusia

Italy

Spain

Population
Infected
Recovered
Deceased
Infected
Recovered
Deceased
Infected
Recovered
Deceased

Prediction to 5 days
Number of modes Relat. error
7
4’60%%
4
6’95%
4
4’43%
5
2’08%
3
1’47%
5
0’55%
10
2’61%
3
1’29%
7
0’75%

Prediction to 7 days
Number of modes Relat. error
7
3’94%
4
3’25%
5
8’09%
5
3’41%
3
1’44%
5
0’79%
10
2’59%
6
6’85%
7
1’11%

Table 2: Test 3: Maximum relative errors for 5 and 7-days prediction of Covid-19 pandemic
evolution in Andalusia region, Italy and Spain.

To validate the data we use a time period to assimilate the data, and compare the predicted
values in a later time period with the official ones.
We have adapted the ROM data assimilation procedure to the prediction of the number of
deceased people. We split the recovered R into true recovered P and deceased people D, and

10

SIR Model solution. R_0=1.2, T_R=15. Refined vademecum. Assimilation of data to 3 modes

SIR Model solution. R_0=1.2, T_R=15. Refined vademecum. Assimilation of data to 3 modes

700000

2e+07
SIR Model

SIR Model

Data in [0,4]

Data in [0,4]

600000
1.5e+07
500000

1e+07
Infected

Recovered

400000

300000

5e+06

200000
0
100000

0

-5e+06
0

200

400

600
Time (days)

800

1000

1200

0

200

400

600
Time (days)

800

1000

1200

Figure 6: Test 2: Data assimilation with vademecum constructed with refined data grid, for
infected (left) and recovered (right) populations.
rewrite the SIR model as



S0




I0




P0

 0
D

S
I,
S∞
S
= α(t)
I − βr I − βd I
S∞
= βr I,
= βd I,
= −α(t)

(10)

where βr = ρ β and βd = (1 − ρ) β, where ρ ∈ (0, 1) is a new parameter. Given the mortality
of the pandemic, we have set ρ = 0.9 as reference value for this parameter. To compute the
vademecum, the parameter ρ is also let to take 4 values equally spaced around the reference
value, within the interval (0, 1).
Figures 8 displays the results for Andalusia region, Italy and Spain, with official data respectively taken from [1],[3] and [2]. As data for Andalusia and Spain present large daily oscillations,
we have instead used the moving time average over 3 days. We show the comparison of the
fitting curve with the official reported values for the last 5 days. Among all possible number of
modes, we select those for which the fitting function presents the smallest oscillations after the
fitting data interval, without reaching negative values. We observe that the errors within the
fitting interval are very small.
Table 2 displays the relative errors for infected, recovered and deceased people in the three
countries/regions for predictions to the next 5 and 7 days. Both predictions to 5 and 7 days
are rather accurate, with errors typically below 4%, and in all cases below 9%. Errors for Italy
and Spain are smaller, possibly because the populations are larger. The errors corresponding
to predictions of infected and recovered populations to 7 days in Andalusia are smaller than to
5 days. This is not inconsistent as we are fitting the last either 5 or 7 days, and assimilating
the data in all the preceding days. Some oscillations in a relatively small amount of data to
assimilate possibly originate this behavior.

11

Refined vademecum. Three first POD modes for infected population,decreasing size of associated eigenvalues.
0.06
First mode

Refined vademecum. Three first POD modes for recovered population,decreasing size of associated eigenvalues.
0.06

Second mode
Third mode

0.04

0.04

0.02
0.02
0
0
-0.02
-0.02
-0.04

-0.04

-0.06

First mode
Second mode
Third mode

-0.08

-0.06
0

200

400

600
Time (days)

800

1000

1200

0

200

400

600
Time (days)

800

1000

1200

Figure 7: Test 2: Data assimilation with vademecum constructed with refined data grid. First
three dominant eigenvalues for infected (left) and recovered (right) populations.

6

Conclusions

This paper introduces a data assimilation procedure for Covid-19 based upon Reduced Order
Modelling (POD) of the solutions of the SIR epidemic model. It is based upon the hypothesis
that although the actual model parameters that govern the epidemic are unknown, reference
values are known. Thus the actual evolution of the pandemic may be well approximated by
the vademecum generated by solving the SIR model with a number of parameters nearby the
reference ones.
This procedure has been tested with analytic functions and the solution of SIR model. We
have concluded that:
• The fitting error within the data assimilation interval is very small in all cases.
• Assimilating data in a small time interval (at least as many days as parameters appear in
the SIR model) to a very small number of modes provides a qualitative good approximation of the evolution of the epidemic: A rough approximation of the maximum number
of infected persons and of the time at which the maximum takes place.
• This assimilation of a very small number of data on a reduced space of very small dimension becomes fairly accurate if the vademecum formed with solutions of the SIR model is
enriched by refining the parameters grids.
• It is preferable to assimilate data to a moderate number of modes, that provides the best
approximations unless the data fitting interval is very large. For larger number of modes
the high frequencies are not well estimated, and generate large oscillations of the fitting
function beyond the data assimilation time.
• To assimilate data for the true pandemic, a time adjustment of the basic reproductive
rate appears to model the relaxation in the fulfillment of the lockdown measures.
The application of the procedure to the evolution of the Covid-19 pandemic in Andalusia region,
Italy and Spain shows accurate predictions for 5 days, that improve as the number of assimilated
data increases.
12

Figure 8: Test 3: Prediction of Covid-19 pandemic evolution in Andalusia region, Italy and
Spain to 7 days. Red dots represent the assimilated data, blue dots the predicted ones, and
the blue lines are the fitted curves. The peaks in these curves correspond to the change in the
basic reproduction rate r0 .

References
[1] https://www.juntadeandalucia.es/institutodeestadisticaycartografia/badea/operaciones/
consulta/anual/38228?CodOper=b3 2314&codConsulta=38228.
[2] https://github.com/pcm-dpc/COVID-19/blob/master/dati-andamento-nazionale/dpccovid19-ita-andamento-nazionale.csv.
[3] https://covid19.isciii.es/resources/serie historica acumulados.csv.
[4] Mejdi Azaı̈ez, Faker Ben Belgacem, Tomás Chacón Rebollo, Recursive POD
expansion for reaction-diffusion equation Eng. Sci. 3:3 (2016), DOI 10.1186/s40323-0160060-1
[5] José M. Gutiérrez, Juan L. Varona, Análisis de la posible evolución
de la epidemia de coronavirus COVID-19 por medio de un modelo SEIR,
https://www.unirioja.es/apnoticias/servlet/Archivo?C BINARIO=12051 (2020)
[6] Jia Jiwei, Ding Jian, Liu Siyu, Liao Guidong, Li Jingzhi, Duan Ben, Wang
Guoqing, Zhang Ran, Modeling the Control of COVID-19: Impact of Policy Interventions and Meteorological Factors, arXiv:2003.02985v1 (2020).
13

[7] M. Muller M., On the POD Method. An Abstract Investigation with Applications to
Reduced-Order Modeling and Suboptimal Control. Ph D Thesis. Georg-August Universität,
Göttingen (2008).
[8] Lionel Roques, Etienne Klein, Julien Papaı̈x, Samuel Soubeyrand, Modèle
SIR mécanico-statistique pour l’estimation du nombre d’infectés et du taux de mortalité
par COVID-19, arXiv:2003.10720v2 (2020).
[9] M. Müller, On the POD Method. An Abstract Investigation with Applications to
Reduced-Order Modeling and Suboptimal Control, Ph D Thesis. Georg-August Universitt, Gttingen; 2008.

14

