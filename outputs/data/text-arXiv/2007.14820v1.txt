Scalable Estimation of Epidemic Thresholds
via Node Sampling
Anirban Dasgupta and Srijan Sengupta

arXiv:2007.14820v1 [cs.SI] 28 Jul 2020

ABSTRACT
Infectious or contagious diseases can be transmitted from one person to another through
social contact networks. In today’s interconnected global society, such contagion processes can cause global public health hazards, as exemplified by the ongoing Covid-19
pandemic. It is therefore of great practical relevance to investigate the network transmission of contagious diseases from the perspective of statistical inference. An important and widely studied boundary condition for contagion processes over networks is
the so-called epidemic threshold. The epidemic threshold plays a key role in determining
whether a pathogen introduced into a social contact network will cause an epidemic or
die out. In this paper, we investigate epidemic thresholds from the perspective of statistical network inference. We identify two major challenges that are caused by high computational and sampling complexity of the epidemic threshold. We develop two statistically accurate and computationally efficient approximation techniques to address these
issues under the Chung-Lu modeling framework. The second approximation, which is
based on random walk sampling, further enjoys the advantage of requiring data on a
vanishingly small fraction of nodes. We establish theoretical guarantees for both methods and demonstrate their empirical superiority.

Anirban Dasgupta (anirbandg@iitgn.ac.in) is a Professor of Computer Science and Engineering of Indian Institute of Technology at Gandhinagar. His work is partially supported by grants from DBT India,
Google and CISCO. Srijan Sengupta (sengupta@vt.edu) is an Assistant Professor of Statistics at Virginia
Tech. His work is partially supported by an NIH R01 grant 1R01LM013309.

1

1

Introduction

Infectious diseases are caused by pathogens, such as bacteria, viruses, fungi, and parasites. Many infectious diseases are also contagious, which means the infection can be
transmitted from one person to another when there is some interaction (e.g., physical
proximity) between them. Today, we live in an interconnected world where such contagious diseases could spread through social contact networks to become global public
health hazards. A recent example of this phenomenon is the Covid-19 outbreak caused
by the so-called novel coronavirus (SARS-CoV-2) that has spread to many countries
(Huang et al., 2020; Zhu et al., 2020; Wang et al., 2020; Sun et al., 2020). This recent
global outbreak has caused serious social and economic repercussions, such as massive
restrictions on movement and share market decline (Chinazzi et al., 2020). It is therefore of great practical relevance to investigate the transmission of contagious diseases
through social contact networks from the perspective of statistical inference.
Consider an infection being transmitted through a population of n individuals. According to the susceptible-infected-recovered (SIR) model of disease spread, the pathogen
can be transmitted from an infected person (I) to a susceptible person (S) with an infection rate given by β, and an infected individual becomes recovered (R) with a recovery
rate given by µ. This can be modeled as a Markov chain whose state at time t is given
by a vector (X1t , . . . , Xnt ), where Xit denotes the state of the ith individual at time t, i.e.,
Xit ∈ {S, I, R}. For the population of n individuals, the state space of this Markov chain
becomes extremely large with 3n possible configurations, which makes it impractical to
study the exact system. This problem was addressed in a series of three seminal papers
by Kermack and McKendrick (Kermack and McKendrick, 1927, 1932, 1933). Instead of
modeling the disease state of each individual at at a given point of time, they proposed
compartmental models, where the goal is to model the number of individuals in a particular disease state (e.g., susceptible, infected, recovered) at a given point of time. Since
their classical papers, there has been a tremendous amount of work on compartmental modeling of contagious diseases over the last ninety years (Hethcote, 2000; Van den
Driessche and Watmough, 2002; Brauer et al., 2012).
Compartmental models make the unrealistic assumption of homogeneity, i.e., each individual is assumed to have the same probability of interacting with any other individual.
In reality, individuals interact with each other in a highly heterogeneous manner, depending upon various factors such as age, cultural norms, lifestyle, weather, etc. The
contagion process can be significantly impacted by heterogeneity of interactions (Meyers et al., 2005; Rocha et al., 2011; Galvani and May, 2005; Woolhouse et al., 1997), and
therefore compartmental modeling of contagious diseases can lead to substantial errors.
In recent years, contact networks have emerged as a preferred alternative to compartmental models (Keeling, 2005). Here, a node represents an individual, and an edge between two nodes represent social contact between them. An edge connecting an infected
node and a susceptible node represents a potential path for pathogen transmission. This
framework can realistically represent the heterogeneous nature of social contacts, and

2

therefore provide much more accurate modeling of the contagion process than compartmental models. Notable examples where the use of contact networks have led to
improvements in prediction or understanding of infectious diseases include Bengtsson
et al. (2015) and Kramer et al. (2016).
Consider the scenario where a pathogen is introduced into a social contact network and
it spreads according to an SIR model. It is of particular interest to know whether the
pathogen will die out or lead to an epidemic. This is dictated by a set of boundary conditions known as the epidemic threshold, which depends on the SIR parameters β and
µ as well as the network structure itself. Above the epidemic threshold, the pathogen
invades and infects a finite fraction of the population. Below the epidemic threshold,
the prevalence (total number of infected individuals) remains infinitesimally small in
the limit of large networks (Pastor-Satorras et al., 2015). There is growing evidence that
such thresholds exist in real-world host-pathogen systems, and intervention strategies
are formulated and executed based on estimates of the epidemic threshold. (Dallas et al.,
2018; Shulgin et al., 1998; Wallinga et al., 2005; Pourbohloul et al., 2005; Meyers et al.,
2005). Fittingly, the last two decades have seen a significant emphasis on studying epidemic thresholds of contact networks from several disciplines, such as computer science,
physics, and epidemiology (Newman, 2002; Wang et al., 2003; Colizza and Vespignani,
2007; Chakrabarti et al., 2008; Gómez et al., 2010; Wang et al., 2016, 2017). See Leitch
et al. (2019) for a complete survey on the topic of epidemic thresholds.
Concurrently but separately, network data has rapidly emerged as a significant area in
statistics. Over the last two decades, a substantial amount of methodological advancement has been accomplished in several topics in this area, such as community detection
(Bickel and Chen, 2009; Zhao et al., 2012; Rohe et al., 2011; Sengupta and Chen, 2015),
model fitting and model selection (Hoff et al., 2002; Handcock et al., 2007; Krivitsky
et al., 2009; Wang and Bickel, 2017; Yan et al., 2014; Bickel and Sarkar, 2016; Sengupta
and Chen, 2018), hypothesis testing (Ghoshdastidar and von Luxburg, 2018; Tang et al.,
2017a,b; Bhadra et al., 2019), and anomaly detection (Zhao et al., 2018; Sengupta, 2018;
Komolafe et al., 2019), to name a few. The state-of-the-art toolbox of statistical network
inference includes a range of random graph models and a suite of estimation and inference techniques.
However, there has not been any work at the intersection of these two areas, in the sense
that the problem of estimating epidemic thresholds has not been investigated from the
perspective of statistical network inference. Furthermore, the task of computing the epidemic threshold based on existing results can be computationally infeasible for massive
networks. In this paper, we address these gaps by developing a novel sampling-based
method to estimate the epidemic threshold under the widely used Chung-Lu model
(Aiello et al., 2000), also known as the configuration model. We prove that our proposed
method has theoretical guarantees for both statistical accuracy and computational efficiency. We also provide empirical results demonstrating our method on both synthetic
and real-world networks.
The rest of the paper is organized as follows. In Section 2, we formally set up the prob3

lem statement and formulate our proposed methods for approximating the epidemic
threshold. In Section 3, we desribe the theoretical properties of our estimators. In Section 4, we report numerical results from synthetic as well as real-world networks. We
conclude the paper with discussion and next steps in Section 5.
Table 1: Common Symbols
Symbol
λ(A)
di
δi
S(t), I(t), R(t)
β

µ

2

Definition and Description
spectral radius of the matrix A
degree of the node i of the network
expected degree of the node i of the network
number of susceptible (S), infected (I), and recovered/removed
(R) individuals in the population at time t
infection rate: probability of transmission of a pathogen from an
infected individual to a susceptible individual per effective contact (e.g. contact per unit time in continuous-time models, or per
time step in discrete-time models)
recovery rate: probability that an infected individual will recover
per unit time (in continuous-time models) or per time step (in
discrete-time models)

Epidemic thresholds

Consider a set of n individuals labelled as 1, . . . , n, and an undirected network (with
no self-loops) representing interactions between them. This can represented by an nby-n symmetric adjacency matrix A, where A(i, j) = 1 if individuals i and j interact
and A(i, j) = 0 otherwise. Consider a pathogen spreading through this contact network
according to an SIR model. From existing work (Chakrabarti et al., 2008; Gómez et al.,
2010; Prakash et al., 2010; Wang et al., 2016, 2017), we know that the boundary condition
for the pathogen to become an epidemic is given by
β
1
=
,
µ
λ(A)

(1)

where λ(A) is the spectral radius of the adjacency matrix A.
The left hand side of Equation (1) is the ratio of the infection rate to the recovery rate,
which is purely a function of the pathogen and independent of the network. As this ratio
grows larger, an epidemic becomes more likely, as new infections outpace recoveries.
The right hand side of Equation (1) is the spectral radius of the adjacency matrix, which
is purely a function of the network and independent of the pathogen. Larger the spectral
radius, the more connected the network, and therefore an epidemic becomes more likely.
Thus, the boundary condition in Equation (1) connects the two aspects of the contagion
process, the pathogen transmissibility which is quantified by β/µ, and the social contact
4

network which is quantified by the spectral radius. If
and if

β
µ

>

1
λ(A) ,

β
µ

<

1
λ(A) ,

the pathogen dies out,

the pathogen becomes an epidemic.

Given a social contact network, the inverse of the spectral radius of its adjacency matrix
represents the epidemic threshold for the network. Any pathogen whose transmissiblity
ratio is greater than this threshold is going to cause an epidemic, whereas any pathogen
whose transmissiblity ratio is less than this threshold is going to die out. Therefore, a
key problem in network epidemiology is to compute the spectral radius of the social
contact network.

2.1

Problem statement and heuristics

Realistic urban social networks that are used in modeling contagion processes have millions of nodes (Eubank et al., 2004; Barrett et al., 2008). To compute the epidemic threshold of such networks, we need to find the largest (in absolute value) eigenvalue of the
adjacency matrix A. This is challenging because of two reasons.
1. First, from a computational perspective, eigenvalue algorithms have computational complexity of Ω(n2 ) or higher. For massive social contact networks with
millions of nodes, this can become too burdensome.
2. Second, from a statistical perspective, eigenvalue algorithms require the entire adjacency matrix for the full network of n individuals. It can be challenging or expensive to collect interaction data of n individuals of a massive population (e.g.,
an urban metropolis). Furthermore, eigenvalue algorithms typically require the
full matrix to be stored in the random-access memory of the computer, which can
be infeasible for massive social contact networks which are too large to be stored.
The first issue could be resolved if we could compute the epidemic threshold in a computationally efficient manner. The second issue could be resolved if we could compute
the epidemic threshold only using data on a small subset of the population. In this paper,
we aim to resolve both issues by developing two approximation methods for computing
the spectral radius.
To address these problems, let us look at the spectral radius, λ(A), from the perspective
of random graph models. The statistical model is given by A ∼ P , which is short-hand
for A(i, j) ∼ Bernoulli(P (i, j)) for 1 ≤ i < j ≤ n. Then λ(A) converges to λ(P ) in probability under some mild conditions (Chung and Radcliffe, 2011; Benaych-Georges et al.,
2019; Bordenave et al., 2020). To make a formal statement regarding this convergence,
we reproduce below a slightly paraphrased version (for notational consistency) of an
existing result in this context.
Lemma 1 (Theorem 1 of Chung and Radcliffe (2011)). Let
∆ = max

n
X

1≤i≤n

j=1

5

P (i, j)

be the maximum expected degree, and suppose that for some  > 0,
∆>

4
log(2n/)
9

for sufficiently large n. Then with probability at least 1 − , for sufficiently large n,
p
|λ(A) − λ(P )| ≤ 2 ∆ log(2n/).
To make note of a somewhat subtle point: from an inferential perspective it is tempting
to view the above result as a consistency result, where λ(P ) is the population quantity
or parameter of interest and λ(A) is its estimator. However, in the context of epidemic
thresholds, we are interested in the random variable λ(A) itself, as we want to study
the contagion spread conditional on a given social contact network. Therefore, in the
present context, the above result should not be interpreted as a consistency result.
Rather, we can use the convergence result in a different way. For massive networks,
the random variable λ(A), which we wish to compute but find it infeasible to do so,
is close to the parameter λ(P ). Suppose we can find a random variable T (A) which
also converges in probability to λ(P ), and is computationally efficient. Since T (A) and
λ(A) both converge in probability to λ(P ), we can use T (A) as an accurate proxy for
λ(A). This would address the first of the two issues described at the beginning of this
subsection. Furthermore, if T (A) can be computed from a small subset of the data, that
would also solve the second issue. This is our central heuristic, which we are going to
formalize next.

2.2

The Chung-Lu model

So far, we have not made any structural assumptions on P , we have simply considered
the generic inhomogeneous random graph model. Under such a general model, it is
very difficult to formulate a statistic T (A) which is cheap to compute and converges
to λ(P ). Therefore, we now introduce a structural assumption on P , in the form of
the well-known Chung-Lu model that was introduced by Aiello et al. (2000) and subsequently studied in many papers (Chung and Lu, 2002; Chung et al., 2003; Decreusefond et al., 2012; Pinar et al., 2012; Zhang et al., 2017). For a network with n nodes, let
δ = (δ1 , . . . , δn )0 be the vector of expected degrees. Then under the Chung-Lu model,
δi δj
P (i, j) = Pn

k=1 δk

.

(2)

This formulation preserves E[di ] = δi , where di is the degree of the ith node, and is very
flexible with respect to degree heterogeneity.

6

Under model (2), note that rank(P ) = 1, and we have
1
P = Pn

i=1 δi

δδ 0

Pn 2
δi
δδ δ = Pi=1
δ
⇒ P δ = Pn
n
i=1 δi
i=1 δi
Pn 2
δi
⇒ λ(P ) = Pi=1
.
n
i=1 δi
1

0

Recall that we are looking for some computationally efficient T (A) which converges in
probability to λ(P ). We now know that under the Chung-Lu model, λ(P ) is equal to the
ratio of the second moment to the first moment of the degree distribution. Therefore, a
simple estimator of λ(P ) is given by the sample analogue of this ratio, i.e.,
Pn
d2i
T1 (A) = Pi=1
.
(3)
n
i=1 di
We now want to demonstrate that approximating λ(A) by T1 (A) provides us with very
substantial computational savings with little loss of accuracy. The approximation error
can be quantified as
T1 (A)
e1 (A) =
−1 ,
(4)
λ(A)
and our goal is to show that e1 (A) → 0 in probability, while the computational cost
of T1 (A) is much smaller than that of λ(A). We will show this both from a theoretical
perspective and an empirical perspective. We next describe the empirical results from a
simulation study, and we postpone the theoretical discussion to Section 3 for organizational clarity.
We used n = 5000, 10000, and constructed a Chung-Lu random graph model where
P (i, j) = θi θj . The model parameters θ1 , . . . , θn were uniformly sampled from (0, 0.25).
Then, we randomly generated 100 networks from the model, and computed λ(A) and
T1 (A). The results are reported in Table 2. Average runtime for the moment based
estimator, T1 (A), is only 0.07 seconds for n = 5000 and 0.35 seconds for n = 10000,
whereas for the spectral radius, λ(A), it is 78.2 seconds and 606.44 seconds respectively,
which makes the latter 1100-1700 times more computationally burdensome. The average
error for T1 (A) is very small, and so is the SD of errors. Thus, even for moderately sized
networks where n = 5000 or n = 10000, using T1 (A) as a proxy for λ(A) can reduce
the computational cost to a great extent, and the corresponding loss in accuracy is very
small. For massive networks where n is in millions, this advantage of T1 (A) over λ(A)
is even greater; however, the computational burden for λ(A) becomes so large that this
case is difficult to illustrate using standard computing equipment.
Thus, T1 (A) provides us with a computationally efficient and statistically accurate method
for finding the epidemic threshold.
7

Table 2: Computational efficiency and statistical accuracy of T1 (A)
n
5000
10000

2.3

Mean Time for λ(A)
78.20 seconds
606.44 seconds

Mean Time for T1 (A)
0.07 seconds
0.35 seconds

Mean Error
0.0012
0.0005

SD of Error
0.0003
0.0002

Sampling based approximation

The first approximation, T1 (A), provides us with a computationally efficient method
for finding the epidemic threshold. This addresses the first issue pointed out at the
beginning of Section 2.1. However, computing T1 (A) requires data on the degree of all n
nodes of the network. Therefore, this does not solve the second issue pointed out at the
beginning of Section 2.1. We now propose a second alternative, T2 , to address the second
issue. The idea behind this approximation is based on the same heuristic that was laid
out in Section 2.2. Since λ(P ) is a function of degree moments, we can estimate these
moments using observed node degrees. In defining T1 (A), we used observed degrees
of all n nodes in the network. However, we can also estimate the degree moments by
considering a small sample of nodes, based on random walk sampling. The algorithm
for computing T2 is given in Algorithm 1.
Algorithm 1 RandomWalkEstimate
procedure E STIMATE(G, r, t∗ )
2:
x ← 1.
3:
while t ≤ t∗ do
4:
x ← random neighbor of x, chosen uniformly.
1:

8:

v ← 0.
while i ≤ r do
v = v + dx
x ← random neighbor of x, chosen uniformly.

9:

return T2 = v/r.

5:
6:
7:

Note that we only use (t∗ + r) randomly sampled nodes for computing T2 , which implies that we do not need to collect or store data on the n individuals. Therefore this
method overcomes the second issue pointed out at the beginning of Section 2.1. The
approximation error arising from this method can be defined as
e2 (A) =

T2 (A)
−1 ,
λ(A)

(5)

and we want to show that e2 (A) → 0 in probability, while the data-collection cost of
T2 (A) is much less than that of T1 (A). In the next section, we are going to formalize this.

8

3

Theoretical results on approximation errors

In this section, we are going to establish that the approximation errors e1 (A) and e2 (A),
defined in Equations (4) and (5), converge to zero in probability. From Theorem 2.1 of
Chung et al. (2003), we know that when
P 2
q
δ
Pi i > log(n) max δi
(6)
1≤i≤n
i δi
holds, then for any  > 0,

P


λ(A)
− 1 >  → 0.
λ(P )

Therefore, under (6), it suffices to show that, for any  > 0,




T1 (A)
T2 (A)
P
− 1 >  → 0, and P
− 1 >  → 0.
λ(P )
λ(P )

3.1

Convergence of T1 (A)
Pn

Pn

d2

δ2

i
i
, and recall that λ(P ) = Pi=1
. For notational conveFirst, consider T1 (A) = Pi=1
n
n
i=1 δiP
P
Pn
Pn i=1 di
n
nience, define m1 = i=1 di , m2 = i=1 d2i , µ1 = i=1 δi , µ2 = ni=1 δi2 . We would like
to show that, under reasonable conditions, for any  > 0,


m2 µ1
P
− 1 >  → 0.
(7)
m1 µ2

We will show that for any 0 > 0,




m1
m2
P
− 1 > 0 → 0, P
− 1 > 0 → 0.
µ1
µ2

(8)

We first prove that (8) implies (7). Equation (8) implies that
 


m2
m1
0
0
−1 > ∪
−1 >
→ 0.
P
µ1
µ2
n
o n
o
m2
0 ∩
0 . Note that m /m is a strictly
1
Now, consider the event m
−
1
≤

−
1
≤

2
1
µ1
µ2
increasing function of m2 and a strictly decreasing function of m1 . Therefore, for outcomes belonging to the above event,
µ2 1 − 0
m2
µ2 1 + 0
×
≤
≤
×
.
µ1 1 + 0
m1
µ1 1 − 0
Note that
1−

1 − 0
20
1 + 0
20
0
=
<
2
,
and
−
1
=
< 40 ,
1 + 0
1 + 0
1 − 0
1 − 0
9

given that 0 < 1/2. Now, fix  > 0 and let 0 = /4. Then,


m2 µ1
0
− 1 > 4 → 0 ⇒ (7).
(8) ⇒ P
m1 µ2
Thus, proving (8) is sufficient for proving (7).
Next, we state and prove the theorem which will establish (8).
Theorem 2. If the average of the expected
degrees goes to infinity, i.e.,
P
2

spectral radius dominates log (n), i.e.,

P

2

Pi δi
i δi

1P
i δi
n

→ ∞, and the

2

= ω(log n), then for any  > 0,




m2
m1
− 1 >  → 0, and P
− 1 >  → 0.
µ1
µ2

Proof. We will use Hoeffding’s inequality (Hoeffding, 1994) for the first part, and we begin by stating the inequality for the sum of Bernoulli random variables. Let B1 , . . . , Bm
be m independent
(but not necessarily identically distributed) Bernoulli random variPm
ables, and Sm = i=1 Bi . Then for any t > 0,


−2t2
P [|Sm − E[Sm ]| ≥ t] ≤ 2 exp
.
m
In our case,
m1 =

n
X
i=1

di =

n X
n
X

A(i, j) = 2

i=1 j=1

X

A(i, j),

i<j

and we know that {A(i, j) P
: 1 ≤ i < j ≤ n} are independent Bernoulli random variables.
Fix  > 0 and note that E[ i<j A(i, j)] = 12 µ1 . Using Hoeffding’s inequality with Sm =

m1 /2, m = n2 , and t = 2 µ1 , we get


h m
µ1
 i
µ21
1
2
P
−
> µ1 ≤ 2 exp −
.
2
2
2
n(n − 1)
Since

1P
i δi
n

→ ∞, the right hand side goes to zero. Therefore,


m1
P
− 1 >  → 0.
µ1

For the second part, we can characterize m2 as following.
X
X
E[m2 ] = E[
d2i ] =
(E[di ])2 + var(di ) = µ2 + var(di ),
i

i

and hence,
|m2 − µ2 | ≤ |m2 − E[m2 ]| + |E[m2 ] − µ2 |.
We show that, under the given assumptions, with probability 1 − o(1), |m2 − E[m2 ]| =
o(µ2 ). Furthermore, |E[m2 ] − µ2 | = o(µ2 ).
10

As noted before, each di is a sum of binomial random variables. By applying ChernoffHoeffding bound, and union bounding over all i ∈ {1, . . . , n}, we can get, with probability 1 − o(1), and for any fixed  ∈ (0, 1),
∀i ∈ {1, . . . , n}, di ≤ δi + max{δi , O(log(n))}.
Let the above event be called the event A. If the event A happens, then,
X
X
m2 =
d2i ≤
δi2 + 2δi max(δi , log n) + max(2 δi2 , log2 n)
i

i

≤ µ2 + 2

X

δi (δi + log n) + (2 δi2 + log2 n)

i

≤ µ2 + 3µ2 + (n +

X

δi ) log2 n

i

X
m2
− 1 ≤ 3 + (n +
δi ) log2 n/µ2
µ2
i

Note that

n
µ2

=

P 12
i δi /n

→ 0 under the given assumption. Furthermore,
P
( i δi ) log2 n
P 2
= o(1) → 0.
i δi

Putting these together, and using 0 = 3 we have the given claim.

Thus, we have proved that the approximation error for T1 (A) goes to zero in probability.
we have already observed in Section 2.2 that the runtime for T1 (A) is orders of magnitude faster that the runtime for λ(A). Therefore, T1 (A) is both computationally efficient
and statistically accurate as an approximation of the epidemic threshold.

3.2

Convergence of T2 (A)

Next, consider Algorithm 1. Let π denote the stationary distribution of the simple random walk on the given graph. Suppose the number of edges in the given graph is m.
Recall that, π is given by πv = Pdvdv for all v. For brevity, we define the mixing time
v
of the graph A, denoted as tmix (A), to mean the number of steps required by the simple
random walk to reach a distribution π̂ such that kπ̂ − πk1 = o( n12 ). Let T2 (A) be the
estimate returned by the Algorithm 1. We first show an easy lemma that characterizes
the bias of the estimator T2 (A).
Lemma
3. If x is a node that is randomly sampled from π, and dx is its degree, then E[dx ] =
P
2

Pi di .
i di

Consequently if π̂ is such that kπ − π̂k1 = o(n−2 ) and x is sampled from π̂, then E[dx ] =
d2

P

(1 ± o(1)) Pi dii .
i

11

Proof. It is easy to see that
Ex∼π [dx ] =

n
X
v=1

P 2
d
dv × πv = Pv v .
d
v v

We show the second claim as follows:
|Ex∼π [dx ] − Ex∼π̂ [dx ]| ≤

n
X

dv |πv − πˆv | ≤ nkπ − π̂k1 = o(1).

v=1

Next, we show that the estimator vRW is actually concentrated around its expectation.
Theorem 4 (Lezaud (1998)). Let (Xn ) be a irreducible and reversible Markov Chain on a finite
set V with Q being the transition matrix. Let π be the stationary distribution. Let f : V → <
be such that Eπ [f ] = 0, kf k∞ ≤ 1 and 0 < Eπ [f 2 ] ≤ b2 . Then, for any initial distribution q,
any positive integer r and all 0 < γ ≤ 1,

"
Pr r
q

−1

r
X

#
f (Xi ) ≥ γ ≤ e

−ε(P )/5


Sq exp −

i=1

rγ 2 ε(P )
4b2 (1 + h(5γ/b2 ))


,

where ε(Q) = 1 − λ2 (Q), λ2 (Q) being the second largest eigenvalue of P , Sq = kq/πk2 (in the
`2 (π) norm).
1 √
h(x) = ( 1 + x − (1 − x/2)).
2
If γ  b2 and ε(P )  1, the bound is

(1 + o(1))Sq exp −

rγ 2 ε(p)
4b2 (1 + o(1))


.

Using the above result, we bound the sample complexity of our estimator. We first quote
the following result that we use to bound λ1 of the transition matrix.
12md
1
P max
log(1/δ) and t∗ ≥
Theorem 5. Let , δ ∈ (0, 1). Algorithm 1, using r = ε(Q)
2
3/2 × (
v dv )
tmix (G) returns an estimate vRW that satisfies, with probability 1 − δ,
P 2
P 2
dv
d
v
(1 − ) P
≤ T2 (A) ≤ (1 + ) Pv v .
v dv
v dv
The number of nodes that are touched by algorithm is O(t∗ + r).

12

Proof. In our setting the set V is the set of vertices. Define the function f (Xi ) as :
dmax × f (Xi ) = dXi − Eπ [dXi ].
f (·) clearly satisfies Eπ [f ] = 0 and that kf k∞ ≤ 1. We can bound Eπ [f 2 ] as
2
−2
Eπ [f 2 ] ≤ d−2
max Eπ [dv ] = dmax

X d3
X d2 × dv
v
P
Pv
= d−2
max
d
v
v
v dv
v
v

Using the first t∗ steps, we reach the distribution π̂ that satisfies kπ − π̂k1 = o(n−2 ).
Hence,
X
X
X
(πv + (π̂v − πv ))2 /πv
π̂v2 /πv =
πv (π̂v /πv )2 =
kπ̂/πk22 =
v

v

v

X
=
(πv + 2(π̂v − πv ) + (π̂v − πv )2 /πv )
v

= 1 + 2 × (1 − 1) +

X
(π̂v − πv )2 /πv ≤ 1 + kπ − π̂k22 / min(πv )
v

≤ 1 + kπ −

X

π̂k21 (

dv )/dmin = 1 + o(1).

v

where the last step follows as kπ − π̂k1 = o(n−2 ).
P 2
P d3v
−1 × Pv dv . Hence
P
We use b2 = d−2
and
γ
=
d
max
max
v
dv
dv
v

v

P 2
P 2 2
v)
2
2 2
2 P ( v dP
v dv
P
γ/b = dmax
and γ /b = 
3
( v dv )( v d3v )
v dv
Hence,
P 2 1/2
P 2
P 2
P 2 1/2


d
d
d
d
− 1 + 5dmax Pv v3 ≤ 5dmax Pv v3
+ 2.5dmax Pv v3
1 + 5dmax Pv v3
d
d
2
d
v v
v v
v dv
P 2v v
d
≤ 61/2 dmax Pv v3
v dv

h(5γ/b2 ) =

Plugging this, we get that
P 2 2
P 2
P
dv −1 rε(Q)3/2 ( v d2v )
rγ 2 ε(Q)
v)
2 P ( v dP
1/2
v
P
≥ rε(Q) × 
× (1 + 6 dmax P 3 ) ≥
4b2 (1 + h(5γ/b2 ))
( v dv )( v d3v )
6( v dv )dmax
v dv
1
Setting r = ε(Q)
3/2 ×
probability 1 − δ,

P
6( P
v dv )dmax
( v d2v )

log(1/δ), and using Theorem 4, we can claim that, with
P 2
d
T2 (A) ∈ (1 ± ) Pv v .
v dv

The bound on the number of nodes touched/queried by the algorithm follows naturally.

13

Note that Q = D−1 A has the same set of eigenvalues as the matrix D−1/2 AD−1/2 . For the
Chung-Lu model, the eigenvalues of the matrix L = I − D−1/2 AD−1/2 can be bounded
by the following result from Chung et al. (2003).
Theorem 6. Let L = I − D−1/2 AD−1/2 denote the normalized Laplacian. Let A be a random
graph generated from the given expected degrees model, with expected degrees {δi }, if the minimum expected degree δmin satisfies δmin  ln(n), then with probability at least 1 − 1/n =
1 − o(1), we have that for all eigenvalues λk (L) > λmin (L) of the Laplacian of G,
s
6 ln(2n)
|1 − λk (L)| < 2
= o(1).
δmin
It follows above that ε(Q) = 1−λ2 (Q) = 1−λ2 (D−1/2 AD−1/2 ) = λn−1 (I−D−1/2 AD−1/2 ) =
1 − o(1). Putting these together, we get the following corollary on the total number of
node queries.
Corollary 6.1. For a graph generated from the expected degrees model, with probability 1 − 1/n,
Algorithm 1, needs to query
P
6( v dv )dmax
1
P
ln(n) + 3/2 ×
log(1/δ)
( v d2v )

P
nodes in order to get a (1 ± ) estimate of v d2v /2m.
6(

P

d )d

v v max
max
Note (P
≤ 6d
2
dmin , but this is a loose bound, better bounds can be derived for
v dv )
power law degree distributions, for instance.

Thus, we have proved that the approximation error for T2 (A) goes to zero in probability.
In addition, Corollary 6.1 shows that the number of nodes that we need to query in order
to have an accurate approximation is much smaller than n. Furthermore, computing T2
only requires node sampling and counting degrees, and therefore the runtime is much
smaller than eigenvalue algorithms. Therefore, T2 (A) is a computationally efficient and
statistically accurate approximation of the epidemic threshold, while also requiring a
much smaller data budget compared to T1 (A).

4

Numerical results

In this section, we characterize the empirical performance of our sampling algorithm
on two synthetic networks, one generated from the Chung-Lu model and the second
generated from the preferential attachment model of Barabási and Albert (1999).

4.1

Data

Our first dataset is a graph generated from the Chung-Lu model of expected degrees.
We generated a powerlaw sequence (i.e. fraction of nodes with degree d is proportion
14

Data
Chung-Lu
Pref-Attach

Nodes
50k
50k

Edges
72k
250k

λ(A)
43.83
37

T1 (A)
48.33
32.8

Table 3: Statistics of the two synthetic datasets used.
to d−β ) with exponent β = 2.5 and then generated a graph with this sequence as the
expected
degrees. Table 3 notes that, as expected, the first eigenvalue λ1 (A) is close to
P
2

Pv dv .
v dv

The second dataset is generated from the preferential attachment model (Barabási and
Albert, 1999), where each incoming node adds 5 edges to the existing nodes, the probability of choosing a specific node as neighbor being proportional to the current degree
of that node. While the preferential attachment model naturally gives rise to a directed
graph, we convert the graph to an undirected one before running our algorithm. It is
interesting to note that even in this case the Chung-Lu model does not hold, our first
approximation, T1 (A), is close to λ(A).

4.2

Implementation Details

In each of the networks, the random walk algorithm presented in Algorithm 1 was used
for sampling. The random walk was started from an arbitrary node and every 10th node
was sampled (to account for the mixing time) from the walk. These samples were then
used to calculate T2 (A). This experiment was repeated 10 times. These gave estimates
T21 , . . . , T210 . We then calculate two relative errors ∀i ∈ {1, 2, . . . , 10},
Ti 1−T 2 =

T2i − T1 (A)
T2i − λ(A)
2
, λ−T
=
.
i
T1 (A)
λ(A)

2
We plot the averages of {Ti 1−T 2 } and {λ−T
} against the actual number of nodes seen by
i
the random walk. Note that the x-axis accurately reflect how many times the algorithm
actually queried the network, not just the number of samples used. Measuring the cost
of uniform node sampling in this setting, for instance, would need to keep track of how
many nodes are touched by a Metropolis-Hastings walk that implements the uniform
distribution.

4.3

Results

Figure 1 demonstrates the results. For the two synthetic networks, the algorithm is able
to get a 10% approximation to the statistic T1 (A) by exploring at most 10% of the network. With more samples from the random walk, the mean relative errors settle to
around 4-5%. However, once we measure the mean relative errors with respect to λ(A),
it becomes clearer that the estimator T2 (A) does better when the graph is closer to the
15

assumed (i.e. Chung-Lu) model. For the Chung-Lu graph, the mean error λ−T 2 essentially is very similar to T 1−T 2 , which is to be expected. For the preferential attachment
graph too, it is clear that the estimate T2 is able to achieve a better than 10% relative error
approximation of λ(A).
Note that, if we were instead counting only the nodes whose degrees were actually used
for estimation, the fraction of network used would be roughly 1 − 2% in all the cases,
the majority of the node cost actually goes in making the random walk mix.
chung-lu

T2-rel.error
Lambda-rel.error

0.20
Mean Relative Error

Mean Relative Error

0.25

prefattachment

0.25

T1-T2-error
Lambda-T2-error

0.20
0.15
0.10

0.15
0.10
0.05

0.05
0.0

0.1

0.2
0.3
Fraction of nodes queried

0.4

0.5

0.0

0.1

0.2
0.3
Fraction of nodes queried

0.4

0.5

Figure 1: Results on two synthetic networks

5

Discussion

In this work, we investigated the problem of computing SIR epidemic thresholds of social contact networks from the perspective of statistical inference. We considered the two
challenges that arise in this context, due to high computational and data-collection complexity of the spectral radius. For the Chung-Lu network generative model, the spectral
radius can be characterized in terms of the degree moments. We utilized this fact to
develop two approximations of the spectral radius. The first approximation is computationally efficient and statistically accurate, but requires data on observed degrees of
all nodes. The second approximation retains the computationally efficiency and statistically accuracy of the first approximation, while also reducing the number of queries
or the sample size quite substantially. The results seem very promising for networks
arising from the Chung-Lu and preferential attachment generative models.
There are several interesting and important future directions. The methods proposed
in this paper have provable guarantees only under the Chung-Lu model, although it
works very well under the preferential attachment model. This seems to indicate that
the degree based approximation might be applicable to a wider class of models. On the
other hand, this leaves open the question of developing a better “model-free” estimator,
as well as asking similar questions about other network features.
In this work we only considered the problem of accurate approximation of the epidemic
threshold. From a statistical as well as a real-world perspective, there are several related
16

inference questions. These include uncertainty quantification, confidence intervals, onesample and two-sample testing, etc.
Social interaction patterns vary dynamically over time, and such network dynamics can
have significant impacts on the contagion process Leitch et al. (2019). In this paper we
only considered static social contact networks, and in future we hope to study epidemic
thresholds for time-varying or dynamic networks.

5.1

Disclaimer With Respect to Current Pandemic

We do realize that in the face of the current pandemic, while it is important to pursue
research relevant to it, it is also important to be responsible in following the proper scientific process. We would like to state that in this work, the question of epidemic threshold
estimation has been formalized from a theoretical viewpoint in a much used, but simple, random graph model. We are not yet at a position to give any guarantees about the
performance of our estimator in real social networks. We do hope, however, that the
techniques developed here can be further refined to work to give reliable estimators in
practical settings.
Acknowledgements. Anirban acknowledges the kind support of the N. Rama Rao
Chair Professorship at IIT Gandhinagar, the Google India AI/ML award (2020), Google
Faculty Award (2015), and CISCO University Research Grant (2016).

References
Aiello, W., Chung, F., and Lu, L. (2000). A random graph model for massive graphs.
In Proceedings of the thirty-second annual ACM symposium on Theory of computing, pages
171–180. Acm.
Barabási, A.-L. and Albert, R. (1999). Emergence of Scaling in Random Networks. Science, 286(5439):509–512.
Barabási, A.-L. and Albert, R. (1999). Emergence of scaling in random networks. Science,
286(5439):509–512.
Barrett, C. L., Bisset, K. R., Eubank, S. G., Feng, X., and Marathe, M. V. (2008). Episimdemics: an efficient algorithm for simulating the spread of infectious disease over
large realistic social networks. In SC’08: Proceedings of the 2008 ACM/IEEE Conference
on Supercomputing, pages 1–12. IEEE.
Benaych-Georges, F., Bordenave, C., Knowles, A., et al. (2019). Largest eigenvalues of
sparse inhomogeneous erdős–rényi graphs. The Annals of Probability, 47(3):1653–1676.

17

Bengtsson, L., Gaudart, J., Lu, X., Moore, S., Wetter, E., Sallah, K., Rebaudet, S., and
Piarroux, R. (2015). Using mobile phone data to predict the spatial spread of cholera.
Scientific reports, 5:8923.
Bhadra, S., Chakraborty, K., Sengupta, S., and Lahiri, S. (2019). A bootstrap-based inference framework for testing similarity of paired networks.
Bickel, P. J. and Chen, A. (2009). A nonparametric view of network models and
Newman–Girvan and other modularities. Proceedings of the National Academy of Sciences, 106:21068–21073.
Bickel, P. J. and Sarkar, P. (2016). Hypothesis testing for automated community detection
in networks. Journal of the Royal Statistical Society: Series B (Statistical Methodology),
78(1):253–273.
Bordenave, C., Benaych-Georges, F., and Knowles, A. (2020). Spectral radii of sparse
random matrices. Annales de l’Institut Henri Poincare (B) Probability and Statistics.
Brauer, F., Castillo-Chavez, C., and Castillo-Chavez, C. (2012). Mathematical models in
population biology and epidemiology, volume 2. Springer.
Chakrabarti, D., Wang, Y., Wang, C., Leskovec, J., and Faloutsos, C. (2008). Epidemic
thresholds in real networks. ACM Transactions on Information and System Security,
10(4):1–26.
Chinazzi, M., Davis, J. T., Ajelli, M., Gioannini, C., Litvinova, M., Merler, S., y Piontti,
A. P., Mu, K., Rossi, L., Sun, K., et al. (2020). The effect of travel restrictions on the
spread of the 2019 novel coronavirus (covid-19) outbreak. Science.
Chung, F. and Lu, L. (2002). The average distances in random graphs with given expected degrees. Proceedings of the National Academy of Sciences, 99(25):15879–15882.
Chung, F., Lu, L., and Vu, V. (2003). Eigenvalues of random power law graphs. Annals
of Combinatorics, 7(1):21–33.
Chung, F. and Radcliffe, M. (2011). On the spectra of general random graphs. the electronic journal of combinatorics, pages P215–P215.
Colizza, V. and Vespignani, A. (2007). Invasion threshold in heterogeneous metapopulation networks. Phys. Rev. Lett., 99:148701.
Dallas, T. A., Krkošek, M., and Drake, J. M. (2018). Experimental evidence of a pathogen
invasion threshold. Royal Society Open Science, 5(1):171975.
Decreusefond, L., Dhersin, J.-S., Moyal, P., Tran, V. C., et al. (2012). Large graph limit
for an sir process in random network with heterogeneous connectivity. The Annals of
Applied Probability, 22(2):541–575.
Eubank, S., Guclu, H., Kumar, V. A., Marathe, M. V., Srinivasan, A., Toroczkai, Z., and
Wang, N. (2004). Modelling disease outbreaks in realistic urban social networks. Nature, 429(6988):180–184.
18

Galvani, A. P. and May, R. M. (2005).
438(7066):293–295.

Dimensions of superspreading.

Nature,

Ghoshdastidar, D. and von Luxburg, U. (2018). Practical methods for graph two-sample
testing. In Advances in Neural Information Processing Systems, pages 3019–3028.
Gómez, S., Arenas, A., Borge-Holthoefer, J., Meloni, S., and Moreno, Y. (2010). Discretetime markov chain approach to contact-based disease spreading in complex networks.
EPL (Europhysics Letters), 89(3):38009.
Handcock, M. S., Raftery, A. E., and Tantrum, J. M. (2007). Model-based clustering for
social networks. Journal of the Royal Statistical Society: Series A, 170:301–354.
Hethcote, H. W. (2000). The mathematics of infectious diseases. SIAM review, 42(4):599–
653.
Hoeffding, W. (1994). Probability inequalities for sums of bounded random variables.
In The Collected Works of Wassily Hoeffding, pages 409–426. Springer.
Hoff, P. D., Raftery, A. E., and Handcock, M. S. (2002). Latent space approaches to social
network analysis. Journal of the American Statistical Association, 97(460):1090–1098.
Huang, C., Wang, Y., Li, X., Ren, L., Zhao, J., Hu, Y., Zhang, L., Fan, G., Xu, J., Gu,
X., et al. (2020). Clinical features of patients infected with 2019 novel coronavirus in
wuhan, china. The Lancet, 395(10223):497–506.
Keeling, M. (2005). The implications of network structure for epidemic dynamics. Theoretical Population Biology, 67(1):1–8.
Kermack, W. O. and McKendrick, A. G. (1927). A contribution to the mathematical
theory of epidemics. Proceedings of the royal society of london. Series A, Containing papers
of a mathematical and physical character, 115(772):700–721.
Kermack, W. O. and McKendrick, A. G. (1932). Contributions to the mathematical theory
of epidemics. ii.the problem of endemicity. Proceedings of the Royal Society of London.
Series A, containing papers of a mathematical and physical character, 138(834):55–83.
Kermack, W. O. and McKendrick, A. G. (1933). Contributions to the mathematical theory
of epidemics. iii.further studies of the problem of endemicity. Proceedings of the Royal
Society of London. Series A, Containing Papers of a Mathematical and Physical Character,
141(843):94–122.
Komolafe, T., Quevedo, A. V., Sengupta, S., and Woodall, W. H. (2019). Statistical evaluation of spectral methods for anomaly detection in static networks. Network Science,
7(3):319–352.
Kramer, A. M., Pulliam, J. T., Alexander, L. W., Park, A. W., Rohani, P., and Drake, J. M.
(2016). Spatial spread of the west africa ebola epidemic. Royal Society Open Science,
3(8):160294.

19

Krivitsky, P. N., Handcock, M. S., Raftery, A. E., and Hoff, P. D. (2009). Representing
degree distributions, clustering, and homophily in social networks with latent cluster
random effects models. Social Networks, 31(3):204–213.
Leitch, J., Alexander, K. A., and Sengupta, S. (2019). Toward epidemic thresholds on
temporal networks: a review and open questions. Applied Network Science, 4(1):105.
Lezaud, P. (1998). Chernoff-type bound for finite markov chains. Annals of Applied Probability, pages 849–867.
Meyers, L. A., Pourbohloul, B., Newman, M., Skowronski, D. M., and Brunham, R. C.
(2005). Network theory and SARS: predicting outbreak diversity. Journal of Theoretical
Biology, 232(1):71–81.
Newman, M. E. J. (2002). Spread of epidemic disease on networks. Physical Review E,
66(1):016128.
Pastor-Satorras, R., Castellano, C., Van Mieghem, P., and Vespignani, A. (2015). Epidemic processes in complex networks. Reviews of Modern Physics, 87(3):925–979.
Pinar, A., Seshadhri, C., and Kolda, T. G. (2012). The similarity between stochastic kronecker and chung-lu graph models. In Proceedings of the 2012 SIAM International Conference on Data Mining, pages 1071–1082. SIAM.
Pourbohloul, B., Meyers, L., Skowronski, D., Krajden, M., Patrick, D., and Brunham,
R. (2005). Modeling control strategies of respiratory pathogens. Emerging Infectious
Diseases, 11:1249–56.
Prakash, B. A., Chakrabarti, D., Faloutsos, M., Valler, N., and Faloutsos, C. (2010). Got
the Flu (or Mumps)? Check the Eigenvalue!
Rocha, L. E. C., Liljeros, F., and Holme, P. (2011). Simulated Epidemics in an Empirical Spatiotemporal Network of 50,185 Sexual Contacts. PLoS Computational Biology,
7(3):e1001109.
Rohe, K., Chatterjee, S., and Yu, B. (2011). Spectral clustering and the high-dimensional
stochastic blockmodel. The Annals of Statistics, 39(4):1878–1915.
Sengupta, S. (2018). Anomaly detection in static networks using egonets. arXiv preprint
arXiv:1807.08925.
Sengupta, S. and Chen, Y. (2015). Spectral clustering in heterogeneous networks. Statistica Sinica, 25:1081–1106.
Sengupta, S. and Chen, Y. (2018). A block model for node popularity in networks with
community structure. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 80(2):365–386.
Shulgin, B., Stone, L., and Agur, Z. (1998). Pulse vaccination strategy in the sir epidemic
model. Bulletin of Mathematical Biology, 60(6):1123–1148.

20

Sun, K., Chen, J., and Viboud, C. (2020). Early epidemiological analysis of the coronavirus disease 2019 outbreak based on crowdsourced data: a population-level observational study. The Lancet Digital Health.
Tang, M., Athreya, A., Sussman, D. L., Lyzinski, V., Park, Y., and Priebe, C. E. (2017a). A
semiparametric two-sample hypothesis testing problem for random graphs. Journal of
Computational and Graphical Statistics, 26(2):344–354.
Tang, M., Athreya, A., Sussman, D. L., Lyzinski, V., and Priebe, C. E. (2017b). A nonparametric two-sample hypothesis testing problem for random graphs. Bernoulli,
23(3):1599–1630.
Van den Driessche, P. and Watmough, J. (2002). Reproduction numbers and subthreshold endemic equilibria for compartmental models of disease transmission.
Mathematical biosciences, 180(1-2):29–48.
Wallinga, J., Heijne, J. C., and Kretzschmar, M. (2005). A measles epidemic threshold in
a highly vaccinated population. PLoS Medicine, 2(11):e316.
Wang, C., Horby, P. W., Hayden, F. G., and Gao, G. F. (2020). A novel coronavirus outbreak of global health concern. The Lancet, 395(10223):470–473.
Wang, W., Liu, Q.-H., Zhong, L.-F., Tang, M., Gao, H., and Stanley, H. E. (2016). Predicting the epidemic threshold of the susceptible-infected-recovered model. Scientific
Reports, 6(1).
Wang, W., Tang, M., Stanley, H. E., and Braunstein, L. A. (2017). Unification of theoretical approaches for epidemic spreading on complex networks. Reports on Progress in
Physics, 80(3):036603.
Wang, Y., Chakrabarti, D., Wang, C., and Faloutsos, C. (2003). Epidemic spreading in
real networks: an eigenvalue viewpoint. In 22nd International Symposium on Reliable
Distributed Systems, 2003. Proceedings., pages 25–34, Florence. IEEE Comput. Soc.
Wang, Y. R. and Bickel, P. J. (2017). Likelihood-based model selection for stochastic block
models. The Annals of Statistics, 45(2):500–528.
Woolhouse, M. E. J., Dye, C., Etard, J. F., Smith, T., Charlwood, J. D., Garnett, G. P.,
Hagan, P., Hii, J. L. K., Ndhlovu, P. D., Quinnell, R. J., Watts, C. H., Chandiwana, S. K.,
and Anderson, R. M. (1997). Heterogeneities in the transmission of infectious agents:
Implications for the design of control programs. Proceedings of the National Academy of
Sciences, 94(1):338–342.
Yan, X., Shalizi, C., Jensen, J. E., Krzakala, F., Moore, C., Zdeborová, L., Zhang, P., and
Zhu, Y. (2014). Model selection for degree-corrected block models. Journal of Statistical
Mechanics: Theory and Experiment, 2014(5):P05007.
Zhang, X., Moore, C., and Newman, M. E. (2017). Random graph models for dynamic
networks. The European Physical Journal B, 90(10):200.

21

Zhao, M. J., Driscoll, A. R., Sengupta, S., Fricker Jr, R. D., Spitzner, D. J., and Woodall,
W. H. (2018). Performance evaluation of social network anomaly detection using a
moving windowbased scan method. Quality and Reliability Engineering International,
34(8):1699–1716.
Zhao, Y., Levina, E., and Zhu, J. (2012). Consistency of community detection in networks
under degree-corrected stochastic block models. The Annals of Statistics, 40:2266–2292.
Zhu, N., Zhang, D., Wang, W., Li, X., Yang, B., Song, J., Zhao, X., Huang, B., Shi, W., Lu,
R., et al. (2020). A novel coronavirus from patients with pneumonia in china, 2019.
New England Journal of Medicine.

22

