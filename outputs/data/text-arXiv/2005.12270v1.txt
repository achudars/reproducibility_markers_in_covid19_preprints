1

Forecasting the Spread of Covid-19 Under Control
Scenarios Using LSTM and Dynamic Behavioral
Models
arXiv:2005.12270v1 [physics.soc-ph] 24 May 2020

Seid Miad Zandavi, Taha Hossein Rashidi, Fatemeh Vafaee*
* Corresponding author

Abstract—To accurately predict the regional spread of Covid19 infection, this study proposes a novel hybrid model which
combines a Long short-term memory (LSTM) artificial recurrent
neural network with dynamic behavioral models. Several factors
and control strategies affect the virus spread, and the uncertainty
arisen from confounding variables underlying the spread of the
Covid-19 infection is substantial. The proposed model considers
the effect of multiple factors to enhance the accuracy in predicting
the number of cases and deaths across the top ten most-affected
countries and Australia. The results show that the proposed
model closely replicates test data. It not only provides accurate
predictions but also estimates the daily behavior of the system
under uncertainty. The hybrid model outperforms the LSTM
model accounting for limited available data. The parameters of
the hybrid models were optimized using a genetic algorithm for
each country to improve the prediction power while considering
regional properties. Since the proposed model can accurately
predict Covid-19 spread under consideration of containment
policies, is capable of being used for policy assessment, planning
and decision-making.
Index Terms—Covid-19, LSTM, Dynamic Behavioral Model,
Hybrid Model.

I. I NTRODUCTION

T

THE outbreak of coronavirus disease 2019 (Covid-19)
has exposed the world to great challenges and is a
serious concern for public health. The outbreak started in
Wuhan, China, in December 2019 [1], [2] and within a
few weeks it spread across the globe. This caused policy
changes regarding the control of the spread. There is a lack
of information and uncertainty about this outbreak, making
it important to understand its dynamic behavior. Forecasting
the outbreaks behavior over time can provide useful insights
into the epidemiological situation [3] and determine whether
the pandemic has been brought under control by mitigation
measures [4], [5]. Research is currently forecasting changes
in infectious diseases [6], predicting the international spread
of outbreaks [7], and assessing the impacts of alternative
interventions during pandemics [8].
However, research is faced with many challenges, particularly related to time. There may be delays in the presentation of
symptoms due to the incubation cycle and delays in verifying
Seid M. Zandavi and Fatemeh Vafaee are with the School of Biotechnology
and Biomolecular Sciences, The University of New South Wales, Sydney
NSW 2052 Australia e-mails: {s.zandavi, f.vafaee}@unsw.edu.au.
Taha Hossein Rashidi is with the Research Center for Integrated Transport
Innovation, School of Civil and Environmental Engineering, The University of
New South Wales, Sydney NSW 2052, Australia e-mail:rashidi@unsw.edu.au.

detection and testing events. Delays and uncertainties can be
taken into account by models, especially those stemming from
normal infection histories and reporting processes [9]. Besides,
some aspects of outbreak dynamics can be biased, incomplete,
or only reported by individual data sources. There is evidence
that synthesis approaches will permit a more robust estimate
of the dynamics underlying the transmission based on noisy
data [10], [11].
In order to determine the potential trajectory of the disease
in accordance with the evidence, a dynamic model can be
used. These predict issues such as how an infection progresses,
how the number of cases/deaths is affected, or how long an
outbreak lasts. In traditional approaches, SEIR models (representing the population groups susceptible, exposed, infectious
and recovered) have been used to analyze the spread of Covid19 [2], [12]. Such models include feedback that regulates
endogenous changes in contact rate, testing, diagnostics, and
reporting in response to risk perception and other relevant
factors. In these compartmental models [2], populations are
divided into compartments and people are modelled by (ordinary) differential equations within the four SEIR groups.
Generative models reflect another broad variety of models
with causal effects (using hidden states and parameters).
For example, a generative model simulates the dynamics of
effects in a group or population (i.e., new COVID-19 cases
over time) [13]. These methods can measure the impact of
policies (e.g. social distancing) and demographic variations
(e.g., public immunity) in order to anticipate what might
happen in a particular area under various conditions [14].
Accordingly, SEIR-like models have been used to imitate
disease outbreaks by, for example, estimating the parameters
of Bayesian Markov-Chain Monte Carlo (MCMC) models
[15], [16] or comprehensively discussing scenarios [17], [18].
This family of models also has recently played a dominant
role in studying the overall outbreak of the coronavirus, from
inference [2], [19] to scenario prediction [1] under control
strategies [20].
Here, we propose a model of time-dependent spreading
movement. The time-dependence is determined through potential changes representing human and system behaviors. Therefore, a hybrid dynamic model is proposed to acquire a robust
estimation of the exclusive use of region properties, which
includes three main sections: A task model, facility model,
and dynamic motion model. The models estimate the behavior
of the Covid-19 outbreak in a particular region. The first

2

model represents general behavior in public, such as public
knowledge and how to follow the rules and knowledge. The
facility model considers facilities such as hospitals, including
emergency and inpatient departments, and medical staff and
their knowledge, rules, and skills. The last model predicts
the dynamic behavior of time-varying cases and deaths in the
nominated country. The motion model uses an artificial neural
network using Long Short Term Memory (LSTM) to update
itself in line with stochastic behaviors and uncertainties in the
proposed framework. Our framework is structured to assess
past intervention efficacy and to analyze future possibilities
that spread uncertainty. This model can be easily adapted to
any country or region. The top-ten most-affected countries,
including Australia, are studied with data collected between 31
December19 April 2020 obtained from the European Centre
for Disease Prevention and Control (ECDC). Furthermore, 90
% of this data is used to train the hybrid dynamic model and
10 % is used to analyze the performance of the model in the
proposed framework.
This paper is organized as follows. Section II describes the
methods. The problem formulation is explained and introduced
in Section III. The results and discussion are presented in
Section IV. Finally, the paper ends with a conclusion.
II. M ETHOD
Recently, deep learning has garnered the attention of many
researchers in different areas. Deep learning usually defines
multiple layers considering its architecture and uses a stochastic optimization algorithm to calculate the weight and bias parameters for each layer. As designed its architecture to perform
the machine learning tasks, the number of depths (i.e., number
of hidden layers) is directly correlated with the learning ability
[21]. In particular, LSTM, a form of recurrent neural network
(RNN), is able to update during the sequence of learning
as it has feedback connections, unlike a feedforward neural
network. This is the key point in using LSTM to forecast
with time series data. For example, it has been applied to
many areas such as image captioning [22], [23], [24], natural
language translation [25], and speech recognition [26]. Many
of these active areas focus on classification and applications
to forecast/regression models are relatively limited.
This paper aims to make a hybrid model based on LSTM
and a dynamic behavioral model to forecast the spread of
Covid-19 across the world from a dynamic modelling perspective. The dynamic behavioral model is introduced to describe
and predict the interactions between multiple components of a
phenomenon that are viewed as a system, which includes many
inputs and outputs interacting over time. The dynamic model
focuses on the mechanism of how the components and system
evolve across time. Therefore, dynamic modeling allows us
to bridge the gap between conceptualizing the phenomena of
dynamic behavior and particular phenomena. Dynamic system
modeling is used in many academic fields, originating in
mathematics and physics before being adopted in the life,
social, and behavioral sciences. It is clear that dynamic system
models combined with machine learning techniques can play
an essential role in data analysis and the way theories are
conceived and developed.

In order to forecast Covid-19, the proposed hybrid model
consists of three main modules: 1) time series/sequencing
learning (i.e., LSTM) with time-variant dynamics, 2) public
behavior and 3) a behavioral model of the system. Figure.
1 shows that Covid-19 forecasting includes three main sections. First, the task model describes external conditions and
reference inputs during covid-19 epidemics. This module can
describe factors such as social distancing, social knowledge,
self-isolation, etc. People decide whether to conform to tasks
or not, observing both external conditions and the current
situation. Additionally, the reference inputs are the ideal states
of public behavior during the covid-19 epidemic, so the
people should control this epidemic. Second, the facility model
describes covid-19 control behavior during the outbreak. This
model focuses on technologies, supplies, professional personnel, etc. Such modelling can reduce the number of deaths and
increase the number of discharged patients. In this model,
personnel are modeled based on human features such as
workload, fatigue, and conditions that affect the performance
of medical staff. Lastly, dynamic motion is modelled using the
artificial neural network based on LSTM to predict numbers
of cases and deaths. The details of each model are introduced
in the following sections.
A. LSTM Model
LSTM is a particular form of RNN capable of learning
long-term dependency, and has fundamental differences to a
conventional feedforward neural network. They are sequencebased models that are able to establish the temporal correlations between previous information and current circumstances.
In times series problems, like forecasting the spread of Covid19, using a sequence-based model in an LSTM means that the
decision an LSTM made at time t − 1 affects the decision
it will make at the next time, t. The feature (i.e., feedback
connections) plays an important role in imitating the systems
dynamic motion, since it takes daily information into account
when the subsequent information is entered.
According to back-propagation through time, RNNs suffer
from long-range dependencies because of gradient vanishing
and exploding [27]. Gradient vanishing in RNN refers to
problems where the norm of the gradient for long-term components decreases exponentially fast to zero, limiting the models
ability to learn long-term temporal correlations, while gradient
exploding refers to the opposite event. Although LSTM has
been introduced to address the issue [28], the forget gate in
the LSTM architecture boosts the performance of the model
[29]. This feature opens a new avenue for many sequencelearning applications.
Here, the general structure of LSTM is described with
naming similar to that of Ref [30]. Let {x1 , x2 , ..., xT } present
a sequencing input for an LSTM model (i.e., the general
structure is illustrated in Fig. 2). In Fig. 2, xt is a kdimensional real vector at the t-th time step.
In order to establish temporal connections, the LSTM defines and maintains an internal memory cell state throughout
the whole life cycle, which is the most important element of
the LSTM structure. The memory cell state st−1 interacts with

3

Facility M odel

Dynam ic M otion

Task M odel
Technology

LSTM

Supply

Exter nal Condition
Covid-19
Contr ol
Refer ence Inputs

M edical Staff
- Fatigue
- Wor kload
- Unacceptable Condition

Fig. 1. Hybrid Model of Covid-19 forecast

the intermediate output ht−1 and the subsequent input xt to
determine which elements of the internal state vector should
be updated, maintained or erased based on the outputs of the
previous time step and the inputs of the present time step. In
addition to the internal state, the LSTM structure also defines
an input node gt , input gate it , forget gate ft , and output gate
ot . Equation 1 - Eq. 6 gives the formulations for all nodes in
an LSTM structure.
ft = σ(Wf x xt + Wf h ht−1 + bf )

(1)

it = σ(Wix xt + Wih ht−1 + bi )

(2)

pass as the LSTM output ht . This process then continues
to repeat for the next time step. All the weights and biases
are learned by minimizing the differences between the LSTM
outputs and actual training samples. Besides, information on
the current time step can be stored and maintained to affect the
LSTM output of future time steps. Here, LSTM is designed to
estimate the movement of Covid-19s spread with consideration
of uncertainties. The stochastic behavior of the system is
modeled as a dynamic behavioral model to update the LSTM
states over time.
ht

st-1

gt = φ(Wgx xt + Wgh ht−1 + bg )

´

(3)

𝜙
𝑖!

ot = σ(Wox xt + Woh ht−1 + bo )

(4)

st = gt · it + st−1 · ft

(5)

𝑜!

𝑔!

𝑓!

𝜎

´

𝜎

𝜙

´

𝜎
ht

ht-1

ht = φ(st ) · ot

st

+

(6)

where Wf x ,Wf h , Wix ,Wih , Wgx , Wgh , Wox and Woh are
weight parameters for the corresponding input of the network
activation function; σ and φ are a sigmoid function and
tanh(.), respectively. The sigmoid function with an output
range of [0, 1] works as a soft switch for the forget gate (ft ),
input gate (it ), input node (gt ), and output gate (ot ). This
means that it is a decision-making point determining whether
the signal/sequencing data should pass the gate or not. For
example, if the output of the sigmoid function is zero, there is
no signal for the prediction. Thus, all gates (forget gate, input
gates, input node and output gates), are directly depended on
the current xt and previous output Ht−1 .
The input gate decides what to maintain in the internal
state while the forget signal is carried out from the previous
state (st−1 ) by the forget gate. In order to update the internal
state, the output gate points out which internal state st should

xt

Fig. 2. General Structure of LSTM

B. Dynamic Behavioral Model
The dynamic behavioral model describes the behavior of
a system on how its elements interact with each other. The
system interactions provide the functionality of the system and
are used for systems and subsystems. A behavioral model represents the temporal behavior between different subsystems,
while an entity interacts over time. Thus, modeling of the
interactions among subsystems, the functionality of the entity
over time, and the setting of roles, etc. is introduced as dynamic behavior in the system because the system performance
is determined through the engagement of each module over
time.

4

Generally, systems and subsystems interact to accomplish
a purpose by exchanging information to submit roles with
expectations, from which functions are presented to ensure that
action is taken. Also, an interaction over time involves communication (i.e., signals in time-series interactions), transfer of
knowledge, receiving and collecting data. Thus, data manipulation/changing system behavior over time is introduced as
a dynamic role. A dynamic behavioral model is constructed
to demonstrate one or more interactions within the system
that are responsible for task accomplishment. Accordingly,
general public behavior, skilled medical staff, and high-quality
hospitals cooperate as a dynamic system to manage the spread
of Covid-19 in an area.
III. P ROBLEM F ORMULATION
The problem is to forecast the number of cases and deaths
during Covid-19 pandemics. The hybrid model using LSTM
and the dynamic behavioral model are introduced to achieve
good predictions. Covid-19 forecasts help to take more attention into account when the number of cases is increasing.
In this section, the structure of the proposed framework (see
Fig. 1) is introduced. Also, the formulation of the modules
involved, such as the task model, medical staff model, hospital
as facility model, and dynamic motion model, are presented
in detail.

1
where A = D
τ and B = τ . The transfer function used to
model the task model is GColoredN oise . It is obvious that the
colored noise determines the uncertain behavior in terms of
the physical phenomena of the motional system.

B. Medical Staff Model
According to McRuer’s crossover model [31], humans in a
dynamic system behave in a way that results in an open-loop
transfer function, which is formulated as a Laplace form in
Eq.10.
ωc e−τ s
(10)
s
where Yh and Yp represent human and plant transfer functions,
respectively. ωc is the crossover frequency that describes
human operations and adaptation during a compensatory situation.
Figure 3 shows that the human behavior model is formulated
with three elements: delay in performance, equalization form,
and medical staff (according to their knowledge, rules, and
skills). Thus, the model is generalized and adjusted by using
a describing function form and a mitigating set of rules of
human characteristics, such as knowledge, rules, and skills.
Top = Yh Yp =

Input

Delay in
Per for m ance

Equalization
For m

M edical Satff

Output

Refer ences

A. Task Model
In the proposed framework, the task model describes the
behavior of the public in the Covid-19 time. It is categorized
into two groups: an external condition and reference input.
The external condition provides all the environmental factors
related to people deciding whether to maintain social distancing or not. The reference input describes the ideal state in
the country, such as public knowledge, keeping updated with
the latest news, and government rules. It is obvious that the
task model is very uncertain due to its dependency on public
behavior. Thus, the uncertainties are modeled by stochastic
colored noise.
The colored noise was generated by white noise that was
Gaussian-distributed with a zero mean. Therefore, the dynamic
is presented in Eq. 7.
dx
= f (x) + (t)
(7)
dt
where x is the task model and  is the white noise. Colored noise is the spectral density calculated by the Fouriertransform of the auto-correlation of white-noise ((t)). The
auto-correlation is formulated in Eq. 8
D − |t−k|
e τ
(8)
τ
where D and τ are the noise intensity and correlation time,
respectively. The Laplace transform of the auto-correlation of
introduced colored noise is expressed as Eq. 9.
(t)(k) =

GColoredN oise =

A
s+B

(9)

Fig. 3. Human Behavior Block Diagram

The generalized/adjusted human function, according to
McRuer’s crossover model, is formulated in Eq. 11.
TL s + 1 −T s
]e
HKRS (s)
(11)
TI s + 1
where kp , TL and TI are the gain, time-lead and time-lag
constant in the equalization from of the model shown in Fig.
3. Here, e−T s represents the delay in staff response, which
is described by the time-constant (T ). HKRS is the transfer
function of medical staff according to their knowledge, rules,
and skills.
Having generalized and adjusted the human model, knowledge, rules, and skill play important roles in staff performance.
In this regard, the model consists of four modules: human
senses such as visual and audio recognition, a cognitive model,
plans and rules for different forms of tasks, and medical
staffs physical actions and performance efficiency. Figure 4
illustrates the general model of medical staff.
Human behavior and performance are highly correlated
with visual and auditory recognition. These human senses are
heavily dependent on workload, fatigue, and working hours. In
the time-domain, the function of the human senses is modeled
as an exponential function (see Eq. 12).
Hstaf f (s) = kp [

fhs (t) = a + be−ct

(12)

where a, b and c are constant parameters in the proposed
model. Laplace transform is applied to fully describe the

5

The Laplace transform is as below.

Hum an Senses

e−Tcog s
)Ucog (s)
s
The transfer function is simplified in Eq. 21.
Fcog (s) = Pcog (1 −

Visual
Recognition
Cognitive M odel

Plans and Rules
for Task

Per for m ance and
Physical Action

Audio
Recognition

Gcog =
Fig. 4. General Model for Knowledge, Rules and Skills

behavior of the system. Thus, the Laplace transform of the
human sense model (i.e., transfer function of human senses)
is calculated as Eq. 13.
Fhs (s)

=
=
=

b
a
s + s+c
(a+b)s+ac
s(s+c)
a[( a+b
ac )s+1]
s[ 1c s+1]

(13)

(

TLhs =

a+b
ac

(14)
(15)

1
(16)
c
Alternatively, the familiar form of the human sense transfer
function can be simplified as in Eq 17.
TIhs =

Fhs (s) = kphs

TLhs s + 1
s(TIhs s + 1)

(17)

where kphs is the gain in the system, which describes the
quality of human senses while submitting jobs. TLhs and
TIhs represents the time-lead and time-lag in the proposed
module. The signal output from the human sense module
passes through the cognitive model, bridging the gap between
understanding what to preserve and what to perform under
some circumstances. As per the system defined in Fig. 4, an
expression of the cognitive module is related to system outputs
and inputs representing the conservation-of-mass principle.
Besides, the cognitive model is formulated as per Eq. 18.
dfcog (t)
= Pcog (InputF lowcog (t) − OutputF lowcog (t))
dt
(18)
where Pcog is the probability of understanding the
task correctly in uncertain circumstances. The term
InputF lowcog (t) − OutputF lowcog (t) represents the
length of the cognitive process in the human mind, which
can be formulated as the input coming from the human
senses with the delay in output considering the length of
Tcog . Therefore, the formulation and transfer function of the
cognitive model are as presented in Eq. 19 and Eq. 20.
dfcog (t)
= Pcog (ucog (t) − ucog (t − Tcog ))
dt

(19)

(21)

After the cognitive model has been defined, medical staff
need to make a plan for their decision. Here, they need to plan
and obey the rules, somehow make the limitation in jobs. In
this matter, a saturation function in Laplace form is considered.
A saturation function is introduced to define a threshold in
the systems response when the input exceeds the limit. At this
time, the output becomes constant at the highest level of the
threshold. Thus, the plans and rules module in the proposed
system can be mathematically expressed as in Eq. 22 .

In order to familiar form in Eq. 13, some replacements in
the formula are made (see Eqs. 14 - 16 ).
kphs = a

Fcog (s)
e−Tcog s
= Pcog (1 −
)
Ucog (s)
s

(20)

Fpr (s) =

+K
s
−K

s > s0
−s0 < s < s0
s < −s0

(22)

where Fpr (s) is the transfer function of the plans and rules
module represented in Fig. 4.
Finally, the performance and physical actions of medical
staff are like a second-order dynamic system. According to
the McRuer crossover theorem, the proposed model can be
formulated by Eq. 23.
dfa (t)
d2 fa (t)
+B
+ cfa (t) = dupr (t)
(23)
dtt
dt
where A, B, C, D are constant parameters related to the nature
of the system. f (t) is the performance response when the plans
and rules are followed by the staff. The Laplace transform of
this proposed model is calculated as per Eq. 24.
A

Fa (s) =

As2

d
Upr (s)
+ Bs + c

(24)

The transfer function is replaced with a similar form as that
in Eq. 25.
Ga (s) =

Fa (s)
=
Upr (s)

1 2
ωn s

1
+ ω2ξn s + 1

(25)

where ωn and ξ are the natural frequency and damping ratio,
respectively. These parameters define how the dynamic model
can behave in the system.
C. Hospital Model
When viewing a hospital as a system, it can be divided
into two main departmentsemergency and inpatientswhich are
the key departments that affect the quality and timeliness of
patient care. Emergency capacity must be flexible throughout
the day as patients arrive according to a non-homogeneous
arrival pattern. Also, the inpatient sector usually focuses on
maintaining bed occupancy levels to improve efficiency in
terms of utilizing resources. The proposed model describes
the maximum occupancy level and planned capacity.

6

Hospital Flow

M edical Dir ect
Registr ation

Diver t Patients
Inpatient Gain
Am bulance Ar r ival
Em er gency
Queue

Visit Patient in
Em er gency

Em er gency
Holding

Inpatient

Em er gency Walk-in

Fig. 5. General Model of Hospital

The proposed hospital model consists of three patient arrival sources: medical direct admissions, emergency walkin patients, and emergency ambulance arrivals. While the
emergency department is crowded with a considerable number
of walk-in and ambulance arrival patients, diversion might
carry out in the ambulance arrival. Under emergency diversion,
the number of patient arrivals is reduced as ambulances are
rerouted to nearby alternative hospitals. At this point, emergency walk-in patients must be registered. Besides, medical
direct admission patients are sent directly to the inpatient
department upon arrival to the hospital. Similar to ambulance
arrivals, accepting patients to the inpatient department is
heavily dependent on the availability of beds. In this regard,
the diversion might be performed when crowding becomes a
problem. Note that the inpatient department includes many
individual sectors/units, such as the intensive care unit (ICU),
telemetry units, medical/surgical units, etc. However, this work
focuses on the performance of hospitals with high-demand
units under conditions of a Covid-19 outbreak. Figure 5
presents the general model of a hospital during a Covid19 pandemic with consideration of high-demand departments
such as emergency and inpatient departments.
According to the conservation-of-mass principle,
continuous-time patient flow in the proposed hospital model
can be formulated using differential equations according to
disturbances and manipulated variables to measured outputs.
Equations 26 to 31 are formulated to describe changes and
hospital tasks. Ambulance arrivals are correlated with hospital
decisions of accepting or diverting some or all patients to
nearby hospitals. This matter is formulated as Eq. 26.
dfh1
= u1 (t)
(26)
dt
where fh1 (t) is ambulance diversion and u1 (t) describes the
decision between ambulance arrival or ambulance diversion.
Additionally, the emergency queue is a module that makes
decisions about transferring patients emergency queue to delivering services to each individual patient. The mathematical
expression is formulated in Eq. 27.
dfh2
= [d1 (t) + d2 (t)] − [u1 (t) + u2 (t)]
(27)
dt
where fh2 (t) is the emergency queue and d1 (t) and d2 (t)
are the time-varying rates of ambulance and walk-in patient
arrivals, respectively. d1 (t) and d2 (2) are modeled as colored

noise due to a lack of information about the rate of arrivals.
u2 (t) is similar to u1 (t) and represents the decision to transfer
patients in emergency sector to visiting patients or delivering
services.
After completing emergency arrival, it is time to perform
services in the emergency department. Here, the length of
treatment is a crucial consideration. Equation 28 shows the
duration of progress in emergency treatment.
dfh3
= u2 (t) − u2 (t − θemg )
dt

(28)

where fh3 (t) and θemg are the emergency services and length
of treatment, respectively. Emergency holding is a decision
about whether to hold patients in the emergency department
or transfer them to inpatient beds. At this point, medical
staff decide to transfer emergency patients directly to the
inpatient department for further care. Equation 29 describes
the emergency holding decision.
dfh4
= kinp u2 (t − θemg ) − u3 (t)
dt

(29)

where fh4 (t) represents emergency holding and u3 (t) is the
decision to transfer a patient in the holding sector to the
inpatient department. kinp is the probability that emergency
patients are admitted directly to the inpatient sector. Also, the
rate of medical admission is modeled as a decision to deliver
services directly to the patient (see Eq. 30).
dfh5
= u4 (t)
dt

(30)

where fh5 (t) and u4 are the medical diversion and direct
admission decisions, respectively.
Finally, the hospital model describes the number of patients
being treated in the inpatient department. The length of
treatment in this sector is of primary importance. Therefore,
controlling inpatient stays and outpatient services directly
influences the number of Covid-19 cases. In this regard, the
model is formulated as per Eq. 31.
dfh6
= [d3 (t) − d3 (t − θinp )]
dt
+[u3 (t) − u3 (t − θinp )]
+[u4 (t) − u4 (t − θinp )]

(31)

7

where fh6 (t) represent inpatient services. d3 and θinp are the
time-varying rates of direct patient admissions (i.e., modeled
as colored noise) to the inpatient section and the length
of treatment in the inpatient department, respectively. The
Laplace transform of each module is represented in Eq. 32
to Eq. 37.
1
Fh1 (s) = U1 (s)
s
1
Fh2 (s) = {D1 (s) + D2 (s) − [U1 (s) + U2 (s)]}
s

Fh4 (s) =

k −θemg s
1
e
U2 (s) − U3 (s)
s
s

(35)

1
U4 (s)
s

(36)

1
(1 − e−θinp s )D3 (s)
s
1
+ (1 − e−θinp s )U3 (s)
s
1
+ (1 − e−θinp s )U4 (s)
s

y2

Fully Connected Layer

h1

h2

LSTM

LSTM

LSTM

LSTM

(33)
(34)

Fh5 (s) =

y1

(32)

1
(1 − e−θemg s )U2 (s)
s

Fh3 (s) =

Output

Hidden Layer
Size: 400

Time Series
Input

x1

x2

Fh6 (s) =

Fig. 6. LSTM Architecture in Hybrid Model

(37)

D. Dynamic Motion
The dynamic motion model is introduced to describe timevarying cases and deaths. After complete modeling of the
public tasks and facilities, such as hospitals and medical
staff behavior, movement is of importance in the proposed
model. The time-varying movement is obviously dependent on
the proposed models such as the tasks and facilities models
(see Fig. 1). The proposed framework is determined by how
public tasks, facilities, and medical staff behavior affect the
numbers of cases and deaths during a Covid-19 outbreak. In
this dynamic motion module, LSTM is utilized as a dynamic
model in the proposed system. LSTM is a time-series model,
which is able to estimate the temporal correlations acquired by
the simulation model and real data from previous and current
circumstances. Therefore, the decision the LSTM makes at
time t − 1 affects the decision it will be make at the next
time step, t. The LSTM’s feedback connections imitate the
systems dynamic motion, since it takes daily information into
account when the subsequent information is entered. Here, the
proposed LSTM architecture is shown in Fig. 6.
IV. R ESULTS AND D ISCUSSION
In this section, the performance of the proposed hybrid
model is evaluated using the latest available public data
on Covid-191 . From the worldwide distribution of Covid19 cases, the top-ten most-affected countries, which include
1 https://www.ecdc.europa.eu/en/publications-data/download-todays-datageographic-distribution-covid-19-cases-worldwide

Australia, were chosen as a case study. The regional properties used in the proposed model are fundamentally different
from one another because of the different infrastructure of
each region. The model properties, listed in Table I, can be
measured by two approaches. First, by extracting the impact
of each property using a heuristic optimization algorithm [32].
Second, by utilization of actual data and the observed behavior
of the whole system if it is available. In this paper, a genetic
algorithm (GA) was applied to actual Covid-19 distribution
data to determine the impacts of the different modules in
the proposed hybrid model. Dynamic motion is represented
by the LSTM, which is highly correlated with the sequence
length in training the model. The sequence length plays an
essential role in the prediction of Covid-19s spread because
mitigation measures and policies are being improved daily.
In this regard, sequence lengths of 110 days are used as the
primary parameters in training the LSTM.
The boxplot (see Fig. 7 ) shows the distribution of RMSEs
across the different countries for each sequence length. A
seven-day sequence length was found to provide lower variability and shorter outliers than other sequence lengths, while
both cases and deaths are matter. Thus, a seven-day sequence
length was selected to analyze the impacts of the different
modules in the proposed hybrid model.
Table II lists 10 different combinations, from pure LSTM to
the whole hybrid model. Generally, the proposed framework
includes three main models: the Task Model (TM), Facilities
Model (FM), and Dynamic Motion Model (DM). The TM
includes external conditions and reference input, while the
FM consists of two main sections: medical staff and hospital
models. The medical staff model considers human senses, a
cognitive model, plans and rules, performance and physical

8

8000

TABLE I
T HE PARAMETERS OF THE HYBRID MODEL

Cases
Deaths

Description
Colored noise numerator
Colored noise denominator
Gain in equalization
Time-lead in equalization
Time-lag in equalization
Delay time in staff response
Gain in the human sense model
Time-lead in the human sense model
Time-lag in the human sense model
Probability of understanding task
Delay time in cognitive model
Saturation parameters in plans and rules model
Natural frequency of medical staff behavior
Damping ratio of medical staff behavior
Length of treatment in the emergency department
Length of treatment in the inpatient department
Probability of emergency patients being transferred
to the inpatient department

4000

2000

0
1

2

3

4

5

6
Stage

7

8

9

10

11

250
Cases
Deaths

200

Improvement (%)

Variable
A
B
kp
TL
TI
T
kphs
TLhs
TIhs
Pcog
Tcog
K
ωn
ξ
θemg
θinp
kinp

RMSE

6000

150
100
50
0
-50
1

2

3

4

5

6
Stage

7

8

9

10

11

Fig. 8. Cumulative Module Effect
Cases

2

4.5

1.5

4

USA (Cases)

RMSE

10

4

1
0.5
0

104

RMSE: LSTM = 7934.1416, Hybrid Model = 623.2917
Test
LSTM
Hybrid Model

3.5
3
2.5

1

2

3

4

5
6
Sequence Length

7

8

9

10
2
Apr 08

Apr 09

Apr 10

Apr 11

Apr 12

Apr 13

Apr 14

Apr 15

Apr 16

Apr 17

Apr 18

Apr 19
20

Apr 18

Apr 19
20

Day
Deaths

6000

USA (Deaths)

1500

RMSE

RMSE: LSTM = 3135.3616, Hybrid Model = 1671.3501

7000

2000

1000
500
0
1

2

3

4

5
6
Sequence Length

7

8

9

10

Test
LSTM
Hybrid Model

5000
4000
3000
2000
1000
Apr 08

Apr 09

Apr 10

Apr 11

Apr 12

Apr 13

Apr 14

Apr 15

Day

Fig. 7. The Impact of Sequence Length Across the Top Ten Most-Affected
Countries

actions, and the hospital, which is modeled in terms of direct
medical registration, ambulance arrivals, emergency walkins, and emergency services. The DM represents dynamic
movement over time as modelled by LSTM. Here, the USA,
the most-affected country, was chosen to investigate the importance of the modules in the hybrid model.
Genetic Algorithm (GA) was used to find best parameters
for each model. Accordingly, GAs with 200 population size
and 500 performed to minimize the root mean square error
(RMSE) between the predicted and observed data. The RMSE
is calculated as follows:
r Pn
2
t=1 (x̂t − xt )
(38)
RM SE =
n
where x̂t and xt are the observed and predicted values,
respectively.
To assess the statistical significance of the reduction in
RMSE in hybrid models compared to LSTM, each module
was evaluated 500 times after hype-parameter tuning, and

Apr 16

Apr 17

Fig. 9. Performance of Hybrid Model for USA

the corresponding RMSE distribution was used to estimate
95% confidence interval (CI) and t-test p-values comparing
significant differences between stage 11 and other stages.
Table II and Fig. 8) clearly show the cumulative effect. As
seen in Fig. 7, adding TM (stage 2) significantly improved the
accuracy (i.e., 250% better than LSTM). Then, adding more
modules (i.e., greater similarity to the real environment) on top
of TM (i.e., stages 3 to 11) was able to improve the models
performance in comparison with the previous stage.
The cumulative results show that having greater similarity
to the real environment helps to obtain a more accurate model.
Figure 8 demonstrates that not only can the whole modeled system, encompassing everything from public behavior
to hospital performance, reach significant accuracy, it also
imitates changes in Covid-19 time. For instance, Fig. 9 shows
a comparison of LSTM and the proposed model, from which
it presents that the hybrid model can more accurately estimate
real ambient behavior.
The parameters of the hybrid model were tuned by GA

9

TABLE II
C UMULATIVE EFFECT OF MODULES IN THE ACCURACY, ESTIMATION OF 95% CI AND T- TEST P - VALUES TO COMPARE SIGNIFICANT DIFFERENCES
BETWEEN STAGE 11 AND OTHER STAGES
RMSE
Stage

Model

Module

1
2
3
4

DM
TM, DM
TM, FM, DM
TM, FM, DM

5

TM, FM, DM

6

TM, FM, DM

7

TM, FM, DM

8

TM, FM, DM

9

TM, FM, DM

10

TM, FM,DM

11

TM, FM,DM

LSTM
External Condition, Reference Input, LSTM
TM, Human Sense, LSTM
TM, Human Sense, Cognitive Model,
LSTM
TM, Human Sense, Cognitive Model, Plans
and Rules, LSTM
TM, Human Sense, Cognitive Model, Plans
and Rules, Human Performance, LSTM
TM, Medical Staff, Ambulance Arrivals,
LSTM
TM, Medical Staff, Ambulance Arrivals,
Emergency Walk-in, LSTM
TM, Medical Staff, Ambulance Arrivals,
Emergency Walk-in, Medical Direct Registration, LSTM
TM, Medical Staff, Ambulance Arrivals,
Emergency Walk-in, Medical Direct Registration, Emergency Services, LSTM
TM, FM (Medical Staff, Hospital), LSTM

Mean
7934
2431
1740
3310

Std
0.0
1332
1540
1024

Case
95% CI
(7934, 7934)
(2374, 2606)
(1507, 2157)
(3240, 3419)

p-value
0.0
0.0
0.0
0.0

Mean
3135
1598
1413
1025

Std
0.0
560
300
297

Death
95% CI
(3135, 3135)
(1515, 1612)
(1375, 1431)
(998, 1050)

p-value
0.0
0.0028
1.43e − 06
0.0

1337

942

(1257, 1420)

1.14e − 04

1483

173

(1470, 1500)

0.9340

1122

839

(1040, 1183)

0.6987

1503

161

(1492, 1519)

0.0530

1494

956

(1302, 1501)

5.36e − 06

1423

357

(1396, 1456)

0.0011

1642

1029

(1557, 1731)

6.87e − 17

1375

312

(1377, 1394)

1.91e − 11

1562

1105

(1399, 1704)

0.0

1229

365

(1194, 1260)

0.0

1379

1007

(1362, 1636)

0.0

1343

401

(1277, 1348)

8.08e − 16

1154

874

(1057, 1207)

-

1279

195

(1267, 1401)

-

TABLE III
T HE TUNED PARAMETERS OF THE HYBRID MODEL

Parameters
A
B
kp
TL
TI
T
kphs
TLhs
TIhs
Pcog
Tcog
K
ωn
ξ
θemg
θinp
kinp

USA
−0.8101
−0.5035
−2.3547
2.5264
0.8912
1.6098
4.2978
−3.2900
0.5158
0.4272
0.3461
3.1723
3.3560
1.4909
5.1623
6.6954
0.2254

ESP
−4.0729
3.8714
2.0928
0.9372
−5.4006
1.6500
−3.5841
−1.7763
−0.1012
0.4576
5.1084
2.0726
4.1003
2.0292
4.8020
3.7435
0.5349

ITA
−3.3868
2.1760
−2.9657
−2.0098
0.8341
0.4342
−2.3695
2.7730
−1.0059
0.1702
0.4207
1.8494
1.7364
2.3595
2.4513
1.9794
0.1146

FRA
−5.8566
1.5111
−2.5787
4.1430
1.0686
0.8359
−0.1626
−2.9302
4.0982
0.5062
1.6048
3.4353
2.5509
1.7027
4.0678
6.9620
0.1844

DEU
−2.9476
4.3153
4.2061
−2.8764
1.4779
1.980
−1.6574
−2.1169
−0.2475
0.1508
1.8097
1.2141
0.4818
0.9775
0.6537
6.9501
0.5675

for the most-affected countries, which were the United States
of America (USA), Spain (ESP), Italy (ITA), France (FRA),
Germany (DEU), United Kingdom (GBR), Turkey (TUR), Iran
(IRN), China (CHN), Russia (RUS), and Australia (AUS). The
tuned parameters are listed in Table III. The results show
that the hybrid model outperforms the LSTM model. The
performance of the hybrid model in testing and forecasting
is presented in Figs. 10 - 13.
Having tuned the hybrid model’s parameters, the hybrid
model was evaluated using test data. In Table IV, the performance of the hybrid model is compared with that of LSTM.
In this table, RMSEs were obtained for cases and deaths in
different countries. The results show that the performance of
the hybrid model is significantly better than that of LSTM.
Figure 10 to Fig. 13 illustrates that the hybrid model
was capable of more accurate prediction than the LSTM
model with all case studies. Not only can the model predict
the behavior/trend, it also provides accurate estimates of the
numbers of cases and deaths under considerable uncertainty.
In these figures, forecasts for the next 20 days are provided. As

GBR
−4.2758
−1.0266
8.5490
0.6761
8.8155
10.8410
6.8063
−0.2613
−7.4055
0.2494
0.6702
2.0622
2.6556
1.1851
3.9345
1.0285
0.1482

TUR
3.4529
−3.4325
−1.9478
4.0391
−1.5356
1.4949
1.8011
−1.3817
−1.5497
0.1504
2.6286
3.2185
0.2992
0.0713
3.1381
0.6522
0.4656

IRN
−0.7062
2.2764
−2.3545
1.7835
−3.1597
1.6416
−2.2024
−2.0913
5.6994
0.4049
1.1620
1.1833
2.0260
2.0415
3.6335
2.9777
0.8178

CHN
3.5021
3.2667
0.8305
−4.1396
1.3461
6.4313
−2.1579
0.2146
−0.9240
0.4150
4.4143
0.1048
0.9775
2.8391
3.5635
8.4738
0.3856

RUS
2.0335
1.8693
−0.6830
−1.8726
3.3400
1.8808
3.8306
−1.2550
0.5457
0.1231
2.4355
1.8516
1.9706
1.4002
4.1859
5.6019
0.7830

AUS
−0.3415
1.2992
1.8628
−1.2981
1.1695
5.9230
2.8875
−6.4650
0.1841
0.3320
1.4879
2.3600
2.1473
0.0388
2.6156
6.2142
0.3006

TABLE IV
C OMPARISON OF H YBRID MODEL WITH LSTM
RMSE
Country
USA
ESP
ITA
FRA
DEU
GBR
TUR
IRN
CHN
RUS
AUS

LSTM
Case
Death
7934
3135
1512
223
2729
427
1846
587
1070
105
1509
273
2924
10
562
32
223
391
2273
23
37
3

Hybrid
Case
623
342
207
424
173
735
101
227
77
153
15

Model
Death
1671
164
35
264
53
143
17
20
194
6
1

seen, Spain, France, Germany, China, and Australia are able to
control the number of cases at zero cases per day. However, the
numbers of cases in the USA and Turkey in the next 20 days
are around 25,000 and 2,000 per day, respectively. Therefore,
these countries need greater restrictions and improved public

10

knowledge and behavior if they are to decrease the number
of cases. During this period, there is insufficient control in
Iran and the United Kingdom. As the model is sensitive to
large fluctuations in cases and deaths, care should be taken to
maintain a stable trend. Besides, Fig. 12 and Fig. 13 show that
LSTM crashes when estimating cases in Australia and France
because of negative values of cases.
V. C ONCLUSION
A novel hybrid model using LSTM and dynamic behavior
models was proposed to forecast the spread of Covid-19 in
the most-affected countries. Many factors affect the spread of
this virus, so it is very difficult to make the right predictions
of cases and deaths. In this regard, the LSTM and dynamic
behavioral models were used to model a dynamic system with
a high level of fidelity. The results show that the hybrid model
can accurately predict the spread of Covid-19 based on real
data.
The proposed hybrid model provides robust estimates with
the exclusive use of regional properties. Adding more modules
and using real data for different modules can substantially
improve the models performance. In this paper, a TM, FM (including medical staff and hospitals), and DM were constructed
to forecast the spread of Covid-19 in the top ten most-affected
countries. Public knowledge and behavior can directly impact
the spread of Covid-19. Additionally, skilled medical staff and
high-quality hospitals can control the outbreak.
R EFERENCES
[1] R. M. Anderson, H. Heesterbeek, D. Klinkenberg, and T. D.
Hollingsworth, “How will country-based mitigation measures influence
the course of the covid-19 epidemic?” The Lancet, vol. 395, no. 10228,
pp. 931–934, 2020.
[2] A. J. Kucharski, T. W. Russell, C. Diamond, Y. Liu, J. Edmunds, S. Funk,
R. M. Eggo, F. Sun, M. Jit, J. D. Munday et al., “Early dynamics of
transmission and control of covid-19: a mathematical modelling study,”
The lancet infectious diseases, 2020.
[3] A. Camacho, A. Kucharski, Y. Aki-Sawyerr, M. A. White, S. Flasche,
M. Baguelin, T. Pollington, J. R. Carney, R. Glover, E. Smout et al.,
“Temporal changes in ebola transmission in sierra leone and implications
for control requirements: a real-time modelling study,” PLoS currents,
vol. 7, 2015.
[4] S. Riley, C. Fraser, C. A. Donnelly, A. C. Ghani, L. J. Abu-Raddad,
A. J. Hedley, G. M. Leung, L.-M. Ho, T.-H. Lam, T. Q. Thach et al.,
“Transmission dynamics of the etiological agent of sars in hong kong:
impact of public health interventions,” Science, vol. 300, no. 5627, pp.
1961–1966, 2003.
[5] S. Funk, I. Ciglenecki, A. Tiffany, E. Gignoux, A. Camacho, R. M. Eggo,
A. J. Kucharski, W. J. Edmunds, J. Bolongei, P. Azuma et al., “The
impact of control strategies and behavioural changes on the elimination
of ebola from lofa county, liberia,” Philosophical Transactions of the
Royal Society B: Biological Sciences, vol. 372, no. 1721, p. 20160302,
2017.
[6] C. Viboud, K. Sun, R. Gaffey, M. Ajelli, L. Fumanelli, S. Merler,
Q. Zhang, G. Chowell, L. Simonsen, A. Vespignani et al., “The rapidd
ebola forecasting challenge: Synthesis and lessons learnt,” Epidemics,
vol. 22, pp. 13–21, 2018.
[7] B. S. Cooper, R. J. Pitman, W. J. Edmunds, and N. J. Gay, “Delaying
the international spread of pandemic influenza,” PLoS medicine, vol. 3,
no. 6, 2006.
[8] A. J. Kucharski, A. Camacho, F. Checchi, R. Waldman, R. F. Grais, J.-C.
Cabrol, S. Briand, M. Baguelin, S. Flasche, S. Funk et al., “Evaluation
of the benefits and risks of introducing ebola community care centers,
sierra leone,” Emerging infectious diseases, vol. 21, no. 3, p. 393, 2015.

[9] H. Nishiura, D. Klinkenberg, M. Roberts, and J. A. Heesterbeek, “Early
epidemiological assessment of the virulence of emerging infectious
diseases: a case study of an influenza pandemic,” PLoS One, vol. 4,
no. 8, 2009.
[10] P. J. Birrell, D. De Angelis, A. M. Presanis et al., “Evidence synthesis
for stochastic epidemic models,” Statistical Science, vol. 33, no. 1, pp.
34–43, 2018.
[11] M. Baguelin, S. Flasche, A. Camacho, N. Demiris, E. Miller, and
W. J. Edmunds, “Assessing optimal target populations for influenza
vaccination programmes: an evidence synthesis and modelling study,”
PLoS medicine, vol. 10, no. 10, 2013.
[12] N. Ghaffarzadegan and H. Rahmandad, “Simulation-based estimation of
the spread of covid-19 in iran,” medRxiv, 2020.
[13] K. J. Friston, T. Parr, P. Zeidman, A. Razi, G. Flandin, J. Daunizeau,
O. J. Hulme, A. J. Billig, V. Litvak, R. J. Moran et al., “Dynamic causal
modelling of covid-19,” arXiv preprint arXiv:2004.04463, 2020.
[14] J. Dehning, J. Zierenberg, F. P. Spitzner, M. Wibral, J. P. Neto,
M. Wilczek, and V. Priesemann, “Inferring covid-19 spreading rates
and potential change points for case number forecasts,” arXiv preprint
arXiv:2004.01105, 2020.
[15] T. Britton and P. D. O’NEILL, “Bayesian inference for stochastic
epidemics in populations with random social structure,” Scandinavian
Journal of Statistics, vol. 29, no. 3, pp. 375–390, 2002.
[16] J. Lourenco, M. M. de Lima, N. R. Faria, A. Walker, M. U. Kraemer,
C. J. Villabona-Arenas, B. Lambert, E. M. de Cerqueira, O. G. Pybus,
L. C. Alcantara et al., “Epidemiological and ecological determinants of
zika virus transmission in an urban setting,” Elife, vol. 6, p. e29820,
2017.
[17] B. Shulgin, L. Stone, and Z. Agur, “Pulse vaccination strategy in the sir
epidemic model,” Bulletin of mathematical biology, vol. 60, no. 6, pp.
1123–1148, 1998.
[18] A. Pandey, K. E. Atkins, J. Medlock, N. Wenzel, J. P. Townsend,
J. E. Childs, T. G. Nyenswah, M. L. Ndeffo-Mbah, and A. P. Galvani,
“Strategies for containing ebola in west africa,” Science, vol. 346, no.
6212, pp. 991–995, 2014.
[19] R. Li, S. Pei, B. Chen, Y. Song, T. Zhang, W. Yang, and J. Shaman,
“Substantial undocumented infection facilitates the rapid dissemination
of novel coronavirus (sars-cov2),” Science, 2020.
[20] V. Zlatić, I. Barjašić, A. Kadović, H. Štefančić, and A. Gabrielli, “Bistability of sudr+ k model of epidemics and test kits applied to covid-19,”
arXiv preprint arXiv:2003.08479, 2020.
[21] Y. Bengio, A. Courville, and P. Vincent, “Representation learning: A
review and new perspectives,” IEEE transactions on pattern analysis
and machine intelligence, vol. 35, no. 8, pp. 1798–1828, 2013.
[22] O. Vinyals, A. Toshev, S. Bengio, and D. Erhan, “Show and tell: A
neural image caption generator,” in Proceedings of the IEEE conference
on computer vision and pattern recognition, 2015, pp. 3156–3164.
[23] A. Karpathy and L. Fei-Fei, “Deep visual-semantic alignments for
generating image descriptions,” in Proceedings of the IEEE conference
on computer vision and pattern recognition, 2015, pp. 3128–3137.
[24] J. Mao, W. Xu, Y. Yang, J. Wang, Z. Huang, and A. Yuille, “Deep
captioning with multimodal recurrent neural networks (m-rnn),” arXiv
preprint arXiv:1412.6632, 2014.
[25] I. Sutskever, O. Vinyals, and Q. V. Le, “Sequence to sequence learning
with neural networks,” in Advances in neural information processing
systems, 2014, pp. 3104–3112.
[26] A. Graves and N. Jaitly, “Towards end-to-end speech recognition with
recurrent neural networks,” in International conference on machine
learning, 2014, pp. 1764–1772.
[27] W. Kong, Z. Y. Dong, Y. Jia, D. J. Hill, Y. Xu, and Y. Zhang, “Short-term
residential load forecasting based on lstm recurrent neural network,”
IEEE Transactions on Smart Grid, vol. 10, no. 1, pp. 841–851, 2017.
[28] S. Hochreiter and J. Schmidhuber, “Long short-term memory,” Neural
computation, vol. 9, no. 8, pp. 1735–1780, 1997.
[29] Z. C. Lipton, J. Berkowitz, and C. Elkan, “A critical review of
recurrent neural networks for sequence learning,” arXiv preprint
arXiv:1506.00019, 2015.
[30] F. A. Gers, J. Schmidhuber, and F. Cummins, “Learning to forget:
Continual prediction with lstm,” 1999.
[31] D. T. McRuer and E. S. Krendel, “Mathematical models of human pilot behavior,” ADVISORY GROUP FOR AEROSPACE RESEARCH AND DEVELOPMENT NEUILLY-SUR-SEINE (FRANCE),
Tech. Rep., 1974.
[32] S. M. Zandavi, V. Y. Y. Chung, and A. Anaissi, “Stochastic dual simplex
algorithm: A novel heuristic optimization algorithm,” IEEE Transactions
on Cybernetics, 2019.

11

Fig. 10. LSTM and Hybrid Model for USA, ESP and ITA

12

Fig. 11. LSTM and Hybrid Model for FRA, DEU and BGR

13

Fig. 12. LSTM and Hybrid Model for TUR, IRN and CHN

14

Fig. 13. LSTM and Hybrid Model for RUS and AUS

