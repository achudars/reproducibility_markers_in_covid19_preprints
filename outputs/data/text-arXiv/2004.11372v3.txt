Learning to Forecast and Forecasting to Learn from the
COVID-19 Pandemic
Ajitesh Srivastava1 , Viktor K. Prasanna1

arXiv:2004.11372v3 [q-bio.PE] 4 May 2020

1 Ming Hsieh Department of Electrical and Computer Enginnering, University of
Southern California, Los Angeles, California, USA

May 6, 2020

{ajiteshs, prasanna}@usc.edu

Abstract
Accurate forecasts of COVID-19 is central to resource management and building
strategies to deal with the epidemic. We propose a heterogeneous infection rate model
with human mobility for epidemic modeling, a preliminary version of which we have
successfully used during DARPA Grand Challenge 2014. By linearizing the model and
using weighted least squares, our model is able to quickly adapt to changing trends and
provide extremely accurate predictions of confirmed cases at the level of countries and
states of the United States. We show that during the earlier part of the epidemic, using
travel data increases the predictions. Training the model to forecast also enables
learning characteristics of the epidemic. In particular, we show that changes in model
parameters over time can help us quantify how well a state or a country has responded
to the epidemic. The variations in parameters also allow us to forecast different
scenarios such as what would happen if we were to disregard social distancing
suggestions.

Introduction
The recent outbreak of COVID-19 and the world-wide panic surrounding it calls for
urgent measures to contain the epidemic. Predicting the speed and severity of infectious
diseases like COVID-19 and allocating medical resources appropriately is central to
dealing with epidemics. The role of data science in this issue was brought to light when
in December 2013, the first cases of Chikungunya virus appeared in the Americas. In
2014 DARPA announced a Grand Challenge [1] to predict the spread of Chikungunya
virus in 55 countries of the western hemisphere. Through monthly predictions and
reevaluation over seven months, DARPA announced the top winners of the challenge
which included our team [2]. While many winning methods relied on manual
adjustments for generating predictions, ours was a completely automated approach,
thus more generalizable. However, training such a model with rapidly changing
epidemic trends is difficult. Often epidemic models are trained through numerical
solutions to differential equations [3] or through Bayesian inference [4, 5]. Instead, we
transform the model into a linear system and train it using weighted least squares. The
more recent data is more heavily weighted to adapt to rapidly changing trends. Further,
we explore various hyper-parameter selection strategies to identify the best model.
Learning the model also enables understanding of the dynamics of the epidemic and
how it has changed over time. We utilize the changing parameters to study how various
countries and US states have responded to the epidemic. We do so by proposing two

1/12

Fig 1. Heterogeneous Susceptible-Infected model with human mobility. The
model incorporates multiple infection sub-states with varying infection rates within a
region and spread due to inter-region mobility.
measures: (i) Contact Reduction Score that measure how much a region has reduced
transmission; (ii) and Epidemic Reduction Score that measures how much reduction in
confirmed cases a region has achieved compared to a hypothetical scenario where the
trends had remained the same as a reference day in the past. Further it enables analysis
of scenarios into the future, for instance, what would be the trend of the epidemic if
social distancing orders were released.
While we perform our analysis at state and country level. In the future, we plan to
generate similar predictions at county and city level. Applying such machine
learning-based models to a finer level (from countries to states/cities) and larger scale
(more ‘regions’ of the world) brings unique challenges in terms of unreported/noisy data
and large number of model parameters, which will be explored in a future work. In this
paper, we present some of our initial results on country and state-level predictions. We
forecast number of reported cases for US states and for all the countries. We
understand that majority of the infections are conjectured to be unreported [6]. We still
believe that number of reported cases is a good indicator of the stress on the healthcare
system. Henceforth, “number of infected cases” refers to the number of reported cases.
In future work, we plan to incorporate modeling of unreported cases informed by
various ongoing antibodies studies. We are also developing an interactive customizable
tool that can be used to perform predictions using our model. A preliminary version of
the tool has been made publicly available1 .

Methodology
Modeling
We propose an epidemic model (Fig. 1) for spread of a virus like COVID-19 across the
world which captures (i) temporally varying infection rates (ii) arbitrary regions, and
(iii) human mobilty patterns. Within every region (hospital/city/state/country), an
individual can exist in either one of two states: susceptible and infected. A susceptible
individual gets infected when in contact with an infected individual at a rate depending
on when that individual got infected, i.e., rate of infection is β1 for an individual
infected at t − 1, β2 for an individual infected at t − 2, and so on, thus resulting in k
sub-states of infection. The hypothesis is that how actively one passes on the infection
is affected by when they get infected. We assume that after being infected for a certain
time, individuals no longer spread the infection, i.e., ∃k, such that βi = 0∀i > k. Also,
people traveling from other regions can increase the number of infections in a given
1 https://jaminche.github.io/COVID-19/

May 6, 2020

2/12

region. We assume that this infection can happen because of human mobility. Suppose
F (q, p) represents mobility from region q to region p. Our model is represented by the
following system of equations.

∆Stp

k
p
X
St−1
p
=− p
β p ∆It−i
,
N i=1 i

∆Itp =

(1)

k
p
X
X
St−1
p
+δ
F (q, p)
βip ∆It−i
p
N i=1
q

Pk

i=1

q
βiq ∆It−i
.
Nq

(2)

Here, Stp and Itp represent the number of susceptible individuals and infected individuals
respectively in the region p at time t. Parameter δ captures the influence of passengers
coming into the region.
To deal with the fact that using large values of k may overfit the model and that
data is likely to be noisy, we incorporate another hyperparameter J in Eq 2 as follows:
∆Itp

k
X
Sp X p p
p
= t−1
βi (It−iJ − It−(i−1)J
F (q, p)
)+δ
p
N i=1
q

Pk

i=1

q
q
)
βiq (It−iJ
− It−(i−1)J

Nq

. (3)

This creates a dependency on last kJ days with k parameters while having a
“smoothing” effect due to combining infections over J days. Note that if we set
k = 1, J = ∞, and ignore mobility (δ = 0), this reduces to Suceptible-Infected (SI)
model [7]. On the other hand, with bounded k = 1 and J < ∞, the model is a variation
of Suceptible-Infected-Released/Recovered (SIR) model [8], where an infected individual
is active for J units of time. While the model is applicable to any definition of regions,
in this work, we focus on country-level and US state-level forecasts, only. Further, there
is a lag between an individual contracting the virus and their case being reported. We
do not account for this lag, assuming that it is constant. County-level and city-level
forecasting accounting for the lag and unreported cases is planned for future work.

Training
To train the model, we linearize it, by setting δip = δβip and learning it as an
independent parameter. This makes the model more general by allowing different
infection rates for the travelers. This is different from traditional approach of fitting one
curve to the data with fixed initial values, which is computationally expensive and
cannot capture rapidly changing trends. Let


β p = β1p . . . βkp δ1p . . . δkp
(4)


p
p
St (It − It−J )
..




.


p
 St−(k−1)J (I p

t−(k−1)J − It−kJ ) 

p
P F (q,p) q
And, Xt = 
(5)

q


q N q (It − It−J )


..




.
P F (q,p) q
q
T
q N q (It−(k−1)J − It−kJ )]
Then, our model can be represented by the linear equation
∆Itp = β p Xpt ,

May 6, 2020

(6)

3/12

which allows us to learn the parameters using a constrained linear solver. This
formulation works only if k and J are same for all regions. To allow different
hyper-parameters for different regions, we used a further simplification:


β p = β1p . . . βkp δ p


p
St (Itp − It−J
)
..




.
And, Xpt = 

p
p
St−(k−1)J (It−(k−1)J − It−kJ )
P F (q,p) q
q
T
q N q (It − It−kJ )] .

(7)

(8)

To incorporate the fast evolving trend of COVID-19 due to changing policies, we use
weighted least squared to learn parameters βip and δip from available reported data. The
best fit in the least-squares sense minimizes the sum of squared weighted residuals, i.e.,
the difference between observed data and predicted values provided by our learned
model. We incorporate a forgetting factor α ≤ 1 in our minimization to put more
weight to the recent infection trend when learning the model. Lower α implies more
emphasis on the more recent data. We compute the minimum of the sum of squares of
weighted errors as
LSE =

T
X

αT −t (∆Iˆtp − ∆Itp )2

(9)

t=1

=

T
X
T −t
T −t
(α 2 ∆Iˆtp − α 2 βp Xpt )2 ,

(10)

t=1

where ∆Iˆtp is the actual number of newly infected individual.

Data
We present our analysis on two datasets - (i) Global: country-level data with each
country defined as a region; and (ii) US states: state-level data for Unites States with
each state defined as a region. Country-level infections were derived from confirmed
cases obtained from JHU CSSE COVID19 dataset [9]. Population of the countries were
obtained from the World Bank dataset [10]. Inter-country travel data were obtained
from KCMD Global Transnational Mobility dataset [10], which makes the estimation on
the basis of global statistics on tourism and air passenger traffic. Number of infections
for US states were obtained from confirmed cases compiled by New York Times [11].
Population of each state was obtained from US Census Bureau [12]. Inter-state travel
was estimated from number of flights flying between airports in the United States [13].

Results
The hyper-parameters to be picked include k, J, and α. The best hyper-parameter set
is identified by a grid search on k, J, and α, which minimizes the Root Mean Squared
Error over a validation set of H = 3:
s
PT
p 2
ˆp
t=T −H+1 (∆It − ∆It )
RM SE =
(11)
H
We pick α from {0.1, 0.2, . . . , 1.0}, while k, J ∈ {1, 2, . . . , 14}. We enforce Jk ≤ 14 days
so that the dependence of new infections is bounded by the previous two weeks. This is
along the lines of the motivation for 14 days of quarantine2 . We experiment with two
2 https://www.cdc.gov/coronavirus/2019-ncov/travelers/after-travel-precautions.html

May 6, 2020

4/12

methods of setting the hyper-parameters: (i) fixed - same set of hyper-parameters for all
countries/states (ii) variable - specialized parameters for each state/country. The results
are presented next.

Test Results
We evaluated the results for a horizon H = 3 with two hyper-parameters selection
schemes termed SI-kJα (variable) and SI-kJα (fixed). The best heper-parameters were
selected by further splitting the training data, to set the last three days for validation.
We compare these results against a recent generalized version of SEIR model [14].
Besides RMSE, we also measure the mean absolute percentage error given by
1
M AP E =
H

T
X
t=T −H+1

|∆Iˆtp − ∆Itp |
∆Iˆtp

(12)

The comparison is shown in Tab. 1. We used a publicly available implementation of the
baseline 3 . We observe that both fixed and variable hyper-parameter selections widely
outperformed the baseline. Performances of both fixed and variable scheme were
comparable. We use the average of both predictions as an ‘ensemble’ prediction which
performed better than both schemes, individually. It should be noted that the number
of cases across different countries has orders of magnitude difference. Filtering out
countries with small number of cases will significantly reduce MAPE but increases
RMSE. As an example, considering only US for country-level prediction, the RMSE for
all three (fixed, variable, and ensemble) is 6886.9, which translates to 1.12% MAPE. All
the code used in our experiments are available on Github 4 .
Table 1. Comparison of performance
Method
RMSE (US) MAPE (US) RMSE (Global) MAPE (Global)
SI-kJα (variable)
333.3
6.82%
462.6
13.64%
SI-kJα (fixed)
342.05
6.58%
456.0
11.22%
SI-kJα (ensemble)
316.3
5.93%
355.9
11.37%
Gen-SEIR [14]
2106.4
14.31%
7471.2*
41.06%*
Our approach with variable hyper-parameter set has the best performance in terms of both MAPE and RMSE.
*For some countries, the baseline method could not converge and for some the produced MAPE was greater than 100%. We
ignore those countries to favor the baseline which results in averaging over 147 countries.
Fig. 2 shows the test results using SI-kJα (ensemble) prediction on H = 5 days for
four US states. These were arbitrarily selected; other states show similar results as well.
Fig. 3 shows the test results on H = 5 days for four countries. Again, these were
arbitrarily selected. Note that the predictions are extremely accurate. For these results,
we set all mobility terms (F (p, q)) to zero to reflect that due to “stay-at-home” policy
around the world, the recent spread due to travel is negligible. This also reduces the
number of parameters to be learned. For an earlier date, we include mobility and
discuss the details next.

Effect of Travel
To measure the effect of travel, we train our model with data until March 18th, with
and without travel data. The next three days are used as validation set to identify best
hyper-parameters and the following three days are used as test set for evaluation.
3 https://github.com/ECheynet/SEIR
4 https://github.com/scc-usc/ReCOVER-COVID-19

May 6, 2020

5/12

Fig 2. Evaluation on US states. The model accurately predicts on the last 5 days not included in the training. Four
states are selected arbitrarily for illustration.

Fig 3. Evaluation on countries. The model accurately predicts on the last 5 days not included in the training. Four
countries are selected arbitrarily for illustration.

Table 2 shows validation and test errors for both variable and fixed hyperparameter
selection scheme, each with and without travel. Observe that in all cases including
travel data reduces RMSE in the test set. For US states, variable hyper-parameter
scheme performs better, while for Global, fixed scheme has a lower RMSE. This may be
due to lack of enough data resulting in overfitting of variable hyperparameter scheme.
This is evident from the fact that the validation errors are much lower than the test
errors. This observation also supports the decision of going forward with the ensemble
approach instead of choosing one of variable or fixed schemes.
Table 2. Inclusion of Travel Data
Method
travel, variable
without travel, variable
Validation
travel, fixed
without travel, fixed
travel, variable
without travel, variable
Test
travel, fixed
without travel, fixed
Test errors suggest that including travel reduces RMSE.

RMSE
25.6
26.9
48.3
49.1
147.3
166.7
207.0
186.6

US
MAPE
10.11%
9.71%
21.94%
23.61%
19.93%
18.51%
25.08%
19.52%

Global
RMSE MAPE
78.6
9.39%
74.4
8.65%
138.5
22.61%
139.38
25.51%
248.4
21.353%
348.2
23.15%
242.6 19.50%
286.8
21.42%

Insights from Parameters
Since the speed of infection is driven by βip , we can assess the effect of a region’s effort to
battle COVID-19 by the change observed in these parameters. We measure the number

May 6, 2020

6/12

of transmissions a susceptible person receives from an infected individual, assuming the
infections are uniformly distributed across all sub-states. Another approach to define
this quantity is to measure the number of new infections, given that past infections are
uniformly increasing. This allows us to quantify a measure of “contact” without relying
on the state of individuals (infected/susceptible) in the population as
X
p
τN
∝
J p βip .
(13)
i

We define Contact Reduction Score (CRS) for a region (country/state) as the fractional
change in this number of transmissions:
CRS(p) =

p
p
τN
(old) − τN
(new)
.
p
τN (old)

(14)

p
We picked a date in the middle of March as the reference day to learn τN
(old), and
p
compared against τN (new) obtained from training up to April 10. Since, the ensemble
approach for hyper-parameters selection has the best performance, we compute the
number of transmissions as the average of transmissions obtained from both scenarios.
Further, we also define Epidemic Reduction Score, which measures the fractional
reduction in number of infections compared to the scenario where the trend of infection
at reference day had continued.
The Reduction Scores for US states and global countries are shown in Fig. 4. We
ignored all the regions that had less than 100 cases for US state-level and 1000 cases
from country-level data on the reference day in order to make the comparison reliable.
Among the 30 US states that qualify based on the threshold of 100 cases at baseline,
the state with best CRS was New Jersey, and Minnesota scored the worst. Mississippi
has the top ERS with Massachusetts at the bottom of the list. Mississippi is also close
to New Jersey in CRS. We note that Mississippi has been awarded between C and F
since the reference day to early April for its “Social Distancing” score by Unacast 5 .
This suggests that while “Social Distancing” score captures percentage reduction in
average mobility, it does not provide the complete picture of the changes in infection
dynamics. A visual inspection reveals that Mississippi has indeed shown significant
change (Fig. 5) compared to reference day when number of infections were increasing
much more rapidly. At country-level, Brazil has the best CRS with Japan at the
bottom, among 22 countries selected based on a threshold of 1000 infections at reference
day. Based on ERS, US tops the list with Japan at the bottom again. We emphasize
that these rankings are sensitive to the reference day.
While both CRS and ERS measure a region’s response to the epidemic, we believe
that CRS is a better metric to evaluate a region’s efforts. This is due to the fact that
CRS only depends on the model parameters that can be controlled by limiting contact
with others and other policies to reduce transmission. On the other hand, ERS depends
on number of current/past infections which are not completely controlled by changing
policies. For instance, a country which already has large number of cases (yet
significantly less than its susceptible population) will experience a higher increase
compared to a country with fewer cases, even when they have identical model
parameters.

Forecasts
We can use our models not only to generate forecasts, but also for emulating scenarios.
As an example, we compute forecasts with two models: (i) a model trained on most
5 https://www.unacast.com/covid19/social-distancing-scoreboard

May 6, 2020

7/12

Fig 4. Epidemic response evaluation. Contact Reduction Score (CRS) and Epidemic Reduction Score (ERS) for various
US states and countries evaluated for April 10th with March 21st as the reference day.

Fig 5. Infection trends. Comparison of states and countries confirmed cases over time. Vertical line represents the
reference day with respect to which the reduction scores have been computed. Please note that the y-axis is logarithmic.

May 6, 2020

8/12

recent data with no inter-region mobility, and (ii) a model trained on data until
mid-March (reference day) including inter-region mobility. The reference day was set to
middle of March as the majority of US states and countries had not actively imposed
“social distancing” suggestion. The results with both models are shown in Figs. 6 and 7.
Instead of showing a single curve for forecasts, we show a range owing to the difference
in fixed and variable hyper-parameter schemes. All plots suggest that, even though the
current trend is leading to limited number of infections, immediately releasing all
precautions can result in a rapid rise of the epidemic.

Fig 6. Forecasts for US states. The green region depicts the forecast according to the current trend. Red region
represents the forecast for the scenario where the precautionary measures are instantly removed . Four states are selected
arbitrarily for illustration.

Fig 7. Forecasts for countries. The green region depicts the forecast according to the current trend. Red region
represents the forecast for the scenario where the precautionary measures are instantly removed . Four countries are selected
arbitrarily for illustration.

Discussion
Hyper-parameter Selection
We have proposed two schemes for selecting hyper-parameters, fixed and variable.
While both schemes have similar performance, variable scheme has a significant
difference in test and validation error, suggesting that it is prone to over-fitting. On the
other hand, with more data this issue may be resolved. While, currently our ‘ensemble’
approach is simply the average of the predictions using both schemes, the ideal
approach may be a hybrid one, where a collection of regions share the same

May 6, 2020

9/12

hyper-parameters. This is especially useful when there are very few cases in a region.
Then the hyper-parameters and even the parameters for this region can be set to be
equal to that of a “similar” region from where more data is available. One way to
identify such similar regions is by clustering regions based on their trends in a previous
epidemic. In this way, active reporting for COVID-19 can be used to improve forecast of
the next epidemic at an early stage. We will explore this in a future work.

Unreported Cases
We have only modeled reported cases, as they are an indicator of the stress on the
healthcare system. However, unreported cases may affect the long term dynamics. The
unreported cases can be classified into two categories: (i) unreported cases - those who
get infected over the course of the epidemic but do not report it; and (ii) immune cases those who have the antibodies without being infected during the epidemic. For
unreported cases, we can add another state to our model: for an individual in the ith
“infected” sub-state, a report will be made with probability γip . Thus, the total number
Pk
p
of new reported cases is given by ∆R = i=1 γip ∆It−i
. Then the parameters will be
p
learned by fitting the reported cases to Rt . The immune cases can be modeled as
considering them not-susceptible. Suppose, ρp is the probability of a randomly selected
individual in region p to be immune. Then the number of susceptible individuals at
time t is given by Stp = (1 − ρp )N p − Itp . We can integrate these cases complemented by
the ongoing various anti-body studies and surveys that will assist with more accurate
learning of the parameters. Learning these parameters from the data without
considering these studies is difficult. This is due to the fact that the number of total
cases, even if it is 100 times the reported cases, is currently a very small fraction of the
population. As of now, we allow γip and ρp to be inputs in our model. These can be
used to study long-term scenarios with various inputs. For example, Fig. 8 shows the
number of new positive cases (reported) for various values of γip = γ.

Fig 8. Forecasts of reported cases considering total cases. As in the previous figure, we show scenarios for forecast
with the current trend and that with no precautionary measures. For each of those scenarios, the figure shows two
possibilities of the fraction of reported cases with γ = 1/20 and 1/40.

May 6, 2020

10/12

Conclusion
We have proposed a heterogeneous infection rate model with human mobility to model
the spread of COVID-19 at country and state-level. Our model incorporates a forgetting
factor to quickly adapt to the rapidly changing trends due to the changing policies of
how we respond to the epidemic. With a weighted least square training and identifying
the right hyper-parameters, we are able to achieve highly accurate predictions. The
parameters obtained over different time-intervals allow us to measure how various
regions (states/countries) have responded to the epidemic. In particular, we have
defined Contact Reduction Score and Epidemic Reduction Score that respectively
measure reduction in transmission, and reduction in epidemic spread compared to a
hypothetical scenario where a trend of a prior reference point were to continue. These
varying parameters also represent different policies of the past, and hence allow us to
simulate scenarios into the future. For instance, using the parameters learned up to the
point before “social distancing” orders, we can forecast the trajectory of the epidemic, if
everyone were to stop taking distancing precautions.

Acknowledgments
This work was supported by National Science Foundation Award No. 2027007. The
authors would like to thank Frost Tianjian Xu for preparing datasets and Jamin Chen
for integrating our methods into a web-based visualization. The authors also thank
Prathik Rao and Kangmin Tan for implementing and testing various ML approaches.

References
1. DARPA forecasting chikungunya challenge;.
https://www.innocentive.com/ar/challenge/9933617.
2. CHIKV Challenge Announces Winners, Progress toward Forecasting the Spread
of Infectious Diseases;. https://www.darpa.mil/news-events/2015-05-27.
3. Cintrón-Arias A, Castillo-Chávez C, Bettencourt L, Lloyd AL, Banks HT. The
estimation of the effective reproductive number from disease outbreak data.
arXiv preprint arXiv:200406827. 2020;.
4. Lekone PE, Finkenstädt BF. Statistical inference in a stochastic epidemic SEIR
model with control intervention: Ebola as a case study. Biometrics.
2006;62(4):1170–1177.
5. Dukic V, Lopes HF, Polson NG. Tracking epidemics with Google flu trends data
and a state-space SEIR model. Journal of the American Statistical Association.
2012;107(500):1410–1426.
6. Lau H, Khosrawipour V, Kocbach P, Mikolajczyk A, Ichii H, Schubert J, et al.
Internationally lost COVID-19 cases. Journal of Microbiology, Immunology and
Infection. 2020;.
7. Zhou T, Liu JG, Bai WJ, Chen G, Wang BH. Behaviors of susceptible-infected
epidemics on scale-free networks with identical infectivity. Physical Review E.
2006;74(5):056109.
8. Bjørnstad ON, Finkenstädt BF, Grenfell BT. Dynamics of measles epidemics:
estimating scaling of transmission rates using a time series SIR model. Ecological
monographs. 2002;72(2):169–184.

May 6, 2020

11/12

9. 2019 Novel Coronavirus COVID-19 (2019-nCoV) Data Repository by Johns
Hopkins CSSE;. https://github.com/CSSEGISandData/COVID-19.
10. KCMD Global Transnational Mobility;.
https://bluehub.jrc.ec.europa.eu/catalogues/data/dataset/ds00162.
11. Coronavirus (Covid-19) Data in the United States;.
https://github.com/nytimes/covid-19-data.
12. State Population Totals: 2010-2019;.
https://www.census.gov/data/datasets/time-series/demo/popest/
2010s-state-total.html#par_textimage_500989927.
13. Airport, airline and route data;. https://openflights.org/data.html.
14. Peng L, Yang W, Zhang D, Zhuge C, Hong L. Epidemic analysis of COVID-19 in
China by dynamical modeling. arXiv preprint arXiv:200206563. 2020;.

May 6, 2020

12/12

