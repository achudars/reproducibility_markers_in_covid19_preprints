OPTIMAL LOCKDOWN FOR PANDEMIC CONTROL

arXiv:2010.12923v3 [math.OC] 26 Jan 2021

QIANQIAN MA∗, YANG-YU LIU†, AND ALEX OLSHEVSKY‡
Abstract. As a common strategy of contagious disease containment, lockdown will inevitably weaken the economy. The ongoing
COVID-19 pandemic underscores the trade-off arising from public health and economic cost. An optimal lockdown policy to resolve
this trade-off is highly desired. Here we propose a mathematical framework of pandemic control through an optimal non-uniform
lockdown, where our goal is to reduce the economic activity as little as possible while decreasing the number of infected individuals at
a prescribed rate. This framework allows us to efficiently compute the optimal lockdown policy for general epidemic spread models,
including both the classical SIS/SIR/SEIR models and a new model of COVID-19 transmissions. We demonstrate the power of this
framework by analyzing publicly available data of inter-county travel frequencies to analyze a model of COVID-19 spread in the 62
counties of New York State. We find that an optimal lockdown based on epidemic status in April 2020 would have reduced economic
activity more stringently outside of New York City compared to within it, even though the epidemic was much more prevalent in New
York City at that point. Such a counterintuitive result highlights the intricacies of pandemic control and sheds light on future lockdown
policy design.

1. Introduction. The COVID-19 pandemic has resulted in more than 92.3M confirmed cases and 2.0M
deaths (up to Jan 13th, 2021) [31] and has impacted the lives of more than 90% global population [13, 59].
Curbing the spread of the pandemic like COVID-19 depends critically on the successful implementation
of non-pharmaceutical interventions such as lockdowns, social distancing, shelter in place orders, contact
tracing, isolation, and quarantine [14, 46, 19, 22]. However, these interventions can also lead to substantial
economic damage, motivating us to investigate the problem of curbing pandemic spread while minimizing
the induced economic losses.
We consider the problem of designing an optimal lockdown that minimizes the economic damage while
reducing the number of new infections to zero at a prescribed rate. Such a lockdown should be non-uniform,
because shutting down different locations has different implications both for the economic cost and for
pandemic spread. The difficulty is whereas a uniform lockdown can be found through a search over a single
parameter, a non-uniform lockdown is parametrized by many parameters associated with different locations.
Despite of its significance and implications, a computationally efficient framework to design the optimal
lockdown strategy is still lacking.
Here we propose such a framework by mapping the design of optimal lockdown policy to a classical
problem in control theory — design an intervention that affects the eigenvalues of a matrix governing the
dynamics of a dynamical system. It turns out that, even though general epidemic spreading dynamics are
highly nonlinear, an eigenvalue bound for a linear approximation of the spreading dynamics nevertheless
forces the number of infections at each location to go to zero asymptotically at a prescribed rate. We provide
two polynomial-time algorithms that design the optimal lockdown to achieve such an eigenvalue bound.
We apply these algorithms to design optimal lockdown on both synthetic and real data (using data from
SafeGraph [54] to fit a county-level model of New York State) for epidemic spread models of COVID-19
using disease parameters from the literature [23, 7, 8]. Unsurprisingly, we find that the best heterogeneous
lockdown is far more economical than a homogeneous lockdown. However, we find additional features of
the optimal lockdown that are counter-intuitive. For example, we find that in models of random graphs,
degree centrality and population do not affect the strength of the optimal lockdown of a location unless its
population (or degree centrality) takes extremely smaller (or larger) values than others. Most surprisingly,
we show that an optimal lockdown based on the epidemic status in April 2020 would have reduced activity
more strongly outside of New York City (NYC) compared to within it, even though the epidemic was much
∗ Department

of Electrical and Computer Engineering, Boston University, Boston, MA, USA
Division of Network Medicine, Brigham and Women’s Hospital, Harvard Medical School, Boston, MA 02115, USA
‡ Department of Electrical and Computer Engineering and Division of Systems Engineering, Boston University, Boston, MA, USA
† Channing

1

This manuscript is for review purposes only.

more prevalent in NYC at that point.
2. Results. All the epidemic spread models considered in this work are compartmental or network
models [8, 43] with “locations” corresponding to neighborhoods, counties, or other geographic subdivisions.
We consider n locations, with the variable xi denoting the proportion of infected population at location i. Our
framework can be applied to general epidemic spread models. For demonstration purpose, here we consider
a simple model of COVID-19 which contains the classical Susceptible-Infectious-Recovered (SIR) model
and the Susceptible-Exposed-Infectious-Recovered (SEIR) model as special cases. Besides the COVID-19
model, we also consider the classical susceptible-infectious-susceptible (SIS) model; details about the SIS
model can be found in SI Sec. 3.1. The optimal lockdown issue we consider is summarized in Fig.1.
A network model of COVID-19. We consider a simple model (similar to models in literature [23, 8])
of COVID-19 spreading that breaks infected individuals into two types: asymptomatic and symptomatic.
This model allows individuals transmit the infection at different rates:
ṡi = −si

n
X

ai j (βa xaj + βs xsj )

j=1

(2.1)

ẋia = si

n
X

ai j (βa xaj + βs xsj ) − ( + ra )xia

.

j=1

ẋis =  xia − rs xis
Here si (xia or xis ) stands for the proportion of susceptible (asymptomatic or symptomatic infected, respectively) population at location i, ai j captures the rate at which infection flows from location j to location i,
βa (or βs ) is the transmission rate of asymptomatic (or symptomatic) infected individuals, ra (or rs ) is the
recovery rate of asymptomatic (or symptomatic) infected individuals. We assume infected individuals are
asymptomatic at first and  is the rate at which they develop symptoms. We use different parameters for
symptomatic and asymptomatic individuals because a recent study [35] reported that asymptomatic individuals have viral load that drops more quickly, so they not only recover faster, but also are probably less
contagious.
Note that our model of COVID-19 spreading can be considered as a generalization of the classical SIR
model and the SEIR model of epidemic spread. Indeed, by setting βs =  = rs = 0, we recover the SIR
model; and by setting βa = ra = 0, we recover the SEIR model. However, neither the SIR nor the SEIR
model captures the existence of two classes of individuals who transmit infections at different rates as above.
Our model can also be considered as a simplification of existing models in studying COVID-19 spreading
[8, 23]. For example, in [8], asymptotic stability was considered in a slightly more general model including
both births and deaths. Here for simplicity in our model we consider a fixed population size. In [23]
eight classes of patients (instead of two) were introduced, depending on whether the infection is diagnosed,
whether the patient is hospitalized, as well as other factors.
In matrix form, we can write our model as



0
−βa diag(s)A
−βs diag(s)A  

 ṡ  
  sa 
 a  
a
a
s

 ,





x
ẋ
(2.2)
0
β diag(s)A − ( + r ) β diag(s)A  
 s  = 

 xs
ẋ


0

−rs
where scalars in the matrix should be understood as multiplying the identity matrix. Let us write M(t) for
the bottom right 2n × 2n submatrix (outlined by a box) in Eq. (2.2). It turns out that, if we want the number
2

This manuscript is for review purposes only.

of infections at each location (or a linear combination of those numbers) to go to zero at a prescribed rate α,
we just need to ensure that the linear eigenvalue condition λ(M(t0 )) ≤ −α holds (see SI Sec. 3.3 for a formal
proof).
Lockdown model. Methods of constructing A capturing spatial heterogeneity have been well studied
[39, 55, 3, 5, 48, 12]. Here we follow a recent work [8]that is particularly well-suited to model the lockdowns
in curbing COVID-19. Denote the fixed population size at location i as Ni , and assume people travel from
location i to location j at rate τi j . It is well accepted that such travel rates determine the evolution of an
epidemic. For example, it has been reported that regional progress of influenza is much more correlated with
the movement of people to and from their workplaces rather than geographic distances [60]. The quantities
ai j can then be determined as (see SI Sec. 3.2 for details):
(2.3)

ai j =

n
X

Nj
.
k=1 Nk τkl

τil τ jl Pn

l=1

It is intuitive that ai j is the sum of the terms involving τil τ jl since this product captures the interactions
between people from locations i and j through visits to location l. Eq. (2.3) can also be written in matrix
form as A = CB> with
(2.4)

C = τ, B> = D1 τ> D2 ,

P
where τ = (τi j ), D1 = diag( k Nk τkl )−1 while D2 = diag(N1 , . . . , Nn ).
When a lockdown is ordered heterogeneously across different locations, this has two consequences.
First, the transmission rates will be altered. For instance, ensuring that all buildings have a maximum
enforced density limits the rate at which people can interact, as do mandatory face-covering, and other
measures, resulting in a number of transmissions that is a fraction of what they otherwise would have been.
We may account for this as follows. From Eq. (2.3), we have that
βa ai j =

n
X

Nj
.
k=1 Nk τkl

βa τil τ jl Pn

l=1

The effect of the lockdown is to replace βa in each term of the sum by βa fl , for some location-dependent
fl ∈ [0, 1]. The effect on βs ai j is similar. Secondly, travel rates to location l are also a fraction of what
they were before since there is now reduced inducement to travel, i.e., τil should be replaced by τil gl with
gl ∈ [0, 1] for each location l.
To avoid overloading the notation, we will not change the definitions of βa , β s or the travel rates τil but
instead achieve the same effect by changing the definition of ai j as:
ai j =

n
X
l=1

Nj
τil τ jl ,
k=1 Nk τkl

zl Pn

where zl = fl gl ∈ [0, 1]. In matrix notation, the post-lockdown A matrix is
(2.5)

A = Cdiag(z)B> .

The quantities z1 , . . . , zn can be thought of as measuring the intensity of the lockdown at each location.
Lockdown cost. Clearly, setting zl = 1 corresponds to doing nothing and should have a zero economic
cost. On the other hand, choosing zl = 0 corresponds to a complete lockdown and should be avoided. We
3

This manuscript is for review purposes only.

will later apply our framework to real data collected from counties in New York State; shutting down a
county entirely would result in people being unable to obtain basic necessities, and thus the economic cost
should approach +∞ as zl → 0. Moreover, it is clearly a good idea to consider a convex cost. With these
considerations in mind, a natural choice of lockdown cost is
!
n
X
1
cl
(2.6)
c(z1 , . . . , zn ) =
−1 .
zl
i=1
Here cl captures the relative economic cost of closing down location l. Throughout this paper, we will choose
cl to be the employment at local l, but other choices are also possible (e.g., cl could be the GDP generated at
location l).
Besides the costfunction in Eq. (2.6), we will also consider cost functions
 that blow up with different
P
Pn
exponents as ni=1 cl z−k
−
1
,
as
well
as
costs
which
threshold
as
min
cl (z−1
i=1
l − 1), C l which alter our
l
cost function by saturating at some location-dependent cost Cl rather than blowing up as zl → 0.
2.1. Analytical Results.. We will consider two variations of the lockdown problem, whose difference
is whether an optimal lockdown is allowed to increase activity in certain locations. Constrained lockdown:
we seek to find a vector z with entries in [0, 1] minimizing lockdown cost determined by Eq. (2.6) subject to
the bound λmax (A − γI) ≤ α in the SIS model, and λmax (M(t)) ≤ α in the case of the COVID-19 model of Eq.
(2.2). Unconstrained lockdown: same as above, but we do not constrain the entries of z to lie in [0, 1]. (The
two factors fl and gl described in the previous subsection will not be constrained to lie in [0,1] either.)Indeed,
if certain locations contribute little to disease spread but have very high relative economic cost of lockdown,
one could even increase activity in these locations to allow for a harsher lockdown elsewhere with the same
overall cost. While our methods work for both variations, all of our simulations and empirical results will
consider the constrained version. Our approach of stabilizing the system by forcing the eigenvalues to
have negative real part is a standard heuristic in control theory [37, 45, 24]. This approach comes with a
caveat—if pushed to the extreme by moving the eigenvalues further and further towards negative infinity,
the asymptotically better performance will start coming at the expense of the non-asymptotic behavior of the
system.
We next turn to describe our main results. Our first step is to discuss an assumption required by one of
our algorithms, i.e., the recovery rate γ has to be small relative to the entries in the matrices C and B. We
call this “high-spread assumption” (see Assumption 3.5 in SI Sec. 3.4 for the formal description). We will
later show that, under this assumption, the constrained and unconstrained lockdown problems are equivalent.
This is quite intuitive: if the epidemic spreads sufficiently fast everywhere, the unconstrained shutdown will
never choose to increase the activity of any location.
Main theoretical contribution. With the above preliminaries in place, we can now state our main
theoretical contribution. Our main theorem provides efficient algorithms for both the unconstrained and
constrained lockdown problems (see Theorem 3.6 in SI Sec. 3.4 for the formal description of this theorem).
In particular, we first prove that the unconstrained lockdown problem for both SIS and COVID-19 models
can be exactly mapped to the classical matrix balancing problem (see SI Sec. 2.2 for details) and solved
with nearly linear time complexity. Moreover, we prove that if the “high-spread” assumption holds, then
the constrained lockdown problem is equivalent to the unconstrained lockdown problem and consequently is
also reducible to matrix balancing. Even if the “high-spread” assumption does not hold, we prove that under
certain conditions the constrained lockdown problem for the SIS and COVID-19 models can still be solved
by applying the covering semi-definite program with polynomial time complexity of Õ(n3 ), where the tilde
hides factors logarithmic in model parameters. To summarize, we give three separate cases that cover all
4

This manuscript is for review purposes only.

possible scenarios. In two of these cases, the optimal lockdown problem is solvable in nearly linear time,
and in the remaining case, it is solvable in Õ(n3 ).
In practice, we find the optimal lockdown problem is solvable in linear time in the vast majority of the
cases. Specifically, when we fit the models to New York State data, in 23 experiments out of 27, the linear
time algorithm gave the correct answer.
2.2. Empirical Application.
We now apply the algorithms we’ve developed to design an optimal
lockdown policy for the 62 counties in the State of New York (NY). Our goal is to reduce activity in each
county in a non-uniform way to curb the spread of COVID-19 while simultaneously minimizing economic
cost. The data sources we employed are presented in SI Sec. 4.
We consider only the constrained lockdown problem here. When the “high-spread” assumption is satisfied, we will apply the matrix-balancing algorithm, otherwise we will apply the covering semi-definite
program. To provide valid estimation results, we employed three different sets of disease parameters provided in literature [7], [8], [23] (See Supplementary Table 2).
Comparison with other lockdown policies. We used the data of the 62 counties in NY on April 1st,
2020 as initialization and estimated the number of active cases over 300 ∼ 800 days and the number of
cumulative cases over 500 ∼ 1, 500 days with different lockdown policies. Fig.2a-c show the estimated
active cases over times, and Fig.2d-e show the estimated cumulative cases over time. Here results from different columns of Fig.2 were calculated by using different sets of disease parameters adopted from literature
[8, 23, 7].
We compared the optimal heterogeneous lockdown policy calculated by our methods with several other
benchmark policies: (1) no lockdown, i.e., zl = 1 for all locations; (2) random lockdown, zl is randomly
chosen from a uniform distribution U[a, b] with the lower- and upper-bounds a and b chosen such that the
overall cost of this policy is the same as that of our policy; (3) uniform lockdown, where zl = z is the same
for all the locations and z is chosen such that the overall economic cost is the same as that of our policy; (4)
uniformly-bounded-decline locdown, where the “decline” is uniformly bounded across locations, i.e., the
decay rate of the infections in each location is bounded by a constant α, where α is chosen such that the
economic cost of this policy is the same as that of our policy. Note that among the four benchmark policies
both the uniformly-bounded-decline lockdown and the random lockdown are heterogeneous locationwise.
From Fig.2, we can see that our optimal heterogeneous lockdown policy outperforms all other lockdown
polices in terms of the total final number of cumulative cases. Similar findings are reported for the SIS and
SIR models in S Fig.1 and S Fig.2.
Optimal lockdown rate z∗l for each county. Fig.3 shows lockdown-rate profiles zl calculated by various
policies. First, we found that the optimal lockdown profile is quite sensitive to the disease parameters.
Second, surprisingly, the values of z∗l for counties in NYC are relatively higher (corresponding to a less
stringent lockdown) than that of counties outside NYC, regardless of the disease parameters. This is a
counter-intuitive result: even though the epidemic was largely localized around NYC on the date we used to
initialize the infection rates, the calculated optimal lockdown profile indicates that it is cheaper to reduce the
spread of COVID-19 by being harsher on neighboring regions with smaller populations. It can be observed
from Fig. 3 that this pattern only appears in our heterogenous optimal lockdown policy.
In SI Sec. 6, we further replicate the same finding in a much simpler city-suburb model: we consider
a city with large population and a neighboring suburb with small population and observe that the optimal
lockdown will choose to shut down the suburb more stringently. In SI Sec. 9, we further confirmed the same
counterintuitive phenomenon using other cost functions.
We investigate this finding further in SI Sec. 7, where we let the metric to be optimized be the total
number of infections. As a counterpoint, we do a greedy search over all two-parameter lockdowns that shut
5

This manuscript is for review purposes only.

down NYC harder than the rest of New York State. Here the two parameters z(1) and z(2) denote the lockdown
factors in NYC and the rest of NYS, respectively. Our results show that our lockdown has a smaller number
of infections than the best two-parameter lockdown of the same cost.
This phenomenon likely occurs because shutting down a suburb with small population yields benefits
proportional to the much larger population of the city, since a shutdown in the suburb affects the rate at which
infection spreads in the city as city residents can infect each other through the suburb. Similarly, a possible
explanation for the phenomenon we observe on New York State data is that shutdowns outside of NYC may
be a cheaper way to curb the spread of infection within NYC.
Additional observations. To fully understand the effect of the disease-related parameters to the optimal lockdown-rate profile {z∗l } and the economic cost, we implemented additional numerical experiments to
analyze the sensitivity. The results are shown in SI Fig.6. It can be seen that the value of z∗l and the corresponding economic cost are sensitive to recovery rate and the initial growth rate but not to other parameters.
We also studied the relationship of the value of z∗l and the structure of the underlying graph. We plotted
the obtained z∗l with respect to degree, home-stay rate, population, and employment in SI Fig.7. We also
implemented random permutation experiments (where we randomly permute one parameter while fixing
everything else) in terms of degree, home-stay rate, population, employment and initial susceptible rate, and
the results are shown in SI Fig.8 and SI Fig.9. From these experiments, we found the distribution of z∗l can be
strongly affected by permutations of centrality, population, and the home stay rate. However, the distribution
of z∗l is not altered much by permuting employment and the initial susceptible rate. More details about these
experiments are presented in SI Sec. 5.
2.3. Numerical Simulations. From the empirical analysis of data in New York State, we hypothesize
that the home-stay rate, degree centrality, and population are three major parameters that impact the optimal
lockdown rate z∗l of county-l. However, no inferences can be made about the effect of these parameters from
empirical data because all of them vary together. To study how the value of z∗l is related to these parameters,
we implement experiments on synthetically generated data. We describe the experiments and results next,
with full details provided in the supplementary SI Sec. 5.
Impact of degree centrality. To study the impact of degree centrality, we considered geometric random
graphs (see SI Sec. 5.5 for other graphs). The population, the home-stay rate, and the initial susceptible rate
of different nodes are set as the same values across all the nodes. The simulation results are presented in
Fig.4a-b. We found that degree centrality only matters for the value of z∗l when there exist hotspots (i.e., hubs
node with very high degrees). Beyond such hotspots, the effect of degree centrality is essentially ignorable.
Impact of population. To study the impact of population, we fix all other model parameters and vary
the population of the nodes. We again considered geometric random graphs, where node degrees are similar.
The simulation results are presented in Fig.4c. We found that nodes with small populations are assigned
smaller values of z∗l , but once the population is large enough, z∗l is almost independent of the population size.
Impact of home-stay rate. To study the impact of home-stay rate, we fixed all other model parameters
and tuned the home-stay rate of the nodes. Our simulation results based on the geometric random graphs
were presented in Fig.4d. We found that z∗l increases with increasing home-stay rate, which agrees well with
our intuition.
3. Discussion. We proposed two efficient algorithms for optimal pandemic control through lockdown.
Our algorithms are applicable to a variety of epidemic models from SIS/SIR/SEIR to a model of COVID-19
spread. Through extensive numerical simulations, we found a number of counterintuitive features of optimal
lockdowns. For example, we observed that, over a range of random network models, degree centrality and
population only have an effect when they take on extreme values. We also observed that a model of epidemic
6

This manuscript is for review purposes only.

spread in New York State will tend to shut down outside of NYC more stringently that NYC itself, even if
the epidemic is largely localized to NYC. We have further replicated this phenomenon in a simple two-city
model of city-suburb model..
While we have focused on simple models in this work, our methods can be applied to more complex models, such as the SIDHARTE model [23], which contains more than two classes (asymptomatic/symptomatic) of infected people. If additional data sets become available on variations of activity
by age and location in the future, it is possible to incorporate this as in [9]; one could, for example, split each
city into multiple nodes, with each node corresponding to a different age group residing in that city.
More broadly, we believe future research on optimal pandemic control would strongly benefit from the
collection of new data sets which would allow more sophisticated and accurate models to be used. For
example, our approach leveraged travel data obtained from SafeGraph, which is based on cell phone data.
We do not know from SafeGraph how many of the minutes recorded as travel outside might have been
spent alone in a vehicle, with no possibility for transmission to other individuals. Similarly, appropriately
anonymized public data sets would allow us to better understand how people respond to lockdown and
estimate a model with a more heterogeneous response compared to our model here, which proposed a simple
scaling down of trips.

7

This manuscript is for review purposes only.

a

𝑠

𝑥!

contagion

Susceptible

Asymptomatic
infected

𝜷𝒂 , 𝜷𝒔
ry
ove 𝒓𝒂
rec

𝑟

𝑥"

recovery
𝒓𝒔

Recovered

b

symptoms 𝝐
Symptomatic
infected

c

d

𝝉𝟐𝟐

C

B
e 2_5
Q)

ro
(.)

A

A

A

(/)

𝒂𝟏𝟏

𝒂𝟏𝟏

𝝉𝟏𝟏

X

𝝉𝟑𝟑

𝒂𝟐𝟐

B

𝒂𝟑𝟐
𝒂𝟐𝟑

𝒂𝟐𝟐

𝒂𝟑𝟑

C

𝒂𝟑𝟐

B

𝒂𝟐𝟑

C

𝒂𝟑𝟑

10 5

2

(/)

Q)

> 1.5

�

ro

L

L

:::J

E

:::J

(.)

ro

1

+-'
+-'

:it 0.5

T

o�---��-�-�-������----�--�-�-������---�--�
10 °

Time (days)

---no lockdown --- random lockdown ---uniform locklodown ---uniformly-bounded-decline lockdown ---ours

Fig. 1 Framework of the optimal lockdown design. a, the COVID-19 model we consider, which corresponds to Eq.
(2.1). b, the travel pattern of a three-nodes network, where A represents a city with large population, B and C represent
two suburbs with small population, τi j represents the travel rate from location i to location j in a day. c, the infection
flow pattern of the three-nodes network before the lockdown, ai j represents the infection flow as described in Eq.(2.1).
Note that although no travel occurs between nodes B and C, the corresponding entries a23 and a32 are nonzero since
people from these locations can meet each other in location A. d, the infection flow pattern of the same network after the
lockdown. The widths of the edges in c, d are propotional to the value of ai j . When lockdown policy are implemented,
the value of ai j will decrease, which lead to the control of the epidemics. e, the estimated number of cumulative cases
of different lockdown polices. In this figure, “ours” represents the heterogeneous optimal lockdown calculated by our
method, “uniform lockdown” represents a uniform policy with the same economic cost as our lockdown. Random
lockdown rate zl is randomly chosen from a uniform distribution U[a, b] with the lower- and upper-bounds a and b
chosen such that the overall cost of this policy is the same as that of our policy. Uniformly-bounded-decline lockdow
implies a policy where the decay rate of the infections in each county is bounded by a constant α, where α is chosen
such that the economic cost of this policy is the same as that of our policy. For this small network, the lockdown rates
of our heterogeneous policy are z1 = 0.21, z2 = 0.06, z3 = 0.06. By contrast, the lockdown rates of the uniform policy
with the same cost are z1 = 0.16, z2 = 0.16, z3 = 0.16. It can be seen that our policy outperforms all the other lockdown
policies.

8

This manuscript is for review purposes only.

a

b

c

d

e

f

>-z

>-z

1.5

>

Q)

C
Cl)
Q)
Cl)

Cl)
Q)
Cl)

Cl)
Q)
Cl)

co
(.)

1

>

Q)

co
(.)

1

>

Q)

co

co

:;::;

co

:;::;

E

E

E

:;::;

5

=t:t:

::J

::J

::J

5

o.5

=t:t:

o�����������-��
10 °

10 1

10 2

o��������������
10 °

1.6
1.4
1.2
1

(.)

=t:t:

10 1

10 2

10 6

1.8

::J

o.5

X

2

Cl)

1.5

C

C

co
(.)

>-z

Cl)

Cl)

2_2

' '

0.8
0.6
10 °

'

1o 1

'

10 2

Time (days)
Time (days)
Time (days)
-- no lockdown -- random lockdown -- uniform locklodown -- uniformly-bounded-decline lockdown -- ours

I

Fig. 2 Estimated number of active casesand cumulative cases for the COVID-19 model by applying different lockdown
policies based on available data about COVID-19 outbreak in NY on April 1st, 2020. a-c, the estimated number of active
cases in NY. d-f, the estimated cumulative cases in NY. In a, d, the disease parameters are set as in [7], the decay rate
α is chosen as 0.0231 which corresponds to halving every 30 days. In b, e, the disease parameters are set as in [23], the
decay rate is chosen as α = 0.2rs = 0.0034 so that α < min(ra , rs ). In c, f, the disease parameters are set as in [8], the
decay rate α is chosen 0.0231 that corresponds to halving every 30 days. Uniform lockdown, random lockdown, and
uniformly-bouded-decline lockdown are defined as in Fig 1.

9

This manuscript is for review purposes only.

z
ₗ
*
0.
1077

0.
6510

b

z
ₗ
*
0.
0255

0.
1544

c

z
ₗ
*
0.
6310

1.
0000

Our
s

a

©Mapbox©OSM

©Mapbox©OSM

z
ₗ
0.
1077

0.
6510

e

©Mapbox©OSM

z
ₗ
0.
0255

0.
1544

f

z
ₗ
0.
6310

1.
0000

Uni
f
or
m Loc
kdown

d

©Mapbox©OSM

©Mapbox©OSM

©Mapbox©OSM

z
ₗ
0.
1019

0.
3444

h

z
ₗ
0.
03614

0.
07343

i

z
ₗ
0.
95724

0.
99955

Random Loc
kdown

g

©Mapbox©OSM

©Mapbox©OSM

z
ₗ
0.
0202

0.
6768

k

©Mapbox©OSM

z
ₗ
0.
0037

0.
1122

l

z
ₗ
0.
1743

1.
0000

Uni
f
or
ml
yboundeddec
l
i
ne
Loc
kdown

j

©Mapbox©OSM

©Mapbox©OSM

©Mapbox©OSM

Fig. 3 Lockdown rate of each county given by different polices for the COVID-19 model based on available data about
COVID-19 outbreak in NY on April 1st, 2020. a-c, optimal lockdown rate z∗l given by our method . d-f, uniform
lockdown rate zl . g-i, random lockdown rate zl . j-l, uniformly-bounded-decline lockdown rate zl . Uniform lockdown,
random lockdown, and uniformly-bouded-decline lockdown are defined as in Fig 1. In a, d, g, j, the disease parameters
are set as in [7], the decay rate α is chosen as 0.0231 which corresponds to halving every 30 days. In b, e, h, k the disease
parameters are set as in [23], the decay rate is chosen as α = 0.2rs = 0.0034 so that α < min(ra , rs ). In c, f, i, l, the
disease parameters are set as in [8], the decay rate α is chosen 0.0231 that corresponds to halving every 30 days. It can
seen from a-c that the value of z∗l for counties in NYC are relatively higher than other counties in New York State, which
implies we should shutdown the outside of NYC harder than itself. Besides, it can be seen that such counter-intuitive
phenomenon does not appear in any other lockdown polices.
10

This manuscript is for review purposes only.

5

10

Degree

15

0.18

SIS
SIS
SIR
SIR
COVID-19
COVID-19

0.14
0.14
0.12

0.05

0

50

100

Degree

150

200

0.120.1
0 0

10

5 20

1030

Degree
Degree

SIS
SIS
SIR
SIR
COVID-19
COVID-19

0.18

0.16
0.15
0.14

0.1
0.12

0.1
0.05
00

40
15

5050

100
100

Degree
Degree

150
150

200
200

n = 200, d = 2, r = 0.2, no additional hotspot
d0.2

Optimal lock-down rate

0.2
0.18

0.16
0.16

0.1

nn==200,
4 additional
hotspot
200,dd==2,2,r r==0.2,
0.12,
4 additional
hotspot

c
0.2
0.2

0.22

Optimal lock-down rate

0.15

n =n 200,
d =d 2,
r =r 0.2,
no no
additional
hotspot
b0.2
= 200,
= 2,
= 0.12,
additional
hotspot

Optimal lock-down rate

SIS
SIR
COVID-19

Optimal lock-down rate

Optimal lock-down rate

SIS
SIR
COVID-19

n = 200, d = 2, r = 0.12, 4 additional hotspot

0.2

Optimal
Optimal lock-down
lock-down rate
e

a

n

0.18
SIS
SIR
COVID-19

0.16
0.14
0.12

n = 200, d = 2, r = 0.2, 4 additional hotspot

0.2

0.16
0.14
0.12
0.1

0

10

20

30

40

Degree

Fig. 4 Numerical results of optimal lockdown rates on synthetic networks. a, b, the impact of the degree centrality on
the geometric random graph. Each point represents a node in the network. It can be observed that centrality only matters
for the value of z∗l when there exist hotspots in all the three models. Without such hotspots, the effect of degree centrality
is essentially ignorable. c, the impact of population. Each point represents a node in the network. Nodes with small
populations are assigned smaller values of z∗l . Surprisingly, once the population is big enough, it doesn’t affect z∗l too
much. d, the impact of home-stay rate. Each point represents a node in the network. It can be observed that z∗l increases
as the home-stay rate increases, and in fact the home-stay rate has by far the largest influence on z∗l compared to the
other parameters we consider.

11

This manuscript is for review purposes only.

SIS
SIR
COVID-19

0.18

0

50

100

Degree

150

200

Author contributions. All authors designed and did the research. Q.M. performed all the calculations and
wrote the manuscript. Y.-Y.L and A.O. edited the manuscript.
Competing interests statement. The authors declare no competing interests.
REFERENCES
[1] D. Acemoglu, V. Chernozhukov, I. Werning, and M. D. Whinston. Optimal targeted lockdowns in a multi-group SIR model.
NBER Working paper, (27102), 2020.
[2] F. E. Alvarez, D. Argente, and F. Lippi. A simple planning problem for COVID-19 lockdown. CEPR Discussion Paper,
(DP14658), 2020.
[3] J. Arino and P. van den Driessche. A multi-city epidemic model. Mathematical Population Studies, 10(3):175–193, 2003.
[4] G. Aronsson and I. Mellander. A deterministic model in biomathematics. asymptotic behavior and threshold conditions. Mathematical Biosciences, 49(3):207–222, 1980.
[5] J. Bayham, N. V. Kuminoff, Q. Gunn, and E. P. Fenichel. Measured voluntary avoidance behaviour during the 2009 A/H1N1
epidemic. Proceedings of the Royal Society B: Biological Sciences, 282(1818):20150814, 2015.
[6] A. Berman and R. J. Plemmons. Nonnegative matrices in the mathematical sciences. SIAM, 1994.
[7] A. L. Bertozzi, E. Franco, G. Mohler, M. B. Short, and D. Sledge. The challenges of modeling and forecasting the spread of
COVID-19. Proceedings of the National Academy of Sciences, 117(29):16732–16738, 2020.
[8] J. R. Birge, O. Candogan, and Y. Feng. Controlling epidemic spread: Reducing economic losses with targeted closures. University of Chicago, Becker Friedman Institute for Economics Working Paper, (2020-57), 2020.
[9] T. Britton, F. Ball, and P. Trapman. A mathematical model reveals the influence of population heterogeneity on herd immunity
to SARS-CoV-2. Science, 369(6505):846–849, 2020.
[10] F. Bullo. Lectures on network systems. Kindle Direct Publishing, 2019.
[11] U. C. Bureau. Population – NYS & Counties. https://www.empirecenter.org/publications/population-new-york-and-u-s-nyscounties/, 2010.
[12] E. H. Bussell, C. E. Dangerfield, C. A. Gilligan, and N. J. Cunniffe. Applying optimal control theory to complex epidemiological
models to inform real-world disease management. Philosophical Transactions of the Royal Society B, 374(1776):20180284,
2019.
[13] P. R. Center. More than nine-in-ten people worldwide live in countries with travel restrictions amid COVID-19. https:
//www.pewresearch.org/fact- tank/2020/04/01/more- than- nine- in- ten- people- worldwide- live- in- countries- with- travelrestrictions-amid-\protect\protect\unhbox\voidb@x\hbox{COVID}-19/, 2020.
[14] M. Chinazzi, J. T. Davis, M. Ajelli, C. Gioannini, M. Litvinova, S. Merler, A. P. y Piontti, K. Mu, L. Rossi, K. Sun, et al. The
effect of travel restrictions on the spread of the 2019 novel coronavirus (COVID-19) outbreak. Science, 368(6489):395–400,
2020.
[15] M. B. Cohen, A. Madry, D. Tsipras, and A. Vladu. Matrix scaling and balancing via box constrained Newton’s method and
interior point methods. 1:902–913, 2017.
[16] CoronaBoard. Covid-19 dashboard. https://coronaboard.com/, 2020.
[17] O. Diekmann, J. A. P. Heesterbeek, and J. A. Metz. On the definition and the computation of the basic reproduction ratio R0 in
models for infectious diseases in heterogeneous populations. Journal of Mathematical Biology, 28(4):365–382, 1990.
[18] P. Fajgelbaum, A. Khandelwal, W. Kim, C. Mantovani, and E. Schaal. Optimal lockdown in a commuting network. CEPR
Discussion Papers, (14923), 2020.
[19] S. Flaxman, S. Mishra, A. Gandy, H. J. T. Unwin, T. A. Mellan, H. Coupland, C. Whittaker, H. Zhu, T. Berah, J. W. Eaton, et al.
Estimating the effects of non-pharmaceutical interventions on COVID-19 in Europe. Nature, 584(7820):257–261, 2020.
[20] J. N. Franklin. Matrix theory. Courier Corporation, 2012.
[21] F. R. Gantmacher. Applications of the Theory of Matrices. Courier Corporation, 2005.
[22] T. C. Germann, K. Kadau, I. M. Longini, and C. A. Macken. Mitigation strategies for pandemic influenza in the United States.
Proceedings of the National Academy of Sciences, 103(15):5935–5940, 2006.
[23] G. Giordano, F. Blanchini, R. Bruno, P. Colaneri, A. Di Filippo, A. Di Matteo, and M. Colaneri. Modelling the COVID-19
epidemic and implementation of population-wide interventions in Italy. Nature Medicine, 26(6):855–860, 2020.
[24] M. Gopal. Control systems: principles and design. Tata McGraw-Hill Education, 2002.
[25] H. Guo, M. Y. Li, and Z. Shuai. Global stability of the endemic equilibrium of multigroup SIR epidemic models. Canadian
Applied Mathematics Quarterly, 14(3):259–284, 2006.
[26] M. Guysinsky, B. Hasselblatt, and V. Rayskin. Differentiability of the hartman-grobman linearization. Discrete and Continuous
Dynamical Systems, 9(4):979–984, 2003.
[27] J. Heesterbeek and M. Roberts. The type-reproduction number T in models for infectious disease control. Mathematical
Biosciences, 206(1):3–10, 2007.
12

This manuscript is for review purposes only.

[28] A. Hortacsu, J. Liu, and T. Schwieg. Estimating the fraction of unreported infections in epidemics with a known epicenter: an
application to COVID-19. Journal of Econometrics, 2020.
[29] M. Idel. A review of matrix scaling and sinkhorn’s normal form for matrices and positive maps. arXiv preprint arXiv:1609.06349,
2016.
[30] A. Jambulapati, Y. T. Lee, J. Li, S. Padmanabhan, and K. Tian. Positive semidefinite programming: mixed, parallel, and widthindependent. Proceedings of the 52nd Annual ACM SIGACT Symposium on Theory of Computing, pages 789–802, 2020.
[31] J. H. U. (JHU). Covid-19 dashboard. https://coronavirus.jhu.edu/map.html, 2020.
[32] J. S. Jia, X. Lu, Y. Yuan, G. Xu, J. Jia, and N. A. Christakis. Population flow drives spatio-temporal distribution of COVID-19
in China. Nature, 582:389–394, 2020.
[33] B. Kalantari, L. Khachiyan, and A. Shokoufandeh. On the complexity of matrix balancing. SIAM Journal on Matrix Analysis
and Applications, 18(2):450–463, 1997.
[34] A. Khanafer, T. Basar, and B. Gharesifard. Stability of epidemic models over directed graphs: A positive systems approach.
Automatica, 74:126–134, 2016.
[35] S. M. Kissler, J. R. Fauver, C. Mack, C. Tai, K. Y. Shiue, C. C. Kalinich, S. Jednak, I. M. Ott, C. B. Vogels, J. Wohlgemuth,
J. Weisberger, J. DiFiori, D. J. Anderson, J. Mancell, D. D. Ho, N. D. Grubaugh, and Y. H. Grad. Viral dynamics of
sars-cov-2 infection and the predictive value of repeat testing. medRxiv, 2020.
[36] A. Lajmanovich and J. A. Yorke. A deterministic model for gonorrhea in a nonhomogeneous population. Mathematical Biosciences, 28(3-4):221–236, 1976.
[37] W. S. Levine. The control handbook. CRC press, 1996.
[38] J. Löfberg. Yalmip : A toolbox for modeling and optimization in matlab. In In Proceedings of the CACSD Conference, Taipei,
Taiwan, 2004.
[39] I. M. Longini Jr. A mathematical model for predicting the geographic spread of new infectious agents. Mathematical Biosciences,
90(1-2):367–383, 1988.
[40] W. Mei, S. Mohagheghi, S. Zampieri, and F. Bullo. On the dynamics of deterministic epidemic propagation over networks.
Annual Reviews in Control, 44:116–128, 2017.
[41] H. Nishiura, T. Kobayashi, T. Miyama, A. Suzuki, S.-m. Jung, K. Hayashi, R. Kinoshita, Y. Yang, B. Yuan, A. R. Akhmetzhanov,
et al. Estimation of the asymptomatic ratio of novel coronavirus infections (COVID-19). International Journal of Infectious
Diseases, 94:154–155, 2020.
[42] C. Nowzari, V. M. Preciado, and G. J. Pappas. Analysis and control of epidemics: A survey of spreading processes on complex
networks. IEEE Control Systems Magazine, 36(1):26–46, 2016.
[43] C. Nowzari, V. M. Preciado, and G. J. Pappas. Optimal resource allocation for control of networked epidemic models. IEEE
Transactions on Control of Network Systems, 4(2):159–169, 2017.
[44] U. B. of Labor Statistics. Employment situation summary. https://lehd.ces.census.gov/data/, 2020.
[45] K. Ogata and Y. Yang. Modern control engineering, volume 4. Prentice hall India, 2002.
[46] A. Pan, L. Liu, C. Wang, H. Guo, X. Hao, Q. Wang, J. Huang, N. He, H. Yu, X. Lin, et al. Association of public health
interventions with the epidemiology of the COVID-19 outbreak in Wuhan, China. Jama, 323(19):1915–1923, 2020.
[47] V. Y. Pan and Z. Q. Chen. The complexity of the matrix eigenproblem. Proceedings of the thirty-first annual ACM symposium
on Theory of computing, pages 507–516, 1999.
[48] P. E. Pare. Virus spread over networks: Modeling, analysis, and control. PhD thesis, University of Illinois at Urbana-Champaign,
2018.
[49] V. M. Preciado, M. Zargham, C. Enyioha, A. Jadbabaie, and G. J. Pappas. Optimal resource allocation for network protection
against spreading processes. IEEE Transactions on Control of Network Systems, 1(1):99–108, 2014.
[50] V. M. Preciado, M. Zargham, C. Enyioha, A. Jadbabaie, and G. J. Pappas. Optimal resource allocation for network protection
against spreading processes. IEEE Transactions on Control of Network Systems, 1(1):99–108, 2014.
[51] A. Rantzer. Distributed control of positive systems. Proceedings of the 50th IEEE Conference on Decision and Control and
European Control Conference, pages 6608–6611, 2011.
[52] B. R. Rowthorn and F. Toxvaerd. The optimal control of infectious diseases via prevention and treatment. CEPR Discussion
Paper, 2012.
[53] R. E. Rowthorn, R. Laxminarayan, and C. A. Gilligan. Optimal control of epidemics in metapopulations. Journal of the Royal
Society Interface, 6(41):1135–1144, 2009.
[54] SafeGraph. Social Distancing Metrics. https://docs.safegraph.com/docs/social-distancing-metrics, 2020.
[55] L. Sattenspiel, K. Dietz, et al. A structured epidemic model incorporating geographic mobility among regions. Mathematical
biosciences, 128(1):71–92, 1995.
[56] R. Sinkhorn and P. Knopp. Concerning nonnegative matrices and doubly stochastic matrices. Pacific Journal of Mathematics,
21(2):343–348, 1967.
[57] N. Y. State. New York State Statewide COVID-19 Testing. https://health.data.ny.gov/Health/New- York- State- StatewideCOVID-19-Testing/xdss-u53e, 2010.
[58] N. Y. Times. Coronavirus (Covid-19) Data in the United States. https://github.com/nytimes/covid-19-data, 2020.
13

This manuscript is for review purposes only.

[59] T. N. Y. Times. COVID-19 live updates: U.s. hospitalizations top 61,000, a record. https://www.nytimes.com/live/2020/
11/10/world/covid-19-coronavirus-live-updates?type=styln-live-updates&label=virus&index=0&action=click&module=
Spotlight&pgtype=Homepage#research- using- spring- cellphone- data- in- 10- us- cities- could- help- influence- officialsfacing-rising-cases-and-possible-restriction/, 2020.
[60] C. Viboud, O. N. Bjørnstad, D. L. Smith, L. Simonsen, M. A. Miller, and B. T. Grenfell. Synchrony, waves, and spatial
hierarchies in the spread of influenza. Science, 312(5772):447–451, 2006.

14

This manuscript is for review purposes only.

OPTIMAL LOCKDOWN FOR PANDEMIC CONTROL
—SUPPLEMENTARY INFORMATION—
QIANQIAN MA1 , YANG-YU LIU2 , and ALEX OLSHEVSKY 3

1. Related work. Our work is related to a number of recent papers motivated by the spread COVID19, as well as some older work. Indeed, spatial spread of epidemic admits a natural network representation,
where nodes represent different locations and edges encode traveling of residents between the locations.
Such spatial epidemic network model has received attention in the studies of COVID-19 recently [32, 14].
Our paper builds on the results of [8], which proposed a spatial epidemic transmission model and consider
the effect of lockdowns; we use the same model of lockdown of [8] in this work. The major difference
between this work in [8] is two-fold. First, we do not consider asymptotic stability in a model with births
and deaths as our focus is on a shorter scale. Second, we propose new algorithms with improved running
times; in particular, our main contribution is a linear time method that is applicable to the vast majority of
cases we have considered. Similarly, the main difference of this work relative to [42] and the references
therein are new algorithms (though the lockdown models differ somewhat), as well as the new observations
on counter-intuitive phenemena satisfied by the optimal lockdown.
Our work has some similarities with the recent paper [9], which proposed a new epidemic transmission
model based on the SEIR model. By dividing the population into 18 compartments depending on the six age
groups and three activity levels, [9] found that population heterogeneity could significantly impact diseaseinduced her immunity. In spirit, this is similar to what we study, except that when nodes represent locations
rather than cohorts and activity levels, the number of compartments becomes large and efficient algorithms
become critical; further, the problem of lockdown begins to make sense, whereas it would be impossible to
create a lockdown that applied arbitrarily different policies to people who started out with different activity
levels.
An alternative approach to the problem of optimal lockdown design was taken in [52, 1, 18, 2] which
studied non-uniform lockdowns in the framework of optimal control. These papers assumed a cost of a
human life lost (sometimes set based on the average lifetime earnings) and considered the discounted total
cost over the entire epidemic (alternatively, [1] considered the frontier of possible strategies over all possible
ways to value life). This framework is conceptually different from ours: when modified to fit into our
framework, strategies derived in this way will begin to relax the lockdown once the epidemic drops below a
certain threshold as the number of lives lost comes to balance the cost of the lockdown, ultimately driving
the epidemic to an endemic state; by contrast, our framework is designed to send the number of infections
to zero. Furthermore, the main advantage of our approach is scalability. For example, solving for the
solution of this nonlinear optimal control problem as in [18] requires an iterative method with each step
requiring the numerical solution of a partial differential equation, a matrix inversion, and a maximization
of the Hamiltonian, without any a-priori bounds on the total number of steps the procedure will take. In
general, solving nonlinear optimal control problems can be quite difficult, and one cannot hope to come
close to the linear-time scaling achieved in this paper.
Scalability is particularly important for shutdown design since infections flow from one neighborhood
1 Department

of Electrical and Computer Engineering, Boston University, Boston, MA USA
Division of Network Medicine, Department of Medicine, Brigham and Women’s Hospital, Harvard Medical School,
Boston, MA 02115, USA
3 Department of Electrical and Computer Engineering and Division of Systems Engineering, Boston University, Boston, MA USA
2 Channing

15

This manuscript is for review purposes only.

to the next. While from the point of view of network science it is fruitful to consider small and medium
sized examples – indeed, we spend considerable space in this work discussing a two-node model of city and
suburb – the ultimate goal is for these algorithms to give real-world guidelines. Best practice would be to
consider isolated regions (e.g., countries) together rather than separating them into smaller regions, making
scalability critical.
2. Mathematical Background. The supplementary information will provide the proofs of the main
results of the paper, as well as give details of many of our empirical and numerical results that were summarized in the main text. We begin with some definitions.
A matrix is called continuous time stable if all of its eigenvalues have nonpositive real parts. A matrix
is called discrete time stable if all of its eigenvalues are upper bounded by one in magnitude. A central
concern of this paper is to get certain quantities of interest (e.g., number of infected individuals) to decay at
prescribed exponential rates. We will say that y(t) decays at rate α beginning at t0 if y(t) ≤ y(t0 )e−αt for all
t ≥ t0 . Note that the decay in this definition is not asymptotic but results in a decrease starting at time t0 .
We will associate to every matrix A ∈ Rn×n the graph G(A) corresponding to its nonzero entries: the
vertex set of G(A) will be {1, . . . , n} while (i, j) ∈ G(A) if and only if A ji , 0. Informally, (i, j) is an edge in
G(A) when the variable j “is influenced by” variable i. We will say that A is strongly or weakly connected if
the graph G(A) has this property.
2.1. Covering Semi-definite Program. A covering semi-definite program has the form
min

d
X

ci xi

i=1
d
X

xiCi ≥ I

i=1

x ≥ 0.
Here ci are nonnegative scalars and Ci are positive semi-definite matrices. It turns out that covering semidefinite programs can be solved considerably faster than general semi-definite programs. Indeed, the recent
paper
 [30] showed that
 to compute a fixed-accuracy additive approximation of the optimal solution takes
e nω + Pdi=1 nnz(Ci ) , where ω is the exponent of matrix multiplication.
O
With these preliminaries in place, we next turn to justifying the analytical claims made in the main body
of the paper.
2.2. Matrix Balancing. The matrix balancing problems plays a fundamental role in our main results,
and we briefly introduce it here. Given a nonnegative matrix P ∈ Rn×n , we say it is balanced if it has identical
row and column sums. The matrix balancing problem is, given a nonnegative P, to find a nonnegative
diagonal matrix D such that DPD−1 is balanced.
The problem of matrix balancing is quite old; for example, an asymmetric version of this problem was
introduced in the classic work of Sinkhorn and Knopp in the 1960s [56]. It is impossible to survey all the
literature on matrix balancing and related problems, though we refer the reader to [29]. Recently, a powerful
algorithm for matrix balancing was given in [15]. It was shown in that work that this problem can be solved
in linear time, understood as follows: solving the problem to accuracy  requires only Õ(nnz(P) log κ log  −1 )
where nnz(P) is the number of nonzero entries in the matrix A, κ = D∗max /D∗min is the imbalance of the optimal
e hides logarithmic factors. Thus matrix balancing problems can be solved in nearly the
solution, and the O
same time as it takes to simply read the data, provided κ is bounded away from zero.
16

This manuscript is for review purposes only.

We will summarize this complexity by saying that the running time “explicitly scales nearly linearly in
the number of nonzero entries.” The “nearly” comes from the logarithmic terms; the word “explicit” comes
because the scaling also depends on the imbalance of the optimal lockdown κ, and one can construct families
of examples where the κ will have some kind of scaling with network size.
3. Analytical calculations. In this section, we first present the details of the SIS model [50] as well
as how the matrix A is constructed. Next, we justify the main theoretical achieved via eigenvalue bounds;
that optimal lockdown for these models can be reduced to a covering semi-definite program (which can be
solved in matrix multiplication time); and that, under the high spread condition, optimal lockdown for these
models reduces to a matrix balancing problem (which can be solved in linear time).

3.1. Network SIS model. is described by the following set of ordinary differential equations

(3.1)

ẋi = (1 − xi )

n
X

βai j x j − γxi , i = 1, . . . , n.

j=1

Here β denotes the transmission rate, which captures the rate at which an infected individual infects others,
γ denotes the recovery rate, and ai j captures the rate at which infection flows from the population at location
j to location i. Because ẋi scales with 1 − xi , the SIS model assumes that everyone who is not infected is
susceptible.
For simplicity of notation, we can stack up the coefficients ai j into a matrix as as A = [ai j ]. Then we
can write the network SIS model as
ẋ = diag(1 − x)βAx − γx,
where 1 denotes the vector of all-ones while diag(u) makes a diagonal matrix out of the vector u.
It is desirable to have xi (t) → 0 for all i = 1, . . . , n, i.e., to have the infection die out. It is mathematically
convenient to encode this into the following equivalent condition: we will require that there exists some
linear combination of the quantities xi (t) with positive coefficients which approaches zero, which happens if
and only if the matrix βA − γI is continuous-time stable [36, 4, 25, 34, 40]. To achieve an exponential decay
rate α of each xi (t), we require that there exists a positive linear combination of xi (t) decaying at that rate,
which is guaranteed if λmax (βA − γI) ≤ α (see formal proof in SI Sec. 3). Note that even though the network
SIS dynamics is nonlinear, the asymptotic convergence nevertheless reduces to a linear eigenvalue problem.
3.2. Construction of the matrix A. We next describe how the matrix A is constructed. Our discussion
will only be for the SIS case, as the COVID-19 case is similar.
Observe that the susceptible individuals at location i can be infected at location i as well as in other
locations, the flow of susceptible population from location i to location l is (1 − xi )τil . Besides, the rate of
infection at location i is proportional to the fraction of infected people in the total population of location i.
Then we can rewrite the SIS model as
(3.2)

Pn
n
X
j=1 N j τ jl x j
β − γxi .
ẋi =
(1 − xi )τil Pn
k=1 Nk τkl
l=1
17

This manuscript is for review purposes only.

Let m(l) =

Pn
k=1

Nk τkl , then (3.2) can be written as
ẋi =

n
X

Pn
j=1

(1 − xi )τil

m(l)

l=1

= (1 − xi )
= (1 − xi )

N j τ jl x j

β − γxi

n X
n
X
N j τil τ jl x j
β − γxi
m(l)
l=1 j=1
n
X

ai j βx j − γxi ,

j=1

where
(3.3)

ai j =

n
n
X
N j τil τ jl X
Nj
Pn
=
τil τ jl .
m(l)
k=1 Nk τkl
l=1
l=1

As already remarked, this approach is not original to our work and is taken from [8]. Note that in COVID-19
case, via similar process, we can obtain the same ai j as in Eq. (3.3).
3.3. Stability of the network SIS and COVID-19 models. Recall that the network SIS model is given
by the system of equations
(3.4)

ẋi = (1 − xi )

n
X

βai j x j − γxi , i = 1, . . . , n,

j=1

where n is the number of nodes in the underlying graph and xi (t) is the proportion of infected individuals at
node i. By contrast, the network COVID-19 model is given by

 


 ṡ   0
−βa diag(s)A
−βs diag(s)A   s 
 x˙a  =  0 βa diag(s)A − ( + ra ) βs diag(s)A   xa  ,
(3.5)
 s  
  s 
ẋ
0

−rs
x
where now xia , xis are the proportion of infected/asymptomatic and infected/symptomatic individuals at node
i. This is a system of 3n equations, with three equations per node of the network. Recall also the notation
M(t) used to denote the bottom 2n × 2n submatrix of the above matrix. In the main text, we stated that
stability and decay rate of the network SIS model is equivalent to the eigenvalues of the matrix A − γI, while
the stability of the network COVID-19 model can be ensured by bounding the eigenvalues of M(t). We next
give a pair of propositions formally justifying these assertions.
Proposition 3.1. Suppose the matrix A is strongly connected. If λmax (βA − γI) ≤ −α, then for the
network SIS dynamics of Eq. (3.4), there exists a positive linear combination of the quantities xi (t) that
decays to zero at rate α starting at any time t0 . Conversely, if λmax (βA − γI) > −α, then there exists an initial
condition in x(0) > 0 so that every positive linear combination of the quantites xi (t) fails to decay at rate α.
Proposition 3.2. Suppose the matrix A is strongly connected, and s(t0 ) > 0. If λmax (M(t0 )) ≤ −α, then
there exists a positive linear combination of the quantities xia (t), di (t) which decays at rate α starting at time
t0 .
The idea behind these propositions is standard in control theory: to get your system to decay at a rate of
e−αt , make sure your eigenvalues have real parts that are at most −α. For linear systems, this is guaranteed to
18

This manuscript is for review purposes only.

work after a transient time, and for nonlinear systems, the situation is complicated. Fortunately, the nonlinear
systems corresponding to network SIS and COVID dynamics have favorable properties, so that it is possible
to draw conclusions about global behavior from the eigenvalues of a linear approximation at a point.
To get each of the quantities xia (t), xis (t) to converge to zero at an asymptotic rate of e−αt , it suffices to
have an arbitrary positive combination of them decay at rate α. Interestingly, for the SIS case, this happens
if and only if an eigenvalue condition is satisfied. In the COVID-19 case, the eigenvalue condition merely
suffices to establish this.
We now turn to the proof of these propositions. Our first step is to restate the Perron-Frobenius theorem
in a form that will be particularly useful to us.
Lemma 3.3 (A Version of Perron-Frobenius). Let us suppose P is a strongly connected matrix whose
off-diagonal elements are nonnegative. Then there exists a real eigenvalue of P which is as large as the
real part of any other eigenvalue of P. This eigenvalue is simple and the eigenvector corresponding to it is
positive.
This lemma follows by observing that A + αI is nonnegative for a large enough choice of α, so we can
apply the Perron-Frobenius theorem (in the form of Theorem 2 in Section 8.2 of [21]) to A + αI.
Definition 3.4. We will use λmax (P) and vmax (P) to denote the eigenvalue/eigenvector described in
Lemma 3.3.
We next give a proof of Proposition 3.1.
Proof of Proposition 3.1. Suppose P = βA − (γ − α)I. Let λmax (P) and vmax (P) be the corresponding
eigenvalue/eigenvector pair. Note that, by our assumptions, λmax ≤ 0. We thus have that


d >
vmax x = v>max diag(1 − x)βAx − γx
dt


≤ v>max βAx − γx


= v>max βAx − γx + αI x − v>max αx
= λmax v>max x − αv>max x
≤ −αv>max x
where the second line used that β, vmax , A, x are nonnegative while 1 − x ∈ [0, 1]n ; and the last line used that
λmax ≤ 0. We conclude that v>max x decays at a rate of α starting at any time.
On the other hand, suppose λmax (βA − γI) > −α. Observe that the linearization of Eq. (3.1) around the
origin is ẋ = (βA − γI)x. Let us write the Jordan normal form,

βA − γI = T diag(λ1 , . . . , λn ) + J T −1 ,
where J is the upper-triangular matrix λ1 , . . . , λn are the eigenvalues of βA − γI, with λ1 being the PerronFrobenius eigenvalue. Because the Perron Frobenius argument is simple, we have that the top Jordan block
is 1 × 1; so that J and all of its powers have zero entries in the first row. Using the standard formula for the
matrix exponential of a Jordan block, we next decompose as


et(βA−γI) = T diag(eλ1 t , eλ2 t , . . . , eλn t ) (I + Ut ) T −1 ,
where Ut is an upper triangular matrix, depending on t, but having only zero entries in its first row. We now
choose the initial condition x0 = lT e1 , where e1 is the first basis vector, and l is a small-enough positive
19

This manuscript is for review purposes only.

scalar; we’ll discuss how small l has to be later. We then have T −1 x0 = le1 and therefore under the flow
ẋ = βA − γI it holds that
1/t
λ1 t
lim sup ||x(t)||1/t
2 = lim sup ||T e le1 ||2
t→∞

t→∞

= λ1
> −α,

(3.6)

This establishes the property we want for the flow of the linear system ẋ = (βA − γI)x, but we need
to establish that the network SIS dynamics has the same property. This can be done via a particular form
of the Hartman-Grobman theorem. Indeed, let y(t) be the network SIS trajectory starting from y0 . The
Harman-Grobman theorem, in the form of Theorem 3 of [26], guarantees the existence of a homeomorphism
h : Rn → Rn such that
y(t) = h−1 (et(βA−γI) h(y0 )),
and, as proved in [26], because the network SIS dynamics are infinitely differentiable, we can further take h
to be differentiable at the origin with the derivative at the origin equalling identity:
h(y) = y + o(||y||2 ).
This implies that
y = h−1 (y) + o(||y||2 ),
which we rearrange as
h−1 (y) = y + o(||y||2 )

(3.7)
Morever, for small enough ||x||2 , we have

1
||x||2 ≤ ||h(x)||2 ≤ 2||x||2 .
2
This further implies that for small enough ||x||2 ,
1
||x||2 ≤ ||h−1 (x)||2 ≤ 2||x||2 .
2
With these observations in mind, we now choose the initial condition y0 = h−1 (x0 ), where x0 = lT e1 as
above. We then have that
−1 t(βA−γI)
lim sup ||y(t)||1/t
h(y0 )||1/t
2 = lim sup ||h (e
2
t→∞

t→∞

≥ lim sup (1/2)1/t ||et(βA−γI) x0 ||1/t
2
> −α,

t→∞

appealing in the last step to Eq. (3.6).
We conclude the proof by arguing that our initial condition y0 is nonnegative provided we choose l small
enough. Indeed, we first argue that T e1 is strictly positive. Indeed, observe that this is the first column of T ,
and since βA − γI = T DT −1 can be rewritten as (βA − γI)T = T D, we obtain that the first column of T is
the Perron-Frobenius eigenvector of A, which is positive by Lemma 3.3. Finally,
√
y0 = h−1 (lT e1 ) = lT e1 + o(l||T ||2 n) = lT e1 + o(l),
by Eq. (3.7); and for small enough l, this has to be strictly positive by strict positivity of T e1 . This concludes
the proof.
20

This manuscript is for review purposes only.

We next give the proof of Proposition 3.2. Since, unlike in the SIS case, only one direction must be
proven, the proof is straightforward.
Proof of Proposition 3.2. By Lemma 3.3, the matrix M(t0 ) has a left-eigenvector vmax which is positive.
Let λmax be the corresponding eigenvalue; by assumption λmax ≤ −α. Let us define p(t) = [x(t), d(t)]> ,
where x(t) stacks up all the xi (t), and likewise for d(t). Since it is immediate that the dynamics of Eq. (2.1)
result in s(t) non-increasing, we have that
d >
v p(t) = v>max M(t)p(t)
dt max
≤ v>max M(t0 ))p(t)
= λmax v>max p(t)
≤ −αv>max p(t)
where the second equation uses that vmax and p(t) are nonnegative, and as a consequence of the nonincreasing of s(t), v>max M(t)p(t) ≤ v>max M(t0 )p(t); while the final equation used λmax ≤ −α. We conclude
that v>max p(t) decreases at rate α starting from any time.
3.4. Lockdown design. We now turn to the algorithmic question of designing an optimal lockdown.
We will first present our main results. Next we will present a string of lemmas and observations which will
culminate in the proof of the main Theorem. It is here that we will perform the reduction from the problem
of computing the optimal lockdown to matrix balancing and covering semi-definite programs.
Our first step is to discuss an assumption required by one of our algorithms. The formal statement of
the assumption is as follows.
Assumption 3.5 (High spread assumption).
1. In the network SIS model, we have diag(B>C) ≥ γ
2. In the network COVID-19 model, we must have


βa + βs s B> diag(s(t0 ))C ≥  + ra .
r
To see why this condition is satisfied in a “high spread” regime, note that A = CB> and, given our
choices of C and B in Eq. (2.4), the entry Cii Bii corresponds to the spread of the epidemic in location i
purely from the same-location trips of residents of location i. This has to be bigger than the natural rate
γ at which people recover. In other words, the natural rate of spreading of the epidemic has to be high
everywhere. Assumption 3.5 is actually somewhat looser than this, as what must be bounded below by γ is
diag(B>C), which is a sum of O(n) products, only one of which is Cii Bii . Note that this is not quite the same
as requiring that Aii ≥ γ since A +CB> , and we’ve flipped the order of multiplication on the condition. In the
COVID-19 case, the interpretation is similar: the recovery rates ra , rs need to be small relative to si (t0 )Cii Bii
as well as the spread parameters βa , βs , , though the relation is now more involved.
Main theoretical contribution. Our main theorem provides algorithms for the unconstrained and constrained lockdown problems in the cases when Assumption 3.5 does and does not hold. Our key contribution
is to give an algorithm for optimal stabilizing lockdown whose complexity has an explicit scaling which is
nearly linear in the number of nonzero entries of the matrix A. That is to say, not only can the optimal heterogeneous lockdown be computed exactly, but doing so takes nearly as much time as just reading through
the data.
21

This manuscript is for review purposes only.

Theorem 3.6. Suppose the graph corresponding to positive entries of the matrix A is strongly connected
and s(t0 ) > 0. Then:
1. The unconstrained lockdown problem for both SIS and COVID-19 models can be reduced to matrix
balancing.
2. Suppose further Assumption 3.5 holds. Then the constrained lockdown problem is equivalent to the
unconstrained lockdown problem and consequently is also reducible to matrix balancing.
3. If Assumption 3.5 does not hold but the matrices C and B are given by Eq. (2.4) and τ is strongly
connected with positive diagonal, then the constrained lockdown problem for the SIS, SIR, COVIDe 3 ) time, where O(·)
e hides factors which are logarithmic in the
19 models can be solved in O(n
remaining problem parameters.
Next, we will prove Theorem 3.6. Our starting point will be the following lemma on a “splitting” of a
positive matrix.
Lemma 3.7.
1. A strongly connected matrix P with non-negative off-diagonal elements is continuous-time stable if
and only if there exists d > 0 such that Pd ≤ 0.
2. The nonnegative strongly connected matrix B is discrete-time stable if and only if there exists d > 0
such that Bd ≤ d.
3. Suppose P = L − D where L is nonnegative while D is a matrix with nonpositive off-diagonal
elements whose inverse is elementwise nonnegative. Suppose further that both P and D−1 L are
both strongly connected. Then P is continuous time stable if and only if B = D−1 L is discrete-time
stable.
This lemma is a small variation on a well-known fact: usually, parts 1 and 2 are stated for strictly stable
matrices, in which case all the inequalities need to be strict (see [10], Theorem 15.17 for the strict version of
part (i) and Proposition 1 of [51] for the strict version of part (ii)). The non-strict version additionally requires
that the matrices be strongly connected, which is not needed for the nonstrict version of this problem. Note
that we do not claim that any part of this lemma is novel. For completeness, we nevertheless give a proof
next.
Proof of Lemma 3.7. For part (1), observe that Pd ≤ 0 if the same as Pdiag(d)1 ≤ 0, which is equivalent
to diag(d)−1 Pdiag(d) being a matrix with nonpositive row sums. Since we have assumed that P has nonnegative off-diagonal elements, this implies that the diagonal elements of diag(d)−1 Pdiag(d) are non-positive. By
Gershgorin circles, diag(d)−1 Pdiag(d) must be continuous-time stable. Since its eigenvalues are the same as
the eigenvalues of P, we conclude that P is also continuous-time stable. Similarly, for part (2), if such a d
exists, then diag(d)−1 Bdiag(d) is a nonnegative matrix whose row sums are upper bounded by one, and must
be discrete-time stable again by Gershgorin circles. This proves the “if” part of parts (1) and (2).
For the “only if” parts, suppose P is continuous-time stable and strongly connected with non-negative
off-diagonal entries. By Lemma 3.3, we have that there exists a positive vector d such that Pd = λd and
λ ≤ 0; this proves the “only if” of part 1. For part 2, if B is discrete-time stable and strongly connected,
we have that Bd = λd for the Perron-Frobenius eigenvalue d of P, which is positive. Since now λ < 1, this
proves the “only if” statement of part 2.
For part (3), suppose first that P = L − D is continuous-time stable. Since P = L − D has nonnegative
off-diagonal elements, we can apply part (1) to observe that continuous time stability of P is equivalent to
existence of d satisfying
(L − D)d ≤ 0, d > 0
22

This manuscript is for review purposes only.

which is equivalent to
Ld ≤ Dd, d > 0.
We now to multiply both sides by D

−1

and obtain that there exists a d satisfying
D−1 Ld ≤ d, d > 0.

Note that we used that D−1 is nonnegative to multiply both sides by D−1 . Since D−1 L is strongly connected,
the last equation is, by part (2), exactly the statement that B = D−1 L is discrete-time stable.
Conversely, suppose D−1 L is discrete-time stable (note that we cannot simply reverse the above chain
of implications since we do not assume that D is elementwise nonnegative; thus we can multiply a linear inequality by D−1 but not necessarily by D). Let λmax , vmax denote the Perron-Frobenius eigenvalue/eigenvector
pair of D−1 L, guaranteed to exist by Lemma 3.3; note that vmax is strictly positive. We then have
Lvmax = DD−1 Lvmax
= Dλmax vmax
≤ Dvmax ,
where the last step used that λmax ≤ 1. It follows that Pvmax = (L − D)vmax ≤ 0, and since, as already
observed, vmax is positive, we obtain that P is continuous-time stable by applying part (1).
We will later need to interchange the order of products while still preserving the condition of being
strongly connected. To that end, the following lemma will be useful.
Lemma 3.8. Suppose U, V are two nonnegative n × n matrices with no zero rows or columns such that
VU is strongly connected. Then UV is strongly connected.
Proof. Consider a directed bipartite graph G on 2n vertices, with vertices l1 , . . . , ln and r1 , . . . , rn denoting the two sides of the bipartition, defined as follows. If Ui j > 0, then we put an edge from l j to ri ; and if
Vi j > 0 we put an edge from r j to li . Let G1 be the graph on l1 , . . . , ln where we put the directed edge from
li to l j if there is a path of length two from li to l j in G. Likewise, let G2 be the directed graph on r1 , . . . , rn
such that we put an edge from ri to r j whenever there is a path of length two in G.
Then the strong connectivity of VU is equivalent to having G1 be strongly connected: indeed, (VU)ab >
0 if and only if there exists a link from b to a in G1 . Similarly, the strong connectivity of UV is equivalent
to having G2 be strongly connected. We will show that if G1 is not strongly connected, neither is G2 . The
converse is established via a similar argument.
Indeed, suppose G1 is not strongly connected. That means there exists a proper subset of the vertices,
say L1 = {l1 , . . . , lk }, with no edges outgoing to L1c = {lk+1 , . . . , ln }. Let r1 be the set of out-neighbors of L1 in
G. Then we must have that r1 is a proper subset of {r1 , . . . , rn } (for otherwise, the assumption that V has no
zero rows/columns would contradict no edges going from L1 to L1c in G1 ) and the set of out-neighbors of r1
in G is contained in L1 .
But since (i) r1 is a proper subset of the right-hand side (ii) the out-neighbors of r1 in G are contained
in L1 (iii) the out-neighbors of L1 in G are contained in r1 , we obtain that there are no edges leading from r1
to r1c in G2 . This proves G2 is not strongly connected.
With these preliminary lemmas in place, we now turn to core of our reduction. We begin with the
network SIS dynamics, where we will reduce the task of finding an (unconstrained) optimal lockdown to the
problem of matrix balancing defined earlier. The reduction will go through several “intermediate” problems,
the first of which as follows.
23

This manuscript is for review purposes only.

Definition 3.9. We will refer to the following as the stability scaling problem: given a nonnegative
strongly connected matrix P and positive diagonal matrix D, find positive scalars q1 , . . . , qn minimizing
Pn −1
i=1 qi such that diag(q1 , . . . , qn )P − D is continuous-time stable.
The utility of this definition should become clear after the following lemma.
Lemma 3.10. Suppose A = CB> is strongly connected. The minimum cost lockdown problem for the SIS
network can be written as stability scaling. Under Assumption 3.5, the constrained lockdown problem for
the network SIS problem can also be written as stability scaling.
Proof. We consider the unconstrained lockdown problem first. Recall that, in the SIS model, we are
looking for a minimum cost positive vector z such that
Cdiag(z)B> − (γ − α)I

(3.8)

is continuous-time stable. Since the nonzero eigenvalues of a product of two matrices do not change after
we change the order in which we multiply them, this is the same as requiring that
diag(z)B>C − (γ − α)I
is continuous-time stable. This is exactly the stability scaling problem provided we have two additional
conditions. The first condition is that α < γ (because the diagonal matrix subtracted needs to be positive).
The second condition is that B>C should be strongly connected. But by Lemma 3.8, the second condition is
true because we assumed that A = CB> is strongly connected.
Observe that the reduction resulted in an instance of stability scaling with matrix P = B>C. Since
we have assumed A = CB> is strongly connected, we can apply Lemma 3.8 to obtain that P is strongly
connected as needed. Under the assumption α < γ, the matrix (γ − α)I is a positive diagonal matrix as
required.
We thus have the reduction we want, from optimal lockdown to stability scaling, assuming α < γ. But
what if α ≥ λ? In that case, we claim that the minimum cost lockdown problem does not have a solution.
Indeed, since at the optimal solution we must have all z∗i > 0, we have that Cdiag(z∗ )B> is an irreducible
nonnegative matrix and its Perron-Frobenius eigenvalue is strictly positive by the Perron-Frobenius theorem
[21]. Consequently, Cdiag(z∗ )B> − (γ − α)I has a positive eigenvalue and cannot be continuous-time stable.
Finally, we consider the constrained version. We argue that, under Assumption 3.5, the optimal solution
to the constrained lockdown problem will have z∗i ≤ 1 for all i, so we can simply drop the constraint. Indeed,
first observe that we can assume α ≤ γ, else the problem does not have a solution as explained above. Now
suppose that z∗j > 1; then diag(z∗ )B>C − diag(γ − α)I has a nonnegative j’th row with at least one positive
entry in that row. Indeed, the off-diagonal entries in the j’th row are clearly nonnegative, while the diagonal
entry is nonnegative by Assumption 3.5.
By Lemma 3.7, diag(z∗ )B>C − diag(γ − α)I cannot be continuous-time stable. As matrix Cdiag(z)B> −
(γ − α)I has the same nonzero eigenvalues as the matrix diag(z∗ )B>C − diag(γ − α)I, it can not be stable
either.
Lemma 3.11. In the unconstrained case, the minimum lockdown model for COVID-19 dynamics can be
reduced to stability scaling provided A is strongly connected and s(t0 ) > 0. In the constrained case, the same
holds under Assumption 3.5.
Proof. Let us begin by assuming that
(3.9)

α < min(rs ,  + ra ).
24

This manuscript is for review purposes only.

We will revisit this assumption later. We need to make the matrix
A0 :=

βa diag(s(t0 ))Az − ( + ra ) + α


βs diag(s(t0 ))Az
−rs + α

!

stable, where we have introduced the notation that Az = Cdiag(z)B> . Let us write
A0 = L − D,
where
L=

βa diag(s(t0 ))Az
0

and
D=

!
βs diag(s(t0 ))Az
,
0

!
 + ra − α
0
.
−
rs − α

We next apply part 3 of Lemma 3.7 to get that A0 is continuous-time stable if and only if D−1 L is discrete
time stable. To do this, however, we need to verify that D−1 is elementwise nonnegative, and that both P and
D−1 L are strongly connected. This easily follows from observing that
!
1
0
a −α
−1
+r
D =
1

(+ra −α)(rs −α)
rs −α ,
and recalling that s(t0 ) > 0 as well as Eq. (3.9).
To summarize, we have shown that equivalently we need to make sure that B = D−1 L is discrete-time
stable. Since the eigenvalues of a matrix which is the product of two matrices do not change after changing
the order of the product, this is the same as having LD−1 be discrete-time stable. But we have the simple
expression
!
s
diag(s(t0 ))Az b1 rsβ−α diag(s(t0 ))Az
−1
LD =
,
0
0
β +β (r −α)
where b1 = (+r
a −α)(r s −α) .
But the eigenvalues of LD−1 are just the eigenvalues of its top n × n block. Thus we obtain that LD−1 is
stable if and only if the matrix diag(s(t0 ))Ab1 is discrete-time stable. Plugging in A = Cdiag(z)B> , we now
need that
diag(s(t0 ))Cdiag(z)B> b1 is discrete-time stable.
s

a

s

We next appear to part (3) of Lemma 3.7 again, using D = diag(s(t0 ))−1 b−1 I to obtain that we need
(3.10)

Cdiag(z)B> − diag(s(t0 ))−1 b−1
1 I is continuous-time stable,

We can apply part (3) of Lemma 3.7 as strong connectivity follows from z being elementwise positive and
strong connectivity of A = CB> . But the last condition is equivalent to Equation (3.8), which we’ve already
shown how to reduce to stability scaling.
We conclude the reduction by observing that, once again, this results in an instance of stability scaling
with the matrix P = B>C, which is strongly connected because A = CB> is strongly connected, allowing us to apply Lemma 3.8. Further, the matrix diag(s(t0 ))−1 b−1
1 I is a positive diagonal matrix due to the
assumptions that s(t0 ) > 0 and the assumption of Eq. (3.9).
25

This manuscript is for review purposes only.

For the constrained case, we argue that under Assumption 3.5, the optimal solution will have all z∗i ≤ 1,
so we can equivalently consider the unconstrained case. Indeed, suppose e.g., that z∗j > 1. In that case, the
∗ >
matrix diag(z∗ )B> diag(s(t0 ))C has its ( j, j)’th entry at least b−1
1 . Since the j’th row of diag(z )B diag(s(t0 ))C
>
is nonnegative, and since B diag(s(t0 ))C is strongly connected by Lemma 3.8, we have that the j’th row
of diag(z∗ )B> diag(s(t0 ))C is not zero. By by the same argument as we made in the SIS case, the matrix
diag(z∗ )B> diag(s(t0 ))C − b−1
1 I cannot be continuous-time stable. This implies that Eq. (3.10) cannot be
satisfied.
Finally, we conclude the proof by revisiting the assumption we made in the very beginning, namely the
assumption of Eq. (3.9). We now argue the problem of optimal lockdown has no solution if that equation
fails. Indeed, in that case, the matrix A0 has either its first n × n block nonnegative, or its last n × n block
nonnegative. We show that the problem has no solution in the first case; the other case has a similar proof.
We want to argue that having d > 0 such that A0 d ≤ 0 cannot occur if the top n × n block of A0
is nonnegative; by Lemma 3.7 part (1) this is enough to show A cannot be stable regardless of z. We can
partition d = [d1 , d2 ], and we immediately see that we must have that d1 = 0, since, by the strong connectivity
of diag(s(t0 ))Az , every entry of d1 is multiplied by some entry in the top left n × n submatrix of A0 . Applying
the same argument to the “top right” n × n block of A0 , get that d2 = 0, and this is a contradiction. This
concludes the proof.
To recap where we are: we have just reduced the unconstrained lockdown problem for the SIS and
COVID-19 models to stability scaling; further, the constrained lockdown problem was reduced to the same
under the high-spread condition.
We need to make the following remark: provided the matrix A = CB> was strongly connected and
s(t0 ) > 0, both of these reductions arrived at a stability scaling problems Our next step is to reduce the
stability scaling problem to a new problem, defined next, which has a somewhat simpler form.
Definition 3.12. Given a nonnegative matrix A, the problem of finding scalars l1 , . . . , ln such that A −
P
diag(l1 , . . . , ln ) is continuous-time stable while minimizing ni=1 ci li will be called the diagonal subtraction
problem.
Lemma 3.13. Stability scaling can be reduced to diagonal subtraction.
Proof. Indeed, starting from
min

n
X

q1 >0,...,qn >0

ci q−1
i

i=1

such that diag(q1 , . . . , qn )P − D is continuous time stable,
we apply Lemma 3.7, part (c) to obtain that the constraint is the same as
D−1 diag(q)P is discrete-time stable.
Here we used crucially that the matrix P is nonnegative and strongly connected and that the diagonal matrix
D is positive, ensuring that the assumptions of Lemma 3.7, part 3 are satisfied. We next use the same Lemma
3.7 part (c) again to obtain that this the last constraint is identical to
P − diag(q1 , . . . , qn )−1 D is continuous time stable
For simplicity, it is convenient to introduce the notation δi = q−1
i , i = 1, . . . , n. In terms of these new variables
δi , we have the problem
n
X
min
ci δi
δ1 >0,...,δn >0

i=1

26

This manuscript is for review purposes only.

subject to P − diag(d1 δ1 , . . . , dn δn ) is continuous-time stable,
where D = diag(d1 , . . . , dn ). Finally, introducing variables ui = di δi , i = 1, . . . , n, we have
n
X
ui
ci
u1 >0,...,un >0
d
i
i=1

min

subject to P − diag(u1 , . . . , un ) is continuous-time stable ,
which is an instance of diagonal subtraction with cost coefficients ci /di .
With all these preliminaries in place, we are now ready to turn to the proof of our main theoretical resu.t
Proof of Theorem 3.6, parts 1 and 2. In Lemma 3.10, we have shown how to reduce the optimal lockdown problem for SIS and COVID-19 dynamics to stability scaling. In the subsequent Lemma 3.13, we
showed how to reduce stability scaling to diagonal subtraction. We now prove Theorem 3.6 by reducing
diagonal subtraction to matrix balancing.
Indeed, we need to solve
n
X
ci li
min
l1 >0,...,ln >0

i=1

such that A − diag(l1 , . . . , ln ) is continuous time stable,
where A is a nonnegative matrix. We use part (a) of Lemma 3.7 to write this ass
(3.11)

n
X

min

l1 ,...,ln ,d1 ,...,dn

ci li

i=1

such that Ad − diag(l1 d1 , . . . , ln dn ) ≤ 0
d > 0, l > 0
The difficulty here is that we are optimizing over l and d, and the constraint includes a product of the
variables. We try to make this into a simpler problem by introducing the variables µi = li di , i = 1, . . . , n. We
change variables from (l, d) to (µ, d) to obtain the equivalent problem:
(3.12)

min

n
X

µ1 ,...,µn ,d1 ,...,dn

ci µi /di

i=1

such that Ad ≤ µ
d > 0, µ > 0
In this reformulation, the constraint is linear, and the nonlinearity has been moved to the objective.
Next, consider what happens when we fix some d > 0 and consider the best µ for that particular d.
Because ci > 0 for all i, and d > 0 , we want to choose each element µi as small as possible. The best choice
is clearly µ = Ad; no component of µ can be lower than that by our constraints. Because A is a nonnegative
matrix without zero rows by strong connectivity, this results in a feasible µ > 0.
27

This manuscript is for review purposes only.

Thus we can transform this into a problem which optimizes over just the variables d1 , . . . , dn :
min

n
X

d1 >0,...,dn >0

ci [Ad]i /di .

i=1

Our next step is to change variables one more time. Since d is a positive vector, it is natural to write di = egi .
In terms of the new variables g1 , . . . , gn , we just need to minimize the function f (g1 , . . . , gn ) defined as
min f (g1 , . . . , gn ) := min

g1 ,...,gn

n X
n
X

ci ai j eg j −gi .

i=1 j=1

We now have an unconstrained minimization of a convex function. In particular, if we can find a point where
∇ f (g1 , . . . , gn ) = 0, we will have found the global optimum.
Let us consider the k’th component of the gradient of f (g1 , . . . , gn ). We have the equation
0=

X
X
∂f
−ck ak j eg j −gk +
ci aik egk −gi
(g1 , . . . , gk ) =
∂gk
j,k
i,k
=

(3.13)

n
X

−ck ak j eg j −gk +

n
X

ci aik egk −gi

i=1

j=1

Let Dg = diag(eg1 , . . . , egn ) and Dc = diag(c1 , . . . , cn ). Observing that
−gu
[D−1
cu auv egv = cu auv egv −gu ,
g Dc ADg ]uv = e

we have that Eq. (3.13) can be written as
> −1
−[D−1
g Dc ADg 1]k + [1 Dg Dc ADg ]k = 0

In other words, the matrix D−1
g Dc ADg needs to have it’s k’th column sum equals to its k’th row sum. Thus
provided we can find a balancing of the matrix Dc A, we will have found the minimum of f (g1 , . . . , gn ) as
needed.
However, a matrix X can be balanced if and only if the underlying graph G(X) is strongly connected
[33]. Since we have assumed that ci are all positive and A is strongly connected, we have that Dc A can be
balanced. We conclude that the unique minimum of f (g1 , . . . , gn ) can be recovered from the balancing of
this matrix. This concludes the reduction of diagonal subtraction to matrix balancing.
We next turn to the third part of Theorem 3.6. We will not be using any of the reductions used to prove
the first two parts of the theorem. The first steps of our proof are very similar to the proof of the main result of
[8], which gave a semidefinite formulation of a lockdown problem ensuring asymptotic stability in a model
involving births and deaths. We diverge from [8] when we write the problem as a covering semi-definite
problem as described in Section 2.1 and analyze its complexity.
Proof of Theorem 3.6, part 3. We can simply repeat the proof of Lemma 3.10 to reduce the constrained
lockdown problem for network SIS and COVID-19 processes to stability scaling; except that, without Assumption 3.5, we now have to keep the constraint that z ∈ [0, 1]n . Indeed, note that the only place where
Assumption 3.5 was used in those two proofs was to argue that we can omit that constraint.
28

This manuscript is for review purposes only.

In this way, we can reduce the constrained lockdown problem to the following:
min

z1 ,...,zn

n
X

ci z−1
i

i=1

diag(a)Cdiag(z1 , . . . , zn )B − qI is continuous time stable
>

z ∈ [0, 1]n .
In this SIS case, a = 1 while q = γ − α. In the COVID-19 case, from Eq. (3.10) we have that a = s(t0 )
while q = b−1
1 . Note that this optimization problem is only over the variables z1 , . . . , zn ; all other quantities
appearing in it are parameters.
Suppose next that matrices C and B are chosen according to Eq. (2.4). In other words, we have the
problem
n
X
min
ci z−1
i
z1 ,...,zn

i=1

diag(a)τdiag(z1 , . . . , zn )D1 τ> D2 − qI is continuous time stable
z ∈ [0, 1]n ,
where, recall, the matrices D1 , D2 are defined immediately after Eq. (2.4).
Since the nonzero eigenvalues of a product of two matrices do not change when we flip the order in
which they are multiplied, the second constraint is equivalent to
diag(z1 , . . . , zn )D1 τ> D2 diag(a)τ − qI is continuous time stable .
Applying part (3) of Lemma 3.7, we get that this is the same as
q−1 diag(z1 , . . . , zn )D1 τ> D2 diag(a)τ is discrete time stable .
Here we used the strong connectivity and positive diagonal of the matrix τ. Next, applying the same lemma
again, we further get the equivalence to
−1
τ> D2 diag(a)τ − D−1
1 diag(z1 , . . . , zn ) qI is continuous time stable .

This can be simplified further by observing that a symmetric matrix is stable if and only if it is non-positivedefinite.
−1
>
Indeed, let us introduce the notation ui = (D1 )−1
ii qzi , and Q = τ D2 diag(a)τ. We can therefore write
our problem as
n
X
ci (D1 )ii
min
ui
q
i=1
0  Q − diag(u1 , . . . , un )
ui ∈ [q(D1 )−1
ii , +∞) for all i = 1, . . . , n.
Further defining c0i = ci (D1 )ii and the 2n × 2n positive-semidefinite matrices Bi = ei e>i + en+i e>n+i , we can
write this as
n
X
min
c0i ui
i=1

(3.14)

n
X
i=1

ui Bi 

Q
0

0
0

!
+

0
0

0
−1
qdiag((D1 )−1
11 , . . . , (D1 )nn )
29

This manuscript is for review purposes only.

!

As mentioned earlier, this is known as a “covering SDP.” In the recent paper, [30], it was shown that it can
be be solved, up to various logarithmic factors, in matrix multiplication time. We next discuss in detail the
results in [30] and how they are applicable to Eq. (3.14).
Specifically, in [30], an algorithm for checking whether the system of equations
X
X
xiCi  I,
xi Pi ≤ (1 − δ)I, x ≥ 0,
i

i

is feasible was given; here Ci , Pi are arbitrary nonnegative definite matrices. To begin applying this to our
1 −1 0
u ci 11> for all i. In that case, we are checking the feasibility of
problem, let us choose δ = 1/2 and Pi = 2n
X
X
(3.15)
xiCi  I,
c0i xi ≤ u, x ≥ 0.
i

i

e Pi nnz(Ci ) + nω ),
The running time of the algorithm from [30] for checking whether this is feasible
is O(


e hides a multiplicative factor which is a power of logarithm is O n2 maxi λmax (Ci )/λmax (Pi )
where the O
(see discussion under “Main Claim” in [30], and note that, in our case, the number of matrices and the
dimension are proportional). In our case, we will choose Ci = ei e>i + en+i e>n+i so that
λmax (Ci ) ≤ 1, λmax (Pi ) =

1
max c0 u−1 ,
2 i i

and plugging the definition of c0i , we have that the factor being hidden in the tilde is a power of logarithm of
n2

1
1
= 2n2
maxi λmax (Pi )
maxi c0i u−1
1
= 2n2 u
maxi c0i
1
= 2n2 u
maxi ci (D1 )ii
1
≤ 2n2 u−1
P
−1 .
maxi ci j N j τ ji

To summarize, we have discussed how long it takes to check feasibility of Eq. (3.15). The conclusion
e Pi nnz(Ci ) + nω ), where the the tilde notation hides a factor that is logarithmic in
is that the running time O(
P
the problem parameters n, u−1 , mini j c−1
i N j τ ji .
P
Now let us transition from just checking feasibility of Eq. (3.15) to minimizing ni=1 c0i xi subject to the
P
constraint i xiCi  0, x ≥ 0. We can, of course, find an  0 -additive approximation of this problem with a
lot of feasibility checks.
Let us suppose that we actually know that xi∗ ≥ li for some li (we do, in fact, know this because Eq.
(3.14) forces
X
xi∗ ≥ q(D1 )−1
=
q
Nk τki
ii
k

:= qNivisit
:= li
30

This manuscript is for review purposes only.



P
If c∗ is the optimal cost, then we need to do O log(c∗ / i c0i li ) + log  0−1 feasibility checks to get an 
additive approximation to the optimal cost. Upper bounding c∗ ≤ ncmax maxi xi∗ , we see that we need to do


n maxi ci maxi xi∗


0−1
O log
P 0 visit + log   ,
q i ci Ni
feasibility checks.
Now we cannot quite apply this directly to Eq. (3.14), since one issue remains. That issue is that we
P
have discussed an algorithm to handle the constraint i ui Bi ≥ I; but in Eq. (3.14), the right-hand side is not
the identity matrix.
However, the right-hand side of Eq. (3.14) is symmetric, so it can be decomposed as UΛU > for orthogonal U and diagonal Λ. Since A  B implies ZAZ >  ZBZ > , by choosing Z = Λ−1/2 U > we can equivalently
rewrite Eq. (3.14) as
n
X
min
c0i ui
i=1
n
X

ui Λ−1/2 U > Bi UΛ−1/2  I.

i=1

=Λ
U Bi UΛ
, we thus obtain a problem to which the algorithm of Eq. ([30]) is applicable.
Unfortunately, in the transformation the number of nonzero entries in the matrix Ci changes. Nevertheless,
as explained in [30] (in footnote 6 in the arxiv version), despite the change of variables, the scaling in the
running time remains with the number of nonzero matrices in the matrices Bi . However, we now need to add
the complexity of computing the eigendecomposition of the right-hand side of Eq. (3.14) to out complexity
bounds.
We can now put together everything we have observed above. The total complexity scales as the complexity of matrix multiplication and computing the eigendecomposition of a symmetric matrix, which we
takes O(n3 ) exact arithmetic operations [47]. This is multiplied by a power of a logarithm in the quantities

Letting Ci0

−1/2

>

−1/2

 0−1 , n, max ci , max xi∗ , P
i

i

X
b1
−1
0
c−1
,
u
,
λ
(C
),
min
max
i N j τ ji
visit
0
i
c
N
i i i
j

All of these are listed in the theorem statement, except maxi xi∗ , u−1 , P c01N visit , λmax (C 0 ). Let’s upper bound
i i i
each of these four quantities.
Since After Eq. (3.14), we switched from u to x as we began discusisng the results of [30], we have that


X


∗ −1
−1 
∗
∗
−1

Nk τka  (min z∗i )−1
max xi = max ui ≤ q max q(D1 )ii (min zi ) = b1 max
i

Next, the smallest u will be is

a

i

i

i

X

c0i li = q

X

i

k

c0i Nivisit .

i

Thus we can “kill two birds with one stone” by first upper bounding u−1 as



−1
X
X 0 −1 X

 ci li  =  ci (D1 )−1
Nk τki 
ii q
i

i

k

31

This manuscript is for review purposes only.

i

which is a polynomial in

X


max c−1

i , max 
i
i

k

−1

Nk τki  , b1 ,

and this also upper bounds
X

c0i Nivisit

i
−1

by a polynomial in the same quantities and q . Next,
λmax (Ci0 ) ≤

1
1
,
≤
mini Λii min(λmin (Q), q mina Navisit )

which is in turn a polynomial in

−1
1
, q−1 , min Nk τka
a
λmin (Q)
Finally, since Q = τ> D2 diag(a)τ, we have that


λmin (Q) ≥ min(D2 )ii ai λmin (τ> τ)
i


= λmin (τ> τ) min βs Ni si (t0 ) .
i

To summarize, the arithmetic complexity of computing an  0 additive approximation to the optimal solution
is O(n3 ) times a polylog in the variables


0−1

∗ −1
−1
, n, max ci , max c−1
i , (min zi ) , b1 , b1 , max
i
a
i
i

X
k


−1
−1
X


−1 

Nk τka  , λmin (τ> τ) , min βs Ni si (t0 ) .
Nk τka , min
a

k

i

Finally, this is to compute and  0 -approximate solution of the modified cost function in Eq. (3.14) which
omits a factor of q−1 . To account for this, we can simply divide  0 by a factor depending on q; but since
−1
q = b−1
1 and both b1 , b1 are already in the list of quantities under the poly log term, this does not change
anything.
Economic coefficients (ci ). In the objective function, ci represents the economic coefficients, which
captures the cost of closing down site or location i. As the economic activity closely related to the number
of employees, we let ci be proportional to the number of employees in location i. Specifically, suppose
ei is the number of employees of node i, emax is the maximum of the number of the employees in the
network, we define ci = ei /emax . We use LEHD Origin-Destination Employment Statistics (LODES) dataset
[44] to obtain the number of employees in each county of NYS. Particularly, we use the Residence Area
Characteristics (RAC) type of this dataset from [44]. This dataset is based on census at the block geographic
level; hence we aggregate the data to the county level.
4. Empirical Data Analysis.
We now describe how our data was obtained and how our simulations were conducted in a higher level
of detail compared to the discussion in the main body of the paper. Our focus here is on the simulations in
Section 2.2 discussing simulations based on New York State data.
Disease parameters. The disease parameters (βs , γ, ra , rs , , βa ) are essential to derive the optimal
lockdown rate z. To provide valid results and fully understand the role of the disease parameters, we use three
32

This manuscript is for review purposes only.

different groups of estimates provided in recent literature [8] [23] [7] to construct the disease parameters,
respectively. However, none of those models quite match our two-state COVID-19 model, which is why one
needs to be careful in re-using the parameters estimated in those models.
We directly use the recovery rate γ, ra , and rs from these literature. The reason is that these quantities
have the interpretation that infected people recover at a rate γ (or ra , rs in the COVID-19 case) per unit time,
which should carry over from model to model. Similarly, we will also reuse the parameter  from literature
[8] [23] which represents the rate that an infected individual develops symptoms.
In the SIS case, we choose the constant ζ (from definition of matrix D2 in Eq. (2.4)) to match the initial
growth of the models in the literature rate; the “initial growth rate” is λmax (A) − γ. We do likewise in the SIR
case.
In the case of COVID-19, we also need to choose the transmission rates βa , βs , which we do as follows.
Our first step is to let βa = α̂βs and assume we can reuse α̂ from the existing literature, as this scalar
measures the transmission rate difference of symptomatic individuals and asymptomatic individuals. Thus
we only need to decide how to choose βs . Our second step is to choose βs to match the initial growth rates of
the models in the literature. This is λmax (M(t0 )), where M(t0 ) is defined in (2.2). Note that as a consequence
of this procedure, the matrix A used for in COVID-19 case may not match the matrix A used in the SIS case.
Finally, we remark that the initial growth rate of the models in literature [8] [23] [7] can also be computed with the similar method. The resulting parameter values offered by literature [8] [23] [7] are summarized in SI Table 2. Our procedure is essentially the same as matching the R0 of the models (see e.g.,
[17, 27]).
One caveat is the in the model from [7], the parameters ra , rs , and α̂ are missing. In our experiments
using data from [7], we simply choose ra = rs = γ, and let α̂ = 0.6754 as in [23].
Populations (Ni ). To define the populations of each node in the network, we adopt the 2010 Census
Bureau data [11] at the level of the counties in the New York state. These populations (Ni ) will be used to
construct the matrix A as in (2.4) in the three models.
Economic coefficients (ci ). In the cost function, ci represents the economic coefficients, which captures
the cost of closing down site or location i. As the economic activity closely related to the number of employees, we let ci be proportional to the number of employees in location i. Specifically, suppose ei is the
number of employees of node i, emax is the maximum of the number of the employees in the network, we define ci = ei /emax . We use LEHD Origin-Destination Employment Statistics (LODES) dataset [44] to obtain
the number of employees in each county of NYS. Particularly, we use the Residence Area Characteristics
(RAC) type of this dataset from [44]. This dataset is based on census at the block geographic level; hence
we aggregate the data to the county level.
Travel rate (τi j ). To construct matrix A for the three models, we need travel rate matrix τ, where τi j
represents the rate at which an individual travels from location i to location j. We use the Social Distancing
Metrics dataset [54] from SafeGraph to generate τ. This dataset was collected using a panel of GPS pings
from anonymous mobile devices, and it is based on Census Block Group levels. For each device/individual,
the dataset identifies a “home” CBG, and the median daily home-dwell-time is provided for each CBG.
Additionally, this dataset provides the daily number of trips that the people go from their home CBG to
various destination CBGs.
In our empirical simulations, we only consider the network of New York State (i.e., we do not consider
the trips to places outside the New York State). For each node, we aggregate the number of trips to the county
level and obtain the number of trips from one node to another. We can also obtain the home-dwell-time of
each node as the median of the home-dwell-time among all the CBGs (daily median home-dwell-time) in
k
hi
) · Paikj ia , where hi is the home-dwell-time of node i (measured
this county. Then, we define τi j = (1 − 1440
33

This manuscript is for review purposes only.

in minutes), kia is the number of trips from node i to node a. We divide hi by 1440 because the latter is the
total number of minutes in a day.
Initial susceptible rate s(t0 ). For the network SIR model and COVID-19 model, we need the initial
susceptible rate s(t0 ) to derive the optimal lockdown rate. For each node of our network, we can get the
cumulative confirmed cases on each day from the dataset provide in [57]. However, recent studies [41]
suggest that many people are infected with COVID-19 but not showing symptoms. To account for this,
we divide the cumulative confirmed cases by a reporting rate to estimate the actual total infections. For
the reporting rate, we use the estimate 0.14 provided in recent literature [8] [28]. Then we obtain si (t0 ) =
Ii (t0 )
, where Ii (t0 ) represents the number of the cumulative confirmed cases of node i at time point t0
1 − 0.14N
i
and, as before, Ni is the number of the population of node i.
Initial recovery rate and initial symptom rate. To estimate the rate of active cases and the rate
of cumulative cases for SIS model and SIR model, we need initialize the recovery rate. For COVID-19
model, besides the recovery rate, we also need initialize the rate of symptomatic individuals and the rate
of asymptomatic individuals. Since we do not consider individuals who died for the pandemic in all three
models, in our simulation, we simply regard these people as recovered patients. We get the number of
cumulative death cases in each county of New York State on April 1st from New York Times [58]. For the
truly recovered people of the pandemic, unfortunately, we can not find specific numbers for each county in
New York State. However, we learn from [16] that the total number of recovered cases in USA on April 1st,
2020 is 8878, and the total number of cumulative cases in USA on April 1st, 2020 is 215215. Therefore, we
8878
)/(0.14Ni ), where Di (t0 ) represents the number
initialize the recovery rate of county i as: (Di (t0 ) + Ii (t0 ) 215215
of cumulative death cases in county i at time point t0 , we divide 0.14 as we also need consider the reporting
rate. For the initial symptom rate, we use the estimation in literature [8] [28] again, we assume 86% of
active cases are asymptomatic individuals, and the remaining active cases are symptomatic individuals. The
number of active cases are obtained as the difference of the cumulative cases and the recovered cases.
5. Numerical Calculations. We now describe the details of the synthetic experiments we have performed. Because in the empirical data all the variables of interest co-vary together, synthetic experiments
are necessary to dis-entangle the effect of aspects of graph variation.
5.1. Implementation details of Figure 1e. To clearly demonstrate the optimal lockdown issues we
consider and compare our non-uniform lockdown policy and the uniform lockdown policy, we implemented
a synthetic experiment on a simple three-nodes network as shown in Figure 1b. This specific network
consists of a city (A) with large population, and two suburbs (B, C) with small population (the population as
well as other data we used are given in Supplementary Table 1). We will assume employment is proportional
to the population so that the economic cost coefficient ci is also proportional to the population. Moreover, we
assume there exists no direct trips between location B and location C. For the choice of the travel rate matrix
τ, we choose a matrix that is similar to the New York State data, but with rounder numbers; specifically, we
k
hi
) · Paikj ia , where hi is the home-dwell-time of node i, kia is the number of trips from node
define τi j = (1 − 1440
i to node a, and we let


8000 1000 2000
0  ,
k = 2000 8500


1500
0
8000
hi is given in Supplementary Table 1. The initial susceptible rates are chosen as s(t0 ) = [0.90, 0.92, 0.95],
so that the epidemic mainly localizes at the city. The initial recovery rate and initial symptom rate are chosen
as in SI Sec. 4, the detailed numbers are given in Supplementary Table 1. The disease parameters are taken
34

This manuscript is for review purposes only.

from [7] where considers a SEIR model; we set the missing parameters as α̂ = 0.6754 (where βa = α̂βs ) and
ra = rs = γ. We still choose the target decay rate α = 0.0231 that corresponds to halving every 30 days.
It can be seen from Figure 1e that our policy outperforms the uniform lockdown policy in all of the three
locations. Besides, we can see that our optimal lockdown policy tends to shutdown the city more stringently
than the suburbs even if the epidemic mainly happens at the city. We will discuss the details about this
counter-intuitive phenomenon in Section 2.2.
5.2. Disease parameter sensitivity analysis. To understand the impact of various disease parameters,
we implement sensitivity experiments. In each experiment, we vary the value of one parameter while fix the
values of the others. The normal values of γ, , and initial growth rate are chosen as in [7], and the normal
value α̂ is chosen as in [23] (α̂ is not provide in [7]). When analyze the impact of γ, we let the decay rate
α = 0.02. In other cases, we let the decay rate α = 0.2rs = 0.04, since it is impossible to achieve a decay rate
better than γ, so we make it our goal to reach halfway there. For simplicity, we assume γ = ra , and rs = γ̂ra ,
where the normal value of γ̂ = 1. To compare the economic cost of the obtained optimal lockdown policy
and the uniform lockdown (decay matching) policy for each scenario. We define efficiency as the economic
cost ratio of the optimal lockdown policy to the best uniform lockdown policy, i.e.,

P 1
−
1
c
∗
i
i
zi
,
efficiency = P 
1
i ci z∗ − 1
uni

where zuni ∗ represents the uniform lockdown rate. Here, the uniform lockdown (decay matching) implies
the uniform policy which decays at a rate greater than equal to α. Supplementary Figure 6 shows the
corresponding experimental results.
Observe each column of Supplementary Figure 6, it can be seen that the value of the optimal lockdown
rate z∗i and the value of the efficiency is inversely proportional to each other. In other words, the higher the
level of the allowed economic activities, the more effective the optimal lockdown policy (compare to the
best uniform lockdown). Besides, it can be observed from Supplementary Figure 6(a), 6(f) that the recovery
rate γ is the parameter that has the most significant impact on the value of z∗i . In particular, when γ ranges
from 0.03 to 0.1, the value of z∗i for all the three models increases more than 0.5. Therefore, if we can make
the patients recover faster, we can send the number of infections to 0 quickly while maintaining a high level
of economic activity. γ̂ decides the value of the recovery rate of symptomatic individuals in the COVID-19
model, hence we allow a higher level of economic activities when the value of γ̂ increases, this can be seen
in Supplementary Figure 6(e). Moreover, the value of the initial growth rate is closely related to the value
of the transmission rate βs , the larger the initial growth rate is, the larger βs will be for each model. As a
consequence, we have to maintain a lower level of economic activities to make sure the infections go to 0
quickly (Supplementary Figure 6(b)).
It can be seen from Supplementary Figure 6(d) and 6(c) that the value of z∗i is not quite sensitive to the
symptom rate  and α̂. When the value of α̂ increases, the corresponding value of z∗i slightly increases. The
reason may be that the increasing of α̂ can lead to the increasing of λmax (M(t)). As we fix the value of the
initial growth rate λmax (M(t0 )), the obtained value of transmission rate βs can be smaller, which means we
can allow a higher level of economic activities.
5.3. Other parameter analysis.. Except the disease parameters, the structure of the data may also
have a great impact on the value of the generated optimal lockdown rate z∗i . To clearly investigate these
relationships, we depict the optimal z∗i with respect to the centrality, the home-stay rate (i.e., daily homedwell-time in minutes/total number of minutes in a day), the population and the employment for each county
35

This manuscript is for review purposes only.

in Supplementary Figure 7. It can be observed that the value of z∗i for all three models increases when the
home-stay rate increases. However, we do not observe any direct relationship between centrality, population,
employment, and the value of z∗i . To further verify this observation, we implemented random permutation
experiments.
5.4. Random permutation analysis.. To fully understand the relationship of the value of z∗i and the
data structure, we implemented random permutation experiments with respect to degree, home-stay rate,
population, employment and initial susceptible rate. In a random permutation experiment, we randomly
permute one parameter while keep all the others fixed, then we fit the models to the randomly permuted data
and apply the proposed algorithms get the optimal lockdown rate. We repeat this process 100 times for each
parameter, and compare the average values of the lockdown rate on permuted data with the original data.
The disease parameters are chosen as in [7]. In order to do a random permutation of the degree of the nodes,
we fix the network, and randomly permute all the other parameters. We implemented such experiments
based on data on different time points. The experimental results are reported in Supplementary Figure 8 and
Supplementary Figure 9. It can be observed that the shapes of the histogram after randomly permuting the
employment and initial susceptible rate are similar to the shape of the histogram of the original data. This
implies the value of z∗i does not have a close relationship with employment and susceptible rate. However,
the shapes of the histogram after randomly permuting the degree, home-stay rate, and population are quite
different from the original data. In other words, the centrality of the node, home-stay rate, and population
have a close relationship with the value of z∗i . To find out what kind of relationship between them, we
implemented further experiments on synthetic data.
5.5. Impact of centrality.. To study the impact of centrality, we generated some geometric random
graphs and then added additional “hotspots” with high degree. This was done by randomly choosing several
nodes in the initially generated geometric random graphs, and letting the edges leading from these nodes to
other nodes be present with probability 0.9.
We let the remaining parameters be identical for all the nodes. Specifically, we let the population of all
the nodes be 4000, the home-stay rate of all the nodes be 0.8, and we assume the number of employees of
each node is proportional to the population. Since the SIS model and the SIR model will be identical if we
let the initial susceptible rate of each node be the same constant (we choose βs to make the initial growth
rate of each model be equal). Besides, according to our previous analysis, when the values of the initial
susceptible rate of the nodes are close, it will not impact the value of the optimal lockdown rate of each node
too much. As a consequence, we choose initial susceptible rate from interval [0.8, 0.9] uniformly at random.
Moreover, according to the data [54] provided by SafeGraph, people tend to spend more time in their own
counties rather than travel to other counties when they are not stay at home. To make the synthetic data
similar to the real data, we update the definition of the travelling matrix τ as following:

0


0.8 · (1 − hi ) ·
τi j = 

0.2h0
i

P

Ai j
Aia

a,i

i, j
i= j

,

where h0i represents the home-stay rate of node i. In addition, the disease parameters of this experiment are
set as in [7], and the missing parameters are set as: α̂ = 0.6754 (βa = α̂βs ), ra = rs = γ. Similar to the
experiments on real data, we let the decay rate α = 0.2γ = 0.04 to satisfy the assumption that α ≤ γ.
The results of this experiment are presented in Figure 4a-b. It can be observed that centrality only
matters for the value of z∗i when there exist hotspots (i.e., highly central nodes) in all the three models.
Surprisingly, beyond such hotspots, the effect of centrality is essentially nonexistent.
36

This manuscript is for review purposes only.

To further study the impact of the centrality, we generated random graphs based on Barabási–Albert
model, where there exist few nodes with unusually high degree compared to other nodes in the network. By
varying the the number of the nodes, the number of links and the initial seed for the B-A model, we can
generate various random graphs. Besides the adjacency matrix A, all the other parameters about the data
(population, τ, employment, initial susceptible rate, home-stay-rate), the disease parameters and the decay
rate α are all chosen as in the experiment based on geometric graph. The experimental results are presented
in Supplementary Figure 10(a). From Supplementary Figure 10(a), we can observe the similar phenomenon:
the hotspots are assigned with smaller values of z∗i by the optimal lockdown policy in all the three models,
however, such effect of the centrality is nonexistent for all the other nodes.
Moreover, we also define a kind of random graphs to provide further evidence for the relationship of
the centrality and the value of z∗i . To generate graphs where the degree of each node can be different and
can be decided by us, we define the adjacency matrix A of the random graph as following: the uppertriangular element Ai j will be 1 with probability pi , and be 0 with probability 1 − pi , where p is the given
probability vector; the values of the elements in the lower-triangular matrix are equal to the symmetry of the
upper-triangular matrix. In other words, the edges leading from different nodes can be present with different
probabilities. Similarly, the disease parameters, the decay rate α, and all the other parameters about the data
are chosen as in the experiment based on geometric random graphs. The experimental results are presented
in Supplementary Figure 10(b). From Supplementary Figure 10(b), we can also observe that centrality only
matters for the value of z∗i when there exist hotspots. Except the hotspots, the effect of centrality is centrality
is nonexistent.
5.6. Impact of population.. In the experiments about the population, we fix all other parameters and
vary the population of each node from 100 to 20000. Since the employment is proportional to the population,
and the economic cost ci of each node is decided by the corresponding number of employees, the economic
cost of different nodes will also be different. To make sure the centrality of all the nodes are close, we
experimented with random regular graph, Erdos-Renyi random graph, and the geometric random graph. All
the other data parameters, disease parameters, and the decay rate α are set as in the experiments about the
centrality. The experimental results are presented in Figure 4c and Supplementray Figure 11(a). It can be
observed that nodes with small populations are assigned with smaller values of z∗i , surprisingly once the
population is not very small, the effect is almost nonexistent.
5.7. Impact of home-stay rate.. In the experiments about the home-stay rate, we fix all the other
parameters and vary the home-stay rate of the nodes from 0.05 to 0.9509. We chose random regular graph,
Erdos-Renyi random graph, geometric random graph, and the 2d grid as our network as the centrality of the
nodes on these graphs are similar. The disease parameters, the dacay rate α, and all the other data parameters
are set as in the experiments about the centrality. The experimental results are presented in Figure 4d and
Supplementary Figure 11(b). It can be observed the value of z∗i increases as the home-stay rate of the nodes
increases.
6. City-suburb model. We now revisit the phenomenon we have observed in our analysis of NYC,
which is that the optimal lockdown tends to shutdown the outside of NYC harder than the NYC itself. To
isolate this phenomenon in the simplest possible setting, we implement a simple synthetic experiment of a
network with two nodes: node 1 will be referred to as “the city” while node 2 will be referred to as “the
suburb.” The city will have a large number of population while the suburb will have a smaller population.
We will assume employment is proportional to the population so that the economic cost coefficient ci is
also proportional to the population. Then we apply the proposed algorithms to design the optimal shutdown
policy to this city-suburb model.
The disease parameters are taken from [7] where considers a SEIR model; we set the missing parameters
37

This manuscript is for review purposes only.

as α̂ = 0.6754 (where βa = α̂βs ) and ra = rs = γ. We still choose the target decay rate α = 0.2rs = 0.04 as
before. For the choice of the travel rate matrix τ, we choose a matrix that is similar to the New York State
k
hi
)· Paikj ia , where hi is the home-dwell-time
data, but with rounder numbers; specifically, we define τi j = (1− 1440
of node i, kia is the number of trips from node i to node a, and we let
"
#
8000 200
k=
,
20 850
h = [800

800].

We will consider three different cases:
• Case 1: population = [20, 000 2, 000], s(t0 ) = [0.7 0.95].
• Case 2: population = [200, 000 2, 000], s(t0 ) = [0.7 0.95].
• Case 3: population = [200, 000 2, 000], s(t0 ) = [0.95 0.95].
The experimental results are presented in SI Table 3. We see the same phonemon as in our New York State
experiments: the optimal lockdown policy shutdown the suburb more stringently than the city even though,
in cases 1 and 2, the epidemic is mainly localized in the city. Comparing the results of Case 1 and Case 2, we
see that this trend gets stronger when the population difference between the city and the suburb increases.
7. Beyond eigenvalue bounds. In this section, we further test our finding that the optimal stabilizing
shutdown using New York State data is more stringent outside NYC. Our goal is to directly compare lockdowns by comparing the total number of infections. Unfortunately, we do not know of any way to optimize
lockdowns efficiently to minimize the total number of infections; indeed, this difficulty is what motivates
optimization of eigenvalue bounds in the first place.
We will compare the optimal stabilizing lockdown computed by our method, which we will say has cost
c∗ , with lockdowns of the following structure:
• Two-parameters lockdown: shutdown the counties in NYC by z1 , and shutdown the other counties
in New York State by z2 , where z2 > z1 , such that the economic cost of the shutdown is at most c∗ .
• Uniform lockdown (cost matching): shutdown all the counties in New York State by z, such that
the economic cost of the shutdown is at most c∗ .
Because these lockdowns are characterized by, respectively, two and one parameters, they can be found via
direct search (i.e., discretizing the parameters and trying every possibility). To summarize, we will perform
an exhaustive search, not only over uniform lockdowns, but overall lockdowns defined by two zi , one inside
NYC and one outside, with the former being smaller (corresponding to a more stringent lockdown).
We will apply the disease parameters from literature [8], [7], and [23] respectively. Similarly, we let the
decay rate α = 0.2rs as before. The experimental results are presented in Supplementary Figure 12. These
findings further substantiate our results: our policy outperforms the best two-parameters lockdown as well
as the best uniform lockdown in all scenarios.
We conclude with a cautionary tale about what happens when the eigenvalues are pushed too far into
the left-hand plane. We have already remarked, in the main body of the paper, that this could result in poor
performance as the improvement in asymptotic rate starts to come at the expense of transient performance;
we next demonstrate how this phenomenon occurs in a series of charts. We experimented with decay rate
α = 0.5rs , the experimental results are presented in Supplementary Figure 13. Note that, in two of the
three charts, this corresponds to an asymptotic rate with roughly 10% decrease in the number of cases per
day. This extremely aggressive rate results in an optimal shutdown which, while attaining this rate, does
not perform well. In particular, in the figures with a 10% decrease rate, we see that our optimal stabilizing
shutdown underperforms the uniform shutdown and the two-parameters shutdown with the same cost.
38

This manuscript is for review purposes only.

Sensitivity analysis: To further study the impact of decay rate as well as various disease parameters to the
total number of infections, we implement sensitivity experiments. In each experiment, we vary the value
of one parameter while fix the values of the others. The normal values of γ, , and the initial growth rate
are chosen as in [7], and the normal value of α̂ (βa = α̂βs ) is set as in [23]. We let the normal value of the
decay rate α = 0.2rs = 0.04, since it is impossible to achieve a decay rate better than γ. For simplicity, we
assume γ = ra , and rs = γ̂ra , where the normal value of γ̂ = 1. The experimental results are presented in
Supplementary Figure 14 and 15.
As expected, it can be observed from Supplementary Figure 14(a), 14(d), and 15(a) that the total number
of the infections of our policy is much better for small α; but if we increase α too much, this starts to change
and we no longer outperform. Additionally, it can be seen from Supplementary Figure 14(c), 14(f), and
15(b) the total number of infections of all the polices increases as the initial growth rate increases, again as
expected; however, somewhat surprisingly, we can see from Supplementary Figure 14(b), 14(e), and 15(c)
that the total number of infections increases when the recovery rate γ increases. The reason for this counterintuitive phenomenon is that we assume the initial growth rate is fixed in this experiment, so that an increase
in the recovery rate γ means an increase in the transmission rate βs to obtain the same initial growth rate,
and the latter effect increases the total number of infections.
For COVID-19 model, besides α, γ, and the initial growth rate, we also studied the impact of parameters
, α̂, and γ̂. We can observe from Supplementary Figure 15(d) that the total number of the infections is not
sensitive to parameter  for all the three polices. As the transmission rate of asymptomatic individuals
βa = α̂βs , then the total number of infections increases as α̂ grows (Supplementary Figure 15(e)). Parameter
γ̂ is closely related to the recovery rate of the symptomatic individuals, its effect is similar to γ, when the
value of γ̂ increases, the transmission rate βs increases and further lead to the increasing of the total number
of the infections (Supplementary Figure 15(f)).
8. Why is the shutdown outside NYC harder? An intuitive explanation. Our main finding in the
empirical experiments – that an optimal stabilizing lockdown will shut down the outside of NYC more
stringently than NYC – is counter-intuitive. At least part of the reason why this happens is that our costs
are taken to be proportional to employment: we do not attempt to take into account either the larger salaries
of workers in NYC or the importance of NYC to the national economy. Nevertheless, the finding remains
counter-intuitive, and we are not aware of any previous literature pointing out that something like this can
occur.
We now provide an explanation which makes this finding more intuitive. Let us consider an idealized
city-suburb model with two nodes. Imagine now that the coefficients ci are proportional to population, and
imagine that, initially, there is no travel between city and suburb. For clarity, let us consider a related model
where, instead of minimizing cost subject to a constraint on how fast infections decay, we instead put a price
on each infection; this is closely related to what we do and slightly simpler to reason about. In that case, the
optimal shutdown should be invariant to scaling in population since doubling the population of a city will
both double the cost of a shutdown as well as double the benefit in terms of number of infections averted.
Now let us consider further what happens when we change the system by stipulating that: (1) 1% of trips
now happen between city and suburb (2) the population N of the city goes to infinity while the population
of the suburb remains fixed at, say, 1000.
In this case, whenever we shut down the suburb, the cost scales with the population 1000; while the
benefit also scales with N, the population of the city, since any shutdown in the suburb decreases the total
number of infections in the city (since the epidemic can spread in the city through interactions with the
suburb). Thus, even though only 1% of the trips go between city and suburb in each direction, the benefit
of shutting down the suburb will overwhelm the cost as N → +∞. The same argument does not apply to
the city: the increased benefits from reducing the number of infections in the suburb is small relative to the
39

This manuscript is for review purposes only.

cost which scales with N. This provides an explanation why an optimal shutdown might choose to be more
stringent in the suburb.
Of course, this is an idealized example. We note that in our empirical results, costs were taken to be
proportional to employment, not population; so that we will never encounter a situation where the costs of
shutting down a suburb do not scale with the size of the city (because if 1% of the trips go between city
and suburb, the suburb will also have employment that will scale with N to provide services to visitors).
Nevertheless, our empirical results suggest that this idealized example is not too far from what happens
once we use real data on number of trips and employment in NYC and suburbs, as the optimal stabilizing
shutdown does choose to be more stringent outside NYC.
9. Extended Lockdown Cost Functions. In this section, we explore the optimal lockdown with additional cost functions. Our goal is to show the counter-intuitive phenomenon we observed earlier – that the
optimal lockdown tends to shutdown the outside of NYC harder than the NYC itself – is not due to the particular choice of the economic cost functions in Eq. (2.6) in the main text. The choice of the new economic
cost functions follow the similar rules in (2.6).
We thus consider other cost functions. First, we consider
c(z1 , . . . , zn ) =

(9.1)

n
X
i

ci (

1
− 1).
z3i

By using the similar method as in SI Sec. 3.4, we can write the optimal lockdown issue with economic cost
(9.1) as a constrained convex optimization problem as following
min

n
X

c0i u3i

i=1

(9.2)

n
X
i=1

ui Bi 

Q
0

0
0

!
+

0
0

0
−1
qdiag((D1 )−1
11 , . . . , (D1 )nn )

!
.

The constraints of (9.2) is convex SDP constraints, and the cost function is also convex. Hence, we can use
the projected gradient descent (PGD) algorithm to obtain the optimal solution of this problem. Each step of
the projection involves solving a semi-definite program.
Besides the cost (9.1), we also consider the following economic cost functions:


n
X
 1

c(z1 , . . . , zn ) =
ci  1.5 − 1 ,
zi
i


n
X  1

c(z1 , . . . , zn ) =
ci  2 − 1 ,
zi
i
!
n
X
1
c(z1 , . . . , zn ) =
ci min( , 10) − 1 ,
zi
i
!
!
n
X
1
c(z1 , . . . , zn ) =
ci min , 20 − 1 ,
zi
i
!
!
n
X
1
c(z1 , . . . , zn ) =
ci min , 100 − 1 .
zi
i
40

This manuscript is for review purposes only.

Similarly, we can also write the optimal lockdown issues with these costs as the convex optimization problem
with convex SDP constraints, which can be addressed by the PGD algorithm.
To check if we can still observe the similar counter-intuitive phenomenon, we experimented with the
data about COVID-19 break in NYS with these extended cost functions. In our simulations, we employed
the toolbox from [38] to solve the projection step in each step of PGD problem. The disease parameters are
set as in [23]. The decay rate is chosen as α = 0.2rs = 0.0034 so that α < min(ra , rs ). The experimental
results are presented in Supplementary Figure 16 and Suplementary Figure 17.
It can still observed that the value of z∗i for counties in NYC are relatively higher than other counties in
NYS in each scenario, which implies we should shutdown the outside of NYC harder than itself. Additionally, the median of z∗i is greater than or close to the value of the uniform lockdown in all the cases. In other
words, compared to the uniform lockdown, the optimal lockdown policy not only leads to less economic
losses but also allows the majority of the counties to have more economic activity.

41

This manuscript is for review purposes only.

a

c

b
••• I

•:-· t �- .•: .-[
-..
••
•
••••,
••
·r ••
. , ·r . . ••
. , , r ., •:::::::::
. :::::::: ::::::.:: :.:. ::::::::.'

r

10 7

. . ..

Cf)

>­
z

z

C

C

en
Q)
en
�
Q)

>
t5 10 4
co

=t:t:

en
Q)
en
co

·;: ·
. -·. . ..
.-- ..--.- .- - .. ' - ' -·-....-.-- .-- .-- .--· .- ..--· .-· -· .....-- .
-

. - -

•

-. -

.· ·;:

i

--.-- .-.--

. . .. .

.

(.)

Q)

.

>
t5
co

: : : ·: - : : : ; . -... - ! . � : : :: : : : : : : :. - - � - -. - -. - � . - . : : .: ::. � : : : :.
• • •
" " "

•

• • " I

,

" " " 1

:

·,

:

-. - · :

I " ," •, • ,• • • • • •

.-

;

1 · .- - . - .- • " " " "

· : " "

.- " · :

" - . - -.

: -. - " "

-.-- .- .. -- .--, .......-, . ......
-- -- .--.•--.- ..- ..............
.
.
. •. C • . .
C
C
.,
!
. [ l .- ,. :

4

en
Q)
en

1

. . . .. .
. .. .. .. . . .
. . . .

• • • •• • • • . I • • •• • . 1 • I • '• •• • •• , • • • • • • • 1

=t:t:

I

,

r

I

"•

•'

I

'

L

I

.•

'• o

'
I

'
,

'
r

I

·,

L

,·•

'•

L

'
,·

I

•

=t:t:

•

•

•• •

•

•

•

•

•

•

•• •

•

p

•

I

,

'•

•

,·

L

�

r o

• •

• •

L •

• •

'• •

. L •

.

•

• ••

•• • •

••

L

-" • •

• •

• •

•'•

.
:-.....
,: :.--.--....--..- -...........--.--..
.
..
, ... . . . . .
.
..
.. .
'

'

••

I • • •

10 5
10 °

•

..

•

•' • '• •

• - - -· - - • • 1 . - -· - _ , . . . .. -· - ·- . - • - - • - _ , - - • - ·- . _ , . - · - - · - _. _ , .J . - - • - - • -

10 2'----�����.____����...............'---�-----'
10 1
10 °
Time (days)

. .

.
. ..·,:: ..
..
. . . .. .. . . . ..
::::, · :: j:
i:: i" :,: ,:: ·:::: "i::::
. ·,:::i:: · :,::,:i: :, :::: ::
..--.--.. .--..- -...... ..--.--..
'
'
'
.
'
'
.
.
.
'.
'
.
.
,.,
,
..
, . . . . . . . , ,'.
.. . .
.
.
. ...

�
Q)

>
t5
co

.
.

-·-.
·

.,
. .
- .. . - . . - ....- . ... . . '.-. . - . - - -.. . - .
- .. - . - - . . ..
. .
. '' --.--.- ..
. --..-... -.......
.--..-..-..-.- ....
.

10

C

06

·_.;: _ i
.

-• •-

Cf)

L

•• • • I .

'
.
,
'

•

•

. • • •. • ,

_.

'

,

• • • • •

101 .____����...............'---����...............'---�-----'
01
0°

'----����-L..L..L-����-'-'--'--�-'

10 1
Time (days)

1
Time (days)

1

----- e-a t -- no lockdown -- random lockdown -- uniform lockdown -- uniformly-bounded-decline lockdown ---ours

�

z

1.5

>-z

Cl)

. . ....
'

'

'

C

'

'

co(.)
Q)

>
:;::;

co

::J

a o.5
=ti:

Q)

co
Cl)

10 °

(.) 3
Q)

>

co

co

:;::;

E

E

::J 2
::J

a o.5
=ti:

0 .___����..........__-���................___��..............

10 1
Time (days)

10 2

>-z

Cl) 5

Cl)

1

::J

E

6

C

Cl)

1

X 10
-����.------��---.---,
6 .------�����

·- 4

Q)

Cl)

>
:;::;

'

Cl)

Q)

Q)

. . ....

1.5

C

Cl)

co(.)

f

e

d

' '

=ti: 1

0 .___����.......___-���..............-��--'

10 °

'

(.)

10 1
Time (days)

10 2

0 .___����..........__-���................___��..............

10 °

10 1
Time (days)

10 2

-- no lockdown -- random lockdown -- uniform locklodown -- uniformly-bounded-decline lockdown -- ours I

Fig. 1 Experimental results on real data: the estimated number of active casesand cumulative cases for SIS model by
applying different lockdown policies based on available data about COVID-19 outbreak in NY on April 1st, 2020. a-c,
the estimated number of active cases in NY. d-f, the estimated cumulative cases in NY. In a, d, the disease parameters
are set as in [7], the decay rate α is chosen as 0.0231 which corresponds to halving every 30 days. In b, e, the disease
parameters are set as in [23], the decay rate is chosen as α = 0.2rs = 0.0034 so that α < min(ra , rs ). In c, f, the disease
parameters are set as in [8], the decay rate α is chosen 0.0231 that corresponds to halving every 30 days. Uniform
lockdown, random lockdown, and uniformly-bouded-decline lockdown are defined as in Fig 1. It can be observed that
our policy outperforms all the other lockdown polices.

10. Supplementary Figures.

42

This manuscript is for review purposes only.

a

,
10 8.-------�����.-------�����,�.-------�----.

b

c

=:;i��==�l�
...........

(f)

>­
z

.

.

(f) 106

- . - ..- - . - - .. .
. . . . .
! : .� -� �� -·�: -� -� .� -� .: -: -: : : : � : : : : :� :
'

'

C

'

C

::
: :- .� :':�
- - ·-..1 :- .: - -

en
Q)
en
ro

''

(f)

>z

''

'

i � � :•: � i � � : : �- i �

>z

.

en
Q)

-

• ■ ■•••• ■
•

'

:

. . .

. ■•• ·
•

:

■

:

'.

. ■••••• ■ ■• ■ ■ .
•
•

:

'

■• ■ ■• ■ ·

'
:

.

'
'
■•••••• ■
•
•
•

� 10 5
u

u

>

>

u

t5
ro

ro
=t:t:

Q)

>

t5
ro

o

=t:t: 1 4
.

.

'

.

• ■■
•·• ■
• ■ i • ■ :•• ■i: •
:

,,

�

''

:i ■O:
�

�

102

.

=t:t:

'

'.

.

�

•

'

'

.�

�

'

'''

�

'

■••'•. !

■ !,,:

'
'
■• ■•• ■ ■.
:
,

'
■• •,•

■

.

'
:

:

•

" i

'

'

'

'

'
'

..

..

:

.

. --

i

_L

■.!

.

■•••■

. .

'
■ ■•,• ■ ·

:

-"

i

..- . - - - . ..-

■•• ■
•

i

.

- . --

10°'---����................___����................___�___.

10 3'---����_.__._,_-����............._-�_,
10 1
10°

Time (days)

.
.'

'
'
'
'
■ ■• ■ ■• ■ ■• ■ ■• ■ ■• ■ ■• ■ ■• ■ ■• ■
'
'
'
'

�

10 1

•

,:-.-,-:

i

.L

;•,:
• : ■ ■• ■ ■••
! . ■ ■.•:

'
'
•,••••• ■ ■• ■ ■• ·

-.--.............

'

='•■■•■■•■■'

'

. . . � .. - .
.

■• ■•'• ■ ■• !

- "J"

■■:I:■
•■■•■■I:■■•■:•■C •■'■o: ■•oC
•
•
•
•C
.:

104

en
Q)
en
ro
u

Q)

Q)

C

10 1

10°

Time (days)

Time (days)

-----e-a t -- no lockdown -- random lockdown -- uniform lockdown -- uniformly-bounded-decline lockdown ---ours

d

e

f

>-z

Cl)

>-z

Cl)

Cl)
C

1.5

C

Q)
Cl)

>

Q)

ro

(.)

1

>

Q)

:;::;

5

E

5

o.5

=t:t:

o�����������-��
10 °

10 1

10 2

X

10 6

1.8
1.6

Cl)
Q)
Cl)

ro 1.4

. . .
'

T"

T"

T

T"

r-

' '
T

T

(.)

1

> 1.2

Q)
:;::;

ro
::J

::J

E

C

:;::;

ro

=t:t:

1.5

Cl)
Q)
Cl)

Cl)

�

>-z

2

ro
::J

E

(.)

=t:t:

o�����������-��
10 °

1

::J

o.5

10 1

10 2

0.8
0.6
10 °

10 1

10 2

Time (days)
Time (days)
Time (days)
--no lockdown --random lockdown --uniform locklodown --uniformly-bounded-decline lockdown --ours

I

Fig. 2 Experimental results on real data: the estimated number of active casesand cumulative cases for SIR model by
applying different lockdown policies based on available data about COVID-19 outbreak in NY on April 1st, 2020. a-c,
the estimated number of active cases in NY. d-f, the estimated cumulative cases in NY. In a, d, the disease parameters
are set as in [7], the decay rate α is chosen as 0.0231 which corresponds to halving every 30 days. In b, e, the disease
parameters are set as in [23], the decay rate is chosen as α = 0.2rs = 0.0034 so that α < min(ra , rs ). In c, f, the disease
parameters are set as in [8], the decay rate α is chosen 0.0231 that corresponds to halving every 30 days. Uniform
lockdown, random lockdown, and uniformly-bouded-decline lockdown are defined as in Fig 1. It can be observed that
our policy outperforms all the other lockdown polices.

43

This manuscript is for review purposes only.

z
ₗ
*
0.
1261

b

0.
7261

z
ₗ
*
0.
0636

0.
3666

c

z
ₗ
*
0.
6564

1.
0000

Our
s

a

©Mapbox©OSM

©Mapbox©OSM

©Mapbox©OSM

z
ₗ
0.
1261

e

0.
7361

z
ₗ
0.
0636

0.
3666

f

z
ₗ
0.
6564

1.
0000

Uni
f
or
m Loc
kdown

d

z
ₗ
0.
1722

h

0.
3297

z
ₗ
0.
0605

0.
1786

i

z
ₗ
0.
97013

0.
99992

Random Loc
kdown

g

©Mapbox©OSM

©Mapbox©OSM

©Mapbox©OSM

z
ₗ
0.
0285

1.
0000

k

z
ₗ
0.
0148

0.
5341

l

z
ₗ
0.
96287

1.
00000

Uni
f
or
ml
yboundeddec
l
i
ne
Loc
kdown

j

©Mapbox©OSM

©Mapbox©OSM

©Mapbox©OSM

©Mapbox©OSM

©Mapbox©OSM

©Mapbox©OSM

Fig. 3 Experimental results of real data: lockdown rate of each county given by different polices for SIS model based
on available data about COVID-19 outbreak in NY on April 1st, 2020. a-c, optimal lockdown rate z∗i given by our
method . d-f, uniform lockdown rate zi . g-i, random lockdown rate zi . j-l, uniformly-bounded-decline lockdown rate zi .
Uniform lockdown, random lockdown, and uniformly-bouded-decline lockdown are defined as in Fig 1. In a, d, g, j, the
disease parameters are set as in [7], the decay rate α is chosen as 0.0231 which corresponds to halving every 30 days. In
b, e, h, k the disease parameters are set as in [23], the decay rate is chosen as α = 0.2rs = 0.0034 so that α < min(ra , rs ).
In c, f, i, l, the disease parameters are set as in [8], the decay rate α is chosen 0.0231 that corresponds to halving every
30 days. It can observed from a-c that the value of z∗i for counties in NYC are relatively higher than other counties in
New York State, which implies we should shutdown the outside of NYC harder than itself. Besides, it can be seen that
such counter-intuitive phenomenon does not appear in any other lockdown polices.
44

This manuscript is for review purposes only.

z
ₗ
*
0.
1260

0.
7614

z
ₗ
*

b

0.
0636

0.
3844

c

z
ₗ
*
0.
6596

1.
0000

Our
s

a

z
ₗ
0.
1260

0.
7614

e

z
ₗ
0.
0636

0.
3844

f

z
ₗ
0.
6596

1.
0000

Uni
f
or
m Loc
kdown

d

©Mapbox©OSM

©Mapbox©OSM

©Mapbox©OSM

©Mapbox©OSM

©Mapbox©OSM

©Mapbox©OSM

z
ₗ
0.
1703

0.
3288

h

z
ₗ
0.
0724

0.
1886

i

z
ₗ
0.
97131

0.
99937

Random Loc
kdown

g

©Mapbox©OSM

©Mapbox©OSM

©Mapbox©OSM

z
ₗ
0.
0303

0.
9999

k

z
ₗ
0.
0159

0.
5753

l

z
ₗ
0.
95882

1.
00000

Uni
f
or
ml
yboundeddec
l
i
ne
Loc
kdown

j

©Mapbox©OSM

©Mapbox©OSM

©Mapbox©OSM

Fig. 4 Experimental results of real data: lockdown rate of each county given by different polices for SIR model based
on available data about COVID-19 outbreak in NY on April 1st, 2020. a-c, optimal lockdown rate z∗i given by our
method . d-f, uniform lockdown rate zi . g-i, random lockdown rate zi . j-l, uniformly-bounded-decline lockdown rate zi .
Uniform lockdown, random lockdown, and uniformly-bouded-decline lockdown are defined as in Fig 1. In a, d, g, j, the
disease parameters are set as in [7], the decay rate α is chosen as 0.0231 which corresponds to halving every 30 days. In
b, e, h, k the disease parameters are set as in [23], the decay rate is chosen as α = 0.2rs = 0.0034 so that α < min(ra , rs ).
In c, f, i, l, the disease parameters are set as in [8], the decay rate α is chosen 0.0231 that corresponds to halving every
30 days. It can observed from a-c that the value of z∗i for counties in NYC are relatively higher than other counties in
New York State, which implies we should shutdown the outside of NYC harder than itself. Besides, it can be seen that
such counter-intuitive phenomenon does not appear in any other lockdown polices.

45

This manuscript is for review purposes only.

20
0

SIS
SIR
COVID-19

40
20

0

0.5

Optimal lockdown rate z i *

1

0

05/01/2020

60

SIS
SIR
COVID-19

40
20

0

0.5

Optimal lockdown rate z i *

0

1

06/02/2020

60

SIS
SIR
COVID-19

# counties

40

04/01/2020

60

# counties

# counties

SIS
SIR
COVID-19

# counties

03/02/2020

60

40
20

0

0.5

Optimal lockdown rate z i *

1

0

0

0.5

Optimal lockdown rate z i *

1

Fig. 5 Experimental results of real data: optimal lockdown rate z∗i given by Theorem 3.6 for SIS, SIR, and COVID-19
model based on available data about COVID-19 outbreak in New York State on March 2nd, April 1st, May 1st and June
2nd. The disease parameters are set as in [7]. The decay rate is chosen as α = 0.2rs = 0.04 so that α < min(ra , rs ). It
can be seen that the value of z∗i tends to increase from March to June, as people travel less frequently due the impact of
COVID-19.

46

This manuscript is for review purposes only.

(a)

(b)

(c)

(d)

(e)

(f)

(g)

(h)

(i)

(j)

Fig. 6 Disease parameter sensitivity analysis: optimal lockdown rate z∗i and corresponding efficiency given by Theorem
3.6 for SIS, SIR, and COVID-19 model based on available data about COVID-19 outbreak in New York State on April
1st. In a-e, the shaded region represents the standard deviation of z∗i for all 62 counties, the solid line is the mean value
of z∗i for all 62 counties. Parameter , α̂, γ̂ only appears in COVID-19 model, hence c-e and h-j only show the results of
COVID-19 model. It can be seen that the value of z∗i and the corresponding economic cost are sensitive to recovery rate
and the initial growth rate but not to other parameters.

47

This manuscript is for review purposes only.

(a)

(b)

(c)

Fig. 7 Other parameter analysis: the relationship of the optimal lockdown rate zi and the centrality, home-stay rate,
population and employment. z∗i are produced by Theorem 3.6 based on available data about COVID-19 outbreak about
COVID-19 outbreak in New York State on April 1st, 2020. The disease parameters are set as in [7]. In a, the disease
parameters are set as in [7], the decay rate α is chosen 0.0231 that corresponds to halving every 30 days. In b, the disease
parameters are set as in [23], the decay rate is chosen as α = 0.2rs = 0.0034 so that α < min(ra , rs ). In c, the disease
parameters are set as in [8], the decay rate α is chosen 0.0231 that corresponds to halving every 30 days. Degree closely
related to centrality, and the number of employees decides the economic cost coefficients ci . Each point represents a
county in New York State. It can be observed that the value of z∗i increases as the home-stay rate of the node increases,
the impacts of the degree, population and the employment to the value of z∗i are not obvious.

48

This manuscript is for review purposes only.

Original Data

Degree random permutation
60

SIS
SIR
COVID-19

40

40

30

30

20

10
0

40

30

20

20

10
0

0.2

0.4

0.6

0.8

0

1

Optimal lockdown rate z i *

10
0

Population random permutation

0.4

0.6

0.8

Optimal lockdown rate z i *

# counties

# counties

10

0

0

0.2

0.4

0.6

0.8

1

Optimal lockdown rate z i *

0.6

0.8

1

SIS
SIR
COVID-19

40
30

20

10

0.4

Optimal lockdown rate z i *

50

30

20

0.2

Initial susceptible rate random permutation

40

30

0

60

SIS
SIR
COVID-19

50

40

0

0

1

Employment random permutation
60

SIS
SIR
COVID-19

50

0.2

# counties

60

SIS
SIR
COVID-19

50

# counties

50

# counties

50

Home-stay rate random permutation
60

SIS
SIR
COVID-19

# counties

60

20
10

0

0.2

0.4

0.6

0.8

Optimal lockdown rate z i *

0

1

0

0.2

0.4

0.6

0.8

Optimal lockdown rate z i *

1

(a)
Original Data

Degree random permutation
60

SIS
SIR
COVID-19

40

40

30

40

30

20

30

20

10

10

0

0

0

0.2

0.4

0.6

0.8

1

Optimal lockdown rate z i *

20
10

0

Population random permutation

0.6

0.8

# counties

# counties

0.6

0.8

Optimal lockdown rate z i *

1

0

0.8

1

SIS
SIR
COVID-19

30
20

10
0.4

0.6

40

20

0.2

0.4

Optimal lockdown rate z i *

50

30

10

0.2

Initial susceptible rate random permutation

40

20

0

60

SIS
SIR
COVID-19

50

30

0

0

1

Employment random permutation

40

0

0.4

Optimal lockdown rate z i *

60

SIS
SIR
COVID-19

50

0.2

# counties

60

SIS
SIR
COVID-19

50

# counties

50

# counties

50

Home-stay rate random permutation
60

SIS
SIR
COVID-19

# counties

60

10
0

0.2

0.4

0.6

0.8

Optimal lockdown rate z i *

1

0

0

0.2

0.4

0.6

0.8

Optimal lockdown rate z i *

1

(b)

Fig. 8 Experimental results of random permutation: optimal lockdown rate z∗i after doing random permutation with
respect to degree, home-stay rate, population, employment, and initial susceptible rate. a, shows the results based on
available data about COVID-19 outbreak in NYS on March 2nd, 2020. b, the results based on available data about
COVID-19 outbreak in NYS on April 1st, 2020. The decay rate is chosen as α = 0.2rs = 0.04 so that α < min(ra , rs ).
The results are average of 100 repeat. It can be observed that the distribution of z∗i can be very strongly affected by
permutations of centrality, population, and the home stay rate. On the other hand, the distribution of z∗i is not altered
much by permuting employment and the initial susceptible rate.

49

This manuscript is for review purposes only.

Original Data

Degree random permutation
60

SIS
SIR
COVID-19

40

40

30

30

20

10
0

40

30

20

20

10
0

0.2

0.4

0.6

0.8

0

1

Optimal lockdown rate z i *

10
0

Population random permutation

0.4

0.6

0.8

Optimal lockdown rate z i *

# counties

# counties

10

0

0

0.2

0.4

0.6

0.8

1

Optimal lockdown rate z i *

0.6

0.8

1

SIS
SIR
COVID-19

40
30

20

10

0.4

Optimal lockdown rate z i *

50

30

20

0.2

Initial susceptible rate random permutation

40

30

0

60

SIS
SIR
COVID-19

50

40

0

0

1

Employment random permutation
60

SIS
SIR
COVID-19

50

0.2

# counties

60

SIS
SIR
COVID-19

50

# counties

50

# counties

50

Home-stay rate random permutation
60

SIS
SIR
COVID-19

# counties

60

20
10

0

0.2

0.4

0.6

0.8

Optimal lockdown rate z i *

0

1

0

0.2

0.4

0.6

0.8

Optimal lockdown rate z i *

1

(a)
Original Data

Degree random permutation
60

SIS
SIR
COVID-19

40

40

30

40

30

20

30

20

10

10

0

0

0

0.2

0.4

0.6

0.8

1

Optimal lockdown rate z i *

20
10

0

Population random permutation

0.6

0.8

# counties

# counties

0.6

0.8

Optimal lockdown rate z i *

1

0

0.8

1

SIS
SIR
COVID-19

30
20

10
0.4

0.6

40

20

0.2

0.4

Optimal lockdown rate z i *

50

30

10

0.2

Initial susceptible rate random permutation

40

20

0

60

SIS
SIR
COVID-19

50

30

0

0

1

Employment random permutation

40

0

0.4

Optimal lockdown rate z i *

60

SIS
SIR
COVID-19

50

0.2

# counties

60

SIS
SIR
COVID-19

50

# counties

50

# counties

50

Home-stay rate random permutation
60

SIS
SIR
COVID-19

# counties

60

10
0

0.2

0.4

0.6

0.8

Optimal lockdown rate z i *

1

0

0

0.2

0.4

0.6

0.8

Optimal lockdown rate z i *

1

(b)

Fig. 9 Experimental results of random permutation: optimal lockdown rate z∗i after doing random permutation with
respect to degree, home-stay rate, population, employment, and initial susceptible rate. a, the results based on available
data about COVID-19 outbreak in NYS on May 1st, 2020. b, the results based on available data about COVID-19
outbreak in NYS on June 2nd, 2020. The disease parameters are set as in [7]. The decay rate is chosen as α = 0.2rs =
0.04 so that α < min(ra , rs ).The results are average of 100 repeat. It can be observed that the distribution of z∗i can be very
strongly affected by permutations of centrality, population, and the home stay rate. On the other hand, the distribution
of z∗i is not altered much by permuting employment and the initial susceptible rate.

50

This manuscript is for review purposes only.

(a)

0.1

0.05

0

50

Degree

100

p = 0.1 * ones(200, 1)

0.18
SIS
SIR
COVID-19

0.16
0.14
0.12
10

15

20

25

Degree

p = kron([0.1 : -0.01 : 0.01], ones(20, 1));

0.22

0.2
0.18
SIS
SIR
COVID-19

0.16
0.14
0.12
0.1

30

Optimal lock-down rate

0.15

0.2

Optimal lock-down rate

SIS
SIR
COVID-19

Optimal lock-down rate

Optimal lock-down rate

p = [0.1; 0.2 ; 0.3; 0.4; 0.01 * ones(196, 1)]

0.2

0

10

20

Degree

30

40

p = [0.2; 0.2; 0.2; 0.2; 0.01 * ones(196, 1) ]

0.2

SIS
SIR
COVID-19

0.18
0.16
0.14
0.12
0.1
0

20

40

Degree

60

(b)

Fig. 10 Experimental results of synthetic data: the impact of centrality of the network. a, the results based on
Barabási–Albert model. b, the results based on a kind of generated random graph. Each point represents a node in
the network. It can be observed that centrality only matters for the value of z∗i when there exist hotspots in all the three
models. Surprisingly, beyond such hotspots, the effect of centrality is essentially nonexistent.

51

This manuscript is for review purposes only.

(a)

(b)

Fig. 11 Experimental results of synthetic data: the impact of population and home-stay rate to the value of optimal
lockdown rate z∗i . a, the impact of population. Each point represents a node in the network. It can be observed nodes
with small populations are assigned smaller values of z∗i . Surprisingly, once the population is not very small, the effect
is almost nonexistent. b, the impact of home-stay rate. Each point represents a node in the network. It can be observed
that z∗i increases as the home-stay rate increases, and in fact the home-stay rate has by far the biggest influence on z∗i
compared to the other parameters we consider.

52

This manuscript is for review purposes only.

Cumulative cases rate in NYS

Cumulative cases rate in NYS

0.5
0.4
0.3
0.2
0.1
0

0

200

400

Time (days)

SIR

0.16

600

0.14
0.12
0.1

0.06
0.04
0.02

800

best two-parameters lockdown
ours
uniform locdkown (cost matching)

0.08

0

200

400

Time (days)

COVID-19

0.14

Cumulative cases rate in NYS

SIS

0.6

600

0.12
0.1
0.08
0.06
0.04
0.02

800

0

200

400

Time (days)

600

800

600

800

600

800

(a)

Cumulative cases rate in NYS

Cumulative cases rate in NYS

0.5
0.4
0.3
0.2
0.1
0

0

200

400

Time (days)

SIR

0.25

600

0.2
0.15
0.1

best two-parameters lockdown
ours
uniform lockdown (cost matching)

0.05
0

800

0

200

400

Time (days)

COVID-19

0.2

600

Cumulative cases rate in NYS

SIS

0.6

0.15

0.1

0.05

0

800

0

200

400

Time (days)

(b)

Cumulative cases rate in NYS

Cumulative cases rate in NYS

0.1
0.08
0.06
0.04
0.02

0

200

400

Time (days)

SIR

0.09

600

800

0.08
0.07
best two-parameters lockdown
ours
uniform lockdown (cost matching)

0.06
0.05
0.04
0.03

0

200

400

Time (days)

COVID-19

0.09

600

800

Cumulative cases rate in NYS

SIS

0.12

0.08
0.07
0.06
0.05
0.04
0.03

0

200

400

Time (days)

(c)

Fig. 12 Experimental results of real data: the estimated rate of accumulative cases in the total population by applying
different lockdown policies based on available data about COVID-19 outbreak in New York State on April 1st, 2020.
It can be observed our policy outperforms the best two-parameters lockdown as well as the uniform lockdown in all
the three models. In a, the disease parameters are set as in [7], and the decay rate α = 0.2rs = 0.04. In b, the disease
parameters set as in [23], and the decay rate α = 0.2rs = 0.0034. In c, the disease parameters set as in [8], and the decay
rate α = 0.2rs = 0.058.

53

This manuscript is for review purposes only.

Cumulative cases rate in NYS

Cumulative cases rate in NYS

0.055
0.05
0.045
0.04
0.035
0.03

0

200

400

Time (days)

SIR

0.065

600

0.06
0.055
0.05

0.04
0.035
0.03

800

best two-parameters lockdown
ours
uniform locdkown (cost matching)

0.045

0

200

400

Time (days)

COVID-19

0.06

Cumulative cases rate in NYS

SIS

0.06

600

0.055
0.05
0.045
0.04
0.035
0.03

800

0

200

400

Time (days)

600

800

600

800

(a)

(b)

Cumulative cases rate in NYS

Cumulative cases rate in NYS

0.055
0.05
0.045
0.04
0.035
0.03

0

200

400

Time (days)

SIR

0.06

600

800

0.055
0.05
0.045

best two-parameters lockdown
ours
uniform lockdown (cost matching)

0.04
0.035
0.03

0

200

400

Time (days)

COVID-19

0.06

600

800

Cumulative cases rate in NYS

SIS

0.06

0.055
0.05
0.045
0.04
0.035
0.03

0

200

400

Time (days)

(c)

Fig. 13 Experimental results of real data: the estimated rate of accumulative cases in the total population by applying
different lockdown policies based on available data about COVID-19 outbreak in New York State on April 1st, 2020. In
a, the disease parameters set as in [7], and the decay rate α = 0.5rs = 0.1. In b, the disease parameters set as in [23],
and the decay rate α = 0.5rs = 0.0085. In c, the disease parameters set as in [8], and the decay rate α = 0.5rs = 0.145.
In b, it can be seen that our policy outperforms the best two-parameters lockdown as well as the uniform lockdown in
SIS model and SIR model. In a, c, and the COVID-19 model in b, it can be seen that our policy underperforms the best
two-parameters lockdown as well as the uniform lockdown, the reason for such phenomenon is provided in SI Sec. 7.

54

This manuscript is for review purposes only.

SIS

(a)

(b)

(c)

SIR

(d)

(e)

(f)

Fig. 14 Sensitivity analysis: the estimated rate of final accumulative cases (at day 500) in the total population for SIS
model and SIR model, respectively based on available data about COVID-19 outbreak in New York State on April 1st,
2020. It can be observed from a and d that the total number of the infections of our policy is much better for small α;
but if we increase α too much, this starts to change and we no longer outperform. Besides, from c and f we can see
that the total number of infections of all the polices increases as the initial growth rate increases. In addition, it can be
observed from b and e that the total number of infections increases when the recovery rate γ increases, the reason for
this counter-intuitive phenomenon is provided in SI Sec. 7.

55

This manuscript is for review purposes only.

COVID-19

(a)

(b)

(c)

(d)

(e)

(f)

Fig. 15 Sensitivity analysis: the estimated rate of final accumulative cases (at day 500) in the total population for
COVID-19 model based on available data about COVID-19 outbreak in New York State on April 1st, 2020. It can be
observed from a that the total number of the infections of our policy is much better for small α; but if we increase α too
much, this starts to change and we no longer outperform. Besides, from b, we can see that the total number of infections
of all the polices increases as the initial growth rate increases. In addition, it can be observed from c that the total number
of infections increases when the recovery rate γ increases, the reason for this counter-intuitive phenomenon is provided
in SI Sec. 7. The analysis for d-f can also be found in SI Sec. 7.

56

This manuscript is for review purposes only.

optimal loackdown rate zᵢ*
0.0200

0.15

© Mapbox © OSM

© Mapbox © OSM

© Mapbox © OSM

median of zᵢ* = 0.0784，uniform lockdown (decay matching) =
0.0748

0.2800

COVID-19

SIR

SIS

median of zᵢ* = 0.0783, uniform lockdown (decay matching) =
0.0748

median of zᵢ*= 0.0233, uniform lockdown (decay matching) =
0.0223

(a)
optimal loackdown rate zᵢ*
0.0200

0.13

© Mapbox © OSM

© Mapbox © OSM

© Mapbox © OSM

median of zᵢ* = 0.0784，uniform lockdown (decay matching) =
0.0748

0.2600

COVID-19

SIR

SIS

median of zᵢ* = 0.0788, uniform lockdown (decay matching) =
0.0748

median of zᵢ*= 0.0235, uniform lockdown (decay matching) =
0.0223

(b)
optimal loackdown rate zᵢ*
0.0200

0.12

© Mapbox © OSM

© Mapbox © OSM

© Mapbox © OSM

median of zᵢ* = 0.0793，uniform lockdown (decay matching) =
0.0748

0.2200

COVID-19

SIR

SIS

median of zᵢ* = 0.0795, uniform lockdown (decay matching) =
0.0748

median of zᵢ*= 0.0237, uniform lockdown (decay matching) =
0.0223

(c)

Fig. 16 Experimental results of real data: optimal lockdown rate z∗i given by Theorem 3.6 for SIS, SIR, and COVID-19
model based on available data about COVID-19 outbreak in New York State on April 1st, 2020. The disease parameters
are set as in [23]. The decay rate is chosen as α = 0.2rs = 0.0034 so that α < min(ra , rs ). In a, the cost function is chosen
P
P
P
1
as i ci ( z1.5
− 1). In b, the cost function is chosen as i ci ( z12 − 1). In c, the cost function is chosen as i ci ( z13 − 1). It
i

i

i

can observed that the value of z∗i for counties in NYC are relatively higher than other counties in New York State, which
57itself. Besides, the median of z∗ is greater than the value of
implies we should shutdown the outside of NYC harder than
i
the uniform lockdown in all the cases.

This manuscript is for review purposes only.

optimal loackdown rate zᵢ*
0.0000

0.20

© Mapbox © OSM

© Mapbox © OSM

© Mapbox © OSM

median of zᵢ* = 0.0656，uniform lockdown (decay matching) =
0.0748

0.4000

COVID-19

SIR

SIS

median of zᵢ* = 0.0606, uniform lockdown (decay matching) =
0.0748

median of zᵢ*= 0.0210, uniform lockdown (decay matching) =
0.0223

(a)
optimal loackdown rate zᵢ*
0.0000

0.155

© Mapbox © OSM

© Mapbox © OSM

© Mapbox © OSM

median of zᵢ* = 0.0785，uniform lockdown (decay matching) =
0.0748

0.3100

COVID-19

SIR

SIS

median of zᵢ* = 0.0782, uniform lockdown (decay matching) =
0.0748

median of zᵢ*= 0.0190, uniform lockdown (decay matching) =
0.0223

(b)
optimal loackdown rate zᵢ*
0.0000

0.155

© Mapbox © OSM

© Mapbox © OSM

© Mapbox © OSM

median of zᵢ* = 0.0781，uniform lockdown (decay matching) =
0.0748

0.3100

COVID-19

SIR

SIS

median of zᵢ* = 0.0781, uniform lockdown (decay matching) =
0.0748

median of zᵢ*= 0.0233, uniform lockdown (decay matching) =
0.0223

(c)

Fig. 17 Experimental results of real data: optimal lockdown rate z∗i given by Theorem 3.6 for SIS, SIR, and COVID-19
model based on available data about COVID-19 outbreak in New York State on April 1st, 2020. The disease parameters
are set as in [23]. The decay rate is chosen as α = 0.2rs = 0.0034 so that α < min(ra , rs ). In a, the cost function is chosen
P
P
as i ci (min( z1i , 10) − 1). In b, the cost function is chosen as i ci (min( z1i , 20) − 1). In c, the cost function is chosen as
P
1
∗
i ci (min( zi , 100) − 1). It can observed that the value of zi for counties in NYC are relatively higher than other counties
in New York State, which implies we should shutdown the58
outside of NYC harder than itself. Besides, the median of z∗i
is greater than or close to the value of the uniform lockdown in all the cases.

This manuscript is for review purposes only.

Table 1 Data used in Figure 1d
Locations

si (t0 )

ri (t0 )

xa (t0 )

xs (t0 )

population

hi

A
B
C

0.90
0.92
0.95

0.0041
0.0033
0.0021

0.0825
0.0660
0.0412

0.0134
0.0107
0.0067

200,000
2000
4000

800
800
800

Table 2 disease parameters from references
Sources

γ

ra

rs



α̂

[8]
[23]
[7]

0.29
0.034
0.20

0.29
0.034
–

0.29
0.017
–

0.14
0.125
0.32

0.55
0.6754
–

Table 3 Optimal lockdown rate z∗i for the City-suburb model. The first node is the city and the second one is the
suburb. It can be observed that the optimal lockdown policy shutdown the suburb more stringently than the city even
though, in cases 1 and 2, the epidemic is mainly localized in the city.
Model

Case 1

Case 2

Case 3

SIS
SIR
COVID-19

[0.195, 0.189]
[0.216, 0.164]
[0.185, 0.141]

[0.196, 0.120]
[0.197, 0.113]
[0.169, 0.098]

[0.170, 0.104]
[0.170, 0.104]
[0.145, 0.089]

11. Supplementary Tables.

59

This manuscript is for review purposes only.

