arXiv:2009.00308v1 [q-bio.PE] 1 Sep 2020

PROPOSAL OF A RECURSIVE COMPARTMENT MODEL OF
EPIDEMICS AND APPLICATIONS TO THE COVID-19
PANDEMIC
MATTHIAS KRECK† , ERHARD SCHOLZ

‡

Abstract. This is work in progress. We make it accessible hoping that people might find the
idea useful. We propose a discrete, recursive 5-compartment model for the spread of epidemics,
which we call SEPIR-model. Under mild assumptions which typically are fulfilled for the Covid19 pandemic it can be used to reproduce the development of an epidemic from a small number of
parameters closely related to the data. We demonstrate this at the development in Germany and
Switzerland. It also allows model predictions assuming nearly constant reproduction numbers.
Thus it might be a useful tool for shedding light on which interventions might be most effective
in the future. In future work we will discuss other aspects of the model and more countries.

1. Introduction
We propose a new model for the development of an epidemic, which we call SEPIR
model. The name stands for 5 compartments which people pass through in the course
of an epidemic, the compartment S of Susceptibles, E of Exposed, P of Propagators,
who infect other people, I of Isolated, either in quarantine or in hospital, and R
of Removed. The most important compartment is I, this occurs in the data sets
under the name “active cases”, the people which are reported to be infected and
are either sent to quarantine or hospital, so we call them isolated. Thus the ”I”
also stands for those counted as infected (but, since in quarantine or hospital, not
infecting others). It is a simple recursive model. We have tried to formulate it such
that also non-mathematicians can read it. The details will be explained in the next
section.
Our motivation is to look for a model, which leads to a good approximation
of the data curves. In order not to overload this text with a bulk of graphics
and data we decide to concentrate on the comparison for two countries, Germany
and Switzerland. The reason for choosing just these is that the documentation
of the data by their health organizations seems to be comparatively reliable. In
future work, which we write together with Harald Grohganz (whom we thank for
programming our model, most of the graphics are made with his program), we will
discuss many other countries and elaborate deeper on some aspects of the model
and its comparison with real data GKS (2020).
Date: August 31, 2020.
†Mathematisches Institut der Universität Bonn and Mathematisches Institut der Universität
Frankfurt, Germany, kreck@math.uni-bonn.de
‡University of Wuppertal, Faculty of Math./Natural Sciences, and Interdisciplinary Centre for
History and Philosophy of Science, scholz@math.uni-wuppertal.de
1

2

M. KRECK, E. SCHOLZ

For the comparison of a model with real data it is crucial to develop methods
which allow to derive the input parameters of the model from the data. We discuss
this in section 3. A model can be useful only if it is possible to distil a small
number of parameters from the data, which allow it to reconstruct or to predict
what happens. There is a fundamental parameter for modelling an epidemic, the
reproduction number. The idea of this number is very simple, namely it is the
number of people that one infected person will pass the virus on to, on average.
It is not easy to read it off from the data (and to our best knowledge there is no
unique answer as one can see from different data sources). In our model we give a
way to determine it. If this number were a constant (and other parameters, which
influence the data, too, like for example the duration people are sent to quarantine),
then a good model should describe or predict the epidemic by equations making
essential use of this input parameter. But as we all know this number is changing.
On the other hand, one observes that there are more or less longer periods where the
reproduction number is approximately constant. During such a period the SEPIR
model gives a good approximation of the development of an epidemic.
In most countries there are longer periods of this type, so that one can use a small
number of corresponding parameters to solve the model equations. In Germany we
observe only 5 such periods between March 25 and August 9, resulting in 5 different
values for the input parameter related to the reproduction number. The following
graphics shows the result (a more detailed description is to be found in the caption
of fig. 4):

This leads to the question whether the SEPIR model can be useful. In periods
where the reproduction number is nearly constant the comparison of our model with
the data curves gives a convincing picture. Assuming that this number remains
constant for a while, one can predict how the development will be. Of course, in
reality the reproduction number may be considered constant only for limited periods.

RECURSIVE COMPARTMENT MODEL

3

There is a critical moment, namely when the reproduction number falls from
above below 1 or passes 1 from below. This is the moment where the SEPIR model
shows its full power. In Germany the reproduction number fell below 1 at March
25 for the first time. The SEPIR model uses a constant input parameter for the
reproduction number between March 25 and a little bit more than a month later
(see box on page 11). Even then the model curve gives a good approximation of the
data as shown in the figure above (or fig. 4). So, in this situation, the SEPIR model
is a good approximation of the data curves and for a long period (assuming that
the reproduction number is nearly constant), one obtains good predictions. We will
discuss this in section 4.
Another use which we discuss in section 4 is that the SEPIR model can be a
tool for controlling an epidemic via trial and error. The ability to look into the
near future via the model allows to impose restrictions which hopefully push the
reproduction number down and, after 10 - 14 days, one can check the success of
these measures by applying the SEPIR model again.
Harald Grohganz has written a program which everybody can use to compute
the development of Covid-19 for a period of 4 weeks starting with an arbitrary date
between April 3 and the actual day. Based on the data available 5 days before
this date (based on the process of the infection about 10 days before) one can
see how the number of isolated people changes https://www.hcm.uni-bonn.de/
homepages/prof-dr-matthias-kreck/modelling-epidemics/.
2. The approximative SEPIR compartment model
The idea of our model is very simple. We observe 5 compartments which we call
S, E, P , I, R, which people pass through in this order: Susceptibles in compartment
S move to compartment E, where they are exposed but not infectious, after they
are infected by people from compartment P , which are propagating the virus. From
compartment P they are sent to quarantine or hospital after they observe symptoms.
So we call them isolated and denote this compartment by I. The notation I is a
bit misleading, since it is often used for the infected people. What me mean is
the people who are called active cases in the worldometer form the John Hopkins
University and other data resources. From compartment I they finally move to
compartment R after removal (recovery or death). Given the duration the people
are members of the different compartments, one can count the number of people
in the corresponding compartments recursively and this is our SEPIR model. One
might call it a delay model. The model is just a picture of what is happening in
reality making the usual simplifying assumptions, in particular that averaging is
allowed due to the large numbers involved. The scheme of the model is:
S→E→P →I→R
We call this model the recursive SEP IR model.
This schematic picture describes the model in general. We assume for our model
that if P (k) denotes the number of persons actively propagating the virus there is a
time dependent parameter a(k) called the infection rate such that we get a number

M. KRECK, E. SCHOLZ

4

of additional exposed people at day k, which we denote by Eadd (k):
(1)

Eadd (k) = (1 − (1 − a(k − 1)/N )P (k−1) )S(k − 1)

Here N is the total number of the population. This needs an explanation. For this
we make the standard assumption that a single infected infects α(k) · S(k) of the
susceptible people, where α(k) measures the strength of the infection at day k. If we
have more infected, they have to “share” the susceptibles. For example if there are
two infected the first infects α(k)·S(k) and so the other one has only S(k)−α(k)·S(k)
susceptibles remaining. This leads to an addition of α(k)(S(k)−α(k)·S(k)) infected
people, which gives (α(k) + α(k) − α(k)2 )S(k) = (1 − (1 − α(k))2 )S(k). More
generally, if there are P (k) infectious people we assume inductively that P (k) − 1
infect (1 − (1 − α(k))P (k)−1 )S(k) people and so for the last there are only S(k)(1 −
(1 − (1 − α(k))P (k)−1 ) = S(k)(1 − α)P (k)−1 susceptibles remaining leading to a total
of S(k)(1 − (1 − α(k))P (k)−1 + α(k)(1 − α(k))P (k)−1 )) = S(k)(1 − (1 − α(k))P (k) )
infected people. Finally we renorm α(k) and replace if by a(k)
, where N is total
N
number of the population. This leads to the formula above. For small a(k)
the
N
formula is approximately equal to the simpler formula
(2)

Eadd (k) ≈

a(k − 1)
P (k − 1)S(k − 1) = a(k − 1) s(k − 1) P (k − 1) ,
N

, which we will frequently use. At the beginning of an epidemic
with s(k) = S(k)
N
the value of s(k) is s(k) ≈ 1, which leads to the approximative formula mentioned
above:
Eadd (k) ≈ a(k − 1)P (k − 1)
We would like to stress that this is the only place in an epidemic where new people
are added to compartments E, P , I and R. Namely at day k the number of exposed
people is equal to the number at day k − 1 plus the additional exposed people at
day k minus those which move to the next compartment P . These are the people
who were exposed at day k − e. We express this in the formula:
(3)

E(k) = E(k − 1) + Eadd (k) − Eadd (k − e)

Similarly at day k we have additional propagating people, whose number we
denote by Padd (k), which is equal to those people leaving compartment E at day k,
which are the people who were additionally exposed at day k − e, so
Padd (k) = Eadd (k − e).
Like for compartment E we obtain the recursive formula
P (k) = P (k − 1) + Padd (k) − Padd (k − p) = P (k − 1) + Eadd (k − e) − Eadd (k − e − p).
The same happens with compartment I leading to the formula:
Iadd (k) = Padd (k − p)

RECURSIVE COMPARTMENT MODEL

5

and using the formula for Padd we obtain:

(4)

I(k) = I(k − 1) + Iadd (k) − Iadd (k − q)
= I(k − 1) + Padd (k − p) − Padd (k − p − q)
= I(k − 1) + Eadd (k − e − p) − Eadd (k − e − p − q)

For the compartment R we apply the same principle and leave the details to the
reader, but there is a difference, since there is no other compartment to which the
people move, they stay for all times. Thus the recursive formula for R is:
R(k) = R(k − 1) + Eadd (k − e − p − q)

(5)
Finally we recall that

S(k) = N − E(k) − P (k) − I(k) − R(k),
where N is the total number of the population.
Summarizing the formulas above yields our recursive SEPIR model:
The SEPIR model: Let e, p, q be integers standing for the duration of staying in
the corresponding compartments. The quantities S(k), E(k), Eadd (k), P (k), I(k), R(k)
of the SEPIR model are given by
a) the start condition:
Eadd (0) = E(0) = E0 , a given number of exposed at day 0,
P (k) = I(k) = R(k) = 0 for k ≤ 0,
Eadd (k) = E(k) = 0 for k < 0
b) and the recursion:
Eadd (k)
E(k)
P (k)
I(k)
R(k)
S(k)

=
=
=
=
=
=

(1 − (1 − a(k − 1)/N )P (k−1) )S(k − 1)
E(k − 1) + Eadd (k) − Eadd (k − e)
P (k − 1) + Eadd (k − e) − Eadd (k − e − p)
I(k − 1) + Eadd (k − e − p) − Eadd (k − e − p − q)
R(k − 1) + Eadd (k − e − p − q)
N − E(k) − P (k) − I(k) − R(k)

As one can see it is easy to program the model. The start condition of the
recursion has to be worked out carefully. We will say more about this later.
Before we move to a comparison of the model with data we would like to discuss
the role of the parameters a(k), e, p, q, which is rather different. All these parameters
are a priory time dependent, but we assume for this text that e, p, and q are constant.
The parameter e is close to a biological datum which depends on the virus, whereas
the parameter p results from a mixture of a biological datum and political decisions
concerning quarantine regulations.
The parameter a(k) is central for the recursion and we will derive it from the
data. If one wants to apply the model for looking into the future one has to make
assumptions about a(k). We observe from the data, that the value for a(k) fluctuates
a lot during the first days. But after some time, when the number of infected people
gets large, we see periods where a(k) is nearly constant for most countries. In these

6

M. KRECK, E. SCHOLZ

periods we actually chose a(k) as a constant value. These are the periods where one
can make predictions (although all predictions have to be treated with reservations).
The choice of the parameter q is a bit mysterious. To a large extent it depends on
how good the data are reported. We observe in several countries that there are good
reasons to assume that recovered or dead people are reported with a delay which
one either has to reflect by choosing time dependent values for q or by adjusting the
number of removed people. In the countries we will discuss here in part I we don’t
observe this phenomenon and work with constant q.
At any rate the role of q is problematic and so it is good to observe that at
least as long as S(k) is approximately equal to the number of the population N
or equivalently s(k) = S(k)/N ≈ 1 (which in all countries is fortunately the case
so far) there is a function which doesn’t depend on q. This is the total number of
infected until a given day k denoted by Itot (k). This is the sum of I(k) and R(k):
Itot (k) = I(k) + R(k)
Using our formulas from the SEPIR model we conclude:
Itot (k) = Itot (k − 1) + Eadd (k − e − p),
so Itot (k) only depends on a(k), e, p and s(k) = S(k)/N , which occurs in the
formula for Eadd (k). So Itot (k) only depends on a(k), e, p and not on q, if s(k) ≈ 1.
Fortunately Itot (k) is the datum in an epidemic, which together with the number
of newly infected is probably best documented. More precisely, the best reported
empirical data is the number of newly infected at a day k, which we denote by
Inew (k) and its relation to Itot (k) is that Itot (k) = Itot (k − 1) + Inew (k).
To distinguish the model function Itot (k) from the function occurring in the data
corresponding to it, we give the the data values a different symbol and denote it by
Iˆtot (k). In general we decorate the data values corresponding to our model functions
ˆ
with a roof, e.g. I(k),
Iˆnew (k) and R̂(k).
There is an obvious question for any model which reflects the reported data only.
The latter do not include information about asymptomatic infected and/or uncounted symptomatically infected. If such information is available it is unreliable
(first) or unknowable on principle (second). In our model, and our data analysis, we do as if they don’t exist. The following consideration is a justification
for this. Suppose that there is a function h(k) (like percentage of hidden infectious people) such that for any day k there are h(k)P (k) people who are infectious
but never show up in the data. It is not clear that the strength of infection is
the same as for people with symptoms, so we take it as a separate parameter denoted by ah (k). Then the correct approximative formula for Eadd is Eadd (k) ≈
a(k − 1)(P (k − 1) + ah (k − 1)h(k − 1)P (k) = (a(k − 1) + ah (k − 1)h(k − 1))P (k − 1).
Thus the hidden people just lead to an enlargement of the strength of infection and
the model works with parameter a(k − 1) + ah (k − 1)h(k − 1). Thus we can do as
if these people don’t exist.
But there is another parameter, namely p, which might be influenced by the
asymptomatically infected people and their strength of infection. One might wonder,
whether the SEPIR model can be used to shed some light on this question. As

RECURSIVE COMPARTMENT MODEL

7

mentioned above Iˆnew (k) seem to be the best documented empirical data on an
epidemic, so it plays a central role. We derive the most fundamental input into our
model, a(k), from the Iˆnew (k). We explain this in section 3.
An important parameter for all models is what is called the reproduction number.
This is the number of people that one infected person will pass the virus on to, on
average. Since we assume that only people in compartment P are propagating the
virus and each day a single person in compartment P infects approximately a(k)
people, we identify the reproduction number in our model as R(k) := p a(k).
3. Reconstruction of the parameters from the data
Although we are convinced that already the assumptions on which the SEPIR
model are based are closely related to reality and so it has a good chance to model
the reality, the final test is, as with all models, the comparison with the data. The
challenges which are posed to all models are the following:
– Find a method how to derive the (time dependent) input parameters from
the data set.
– Find time intervals where the input parameters are nearly constant and check
whether the model curves are approximatively equal to the data curves. The
longer these intervals are the more useful the model is, for these are the
periods where one can use the model for predictions.
We assume e = 4 and p = 5 as constant durations for all countries we deal here
with, although one may also like to consider different values and to check the consequences for the model predictions. We plan do to so in a forthcoming paper (GKS,
2020). The number e is a medical datum, p is the sum of the mean duration of
infectiousness without symptoms, estimated as 2 days, and the average time delay
between the observation of symptoms and the beginning of the quarantine, which
for the chosen countries should not be longer than about 3 days.1 This leads us to
the estimated value 5 for p. A check of the model performing approximations for
Switzerland and South-Korea with different values for p indicates an optimum of
the approximation for p between 4 and 6. In addition we tried out smaller values
for e and found that this makes the model unstable in respect to the optimization
(described below) of the intervals, where a(k) is approximatively constant. And
making p large leads to unnatural fluctuations. In the light of the general quarantine regulations in many countries and the overall (numerical) dominance of weakly
infected persons, we expect q to be about 14 or 15 but check the reliability of this
expectation in an initial analysis of the data. In some countries it turns out to be
larger and in some cases even time dependent. We will discuss the choices of the
parameters e, p, and q more carefully in future work.
The most delicate and central input of our model are the parameters a(k). They
are derived from the daily reported number of newly infected Iˆnew (k). We actually
replace the data Iˆnew (k) by the 3 days average, which we call I˜new (k). The effect is
1Compare

(Qun Li, 2020) and https://www.rki.de/DE/Content/InfAZ/N/Neuartiges_
Coronavirus/Steckbrief .

8

M. KRECK, E. SCHOLZ

that we reduce the sometimes enormous jumps of the number of newly infected. The
I˜new (k) correspond to the Inew (k) in our model. The model tells how to derive the
parameters a(k) from the numbers I˜new (k). As before we give the numbers which
result from the data a different name and call them ā(k).
Because of the time delay between the infection at day k, resulting in Eadd (k) and
its visibility in the number of registered infected, the infection is expressed by the
number of registered newly infected Inew (k+e+p). The number of actively infectious
persons at t = k, i.e. those in the compartment P at this day, is the sum of persons
who have themselves been newly infected at a day k − (e + j) for j = 0, . . . , p − 1.
They appear p + e days later as visibly new infected, i.e. as Inew (k + p − j). Using
I˜new (k) instead of Inew (k) in our model the equations of the model determine the
values for ā(k) (under the assumption s(k) = S(k)
≈ 1):
N
(6)

I˜new (k + e + p)
.
ā(k) := Pp−1
ˆ
j=0 Inew (k + p − j)

Now we begin with the determination of the time intervals. We fix the first day
from which on we determine ā(k) and call it t0 = 1 as the day where for the first
time the number of newly infected people Iˆnew (k) is > 0 for at least e + p days.
As an effect of the restrictions imposed by governments, ā(k) starts to decay after
a few days and, hopefully, falls until it reaches a value approximately equal to 0.2.
Assuming p = 5 this corresponds to a reproduction number R(k) = 5 ā(k) ≈ 1. We
denote the first day where ā(k) ≤ 0.2 by t1 . For many countries one can observe that
after day t1 , where the reproduction number is approximatively equal to 1, periods of
considerable length follow, for which ā(k) is approximately constant. These periods
are modelled by intervals A1 = [t1 , t2 ), A2 = [t2 , t3 ), A3 = [t3 , t4 ) and so on, which
we consider as our main intervals. In in these periods our model can work with
constant values of the a(k) determined from the I˜new (k) in a systematic way.
The determination of the main intervals is a delicate step which we will comment
upon later. Before we do so, we explain how we treat the interval [t0 , t1 ). Since our
model is a recursive one we need values for Eadd for at least e + p days before the
day t0 to get the model started. These e + p days play the role of an electric engine
starter, which is needed at the beginning until the engine runs smoothly. We choose
ˆ starting from k = 1 and shift them e+p days back. If we
the first e+p values of I(k)
set all the a(k) = 0 for k < 0 and consider a(0) = a0 as a free parameter this gives
the necessary information to start the model recursion at t0 = 1 for any value of a0 .
In the end we look for the value of a0 for which the resulting model curve for Itot (k)
using the daily values for ā(k) comes closest to the empirical curve Iˆtot (k); closest
in the sense of minimizing the distance between Itot and Iˆtot , using the root mean
square error RMSE(Itot ) as the criterion. Since we have here a single free parameter
this can easily be found either by computer or by hand. This determines our start
value. We have chosen RMSE (Itot ) for the measure since this is independent of the
more problematic parameter q. Once we know the start value we model the interval
from t0 to t1 using the daily values for ā(k). Using the daily strongly varying values

RECURSIVE COMPARTMENT MODEL

9

for ā(k) in this interval and no longer intervals implies that in the interval between
t0 and t1 model predictions are impossible.
Now we discuss the determination of the main intervals starting from t1 . The hope
is to find a small number of main intervals which still leads to a good approximation.
The basic idea is the following. Fix a number m of main intervals and minimize
RMSE (Itot ) under this condition. There are standard methods how to solve such an
optimization problem. But there are simple by hand methods, where the number
m is left open. First look at the curve for ā(k) and check whether there are points,
where the curves makes obvious bigger jumps. Chose a point close to each of these
obvious jumps and call them “jump points”. Compute the model curves and the
RMSE (Itot ) using the intervals given by the jump points, the beginnig t1 and the
end of the period you would like to model. Now divide one after the other the
resulting intervals in the middle, unless their length is less than 10. For each new
interval end compare the RMSE (Itot ) with the previous value. If this is almost the
same, remove the new interval end. Otherwise move the middle point to the left or
right until the RMSE (Itot ) reaches the minimum. Now consider the next interval
and do the same and so on. At the end make a fine tuning by moving the interval
points a bit until one reaches a minimum for RMSE (Itot ).

4. Modelling Covid-19 for Germany and Switzerland
We demonstrate this ad hoc method by looking at Germany and Switzerland.
The data we are using stem from John Hopkins University (JHU).2

Basic parameters D, CH
e p
q
4 5
15

2For

most countries we use the humdata repository of JHU directly https://data.humdata.
org/dataset/novel-coronavirus-2019-ncov-cases. For Switzerland we use the corresponding
time series contained in the Mathematica resources for Covid-19. They agree basically with
the JHU data; for information see https://datarepository.wolframcloud.com/resources/
Epidemic-Data-for-Novel-Coronavirus-COVID-19.

M. KRECK, E. SCHOLZ

10

For Germany (D) the day t0 at which the number of newly infected becomes nonsporadic, i.e. without interruptions of days with no newly infected, is Feb. 25, 2020.
Here we start our count of days, t0 = 1. The ā(k) values for Germany, determined
according to equation (6), are shown in figure 1.

Figure 1.

Infection rates ā(k) for Germany, Mar 25, 2020, is the first day t1 with infection
rate below 0.2. It is parametrized by k = 30; here ā(30) = 0.158.

The first day with ā(k) ≤ 0.2 is March 25, t1 = 30; the end of data for the following
consideration is k = 170 (August 12, 2020). The optimal start value for Germany
is a0 = 2.665. With the start condition explained above the recursion with day by
day changing model values according to the empirical data, a(k) = ā(k), leads to a
result shown in figure 2.

Figure 2.

SEPIR model curves (unbroken lines) and JHU data (dots) for the confirmed
cases Itot and the actually infected I for Germany. Model curves here determined with daily
changing a(k) = ā(k) for optimal start condition explained in the main text with a0 = 2.665. In
the headline the root of mean square difference (RMSE) of the Itot , I and Inew (not depicted)
to the corrsponding JHU values are given.

RECURSIVE COMPARTMENT MODEL

11

If we let the total period end at day k = 170, one sees just two obvious jump
points at k = 132, 142, i.e. around June 8, this is about 9 days before a hotspot in
a German meat factory became apparent in the Iˆnew , so that about 7000 employees
and their families had to be sent into quarantine for two weeks (the Tönnies case).
With these four values k = 30, 132, 142, 170 the RMSE (Itot ) becomes 19548. Now
add the new interval end 66; then RMSE (Itot ) = 9209. Moving this end to the
right gives a worse value, while moving it to the left gives improvements each time
until the optimum is reached at 62, where RMSE (Itot ) = 7516. Now introduce a
new interval end 141, then RMSE (Itot ) = 5387. Moving this point to the right
gives worse values, while moving it to the left improves the values each step until
an optimum is reached for 132 with RMSE (Itot ) = 5071. A fine tuning by slightly
moving the interval ends leads to the interval ends 30, 65, 103, 110, 132, 170 with
RMSE (Itot ) = 2019.
The dates of the partition points of the time-line are given in the following table.
The mean values aj of the ā(k) in the respective intervals [tj , tj+1 ) and the empirical
standard deviation follow.

Time partion SEPIR model Germany
t0 (k = 1) t1 (k = 30) t2 (k = 65) t3 (k = 103) t4 (k = 110) t5 (k = 132) t6 (k = 170)
02/25
03/25
04/29
06/06
06/13
07/05
08/12
SEPIR infection rates ai (±σ) (standard deviation) in main intervals for Germany
a1
a2
a3
a4
a5
0.139 (±0.024) 0.160 (±0.047) 0.459 ± (0.140) 0.167 (±0.028))
0.260 (±0.038)

M. KRECK, E. SCHOLZ

12

Figure 3 shows the model values aj in the main intervalus in comparison with the
the daily values of the ā(k).

Figure 3.

Infection rates ā(k) for Germany and model values aj in the main intervals (see table)

Figure 4 shows a picture of the resulting model curves for Itot and I.

Figure 4. The SEPIR model for Germany with a0 = 2.665 and main interval ends
30, 65, 103, 110, 132, 170 starting with t1 = 30 (Mar 25, 2020). Itot blue, I red; continuous
lines model values, (fat) dots JHU data.

RECURSIVE COMPARTMENT MODEL

13

If one applies the same method to Switzerland (CH) one finds that the conditions
for t0 are satisfied February 29, 2020, while March 18 is the day t1 , i.e. t1 = 19. The
values for the ā(k) (including the model values aj in the main intervals) are shown
in figure 5.

Figure 5. Infection rates ā(k) for Switzerland, Mar 29, 2020, is the first day t1 = 28 with
infection rate below 0.2 with here ā(28) =: 0.491.
The optimal start value for the recursion is a0 = 0.491. The resulting model curve
with daily values ā(k) are shown in figure 6.

Figure 6.

SEPIR model curves (unbroken lines) and JHU data (dots) for the confirmed
cases Itot and the actually infected I for Switzerland. Model curves are here determined with
daily changing a(k) = ā(k) for optimal start condition explained in the main text with a0 = 0.491.

Here it is not so obvious to find jump points, but one might make a first try with
k = 19, 35, 71, 99, 131, 159. Playing for a while yields a good approximation with
jump points at k = 19, 32, 65, 91, 110, 159. The resulting time partition and the
model values aj in the intervals [tj , tj+1 ) are shown in the following tables.
Time partition SEPIR Switzerland
t0 (k = 1) t1 (k = 19) t2 (k = 32) t3 (k = 65) t4 (k = 91) t5 (k = 110) t6 (k = 159)
02/29
03/18
03/31
05/03
05/30
06/17
07/27
SEPIR infection rates ai (±σ) (standard deviation) in main intervals for Switzerland
a1
a2
a3
a4
a5
0.164 (±0.020) 0.113 (±0.20) 0.147 ± (0.046) 0.277 (±0.077))
0.265 (±0.90)

M. KRECK, E. SCHOLZ

14

The resulting model curves are shown in (figure 7).

Figure 7. The SEPIR model for Switzerland with a0 = 0.491 and main interval ends 28,
44, 80, 108, 140, 168 starting with t1 = 28 (Mar 29, 2020). Itot blue, I red; continuous lines
model values, (fat) dots JHU data.
It is likely that one can obtain better results by applying optimization algorithms.
But the results of this ad hoc method are good enough to demonstrate the use of
the SEPIR model.
Summarizing we have clear methods how to read off intervals where the infection
rate ā(k) measuring the strength of the infection is approximately constant and to
derive the value of a(k) during these intervals from the data. This can be used to
model the epidemic of the different countries.
5. Use of the SEP IR model
5.1. Model based views into the future. The first question people want to know
from a new model is what it tells about the future. The natural answer is: That
depends on how the people behave. The next question then may be: Assume that
they have behaved more or less the same in the near past;3 what does the model
predict, if people don’t change their behavior in the (near) future?
For example if we consider the data curve shown for Germany above and ask this
question around March 15, then the answer is clear: The assumption that the people
have behaved the same in the near past would not be realistic. For about 9 days
before March 15 the values for ā(k) change dramatically day by day (fig. 1).
If the people would have asked this question in the first days of April, on the other
hand, things would have been different. The situation accessible to the observational
data at this date (i.e., the values of ā(k) for the period e+p = 9 days earlier) started
to be sufficiently stable for daring a model based prediction. They would contain
the data on March 25, 2020 the day t1 = 30 at which the reproduction number for
3As

one often hears from epidemiologists the data of a given day reflect the infection process
abut 10 – 14 days earlier. In our notation this is the period e + p days before the actual date, since
only after this many days exposed persons develop symptoms and are counted as infected.

RECURSIVE COMPARTMENT MODEL

15

Germany fell below 1 for the first time (ā(t1 ) = 0.173). 9 days later, i.e. on April
3, this became visible in the Iˆnew (k); and it stayed so for the following days (in
fact until May 25). If one would have dared a provisional look into the future with
SEPIR based on the data ā(k) for the three days starting with t1 (April 3 – 5 with
k = 39 to 41), all of them below 0.2, the SEPIR model curve would clearly indicate
ˆ
that the I(k)-curve
was already close to the peak value, which one could expect in
the next few days (figure 8).
200 000

200 000

200 000

150 000

150 000

150 000

100 000

100 000

100 000

50 000

50 000

50 000

0

Mar 30

Apr 06

0

Apr 13

Mar 30

Apr 06

Apr 13

Apr 20

0
Mar 30

200 000

200 000

200 000

150 000

150 000

150 000

100 000

100 000

100 000

50 000

50 000

50 000

0

Apr 06

Apr 13

Apr 20

Apr 27

0

Apr 06

Apr 13

Apr 20

Apr 27

0

Apr 06

Apr 06

Apr 13

Apr 13

Apr 20

Apr 20

Apr 27

May 04

SEPIR pedictions for I(t) on the basis of the data for Iˆnew of 5 days ending in
dates ta ; top: ta = Mar 31, Apr 02, Apr 04; bottom ta = Apr 06, Apr 08, Apr 10; blue dots
ˆ
JHU data I(t)

Figure 8.

So the model prediction is not so far away from the data curves. As said above
the data ā(k) values for March 24-26 are only reflected in the data about 10 day
later, April 3 - 5. This is almost the time, when the Iˆ curve reaches the peak. But
ˆ
even at that day it was not obvious from the development of the I-curve
that the
peak would be reached so soon.
5.2. The SEP IR-model as a tool for trial and error. The natural way to
control a process is to use all information available to estimate the effects of a
restriction in advance. Even if one can learn from the past to get some feeling for the
effects of restriction there will remain a great uncertainty. In such a situation one will
apply trial and error – if there is enough time. This was not the case in March 2020,
since, besides having no experience which measure has which effect, the development
was too fast. But in the future there is, generally speaking, more control because
the numbers increase slower. For example in Germany the reproduction number is
above 1 since July 5, leading to a second wave if not stopped by exterior means.
But the increase is much slower (SEPIR reproduction rate ≈ 1.3 in comparison to
R ≥ 2 in March).

16

M. KRECK, E. SCHOLZ

Figure 9 takes a look into the future based on the data during 2 weeks before
August 5, 2020.

Figure 9. SEPIR preview computed on the basis of data available 2
weeks before August 5, 2020

According to this prediction the number of actually infected would be almost
68000 by the end of September 2020, if no additional restriction measures are imposed in late August, early September. This number is close to the peak at the
beginning of April, which was reached within about 3 weeks. The data on mid August, available at the end of the month, seem to indicate a more relaxed situation
(consult the website given below and check the dates August 28 – 31).
So trial and error is possible, even if the effects of a restriction are only visible in
the data about 10 days later. Combined with some knowledge about the influence
of restrictions this might allow politicians to look at the future using the SEPIR
model based on the present reproduction number, impose a restriction which based
on experience in the past lowers the reproduction number to a level desired. After
10 days one will see the effect and using the model again one can take a view
into the future. If like at the beginning of April this shows a quick reach of the
peak, the restriction was successful, otherwise there is enough time to impose more
restrictions.
Harald Grohganz has written a program which everybody can use to compute
the development of Covid-19 for a period of 4 weeks starting with an arbitrary date
between April 3 and the actual day. Based on the data available 5 days before
this date (based on the process of the infection about 10 days before) one can see
how the number of isolated people changes; see https://www.hcm.uni-bonn.de/
homepages/prof-dr-matthias-kreck/modelling-epidemics/.

RECURSIVE COMPARTMENT MODEL

17

In the final phase of our work we came across the paper (Balabdaoui, 2020) which,
independently, follows a similar approach. The authors also use a recursive model
with additional compartments and a stratification into different age layers adapted
to the Swiss context. Our model is simpler and can be adapted to different contexts
more easily. For the Swiss case the basic results of the models seem to be sufficiently
close to trust our simple approach.
We would like to thank Harald Grohganz for invaluable help programming our
different approaches quickly, and also for several helpful comments. We are very
grateful to Odo Diekmann. He was willing to discuss our thoughts as non-experts
and helped us to understand compartment models better, gave hints and corrected
mistakes here and there. Finally we would like to thank Stephan Luckhaus and
Viola Priesemann for stimulating exchanges.

References
Balabdaoui, Fadoua; Mohr, Dirk. 2020. “Age-stratified model of the COVID-19 epidemic
to analyze the impact of relaxing lockdown measures: nowcasting and forecasting for
Switzerland.” Preprint medRχciv.
URL: https://www.medrxiv.org/content/10.1101/2020.05.08.20095059v2
Grohganz, Harald; Kreck, Matthias; Scholz, Erhard 2020. A recursive compartment model
of epidemics and its applications to the covid-19 pandemic. In preparation.
Qun Li, Xuhua Guan, Pen Wu et al. 2020. “The early transmission dynamics in Wuhan,
China, of novel Coronavirus-infected pneumonia.” New England Journal of Medicine
382(382):1199–1207.

