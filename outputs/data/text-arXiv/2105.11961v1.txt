rsta.royalsocietypublishing.org

Research

A statistical model of
COVID-19 testing in
populations: effects of
sampling bias and testing
errors
Lucas Böttcher1,2 , Maria R. D’Orsogna3,1

arXiv:2105.11961v1 [stat.AP] 24 May 2021

Article submitted to journal

Subject Areas:
Epidemiology, Medical Statistics,
Applied Mathematics

and Tom Chou1,4
1 Dept. of Computational Medicine, University of

California, Los Angeles, 90095-1766, Los Angeles,
CA, United States
2 Computational Social Science, Frankfurt School of

Keywords:

Finance and Management, 60322 Frankfurt am Main,

COVID-19, testing, combinatorics

Germany
3 Dept. of Mathematics, California State University at

Author for correspondence:

Northridge, Los Angeles, 91330-8313, CA, United

Lucas Böttcher

States

e-mail: lucasb@g.ucla.edu

4 Dept. of Mathematics, University of California, Los

Angeles, 90095-1766, Los Angeles, CA, United States
We develop a statistical model for the testing of
disease prevalence in a population. The model
assumes a binary test result, positive or negative, but
allows for biases in sample selection and both type
I (false positive) and type II (false negative) testing
errors. Our model also incorporates multiple test
types and is able to distinguish between retesting and
exclusion after testing. Our quantitative framework
allows us to directly interpret testing results as a
function of errors and biases. By applying our testing
model to COVID-19 testing data and actual case data
from specific jurisdictions, we are able to estimate and
provide uncertainty quantification of indices that are
crucial in a pandemic, such as disease prevalence and
fatality ratios.

© The Authors. Published by the Royal Society under the terms of the
Creative Commons Attribution License http://creativecommons.org/licenses/
by/4.0/, which permits unrestricted use, provided the original author and
source are credited.

1. Introduction

2

rsta.royalsocietypublishing.org Phil. Trans. R. Soc. A 0000000
..................................................................

Real-time estimation of the level of infection in a population is important for assessing the severity
of an epidemic as well as for guiding mitigation strategies. However, inferring disease prevalence
via patient testing is challenging due to testing inaccuracies, testing biases, and heterogeneous
and dynamically evolving populations and severity of the disease.
There are two major classes of tests that are used to detect previous and current SARS-CoV-2
infections [1]. Serological, or antibody, tests measure the concentration of antibodies in infected
and recovered individuals. Since antibodies are generated as a part of the adaptive immune
system response, it takes time for detectable antibody concentrations to develop. Serological tests
should thus not be used as the only method to detect acute SARS-CoV-2 infections. An alternative
testing method is provided by viral-load or antigen tests, such as reverse transcription polymerase
chain reaction (RT-PCR), enzyme-linked immunosorbent assay (ELISA), and rapid antigen tests,
which are able to identify ongoing SARS-CoV-2 infections by directly detecting SARS-CoV-2
nucleic acid or antigen.
Test results are mainly reported as binary values (0 or 1, negative or positive) and often do not
include further information such as the cycle threshold (Ct) for RT-PCR tests. The cycle threshold
Ct defines the minimum number of PCR cycles at which amplified viral RNA becomes detectable.
Large values of Ct indicate low viral loads in the specimen. An increase in Ct by a factor of about
3.3 corresponds to a viral load that is about one order of magnitude lower [2]. Cycle threshold
cutoffs are not standardized across jurisdictions and range from values between 37 − 40, making
it difficult to compare RT-PCR test results [3]. Lower Ct cutoffs in the range of 30 − 35 may be
more reasonable to avoid classifying individuals with insignificant viral loads as positive [3].
Further uncertainty in COVID-19 test results arises from different type I errors (false positives)
and type II errors (false negatives) that are associated with different assays. Note that inherent to
any test, the threshold (such as Ct mentioned above) may be tunable. Therefore, besides intrinsic
physical limitations, binary classification of “continuous-valued” readouts (e.g., viral load) may
also lead to an overall error of either type [4]. In this work, we will assume that there is a
standardized threshold and the test readout is binary; if any virus is detected, the test subject
is positive. We will not explicitly model the underlying statistics of the errors but assume that
the test readouts are binary but can be erroneous at specified rates. Some uninfected individuals
will be wrongly classified as infected with rate FPR and some infected individuals will be
wrongly classified as uninfected with rate FNR. For serological COVID-19 tests, the estimated
proportions of false positives and false negatives are relatively low, with FPR ≈ 0.02 − 0.07
and FNR ≈ 0.02 − 0.16 [5–8]. The FNRs of RT-PCR tests depend strongly on the actual assay
method [9,10] and may be significantly larger than those of serological tests. Typical values of
FNR for RT-PCR tests lie between 0.1 and 0.3 [11,12] but might be as high as FNR ≈ 0.68 if
throat swabs are used [7,12]. False-negative rates may also vary significantly depending on the
time delay between initial infection and testing [8]. According to a systematic review [13] that
was conducted worldwide, the initial value of FNR is about 0.54, underlying the importance
of retesting. Similar to serological tests, reported false-positive rates of RT-PCR tests are about
FPR = 0.05 [7].
Estimates of disease prevalence and other surveillance metrics [14,15] need to account for
FPRs and FNRs, in particular if reported positive-testing rates [16] are in the few percent
range and potentially dominated by type I errors. In addition to type-I/II testing errors, another
confounding effect is biased testing [17], that is, preferential testing of individuals that are
expected to carry a high viral load (e.g., symptomatic and hospitalized individuals). Biasing
testing towards certain demographic and risk groups leads to additional errors in disease
prevalence estimates that need to be corrected for.
To account for type-I/II errors, bias, retesting and exclusion after testing, we develop a
corresponding framework for disease testing in Sec. 2. We apply our testing model to COVID-19
testing and case data in Sec. 3 and estimate testing bias by comparing random-sampling testing

data [18] with officially reported, biased COVID-19 case data in Sec. 4. We conclude our study in
Sec. 5.

Here, and in the following subsections, we develop a general statistical model for estimating the
number of infected individuals in a jurisdiction by testing a sample population. The relevant
variables and parameters to be used in our derivations are listed and defined in Table 1.

symbol

definition

N ∈ Z+

population in jurisdiction

Q : [0, N ]

number of tests administered

Q+ : [0, Q]

recorded positives under error-free testing

Q̃+ : [0, Q]

recorded positives under error-prone testing

f : [0, 1]

true proportion of infected individuals

fb := Q+ /Q : [0, 1]

fraction of positives under biased, error-free testing

f˜b := Q̃+ /Q : [0, 1]

fraction of positives under biased, error-prone testing

b∈R

testing bias parameter

b̂, fˆ : [0, 1]

estimates of bias and underlying infection fraction

FPR : [0, 1]

false positive rate

FNR : [0, 1]

false negative rate

Table 1. Overview of variables used in testing model. An overview of the main variables and parameters that will be
used in developing our testing model. The sets [0, N ] and [0, Q] contain all integers from 0 up to Q and N , respectively.
The set f, fb , f˜b : [0, 1] denotes all rational numbers between 0 and 1. For FNR, FPR, [0, 1] represents all real
numbers between 0 and 1. We assume that Q, Q+ , Q̃+ , fb := Q+ /Q, and f˜b := Q̃+ /Q are determined by testing
a population of known size N .

Suppose we randomly administer Q tests within a particular short time period (e.g., within
one day or one week) to a total effective population of N previously untested individuals. This
population of individuals is comprised of S susceptible, I infected, and R removed (i.e., recovered
or deceased) individuals, which are unknown. S, I, and R can dynamically change from one
testing period to another due to transmission and recovery dynamics, as well as removal from
the untested pool by virtue of being tested. The total population N = S + I + R can also change
through intrinsic population dynamics (birth, death, and immigration), but can assumed to be
constant over the typical time scale of an epidemic that does not cause mass death.
We start the derivation of our statistical model by first fixing S, I and R, assuming both perfect
error-free testing, considering a “testing with replacement” scenario, in which tested individuals
can be retested within the same time window. Under these conditions, the probability that q tests

rsta.royalsocietypublishing.org Phil. Trans. R. Soc. A 0000000
..................................................................

2. Statistical testing model

3

4

(2.1)

where the parameter
(I + R)
I
or
,
(2.2)
N
N
are simply the probabilities of identifying currently and previously infected individuals with
tests such as serological (antibody) tests, or of detecting current infections with viral load tests,
respectively. Note that testing with replacement renders Ptrue dependent only on Q and f , and
not explicitly on I, S, R or N . The binomial expression 2.1 is accurate when the number of tests
are much smaller than the population (I + R) or I.
Equation 2.1 describes perfect error-free and random testing. However, if there is some
prior suspicion of being infected, the administration of testing may be biased. For example,
certain jurisdictions focus testing primarily on hospitalized patients and people with significant
symptoms [17], thus biasing the tests to those that are infected. We quantify such testing biases
through a biased-testing function B(Q+ ) ∈ R≥0 , leading to the following modification of Eq. 2.1:
f≡

+

Ptrue (Q = q|Q, f ) =

Q q
Q−q
B(q)
q f (1 − f )
.

PQ
Q k
Q−k
B(k)
k=0 k f (1 − f )

(2.3)

We define the biased-testing function B(q) as a weighting over certain numbers q of positive tests.
A convenient choice of this weighting is a “Boltzmann” functional form B(q) = eqUI e(Q−q)US , for
which Ptrue (Q+ = q|f, Q) becomes

+

Ptrue (Q = q|Q, f, b) =

=

Q q
Q−q qb
e
q f (1 − f )

PQ
Q k
Q−k
ekb
k=0 k f (1 − f )
Q
b q
Q−q
q (f e ) (1 − f )
,
[1 + (eb − 1)f ]Q

(2.4)

where −UI , −US represent “costs” for testing infecteds, susceptibles, and b ≡ UI − US ∈ R is a
testing-bias parameter, which we employ below.
A Gaussian approximation to Eq. 2.4 can be found through the mean and variance of Q+ :


(q − µ(f, b))2
1
+
√
Ptrue (Q = q|Q, f, b) ≈
exp −
,
(2.5)
2σ 2 (f, b)
σ 2π
where
µ(f, b) ≡

Qf eb
1 + f (eb − 1)



µ(f, b)
and σ 2 (f, b) ≡ µ(f, b) 1 −
.
Q

(2.6)

In addition to describing the probability distribution in Eq. 2.5 as a function of the number of
positive tests Q+ , we can also express it in terms of the observed positive (and potentially samplebiased) testing fraction fb := Q+ /Q:

Ptrue (fb = x|Q, f, b) ≈



(x − µ̄(f, b))2
1
√ exp −
,
2σ̄ 2 (f, b)
σ̄(f, b) 2π

(2.7)

where here,

µ̄(f, b) ≡ µ/Q =

f eb
1 + f (eb − 1)

and σ̄ 2 (f, b) ≡ µ̄(f, b) (1 − µ̄(f, b)) /Q.

(2.8)

The expected value of fb , µ̄(f, b), can be understood as a product of the true underlying infected
fraction f and a bias function B̃(f, b) that depends on f and the bias parameter b, i.e., µ̄(f, b) =

rsta.royalsocietypublishing.org Phil. Trans. R. Soc. A 0000000
..................................................................

are returned positive and Q− = Q − q tests are returned negative is
!
Q q
+
Ptrue (Q = q|Q, S, I, R) =
f (1 − f )Q−q ,
q

5

f B̃(f, b), where B̃ is given by
B̃(f, b) =

eb
.
1 + f (eb − 1)

(2.9)

Note, that Eq. 2.9 implies that when b > 0, the currently and/or previously infected population is
favored to be tested, while for b < 0, the non-infected and/or susceptible population is favored.
The limits of b → ±∞ indicate testing that is completely biased such that only infected and
susceptible individuals are tested, respectively. Realistic values of our bias parameter b are
positive and ∼ O(1).
Fig. 1(a) shows the bias function 2.9 as a function of b for different infection fractions f . For
B̃(f, b) > 1, the biased-testing fraction f B̃ is larger than the unbiased-testing fraction f . The
opposite holds for B̃(f, b) < 1. The variance σ̄ 2 is plotted as a function of b in Fig. 1(b) and exhibits
a maximum value of 1/(4Q) at b∗ = ln[(1 − f )/f ].
The probabilities Ptrue derived in Eqs. 2.1 and 2.3 correspond to “testing with replacement”.
The opposite limit is “testing without replacement”; once an individual is tested they are labeled
as such and removed from the pool of test targets, at least within the specified testing period.
This concept of sampling with and without replacement commonly arises in the measurement
of diversity in ecological settings [19]. Without replacement, and still under conditions of perfect
random testing, two slightly different forms for Ptrue arise for the different type of tests (e.g.,
antibody vs PCR/viral load). For antibody tests that perfectly identifies recovered (or deceased)
individuals as being previously infected, Eq. 2.1 is replaced by

Ptrue (Q+ = q|S, I, R, Q) =

I +R
q

!

N
Q
=

S
Q−q
!

!

! Q−1 
 q−1
Q−q−1
Y
Y
Q Y
1
(I + R − i)
(S − j),
N −n
q
n=0

i=0

(2.10)

j=0

where the binomial coefficients for q = 0, Q are zero. On the other hand, if the perfect test only
identifies individuals that currently have a viral load, the susceptible and recovered (or deceased)

rsta.royalsocietypublishing.org Phil. Trans. R. Soc. A 0000000
..................................................................

Figure 1. Illustration of a bias function B̃(f, b). (a) The bias function B̃(f, b) (Eq. 2.9) for three different fractions
f of currently (and previously) infected individuals. Grey dashed lines indicate the asymptotic value B̃(∞, f ) = 1/f .
A value b > 0 indicates a testing bias towards currently and/or previously infected individuals while susceptible and/or
non-infectious individuals are preferentially tested for b < 0. Unbiased testing corresponds to b = 0 and B̃(0, f ) = 1. (b)
The variance σ̄ 2 exhibits a maximum value of 1/(4Q) at a typical value of bias b∗ = ln[(1 − f )/f ].

n=0

i=0

6

(2.11)

j=0

The expressions for Ptrue when tested subjects are not replaced, unlike in the case of testing with
replacement, depend explicitly on S, I, R, and N .
To incorporate testing bias in into the probabilities Ptrue for testing without replacement, first


consider Eqs. 2.11 and think of Iq S+R
Q−q as the number of ways of distributing q positive tests
among I infected individuals, and Q − q negative tests among S + R uninfected individuals. As
in the biased-testing formulation of Eq. 2.3, we interpret the bias as a factor B(q) that weights
more tests in I or S + R pools:
I  S+R
q Q−q B(q)
.
(2.12)
Ptrue (Q+ = q|Q, S, I, R, B) ≡ PQ
I  N −I 
k=0 k Q−k B(k)
To obtain the “testing without replacement” equivalent of Eq. 2.4, we again set B(q) =
eqUI e(Q−q)US = ebq eQUS . By using the Chu–Vandermonde identity
!
!
!
Q
X
I
N −I
N
=
,
(2.13)
k
Q−k
Q
k=0

we verify that when b = 0 the expression 2.12 reduces to Eq. 2.11.
For the exponential form of B, the normalizing “partition function” becomes
!
!
!
Q
X
I
N − I kb
N −I
b
e =
2 F1 (−I, −Q; N − I − Q + 1; e ),
k
Q−k
Q

(2.14)

k=0

where 2 F1 denotes the (ordinary) hypergeometric function. Thus, the distribution of positive tests
Q+ under biased testing without replacement for viral load-type tests can thus be expressed as

 Qq−1 
I−k
eqb Q
−
q
k=0 S+R−Q −k
Ptrue (Q+ = q|Q, S, I, R, b) ≡
(2.15)
b
2 F1 (−I, −Q; N − I − Q + 1; e )
The distribution of positives under biased testing without replacement for antibody-type tests
becomes (analogous to Eq. 2.10) is
 Qq−1  I+R−k 
eqb Q
q
k=0 S−Q− −k
Ptrue (Q+ = q|Q, S, I, R, b) ≡
(2.16)
b
2 F1 (−I − R, −Q; N − I − R − Q + 1; e )
where Q− ≡ Q − q. The above two expressions are equivalent except for the merging of the R
pool with uninfected susceptibles S in one case, or with current infecteds I in the other. Because
the testing decreases with the number of tests administered, Eqs. 2.15 and 2.16 cannot be reduced
to functions of a simple positive-test fraction fb or to universally accurate simple Gaussian forms.

(a) Testing errors
The probability distributions Ptrue that we derived in Eq. 2.3 and in Eqs. 2.10–2.11 assume that
testing is error-free, i.e., that the false-negative rate FNR = 1 − TPR = 0 and false-positive rate
FPR = 1 − TNR = 0, or equivalently that the true-positive rate TPR = 1 and the true-negative
rate TNR = 1. To incorporate erroneous testing, we now construct the probability distribution of

rsta.royalsocietypublishing.org Phil. Trans. R. Soc. A 0000000
..................................................................

individuals both test negative and Ptrue is described by
!
!
I
S+R
q
Q−q
!
Ptrue (Q+ = q|S, I, R, Q) =
N
Q
! Q−1 
 q−1
Q−q−1
Y
Y
Q Y
1
(S + R − j).
(I − i)
=
N −n
q

might have been erroneously counted as positives drawn from the Q− ≡ Q − q 0 true negatives.
The remaining q 0 − p true positive tests might have been erroneously tallied as false negatives,
while the remaining Q− − k negative tests might have been correctly tallied as true negatives.
Assuming nonzero FPR and FNR, we find that the probability distribution of finding 0 ≤ q ≤ Q
apparent positive tests is
Perr (Q̃+ = q|Q+ = q 0 , Q, FPR, FNR) =
!
!
q
0
X
0
q0
p
q 0 −p Q − q
(TPR) (FNR)
(FPR)q−p (TNR)Q−q −(q−p) ,
p
q−p

(2.17)

p=0

where we invoked the identities TPR + FNR = 1 and FPR + TNR = 1. The total error-prone
distribution PTOT (Q̃+ = q|Q, S, I, R, b) of recording q positives after having administered Q tests
under bias and/or testing errors is given by convolving the probability Perr of finding q apparent
tests given q 0 true positive tests with the probability Ptrue of finding q 0 positive tests under perfect
testing (Eq. 2.4 or Eq. 2.15):
PTOT (Q̃+ = q|Q, S, I, R, b, FPR, FNR) =
Q
X

Perr (Q̃+ = q|Q+ = q 0 , Q, FPR, FNR)Ptrue (Q+ = q 0 |Q, S, I, R, b).

(2.18)

q 0 =0

This convolution can be further simplified by taking the Gaussian limit of the binomial
distributions that appear in Perr and in Ptrue . To be concrete, we use Ptrue as written in Eq. 2.3
under the testing with replacement scenario and use the approximation 2.5. The same Gaussian
approximation can be used for all terms in Perr from Eq. 2.17. After approximating the summation
over p ∈ (0, q) in Eq. 2.17 by an integral over p ∈ (−∞, ∞) (provided q is sufficiently large), we
find


(q − q 0 TPR − (Q − q 0 )FPR)2
exp − 0
2q FNR TPR + 2(Q − q 0 )FPR TNR
. (2.19)
Perr (Q̃+ = q|Q, Q+ = q 0 , FPR, FNR) ≈ √ p
2π q 0 FNR TPR + (Q − q 0 )FPR TNR
We now convolve Eq. 2.5 with Eq. 2.19 as prescribed by Eq. 2.18 to find
"
#
(q − µT )2
1
√ exp −
PTOT (Q̃ = q|Q, f, b, FPR, FNR) ≈
,
2
2σT
σT 2π
+

(2.20)

where
µT (f, b, FPR, FNR) ≡Q [µ̄(f, b)(1 − FNR) + (1 − µ̄(f, b))FPR] ,
2
σT
(f, b, FPR, FNR) ≡Q(1 − µ̄(f, b))FPR(1 − FPR) + Qµ̄(f, b)FNR(1 − FNR)

(2.21)

2

+ Qµ̄(f, b)(1 − µ̄(f, b))(1 − FNR − FPR) .
with µ̄(f, b) the mean value of the fraction of observed positives under biased, but perfect testing
(see Eq. 2.8). The mean number of apparent positive tests µT is given by the sum of the expected
value of true positive tests (i.e., Qµ̄(f, b)(1 − FNR) = Qµ̄(f, b)TPR) and the expected value of
2
false positive tests (i.e., Q(1 − µ̄(f, b))FPR). Based on the derived expressions for µT and σT
, we
+
˜
define the random variable as the fraction of observed positive tests fb ≡ Q̃ /Q under biased and

7

rsta.royalsocietypublishing.org Phil. Trans. R. Soc. A 0000000
..................................................................

error-generated deviation Perr (Q̃+ = q|Q+ = q 0 ) over the number of “apparent” positives q from
tests that carry nonzero FPRs and FNRs, given that q 0 positives would be recorded if the tests were
perfect. If q apparent positive tests are tallied, p of them might have been true positives drawn
0
from the perfect-test positives q 0 in qp ways, while the remaining k = q − p apparent positives

8

104 , Q = 103 , and different (a) values of I + R, (b) testing biases b, (c) FNRs, and (d) FPRs. The Gaussian
approximation (solid light blue lines) of Eq. 2.22 provides an accurate approximation of PTOT . Dashed black lines
correspond to distributions with replacement and the remaining solid colored lines correspond to those without
replacement.

error-prone testing and obtain
2

2

e−(x−µ̄T ) /(2σ̄T )
√
,
PTOT (f˜b = x|Q, f, b, FPR, FNR) ≈
σ̄T 2π

(2.22)

where
µ̄T (f, b, FPR, FNR) ≡ [µ̄(f, b)(1 − FNR) + (1 − µ̄(f, b))FPR] ,
2
Qσ̄T
(f, b, FPR, FNR) ≡(1 − µ̄(f, b))FPR(1 − FPR) + µ̄(f, b)FNR(1 − FNR)

(2.23)

+ µ̄(f, b)(1 − µ̄(f, b))(1 − FNR − FPR)2 .
The Gaussian approximation 2.23 is quite accurate provided that (i) the number of positive and
apparent positive tests, Q+ = q 0 and Q̃+ = q, are sufficiently large, and (ii), the quantities µ̄ , FNR,
and FPR are not too close to 0 or 1. In Table 1, we provide an overview of the main variables used
in the statistical testing model (2.17)–(2.23).
Fig. 2 shows the distribution of apparently infected individuals PTOT for different numbers
of infected/recovered individuals [Fig. 2 (a)], testing biases [Fig. 2 (b)], and testing sensitivities
(i.e., true positive rates, TPRs) and specificities (i.e., true negative rates, TNRs) [Fig. 2 (c–d)].
Solid light blue lines represent the Gaussian approximation 2.22 and dashed black lines and the
remaining colored lines are calculated by directly evaluating Eq. 2.18 with replacement (Eq. 2.3)
and without replacement (Eq. 2.16), respectively. The FNRs that we consider in Fig. 2 (c) are
chosen in accordance with reported sensitivities of serological and RT-PCR tests for SARS-CoV2 [9–12]. We observe that an increase in the FNR slightly shifts the distribution PTOT towards
smaller values of apparently infected individuals, which is consistent with the FNR dependence
of the mean µ̄T (Eq. 2.23). For serological and RT-PCR tests, the FPR = 1 − TNR is about 5%.
A smaller specificity would lead to larger FPRs and a shift of PTOT towards larger values of

rsta.royalsocietypublishing.org Phil. Trans. R. Soc. A 0000000
..................................................................

Figure 2. Distribution of apparently positive tests. Plots of PTOT (Q̃+ = q|Q, I, S, R, b) with N = S + I + R =

9

month-year

Figure 3. Observed and corrected proportions of positive tests in the United States. (a) The solid black line
represents the 7-day average of the proportion of positive tests (f˜b )t = Q̃+
t /Qt in the United States. Blue and red bars
show the corresponding total number of daily tests Q and apparent positive tests Q̃+
t , respectively. (b) The corrected
proportion of positive tests fˆt , found by inverting Eq. 3.1, for different FPR, FNR, and bias combinations.

Q̃+ and f˜b [Fig. 2 (d)]. Our results show that PTOT is more affected by variations in the testing
specificity than by variations in testing sensitivity.

(b) Temporal variations and test heterogeneity
Up to now, we have discussed single viral-load and antibody tests (with and without
replacement) but have not considered temporal variations in the number of tests Q, the number
of returned positives Q̃+ , and heterogeneity in FNR and FPR that are associated with different
classes (types, manufacturing batches, etc.) of assays. To make our model applicable to empirical
time-varying testing data, we use St , It , Rt to denote the number of susceptible, infected, and
removed individuals at time t (or in successive time windows labeled by t), respectively. If K > 1
test classes are present, we also include an additional index c ∈ {1, . . . , K} in all relevant model
parameters. The testing bias and the total number of tests may be both test-class and timedependent. That is, b = bt,c and Q = Qt,c . Test specificity and sensitivity mainly depend on the
assay type and not on time. We thus set FPR = FPRc and FNR = FNRc .

3. Inference of prevalence and application to COVID-19 data
For a certain time window, one often wishes to infer It + Rt and St , or It and St + Rt from values
of bt,c , Qt,c , and qt,c . Alternatively, since bt,c is difficult to independently ascertain, one may only
be able to infer (fb )t,c = f (St , It , Rt , bt,c ). For a single test result q̃t,c (or (f˜b )t,c ), we can generate
the maximum likelihood estimate (MLE) of the bias-modified prevalence (fˆb )t,c by setting the
measured value (f˜b )t,c = µ̄T [(fˆb )t,c ] to find
(f˜b )t,c = (fˆb )t,c (1 − FNRc ) + (1 − (fˆb )t,c )FPRc

(3.1)

ˆT )2t,c ≈ (σ̄T )2t,c [(fˆb )t,c ].
(σ̄

(3.2)

and

Since (fˆb )t,c = fˆt,c B̃(fˆt,c , bt,c ), Eq. 3.1 can be solved for fˆt,c :
fˆt,c =

eb [1 − FNRc

(f˜b )t,c − FPRc
.
− (f˜b )t,c ] + (f˜b )t,c − FPRc

(3.3)

The posterior distribution Ppost over values of f can be found through Bayes’ theorem:
Ppost (f |Q̃+ , Q, FPR, FNR) = R1
0

PTOT (Q̃+ |Q, f, FPR, FNR)P0 (f )
PTOT (Q̃+ |Q, f 0 , FPR, FNR)P0 (f 0 ) df 0

,

(3.4)

rsta.royalsocietypublishing.org Phil. Trans. R. Soc. A 0000000
..................................................................

month-year

4. Inference of bias b
One way to estimate the testing bias b is to identify a smaller subset of control tests within a
jurisdiction that is believed to be unbiased and compare it with the reported fraction of positive
tests obtained via standard (potentially biased) testing procedures.
We can derive a rather complete methodology to estimate bias by formally comparing the
statistics of two sets of tests applied to the same population. The first set of control tests with
testing parameters θ0 = {Q0 , f, FPR0 , FNR0 } is known to be unbiased (has prior distribution
δ(b)), while the second set is taken with known parameters θ = {Q, FPR, FNR}, but unknown
testing bias b. For example, the control set may consist of a smaller number Q0 of tests that
are administered completely randomly, while the second set may be the scaled-up set of tests
with Q > Q0 . Since both sets of tests are applied roughly at the same time to the same overall
population, the underlying positive fraction f is assumed to be the same in both test sets. We can
then use Bayes’ rule on the first unbiased test set to infer f :
P
(f˜ |f, θ0 , b = 0)P0 (f )
.
Ppost (f |f˜0 , θ0 , b = 0) = R1 TOT 0
0
0
˜ 0
0 PTOT (f0 |f , θ0 , b = 0)P0 (f ) df

(4.1)

The probability distribution over b for a specified value of f can also be constructed from Bayes’
rule
PTOT (f˜b |f, θ, b)P0 (b)
,
0
0
0
˜
−∞ PTOT (fb |f, θ, b )P0 (b ) db

Ppost (b|f˜b , f, θ) = R∞

(4.2)

where P0 (·) are prior distributions over the relevant parameters. The final distribution over the
bias factor, given the two measurements f˜0 and f˜b derived from the two sets of tests with testing
parameters θ0 and θ, can be found using
Pb (b|f˜b , f˜0 , θ, θ0 ) =

Z1

Ppost (b|f˜b , f, θ)Ppost (f |f˜0 , θ0 , b = 0)df.

(4.3)

0

Of course, a simpler maximum likelihood estimate can also be applied to data by first inferring
the most likely value of f from the control test set. We can use the number of positive tests in the
+
˜
˜
control sample Q+
0 to define the variable f0 = Q0 /Q0 . One can then maximize PTOT (f0 |f, θ0 , b =

10

rsta.royalsocietypublishing.org Phil. Trans. R. Soc. A 0000000
..................................................................

where P0 (f ) is a prior distribution over the underlying infection fraction f in the population. For
notational brevity, we did not include the indices c and t in Eq. 3.4. We can again simplify the
analysis by using the Gaussian approximation and a simple initial uniform prior, P0 (f < fmax ≤
1) = 1/fmax .
As an example, we collected US testing data [20] from March 2020 to March 2021. Figure 3(a)
shows the daily number of observed positive tests Q̃+
t (red bars) and the corresponding total
daily number of tests Qt (blue bars). The 7-day average of the observed positive testing rate
˜
(f˜b )t = Q̃+
t /Qt is indicated by the black solid line. The first drop in (fb )t in March 2020 was
associated with the initially very limited number of available SARS-CoV-2 testing infrastructure
followed by the ramping up of testing capacity. After new cases surged by the end of March
and in April 2020, different types of stay-at-home orders and distancing policies with different
durations were implemented across the United States [21]. In June and July 2020, reopening plans
were halted and reversed by various jurisdictions to limit the resurgence of COVID-19 [22].
In Fig. 3(b), we show the corrected proportion of positive tests fˆt , found by numerically
inverting Eq. 3.1 for different FPR, FNR, and bias combinations. We observe that a small
FPR = 0.04 shifts values (f˜b )t ≈ 0.05 towards zero such that the corrected positive testing rate
fˆt ≈ 0. Reducing the FNR from 0.2 to 0.1 has only little effect on the corrected proportion of
positive tests fˆt [solid black and dashed lines in Fig. 3(b)]. Accounting for a positive testing bias of
b = 1 (i.e., preferential testing of infected and symptomatic individuals by a factor of e), however,
markedly changes the inferred fˆt [dashed-dotted black line in Fig. 3(b)].

11

and N = 12,597. A value b > 0 indicates a testing bias towards currently and/or previously infected individuals while
susceptible and/or non-infectious individuals are preferentially tested for b < 0. Unbiased testing corresponds to b = 0.

0) with respect to f and use this value fˆ in PTOT (f˜b |fˆ, θ, b). Maximizing PTOT (f˜b |fˆ, θ, b) with
respect to b then gives the MLE estimate b̂. We can use random and unbiased sampling results
obtained in the German jurisdiction of Gangelt, North Rhine-Westphalia [18]. A total of 600 adult
persons with different last names were randomly selected from a population of 12,597 and asked
to participate in the study together with their household members. The resulting study comprised
of Q0 = 919 subjects who underwent serological and PCR testing between March 31-April 6, 2020.
The specificity and sensitivity corrected, unbiased positive test fraction was determined to be f =
15.53% (95% CI; 12.31%–18.96%). Thus, we use this value as an estimate for the true underlying
positivity rate fˆ. The larger sample taken across North Rhine-Westphalia between March 30–April
5, 2020 was measured (Q ≈ 25, 000) to be f˜b ≈ 0.1 [23]. Assuming that this value is also errorcorrected, an estimate of the bias b̂ in this main testing set can be found by solving f˜b ≈ 0.1 =
µ̄T (fˆ = 0.1553, b̂, FPR = FNR = 0) = µ̄(fˆ = 0.1553, b̂) for b̂. We find that the difference between
the unbiased positive testing rate of 15.53% and 10% corresponds to a bias of b̂ = −0.50. This
negative bias likely arises because Gangelt was a an infection hotspot within the entire North
Rhine-Westphalia region, so the control sample was probably not unbiased. For comparison, a
higher biased positive testing rate of 20% would lead to an estimated testing bias b̂ = 0.31.
The number of total deaths on April 6, 2020 amounted to 7. Hence, the corresponding estimate
of the infection fatality ratio (IFR), the number of disease-induced deaths Dt divided by the total
number of cases Nt at time t, in this jurisdiction on April 6, 2020 was 7/(0.1553 × 12,597) = 0.36%
(95% CI; 0.29%–0.45%) [18]. If only a biased estimate of the proportion of positive cases is known
and not the true value f , we can use our framework to distinguish between the true IFRt =
Dt /(Nt − St ) = Dt /(f0 Nt ) and the observed infection fatality ratio
Dt
g t = Dt =
IFR
.
f Nt
f B̃(f, b)Nt

(4.4)

g as a function of testing bias b for the aforementioned example of
Figure 4 shows the observed IFR
the German jurisdiction of Gangelt. Values of b > 0 correspond to preferential testing of infected
g The opposite holds for b < 0.
individuals and thus lead to an apparently lower IFR.

5. Summary and Conclusions
Radiological testing methods such as chest computed tomography (CT) are used sporadically
to identify COVID-19-induced pneumonia in patients with negative tests [24], However, the
overwhelming majority of COVID-19 tests are based on serological (or antibody) tests and rapid
antigen tests, ELISA, and RT-PCR assay [1]. These tests are designed to subsequently output

rsta.royalsocietypublishing.org Phil. Trans. R. Soc. A 0000000
..................................................................

Figure 4. Dependence of the observed IFR on testing bias. The observed infection fatality ratio ]
IFR (Eq. (4.4))
as a function of testing bias b. We used the example of the German jurisdiction Gangelt and set fˆ = 0.1553, D = 7,

Data Accessibility. Our source codes are publicly available at https://github.com/lubo93/
disease-testing.

Authors’ Contributions. LB, MRD, and TC contributed equally to the study design, data analyses, and
manuscript writing.

Competing Interests. The authors declare no competing interests.
Funding. LB acknowledges financial support from the Swiss National Fund (P2EZP2_191888). The
authors also acknowledge financial support from the Army Research Office (W911NF-18-1-0345), the NIH
(R01HL146552), and the National Science Foundation (DMS-1814364, DMS-1814090).

References
1. CDC, “Overview of Testing for SARS-CoV-2 (COVID-19),” https://www.cdc.gov/
coronavirus/2019-ncov/hcp/testing-overview.html, 2020, accessed: 2021-01-26.
2. M. R. Tom and M. J. Mina, “To interpret the SARS-CoV-2 test, consider the cycle threshold
value,” pp. 2252–2254, 2020.
3. A. Mandavilli, “Your coronavirus test is positive. Maybe it shouldn’t be,” The New York Times,
vol. 17, 2020.
4. P. N. Patrone and A. J. Kearsley, “Classification under uncertainty: Data analysis for diagnostic
antibody testing,” arXiv:2012.10021, p. arXiv:2012.10021, 2021.
5. U.S. Food and Drug Administration, “EUA authorized serology test performance,”
https://www.fda.gov/medical-devices/emergency-situations-medical-devices/

12

rsta.royalsocietypublishing.org Phil. Trans. R. Soc. A 0000000
..................................................................

a binary signal, either infected or not. The population statistics of this output are affected by
testing errors and bias. False positive and false negative rates of serological tests are generally
smaller than those of rapid antigen tests and RT-PCR tests. However, serological tests are unable
to identify early-stage infections since they are measuring antibody titres that usually develop a
few days up to a few weeks after infection. In addition to the occurrence of false positives and
false negatives (i.e., type-I and type-II errors), certain demographic groups (e.g., elderly people
or those with comorbidities such as heart and lung diseases) may be overrepresented in testing
statistics.
To quantify the impact of both type-I/II errors and testing bias on reported COVID-19 case and
death numbers, we developed a mathematical framework that describes erroneous and biased
sampling (both with and without replacement) from a population of susceptible, infected, and
removed (i.e., recovered or deceased) individuals. We identify a positive testing bias b > 0 with
an overrepresentation of previously or currently infected individuals in the study population.
Conversely, a negative testing bias b < 0 corresponds to an overrepresentation of susceptible
and/or non-infectious individuals in the study population. We derived maximum likelihood
estimates of the testing-error and testing-bias-corrected fraction of positive tests. Our methods
can be also applied to infer the full distribution of corrected positive testing rates over time and
for different types of tests across different jurisdictions.
The mathematical quantity that underlies most of our analysis is the proportion of apparent
positive tests. As pointed out in [25], the absolute number of positive tests may not capture the
actual growth of an epidemic due to limitations in testing capacity. Still, many jurisdictions report
absolute case numbers without specifying the total number of tests or additional information
about test type, date of test, and duplicate tests [26], rendering interpretation and application
to epidemic surveillance challenging. For a reliable picture of COVID-19 case numbers, more
complete testing data, including total number of tests, number of positive tests, test type, and date
of test, has to be reported and made publicly available at online data repositories. To correct for
false positive, false negatives, and testing bias in testing statistics (Fig. 3), it will be also important
to further improve estimates of FPR, FNR, and b through in field studies. In particular, estimating
the testing bias b requires random sampling studies similar to that carried out in [18]. Finally,
while we have presented our analysis in the context of the COVID-19 pandemic, the general
results presented in this paper apply to testing and estimation of severity of any infectious disease
afflicting a population.

13

rsta.royalsocietypublishing.org Phil. Trans. R. Soc. A 0000000
..................................................................

eua-authorized-serology-test-performance, 2020.
6. A. N. Cohen, B. Kessel, and M. G. Milgroom, “Diagnosing COVID-19 infection: the danger of
over-reliance on positive test results,” medRxiv, 2020.
7. J. Watson, P. F. Whiting, and J. E. Brush, “Interpreting a COVID-19 test result,” BMJ, vol. 369,
2020.
8. M. L. Bastos, G. Tavaziva, S. K. Abidi, J. R. Campbell, L.-P. Haraoui, J. C. Johnston, Z. Lan,
S. Law, E. MacLean, A. Trajman et al., “Diagnostic accuracy of serological tests for COVID-19:
systematic review and meta-analysis,” BMJ, vol. 370, 2020.
9. R. Lassaunière, A. Frische, Z. B. Harboe, A. C. Nielsen, A. Fomsgaard, K. A. Krogfelt, and C. S.
Jørgensen, “Evaluation of nine commercial SARS-CoV-2 immunoassays,” medRxiv, 2020.
10. J. D. Whitman, J. Hiatt, C. T. Mowery, B. R. Shy, R. Yu, T. N. Yamamoto, U. Rathore, G. M.
Goldgof, C. Whitty, J. M. Woo et al., “Test performance evaluation of SARS-CoV-2 serological
assays,” medRxiv, 2020.
11. Y. Fang, H. Zhang, J. Xie, M. Lin, L. Ying, P. Pang, and W. Ji, “Sensitivity of chest CT for
COVID-19: comparison to RT-PCR,” Radiology, p. 200432, 2020.
12. W. Wang, Y. Xu, R. Gao, R. Lu, K. Han, G. Wu, and W. Tan, “Detection of SARS-CoV-2 in
different types of clinical specimens,” JAMA, vol. 323, no. 18, pp. 1843–1844, 2020.
13. I. Arevalo-Rodriguez, D. Buitrago-Garcia, D. Simancas-Racines, P. Zambrano-Achig, R. del
Campo, A. Ciapponi, O. Sued, L. Martinez-Garcia, A. Rutjes, N. Low et al., “False-negative
results of initial RT-PCR assays for COVID-19: a systematic review,” medRxiv, 2020.
14. L. Böttcher, M. D’Orsogna, and T. Chou, “Using excess deaths and testing statistics to improve
estimates of COVID-19 mortalities,” European Journal of Epidemiology, 2021.
15. L. Böttcher, M. Xia, and T. Chou, “Why case fatality ratios can be misleading: individual-and
population-based mortality estimates and factors influencing them,” Physical Biology, vol. 17,
p. 065003, 2020.
16. CDC, “Summary of Laboratory Testing Results Reported to CDC,” https://www.cdc.gov/
coronavirus/2019-ncov/covid-data/covidview/index.html, 2020, accessed: 2020-04-18.
17. N. E. Fenton, M. Neil, M. Osman, and S. McLachlan, “COVID-19 infection and death rates:
the need to incorporate causal explanations for the data and avoid bias in testing,” Journal of
Risk Research, pp. 1–4, 2020.
18. H. Streeck, B. Schulte, B. M. Kümmerer, E. Richter, T. Höller, C. Fuhrmann, E. Bartok,
R. Dolscheid-Pommerich, M. Berger, L. Wessendorf et al., “Infection fatality rate of SARS-CoV2
in a super-spreading event in Germany,” Nature Communications, vol. 11, no. 1, pp. 1–12, 2020.
19. S. Xu, L. Böttcher, and T. Chou, “Diversity in biology: definitions, quantification and models,”
Physical Biology, vol. 17, no. 3, p. 031001, 2020.
20. “The COVID Tracking Project,” https://covidtracking.com/, accessed: 2021-02-20.
21. A. Moreland, C. Herlihy, M. A. Tynan, G. Sunshine, R. F. McCord, C. Hilton, J. Poovey, A. K.
Werner, C. D. Jones, E. B. Fulmer et al., “Timing of state and territorial COVID-19 stay-athome orders and changes in population movement – United States, March 1–May 31, 2020,”
Morbidity and Mortality Weekly Report, vol. 69, no. 35, p. 1198, 2020.
22. “A Timeline of COVID-19 Developments in 2020,” https://www.ajmc.com/view/
a-timeline-of-covid19-developments-in-2020, 2021, accessed: 2021-04-17.
23. “Laborbasierte Surveillance von SARS-CoV-2–24.04.2020,” https://ars.rki.de/Docs/SARS_
CoV2/Archiv/Wochenberichte/20200424_Wochenbericht.pdf, 2020, accessed: 2021-04-12.
24. X. Xie, Z. Zhong, W. Zhao, C. Zheng, F. Wang, and J. Liu, “Chest CT for typical coronavirus
disease 2019 (COVID-19) pneumonia: relationship to negative RT-PCR testing,” Radiology, vol.
296, no. 2, pp. E41–E45, 2020.
25. R. Omori, K. Mizumoto, and G. Chowell, “Changes in testing rates could mask the novel
coronavirus disease (COVID-19) growth rate,” International Journal of Infectious Diseases,
vol. 94, pp. 116–118, 2020.
26. J.
G.
McGinty,
“Covid-19
Positivity
Rate
Might
Not
Mean
What
You
Think
It
Does,”
https://www.wsj.com/articles/
covid-19-positivity-rate-might-not-mean-what-you-think-it-does-11599211800,
2020,
accessed: 2021-04-18.

