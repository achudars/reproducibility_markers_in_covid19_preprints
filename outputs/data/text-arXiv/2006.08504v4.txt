Kemeny-based testing for COVID-19
Serife Yilmaz,∗ Ekaterina Dudkina,‡ Michelangelo Bin,† Emanuele Crisostomi,‡ Pietro Ferraro,∗
Roderick Murray-Smith,§ Thomas Parisini,†,¶,k Lewi Stone,∗∗ Robert Shorten∗
∗ Dyson

School of Design Engineering, Imperial College London, London, UK.
of Electrical and Electronic Engineering, Imperial College London, London, UK.
‡ Department of Energy, Systems, Territory and Constructions Engineering, University of Pisa, Pisa, Italy
Email: {emanuele.crisostomi}@unipi.it
§ School of Computing Science, University of Glasgow, Glasgow, Scotland.
¶ Department of Engineering and Architecture, University of Trieste, Trieste, Italy.
k KIOS Research and Innovation Center of Excellence, University of Cyprus, Nicosia, Cyprus.
∗∗ The George S. Wise Faculty of Life Sciences, Tel Aviv University, Israel.

arXiv:2006.08504v4 [physics.soc-ph] 24 Jul 2020

† Department

Abstract—Testing, tracking and tracing abilities have been identified as pivotal in helping countries to safely reopen activities
after the first wave of the COVID-19 virus. Contact tracing apps
give the unprecedented possibility to reconstruct graphs of daily
contacts, so the question is who should be tested? As human
contact networks are known to exhibit community structure, in
this paper we show that the Kemeny constant of a graph can
be used to identify and analyze bridges between communities
in a graph. Our ‘Kemeny indicator’ is the change in Kemeny
constant when a node or edge is removed from the graph. We
show that testing individuals who are associated with large values
of the Kemeny indicator can help in efficiently intercepting new
virus outbreaks, when they are still in their early stage. Extensive
simulations provide promising results in early identification and
in blocking possible ‘super-spreaders’ links that transmit disease
between different communities.
Index Terms—Markov chains, Covid-19, Kemeny constant

I. I NTRODUCTION
A. Motivation
Amidst fears of a possible second wave of the COVID-19
disease, methodologies based around test, track, and trace
(3T ) policies have been identified in many countries to lift
confinement restrictions [17], [27], [29]. Some initial examples
of contact tracing methods, that have been widely applied
from the beginning of the epidemic, aimed at combining data
from interviews, smartphones GPS and Bluetooth histories,
credit cards and camera records. Examples of successful
applications in China, Iceland, New Zealand, Singapore,
South Korea and Taiwan, have been shown to contribute
to mitigating the spread of the virus [1], but such manual
contact tracing approaches are particularly time consuming,
especially with large numbers of infected people. Besides,
considering the long incubation period, and exponential
growth in transmission, even short delays in actions may
lead to the loss of control of the epidemic [10]. From this
perspective, it has also been shown in [16] that reducing the
delay in detecting a new case from 5 to 3 days leads to a
60-70% improvement in efficiency, in terms of reproduction
number. Accordingly, an alternative more efficient solution for
contact tracing includes the use of mobile phone applications
with immediate notification. Considering a high penetration

rate, and a high compliance of people in using this app, it
could significantly help to stop the epidemic as shown in
[10]. The benefits of efficient testing are clear. In addition
to identifying infected individuals and tracing their contacts,
fast diagnostic tests also allow estimation of the degree of
spread of the virus in a region.
Accordingly, one proposal is to perform the tracing task by
using Bluetooth connectivity to recognize when a prolonged
proximity between two smartphones (and thus, their owners)
occurs. For instance, the smartphone app that has been recommended by the Italian government stores a contact when
a proximity of less or equal than two meters for at least
15 minutes is recorded.1 Thus, the tracing task is currently
designed as a reactive process, as it is a reaction to a positive
test. Consequently, unless the positive individual is tested in
the very early stages of the infection, which may be unrealistic
in practice in many cases since symptoms do not usually
appear before 3-4 days, large numbers of naive tests and
ineffective quarantines may be required for an effective 3T
policy. It is therefore of interest to reshape the sampling
process to be proactive and make sampling more efficient in
the presence of limited testing capabilities. In this context,
an obvious related questions arises: Is it possible to identify
the potential super-spreaders before they spread? [27]. While
such a question implies a formal definition of what is a
‘super-spreader’, we note that in the context of COVID-19,
the effect of the disease is highly compartmentalized; not
only regionally, but also in terms of demographics, with older
communities highly at risk, and younger children apparently
in a low risk category, but still with the potential for acting
as vectors. Indeed, the terrible effects of the disease in care
homes for the elderly, and in communities such as the Satmar
community,2 only reinforce the negative consequences of the
disease jumping from one compartment to another. Our main
1 https://www.ilsole24ore.com/art/download-dati-notifiche-ecco-comefunzionera-l-app-tracciare-contagio-ADvrNfN
2 https://www.independent.co.uk/independentpremium/long-reads/ultraorthodox-coronavirus-new-york-brooklyn-hasidic-antibodies-lockdowna9537556.html

objective is therefore to: Propose testing strategies which can
identify ‘bridges’ between communities, which could easily
become ’super-spreaders’. For this purpose, we shall describe
how the contact tracing apps can be conveniently used to
support targeted prioritization of testing, by exploiting the
reconstructed networks of daily contacts. Despite the fact
that current apps are not explicitly designed for this purpose,
as they are only used when an individual is identified as
being infected, we show that the network information they
are capable of acquiring could actually provide very valuable
information also in the absence of infected individuals.
B. State of the art
The issue of who should be tested is not new in epidemiology.
This problem is very similar to the classic one of who should
be vaccinated in a population. For instance, it is well
established that random immunization requires immunizing a
very large fraction of a population in order to abate contacttransmissible epidemics [6]. When time or resources are
limited, better results can be achieved if smarter immunisation
strategies are used; see, for instance the immunising random
acquaintances of random nodes policy [6] which is known to
be more successful than a fully random strategy in identifying
the super-spreaders.
In principle, targeted immunization of the most highly
connected individuals is also known to be more effective.
However, since such vaccination policies actually require a
global knowledge of the contact network, they are impractical
in most cases [6]. In the COVID-19 context, the advantage
of sample testing is confirmed in [22], where the authors
analyzed the effect of testing, isolation, tracing, physical
distancing, and type of contacts (household and others) on the
reproduction number. According to their simulations, focused
testing strategies based on contact tracking help to hold back
the epidemic more efficiently than widespread mass testing or
self-isolation alone. From this perspective, it is clear that the
contact tracing apps provide an unprecedented opportunity
to infer the network over which an epidemic spreads, and to
implement targeted immunization/testing policies [17].
Assuming that the tracing apps truly do provide a snap-shot of
a city-wide network of contacts, then the problem becomes:
what is meant by the most highly connected individuals? Such
problems are highly topical in computer science, mathematics,
and engineering, and a number of tools are available to us. In
this paper we compare several measures. We first consider the
graph node degree (i.e., the number of daily contacts) as the
most obvious option of who should be tested. An alternative
is represented by the Google’s PageRank indicator [23], as
suggested in [8]. These indicators identify influential contacts
in a graph, and do not necessarily identify communities or
individuals that bridge communities, and so, as we shall show,
may not be particularly effective for our purpose. Thus, we
also consider an indicator based on the Kemeny constant [7]
which we shall show to be particularly attractive for this task.

II. M ATERIALS AND

METHODS

A. A Primer on Markov chains
Graph theory and Markov chains have been ubiquitously
employed in many different fields of engineering and applied
mathematics, including epidemiology [19], [31]. Here we
only briefly recall some basic notions that will be later used
in our analysis. In doing this, we follow [7], based on classic
references [20], [23].
In this manuscript, we shall only consider discrete-time, finitestate, homogeneous Markov chains. In this situation, the
Markov chain is a discrete time stochastic process xk , k ∈ N
and characterised by the equation
p(xk+1 = Sik+1 |xk = Sik , ..., x0 = Si0 ) = p(xk+1 = Sik+1 |xk = Sik )
where p(E|F ) denotes the conditional probability that event
E occurs given that event F occurs.
A Markov chain with n states is completely described by the
n × n transition probability matrix P, whose entry Pij denotes
the probability of passing from state Si to state Sj in exactly
one step. P is a row-stochastic non-negative matrix, as the
elements in each row are probabilities and they sum up to
1. Within Markov chain theory, there is a close relationship
between the transition matrix P and a corresponding graph.
The graph consists of a set of nodes that are connected through
edges. The graph associated with the matrix P is a directed
graph, whose nodes are given by the states Si , i = 1, ..., n,
and there is a directed edge leading from Si to Sj if and only
if Pij 6= 0. A graph is strongly connected if for each pair
of nodes there is a sequence of directed edges leading from
the first node to the second one. The matrix P is irreducible
if and only if its directed graph is strongly connected. Some
important properties of irreducible transition matrices follow
from the well-known Perron-Frobenius theorem [23]:
• The spectral radius of P is 1; 1 also belongs to the
spectrum of P, and has an algebraic multiplicity of 1;
• The left-hand Perron eigenvector π is the unique vector
defined by π T P = π T , such that every single entry
of π is strictly positive and kπk1 = 1. Except for
positive multiples of π there are no other non-negative
left eigenvectors for P.
One of the main properties of irreducible Markov chains is
that the i′ th component πi of the vector π represents the
long-run fraction of time that the chain will be in state Si .
The row vector π T is also called the stationary distribution
vector of the Markov chain.
In our application, a node of the graph is an individual with
the contact tracing app installed in her/his smartphone. Two
nodes are connected through an undirected edge if the app
recognizes that two individuals have been in close contact for
a sufficient time (e.g., 15 minutes in the previous example
of the Italian app). If the app also records the amount of
time, or the distance, between two individuals, then it would

be possible to consider a weighted graph, where the weights
could correspond to the probability of contagion (i.e., it would
increase with the duration of the contact, and decrease with
the distance), as will be considered in a specific later section.
Also, note that the contact tracing apps give rise, in principle,
to daily graphs which are not fully connected. This is due to
the fact that some communities may be in fact isolated, and
in general single individuals may not have significant contacts
with other people during a day.
B. Mean first passage times and the Kemeny constant
A transition matrix P with 1 as a simple eigenvalue gives
rise to a singular matrix I − P (where the identity matrix I
has appropriate dimensions), which is known to have a group
inverse (I − P)# . The group inverse is the unique matrix such
that (I −P)(I −P)# = (I −P)# (I −P), (I −P)(I −P)# (I −
P) = (I −P), and (I −P)# (I −P)(I −P)# = (I −P)# . More
properties of group inverses and their applications to Markov
chains can be found in [20]. The group inverse (I − P)#
contains important information on the Markov chain and it will
be often used in this paper. For this reason, it is convenient
to denote this matrix as Q# . The mean first passage time
(MFPT) mij from the state Si to the state Sj denotes the
expected number of steps to arrive at destination Sj when the
origin is Si , and the expectation is averaged over all possible
paths following a random walk from Si to Sj . If we denote by
#
qij
the ij entry of the matrix Q# , then the mean first passage
times can be computed according to [5],
mij =

#
qjj

−
πj

#
qij

i, j = 1, ..., n, i 6= j.

(2)

We assume that mii = 0. The Kemeny constant is defined as
K=

n
X

mij πj ,

(3)

j=1

where the right-hand side is independent of the choice of
the origin state Si [20]. An interpretation of this result is
that the expected time to get from an initial state Si to
a destination state Sj (selected randomly according to the
stationary distribution π) does not depend on the starting
point Si [9]. Therefore, the Kemeny constant is an intrinsic
measure of a Markov chain, and if the transition matrix P has
eigenvalues λ1 = 1, λ2 , ..., λn , then another way of computing
K is [25],
K=

n
X
j=2

1
.
1 − λj

(4)

As can be seen from Equation 4, K is only related to the
particular matrix P and it becomes very large if one or more
of the other eigenvalues of P, different from λ1 , are close to 1.
Remark: The Kemeny constant admits many interpretations.
First, it is related to the mean first passage times of the
underlying Markov chain. But it is much more than this. It
is also determined by the entire spectrum of the transition

matrix. From a control theoretic perspective it resembles the
sum of rise times along all the modes of the system. Thus,
while the second eigenvalue of the transition matrix gives
a bound on the convergence rate of the underlying Markov
chain, the Kemeny constant is akin to an average of rise
times across all modes.
The Kemeny constant is usually computed using the group
inverse (Equation 3) or the knowledge of all the eigenvalues
(Equation 4). A more convenient computation, revealing the
complexity of the calculation, can be developed as follows.
Let P be a n × n stochastic, irreducible transition matrix. We
denote the eigenvalues of P by λ1 = 1, λ2 , . . . , λn and its
characteristic polynomial is
p(s) = det(sI − P) = (s − 1)(s − λ2 ) · · · (s − λn ).
We define p̃(s) = p(s)/(s − 1). The Kemeny constant of P
can be calculated using its characteristic polynomial:
K

=

1
1
1
+
+ ···+
1 − λ2
1 − λ3
1 − λn

=

p̃′ (1)
.
p̃(1)

Since p(s) = (s − 1)p̃(s),
p̃(1) = lim

s→1

p(s)
p′ (s)
= lim
= p′ (1)
s − 1 s→1 1

and using the derivative of p̃(s) = p(s)/(s − 1) we get
p̃′ (1) =
=
=

p′ (s).(s − 1) − p(s)
s→1
(s − 1)2
′′
p (s).(s − 1) + p′ (s) − p′ (s)
lim
s→1
2(s − 1)
1 ′′
p (1).
2
lim

Hence, the Kemeny constant of the matrix P can be written
as
K=

1 p′′ (1)
.
2 p′ (1)

(5)

Remark:
• A characteristic polynomial interpretation of K is also
given in [4], [21]. To the best of our knowledge the link
to the characteristic polynomial and the Markov transition
matrix, more precisely I − P, was first given in [21]. A
further derivation is given in [4], this time using the associated adjacency matrix. However, the derivation given
here expresses K from the derivative of the characteristic
polynomial associated with P.
• Calculation of the Kemeny constant is of the same
computational complexity as that of calculating the determinant.
• The determinantal interpretation of K suggests a deeper
control theoretic interpretation of the Kemeny constant.

C. PageRank and Betweenness Centrality Indicators
As a starting point, we are first interested in undirected
and un-weighted graphs. In this case, if tele-portation is not
considered, then PageRank simply corresponds to the Perron
eigenvector, and it is well-known that node degree and the
Perron eigenvector are highly correlated [14]. In addition,
our graph structures have some other important properties. In
particular, if we denote by A the symmetric [0, 1] adjacency
matrix that has ones in positions Ai,j and Aj,i if individuals i
and j are in close contact for a long enough time, then it can
be noticed that the row-stochastic matrix P of our interest can
be obtained as
P = D−1 A,

(6)

where D is the diagonal matrix, whose Dii entry corresponds
to the degree of the i’th node of A. Also, the eigenvalues of
the row-stochastic (non-symmetric) matrix P are the same
of the symmetric matrix D−1/2 AD−1/2 , and we remind the
reader that the eigenvalues of symmetric matrices are real.
Thus: all eigenvalues and eigenvectors of P are real as well.
This shall play an important role in the following discussion.
Another measure of centrality in graphs is represented by
betweenness centrality. In its basic definition, it measures the
number of shortest paths that pass through a node [11], [12].
In principle, it is known to show which nodes are acting as
“bridges” between communities in graphs.
Fig. 1. Betweenness Centrality. An example of a node (yellow) with the
highest betweenness value. The yellow node acts as a ‘bridge’ between the
red and blue communities.

For example, in Fig 1, all shortest paths connecting red
and blue nodes will pass through the yellow node, which
consequently has the maximum betweenness centrality
value in the graph. However, in many networks, including
the contact networks of our interest, the information (or
here, the virus) does not flow along shortest paths, and
will most likely take a random route [26]. Accordingly, a
measure of betweenness centrality based on random walks,
called Random Walk Betweenness was introduced in [26].
This measure was shown to better rank the importance of
nodes in graphs with existing communities, and to be less
correlated with vertex degree in most networks [26]. Also, it
is known that in networks with strong community structure,
immunization interventions targeted at individuals bridging
communities (e.g., using random walk betweenness) are

more effective than those simply targeting highly connected
individuals.
Remark: The Kemeny constant may be interpreted as the
average time to take a random walk in the contagion graph,
weighted according to likely destinations. As such it takes into
account the stationary distribution, and the first mean passage
times from a given starting location and all other destinations.
As such, this constant represents a compromise between
indicators that use only the stationary distribution (such as
PageRank and node degrees), and those using path-based
algorithms (such as the betweenness centrality indicators).
Thus, the indicator should work in highly connected singlecommunity graphs, and in more sparse graphs, associated with
many unknown sub-communities.
III. S IMULATION

RESULTS

A. Who should be tested: node degree vs. Kemeny indicator
We use the Kemeny-based indicator as a proxy to determine
individuals that should be tested. For this purpose, we quantify
the important of each single node as the corresponding value
of the Kemeny constant of the graph obtained from the original
graph by removing such a node, and for simplicity we shall
denote it as the Kemeny indicator. The rationale of this choice
is that nodes connecting two communities are associated with
very high Kemeny indicators, as walking times become much
larger if such nodes are removed. In particular, if a single
node connects two communities then it implies that only one
person belongs to both such communities, and if that node
is removed, then the Kemeny constant tends to infinity (i.e.,
after removing that node, the graph is split into two nonconnected sub-graphs, and it is impossible to find a path from
one community to the other community, thus the walking time
tends to infinity).
We now consider a simple scenario with a population of 240
individuals who belong to 6 different communities (with 40
people within each community). Communities are artificially
created by giving a higher probability to meeting individuals
from the same community (19 %) than people from other communities (0.1 %), and with the chosen values a modularity of
0.8 is obtained, which is consistent with known communities
[29]. In the assumption that 10 tests were available, Fig 2
shows the 10 individuals with highest degree (magenta) and
the 10 individuals with highest Kemeny indicator (black). By
visual inspection, it is very simple from Fig 2 to understand
the main difference between Kemeny-based testing, and testing
the individuals with highest node degree. In particular, the Kemeny indicator identifies the bridges between the communities,
i.e., people that visit different communities during the same
day, regardless of how many people in total they meet during
the day. While, in principle, benefits may be found for both
solutions, we argue that this feature of the Kemeny indicator
may be particularly convenient as a better coverage of the
graph is obtained (the same individual covers more than only
one community), and also is convenient to intercept possible

Fig. 2. Kemeny indicator vs. Node degree. The six existing communities can be clearly identified by visual inspection. Assuming that up to 10 individuals
can be tested, the black circles show those that would be chosen according to their highest Kemeny value, while the nodes in magenta correspond to the
nodes (i.e., individuals) with highest degree. Edges correspond to the random interactions on one day.

new virus outbreaks occurring in communities, when they are
still in their early stages.

Fig. 3. Comparison of different indicators in networks without community structure. If no communities exist, then all indicators appear to select
the same nodes (i.e., those with highest degree) for testing.

B. Impact of communities on indicators
The previous case study, exemplified in Fig 2, assumed the
presence of communities. We now show what happens when
a strong community structure does not exist. For this purpose,
Fig 3 and Fig 4 compare how different indicators provide
different outcomes depending on the existence or not of
communities. In particular, Fig 3 refers to a case where
people meet with the same probability (19 % again) people
belonging to their community and to other communities (i.e.,
communities degenerate into a single large community). In
this case, Fig 3 shows that both indicators based on node
degrees (on the left-hand side) and those based on random
walks (on the right-hand side) provide the same results. On
the other hand, when the probability of meeting people of
other communities is decreased, then communities emerge
from the graph, and the two categories of indexes clearly
provide different results, see Fig 4.
C. Impact of tests on the dynamics of an epidemics
We now try to quantitatively evaluate the impact of using one
specific indicator over another one (i.e., Kemeny indicators
vs. Node degree) in terms of the spreading of the virus.
For this purpose, every day we consider a graph created
according to the usual probabilities previously outlined. On
the first day, we assume that 2 individuals randomly chosen
are infected. Then, every day, each susceptible individual

who enters in contact with an infected individual has a
probability 10 % of being infected. Then, every day, using the
information retrieved by the contact tracing app, we assume
that the individuals who rank in the top positions according
to different indicators are tested. If they are found infected,
then they are quarantined for two consecutive weeks. Also,
in this case, all their contacts of the same day are tested (and
quarantined if positive). Note that in principle the procedure
may be iterated in the past (i.e., the contacts of the previous
days may be tested as well), but this is not considered here
for simplicity. Such a simple case study may be associated
with the spreading of the virus in a network of asymptomatic

Fig. 4. Comparison of different indicators in networks with community
structure. When communities arise, then it is easier to appreciate the different
strategies pursued by indicators based on node degrees (left) and those based
on random walks (right).

infected individuals, as we do not consider individuals who
may autonomously decide to get tested (e.g., because they
have developed symptoms), and only individuals detected by
the test are quarantined.
Fig 5 shows the results of running 20 repetitions of the
simulations for 30 days (repetitions are used to obtained
averaged results). The Kemeny indicator gives an improvement
by reducing the number of people infected, with a comparable
total number of days spent in quarantine by the population.
With the settings used, when more than 10 tests are assumed to
be available, then with the Kemeny indicator, it becomes much
more likely to restrict the infection to the local communities
initially infected. Also, it is possible to appreciate that much
better results are obtained by testing only 20 individuals per
day, targeting the individuals with highest Kemeny indicator,
than testing 25 individuals per day, targeting those with the
highest node degree. In Fig 5, on the right hand side, it can
be also seen that the number of infected individuals decreases
steadily when more people per day are tested, while the
number of individuals in quarantine oscillates (i.e., it is low
when very few individuals are tested, because few tests are
used, and when a lot of people are tested as well, because
fewer individuals are infected and require quarantine; highest
values are achieved for intermediate numbers of tests).
Fig 6 shows the results of running 20 repetitions of the
simulations for 30 days but with a fixed random network. The
network is sampled with the same strategy before on the first
day, but then kept fixed for further days. All other aspects of
the simulation are as before. In this case, a paradoxical result
is obtained, which is that the same individuals are tested, most
likely, every day (because most part of the graph remains fixed,
and accordingly, more likely the same individuals have highest
node degree, or give rise to the highest values of the Kemeny
indicator). Accordingly, much fewer individuals than before
are quarantined during the simulations.

D. Simulations on Benchmark Graphs
The objective of this section is to validate the previously
described findings in networks that are known to realistically
capture relations in contact networks. In particular, we follow
the procedure described in [29] (where it was observed that
human contact networks exhibit strong community structure,
in the context of immunization interventions) to generate
networks with community structure, which we briefly report
below, taken from [29] (for simplicity, sizes have been scaled
to be consistent with our simulations, and to allow for simple
visual inspections of the results):
1) 6 small-world communities of 40 nodes are first created
using the Watts-Strogatz algorithm [30], so that each
node has exactly 8 edges connecting to nodes of the
same community;
2) We then add 240 edges randomly to connect different
communities;
3) We then rewire between-communities edges so that they
become within-community edges. In doing this, the modularity of the graph increases, and we stop the procedure
once a desired level of modularity is achieved.
In particular, we terminate the previous procedure when
a modularity equal to 0.8 is achieved (as before), as this
is known to be consistent with many contact networks
investigated in the literature [29].
Also for such realistic networks, very similar results have been
obtained, as depicted in Fig 7.
The adopted procedure gives rise to networks with an average degree of 10, which is in line with general findings
regarding social contact patterns. However, it is reasonable to
presume that after a first wave of COVID-19, individuals will
meet fewer people than they did before the disease (due to
adoption of non-pharmaceutical interventions, like observation
of distance measures). Accordingly, Fig 8 further compares
Kemeny-testing and node degree testing, assuming that the
initial communities are created with node degree 8 (as before),
6 and 4 (step 1 of the previous procedure; final modularity is
maintained constant equal to 0.8). When networks with smaller
average node degrees are considered, then fewer edges appear
in the graph (including fewer edges that connect different
communities), and the improvement of Kemeny-based testing
over node degree becomes more relevant than before.
E. Effect of Compliance
An important issue related to contact tracing apps, regards
whether people will indeed comply with the national, or local,
recommendations of downloading and installing the same
app to reconstruct daily graphs of contacts [1]. This issue
appears particularly compelling for the case of Kemeny-based
testing: roughly speaking, Kemeny-based testing works well
because bridges between communities are identified, which
implies that individuals travelling from one (already infected)
community to another (fully healthy) community are detected
in the early stages of a new virus outbreak. However, if only

Fig. 5. Dynamics of the virus for different testing strategies. Impact of testing individuals using metrics based on the Node Degree (top) or Kemeny
indicator (bottom) on the left-hand side. On the right-hand side, the average number of infected and quarantined individuals on each day of the simulation.
Figures are averaged over 20 repetitions of the simulation process, to give insight into the level of variability between runs.
Number of Infected Individuals, with Node Degree

250

Number of Daily Infected Individuals

140
5 tests - Kemeny
10 tests - Kemeny
20 tests - Kemeny
25 tests - Kemeny
5 tests - Node Degree
10 tests - Node Degree
20 tests - Node Degree
25 tests - Node Degree

120
200
100
150

80
60

100

40
50
20
0

0

5

10

20

25

0

0

5

10

Number of Infected Individuals, with Kemeny-based indicator

250

15

20

25

30

25

30

Day of simulation

Number of tests

Number of Daily Individuals in Quarantine

80
5 tests - Kemeny
10 tests - Kemeny
20 tests - Kemeny
25 tests - Kemeny
5 tests - Node Degree
10 tests - Node Degree
20 tests - Node Degree
25 tests - Node Degree

70
200
60
50

150

40
100

30
20

50
10
0

0

5

10

20

25

0

0

5

10

15

20

Day of simulation

Number of tests

Fig. 6. Dynamics of the virus for different testing strategies, with a fixed graph. Impact of testing individuals on a fixed network using metrics based on
the Node Degree (top) or Kemeny indicator (bottom) on the left-hand side. On the right-hand side, the average number of infected and quarantined individuals
on each day of the simulation. Figures are averaged over 20 repetitions of the simulation process, and on average fewer individuals are quarantined in this
case, as most likely the same individuals are tested every day.
Number of Infected Individuals, with Node Degree

250

Number of Daily Infected Individuals

140

5 tests - Kemeny
10 tests - Kemeny
20 tests - Kemeny
25 tests - Kemeny
5 tests - Node Degree
10 tests - Node Degree
20 tests - Node Degree
25 tests - Node Degree

120
200
100
150

80
60

100

40
50
20
0

0

5

10
Number of tests

20

25

Number of Infected Individuals, with Kemeny-based indicator

250

0

0

5

15
Day of simulation

20

25

30

25

30

Number of Daily Individuals in Quarantine

35

5 tests - Kemeny
10 tests - Kemeny
20 tests - Kemeny
25 tests - Kemeny
5 tests - Node Degree
10 tests - Node Degree
20 tests - Node Degree
25 tests - Node Degree

30
200
25
150

10

20
15

100

10
50
5
0

0

5

10
Number of tests

20

25

a fraction of the population runs the contact tracing app,
then some community bridging individuals may be missed,

0

0

5

10

15
Day of simulation

20

undermining the main strengths of Kemeny indicator-based
tests. On the other side, it is less clear how compliance would

Fig. 7. Comparison in benchmark graphs. Impact of testing individuals using metrics based on the Node Degree (top) or Kemeny indicator (bottom), in a
realistic graph created according to the procedure proposed in [29]. The left-hand figures show the total number of people who were infected during a 30-day
simulation. The right hand figures show the cumulative number of days spent in quarantine for members of the population (N = 240). The boxplots show
the distribution of 20 repetitions of the simulation process, to give insight into the level of variability between runs.
Number of Infected Individuals, with Node Degree

250

Number of Daily Infected Individuals

200

200

5 tests - Kemeny
10 tests - Kemeny
20 tests - Kemeny
25 tests - Kemeny
5 tests - Node Degree
10 tests - Node Degree
20 tests - Node Degree
25 tests - Node Degree

150

150
100
100
50

50

0

0

5

10
Number of tests

20

25

Number of Infected Individuals, with Kemeny-based indicator

250

0

0

5

140
120
100
80

100

20

25

30

25

30

5 tests - Kemeny
10 tests - Kemeny
20 tests - Kemeny
25 tests - Kemeny
5 tests - Node Degree
10 tests - Node Degree
20 tests - Node Degree
25 tests - Node Degree

160

150

15
Day of simulation

Number of Daily Individuals in Quarantine

180

200

10

60
40

50

20
0

0

5

10
Number of tests

20

25

0

0

5

10

15
Day of simulation

20

Fig. 8. Comparison in benchmark graphs for graphs with different average node degree. Impact of testing individuals using metrics based on the
Node Degree (top) or Kemeny indicator (bottom), in a realistic graph created according to the procedure proposed in [29], for graphs with different average
node degree is shown on the left-hand side. While the community structure of the graph remains the same, when smaller node degree are considered, the
improvement of Kemeny-based testing over node degree testing becomes more relevant. 25 daily tests, and 20 repetitions of each instance have been considered.
On the right-hand side, the number of infected and quarantined individuals is shown.
Number of Infected Individuals, with Node Degree

250

Number of Daily Infected Individuals

120

Mean ND comm. 8 - Kemeny
Mean ND comm. 6 - Kemeny
Mean ND comm. 4 - Kemeny
Mean ND comm. 8 - ND
Mean ND comm. 6 - ND
Mean ND comm. 4 - ND

100

200

80
150
60
100
40
50

0

20

4

6

8

0

0

5

10

Node degree of initial small world communities
250

15

20

25

30

Day of simulation

Number of Infected Individuals, with Kemeny-based indicator

Number of Daily Individuals in Quarantine

180

Mean ND comm. 8 - Kemeny
Mean ND comm. 6 - Kemeny
Mean ND comm. 4 - Kemeny
Mean ND comm. 8 - ND
Mean ND comm. 6 - ND
Mean ND comm. 4 - ND

160
200

140
120

150

100
80

100

60
40

50

20
0

4

6

Node degree of initial small world communities

8

0

0

5

10

15

Day of simulation

20

25

30

affect node degree-based testings.

Percentage of susceptible individuals
at the end of the simulation [%]

Fig. 9. Effect of compliance. Percentage of individuals who remain healthy
throughout the simulation of 30 days, assuming different percentages of
individuals who install the contact tracing app. Kemeny-based testing appears
more effective than node degree testing for all different levels of compliance.
25

Kemeny
Node Degree

20

15

10

5

0
30

40

50
60
70
80
Percentage of individuals who install the app [%]

90

100

For this purpose, Fig 9 compares the percentage of individuals who remain healthy throughout the 30-day simulation
assuming that 20 individuals (out of a population of 240)
are tested every day according to either the Kemeny-based
indicator or according to the Node Degree (results are averaged
over 20 different simulations, to filter out stochastic effects).
It is interesting to note that independently from the fraction
of individuals who install the app, and thus are traced in
practice, the Kemeny-based indicator appears to consistently
outperform the one based on the node degree.
F. Weighted Undirected Graphs
So far, we have restricted our interest to unweighted undirected graphs. One reason for doing so is that most centrality
indicators are usually defined upon the adjacency matrix (e.g.,
node degree or random walk betweenness), rather than on the
transition matrix. However, assuming that the contact tracing
app does not simply store the information about whether a
contact has occurred or not, but also the duration of a contact,
or the distance between two individuals during a contact, then
a different probability of infection may be associated with each
different contact.
We now provide a simple solution to take into account
weighted graphs, where we assume that the weights are
proportional to the duration of a contact. In particular, we
assume that a probability equal to 1 is associated with a
contact that lasts for 10 hours (and also for durations longer
than 10 hours), and a probability equal to 0.025 (i.e., 2.5%)
for contacts that last 15 minutes. Contacts that last less than
15 minutes are not recorder by the app, while for contacts of
intermediate duration between 15 minutes and 10 hours, the
probability changes in a linear fashion (in practice, for such
intermediate values, the probability is equal to the duration
of the contact in minutes divided by 600). While this is
a very simple way to model the probability of infection
proportionally to the duration of a contact, any other more
sophisticated model may be used without affecting our
general discussion at all.

In addition, we add an extra ‘idle’ state to represent the
possibility that one infected individual does not pass the
infection to anybody else (e.g., because he/she had no contacts
during the day). Then, from the idle state, we assume that
with equal probability it is possible to pass to any other state
(i.e., to any individual in the network). The trick of adding an
extra idle state has been well explored in the Markov chain
community, for instance to avoid having absorbing states in the
chain, and sometimes is denoted as “teleportation” [23]. In our
application, the interpretation of the teleportation possibility
is particularly convenient and meaningful, as it corresponds to
the possibility that the virus is spread without a proper contact
occurring: so this can be used to model the fact that individuals
may get infected even after contacts that last less than 15
minutes (and are not recorded by the app), or even if a proper
contact does not occur at all (for instance, if the infection
is taken after touching an infected surface). In this case, the
interpretation of what people should be tested according to
the Kemeny indicator is less intuitive, as not all edges are
equally important (i.e., equally dangerous for spreading a
virus), and the chosen individuals are not just bridges between
communities. An example of what individuals are chosen is
depicted in Fig 10, where the weights of edges are represented
by changing the thickness of the edges (i.e., a thicker edge
corresponding to a longer contact). The interest of this last
section is that indicators that exploit transition matrices (e.g.,
like the Kemeny constant) may be used to analyze unweighted
graphs, while other indicators that exploit adjacency matrices
(e.g., like the previously mentioned indicator based on random
walk betweenness, that in the case of unweighted graphs
provided similar results to the Kemeny constant) fail to take
into account such important further information (e.g., duration
of contacts).
IV. D ISCUSSION
While this is the first use of the Kemeny constant in sampling
problems that we are aware of, it is related to several other
methods in the literature. In particular, as mentioned, the
connection to the random walk betweenness indicator is
immediate. However, it is worth noting some important
advantages of the Kemeny constant.
•

First, from a merely computational point of view,
calculation of the Kemeny constant is of the same
computational complexity as that of calculating the
determinant, and thus does scale well with the size of
the network. From this perspective, it is more convenient
than the random walk betweenness indicator.

•

Second, differently from the random walk betweenness,
and other similar indicators that are computed on the
basis of the adjacency matrix, the Kemeny constant is
computed using the transition matrix. Accordingly, it
can take into account weighted graphs, as illustrated
through a specific case study, where the probability of
infections can be properly modelled, assuming that the

Fig. 10. Kemeny-testing in weighted graphs. When edges have different weights (represented with lines of different thickness), then this further information
is taken into account when choosing who should be tested according to the indicator based on the Kemeny constant.

contact tracing app has the ability to keep track of the
duration of contacts, and/or of the relative distance.
This allows for asymmetric and variable transmission
probabilities between different communities [18].
•

Third, directionality can be important. Diseases can have
asymmetric transmission paths between compartments.3
Furthermore, behavioural differences between communities, such as non-homogeneous wearing of face-masks,
is also likely to lead to further asymmetries in transmission.4 Such asymmetries lead to directed graphs. While
the Kemeny constant readily extends to such situations,
it is not immediately evident how other similar indicators
extend to this case in a computationally efficient manner.

A. Proactive intervention
Note that in most simulations, while the nodes remained in
the same community throughout, the graph representing their
interactions was drawn randomly each day, with further randomness about whether an edge was effective in transmitting
disease. This means that individual nodes do not remain in
their role as potential bridges between communities for more
than that day. In the second simulation we employed a graph
with fixed structure then simulated random interactions on the
3 For example, in COVID-19 there is some evidence that children may be
less susceptible to transmission than adults [15], [24] although in a study
in Shenzhen, China, it was suggested that they were equally susceptible to
infection [3]).
4 Non wearers may be at an increased likelihood of infection, but are also
much more likely to infect others.

edges to provide a more realistic model which would have
more consistency between days, allowing us to benefit further
from the precision of the Kemeny indicator.
In this scenario, nodes near bridges between communities
would be likely to face repeated testing on multiple days. In
real life this might face resistance, depending on the context.
For example, while testing professionals, such as care workers
repeatedly as part of their job would probably have high
compliance, there may be others who would resist that. An
alternative approach is to identify and intervene with bridge
nodes proactively before infection. Such intervention could
include quarantine measures, or more targeted education or
police enforcement.
Comment 1: Our motivation is to make the research and
public health communities aware of a tool that can be
used in the context of contact tracing. Since most of the
currently proposed contact tracing apps do not enable a
central picture of the connectivity graph, a natural question
concerns the utility of any such approach, given privacy
concerns about centralised government knowledge of social
graph structures. This is a valid concern. While not the
concern of this present paper, we note here that distributed
estimation of the Kemeny constant is in principle possible
by initializing multiple random walks along the connectivity
graph. Such strategies are considered in [28] in the context
of a distributed reinforcement algorithm, and can be enabled
and secured using distributed ledger technology. The study of
such algorithms will be the subject of future publications.

Comment 2: In this manuscript we mainly focused on the
consequences of node removal actions, as they correspond
to quarantining an individual. However, one may think of
some softer alternatives, such as warning individuals when
they move from one community to another one. Given the
shown dangerous potential of individuals who serve as bridges
between different communities, it may be interesting to devise
strategies to educate individuals (e.g., through smartphone
warnings) to observe more prudential behaviours. While such
warnings, on the one side, may be seen as privacy intrusive,
and limiting of one’s freedom, still they are less limiting
than directly quarantining individuals, and also cheaper and
quicker actions than testing.
Comment 3: This work directly applies the ideas pioneered in
[7] by some of the authors of the present manuscript. In that
paper the Kemeny indicator, had been used to identify critical
nodes and edges in networks, according to a node removal
and renormalization approach. Since publication of that paper
in 2011, many authors have applied the same idea in different
application domains; see for example [2] in Markov influence
graphs.
V. C ONCLUSION
We have presented a framework for using the change in the
Kemeny constant of a graph to identify and analyze bridges
between sub-communities. The use of the Kemeny indicator
is computationally convenient, and also supports the study of
weighted and directed graphs.
Applications of testing, tracking and tracing will be critical
in helping countries to safely reopen activities after the first
wave of the COVID-19 virus, but they will be faced with
limitations on the number of tests they can apply each day,
and the compliance of the population in respecting quarantine
isolation measures. The theoretical and simulation results
presented in this paper show how the application of graph
theory and the Kemeny indicator can be conveniently used
to efficiently identify and block new virus outbreaks as early
as possible by removing possible ‘super-spreader’ links that
transmit disease between different communities.
The simulation models have deliberately been kept very
simple, to illustrate the core concepts, but the work should
be applicable to any simulation model which incorporates a
graph or network representation of the population and their
interactions. The work also has implications for the design of
tracking processes and apps, to ensure that they can provide
complete information on both the adjacency of nodes and the
transition matrix.
We believe that our work can be interestingly extended under
a significant number of lines of research, including among
others:
• As mentioned, we have not taken into account the dynamic evolution of contact graphs day after day. Sim-

•

•

ilarly, information about who has been tested in the
previous days could be further employed to decide who
should be tested;
So far, we have presented the Kemeny indicator method
and the node degree as two alternative competing methods for deciding who should be tested. However, an
optimized combination of individuals who maximize one,
or the other, indicator may actually be the best solution to
combine the advantages of the two methods (i.e., intercept
‘super-spreaders’ before they infect new communities,
and to mitigate the spread within a community;
While our paper so far aims to illustrate the differences
between different indicators in terms of who should be
tested in networks, more sophisticated epidemiological
models may be used to better evaluate the impact of
different testing strategies [13].
R EFERENCES

[1] A Review of International Approaches to Test, Trace, Isolate. In Royal
Society DELVE Initiative, 2020.
[2] J. Berkhout and B. F. Heidergott. Analysis of markov influence graphs.
Operations Research, 67(3):892–904, 2019.
[3] Q. Bi, Y. Wu, S. Mei, C. Ye, X. Zou, Z. Zhang, X. Liu, L. Wei, S. A.
Truelove, T. Zhang, W. Gao, C. Cheng, X. Tang, X. Wand, Yu Wu,
B. Sun, S. Huang, Y. Sun, and T. Feng. Epidemiology and transmission
of COVID-19 in 391 cases and 1286 of their close contacts in Shenzhen,
China: a retrospective cohort study. The Lancet Infectious Diseases,
2020.
[4] J. Breen, S. Butler, N. Day, C. Dearmond, K. Lorenzen, H. Qian,
and J. Riesen. Computing Kemeny’s constant for Barbell-type graphs.
Electronic Journal of Linear Algebra, 35:583–598, 2019.
[5] G. E. Cho and C. D. Meyer. Comparison of perturbation bounds for
the stationary distribution of a Markov chain. Linear Algebra and its
Applications, 335:137–150, 2001.
[6] R. Cohen, S. Havlin, and D. Ben-Avraham. Efficient immunization
strategies for computer networks and populations. Physical review
letters, 91(24):247901, 2003.
[7] E. Crisostomi, S. Kirkland, and R. Shorten. A Google-like model of
road network dynamics and its application to regulation and control.
International Journal of Control, 81(3):633–651, 2011.
[8] M. Dahlel. Inching back to normal after COVID-19 Lockdown quantification of interventions. Keynote Talk, Workshop on Modeling and
Prediction of Covid-19, 2020.
[9] P. G. Doyle. The Kemeny constant of a Markov chain. arXiv preprint
arXiv:0909.2636, 2009.
[10] L. Ferretti, C. Wymant, M. Kendall, L. Zhao, A. Nurtay, L. AbelerDörner, M. Parker, D. Bonsall, and C. Fraser. Quantifying SARS-CoV2 transmission suggests epidemic control with digital contact tracing.
Science, 368:6491, 2020.
[11] L. C. Freeman. A set of measures of centrality based upon betweenness.
Sociometry, 40:35–41, 1977.
[12] L. C. Freeman. Centrality in social networks: conceptual clarifications.
Social Networks, 1:215–239, 1979.
[13] G. Giordano, F. Blanchini, R. Bruno, P. Colaneri, A. Di Filippo,
A. Di Matteo, and M. Colaneri. Modelling the COVID-19 epidemic
and implementation of population-wide interventions in italy. Nature
Medicine Letters, pages 1–32, 2020.
[14] V. Grolmusz. A note on the PageRank of undirected graphs. Information
Processing Letters, 115(6-8):633–634, 2015.
[15] D. F. Gudbjartsson, A. Helgason, H. Jonsson, O. T. Magnusson, P. Melsted, G. L. Norddahl, J. Saemundsdottir, A. Sigurdsson, P. Sulem,
A. B. Agustsdottir, B. Eiriksdottir, R. Fridriksdottir, E. E. Gardarsdottir,
G. Georgsson, O. S. Gretarsdottir, K. R. Gudmundsson, T. R. Gunnarsdottir, A. Gylfason, H. Holm, B. O. Jensson, A. Jonasdottir, F. Jonsson,
K. S. Josefsdottir, T. Kristjansson, D. N. Magnusdottir, G. Sigmundsdottir L. le Roux, G. Sveinbjornsson, K. E. Sveinsdottir, M. Sveinsdottir,
E. A. Thorarensen, B. Thorbjornsson, A. Löve, G. Masson, I. Jonsdottir,
A. D. Möller, T. Gudnason, K. G. Kristinsson, U. Thorsteinsdottir, and

[16]

[17]

[18]

[19]
[20]
[21]
[22]

[23]
[24]

[25]
[26]
[27]
[28]

[29]

[30]
[31]

K. Stefansson. Spread of SARS-CoV-2 in the Icelandic population. New
England Journal of Medicine, 382;24, June 2020.
B. He, S. Zaidi, B. Elesedy, M. Hutchinson, A. Paleyes,
G. Harling, A. Johnson, and Y. Whye The.
Technical
document 3: Effectiveness and resource requirements of
Test, Trace and Isolate strategies.
In DELVE report,
https://rs-delve.github.io/ pdfs/2020-05-27-effectiveness-and-resource-requirements-of-tti-strategies.pdf ,
26th May 2020.
J. Hellewell, S. Abbott, A. Gimma, N. I. Bosse, C. I. Jarvis, T. W.
Russell, J. D. Munday, A. J. Kucharski, and W. J. Edmunds. Feasibility
of controlling COVID-19 outbreaks by isolation of cases and contacts.
The Lancet Global Health, 2020.
C. I. Jarvis, K. Van Zandvoort, A. Gimma, K. Prem, P. Klepac, G.J.
Rubin, and W. J. Edmunds. Quantifying the impact of physical distance
measures on the transmission of COVID-19 in the UK. BMC medicine,
18:1–10, 2020.
M. J. Keeling and K. T. D. Eames. Networks and epidemic models.
Interface, the Royal Society Publishing, 2(4):295–307, 2005.
J. G. Kemeny and J. L. Snell. Finite Markov Chains. Van Nostrand,
Princeton, 1960.
S. Kirkland and Z. Zeng. Kemeny’s constant and an analogue of Braess
paradox for trees. Electronic Journal of Linear Algebra, 31:444–464,
2016.
A. J. Kucharski, P. Klepac, A. Conlan, S. M. Kissler, M. Tang,
H. Fry, J. Gog, J. Edmunds, and Cmmid Covid-19 Working Group.
Effectiveness of isolation, testing, contact tracing and physical distancing
on reducing transmission of SARS-CoV-2 in different settings. MedRxiv,
4(20077024):23, 2020.
A. N. Langville and C.D. Meyer. Google’s PageRank and beyond: The
science of search engine rankings. Princeton university press, 2006.
E. Lavezzo, E. Franchin, C. Ciavarella, G. Cuomo-Dannenburg, L. Barzon, C. Del Vecchio, L. Rossi, R. Manganelli, A. Loregian, N. Navarin,
D. Abate, M. Sciro, S. Merigliano, E. Decanale, M. C. Vanuzzo,
F. Saluzzo, F. Onelia, M. Pacenti, S. Parisi, G. Carretta, D. Donato,
L. Flor, S. Cocchio, G. Masi, A. Sperduti, L. Cattarino, R. Salvador,
K. A.M. Gaythorpe, A. R Brazzale, S. Toppo, M. Trevisan, V. Baldo,
C. A. Donnelly, N. M. Ferguson, I. Dorigatti, and A. Crisanti. Suppression of COVID-19 outbreak in the municipality of Vo, Italy. medRxiv,
2020.
M. Levene and G. Loizou. Kemeny’s constant and the random surfer.
American Mathematical Monthly, 109:741–745, 2002.
M. E. J. Newman. A measure of betweenness centrality based on random
walks. Social Networks, 27:39–54, 2005.
OECD. Testing for COVID-19: A way to lift confinement restrictions.
In Tackling Coronavirus (COVID-19): Contributing to a global effort,
2020.
R. Overko, R. H. Ordóñez-Hurtado, S. Zhuk, P. Ferraro, A. Cullen,
and R. Shorten. Spatial positioning token (SPToken) for smart mobility. IEEE International Conference on Connected Vehicles and Expo
(ICCVE), pages 1–6, 2019.
M. Salathé, C. L. Althaus, R. Neher, S. Stringhini, E. Hodcroft, J. Fellay,
M. Zwahlen, G. Senti, M. Battegay, A. Wilder-Smith, et al. COVID-19
epidemic in Switzerland: on the importance of testing, contact tracing
and isolation. Swiss medical weekly, 150(11-12):w20225, 2020.
D. J. Watts and S. H. Strogatz. Collective dynamics of ’small-world’
networks. Nature, 393:440–442, 1998.
R. Yaesoubi and T. Cohen. Generalized Markov models of infectious
disease spread a novel framework for developing dynamic health policies. European Journal of Operation Research, 213(3):679–697, 2011.

