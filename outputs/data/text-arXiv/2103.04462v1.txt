arXiv: arXiv:0000.0000

arXiv:2103.04462v1 [stat.ME] 7 Mar 2021

Improving Bayesian estimation
of Vaccine Efficacy
Mauro Gasparini
Department of Mathematical Sciences “G.L. Lagrange”
Politecnico di Torino
e-mail: mauro.gasparini@polito.it
Abstract: A full Bayesian approach to the estimation of Vaccine Efficacy
is presented, which is an improvement over the currently used exact method
conditional on the total number of cases. As an example, we reconsider the
statistical sections of the BioNTech/Pfizer protocol, which in 2020 has led
to the first approved anti-Covid-19 vaccine.
MSC2020 subject classifications: Primary 62FXX, 62FXX; secondary
62F15.
Keywords and phrases: Covid-19, Pfizer, BioNTtech.

1. Introduction
The so-called “exact method conditional on the total number of cases” is a
Bayesian approach to the estimation of vaccine efficay (VE) which has been
used in the recent pivotal clinical trial of the anti Covid-19 Vaccine sponsored
by Pfizer/BioNTech ([2]) and has also been mentioned in the analogous paper
about the vaccine sponsored by Moderna ([1]), the other currently approved
mRNA based vaccine. The name “exact method conditional on the total number
of cases” comes from that citation in the latter work.
In addition to the enormous impact of these new therapies on the lives of
billions of people, it should be stressed that these were some of the first major
clinical trials adopting Bayesian methods for planning and analysis, something
many statisticians have been advocating for quite some time now.
Nonetheless, the exact method conditional on the total number of cases is
only an approximate Bayesian approach, since it makes only partial use of the
full likelihood and of the Bayesian updating mechanism. In particular, the total
number of cases and the surveillance times of the vaccinated and of the placebo
cohorts are treated as known parameters instead of observed statistics, hence the
adjective “conditional”: the method is a partially Bayesian method conditional
on the the total number of cases and on the surveillance times.
This work contains a more complete full Bayesian approach which takes as
starting point the same assumptions of the conditional method but generalizes it by computing the distributions of the total number of cases and of the
surveillance times and by including them in the full model.
The exact method conditional on the total number of cases is described in
Section 2, while the full Bayesian model is derived in Section 3. Section 4 con1

Gasparini/Vaccine Efficacy

2

tains a revisitation of the Pfizer/BioNTech results and a comparison with the
full Bayesian approach.
2. The exact method conditional on the total number of cases
The “exact method conditional on the total number of cases” relies on the
mathematical assumption that the infection processes can be modeled by two
overlapping homogeneous Poisson processes: one for vaccinated participants with intensity λv - and an independent one for the control (not vaccinated)
participants - with intensity λc . The time dimension of the Poisson processes is
called “surveillance time” and it is measured in person-years of follow-up. It is
the sum of all durations participants have been experiencing in the clinical trial
from 7 days (for the BNT162b2 mRNA vaccine) after the second dose up until
the earliest of the following four endpoints happens: onset of disease, death,
loss to follow up or end of study. A common measure of comparison between
two infection processes in Epidemiology is the incidence rate ratio IRR= λv /λc ;
based on it, the percentage version of VE is defined as
100 × VE = 100 × (1 − IRR) = 100 × (1 −

λv
),
λc

(2.1)

which can be interpreted as the average percentage of missed infections (percentage of not infected vaccinated participants who would have been infected if
not vaccinated). In order to estimate VE, one can define a likelihood based on
the following statistics:
•
•
•
•

sv = surveillance time of the vaccine cohort,
sc = surveillance time of the control cohort,
xv + xc = total number of infections,
xv = number of infections in the vaccine cohort.

Using standard probability symbolism, the joint density of the corresponding
random variables (indicated in capital letters), which is the dual way of writing
the likelihood, can be expressed as
fSV ,SC (sV , sC |λV , λC ) × fXV +XC |SV ,SC (xv + xc |sV , sC λV , λC )×

fXV |XV +XC ,SV ,SC (xV |xv + xc , sV , sC λV , λC ) (2.2)

i.e. as the chain product of the marginal density of SV , SC times the conditional
density of XV + XC times the conditional density of XV given xV + xC , which
can be easily proved to be binomial:
fXV |XV +XC ,SV ,SC (xv |xv + xc , sv , sc λv , λc ) =


xv 
xc
sv λv
xv + xc
sv λv
1−
xv
sv λv + sc λc
sv λv + sc λc

(2.3)

Gasparini/Vaccine Efficacy

3

Notice that the probability of infection in this formula is
θ=

sv (1 − VE)
sv λv
=
.
sv λv + sc λc
sv (1 − VE) + sc

(2.4)

The exact method conditional on the total number of cases consists of assuming
that the first two factors of the likelihood (2.2) do not depend on VE, substituing de facto the binomial expression (2.3) for the full likelihood (2.2). To
complete the analysis, a conditional Bayesian approach is then followed and a
conjugate prior Beta(a,b) is given to the parameter θ. Once the posterior is obtained, the mean a posteriori (MAP) estimate, Bayesian credible intervals and
posterior probabilities can be computed regarding θ and, working equation (2.4)
backward, regarding VE itself. An example from the Pfizer/BioNTech paper is
discussed in Section 4.
3. An alternative full Bayesian model
It is not true that the first two factors of the likelihood (2.2) are independent of
VE. Imagine studies that go on for a long time: the ratio between the control
surveillance time sc and the vaccinated surveillance time sv approximates then
the ratio of the two mean times to infection, by the law of large numbers applied
once to the numerator and once to the denominator of the ratio. Now, the ratio of
the two mean times is exactly 1-VE, since the times to infection are exponentially
distributed with mean 1/λv for the vaccinated and 1/λc for the control groups.
Hence, the ratio of the surveillance times does contain some extra information
about VE, in addition to the numbers of cases in the two groups. In practice,
things are complicated by the fact that the study must have a finite duration
D.
Now, it is not impossible to derive an explicit expression for the full likelihood (2.2). Fist, one should notice that fXV +XC |SV ,SC (xv + xc |sV , sC λV , λC ) is
Poisson(sV λV +sC λC ) by the properties of two independent overlapping Poisson
processes. Next, the total surveillance times are the sum of many i.i.d. random
variables, each of them given by the minimum between the time to infection and
a random censoring time. By the central limit theorem, the surveillance time
of each of the two cohorts is therefore approximated normal as in the following theorem, where a reasonable specific assumption is made about the patient
recruiting process.
Theorem 3.1. Under the following assumptions:
1. an infection process is homogeneous Poisson with intensity λ;
2. no participant is lost to follow up;
3. the recruitment process is uniform between beginning of study and a study
duration D;
the mean surveillance time S/n, where n is the number of recruited participants,
is asymptotically normal with mean
E(min(T, C)) =

1
exp(−λD) − 1
(1 +
)
λ
λD

(3.1)

Gasparini/Vaccine Efficacy

4

and variance
1
Var(min(T, C)) = 2
λ



4 exp(−λD)
exp(−λD) − 1 2
2 exp(−λD) +
− (1 +
)
λD
λD
(3.2)

Proof. The potential infection time is exponential with rate λ and can be censored by an independent censoring random variable C. By assumption 3, C can
be written as D −U , where U is uniform between 0 and the recruitment duration
D. Therefore it has itself a uniform distribution between 0 and D. Next,
Z ∞
E(min(T, C)) =
P(min(T, C) > t)dt
Z0 ∞
=
P(T > t)P(C > t)dt
Z

0

D

D−t
dt
D
0
exp(−λD) − 1
1
)
= (1 +
λ
λD

=

2

E(min(T, C) ) =

Z

exp(−λt)

∞

P(min(T, C)2 > t)dt

0

=
=

Z

∞

P(T >

√
√
t)P(C > t)dt

Z0 ∞

P(T > x)P(C > x)2xdx


4 exp(−λD)
1
,
= 2 2 exp(−λD) +
λ
λD
0

and the variance can be obtained as stated by computing
Var(min(T, C)) = E(min(T, C)2 ) − (E(min(T, C)))2
Finally, the central limit theorem applies.
Having completed the construction of the likelihood, to obtain a full Bayesian
model only the prior on (λv , λc ) remains to be decided. A natural proposal is
to have independent gamma priors with hyperparameters (av , bv ) and (ac , bc ).
The scale parameters bv and bc should then be chosen to give λv and λc the
right order of magnitude. For example, having a prior guess λbc for the average
number of infected people in the unit time - something we may estimate based
on the natural history of the disease - we could set bc = ac /λbc and, for the lack
of better information, impose bv = bc . Next, the two hyperparameters aV and
aC can be chosen by gauging V E = 1 − λv /λc . For example, noticing that
E(VE) = 1 − E(λv )E(1/λc ) = 1 −

av b c
,
b v ac − 1

(3.3)

Gasparini/Vaccine Efficacy

5

then, if bc = bv , then we could finally set
ac =

c
1 + ac − VE
c
1 − VE

c is a suitable prior guess for VE, with 0 ≤ V E ≤ 1 (there would be no
where VE
point in experimenting with a vaccine for which the expected VE is negative,
since that case would imply λv > λc ).
Finally, the choice of av could be driven by noticing that av = 1 allows
for an inverted J-shape density on λv , which is therefore exponential. WIth
this choice, bc = bv = (λbc )−1 , i.e. the average time to infection of a randomly
selected participant in the control group. Notice also that in this case ac > 1,
which would allow for the prior expectation of VE in formula (3.3) to exist,
positive.
To recap, here’s the full Bayesian model proposed, which is also illustrated
graphically by its associated Directed acyclic Graph (DAG) in Figure 1
λv ∼ Gamma(av , bv )

λc ∼ Gamma(ac , bc )
sv |λv ∼ Normal(nv E(min(Tv , Cv )), nv Var(min(Tv , Cv ))

sc |λc ∼ Normal(nc E(min(Tc , Cc )), nc Var(min(Tc , Cc ))
XV + XC |SV , SC , λV , λC ∼ Poisson(sV λV + sC λC )


sv λv
.
XV |XV + XC , SV , SC , λv , λc ∼ Binomial xv + xc ,
sv λv + sc λc

with E(min(Tv , Cv ))Var(min(Tv , Cv )), E(min(Tc , Cc ))Var(min(Tc , Cc )) given in
Theorem 3.1 for the vaccine and the control group respectively and the following
default choices:
av = 1
d
2−V
E
d
1−VE
bv = bc = (λbc )−1 .
ac =

The following theorem draws a connection to the exact method conditional on
the total number of cases.
Theorem
3.2. If λv
λc ∼ Gamma(ac , bc ), then

∼

Gamma(av , bv )

and,

independently,

bv λv
∼ Beta(av , ac ).
bv λv + bc λc
Proof. It is easy to see that bv λv ∼ Gamma(av , 1) and , independently, bc λc ∼
Gamma(ac , 1). Then, by the well known Renyi’s representation of a Dirichlet
distribution, which in one dimension is the same as a Beta distribution, the
theorem follows.

Gasparini/Vaccine Efficacy

6

If we used the data-dependent prior bv = sv and bc = sc , then the full
model would approximate the exact method conditional on the total number
of cases (see equation 2.4). That is not what is recommended here though,
since data-dependent priors are difficult to accept and instead the prior choice
bv = bc = (λbc )−1 discussed above looks more reasonable.
4. The Pfizer/BioNTech protocol revisited
Several computational strategies are available for the full Bayesian model, the
easiest being MCMC simulation of the exact posterior distribution of VE. Among
the many possibilities available nowadays, the sofware OpenBUGS
(http://www.openbugs.net/) has been used here. The model and data files
necessary to run the MCMC simulation in OpenBUGS are listed in the Appendix. The following results are taken from Table 2 of [2]:
nc = 17411

sample size of the vaccinated cohort

nv = 17511
sv = 2214

sample size of the control cohort
surveillance time of the vaccinated cohort

sc = 2222
xv = 8

surveillance time of the control cohort
number of cases in the vaccinated cohort

xc = 162

number of cases in the control cohort

D = 0.29

enrollment duration, in years

and, according to the discussion at the end of Section 3, they have been programmed together with the following choice of the parameters to mimick the
method used in [2]:
av = 0.7, bv = 2214 ac = 1, bc = 2222.
The results of the Bayesian analysis are summarized in the posterior mean of
percentage VE, equal to 93.7, and in the posterior equal tail 95% credible interval
(89.0,97.0). The results reported in [2] are instead a posterior mean equal to 95.0
and a posterior interval (90.3,97.6) for VE. We notice a basic agreement of the
results, but a larger uncertainty regarding VE in the full Bayesian model due
to the more accurate complete accounting of sampling variation.
By proceeding instead following the recommendations at the end of Section
3 and assuming an average infection time equal to a week ((λbc )−1 = 0.01917808
years), one would have used instead
av = 1, bv = 0.01917808 ac = 2.428571, bc = 0.01917808.
and obtained a posterior mean equal to 93.6 and a posterior interval (89.0,97.0)
for VE. That does not differ from the full Bayes analysis due to the very large
sample sizes, which make the influence of the prior disappear and provide substantial evidence for the validity of the Pfizer/BioNTech vaccine.

Gasparini/Vaccine Efficacy

7

✟
☛
λv
✡
✠
❆
✟
✟
❆
❄
✟
✟ ☛
✟✟✏✏✡ Sv ✠❆
✏
❆❆❯
✏
✟✟✏
✙
❄✟ ☛
✮
☛✟
✟
✟
☛
✛ Xv + Xc
Xv
VE
✡❍
✠
✡
✠
✡
✠
✐
P
❨
❍ P
❍ PPP☛✻ ✟ ✁✁✕
❍❍
Sc
✠✁
❍❍✡
✁
❍ ✻ ✟
☛
✁
✡ λc ✠
Fig 1. DAG for the full Bayesian model for Vaccine Efficacy. Double arrows indicate a
functional relationship.

5. Conclusions
From a theoretical point of view, a new fully Bayesian coherent model is developed here for VE. It does not provide results in strong contrast with the
approximations in the original paper [2], which exhibits large sample sizes and
uncontroversial positive results. The new model may be the theoretical basis
for the other vaccines currently under development, which may not exhibit the
same size of VE. For those, a careful and motivated prior may make a difference.
6. Appendix
The model of the OpenBUGS program is
model{
lambdac ~ dgamma(ac,bc)
lambdav ~ dgamma(av,bv)
sc ~ dnorm(expsc, tausc)
sv ~ dnorm(expsv, tausv)

Gasparini/Vaccine Efficacy

8

tausc <- 1/(nv*varsc)
tausv <- 1/(nv*varsv)
expsc <- nc*(1- (1-exp(-lambdac*D))/(lambdac*D)) / lambdac
varsc <- (2*exp(-lambdac*D) + 4*exp(-lambdac*D)/(lambdac*D) pow((1-(1-exp(-lambdac*D))/(lambdac*D)),2))/pow(lambdac,2)
expsv <- nv*(1- (1-exp(-lambdav*D))/(lambdav*D))/lambdav
varsv <- (2*exp(-lambdav*D) + 4*exp(-lambdav*D)/(lambdav*D) pow((1-(1-exp(-lambdav*D))/(lambdav*D)),2))/pow(lambdav,2)
cases ~ dpois(meancases)
meancases <- sc*lambdac + sv*lambdav
xv ~ dbin(theta, cases)
theta <- sv*lambdav/(sc*lambdac + sv*lambdav)
VE <- 1 - lambdav/lambdac
}
whereas the data of the OpenBUGS program is
list(av=1, bc=0.01917808,
### full Bayes prior for lambdac
ac= 2.428571, bv=0.01917808,
### full Bayes prior for lambdav
#
ac=1, bc=2222,
### Pfizer prior for lambdac
#
av=0.7, bv=2214,
### Pfizer prior for lambdav
nc=17511,
### ss for c
nv=17411,
### ss for v
sc=2222,
### surveillance time for c
sv=2214,
### surveillance time for v
cases=170,
### totalnumber of cases
xv=8,
### infected among vaccinated
D=0.29
### duration of uniform recruitment
)

References
[1] Baden, L.R. et al. (2021). Efficacy and Safety of the mRNA-1273 SARSCoV-2 Vaccine. The New England Journal of Medicine, Vol. 384, 403–416.
[2] Polack, F.P. et al. (2020). Safety and Efficacy of the BNT162b2 mRNA
Covid-19 Vaccine. The New England Journal of Medicine, Vol. 383, 2603–
2615.

