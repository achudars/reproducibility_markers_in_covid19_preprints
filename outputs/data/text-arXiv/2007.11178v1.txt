Optimal policies for mitigating pandemic costs
M. Serra† ,1 S. al-Mosleh† ,1 S. Ganga Prasath,1 V. Raju,1 S.
Mantena,1 J. Chandra,1 S. Iams,1 and L. Mahadevan1, 2, 3, ∗

arXiv:2007.11178v1 [physics.soc-ph] 22 Jul 2020

1

School of Engineering and Applied Sciences, Harvard University, Cambridge MA 02143.
2
Department of Organismic and Evolutionary Biology,
Harvard University, Cambridge, MA 02138, USA
3
Department of Physics, Harvard University, Cambridge, MA 02138, USA
(Dated: July 23, 2020)

Several non-pharmaceutical interventions have been proposed to control the spread of the COVID19 pandemic. On the large scale, these empirical solutions, often associated with extended and
complete lockdowns, attempt to minimize the costs associated with mortality, economic losses and
social factors, while being subject to constraints such as finite hospital capacity. Here we pose
the question of how to mitigate pandemic costs subject to constraints by adopting the language of
optimal control theory. This allows us to determine top-down policies for the nature and dynamics of
social contact rates given an age-structured model for the dynamics of the disease. Depending on the
relative weights allocated to life and socioeconomic losses, we see that the optimal strategies range
from long-term social-distancing only for the most vulnerable, to partial lockdown to ensure not
over-running hospitals, to alternating-shifts with significant reduction in life and/or socioeconomic
losses. Crucially, commonly used strategies that involve long periods of broad lockdown are almost
never optimal, as they are highly unstable to reopening and entail high socioeconomic costs. Using
parameter estimates from data available for Germany and the USA, we quantify these policies and
use sensitivity analysis in the relevant model parameters and initial conditions to determine the
range of robustness of our policies. Finally we also discuss how bottom-up behavioral changes can
also change the dynamics of the pandemic and show how this in tandem with top-down control
policies can mitigate pandemic costs even more effectively.

I.

INTRODUCTION

As of July 2020, the virus SARS-CoV-2 has infected
more than thirteen million and been responsible for more
than half a million deaths globally, devastating communities, economies and societies along the way [1]. In the
absence of therapies and vaccines to combat the COVID19 disease, the primary approach to mitigate these losses
has been to minimize the rate of spread of the infection transmitted primarily via the respiratory tract - by controlling social interactions. At an extreme, this has led
to the complete lock-down of entire societies, reducing
social contacts to a minimum required for essential services. While this strategy reduces the infection rate dramatically [2], it is unsustainable over longer terms owing to the considerable economic and social losses that
it eventually entails - from loss of productivity to the
collapse of vulnerable communities. This raises the natural question: how can one run a viable society limiting
the life, social and economic costs of the pandemic, while
maintaining essential services and constrained by finite
resources such as hospital capacity?
Mathematical models of the pandemic and its control
by limiting social interactions and/or changing individual
and collective behavior can help us understand the range
of plausible scenarios and interventions [3]. Naturally,
any model and the strategies that it suggests are only as

∗

lmahadev@g.harvard.edu;
† equal contribution

good as the assumptions that it is based on and the data
that feed into it. Here, we approach this question with
the aim not as much as to be able to predict the course
of the pandemic, but instead to use a set of minimal
models grounded in data to provide qualitative scenarios
for policies that mitigate the costs of the pandemic and
sharpen the question of how to compare different policies.
The dynamics of epidemics has been the subject of
mathematical study for more than a century since the
pioneering work of Ross, Kermack and McKendrick
[4, 5]. The theoretical framework for the evolution of epidemics takes the form of either deterministic or stochastic integro-differential equations for the rates at which a
population of susceptible (S), infected (I) and recovered
(R) individuals vary in space-time [6–10]; the simplest
form of these models is the well known SIR model [11].
Using this model and its variants, optimal strategies for
containment of an epidemic in the form of vaccination
and/or isolation while discounting future costs and allowing for stochastic effects [12, 13] have been studied
for nearly fifty years. In the context of the current pandemic, this thread has been revived to determine a range
of non-pharmaceutical interventions (NPIs) in different
minimal scenarios [14] inspired by optimal control theory [15].
In order to help generate efficient NPIs, a model needs
account for (i ) the differential vulnerability of populations as a function of age [10] that also accounts for their
differences in social contact rates [10], (ii ) the costs due
to morbidity, mortality and healthcare (life) costs as well
due to socioeconomic factors driven by distancing mea-

2
compartments i = y, o (y < 60 years; o > 60) to account
for the differential vulnerability, contact structure, infection and recovery rates in these sub-groups. Denoting by
Si (t), the number of susceptible people in the age group
labeled by i, Ii (t), the corresponding number of infected,
and Ri (t), the number of recovered, the dynamical equations for their evolution is given by [16]:
X
Ij
Ṡi = − β
Si Cij
,
Nj
j=y,o
I˙i = β

X
j=y,o

Si Cij

Ij
− γ Ii ,
Nj

(1)

Ṙi = γ Ii ,

FIG. 1: Schematic of the 2-age SIR model. Si is
the susceptible population, Ii the infected population
and Ri the recovered with i = Young, Old. The
controller u(t) affects the dynamics of infected through
βCij , where Cij is the contact matrix (Eq. 2). The
objective function we minimise is composed of life,
economic and social costs (Eq. 3a). The right panels
illustrate how u(t) modulates the time evolution of
infections in the young and old populations differently,
optimally accounting for their intrinsic dynamics.

sures, (iii ) constraints due to finite resources e.g. hospital beds and intensive care units (ICU) capacity, (iv )
the possibility of batching strategies, where people participate economically in separate shifts and (v ) the behavioral dynamics of people driven by knowledge of infections. Here, we extend a classical epidemiological model
to account for these features and pose and solve an optimal control problem to generate policies for mitigating
pandemic costs as a function of the relative weights associated with health and socioeconomic costs.

II.

MATHEMATICAL FRAMEWORK
Optimal control model

Rather than using sophisticated spatio-temporal models that account for multiple compartments, stochasticity
etc. but require multiple parameters (that still remain
difficult to estimate from data), we modify the simple
but effective SIR model to capture the essential features
of the pandemic (See SI for an extension of our model to
include a fourth compartment corresponding to the ”exposed” individuals; our qualitative results are robust to
this change).
Our SIR model is assumed to have two epidemiological

where Cij represents the number of contacts a person of
age i makes with people from age j (per day), β corresponds to the nominal rate of infection from contacts
and γ is the nominal recovery rate, Ni is the population of age group i and we define the total population as
N = N1 + N2 , subject to the constraint N1 C12 = N2 C21
since the total number of contacts is symmetric.
We assume that the main control measure available to
policy makers is to enforce a reduction of the contact rate
between individuals in different age groups. Then, if we
take the contact matrix to be
0
C
Cij = Cij
− u(t) Cij
,

(2)

0
Cij

where
represents the nominal contact matrix between
C
people in the absence of control measures, and Cij
encodes the relative change in contact structure imposed
by the control function u(t) that characterizes the magnitude of the lock-down. In our minimal framework, we
assume that u is a scalar time-dependent function, so that
an age-structured social-distancing policy enters through
C
the form of Cij
, which we choose so as to reduce contacts
with the older, more vulnerable population more strongly
(See SI for details).
To determine the strategy u(t), we need to define an
objective cost function that must be minimized, and accounts for a life cost in terms of the proliferation of infections, a measure of economic cost (loss), and a social
cost associated with the burdens due to social distancing
measures. We further require that the total number of
people in critical condition (defined as a weighted fraction
of those infected) is below the finite number of available
hospital beds/ ICUs. Then, we may write the optimal
control problem for the control u(t) formally as follows:
G(x,u,t)

Z
arg min
u

0

Glife

=

αL

Gecon.

=

αE

Gsocial

=

αS

T

z
}|
{
(Glife + Gecon. + Gsocial )dt,


py Iy (t) + po Io (t)
(3a)
NICU


N − Iy (t) − Io (t)
1−
(1 − u(t))
N

2
u(t)
,
uM

3
subject to the SIR model (1) and the constraints:
IC (t) ≡

py Iy (t)+po Io (t)
NICU

≤ 1,

0 ≤ u ≤ uM .

(3b)

Here, the first term Glife is the cost associated with the
expected fraction of people needing ICUs (relative to the
total number of available ICUs (NICU )), where the parameters py (po ) are the (known) probabilities that an
infected young (old) person will need an ICU. The second
term Gecon. is the economic cost associated with the loss
in production capacity due to a reduction in the number
of productive individuals. While it is possible to use more
complex forms, e.g. the Cobb-Douglas function [17], this
increases the number of parameters that we have to fit,
and so we have chosen to use a simple linear form (See SI
for the results using a nonlinear Cobb-Douglas function
with the same qualitative trends). The quantity (1−u(t))
represents the fraction of people allowed to work [18]
which is multiplied by the fraction of productive individuals (not infected). Finally, the social cost Gsocial grows
with social distancing and becomes larger with u(t) relative to the maximum lock-down uM which defines the
minimum residual contact rate between individuals possible, e.g. due to families (which can vary across cultures
and societies [19]); we use a simple quadratic form to
strongly penalize increase in u(t) (See the SI for an exponential functional form which produces similar results
to those presented here). The integrand to be minimized
has three normalized costs with αL , αE and αS being
the relative weights associated with life, economic and
social costs. A complete derivation of the nonlinear differential equations associated with the optimal control
problem obtained by the minimization of the constrained
functional Eqs. (3a-3b) is given in the SI. There are a
number of parameters in our problem, most of which can
be estimated from data. From the perspective of the policy, there is freedom to vary the relative weights of life,
economic and social costs αL , αE , αS , and the desired nature of the contact structure imposed by the lock-down
C
Cij
. Once these are chosen, the governing differential
equations associated with optimal control (see SI) were
solved using the Open Optimal Control Library (Open
OCL) [20], which uses the nonlinear optimization tool
CasADi [21], via the MATLAB interface.

Parameter estimation

From the perspective of optimal control theory, our
aim is to estimate system parameters in absence of control measures, and then let the policy modulate the effective social contact structures within a given time horizon.
This is to be contrasted with data-driven models that focus only on short-term predictions using model predictive
control or its variants [22]. Our reasons for this are primarily associated with the present lack of fine-grained
data that would allow for continuous adjustments in the

controller. Instead, by using a classical optimal control
framework and sensitivity analysis, our analysis provides
longer-term robust policies.
The two nominal time scales in the problem are the
infection and recovery rates β, γ respectively, which we
extract from publicly available data (see SI for details).
In addition, we need to extract the following quantities
from data for solving the above control problem: the
0
nominal contact matrix Cij
, its leading eigenvalue c0 , the
total number of people in each age-group Nj , the initial
number of infected and recovered individuals Ii (0), Ri (0),
the probability of old and young people needing critical
care po , py , the limits on the number of ICUs (NICU ) and
the maximum value of the control uM . Our parameter
estimates focused on Germany because there are publicly available age-structured datasets over a sufficiently
long duration before and after the onset of lock-down
[23]. The data used for estimating the growth rate of
the infected population is the time series of confirmed infected cases in Germany that captures the total of all currently active infections as well as recovered individuals,
I(t)+R(t). From this data set we extract the growth rate
of the number of active infections in the early exponential
growth phase. This quantity, given as ρ = β c0 − γ, is related to the doubling time through Tdoubling = log(2)/ρ.
For the German data, we find that the doubling time is
about 3.5 days, i.e. ρ = 0.2 ± 0.03. In order to estimate
the basic reproduction number R0 = β c0 /γ [24], we use
its relation to the growth rate and the serial interval, the
mean duration from the onset of symptoms of an infector to the onset in a person they infected [25], to get
R0 ≈ 2.2 (see SI for details). Using these values we find
β = 0.036 and γ = 0.16.
The German dataset also shows that the ratio between the young and old infected populations is approximately constant and is given by Iy /Io = 3.8. This ratio reflects the dominant eigenvalue of the contact matrix and its left eigenvector (see SI for details). We use
this ratio, along with the constraint N1 C12 = N2 C21 ,
to estimate the contact matrix given in the SI. When
assessing the different control measures (Results Section), we will need the infection fatality rate (IFR) for
the two age groups. Following the Centers for Disease
Control and Prevention (CDC) data [26], we estimate
the IFRs to be 0.001 and 0.02 for the young and old
populations. From [26], we also find that py = 0.0076
and po = 0.031. These estimates were adjusted to account for an asymptomatic ratio of 35% (see SI for details). Finally, ICU capacity estimates are taken from
[27]. For Germany NICU = 34 × 10−5 N while for the
U.S. NICU = 26 × 10−5 N . To account for uncertainties
we include a safety factor in these estimates and design
our control policy using 0.8 ∗ NICU ≥ py Iy + po Io . By
comparing the growth rate (of the infected population) in
the phase before shelter in place to the phase afterwards
in Germany, we find uM = 0.85 [28]. When choosing CC
we assume that, when a fraction u of the young population is in lockdown, a (bigger) fraction u/uM of the old

4
population is (See SI).

III.

RESULTS

Top-down optimal policies

We quantify the performance of the different policies
associated with our choice of αL , αE , αS , with three difRT
ferent measures: Ec = αE1 T 0 Gecon. (t) dt, which
quantifies economic loss and represents the fraction of
S (T )−S (0)
days of lost economic activity, ND = y N y ×0.001+
So (T )−So (0)
× 0.02, which is the expected fraction of the
N
population that will die after one year, computed from estimates of the infection fatality rate for the young (0.001)
and the old (0.02) populations, and TC , the time spent
at peak hospital capacity. Table I shows the performance
of different strategies using these measures.
As a benchmark, we first assumed equal weights,
αL,E,S = 1 and calculated the optimal solution for this
case. The results, shown in Figs. 2A-B suggest that the
optimal controller starts with no lockdown i.e. u = 0,
and increases with the rise in the number of infecteds,
reaching its maximum around day 50. After this initial growth, due to decrease in the number of susceptible
people, the control measures gradually diminish over the
course of about 175 days, but then increases again with
a second peak soon after. This second peak is due to the
fact that the number of older infected in the population
slowly increases over the period of the decreasing partial lockdown, and eventually triggers an increase in the
lockdown to prevent the number of older people who are
infected from increasing further. This second peak in the
lockdown makes the total period of saturated hospital
capacity end sooner as can be observed. We emphasize
that our scalar controller modulates the time evolution
of infections in the young and old populations differently,
optimally accounting for their intrinsic dynamics. Figure
2B shows the life, economic and social costs associated
with this solution; the life cost tracks the weighted number of severely ill patients IC (t), the economic cost Gecon.
tracks the control variable u(t) since we have assumed
a linear relationship linking them in (3a), and the social cost is quadratic in the control cost u(t). For the
αL,E,S = 1 solution, we lose 18% of economic activity
with 0.3% death rate after one year.
Moving away from the benchmark case of αL = αE =
αS = 1 and weighting the socioeconomic burdens relative to life costs changes the policies. In Fig. 3A we
show that weighting the socioeconomic costs (αL = 0.2 <
αE = αS = 1) strongly leads to the disappearance of the
second peak in the social distancing control parameter
u(t), along with a corresponding reduction in duration
of the control measures (Ec = 0.14) and a corresponding increase in the time spent at critical ICU capacity by
30% (Table I). We note that increasing the socioeconomic
weights much further does not change the qualitative na-

FIG. 2: Solutions of the optimal control problem.
(A) Solution to the optimal control problem described
in (3a) using the weights αL,E,S = 1. The quantity IC
((3b)) represents the expected number of patients
needing ICUs. The color of the plots determines the
y-axis (left or right) they should be read from. (B) The
values of the different costs (Glife , Gecon. , Gsoc. )
corresponding to panel (A). Parameters correspond to
data from Germany (see SI). For analogous results
using US data see the SI.

ture of the solution significantly because of the resource
constraint associated with ICU capacity. On the other
hand, as we increase the relative weight on the life cost
with (αL = 1.35 > αE = αS = 1), the resulting control
policy u(t) shown in Fig. 3B is similar to that shown in
Fig. 2A in the initial phase, starting at zero and then rising quickly. However, it will extend over a longer period
of time and the second bump will be more pronounced,
leading to a shorter time at maximum ICU capacity. Further increasing the weight to αL = 5 leads to a lockdown
of nearly constant intensity (Fig. 3C). Note that considerably increasing αL does not induce a much stronger
lockdown. This is because it is sufficient to reduce the
effective reproduction number to just below unity whence
the intrinsic dynamics of disease transmission will limit
the spread of the epidemic, and any farther increase in
u will just cause socioeconomic damages. A simple estimate of the maximum control required follows from the
relation (1−u) R0 = 1, leading to u ≈ 0.55, which is close
to the value observed in Fig. 3C. This strategy results in
low mortality (ND = 4 × 10−5 ) and no strain on hospital
capacity (Tc = 0), however, the economic burden will be
great (Ec ≈ 0.5). Therefore, we see that a strategy such
as the αL,E,S = 1 solution can strike a balance between
the two extremes in economic and life costs. Finally, Fig.
S1 shows the performance of a periodic strategy with
full lockdown (≈ 2 months) followed by reopening (≈ 2
months). This strategy leads to higher economic loss and

5

FIG. 3: Optimal control solutions for different weights on life and socioeconomic costs. (A) Same as Fig.
2A with high weights on the social and economic costs. This strategy results in a shorter lockdown period combined
with a longer period of maximum hospital capacity. (B) Increasing the weight on the life cost, αL = 1.35, leads to a
longer lockdown period and a shorter period of maximum hospital capacity. (C) Continuing to increase the weight
of the life cost leads to a constant lockdown (except near the end) to prevent the number of infections from
increasing. The values of αL are chosen to explore the different lockdown policies.

considerably exceeds hospital capacity.
αL = 1 αL = 5 αL = 0.2 Periodic Batching
Ec 0.18
0.48
0.14
0.50
0.20
ND 0.003 4 × 10−5 0.0036
0.0017
Tc
124
0
158
48

TABLE I: Comparing the performance of some
of the control strategies shown in Figs. (2 - 4).
Here Ec is the fraction of days of economic activity (per
person) lost, ND is the expected mortality rate (fraction
of dead in the population), Tc is the time spent at peak
hospital capacity. The periodic lockdown corresponds to
SI, Fig. S1. The batching column corresponds to
Fig. (4D) which may be compared with column αL = 1.
Throughout our analysis we fix αE = αS = 1.

Contact allocation and batching

Although the above framework provides the optimal
value of the control variable u(t), it doesn’t specify how
this can be realized in practice. The reduction in transmittance can be accomplished by reducing the number of
contacts, or reducing the probability of infection per contact. The latter can be accomplished by masks, hygiene
and other measures while the former can be accomplished
by reducing the density of people in public and private
gatherings. Naturally, reducing density can happen either through use of larger spaces or reducing the number
of people in contact by a factor of 1 − u, which we denote
as the participation number. Since it might not be feasible to enlarge the space of all gatherings, reduction in
participation number is a necessary strategy to achieve
a certain value of u. We now describe a solution to this
allocation problem and illustrate how choosing the right
strategies can result in a further reduction of infections
and economic losses for the same u.
For each strategy, we will take a given time period ∆t,
which for concreteness can be taken as one week, and

divide it into two shifts. For example a given work week
may be divided into two 3-day shifts. For simplicity, we
also assume that at the beginning of each week the groups
are selected from a homogeneous population (independently of age). More specifically, the ratio of susceptible
people in each group at the beginning of the week is the
same. This assumption, which may be relaxed, allows us
to easily extend the previous optimal control problem for
the case of batching strategies (see Fig. 4).
The first strategy involves having the same fraction
of people (N1 ) working for an extended period of time.
At a given time t, the susceptible population is given by
S1 (t) and the infected is I1 (t). We assume S1 (t)  I1 (t),
which has to be true for a well controlled epidemic that
is not near completion. Then, for a small enough period
∆t the number of infected increases by a factor
I(t + ∆t) = exp [γ (R(t) − 1) ∆t] I1 (t) + e−γ∆t I2 ,
(1 − u(t)) S(t) β
.
(4)
R(t) ≡
N (t) γ
In the second strategy, similar to that explored in [29],
the two groups N1 and N2 alternate participation in periods of ∆t/2 each. In time ∆t, each group has participated a time ∆t/2 and fully recovered with recovery rate
γ in a time period of ∆t/2 (see Fig. 4A). This combines
to give the total number of infected as (see SI for details)
 
 
R(t)
I(t + ∆t) = exp γ
− 1 ∆t I(t).
(5)
2
As an example, suppose that at time t = 0 we split the
population in half with I1 = I2 = I(0)/2. The ratio
of increments in the number of infected will initially be
given by

 


2 exp γ R20 − 1 ∆t
γ R0 ∆t
= sech
< 1.
exp [γ (R0 − 1) ∆t] + exp [−γ∆t]
2
So for large R0 the alternating strategy represents a significant improvement over the constant fraction strategy
(Fig. 4B).

6

FIG. 4: Optimal batching strategies. (A) The first row illustrates the reduction of transmission using batching
strategies with participation ratio (1 − u) = 0.5. By letting each group recover for half of the shifting period, 3 days
for example, and be active in the other, we reduce the effective reproduction number by a factor of 2. (B)
Comparison of the three different strategies for an epidemic with a basic reproductive number R0 = 3, γ = 0.16 and
a fixed u(t) = 0.5. Panels (C - E) show the solution of the optimal control problem with different values of αL
combined with the batching strategy, which effectively reduces β by a factor of (1 − u(t)) as given in Eq. (6).
Solutions obtained in this case achieve a better compromise between lives lost and economic loss. We can achieve
lower economic impact with a slightly lower mortality (C) or save many lives without an exceedingly high economic
cost (E). Compare panels C-E with Fig. 3. Similarly to Fig. 3B, the values of αL are chosen to explore the different
lockdown policies. Parameters correspond to the German data set (see SI).

For u = 0.5, we see that the alternating strategy effectively drops the reproduction number R0 by two (Eq. 5),
while the constant strategy just amounts to a decrease
in the initial number of actively infecting people by two
(Eq. 4). Figure 4B illustrates the difference between the
two solutions over the course of an epidemic with u = 0.5
and compares them to the case of a completely mixed
population.
In the third strategy, corresponding to the completely
mixed case there is no time for individuals to recover or
discover symptoms while in confinement, and everyone is
effectively always contributing to infection. For arbitrary
u(t), this strategy results in an effective growth rate (see
SI)
I(t + ∆t) − I(t)
= γ [(1 − u(t)) R(t) − 1] ,
∆t→0
∆t I(t)
lim

(6)

which reduces the effective reproduction number (Eq. 4)
by an extra factor of (1 − u).
With this result, we can implement the batching strategy in the optimal control framework described above.
The only modification needed is to replace β in Eq. (1)
with (1 − u) β (SI for details). The results obtained are
shown in Fig. (4). Note that the maximum lockdown required to stop the epidemic is now closer to u = 0.33
(Fig. 4E) compared with u = 0.55 in the absence of
batching (Fig. 3C). Furthermore, it is much easier in
the present case to achieve a compromise between life
and economic costs. Comparing the two socioeconomic
focused strategies (Fig. 3A v.s. Fig. 4C), we find that

batching achieves a 40% less economic losses. Comparing
Fig. 2A with Fig. 4D we see a 50% reduction in both the
number of lives lost and time spent at maximum hospital capacity with a negligible increase in economic losses
(Table I). Our minimal approach on how to include the
allocation problem into our optimal control framework
already shows the resulting improvement in mitigating
pandemic costs, at the slight expense of increasing the
logistical complexity of batching.

Sensitivity to parameters, cost functionals and
epidemic model

Our results so far are driven by our choice of the epidemic model, the choice of cost functionals and are predicated on the parameters extracted from data. Understanding the range of robustness of our results to these
choices requires us to vary each of these separately and
determine their effect on the resulting policies.
To understand the uncertainty in our parameter estimates, we perform a sensitivity analysis of the optimal control policy shown in Fig. 2A. The gray curves in
Fig. 5A delimit the possible changes of the optimal control when β, γ vary from the worst and the best case estimates obtained from data (see SI). This analysis shows
that the shape of the nominal optimal control strategy
(dashed black) is robust to uncertainties in β, γ. Figure
5B shows the sensitivity analysis with respect to changes
in the parameters py , po , NICU . A 30% increase of py in-

7

FIG. 5: Sensitivity of the optimal control strategy to parameters from German data estimates (see SI)
(A) Magnitude of the controller u(t) subject to the worst and the best case estimates for the β, γ parameter bounds.
I corresponds to the worst case (β = 0.042, γ = 0.14), II corresponds to the nominal case (β = 0.036, γ = 0.16)
shown in Fig. 2A, and III to the best case (β = 0.032, γ = 0.21). (B) Variation of the controller to changes py , po
and NICU . (C) Sensitivity of the controlled dynamics, using the nominal u, to uncertainties in the number of initial
infected Iy (0), Io (0). Contours correspond to maximum value of (py Iy (t) + po Io (t))/NICU , where
NICU = 0.0003 N . The uncertainty ranges of Iy (0)(Io (0)) span large deviations from their nominal value marked by
the black triangle. The black curves mark the critical level set beyond which the needed ICUs exceeds the available
ones. Two of such cases are shown in panels (D-E).

duces a moderate increase in the optimal u, while a similar increase of po leads to a larger change in lockdown
intensity. By contrast, a 30% increase of NICU reduces
the lockdown period by ≈ 70 days as well as the overall
lockdown strength. We note the robustness of the global
shape of the optimal u to changes in all parameters.
To quantify the sensitivity of the controlled dynamics
to uncertain initial conditions, we consider a uniform grid
of initial infected Iy (0), Io (0) spanning significant deviations from their nominal value marked by the black triangle. For each initial condition Iy (0), Io (0), we set Sy (0) =
Ny − Iy (0), So (0) = No − Io (0), Ry (0) = Ro (0) = 0, and
simulate the pandemic evolution using the nominal u.
As a performance metric, for each initial condition we
compute the maximum of (py Iy (t) + po Io (t))/NICU ,
where NICU = 0.0003 N , and plot the contour of
this scalar field in Fig. 5C. We note how these contours approximately run in the direction corresponding
to Iy (0) + Io (0) = constant, implying that our results
are more sensitive to uncertainty in the total number of
infected. The black curves mark the critical (i.e. equal
to 1) level set beyond which the needed ICUs exceed the
available ones. Overall, our optimal controller guarantees
that the number of available ICUs is enough for a large
set of uncertainties in initial infected. In Figs. 5D-E, we
show the evolution of the pandemic in two cases where
hospital capacity is exceeded. Given a nominal control
policy, underestimating the initial infected one expects a
shortage of available ICSs (Fig. 5D). However, it is less

intuitive that the same would happen when one designs
the optimal u overestimating the initial I (Fig. 5E). The
reason behind this surprising result is that minimizing
our costs tends to reduce u to avoid unnecessary socioeconomic damages. Figure 5E shows that starting from
smaller Iy (0), Io (0), it takes longer to manifest a significant increase of infected, and by that time, the nominal
decaying controller is unable to prevent exceeding hospital capacity.
To determine how our results change when using more
complex models, we repeat our analysis by (i) replacing
our SIR model by an SEIR model [30], which incorporates
an exposed but not yet infected group Ei , and (ii) altering the socioeconomic cost functions as described (see SI
for details). Neither of these chages the nature of our
solutions (Figs. S6 - S7).

Behavioral dynamics and bottom-up optimal policies

So far we have considered how the spread of infection
may be curbed by externally imposed lockdown measures. However, the dynamics of disease transmission
also critically depends on how people alter their behavior in response to perceived levels of risk [31]. To quantify
this notion, we note the observation that as the number
of (reported) cases goes up, without being forced to do
so, people will often spontaneously practice more social
distancing. This behavioral change can be minimally in-

8
corporated into the modified SIR model by making the
overall contact rate parameter β become a dynamical
variable whose evolution follows the simple law
β(t) − β0 (1 − δ tanh [v IC (t)])
dβ(t)
=−
,
dt
τ

(7)

where β0 is the reference level at the start of the epidemic,
the factor δ is a measure of the maximum change in β, v
determines the sensitivity of the behavioral response and
τ is the time scale associated with the dynamics behavior change. While these parameters may be estimated
by analyzing the effect of public events on mobility data
[32], this lies outside the scope of this paper.
This extension of the SIR model allows us study the
bottom-up response of the population to an evolving pandemic, and is particularly important for countries where
the social costs of an enforced (top-down) lockdown can
be high. Including (7) in our control framework (see SI
for details), we obtain different optimal scenarios by varying the parameter δ, which represents the magnitude of
the bottom-up behavioral response (Fig. 6). For small
values of δ (Fig. 6A), the solution is similar to the results
of Fig. 3, but with a slightly smaller enforced lockdown.
As we increase δ, the the optimal control u(t) decreases in
magnitude further until the two peaks become separated
by a region having u = 0. This implies that when people respond strongly to a peak in the number of reported
cases, there is no need for enforcing lockdowns from the
top-down with the associated social costs. As δ increases
further, the first peak goes away and we observe a later
peak in the optimal policy (Fig. 6C). This is because as
the number of reported cases drops, β increases, hence
requiring a top-down intervention to prevent a second
outbreak.

IV.

DISCUSSION

while reducing the life cost. We emphasize that even using an easily implementable scalar controller these policies reduce contacts in the young and old age groups differently (Eq.(2)), accounting for their intrinsic dynamics
(Figs. 2-4).
Solutions that heavily weight economic costs start with
no lockdown (u(t) = 0) and only reduce contacts as the
number of infections rises to near hospital capacity. Such
a strategy results in a higher fraction of the population
getting immunity, allowing the control to progressively
drop down to zero over time. This is to be contrasted
with measures implemented by many countries, which
start with a severe lockdown and then proceed to open
up. Unless full lockdown is implemented for the entire
duration of the pandemic (Fig. 3C), the risk of outbreaks
remains extremely high when societies reopen (SI, Fig.
S1), sadly being seen right now.
Complete lockdown (u(t) = 1) is not required in general to stop the spread of the epidemic, and instead it
is enough to bring the effective reproduction number to
a little less than unity. This is why in Fig. 3C, with a
higher weight on the life cost, the value of u(t) does not
exceed (R0 − 1)/R0 ≈ 0.55.

Batching outperforms bulk strategies with marginally higher
logistic costs

An effective SIR model that incorporates batching
strategies into the optimal control framework lead to a
60% reduction in the period of saturated hospital capacity and 50% less mortality, with negligible increase of
economic losses (Table I). Furthermore, the minimum required value to√suppress the
√ epidemic in this case drops
down to u = ( R0 − 1)/ R0 ≈ 0.33 (see Fig. 4E). In
other words, about 70% of people could be participating
economically and working without any outbreaks, as long
as 60% of them are cycling in alternating shifts.

The value of a mathematical model is in its ability to (i)
abstract a minimal framework that clearly lays out the
underlying assumptions and (ii) use analysis combined
with experimental data to provide qualitative insights
that go beyond verbal reasoning. If these lead to a sharpening of the original question and direct further investigations, the model has served its purpose. We close with
a discussion of the qualitative insights from the preceding
calculations, highlight the limitations of our model, and
suggest possible future improvements to the question of
how NPIs might minimize pandemic costs.

Including bottom-up behavior changes due to risk perception in our optimal control problem shows that a significant reduction in hospital load can be achieved with
mild imposed lockdowns (Fig. 6C). This is due to the
self-imposed isolation from people as the number of reported cases increases.

Age-structured partial lockdown outperforms periodic
lockdown

Sensitivity analysis quantifies robustness of policies to
parameter uncertainty

Taking into account the mortality and morbidity differences in addition to the difference in contact rates between and among the different age groups, we found optimal policies that better mitigate socioeconomic losses

The nature of the optimal lockdown policy is robust to
a range of uncertainty in the relevant model parameters
and initial conditions (Fig. 5). Figure 5C illustrates
the effects of wrongly estimating the initial infected on

Bottom-up behavioral dynamics helps mitigating pandemic
costs

9

FIG. 6: Changing behavior in response to risk perception. (A) Solution for the optimal control problem with
behavioral dynamics incorporated (Eq.7). The parameters used are the ones extracted from German data (see SI),
in addition to αL,E,S = 1, τ = 2γ −1 , v = 1 and δ = 0.2. (B & C) Same as (A) with different values of δ. Note how in
(C), as the number of infections starts to decrease, the top-down control is required to increase to avoid further
outbreaks.

reaching hospital capacity. We find that both large underestimates (Fig. 5D) and, interestingly, overestimates
(Fig. 5E) of initial conditions can lead to a crisis driven
by exceeding hospital capacity. The latter is because
the nominal controller is out of phase with the dynamics
of the disease: it peaks too early and decays when the
actual number of infected cases is increasing.
This last problem is exacerbated by delays in the onset
of symptoms which makes using tests to estimate the
current state of the system very difficult. Extrapolation,
in addition to current test results, should be used to
assess the current number of infections.

Polcies are robust to form of socio-economic cost within a
class of epidemic models

Our analysis is predicated on the classical SIR Model
and a minimal cost that weights life, social and economic
factors differentially. Replacing the SIR with the SEIR
model, which incorporates an exposed but not yet infected group Ei and using different forms of the socioeconomic cost does not change the qualitiative nature of
our solutions, highlighting the robustness of our study
(Figs. S6 - S7).

Accuracy of parameter estimation affects the robustness of
optimal policies

While using real data allows to estimate the model parameters, and simulate and quantify the outcome of different optimal policies, the limited amount of data has
made some parameters difficult to estimate, particularly
those associated with infection rates. As more high quality data becomes available, our results may have to be
updated in two ways: the nature of the optimal policies
might change, and the range of robustness implied by
sensitivity analysis will also vary.

Minimal framework does not account for stochasticity,
additional compartments, spatial variability, complex
batching and control

Our simple SIR model with a two-age structure
captures critical features in the dynamics of disease
spread, such as the initial exponential growth, final
herd immunity and their relation to the basic problem
parameters. However, there are several effects that we
have not included. The most important are to include
the effects of additional compartments. Since COVID-19
is known to be transmitted through asymptomatic
and presymptomatic individuals (which may be a viral
evolutionary adaptive strategy [33]), estimating the
effect of these could be an important addition to the
present analysis.
In addition, we have not explicitly accounted for
stochasticity in disease transmission. Instead, we used
a safety factor in NICU , and carried out a sensitivity
analysis with respect to changes in the model parameters
and initial conditions. In the early stages of the disease,
given the importance of small number fluctuations,
stochastic epidemic models [10, 16] might be more
suitable.
Finally, adding more control inputs and complex batching of populations can lead to strategies that better
exploit clinical and epidemiological differences between
the different age groups and provide a better solution to
the optimal allocation problem involving spatiotemporal
interventions. Such changes, however, are likely to be
more difficult to deploy.

ACKNOWLEDGEMENTS

We are grateful to Andrea Galeotti and Oliver Watson
for illuminating discussions, and acknowledge support
from the Schmidt Science Fellowship (MS) and the Postdoc Mobility Fellowship from the Swiss National Foundation (MS) and the Harvard QBIO Initiative (LM).

10

Supplemental Information

MODEL

Our model is a modification of the classical SIR model that accounts for an age-structured population with a
non-trivial contact structure that follows the dynamics given by
Ṡi = − λi (t)Si ,
I˙i = λi (t)Si − γIi ,

(S.1)

Ṙi = γIi ,
X
Ij
,
λi (t) = β
Cij
N
j
j=1,2

(S.3)

(S.2)

(S.4)

0
C
Cij = Cij
− u(t)Cij
.

(S.5)

To keep the model simple, we assumed only two age classes, and a scalar control parameter u ∈ [0, uM ] that modulates
the constant control-contact matrix CC (S.5). For notation simplicity, we define the modified contact matrices C̃
with entries C̃ij = Cij /Nj . Using Eqs.(S.4-S.5), we write λ as
λ = β C̃0 I − uβ C̃C I,

(S.6)

0
where I = [Iy , Io ]> . Denoting by D0 (x) the open-loop vector with entries Di0 = β C̃ij
Ij Si , and by DC (x) the vector
C
C
with entries Di = −β C̃ij Ij Si , we can rewrite the dynamical system in compact form as




 
−D0 (x)
−DC (x)
Ṡ
=
+u
,
D0 (x) − γI
DC (x)
İ
{z
}
|
{z
}
| {z } |


ẋ

f 0 (x)

f (x, u) = f 0 (x) + uf C (x),

x(0) = x0 .

(S.7)

f C (x)

Because uM < 1, if C0 = CC , Cij > 0. To model a policy that favors contact inhibition of the old population using
a scalar controller, we choose

 0
0
/uM
Cyy Cyo
.
(S.8)
CC =
0
0
/uM
Coo
Coy
This corresponds to reducing the density of the young population by a factor of (1 − u) and the old population by the
smaller factor (1 − u/uM ). For simplicity, we assumed that the rate of contacts with a population is proportional to
the number of them not in lockdown, which leads to the given form of the CC . Note that when u = uM , the second
column of Cij will be zero, the minimum allowed value. In that case, the number of participating people in the old
population has been reduced to zero. If the restriction in contacts is done differently, for example if both populations
have the same participation ratio but older people are given stronger protective equipment, the expression for the
matrix CC will be different.
The expression for the economic cost in the main text could be changed to account for the different rates of
quarantine among the age groups. Specifically,



Ny − Iy (t)
No − Io (t)
u(t)
Gecon. = αE 1 −
(1 − u(t)) −
1−
.
(S.9)
N
N
uM
However, since this is not expected to change the qualitative nature of our results, we used the factor of (1 - u) for
both populations in the economic cost.
OPTIMAL CONTROL

In this section, we derive the set of equations to solve our optimal control using the Pontryagin’s Maximum Principle
or indirect method [15, 34]. The derivation below applies to the optimal control problem described in Eq. (3) of the
main text and can be adjusted accordingly for the control problems involving batching or behavioral dynamics.

11
Constraints and Lagrange multipliers

In the language of optimal control, we have a Lagrange problem, with mixed inequality constraints


u
g(u) =
≥ 0, t ∈ [0, T ],
uM − u

(S.10)

and pure state inequality constraints
h(x) = NICU − (py Iy (t) + po Io (t)) ≥ 0, t ∈ [0, T ].

(S.11)

Pure state constraints are usually more difficult to handle because they can be controlled only indirectly trough
Eq (S.12). We note that with a scalar controller it is typically not possible to enforce more than one pure state
constraint as the corresponding full rank condition would not be satisfied.
The pure state inequality constraint is of order one, as u appears for the first time in h1 = dh(x(t))/dt =
h∇x h, f (x, u)i


∇x h = 0, 0, −py , −po ; h1 = hp, −D0 (x) + γI − uDC (x)i ,
(S.12)
where p = [py , po ]> and h., .i is the inner product between vectors. With respect to the constraint h(x) ≥ 0, an
interval (θ1 , θ2 ) ⊂ [0, T ] is called an interior interval if h(x) > 0, ∀ t ∈ (θ1 , θ2 ). If the optimal trajectory hits the
boundary, i.e., satisfies h(x, t) = 0, then [τ1 , τ2 ] is the boundary interval. An instant τ1 is called an entry time if there
is an interior interval ending at t = τ1 and a boundary interval starting at τ1 . Correspondingly, τ2 is the exit time
if a boundary interval ends and an interior interval starts at τ2 . If the trajectory just touches the boundary at time
τ , while it is in the interior just before and just after τ , then τ is called a contact time. Taken together, entry, exit,
and contact times are called junction times. The pure state constraint is full rank on any boundary interval [τ1 , τ2 ]
because


rank[∂h1 /∂u] = rank −h[py , po ], DC (x)i = 1
(S.13)
from the definition of DC (x). The mixed inequality constraint is also full rank because
rank[∂g/∂u, diag(g)] = 2

(S.14)

along any optimal solutions. This full rank condition ensures that the gradients with respect to u of all the mixed
constraints are linearly independent.
The Lagrange multipliers must satisfy the complementary slackness condition
µ1 ≥ 0, µ1 u = 0
µ2 ≥ 0, µ2 (uM − u) = 0
η ≥ 0, η(NICU − (py Iy + po Io )) = 0, η̇ ≤ 0.

(S.15)
(S.16)
(S.17)

Solving the optimal control problem

Using the indirect method maximum principle [15], we can then define the Hamiltonian and the associated Lagrangian as
H(x, u, ζ ) = hζζ , f 0 (x)i + hζζ , uf C (x)i − G(x, u),

(S.18)

µ, g(u)i + ηh1 (x),
L(x, u, ζ , µ , η) = hζζ , f 0 (x)i + hζζ , uf C (x)i − G(x, u) + hµ

(S.19)

where ζ (t) is the adjoint vector, and µ (t), η(t) the Lagrange multipliers associated to the inequality constraints. We
note that maximizing −G with respect to the control variable is equivalent to minimizing G with respect to it.
From the maximizing condition H(x∗ , u∗ , ζ ) ≥ H(x∗ , u, ζ ), the optimal controller u∗


N − Iy∗ − Io∗
u2M
C ∗
∗
∗
ζ
ζ
hζ , f (x )i − αE
.
(S.20)
u (ζ , x ) =
2αS
N

12
In the interior of the feasible domain, i.e. where h(x∗ ) > 0, g(u∗ ) ≥ 0, while when x∗ is on the boundary xb , ub∗
should satisfy the additional condition
h1 (xb , ub∗ ) ≥ 0,

xb = {x : h(x) = 0}.

(S.21)

The differential equation for the adjoint vector ζ is

ζ̇ζ = −

∂L(x∗ , u∗ (ζζ , x), ζ , µ , η)
= −[∇x hf (x∗ , u∗ (ζζ , x∗ )), ζ i]> + [∇x G(x∗ , u∗ (ζζ , x∗ ))]> − [∇x h1 (x∗ , u∗ (ζζ , x∗ ))]> η
∂x
(S.22)

ζ (T − ) = [∇x h]> γ = 0

(S.23)

where γ ≥ 0, γh(x∗ , T ) = 0 and Eq. (S.23) describe the transversality condition arising from the pure state constraint.
In the presence of inequality constraints, the optimal solution needs to satisfy additional conditions which will
provide the remaining equations for the η and µ . To identify the ODE associated with the Lagrange multiplier η, we
use the fact that along optimal trajectories dH/dt = dL/dt = ∂L/∂t which gives:
d
µ, g(u∗ ))i + η(t)h1 (x∗ )) = 0, =⇒ hµ
µ, g(u∗ ))i + ηh1 (x∗ ) = const..
(hµ
dt

(S.24)

Additionally, the optimal trajectory x∗ must also satisfy
∂L
∂u

µ, ∂u g(u∗ )i − ηhp, DC (x)i = 0.
= hζζ , f C (x∗ )i − ∂u G(x∗ , u∗ ) + hµ
x∗ ,u∗ (ζζ ,x∗ )

= hζζ , f C (x∗ )i − ∂u G(x∗ , u∗ ) + µ1 − µ2 − ηhp, DC (x)i = 0.

(S.25)

From the complementary slackness conditions Eqs. (S.15-S.17) and Eq. (S.25), the following equations hold along
the optimal solution
u∗ = 0 : µ2 (t) = 0, µ1 (t) = −hζζ , f C i + ∂u G + ηhp, DC i
∗

C

(S.26)

C

(S.27)

u = uM : µ1 (t) = 0, µ2 (t) = hζζ , f i − ∂u G − ηhp, D i.

(S.28)

0 < u < uM : µ1 (t) = µ2 (t) = 0, ηhp, D i = −∂u G + hζζ , f i
∗

C

C

From (S.17), when x ∈
/ xb , η(t) = 0 and the equations above fully determine µ . When x ∈ xb , Eqs.(S.24,S.26-S.28)
determine µ , η. Therefore, Eqs. (S.7, S.20-S.24,S.26-S.28) completely define the boundary value problem that needs
to be solved to compute u∗ . Finally, at any junction time τ , the following jump conditions need to be satisfied [15]
ζ (τ − ) = ζ (τ + ) + α(τ )[∇x h]> ,
∗

∗

−

−

∗

∗

+

+

H(x (τ ), u (τ ), ζ (τ )) = H(x (τ ), u (τ ), ζ (τ )).

(S.29)
(S.30)

Here we solve the optimal control problem numerically using the publicly available Open Optimal Control Library
(Open OCL) [20], which effectively solves the optimal control problem using the direct method via Casadi [21].

13
PERIODIC STRATEGIES

FIG. S1: Periodic Lockdowns. Panels (A-B) Show the performance of a strategy that alternates between full
lockdown (u = 0.85) and open (u = 0) states approximately every two months. While initially the lockdowns do
suppress the outbreak, the situation is unstable and an outbreak goes out of control in the second open phase. This
happens since the recovery rate during the lockdown is approximately γ = 0.16, while the growth rate for a population
that is mostly susceptible (without control measures) is estimated to be ρ = 0.2. To prevent this resurgence either
longer lockdown or milder re-openings will be required. The economic cost of this strategy, in terms of fraction of
days lost will be greater Ec ≥ 0.5. Since the maximum hospital capacity is exceeded for this solution, we do not
calculate the period Tc for this strategy.
CALCULATING THE EFFECTIVE REPRODUCTION NUMBER FOR BATCHING STRATEGIES

We will consider here the case when the participation ratio (fraction of people participating economically, given by
1 − u) is less that 0.5. The case when 1 − u > 0.5 can be solved in a similar fashion. We assume a strategy where a
fraction (1 - u) of the population participates in the first time period (∆t days) and another (1 - u) participates in
the second time period, while a fraction (2u − 1) does not participate in both periods. During the first time period,
the number of infected grows as






∆t
∆t
∆t
I t+
= (2 u(t) − 1) exp −γ
I(t) + (1 − u(t)) exp −γ
I(t)
2
2
2


∆t
+ (1 − u(t)) exp γ (R(t) − 1)
I(t).
(S.31)
2
In the second time period, the two groups switch places and we get
 
 
R(t)
− 1 ∆t I(t).
I(t + ∆t) = (2 u(t) − 1) exp {−γ∆t} I(t) + 2 (1 − u(t)) exp γ
2

(S.32)

We get the effective growth rate through
ρef f ≡ lim

∆t→0

I(t + ∆t) − I(t)
= γ [(1 − u(t)) R(t) − 1] .
∆t I(t)

(S.33)

A similar calculation shows that for the case u < 0.5 we get the same expression for the effective growth rate. In that
case a fraction of (1 − 2u) works in both periods. Two fractions of ratio u work in alternative shifts (see Fig. S2A).
Fig. S2B shows a simulation of the effective description of the batching strategy compared with a more fine grained
simulation that explicitly takes into account the shifts. Notice how the approximation becomes better for a smaller
shift.
The derivations above assumed that S changes slowly compared with I, which will be true if S ≈ N . For example,
˙ ∝ S/N , whereas the rate of variation of S is much slower,
significant variation in I happens at a rate of order I/I
Ṡ/S ∝ I/N . Consequently, when R0 > 4, the approximation above will not work for the entire duration of the
simulation.

14

FIG. S2: Batching strategies Panel (A) illustrates the batching strategies for three different values of u. For
concreteness, we take ∆t = 7 days. When u < 0.5, there will be a portion of the populations that is always infecting
(left). By contrast, when u > 0.5, there will be a portion of the population that is always recovering. (B) Comparing
the effective description of batching strategies to fine grained simulation. Here R0 = 3 and γ = 0.16 and u(t) = 0.5.
We assume initially 0.1% of the population is infected and R(0) = 0.

PARAMETER ESTIMATION FOR SINGLE AND TWO POPULATION SIR MODEL
SIR without age structure

The data used for estimating the growth rate of the infected population is the total confirmed infected cases. This
time-series captures the sum total of all currently active infected as well as recovered individuals, I(t) + R(t). For
the US [35], we perform the estimation over a 15 day moving time window spanning the month of March (result
in Fig. S3A). The maximum total detected cases was about ≈ 200, 000, less than 0.1% of the total population and
hence, the susceptible population is assumed to be a constant and equal to the total population (S = N ) during the
estimation period. Under this assumption, we have linear dynamics for currently active infections and the recovered
population:
I˙ = (β c − γ)I,

Ṙ = γ I,

(S.34)

where we factored out the mean number of contacts per day c so that β is the transmissibility. The solution is given
as
I(t) = e(β c−γ) t I0

R(t) = R0 + γI0 (β c − γ)−1 e(β c−γ) t − 1

(S.35)

with I(0) = I0 and R(0) = R0 .
To compare the trajectory generated by this model with the U.S. data for total infected cases, we sum I(t) and
R(t) from Eq. (S.35) to get the expression
I(t) + R(t) = a + b eρ t

(S.36)

where ρ = β c − γ, a = R0 − I0 /(R0 − 1) and b = I0 R0 /(R0 − 1). Equation (S.36) captures the initial exponential
growth phase in U.S. data. The uncertainty in initial conditions affects the estimated total cases through the constants
a, b whereas the eigenvalue ρ captures the growth rate. Due to the dominant exponential growth term, uncertainty
in the I0 and R0 via the constant a has a comparably smaller effect on the fit. Given an estimate of ρ, we use an
estimate of the serial interval [25, 36, 37] to get the complete parameter set.

15

FIG. S3: Parameter estimation for U.S. and Germany. (A) Eigenvalues (blue) determining growth of
infections for U.S. national data is plotted with 95% confidence intervals (red) against last day of a 15 day
estimation period. Eigenvalues are shown for 17 such periods. (B) log10 of total cumulative cases in people ages 0 to
59 (left) is plotted against time for sixteen German states. The highlighted portions of the labeled curves were used
for parameter estimation. This data is selected from early in the virus spread, before the visible shift in growth rate
that occurs around March 15th. The black vertical line marks the cutoff day of the data used for fitting. The
starting day for each highlighted section is the day cases in that state crossed a threshold, set here to 40 cases.
Parameter estimation was not sensitive to choosing a threshold of 100 rather than 40. (C) This panel repeats the
analysis of (A), which showed US data, for each German states separately. Note the interesting similarity of values
between the different states. (D) As described in the text, the ratio of young to old should be dictated by the
dominant eigenvalue of the contact matrix, in this figure we find a direct relation between the growth rate of the
infected in both young and old populations across the different German states (Blue points). This implies a constant
fraction between the two age groups. (E) Shows the fraction of the populations in the different age groups as the
number of infected increases by several orders of magnitude over the course of a month. (F) Log plot of the number
of infected over time well after lockdown in Germany. The slope of the line is ρ1 = 0.2 days−1 .

Thus if we fit b, ρ and the initial total case count H0 = R0 + I0 from data and obtain an estimate of the serial
interval τs , we can find the rest of the parameters as
I0 = b (R0 − 1) /R0 ,
R0 = H0 − I0 ,
R0 ρ
ρ
βc=
,
γ=
, where R0 ≈ eρ τs .
R0 − 1
R0 − 1

(S.37)

Fig. (S3A) shows the results for the fitting of U.S. data. The fit was done with the least square curve fit function in
Matlab and the error bars are 95% confidence intervals from this function. Since β is always multiplied by c, when
presenting the results for β we assume c = 10 (Table II).

SIR with age structure

In this section, we describe the parameter estimation for the two age model based on the simplifying assumption
that the ratio of infected young people to the infected old is constant throughout the period over which the parameters
are estimated. This approximation works well since the leading (left) eigenvector of the contact matrix will dominate
during this exponential growth phase. The next section will provide theoretical justification for this assumption
while Figs. (S3C & S3D) show empirical justification in the case of Germany. Using the data [23] illustrated in
Fig. (S3D), we find that the mean ratio to be Iyoung /Iold ≈ 3.8 and with standard deviation 0.27. Furthermore,
we find the magnitude of this leading eigenvector increases exponentially at the rate ρ1 = 0.2 days−1 (see Table II)
which amounts to a doubling time of approximately 3.5 days. Since we cannot estimate the contact matrix and the
parameter β independently, only their product, we normalize the contact matrix so that its leading eigenvalue is equal

16

Country

Ny No

ρ1

γ

R0

β

C=


Cyy Cyo
Coy Coo

8.5 ± 0.4
 5.6 ± 0.6
7.4 ± 0.3
United States 255 74 0.26 ± 0.08 0.14 (0.09 − 0.21) 0.040 (0.032 − 0.048) 2.8 (1.9 − 4.6)
8.2 ± 0.9
Germany

57

23 0.2 ± 0.03 0.16 (0.13 − 0.21) 0.036 (0.032 − 0.042) 2.2 (1.8 − 2.8)




2.3 ± 0.2
1.5 ± 0.4 
2.3 ± 0.2
2.6 ± 0.7

TABLE II: Parameter estimates for the age-structured SIR model based on time-series data from Germany and the
US. ρ1 is estimated via curve fitting. Nj is the populations in age group j, in millions of people. The parameters β,
γ and R0 are estimated using (S.37). The serial interval is taken to be 4(3.5 − 4.5) days [36, 37]. The estimates of
the growth rate are shown in Figs. (S3A & S3B). Since we do not have time series age-structured data for the U.S.
the error bars on the contact matrix are taken from the German counterpart.

to 10, corresponding roughly to 10 contacts per day per person.
Under an assumption of constant Sy , So , with Sy ≈ Ny and So ≈ No , from Eqs. (S.1 - S.4), we have


Ny
˙
Iy = β Cyy Iy +
Cyo Io − γ Iy
No


No
˙
Io = β
Coy Iy + Cyy Io − γ Io
Ny
Ṙy = γ Iy ,
Ṙo = γ Io
We can rewrite these equations as
 ˙  
Iy
β Cyy − γ
β Coy
 I˙o   β Cyo
β
Coo − γ


 Ṙy  = 
γ
0
0
γ
Ṙo

0
0
0
0




0
Iy
0   Io 

=M
0   Ry 
0
Ro


Iy
Io 
.
Ry 
Ro

(S.38)

(S.39)

The matrix M has three distinct eigenvalues: 0, ρ1 , ρ2 , with ρ1 > ρ2 , and ρj has an associated eigenvector of the form

T
v j = 1 mj γ/ρj γ mj /ρj , where [1 mj ] are the left eigenvectors of the contact matrix whose eigenvalues cj
satisfy β cj − γ = ρj . The zero eigenvectors correspond to populations with only recovered people and zero infected.
As shown in the next subsection, the linearized problem splits into two separate SIR models, one for each eigenvector
of the contact matrix.
We fit the data to the following equation, which only accounts for the leading eigenvalue of the contact matrix,
Io (t) + Ro (t) = ay + b eρ1 t
Iy (t) + Ry (t) = ao + b m1 eρ1 t

(S.40)

As in the single age group case (S.37), we can use the exponential fit to estimate b and ρ1 in addition to m1 and,
using the initial populations numbers Ii (0) + Ri (0), we can estimate the other parameters (Table II). Note that here
R0 is estimated from the leading eigenvalue of the contact matrix c0 through the relation R0 = β c0 /γ (See [24]).
The dominant eigenvector of the contact matrix

In this section we show how to get an estimate of the effective contact matrix using its dominant left eigenvector.
We write the age structured SIR model (for Sj ≈ Nj ) as



I˙young
T
≡
İ
=
β
C
−
γ
I,
Ṙ = γ I.
(S.41)
I˙old
We can decompose both vectors R and I in terms of the eigenvectors of the contact matrix C. Here, it is assumed
that γ is the same for all ages. If it’s not then we can repeat the same analysis with the eigenvectors of the 2 × 2
matrix β CT − γ , where γ is a diagonal matrix.
Denoting the (left) eigenvectors of C as V± and the eigenvalues as ρ± , we find (because V± are linearly independent)
that the system of equations decouples for each eigenvector of the contact matrix. Specifically,
I˙± = (β c± − γ) I± ,

Ṙ± = γ I± .

(S.42)

17
where I± and R± are scalars and represent the components in the eigenbasis of the contact matrix. Each eigenvalue
of the contact matrix determines two growth rates of the system. one of them is zero and the other is β c± − γ.
Thus, for long enough time, the system can be approximated by I ≈ I+ e(β c+ −γ) t V+ . Thus the dominant
eigenvector of the contact matrix should determine the long term fraction of infected people in the young and old
populations.
Conversely, if we have empirically that the ratio between the two populations is fixed over time (see Fig. S3C), we
can use that to have a rough estimate of the contact matrix which is given by CT = ρ+ V+ UT+ +ρ− V− UT− ≈ ρ+ V+ UT+ ,
T
where U± are the right eigenvectors of C. Here we assume that V±
· U± = 1, otherwise we have to divide by the
corresponding inner product in each term.
From the German data, we have that Iyoung /Iold = 3.8 with standard deviation σ = 0.3. Thus we estimate the
dominant eigenvector as (3.8, 1)T and estimating the left eigenvector through the consistency condition on the contact
matrix we get the results shown in Tab. II. While there is no age structured time series data for the U.S. we estimate
the dominant eigenvector using the aggregated data to be (3.14, 1).
OPTIMAL LOCKDOWN POLICIES FOR THE US

FIG. S4: Optimal control results for parameters extracted from U.S. data. Panels (A - C) represent optimal
control strategies with no batching (Similar to Fig. 3 in the main text). We have used a horizon period of 18
months. Due lower number of ICUs and a higher growth rate it is harder to reduce the period spent at hospital
capacity and reach herd immunity within one year without extended lockdown measures. The situation is improved
by incorporating batching strategies. Panels (D - F) show the behavior, for different values of αL , of the optimal
batching strategies (Similar to Fig. 4 in the main text).
BEHAVIORAL DYNAMICS

We incorporate the behavioral dynamics described in the main text by modifying the equations (S.1-S.5) to
Ṡi = −β

X

Si Cij

j=y,o

I˙i = β

X

Si Cij

j=y,o

Ij
,
Nj

Ij
− γ Ii ,
Nj

Ṙi = γ Ii ,
0
C
Cij = Cij
− u(t) Cij
,
β̇ = −

β(t) − β0 (1 − δ tanh (v IC ))
.
τ

(S.43)
(S.44)

Note that here β is a dynamical function rather than a constant. The solution to these equations for the open loop
case, u(t) = 0, is given in Fig. S5.

18
The objective function is changed (only the economic cost changes) to
G(x,u,t)

Z
arg min
u

0

Glife

=

αL

Gecon.

=

αE

Gsocial

=

αS

T

z
}|
{
(Glife + Gecon. + Gsoc. )dt,


py Iy (t) + po Io (t)
NICU


N − Iy (t) − Io (t)
β(t)
1−
(1 − u(t))
N
β(0)
2

u(t)
,
uM

subject to the constraints:
IC (t) ≡

py Iy (t)+po Io (t)
NICU

≤ 1,

0 ≤ u ≤ uM .

FIG. S5: Changing behavior in response to risk perception (open loop dynamics). (A) β̄ is the value
of β that the population would settle on over time if IC was held fixed at a constant value, it is given by β̄/β0 =
(1 − δ tanh (v IC )). The parameters used to generate this figure are β = 0.036, γ = 0.16, c = 10, v = 2 and δ = 1. (B)
Solution for β as a function of time from (S.44) and u(t) = 0. (C) The corresponding number of infections over time.
Note how bottom up response of people can control the number of infections but will lead to oscillations.

MODEL SENSITIVITY ANALYSIS

In addition to studying the sensitivity of our predictions to uncertainties in the parameters, it would also be useful
to know how our predictions would change for more realistic model. In order aid future work in this direction and to
further test the robustness of the proposed strategies, we repeat our analysis by making two different changes to our
basic model.

1.

SEIR model

The first change is to study an SEIR model [30] which incorporates an exposed but not yet infected group (Ei ).
The equations of motion in this case change to
Ṡi = −β

X

Si Cij

j=y,o

Ėi = β

X

Si Cij

j=y,o

I˙i = σ Ei − γ Ii ,
Ṙi = γ Ii ,

Ij
,
Nj

Ij
− σ Ei ,
Nj

(S.45)

19
where σ −1 is proportional to the incubation period which we take to be four days so that σ = 0.25 days−1 . We repeat
our optimization procedure with the same cost function and parameters used in Fig. 3 of the main text, and show
our results in Fig. S6. We note that the results in this case are similar to those from the SIR model (Fig. 3 in the
main text).

FIG. S6: Optimal controls for the SEIR model. Solution of the optimal control problem with dynamics given
in (S.45) and the cost function given by Eq. (3) in the main text for (A) socioeconomically dominated (B) balanced
and (C) life dominated cost functions. Compare with Fig. 3 in the main text.

2.

Alternative socioeconomic costs

Here we analyse how our results change as we vary the choice of the socioeconomic cost function. We require the
social cost to be increasing and convex with respect to u so that it becomes steeper with higher lockdown measures.
2
Fist, we modify the quadratic dependence on u of the social cost to Esoc. ∝ eu/uM − 1 . The results are shown in
the first row of Fig. S7 and again are consistent with the results of Fig. 3 in the main text. Second, we have modified
the economic cost to the Cobb-Douglas function [17] with labor output elasticity equal to 2. As shown in the second
row of Fig. S7, the results are again similar to Fig. 3 in the main text. In this case, for αL = 1 the second bump
has a much shorter duration due to the increased sensitivity of the economic cost on the fraction of people working.
However, by increasing αL , thus emphasising the life cost more, the range of the second bump increases just as before.
Therefore, even in this case, the range of policies observed remains qualitatively unaltered.

FIG. S7: Modifying the socioeconomic costs. The first row represents the change of the quadratic dependence
2
on u of the social cost to Esoc. ∝ eu/uM − 1 . The second row shows the result of changing the economic cost (using
a Cobb-Douglas function with labor out put elasticity equal to 2). Compare with Fig. 3 in the main text.

20
GLOSSARY

β :
γ :
Cij :
c0 :
R0 :
Ii :
Si :
Ri :
pi :
NICU :
IC :
u :
αL :
αE :
αS :
δ :
v :

Transmissivity, Probability of an infection from a meeting of an infected and a susceptible person.
Rate of removal of infected individuals.
Number of contacts per day a person of age i makes with people from group j (contact matrix).
Largest eigenvalue of the contact matrix.
Basic reproduction number, number of secondary cases one case would produce in a completely susceptible population.
Number of infected people in group i.
Number of susceptible people in group i.
Number of Removed people in group i.
probability of needing ICU for an infected person in group i.
The number of available ICUs in the region of interest.
The expected number of people needing ICUs as a fraction of total available ICUs.
A function that controls the intensity of the lockdown measures.
The weight of the life cost in the objective function.
The weight of the economic cost in the objective function.
The weight of the social cost in the objective function.
Magnitude of behavior change as response to change in infections.
Sensitivity of behavior change to changes in the number of infections.

[1] A. Galeotti and P. Surico, “A User Guide to COVID-19,” VOX CEPR Policy Portal, vol. 27, 2020.
[2] H. Tian, Y. Liu, Y. Li, C.-H. Wu, B. Chen, M. U. Kraemer, B. Li, J. Cai, B. Xu, Q. Yang, et al., “An investigation
of transmission control measures during the first 50 days of the covid-19 epidemic in china,” Science, vol. 368, no. 6491,
pp. 638–642, 2020.
[3] S. M. Kissler, C. Tedijanto, E. Goldstein, Y. H. Grad, and M. Lipsitch, “Projecting the transmission dynamics of sars-cov-2
through the postpandemic period,” Science, vol. 368, no. 6493, pp. 860–868, 2020.
[4] R. Ross, “An application of the theory of probabilities to the study of a priori pathometry.part i,” Proceedings of the Royal
Society of London. Series A, vol. 92, no. 638, pp. 204–230, 1916.
[5] W. O. Kermack and A. G. McKendrick, “A contribution to the mathematical theory of epidemics,” Proceedings of the
Royal Society of London. Series A, vol. 115, no. 772, pp. 700–721, 1927.
[6] N. T. Bailey, The mathematical theory of infectious diseases and its applications. Charles Griffin & Company Ltd, 5a
Crendon Street, High Wycombe, Bucks HP13 6LE., 1975.
[7] D. J. Daley and J. Gani, Epidemic Modelling: An Introduction. Cambridge Studies in Mathematical Biology, Cambridge
University Press, 1999.
[8] R. M. Anderson and R. M. May, Infectious diseases of humans: dynamics and control. Oxford university press, 1992.
[9] M. J. Keeling and K. T. Eames, “Networks and epidemic models,” Journal of the Royal Society Interface, vol. 2, no. 4,
pp. 295–307, 2005.
[10] M. J. Keeling and P. Rohani, Modeling infectious diseases in humans and animals. Princeton University Press, 2011.
[11] H. W. Hethcote, “The mathematics of infectious diseases,” SIAM Review, vol. 42, no. 4, pp. 599–653, 2000.
[12] R. Morton and K. H. Wickwire, “On the optimal control of a deterministic epidemic,” Advances in Applied Probability,
vol. 6, no. 4, pp. 622–635, 1974.
[13] K. Wickwire, “Mathematical models for the control of pests and infectious diseases: a survey,” Theoretical population
biology, vol. 11, no. 2, pp. 182–238, 1977.
[14] R. Chowdhury, K. Heng, M. S. R. Shawon, G. Goh, D. Okonofua, C. Ochoa-Rosales, V. Gonzalez-Jaramillo, A. Bhuiya,
D. Reidpath, S. Prathapan, et al., “Dynamic interventions to control covid-19 pandemic: a multivariate prediction modelling study comparing 16 worldwide countries,” European Journal of Epidemiology, pp. 1–11, 2020.
[15] S. P. Sethi, Optimal Control Theory. No. 3, Springer International Publishing, 2019.
[16] C. E. Dangerfield, J. V. Ross, and M. J. Keeling, “Integrating stochasticity and network structure into an epidemic model,”
Journal of The Royal Society Interface, vol. 6, no. 38, pp. 761–774, 2009.

21
[17] C. W. Cobb and P. H. Douglas, “A theory of production,” The American Economic Review, vol. 18, no. 1, pp. 139–165,
1928.
[18] When the young and old populations are quarantined in different proportions, the expression for the fraction of people
allowed to work would be slightly different (See SI). Since this detail does not change the nature of our results, the simpler
expression given here suffices.
[19] K. Prem, A. R. Cook, and M. Jit, “Projecting social contact matrices in 152 countries using contact surveys and demographic data,” PLOS Computational Biology, vol. 13, pp. 1–21, 09 2017.
[20] J. Koenemann, G. Licitra, M. Alp, and M. Diehl, “Openocl–open optimal control library,” 2017.
[21] J. A. E. Andersson, J. Gillis, G. Horn, J. B. Rawlings, and M. Diehl, “CasADi – A software framework for nonlinear
optimization and optimal control,” Mathematical Programming Computation, vol. 11, no. 1, pp. 1–36, 2019.
[22] J. Dehning, J. Zierenberg, F. P. Spitzner, M. Wibral, J. P. Neto, M. Wilczek, and V. Priesemann, “Inferring change points
in the spread of covid-19 reveals the effectiveness of interventions,” Science, 2020.
[23] Robert-Koch-Institute, “Rki-covid19,https: // www. arcgis. com/ home/ item. html? id= f10774f1c63e40168479a1feb6c7ca74 ,”
2020.
[24] J. Heffernan, L. Wahl, and R. Smith, “Perspectives on the basic reproductive ratio,” J R Soc Interface, vol. 2, p. 281293,
2005.
[25] S. Zhao, P. Cao, D. Gao, Z. Zhuang, Y. Cai, J. Ran, M. K. C. Chong, K. Wang, Y. Lou, W. Wang, L. Yang, D. He,
and M. H. Wang, “Serial interval in determining the estimation of reproduction number of the novel coronavirus disease
(COVID-19) during the early outbreak,” Journal of Travel Medicine, 03 2020.
[26] NCIRD,
“Covid-19
pandemic
planning
scenarios,
https: // www. cdc. gov/ coronavirus/ 2019-ncov/ hcp/
planning-scenarios. html ,” 2020.
[27] Statistisches-Bundesamt (Destatis), “High hospital bed density in germany compared with other countries, https: // www.
destatis. de/ en/ press/ 2020/ 04/ pe20_ 119_ 231. html ,” 2020.
[28] Since the the optimal control does not exceed c = 0.6 in all our solutions, the precise value of this upper bound will not
affect our results.
[29] O. Karin, Y. M. Bar-On, T. Milo, I. Katzir, A. Mayo, Y. Korem, B. Dudovich, E. Yashiv, A. J. Zehavi, N. Davidovich,
R. Milo, and U. Alon, “Adaptive cyclic exit strategies from lockdown to suppress covid-19 and allow economic activity,”
medRxiv, 2020.
[30] J. L. Aron and I. B. Schwartz, “Seasonality and period-doubling bifurcations in an epidemic model,” Journal of theoretical
biology, vol. 110, no. 4, pp. 665–679, 1984.
[31] E. P. Fenichel, C. Castillo-Chavez, M. G. Ceddia, G. Chowell, P. A. G. Parra, G. J. Hickling, G. Holloway, R. Horan,
B. Morin, C. Perrings, et al., “Adaptive human behavior in epidemiological models,” Proceedings of the National Academy
of Sciences, vol. 108, no. 15, pp. 6306–6311, 2011.
[32] C. O. Buckee, S. Balsari, J. Chan, M. Crosas, F. Dominici, U. Gasser, Y. H. Grad, B. Grenfell, M. E. Halloran, M. U.
Kraemer, et al., “Aggregated mobility data could help fight covid-19.,” Science, vol. 368, no. 6487, p. 145, 2020.
[33] C. M. Saad-Roy, N. S. Wingreen, S. A. Levin, and B. T. Grenfell, “Dynamics in a simple evolutionary-epidemiological
model for the evolution of an initial asymptomatic infection stage,” Proceedings of the National Academy of Sciences,
vol. 117, no. 21, pp. 11541–11550, 2020.
[34] R. F. Hartl, S. P. Sethi, and R. G. Vickson, “A survey of the maximum principles for optimal control problems with state
constraints,” SIAM review, vol. 37, no. 2, pp. 181–218, 1995.
[35] The-Covid-Tracking-Project, “USA historical data, https: // covidtracking. com/ data/ us-daily ,” 2020.
[36] A. A. H. Nishiura, N.M. Linton, “Serial interval of novel coronavirus (COVID-19) infections.,” Int J Infect Dis, vol. 93,
p. 284286, 2020.
[37] Y. W. e. a. Z. Du, X. Xu, “Serial interval of COVID-19 from publicly reported confirmed cases,” Emerg Infect Dis, 2020.

