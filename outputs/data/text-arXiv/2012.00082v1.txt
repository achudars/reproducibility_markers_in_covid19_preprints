Machine learning spatio-temporal epidemiological model to evaluate
Germany-county-level COVID-19 risk
Lingxiao Wanga , Tian Xub , Till Hannes Stoeckerc , Horst Stoeckera,d , Yin Jiang∗,b,e , Kai Zhou∗,a
a Frankfurt

arXiv:2012.00082v1 [physics.soc-ph] 30 Nov 2020

Institute for Advanced Studies, Ruth-Moufang-Str. 1, 60438 Frankfurt am Main, Germany
b Department of Physics, Beihang University, Beijing, 100191, China
c Black Hole KG, 61440 Oberursel (Taunus), Germany
d Institute for Theoretical Physics, Goethe University Frankfurt, 60438 Frankfurt am Main, Germany
e Beijing Advanced Innovation Center for Big Data-Based Precision Medicine, School of Medicine and Engineering, Beihang
University, 100191, China

Abstract
As the COVID-19 pandemic continues to ravage the world, it is of critical significance to provide a
timely risk prediction of the COVID-19 in multi-level. To implement it and evaluate the public health
policies, we develop a framework with machine learning assisted to extract epidemic dynamics from the
infection data, in which contains a county-level spatiotemporal epidemiological model that combines a
spatial Cellular Automaton (CA) with a temporal Susceptible-Undiagnosed-Infected-Removed (SUIR)
model. Compared with the existing time risk prediction models, the proposed CA-SUIR model shows
the multi-level risk of the county to the government and coronavirus transmission patterns under different policies. This new toolbox is first utilized to the projection of the multi-level COVID-19 prevalence
over 412 Landkreis (counties) in Germany, including t-day-ahead risk forecast and the risk assessment
to the travel restriction policy. As a practical illustration, we predict the situation at Christmas where the
worst fatalities are 34.5 thousand, effective policies could contain it to below 21 thousand. Such intervenable evaluation system could help decide on economic restarting and public health policies making in
pandemic.
Key words: SUIR Model, COVID-19 Pandemic, Deep Learning, Cellular Automata

1. Introduction
Public health security is the cornerstone of economic and social stability. CoronaVirus Disease 2019
(COVID-19), an infectious disease caused by the Severe Acute Respiratory Syndrome Coronavirus 2
(SARS-CoV-2), became a global pandemic that spread out across the world from the beginning of 2020.
Since middle of March, the number of infected cases in Germany experienced a rapid growth. Although
the severe restriction of travel eases the situation in the summer, the number of infected cases have been
increasing again with a more critical trend since mid-September, named routinely as the second-wave
pandemic worldwide. By November 25, 2020, the pandemic has caused 983588 confirmed cases and
15160 fatalities in Germany. Many states are facing dilemma challenges of public heath and economics
in curbing the spread of the COVID-19, e.g., Berlin, Bavaria and Hessen. The medical resources of Germany (ICU beds and doctors) have not reached their ceiling, but the current phase of the pandemic is not
encouraging. Being a high-infectious disease, COVID-19 is expected to continue spreading or be even
worse in the coming winter, which will cause a higher number of infections and mortality in the next
∗ Corresponding

author.

Preprint submitted to XXX

December 2, 2020

few months. With no perfect medical treatments nor enough vaccines available until now, implementation of relatively effective public health policies such as social distancing and travel restriction become
the primary measures of the states to mitigate the spread of epidemic, which has been proven to be an
effective containment in East Asia, e.g. China [1] and South Korea, also in Europe at early stage [2]. In
this worsening health crisis, a dire need emerges to establish a multi-level (Nation-State-County)
COVID-19 risk prediction model, which can guide the evaluation and improvement on the public
health policies of governments (states) at multi-level. Such intervenable risk evaluation model is beneficial to policymakers in decision-making on economics restarting and public health policies at different
scales during epidemics. The multi-level risk information can help governments to improve the public
restriction strategies such as cross-state travel restriction, home office rules, severe home isolating regulations and vaccination resources allocation. Residents, who are concerning the present situation, can
also benefit from the multi-level risk information, to make effective access of medical resources and help
implementing or following the public health policies.
Evaluation to the risk of the on-going COVID-19 pandemic across the geographical-dependent administrative divisions is challenging because of the substantial heterogeneity rooted in economic composition, industrial diversity, traffic conditions and political views. Nonetheless, it is inevitably an emergent
demand for governments at all levels. Although a lot of studies have been devoted to the dynamics
of the epidemics based on mathematical models [3, 4], (see also reviews1 [5, 6, 7]), they mainly focus on time-domain analysis and ignore the influence of geographic distribution and population migration [2] which palpably presents as cross-county transfers at daily-scale. A model which can predict
the spatio-temporal evolution of the COVID-19 cases is urgently needed to assess the local risk at
multi-level regions. Besides works which concern spatial distribution or local evolution based on the
historical statistical data [8, 9, 10] , recently there are several studies sharing similar goals in different
countries [11, 12, 13, 14], which is merited to be one of the most urgent needs across the world. In a practical perspective, a reasonable and efficient risk prediction model needs to be performed comprehensively
with all Landkreis 2 , since people is highly mobile and connected by highways, railways and airways in
Germany. Conceivably, a county-level risk evaluation to the public and local governments is informative
and ponderable.
Machine learning (ML), a branch of artificial intelligence, efficiently integrates statistical and inference algorithms and thus offer the opportunity to uncover hidden structure of evolution in complex
coronavirus data and to describe it with finite dynamical parameters. Therefore, combinatory usage of
ML algorithms and spatio-temporal epidemiological model for risk prediction in the context of COVID19 pandemic are worth exploring. Although the state-of-the-art ML techniques have been deployed into
myriad fields of COVID-19 pandemic [15, 16, 17, 18], for the governments and residents, the highest
concern is how fast the COVID-19 diffuses. Available ML models that focus on this exhibit promising
implications in individual or national scale, but are still impeded by the paucity of validation information
and limited privacy rules in Germany, thus lack the capability of predicting multi-scale evolution.
In this study, we aim to establish a new evaluation paradigm by introducing a spatio-temporal
epidemiological model with machine learning assisted. The dynamical model of the epidemic contains a Cellular Automaton (CA) [19, 20] and a modified Susceptible-Undiagnosed-Infected-Removed
(SUIR) model [13, 21]. The SUIR model is more inclusive than the previous Susceptible-InfectiousRecovery(SIR)-type models since consideration of the Undetected or Asymptomatic populations [22, 23]
hidden under the lack of detection. As an important extension of the SIR model, we divide the infectious
population into two compartments: one is the undiagnosed who manifest as normal susceptible individuals but with possible infectious and no timely detection; the other one is the infected (diagnosed) who
1 Since the number of COVID-19 papers are too many to list them all, the following references are highly relevant to the topic
we discussed in this paper.
2 It is the primary administrative subdivision higher than a city in Germany, also could be named as county in English.

2

are confirmed by detection and have been admitted to hospital or isolated at home. In this new temporal
model, we constrain the mobility of the people in the susceptible and undiagnosed populations, in which
the understanding to the latter will help address the underestimation issue concerning infection cases in
the public databases. As a matter of fact, the movement of the undiagnosed people across the counties
will contribute to the deteriorating epidemic situation, thus we introduce the CA model to capture the
influences of the population mobility. Being assisted with ML to extract the dynamical parameters, this
new evaluation system can inform the public and governments in different regions with effective warning,
which should be considered into adjusting the restriction rules.
The article is organized as follows. In Section. 2, we propose a full framework of risk prediction to
COVID-19 pandemic in Germnay with introducing the spatio-temporal CA-SUIR model. The machine
learning techniques are applied to extract the dynamical parameters from reported data of Robert KochInstitut (RKI). Section. 3 reproduces the evolution of infection maps from 25 February to 28 March 2020,
and extracts the infectious parameters from RKI data in September 2020 with a well-trained machine
which was training on the data set from CA-SUIR model simulations. The well-learned machine predicts
county-level infection maps from September to November 2020, which is matched remarkably with the
reported situation. With regard to the up-coming Christmas holiday, the different public health policies
are evaluated in the end of the section, in which the entire, partial and none lock-down strategies are
compared. In the last section, some concluding remarks are presented.
2. Machine Learning Spatio-temporal Epidemiological Model

Nation

States

Landkreis

+

SUIR

CA-SUIR model

Real Map

Topological Map

Spatial Evolution

Temporal Evolution

Machine Learning Parameters of CA-SUIR model
Machine Learning COVID-19 Risk from Infection Maps

Figure 1: A framework to evaluate and predict the COVID-19 risk in Germany. The left panel is the geographic distribution
of the infection cases in Germany, which is named as the real map at nation level. The central panel is the topological equivalent
map of the infection cases, in which the main cities are mapping onto the sites on square lattice at state level. The right panel is the
microscopic dynamics on each site, which is spatially depicted by Cellular Automata and temporally evolved through SUIR model
at county level. The color of the characters in SUIR corresponds to the subsequent Fig. 3.

In this section, we propose a spatio-temporal model to predict the multi-level COVID-19 risk in
Germany, named as CA-SUIR model in the following parts. Machine learning techniques are introduced
3

to learn the dynamical parameters of the CA-SUIR model given a ’movie’ of infection maps, which is
sequentially utilized to evaluate the COVID-19 risk from RKI infection map timely in Germany. The full
flow chart is assembled in Fig.1 to present the multi-level spatio-temporal simulation of epidemics, where
as the first step real maps are projected onto the topological equivalent maps as explained in Appendix. A.
The cumulative infected cases in the real profiles3 are reassembled into a topological equivalent map
with 25 × 25 sites in Germany, which contains 412 counties (see details in Appendix. A). The microstates of each county, its number of infected cases, are driven by the SUIR and CA simultaneously in the
model, which construct the topological infection map. With simulated data from the CA-SUIR model, the
Conv2LSTM neural networks [24] consist of the Time-distributed Convolution Neural Networks(CNNs)
and the Recurrent Neural Networks(RNNs) are designed to learn to extract dynamical parameters of CASUIR model. Subsequently, we transfer the well-trained neural networks to make timely prediction and
risk evaluation on RKI infection maps.
2.1. Deep learning dynamical parameters

Undiagnosed cases
Infectious rate
DAY 1

DAY 2

Removed rate
CNN

LSTM

DAY 3

DAY 4
DAY N

Diagnosed rate

Transfer rate

Figure 2: Machine learning the dynamical parameters of CA-SUIR model from the evolution of infection maps. The TimeDistributed Convolutional Neural Networks(CNNs) layers and Long Short-Term Memory(LSTM) units are combined to extract the
information encoded in the input short movie (one image per frame). The undiagnosed population, infectious rate, removed rate,
diagnosed rate and transfer rate are decoded from the Conv2LSTM neural networks.

CNN model and Long Short-Term Memory (LSTM) model have been popularly adopted and show
remarkable performance in many researches like in computer vision or Natural Language Processing
tasks. While the CNN model can do efficient pattern recognition with convolutional filters on imagelike tensor data, the LSTM model is capable of capturing dependencies along time direction between
3 see

the map at COVID-19 pandemic in Germany

4

sequential tallies. In this work we combine CNN and LSTM model into Conv2LSTM for analysing the
infection dynamical evolution.
The Conv2LSTM neural networks we built are demonstrated in Fig. 2, in which the Time Distributed
Convolutional Neural Networks(CNNs) layers and LSTM layers are combined to decode the information
encoded in the short movie constructed by the infection maps. The details of the structure are arranged in
Appendix. C. The time distributed CNNs could extract features (with temporal structure preserved) from
sequential image inputs and then embed them into the following LSTM layers, which is able to efficiently
drill evolution rules from the short movies.
2.2. Temporal SUIR model
We propose a proposed modified Susceptible-Undiagnosed-Infected-Removed (SUIR) model and
demonstrate it in Fig 3, where the infectious rate λ controls the rate of spread which represents the
probability of transmitting disease between a susceptible and an infectious individual. The diagnosed rate
σ dictate the probability of latent infectious individuals becoming confirmed by testing. Removed rate
γ contains the rate of mortality and recovery from the infectious. Besides the classical definition of SIR
model, considering the special features of COVID-19, we introduce the modified SUIR model: there is a
considerable population that could be infected but without any symptoms, or, they just have no access to
perform a detection(with possibility p), which is concluded in a new compartment, Undiagnosed(U). In
contrast to the Infected who is usually subjected to be isolated in medical facilities or quarantine at home,
the Undiagnosed population is with normal mobility, which leads to the high infection; the infectivity
could decrease after d days [25], but there is no clear evidence that they will get special immunity, which
means immunity loss.

Figure 3: The SUIR diagram shows how individuals are infected and transferred among each compartments in a close area.

In a closed population with no births or mortalitys per day,the modified SUIR model becomes,
dS
dt
dU
dt
dI
dt
dR
dt

S
σ0
= − λU +
U
N
days
S
σ0
= λU − σU −
U
N
days

(1)
(2)

= σU − γI

(3)

= γI

(4)

where N = S + U + I + R is the total population. The redefinition parameters in Fig.3 are σ ≡ σp, σ0 ≡
σ(1 − p). The detail explanation of the parameters are in Appendix. B.
2.3. Spatio-temporal CA-SUIR model
We construct a cellular automaton model for tracking the epidemics spatial evolution in a closed
system (Nation with fixed boundary as Fig. 1 shown, which matches the extreme restriction adopt by the
German government from March 16. to May). The underlying structure is a L × L cell grid, where L is the
system size, and the number is from the topological map. The color of cell characterizes the population
5

in minimum geographical unit, which is county in our case. It’s an instructive example to set the cell size
to a typical area of city, such as 102 ∼ 103 km2 , which can simulate the epidemics in the corresponding
resolution approximately. The resolution could be naturally increased into community level, but it needs
more detailed data which is laboriously accessible, thus the following discussion focuses on county level
and corresponding resolution. This model adopts the Moore neighbor, and cells update their states by
transition tensor Pim,n (t) with 4 × L × L shape, which means the possibility of transfer from city (m, n) to
direction i at t time-step. In Fig. 4, the Pi (t) shows as 4 matrices (Pu (t), Pd (t), Pl (t), Pr (t)) with same lattice
size, in which different colors labels the direction of transfer. In the following simulation, we adopt the
mean field approximation [26], which leads to the uniform transition possibility Pu (t) = Pd (t) = Pl (t) =
Pr (t) = . The transfer rate  is introduced to describe the average movement of the residents on each site.
To mimic the border control induced closed boundary, a transfer rate  = 0 has been used in the primary
epidemic stage [27].

i = l, r, u, d

u
pm,n

Pi =

r
pm,n

l
pm,n

i
p1,1

i
p1,2

⋯

⋮

⋮

i
pm,n

i
p2,1

i
p2,2

i
i
p25,1
p25,2

⋯
⋯

i
p1,25
i
p2,25

⋮

i
p25,25

d
pm,n
Transition Matrix

Cellular Automata

Figure 4: Transition matrices in Cellular Automaton model. The size of the grid is L = 25 in our case.

The evolution of the CA-SUIR model is as follows,
Step.1 Initialization. Set the position of infection burst (x, y) and generate population distribution
S (t) at the L × L lattice. At t = 0 time-step, epidemic turns on and population begins to migrate;
Step.2 SUIR dynamics. At t time-step, evolve SUIR model t0 times on each site;
Step.3 Movement. The parts of susceptible and undiagnosed people (S and U) on site (m, n) migrate
into the neighbor site with transition matrices Pk (t, m, n) at t +1 time-step. Update all sites synchronously;
Step.4 Update. Turn to Step.2 until T time-step is reached.
3. Results
3.1. Pandemic dynamics modeling, data set generation and network capacity
With the daily number of cumulative cases in Germany (Data is from the open database of Robert
Koch-Institut (RKI) 4 ), we fix the SUIR parameters to be λ0 ≡ λ − NS σ0 /days = 0.293, σ = 0.129, γ =
0.628 by fitting from redefined exponential behavior parameters(see Appendix. B). This parameter set
can fit well the first-wave burst out in March especially the rapidly increasing stage (from 25 Feb.2020
to 28 Mar.2020), as presented in Fig. 5. The number of initial undiagnosed cases is determined in the
model as U0 ' 700 which distributes as the infection cases. Fig.5 suggests that there is an overestimation of the simulation at early stage(first 20 days), which might be naturally understood to be related
with the underestimation in reality at that time since the limited detection ability and the supply of test
4 www.rki.de/covid-19

and COVID-19 GeoHub Deutschland

6

80K
Real data

Cummulative cases

Fitting curve

60K

40K

20K

0
2-25

3-05

3-15

3-25

Figure 5: The comparison of RKI data and simulated cumulative infection cases. The data is from 25 Feb.2020 to 28 Mar.2020,
in which the shadow bars are from uncertainty estimation. The orange panel is the variation space of SUIR model parameters,
which shows a reliable area under 10% changes. The green panel is from the 10% uncertainty of the undiagnosed population(U),
which is actually from the stability issues of RT-PCR testing [28] and unreported cases in practical situation.

reagents were insufficient [29]. Conceivably, by introducing more practical factors from clinical diagnosis or management, the SUIR model can be predictably improved to match with the record data, which
will be discussed in our further works but is not the focus in the current one. According to the initial
infection cases distribution and the locations of main cities of Germany, we set the initial undiagnosed
population distribution U0 (m, n) to be proportional to the population distribution of the cities N(m, n). In
the simulations for March we choose the transfer rate  = 0.08 as a constant, the population of transfer
on site is proportional to the rate in each time-step. With the fitted parameters from above SUIR model,
we generate the simulated evolution of the cumulative infection cases map in Fig.6, which demonstrates
the high consistency with the RKI data map (named as real profiles, see the full evolution sample in
Appendix. A).
(a)

(b)

2×103
2×102
20

0

Figure 6: Simulated and data evolution of the infection distribution in Germany. The infection maps are evaluated through
CA-SUIR model, from the same initial distribution at 25 Feb.2020. The color bar is set in an uniform orange color scale, the darkest
color is 2000 cases with a logarithmic re-scale. The horizontal and vertical coordinates correspond to the real geographical latitude
and longitude, which is consistent in the following figures.

To prepare training data for Conv2LSTM, we generate 30-day simulation maps as short movies by
associating the SUIR model parameters a 10% uncertainty range. The total number of the data set is
7

10000, which contains 9000 infection movies as training data-set and the rest 1000 as testing data-set.
The 30-day movie contains 30 frames, which is fed to the machine with continuous 7-day segments as
slip windows [30]. The structure of the Conv2LSTM neural networks are exhibited in Appendix. C.
With the short movies to be the input, the Conv2LSTM is trained to predict the involved epidemiological
model simulation parameters. The learning curve is shown in Appendix. C. The four sub-figures in Fig. 7
demonstrate the comparison between the prediction from the trained Conv2LSTM and ground-truth for
testing data, they are the transfer rate , the infectious rate λ, the diagnosed rate σ and undiagnosed
population U respectively. The well-trained machine extracts parameters from the RKI infection map of
March 2020 as λ0 = 0.26, σ = 0.09, U0 = 1352,  = 0.068. The first and last parameters are numerically
matched with the fitting results, and the diagnosed rate and initial undiagnosed population maintain the
consistency with fitting parameters in the relationship σU0 (see Appendix. B).
(a)

Transfer Rate

1

(b)

0.8

Prediction

Prediction

0.8

0.6

0.4

0.2

0

Infectious Rate

1

0.6

0.4

0.2

0

0.2

0.4

0.6

0.8

0

1

0

0.2

0.4

Truth

(c)

Diagnosed Rate

1

(d)

0.8

1

Undiagnosed Population U

0.2

0.8

0.15

Prediction

Prediction

0.6

Truth

0.6

0.4

0.1

0.05

0.2

0

0

0

0.2

0.4

0.6

0.8

1

0

0.05

0.1

0.15

0.2

Truth

Truth

Figure 7: The performance of Conv2LSTM neural networks to extract dynamical parameters from infection maps. (a) The
transfer rate  is tested on the testing data-set with the coefficient of determination R2 = 0.996. (b) The infectious rate λ is tested on
the testing data-set with the coefficient of determination R2 = 0.998. (c) The diagnosed rate σ is tested on the testing data-set with
the coefficient of determination R2 = 0.987. (d) The undiagnosed population U is tested on the testing data-set with the coefficient
of determination R2 = 0.993.

3.2. Machine Learning-assisted Risk Prediction
To assess the COVID-19 risk in realistic situation timely, we deploy the well-trained neural network
into the current cases with transfer learning method. Transfer learning is a machine learning method
where a model developed for a task is generally reused as the starting point for a model on a second task.
In our case, transferring the pre-trained models into the on-going second-wave COVID-19 epidemics
in Germany, we extract the dynamical parameters of the spatio-temporal pandemics from the 30-day
RKI infection maps with beginning from September 8, 2020, which yields the dynamical parameters as
λ0 = 0.21, σ = 0.167, U0 = 7426,  = 0.09.
Fig. 8 describes the homogeneity between simulation and RKI infection maps from September to
November 2020 in Germany. The former cumulative infection maps shown in Fig. 8a are generated from
8

(a)

2×104
2×103
6×102
50

0

(b)

2×104
2×103
6×102
50

0

Figure 8: Comparison of simulation and RKI infection maps from September to November 2020 in Germany. The color bar
is set into an uniform red color scale, the darkest color is 20000 cases with a logarithmic re-scale. (a) As of the end of November,
the cumulative infection cases are presented in dynamical simulation with parameters learned by machine learning at 2020-09-25,
2020-10-25 and 2020-11-25 respectively. (b) As of the end of November, the cumulative infection cases are presented in real
profiles at 2020-09-25, 2020-10-25 and 2020-11-25 respectively. The top 5 biggest cities in Germany, Berlin (13°23E, 52°31N),
Hamburg (10°00E, 53°33N), München (11°35E, 48°03N), Köln (6°58E, 50°56N) and Frankfurt (8°41E, 50°07N) shows a worse
situation than the other sites.

the SUIR model with the machine learning parameters during 3 months. The latter maps shown in Fig. 8b
are projected from the RKI data, in which we present the cumulative infection cases in real profiles until
the end of November. The slight mismatching on the map of November is due to the actual soft lockdown policy has been executed from 2 November. The functional regulations will contain the pandemic
moderately, which will be examined in the following section under different policies.
3.3. Public Policies Evaluation

Office
Campus
School
Supermarket
Restaurant
Travel

Unlocked

Soft-locked

Locked

Office work in schedule
Open
Open
Open
Customer number constrain
Free movement

Home office for large group
Close
Close
Open with distance constrains
Only Take-out
Long distance travel is prohibited

Home office
Close
Close
Close
Close
Home isolation

Table 1: Public Policies for Different Spots. This table lists specific rules which lead to three scenarios: a) unlocked, b) soft-locked,
c) locked. The last one is the well-know lock-down policy which shows most powerful restriction to the mobility of human.

Three different degrees of restriction rules, named as the unlocked, soft-locked and locked strategies
in public policy, are evaluated in our COVID-19 evaluation framework. The examples of the correspond9

ing policies are listed in Table. 1, in which we list some representative government policies in different
spots. It is of crucial concern for both governments and residents who are enduring the social-economical
pressure in pandemic [11, 31, 32, 33]. The hot spots include but are not limited to office, campus, school,
restaurant and cross-county travel. It should be mentioned that although we introduce the heterogeneous
rules in different spots the comprehensive influences at county-level are averaged, which means the effect
of policies are coarse graining to the county-level. Reasonably, it could be improved if we collect more
precise data below county-level, e.g., individual or community-level [34].
(b)

(a)

(c)

2×104
2×103
6×102
50

0

Figure 9: Predicted cumulative infection maps at Christmas under three different public policies. The color bar is set into an
uniform red color scale, the darkest color is 20000 cases with a logarithmic re-scale. The dynamical parameters are extracted from
RKI infection maps by the well-trained machine. (a) The prediction is based on the existing public policies. (b) The soft lockdown
rules contains the relative loose restrictions to some hot spots, thus the diffusion of the epidemic is alleviated partially. (c)Locked:
These strictest rules prohibit any form of mobility, which yield the least infections.

The differences among them in simulation are the transfer rate and susceptible population: the most
strict locked rules has transfer rate  = 0, the soft-locked with half transfer  = 0.045, and the rule with
no additional restriction has  = 0.09 as default; meanwhile, the containment policies could result in a
consequence of infectious population decreasing that effectively deplete the susceptible population [1]. It
leads to the reduction of the susceptible population, reaching to 1/2, 1/8 for the locked and soft-locked
rules respectively, in which the 1/8 is from the rough estimation to the necessary out time. These three
strategies are implemented from the same time point 25 November 2020, and their 30-day simulation
results are shown in Fig. 9. In our prediction assisted by the transfer learning method, 2.3 million people
will be infected before Christmas in the worst situation, where daily increase is approximately 80 thousand (estimate with mortality rate ∼ 1.5% [35]). Compared with the prediction of the Institute for Health
Metrics and Evaluation (IHME)5 , they achieve the consistency in order of magnitude, which means the
total mortality will reach 34.5 thousand approximately. With regard to the soft-locked policy, the infection number reduces to 1.4 million and the corresponding daily increasing cases are 20 thousand. In the
most strict rules, although it restricts the mobility, the number of infection cases will be 1.07 million and
the daily increase is 4 thousand.
4. Discussion
In this paper, we construct a multi-level spatio-temporal epidemiological model that combines a
spatial cellular Automaton (CA) with a temporal hybrid Susceptible-Undiagnosed-Infected-Removed
(SUIR) model which contains the human mobility across the counties. This new toolbox enables the
projection of the state-county-level COVID-19 prevalence over 412 Landkreise in Germany, including
5 http://www.healthdata.org/covid

10

t-day-ahead risk forecast and the risk evaluation related to a public policy. The modular design in our survey can reach a more accurate estimation of the COVID-19 risk with replacing the modules by the other
elaborate spatial or temporal models conveniently. With the help of machine learning methods, we extract
the dynamical parameters directly from the infection maps, which are topologically equivalent to the real
geographic maps. After training the Conv2LSTM neural networks composed of time distributed CNNs
and LSTM on data set generated from CA-SUIR model, we transfer the well-trained neural networks into
the data set collected from the open database of RKI.
The CA-SUIR model reproduces the evolution of the infection maps in March and September acknowledged as the first- and second-wave of COVID-19 pandemic. Even though the prediction focuses
on the infectious dynamics in the current paper, it is conveniently feasible to derive recovery and mortality
rate from the model under the guarantee of accurate data sources confronted. The simulations perform
properly to describe and predict the data in the initial 30-day phase, while it shows a tendency towards
a faster smoothing-out of the pronounced local fine structure and persistent hot spots, as compared to
the data. It could be understood that the observed infection cases concentrated in the big cities, such
as Berlin, Hamburg, München, Köln and Frankfurt than the other sites in the simulation, which reflects
high population density enhances the diffusion of the COVID-19. The prediction could be evidently
improved by introducing more abundant interactions across and within the counties. As some practical
improvements, e.g. replacing the geographic lattice to traffic networks [5, 34, 36, 37, 38], introducing the
higher resolution lattices beyond the county-level which also means higher-order interactions among the
residents [12, 20, 34, 39], can be implemented and devoted in further future works. With the help of the
deep learning, the machine learns the dynamical parameters matched with the data of March, which is
transferred into the prediction to second-wave sequentially. Starting in September, the simulation maps
are remarkably consistent with the data. Regarding the slight uncertainty in extracting parameters for the
dynamics in September, which might has root in the difference of development trend between the firstand second-wave, it could be avoided by training the neural networks on more heterogeneous data set.
We will present the further improvement in our future papers.
Compared to the prevailing COVID-19 risk prediction models, the machine learning-assisted CASUIR model here indicates that knowledge of risk evaluation in the county-level can be displayed directly
to governments and residents. The prediction to the effects of different public health policies suggests that
the transmission modes of coronavirus could be shaped by the efficient non-pharmaceutical interventions.
Besides, the 7-day windows could give a robust prediction in long-term, which is advantageous to timely
assess the current situation. The other valuable application of our evaluation system is to improve allocation of medical resources which are routinely unequal in different counties, some of them are suffering
from the epidemic that far exceeds their medical capacity. It is of essential significance to implement
the intervenable risk evaluation model for decision-making on restarting economics and public health
policies in the COVID-19 pandemic.
5. Acknowledgments
The authors thank Esteban Vargas and Maria Babarossa for useful discussions and comments. The
work on this research is supported by the BMBF through the ErUM-Data funding and the Samson AG AI
grant (L.W, K.Z), by the National Natural Science Foundation of China, Grant No. 11875002(T.X, Y.J.),
by the Zhuobai Program of Beihang University(Y.J.). The authors also thank the donation of NVIDIA
GPUs from NVIDIA Corporation.
A. Infection Maps
In order to simulate the population evolution on lattice, the topological mapping is adopted in our CA
computation. We firstly embed the map in a rectangle area whose length and width are chosen as the
11

25

25

25

25

Real Infection Map

Topological Infection Map

Figure 10: Mapping from real infection map of Germany onto topological equivalent lattice. The left map is divided into
25 × 25 sites as the size of the right part. The geometric shape of the suqare lattice is irrelevant to the real geographic topography.
The site on lattice depict a typical county-level unit of the real map.

maximum value of the Germany map, as in Fig. 10(left). Then the area is segmented into uniform sites of
L × L. And each site is labelled by its row and column numbers as Bmn , where 1 ≤ m, n ≤ L. If a county
occupies N sites, all kinds of the population, such as susceptible, undiagnosed, infected and removed,
are assigned equally into each site. And if there is more than one county or county part on a site, the
populations of the site is set as the sum of all these counties or county parts. Because the geographic
distance is not important in our simulation, which focus on the population distributions, we set each site
as a square when plotting the distribution in Fig. 10(right). In the current simulation, we confine all the
population in Germany and thus set the out-of-Germany transfer possibility at the border as zero.
(a)

2×103
2×102
20

0

(b)

2×103
2×102
20

0

Figure 11: Comparison of simulated and RKI infection maps during March 2020 in Germany. The color bar is set in an
uniform orange color scale, the darkest color is 2000 cases with a logarithic re-scale. (a) As of the end of March, the cumulative
infection cases are presented in dynamical simulation with fitting parameters at 2020-03-05, 2020-03-15 and 2020-03-25 respectively. (b) As of the end of March, the cumulative infection cases are presented in real profiles at 2020-03-05, 2020-03-15 and
2020-03-25 respectively.

12

B. SUIR model parameters explanation
In this part, we discuss the fitting details based on the mathematical simplification to the SUIR model.
In the large susceptible population limit and ignoring the recovery and mortality cases for the uncertainty
at early stage, there are only two equations are relevant,
dU
σ0
= (λ − σ −
)U
dt
days
d(I + R)
= σU
dt

(5)
(6)

The solutions are clearly derived as,
U(t) = U0 Exp[(λ − σ −
I + R = I0 + R0 −

σ0
)t]
days

σU(t)
σU0
+
σ0
σ0
λ − σ − days
λ − σ − days

(7)
(8)

The I + R fitting is easy now with I + R = a∗ + b∗ Exp[c∗ t]. This means we can not obtain all the
independent parameters in the solution, but the following redefinition could be helpful,
a∗ = I0 + R0 −
b∗ =

σU0
σ0
λ − σ − days

σU0
σ0
λ − σ − days

c∗ = λ − σ −

σ0
days

(9)
(10)
(11)

or equivalently only the following combinations could be obtained
I0 + R0 = a∗ + b∗

(12)

σU0 = b∗ c∗
σ0
= c∗
λ−σ−
days

(13)
(14)

As for the product σU0 , which means it is difficult to determine the σ and U0 individually. It will
introduce the inevitable uncertainty to the two parameters, while the confidence to the multiplicative
variable could be reserved.

13

C. Conv2LSTM Neural Networks

Figure 12: The Conv2LSTM neural networks. The nuts-and-bolts of the neural network are: Convolution layers within TimeDistributed wrapper, from Convolution 2D (64, kernel size=3x3, ‘ReLU’, ‘same’ padding) to Convolution 2D (64, kernel size=3x3,
strides=2, ‘ReLU’, ‘same’ padding) to Convolution 2D(64, kernel size=3x3, ‘ReLU’, ‘same’ padding) to Convolution 2D(64, kernel size=3x3, ‘ReLU’, ‘same’ padding) and Flatten; for the LSTM part shown in Fig. 12, 256 LSTM cells with ‘sequence=False’
and activation=‘tanh’ are used; dense layers contains 256 neurons with ‘ReLU’ active function, before the output is the ‘sigmoid’
function to fit the normalized targets.

0.025
Validation Curve
Training Curve

0.02
0.95

0.015

R2

MSE Loss

1

0.9
0.85

0.01

0.8
0

50

100

Epoch

0.005

0

0

20

40

60

80

100

Epoch
Figure 13: Learning curve of the Conv2LSTM neural networks. The red line is the learning curve, in which the Mmean-Square
Error (MSE) loss is reducing with the epoch increasing. The blue line is located in validation data set, which shows the similar
results in learning data set. The increasing of the R square with training is shown in subfigure, which indicates the correlation
between the prediction from neural networks and truth tends to be close.

14

References
[1] B. F. Maier, D. Brockmann, Effective containment explains subexponential growth in recent confirmed COVID-19 cases in China, Science 368 (2020) 742–746. doi:10.1126/science.abb4557.
[2] R. P. Walensky, C. del Rio, From Mitigation to Containment of the COVID-19 Pandemic: Putting
the SARS-CoV-2 Genie Back in the Bottle, JAMA 323 (2020) 1889. doi:10.1001/jama.2020.
6572.
[3] M. V. Barbarossa, J. Fuhrmann, J. H. Meinke, S. Krieg, H. V. Varma, N. Castelletti, T. Lippert,
Modeling the spread of COVID-19 in Germany: Early assessment and possible scenarios, PLOS
ONE 15 (2020) e0238559. doi:10.1371/journal.pone.0238559.
[4] M. V. Barbarossa, J. Fuhrmann, J. Heidecke, H. V. Varma, N. Castelletti, J. H. Meinke, S. Krieg,
T. Lippert, A first study on the impact of current and future control measures on the spread
of COVID-19 in Germany, medRxiv (2020) 2020.04.08.20056630. doi:10.1101/2020.04.08.
20056630.
[5] E. Estrada, COVID-19 and SARS-CoV-2. Modeling the present, looking at the future, Physics
Reports 869 (2020) 1–51. doi:10.1016/j.physrep.2020.07.005.
[6] A. Vespignani, H. Tian, C. Dye, J. O. Lloyd-Smith, R. M. Eggo, M. Shrestha, S. V. Scarpino,
B. Gutierrez, M. U. G. Kraemer, J. Wu, K. Leung, G. M. Leung, Modelling COVID-19, Nat. Rev.
Phys. 2 (2020) 279–281. doi:10.1038/s42254-020-0178-4.
[7] L. Wang, Y. Wang, D. Ye, Q. Liu, Review of the 2019 novel coronavirus (SARS-CoV-2) based on
current evidence, International Journal of Antimicrobial Agents 55 (2020) 105948. doi:10.1016/
j.ijantimicag.2020.105948.
[8] A. Kergassner, C. Burkhardt, D. Lippold, S. Nistler, M. Kergassner, P. Steinmann, D. Budday,
S. Budday, Meso-scale modeling of COVID-19 spatio-temporal outbreak dynamics in Germany,
medRxiv (2020) 2020.06.10.20126771. doi:10.1101/2020.06.10.20126771.
[9] M. Linden, J. Dehning, S. B. Mohr, J. Mohring, M. Meyer-Hermann, I. Pigeot, A. Schöbel,
V. Priesemann, The foreshadow of a second wave: An analysis of current COVID-19 fatalities
in Germany, ArXiv201005850 Phys. Q-Bio (2020). arXiv:2010.05850.
[10] Y. Long, Y. Chen, Y. Li, Multifractal scaling analyses of the spatial diffusion pattern of COVID-19
pandemic in Chinese mainland, ArXiv201002747 Phys. (2020). arXiv:2010.02747.
[11] A. Chande, S. Lee, M. Harris, Q. Nguyen, S. J. Beckett, T. Hilley, C. Andris, J. S. Weitz, Real-time,
interactive website for US-county-level COVID-19 event risk assessment, Nat. Hum. Behav. (2020)
1–7. doi:10.1038/s41562-020-01000-9.
[12] B. Rader, S. V. Scarpino, A. Nande, A. L. Hill, B. Adlam, R. C. Reiner, D. M. Pigott, B. Gutierrez,
A. E. Zarebski, M. Shrestha, J. S. Brownstein, M. C. Castro, C. Dye, H. Tian, O. G. Pybus, M. U. G.
Kraemer, Crowding and the shape of COVID-19 epidemics, Nat. Med. (2020) 1–6. doi:10.1038/
s41591-020-1104-0.
[13] J. Wang, X. Lin, Y. Liu, Qilegeri, H. Lin, M. Wu, Global dynamics of a SUIR model with predicting
COVID-19, ArXiv200412433 Phys. Q-Bio (2020). arXiv:2004.12433.
[14] Y. Zhou, L. Wang, L. Zhang, L. Shi, K. Yang, J. He, B. Zhao, W. Overton, S. Purkayastha, P. Song,
A Spatiotemporal Epidemiological Prediction Model to Inform County-Level COVID-19 Risk in
the United States, Harv. Data Sci. Rev. (2020). doi:10.1162/99608f92.79e1f45e.
15

[15] Y. Gao, G.-Y. Cai, W. Fang, H.-Y. Li, S.-Y. Wang, L. Chen, Y. Yu, D. Liu, S. Xu, P.-F. Cui, S.-Q.
Zeng, X.-X. Feng, R.-D. Yu, Y. Wang, Y. Yuan, X.-F. Jiao, J.-H. Chi, J.-H. Liu, R.-Y. Li, X. Zheng,
C.-Y. Song, N. Jin, W.-J. Gong, X.-Y. Liu, L. Huang, X. Tian, L. Li, H. Xing, D. Ma, C.-R. Li, F. Ye,
Q.-L. Gao, Machine learning based early warning system enables accurate mortality risk prediction
for COVID-19, Nat. Commun. 11 (2020) 5033. doi:10.1038/s41467-020-18684-2.
[16] C. Shen, A. Chen, C. Luo, J. Zhang, B. Feng, W. Liao, Using Reports of Symptoms and Diagnoses
on Social Media to Predict COVID-19 Case Counts in Mainland China: Observational Infoveillance
Study, J. Med. Internet Res. 22 (2020) e19421. doi:10.2196/19421. arXiv:2004.06169.
[17] C. M. Yeşilkanat, Spatio-temporal estimation of the daily cases of COVID-19 in worldwide using
random forest machine learning algorithm, Chaos, Solitons & Fractals 140 (2020) 110210. doi:10.
1016/j.chaos.2020.110210.
[18] D. Zou, L. Wang, P. Xu, J. Chen, W. Zhang, Q. Gu, Epidemic Model Guided Machine Learning for
COVID-19 Forecasts in the United States, medRxiv (2020) 2020.05.24.20111989. doi:10.1101/
2020.05.24.20111989.
[19] S. H. White, A. M. del Rey, G. R. Sánchez, Modeling epidemics using cellular automata, Applied
Mathematics and Computation 186 (2007) 193–202. doi:10.1016/j.amc.2006.06.126.
[20] G. Schneckenreither, N. Popper, G. Zauner, F. Breitenecker, Modelling SIR-type epidemics by
ODEs, PDEs, difference equations and cellular automata – A comparative study, Simulation Modelling Practice and Theory 16 (2008) 1014–1023. doi:10.1016/j.simpat.2008.05.015.
[21] L. Jun-feng, Assessment and Prediction of COVID-19 Based on SEIR Model with Undiscovered
People, J. Univ. Electron. Sci. Technol. China 49 (2020) 1–9.
[22] Y.-C. Chen, P.-E. Lu, C.-S. Chang, T.-H. Liu, A Time-dependent SIR model for COVID-19 with
Undetectable Infected Persons, IEEE Trans. Netw. Sci. Eng. (2020) 1–1.
[23] B. Ivorra, M. R. Ferrández, M. Vela-Pérez, A. M. Ramos, Mathematical modeling of the spread of
the coronavirus disease 2019 (COVID-19) taking into account the undetected infections. The case
of China, Communications in Nonlinear Science and Numerical Simulation 88 (2020) 105303.
doi:10.1016/j.cnsns.2020.105303.
[24] X. Shi, Z. Chen, H. Wang, D.-Y. Yeung, W.-k. Wong, W.-c. Woo, Convolutional LSTM Network:
A machine learning approach for precipitation nowcasting, in: Proceedings of the 28th International Conference on Neural Information Processing Systems - Volume 1, NIPS’15, MIT Press,
Cambridge, MA, USA, 2015, pp. 802–810.
[25] E. A. Hernandez-Vargas, J. X. Velasco-Hernandez, In-host Mathematical Modelling of COVID-19
in Humans, Annual Reviews in Control (2020). doi:10.1016/j.arcontrol.2020.09.006.
[26] L. Wang, Y. Jiang, Escape dynamics based on bounded rationality, Physica A 531 (2019) 121777.
doi:10.1016/j.physa.2019.121777.
[27] M. Eckardt, K. Kappner, N. Wolf, Covid-19 Across European Regions: The Role of Border Controls, SSRN Scholarly Paper ID 3688126, Social Science Research Network, Rochester, NY, 2020.
[28] Y. Li, L. Yao, J. Li, L. Chen, Y. Song, Z. Cai, C. Yang, Stability issues of RT-PCR testing of
SARS-CoV-2 for hospitalized patients clinically diagnosed with COVID-19, J Med Virol 92 (2020)
903–908. doi:10.1002/jmv.25786.

16

[29] O. Vandenberg, D. Martiny, O. Rochas, A. van Belkum, Z. Kozlakidis, Considerations for diagnostic
COVID-19 tests, Nat. Rev. Microbiol. (2020) 1–13. doi:10.1038/s41579-020-00461-z.
[30] A. A. Ramos, I. S. Requerey, N. Vitas, DeepVel: Deep learning for the estimation of horizontal
velocities at the solar surface, A&A 604 (2017) A11. doi:10.1051/0004-6361/201730783.
[31] J. J. V. Bavel, K. Baicker, P. S. Boggio, V. Capraro, A. Cichocka, M. Cikara, M. J. Crockett, A. J. Crum, K. M. Douglas, J. N. Druckman, J. Drury, O. Dube, N. Ellemers, E. J. Finkel,
J. H. Fowler, M. Gelfand, S. Han, S. A. Haslam, J. Jetten, S. Kitayama, D. Mobbs, L. E. Napper, D. J. Packer, G. Pennycook, E. Peters, R. E. Petty, D. G. Rand, S. D. Reicher, S. Schnall,
A. Shariff, L. J. Skitka, S. S. Smith, C. R. Sunstein, N. Tabri, J. A. Tucker, S. van der Linden,
P. van Lange, K. A. Weeden, M. J. A. Wohl, J. Zaki, S. R. Zion, R. Willer, Using social and
behavioural science to support COVID-19 pandemic response, Nat. Hum. Behav. (2020) 1–12.
doi:10.1038/s41562-020-0884-z.
[32] S. Hsiang, D. Allen, S. Annan-Phan, K. Bell, I. Bolliger, T. Chong, H. Druckenmiller, L. Y. Huang,
A. Hultgren, E. Krasovich, P. Lau, J. Lee, E. Rolf, J. Tseng, T. Wu, The effect of large-scale
anti-contagion policies on the COVID-19 pandemic, Nature 584 (2020) 262–267. doi:10.1038/
s41586-020-2404-8.
[33] G. N. Wong, Z. J. Weiner, A. V. Tkachenko, A. Elbanna, S. Maslov, N. Goldenfeld, Modeling
COVID-19 Dynamics in Illinois under Nonpharmaceutical Interventions, Phys. Rev. X 10 (2020)
041033. doi:10.1103/PhysRevX.10.041033.
[34] S. Chang, E. Pierson, P. W. Koh, J. Gerardin, B. Redbird, D. Grusky, J. Leskovec, Mobility network
models of COVID-19 explain inequities and inform reopening, Nature (2020) 1–8. doi:10.1038/
s41586-020-2923-3.
[35] N. Stafford, Covid-19: Why Germany’s case fatality rate seems so low, BMJ 369 (2020). doi:10.
1136/bmj.m1395.
[36] A. Topirceanu, M. Udrescu, R. Marculescu, Centralized and decentralized isolation strategies
and their impact on the COVID-19 pandemic dynamics, ArXiv200404222 Phys. Q-Bio (2020).
arXiv:2004.04222.
[37] O. Valba, V. Avetisov, A. Gorsky, S. Nechaev, Self-isolation or borders closing: What prevents the
spread of the epidemic better?, Phys. Rev. E 102 (2020) 010401. doi:10.1103/PhysRevE.102.
010401. arXiv:2003.12290.
[38] Y. Ye, Q. Zhang, Z. Ruan, Z. Cao, Q. Xuan, D. D. Zeng,
Modeling the heterogeneous disease-behavior-information dynamics during epidemics, ArXiv200507012 Phys. (2020).
arXiv:2005.07012.
[39] B. Charoenwong, A. Kwan, V. Pursiainen, Social connections with COVID-19–affected areas increase compliance with mobility restrictions, Sci. Adv. 6 (2020) eabc3054. doi:10.1126/sciadv.
abc3054.

17

