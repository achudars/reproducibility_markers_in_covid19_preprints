Preprint submitted to Annual Reviews in Control: Special Issue on Covid-19

arXiv:2007.15412v2 [physics.soc-ph] 22 Dec 2020

Smart Testing and Selective Quarantine
for the Control of Epidemics
Matthias Pezzutto,1 Nicolas Bono Rossello,2 Luca Schenato,1 and Emanuele Garone2
1)

Department of Information Engineering, University of Padova (Italy)
email: matthias.pezzutto@phd.unipd.it, schenato@dei.unipd.it
2)
Service d’Automatique et d’Analyse des Systèmes, Université Libre de Bruxelles (Belgium)
e-mail: {nbonoros,egarone}@ulb.ac.be
(Dated: 22 December 2020)

This paper is based on the observation that, during Covid-19 epidemic, the choice of which individuals should be tested has an important impact on the effectiveness of selective confinement measures.
This decision problem is closely related to the problem of optimal sensor selection, which is a very
active research subject in control engineering. The goal of this paper is to propose a policy to smartly
select the individuals to be tested. The main idea is to model the epidemics as a stochastic dynamic
system and to select the individual to be tested accordingly to some optimality criteria, e.g. to
minimize the probability of undetected asymptomatic cases. Every day, the probability of infection
of the different individuals is updated making use of the stochastic model of the phenomenon and
of the information collected in the previous days. Simulations for a closed community of 10’000
individuals show that the proposed technique, coupled with a selective confinement policy, can reduce the spread of the disease while limiting the number of individuals confined if compared to the
simple contact tracing of positive and to an off-line test selection strategy based on the number of
contacts.
I.

INTRODUCTION

During the Covid-19 epidemic, one of the limiting factors that affected the capability to handle
the spread of the disease was the limited number of available tests. This lack of information has
created major issues in several countries and promoted the idea that testing is essential in the control
of an epidemic (Salath et al. (2020)).
Recent research works support the importance of testing to effectively control an epidemic,
see Brotherhood et al. (2020); Wang (2020); Eichenbaum et al. (2020). In this regard, the selection of the individuals to be tested has become a major concern in many countries. However, to
the best of the authors’ knowledge, research on how to define these testing policies is still at a very
early stage (Nowzari et al. (2016)).
This observation is testified by the de facto policies applied by decision makers during the Covid19 epidemic. Among the various policies we can mention the use of contact tracing of individuals
exposed to positive cases (Cereda et al. (2020)), contact tracing combined with additional random
testing (Shim et al. (2020)), the use of exhaustive control of new arrivals in isolated communities (Wang et al. (2020)), and the testing of people with high number of human interaction such as
health care personnel (Padula (2020)). It is worth to note that most of these strategies rely on the
appearance of symptomatic cases and required the use of hard lockdown policies to be effective.
Interestingly enough, the selection of individuals to test has important similarities with the problem of sensor selection for state estimation in the context of Wireless Sensor Networks. In both
cases only a limited amount of information on a partially unknown process can be retrieved due
to a limited amount of resources, i.e. the number of available tests or the channel bandwidth, respectively. The objective is to optimize where to collect the measurements based on the available
information and on the model of the process. Sensor selection has been an active field in the last two
decades: a method based on convex optimization is proposed by Joshi and Boyd (2008), a stochastic policy is studied by Gupta et al. (2006) and the optimal periodic policy for two sensors is given

2

by Shi et al. (2011). In the case of a general number of sensors the problem has been explored
by Vitus et al. (2012) over a finite horizon, by Mo et al. (2014) over the infinite horizon, and for a
general number of independent dynamical systems by Han et al. (2017). However most of available
works on sensor selection focus on real-valued dynamical systems, while the case where the process
state assumes values from a finite set is at the best of our knowledge still largely unexplored.
The first step to propose an effective smart testing is the selection of an adequate model to
monitor the epidemic. Compartmental epidemic models proved to provide accurate estimations of the dynamics of an epidemic (Brauer (2008)). These models can be divided in deterministic models, governed by differential equations (McCluskey (2010)), or stochastic models,
where the heterogeneity of small communities can be better represented (Bjørnstad et al. (2002);
Lopez-Herrero and Amador (2017)). New models tailored for the Covid-19 case have been developed seeking for more suitable approaches for the design of control strategies, e.g. Giordano et al.
(2020); Casella (2020); Franco (2020). However, the nature of compartmental models implies an
homogeneously distributed population with random mixing between individuals, which does not
inform about the granular distribution of the disease. To model the granularity of the spread of a
disease, network diffusion models provide a better insight of the population’s distribution and allow
to identify the critical clusters of the spreading.
The most common network diffusion models are based on Stochastic Cellular Automata (SCA),
where the spread of the disease depends on the interaction between neighboring cells (Mikler et al.
(2005); White et al. (2007)). This idea has been lately extended to more complex network topologies (Li et al. (2014); Keeling and Eames (2005)). In these complex network models the interactions between individuals are modelled as the edges of a graph. This representation makes it possible
to also model time-varying interactions, as well as selective quarantine policies (e.g. by removing
the connections of certain individual with the rest of the population). From the theoretical viewpoint it is possible to prove that any SCA model is equivalent to a Markov chain (Ruhi and Hassibi
(2015)). As we will discuss later on in this paper, this fact, although important from the theoretical
viewpoint, is however not very useful in practice as the resulting Markov chain has a number of
states that is exponential in the number of the states of SCA.
It is important to mention that while the use of network models has been often overlooked due to
the difficulty to monitor and define the interactions in real communities, in the authors’ opinion the
conception of more advanced tracking systems during the last pandemic leads naturally to this kind
of approaches.
The problem of estimating the state of partially observable dynamic networks has been object
of only a few studies in the last few years. One of the most studied problems is the estimation
of the source of an information spread in networks using only limited observations. Zhu and Ying
(2016); Zhu and Ying (2014) propose a sample path algorithm to estimate the location of a source of
information or a disease. Alexandru and Dragotti (2019) extend this idea to the case where multiple
rumours are spread and the time of the origin of the information is unknown. These works provide
interesting idea that can be possibly adapted for the estimation of the evolution of an epidemic over
a network.
An alternative approach to the surveillance of epidemics within networks can be found on the
use of a sentinel system to estimate the evolution of the epidemic as done by Braeye et al. (2019).
A sentinel system involves a limited network of selected reporting sites monitoring the disease in
small portions of the population. The obtained data is used to estimate the behaviour of the entire
network. Souty and Boëlle (2016) estimate the total number of cases of influenza based on the
population density associated to each reporting site. Although this approach uses the density of
population to improve the estimation of the state of the epidemic, the total population is still divided
into small clusters with homogeneous distribution and interactions.
At the time of the writing of this paper, some early work presenting attempts to define smart
testing and quarantine policies have been just published. In particular Berger et al. propose a policy
based on conditional quarantine and random testing. However, the model based on partial observations assumes that tested negatives are ”tagged” and they remain observable after a single test. In
another recent paper on the subject by Kasy and Teytelboym (2020), the trade-off between quarantine and testing is regarded by defining a certain threshold based on the infection probability and
related to the cost of testing or quarantining an individual. In this case, the partial information is

3

inferred based on the social group of the individual rather than its interactions within the network.
The main contribution of this paper is to propose a smart testing strategy to select the individuals
to be tested based on the estimated probability of infection of each individual. As a first step we
propose a method to make an approximated estimation of the current state of the epidemic which
is computationally inexpensive. On the basis of this estimation, the testing policy is defined as
a constrained optimization problem. This testing policy is coupled with a selective confinement
policy which allows to only confine few individuals of the population based on the outcome of the
tests. We compare the proposed strategy with the current best practice, namely contact tracing of
positive, and a suitable topology-based strategy, where individuals to test are selected according to
their number of contacts. Numerical simulations show the advantage of this approach both in terms
of number of infected individuals and in terms of number of individuals put in quarantine at each
time. In particular, on a population of 10’000 individuals, the total number of infected is 8 times
less and the total amount of days spent in quarantine is 5 times less with respect to the current best
practice, and the improvement with respect to the topology-based strategy is even more evident.
These results also show that tracing of contacts is crucial to keep under control the epidemic but it
can be largely improved by using the algorithms proposed in this paper. The proposed algorithms
can be used in a centralized way (e.g. by a decision maker) but they are also suitable to work in a
distributed privacy-aware fashion and to integrate with tracing devices.
The remainder of the paper is organized as follows. In Section II the proposed model of the
epidemic is presented. Sections III and IV introduce the exact and the approximated estimations of
the evolution of the epidemic. Section V defines the testing strategy and Section VI the quarantine
actions. In Section VII several simulations demonstrate the performance of the proposed strategies.
Section VIII provides conclusions and future works.
II. MODEL

Consider a population of N individuals where a disease is spreading. Each individual can be
susceptible, infected, or removed. The spreading of the epidemic is modelled according to the
following assumption.
Assumption 1 A susceptible individual can be infected by other infected individuals of the population with whom he had a direct contact. Once an individual is infected, the individual will eventually
become removed and cannot be infected a second time.
The exposure to an infected individual is a necessary but not-sufficient condition for a susceptible individual to become infected. Indeed, the contagion actually takes place if some events (e.g.
exchange of body fluids for flu-like illnesses) have occurred and thus it is intrinsically stochastic.
Motivated by these considerations, we model the transmission of the disease through random variables. Similarly, also recovery is modelled as a random variable to capture the uncertainty of the
recovery process.
Mathematically, each individual i has at fixed time instants, say every day, t a state ξi (t) ∈
{S, I, R} that can take three logical states:
• S - susceptible, the individual is healthy and was never infected before, so it is susceptible of
being infected;
• I - infected, the individual is infected and can infect others;
• R - removed, the individual has been infected in the past and cannot be infected anymore
(because immune or dead).
We denote with ui (t) ∈ {0, 1} the binary stochastic input representing the stochastic contagion
event at time t. The variable takes value ui (t) = 1 if the ith individual has been infected between
time t and time t + 1, and ui (t) = 0 otherwise.
To characterize ui we introduce the transmission variables Tji (t) ∈ {0, 1} which takes value
Tji (t) = 1 if the infection is transmitted from j to i between time t and time t + 1 given that the
individual j was infected and the individual i was susceptible. The same way ri (t) ∈ {0, 1} denotes

4

1

1

∀
FIG. 1. Evolution of the state.

the binary stochastic variable representing the stochastic recovery event at time t. In particular,
ri (t) = 1 if the ith individual becomes removed between time t and time t + 1, and ri (t) = 0
otherwise. Note that the recovery variable ri (t) denotes the moment that an individual is not infected
anymore, due to immunity or death.
Finally the state of each individual evolves according to the following equation


S if ξi (t) = S and ui (t) = 0





I if ξi (t) = S and ui (t) = 1
ξi (t + 1) =
(1)
or if ξi (t) = I and ri (t) = 0



R if ξi (t) = I and ri (t) = 1




or if ξi (t) = R

with

ui (t) = 1 −

Y

(1 − Tji (t))

(2)

j : ξj (t)=I

The state evolution of each individual is depicted by Fig 1. From the last equation it is clear that
an individual i can be infected by individual j if individual j was infected, i.e. ξj (t) = I, and if
the transmission occurred, i.e. Tji (t) = 1. The modelling of variable Tji (t) is summarized by the
following assumption.
Assumption 2 The transmission of the disease Tji (t) from an infected individual j to a susceptible
individual i is a Bernoulli random variable with mean wij (t), such as Tij ∼ B(wij ). Moreover
Tji (t) is independent of Tmn (k) ∀m, n, k 6= i, j, t and of the initial state ξn (0) ∀n. The mean
values are symmetric, i.e. wij (t) = wji (t). For any pair i, j of individuals that have no contacts
wij (t) = 0.
The variable ri (t) is modelled according to the following assumption,
Assumption 3 The recovery ri (t) is a Bernoulli random variable with mean λi constant over time.
Moreover ri (t) is independent of rj (k) ∀j, k 6= i, t, of Tmn (k) ∀m, n, k, and of the initial state
ξn (0) ∀n.
In general the system is partially observable as symptoms only appear in a small percentage of
the population. The appearance of symptoms is modeled by the random variable ei (t) ∈ {0, 1}
taking value ei (t) = 1 if i-th individual is infected and shows symptoms between time t and time
t + 1, and 0 otherwise. We model it according to the following assumption.
Assumption 4 The appearance of symptoms ei (t) is a Bernoulli random variable with mean θi constant over time. Moreover ei (t) is independent of ej (k) and rj (k) ∀j, k 6= i, t, of Tmn (k) ∀m, n, k,
and of the initial state ξn (0) ∀n.

5

State
Estimator

x̂(t|t)

Test
Selection

γ(t)

System
(Population)

y(t)

q(t)
Quarantine
Selection

FIG. 2. Control scheme
A.

Problem formulation

In this paper we consider the case in which only a limited amount NT of tests are available at
each time t. We assume that when a test is performed on the i-th individual at time t we obtain the
information if ξi (t) = I or not. No other information is provided by the test, so it is not possible
to distinguish if an individual is susceptible or recovered. We can formally introduce the auxiliary
state xi (t), taking value xi (t) = 1 if ξi (t) = I, and xi (t) = 0 otherwise, that represents the binary variable accessed by the test. For Covid-19 the value of xi (t) can be retrieved by exploiting
several different kind of tests. To date, even if false negative are not completely avoided, PCR
tests are widely considered to be very accurate (it is the only recommended method for the identification of Covid-19, see World Health Organization (2020a), and the reference standard for many
medical studies, see e.g. Dinnes et al. (2020)). Based on this consideration, the paper assumes that
available tests are ideal which is in line with an ample part of the literature dealing with testing
strategies (Piguillem and Shi; Berger et al.).
To model the testing phase, we introduce the selection variables γi (t) taking value γi (t) = 1
if individual i is selected to be tested at time t and γi (t) = 1 otherwise. Variable γ is thus a
controlled variable that can be managed to tackle the disease diffusion. Beside tested individuals,
we also consider that additional information is provided by symptomatic individuals. In the context
of this work, a symptomatic individual is assumed to be an infected person who spontaneously
visits a medical center with clear symptoms and it is diagnosed with the disease. Let S(t) =
{s1 (t), s2 (t) , . . . , sM(t) (t)} be the set containing the indices of the individuals who are tested at
the time instant t and of the individuals who show first symptoms at time t. Note that the cardinality
M (t) of the set is time-dependent since the number of symptomatic individuals is not constant. The
observed output at time t can be then expressed as
o
n
(3)
y(t) = xs1 (t) (t), xs2 (t) (t), . . . , xsM (t) (t)
while the set of the observed outputs up to time instant t is

Y 0:t = y(0), y(1), . . . , y(t)

(4)

and it represents the information available at time instant t. Beside the testing phase, the system
evolution is affected by the quarantine mechanism represented by the control variable qi (t), taking
value qi (t) = 1 if individual i is in quarantine at time t and qi (t) = 0 otherwise. The variable q(t)
is the control variable that governments use to tackle the epidemic.
The goal of this paper is the definition of a policy to select the individuals to be tested that,
in conjunction with a selective quarantine policy, is able to reduce the spread of the disease while
keeping a limited number of individuals in quarantine. To do so, we tackle the problem by proposing
the closed-loop structure reported in Fig.2 consisting of three stages: 1) estimation of the states
xi (t) using the information available Y 0:t from the feedback of the outputs; 2) selection of the NT
individuals to test by optimizing a reward function R(·); and 3) based on the output y(t), execution
of control actions through selective quarantine. The following sections focus on the derivation of a
proper state estimation given the information available Y 0:t and the definition of a suitable reward.

6

III. EXACT ESTIMATE: HIDDEN MARKOV MODEL

The state of the whole population is defined by the vector

ξ(t) = ξ1 (t), ξ2 (t), . . . , ξN (t) ∈ {S, I, R}N .

(5)

Under Assumptions 1,2,3, at any time t, the next state of the population ξ(t + 1) depends only
on the current state of the population ξ(t). Accordingly, in line of principle, the stochastic process
describing the evolution of the epidemic satisfies the Markov property and can be represented by a
Markov chain.
To model the dynamics of the Markov chain, we have to derive the transition matrix A ∈ 3N ×3N
whose entries are
Avz = P (ξ(t + 1) = z|ξ(t) = v).

(6)

where z, v ∈ {S, I, R}N represent two possible states of the network, and z, v represent the indices of the transition matrix associated to them. Under Assumptions 1,2,3, the next states of two
individuals are independent given the previous state of the population. It follows that
P (ξ(t + 1) = z|ξ(t) = v) =

N
Y

P (ξi (t) = zi |ξ(t − 1) = v),

(7)

i=1

allowing to compute the transition probabilities of the network as a derivation of the transition
probabilities between the states of each single individual. Since only the transition from susceptible
to infected depends on the state of other individuals, the following simplification holds
(
P (ξi (t + 1) = zi |ξ(t) = v)
if vi = S
P (ξi (t + 1) = zi |ξ(t) = v) =
(8)
P (ξi (t + 1) = zi |ξi (t) = vi ) otherwise,
where zi , vi ∈ {S, I, R}.
The state transition probability of any individual at time t can be computed as
(
Q
P (ξi (t + 1) = I|ξ(t) = v, vi = S) = 1 − j : vj =I (1 − wji (t))
P (ξi (t + 1) = R|ξi (t) = I) = λi ,
while the probability of remaining in a given state is


P (ξi (t + 1) = S|ξ(t) = v, vi = S) = 1 − P (ξi (t + 1) = I|ξ(t) = v, vi = S),
P (ξi (t + 1) = I|ξi (t) = I) = 1 − P (ξi (t + 1) = R|ξi (t) = I),

P (ξ (t + 1) = R|ξ (t) = R) = 1.
i
i

(9)

(10)

All other transitions have probability 0.
A major difficulty in our setting is that the evolution of the system can be only observed by
symptomatic individuals and selective tests on the population. Since M (t) < N , the Markov model
is hidden and can be only partially observed through the output. The complete characterization
of the state given the available information is provided by the joint distribution p(ξ(t), Y 0:t ). For
a given Y 0:t , the joint distribution can be represented by a vector of dimension 3N with entries
p(z, Y 0:t ) = p̂t (z) ∀z ∈ {S, I, R}N . In the case of Hidden Markov Models, this joint distribution
can be easily computed by means of the forward algorithm (see Blunsom (2004); L. R. Rabiner
(1989)), providing the following expression
p̂t (z) = p(ξ(t) = z, Y 0:t−1 , y(t))
= P (y(t)|ξ(t) = z, Y 0:t−1 )p(ξ(t) = z, Y 0:t−1 )
X
= P (y(t)|ξ(t) = z)
P (ξ(t) = z|ξ(t−1) = v)p(ξ(t−1) = v, Y 0:t−1 )
v
X
= P (y(t)|ξ(t) = z)
Avz p̂t−1 (v).
v

(11)

7

The computation of P (y(t)|ξ(t) = z) is then easy: P (y(t)|ξ(t) = z) = 1 if the state ξ(t) = z gives
the output y(t), and 0 otherwise, namely if y(t) is not a possible output for the state z.
From the joint distribution, the conditional distribution is
p(ξ(t) = z | Y 0:t ) =

p(ξ(t) = z, Y 0:t )
p(ξ(t) = z, Y 0:t )
P
=
0:t )
p(Y 0:t )
z p(ξ(t) = z, Y

(12)

where we used the Bayes rule and the law of total probability. Recall now that the optimal
estimate of a random variable corresponds to the expected value given the observations, see
Anderson and Moore (2012). Then the optimal estimate of the i-individual x̂i (t|t) is
h
i
X
x̂i (t|t) = E xi (t)|Y 0:t = P (xi (t) = 1|Y 0:t ) =
p(ξ(t) = z|Y 0:t ).
(13)
z:zi =I

where we used the definition of expected value for a binary variable and the law of total probability. This procedure allows to obtain the probability of each individual to be infected at time t
given the complete vector of observations Y 0:t . However, in spite of allowing to compute the exact
probability, this approach requires the computation of all the transition probabilities of the matrix
A and the use of a vector variable of size 3N , which is not computationally feasible even for small
populations.

IV.

AN APPROXIMATED STATE ESTIMATE

Due to the prohibitive burden of an exact probability computation, in this paper we propose an approximated low-computational algorithm to estimate such probability. The proposed approximated
estimation is based on the idea of temporal and spatial truncation of the updates and is also suitable
for decentralized implementations More precisely, we propose to propagate the information from
testing only to individuals that are the most correlated to the tested individuals, namely the ones that
have direct contact with tested people, while for the remaining part of the population the update is
performed based on previous estimates and the topology of the network representing the population.
In the same way, only a limited amount of past state estimates are assumed to be affected by the
new information. This approximation allows to retrieve the information regarding the individuals
that are most affected by the result of each test while keeping a limited computational time.

A.

Approximated State Estimation Definitions

We define the estimate of the state of the individual i as
x̂i (t|t) = E[xi (t) | Ii0:t ] = P (xi (t) = 1 | Ii0:t )

(14)

where the local information set for the i-th individual Ii0:t is defined as

Ii0:t = Ii0:t−1 ∪ x̂k (t − 1|t − 1), k : wik (t) 6= 0

∪ x̂k (τ |t), τ ≤ t − 1, k ∈ S(t) ∪ y(t).

(15)

Local information set Ii0:t consists of the local state estimates of direct contacts, updated at the
time instant of the interaction, and the state estimates of tested individuals, updated just after the
test. In order to keep the computations associated to the i-th individual limited, we define a local
approximated estimation which can be retrieved based only a partial knowledge of the network.
More precisely, the state of each individual is estimated under the assumption that only its contacts
are known, and no information on the connections between any other individuals is assumed to be
available. In this sense, we will focus only on individuals with whom the i-th individual was in
contact: in the case of untested individuals we will use only the previous local estimates x̂k (t −

8

1|t − 1) while in the case of tested individuals we will use the current state xk (t) ∈ y(t) and the
updated estimation x̂k (τ |t), τ ≤ t − 1 of past states.
Denote by Xi0:t the (random) vector collecting all the random variables xi (τ ) τ ≤ t, namely
′
0:t
Xi = xi (0), . . . , xi (t) . With a little misuse of notation Xi0:t = 0 denotes the case where all
the past states xi (τ ), τ ≤ t, are equal to 0. We assume that the random variables Tji (τ )xj (τ ), j 6=
i, are conditional independent given Xi0:τ = 0. Similar assumptions are made by Valdano et al.
(2015) and Boguná et al. (2013). The rationale is that, if the individual i has always been healthy,
the coupling between two of his neighbours m and n is negligible, as in the case when individual i
is the only connection between m and n or, even if wmn (τ ) 6= 0, contacts of n are enough different
from contacts of m. It follows that
E

h

ui (τ ) | Xi0:τ

i

=0 =1−

N
Y

1 − wij (τ )P (xj (τ ) = 1|Xi0:τ = 0).

(16)

j=1

To further simplify the estimation algorithm we will simplify the stochastic recovery with a deterministic one based on the average recovery time D. Then we have
x̂i (t|t) = P (xi (t) = 1 | Ii0:t )
= P (at least a contagion in (t−D, t) ∩ Xi0:t−D = 0 | Ii0:t )
= P (Xi0:t−D = 0 | Ii0:t ) − P (Xi0:t = 0 | Ii0:t )

(17)

We compute P (Xi0:t = 0 | Ii0:t ) and P (Xi0:t−D = 0 | Ii0:t ) as
P (Xi0:τ = 0 | Ii0:t )
= P (ui (τ −1) = 0 ∩ Xi0:τ−1 = 0 | Ii0:t )
= P (ui (τ −1) = 0 | Xi0:τ−1 = 0, Ii0:t )P (Xi0:τ−1 = 0 | Ii0:t )
"
#


= 1 − E ui (τ −1) Xi0:τ−1 = 0, Ii0:t


=

N
Y

j=1

P (Xi0:τ−1 = 0 | Ii0:t )


1 − wij (τ −1)P (xj (τ −1) = 1|Xi0:τ−1 = 0, Ii0:t )P (Xi0:τ−1 = 0|Ii0:t )

(18)

where the last equality holds since Tji (τ )xj (τ ) j 6= i are conditional independent given Xi0:τ−1 = 0.
To obtain the numerical value of P (Xi0:τ = 0 | Ii0:t ) would require to compute P (xj (τ − 1) =
1 | Xi0:τ−1 = 0, Ii0:t ) that in turn would require P (xk (τ − 2) = 1 |Xj0:τ−1 = 0, Xi0:τ−1 = 0, Ii0:t )
and so on. Since this propagation is very computationally expensive we make the approximation
that
P (xj (τ −1) = 1|Xi0:τ−1 = 0, Ii0:t ) = P (xj (τ −1) = 1 | Ii0:t ).

(19)

The underlying assumption is that the state of an individual and those of its neighbors are independent. The accuracy of this assumption has been explored by Gleeson et al. (2012) where it has been
shown that the dynamics are well approximated if the degrees of closest neighbours are high. In the
same way the assumption holds when the underlying network of contacts is time-varying, the results
can be less accurate if pairs of individuals have frequent interactions, and many contacts in common. Since this happens in real life (think of relatives and colleagues), we introduce a correction
factor σij (wij (τ ), wij (τ −1), . . . , wij (0))) ∈ [0, 1], for simplicity denoted by σij (τ ), that accounts
for the coupling of individuals i and j due to the interactions before τ
P (xj (τ −1) = 1|Xi0:τ−1 = 0, Ii0:t ) = σij (τ −1)P (xj (τ −1) = 1 | Ii0:t ).

(20)

In line of principle, σij (τ ) is as smaller as many interactions have occurred between i and j in the
past. In fact, the probability that j is infected given that i has been healthy (namely the left hand

9

side of eq. (19)) is lower than the probability that j is infected without any knowledge on the past
states of i (namely the right hand side of eq. (19)). An efficient way to compute σij (τ ) is defined
in Sec. VII. We can conveniently incorporate the correction factor σij (τ ) in the term wij (τ ) as
w̄ij (τ ) = cij (τ )wij (τ ). We finally obtain the following update rule


N
Y
P (Xi0:τ = 0 | Ii0:t ) =  1− w̄ij (τ −1)P (xj (τ −1) = 1|Ii0:t )P (Xi0:τ−1 = 0|Ii0:t ).
(21)
j=1

To keep a limited number of computations, we also make the following approximation
(
P (xj (τ ) = 1 | Ij0:t )
if j ∈ S(t)
P (xj (τ ) = 1 | Ii0:t ) =
P (xj (τ ) = 1 | Ii0:t−1 ) otherwise.

(22)

with initialization P (xj (τ ) = 1 | Ii0:τ ) = x̂j (τ |τ ). Roughly speaking, if individual j has direct
contact with a tested individual k and individual i has direct contact with j but not with k, the state
estimates of j will be corrected based on the outcome while the state estimates of i will use the
old estimation of j, as derived without the knowledge of the outcome. This means that we use
the information regarding the outcome from the tests to only update the direct contacts of tested
individuals.
B.

State estimation update

Since the update of each individual uses only knowledge from local connections, new information
can be used differently for tested individuals, individuals with a direct contact with them, and the
remaining of the population.
Tested individuals

Let γ denote the outcome of the test to the individual i. Then we have
P (Xi0:τ = 0 | Ii0:t ) = P (Xi0:τ = 0| xi (t) = γ, Ii0:t−1 )
P (xi (τ ) =

1 | Ii0:t )

= P (xi (τ ) = 1 | xi (t) = γ,

Ii0:t−1 ).

(23)
(24)

If xi (t) = 0, no contagion happened in (t, t − D), namely
P (Xi0:τ = 0 | xi (t) = 0, Ii0:t−1 ) = P (Xi0:t−D = 0 | Ii0:t−1 )

(25)

for τ = t − D + 1, . . . , t, and
P (Xi0:τ = 0 | xi (t) = 0, Ii0:t−1 ) = P (Xi0:τ = 0 | Ii0:t−1 )

(26)

for τ ≤ t − D as no additional information on past states is given by a negative outcome. As
xi (t) = 0, xi (τ ) may be equal to 1 only if a contagion occurs in the interval (τ − D, t − D),
therefore the infection probability is updated as
x̂i (τ |t) = P (xi (τ ) = 1 | xj (t) = 0, Ii0:t−1 )
=

P (xi (τ ) = 1 ∩ xi (t) = 0 | Ii0:t−1 )
P (xi (t) = 0 | Ii0:t−1 )

=

P (Xiτ −D = 0 | Ii0:t−1 ) − P (Xit−D = 0 | Ii0:t−1 )
P (xi (t) = 0 | Ii0:t−1 )

(27)

for τ = t − D + 1, . . . , t and
x̂i (τ |t) = P (xi (τ ) = 1 | xj (t) = 0, Ii0:t−1 ) = P (xi (τ ) = 1 | Ii0:t−1 ) = x̂i (τ |t−1)

(28)

10

for τ ≤ t − D.
For the case of a positive result, xi (t) = 1, we have
P (Xi0:τ = 0 | xi (t) = 1, Ii0:t−1 ) = 1

(29)

for τ ≤ t − D, while for τ = t − D + 1, . . . , t it holds that
P (Xi0:τ = 0 | xi (t) = 1, Ii0:t−1 )
= P (Xi0:t−D = 0 ∩ no contagion in (t−D, τ ) | xi (t) = 1, Ii0:t−1 )
= 1−P (at least a contagion in (t−D, τ )|Xi0:t−D = 0, xi (t) = 1, Ii0:t−1 )
= 1−

P (at least a contagion in (t−D, τ ) ∩ xi (t) = 1|Xi0:t−D = 0, Ii0:t−1 )
P (xi (t) = 1 | Xi0:t−D = 0, Ii0:t−1 )

=1−

P (at least a contagion in (t − D, τ ) | Xi0:t−D = 0, Ii0:t−1 )
P (xi (t) = 1 | Xi0:t−D = 0, Ii0:t−1 )

=1−

P (Xi0:t−D = 0 | Ii0:t−1 ) − P (Xi0:τ = 0 | Ii0:t−1 )
P (Xi0:t−D = 0 | Ii0:t−1 ) − P (Xi0:t = 0 | Ii0:t−1 )

(30)

If xi (t) = 1, xi (τ ) is equal to 1 only if the contagion occurred in the interval (t − D, τ ). Knowing
that P (Xit−D = 0 | Ii0:t ) = 1, we can compute the infection probability for these individuals as
x̂i (τ |t) = P (xi (τ ) = 1 | xi (t) = 1, Ii0:t−1 ) = 1 − P (Xi0:τ = 0 | Ii0:t )

(31)

for τ = t − D + 1, . . . , t and
x̂i (τ |t) = P (xi (τ ) = 1 | xi (t) = 1, Ii0:t−1 ) = 0

(32)

for τ ≤ t − D.

Neighbours of tested individuals

Formally the neighbours of a tested individual are defined by the set Q(t) = {i | ∃wik (τ ) 6=
0, k ∈ S(t), τ < t} which represents the set of individuals that has been in contact at least once
with at least a tested individual. According to the definition of local information set, the update of
the estimation exploits also the updated estimate of the past states of tested individual.
The probability relative to the initial time instant is not changed
P (Xi0 = 0 | Ii0:t ) = P (Xi0 = 0).

(33)

By using the information from the contacts that have been tested at time instant t we can update the
probabilities starting from (21) as
Y
1− w̄ij (τ −1)P (xj (τ −1) = 1|Ii0:t )·
P (Xi0:τ = 0|Ii0:t ) = P (Xi0:τ −1 = 0|Ii0:t ) ·
j∈S(t)

Y

1− w̄ik (τ −1)P (xk (τ −1) = 1|Ii0:t )

k∈S(t)
/

=

P (Xi0:τ −1

=

0|Ii0:t )

·

Y

1− w̄ij (τ −1)P (xj (τ −1) = 1|Ij0:t )·

j∈S(t)

Y

1− w̄ik (τ −1)P (xk (τ −1) = 1|Ii0:t−1 )

k∈S(t)
/

=

P (Xi0:τ

=

0 | Ii0:t−1 )ci,1 (τ, t)ci,2 (τ, t)

(34)

11

using (22), where
P (Xi0:τ−1 = 0 | Ii0:t )
P (Xi0:τ−1 = 0 | Ii0:t−1 )
Q
0:t
j∈S(t) 1 − w̄ij (τ − 1)P (xj (τ −1) = 1 | Ij )
ci,2 (τ, t) = Q
0:t−1
)
j∈S(t) 1 − w̄ij (τ − 1)P (xj (τ −1) = 1 | Ii
ci,1 (τ, t) =

(35)
(36)

Note that the previous update takes advantage from the knowledge of the update estimate of the
past state of tested individuals. The last equality holds only if individual i has not been tested
before, otherwise P (Xi0:τ−1 = 0 | Ii0:t−1 ) would be different according to the update relative to a
tested individual. In that case, the correction procedure starts from the instant where the individual
was tested. The correction procedure works if more than one neighbour have been tested even in
different time instants. Note that c2,i (τ, t) > 1 if xj (t) = 0 and c2,i (τ, t) < 1 if xj (t) = 1. Finally,
the infection probability at time t is computed as
x̂i (t|t) = P (xi (t) = 1 | Ii0:t ) = P (Xi0:t−D = 0 | Ii0:t ) − P (Xi0:t = 0 | Ii0:t ).

(37)

Open-loop state estimation

For each individual not having direct contact with any tested individual, the open-loop estimate
is computed as P (Xi0:t = 0 | Ii0:t−1 ) based on the previous estimates P (xj (t − 1) = 1 | Ii0:t−1 )
provided by its contacts as


N
Y
1− w̄ij (t−1)P (xj (t−1) = 1 | Ii0:t−1 ) P (Xi0:t−1 = 0 | Ii0:t )
P (Xi0:t = 0 | Ii0:t ) = 
j=1



=

N
Y

j=1



1− w̄ij (t − 1)x̂j (t−1|t−1) P (Xi0:t−1 = 0 | Ii0:t ).

(38)

using (21) and (22). Other required values are updated according to

C.

P (Xi0:τ = 0 | Ii0:t ) = P (Xi0:τ = 0 | Ii0:t−1 )

τ≤t−1

P (xi (τ ) = 1 | Ii0:t ) = P (xi (τ ) = 1 | Ii0:t−1 )
x̂i (t|t) = P (xi (t) = 1 | Ii0:t ) = P (Xi0:t−D

τ ≤ t−1
=

0 | Ii0:t )

−

P (Xi0:t

(39)
(40)
=

0 | Ii0:t ).

(41)

Overall estimation scheme

The state estimation scheme proposed above performs a hierarchical update of the infection probability. This update is structured around individuals that are tested at time t, the neighbors of the
tested individuals and the remaining of the population. At each time instant, the estimation is thus
divided into 3 levels of update based on the derivations obtained in the previous subsection:
• First level: Tested individuals, using the output y(t) from the performed tests
• Second level: Neighbors of tested individuals, including the update estimate from the first
level and the previous estimates x̂(τ |t), τ < t
• Third level: Rest of the population (open loop), using only the previous estimates x̂(t−1|t−1).
This scheme is depicted in Fig. 3.
In line of principle, buffers of increasing length are needed to store past probabilities. In the spirit
of a temporal truncation of the updates, since the current test outcomes bring little information on

12

First level
-

−

−

Second level

Third level

FIG. 3. 3 level update of the state estimate.

the oldest states except for positive tested individuals, we assume that for untested individuals past
probabilities older than Dw are not affected by the new outcomes, i.e.
P (Xit:t−Dw = 0 | Ii0:t ) = P (Xit:t−Dw = 0 | Ii0:t−1 ).

(42)

Under this approximation, in terms of information storage, the local update of the current state
estimate requires the storage of the following two buffers of information for each individual, namely
the Susceptibility buffer
i
Bsus
(t) = {P (Xi0:t−D = 0 | Ii0:t ), . . . , P (Xi0:t = 0 | Ii0:t )}

(43)

and, the Infection probability buffer
i
Binf
(t) = {P (xi (t−D−Dw ) = 1 | Ii0:t ), . . . , P (xi (t) = 1 | Ii0:t )}.

(44)

It is worth to note that the complexity of the proposed estimator is much lower than the optimal
estimation devised in the previous section. At each update, the open-loop state estimation requires
for each individual the product of a sequence of at most N real factors, see (38). Since only effective
contacts (namely those with wij 6= 0) affect the product, the number of required multiplications
drastically falls and scales with the node degree. The second level update requires, for each contact
of a tested individual, the correction of the last Dw values and involves simple multiplications of
scalar quantities, see (34). Similarly, at the first level, for each tested individual, the update of the
last estimates requires only elementary operations using already available quantities (see (27) and
(30)).
An interesting feature of the proposed approach is that it is not only computationally efficient
to be used in a centralized way for a given community, but that it can be also implemented in a
decentralized manner. This is the case where each individual is equipped with a smart device (e.g.
a smartphone) provided with small computational capabilities and able to communicate with other
devices and with a central testing unit, see Fig. 5.
Contact tracing mechanisms have already been applied by many countries during Covid-19 epidemic and software are already available in the market. With respect to them, our algorithm can be
implemented based on the same hardware and with a larger amount of transmitted data. In particular, when individuals get in contact during the day, their previous estimate x̂i (t − 1|t − 1) has to
be exchanged. The outcomes of the tests y(t) are provided to tested individuals who compute and
communicate the updated estimates of the previous states x̂j (τ |t), j ∈ S(t) to the server. Then remote communications of those updated estimates are performed once per day from the main server
to the population. An explanatory representation is given in Fig. 4.
Note that no information on interactions is communicated neither to the central unit or other
individuals, so that privacy is preserved and vulnerability of a central data collector is avoided.
Then, each individual transmits the updated estimates x̂i (t|t) to the server which decides who to
test the next day and convoke them.

13
s

−

−

− 1| − 1)

Informaon
collecon

( − 1| − 1)

| )

Update
es maon

Update
Selecon

(Interacons)

FIG. 4. Information collection and update of each individual.

server

smartphone
(individual j)

smartphone

smartphone

(individual k)

(individual i)

smartphone
(individual l)

FIG. 5. Required communications. Full lines=local data exchange, dotted lines=remote communication.

V.

TESTING POLICY

Similarly to the literature on sensor selection, it is possible to formulate the test selection problem
as a constrained optimization problem based on the state estimate. Formally, we introduce the binary
control variable γi (t) taking value γi (t) = 1 if i-th individual is selected at time instant t to be tested
at the next time instant t+1, and γi (t) = 0 otherwise, while we denote γ(t) = (γi (t), . . . , γN (t))′ .
Then the test selection problem can be formulated as
γi (t) = arg max R(x̂(t|t), γ)
γ

s.t.

N
X

γi ≤ N T

(45)
(46)

i=1

where R(·) is a suitable reward function.
Several possibilities exist for the choice of the cost function. Differently from most of the works
on sensor selection for remote estimation, we avoid to adopt the error covariance matrix because
it is computationally infeasible for large N . More suitable cost functions can be computed based
on different metrics of the current state of the population or the topology and characteristics of
the network. Namely, intuitive choices would focus on the expected number of detected people,
the expected number of infections at the next time instant t + 1 or targeting individuals with high
number of contacts (i.e. first-line health workers). In this context, different cost functions may
provide different results based on the time of application of their actions, the number of available
tests or the quarantine actions applied.

14

Based on good preliminary results, in this paper we propose to maximize the expected value of
the number of detected positive individuals, that is


N
N
X
X
0:t


R(x̂(t|t), γ) = E
γi xi (t) Y
=
γi x̂i (t|t).
(47)
i=1

i=1

This policy is equivalent to select the NT individuals whose probability of being infected x̂i (t|t) is
the highest.
It should be noted that the proposed cost function is a primary attempt to define an efficient metric
in line with the presented framework. Nonetheless, the selection of the optimal cost function is out
of the scope of this paper and remains an open problem for further research.

VI.

QUARANTINE ACTIONS

The outcomes of the tests are exploited to act on the population through a selective quarantine.
Formally, we introduce the control variable qk (t) such that qk (t) = 1 if k-th individual is selected
to be quarantined at time instant t, and qk (t) = 0 otherwise. In this paper for any positive i we
propose to quarantine the L closest neighbours, i.e. the L individuals with the highest transmission
probability wij (t). The parameter L can be properly tuned to trade-off between the total number of
quarantined for positive and the expected number of infected (but not detected) that are quarantined
because they have a direct contact with a positive. We consider that individuals will leave quarantine
after DQ days.
Note that in line of principle other quarantine strategies can be designed based on probabilities of
infection of the neighbours of a positive tested, as well as preventive quarantine based only on the
state estimate, and they will be the subject of future investigations.

VII. NUMERICAL SIMULATIONS

This section shows, through numerical simulations, the effectiveness of the proposed solution by
comparing it to current approaches.

A.

Setting

The simulation setup considers a closed population of 10’000 individuals with the following
parameters regarding the spread of the disease
• R0 = 2. This value is equivalent to a virus with high spreading, e.g. the Covid-19, when no
social distance measures are adopted (Giordano et al., 2020; Salath et al., 2020).
• 0.1% of the population is initially infected.
• 20% of new infected present symptoms of the disease before the recovery, in agreement with
Ing et al. (2020) and Lavezzo et al. (2020).
• 0.5% of the population can be tested at each day, corresponding to NT = 50. This value
is similar to the percentage of daily tests in South Korea or in USA at December 2020, see
https://covidtracking.com/data.
• The L = 5 closest individuals of each individual with positive test are put in quarantine for
DQ = 14 days. When in quarantine, all the transmission probability wij are reduced to 1/100
of their normal value.

15

The population distribution can be conveniently represented through a weighted undirected graph,
where each node represents an individual, an edge between two nodes represents an interaction between two individuals, and the weight is set equal to the probability of transmission wij . The graph
topology has been generated to emulate a small-world network. This kind of graphs are characterized by the presence of clusters, which are subgraphs that are (almost) complete, and of short paths
connecting (almost) any pair of nodes. They have been introduced to capture the evidence of human
connections and have been widely studied in the literature, see de Sola Pool and Kochen (1978) and
Watts and Strogatz (1998). In our case, each individual belongs to more clusters (at least 2, up to 6)
to mimic families, offices, habitual relations and activities, etc. Dimensions of the clusters are uniformly distributed and the range depends on the kind of relationship that they capture: for example
dimensions of households randomly vary from 1 to 8, while dimensions of offices vary from 4 to 40.
Random links are also added to the network. The resulting graph is then heterogeneous and possibly
unbalanced. Average weights are set in a realistic way, e.g. average weights in a household are four
times the ones in a small office. For the sake of simplicity the graph is assumed to be time-invariant,
except for the effects of quarantine action.
Initial conditions ξ(0), i.e. which individuals are initially infected, are stochastically generated
based on the initial probability of each node to be infected. To test the robustness of the proposed
strategy, we assume that the probability distribution of the initial conditions is perturbed up to the
10%. It is also assumed that 10% of the arcs of the graph are unknown.
The presented simulations compare three different scenarios:
• Test and trace (T&T). This policy tracks the contacts (based on the knowledge of the network)
of symptomatic and detected cases (see Ferretti et al. (2020) and Dar et al. (2020)). More
formally we define the set of individuals that have been detected at a generic time τ as D(τ ) =
{i ∈ S(τ ) : xi (τ ) = 1}. Then for any individual i ∈ D(t−1) we retrieve the set of recent
contacts Ni (t) = {j : wij (τ ) > 0, t− D < τ < t}, and we refine it by removing already
detected individuals and individuals that have been recently tested. From the set Ni (t) we
select the individuals that have been more in contact with the individual i ∈ D(t−1). Among
the different possibilities for doing so, we choose N i (t) ⊆ Ni (t) such that
wik (t−1) ≥ wiℓ (t−1) ∀k ∈ N i (t) ∀ℓ ∈ Ni (t)
[
N i (t) = NT
i∈D(t−1)

|N i (t)| − |N j (t)| ∈ {−1, 0, 1}

(48)
(49)
(50)

where |·| denotes the cardinality of the set. Less rigorously, we can say that N i (t) contains the
contacts of i with which the last interaction has been the most dangerous, while the number of
individuals in each set N i (t) is chosen such that tests are allocated as uniformly as possible
among the sets Ni (t) of contacts of detected positive. Please note that, since in the following
simulations the graph is fixed, wik (t−1) ≥ wiℓ (t−1) implies that wik (τ ) ≥ wiℓ (τ ) for any
τ ≤ t − 1 if k, ℓ has not been in quarantined. Remaining tests are used to randomly explore
other parts of the graph in order to model test selection policies that are not based on the
probabilities of infection, as it is done in reality where tests are also partially allocated to the
employs of interested companies. Test and trace strategy is a well-known policy which has
provided good results in several countries and it has been considered the best practice by the
medical community World Health Organization (2020b).
• Topology-based testing. This scenario presents a policy where, based on the topology of the
graph, i.e. the number of contacts, certain individuals are periodically tested. In particular we
choose a period T = 20 days and we solve the constrained optimization problem
X X
γ T = arg max
wij (0)γi
(51)
γ
i
j
X
s.t.
γi ≤ T N T
(52)
i

Individuals such that γiT = 1 are then randomly sorted and tested accordingly. The periodical
testing campaign is on-line delayed in order to allocate tests to the closets neighbours of a

16

new detected. However we consider only a partial tracing, assuming that at most 8 contacts
are provided. The application of topology-based centrality metrics for test selection is quite
new but they have been studied to select the edges to remove (see Doostmohammadian et al.
(2020) and references therein).
• Smart testing (T&EST). This scenario follows the proposed control scheme where individuals
are selected according to the probability of being infected, eq. (47), and the outcomes of the
tests are used to update the state estimate according to Sec. IV. The correction term is set as
σij (wij (t), wij (t−1), . . . , wij (0))) = (1 − ǫ)|Tij (t)|

(53)

Tij (t) = {τ > 0 : t−D < τ < t, wij (τ ) > 0}

(54)

with

so |Tij (t)| is the number of days in the last D with a contact between individual i and j. We
set parameter ǫ by fitting the time evolution of the mean probability computed by the proposed
estimator to the incidence of cases obtained by simulating a graph of a similar topology in the
case of no actions on the system.
Given the stochastic nature of the model, 100 simulations have been generated for each scenario.
The spread of the infectious disease is monitored for a time span of 300 days.
B.

Results

As we can see in Fig. 6, the proposed control mechanism (testing based on estimation and conditional quarantine) is effective in reducing the total number of infected people in a given temporal
window both with respect to the topology-based strategy and test-and-trace. It is important to note
that the test-and-trace strategy clearly outperforms the topology-based strategy even if the latter,
when no new known positive are present, allocates tests on crucial points of the network instead of
on random individuals. This result confirms how important is to trace contacts of positive individuals in order to keep the epidemic under control. On the other hand, the comparison between T&T
and T&EST shows that the performance of pure tracing can be largely improved by using control
methodologies. In particular, when many positive individuals have been detected, it is impossible to
test all of their contacts due to the limited number of available tests. In that case, with the proposed
strategy, the contacts that should be tested naturally come up among all the other contacts. When no
new positive is detected, T&EST selects who to test using updated information on the state of the
population. Thus, the proposed strategy takes into account both information on the graph topology

4000
3500

T&T
T&EST

3000
2500
2000
1500
1000
500
0

0

50

100

150

200

250

FIG. 6. Evolution of the cumulative number of infected individuals.

300

17

400
T&T
T&EST

300
200
100
0

0

50

100

150

200

250

300

250

300

FIG. 7. Evolution of the number active cases.

120
T&T
T&EST

100
80
60
40
20
0

0

50

100

150

200

FIG. 8. Evolution of the number active cases for test-and-trace and the presented strategy.

(for individuals that has not been in contact with tested, estimation is affected by the number of interactions) and the information from tests. Obtained results show that including dynamics provides
better performances than simpler off-line strategies.
The proposed strategy is effective also in mitigating the epidemic outbreak by avoiding any peak
of active cases, as shown in Fig. 7. This is an important result since it is fundamental to have a
low number of active cases to avoid the health-care system maximum capacity to be reached. It
is important to remark that the presented approach has shown to be very effective when applied
to cases where the initial number of infected individuals is small compared to the total size of
the population. In such a case, a fast identification of clusters of infection is essential, providing
enough tracing to detected positive individuals but also exploring new areas of the network. This
improvement in the performance can be better appreciated in Fig 8.
The number of people in quarantine at each time instant is depicted in Fig. 9. Although not intuitive, this plot shows lower numbers of people in quarantine for the smart testing policy, indicating
that the improvement in performance does not require a greater number of people in quarantine but
that actually can be achieved with less but better focused quarantines. In these simulations the number of people in quarantine for the T&EST is almost negligible, showing that an efficient testing
policy can have a great impact also in the required control actions. This is a very promising result
especially from an economic point of view since it would limit the social and economical impact of
the measures.

18

500
T&T
T&EST

400
300
200
100
0

0

50

100

150

200

250

300

FIG. 9. Evolution of the number of individuals in quarantine.

A synoptic overview of the numerical simulations is reported in Table I. The results show the
clear improvement on the containment of the epidemic, in terms of both active cases and people in
quarantine, by using a testing and quarantine policy based on the presented estimation algorithm.
TABLE I. Summary of the averaged results for the 3 scenarios.
Scenario

Peak of active cases Total infected Work days lost
116
365
20

Test and trace
Topology-based strategy
Smart testing

1472
3859
169

2564
5847
444

An important aspect of the presented strategy is the assumption of a good knowledge of the
network topology. In this sense, Fig. 10 provides the variation in the performance of the presented
strategy with respect to the number of individual interactions known. From this plot it can be seen
that within the range of 80% − 100% of knowledge of the network, the results are very similar and
promising. For a percentage of unknown interactions superior to 20%, a threshold behaviour can be
seen, where the performance is clearly worse and a more evident peak of infection can be seen.

50

30%
22.5%
[5%,10%,15%,17.5%,20%]

40

30

20

10

0

0

50

100

150

200

250

300

FIG. 10. Variation of the strategy performance based on the knowledge of the network.

19

VIII. CONCLUSIONS

In this paper we presented a novel testing strategy to smartly select the individuals to be tested
during an epidemic. This policy is based on a decentralized state estimation of the status of the
epidemic obtained from the outcome of the tests.
The testing policy is defined as an optimization problem based on the state estimation. The
proposed estimation algorithm is computationally inexpensive and can even be implemented in a
distributed fashion.
The numerical results based on Montecarlo simulations demonstrate that the use of the proposed
scheme, testing and selective quarantine, significantly reduces the total number of infected people
as well as the peak of active case and the number of people put in quarantine.
Future works will focus on the link between the test selection objective functions and the quarantine policies. The case where the reliability of the test is considered is another subject of study in
future research.

REFERENCES

Roxana I. Alexandru and Pier Luigi Dragotti. Diffusion source detection in a network using partial observations. In
Yue M. Lu, Manos Papadakis, and Dimitri Van De Ville, editors, Wavelets and Sparsity XVIII, page 20, San Diego,
United States, September 2019. SPIE. ISBN 978-1-5106-2969-1 978-1-5106-2970-7. doi:10.1117/12.2529418. URL
https://www.spiedigitallibrary.org/conference-proceedings-of-spie/11138/2529418/Diffusion-source-detectio
Brian DO Anderson and John B Moore. Optimal filtering. Courier Corporation, 2012.
David Berger, Kyle Herkenhoff, and Simon Mongey. An SEIR Infectious Disease Model with Testing and Conditional
Quarantine. URL https://www.nber.org/papers/w26901.
Ottar N. Bjørnstad, Bärbel F. Finkenstädt, and Bryan T. Grenfell.
Dynamics of measles epidemics : Estimating scaling of transmission rates using a time series sir model.
Ecological Monographs, 72(2):
169–184, May 2002.
ISSN 0012-9615.
doi:10.1890/0012-9615(2002)072[0169:DOMEES]2.0.CO;2.
URL
http://doi.wiley.com/10.1890/0012-9615(2002)072[0169:DOMEES]2.0.CO;2.
Phil Blunsom.
Hidden markov models.
Lecture notes, August, 15(18-19):48, 2004.
URL
http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.123.1016&rep=rep1&type=pdf.
Marian Boguná, Claudio Castellano, and Romualdo Pastor-Satorras. Nature of the epidemic threshold for the susceptibleinfected-susceptible dynamics in networks. Physical review letters, 111(6):068701, 2013.
Toon Braeye, Sophie Quoilin, and Niel Hens.
Incidence estimation from sentinel surveillance data; a simulation study and application to data from the Belgian laboratory sentinel surveillance.
BMC Public Health, 19(1):982, December 2019.
ISSN 1471-2458.
doi:10.1186/s12889-019-7279-y.
URL
https://bmcpublichealth.biomedcentral.com/articles/10.1186/s12889-019-7279-y.
Fred Brauer. Compartmental Models in Epidemiology. In Fred Brauer, Pauline van den Driessche, and Jianhong Wu,
editors, Mathematical Epidemiology, pages 19–79. Springer Berlin Heidelberg, Berlin, Heidelberg, 2008. ISBN 978-3540-78911-6. doi:10.1007/978-3-540-78911-6. URL https://doi.org/10.1007/978-3-540-78911-6.
Luiz Brotherhood, Philipp Kircher, Cezar Santos, and Michèle Tertilt.
An Economic Model of
the COVID-19 Epidemic:
The Importance of Testing and Age-Specific Policies.
2020.
URL
https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3618840.
Francesco Casella. Can the covid-19 epidemic be controlled on the basis of daily test reports. arXiv preprint
arXiv:2003.06967, 2020.
Diletta Cereda, Marcello Tirani, Francesca Rovida, Vittorio Demicheli, Marco Ajelli, Piero Poletti, Frédéric Trentini, Giorgio
Guzzetta, Valentina Marziano, Angelica Barone, Michele Magoni, Silvia Deandrea, G Diurno, Mauro Lombardo, Martha
Faccini, A. Pan, Ricciardelli Bruno, Elena Pariani, Giacomo Grasselli, Alessandra Piatti, Maria Gramegna, Fausto Baldanti, Alessia Melegaro, and Stefano Merler. The early phase of the covid-19 outbreak in lombardy, italy. arXiv preprint
arXiv:2003.09320, 2020.
Aaqib Bashir Dar, Auqib Hamid Lone, Saniya Zahoor, Afshan Amin Khan, and Roohie Naaz. Applicability of mobile contact
tracing in fighting pandemic (covid-19): Issues, challenges and solutions. Computer Science Review, page 100307, 2020.
Ithiel de Sola Pool and Manfred Kochen. Contacts and influence. Social networks, 1(1):5–51, 1978.
Jacqueline Dinnes, Jonathan J Deeks, Ada Adriano, Sarah Berhane, Clare Davenport, Sabine Dittrich, Devy Emperador,
Yemisi Takwoingi, Jane Cunningham, Sophie Beese, et al. Rapid, point-of-care antigen and molecular-based tests for
diagnosis of sars-cov-2 infection. Cochrane Database of Systematic Reviews, (8), 2020.
Mohammadreza Doostmohammadian, Hamid R Rabiee, and Usman A Khan. Centrality-based epidemic control in complex
social networks. Social Netw. Analys. Mining, 10(1):32, 2020.
Martin Eichenbaum, Sergio Rebelo, and Mathias Trabandt.
The Macroeconomics of Testing and Quarantining. Technical Report w27104, National Bureau of Economic Research, Cambridge, MA, May 2020. URL
http://www.nber.org/papers/w27104.pdf.
Luca Ferretti, Chris Wymant, Michelle Kendall, Lele Zhao, Anel Nurtay, Lucie Abeler-Dörner, Michael Parker, David

20

Bonsall, and Christophe Fraser. Quantifying sars-cov-2 transmission suggests epidemic control with digital contact
tracing. Science, 368(6491), 2020.
Elisa Franco. A feedback sir (fsir) model highlights advantages and limitations of infection-based social distancing. arXiv
preprint arXiv:2004.13216, 2020.
Giulia Giordano, Franco Blanchini, Raffaele Bruno, Patrizio Colaneri, Alessandro Di Filippo, Angela Di Matteo, and
Marta Colaneri. Modelling the COVID-19 epidemic and implementation of population-wide interventions in Italy.
Nature Medicine, 26(6):855–860, June 2020. ISSN 1078-8956, 1546-170X. doi:10.1038/s41591-020-0883-7. URL
http://www.nature.com/articles/s41591-020-0883-7.
James P Gleeson, Sergey Melnik, Jonathan A Ward, Mason A Porter, and Peter J Mucha. Accuracy of mean-field theory for
dynamics on real-world networks. Physical Review E, 85(2):026106, 2012.
Vijay Gupta, Timothy H Chung, Babak Hassibi, and Richard M Murray. On a stochastic sensor selection algorithm with
applications in sensor scheduling and sensor coverage. Automatica, 42(2):251–260, 2006.
Duo Han, Junfeng Wu, Huanshui Zhang, and Ling Shi. Optimal sensor scheduling for multiple linear dynamical systems.
Automatica, 75:260–270, 2017.
Alvin J Ing, Christine Cocks, and Jeffery Peter Green. Covid-19: in the footsteps of ernest shackleton. Thorax, 2020.
Siddharth Joshi and Stephen Boyd. Sensor selection via convex optimization. IEEE Transactions on Signal Processing, 57
(2):451–462, 2008.
Maximilian Kasy and Alexander Teytelboym. Adaptive Targeted Infectious Disease Testing. Oxford Review of
Economic Policy, page graa018, June 2020. ISSN 0266-903X, 1460-2121. doi:10.1093/oxrep/graa018. URL
https://academic.oup.com/oxrep/advance-article/doi/10.1093/oxrep/graa018/5850165.
Matt J Keeling and Ken T.D Eames.
Networks and epidemic models.
Journal of The Royal Society Interface, 2(4):295–307, September 2005.
ISSN 1742-5689, 1742-5662.
doi:10.1098/rsif.2005.0051.
URL
https://royalsocietypublishing.org/doi/10.1098/rsif.2005.0051.
L. R. Rabiner. A tutorial on hidden Markov models and selected applications in speech recognition. Proceedings of the
IEEE, 77(2):257–286, February 1989. ISSN 1558-2256. doi:10.1109/5.18626.
Enrico Lavezzo, Elisa Franchin, Constanze Ciavarella, Gina Cuomo-Dannenburg, Luisa Barzon, Claudia Del Vecchio, Lucia
Rossi, Riccardo Manganelli, Arianna Loregian, Nicolò Navarin, et al. Suppression of covid-19 outbreak in the municipality of vo, italy. medRxiv, 2020.
Chun-Hsien Li, Chiung-Chiou Tsai, and Suh-Yuh Yang.
Analysis of epidemic spreading of an SIRS
model in complex heterogeneous networks.
Communications in Nonlinear Science and Numerical Simulation, 19(4):1042–1054, April 2014.
ISSN 10075704.
doi:10.1016/j.cnsns.2013.08.033.
URL
https://linkinghub.elsevier.com/retrieve/pii/S1007570413003833.
Mariajesus Lopez-Herrero and Julia Amador.
Cumulative and maximum epidemic sizes for a nonlinear SEIR stochastic model with limited resources.
Discrete and Continuous Dynamical Systems
- Series B, 22(5):18–18, September 2017.
ISSN 1531-3492.
doi:10.3934/dcdsb.2017211.
URL
http://www.aimsciences.org/journals/displayArticlesnew.jsp?paperID=14547.
C. Connell McCluskey. Complete global stability for an SIR epidemic model with delay — Distributed or discrete. Nonlinear
Analysis: Real World Applications, 11(1):55–59, February 2010. ISSN 14681218. doi:10.1016/j.nonrwa.2008.10.014.
URL https://linkinghub.elsevier.com/retrieve/pii/S1468121808002447.
Armin R. Mikler, Sangeeta Venkatachalam, and Kaja Abbas.
Modeling infectious diseases using global stochastic cellular automata.
Journal of Biological Systems, 13(04):421–439, December 2005.
ISSN 0218-3390,
1793-6470.
doi:10.1142/S0218339005001604.
URL
https://www.worldscientific.com/doi/abs/10.1142/S0218339005001604.
Yilin Mo, Emanuele Garone, and Bruno Sinopoli. On infinite-horizon sensor scheduling. Systems & control letters, 67:
65–70, 2014.
C. Nowzari, V. M. Preciado, and G. J. Pappas. Analysis and control of epidemics: A survey of spreading processes on
complex networks. IEEE Control Systems Magazine, 36(1):26–46, 2016.
William V. Padula. Why Only Test Symptomatic Patients? Consider Random Screening for COVID-19. Applied Health
Economics and Health Policy, 18(3):333–334, June 2020. ISSN 1175-5652, 1179-1896. doi:10.1007/s40258-020-005794. URL http://link.springer.com/10.1007/s40258-020-00579-4.
Facundo Piguillem and Liyan Shi. The Optimal COVID-19 Quarantine and Testing Policies. page 32.
Navid Azizan Ruhi and Babak Hassibi. SIRS epidemics on complex networks: Concurrence of exact Markov
chain and approximated models.
In 2015 54th IEEE Conference on Decision and Control (CDC), pages
2919–2926, Osaka, December 2015. IEEE. ISBN 978-1-4799-7886-1. doi:10.1109/CDC.2015.7402660. URL
http://ieeexplore.ieee.org/document/7402660/.
Marcel Salath, Christian L. Althaus, Richard Neher, Silvia Stringhini, Emma Hodcroft, Jacques Fellay, Marcel Zwahlen,
Gabriela Senti, Manuel Battegay, Annelies Wilder-Smith, Isabella Eckerle, Matthias Egger, and Nicola Low. COVID-19
epidemic in Switzerland: on the importance of testing, contact tracing and isolation. Swiss Medical Weekly, March 2020.
ISSN 1424-3997. doi:10.4414/smw.2020.20225. URL https://doi.emh.ch/smw.2020.20225.
Ling Shi, Peng Cheng, and Jiming Chen. Optimal periodic sensor scheduling with limited resources. IEEE Transactions on
Automatic Control, 56(9):2190–2195, 2011.
Eunha Shim, Amna Tariq, Wongyeong Choi, Yiseul Lee, and Gerardo Chowell.
Transmission potential and severity of COVID-19 in South Korea.
International Journal of Infectious Diseases, 93:339–344, April 2020.
ISSN 12019712.
doi:10.1016/j.ijid.2020.03.031.
URL
https://linkinghub.elsevier.com/retrieve/pii/S1201971220301508.
Cécile Souty and Pierre-Yves Boëlle.
Improving incidence estimation in practice-based sentinel surveillance networks using spatial variation in general practitioner density.
BMC Medical Research Method-

21

ology, 16(1):156, December 2016.
ISSN 1471-2288.
doi:10.1186/s12874-016-0260-x.
URL
http://bmcmedresmethodol.biomedcentral.com/articles/10.1186/s12874-016-0260-x.
Eugenio Valdano, Luca Ferreri, Chiara Poletto, and Vittoria Colizza. Analytical computation of the epidemic threshold on
temporal networks. Physical Review X, 5(2):021005, 2015.
Michael P Vitus, Wei Zhang, Alessandro Abate, Jianghai Hu, and Claire J Tomlin. On efficient sensor scheduling for linear
dynamical systems. Automatica, 48(10):2482–2493, 2012.
C. Jason Wang, Chun Y. Ng, and Robert H. Brook. Response to COVID-19 in Taiwan: Big Data Analytics, New Technology, and Proactive Testing. JAMA, 323(14):1341, April 2020. ISSN 0098-7484. doi:10.1001/jama.2020.3151. URL
https://jamanetwork.com/journals/jama/fullarticle/2762689.
Yikai Wang. An Analytical SIR model of Epidemics and A Sustainable Suppression Policy: Testing. SSRN Electronic Journal, 2020. ISSN 1556-5068. doi:10.2139/ssrn.3573979. URL https://www.ssrn.com/abstract=3573979.
Duncan J Watts and Steven H Strogatz. Collective dynamics of ‘small-world’networks. nature, 393(6684):440–442, 1998.
S. Hoya White, A. Martı́n del Rey, and G. Rodrı́guez Sánchez. Modeling epidemics using cellular automata. Applied
Mathematics and Computation, 186(1):193–202, March 2007. ISSN 00963003. doi:10.1016/j.amc.2006.06.126. URL
https://linkinghub.elsevier.com/retrieve/pii/S0096300306009295.
WHO World Health Organization. Advice on the use of point-of-care immunodiagnostic tests for covid-19. Technical
documents, April 2020a.
WHO World Health Organization. Contact tracing in the context of covid-19. Publications, May 2020b. URL
https://www.who.int/publications/i/item/contact-tracing-in-the-context-of-covid-19.
K. Zhu and L. Ying. Information source detection in the sir model: A sample-path-based approach. IEEE/ACM Transactions
on Networking, 24(1):408–421, 2016.
Kai Zhu and Lei Ying.
A robust information source estimator with sparse observations.
Computational Social Networks, 1(1):3, October 2014.
ISSN 2197-4314.
doi:10.1186/s40649-014-0003-2.
URL
https://doi.org/10.1186/s40649-014-0003-2.

