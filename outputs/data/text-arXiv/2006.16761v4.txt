I NDIVIDUAL - LEVEL M ODELING OF COVID-19 E PIDEMIC R ISK

arXiv:2006.16761v4 [stat.AP] 21 Aug 2020

Andres Colubri
Broad Institute of MIT and Harvard
Cambridge, MA 02142, USA
andres@broadinstitute.org

Kailash Yadav
Elucidata
New Delhi, Delhi 110049, India
kailash.yadav@elucidata.io

Abhishek Jha
Elucidata
Cambridge, MA 02139, USA
abhishek.jha@elucidata.io

Pardis Sabeti
Broad Institute of MIT and Harvard
Cambridge, MA 02142, USA
pardis@broadinstitute.org

August 24, 2020

A BSTRACT
The ongoing COVID-19 pandemic calls for a multi-faceted public health response comprising
complementary interventions to control the spread of the disease while vaccines and therapies are
developed. Many of these interventions need to be informed by epidemic risk predictions given
available data, including symptoms, contact patterns, and environmental factors. Here we propose a
novel probabilistic formalism based on Individual-Level Models (ILMs) that offers rigorous formulas
for the probability of infection of individuals, which can be parameterised via Maximum Likelihood
Estimation (MLE) applied on compartmental models defined at the population level. We describe an
approach where individual data collected in real-time is integrated with overall case counts to update
the a predictor of the susceptibility of infection as a function of individual risk factors.

1

Introduction

The COVID-19 Pandemic [1, 2] has emerged as the most serious health crisis that humanity has faced since the 1918
Influenza Pandemic [3]. Its causal pathogen, SARS-CoV-2 [4], is a coronavirus new to the human population with unique
molecular [5], physiopathological [6], and epidemiological [7] features. This has resulted in the exponential spread of
COVID-19 around the world, with over 22 million confirmed cases and nearly 800,000 deaths worldwide as reported by
the COVID-19 interactive web dashboard from John Hopkins University (https://coronavirus.jhu.edu/map.html), at the
time of this writing [8].
As part of the public interventions that aim to reduce the transmission of COVID-19, precautionary self-isolation of
the general population and quarantining of suspected and confirmed mild cases is a strategy that can substantially
reduce the effective reproductive number of the disease, Re [9]. This has the important consequence of "flattening the
epidemic curve" until herd immunity is achieved, either by infection or vaccination, and therefore avoid overwhelming
the health care system [10]. Active monitoring of contacts via traditional contact tracing by health care workers [11],
potentially complemented and expanded with proximity-sensing tracking mobile apps [12], could further help mitigate
transmission [13].
In all these interventions, the spatio-temporal modeling of the disease is critical to understand risk factors associated
with transmission and, through this, adjust the magnitude and timing of the interventions in order to maximize their
change of success. In particular, predicting the epidemic risk of individuals to contract the disease over space and
time can help to identify subpopulations under increased risk and to inform interventions such as quarantine. Most
importantly, being able to promptly identify who, in a system, is at risk of infection during an outbreak is key to
the efficient control of the epidemic. However, developing such models is challenging in a situation like the current
pandemic, due to the uncertainty in the epidemiological parameters of a novel pathogen and also to the urgency with
which interventions and tools are needed.

In this paper, we adopt a individual-level model (ILM) framework that enable us to express the probability of a
susceptible individual being infected as a function of their interactions with the surrounding infectious population while
also allowing to incorporate the effect of individually-varying risk factors (e.g., age, pre-existing conditions). ILMs are
intuitive and flexible due to be expressed in terms of individual interactions [14–16] but also computationally costly to
parameterise, especially in the case of epidemics in large populations. More recent work has shown how to simplify the
likelihood calculations to make ILMs more readily applicable in real-life scenarios [17], and also how geographical
covariates can be incorporated [18] in order to represent spatial distribution of infection risk over time and model public
health interventions that take into account geographical variation.
We first apply the formalism for ILMs to derive an expression for the marginal probability of individual risk of infection
as a function of parameters with straightforward epidemiological interpretation and initial estimation. We incorporate
symptom and other individual-level data to update the risk of infection based on this new information. We then
construct a population-level compartmental SIR epidemic model, where the rate of infection can be estimated from
the individual-level probabilities given a random sample of individuals front he population. This allows to express
the population-level parameters as a function of the individual-level parameters, and to use partially observed data
(overall case counts, and individual risk factors and contacts) to apply Maximum Likelihood Estimate (MLE) within a
Partially Observed Markov Process (POMP) framework. The POMP framework enables us to solve a computationally
more tractable MLE problem thanks to iterated filtering, an efficient computational method that’s based on a sequence
of filtering operations which are shown to converge to a maximum likelihood parameter estimate. As result of this
approach, we arrive to estimates of individual-level parameters that can be used to predict risk of infection.
The structure of this article is as follows. In Section 2, the formula for individual epidemic risk is derived and applied to
evaluate conditional probability on infection given additional individual-level data and the overall likelihood function.
In Section 3, the iterated filtering MLE is presented to fit the model parameters. Section 4, applies the iterated filtering
MLE algorithm on simulated data generated with an agent-based model (ABM). We conclude the article with a
discussion in Section 5.

2
2.1

Model Formalism
Individual-level Models

We adopt the general ILM formalism described by Deardon et al [17]. In these models, each individual at each time t
can be in one of three states: susceptible, infected, or recovered, denoted S(t), I(t), or R(t) respectively. Furthermore,
time is discretized so that t represents a time interval [t, t + 1). The probability of a susceptible individual i being
infected at time t is expressed as follows:
P (i, t) = 1 − exp



− ΩS (i)

X



ΩT (j)κ(i, j, t) − (i, t)

(1)

j∈C(i,t)

In this expression, the set of infectious individuals who interacted with susceptible i in the time interval [t, t + 1) is
denoted as C(i, t). Following the notation in [17], the risk factors of a susceptible individual i becoming infected,
and an infected individual j transmitting the disease are represented by the functions ΩS (i) and ΩT (j), respectively.
The time-dependent infection kernel, κ(i, j, t), incorporates pairwise risk factors, such as the occurrence and duration
of contacts between i and j. The "sparks" term, (i, t), can be used to represent other sources of infection, such as
zoonotic introductions at a given rate.
This formula is the result of assuming a Poisson infectious process in each time interval [t, t + 1). We count the number
−λ k
k of transmission events between susceptible i and infected j, which follow a Poisson distribution f (k) = e k!λ
with λ the rate of transmission. Non-infection from j corresponds to k = 0, so then f (k = 0) = e−λ . The rate of
transmission from j to i is modeled as the product form λi,j = ΩS (i)ΩT (j)κ(i, j). Non-infection of i from all infected
j follows from independence between these Poisson processes, therefore (ignoring the sparks term):
Q
1 − P (i, t) = e−λi,j
j

Formally, the ILMs can be extended to incorporate the effect of spatial-dependent risk factors upon the transmission of
infectious disease. The resulting GD-ILMs have the general form [18]:
P (i, k, t) = 1 − exp



− ΩS (i, k)

X
j∈C(i,t)

2



ΩT (j, k)κ(i, j, t) − (i, k, t)

(2)

where each function is now a function of an area index k ranging over the geographical subdivisions under consideration.
However, in the context of this manuscript we will only consider simple ILM without explicit geographical dependencies.
2.2

Model Covariates

The functions introduced in the previous section, ΩS (i) and ΩT (j) are general and can incorporate covariates that
determine susceptibility and transmissibility risks through various functional dependencies. We can start by considering
a linear form:
ΩS (i) = a0 + a1 X1 (i) + ... + aN XN (i)

(3)

where a0 > 0 is a constant susceptibility parameter, and Xn (i) are covariates that represent various susceptibility
factors to be included in the model (e.g.: age, pre-existing conditions, etc.) Thus, an is the parameter for the n-th
individual-level covariate.
The transmisibility function has a similar general form:
ΩT (j) = b0 + b1 Y1 (j) + ... + bM YM (i)

(4)

where b0 > 0 is a constant transmisibility parameter, Ym (i) and bm the transmisibility covariates and their corresponding
coefficients.
The infection kernel is a function of the varying distance between i and j over the course of the time interval [t, t + 1)
κ(i, j, t) = F ({di,j (τ ), τ ∈ [t, t + 1)})

(5)

The next sections will provide specific details on these factors and concrete assumptions motivated by what is known
about COVID-19.
2.3

Model Simplifications

The general forms of the ΩS (i) and ΩT (i) functions described above allow us to incorporate an arbitrary number of
covariates into the model. Here we propose a very simple initial model. The susceptibility function will depend only on
"immunity status" of the susceptible individual. We define the variable X1 (i) to be 1 if individual i is over 65 or is
immunosuppressed due to some pre-existing condition, 0 otherwise. Therefore:
ΩS (i) = a0 + a1 X1 (i)

(6)

For the transmissibility function, an important factor determining the potential for an infected individual to pass along
the virus seems to be the presence or absence of symptoms. So in this case the binary covariate Y1 (j) takes the values 0
or 1 whether the infected individual is aymptomatic/pre-symptomatic or symptomatic, respectively. So we arrive to the
following simplified form:
ΩT (j) = b0 + b1 Y1 (j)

(7)

As for the the infection kernel, for the time being is just 1 when j is in C(i, t), the contact set of i, which includes all
the infectious individuals whim whom i was closer than 2 meters for at least 15 minutes in [t, t + 1), and 0 otherwise:

κ(i, j) =

1
0

j ∈ C(i, t)
otherwise

(8)

Finally, we will adopt a zero sparks term. This assumption is reasonable is transmission mainly due to interactions
between individuals, and not through the environment (e.g.: contaminated surfaces or fomites). There is some anecdotal
evidence that this might be the case in COVID-19 [12], but for the time being we just assume (i, t) = 0 to keep the
models simple.
3

With these modeling decisions we reach the following expression for the individual probability of infection:
 

X 
P (i, t) = 1 − exp − a0 + a1 X1 (i)]
b0 + b1 Y1 (j))]

(9)

j∈C(i,t)

2.4

Conditioning on Additional Data

Formula (9) gives an expression of the marginal probability P (i, t) of infection of individual i in time interval [t, t + 1).
This probability depends on a number of individual-level and area-level covariates. However, additional data from
the individual i can be used to arrive to an updated risk of infection. In particular, we are interested in the probability
of infection over the course of the past d days given this new data, P (I[t−d,t] |D), with d defining an appropriate
retrospective window of possible infection. Given that the incubation period of COVID-19 is two weeks, then d = 14
should be a suitable choice to inform quarantining/testing measures. Applying Bayes Theorem to this probability, we
can formally write:
P (I[t−d,t] |D) =

P (D|I[t−d,t] )P (I[t−d,t] )
P (D)

The probability of an infection over the course of the past d days can be expressed as a function of the per-day
probabilities of infection:
P (I[t−d,t] ) = P (It−d ) + P (It−d+1 ) + ... + P (It )
since each event (infection d days ago, d − 1 days ago, and so on) is independent from each other. Furthermore,
infection n day ago implies that infection did not happen until exactly that day, and so:
d−n−1
Q 


1 − P (t − d + l) P (t − n)

P (It−n ) =

l=0

where P (t0 ) is precisely (9), with indices for individual i omitted for clarity.
More concretely, if D comprises symptom data self-reported by individual i, or Si , we can then write the risk of
infection over the past d days for individual i at time t given symptom data Si :

R(i, t) = rs

d d−n−1
X
Y 

1 − P (i, t − d + l) P (i, t − n)
n=0

(10)

l=0

with the coefficient rs defined as:
rs =

P (Si |I[t−d,t] )
P (Si )

(11)

This coefficient can be thought of the ratio of the observed symptoms given the fact that the individual was recently
infected to the prevalence of those symptoms among the general population, which in general should be greater than
1. For instance, if the observed symptoms are cough and fever, then rs is a measure of how much prevalent those
symptoms are among people infected with COVID-19, and could be estimated from currently available data. In fact, a
recent study [19] looked at the predictive power of symptoms self-reported in the US and UK with the COVID Symptom
Study mobile app [20]. This study presents a logistic regression predictor of infection given a number of symptom
predictors:
ln[p/(1 − p)] = 1.32 − 0.01 × age + 0.44 × sex + 1.75 × smell and taste loss+
0.31 × cough + 0.49 × fatigue + 0.39 × skipped meals

(12)

Where p = P (I|S). We make the assumption that, for a sufficiently long period of time d, the conditional probability
P (S|I[t−d,t] ) is simply P (S|I), where I represents infection at some moment in the past. With this assumption in
place, we can connect the COVID Symptom Study prediction model with out probabilistic formalist by means of:
P (S|I)
P (I|S)
=
= rs
P (S)
P (I)
4

(13)

where P (I) would represent the overall prevalence of COVID-19 infection. This allows us to write the following final
formula for the risk score:

R(i, t) =

d n−1

P (I|Si ) X Y 
1 − P (i, t − d + l) P (i, t − d + n)
P (I) n=0

(14)

l=0

Given knowledge of the individual’s symptoms, demographic and medical covariates, and their recent contact history, it
would be then possible to calculate this risk of infection.

3

Maximum likelihood in POMPs

Following [17], given the S(t), E(t), I(t), and R(t) counts of susceptible, exposed, infected, and recovered individuals,
respectively, at time t, we can write the likelihood function as function of the parameter vector θ = (a0 , a1 , b0 , b1 ) as
the individual probabilities of infection as follows:
L(θ|S, E, I, R) = P (S, E, I, R|θ) =

Y

ft (S(t), E(t), I(t), R(t)|θ)

(15)

t

where S = {S(t)}t , E = {E(t)}t , I = {I(t)}t , R = {R(t)}t , and the joint probability of all new infections occurring
in time interval [t, t+1):
ft (S(t), E(t), I(t), R(t)|θ) =

h

ih
P (i, t)

Y
i∈E(t+1)−E(t)

Y

(1 − P (i, t))

i

(16)

i∈S(t+1)

MLE via Metropolis-Hastings MCMC requires the recalculation of L(θ|S, E, I, R) a very large number of times,
with varying θ, in order to maximize the likelihood. In each recalculation of the likelihood, the products over all the
individuals i have to be evaluated, which can become prohibitive even for relatively small populations.
An alternative MLE approach integrates compartmental models with Partially Observed Markov Process (POMP)
models [21]. Compartmental models simplify the mathematical modeling of infectious disease; however, they assume
access to fully observed disease data. In reality, not all COVID-19 cases are reported, and there are several reports of
infectious asymptomatic/pre-symptomatic carriers [22], with some studies [23] suggesting at least 30% of asymptomatic
cases. POMP models allow us to address such limitations by combining the simplicity of compartmental models with a
probabilistic framework for the unobserved data.
∗
POMP models represent data y1∗ , ..., yN
collected at times t1 < ... < tN as noisy, incomplete observations of an
unobserved Markov process X(t), t ≥ t0 . Disease transmission, represented by compartmental models, is a Markov
process because the number of infectious people at time t is solely determined by the number of infectious people
at time t − δ. A POMP model is characterized by the transition density and measurement density of its stochastic
processes. The one-step transition density is represented by fXn |Xn−1 (xn |xn−1 ; θ), since X(t) is Markovian and only
relies on the previous state. Meanwhile, the measurement density depends on only the state of the Markov process at
that time and so is represented by fYn |Xn (yn |xn ; θ), where Yn is a random variable modeling the observation at time
tn . Hence, the entire joint density for a POMP model, including the initial density fX0 (x0 ; θ), is:

fX0:N Y1:N (x0:N , y1:N ; θ) = fX0 (x0 ; θ)

N
Q

fXn |Xn−1 (xn |xn−1 ; θ)fYn |Xn (yn |xn ; θ)

n=1
∗
and the marginal density for the sequence of measurements, Y1:N , evaluated at the data, y1:N
, is
R
fY1:N (y( 1 : N )∗ ; θ) = fX0:N Y1:N (x0:N , y1:N ; θ) dx0:N

Here the state variable Xt is the vector (S(t), E(t), I(r), R(t)) described before. Our novel approach here will be to
relate the population-level parameters in a SEIR model for COVID-19 [9] with average estimations calculated over a
suitable sample of individuals, which will be expressed in terms of the individual-level probabilities defined by equation
(9) and, ultimately, as a function of the individual-level parameters Θ = (a0 , a1 , b0 , b1 , ). In this way, our method can
be seen a form of hierarchical maximum likelihood where estimation of individual-level is performed simultaneously
with the population-level parameters [24], which has the advantage of reducing variability in the recovered parameters
[25].
5

3.1

SEIR model setup

We constructed the two components of a POMP model: the unobserved process model and the measurement model.
The process model, defined as a SEIR model, provides the change in true incidence of COVID at every time point,
while the measurement model incorporates the fact that not all cases are observed or reported.
The underlying dynamics of COVID can be captured by a stochastic SEIR model. Most of the assumptions of a basic
SEIR model are still the same in a stochastic version. However, we add parameters that induce random fluctuations
into the population and change the compartments’ rates of transfer in response to interventions. We do this by using
probabilistic densities for the transition of state variables. Moreover, although disease dynamics are technically a
continuous Markov process, this is computationally complex and inefficient to model, and so we make discretized
approximations by updating the state variables after a time step, δ. The system of discretized equations is shown below,
where B(t) is the number of susceptible individuals who become exposed to COVID, C(t) is the number of newly
infectious cases, and D(t) is the number of cases that are removed from the population, all during the time step δ:
S(t + δ) = S(t) − B(t)
E(t + δ) = E(t) + B(t) − C(t)
I(t + δ) = I(t) + C(t) − D(t)
R(t + δ) = R(t) + D(t)
S(t) + E(t) + I(t) + R(t) = N

(17)

This equation describes how the sizes of the four compartments (susceptible, exposed, infectious, and removed) change
between (t, t + δ). The model further assumes that the population size N remains constant at every time point. We
added inherent randomness to our model by setting B(t), C(t), and D(t) as binomials. If we assume that the length of
time an individual spends in a compartment is exponentially distributed with some compartment-specific rate x(t), then
the probability of remaining in that compartment for an additional day is exp(−x(t)) and the probability of leaving that
compartment is 1 − exp(−x(t)):
B(t) ∼ Binomial(S(t), 1 − exp(−λ(t)))
C(t) ∼ Binomial(E(t), 1 − exp(−σ))
D(t) ∼ Binomial(I(t), 1 − exp(−γ))

(18)

The force of infection, λ(t), is the transition rate between the susceptible and exposed classes and can be written as
λ(t) = β(t) I(t)
N , where β(t) represents the transmission rate of the disease. Furthermore, σ is the transition rate between
the exposed and infectious classes, and γ is the transition rate between the infectious and removed compartments. σ −1
represents the mean length of time a person stays in the latent stage and γ −1 represents the mean length of time a person
is infectious before being removed from the population (either because of intervention efforts or natural recovery). We
assume these two parameters to be constant over the course of the epidemic.
The transmission rate β(t) can be estimated from sample averages calculated over individuals. If we recall the ILM
formalism from the previous section, we can write the probability of infection of susceptible i by infected contact j as
follows:
 


pi,j = 1 − exp − a0 + a1 Xi ] b0 + b1 Yj ]

(19)

Therefore, the transmission rate for individual j is the sum of these probabilities over all the contacts:
βj =

X

 


1 − exp − a0 + a1 X1 (i)] b0 + b1 Y1 (j)]

(20)

i∈C(j)

If we are considering infected individuals from a random sample J we can then estimate the transmission rate as:
β̂ =

 


1 X X
1 − exp − a0 + a1 X1 (i)] b0 + b1 Y1 (j)]
|J|
j∈J i∈C(j)

6

(21)

Given a fixed sample J, we can consider β̂ = β̂(a0 , a1 , b0 , b1 ), that is, a function solely of the individual-level
susceptibility and transmissibility coefficients.
Although it is impossible to directly record the number of people that are susceptible, exposed, infectious, and removed
directly, the publicly available data tells us the number of observed cases per day. The mean number of observed cases
per day is the true number of cases multiplied by the reporting rate ρ (ρ < 1). This can be modeled with a binonial
distribution of parameters C(t) and ρ:
yt |C(t) ∼ Binomial(C(t), ρ)

(22)

The process and measurement models define our final POMP model. For each time point, the process model generates
the number of new cases based on binomial distributed counts. The measurement model then estimates the observed
number of cases based on the true number of cases and reporting rate.
3.2

Iterated filtering method

The likelihood function for the POMP models is the density function evaluated with data at a candidate set of parameter
values. It is computationally simpler to work with the log likelihood, l(θ) = log f (y1:N ; θ), so that we can deal with
sums instead of products. We used a simulation-based approach to avoid solving the density function analytically, in
which we simulated the random variable Y1:N , which implicitly defines the density function. Likelihood evaluation
via Sequential Monte Carlo (SMC) techniques is one standard method to obtain the log likelihood for POMP models,
because it simulates sample paths rather than requiring explicit transition probabilities. Exploiting the Markov property
of the process, it is possible to use these paths to sample the parameter space much more efficiently than with regular
MCMC, thanks to the iterated filtering method.
We factorized the likelihood as the product of conditional likelihoods:

L(θ) =

N
Y

Ln|1:n−1 (θ)

(23)

n=1
∗
where Ln|1:n−1 (θ) = P [yn∗ |y1:n−1
; θ] and there are N time points. The structure of a POMP model then implies the
representation of Ln|1:n−1 (θ) as

Z
Ln|1:n−1 (θ) =

∗
P [yn∗ |xn ; θ]P [xn |y1:n−1
; θ] dxn

(24)

so that the final expression for the likelihood is:
N Z
Y

∗
P [yn∗ |xn ; θ]P [xn |y1:n−1
; θ] dxn

(25)

n=1
∗
In this last equation, although P [yn∗ |xn ; θ] is simple to calculate (using the observation process), P [xn |y1:n−1
; θ] is
more difficult to evaluate. We can use the Markov property to determine an expression for this probability, known as the
prediction formula:

∗
P [xn |y1:n−1
; θ]

Z
=

∗
P [xn |xn−1 ; θ]P [xn−1 |y1:n−1
; θ] dxn−1

(26)

∗
We can then use Bayes’ Theorem to determine an expression for P [xn−1 |y1:n−1
; θ], known as the filtering formula:

∗
∗
P [xn |y1:n
; θ] = P [xn |yn∗ , y1:n−1
; θ] = R

∗
P [yn∗ |xn ; θ]P [xn |y1:n−1
; θ]
∗
∗
P [yn |xn ; θ]P [xn |y1:n−1 ; θ] dxn

(27)

The prediction and filtering formulas give us a recursion. Specifically, the prediction formula calculates the pre∗
diction distribution at time tn , f( Xn |Y1:n−1 )(xn |y1:n−1
), at time tn by using the filtering distribution at time tn−1 ,
∗
f( Xn−1 |Y1:n−1 )(xn−1 |y1:n−1 ),at time tn−1 . Meanwhile, the filtering formula gives us the filtering distribution at time
tn using the prediction distribution at time tn .
7

In SMC, we use Monte Carlo techniques to sequentially estimate the integrals in the prediction and filtering recursions,
∗
which in turn allows us to estimate P [xn |y1:n−1
; θ]. This is done by generating a swarm of J particles that are
propagated forward based on the process model and then filtered and altered to fit the next data point more closely.
Because of this, SMC is commonly known as the particle filter.
Iterated filtering [26] allows to more efficiently obtain MLEs of parameters in partially observed dynamical systems,
such as POMPs. It works by defining a set of initial values for the parameter vector θ and a fixed number of iterations,
M . For every iteration, we apply a basic particle filter (Equation 9 above) to the model and add stochastic perturbations
to the parameters so that they take a random walk through time. At the end of the time series, we use the final value of
the parameters as the starting point for the next iteration but reducing (“cooling”) the random walk variance. After
completing the M iterations, we obtain the Monte Carlo maximum likelihood estimate, θM , and its corresponding log
likelihood. In contrast, Monte Carlo likelihood by direct simulation scales poorly with dimension. It requires a Monte
Carlo effort that scales exponentially with the length of the time series, and so is infeasible on anything but a short data
set.

4
4.1

Simulation study
Parameter estimation

Millions of individuals worldwide have self-reported symptoms associated with COVID-19 infection through numerous
websites and apps specifically designed for that purpose [19]. Meanwhile, anonymized mobility data generated by
cellphones has been aggregated from several sources and made available for research [27]. However, this currently
available data is not enough to evaluate the ILMs described above. These models can potentially provide infection
risk predictions aggregating several sources of health and epidemiological data from individuals, including symptoms,
demographics, and contact information. Approaches incorporating this kind of data, collected through contact tracing
and symptom reporting apps, have been proposed recently by several groups [28, 29], and have lead to consider the
privacy risks presented by this data and possible mitigation of those risks. Here, we are focusing primarily on the
parameter estimation problem, assuming that it is possible to acquire the data securely, but will make some observations
regarding privacy in the conclusions.
Since the detailed data needed to calculate our ILMs is not currently available, we have started by conducting a purely
computational study where the individual-level data is generated by means of agent-based models (ABMs). These
models allow us to simulate behaviours of individuals in a large population, and obtain data that mirrors what we could
collect with contact tracing and symptom reporting apps in real life. One advantage of using ABMs at this stage is
that we can define the ground truth of the ILM by specifying the coefficients in the susceptibility and transmissibiliy
functions, this allow us to evaluate the accuracy of our parameter estimation methods.
For the purpose of running the ABMs simulations, we used the COMOKIT COVID-19 SEIR model [30] implemented
in the GAMA software [31], a general ABM simulator allowing for a wide range of options through a custom modeling
language and supporting GIS layers to represent specific geographical in detail. In particular, we run simulations
using a scenario of a COVID-19 outbreak in Vietnam without any containment strategies, with a population of nearly
10,000 individuals. We adapted the SEIR model provided in COMOKIT to incorporate the individual probabilities
of infection as defined by Formula (9), with a number of different selections of parameters θ = (a0 , a1 , b0 , b1 ).
We arbitrarily defined three sets of ground truth parameters, θ1 = (a0 = 0.2, a1 = 2.0, b0 = 0.2, b1 = 2.0),
θ2 = (a0 = 0.5, a1 = 1.5, b0 = 0.5, b1 = 0.8), and θ3 = (a0 = 1.0, a1 = 2.0, b0 = 1.0, b1 = 1.0). Given the
symmetric form of (9), we expanded the product of the transmissibility and susceptibility functions to arrive to the
following reparametrization:

β̂ =

 

1 X X
1 − exp − c00 + c01 Y1 (j) + c10 X1 (i) + c11 X1 (i)Y1 (j)]
|J|

(28)

j∈J i∈C(j)

The relationship between the original and new parameters is given by:
a0 b0
a0 b1
a1 b0
a1 b1

= c00
= c01
= c10
= c11
8

(29)

Figure 1: Result of MLE with POMP on synthetic data generated with GAMA: (A) Curve of new infected cases over
time. (B) Scatterplot matrix showing all the initial points (gray) and final (red) points in parameter space from the MLE
runs. (C) GAMA curve (blue) and 9 simulated curves (red) generated with the MLE parameters. (D) Range covered
between the 5 and 95 percentiles from 100 simulated curves using the MLE parameters.
from which we can express the ratios a0 /a1 and b0 /b1 as a function of the new parameters c00 , c01 , c10 , and c11 :
a0
c01
c00
=
=
a1
c11
c10
b0
c00
c10
=
=
b1
c01
c11

(30)

We assume the mean latent and infectious times to be known, and we can estimate them from the GAMA data. In the
case of the COMOKIT simulations, have σ = 0.26 and γ = 0.6, both in units of 1/day. Therefore, the only parameters
in the SEIR model at the population level are c00 , c01 , c10 , and c11 , which we estimate by applying iterated filtering
with POMP. An MLE run corresponding to the the underlying parameters θ1 is shown in figure 1.
An issue we encountered with the first round of MLE runs is that, as the ABM simulation progressed, the compartment
of susceptible individuals gets depleted as more become infected, and so the β̂ estimator becomes increasingly biased.
In order to account for this problem, we fit the GAMA data only for the initial stages of the simulated epidemic, when
9

Figure 2: Range of synthetic epidemic data used to fit the parameters. (A) GAMA curve (blue) and 9 simulated curves
(red) generated with the resulting MLE parameters. (B) Range covered between the 5 and 95 percentiles from 100
simulated curves using the MLE parameters.

Table 1: Maximum likelihood estimates for all the parameter sets

c00
c01
c10
c11

True value
0.04
0.40
0.40
4.00

c00
c01
c10
c11

True value
0.25
0.40
0.75
1.20

c00
c01
c10
c11

True value
1.0
1.0
2.0
2.0

Set 1
MLE mean
0.063
0.839
0.603
5.452
Set 2
MLE mean
0.629
0.347
1.690
1.438
Set 3
MLE mean
0.381
1.409
2.088
2.113

MLE sdev
0.036
0.411
0.346
1.825
MLE sdev
0.216
0.384
0.538
0.667
MLE sdev
0.120
0.322
0.901
1.218

the number of new infectious cases is still increasing due to the large percentage of susceptible individuals. The range
of the data with enough susceptibles is shown in figure 2.
The ground truth values for the c00 , c01 , c10 , and c11 parameters, and the mean and standard deviation over the 10
highest likelihoods are listed in table 1. Most of the true values fall within a standard deviation from the mean MLE, as
seen in 3, with the exception of c00 in the parameter set 3.
In order to recover the original parameters a0 , a1 , b0 , and b1 that are needed in the susceptibility and transmisibility
functions, we can use the ratios in equation 30. An initial calculation simply taking the top estimates of the cij ’s to
calculate the mean and standard deviation of the a’s and b’s gave values with high errors when compared with the true
10

Figure 3: Plots representing the standard deviation of the top 10 MLEs for each parameter as an error bar. The red
circle indicates the true value of the parameter. All values are scaled to the mean MLE for each parameter.
Table 2: Approximation to the original parameter ratios using MLEs

a0 /a1
b0 /b1
a0 /a1
b0 /b1
a0 /a1
b0 /b1

Set 1
MLE approx.
0.13
0.09
Set 2
True ratio MLE approx.
0.33
0.31
0.62
1.50
Set 3
True ratio MLE approx.
0.5
0.42
1.0
0.63
True ratio
0.10
0.10

rations, which seems to be caused by fluctuations in the cij ’s. A better approximation to the ratios is given by this
heuristic formula:
a0
M LE(c01 )
M LE(c00 )
= 0.5
+ 0.5
a1
M LE(c11 )
M LE(c10 )
b0
M LE(c10 )
M LE(c00 )
= 0.5
+ 0.5
b1
M LE(c11 )
M LE(c01 )

(31)

where M LE(cij ) represents the mean of the parameter cij taken over the 10 top MLEs. This formula smooths out the
fluctuations in the individual parameters, and gives a better result, shown in table 2.
4.2

Risk calculation

Once the parameters of the model have been determined through MLE using POMP, in particular the individual-level
coefficients (c00 , c01 , c10 , c11 ), we can compute individual risks of infection using equation (14). We use the ABM in
GAMA with the three parameter sets and a random assignment of symptoms for susceptible and infected individuals
11

Table 3: Mean and standard deviation of individual risks for susceptible (RS ) and infected individuals (RI )
Set 1
Set 2
Set 3

RS
0.24±0.25
0.28±0.24
0.55±0.31

RI
0.52±0.34
0.45±0.32
0.63±0.31

Table 4: Performance measures for the infection predictor based on equation (14), calculated on the 3 parameters sets
considered in the paper
Set 1
Set 2
Set 3

AUC (95% CI)
0.74 (0.73, 0.74)
0.65 (0.64, 0.66)
0.57 (0.56, 0.59)

Accuracy
0.65
0.62
0.76

Sensitivity
0.78
0.83
0.81

Specificity
0.53
0.29
0.28

using the symptom prevalence for the US listed in [19]. Instead of using the ground truth individual-level parameters,
we generate random perturbation of a0 and b0 , and then obtained a1 and b1 with the ratio estimates in (31).
As a fist sanity check, we calculated the mean risk for susceptible and infected individuals over entire simulation
parameter runs with each parameter set, and we obtained the results shown in table 3. Difference between the risks
for susceptible and infected is very small for parameter set 3, and the reason for this is that this set yields higher
probabilities of infection across all individuals, resulting in more uniform risk score values. We then make predictions
of infected status for all agents in each simulation based on their risk, using the mean infected risk minus the standard
deviation, as listed in 3, to calculate the threshold to predict infection.
The area under the receiver characteristic curve (AUC), the 95% confidence interval (CI) for the AUC values, sensitivity,
specificity, and overall accuracy of the infection prediction for each parameter set are listed in 4. The corresponding
receiver characteristic curves are plotted in 4. We can see how the predictions fare for each parameter set, and set 1
has the highest AUC and best balance of sensitivity and specificity. Even though set 2 and 3 exhibit higher sensitivity,
their specificity is fairly low, meaning that in those parameter sets, the risk predictor results in many false positives. In
terms of using the risk to decide when to quarantine agents, a high false positive rate (agents that are not infected get
needlessly quarantined) is arguably better than a high false negative rate (infected agents are not quarantines and go on
to transmit the pathogen).
Finally, we run ABM simulations where the risk values where used to quarantine for 14 days those individuals with
a risk higher than a given threshold. We simulated two scenarios, in the first scenario, there was a delay of 4 days
between the risk calculation and its use to determine quarantine, in order to model the fact that the infectious status of
contacts is not determined instantaneously, but with a lag caused by the symptom onset time (and also by the delay
in obtaining test results). In the second scenario, the risk was updated instantly with the information of the infected
contacts, this represents an unrealistic situation where infectious status is known upon interaction but gives an upper
bound for the performance of the intervention. The results form these simulations are shown in figure 5. The epidemic
curves of new cases for the three scenarios (no quarantine, delayed quarantine, and instant quarantine) suggest that
risk-based quarantine could help in lowering the peak of new cases and spread them over a longer period of time (e.g.:
"flattening the curve"), with the most pronounced effect in the case of instantaneous availability of infection status,
which is impossible in practice but providing a "maximum curve flattening".

5

Conclusions

We constructed an statistical inference framework that allows to obtain individual-level epidemic parameters by applying
MLE to population-level case data. We tested this framework using an agent-based model to generate epidemic data
resolved at the individual level. As part of this framework, we defined an individual-level epidemic risk model that
depends on data such as demographics, medical condition, self-reported symptoms, and contact tracing information.
These models could be trained on aggregate data provided by consenting users of a mobile app, for example, and then
evaluated locally by the rest of the users. These models could also incorporate additional data, such as spacial random
effects. The initial simulation experiments are promising and suggest that is possible to: (1) obtain good estimates
for the individual-level parameters by applying MLE on the population level data, (2) predict who is infected and
who is not using the individual-level risks, and (3) carry out interventions based on the individual-level risks, such
as quarantine, that could help in lowering the peak of the epidemic, i.e.: “flattening the curve”. However, this work
in in its initial stages and has several limitations. First of all, the individual-level models we considered so far are
very simple, including only two somewhat artificial covariates (immune and symptomatic levels). Secondly, data to
12

Figure 4: Receiver Operating Characteristic (ROC) Curve for the infection predictor based on equation (14), generated
for the 3 parameter sets considered in the paper
train the models was obtained completely from simulated experiments, thus, we need to extend to and validate on real
data. Third, our risk calculation requires knowledge on confirmed cases in order to determine exposure events, which
might not be readily available or accessible. Other approaches [28, 29] are based on estimating the probabilities of all
possible states an individual can be in (susceptible, infected, recovered) based on the available information (symptoms,
tests, contacts, etc) and then having this information be shared across the individuals through a mobile app in order to
update the probabilities as new information is obtained. Our approach has the advantage of being simpler, but could
also incorporate some of these ideas to lift the requirement of exact infectious states to be known in advance to the
calculation of the risks score. We envision the computational framework presented in this work as the basis for a system
that could be used to estimate risks of infection for diseases other than COVID-19.

6

Acknowledgments

The authors would like to thank Aaron King for discussions about the model and revision of the POMP code, Hayden
Metsky for suggestions regarding MLE, Brandon Westover for comments about method evaluation, and members of the
Machine Learning and Optimization Lab at EPFL for support and feedback.

7

Availability of code and data

All the GAMA parameters and R scripts are available under the MIT license at this repository:
https://github.com/broadinstitute/ILM-COVID19-risk, together with the simulated data used in the analysis.

References
Velavan, T. P. & Meyer, C. G. The COVID-19 epidemic. Tropical Medicine & International Health 25, 278–280
(2020).
2. Fauci, A. S., Lane, H. C. & Redfield, R. R. Covid-19 — Navigating the Uncharted. New England Journal of
Medicine 382, 1268–1269 (2020).
3. Viboud, C. & Lessler, J. The 1918 Influenza Pandemic: Looking Back, Looking Forward. American Journal of
Epidemiology 187, 2493–2497 (2018).
4. Lu, R. et al. Genomic characterisation and epidemiology of 2019 novel coronavirus: implications for virus origins
and receptor binding. The Lancet 395, 565–574 (2020).
1.

13

Figure 5: Plot of new cases for the three parameter sets (A: set 1, B: set 2, C: set 3), under three intervention scenarios:
no quarantine (blue curve), risk-based quarantine with 4 day delay (orange curve), and risk-based quarantine with
instant availability of infectious status of contacts.

14

5.
6.
7.

8.
9.

10.

11.
12.

13.

14.
15.
16.
17.
18.

19.
20.
21.
22.

23.
24.
25.

Wrapp, D. et al. Cryo-EM structure of the 2019-nCoV spike in the prefusion conformation. Science 367, 1260–
1263 (2020).
Zou, L. et al. SARS-CoV-2 Viral Load in Upper Respiratory Specimens of Infected Patients. New England Journal
of Medicine 382, 1177–1179 (2020).
Liu, Y., Gayle, A. A., Wilder-Smith, A. & Rocklöv, J. The reproductive number of COVID-19 is higher compared
to SARS coronavirus. Journal of Travel Medicine 27. doi:10.1093/jtm/taaa021. eprint: https://academic.
oup.com/jtm/article-pdf/27/2/taaa021/32902430/taaa021.pdf. <https://doi.org/10.1093/
jtm/taaa021> (2020).
Dong, E., Du, H. & Gardner, L. An interactive web-based dashboard to track COVID-19 in real time. The Lancet
Infectious Diseases 20, 533–534 (2020).
Wang, C. et al. Evolving Epidemiology and Impact of Non-pharmaceutical Interventions on the Outbreak
of Coronavirus Disease 2019 in Wuhan, China. medRxiv. doi:10 . 1101 / 2020 . 03 . 03 . 20030593. eprint:
https : / / www . medrxiv . org / content / early / 2020 / 03 / 06 / 2020 . 03 . 03 . 20030593 . full . pdf.
<https://www.medrxiv.org/content/early/2020/03/06/2020.03.03.20030593> (2020).
Kissler, S. M., Tedijanto, C., Lipsitch, M. & Grad, Y. Social distancing strategies for curbing the COVID-19
epidemic. medRxiv. doi:10.1101/2020.03.22.20041079. eprint: https://www.medrxiv.org/content/
early/2020/03/24/2020.03.22.20041079.full.pdf. <https://www.medrxiv.org/content/early/
2020/03/24/2020.03.22.20041079> (2020).
Eames, K. T. D. & Keeling, M. J. Contact tracing and disease control. Proceedings of the Royal Society of London.
Series B: Biological Sciences 270, 2565–2571 (2003).
Ferretti, L. et al. Quantifying SARS-CoV-2 transmission suggests epidemic control with digital contact tracing.
Science 368. doi:10.1126/science.abb6936. eprint: https://science.sciencemag.org/content/
early/2020/03/30/science.abb6936.full.pdf. <https://science.sciencemag.org/content/
early/2020/03/30/science.abb6936> (2020).
Peak, C. M. et al. Modeling the Comparative Impact of Individual Quarantine vs. Active Monitoring of Contacts
for the Mitigation of COVID-19. medRxiv. doi:10.1101/2020.03.05.20031088. eprint: https://www.
medrxiv . org / content / early / 2020 / 03 / 08 / 2020 . 03 . 05 . 20031088 . full . pdf. <https : / / www .
medrxiv.org/content/early/2020/03/08/2020.03.05.20031088> (2020).
Gibson, G. J. Markov Chain Monte Carlo Methods for Fitting Spatiotemporal Stochastic Models in Plant
Epidemiology. Journal of the Royal Statistical Society: Series C (Applied Statistics) 46, 215–233 (1997).
Keeling, M. J. et al. Dynamics of the 2001 UK Foot and Mouth Epidemic: Stochastic Dispersal in a Heterogeneous
Landscape. Science 294, 813–817 (2001).
Neal, P. J. & Roberts, G. O. Statistical inference and model selection for the 1861 Hagelloch measles epidemic.
Biostatistics 5, 249–261 (2004).
Deardon, R. et al. Inference for Individual-level models of infectious diseases in large populations. Statistica
Sinica 20, 239–261 (2010).
Mahsin, M. D., Deardon, R. & Brown, P. Geographically dependent individual-level models for infectious diseases
transmission. Biostatistics. doi:10.1093/biostatistics/kxaa009. eprint: https://academic.oup.com/
biostatistics/advance-article-pdf/doi/10.1093/biostatistics/kxaa009/32742504/kxaa009.
pdf. <https://doi.org/10.1093/biostatistics/kxaa009> (2020).
Menni, C. et al. Real-time tracking of self-reported symptoms to predict potential COVID-19. Nature Medicine.
doi:10.1038/s41591-020-0916-2. <https://doi.org/10.1038/s41591-020-0916-2> (2020).
COVID Symptom Study website <https://covid.joinzoe.com/>.
King, A. A., Nguyen, D. & Ionides, E. L. Statistical Inference for Partially Observed Markov Processes via the R
Package pomp. Journal of Statistical Software 69, 1–43 (2016).
Aguirre-Duarte, N. Can people with asymptomatic or pre-symptomatic COVID-19 infect others: a systematic
review of primary data. medRxiv. doi:10.1101/2020.04.08.20054023. eprint: https://www.medrxiv.
org/content/early/2020/04/16/2020.04.08.20054023.full.pdf. <https://www.medrxiv.org/
content/early/2020/04/16/2020.04.08.20054023> (2020).
Nishiura, H. et al. Estimation of the asymptomatic ratio of novel coronavirus infections (COVID-19). International
journal of infectious diseases 94, 154–155 (2020).
Rouder, J. N. & Lu, J. An introduction to Bayesian hierarchical models with an application in the theory of signal
detection. Psychonomic bulletin & review 12, 573–604 (2005).
Farrell, S. & Ludwig, C. J. H. Bayesian and maximum likelihood estimation of hierarchical response time models.
Psychonomic bulletin & review 15, 1209–1217 (2008).

15

26.
27.
28.
29.
30.

31.

Ionides, E. L., Bretó, C. & King, A. A. Inference for nonlinear dynamical systems. Proceedings of the National
Academy of Sciences 103, 18438–18443 (2006).
COVID-19 Mobility Data Network <https://www.covid19mobility.org/>.
Probabilistic inference framework for estimating risk of infection from proximity tracking data <https://
github.com/sphinxteam/sir_inference/>.
Alsdurf, H. et al. COVI White Paper. eprint: 2005.08502. <https://arxiv.org/abs/2005.08502> (2020).
Drogoul, A. et al. Designing social simulation to (seriously) support decision-making: COMOKIT, an agentbased modeling toolkit to analyze and compare the impacts of public health interventions against COVID-19.
<https://rofasss.org/2020/04/27/comokit/> (2020).
Taillandier, P. et al. Building, composing and experimenting complex spatial models with the GAMA platform.
GeoInformatica 23, 299–322 (2019).

16

