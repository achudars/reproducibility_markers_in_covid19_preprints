arXiv:2102.07566v2 [q-bio.PE] 16 Feb 2021

A stochastic SIR model for the analysis of the COVID-19 Italian
epidemic
S. Pasquali, A. Pievatolo, A. Bodini, F. Ruggeri
CNR IMATI “E. Magenes”, Milano, Italy
February 17, 2021

Abstract
We propose a stochastic SIR model, specified as a system of stochastic differential equations, to
analyse the data of the Italian COVID-19 epidemic, taking also into account the under-detection
of infected and recovered individuals in the population. We find that a correct assessment of the
amount of under-detection is important to obtain reliable estimates of the critical model parameters.
Moreover, a single SIR model over the whole epidemic period is unable to correctly describe the
behaviour of the pandemic. Then, the adaptation of the model in every time-interval between
relevant government decrees that implement contagion mitigation measures, provides short-term
predictions and a continuously updated assessment of the basic reproduction number.
Keywords: susceptible-infected-removed; basic reproduction number; state-space SDE; under-detection;
identifiability; particle filtering

1

Introduction

In this work we apply a stochastic version of the well-known SIR (with the three Susceptible, Infective
and Removed compartments) epidemic model to the Italian COVID-19 data. The SIR model has been
introduced about ten years after the 1918 influenza pandemic, also known as Spanish flu ([22]), and
is still popular as a simple tool to approximate disease behaviour ([31]). Numerous extensions such as
the simpler SEIR and SIRD models or the more complex SIDARTHE ([17]) have been subsequently
developed to make more reliable assumptions on the epidemic dynamic. For the outbreak of COVID19, alternative models have been introduced ranging from elementary models ([33]) to very complex
ones including spatial and temporal variations (e.g. [1], [2], [35], [34]). However, as a parsimonious
model able to allowing the measurement and forecast of the impact of non-pharmacological interventions like social distancing, the SIR model still preserves a primary role in the analysis of the early
phase of COVID-19 outbreak ([3],[8]). In [11] for instance, the SIR model is combined with Bayesian
parameter inference and the effects of governmental interventions in Germany are modelled as flexible
change points in the spreading rate. A SIR model with time-dependent infectivity and recovery rate
which are estimated by solving an inverse problem is considered in [25]. A hierarchical epidemiological model in which two observed time series of daily proportions of infected and removed cases are
emitted from the underlying infection dynamics governed by a Markov SIR infectious disease process
is proposed in [36]. By introducing a time–varying transmission rate, the Authors cover the effects
of different intervention measures in dissimilar periods in Italy. In [9] it is assumed that the susceptible population is a variable that can be adjusted to account for new infected individuals spreading
throughout a community. With a similar aim, [7] include among the parameters of a SIRD model
the initial number of susceptible individuals as well as the proportionality factor relating the detected
number of positives with the actual (and unknown) number of infected individuals. An alternative
way to account for possible random errors in reporting is proposed in [18] as well.

As mentioned before, several compartments may be added to the SIR model but, in previous work
([4]) it was shown that while the parameters of the SIR model can be uniquely determined from
the time evolution of the normalized curve of removed individuals, the same does not hold for more
complex models. Thus, the SEIR and other models should not be used in the absence of additional
information that might be obtained from clinical studies. In the present work, since we assume no
clinical information, we will use the SIR model. In particular, we introduce a stochastic SIR model to
describe the dynamics of the infection, coupled with an observation equation that relates the actual
numbers of infected and removed to the observed ones. There are two sources of randomness: the first
in the SIR model, introduced through uncertainty in the infection and recovery rate parameters, such
that they depend on time; the second in the observation equation, where a random under-reporting
error is assumed. This model is amenable to sequential updating of parameters and forecasting, a
useful feature when data come in on a daily basis. The updating method is a particle filter with
parameter learning [13] for the fraction of individuals in each compartment.
The article has two objectives: on the one side, the exploration of the suitability of a SIR model,
while, on the other, it provides some results on the epidemic in Italy. The first finding is that a
single SIR model is unable to capture the dynamics of the entire development of the COVID-19
epidemic, because of the numerous policy adjustments by health authorities and different government
interventions that took place during the emergency. Hence we fitted one SIR model to each phase
between selected government interventions, obtaining a good fit to the data. Notwithstanding, the
predictive capability of this model remains very limited. The second finding is that it is very important
to use the correct probability distribution for the observation error: failure to do so may produce
parameter estimates that seemingly provide a good fit to the data but do not correctly describe the
true underlying dynamics.
The article is organised as follows. In Section 2 we introduce the stochastic SIR model and
in Section 3 we present a discretised state-space version and the observation equation, where the
state is the fraction of susceptible, infected and removed individuals. A Rao-Blackwellised particle
filter (RBPF) algorithm for state filtering, state prediction and parameter learning is illustrated in
Appendix A, [13]. In Section 4 we study the filtering and prediction problem on data simulated from
our model with the help of graphical displays addressing the following: the accuracy and the precision
of both parameter estimation and filtering and the accuracy of the forecast (Sections 4.1 and 4.2); the
problem of the simultaneous identifiability of the parameters in both the SIR model and the observation
error distribution (Section 4.3). In Section 5 we apply our method to the Italian data of both the first
and the second infection wave, obtaining a good fit, as stated above, but a forecast that may be valid
only in the short term. In the same section we briefly compare the performance of a deterministic SIR
model to our stochastic SIR model, showing that the latter is superior. We also consider the problem
of assigning the correct observation error distribution using available information on the Infection
Fatality Rate and compare the level of the filtered state to the result of a sample serological survey
carried out by Istat (Italian national statistical office) and the Italian Health Ministry between May
and July 2020. This comparison indicates that our model, if correctly calibrated, provides a realistic
assessment of the state of the epidemics. A section with some final remarks concludes the article.

2

SIR model

Consider a population and denote by St the fraction of susceptible individuals at time t, by It the
fraction of infected individuals and by Rt the fraction of recovered individuals (survivors and dead).
We suppose that the population is closed, then for every time t
St + It + Rt = 1.

The deterministic SIR model can be written

dSt

 dt

= −βIt St
= βIt St − γIt
= γIt

dIt
dt

 dRt
dt

(1)

where β is the disease transmission rate, that is, the fraction of all contacts, between infected and
susceptible people, that become infectious per unit of time and per individual in the population, and γ
is the removal rate. The reciprocal of γ is the duration of infection. The parameters β and γ allow to
approximate the basic reproduction number (or ratio, also called basic reproductive number or ratio)
that can be thought of as the expected number of infected people generated by an infected individual
in a population where all individuals are susceptible to infection. Despite its conceptual simplicity, R0
is usually estimated with complex mathematical models developed using various sets of assumptions
([12]). In the above SIR model it holds
β
R0 = ,
γ
where parameters β and γ are unknown and have to be estimated. We suppose that they are subject
to uncertainty and change in time as follows:
(2)

(1)

(1)

(2)

γt = γ0 + ηwt

βt = β0 + σwt
(2)

with wt and wt independent Wiener noises, that is, βt is supposed normally distributed with mean
β0 and variance σ 2 t and γt is normally distributed with mean γ0 and variance η 2 t. The parameters
σ and η measuring the noise intensity are assumed known and sufficiently small to obtain positive βt
and γt with probability approximately equal to one. Substituting the expression (2) for β and γ in
system (1), we obtain the following stochastic SIR model:

(1)

 dSt = −β0 It St dt − σIt St dwt
(2)
(1)
(3)
dIt = (β0 It St − γ0 It ) dt + σIt St dwt − ηIt dwt


(2)
dRt = γ0 It dt + ηIt dwt
Unfortunately, the introduction of the noise in the parameters β and γ no longer grants the condition
St + It + Rt = 1. We can enforce it by substituting St by 1 − It − Rt in the second and third equations
and removing the first equation to obtain the reduced system
(
(2)
(1)
dIt = (β0 It (1 − It − Rt ) − γ0 It ) dt + σIt (1 − It − Rt )dwt − ηIt dwt
(4)
(2)
dRt = γ0 It dt + ηIt dwt



(2) T
(1)
the vector of independent Wiener
Denoting by Xt = (It , Rt )T the state vector, by Wt = wt , wt

processes and by θ0 = (β0 , γ0 )T the parameter vector, we can rewrite system (4) in vectorial form:
dXt = h (Xt ) θ0 dt + g (Xt ) dWt

(5)

where
h (Xt ) =



It (1 − It − Rt ) −It
0
It



;

g (Xt ) =



σIt (1 − It − Rt ) −ηIt
0
ηIt



.

(6)

We called Xt the state of the system, which for COVID-19 is unobservable, and introduce Yt to denote
what can be actually observed, in accordance with the terminology derived from state-space modelling.
The vector Yt is characterised in the following section.

3

Parameter estimation, filtering, forecasting, and goodness-of-fit

To estimate parameter θ0 we propose a Rao-Blackwellized particle filter (RBPF) algorithm based on
the Euler discretization of the stochastic system (5):
Xt+1 = Xt + h(Xt )θ0 ∆t + g(Xt )∆Wt ,

t = 0, 1, 2, . . .

(7)

where we also use t for discrete time to save notation. The method is described in Appendix A. This
algorithm allows to jointly calculate, at each time step, the estimated parameter and the state of the
system using a noisy observation of the state as input. It is widely recognised that in this pandemic
collected data on infected and removed suffer of under–diagnosis and under–detection, ([37]) that is, the
observations are subject to an observation error. We suppose that each component of the observation
vector Yt+1 is given by the product of the corresponding component of Xt+1 and a random variable:

 

Yt,1
Ut,1 Xt,1
=
(8)
Yt,2
Ut,2 Xt,2
where Ut,1 and Ut,2 are independent beta distributed random variables with shape parameters a and
b. (In the following, by U , Y and X with no subscript we mean scalar random variables distributed
as Ut,i , Yt,i , and Xt,i , respectively, i = 1, 2). Finally, we assume that the initial distribution of θ0 is
Gaussian with mean µ0 and covariance matrix Σ0 .
The model can also be used to predict the future behaviour of the epidemic. Let y1:t be the time
series of observations up to time t; for a fixed initial state x0 , the RBPF algorithm provides a sample
(i)
x0:t , i = 1, . . . , M , to approximate the posterior distribution of the state p(x0:t |y1:t ). Furthermore,
the conditional distributions of θ0 given x0:t , p(θ0 |x0:t ), is Gaussian with mean µt = E(θ0 |x0:t ) and
(i)
(i)
covariance matrix Σt = Cov(θ0 |x0:t ). The RBPF algorithm produces a sample (µt , Σt ) of conditional
(i)
mean vectors and covariance matrices given x0:t . To forecast Xt+k given y1:t , we aim at computing
E(Xt+k |y1:t ). If we fix θ0 and x0:t , and run model (7) for k time steps, we obtain a value for Xt+k as
a function fk (x0:t , θ0 , ξ), in which ξ indicates the sequence of increments ∆Ws , s = t + 1, . . . , t + k.
Using fk (x0:t , θ0 , ξ), the conditional expectation is
Z
E(Xt+k |y1:t ) = fk (x0:t , θ0 , ξ)p(ξ)p(θ0 |x0:t )p(x0:t |y1:t ) dξdθ0 dx0:t
(9)
where conditional independence of θ0 on y1:t given x0:t allows for substitution of p(θ0 |x0:t , y1:t ) by
(i)
(i)
p(θ0 |x0:t ). Then, if for each i we draw θ0 from p(θ0 |x0:t ) and ξ (i) from the distribution of the Wiener
process increment, the predictive expectation of Xt+k is approximated by
E(Xt+k |y1:t ) ≃

M
1 X
(i) (i)
fk (x0:t , θ0 , ξ (i) ) .
M

(10)

i=1

To visualize how well the SIR model fits the observations, we need a way to compare the simulated
trajectories with the observed data. We have supposed that the observations are smaller than the
true value of the state X, therefore we have to scale them by a factor that makes them comparable
to the filtered state. A scaling factor is suggested by building a prediction interval of the state X at
each observation time. Note that from (8) the random variable Y /X is a pivotal quantity with beta
distribution and we may state that
!


Y
Y
Y
≤X≤
(11)
≤ u1− q = P
1 − q = P uq ≤
2
2
X
u1− q
uq
2

q
2

q
2

2

where u q and u1− q are the and the 1 − percentiles of the beta distribution of U . Then, the
2
2
corresponding prediction interval for X, after observing y, is
!
y
y
,
(12)
u1− q u q
2

2

1

8

normalised n. of individuals

7
6
5
4
3
2

0.8
susceptible
infected
removed

0.6

0.4

0.2

1
0

0
0

0.2

0.4

0.6

0.8

1

detected fraction

0

10

20

30

40

50

60

70

time (days)

Figure 1: Left panel: beta distribution with parameters a = 10 and b = 40 for the observation error
terms Ut,1 and Ut,2 in (8). Right panel: data generated by (8) from state trajectories generated by
(4).
and a natural scaling factor for a point prediction of X is the median of U , producing y/u0.5 . The
feature of (12) is that it does not depend on the SIR modelling assumption, but only on the observation
error assumption, therefore it offers a way to see how well the SIR dynamic follows the (transformed)
data.

4
4.1

Numerical simulations
Data generated from the model

To check the convergence of the method we fix a parameter value and simulate the observations (or
data).
We start from an initial condition of 1% infected and 0.1% removed. We simulate data for the
parameters β0 = 0.3 and γ0 = 0.1. The parameters σ and η in (2) are 0.03 and 0.01, respectively.
We run model (4) with an underlying time step of 1/24 day to generate 67 daily step states. The
first 60 states will be used for the estimation procedure and the other 7 to check the goodness of the
forecast. Then, we use equation (8) with a = 10 and b = 40 for the beta distribution of the observation
error. This distribution is reported in the left panel of Figure 1 and the simulated observations are in
the right panel of Figure 1.
We apply the RBPF algorithm described in Appendix A with 200,000 particles and with a time
step of 1/24 day. Since we have a single observation for each day, to run the algorithm we have
to impute new hourly observations by means of a linear interpolation between two consecutive daily
observations. The imputed observations are no longer indipendently distributed conditionally on the
states, however this approximate procedure keeps the effective sample size of the RBPF algorithm at
large values with no appreciable difference on the results.
The initial guess for the parameter θ0 = (β0 , γ0 )T is µ0 = (0.5, 0.5)T and the prior covariance
matrix Σ0 = diag(0.05, 0.02). The mean trajectories of infected and removed people over all the
particles obtained running the RBPF algorithm are represented with continuous lines in the left panel
of Figure 2 where the circles represent simulated states before the introduction of the observation
error. Susceptibles are obtained as St = 1 − It − Rt and then the goodness of fit is a consequence of
the fit for the other two compartments.
We denote the estimates of β0 and γ0 with information up to time t by β̂t and γ̂t , see (A-5). Their
time behaviour is shown in the left panel of Figure 3. The behaviour of R̂0 (t), the estimated basic
reproduction number (A-6), is displayed in the right panel of Figure 3.

normalised n. of individuals

10

4

1

2.5

0.8

2

2

0.6

1.5

1.5

0.4

1

1

0.2

0.5

0.5

0
0

10

20

30

40

50

60

70

0
0.3

2.5

0.32

time (days)

10

0
0.095

0.34

4

0.1

0

0.105

0.11

0

Figure 2: Application of the RBPF algorithm. Left panel: trajectories of infected (red line) and
removed (green line). Circles represent the true state. The dynamics up to day 60 are the filtered
states, while the dynamics from day 61 to day 67 are forecasts. Right panel: posterior distributions
for the parameters β0 and γ0 at time 60.

4
0.45

3.5

0.4
3
0.35
0.3

2.5

0.25

2

0.2
1.5
0.15
1

0.1
0.05

0.5
0

10

20

30

40

time (days)

50

60

70

0

10

20

30

40

50

60

70

time (days)

Figure 3: Left panel: behaviour of β̂t (blue) and γ̂t (red) obtained from (A-5). Right panel: behaviour
of R̂0 (t) obtained from (A-6) (blue line) and value of true R0 = β0 /γ0 = 0.3/0.1 (red line).

3

normalised n. of individuals

infected
removed

2.5

2

1.5

1

0.5

0
0

10

20

30

40

50

60

70

time (days)

Figure 4: True states (circles), filtered state and forecast (thick lines) and adjusted observations (thin
line) with 95% prediction intervals (12). The thick lines up to day 60 are the filtered states, while
those from day 61 to day 67 are forecasts. The thin lines are the observations divided by u0.5 , the
median of the observation error distribution.
We denote the filtered or forecasted state as Iˆt and R̂t , where the value of t determines whether
we are filtering or forecasting, that is, if our observation period ends at time s, then when t > s, Iˆt
and R̂t are forecasts; otherwise they are filtered states. From the RBPF we get the filtered states
and, using (10), we get a forecast of the dynamics. Iˆt and R̂t are compared to the true state in the
left panel of Figure 2, where we see that both the fit up to day 60 and the forecast on days 61-67 are
satisfactory. In particular, the forecast well represents the trend of the state.
In reality the true states are unobserved, and we can only compare the filtered states to the
observations, by taking under-detection into account. Therefore, we compute daily prediction intervals
for infected It and removed Rt , as in (12) with q = 0.025. In Figure 4 the prediction intervals
are represented by vertical lines, while the thin continuous lines represent the ratio between the
observations and the median of the distribution of the observation error (which we may call the
adjusted observations). The width of the prediction intervals reflects the dispersion of the observation
error distribution in the left panel of Figure 1, for which q0.025 = 0.10 and q0.975 = 0.32. The simulated
dynamics (the true states) are inside the intervals and cross the adjusted observations, then, if the
adjusted observations and the filtered state agree with each other, this is a necessary condition for the
filtered state to follow the true state.

4.2

Assessment of sample variability

In this section we analyze the variability of the filtered states and of the estimated parameters due
to the variability of the data generated from the system (4), in order to get an impression of how far
they can get from the true values, even if the true random under-reporting error distribution is used.
We use the same parameters of Section 4.1, that is, (β0 , γ0 ) = (0.3, 0.1), σ = 0.01, η = 0.03, initial
values µ0 = (0.5, 0.5)T and Σ0 = diag(0.05, 0.02) and initial state X0 = (1%, 0.1%).
We generate 500 dynamics from the system (4), from which we obtain 500 trajectories of observed
infected and removed people. Then, we run the RBPF algorithm on every simulated dataset, with a
time step of 1/24 day and for 200,000 particles. For every simulations we compute the trajectories
Iˆt /It and R̂t /Rt , where we recall that Iˆt and R̂t are the estimated infected and removed individuals

2
1.6
1.4

1.5

1.2
1
1
0.8
0.6
0.5

0.4
0.2

0

0
0

10

20

30

40

50

60

0

10

20

time (days)

30

40

50

60

time (days)

Figure 5: Left panel: behaviour of Iˆt /It for 100 different simulations. Right panel: behaviour of R̂t /Rt
for 100 different simulations.
trajectory min distance

trajectory max distance

1

normalised n. of individuals

normalised n. of individuals

0.8
0.7
0.6
0.5
0.4
0.3
0.2

0.8

0.6

0.4

0.2

0.1
0

0
0

10

20

30

time (days)

40

50

60

0

10

20

30

40

50

60

time (days)

Figure 6: Left panel: dynamics of filtered states Iˆt and R̂t (continuous lines) in the case of minimum
sum of root mean square error between filtered states and true states (circles). Right panel: dynamics
of filtered states Iˆt and R̂t (continuous lines) in the case of maximum sum of root mean square error
between filtered states and true states (circles).
filtered by the RBPF algorithm, while It and Rt are the true states for the corresponding simulation.
For the sake of a clear representation, in Figure 5 we show one every five trajectories of Iˆt /It (left
panel) and R̂t /Rt (right panel).
In both panels of Figure 5, after a transient phase with larger dispersion, Iˆt /It and R̂t /Rt end up
fluctuating around 1, with a stable dispersion in the left panel and a decreasing dispersion in the right
panel. Now consider the sum of the root mean square error (RMSE) between Iˆt and It and of the
RMSE between R̂t and Rt for all the trajectories, as a measure of distance between the estimate and
the truth. Among all the trajectories we represented the one with the smallest and the one with the
largest distance in the left and in the right panels of Figure 6, respectively. The latter picture shows
that the fit may be very unsatisfactory.
Finally, we report the scatter plot of all the pairs (β̂t , γ̂t ) obtained in the 500 simulations (Figure 7)
at t = 60. We observe that they are dispersed around the true value of the parameter (0.3, 0.1). The
pair corresponding to the trajectory of minimum distance (green dot) is closer to the true parameter
(red dot) than the pair estimated from the trajectory of maximum distance (yellow dot). Then a good
fit to the state trajectory is associated with a better estimate of unknown parameters, provided the
remaining parameters, which have been assumed as known, are correctly assigned, as we will see in

0.5
0.45

posterior means
params. for max trject.
params. for min trject.
true value

0.4
0.35
0.3
0.25
0.2
0.15
0.06

0.08

0.1

0.12

0.14

0.16

Figure 7: Scatter plot of the parameters (γ̂60 , β̂60 ) obtained for the different simulations. The red
dot represents the true pair (0.1, 0.3). The green dot represents the pair of parameters relative to
the filtered state trajectory with minimum distance from the true states (left panel of Figure 6).
The yellow dot represents the pair of parameters corresponding to the filtered state trajectory with
maximum distance from the true states (right panel of Figure 6). The line is the least squares fit of
β̂60 against γ̂60 (slope 2.78).
the next section.
An interesting feature of Figure 7 is that the ratio β̂t /γ̂t shows a smaller variability than β̂t and
γ̂t , around a straight line with slope close to three, the true value of R0 . Therefore we expect to be
able to estimate the basic reproduction number with better accuracy and precision than the infection
and removal rate parameters.

4.3

Identifiability

A statistical model, belonging to a parametric family, is called identifiable if, for any two different
values of parameters, there exists at least a measurable set in the sample space that is not assigned
the same probability by the two members of the family, that is, given θ01 6= θ02 , there exists at least
one set B such that
Pr(Y1:t ∈ B; θ01 ) 6= Pr(Y1:t ∈ B; θ02 ) ,
(13)
where Y1:t denotes a finite-length trajectory of observations from (8). For a deterministic model, this
property is called structural identifiability, which holds if there exists a map from the parameter to
the output θ0 7→ y1:t (θ0 ) which is injective, that is, given θ01 6= θ02 , the two models y(θ01 ) and y(θ02 )
describe different output trajectories. By a differential algebra approach, [28] show that the following
deterministic SIR model with its output
 dIt

dt = β0 It (N − It − Rt ) − γ0 It

 dR
t
dt = γ0 It
(14)
1

y1,t = K
It


1
Rt
y2,t = K

defined for a non-normalised population of size N , is structurally identifiable with respect to the
unknown parameters β0 , γ0 and K. The parameter K > 1 accounts for under-reporting of infected
and recovered and has the same function of the U random variables in (8). Then, after adding noise

8
7
6
5
4
3
2
1
0
0

0.2

0.4

0.6

0.8

1

detected fraction

Figure 8: Comparison between the two beta densities used to model the observation error.
1.4

1.5

1.2
1
1
0.8
0.6
0.5
0.4
0.2
0

0
0

5

10

15

time (days)

20

25

30

0

5

10

15

20

25

30

time (days)

Figure 9: Left panel: behaviour of Iˆt /It for 100 different simulations. Right panel: behaviour of R̂t /Rt
for 100 different simulations.
to the output they go on to show that, despite structural identifiability, the parameters may not
be practically identifiable, that is, a good or acceptable agreement between observations and fit is
displayed for different values of the parameters when observations end before reaching the peak.
The way randomness has been included into this problem via model (7)-(8) is different from [28],
but we also observe practical identifiability. We generate state trajectories composed by 30 daily values
using model (4) with parameters β0 = 0.1 and γ0 = 0.03. Then, to obtain the actual observations we
multiply each value by a number drawn from a beta distribution with parameters a = 10 and b = 40
(blue line in Figure 8). After running the RBPF algorithm using the same beta distribution we obtain
results analogous to those in the previous sections, that is, a satisfactory fit of the observed dynamics
and a good estimate of the parameters β0 and γ0 .
Now we run the RBPF algorithm assuming an observation error with beta distribution with a
mean larger than the truth, with parameters a = 10 and b = 30 (red line in Figure 8). We compare
the filtered states with both the true ones and the observed data. First, we consider 500 simulations
and look at the ratio between the filtered state and the state. For the sake of a clear representation, in
Figure 9 we show one every five trajectories for both the infected and the removed individuals. These
ratios are, generally, less than 1 denoting an underestimation of both infected and removed.
Then, we consider the ratio between the filtered states and the adjusted observations. The results
of one every five trajectories are reported in Figure 10 for both infected and removed individuals.
These ratios fluctuate around 1, denoting a satisfactory fit to the observed data. Figure 11 shows the
dynamics of two simulations: the dynamics with minimum distance of the filtered state from the true

3.5

2.5

3
2
2.5
1.5

2
1.5

1

1
0.5
0.5
0

0
0

5

10

15

20

25

30

0

5

10

time (days)

15

20

25

30

time (days)

Figure 10: Left panel: behaviour of Iˆt /(yt,1 /m) for 100 different simulations, where m is the true
median of the observation error distribution. Right panel: behaviour of Iˆt /(yt,2 /m) for 100 different
simulations.
trajectory min distance

trajectory max distance

0.1

0.04

normalised n. of individuals

normalised n. of individuals

0.05

0.03

0.02

0.01

0

0.08

0.06

0.04

0.02

0

0

5

10

15

time (days)

20

25

30

0

5

10

15

20

25

30

time (days)

Figure 11: Left panel: case of minimum sum of root mean square error between true and filtered state,
dynamics of Iˆt and R̂t (continuous lines) and adjusted observations (thin line with asterisks). Right
panel: case of maximum sum of root mean square error between true and filtered state, dynamics of
Iˆt and R̂t (continuous lines) and adjusted observations (thin line with asterisks).
state (intended as the minimum sum of the root mean square errors over the two components), in
the left panel, and the dynamics with maximum distance, in the right panel. Both trajectories fit the
(scaled) observed data reasonably well.
Even if the filtered states follow the adjusted observations, the values of the estimated parameters
are not correct, as shown in Figure 12. In fact, the pair of estimated parameters in the 100 simulations
are not equally dispersed around the true value (red point) but are placed mainly at the left of the
true value, denoting a bad estimation for β0 . The estimation of γ0 is better.
It follows that it is very important to suitably choose the beta distribution of the observation error
(as we have done in Section 5) in the collection of infected and removed people to avoid practical
nonidentifiability.

5

Real data

In this section we use data of the epidemic in Italy, collected by Protezione Civile (Civil Protection
Department) from 24th February. As a first step we consider the data for the whole Italy from 1st
March up to 26th November 2020. Available data are the number of infected, dead, and recovered

posterior means
params. for max trject.
params. for min trject.
true value

0.14
0.13
0.12
0.11
0.1
0.09
0.08
0.07
0.06
0.02

0.025

0.03

0.035

0.04

0.045

0.05

0.055

Figure 12: Scatter plot of the parameters (γ̂60 , β̂60 ), obtained for the different simulations, with
wrong parameters a and b in the observation error distribution. The red dot represents the true pair
(0.03, 0.1). The green dot is the estimate corresponding to minimum distance case (left panel of Figure
11). The yellow dot is the case corresponding to the maximum distance case (right panel of Figure
11).
individuals. Removed people can be obtained by summing dead and recovered people. In Italy, all
deaths of people infected with SARS-CoV-2 were classified as COVID-19 ([29]). The infected and
removed individuals in Italy from 24th February to 26th November are represented in Figure 13. The
total residing population as of 31st December 2019 is 60,244,639 people, as certified by Istat.
To deal with underdetection we consider observations as generated by (8), where we recall that Ut,1
and Ut,2 are independently beta distributed with common shape parameters a and b. In particular,
we have Iobs = Y1 = U1 X1 and Robs = Y2 = U2 X2 , where the additional notations Iobs and Robs are
introduced as meaningful names for what follows.
As we can see from Figure 13 the epidemic can be divided in two waves: the first officially began on
24th February and lasted until mid-summer, when the number of infected people began to rise again,
as in the rest of Europe ([5]). The second wave is distinguished from the first also by the increased
test capacity. Hence we consider the two waves as different models, with respect to both the SIR
parameters and the observation error distribution parameters and we conventionally set the start of
the second wave on 1st August.

5.1

Assigning parameters of the observation error distribution

To fix a and b we refer to the Infection Fatality Ratio (IFR), a fundamental quantity to estimate
the seriousness of the epidemic, and to its crude estimate, the Case Fatality Ratio (CFR). The IFR
is the ratio of COVID-19 deaths to total infections of SARS-CoV-2, asymptomatic and undiagnosed
infections included, while the CFR is the ratio of COVID-19 deaths to confirmed cases. By the
definition, the CFR is greater than the IFR. At any time t an estimate CF Rt of the CFR and an
estimate IF Rt of the IFR are related by the simple relationship
CF Rt =

Dt
Rt
Rt
Dt
=
×
= IF Rt ×
Robs,t
Rt
Robs,t
Robs,t

where Dt denotes all deaths by time t ([16]).

(15)

9

10 5

8

n. of individuals

7
6
5
4
3
2
1
0
01/03 01/04 01/05 01/06 01/07 01/08 01/09 01/10 01/11

Figure 13: Infected (red asterisks) and removed (green asterisks) in Italy from 24th February (time
0) to 26th November 2020. Data from Protezione Civile.

Since by (15)
Robs,t =

IF Rt
× Rt ,
CF Rt

(16)

the ratio IF Rt /CF Rt can be regarded as the under-reporting factor that we modelled as the U beta
random variable introduced earlier.
Given estimates of IF Rt as t = 1, . . . , T and the corresponding observed sequence of CF Rt we
would obtain a sample u1 = IF R1 /CF R1 , . . . , uT = IF RT /CF RT and an estimate of a and b by any
established method. Using the method of moments, for example, and considering an estimate of the
IFR to substitute IF Rt , we would get
)
(


ū1/CF R (1 − IF R ū1/CF R )
ū(1 − ū)
− IF R
− 1 = ū1/CF R
â = ū
s2u
s21/CF R
)
(
(17)


1 − IF R ū1/CF R ū1/CF R (1 − IF R ū1/CF R )
ū(1 − ū)
b̂ = (1 − ū)
− IF R
−1 =
s2u
IF R
s21/CF R
where ū and s2u are the sample mean and variance of (u1 , . . . , uT ) and ū1/CF R and s21/CF R are the
sample mean and variance of 1/CF R1 , . . . , 1/CF RT . These equations show that the IFR affects both
parameters.
The fatality ratio approach has the advantage that the IFR is a pure number and information on
its value can be gathered from different populations. Then, in practice, we may estimate the sample
mean and variance of 1/CF R1 , . . . , 1/CF RT from the observed fatality and removal data, and for a
selected IF R assign â and b̂. If a range of values is available for the IFR from another source, such as
a confidence or a credibility interval, we may repeat the analysis for IF R varying within the interval
and evaluate the sensitivity of the results.
For Italy, we may use an indirect method to point at a plausible value of the IFR within this
interval, taking advantage of a seroprevalence survey targeting IgG antibody conducted in Italy from
May to July by Istat, the Italian national statistical office, and the Italian Health Ministry. Preliminary
results obtained from 64,660 people were presented in early August ([20]). According to them, almost
1.5 million people in Italy or 2.5% of the population had developed coronavirus antibodies, a figure six

times larger than official numbers reported. In short, the idea is to compare the 2.5% figure of people
who developed antibodies to the healed people (who have antibodies) estimated from the filtered
state R̂t in an appropriate time interval. The infected compartment may also contain seropositive
individuals, still, the fraction of people in this compartment had become small when Istat’s survey
started, so we consider only the recovered compartment. The reasoning behind this comparison is
that if the assumed IFR is correct, then the observation error distribution derived from (17) is correct
and the filtered states are realistic and they should be in agreement with the Istat survey result.
To be more specific, let Rt = Ht + Dt , where Ht and Dt are the fractions (over the population) of
healed and dead people by time t, respectively. Healed people can be seronegative if IgG antibodies
are no longer in their system, but we can safely assume that a person enters the healed record soon
so they s/he can be considered as seropositive when they do. Now, Ht includes all healed since the
start of the epidemic, hence a fraction of Ht can be seronegative, depending on the duration d of
seropositivity. Hence we should compare 2.5% to Ht − Ht−d , where Ht−d = 0 if t − d < 1. The true
values of Ht are unknown. We may recover them from R̂t and the available data on the fraction of
deaths as Ĥt = R̂t − Dt /u0.5 , where u0.5 is the median of the distribution of the observation error.
Since Istat’s survey was carried out between 25 May and 15 July 2020, we compare 2.5% to
H̄ =

1
52

15X
July

(Ĥt − Ĥt−d ) .

(18)

t=25 May

A plausible value of d is three months ([14]). This procedure rests on several assumptions and we only
regard it as a way to check for gross deviations of our model from reality.

5.2

State and parameter estimation

We run the RBPF algorithm with 20,000 particles and time discretisation step of 1/24 day as done
for the synthetic data. The initial values are (β0 , γ0 )T = µ0 = (0.3, 0.1)T and Σ0 = diag(0.05, 0.02).
Moreover σ = 0.03 and η = 0.01.
The true IFR in a population of interest can only be known at the end of the epidemic, and having
tested all the population. Because at the early stage of the epidemic reverse-transcription PCR (RTPCR) diagnostic testing is primarily limited to people with significant indications of and risk factors
for COVID-19, and because a large number of infections with SARS-CoV-2 result in mild or even
asymptomatic disease, the accurate estimation of IFR is challenging ([24]). The Centre for EvidenceBased Medicine (CEBM) at the University of Oxford bases its timely updates of IFR point estimate on
a continuously evolving meta-analysis based on CFR data. The IFR point estimate is then obtained by
halving the lower bound of the 95% prediction interval of the CFR and the current estimate fixes the
IFR at 0.54% ([27]: last updated 2 February 2021; cebm.net/covid–19/global–covid–19–case–fatality–
rates/). In [6] low and high income countries are separately discussed and in a typical high income
country, with a greater concentration of elderly individuals, an overall IFR of 1.15% (0.78-1.79 95%
prediction interval) is estimated. An estimate of 1.3% has been obtained using data from the closed
population of passengers in the Diamond Princess cruise ship ([30]). The meta–analysis carried out by
[26] of published research data on COVID-19 infection fatality rates with last search on 16/06/2020
indicates a point estimate of IFR of 0.68% (0.53%–0.82%) with high heterogeneity, and suggests that
in many populations the IFR would be > 1% if excess mortality was taken into account.
For the first wave, we computed a and b from (17) for a range of IFR values from 0.1%–6%,
where the minimum value is the lowest we found in the relevant literature and has been suggested
as lower bound of IFR in Europe by CEBM. The maximum value is still inspired by CEBM and
by the considerations in [26]. Indeed, in Italy an estimated initial CFR of about 11-19% has been
reported ([10], [32], [29]). This suggested to consider as a possible maximum initial value an IFR=6%,
accounting for the lack of knowledge at the beginning of the first wave. In particular, we considered
0.1%, 0.35%, 1.3%, and 6%. Moving too far from the highest value gives a large discrepancy between
Istat’s 2.5% estimated seropositivity in the population and (18). Then we present results for IF R =

normalised n. of individuals

12

infected
removed
Istat value

0.05

10

0.04

8

0.03

6

0.02

4

0.01

2

0
0

20

40

60

80

100

time (days)

120

140

160

0
0

0.2

0.4

0.6

0.8

1

detected fraction

Figure 14: Left panel: Filtered states for infected (thick red line) and removed (thick green line).
Parameters of the beta observation error distribution (right panel) are a = 11.72 and b = 81.39
obtained considering IFR=5%. The prediction intervals are computed from (12) with q = 0.025. The
thin lines are the observed infected (red) and removed (green) divided by u0.5 . The magenta dotted
line represents the 2.5% of the Italian population that have developed coronavirus antibodies in the
Istat analysis from 25th May to 15th July. Time 0 is 1st March.
5%, for which H̄ = 2.55%. Then a = 11.72 and b = 81.39 and the corresponding beta density is shown
in the right panel of Figure 14. The initial condition for It (Rt ), for each trajectory, is given by the
normalized number of infected (removed) people collected by Protezione Civile on 1st March divided
by the median of this beta distribution. The filtered states of infected and removed individuals are
represented with thick lines in the left panel of Figure 14 where also the prediction intervals for both
infected and removed are reported. The prediction intervals are computed from (12).
The plots of β̂t and γ̂t from (A-5) are in the top panel of Figure 15 and the plot of R̂0 (t) from
(A-6) is in the bottom panel.
The gap between the thick and the thin red lines in Figure 14 shows that a single SIR is not
able to correctly describe the behaviour of the true dynamics. Therefore, we split the first wave into
subintervals. For the partition we consider the DPCMs1 with the greatest impact on social organization
allowing for 10 days for the DPCM to have an effect on the epidemics (that is, change-points are the
DPCM dates plus 10 days). In particular, we consider the following DPCM dates: 11th March, 22nd
March, 26th April and 3rd June, so the change-points are on 21st March, 1st April, 3rd May and 13rd
June.
For each time interval, except for the first, we use the filtered state x̂t (A-4) at the end of the
previous interval as initial state and the values of β̂t and γ̂t at the end of the previous interval as starting
parameters. Then the discontinuity in the update is determined only by the initial covariance matrix.
Since in the case of a single time interval we observed that the entries of Σ0 are updated to very small
values, then for the case of several intervals we do not restart each interval with Σ0 = diag(0.05, 0.02),
but compromise between the updated Σ0 at the end of the previous interval and the initial Σ0 , taking
Σ0 = diag(0.002, 0.001), for all the time intervals. This choice also allows us to avoid big jumps in the
trajectories of the parameters at the change-points. The dynamics of the five different SIR models are
represented as a whole dynamics in Figure 16.
The trajectories β̂t , γ̂t and R̂0 (t) show jumps at the change-points (Figure 17), not very pronounced
due to the choice of a small Σ0 . After a few steps from each jump, the trajectories stabilize following
a regular trend. The dynamics of infected individuals fits very well the observed infected divided by
u0.5 . After day 66 (corresponding to 26 April), β̂t is smaller than γ̂t , so R̂0 (t) < 1. This value is more
1

DPCM: Italian acronym for government decrees. For a summary of the DPCMs related to the COVID-19 emergency
see http://www.governo.it/it/coronavirus-misure-del-governo

0.3
0.2
0.1
0
0

20

40

60

80

100

120

140

160

100

120

140

160

time (days)
6
4
2
0
0

20

40

60

80

time (days)

Figure 15: Single time interval case. Top panel: plots of β̂t and γ̂t from (A-5). Bottom panel: plot of
R̂0 (t) from (A-6). Time 0 is 1st March.

0.06
infected
removed

0.05

individuals

0.04

0.03

0.02

0.01

0
0

20

40

60

80

100

120

140

160

time (days)

Figure 16: Filtered states for infected (thick red line) and removed (thick green line) from five different
SIRs in the intervals [0, 20], [20, 31], [31, 66], [66, 104], [104, 160]. Parameters of the beta observation
error distribution are a = 11.72 and b = 81.39. The prediction intervals are computed from (12) with
q = 0.025. The thin lines are the observed infected (red) and removed (green) divided by u0.5 . Time
0 is 1st March.

0.3
0.2
0.1
0
0

20

40

60

80

100

120

140

160

100

120

140

160

time (days)
6
4
2
0
0

20

40

60

80

time (days)

Figure 17: Multiple time intervals case. Top panel: plots of β̂t and γ̂t from (A-5). Bottom panel: plot
of R̂0 (t) from (A-6). Time 0 is 1st March.
realistic than R̂0 (t) in the single time interval case, which is always greater than 1 (Figure 15).
This result is in agreement with the effective reproduction number published for the first time by
Istituto Superiore di Sanità (Italian National Istitute of Health, ISS) on 30 April ([19]): the effective
reproduction numbers were reported for every Italian region (except for two because of bad quality
data) and they were all smaller than one.
Now, we analyze the forecast of the infected and removed dynamics for the first wave, computed
as in (10). We consider different cases: we suppose to have observations up to 10 days or 20 days after
the second or third change-points, and we try to forecast the dynamics for 7 future days (Figure 18).
It can be observed from Figure 18 that the forecast is satisfactory when it starts 10 days after
a change-point (left panels), while when it starts 20 days after a change-point is satisfactory only in
the decreasing phase (bottom right panel). This different performance is mainly due to how fast β̂t
changes after each change-point, rather than to the number of observations taken before the forecast
is started.
Now, we focus on the second wave, starting on 1st August and we select three change-points 10
days after the following measures: on 1st September (partial opening of museums, stadiums, and
the increase in public transport occupancy); on 21st October (curfew in Lombardy, the most affected
region); on 3rd November (DPCM establishing red, orange and yellow scenarios to classify the Regions
from the highest to the lowest risk and introducing tiered restrictions). We run the RBPF algorithm,
with µ0 = (0.05, 0.03)T as initial value for (β0 , γ0 )T and Σ0 = diag(0.002, 0.001). Moreover, σ = 0.03
and η = 0.01. The state is formed by the infected individuals and by the new removed individuals
since 1st August, that is, the difference between the collected removed at each time and the removed
on 31st July.
For the second wave the under-detection error of infected and removed people is smaller, because
of an increase in resources for taking swab tests. For this reason it is appropriate to recalculate the
parameters of the beta observation error distribution from (17) only with the data since 1st August.
Unfortunately, we lack a benchmark such as the serological survey during the first wave, and therefore
we present the results obtained by considering four different IF R values: 1.15%, 1.3%, 1.5%, 1.75%
according to the most recent studies. The beta densities obtained for these values are represented in
Figure 19 and compared with the beta density used for the first wave. We exclude smaller values of
IF R because the corresponding observation error beta distributions are located on small values like

0.03

0.03

normalised n. of individuals

infected
removed

infected
removed

0.025

0.025

0.02

0.02

0.015

0.015

0.01

0.01

0.005

0.005

0

0

0

10

20

30

40

50

0

10

20

30

40

50

60

0.05
infected
removed

normalised n. of individuals

0.04

infected
removed

0.04

0.035
0.03

0.03
0.025
0.02
0.02
0.015
0.01

0.01

0.005
0

0
0

10

20

30

40

50

60

70

80

90

0

20

time (days)

40

60

80

100

time (days)

Figure 18: Dynamics of infected and removed individuals with forecasts during an increasing phase
(first row) or a decreasing phase (second row). The forecasts start 10 days after a change point (first
column) or 20 days after (second column). Starting dates are: 11th April (top left), 21st April (top
right), 6th May (bottom left), 16th May (bottom right). Forecasts of infected and removed individuals
are highlighted with different colours.
for the first wave.
It can be seen from Figure 19 that both the mean and the variance of the beta distribution increase
as the IFR increases. The corresponding dynamics are shown in Figure 20. The normalised numbers
of individuals decrease when the IFR increases, because observations are divided by the median of the
beta distribution which is increasing with the IFR. Also the width of the prediction intervals decreases
as IFR increases. The filtered dynamics well reconstruct the behaviour of the adjusted data in all
the cases. The estimated parameters β̂t and γ̂t are very similar for the different cases and only the
parameters obtained using IFR=1.3% are reported in Figure 21 with the corresponding R̂0 (t).
We observe a big jump in R̂0 (t) on the date of the second change point, 10 days after the curfew in
Lombardy, followed by a slow decrease, denoting that this measure did not produce the desired effect.
Then it was followed by the measure of 3rd November that allows R̂0 (t) to accelerate its decrease,
approaching one, in agreement with what the ISS reported in its 25th November bulletin [21].

5.3

A comparison with the SIR deterministic model

In this section we consider for comparison model (1) combined with the observation equations (8),
that is, the state dynamics is completely deterministic. We repeat part of the analysis done with
the stochastic SIR model on the first wave data, using the same observation error distribution, and
estimate (β, γ) via maximum likelihood. In Figure 22 we show the single-phase deterministic SIR
simulation along with the adjusted observations, in two situations: when the number of infected is
descending after the peak and when the descent is almost complete. In both cases the deterministic SIR
is unable to capture the dynamics. The single-phase stochastic SIR model (see Figure 14), although
unsuitable, performs better thanks to the learning mechanism that makes adaptations both to the
parameter and the filtered state. The piecewise deterministic SIR model, see Figure 23, follows the
scaled observations more closely, still it is rather less flexible than its stochastic counterpart (see Figure

12

10

8

6

4

2

0
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

detected fraction

Figure 19: Beta distributions of the observation error for different values of IFR: 1.15% (light blue
dashed line), 1.3% (red dotted line), 1.5% (green continuous line), 1.75% (magenta dashed-dotted
line). For comparison also the beta density used for the first wave is reported (blue continuous line).

infected
removed

0.08

normalised n. of individuals

normalised n. of individuals

0.08
0.07
0.06
0.05
0.04
0.03
0.02
0.01
0
160

infected
removed

0.07
0.06
0.05
0.04
0.03
0.02
0.01

180

200

220

240

260

0
160

280

180

200

time (days)
infected
removed

0.07
0.06
0.05
0.04
0.03
0.02
0.01
0
160

240

260

280

240

260

280

infected
removed

0.08

normalised n. of individuals

normalised n. of individuals

0.08

220

time (days)

0.07
0.06
0.05
0.04
0.03
0.02
0.01

180

200

220

time (days)

240

260

280

0
160

180

200

220

time (days)

Figure 20: Filtered states for infected (thick red line) and removed (thick green line) in the second
wave for different IFR: 1.15% (top left), 1.3% (top right), 1.5% (bottom left), 1.75% (bottom right).
The prediction intervals are computed from (12) with q = 0.025. The thin lines are the observed
infected (red) and removed (green) divided by u0.5 . Forecast of infected and removed individuals are
highlighted with different colors. Time 160 is 1st August.

0.1

0.05

0
160

180

200

220

240

260

280

240

260

280

time (days)
10

5

0
160

180

200

220

time (days)

Figure 21: Top panel: plots of β̂t and γ̂t from (A-5). Bottom panel: plot of R̂0 (t) from (A-6). The
IFR is 1.3%. Time 0 is 1st August.
16). This is a further demonstration that a single SIR is unsuitable to describe the true behaviour of
the pandemic.

6

Concluding remarks

In this work we have proposed a piecewise stochastic SIR model with change-points to the COVID-19
data in Italy from 24th February to 26th November 2020, using the dates of measures taken by the
government to control the epidemic to define the change-points. The under-detection of the fractions of
infected and removed in the population has also been explicitly modelled, introducing a distribution for
the observation error. This strategy makes it possible to estimate the actual dynamics of the epidemic
by overcoming the limitations of a single deterministic SIR model on the one hand and by correcting
the observed data on the other hand. Then, via a particle filtering and parameter learning algorithm,
the model can produce short-term predictions of the population in each compartment and continously
0.045

0.04
infected
removed

infected
removed

0.035

normalised n. of individuals

normalised n. of individuals

0.04
0.035
0.03
0.025
0.02
0.015
0.01

0.03
0.025
0.02
0.015
0.01
0.005

0.005
0

0
0

20

40

60

time (days)

80

100

0

20

40

60

80

100

120

140

time (days)

Figure 22: First wave: deterministic SIR simulations with ML parameter estimates and adjusted observations and seven-day forecast, until 15 May (left) and until 30 June (right). Estimated parameters
are (β, γ) = (0.15, 0.08) and (β, γ) = (0.57, 0.55), respectively. Time 0 is 1st March.

0.25

0.025

normalised n. of individuals

infected
removed

0.02

0.2

0.015

0.15

0.01

0.1

0.005

0.05

0

0
0

20

40

60

time (days)

80

100

0

10

20

30

40

50

60

70

80

time (days)

Figure 23: First wave: piecewise deterministic SIR simulations with ML parameter estimates and
adjusted observations and seven-day forecast (left) until 15 May; parameter estimates (β̂, γ̂) in each
phase (right) are (0.21, 0.04), (0.08, 0.03), (0.04, 0.03), (1.6 × 10−8 , 0.05). Cut dates correspond to 10
days after the government decrees on 11 March, 22 March, 26 April. Time 0 is 1st March.
updated estimates of key quantities such as the basic reproduction number, which can be acted upon
by decision makers. We obtained a rather large basic reproduction number in the initial phase of the
first wave, decreasing progressively in the following phases. This value may seem surprising, but other
studies, such as [23], confirm this behaviour which is common in European countries.
The stochastic SIR model might be used to evaluate the effect of mitigation measures by extending
the predictions to a horizon of several weeks beyond the date of the next government decree, as an
answer to the question: “what would the mid-term evolution of the epidemics have been if this specific
measure had not been taken”? But, given the complexity of the phenomenon, which is only partially
captured by the model, a great deal of caution is required in doing so. A possible way out is to enrich
the model by adding compartments, but, as our model identifiability study has shown, solid prior
information or data relevant to the required additional parameters are needed to obtain meaningful
results.
With respect to prior information, our approach to the selection of the observation error distribution depends on an estimate of the IFR. For the first wave we have chosen larger values than for
the second wave (up to 6% against up to 1.75%), which is in agreement with a report of the ISS [15],
published after we finished our analyis, where the monthly standardised CFR has been calculated.
When standardised with respect to the age and sex structure of the Italian population, the CFR is
close to 9% in February-March 2020 and close to 4.5% in April. Then it falls to around 1% in June
and July and increases to above 2% in October.

Acknowledgments
The authors acknowledge the many fruitful discussions with several colleagues, and in particular the
colleagues at CNR-IMATI that participated in the COVID-19 modelling study group.

A

RBPF algorithm

To estimate parameter θ0 = (β0 , γ0 )T and state Xt we propose to apply a Rao-Blackwellized particle
filter (RBPF) algorithm. We consider the Euler discretization of the stochastic system (5) reported
in equation (7). Since the system is linear in θ0 , we can apply the Kalman filter. Suppose that
θ0 = (β0 , γ0 )T has a normal prior distribution with mean µ0 and covariance matrix Σ0 , then the
distribution of θ0 , given x0:t+1 = (x0 , x1 , ..., xt+1 ) after t + 1 time steps, as t = 0, 1, 2, . . ., is normal

with mean µt+1 and covariance matrix Σt+1 given by

T

µt+1 = µt + St+1 [xt+1 − xt − h (xt ) µt ∆t]
T h (x ) Σ ∆t
Σt+1 = Σt − St+1
t
t


−1
 T
St+1 = Σt hT (xt ) ∆t h (xt ) Σt hT (xt ) (∆t)2 + g(xt )gT (xt )∆t

(A-1)

The distribution of Xt+1 given x0:t is Gaussian with mean Bt+1 and covariance matrix Gt+1 given by
(
Bt+1 = xt + h (xt ) µt ∆t
(A-2)
Gt+1 = h (xt ) Σt hT (xt ) (∆t)2 + g(xt )gT (xt )∆t.
Recalling that the observations are obtained multiplying the state Xt for the beta-distributed
observation error term, as defined in equation (8), the RBPF algorithm can be summarized as follows:
STEP 1
• At time t = 0, we draw M initial values of X0 from its prior distribution π (x0 ) and obtain M
(i)
values x0 , i = 1, 2, ..., M or, alternatively, we put x0 equal to the initial observation.
• We consider a prior distribution for the parameter θ0 , given by a normal distribution N (µ0 , Σ0 ),
where µ0 is a vector of initial parameters, and Σ0 is a diagonal covariance matrix.
• To obtain candidate values of the state at importance sampling steps, we will use the distribution
implied by the state-transition equation (7) after marginalising it with respect to θ0 . At step
(i)
(i)
(i)
one, a value for X̃1 , conditional on x0 , is sampled from a normal distribution with mean B1
(i)
and covariance matrix G1 , for i = 1, . . . , M , given by (A-2) with k = 0.
• Denoting by y1 the observation at time k = 1, we compute weights for each particle from the
(i)
likelihood at x̃1
(i)
(i)
(i)
(i)
ṽ1 = L(x̃1 ; y1 ) = p(y1,1 |x̃1,1 ) × p(y1,2 |x̃1,2 )
where
p (y|x) =

y a−1
x

1 − xy
B (a, b)

b−1

1
I
(y).
x [0,x]

(A-3)

In order to resample the particles, we need to normalize the weights:
(i)
v1

(i)

ṽ1

=P
M

(i)
i=1 ṽ1

• We update the posterior distribution of θ0 given

.

n
o
(i) (i)
x̃1 , x0
by taking one step of the Kalman
(i)

(i)

filter of equation (A-1), obtaining the new mean vector µ̃1 and covariance matrix Σ̃1 .
n
o
(i) (i)
(i)
• We resample M particles from a discrete distribution with support
x̃1 , µ̃1 , Σ̃1
i=1,...,M
n o
n
o
(i)
(i) (i)
(i)
and corresponding probabilities v1
. We denote by
x1 , µ 1 , Σ 1
the
i=1,...,M

resampled particles.

At time t ≥ 1, assume the sample

i=1,...,M

o
n
(i)
(i) (i)
xt , µ t , Σ t

i=1,...,M

is available.

STEP t + 1
(i)

(i)

• For i = 1, . . . , M , sample candidate particles x̃t+1 from a normal distribution with mean Bt+1
(i)

and covariance matrix Gt+1 , given by (A-2).

(i)

• Compute the weights ṽt+1 for each particle as the product of two distributions with density
(A-3). Normalize the weights:
(i)
ṽ
(i)
vt+1 = P t+1 (i) .
M
i=1 ṽt+1
(i)

• Update the posterior distribution of θ0 given x0:t+1 , which is a normal distribution with mean
(i)

(i)

µ̃t+1 and covariance matrix Σ̃t+1 given by equation (A-1).
n
o
(i)
• Resample M particles using the probabilities vt+1
and denote the resampled particles
i=1,...,M
n
o
(i)
(i)
(i)
by
xt+1 , µt+1 , Σt+1
.
i=1,...,M

(i)

o
n
(i)
(i) (i)
Particles
xt , µ t , Σ t

i=1,...,M

are a sample from the distribution of interest. In detail, the

xt ’s are a sample from p(xt |y1:t ) and, by keeping track of the resampling history, the entire sample
(i)
(i)
x0:t , i = 1, . . . , M is potentially available, hence a sample from p(x0:t |y1:t ). The mean of xt over the
particles approximates E(xt |y1:t ) and we call it the filtered state:
x̂t =

M
1 X (i)
xt .
M

(A-4)

i=1

(i)

(i)

(i)

The µt ’s and Σt ’s are a sample of conditional means and covariance matrices, that is, E(θ0 |x0:t )
(i)
and Cov(θ0 |x0:t ). Therefore, an estimate of E(θ0 |y1:t ) is
M
1 X (i)
µt
(β̂t , γ̂t ) = θ̂t =
M
T

(A-5)

i=1

(i)

(i)

and, by sampling M values from M Gaussian distributions N (µt , Σt ), i = 1, . . . , M , we produce a
(M )
(1)
sample (θt , . . . , θt ) from p(θ0 |y1:t ).
The basic reproduction number is defined as R0 = β0 /γ0 , therefore an estimate based on y1:t is
E(β0 /γ0 |y1:t ), which is computed as
M
(i)
1 X βt
(A-6)
R̂0 (t) =
(i)
M
i=1 γt
(i)

(i)

(i)

(i)

where (βt , γt )T = θt . If the variances on the diagonal of Σt are small, the additional sampling from
(i)
(i)
the N (µt , Σt ) may be unnecessary and the following approximation might be used, corresponding
to degenerate conditional distributions:
(i)
M
1 X µ1,t
R̂0 (t) =
.
(i)
M
i=1 µ2,t

(A-7)

R̂0 (t) can be regarded as our best estimate of the basic reproduction number in the light of the observed
data, not to be confused with the net or effective reproduction number. A very useful discussion on
the meaning of R0 is provided by [12].

References
[1] A. Arenas, W. Cota, J. Gómez-Gardeñes, S. Gómez, C. Granell, J. T. Matamalas, D. SorianoPaños, and B. Steinegger. Modeling the spatiotemporal epidemic spreading of covid-19 and the
impact of mobility and social distancing interventions. Physical Review X, 10:041055, 2020.

[2] Y. Bai, A. Safikhani, and G. Michailidis. Non-stationary spatio-temporal modeling of covid-19
progression in the us. medRxiv, 2020.
[3] A. L. Bertozzi, E. Franco, G. Mohler, M. B. Short, and D. Sledge. The challenges of modeling and forecasting the spread of covid-19. Proceedings of the National Academy of Sciences,
117(29):16732–16738, 2020.
[4] A. H. Bilge, F. Samanlioglu, and O. Ergonul. On the uniqueness of epidemic models fitting a
normalized curve of removed individuals. Journal of Mathematical Biology, 71(4):767–794, 2015.
[5] E. Bontempi. The europe second wave of covid-19 infection and the italy “strange” situation.
Environmental Research, page 110476, 2020.
[6] N. F. Brazeau, R. Verity, S. Jenks, H. Fu, C. Whittaker, P. Winskill, I. Dorigatti, P. Walker,
S. Riley, R. P. Schnekenberg, et al. Report 34: Covid-19 infection fatality ratio: estimates from
seroprevalence. 2020.
[7] G. C. Calafiore, C. Novara, and C. Possieri. A modified sir model for the covid-19 contagion in
italy. In 2020 59th IEEE Conference on Decision and Control (CDC), pages 3889–3894, 2020.
[8] T. Carletti, D. Fanelli, and F. Piazza. Covid-19: The unreasonable effectiveness of simple models.
Chaos, Solitons & Fractals: X, 5:100034, 2020.
[9] I. Cooper, A. Mondal, and C. G. Antonopoulos. A sir model assumption for the spread of covid-19
in different communities. Chaos, Solitons & Fractals, 139:110057, 2020.
[10] G. De Natale, V. Ricciardi, G. De Luca, D. De Natale, G. Di Meglio, A. Ferragamo, V. Marchitelli,
A. Piccolo, A. Scala, R. Somma, et al. The covid-19 infection in italy: a statistical study of an
abnormally severe disease. Journal of Clinical Medicine, 9(5):1564, 2020.
[11] J. Dehning, J. Zierenberg, F. P. Spitzner, M. Wibral, J. P. Neto, M. Wilczek, and V. Priesemann.
Inferring change points in the spread of covid-19 reveals the effectiveness of interventions. Science,
369(6500), 2020.
[12] P. L. Delamater, E. J. Street, T. F. Leslie, Y. T. Yang, and K. H. Jacobsen. Complexity of the
basic reproduction number (r0). Emerging Infectious Diseases, 25(1):1, 2019.
[13] A. Doucet, S. Godsill, and C. Andrieu. On sequential monte carlo sampling methods for bayesian
filtering. Statistics and computing, 10(3):197–208, 2000.
[14] E. Duysburgh, L. Mortgat, C. Barbezange, K. Dierick, N. Fischer, L. Heyndrickx, V. Hutse,
I. Thomas, S. Van Gucht, B. Vuylsteke, et al. Persistence of IgG response to SARS-CoV-2. The
Lancet Infectious Diseases, 21(2):163–164, 2021.
[15] M. Fabiani, G. Onder, S. Boros, M. Spuri, G. Minelli, A. Mateo Urdiales, , A. Xanthi, F. Riccardo,
M. Del Mando, D. Petrone, L. Palmieri, M. F. Vescio, A. Bella, and P. Pezzotti. Il case fatality rate
dell’infezione SARS-CoV-2 a livello regionale e attraverso le differenti fasi dell’epidemia in Italia.
Technical Report 1/2021, Istituto Superiore di Sanità, 2020. [Online; accessed 10-February-2021;
in Italian].
[16] A. C. Ghani, C. A. Donnelly, D. R. Cox, J. T. Griffin, C. Fraser, T. H. Lam, L. M. Ho, W.-S.
Chan, R. M. Anderson, A. J. Hedley, et al. Methods for estimating the case fatality ratio for a
novel, emerging infectious disease. American Journal of Epidemiology, 162(5):479–486, 2005.
[17] G. Giordano, F. Blanchini, R. Bruno, P. Colaneri, A. Di Filippo, A. Di Matteo, and M. Colaneri.
Modelling the covid-19 epidemic and implementation of population-wide interventions in italy.
Nature Medicine, 26(6):855–860, 2020.

[18] H. G. Hong and Y. Li. Estimation of time-varying reproduction numbers underlying epidemiological processes: A new statistical tool for the covid-19 pandemic. PloS ONE, 15(7):e0236464,
2020.
[19] Istituto di Superiore Sanità.
Epidemia COVID-19. Aggiornamento nazionale 28
aprile 2020 – ore 16:00.
https://www.epicentro.iss.it/coronavirus/bollettino/
Bollettino-sorveglianza-integrata-COVID-19_28-aprile-2020.pdf, 2020.
[Online;
accessed 01-February-2021; in Italian].
[20] Istituto Nazionale di Statistica. Primi risultati dell’indagine di sieroprevalenza sul SARS-CoV-2.
Technical report, 2020. [Online; accessed 01-February-2021; in Italian].
[21] Istituto Superiore di Sanità. Epidemia COVID-19. Aggiornamento nazionale 25 novembre 2020 – ore 16:00.
https://www.epicentro.iss.it/coronavirus/bollettino/
Bollettino-sorveglianza-integrata-COVID-19_25-novembre-2020.pdf, 2020.
[Online;
accessed 10-February-2021; in Italian].
[22] W. O. Kermack and A. G. McKendrick. A contribution to the mathematical theory of epidemics.
Proceedings of the Royal Society of London. Series A, 115(772):700–721, 1927.
[23] K. Linka, M. Peirlinck, and E. Kuhl. The reproduction number of covid-19 and its correlation
with public health interventions. Computational Mechanics, 66(4):1035–1050, 2020.
[24] S. Mallapaty. How deadly is the coronavirus? scientists are close to an answer. Nature, pages
467–468, 2020.
[25] T. T. Marinov and R. S. Marinova. Dynamics of covid-19 using inverse problem for coefficient
identification in sir epidemic models. Chaos, Solitons & Fractals: X, 5:100041, 2020.
[26] G. Meyerowitz-Katz and L. Merone. A systematic review and meta-analysis of published research
data on covid-19 infection-fatality rates. International Journal of Infectious Diseases, 2020.
[27] J. Oke and C. Heneghan. Global Covid-19 Case Fatality Rates. https://www.cebm.net/
covid-19/global-covid-19-case-fatality-rates, 2020. [Online; accessed 01-February2021].
[28] C. Piazzola, L. Tamellini, and R. Tempone. A note on tools for prediction under uncertainty
and identifiability of sir-like dynamical systems for epidemiology. Mathematical Biosciences, page
108514, 2020.
[29] F. Riccardo, M. Ajelli, X. D. Andrianou, A. Bella, M. Del Manso, M. Fabiani, S. Bellino, S. Boros,
A. M. Urdiales, V. Marziano, et al. Epidemiological characteristics of covid-19 cases and estimates
of the reproductive numbers 1 month into the epidemic, italy, 28 january to 31 march 2020. Euro
Surveillance, 25(49):2000790, 2020.
[30] T. W. Russell, J. Hellewell, C. I. Jarvis, K. Van Zandvoort, S. Abbott, R. Ratnayake, S. Flasche,
R. M. Eggo, W. J. Edmunds, A. J. Kucharski, et al. Estimating the infection and case fatality
ratio for coronavirus disease (covid-19) using age-adjusted data from the outbreak on the diamond
princess cruise ship, february 2020. Euro Surveillance, 25(12):2000256, 2020.
[31] J. Tolles and T. Luong. Modeling epidemics with compartmental models. JAMA, 323(24):2515–
2516, 2020.
[32] D. Tosi, A. Verde, and M. Verde. Clarification of misleading perceptions of covid-19 fatality and
testing rates in italy: Data analysis. Journal of Medical Internet Research, 22(6):e19825, 2020.
[33] N. Wang, Y. Fu, H. Zhang, and H. Shi. An evaluation of mathematical models for the outbreak
of covid-19. Precision Clinical Medicine, 3(2):85–93, 2020.

[34] Z. Wang, X. Zhang, G. Teichert, M. Carrasco-Teja, and K. Garikipati. Correction to: System
inference for the spatio-temporal evolution of infectious diseases: Michigan in the time of covid-19.
Computational Mechanics, page 1, 2020.
[35] Z. Wang, X. Zhang, G. Teichert, M. Carrasco-Teja, and K. Garikipati. System inference for the
spatio-temporal evolution of infectious diseases: Michigan in the time of covid-19. Computational
Mechanics, 66(5):1153–1176, 2020.
[36] J. Wangping, H. Ke, S. Yang, C. Wenzhe, W. Shengshu, Y. Shanshan, W. Jianwei, K. Fuyin,
T. Penggang, L. Jing, et al. Extended sir prediction of the epidemics trend of covid-19 in italy
and compared with hunan, china. Frontiers in Medicine, 7:169, 2020.
[37] World Health Organization. Estimating mortality from COVID-19: scientific brief, 4 August
2020. Technical documents, 2020.

