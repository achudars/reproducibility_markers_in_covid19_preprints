1

Variable pool testing for infection spread
estimation

arXiv:2004.03322v1 [stat.AP] 7 Apr 2020

Itsik Bergel

Abstract
We present a method for efficient estimation of the prevalence of infection in a population with
high accuracy using only a small number of tests. The presented approach uses pool testing with a mix
of pool sizes of various sizes. The test results are then combined to generate an accurate estimation over
a wide range of infection probabilities. This method does not require an initial guess on the infection
probability. We show that, using the suggested method, even a set of only 50 tests with a total of only
1000 samples can produce reasonable estimation over a wide range of probabilities. A measurement set
with only 100 tests is shown to achieve 25% accuracy over infection probabilities from 0.001 to 0.5.
The presented method is applicable to COVID-19 testing.

I. BACKGROUND
In times of epidemic crisis, it is important to monitor the spread of the infection in the general
population as well as in various sub-groups (neighborhoods, work places, special populations
etc.). While taking samples can be relatively easy, the actual tests require sophisticated machinery and specific reagents which are often sparse. Furthermore, the testing procedure is time
consuming, and the processing of each test may take several hours. Thus, most countries focus
their testing capacity on acutely ill patients, leaving very small capacity to statistical studies of
other populations. Furthermore, the prevalence disease carriers in such other population can be
low, and hence, a direct estimation would require many tests.
Pool testing (or group testing) was suggested as a method to efficiently test large populations
[1], [2]. In pool testing several samples are mixed and tested at a single pool. That is, A group
of collected samples (e.g., using swabs for COVID-19 tests) is mixed into a single tube. This
tube is then tested (e.g., using RT-qPCR). Thus, while many samples are collected, the load on
the testing machinery remains small.

April 8, 2020

DRAFT

2

Pool testing is used for various infectious disease [3], [4], and was proven to work also for
RT-qPCR tests [5], [6]. Furthermore, pool testing was successfully demonstrated recently for
the SARS-CoV-2 pathogen of COVID-19 [7] for pool sizes of up to 64 samples. Pool sampling
strategics for COVID-19 (with fixed pool size) where also studied in [8].
The literature on pool testing is quite diverse, both in the medical literature (e.g., [9], [10])
and in data processing contexts (e.g., [11], [12]). Pool testing is commonly used for efficient
detection of infected samples when the infection probability is small. But, pool testing is also
used for efficient estimation of the prevalence of a rare disease.
But, using pool testing for prevalence estimation, requires a choice of the pool size in
accordance with the expected prevalence. This is problematic, as such tests are often performed
without prior knowledge on the tested group. For example [13] suggested a sequential pool
testing, where at each stage the estimate of the infection probability is improved and used to
design the next stage. Yet, the test accuracy still strongly depends on the quality of the initial
guess.
So far, there is no simple and efficient method to choose pool sizes that will bring accurate
estimation over a wide range of infection probabilities in a single batch.
In this work we present a method for efficient estimation of the prevalence of infection in
a population using a small number of tests. The presented approach uses a mix of pool sizes,
ranging from single sample test to very large pools. The test results are then combined to generate
an accurate estimation for a wide range of infection probabilities. This solves the problem of
choosing the pool size (which requires an initial guess of the probability). As an example, using
only 100 tests, we can estimate the infection probability at an accuracy of ±25% over all the
probability range from 10−3 to 0.5.
In the following we first consider pool testing with fixed pool size, and then present the
variable pool size approach.
II.

PERFORMANCE ANALYSIS FOR CONSTANT POOL SIZE

We consider the estimation of the spread of disease in a given population. Denote the population size by L and the number of infected by Li . We define the probability of finding an infected
sample by: p =

April 8, 2020

Li
.
L

We consider the estimation accuracy given a limited number of tests T .

DRAFT

3

For the initial step, we assume that all pools are of equal size N. A pool test is positive if at
least one of its samples is positive. Thus, δi , the result of test i will have a binary distribution,
with:
Pr(δi = 0) = (1 − Pr(δi = 1)) = (1 − p)N .

(1)

Note that δi = 1 indicates a positive test for the disease.
Considering a maximum likelihood (ML) estimator, we have:
p̂ = arg max
p

Let w =

PT

i=1

T
Y

(1 − p)N (1−δi ) (1 − (1 − p)N )δi

(2)

i=1

δ i , we take the derivative of the log of (2) with respect to p, and compare to zero:
0 = −N(T − w)

N(1 − p̂)N −1
1
+w
1 − p̂
1 − (1 − p̂)N

(3)

which is solved by:
w 1/N
p̂ = 1 − 1 −
T


(4)

The accuracy of this estimation is presented in figure 1. We measure the accuracy relative to
the actual infection probability. The root mean square error is defined as:
q 

RMSE = E (p̂ − p)2

(5)

and is evaluated using Monte Carlo simulation. The estimation accuracy is defined as
η=

RMSE
.
p

(6)

Note that the accuracy is better if η is smaller. All Monte Carlo simulations in this work use
104 repetitions.
Fig. 1 show the accuracy as a function of the actual infection probability for pool sizes of 10
and 100 as well as without pooling (pool size of 1). The figure demonstrates that pooling can
significantly improve the accuracy. But, it is useful only if the pool size is approximately 1/p.
If the pool size is too small, then the probability to get a positive set is still too small and the
efficiency is reduced. On the other hand, if the pool size is too large, almost all tests will turn
positive and the accuracy degrades very fast.
Thus, to have an efficient test, one must match the pool size to an initial guess of the actual
probability. To avoid the need for such a guess, the next sub-section presents an efficient method
for estimation with variable pool sizes.

April 8, 2020

DRAFT

4

1
0.9
0.8
0.7
0.6

Accuracy,

0.5
0.4
0.3

0.2
Pool size=1
Pool size=10
Pool size=100
0.1
10-3

10-2

10-1

Actual probability, p
Fig. 1. Estimation accuracy vs. the actual infection probability for various pool sizes. The estimation accuracy is defined in (6).
(Recall the lower values of η represent better accuracy.)

III. G ENERAL

POOL SIZES

A. Probability estimation
We next consider a general pooling scheme where the pool of test i is of size Ni . Thus, δi ,
is a binary distribution, with:
Pr(δi = 0) = (1 − Pr(δi = 1)) = (1 − p)Ni

(7)

(and again, δi = 1 indicates a positive test for the disease).
The ML estimate of the infection probability, p, from a set of T tests with pool sizes
N1 , N2 , . . . , NT is given by:
T
Y
p̂ = arg max (1 − p)Ni (1−δi ) (1 − (1 − p)Ni )δi
p

April 8, 2020

(8)

i=1

DRAFT

5

Taking the derivative of the log of (8), and comparing to zero:
0=

T
X

Ni

T
X

Ni (1 − δi ) − δi

i=1

=

Ni (1 − p̂)Ni −1
1
(1 − δi ) − δi
1 − p̂
1 − (1 − p̂)Ni

i=1

Thus, the ML estimator is the solution to

T
X
Ni 1 −
i=1

Ni (1 − p̂)Ni
.
1 − (1 − p̂)Ni

δi
1 − (1 − p̂)Ni



= 0.

(9)

(10)

(11)

In this case, the ML estimator does not have a closed form expression. Yet, the left hand side
of Equation (11) is monotonic increasing with p̂. Hence, the ML estimator can be efficiently
calculated by solving (11) using a binary search.
B. Choosing the pool sizes
As shown above, the probability estimate will benefit most from a pool size which is approximately N = 1/p. In this approach we wish to measure a large range of possible infection
probabilities, p. Thus, we need to use pool size with wide range of sizes. To do so, we suggest
to select the pool sizes in a logarithmic manner, that is:
Ni = ⌈N0 · q i ⌋

(12)

for i = 0, . . . , T − 1, where N0 is the size of the smallest pool and q > 1 is the logarithmic
spacing. We use the notation ⌈·⌋ to indicate rounding to the nearest integer.
If the desired range of measure probabilities is pmin < p < pmax , then it is important to have
N0 < 1/pmax and N0 · q T −1 > pmin . Thus, the choice of q represents a tradeoff between a large
measurement range and the measurement accuracy. This is demonstrated in Fig. 2, where the
estimation accuracy, η, is depcited as a function of the actual infection probability for T = 50
tests, N0 = 1 and q = 1.1, q = 1.15 and q = 1.2. The figure shows the the logarithmic choice
of pool sizes indeed keeps the estimation accuracy nearly constant, but only within the dynamic
range of the measurements. For the values of this figure we have N0 · q T −1 = 107, 942 and 7584
for the values of q give above. Indeed, we see that the estimation accuracy starts to deteriorate
around 1/(N0 · q T −1 ), that is around 0.009, 0.001 and 0.00013 respectively. Note that even using
the larger q in this simulation, the accuracy of ±40% is quite good, as this error is obtained in
a measurement that covers three order of magnitudes of the actual probability.

April 8, 2020

DRAFT

6

1
0.9

q=1.1
q=1.15
q=1.2

0.8
0.7

Accuracy,

0.6
0.5
0.4

0.3

0.2
10-4

10-3

10-2

10-1

Actual probability, p
Fig. 2. Estimation accuracy vs. the actual infection probability for various q values.

C. Practical example
We next present a last set of simulations that demonstrates the efficiency of the suggest
approach for a fast and efficient measurement of the infection probability. We choose the
measurement design to cover the range 10−3 < p < 0.5. Using T = 100 tests, we use N0 = 1
and q = 1.085 (such that q T −1 = 103.5 ). The resulting accuracy is depicted by the solid line with
x-markers in Fig. 3. The figure demonstrates that using only 100 tests, we can get an estimation
accuracy of 25% over the whole probability range.
The main drawback of this approach is that it requires many samples. The example above used
100 tests, but required a total of 40, 439 samples (mixed in the various pools). This is sometimes
a problem, as it may be difficult to persuade these many people to come to test. Thus, the figure
also depicts the accuracy when the measurement is limited only to 1000 samples. In this case,
we adjust the q to achieve a logarithmic spacing such that the sum of all pool sizes in 1000 (i.e.,
q = 1.03708).
Such a limiting of the total number of tests obviously limits the capability of measuring very

April 8, 2020

DRAFT

7

1
0.9
0.8
0.7

Total sample size = 41,061
Total sample size = 1000
1000 Samples

0.6

Accuracy,

0.5
0.4
0.3

0.2

10-3

10-2

10-1

Actual probability, p
Fig. 3. Estimation accuracy vs. the actual infection probability. The solid lines uses 100 samples, one is optimized for accuracy,
while the other is limited to 1000 patients. The dashed line uses 1000 samples and performs individual test for each sample.

low infection probabilities. The resulting accuracy is shown by the solid line with o-markers. The
use of smaller pool sizes improves the accuracy at higher infection probabilities, but is indeed
limited at low infection probabilities. As a comparison, we plot also the estimation accuracy
of the conventional approach, i.e., taking 1000 samples and performing individual test to each
sample (1000 tests). This conventional approach requires much more resources. Yet, it gives
significant advantage only if the infection probability is above 0.05.
Fig. 4 depicts the performance for a similar scenario, but using only 50 tests. The figure shows
the performance using our suggested pool sizes (N0 = 1, q = 1.1788 total of 20, 868 samples),
and the performance with using only 1000 samples (N0 = 1, q = 1.09578). The figure show the
95% confidence interval of the estimation for each actual infection probability. The figure shows
that even only 50 tests can give reasonable estimations when the pool size is not limited. Even
with a limit of only 1000 samples, the estimation deteriorates only below p = 10−2 . Moreover,
even in this case, the estimates still give a good upper-bound on the infection probability.

April 8, 2020

DRAFT

8

Estimated probability

100

10-1

10-2

10-3
Actual probability
95% estimates, Total sample size = 20,868
95% estimates, Total sample size = 1000
10-4
10-3

10-2

10-1

100

Actual probability, p
Fig. 4. 95% confidence interval for practical estimation with T = 50 tests.

IV. C ONCLUSIONS

AND FUTURE WORK

We presented a method for efficient estimation of infection probability using a small number of
tests. The method is based on pool testing with variable pool sizes. It is shown that proper choice
of pool sizes leads to accurate estimations even with small number of tests. For example, using
100 tests was shown to achieve 25% accuracy over a wide range of actual infection probabilities.
Even a set of only 50 tests over only 1000 samples was shown to produce reasonable estimation.
Further research is required in order to accommodate for false alara (false positive) and miss
detection (false negative) probabilities. In particular, it can be assumed that these error probability
can increase with the pool size and hence effect the choice of pool sizes. Pool tests for COVID19 was so far demonstrated for up to 64 samples in a pool, with small enough errors [7]. The
data in that work can give an initial estimate on the behavior of the error probabilities, and hence
used to improve the estimation and the pool size design.

April 8, 2020

DRAFT

9

R EFERENCES
[1] R. Dorfman, “The detection of defective members of large populations,” The Annals of Mathematical Statistics, vol. 14,
no. 4, pp. 436–440, 1943.
[2] C. R. Bilder and J. M. Tebbs, “Pooled-testing procedures for screening high volume clinical specimens in heterogeneous
populations,” Statistics in medicine, vol. 31, no. 27, pp. 3261–3268, 2012.
[3] E. Litvak, X. M. Tu, and M. Pagano, “Screening for the presence of a disease by pooling sera samples,” Journal of the
American Statistical Association, vol. 89, no. 426, pp. 424–434, 1994.
[4] N. T. Nguyen, H. Aprahamian, E. K. Bish, and D. R. Bish, “A methodology for deriving the sensitivity of pooled testing,
based on viral load progression and pooling dilution,” Journal of translational medicine, vol. 17, no. 1, p. 252, 2019.
[5] S. M. Taylor, J. J. Juliano, P. A. Trottman, J. B. Griffin, S. H. Landis, P. Kitsa, A. K. Tshefu, and S. R. Meshnick, “Highthroughput pooling and real-time pcr-based strategy for malaria detection,” Journal of clinical microbiology, vol. 48, no. 2,
pp. 512–519, 2010.
[6] M. Arnold, M. Slomka, V. Coward, S. Mahmood, P. Raleigh, and I. Brown, “Evaluation of the pooling of swabs for
real-time pcr detection of low titre shedding of low pathogenicity avian influenza in turkeys,” Epidemiology & Infection,
vol. 141, no. 6, pp. 1286–1297, 2013.
[7] I. Yelin, N. Aharony, E. Shaer-Tamar, A. Argoetti, E. Messer, D. Berenbaum, E. Shafran, A. Kuzli, N. Gandali,
T. Hashimshony, Y. Mandel-Gutfreund, M. Halberthal, Y. Geffen, M. Szwarcwort-Cohen, and R. Kishony, “Evaluation
of covid-19 rt-qpcr test in multi-sample pools,” medRxiv, 2020.
[8] N. Sinnott-Armstrong, D. Klein, and B. Hickey, “Evaluation of group testing for sars-cov-2 rna,” medRxiv, 2020.
[9] M. Schmidt, L. Pichl, C. Jork, M. Hourfar, V. Schottstedt, F. Wagner, E. Seifried, T. Müller, J. Bux, and J. Saldanha,
“Blood donor screening with cobas s 201/cobas taqscreen mpx under routine conditions at german red cross institutes,”
Vox sanguinis, vol. 98, no. 1, pp. 37–46, 2010.
[10] D. Wang, C. S. McMahan, and C. M. Gallagher, “A general regression framework for group testing data, which incorporates
pool dilution effects,” Statistics in medicine, vol. 34, no. 27, pp. 3606–3621, 2015.
[11] G. K. Atia and V. Saligrama, “Boolean compressed sensing and noisy group testing,” IEEE Transactions on Information
Theory, vol. 58, no. 3, pp. 1880–1901, 2012.
[12] Y. Bai, Q. Wang, C. Lo, M. Liu, J. P. Lynch, and X. Zhang, “Adaptive bayesian group testing: Algorithms and performance,”
Signal Processing, vol. 156, pp. 191–207, 2019.
[13] N. T. Nguyen, E. K. Bish, and H. Aprahamian, “Sequential prevalence estimation with pooling and continuous test
outcomes,” Statistics in medicine, vol. 37, no. 15, pp. 2391–2426, 2018.

April 8, 2020

DRAFT

