Detection of Covid-19 Patients with Convolutional
Neural Network Based Features on Multi-class
X-ray Chest Images
Ali Narin1

arXiv:2012.05525v1 [eess.IV] 10 Dec 2020

1

Department of Electrical and Electronics Engineering, Zonguldak Bulent Ecevit University, Zonguldak, Turkey
alinarin@beun.edu.tr

Abstract—Covid-19 is a very serious deadly disease that has
been announced as a pandemic by the world health organization
(WHO). The whole world is working with all its might to end
Covid-19 pandemic, which puts countries in serious health and
economic problems, as soon as possible. The most important
of these is to correctly identify those who get the Covid-19.
Methods and approaches to support the reverse transcription
polymerase chain reaction (RT-PCR) test have begun to take
place in the literature. In this study, chest X-ray images, which
can be accessed easily and quickly, were used because the covid19 attacked the respiratory systems. Classification performances
with support vector machines have been obtained by using the
features extracted with residual networks (ResNet-50), one of the
convolutional neural network models, from these images. While
Covid-19 detection is obtained with support vector machines
(SVM)-quadratic with the highest sensitivity value of 96.35%
with the 5-fold cross-validation method, the highest overall
performance value has been detected with both SVM-quadratic
and SVM-cubic above 99%. According to these high results, it
is thought that this method, which has been studied, will help
radiology specialists and reduce the rate of false detection.
Keywords—covid-19, convolutional neural network, SVM, prediction, feature extraction.

with feature extraction and classification [4], [5], [6], studies
performed with convolutional neural networks without external
feature extraction, which are among the end-to-end methods
[7], [8], [9] are studies with segmentation methods [10], [11].
In this study, a 3-class (Covid-19, Normal, Viral Pneumonia)
detection study has been carried out with the help of SVM
using feature maps obtained from the ResNet-50 model, which
is a convolutional neural network (CNN). 1x1000 attribute
map was obtained from each image. The study has been carried
out in 10 replicates with 5-fold cross validation method.
In the following sections, the data used in the study, the
convolutional neural network and model used, support vector
machines, performances criteria and results will be mentioned.

A. Database
In this study, 3-class datasets are used, which are available
to everyone on the Kaggle website. The data set consists of
219 ”Covid-19”, 1341 ”Normal” and 1345 ”Viral Pneumonia”
X-ray chest images shown as an example in Fig 1 [12]. Each
image in the data set is 1024x1024 data.

I. I NTRODUCTION
Coronavirus is an infectious virus seen in animals and
humans. The new coronavirus disease, a member of the
coronavirus family, which broke out in late December is
caused by the SAR-CoV-2 virus [1]. This infectious disease,
known as Covid-19 in the literature, attacks the respiratory
system directly, so symptoms of fever, cough, and shortness
of breath are frequently observed. In advanced cases, it causes
inflammation of the air sacs in the lungs such as known as
pneumonia [2].
The epidemic’s spread around the world has seriously
damaged the economies and health systems of countries. For
this reason, the biggest effort of all countries recently is to end
the epidemic. For this, it is very important to detect and isolate
those who have Covid-19 disease at an early stage. Detection
of the presence of Covid-19 by reverse transcription polymerase chain reaction (RT-PCR) tests is of vital importance
[3]. Due to its low sensitivity and time consuming, alternative
fast and effective methods are needed to be developed. In this
context, there are some studies conducted with lung imaging
methods (X-ray or CT). Some of them are as follows: Studies

Fig. 1: X-ray images a) Covid-19 b) Normal c) Viral Pneumonia.

B. Convolutional Neural Networks
The most widely known and used deep learning models
are convolutional neural networks. CNN consists of one or
more convolution layers, pooling layers and fully connected
layers. Dropout etc. can be added in different layers. One of
the biggest advantages of CNN models is that the model is
realized using data directly in the training process [13]. The
extraction of feature maps takes place in the convolution and

pooling layers. The classification process takes place at the
end of the fully connected layer.
Defining Data: Standard size data is given as input to the
network. The important thing here is the size of the data.
Performance may vary depending on the model used.
Convolution layers: The convolution layer is the most basic
layer from which CNN is named. By sliding the filters used
here over the image, the feature maps of the image are created
at the output.
Pooling layers: In this layer, the prominent parts of the
obtained feature maps are obtained. The feature map is updated with the smallest, largest, average values etc. among the
measures determined on the map. However, there may be loss
of information in this layer..
Fully Connected Layers: It is the layer added to the model
after the feature maps are created. It has a feature that brings
together all the layers before it. For example, 10x10x10 data
is converted to 1x1000 and operations are performed.
C. Feature Extraction using ResNet-50 Convolutional Neural
Network
The use of CNN models has become quite common in recent
years. There are many models in the literature. The fact that the
models have different depths and the number of data increases
day by day significantly affect the training period. For this,
the use of pre-trained models is preferred to overcome this
problem. In this study, the ResNet-50 model consisting of
5 convolution blocks and 50 layers in total was used [14].
1x1, 3x3 and 1x1 operations are applied in convolution blocks.
Different feature maps are obtained from images with filters
of different sizes. The features used in the study have been
obtained from the fully connected layer in 1000x1 dimensions.
D. Support Vector Machines

E. Performance Metrics
The classification performance of the obtained features on
SVM was measured with 3 parameters. These are expressed
as [17]:
=

SP E

=

ACC

=

TP
TP + FN
TN
TN + FP
TP + TN
TP + TN + FP + FN

Fig. 2: Representaton of 5-fold cross validation methods.

II. RESULTS

SVM algorithm, which was introduced for the first time
in 1963, is a supervised learning approach based on the
statistical learning theory [15], [16]. It is widely used in
linear and nonlinear classification problems. The purpose of
the algorithm is to determine the support vectors that provide
the clearest distinction between classes and to draw the line
called the hyper plane. It provides separation of classes that
are not separated linearly from kernel functions. In this study,
results for different functions have been obtained by using
linear, cubic and quadratic functions.

SEN

Here, the number of those who are really Covid-19 patients
and found as Covid-19 patients by the classifier is expressed
as TP and the number of those who are mistakenly found in
the form of other classes as FN, the number of those who
are really non-Covid-19 patients and found as non-Covid-19
patients by the classifier is expressed as TN and the number
of those who are mistakenly found in Covid-19 patients by the
classifier is expressed as FP. Using these values, the classifier
performances, sensitivity (SEN), specificity (SPE) and general
performance (ACC) values were calculated. The SEN value
gives the performance of those with Covid-19, the performance
of the classes whose SPE value is out of Covid-19, and the
ACC is general performance values.
5-fold cross validation method was used to obtain a more
stable result. As shown in Fig 2, the whole data set is divided
into 5-fold. One part of it is reserved for testing, while (k-1)
is reserved for training. This process is repeated until the last
fold reserved for testing has been tested. In addition, the whole
study was repeated 10 times and averaged and performance
values were recorded.

(1)
(2)
(3)

In this study, first of all, all data downloaded from the
Kaggle page were made available for the study. In addition,
all images were converted from 1024x1024 size to 224x224
size via MATLAB 2020a without pre-processing. All these
transformed images were provided as input to the pre-trained
ResNet-50 convolutional network model. 1000 features were
obtained for each of 2905 data from the layer just before the
classification layer. It was submitted to SVM as input with a
size of 2905x1000. All these operations performed are given
in the flow diagram presented in Figure 3. All the results
obtained from this study performed with 3 different functions
are presented in Table 1.
The performance of 3 different classes for 3 different SVMs
are shown in Table 1. The success of Covid-19 patients detected with the SVM-Quadratic approach is higher than other
approaches. At the same time, it is clearly seen that the SVM
Quadratic approach gives higher results than other methods
in determining healthy individuals, ie normal individuals. For
Viral Pneumonia, the SVM-Quadratic approach yielded the
highest results. It is clear that the overall performance (ACC)
results can also be detected with an accuracy of over 99%. In

Fig. 3: Flow diagram of the study.
TABLE I: P ERFORMANCE RESULTS FOR 3 DIFFERENT SVM
ALGORITHMS .
Methods

Class

SEN

SPE

ACC

SVM Linear

Covid-19

94.52

99.70

98.90

Normal

96.87

95.52

94.77

Viral Pneumonia

94.72

96.99

93.65

Covid-19

96.35

99.85

99.31

Normal

97.02

96.23

95.28

Viral Pneumonia

95.84

97.37

94.83

Covid-19

95.89

99.96

99.35

Normal

96.57

95.84

94.68

Viral Pneumonia

95.54

96.86

94.30

Fig. 4: Confusion matrix for SVM (linear).

SVM Quadratic

SVM Cubic

addition to these performance metrics, the Confusion matrixes
for all SVM types are given in Figure 4, Figure 5 and Figure
6. It is clearly seen in Figure 5 that 211 of 2019 Covid19 patients have been successfully detected. The receiver
operating characteristic curve (ROC) is also given in Figure
7 shows that the Area Under the ROC Curve (AUC) value is
quite high for the Covid-19 class.
The results obtained are more successful than many studies
performed with manual feature extraction methods on Covid19 in the literature. This study, in which the feature maps
obtained from the model are used, is one of the advantageous
parts of using the raw data directly and obtaining the features
directly without any separate mathematical processing other
than the model.
These results are thought to benefit experts during the
Covid-19 outbreak. Even if the symptoms are thought to occur
late, its use in the follow-up of patients in the most optimistic
aspect will relieve the health community.

Fig. 5: Confusion matrix for SVM (quadratic).

Based on the results obtained, it is necessary to repeat
the study with much more data in order to make a general
judgment. In future studies, the data set will be increased
and the study will be detailed by using different convolution
models.
III. C ONCLUSION
In this paper, a multi-class study of Covid-19, Normal and
Viral Pneumonia has been made using the SVM algorithm and
the features extracted from the X-ray chest images with the
help of the ResNet-50 deep learning model. With the study
carried out, it has been revealed that the deep learning-based
models can be used to extract the features directly and classify

Fig. 6: Confusion matrix for SVM (cubic).

Fig. 7: ROC curve for SVM (quadratic).

them with different classifiers. It gives very high results even
for a limited number of Covid-19 data.
R EFERENCES
[1] Xu, Z., Shi, Y., Wang, Y., Zhang, J., Huang, L. Zhang, C. and et al.,
“Pathological findings of COVID-19 associated with acute respiratory
distress syndrome,” Lancet Respir Med, 8: 420-422, 2020.
[2] Roudsari, P. P., Alavi-Moghadam, S., Payab, M. and et al.,”Auxiliary role
of mesenchymal stem cells as regenerative medicine soldiers to attenuate
inflammatory processes of severe acute respiratory infections caused by
COVID-19,” Cell Tissue Bank, 21:405-425, 2020.

[3] Waller, J. V., Allen, I.E., Lin, K.K., Diaz, M.J., Henry, T.S. and Hope,
M.D., The Limited Sensitivity of Chest Computed Tomography Relative
to Reverse Transcription Polymerase Chain Reaction for Severe Acute
Respiratory Syndrome Coronavirus-2 Infection: A Systematic Review on
COVID-19 Diagnostics,” Invest radiol, 2020.
[4] Ozturk, S., Ozkaya, U. and Barstugan, M., ”Classification of coronavirus
images using shrunken features,” medRxiv, 2020.
[5] Wei, W., Hu, X., Cheng, Q. and et al., “Identification of common and
severe COVID-19: the value of CT texture analysis and correlation with
clinical characteristics,” Eur Radiol, 2020.
[6] Elaziz, M. A., Hosny, K. M., Salah, A., Darwish, M. M., Lu, S., and
Sahlol, A. T., “New machine learning method for image-based diagnosis
of COVID-19,” Plos one, 15(6), e0235187, 2020.
[7] Narin, A., Kaya, C. and Pamuk, Z., ”Automatic detection of coronavirus
disease (covid-19) using x-ray images and deep convolutional neural
networks,” arXiv preprint arXiv:2003.10849 (2020).
[8] Mahmud, T, Rahman, M. A., and Fattah, S. A., ”CovXNet: A multidilation convolutional neural network for automatic COVID-19 and other
pneumonia detection from chest X-ray images with transferable multireceptive feature optimization.” Comput biol med, 122: 103869, 2020.
[9] Ozturk, T., Talo, M., Yildirim, E. A., Baloglu, U. B., Yildirim, O. and
Acharya, U. R., “Automated detection of COVID-19 cases using deep
neural networks with X-ray images.” Comput biol med,103792, 2020.
[10] Fan, D. P., Zhou, T., Ji, G. P., Zhou, Y., Chen, G., Fu, H., Shen, J. and
Shao, L., “Inf-Net: Automatic COVID-19 Lung Infection Segmentation
from CT Images.” IEEE Trans Med Imaging, 2020.
[11] Wu, Y.H., Gao, S.H., Mei, J., Xu, J., Fan, D.P., Zhao, C.W. and
Cheng, M.M., “JCS: An explainable COVID-19 diagnosis system by joint
classification and segmentation.” arXiv preprint arXiv: 2004.07054, 2020.
[12] Rahman T., Chowdhury M. E. H, Khandakar A., Mazhar R., Kadir M.
A., Mahbub Z.B., Islam K. R., Khan M. S., Iqbal A., Al-Emadi N.,
Ibne Reaz M. B., “COVID-19 chest radiography database.” Available:
https://www.kaggle.com/tawsifurrahman/covid19-radiography-database.
[13] Schmidhuber, J., “Deep Learning in neural networks: an overview”
Neural Netw, 61: 85-117, 2015.
[14] He, K., Zhang, X., Ren, S., and Sun, J. Deep residual learning for image
recognition, CVPR (2016).
[15] Vapnik, V., Statistical Learning Theory, Wiley, New York, 1998.
[16] Vapnik, V., The Nature of Statistical Learning Theory, Springer, Berlin,
1995.
[17] Narin, A., Işler, Y., and Ozer,, M., ”Early prediction of Paroxysmal Atrial
Fibrillation using frequency domain measures of heart rate variability,”
2016 Medical Technologies National Congress, Antalya, Turkey, 1-4,
2016.

