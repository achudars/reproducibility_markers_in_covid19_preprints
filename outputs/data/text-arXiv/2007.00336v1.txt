ON THE MINIMIZATION OF SOBOLEV NORMS OF TIME-VARYING GRAPH SIGNALS:
ESTIMATION OF NEW CORONAVIRUS DISEASE 2019 CASES
Jhony H. Giraldo and Thierry Bouwmans

arXiv:2007.00336v1 [eess.SP] 1 Jul 2020

Laboratoire MIA, La Rochelle Universit, France
{jgiral01, tbouwman}@univ-lr.fr
ABSTRACT
The mathematical modeling of infectious diseases is a fundamental research field for the planning of strategies to contain
outbreaks. The models associated with this field of study usually have exponential prior assumptions in the number of new
cases, while the exploration of spatial data has been little analyzed in these models. In this paper, we model the number
of new cases of the Coronavirus Disease 2019 (COVID-19)
as a problem of reconstruction of time-varying graph signals.
To this end, we proposed a new method based on the minimization of the Sobolev norm in graph signal processing.
Our method outperforms state-of-the-art algorithms in two
COVID-19 databases provided by Johns Hopkins University.
In the same way, we prove the benefits of the convergence rate
of the Sobolev reconstruction method by relying on the condition number of the Hessian associated with the underlying
optimization problem of our method.
Index Terms— COVID-19, Sobolev norm, time-varying
graph signals, signal reconstruction
1. INTRODUCTION
The Coronavirus Disease 2019 (COVID-19) brought an unprecedented sanitarian crisis around the world in 2020 [1]
with a pandemic. Several developed countries such as the
United States of America (USA), Italy, Spain, France, the
United Kingdom, among others, have had problems trying
to contain the outbreak. The capacity of some countries to
detect new cases has been overwhelmed by the exponential
number of cases, leading to a poor and unreliable estimation
of the number of new cases. As a matter of fact, Colombia
slowed down the testing of suspected new cases of COVID19 between March 25th and 27th in 2020 because of a failure
in an essential machine for the COVID-19 diagnosis.
The mathematical modeling of infectious diseases is an
old and well-established research field [2, 3], these infectious
models are either stochastic or deterministic and use basic
assumptions. Specifically in COVID-19, Wang et al. [4] used
a Susceptible, Exposed, Infectious, and Removed (SEIR)
model to estimate the epidemic trend in Wuhan, China. How-

ever, this model does not take into account the underlying
spatial information of the problem, i.e., the model does not
associate the number of new cases in nearby localities. In the
same way, not all countries are able to effectively sample the
number of infected people in their population.
In this work, we model the number of new COVID-19
cases as a reconstruction of time-varying graph signals [5–7].
Our algorithm associates a graph to the geographical localization of cities or countries, and the number of new COVID-19
cases is represented by a graph signal that evolves in time
[8–10]. Intuitively, the prior assumption of this work is that
the number of new COVID-19 cases is smooth both in the
graph and in time, i.e., the number of new COVID-19 cases
should be similar in nearby localities, and the change in time
is progressive. Unlike previous mathematical models of infectious diseases, this paper takes into account the underlying spatial information of the problem. In the same way, we
propose a new time-varying graph signals reconstruction algorithm based on the minimization of the Sobolev norm of
Graph Signal Processing (GSP) [11]. Our method outperforms state-of-the-art algorithms in time-varying graph signals, while showing convergence rate benefits based on the
Hessian of the underlying problem. The main contributions
of this paper are summarized as follows:
• To the best of our knowledge, concepts of GSP are introduced for the first time in the domain of infectious
diseases modeling.
• A new algorithm based on the minimization of the
Sobolev norm is introduced in the problem of timevarying graph signals reconstruction.
• We show the convergence rate benefits on the minimization of the Sobolev norm for the reconstruction of
time-varying graph signals.
The rest of the paper is organized as follows. Section 2
explains the basic concepts and the proposed method. Section
3 introduces the experimental framework. Finally, Sections 4
and 5 present the results and conclusions, respectively.

Fig. 1. Graph with the regions in the world with confirmed
cases of COVID-19 by April 6, 2020. This graph was constructed with k-nearest neighbors with k = 5.
2. TIME-VARYING GRAPH SIGNALS
RECONSTRUCTION
This section presents the mathematical notation, basic concepts of this paper, as well as the proposed Sobolev norm
reconstruction algorithm. Figure 1 shows a graph with the
regions in the world with confirmed cases of COVID-19 by
April 6, 2020.
2.1. Notation
In this paper, uppercase boldface letters such as X represent matrices, and lowercase boldface letters such as x denote
vectors. Calligraphic letters such as E represent sets. The
Hadamard and Kronecker products between matrices are denoted by ◦ and ⊗, respectively. (·)T denotes transposition.
The vectorization of a matrix A is denoted as vec (A), while
diag(x) is a diagonal matrix with entries x1 , x2 , . . . , xn . The
trace and Frobenius norm of a matrix are represented by tr(·)
and k · kF , respectively.
2.2. Background
Let G = (V, E) be a graph with V = {1, . . . , N } the set of
N nodes. E = {(i, j)} represents the set of edges, where
(i, j) is an edge between the nodes i and j. W ∈ RN ×N is
the weighted adjacency matrix of G, with W(i, j) > 0 ⇔
{i, j} ∈ E. This paper is focused in undirected graphs, then
W is symmetric, i.e., the edges (i, j) and (j, i) have the same
weight. D ∈ RN ×N is a diagonal matrix such that D(i, i) =
PN
j=1 W(i, j) ∀ i = 1, . . . , N . Furthermore, L = D − W
is the positive semi-definite combinatorial Laplacian operator of G, with eigenvalues 0 = λ1 ≤ λ2 ≤ · · · ≤ λN and
corresponding eigenvectors {u1 , u2 , . . . , uN }. And finally, a
graph signal is a function in V such that x : V → R, and it can
be represented as a vector x ∈ RN where x(i) is the value of
the function in the node i ∈ V.

The sampling and reconstruction of graph signals play a
central role in GSP [12–15]. Several algorithms for sampling
and recovery assume that the graph signal is smooth in the
graph. One well-known measure of smoothness in G is the
graph Laplacian quadratic form defined as S2 (x) = xT Lx.
For example in reconstruction, Puy et al. [16] used this Laplacian quadratic form as a regularization term in the formulation
of their optimization problem. However, the graph Laplacian
quadratic form S2 (x) is limited to static graph signals in G.
Qiu et al. [10] extended the definition of S2 to time-varying
graph signals. Let X = [x1 , x2 , . . . , xM ] be a time-varying
graph signal, where xt is a graph signal in G at time t. The
smoothness of time-varying graph signals X is such that [10]:
S2 (X) = tr(XT LX).

(1)

Equation (1) sums all the Laplacian quadratic form for each
1 < t < M , i.e., there is not a temporal relationship between
graph signals in different times t.
Qiu et al. [10] introduced the temporal difference operator Dh ∈ RM ×(M −1) with the purpose of including temporal
information in the problem of time-varying graph signal reconstruction such that:


−1

 1 −1




..
 ∈ RM ×(M −1) ,

.
1
(2)
Dh = 



.
.

. −1
1
and the temporal difference signal as:
XDh = [x2 − x1 , x3 − x2 , . . . , xM − xM −1 ].

(3)

Qiu et al. [10] also proposed two time-varying graph signal
reconstruction batch methods. The first method is focused in
the noiseless case, while the second method approaches the
noisy case. In this paper we focus in the noisy case defined as
follows:

λ 
1
min kJ ◦ X̂ − Yk2F + tr (X̂Dh )T LX̂Dh ,
2
X̂ 2

(4)

where J ∈ {0, 1}N ×M is the sampling matrix for the whole
time-varying graph signal, and Y ∈ RN ×M is the matrix of
observed values (the data that we know). J is defined as follows:
(
1 if i ∈ St ,
J(i, j) =
(5)
0 if i ∈
/ St ,
where St is the set of sampled nodes at time t. Basically, Eqn.
(4) is trying to reconstruct a time-varying graph signal X̂ with
a small error kJ◦ X̂−Yk2F while minimizing the smoothness
of the temporal difference graph signal.

2.3. Graph Construction
Let M ∈ RN ×2 be the matrix of locations of all nodes in V
such that M = [m1 , . . . , mN ]T , where mi ∈ R2 is the vector with latitude and longitude of node i. A k-nearest neighbors algorithm with k = 10 is used to connect the nodes in
the graph for the experiments in this paper. The weight of
2
the edge (i, j) is such that W(i, j) = exp (− d(i,j)
σ 2 ), where
d(i, j) = kmi − mj k2 is the euclidean distance between
nodes (i, j), and σ 2 is the standard deviation of the Gaussian
function computed as follows:
σ=

X
1
d(i, j).
|E| + N

(6)

(i,j)∈E

2.4. Sobolev Norm Reconstruction of Time-Varying Graph
Signals
In this paper, we propose a new time-varying graph signals
reconstruction algorithm inspired by the minimization of the
Sobolev norm in GSP. The definition of this norm was given
by Pesenson et al. [11], who used the Sobolev norm to introduce the variational problem in graphs.
Definition 1 For a fixed  ≥ 0, the Sobolev norm is defined
as follows:
kf kβ, = k(L + I)β/2 f k, β ∈ R.

(7)

From Theorem 1, we can notice that the condition number of
(L + I) is lower bounded by σmax (L + I)/, i.e., greater
values of  could end up in better condition numbers. In the
same way, we have that κ(L + I) < ∞ since σmin (L + Ψ)
is strictly greater than zero according to Theorem 2, while
κ(L) = ∞ because the first eigenvalue of L is zero, i.e., we
are improving the condition number of L when adding the
perturbation matrix I. In this paper, we use this fact to show
that the convergence rate of the Sobolev norm is better than
the graph Laplacian quadratic form when solving with gradient descent.
Firstly, we need to extend the definition of the Sobolev
norm to time-varying graph signals as follows (given that L
is a symmetric matrix):
kXkβ, =

M
X

β
T
β
xT
i (L + I) xi = tr(X (L + I) X). (11)

i=1

The Sobolev reconstruction problem for time-varying graph
signals is formulated as follows:

λ 
1
min kJ ◦ X̂ − Yk2F + tr (X̂Dh )T (L + I)β X̂Dh ,
2
X̂ 2
(12)
where we used the temporal difference operator in Eqn. (2),
and the Sobolev norm of time-varying graph signals in Eqn.
(11). Equation (12) is solved with conjugate gradient method
in this paper.

When L is symmetric, Eqn. (7) can be rewritten as follows:
f T (L + I)β f

2.5. Rate of Convergence
(8)

Giraldo and Bouwmans [17] found that the term (L + I)
in the Sobolev norm in Eqn. (7) has a better condition number
than L, they used the following theorems:
Theorem 1 Let Ψ ∈ RN ×N be a perturbation matrix. Given
a combinatorial Laplacian matrix L, the term L + Ψ has a
lower and upper bound in the condition number such that:
σmax (L + Ψ)
σmax (L) + σmax (Ψ)
≤ κ(L + Ψ) ≤
,
σmax (Ψ)
σmin (L + Ψ)

(9)

where κ(L + Ψ) is the condition number of L + Ψ.
Proof: see [17].
Theorem 2 Let L and Ψ be Hermitian matrices with set of
eigenvalues {λ1 , . . . , λN } and {ψ1 , . . . , ψN }, respectively.
The matrix L+Ψ has a set of eigenvalues {ν1 , . . . , νN } where
the following inequalities hold for i = 1, . . . , N :
λi + ψ1 ≤ νi ≤ λi + ψN .
Proof: see [18].

(10)

The rate of convergence of the Sobolev norm reconstruction
in Eqn. (12) is better than the rate of convergence of the
method involving the graph Laplacian quadratic form in Eqn.
(4). Intuitively, we are improving the condition number of the
Sobolev norm with respect to the Laplacian quadratic form as
shown in Section 2.4. As a consequence, one can expect that
the Sobolev reconstruction problem is better conditioned, and
then a gradient descent method can arrive faster to the global
minimum (when the optimization problem is convex).
Formally, the rate of convergence of a gradient descent
method is at best linear. This rate can be accelerated if the
condition number of the Hessian of the cost function is reduced [19]. Qiu et al. [10] showed that the problem in Eqn.
(4) can be rewritten as follows:
1
λ
min kQ[z − vec (Y)]k22 + zT [(Dh DT
h ) ⊗ L]z = f (z),
z 2
2
(13)
where Q = diag(vec (J)) ∈ RM N ×M N , and z = vec (X̂).
In the same way, the Hessian matrix of f (z) in Eqn. (13) is
such that:
∇2z f (z) = Q + λ(Dh DT
h ) ⊗ L.

(14)

Using a similar rationale, the Hessian matrix associated with
the Sobolev reconstruction problem is such that:
β
∇2z f (z) = Q + λ(Dh DT
h ) ⊗ (L + I) .

(15)

If we analyze the condition number of the second term in Eqn.
(14) we get:
T
κ(λ(Dh DT
h ) ⊗ L) = κ(Dh Dh )κ(L),

(16)

where we applied the following property [20]:
κ(A ⊗ B) := kA−1 kkAkkB−1 kkBk = κ(A)κ(B). (17)
Similarly, the condition number of the second term in Eqn.
(15) is:
β
T
β
κ(λ(Dh DT
h ) ⊗ (L + I) ) = κ(Dh Dh )κ((L + I) ). (18)

Then for β = 1 and  > 0, we know from Section 2.4 that
κ(L + I) < κ(L) and then:
T
κ(Dh DT
h )κ(L + I) < κ(Dh Dh )κ(L).

(19)

As a consequence, we have that:
T
κ(λ(Dh DT
h ) ⊗ (L + I)) < κ(λ(Dh Dh ) ⊗ L).

(20)

In other words, we are improving the convergence rate of the
Sobolev reconstruction with respect to the problem with the
Laplacian quadratic form by reducing the condition number
of the Hessian associated to these optimization problems.
3. EXPERIMENTAL FRAMEWORK
This section introduces the databases used in this paper, and
the experiments to validate our proposed method.
3.1. Databases
We use the global and the USA COVID-19 databases provided by the Johns Hopkins University [21]. The databases
were used between the dates January 22, 2020 and April 6,
2020. The global dataset contains the cumulative number of
COVID-19 cases for each day and each locality between January 22 and April 6, as well as the geographical localization
of 259 places including some regions of the world (Figure 1
shows the localities in the database). In the same way, the
USA database contains information of 3149 localities about
COVID-19 in the United States. Figure 2 shows the graph
G used in this paper for the USA COVID-19 database. The
sampling period of both databases is 1 day. We pre-processed
the COVID-19 databases to get the number of new cases each
day instead of the cumulative number of cases.
We also use a database of sea surface temperature, and
a dataset of daily mean concentration of Particulate Matter (PM) 2.5 in California for reference purposes. These
databases were used in the paper of Qiu et al. [10].

Fig. 2. Graph with the cities in the United States in the
Johns Hopkins University database [21]. This graph was constructed with k-nearest neighbors with k = 10.
3.2. Experiments
We compare our Sobolev method against Qiu’s algorithm
[10], and Natural Neighbor Interpolation (NNI) [22]. For
each database, we make one experiment to check the performance in all methods, and one additional experiment to
check the convergence rate of our Sobolev algorithm and
Qiu’s method. In the first experiment, for Qiu’s method
we first search the best λ parameter in Eqn. (4) by performing 5 reconstruction for each λ in the set M = {1 ×
10−3 , 1 × 10−2 , 2 × 10−2 , 5 × 10−2 , 0.1, 0.2, 0.5, 1, 2, 5, 10,
20, 50, 1 × 102 , 2 × 102 , 5 × 102 }, and with sampling densities: {0.1, 0.2, . . . , 0.9} for the databases of sea surface
temperature and PM 2.5, and {0.5, 0.6, . . . , 0.9, 0.995} for
the COVID-19 datasets. We use a random sampling strategy
for J, ensuring that each time graph signal xi has the same
amount of sampled nodes for all 1 < i < M . Secondly, we
execute the algorithm with the best λ parameter 100 times
(with different J matrices) for each sampling density. For our
Sobolev method in Eqn. (12) we use the same strategy, but
in this case the best parameters are searched in the cartesian
product M × M for λ ∈ M and  ∈ M. Finally, for NNI we
perform the experiment 100 times for each sampling density.
The second experiment records the number of iterations
required to converge for the reconstruction method in Eqn.
(4) and in Eqn. (12). This experiment is repeated 100 times
for each sampling density using the best parameters λ and 
found in the first experiment for the Sobolev method. For a
fair comparison, both reconstruction methods use the same J
and λ in each repetition.
4. RESULTS AND DISCUSSION
Figure 3 shows the average mean square error in the four
databases using Qiu’s method [10], NNI [22], and our
Sobolev algorithm. Figure 3 shows that our method is better than Qiu’s algorithm and NNI in both global and USA
COVID-19 datasets. The results of NNI are not displayed
in the USA COVID-19 database because its performance is

Fig. 3. Average mean square error using the reconstruction method proposed by Qiu et al. in [10], natural neighbor interpolation
[22], and our method with Sobolev norm, versus the sampling density considering the reconstruction in 4 databases with 100
different sampling matrices J.

Fig. 4. Average number of iterations in logarithmic scale in the y-axis, using the reconstruction method proposed by Qiu et al.
in [10] and our method with Sobolev norm, versus the sampling density considering the reconstruction in 4 databases with 100
different sampling matrices J.
very far from Qiu and Sobolev methods. Our method also
outperforms NNI in the sea surface temperature and PM 2.5
concentration, while having relatively the same performance
with respect to Qiu’s algorithm. Moreover, Figure 4 shows
the average number of iterations with both Qiu’s method and
our proposed Sobolev algorithm, in this case the Sobolev
reconstruction clearly performs better than Qiu’s method for
the COVID-19 databases, and slightly better in the PM 2.5
concentration dataset. The behavior in the number of iterations of both methods in Figure 4 is expected according to the
proofs in Section 2.5. Then, we can argue that our Sobolev
method is better for time-varying graph signals reconstruction
than Qiu’s method [10] for the estimation of new COVID-19
cases.
It is also important to remark that the estimation of new
COVID-19 in the USA dataset shows promising results. This
algorithm could be useful in two scenarios. Firstly, we can
use the Sobolev norm minimization to estimate the number
of possible COVID-19 cases in certain regions without confirmed cases, i.e., we can add a node in G with the desired location and perform the Sobolev reconstruction. Secondly, the
minimization of the Sobolev norm could be incorporated for
leveraging spatio-temporal information in well-established
models of infectious diseases [2,3], which we leave for future
work.

5. CONCLUSIONS
This paper introduces an estimation method of new COVID19 cases. This estimation is performed using spatio-temporal
data embedded in a time-varying graph signal. Our method is

based in the minimization of the Sobolev norm, and outperforms state-of-the-art algorithms in time-varying graph signals reconstruction. Most importantly, we show the benefits
of the convergence rate of our method by relying on the condition number of the Hessian associated with the problem.
The present work opens up several questions for future research. For example, what is the role of GSP in the field of
the mathematical modeling of infectious disease? Or, what is
the importance of the Sobolev norm for the acceleration of the
convergence rate in the underlying optimization problems of
mainstream applications in GSP such as graph convolutional
neural networks [23, 24], active learning [25, 26], among others,
6. REFERENCES
[1] Z. Xu et al., “Pathological findings of covid-19 associated with acute respiratory distress syndrome,” The
Lancet respiratory medicine, vol. 8, no. 4, pp. 420–422,
2020.
[2] D. J. Daley and J. Gani, Epidemic modelling: an introduction, vol. 15, Cambridge University Press, 2001.
[3] H. W. Hethcote, “The mathematics of infectious diseases,” SIAM review, vol. 42, no. 4, pp. 599–653, 2000.
[4] H. Wang et al., “Phase-adjusted estimation of the number of coronavirus disease 2019 cases in wuhan, china,”
Cell Discovery, vol. 6, no. 1, pp. 1–8, 2020.
[5] D. I. Shuman, S. K. Narang, P. Frossard, A. Ortega,
and P. Vandergheynst, “The emerging field of signal

processing on graphs: Extending high-dimensional data
analysis to networks and other irregular domains,” IEEE
Signal Processing Magazine, vol. 30, no. 3, pp. 83–98,
2013.
[6] A. Sandryhaila and J. M. F. Moura, “Discrete signal
processing on graphs,” IEEE Transactions on Signal
Processing, vol. 61, no. 7, pp. 1644–1656, 2013.
[7] A. Ortega, P. Frossard, J. Kovačević, J. M. F. Moura, and
P. Vandergheynst, “Graph signal processing: Overview,
challenges, and applications,” Proceedings of the IEEE,
vol. 106, no. 5, pp. 808–828, 2018.
[8] A. Loukas and D. Foucard, “Frequency analysis of timevarying graph signals,” in Global Conference on Signal
and Information Processing. IEEE, 2016, pp. 346–350.
[9] N. Perraudin, A. Loukas, F. Grassi, and P. Vandergheynst, “Towards stationary time-vertex signal processing,” in International Conference on Acoustics,
Speech and Signal Processing. IEEE, 2017, pp. 3914–
3918.
[10] K. Qiu, X. Mao, X. Shen, X. Wang, T. Li, and Y. Gu,
“Time-varying graph signal reconstruction,” IEEE Journal of Selected Topics in Signal Processing, vol. 11, no.
6, pp. 870–883, 2017.
[11] I. Pesenson, “Variational splines and Paley-Wiener
spaces on combinatorial graphs,” Constructive Approximation, vol. 29, no. 1, pp. 1–21, 2009.
[12] S. Chen, R. Varma, A. Sandryhaila, and J. Kovačević,
“Discrete signal processing on graphs: Sampling theory,” IEEE Transactions on Signal Processing, vol. 63,
no. 24, pp. 6510–6523, 2015.
[13] A. Anis, A. Gadde, and A. Ortega, “Efficient sampling
set selection for bandlimited graph signals using graph
spectral proxies,” IEEE Transactions on Signal Processing, vol. 64, no. 14, pp. 3775–3789, 2016.
[14] D. Romero, M. Ma, and G. B. Giannakis, “Kernel-based
reconstruction of graph signals,” IEEE Transactions on
Signal Processing, vol. 65, no. 3, pp. 764–778, 2016.
[15] A. Parada-Mayorga, D. L. Lau, J. H. Giraldo, and G. R.
Arce, “Blue-noise sampling on graphs,” IEEE Transactions on Signal and Information Processing over Networks, vol. 5, no. 3, pp. 554–569, 2019.
[16] G. Puy, N. Tremblay, R. Gribonval, and P. Vandergheynst, “Random sampling of bandlimited signals on graphs,” Applied and Computational Harmonic
Analysis, vol. 44, no. 2, pp. 446–475, 2018.

[17] J. H. Giraldo and T. Bouwmans, “GraphBGS: Background subtraction via recovery of graph signals,” arXiv
preprint arXiv:2001.06404, 2020.
[18] R. A. Horn and C. R. Johnson, Matrix analysis, Cambridge university press, 2012.
[19] J. S. Arora, “More on numerical methods for unconstrained optimum design,” in Introduction to Optimum
Design, pp. 455–509. Academic Press, Boston, fourth
edition, 2017.
[20] H. Xiang, H. Diao, and Y. Wei, “On perturbation bounds
of kronecker product linear systems and their level-2
condition numbers,” Journal of computational and applied mathematics, vol. 183, no. 1, pp. 210–231, 2005.
[21] E. Dong, H. Du, and L. Gardner, “An interactive webbased dashboard to track COVID-19 in real time,” The
Lancet infectious diseases, 2020.
[22] R. Sibson, “A brief description of natural neighbour interpolation,” Interpreting multivariate data, 1981.
[23] T. N. Kipf and M. Welling, “Semi-supervised classification with graph convolutional networks,” arXiv preprint
arXiv:1609.02907, 2016.
[24] M. M. Bronstein, J. Bruna, Y. LeCun, A. Szlam, and
P. Vandergheynst, “Geometric deep learning: going beyond euclidean data,” IEEE Signal Processing Magazine, vol. 34, no. 4, pp. 18–42, 2017.
[25] A. Gadde, A. Anis, and A. Ortega, “semi-supervised
learning using sampling theory for graph signals,” in
International Conference on Knowledge Discovery and
Data Mining. ACM, 2014, pp. 492–501.
[26] A. Anis, A. El Gamal, A. S. Avestimehr, and A. Ortega, “A sampling theory perspective of graph-based
semi-supervised learning,” IEEE Transactions on Information Theory, vol. 65, no. 4, pp. 2322–2342, 2018.

