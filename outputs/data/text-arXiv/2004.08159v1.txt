arXiv:2004.08159v1 [math.ST] 17 Apr 2020

Detection and Estimation of Local Signals
Xiao Fang
Department of Statistics, The Chinese University of Hong Kong
and
David Siegmund
Department of Statistics, Stanford University
April 15, 2020

Abstract
We study the maximum score statistic to detect and estimate local signals in
the form of change-points in the level, slope, or other property of a sequence of
observations, and to segment the sequence when there appear to be multiple changes.
We find that when observations are serially dependent, the change-points can lead
to upwardly biased estimates of autocorrelations, resulting in a sometimes serious
loss of power. Examples involving temperature variations, the level of atmospheric
greenhouse gases, suicide rates and daily incidence of COVID-19 illustrate the general
theory.

Keywords: segmentation, change-point, broken line, autoregression.

1

1

Introduction.

We consider a problem of detection, estimation, and segmentation of local nonlinear signals
imbedded in a sequence of observations. As a model, we assume for u = 1, . . . , T
Yu = œÅYu‚àí1 + ¬µ(Xu ) +

X

Œæk f [(Xu ‚àí tk )/T ] + u ,

(1)

k

where t1 < t2 < . . . < tM define the locations and f the ‚Äúshape,‚Äù of the local signals.
For asymptotic analysis given below, we assume that the tk are scaled, so tk /T = t0,k .
Initially we assume the Xu are fixed, but for some applications they are random. The u
are independent mean 0, normally distributed errors. For the moment we assume their
variances are known and equal one, and discuss later how they should be estimated. The
nuisance parameters ¬µ(Xu ) depend on the variable Xu and may be constant or a parameterized regression function. They might, for example, be the mean values for a control
group, for which it is assumed that all of the Œæj = 0. For our general theory we assume œÅ
is an unknown constant, but we estimate œÅ differently in different problems.
An important special case that we return to in examples below is Xu = u and ¬µu =
Œ± + Œ≤[(u ‚àí (T + 1)/2)/T ], so with this notation the model becomes
Yu = œÅYu‚àí1 + ¬µu +

X

Œæk f [(u ‚àí tk )/T ] + u .

(2)

k

It is occasionally convenient to simplify several basic calculations by considering an alternative continuous time model, for which (2) can be conveniently written
dYu = ‚àíŒ≥Yu du + ¬µu du +

X

Œæk f [(u ‚àí tk )/T ]du + dW (u)

k

for 0 ‚â§ u ‚â§ T , where dW defines white noise residuals.
2

(3)

Specific choices of the function f appear to be appropriate for a number of applications,
some of which are discussed below. The special case f (x) = I{x > 0} is a frequently
discussed ‚Äúchange-point‚Äù model, which has been applied to a variety of problems, usually
with œÅ assumed equal to 0. See, for example, Olshen et al. (2004), Robbins, Gallagher, and
Lund (2016) and references given there. Fang, Li and Siegmund (2018) and Fryzlewicz
(2014) address a version of the problem that involves the possibility of multiple changepoints, and a major goal is segmentation of the observations to identify their number and
locations, while controlling the probability of false positive detections. In this paper we
extend the methods of Fang, Li and Siegmund (2018) to deal with more general signals and
with observations that may have autoregressive dependence. See also Baranowski, Chen,
and Fryzlewicz (2019).
An interesting special case is a broken line regression model, where f (x) = x+ , so the
model is given by
Yu = œÅYu‚àí1 + Œ± + Œ≤[(u ‚àí (T + 1)/2)/T ] +

X

Œæk [(u ‚àí tk )+ /T ] + u .

(4)

This model has a long history, again primarily for the case of independent observations and
at most one break-point in a regression line. An application to monitor kidney function
after transplant has been discussed in a series of papers by A. F. M. Smith and others
(e.g. Smith and Cook (1980)). Davies (1987) and Knowles and Siegmund (1989) give
theoretical analyses for independent observations. Toms and Lesperance (2003) provides
an analysis and ecological applications. Several of the examples discussed below involve
climatological time series, or day by day newly confirmed cases of COVID-19. Although
alternative models are possible, a broken line model provides a conceptual framework that
allows us to fit an easy to understand model and to ask whether the breakpoints represent
changes of scientific importance.
3

In a variety of genomic applications t denotes a genomic location, and different applications suggest functions f having different characteristic shapes. For example, for detection
of copy number variations (CNV) the indicator of an interval or a half line may be appropriate. For detection of differentially methylated genomic regions Jaffe, et al. (2012a) suggests
a ‚Äúbump‚Äù function. See simple examples below and elaborations of this model involving
covariates in Jaffe, et al.

(2012b). For ChIP-Seq analysis steeply decaying symmetric

functions like (1 ‚àí |u|)+ , exp(‚àí|u|), or a normal probability density function are different
possibilities (cf. Shin et al. (2013), Schwartzman et al. (2013)). In some applications it
is often appropriate to add a scale parameter œÑ , so at u the signal located at t is of the form
Œæf [(u ‚àí t)/(œÑ T )] (cf. Siegmund and Worsley (1995)). The model of ‚Äúpaired change-points‚Äù
of Olshen et al. (2004) can be described similarly, with f (x) = I{0 < x ‚â§ 1}.
In the special case that ¬µ is a constant, Xu = Yu‚àí1 , and f (x) is the indicator that
x ‚â§ 0, (1) is the simplest example of a threshold autoregression, as introduced by Tong
and studied by Chan and Tong and others (e.g., Chan and Tong (1990) ) in numerous
projects. In a still different context, Xu may be a regressor, say a biomarker, and the local
signal can be used to study whether a subset of individuals, defined by the value of that
biomarker, differ from others in some respect, e.g., response to a treatment.
In some applications Xu may be multidimensional or the noise distribution may not be
normal, with the Poisson distribution representing a particularly interesting alternative.
Although the focus or our paper is on segmentation of multiple signals, we also develop
confidence regions for t and jointly for t and Œæ. After beginning with some basic calculations
and a discussion of testing for at most one change in Section 2, segmentation is discussed
in Section 3 and illustrated in 3.1. New approximations to control the false positive error
rate given in Section 3, which combine smooth and not smooth stochastic processes, play

4

an important role. Sections 4 and 5 briefly consider a number of other special cases of our
general framework. Additional theory and examples are contained in an online Supplement.
We have used simple models to minimize issues of over-fitting and data re-use that could
arguably complicate interpretation of our segmentations. Once segmented, the models
become simple linear models, so we also consider a second stage analysis to estimate more
accurately the nuisance parameters and the Œæj , which then allows us to re-evaluate the
accuracy of the segmentation.
Although large sample theory suggests use of maximum likelihood estimators to estimate the nuisance parameters œÅ and œÉ 2 , we find that in some cases the signals themselves
introduce large bias into those estimators. We discuss some ad hoc alternatives below.

2

Basic Calculations and the Case of at Most One
Change.

To introduce our notation and provide some basic results, we begin with the model given
by (2), with M = 1 or 0, and we consider a test of the hypothesis Œæ = 0. The log likelihood
is given by `(Œæ, t, Œ∏)
= ‚àí.5

X
{Yu ‚àí œÅYu‚àí1 ‚àí Œ± ‚àí Œ≤[(u ‚àí (T + 1)/2)/T ] ‚àí Œæf [(u ‚àí t)/T ]}2 ,
u

where Œ∏ = (Œ±, Œ≤, œÅ)0 , and we consider a test based on the maximum with respect to t of the
standardized score statistic
`Œæ (0, t, Œ∏ÃÇ)/œÉ(t),

(5)

where `Œæ = d`/dŒæ and Œ∏ÃÇ is the maximum likelihood estimator of the nuisance parameters
under the hypothesis Œæ = 0; and œÉ 2 (t) is the asymptotic variance of the numerator.
5

We begin with the standard large sample expansion of the numerator in (5) given by
‚àí1
`Œæ (0, t, Œ∏ÃÇ) ‚âà `Œæ (0, t, Œ∏) ‚àí IŒæ,Œ∏ IŒ∏,Œ∏
`Œ∏ ,

(6)

where I¬∑,¬∑ denotes elements of the Fisher information matrix and by the law of large numbers all quantities on the right hand side are evaluated at Œæ = 0 and true values of the
other parameters. This expansion is valid in large samples up to terms that are o(T ) in
probability. To emphasize the structure of this approximation we find it convenient to use
the notation E0 to denote expectation under the hypothesis Œæ = 0 and write (6) in the form
Vt = `Œæ (t) ‚àí Œ®(t)0 A`Œ∏ , where `Œæ (t) = `Œæ (0, t, Œ∏), Œ®(t)0 = E0 [`Œæ (t)`0Œ∏ ] is not random although
it depends on t; `Œ∏ does not depend on t, and under the hypothesis Œæ = 0 it has mean value
0 and covariance matrix A‚àí1 = IŒ∏,Œ∏ .
Remark. It may be shown that the decomposition given in (6) does not depend on the
normality of the j , although we can no longer use the terminology of likelihood, efficient
score, etc., and must rely on the central limit theorem to justify the asymptotic normality
of probability calculations given below. The special case of Poisson observaions is discussed
briefly in Section 5.
Calculations yield a number of simple propositions.
Proposition 1.
Œ£(s, t) = E0 (Vs Vt ) = E0 [`Œæ (s)`Œæ (t)] ‚àí Œ®(s)0 AŒ®(t).

(7)

In particular the variance of Vt is œÉ 2 (t) = Œ£(t, t).
Remark. In the case the local signal contains a scale parameter, so it takes the form
Œæf [(u ‚àí t)/(œÑ T )], the covariance is similar in its general formulation, but slightly more
complicated to compute in examples.
6

Writing Et,Œæ to denote expectation under the alternative, where t and Œæ can be vectors,
we have
Proposition 2. Et,Œæ (Vs ) =

P

k

Œ£(s, tk )Œæk .

Let Zt = [`Œæ (t) ‚àí Œ®(t)0 A`Œ∏ ]/œÉ(t), and consider the test statistic maxt |Zt |. The false
positive probability for the test that detects a signal when maxt |Zt | is large is given by
P0 {maxt |Zt | ‚â• b}.
To evaluate this probability, we distinguish essentially two cases, one where f is continuous and the second where it is discontinuous. The case where f is the indicator of a half
line or an interval (of unspecified length) is discussed in Fang, Li and Siegmund (2018).
Here we assume that f is continuous and piecewise differentiable. An approximation based
on Rice‚Äôs formula is given by
Proposition 3.
P0 { max |Zt | > b} ‚â§ 2{(œï(b)/(2œÄ)

1/2

T0 ‚â§t‚â§T1

T1

Z

[E0 (ZÃát )2 ]1/2 dt + 1 ‚àí Œ¶(b)},

)

(8)

T0

where ZÃát denotes the derivative of Z at t. For the model where the local signal at u has
the form Œæf [(u ‚àí t)/œÑ T ], and we maximize over both t and a range of values of œÑ , a first
order approximation becomes
Z

œÑ1

Z

T1

P0 {max |Zt,œÑ | > b} ‚âà 2{bœï(b)/(2œÄ)}
t,œÑ

œÑ0

det[E0 (ZÃáZÃá0 )]1/2 dtdœÑ,

(9)

T0

where ZÃá = ‚àáZt,œÑ . This approximation can be improved by adding terms involving edge
effects and corrections for curvature. The most important is the boundary correction at the
RT
(t, œÑ0 ).
minimum value of œÑ , which equals (8œÄ)‚àí1/2 œï(b) T01 [E0 (ZÃá)2 ]1/2 dt, where now ZÃá = ‚àÇZ
‚àÇt
It is often convenient when T is large to ignore edge effects, which simplifies integration over

7

[T0 , T1 ]. See Siegmund and Worsley (1995) or Adler and Taylor (2007) for more detailed
approximations.
To evaluate (8) and (9), the following result is useful.
Proposition 4.
E0 [(ZÃá ZÃá 0 )] = [E0 (`Àô`Àô0 ) ‚àí Œ®Ãá0 AŒ®Ãá]/œÉ 2 (t) ‚àí [œÉÃá œÉÃá 0 ]/œÉ 2 .

(10)

Finally observe that by Propositions 1 and 2, we have the ‚Äúmatched filter‚Äù conditions,
and consequently
Proposition 5. Given t (or t, œÑ ), the variable Vt (or Vt,œÑ ) is sufficient for Œæ.
For the specific case of (4), it simplifies calculations somewhat to consider the continuous
time version given in (3), which amounts to replacing certain sums by integrals, leading to
Proposition 6. œÉ 2 (t) ‚àº T {(1 ‚àí t0 )3 /3 ‚àí (1 ‚àí t0 )4 (1 + t0 + t20 )/3}, and E0 (VÃát2 ) ‚àº T {(1 ‚àí
t0 ) ‚àí (1 ‚àí t0 )2 ‚àí 3[t0 (1 ‚àí t0 )]2 }.
As expected, this result does not depend on the nuisance parameters Œ±, Œ≤. It is perhaps
surprising that it also does not depend on œÅ. See the online Supplement for details.

2.1

Confidence Regions

It is possible to obtain a confidence region for the parameters t or a joint region for t and
Œæ. Calculation shows that the expected value of Vs equals Œæ times the covariance of Vs and
Vt (cf. Proposition 2). An easy consequence is that Zt = Vt /œÉ(t) is sufficient for Œæ, so the
conditional distribution of Zs given Zt is the same as it would be under the null hypothesis,
Œæ = 0.
Now we must consider two cases, depending on whether the process has a jump at t.
The case of a jump was studied by Fang, Li and Siegmund (2018), so here we consider
8

the continuous case. For a similar approach based on a different probability evaluation see
Knowles, Siegmund and Zhang (1991). We use the Kac-Slepian model process, which for a
mean 0 unit variance stationary, differentiable, Gaussian process, say Us , gives a parabolic
approximation for the process in a neighborhood of s0 conditional on Us0 assuming a large
value. As a consequence of those arguments, in a neighborhood of s0
Us = Us0 + (s ‚àí s0 )UÃás0 ‚àí

(s ‚àí s0 )2
Us0 E0 [(UÃás0 )2 ] + o((s ‚àí s0 )2 ),
2

so
max(Us2 ‚àí Us20 ) ‚âà UÃás20 /{E0 [(UÃás0 )2 ]Us0 },
s

(11)

with errors that converge to 0 in probability. It follows that the conditional distribution
of maxs (Zs2 ‚àí Zt2 ) is asymptotically œá2 with one degree of freedom, so a 1 ‚àí Œ± confidence
region is given by the set of all s that satisfy Zs2 ‚â• Zt2 ‚àí œá21‚àíŒ± , where œá21‚àíŒ± is the 1 ‚àí Œ±
quantile of the œá2 distribution with one degree of freedom. This is in effect the same result
one would obtain by inverting the log likelihood ratio statistic if Z were the log likelihood
of a parameter satisfying standard regularity conditions.
A joint confidence region for Œæ and t is also easily obtained. To the condition that Zt2
must be within a given distance of maxs Zs2 , we also require that |Zt ‚àí ŒæœÉ(t)| is sufficiently
2
small. The pairs Œæ, t that satisfy maxŒ¥ [Zt+Œ¥
‚àí Zt2 ] + (Zt ‚àí ŒæœÉ(t))2 ‚â§ c2 provide a joint

confidence region having the confidence coefficient

2
Pt,Œæ {max[Zt+Œ¥
‚àí Zt2 ] + (Zt ‚àí ŒæœÉ(t))2 ‚â§ c2 }

(12)

2
= Et,Œæ [Pt,Œæ {max[Zt+Œ¥
‚àí Zt2 ] ‚â§ c2 ‚àí (Zt ‚àí ŒæœÉ(t))2 |Zt }; |Zt ‚àí ŒæœÉ(t)| ‚â§ c]

(13)

Œ¥

Œ¥

which equals the distribution of a œá2 random variable with two degrees of freedom, again
as if standard regularity conditions had been satisfied.
9

Looking ahead to the possibility of finding joint confidence regions for two (or more)
change-points t1 < t2 , we face a more subtle argument. First note that with t = (t1 , t2 ),
and Œæ = (Œæ1 , Œæ2 ), a straightforward calculation extending the result given in Proposition
P
2 (cf. (29) in the online Supplement) shows that Et,Œæ (Vs ) =
i [Œæi œÉ(ti )Œ£(s, ti )], where
Œ£(s, v) = Cov(Vs , Vv ). This produces by a second calculation the conclusion that the log
P
P
likelihood of Vs , s = 1, ¬∑ ¬∑ ¬∑ , T equals i Œæi œÉ(ti )Vti ‚àí .5 i,j Œæi Œæj œÉ(ti )œÉ(tj )Œ£(ti , tj ). Hence the
log likelihood ratio statistic, given t, for testing that Œæ is the 0 vector equals
(Vt1 , Vt2 )Œ£(t1 , t2 )‚àí1 (Vt1 , Vt2 )0 = ||ZÃÉt1 ,t2 ||2 ,

(14)

where ZÃÉt1 ,t2 = Œ£(t1 , t2 )‚àí1/2 (Vt1 , Vt2 )0 has a standard bivariate normal distribution when
Œæ = 0, and || ¬∑ || denotes the Euclidean norm. It follows from sufficiency and the KacSlepian argument used above that
max[||ZÃÉt1 +Œ¥1 ,t2 +Œ¥2 ||2 ‚àí ||ZÃÉt1 ,t2 ||2 ]
Œ¥1 ,Œ¥2

has a œá2 distribution with two degrees of freedom and can be used as above to obtain a
joint confidence region for (t1 , t2 ).
A joint confidence region for t, Œæ follows by an argment similar to that given above.
Remark. The confidence regions for the change-points are easy to visualize and seem
reasonable. The estimates of Œæ are more problematic, since selection of the change-point
value t introduces bias into the estimation of Œæ which may be exacerbated by a biased
estimate of œÅ. In Section 3 we consider a different method for estimating the parameters Œæ.

2.2

Numerical Examples

We begin with several simple numerical examples of broken line regression, which differs
from some other models in the sense that a change of slope can have a lasting effect that
10

makes even a relatively small change easy to detect if it persists.
Example 1. Extreme Precipitation in the United States. Extreme precipitation in the
United States is reported by the National Oceanographic and Atmospheric Administration
(NOAA) at
https://www.ncdc.noaa.gov/temp-and-precip/uspa/wet-dry/0.
This web site gives the area of the country where monthly rainfall exceeeded the 90th
percentile of normal for the 124 years and 8 months beginning in 1895.
Our test for at most one changes suggests a slope increase in 1954, with a p-value of
0.001. The value of œÅ is estimated to be 0.08. The test applied to extremely low preciptation
(area of the country below the 10th percentile) is consistent with the hypothesis of no change
in slope.
Example 2. Central England Annual Average Temperature. The average temperature in
central England England from 1659 (Manley (1974)) until 2019 is reported on
(https://www.metoffice.gov.uk/hadobs/hadcet/cetml1659on.dat).
The maximum Z value is about 4.60, with œÅ estimated to be 0.16, and occurs in 1969.
The appropriate (two-sided) p-value is about 6 √ó 10‚àí5 . See Figure 1, where it appears
that there might also be earlier change-points. Although the mercury thermometer was
relatively young in 1659, those early years are interesting since they appear to involve
the ‚Äúlittle ice age.‚Äù We return to these data below for our discussion of segmentation.
Meanwhile it may be interesting to note that an approximate 95% confidence region based
on the detected change in 1969 is (1895,1990), which reflects the local shape of the plot
in Figure 1 and suggests the possibility that an increase in temperature may have actually
begun during the late 19th century.

11

15
10
0

5

Z[1:m]^2

0

50

100

150

200

250

300

350

Index

Figure 1: Plot of Zt2 for central england temperature data, 1659-2017.
12

2.3

Estimation of œÉ 2 and œÅ: A Simulated Example.

Although we have assumed the variance known in our theoretical calculations, in our numerical studies we have estimated it by the residual mean square under the null hypothesis.
Other possibilities when the data are independent are sums of squares of first or second
P
P
order differences: u (Yu+1 ‚àíYu )2 /2m or u (Yu+1 ‚àí2Yu +Yu‚àí1 )2 /6m, which may be preferable. First order differences remove most of the effect of changing mean values, and second
order differences also mitigate the effect of slope changes.
Regarding correlation of the observations, a useful model is one that helps to control
false positive errors with minimal loss of power; and to that end our working model is a
first order autoregression. Using a value of œÅ that is too small can lead to an increase in
false positives. But when there are change-points, the maximum likelihood estimator of œÅ
under the null hypothesis that Œæ = 0 can be upwardly biased, leading to a loss of power,
as we can easily see from the simulated data described below.
The simulated example in Table 1 illustrates the problem of estimating œÅ and the effect
on the power to detect a change.
For the data in the third and fourth rows of the Table, if we assume it known that
œÅ = 0 and use second order differences to estimate œÉ 2 , the estimated value is 0.89 and the
maximum Z value is 6.77. In all cases, the maximizing value of t is 94. In most other cases
as well the maximizing value of t provides a reasonable estimator of the true value.
It is clear from these examples and others not shown that the existence of a change-point
causes the estimator of œÅ to be upwardly biased and results in a loss of power compared to
using the true value of œÅ. This is usually worse if there are multiple change-points. If a plot
of the data indicates long stretches without change-points, one might use an estimator of œÅ
from that segment. For the data in the next to last row of Table 1, an estimate of œÅ based on
13

Table 1: Simulated examples: m = 150,, 0.05 threshold is b = 2.83. Locations of breakpoints and changes in the slope occurring at the break-points are as indicated. Rows where
œÅÃÇ has been set equal to œÅ are included to illustrate the loss of signal that occurs because of
bias in estimation of œÅ.
t

Œæ

œÅ

œÅÃÇ

‚Äî

0.00

0.50 0.48 0.98

1.60

‚Äî

0.00

0.60 0.56 0.98

1.05

100

0.05

0.0

0.30 1.04

4.04

100

0.05

0.0

0.00 1.09

5.51

100

0.05

0.4

0.60 1.19

3.86

100

0.05

0.6

0.75 1.00

3.34

100

0.05

0.6

0.60 1.02

5.06

50

0.04

0.5

0.54 0.97

3.37

50

0.04

0.5

0.50 0.97

3.66

50

-0.033

0.6

0.76 1.15

2.74

50

-0.033

0.6

0.60 1.15

4.34

14

œÉÃÇ

maxs Zs

the observations 65-150 yields the value 0.61, which in turn leads to a maximum Z-value
of 4.31. Although the theory developed here does not justify this approach, numerous
simulations suggest that it works reasonably well.
A second consideration in estimation of œÅ is robustness of our procedure against more
complex forms of dependence. Without exploring this question in detail, consider again
the next to last row of Table 1, but where there is a second order autoregressive coefficient
of - 0.2 and Œæ = ‚àí0.06. A simulation of this case gives an estimator of œÅ equal to 0.6 based
on all the data, with a maximuom Z-value of 3.32, and an estimator equal to 0.42 based
on the second half of the data, with a maximum Z-value of 4.85. Other simulations, not
given here, suggest that at least for higher order autoregressive dependence, the first order
model we have suggested provides reasonable protection against an inflated false positive
error rate.
A different approach (e.g., Robbins, Gallagher, and Lund (2016)) for dealing with dependence in the standard change-point model (i.e., f (s) = I{s > 0}) is to assume that
the estimated residuals from a least squares fit of the null model form a locally dependent stationary process and estimate the autocovariances accordingly. Weak convergence
arguments typically indicate that a rescaled process converges weakly to a Gaussian process, often related to a Brownian Bridge, which can be studied to look for change-points.
Although this method has some advantages, we prefer our approach for facilitating quantitative statements in the form of hypothesis tests and confidence intervals after a minimal
amount of ‚Äúdata snooping‚Äù to arrive at a useful model. If we are successful in detecting
the signal locations, our model for the other parameters becomes a standard linear model.
In Section 3.1 we discuss analysis of this linear model as a test of our approach.

15

3

Segmentation.

We now turn to the problem of segmentation when there may be several change-points. It
is helpful conceptually to think of two different cases. In the first the signals exhibit no
particular pattern. In the second two or more changes are expected to produce a definite
signature. For the problem of changes in levels of the process, paired changes frequently
take the form of an abrupt departure from followed by a return to a baseline level.
Here we initially concentrate on the case of signals having no apparent pattern and consider versions of the two methods suggested in Fang, Li and Siegmund (2018) for detection
of jump changes. First we consider a pseudo-sequential procedure, called Seq below, where
it is convenient to write Z(t, T ) to denote the statistic Z(t) when the interval of observation
is [0, T ]. We also use a minimum sample size m0 and a minimum lag n0 , both of which we
often set equal to 5. Let t0 = m0 and let T be the smallest integer exceeding t0 + n0 such
that for some t0 < t < T ‚àí n0 , the value of Z(t, T ) exceeds a threshold b to be determined
by a constraint on the probability of false positive error. The first change-point is taken to
be t1 : equal to arg max |Zt |, or the smallest or largest value of t for that smallest T . (In
numerical experiments we have been unable to find a consistent preference.) The process
is then iterated starting from t1 . The nuisance parameter œÅ is assumed to be known. In
practice it is estimated from the data or more often from a subset of the data to mitigate
the effect of the bias discussed above. The other nuisance parameters, are estimated from
the current, evolving interval of observations, so that the nuisance parameters associated
with one change-point do not confound detection of another. It would also be possible to
estimate œÅ from the currently studied subset of the data, but this estimator appears to be
unstable.

16

To control the global false positive error rate, we want an approximation for
Q = P{

max

m0 ‚â§t<T ‚àín0 ,T ‚â§m

|Z(t, T )| ‚â• b},

where m is the number of observations and m0 , n0 represent minimal sample sizes, both of
which we frequently take to be 5. To emphasize that T is a variable quantity, we also write
œÉ 2 (t, T ), Œ®(t, T ), etc.
Let Œ≤(t, T ) = {E[V ‚àÇV /‚àÇT ) ‚àí .5‚àÇœÉ 2 (t, T )/‚àÇT }/œÉ 2 (t, T ) and Œªt = E[(ZÃát,T )2 ]. Then
1/2

Q ‚âà (2/œÄ)

bœï(b)

m Z
X
T =m0

{Œªt Œ≤(t, T )ŒΩ[b(2Œ≤(t, T ))1/2 ]}1/2 dt.

(15)

m0 <t‚â§T ‚àín0

A derivation of the approximation (15) begins from the initial approximation of the
probability of interest by a sum over T of the sum over t ‚â§ T ‚àí n0 of the integral over x
from 0 to ‚àû of the product of three factors: (i) P{Z(t, T ) ‚àà b + dx/b} ‚âà œï(b) exp(‚àíx)dx/b;
(ii) P{Z(t ‚àí Œ¥, T ) < b|Z(t, T ) = b + x/b}; and (iii) P{maxj‚â•1 b[Z(t, T ‚àí j) ‚àí Z(t, T )] <
‚àíx|Z(t, T ) = b + x/b}.
1/2

The second factor is approximately Œ¶[Œ¥bŒªt

1/2

‚àí x/(Œ¥bŒªt )]. If we choose Œ¥, so that Œ¥b

is very small, the integral is dominated by small values of x. The third factor is approximately P{maxj Sj ‚â§ ‚àíx}, for a suitable random walk. For small x, it is approximately
P{maxj Sj < 0}. Putting these two observations together leads to the approximation given
by (15).
A slightly more complex calculation leads to a different and apparently preferable approximation, which is based on a similar analysis but incorporates in addition the conditional probability, given Z(t, T ) = b + x/b, that 2b[maxs Z(s, T ) ‚àí Z(t, T )] ‚àà dy and
b[Z(t, T ‚àí j) ‚àí maxs Z(s, T )] < ‚àí(x + y) for all j ‚â• 1. By virtue of the Kac-Slepian model
process 2b[maxs Z(s, T ) ‚àí Z(t, T )] ‚àº ZÃá(t, T )2 /EZÃá(t, T )2 and hence is an independent œá21
17

random variable. This leads to an expression similar to (15), but with the integrand in
(15) replaced by
1/2

bŒªt Œ≤(t, T )ŒΩ{b[2Œ≤(t, T )]1/2 }.

(16)

In spite of its somewhat different appearance, this second approximation is slightly less
conservative than the first, but gives very similar numerical values. For m0 = n0 = 3
and m = 250, the first approximation gives a 0.05 threshold of 4.08, while the second gives
3.97. Since these probabilities vary substantially for small values of m0 , n0 , and neighboring
changes in slope seem difficult to detect and rarely to occur in the data we have studied,
we typically use the values m0 = n0 = 5, which for this example would reduce the 0.05
threshold given by (16) from 3.97 to 3.89.
The approximation (16) may be used to assign a p-value to the the individual detections.
For example, suppose we use the threshold b = 4.09, which for m0 = n0 = 5 and m = 500
gives a global false positive error of 0.05. Suppose also that we detect a change at t = 50
with T = 70 and Z(50, 70) = 4.49. The approximation (16) for m = 70 and b = 4.49,
which equals 0.001, can be regarded as a p-value for that detection. This argument can be
applied iteratively to obtain p-values for a second and subsequent detections. In view of
the lag between a putative change-point t and the value of T when detection occurs, it is
possible for the sum of p-values to exceed the global significance value, although numerical
experimentation indicates that this rarely occurs.
When this process detects a change in slope, for the smallest value of T there typically
is a cluster of values of t where |Z(t, T )| exceeds the chosen threshold. In practice we
might reasonably choose the smallest such t, or the value that maximizes |Z(t, T )|. We
then iterate the process starting from the selected t. Upon iteration the background linear
regression is estimated using the data beginning with that t. It may not be clear which
18

choice is better in a particular application.
Remarks. (i) Although we use this ‚Äúpseudo-sequential‚Äù method with a given amount of
data, it can also be used for actual sequential detection, as in the problem of monitoring
kidney transplants discussed in Smith and Cook (1980).
(ii) Although sample paths of the process Z(t, T ) as a function of t are smooth, as a
function of T they behave locally like a random walk. A consequence is that to obtain
a mathematically precise derivation of the approximation (15), local perturbations of the
paramter T must be scaled by a small factor, say ‚àÜ, which converges to 0 at the rate of
1/b2 when b ‚Üí ‚àû. See, for example, Fang, Li and Siegmund (2018) for the case of abrupt
changes in the mean. A similar remark applies to (17) given below.
A second method of segmentation, called MS below (for Maximum Score Statistic), uses
(in obvious notation)
max

m0 ‚â§T0 <t<T1 <m

ZT0 ,t,T1 .

An asymptotic approximation to the null probability that this expression exceeds b can be
computed by a modification of the argument behind (16), and we obtain the approximating
expression
2
( )1/2 b2 œï(b)√ó
œÄ
X
m0 ‚â§T0 <T1 ‚â§m

Z

(Œªt )1/2 Œ≤0 (t, T0 )Œ≤(t, T1 )ŒΩ{b[2Œ≤0 (t, T0 )]1/2 }ŒΩ{b[2Œ≤(t, T1 )]1/2 }dt,

(17)

T0 <t<T1

where Œ≤0 (t, T0 ) is defined similarly to Œ≤(t, T ). The evaluation of (17) can be simplified by
a summation by parts and the observation that the various functions of three variables,
(T0 , t, T1 ), occurring in (17) are in fact functions of two variables: (t ‚àí T0 , T1 ‚àí T0 ).
These methods determine a list of putative local signals together with generally overlapping backgrounds. We consider different algorithms for selecting a set of local signals and
19

backgrounds from this list, with a preference for the additional constraint that no background overlap two local signals. In Fang, Li and Siegmund (2018) examples of particular
interest were the shortest background, (cf. also Baranowski, Chen, and Fryzlewicz (2019)),
and the largest Z value. For the second of these methods we have paid in advance for false
positive errors, so we can also consider other methods for searching the list, e.g., subjective
consistency with a plot of the data. We also find it convenient computationally to follow
the suggestion of Fryzlewicz (2014) by searching a random subset of intervals, which seems
to work very well. When it appears that the number of changes is small, as in the examples
considered in this paper, one might also use a combination of methods, e.g., searching a
small random subset of intervals at a low threshold to generate candidates, then sorting
those by hand with tests to detect at least one change at the appropriate higher threshold.
The methods discussed so far are ‚Äúbottom up‚Äù methods in the sense that they attempt
to identify one local signal at a time against a background appropriate for that signal. A
popular ‚Äútop down‚Äù method in the change-point literature scans all the data looking for a
pair of change-points (e.g., Olshen et al. (2004)). In some cases, especially if there is only
one change to be detected, the method will ‚Äúdetect‚Äù two changes, as required, but it will
put one of them near an end of the data sequence, where it can be recognized and ignored.
After an initial discovery of one or two change-points, the sequence is broken into two or
three parts by those change-points, and the process is iterated as long as new change-points
are identified. Here we also consider the statistic maxs<t‚àíh Us,t , where
0
Us,t = (Vs , Vt )Œ£‚àí1
s,t (Vs , Vt ) .

(18)

and h is a parameter that represents a minimum distance between changes that we find
interesting (usually taken to be 5 or 10 in the examples below). An appropriate threshold
may be determined from the approximation (closely related to (9))
20

Z
P{max Us,t > b} ‚àº [2bœï(b)/(2œÄ)]
s<t

det[E(UÃá UÃá 0 )]1/2 dsdt.

(19)

s<t‚àíh

This approximation is approximately linear in the length of the sequence searched, so
iterating the process leads in a final step to roughly the same probability of a false positive
as is present in the first step. If we assume that in early iterations, only true positives are
detected, then the iterative process does not create a multiple comparisons issue. As we
will see in the examples below, this method has very good power properties, although its
use requires somewhat more thoughtful analysis than the other methods. Since the process
Zt can have relatively large local correlations, when there is only one change to be detected
in an interval, and hence we expect to find a second ‚Äúfake‚Äù change near an end-point of the
interval searched, that ‚Äúfake‚Äù change may be somewhat distant from the end-point, so it is
not clear without additional analysis whether it should be ignored. Use of a linear analysis
as in the following section can be very helpful.
A search algorithm based on the maximum of (18) is easily adapted to obtain joint
confidence regions for a pair of change points along the lines discussed toward the end of
Section 2.1.
An advantage of the top down feature is that the intervals searched are usually relatively
long, so it may be reasonable to estimate different values of œÅ for the different intervals
searched. If we assume that large changes are detected first, this method would presumably
reduce the estimated value of œÅ, in subsequent searches, but the problem of bias would
remain as long as subsequent searches involve intervals containing changes. For the sake of
consistency in our examples we have not explored this option.

21

3.1

Applications.

In this section we consider a number of data sets, where broken line regression is arguably an
appropriate model, or at least where it allows one to address questions of interest regarding
the times of changes in long term trends. Since all these examples involve observational
time series, an assumption of independence seems inappropriate, although in several cases
the estimated value of œÅ is small enough to be assumed equal to zero.
After employing a detection method, we assume that the detections are in fact correct,so our model becomes a standard linear model. Estimation of the parameters of the
linear model gives us an idea of the size and importance of different detected changes, the
adequacy of the model as judged by the value of R2 and œÅÃÇ, and the reasonableness of our
choice for the value of œÅ in our initial segmentation.
Example 3: Greenland temperatures 1901-2016. An example from a site sponsored by the
World Bank,
https://climateknowledgeportal.worldbank.org/download-data
is the average annual temperature of Greenland, which may be particularly interesting in
view of the large amount of water contained in its glaciers. Data are provided for the years
1901-2016. See Figure 4 in the online Supplement for a plot of Zt , which suggests a small
increase followed by a decrease early in the 20th century, then a second increase near the
end of the century. If we use all 116 observations to estimate œÅ, we obtain œÅÃÇ = 0.13 and the
test to detect at least one change detects a decrease in slope occurring in about 1929. If we
use only the first half or the second half of the data to estimate œÅ, we obtain a value slightly
less than 0.1 and with this value detect an increase in 1993. With the smaller estimate of
œÅ, Seq detects three changes: an increase in 1919, a decrease in 1929, and a second increase
that seems to occur about 1973, although 1984 gives essentially the same observed value of
22

the statistic. With MS, we detect changes in 1929 and 1984. If we set œÅ = 0, we also barely
detect a change in 1919. A linear model incorporating these three changes begins with an
initially negative slope, with the first two changes essentially canceling each other, and the
third change about three times as large (in magnitude) as the initial negative slope. The
effect of putting these changes into the model is to increase R2 from an initial value of 0.28
to approximately 0.7, while reducing the estimated value of œÅ from 0.13 to 0.02, which does
not test to be different from 0. Although the change at 1919 is borderline, omitting it from
the model provides a less satisfactory result (details omitted).
If we use (18) to search for two changes at a time, we find slope changes in 1918, 1933,
and 1983, essentially the same as above.
Example 4. Berkeley Earth Central European Temperature Anomalies beginning in 1753.
Whereas both the Hadley Center and NOAA provide temperature data, their beginning
dates are in the mid to late 19th century, and hence make it difficult to detect slope changes
that may have occurred during the 19th century. The Berkeley Earth web site at
http://berkeleyearth.org/data/
provides measurements going back to the mid 18th century. The results for several European countries are quite similar and suggest that at least in Europe increasing temperatures
began in the late 19th century before the recent acceleration that began about 1980. As an
example we consider Swiss temperature anomalies from 1753 to 2012. Our test for at least
one change identifies a slope increase in 1890 with an estimated autocorrelation of 0.24.
The plot of Zt (Figure 2) contains a broad peak and a local maximum in the late 20th
century, which suggests the possibility of more than one change. A 95% confidence interval
based on the theory suggested above is [1866,1972], which leaves open the possibility of a
second change. Seq and MS confirm a 19th century change, but they fail to detect one in
23

the 20th century even if the autocorrelation is set to 0. With the estimated autocorrelation
of 0.24, the statistic (18) detects changes in both 1897 and 1980. A linear analysis with
these two change points yields and R2 of 0.33 and an autocorrelation of 0.03, which does
not test to be different from 0. Temperature anomalies of several other countries in Europe exhibit similar, but not identical behavior. In these cases the test to detect a single
change will sometimes pick out a local maximum in the 19th century and sometimes in the
20th, while the statistic (18) detects two changes. This is perhaps not surprising since the
method was designed for such data. For Switzerland, a 90 % joint confidence region for
the two change-points with œÅ set equal to 0 contains about 2000 pairs of points. Typical
examples near the extremes are (1829,1988), (1888,1962), (1890,1995).
Example 2 (continued): Central England Average Annual Temperature. A challenging case
is the central England temperature data for 360 years beginning in 1659. A plot of the data
suggests possible changes very early in the series with a much larger change 2-3 hundred
years later. The first 80-100 years may be less reliable, due to the primitive thermometers
available at that time, but the early data are nonetheless interesting in view of the so-called
‚Äúlittle ice age,‚Äù which overlapped these years. As reported above, a test of at least one
change produces a significant increase in slope in 1970 with an estimated autocorrelation of
0.159, and a confidence interval going back about a hundred years, reflecting the increase
in the plot of Zt2 , in Figure 2, that begins in the late 19th century. If we use Seq with the
threshold 4.00 and the autocorrelation 0.159, we find an increase in 1693, a decrease about
1708, and a larger increase about 1890. For MS with a threshold of 4.81 and the same value
for œÅ, we detect only the change in 1890. If we lower the detection standard to control the
global false positive rate at 0.10 and set œÅ = 0.12, which is the estimate obtained from the
first half of the data or from the second half of the data, we obtain a change in 1696 and a
24

3
2
1

Z[2:(m - 1)]

4

5

Figure 2: Plot of Zt for Berkeley Earth Swiss Temperature Anomalies: 1753-2012.

0

50

100

150

25

200

250

second in either 1890 or 1988, but without a compelling reason to choose one or the other.
Figure 3 suggests that either (or both) could be correct. A linear analysis indicates that
the model with only one change at either 1890 or 1988 leads to an R2 of approxmately
0.26 and a value of œÅ of about 0.12. Incorporating the two earlier changes detected by Seq
raises R2 to about 0.31 and reduces œÅ to about 0.1 for either choice of the third change.
Including all four changes raises R2 to about 0.33 and decreases œÅÃÇ to about 0.08. The
statistic (20) to detect two changes at a time detects changes in 1697, 1704, 1730, and
1886; but a linear analysis indicates that the change in 1730 need not be included. The
two earlier changes are detected on the initial search, and hence this represents an example
where the statistic (20), when faced with an interval where there is only one change, may
place a second change sufficiently far from an end-point of the interval searched that it is
not obvious that it should be disregarded.
Example 5: Age specific suicide rates in the United States. A small sample size example is
suicide rates in the US from 1990 through 2017, which can be found on the web site
ourworldindata.org.
Autocorrelation appears to be very small, so we assume it is 0. All methods detect a
substantial slope increase about 2000. For MS this is the only change detected, and it
produces an R2 of 0.91. Seq detects in addition, a second increase about 2014. The
statistic (18) detects three changes, a decrease in slope about 1995 before a larger increase
in 1999, and a third increase in 2014. A linear analysis with all three changes yields an R2
of 0.97.

26

4

Detection of Jump Changes

We consider again the model (2), now with ¬µu an unknown constant and f (u) = 1{u > 0},
so the tk are change-points in the level of the observed process. For some applications it
may seem more appropriate to use f (u) = 1{0 < u/œÑ ‚â§ 1}, so the length of a local interval
where the mean changes is an unknown constant œÑ , which may vary from one interval
to another when there are multiple changepoints. Since the case œÅ = 0 has been widely
studied, here we concentrate on time series, where the first order autoregressive dependence
discussed above may be pertinent. Again it turns out that change-points introduce bias
into the estimation of œÅ, so we consider estimators based on subsets of the data that appear
to be free of change-points.
We consider primarily methods taken from Fang, Li and Siegmund (2018), which, as
noted above, motivate the structure of the bottom up segmentation methods suggested in
this paper.
We also consider the top down method of circular binary segmentation (CBS) (Olshen
et al. (2004)), which may have advantages when a change that increases (decreases) the
mean value tends to be followed by a change that decreases (increases) the mean, since it
directly models such paired change-points. And finally we consider the analogue of (18),
which was not studied in Fang, Li and Siegmund (2018). To that end we take œÅ = 0 for
P
simplicity and let St = t1 Yu . Then Vt = (tSm /m ‚àí St ) , so Us,t is defined by the equation
(18) for the approriately modified covariance matrix with entries s(1 ‚àí t/m) for s ‚â§ t. In
this section we continue to refer to this as the statistic (18).
Two interesting climate related time series are AMO (Atlantic Multidecadal Oscillation), for which there are data beginning in 1856, and PDO (Pacific Decadal Oscillation)
with data from 1900. In both cases the data have been recorded monthly, but we average
27

the monthly data to get annual time series with 163 and 118 values, respectively.
A visual inspection of the AMO data suggests that there is no change-point before
about 1900, so we estimate œÅ from the first 45 observations to get the value 0.38. All
methods agree that there is a decrease in the mean at 46 (1901), an increase at 70 (1925),
a decrease about at 108 (1963), and the latest increase at 139 (1995). A linear analysis
with these change-points returns an R2 of about 0.72 and an auto-correlation of 0. It may
be interesting to observe that the changes in slope detected in the Northern Hemisphere
ocean temperature anomalies (Example 6 in Section 3.1) fall very close to the mid-points
of these three intervals.
The PDO data are similar, but changes appear to be more frequent, as the name
suggests, and a cumulative sum plot appears very noisy. If we estimate œÅ by all the
observations, we get 0.55 and detect no changes. If we use the observations from 1 to 45,
we get œÅÃÇ = 0.30 and detect changes at 48, 76, 99, and 114 by the pseudo-sequential method
and by CBS, while the stricter segmentation method that uses all possible background
intervals detects changes at 48, 76, and 114. The statistic (18) detects only the first two
change-points. A linear analysis with the four detected change-points produces an R2 of
0.48 and an estimate for œÅ of 0.27.
For these data level changes seem to alternate positive and negative directions, so CBS
and related methods that look for paired changes appear to have an advantage. Although
the pseudo-sequential method detected the same changes in the PDO data as CBS, its
detections at 76 and 114 were borderline.

28

5

Non-Gaussian Models.

It is relatively straightforward to extend the analysis given above to generalized linear
models, at least for independent observations. For example, suppose that Yu has the log
likelihood

Yu Œ∏u ‚àí œà(Œ∏u ),

(20)

where
Œ∏u = ¬µu + Œæf (u ‚àí t).
The efficient score to test the hypothesis Œæ = 0 or segment the sequence is much as before,
although computation of Œ®(t) is more complicated. Fortunately at least for the following
examples, it seems plausible to assume independent (quasi)Poisson observations.
A perhaps more flexible model than (20) is an asymptotic quasi-likelihood model, e.g.,
Heyde (1997), where there is the possibility of different models for the mean and variance. A
very similar model to the one we developed in Section 2 is obtained by setting œà(Œ∏u ) = Œ∏u2 /2
in (20), but we interpret Œ∏u as the conditional expectation of Yu given the observations up
to u ‚àí 1, so the efficient score to detect a local signal is a sum of martingale differences. It
is then straightforward to extend the methods developed above.
Example 6: Rain Storms in New Zealand An example modeled as jump changes in a Poisson
mean are heavy rain storms in New Zealand since 1900, which have been catalogued at
https://hwe.niwa.co.nz.
Both Seq and (18) suggest that there are two periods of increased storm activity‚Äî
from about 1920 to approximately 1949 and from 1996 to 2010. The statistic MS misses
the decrease in level in 1949, but detects the other three changes. A generalized linear

29

model analysis indicates that the four change model is preferable to three changes, but not
surprisingly gives a relatively small z-score to the change in 1949.
A series of interesting, but often challenging examples of contemporary interest are the
slope changes occuring in the new cases day by day of COVID-19 occurring in various
locations. We have used data from
ourworldindata.org
.
Example 7: COVID-19 in Santa Clara County, California. We consider the 72 day history
by day ending on 12 April 2020. The statistic (20), initially at a constant mean value
and allowing for a slope change and for overdispersion, detects an increase in slope on
the 34th day. The quasilikelihood statistic with œà(Œ∏) = Œ∏2 /2, autocorrelation of 0 and
constant variance for the residuals, i.e., effectively just the single change statistic of Section
2, detects a slope increase on the same day. Both a linear least squares analysis and a loglinear (Poisson) analysis confirm this change and indicate 0 autocorrelation. The dispersion
paramter is estimated to be about 20.
Example 8: COVID-19 in South Korea. South Korea provides an example (84 observations
as of 12 April, 2020). which involves multiple changes. We use a quasi-likelihood analysis,
again with 0 autocorrelation. The statistic Seq detects a slope increase at 27, a decrease
at 44, and another increase at 54, all of which seem evident from a plot of the data. The
statistic (18) suggests slope changes at observations 32, 41, and 54 while the statistic MS
also detects three changes: at 32,44, and 55.
Remark. Additional examples and discussion of COVID-19 data are contained in the
online supplement.

30

6

Discussion.

We have studied several score statistics to detect local signals in the form of changes
of level, slope, or (in the online Supplement) the autoregressive coefficient. To segment
the observations, we consider two ‚Äúbottom up‚Äù methods patterned after the methods of
multiple change-point segmentation in Fang, Li and Siegmund (2018) and one ‚Äútop down‚Äù
method, defined in (18).
Estimation of the nuisance parameters, œÅ and œÉ 2 , pose special problems. For the bottom
up methods, in examining an interval of observations for possible change-points, intercept,
level, slope and variance of the process are estimated locally, i.e., using only the data from
the interval under consideration. For the autoregressive coefficient, our theory suggests
using the (global) maximum likelihood estimator estimator under the hypothesis of no
change. Since this estimator can be badly biased and result in a loss of power when there
are change-points, we also consider ad hoc methods based on examination of different parts
of the data. For use of (18), which estimates of œÉ 2 based on the (usually long) interval being
searched, a possible method for dealing with variance heterogeneity arising from the early
part of the data is to discard initial segments of varying length and consider the stability
of the results obtained.
The multiple regression analsis suggested in Section 3.1, based on the assumption that
detected break-points are correct, allows us to see if our segmentation is reasonable, estimate the magnitude of the detected signals, and reconsider our chosen value of œÅ to see if
we have used one that is too small. In most examples, it appears that we have used a larger
value than necessary, which may result in a loss of power in the case of a large discrepancy.
A different approach would be to use initially the value œÅ = 0, or some other small
value to detect change points, apply the multiple regression analysis to discard changes
31

that seem to be superfluous, and then iterate the process with the value of œÅ suggested by
the regression analysis. We have not chosen this path because our goal has been to use
a value of œÅ obtained with at most a small amount of ‚Äúdata snooping,‚Äù in order to claim
that due to minimal re-use of the data the false positive error rate has been adequately
controlled.
Because our emphasis has been on detection of local signals, we have admittedly been
selective in our use of examples and for the most part have limited our subsequent linear
analysis to what it can tell us about our detection methods. In some examples it seems
interesting to ask if there are explanations for the local changes: e.g., what is the evidence
that a temperatures began to increase in the late 19th century, perhaps accompanied by an
hiatus in the early-mid 20th century, before accelerating about 1980? In other examples it
appears that our methods may lead to a reasonable regression fit without suggesting that
the detected change-points need an explanation.
For problems involving sparse, bump like changes as discussed briefly the Supplement,
some superficial analysis suggests that our methods work well since most of the data are
consistent with the null model, and hence global estimation of nuisance parameters does
not pose a serious problem. In view of the ubiquity of genomic applications where ‚Äúbumps‚Äù
have different signatures suggested by a combination of science and experimental technique,
and where the background may involve use of a control group it seems worthwhile to pursue
a more systematic study.
Here we have considered signals in one-dimensional processes, where the number of
possible ‚Äúshapes‚Äù of the signals is relatively small. In view of the much larger variety of
possible multi-dimensional signal shapes and the variety of approaches already existing in
the literature a systematic comparative study of that problem may be valuable.

32

References
R. J. Adler and J. E. Taylor (2007). Random Fields and Geometry Springer-Verlag, New
York-Heidelberg-Berlin.
R. Baranowsk, Yining Chen, and P. Fryzlewicz (2019). Narrowest-over-threshold detection
of multiple change-points and change-point-like features J. Roy. Statist. Soc. B 89, 649672.
K. S. Chan and H. Tong (1990) On likelihood ratio tests for threshold autoregression
JRSSB 52, 469-476.
R. B Davies (1987). Hypothesis testing when a nuisance parameter is present only under
the alternative Biometrika 74, 33-43.
X. Fang, J. Li and D. O. Siegmund (2018). Segmentation and estimation of change-point
models: false positive control and confidence regions Arkiv
P. Fryzlewicz (2014). Wild binary segmentation for multiple change-pont detection. Ann.
Statist. 42, 2243‚Äì2281.
C. C. Heyde (1997) Quasi-Likelihood and Its Application Springer-Verlag, New YorkHeidelberg-Berlin.
A. E. Jaffe, A. P. Feinberg, R. A. Irizarry, and J T. Leek (2012a). Significance analysis
and statistical dissection of variably methylated regions. Biostatistics 13, 166‚Äì178.
A. E. Jaffe, P. Murakami, Hwajin Lee, J T. Leek, M. Daniele Fallin, A P. Feinberg, and
R. A. Irizarry (2012b). Bump hunting to identify differentially methylated regions in
epigenetic epidemiology studies, Int. J. of Epidemiology 41, 200‚Äì209.
33

P. D. Jones, D. H. Lister, T. J. Osborn, C. Harpham, M. Salmon, and C. P. Morice
Hemispheric and large-scale land surface air temperature variations: An extesive revision
and an update to 2010. J. Geophys. Res. 117 D05127,doi:10.1029/2011JD017139.
M. Knowles and D. Siegmund (1989) On Hotelling‚Äôs approach to testing for a nonlinear
parameter in regression Int. Statist. Rev. 57 205-220.
M. Knowles, D. Siegmund and H. P. Zhang (1991) Confidence regions in semilinear
regression Biometrika 79 15-31.
C. Loader (1992). A log-linear model for a Poisson process change-point. Ann. Statist. 20
1391-1411.
Gordon Manley (1974) Central England temperatures:monthly means 1659 to 1973 Quarterly J. Roy. Meteorological Soc. 100 389-405.
V. M. R Muggeo (2016) Testing with a nuisance parameter present only under the
alternative: a score based approach with application to segmented modeling J. Statistical
Computation and Simulation doi: 10.1080/00949655.2016.1149855
A. B. Olshen, E. S. Venkatraman, R. Lucito and M. Wigler (2004). Circular binary segmentation for the analysis of array-based DNA copy number data. Biostatistics 5, 557‚Äì572.
A. E. Raftery and V. E. Akman (1986). Bayesian analysis of a Poisson process with a
change-point. Biometrika 73, 85‚Äì80.
M. W. Robbins, C. M. Gallagher, and R. Lund (2016). A general regression change-point
test for time series data, Jour. Amer. Statist. Assoc. 111 670‚Äì683.

34

A. Schwartzman, A. Jaffe, Y. Gavrilov, Y. and C.

E. Meyer (2013). Multiple testing of

local maxima for detection of peaks in ChIP-seq data, Ann. Appl. Statist., 7, 471-494.
H. Shin, T. Liu, X. Duan, Y. Zhang, X. S. Liu (2013). Computational methodology for
ChIP-seq analysis. Quantitative Biology 1, 54‚Äì70.
D. O. Siegmund and K. J. Worsley (1995). Testing for a signal with unknown location and
scale in a stationary Gaussian random field. Ann. Statist. 23, 608‚Äì639.
A. F. M. Smith and D. G. Cook (1980). Strait lines with a change-point: an analysis of
some renal transplant data J. Roy. Statist. Soc. Series C 29, 180-189.
J.

D. Toms and M. L. Lesperance Piecewise regression: a tool for identifying ecological
thresholds Ecology 84, 2034-2041.

N. R. Zhang, D. O. Siegmund, H. Ji and J. Z. Li (2010). Detecting simultaneous changepoints in multiple sequences. With supplementary data available online. Biometrika 97,
631‚Äì645.

35

SUPPLEMENTARY MATERIAL
Appendix A: Some Basic Calculations
In this appendix we record basic formulas we have used in the paper. Assume the model
is given by (2) with M = 1 and ¬µu = Œ± + Œ≤[(u ‚àí (T + 1)/2)/T ]. The expressions given
below are asymptotic for T >> 1; and for some specific examples, the results used are
P
computed in continuous time. Hence, for example, Tu=1 f [(u ‚àí t)/T ] may be evaluated
R1
as T 0 f (u ‚àí t/T )du, and E(Yu ) may be computed after solving the differential equation
(3). In the change-point problems of (Fang, Li and Siegmund (2018)), where the function
f is discontinuous, use of a continuous time model would result in considerable loss of
accuracy, but it seems much less consequential here where for many of our examples, in
particular for broken line regression, the stochastic processes under consideration have
piecewise differentiable sample paths. Let Œ≥ = 1 ‚àí œÅ. Then
X
X
Yu = (
œÅj )[Œ± + Œ≤(u/T ‚àí 1/2]) +
œÅj u‚àíj + Op (1/T ),

(21)

j‚â•0

or alternatively the solution of (3) with Y0 = 0 is
Z u
exp[‚àíŒ≥(u ‚àí s)]{(Œ± + Œ≤(s/T ‚àí 1/2) + Œæf [(s ‚àí t)/T ])ds + dW (s)}.
Yu =

(22)

0

Hence, under the null hypothesis that Œæ = 0 we have
Œ®(t)0 = E(`Œæ `Œ∏ )0 ‚àº T (1, 1/12, (1 ‚àí œÅ)‚àí1 [Œ± + Œ≤/12].
Let ‚àÜu = Yu ‚àí œÅYu‚àí1 ‚àí Œ± ‚àí Œ≤(u ‚àí T /2). The ingredients of the representation Zt =
[`Œæ (t) ‚àí Œ®(t)0 A`Œ∏ ]/œÉ(t) introduced in Section 2 are
`Œæ (t) =

X

‚àÜu f [(u ‚àí t)/T ];

u

36

X
X
X
`Œ∏ = (
‚àÜu ,
‚àÜu [(u ‚àí (T + 1)/2)/T ],
‚àÜu Yu‚àí1 )0 ;
u

u

u

X
X
X
Œ®(t) ‚àº (
f [(u‚àít)/T ],
f [(u‚àít)](u/T ‚àí1/2),
{f [(u‚àít)/T ](Œ±+Œ≤[(u‚àíT )/(2T )]}/(1‚àíœÅ))0 .
u

u

u

For the special case of broken line regression in continuous time the first and second coordinates are respectively g1 (t, T ) = (T ‚àí t)2 /2T 2 , g2 (t, T ) = [(T ‚àí t)3 /12 ‚àí t(T ‚àí t)2 /4]/T 3 .
The matrix A‚àí1 = E(`Œ∏ `0Œ∏ ) is straightforward to compute and somewhat tedious to
invert. A very useful result is
X
X
X
Œ®(t)0 A = (
f [(u ‚àí t)/T ],
f [(u ‚àí t)/T ][(u ‚àí 1/2)/T ]/
(u/T ‚àí 1/2)2 , 0).
u

u

(23)

u

It follows that the numerator of Zt , has covariance function
Œ£(s, t) ‚àº

X

f [(u ‚àí s)/T ]f [(u ‚àí t)/T ] ‚àí Œ®(s)0 AŒ®(t),

(24)

u

which does not depend on Œ±, Œ≤, nor on œÅ. In particular
œÉ 2 (t) ‚àº

X

f [(u ‚àí t)/T ]2 ‚àí Œ®(t)0 AŒ®(t).

(25)

u

To derive (15) and (17) (see below), we must consider T as variable and study the
quantities œÉ 2 , Œ®, etc., as functions of both t and T . It is obvious from (25) that ‚àÇœÉ 2 (t, T )/‚àÇT
does not depend on nuisance parameters. Since Œ®(t, T ) depends on the nuisance parameters
(Œ±, Œ≤, œÅ) only in its third coordinate, if we first differentiate (23) with respect to T , then
multiply on the right by Œ®(t, T ) it follows from (23) that neither (‚àÇŒ®/‚àÇT )0 AT Œ®(t, T ) nor
Œ®(t, T )0 (‚àÇAT /‚àÇT )Œ®(t, T ) depends on nuisance paramters. The approximation (17) requires
that we introduce T0 < t as a third parameter. For broken line regression we also require
Œ®0 A‚àÇŒ®/‚àÇT0 = ‚àí3T 3 (1 ‚àí t/T )2 g2 [(t ‚àí T0 )/T, (T1 ‚àí T0 )/T ]/(T1 ‚àí T0 )3 .
37

(26)

To study the behavior of Zt when Œæ is different from 0, and to help with the interpretation
of a plot of Zt , we put t = (t1 , . . . , tk ), Œæ = (Œæ1 , . . . , Œæk ) and use the notation Et,Œæ (¬∑). By
combining the results given above we find that
Et,Œæ (Zs ) =

X

Œæj Œ£(tj , s)/œÉ(s).

(27)

j

Appendix B: Additional Broken Line Examples.
Example 9: Reconstruction of Global Sea Levels. We consider the reconstruction of Church
and White (2011) of global sea levels beginning in 1880. An updated version of the data
can be found at
https://github.com/datasets/sea-level-rise/blob/master/archive/
Our test for at least one change detects a slope increase in 1991. See Figure 5, where
the broad peak of the plot of Zt suggests there may be more than one change-point. The
estimated autocorrelation based on all the data is 0.34, and with this estimate Seq detects
slope increases in 1938 and 1999. With the same estimate of œÅ MS detects only the change
in 1999. However, in the first 100 observations the estimated autocorrelation is only 0.14.
With an autocorrelation of 0.25 for MS, slope changes are detected in 1935 and 2000. A
linear model incorporating these two changes yields an R2 greater than 0.99 and an estimate
for œÅ of 0.06. With œÅ = 0.34 the test (18) to detect two changes at a time indicates in
addition to slope increases in 1932 and 1991 a decrease in 1915. With these three changes a
linear analysis gives approximately the same R2 and œÅ as the model with only two changes.

38

Example 10: Northern Hemisphere Ocean Temperature Anomalies. An interesting example
is provided by time series of ocean temperature. Both NOAA and the Hadley Center
provide relevant data. The northern hemisphere temperatures appear to be an interesting
illustration of our methods since a plot of the data suggests the possibility of multiple
changes during the 20th century. We first consider the NOAA monthly anomalies, with m
= 1665.
ftp://ftp.ncdc.noaa.gov/pub/data/noaaglobaltemp/operational/timeseries/
Our test for at most one change gives a p-value about 0.001 and an estimated autocorrelation of 0.94 (cf. Figure 6). Since estimates of œÅ based on segments of the data that
appear not to involve changes were no more than 0.9, we tried using Seq with that value of
œÅ and a threshold equal to the nominal 0.05 threshold of 4.40. At these settings an increase
was detected at observation 367 months (1912), a decrease at 756 (1943), and a second
increase at 1133 (1974). For the m = 139 average annual anomalies, where œÅ appears to be
substantially smaller, at a threshold of b = 3.75, m0 = 4, and œÅ set equal to 0.5, positive
changes are detected in 1910 and 1975, with an intervening negative trend in 1943. At the
conventional level 0.05, MS detects the first and the third of these change-points, but misses
the second. For the annual average northern hemisphere ocean temperature anomalies a
linear model without changes has an R2 of 0.88. Incorporating the three slope changes
detected by Seq into the model produces only a small increase in R2 to 0.90, but a large
decrease in the estimated value of œÅ from 0.80 to 0.52. The statistic (18) also suggests three
changes in slope, at 1909,1941, and 1974. For these changes the linear model again gives
and R2 of 0.90 and estimates œÅ to be 0.47.
Example 11: Atmospheric Greenhouse Gases. In view of their connection with global
warming, it is interesting to consider atmospheric greenhouse gases. Systematic atmo39

2
0
-4

-2

Z[1:m]

0

20

40

60

80

100

120

Index

Figure 3: Plot of Zt for reconstructed sea level rise from 1880 to 2014.

40

4
3
2
Z[1:m]

1
0
-1

0

500

1000

1500

Index

Figure 4: Plot Zt , NOAA northern hemisphere ocean anomalies.

41

spheric measurements began relatively recently, although reconstructions from surrogate
measurements go back centuries. Atmospheric measurements for CO2 show a number of
increases in slope since about 1960. To illustrate our methods, we first consider global
average methane emissions for 35 years beginning in 1984, reported at
ftp://aftp.cmdl.noaa.gov/products/trends/ch4/.
A linear model without changes shows a positive slope with an R2 of 0.95 and an
autocorrelation of zero. MS detects a slowing of the rate of increase in 1993 followed by
a large increase in 2010. Incorporating these changes into a linear model produces an R2
greater than 0.99 and an autocorrelation of zero. The statistic (18) detects the same two
changes, although it places the initial decrease about 1996.
An example of surrogate measurements of atmospheric CO2 is provided by the web site
of the Institute for Atmospheric and Climate Science (IAC) at the ETH-ZuÃàrich.
https://www.co2.earth/historical-co2-datasets
To provide a comparable time frame to Example 3, we consider the 260 years 1755-2014.
Unlike other examples, where changes are difficult to detect because of large variability, the
variability in these data (and in the recent atmospheric measurements) is very small, so
there appear to be many small changes, that do not help us to understand larger patterns
that may have environment impact. The top down statistic (18) focuses on relatively
few, large changes. The null estimate of œÅ is 0.39. With this value the first two changes
suggested by (18) are slope increases occurring in 1871 and 1959. A linear model with these
change-points produces an R2 of 0.995 and a estimated value of œÅ of 0.01. The statistic MS
with the same value of œÅ and T0 = 20 to deter detection of small changes, detects the large
increase in 1959 and an earlier detection in 1853, which has roughly the same effect on the
linear model as the change in 1871 detected by (18). Both statistics suggest that there
42

are additional small changes in the first hundred years. The statistic (18), but not MS,
suggests there may be a slope decrease in 1943, which together with the two other changes
detected increases R2 to 0.997. This change may be interesting insofar as it appears to
coincide roughly with the hiatus in temperature increases in Greenland shown in Example
3 and the dip in northern hemisphere ocean anomalies mentioned in Example 10.
Appendix C: Bump Hunting: fixed shape, variable amplitude and scale.
In a variety of problems, the local signal to be detected occurs in a departure from,
followed by a return to, a baseline value. In many cases the shape of the local signal arises
naturally from the scientific context. An important example is inherited copy number
variation, where there is an abrupt increase or decrease from the baseline value of two,
which is followed quickly by a return to the baseline (e.g., Zhang et al. (2010)). Other
examples are ChIP-Seq, where a shape to expect is roughly triangular or double exponential
(e.g., Shin et al. (2013)) , or differential methylation, where a normal probability density
function or an integral thereof might be reasonable (cf. Jaffe, et al. (2012a)).
We modify (2) to include a scale paramter œÑ , to obtain the log likelihood function
T
X
X
Œæk f {(u ‚àí tk )/œÑk }]2 .
[Yu ‚àí œÅYu‚àí1 ‚àí ¬µu ‚àí
‚àí .5
1

(28)

k

Here f is a positive, symmetric integrable function, e.g., the square root of (i) a standard
normal density function, (ii) a triangular probability density on [‚àí1, 1], (iii) a double exponential probability density, or (iv) a uniform probability density function on [‚àí1/2, 1/2].
Consider the case of at most one bump and assume that the search interval is long enough
relative to the scale parameter that it is reasonable to ignore end effects. We define our
standardized statistic as above, but we now write it as Zt,œÑ to reflect the unknown location
t and width œÑ of the bump. An approximation to its false positive error probability is
43

given in display (9). (For (iv) above a different approximation is required because of the
discontinuities in f . See Fang, Li and Siegmund (2018).)
Often bumps are relatively sparse, which makes estimation of œÅ and œÉ 2 relatively easy,
so one can see intervals of the data that can be used for estimating autocorrelation and
other nuisance parameters without serious bias.
Although a serious study of these methods is warranted by the variety of potential applications, we do not discuss these in detail here, which would require a lengthy investigation
of the specific scientific features of those applications.
Appendix D: Additional COVID-19 Examples.
Example 11. COVID-19 in Italy. An interesting example is Italy, which had substantial
difficulty in controlling the spread of the virus. Using data for 74 days up to (including)
12 April 2020, we find that MS detects changes an increase at day 34 and a substantial
decrease at day 53. A linear least squares analysis and a (quasi) Poisson analysis suggest
that these changes are reasonable.
Example 12. COVID-19 in Hong Kong An extremely well organized and informative web
site is
chp-dashboard.geodata.gov.hk/covid-19/en.html
.
For 80 days of data up to 12 April, 2020, the method MS detects an increase in new cases on
the 52nd day, followed by a decrease on the 66th. Both a least squares linear analysis and
a (quasi)Poisson analysis suggest these are reasonable, with no day to day autocorrelation.
Results for Taiwan are similar.
Example13. COVID-19 in China In addition to South Korea, discussed above, China is
another country that has apparently managed to stop the epidemic, but it poses a special

44

challenge because the data are very noisy and contain one huge outlier in the center of
the sequence of observations. To mitigate the effect of this outlier, we assumed that there
had been a reporting delay and arbitrarily distributed many of those cases between the
preceding two days. For the 97 days before 6 April 2020, Seq detects three changes at days
20, 46, and 55, while (18) would place them at 24, 45, and 54. Both the least squares linear
analysis and a generalized linear (quasi)Poisson analysis seem to approve of these results.
MS also detects three changes, at slightly different locations. Results for Taiwan are quite
similar.
The COVID-19 data typically start with a small number of cases showing relatively little
day to day variability. When the number of cases is larger, the variability also becomes
larger. In some cases it is enormous, apparenly partly due to reporting delays that can
lead to huge fluctuations in a one or two days interval. The bottom up methods, Seq
and MS seem to control the false positive rate reasonably well, because they estimate the
variance of the data locally. In contrast (18) estimates the variance globally‚Äîaccording to
the interval searched, so it may make false positive errors by using a variance that is too
small. However, its stability can be checked by looking for consistency when the starting
point of the sequence is varied. There are limitations, since starting the search too late in
the sequence makes it difficult to detect an early change. To avoid some of the reporting
incongruities, it is tempting to use a moving average of the day to day data. This reduces
the variance but increases the autocorrelation quite substantially. In a small number of
numerical experiments, it did not seem to offer consistent advantages. An interesting
feature of our linear least squares analysis of the detected changes is that the estimated
slopes are additive, so we have some information about the danger of another flare-up.
In both the South Korean and the China data, the net slope change is close to zero. It

45

may be interesting to consider a (quasi)Poisson log linear analysis, which usually agrees
with the linear least squares analysis. The dispersion parameter often indicates large overdispersion. We have also considered a detection strategy using a square root transformation
of the dependent variable, which would be expected to stabilize Poisson like variability.
Simulations suggest that this technique can be useful, but also that heteroscedasticity is
usually not a serious problem.
Appendix E: Threshold Autoregression
As a final illustration of our methods we consider a simple case of Threshold Autoregression, which has been studied in a number of papers by Tong and colleagues.
For a model assume
Yu = ¬µ + œÅYu‚àí1 + ŒæYu‚àí1 I{Yu‚àí1 ‚â§ t} + u

(29)

To test Œæ = 0, in the notation of Section 2
`Œæ (t) =

X
(Yu ‚àí ¬µ ‚àí œÅYu‚àí1 )Yu‚àí1 I{Yu‚àí1 ‚â§ t},
u

and asymptotically under the null hypothesis we have
Œ®(t)0 ‚àº T (E(Y ; Y ‚â§ t), E(Y 2 ; Y ‚â§ t)),
X
X
`ÀôŒ∏ = ( (Yu ‚àí ¬µ ‚àí œÅYu‚àí1 ),
(Yu ‚àí ¬µ ‚àí œÅYu‚àí1 )Yu‚àí1 ),
and A‚àí1 is the 2 √ó 2 matrix with entries a11 = T, a12 = T E(Y ), a22 = T E(Y 2 ), where Y
denotes the stationary distribution of Yu under the null hypothesis (and the stationarity
assumption that |œÅ| < 1). Hence
œÉ 2 (t) ‚àº T E(Y 2 ; Y ‚â§ t)
46

‚àí T [E2 (Y 2 ; Y ‚â§ t) + E(Y 2 )E2 (Y ; Y ‚â§ t) ‚àí 2E(Y )E(Y ; Y ‚â§ t)E(Y 2 ; Y ‚â§ t)]/Var(Y ). (30)
Let G( t) = E(Y 2 ; Y ‚â§ t), so œÉ 2 (t) ‚àº T [G(t) ‚àí Œ®(t)0 AŒ®(t)]. Straightforward calculations show that the covariance of the standardized score statistics Zs and Zt are given by
[G(min(s, t)) ‚àí Œ®0 (s)AŒ®(t)]/œÉ(s)œÉ(t). Hence locally for small Œ¥

Cov(Zt , Zt+Œ¥ ) ‚âà I ‚àí (Œ¥/2)[G ‚àí Œ®0 AŒ®]‚àí1 GÃá,
where the functions G, Œ® and GÃá are evaluated at t, and slightly more generally Cov[(Zt+Œ¥1 , Zt+Œ¥2 )|Zt ] ‚âà
min(Œ¥1 , Œ¥2 )[G ‚àí Œ®0 AŒ®]‚àí1 GÃá. This allows us to calculate an approximation to P{maxt |Zt | ‚â•
b}. The methods of, e.g., Woodroofe (1976) or Yakir (2013) lead after some calculation to
Z t1
P{ max |Zt | > b} ‚âà 2bœï(b)
[Œ®0 (t)AŒ®Ãá(t)/œÉ 2 (t)]dt.
(31)
t0 <t<t1

t0

We have evaluated (31) by numerical integration, and the p-values given below come
from that evaluation with the observed mean value and standard deviation. We have also
implemented an empirical version of this approximation, where the entire computation is
based on the appropriately estimated quantities. These two approximations are in rough
agreement for our examples, where the p-value is very small. Simulations suggest that the
Type I error control of (31) is adequate under the model The power also seems reasonable.
In principle, one should learn something from the maximizing point of the statistic Zs
relative to the estimated values of ¬µ and of œÉ, but in simulations the maximizing value of
shows more variability than we can easily interpret. A calculation similar to that giving
(30) indicates that in the case that Œæ 6= 0 the expected value of Zt is approximately
ŒæT 1/2 œÉ(t), as it would be for likelihood theory with standard regularity conditions. This
approximation seems relatively stable and suggests a rough approximation for Œæ by equating
the approximation to the observed value of maxs Zs (or mins Zs ).
47

With a slight modification in principle, but substantially more detailed calculation in
application, one can consider higher order autoregressions. Suppose, for example, the model
is
Yu = œÅ1 Yu‚àí1 + œÅ2 Yu‚àí2 + (Œæ1 Yu‚àí1 + Œæ2 Yu‚àí2 )I{Yu‚àí2 ‚â§ t} + u .
Now Xt is a two-dimensional vector, while G(t), Œ®(t), and œÉ 2 (t) = Œ£t , say, are 2 √ó 2
‚àí1/2
Vt ,
matrices. An appropriate test statistic has the form maxt Vt0 Œ£‚àí1
t Vt . Putting Zt = Œ£

we can control the false positive probability based on the approximation
P{ max ||Zt || > b}
t0 <t<t1

2

2

‚àí1

Z

t1

Z

2œÄ

‚âà (b /2) exp(‚àíb /2)(2œÄ)

t0

2
e0 Œ£‚àí1
t GÃá(t)edœâdt + exp(‚àíb /2),

(32)

0

where e = (cos(œâ), sin(œâ))0 , and where œÄ ‚àí1 times the integral over œâ equals the trace of
Œ£‚àí1
t GÃá(t).
Simulations suggest that the Type I error control of this procedure is adequate under
the model. The power also seems reasonable. In principle, one should learn something
from the maximizing point of the statistic Zt relative to the estimated values of ¬µ and of
œÉ, but in simulations the maximizing value of t shows more variability than we can easily
interpret.
Examples. As illustrative applications, we follow Chan and Tong (1990) in considering
the Canadian lynx data and Nicholson‚Äôs blowfly data. We do not, however, try to give a
complete discussion of these well studied data.
The Canadian lynx data consist of annual counts over a 114 year period, which are
considered a surrogate for the size of the lynx population. The scientific reasoning behind
a two-phase model is the hypothesis that when the lynx population is small, it finds a more
48

than adequate food supply and increases until it reaches a size where the food supply is
inadequate, when it then decreases until the cycle begins again. Empirical observations
suggest that the decrease in times of food shortage is more rapid than the increase in times
of abundance. If we use a first order auto regressive model, these fluctuations suggest a
positive autoregressive parameter in times of food abundance, which decreases when there
is a food shortage. Although there are clear outliers in the data, which has lead others to
consider transformations to shorten the tails, we analyze the original data. Employing the
first order autoregressive model with a possible change in the autoregressive parameter, as
suggested above yields null estimators of E(Y ) and Var(Y ) of 1538 and 1560, respectively.
The maximum value of Zt is 3.89, which occurs at about t = 3500, and the resulting
(two-sided) p-value based on (31) is approximately 0.004.
Nicholson‚Äôs blowfly data (Brillinger (et al. 1980) and the web site
www.stat.berkeley.edu/ brill/blowfly97I.html
contains 361 observations in four columns, labeled respectively ‚Äúbirths,‚Äù ‚Äúnonemerging,‚Äù
‚Äúemerging,‚Äù and ‚Äúdeaths.‚Äù The first, third, and fourth columns vary from numbers close to
0 to numbers in the several thousands. The second column typically involves substantially
smaller numbers. For the first column. the estimated mean value, autocorrelation, and
standard deviation under the null model are 1438, 0.6 and 1670, respectively. The maximum
Z value is about 4.73, which occurs for t ‚âà 5300. The p-value for the hypothesis of no change
is approximately 2 √ó 10‚àí4 . For ‚Äúemerging‚Äù the maximum Z-value is about 5.22, which gives
a p-value of about 6 √ó 10‚àí5 . For these data the change in the autocorrelation is positive.

49

References
D. R. Brillinger, J. Guckenheimer, P. Guttorp and G. Oster (1980) Empirical modelling of
population time series data: the case of age and density dependent vital rates Lectures
on Mathematics in the Life Sciences 13, 65-90 American Math. Soc.
K. S. Chan (1991) Percentage points of the likelihood ratio test for threshold autoregression
JRSSB 53, 691-696.
K. S. Chan and H. Tong (1990) On likelihood ratio tests for threshold autoregression
JRSSB 52, 469-476.
J. A. Church and N. J. White (2011) Sea level rise from the late 19th to the early 21st
century Surv. Geophysis. 32, 585-602.
A. E. Jaffe, A. P. Feinberg, R. A. Irizarry, and J T. Leek (2012a). Significance analysis
and statistical dissection of variably methylated regions. Biostatistics 13, 166‚Äì178.
A. E. Jaffe, P. Murakami, Hwajin Lee, J T. Leek, M. Daniele Fallin, A P. Feinberg, and
R. A. Irizarry (2012b). Bump hunting to identify differentially methylated regions in
epigenetic epidemiology studies, Int. J. of Epidemiology 41, 200‚Äì209.

50

