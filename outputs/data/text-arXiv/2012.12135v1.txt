COVID-19: Optimal Design of Serosurveys for Disease Burden
Estimation
Siva Athreya∗1 , Giridhara R. Babu2 , Aniruddha Iyer3 , Mohammed Minhaas B.S.3 , Nihesh
Rathod3 , Sharad Shriram3 , Rajesh Sundaresan3,4 , Nidhin Koshy Vaidhiyan3 and Sarath
Yasodharan3

arXiv:2012.12135v1 [stat.AP] 22 Dec 2020

1

Indian Statistical Institute, Bangalore Centre
Indian Institute of Public Health, Bangalore
3
Indian Institute of Science, Bangalore
4
Strand Life Sciences

2

December 23, 2020

Abstract
We provide a methodology by which an epidemiologist may arrive at an optimal design for a survey
whose goal is to estimate the disease burden in a population. For serosurveys with a given budget of C
rupees, a specified set of tests with costs, sensitivities, and specificities, we show the existence of optimal
designs in four different contexts, including the well known c-optimal design. Usefulness of the results
are illustrated via numerical examples. Our results are applicable to a wide range of epidemiological
surveys under the assumptions that the estimate’s Fisher-information matrix satisfies a uniform positive
definite criterion.

Keywords: c-optimal design, serosurvey, COVID-19, worst-case design, Fisher Information, weighted
estimate, adjusted estimate.
AMS Classification: 62K05, 62P10

1

Introduction

For evidence-based public health management during a pandemic, epidemiologists conduct surveys to estimate
the total disease burden. The surveys use multiple tests on participants to gather evidence of both past
infection and active infection. For example, the recently concluded first round of the Karnataka state
COVID-19 serosurvey [1] involved three kinds of tests on participants: the serological test on serum of
venous blood for detection of immunoglobulin G (IgG) antibodies, the rapid antigen detection test (RAT),
and the quantitative reverse transcription polymerase chain reaction (RTPCR) test for detection of viral
RNA. The tests provide different kinds of information, e.g. past infection or active infection. The tests
have remarkable variation in reliability, e.g., the RAT has sensitivity (i.e probability of a positive test given
that the patient has the disease.) of about 50% while the RTPCR test has a sensitivity of 95% or higher
(assuming no sample collection- or transportation-related issues); there is variation, albeit less spectacular,
in specificities (i.e probability of a negative test given that the patient is well.). The test costs also vary,
e.g., the RAT cost was Rs. 450 while the RTPCR test cost was Rs. 1600 on 10 December 2020. Conducting
all three tests on each participant is ideal but can lead to high cost.
Suppose J is the set of tests and T = 2J \ ∅ be all the nontrivial subsets of tests. If a subset of tests
t ∈ T is used on a participant, the cost ct is the sum of the costs of the individual tests constituting t. A
survey design is defined as (wt , t ∈ T ), where wt ≥ 0 is the number of participants who are administered the
1
subset t of tests. We
P relax the integrality requirement on wt and will assume wt ∈ R+ . The cost of this
design is obviously t∈T wt ct . The question of interest is:
∗ Corresponding
1 Integrality

Author: athreya@isibang.ac.in
can be met if we randomise and constrain the expectation.

1

Figure 1: Noise model for the RAT, RTPCR, and antibody test outcomes. The left-most subfigure is for RAT,
j = 1. The middle subfigure is for the RTPCR test, j = 2. The right-most figure is for the antibody test, j = 3.
In each subfigure, the first connection is a “noiseless” channel indicated by M (s, j). In each subfigure, the second
channel is a noisy binary asymmetric channel whose correct outcome probabilities are given by the specificity σ(0, j)
and sensitivity σ(1, j). The values are indicated in Table 2. The cross-over probabilities are 1 minus these.

Given a budget of C rupees, a set of tests, their costs, their sensitivities, specificities, and the
goal of estimating the disease burden, what is a good survey design?
In this short note we address the above question for four specific optimisation criteria. Motivated by
the sero-survey discussed above we assume a specific model (see Section 1.1) and find the best design for
each criteria. In our first result, Theorem 1, we show the existence of a c-optimal design. We then consider
a worst-case design in Theorem 2, optimal design of surveys conducted across different strata in Theorem
3, and optimal design when additional information about the participants such as symptoms are observed
in Theorem 4. We also present numerical examples2 illustrating the applicability of the theorems, see in
particular Table 3 in Section 1.2. The results are not limited to the assumed settings and can be applied to
more general epidemiological surveys as well, see Remark 1.

1.1

Model and Main Results

As discussed in the introduction, the primary motivation for this note was to find optimal designs when one
needs to use multiple tests to estimate COVID-19 burden in a region. We shall formulate our results with
the model used in the Karnataka serosurvey, see [1]. As we will see in Remark 1 our results have wider
applicability to other models and surveys.
Each individual of the population will be assumed to be in one of four states. Namely: (i) having active
infection but no antibodies, (ii) having antibodies but no evidence of active infection, (iii) having both
antibodies and active infection, and (iv) having neither active infection nor antibodies. The state of the
participant in a survey is inferred from the RAT, the RT-PCR, and the antibody test outcomes, or a subset
thereof. As the tests have known sensitivities and specificities their outcomes are thus noisy observations of
the (unknown) disease state of the individual.
The main focus is on estimating the total disease burden, which is ℘ := p1 + p2 + p3 , where pi are the
probabilities of the various states and are unknown to the epidemiologist (See Table 1). We will assume
the parameter space P to be a convex and compact subset of [0, 1]3 . Let the indices j = 1, 2, and 3 stand
for RAT, RTPCR and antibody tests, respectively. The last three columns of Table 1 provide the nominal
responses on the RAT, RTPCR and the antibody tests for each of the four states. Write M (s, j) for the
nominal test outcome for an individual in state s; M (s, j) = 1 indicates a nominal positive outcome, and
M (s, j) = 0 indicates a nominal negative outcome.
As alluded to earlier, the actual test outcomes may differ from the nominal outcomes. In Figure 1, there
are three channels for the three tests. Each channel has a deterministic binary-output channel followed by
a noisy binary asymmetric channel. The deterministic output is M (s, j) for test j on input s. Let σ(0, j)
denote the specificity of test j, and let σ(1, j) denote the sensitivity of test j. The final output of test j is
the output of the noisy binary asymmetric channel with this sensitivity and specificity, see Figure 1. We can
thus view each test outcome (RAT or RT-PCR or antibody) as the output of two channels in tandem, with
the disease state as input.
2 The source code (in R and Python) that was used to generate the results corresponding to Theorems 1 and 2 in Table 3
can be found at the following URL: https://github.com/cni-iisc/optimal-sero-survey-design

2

State s
s=1
s=2
s=3

s=4

Table 1: Table of states and nominal test responses M (s, j)
Probability State description
RAT RTPCR
j=1
j=2
p1
Active infection but no antibodies
1
1
p2
Antibodies present but no evidence of ac0
0
tive infection
p3
Simultaneous presence of active infection
1
1
and antibodies
3
X
1−
Neither active infection nor antibodies
0
0
pi

Antibody
j=3
0
1
1

0

i=1

Table 2: The sensitivities and specificities
σ(m, j)
RAT RTPCR test Antibody test
j=1 j=2
j=3
Specificities (m = 0) 0.975 0.97
0.977
Sensitivities (m = 1) 0.5
0.95
0.921
The specificities and sensitivities used for the estimations3 are in Table 2. Let t = (t1 , t2 , t3 ) represent
the subset of tests carried out, or a test pattern. If tj = 1, then test j had a valid outcome; if tj = 0, then
test j was either not conducted or had an invalid outcome. Let y = (y1 , y2 , y3 ), where yj ∈ {0, 1, NA}. The
three values indicating a negative outcome, a positive outcome or an invalid outcome, respectively. Let Yt
denote the set of possible outcomes for the subset of tests t.
We assume that the test outcomes of an individual are conditionally independent given the disease state of
the individual4 . Then for an individual in state s with test pattern t = (t1 , t2 , t3 ), the conditional probability
of test outcome y = (y1 , y2 , y3 ) is given by
Y
q(y|s, t) =
[σ(M (s, j), j)]1{M (s,j)=yj } · [1 − σ(M (s, j), j))]1−1{M (s,j)=yj }
(1)
j:tj =1

where M and σ are given in Tables 1 and 2, respectively.
This leads to a parametric model for the probabilities of test outcomes (observations) given the diseasestate probabilities (parameters of the model) denoted p = (p1 , p2 , p3 ). Then total burden will be a linear
combination uT p (i.e. u = (1, 1, 1)). The Fisher information matrix, denoted It (p), captures information on
the reliability of the outcomes when a subset t of tests is conducted on the participant. The (i, j)th entry of
It (p) for the above model can be expressed as
X
y∈Yt

(q(y|i, t) − q(y|4, t))(q(y|j, t) − q(y|4, t))T
.
P3
s=1 ps q(y|s, t) + (1 − p1 − p2 − p3 )q(y|4, t)

(2)

For a given survey design (wt , t ∈ T ), using the above likelihood function the maximum likelihood estimate
(MLE) can be obtained, say p̂. Standard results (e.g. [10, Chapter 4]) then will assert the consistency and
asymptotic normality of the MLE, p̂, as the number of samples goes to infinity while keeping the survey
design proportion fixed. We are now ready to state our main results.
1. The c-optimal design. By the asymptotic optimality property, the estimated total burden uT p̂ is approxi−1
P
mately Gaussian with mean uT p and variance uT
u. This suggests the use of the so-called
t∈T wt It (p)
local c-optimal design criterion. The adjective ‘local’ refers to local optimality at p and the criterion is called
c-optimal because the variance of cT p̂ was minimised, for a vector c, in [11, Chapter 5].. Accuracy of the
estimate is generally a combination of precision (narrow confidence intervals) and unbiasedness. Broadly
speaking, given a budget, c-optimal design attempts to resolve the tension between the accuracy of the
estimate and cost efficiency. We shall refer to a survey design (wt∗ , t ∈ T ) as c-optimal if it minimizes the
3 The reliability indicators for the antibody test were measured on the same lot and batch used for the Karnataka sero-survey
[1] and those for the other tests are the same as those used therein.
4 The assumption of independence is a strong one. Indeed it is possible that a symptomatic person can get tested earlier and
during the infectious state, leading to a higher predictive value for the test. For simplicity, we do not model these complications.

3

variance

!−1
X

T

u

u

wt It (p)

t∈T

given the budget C. Our first result is on the c-optimal design.
Theorem 1. Let the budget C > 0, let the parameter p be fixed. Then the c-optimal survey design (wt∗ , t ∈ T )
is given by
wt∗ = vt∗ C/ct , t ∈ T,
(3)
where v ∗ is a solution to the optimisation problem:
!−1
minimise

T

a(v; p) := u

X

vt It (p)/ct

u

(4)

t∈T

X

subject to

vt = 1,

vt ≥ 0, t ∈ T.

t∈T

Furthermore, the minimum variance is given by a(v ∗ ; p)/C.
In other words, for c-optimality, we must allocate vt∗ fraction of the budget C to the subset of tests t;
the number of participants wt∗ that should be administered the subset t of tests is therefore given by (3).
Note that v ∗ is independent of the budget C. A subset t may be highly informative, i.e., uT It (p)−1 u may
be small, yet t may not be attractive when relativised by its cost ct because what ultimately matters is
uT (It (p)/ct )−1 u; see (4). Section 2 contains the proof with additional structural results on the support of
the solution. The last statement of the theorem gives the level of accuracy5 (asymptotic variance of the rescaled estimate) that the budget can buy: accuracy is inversely proportional to the budget. It also suggests
how to solve a related problem: what is the required budget to meet a certain margin
p of error target with
confidence 1 − α? The answer to this question is to find the C that lowers Φ−1 (α/2) a(v ∗ ; p)/C below the
target margin of error, where Φ is the normal cumulative distribution function.
2. Worst-case design. Theorem 1 is a locally optimal design at parameter p, and the optimal design v ∗
may depend on p in general. Whenever we want to highlight this dependence, we will write v ∗ (p). In
practice, we often design for a guessed p; for e.g., the Karnataka serosurvey [1] assumed a seroprevalence
of 10% prevalence to arrive at the required number of antibody tests. One could also use a prior for p and
extend Theorem 1 straightforwardly. Our next result, however, is a design for the worst case, i.e., a design
(wt , t ∈ T ) that minimises
!−1
X
T
max u
wt It (p)
u,
p∈P

t∈T

where P is a convex and compact uncertainty region for the parameter, subject to the budget constraint C.
As optimal designs for the worst case usually go, our solution will involve the Nash equilibria of a
two-player zero-sum game G defined as follows: The pay-off of the game G is
X
uT (
vt It (p)/ct )−1 u
t∈T

with the minimising player chooses v from the probability simplex on T ; the maximising player simultaneously
chooses p from a convex and compact P. The design for the worst case is as follows.
Theorem 2. Any design w∗ for the worst case is of the form wt∗ = vt∗ C/ct , t ∈ T , where v ∗ is a Nash
equilibrium strategy for the minimising player in the game G.
As we shall see, the strategy sets are convex and compact, the pay-off function is concave in p for a fixed
v, convex in v for a fixed p, and by Glicksberg’s theorem [8] there exists a Nash equilibrium. While the
equilibrium may not be unique, it is well-known that this is not an issue for two-player zero-sum games.
The minimising player may pick any Nash equilibrium and play his part of the equilibrium, i.e., there is no
“communication problem” in a two-player zero-sum game.
3. Allocation across strata. Surveys are also conducted across different strata or districts with differing
disease burdens. For example, consider D districts, with p(d) being the disease spread parameter in district
5 We

will assume that the bias is negligible.

4

P
d, d ∈ [D] = {1, . . . , D}. If the population fraction of district d is nd , with d∈[D] nd = 1, then the weighted
P
overall disease burden in the D districts is d∈[D] nd (uT p̂(d)) where p̂(d) is the MLE for district d when
the true parameter is p(d). The nextP
result indicates how the total budget must be allocated across the D
districts to minimise the variance of d∈[D] nd (uT p̂(d)), subject to a total budget of C.
Theorem 3. Let the parameters for the districts be p(d)Pand let the population fractions be nd , d = 1, . . . , D.
The (local) c-optimal design for the weighted estimate d∈[D] nd (uT p̂(d)) is as follows. The optimal budget
allocation Cd for district d is proportional to
p
nd a(v ∗ (p(d)); p(d)),
i.e.,
p

a(v ∗ (p(d)); pd )
p
,
0
a(v ∗ (p(d0 )); p(d0 ))
d0 ∈[D] nd

Cd = C · P

nd

d = 1, . . . , D,

where v ∗ (p(d)) solves (4) for district d. The optimal design in each district is given by wt∗ (d) = vt∗ (p(d))Cd /ct
for each t and d.
Thus a larger fraction of the total budget should be allocated to districts with a larger population, and
to districts with a greater uncertainty in the estimate as measured by the standard error. The precise
mathematical relation is the content of the above theorem. If there is no basis for a guess of p(d) in each
district, then the worst-case design could be employed in each district. Theorem 3 then implies that the
budget allocation is in the proportion of the population. Theorem 3 is also applicable to other kinds of
stratification, for e.g., sex, age groups, risk categorisation, pre-existing health conditions, etc., so long as the
fraction in each component of the stratification under consideration6 is known.
4. Enabling on-the-ground decisions. Often the surveyors have access to additional information about the
participants that might affect the quality of the test outcomes. Let us consider the example of participants
presenting with or without symptoms. This is useful information that can inform what tests should be
employed. The Karnataka serosurvey found that the RAT is more sensitive on participants with symptoms
than on participants without symptoms (68% and 47%, respectively, see [1]). Let s by the symptom-related
observable with s = 0 denoting the absence of symptoms and s = 1 denoting the presence of symptoms. Let
rs , s = 0, 1 denote the asymptomatic and the symptomatic fractions of the population.
Let p(s) be the model
P
parameter for substratum s, s = 0, 1. The goal is to estimate the total burden s=0,1 rs (uT p(s)). Assuming
P
MLE in each substratum, the objective continues to be the minimisation of the variance of s=0,1 rs (uT p̂(s)).
Since the tests’ reliability depend on whether a participant is symptomatic or asymptomatic, let Its (p(s))
be the Fisher information matrix associated with the group s, when the subset of tests employed is t and
the group s parameter is p(s). Let v ∗ (p(s)) denote the optimum allocation of the budget7 , given to group
s, across the subsets of tests. Further, let as (v ∗ (p(s)); p(s)) denote the value of (4) for group s, when the
parameter is p(s) and the Fisher information matrices are Its (p(s)), t ∈ T . The next result is the following.
Theorem 4. The optimal budget allocation Cs for group s is in proportion to
p
rs as (v ∗ (p(s)); p(s)),
i.e.,
Cs = C P

p

as (v ∗ (p(s)); p(s))
p
,
rs0 as0 (v ∗ (p(s0 )); p(s0 ))

rs

s = 0, 1,

s0 =0,1
∗

where v (p(s)) solves (4) for group s. The optimal design for each group s is given by wt∗ (s) = vt∗ (p(s))Cs /ct
for each t and s.
Note that the optimal allocation in Theorem 4 is similar to that in Theorem 3, with the difference being
as (v ∗ (p(s)); p(s)) depending on the group s in Theorem 4. The optimal budget for C0 and C1 suggests how
many asymptomatics and symptomatics must be tested. Furthermore, the test prescription adapts to the
presence or absence of symptoms presented by the participant. Finally, Theorem 4 is also applicable to
other settings where information about participants’ variables and factors are observable, and are known to
affect the quality of testing, e.g., severity of the symptoms and the possible high viral load leading to better
sensitivity of viral RNA detection tests.
6 For example, we should know the male fraction of the population and the female fraction the population for the sex-based
stratification. These replace the nd in Theorem 3.
7 Note that a more proper notation would have been v ∗ (p(s); s) at the expense of cumbersome notation. We will omit the
dependence of v ∗ on s for notational convenience.

5

Table 3: Numerical examples for a budget of Rs. 1 Crore.
Criterion
Local
Local
Local
Worst-case
On-the-ground, 10% symptomatic
RAT sensitivity 0.68(S) 0.47(A)

1.2

RAT

Test cost in Rs.
RTPCR
Antibody

Parameter or parameter range
p1
p2
p3

450
450
450
450

1,600
1,000
100
100

300
300
300
300

0.10
0.10
0.10
0.01-0.15

0.30
0.30
0.30
0.10-0.50

0.01
0.01
0.01
0.00-0.02

450

1,600

300

0.10

0.30

0.01

Optimal design (quantised to Z+ )
S/A
(0,0,1)
(1,0,1)
(0,1,1)
S
A

521
8,000
0
838
300
0

13,125
0
0
0
1,046
12,167

0
5,846
25,000
24,371
0
0

Numerical Examples

In this section we shall discuss several numerical examples illustrating the applications of our main results.
We begin with some examples connected to Theorem 1. Consider a local c-optimal design at p =
(0.10, 0.30, 0.01), the fractions of those with active infection alone, those with antibodies alone, and those
that show both active infection and antibodies. Suppose that the budget is Rs. 1,00,00,000 = Rs. 1 Crore.
Let us fix the RAT and antibody test costs at Rs. 450 and Rs. 300, respectively. In the first row of Table 3,
the RTPCR test costs Rs. 1,600. The optimal allocation is to run antibody tests alone on 521 participants
(t = (0, 0, 1)) and the RAT and antibody tests on 13,125 participants (t = (1, 0, 1)). In particular, no
RTPCR tests are done. In the second row of Table 3, the RTPCR test cost comes down to Rs. 1000. Then
the optimal allocation is to run antibody tests (t = (0, 0, 1)) on a larger number of participants, namely
8,000, and the RTPCR and antibody tests on 5,846 participants (t = (0, 1, 1)). In particular, RTPCR is
sufficiently competitive that no RAT tests are done. In the third row of Table 3, the RTPCR test costs
only8 Rs. 100. The optimal allocation is to run exactly one test pattern, the RTPCR and the antibody tests
(t = (0, 1, 1)), on 25,000 participants.
Our next set of example is with regard to Theorem 2. Consider the numerical example in the fourth
row of Table 3 where the RTPCR test cost is only Rs. 100. The range for p2 comes from the Karnataka’s
serosurvey [1] where the districts’ total burden varied from 8.7% to 45.6%. The ranges for p1 and p3 also
come from [1]. The worst-case (obtained via a grid search with 0.01 increments) is near p = (0.06, 0.45, 0.0).
The optimal design is to spend 2.5% of the budget on antibody tests alone, and 97.5% of the budget on the
combination of RTPCR and antibody tests. For the indicated costs, this comes to 838 participants getting
only antibody tests and 24,371 participants getting the RTPCR and antibody tests, see the fourth row of
Table 3.
Since an overwhelming part of the budget is for the test pattern (0, 1, 1), for logistical reasons, all
participants will be administered RTPCR and antibody tests in the second serosurvey for Karnataka (January
2021). Calculations (that we do not present here) indicate that the worst-case variance increases by a factor
1.0023, and so the number of samples must be increased by this factor to achieve the same margin of error and
confidence. But the logistical simplicity is well worth extra cost, considering the magnitude and decentralised
nature of the survey.
We now discuss an insightful numerical example related to Theorem 4. Consider a setting where the RAT
costs Rs. 450, the RTPCR costs Rs. 1,600 and the antibody test costs Rs. 300. Let us go back to the local
c-optimal design criterion for p = (0.1, 0.3, 0.01). Additionally, let 10% of the population be symptomatic
(r1 = 0.1). The optimal allocations under Theorem 4 indicate that roughly 91.2% of the budget must
be spent on the asymptomatic population and 8.8% on the symptomatic population. The reduction for
the symptomatic population is because the estimate is more reliable (given the better sensitivity of the
RAT). As expected, the RTPCR test is too expensive and is completely skipped. More interestingly, all
asymptomatic participants should be administered the RAT and the antibody tests whereas among the
symptomatic participants, a sizable fraction should be administered the antibody test alone. In other words,
a smaller fraction of the symptomatic fraction get the RAT. This might be paradoxical at first glance, for
one might expect an increased use of RAT on participants where it is more effective. There is however an
insightful resolution to this paradox: given that the active infection fraction estimate is likely to be better in
the symptomatic population than in the asymptomatic population, we must invest a portion of the budget
for the symptomatic population on antibody tests alone to improve the estimation of the fraction with past
infection. In the last row in Table 3, we have indicated the numbers to be tested according to the optimal
design.
8 This

big reduction in cost may come from pooled testing strategies.

6

1.3

Prior work and context for our findings

The locally c-optimal design criterion is well-known [11, Chapter 5]. Elfving’s seminal work [6] shows that,
for a linear regression model, the c-optimal design is a convex combination of the extreme points in the
design space. Dette and Holland-Letz [5] extended the characterisation of the c-optimal design to nonlinear
regression models with unequal noise variances. Our Theorem 1 could be recovered from the results of Dette
and Holland-Letz [5] with some additional work to characterise
the solution. Chernoff [4] considered the
P
closely related criterion of minimising the trace of ( t∈T wt It (p))−1 and obtained a convex-combinationof-extreme-points characterisation. This criterion is useful in our setting if the surveyor is interested in
estimating the individual p1 , p2 , and p3 with good accuracies, not just their sum, and gives equal importance
to the three variances. Other design criteria include an optimality criterion that takes into account the
probability of observing a desired outcome in generalised linear models [9], variance minimisation for linear
models but with non-Gaussian noise [7], etc. For us, c-optimality is the most appropriate since our interest
is in estimating uT p.
While the above works deal with locally optimal designs, we also consider the worst-case design problem,
weighted design, and design for on-the-ground decisions in Theorems 2, 3, and 4, respectively. The worst-case
design problem was considered in [11, Chapter 8] where a necessary and sufficient condition for optimality is
given. In principle it should be possible to derive Theorem 2 from that starting point. Our game-theoretic
characterisation was more appealing. To the best of our knowledge, Theorem 4 and applications of Theorems
1-4 to COVID-19 survey design are new. We hope that other survey designers will make use of our findings
at this critical juncture of the pandemic, so that immunisation plans can be better optimised.
Remark 1. Our focus in this note has been optimal design of serosurveys for disease burden estimation.
However our results hold for more general epidemiological surveys. The dimensionality of the parameter p
can be any natural number k, and the u defining the estimate uT p can be any vector in Rk . In any such
a model our results will hold as long as the MLE exists and the corresponding Fisher information matrix,
It (p), corresponding to the parameter p, satisfies the assumption (A1) stated below for Theorem 1, Theorem
3, and Theorem 4, and the assumption (A2), also stated below, for Theorem 2, see Remark 2 in the next
section.
For t ∈ T and p ∈ P, let λp (t) denote the smallest eigenvalue of It (p). We now make precise the
assumptions.
(A1) For a given p ∈ P, there exists t∗ ∈ T such that the matrix It∗ (p) is positive definite.
(A2) There exists t∗ ∈ T such that inf p∈P λp (t∗ ) > 0.

2

Proof of Theorems

Recall that C > 0 is the total budget, T is all the nontrivial subsets of tests, ct is the sum of the costs of
the individual tests constituting t ∈ T , and the survey design is denoted by (wt , t ∈ T ), where wt ≥ 0 is the
number of participants
P (relaxed to a real-value) who are administered the subset t of tests, wt ∈ R+ . The
cost of this design is t∈T wt ct .
We begin with a specific observation with regard to our model.
Remark 2. Let t∗ = (1, 1, 1). When the specificities and sensitivities are as given by Table 2, it is easy to
verify (A1) and (A2) hold. Indeed, from (2), defining
T

v(y, t∗ ) := (q(y|1, t∗ ) − q(y|4, t∗ ), q(y|2, t∗ ) − q(y|4, t∗ ), q(y|3, t∗ ) − q(y|4, t∗ )) ,
and the probability
P (y|t∗ ) :=

3
X

ps q(y|s, t∗ ) + (1 − p1 − p2 − p3 )q(y|4, t∗ ),

s=1

7

we have for any nonzero x ∈ R3



xT It∗ (p)x

= xT 

1
v(y, t∗ )v(y, t∗ )T  x
P (y|t∗ )

X

y∈Yt∗

X

=

y∈Yt∗

X

≥

1
xT v(y, t∗ )
P (y|t∗ )
xT v(y, t∗ )

2

2

y∈Yt∗

> 0,
where the last strict inequality holds because {v(y, t∗ ), y ∈ Yt∗ } is linearly independent, a fact that can
verified for the given sensitivities and the specificities. This not only verifies assumption (A1) for our
example, but also assumption (A2).
We shall use the fact the model satisfies assumption (A1) or (A2) in the proofs below.
Proof of Theorem 1. Let vt = wt ct /C, t ∈ T . Recall a(v; p) from (4). It is immediate that a minimiser of
(4) will yield a c-optimal design given by (3). To find a minimiser, first consider the following optimisation
problem
minimise
subject to

a(v; p)
X
vt ≤ 1,

(5)
vt ≥ 0, t ∈ T.

(6)

t∈T

By Assumption (A1), there exists a v (0) such that a(v (0) ; p) < ∞, and
P hence the minimisation can be
restricted to the set C = {(vt , t ∈ T ) : a(v; p) ≤ a(v (0) ; p), vt ≥ 0, t ∈ T, t∈T vt ≤ 1}. With this restriction
on the constraint set, the above problem is a convex optimisation problem. Indeed, the objective function
is convex on C; for any λ ∈ (0, 1) and any two designs v (a) and v (b) in C, the matrix
!−1
!−1
!−1
X v (a) It (p)
X v (b) It (p)
X (λv (a) + (1 − λ)v (b) )It (p)
t
t
t
t
λ
+ (1 − λ)
−
ct
ct
ct
t∈T

t∈T

t∈T

is positive semidefinite, and the constraint set C is a convex subset of R|T | . Moreover C is also compact: for
any sequence {v (n) , n ≥ 1} in C, being a sequence in the compact set (6), we can extract a subsequence that
converges to an element ṽ of (6); from the definition of C, we must have a(ṽ; p) ≤ a(v (0) ; p) which implies
that
C. Hence there exists a v ∗ = (vt∗ , t ∈ T ) that solves the above problem, see [3, Section 4.2.2]. If
P ṽ ∈
∗
∗
t∈T vt < 1, then we may scale up the v by a factor to use the full budget, satisfy the sum-constraint
with equality, and strictly
reduce the objective function by the same factor, which is a contradiction to v ∗ ’s
P
optimality. Hence t∈T vt∗ = 1. Hence wt∗ = vt∗ C/ct is the desired c-optimal design and the minimum
variance is given by a(v ∗ ; p)/C. This completes the proof.
For information on the structure of an optimal solution, consider the Lagrangian
!−1
!
X
X
X
T
L(v, λ, µ) = u
vt It (p)/ct
u−
λt vt + µ
vt − 1 .
t∈T

t∈T

t∈T

For each t ∈ T ,
!−1
T

∂vt L(w, λ, µ) = −u

X

vt0 It0 (p)/ct0

t0 ∈T

It (p)
ct

!−1
X

vt0 It0 (p)/ct0

u − λt + µ.

t0 ∈T

By the Karush–Kuhn–Tucker conditions [3, Chapter 5], there exist non-negative numbers (λ∗t , t ∈ T ) and µ∗
such that
!−1
!−1
X
It (p) X ∗
T
∗
vt0 It0 (p)/ct0
−u
vt0 It0 (p)/ct0
u − λ∗t + µ∗ = 0, t ∈ T,
(7)
c
t
0
0
t ∈T

t ∈T

µ∗

λ∗t vt∗ = 0, t ∈ T,
!
X
∗
vt − 1 = 0.
t∈T

8

(8)
(9)

Clearly v ∗ 6≡ 0 and µ∗ > 0, otherwise (7) is violated. Conditions (7) and (8) together with the fact that
wt∗ = vt∗ C/ct imply that whenever wt∗ > 0 for some t ∈ T , we must have
!−1
T

u

X

vt∗ It (p)/ct

t∈T

It (p)
ct

!−1
X

vt∗ It (p)/ct

u = µ∗ .

t∈T

We can compute µ∗ easily: multiplying by vt∗ , summing over t, and using

P

t∈T

vt∗ = 1, we see that

!−1
∗

µ =u

T

X

vt∗ It (p)/ct

u = a(v ∗ ; p).

t∈T
3
K
The proof
PK of Theorem 2 requires a preliminary lemma. Fix K ≥ 3 and let v1 , . . . , vK ∈ R . For a ∈ R
such that i=1 ai = 1, define

I(a) =

K
X
1
vi viT .
a
i=1 i

We first prove the following lemma. A similar concavity property holds in the context of parallel sum of
positive definite matrices; see [2, Theorem 4.1.1]. Let RK
++ denote the set of K-vectors whose entries are
strictly positive.
T
−1
u is concave on RK
Lemma 5. Assume I(a) is invertible for all a ∈ RK
++ .
++ . The mapping a 7→ u I(a)

Proof. Let f (a) = uT I(a)−1 u. We have, for i = 1, 2, . . . , K,
∂ai I(a)−1 = −I(a)−1 (∂ai I(a))I(a)−1
1
= 2 I(a)−1 vi viT I(a)−1 .
ai
We also have, for i, j = 1, 2, . . . , K,
∂a2i aj I(a)−1 =

I(a)−1 vi viT I(a)−1 vj vjT I(a)−1 + I(a)−1 vj vjT I(a)−1 vi viT I(a)−1
a2i a2j


−2
+ δi=j
I(a)−1 vi viT I(a)−1 .
a3i

Hence
1 2
uT I(a)−1 vi × viT I(a)−1 vj × uT I(a)−1 vj
∂ai aj f (a) =
2
a2i a2j
1
− δi=j 3 (uT I(a)−1 vi )2 .
ai
Let βi = uT I(a)−1 vi and let Bi,j = viT I(a)−1 vj . Then
1 2
βi Bi,j βj
1
∂
f (a) =
− δi=j 3 βi2 .
2 ai aj
a2i a2j
ai
For positive semidefiniteness of the Hessian of f , it suffices to show that
K
K
X
xi βi Bi,j βj xj X x2i βi2
−
≤0
a2i a2j
a3i
i=1
i,j=1

for all x ∈ RK . With αi =

x√
i βi
ai ai ,

the above condition becomes
K
X

K

X
Bi,j
αi √
αj −
αi2 ≤ 0,
a
a
i
j
i,j=1
i=1
9

which is the same as asking for the largest eigenvalue of the matrix with entries


Bi,j
√
ai aj i,j=1,2,...,K
to be at most 1. Note that
Bi,j
1
1
= √ viT I(a)−1 vj √
√
ai aj
ai
aj


T

vj
vi
−1
I(a)
= √
√
ai
aj

T X 

T !−1 

vi
vi0
vi 0
vj
= √
.
√
√
√
ai
ai0
ai0
aj
0
i

Let ṽi = √vai i and Ṽ = [ṽ1 , . . . , ṽK ]. Then the above entry is the (i, j) entry of the matrix Ṽ T (Ṽ Ṽ T )−1 Ṽ . It
therefore suffices to show that, in positive semidefinite ordering,
Ṽ T (Ṽ Ṽ T )−1 Ṽ ≤ IK ,
that is, for each z ∈ RK , we must have
(Ṽ z)T (Ṽ Ṽ T )−1 Ṽ z ≤ kzk2 .
Let Ṽ have the singular value decomposition U ΣV T , where U and V are unitary matrices of appropriate
sizes. Since I(a) is invertible, it follows that (Ṽ Ṽ T )−1 = U Λ−1 U T where Λ = ΣΣT . Also ΣT (ΣΣT )−1 Σ is a
block diagonal matrix with I3 and OK−3 (all zero matrix square matrix of dimension K − 3) on the diagonal.
Therefore, the left-hand side of the above display becomes
z T V ΣT U T U Λ−1 U T U ΣV T z = z T V ΣT (ΣΣT )−1 ΣV T z


I3
O3,K−3
= zT V
V Tz
OK−3,3 OK−3
where Om,n is the all zero matrix of dimensions m × n. Since V is orthonormal, the lemma follows.
Proof of Theorem 2. Consider the zero-sum game G. By assumption (A2), there exists a design v (0) such
that supp∈P a(v (0) ; p) < ∞; hence, we may restrict the set of designs to
(
)
X
(0) 0
C := (vt , t ∈ T ) : vt ≥ 0, t ∈ T,
vt = 1, a(v; p) ≤ sup a(v ; p ) for all p .
p0 ∈P

t∈T


P
Recall that, for a given pair of strategies (v, p), the pay-off of the maximising player is a(v; p) = uT
t∈T vt It (p)/ct u.
For each p ∈ P, as argued in the proof of Theorem 1, the mapping v 7→ a(v; p) is convex on C, and C is a
convex and compact subset of the design space. Recall q from (1) and the Fisher information matrix from
(2). The mapping
p 7→

3
X

ps q(y|s, t) + (1 − p1 − p2 − p3 )q(y|4, t), ∀y ∈ Yt , ∀t ∈ T

s=1

is linear. So by Lemma 5, for each fixed v ∈ C, the mapping p 7→ a(v; p) is concave. Also, P is convex and
compact. Hence by Glicksberg’s fixed point theorem [8] there exists a Nash equilibrium for the game G.
The result now follows from Theorem 1 and the interchangeability property of Nash equilibria in two-player
zero-sum games (see [12, Theorem 3.1]).
P
Proof of Theorem 3. A local c-optimal design that minimises the variance of the estimator d∈[D] nd (uT p̂(d))
∗
is obtained by finding a solution vt,d
, t ∈ T, d = 1, . . . , D, to the following optimisation problem:
!−1
D
X
X
2 T
minimise
nd u
vt,d It (p(d))/ct
u
(10)
d=1

subject to

D
XX

t∈T

vt,d ≤ 1,

t∈T d=1

10

vt,d ≥ 0, t ∈ T, d = 1, . . . , D.

With additional variables (md , d = 1, . . . , D) which can be interpreted as the budget fractions given to each
district, the value of the above optimisation problem is equal to the value of the following problem:
minimise
subject to

D
X

!−1
n2d

X

T

×u

vt,d It (p(d))/ct

d=1

t∈T

X

vt,d ≤ md , d = 1, . . . , D,

u

(11)

t∈T

vt,d ≥ 0, t ∈ T, d = 1, . . . , D,
D
X

md ≤ 1,

d=1

md ≥ 0, d = 1, . . . , D.
For a given (md , d = 1, . . . D), the optimisation in (11) over the variables (vt,d , t ∈ T, d = 1, . . . , D) can
be performed separately for each d. As argued in the proof of Theorem 1, using assumption (A1) for each
p(d), d = 1, . . . , D, there exists a solution to the problem (4) with p(d) in place of p; we denote it by v ∗ (p(d))
and the corresponding value by a(v ∗ (p(d)); p(d)). Hence the above problem reduces to
minimise

D
X
n2d
a(v ∗ (p(d)); p(d))
md

(12)

d=1

subject to

D
X

md ≤ 1,

d=1

md ≥ 0, d = 1, . . . , D.
Note that (12) is a convex problem in the variables (md , d = 1, . . . , D); indeed the mapping (md , d =
P
n2
1, . . . , D) 7→ d∈[D] mdd a(v ∗ (p(d)); p(d)) is lower-semicontinuous, convex and the constraint set is a compact
∗
and convex subset of RD
+ . Hence, there exists a solution (md , d = 1, . . . , D) to the above problem. Consider
the Lagrangian
!
D
d
D
X
X
X
n2d
∗
L(m, λ, µ) =
a(v (p(d)); p(d)) −
λd md + µ
md − 1 .
md
d=1

d=1

d=1

By the Karush-Kuhn-Tucker conditions [3, Chapter 5], there exist non-negative numbers (λ∗d , d = 1, . . . , D)
and µ∗ such that the following conditions hold:
−

n2d a(v ∗ (p(d)); p(d))
− λ∗d + µ∗ = 0, d = 1, . . . , D,
(m∗d )2

µ∗

D
X

λ∗d m∗d = 0, d = 1, . . . , D,
!
m∗d − 1

= 0.

(13)
(14)
(15)

d=1

P
If µ∗ = 0, then (13) is violated for all d; hence µ∗ > 0 and by (15), d∈[D] m∗d = 1. Whenever m∗d > 0, we
p
PD
must have λ∗d = 0, and by (13), m∗d = nd µ∗ a(v ∗ (p(d)); p(d)). Using d=1 m∗d = 1, we can solve for µ∗ to
get
p
nd a(v ∗ (p(d)); p(d))
∗
md = PD
.
(16)
p
0
a(v ∗ (p(d0 )); p(d0 ))
d0 =1 nd
This solves problem (12). By setting
∗
vt,d
= vt∗ (p(d))m∗d ,

t ∈ T, d = 1, . . . , D

where m∗d is as given in (16), we also solve problem (11). By the equivalence of the problems (10) and (11),
we have a solution to problem (10), which can be described as follows: Allocate Cd = Cm∗d to district d, and
by Theorem 1, allocate wt∗ (d) = vt∗ (p(d))Cd /ct for test pattern t in district d. This completes the proof.
11

Proof of Theorem 4. The proof is straightforward and follows the same arguments used in the proof of
Theorem 3; we only have to use s in place of d and recognise that the Fisher information matrices may
depend on s.
Acknowledgements: SA’s research was supported in part by MATRICS. GRB’s research is funded by
an Intermediate Fellowship by the Wellcome Trust DBT India Alliance (Clinical and Public Health Research
Fellowship); grant number: IA/CPHI/14/1/501499. AI and NKV were supported by the IISc-Cisco Centre
for Networked Intelligence (CNI), Indian Institute of Science, through a Google grant. MM and SS were
supported by the CNI through a Hitachi grant. NR and SY works were supported by CNI through a
Cisco-IISc PhD Research Fellowship. RS’s work was supported by the Google Gift Grant. RS’s work was
done while on sabbatical leave at Strand Life Sciences, and RS gratefully acknowledges discussions with and
feedback from Vamsi Veeramachaneni and Ramesh Hariharan.

References
[1] G. R. Babu et al. The burden of active infection and anti-SARS-CoV-2 IgG antibodies in the general
population: Results from a statewide survey in Karnataka, India. medRxiv 2020.12.04.20243949, 2020.
[2] R. Bhatia. Positive Definite Matrices. Hindustan Book Agency, India, 2007.
[3] S. Boyd and L. Vandenberghe. Convex Optimization. Cambridge University Press, 2004.
[4] H. Chernoff. Locally optimal designs for estimating parameters. The Annals of Mathematical Statistics,
pages 586–602, 1953.
[5] H. Dette and T. Holland-Letz. A geometric characterization of c-optimal designs for heteroscedastic
regression. The Annals of Statistics, 37(6B):4088–4103, Dec 2009.
[6] G. Elfving. Optimum allocation in linear regression theory. The Annals of Mathematical Statistics,
23(2):255–262, 1952.
[7] L. L. Gao and J. Zhou. New optimal design criteria for regression models with asymmetric errors.
Journal of Statistical Planning and Inference, 149:140–151, 2014.
[8] I. L. Glicksberg. A Further Generalization of the Kakutani Fixed Point Theorem, with Application to
Nash Equilibrium Points. Proceedings of the American Mathematical Society, 3(1):170–174, 1952.
[9] J. M. McGree and J. A. Eccleston. Probability-based optimal design. Australian & New Zealand Journal
of Statistics, 50(1):13–28, 2008.
[10] H. V. Poor. Introduction to Signal Detection and Estimation. Springer-Verlag, 2nd edition, 1994.
[11] L. Pronzato and A. Pázman. Design of experiments in nonlinear models. Lecture notes in statistics,
212, 2013.
[12] S. Tijs. Introduction to Game Theory. Hindustan Book Agency, India, 2003.

12

