The identification of spatially constrained
homogeneous clusters of Covid-19 transmission
Roberto Benedettia , Federica Piersimonib , Giacomo Pignataroc , Francesco Vidolid
a Department

of Economic Studies, G. d’Annunzio, University of Chieti-Pescara, Italy
Directorate for Methodology and Statistical Process Design, Rome, Italy
c Department of Management, Economics and Industrial Engineering, Politecnico di Milano, and
Department of Economics and Business, University of Catania, Italy
d Department of Political Science, University of Roma Tre, Italy

arXiv:2006.03360v1 [stat.AP] 5 Jun 2020

b Istat,

Abstract
The paper introduces an approach to identify a set of spatially constrained homogeneous
areas maximally homogeneous in terms of epidemic trends. The proposed hierarchical
algorithm is based on the Dynamic Time Warping distances between epidemic time trends
where units are constrained by a spatial proximity graph. The paper includes two different
applications of this approach to Italy, based on different data (number of positive test
and number of differential deaths, with respect to the previous years) and on different
observational units (provinces and Labour Market Areas). Both applications, above all
the one related to Labour Market Areas, show the existence of well-defined areas, where
the dynamics of growth of the infection have been strongly differentiated. The adoption
of the same lock-down policy throughout the entire national territory has been therefore
sub-optimal, showing once again the urgent need for local data-driven policies.
Keywords: Spatial justice, Spatial heterogeneity, Spatial clustering, Epidemiological
Models, R(t), Time series distance

Email addresses: Benedett@unich.it (Roberto Benedetti), piersimo@istat.it (Federica
Piersimoni), giacomo.pignataro@polimi.it (Giacomo Pignataro),
francesco.vidoli@uniroma3.it (Francesco Vidoli)

Preprint submitted to Journal of Urban Economics - Insights

June 8, 2020

1. Introduction
Coronavirus disease 2019 (Covid-19) caused by SARS-CoV-2, is an infectious disease
that was first identified in 2019 in the Hubei province of China, in particular in the city of
Wuhan. By the middle of May 2020, the pandemic had spread to 188 countries.
As data on daily contagions and on the reproduction number are progressively improving (China first and Europe afterwards), countries are lifting the lockdown measures,
enforced since the beginning of the pandemic. In the discussion on how to design such
measures, the crucial policy trade-off between health safety and a quick economic recovery (taking into account that prolonged economic recessions have historically brought
forward long-term indirect consequences on health) needs to be considered. The concern
about this trade-off is generally requiring a decision on how far to go in lifting the previous restrictions on mobility and contacts, with all the implications on the way economic,
social and individual activities can be carried out (Bonaccorsi et al., 2020).
However, because of the general non-uniform spread of the contagion within a country, the other relevant policy issue is whether to have a differentiated implementation of
the lift of the lockdown restrictions for different geographic areas (what Friedman et al.,
2020 call a zone-based social distancing, or the geographic segmentation hoped for by
World Health Organization, 2020a)1 . Actually, this was an issue also in the first place,
when these restrictions were introduced. After a first period in which choices targeted
on specific local situations were more frequent (for example the delimitation of restricted
circulation zones around an outbreak, i.e. the so-called red areas), governments have increasingly implemented identical rules all over the country, slowing down the economy
and trade even in areas where it was probably not necessary. Whenever the issue of having
1 More

generally, policies can be differentiated for different groups of individuals, focusing non only on
the place where they live, but on other characteristics, like their age or the industry where they work. Our
interest, however, is on spatial differentiation.

2

different rules for different areas of a country has been raised, it has been referred to its
administrative areas (at different levels: states, regions, municipalities, etc.) as a reflection of the internal distribution of the decision-making powers, relevant for the take-up
of the measures. In Italy, for instance, the institutional debate on how differentiated the
lifting of lockdown restrictions should be is focused on the differences across the regions,
as supported by the settlement of a monitoring system at that territorial level.
Even in the short time since the outbreak of the Covid-19 pandemic, there is evidence2
that the infection followed specific patterns dictated by the territorial proximity, by spatial human mobility (Kraemer et al., 2020; Gatto et al., 2020) and that it was strongly
concentrated in some areas. In other words, the pattern of contagion developed upon to a
pre-existing spatial organization, which is not necessarily characterized, at a geographic
level, by the coincidence with whatever administrative boundaries. Several studies have
pushed to consider the differentiation of the virus outbreak areas in terms of relevant characteristics of disease transmission (among others, Harris, 2020; Siegenfeld and Bar-Yam,
2020; Zhao et al., 2020) and some have explicitly considered the tool of spatial analysis and its main concepts of spatial dependence and spatial heterogeneity (Bourdin et al.,
2020).
The objective of this paper is the identification of geographic areas characterized by
different patterns of Covid-19 transmission. This is a problem connected with the partitioning of spatial data with respect to the trends of the epidemic curves. While there are
by now several attempts to deal with spatial aspects in the health field, from spatial dependence (Baltagi et al., 2018) to spatial heterogeneity (Baltagi et al., 2017; Auteri et al.,
2019), a specific, systematic and complete approach to such a grouping problem is not
2 The

effort of the scientific community has taken advantage from most governments’ efforts to provide
up-to-date epidemiological data at different levels of resolution, from the national aggregates to the regional
and the sub-regional breakdowns, and to make them publicly available. For Italian data see https://
github.com/pcm-dpc/COVID-19.

3

yet available and it is still the focus of scientific debate (Zhou et al., 2020).
We introduce a methodology, which develops in three subsequent steps. First, for each
geographic area, considered as the elementary observational unit of the analysis, we measure the extent of the virus transmission, which represents the basic information for the
sort of decision-making problem discussed earlier. As it is standard, we use an estimate
of the time dependent reproduction number R(t) time series, built on the row data, which
directly (the number of cases) or indirectly (the differential number of deaths with respect
to homogenous time period of previous years) measure the daily incidence of the disease.
Second, we try to capture the extent at which the R(t) trends of the different observational
units are similar to each other, by using the Dynamic Time Warping algorithm, which
provides a measure of the distance between the time series of the R(t) indicator. Third,
we employ the Skater algorithm to combine information about the spatial proximity of
the observational units and the difference of their time series of the R(t) indicator, so as
to identify spatial clusters of the units – maximally homogenous within and heterogenous
between. The application to the Italian case allows to provide a more precise geographic
picture of the differences in the pattern of Covid-19 transmission and, therefore, can be
regarded a suitable information basis for an appropriate geographic modulation of the
policies aimed at containing the virus transmission while avoiding useless disruptions of
the economic and social activities.
The paper is structured as follows. In Section 2, we present the empirical methodology
for the identification of homogenous geographic clusters of Covid-19 transmission. In
Section 3, this methodology is applied to Italy: while in Section 3.1, our observational
units are the Italian provinces and the R(t) time series are estimated on the basis of the
daily provincial number of cases, in Section 3.2 we switch to different observational units,
the Labor Market Areas (LMAs), and to data on the municipal variation of the daily deaths
(Modi et al., 2020). Finally, in Section 4, the main results of the paper are discussed and
4

some important issues related to policy implications and decisions are identified.

2. A methodological approach for estimating spatially constrained zones
The proposed analytical framework runs essentially through three main steps. In the
first one, the Real-Time Reproduction Number R(t) trends (Wallinga and Teunis, 2004)
are estimated separately for each unit of analysis. Such time trends are, then, compared
all each other by means of the Dynamic Time Warping algorithm, so as to obtain a distance matrix with the aim of estimating a synthetic measure of the difference between
time series. Finally, the estimated distance matrix together with information on the proximity among units had been used to identify clusters of neighbouring areas maximally
homogeneous in terms of time trends, through a redesigned version of the Skater (Spatial
K’luster Analysis by TreeEdgeRemoval, Assuncao et al., 2006) algorithm.
2.1. Real-Time Reproduction Number and the Dynamic Time Warping distance
The key epidemiologic variable that characterizes the potential transmission of a disease is the basic time dependent reproduction number, R(t), which is defined as the expected number of secondary cases produced by a typical primary case in an entirely susceptible population (Wallinga and Teunis, 2004). The higher the value of this indicator,
the higher the risk of spreading the epidemic. Since the beginning of this epidemic, the
World Health Organization (WHO) and numerous research institutes around the world
have released estimates of this parameter.
R(t) is a function of (i) the probability of transmission by single contact between an infected and a susceptible person, (ii) the number of contacts of the infected person and (iii)
the duration of the infectivity; reducing at least one of the three growth factors can reduce
this value and therefore be able to control, or at least delay, the spread of the pathogen to
other people. The probability of transmission and the duration of infectivity (without a
5

vaccine or a treatment that reduces viraemia) are not modifiable at this stage but, the immediate diagnosis and identification of the infected person, or of the potentially infected
person, and the possibility of reducing his/her contacts with other people would allow a
reduction of R(t). To stop an epidemic, R(t) needs to be persistently reduced to a level
below 1. The estimate of R(t) is quite simple if we have information on who has infected
whom, in these cases it is possible to build an infection network, in which connections
are active if one person has infected the other. Estimating R(t) simply involves counting
the number of secondary infections for each unit (Wallinga and Teunis, 2004).
Often, estimation is a much more complicated affair, because only the epidemic curve
is observed and there is no information on who has been infected by whom. However, in
most cases, the approximation of R(t) is used assuming a theoretical trend in the number
of cases over time and adapting to observed data this specific model which summarizes
the assumptions about the epidemiology of the disease (Gani and Leach, 2001; Riley
et al., 2003).
From the time series of the relevant observation variable (either the number of positives or the differential number of deaths), a maximum likelihood (ML) estimate is obtained, opting for the hypothesis of time dependence of the parameter R0, namely R(t),
as suggested by Wallinga and Teunis (2004). In fact, it cannot be considered stationary
over time, both for stay-at-home measures and because the cognitive objective is to see
its evolution over time until it can be considered sufficiently low to allow the government
to reopen economic activities even if with more or less binding rules.
The similarities between R(t) trends among different spatial units have been assessed
using dynamic time warping, a widely used technique whose rationale is to locally stretch
or compress two time series in order to make one resemble the other as much as possible.
In such a way, it provides a measure of distance, insensitive to local compression, stretching (namely “warping”) the relative curves and optimally deforming one of the two input
6

series onto the other (Giorgino, 2009). The distance is thus computed, after stretching, by
summing the distances of individual aligned elements.
This technique has long been known in the speech recognition community. It allows a
non-linear mapping from one time series to another minimizing the distance between the
two. DTW was introduced to the Data Mining community as a utility for various activities
for time series issues including classification, clustering and anomaly detection (Montero
and Vilar, 2014; Pree et al., 2014). The technique has spread rapidly and has been applied,
as well as in field of speech recognition, to a great deal of problems in various disciplines
including handwriting and online signature matching, finger print verification, pattern
and shape recognition, computer vision and animation, surveillance, protein sequence
alignment, chemical engineering, music and signal processing (Yadav and Alam, 2018).
2.2. Hierarchical spatially constrained clustering algorithm based on time-series distances
The redesigned procedure3 of the Skater (Assuncao et al., 2006) algorithm aims at
identifying k not overlapping clusters of units that are geographically proximate and as
much as possible homogenous in terms of the measure of time-trend distance. More
in detail, the Skater procedure can be described as a k-means clustering procedure in
which the units are belonging to a proximity graph: each observation, thereby, belongs to
the cluster with the nearest mean (measured in terms of distance) in order to partition n
neighbouring observations into k clusters.
Conceptually, the algorithm can be split into two main steps: (i) the identification of
geography and distances among units, and (ii) a second phase in which the effective spatially constrained clustering algorithm is implemented. In the first step, the units are first
3 The relative R functions - derived from the spdep package functions - are available from the authors
upon request.

7

represented as a full neighbourhood graph and then this complete network is simplified
according to the Minimum Spanning Tree algorithm (MST, Pettie and Ramachandran,
2000). Starting from this simplified representation of the neighbourhood, the purpose
of the second phase is to identify spatial clusters - maximally homogeneous within and
heterogeneous between - in terms of time-trend distances.
The proposed redesigned procedure for time series differs from the standard Skater
algorithm essentially in the objective function to be maximized during the cluster search
phase: in the original algorithm, the different sub-graphs are compared in terms of intracluster square deviation for a set of variables, while in this case comparison faces in terms
of dynamic time warping distance between trends. More formally, in a generic step, unit
k is included in cluster A if the average Dynamic Time Warping (dtw) distance between
its trend and that of the other units belonging to cluster A (dtw(k,A) ) is minimal compared
to other units q other than k not yet belonging to A and spatially contiguous to A. In each
step:
k ∈ A, if dtw(k,A) < dtw(q,A) ∀q 6= k & k, q contiguous to A

(1)

dtw(k,A) = E(dtwi, j ), ∀i, j ∈ A ∪ k

(2)

where

Please note how the complexity of the algorithm, written in such schematic terms,
can grow very fast as the units under analysis grow. Assuncao et al. (2006) write that
”the exhaustive comparison of all possible values of the objective function is expensive
computationally [and it] leads to a combinational explosion”. In order to practically overcome this drawback and reduce the search complexity, Assuncao et al. (2006) suggests to
look for the edges no longer among all the possible nodes, but only among those already
calculated.
For other technical details, please refer to Assuncao et al. (2006).
8

3. The identification of spatial clusters of Covid-19 transmission in Italy
We carry out two different attempts of applying the methodology outlined in Section 2
for the identification of homogenous geographic areas in terms of epidemic trend, to Italy.
The difference between the two applications is related to the spatial observational units of
our analysis and to the nature of the data used for the estimation of the time trends of the
R(t) indicator for each unit. In Section 3.1, we consider as the basic geographic unit of
analysis the Italian provinces and we use (provincial) daily data on the number of Covid19 cases; in Section 3.2, we move to focus the application on different geographical units,
namely LMAs, and we use smooth daily data at week level for the municipal variation of
deaths (with respect to the analogous time period of the previous years), aggregated at the
LMA level.
3.1. Estimation of clusters using provincial Covid-19 diseases data
We use the daily data on the total number of Covid-19 positive cases, published daily
by the Civil Protection Department, for each of the 101 Italian provinces4 . It is important
to notice that the data reported by the Civil Protection Department actually refer to the
number of positive (to Covid-19) tests, without differentiating between diagnostic and
control tests. Therefore, it cannot be considered a measure of the daily incidence of the
disease.
The first step of the analysis has involved the estimation of the time dependent reproduction number R(t) according to Wallinga and Teunis (2004) specification distinctly for
each Italian province. The estimated real-time reproduction number trend obtained for
each day has been subsequently smooth over weeks so as to obtain more robust estimates.
The basic idea is precisely to compare estimated epidemic trends for each province; Fig4 Source:

https://github.com/pcm-dpc/COVID-19, last analysis update: May 15, 2020. The Civil
Protection Department time series starts on 24th February, 2020.

9

ure 1 shows, for example, the estimated trends for three provinces: Bergamo and Brescia,
which show very similar trends, and Sud Sardegna, which has experienced a lower growth
trend (also in absolute terms).
●

2.0
●

Estimated R(t)

●

1.6

●

●

●

●
●
●

●

1.2

●

●

●
●

●

●
●
●

1

2

3

4

5

6

●
●
●

●
●

●
●

●
●

7

8

9

10

●
●

Week, year 2020 − start date: 24 February, 2020
Provinces:

●

Bergamo

●

Brescia

●

Sud Sardegna

Figure 1: Clusters estimated in terms of the epidemic trend - Italy

In the second step, using the estimated provincial R(t) trend, the Dynamic Time Warp
distance matrix has been calculated. To overcome the potential misalignments among
time series due to the differentiated impact of the epidemic over space, the optimal alignments between time series have been computed for every comparison (Giorgino, 2009).
Finally, starting from the provincial centroids, the minimum spanning neighbourhood
graph has been calculated (see Figure A.8) in order to apply the Skater procedure. . Four
homogeneous zones, estimated in terms of homogeneity with respect to epidemic trends
and geographic proximity of the provinces (see Figure 2), emerge. They show a clear
differentiation between Northern Italy, with a split between North-West and North- East,
Central Italy including Tuscany and part of Emilia-Romagna, and the South where the
10

epidemic peak has been averted.

45.0

lat

42.5

40.0

37.5

10

15

lon
Skater trend
cluster:

1

2

3

4

Figure 2: Clusters estimated in terms of the epidemic trend - Italy

The great differentiation between homogeneous zones, both in terms of quantity and
growth rate, of official infected people can be valued in Figure 3, where there is a clear
division between geographical areas, especially between cluster 4 (North-West) and the
rest of Italy.
3.2. Estimation of clusters using Municipal deaths data
The clusterization carried out in Section 3.1 raises two key questions. The first one is
related to the homogeneity of the data on the daily number of positive tests, both in terms
of its distribution between diagnostic and control tests and of the intensity of testing in
each province, with respect to population. One of the main implications for the application of our methodology is whether the relationship, over time, between tested positive
and actually infected people can be considered constant in space. The answer is nega11

150000

●
●
●

●

●

●

●

●

●

●

●

●●

●●

●

●

●●

●●

●●

●

●

●

●
●
●
●

●

●

100000

●
●
●
●
●

Total number

●

●

●
●
●
●
●
●
●
●
●
●
●

50000

●
●
●
●
●
●
●●●●
●●●●●●●●●●●●●
●●●●●●
●●●
●●●●●●●●●●●●●●●●
●●●●
●●
●●●●●●●●●
●●●
●●●●●●●●
●
●●●●
●
●
●
●
●●●●●
●●● ●●●
●●●●●●●●●
●
●
●●
●●●●
●●●●
●● ●●●●
●
●●●●
●
●●
●●●
●● ●●●
●
●●●
●
●●●●●
●●●
●
●
●
● ●●
●●●
●
●●
●● ●●●●
●●
●●
●●
●
●●
●●
●●●●●●
●●
●●
●●●
●●●●●●●
●●●
●●●
●●
●●
●●
●●
●●
●●
●●
●●●●●●
●●●●●●●
●●●●
●

●

●

●

0
0

20

40

60

80

Day
Skater trend cluster:

●

1

●

2

●

3

●

4

Figure 3: Total number of positive tests by spatial cluster, as estimated in terms of epidemic trend - provincial level

tive5 , since, due to the highly decentralized nature of the Italian National Health Service,
the provincial data on the number of positive tests reflect the testing strategy (and its intensity in terms of population tested) adopted by each. For this reason, and because of the
possible problems of underestimation6 of the actual infection rate, many authors (see e.g.
Modi et al., 2020; Ghislandi et al., 2020) have suggested using mortality data differentials
between the year 2020 and previous years.
The second question arises from the observation of the clusterization of provincial
units, which has a limited informational content, since we get only four clusters. The
5 Figure

A.7 shows how the ratio of the number of positive tests and mortality trend changes clearly
across provinces.
6 The potential underestimation has been underlined by several official studies (see for example the study
of the English ONS at https://www.ft.com/content/67e6a4ee-3d05-43bc-ba03-e239799fa6ab,
or that of INPS for Italy at https://www.inps.it/nuovoportaleinps/default.aspx?itemdir=
53705), which estimate the deaths due to Covid-19 in about the double the official rate.

12

number of clusters is constrained by the limited number of spatial units to be aggregated
(101 overall). To improve the informational content of our clusters, therefore, we need
to look for a more detailed geographic delimitation of the spatial units to be aggregated
in clusters and, above all, they should be correlated to some pre-existing spatial organization that is relevant for the transmission pattern of the disease, thus avoiding a spatial
delimitation that simply refers to administrative boundaries. More precisely, we look for
geographic areas that can be regarded as homogenous in terms of functional mobility7 .
Similarly to existing literature (see e.g. Martinez-Bernabeu et al., 2012; Chakraborty
et al., 2013; Franconi et al., 2017), we use the municipal functional aggregation called
Labor market areas (LMAs), provided by the Italian National Institute for Statistics (ISTAT); more specifically, LMAs are “sub-regional geographical areas where the bulk of
the labour force lives and works, and where establishments can find the largest amount
of the labour force necessary to occupy the offered jobs”. Monras (2020) has stressed the
relevance of labour mobility for the trade-off between health safety and economic recovery: “we need labour immobility to fight the virus, but we also need people to move for
the economy not to collapse”. Most of the mobility, which affects the speed of the virus
transmission, is “concentrated around work and home locations” and, therefore, “commuting zones may offer a way to think about designing more targeted policies to halt the
spread of Covid-19” (Monras, 2020).
Altogether, ISTAT classifies 610 LMAs based on commuting data stemming from the
15th Population Census using an allocation process shared at European level. It surely
represents a more refined partitioning of the country than the one represented by the
provincial partition. The information provided by ISTAT allows to identify the munic7 OECD

(2002) (p.11) defines a functional region as “a territorial unit resulting from the organisation of
social and economic relations in that its boundaries do not reflect geographical particularities or historical
events. It is thus a functional sub-division of territories”.

13

ipalities aggregated in each LMA and, therefore, we are able to link the mortality data,
collected at the municipal level, with the LMA partition and to aggregate these data at the
LMA level.
Against this background, data on the difference in mortality between the year 2020
and the average for the years 2015-2019 at municipal level have been used8 . Starting from
the mortality data, aggregated at LMA level, the single real-time reproduction number
trend R(t), the matrix of distances between the estimated trends and, finally, the homogeneous areas in terms of trends of virus transmission have been estimated – similarly
to what done in Section 3.1, for the estimation of clusters based on the provincial level.
Since the burden of the Covid-19 disease (in terms of cases and deaths, as well as of
demand for hospital services) has been concentrated in the Northern part of Italy, as confirmed by our clusterization results in Section 3.1, we decided to focus on the regions
of Northern Italy, just to check whether a different choice of the observational units (the
LMAs) can provide a more refined information of the geographic differences in terms of
virus transmission. Our methodology, this time, is therefore applied to the sub-sample of
LMAs including Municipalities of all the Northern Italy regions. Figure 4 actually shows
that while in the previous clusterization the provinces of these regions were part of just
three clusters (see Figure 2), their LMAs are now differentiated in 8 clusters. In terms
of the severity of the R(t) time trend, the most badly hit area no longer covers the entire
North west of the country, but it is limited to cluster 8. Figure 5 shows values of the
growth rate of the differential of mortality, with respect to the second week of the year,
for cluster 8, up to more than 300%. This cluster is made up of LMAs aggregating almost
entirely municipalities of the Lombardy region (only 14 municipalities, out of 789, are
8 Source:

https://www.istat.it/it/archivio/240401, last analysis update: May 15, 2020. Figure A.6 shows both the clear difference between the years 2015-2020 starting approximately from the
beginning of March, and the gradual unreliability of the statistical data from 1th April due to the delay in
the update.

14

part of other regions – Piemonte, Veneto and Emilia Romagna). Moreover, Lombardy is
not to be considered a uniform geographic area, in terms of the R(t) time trend, but its
territory is distributed between two clusters, 7 and 8. About 45% of its municipalities,
representing 35% of its population, are part of the most badly hit area, cluster 8, while
the rest is part of cluster 7, which shows a significantly different dynamic pattern of the
contagion (see Figure 5). Clusters 5, 6 and 7, although with differentiated growths rates,
lower than the ones characterizing cluster 8, show a separate trend from the rest of the
estimated areas.
47

46

lat

45

44

43

8

10

12

lon
Skater trend
cluster:

1

3

5

7

2

4

6

8

NA

Figure 4: Clusters estimated in terms of the mortality difference trend - Northern Italy

3.3. Discussion of results
The results presented in the two previous sections 3.1 and 3.2 represent an attempt of
identifying spatially constrained homogenous zones, on the basis of the estimated values
of R(t).
15

●

●

% increase respect to week 2

300

●

200
●
●

●

●

●

100

●

●
●
●

●
●
●
●

●

0

●

●
●
●
●
●
●
●

●
●
●
●
●

●
●
●
●
●

●
●
●
●
●
●

●
●
●
●
●
●
●

●
●
●
●
●

●
●
●
●
●
●

●
●
●
●

●

●
●

●
●

●

●
●
●

●
●
●

●

●

●
●

●
●
●
●

●
●

●

●
●

●
●
●
●
●

●
●
●
●
●
●

4

8

12

16

Week of the year 2020

Skater trend cluster:

●

1

●

3

●

5

●

7

●

2

●

4

●

6

●

8

Figure 5: Percentage increase in deaths compared to the second week of the year by spatial cluster - Northern Italy

First of all, we would like to point out the qualitative differences, in the nature of the
information arising from the zone mapping, between the two different applications of the
methodology developed in section 2, and also with respect to the current monitoring system of the epidemic, implemented by the Italian Ministry of Health, whose indicators,
including R(t), are estimated on a regional basis9 .
The regionalization of the information provided by the official monitoring system is basically motivated by institutional reasons. Regional governments, in Italy, are granted,
by Constitution, autonomous powers for the provision of healthcare services (within the
9 The monitoring system, implemented since the beginning of May 2020, is the outcome of a cooperation

between the central government and the regional governments. It is meant to be an information tool for the
design of the reopening measures, based on epidemiological data and on the measurement of the regional
capacity of early response. Indicators include a measure of the weekly incidence of the disease, an estimate
of R(t), the weekly trend of the number of positives (whether declining or not), a categorical evaluation of
the change in transmission and on its impact on the regional healthcare system, a measure of the resilience
of the community healthcare services.

16

framework of nationally uniform general principles about the fundamental architecture of
the healthcare system) and, therefore, bear the responsibility for all the measures, which
involve the utilization of their healthcare systems. However, the regional basis of the monitoring system is not necessarily the relevant one for the design of the other measures for
the management of the different stages of the epidemic. It is in fact disputed that, on the
basis of Italian Constitution, regional governments should have a say on community mitigation strategies. Moreover, the latter should anyway be consistent with the geographic
patterns of the virus transmission, so as to balance health and economic safety.
Our estimation of R(t), therefore, tries to overcome the limitations arising from sticking to administrative boundaries that are only partially relevant from an institutional point
of view and risk to be inconsistent with the epidemic geographic pattern. This inconsistency is only partially overcome in our first attempt of identifying homogenous clusters
on the basis of the provincial data on the number of contagions (section 3.1). The clusters, because of its limited number, overlap the regional boundaries while, at the same
time, there are regions whose territory is shared by different clusters. However, this clusterization has severe limitations of the information it provides, arising from the limited
number of clusters, constrained by the relatively small number of observation units (101
provinces all over the country), and from the provincial source of the data on the number
of positive tests, which is not necessarily related to the geographic patterns of the virus
transmission.
The application in section 3.2 is, instead, based on smaller and more numerous observation units but, above all, on a pre-existing spatial organization, which is surely relevant
for the transmission pattern of the virus. As already noticed, the LMAs are identified
through the analysis of the work commuting patterns and, therefore, are related to an essential component of daily mobility, which is obviously considered as one of the main
drivers of a virus transmission. In such a way, when we aggregate LMAs in a cluster, by
17

spatial proximity and by homogeneity of the R(t) time trend (as measured according to
the Dynamic Time Warping algorithm), we take in municipalities, which may have different values of R(t) with respect to the one for the entire LMA, but are however connected
to the rest of this area by a work mobility pattern.
The differentiation of the geographic areas we get is undoubtedly finer than the one based
on the regional values of R(t) and able to get a discrimination of geographic areas within
a region. Our focus on Northern Italy allows to consider the situation of those regions,
which were badly hit by Covid-19 – Piemonte, Lombardy, Veneto, Emilia Romagna and
Tuscany, and are usually regarded as a sort of “uniform” block.
The clusterization based on LMAs, however, show a very differentiated picture. As
far as Piemonte and Tuscany are concerned, each of these two regions appears to be quite
homogenous in terms of our estimate of R(t). Each region is almost self-contained in one
cluster, respectively 5 and 2, with the few exceptions of those municipalities aggregated in
LMAs overlapping with other regions. As Figure 5 reveals, they show a different pattern
with respect to the other regions and clusters, especially Tuscany (cluster 2). Lombardy,
as already noticed, is substantially covered by two clusters, 7 and 8, the ones with the
most severe estimated values of R(t), even if with a substantially differentiated pattern
between the two. The situation of Veneto and Emilia Romagna is much more articulated.
The municipalities of Veneto belong to three different clusters (1, 3 and 7, with only 9
over 574 municipalities aggregated to cluster 8), almost evenly distributed among them.
While there is a part of Veneto which shows a severity of transmission of the virus homogenous to part of Lombardy (cluster 7), two thirds of the region belong to clusters with
substantially weaker values of R(t). Emilia Romagna is covered by two clusters, 3 and 6,
with relevant differences from each other.
The main advantage of this picture and, more generally, of our methodology is the
possibility of linking the community mitigations strategies as well as their uplift not to
18

mere administrative areas (e.g. regions or municipalities), but to clusters whose components (the LMAs) are homogenous with the other ones belonging to the same cluster in
terms of the virus transmission rate, but are also homogenous inside in terms of work
commuting habits. It should guarantee a better trade-off of the policy intervention between the goal of health safety (and of preventing unsustainability of the demand for
healthcare services like intensive care) and the need of avoiding unnecessary disruptions
of economic and social activity (not to speak of the individual liberties).
A refined geographic identification of the different areas is relevant not only for the
short-term social, economic and health consequences of the different policy interventions but also looking at the medium- and long-term effects. Considering LMAs as the
elementary unit of any zoning, for instance, may avoid costly breaks of existing economic networks, as it would be the case if they happen to be located on the boundaries
of different regions and, consequently, they could be jeopardized by different regional
lockdown/reopening policies. Of course, this sort of “granular” approach is not without problems, impinging on the “clash” between the spatial organization of a geographic
area and the current institutional arrangements related to that area. When the geographic
areas, regarded as homogenous from the point of view of the strength of the virus transmission, overlap with different jurisdictions, a problem of governance of the different
interventions arise. Unless the power to intervene is already centralized or centralization
can be enforced without constitutional breaks, the release of policy measures that should
be implemented in areas, which are part of different jurisdictions (e.g. different regions
or different municipalities), requires coordination. In consideration of the political nature of the (local) governments that need to be involved, coordination can be very costly,
above all in terms of time for reaching an agreement, while some of these interventions
(like lockdowns) have to be decided very quickly to be highly effective. The coordination
problems are likely to be more relevant the more fragmented is the distribution of the
19

relevant decision-making powers among different jurisdictions (at different levels), as it
happens in Italy. As for the specific problems related to the provision of healthcare services, in connection with the treatment of the consequences of epidemic, if the different
areas included in the same LMA are part of different regions, it is well possible that the
supply of services within that LMA will not be homogenous, in quantity and quality. A
potential consequence is that inefficiencies of providers in some areas of an LMA may
slow down the reduction of contagions and, consequently, may delay the “exit” of the
all areas of that LMA from a lockdown, as well as a quick exit from a lockdown may
not be safe for the areas of an LMA, which have delays in reducing contagions and may,
eventually, result in a policy reversal.
The issue of the potential asymmetry between the administrative boundaries of the
government and of the management of healthcare services and the spatial differentiation
of the health needs and demand, revealed by our analysis on the Covid-19 epidemic, is
probably more general. As shown, for instance, by Auteri et al. (2019), who deal with the
issue of defining spatial regimes for the estimation of the efficiency of hospital services
in Italy, clusters differentiated by the relevant production frontier generally overlap the
different regions. Even if we are aware that the definition of the boundaries of jurisdictions is not a short term decision and, however, it has to correspond to a wider spectrum
of interests than the ones relative to the provision of a specific service, there is a need to
look for institutional coordination mechanisms, flexible enough for guaranteeing a more
homogenous policy intervention in specific circumstances, like the ones faced within the
current epidemic, as also recommended by World Health Organization (2020b,a).

4. Final remarks
The Covid-19 crisis has found most countries unprepared to offer an effective reaction,
both in terms of the supply of healthcare services for treating people infected by the virus,
20

and of the containment of the virus transmission. The main strategy, therefore, has been in
terms of extended and massive lockdown of entire countries, with unprecedented negative
consequences for their economic and social environment. A fine-tuned policy intervention
requires selective measures, which, above all, need to be targeted to the specific outbreak
areas. This approach has to be based on appropriate and refined information about the
geographic distribution of the virus transmission pattern.
In this paper, we have outlined a methodological approach, based on a spatially constrained clustering algorithm with the aim of identifying homogeneous areas in terms of
epidemic growth. The results show how data of different nature (epidemic and mortality
data) and different observational units (provinces and LMA) can provide different pictures
of the spatial distribution of the disease.
The proposed methodological approach is not intended to be an ex post policy evaluation tool, but, given that the population may be vulnerable to new outbreaks in the
medium term, is to be intended as a tool for design well-defined potential new areas in
terms of epidemic growth. Finally, the proposed framework can be used more extensively
in future economic impact assessments, highlighting heterogeneous space-time patterns
of regional resilience and showing how the epidemic has changed our lives in social,
labour and economic fields.

21

Appendix A.
3000

Deaths

2500

2000

1500

1000

gen

feb

mar

apr

Date
Year:

2020

2019

2018

2017

2016

2015

Figure A.6: Daily mortality per year - years 2015-2020

% Ratio between cum. infected and cum. deaths

200

150

100

50

0
mar 01

mar 15

apr 01

apr 15

Date
Provinces:

Bergamo

Verona

Bologna

Lecco

Figure A.7: Percentage ratio between cumulate infected and cumulate deaths by date - year 2020

22

23

●
21
●
●
25
14
●
30
●
●
22
93
●
●
13
97
●
●
31
●
●
12
16
26
●
7●
●
●
17
32
24
●
104
●
96
●
2● 3●
27
●
15
●
23
●
28
●
●
98
19
●
●
1●
20
18
●
29
●
5●
33
6●
●
38
●
34
●
35
●
36
●
4●
10
●
37
●
39
●
9●
● 45
11
●
●
40
46
●
●
47
●
100
8●
99
●
48
●
41
●
●
●
51
50
42
●
49
●
●
52
43
●
●
105
54
●
44
●
53
●
●
55
67
●
56
●
57
●
68
●
103

●
66

●
58

●
59

●
69
●
70

●
94

●
60

●
71

●
62

●
61

●
106
●
64

●
63

●
90

●
65

●
72
●
76

●
77

●
73

●
91

●
74
●
75

●
95
●
78

●
107
●
92

●
101
●
79
●
102
●
80
●
83

●
82

●
81

●
84

●
85

●
86
●
87

●
88

●
89

Figure A.8: Provincial minimum spanning neighbourhood graph

●
104
●
102

● 35
●
33
● 43
●
36
●
39

●
34

●
41
●
38
●
40

●
37

●
44

●
7

●
10
●
42

●
● 32
31
●
4

●
11

●
2
●
8

●
6

●
5

●
9

●
78

●
96

●
95
●
101
●
93
●
136
●
●
97
94
●
138
●
●
●
164
49
107
●
165
●
141
●
111
●
109
●
110
●
●
●
135
48
51
●
98
●
●
108
●
72
140
●
●
●
117
170
52
●
●
112
53 66
●
50
●
●
●
●
118
137
166
●
161
●
●
106
116
●
46
●
139
●
47
●
59
●
149
●
105
●
●
61
171
●
57
●
●
60
●
●
167
115
●
128
● 146
●
148
113
●
91
●
143
●
●
114
●
● 168
●
129
● 64
55
●
●
●
67
●
144
45
●
● 163
131
145
162
● 74
●
68
122
●
●
●
132
151
●
169
●
●
●
147
142
58
●
●
152
133
●
56
● 119
73
●
●
154
●
63
●
●
150
●
62
● 134
127
●
125
●
54
● 123
65
●
●
●
153
124
●
71
●
●
157
● 85
81
●
●
130
● 126
● 70
69
●
●
84
120
●
● 155
92
●
●
75
●
● 156
83
121
●
●
86
82
●
99

●
103
●
100

●
76
●
26
● 160
159
●
●
●
77
80
●
●
● 88
30
158
●
● 87
89
●
90
●
186
●
●
195
●
209
●
●
●
25
211
● 79
● 190
●
29
199
● 187
●
188
210
●197
●
194
●
23
●
●
●
20
192
208
● 22
●
● 12
●
●
13
196
27
●
200
●
19
● 28
24
●
●
●
16
213
●
189
●
●
205
●
191
181
●
203
●
204
●
180
●
●
214
193
●
● 177
● 14
● 179
●
18
●
●
182
●
201
227
●
15
207
●
183
●
●
● 198
212
●
184
●
●
185
●
206
178
●
● 202
17
229
●
●
217
●
239
● 218
219
●
225
●
176
●
●
●
226
216
228
●
●
223
173
●
231
●
●
235
220
●
● 267
●
234
●●
● 172
222
174
● ● 233
221
232
●
175
230 ●
●
283
●
215
●
224
●
284
●
238
●
● 281
286
●
253
● 237
●
●
250
247
●
291
●
285
●
256
●
●
282
● 236
287
●
●
255
● 249
●
242
280
●
● 290
●
289
●
270
252
●
246
●
295
●
261
●
●
251
288
● 273
278
●
●
292
●
241
●
●
●
262
254
293
●
●304
303
●
●
263
●
248
272
●
240
● 296
294
● 302
●
● 301
● 268
● 269
●
259
● 275
● 265
●
244
258
●
●
300
●
●
271
●
299
297
●
●
260
257
●
264
●
●
●
●
306
●
266
277
274
298
● 245
●
243
●
276
●
● 279
305
●
1

●
3

●
21

Figure A.9: LMAs minimum spanning neighbourhood graph

References
Assuncao, R., Neves, M., Camara, G., Da Costa Freitas, C., 2006. Efficient regionalization techniques for
socio-economic geographical units using minimum spanning trees. International Journal of Geographical
Information Science 20(7), 797–811.
Auteri, M., Guccio, C., Pammolli, F., Pignataro, G., Vidoli, F., 2019. Spatial heterogeneity in nonparametric efficiency: An application to italian hospitals. Social Science & Medicine 239.
Baltagi, B., Moscone, F., Santos, R., 2018. Spatial Health Econometrics. Emerald Group Publishing Limited. volume 294 of Contributions to Economic Analysis.
Baltagi, B.H., Lagravinese, R., Moscone, F., Tosetti, E., 2017. Health care expenditure and income: A
global perspective 26, 863–874. doi:10.1002/hec.3424.
Bonaccorsi, G., Pierri, F., Cinelli, M., Porcelli, F., Galeazzi, A., Flori, A., Schmidt, A.L., Valensise, C.M.,
Scala, A., Quattrociocchi, W., Pammolli, F., 2020. Evidence of economic segregation from mobility
lockdown during covid-19 epidemic. arXiv:2004.05455.
Bourdin, S., Jeanne, L., Nadou, F., G. Noiret, G., 2020. Does lockdown work? a spatial analysis of the
spread and concentration of covid-19 in italy. url:. URL: https://ersa.org/wp-content/uploads/
2020/05/1-article-covid19vfok.pdf.
Chakraborty, A., Beamonte, M.A., Gelfand, A.E., Alonso, M.P., Gargallo, P., Salvador, M., 2013. Spatial
interaction models with individual-level data for explaining labor flows and developing local labor markets. Computational Statistics and Data Analysis 58, 292–307. doi:10.1016/j.csda.2012.08.016.
Franconi, L., Ichim, D., D’Alo’, M., 2017. Labour market areas for territorial policies: Tools for a european
approach. Statistical Journal of the IAOS 33, 585–591. doi:10.3233/sji-160343.
Friedman, E., Friedman, J., Johnson, S., Landsberg, A., 2020. Transitioning out of the coronavirus lockdown: A framework for zone-based social distancing. URL: https://arxiv.org/pdf/2004.08504.
pdf.
Gani, R., Leach, S., 2001. Transmission potential of smallpox in contemporary populations. Nature 414,
748–751. doi:10.1038/4151056a.

24

Gatto, M., Bertuzzo, E., Mari, L., Miccoli, S., Carraro, L., Casagrandi, R., Rinaldo, A.,
2020.

Spread and dynamics of the covid-19 epidemic in italy:

containment measures.

Effects of emergency

Proceedings of the National Academy of Sciences 117, 10484–

10491. URL: https://www.pnas.org/content/117/19/10484, doi:10.1073/pnas.2004978117,
arXiv:https://www.pnas.org/content/117/19/10484.full.pdf.
Ghislandi,

S.,

Estimation
covid-19

Muttarak,
of

R.,

excess

pandemic

Sauerberg,

mortality

in

italy.

and

M.,
life

Scotti,

B.,

expectancy

medRxiv

URL:

2020.
in

the

News from the front:
major

epicenters

of

the

https://www.medrxiv.org/content/
doi:10.1101/2020.04.29.20084335,

early/2020/05/13/2020.04.29.20084335,

arXiv:https://www.medrxiv.org/content/early/2020/05/13/2020.04.29.20084335.full.pdf.
Giorgino, T., 2009. Computing and visualizing dynamic time warping alignments in R: the dtw package.
Journal of Statistical Software 7, 1–24. doi:10.18637/jss.v031.i07.
Harris, J., 2020. Reopening under COVID-19: What to watch for. Technical Report 27166. NBER Working
Paper. URL: https://www.nber.org/papers/w27166.
Kraemer, M., Yang, C., Gutierrez, B., Wu, C., Klein, B., 2020. The effect of human mobility and control
measures on the covid-19 epidemic in china. Science 368, 493–497. doi:10.1126/science.abb4218.
Martinez-Bernabeu, L., Florez-Revuelta, F., Casado-Diaz, J.M., 2012. Grouping genetic operators for the
delineation of functional areas based on spatial interaction. Expert Systems with Applications 39, 6754–
6766. doi:10.1016/j.eswa.2011.12.026.
Modi, C., Boehm, V., Ferraro, S., Stein, G., Seljak, U., 2020. Total covid-19 mortality in italy: Excess mortality and age dependence through time-series analysis. medRxiv URL: https://www.medrxiv.org/
content/early/2020/04/20/2020.04.15.20067074.1,

doi:10.1101/2020.04.15.20067074,

arXiv:https://www.medrxiv.org/content/early/2020/04/20/2020.04.15.20067074.1.full.pdf.
Monras,
From

J.,

2020.

’red-zoning’

Some thoughts on covid-19 from a labour mobility perspective:
to

’green-zoning’.

Vox

URL:

https://voxeu.org/article/

some-thoughts-covid-19-labour-mobility-perspective.
Montero, P., Vilar, J.A., 2014. Tsclust: Anrpackage for time series clustering. Journal of Statistical Software
62, 1–43. doi:10.18637/jss.v062.i01.

25

OECD, 2002.

Redefining Territories: The Functional Regions.

OECD Publishing, Paris.

URL:

https://www.oecd-ilibrary.org/content/publication/9789264196179-en, doi:https://
doi.org/https://doi.org/10.1787/9789264196179-en.
Pettie, S., Ramachandran, V., 2000. An optimal minimum spanning tree algorithm, in: Montanari, U.,
Rolim, J.D.P., Welzl, E. (Eds.), Automata, Languages and Programming, Springer Berlin Heidelberg,
Berlin, Heidelberg. pp. 49–60.
Pree, H., Herwig, B., Gruber, T., Sick, B., David, K., Lukowicz, P., 2014. On general purpose time series
similarity measures and their use as kernel functions in support vector machines. Information Sciences
281, 478–495. doi:10.1016/j.ins.2014.05.025.
Riley, Fraser, C., Donnelly, C., 2003. Transmission dynamics of the etiological agent of sars in hong kong:
Impact of public health interventions. Science 300, 1961–1966. doi:10.1126/science.1086478.
Siegenfeld, A., Bar-Yam, Y., 2020. Eliminating covid-19: A community-based analysis. URL: https:
//arxiv.org/abs/2003.10086.
Wallinga, J., Teunis, P., 2004. Different epidemic curves for severe acute respiratory syndrome reveal
similar impacts of control measures. American Journal of Epidemiology 160, 509.
World Health Organization, 2020a. Strengthening and adjusting public health measures throughout the
covid-19 transition phases. policy considerations for the who european region.
World Health Organization, 2020b. Strengthening the health system response to covid-19 recommendations
for the who european region policy brief (1 april 2020).
Yadav, M., Alam, M., 2018. Dynamic time warping (dtw) algorithm in speech: A review. International
Journal of Research in Electronics and Computer Engineering 6, 524–528.
Zhao, W., Zhang, J., Meadows, M., Liu, Y., Hua, T., Fu, B., 2020. A systematic approach is needed to
contain covid-19 globally. Science Bulletin 65, 876–878.
Zhou, C., Su, F., Pei, T., Zhang, A., Du, Y., Luo, B., Cao, Z., Wang, J., Yuan, W., Zhu, Y., Song, C., Chen, J.,
Xu, J., Li, F., Ma, T., Jiang, L., Yan, F., Yi, J., Hu, Y., Liao, Y., Xiao, H., 2020. Covid-19: Challenges to
gis with big data. Geography and Sustainability 1, 77 – 87. URL: http://www.sciencedirect.com/

26

science/article/pii/S2666683920300092, doi:https://doi.org/10.1016/j.geosus.2020.
03.005.

27

