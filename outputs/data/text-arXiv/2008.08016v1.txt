M ASKED FACE -N ET - A DATASET OF CORRECTLY / INCORRECTLY
MASKED FACE IMAGES IN THE CONTEXT OF COVID-19
A P REPRINT
Adnane Cabani1∗
Normandie Univ, UNIROUEN
ESIGELEC, IRSEEM
76000 Rouen, France
adnane.cabani@esigelec.fr

arXiv:2008.08016v1 [cs.CV] 18 Aug 2020

1

Halim Benhabiles4
Univ. Lille, CNRS, Centrale Lille
Univ. Polytechnique Hauts-de-France
Yncrea Hauts-de-France
UMR 8520 - IEMN
Lille F-59000, France
halim.benhabiles@yncrea.fr
4

Karim Hammoudi2,3,∗
Université de Haute-Alsace
Department of Computer Science, IRIMAS
F-68100 Mulhouse, France
3
Université de Strasbourg
karim.hammoudi@uha.fr
2

Mahmoud Melkemi2,3
Université de Haute-Alsace
Department of Computer Science, IRIMAS
F-68100 Mulhouse, France
3
Université de Strasbourg
mahmoud.melkemi@uha.fr
2

August 19, 2020

A BSTRACT
The wearing of the face masks appears as a solution for limiting the spread of COVID-19. In this
context, efficient recognition systems are expected for checking that people faces are masked in
regulated areas. To perform this task, a large dataset of masked faces is necessary for training
deep learning models towards detecting people wearing masks and those not wearing masks. Some
large datasets of masked faces are available in the literature. However, at the moment, there are
no available large dataset of masked face images that permits to check if detected masked faces
are correctly worn or not. Indeed, many people are not correctly wearing their masks due to bad
practices, bad behaviors or vulnerability of individuals (e.g., children, old people). For these reasons,
several mask wearing campaigns intend to sensitize people about this problem and good practices. In
this sense, this work proposes three types of masked face detection dataset; namely, the Correctly
Masked Face Dataset (CMFD), the Incorrectly Masked Face Dataset (IMFD) and their combination
for the global masked face detection (MaskedFace-Net). Realistic masked face datasets are proposed
with a twofold objective: i) to detect people having their faces masked or not masked, ii) to detect
faces having their masks correctly worn or incorrectly worn (e.g.; at airport portals or in crowds).
To the best of our knowledge, no large dataset of masked faces provides such a granularity of
classification towards permitting mask wearing analysis. Moreover, this work globally presents the
applied mask-to-face deformable model for permitting the generation of other masked face images,
notably with specific masks. Our datasets of masked face images (137,016 images) are available at
https://github.com/cabani/MaskedFace-Net.

Keywords virus protection · COVID-19 · masked face dataset · correct mask wearing · masked face detection.

∗

Adnane Cabani and Karim Hammoudi contributed equally to this work (corresponding authors).

A PREPRINT - AUGUST 19, 2020

(a) Samples of correctly masked faces (dataset CMFD).

(b) Samples of incorrectly masked faces (dataset IMFD).

Figure 1: A snapshot of the generated MaskedFace-Net image datasets: Fig.1a displays samples of correctly masked
faces (dataset CMFD); Fig.1b displays face samples with a mix of incorrectly masked faces (dataset IMFD). For each
set, 49 randomly sampled images are presented amongst approximately 70,000 generated images.

1

Introduction and motivation

The wearing of the face masks appears as a solution for limiting the spread of COVID-19. In this context, efficient
recognition systems are expected for checking that people faces are masked in regulated areas. To perform this task, a
large dataset of masked faces is necessary for training deep learning models towards detecting people wearing masks
and those not wearing masks. In this sense, some large datasets of face images with virus-related protection mask are
available in the literature; e.g. the MAsked FAces dataset (MAFA) [1], the Real-World Masked Face Dataset (RMFD2 )
and a masked face recognition dataset [2] composed of Masked Face Detection Dataset (MFDD), Real-world Masked
Face Recognition Dataset (RMFRD) and Simulated Masked Face Recognition Dataset (SMFRD).
Besides, many people are not correctly wearing their masks due to bad practices, bad behaviors or vulnerability of
individuals (e.g., children, old people). In this sense, several mask wearing campaigns intend to sensitize people about
this problem and good practices [3–6]. In [7], a mobile application “CheckYourMask” has been designed towards
permitting people to check if their mask is correctly worn or not by taking a selfie. The creation of a dataset with
correctly/incorrectly worn mask classes has been suggested. In [8], a dataset composed of images with individual
or multiple masked faces (853 images) has been proposed towards creating detection model taking into account the
improperly masked faces. In the present case, we propose a relatively large dataset of 137,016 masked face images
that is divided into two masked face categories; correctly worn and incorrectly worn (see samples in Fig.1a and Fig.1b,
respectively).
Specifically, this work proposes three types of masked face detection dataset; namely, the Correctly Masked Face
Dataset (CMFD), the Incorrectly Masked Face Dataset (IMFD) and their combination (MaskedFace-Net) for the masked
face detection (see dataset structure in Fig.2a). Realistic masked face datasets are proposed with a twofold objective: i)
to detect people having their faces masked or not masked, ii) to detect faces having their masked correctly worn or
incorrectly worn (e.g.; at airport portals or in crowds). To best of our knowledge, no large dataset of masked faces
provides such a granularity of classification towards permitting mask wearing analysis. Moreover, this work globally
presents the applied mask-to-face deformable model for permitting the generation of other masked face images, notably
with specific masks.

2

see “Real-World Masked Face Dataset” https://github.com/X-zhangyang/Real-World-Masked-Face-Dataset.

2

A PREPRINT - AUGUST 19, 2020

MaskedFace-Net

Correctly masked

Incorrectly masked

CMFD

IMFD

Uncovered chin
IMFD1

Uncovered nose and
IMFD2

IMFD3

Uncovered nose

function GENERATING M ASKED FACE -N ET(F F HQ, mask)
for (each f ace image ∈ F F HQ) do
FaceDetection()
FacialLandmarksDetection()
if (CM F D targeted) then
Match(landmards)
Map(mask, f ace)
end if
if (IM F D1 targeted) then
Match(landmards)
Map(mask, f ace)
end if
if (IM F D2 targeted) then
Match(landmards)
Map(mask, f ace)
end if
mouth
if (IM F D3 targeted) then
Match(landmards)
Map(mask, f ace)
end if
end for
return MaskedFace-Net
end function

(a) View of the MaskedFace-Net data tree.

(b) Pseudo-code for the generation of MaskedFace-Net.

Figure 2: Fig.2a depicts the structure of the generated MaskedFace-Net dataset. Fig.2b shows a pseudo-code of the
mask-to-face deformable model applied for generating outputs Fig.2a of the MaskedFace-Net dataset.

2

Applied mask-to-face deformable model

The dataset of face images Flickr-Faces-HQ3 (FFHQ) has been selected as a base for creating an enhanced dataset
MaskedFace-Net composed of correctly and incorrectly masked face images. Indeed, FFHQ contains 70000 high-quality
images of human faces in PNG images at 1024 × 1024 resolution and is free of use. The FFHQ dataset offers a lot of
variety in terms of age, ethnicity, viewpoint, lighting, and image background. It was originally created as a benchmark
for generative adversarial networks (GAN) [9].
Our MaskedFace-Net dataset has been created by defining a mask-to-face deformable model. A pseudo-code of the
global principle for generating MaskedFace-Net is shown in Fig.2b with respect to outputs depicted in Fig.2a. For
each face image of FFHQ (e.g. Fig. 3a), Haar feature-based cascade classifiers are applied for detecting a region of
interest (detection of face rectangle). Then, a specific key point detector “shape predictor 68 face landmarks45 ” (model
derived from [10]) is applied to the detected region of interest and permits to automatically detect 68 landmarks of the
facial structure (see sample in Fig. 3b). Besides, an image of a conventional face protection mask (single-use blue face
protection mask) has been selected as a reference image for the mapping (see sample in Fig. 3c). For this latter, 12 key
points have manually been annotated for delineating the mask area (polygonal area).
At this stage, four types of mask-to-face mapping have been defined with respect to targeted cases (see Fig.2a), namely
mask covering the nose, mouth and chin (i.e. mask correctly worn), mask only covering the nose and mouth; mask
only covering mouth and chin and mask under the mouth (i.e. three cases of mask incorrectly worn). For each type
of mask-to-face mapping (CMFD, IMFD1, IMFD2 or IMFD3), a subset of 12 facial key points is retained from the
68 landmarks automatically detected; then matched to the 12 mask key points. By this way, the mask can fit specific
areas of the face for each targeted case. Hence, a mask-to-face deformable mask model has been created to generate
MaskedFace-Net. Moreover, each targeted case can have up to 2 key points of the mask (amongst 12 key points) that
have their locations randomly displaced in a limited perimeter. In particular, this tolerance allows to act on the height of
the mask on the face and then to bring more realism to the generated dataset.
Finally, a homography transformation which relies on the defined point-to-point correspondence of landmarks between
mask image and face image is applied for mapping mask pixels over the targeted facial areas. Instances of produced
face landmarks and corresponding mask-to-face mapping are displayed for each type in Fig.4a and Fig.4b, Fig.4c,
Fig.4d and Fig.4e, Fig.4f, Fig.4g, Fig.4h, respectively.
3

see “dataset of face images Flickr-Faces-HQ (FFHQ)” https://github.com/NVlabs/ffhq-dataset.
see “Facial point annotations” https://ibug.doc.ic.ac.uk/resources/facial-point-annotations/.
5
see
“shape
predictor
68
face
landmarks.dat.bz2”
https://github.com/davisking/dlibmodels#shape_predictor_68_face_landmarksdatbz2.
4

3

A PREPRINT - AUGUST 19, 2020

(a) Face image (first author).

(b) Detected landmarks.

(c) Annotated landmarks.

Figure 3: Sample of face image, reference mask image and considered landmarks.

(a) Detected landmarks.

(b) Detected landmarks.

(c) Detected landmarks.

(d) Detected landmarks.

(e) Correctly masked.

(f) Incorrectly masked.

(g) Incorrectly masked.

(h) Incorrecly masked.

Figure 4: (row 1) Results of landmarks detection with respect to the defined types of mask-to-face mapping. (row
2) Corresponding results of mask-to-face mapping driven by the proposed deformable model towards generating the
MaskedFace-Net dataset.

For information, Fig.2b illustrates a nominal scenario of face-related detection. However, some faces of FFHQ have not
been processed (177 images) since face occlusions (e.g., arms, hands) made the face detection failing (i.e. no detected
face rectangle). After the face detection, the MaskedFace-Net dataset contained 139,646 images. Moreover, a manual
filtering has been operated for deleting detected face images having their mask incorrectly mapped in reason of failing
landmark detection. Indeed, erroneous landmark detection occurs when the visibility of the facial contours is limited
(e.g. for profile views of detected faces). Hence, the proposed MaskedFace-Net dataset contains 137,016 masked face
images. The MaskedFace-Net dataset is composed of 49% of correctly masked faces (67,193 images) and 51% of
incorrectly masked faces (69,823 images). For this latter set, approximately 80% represents faces with only mouth and
chin masked, 10% with only nose and mouth masked and 10% with only chin masked.
We emphasize that a raw mask-to-face mapping has been applied to the FFHQ dataset. In particular, no images have
been filtered according to specific parameters (e.g. age). However, the file naming of MaskedFace-Net includes the one
given by the FFHQ dataset. Hence, correspondence in between the FFHQ and MaskedFace-Net can be established
towards related filtering.
It is worth mentioning that the minimum age for mask wearing depends on applicable laws in concerned countries. For
instance, the mask wearing is compulsory from 6 years old in Spain, 11 years old in France, 12 years old in Belgium
under certain conditions [11]. Between 2 and 11 years old, opinions differ [12]. Since FFHQ contains face images
of all ages, it is also the case for masked face image of MaskedFace-Net. Such datasets could then be exploited for
detecting children in crowds that wear a mask under the recommended limit of age.
4

A PREPRINT - AUGUST 19, 2020

3

Conclusion

A large dataset of 137,016 quality masked face images has been produced and made available online. MaskedFace-Net
can be seen as a benchmark dataset for creating machine learning models related to the mask wearing analysis; notably,
detecting the presence of mask or not over detected face images, the correct or incorrect wearing for detected masked
faces. MaskedFace-Net can then be used for enhancing vision-based monitoring systems towards several applications
such as checking the respect of laws related to the mask wearing or generating crowd statistics. Moreover, the method
used for the generation of MaskedFace-Net has been described for permitting the generation of masked face images by
using other types of mask.

4

Disclaimer

In no case the contributors of this work could be held responsible for any incident when using the MaskedFace-Net
dataset or masks.

References
[1] S. Ge, J. Li, Q. Ye, and Z. Luo, “Detecting masked faces in the wild with lle-cnns,” in 2017 IEEE Conference on
Computer Vision and Pattern Recognition (CVPR), 2017, pp. 426–434.
[2] Z. Wang, G. Wang, B. Huang, Z. Xiong, Q. Hong, H. Wu, P. Yi, K. Jiang, N. Wang, Y. Pei, H. Chen, Y. Miao,
Z. Huang, and J. Liang, “Masked face recognition dataset and application,” 2020, arXiv:2003.09093.
[3] Africa Centres for Disease Control and Prevention - Africa CDC, African Union, “How to wear a face mask
correctly,” 2020. https://africacdc.org/download/how-to-wear-a-face-mask-correctly/
[4] J. Bouteiller, “Coronavirus. comment bien porter son masque ? les conseils d’une infirmière de la métropole
de Lille,” 2020. https://actu.fr/hauts-de-france/lille_59350/coronavirus-comment-bien-porter-masque-conseilsdune-infirmiere_32651335.html
[5] Action Santé-Social Côte d’Ivoire, “Comment bien mettre son masque,” 2020. https://www.facebook.com/
110412877115436/photos/comment-bien-mettre-son-masque/154573562699367/
“Le port du masque:
les gestes à faire et ne pas faire,”
2020,
[6] L. Colart,
https://www.lesoir.be/sites/default/files/dpistyles_v2/ena_16_9_in_line/2020/04/21/node_296003/27512244/
public/2020/04/21/B9723268640Z.1_20200421182927_000+GBLFTKA92.1-0.jpg?itok=vge-65yl1587734455.
https://plus.lesoir.be/296003/article/2020-04-21/le-port-du-masque-les-gestes-faire-et-ne-pas-faire
[7] K. Hammoudi, A. Cabani, H. Benhabiles, and M. Melkemi, “Validating the correct wearing of protection mask by
taking a selfie: design of a mobile application “CheckYourMask” to limit the spread of COVID-19,” Computer
Modeling in Engineering & Sciences, 2020.
[8] “Mask dataset.” https://makeml.app/datasets/mask
[9] T. Karras, S. Laine, and T. Aila, “A style-based generator architecture for generative adversarial networks,” 2018,
arXiv:1812.04948.
[10] C. Sagonas, E. Antonakos, G. Tzimiropoulos, S. Zafeiriou, and M. Pantic, “300 faces in-the-wild challenge:
database and results,” Image and vision computing, vol. 47, pp. 3–18, 2016.
[11] RTBF, “Le masque obligatoire dès 6 ans en espagne, 11 ans en france, 12 ans en belgique : pourquoi tant de
différences ?” 2020. https://www.rtbf.be/info/societe/detail_le-masque-obligatoire-des-6-ans-en-espagne-11-ansen-france-12-ans-en-belgique-pourquoi-tant-de-differences?id=10549655
[12] C. Daclin, “Coronavirus : où et à quel âge les enfants doivent-ils porter le masque ?” 2020. https://www.rtl.fr/
actu/bien-etre/coronavirus-ou-et-a-quel-age-les-enfants-doivent-ils-porter-le-masque-7800688133

5

