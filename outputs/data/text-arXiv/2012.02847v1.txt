Network Group Testing

arXiv:2012.02847v1 [stat.AP] 4 Dec 2020

Paolo Bertolotti
IDSS, SDSC, LIDS
Massachusetts Institute of Technology
Cambridge, MA 02139
pbertolo@mit.edu

Ali Jadbabaie
IDSS, LIDS, CEE
Massachusetts Institute of Technology
Cambridge, MA 02139
jadbabai@mit.edu

Abstract
We consider the problem of identifying infected individuals in a population of
size N . Group testing provides an approach to test the entire population using
significantly fewer than N tests when infection prevalence is low. The original and
most commonly utilized form of group testing, called Dorfman testing, treats each
individual’s infection probability as independent and homogenous. However, as
communicable diseases spread from individual to individual through underlying
social networks, an individual’s network location affects their infection probability.
In this work, we utilize network information to improve group testing. Specifically,
we group individuals by community and demonstrate the performance gain over
Dorfman testing. After introducing a network and epidemic model, we derive the
number of tests used under network grouping. We prove the expected number of
tests is upper bounded by Dorfman testing. In addition, we demonstrate network
grouping successfully achieves the theoretical lower bound for two-stage testing
procedures when networks have strong community structure. On the other hand,
network grouping is equivalent to Dorfman testing when networks have no structure.
We end by demonstrating network grouping outperforms Dorfman testing in the
scenario of a university testing its population for COVID-19 cases.

1

Introduction

Group testing significantly improves testing capabilities for infectious diseases when resources are
limited. In normal scenarios, infected individuals from a population of size N are identified by testing
all population members individually, which uses N tests. In the simplest form of group testing,
individual samples are pooled together into groups of size n for an initial round of testing. If a group
tests negative, all individuals within the group are classified as negative for the disease. If a group
tests positive, all individual samples from the group are retested individually to identify the infected
members. To illustrate the power of group testing, consider the scenario where N = 50 and one
individual is infected. If individuals are pooled into groups of size n = 10 for an initial round of
testing, one group will test positive and all 10 samples from the group will be retested. The group
testing approach uses 15 tests compared to the 50 used under individual testing.
Group testing was introduced by Robert Dorfman in 1943 to screen for syphilis in the US military [1].
Dorfman’s insight was simple but powerful. As a result, group testing has been employed numerous
times in the medical field for diseases including influenza [2], chlamydia [3], and malaria [4]. Within
the US, group testing is used in blood banks [5] and infertility prevention programs [6, 7] where large
numbers of individuals are routinely tested. Group testing’s efficient use of resources has made it
a valuable technique in developing areas. Notably, group testing was used during the early stages
of the HIV pandemic in Africa when polymerase chain reaction (PCR) test costs were high [8, 9].
By reducing testing costs and increasing access to diagnostic information, group testing plays an
important role in increasing health equity.
Preprint. Under review.

Dorfman’s original method of two-stage testing, in which individuals are grouped for an initial round
of testing and samples from positive groups are then retested, remains the most common approach to
group testing in practice [2, 7, 10, 11]. In Dorfman’s work, each individual’s infection probability is
treated as independent and homogenous, which is equivalent to ignoring any information regarding an
individual’s susceptibility to infection. However, as communicable diseases spread from individual
to individual through underlying social networks, an individual’s network location affects their
infection probability. In this work, we utilize network information to pool individuals for group
testing. Specifically, we group individuals by community as infections are more likely to spread
between closely connected community members than between members of distinct communities.
In order to analyze the performance of a network grouping strategy, we first introduce a network
model and epidemic model. We utilize a stochastic block model to generate the networks under
consideration and the first stage of a branching process epidemic model to generate infections. Our
chosen models are able to capture the subtleties in the group testing problem and provide insight
into the behavior of network grouping. With generative models in hand, we derive the number of
tests used under network grouping. We prove the expected number of tests is upper bounded by
Dorfman testing, which implies network grouping weakly dominates Dorfman. In networks with
strong community structure, we prove network grouping achieves the theoretical lower bound for
two-stage testing procedures. In addition, we prove network grouping is equivalent to Dorfman
testing when the underlying network has no structure.
We end by considering the scenario of a university testing its population for COVID-19 cases
and demonstrate network grouping outperforms Dorfman testing. Our work reinforces the benefit
of group testing for communicable diseases, which is consequential for the current COVID-19
pandemic. Multiple labs have demonstrated the efficacy of group testing for detecting the SARSCoV-2 virus [11, 12] and several countries have implemented group testing to increase their testing
capabilities [13, 14]. As testing resources still remain constrained [15], we hope more institutions
and governments will take advantage of the power of group testing.

2

Setup

In this section, we describe Dorfman testing and the lower bound for two-stage group testing. Under
two-stage testing, a population of size N is split into N/n groups of size n for an initial round of
testing. Let G denote the number of positive groups after the initial round. In the second round of
testing, all n samples from each positive group are retested individually. In total, N/n + nG tests are
used.
Under Dorfman testing, one individual is infected with probability one and the remaining N −
1 individuals are infected independently with probability v.1 The expected number of infected
individuals is therefore E[ID ] = 1 + (N − 1)v. The expected number of tests used under Dorfman
testing is


 
N
N
E[TD ] =
+n 1+
− 1 v0
(1)
n
n
where v 0 = 1 − (1 − v)n . The derivation of E[TD ] was provided by Dorfman and can be found
in appendix A.1 for completeness. When the infection prevalence v is low, Dorfman testing uses
significantly fewer than N tests in expectation. As an example, consider the scenario where N = 1000
and v = 0.05. If we employ Dorfman testing and a group size of n = 10, only 507 tests are needed
in expectation to test the entire population, a reduction of nearly 50% compared to the N = 1000
tests used under individual testing.
Given a population, a certain number of infected individuals, and a group size, the minimum number
of tests is achieved by minimizing the number of positive groups G. G is minimized by perfect
grouping, in which all infected individuals are pooled together into the minimum possible number
of groups. The lower bound for two-stage testing procedures when 1 + (N − 1)v individuals are
infected is


N
1 + (N − 1)v
TLB =
+ n · max 1,
(2)
n
n
1

In Dorfman’s original paper, all N individuals are infected independently with probability v. We deviate
slightly from his original setup to ensure at least one individual is infected.

2

The derivation can be found in appendix A.2. Revisiting our example, if N = 1000, v = 0.05, and
n = 10, the minimum number of tests needed under two-stage group testing is 151. The lower bound
is unattainable in most scenarios as we do not know which samples are infected a priori.

3

Model

In this work, we consider the population of N individuals to be embedded in a network, where
each individual corresponds to a node and their physical interactions correspond to edges. In our
framework, the network underlying the population is generated by a stochastic block model (SBM).
Specifically, we consider an SBM with N nodes split into N/m communities of size m. Within each
community of m nodes, edges exist between nodes independently with probability p. Edges exist
between nodes in different communities independently with probability q, where q ≤ p. As a result,
nodes are more likely to be connected to other nodes in the same community than to nodes in other
communities.
For our epidemic model, we consider the initial stage of a branching process model. Specifically,
an epidemic starts with a single infected seed node, which is chosen at random from the population.
The seed node infects each of its neighbors independently with probability α. The seed node has
m − 1 possible neighbors within its community, each connected with probability p, and N − m
possible neighbors outside of its community, each connected with probability q. As a result, the
expected number of infected individuals under this model, which will we use for network grouping,
is E[IN G ] = 1 + (m − 1)pα + (N − m)qα.
The epidemic model describes the initial stage of an outbreak or, alternatively, a super-spreader event.
We set α such that the expected number of infected individuals in the epidemic model is equal to
the expected number of infected individuals in the Dorfman setting. Setting E[IN G ] = E[ID ] and
solving for α yields α = (N − 1)v/[(m − 1)p + (N − m)q]. Figure 1A provides a visual example
of an SBM and our epidemic model. For the remainder of this work, we assume the following.
Assumption 1. Assume 1 ≤ n ≤ N , 1 < m < N , 0 ≤ q ≤ p ≤ 1, and v ∈ [0, 1]. In addition,
assume α ∈ [0, 1] set such that E[IN G ] = E[ID ].

4

Results

In this section, we introduce our main results regarding network grouping and its performance
compared to Dorfman testing. Under network grouping, we group individuals by community. In the
simplest case, if communities have the same size as groups, m = n, each community is pooled into a
unique group. If community size is divisible by group size, the m community members are pooled
into m/n groups. If group size is divisible by community size, each group of size n consists of n/m
communities. For example, if m = 20 and n = 10, each community is pooled into two groups and if
m = 5 and n = 10, each group consists of two communities. When m not divisible by n and n not
divisible by m, we keep communities intact as much as possible and remainder community members
are pooled into the remaining groups.
The expected number of tests used under network grouping is


m
+
m
+  
N
N
E[TN G ] =
+n 1+
− 1 p0 +
−1−
−1
q0
n
n
n
n

(3)

where p0 = 1 − (1 − pα)n , q 0 = 1 − (1 − qα)n , and (x)+ = max(x, 0). The derivation of the full
distribution of the number of tests is provided in appendix A.3.
4.1

Performance of network grouping

With the number of tests under network grouping, Dorfman testing, and the lower bound derived, we
come to the main result of our work. The expected number of tests under network grouping is upper
bounded by Dorfman testing and lower bounded by the two-stage testing lower bound.
Theorem 1. Under the conditions of assumption 1,
TLB ≤ E[TN G ] ≤ E[TD ]
3

(4)

Network grouping
Dorfman testing
Lower bound

Number of tests, T

5000
4000
3000
2000
1000
0

0

(A)

5

10

15
Group size, n

20

25

30

(B)

Figure 1: (A) Example of an SBM and our epidemic model with N = 100, m = 10, p = 0.99,
q = 0.01, and v = 0.05. The infected seed node is colored red and its infected neighbors are colored
orange. The community structure present in SBMs is clearly visible. (B) Comparison of network
grouping, Dorfman testing, and the two-stage lower bound as a function of group size. The figure
displays the expected number of tests used to test a population of size N = 5000 where m = 400,
p = 0.8, q = 0.02, and v = 0.05.
Proofs for this section can be found in appendix A.4 and A.5. Theorem 1 states network grouping
weakly dominates Dorfman testing in terms of the expected number of tests used. In fact, there are
cases where network grouping significantly outperforms Dorfman testing and achieves the lower
bound, as seen in corollary 1.
Corollary 1. Under the conditions of assumption 1, if q = 0 and n ≥ m,
E[TN G ] = TLB

(5)

Corollary 1 states there are cases where network grouping performs optimally. When q = 0,
communities are disconnected from each other and all infected individuals will reside within the
same community. When n ≥ m, each group is large enough to capture each entire community and,
as a result, all infected individuals will be grouped together. However, there are also scenarios where
network grouping is equivalent to Dorfman testing, notability when q = p as seen in corollary 2.
Corollary 2. Under the conditions of assumption 1, E[TN G ] is increasing in q and if q = p,
E[TN G ] = E[TD ]

(6)

Corollary 2 states network grouping is equivalent to Dorfman testing when the underlying network
has no structure. Interestingly, even though we assume a network model, epidemic model, and
network grouping, we end up back where we started with Dorfman testing. The reasoning is simple:
since the network has no community structure, all nodes have the same probability of being infected
and the network provides no useful information for grouping.
In normal cases when 0 < q < p, network grouping can significantly outperform Dorfman testing.
Consider the scenario of a university testing its population for COVID-19 cases. Using MIT as our
example, MIT has roughly N = 5000 undergraduates living in dorms of around m = 400 students.
Assuming students within the same dorm are exposed to each other while students across dorms are
rarely allowed to interact due to social distancing restrictions, we set p = 0.8 and q = 0.02. We set
v = 0.05, which is in line with US infection prevalence estimated by the COVID Tracking Project
and Johns Hopkins University [16]. Figure 1B displays the expected number of tests needed to test
MIT’s population under network grouping, Dorfman testing, and the two-stage lower bound as a
function of group size. In this context, network grouping simply groups students by dorm. While
Dorfman testing significantly improves upon individual testing, which uses N = 5000 tests, network
grouping significantly improves upon Dorfman testing. When n = 10, network grouping uses only
1429 tests, a 43% reduction compared to Dorfman testing, which uses 2512 tests.
In this work, we have introduced the idea of using network information to improve group testing.
When networks have strong community structure, network grouping outperforms Dorfman testing.
4

Acknowledgments and Disclosure of Funding
We thank Alberto Abadie, Ben Deaner, Yash Deshpande, David Hughes, and Eric Lai for helpful
discussions. PB was supported by a National Defense Science and Engineering Graduate (NDSEG)
Fellowship.

References
[1] R. Dorfman, “The detection of defective members of large populations,” The Annals of Mathematical
Statistics, vol. 14, no. 4, pp. 436–440, 1943.
[2] T. T. Van, J. Miller, D. M. Warshauer, E. Reisdorf, D. Jernigan, R. Humes, and P. A. Shult, “Pooling
nasopharyngeal/throat swab specimens to increase testing capacity for influenza viruses by PCR,” Journal
of Clinical Microbiology, vol. 50, no. 3, pp. 891–896, 2012.
[3] M. J. Currie, M. McNiven, T. Yee, U. Schiemer, and F. J. Bowden, “Pooling of clinical specimens prior to
testing for chlamydia trachomatis by PCR is accurate and cost saving,” Journal of Clinical Microbiology,
vol. 42, no. 10, pp. 4866–4867, 2004.
[4] S. M. Taylor, J. J. Juliano, P. A. Trottman, J. B. Griffin, S. H. Landis, P. Kitsa, A. K. Tshefu, and S. R.
Meshnick, “High-throughput pooling and real-time PCR-based strategy for malaria detection,” Journal of
Clinical Microbiology, vol. 48, no. 2, pp. 512–519, 2010.
[5] US Food & Drug Administration, “Guidance for industry - Use of nucleic acid tests on pooled and individual samples from donors of whole blood and blood components, including source plasma, to reduce the risk
of transmission of hepatitis B virus.” https://www.fda.gov/regulatory-information/searchfda-guidance-documents/use-nucleic-acid-tests-pooled-and-individual-samplesdonors-whole-blood-and-blood-components, October 2012.
[6] C. R. Bilder, J. M. Tebbs, and P. Chen, “Informative retesting,” Journal of the American Statistical
Association, vol. 105, no. 491, pp. 942–955, 2010.
[7] C. S. McMahan, J. M. Tebbs, and C. R. Bilder, “Informative Dorfman screening,” Biometrics, vol. 68,
no. 1, pp. 287–296, 2012.
[8] J. Emmanuel, M. Bassett, H. Smith, and J. Jacobs, “Pooling of sera for human immunodeficiency virus
(HIV) testing: an economical method for use in developing countries,” Journal of Clinical Pathology,
vol. 41, no. 5, pp. 582–585, 1988.
[9] S. Vansteelandt, E. Goetghebeur, and T. Verstraeten, “Regression models for disease prevalence with
diagnostic tests on pools of serum samples,” Biometrics, vol. 56, no. 4, pp. 1126–1133, 2000.
[10] US Food & Drug Administration, “In vitro diagnostics EUAs - Molecular diagnostic template
for laboratories.” https://www.fda.gov/medical-devices/coronavirus-disease-2019-covid19-emergency-use-authorizations-medical-devices/vitro-diagnostics-euas, July 28,
2020.
[11] C. A. Hogan, M. K. Sahoo, and B. A. Pinsky, “Sample pooling as a strategy to detect community
transmission of SARS-CoV-2,” JAMA, April 2020.
[12] I. Yelin, N. Aharony, E. S. Tamar, A. Argoetti, E. Messer, D. Berenbaum, E. Shafran, A. Kuzli, N. Gandali,
O. Shkedi, T. Hashimshony, Y. Mandel-Gutfreund, M. Halberthal, Y. Geffen, M. Szwarcwort-Cohen, and
R. Kishony, “Evaluation of COVID-19 RT-qPCR test in multi sample pools,” Clinical Infectious Diseases,
May 2020.
[13] US Food & Drug Administration, “Pooled sample testing and screening testing for COVID19.”
https://www.fda.gov/medical-devices/coronavirus-covid-19-and-medicaldevices/pooled-sample-testing-and-screening-testing-covid-19, August 24, 2020.
[14] The Wall Street Journal, “Wuhan tests nine million people for coronavirus in 10 days.”
https://www.wsj.com/articles/wuhan-tests-nine-million-people-for-coronavirusin-10-days-11590408910, May 25, 2020.
[15] The Wall Street Journal, “COVID-19 testing is hampered by shortages of critical ingredient.”
https://wsj.com/articles/covid-19-testing-is-hampered-by-shortages-of-criticalingredient-11600772400, September 22, 2020.
[16] Johns Hopkins University, “Daily testing trends in the US.” https://coronavirus.jhu.edu/testing/
individual-states, Accessed September 25, 2020.

5

Appendix
A.1 Derivation of Dorfman testing
Under Dorfman testing, a population of size N is split into N/n groups of size n for an initial round
of testing. Let G denote the number of positive groups after the initial round. In the second round of
testing, all n samples from each positive group are retested individually. In total, N/n + nG tests are
used. G is a random variable. Of the N/n groups, one is positive with probability one as there is at
least one infected individual. The remaining N/n − 1 groups are positive independently with some
probability v 0 . As a result, G is distributed 1 + Bin(N/n − 1, v 0 ).
The probability v 0 is derived as follows. Each of the remaining N − n individuals (that are not in the
first group) are infected with probability v and not infected with probability 1−v. The probability that
all n individuals in a group are not infected is (1 − v)n . The probability that at least one individual in
the group is infected, and therefore the group tests positive, is v 0 = 1 − (1 − v)n . Putting everything
together, the number of tests used under Dorfman testing is distributed



N
N
0
TD ∼
+ n 1 + Bin
− 1, v
(7)
n
n
Taking the expectation of TD provides E[TD ] as displayed in equation 1.
A.2 Derivation of lower bound
Under two-stage group testing, a population of size N is split into N/n groups of size n for an
initial round of testing. Let G denote the number of positive groups after the initial round. In the
second round of testing, all n samples from each positive group are retested individually. In total,
N/n + nG tests are used. Given a population, a certain number of infected individuals, and a group
size, the minimum number of tests is achieved by minimizing the number of positive groups G.
G is minimized by perfect grouping, in which all infected individuals are pooled together into the
minimum possible number of groups.
When 1 + (N − 1)v individuals are infected, the minimum number of positive groups of size n is
[1 + (N − 1)v]/n. For example, if 20 individuals are infected and n = 10, the minimum number of
positive groups is two. When the number of infected individuals is greater than or equal to one but
less than or equal to n, the minimum number of positive groups will be one. Note, there is always at
least one infected individual in our framework. Putting everything together, the lower bound for the
number of tests needed under two-stage group testing is


N
1 + (N − 1)v
TLB =
+ n · max 1,
(8)
n
n
A.3 Derivation of network grouping
Under two-stage group testing, a population of size N is split into N/n groups of size n for an initial
round of testing. Let G denote the number of positive groups after the initial round. In the second
round of testing, all n samples from each positive group are retested individually. In total, N/n + nG
tests are used. G is a random variable.
The network contains N/m communities of size m. We consider cases where n divisible by m or m
divisible by n. First consider the case where m ≤ n. Since we group individuals by community (as
described at the beginning of section 4), the infected seed node and its m − 1 community members
will be contained in the same group. This group will be positive with probability one. The remaining
N/n − 1 groups each contain n nodes that belong to different communities than the seed node. As a
result, each node in the remaining N/n − 1 groups is not infected with probability 1 − qα, as they
are only infected if they are both connected to the seed, with probability q, and infected by the seed,
with probability α. The probability all n nodes within a group are not infected is (1 − qα)n . The
probability that at least one individual in a group is infected, and therefore the group tests positive,
is q 0 = 1 − (1 − qα)n . In summary, the remaining N/n − 1 groups are positive independently with
probability q 0 . Putting everything together, the distribution of the number of tests used under network
6

grouping when m ≤ n is
TN G




N
N
0
∼
+ n 1 + Bin
− 1, q
n
n

(9)

Now consider the case where m > n. As we group individuals by community, there will be one
group that contains the infected seed node and n − 1 of its community members. This group will be
positive with probability one. The remaining m − n nodes from the seed node’s community will be
pooled into (m − n)/n = m/n − 1 other groups. Each node in these groups will be infected with
probability 1 − pα, as they are only infected if they are both connected to the seed, with probability
p, and infected by the seed, with probability α. Following the same logic as the m ≤ n case, each of
these m/n − 1 groups is positive independently with probability p0 = 1 − (1 − pα)n . After accounting
for the infected seed’s group and the other m/n − 1 groups, N/n − m/n groups still remain. Each of
the n nodes in these groups are members of different communities than the seed node. Therefore,
each of the N/n − m/n groups is positive independently with probability q 0 = 1 − (1 − qα)n . Putting
everything together, the distribution of the number of tests used under network grouping when m > n
is




m
N
N
m 0
0
TN G ∼
+ n 1 + Bin
− 1, p + Bin
− ,q
(10)
n
n
n
n
The two cases, m ≤ n and m > n, can be easily combined. Defining (x)+ = max(x, 0), we have
(m/n − 1)+ = 0 when m ≤ n. Therefore, we can write the distribution of the number of tests used
under network grouping in the general case as



+ 
m
+ 
N
m
N
(11)
+ n 1 + Bin
− 1 , p0 + Bin
−1−
− 1 , q0
TN G ∼
n
n
n
n
where p0 = 1 − (1 − pα)n and q 0 = 1 − (1 − qα)n . Equation 11 holds exactly when N divisible by
n and either m divisible by n or n divisible by m. It is a strong approximation otherwise. Taking the
expectation of TN G in equation 11 provides E[TN G ] as displayed in equation 3.
A.4 Proof of theorem 1
Upper bound To prove E[TN G ] ≤ E[TD ], we prove E[TN G ] is increasing in q under assumption 1
and equals E[TD ] when q is set to its maximum value under assumption 1, q = p. This also proves
corollary 2. To prove E[TN G ] is increasing in q, we consider the cases where m > n and m ≤ n
separately.
Case 1: We first consider the case where m > n. When m > n, E[TN G ] is given by


 
m

N
N
m
E[TN G ] =
+n 1+
− 1 p0 +
−
q0
n
n
n
n

(12)

where p0 = 1 − (1 − pα)n and q 0 = 1 − (1 − qα)n .
Under assumption 1,
α = (N − 1)v/[(m − 1)p + (N − m)q]. Taking the derivative of equation 12 with respect to q
and simplifying yields
h
i
n−1
n−1
nv(N
−
1)(N
−
m)
p(m
−
1)
(1
−
qα)
−
p(m
−
n)
(1
−
pα)
∂ E[TN G ]
=
(13)
∂q
[(m − 1)p + (N − m)q]2
Demonstrating equation 13 is nonnegative proves equation 12 is increasing in q. The denominator
is nonnegative due to the square and n, v, N − 1, and N − m are nonnegative by assumption
1. Examining the bracket term in the numerator, we note p(m − 1) ≥ p(m − n) as n ≥ 1 and
(1 − qα)n−1 ≥ (1 − pα)n−1 as p ≥ q. Note both 1 − qα and 1 − pα are probabilities between 0
and 1 as p and α are between 0 and 1. As a result, the bracket term is nonnegative and the entirety of
equation 13 is nonnegative.
Case 2: We now consider the case where m ≤ n. When m ≤ n, E[TN G ] is given by


 
N
N
E[TN G ] =
+n 1+
− 1 q0
n
n
7

(14)

where q 0 = 1 − (1 − qα)n . Again, α = (N − 1)v/[(m − 1)p + (N − m)q]. Taking the derivative of
equation 14 with respect to q and simplifying yields
n

∂ E[TN G ]
nvp(N − 1)(N − n)(m − 1) (1 − qα)
=
(15)
∂q
[(m − 1)p + (N − m)q] [(m − 1)p + (N − m)q + q(1 − N )v]
All terms in the numerator and the first bracket term in the denominator are nonnegative by assumption
1. The second bracket term in the denominator is nonnegative if
(m − 1)p + (N − m)q + q(1 − N )v ≥ 0

(16)

Rearranging equation 16 yields
q(N − 1)v
≤1
(m − 1)p + (N − m)q
qα ≤ 1

(17)
(18)

which is true by assumption 1. As a result, equation 15 is nonnegative and equation 14 is increasing
in q.
Final step: We have shown E[TN G ] is increasing in q for m > n and m ≤ n. Setting q to its
maximum value under assumption 1, q = p, we have p0 = q 0 as 1 − (1 − pα)n = 1 − (1 − qα)n . In
addition, α simplifies to v/p and pα = v. Therefore, p0 = q 0 = v 0 where v 0 = 1 − (1 − v)n . E[TN G ]
in the general case simplifies to


m
+
m
+  
N
N
E[TN G ] =
+n 1+
− 1 p0 +
−1−
−1
q0
(19)
n
n
n
n


 
N
N
+n 1+
− 1 v0
(20)
=
n
n
and we have E[TN G ] = E[TD ], completing the upper bound portion of the proof.
Lower bound To prove E[TN G ] ≥ TLB , we prove E[TN G ] − TLB ≥ 0 for the three cases of 1)
group size larger than (or equal to) the expected number of infected individuals, n ≥ 1 + (N − 1)v,
2) group size less than infected individuals and less than community size, n < 1 + (N − 1)v and
n < m, and 3) group size less than infected individuals and greater than (or equal to) community
size, n < 1 + (N − 1)v and n ≥ m.
Case 1: When group size is larger than or equal to the expected number of infected individuals,
n ≥ 1 + (N − 1)v, the lower bound in equation 2 simplifies to N/n + n. Therefore,

m
+
m
+ 
N
0
−1 p +n
−1−
−1
q0
(21)
E[TN G ] − TLB = n
n
n
n
where p0 = 1 − (1 − pα)n and q 0 = 1 − (1 − qα)n . By assumption 1, n ≥ 1 and both p0 and q 0
are probabilities between 0 and 1, as 1 − pα and 1 − qα are between 0 and 1. In addition, the term
(N/n − 1 − (m/n − 1)+ ) is nonnegative as N ≥ n and N > m . As a result, the entirety of equation
21 is nonnegative.
Case 2: When group size is smaller than the expected number of infected individuals and community
size, n < 1 + (N − 1)v and n < m, we can write the lower bound TLB as
N
TLB =
+ 1 + (N − 1)v
(22)
n
N
=
+ 1 + (m − 1)pα + (N − m)qα
(23)
n
N
=
+ n + (m − 1)(1 − (1 − pα)) + (N − m)(1 − (1 − qα)) − (n − 1)
(24)
n
where the second equality makes use of the E[ID ] = E[IN G ] equivalence specified in assumption 1.
Equation 24 is a slight rearrangement of equation 23. As n < m, E[TN G ] becomes
N
E[TN G ] =
+ n + (m − n)p0 + (N − m)q 0
(25)
n
N
=
+ n + (m − 1)p0 + (N − m)q 0 − (n − 1)p0
(26)
n
8

Subtracting equation 24 from equation 26 yields
E[TN G ] − TLB =
(m − 1)[p0 − (1 − (1 − pα))] + (N − m)[q 0 − (1 − (1 − qα))] + (n − 1)(1 − p0 )

(27)

By assumption 1, we have m > 1, N > m, and n ≥ 1. In addition, 1 ≥ p0 as p0 = 1 − (1 − pα)n is
a probability between 0 and 1. Lastly, p0 = 1 − (1 − pα)n ≥ 1 − (1 − pα) as (1 − pα)n ≤ (1 − pα).
Similarly, q 0 = 1 − (1 − qα)n ≥ 1 − (1 − qα). As a result, E[TN G ] − TLB is nonnegative.
Case 3: We consider the case where group size is smaller than the expected number of infected
individuals but larger than (or equal to) community size, n < 1 + (N − 1)v and n ≥ m. Using
equation 23 and the inequality m ≥ 1 + (m − 1)pα, we have the following inequality for the lower
bound TLB .
N
+ 1 + (m − 1)pα + (N − m)qα
n
N
≤
+ m + (N − m)qα
n
N
=
+ n + (N − m)(1 − (1 − qα)) − (n − m)
n

TLB =

(28)
(29)
(30)

Since n ≥ m, E[TN G ] becomes
N
+ n + (N − n) q 0
n
N
+ n + (N − m) q 0 − (n − m)q 0
=
n
Subtracting equation 30 from equation 32 yields
E[TN G ] =

E[TN G ] − TLB ≥ (N − m)[q 0 − (1 − (1 − qα))] + (n − m)(1 − q 0 )

(31)
(32)

(33)

By assumption, N > m and n ≥ m. In addition, 1 ≥ q 0 as q 0 is a probability between 0 and 1.
Lastly, q 0 = 1 − (1 − qα)n ≥ 1 − (1 − qα) as (1 − qα)n ≤ (1 − qα). As a result, the difference
E[TN G ] − TLB is nonnegative.
We have proven E[TN G ] − TLB ≥ 0 for the three cases under consideration, completing the lower
bound portion of the proof and completing the proof of theorem 1.
A.5 Proof of corollary 1 and 2
Corollary 1 follows directly from the definition of E[TN G ]. When q = 0, we have
q 0 = 1 − (1 − qα)n = 0. When n ≥ m and q 0 = 0, E[TN G ] simplifies to
E[TN G ] =

N
+n
n

(34)

By assumption 1, α = (N − 1)v/[(m − 1)p + (N − m)q] ≤ 1. When q = 0, we have
(N − 1)v/[(m − 1)p] ≤ 1, which implies v ≤ (m − 1)p/(N − 1). Recall the number of infected
individuals is 1 + (N − 1)v. We now have 1 + (N − 1)v ≤ 1 + (m − 1)p and 1 + (m − 1)p ≤ m
as p ≤ 1. Since m ≤ n, we have 1 + (N − 1)v ≤ n. Therefore, the lower bound TLB is
TLB =

N
+n
n

(35)

and E[TN G ] = TLB , completing the proof.
Note, the assumption α ≤ 1 in assumption 1 sets an upper bound for the infection prevalence v as α
is a function of v. However, this is not restrictive as group testing is employed in cases when v is low.
Corollary 2 is proved during the proof of the theorem 1. See the proof of the theorem 1 upper bound
in appendix A.4.

9

