Social Distancing and COVID-19: Randomization Inference
for a Structured Dose-Response Relationship
Bo Zhang1 , Siyu Heng2 , Ting Ye1 , Dylan S. Small1,†
1 Department
2 Graduate

of Statistics, The Wharton School, University of Pennsylvania

Group in Applied Mathematics and Computational Science, School of Arts and

arXiv:2011.06917v2 [stat.AP] 25 Nov 2020

Sciences, University of Pennsylvania

Abstract: Social distancing is widely acknowledged as an effective public health policy combating the
novel coronavirus. But extreme social distancing has costs and it is not clear how much social distancing
is needed to achieve public health effects. In this article, we develop a design-based framework to make
inference about the dose-response relationship between social distancing and COVID-19 related death
toll and case numbers. We first discuss how to embed observational data with a time-independent,
continuous treatment dose into an approximate randomized experiment, and develop a randomizationbased procedure that tests if a structured dose-response relationship fits the data. We then generalize
the design and testing procedure to accommodate a time-dependent treatment dose in a longitudinal
setting. Finally, we apply the proposed design and testing procedures to investigate the effect of social
distancing during the phased reopening in the United States on public health outcomes using data
compiled from sources including Unacast™ , the United States Census Bureau, and the County Health
Rankings and Roadmaps Program. We rejected a primary analysis null hypothesis that stated the social
distancing from April 27th to June 28th had no effect on the COVID-19-related death toll from June
29th to August 2nd (p-value < 0.001) and conducted extensive secondary analyses investigating the
dose-response relationship between the social distancing level and COVID-19 case numbers.
Keywords: COVID-19; longitudinal studies; randomization inference; statistical matching; treatment
dose

1
1.1

Introduction
Social distancing, a pilot study, and dose-response relationship

Social distancing is widely acknowledged as one of the most effective public health strategies to
reduce transmission of the novel coronavirus (Lewnard and Lo, 2020). There seemed to be ample
† Address for correspondence: Dylan S. Small, Department of Statistics, The Wharton School, University of
Pennsylvania, Philadelphia, PA 19104 (e-mail: dsmall@wharton.upenn.edu).

1

evidence from China (Lau et al., 2020) and Italy (Sjödin et al., 2020) that a strict lockdown and
practice of social distancing could have a substantial effect on reducing disease transmission, but
social distancing has economic, psychological and societal costs (Acemoglu et al., 2020; Atalan,
2020; Grover et al., 2020; Sheridan et al., 2020; Venkatesh and Edirappuli, 2020). How much social
distancing is needed to achieve the desired public health effect? We conducted a pilot study in
March to investigate the effect of social distancing during the first week of President Trump’s 15
Days to Slow the Spread campaign (March 16-22, 2020) on the influenza-like illness (ILI) percentage
two and three weeks later. We tested the causal null hypothesis and found some weak evidence
(p-value = 0.08) that better social distancing had an effect on ILI percentage three weeks later. In
Supplementary Material A, we described in detail our pilot study. A protocol of the design and
analysis was posted on arXiv (https://arxiv.org/abs/2004.02944) before outcome data were
available and analyzed.
In addition to testing a causal null hypothesis, our main interest in this article is to explore the
“dose-response relationship” between the degree of social distancing and potential public health
outcomes under various degrees of social distancing. Infectious disease experts seemed to express
sentiments that the effect of social distancing on public health outcomes might be small or even
negligible under a small degree of social distancing, but much more substantial under a large degree
of social distancing. In an interview with the British Broadcasting Corporation (BBC Radio 4,
2020), director of the National Institute of Allergy and Infectious Diseases (NIAID), Dr. Anthony
S. Fauci said:
“We never got things down to baseline where so many countries in Europe and the UK
and other countries did – they closed down to the tune of about 97 percent lockdown.
In the United States, even in the most strict lockdown, only about 50 percent of the
country was locked down. That allowed the perpetuation of the outbreak that we never
did get under very good control”.
Perhaps Dr. Fauci was proposing a hypothesis that the treatment dose, i.e., level of social distancing,
played a very important role, and the causal effect of social distancing as a public health strategy
combating coronavirus transmission is likely to be very different depending on the extent to which
it is practiced. As statisticians, we would like to formalize and test the hypothesis concerning a
dose-response relationship between social distancing and public health outcomes.

2

1.2

Reopening and a dose-response kink model

Starting late April and early May, many states in the U.S. started phased reopening. States and
local governments differed in their reopening timelines; people in different states and counties also
differed in their social mobility during the process: some ventured out; some continued to stay
at home as much as possible. Figure 1 plots the 7-day rolling average of percentage change in
total distance traveled (data compiled and made available by Unacast™ ) of all counties in the U.S.,
from mid-March to late May. It is evident that as many counties started to ease social distancing
measures, we saw less reduction in distance traveled; in fact, in many counties, distance traveled

7−Day Average Percentage Change in Distance Traveled

started to return to and even supersede the pre-coronavirus level.
0.2

First Week
0.0

−0.2

−0.4

Reopening Starts

03/23

04/06

04/20

05/04

05/18

06/01

date

Figure 1: County-averaged 7-day rolling average (black solid line), middle 50% (dark shade), and middle
90% (light shade) of percentage change in total distance traveled, e.g., −0.35 corresponds to 35% reduction
in total distance traveled compared to the pre-coronavirus period. Average percentage change during the
first week of President Trump’s 15 Days to Slow the Spread campaign (March 16-22) is in red and during
the initial reopening phases is in green.

In this article, we leverage the county-level social distancing data since phased reopening in the
U.S. to study the dose-response relationship between the level of social distancing and its treatment
effect on public health outcomes. One potential model is the following dose-response kink model:
H0K :

Yn (z) = Yn (z ∗ ), ∀z ≤ τ, and
Yn (z) − Yn (τ ) = β(z − τ ), ∀z > τ, ∀n = 1, 2, · · · , N,
for some τ and β,

3

(1)

where z is a measure of change in social mobility (such that smaller z corresponds to more reduction
in total distance traveled and better social distancing), z ∗ a baseline social distancing level, and
Yn (z) the potential outcome under dose z. Model (1) states that the potential health-related
outcome (e.g., death toll, test positivity rate, etc) remains the same as the potential outcome
under the baseline social distancing level when the treatment dose z is less than a certain threshold
τ , and then increases at a rate proportional to how much z exceeds the threshold. Model (1)
succinctly captures two key features policy makers may be most interested in: τ the minimum dose
that “activates” the treatment effect, and β how fast the potential outcome changes as the dose
changes after exceeding the threshold. Model (1) may remind readers of the “broken line regression”
models in regression analysis; see Zhang and Singer (2010, Chapter 4). The key difference here
is that Model (1) and other dose-response relationships in this article are about the potential
outcomes, not the observed outcomes in a regression analysis. There are two closely related public
health questions of interest. First, is the dose-response kink model sufficient in explaining the
observed data? Second, if it is deemed sufficient, how to make inference for the threshold τ and
the proportional effect β?
1.3

Our contribution

We have three goals in this article. First, we propose a simple, model-free randomization-based
procedure that tests if a structured dose-response relationship, e.g., the dose-response kink model,
fits the data in a static setting with a time-independent, continuous or many-leveled treatment
dose. To be specific, an empirical researcher posits a structured dose-response relationship that
she finds scientifically meaningful, parsimonious, and flexible enough to describe data at hand; our
developed procedure can then be applied to test if such a postulated dose-response relationship is
sufficient to describe the causal relationship. If the hypothesis is rejected, empirical researchers
are then advised to re-examine the scientific theory underpinning the postulated model; otherwise,
the model seems a good starting point for data analysis. In this way, our method can be deemed
as a model-free “diagnostic test” for a dose-response relationship, and more broadly a test of the
underlying scientific theory. In our application, the treatment and outcome are both longitudinal;
our second goal is to generalize the proposed design and testing procedure to the longitudinal
setting. We define a notion of cumulative dose for a time-varying treatment dose trajectory, and
discuss how to embed observational longitudinal data into an approximate randomized controlled
trial in order to permute two treatment trajectories. Finally, we closely examine our assumptions
4

in the context of an infectious disease transmission mechanism and apply the developed design
and testing procedure to characterize the dose-response relationship between social distancing and
COVID-19 related death toll and case numbers during the reopening phases in the U.S. using
county-level data we compiled from sources including Unacast™ , the United States Census Bureau,
and the County Health Rankings and Roadmaps Program (Remington et al., 2015).

2
2.1

Investigating the dose-response relationship via nonbipartite matching
Observational data with a continuous treatment dose in a static setting

Suppose there are N = 2I units, indexed by n = 1, 2, · · · , N . Each unit is associated with a vector
of observed covariates Xn , an observed treatment dose assignment Znobs , and an observed outcome
Ynobs . The vector of observed covariates Xn are collected before the treatment assignment and
not affected by the treatment. Let Zn denote the treatment dose assignment of unit n, Z the set
of all possible treatment doses, z ∈ Z a realization of Zn , and |Z| the cardinality of Z. For a
binary treatment, |Z| = 2; for a continuous treatment dose, |Z| is an infinite number. In most
applications, Z is an ordered set (either partially ordered or totally ordered) with a (partial or
total) order defined in light of the application.
Let Yn (z) denote the potential outcome that unit n exhibits under the dose assignment z
assuming no interference among units (Rubin, 1980, 1986). Each unit n is associated with a
possibly infinite array of potential outcomes {Yn (z), z ∈ Z}. We will assume consistency so that
Ynobs = Yn (Znobs ). A causal estimand is necessarily a contrast between potential outcomes. Each unit
n is associated with a collection of unit-level causal effects {fn (z, z 0 ) = Yn (z) − Yn (z 0 ), ∀z, z 0 ∈ Z}.
Table 1 summarizes all information regarding these N units, where we let Z = {0, 1, 2, · · · } be
a countable set for ease of exposition. Table 1 is referred to as a science table in the literature
(Rubin, 2005). In a causal inference problem, the fundamental estimands of interest are the arrays of
potential outcomes in Table 1; the task of uncovering the arrays of potential outcomes is challenging
because one and only one of the potentially infinite array of potential outcomes for each unit is
actually observed (Holland, 1986).
One unique feature of problems with a continuous treatment dose assignment is that the unitlevel causal effect is an infinite set of comparisons between any two potential outcomes Yn (z) and
Yn (z 0 ), unlike with a binary treatment where the unit-level causal effect unambiguously refers to
a comparison between Yn (1) and Yn (0). Let z ∗ ∈ Z denote an arbitrary reference dose. Observe

5

Table 1: Science table of N = 2I units for a countable set Z = {0, 1, 2, · · · }.
Potential Outcomes
Units

Covariates
X

Observed
Dose Z

Y (0)

Y (1)

···

Y (z 0 )

···

Unit-Level
Causal Effects

Unit-level Causal
Effects Summary

Summary
Causal Effects

1
2
..
.

X1
X2
..
.

Z1obs
Z2obs
..
.

Y1 (0)
Y2 (0)
..
.

Y1 (1)
Y2 (1)
..
.

···
···
..
.

Y1 (z 0 )
Y2 (z 0 )
..
.

···
···
..
.

{Y1 (z) − Y1 (z 0 ), z, z 0 ∈ Z}
{Y2 (z) − Y2 (z 0 ), z, z 0 ∈ Z}
..
.

n
..
.

Xn
..
.

Znobs
..
.

Yn (0)
..
.

Yn (1)
..
.

···
..
.

Yn (z 0 )
..
.

···
..
.

{Yn (z) − Yn (z 0 ), z, z 0 ∈ Z}
..
.

Summarize
dose-response
relationship for
a common set
of units

N

XN

obs
ZN

YN (0)

YN (1)

···

YN (z 0 )

···

{YN (z) − YN (z 0 ), z, z 0 ∈ Z}

Unit-Level
Dose-response
relationship
e.g.,
Yn (z) − Yn (z ∗ )
= fn (z; z ∗ , θn )

that Yn (z) − Yn (z 0 ) = Yn (z) − Yn (z ∗ ) − {Yn (z 0 ) − Yn (z ∗ )}, and the collection of contrasts {Yn (z) −
Yn (z ∗ ), z ∈ Z} is sufficient in summarizing all pairwise comparisons of potential outcomes. With
a binary treatment, a “summary causal effect” (Rubin, 2005) is defined as a comparison between
Yn (1) and Yn (0) over the same collection of units, e.g., the mean unit-level difference for females.
With a continuous treatment dose, we first summarize the causal effects with a “unit-level doseresponse relationship” for each unit n. For example, one simple unit-level dose-response relationship
states that Yn (z) − Yn (z ∗ ) = τ0 , ∀z ∈ Z; in words, for unit n, the causal effect when comparing
treatment dose z to the reference dose z ∗ is equal to a constant τ0 regardless of the dose z ∈ Z.
We may then summarize such unit-level dose-response relationships for a collection of units. For
example, one such summary may state that a structured dose-response relationship f (z; z ∗ , θ) holds
for all counties in the U.S.; this summary can be represented by the following null hypothesis:
H01 : Yn (z) − Yn (z ∗ ) = f (z; z ∗ , θ), for all counties in the U.S. indexed by n, for some θ.
Another summary may state that a constant dose-response relationship holds for counties in the
Sun Belt, and a dose-response kink model holds for the rest of the U.S., i.e.,
H02 : Yn (z) − Yn (z ∗ ) = τ0 , for all counties in the Sun Belt, for some τ0 , and
Yn (z) = Yn (z ∗ ), ∀z ≤ τ, Yn (z) − Yn (τ ) = β(z − τ ), ∀z > τ,
for all counties outside the Sun Belt, for some τ and β.
We first develop a simple, randomization-based testing procedure to assess hypotheses of the form
H01 and H02 . The work most relevant to our development is Ding et al. (2016), who studied testing
the existence of treatment effect variation in a randomized controlled trial with a time-independent
binary treatment.
In a randomization-based inferential procedure, the potential outcomes (i.e., the infinite collec-

6

tion {Yn (z), ∀z ∈ Z, ∀n} in Table 1 are held fixed and the only probability distribution that enters
statistical inference is the randomization distribution that describes the treatment dose assignment.
The key step here is to properly embed the observational data into an approximately randomized
experiment (Rosenbaum, 2002, 2010; Bind and Rubin, 2019), as we are ready to describe.
2.2

Embedding observational data with a time-independent, continuous treatment into an
as-if randomized experiment via nonbipartite matching

In a randomized controlled experiment, physical randomization creates “the reasoned basis” for
drawing causal inference (Fisher, 1935). In the absence of physical randomization as with retrospective observational data, one strategy is to use statistical matching to embed observational
data into a hypothetical randomized controlled trial (Rosenbaum, 2002, 2010; Rubin, 2007; Ho
et al., 2007; Stuart, 2010; Bind and Rubin, 2019) by matching subjects with the same (or at least
very similar) estimated propensity score or observed covariates and forging two groups that are
well-balanced in observed covariates.
One straightforward design to handle observational data with a continuous treatment is to
dichotomize the continuous treatment based on some prespecified threshold and create a binary
treatment out of the dichotomization scheme. For instance, let Z denote a measure of social distancing; one can define counties with the social distancing measure above the median as the “abovemedian,” or “treated” group, and the others as the “below-median,” or “control” (or “comparison”)
group. One may then pair counties in the “above-median” group to those in the “below-median”
group via a standard bipartite matching algorithm (for instance, via the R package optmatch by
Hansen, 2007), and test the null hypothesis that social distancing has no effect on the outcome.
Such a strategy is often seen in empirical research, probably because of its simplicity; however,
dichotomizing the continuous treatment inevitably censors the rich information contained in the
original, continuous dose and prevents researchers from studying the dose-response relationship.
To address this limitation, Lu et al. (2001, 2011) proposed optimal nonbipartite matching. In
a nonbipartite matching, units with similar observed covariates but different treatment doses are
paired. Suppose there are N = 2I units, e.g., counties in the U.S in our application. In the
design stage, distances {δij , i = 1, · · · , N, j = 1, · · · , N } are calculated between each pair of
units and a N × N distance matrix is constructed (Lu et al., 2001, 2011; Baiocchi et al., 2010).
Some commonly used distances δij include the Mahalanobis distance between observed covariates
Xi and Xj and the rank-based robust Mahalanobis distance. Researchers may further modify the
7

distance to incorporate specific design aspects of the study. For instance, in a study that involves
effect modification, researchers are advised to match exactly or near-exactly on the effect modifier
(Rosenbaum, 2005; Zubizarreta et al., 2014), e.g., the geographic location of the county, and such
an aspect of design can be pursued by adding a large penalty to δij if county i and j are not from
the same geographic region.
An optimal nonbipartite matching algorithm then divides these N = 2I units into I nonoverlapping pairs of two units such that the total within-matched-pair distance is minimized.
Nonbipartite matching allows more flexible pairing compared to bipartite matching based on a
dichotomization scheme, and preserves the continuous nature of the treatment, which is essential
for investigating a dose-response relationship.
Suppose that we have formed I matched pairs of 2 units so that index ij, i = 1, · · · , I, j = 1, 2,
uniquely identifies a unit. We follow Rosenbaum (1989) and Heng et al. (2019) and define the
following potential outcomes after nonbipartite matching.
obs ∨Z obs = max(Z obs , Z obs )
Definition 1 (Potential Outcomes After Nonbipartite Matching). Let Zi1
i2
i1
i2
obs ∧ Z obs = min(Z obs , Z obs ) denote the maximum and minimum of two observed treatment
and Zi1
i2
i1
i2

doses in each matched pair i. We define the following two potential outcomes for each unit ij:
∆

∆

obs
obs
YT ij = Yij (Zi1
∨ Zi2
),

obs
obs
YCij = Yij (Zi1
∧ Zi2
),

where we abuse the notation and use subscripts T and C to denote the potential outcomes under
the maximum and minimum of two observed doses within each matched pair, respectively.
Write F = {Xij , YT ij , YCij , i = 1, · · · , I, j = 1, 2}, where YT ij and YCij are defined in Definition
obs
obs
obs
obs
obs
obs
obs
obs
obs
1, Zobs
∨ = (Z11 ∨ Z12 , · · · , ZI1 ∨ ZI2 ), and Z∧ = (Z11 ∧ Z12 , · · · , ZI1 ∧ ZI2 ). As always

in randomization inference (Rosenbaum, 2002, 2010; Ding et al., 2016), we condition on observed
covariates, potential outcomes, and observed dose assignments, i.e., we do not model X or the
potential outcomes, and rely on the treatment assignment mechanism to draw causal conclusions.
The law that describes the treatment dose assignment in each matched pair i is
obs
obs
obs
obs
obs
πi1 = P (Zi1 = Zi1
∨ Zi2
, Zi2 = Zi1
∧ Zi2
| F, Zobs
∨ , Z∧ ),

and πi2 = 1 − πi1 . In an ideal randomized experiment, experimenters use physical randomization
obs
(e.g., coin flips) to ensure πi1 = πi2 = 1/2: for matched pair i with two treatment doses Zi1

8

obs , a fair coin is flipped; if the coin lands heads, the first unit is assigned Z obs and the
and Zi2
i1
obs , and vice versa if the coin lands tails. The design stage of an observational
second unit Zi2

study aims to approximate this ideal (yet unattainable) hypothetical experiment by matching units
with similar covariates X so that πi1 ≈ πi2 after matching. In this way, nonbipartite matching
embeds observational data with a continuous treatment dose into a randomized experiment; this
induced randomization scheme will serve as our “reasoned basis” for inferring any causal effect
including a dose-response relationship. As is always true with retrospective observational studies,
a careful design may alleviate, but most likely never eliminate bias due to the residual imbalance
in X or unmeasured confounding variables. The departure from randomization, i.e., πi1 6= πi2 , is
investigated via a sensitivity analysis (Rosenbaum, 1989, 2002, 2010).

3
3.1

Randomization-based inference for a dose-response relationship
Randomization inference for fixed τ = τ0 and β = β0 in the dose-response kink model

Endowed with the randomization scheme induced by nonbipartite matching, we now turn to statistical inference. We first consider testing the dose-response kink model for a fixed τ = τ0 and
β = β0 for all units, i.e.,
τ0 ,β0
: Yij (z) = Yij (z ∗ ), ∀z ≤ τ0 , and
H0,kink

Yij (z) − Yij (τ0 ) = β0 (z − τ0 ), ∀z > τ0 , ∀i, j.
τ0 ,β0
Under H0,kink
, the entire dose-response relationship for subject ij is known up to Yij (z ∗ ). Fortuobs ); hence, the entire
nately, we do observe one point on the dose-response curve, namely Yij (Zij
obs ∧ Z obs ) and
dose-response curve for the subject ij is fixed, and both potential outcomes Yij (Zi1
i2
obs ∨ Z obs ) can then be imputed for each unit ij. In matched pair i, for the unit with
Yij (Zi1
i2
obs ∧ Z obs , her potential outcome under Z obs ∧ Z obs is the observed outcome Y obs and under
Zij = Zi1
i2
i1
i2
ij
obs ∨ Z obs is
Zi1
i2






Yijobs ,



obs ∨ Z obs − τ ),
Yijobs + β0 × (Zi1
0
i2





obs ∨ Z obs − Z obs ∧ Z obs ),

Yijobs + β0 × (Zi1
i2
i1
i2

9

obs ∨ Z obs ≤ τ ;
Zi1
0
i2
obs ∧ Z obs ≤ τ and Z obs ∨ Z obs > τ ;
Zi1
0
0
i2
i1
i2
obs ∧ Z obs > τ .
Zi1
0
i2

(2)

obs ∨ Z obs , her potential outcome under Z obs ∨ Z obs is the
Analogously, for the unit with Zij = Zi1
i2
i1
i2
obs ∧ Z obs is
observed outcome Yijobs and under Zi1
i2






Yijobs ,



obs ∨ Z obs − τ ),
Yijobs − β0 × (Zi1
0
i2





obs ∨ Z obs − Z obs ∧ Z obs ),

Yijobs − β0 × (Zi1
i2
i1
i2

obs ∨ Z obs ≤ τ ;
Zi1
0
i2

(3)

obs ∨ Z obs > τ and Z obs ∧ Z obs ≤ τ ;
Zi1
0
0
i2
i1
i2
obs ∧ Z obs > τ .
Zi1
0
i2

Table 2 illustrates the imputation scheme by imputing the missing potential outcome for each
τ0 ,β0
with τ0 = 0.3 and β0 = 1.
subject under the null hypothesis H0,kink

Table 2: Imputed science table when testing the dose-response kink model with τ0 = 1 and β0 = 0.3. Two
units in each pair i are arranged so that i1 has a smaller dose and i2 a larger dose. For each unit, one and
τ0 ,β0
only one potential outcome is observed; however, the other potential outcome can be imputed under H0,kink
.
(reference dose?)
Observe One Potential Outcome

Imputed Potential Outcomes

Units

Observed
obs
Dose Zij

obs ∧ Z obs )
Yij (Zi1
i2

obs ∨ Z obs )
Yij (Zi1
i2

obs ∧ Z obs )
Yij (Zi1
i2

obs ∨ Z obs )
Yij (Zi1
i2

11
12
21
22
31
32
..
.

0.2
0.4
0.9
2.2
1.4
1.9
..
.

obs
Y11
?
obs
Y21
?
obs
Y31
?
..
.

?
obs
Y12
?
obs
Y22
?
obs
Y32
..
.

obs
Y11
obs
Y12
obs
Y21
obs
Y22 − 0.3 × (2.2 − 1)
obs
Y31
obs
Y32 − 0.3 × (1.9 − 1.4)
..
.

obs
Y11
obs
Y12
obs + 0.3 × (2.2 − 1)
Y21
obs
Y22
obs + 0.3 × (1.9 − 1.4)
Y31
obs
Y32
..
.

I1

ZI1

obs
YI1

?

obs
YI1

Impute according
to scheme (2)

I2

ZI2

?

obs
YI2

Impute according
to scheme (3)

obs
YI2

..
.

..
.

obs ∧ Z obs in matched pair i, Y obs = {Y obs , i = 1, · · · , I},
Let ij 0 denote the unit with dose Zi1
i2
min
ij 0
obs . Analogously, let ij 00 denote the unit with dose Z obs ∨ Z obs and Y obs
and Fbmin (·) the CDF of Ymin
max
i1
i2
obs
obs
= {Yijobs
00 , i = 1, · · · , I}. For each Yij 00 ∈ Ymax , define the following transformed outcome:

Yeijobs
00 =






Yijobs
00 ,




obs ∨ Z obs ≤ τ ;
Zi1
0
i2

obs
obs
Yijobs
00 − β0 × (Zi1 ∨ Zi2 − τ0 ),





obs
obs
obs
obs

Yijobs
00 − β0 × (Zi1 ∨ Zi2 − Zi1 ∧ Zi2 ),

obs ∨ Z obs > τ and Z obs ∧ Z obs ≤ τ ;
Zi1
0
0
i2
i1
i2
obs ∧ Z obs > τ .
Zi1
0
i2

obs = {Y
e obs
btr
Let Yemax
ij 00 , i = 1, · · · , I} denote the collection of transformed outcomes, and Fmax (·) its
τ0 ,β0
CDF. The null hypothesis H0,kink
can then be tested by comparing the following Kolmogorov-

10

Smirnov-type (KS) test statistic
tr
tKS (τ0 , β0 ) = sup Fbmin (y) − Fbmax
(y)

(4)

y

evaluated at the observed data to a reference distribution generated based on the imputed science
table (e.g., Table 2) and enumerating all 2I possible randomizations: within each matched pair i,
obs ∨ Z obs and exhibits Y obs = Y (Z obs ∨ Z obs ) and i2 receives Z obs ∧ Z obs and
unit i1 receives Zi1
i1
i2
i1
i1
i2
i1
i2
obs ∧Z obs ), or unit i1 receives Z obs ∧Z obs and exhibits Y obs = Y (Z obs ∧Z obs )
exhibits Yi2obs = Yi2 (Zi1
i1
i2
i1
i2
i1
i1
i2
obs ∨ Z obs and exhibits Y obs = Y (Z obs ∨ Z obs ). In principle, any test statistic can
and i2 receives Zi1
i2
i2
i2
i1
i2

be combined with this randomization scheme to yield a valid test. We motivate the test statistic
(4) in Supplementary Material B.
We illustrate the procedure using the following simple example. We generate I = 200 matched
obs ∼ Unif[0, 4], Y (0) ∼ Normal(0, 1), and Y obs = Y (Z obs ) follows
pairs of 2 units, each with Zij
ij
ij
ij
ij
τ0 ,β0
Model (1) with τ = 1 and β = 0.5. We test the null hypothesis H0,kink
with τ0 = 1 and β0 = 0.5

using the test statistic (4). The left panel of Figure 2 plots the empirical distribution Fbmin (y)
tr (y), and t (1, 0.5) = 0.065 for the observed data. Instead of enumerating all 2I = 2200
and Fbmax
KS

possible treatment dose assignments, we draw with replacement 100, 000 samples from all 2200
possible configurations. The right panel of Figure 2 plots the reference distribution based on
these 100, 000 samples. Such a “sampling with replacement” strategy is referred to as a “modified
randomization test” in the literature (Dwass, 1957; Pagano and Tritchler, 1983) and known to still
preserve the level of the test. In this way, a p-value equal to 0.803 is obtained in this simulated
τ0 ,β0
dataset and the null hypothesis H0,kink
with τ0 = 1 and β0 = 0.5 is not rejected. The p-value is

exact as the procedure does not resort to any asymptotic theory and works in small samples.
3.2

Testing the dose-response kink model

Observe that
H0K =

[

τ0 ,β0
H0,kink
,

τ0 ,β0
τ0 ,β0
i.e., H0K is a composite hypothesis that is equal to the union of H0,kink
over all τ = τ0 and

β = β0 . In other words, the activation dose τ and the slope β are nuisance parameters to be taken
into account. One strategy testing H0K is to take the supremum p-value over the entire range of
(τ, β); another commonly used strategy (Berger and Boos, 1994) is to first construct a confidence

11

1.00

20

0.75

density

15

0.50

0.25

10

5

0.00

0
−2

0

2

0.1

y

0.2

test statistic

τ0 ,β0
Figure 2: An illustrative example. I = 200, τ = 1, and β = 0.5. We test the null hypothesis H0,kink
with
obs
tr
τ0 = 1 and β0 = 0.5. The left panel plots Fbmin (y), the empirical CDF of Ymin
and Fbmax
(y), the empirical
obs
CDF of the transformed outcomes Yemax . The test statistic tKS (1, 0.5) evaluated at the observed data is
0.065. The right panel plots the exact reference distribution of the test statistic given the sample and under
the null hypothesis. The reference distribution is generated using 100, 000 Monte Carlo draws from the 2200
randomization configurations. The red dashed line plots the position of the observed test statistic. The
exact p-value in this case is 0.803.

set around (τ, β) and then take the supremum p-values over the (τ, β) values in this confidence
set. This latter strategy is particularly useful when the treatment dose and/or the outcome of
interest are not bounded so that τ and β are not bounded; for some applications in the causal
inference literature, see Nolen and Hudgens (2011), Ding et al. (2016), and Zhang et al. (2020). In
Supplementary Material C, we discuss how to construct a bounded level-γ confidence set for (τ, β)
based on inverting a variant of the Wilcoxon rank sum test statistic and its properties.
Being able to reject H0K suggests evidence against the postulated dose-response relationship;
otherwise, the model is deemed sufficient to characterize the dose-response relationship for the
data at hand. We illustrate the procedure using the following example. We generate I = 200
obs ∼ Unif[0, 4], Y (0) ∼ Normal(0, 1), and Y obs = Y (Z obs ) =
matched pairs of 2 units with Zij
ij
ij
ij
ij
obs ≤ 1} + 1 · 1{1 < Z obs ≤ 4}. Figure 3 plots the p-values in log scale against
Yij (0) + 2 · 1{0 ≤ Zij
ij

τ0 and β0 . The maximum p-value is obtained at τ0 = 3.8 and β0 = 0.4 and equal to 0.004. The
null hypothesis H0K , i.e., the dose-response relationship follows a kink model, can be rejected at
level 0.05 for this simulated dataset.
3.3

Testing any structured dose-response model

Our discussion above suggests a general model-free, randomization-based framework to test any
structured dose-response relationship. Here, we say a dose-response relationship is “structured” if

12

4
−8

−7

−6

β0

3

2

1

pmax = 0.004

0
2.5

3.0

τ0

3.5

4.0

Figure 3: The probability contour plot (in log scale) against values of τ0 and β0 . The true dose-response

model is Yij (z) = Yij (0) + 2 · 1{0 ≤ z ≤ 1} + 1 · 1{1 < z ≤ 4}. We let Yij (0) ∼ N (0, 1) and I = 200. We
τ0 ,β0
test H0,kink
and plot the p-value in log scale against τ0 and β0 values. The maximum p-value is obtained at
τ0 = 3.8 and β0 = 0.4 and equal to 0.004. The null hypothesis H0K is hence rejected at level 0.05 for this
simulated dataset.

it is characterized by a few structural parameters. Consider the following structured dose-response
relationship model:
H0dose-response : Yij (z) − Yij (z ∗ ) , f (z; z ∗ , θ) = 0, ∀i = 1, · · · , I, j = 1, 2, for some θ,
where z ∗ ∈ Z is a reference dose, and f (· ; z ∗ , θ) is a univariate function that satisfies f (z ∗ ; z ∗ , θ) = 0
and is parametrized by a p-dimensional vector of structural parameters θ ∈ Rp . Algorithm 1
summarizes a general procedure testing H0dose-response at level α. In Supplementary Material D, we
brief discuss and illustrate how to sequentially test a few dose-response relationships ordered in
their model complexity.

4
4.1

Extension to longitudinal studies with a time-varying treatment
Treatment dose trajectory and potential outcome trajectory

In our application, the treatment dose evolves over time and the public-health-related outcomes,
e.g., county-level COVID-19 related death toll, may depend on the treatment dose trajectory.
Formally, let t0 denote a baseline period and t1 , t2 , · · · , ti , · · · , T subsequent treatment periods.

13

Algorithm 1. Randomization Inference for a Dose-Response Relationship: Pseudo Algorithm
Input: I matched pairs after nonbipartite matching and a dose-response relationship
model H0dose-response : Yij (z) − Yij (z ∗ ) , f (z; z ∗ , θ) = 0, ∀i, j, for some θ
1. Construct CIθ , a level-γ confidence set for the structural parameter θ;
2. For each θ 0 ∈ CIθ , do the following steps:
obs ∨ Z obs , i.e., the unit
(a) Compute the test statistic tobs . For each unit ij with Zij = Zi1
i2
with maximum dose in each matched pair i, define the following transformed outcome
obs
obs ∗
obs
obs ∗
Yeijobs = Yijobs − f (Zi1
∨ Zi2
; z , θ 0 ) + f (Zi1
∧ Zi2
; z , θ 0 ).

(5)

tr (·) denote the empirical CDF of {Y
e obs , i = 1, · · · , I} and Fbmin (·) the empirical
Let Fbmax
ij
obs ∧ Z obs . Calculate
CDF of the collection of units ij with Zij = Zi1
i2
tr
tobs = sup Fbmin (y) − Fbmax
(y) ;
y

obs ∧ Z obs , impute
(b) Impute the science table. For each unit ij with Zij = Zi1
i2
obs ∧ Z obs ) = Y obs and
Yij (Zi1
i2
ij
obs
obs
obs
obs ∗
obs
obs ∗
∨ Zi2
; z , θ 0 ) − f (Zi1
∧ Zi2
; z , θ 0 );
Yij (Zi1
∨ Zi2
) = Yijobs + f (Zi1
obs ∨ Z obs , impute Y (Z obs ∨ Z obs ) = Y obs and
for each unit ij with Zij = Zi1
ij
i2
i1
i2
ij
obs
obs
obs
obs ∗
obs
obs ∗
Yij (Zi1
∧ Zi2
) = Yijobs − f (Zi1
∨ Zi2
; z , θ 0 ) + f (Zi1
∧ Zi2
; z , θ 0 );

(c) Generate a reference distribution. Sample with replacement MC = 100, 000 dose
assignment configurations from the 2I possible configurations. For each sampled dose
(k)
e k , calculate e
assignment configuration Z
tKS (θ 0 ) according to Step (a). Let Feθ0 denote
(k)
the distribution of {e
tKS (θ 0 ), k = 1, 2, · · · , MC};
(d) Compute the p-value pθ by comparing tobs to the reference distribution Feθ , i.e.,
0

0

MC

pθ 0

o
1 X n (k)
1 t̃KS (θ0 ) ≥ tobs ;
=
MC
k=1

3. Let pmax = supθ∈CIθ pθ and reject the null hypothesis H0dose-response at level α if
pmax + γ ≤ α.

14

Fix t0 ≤ ti ≤ tj and let Z be the set of all possible treatment doses at each time point. Let
Zti :tj = (Zti , Zti +1 , · · · , Ztj ) ∈ Z × · · · × Z
{z
}
|
tj −ti +1

denote the random treatment dose trajectory (Robins, 1986; Bojinov and Shephard, 2019) from ti
obs
obs
obs
to tj , zti :tj one realization of Zti :tj , and Zobs
n,ti :tj = (Zn,ti , Zn,ti +1 , · · · , Zn,tj ) the observed treatment

dose trajectory of unit n from ti to tj . In our application, t0 denotes the start of the phased
reopening and Zti :tj the trajectory of daily percentage change in total distance traveled from ti to
tj . We are interested in the effect of a sustained period of treatment on some future outcome. We
assume that the treatment dose at time t temporally precedes the outcome at time t. Fix a time
t and let Yn,t (zt0 :t ) = Yn,t (zt0 , zt1 , · · · , zt ) denote the potential outcome of unit n at time t under
obs = Y (Zobs ).
the treatment dose trajectory Zn;t0 :t = zt0 :t . We assume consistency so that Yn,t
n,t
n;t0 :t

Finally, we let Yn;ti :tj (zt0 :tj ) denote unit n’s potential outcome trajectory from time ti to tj under
the treatment dose trajectory zt0 :tj .
4.2

Covariate history and sequential randomization assumption

One unique feature of longitudinal data is that the observed outcome trajectory up to time t−1 may
confound the treatment dose at time t; this is particularly true in our application: if the COVID19 related case and death numbers were high during the last week in a county, then residents
may be more wary of the disease and reduce social mobility this week. Following the literature
on longitudinal studies, we let Ln,t denote the time-dependent covariate process of unit n up to
but not including time t; Ln,t contains both time-independent covariates Xn and time-dependent
obs , Y obs , · · · , Y obs }. We further assume the sequential
covariates like the observed outcomes {Yn,t
n,t1
n,t−1
0

randomization assumption (SRA) (Robins, 1998), which states that conditional on the treatment
history up to time t − 1 and covariate process up to time t, the treatment dose assignment at time
t is independent of the potential outcome trajectories, i.e.,
|=

Yn;t0 :T (zt0 :T ) Zn,t | Zn;t0 :t−1 = zn;t0 :t−1 , Ln,t , ∀zt0 :T .
This assumption holds if residents’ adopting the social distancing measures at time t depends on
(1) their history of adopting social distancing measures, (2) time-independent covariates, and (3)
observed daily COVID-19 related case numbers and death toll up to time t − 1. See also Mattei

15

et al. (2019) for a relaxed version of this assumption.
4.3

Cumulative treatment dose, W-equivalence, and dose-response relationship in a longitudinal setting

One general recipe for drawing causal inference from longitudinal data is to model the marginal distribution of the counterfactual outcomes Yn,t (zt0 :t ), or the marginal joint distribution of Yn;ti :tj (zt0 :t ),
as a function of the treatment trajectory and baseline covariates; see Robins (1986, 1994); Robins
et al. (1999, 2000) for seminal works. For example, one simplest model may state that N units
are i.i.d. samples from a superpopulation such that the counterfactual mean of the outcome at
time t depends on the treatment dose trajectory and the time-independent covariates X through
a known functional form g(·), i.e., E[Yt (Zt0 :t ) | X] = g(Zt0 :t , X; β), and the interest lies in efficient
estimation of the structural parameters β.
In the infectious disease context, modeling the potential outcomes is a daunting task and our
interest here lies in testing a structural dose response relationship in a less model-dependent way.
To proceed, we generalize the notion of “dose” from the static to longitudinal setting. Consider
the following weighted difference between two treatment dose trajectories zti :tj and z0ti :tj :
zti :tj − z0ti :tj

W

=

X

w(t0 ) · (zt0 − zt00 ),

(6)

ti ≤t0 ≤tj

where W is a shorthand for the weight function W(t0 ) = {w(t0 ) | 0 ≤ w(t0 ) ≤ 1 and

P

ti ≤t0 ≤tj

w(t0 ) =

1}. Let z∗ti :tj denote a reference trajectory, e.g., z∗ti :tj = (−1, −1, · · · , −1) corresponding to 100%
reduction in total distance traveled from ti to tj . For each treatment dose trajectory zti :tj , we
define its “cumulative dose” as the weighted difference between zti :tj and z∗ti :tj .
Definition 2 (Cumulative Dose). Let zti :tj be a realization of the treatment dose trajectory Zti :tj .
Its cumulative dose with respect to the reference trajectory z∗ti :tj and the weight function W is
CD(zti :tj ; z∗ti :tj , W) = zti :tj − z∗ti :tj

W

,

where k · kW is defined in (6).
Remark 1. The cumulative dose of a treatment dose trajectory is defined with respect to a reference trajectory and a weight function. The choices of the reference trajectory and weight function

16

should be guided by expert knowledge so that the cumulative dose reflects some scientifically meaningful aspect of the treatment dose trajectory.
A collection of treatment dose trajectories is said to be “W-equivalent” if they have the same
cumulative dose with respect to the same weight function and reference trajectory.
Definition 3 (W-Equivalence). Two treatment dose trajectories zti :tj and z0ti :tj are said to be
W

W-equivalent w.r.t.to the reference trajectory z∗ti :tj , written as zti :tj ≡ z0ti :tj , if CD(zti :tj ; z∗ti :tj , W)
= CD(z0ti :tj ; z∗ti :tj , W). Treatment dose trajectories that are equivalent to zti :tj form an equivalence
class and is denoted as
o
n
[zti :tj ]W = z0ti :tj | CD(z0ti :tj ; z∗ti :tj , W) = CD(zti :tj ; z∗ti :tj , W) .
Equipped with Definition 2 and 3, we are ready to state a major assumption that facilitates
extending a dose-response relationship to longitudinal settings.
Assumption 1 (Potential outcomes under W-equivalence). Let [zt0 :t ]W be an equivalence class
as defined in Definition 3 with respect to k · kW and a reference trajectory z∗t0 :t . Then unit-level
potential outcomes at time t, Yn,t (·), satisfies:
Yn,t (zt0 :t ) = Yn,t (z0t0 :t ), ∀ zt0 :t , z0t0 :t ∈ [zt0 :t ]W .

(7)

Example 1. In a longitudinal study of the effect of zidovudine (AZT) on mortality, Zt0 :t represents the AZT dose trajectory from t0 to t. Let Yn,30 = 1 if unit n dies at time t = 30 and
0 otherwise. Assumption 1 applied to Yn,30 then states that patient n’s 30-day mortality status
depends on the AZT trajectory from t0 to t only through some “cumulative dose” captured by
CD(zt0 :t ; z∗t0 :t , W). For instance, Robins et al. (2000) assumes the causal effect of the time-varying
zidovudine (AZT) treatment on mortality is only through its aggregate dose, i.e., z∗t0 :t = (0, · · · , 0)
P
and CD(zt0 :t ; z∗t0 :t , W) = t0 ≤t0 ≤t zt0 .
Remark 2. Though Assumption 1 and its variants are often assumed in the literature on longitudinal studies in order to reduce the number of potential outcomes (Robins et al., 2000, Section
7), its validity needs to be evaluated on a case-by-case basis. We will evaluate Assumption 1 in the
infectious disease dynamics context before invoking it in our application.
We now extend the dose-response relationship from a static setting to a longitudinal setting.
17

Definition 4 (Unit-Level Dose-Response Relationship in Longitudinal Studies). Let CD(zt0 :t ; z∗t0 :t , W)
be a cumulative dose defined in Definition 2 and fn (·; θ n ) a univariate dose-response model parametrized
by θn such that fn (0; θn ) = 0. Suppose that Assumption 1 holds. A unit-level dose-response relationship for unit n states that

Yn,t (zt0 :t ) − Yn,t (z∗t0 :t ) = fn CD(zt0 :t ; z∗t0 :t , W); θ n .

(8)

Remark 3. Observe that when zt0 :t = z∗t0 :t , the LHS of (8) evaluates to 0 and the RHS evaluates

to fn CD(z∗t0 :t ; z∗t0 :t , W); θ n = fn {0; θ n } = 0.
Remark 4. Let zt0 :t and z0t0 :t be two treatment dose trajectories such that zt0 :t 6= z0t0 :t but
CD(zt0 :t ; z∗t0 :t , W) = CD(z0t0 :t ; z∗t0 :t , W). For the dose-response relationship (8) to be well-defined,
we necessarily have Yn,t (zt0 :t ) = Yn,t (z0t0 :t ), which is guaranteed by Assumption 1.
Remark 5. Similar to the static setting considered in Section 2, the dose-response relationship (8)
can be thought of as a parsimonious summary of unit-level causal effects from a sustained period
of treatment.
4.4

Embedding longitudinal data into an experiment and testing a dose-response relationship

Let i = 1, 2, · · · , I be I pairs of two units matched on the covariate process Li1,t = Li2,t but
obs
Z obs
i1;t0 :t 6= Z i2;t0 :t . Units i1 and i2 are each associated with the following two potential outcomes at

time t:
Yij,t (Z obs
i1;t0 :t )

and Yij,t (Z obs
i2;t0 :t ), i = 1, · · · , I, j = 1, 2,

obs
in parallel with Definition 1 in the static setting. Write Ft = {Lij,t , Yij,t (Z obs
i1;t0 :t ), Yij,t (Z i2;t0 :t ), i =

1, · · · , I, j = 1, 2}. Let ij 0 denote the unit with the minimum cumulative dose in matched pair i and
obs
obs
obs
obs
obs
ij 00 the other unit, and write Zobs
∧;t0 :t = {Z1j 0 ;t0 :t , · · · , ZIj 0 ;t0 :t }, and Z∨;t0 :t = {Z1j 00 ;t0 :t , · · · , ZIj 00 ;t0 :t }.

By iteratively applying the sequential randomization assumption, it is shown in the Supplementary
Material E that
obs
obs
obs
πi1 =P (Zi1;t0 :t = Zobs
i1;t0 :t , Zi2;t0 :t = Zi2;t0 :t | Ft , Z∧;t0 :t , Z∨;t0 :t )

(9)

obs
obs
obs
=P (Zi1;t0 :t = Zobs
i2;t0 :t , Zi2;t0 :t = Zi1;t0 :t | Ft , Z∧;t0 :t , Z∨;t0 :t ) = πi2 = 1/2.

Remark 6. In the static setting, it suffices to match on observed covariates to embed data into an
approximate experiment; in the longitudinal setting, one needs to match on the covariate process
18

Lt including the time-independent covariates and observed outcomes during the treatment period.
Remark 7. Our framework is different from the balance risk set matching of Li et al. (2001).
According to Li et al. (2001)’s setup, units receive a binary treatment at most once in the entire
study period. Our framework is also different from Imai et al. (2018). Imai et al. (2018)’s primary
interest is the treatment effect of an intervention at a particular time point t; hence, Imai et al.
(2018) pair a subject receiving treatment at time t to subjects with the same treatment dose and
covariate process up to time t − 1 but not receiving the treatment at time t. In sharp contrast, we
are focusing on the causal effect of a sustained period of treatment, similar to the setup in Robins
et al. (2000). The entire treatment dose trajectory is the unit to be permuted and our design
reflects this aspect.
Consider testing the following dose-response relationship in a longitudinal study:
H0L : Yij,t (zt0 :t ) − Yij,t (z∗t0 :t )

=f CD(zt0 :t ; z∗t0 :t , W); θ ,

∀i = 1, · · · , I, j = 1, 2,

for some θ,

where z∗t0 :t is a reference trajectory, CD(zt0 :t ; z∗t0 :t , W) a cumulative dose, and f (·; θ) a dose-response
relationship of scientific interest. Within each matched pair are two observed treatment dose
obs
obs
trajectories Zobs
i1;t0 :t and Zi2;t0 :t . We observe the potential outcome that i1 exhibits under Zi1;t0 :t ,
obs
obs
L
i.e., Yi1,t (Zobs
i1;t0 :t ) = Yi1,t ; moreover, we are able to impute Yi1,t (·) evaluated at Zi2;t0 :t , under H0

and Assumption 1:
n
o
n
o
obs
obs
∗
obs
∗
Yi1,t (Zobs
)
=
Y
+
f
CD(Z
;
z
,
W);
θ
−
f
CD(Z
;
z
,
W);
θ
.
i2;t0 :t
i1,t
i2;t0 :t t0 :t
i1;t0 :t t0 :t

(10)

obs
Similarly, we have Yi2,t (Zobs
i2;t0 :t ) = Yi2,t and can impute:

n
o
n
o
obs
obs
∗
obs
∗
Yi2,t (Zobs
i1;t0 :t ) = Yi2,t + f CD(Zi1;t0 :t ; zt0 :t , W); θ − f CD(Zi2;t0 :t ; zt0 :t , W); θ .

(11)

Table 3 summarizes the observed and imputed information. The problem has now been reduced to
the static setting, except that instead of permuting the two scalar treatment doses, we now permute
two treatment dose trajectories. Randomization-based testing procedure like the one discussed in
Section 3 in a static setting can be readily applied to testing (1) θ = θ 0 for a fixed θ 0 and (2) the
validity of a postulated dose-response relationship H0L .

19

Table 3: Imputed science table when testing a dose-response relationship in a longitudinal setting. For each
unit, one and only one potential outcome is observed; however, the other potential outcome can be imputed
under Assumption 1 and H0L .
Observe One Potential Outcome

Imputed Potential Outcomes

Units

Obs. Treatment
Dose Trajectory
Zobs
ij;t0 :t

Cumulative
Dose
Zobs
ij;t0 :t

Yij,t (Zobs
i1;t0 :t )

Yij,t (Zobs
i2;t0 :t )

Yij,t (Zobs
i1;t0 :t )

Yij,t (Zobs
i2;t0 :t )

11

Zobs
11;t0 :t

∗
CD(Zobs
11;t0 :t ; zt0 :t , W)

obs
Y11,t

?

obs
Y11,t

Impute according
to scheme (10)

12

Zobs
12;t0 :t

∗
CD(Zobs
12;t0 :t ; zt0 :t , W)

?

obs
Y12,t

..
.

..
.

..
.

..
.

..
.

Impute according
to scheme (11)
..
.

I1

Zobs
I1;t0 :t

∗
CD(Zobs
I1;t0 :t ; zt0 :t , W)

obs
YI1,t

?

obs
YI1,t

I2

Zobs
I2;t0 :t

∗
CD(Zobs
I2;t0 :t ; zt0 :t , W)

?

obs
YI2,t

Impute according
to scheme (11)

4.5

obs
Y12,t

..
.
Impute according
to scheme (10)

..
.

obs
YI2,t

Time lag and lag-incorporating weights

One unique aspect of our application is that there is typically a time lag between social distancing
and its effect on public-health-related outcomes. We formalize this in Assumption 2.
Assumption 2 (Time Lag). The treatment trajectory is said to have a “`-lagged effect” on unit
n’s potential outcomes at time t if
0
Yn,t (zt0 , zt1 , · · · , zt−` , zt−`+1 , · · · , zt ) = Yn,t (zt0 , zt1 , · · · , zt−` , zt−`+1
, · · · , zt0 ),

0
for all zt0 , · · · , zt−` , zt−`+1 , · · · , zt , and zt−`+1
, · · · , zt0 .

In words, Assumption 2 says that the outcome of interest at time t depends on the entire
treatment dose trajectory only through up to time t − `. Assumption 2 holds in particular when
Yn,t measures the number of people succumbing to the COVID-19 at time t. Researchers estimated
that the time lag between contracting COVID-19 and exhibiting symptoms (i.e., the so-called
incubation period) had a median of 5.1 days and could be as long as 11.5 days (Lauer et al., 2020),
and the time lag between the onset of the COVID-19 symptoms and death ranged from 2 to 8
weeks (Testa et al., 2020; World Health Organization, 2020). Therefore, it may be reasonable to
believe that the number of COVID-19 related deaths at time t does not depend on social distancing
practices ` days immediately preceding t for some properly chosen `. Assumption 2 may be further
combined with Assumption 1 to state that unit n’s potential outcomes at time t depend on the entire
treatment dose trajectory zt0 :t only via some cumulative dose from time t0 to t − ` by defining the
cumulative dose with respect to some lag-incorporating weight function Wlag that assigns 0 weights
20

to ` treatment doses immediately preceding time t.
Remark 8. Suppose that the time lag assumption holds for potential outcomes Yn,t (·), · · · ,
Yn,t+`−1 (·), and let g : Rl 7→ R be a function that maps these ` potential outcomes to an aggregate outcome g{Yn,t (·), · · · , Yn,t+`−1 (·)}. One immediate consequence of Assumption 2 is that
g{Yn,t (·), · · · , Yn,t+`−1 (·)} depends on the entire treatment dose trajectory Zt0 :t+`−1 only via Zt0 :t−1 ;
moreover, we may invoke Assumption 1 and further state that g{Yn,t (·), · · · , Yn,t+`−1 (·)} depends
on the entire treatment dose trajectory Zt0 :t+`−1 only via some cumulative dose of Zt0 :t−1 . Doseresponse relationships, statistical matching, and testing procedures described in Section 4.3 and
4.4 then hold by replacing Yn,t (·) with the aggregate outcome g{Yn,t (·), · · · , Yn,t+`−1 (·)} where
appropriate. Details are provided in Supplementary Material F.

5
5.1

Social distancing and COVID-19 during phased reopening: study design
Goal and connection to infectious disease modeling

Epidemiologists and infectious disease experts routinely leverage mathematical models, e.g., the SIR
(Susceptible-Infected-Recovered) model and its numerous variants, to understand disease transmission dynamics (Brauer et al., 2012; Daley and Gani, 2001). One simple variant is the following
SIRD (Susceptible-Infected-Recovered-Dead) model (Canabarro et al., 2020):
dS
SI
= −κ ;
dt
N

dI
SI
=κ
− αI − γI;
dt
N

dR
= αI;
dt

dD
= γI,
dt

(12)

where N represents the total number of people, S(t), I(t), R(t), and D(t) cumulative number of
people susceptible, infected, recovered, and succumbed to the disease at time t, respectively, and
κ, α, and γ the rate at which a susceptible person gets infected (transmission rate), an infected
person recovers, and an infected person dies, respectively.
Specialize Model (12) to a county n. A fixed set of parameters (κn , αn , γn ) would then correspond to one trajectory of the number of cumulative deaths Dn (t). In reality, the level of daily
social distancing is likely to affect the transmission rate κn , e.g., a larger reduction in total distance
traveled at time t may correspond to a smaller κn at time t, so that κn is time-varying and denoted
as κn (t). In this way, different social distancing trajectories zn;t0 :t correspond to possibly different
time-varying transmission rate functions κn (t), which then induce different outcome trajectories.
The causal question we have been asking, i.e., the effect of the social distancing on public-health-

21

related outcomes, can then be understood as how the daily social distancing trajectory affects the
public-health-related outcomes via altering aspects of the disease transmission dynamics.
Disease transmission dynamics and the interplay between social distancing and various aspects
of the dynamics are much more complicated in reality. The primary goal of this case study is to grasp
a high-level understanding of the causal relationship between social distancing level and publichealth-related outcomes via testing structured dose-response relationships. Understanding a highlevel causal effect, i.e., a dose-response relationship in this context, can be a useful first step toward
understanding the causal mechanism. As elaborated in previous sections, our randomization-based
testing procedure does not require modeling the often highly complicated disease transmission
mechanism or the potential public-health-related outcomes.
5.2

Evaluating Assumption 1

In the disease transmission context, Assumption 1 states that social distancing trajectories with
the same, properly defined cumulative dose would correspond to similar transmission mechanism,
e.g., transmission rate function κ(t) in Model (12), and similar transmission mechanisms from t0
to T would then correspond to roughly the same public-health-related outcome at time T , e.g., the
COVID-19 related deaths per 100, 000 people at time T . In this section, we evaluate this assumption
by assessing the relationship between the disease transmission mechanism and potential outcomes
under the canonical epidemiological model (12).
The left panel of Figure 4 plots three sampled κ(t) curves from each of the four W-equivalence
classes with respect to a weight function W(t) proportional to the density of an exponential distribution of rate 5 (hence more weight on the initial transmission rate) and a reference trajectory that
is 0 everywhere, using the xsample function (Van den Meersche et al., 2009) in the limSolve package
in the R programming language (R Core Team, 2013). In other words, κ(t) curves of the same color
have the same weighted L1 -norm with respect to W(t) (red = 0.122, black = 0.367, blue = 0.612,
green = 0.734). The right panel of Figure 4 plots the cumulative death curve D(t) corresponding
to each κ(t) under the SIRD Model (12) with N = 100, 000, γ = 0.002 and α = 0.085. The choice
of γ and α are made in reference to Canabarro et al. (2020) and calibrated so that the number of
deaths per 100, 000 people after 60 days is somewhere between 20 and 60. To put these numbers
into context, the total number of deaths due to COVID-19 in the U.S. from May 1st to July 1st is
approximately 70, 000, corresponding to 21.2 per 100, 000 people. Figure 4 seems to suggest that
the transmission rate curves κ(t) with the same cumulative dose from t = 0 to t = 60 lead to
22

relatively similar death toll trajectory D(t) and hence similar COVID-19 related deaths at time
t = 60, i.e., D(60) − D(59). In this regard, Assumption 1 seems at least a reasonable approximation
in the case study.

0.100

60

0.075

D(t)

κ(t)

40

0.050

20
0.025

0.000

0
0

20

40

60

0

Day

20

40

60

Day

Figure 4: Left panel: simulated transmission rate function κ(t). Curves of the same color have the same
cumulative dose with respect to a weight function W(t) proportional to the density of an exponential distribution of rate 5 and a reference trajectory that is 0 everywhere. Right panel: cumulative number of death
D(t) corresponding to each transmission rate function κ(t) under SIRD Model (12).

5.3

Data: time frame, granularity, cumulative dose, outcome, and covariate history

The first state in the U.S. that reopened was Georgia at April 24th. We hence consider data from
April 27th, the first Monday following April 24th, to August 2nd, the first Sunday in August in the
primary analysis. We choose a Monday (April 27th) as the baseline period and a Sunday (August
2rd) as the endpoint because social distancing and public-health-related outcomes data exhibited
consistent weekly periodicity (Unnikrishnan, 2020).
We analyze the data at a county-level granularity. Literature on causal inference typically makes
the “no interference” assumption at a certain data granularity, e.g., at the dorm level (Sacerdote,
2001; Li et al., 2019) or the school level (Hong and Raudenbush, 2006), where interference among
units in the same dorm or school is allowed, but among units from different dorms or schools is
not. In the case study, our county-level analysis allows interference among individual residents in
each county, but not interference among different counties.
We use the county-level percentage change in the total distance traveled compiled by Unacast™
as the continuous, time-varying treatment dose. We consider a two-month treatment period from
April 27th (Monday) to June 28th (Sunday). The primary outcome of interest is the cumulative
COVID-19 related death toll per 100, 000 people from June 29th (Monday) to August 2nd (Sunday),
23

a total of five weeks. The county-level COVID-19 case number and death toll are both obtained
from the New York Times COVID-19 data repository (The New York Times, 2020).
As discussed in Section 4.4, we match counties similar on covariates, including time-independent
covariates and time-dependent covariate processes, in order to embed data into an approximate
randomized experiment. Specifically, we matched on the following time-independent baseline covariates: female (%), black (%), Hispanic (%), above 65 (%), smoking (%), driving alone to work
(%), flu vaccination (%), some college (%), number of membership associations per 10, 000 people, rural (0/1), poverty rate (%), population, and population density (residents per square mile).
These county-level covariates data were derived from the census data collected by the United States
Census Bureau and the County Health Rankings and Roadmaps Program (Remington et al., 2015).
Moreover, we matched on the number of new COVID-19 cases and new COVID-19 related deaths
per 100, 000 people every week from April 20th - 26th to June 23th - 29th.
5.4

Statistical matching, matched samples, and assessing balance

A total of 1, 211 matched pairs of two counties were formed using optimal nonbipartite matching
(Lu et al., 2001, 2011). We matched exactly on the covariate “rural (0/1)” for later subgroup
analysis and balanced all other 32 covariates. We added a mild penalty on the cumulative dose so
that two counties within the same matched pair had a tangible difference in their cumulative doses,
and added 20% sinks to eliminate 20% of counties for whom no good match can be found (Baiocchi
et al., 2010; Lu et al., 2011). Following the advice in Rubin (2007), the design was conducted
without any access to the outcome data in order to assure the objectivity of the design.
Within each matched pair, the county with smaller cumulative dose is referred to as the “better
social distancing” county, and the other “worse social distancing” county. Appendix A.1 shows
where the 1, 211 better social distancing counties and the other 1, 211 worse social distancing
counties are located in the U.S., and Figure 5 plots the average daily percentage change in total
distance traveled and the average daily COVID-19 related death toll per 100, 000 people during the
treatment period (April 27th to June 28th) in two groups. It is evident that two groups differ in
their extent of social distancing, but are very similar in their daily COVID-19 related death toll
per 100, 000 people during the treatment period. Finally, Appendix A.2 summarizes the balance
of all 33 covariates in two groups after matching. All variables have standardized differences less
than 0.15 and are considered sufficiently balanced (Rosenbaum, 2002). In Supplementary Material
G.1, we further plot the cumulative distribution functions of important variables in two groups. A
24

detailed pre-analysis plan, including matched samples and specification of a primary analysis and

Better social distancing

Worse social distancing

0.2

0.1

7.5

0.0
5.0
−0.1

−0.2
2.5
−0.3

−0.4

0.0
04/27

05/04

05/11

05/18

05/25

06/01

06/08

06/15

06/22

Average Daily Deaths per 100,000 People

Average Percentage Change in Distance Traveled

three secondary analyses, can be found via DOI:10.13140/RG.2.2.23724.28800.

06/29

date

Figure 5: Trajectories of the average daily percentage change in total distance traveled (dashed lines) and
average daily COVID-19 related death toll per 100,000 people (solid lines) in 1, 211 better social distancing
counties (dark green) and 1, 211 worse social distancing counties (dark red). We saw a sharp contrast in the
level of social distancing but little difference in the COVID-19 related death during this treatment period.

6
6.1

Social distancing and COVID-19 during phased reopening: outcome analysis
Primary analysis: causal null hypothesis regarding the death toll

Fix t0 = April 27th and T = June 28th. Let Zt0 :T = zt0 :T denote treatment dose trajectory, z∗t0 :T
a reference trajectory equal to the −0.50 for all t0 ≤ t ≤ T (corresponding to 50% reduction in
total distance traveled from April 27th to June 28th), Wlag a weight function that assigns equal
weight to all t such that t0 ≤ t ≤ T and 0 otherwise, and a cumulative dose CD(zt0 :T ; z∗t0 :T , Wlag )
defined with respect to zt∗0 :T and Wlag . Finally, let Yt (·) denote the potential COVID-19 related
deaths at time t, ` = 35 so that T + ` corresponds to August 2nd, and invoke Assumption 2 on Yt (·)
for all t between T + 1 and T + `. As discussed in Remark 8, we consider the aggregate outcome
P
Yagg (·) = g{YT +1 (·), · · · , YT +` (·)} = T +1≤t≤T +` Yt (·). We further invoke Assumption 1 so that
25

Yagg (·) depends on Zt0 :T = zt0 :T only via CD(zt0 :T ; z∗t0 :T , Wlag ).
Our primary analysis tests the following causal null hypothesis for the 1, 211×2 = 2, 422 counties
in our matched samples:
H0,primary : Yij,agg (zt0 :T ) − Yij,agg (z∗t0 :T ) = 0, ∀zt0 :T , ∀i = 1, · · · , I = 1211, j = 1, 2.

(13)

This null hypothesis states that the treatment dose trajectory from April 27th to June 28th had
no effect whatsoever on the COVID-19 related death toll from June 29th to August 2nd.
The top left panel of Figure 6 plots Fbmin (CDF of the better social distancing counties’ obtr (CDF of the worse social distancing counties’ observed outcomes under
served outcomes) and Fbmax

H0,primary ); we calculate the test statistic tKS = 0.735 and contrast it to a reference distribution
generated using 1, 000, 000 samples from all possible 21211 randomizations; see the top right panel
of Figure 6. In this way, an exact p-value equal to 2.06 × 10−4 is obtained and the causal null
hypothesis H0,primary is rejected at 0.05 level. We further conducted a sensitivity analysis to assess
the no unmeasured confounding assumption we made in the primary analysis. In a sensitivity
analysis, we allowed the dose trajectory assignment probability πi1 and πi2 as in (9) to be biased
from the randomization probability and then generated the reference distribution with this biased
randomization probability; specifically, we considered a biased treatment assignment model where
log(Γi ) = log{πi1 /πi2 } in each matched pair i was proportional to the absolute difference in the
cumulative doses of two units in the pair (πi1 = πi2 = 1/2 and Γi = 1 in a randomized experiment
for all i). We found that our primary analysis conclusion would hold up to Γi having a median as
large as 3.82. See Supplementary Material G.3 for details.
6.2

Secondary analysis I: secondary outcome

Let Yij,case,agg denote the cumulative COVID-19 cases per 100, 000 people from June 29th to July
12th, as specified in our pre-analysis plan. We test the following null hypothesis concerning the
secondary outcome Yij,case,agg :
H0,secondary : Yij,case,agg (zt0 :T ) − Yij,case,agg (z∗t0 :T ) = 0, ∀zt0 :T , ∀i = 1, · · · , I = 1211, j = 1, 2. (14)
The exact p-value is less than 10−5 ; see the bottom panels of Figure 6. Our result suggests strong
evidence that social distancing from April 27th to June 28th had an effect on cumulative COVID-19
cases per 100, 000 people from June 29th to July 12th in our matched samples.
26

50

1.00

40
0.75

density

30
0.50

20

0.25

p−value
< 0.001

10
Better social distancing
Worse social distancing

0.00
0

20

40

0
60

0.000

0.025

Deaths per 100,000 people

0.050

0.075

test statistic

1.00

50

40

density

0.75

0.50

30

20
0.25
10
Better social distancing
Worse social distancing

0.00
0

50

100

150

0
200

0.00

Cases per 100,000 people

0.03

0.06

0.09

test statistic

Figure 6: Top left panel: CDFs of cumulative COVID-19 related deaths per 100, 000 people in the better
social distancing (green) and worse social distancing (red) groups. Top right panel: randomization-based
reference distribution. The exact p-value is 2.06 × 10−4 . Bottom left panel: CDFs of cumulative COVID-19
cases per 100, 000 people in the better social distancing (green) and worse social distancing (red) groups.
Bottom right panel: randomization-based reference distribution. The exact p-value is less than 10−5 .

6.3

Secondary analysis II: explore dose-response relationship

We consider testing the dose-response kink model concerning the aggregate case number Yij,case,agg :
H0,kink : Yij,case,agg (zt0 :T ) − Yij,case,agg (z∗t0 :T ) = 0, ∀zt0 :T such that CD(zt0 :T ; z∗t0 :T , Wlag ) ≤ τ,
and log{Yij,case,agg (zt0 :T )} − log{Yij,case,agg (z∗t0 :T )} = β · {CD(zt0 :T ; z∗t0 :T , Wlag ) − τ },
∀zt0 :T such that CD(zt0 :T ; z∗t0 :T , Wlag ) > τ, ∀i = 1, · · · , I = 1211, j = 1, 2.
(15)
This dose-response relationship states that the potential COVID-19 cases from June 29th to July
12th remains the same as the potential outcome under Zt0 :T = z∗t0 :T , i.e., strict social distancing
that reduces total distance traveled by 50% everyday from April 27th to June 28th, when the

27

cumulative dose (defined w.r.t. z∗t0 :T and Wlag ) is less than a threshold τ ; after the cumulative dose
exceeds this threshold, the COVID-19 case number increases exponentially at a rate proportional
to how much the cumulative dose exceeds the threshold.

Case number per 100,000 people

50

40

β0

30
0.05

20

0.005

10
0.1

40

30

20

10

0

0
0.3

0.4

τ0

0.5

−0.4

0.6

−0.2

0.0

0.2

Percentage change in total distance traveled

Figure 7: Left panel: contour plot of p-values when testing H0,kink as in (15) against τ = τ0 and β = β0 .
Maximum p-value is obtained at (τ0 , β0 ) = (4.8, 10.0) (red marker). Three isopleths (0.1, 0.05, and 0.005)
are plotted. Right panel: dose-response relationships for selected (τ0 , β0 ) in the 0.1 confidence set with
baseline Yij,case,agg (z∗t0 :T ) equal to 1 per 100, 000. The red line corresponds to (τ0 , β0 ) = (0.46, 5.0), blue line
(τ0 , β0 ) = (0.48, 10.0), and green line (τ0 , β0 ) = (0.50, 12.0).

We tested (15) for different τ = τ0 and β = β0 combinations; the maximum p-value obtained at
(τ0 , β0 ) = (4.8, 10.0) is equal to 0.417 and hence the kink model (15) cannot be rejected. The left
panel of Figure 7 plots the level-0.1 and level-0.05 confidence sets of (τ, β). We see the confidence
set of τ is tightly centered around 0.5, suggesting that as a county’s average percentage change
in total distance traveled from April 27th to June 28th increases from −50% to around −5% to
5%, the potential COVID-19 cases number from June 29th to July 12th would remain unchanged;
once beyond this threshold, the case number rises exponentially. To further illustrate this doseresponse relationship, the right panel of Figure 7 plots dose-response curves with baseline (i.e.,
50% reduction) case number equal to 1 per 100, 000 people for three selected (τ0 , β0 ) pairs in the
level-0.1 confidence set.
6.4

Secondary analysis III: subgroup analysis and differential dose-response relationship

We also conducted subgroup analyses by repeating the primary and secondary analyses described
in Section 6.1 to 6.3 on 462 matched pairs of 2 non-rural counties and 749 matched pairs of 2 rural
counties. P-values when testing the primary analysis hypothesis H0,primary concerning the death
toll and secondary analysis hypothesis H0,secondary concerning the case number are 0.004 and less

28

than 10−5 , respectively, in the non-rural subgroup, and 0.008 and 0.009, respectively, in the rural
subgroup. We also allowed a differential dose-response relationship between social distancing and
case numbers in rural and non-rural counties and constructed confidence sets for (τ, β) separately;
see Figure 8. A comparison of confidence sets for the non-rural counties and rural counties seemed
to suggest that the activation dose required to trigger an exponential increase in case numbers in

Case numbers per 100,000 people

rural counties might be larger than that in non-rural counties.

50

40

β0

30

20

10
0.005
0.1

0.1

0.05

0
0.2

τ0

−0.4

40

β0

30

20

0.005

0.1
0.05

0
0.0

0.2

0.4

τ0

0
−0.2

0.0

0.2

Percentage change in total distance traveled

50

10

50

0.4

Case numbers per 100,000 people

0.0

100

0.6

60

40

20

0
−0.4

0.8

−0.2

0.0

0.2

Percentage change in total distance traveled

Figure 8: Top left panel: contour plot of p-values when testing H0,kink against τ = τ0 and β = β0 in
462 matched pairs of 2 non-rural counties. Three isopleths (0.1, 0.05, and 0.005) are plotted. Top right
panel: dose-response relationships for selected (τ0 , β0 ) in the 0.1 confidence set as in the top left panel with
baseline Yij,case,agg (z∗t0 :T ) equal to 1 per 100, 000. The red line corresponds to (τ0 , β0 ) = (0.10, 3.0), blue
line (τ0 , β0 ) = (0.38, 8.0), and green line (τ0 , β0 ) = (0.41, 12.0). Bottom left panel: contour plot of p-values
when testing H0,kink against τ = τ0 and β = β0 in 749 matched pairs of rural counties. Three isopleths (0.1,
0.05, and 0.005) are plotted. Bottom right panel: dose-response relationships for selected (τ0 , β0 ) in the 0.1
confidence set as in the bottom left panel with baseline Yij,case,agg (z∗t0 :T ) equal to 1 per 100, 000. The red line
corresponds to (τ0 , β0 ) = (0.5, 10.0), blue line (τ0 , β0 ) = (0.55, 15.0), and green line (τ0 , β0 ) = (0.60, 20.0).

29

7

Discussion

We studied in detail the effect of social distancing during the early phased reopening in the United
States on COVID-19 related death toll and case numbers using our compiled county-level data.
To address the statistical challenge brought by a time-dependent, continuous treatment dose trajectory, we developed a design-based framework based on nonbipartite matching to embed observational data with time-dependent, continuous treatment dose trajectory into a randomized
controlled experiment. This embedding induces a randomization scheme that we then used to conduct randomization-based, model-free statistical inference for causal relationships, including testing
a causal null hypothesis and a structured dose-response relationship.
Upon applying the proposed design and testing procedures to the social distancing and COVID19 data, we found very strong evidence against the causal null hypothesis and supporting a causal
effect of social distancing during the early phases of reopening on both the COVID-19 related death
toll and case numbers. We then tested a dose-response kink model featuring both an “activation
dose threshold” such that there was no treatment effect when the social distancing level was below
this threshold and a “slope” that allowed an exponential growth when the social distancing level
exceeded the threshold. This dose-response kink model could not be rejected; in fact, the confidence
set around the activation dose threshold was tight and its magnitude suggested that once the
total distance traveled returned to or even superseded the pre-coronavirus level, it would have
a devastating effect on the COVID-19 case numbers by contributing to an exponential growth.
Finally, in a subgroup analysis where we allowed a differential dose-response relationship and tested
the dose-response kink model separately in the non-rural and rural counties, we found that in order
to avoid an exponential increase in COVID-19 case numbers, more stringent social distancing would
be needed for non-rural counties compared to rural counties.

Supplementary Materials
Supplementary Material A provides details on the pilot study described in Section 1.1 in the
main article. Supplementary Material B motivates the Kolmogorov-Smirnov-type test statistic
considered in the main article. Supplementary Material C discusses how to construct a confidence
set for nuisance parameters (τ, β) in a dose-response kink model based on a variant of rank sum
test. Supplementary Material D illustrates how to test a sequence of dose-response relationship
ordered according to their model complexity. Supplementary Material E derives the treatment dose
trajectory assignment probability in each matched pair. Supplementary Material F provides details
30

on generalizing the dose-response relationship to an aggregate outcome. Supplementary Material
G provides further details on the case study, including a closer examination of the distributions of
some important variables after matching, separate analyses of rural and non-rural counties, and a
sensitivity analysis of the primary analysis.

Appendix
A.1: Maps of 1, 211 better and 1, 211 worse social distancing counties

1,211 Better Social Distancing Counties

1,211 Worse Social Distancing Counties

31

A.2: Balance table summarizing 33 covariates after statistical matching
Better Social
Distancing Counties
(n = 1,211)

Worse Social
Distancing Counties
(n = 1,211)

Standardized
Difference

0.50
0.20
0.07
0.09
0.80
0.17
0.42
0.59
12.29
0.62
0.14
173
92,310

0.50
0.19
0.07
0.08
0.81
0.18
0.42
0.58
12.01
0.62
0.15
130
79,423

0.06
-0.05
0.00
-0.03
0.12
0.15
-0.01
-0.09
-0.05
0.00
0.14
-0.08
-0.06

27.97
29.74
29.17
26.21
29.13
30.95
29.75
28.40
34.02
45.51
1.35
1.20
1.35
1.00
0.95
1.06
0.85
0.67
0.62
0.85

25.30
24.23
25.25
25.49
28.70
25.62
28.78
31.31
40.97
51.94
0.92
0.95
1.00
0.98
0.91
0.84
0.70
0.66
0.64
0.68

-0.02
-0.08
-0.05
-0.01
-0.01
-0.07
-0.01
0.04
0.09
0.09
-0.12
-0.08
-0.09
-0.01
-0.01
-0.07
-0.06
-0.00
0.01
-0.05

Time-Independent Covariates
female (fr)
above 65 (fr)
black (fr)
hispanic (fr)
driving alone to work (fr)
smoking (fr)
flu vaccination (fr)
some college (fr)
membership association (per 10,000 people)
rural (0/1)
below poverty (fr)
population density (residents per mi2 )
population
Time-Varying Covariates (per 100,000 people)
Cases during Apr 20th - Apr 26th
Cases during Apr 27th - May 3rd
Cases during May 4th - May 10th
Cases during May 11th - May 17th
Cases during May 18th - May 24th
Cases during May 25th - June 1st
Cases during June 2rd - June 8th
Cases during June 9th - June 15th
Cases during June 16th - June 22th
Cases during June 23th - June 29th
Deaths during Apr 20th - Apr 26th
Deaths during Apr 27th - May 3rd
Deaths during May 4th - May 10th
Deaths during May 11th - May 17th
Deaths during May 18th - May 24th
Deaths during May 25th - June 1st
Deaths during June 2rd - June 8th
Deaths during June 9th - June 15th
Deaths during June 16th - June 22th
Deaths during June 23th - June 29th

References
Acemoglu, D., Chernozhukov, V., Werning, I., and Whinston, M. D. (2020). Amulti-risk SIR model
with optimally targeted lockdown. Technical report, National Bureau of Economic Research.
Atalan, A. (2020). Is the lockdown important to prevent the COVID-19 pandemic? Effects on
psychology, environment and economy-perspective. Annals of Medicine and Surgery, 56:38–42.
Baiocchi, M., Small, D. S., Lorch, S., and Rosenbaum, P. R. (2010). Building a stronger instrument
32

in an observational study of perinatal care for premature infants. Journal of the American
Statistical Association, 105(492):1285–1296.
BBC Radio 4 (2020). Best of today. https://www.bbc.co.uk/programmes/p08jn7g4.
Berger, R. L. and Boos, D. D. (1994). P values maximized over a confidence set for the nuisance
parameter. Journal of the American Statistical Association, 89(427):1012–1016.
Bind, M.-A. C. and Rubin, D. B. (2019). Bridging observational studies and randomized experiments by embedding the former in the latter. Statistical Methods in Medical Research, 28(7):1958–
1978.
Bojinov, I. and Shephard, N. (2019). Time series experiments and causal estimands: exact randomization tests and trading. Journal of the American Statistical Association, 114(528):1665–1682.
Brauer, F., Castillo-Chavez, C., and Castillo-Chavez, C. (2012). Mathematical Models in Population
Biology and Epidemiology, volume 2. Springer.
Canabarro, A., Tenorio, E., Martins, R., Martins, L., Brito, S., and Chaves, R. (2020). Data-driven
study of the covid-19 pandemic via age-structured modelling and prediction of the health system
failure in brazil amid diverse intervention strategies. PLOS ONE, 15:1–13.
Daley, D. J. and Gani, J. (2001). Epidemic Modelling: An Introduction, volume 15. Cambridge
University Press.
Ding, P., Feller, A., and Miratrix, L. (2016). Randomization inference for treatment effect variation.
Journal of the Royal Statistical Society: Series B (Statistical Methodology), 78(3):655–671.
Dwass, M. (1957). Modified randomization tests for nonparametric hypotheses. The Annals of
Mathematical Statistics, pages 181–187.
Fisher, R. A. (1935). The Design of Experiments. Oliver and Boyd. London and Edinburgh.
Grover, S., Sahoo, S., Mehra, A., Avasthi, A., Tripathi, A., Subramanyan, A., Pattojoshi, A., Rao,
G. P., Saha, G., Mishra, K., et al. (2020). Psychological impact of covid-19 lockdown: An online
survey from india. Indian Journal of Psychiatry, 62(4):354.
Hansen, B. B. (2007). Optmatch: Flexible, optimal matching for observational studies. R News,
7(2):18–24.
33

Heng, S., Zhang, B., Han, X., Lorch, S. A., and Small, D. S. (2019). Instrumental variables: to
strengthen or not to strengthen? arXiv preprint arXiv:1911.09171.
Ho, D. E., Imai, K., King, G., and Stuart, E. A. (2007). Matching as nonparametric preprocessing
for reducing model dependence in parametric causal inference. Political Analysis, 15(3):199–236.
Holland, P. W. (1986). Statistics and causal inference. Journal of the American Statistical Association, 81(396):945–960.
Hong, G. and Raudenbush, S. W. (2006). Evaluating kindergarten retention policy: A case study of
causal inference for multilevel observational data. Journal of the American Statistical Association,
101(475):901–910.
Imai, K., Kim, I. S., and Wang, E. (2018). Matching methods for causal inference with time-series
cross-section data. https://imai.fas.harvard.edu/research/files/tscs.pdf.
Lau, H., Khosrawipour, V., Kocbach, P., Mikolajczyk, A., Schubert, J., Bania, J., and Khosrawipour, T. (2020). The positive impact of lockdown in Wuhan on containing the COVID-19
outbreak in China. Journal of Travel Medicine, 27(3):taaa037.
Lauer, S. A., Grantz, K. H., Bi, Q., Jones, F. K., Zheng, Q., Meredith, H. R., Azman, A. S., Reich,
N. G., and Lessler, J. (2020). The incubation period of coronavirus disease 2019 (COVID-19)
from publicly reported confirmed cases: estimation and application. Annals of Internal Medicine,
172(9):577–582.
Lewnard, J. A. and Lo, N. C. (2020). Scientific and ethical basis for social-distancing interventions
against COVID-19. The Lancet. Infectious diseases, 20(6):631.
Li, X., Ding, P., Lin, Q., Yang, D., and Liu, J. S. (2019). Randomization inference for peer effects.
Journal of the American Statistical Association, 114(528):1651–1664.
Li, Y. P., Propert, K. J., and Rosenbaum, P. R. (2001). Balanced risk set matching. Journal of the
American Statistical Association, 96(455):870–882.
Lu, B., Greevy, R., Xu, X., and Beck, C. (2011). Optimal nonbipartite matching and its statistical
applications. The American Statistician, 65(1):21–30.

34

Lu, B., Zanutto, E., Hornik, R., and Rosenbaum, P. R. (2001). Matching with doses in an observational study of a media campaign against drug abuse. Journal of the American Statistical
Association, 96(456):1245–1253.
Mattei, A., Ricciardi, F., and Mealli, F. (2019). Bayesian inference for sequential treatments under
latent sequential ignorability. Journal of the American Statistical Association.
Nolen, T. L. and Hudgens, M. G. (2011). Randomization-based inference within principal strata.
Journal of the American Statistical Association, 106(494):581–593.
Pagano, M. and Tritchler, D. (1983). On obtaining permutation distributions in polynomial time.
Journal of the American Statistical Association, 78(382):435–440.
R Core Team (2013). R: A Language and Environment for Statistical Computing. R Foundation
for Statistical Computing, Vienna, Austria.
Remington, P. L., Catlin, B. B., and Gennuso, K. P. (2015). The county health rankings: rationale
and methods. Population Health Metrics, 13(1):11.
Robins, J. (1986). A new approach to causal inference in mortality studies with a sustained exposure
period—application to control of the healthy worker survivor effect. Mathematical Modelling, 7(912):1393–1512.
Robins, J., Hernán, M. A., and Babette, B. (2000). Marginal structural models and causal inference
in epidemiology. Epidemiology, 11(5):550–560.
Robins, J. M. (1994). Correcting for non-compliance in randomized trials using structural nested
mean models. Communications in Statistics - Theory and Methods, 23(8):2379–2412.
Robins, J. M. (1998). Marginal structural models. In: 1997 Proceedings of the Section on Bayesian
Statistical Science, Alexandria, VA: American Statistical Association, 1998;1-10.
Robins, J. M., Greenland, S., and Hu, F.-C. (1999). Estimation of the causal effect of a timevarying exposure on the marginal mean of a repeated binary outcome. Journal of the American
Statistical Association, 94(447):687–700.
Rosenbaum, P. R. (1989). Sensitivity analysis for matched observational studies with many ordered
treatments. Scandinavian Journal of Statistics, pages 227–236.

35

Rosenbaum, P. R. (2002). Observational Studies. Springer.
Rosenbaum, P. R. (2005). Heterogeneity and causality: Unit heterogeneity and design sensitivity
in observational studies. The American Statistician, 59(2):147–152.
Rosenbaum, P. R. (2010). Design of Observational Studies. Springer.
Rubin, D. B. (1980). Randomization analysis of experimental data: The fisher randomization test
comment. Journal of the American Statistical Association, 75(371):591–593.
Rubin, D. B. (1986). Statistics and causal inference: Comment: Which ifs have causal answers.
Journal of the American Statistical Association, 81(396):961–962.
Rubin, D. B. (2005). Causal inference using potential outcomes: Design, modeling, decisions.
Journal of the American Statistical Association, 100(469):322–331.
Rubin, D. B. (2007). The design versus the analysis of observational studies for causal effects:
parallels with the design of randomized trials. Statistics in Medicine, 26(1):20–36.
Sacerdote, B. (2001). Peer effects with random assignment: Results for dartmouth roommates.
The Quarterly Journal of Economics, 116(2):681–704.
Sheridan, A., Andersen, A. L., Hansen, E. T., and Johannesen, N. (2020). Social distancing
laws cause only small losses of economic activity during the covid-19 pandemic in scandinavia.
Proceedings of the National Academy of Sciences, 117(34):20468–20473.
Sjödin, H., Wilder-Smith, A., Osman, S., Farooq, Z., and Rocklöv, J. (2020). Only strict quarantine
measures can curb the coronavirus disease (covid-19) outbreak in italy, 2020. Eurosurveillance,
25(13):2000280.
Stuart, E. A. (2010). Matching methods for causal inference: A review and a look forward. Statistical Science, 25(1):1–21.
Testa, C. C., Krieger, N., Chen, J. T., and Hanage, W. P. (2020). Visualizing the lagged connection
between COVID-19 cases and deaths in the United States: An animation using per capita statelevel data (January 22, 2020 – July 8, 2020). Technical report, The Harvard Center for Population
and Development Studies, Munich.

36

The New York Times (2020). Coronavirus (Covid-19) Data in the United States. https://github.
com/nytimes/covid-19-data. Accessed: 2020-09-30.
Unnikrishnan, C. (2020). Globally coherent weekly periodicity in the covid-19 pandemic. medRxiv.
Van den Meersche, K., Soetaert, K., and Van Oevelen, D. (2009). xsample (): an r function for
sampling linear inverse problems. Journal of Statistical Software, 30(1).
Venkatesh, A. and Edirappuli, S. (2020). Social distancing in covid-19: what are the mental health
implications? BMJ, 369.
World Health Organization (2020). Report of the WHO-China joint mission on coronavirus disease
2019 (COVID-19).
Zhang, B., Heng, S., MacKay, E. J., and Ye, T. (2020). Bridging preference-based instrumental variable studies and cluster-randomized encouragement experiments: study design, noncompliance,
and average cluster effect ratio. arXiv preprint arXiv:2007.06772.
Zhang, H. and Singer, B. H. (2010). Recursive Partitioning and Applications. Springer Science &
Business Media.
Zubizarreta, J. R., Paredes, R. D., Rosenbaum, P. R., et al. (2014). Matching for balance, pairing
for heterogeneity in an observational study of the effectiveness of for-profit and not-for-profit
high schools in chile. The Annals of Applied Statistics, 8(1):204–231.

37

