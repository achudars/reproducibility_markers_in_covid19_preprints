The shapes of an epidemic: using Functional Data
Analysis to characterize COVID-19 in Italy
Tobia Boschi1 , Jacopo Di Iorio2 , Lorenzo Testa2 , Marzia A. Cremona1,3,4,* , and Francesca
Chiaromonte1,2,*
1 Penn

State University, Dept. of Statistics and Huck Institutes of the Life Sciences, University Park, PA 16802, USA
School of Advanced Studies, Institute of Economics and EMbeDS, Pisa, 56127, Italy
3 Université Laval, Dept. of Operations and Decision Systems, Québec, G1V 0A6, Canada
4 CHU de Québec – Université Laval Research Center, Québec, G1V 4G2, Canada
* co-corresponding authors; marzia.cremona@fsa.ulaval.ca, fxc11@psu.edu

arXiv:2008.04700v1 [stat.AP] 11 Aug 2020

2 Sant’Anna

ABSTRACT
We investigate patterns of COVID-19 mortality across 20 Italian regions and their association with mobility, positivity, and
socio-demographic, infrastructural and environmental covariates. Notwithstanding limitations in accuracy and resolution of the
data available from public sources, we pinpoint significant trends exploiting information in curves and shapes with Functional
Data Analysis techniques. These depict two starkly different epidemics; an "exponential" one unfolding in Lombardia and the
worst hit areas of the north, and a milder, "flat(tened)" one in the rest of the country – including Veneto, where cases appeared
concurrently with Lombardia but aggressive testing was implemented early on. We find that mobility and positivity can predict
COVID-19 mortality, also when controlling for relevant covariates. Among the latter, primary care appears to mitigate mortality,
and contacts in hospitals, schools and work places to aggravate it. The techniques we describe could capture additional and
potentially sharper signals if applied to richer data.

Introduction
At the end of January 2020, two Chinese tourists were hospitalized in Rome and tested positive to SARS-CoV-2. At the
beginning of February, a group of Italian citizens was repatriated from Wuhan — among them, one tested positive. As the news
media reported these headlines, neither the Italian public nor the Italian authorities appeared to perceive an imminent threat,
though retrospective analyses now suggest that the virus may have been circulating in the north of the country as far back as
December 2019 (e.g., detection of SARS-CoV-2 in the wastewater of Milan and Turin1 ). The first recorded non-travel related
COVID-19 case occurred in Codogno (Lombardia) — where a 38 years old male visited the hospital first on February 17,
and then again on February 19 with worsening respiratory symptoms; in this date, he was tested and diagnosed. On February
20, two individuals tested positive in Vo’ Euganeo (Veneto). Notably, the outbreaks in Lombardia and Veneto took two very
different paths, something many observers attributed to the early response and aggressive testing strategy adopted by the
regional authorities in Veneto2, 3 . After some initial, much debated inconsistencies (e.g., hesitations in implementing local
lock-downs in areas hosting major industrial production hubs, contested decisions to move patients between hospitals and
nursing homes and to keep major sports events open to the public in Lombardia), starting in early March, local and central
authorities took progressively more stringent measures to limit mobility and social gatherings — culminating with a general
nationwide lock-down on March 9 and the suspension of all nonessential production activities on March 23 (starting in early
May, activities restarted and mobility and gathering restrictions were gradually loosened).
Lock-down notwithstanding, based on official records, Italy saw a total of ≈ 35, 200 COVID-19 deaths as of the beginning
of August. While other countries (e.g., the U.S. and Brazil) have reached much higher death counts, Italy’s relative death toll
remains rather stark at 58.25 per 100, 000 inhabitants. This may be partially attributable to the fact that Italy’s population is
very old (nationally, the median age is almost 46 years and the percentage of individuals over 65 almost 22%), and that age
itself correlates with conditions such as type II diabetes, hypertension and chronic respiratory ailments, which substantially
worsen illness and increase the likelihood of death for individuals affected by the virus. But perhaps the most striking aspect of
the COVID-19 epidemic in Italy has been its heterogeneity. Some parts of Lombardia and of other regions in the industrialized
north were hit early and especially hard, yet other demographically and socio-economically similar areas fared better. Moreover,
most of the central and southern regions of the country experienced a much milder epidemic — notwithstanding waves of
relocations from employment-related domiciles in the north back to family homes in the center and south around the time of the

nationwide lock-down. Potential contributors to this heterogeneity discussed by both scientists and the media include human
density characteristics; centralized, hospital-based vs distributed, primary health care systems; and pollution levels4–7 .
A broad and extremely sophisticated literature exists on epidemiological models, which many research groups are utilizing
both to aid policy through forecasts and to dissect what happened, in Italy and around the world. We did not utilize these models.
Instead, we applied a mix of statistical tools from the field of Functional Data Analysis (FDA8, 9 ), some well-established, and
some recently developed by our group. FDA offers very powerful approaches to analyze data sets composed of curves or
surfaces, exploiting information in their shapes. These techniques, which have been successfully applied in a variety of scientific
domains10–12 , can effectively complement traditional epidemiological analyses and provide useful insights13 . We used them
to characterize patterns of COVID-19 deaths occurring around the country and analyze their statistical association with two
key predictors; namely, mobility and positivity (the fraction of performed tests returning positive results). We also considered
various socio-demographic, infrastructural and environmental covariates. We focused on the period from February 16, right
before the first cases were recorded in Codogno and Vo’ Euganeo, to April 30, right before the first lock-down relaxations
(restarting of manufacturing and construction activities at the beginning of May). Based on data availability, we performed our
analyses at the spatial resolution of regions, which is suboptimal for several reasons. An epidemic is certainly better studied at a
much finer resolution (municipalities, urban areas, perhaps the provinces within which Italian regions are further partitioned) –
and so are its links to predictors and covariates whose signals may dilute when aggregated at the regional level. Moreover,
operating with 20 observational units (the Italian regions) limits the size of the statistical models one can reliably fit on the data.
The techniques we employed allowed us to pinpoint significant trends working with what we could retrieve from public data
sources. Unquestionably though, access to data at higher resolution would allow more nuanced, in-depth analyses and likely
produce sharper results.

Results
Below we describe the salient outcomes of our analyses. After addressing some shortcomings in publicly available COVID-19
deaths records, we characterize two starkly different epidemic patterns and rank regional mortality curves. Next, we relate
mortality to mobility and positivity, and to a number of socio-demographic, infrastructural and environmental factors.
Under-counting deaths
Since February 24, the Italian Civil Protection agency (Dipartimento della Protezione Civile; DPC) has released daily counts
of recorded COVID-19 deaths at the coarse resolution of regions (only the number of recorded cases are released at the finer
resolution of provinces). In Italy and elsewhere, official death records have often been criticized as undercounts14 . Alternative
data sources do exist, e.g., daily mortality rates -– which can be contrasted to those from prior years to gauge differential
mortality. In Italy these are provided by the National Statistical Institute (ISTAT) at the resolution of municipalities. We
aggregated the data over municipalities belonging to the same region and subtracted averages over the past 5 years (2015-19,
see Methods)15 . Figure 1(a) shows smoothed DPC and ISTAT differential mortality curves (per 100,000 inhabitants) for some
example regions (Lombardia, Veneto, Emilia Romagna and Campania). The under-counting in the official DPC records was
dramatic, especially in badly affected areas and in the initial stages of the epidemic. However, ISTAT differential mortality
curves have themselves limitations, especially in less affected areas, where they can fluctuate at small levels and even take
negative values — idiosyncratically or reflecting other COVID-19 related phenomena (e.g., increases in mortality due to
untreated emergencies or reductions in mortality due to fewer accidents during the lock-down). We therefore formed maxima
curves (MAX), where the largest between the DPC and the ISTAT datum is taken in each day and for each region, and then
smoothed. These are shown in Fig. 1(b) (DPC and ISTAT smoothed curves for all regions are shown in Figs. S1 and S2). We
repeated our analyses on all three data sets; given the small number of observational units at our disposal (n = 20 regions), this
allowed us to borrow strength replicating results across data sets, with their differences and limitations.
Two different epidemics
Italy saw the unfolding of two very different epidemics; a relatively mild one in the majority of the country, and a tragic,
seemingly out of control one in its most hard-hit regions. These two epidemics can be effectively characterized with probKMA,
an FDA technique designed to identify recurrent motifs within a set of curves, and group the curves based of the motifs they
comprise15 . Here, the motifs are the temporal patterns of deaths that characterize alternative epidemic unfoldings, which
may in fact start at different times in different curves (regions). Thus, the algorithm also produces the shifts required to align
regions comprising the same motif to each other. ProbKMA is similar to a K-mean algorithm; it requires the user to specify the
number of motifs (K) at the outset, and to select a distance — which can be defined on the curve levels, their derivatives, or a
combination of both (see Methods).
The solution with K = 2 and distance defined on curve levels depicts two starkly different epidemics, shown for the MAX
curves in Fig. 2(a). Allowing for shifts, these are represented by 65-day long motifs. Group 1 undergoes a steep ascent
2/29

6

2/16
2/20
2/24
2/28
3/03
3/07
3/11
3/15
3/19
3/23
3/27
3/31
4/04
4/08
4/12
4/16
4/20
4/24
4/28

2/16
2/20
2/24
2/28
3/03
3/07
3/11
3/15
3/19
3/23
3/27
3/31
4/04
4/08
4/12
4/16
4/20
4/24
4/28

0

2

4

Mortality

4
0

2

Mortality

0
2/16
2/20
2/24
2/28
3/03
3/07
3/11
3/15
3/19
3/23
3/27
3/31
4/04
4/08
4/12
4/16
4/20
4/24
4/28

(a)

Campania
Emilia−Romagna
Lombardia
Veneto

6

DPC
ISTAT

6

DPC
ISTAT

8

2/16
2/20
2/24
2/28
3/03
3/07
3/11
3/15
3/19
3/23
3/27
3/31
4/04
4/08
4/12
4/16
4/20
4/24
4/28

0

2

4

Mortality

6

MAX − After shifts

8

2/16
2/20
2/24
2/28
3/03
3/07
3/11
3/15
3/19
3/23
3/27
3/31
4/04
4/08
4/12
4/16
4/20
4/24
4/28

0

2

4

Mortality

4
4

Campania
Emilia−Romagna
Lombardia
Veneto

Campania

2

Mortality

DPC
ISTAT

Emilia−Romagna

6

8

0

2

Mortality

6

DPC
ISTAT

MAX − Before shifts
8

Veneto
8

8

Lombardia

0

10

20

30

40

50

60

70

(b)

Figure 1. Mortality curves. (a) DPC (dashed) and ISTAT (solid) differential mortality curves (per 100,000 inhabitants) in
four example regions; Lombardia, Veneto, Emilia Romagna and Campania. Curves are smoothed with splines, with degree of
smoothing selected by generalized cross-validation (see Methods). ISTAT curves “take off” earlier and in some regions are as
much as twice as high at their peak – possibly due to many COVID-19 deaths happening at home and/or not being recorded as
such in hospitals, especially in the early stages of the epidemic. (b) MAX mortality curves (per 100,000 inhabitants) in the 20
Italian regions, before (top) and after (bottom) the shifts produced by probKMA run with K = 2. In the bottom panel, time is
marked as a day number (as opposed to a date); this represents the region-specific time of the epidemic unfolding, and
corresponds to actual time (starting on February 16 and ending on April 30) only for regions with no shifts, e.g., Lombardia).
Curves are again smoothed with splines, with degree of smoothing selected by generalized cross-validation. Lombardia, Veneto,
Emilia Romagna and Campania, also shown in (a), are highlighted in color. In all panels, vertical lines mark the dates of the
national lock-down (March 9) and of the suspension of all nonessential production activities (March 23). In the bottom panel of
(b) vertical lines still show these dates without shifts; stars on the curves mark the lock-down after the region specific shifts.

(the “exponential” pattern) followed by a slower descent from the peak; it includes many northern regions. Based on the
shifts, Lombardia was first, followed by Emilia Romagna, Marche, Liguria, Piemonte, Trento/Bolzano, and last Valle d’Aosta.
Lombardia and Valle d’Aosta presented the most extreme peaks – but Valle d’Aosta’s descent was steeper (with a second late
ascent likely due to data recording imprecisions; Valle d’Aosta is a very small region with only ≈ 125, 000 inhabitants). Group
2 follows a “flat(tened)” pattern; it includes all regions in southern and central Italy and, remarkably, Veneto – where the curve
was successfully curbed. The shifts produced for this group are less stable and less meaningful in terms of interpretation, as
flatter profiles leave more leeway in aligning curves against each other. All results (except for the shifts in Group 2) are rather
consistent when using DPC and ISTAT curves (see Fig. S3a and Fig. S3c), and when using distances defined on derivatives
instead of curve levels. The solution with K = 3 places Lombardia (ISTAT curves) or Lombardia and Valle d’Aosta (MAX and
DPC curves) in a cluster of their own (see Fig. S4). We also validated our results using a modification of funBI 16 , a functional
biclustering technique, and IWTomics17 , a functional testing technique which contrasts two sets of aligned curves pinpointing
the locations and scales at which they differ (see Methods). Figure 2(b) shows how, starting a little over two weeks from the
beginning of their motif (wherever that was in each curve), Group 1 and Group 2 differ significantly at all temporal scales (see
also Fig. S3b and Fig. S3d).
Why the two epidemics? The pattern of deaths characterizing Group 1 may be due, in large part, to the fact that the virus
had circulated silently in the north of Italy for a long period of time before any kind of behavioral changes by the general public,
medical protocols, or mitigation policies by local and central authorities were put in place. Mounting evidence suggests that
a large share of COVID-19 cases are asymptomatic and yet contagious3 ; their numbers may have increased until a pent-up
3/29

ProbKMA K=2

Adjusted p−value heatmap

Shifts

−R
Em
i

lia

0
2/16
2/20
2/24
2/28
3/03
3/07
3/11
3/15
3/19
3/23
3/27
3/31
4/04
4/08
4/12
4/16
4/20
4/24
4/28

p−value

8
50

60

20

30

40

50

60

1.0
0.8
0.6
0.4
0.2
0.0

●●●●●
●●
●●
●
●
●
●
●
●
●
●
●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●

10

20

30

40

50

60

Mortality
10

20

30

40

50

0 2 4 6 8

IWTomics results

0

Group 1
Group 2

60
0

(a)

10

4

Mortality
40

0.2
10

0

2
30

0.4

20

Adjusted p−values − 65−day scale

0
20

0.6

30

0.0

6

8
6
4
2

10

40

0

Group 2

0
0

0.8

50

0

Group 1

Mortality

Maximum interval length

6
4
2

Mortality

60

om
ag
Lo Liguna
mb ria
ard
M
Tre Pi arc ia
nt em he
Va o/Bo onte
lle lza
d'A no
A os
Ba bruz ta
s zo
Fri
Cailicat
uli
la a
Ve Cam
ne p bria
zia an
Gi ia
u
La lia
Mo zio
l
P
Sa ugise
rde lia
gn
a
To Sicili
sc a
Umana
b
Ve ria
ne
to

8

1.0

10
8
6
4
2
0

Group 1
Group 2

10

20

30

40

50

60

(b)

Figure 2. Characterizing two epidemics. (a) MAX mortality curves are shown in the top left panel with 65-day portions
identified by probKMA with K = 2 in red (Group 1; "exponential" pattern) and blue (Group 2; "flat(tened)" pattern). The curve
portions are shown again, this time aligned with each other and separated by group, in the bottom panels. Black lines indicate
group averages. The shifts produced by probKMA are shown in the top right panel (motifs, groups and shifts for Group 1 are
stable across data sets; shifts for Group 2 are less stable and less interpretable – see Fig. S3). (b) Shifted Group 1 and Group 2
MAX mortality curves are tested against each other with IWTomics. The heatmap at the top shows p-values adjusted at all
possible scales (from 1 to 65 days). The middle panel shows in detail the top-most row of the heatmap; i.e. the p-values
adjusted across the whole 65-day interval. The bottom panel shows again the shifted curves. Gray areas in the middle and
bottom panels mark days when the difference between the two groups is significant (adjusted p-value < 5%). Starting a little
over two weeks from the beginning of their epidemic, curves in the two groups differ significantly at all temporal scales.

reservoir of virus found its way to vulnerable individuals (some researchers also hypothesize Antibody-Dependent-Enhancement
of SARS-CoV-218 , and thus a role for re-infections). But a variety of additional factors may have contributed to shaping the
two epidemics; we explore some below.
Ranking mortality curves
Non-parametric FDA methods can be used to rank curves based on the notion of depth — from the innermost to the most
extreme, and to identify outliers19, 20 . Figure 3 shows a functional box plot of the MAX mortality curves and a depth ranking
of the curves in the DPC, ISTAT and MAX data sets – shifted based on probKMA run with K = 2 and restricted to their
aligned 65-day portions. The ranking is directional; we attributed signs to the depth measurements, so that curves far over or
under the median curve are at the top or bottom of the ranking, respectively (see Methods). The top portion of the ranking
comprises regions with "exponential" epidemics (Group 1) and is rather stable across data sets; Lombardia and Valle d’Aosta
are consistently among the most extreme curves (they are also identified as outliers in the MAX and DPC data sets). The midand bottom portions of the ranking comprise regions with "flat(tened)" epidemics (Group 2) and are less stable across data sets,
as the flatter profiles can more easily switch in their depth ranks. However, Toscana (which is the median in the MAX and
ISTAT data sets) and Veneto are consistently among the deepest, most central curves. This analysis highlights again the tragic
epidemic unfolding in Lombardia, and, by contrast, confirms how Veneto managed to “flatten” its curve back into the bulk.
Local mobility and positivity as statistical predictors of mortality
Next, we focus on two key variables. The first is one of the most discussed policy-actionable variables, mobility, which has
been curtailed to various degrees through lock-down measures in most of the countries affected by COVID-19. The second is
4/29

(a)

(b)

Figure 3. Functional boxplot and ranking. (a) Functional boxplot of the MAX data set (top) and MAX mortality curves
(bottom) color-coded according to their ranking, as shown in the MAX column of (b). In the boxplot, Toscana is the median
(black continuous line); Lombardia, Valle d’Aosta and Liguria are identified as outliers (red dashed lines); and the 50%
innermost "box" (grey area) include the curves for Trento/Bolzano, Emilia-Romagna, Marche, Friuli Venezia Giulia, Veneto,
Toscana, Molise, Abruzzo, Sardegna, Umbria, and Basilicata. Note that the "box" is skewed upwardly. (b) Rankings of the
ISTAT (left), MAX (center) and DPC (right) mortality curves. The median regions are in bold, gray rectangles mark the 50%
innermost boxes, and pale red rectangles mark outliers (no region is labeled as an outlier in the ISTAT data set; see Methods).
The dots representing each region are color-coded (from intense red, through gray, to intense blue) according to their signed
depth values (see Methods). In all three data sets, Lombardia’s curve is the most extreme at the very top of the ranking and, in
contrast, Veneto’s curve is deep in the bulk close to the median (Toscana for ISTAT and MAX, Friuli Venezia Giulia for DPC).
Segments joining the regions across the three rankings show how the top portion remains rather stable, while the mid- and
bottom portions contain several crossings. Regions at the top are those characterized by "exponential" epidemics (Group 1),
while regions in the middle and at the bottom are those with "flat(tened)" epidemics (Group2), whose curves can more easily
switch in their depth ranks.

one of the most discussed sentinel indicators, positivity, i.e. the fraction of performed tests returning positive results. For both
these variables daily values for the period February 16 – April 30 can be obtained from data in the public domain at regional
resolution.
We considered differential mobility curves provided by Google for the category “Grocery & pharmacy”. These express
the fractional reduction with respect to January 2020 levels, and refer to mobility linked to first necessities — such as buying
food, medicine, etc. For Italy, they are provided at the resolution of regions. Even though individuals were allowed to leave
their homes for these necessities also during the most restrictive phase of the lock-down, the reduction captured by Google’s
“Grocery & pharmacy” was substantial. Mobility in weekdays fell by roughly 0.30, i.e. 30%, in the week after the lock-down
5/29

^
β(s,t) for mobility − partial R2 = 0.62

mobility: shifted curves

^
β(s,t) for mobility − contour plot
500

0

30

40

50

60
50
40
400

300
400

30

300

−200

300

or t

100

100

0

−100

200

200

100

t (mortality time)

e)

y tim

alit

−100

−100

10

t (m

−1.0

−100

20

−200

10

−200

0

−400

−300

0

0

−400

0

im

0

100

0

20
ob 40
ility
t

−300

20
s(
m

0

100

−200

200

40

100
100

60

−200
−400

200

0

−100

0

0

20

200

300

−2
0
0

−0.2

200

200

400

−0.6

400

400

0

0.2

Campania
Emilia−Romagna
Lombardia
Veneto

0

0

e) 60

0

0

0

100

60

0

10

20

30

40

50

−500

60

s (mobility time)

^
β(s,t) for positivity − partial R2 = 0.53

200

60
40

−100

400

50
100

100
100

e)

y tim

30

t (mortality time)

10

−400

60

0

10

20

30

40

50

−200

−300

−100

0

100

−100

0

0.2

alit

or t

−300

200

t (m

300

0.1

200

100

0.0

400

0

−500
0

50

−200

100

0

0

40

−100

0

0

−100

30

0

0 0

im

20

300

−400

e) 60

0

100

0

20
siti 40
vity
t

200

500

20
s(
po

400

40

300

−200

−100

60

300

100

100

0

0
−200
−400

20

0.4
0.3

200

200

10

500
400

400

400

0

600

0

0

0

Campania
Emilia−Romagna
Lombardia
Veneto

0

positivity: shifted curves

^
β(s,t) for positivity − contour plot

−600

60

s (positivity time)

(a)

(b)

Figure 4. Associating mortality to local mobility and positivity. (a) Local mobility curves (Google’s “Groceries &
pharmacy”) and positivity curves (regularized ratios of new cases to number of tests performed) in the 20 Italian regions.
Curves are smoothed with splines, with degree of smoothing selected by generalized cross-validation, and shifted based on
probKMA run on the MAX mortality curves with K = 2; time is marked as a day number representing the region-specific time
of the epidemic unfolding, and corresponds to actual time (starting on February 16 and ending on April 30) only for regions
with no shifts, e.g., Lombardia. Vertical lines show the days corresponding to the nationwide lock-down (March 9) and the
suspension of all nonessential production activities (March 23) without shifts, stars on the curves mark the lock-down after the
region specific shifts. The example regions of Fig. 1(a) are highlighted in color. (b) Estimated effect surfaces from the joint
function-on-function regression of MAX mortality on local mobility and positivity shown in 3D and as contour plots (March 9,
without shift, is again marked on both). Early and mid-period local mobility levels are strong positive predictors of mortality at
its peak. Positivity has similar but much weaker predictive signals, likely because the effects are subsumed by mobility. Late
local mobility has a negative association with mortality at its peak (mobility resumed faster in regions with milder epidemics),
and late positivity a strong positive one (positivity remained elevated in regions with worse epidemics). The regression captures
a large share of the variability in mortality curves (in-sample R2 = 0.90, LOO-CV R2 = 0.52), with substantial and comparable
contributions of the two predictors (partial R2 s = 0.62, 0.53).

(March 9), and further decreased in following weeks – reaching the lowest levels (between approximately −0.60 and −0.40
depending on the region) in the week after the suspension of nonessential production activities (March 23). It then slowly
increased, getting back in a range between approximately −0.40 and −0.20 at the very end of April (see Fig. S5). In Lombardia,
the peak MAX mortality was between March 20 and 25 – i.e., roughly, simultaneous to the lowest mobility and two weeks after
its first substantial drop. Notably, in most Italian regions mobility during lock-down weekends reached −1.00, i.e. −100%. For
comparison, in the state of New York, which had among the strongest restriction measures in the U.S., Google’s “Grocery &
pharmacy” never fell below −0.40. We refer to Google’s “Grocery & pharmacy” curves as local mobility because they measure
how much individuals move around where they live, as opposed to how much individuals move from place to place — e.g., to
go from Wuhan to Milan, or from Milan to Palermo, or New York City. Obviously both types of mobility are relevant for the
spread of a virus, and definitions depend on scale/resolution, but the first one is the one we analyzed.
To construct positivity curves, we combined daily public records on number of tests performed and number of new cases,
which are also provided by the Italian Civil Protection agency. Taking daily ratios of new cases on tests performed is clearly
imperfect, because of (variable and unreported) delays in test results. But regularizing and smoothing these ratios (see Methods)
6/29

produced a reasonable proxy. Smoothed positivity surpassed 0.1, i.e. 10%, as early as February 20 in some hard hit regions,
peaked in a staggered fashion throughout March, and fell below 0.10 for all regions by around April 22 (see Fig. S5). Lombardia
surpassed 0.10 around February 22 and peaked around March 15-18; that is, roughly, about a month and about a week prior to
the peak of MAX mortality, respectively. Though we cannot draw exact parallels (our positivity curves are approximate and
smoothed), this is consistent with what was observed, e.g., in New York City – where positivity was above 0.10 approximately
from March 6-7 to May 12-13 and peaked at about 0.70 around March 28, with deaths peaking between April 5 and 13.
To anchor local mobility and positivity curves to the epidemic unfolding in each region, we shifted them congruently with
the mortality curves. Figure 4a displays shifted curves based on probKMA run on MAX data with K = 2 (Fig. S6 displays shifted
curves based on probKMA run on DPC and ISTAT data). The horizontal axis now indicates again days in the region-specific
epidemic unfolding, restricted to the 65-day portions where mortality curves align forming the two probKMA motifs.
We then used function-on-function regressions8, 21 to model
the statistical dependence
of mortality on local mobility and
R
R
positivity; in symbols, we fit the joint model y(t) = α(t) + βmob (s,t)xmob (s)ds + β pos (s,t)x pos (s)ds + ε(t), where y(t) is the
response curve, i.e. mortality, α(t) is the intercept, ε(t) is the model error, and xmob (s) and x pos (s) are the predictor curves –
mobility and positivity, respectively. These predictors are integrated over time, with “effects” represented by surfaces; βmob (t, s)
is the association of mortality at time t with local mobility at time s, and similarly β pos (t, s) for positivity (see Methods).
Figure 4b shows the effect surfaces for local mobility and positivity estimated using the MAX curves as response. β̂mob (t, s)
suggests that local mobility levels early on and mid-way through the epidemic (e.g., around the March 9 lock-down date for
Lombardia) are strong positive predictors of mortality at its peak, with the early predictive signal stronger than the mid-way one.
In contrast, the local mobility level late in the epidemic has a negative association with mortality at its peak, likely reflecting a
faster resumption of mobility in regions with milder epidemics. β̂ pos (t, s) suggests that positivity levels early on and mid-way
through the epidemic are also positive predictors of mortality at its peak – though the predictive signals are substantially
weaker than those of mobility, likely because they are confounded with the latter. However, the positivity level late in the
epidemic has a marked positive association with mortality at its peak. Here the signal is "detangled" from that of mobility, and
one finds a sort of retrospective signature; regions which fared worse still had hightened positivity in the late stages of their
epidemics. Estimated effect surfaces are remarkably similar across the three data sets (MAX, DPC and ISTAT), and the joint
models all have in-sample R2 s above 90% and leave-one-out cross-validated (LOO-CV) R2 s above 50% (see Table S2), with
strong and comparable contributions of local mobility and positivity (e.g., for the MAX curves, the partial R2 s are 62% and
53%, respectively). Also, while this is not the case for all regions, residuals are rather consistent across data sets for Veneto,
whose mortality is well predicted, and for Lombardia, whose mortality is always and sizably underestimated (see Fig. S7a and
Fig. S10).
In order to further assess the roles of local mobility and positivity, we also
considered marginal function-on-function
R
regressions
for
mortality
on
each,
separately;
in
symbols,
y(t)
=
α(t)
+
β
(s,t)xmob (s)ds + ε(t) and y(t) = α(t) +
mob
R
β pos (s,t)x pos (s)ds + ε(t). Effect surface estimates for local mobility are very similar to those in the joint models for
all three data sets (see Fig. S8). Those for positivity confirm a strong association with mortality at its peak, but are less defined
in terms of time profile (see Fig. S9). In summary, we find substantial evidence that local mobility and positivity are associated
with COVID-19 mortality, and can predict it with some lag-time. Though the data at our disposal does not allow us to pinpoint
lag lengths with accuracy, our analysis does support their roles as policy-actionable and monitoring variables, respectively.
We also find that, even when considered jointly, these variables are not enough to fully account for the massive numbers of
COVID-19 deaths recorded in Lombardia, the worst hit region in the country.
The role of socio-demographic, infrastructural and environmental factors
We considered several scalar (non-longitudinal) covariates proxying for socio-demographic, infrastructural and environmental
factors debated by scientists and policy-makers during the epidemic (see Table S3). Many of these are suboptimal proxies
retrieved from public sources. They refer to the closest times we could find data for (usually 2017 or 2018) and are, too, at
the coarse resolution of regions. After an initial screen to guarantee data quality and limit the amount of collinearities, we
focused on 12 covariates capturing aging of the population; prevalence of pre-existing conditions believed to affect disease
severity; quality of distributed primary health care vs. centralized hospital-based health care; the potential of hospitals and
nursing homes, but also schools, work places, households and public transport to act as contagion hubs; and pollution levels
(see Table 1; Fig. S14 provides marginal densities, pair-wise scatter plots and correlations).
Even the restricted set of 12 covariates presents a distinct interdependence structure (see covariates dendrogram in Fig. 5(b)
and Variance Inflation Factors in Table S4). For instance, our contagion hubs proxies for hospitals, schools and work places,
and our (inverse) proxy for quality of distributed, primary health care (number of adults per family doctor), tend to vary closely
together across regions. Also, our contagion hub proxy for public transport and pollution levels tend to vary together (this is
not counter-intuitive, as both increase in more industrialized regions with large metropolitan areas), as do the percentages of
individuals affected by diabetes and allergies, and our proxy for quality of centralized, hospital-based health care (ICU beds
7/29

Covariate

Description [comment in legend]

Year and Source

% Over 65
% Diabetics
% Allergic
Adults per family doctor
ICU beds per 100K inhabitants
Ave. beds per hospital (whole)
Ave. beds per nursing home (ward)
Ave. students per classroom
Ave. employees per firm
Ave. members per household
Public transport rides per capita
PM10

Aging of the population [1]
Prevalence of relevant pre-existing conditions [2]
Another potentially relevant pre-existing condition
Quality of distributed, primary health care
Quality of centralized, hospital-based health care [3]
Ability of hospitals to act as contagion hubs
Ability of nursing homes to act as contagion hubs
Ability of schools to act as contagion hubs
Ability of work places to act as contagion hubs
Ability of households to act as contagion hubs [4]
Ability of public transport to act as contagion hub
Pollution levels (particulates)

2018, ISTAT
2018, ISTAT
2018, ISTAT
2017, Ministry of Health
2018, Ministry of Health
2018, Ministry of Health
2018, Ministry of Health
2018, Ministry of Education
2017, ISTAT
2017, ASR Lombardia
2017, ISTAT
2018, ISTAT

Table 1. Scalar covariates potentially affecting COVID-19 mortality. [1] The percentages of over 65, 70, 75 and 80 are
highly correlated at the resolution of regions; we took over 65 as representative. [2] The prevalence of diabetes, hypertension
and chronic bronchitis are highly correlated at the resolution of regions; we took diabetes as representative (allergies are not as
highly collinear and were retained as separate). [3] Availability of ICU beds is also directly relevant for withstanding the
impact of COVID-19 surges. [4] Average members per household is not a direct proxi of inter-generational contacts, but it may
capture some of its effects.

per 100, 000 inhabitants) and the percentage of individuals over 65. Conversely, some regions show similar profiles across
covariates (see regions dendrogram in Fig. 5(a)). For instance, Lombardia, Veneto, Emilia Romagna and Piemonte have strong
similarities, as do groups of southern regions (e.g., Sicilia, Campania, Puglia and Calabria; Basilicata, Abruzzo and Molise).
An interesting characterization is produced using the Cheng and Church’s biclustering algorithm22 , which we implement with
an adjusted mean squared residue, or H-score23 . A bicluster is a subset of regions which exhibit similar behavior across a subset
of covariates. Figure 5(b) shows two biclusters with similar adjusted H-score values, obtained through the same run of the
algorithm. The first bicluster comprises central and southern regions, all with "flat(tened)" epidemics (Group 2). Its regions
have low ratios of adults to family doctors, limited concentrations in hospitals, nursing homes, work places and public transport,
and low pollution levels. They also have high percentages of diabetic individuals and limited availability of ICU beds. The
second bicluster comprises northern regions with "exponential" epidemics (Group 1), such as Lombardia, Emilia-Romagna
and Piemonte, but also northern and central regions with "flat(tened)" epidemics (Group 2), such as Veneto, Friuli Venezia
Giulia and Toscana. Its regions have high ratios of adults to family doctors, high concentrations in hospitals, work places and
classrooms, and tend to have large percentages of individuals over 65. They also have low percentages of diabetic individuals
and medium or small-sized households.
Next, we used functional regressions with a two-fold aim: pursue a more direct, systematic assessment of the associations
between the scalar covariates and COVID-19 mortality; and use the scalar covariates as controls in models comprising mobility
and positivity to re-assess these key predictors. We stress again that the coarse resolution of the data poses serious limitations for
these analyses, because it may dilute some predictive signals and because it bounds us to a small sample size. With only n = 20
observational units (the regions), fitting functional regression models comprising many terms (e.g., several scalar covariates
and possibly their interactions; mobility and positivity curves along with more than one scalar covariate) produces unstable,
overfit outcomes. Thus, we evaluate only the marginal effects of the scalar predictors, and the effects of mobility and stability
with one scalar control at a time. The marginal function-on-scalar regressions of mortality curves on each of the 12 covariates
have in-sample R2 s ranging between ≈ 20 and 65%. Here the "effects" are curves; βx (t) represents the association of mortality
at time t with the covariate x. For 8 of the covariates the β̂x (t)’s show the expected signs throughout the peak period of the
epidemic. In particular, the (inverse) proxy for quality of distributed, primary health care is the strongest marginal predictor;
adults per family doctor shows a very large positive association with mortality. Also hospital, school and work place contagion
hub proxies show strong positive associations with mortality. Nursing homes and public transport contagion hub proxies,
pollution and the percentage of individuals over 65 are positive but comparatively weaker marginal predictors. For 4 of the
covariates the β̂x (t)’s show unexpected signs. The percentages of diabetics and allergic individuals show negative associations
with mortality, likely due to the fact that their prevalence is high(er) in areas which were spared the brunt of the epidemic. In
fact, estimated effect curves become positive when a differential intercept is included in the model to account for different
overall mortality levels in Group 1 and Group 2 regions (see Fig. S12). Also the average number of members per household
shows a negative association with mortality. Its small range of variation across regions (≈ 2.0 − 2.8, mean 2.3, s.d. 0.16) may
8/29

(a)

(b)

Figure 5. Interdependencies among scalar covariates and regions. (a): heatmap of the 20 (regions) x 12 (covariates) data
matrix, with dendrograms from separate hierarchical clustering (correlation distance, complete linkage) of the regions (left) and
the covariates (top). Color coding within cells represents values of the standardized covariates (centered and scaled to mean 0
and standard deviation 1). Color coding of some cell borders identifies the biclusters in (b). The dendrograms capture a distinct
interdependence structure. For instance, there are marked similarities among Lombardia, Veneto, Emilia Romagna and
Piemonte, as well as among some groups of southern regions (Sicilia, Campania, Puglia and Calabria; Basilicata, Abruzzo and
Molise). There are also marked associations among groups of covariates. The contagion hubs proxies for hospitals, schools and
work places, and number of adults per family doctor, vary closely together. So do the contagion hub proxy for public transport
and pollution levels; the percentages of individuals affected by diabetes and allergies; and ICU beds and the percentage of
individuals over 65. (b): restricted heat-maps further illustrating interdependencies through two biclusters of regions and
covariates. Color-coding within cells corresponds to that in (a), and each bicluster is identified by a border color and its adjusted
H-score (an inverse measure of bicluster strength; see Methods). The first bicluster (adjusted H-score = 0.0902) comprises
central and southern regions with "flat(tened)" epidemics (Group 2). The second bicluster (adjusted H-score = 0.0942)
comprises northern regions with "exponential" epidemics (Group 1) but also northern and central regions from Group 2.

not allow it to properly proxy the effect of household contagions. At the same time, a strong negative correlation with the
percentage of individuals over 65 may not allow it to properly proxy inter-generational contacts; regions with more elderly
people are in fact those with smaller households. The negative association of average number of members per household with
mortality, which persists even when including a differential intercept for Group 1 and Group 2 in the model (see Fig. S12), may
simply be a "shadow" of this its negative correlation with the percentage of individuals over 65. Finally, ICU beds per 100, 000
inhabitants shows a positive association with mortality which, too, persists when including a differential intercept for Group 1
and Group 2 in the model (see Fig. S12), and may be in part a "shadow" of positive correlations with percentage of individuals
over 65 and average number of beds per hospital. However, this proxy for quality of centralized, hospital-based health care, so
prominent to the public debate during the epidemic, is not a negative predictor of mortality in our analysis. In conclusion, better
proxies and finer resolution may reveal stronger aggravating roles for age, nursing homes, public transport and pollution4, 5
and better dissect the roles of chronic conditions, households and inter-generational contacts, and ICU availability24, 25 . But
our analysis, notwithstanding limitations in the data, suggests important roles of primary care in mitigating mortality, and of
9/29

^
β(s,t) for mobility − partial R2 = 0.66

^
β(t) for marginal regressions
negative

●

zeros

60

●
●

^
β(s,t) for positivity − partial R2 = 0.61

positive

●

600

200

400

40

200

100

500

200

100
0

5+

%6

%D

●
●
●
●
●
●

ct s/cpt spt /nrsg lrm firm hld p/cpt M10
bts llrgs
s
do
h
P
%A lts/ UBd ds/ Bds ns/c pls/ rs/h bTrs
b
m
td
IC
Av
Pu
Ad
vB
A

e)

e)

20
s(
mo 40
bili
ty
t

●
●
●
●

20
e) 60

0.4

0.4

0.0

0.0

A

0.8
0.4
0.2

0.2

−0.2

ts rgs oct /cpt spt rsg rm rm hld /cpt
10
l
ll
s
fi
p
/n
s
d
h
PM
%A lts/ UBd ds/ Bds ns/c pls/ rs/h bTrs
b Pu
td m
Ad IC vB Av

e) 60

0.6

0.6

pc1 loadings

0.0

b
%D

−600

^
β(t) for pc1 − partial R2 = 0.39

0.2

+

−400

20
siti 40
vity
tim

R2 for marginal regressions

5
%6

−200

40
20
s(
po

−200

im

E
S
Av Av AvM

max
istat
dpc

−500

−100

40

y tim

●
●
●
●
●
●
●
●

alit

●
●
●
●
●
●

or t

●
●
●
●
●
●

y tim

●
●
●
●
●
●

alit

●
●
●
●
●
●
●
●
●
●
●
●
●

or t

●
●
●
●

60

t (m

0

●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●

0

0

60

t (m

20

0
−100
−200

t
ct
sp
lrm /firm hshld
/do
s/h
s/c
pls
rs/
dn
Bd
Av AvSt AvEm AvMb

lts

Ad

0

10

20

30

40

50

60

E
S
Av Av AvM

(a)

(b)

Figure 6. Associating mortality to socio-demographic, infrastructural and environmental factors. (a) Results from
marginal function-on-scalar regressions. Mortality curves are regressed against each of the scalar covariates in Table 1. The top
plot displays the signs of the effect curves estimated on the MAX data. Time, marked as the 65 days of the region specific
epidemic unfoldings, is on the vertical axis (the nationwide lock down on March 9, without shift, is marked by a horizontal line.
Red, blue and green indicate, respectively, positive, negative and non-significant portions (i.e., where 95% confidence bands
around the estimated effect curve are entirely above, entirely below, or contain 0; see Methods). The bottom plot displays
in-sample R2 s for the regressions fitted on MAX, ISTAT and DPC data; these are remarkably consistent. The names in red on
the horizontal axes indicate the top 5 covariates selected by SnNAL-EN on all three data sets (see Methods); these are also the
ones with the largest R2 s. (b) Results from the joint function-on-function regression of MAX mortality on local mobility,
positivity, and the first principal component (pc1) of the top 5 covariates, used as a "summary" control. This control does not
modify the shapes of the estimated effect surfaces for mobility and positivity (shown on top) – which are very similar to the
ones in Fig. 4(b). The estimated effect curve for pc1 shows a positive and significant association with mortality at its peak
(bottom right; 95% confidence band in dashes, gray corresponds to non significant portions, vertical dashed line corresponds to
March 9, without shift). The sign of this effect is consistent with marginal findings, based on the loadings of the first principal
component (bottom left; positive for adults per family doctor, average beds per hospital, average students per classroom and
average employees per firm, and negative for average members per household). With the addition of pc1, the regression reaches
an in-sample R2 = 0.94 and a LOO-CV R2 = 0.7. The contributions of local mobility and positivity remain high (partial
R2 = 0.66 and 0.61, respectively). That of our "summary" covariate is also substantial (partial R2 = 0.39).

contacts in hospitals, schools and work places in aggravating it.
The results of our marginal function-on-scalar regressions, which are summarized in Fig. 6(a) for MAX mortality curves,
are also consistent across data sets (see Fig. S12) – which lends them support, at least at the resolution of regions. To further
validate their stability we ran a functional generalization of SsNAL-EN 26 – an Elastic Net-like algorithm that performs feature
selection for regressions with many predictors, producing reasonably stable outcomes even with small sample sizes and collinear
features. Reassuringly, the output of SsNAL-EN is consistent with the marginal analysis, and again consistent across data sets
(see Table S1): the top feature is always adults per family doctor, and the top 5 always include, in addition to it, average beds
per hospital, average students per classroom, average employees per firm, and average members per household.
Finally, we ran again the function-on-function regression of mortality on local mobility and positivity, and re-evaluated
the effects of these predictors introducing in the model one of the top 5 scalar covariates at a time (see Fig. S13 for results on
10/29

DPC, ISTAT and MAX data), as well as their first principal component, which explains ≈ 68% of their variability and can
act as a "summary" control (see Fig. 6(b) for MAX curves and Fig. S11 for DPC and ISTAT curves). Remarkably, while the
control covariate "subsumes" some of the predictive power in each model, the estimated effect surfaces of local mobility and
positivity retain the same shapes, and they remain very strong and comparable contributors (e.g., for MAX curves in Fig. 6(b),
the overall in-sample R2 reaches 94%, the LOO-CV R2 is 70%, and the partial R2 s are 66, 61 and 39%, respectively, for local
mobility, positivity and the first principal component; see also Table S2). Thus, with all the limitations of the data at our
disposal, controlling for relevant covariates does not modify how the epidemic unfolding is associated to local mobility and
positivity over time. Introducing socio-demographic, infrastructural and environmental factors in the modeling also does not
change what we observed concerning residuals: mortality in Veneto is well predicted, and mortality in Lombardia remains
sizably underestimated (see Fig. S7b) for MAX and Fig. S11 for DPC and ISTAT).

Discussion
Notwithstanding the limitations of the data employed in this study, using FDA techniques we were able to characterize
heterogeneous and staggered epidemics in different areas of Italy -– recapitulating and quantitating what scientists, policy
makers and the public saw unfolding during the months of February, March and April 2020. In addition, we were able to
document strong associations of COVID-19 mortality with local mobility and positivity, which persist in models that control
for other relevant covariates. Investigating local mobility and positivity as, respectively, an actionable effector and a sentinel
indicator of epidemic strength and progression, possibly to be used to adapt mitigation and containment efforts in real time, will
require more and better data. In particular, accurate data on cases and hospitalizations in addition to deaths, and at a resolution
much finer than that of Italian regions. Such data would also be critical to better capture predictive signals in a number of
covariates – which may weaken and/or become confounded when aggregating data over broad, internally heterogeneous areas.
But our results, along with those of other recent studies27 , do support a role for mobility as a key modulator of COVID-19 spread
and for positivity as a monitoring variable. Moreover, they support a role for distributed, primary health care in mitigating
mortality, and for hospitals, schools and work places as contagion hubs that may aggravate the epidemic. If confirmed and
fine-tuned on higher resolution data, also these findings could inform decision making – e.g., on short- and medium-term
investments to boost distributed health care, or "pod" patients, students or employees. Finally, an extension of the temporal
span of the data would also be of great interest to properly characterize different phases of the Italian epidemic – including
its evolution after the gradual weakening of lock-down measures in May 2020. We believe that our work demonstrates the
potential of FDA techniques for analyzing epidemiological data. Our pipelines and the mix of FDA tools used in this study
could be applied to COVID-19 data from other parts of the world.

Methods
Data retrieval and pre-processing
Functional variables

Daily cumulative COVID-19 death counts per region were retrieved from the Italian Civil Protection agency (Dipartimento
della Protezione Civile; DPCA ). DPC mortality curves from February 24 to April 30 were computed for each region as the daily
increments in COVID-19 death counts, divided by the population of the region as of January 1, 2019 (as recorded by ISTATB ).
DPC mortality curves were set to zero for the period February 16-23, before the Civil Protection agency started releasing data.
Daily death counts from all causes in 7270 Italian municipalities (about 93.5% of the Italian population) for the years 2015-20
were downloaded from the Italian National Institute of Statistics (ISTATC ) on June 4, 2020. Data were aggregated by region,
and ISTAT differential mortality curves from February 16 to April 30 were computed for each region as the daily difference
between 2020 deaths and the average daily deaths in 2015-19, divided by the total population of the municipalities included
in the death counts as of January 1, 2019 D ). MAX mortality curves were created taking, for each region and each day, the
maximum between DPC mortality and ISTAT differential mortality. Daily measurements concerning “Grocery & pharmacy”
mobility from February 16 to April 30 were downloaded for each region from the Google Mobility ReportE (local mobility
curves). These measurements express percent changes with respect to the corresponding daily mobility levels in the first five
weeks of 2020 (January 3 to February 6). Positivity curves were constructed using raw data from the Italian Civil Protection
agencyA . For each day from February 24 to April 30 and each region, we took the ratio between the number of new positive
cases and the number of new tests performed. The ratios were truncated at 0 and 1 to account for irregularities in the row data
A https://github.com/pcm-dpc/COVID-19/tree/master/dati-regioni
B http://asti.istat.it/asti
C https://www.istat.it/it/files/2020/03/Dataset-decessi-comunali-giornalieri-e-tracciato-record-4giugno.zip
D http://dati.istat.it/Index.aspx

(Popolazione e famiglie/Popolazione/Popolazione residente al 1◦ gennaio/Tutti i comuni/2019)

E https://www.google.com/covid19/mobility/

11/29

(e.g., positive cases = −1, or positive cases exceeding tests performed, presumably due to delays in test results). Like DPC
mortality, positivity curves were set to zero for the period before the Civil Protection agency started releasing data (February
16-23). For all functional data sets, the two self-governing provinces of Trento and Bolzano were considered together as the
Trento/Bolzano region, since not all data were available for both provinces separately. The 20 curves in each functional data set
were smoothed using cubic smoothing B-splines with knots at each day and roughness penalty on the curve second derivative8 .
For each functional data set the smoothing parameter was selected minimizing the average generalized cross-validation error
(GCV28 ) across the 20 curves. All computations were performed using the R package fda29 .
Scalar covariates

We considered a large number of scalar covariates of potential interest (see Table S3), and focused on the 12 listed in Table
1 and below. In retrieving and computing various measurements, as was done for the functional variables, the provinces of
Trento and Bolzano were aggregated into the Trento/Bolzano region. % Over 65 was retrieved from ISTATB at the regional
level for the year 2018. % Diabetics and % Allergics were retrieved from ISTATF at the regional level for the year 2018. Adults
per family doctor was retrieved from the Ministry of HealthG at the regional level for the year 2017. To compute ICU beds
per 100, 000 inhabitants, we collected the total number of ICU beds in each region in 2018 from the Ministry of HealthH ,
multiplied by 100,000 and divided by the population of the region as of January 1, 2019B . To compute Ave. beds per hospital
(whole) we used data from the Ministry of HealthI , which provides the number of beds per ward in each hospital in 2018. We
first aggregated them over wards belonging to the same hospital, and then averaged over hospitals in each region. Ave. beds per
nursing home (ward) was also obtained based on data for the year 2018 from the Ministry of HealthJ – here we considered
regional averages at the level of wards, without aggregating over wards inside the same nursing home (the ward-level covariate
had a slightly higher association with mortality outcomes). To compute Ave. students per classroom we used data from the
Ministry of EducationK LM N , which provides the number of students in each classroom of each school in the country (public or
private, at every level of education), for the year 2018. We averaged them over schools in each region. Data for Trento/Bolzano
and Valle d’Aosta were missing, and were imputed through random forest imputation30 , with default parameters maxiter=10
(maximum number of iterations to be performed given the stopping criterion is not met beforehand) and ntree=100 (number
of trees to grow in each forest). To compute Ave. employees per firm we used data from ISTATO , which provides number of
employees per firm at the level of municipalities. We averaged them over firms in each region. Data for Valle d’Aosta were
missing, and were again imputed through random forest imputation with default parameters. Ave. members per household
was retrieved from ASR LombardiaP at the regional level for the year 2017. To compute Public transport rides per capita
we used data from ISTATQ , which provides the number of rides per capita for each Italian province in 2017. We multiplied
these by the provinces’ population as of January 1, 2019B , summed up over provinces in the same region, and divided by the
region population as of January 1, 2019B . To compute PM10 we used data from ISTAT Q , which provides the average annual
concentrations of PM10 (in µg/m3) detected by air quality meters distributed over the Italian territory. We averaged them over
meters located in each region.
Multivariate analysis tools
We used a number of standard multivariate techniques to analyze data on the 12 scalar covariates – including the extraction of
Principal Components31 , the calculation of Variance Inflation Factors32 to evaluate multicollinearities, and clustering based on
hierarchical agglomeration31 . The latter was used both to agglomerate covariates with similar behavior across regions and
to agglomerate regions with similar behavior across covariates. Agglomerative hierarchical clustering groups elements in
a set with a bottom-up procedure that results in a dendrogram. Each element starts in its own cluster, and pairs of clusters
are merged iteratively with a chosen distance for elements and linkage criterion for clusters. We employed the correlation
distance, defined as d(x1 , x2 ) = 1 − corr(x1 , x2 ) for two generic elements x1 and x2 , and the complete linkage, defined as
D(X1 , X2 ) = maxx1 ∈X1 ,x2 ∈X2 d(x1 , x2 ) for two generic clusters X1 and X2 (thus, the distance between two clusters is defined as
the furthest distance between their elements). We also used biclustering on the 20 (regions) by 12 (covariates) data matrix, to
identify subsets of regions exhibiting similar behaviors across subsets of covariates. Following standard literature, we sought
F http://dati.istat.it/Index.aspx?QueryId=15448
G http://www.salute.gov.it/imgs/C_17_pubblicazioni_1203_ulterioriallegati_ulterioreallegato_8_alleg.pdf
H http://www.dati.salute.gov.it/dati/dettaglioDataset.jsp?menu=dati&idPag=96
I http://www.salute.gov.it/imgs/C_17_bancheDati_6_0_1_file.xls
J http://www.salute.gov.it/imgs/C_17_bancheDati_6_0_0_file.xls
K https://dati.istruzione.it/opendata/opendata/catalogo/elements1/leaf/?area=Studenti&datasetId=DS0030ALUCORSOINDCLASTA
L https://dati.istruzione.it/opendata/opendata/catalogo/elements1/leaf/?area=Studenti&datasetId=DS0030ALUCORSOINDCLAPAR
M https://dati.istruzione.it/opendata/opendata/catalogo/elements1/leaf/?area=Studenti&datasetId=DS1114INFANZIACLASTA
N https://dati.istruzione.it/opendata/opendata/catalogo/elements1/leaf/?area=Studenti&datasetId=DS1115INFANZIACLAPAR
O http://asc.istat.it/asc_BL/
P https://www.asr-lombardia.it/asrlomb/it/13740numero-di-famiglie-convivenze-e-numero-medio-di-componenti-famiglia-regionale
Q https://www.istat.it/it/archivio/236912

12/29

sub-matrices of the data whose entries are consistent with the "ideal" additive model xi, j = µ + αi + τ j , where µ is the typical
value within the bicluster, and αi and τ j are additive adjustments for row i and column j, but we set all αi s to 0 in order to
find constant column biclusters, i.e., sub-matrices with constant columns (covariates). We employed the Cheng and Church
Biclustering Algorithm22 , a greedy algorithm which finds the largest sub-matrices whose departure from the additive model is
below a user-defined threshold. The departure is computed using the H-score (or mean squared residue score); in symbols,
2
1
H(I, J) = |I||J|
∑i∈I, j∈J (xi, j − xI, j ) , where I and J index the sets of rows and columns composing the bicluster, xi, j is a generic
cell in the bicluster and xI, j is the mean of column j. We implemented this algorithm with a recently proposed adjustment to
the H-score23 that corrects a bias towards smaller biclusters in the original formulation. The adjusted H-score is defined as
J−1 q2 −1
r2
Had j (I, J) = (∏I−1
r=2 r2 −1 ∏q=2 q2 −1 ) H(I, J).
Functional Data Analysis tools
Local clustering of curves and functional motif discovery

We performed local clustering of smoothed mortality curves (DPC, ISTAT and MAX, separately) using probabilistic K-mean
with local alignment (probKMA15 ). ProbKMA is a K-mean-like algorithm for functional data that finds K groups in a set of
curves based on a local similarity among portions of the curves themselves. This allows the discovery of functional motifs, i.e. of
typical local shapes that recur within and across the curves. In symbols, the algorithm finds K motifs v1 , . . . , vK , membership
probabilities pk,i and shifts sk,i (i.e. the starting points of the motif instances) for each cluster-curve pair that minimize the
generalized least-squares functional J(v1 , . . . , vK , pk,i , sk,i ) = ∑Ni=1 ∑Kk=1 p2k,i d 2 (x̃i , vk ), where x̃i is the portion of the curve i
corresponding to the shift sk,i , and d is the distance used to capture local similarity. For each data set, we considered K = 2
and K = 3. ProbKMA is probabilistic; it returns as output a membership probability pk,i for each cluster-curve pair. However,
such an output can be turned into a hard partition by assigning each curve to the group with highest membership probability
– which is what we did here. Notably, for K = 2, membership probabilities showed that Lombardia’s and Valle d’Aosta’s
extreme mortality patterns were not well accommodated even in the "exponential" group15 . The algorithm can employ different
definitions of similarity d and thus capture different
aspects of curve shapes. We used Euclidean (L2 ) distance between curve
1 Rc
levels for our main analysis – in symbols, d = c 0 (x(t) − v(t))2 dt for two generic curves x and v – though using Euclidean
distance between curve derivatives produced similar results (not shown). ProbKMA allows the length of the motifs to be
extended endogenously starting from a minimal one fixed in input. However, to identify epidemic patterns we ran it with a
fixed motif length of 65 days – hence allowing a maximum shift of 10 days between curves (the mortality curves are 75 days
long). The same clusters and very similar shifts were obtained with a fixed motif length of 50 days, which allows a maximum
shift of 25 days (results not shown). The shifts produced by probKMA with K = 2 on the three mortality data sets (DPC, ISTAT
and MAX) were employed to align, in addition to the mortality curves themselves, local mobility and positivity curves. All
subsequent analyses employing shifted curves (tests contrasting groups of curves, functional boxplots and depth analyses, and
functional regression models) were therefore restricted to the 65-day portions where mortality curves aligned following the
two probKMA motifs. We also validated the groups produced by probKMA with a modified version of funBI 16 , an algorithm
tipically used for finding functional biclusters. We used the modified funBI to identify groups of curves characterized by
group-specific fixed length motifs, considering all possible sub-curves of a fixed length and clustering them with a divisive
hierarchical algorithm (results not shown).
Testing for differences between groups of curves

We employed an Interval-Wise Testing algorithm developed for omics data (IWTomics17 ) to test for differences between the two
groups of shifted mortality curves produced by probKMA with K = 2 (again, separately for DPC, ISTAT and MAX). IWTomics
is a non-parametric, permutation-based functional hypothesis test. It contrasts two sets of curves aligned on a common domain
to detect locations where the two sets differ significantly, and scales at which such significant differences are displayed (scales
correspond to varying degrees of adjustment for multiple testing on intervals of varying lengths). Here locations are represented
by the 65 days where the shifted mortality curves are defined, while scales vary from 1 day to the whole 65 days. The test was
performed with the R package IWTomics17 . The package allows the user to select among various possible test statistics;
we employed the mean.
Functional boxplots and depth analyses

The functional boxplot19 is an exploratory tool used to visualize functional data. It is constructed after ordering a set of curves
based on a depth measure, such as the modified band depth20 . The statistics employed to construct a functional boxplots are:
the 50% central region envelope, the median curve, and the maximum non-outlying envelope. The 50% central region envelope
corresponds to the box in a classical boxplot; it contains the 50% deepest, most centrally located curves. The median, i.e. the
deepest curve, is inside this box and represents a robust "center" of the functional data set. The maximum non-outlying envelope
is obtained by inflating the 50% central region envelope by 1.5 times its range. All curves extending outside of this envelope
are flagged as outliers (the fact that the ISTAT data set in Fig. 3(b) lacks outlying curves based on this definition is due to the
13/29

width of its 50% central region envelope). We ranked the curves based on their depth measurements, after attributing a sign to
such measurements with an ad hoc procedure. We subtract the median from each curve, and consider the share of the domain
on which the difference is positive. If this is larger than 50%, we attribute a positive sign to the curve’s depth – otherwise, we
attribute a negative sign. Curves can thus be ranked from the most outlying above the median (labeled as positive), down to
those close to the median, down to the most outlying below the median (labeled as negative) – see Fig. 3(b). While this is
not a fully general procedure, it works well on the DPC, ISTAT and MAX mortality curves we considered, which are rather
unambiguously above/below the median (the share of the domain where the difference from the median is positive is ≥ 70
or ≤ 30% for all curves in all three data sets). Note also that the median curve of a data set, defined as the deepest, does not
necessarily have half of the curves above it and half of the curves below it in the signed ranking we created (e.g., Toscana is the
median curve in both ISTAT and MAX data sets, but the number of curves above/below it differs).
Functional regression models

We consider models where a functional response variable is regressed against functional predictors and/or scalar covariates8, 9 .
All are special cases of the general equation21
L

yi (t) = α(t) + ∑

`=1

J

Z

β` (s,t)xi,` (s)ds + ∑ β j (t)xi, j + εi (t) i = 1, . . . n .
j=1

n is the number of observations, in our case n = 20 regions. yi (t), i = 1, . . . n are the aligned mortality curves (DPC, ISTAT
or MAX, modeled separately), α(t) is a functional intercept and εi (t), i = 1, . . . n are i.i.d. Gaussian model errors. L is the
number of functional predictors. xi,` (s), i = 1, . . . n, ` = 1, . . . L, are such predictors, measured on the n observations. The
regression coefficient of each functional predictor, β` (s,t), is a surface. J is the number of scalar covariates. xi, j (s), i = 1, . . . n,
j = 1, . . . J, are such covariates, measured on the n observations. The regression coefficients of each scalar covariate, β j (t),
is a curve. For the marginal regression of mortality on local mobility and mortality on positivity, we have L = 1 and J = 0.
For the joint regression of mortality on local mobility and positivity, we have L = 2 and J = 0. For the marginal regressions
of mortality on individual scalar covariates, we have L = 0 and J = 1. In Fig. S12 we fit marginal regressions of this type
allowing the estimation of two different intercepts: α1 (t) for curves in Group 1 and α2 (t) for curves in Group 2. Finally,
for the joint regression of mortality on local mobility, positivity and one scalar control variable, we have L = 2 and J = 1.
To fit all these functional regressions we used the R package refund33 , which estimates the functional coefficients as
well as their standard errors. We used these standard errors to construct confidence bands around the estimated functional
coefficients. To gauge the explanatory power of each model, we computed the in-sample R2 as well as the Leave-One-Out
Cross-Validation (LOO-CV) R2 . The former is a functional generalization of the classical coefficient of determination defined
as SSreg /(SSreg + SSres ), where SSreg and SSres are the regression and the residual sum of squares, respectively. To compute the
latter, for each observation i, one replaces the fitted response curve ŷi (t) (from the model fitted on all observations) with the
predicted response curve ŷ pred,i (t) obtained for i from the model fitted withholding i itself. Finally, for models with multiple
terms (predictor and/or covariate), the partial R2 of each term is computed as (R2 − R2red )/(1 − R2red ), where R2 is the coefficient
of determination of the complete model, and R2red that of the model comprising all terms but the one being evaluated.
SsNAL-EN for feature selection

SsNAL-EN26 is an efficient algorithm to perform Elastic Net34 feature selection in a standard regression framework, i.e. when
both response and features are scalars. The Elastic Net is a hybrid between LASSO and Ridge, which penalizes both the L1
and the L2 (Euclidean) norm of the regression coefficients. The L1 penalty induces sparsity selecting only the most predictive
among the features. The L2 penalty regularizes coefficient estimates mitigating variance inflation due to collinearity. To perform
feature selection in the functional regression setting, we applied a generalization of SsNAL-EN which incorporates a group
structure in the Elastic Net objective function and uses the Functional Principal Components basis expansion to represent a
functional response. In particular, we performed feature selection for the regression of mortality against all 12 scalar covariates
in Table 1. Notably, we selected the same top 5 features across all three data sets (DPC, ISTAT and MAX) (see Table S1) –
lending strong support to their association with mortality.

References
1. La Rosa, G. et al. SARS-CoV-2 has been circulating in northern Italy since December 2019: evidence from environmental
monitoring. medRxiv 2020.06.25.20140061 (2020).
2. Mugnai, G. & Bilato, C. COVID-19 in Italy: lesson from the Veneto region. Eur. J. Intern. Medicine (2020).
3. Lavezzo, E. et al. Suppression of COVID-19 outbreak in the municipality of Vo’, Italy. Nature (2020).
14/29

4. Wu, X., Nethery, R. C., Sabath, B. M., Braun, D. & Dominici, F. Exposure to air pollution and COVID-19 mortality in the
United States. medRxiv (2020).
5. Coccia, M. Factors determining the diffusion of COVID-19 and suggested strategy to prevent future accelerated viral
infectivity similar to COVID. Sci. Total. Environ. (2020).
6. Binkin, N., Salmaso, S., Michieletto, F. & Russo, F. Protecting our health care workers while protecting our communities
during the COVID-19 pandemic: a comparison of approaches and early outcomes in two italian regions, 2020. medRxiv
(2020).
7. Frumento, P. & Sylos Labini, M. Mortalità da coronavirus: quanto vale l’effetto Lombardia. LaVoce.info (2020).
8. Ramsay, J. O. & Silverman, B. W. Functional data analysis (Springer, 2005), 2 edn.
9. Kokoszka, P. & Reimherr, M. Introduction to functional data analysis (CRC Press, 2017).
10. Ramsay, J. O. & Silverman, B. W. Applied functional data analysis: methods and case studies (Springer, 2007).
11. Ullah, S. & Finch, C. F. Applications of functional data analysis: A systematic review. BMC medical research methodology
13, 43 (2013).
12. Cremona, M. A. et al. Functional data analysis for computational biology. Bioinformatics 35, 3211–3213, DOI:
10.1093/bioinformatics/btz045 (2019).
13. Carroll, C. et al. Time dynamics of COVID-19. medRxiv 2020.05.21.20109405 (2020).
14. Ciminelli, G. & Garcia-Mandicó, S. Covid-19 in Italy: an analysis of death registry data. VOXEU, Centre for Econ. Policy
Res. Lond. 22 (2020).
15. Cremona, M. A. & Chiaromonte, F. Probabilistic K-mean with local alignment for clustering and motif discovery in
functional data. arXiv 1808.04773 (2020).
16. Di Iorio, J. & Vantini, S. funbi: a biclustering algorithm for functional datas. MOX-Report 46/2019 (2019).
17. Cremona, M. A. et al. IWTomics: testing high-resolution sequence-based ’Omics’ data at multiple locations and scales.
Bioinformatics 34, 2289–2291 (2018).
18. Cegolon, L. et al. Hypothesis to explain the severe form of COVID-19 in northern Italy. BMJ Glob. Heal. 5, e002564
(2020).
19. Sun, Y. & Genton, M. G. Functional boxplots. J. Comput. Graph. Stat. 20, 316–334 (2011).
20. López-Pintado, S. & Romo, J. On the concept of depth for functional data. J. Am. Stat. Assoc. 104, 718–734 (2009).
21. Horváth, L. & Kokoszka, P. Inference for functional data with applications, vol. 200 (Springer Science & Business Media,
2012).
22. Cheng, Y. & Church, G. M. Biclustering of expression data. In Proceedings of the 8th International Conference on
Intelligent Systems for Molecular Biology, La Jolla, CA, 93–103 (2000).
23. Di Iorio, J., Chiaromonte, F. & Cremona, M. A. On the bias of h-scores for comparing biclusters, and how to correct it.
Bioinformatics 36, 2955–2957 (2020).
24. Dowd, J. B. et al. Demographic science aids in understanding the spread and fatality rates of COVID-19. Proc. Natl. Acad.
Sci. 117, 9696–9698 (2020).
25. Nepomuceno, M. R. et al. Besides population age structure, health and other demographic factors can contribute to
understanding the COVID-19 burden. Proc. Natl. Acad. Sci. 117, 13881–13883 (2020).
26. Boschi, T., Reimherr, M. & Chiaromonte, F. An efficient semi-smooth newton augmented lagrangian method for elastic
net. arXiv 2006.03970 (2020).
27. Cintia, P. et al. The relationship between human mobility and viral transmissibility during the COVID-19 epidemics in
Italy. arXiv 2006.03141 (2020).
28. Craven, P. & Wahba, G. Smoothing noisy data with spline functions. Numer. mathematik 31, 377–403 (1978).
29. Ramsay, J. O., Wickham, H., Graves, S. & Hooker, G. fda: Functional data analysis. R package version 2.2-6 (2011).
30. Stekhoven, D. J. & Bühlmann, P. Missforest—non-parametric missing value imputation for mixed-type data. Bioinformatics
28, 112–118 (2012).
31. Hastie, T., Tibshirani, R. & Friedman, J. The elements of statistical learning: data mining, inference, and prediction
(Springer Science & Business Media, 2009).
15/29

32. Allison, P. D. Multiple regression: A primer (Pine Forge Press, 1999).
33. Goldsmith, J. et al. Refund: Regression with functional data. R package version 0.1-16 (2016).
34. Zou, H. & Hastie, T. Regularization and variable selection via the elastic net. J. royal statistical society: series B (statistical
methodology) 67, 301–320 (2005).

Acknowledgements
M.A. Cremona acknowledges support from the NSERC. F. Chiaromonte and T. Boschi acknowledge support from the Huck
Institutes of the Life Sciences (Penn State University). F. Chiaromonte and L. Testa acknowledge support from the Sant’Anna
School of Advanced Studies. We are grateful to Paola Cesari, Christian Esposito, Giovanni Felici, Daniele Licari, Andrea Mina
and Flavia Petruso for useful feedback.

Author contributions
All authors conceived ideas and analysis approaches. T.B., J.Di I., L.T. and M.A.C. retrieved and processed data from multiple
public sources, implemented pipelines and performed statistical analyses. All authors interpreted findings and participated to
the writing of the manuscript. M.A.C. and F.C. supervised the research.

Competing interests
The authors declare no competing interests.

16/29

Supplementary Material

mortality MAX
8
6
4
2

2/16
2/20
2/24
2/28
3/03
3/07
3/11
3/15
3/19
3/23
3/27
3/31
4/04
4/08
4/12
4/16
4/20
4/24
4/28

0
2/16
2/20
2/24
2/28
3/03
3/07
3/11
3/15
3/19
3/23
3/27
3/31
4/04
4/08
4/12
4/16
4/20
4/24
4/28

0

2

4

6

8

mortality ISTAT

0

2

4

6

8

mortality DPC
Molise
Piem
Puglia
Sard
Sicilia
Tosc
Tre/Bolz
Umbria
ValAos
Veneto

2/16
2/20
2/24
2/28
3/03
3/07
3/11
3/15
3/19
3/23
3/27
3/31
4/04
4/08
4/12
4/16
4/20
4/24
4/28

●

Abruzz
Basilic
Calabria
Camp
EmRom
Friuli
Lazio
Liguria
Lomb
Marche

Figure S1. Unshifted mortality curves. MAX, ISTAT and DPC mortality curves (per 100,000 inhabitants) without shift.
Vertical lines show the days corresponding to the national lock down (March 9) and the suspension of all non-essential
production activities (March 23).

Table S1. Function-on-scalar feature selection. Top five scalar covariates selected by SsNAL-EN considering as response
the MAX, ISTAT, and DPC mortality curves.
1
2
3
4
5

MAX
Adults per family doctor
Ave. beds per hospital (whole)
Ave. students per classroom
Ave. members per household
Ave. employees per firm

ISTAT
Adults per family doctor
Ave. students per classroom
Ave. beds per hospital (whole)
Ave. employees per firm
Ave. members per household

DPC
Adults per family doctor
Ave. beds per hospital (whole)
Ave. students per classroom
Ave. employees per firm
Ave. members per household

17/29

8
6

2/16
2/20
2/24
2/28
3/03
3/07
3/11
3/15
3/19
3/23
3/27
3/31
4/04
4/08
4/12
4/16
4/20
4/24
4/28

0
8

2/16
2/20
2/24
2/28
3/03
3/07
3/11
3/15
3/19
3/23
3/27
3/31
4/04
4/08
4/12
4/16
4/20
4/24
4/28

0

ISTAT − After shifts

6

Campania
Emilia−Romagna
Lombardia
Veneto

0

0

2

4

Mortality

6

Campania
Emilia−Romagna
Lombardia
Veneto

4

8

DPC − After shifts

2

Mortality

Campania
Emilia−Romagna
Lombardia
Veneto

2

4

Mortality

6

Campania
Emilia−Romagna
Lombardia
Veneto

2

Mortality

ISTAT − Before shifts

4

8

DPC − Before shifts

0

10

20

30

40

50

60

70

0

10

(a)

20

30

40

50

60

70

(b)

Figure S2. Mortality curves. (a): DPC mortality curves (per 100,000 inhabitants) in the 20 Italian regions – before (top) and
after (bottom) the shifts produced by probKMA run with K = 2. (b): ISTAT mortality curves (per 100,000 inhabitants) in the 20
Italian regions – before (top) and after (bottom) the shifts produced by probKMA run with K = 2. In all panels, vertical lines
mark the dates of the national lock-down (March 9) and the suspension of all non-essential production activities (March 23). In
the bottom panels vertical lines still show these dates without shifts, stars on the curves mark the lock-down after the
region-specific shifts.
Table S2. Functional regression models (in-sample) R 2 , LOO-CV R 2 and partial R 2 s. For each functional linear model
which regresses mortality on the covariates listed in the first column, the table reports the (in-sample) R2 , the LOO-CV R2 and
the partial R2 s.

R2

MAX
LOO-CV R2

mob

0.79

0.54

pos

0.75

0.47

mob + pos

0.90

0.52

mob + pos + pc1

0.94

0.70

covariates

R2

ISTAT
LOO-CV R2

-

0.63

0.47

-

0.71

0.44

0.93

0.64

0.93

0.62

partial R2 s

mob: 0.62
pos: 0.53
mob: 0.66
pos: 0.61
pc1: 0.39

R2

DPC
LOO-CV R2

-

0.62

0.33

-

-

0.73

0.47

-

0.90

0.69

0.94

0.68

partial R2 s

mob: 0.74
pos: 0.80
mob: 0.57
pos: 0.67
pc1: 0.03

partial R2 s

mob: 0.66
pos: 0.76
mob: 0.43
pos: 0.57
pc1: 0.00

18/29

Table S3. List of all scalar covariates considered.
Covariate

Year and Source

Resident population, units
Land area, hectares
% population over 65
% population over 70
% population over 80
% population over 85
% male over 18
% female over 18
Employees in large supermarket chains, units
Department stores, units
Supermarkets, units
Ipermarkets, units
Airports, units
Landed and departed passengers in airports, units
Landed and departed airplanes in international flights, units
Healthcare institutes (private and public), units
Public healthcare institutes, units
Days of stay in public and private healthcare institutes
Days of stay in public healthcare institutes
Patients in public and private institutes, units
Patients in public institutes (except for residual psychiatric institutes), units
Beds in pneumatology in public and private healthcare institutes
Mechanical lung ventilators, units
People with at least 1 chronic disease, units
People with at least 2 chronic diseases, units
% people with diabetes
% people with hypertension
% people with bronchitis
% people with osteoporosis
% people with arthritis
% people with allergy
% people with ulcer
Old-age index
Life expectancy at birth (female)
Life expectancy at birth (male)
Active buses per 1000 habitants
% children going to school with public transportation
Public expenditure in healthcare per capita
Factor risk: alcohol
Factor risk: smoke
Factor risk: obesity
Average household income
Mobility index (commuting due to work)
Self-containment index
Public mobility index
PM10
PM2.5
ICU beds per 100K inhabitants
Beds in pneumatology
Additional beds in ICU on April, 10th 2020
Weighted PM10
Average students per classroom
Average students per school
Gini index for schools
Average beds per nursing home (ward)
Average beds per nursing home (whole)
Gini index for nursing homes
Average beds per hospital (ward)
Average beds per hospital (whole)
Gini index for hospitals
Average number of employees
Gini index for firms
Total number of tests between February 25th and April, 30th 2020
Total number of tests between February 25th and March, 23rd 2020
Total number of tests between March, 23rd and April, 30th 2020
Adults per family doctor
Average members per family
Public transport rides per capita

2018, ISTAT
2018, ISTAT
2018, ISTAT
2018, ISTAT
2018, ISTAT
2018, ISTAT
2018, ISTAT
2018, ISTAT
2018, ISTAT
2018, ISTAT
2018, ISTAT
2018, ISTAT
2018, ISTAT
2018, ISTAT
2018, ISTAT
2018, Ministry of Health
2018, Ministry of Health
2015, ISTAT
2015, ISTAT
2015, ISTAT
2015, ISTAT
2015, ISTAT
2018, Ministry of Health
2017, Ministry of Health
2017, Ministry of Health
2017, Ministry of Health
2017, Ministry of Health
2017, Ministry of Health
2017, Ministry of Health
2017, Ministry of Health
2017, Ministry of Health
2017, Ministry of Health
2016, ISTAT
2017, ISTAT
2017, ISTAT
2016, ISTAT
2016, ISTAT
2016, ISTAT
2016, ISTAT
2016, ISTAT
2016, ISTAT
2015, ISTAT
2011, ISTAT
2011, ISTAT
2011, ISTAT
2017, ISTAT
2017, ISTAT
2018, Ministry of Health
2018, Ministry of Health
2020, DPC
2018, ISTAT
2018, Ministry of Education
2018, Ministry of Education
2018, Ministry of Education
2018, Ministry of Health
2018, Ministry of Health
2018, Ministry of Health
2018, Ministry of Health
2018, Ministry of Health
2018, Ministry of Health
2017, ISTAT
2017, ISTAT
2020, DPC
2020, DPC
2020, DPC
2017, Ministry of Health
2018, ASR Lombardia
2017, ISTAT

19/29

Table S4. Variance inflation factors (VIF) for the 12 scalar covariates used in the main analysis.
Covariate

VIF

%65+
%Dbts
%Allrgs
Adlts/doct
ICUBds/cpt
AvBds/hspt
AvBds/nrsg
AvStdns/clrm
AvEmpls/firm
AvMbrs/hshld
PubTrsp/cpt
PM10

11.315684
12.105778
3.933976
4.245479
2.892715
5.012343
2.428207
6.529208
7.854636
6.223056
4.293915
12.858811

20/29

ProbKMA K=2

Adjusted p−value heatmap

Shifts

−R
Em
i

lia

0
2/16
2/20
2/24
2/28
3/03
3/07
3/11
3/15
3/19
3/23
3/27
3/31
4/04
4/08
4/12
4/16
4/20
4/24
4/28

p−value

8
50

10

20

30

40

50

60

1.0
0.8
0.6
0.4
0.2
0.0

●
●
●
●

●
●
●
●●
●●●●

●
●
●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●

10

20

30

40

50

60

4

IWTomics results
Mortality

60

0

10

20

30

40

50

0 2 4 6 8

Mortality
40

0.2
10

0

2
30

0.4

20

Adjusted p−values − 65−day scale

0
20

0.6

30

0.0

6

8
6
4
2

10

40

0

Group 2

0
0

0.8

50

0

Group 1

Mortality

Maximum interval length

6
4
2

Mortality

60

om
ag
Lo Liguna
mb ria
ard
M
Tre Pi arc ia
nt em he
Va o/Bo onte
lle lza
d'A no
A os
Ba bruz ta
s zo
Fri
Cailicat
uli
la a
Ve Cam
ne p bria
zia an
Gi ia
u
La lia
Mo zio
l
P
Sa ugise
rde lia
gn
a
To Sicili
sc a
Umana
b
Ve ria
ne
to

8

1.0

10
8
6
4
2
0

Group 1
Group 2

Group 1
Group 2

60
0

10

20

(a)

30

40

50

60

(b)

ProbKMA K=2

Adjusted p−value heatmap

Shifts

−R
Em

ilia

0
2/16
2/20
2/24
2/28
3/03
3/07
3/11
3/15
3/19
3/23
3/27
3/31
4/04
4/08
4/12
4/16
4/20
4/24
4/28

p−value

8
50

60

20

30

40

50

60

1.0
0.8
0.6
0.4
0.2
0.0

●●●●●●
●
●
●
●
●
●
●
●
●
●●
●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●

10

20

30

40

50

60

Mortality
10

20

30

40

50

0 2 4 6 8

IWTomics results

0

Group 1
Group 2

60
0

(c)

10

4

Mortality
40

0.2
10

0

2
30

0.4

20

Adjusted p−values − 65−day scale

0
20

0.6

30

0.0

6

8
6
4
2

10

40

0

Group 2

0
0

0.8

50

0

Group 1

Mortality

Maximum interval length

4
2

Mortality

6

Group 1
Group 2

60

om
ag
Lo Liguna
mb ria
ard
M
Tre Pi arc ia
nt em he
Va o/Bo onte
lle lza
d'A no
A os
Ba bruz ta
s zo
Fri
Cailicat
uli
la a
Ve Cam
ne p bria
zia an
Gi ia
u
La lia
Mo zio
l
P
Sa ugise
rde lia
gn
a
To Sicili
sc a
Umana
b
Ve ria
ne
to

8

1.0

10
8
6
4
2
0

10

20

30

40

50

60

(d)

Figure S3. Characterizing two epidemics. Results of probKMA and IWTomics on (a)-(b) DPC mortality curves and (c)-(d)
ISTAT curves. (a) and (c): Mortality curves are shown in the top left panel with portions identified by probKMA with K = 2 in
red (Group 1; "exponential" pattern) and blue (Group 2; "flat(tened)" pattern). The curve portions are shown again, this time
aligned with each other and separated by group, in the bottom panels. Black lines indicate group averages. The shifts produced
by probKMA are shown in the top right panel. (b) and (d): Shifted Group 1 and Group 2 mortality curves are tested against
each other with IWTomics. The heatmap at the top shows p-values adjusted at all possible scales (from 1 to 65 days). The
middle panel shows in detail the top-most row of the heatmap; i.e. the p-values adjusted across the whole 65-day interval. The
bottom panel shows again the shifted curves. Gray areas in the middle and bottom panels mark days when the difference
between the two groups is significant (adjusted p-value < 5%).
21/29

0

10

20

30

40

6

8

50

50
60

Group 1
Group 2
Group 3
10
8
6
4
2
0

60
8

4

Mortality

40

6

−R

ilia

Em

2

30

om
a
Liggna
u
Tre PiMarc ria
e
nto m he
/Bo ont
e
A lzan
Ba bruz o
z
s
o
Fri
Cailicat
uli
la a
Ve Cam
ne p bria
zia an
Gi ia
u
La lia
Mo zio
l
P
Sa ugise
rde lia
gn
a
To Sicili
sc a
Umana
b
L V ria
Va ombeneto
lle ar
d'A dia
os
ta

2/16
2/20
2/24
2/28
3/03
3/07
3/11
3/15
3/19
3/23
3/27
3/31
4/04
4/08
4/12
4/16
4/20
4/24
4/28

0

0

0

0

2

2

2

0

0
10

10
20

ProbKMA K=3

Group 1

20
30

30
40

40
50

50

60

4

Mortality

4

Mortality

4

Mortality

6

6

6

8

8

8

Group 1

4

8

8

20

Mortality

6

6

10

4

Mortality

4

Mortality

0
lia
−R

Em
i

2

4

Mortality

om
a
Liggna
u
Tre PiMarc ria
e
nto m he
/Bo ont
e
A lzan
Ba bruz o
z
s
o
Fri
Cailicat
uli
la a
Ve Cam
ne p bria
zia an
Gi ia
u
La lia
Mo zio
l
P
Sa ugise
rde lia
gn
a
To Sicili
sc a
Umana
b
L V ria
Va ombeneto
lle ar
d'A dia
os
ta

2/16
2/20
2/24
2/28
3/03
3/07
3/11
3/15
3/19
3/23
3/27
3/31
4/04
4/08
4/12
4/16
4/20
4/24
4/28

0

6

8

10
8
6
4
2
0

2

2

2

Group 1
Group 2
Group 3

0

0

0

ProbKMA K=3
Shifts

Group 2
Group 3

60
0

0

10

10

20

Group 2

20

30

30

40

(a)

Shifts

Group 3

40

50
60

50

60

(b)

22/29

10
8
6
4
2
0

4

6

Group 1
Group 2
Group 3

2/16
2/20
2/24
2/28
3/03
3/07
3/11
3/15
3/19
3/23
3/27
3/31
4/04
4/08
4/12
4/16
4/20
4/24
4/28

Em
i

lia

0

−R

2

8
6
Mortality

6
0

10

20

30

40

50

60

2
0

0

2

4

Mortality

6
4
0

2

Mortality

Group 3

8

Group 2

8

Group 1

4

Mortality

Shifts

om
a
Liggna
u
Tre PiMarc ria
e
nt m he
Va o/Bo onte
lle lza
d'A no
A os
Ba bruz ta
s zo
Fri
Cailicat
uli
la a
Ve Cam
ne p bria
zia an
Gi ia
u
La lia
Mo zio
l
Sa Pugise
rde lia
gn
a
To Sicili
sc a
Umana
b
Lo Ven ria
mb eto
ard
ia

8

ProbKMA K=3

0

10

20

30

40

50

60

0

10

20

30

40

50

60

(a)

Figure S4. Characterizing three epidemics. Results of probKMA with K = 3 on (a) MAX mortality curves, (b) DPC
mortality curves and (c) ISTAT curves. Mortality curves are shown in the top left panel with portions identified by probKMA
with K = 3 in red (Group 1; "exponential" pattern), blue (Group 2; "flat(tened)" pattern) and green (Group 3; "extreme"
pattern). The curve portions are shown again, this time aligned with each other and separated by group, in the bottom panels.
Black lines indicate the average curves of the group. The shifts produced by probKMA are shown in the top right panel.

positivity

Abruzz
Basilic
Calabria
●

Camp
EmRom
Friuli

Lazio
Liguria
Lomb

2/16
2/20
2/24
2/28
3/03
3/07
3/11
3/15
3/19
3/23
3/27
3/31
4/04
4/08
4/12
4/16
4/20
4/24
4/28

2/16
2/20
2/24
2/28
3/03
3/07
3/11
3/15
3/19
3/23
3/27
3/31
4/04
4/08
4/12
4/16
4/20
4/24
4/28

−1.0

−0.6

−0.2

0.2

0.0 0.1 0.2 0.3 0.4

mobility

Marche
Molise
Piem

Puglia
Sard
Sicilia

Tosc
Tre/Bolz
Umbria

ValAos
Veneto

Figure S5. Unshifted mobility and positivity curves. Local mobility and positivity curves without shift in the 20 Italian
regions. Vertical lines show the days corresponding to the national lock down (March 9) and the suspension of all non-essential
production activities (March 23).

23/29

shifted curves ISTAT
mobility
0.2

Campania
Emilia−Romagna
Lombardia
Veneto

−1.0

0

2

−0.6

4

−0.2

6

Campania
Emilia−Romagna
Lombardia
Veneto

positivity

0

10

20

30

40

50

60

0

10

20

30

40

50

Campania
Emilia−Romagna
Lombardia
Veneto

0.0 0.1 0.2 0.3 0.4

8

mortality

60

0

10

20

30

40

50

60

shifted curves DPC
mobility
0.2

Campania
Emilia−Romagna
Lombardia
Veneto

−1.0

0

2

−0.6

4

−0.2

6

Campania
Emilia−Romagna
Lombardia
Veneto

positivity

0

10

20

30

40

50

60

0

10

20

30

40

50

Campania
Emilia−Romagna
Lombardia
Veneto

0.0 0.1 0.2 0.3 0.4

8

mortality

60

0

10

20

30

40

50

60

Figure S6. Shifted curves for ISTAT and DPC. Mortality (per 100,000 inhabitants), mobility, and positivity curves after the
shifts produced by probKMA with K=2. Vertical lines mark the dates of the national lock-down (March 9) and the suspension
of all non-essential production activities (March 23) without shifts. Stars on the curves mark the lock-down after the
region-specific shifts.

mobility + positivity

mobility + positivity + pc1

0.008
0.006

●
●

0.004

group 1
group 2

0.006

●
●

group 1
group 2

0.004

0.002

0.002

0.000
0.000
−0.002
−0.002

−0.004

Abr
Basilic
Calabria
Camp
EmRom
Friuli
Lazio
Liguria
Lomb
Marche
Molise
Piem
Puglia
Sard
Sicilia
Tosc
Tre/Bolz
Umbria
ValAos
Veneto

(a)

Abruzz
Basilic
Calabria
Camp
EmRom
Friuli
Lazio
Liguria
Lomb
Marche
Molise
Piem
Puglia
Sard
Sicilia
Tosc
Tre/Bolz
Umbria
ValAos
Veneto

−0.004

−0.006

(b)

Figure S7. MAX mortality residuals. (a): residuals of the function-on-function regression of MAX mortality on local
mobility and positivity. (b): residuals of the function-on-function regression of MAX mortality on local mobility, positivity,
and the first principal component of the top 5 covariates. In both panels curves from Group 1 are in red, and curves from Group
2 are in blue. Residuals with positive sign indicate regions for which the true mortality curve is above the estimated mortality
curve. Conversely, residuals with negative sign indicate regions for which the true mortality curve is below the estimated
mortality curve.

24/29

mortality ∼ mobility
MAX

ISTAT

^
β(s,t) − R2 = 0.79

DPC

^
β(s,t) − R2 = 0.63

^
β(s,t) − R2 = 0.62

300
400

500

200
200

400

●

−400

t (m

e)

20
s(
mo 40
bili
ty
t

im

e) 60

group 1
group 2

●

0.08

0.00

●

−100
−200
−300

20
im

e) 60

residuals
0.10

or t

alit

40

20
ob 40
ility
t

residuals
●

−200

alit

or t

alit

or t
t (m

20
s(
m

im

0.01

60

−200

40
−500

20
ob 40
ility
t

0

0

60

40
20
s(
m

100

y tim

y tim

e)

60

−500

0

t (m

0

200
0
−200
−400

e)

0

200

y tim

500

e) 60

residuals
0.03

group 1
group 2

●
●

group 1
group 2

0.02

0.06
0.04

0.01

−0.01
0.02
−0.02

0.00

0.00

Abr
Basilic
Calabria
Camp
EmRom
Friuli
Lazio
Liguria
Lomb
Marche
Molise
Piem
Puglia
Sard
Sicilia
Tosc
Tre/Bolz
Umbria
ValAos
Veneto

Abr
Basilic
Calabria
Camp
EmRom
Friuli
Lazio
Liguria
Lomb
Marche
Molise
Piem
Puglia
Sard
Sicilia
Tosc
Tre/Bolz
Umbria
ValAos
Veneto

Abr
Basilic
Calabria
Camp
EmRom
Friuli
Lazio
Liguria
Lomb
Marche
Molise
Piem
Puglia
Sard
Sicilia
Tosc
Tre/Bolz
Umbria
ValAos
Veneto

−0.02

Figure S8. Associating mortality to mobility. Results from the function-on-function regression of mortality on local
mobility. The top row displays the estimated effect surface (the March 9 date is marked) with respective in-sample R2 (for
LOO-CV R2 see Table S2). The bottom row displays the regression residuals (for barplots interpretation see Fig. S7).
mortality ∼ positivity
MAX

ISTAT

^
β(s,t) − R2 = 0.75

DPC

^
β(s,t) − R2 = 0.71

^
β(s,t) − R2 = 0.73

30
20
20

10

20
siti 40
vity
t

im

●
●

0.01

ime
)

−10

lity
t

ime
)

20
s(
po

−30

40
−20

20
s(
po

20
siti 40
vity
t

im
e) 60

e) 60

residuals
0.04
0.03

−10

20
siti 40
vity
t

im

e) 60

group 1
group 2

60

−10

40

−20

residuals
0.02

0

0

or t
a

t (m

20
s(
po

0

60

t (m

or t
a

40

−10

or t
a

lity
t

−20

t (m

ime
)

60

10

10
0
−10
−20

0

0

10

20

lity
t

10

20

residuals
0.015

●
●

group 1
group 2

●

0.010

●

group 1
group 2

0.02
0.005
0.01

0.00

0.000

0.00
−0.01

−0.01

−0.02

−0.005

−0.02

Abr
Basilic
Calabria
Camp
EmRom
Friuli
Lazio
Liguria
Lomb
Marche
Molise
Piem
Puglia
Sard
Sicilia
Tosc
Tre/Bolz
Umbria
ValAos
Veneto

Abr
Basilic
Calabria
Camp
EmRom
Friuli
Lazio
Liguria
Lomb
Marche
Molise
Piem
Puglia
Sard
Sicilia
Tosc
Tre/Bolz
Umbria
ValAos
Veneto

Abr
Basilic
Calabria
Camp
EmRom
Friuli
Lazio
Liguria
Lomb
Marche
Molise
Piem
Puglia
Sard
Sicilia
Tosc
Tre/Bolz
Umbria
ValAos
Veneto

−0.010

Figure S9. Associating mortality to positivity. Results from the function-on-function regression of mortality on positivity.
The top row displays the estimated effect surface (the March 9 date is marked) with respective in-sample R2 (for LOO-CV R2
see Table S2). The bottom row displays the regression residuals (for barplots interpretation see Fig. S7).

25/29

mortality ∼ mobility + positivity
ISTAT
^
β(s,t) for mobility − partial R2 = 0.74

DPC

^
β(s,t) for positivity − partial R2 = 0.80

^
β(s,t) for mobility − partial R2 = 0.66

^
β(s,t) for positivity − partial R2 = 0.76

400
400

200

20

20
sitiv40
ity
t

im

−200

e) 60

0.002

●

tim
e)

im

e) 60

−100

20
sitiv40
ity
t

residuals

−50

40
20
s(
po

20

e) 60

residuals

0.004
●

60

im

im

e) 60

−100

40

ob 40
ility
t

0

0
−50
−100

60

20
s(
m

−400

50

lity

tim
e)

lity

20
s(
po

−400

−200

40

t (m
or ta

tim
e)

lity

t (m
or ta

40
20
s(
mo 40
bilit
yt

60

−200
−400

−200

0

t (m
or ta

0

60

100
50

100
0
−100
−200

0

tim
e)

0

0
−200
−400

100

200

200

200

100

200

400

lity

200

t (m
or ta

400

0.004

group 1
group 2

0.003

●
●

group 1
group 2

0.002

0.000

0.001
−0.002
0.000
−0.004

−0.001

−0.006

Abr
Basilic
Calabria
Camp
EmRom
Friuli
Lazio
Liguria
Lomb
Marche
Molise
Piem
Puglia
Sard
Sicilia
Tosc
Tre/Bolz
Umbria
ValAos
Veneto

Abr
Basilic
Calabria
Camp
EmRom
Friuli
Lazio
Liguria
Lomb
Marche
Molise
Piem
Puglia
Sard
Sicilia
Tosc
Tre/Bolz
Umbria
ValAos
Veneto

−0.002

Figure S10. Associating mortality to mobility and positivity - ISTAT and DPC. Results from the joint
function-on-function regression of ISTAT and DPC mortality on mobility and positivity. The top row shows the estimated
effect surfaces (the March 9 date is marked) with respective partial R2 (for in-sample R2 and LOO-CV R2 see Table S2). The
bottom row shows the regression residuals (for barplots interpretation see Fig. S7)

mortality ∼ mobility + positivity + reduced PC1
ISTAT
^
β(s,t) for mobility − partial R2 = 0.57

DPC

^
β(s,t) for positivity − partial R2 = 0.67

^
β(s,t) for mobility − partial R2 = 0.43

^
β(s,t) for positivity − partial R2 = 0.57

400

400

150

0

20
sitiv40
ity
t

im

^
β(t) for pc1 − partial R2 = 0.03

40

●

im

im

e) 60

^
β(t) for pc1 − partial R2 = 0.00

0.3

0.002

−0.002

0.000

−0.004

−0.002

−0.006

−100
−150

e) 60

residuals
0.004

0.1

0.4

0.000

−50

40
20
sitiv40
ity
t

0.5

0.8

0.002

group 1
group 2

20
s(
po

20
ob 40
ility
t

residuals
●

−20

or ta

20
s(
m

−400

e) 60

0.004

)

me

lity
ti

−200

im

e) 60

0

60

−100

t (m

20
s(
po

−400

t (m

20

lity
ti

or ta
t (m

20
s(
mo 40
bilit
yt

40

−20

or ta

−200

40

me

me

lity
ti

−200
−400

50

0

60

)

60

)

60

−200
−400

0

0

me

0

)

0

0

100

20

200

200

100

20

200

lity
ti

400

or ta

200

t (m

400

●
●

group 1
group 2

0.0

−0.004

20

30

40

50

60

0

10

20

30

40

50

60

Abr
Basilic
Calabria
Camp
EmRom
Friuli
Lazio
Liguria
Lomb
Marche
Molise
Piem
Puglia
Sard
Sicilia
Tosc
Tre/Bolz
Umbria
ValAos
Veneto

10

−0.1

0

Abr
Basilic
Calabria
Camp
EmRom
Friuli
Lazio
Liguria
Lomb
Marche
Molise
Piem
Puglia
Sard
Sicilia
Tosc
Tre/Bolz
Umbria
ValAos
Veneto

−0.008

Figure S11. Associating mortality to mobility, positivity and first principal component - ISTAT and DPC. Results
from the joint function-on-function regression of ISTAT and DPC mortality on mobility, positivity, and the first principal
component (pc1) of the top 5 covariates, used as a "summary" control. Each panels shows: the estimated effect surfaces for
mobility and positivity and the estimated effect curve for pc1 with respective partial R2 (for in-sample R2 and LOO-CV R2 see
Table S2). For interpretating the regression residuals see Fig. S7.

26/29

marginal β (t) signs: 1 intercept model

●
●
●
●

●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

zeros
●

●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●

positive

●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●

5+ bts rgs oct cpt spt rsg lrm irm hld cpt 10
%6 %D %All lts/d Bds/ ds/h ds/n ns/c pls/f rs/hs Trsp/ PM
Ad ICU AvB AvB vStd vEm vMb Pub
A A A

negative

●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●

DPC

zeros
●
●
●

positive

●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●

●

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●

negative

20 40 60

●
●

20 40 60

●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●

●

0

0

20 40 60

negative

ISTAT

●
●
●
●
●
●
●
●
●
●

5+ bts rgs oct cpt spt rsg lrm irm hld cpt 10
%6 %D %All lts/d Bds/ ds/h ds/n ns/c pls/f rs/hs Trsp/ PM
Ad ICU AvB AvB vStd vEm vMb Pub
A A A

0

MAX

●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●

●

●
●
●
●
●

●

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

zeros
●
●

●
●
●

●
●
●
●
●
●
●

●
●
●
●

●
●
●
●
●
●
●

positive

●
●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●

5+ bts rgs oct cpt spt rsg lrm irm hld cpt 10
%6 %D %All lts/d Bds/ ds/h ds/n ns/c pls/f rs/hs Trsp/ PM
Ad ICU AvB AvB vStd vEm vMb Pub
A A A

marginal β (t) signs: 2 intercepts model

positive

●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●

●
●
●
●
●
●
●
●

5+ bts rgs oct cpt spt rsg lrm irm hld cpt 10
%6 %D %All lts/d Bds/ ds/h ds/n ns/c pls/f rs/hs Trsp/ PM
Ad ICU AvB AvB vStd vEm vMb Pub
A A A

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

negative
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●

●

zeros
●
●

positive
●

●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●

●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●

20 40 60

zeros
●
●

DPC

●
●
●
●
●
●
●

5+ bts rgs oct cpt spt rsg lrm irm hld cpt 10
%6 %D %All lts/d Bds/ ds/h ds/n ns/c pls/f rs/hs Trsp/ PM
Ad ICU AvB AvB vStd vEm vMb Pub
A A A

0

●

20 40 60

negative

ISTAT

0

0

20 40 60

MAX

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

negative
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

●

zeros
●

positive

●
●

●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●

●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●
●
●
●

●
●
●
●

●
●
●
●
●
●
●
●
●
●

●
●
●
●
●
●
●
●
●
●
●

5+ bts rgs oct cpt spt rsg lrm irm hld cpt 10
%6 %D %All lts/d Bds/ ds/h ds/n ns/c pls/f rs/hs Trsp/ PM
Ad ICU AvB AvB vStd vEm vMb Pub
A A A

Figure S12. Marginal function-on-scalar regressions. Results for marginal function-on-scalar regressions. Mortality
curves are regressed against each of the scalar covariates in Table 1. The top-row displays the signs of the effect curves
estimated when just one intercept is included in the model. The bottom-row displays the signs of the effect curves estimated
when we consider two different intercepts for curves in Group 1 and curves in Group 2. Time is on the vertical axis (the
national lock down on March 9, without shift, is marked by a horizontal line). Red, blue and green indicate, respectively,
positive, negative and non-significant portions (i.e., where 95% confidence bands around the estimated effect curve are entirely
above, entirely below, or contain 0).

27/29

MAX

ISTAT

βˆ (t , s ) mobility

βˆ (t , s ) positivity

partial R2=0.49

DPC

βˆ (t , s ) mobility

partial R2=0.69

βˆ (t , s ) positivity

βˆ (t , s ) mobility

βˆ (t , s ) positivity

partial R2=0.76

partial R2=0.37

partial R2=0.72

partial R2=0.49
400

200

400

600
200

100

20
sitiv40
ity
ti

me

partial R2=0.66

20

40

20
s(
po
sitiv40
ity
tim
e) 60

−400

me

partial R2=0.53

) 60

partial R2=0.73

20

20
s(
m

−400

−100

40

20
ob 40
ility
tim
e

0

60

e)

tim

−100
−200

−200

tim

60

e)

60

−200
−400

−200

50
0
−50
−100

or ta
lity

20
s(
mo 40
bilit
y ti

−600

me 60
)

) 60

60
40

0

0

20
s(
po

−200

sitiv40
ity
ti

me 60
)

partial R2=0.55

300

−100

20

) 60

partial R2=0.83

partial R2=0.72

400
100

600
200

me

me

me 60
)

) 60

partial R2=0.60

partial R2=0.57

) 60

partial R2=0.73

20

lity

40
20
s(
po

−100

20
sitiv40
ity

tim

e) 60

) 60

partial R2=0.82

−50

or ta

−200

tim

−50
−100

−100

20
ob 40
ility
tim
e

60

e)

e)

tim

20
s(
m

−400

0

0

60
40

−200

t (m

20

60
40
20
s(
po
sitiv40
ity
tim
e) 60

−600

t (m

20
s(
mo 40
bilit
y ti

−200
−400

−400

or ta

or ta

−500

20
sitiv40
ity
ti

0

−200

50

50

lity

lity

40

100

0

or ta

e)

tim

e)

lity

−300

−500

t (m

20
s(
po

20
ob 40
ility
ti

60

tim

e)

tim

lity

−200

t (m

20
s(
m

0

60
40

0

100

200
100
0
−100
−200

t (m

−500

60

200

0

e)

0

−100

0

200

tim

500

0

200

400

lity

500

40

or ta

2

100

400

or ta

500

t (m

200

300
200
100
0
−100
−200
−300

−50

40

t (m

−400

t (m

20
s(
po

−200

20
ob 40
ility
ti

−200
−400

0

0

50

100

or ta
lity

40

t (m

20
s(
m

−200

e)

tim

or ta
lity

tim

e)

60

40

0

100

t (m

−500

0

e)

−100

60

0

tim

0

200
100

200

or ta
lity

0

200

t (m

0
−100
−200

200

400

e)

200

200

tim

500

100

or ta
lity

1

100

or ta
lity

200

400

t (m

400

partial R2=0.58

partial R2=0.75

600
600

400

partial R2=0.65

20
s(
mo 40
bilit
y ti

−600

partial R2=0.46

) 60

20

40
20
s(
m

−400

20
ob 40
ility
tim
e

ob 40
ility
ti

me

) 60

−400

20
s(
po

20
sitiv40
ity
ti

me 60
)

−400

lity

tim

e)

−100

t (m

−200

me 60
)

partial R2=0.74

20
s(
mo 40
bilit
y ti

20
me

) 60

20
s(
po
sitiv40
ity
tim
e) 60

−100

40

−200
−300

20

100

100

50

50

100
0
−100
−200

0

60

tim
e)

60

−200
−200

−400

100

200

200

−100

lity

40

tim
e)

60

−200
−400

0

0
lity

−200

100

200
0

0
tim
e)

tim
e)

40

e)

sitiv40
ity
ti

40
20
s(
m

t (m
or ta

20

60

−200
−400

20

200

t (m
or ta

20
s(
m

−200

lity

lity

40

t (m
or ta

tim
e)

60

−200
−400

t (m
or ta

5

0

0

20
s(
po

partial R2=0.63

200

200

200
0

0

400

lity

200

200

−40

400

400

400

40

) 60

partial R2=0.81

t (m
or ta

200

60

−100
−200

−20

−60

300

400

or ta

e)

tim

lity

t (m
e)

tim

−50

−200

0

0

60

e)

tim

20
s(
po
sitiv40
ity
tim
e) 60

−300

0

60
40

−200

partial R2=0.75

400

or ta

e)

tim

0

0

20
ob 40
ility
tim
e

) 60

−200

0

0
−50
−100

60

tim
e)

partial R2=0.61

20

100

20

100

−200
−400

me

me 60
)

) 60

200

50

0

lity

tim

lity

−400

−100

200

60
40

200

lity

sitiv40
ity
ti

me

e)

60
40

or ta

lity

or ta

20

partial R2=0.80

40

t (m
or ta

ob 40
ility
ti

20
s(
po

−200

t (m

20

−200

e)

tim

e)

tim

lity

40

or ta
t (m

20
s(
m

0

−200

60
−500

−100

me 60
)

400

or ta

0

60
40

−50

−100

20
sitiv40
ity
ti

200
0

t (m

0
−100
−200

200

0

ob 40
ility
tim
e

partial R2=0.67

t (m

100

20
s(
po

tim

100

−200

20

lity

200

200

0

60
40

or ta

300

400

−100

t (m

600

60

) 60

400

500
0

−600

50

0
−50
−100

40
20
s(
m

partial R2=0.79

100

0

−400

20

100
50

100
0
−100
−200

lity

200

200

) 60

−200

lity

tim

lity

partial R2=0.68

60
40

100

200

or ta

partial R2=0.73

0

20
s(
po
sitiv40
ity
tim
e) 60

−600

20
me

me 60
)

) 60

−400

or ta

20
s(
mo 40
bilit
y ti

−200

200

400
200
0
−200
−400
−600

t (m

sitiv40
ity
ti

40

−400

20

me

−500

−200

t (m

t (m

20
s(
po

e)

60

e)

tim

lity

or ta

−200

20
ob 40
ility
ti

0

0

400

600

or ta

200

60
40

or ta

−100

t (m

tim

e)

60

20
s(
m

0

0
−200
−400

40

4

500

200
0

lity

3

100

200
100
0
−100
−200

200

t (m

400

400

100

200

200

20
s(
po

20
sitiv40
ity

tim

e) 60

Figure S13. Function-on-function regression of mortality on mobility, positivity, and a control scalar covariate. Each
row shows some results from the joint function-on-function regression mortality on local mobility, positivity, and one of the top
5 covariates selected by SsNAL-EN, used as control. In particular, we display the estimated effect surfaces for mobility and
positivity (the March 9 date, without shift, is marked) with their respective partial R2 s. The scalar control covariates associated
with each row are the following: 1: Adults per family doctor, 2: Ave. beds per hospital (whole), 3: Ave. students per classroom,
4: Ave. employees per firm, 5: Ave. members per household

28/29

−50

−100

Figure S14. Exploratory matrix containing scatterplots with loess regression, marginal densities and correlation between
covariates
29/29

