arXiv:2103.02643v1 [stat.ME] 3 Mar 2021

Inference for natural mediation effects under case-cohort
sampling with applications in identifying COVID-19
vaccine correlates of protection
D BENKESER, I DIAZ, J RAN
March 5, 2021
Abstract
Combating the SARS-CoV2 pandemic will require the fast development of effective
preventive vaccines. Regulatory agencies may open accelerated approval pathways for
vaccines if an immunological marker can be established as a mediator of a vaccine’s
protection. A rich source of information for identifying such correlates are large-scale
efficacy trials of COVID-19 vaccines, where immune responses are measured subject to
a case-cohort sampling design. We propose two approaches to estimation of mediation
parameters in the context of case-cohort sampling designs. We establish the theoretical
large-sample efficiency of our proposed estimators and evaluate them in a realistic
simulation to understand whether they can be employed in the analysis of COVID-19
vaccine efficacy trials.

Keywords:

1

vaccines, COVID-19, one-step estimation, efficiency theory

Introduction

The best hope for stemming the SARS-CoV2 pandemic is to develop a safe and effective
preventive vaccine and to distribute the vaccine widely (Corey et al., 2020). Several vaccines
have already been demonstrated to exhibit high efficacy and have been granted emergency
use authorizations around the world (Baden et al., 2021; Polack et al., 2020). However,
supply issues for COVID-19 vaccines remain a pressing concern. Thus, it is of critical
importance to continue to bring new effective vaccines to the market.
An important means of accelerating the vaccine development process is to establish immune correlates of vaccine efficacy. Immune correlates are immunogenicity assays that are
predictive of the vaccine’s effect on infection with SARS-CoV2 and/or COVID-19 disease
(Qin et al., 2007). These immune responses are typically measured shortly after receipt of
the final dose of a vaccine. For SARS-CoV2, scientists are keenly interested in antibody
responses to the vaccine insert SARS-CoV-2 proteins, including binding, pseudovirus neutralizing, and live virus neutralizing antibodies. Discovery and validation of a strong immune
correlate would have an immense impact on SARS-CoV2 vaccine development, as it could
provide a valid surrogate endpoint and thereby open an expedited regulatory pathway for
licensure of vaccine products. Currently, in order to adequately power a Phase III licensure
trial in the U.S., studies are enrolling between 30,000 and 60,000 individuals and following

1

for up to two years. If a licensure pathway were opened based on an immune correlate,
licensure trials could be designed to yield results in weeks rather than years.
Because of the importance of immune correlates to the success of a vaccine development
program, sub-studies of ongoing Phase III randomized trials are designed specifically to
examine immune correlates in a harmonized fashion (Gilbert et al., 2021). There is a wide
body of literature available on statistical approaches for establishing immune correlates.
These methods broadly fall into two classes: correlates of risk and correlates of protection
(also known as, respectively, non-mechanistic and mechanistic correlates of protection).
The former approaches seek to evaluate relative and absolute risks of infection and disease
across levels of an immune response. These methods can be framed as a standard supervised
learning problem, where one is predicting infection/disease status based on one or several
sets of participant information. Mechanistic correlates of protection, on the other hand,
seek to establish a causal relationship between vaccination, immune response and outcome.
There is a rich literature available on statistical approaches based on principal stratification
(Gilbert and Hudgens, 2008; Joffe and Greene, 2009; Li et al., 2010; Wolfson and Gilbert,
2010). An alternative approach is to evaluate immune responses as mediators of the vaccine’s
effect (Cowling et al., 2019).
Mediation is a very deep literature with contributions coming from across many diverse
fields over several decades. VanderWeele (2016) and Nguyen et al. (2020) provide excellent
overviews of current research in the area. In this work, we focus on natural mediation
parameters (Robins and Greenland, 1992; Pearl, 2001). These parameters decompose a
vaccine’s effect into direct pathways (i.e., pathways not involving the measured immune
responses) and indirect pathways (i.e., pathways through the measured immune responses).
Natural indirect effects involve a comparison of two counterfactual risks: (i) the risk of
infection or disease under a hypothetical intervention wherein individuals receive the vaccine,
but rather than allowing the vaccine to determine the level of immune response, we fix their
immune responses to the values they would naturally assume under placebo; (ii) the risk
of infection or disease when individuals receive the vaccine and their immune responses are
allowed to naturally respond to the vaccine. Comparison of these risks yields one causal
effect that quantifies the impact of the immune response on risk of infection and disease.
Identification and estimation of natural mediation effects has been extensively studied
(among others, Petersen et al. (2006); van der Laan and Petersen (2008); Imai et al. (2010);
Tchetgen Tchetgen and Shpitser (2012); Zheng and van der Laan (2012)). However, none
of these approaches is well-suited for use in the sampling frame of COVID-19 vaccine efficacy trials, where immune responses are measured using case-cohort sampling (Breslow
et al., 2013). In this approach, all Phase III trial participants have blood drawn shortly
after receipt of the final vaccination. However, immune responses are only measured in a
stratified random sub-sample (i.e., cohort) of individuals, with inclusion probabilities dependent on participants’ age, race/ethnicity, and SARS-CoV2 baseline serostatus. In order
to adequately power correlates analysis, data are augmented to include immune responses
from all individuals who eventually become infected with SARS-CoV2 (i.e., cases). Thus,
the observed data represent a biased sub-sample of the trial population.
In this work, we describe methods for estimation and inference on natural mediation
effects in this context. Our work builds on past work on multiply robust estimation (Tchetgen Tchetgen and Shpitser, 2012; Zheng and van der Laan, 2012). We combine these
approaches with theory of two-phase sampling (Rose and van der Laan, 2011) to establish
the nonparametric efficiency bound for regular, asymptotically Normal estimators in this
problem. We establish the efficient influence function of these parameters in a nonparamet-

2

ric model, which naturally suggests one-step estimators of the effects of interest. Using these
results we propose two multiply robust estimators. One is derived using a direct application
of the strategy suggested by Rose and van der Laan (2011). The second is novel in that it
relies on a new representation of the efficient influence function. For both estimators, we establish regularity conditions under which they converge weakly to Normal random variables.
Furthermore, we study and compare their performance in finite samples using simulations
targeted towards the design of the randomized COVID-19 vaccine efficacy trials.

2
2.1

Background
Natural mediation effects

Suppose that we have access to a randomized trial that generates independent observations
of the vector X = (W, A, S, C, CY ) ∼ PX , where W is a vector of baseline covariates, A
is the randomized vaccine assignment (A = 0 denotes randomization to placebo, A = 1
to vaccine), S is a vector of immune responses, C is an indicator of full follow-up for a
participant (i.e., that the participant is not lost-to-followup), and Y is the study endpoint
(e.g., infection with SARS-CoV2 or clinical COVID-19 disease). Here, we represent the data
in such a way that the outcome CY is set to zero is C = 0, though this is arbitrary and
does not affect our subsequent developments. Note that this trial is hypothetical, because
in reality we will not have observed the immune responses S for all trial participants.
We assume a model for PX that makes certain positivity assumptions on the conditional
distributions of A, S and C. Specifically, for a0 = 0, 1, we define gA|W (a0 | W ) := PX (A =
a0 | W ) and assume a positivity condition, PX {δA < gA|W (a0 | W ) < 1 − δA } = 1 for some
δA > 0. With respect to censoring, we assume that C does not depend on S, which seems
reasonable in our context since individuals are blinded to the value of their immune response
measurements during the trial. The methods below could easily be adapted to handle the
case where censoring depends on S. Moreover, we define gC (1 | a0 , w) := PX (C = 1 | A =
a0 , W = w) and assume a positivity condition PX {gC (1 | a0 , W ) > δC } = 1 for some δC > 0.
Finally, we make a positivity assumption on the conditional immune response distribution.
For a0 = 0, 1, we denote by qS|a0 ,W (· | W ) the
 conditional density of S given A = a0 , W . We
assume for a1 = 0, 1 and a2 = 1 − a1 , PX {qS|a2 ,W (S | W ) / qS|a1 ,W (S | W )] < ∞ = 1,
which is an assumption of common support of the W -conditional immune response distributions between vaccinated and placebo-recipients. It is possible that this assumption could
be violated in the context of COVID-19 vaccine trials for certain vaccines and particular
immune responses. In particular, for a highly immunogenic vaccine, it may be that all participants have a positive immune response. In this case, there would be positive mass at zero
in the immune response distributions amongst SARS-CoV2 seronegative placebo recipients,
while amongst SARS-CoV2 seronegative vaccine recipients there would always be a positive
immune response. In such cases, one possible path forward is to re-frame the mediation
question, for example, by defining S as a binary fold-rise in antibody response.
Beyond these positivity conditions, our model makes no assumption on the distribution
PX . However, our results apply to settings where additional assumptions are placed on
gA|W and gC , including the possibility that these quantities are known exactly.
We define Y (a, s) as the value Y would assume under a hypothetical intervention that
sets A = a, S = s, and C = 1, though our notation suppresses this latter intervention
for simplicity. Thus, we can define a counterfactual observation X ∗ = (W, S(a1 ), Y (a2 , s) :
∗
(a1 , a2 ) ∈ {0, 1}2 , s ∈ S)) ∼ PX
for some set S.
3

R
∗
∗
∗
We use EX
{f (X ∗ )} = f (x)dPX
(x) to denote the expectation of any PX
-measurable
∗
function f under PX . The effect of the vaccine can be quantified in terms of a ratio of coun∗
∗
terfactual risks, EX
{Y (1, S(1))}/EX
{Y (0, S(0))}. Notice that this is a contrast of average
counterfactual outcomes generated under two distinct interventions. The first intervention
(in the numerator) randomizes a participant to receive vaccine and then sets their immune
response to S(1), that is, the value their immune response would naturally assume under
vaccine. The second (in the denominator), similarly randomizes to placebo and sets immune
responses to their natural value under placebo. This effect can be decomposed as follows:
∗
∗
∗
EX
{Y (1, S(1))} EX
{Y (1, S(0))}
EX
{Y (1, S(1))}
=
∗ {Y (0, S(0))}
∗ {Y (1, S(0))} E ∗ {Y (0, S(0))} ,
EX
EX
X

where the first term is a natural indirect effect and the latter a natural direct effect. The former compares counterfactual risks under interventions that only differ in how they assign S
and thus describes the impact of modulating S on the protective efficacy of the vaccine. The
latter compares interventions that only differ in the vaccination status, thereby evaluating
the impact of the vaccine that is not influenced by S. For brevity, we hence discuss identifi∗
cation and estimation of ψ ∗ (a1 , a2 ) := EX
{Y (a1 , S(a2 ))}, for (a1 , a2 ) ∈ {0, 1}2 , noting that
each of these effects can be written in terms of these quantities.
Under certain causal assumptions, one can show that ψ ∗ (a1 , a2 ) = ψ(a1 , a2 ), where,
using EX to denote expectation under PX ,
ψ(a1 , a2 ) := EX [EX {EX (CY | A = a1 , C = 1, S, W ) | A = a2 , W }] .

(1)

The form of these assumptions has been the subject of debate; see e.g., Zheng and van der
Laan (2012). We omit such a discussion here and focus instead on the statistical estimation
problem of the parameter (1).

2.2

Review of asymptotic linearity and influence functions

An estimator
ψ̂(a1 , a2 ) of ψ(a1 , a2 ) is said to be asymptotically linear if ψ̂(a1 , a2 )−ψ(a1 , a2 ) =
Pn
n−1 i=1 D(PX )(Xi ) + op (n−1/2 ) for some function D(PX ) such that EX {D(PX )(X)} = 0
and EX {D2 (PX )(X)} < ∞. The function D(PX ) is called the influence function of ψ̂(a1 , a2 )
and is a key object for (i) characterizing the asymptotic sampling distribution of the estimator; (ii) establishing an efficiency bound for regular estimators of ψ(a1 , a2 ); (iii) describing
robustness properties of efficient estimators; (iv) constructing efficient estimators.
With respect to the sampling distribution of the estimator, we note that asymptotically
linear estimators are particularly convenient for asymptotic analysis, as their large sample
behavior is described by the weak law of large numbers and the central limit theorem. The
latter implies that n1/2 {ψ̂(a1 , a2 ) − ψ(a1 , a2 )} converges weakly to a random variable with
a mean-zero Normal distribution with variance EX {D2 (PX )(X)}. Influence functions are
also useful for establishing local efficiency of estimators. Because the asymptotic variance
of an asymptotically linear estimator equals the variance of the its influence function, we
can often describe an efficient influence function, that is, the influence function that has the
smallest variability amongst all influence functions of regular, asymptotically linear estimators. An estimator with influence function equal to the efficient influence function is said to
be asymptotically efficient. The influence function can be used to describe which combinations of parameters of PX must be consistently estimated in order to achieve a consistent
estimator of ψ(a1 , a2 ). For many parameters, one can obtain a consistent estimator of the
4

parameter of interest with two or more distinct combinations. We describe such parameters
and estimators as doubly- or multiply-robust.
Influence functions are also used to construct asymptotically linear and efficient estimators via the one-step estimation framework. Suppose we have an estimate of PX , say P̂X ,
that we use to construct a plug-in estimate of ψ(a1 , a2 ), say ψ̂(a1 , a2 ) := ÊX [ÊX {ÊX (CY |
A = a1 , C = 1, S, W ) | A = a2 , W }], where ÊX denotes expectation under P̂X . A one-step
Pn
estimator can be constructed as ψ̂ + (a1 , a2 ) := ψ̂(a1 , a2 ) + n−1 i=1 D(P̂X )(Xi ). Under regularity conditions on P̂X , ψ̂ + (a1 , a2 ) can be shown to be asymptotically linear and efficient.
In practice, as we will soon see, it is often not necessary to estimate the entire distribution PX , but rather only key parameters of the distribution, which we refer to as nuisance
parameters.
The efficient influence function for ψ(a1 , a2 ) is provided in Tchetgen Tchetgen and Shpitser (2012). To write down its form, we first require notation to describe key nuisance
parameters. We define gA|W,S (a0 | W, S) := PX (A = a0 | W, S), the conditional probability
of randomization status given W and S, as well as Q̄Y (W, S) := EX (Y | A = a1 , W, S),
the conditional probability of the outcome. Subsequently, we can define Q̄Q̄Y (W,S) (W ) :=
EX {Q̄Y (W, S) | A = a2 , W } as the conditional mean of Q̄Y (W, S) given A = a2 , W . Finally,
we use QW (w) := PX (W ≤ w) to denote the cumulative distribution function of W . Using
these definitions, we can write the nonparametric efficient influence function for ψ(a1 , a2 )
evaluated on an observation x as
D(PX )(x) :=

1(a = a1 , c = 1)

gA|W,S (a2 | w, s)
{y − Q̄Y (w, s)}
gA|W (a2 | w)gC (1 | a1 , w) gA|W,S (a1 | w, s)
+

1(a = a2 )
{Q̄Y (w, s) − Q̄Q̄Y (W,S) (w)}
gA|W (a2 | w)
Z
+ Q̄Q̄Y (W,S) (w) − Q̄Q̄Y (W,S) (w) dQW (w) .

(2)

The efficient influence function is multiply robust in the sense that it is a valid estimating
equation for ψ(a1 , a2 ) if any of the following conditions holds: (i) Q̄Y and Q̄Q̄Y (W,S) are
correct; (ii) gA|W,S , gA|W , and gC (1 | a1 , ·) are correct; or (iii) Q̄Y , gA|W , and gC (1 | a1 , ·)
are correct. Here we use “correct” to mean equal to the true regression implied by PX .
When it comes to estimation, this robustness will imply that we only need to consistently
estimate certain combinations of these nuisance parameters to obtain a consistent estimate
of ψ(a1 , a2 ).

2.3

Two-phase sampling designs

In the context of COVID-19 vaccines, S is measured subject to case-cohort sampling. The
observed data can thus be represented as n independent copies of O = (W, A, R, RS, C, CY ) ∼
P , where R is an indicator of having S measured. As with Y , we arbitrarily set S = 0
if immune responses are not measured, though this does not impact subsequent developments. We denote by gR (1 | W, A, C, CY ) = P (R = 1 | W, A, C, CY ) the probability of having immune responses measured. Recall that, because all cases are sampled
by design, gR (1 | w, a, 1, 1) = 1 for all w and a, but otherwise will equal to the probability of being randomly selected given covariates and vaccine assignment. The model
for P can be defined in terms of the model described above for PX and a model for the

5

sampling mechanism. The only assumption we make on the sampling mechanism is that
P {gR (1 | W, A, C, CY ) > 0} = 1, which is satisfied by design in COVID-19 vaccine trials.
Rose and van der Laan (2011) provide a convenient characterization of the efficient
influence function for pathwise differentiable parameters in two-phase sampling settings.
Since ψ(a1 , a2 ) is indeed pathwise differentiable and case-cohort sampling is a special case
of general two-phase sampling, we can apply these results directly. Their results imply that
the efficient influence function of ψ(a1 , a2 ) in a nonparametric observed data model for P ,
when evaluated on a typical observation o can be written
r
D(PX )(o)
gR (w, a, c, cy)


r
+ 1−
E{D(PX )(O) | R = 1, W = w, A = a, C = c, CY = cy} .
gR (w, a, c, cy)
(3)
Above, we only need evaluate D(PX ) on observations O such that R = 1 and when R = 1
O = X and thus we are able to evaluate D(PX )(O). Because D(PX ) depends on parameters
of the full data distribution, in the next section we establish identifiability of these quantities
based on the observed data distribution.
The influence function (3) is doubly robust in the sense that it is a valid estimating
equation for ψ(a1 , a2 ) if D(PX ) is a valid estimating function in the full data model and
either gR or E{D(PX )(O) | R = 1, W = w, A = a, C = c, CY = cy} corresponds to the true
value of the regressions implied by P .
D(P )(o) :=

3
3.1

Methods
A classic one-step estimator

A one-step estimator can be constructed directly from the results of Rose and van der Laan
(2011). Recall that one-step estimators involve two ingredients: (i) a plug-in estimator of
the target parameter and (ii) the empirical average of its efficient influence function at the
estimated nuisance parameters evaluated on the observed data.
With respect to (i), we note that a plug-in estimator of ψ(a1 , a2 ) can be obtained via
inverse probability weighted sequential regression. First, we require an estimate gn,R of
gR , if it is unknown. This could be obtained using regression of the binary outcome R
onto W, A, C, and CY . The estimated sampling probabilities are then used to estimate Q̄Y .
Here, we regress the outcome Y onto covariates W and S amongst the subset of data with
R = 1 and A = a1 , while including inverse probability weights R/gn,R (1 | W, A, C, CY ) into
the learning procedure. For example, logistic regression working models could be used with
regression parameters estimated by maximizing an inverse weighted log-likelihood. More
flexible learning approaches could also be adopted. Irrespective of the learning approach
chosen, we let Q̄n,Y denote the estimated regression function. The second step in the
procedure involves evaluating Q̄n,Y (Wi , Si ) for i such that Ri = 1. This prediction serves
as the outcome in a regression onto covariates W amongst the subset of data with R =
1, A = a2 , again including inverse probability weights. Let Q̄n,Q̄Y (W,S) denote the estimated
Pn
regression. A plug-in estimate is obtained as ψn,1 (a1 , a2 ) = n−1 i=1 Q̄n,Q̄Y (W,S) (Wi ).
Inspection of (3) reveals that it involves both the full data efficient influence function
(2) (in the first line), as well as an additional nuisance parameter Q̄D(PX ) (W, A, C, CY ) :=

6

E{D(PX )(O) | R = 1, W, A, C, CY } (second line). To evaluate the full data efficient influence function, we will need estimates of gA|W , gC , and gA|W,S . The randomization probability gA|W is known our example, but in general could be estimated. To maintain generality,
we denote by gn,A|W the estimated regression function. An estimate gn,C of the censoring
probability gC could be obtained via regression of the binary outcome C onto W amongst
observations with A = a1 . Importantly these two regression, do not require inverse probability weights, since the distribution of A, W, and C are observed for everyone. On the other
hand, an estimate gn,A|W,S of gA|W,S would need to involve inverse probability weights, for
example as in a weighted regression of the binary outcome A onto W and S.
Once all of the above regressions have been estimated, we can replace the true nuisance
parameters in (2) with their estimated counterparts and evaluate the expression for all Oi
such that Ri = 1,
D̂X (Oi ) :=

1(Ai = a1 , Ci = 1)

gn,A|W,S (a2 | Wi , Si )
{Yi − Q̄n,Y (Wi , Si )}
gn,A|W (a2 | Wi )gn,C (1 | a1 , Wi ) gn,A|W,S (a1 | Wi , Si )
+

1(Ai = a2 )
gn,A|W (a2 | Wi )

{Q̄n,Y (Wi , Si ) − Q̄n,Q̄Y (W,S) (Wi )}

(4)

+ Q̄n,Q̄Y (W,S) (Wi ) − ψn,1 (a1 , a2 ) .
Next, we obtain an estimate Q̄n,D(PX ) of the additional nuisance parameter Q̄D(PX ) by
regressing the pseudo-outcome D̂X (Oi ) onto Wi , Ai , Ci , Ci Yi amongst observations with
Ri = 1. The estimated efficient influence function is

Ri
D̂X (Oi )
D̂1 (Oi ) :=
gn,R (1 | Wi , Ai , Ci , Ci Yi )



Ri
Q̄n,D(PX ) (Wi , Ai , Ci , Ci Yi ) .
+ 1−
gn,R (1 | Wi , Ai , Ci , Ci Yi )
Pn
+
The one-step estimator is ψn,1
(a1 , a2 ) := ψn,1 (a1 , a2 ) + n−1 i=1 D̂1 (Oi ).
We have the following theorem describing the behavior of the one-step estimator.
We
R
write the squared L2 (P )-norm of a square-integrable function f as ||f ||2P := f (o)2 dP (o).
Let Q̄D(P̂X ) (W, A, C, CY ) := E{D̂1 (O) | W, A, C, CY } and Q̄Q̄n,Y (W,S) (W ) = EX {Q̄n,Y (W, S) |
A = a2 , W }.
Theorem 1. Assume the following conditions:
A1 supw |gn,A|W (a1 | w) − gA|W (a1 | w)| = op (1) and ||gn,A|W (a1 | ·) − gA|W (a1 | ·)||P =
op (n−1/4 )
A2 supw |gn,C (1 | a1 , w) − gC (1 | a1 , w)| = op (1) and ||gn,C (1 | a1 , ·) − gC (1 | a1 , ·)||P =
op (n−1/4 )
A3 supw,s |gn,A|W,S (a1 | w, s)−gA|W,S (a1 | w, s)| = op (1) and ||gn,A|W,S (a1 | ·)−gA|W,S (a1 |
·)||PX = op (n−1/4 )
A4 ||Q̄n,Y − Q̄Y ||PX = op (n−1/4 )
A5 ||Q̄n,Q̄Y (W,S) − Q̄Q̄n,Y (W,S) ||PX = op (n−1/4 ) and ||Q̄n,D(PX ) − Q̄D(P̂X ) ||P = op (n−1/4 )

7

A6 ||D̂1 − D(P )||2P = op (1) and D̂1 falls in a P -Donsker class with probability tending to
1.
+
Under these assumptions n1/2 {ψn,1
(a1 , a2 )−ψ(a1 , a2 )} converges in distribution to a random
2
variable with a Normal(0, E{D (P )(O)}) distribution.

We provide a proof in the web supplement. The uniform consistency assumptions in
A1-A3 ensure estimates of treatment and censoring probabilities are bounded away from
zero. The L2 rate conditions in A1-A5 ensure negligibility of a second-order remainder
term. The n−1/4 convergence rates are sufficient for the results of the theorem, but could
also be weakened to conditions involving the product of rates for various combinations of
nuisance parameters. We note that the n−1/4 rate is slower than the standard parametric
rate of n−1/2 , implying that flexible regression techniques could be used. However, due to
the curse of dimensionality, in settings with even moderately large dimensions of S or W ,
the n−1/4 rates may be difficult to achieve without further smoothness assumptions. For
example, the highly adaptive lasso assumes that the nuisance functions have variation norm
bounded by a constant and achieves requisite L2 convergence irrespective of the dimension
of the regression (Benkeser and van der Laan, 2016). However, this bounded variation
condition can be rather stringent in higher dimensions. Assumption A6 is needed to ensure
that an empirical process term is negligible (van der Vaart and Wellner, 1996), but could
be removed by using cross-fitting as in Zheng and van der Laan (2011) and Chernozhukov
et al. (2017).
The robustness of the full- and observed-data efficient influence functions imply that
+
ψn,1
(a1 , a2 ) is consistent if: (i) either (i.a) Q̄n,Y and Q̄n,Q̄Y (W,S) are consistent for their
respective targets or (i.b) gn,A|W,S , gn,A|W , and gn,C (1 | a1 , ·) are consistent or (i.c) Q̄n,Y ,
gn,A|W , and gn,C (1 | a1 , ·) are consistent and (ii) either (ii.a) gn,R is consistent for gR or
(ii.b) Q̄n,D(PX ) is consistent for Q̄D(PX ) .
Pn
2
Under the assumptions of the theorem, we also have that σn,1
= n−1 i=1 {D̂1 (Oi ) −
Pn
+
(a1 , a2 )
n−1 j=1 D̂1 (Oj )}2 is a consistent estimate of the asymptotic variance of n1/2 ψn,1
that can be used to construct Wald-type confidence intervals.

3.2

An alternative one-step estimator

Our second estimator differs both in terms of the construction of the plug-in estimator, as
well as in the form of the efficient influence function used in the one-step estimator. Both
changes are the result of a more explicit examination of Q̄D(PX ) in (3). We define

Q̃D(PX ) (W, A, C, CY ) := E

1(A = a1 , C = 1)

gA|W,S (a2 | W, S)
gA|W (a2 | W )gC (1 | a1 , W ) gA|W,S (a1 | W, S)

× {Y − Q̄Y (W, S)} | R = 1, W, A, C, CY

which is similar to Q̄D(PX ) , but only involves the first term in D(PX ). We also define
Q̃Q̄Y (W,S) (W, A, C, CY ) := E{Q̄Y (W, S) | R = 1, W, A, C, CY }, and Q̃Q̃(W,A,C,CY ) (W ) =
E{Q̃Q̄Y (W,S) (W, A, C, CY ) | A = a2 , W }. In the appendix, we show that Q̃Q̃(W,A,C,CY ) =
Q̄Q̄Y (W,S) defined above.

8

,

Using the above-defined nuisance parameters, we can rewrite (3) as follows,
D(P )(o) :=

gA|W,S (a2 | w, s)
r
1(a = a1 , c = 1)
{y − Q̄Y (w, s)}
gR (w, a, c, cy) gA|W (a2 | w)gC (1 | a1 , w) gA|W,S (a1 | w, s)
+

1(a = a2 )
r
{Q̄Y (w, s) − Q̃Q̄Y (W,S) (w, a, c, cy)}
gR (w, a, c, cy) gA|W (a2 | w)
1(a = a2 )
{Q̃
(w, a, c, cy) − Q̃Q̃(W,A,C,CY ) (w)}
gA|W (a2 | w) Q̄Y (W,S)
Z
+ Q̃Q̃(W,A,C,CY ) (w) − Q̃Q̃(W,A,C,CY ) (w)dQW (w)

+

−

(5)

Q̃D (w, a, c, cy)
{r − gR (1 | w, a, c, cy)} .
gR (1 | w, a, c, cy)

To construct a one-step estimator based on this representation, we describe construction of
a plug-in estimate and an approach for evaluating the one-step correction term.
For the plug-in estimator, we begin as above by obtaining Q̄n,Y , an estimate of Q̄Y
using inverse weighted regression and evaluating Q̄n,Y (Wi , Si ) for all i such that Ri = 1.
We then use these estimates as the outcome in a regression onto W, A, C, CY amongst
those with R = 1, which yields an estimate Q̃n,Q̄Y (W,S) of Q̃Q̄Y (W,S) . Similarly, we evaluate Q̃n,Q̄Y (W,S) (Wi , Ai , Ci , Ci Yi ) for i = 1, . . . , n and use this as the outcome in a regression onto W amongst those with A = a2 , thereby providing an estimate Q̃n,Q̃(W,A,C,CY ) of
Pn
Q̃Q̃(W,A,C,CY ) . Finally, the plug-in estimator is ψn,2 (a1 , a2 ) := n−1 i=1 Q̃n,Q̃(W,A,C,CY ) (Wi ).
With the estimates of the sequential outcome regression described above and the estimates of and gR , gA|W , gA|W,S described above, the only additional nuisance parameter
estimate we require is one of Q̃D . Such an estimate can be obtained by evaluating
D̂X,1 (Oi ) :=

gn,A|W,S (a2 | Wi , Si )
1(Ai = a1 , Ci = 1)
{Yi − Q̄n,Y (Wi , Si )}
gn,A|W (a2 | Wi )gn,C (1 | a1 , Wi ) gn,A|W,S (a1 | Wi , Si )

for all i such that Ri = 1. The quantity D̂X,1 (Oi ) then serves as an outcome in a regression
onto Wi , Ai , Ci , Ci Yi , yielding an estimate Q̃n,D of Q̃D .
We denote by D̂2 the efficient influence function in (5), but with true nuisance parameters
substituted with their estimated counterparts, just as we did in (4) for the classic
esPone-step
n
+
timator. Our proposed one-step estimator is ψn,2
(a1 , a2 ) = ψn,2 (a1 , a2 ) + n−1 i=1 D̂2 (Oi ).
We have the following theorem describing its behavior. Let Q̃D(P̂X ) (W, A, C, CY ) = E{D̂2,1 (O) |
W, A, C, CY } and Q̃Q̄n,Y (W,S) (W, A, C, CY ) := E{Q̄n,Y (W, S) | R = 1, W, A, C, CY }.
Theorem 2. Assume conditions A1-A4 of Theorem 1. Additionally assume
B5 ||Q̃n,Q̄Y (W,S) − Q̃Q̄n,Y (W,S) ||P = op (n−1/4 ) and ||Q̃n,Q̃(W,A,C,CY ) − Q̃Q̃(W,A,C,CY ) ||P =
op (n−1/4 )
B6 ||Q̃n,D(PX ) − Q̃D(P̂X ) ||P = op (n−1/4 )
B7 ||D̂2 − D(P )||2P = op (1) and D̂2 falls in a P -Donsker class with probability tending to
1.

9

Under these assumptions n1/2 {ψn,2 (a1 , a2 )−ψ(a1 , a2 )} converges in distribution to a random
variable with a Normal(0, E{D2 (P )(O)}) distribution.
The conditions are similar to those of Theorem 1. The estimator ψn,2 (a1 , a2 ) is also
multiply robust in the sense of the classic one-step estimator, but where we replace (i.a)
with condition (i.a’) Q̄n,Y , Q̃n,Q̃(W,A,C,CY ) are consistent for their respective targets and
replace (ii.b) with condition (ii.b’) Q̃n,D(PX ) is consistent for Q̃D(PX ) and Q̃n,Q̄Y (W,S) is
Pn
2
consistent for Q̃Q̄Y (W,S) . Under the assumptions of the theorem, σn,2
= n−1 i=1 {D̂2 (Oi )−
Pn
n−1 j=1 D̂2 (Oj )}2 is a consistent estimate of the asymptotic variance of n1/2 ψn,2 (a1 , a2 ).
We provide a detailed theoretical comparison of the two one-step estimators in the supplementary materials.

4

Practical considerations in the context of COVID vaccines

We turn to a discussion of the implications of our theoretical results on planning for the
analysis of randomized trials of COVID vaccines. First, since we are in the context of a
randomized trial, gA|W is known exactly. Thus, the conditions pertaining to consistent
estimation of this quantity are easily satisfied. For example, we could use the known randomization probabilities or fit a low-dimensional parametric regression to adjust for chance
imbalances in covariates. Similarly, the sampling probability gR is known by design. If we
use the known sampling probability in the estimation procedure, then we can use any estimator of Q̄D(PX ) (or, for the alternative one-step, Q̃D(PX ) ) and the results of the theorem
hold irrespective of the consistency of Q̄n,D (Q̃n,D ). All that we need is that these estimates
converge to something at a reasonable rate.
Second, we comment on estimation of regression quantities that involve conditioning on
C and CY . Note that there are three categories into which a participant’s data may fall,
right-censored (C = 0, CY = 0), not right-censored and not a case (C = 1, CY = 0), and
not right-censored and a case (C = 1, CY = 1). Thus, for regression quantities that require
conditioning on these data, we can construct dummy variables for two of these cases to
include in the regression.
Third, in the above developments, we have left unspecified which regression techniques
may be used to estimate the nuisance parameters. We provide a software implementation
that implements two specific approaches, but also that allows users to define their own
regression approaches. Specifically, we adopt approaches based on working linear or logistic
(depending on the parameter space of the particular nuisance parameter) regression models,
as well as based on super learner (van der Laan et al., 2007). In the latter approach, one
defines a pre-specified library of candidate regression estimators. The resultant regression
estimator is a convex combination of the library of candidate estimators where the weights
are selected by minimizing a cross-validated risk criterion.

10

5
5.1

Simulations
Confirming theoretical properties of estimators

The goal of this simulation was to verify the statistical properties of our estimators as established by our theorems. Accordingly, we used a discrete data generating process so that
it was possible to (i) numerically approximate the efficiency bound and (ii) use nonparametric maximum likelihood estimators for nuisance parameters thereby guaranteeing that
requisite regularity conditions required by our theorems were satisfied. We generated data
as follows. A bivariate variable W = (W1 , W2 ) was generated by independently drawing two
Bernoulli(1/2) variables. Given W = w, a binary treatment A was generated according to a
Bernoulli distribution with gA|W (1 | w) = expit(w1 − w2 ). Given W = w and A = a, S was
drawn from a Binomial(2, p(a, w)) distribution with p(a, w) = expit(−1+w1 /4−w2 /3+a/2).
Given W = w, A = a, S = s, a binary outcome Y was drawn from a Bernoulli distribution
with P (Y = 1 | W = w, A = a, S = s) = expit(−2 + a/2 + w1 /2 − s/2), while C was
drawn from a Bernoulli distribution with gC (1 | a, w) = expit(2 + w1 /2 − w2 /3). Subsequently, case-cohort sampling was applied to S, by sampling a random 1/4 of the cohort,
in addition to all observations with CY = 1. We evaluated our two proposed estimators of
ψ(1, 0), the true value of which was approximately 0.187 with efficient variance bound equal
to E{D2 (P )(O)} = 0.509.
For each sample size n ∈ {500, 1000, 2000, 4000, 8000}, we simulated 1000 data sets
from this data generating process and computed our two proposed estimators along with a
confidence interval for ψ(1, 0). We evaluated the estimators in terms of their bias (scaled
by n1/2 ), their standard error (scaled by n1/2 ), the coverage probability of a nominal 95%
confidence interval, and the ratio of the scaled standard error to the square root of the
efficient variance.
We first evaluated estimators under the conditions of the theorem where all nuisance
parameters are consistently estimated at appropriate rates. To achieve this, we used parsimonious logistic regression models for gA|W , gC , gR , Q̄Y and fully saturated logistic regression models (i.e., nonparametric maximum likelihood estimates) for the remaining nuisance
parameters. In this setting, our theory predicts that bias of the estimators should converge
to zero faster than n−1/2 , the scaled standard error of the estimators should converge to the
square root of the efficiency bound, and confidence intervals should attain nominal coverage.
After confirming asymptotic properties in the setting with consistently estimated nuisance parameters, we subsequently studied six scenarios in which various combinations of
nuisance parameters were misspecified. The six scenarios that we studied are ones in which
our multiple robustness results imply that the one-step estimators should remain consistent. In these settings, certain nuisance parameters were inconsistently estimated by using
a simple intercept-only regression model (i.e., the sample average of the outcome of the
regression). In these settings, our results suggest that we should still see diminishing bias
and stabilizing scaled standard error as sample size increases. However, neither estimators’ influence function will equal the efficient influence function. Consequently, we expect
non-nominal coverage probabilities for the confidence intervals.
The results of the simulation results confirmed our theory and estimators enjoyed expected behavior in all settings considered (Table 1). In the setting where all nuisance parameters were consistently estimated, the two one-step estimators had similar performance
across the board. However, in settings where the regression of the full data efficient influence
+
function was inconsistently estimated, the alternative one-step estimator ψn,2
(1, 0) tended

11

to have higher variability.

5.2

Evaluating estimators in the context of COVID vaccine trials

In our second simulation, we wished to study the finite-sample performance of our estimators in a setting similar to what might be expected in a correlates study of a COVID-19
vaccine. To that end, we developed a data generating process meant to mimic the expected data outputs of a large (n = 30000), placebo-controlled trial. We simulated a threedimensional covariate W = (W1 , W2 , W3 ) with three Bernoulli-distributed components with
success probabilities of 2/5, 1/4, 1/4, meant to represent measurements of participants’
age (≥ 65 vs. < 65 years old), racial/ethnic minority status (yes vs. no), and presence of
COVID-19 risk factors (yes vs. no). For each simulated participant, we drew their randomization assignment A from a Bernoulli(1/2) distribution. A continuous immune marker
was then generated as follows. Given W1 = w1 , we drew S ∗ from a Normal(2 - 0.5 w1 , 1)
distribution. Next, given A = a, we set S = a1(S ∗ > 0)S ∗ . That is, placebo recipients
uniformly have S = 0, which is reasonable as the primary analysis of COVID-19 trials focuses on previously uninfected individuals. For individuals in the vaccine arm, there are
some “vaccine failures,” that is individuals in whom the vaccine fails to induce a positive
immune response. Under our simulation setting, the probability of failure increases with
age. Given W = w, S = s, A = a we set the probability of having an observed COVID-19
disease endpoint as expit(α − 0.5s − 1.8a + 0.2w1 + 0.1w2 + 0.7w3 ). Note that the parameter
α controls the total number of breakthrough endpoints. We considered performance of our
estimators under several values of α that may be realistic for COVID vaccine efficacy studies. Under this data generating process, the vaccine has high efficacy, as was observed with
the first reported COVID-19 vaccines. For simplicity, we assumed there was no censoring
of endpoints. The corresponding true parameter values for each setting we considered is
shown in Table 2.
Two-phase sampling of S was simulated according to the sampling plan developed for
all Phase 3 trials run in the United States (Gilbert et al., 2021). In this design, a stratified
random sample is drawn based on the sixteen strata defined by W and A. Specifically,
113 vaccine recipients and 15 placebo recipients are sampled from each of the eight strata
defined by W . All observed COVID-19 endpoints are additionally sampled.
We were interested primarily in comparing the two one-step estimators in terms of their
performance at realistic sample sizes in terms of point estimation and confidence interval
coverage for the indirect effect ψ(1, 1)/ψ(1, 0) and for the proportion mediated, defined as
1−log{ψ(1, 0)/ψ(0, 0)}/log{ψ(1, 1)/ψ(0, 0)}, as these are two key parameters for establishing
vaccine correlates. For each setting described above, we simulated 1000 data sets and
computed the two one-step point estimates and confidence intervals.
We repeated the simulation under several different modeling strategies for nuisance parameters. The first considered regression models that included all possible interactions between regressors, where S was modeled as a linear term. In this approach, we do not expect
that the nuisance parameters are consistently estimated, though the bias from model misspecification is expected to be relatively small. Our second strategy for nuisance parameter
estimation considered using the super learner. In our analysis, we used four different regressions that included a main-terms generalized linear model, a stepwise generalized linear
model that included all two-way interaction terms, an intercept-only model, and polynomial multivariate adaptive regression splines. Due to the added flexibility of the ensemble
model, we believe this approach should come closer to consistent estimation of the nuisance

12

parameters. However, it is a highly data-driven and so we wished to evaluate whether it
could be appropriately employed at these sample sizes. Finally, we considered using simple
main-terms regression models that did not include any interactions between variables. These
models were expected to have the worst performance in modeling the nuisance parameters
and served as a “worst-case scenario” in our simulation. We report on the generalized linear
models with interaction and super learner results in the body and describe the misspecified
main terms models in the supplement.
For both one-step estimators and irrespective of the nuisance parameter estimation approach, we found that when events were very rare in the vaccine group, the estimators
exhibited considerable bias. In these rare-event settings, confidence intervals for the indirect effect and proportion mediated had slightly less than nominal coverage. However, as the
number of expected events amongst the vaccinated rose to around 50, the bias of the estimators decreased to a reasonable level and the confidence intervals attained nominal coverage
probabilities. Comparing the two modeling strategies, we found comparable results between
the GLM with interactions and the SuperLearner. Comparing the two one-step estimators,
we saw similar performance in terms of bias and confidence interval coverage. However,
we found that confidence intervals for the standard one-step estimator when combined with
super learner tended to be more erratic (Figure 1). The same phenomenon was not observed
when the GLM with interactions was used to estimate nuisance parameters (Figure 2).

Figure 1: Indirect effect confidence intervals using classic (left column) and alternative (right
column) one-step estimators constructed using super learner to estimate nuisance quantities.
The confidence intervals are ordered across the 1000 simulations from smallest to largest
and are displayed on the log scale. In the rare event setting (α = −5), we include a subfigure
that is zoomed in and has the extreme confidence intervals removed.

13

Figure 2: Indirect effect confidence intervals using classic (left column) and alternative (right
column) one-step estimators constructed using GLMs with interactions to estimate nuisance
quantities. The confidence intervals are ordered across the 1000 simulations from smallest
to largest and are displayed on the log scale. In the rare event setting (α = −5), we include
a subfigure that is zoomed in and has the extreme confidence intervals removed.
We found that basing inference on the misspecified main terms models tended to lead
to estimators with non-negligible bias and conservative inference, with confidence interval
coverage probabilities near to 1 (Supplemental material). However, we did find more robust
performance of the alternative one-step estimator relative to its standard counterpart.
Overall, we found that the estimators performed reasonably well in all but the smallest
sample sizes considered. We also found that using super learning to estimate nuisance
parameters appears acceptable even in settings with a limited number of observed events.
The supplemental material contains additional simulation results for operating characteristics of the estimators of the counterfactual risk parameters ψ(a1 , a2 ). Of note, we show
+
there that the classic one-step estimator ψn,1
(1, 0) < 0 for a non-negligible fraction of simulations. The results are particularly bad for the misspecified nuisance models. However,
+
even with super learner ψn,1
(1, 0) was less than zero up to 5% of simulated data sets. On
the other hand, the alternative one-step estimator was always positive.

6

Discussion

A central contribution of this study is establishing that nonparametric estimators of mediation effects can reasonably be employed in the analysis of COVID-19 correlates data
assuming a reasonable number (≈ 50) of vaccine breakthrough cases are observed. The fact
that super learner can be used to estimate nuisance parameters while retaining reasonable

14

operating characteristics is highly appealing given (i) the inherent complexity of some of
the nuisance parameters that need to be estimated as part of our procedure (e.g., Q̃D(PX ) )
and (ii) our limited understanding of the interaction between patient-level COVID-19 risk
factors and vaccine-induced immune responses on risk of COVID-19.
Beyond this practical contribution, we believe that the alternative approach outlined
to one-step estimation is also a valuable contribution to the literature on estimation of
pathwise differentiable parameters in two-phase sampling designs. An attractive feature of
this alternative approach is the decoupling of estimation of the sampling probabilities and
estimation of full-data nuisance parameters. This should provide more practical avenues for
achieving a robust estimator in settings where sampling probabilities are unknown. However,
the results of the simulations were mixed in terms of the performance of this alternative onestep estimator vs. the standard one. In our COVID-19-oriented simulation, we saw more
stable inference in small samples using the alternative one-step. The alternative estimator
of ψ(1, 0) never slipped below 0, while this occurred with some frequency for the classic
estimator. However, in the large sample simulation, we saw that the alternative one-step
may not be as robust to certain forms of nuisance parameter misspecification. A careful
comparison of these estimation approaches across a more diverse set of scenarios is warranted
and is an important direction for future research.
Another potential area for expanding this work area is in developing a targeted minimum
loss-based estimation (TMLE) framework for estimation of these mediation parameters.
As substitution estimators, TMLEs enjoy the property of being guaranteed to fall in the
parameter space. This property may be particularly important in the context of studies
of highly effective COVID-19 vaccines where risks of disease amongst the vaccinated are
extremely small. Very modest one-step correction terms can easily push estimators below
zero, as we saw in the simulation study. TMLEs would likely enjoy more robust behavior
in these settings.

Data Availability Statement
The code needed to reproduce the both simulation studies is available on in a GitHub
repository at https://github.com/benkeser/natmed2 sims.

References
Baden, L. R., El Sahly, H. M., Essink, B., Kotloff, K., Frey, S., Novak, R., Diemert, D.,
Spector, S. A., Rouphael, N., Creech, C. B., et al. (2021). Efficacy and safety of the
mRNA-1273 SARS-CoV-2 vaccine. New England Journal of Medicine, 384(5):403–416.
Benkeser, D. and van der Laan, M. (2016). The highly adaptive lasso estimator. In 2016
IEEE International Conference on Data Science and Advanced Analytics (DSAA), pages
689–696. IEEE.
Breslow, N. E., Amorim, G., Pettinger, M. B., and Rossouw, J. (2013). Using the whole
cohort in the analysis of case-control data. Statistics in Biosciences, 5(2):232–249.
Chernozhukov, V., Chetverikov, D., Demirer, M., Duflo, E., Hansen, C., and Newey, W.
(2017). Double/debiased/neyman machine learning of treatment effects. American Economic Review, 107(5):261–65.
15

Corey, L., Mascola, J. R., Fauci, A. S., and Collins, F. S. (2020). A strategic approach to
COVID-19 vaccine R&D. Science, 368(6494):948–950.
Cowling, B. J., Lim, W. W., Perera, R. A., Fang, V. J., Leung, G. M., Peiris, J. M., and
Tchetgen Tchetgen, E. J. (2019). Influenza hemagglutination-inhibition antibody titer
as a mediator of vaccine-induced protection for influenza B. Clinical Infectious Diseases,
68(10):1713–1717.
Dı́az, I., Hejazi, N. S., Rudolph, K. E., and van der Laan, M. J. (2020). Non-parametric
efficient causal mediation with intermediate confounders. Biometrika.
Gilbert, P. B., Fong, Y., Benkeser, D., et al. (2021). OWS CoVPN COVID-19 vaccine
efficacy trial immune correlates statistical analysis plan.
Gilbert, P. B. and Hudgens, M. G. (2008). Evaluating candidate principal surrogate endpoints. Biometrics, 64(4):1146–1154.
Imai, K., Keele, L., and Yamamoto, T. (2010). Identification, inference and sensitivity
analysis for causal mediation effects. Statistical Science, 25(1):51–71.
Joffe, M. M. and Greene, T. (2009). Related causal frameworks for surrogate outcomes.
Biometrics, 65(2):530–538.
Li, Y., Taylor, J. M., and Elliott, M. R. (2010). A bayesian approach to surrogacy assessment
using principal stratification in clinical trials. Biometrics, 66(2):523–531.
Nguyen, T. Q., Schmid, I., and Stuart, E. A. (2020). Clarifying causal mediation analysis
for the applied researcher: Defining effects based on what we want to learn. Psychological
Methods.
Pearl, J. (2001). Direct and indirect effects. Proceedings of the Seventeenth Conference on
Uncertainty in Artificial Intelligence.
Petersen, M. L., Sinisi, S. E., and van der Laan, M. J. (2006). Estimation of direct causal
effects. Epidemiology, pages 276–284.
Polack, F. P., Thomas, S. J., Kitchin, N., Absalon, J., Gurtman, A., Lockhart, S., Perez,
J. L., Pérez Marc, G., Moreira, E. D., Zerbini, C., et al. (2020). Safety and efficacy of the
BNT162b2 mRNA Covid-19 vaccine. New England Journal of Medicine, 383(27):2603–
2615.
Qin, L., Gilbert, P. B., Corey, L., McElrath, M. J., and Self, S. G. (2007). A framework
for assessing immunological correlates of protection in vaccine trials. The Journal of
infectious diseases, 196(9):1304–1312.
Robins, J. M. and Greenland, S. (1992). Identifiability and exchangeability for direct and
indirect effects. Epidemiology, pages 143–155.
Rose, S. and van der Laan, M. J. (2011). A targeted maximum likelihood estimator for
two-stage designs. The International Journal of Biostatistics, 7(1).
Tchetgen Tchetgen, E. J. and Shpitser, I. (2012). Semiparametric theory for causal mediation analysis: efficiency bounds, multiple robustness, and sensitivity analysis. Annals of
Statistics, 40(3):1816.
16

van der Laan, M. J. and Petersen, M. L. (2008). Direct effect models. The International
Journal of Biostatistics, 4(1).
van der Laan, M. J., Polley, E. C., and Hubbard, A. E. (2007). Super learner. Statistical
Applications in Genetics and Molecular Biology, 6(1).
van der Vaart, A. and Wellner, J. (1996). Empirical processes and weak convergence.
VanderWeele, T. J. (2016). Mediation analysis: A practitioner’s guide. Annual Review of
Public Health, 37:17–32.
Wolfson, J. and Gilbert, P. (2010). Statistical identifiability and the surrogate endpoint
problem, with application to vaccine trials. Biometrics, 66(4):1153–1161.
Zheng, W. and van der Laan, M. J. (2011). Cross-validated targeted minimum-loss-based
estimation. In Targeted Learning, pages 459–474. Springer.
Zheng, W. and van der Laan, M. J. (2012). Targeted maximum likelihood estimation of
natural direct effects. The International Journal of Biostatistics, 8(1).

Supporting Information
The R package natmed2 is available on Github at https://github.com/benkeser/natmed2.
Web Appendices referenced appear below. Appendix A includes a proof of Theorems 1
and 2; Appendix B contains theoretical comparison of the classic and alternative one-step
approaches; Appendix C provides an alternative identification result that does not rely at all
on full-data nuisance parameters; and Appendix D contains additional simulation results.

A. Proof of asymptotic linearity
For proving asymptotic linearity of the proposed estimators, it will first be useful to establish
the following lemmas. We recall the following definitions: Q̄Q̄Y (W,S) (W ) = EX {EX (Y |
A = a1 , W, S) | A = a2 , W }, Q̃Q̄Y (W,S) (W, A, C, CY ) = E{EX (Y | A = a1 , W, S) | R =
1, W, A, C, CY }, and Q̃Q̃(W,A,C,CY ) (W ) = E{Q̃Q̄Y (W,S) (W, A, C, CY ) | A = a2 , W }.
Lemma 1. We have Q̄Q̄Y (W,S) = Q̃Q̃(W,A,C,CY ) .
Proof.
Q̄Q̄Y (W,S) (W ) = EX {Q̄Y (W, S) | A = a2 , W }
= EX [EX {Q̄Y (W, S) | W, A, C, CY } | A = a2 , W ]
= EX [E{Q̄Y (W, S) | R = 1, W, A, C, CY } | A = a2 , W ]
= EX [Q̃Q̄Y (W,S) (W, A, C, CY ) | A = a2 , W ]
= E[Q̃Q̄Y (W,S) (W, A, C, CY ) | A = a2 , W ]
= Q̃Q̃(W,A,C,CY ) (W )

17

The first line follows by definition of Q̄Y , the second by the tower rule. The third follows from
the fact that two-phase sampling status R is independent of Q̄Y (W, S) given (W, A, C, CY ).
The fourth follows again by definition, the fifth recognizing that the conditional distribution
of (A, C, CY ) given A = a2 , W implied by PX is the same as that implied by P . The final
line follows by definition.
Lemma 2. Let MF denote the non-parametric full-data model described in the main doc0
ument. Let ΨF : MF → R denote the parameter mapping that maps any distribution PX
0
0
0
0
in the model to a number EX [EX {EX (CY | A = a1 , C = 1, S, W ) | A = a2 , W }], where EX
0
denotes expectation under PX
. The efficient influence function D(PX ) of Ψ in the full data
model satisfies
0
0
0
ΨF (PX
) − ΨF (PX ) = −EX {D(PX
)(X)} + R2F (PX
, PX ),
F
F
F
where R2F = R2,1
+ R2,2
+ R2,3
with

"
F
0
R2,1
(PX
, PX )

:= EX

{Q̄0Q̄0 (W,S) (W )
Y

(

gA|W (a2 | W )
− Q̄Q̄Y (W,S) (W )} 1 − 0
gA|W (a2 | W )

)#

F
0
R2,2
(PX
, PX )
( 0
)


gA|W (a2 | W ) gA|W,S (a2 | W, S) gA|W,S (a2 | W, S)
0
:= EX 0
−
{Q̄Y (W, S) − Q̄Y (W, S)}
0
gA|W (a2 | W ) gA|W,S
(a1 | W, S) gA|W,S (a1 | W, S)
#
" 0


gA|W,S (a2 | W, S) gC (1 | a1 , W )
0
F
0
.
R2,3 (PX , PX ) := EX 0
0 (1 | a , W ) − 1 {Q̄Y (W, S) − Q̄Y (W, S)}
gA|W,S (a1 | W, S) gC
1

Proof. This lemma follows from Theorem 4 in the supplementary materials of Dı́az et al.
(2020).
Lemma 3. Let V = (W, A, C, CY ), and let P 0 denote the observed data distribution implied
0
0
. The efficient influence function D(P ) of Ψ in the observed
according to gR
by coarsening PX
data model satisfies
0
0
ΨF (PX
) − ΨF (PX ) = −E{D(P 0 )(O)} + R2 (PX
, PX , P 0 , P ),

where
0
0
R2 (PX
, PX , P 0 , P ) = R2F (PX
, PX )



0
gR (1 | V ) − gR (1 | V )
0
0
0
[E{D(P
)(O)
|
R
=
1,
V
}
−
E
{D(P
)(O)
|
R
=
1,
V
}]
+E
X
X
0 (1 | V )
gR
(6)

Proof. This follows from Lemma 2 and the definition of D(P ) after computing
0
R2 (P 0 , P ) = ΨF (PX
) − ΨF (PX ) + E{D(P 0 )(O)},

using the assumption R ⊥
⊥X |V.

18

F
Corollary 1. The object R2,1
can equivalently be written as
"
F
0
R2,1
(PX
, PX ) = EX

(

gA|W (a2 | W )
{Q̃0Q̃0 (W,A,C,CY ) (W ) − Q̃Q̃(W,A,C,CY ) (W )} 1 − 0
gA|W (a2 | W )

)#
,

and the object R2 = R2F + R2,1 + R2,2 where



0
gR (1 | V ) − gR
(1 | V )
0
0
0
0
R2,1 (PX , PX , P , P ) = E
{Q̃D(PX ) (V ) − Q̃D(P 0 ) (V )}
0 (1 | V )
X
gR
0
R2,2 (PX
, PX , P 0 , P )
"
#


0
gR (1 | V ) − gR
(1 | V )
R
1(A = a2 )
0
=E 0
{Q̃Q̄0Y (W,S) (V ) − Q̃Q̄0 (W,S) (V )} .
0
0 (1 | V )
Y
(a2 | W )
gR (1 | V ) gA|W
gR
F
Proof. The equality of R2,1
follows immediately from Lemma 1. The equality of R2 comes
from an algebraic simplification of (6) in Lemma 3.

We are now ready to prove the theorems. We start with the proof of asymptotic linearity for the classic one-step estimator. Below, we use P̂ and P̂X denote any distribution in the observed and full data models, respectively, that is compatible with our estimated nuisance parameters. We define the shorthand notation gj (W ) := gA|W (aj | W )
and gn,j (W ) := gn,A|W (aj | W ). Similarly, we define g̃j (W, S) := gA|W,S (aj | W, S),
g̃n,j (W, S) := gn,A|W,S (aj | W, S), and gC,j (W ) := gC (1 | aj , W ), gn,C,j (W ) := gn,C (1 |
aj , W ). We also make use of the shorthand notation P 0 f to denote expectation of a
0
0
0
P
R -measurable function f of O under a given probability distribution P ; thus, P f =
f (o)dP (o). In particular,
we denote by Pn the empirical distribution based on O1 , . . . , On
Pn
so that Pn f = n−1 i=1 f (Oi ). Note that based on these definitions, the classic one-step
+
estimator can be written as ψn,1
(a1 , a2 ) = ΨF (P̂X ) + Pn D(P̂X ). Thus, by Lemma 3,
+
ψn,1
(a1 , a2 ) − ψ(a1 , a2 ) = (Pn − P )D(P̂ ) + R2 (P̂X , PX , P̂ , P )

= (Pn − P )D(P ) + R2 (P̂X , PX , P̂ , P ) + op (n−1/2 )
= Pn D(P ) + R2 (P̂X , PX , P̂ , P ) + op (n−1/2 )
which follows from assumption A6 and the fact that D(P ) has mean zero. Thus, it remains
to establish that R2 (P̂X , PX , P̂ , P ) = op (n−1/2 ). We note that
h
i
−1
F
(a2 | ·){Q̄n,Q̄n,Y (W,S) − Q̄Q̄Y (W,S) }{gn,A|W (a2 | ·) − gA|W (a2 | ·)}
R2,1
(P̂X , PX ) = P gn,A|W

 h
i
−1
≤ sup gn,A|w
|P {Q̄n,Q̄n,Y (W,S) − Q̄Q̄Y (W,S) }{gn,A|W (a2 | ·) − gA|W (a2 | ·)} |
w


−1
≤ sup gn,A|W
||Q̄n,Q̄n,Y (W,S) − Q̄Q̄Y (W,S) ||P ||gn,A|W (a2 | ·) − gA|W (a2 | ·)||P
w

= op (n−1/2 ) ,
0
F
(PX
, PX )
where the last line follows from assumptions A1 and A5. Next, we note that R2,2
can be written as




g2
(g̃1 − g̃n,1 ) + (g̃n,2 − g̃2 ) + g̃2 (g̃1 − g̃n,1 ) + g̃n,1 (g̃n,2 − g̃2 )
PX
(Q̄Y − Q̄n,Y (W, S)) .
gn,2
g̃n,1 g̃1

19

F
Thus, R2,2
(P̂X , PX ) can be split into four terms that each may be analyzed separately in a
F
similar fashion as with R2,1
. For example, we have


PX




g2
g̃1 − g̃n,1
(Q̄Y − Q̄n,Y )
gn,2
g̃n,1 g̃1



g2 (w)
≤ sup
|PX (g̃1 − g̃n,1 )(Q̄Y − Q̄n,Y ) |
g
(w)g̃
(w,
s)g̃
(w,
s)
w,s
n,2
n,1
1


g2 (w)
≤ sup
||g̃1 − g̃n,1 ||PX ||Q̄Y − Q̄n,Y ||PX
w,s gn,2 (w)g̃n,1 (w, s)g̃1 (w, s)
= op (n−1/2 ) ,

F
which follows from Assumptions A3 and A4. Likewise, we can bound R2,3
(P̂X , PX ),
F
R2,3
(P̂X , PX )


≤

g̃n,2 (w, s)gn,C,1 (w)
sup
g̃n,1 (w, s)
w,s



||gC,1 − gn,C,1 || ||Q̄Y − Q̄n,Y || = op (n−1/2 ) ,

as well as R2 ,

R2 (P̂X , PX , P̂ , P ) ≤

−1
sup gn,R
(1
v


| v) ||gn,R (1 | ·) − gR (1 | ·)||P ||Q̄n,D(PX ) − Q̄D(P̂X ) ||P

= op (n−1/2 ) .
+
Thus, ψn,1
(a1 , a2 ) − ψ(a1 , a2 ) = Pn D(P ) + op (n−1/2 ). Because O1 , . . . , On are independent,
the central limit then implies the result.
The proof of Theorem 2 follows almost exactly as above. We start by noting that based
on assumption B7, we have
+
ψn,2
(a1 , a2 ) − ψ(a1 , a2 ) = Pn D(P ) + R2 (P̂X , PX , P̂ , P ) + op (n−1/2 ) .

All that remains is to establish the negligibility of the remainder terms as written in Corollary
1. This proceeds similarly as above and we can establish that under the conditions of the
theorem
n
o
−1
F
0
R2,1
(P̂X
, PX ) = PX gn,2
(Q̃0n,Q̃(W,A,C,CY ) − Q̃Q̃(W,A,C,CY ) ) (gn,2 − g2 )


−1
≤ sup gn,2
(w) ||Q̃0n,Q̃(W,A,C,CY ) − Q̃Q̃(W,A,C,CY ) ||PX ||gn,2 − g2 ||PX
w

= op (n−1/2 ) ,
as well as that
h
i
−1
R2,1 (P̂X , PX , P̂ , P ) = P gn,R
(1 | ·){gR (1 | ·) − gn,R (1 | ·)}{Q̃D(P̂X ) − Q̃0n,D(PX ) }


−1
≤ sup gn,R (1 | v) ||gR (1 | ·) − gn,R (1 | ·)||P ||Q̃D(P̂X ) − Q̃0n,D(PX ) ||P
v

= op (n−1/2 ) ,

20

and


2
R2,2 (P̂X , PX , P̂ , P ) ≤ sup {gn,R
(1 | v) gn,2 (w)}−1 ||gR (1 | ·) − gn,R (1 | ·)||P
v

× ||Q̃Q̄n,Y (W,S) − Q̃n,Q̄Y (W,S) ||P
= op (n

7

−1/2

).

B. Theoretical comparison of the classic and alternative one-step approaches

The main difference between the classic and alternative approach is that the latter does
not involve inverse probability weights when integrating Q̄Y (W, S) over S. Instead, we
first integrate out S over the conditional distribution of S given R = 1, W, A, C, CY . By
assumption, this conditional distribution is is equal to the conditional distribution of S
given W, A, C, CY in the full data distribution, so there is no need to bother with inverse
probability weights in its estimation. A second regression is then applied to integrate out
A, C, and CY to obtain the appropriate function of W . This strategy may have a theoretical
advantage in situations where gR is unknown. To understand why, note that the multiple
robustness of the classic approach allows for inconsistent estimation of gR , so long as Q̄n,D is
consistent. However, estimation of the sequential regressions Q̄Y and Q̄Q̄Y relies on inverse
weighting by the estimate of gR . Thus, if gR is inconsistently estimated, it is likely that
these quantities will be inconsistently estimated as well. In this case, consistency of the
estimator is fully reliant on consistent estimation of the other nuisance quantities. On the
other hand, the alternative one-step estimator decreases the reliance of the estimator on
gR by replacing one step of inverse weighted estimation. Thus, we hypothesize that the
alternative one-step may enjoy better performance in situations where gR is inconsistently
estimated. However, this is not fully satisfactory, as estimation of the sequential regression
quantity Q̃Q̄Y still relies on estimation of Q̄Y , which itself relies on estimation of gR . Thus,
the alternative estimator may also be subject to poor performance when gR is inconsistently
estimated.

7.1

C. A one-step estimator that does not rely on inverse-weighted
learning

In fact, we can outline an estimation approach that fully disentangles estimation of gR and
estimation of the required full data nuisance parameters. However, the approach does not
appear to scale well in settings where S is continuous valued.
Let qS (s | W, A, Y ) be defined as the conditional density of S given R = 1, W, A, C = 1, Y
evaluated at s. Note that this parameter of P is the same as the conditional density of
S given W, A, C = 1, Y under PX . For each s ∈ S, we define the nuisance quantities
Q̄Y qS (s | W ) := E{Y qS (s | W, A = a1 , C = 1, Y ) | A = a1 , C = 1, W } and Q̄qS (s |
W ) := E{qS (s | W, A = a1 , Y ) | A = a1 , W }. We now derive a relationship between
EX (CY | C = 1, W, A = a1 , S) and these two quantities. For simplicity and without loss of

21

generality we show the derivation when data are discrete.
EX (CY | A = a1 , C = 1, W, S = s)
X
=
y PX (CY = y | C = 1, S = s, A = a, W )
y

=

X

y

y

PX (S = s | C = 1, Y = y, W, A = a)
PX (CY = y | C = 1, A = a1 , W = w)
PX (S = s | C = 1, W, A = a1 )

)
PX (S = s | C = 1, Y = y, W, A = a1 )PX (Y = y | C = 1, A = a1 , W )
=
y P
y PX (S = s | C = 1, Y = y, W, A = a1 )PX (Y = y | C = 1, A = a1 , W )
y
(
)
X
P (S = s | C = 1, Y = y, W, A = a1 , R = 1)P (Y = y | C = 1, A = a1 , W )
=
y P
y P (S = s | C = 1, Y = y, W, A = a1 , R = 1)P (Y = y | C = 1, A = a1 , W )
y
P
y y P (S = s | C = 1, Y = y, W, A = a1 , R = 1)P (Y = y | C = 1, A = a1 , W )
= P
y P (S = s | C = 1, Y = y, W, A = a1 , R = 1)P (Y = y | C = 1, A = a1 , W )
(

X

=

Q̄Y qS (s | W )
Q̄qS (s | W )

Thus, we have the following identification result,


  
Q̄Y qS (S | W )
| R = 1, W, A, C, CY | A = a2 , W
.
ψ(a1 , a2 ) = E E E
Q̄qS (S | W )
This suggests the following estimation strategy for evaluating the plug-in estimator. First,
obtain an estimate qn,S of the conditional mediator density qS . For all i such that Ri = 1,
evaluate qn,S (Si | W = Wj , A = a1 , Y = Yj ) for all j such that Cj = 1 and Aj = a1 .
Next, obtain an estimate Q̄n,Y qS (Si | W ) of Q̄Y qS (Si | W ) by using observations such that
Cj = 1 and Aj = a1 to regress the outcome Yj × qn,S (Si | W = Wj , A = a1 , Y = Yj )
onto Wj . Similarly, obtain an estimate Q̄n,qS (Si | W ) of Q̄qS (Si | W ) by regressing the
outcome qn,S (Si | W = Wj , A = a1 , Y = Yj ) onto Wj . Next, for all i such that Ri = 1,
evaluate Q̄n,Y qS (Si | Wi )/Q̄n,qS (Si | Wi ). This quantity serves as our estimate of Q̄n,Y and
we proceed as with the plug-in estimator for the alternative one-step.
The key element of this estimator’s construction is that it does not rely on inverse
weighting by an estimate of gR to estimate nuisance parameters. However, there is a price
to be paid in terms of complexity. Whereas the previous estimators each allowed us to
avoid estimation of the conditional mediator density, in this approach we require such an
estimator. Moreover, we require a separate estimation of Q̄qS and Q̄qS for each value at
each
Pn value Si such that Ri = 1. Thus, if S is continuous-valued, this would require fitting
2 i=1 Ri regressions. This strategy therefore appears most-appealing in situations where
S is binary, in which case its implementation is quite tractable, both in terms of density
estimation and in terms of the estimation of Q̄qS and Q̄qS .

D. Additional simulation results
We found that the estimates based on a misspecified GLM performed quite poorly in terms
of their bias (Table 4). Not only that, the variance of the estimators was extremely inflated

22

and confidence intervals tended to have conservative coverage probabilities due to standard
error estimates that were too large.
Table 5 shows estimators of the counterfactual risk ψ(1, 0). We found similar results as
with the estimators of indirect effect and proportion mediated. Confidence intervals attained
near nominal coverage in larger samples with negligible bias.

23

Table 1: Bias (scaled by n1/2 ), standard error ((scaled by n1/2 , SE), coverage probability of
a nominal 95% confidence interval (Cov), and the scaled SE divided by the square root of
the efficient variance (Ratio) for the two proposed one-step estimators in different settings.
The settings column indicates which nuisance parameters are consistently estimated (gR
was consistently estimated in all settings).
+
+
ψn,1
(1, 0)
ψn,2
(1, 0)
Setting
n Bias
SE Cov. Ratio Bias
SE Cov. Ratio
500
0.33 1.06 0.93
1.48
0.37 1.11 0.94
1.55
1000
0.21 0.83 0.95
1.17
0.21 0.83 0.95
1.16
All
2000
0.14 0.79 0.94
1.11
0.14 0.79 0.94
1.11
4000
0.10 0.74 0.94
1.04
0.10 0.74 0.94
1.04
8000
0.04 0.73 0.95
1.02
0.04 0.73 0.95
1.02
500
0.03 0.74 0.99
1.03
0.14 1.05 0.98
1.47
1000
0.03 0.74 0.99
1.04
0.10 1.06 0.98
1.49
Q̄Y , Q̄Q̄Y
2000 -0.00 0.72 0.99
1.01
0.03 1.04 0.98
1.46
4000
0.05 0.75 0.99
1.04
0.10 1.12 0.97
1.57
8000
0.01 0.77 0.99
1.08
0.02 1.11 0.97
1.56
500 -0.01 0.67 0.90
0.94 -0.01 0.67 0.90
0.94
1000 -0.01 0.68 0.92
0.95 -0.01 0.68 0.92
0.95
Q̄Y , Q̄Q̄Y ,
2000
0.01 0.66 0.92
0.93
0.01 0.67 0.92
0.93
Q̄DPX , Q̃DPX
4000
0.04 0.63 0.93
0.89
0.04 0.63 0.93
0.89
8000 -0.01 0.65 0.93
0.91 -0.01 0.65 0.93
0.91
500
0.56 1.14 0.99
1.60
0.66 1.63 0.96
2.29
1000
0.37 0.98 0.99
1.38
0.45 1.44 0.96
2.02
gA|W , gA|W,S ,
2000
0.21 0.88 0.99
1.24
0.25 1.29 0.97
1.81
gC
4000
0.11 0.87 0.99
1.23
0.14 1.27 0.96
1.79
8000
0.11 0.85 0.99
1.19
0.12 1.20 0.97
1.69
500
0.42 1.17 0.92
1.64
0.44 1.11 0.92
1.55
gA|W , gA|W,S , 1000
0.30 0.87 0.94
1.22
0.31 0.87 0.93
1.22
gC , Q̄DPX ,
2000
0.20 0.78 0.93
1.10
0.20 0.78 0.93
1.09
4000
0.13 0.72 0.94
1.01
0.13 0.72 0.94
1.01
Q̃DPX
8000
0.13 0.76 0.92
1.06
0.13 0.76 0.92
1.06
500
0.04 0.84 1.00
1.17
0.13 1.31 0.98
1.84
1000
0.06 0.82 1.00
1.15
0.14 1.23 0.99
1.73
Q̄Y , gA|W ,
2000
0.06 0.81 1.00
1.13
0.12 1.21 0.99
1.69
gC
4000
0.03 0.80 1.00
1.12
0.08 1.20 0.99
1.69
8000
0.04 0.80 1.00
1.12
0.09 1.21 0.99
1.70
500 -0.05 0.79 0.96
1.10 -0.06 0.78 0.96
1.09
Q̄Y , gA|W ,
1000 -0.05 0.73 0.97
1.02 -0.06 0.72 0.97
1.01
gC , Q̄DPX ,
2000 -0.01 0.71 0.97
0.99 -0.01 0.71 0.97
0.99
4000 -0.03 0.73 0.97
1.02 -0.03 0.73 0.97
1.02
Q̃DPX
8000
0.00 0.72 0.97
1.01
0.00 0.72 0.97
1.01

24

Table 2: True values of the parameters of interest for the various simulation settings and
the average (standard deviation) number of observed events amongst the simulated vaccine
recipients (n̄1 ) and amongst the simulated placebo recipients. VE = 1 - ψ(1, 1)/ψ(0, 0).
ψ(1,0)
α
VE ψ(1,1)
Prop. Mediated n̄1 (sd)
n̄2 (sd)
ψ(1,0)
ψ(0,0)
-5.00 0.92
0.46
0.17
0.30 10.6(3.2) 140.1(11.8)
-4.10 0.92
0.46
0.17
0.30 26.2(5.3) 339.2(18.0)
-3.60 0.92
0.46
0.17
0.31 43.2(6.6) 550.3(23.2)
-3.30 0.92
0.46
0.17
0.31 58.4(7.5) 731.3(26.2)
-3.10 0.92
0.46
0.17
0.31 71.1(8.2) 882.9(28.9)

Table 3: Bias and confidence interval coverage for the classic (left) and alternative (right)
one-step estimator of indirect effect and proportion mediated for different event rates (α).
Results are shown for when nuisance parameters are estimated using a GLM with interactions (top) and a Super Learner (bottom)
α
-5.0
-4.1
-3.6
-3.3
-3.1
-5.0
-4.1
-3.6
-3.3
-3.1

+
ψn,1
Indirect
Prop. Med.
Bias Coverage
Bias Coverage
4.361
0.842 -0.270
0.857
1.103
0.922 -0.098
0.926
0.828
0.935 -0.048
0.938
0.075
0.947 -0.023
0.947
0.025
0.945 -0.013
0.950
-0.843
0.903 -0.202
0.911
0.396
0.947 -0.079
0.947
0.261
0.977 -0.052
0.979
-0.677
0.981 -0.039
0.982
0.069
0.982 -0.030
0.983

+
ψn,2
Indirect
Prop. Med.
Bias Coverage
Bias Coverage
3.509
0.805 -0.256
0.823
1.807
0.911 -0.100
0.916
0.390
0.930 -0.042
0.933
0.850
0.943 -0.024
0.948
0.083
0.943 -0.013
0.948
1.528
0.876 -0.192
0.889
0.375
0.927 -0.065
0.931
0.187
0.959 -0.035
0.960
0.139
0.963 -0.030
0.967
0.122
0.970 -0.027
0.971

Method

GLM inter.

SuperLearner

Table 4: Comparison of estimators of indirect effect and proportion mediated for the
COVID-19 simulation including a misspecified main terms generalized linear model.
+
ψn,1

α
-5.0
-4.1
-3.6
-3.3
-3.1
-5.0
-4.1
-3.6
-3.3
-3.1
-5.0
-4.1
-3.6
-3.3
-3.1

Indirect
Bias Coverage
3.563
0.998
-1.762
0.995
1.521
0.996
-0.253
0.999
-0.303
0.999
4.361
0.842
1.103
0.922
0.828
0.935
0.075
0.947
0.025
0.945
-0.843
0.903
0.396
0.947
0.261
0.977
-0.677
0.981
0.069
0.982

Prop. Med.
Bias Coverage
-0.276
0.999
-0.047
0.994
0.040
0.995
0.099
0.999
0.110
0.999
-0.270
0.857
-0.098
0.926
-0.048
0.938
-0.023
0.947
-0.013
0.950
-0.202
0.911
-0.079
0.947
-0.052
0.979
-0.039
0.982
-0.030
0.983

+
ψn,2

Indirect
Bias Coverage
3.526
0.844
1.969
0.952
0.477
0.972
0.109
0.979
0.085
0.982
3.509
0.805
1.807
0.911
0.390
0.930
0.850
0.943
0.083
0.943
1.528
0.876
0.375
0.927
0.187
0.959
0.139
0.963
0.122
0.970

25

Prop. Med.
Bias Coverage
-0.255
0.856
-0.100
0.951
-0.043
0.974
-0.022
0.980
-0.013
0.982
-0.256
0.823
-0.100
0.916
-0.042
0.933
-0.024
0.948
-0.013
0.948
-0.192
0.889
-0.065
0.931
-0.035
0.960
-0.030
0.967
-0.027
0.971

Method

GLM main

GLM inter.

SuperLearner

Table 5: Performance of the two one-step estimators of ψ(1, 0) in terms of bias, coverage
probability of a 95% confidence interval, and the median estimated standard error divided
by the true standard error.
α
-5.0
-4.1
-3.6
-3.3
-3.1
-5.0
-4.1
-3.6
-3.3
-3.1
-5.0
-4.1
-3.6
-3.3
-3.1

ψ(1, 0)
0.0016
0.0038
0.0063
0.0085
0.0103
0.0016
0.0038
0.0063
0.0085
0.0103
0.0016
0.0038
0.0063
0.0085
0.0103

Bias
0.0002
0.0003
-0.0002
0.0002
0.0002
0.0001
0.0002
0.0003
0.0005
0.0007
0.0001
0.0002
0.0003
0.0003
0.0004

+
ψn,1
(1, 0)
Coverage
0.6250
0.8990
0.9790
0.9960
0.9970
0.6220
0.8380
0.8920
0.9160
0.9250
0.6190
0.8480
0.9000
0.9200
0.9370

Est. std.
True. std.

Bias
0.0001
0.0002
0.0004
0.0005
0.0007
0.0001
0.0002
0.0003
0.0005
0.0007
0.0001
0.0002
0.0002
0.0004
0.0004

5.0116
4.8306
4.3200
4.0146
3.8029
0.6468
0.9314
0.9224
0.9543
0.9649
0.6909
1.0329
1.0239
1.0884
1.1188

+
ψn,2
(1, 0)
Coverage
0.6220
0.8730
0.9410
0.9510
0.9640
0.6210
0.8320
0.8920
0.9140
0.9230
0.6170
0.8760
0.9380
0.9610
0.9720

Est. std.
True. std.

0.8528
1.2171
1.2139
1.2209
1.2445
0.6454
0.9293
0.9130
0.9418
0.9551
0.8796
1.0659
1.0530
1.0687
0.9704

Method

GLM main

GLM inter.

SuperLearner

Table 6: Proportion of estimates of ψ(1, 0) that were less than zero for the classic one-step
estimator
+
α Prop. ψn,1
(1, 0) < 0 Method
-5.0
0.10
-4.1
0.21
-3.6
0.25 GLM main
-3.3
0.28
-3.1
0.28
-5.0
0.01
-4.1
0.00
-3.6
0.00 GLM inter.
-3.3
0.00
-3.1
0.00
-5.0
0.01
-4.1
0.03
-3.6
0.04 SuperLearner
-3.3
0.04
-3.1
0.05

26

