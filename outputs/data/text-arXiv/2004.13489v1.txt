arXiv:2004.13489v1 [q-bio.PE] 24 Apr 2020

Comparative prediction of confirmed cases with
COVID-19 pandemic by machine learning,
deterministic and stochastic SIR models
Babacar Mbaye Ndiaye, Lena Tendeng, Diaraf Seck
Abstract. In this paper, we propose a machine learning technics and SIR models
(deterministic and stochastic cases) with numerical approximations to predict
the number of cases infected with the COVID-19, for both in few days and the
following three weeks. Like in [1] and based on the public data from [2], we
estimate parameters and make predictions to help on how to find concrete actions to control the situation. Under optimistic estimation, the pandemic in some
countries will end soon, while for most of the countries in the world, the hit of
anti-pandemic will be no later than the beginning of May.
Keywords. COVID-19, stochastic SIR model, existence, stopping time, machine
learning, forecasting.

1. Introduction
The deterministic SIR models are usually investigated through ordinary differential
equations for prediction [19]. It can also be viewed in a stochastic framework, which
is more realistic but also more complicated to analyze.
In population dynamics, the deterministic models are developed with success in many
situations. In these models appear some parameters and in concrete applications, its
estimated values play a crucial role in the prediction of the studied system and even
in the decision-making policies. Usually one considers that they are deterministic,
but many times due to errors in measurements, variability in the populations, and
other factors that introduce uncertainties, one can think of parameters as random
variables. To consider these aspects, it is necessary to get some skills in probability
theory, statistics, and differential equations. And the stochastic differential equation
theory invites itself and fortunately there are many excellent books in this topics. For
more details see for instance [14, 18, 15].
And with tools developed in this topic, interdisciplinary areas such as mathematical
biology, biostatistics, and bio-engineering have become possible with rapid growth.
There are interesting works done and the reader can see for example [12, 13, 16] and

This work was completed with the support of the NLAGA project.

2

Ndiaye et al.

references therein.
Our aim in this work is one hand, to propose a stochastic model to analyze the pandemic of COVID-19. And on the other hand, we would like to deepen the numerical
analysis of such phenomena in situations where the settings may be random.
Many theoretical studies of the evolution of infectious diseases of the COVID-19 are
recently proposed in [1, 4, 5, 6, 7]. In the simple SIR model, the total population for
each country [3] is assumed to be constant and divided into three classes (susceptible,
infected, and recovered). In the numerical simulations, we start with the deterministic
case, following by the new proposed stochastic model in section 2, then 3 others SIR
models and machine learning for forecasting where algorithms can include artificial
neural networks, deep learning, association rules, decision trees, reinforcement learning and bayesian networks [20, 21].
First, we collect carefully the pandemic data from [2], e.g. https://www.tableau.
com/covid-19-coronavirus-data-resources, from January 21, 2020 to April 19,
2020. After exploratory data analysis, we propose six(6) technics, a simple SIR model,
a stochastic SIR with Brownian motion, SIR with Deaths, SIR with Fatal, SIR Exposed and Waiting cases with Fatal, and machine learning tools, to analyze the coronavirus pandemic in the worldwide. A special study is done for Senegal.
The paper is organized as follows. In section 2, we present a stochastic SIR model
with the existence, uniqueness and some qualitative results. In section 3, we present
approximation methods to estimate different parameters involving in the SIR models.
It is followed by various numerical tests for comparative prediction. Finally, in section
4, we present conclusions and perspectives.

2. Modeling, Existence, Uniqueness and Properties
2.1. Stochastic Model
The stochastic aspect would be very interesting due to the lack of data, especially
in the case of Senegal with the expansion of COVID 19 pandemic. Some infected
people do not develop the disease and spread it (the case of some children, as it is
suspected) not to mention the unmonitored asymptomatic cases that are the cause of
community transmission. There is also the probability of touching infected objects:
too many random factors in the transmission of the disease. Let us propose among
many possibilities the following stochastic SIR model:










dS
dt

= −βIS + σ1 ξ1

dI
dt

= βIS − γI + σ2 ξ2

dR
dt

= γI

(2.1)

• S is the number of individuals susceptible to be infected at time t.
• I is the number of both asymtomatic and symptomatic infected individuals at
time t.
• R is the number of recovered persons at time t.
• The parameters β and γ are respectively the transmission rate through exposure
of the disease and the rate of recovering.

Comparative prediction of confirmed cases with COVID-19 pandemic.

3

• σ1 and σ2 are diffusion coefficients that are interpreted as volatility rates. They
may depend on the time t, the suspects and the infected. ξ1 and ξ2 are white
noises.
One interesting case that we endeavor to look at in this work, is when the above
system is written as follows:


 dS = −βISdt − σ1 ISdW1


dI = βISdt − γI + σ2 ISdW2
(2.2)



 dR
dt = γI
W1 and W2 are classical Brownian motions; σ1 and σ2 are positive constants.
Remark
2.1. Let us note that instead the term σi ISdWi , i = 1, 2 one could propose
√
σi ISdWi , i = 1, 2.
As in the deterministic case, let us consider a sample of population. We denote it by
N satisfying the relation
N = S(t) + I(t) + R(t)

(2.3)

The balance property of the above equation implies the following constraint
−σ1 dW1 + σ2 dW2 = 0.

(2.4)

With this constraint, we shall need in the simulation of the stochastic case to have
an estimation of one of σ1 , σ2 .
Before proceeding further, we are going to present some classical results for the stochastic differential equation model, such as existence and uniqueness results, the stopping notion, and its properties.
2.2. Existence and Uniqueness
This section is started by a few useful reminds in probability theory. For more details,
see for instance [14, 18].
Definition 2.2. Let Ω be a set.
A σ−algebra is a collection U of subsets of Ω with the following properties
• ∅, Ω ∈ U;
• if A ∈ U, then Ac := Ω\A ∈ U;
∞
∞
[
\
• if A1 , A2 , ..., ∈ U then
Ai ,
Ai ∈ U.
i=1

i=1

Let W (.) be a 1−dimensional Brownian motion defined on some probability space
(Ω, U, P).
Definition 2.3. The σ−algebra W(t) := U(W (s)/0 ≤ s ≤ t) is called the history of
Brownian motion up to and including t.
The σ−algebra W + (t) := U(W (s)/s ≥ t) is called the future of Brownian motion
beyond time t.
Definition 2.4. A family F(.) of σ− algebras included in U is called non anticipating
with respect to W (.) if
1. F(t) ⊇ F(s) for all t ≥ s ≥ 0;

4

Ndiaye et al.
2. F(t) ⊇ W(t) for all t ≥ 0;
3. F(t) is independent of W + (t) for all t ≥ 0;

It is referred to F(t) as a filtration.
Let us state a general a Cauchy Lipschitz Theorem version and for the details (2.2),
see for example [14].
Theorem 2.5. Suppose that the two functions b : Rn × [0, T ] −→ Rn and B : Rn ×
[0, T ] −→ Mm×n are continuous and satisfy the following conditions:
(a) | b(x, t) − b(x̂, t) |≤ L | x − x̂ | and | B(x, t) − B(x̂, t) |≤ L | x − x̂ | ∀ 0 ≤ t ≤
T and x, x̂ ∈ Rn .
(b) | b(x, t) |≤ L(1+ | x |) and | B(x, t) |≤ L(1+ | x |) ∀ 0 ≤ t ≤ T , x ∈ Rn for
some constant L.
Let X0 be any Rn -valued random variable such that
(c) E(| X0 |2 ) < ∞, and
(d) X0 is independent of W + (0), where W(.) is a given m-dimensional Brownian
motion.
Then there exists a unique solution X ∈ L2n (0, T ) of the stochastic differential equation:

dX = b(X, t)dt + B(X, t)dW (0 ≤ t ≤ T )
(2.5)
X(0) = X0
The above theorem is merely adapted in our study case.
Theorem 2.6. Let X0 = (S0∗ , I0∗ , R0∗ ) be any R3 -valued random variable such that:
(i) E(| X0 |2 ) < ∞, and
(ii) X0 is independent of W + (0),
There exists a unique solution of the following stochastic differential equation:


 dS = −βISdt − σ1 ISdW1



 dI = (βIS − γI)dt + σ ISdW

2









dR
dt

2

(2.6)

= γI

S(0) = S0∗ , I(0) = I0∗ , R(0) = R0∗

Proof. The proof is simple. It suffices
are satisfied.

 
dS
−βI
0
 dI  =  βI −γ
dR
0
γ

only to verify if the hypotheses of Theorem 2.5




0
S
−σ1 IS
0   I  dt +  σ2 IS  dW
0
R
0

Our
fits 
well to
the one considered
in the
 system


S
W1
−βI
0
 I , W =  W2 , b(X) =  βI −γ
R
0
0
γ


Ŝ
By chosen X̂ =  Iˆ , we have:
R̂

above
 general theorem.
 with: X
=
0
−σ1 IS
0  and B(X) =  σ2 IS .
0
0

Comparative prediction of confirmed cases with COVID-19 pandemic.

5


ˆ 0 0
−β(I − I)
ˆ
ˆ
b(X) − b(X̂) =  β(I − I)
0 0  =⇒|| b(X) − b(X̂) ||∞ = β|I − I|
0
0 0


S − Ŝ
ˆ |R − R̂|)
X − X̂ =  I − Iˆ  =⇒|| X − X̂ ||∞ = max(|S − Ŝ|, |I − I|,
R − R̂


ˆ ≤ max(|S − Ŝ|, |I − I|,
ˆ |R − R̂|)
|I − I|
ˆ ≤ β || X − X̂ ||∞ . We have β(1+ || X ||) ≥ 0
=⇒|| b(X) − b(X̂) ||∞ = β|I − I|
|| b(X) ||∞ = max(βI, βI + γ, γ) = βI + γ

and

|| X ||∞ = max(S, I, R)

βI ≤ β max(S, I, R) = β || X || or γ < β =⇒
|| b(X) ||∞ = βI + γ ≤ β + β || X ||= β(1+ || X ||)
|B(X)|
≤ C0 + C0 max(S, I, R) = C0 (1+ || X ||)
kXk≤1 kXk

|| B ||= sup

where C0 = max{σ1 , σ2 }. We see that it suffices to take L = max{β, C0 }



2.3. Stopping time
Let (Ω, U, P) be a probability space and F(.) a filtration of σ−algebras.
Definition 2.7. A random variable τ : Ω =⇒ [0, +∞] is called a stopping time with
respect to F(.) if the set
{τ ≤ t}, for all t ≥ 0.
This means that the set of all ω ∈ Ω such that τ (ω) ≤ t is an F(t)− measurable
set. For our model, it could be interesting to study the stopping time. For instance,
the situation in which efforts are done to contain or eradicate the pandemic. And
an interesting one is can we find a finite stopping time when the susceptible infected
and recovered or removed variables S(t), I(t) and R(t) respectively are less than
thresholds?
Let us state a general theorem where the stopping time does exist but it may be taken
+∞.
Theorem 2.8. Let V be either a nonempty closed subset or a nonempty open subset
of R3 . Then
τ := inf{t ≥ 0/(S(t), I(t), R(t)) ∈ V }

(2.7)

is a stopping time
Let us point out that the stopping time has interesting properties as a remark. Let
τ1 and τ2 be stopping times with respect to F(.), then:
• {τ < t} ∈ F(t), and so {τ = t} ∈ F(t) for all times t ≥ 0.
• τ1 ∧ τ2 := min(τ1 , τ2 ), τ1 ∨ τ2 := max(τ1 , τ2 ) are stopping times
In the numerical simulations, we shall wonder if it is possible to find a finite stopping
time by considering V a closed subset of R3 in the form of [0, S ∗ ] × [0, I ∗ ] × [0, R∗ ].

6

Ndiaye et al.

3. Parameter estimation and numerical simulations
In this section, we present the simulations of the simple SIR, stochastic SIR, SIR
with Deaths, SIR with Fatal, SIR Exposed and Waiting cases with Fatal and the
machine learning technic for forecasting of the pandemic. The numerical tests were
performed by using the Python with the Panda library [24]. The numerical experiments were executed on a computer with the following characteristics: intel(R) Core-i7
CPU 2.60GHz, 24.0Gb of RAM, under the UNIX system.
3.1. Exploratory data analysis
As stated in the introduction, the simulations are carried out from data in [2], from
January 21 2020, to April 19, 2020. We first analyze and make some data preprocessing
before simulations. It is a good practice to know data types, along with finding whether
columns contain null values or not.
We get various summary statistics, by giving the count (number of observations),
mean, standard deviation, minimum and maximum values, and the quantiles of the
data (see tables 1 and 2).
Values
count
mean
std
min
25%
50%
75%
max

Confirmed
16729
2532.4691
13183.2366
0
8
85
576
247815

Deaths
16729
143.0855
1140.9791
0
0
1
6
23660

Recovered
16729
624.3309
4818.1358
0
0
1
52
88000

Table 1. Worldwide summary statistics (per day) until April 19th, 2020.
Date
2020-04-17
2020-04-18
2020-04-19

Confirmed Infected Deaths Recovered
2240191
1518026 153822
568343
2317759
1565930 159510
592319
2401379
1612432 165044
623903

Table 2. Worldwide total data until April 19th, 2020.

The worldwide cumulative of confirmed, deaths and recovered cases are illustrated in
Figure 1.
3.2. Parameter estimation
The identification of a real dynamical system (called object) is to characterize another
system (called model), starting from the experimental knowledge of the inputs and
outputs to obtain an identity of behavior. In practice, the purpose of identification is
generally to determine the conducted model, which can be used to simulate, control,
or regulate a process. This model can be physical (in the sense of analog or digital
simulator and reduced model), or abstract (mathematical model, i.e. system of algebraic or differential equations (ODE or PDE)).

Comparative prediction of confirmed cases with COVID-19 pandemic.

7

Figure 1. Worldwide - confirmed, deaths and recovered
This subsection is started by the estimation of the parameters β, γ in the deterministic
SIR model by the standard least square method.
3.2.1. Deterministic case.











dS
dt

= −βIS

dI
dt

= βIS − γI

dR
dt

= γI

(3.1)

Let us consider a time interval [0, T ] and subdivide it as follows: ∀i ∈ {0, ..., n − 1},
ti+1 − ti = 1, t0 = 0, tn−1 = T . Let: β(ti ) = βi , γ(ti ) = γi , S(ti ) = Si , and I(ti ) = Ii .
Discretizing (3.1), we get the following system of 2n unkown (∀i = 0, ..., n − 1):


 Si+1 − Si = −βi Ii Si


Ii+1 − Ii = βIi Si − γi Ii
(3.2)



 R
i+1 − Ri = γi Ii
Let us set:
Y = (S1 , , ..., Sn , I1 , ..., In ) ∈ R2n

and F (β0 , ..., βn−1 , γ0 , ..., γn−1 ) ∈ R2n

the vector coming from the right hand side of the above two first equations of (3.2).
P := (β0 , β1 , ..., βn−1 , γ0 , γ1 , ..., γn−1 ) ∈ [0, 1]2n .
We try to minimize:
E(P ) := kY − F (P )k22
on [0, 1]2n , where k.k2 is the Euclidean norm in R2n .
The differentiability of E and its convex structure ensure existence of a minimizer

8

Ndiaye et al.

∗
∗
that we note by Popt = (β0∗ , β1∗ , ..., βn−1
, γ0∗ , γ1∗ , ..., γn−1
).
And the approximated parameters proposed are:

βapp =

n−1
1X ∗
β
n i=0 i

and

γapp =

n−1
1X ∗
γ
n i=0 i

We have:
•
•
•
•

S : Susceptible (= N - Confirmed)
I : Infected (= Confirmed - Recovered - Deaths)
R : Recovered (= Recovered + Deaths)
S + I + R = N , where N is the total population that can be obtained in [3].

The basic reproduction number (also called basic reproduction ratio) is defined as is
R0 = βγ −1 . This ratio is derived as the expected number of new infections (these
new infections are sometimes called secondary infections) from a single infection in a
population where all subjects are susceptible. For the model, we also have:
β

S + I −→ 2I

and

γ

I −→ R

with: β= effective contact rate [1/day], γ= recovery(+mortality) rate [1/day].
Remark 3.1. An easy way to compute γi , is to use the equation Ri+1 − Ri = γi Ii ,
and set yi = Ri+1 − Ri , xi = Ii (∀i = 1, ..., n − 1). Then, we obtain yi = f (xi ).
Finally, as γi are bounded ∀i = 1, ..., n, we can call the curve fit procedure. The
scipy.optimize.curve fit use non-linear least squares to fit a function, f , to data,
assuming ydata = f(xdata, *params) + .
The return value popt contains the best-fit values of the parameters. The return
value pcov contains the covariance (error) matrix for the fit parameters. From them,
we can determine the standard deviations of the parameters. We can also determine
the correlation between the fit parameters.
To estimate β, we use the same procedure with the first equation yi = Si − Si+1 =
βi Ii Si = βi xi , (∀i = 1, ..., n − 1). Recall that yi ≥ 0, and xi = Ii Si .
3.2.2. Volatility rates. To approximate the volatility rates σ1 , σ2 , we propose the standard deviation. And we need to compute the variances of the distributions obtained
in the deterministic estimations in the previous sub sub section.
V1 =

n−1
1X ∗
(β − βapp )2
n i=0 i

and

V2 =

n−1
1X ∗
(γ − γapp )2
n i=0 i

And first idea for approximating volatilities are:
p
p
σ1 = V 1 ,
σ2 = V2 .
But in the numerical simulation section we have to take into account the equilibrium
condition (2.4) that derives from the modeling.
A second idea that could be better, is to take:
√
√
V1 + V2
σi =
, i = 1, 2.
2

Comparative prediction of confirmed cases with COVID-19 pandemic.

9

Remark 3.2. Before proceeding further, we would like to underline that the numerical
tests that we shall realize below, are to be understood under hypotheses. If nothing is
done on time, it could be possible to fall on the below predictions. And an invitation
is to see how it is possible to organize minimal actions to mitigate strongly possible
damage caused by the COVID 19 pandemic in a country like Senegal.
3.3. Simple SIR model
First, we use the SIR model simulations for the Senegal case study. For the initial
values, we use date already stated in section 3.1. The first 3 days cases are given in
Table 3. We have: N = 16, 296, 361 until the year 2019 (see [3]), I0∗ = Confirmed[0]=1,
S0∗ = N − I0∗ − R0∗ .
To estimate parameters β and γ, we call the procedure Optuma package [11] with
python, an open source hyper-parameter optimization framework to automate hyperparameter search. For the contact rate (β) and the mean recovery rate (γ), we have:
β = 0.115953, γ = 0.030912 (1/[days]) and R0 = 3.75. The prediction is given in
Figure 2.
Date
Confirmed Infected Deaths
2020-03-02
1
1
0
2020-03-04
2
2
0
2020-03-05
4
4
0
Table 3. Senegal: first three days

Figure 2. Senegal: prediction with SIR
3.4. Stochastic SIR model
In this stochastic part, the following relation is to be considered
−σ1 dW1 + σ2 dW2 = 0

(3.3)

10

Ndiaye et al.

√
with dW = Z ∆t, and Z v N (0, 1).
For the numerical simulation of the stopping time, we consider, V a closed subset of
R3 in the form of [0, S ∗ ] × [0, I ∗ ] × [0, R∗ ].
We consider the same procedure like in section 3.3 with the same population and the
same initialization, I0∗ = Confirmed[0]=1, S0∗ = N − I0∗ − R0∗ .
To estimate parameters β and γ, we call the procedure scipy.optimize.curve fit
with python. For the contact rate (β) and the mean recovery rate (γ), we have: β =
0.135005, γ = 0.026979 (1/[days]), σ2 = 0.036254 and R0 = 5. As σ1 dW1 = σ2 dW2 ,
we only use σ2 dW2 in the simulations.
Predictions with different simulations (because of Brownian) are given in Figure 3.
For the Brownian, the curve changes for each simulation. For 4 tests, this gives us
the results of Figures 3a, 3b, 3c and 3d.
Remark 3.3. The stopping time (see section 2.3) is illustrated in dotted line and
appears around the middle April.

(a) a first stochastic SIR

(b) a second stochastic SIR

(c) a third stochastic SIR

(d) a fourth stochastic SIR

Figure 3. Senegal: prediction with stochastic SIR

Comparative prediction of confirmed cases with COVID-19 pandemic.

11

3.5. Interpretation of figures
The values of the parameters having been estimated, the SIR deterministic model
(Figure 2) shows that the peak of infection could be reached by mid-May with about
37.5% of the population infected. The same time period of peak (mid-May) for infected, is observed for Figures 4, 5 and 6.
The stochastic SIR model illustrates that it is possible to have nearly the same peak
than the deterministic one (but with a larger infected population) if random factors
are not too important (Figures 3a and 3b).
In the other hand if the effect of hazard is important, the stochastic SIR model is
less optimistic and show that the peak of infection could be reached in early June
(Figures 3c and 3d) with about 56% of the population infected.
A finite stopping time exists (in dotted line) and is established in the second half of
April.
3.6. Others modifications of the SIR model
There are a large number of modifications of the SIR model, including those that
include births and deaths separately, where some cases are reported as fatal cases
before clinical diagnosis of COVID-19, where the number of exposed cases in latent
period and the waiting cases for confirmation are un-measurable variables, etc. All
models allow for understanding how different situations may affect the outcome of
the pandemic.
3.6.1. SIR with Deaths [8, 9, 10] (SIR-D). It’s possible to measure the number of
fatal cases and recovered cases separately. We can use two variables Recovered and
Deaths, instead of Recovered + Deaths in the mathematical model.
The model is given by:
 dS

dt = −βIS





 dI
dt = βIS − (γ + α)I
(3.4)

dR

=
γI

dt



 dD
dt = αI
We have:
S : Susceptible, I : Infected, R : Recovered, D : Fatal.
In addition, S +I +R+D = N , where N is the total population, always obtained from
[3]. The basic reproduction number (also called basic reproduction ratio) is defined
as is R0 = β(γ + α)−1 . For the model, we also have:
β

γ

α

S + I −→ 2I, I −→ R and I −→ D
with: β= effective contact rate [1/day], γ= recovery rate [1/day], α= mortality rate
[1/day]. We also use the optuna package to estimate the parameters.
We obtain: β = 0.002343, γ = 0.042431, α = 0.008784 (1/[days]) and R0 = 3.81. The
prediction is given in Figure 4.

12

Ndiaye et al.

Figure 4. Senegal: prediction with SIR with Deaths
3.6.2. SIR with Fatal [8, 9, 10] (SIR-F). We can have a situation where some cases
are reported as fatal cases before clinical diagnosis of COVID-19. To consider this
issue, S + I −→ Fatal + I will be added to the model.
The model is given by:
 dS

dt = −βIS





 dI
dt = (1 − α1 )βIS − (γ + α2 )I
(3.5)

dR

=
γI

dt



 dD
dt = α1 βIS + α2 I
We have:
S : Susceptible, S ∗ : Confirmed and un-categorized, I : Confirmed and categorized as
I, R : Recovered, F : Fatal with confirmation.
In addition, S +I +R+F = N , where N is the total population, always obtained from
[3]. The basic reproduction number (also called basic reproduction ratio) is defined
as is R0 = β(1 − α1 )(γ + α)−1 . For the model, we also have:
βI

α

βI

1−α

γ

α

1
2
S −→ S ∗ −→
F, S −→ S ∗ −→1 I, I −→ R and I −→
F

with: β= effective contact rate [1/day], γ= recovery rate [1/day], α1 = mortality rate
of S ∗ cases [1/day], α2 = mortality rate of I cases [1/day]. We also use the Optuna
package to estimate the parameters.
We obtain: β = 0.103144, γ = 0.02308, α1 = 0.057568, α2 = 0.000192 (1/[days]) and
R0 = 4.18. The prediction is given in Figure 5.

Comparative prediction of confirmed cases with COVID-19 pandemic.

13

Figure 5. Senegal: prediction with SIR with Fatal

3.6.3. SIR Exposed and Waiting cases with Fatal [8, 9, 10] (SEWIR-F). We can
consider the number of exposed cases in latent period (E) and the waiting cases for
confirmation (W) which are un-measurable variables. If E and W are large, outbreak
will occur in the near future. W and some rules were added to explain COVID-19
dataset, but this is like-SEIR model.
The model is given by:
 dS

 dt = −β1 (W + I)S



 dE = β (W + I)S − β E

1
2


 dt



 dW
dt = β2 E − β3 W
(3.6)

dI

=
(1
−
α
)β
W
−
(γ
+
α
)I
1
3
2
 dt





dR


 dt = γI


 dF
dt = α1 β3 W + α2 I
We have:
S : Susceptible, E : Exposed and in latent period (without infectivity), W : Waiting
cases for confirmation (with infectivity), I : Confirmed and categorized as I, R :
Recovered and F : Fatal with confirmation.
In addition, Total population - Confirmed = S + E + W + S ∗ , Confirmed = I + R + F ,
Recovered = R, Deaths = F and S + E + W + I + R + F = N , where N is the total
population, always obtained from [3]. The basic reproduction number (also called
basic reproduction ratio) is defined as is R0 = β1 (1 − α1 )(γ + α2 )−1 . For the model,

14

Ndiaye et al.

we also have:
S

β1 (W +I)

−→

β2

β3

α

1
F, S
E −→ W −→ S ∗ −→

γ

β1 (W +I)

−→

β2

β3

1−α

E −→ W −→ S ∗ −→1 I

α

2
F
I −→ R and I −→
with: β1 = exposure rate (the number of encounter with the virus in a minute) [1/day],
β2 = inverse of latent period [1/day], β3 = inverse of waiting time for confirmation
[1/day], γ= recovery rate [1/day], α1 = mortality rate of S ∗ cases [1/day] (S ∗ =
Confirmed and un-categorized), α2 = mortality rate of I cases [1/day].
We also use the Optuna package to estimate the parameters.
To estimate β2 and β3 , we first calculate median value of latent period LE and waiting
time for confirmation LW . We assume that latent period is equal to incubation period
(patients start to have infectivity from onset dates).
We obtain: β1 = 0.0.108008, β2 = 0.407707, β3 = 0.728274, γ = 0.018478, α1 =
0.068890, α2 = 2.066063e − 05 (1/[days]) and R0 = 5.44. The prediction is given in
Figure 6.

Figure 6. Senegal: prediction with SEWIR with Fatal
Remark 3.4. Note that it is quite possible to propose stochastic variants for all the
above various deterministic models.
3.7. Forecasting using Prophet
In this section, we develop the machine learning technics for forecasting to compare
with the previous SIR models. We use Prophet [22, 23], a procedure for forecasting
time series data based on an additive model where non-linear trends are fit with
yearly, weekly, and daily seasonality, plus holiday effects.
For the average method, the forecasts of all future values are equal to the average
(or mean) of the historical data. If we let the historical data be denoted by y1 , ..., yT ,
then we can write the forecasts as
ŷT +h|T = ȳ = (y1 + y2 + ... + yT )/T

Comparative prediction of confirmed cases with COVID-19 pandemic.

15

The notation ŷT +h|T is a short-hand for the estimate of yT +h based on the data
y1 , ..., yT . A prediction interval gives an interval within which we expect yt to lie with
a specified probability. For example, assuming that the forecast errors are normally
distributed, a 95% prediction interval for the h-step forecast is
ŷT +h|T ± 1.96σˆh
where σh is an estimate of the standard deviation of the h-step forecast distribution.
For the data preparation, when we are forecasting at country level, for small values, it
is possible for forecasts to become negative. To counter this, we round negative values
to zero. Also, no tweaking of seasonality-related parameters and additional regressors
are performed.
We can carry out simulations for a longer time and forecast the potential trends of
the COVID-19 pandemic. In Senegal, the predicted cumulative number of confirmed
cases are first plotted for a shorter period of the next 7 days, and 3 weeks ahead
forecast with Prophet, with 95% prediction intervals.
The confirmed predictions for Senegal are given in Figures 7 and 8 (see Tables 4 and
5 for the value of the confidence interval).
ds
2020-04-22
2020-04-23
2020-04-24
2020-04-25
2020-04-26

ŷ
390.082137
399.143136
411.338180
420.807645
432.420448

ŷlower
381.573661
389.013079
400.868963
408.116029
418.126379

ŷupper
398.870511
408.336247
422.324577
432.783086
446.991749

Table 4. Senegal: predicted cumulative confirmed cases ∼April 26, 2020.
ds
2020-05-06
2020-05-07
2020-05-08
2020-05-09
2020-05-10

ŷ
534.240980
543.301979
555.497023
564.966488
576.579291

ŷlower
483.962306
487.616917
498.895290
501.869902
509.887788

ŷupper
586.061842
600.747825
616.731785
631.122912
647.035185

Table 5. Senegal: predicted cumulative confirmed cases ∼May 10, 2020.
3.8. Main comments
With Prophet, we perform also for the worldwide and three selected countries China,
Italy, and Iran. Firstly, the worldwide predicted cumulative number of confirmed
cases and deaths cases are plotted for a shorter period of the next 7 days. Secondly,
we perform for 3 weeks for both confirmed and deaths cases. We plot only for the
next three days for China, Italy, and Iran countries.
We can summarize our basic predictions as follows, for the worldwide and by country:
• For Senegal (see Figure 9), the peak of the pandemic will be no later than the
end of May. The predictions given by the SIR models and machine learning give
roughly the same estimates. The authorities must take strict measures to stop
the pandemic of COVID-19, because the peak can be reached around mid-May.

16

Ndiaye et al.

Figure 7. Senegal (Confirmed) : Forcasting for the next week
∼April 29, 2020

Figure 8. Senegal (Confirmed) : Forcasting for the next 3 weeks
∼May 10, 2020

• For worldwide, (see Figure 10), overall, each country of the whole world must
take strict measures to stop the pandemic. At ∼May 10, 2020 we may obtain >
3 million 740 000 confirmed cases (see Table 6).

Comparative prediction of confirmed cases with COVID-19 pandemic.

17

• For Italy (see Figure 11a) and Iran (see Figure 11b), the success of the antipandemic will be no later than the middle of May. The situation in Italy and
Iran is still very severe.
• For China (see Figure 11c), based on optimistic estimation, the pandemic of
COVID-19 would soon be ended within a few weeks in China.
ds
2020-05-06
2020-05-07
2020-05-08
2020-05-09
2020-05-10

ŷ
3.777760e+06
3.861820e+06
3.945427e+06
4.026816e+06
4.108123e+06

ŷlower
3.512616e+06
3.573719e+06
3.633930e+06
3.691283e+06
3.740562e+06

ŷupper
4.006792e+06
4.106810e+06
4.213883e+06
4.311569e+06
4.415467e+06

Table 6. Worldwide: predicted cumulative confirmed cases ∼May
10, 2020.

Finally, due to the inclusion of suspected cases with clinical diagnosis into confirmed
cases (quarantined cases), we can see severe situation in some cities, which requires
much closer attention. Individuals, communities and governments have to fight against
the spread of the coronavirus. And thoughtful actions are to be taken.

4. Conclusion and Perspectives
Under optimistic estimation, the pandemic in some countries (like China) will end
soon within few weeks, while for most of the countries in the world, the hit of antipandemic will be no later than mid-May. In Senegal, we expect the situation will end
up at the beginning of May.
In front of good forecasting, it is fundamental to get back to the estimation of parameters in general. And in the stochastic models, there is also another main issue:
the estimation of volatility parameters. These bring more works. And most of the
time one considers the standard deviation to approximate them. But, because of the
difficulty to identify the asymptomatic cases, like in Finance, should it be possible to
introduce other ways to estimate them? One investigation way could be:
n−1
1X
(xi − x̄)2 , xi , i = 0, ..., n − 1 are the measures given by the infected
• V =
n i=0
numbers between two consecutive periods: xi = ln(Si , Ii , Ri , Si−1 , Ii−1 , Ri−1 )
Ii
(one could think to xi = ln( Ii−1
) provided that , Ii , Ii−1 > 0 with possible other
√
conditions); x̄ is statistical mean value of xi . And then σ1 = V .
• If one thinks that the volatility cannot be equal to 0, i. e we exclude the situation
where xi = x̄ for any i. A possibility to take always into account the presence
of volatility is to use the approximation where the mean value of the sample is
removed in the variance formula: then one can consider the following estimation
n−1
1X 2
for the variance V =
x .
n i=0 i

18

Ndiaye et al.

(a) SIR

(b) Stochastic SIR

(c) SIR-D

(d) SIR-F

(e) SEWIR-F

(f) forecasting 3 weeks

Figure 9. Senegal: Comparative prediction between SIR models
and machine learning technics

At the end of this work, we think that other questionings could merit to be studied
such as

Comparative prediction of confirmed cases with COVID-19 pandemic.

(a) 1 week confirmed

(b) 3 weeks confirmed

(c) 1 week deaths

(d) 3 weeks deaths

19

Figure 10. Worldwide: forecasting for confirmed & deaths (next
week and next 3 weeks)
• the deepening of the stochastic models, by considering the fractional Brownian
motion,
• the consideration of non-local terms in some models,
• some minimal actions such as stochastic optimization to control the spreading
of the disease,
• and finally, the mean-field games could be an interesting way to investigate in
that pandemic, lockdown problems.
Acknowledgement
The authors thanks the Non Linear Analysis, Geometry and Applications (NLAGA)
Project for supporting this work. They thanks also the anonymous authors for their
helpful comments.

References
[1] Babacar M. Ndiaye, Lena Tendeng, Diaraf Seck, Analysis of the COVID-19 pandemic by
SIR model and machine learning technics for forecasting, arXiv:2004.01574v1 [q-bio.PE],
3 Apr 2020.

20

Ndiaye et al.

(a) Forcasting - confirmed in Italy

(b) Forcasting - confirmed in Iran

(c) Forcasting - confirmed in China

Figure 11. Italy, Iran, and China : forecasting for confirmed (next
3 weeks)
[2] COVID-19 Data Hub, available on https://www.tableau.com/covid-19-coronavirus
-data-resources.
[3] Population Pyramids of the World, available on https://www.populationpyramid.net
[4] Z. Liu, P. Magal,O. Seydi, G. Webb, (2020). Understanding Unreported Cases
in the 2019-Ncov Epidemic Outbreak in Wuhan, China, and the Importance of
Major Public Health Interventions. SSRN: https://ssrn.com/abstract=3530969 or
http://dx.doi.org/10.2139/ssrn.3530969.
[5] Hiroshi Nishiura, Natalie M Linton, and Andrei R. Akhmetzhanov. Serial interval of
novel coronavirus (2019-ncov) infections. medRxiv, 2020.
[6] Kamalich Muniz-Rodriguez, Gerardo Chowell, Chi-Hin Cheung, Dongyu Jia, Po-Ying
Lai, Yiseul Lee, Manyun Liu, Sylvia K. Ofori, Kimberlyn M. Roosa, Lone Simonsen, and
Isaac Chun-Hai Fung. Epidemic doubling time of the 2019 novel coronavirus outbreak
by province in mainland china. medRxiv, 2020.
[7] Steven Sanche, Yen Ting Lin, Chonggang Xu, Ethan Romero-Severson, Nick Hengartner, and Ruian Ke. The novel coronavirus, 2019-ncov, is highly contagious and more
infectious than initially estimated. medRxiv, 2020.

Comparative prediction of confirmed cases with COVID-19 pandemic.

21

[8] O. Diekmann, H. Heesterbeek, and T. Britton, Mathematical Tools for Understanding Infectious Disease Dynamics. Princeton Series in Theoretical and Computational
Biology. Princeton University Press, Princeton, (2013).
[9] H.W. Hethcote, The mathematics of infectious diseases, SIAM Review 42, 599-653
(2000).
[10] M.J. Keeling and P. Rohani, Modeling Infectious Diseases in Humans and Animals.
Princeton University Press, Princeton, (2007).
[11] Takuya Akiba, Shotaro Sano, Toshihiko Yanase, Takeru Ohta, and Masanori Koyama.
2019. Optuna: A Next-generation Hyperparameter Optimization Framework. In KDD.
[12] E Allen, Modeling with Itô Stochastic Differential Equations. Springer, Dordrecht, The
Netherlands 2007.
[13] L. Allen, 2010, An Introduction to Stochastic Processes with Applications to Biology,
2nd edition, CRC Press, Boca Raton.
[14] L.C. Evans, An Introduction to Stochastic Differential Equations, American Mathematical Society (2014).
[15] K.Itô; H.P. Jr. McKean, 1965, Diffusion Processes and Their Sample Paths, Academic
Press. N.Y.
[16] S. Ly, D. Seck, Stochastic optimization in population dynamics: the case of multi-site
fisheries, submitted, 2020.
[17] Kermack WO, McKendrick AG (1927) Contributions to the mathematical theory of
epidemics. Proc R Soc A 115 : 700721.
[18] B. Oksendal, Stochastic Differential Equations. An Introduction with Applications Fifth
Edition, Corrected Printing Springer-Verlag Heidelberg New York, 2000
[19] Howard Weiss (2013). The SIR Model and the foundations of public health. volum 203,
treball no. 3, 17 pp. ISSN: 1887-1097.
[20] Arkes, H. R. (2001). Overconfidence in judgmental forecasting. In J.S. Armstrong (Ed.),
Principles of Forecasting (pp. 495-515). Boston, MA: Kluwer Academic Publishers. FC.
[21] Nikolopoulos, K., Litsa, A., Petropoulos, F., Bougioukos, V., & Khammash, M. (2015).
Relative performance of methods for forecasting special events, Journal of Business
Research, 68, 1785-1791.
[22] Prophet: Automatic Forecasting Procedure, avalailable in https://facebook.github.
io/prophet/docs/ or https://github.com/facebook/prophet.
[23] Sean J. Taylor and Benjamin Letham. Forecasting at scale. The American Statistician,
(just-accepted), 2017.
[24] Python Software Foundation. Python Language Reference, version 2.7. Available at
http://www.python.org.
Babacar Mbaye Ndiaye, Lena Tendeng, Diaraf Seck
Laboratory of Mathematics of Decision and Numerical Analysis
University of Cheikh Anta Diop
BP 45087, 10700. Dakar, Senegal
e-mail: babacarm.ndiaye@ucad.edu.sn, lenatendeng@yahoo.fr,
diaraf.seck@ucad.edu.sn

