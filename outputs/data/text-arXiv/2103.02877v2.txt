A Two-Sample Robust Bayesian Mendelian
Randomization Method Accounting for Linkage
Disequilibrium and Idiosyncratic Pleiotropy with
Applications to the COVID-19 Outcome

arXiv:2103.02877v2 [stat.ME] 29 Mar 2021

Anqi Wang, Zhonghua Liu*
Department of Statistics and Actuarial Science, University of Hong Kong,
Hong Kong SAR, China
*

To whom correspondence should be addressed: zhhliu@hku.hk
March 31, 2021

ABSTRACT
Mendelian randomization (MR) is a statistical method exploiting genetic variants as
instrumental variables to estimate the causal effect of modifiable risk factors on an outcome of interest. Despite wide uses of various popular two-sample MR methods based on
genome-wide association study summary level data, however, those methods could suffer
from potential power loss or/and biased inference when the chosen genetic variants are in
linkage disequilibrium (LD), and also have relatively large direct effects on the outcome
whose distribution might be heavy-tailed which is commonly referred to as the idiosyncratic pleiotropy phenomenon. To resolve those two issues, we propose a novel Robust
Bayesian Mendelian Randomization (RBMR) model that uses the more robust multivariate
generalized t-distribution (Arellano-Valle and Bolfarine, 1995) to model such direct effects
in a probabilistic model framework which can also incorporate the LD structure explicitly.
The generalized t-distribution can be represented as a Gaussian scaled mixture so that our
model parameters can be estimated by the EM-type algorithms. We compute the standard
errors by calibrating the evidence lower bound using the likelihood ratio test. Through
extensive simulation studies, we show that our RBMR has robust performance compared
to other competing methods. We also apply our RBMR method to two benchmark data
sets and find that RBMR has smaller bias and standard errors. Using our proposed RBMR
method, we find that coronary artery disease is associated with increased risk of critically

1

ill coronavirus disease 2019 (COVID-19). We also develop a user-friendly R package RBMR
(https://github.com/AnqiWang2021/RBMR) for public use.
Key Words:

COVID-19 outcome; Mendelian randomization; Idiosyncratic pleiotropy;

Linkage disequilibrium, Multivariate generalized t-distribution; EM-type algorithm

2

1. Introduction
Mendelian randomization (MR) is a useful statistical method that leverages genetic
variants as instrumental variables (IVs) for assessing the causal effect of a modifiable risk
factor on a health outcome of interest even in the presence of unmeasured confounding
factors (Ebrahim and Smith, 2008; Lawlor et al., 2008; Evans and Davey Smith, 2015).
Because of the inborn nature of genetic variants, the associations between genetic variants
and phenotypes after adjusting for possible population stratification will not be confounded
by the environmental factors, socio-economic status and life styles after birth. Genome-wide
association studies (GWAS) have identified tens of thousands of common genetic variants
associated with thousands of complex traits and diseases (MacArthur et al., 2017). Those
GWAS summary level data contain rich information about genotype-phenotype associations
(https://www.ebi.ac.uk/gwas/), and thus provide us valuable resources for MR studies.
Therefore, we have seen a boost of two-sample MR method developments and applications
based on GWAS summary statistics recently due to the increasing availability of candidate
genetic variant IVs for thousands of phenotypes. (Burgess et al., 2013; Bowden et al., 2015;
Pickrell et al., 2016). In particular, a genetic variant serving as a valid IV must satisfy the
following three core assumptions (Martens et al., 2006; Lawlor et al., 2008):
1. Relevance: The genetic variant must be associated (not necessarily causally) with
the exposure;
2. Effective Random Assignment: The genetic variant must be independent of any
(measured or unmeasured) confounders of the exposure-outcome relationship;
3. Exclusion Restriction: The genetic variant must affect the outcome only through
the exposure, that is, the genetic variant must have no direct effect on the outcome
not mediated by the exposure.
When these three core IV assumptions hold, the inverse variance weighted (IVW) (Ehret
et al., 2011) method can be simply used to obtain unbiased causal effect estimate of the
exposure on the outcome. However, among those three core assumptions, only the IV relevance assumption can be empirically tested, for example, by checking the empirical association strength between the candidate IV and the exposure using the GWAS catalog
(https://www.ebi.ac.uk/gwas/). The association between the IV and the exposure must

3

be strong enough (the IV explains a large amount of the variation of the exposure variable) to
ensure unbiased causal effect estimate. The problem of weak IVs has been studied previously
in the econometric literature (Bound et al., 1995; Hansen et al., 2008). In MR settings, the
method that uses genetic score by combining multiple weak IVs together to increase the IVexposure association strength to reduce weak IV bias has also been proposed (Evans et al.,
2013). Unfortunately, the other two IV core assumptions cannot be empirically tested and
might be violated in practice. Violation of the exclusion restriction assumption can occur
when the genetic variant indeed has a non-null direct effect on the outcome not mediated
by the exposure, referred to as systematic pleiotropy (Solovieff et al., 2013; Verbanck et al.,
2018; Zhao et al., 2020b). However, very often, genetic variants might have relatively large
direct effects whose distribution exhibit heavy-tailed pattern, a phenomenon referred to as
the idiosyncratic pleiotropy in this paper.
To address those possible violations of the IV core assumptions and potential risk,
many efforts have been made recently. The MR-Egger regression method introduced an
intercept term to capture the presence of unbalanced systematic pleiotropy under the Instrument Strength Independent of Direct Effect (InSIDE) assumption (Bowden et al., 2015).
However, MR-Egger would be biased when there exists idiosyncratic pleiotropy. Zhu et al.
(2018) proposed the GSMR method that removes suspected genetic variants with relatively
large direct effects and also takes the LD structure into account by using the generalized
least squares approach. However, removal of a large number of relatively large direct effects
might lead to efficiency loss. Zhao et al. (2020b) proposed MR-RAPS to improve statistical
power for causal inference and limit the influence of relatively large direct effects by using
the adjusted profile likelihood and robust loss functions assuming that those SNP IVs are
independent. However, this independent IV assumption might not hold in practice because
SNPs within proximity tend to be correlated. Cheng et al. (2020) proposed a two-sample MR
method named MR-LDP that built a Bayesian probabilistic model accounting for systematic
pleiotropy and LD structures among SNP IVs. One drawback of the MR-LDP method is
that it cannot handle relatively large direct effects well.
To overcome the limitations of those aforementioned methods, we propose a more robust method named ‘Robust Bayesian Mendelian Randomization (RBMR)’ accounting for
LD, systematic and idiosyncratic pleiotropy simultaneously in a unified framework. Specifically, to account for LD, we first estimate the LD correlation matrix of SNP IVs and then

4

explicitly include it in the model likelihood. To account for idiosyncratic pleiotropy, we propose to model the direct effects using the more robust multivariate generalized t-distribution
(Arellano-Valle and Bolfarine, 1995; Frahm, 2004) which will be shown to have improved performance than using the Gaussian distribution when the idiosyncratic pleiotropy is present.
Moreover, this more robust distribution can be represented as a Gaussian scaled mixture to
facilitate model parameter estimation using the parameter expanded variational Bayesian
expectation maximization algorithm (PX-VBEM) (Yang et al., 2020) which combines the
VB-EM (Beal et al., 2003) and the PX-EM (Liu et al., 1998) together. We further calculate
the standard error by calibrating the evidence lower bound (ELBO) according to a nice property of the likelihood ratio test (LRT). Both extensive simulation studies in Section 3 and
analysis of two real benchmark data sets in Section 4 show that our proposed RBMR method
outperforms competitors. We also find that coronary artery disease (CAD) is associated with
increased risk of critically ill COVID-19 outcome.

2. Methods
2.1 The Linear Structural Model
Suppose that we have J possibly correlated genetic variants (for example, single-nucleotide
polymorphisms, or SNPs ) Gj , j = 1, 2, . . . , J, the exposure variable X, the outcome variable
Y of interest and unknown confounding factors U . Let δX and δY denote the effects of confounders U on exposure X and outcome Y respectively. The coefficients γj (j = 1, 2, . . . , J)
denote the SNP-exposure true effects. Suppose that all the IVs are valid, then the exposure
can be represented as a linear structural function of the SNPs, confounders and an independent random noise term eX . The outcome can be represented as a linear structural function
of the exposure, confounders and the independent random noise term eY . The true effect
size of the exposure on the outcome is denoted as β0 . Then, we have the following linear
structural equation models (Bowden et al., 2015):
X=

J
X

Gj γj + U δX + eX ,

Y = β0 X + U δY + eY .

(2.1)

j=1

Let Γj (j = 1, 2, . . . , J) be the true effects of SNPs on the outcome. With valid IVs, we
have
Γj = β0 γj .

5

(2.2)

To accommodate possible violations of the exclusion restriction assumption, we now consider
the following modified linear structural functions (Bowden et al., 2015):
X=

J
X

Gj γj + U δX + eX ,

Y =

j=1

J
X

Gj αj + β0 X + U δY eY ,

(2.3)

j=1

where the coefficients αj (j = 1, 2, . . . , J) represent the direct effects of the SNPs on the
outcome. Then we have
Γj = β0 γj + αj .

(2.4)

So far, many existing MR methods assign the Gaussian distribution on each direct effect
αj , that is α ∼ N (0, σ02 IJ ) (Zhao et al., 2020b; Cheng et al., 2020; Zhao et al., 2020a), where
α = [α1 , . . . , αJ ]T is a J-dimensional vector of direct effects. However, real genetic data
might contain some relatively large direct effects whose distribution can be heavy-tailed,
and thus the Gaussian distribution might not be a good fit. Therefore, we propose to assign
the multivariate generalized t-distribution on α (Arellano-Valle and Bolfarine, 1995; Kotz
and Nadarajah, 2004), which is a robust alternative to the Gaussian distribution (Frahm,
2004).

2.2 The
Bayesian
MR
o
n
o Model
n Robust
2
γ
bj , σ
bX
j

and

bj , σ
Γ
bY2j

be the GWAS summary statistics for the exo
n
2
2
are the corresponding estimated
,
σ
b
posure and the outcome respectively, where σ
bX
Yj
j
Let

j=1,...,J

j=1,...,J

standard errors. Many existing MR methods assume that IVs are independent from each
other (Ehret et al., 2011; Bowden et al., 2015; Zhao et al., 2020b), and the uncorrelated SNPs
can be chosen by using a tool called LD clumping (Hemani et al., 2016; Purcell et al., 2007),
which might remove many SNP IVs and thus cause efficiency loss. To include more SNP
IVs even if they are in LD, we need to account for the LD structure explicitly. To achieve
this goal, we use a reference panel sample to assist with reconstructing LD matrix, such as
the 1000 Genome Project Phase 1 (N =379) (Consortium et al., 2012). We first apply the
LDetect method to partition the whole genome into Q blocks (Berisa and Pickrell, 2016)
b (k) (k = 1, 2, . . . , Q) first proposed
and then estimate the LD matrix Θ using the estimator Θ
b are given by
b and Γ
by Rothman (2012). Then, the distributions of γ


−1
b
b
b
b |γ, Θ, σ
bX ∼ N σ
b X Θb
b X Θb
γ
σX γ, σ
σX ,


b Θ,
b σ
b σ −1 Γ, σ
b σY ,
bY ∼ N σ
b Y Θb
b
Γ|Γ,
Θb
Y
Y
6

(2.5)
(2.6)

b X = diag ([b
b Y = diag ([b
where σ
σX1 , . . . , σ
bXJ ]) and σ
σY1 , . . . , σ
bYJ ]) are both diagonal matrices
(Zhu and Stephens, 2017).
To account for the presence of idiosyncratic pleiotropy, we propose to model the direct
effects α using the more robust multivariate generalized t-distribution (Arellano-Valle and
Bolfarine, 1995; Kotz and Nadarajah, 2004; Ala-Luhtala and Piché, 2016) whose density
function is given by

−(αw +J/2)
f (αw + J/2)
1
T −1
tJ (α|Σ, αw , βw ) =
1+
(α Σ α)
|Σ|1/2 f (αw )(2πβw )J/2
2βw
Z
= N (α|0, Σ/w)G(w|αw , βw )dw,

(2.7)

where N (α|0, Σ/w) denotes the J-dimensional Gaussian distribution with mean 0 and covariance Σ/w, Σ = σ02 IJ is a J × J diagonal matrix, and G(w|αw , βw ) is the Gamma distribution of a univariate positive variable w referred to as a weight variable
G(w|αw , βw ) =

βw αw αw −1 −βw w
w
e
,
f (αw )

(2.8)

where f denotes the Gamma function. When αw = βw = ν/2 in equation (2.8), the distribution in equation (2.7) reduces to a multivariate t-distribution, where ν is the degree of
freedom. Gaussian scaled mixture representation enables the use of EM-type algorithms for
statistical inference, such as the PX-VBEM (Yang et al., 2020) described in Section 2.3.
Then we denote the distribution of the latent variable γ as

γ|σ 2 ∼ N 0, σ 2 ,

(2.9)

where σ 2 = σ 2 IJ is a J × J diagonal matrix. By assuming that γ, α and w are latent
variables, the complete data likelihood can be written as





−1
b
b
b
b
b
b
b
b
Pr Γ, γ , α, γ, w|b
σX , σY , Θ; θ, h =N Γ|b
σY Θb
σY (β0 γ + α) , σY Θb
σY N 0, σ 2 IJ



b σ −1 γ, σ
b σX N α|0, σ 2 IJ /w G (w|αw , βw ) .
b |b
b
×N γ
σX Θb
Θb
X
0
X
(2.10)

2.3 Estimation and Inference
The standard expectation-maximization (EM) algorithm (Dempster et al., 1977) is a
popular choice for finding the maximum likelihood estimate in the presence of missing (latent)
variables. However, one difficulty for implementing the EM algorithm is to calculate the
marginal likelihood function which might involve difficult integration with respect to the
7

distributions of the latent variables. In addition, the original EM algorithm might be slow
(Liu et al., 1998). To address these numerical issues, we utilize a parameter expanded
variational Bayesian expectation-maximization algorithm, namely, PX-VBEM (Yang et al.,
2020), by replacing the EM algorithm in VB-EM (Beal et al., 2003) with PX-EM algorithm
(Liu et al., 1998) to accelerate the speed of convergence. To start with, for the purpose of
b in equation (2.5) can be rewritten as
applying the PX-EM algorithm, the distribution of γ
follows:


b σ
b σ −1 γ, σ
b
b |γ, Θ,
bX ∼ N ζ σ
b X Θb
b
γ
Θb
σ
X
X .
X

(2.11)

We also rewrite the complete data likelihood in equation (2.10) as:





2
b γ
b θ, h =N Γ|b
b σY Θb
b σ −1 (β0 γ + α) , σ
b
b , α, γ, w|b
b Y , Θ;
b
Pr Γ,
σX , σ
Θb
σ
Y
Y N 0, σ IJ
Y



−1
b
b
b |ζ σ
b X Θb
b X Θb
×N γ
σX γ, σ
σX N 0, σ02 IJ /w G (w|αw , βw ) ,
(2.12)
def

where the expanded model parameters for RBMR are θ = {β0 , σ02 , σ 2 , ζ}. Let q(γ, α, w)
be a variational posterior distribution. The logarithm of the marginal likelihood can be
decomposed into two parts,


b θ, h
b σX , σ
b , Γ|b
b Y , Θ;
log Pr γ
h

i
b
b
b , Γ|b
b Y , Θ; θ, h
= Eq(γ,α,w) log Pr γ
σX , σ

(2.13)

= L(q) + KL(qkp),
where

b
b
b , Γ, γ, α, w|b
b Y , Θ; θ, h
Pr γ
σX , σ
,
L(q) = Eq(γ,α,w) log
q (γ, α, w)


q (γ, α, w)
 .
KL(qkp) = Eq(γ,α,w) log 
b
b
b
b
p γ, α, w|b
γ , Γ, σX , σY , Θ; θ, h




(2.14)

Given that the L(q) is an evidence lower bound (ELBO) of the marginal log-likelihood, the
non-negative Kullback-Leibler (KL) divergence KL(qkp) is equal to zero if and only if the
variational posterior distribution is equal to the true posterior distribution. Minimizing the
KL divergence is equivalent to maximizing ELBO. Before calculating the maximization of
ELBO, due to the fact that latent variables are independent of each other, the decomposition

8

form of the posterior distribution q(γ, α, w) is obtained using the mean field assumption (Blei
et al., 2017),
q(γ, α, w) =

J
Y

q (γj )

j=1

J
Y

q (αj ) q(w).

(2.15)

j=1

In the PX-VB-E step, the optimal variational posterior distributions for γ, α and w
can be written as:
J
J
 Y

 
 Y



N µγj , σγ2j , q α|µαj , σα2 j =
N µαj , σα2 j ,
q γ|µγj , σγ2j =
j=1

(2.16)

j=1









q w|e
αw , βew = G α
ew , βew .
The updating equations for the parameters are given by
−

b jj
b jj
1
ζ 2Θ
1
β02 Θ
−
− 2,
=
−
2
2
2
2σγj
2 σYj
2σXj
2σ






 
 
 
J
b
b
b
2
2
X
X
X
b
0
0
0
0
0
0
α
Θ
γ
Θ
γ
Θ
µγj
ζb
γj
Γj
β
β0 
ζ 
j
jj 
j
jj 
j
jj 
+ 2 −
,
= β0 2 − 0 
−
2
0
0
σγj
σ Yj
σYj
σ Yj
σYj
σY
σXj
σXj
σX
0
0
0
j 6=j

−

j =1

j

j 6=j

j

b jj
1
[w]
1Θ
− 2,
=
−
2
2
2σαj
2 σ Yj
2σ0
 
 
J
b 0
b 0 γ0
bj
µαj
β0 X Θ
1 X αj 0 Θ
Γ
j
jj
jj
−
−
,
=
2
2
σ αj
σYj
σYj 0
σY 0
σYj 0
σY 0
j =1

α
e w = αw +
βew = βw +

J
,
2
J  2
X
αj
j=1

σ02

j

j 6=j

j

.
(2.17)



where γj 0



def

= Eq

i


 h
def
def
γj 0 , αj 0 (j) = Eq αj 0 (j) and [w] = Eq (w).

In the PX-VB-M step, by setting the derivate of the ELBO to be zero, the model
parameters θ can be obtained as:


o−1 
n
−1 b −1
−1 b −1
T −2
T −1 b −1
b
b
b
b
b
σ
Θb
σ
µ
Θb
σ
µ
+
Tr
σ
Θb
σ
S
Γ
σ
µ
−
µ
β0 = µT
σ
γ
γ
γ
γ ,
γ Y
α Y
Y
Y
Y
Y
Y

σ 2 = µT
γ µγ + Tr (Sγ ) /J,


ew µT
/J βew ,
σ02 = α
α µα + Tr (Sα )
n

o−1

−1 b −1
−2
T −1 b −1
b X Θb
b X Θb
bTσ
bX
ζ = µγ σ
σX µγ + Tr σ
σX Sγ
γ
µγ ,
9

(2.18)



where µγ = (µγ1 , . . . , µγJ )T , µα = (µα1 , . . . , µαJ )T , Sγ = diag σγ21 , . . . , σγ2J and Sα =


diag σα2 1 , . . . , σα2 J . Finally, we use the updated model parameters θ to construct the
evidence lower bound to check the convergence. Since we adopt PX-EM algorithm, the reduction step should be used to process the obtained parameters. More technical details can
be found in the Supplementary Materials.
After obtaining an estimate of the causal effect, we further calculate the standard error according to the property of likelihood ratio test (LRT) statistics which asymptotically
follows the χ21 under the null hypothesis (Van der Vaart, 2000). We first formulate the
statistical tests to examine the association between the risk factor and the outcome.
H 0 : β0 = 0

Ha : β0 6= 0,

the likelihood ratio test (LRT) statistics for the causal effect is given by:





ML
ML
b
b
b
b
b , Γ|b
b , Γ|b
b Y , Θ; h, θ̂
b Y , Θ; h, θ̂ 0
σX , σ
,
σX , σ
− log Pr γ
Λ = 2 log Pr γ
ML

where θ̂ 0

and θ̂

ML

(2.19)

(2.20)

are collections of parameter estimates obtained by maximizing the

marginal likelihood under the null hypothesis H0 and under the alternative hypothesis Ha .
b and θ
b0 instead of
We utilize PX-VBEM algorithm to maximize the ELBO to get the θ
maximizing the marginal likelihood to overcome the computational intractability. Although
PX-VBEM produces accurate posterior mean estimates (Blei et al., 2017; Dai et al., 2017;
Yang et al., 2018), it would underestimate the marginal variance because we use the estimated
posterior distribution from the ELBO to approximate the marginal likelihood in equation
(2.20) (Wang and Titterington, 2005). Thus, we calibrate ELBO by plugging our estimates
b and θ
b0 ) from PX-VBEM into the equation (2.20) to construct the test statistics (Yang
(θ
et al., 2020):





0
b h, θ̂ − log Pr γ
b h, θ̂ 0 .
b σX , σ
b σX , σ
b , Γ|b
b Y , Θ;
b , Γ|b
b Y , Θ;
Λ = 2 log Pr γ

(2.21)

√ 0
Then, we can get the well-calibrated standard error as se(
b βb0 )= βb0 / Λ .

3. Simulation Studies
Although our proposed method is based on summary level data, we still simulate the
individual-level data to better mimic real genetic data sets. Specifically, the data sets are
generated according to the following models:
X = GX γ + UX η X + εX ,

Y = β0 X + GY α + UY η Y + εY ,
10

(3.1)

where X ∈ RnX ×1 is the exposure vector, Y ∈ RnY ×1 is the outcome vector, GX ∈ RnX ×J
and GY ∈ RnY ×J are the genotype datasets for the exposure X and the outcome Y,
UX ∈ RnX ×N0 and UY ∈ RnY ×N0 are matrices for confounding variables, nX and nY are
the corresponding sample sizes of exposure X and outcome Y, J is the number of geno
typed SNPs. The error terms εX and εY are independent noises from N 0, σε2X InX and

N 0, σε2Y InY respectively. In model (3.1), β0 is the true causal effect and α represents the
direct effect of the SNPs on the outcome not mediated by the exposure variable.
An external reference panel Gr ∈ Rnr ×J is chosen for estimating the LD matrix among
SNPs, where nr is the sample size of the chosen reference panel. The R package named
MR.LDP is available to generate genotyped matrices GX , GY and Gr . We fix nX = nY =
20000 and nr = 2500. The total number of SNPs is J = 300. For confounding variables,
each column of UX and UY is sampled from a standard normal distribution while each
row of corresponding coefficients η X ∈ RN0 ×1 and η Y ∈ RN0 ×1 of confounding variables is
obtained from a multivariate normal distribution N (0, Sη ) where the diagonal elements of
Sη ∈ R2×2 are 1 and the off-diagonal elements are 0.8. We simulate the following three cases
of idiosyncratic pleiotropy:
i.i.d

1. case 1: Γj = γj β0 + αj , αj ∼ N (0, σ02 ), j = 1, 2, . . . , 300. We randomly select
{5%, 10%,
20%, 25%} of IVs so that their direct effects αj s have mean 0 and variance 10σ0 2 .
i.i.d

2. case 2: Γj = γj β0 + αj , αj ∼ N (0, σ02 ), j = 1, 2, . . . , 300. We randomly select
{5%, 10%,
20%, 25%} of IVs so that their direct effect αj s have mean 10σ0 and variance σ02 .
i.i.d

3. case 3: Γj = γj β0 + αj , αj ∼ t(df ), j = 1, 2, . . . , 300, the values of freedom df are
{10, 15, 20}.
The σ02 in case 1 and case 2 is controlled by the heritability hα due to systematic pleiotropy,
h2α =

var(GY α)
var(Y)

which is set to be h2α : 0.05 and 0.07 respectively. The signal magnitude for γ

is chosen such that the heritability h2γ =

var(β0 GX γ)
var(Y)

= 0.1. The true causal effect β0 is set to

be 0.2.
We first run single-variant genetic association analysis for the exposure and the outcome
bj }j=1,2,...,300 with their
respectively, and then we obtain the summary-level statistics {b
γj , Γ
corresponding standard errors {b
σXj , σ
bYj }j=1,2,...,300 for all the three cases. Then we use the
11

Estimation
Method
rate=0.05

RBMR
MR-LDP

Estimation

RAPS(prune)
GSMR(prune)

rate=0.1

MR-Egger(prune)
IVW(prune)

rate=0.2

Method

rate=0.25

rate=0.05

RBMR
MR-LDP

RAPS(prune)
GSMR(prune)

rate=0.1

MR-Egger(prune)
IVW(prune)

rate=0.2

rate=0.25

Estimate of Causal Effect

Estimate of Causal Effect

0.30
0.25
0.20
0.15
0.10

0.3

0.2

0.1

Method

(a)

Method

h2α =0.05

(b)

Estimation
Method
rate=0.05

RBMR
MR-LDP

RAPS(prune)
GSMR(prune)

rate=0.1

Estimation
MR-Egger(prune)
IVW(prune)

rate=0.2

Method

rate=0.25

rate=0.05

RBMR
MR-LDP

RAPS(prune)
GSMR(prune)

rate=0.1

MR-Egger(prune)
IVW(prune)

rate=0.2

rate=0.25

0.6
Estimate of Causal Effect

0.4
Estimate of Causal Effect

h2α =0.07

0.3

0.2

0.4

0.2

0.1
Method

Method

(c) h2α =0.05

(d) h2α =0.07

Estimation
Method
freedom=10

RBMR
MR-LDP

RAPS(prune)
GSMR(prune)
freedom=15

Estimation
MR-Egger(prune)
IVW(prune)

Method

freedom=20

freedom=10

RAPS(prune)
GSMR(prune)
freedom=15

MR-Egger(prune)
IVW(prune)
freedom=20

0.4

0.3
Estimate of Causal Effect

RBMR
MR-LDP

0.3
0.2
0.2

0.1

0.1

0.0
Method

(e) h2α =0.05

(f) h2α =0.07

Figure 3.1: Comparisons of MR methods at heritability level of 0.05 and 0.07: The Figure (a),
(c) and (e) represent comparisons of the causal estimates βb0 of RBMR, MR-LDP, RAPS, GSMR,
MR-Egger and IVW methods at heritability level of 0.05 for three cases of idiosyncratic pleiotropy,
respectively. The Figure (b), (d) and (f ) represent comparisons of the causal estimates βb0 of RBMR,
MR-LDP, RAPS, GSMR, MR-Egger and IVW methods at heritability level of 0.07 for three cases
of idiosyncratic pleiotropy, respectively.

12

summary-level data to conduct MR analyses using the proposed RBMR, MR-LDP, MREgger, RAPS, GSMR and IVW methods. As the prerequisite for MR-Egger, RAPS and
IVW methods is that the instrumental variables are independent of each other, we adopt a
step-wise GSMR method to remove SNPs with LD structure. We repeat such experiment
for 100 times.
The simulation results are shown in Figure 3.1. In all the three cases considered, we
find that the proposed RBMR and MR-LDP methods are more stable than the other four
methods: RAPS, GSMR MR-Egger and IVW. However, we found that our proposed RBMR
method has smaller bias and root mean square error (RMSE) than the MR-LDP method.
More detailed results are provided in the Supplementary Materials.

4. Real Data Analysis
In this section, we analyzed three real data sets to demonstrate the performance of our
proposed method. The 1000 Genome Project Phase 1 (1KGP) is used as the reference panel
to compute the LD matrix (Consortium et al., 2012). We first analyze two benchmark data
sets commonly used for method comparison purpose, then we will estimate the causal effect
of coronary artery disease (CAD) on the risk of critically ill COVID-19 outcome defined as
those who end up on respiratory support or die from COVID-19.
The first benchmark data analysis is based on the summary-level data sets from two
non-overlapping GWAS studies for the coronary artery disease (CAD), usually referred to
as the CAD-CAD data. The true causal effect should be exactly one. The selection data
set is from the Myocardial Infarction Genetics in the UK Biobank, the exposure data is
from the Coronary Artery Disease (C4D) Genetics Consortium (Consortium et al., 2011),
and the outcome data is from the transatlantic Coronary Artery Disease Genome Wide
Replication and Meta-analysis (CARDIoGRAM) (Schunkert et al., 2011). We first filter
the genetic variants using the selection data under different association p-value thresholds
(p-value ≤ 1 × 10−4 , 5 × 10−4 , 1 × 10−3 ). Then we applied our proposed RBMR method
and the MR-LDP to all the selected and possibly correlated SNPs by accounting for the LD
structure explicitly. We applied the GSMR, IVW, MR-Egger and MR-RAPS methods using
the independent SNPs after LD pruning because those methods require independent SNPs.
We obtain causal effect point estimates and the corresponding 95% confidence intervals (CI)
as shown in Figure 4.1(a). We found that our proposed RBMR method outperforms other
methods because it has the smallest bias and shortest confidence intervals for a range of
13

p-value thresholds.
To further investigate the performance of our proposed RBMR method, we consider
the case that both the exposure and outcome are body mass index (BMI). We select SNPs
based on previous research (Locke et al., 2015). The exposure is the BMI for physically
active men and the outcome is the BMI for physically active women, both are of European ancestry (https://portals.broadinstitute.org/collaboration/giant/index.
php/GIANT_consortium_data_files#2018_GIANT_and_UK_BioBank_Meta_Analysis_for_Public_
Release). The point estimates and the corresponding 95% confidence intervals are shown
in Figure 4.1(b). We found that our proposed RBMR method has smaller bias than other
competing methods. More numerical results are provided in the Supplementary Materials.

Estimation
Method

RBMR
MR−LDP

threshold = 1e−4

RAPS(prune)
GSMR(prune)
threshold = 5e−4

Estimation
MR−Egger(prune)
IVW(prune)

Method

threshold = 1e−3

RBMR
MR−LDP

threshold = 1e−4

RAPS(prune)
GSMR(prune)
threshold = 5e−4

MR−Egger(prune)
IVW(prune)
threshold = 1e−3

1.2

1.0

estimate of causal effect

estimate of causal effect

1.0

0.8

0.6

0.8

0.6

0.4
0.4

Method

Method

(a) CAD-CAD

(b) BMI-BMI

Figure 4.1: The results of CAD-CAD and BMI-BMI using 1KGP as the reference panel with shrinkage parameter λ = 0.15 and screening the corresponding SNPs under three thresholds (p-value
≤ 1 × 10−4 , 5 × 10−4 , 1 × 10−3 ), , RBMR, MR-LDP, RAPS, GSMR, MR-Egger and IVW methods
use SNPs selected to calculate the casual effect estimate βb0 .

We apply our proposed RBMR method together with other competing methods to
estimate the causal effect of CAD on the risk of critically ill coronavirus disease 2019 (COVID19) defined as those who end up on respiratory support or die from COVID-19. Specifically,
the selection data set is the Myocardial Infraction Genetics in the UK Biobank and the
exposure data set is from Consortium et al. (2011). The outcome is obtained from Freeze 5
(January 2021) of the COVID-19 Host Genetics Initiative (COVID-19 HGI) Genome-Wide
Association Study (Initiative et al., 2020) (https://www.covid19hg.org/results/). The
14

Estimation
Method

RBMR
MR−LDP

RAPS(prune)
GSMR(prune)

Estimation
MR−Egger(prune)
IVW(prune)

0.2

threshold = 1e−4

Coronavirus Disease 2019 (COVID−19)

0.4

estimate of causal effect

0.3

0.2

0.1

Method
RBMR
MR−LDP
RAPS(prune)
GSMR(prune)
MR−Egger(prune)
IVW(prune)

0.0

−0.1

0.1

−0.2

−0.1

Method

(a) CAD-COVID-19

0.0

0.1

0.2

Coronary Artery Disease (CAD)

cj versus γbj for CAD-COVID-19 data
(b) Scatter plot of Γ

Figure 4.2: The results of CAD-COVID-19 using 1KGP as the reference panel with shrinkage
parameter λ = 0.15 and screening the corresponding SNPs under thresholds (p-value ≤ 1 × 10−4 ),
RBMR, MR-LDP, RAPS, GSMR, MR-Egger and IVW methods use SNPs selected to calculate the
casual effect estimate βb0 . Each point of scatter plot in Figure (b) is augmented by the standard
cj and γbj on the vertical and horizontal sides. Dashed lines are the slopes fitted by six
error of Γ
methods.

data combines the genetic data of 49562 patients and two million controls from 46 studies
across 19 countries (Initiative et al., 2021). We mainly consider the GWAS data on the
6179 cases with critical illness due to COVID-19 and 1483780 controls from the general
populations in our analysis. We use the selection data with p-value ≤ 1 × 10−4 threshold
to select genetic variants as IVs. As shown in Figure 4.2(a), we found a significant effect of
CAD on the risk of critically ill COVID-19 using our RBMR method (βb = 0.2242, p-value
= 0.0273, 95% CI = [0.0834, 0.3648]), MR-LDP (βb = 0.2197, p-value = 0.0325, 95% CI
= [0.0773, 0.3621]), RAPS (βb = 0.1835, p-value = 0.0412, 95% CI = [0.0074, 0.3596]) and
MR-Egger (βb = 0.2787, p-value = 0.012, 95% CI = [ 0.0607, 0.4967]). However, the results
of GSMR (βb = 0.1343, p-value = 0.0558, 95% CI = [-0.0034, 0.2719]) and IVW (βb = 0.1343,
p-value = 0.0700, 95% CI = [-0.0111, 0.2796]) are not significant (p-value > 0.05). Although
MR-LDP and RBMR give similar point estimate, however, our RBMR is more accurate as
its confidence interval is slightly shorter and its p-value is more significant.

15

5. Discussion
In this paper, we propose a novel two-sample robust MR method RBMR by accounting
for the LD structure, systematic pleiotropy and idiosyncratic pleiotropy simultaneously in a
unified framework. Specifically, we propose to use the more robust multivariate generalized
t-distribution rather the less robust Gaussian distribution to model the direct effects of the
IV on the outcome not mediated by the exposure. Moreover, the multivariate generalized
t-distribution can be reformulated as Gaussian scaled mixtures to facilitate the estimation
of the model parameters using the parameter expanded variational Bayesian expectationmaximum algorithm (PX-VBEM). Through extensive simulations and analysis of two real
benchmark data sets, we found that our method outperforms the other competing methods.
We also found that CAD is associated with increased risk of critically ill COVID-19 outcome
using our RBMR method.
We make the following two major contributions. First, our method can account for the
LD structure explicitly and thus can include more possibly correlated SNPs to reduce bias
and increase estimation efficiency. Second, our RBMR method is more robust to the presence
of idiosyncratic pleiotropy. One limitation of our proposed method is that it cannot handle
correlated pleiotropy where the direct effect of the IV on the outcome might be correlated
with the IV strength. We leave it as our future work.

Acknowledgements
We would like to thank the GIANT Consortium and COVID-19 host genetics initiative
for providing publicly available summary statistics to support our analysis.

References
Ala-Luhtala, J. and Piché, R. (2016). Gaussian scale mixture models for robust linear
multivariate regression with missing data. Communications in Statistics-Simulation and
Computation, 45(3).
Arellano-Valle, R. B. and Bolfarine, H. (1995).

On some characterizations of the t-

distribution. Statistics & Probability Letters, 25(1):79–85.
Beal, M. J. et al. (2003). Variational algorithms for approximate Bayesian inference. University of London London.

16

Berisa, T. and Pickrell, J. K. (2016). Approximately independent linkage disequilibrium
blocks in human populations. Bioinformatics, 32(2):283.
Blei, D. M., Kucukelbir, A., and McAuliffe, J. D. (2017). Variational inference: A review for
statisticians. Journal of the American Statistical Association, 112(528):859–877.
Bound, J., Jaeger, D. A., and Baker, R. M. (1995). Problems with instrumental variables
estimation when the correlation between the instruments and the endogenous explanatory
variable is weak. Journal of the American Statistical Association, 90(430):443–450.
Bowden, J., Davey Smith, G., and Burgess, S. (2015). Mendelian randomization with invalid
instruments: effect estimation and bias detection through Egger regression. International
Journal of Epidemiology, 44(2):512–525.
Burgess, S., Butterworth, A., and Thompson, S. G. (2013). Mendelian randomization
analysis with multiple genetic variants using summarized data. Genetic Epidemiology,
37(7):658–665.
Cheng, Q., Yang, Y., Shi, X., Yeung, K.-F., Yang, C., Peng, H., and Liu, J. (2020). MRLDP: a two-sample mendelian randomization for gwas summary statistics accounting for
linkage disequilibrium and horizontal pleiotropy. NAR Genomics and Bioinformatics,
2(2):lqaa028.
Consortium, . G. P. et al. (2012). An integrated map of genetic variation from 1,092 human
genomes. Nature, 491(7422):56.
Consortium, C. A. D. C. G. et al. (2011). A genome-wide association study in europeans
and south asians identifies five new loci for coronary artery disease. Nature Genetics,
43(4):339.
Dai, M., Ming, J., Cai, M., Liu, J., Yang, C., Wan, X., and Xu, Z. (2017). IGESS: a
statistical approach to integrating individual-level genotype data and summary statistics
in genome-wide association studies. Bioinformatics, 33(18):2882–2889.
Dempster, A. P., Laird, N. M., and Rubin, D. B. (1977). Maximum likelihood from incomplete data via the em algorithm. Journal of the Royal Statistical Society: Series B
(Methodological), 39(1):1–22.
17

Ebrahim, S. and Smith, G. D. (2008). Mendelian randomization: can genetic epidemiology
help redress the failures of observational epidemiology? Human Genetics, 123(1):15–33.
Ehret, G. B., Munroe, P. B., Rice, K. M., Bochud, M., Johnson, A. D., Chasman, D. I.,
Smith, A. V., Tobin, M. D., Verwoert, G. C., Hwang, S.-J., et al. (2011). Genetic variants in novel pathways influence blood pressure and cardiovascular disease risk. Nature,
478(7367):103.
Evans, D. M., Brion, M. J. A., Paternoster, L., Kemp, J. P., McMahon, G., Munafò, M.,
Whitfield, J. B., Medland, S. E., Montgomery, G. W., Timpson, N. J., et al. (2013).
Mining the human phenome using allelic scores that index biological intermediates. PLoS
Genet, 9(10):e1003919.
Evans, D. M. and Davey Smith, G. (2015). Mendelian randomization: new applications
in the coming age of hypothesis-free causality. Annual Review of Genomics and Human
Genetics, 16:327–350.
Frahm, G. (2004). Generalized elliptical distributions: theory and applications. PhD thesis,
Universitätsbibliothek.
Hansen, C., Hausman, J., and Newey, W. (2008). Estimation with many instrumental
variables. Journal of Business & Economic Statistics, 26(4):398–422.
Hemani, G., Zheng, J., Wade, K. H., Laurin, C., Elsworth, B., Burgess, S., Bowden, J.,
Langdon, R., Tan, V., Yarmolinsky, J., et al. (2016). MR-Base: a platform for systematic
causal inference across the phenome using billions of genetic associations. BioRxiv, page
078972.
Initiative, C.-. H. G. et al. (2020). The covid-19 host genetics initiative, a global initiative
to elucidate the role of host genetic factors in susceptibility and severity of the sars-cov-2
virus pandemic. European Journal of Human Genetics, 28(6):715.
Initiative, C.-. H. G. et al. (2021). Mapping the human genetic architecture of covid-19 by
worldwide meta-analysis. MedRxiv.
Kotz, S. and Nadarajah, S. (2004). Multivariate t-distributions and their applications. Cambridge University Press.
18

Lawlor, D. A., Harbord, R. M., Sterne, J. A., Timpson, N., and Davey Smith, G. (2008).
Mendelian randomization: using genes as instruments for making causal inferences in
epidemiology. Statistics in Medicine, 27(8):1133–1163.
Liu, C., Rubin, D. B., and Wu, Y. N. (1998). Parameter expansion to accelerate em: the
px-em algorithm. Biometrika, 85(4):755–770.
Locke, A. E., Kahali, B., Berndt, S. I., Justice, A. E., Pers, T. H., Day, F. R., Powell, C.,
Vedantam, S., Buchkovich, M. L., Yang, J., et al. (2015). Genetic studies of body mass
index yield new insights for obesity biology. Nature, 518(7538):197–206.
MacArthur, J., Bowler, E., Cerezo, M., Gil, L., Hall, P., Hastings, E., Junkins, H., McMahon,
A., Milano, A., Morales, J., et al. (2017). The new NHGRI-EBI Catalog of published
genome-wide association studies (gwas catalog). Nucleic Acids Research, 45(D1):D896–
D901.
Martens, E. P., Pestman, W. R., de Boer, A., Belitser, S. V., and Klungel, O. H. (2006).
Instrumental variables: application and limitations. Epidemiology, pages 260–267.
Pickrell, J. K., Berisa, T., Liu, J. Z., Ségurel, L., Tung, J. Y., and Hinds, D. A. (2016).
Detection and interpretation of shared genetic influences on 42 human traits. Nature
Genetics, 48(7):709.
Purcell, S., Neale, B., Todd-Brown, K., Thomas, L., Ferreira, M. A., Bender, D., Maller,
J., Sklar, P., De Bakker, P. I., Daly, M. J., et al. (2007). PLINK: a tool set for wholegenome association and population-based linkage analyses. The American Journal of
Human Genetics, 81(3):559–575.
Rothman, A. J. (2012). Positive definite estimators of large covariance matrices. Biometrika,
99(3):733–740.
Schunkert, H., König, I. R., Kathiresan, S., Reilly, M. P., Assimes, T. L., Holm, H., Preuss,
M., Stewart, A. F., Barbalic, M., Gieger, C., et al. (2011). Large-scale association analysis
identifies 13 new susceptibility loci for coronary artery disease. Nature Genetics, 43(4):333–
338.
Solovieff, N., Cotsapas, C., Lee, P. H., Purcell, S. M., and Smoller, J. W. (2013). Pleiotropy
in complex traits: challenges and strategies. Nature Reviews Genetics, 14(7):483–495.
19

Van der Vaart, A. W. (2000). Asymptotic Statistics, volume 3. Cambridge University Press.
Verbanck, M., Chen, C.-y., Neale, B., and Do, R. (2018). Detection of widespread horizontal
pleiotropy in causal relationships inferred from mendelian randomization between complex
traits and diseases. Nature Genetics, 50(5):693–698.
Wang, B. and Titterington, D. (2005). Inadequacy of interval estimates corresponding to
variational bayesian approximations. In AISTATS. Citeseer.
Yang, Y., Dai, M., Huang, J., Lin, X., Yang, C., Chen, M., and Liu, J. (2018). LPG: A fourgroup probabilistic approach to leveraging pleiotropy in genome-wide association studies.
BMC Genomics, 19(1):503.
Yang, Y., Shi, X., Jiao, Y., Huang, J., Chen, M., Zhou, X., Sun, L., Lin, X., Yang, C.,
and Liu, J. (2020). CoMM-S2: a collaborative mixed model using summary statistics in
transcriptome-wide association studies. Bioinformatics, 36(7):2009–2016.
Zhao, J., Ming, J., Hu, X., Chen, G., Liu, J., and Yang, C. (2020a). Bayesian weighted
mendelian randomization for causal inference based on summary statistics. Bioinformatics,
36(5):1501–1508.
Zhao, Q., Wang, J., Hemani, G., Bowden, J., and Small, D. S. (2020b). Statistical inference
in two-sample summary-data mendelian randomization using robust adjusted profile score.
Annals of Statistics, 48(3):1742–1769.
Zhu, X. and Stephens, M. (2017).

Bayesian large-scale multiple regression with sum-

mary statistics from genome-wide association studies. The Annals of Applied Statistics,
11(3):1561.
Zhu, Z., Zheng, Z., Zhang, F., Wu, Y., Trzaskowski, M., Maier, R., Robinson, M. R.,
McGrath, J. J., Visscher, P. M., Wray, N. R., et al. (2018). Causal associations between risk
factors and common diseases inferred from gwas summary data. Nature Communications,
9(1):1–12.

20

