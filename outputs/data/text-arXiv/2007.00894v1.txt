JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

1

Decentralized Blockchain for Privacy-Preserving
Large-Scale Contact Tracing

arXiv:2007.00894v1 [cs.CR] 2 Jul 2020

Wenzhe Lv, Student Member, IEEE, Sheng Wu, Member, IEEE, Chunxiao Jiang, Senior Member, IEEE,
Yuanhao Cui, Member, IEEE, Xuesong Qiu, Yan Zhang, Fellow, IEEE

Abstract—Activity-tracking applications and location-based
services using short-range communication (SRC) techniques have
been abruptly demanded in the COVID-19 pandemic, especially
for automated contact tracing. The attention from both public
and policy keeps raising on related practical problems, including
1) how to protect data security and location privacy? 2) how to
efficiently and dynamically deploy SRC Internet of Thing (IoT)
witnesses to monitor large areas? To answer these questions, in this
paper, we propose a decentralized and permissionless blockchain
protocol, named Bychain. Specifically, 1) a privacy-preserving
SRC protocol for activity-tracking and corresponding generalized
block structure is developed, by connecting an interactive zeroknowledge proof protocol and the key escrow mechanism. As a
result, connections between personal identity and the ownership
of on-chain location information are decoupled. Meanwhile,
the owner of the on-chain location data can still claim its
ownership without revealing the private key to anyone else. 2)
An artificial potential field-based incentive allocation mechanism
is proposed to incentivize IoT witnesses to pursue the maximum
monitoring coverage deployment. We implemented and evaluated
the proposed blockchain protocol in the real-world using the
Bluetooth 5.0. The storage, CPU utilization, power consumption,
time delay, and security of each procedure and performance of
activities are analyzed. The experiment and security analysis is
shown to provide a real-world performance evaluation.
Index Terms—Blockchain, Potential Field, Contact Tracking,
COVID-19

I. I NTRODUCTION
A. COVID-19 Requirement
The COVID-19 pandemic has been a global health emergency, spreading to more than 18 countries of the world and
infecting more than 8,359,869 population. As an essential
tool for public health officials and local communities to fight
the rapidly spreading, contact tracing methods draw attention
across the world. Early in the outbreak, when there were only
a few cases, contact tracing can be done manually with a slight
impact on society. Nevertheless, with the skyrocketing of the
infections in the vast majority of countries, manual contact
tracing tends to be unrealizable on both economy and policy
considerations.
Location-Based Services (LBS) provided by Short-Range
Communication (SRC) techniques are considered a viable
Wenzhe Lv, Sheng Wu, Yuanhao Cui, Xuesong Qiu are with School of
Information and Communication Engineering, Beijing University of Posts
and Telecommunications, Beijing 100876, China. (E-mail: {lvwz, thuraya,
cuiyuanhao, xsqiu}@bupt.edu.cn)
Chunxiao Jiang are with Space Center, Tsinghua University, Beijing
100084, China. (E-mail: jchx@tsinghua.edu.cn)
Yan Zhang are with Department of Informatics, University of Oslo, Oslo,
Norway. (E-mail: yanzhang@ieee.org)

solution to perform contact tracing. Due to the intensive
penetration of mobile smartphones, wearable devices, and
ubiquitous sensors, residents can opt-in contact tracing service
via an over-the-air mobile application installation, whenever
Internet access is available. The Singaporean government
released a mobile phone app, TraceTogether, that is designed
to assist health officials in tracking down exposures after an
infected individual is identified.
In general, a recorded SRC interaction with timestamp and
locationinfo can certify that, at a given moment and position,
two radio terminals have been closer than the maximum
transmission distance. If one of the two terminal owners is
tested positive for COVID-19, the SRC record can be strong
evidence of epidemiological exposure for the other owner.
Therefore, the contact identification can be automatically made
by analyzing the infected person’s SRC records.
On the other hand, the chosen of SRC standard and storage methods would significantly impact the performance of
SRC-based contract tracking. Shorter communication distance
increases identity accuracy. An overlong communication range
may result in excessive identified contactees whose physical
exposure may do not actually occur. As an example, the South
Korea government analyzes Call Detail Record (CDR) collected from telecommunication operators. When a COVID-19
patient is detected, the entire building should be quarantined,
which results in a significant impact on the company business.
Therefore, benefit from easy to deployment and stone-cast
data transmission, Bluetooth Low Energy (BLE) has been
considered as a possible contact tracing approach.
B. Daily Requirement
If we take a longer-term and world-wide perspective, increasingly more people rely on LBS apps to track, monitor,
manage, and plan their daily life. These mobile apps have
profoundly impacted and even initialized various industries,
such as Uber [2] and DiDi in transportation sharing, Ele in
food delivery, Fitbit and Nike+ in fitness, and Pokergo in
augmented reality games. The key features of these apps are
to collect location information in a certain time period and to
perform path generation to share the personal location/activity
path/summary with other users/service providers on a social
network. For example, activity-tracking programs are developed in United Health and Aetna to modify insurance rates
according to an activity analysis [3].
However, these activity-tracking services assume users are
trusted and honest to report their location and time information, which is generally impractical and unrealistic. Indeed,

JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

the fashion of self-reporting location information using global
positioning system (GPS) coordinates, cell triangulation and
IP address tracking are all susceptible to manipulation such
that users can handily claim a mendacious location [4], which
may cause serious cheating issues, especially to financial and
critical service providers. To address these issues, SRC records
also consider being an applicable method to improve their
location reliability.
C. Challenges and Motivations
Although LBS provided by SRC (especially BLE) techniques are highly demanded in the contact tracing of COVID19 pandemic and many more daily demands, much uncertainty
still exists on data security, privacy, and deployment efficiency.
• Security: Traditional security services such as authentication, integrity, and provenance provided by thirdparty brokers. However, the third-party brokers maybe
not trustable.
• Privacy: User privacy may be violated when service
providers collect, store, and analyze customer’s locations
using a centralized database. The service providers can
even sell customer data by taking a little advantage
of the fine print in the service agreements. Although
Europe’s General Data Protection Regulation (GDPR) has
been implemented, the unintended data leakage of service
providers still call for technical privacy concerns.
• Deployment Efficiency: A phone-to-phone SRC record
demonstrates the spatial connection between two individuals. However, long-term monitoring of a high-risk hotspot area is still critical in contact tracing. Governments
or philanthropic organizations are willing to deploy several IoT witnesses, e.g., BLE beacons, to achieve an allweather day-and-night low-cost area surveillance. These
organizations may not cooperate. Therefore, an efficient
deployment strategy is desired in the blockchain system.
In this paper, we propose a permissionless blockchain
for automated contact tracing and activity-proofing, named
Bychain. An interactive zero-knowledge proof based protocol
is designed to provide transaction security and identity privacy
while taking advantage of cryptographic techniques instead
of employing a trusted third party. The deployment problem
is addressed by proposing an incentive allocation mechanism
based on a visual potential field algorithm; a participant would
be distributed the maximum reward when it is on the position
of force equilibrium. Ideally, the blockchain network archives
maximized monitoring area when the IoT witnesses in the
blockchain are static equilibrium.
This protocol relies on the cryptography technique to create
SRC proofs for its nearby mobile users. The proposed protocol
consists of three stages: First, users obtain secure and privacypreserving proofs of location during their activities, by relying
on an over-the-air lightweight message exchange between their
mobile device and the witness point. Proof of Location (PoL)
commitments are generated, digitally signed, and verified by
their nearby witness nodes through BLE techniques. Second,
the activity proofs are uploaded on a decentralized ledger
that is transparently and distributively stored on the Internet.

2

Finally, the trusted activity summary can be generated by
using a zero-knowledge proof based authentication based on a
smart contract after an ownership verification. The blockchain
could compute an accurate and trusted activity summary of
an authenticated user to fulfill the requirement of COVID19 contact tracing, without revealing activity information to
anyone else.
To empower Bychain with the ability of witness deployment, an incentive allocation algorithm is proposed based
on the virtual potential field. Each witness node is treated
as a charged particle, such that artificial electric fields are
constructed in a way that each node is repelled by repulsive
force from other nodes. As a result, the witnesses in blockchain
could spread itself throughout the environment. Finally, the
monitoring area of the blockchain system tends to maximize
the monitoring area when the IoT witnesses in blockchain tend
to static equilibrium.
Additionally, in the blockchain system, a semi-trusted decentralized activity-proofing system and zero-knowledge based
authentication techniques could provide security from cheating
and protect identity privacy. The public essential cryptography technique is naturally merged to provide an ownership
certification of personal location information. As a benefit
from the zero-knowledge proof technique, a user could claim
data ownership without revealing the private key to anyone
else. However, the decentralized ledger is transparent such
that the public can verify the location information. Hence, we
introduce a crucial escrow technique to alternate the traditional
one-key-per-user with a one-key-per-proof scheme. The onchain data traceability becomes almost impossible, and the
identity information is pseudonymous. Thus, data security
and identity privacy requirements are met in our system.
Consequently, the attack of controlling the certificate authority
and the central database can be avoided. Furthermore, plenty
of attacks can be avoided, such as the reply attack and the
dust attack. We will discuss them in detail later in this paper.
The contributions of this paper can be summarized as
follows:
• A proof-of-activities generation and verification protocol is introduced to achieve trusted activities proof for
contact tracing and related SRC usage. Bychain protocol
addresses the activity-proofing problem without a trusted
third party while considering privacy and anonymity.
Buchanan can also fastly applied in COVID-19 with a
low economic cost.
• By jointly design of crucial escrow and zero-knowledge
proof method, the proposed protocol is able to obtain
location identity privacy and security. It can resist various
attacks and collusion. A generalized block structure is
proposed to fulfill the requirement of new on-chain operations. Furthermore, to address the efficient deployment of
IoT witnesses, an incentive allocation mechanism using
virtual potential field is proposed to maximizing the
monitoring area.
• A prototype implementation is realized and verified on
the Android platform. The performance analysis shows
that our protocol requires preferably low computational
time, energy, and storage. Experiments show that the

JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

proposed protocol is practical and can be applied in many
scenarios, even in a highly dynamic environment.
The rest of the paper is organized as follows. Section II
discusses related work. Section III describes the overview of
the proposed blockchain system. In Section IV, we discuss our
proposed proof of activity protocol and incentive allocation
mechanism. A security analysis of our proposed protocol
against different types of attacks is provided in Section 5. In
Section VI, we describe our implementation and simulation
and present our experimental results on the performance
evaluation. Finally, Section VII concludes the paper.
II. R ELATED W ORK
Security and privacy of LBS and activity-tracking services
are becoming a serious problem. The GPS verification mechanism can be modified by simply and easily cheating by
modifying the geolocation API value return [4]. Moreover,
the work in [5] analyzed data from Foursquare and Gowalla
and found that incentives to cheat exist because people actively
check-in and collect rewards. Thus, it is necessary to carefully
balance incentives with a more effective verification of users’
location claims.
Many works have been discussed in the mobile computing
society to offer secure verification of location information [6]–
[8]. Short-range communication technologies, such as Bluetooth, have been proposed to generate location evidence from
its neighbors. The mutual verification protocol of a set of users
is proposed based on users’ spatiotemporal correlation in [9].
A centralized location verifier is applied to verify mutually
colocated users relying on Bluetooth communications. The
privacy is performed by deciding whether to accept location
proof requests and is decided by the users. APPLAUS is proposed in [10] as similar work on a collusion-resistant location
proof updating system using collocated Bluetooth devices.
In addition, STAMP provides a spatial-temporal probabilistic
provenance assurance for mobile users [11]. The collision
detection for such protocols is not 100 percent effective, and
the protocol does not itself guarantee any collusion resistance.
SRC based contact tracing is developing by Google and
Apple [12] in a privacy-preserving fashion. However, the SRC
records are stored in mobile terminals facing storage shortage
problems. The deployment of IoT witnesses is not supported as
well. Indeed, blockchain technology and its applications have
drawn enormous attention from various researchers. In [13],
highly reliable communication is supported by blockchain and
neural networks for unmanned aerial vehicles. A blockchain
protocol is also proposed to manage data for the vehicular
network in [14]. However, the above applications can not
address the location problems in this article.
III. A N OVERVIEW OF L OCATION -BASED B LOCKCHAIN
A RCHITECTURE
The proposed blockchain protocol is a peer-to-peer system,
which provides users with anonymous and trusted location
proofing, transparent data storage, and zero-knowledge proof
based data ownership authorization. Fig. 1 illustrates the

3

proposed blockchain architecture, in which the network is
summarized as three layers :
• The service layer contains honestly witnesses that afford
location-proofing service to passing-by provers via nearfield communication techniques, and verifiers that finally
generate activity certifications in the form of tabular
activation summary. In a given time period, Tn , a prover
collects witness-signed PoL commitments and then uploads them on blockchain as the cornerstone of trust
evaluation. A straightforward trust level evaluation via the
cumulative method is marked as green labels in Fig.1.
• The network layer enables the peer-to-peer (P2P) transmission mechanism to exchange collected PoL commitments of each prover and virtual force of each witness.
This information are carried by the Transactions (Tx) field
in the proposed generalized data structure and received
by chain nodes.
• The blockchain layer is comprised of a distributed
database recording immutable and continuously growing
transactions and a location-based consensus mechanism
maximizing total coverage of witness nodes, which is
detailed in Sec.IV. The blockchain system disburses
a budget coverage package per 24 hours to stimulate
witness movement to form maximum coverage of the
sensing area. During each round of consensus procedure,
a miner calculates the incentive allocation scheme and
then sticks it into the next block. The miner is pseudorandomly determined from a node sequence in the order
of owned stock value. The proposed block is broadcasted
and finally confirmed by an elected consensus committee
according to the value of mortgaged stocks.
The key entities and mechanisms in each layer would be
detailed in the following subsections.
A. The Service Layer
Individuals can access the blockchain with unified application software, which ensures data integrity by forcing a data
consistency check when initializing. The service layer establishes a set of available application operations and coordinates
the application’s response in each operation. Although all IoT
nodes with application installation are fully functional, the
three logical roles involved in those operations need to be
elaborated for a better understanding of readers.
1) Prover: In the proposed blockchain architecture, the
prover acquires anonymous and trusted location proofing,
transparent data storage, and zero-knowledge proof based data
authorization. Provers indeed are a set of wireless nodes
that desires location-based proof-of-activities. Each prover is
equipped with a GPS module as well as Bluetooth, WiFi,
or LTE antennas has Internet activity to the blockchain and
moves in a given region that is covered by our wireless access
point (AP) networks. These provers can communicate with
AP nodes involved in our system only if their distance is
lower than the communication distance R, where R is determined by the near-field communication technology, which
means Bluetooth, WiFi or LTE will provide three kinds of
distances, defined as RB , RW , and RL , respectively. The sum

JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

4

In a Sparse Witness
Zone at Tn+1

In a Dense Witness Zone at Tn

Activity Start

Bluetooth Witness

WiFi Witness

Activity End
Summary

WiFi Witness

Trusted Level 1

Service Layer

Tx1

…..

Tx2

…..

Tx1

Prover
Tx5

Trusted Level 5

…..

Tx1

Tx3

Bluetooth Witness

Tx4

Tx2

Collection of Transactions at Tn
Tx1

…..

Tx2

Tx3

Zero Knowledge Proof
Varifier

Bluetooth Witness

LTE Witness

Bluetooth Witness

Collection of Transactions at T1

Trusted Level 2

NR Witness

Tx4

Distance: 5km
Time : 30 min
Path :
Witness 1 9:00;
Witness 2 9:10;
…..
Witeness k 9:30;

Collection of Transactions at Tn+1

Tx5

Tx1

Tx2

Tx1

Network Layer

P2P Network
Location Based Stimulations

…..

Block BTn+1
Block Header ( including Hash of BTn )
Payload Data (2 Transactions)

Block BTn
Block Header (including Hash of BTn-1)
Payload Data (5 Transactions)

…..

Candidate Block

Candidate Block
Merkle Tree organizing Blockchain Database
Merkle Root

Blockchain Layer

Hash 12

Candidate Block

Candidate Block

Hash 34

Hash 3

Hash 4

Payload Data

Payload Data

Candidate Block

Candidate Block

Incentive Based Deployment

Fig. 1. Overview of proposed blockchain architecture.

of communication durations between provers and AP nodes
can be completed before the prover leaves the coverage area
of AP, which is verified in our experiment.
Each prover i is equipped with a memory as a critical
escrow agent to stock pairs of cryptology keys. The stocked
vital pairs are generated when service initializes and randomly
sign each near-field communication message, which means
the kth proof-of-location commitment is uniquely identified
by public key pkpki and a private key skpki . Without loss of
generality, we assume provers will never hand or even reveal
their private keys to anyone else.
2) Witness: Witnesses are wireless nodes that provide
location-based proofs to provers. These witnesses may be
fixed WiFi APs, Bluetooth low power equipment (BLE) or
an LTE base station owned by an ISP provider, deployed in
the area where provers pursue their proofs. More importantly,
a witness could discover another if their distance is lower than
its coverage radius. Hence, witnesses are aware of the locations
of their neighbors.
All the witnesses and provers have synchronized clocks
and are equipped with a GPS device that is aware of the
location of itself. This WiFi AP localization technique can
be realized by the analysis of communication channel state
information. Different from provers, each witness i can be
uniquely identified by a pair of cryptology keys, known as
a public key pkwi and a private key skwi . Without loss of
generality, we also assume the witness will never hand or
even reveal their private key or digital signature to anyone
else. The witness can access the Internet and communicate

with the blockchain.
In our system, we assume each witness is semi-trusted and
privacy-honest, which means it does not reveal the prover’s
information to any nodes, but cheating such as collusion may
occur. Practically, a witness is probably willing to collude with
other witnesses or provers cheating for blockchain awards.
3) Verifier: A verifier is an entity that a prover wants to
request an activity certification from, such that a prover’s claim
appears in a certain location at a particular time. The verifier
is completed by interactive zero-knowledge proof based on the
smart contract, such that it is self-running and able to protect
the identity privacy of a specific user.
When the prover intends to request certification, a verification request including the on-chain index of PoL commitment,
public keys of the prover, and witness are submitted to the
blockchain system. The verifier smart contract is triggered
when the particular verification request appears in a new block.
Consequently, the ownership of the PoL commitment is verified by a zero-knowledge proof algorithm without revealing
private keys to anyone else. Hence, the prover can be verified
and certified as the owner of the particular PoL commitment,
i.e., the prover is witnessed at a certain timestamp.
B. The Network Layer
The network layer takes responsibility for routing data
packages between blockchain nodes. Considering lacking retransmission and reordering in User Datagram Protocol (UDP),
transmission reliability of large package (block size up to 4

JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

MB) could not meet the network requirement. Bychain uses
an unstructured peer-to-peer network with TCP connections as
its foundational communication protocol.
Bychain introduces several novel operations in the service
layer such that traditional blockchain data structure [22] could
not be straightforwardly applied. Take several new operations
as an example, 1) the prover intermittently broadcasts a
package including multiple PoL commitments collected in a
time window. 2) The witness reports its location and virtual
forces during every round of consensus procedure. 3) In the
blockchain layer, the miner publishes the incentive allocation
into the next block, which will be detailed in the next section.
Hence, for efficient and confidential data transmission, Bychain reconstructs the transaction structure and then develops
a general block format, as shown in Fig.2. More precisely,
Expiration and Signature fields are applied to indicate the
producer and timeslot of one transaction. Hence, there would
be multiple Operations happening over the specified identity
and time duration. The broadcasted transactions are stored in
a buffer pool to be serially packaged into Blocks. The buffer
pool is maintained and checked by the consensus committee.
C. The Blockchain Layer
In contrast to existing location-proof methods, the proposed
system does not require a trusted centralized third-party. Furthermore, aiming to endow the blockchain with maximizing
the monitoring area, Bychain proposes a new location consensus based on the virtual electric field to maximizing the
sum coverage of the location-proofing service. Furthermore,
Bychain adopts an interactive zero-knowledge proof method
to ensure data confidentiality and anonymity. We will describe
the necessary entities and mechanisms in the following.
Blockchain is composed of a distributed database and a
peer-to-peer node network. The blockchain database is a
secured, shared, fault-tolerant, distributed, and append-only
database that facilitates consensus-based recording and tracking information without a centralized, trusted third party. The
blockchain network is based on the peer-to-peer communication protocol and untrusted nodes.
All the data processes on the blockchain are decided by the
majority users in the blockchain network, and the decisionmaking procedure is called consensus generation or mining a
block. All the network nodes attend a mining competition in
each turn to decide which node can produce and broadcast the
new block to the other nodes. The new blocks are composed
of new unpacked data in the distributed database. There are
several existing consensus generation algorithms, including
Proof-of-Work (PoW) [15], Proof-of-Stake (PoS) [16], [17],
Proof-of-Space (PoSpace) [18] and practical Byzantine fault
tolerance (PBFT) [19].
The blockchain system produces cryptocurrency to incentivize miners to take part in competitions for block recording
rights in each turn. Due to the majority decision and resourceconsuming competition, the blockchain does not rely on a
traditional trusted third party when recording data if the majority of network nodes are honest. It is because a successful
attack can only occur when the attacker wins enough mining

5

competitions; however, the cost of this 51% attack would
go beyond expectation. According to an analysis in 2018
December [20], it will cost 1.4 billion dollars to realize the
51% attack in the Bitcoin blockchain.
Although a blockchain is composed of a database and a
node network, the decentralized system is able to process
some proper, on-chain, and heavily automated workflows by
using the concept of the smart contract [21]. Smart contracts
are self-executing scripts stored in the blockchain database
and independently executed on each network node in a sandboxed virtual machine. The Turing-complete virtual machine
allows us to implement complicated logic smart contracts
with deterministic outputs and on-chain data interactions. The
smart contract can be regarded as a predetermined on-chain
rule triggered by particular on-chain data, such as a specific
transaction.
1) Signature and Key Escrow: To validate the authenticity of PoL commitments and on-chain transactions, our
blockchain employs the elliptic curve digital signature algorithm (ECDSA) asymmetric cryptography technique. The
ECDSA cryptography is implemented by using the secp256k1based Koblitz curve for the ECDSA key-pair in the opensource project OpenSSL. The generated private witness key
is able to sign the PoL messages to authorize that the prover
appears in a particular location and at particular timestamps.
Furthermore, the on-chain transaction data also need to be
signed such that the transaction is traceable and verifiable.
Due to the on-chain data transparency, anyone can access
and analyze the on-chain data freely. In this case, identity privacy becomes a critical problem introduced from the
blockchain technique because the prover’s activity information
can be easily tracked on the blockchain. In our protocol, a key
escrow is employed for the prover to achieve the separation
of identity information and location information. A primary
private key and several generated key pairs are initialized and
stored in the memory when the system initializes. The generated vital pairs are iteratively employed for each PoL message
interaction procedure, and consequently, the generated public
key is uploaded into the blockchain database for verification.
Because it is almost impossible to calculate the main private
key based on the generated public key, we consider that the
identity privacy is achieved.
2) Zero-Knowledge Proof Based Authorization: Because
the key escrow is applied in our protocol, the only way to
verify the identity information of the on-chain PoL commitment is by checking the private key. However, there is
no third party that can be trusted to verify the private key
on a blockchain system. Otherwise, location privacy may be
’stolen’ by copying the private key.
zero-knowledge proof technique tries to help a verifier trust
a prover without leaking any secret information to anyone else
during the verification procedure. In this paper, we employ
an interactive proof scheme in which the prover demonstrates
its authorization information (private key) to the verifier by
several interactive rounds. During the interactive procedure,
the prover answers a randomly generated challenge from the
verifier. However, most of the recent zero-knowledge proof
based authorization to reply to a trusted third party, which is

JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

Block
proposal

Information
propagation

Block
validation

6

Block
finalization

23%()*+&,- * .
*+&,-)45

!"#$%&'()*+&,* ./1

!"#$%&'()*+&,* ./0

*+&,*.

67(3

!7"#8.)37(3

2"78(7,.%&8();#"-+#)"&&.

<%=8%8=)>#?

E:#"7.%&8 @ E0 A E9 B
#
!

H!<)
%8I&"97.%&8

!&J) "
,&99%.9#8.

%8,#8.%$#)7++&,7.%&8

E:#"7.%&8).?:#
G&8.#8.

!

2%9#(.79:

"

#

F##

F##)&:.%&8(

;%8#"

;%8#")(%=87.'"#

2"78(7,.%&8 @ 2 0 A 2 8 B
2"78(7,.%&8)45
CD:%"7.%&8
<%=87.'"#(
E:#"7.%&8)79&'8.

K#7,&8

Fig. 2. The proposed generalized block structure, the transaction field is extended to support multiple new operations.

not always practical in the real world.
In our system, zero-knowledge proof based authorization
procedure is considered part of our blockchain so that the
information leakage risky from a third party is avoided. Hence,
the private key is not required when verifying the clear onchain proof-of-location commitments.
Furthermore, the blockchain itself can generate and distribute and update sets of pseudonyms (the pairs of the public
key and private key as mentioned above) for every prover and
witness.
IV. P ROPOSED P ROTOCOL AND L OCATION -BASED
C ONSENSUS
In contrast to existing location-proof methods, the proposed
system does not require a trusted centralized third-party.
Furthermore, Bychain proposes a new DPoS consensus based
on the virtual electric field to maximize the sum coverage of
the location-proofing service. We will describe the necessary
entities and mechanisms in the following.
A. Proposed Protocol
Our goal is to establish an activity-tracking and locationproofing system that guarantees the authenticity of the user
location and activity data with respect to cheating nodes,
the underlying untrusted centralized supernode, and malicious
nodes, and provide almost complete privacy protection with
respect to on-chain nodes that are trying to track provers. In
this section, we detail our blockchain-based proof-of-location
system. The system is shown in Fig. 1, and the scheme is
shown in Fig. 5. Two stages are involved in our proof-ofactivities protocol, the proof-of-location stage, and the activity
generation stage, and they are denoted as follows,
Stage 1: Proof of Location
1) Broadcasting: The broadcasted PoL request can be descried by multiple witness nodes as shown in Fig. 3. Suppose
a prover pi at location Li,t wants to start an activity proof

collection event at sampling time t, so it periodically generated
a location proof request Pik using the kth pair of cryptology
keys {pkpki , skpki } and broadcasts Pik to nearby devices. Note
} when
, skpk+1
that {pkpki , skpki } will be updated as {pkpk+1
i
i
this PoL stage is completed. The PoL request is constructed
as follows,
Pik = C{pkpki , noncepi (t), Lpi ,t , t, Sskpk },

(1)

i

where noncepi (t) is a random number with respect to
prover pi and timestamp t and Lpi ,t represents the current location information at time t. The payload data
is compressed by the SHA256 function H() to reduce
the communication complexity in the signature. Sskpk =
i
Signskp {H(pkpki , noncepi (t), Lpi ,t , t)} denotes the signature
i
of skpki agrees with the PoL request. The request is specified
with respect to wireless protocols that are denoted as C{}.
2) Response: Each witness in its communication range
decides whether to respond to the request. The witness
node may reject the PoL request due to fake parameters,
for example, the location information in Pik shows that
distance between the prover and current witness is significantly larger than the communication range. Request rejection also happens if crypto-verification fails, i.e., Sskpk 6=
i
Signskp {H(pkpki , noncepi (t), Li,t , t)} or is not paired with
i
the public key pkpki in Pik . If the request is accepted by the
witness j, the witness sends back a response message Rjk at
timestamp t0 . Without loss of generality, the time difference
t0 − t is not enough for the prover to move out of witness j’s
communication range. Rjk can be constructed as follows,
Rjk = C{pkpki , noncepi (t), Li,t , t, Sskpk , noncewj , Sskpk

},
(2)
where noncewj = {pkj ||n} is a combination of public key
pkj of witness j and an unrepeatable built-in counter as
n. It is worth noting that pkj is specific and unique to juser, and noncewj functions as an on-chain index of the PoL
commitments.
i

i

k
,skw

j

JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

!"#$%&&'2

!"#$%&&')

!"#$%&&'2
!"#$%&&'3

P ik

P ik

Pi
P ik

!"#$%&&')

!"#$%&&'(

4/5+,4674&#"$8
!"#$%&&'2

@#>'!"#$%&&

*+,-%+'"

R$k

./0%&1,$&%&

5<,7=7>4"$

Verifier Smart
Contract

P ik

R!k

Rjk

0%&1,$&%&
A,<<%7#",$

!"#$%&&'(

*+,,B',B'C,74#",$
9#48%

5<,7=7>4"$'&?&#%;

!"#$%&&'3

!"#$%&&')
*+,-%+'"

"#>'*+,-%+

!"#$%&&'3

R"k

R#k

k

*+,-%+'"

7

D7#"-"#?'E%$%+4#",$
9#48%

Comik

Nik

F%+,'G$,H<%68%'*+,,B'0%I:%&#

Comik

J4#4'K:%+?
VPki

rPki

F%+,'G$,H<%68%'*+,,B'0%&1,$&%

!"#$%&&'(

9:;;4+?'0%&1,$&%

7/9:.;"&&",$
Fig. 3. The proposed protocol consists of two stages, including PoL stage and activity generation stage.

Algorithm 1 The Proposed Bychain Protocol
Sskpk

i

k
,skw

j

= Signskw {H(pkpki , noncepi (t), Li,t ,
j

t, Sskpk , noncewj )},

(3)

i

1

skpki

agrees with this response. This
denotes that a signature of
response is sent back to the prover as a witness location proof.
3) Submission: Consequently, a dozen of responses with
diverse witness signatures are collected at the prover’s antenna
in a short time window. If the responses originate from M
receivers, then the PoL commitment can be constructed by
combining all the PoL responses,
Comki

=

k
{R1k ||R2k || · · · ||RM
}.

(4)

2
3

4
5
6
7
8
9

10

Comki is uploaded on the blockchain such that the PoL commitment for kth PoL request at the ith prover is immutable.11
A trusted level of Comki can be generated at the activation12
summary depending on number of combined PoL responses.13
The prover-witness collusion attack can be avoided when M 14
is large enough and the honest witnesses are more than M
2 .15
These steps are illustrated in Fig. 3.
16
For each submitting procedure k, a PoL note is stocked17
for a further zero-knowledge proof. The PoL note is a com-18
bination of private key skpki in the broadcasted request, the
random number noncepi (t) and the collected witness indices19
noncew1 , . . . , noncewM and can be written as,
Nik = {skpki ||noncepi (t)||t||noncew1 || · · · ||noncewM }

(5)20
21

PoL notes the function as an identifier of its corresponding22
on-chain commitment, prover always can precisely locate the23
on-chain commitment and proofs of the ownership to anyone24
else by a zero-knowledge proof smart contract verifier without25
26
revealing the private key skpki .
27
28

Input: Key pair {pkpki , skpki }, Responsed Witeness Set
w1 , w2 , ..., wM , Maximum Response Duration Tmax .
Output: Activity Summary
Stage 1 : Proof of Location
for Prover pi do
Generate and Broadcast PoL request Pik according to (1).
A clock is initialized as T .
foreach witness i in w1 , w2 , ..., wM do
PoL response Rjk is generated according to (2)
end
while T ≤ Tmax do
Responses collection and combination according to
(4).
end
Local storage for private key and nonces storage according
to (5).
end
Stage 2 : Activity Generation
for Prover pi do
Generate and transmit verification request according to (6).
rpki is returned from contract.
Generate and transmit Proof according to (7).
for Verifier do
if Verifypki (Proof) == Signskp {H(noncepi (t), rpki )}
i
then
if
Verifypki (Sskpk )
equals
to
i
k
Signskp {H(pkpi , noncepi (t), Li,t , t)} then
i
Activity Summary transmission starts.
else
The verification is failed.
end
else
The verification is failed.
end
end
end

JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

8

Stage 2: Activity Generation
In our system, the activity summary is generated by two
steps: location verification and summary generation.
1) Location Verification: To verify the kth commitment,
a single-round interaction zero-knowledge proof is applied.
Firstly, prover pi produces a verification request,
Vpki = {noncew1 || · · · ||noncewM }.

(6)

The smart contract verifier searches on-chain data
according
to
index
noncew1 || · · · ||noncewM .
The
outcome is the kth PoL broadcasting request, shown as
{Li,t , noncepi (t), pki , t, Sskpk }. Consequently, the verifier
i
generates a pseudorandom number rpki as response to prepare
zero-knowledge verification.
Secondly, the prover signs a proof by using skpki , as
Proof = Signskp {H(noncepi (t), rpki )}.
i

(7)

The verifier can identify the ownership of the commitment
by comparing H(noncepi (t), rpki ) with on-chain noncepi (t)
and local rpki , which is according to the randomness of rpki
and noncepi (t). The private key skpki will not be revealed
to the verifier such that no one can complete the ownership
verification in the future except prover i.
Finally, the verifier returns true or false as a result of PoL
verification. It implies whether or not the PoL commitment
belongs to the specific prover i.
2) Summary generation: After each PoL is verified, the
smart contract produces an activation summary, including the
trusted level generated from the number of witnesses M and
the activation path.
B. Location-based Consensus
!"##$%%&&
'(")*

'(")*

'(")*
,-",/2/%$"3
4

1 block
verification

6

'(")*

4

'(")*

4

4

1 block

1 block

1 block

verification

verification

verification

)"##$%%&&+&(&)%$"3

:

0

block
finalization

567
507
547

9

$3)&3%$8&+/((")/%$"3

Fig. 4. The overview of location based consensus.

'(")*

'(")*+,-","./(

In this subsection, we present the details of the locationbased consensus algorithm. Inspired from DPoS and aiming
to maximize the monitoring area, the proposed consensus
algorithm consists of six parts: 1) committee election, 2) block
proposal, 3) block propagation, 4) block validation, 5) block
finalization and 6) incentive mechanism. Different from DPoS
or another consensus, the participants of Bychain are given
a different number of votes according to its last location
reward. The reward allocation (or incentive allocation) scheme
is one of the vital consensus procedures for permissionless
blockchain [23], especially to encourage the profit-oriented
blockchain participants to act in the way Bychain expect them
to. The details about the proposed consensus are introduced
in the following.
1) Committee Election: Although every participant in Bychain can be elected as a committee member, the computation capacity limited by hardware should meet the minimum
requirement of the block and consensus computation. On
the other hand, instead of DPoS, where stockholders vote
for a committee candidate according to personal willingness,
the IoT devices in Bychain prefer the candidate with high
utility, i.e., the higher network quality and higher computation
capacity, the higher probability to be voted.
From the viewpoint of IoT node n, the timestamps of
transaction generation, block proposal and block finalization
can be observed in the finalized blocks. Therefore, for given
T th transaction that collected by mth committee member in
block B, the delay of transaction and block procedure can be
written as,
B(T )
T
C
τn→m
= τn→m
+ τm
+ τfBinal ,

(8)

T
τn→m

denotes the delay of transaction propagation from
where
node n to committee member m. The block computation delay
C
ha
τm
consists of three parts: a) the hash time consumption τm
,
sig
b) the signature generation delay τm , and c) the incentive
ic
ic
sig
ha
C
ic
will
. τm
+ τm
+ τm
= τm
, τm
computation delay τm
B
be described in next subsection IV-C. τf inal is the block
finalization delay, which is determined according to the overall
network quality. For the permissionless blockchain that may
be world-widely deployed, τfBinal is set to be 3s or 0.5s in
Bitshares or EOSIO, respectively.
B(T )
In general, τn→m implies the network quality and computation capacity of committee member m that observed by
IoT node n. Consider the maximum block processing delay of
being a committee member is Θ, we define an utility function
to indicate the election,

B(T ) +
Un→m = log 1 + [Θ − τn→m
] ,
(9)
where [a]+ = max{a, 0}. Un→m is set to be 0 when the block
processing delay observed by n is less than the given threshold
Θ. Otherwise, Un→m would achieve a logarithmic increment.
Therefore, the probability of n voting for m can be written
as,
Un→m
,
(10)
pn→m = P
m Un→m
which means the higher utility of m, the higher chance to be
voted. Then the committee M = {1, .., Mc } is elected as the
top Mc winners.

JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

2) Block Proposal, Block Propagation and Block Validation: When the committee is elected to take part in a consensus algorithm, at each block generation slot, the committee
members take turns to act as a block miner proposing a block
in a round-robin fashion.
In a specific block proposal process, the miner packages collected PoL transactions into an unverified block. The incentive
allocation is also performed in this procedure. It is elaborated
in the next subsection in IV-C. Then the unverified block is
propagated to other committee members for block validation.
The delay of information propagation highly depends on
committee members’ geographical distribution and the block
size. The other committee members verify the signatures of the
block proposer and transaction generator. If the verification is
successful, the block is appended into the local block database.
Otherwise, the appended procedure would be forbidden.
3) Block Finalization and Incentive Mechanisms: In Bychain, the block finalization follows the Longest-chain rule.
Due to network uncertainty and possible malicious participant,
the blockchain may be forked into the longest chain and several shorter chains. In this case, the block miner should always
propose a block that extends the longest chain. Otherwise, a
local database update should be performed ahead of the block
proposal.
There are two kinds of incentive mechanisms involved in
Bychain: 1) block generation can claim a certain amount of
token reward, 2) IoT devices pursuing maximizing monitoring
area can be rewarded a certain amount of votes. 1) is commonly applied to encourage more participants to join in the
permissionless blockchain systems, e.g., Bitshares, Bitcoins,
etc. We will describe 2) in detail.
C. Incentive Allocation for Maximizing Monitoring Area
In this subsection, we detail the incentive allocation mechanism to maximizing the total coverage area. For every 24
hours, or every 28800 blocks at 3s block production interval
1
, Bychain issues a fixed-value budget as total incentive of
maximizing network communication coverage usage. With
omnidirectional mobility, each IoT node is willing to find and
deploy itself to where maximizes the next round reward. We
define it as an Incentive Allocation for Maximizing Monitoring
Area problem.
Problem: Given a coverage budget worth U, and N
incentive-pursuing noncooperative nodes with isotropic communication module of available radius R, how should the
budget be allocated so that the resulting configuration is
tending to maximize the network communication coverage?.
Before going further, some underlying constraints need to
be clarified:
• Global-class computing may not be feasible due to limited computation and power consumption of IoT devices.
Furthermore, localization of devices is not globally available because, as mentioned in the last subsection, location
ciphertext Lpi ,t cannot be publicly understood.
1 Due

to fixed block broadcast interval, the number of blocks is a widely
used dimension to measure time difference in blockchain system.

9

•

•

Bychain opens for anyone to access, read, send, or receive
transactions and blocks. Hence, the problem-solution
requires high scalability and adaptivity to contain abrupt
attendance or absence.
The connectivity between Bluetooth devices highly depending on the electromagnetic propagation characteristics of the natural environment. In certain scenarios with
high path loss and shadow fading, the signal from sources
in different directions is necessary to avoid the ”dead”
coverage zone.

Motivated by potential virtual field in robotic navigation
and obstacle avoidance [24], Bychain applies artificial virtual potential field to address above incentive allocation for
maximizing monitoring area problem. Each witness node in
the blockchain system is treated as a charged particle, such
that artificial electric fields are constructed in a way that each
(i,j)
node is repelled by repulsive force F~r
from other nodes,
thereby forcing the blockchain to spread itself throughout
the environment. Bychain then introduces an attractive force
(i,j)
to gather nearby witness nodes, and keep the repetitive
F~a
coverage area.
1) Potential Field of Single Node: According to the relationship between potential field and force, given ith witness
node and jth near-by witness node, the repulsive force with
respect to the scalar potential field Pj can be written as,

F~r(i,j)


 − krep · 1 · ~xj − ~xi ,
rj2
rj
= −∇Pj =

0,

rj ≤ Rr ,

rj > Rr .
(11)
where krep denotes the strength constant of the repulsive field,
rj is the Euclidean distance between node j and node i, where
rj = ||~xj − ~xi ||2 , ~xj and ~xi denote the absolute position
(i,j)
is a
of node j and node i, respectively. In general, F~r
conservative force that subjects to the gradient of potential
field. The piecewise function indicates that each node out
of the disc of radius Rr would not affected by its repulsive
potential field.
Let us focus on the potential field of ith witness node. As
(i,j)
illustrated in Fig.4(a), regardless of the attractive force F~a ,
(i,j)
F~r
could result in non-overlapping network coverage with
uncovered gaps. Indeed, the repulsive-only field could perform
well as an initial deployment solution of densely placed nodes.
However, it probably conduces a discrete dot-like coverage in
urban scene. Therefore, a larger range of attractive field is
necessary to gether nearby nodes out of the repulsive field.
(i,j)
As illustrated in Fig.4(b), an attractive field of F~a
is
(i,j)
(i,j)
constructed subjects to ||F~a + F~r || = 0 on the circle of
(i,j)
radius λR. Furthermore, for nearby node j, we wish F~a
growth exponentially with rj , such that node i is able to
(i,j)
pull far-distant node back. Hence, F~a
is constructed as
following,

F~a(i,j)


~xj − ~xi
1
 −k ·
·
,
att
(rj − Rr )2
rj
=

0,

rj ≥ Rr ,
rj < Rr .

(12)

JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

10

The total force of node i results in an acceleration that adjust
its velocity according to the well-known Equation of Motion.
Therefore, given consensus round k, node i with velocity ~vk ,
the new velocity ~vk+1 can be written as:
F~ i − α~vk
,
(17)
m
where α < 1 denotes viscosity factor and m is the virtual
mass of this node.
Network Static Equilibrium and Intensive: It is obvious that the network could asymptotically approach a static
equilibrium because the viscous friction term results in monotonically decreasing system energy over time. Hence, one can
see a necessary condition for the maximum coverage of the
network is the equilibrium on each node.
Therefore, if blockchain aims to encourage nodes to participate in above coverage maximization, such objective should
design proper budget allocation strategy to intensive motion
of each node. Hence, Bychain allocates the coverage intensive
to node i as follow,
PN
~n
U
n=1,n6=i ||F || + 
(18)
·
ui = PN
n
~
n−1
n=1 ||F || + n
~vk+1 = ~vk +

Fig. 5. Illustrations of final coverage caused by potential field. In subfigure
~a(i,j) ,
(a), we set Rr = 2R and remove the effects of attractive force F
where dotted circle denotes the range of repulsive field. At this moment the
coverage is maximized, however, resulting in several coverage gaps that lifts
the interruption probability of Bluetooth connections. After taking attractive
~a(i,j) into account, subfigure (b) showns a node reaches the force
force F
equilibrium at λR.

where katt denotes the strength constant of the attractive field.
The resultant force between node i and node j is
F~ (i,j) = F~a(i,j) + F~r(i,j) .

(13)

Meanwhile, the combined attractive and repulsive potential
field construct a zero potential ring at radius λR such that
(i,j)
(i,j)
+ F~r || = 0, shown as the red circle in Fig.5.
||F~a
By substituting (11), (12) and rj = λR into constraint
(i,j)
(i,j)
+ F~r || = 0, the relationship between strengths of
||F~a
potential fields krep and katt could be written as following,
1
1
katt ·
− krep · 2 2 = 0.
(14)
(λ − 1)2 Rr
λ R
Hence,
λ2 katt = (λ − 1)2 krep .
(15)
Repulsive + Attractive Potential Field

peak of attractive potential
peak of repulsive potential

F +F

=0

Fig. 6. Illustration of the combined potential field, where a witness node
locates at (200,200).

2) Potential Field and Intensive of Multiple Nodes: Let’s
extend the perspective to the relationship between multiple
nearby nodes, denote as a node set K. The total force of node
i can be given by,
X
X
F~ i =
F~a(i,j) +
F~r(i,j)
(16)
j∈K

j∈K

where  is a perturbation factor that sufficiently small preventing denominator to be 0. (18) performs three key characters:
1) the incentive of node i would decrease as ||F~ i || increase.
2) When the network static equilibrium, each node would be
distributed n1 U budget. 3) The sum of network budget still
approximately equal to U.
V. S ECURITY A NALYSIS
In this section, we analyze our proposed blockchain’s security properties and prove that the protocol can achieve our
security goals.
1) A prover cannot generate a location proof without a
witness.
Since witnesses do not give away their private keys, a prover
cannot claim the activities information by signing it using
the private key of the witness. If this situation occurs, the
blockchain key cryptography system can detect it.
2) If the witness does not reveal the private key, a prover
cannot generate a legitimate location proof at the claimed
location and claimed time without colliding with more than
half of the witnesses.
If a witness does not provide its private key, the digital
signature cannot be produced by any node except by the
witness itself. In this case, there may be two kinds of attack:
(1) the prover may provide a false location claim, or (2) the
prover may perform signature relaying attack, that is, store
the digital signature in the last location and transmit it in the
current location.
The attack (1) can be detected easily since the communication between the witness and prover is always nearrange communication. The witness will always calculate the
distance between the prover and the witness. If the distance
calculated from the physical layer is significantly different
from the claimed location information, this attack can be easily

JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

detected by the witness. (2) There is an auto-increment field
noncewj corresponding to the jth witness wj . Consequently,
the noncewj is different in each PoL. If the attack (2) occurs,
the signature could not be the same due to noncewj . Therefore,
attack (2) can be easily detected by verifying the content.
In the proof-of-location stage, the prover may receive more
than one proof-of-location response. Since the witness is semitrusted and majority-honest, the attack can be conveniently
detected by analyzing the proof-of-location responses if the
prover does not collude with more than half of the witness
nodes.
3) The prover, witness and verifier are not able to modify
generated activity proofs.
In the second stage, the proof-of-location information is
uploaded on the blockchain, and the data on the blockchain
is transparent and tamper-resistant. It is almost impossible to
modify the generated activity proofs.
4) This protocol is able to avoid the PoL replaying attack
on the blockchain.
Due to the consistency of the blockchain database, the
on-chain storage space is precious. A malicious user may
resubmit the PoL commitment to occupy the storage space,
named the PoL replaying attack. Since each peer of the
blockchain network checks, if the current PoL is contained in
the blockchain database before submitting, it is not possible
to successfully complete the replaying attack.
5) A verifier can verify the activity information without the
private key of the proof.
The zero-knowledge proof is applied in our protocol. The
private key will not be revealed to the service provider. The
signature of the activity information is verified by providing
the verifier, a signed verifier-specified nonce, and this kind of
attack can be avoided.
6) Only the prover and verifier can access the location information in this protocol, such that the privacy is maximized.
While these activity proofs are uploaded on the blockchain
such that they are transparent to all the other users, the public
key and private key are managed by key escrow and changed
in each k proof-of-location stage. No one can connect this
information with an uniform identity. At the same time, the
user does not need to reveal its private key to anyone else
when verifying ownership, such that the risk of revealing the
private key is avoided. Hence, privacy is maximized.

11

•

•

•

•

Kotlin to reduce the programming complexity on the
client interface. Due to the low computation cost, C++ is
considered to be one of the best choices of our blockchain
system.
Bluetooth 5.0: This is latest version of the Bluetooth
wireless communication protocol. We adopt Bluetooth 5.0
in our protocol to study the feasibility of our protocol
under the latest wireless standards. The PoL message
exchange can also benefit from the extended advertising
data length such that the signal Bluetooth frame is able
to carry our PoL requests and PoL responses. In our
software, the Bluetooth 5 advertising extension mode is
employed. The primary physical layer parameter is LE
1M and the secondary physical layer is LE 2M.
OpenSSL: This is a general-purpose cryptography library
for the transport layer security (TLS) and secure sockets
layer (SSL) protocols. The OpenSSL library is a successor of commercial-grade and full-featured cryptography
implementations. OpenSSL is required in our protocol to
provide signing, signature verification, key pairs generation and key escrow operations.
Bitcoinj-core: This is a Java implementation of the Bitcoin protocol for building blockchain applications. Peerto-peer communication, network nodes organization and
the blockchain object database are implemented and
applied in our protocol.
nRF-connect: This is wireless performance analysis software that is produced by Nordic Semiconductor, including Bluetooth, WiFi and cellular signals. The received
signal strength indication (RSSI), packet history, packet
changes, Bluetooth advertising intervals, etc., can be
analyzed using nRF-connect in real time and in real-world
applications.

VI. I MPLEMENTATION AND E VALUATION
To verify our system in a real-world setting, we implement
production-grade software by using Bluetooth 5.0. The implemented system is shown in Fig.7. In this section, we study the
performance and constraints of our proposed protocol, such as
the message interaction latency, power consumption, computation and storage limitations. The main software components
and data structures are shown as follows.
• Programming Language: The client is implemented using
Java and Kotlin while the blockchain server and smart
contract are implemented using C++. Kotlin is a statically
typed language with a type inference suggested as an
alternative to Java on the Android platform. We use

Fig. 7. Implemented System which is composed of a Google Pixel2, an One
Plus 6, several Bluetooth beacons and the blockchain nodes that running on
Alibaba Cloud.

Blockchain network and nodes: We realize our protocol
on Alibaba Cloud. On the blockchain, we generate the genesis
block (known as the first block of blockchain) using the unique
Merkle hash root at 2017-09-05 12:15:00. After two years

JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

of running, it is proved that our DPoS blockchain is stable
in practice. We then modified its incentive mechanism from
March 2020. Because the on-chain data transaction is not
heavy, the current size of our private blockchain database
is approximately 2.4 GB and the number of network nodes
is approximately 65. Note the number of nodes varies from
60–68 during the experiment. To simulate the real world, our
blockchain is implemented on an Intel(R) Xeon(R) CPU E52650 v3 platform with 2 GB RAM and 10 Mbps bandwidth for
each node is provided by Alibaba Cloud and Amazon Cloud.
Nodes in the blockchain network are virtual private servers
such that they broadcast and receive block messages via a
physical communication link. The mining interval is set as
3 s.
The provers and witnesses: To mimic real-world user activities, we developed a client to realize the functions required
by the prover and witness. The client is implemented by Java
and Kotlin on One Plus 6 and Google Pixel 2 (all with Android
9.0). One plus 6 equips Qualcomm SDM845 Snapdragon 845
(10 nm) with 4x2.8 GHz CPU cores and 4x1.7 GHz CPU cores,
6 GB RAM, WiFi 802.11 a/b/g/n/ac, Bluetooth 5.0 and a
GPS module. Google pixel 2 equips Qualcomm MSM8998
Snapdragon 835 (10 nm) with 4x2.35 GHz CPU cores and
4x1.9 GHz CPU cores, 4 GB RAM, WiFi 802.11 a/b/g/n/ac,
Bluetooth 5.0 and a GPS module. Both One Plus 6 and Pixel
2 can communicate with blockchain via the WiFi or 4G signal
provided by China Mobile.
Data structure: The interacted message involved in our
protocol includes the following: the PoL request P k , the PoL
response Rk , the PoL commitment Comk and the verification
information N k . In our protocol, the length of P k advertising
data is approximately 320 bytes including a 128-bit service
UUID and payload data shown in (2). The message length
is heavily dependent on the key length of the cryptosystem.
There always exists a trade-off between the performance and
security level when deciding the public key length. Our public
key is a 160-bit hash of the SHA256 hashed ECDSA public
key and the private key is abstract syntax notation one (ASN.1)
coded strings. The signature of the PoL commitment is a 65-bit
ECDSA formed signature. As a comparison, the length of Rk
is approximately 540 bytes, and the PoL commitment under
a single witness is approximately 520 bytes. The location
information is required from the GPS module with 14 bit data
and 10−7 accuracy, i.e., centimeter-level location information.
A. System Performance
In this subsection, we study the performance and cost of
deploying our protocol including the storage, CPU, power consumption, and the latency in each procedure. We also measure
the system performances under various relative velocities and
number of witnesses.
1) Storage, CPU and Power Consumption: The running of
the client code costs approximately 120 MB of data memory,
while the blockchain system takes approximately 3.5 GB of
data memory. With 62 blockchain network nodes mining the
block, the blocks of uploaded location information generate
each 6 seconds. Considering that the peer-to-peer network

12

propagation delay is unstable, we monitor the arrived time
interval of each block indicating the timestamp differences of
the current arrived block and the last arrived block. The result
shows that the minimum time interval is 6532 milliseconds
and the maximum time interval is 13245 milliseconds. The
arrived time interval depends on the network condition, such
as the retransmission rate and the verification delay of the PoS
algorithm. Therefore, we believe that a powerful CPU and the
adjoining blockchain network node may have a positive effect
on the blockchain propagation time.
We monitor the CPU utilization of each prover, the witness
nodes and the blockchain nodes. When the prover node is
broadcasting and the witness node is monitoring, the CPU
consumption is approximately 4 percent and 0.5 percent,
respectively. This may be due to the listening Bluetooth
signal employing less computation than the emitting Bluetooth
signals. Another possible reason is that the cryptosystem
involved in the prover processing flow costs more in terms
of computation. The CPU utilization of blockchain mining
nodes is always above 30 percent. We also realize that the
CPU utilization of the network mining node reaches a peak
when it is mining the block, in which heavy computations such
as authentication and encryption/decryption are involved.
The power consumption of the prover, witness and
blockchain is studied as well. We monitor the device power
consumption before and after the program launched as Pbefore
and Pafter , respectively. Hence the power consumption of each
entity can be computed as PE = Pafter −Pbefore . The experiment
is evaluated 50 times for each entity to study its statistical
properties, which is shown in Table I. For each experiment
and each entity, we measure the CPU utilization and power
consumption with distances dp−w = 3 m and 15 m between
the prover and witness. It is shown that farther Bluetooth
signal interaction causes higher power consumption while
computation varies little.
2) Delay Evaluation: We evaluate the time delay of each
procedure in a relative static environment, where the prover
and witness are immobile. The system parameters are shown
in Table II. During the evaluation, the PoS blockchain system
is maintained by 65 mining nodes. The Pixel 2 is in witness
mode and One Plus 6 phone is set in the prover mode with
the advertising interval tadv = 100 ms, which is the minimum
advertising interval provided in the Android Bluetooth Low
Energy API . We set the maximum advertising duration tadv =
1000 ms in the implementation.
The reason for this setting is to try to minimize the
detection delay that is caused by random access methods
in the Bluetooth protocol. Ideally, the prover’s Bluetooth
module broadcasts an advertising frame in each advertising
event, while the duration of advertising event is controlled
by the advertising interval. However, the scanning window
of the witness’s Bluetooth module is independent of the
prover’s advertising event, such that the Bluetooth message
interaction succeeds if and only if the witness’s scanning
window coincides with the prover’s advertising event. Because
the prover does not share its information with witnesses, the
message interaction of the prover and witness is considered to
be a random access event. We set the minimum advertising

JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

13

TABLE I
CPU AND POWER CONSUMPTION OF EACH ENTITY
Property

Distance dp−w (m)

CPU utilization(%)
minimum

maximum

mean

minimum

maximum

mean

Prover

3m
15 m

2
3

7
7

4
4.5

356
468

552
636

456
534

Witness

3m
15 m

0.2
0.4

0.9
1.1

0.5
0.6

296
394

350
538

323
432

15

43

30

Blockchain Miner

Power Consumption PE (mW)

TABLE II
PARAMETERS USED IN THE DELAY EVALUATION
Parameters

Description

Value

N
dp−w
tadv
Ptx

Number of Blockchain Mining Nodes
Distance between Prover and Witness
Advertising Interval
Prover and Witness Transmit Power Level
Primary Physical Layer Parameters
Secondary Physical Layer Parameters
Maximum Advertising Duration
Maximum Block Size
Maximum Commitment Size

65
1
100
−11
LE 1M
LE 2M
1000
2
9

tMAX
adv
MAX
Sblock
MAX
SCOMM

Unit
m
ms
dBm

ms
MB
KB

interval to improve the possibility of successive Bluetooth
message interactions. Hence, the communication delay of the
PoL message interaction will be minimized.

Fig. 8. Average time delay of each procedure. T1 is the key escrow generation
(key-pair generation for 100 times), T2 denotes the PoL request generation,
T3 represents the delay of the PoL request emission task, T4 is the time cost
of signature generation, T5 is the time cost of PoL commitment uploading,
T6 is the signal propagation delay between the prover and witness.

We also constrain the blockchain parameters’ maximum
MAX
MAX
and maximum commitment size SCOMM
as
block size Sblock
2 MB and 9 KB to mimic real-world network conditions,
respectively. In our experiment, the adoption of Alibaba Cloud
and Amazon Cloud may cause unrealistic network conditions
because the blockchain miner is considered to be worldwide
and under various network conditions. The network condition of our miner nodes are much better than the average
blockchain miners such as Bitcoin miners, including the average packet loss probability, the network bandwidth and average

latency. A large block size (>2 MB) and commitment size
(>9 KB) increase the computation complexity and bandwidth
requirement such that it is much more difficult to maintain
the data consistency of the distributed blockchain database.
According to the running parameters of the Bitcoin blockchain,
MAX
MAX
we adopt Sblock
= 2 MB and SCOMM
= 9 KB to mimic a
world-wide deployed blockchain system.
To study the sensitivity of our protocol to the time delay of
each procedure, we evaluate the time durations of key escrow
generation, PoL request generation, PoL request emission,
signature generation, PoL commitment uploading and the overthe-air signal propagation delay. After a 50-turn test, the
average time delay of each procedure is illustrated in Fig. 8.
Among these procedures, the key escrow generation, PoL
commitment uploading and the over-the-air signal propagation delay are significantly higher than the others. The PoL
commitment uploading is limited by the propagation delay
and churn of the peer-to-peer blockchain network; thus it
is observed to have high volatility that increases to 421 ms
and decreases to 121 ms. The signal propagation delay is
determined by the channel states of Bluetooth with respect
to the relative velocity and activity between the prover and
witness. We will further study the influence of key escrow
generation and activity in next subsection.
The generation of key pairs and signature is studied to evaluate the authentication performance and security. The delay of
the key and signature generation and verification is highly dependent on the device performance. We run key pair generation
and signature verification 10,000 times regarding secp256k1
(with 128 bits of security strength), secp128r1 (with 64 bits
security strength), secp192k1 (with 96 bits security strength),
secp384r1 ((with 192 bits security strength)), secp521r1 (with
256 bits security strength), and curve25519 (with 128 bits
security strength) on One Plus 6 and Pixel 2. The performances
of key generation under different security strengths are shown
in Fig. 9. The performance evaluation shows that the time cost
increase exponentially with the security strength. However, the
curve 25519 algorithm performs with more complexity than
secp256k1 even in same security strength. Hence, secp256k1
is implemented in our blockchain system.
3) Activities Evaluation: We further evaluate the sensitivity of over-the-air signal propagation to the received signal
strength indication (RSSI) and various activity conditions.
We adopt Pixel 2 as the prover, all witnesses are static,
the experimental tests are conducted in an urban area, and
the initial activity condition is shown in Fig. 10(a). It is

JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

14

R EFERENCES

Fig. 9. Time comparison under different security strengths.

shown that the RSSI decreases with the more significant initial
distance dp−w and the tremendous accelerated velocity of a;
this confirms our intuition and suggestions. When a barrier
wall appears in the experiment, the Bluetooth signal faces
significant fading such that there appears a 2-second gap in
subfigure (h). The PoL message interactions are impossible
in this signal gap. A prover walking through multiple witness
nodes is evaluated in (j),(k), and (l): the witnesses are placed
around the prover in (j), and one-by-one in (k) and (l). The
signals that originate from different witnesses are painted with
different colors. The result confirms that our protocol works
well to collect multiple witness messages in an urban area.
Although the PoL message interaction could not coincide, the
time interval between each PoL message interaction event is
still acceptable at 0.4–2 s, such that a running user could not
run out of the coverage area of Bluetooth 5.0 equipment.
VII. C ONCLUSION
In this paper, we proposed and implemented a decentralized
blockchain system for activity-proofing and contact tracing. In
the proposed protocol, activity and location-proof problems are
addressed by a combination of cryptographic techniques and
a decentralized blockchain system without reliance on trusted
third parties. The identity privacy problem is protected by
proposing a combination technique of zero-knowledge proof
and key escrow. The connection of unique cryptographic identity and on-chain proof-of-location commitment is decoupled
such that it is almost impossible to track and identify the owner
of transparent on-chain data. Hence, security and identity
privacy is protected. A location-based consensus algorithm
is proposed aiming to maximize the monitoring area. The
incentive allocation technology is performed by virtual potential fields. Several implement results are shown to provide
a practical perspective.

[1] Aruba, Location Service with Aruba Bluetooth Beacons, https://www.
arubanetworks.com/products/location-services/aruba-beacons/.
[2] J. D. Angrist, S. Caldwell, and J. V. Hall, Uber vs. Taxi: A Driver’s Eye
View, Tech. report, National Bureau of Economic Research, 2017.
[3] S. Bertoni, “Oscar health using misfit wearables to reward fit customers,”
in Forbes, 2014. https://www.forbes.com/sites/stevenbertoni/2014/
12/08/oscar-health-using-misfit-wearables-to-reward-fit-customers/
#56d693ba93c5.
[4] D. Doolittle et al., “UT students use fake GPS signals to take over
superyacht,” HispanicBusiness.com, Jul. 2013, p. 1.
[5] B. Carbunar and R. Potharaju, “You unlocked the Mt. Everest badge
on foursquare! Countering location fraud in Geosocial Networks,” in
2012 IEEE 9th International Conference on Mobile Ad-Hoc and Sensor
Systems (MASS 2012). Las Vegas, NV: IEEE, 2012, pp. 182–190.
[6] L. Buttyán, T. Holczer, and I. Vajda, “On the effectiveness of changing
pseudonyms to provide location privacy in VANETs,” in European
Workshop on Security in Ad-hoc and Sensor Networks. Berlin: Springer,
2007, pp. 129–141.
[7] V. Lenders, E. Koukoumidis, P. Zhang, and M. Martonosi, “Locationbased trust for mobile user-generated content: Applications, challenges
and implementations,” in Proceedings of the 9th Workshop on Mobile
Computing Systems and Applications. New York, NY: ACM, 2008, pp.
60–64.
[8] A. Pham, K. Huguenin, I. Bilogrevic, I. Dacosta, and J.-P. Hubaux,
“Securerun: Cheat-proof and private summaries for location-based activities,” IEEE Trans. Mobile Comput., vol. 15, no. 8, Aug. 2015, pp.
2109–2123.
[9] M. Talasila, R. Curtmola, and C. Borcea, “Link: Location verification
through immediate neighbors knowledge,” in International Conference
on Mobile and Ubiquitous Systems: Computing, Networking, and Services. Berlin: Springer, 2010, pp. 210–223.
[10] Z. Zhu and G. Cao, “Toward privacy preserving and collusion resistance
in a location proof updating system,” IEEE Trans. Mobile Comput.,
vol. 12, no. 1, Nov. 2011, pp. 51–64.
[11] X. Wang, A. Pande, J. Zhu, and P. Mohapatra, “STAMP: Enabling
privacy-preserving location proofs for mobile users,” IEEE/ACM Trans.
Netw., vol. 24, no. 6, Dec. 2016, pp. 3276–3289.
[12] “Privacy-Preserving Contact Tracing,’2020. https://www.apple.com/
covid19/contacttracing.
[13] V. Sharma, I. You, D. N. K. Jayakody, D. G. Reina, and K. R. Choo,
“Neural-blockchain-based ultrareliable caching for edgeenabled UAV
networks,” IEEE Trans. Ind. Informat., vol. 15, no. 10, Oct. 2019, pp.
57235736.
[14] Z. Yang, K. Yang, L. Lei, K. Zheng, and V. C. M. Leung “Blockchainbased decentralized trust management in vehicular networks,” IEEE
Internet Things J., vol. 6, no. 2, Apr. 2019, pp.14951505.
[15] S. Nakamoto et al., Bitcoin: A Peer-to-Peer Electronic Cash System,
Working Paper, 2008.
[16] F. Saleh, “Blockchain without waste: Proof-of-stake,” May 2019. http:
//dx.doi.org/10.2139/ssrn.3183935.
[17] A. Kiayias, A. Russell, B. David, and R. Oliynykov, “Ouroboros: A
provably secure proof-of-stake blockchain protocol,” in Annual International Cryptology Conference. Berlin: Springer, 2017, pp. 357–388.
[18] G.-T. Nguyen and K. Kim, “A survey about consensus algorithms used
in blockchain.” J. Inf. Process. Syst., vol. 14, no. 1, Jan. 2018, 101–128.
[19] C. Cachin, “Architecture of the hyperledger blockchain fabric,” in
Workshop on Distributed Cryptocurrencies and Consensus Ledgers, vol.
310, 2016.
[20] M. Moos, “Analysis: Bitcoin costs $1.4 billion to 51% attack, consumes as much electricity as Morocco.” 2018. https://cryptoslate.com/
analysis-bitcoin-costs-1-4-billion-to-51-attack-consumes-as/.
[21] V. Buterin et al., A Next-Generation Smart Contract and Decentralized
Application Platform, White Paper, 2014.
[22] Z. Lijing, W. Licheng, S. Yiru and L. Pin, “BeeKeeper: A BlockchainBased IoT System With Secure Storage and Homomorphic Computation.” IEEE Access, vol. 6, 2018, 43472–43488.
[23] X. Yang and Z. Ning and L. Wenjing and H. Y Thomas, A survey
of distributed consensus protocols for blockchain networks, ” IEEE
Communications Surveys & Tutorials,vol. 22, 2020, 1432–1465.
[24] F. E. Scheider, D. Wildermuth, and H.-L. Wolf, Motion coordination in
formations of multiple mobile robots using a potential field approach,”
Distributed Autonomous Robotics Systems, vol. 4, 2000, 305–314.

JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

15

(a) v = 0, a = 0, dp−w = 1 m, N = 1

(b) dp−w = 3 m

(c) v ' 1 m/s, dp−w = 1 m

(d) dp−w = 9 m

(e) dp−w = 9 m

(f) dp−w = 3 m, v ' 3 m/s, a ' 1 m/s2

(g) dp−w = 3 m, v ' 3 m/s, a ' 2 m/s2

(h) Walking through a barrier wall

(i) Varied direction running

(j) dp−w ' 7 m, N = 5

(k) v ' 1 m/s, dp−w = 7 m, N = 4

(l) v ' 3 m/s, dp−w = 7 m, N = 7

Fig. 10. Prover Activities Experiment under different velocity v, accelerated velocity a, initial distance dp−w , environment and witness number N .

Wenzhe Lv received his B.S degree in Harbin Institute of Technology in 2012. He is currently working
toward the Ph.D degree at Beijing University of
Posts and Telecommunications. His research interest
focuses on blockchain technology and distributed
system.

Chunxiao Jiang (S09-M13-SM15) is an Associate
Professor in School of Information Science and
Technology, Tsinghua University. He received the
B.S. degree in information engineering from Beihang University, Beijing in 2008 and the Ph.D.
degree in electronic engineering from Tsinghua University, Beijing in 2013, both with the highest honors. His research interests include application of
game theory, optimization, and statistical theories
to communication, networking, and resource allocation problems, in particular space networks and
heterogeneous networks. Dr. Jiang has served as an Editor of IEEE Internet
of Things Journal, IEEE Network, IEEE Communications Letters, and a
Guest Editor of IEEE Communications Magazine and IEEE Transactions on
Network Science and Engineering. He has also served as a member of the
technical program committee as well as the Symposium Chair for a number
of international conferences, including IEEE ICC 2018 Symposium Co-Chair,
IWCMC 2018/2019 Symposium Chair, WiMob 2018 Publicity Chair, ICCC
2018 Workshop Co-Chair, and ICC 2017 Workshop Co-Chair. Dr. Jiang is the
recipient of the Best Paper Award from IEEE GLOBECOM in 2013, the Best
Student Paper Award from IEEE GlobalSIP in 2015, IEEE Communications
Society Young Author Best Paper Award in 2017, the Best Paper Award
IWCMC in 2017, IEEE ComSoc TC Best Journal Paper Award of the IEEE
ComSoc TC on Green Communications & Computing 2018, IEEE ComSoc
TC Best Journal Paper Award of the IEEE ComSoc TC on Communications
Systems Integration and Modeling 2018, the Best Paper Award ICC 2019.

JOURNAL OF LATEX CLASS FILES, VOL. 14, NO. 8, AUGUST 2015

Sheng Wu (S13-M14) received the B.S. and M.S.
degree from the Beijing University of Posts and
Telecommunications, Beijing, China, in 2004 and
2007, respectively, and the Ph.D. degree in electronic
engineering from Tsinghua University, Beijing, in
2014. He was a post-doctoral researcher in the Tsinghua Space Center at Tsinghua University, Beijing,
China. He is currently an Associate Professor with
the Beijing University of Posts and Telecommunications. He has published over 50 journal and
conference papers. He also holds over 20 granted
patents. His research interests are mainly in iterative detection and decoding,
channel estimation, massive MIMO, and satellite communications. He has
received the first prize from the Science and Technology Award of Chinese
Institute of Electronics in 2017, the silver medal from the 46th Geneva
International Exhibition of Inventions in 2018, and the second prize from
the National Technological Invention Award of China in 2018.

Yuanhao Cui received his B.S. degree in Henan
University in 2012. From 2016 until 2018, he was
working as a Ph.D visitor of Aalto University in
Helsinki, Finland. He is currently working toward
the Ph.D. degree in signal processing at Beijing
University of Posts and Telecommunications. His
research interests include blockchain application in
Internet of Things, coexistence of radar and communication and machine learning application in wireless communication.

Xuesong Qiu received the Ph.D. degree from the
Beijing University of Posts and Telecommunications, Beijing, China, in 2000. He is currently a
Professor, a doctoral supervisor, and the deputy director of the State Key Laboratory of networking and
switching technology, and vice president of Network
Technology Research Institute of Beijing University
of Posts and Telecommunications, China. He was
editor of the two ITU-T standards and 4 industry
standards of China. He has published more than 200
academic papers. He won twice the national scientific and technological progress prize of china. His major research interests
include network and service management, information and communication
technology of smart grid. Email: xsqiu@bupt.edu.cn.

16

Yan Zhang (Fellow, IEEE) received the Ph.D. degree from the School of Electrical and Electronics Engineering, Nanyang Technological University,
Singapore. He is currently a Full Professor with
the Department of Informatics, University of Oslo,
Oslo, Norway. His research interests include nextgeneration wireless networks leading to 5 G beyond/6 G, green and secure cyber-physical systems
(e.g., smart grid and transport). Dr. Zhang is a member of CCF Technical Committee of Blockchain.
He is the Chair of IEEE Communications Society
Technical Committee on Green Communications and Computing (TCGCC).
He is an Editor for IEEE publications, including IEEE Communications
Magazine, IEEE Network Magazine, IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, IEEE TRANSACTIONS ON GREEN COMMUNICATIONS
AND NETWORKING, IEEE COMMUNICATIONS SURVEY AND TUTORIALS, IEEE INTERNET OF THINGS JOURNAL, IEEE SYSTEMS
JOURNAL, IEEE VEHICULAR TECHNOLOGY MAGAZINE, and IEEE
BLOCKCHAIN TECHNI-CAL BRIEFS. He is a Symposium/Track Chair
for a number of conferences, including IEEE International Conference on
Communications 2021, IEEE Global Communications Conference 2017, IEEE
International Symposium on Personal, Indoor and Mobile Radio Communications 2016, IEEE International Conference on Communications, Control,
and Computing Technologies for Smart Grids 2015. He is an IEEE Vehicular
Technology Society Distinguished Lecturer during 2016-2020 and he is named
as CCF 2019 Distinguished Speaker. Since 2018, he was the recipient of
the Highly Cited Researcher Award (Web of Science top 1% most cited) by
Clarivate Analytics.

