Semi-Mechanistic Bayesian modeling of COVID-19 with Renewal Processes
Samir Bhatt1 , Neil Ferguson1 , Seth Flaxman2 , Axel Gandy2,† , Swapnil Mishra1 , and James A. Scott2
1 MRC

Centre for Global Infectious Disease Analysis, Imperial College, London, UK
2 Department of Mathematics, Imperial College, London, UK
† Corresponding author: a.gandy@imperial.ac.uk

Abstract

arXiv:2012.00394v2 [stat.AP] 29 Dec 2020

We propose a general Bayesian approach to modeling epidemics such as COVID-19. The approach grew out of
specific analyses conducted during the pandemic, in particular an analysis concerning the effects of non-pharmaceutical
interventions (NPIs) in reducing COVID-19 transmission in 11 European countries. The model parameterizes the time
varying reproduction number Rt through a regression framework in which covariates can e.g. be governmental interventions or changes in mobility patterns. This allows a joint fit across regions and partial pooling to share strength.
This innovation was critical to our timely estimates of the impact of lockdown and other NPIs in the European epidemics,
whose validity was borne out by the subsequent course of the epidemic. Our framework provides a fully generative model
for latent infections and observations deriving from them, including deaths, cases, hospitalizations, ICU admissions and
seroprevalence surveys. One issue surrounding our model’s use during the COVID-19 pandemic is the confounded nature
of NPIs and mobility. We use our framework to explore this issue. We have open sourced an R package epidemia implementing our approach in Stan. Versions of the model are used by New York State, Tennessee and Scotland to estimate
the current situation and make policy decisions.

1

Introduction

This article presents a general framework for semi-mechanistic Bayesian modeling of infectious diseases using renewal
processes. The term semi-mechanistic relates to statistical estimation within some constrained mechanism. Variants
of this general model have been used in specific analyses of Covid-19 (Flaxman et al., 2020a; Flaxman et al., 2020b;
Vollmer et al., 2020; Mellan et al., 2020; Unwin et al., 2020; NYS Press Office, 2020; Olney et al., 2020; The Scottish
Government, 2020; Mishra et al., 2020a), and continue to be used in ongoing work to make policy decisions. The present
article motivates and discusses the key statistical and epidemiological features of this framework, starting from a counting
process setup. Various extensions of the basic model are considered, including a latent infection process. We discuss
limitations and applications of the modelling framework to stimulate further research.
The model uses a flexible regression-based framework for parameterising transmission and ascertainment rates. This
allows the fitting of multilevel models (Gelman and Hill, 2006; Hox, Moerbeek, and Schoot, 2010; Kreft and Leeuw,
2011) for several regions simultaneously. Such partial pooling of parameters has specific advantages in the context of
infectious diseases. Suppose we wish to estimate the effect of NPIs (Cowling et al., 2020; Flaxman et al., 2020b) or
mobility (Badr et al., 2020; Miller et al., 2020) on transmission rates. Estimating these effects separately in different
regions could lead to noisy estimates for at least two reasons. There is typically little high quality data at the early stages
of an epidemic. Such data is generally correlated, reducing the information content that can be used to infer such an
effect. In addition, NPIs often occur in quick succession and their effects are confounded (HKSAR, 2003; WHO, 2003).
This is exacerbated by the random times between infections (the generation distribution) and between infections and
observations, which smooths the observed data, making it more difficult to attribute changes in transmission rates to a
particular NPI. Alternatively, one could pool the effect across all groups. This ignores group-level variations and can
lead to poor predictive performance, in particular underestimating variance for previously unmodeled regions. One could
augment such a model with group-level indicators, but this results in a large number of parameters, which are difficult to
estimate and leads to overfitting with classical estimation techniques. Partial pooling provides a natural solution to this.

1

Sometimes the inferential goal is not to assess the effect of a covariate on outcomes, but rather to infer transmission
rates over time. Previous studies have focused on estimating reproduction numbers from case data (Ferguson, Donnelly,
and Anderson, 2001; Riley et al., 2003; Bettencourt and Ribeiro, 2008; Fraser et al., 2009; Kelly et al., 2010; Cori et al.,
2013), sometimes directly substituting observed case counts for the unknown number of infected individuals (Wallinga
and Teunis, 2004). However, the emergence of SARS-CoV-2 has highlighted shortcomings of methods that rely on just
case data. Limited testing capacity at the early stages of the pandemic led to only a small proportion of infections being
detected and reported (Li et al., 2020). Those tested were typically more likely to have been hospitalised or were at higher
risk of infection or death. In particular this proportion, referred to as the infection ascertainment rate (IAR) is countryspecific and likely to have changed over time due to changes in testing policies and capacity. If unaccounted for, it will
lead to biases in the inferred transmission rates.
This highlights the need for more flexible observational models, whereby more varied types of data can be incorporated, and their idiosyncrasies accounted for. Daily death data has been used in Flaxman et al. (2020b) to recover
reproduction numbers in the early stages of the SARS-CoV-2 pandemic, and has been seen as more reliable than case
data. However, there have been clear variations in definitions and reporting across time and countries. It is therefore
important to appropriately model noise within the the observational models. Our framework allows for multiple types of
data including deaths, cases, hospitalizations, ICU admissions and the results of seroprevalence surveys. This improves
robustness of inferred parameters to biases in any one type of data.
The model uses discrete renewal processes to propagate infections within modeled populations. These have been used
in a number of previous studies (Fraser, 2007; Cori et al., 2013; Nouvellet et al., 2018; Cauchemez et al., 2008), and
are linked to other popular approaches to infectious disease modeling. Champredon, Dushoff, and Earn (2018) show that
the renewal equation leads to identical dynamics as Erlang-Distributed Susceptible-Exposed-Infected-Recovered (SEIR)
compartmental models, when a particular form is used for the generation distribution. A special case of this is the standard
Susceptible-Infected-Recovered (SIR) model (Kermack, William Ogilvy and McKendrick, 1927). The approach is also
connected to counting processes including the Hawkes process and the Bellman-Harris process (Bellman and Harris,
1948; Bellman and Harris, 1952). Bellman and Harris (1948) and Mishra et al. (2020b) derive the renewal equation as
the expectation of an age-dependent branching process. Age-dependence allows for more realistic dynamics than ageinsensitive processes, like the Galton-Watson process (Bartoszynski, 1967; Getz and Lloyd-Smith, 2006). More complex
branching processes such as the Crump-Mode-Jagers branching process could also be considered. Hawkes processes are
also related to renewal processes, with the expectation of the Hawkes intensity function resulting in the renewal equation
(Rizoiu et al., 2017).
We describe the general model in detail, and start by considering the bare-bones version in Section 2. The motivation
for the model lies in continuous-time counting processes, and this connection is discussed in Section 3. Sections 4 and
5 present the infection and observation processes in more detail, and consider important extensions of the basic model.
Section 6 considers how to use the framework for multilevel modeling. Section 7 compares our approach to standard time
series models, and outlines the key challenges involved in modeling with our framework. Section 8 considers the specific
aspect of confounding and causality when estimating the effects of variables on transmission rates. Section 9 has a brief
discussion.

2

Model Overview

We now formulate a basic version of the model for one homogeneous population. The same model can be used for
multiple regions or groups jointly. Let Rt > 0 be the reproduction number at time t > 0. This determines the rate at
which infections grow. Infections iv , . . . , i0 for some v ≤ 0 are given a prior distribution. For t > 0, we let new infections
it be defined by
it = Rt

X
s<t

2

is gt−s ,

(1)

where the generation time, the lag between infections, is given through a probability mass function g, i.e. gt ≥ 0 and
P∞
t=1 gt = 1.
Observations occur at certain times t > 0 . In general, there may be multiple types; case and death counts for example.
Each such type is driven by its own time-varying ascertainment rate αt > 0. The mean of the observations at time t is
linked to past infections by
yt = αt

X

is πt−s ,

(2)

s≤t

where π is a distribution for the lag between an infection and when it gives rise to an observation. The sampling distribution of the observations with these means is typically nonegative and discrete, and may depend on auxiliary parameters.
(l)

(l)

When multiple types are observed, we can superscript the quantities as yt , αt and π (l) and assign independent sampling
distributions for each type.
Transmission rates Rt and ascertainment rates αt can be modeled flexibly using Bayesian regression models, and
through sharing of parameters, are the means through which we tie together multiple regions or groups using multilevel
modeling. One can, for example, model transmission rates as depending on a binary covariate for an NPI, say full
lockdown. The coefficient for this can be partially pooled between these groups. The effect is to share information
between groups, while still permitting between group variation.

3

Motivation from continuous time

Our model can be motivated from a continuous time perspective as follows. Infections give rise to additional infections in
the future, referred to as offspring. Letting N I (t) denote the number of infections occurring up to time t, defined by its
intensity
Z
λ(t) = R(t)

g(t − s)N I (ds),

t > 0,

(3)

s<t

where g is the density of a probability distribution on R+ defining the time between infections, and where {R(t) : t > 0}
is a non-negative stochastic process. The process can be initialised by assuming values for N I (t) for t in the seeding
period [v, 0].
Equation (3) is similar to the Hawkes intensity, however the memory kernel g is scaled by a time-specific factor R(t).
The integrand g allows the intensity to increase due to previous infection events, while R(t) tempers the intensity for
other time-specific considerations. If R(t0 ) = R(t) for all t0 then Equation (3) reduces to a Hawkes process. Under this
assumption, since g integrates to unity, the expected number of offspring is simply R(t), and so this is the instantaneous
reproduction number or alternatively the branching factor of the Hawkes process. The generation time, defined as the
time from an infection to a secondary infection, is distributed according to g and so g is the generation distribution.
Observations are precipitated by past infections; a given infection may lead to observation events in the future. Letting
Y

N (t) be the count of some observation type over time defined by the intensity
Z

π(t − s)N I (ds),

λy (t) = α(t)

(4)

s<t

for t > 0, where π : R+ → R+ is a function and {α(t) : t ≥ 0} is a non-negative stochastic process. This is similar to
Equation (3), however the intensity increases due to past infections, rather than past observations.
Consider the special case where π is a probability density and where α(t0 ) = α(t) for all t0 . The average number of
observation events attributable to a single infection is then α(t), and so this is an instantaneous ascertainment rate. π is
then interpreted as the distribution for the time from an infection to an observation, and therefore we call it the infection
to observation distribution.

3

4

Infection Process

Starting from the continuous model, we now describe a discrete model, which results in the formulation of Section 2. This
discrete model is more amenable to inference. Let It be the number of new infections at time t; this is the equivalent of
I
NtI − Nt−1
in the continuous model. As basic modelling block we use the following discrete version of (3):

E[It |R1:t , Iv:t−1 ] = Rt Lt ,
where Lt :=

P

s<t Is gt−s

(5)

is the case load or total infectiousness by time t > 0. Moreover, letting it := E[It |R1:t , Iv:0 ]

and taking the conditional expectation given reproduction numbers R1:t and seeded infections Iv:0 on both sides of (5)
gives
it = Rt E[Lt |R1:t , Iv:0 ] = Rt

X

E[Is |R1:s , Iv:0 ]gt−s = Rt

X

s<t

is gt−s ,

s<t

which is Equation (1). This is a discrete renewal equation, which can alternatively be interpreted as an AR(t)-process with
known coefficients gk . From this point of view, the basic model in Section 2 uses it as synonymous with actual infections.
Since infections are simply a deterministic function of other parameters, there is no need to treat them as unknown latent
parameters to sample. This can lead to lower sampling times and faster convergence.

4.1

Modeling Latent Infections

The model of Section 2 can be extended by replacing each it with the actual infections from the counting process It , and
then assigning a prior to It . Although sampling can be slower, this has certain advantages. When past infection counts
are low, significant variance in the offspring distribution can imply that new infections It has high variance. This is not
explicitly accounted for in the basic model. In addition, this approach cleanly separates infections and observations; the
latter being modeled conditional on actual infections. The sampling distribution can then focus on idiosyncrasies relating
to the observation process.
We assign a prior to It conditional on previous infections and current transmission Rt . The expected value for this is
given by Equation (5). Appendix 10.1 shows that assuming the variance of the prior to be a constant proportion d of this
mean is equivalent to letting d be the coefficient of dispersion for the offspring distribution. d > 1 implies overdispersion,
and can be used to account for super-spreading events, which has been shown to be an important aspect for modeling
Covid-19. The parameter d can be assigned a prior.
Any two parameter family can be used to match these first two moments. Letting this be continuous rather than discrete
allows inference to proceed using Hamiltonian Monte Carlo, whereby new values for It are proposed simultaneously
with all other parameters. Possible candidates include log-normal, gamma and the Weibull distributions. If an explicit
distribution for the offspring distribution is desired, one can show that assuming a Gamma distribution with rate λ for this
results in a Gamma distribution for It with rate λ. The coefficient of dispersion is then simply D = λ−1 .

4.2

Population Adjustments

If Rt remains above unity over time, infections grow exponentially without limit. In practice, infections should be bounded
from above by S0 , the initial susceptible population. All else being equal, transmission rates are expected to fall as the
susceptible population is diminished.
Consider first the model using It , which was described in Section 4.1. Equation 5 can be replaced with




Ru,t Lt
E[It |R1:t , Iv:t−1 ] = (S0 − It−1 ) 1 − exp −
S0


,

(6)

where Ru,t is an unadjusted reproduction number, which does not account for the susceptible population. This satisfies
intuitive properties. As the unadjusted expected infections Ru,t Lt approaches infinity, the adjusted expected value approaches the remaining susceptible population. The motivation for and derivation of Equation (6) is provided in Appendix
10.2. In short, this is the solution to a continuous time model whose intensity is a simplification of Equation (3). We must

4

also ensure that the distribution of It cannot put positive mass above S0 − It−1 . A simple solution is to use truncated
distributions. Of course, this adjusts the mean value from Equation (6), however this is unlikely to be significant unless
the susceptible population is close to depletion.
In the basic model, one can apply the adjustment to it by replacing Lt in Equation (6) with
E(Lt |R1:t , Iv:0 ) =

X

is gt−s .

(7)

s<t

5

Observations

Observations are modeled in discrete time, analogous to how we treated infections in Section 4. Letting π : N → R+ and
Y
Yt := NtY − Nt−1
, the discrete analogue to Equation (4) is

E[Yt |αt , Iv:t ] = αt

X

Is πt−s .

(8)

s≤t

Taking the expected value of the above given seeded infections, transmission rates and the current ascertainment rate gives
E[Yt |αt , R1:t , Iv:0 ] = αt

X

is πt−s ,

(9)

s≤t

which is recognisable as Equation (2). Thus we have two possible expressions for the mean of Yt , one given actual
infections, and the other given expected infections it . The basic model of Section 2 uses the latter, while the extension in
Section 4.1 uses the former.
We assume that Yt ∼ F (yt , φ), where F is a non-negative discrete family parameterised by its mean yt and potentially
an auxiliary parameter φ. This could be a Poisson distribution, where there is no auxiliary parameter. Using a quasiPoisson or negative binomial instead allows for overdispersion. This can be useful to capture, for example, day-to-day
variation in ascertainment rates when infection counts are low. The mean yt can be taken to be either (8) or (9), the latter
being used in the basic version of the model. Hidden in this formulation is the assumption that each Yt is conditionally
(l)

independent given yt . Using multiple observation series Yt

can help to improve the model inferences and identifiability

of certain parameters. We simply assume that each such series is conditionally independent given the underlying infection
process.

6

Multilevel Models

Transmission rates can be modeled quite generally within the framework. If the aim is simply to estimate transmission
in a single region over time, one approach could be to let Rt = g −1 (γt ), where g is a link function and γt is some
autocorrelation process, for example a random walk. Suppose, however, that transmission is modeled in M regions and
(m)

the goal is to estimate the effect of a series of NPIs on transmission. Letting Rt
t, we could let
(m)
Rt

=g

−1

(m)
β0

+

p
X

denote transmission in region m at time

!
(m) (m)
x t βk

,

(10)

l=1
(m)

where xt

(m)

are binary encodings of NPIs, and β0

(m)

and βk

are region-specific intercepts and effects respectively.

The intercepts are used to allow regions to have their own baseline transmission rates. Collecting these group specific
parameters into β (m) , we can partially pool them by letting β (m) ∼ N (0, Σ), for each group m, and the assigning a prior
to the covariance matrix Σ. This could be an inverse-Wishart prior, or alternatively, Σ can be decomposed into variances
and a correlation matrix, which are each given separate priors (Tokuda et al., 2011).
One possible option for g is is the log-link. This provides easily interpretable effect sizes; a one unit change in
a covariate multiplies transmission by a constant factor. However, this can lead to prior mass on unreasonably high

5

transmission rates. With this in mind, an alternative is to use a generalisation of the logit link for which
g −1 (x) =

K
,
1 + e−x

(11)

and where K is the maximum possible value for transmission rates. This serves a similar purpose to the carrying capacity
in a logistic growth model.
The ascertainment rate αt can also be modeled with similar considerations to the above. This flexibility is useful,
particularly because these quantities are likely to change as an epidemic progresses. This has been clearly seen during the
Covid-19 epidemic, where the infection ascertainment rate may have increased over time due to increased testing capacity
and improved track and trace systems. Multilevel models can in theory also be specified through αt .

7

Forecasting, epidemiological constants, and seeding

A key benefit of using a semi-mechanistic approach is that forecasts are constrained by plausible epidemiological mechanisms. For example, in the absence of any further interventions or behavioural changes, and looking at a medium term
forecast of just incidence (daily new cases/infections), a traditional time series forecasting approach may predict a constant function based on observing broadly constant incidence, but semi-mechanistic approach would expect a monotonic
decrease based on a constant rate of transmission and the effect of herd immunity. The performance of epidemiologically
constrained models is generally good (Carias et al., 2019); this is perhaps not surprising as examining the discrete renewal
equation shows that these models correspond to autoregressive(n) filters with a convex combination of coefficients specified by the generation interval. However, similar to financial forecasting, the predictive capability of epidemic models are
likely to be better interpreted as scenarios rather than actual predictions due to the rapidly adaptive landscape of policy.
A second benefit of epidemic models is to provide a plausible mechanism to explain (non causally) the changes
observed in noisy data. For example, in estimating the effect of an intervention on observed death data, we need consider
what that intervention affects i.e the rate of transmission or Rt . As we have described above, we can connect the rate
of transmission to latent infections to deaths such that we have an epidemiologically motivated mechanism. While we
can statistically estimate parameters for how the intervention affects Rt , certain important parameters will be entirely
unidentifiable and need to be fixed as constants or with very tight priors. For example, to reliably estimate the number of
infections, an infection fatality rate needs to be chosen. A failure to choose an appropriate infection fatality rate can result
in a bimodal posterior where changes can either be attributed to herd immunity or to interventions. From a statistical
perspective, is it difficult to disentanlge which mode of the posterior best represents reality, and hence it is sensible to
first estimate a plausible infection fatality rate and then use this within the semi-mechanistic model. A second example
is the onset of symptoms-to-death distribution. Given the lag between transmission, infection and deaths, the effect of an
intervention is dependent on the onset of symptoms-to-death distribution.
Infection seeding is a fundamentally challenging aspect of epidemic modelling. Estimating the initial effect of seeding
is crucial to understanding a baseline rate of growth (R0 ) from which behaviours and interventions can modify. This
seeding is heavily confounded by importation and under ascertainment. Both these factors can influence estimates of the
initial growth rates, and this in turn can affect the impact of changes in transmission as time progresses. We have proposed
heuristic approaches to mitigate issues with early seeing, but principled statistical approaches need to be developed. In
particular, Bayesian pair plots show strong correlation between seeding parameters and R0 , which can potentially lead
again to a bimodal posterior where initial growth dynamics can be explained through R0 or via initial seed infections.

8

Confounding and Causality: Estimating the Effect of Interventions

Section 6 showed that changes in transmission rates over time can be explained by parameterising these rates in terms of
predictor variables, such as NPIs and mobility. Clarifying the effects of interventions on transmission is important, if only
because of their clear economic and human consequences. This is however a significant challenge because the effects
are potentially confounded with unobserved behavioural changes, and they are hard to identify. Identification is difficult

6

because interventions are highly correlated when they occur in quick succession. Moreover, the random time between an
infection and its recording as a case or death leads to observations being less informative about the effect of any particular
intervention.
Flaxman et al. (2020b) estimated the effectiveness of NPIs across 11 European countries, and used partial pooling of
effect sizes to address the identification problem. At that time, little data existed other than information on deaths and the
timing of interventions. NPIs, which were coded as a binary set of mandatory government measures (e.g. school closures,
ban on public events, lockdown), could not fully explain the patterns seen in some countries (e.g. Sweden), and especially
at the subnational level. Mobility data became available in April and was used to model the epidemic in Italy, Brazil
and the USA (Vollmer et al., 2020; Mellan et al., 2020; Unwin et al., 2020). Such data is useful as it may help account
for behavioral changes that confound the effects of NPIs. However since mobility affects transmission, is linked to the
introduction of NPIs and potentially also to voluntary behavioural measures, we expect it to be a confounder.
Section 8.2 extends the model in Flaxman et al. (2020b) to investigate further this issue of confounding, and models
both NPIs and mobility jointly. This is in keeping with standard practice in regression/ANOVA: expanding a model to
take into account more explanatory variables. Nonetheless, NPIs may partially affect transmission via a path through
mobility. A joint model of mobility and NPIs does not account for this. Therefore, in Section 8.3 we take a first step
in assessing causal considerations through a simple mediation analysis. We begin however by exploring the relationship
between interventions and mobility.

8.1

Interventions and Mobility

Regressing average mobility on NPIs in a Bayesian linear model (no intercept or partial pooling) we find a correlation
of over 85% with a mean absolute error of 0.1%. Given mobility generally ranges from -1 to 1, this is a good overall
fit. Figure 1a shows that these fits visually correspond well with changes in average mobility. One could conjecture that
mobility and NPIs are lagged, but lagging NPI dates either forwards or backwards in time does not result in a better fitting
model (see Figure 1b). Indeed Figure 1b does support a hypothesis that the timing of NPIs and changes in mobility are
strongly linked. The coefficient sizes from this regression are entirely consistent with Flaxman et al. (2020b) finding
that the NPI with the largest effect size is lockdown (see Figure 1c). This simple analysis does not model transmission,
but does provide strong evidence that mobility and NPIs do not provide conflicting narratives. We note, to perform this
regression as fairly as possible we used a hierarchical shrinkage prior (Piironen and Vehtari, 2017) that performs both
shrinkage and variable selection.

(a)

(b)

(c)

Figure 1: Simple regression of mobility against NPIs. Figure (a) shows the fit for the United Kingdom with mobility
in black and the fit for NPIs in red. (b) Shows the effect on mean absolute error from lagging the NPIs. (c) Shows the
coefficient effect sizes from the regression. Y axis are NPIs and X axis the regression effect sizes

8.2

Controlling for Mobility

Section 8.1 found a large correlation between interventions and mobility, demonstrating that mobility is a potential confounder. Here we control for this by jointly modeling NPIs and mobility. This is done using the same 11 European
countries, sets of NPIs and death data as used in Flaxman et al. (2020b).
A two-stage approach (Haug et al., 2020) is used, whereby Rt is first estimated using a daily random walk. In the
second stage this is regressed on NPIs and mobility. The random walk can in theory select any arbitrary function of Rt that
7

best describes the data without any prior information about which interventions happened when or how well they worked.
Given these estimates of Rt for all 11 European countries, we run a simple partial pooling model to see if interventions
and/or mobility can reproduce the trends in Rt . The model used is a linear regression with country level intercepts (to
account for variation in R0 ), and both joint and country specific effect sizes for interventions/mobility. As with the earlier
analysis we use a hierarchical shrinkage prior on the coefficients (Piironen and Vehtari, 2017).
Three variations of the model are considered: NPIs only (NPI only), mobility only (Mobility only), and both NPIs
and mobility (NPI+Mobility). MCMC convergence diagnostics in all cases did not indicate problems. We found the best
fitting model to be NPI+Mobility. Relative to this model the expected log posterior difference (± standard error) in WAIC
of the model with only NPIs is −5.2 ± 4, ad −565.6 ± 49.2 with only mobility. Therefore, in fits to the estimated Rt ,
the model with mobility alone is substantially worse than the models with NPIs. Controlling for mobility does not appear
to significantly change the estimated effects of NPIs. As in Flaxman et al. (2020b), the largest effect size is attributed to
lockdown, as seen in Figure 2. This is true with and without the inclusion of the mobility variable. This analysis could
be improved using Bayesian leave-one-out cross-validation (Vehtari, Gelman, and Gabry, 2017) to account for the time
series nature of the data.

(b)

(a)

(c)

Figure 2: Regression of NPIs and/or mobility against nonparametric Rt . Figure (a) shows the fit for NPIs only. (b) for
mobility only, (c) NPIs and mobility. Mobility only was not significantly preferred by WAIC. Y axis are covariates and X
axis the regression effect sizes
An advantage of the two-stage approach is that it is scalable to a large number of regions. Rt can be estimated in
each region in parallel using separate models. Partial pooling can still be leveraged to estimate effects in the second stage.
Once Rt has been estimated, any number of interesting statistical analyses can be conducted. Nonetheless the estimated
Rt is not entirely non-parametric; it is clearly influenced by its random walk form in the first stage. This analysis could be
extended by considering a range of alternative priors for Rt . More importantly however, this approach has not considered
causal relationships between NPIs and mobility. This is the focus of the next example.

8.3

Causal Mediation

The effect of interventions in the previous analysis holds mobility constant. However, we intuitively expect that part of
these effects occur indirectly through changeing mobility. We can hypothesise that changes in mobility are both an effect
of NPIs and a cause of reductions in transmission. Causal mediation analysis provides a means to disentangle the total
effect of a variable into a direct and indirect effect. The indirect effect occurs via some mediator, which in this case is
hypothesised to be mobility. Further information about causal mediation can be found here (Pearl, 2009; Pearl, 2012).
Only lockdown is considered here because performing causal mediation with all NPIs is challenging and lockdown
is consistently the NPI with the largest effect size in Section 8.1, Section 8.2 and in Flaxman et al. (2020b). Briefly, to
perform causal mediation we consider two transmission models
(m)

Rt

(m)
Rt

1
= R̃m
exp

=

2
R̃m

exp



1
β11 + β1,m
Lt,m + 1t,m ,



2
2
β12 + β1,m
Lt,m + β22 + β2,m
Mt,m + 2t,m ,

(12)
(13)

i
where Lt,m is a binary indicator for lockdown and Mt,m is mobility in country m respectively. R̃m
and it,m are country

specific parameters modeling baseline transmission and a weekly random walk respectively. All other aspects of both
models are the same as in (Flaxman et al., 2020b). Model (12) includes effects for lockdown, while (13) additionally
8

considers mobility. β11 is the total effect for lockdown, while β12 is the partial effect when controlling for mobility. The
mediated effect is therefore β11 − β12 . This quantifies the effect of lockdown via the path through mobility. We find this
mediated effect reduces Rt by 18.3% with a 95% credible interval of [12.2%, 44.4%]. The posterior probability of the
effect being greater than 0 is 89.6% . Individual coefficients are shown in Figure 3.

●

Covariate

Covariate

averageMobility

●

lockdown

●

lockdown

0%
(no effect on transmissibility)

25%

50%

75%

100%
0%
(ends transmissibility) (no effect on transmissibility)

25%

Relative % reduction in Rt

50%

75%

100%
(ends transmissibility)

Relative % reduction in Rt

(a)

(b)

Figure 3: Mediation analysis (a) Lockdown, (b) Lockdown and Mobility
These mediation results suggest a causal link between lockdown and mobility that eventually leads to reduced transmission rates. They also suggest that the mediated effect is far less than the total effect of lockdown, suggesting lockdown
will have other causal pathways. Of course, mobility is also mediated through other pathways, and a principled causal
analysis is out of the scope of this article. The exclusion of other NPIs may introduce omitted variable bias. Nonetheless,
this simple analysis with lockdown adds support to causal considerations.

9

Discussion

This article has discussed a class of statistical models for epidemics such as Covid-19 which are able to capture key epidemiological mechanisms. The model has appeared in various forms for specific analyses during the Covid-19 crisis and,
at the time of writing, continues to be used to inform public policy. By presenting it in a general form and discussing key
modelling difficulties we hope to stimulate discussion around it. One key difficulty within the framework is dealing with
confounded variables, particularly those used to explain changes in transmission during the early stages of an epidemic.
The analyses in Section 8 make a first step in dealing with these, and support the central finding of Flaxman et al. (2020b):
that lockdown and other NPIs together served to control the first wave of the epidemic in 11 European countries.
A number of model enhancements have not been discussed here. These include explicitly accounting for importations,
and allowing for uncertainty in the generation and infection to observation distributions. The model can be fit using Stan
(Stan Development Team, 2018), but the adaptive Hamiltonian Monte Carlo used often has difficulty converging when
latent infections are modeled directly, or when multiple regions are jointly modeled. We conjecture that convergence may
be improved by carefully choosing initial parameters for the sampler. Future research could explore whether alternative
samplers can be developed to fit these models more pragmatically.

References
Badr, Hamada S. et al. (2020). “Association between mobility patterns and COVID-19 transmission in the USA: a mathematical modelling study”. In: The Lancet Infectious Diseases. ISSN: 14744457.
Bartoszynski, Robert (1967). “Branching Processes and the Theory of Epidemics”. In: Proceedings of the Fifth Berkeley
Symposium on Mathematical Statistics and Probability.

9

Bellman, R. and T. E. Harris (1948). “On the Theory of Age-Dependent Stochastic Branching Processes”. In: Proceedings
of the National Academy of Sciences. ISSN: 0027-8424.
Bellman, Richard and Theodore Harris (1952). “On Age-Dependent Binary Branching Processes”. In: The Annals of
Mathematics. ISSN: 0003486X.
Bettencourt, Luı́s M.A. and Ruy M. Ribeiro (2008). “Real time bayesian estimation of the epidemic potential of emerging
infectious diseases”. In: PLoS ONE. ISSN: 19326203.
Carias, Cristina et al. (Nov. 2019). “Forecasting the 2014 West African Ebola Outbreak”. In: Epidemiologic Reviews 41.1,
pp. 34–50. ISSN: 1478-6729. eprint: https://academic.oup.com/epirev/article-pdf/41/1/34/
33044075/mxz013.pdf. URL: https://doi.org/10.1093/epirev/mxz013.
Cauchemez, Simon et al. (2008). “Estimating the impact of school closure on influenza transmission from Sentinel data”.
In: Nature. ISSN: 14764687.
Champredon, David, Jonathan Dushoff, and David J.D. Earn (2018). “Equivalence of the Erlang-distributed SEIR epidemic model and the renewal equation”. In: SIAM Journal on Applied Mathematics. ISSN: 00361399.
Cori, Anne et al. (2013). “A new framework and software to estimate time-varying reproduction numbers during epidemics”. In: American Journal of Epidemiology. ISSN: 00029262.
Cowling, Benjamin J. et al. (2020). “Impact assessment of non-pharmaceutical interventions against coronavirus disease
2019 and influenza in Hong Kong: an observational study”. In: The Lancet Public Health. ISSN: 24682667.
Ferguson, N. M., C. A. Donnelly, and R. M. Anderson (2001). “Transmission intensity and impact of control policies on
the foot and mouth epidemic in Great Britain”. In: Nature. ISSN: 00280836.
Flaxman, S et al. (2020a). “Report 13: Estimating the number of infections and the impact of non-pharmaceutical interventions on COVID-19 in 11 European countries”. In: Spiral. URL: https://doi.org/10.25561/77731.
Flaxman, Seth et al. (2020b). “Estimating the effects of non-pharmaceutical interventions on COVID-19 in Europe”. In:
Nature. ISSN: 1476-4687. URL: https://doi.org/10.1038/s41586-020-2405-7.
Fraser, Christophe (2007). “Estimating individual and household reproduction numbers in an emerging epidemic”. In:
PLoS ONE. ISSN: 19326203.
Fraser, Christophe et al. (2009). “Pandemic potential of a strain of influenza A (H1N1): Early findings”. In: Science. ISSN:
00368075.
Gelman, Andrew and Jennifer Hill (2006). Data Analysis Using Regression and Multilevel/Hierarchical Models.
Getz, Wayne and James Lloyd-Smith (2006). “Basic methods for modeling the invasion and spread of contagious diseases”. In.
Haug, Nils et al. (2020). “Ranking the effectiveness of worldwide COVID-19 government interventions”. In: Nat. Hum.
Behav. 4.12, pp. 1303–1312. ISSN: 2397-3374.
HKSAR, SARS Expert Committee of (2003). Chronology of the SARS epidemic in Hong Kong. Tech. rep. Hong Kong.
Hox, Joop J, Mirjam Moerbeek, and Rens de Schoot (2010). Multilevel analysis: Techniques and applications. Routledge.
Kelly, Heath A. et al. (2010). “Pandemic (H1N1) 2009 influenza community transmission was established in one Australian state when the virus was first identified in North America”. In: PLoS ONE. ISSN: 19326203.
Kermack, William Ogilvy and McKendrick, A. G. (1927). “A contribution to the mathematical theory of epidemics”. In:
Proceedings of the Royal Society of London. Series A, Containing Papers of a Mathematical and Physical Character.
ISSN : 0950-1207.
Kreft, Ita and Jan de Leeuw (2011). Introducing Multilevel Modeling.
Li, Ruiyun et al. (2020). “Substantial undocumented infection facilitates the rapid dissemination of novel coronavirus
(SARS-CoV-2)”. In: Science. ISSN: 10959203.
May, Robert M. (1976). “Simple mathematical models with very complicated dynamics”. In: Nature. ISSN: 00280836.
Mellan, Thomas A et al. (2020). “Subnational analysis of the COVID-19 epidemic in Brazil”. In: medRxiv. URL: https:
//www.medrxiv.org/content/early/2020/08/24/2020.05.09.20096701.
Miller, Andrew C et al. (2020). “Mobility trends provide a leading indicator of changes in SARS-CoV-2 transmission”.
In: medRxiv. URL: https : / / www . medrxiv . org / content / early / 2020 / 05 / 11 / 2020 . 05 . 07 .
20094441.

10

Mishra, Swapnil et al. (2020a). “A COVID-19 Model for Local Authorities of the United Kingdom”. In: medRxiv. URL:
https://www.medrxiv.org/content/early/2020/11/27/2020.11.24.20236661.
Mishra, Swapnil et al. (June 2020b). “On the derivation of the renewal equation from an age-dependent branching process:
an epidemic modelling perspective”. In: arXiv: 2006.16487 [q-bio.PE].
Nouvellet, Pierre et al. (2018). “A simple approach to measure transmissibility and forecast incidence”. In: Epidemics.
ISSN :

18780067.

NYS Press Office (2020). Amid Ongoing COVID-19 Pandemic, Governor Cuomo Announces State is Bringing in International Experts to Help Advise the State’s Reopening Plan. URL: https : / / www . governor . ny . gov /
news/amid-ongoing-covid-19-pandemic-governor-cuomo-announces-state-bringinginternational-experts.
Olney, Andrew M et al. (2020). “Estimating the Effect of Social Distancing Interventions on COVID-19 in the United
States”. In: medRxiv.
Pearl, Judea (2009). “Causal inference in statistics: An overview”. en. In: Stat. Surv. 3, pp. 96–146.
— (2012). “The causal mediation formula—a guide to the assessment of pathways and mechanisms”. In: Prev. Sci. 13.4,
pp. 426–436.
Piironen, Juho and Aki Vehtari (2017). “Sparsity information and regularization in the horseshoe and other shrinkage
priors”. en. In: Electron. J. Stat. 11.2, pp. 5018–5051.
Riley, Steven et al. (2003). “Transmission dynamics of the etiological agent of SARS in Hong Kong: Impact of public
health interventions”. In: Science. ISSN: 00368075.
Rizoiu, Marian-Andrei et al. (2017). “Expecting to Be HIP: Hawkes Intensity Processes for Social Media Popularity”.
In: Proceedings of the 26th International Conference on World Wide Web. WWW ’17. Perth, Australia: International
World Wide Web Conferences Steering Committee, 735–744. ISBN: 9781450349130. URL: https://doi.org/
10.1145/3038912.3052650.
Stan Development Team (2018). The {Stan} Core Library. URL: http://mc-stan.org/.
The Scottish Government (2020). Coronavirus (COVID-19): modelling the epidemic. URL: https : / / www . gov .
scot/collections/coronavirus-covid-19-modelling-the-epidemic/.
Thompson, W. A., Howard M. Taylor, and Samuel Karlin (1985). “An Introduction to Stochastic Modeling.” In: Journal
of the American Statistical Association. ISSN: 01621459.
Tokuda, Tomoki et al. (2011). “Visualizing distributions of covariance matrices”. In: Columbia Univ., New York, USA,
Tech. Rep, pp. 18–18.
Unwin, H. Juliette T. et al. (2020). “State-level tracking of COVID-19 in the United States”. In: Nature Communications
(in Press).
Vehtari, Aki, Andrew Gelman, and Jonah Gabry (Sept. 2017). “Practical Bayesian model evaluation using leave-one-out
cross-validation and WAIC”. In: Stat. Comput. 27.5, pp. 1413–1432.
Vollmer, Michaela A. C. et al. (2020). “A sub-national analysis of the rate of transmission of COVID-19 in Italy”. In:
medRxiv. URL: https : / / www . medrxiv . org / content / early / 2020 / 05 / 09 / 2020 . 05 . 05 .
20089359.
Wallinga, Jacco and Peter Teunis (2004). “Different epidemic curves for severe acute respiratory syndrome reveal similar
impacts of control measures”. In: American Journal of Epidemiology. ISSN: 00029262.
WHO (2003). SARS: chronology of a serial killer. Tech. rep.

10

Appendix

10.1

Offspring Dispersion

Define the offspring distribution of any given infection to be the distribution of the random number of offspring attributable
to that infection. We show that assuming the variance of these distributions are a constant proportion of the mean implies,
under suitable independence assumptions, the same result for new infections It for all time points.
(i)

Assume some ordering over infections at each period, and let Ot denote the number of offspring of the ith infection
11

at time t. This can be decomposed as
(i)

Ot =

∞
X

(i)

Ots ,

(14)

s=t+1
(i)

(i)

where Ots are the number of offspring of i birthed at time s. The branching process behind Equation (5) implies that Ots
(i)

has mean Rs gs−t . Assume that {Ots : s ≥ t} are mutually independent and have variance which is a fixed proportion d
(i)

of the mean. By Equation (14), this implies the same variance relationship for Ot . In particular, if Rs = Rt for s > t
(i)

then Ot has mean Rt and variance dRt . New infections at time t can be expressed as
It =

Is
t−1 X
X

(i)

Ost .

(15)

s=1 i=1
(i)

Assume that all Ost appearing in Equation (15) are mutually independent conditional on everything occurring up to time
t − 1, the result clearly follows by taking the variance of both sides of Equation 15 given Rt and Iv:t−1 .

10.2

Population Adjustment

Here we motivate Equation (6), which is used to adjust transmission rates for the size of the infectable population. The
most obvious starting point for such an adjustment would be to let

E[It |Rt , Iv:t−1 ] =

S0 − It−1
S0


Ru,t Lt ,

(16)

where Rut is defined as in Section 4.2. This is similar in form to a discrete logistic growth model. Such models are
well known as examples of simple models that exhibit chaotic dynamics (May, 1976). In particular, it is possible that
the expected value on the left hand side exceeds the remaining susceptible population. Intuitively, this issue occurs
because multiple infections can occur simultaneously in the discrete model. We therefore propose solving this by using a
population adjustment motivated by the solution to a continuous time model whose intensity is a simplification of Equation
(3).
Suppose we observe Iv:t−1 and current transmission Rt . We evolve infections from time t − 1 to t continuously, and
˜ process starting at time t − 1 by the intensity
hence avoid overshooting. Define a continuous time counting I(s)
λ̃(s) =

˜
S0 − I(s)
S0

!
Ru,t Lt ,

(17)

˜ − 1) = It−1 . Supplementary 11.1 shows that
for s ≥ t − 1, and with initial condition I(t



Ru,t Lt
˜
E[I(t)] = It−1 + (S0 − It−1 ) 1 − exp −
,
S0
which is the motivation for Equation (6).

12

(18)

11

Online Supplement

11.1

Proof of Equation (18)

Without loss of generality, we prove the result for time t = 1. The argument remains the same for all t > 1.
From Thompson, Taylor, and Karlin, 1985, Lemma 5.5, we have
˜
˜ +
E[I(s)]
= I(0)

s

Z

E[λ̃(l)]dl for s ≥ 0.
0

The following lemma derives an expression for the the expected intensity on the right hand side.
Lemma 11.1. The expected intensity takes the form


Ru,1 L1
E[λ̃(s)] = λ̃(0) exp −
s ,
S0
for all s ≥ 0.
Proof of Lemma 11.1. Fix s ≥ 0, some small ∆ > 0 and let h(s) := E[λ̃(s)]. We have from Equation (17) that
h(s + ∆) =

˜ + ∆)]
S0 − E[I(s
S0

!
Ru,1 L1 .

(19)

We can write
˜ + ∆)|λ̃(s)] = E[I(s)|
˜ λ̃(s)] + λ̃(s)∆ + O(∆),
E[I(s
and taking expectations on both sides,
˜ + ∆)] = E[I(s)]
˜
E[I(s
+ h(s)∆ + O(∆).
Substituting this into (19) and rearranging gives
h(s + ∆) =

˜ + ∆)]
S0 − E[I(s
S0

= h(s) −

!
Ru,1 L1 −

Ru,1 L1
(h(s)∆ + O(∆)) ,
S0

Ru,1 L1
(h(s)∆ + O(∆)) .
S0

Rearranging gives
h(s + ∆) − h(s)
Ru,1 L1
=−
∆
S0


h(s) +

O(∆)
∆


.

Taking the limit as ∆ → 0 and rearranging gives the differential equation
h0 (s)
Ru,1 L1
=−
.
h(s)
S0
Integrating both sides gives
log(h(s)) = −

Ru,1 L1
s + C.
S0

Using that h(0) = λ̃(0) gives the constant C = log(λ̃(0)). Plugging in yields the required result.

13

Hence,
s



Ru,1 L1
exp −
l dl
S0
0



S0
Ru,1 L1
= I0 + λ̃(0)
1 − exp −
s
Ru,1 L1
S0



Ru,1 L1
˜
= I0 + (S0 − I(s))
1 − exp −
s
.
S0

˜
E[I(s)]
= I0 + λ̃(0)

Z

Letting s = 1 gives the required result.

14

