arXiv:2007.16058v2 [stat.AP] 18 Feb 2021

Regional now- and forecasting for data
reported with delay: Towards surveillance of
COVID-19 infections
Giacomo De Nicola* , Marc Schneble* , Göran Kauermann* and
Ursula Berger**
*

Department of Statistics, Ludwig-Maximilians-University
Munich, Germany
**
Institute for Medical Information Processing, Biometry and
Epidemiology, Ludwig-Maximilians-University Munich, Germany
Abstract
Governments around the world continue to act to contain and mitigate the spread of COVID-19. The rapidly evolving situation compels
officials and executives to continuously adapt policies and social distancing measures depending on the current state of the spread of the
disease. In this context, it is crucial for policymakers to have a firm
grasp on what the current state of the pandemic is as well as to have
an idea of how the infective situation is going to unfold in the next
days. However, as in many other situations of compulsorily-notifiable
diseases and beyond, cases are reported with delay to a central register,
with this delay deferring an up-to-date view of the state of things. We
provide a stable tool for monitoring current infection levels as well as
predicting infection numbers in the immediate future at the regional
level. We accomplish this through nowcasting of cases that have not
yet been reported as well as through predictions of future infections.
We apply our model to German data, for which our focus lies in predicting and explain infectious behavior by district.

1

1

Introduction

The infectious disease known as COVID-19 hit the planet in tsunami-like
fashion. The first cases were identified in December 2019 in the city of
Wuhan, China, and by March 2020 infections had already spread over the
entire world. Nearly all of the affected countries progressively implemented
measures to slow down the spread of the virus, ranging from recommended
social distancing to almost complete lockdowns of social and economic activity. These measures eventually proved to be effective, as the number of
infections could be slowed down (see e.g. Flaxman et al., 2020 and Roux
et al., 2020). This allowed numerous states to relax restrictions, in an attempt to gradually return to normality. At the same time, with the threat
posed by the virus still looming, decision makers are forced to strike a balance
between epidemiological risk and allowance of socio-economic activity. In this
context, surveillance of the number of new infections became increasingly important, and particularly so on a regional level. Given the local nature of the
phenomenon (see e.g. Gatto et al., 2020 and Li et al., 2020), such regional
view appears to be of crucial importance. One of the difficulties lies in the
fact that exact numbers of infections detected on a particular day are only
available with a reporting delay of, in some cases, several days, which occurs
along the reporting line from local health authorities to the central register.
The following paper provides a stable tool for monitoring current infection
levels corrected for incompleteness of the data due to reporting delays. This
approach is also extended towards predicting the infectious behavior in the
immediate future at the regional level.
More specifically, the scope of our model is threefold: Firstly, we aim to
understand the current epidemiological situation as well as to comprehend
the association between the number of detected infections and demographic
characteristics and geographical location. Secondly, our goal is to nowcast
infections that have already been observed but have not yet been included in
the official numbers. New infections are detected through tests and registered
by the local health authorities, which in turn will report the numbers to
national authorities with an inevitable delay. Since we observe reports of
infections for each day, we are able to model this delay, which indeed allows
to nowcast infection numbers for today correcting for infections which have
not yet been reported. Lastly, our aim is also to forecast the epidemiological
situation for the immediate future. We here want to stress that our model
is not aiming to exactly predict future infection numbers, as that would not
2

be realistic. The goal is rather to try and give a general idea of what is
going to happen in the next days in the different districts, and, perhaps
most importantly, help identify which districts are going to be the most
problematic. This could also help policymakers in making decisions regarding
the implementation of safety measures at the regional level.
We apply our modeling approach to explain and predict numbers of registered COVID-19 infections for Germany by district, age group and gender.
While the regional component is of evident and paramount importance, the
age group and gender distinctions are also very relevant, given the powerful
interaction of demography and current age-specific mortality for COVID-19
(Dowd et al., 2020).
Our nowcasting approach can also be used to obtain up-to-date measures
of the 7-days incidence, both at the local as well as at the national level.
This quantity is often used by authorities to assess how hard a specific area
is currently hit by the pandemic, and sometimes (as is the case for Germany)
it is also employed as a criterion to decide which containment measures are
appropriate. It is especially important to have up-to-date infection numbers
when computing such a measure, as it is inherently evolving on a daily basis;
At the time of writing, the index is calculated by German officials through
use of the date of report by the local health authorities. Given that, as
already stated, there are significant delays in the reporting of cases from
local authorities to the national ones, the resulting figures are consistently
underestimating the actual incidence, with the error being potentially quite
large and problematic. Our nowcasts offer a simple and stable solution to
this issue, providing infection numbers that are already corrected for expected
delays.
The statistical modeling of infectious diseases is a well developed scientific field. We refer to Held et al. (2017) for a general overview of the different models. Modeling and forecasting COVID-19 infections has been tackled by numerous research groups using different models. Panovska-Griffiths
(2020) discusses whether one or multiple models may be useful for COVID-19
data analytics. Stübinger and Schneider (2020) make use of time warping to
forecast COVID-19 infections for different countries (see also Cintra et al.,
2020), while Dehesh et al. (2020) utilize ARIMA time series models. Ray
et al. (2020) combine forecasts from several different models to obtain robust short-term forecasts for deaths related to COVID-19. Fritz et al. (2021)
present a multimodal learning approach combining statistical regression and
machine learning models for predicting COVID-19 cases in Germany at the
3

local level. Early references dating back to the first stages of the pandemic
are Anastassopoulou et al. (2020) and Petropoulos and Makridakis (2020). In
this paper we make use of negative binomial regression models implemented
in the mgcv package in R (Wood, 2017). This allows us to decompose the
spatial component in depth, and obtain district-level nowcasts and forecasts
for Germany. Our results confirm the dynamic and highly local nature of
outbreaks, highlighting the need for continuous regional surveillance on a
small area level.
The rest of the paper is structured as follows: Section 2 describes the
data, while Section 3 frames the problem, presents our model and compares
the performance of different variants over time, motivating our modeling
choices. Section 4 exemplifies surveillance and describes how predictions
are performed in practice, showing the results for exemplary dates. Finally,
Section 5 concludes the paper, highlighting the limitations of this study and
adding some concluding remarks.

2

Data

As previously anticipated, we focus our analyses on German data. To do
so, we make use of the COVID-19 dataset published by the Robert-KochInstitute (RKI) on a daily basis. The RKI is a German federal government
agency and scientific institute responsible for health reporting and for disease control and prevention. It maintains the national register for COVID-19,
where all identified cases of this compulsorily-notifiable disease are reported
from the local health authorities to the RKI. In our analysis we make use
of daily downloads of the data, which we have at our disposal starting from
April 12, 2020 until December 29, 2020. As we want our model to be dynamic, the surveillance analysis is performed considering only infections with
registration dates within 21 days of the day of analysis, with earlier data allowing us to compare the differences in model fit over time.
Table 1 shows an exert of the data we are confronted with. Every morning, the database containing all registered COVID-19 infections is updated
and released to the public, downloadable from the Robert-Koch-Institute’s
repository1 . The dataset contains, for each of the 412 districts, the cumulated number of confirmed cases of COVID-19 infections stratified by age
group (00-04, 05-14, 15-34, 35-59, 60-79 or 80+) and gender, updated to that
1

https://www.arcgis.com/home/item.html?id=f10774f1c63e40168479a1feb6c7ca74

4


District
Age Group




(Landkreis) (Altersgruppe)




Data downloaded
..
..
.
.
on September 25,

Munich
City
60-79


2020


Munich City
60-79




..
..
.
.

District
Age
Group





..
..

Data downloaded
.
.
on September 26,
Munich
City
60-79



2020
Munich City
60-79




..
..
.
.

Gender
(Geschlecht)
..
.
F
M
..
.

Infections
(Anzahl Fall)
..
.
3
5
..
.

Registration Date
Reporting Date
(Meldedatum)
(Datenstand)
..
..
.
.
September 22, 2020 September 25, 2020
September 22, 2020 September 25, 2020
..
..
.
.

Gender
..
.
F
M
..
.

Infections
..
.
6
5
..
.

Registration Date
Reporting Date
..
..
.
.
September 22, 2020 September 26, 2020
September 22, 2020 September 26, 2020
..
..
.
.

Table 1: Illustration of the raw data structure, showing downloads of the
data from September 25 and September 26, 2020 as an example. To facilitate
reproducibility, the original column names used in the RKI datasets are given
in brackets below our English notation.
day, as well as the date of registration of each case by the local public health
authorities (Gesundheitsämter ). Through the merging of daily downloads
of this RKI report, we can construct the full dataset as sketched in Table
1, where the release date is defined in the column “Reporting Date”. This
full data format is necessary to trace the reporting delay for each observation. It can sometimes indeed take several days for the data to get from the
local health authorities to the nation-wide central one, and we thus define
reporting delay as the number of days between registration date and reporting date. Note that since the RKI reports data every morning, all reported
cases will have a delay of at least one day. The delay is especially high during
weekends, a fact that we take into account in our model. Due to the delayed
nature of reporting, the number of registered COVID-19 cases which refer to
a specific registration date might change with the reporting date, as exemplified in Table 1. On September 25, the RKI has reported three registered
infections of females in the age group from 60-79 living in the city of Munich,
which were registered on September 22, 2020. Due to delayed reporting, this
number increased to six in the report of September 26, 2020. The three
newly reported cases have therefore been reported with a delay of four days.
Note once again that the RKI dataset available for download only contains
the information up to the current date, thus making daily downloads of the
datasets necessary to determine reporting delay.
For the sake of brevity, we here do not provide general descriptive statistics of the data, since these numbers can be easily obtained from many other
5

d

t
1
2
..
.

1
N1,0
N2,0
..
.

2
N1,1
N2,1
..
.

T − dmax
T − dmax + 1
..
.

NT −dmax ,0
NT −dmax +1,0
..
.

NT −dmax ,1
NT −dmax +1,1
..
.

T −1
T

NT −1,0
NT,0

NT −1,1
NA

···
···
···
..
.

dmax
N1,dmax
N2,dmax
..
.

···
···
..
.

NT −dmax ,dmax
NA
..
.

NA
NA

NA
NA

Table 2: Reformulated data structure for a single district, age group and
gender, explicitly including delay. Available data are akin to a guillotine
blade.
sources. Among others, we refer to the RKI webpage2 , which also includes a
dashboard to visualize the data (see also CoronaMaps3 ).

3

Surveillance Model

3.1

Framing

We start motivating the model by first reformulating the data structure in
a way that is suitable for the analysis. Let Nt,d denote the newly registered
infections at day t which are reported with delay d and hence included in the
database from day t + d. The minimum possible delay is one day, and we
assume the maximum delay to be equal to dmax days. In our analysis we set
dmax = 7, which corresponds to a week. In other words, we assume delayed
reporting to happen within a week. If we define T as the time point of the
analysis, the data available at that moment will take the form shown in Table
2. The bottom right triangle of the data is missing, so that the structure
2
3

https://www.rki.de/EN/Home/homepage_node.html
https://corona.stat.uni-muenchen.de/maps

6

of the available data is akin to that of a guillotine blade. This comparison
can be helpful to understand prediction of future values, since predicting by
reporting date corresponds to making the blade fall down by one or more
days. In other words, one of our goals will be to predict the diagonal edge of
the blade, which corresponds to the predicted cases reported on day T +1. To
better explain our prediction strategy, we give a sketch of this idea in Figure
1. In the sketch, the green dots represent data that are already observed
at time T (the day of analysis), while the crosses represent entries that are
not yet observed and that we aim to predict with our model. This is done in
three steps, which are described below. To be specific, we pursue nowcasting,
forecasting and the combination of both, forenowcasting.
Nowcasting: Since each row of the matrix contains cases registered on a
single date, to obtain the amount of cases registered on that day, regardless
of the delay with which they are reported, we need to take the sum of the
corresponding row. If the goal is to obtain predictions by registration date
for several days, we then just sum the cases over the corresponding rows.
In Figure 1 we highlight this type of prediction with a green square, which
represents a weekly nowcast, that is the number of cases with registration
dates over the past week. This comprises numbers that have already been
observed as well as the predictions for cases from past days that have not yet
been reported.
Forecasting: If we shift the focus from predicting by registration date to
reporting date, that is, if the aim is to predict reported numbers regardless
of when the reported infections were actually first discovered, we cannot sum
the entries of the matrix row-wise, but we need to do so diagonally. This
is because the reported number on day T is comprised of the sum of cases
registered on day T − 1 reported with delay 1, cases registered on day T − 2
reported with delay 2, and so on and so forth, up until cases registered on
day T − dmax reported with delay dmax . The red parallelogram in Figure 1
thus represents the cumulated weekly forecast, that is, the predicted number
of infections to be reported over the next seven days. Here all entries are
unobserved, and will need to be predicted through our model, which will be
uncovered in the following section.

7

Forenowcasting: We can also combine the two aspects and predict the
number of infections that will happen in the next week, regardless of their
reporting date. While the previously described forecasting (i.e. predicting by
reporting date) is useful to have an idea of the numbers that will be reported
each day, what really gives a picture of the ongoing situation are infection
numbers based on registration date. This weekly prediction corresponds to
the blue square in Figure 1 and in fact is a combination of forecasting and
nowcasting. We will demonstrate that the three types of predictions can be
carried out with a single model, where predictions refers to extending the
data row-wise (i.e. nowcasting), column-wise (i.e. forecasting) or both (i.e.
forenowcasting).
delay d
time t

1
1

2

3

4

5

6

7

● ● ● ● ● ● ●
●
●
●

●
●
●

●
●
●

●
●
●

●
●
●

●
●
●

●
●
●
●
●
●
●
●

●
●
●
●
●
●
●

●
●
●
●
●
●

●
●
●
●
●

● ● ●
● ● ●
● ● ✕
● ✕ ✕
✕

✕

✕

✕

✕

✕

✕

✕

✕

✕

✕

✕

✕

✕

✕

✕

✕

✕

✕

✕

✕

✕

✕

✕

✕

T+1

✕

✕

✕

✕

✕

✕

✕

T+2

✕

✕

✕

✕

✕

✕

✕

T+3

✕

✕

✕

✕

✕

✕

✕

T+4

✕

✕

✕

✕

✕

✕

✕

T+5

✕

✕

✕

✕

✕

✕

✕

T+6

✕

✕

✕

✕

✕

✕

✕

T-8
T-7
T-6
T-5
T-4
T-3
T-2
T-1
T≙day of analysis

●

≙ observed on day T

✕

≙ not observed on day T

●
●
●

nowcast

forecast

fore-nowcast

Figure 1: Sketch of the reformulated data structure showing how nowcasting,
forecasting and forenowcasting are performed.

8

3.2

Statistical Model

As already stated in Section 2, the cumulative numbers of registered COVID19 infections are, other than by registration date, also stratified by district,
age group and gender. To accommodate this additional information, we
extend the notation from above and define with Nt,d,r,g the number of newly
registered infections on day t in region/district r and gender and age group
g, reported by the RKI on day t+d (thus with delay d). Row-wise cumulated
numbers are defined through
Ct,d,r,g =

d
X

Nt,j,r,g

(1)

j=1

which represents the group- and district-specific cumulated number of cases
with registration date t and delay up to d. We define with z r the geocoordinates of district/region r and generally denote covariates with x, where
varying subscripts indicate dependence on either gender- and age group g,
region r, time point t or delay d.
We assume the counts Nt,d,r,g to follow a negative binomial distribution
with mean µt,d,r,g and variance µt,d,r,g + θµ2t,d,r,g , where θ > 0 and the limit
θ → 0 leads to a Poisson distribution. More specifically, we set
µt,d,r,g = exp{s1 (t) + s2 (z r ) + γd + xt,d α + xg β + xt ur +
+φ log(1 + Ct−1,d,r,g ) + δ log(1 + Ct,d−1,r,g ) + offsetr,g }

(2)

Here, s1 (t) is a global smooth time trend and s2 (z r ) is a smooth spatial effect
over the districts of Germany. The parameters γ d = (γ1 , . . . , γdmax ) capture
the delay effect for each delay d, while the parameters contained in α capture
effects related to time and delay, which in our case will be weekday effects.
Gender and age effects are included in β, and ur are unstructured regional
effects which will be subsequently specified in more detail. Coefficient φ
captures the time-related autoregressive (AR) component of the process, indicating the effect of cases from the same district and gender- and age group
which were reported on the previous day. Coefficient δ expresses the effect of
infections registered on the same day which were reported with delay up to
d − 1, or in other words a delay-related autoregressive component. Finally,
the offset is set to the logarithm of the regional population size in the different gender- and age-groups, enabling us to model the infection rate. The
9

offset defined this way also allows to incorporate the size of the susceptible
population in each region, showing that this type of modeling is practicable
at different stages of the pandemic. In this case, the population size would
need to be replaced by the number of susceptible in region r, incorporating the SIR (susceptible-infected-removed) model or other similar ones (see
e.g. Allen, 1994). This is not particularly relevant at the time point chosen
for the analysis, since the number of susceptible corresponds more or less
to the population size due to the small (and unknown) size of the immune
populations in each district.
The previously mentioned spatial effect is comprised of two components:
An overall smooth effect s2 (z r ) mirroring the fact that different parts of Germany are differently affected, and a region-specific component accounting for
infection rates that are particularly high or low in single districts with respect
to the neighbouring situation. To be more specific, s2 () is a smooth spatial
function of the geo-coordinates z r for region r, while the ur are unstructured region-specific effects, interacting with the time dependent covariates
xt . We put a normal prior on ur , i.e. we model ur = (ur0 , ur1 )> as random
effects, where ur0 is a general random intercept capturing the long-term level
(from t = 1, . . . , T ) of the epidemiological situation in the different districts,
while ur1 is a second random intercept estimated exclusively over the last k
days, expressing the short-term dynamics (within k days prior to t = T ) of
infections. In our analysis we set k = 7. For ur we assume the structure
iid

ur ∼ N (0, Σu )

(3)

for r = 1, . . . , 412, with the posterior variance matrix Σu being estimated
b r (i.e. the posterior mode) measure
from the data. The predicted values u
how much and in which direction the infection rate of each district deviates
from the global spatial structure, controlling for covariates and age- and
gender-specific population sizes.

3.3

Model Selection and Performance

Model (3.2) includes several components. In this section we aim at assessing
whether the inclusion of some of those components is beneficial in terms of
predictive performance, and to generally evaluate the overall performance of
the final model. We are specifically interested in seeing how the unstructured
random effects xt ur and the autoregressive components φ log(1 + Ct−1,d,r,g )
10

and δ log(1 + Ct,d−1,r,g ) impact predictive accuracy. To do so, we consider
the realized absolute prediction error with regards to nowcasts, forecasts and
forenowcasts, cumulated for each district over a period of seven days using
different model specifications, to compare performance over time through a
weekly rolling window approach. The specifics of how predictions are performed will be described in detail in Section 4.
(n)
Starting with nowcasting, let therefore YT,r denote the cumulated number
of registered infections in district r over k = 7 days prior to the day of analysis
at time T , that is
k X
X
(n)
YT,r =
CT −t,dmax ,r,g
t=1

g

with CT,dmax ,r,g defined as in (1). This corresponds to the sum of all num(n)
bers in the green square in Figure 1. Accordingly, we define with YbT,r the
corresponding prediction based on the fitted model as described above. For
forecasting, we modify the definition and look at the cumulated number of
cases
k dX
max X
X
(f )
NT +t−d,d,r,g
YT,r =
t=1 d=1

g

which corresponds to the red parallelogram in Figure 1. Again, the corre(f )
sponding predicted value is notated as YbT,r . Finally, for forenowcasting we
concentrate on the cumulated numbers in the blue square, and set
(f n)
YT,t

=

k X
X
t=1

CT +t−1,dmax ,r,g

g

(f n)
with matching prediction YbT,t based on the fitted model. With the notation just given, we can define the relative district specific prediction error
(standardized per 100, 000 inhabitants) simply as
(·)

(·)
RPET,r

(·)

YT,r − YbT,r
= 100, 000
popr

where popr is the population size in district r, and the dot refers to nowcasting, forecasting or forenowcasting, respectively. It should be clear that,
setting k = dmax = 7, the numbers defined above are only observable on day
T + 7 for nowcasting and forecasting and on day T + 14 for forenowcasting.
11

To obtain a measure of the overall predictive performance of the model
for a certain fitting date T , we take the mean of RPET,r in absolute value
over all districts, which we call Mean Absolute Relative Prediction Error
(MARPE):
412
1 X
(·)
(·)
|RPET,r |
MARPET =
412 r=1
To have an idea of the average bias of predictions over time, we also plot the
Mean Relative Prediction Error (MRPE), which takes the mean of relative
errors without considering them in absolute value:
412

(·)
MRPET

1 X
(·)
=
RPET,r
412 r=1

This last measure will be positive if the model tends to underpredict on
average over the districts, and negative otherwise.
To evaluate the predictive accuracy of different model specifications, we
(·)
(·)
compute MARPET and MRPET over time by fitting the model weekly for
each of the considered specifications in a rolling window approach. In particular, we consider te following model variations:
• Full model as in (3.2);
• Model without the time-related autoregressive component, Ct−1,d,r,g .
• Model without the delay-related autoregressive component, Ct,d−1,r,g ;
• Model without the autoregressive components, Ct−1,d,r,g and Ct,d−1,r,g ;
• Model without the short-term district-specific random intercept, u2,r ;
• Model without the unstructured district-specific random effects ur ;
• Model without the short-term district-specific random intercept, u2,r
and the autoregressive components, Ct−1,d,r,g and Ct,d−1,r,g ;
• Model without the unstructured district-specific random effects ur and
the autoregressive components, Ct−1,d,r,g and Ct,d−1,r,g ;
Figure 2 plots the MARPE and the MRPE by model fitting date for
nowcasts, forecasts and forenowcasts, respectively. The plots already reveal
several aspects of the goodness of fit of our model. Looking at the MARPE
(top panel), we at first notice how the errors for nowcasts are, as expected,
12

Forenowcasts

80

80

80

60

60

60

40

40

20

20

0

0
Jun

Jul

Aug
Sep
Fitting Date

Oct

Nov

MARPE

100

May

Dec

40

20

0
May

Jun

Jul

Aug
Sep
Fitting Date

Oct

Nov

Dec

40

40

20

20

20

0

MRPE

40

MRPE

MRPE

Forecasts
100

MARPE

MARPE

Nowcasts
100

0

−20

−20

−40

−40

−40

Jun

Jul

Aug
Sep
Fitting Date

Oct

Nov

Dec

May

Jun

Jul

Aug
Sep
Fitting Date

Oct

Nov

Dec

Jun

Jul

Aug
Sep
Fitting Date

Oct

Nov

Dec

May

Jun

Jul

Aug
Sep
Fitting Date

Oct

Nov

Dec

0

−20

May

May

(·)

Figure 2: Mean Absolute Relative Prediction Error (MARPET,r , top panel)
(·)
and Mean Relative Prediction Error (MRPET,r , bottom panel) for all districts in Germany calculated over time for different model specifications, respectively for nowcasts (green), forecasts (red) and forenowcasts (blue). The
thicker line indicates the selected model, which corresponds to the full model
with the exclusion of the time-related AR component, Ct−1,d,r,g .
much smaller than for forecasts and forenowcasts. Secondly, we can see how
prediction errors are remarkably small for the first five months of model
fitting. Those months coincide with the late spring and summer months,
during which the infection numbers were relatively stable and under control
in Germany. Our model was thus able to capture most of the variability in
the process, resulting in precise predictions not only for nowcasts, but also for
forecasts and forenowcasts. Finally, we notice how there is a large increase
in MARPE for all fitted models starting from October, which coincides with
the beginning of the second wave of COVID-19 in Germany. This is due to
the fact that in that period infection dynamics changed and the numbers got
much larger, thus also leading to an increase in prediction errors. The model
variant that performed the best during this later period is the full model
with the exclusion of the time-related autoregressive component Ct−1,d,r,g ,
highlighted with a thicker line. The plots for the MRPE (bottom panel)
confirm this fact and help explaining the reasons behind it. For both forecasts
and forenowcasts, we see how at the very beginning of the second wave all
13

models tend to underpredict, while they overpredict from November onward.
The chosen model without the AR component is actually the most biased one
towards the downside in October (even though it is not performing worse than
the others in terms of MARPE), while it then becomes by far the least biased
towards the upside in later months. This is beacuse infection numbers grew
very fast in October, and models including the autoregressive component
were better able to capture the quick increase. In contrast though, after
new infections somewhat stabilized, the models including the autoregressive
component were still projecting the increase of past months on new ones,
causing large overestimation. The chosen model is instead more conservative
in its predictions, resulting in better overall predictive performance.

4

Applied Surveillance

Given that what we propose is a monitoring tool, the results change over time.
We here give an exemplary snapshot of the estimates and how predictions can
be obtained using Tuesday, September 15, 2020 as date of the analysis. As
an additional remark, note that our analysis is completely reproducible for
different dates as well, with code and data openly available and downloadable
from our GitHub repository4 .

4.1

Model-Based Monitoring

In addition to proper predictions (nowcasts, forecasts and forenowcasts),
which will be shown in the next section, our model also fits smooth components over time and space, which are visualized in Figure 3. The left hand
side shows the estimated infection rate over time for the three weeks prior
to September 15, 2020. We notice how the rate of registered infections has
been dropping until the end of August, while in the following weeks numbers started rising again, leading to an inversion and a steady increase in the
smooth spline. The map on the right hand side depicts the smooth spatial effect estimated as a function of longitude and latitude, on the log scale. From
the plot we can see how, at the time of the analysis, the regions of Bavaria
and Baden-Württemberg in the south of Germany were generally the most
affected. We also observe that the west was also, on average, more affected
than the east.
4

https://github.com/gdenicola/Now-and-Forecasting-COVID-19-Infections

14

The two maps in Figure 4 show further spatial components of the model,
namely the district-specific random intercepts. Those reflect the situation in
single districts controlling for the previously shown smooth spatial effect, that
is, in comparison to the average of the neighboring areas. More specifically,
the map on the left displays the overall district-specific long-range random
intercept, depicting the relative infection situations in the 21 days prior to
the day of analysis, while the map on the right hand side shows the additional
short-term random intercept which enters the linear predictor only over the
last 7 days, giving an idea of the more recent infection dynamics. We can thus
see that, for example, the district of Weimarer Land in the region of Thuringia
has had the most rapidly evolving number of cases in the 7 days prior to the
day of analysis controlling for the situation in its surroundings, reflecting
the outbreak that happened in the region during the analyzed period. This
second map can already be regarded as a first way of monitoring infection
dynamics at a local level, preliminary to looking at the predicted numbers:
If a district has a very high short term random effect, it probably means that
something is going on there that deserves further consideration.

4.2

Predictions

As previously explained, our model can be used to directly nowcast (correct
reports from previous days for delay), forecast (predict the number of cases
reported in the next days) and forenowcast (predict the number of infections
that will be registered for the next days). The obtained predictions can be
used to get a picture of how the pandemic is going to unfold in the short
term. In the following, we explain how we obtain those predictions from our
model.
Nowcasting: In our case, nowcasting is equivalent to filling all NA (missing) entries of the matrix in Table 2, turning the trapezoid shape of the data
into a full rectangle. This is also equivalent to completing the green square
in Figure 1. Given that we model delay d as a stand-alone variable in our
generalized additive model, we are able to simply predict the missing cells
directly by setting the delay d to the necessary value in the data vector used
for predictions alongside all other covariates. We can thus nowcast infections
for each delay, day, district, gender and age group. The predictions are,
depending on the model variant used, also dependent on the autoregressive
terms Ct−1,d,r,g and Ct,d−1,r,g . These are, except when predicting the first
15

s^1(t)

0.2

0.0

08

−2
08 5
−2
08 6
−2
08 7
−2
08 8
−2
08 9
−3
08 0
−3
09 1
−0
09 1
−0
09 2
−0
09 3
−0
09 4
−0
09 5
−0
09 6
−0
09 7
−0
09 8
−0
09 9
−1
09 0
−1
09 1
−1
09 2
−1
09 3
−1
4

−0.2

Registration Date

Figure 3: Estimated smooth effects s1 (t) and s2 (z r ), respectively the fitted
smooth effect of time and the fitted smooth spatial effect for the prevalence of
COVID-19 infections in Germany (measured on the log scale). Both effects
are estimated over the 21 days prior to September 15, 2020.

Figure 4: Region specific level (left) and dynamics (right) of COVID-19
infections, controlling for the smooth spatial effect on the right hand side of
Figure 3.
16

diagonal of the red parallelogram in Figure 1, not yet known at the day of
analysis. We therefore perform the prediction of the black crosses in Figure
1 iteratively, by utilizing the predictions of the previous diagonal as the autoregressive components. Based on the model, we can also take uncertainty
into account by simulating data from a negative binomial distribution with
the corresponding mean and variance structure. More precisely, we apply
the same strategy as above, but instead of using the mean value we now
plug counts simulated from the model into the autoregressive components,
and repeat this procedure n = 1000 times. This parametric bootstrap approach easily allows us to compute lower and upper bounds of the prediction
intervals.
Forecasting: The model also allows to directly predict cases for future
dates. With T denoting the time point of data analysis, we can obtain
predictions for the number of reported cases on days T, T + 1, . . . T + k −
1. Let us start with the predictions for the reported cases on the day of
analysis, i.e. time T . Referring once again to the guillotine blade structure
in Table 2, we proceed as follows: For d = 1, i.e. at the leftmost point of
the blade, we take the fitted mean values as prediction, while keeping the
smooth function of time constant, that is, setting s(t + 1) ≡ s(t) for the
sake of stability. For the remaining dmax − 1 elements of the blade edge
we take the mean value by setting d = d + 1. To get predictions for the
numbers of infections reported on days T + 1, . . . T + k − 1 we can then
proceed in an analogous way, using the values just predicted to update the
autoregressive components (Ct−1,d,r,g and Ct,d−1,r,g ). Figure 1 visualizes the
strategy, with cumulated predictions for the number of cases reported on
days T, T + 1, . . . T + 6 being represented by the red parallelogram. Similarly
as we did for the nowcasting, we can take uncertainty into account through
simulations, sampling from a negative-binomial model with the estimated
group-specific mean and variance structure.
Forenowcasting: While the previously described forecasts (i.e. predictions by reporting date) are useful to have an idea of the numbers that will
be published over time, what really gives a more up-to-date picture of the
ongoing situation are infection numbers based on registration (rather than reporting) date. It is possible to combine forecasting and nowcasting to predict
cases by registration date, thus setting the real number of infections being
17

discovered during a specific set of dates as target variable. This process, that
we call forenowcasting, is equivalent to filling the blue square on the bottom
of Figure 1. This is done by computing forecasts as described in the previous
subsection, and then performing nowcasting on the forecasted numbers. We
also obtain uncertainty estimates in an analogous way as for forecasts and
nowcasts.

4.3

Retrospective Surveillance

It is also possible to utilize the proposed model as a surveillance tool retrospectively. After a certain period of time has passed from the day of analysis,
we are able to compare predictions with infections observed in the corresponding period. If the predictions are aggregated on a weekly basis and we
keep the maximum delay set as dmax = 7, the waiting time to observe realized
infection numbers will be equal to seven days for nowcasts and forecasts and
fourteen days for forenowcasts. Figure 5 shows predictions of all three kinds
and corresponding infections observed a posteriori for two exemplary days
of analysis, namely September 15 (left hand panel) and November 11, 2020
(right hand panel).
From the plots we can observe how nowcasts tend to be, in general, quite
precise, as already seen from Figure 2. We can also immediately notice how
performance is very different for the two dates, especially for forecasts and
forenowcasts: We see that the predictions for September 15th are relatively
precise and unbiased, while for November 11th we observe quite a strong
tendency towards overprediction. This is because, while the first date belongs to a period in which the pandemic was relatively stable in Germany,
the second one lies in the heart of the second wave. The latter was immediately successive to the sudden increase in new infections in October and to
the consequent implementation of social distancing measures, the so-called
“lockdown light”, from the beginning of November. However, our model does
not include anything regarding exogenous governmental interventions and
general changes in population behavior. This means that the predictions are
to be interpreted assuming that everything else stays the same as in the three
weeks used to fit the model, leading to overprediction for areas in which measures are indeed imposed, and possibly underpredictions after those measures
are softened or lifted. While this is certainly a limitation of our approach,
it can on the other hand also be seen as a feature of the model, which in a
sense provides potential future "counterfactual" scenarios in which no action
18

90

Finally observed vs. nowcasted cases
for registration dates from 2020−11−04 to 2020−11−10

Nowcasted cases per 100 000 inhabitants

Nowcasted cases per 100 000 inhabitants

Finally observed vs. nowcasted cases
for registration dates from 2020−09−08 to 2020−09−14

Kaufbeuren

Würzburg

60

30

0

500

Erzgebirgskreis

Traunstein

400

300

200

100

0
0

30

60

90

0

100

200

300

400

500

Finally observed cases per 100 000 inhabitants

Finally observed cases per 100 000 inhabitants

Finally observed vs. forecasted cases
for reporting dates from 2020−09−15 to 2020−09−21

Finally observed vs. forecasted cases
for reporting dates from 2020−11−11 to 2020−11−17

Forecasted cases per 100 000 inhabitants

Forecasted cases per 100 000 inhabitants

150

Kaufbeuren

100

Würzburg
50

Cloppenburg

0

1500

Erzgebirgskreis

1000

Görlitz

500

0
0

50

100

150

0

500

1000

1500

Finally observed cases per 100 000 inhabitants

Finally observed cases per 100 000 inhabitants

Finally observed vs. forenowcasted cases
for registration dates from 2020−09−15 to 2020−09−21

Finally observed vs. forenowcasted cases
for registration dates from 2020−11−11 to 2020−11−17
Forenowcasted cases per 100 000 inhabitants

Forenowcasted cases per 100 000 inhabitants

150

Kaufbeuren

100

Würzburg
50

Cloppenburg

0

1500

Erzgebirgskreis
1000

Görlitz

500

0
0

50

100

150

0

Finally observed cases per 100 000 inhabitants

500

1000

1500

Finally observed cases per 100 000 inhabitants

Figure 5: Nowcasts (top), forecasts (middle) and forenowcasts (bottom) of
cumulated infections over a week, cumulated by district, plotted against values observed a posteriori. The model is fitted with data available on the
dates September 15, 2020 (left) and November 11, 2020 (right). Vertical
lines represent prediction intervals computed at the 90% level.
19

was taken by decision makers. This can thus be used to try to quantify the
effect of social distancing policies and interventions, in specific districts as
well as at a broader level.
This also applies in the case of sudden outbreaks: If, in a specific district, a rapid spike in cases is observed which was not yet known to health
authorities at the time of the analysis, the model will naturally underpredict
infection numbers in that district. Severe underpredictions observed a posteriori can also be used as an indicator for “true” outbreaks, revealing if they
were explainable by past data or not. This “counterfactual” use of our model
can thus be seen as an additional feature, which becomes available in retrospect, to measure the effect of NPIs (Non-Pharmaceutical Interventions) and
to assess the nature of outbreaks.

5

Discussion

We proposed a numerically stable tool to nowcast and forecast COVID-19
cases reported with delay. This allows to perform surveillance by gender
and age group at the regional level, providing an up-to-date and detailed
picture of the pandemic, as well as giving insight in the dynamics of the
near future. Our model can be used for computing inherently dynamic index
measures, such as the 7-days incidence, both at the regional and national
level, and it can also aid governments in the implementation of more targeted
area- and population-specific containment strategies. However, as previously
mentioned, this approach does not come without limitations, which we also
want to address.
The number of detected cases greatly depends on local testing strategies
and capacities. This implies that comparisons between different states or regions are not straightforward. As our model makes use of reported infections,
direct comparisons should be limited to areas for which it is reasonable to
assume that testing has been carried out in a similar manner.
Another important thing to note is that our model only addresses the
delay in reporting from local to national health authorities, and not the time
that occurs between each test and its (positive) result. This would be useful
for our application as it would give an even more up-to date picture of the
current situation, but it is not pursued due to a lack of data.
An eminent limitation of our approach is the inability to capture new outbreaks related to specific phenomena that are not yet known to the health
20

authorities. An example of this would be the outbreaks in slaughterhouses
which happened during the summer in Coesfeld and Gütersloh, North-RhineWestphalia. After all, of course, the model predicts future infections with
data from the past, and is not clairvoyant. As previously discussed, severe
underpredictions observed a posteriori can also be used in retrospect as an
indicator for outbreaks that are localized and not explainable by past data,
while overpredictions can signal and quantify the effectiveness of social distancing measures.
Taking into account the previously mentioned limitations, the model is
able to capture a good chunk of the variability that is present. The methodology that we employed is quite general, and, if suitable data is available, can
easily be adapted to other countries as well. Moreover, we only employed
standard tools for software implementation, and this makes adapting and enriching the model, e.g. with more covariates, relatively straightforward. We
here did not include more covariates which would be available for the special
case of Germany (e.g. district-wise deprivation indexes, see Maier, 2017), because we want our modeling exercise to be flexible and easy to apply to any
country in which delays in reporting happen, with basic data being available.
Nonetheless, it would most certainly be fruitful, at least from a predictive accuracy perspective, to include more covariates which are available for specific
cases in the model.
We complete our discussion by emphasizing that the proposed methodology is flexible and applicable to any data constellation in which reporting
delay plays a role. In other words, one can easily adopt the proposed model
to any guillotine blade-like data structures, i.e. data where ti denotes the
time point of an event and di the delay with which the event is reported.
Moreover, our approach can not only be applied to correct for the delay between registration of an event and its reporting, but also, for example, to
bridge the delay between disease onset and registration of its positive test
result. Data in guillotine blade-like form also occur in areas beyond epidemiology, e.g. when cases of unemployment are reported from regional offices to a
central state register. The generality of the data structure supports the proposed modeling approach, where corrections for the missing data structure
are directly incorporated in the model. In particular, however, the modeling
exercise exhibits promising performance for COVID-19 infections, and may
therefore be incorporated into a general surveillance tool to assist health
authorities and policymakers in their efforts to contain the spread.
21

References
Allen, L. J. (1994). Some discrete-time SI, SIR, and SIS epidemic models.
Mathematical Biosciences 124 (1), 83 – 105.
Anastassopoulou, C., L. Russo, A. Tsakris, and C. Siettos (2020). Databased analysis, modelling and forecasting of the COVID-19 outbreak. PLoS
ONE 15(3).
Cintra, P., M. Citeli, and F. Fontinele (2020). Mathematical models for
describing and predicting the COVID-19 pandemic crisis. arXiv preprint
arXiv:2006.02507 .
Dehesh, T., H. Mardani-Fard, and P. Dehesh (2020). Forecasting of covid-19
confirmed cases in different countries with arima models. MedRxiv .
Dowd, J. B., L. Andriano, D. M. Brazel, V. Rotondi, P. Block, X. Ding,
Y. Liu, and M. C. Mills (2020). Demographic science aids in understanding the spread and fatality rates of covid-19. Proceedings of the National
Academy of Sciences 117 (18), 9696–9698.
Flaxman, S., S. Mishra, A. Gandy, H. J. T. Unwin, T. A. Mellan, H. Coupland, C. Whittaker, H. Zhu, T. Berah, J. W. Eaton, et al. (2020). Estimating the effects of non-pharmaceutical interventions on COVID-19 in
Europe. Nature 584 (7820), 257–261.
Fritz, C., E. Dorigatti, and D. Rügamer (2021). Combining Graph Neural
Networks and Spatio-temporal Disease Models to Predict COVID-19 Cases
in Germany. arXiv preprint arXiv:2101.00661 .
Gatto, M., E. Bertuzzo, L. Mari, S. Miccoli, L. Carraro, R. Casagrandi, and
A. Rinaldo (2020). Spread and dynamics of the COVID-19 epidemic in
Italy: Effects of emergency containment measures. 117 (19), 10484–10491.
Held, L., S. Meyer, and J. Bracher (2017). Probabilistic forecasting in infectious disease epidemiology: The 13th Armitage lecture. Statistics in
medicine 36.
Li, R., S. Pei, B. Chen, Y. Song, T. Zhang, W. Yang, and J. Shaman (2020).
Substantial undocumented infection facilitates the rapid dissemination of
novel coronavirus (SARS-CoV-2). Science 368 (6490), 489–493.
22

Maier, W. (2017). Indices of Multiple Deprivation for the analysis of regional health disparities in Germany : Experiences from epidemiology and
healthcare research. 60 (12).
Panovska-Griffiths, J. (2020). Can mathematical modelling solve the current
Covid-19 crisis? BMC Public Health 20:551.
Petropoulos, F. and S. Makridakis (2020). Forecasting the novel coronavirus
COVID-19. PLoS ONE 15.
Ray, E. L., N. Wattanachit, J. Niemi, A. H. Kanji, K. House, E. Y. Cramer,
J. Bracher, et al. (2020). Ensemble Forecasts of Coronavirus Disease 2019
(COVID-19) in the U.S.
Roux, J., C. Massonnaud, and P. Crépey (2020). COVID-19: One-month
impact of the French lockdown on the epidemic burden. medRxiv .
Stübinger, J. and L. Schneider (2020). Epidemiology of Coronavirus COVID19: Forecasting the Future Incidence in Different Countries. Healthcare 8(2)(99).
Wood, S. N. (2017). Generalized additive models: an introduction with R.
CRC press.

23

