Stochastic sampling effects favor manual over digital contact tracing
Marco Mancastroppa,1, 2 Claudio Castellano,3 Alessandro Vezzani,4, 1 and Raffaella Burioni1, 2
1

arXiv:2010.03399v1 [physics.soc-ph] 7 Oct 2020

Dipartimento di Scienze Matematiche, Fisiche e Informatiche,
Università degli Studi di Parma, Parco Area delle Scienze, 7/A 43124 Parma, Italy
2
INFN, Sezione di Milano Bicocca, Gruppo Collegato di Parma,
Parco Area delle Scienze, 7/A 43124 Parma, Italy
3
Istituto dei Sistemi Complessi (ISC-CNR), Via dei Taurini 19, I-00185 Roma, Italy
4
Istituto dei Materiali per l’Elettronica ed il Magnetismo (IMEM-CNR),
Parco Area delle Scienze, 37/A-43124 Parma, Italy
(Dated: October 8, 2020)
Isolation of symptomatic individuals, together with tracing and testing of their nonsymptomatic
contacts, is a fundamental strategy for mitigating the current COVID-19 pandemic before pharmaceutical interventions become available. The breaking of contagion chains relies on two main alternative strategies: manual reconstruction of contacts based on interviews or a digital (app-based)
privacy-preserving contact tracing protocol. We compare in the same framework the effectiveness of
the two strategies within the activity-driven model, a general empirically validated framework for
network dynamics. Using model parameters tailored to describe SARS-CoV-2 diffusion, we show
that even when the probability for a contact to be traced is the same, manual contact tracing robustly performs better than the digital protocol in increasing the epidemic threshold, limiting the
height of the epidemic peaks and reducing the number of isolated individuals. This remains true
even taking into account the intrinsic delay and limited scalability of the manual procedure. This
result is explained in terms of the stochastic sampling occurring during the case-by-case manual
reconstruction of contacts of infected individuals, contrasted with the intrinsically prearranged nature of digital tracing, determined by the decision to adopt the app or not of each individual. The
better performance of manual tracing is enhanced by the heterogeneous features of agent behavior:
a superspreader not adopting the app is completely invisible to digital contact tracing, while she
can be traced manually, due to her multiple contacts. Our results indicate a careful integration of
the two intrinsically different protocols as key to optimal mitigation strategies.
Keywords: Epidemics, Temporal networks, Contact tracing, Manual and digital contact tracing, COVID-19

The current COVID-19 pandemic is impacting daily
life worldwide at an unprecedented scale. Among the
features that have contributed to transform the emerging
diffusion of SARS-CoV-2 coronavirus into such a global
scale crisis, a prominent role is played by the high rates
of virus transmission mediated by presymptomatic and
asymptomatic individuals [1–6]. Given the absence of effective pharmaceutical interventions, this feature makes
the mitigation of the pandemic a highly nontrivial task,
that has been tackled with various strategies, none of
them devoid of drawbacks.
Initially, governments resorted to very restrictive limitations of non strictly necessary activities (lock-downs) to
curb the diffusion of the infection. Such measures turned
out to be effective from an epidemiological point of view,
but exceedingly costly in other respects, for their economic and social consequences [7, 8]. Recently, such restrictive measures have been progressively lifted, and we
now rely on other tools to contain the pandemic: social
distancing, reinforced hygiene and the use of individual
protection devices. Along with these provisions, aimed
at preventing single virus transmission events, another
set of measures points at breaking contagion chains: the
isolation of infected individuals (symptomatic or found
via some testing), followed by the tracing of their contacts (contact tracing, CT), the testing of the latter and
the possible isolation of the infected [9–12].

This CT procedure has proven effective in the past
in various contexts [13–16] but it comes, in its standard
manual implementation, with important limitations [17].
It requires the set up of a physical infrastructure, needed
to find infected individuals, interview them and reconstruct their contacts in a temporal window, call these
contacts, convince them to get tested and eventually isolated. Apart from the evident problems of practical feasibility and economic cost, the manual CT procedure intrinsically implies a delay between the moment an individual is found infected (and isolated) and the time
her contacts are tested and possibly isolated. For an
epidemic such as COVID-19, characterized by a rather
long presymptomatic infectious stage and a high relevance of transmission by asymptomatics, the delay implied by manual CT risks to undermine the effectiveness
of the whole procedure.
For this reason the alternative strategy of a digital
CT procedure, based in particular on the installation of
apps on smartphones (app-based), has been proposed [2].
The rationale is that proximity sensors installed on these
ubiquitous devices allow the detection of contacts of epidemiological significance among individuals. When an
individual is found infected, the app permits to instantaneously trace all contacts in the recent past, thus allowing
for much quicker testing and isolation. A quantitative
comparison between manual and digital CT applied to

2
an epidemiological model describing COVID-19 diffusion
suggested that already a delay of the order of 3 days
completely spoils the ability of manual CT to prevent
the initial exponential growth of the epidemic [2]. The
conclusion was that only a digital CT avoiding this delay
could be a viable strategy to control the current epidemic.
The proposal for digital CT rapidly gained momentum,
leading to the development of technical solutions [18–20]
and to the deployment of app-based CT infrastuctures in
many countries [21].
Many works have scrutinized the actual validity of this
solution and investigated the possible shortcomings of
app-based CT, casting doubts over many of the assumptions underlying such strategy [22–24]: there are too few
modern enough smartphones; Bluetooth based proximity
measurements are unreliable; co-location is not always a
good proxy for epidemiological contact. The potential
risks for privacy breaches have also been exposed.
Other papers have tried to evaluate the impact of digital CT on the current COVID-19 epidemic, attempting
to precisely determine, by means of detailed data-driven
epidemiological models, to what extent such a strategy
is able to suppress virus diffusion [25–29]. A critical role
is played by the fraction f of individuals in a population
that actually use the app. Fairly high values of f (of
the order of 60%) are required for the digital CT protocol to lead to global protection [2, 9, 23]. These values
are in striking contrast with the low app adoption rates
observed so far in most countries [30–32].
In this paper we take a different approach. We compare the effectiveness of the two CT protocols in exactly
the same conditions, i.e., in the very same realistic epidemiological scenario, without making claims on their absolute performance. We consider a sensible epidemiological model incorporating all main ingredients of the current epidemic, with parameters tuned to values derived
from empirical observations about COVID-19 spreading.
Within this single framework we consider the impact of
both manual and digital CT strategies, working in similar
manner but with their own specific features: delayed isolation of contacts, limited scalability and imperfect recall
for the manual procedure; dependence on the predetermined app adoption decision for the digital CT.
The comparison reveals that even when the number of
reconstructed contacts is the same, manual CT performs
better than digital CT in practically all realistic cases.
The manual protocol is more efficient in increasing the
epidemic threshold (i.e., the value of the effective infection rate above which the infection spreads diffusely), in
limiting the height of the epidemic peaks and in reducing
the number of isolated individuals. This surprising result
is due to the stochastic annealed nature of the manual CT
procedure, in which each symptomatic node randomly recalls a fraction of her contacts, in contrast with the digital CT where the traced nodes belong deterministically
to the prearranged quenched fraction of the population
adopting the app. In the latter case, the individuals not
adopting the app can never be reached by the CT proto-

col, while the entire population is potentially detectable
through the stochastic sampling of the manual procedure.
The better performance of manual CT is already evident
in homogeneous populations and it is strongly enhanced
in the presence of a heterogeneous distribution of contacts. Superspreaders not adopting the app are invisible
to the digital tracing while they are very likely to be detected by a manual tracing originating from one of their
many contacts.

I.
A.

RESULTS

Epidemic spreading on heterogeneous
dynamical networks

We consider an activity-driven network model with attractiveness, taking into account both the temporal dynamics of social contacts and the heterogeneity in the
propensity to establish social ties [33–35]. Each susceptible node S is assigned with an activity aS and an attractiveness parameter bS , drawn from the joint distribution
ρ(aS , bS ): the activation rate aS describes the Poissonian activation dynamics of the node; the attractiveness
bS sets the probability pbS ∝ bS for a node to be contacted by an active agent. At the beginning all nodes
are disconnected and when a node activates it creates m
links with m randomly selected nodes (hereafter we set
m = 1); then all links are destroyed and the procedure
is iterated. The functional form of ρ(aS , bS ) encodes the
correlations between activity and attractiveness in a population with a given distribution of activity. It has been
observed that several social systems feature positive correlations between activity and attractiveness and a broad
power-law distribution of activity [33–37]:
−(ν+1)

ρS (aS , bS ) ∼ aS

δ(bS − aS )

(1)

with ν typically ranging between 0.5 and 2.
On top of the activity-driven dynamics, we consider a
compartmental epidemic model which includes the main
phases of clinical progression of the SARS-CoV-2 infection [6, 38–40], also applicable to other infectious diseases with asymptomatic and presymptomatic transmission. The model is composed by five compartments:
S susceptible, P presymptomatic, A infected asymptomatic, I infected symptomatic, R recovered. A contagion process (see Fig. 1(a)) occurs with probability λ
when a link is established between an infected (either P ,
A and I) and a susceptible node S (contact-driven transition): a node has probability δ to become presymptomatic after infection and probability (1 − δ) to beλδ

λ(1−δ)

come asymptomatic, thus S −→ P and S −−−−→ A. A
presymptomatic node spontaneously develops symptoms
with rate γP = 1/τP , thus with a Poissonian process
γP
P −−→ I; both asymptomatic and symptomatic nodes
spontaneously recover respectively with rate µ = 1/τ and

3

b)

2.4
2.2
2
1.8
1.6
1.4
1.2
1

0

20

40

60

80

100

FIG. 1: Epidemic model without CT. In panel (a) we
represent, the compartmental epidemic model without CT.
In panel (b) we plot, as a function of γP /µ, the ratio between
SY M P T O
when symptomatic nodes
the epidemic threshold rC
are isolated and the epidemic threshold of the non-adaptive
NA
. The horizontal dashed orange line indicates the
case rC
NA
SY M P T O
for γP = ∞ (instantaneous onset of
/rC
value of rC
symptoms). The vertical red dash-dotted line indicates the
value of γP /µ we consider in the rest of the paper. We set
ρ(aS , bS ) = ρS (aS )δ(bS − aS ). The curve does not depend on
the specific form of ρS (aS ).

rC is an indicator of the effectiveness of mitigation strategies. Within the adaptive activity-driven framework, the
epidemic threshold can be calculated analytically via a
mean-field approach (see Materials and Methods).
The effect of isolating symptomatic nodes as the only
containment measure is shown in Fig. 1(b). We compare
the epidemic threshold rC , obtained with the isolation
of symptomatic nodes only, with the epidemic threshold
NA
rC
of the non-adaptive (NA) case, in which no containment measures are taken on infected individuals, as a
function of γP /µ (see Materials and Methods for the explicit expression). In the case of instantaneous symptoms
development (γP /µ → ∞), the threshold is increased by
a factor of 1/(1 − δ), while for smaller γP /µ the gain
is reduced. For example, for (1 − δ) = 0.43, that is
43% of asymptomatic individuals, τP = 1.5 days and
τ = 14 days as observed for SARS-CoV-2 (see Materials and Methods for details on the parameters used in
all figures), the threshold is doubled by the isolation of
symptomatic nodes. This is the baseline reference for the
evaluation of the performance of CT strategies.

B.

Manual and digital contact tracing protocols

The CT protocols differ in their practical implementation as well in their exploration properties.

1.

with rate µI = µγP /(γP − µ), so that the average infectious period for both symptomatic and asymptomatic is
τ . We neglect states of hospitalization and exposure and
consider recovery without death: this choice does not affect the infection dynamics.
Adaptive behavior of populations exposed to epidemics can be modelled within the activity-driven network framework: infected nodes experience a reduction in activity, due to isolation or the appearance of
symptoms; similarly, other individuals undertake selfprotective behavior to reduce the probability of contact
with an infected node, and this is modelled as a reduction in the attractiveness of infected nodes [41–43].
We assume that symptomatic infected nodes I are immediately isolated (aI , bI ) = (0, 0), therefore not being able to infect anymore. On the contrary, we assume that recovered R, asymptomatic A and presymptomatic P individuals behave as when they were susceptible (aA , bA ) = (aP , bP ) = (aR , bR ) = (aS , bS ). The
adaptive behavior is implemented without affecting the
activity of nodes which are not isolated [42].
The control parameter r = λ/µ is the effective infection rate, whose critical value rC – the epidemic threshold
– sets the transition point between the absorbing and the
active phase of the epidemic. The increase in the value of

Manual CT

Manual tracing is performed by personnel who,
through interviews, collects information, contacts individuals who may have been infected and arranges for
testing. In manual CT, as soon as an individual develops symptoms (i.e. P → I), her contacts in the previous
TCT days are traced with recall probability ε(a), where
a is the activity of the symptomatic individual. A traced
contact is tested and, if found in state A (infected asymptomatic), isolated (a = b = 0): the average time between
the isolation of the symptomatic individual and the isolation of her asymptomatic infected contacts is τC . Such
delay can be quite large, due to the time required for
the collection of the diary, the execution of the diagnostic test and the subsequent isolation [2, 17]. Moreover,
the manual protocol depends on ε(a), which takes into
account the limited resources allocated for tracing and
the limited memory/knowledge of symptomatic individuals in reconstructing their contacts. Low activity nodes
make few contacts over time and a fraction of their contacts will be traced; on the other hand high activity nodes
will only remember a finite number of their contacts so
that, also because of limitations of the tracing capacity,
we expect that at most a number kc of contacts can be
traced [44, 45]. This translates into the limited scalability
property:

4
a)

a probability f to download the app before the epidemic
starts. As soon as an individual develops symptoms (i.e.
P → I), if she downloaded the app, her contacts are
traced only if they downloaded the app as well. A traced
contact is tested and, if found in state A (infected asymptomatic), is isolated, a = b = 0. The time passing between the isolation of a symptomatic individual and the
isolation of her asymptomatic infected contacts is taken
to be 0, thus assuming an idealized scenario of instantaneous notification and isolation. See Materials and
Methods for details on the implementation of the CT
protocols.

7
1.2

6
1.1

5
1

0

0.5

1

4

3

2

Manual CT
App-based CT

0

0.2

0.4

0.6

0.8

1

C.

FIG. 2: Stochastic vs. prearranged sampling in CT. In
panel (a) we plot, as a function of ε = f 2 , the ratio between
the epidemic threshold rC in the presence of CT protocols and
NA
. In the
the epidemic threshold of the non-adaptive case rC
inset we plot the ratio between the epidemic threshold of the
AP P
M AN U AL
,
and that of the app-based CT rC
manual CT rC
as a function of ε = f 2 . We consider homogeneous activity
and attractiveness, setting ρ(aS , bS ) = δ(aS − a)δ(bS − b).
Panel (b) shows that if an asymptomatic node A infects a
single susceptible node S (which subsequently becomes symptomatic, I), the infector is traced with probability ε in the
manual CT and with probability f 2 in the digital CT. Thus
the probability is the same if we impose f 2 = ε. However, if
an asymptomatic node infects two susceptible nodes (which
subsequently become symptomatic), the probability of tracing
the infector with the manual protocol is 1−(1−ε)2 = 2f 2 −f 4
(still considering ε = f 2 ), that is always larger than that of
the digital protocol f (1 − (1 − f 2 )) = 2f 2 − f 3 .

(
ε∗ ,
ε(aS ) =
∗
ε∗ aaS =

if aS ≤ a∗
kc
∗
2TCT aS , if aS > a

(2)

where a∗ = kc /2TCT ε∗ .
2.

Stochastic vs. prearranged sampling

We first compare the two CT protocols in the case of
a population with homogeneous activity and attractiveness, ρ(aS , bS ) = δ(aS −a)δ(bS −b), without delay even in
manual CT, i.e., τC = 0. We set ε = f 2 so that the probability that a single contact is traced in the two protocols is
the same. However, it should be emphasized that typical
values of f 2 range between 0.01 and 0.1 in many countries [30–32], while ε is usually larger (≈ 0.5), since typically more than half of contacts occur at home, at work
or at school and thus are easily traceable [46]. An exact
analytical estimate of the epidemic threshold is obtained
through a linear stability analysis around the absorbing state (see Materials and Methods for explicit expressions): in Fig. 2(a) we compare the threshold for manual
and app-based CT, compared to the non-adaptive case
(NA), for realistic COVID-19 parameters. Both protocols feature the same epidemic threshold when ε = f = 0
and ε = f = 1: indeed the former corresponds to the
isolation of symptomatic individuals only, without CT,
while the latter limit corresponds to the case in which all
contacts are traced. For intermediates values of ε = f 2 ,
manual tracing is strongly and surprisingly more effective than digital tracing, as it increases significantly the
epidemic threshold, compared to the app-based protocol. Since we are considering no heterogeneity or delays,
the difference is due only to sampling effects in the CT
dynamics. In practice, in app-based CT the population
to be tested is prearranged, based on whether or not the
app was downloaded before the outbreak started. On the
contrary, manual CT performs a stochastic sampling of
the population: the random exploration can potentially
reach the entire population, since anyone who has come
in contact with a symptomatic node can be traced. The
simplest example of the difference in tracing multiple infections processes in the two protocols is illustrated in
Fig. 2(b).

App-based CT
D.

Digital CT is based on the download of an app which
allows the tracing of close contacts equipped with the
same app. We assume that each of the individuals has

Effects of heterogeneous activity

We now consider a heterogeneous activity distribution,
as observed in several human systems, and we consider

5
a)

b)

7

6.5
6

1.6

Manual CT
App-based CT
w/o CT

5
4

1

3.5

1.4

5

1

1.2

2

4

6

4
3

2.5

2.5

2

2
1.5

2

2.5

3

3.5

4

4.5

0.5

1

5
4

Manual CT
App-based CT
w/o CT

5

0.5

1

1.5

2

2.5

3

3.5

4

4.5

Manual CT
App-based CT

3
2

1

0

3.5

3

0.5

1.4

7 1.2

4.5
4

=1
=1.5
=3
=5

1.6

6

2

9
8

5.5

1.2

4.5

1.6

6.5

1.4

5.5

c)

7

5

0

0.2

0.4

0.6

0.8

1

FIG. 3: Effects of heterogeneity. In panels (a) and (b) we plot, as a function of the exponent ν, the ratio between the
NA
epidemic threshold rC in the presence of CT protocols and the epidemic threshold of the non-adaptive case rC
. In the inset we
M AN U AL
AP P
plot the ratio between the epidemic threshold of the manual CT rC
and that of the app-based CT rC
, as a function
NA
of ν. In panel (a) ε = f 2 = 0.1 (f ≈ 0.316), in panel (b) ε = f 2 = 0.6 (f ≈ 0.775). In panel (c) we plot the ratio rC /rC
as a
2
M AN U AL
AP P
function of ε = f for both CT protocols, with ν = 1.5. In the inset we plot the ratio rC
/rC
as a function of ε = f 2
for several ν values. In all panels the distribution ρS (aS , bS ) is given by Eq. (1).

a positive activity-attractiveness correlation, as defined
in Eq. (1) [33–37]. The power-law distribution for the
activity implies the presence of hubs with high activity
and high attractiveness. We investigate the pure effect
of heterogeneities in contact tracing [12, 27] setting now
ε(aS ) = ε, ∀aS and not considering delays in manual CT,
τC = 0. We perform again a mean-field approach, obtaining an analytical closed form for the epidemic threshold
(see Materials and Methods and Supplementary Information, SI): in Fig. 3 we compare the epidemic threshold
with the two protocols as a function of the exponent ν of
the activity distribution, for realistic parameters and setting an average activity aS = 6.7 days−1 [41, 46]. Both
protocols are more effective in heterogeneous populations
ν ∼ 1 − 1.5. However heterogeneity greatly amplifies
stochastic effects, further increasing the advantage of the
manual tracing over the app-based prearranged protocol.
Indeed, in heterogeneous populations nodes with high activity and attractiveness (super-spreaders) drive and sustain the spread of the epidemic. Manual CT is far more
effective in identifying and isolating them than app-based
CT: in digital CT, hubs which have not downloaded the
app will never be traced, despite the high number of their
contacts. On the contrary, manual CT is very effective
in tracing super-spreaders, because they are engaged in
many contacts and are traced very effectively by stochastic exploration.

E.

Limited scalability and delay in manual contact
tracing

We now consider some features of manual CT that
can reduce its effectiveness: the limited scalability of the
tracing capacity [44, 45] and the delays in CT and isolation [2, 23, 28]. We set ε(aS ) as in Eq. (2) and consider

a large delay τC = 3 days [2] in manual CT. In Fig. 4 we
compare the epidemic threshold for the two CT protocols, setting equal the
R probabilities of tracing a contact
ε = f 2 , where ε = ε(aS )ρS (aS ). For small values of
ε (note that this however
corresponds to a quite large
√
adoption rate f = ε ≈ 0.316) manual CT is still more
effective (see Fig. 4(a)): the delay in isolation and the
limited scalability are not able to significantly reduce the
advantage provided by the stochastic exploration of contacts. Fig. 4(b) shows that digital CT can become more
effective than manual CT, but this occurs only for very
large values of f 2 and τC . This indicates that for realistic settings, the advantage of the manual protocol over
the app-based protocol is robust even including delays
and limited scalability. Fig. 4(c) further illustrates for
which (unrealistically large) values of f 2 and τC , digital
CT outperforms manual CT. Note that realistic values of
f correspond to f 2 at most of the order of 0.1. Hence, an
extremely high adoption of the app is necessary in order
to obtain an effective advantage of the digital CT.

F.

Effects of manual and app-based CT in the
epidemic phase

We now explore with numerical simulations (see Materials and Methods, SI) the effects of the CT protocols
in the active phase of the epidemic. We consider an optimistic value of f = 0.316, setting ε = f 2 = 0.1 that is a
very low value for the recall probability, and we consider
the system above the epidemic threshold r > rc , in the
conditions of Fig. 4(a). Fig. 5 shows that the infection
peak with manual tracing is lower than the app-based
one. Moreover, in the manual CT the duration of the
epidemic is reduced: this strongly impacts on the final
epidemic size, which is about half of the one observed in

6
a)

b)

3.2

1.3

7

1.5

Manual CT
App-based CT

1.2

3

c)

4.5

4

6

3.5

5

1
0

1.1

2.8

5

10

1
2

2.6

3

1

2

3

4

C

4

0.9

C
C

0.8

Manual CT
App-based CT

2.4

2.2

4

3

2.5

C

0.7

5

2

C

2

1

2

3

=1 d
=3 d
=5 d
=7 d

App CT

4

4

=0 d

2

5

0

0.2

0.4

0.6

0.8

1

FIG. 4: Effects of limited scalability and isolation delay in manual CT. In panels (a) and (b) we plot, as a function of
the exponent ν, the ratio between the epidemic threshold rC in the presence of CT protocols and the epidemic threshold of the
NA
non-adaptive case rC
, with limited scalability and delay in manual CT. In the insets we plot the ratio between the epidemic
M AN U AL
AP P
threshold of the manual CT rC
and that of the app-based CT rC
, as a function of ν. In panel (a) ε = f 2 = 0.1
2
NA
(f ≈ 0.316), τC = 3 days, while in panel (b) ε = f = 0.6 (f ≈ 0.775), τC = 5 days. In panel (c) we plot the ratio rC /rC
as a function of ε = f 2 for both CT protocols, setting ν = 1.5 and for several values of τC : in the inset we plot the ratio
AP P
M AN U AL
as a function of τC for several ε values. In all panels the distribution ρS (aS , bS ) is given by Eq. (1).
/rC
rC

the app-based CT. We also plot the temporal evolution of
the average activity of the system ha(t)i and of the fraction of isolated nodes Iso(t) (see inset). In general, the
average activity ha(t)i features a minimum, however its
value remains very large (about 98% of the case without
any tracing measure). This implies that both protocols
do not disrupt the functionality of the system. Interestingly, the fraction of isolated nodes is coherent with
the infection peak, and in particular it is lower when the
infection peak is lowered. This means that the most effective procedure, i.e. manual CT for realistic values of
the parameters, not only lowers the infection peak but it
is also able to isolate a smaller number of nodes, a key
feature of any effective CT strategy.

G.

Robustness

In the SI we show that the advantage of the manual CT
is robust with respect to the relaxation of many assumptions and to the change of parameters. In particular, we
consider the case where all nodes have equal attractiveness ρ(aS , bS ) = ρS (aS )δ(bS − b), we take into account
very strong delays τC and we change the maximum number of traceable contacts kc .

II.

6

10-3
10-3
1
1

5

0.995
0.5

0.99

4

0.985
0

3

0.98
0

100

200

2
Inf(t) Manual CT
R(t) Manual CT
Inf(t) App-based CT
R(t) App-based CT

1
0

50

100

150

200

FIG. 5: Effects of manual and digital CT on the epidemic active phase. We plot the temporal evolution of the
fraction of infected nodes Inf (t), i.e. infected asymptomatic
and infected symptomatic, and of the fraction of removed
nodes R(t), for both manual and digital CT. In the inset we
plot the temporal evolution of the fraction of isolated nodes
Iso(t) (right y-axis) and of the average activity of the population ha(t)i (left y-axis), normalized with aS . All curves
are averaged on several realizations of the disorder and of
the temporal evolution. We set ε = f 2 = 0.1, τC = 3 days,
NA
r/rC
= 3.1 and N = 5 103 . The distribution ρ(aS , bS ) is
given by Eq. (1), with ν = 1.5.

DISCUSSION AND CONCLUSIONS

Our results indicate that manual CT, despite its drawbacks, can be an efficient protocol in heterogeneous populations, more efficient than its digital counterpart, due
to its specific sampling properties. This conclusion is
robust with respect to variations in several model assumptions, including correlations between activity and

attractiveness or the limited scalability of the manual
CT protocol. However, epidemic propagation and strategies to mitigate it are very complex processes and several
of their features have been left out from our modelling
scheme. Many of them can be included straightforwardly,
at the price only of more complicated equations, that
can still be solved numerically. Some of these features

7
(the possibility that isolation is non complete, that some
individuals do not report symptoms or the existence of
testing campaigns detecting infected nonsymptomatic individuals) act similarly on both types of CT and hence
do not modify the relative performance. Other more realistic features (the presence of delays even in digital CT
and the existence of additional sources of heterogeneity
in viral shedding [47], recovery rates [48] and activity
temporal patterns [49]) would even reduce the relative
performance of digital CT.
Some effects neglected in the present analysis may in
principle improve the performance of digital versus manual CT. In particular, a positive correlation between activity aS and probability f of adopting the app would
positively influence the effectiveness of digital CT. This
is highly desirable and therefore should be pursued in
campaigns to drive app adoption. In general economic,
social and psychological factors may affect the choice to
use the app, so this represents a challenge for policy makers. Another effect that could enhance CT protocols is
following chains of transmissions along multiple steps. In
fact in present protocols when a traced contact is found
infected also her contacts are often reconstructed and
tested. This additional step improves the overall effectiveness of CT protocols, but also increases the delay
associated to the manual procedure with respect to the
digital one. Digital CT allows in principle to extend very
easily the tracing procedure to an arbitrary number of
steps, thus enhancing the ability to mitigate the spreading process. However, strong concerns, related to privacy
issues [50], make this path difficult to follow.
In summary, additional features in digital CT should
be proposed to counterbalance its intrinsic weakness,
originated by the nature of the sampling of contacts performed and worsened by unavoidable heterogeneities in
the epidemic spreading. This weakness can reduce the
effectiveness of the digital CT procedure, even for adoption rates much higher than the values currently observed. The manual CT protocol, with its higher intrinsic
stochasticity, does not suffer from this problem and samples contacts effectively, especially in realistic heterogeneous populations: thus, digital CT cannot be considered
simply as a cheaper and more rapid way of implementing
standard contact tracing. Manual CT must necessarily
play an important role in any strategy to mitigate the
current pandemic. Considerations about costs and practical feasibility of the two approaches (which have not
been taken into account here) suggest that a careful integration of the two protocols may be the key for more
effective mitigation strategies. In this respect, the availability of detailed data about the rates of app adoption
in various population groups (and correlations with age
or activity levels), as well as more precise estimates of
other parameters, such as the recall probability, would
be highly beneficial. The design of optimal hybrid (manual and digital) CT protocols, including decisions on how
to allocate resources and how to target recommendations
for app adoption, is a very promising direction for future

work.
III.
A.

MATERIALS AND METHODS

Mean-field equations and implementation of CT
protocols

We consider an activity-attractiveness based meanfield approach, dividing the population into classes of
nodes with the same activity aS and attractiveness bS
and treating them as if they were statistically equivalent. For each class (aS , bS ) we consider the probability
that at time t a node is in one of the epidemic compartments. For arbitrary ρ(aS , bS ) distribution and arbitrary functional form of f (aS ) and ε(aS ) we build the
mean-field equations which describe the temporal evolution of the network, the epidemic spreading and the
adaptive behavior due to isolation and CT (see SI). In
particular, in order to model the manual and app-based
CT we introduce two further compartments: T traceable
asymptomatic and Q isolated asymptomatic. An asymptomatic individual became traceable T when infected by
a presymptomatic node or when she infects a susceptible
node that eventually develops symptoms. In the manual case the tracing is effective with probability ε(a). In
the app-based case, tracing occurs only if both nodes involved in the contact downloaded the app. A traceable
node is still infective (aT , bT ) = (aS , bS ) and with rate
γA
γA = 1/τA  µ it is quarantined, T −−→ Q; while a quarantined node is no more infective since (aQ , bQ ) = (0, 0).
In order to take into account the delay in the manual CT
we set: τA = τC + τP for the manual case and τA = τP
for the app-based process.
B.

Epidemic thresholds

We perform a linear stability analysis of the mean field
equations around the absorbing state obtaining the conditions for its stability and then the epidemic threshold
rC (see SI for details). For the non-adaptive case (NA),
when infected individuals do not modify their behavior,
the threshold is equal to the one obtained in Refs. [35, 42].
Indeed, setting ρ(aS , bS ) = ρS (aS )δ(bS − aS ) we obtain:
NA
rC
=

aS

(3)

2a2S

If only symptomatic nodes are isolated as soon as
they develop symptoms, we obtain, setting ρ(aS , bS ) =
ρS (aS )δ(bS − aS ):
SY M P T O
rC

=

NA
rC

γP
µ

δ + (1 − δ) γµP

(4)

For the case with CT on homogeneous population, we set
ρ(aS , bS ) = δ(aS − a)δ(bS − b), ε(aS ) = ε and no delay

8
in manual CT τC = 0. We obtain the epidemic threshold

M AN U AL
rC
=

AP P
rC
=

δ + (1 − δ − εδ) γµP

δ + (1 − δ − f δ) γµP +

q

N A γP
2rC
µ
q
+ (δ + (1 − δ − εδ) γµP )2 + 4δ 2 ε γµP
N A γP
2rC
µ

(δ + (1 − δ − f δ) γµP )2 + 4δf γµP (δ +

The more general case of populations with arbitrary distribution ρ(aS , bS ), arbitrary delays τC and general form
of ε(aS ) and f (aS ), is reported in the SI.
C.

for both the manual and digital CT:

Model parameters

Figures present results where one of the model parameters is varied and all the others are fixed. Here we report
the parameter values used throughout the paper, unless
specified otherwise. They are tailored to describe the
current COVID-19 pandemic.
The fraction of infected individuals who develop symptoms is δ = 0.57 [1]. The time after which a presymptomatic individual spontaneously develops symptoms is
τP = 1.5 days [6, 39, 51], while infected individuals recover on average after τ = 14 days [40, 47]. The time window over which contacts are reconstructed is TCT = 14
days [51]: it is fixed equal to τ to track both nodes infected by the index case in the pre-symptomatic phase
(forward CT) and the primary case who infected the
index case (backward CT) [12]. The maximum number of contacts engaged in TCT by a single individual
that can be reconstructed with the manual CT procedure is kC = 130, according to the estimates of allocated resources [44, 52] and assuming that for an average individual (aS = aS ) at most 70% of its contacts

[1] E. Lavezzo et al., Nature 584, 425 (2020).
[2] L. Ferretti et al., Science 368, eabb6936 (2020).
[3] C. Rothe et al., New England Journal of Medicine 382,
970 (2020).
[4] F. Pinotti et al., PLOS Medicine 17, 1 (2020).
[5] R. Li et al., Science 368, 489 (2020).
[6] W. E. Wei et al., Morbidity and Mortality Weekly Report
69, 411 (2020).
[7] G. Bonaccorsi et al., Proceedings of the National
Academy of Sciences 117, 15530 (2020).
[8] M. Nicola et al., International Journal of Surgery 78, 185
(2020).
[9] K. T. Eames and M. J. Keeling, Proceedings of the Royal

γP
µ

(1 − f )(1 − δ))

(5)

(6)

can be traced, since more than half of physical contacts occur at home, at work and at school [46, 51].
The activity-driven network parameters are fixed so that
the average value of the activity is always the same, i.e.
aS = 6.7 days−1 [41, 46]. In particular for a power−(ν+1)
law distribution ρS (aS ) ∼ aS
, the values of aS are
constrained between a minimum and a maximum value
(am < aS < aM ). We keep aM = 103 am and then we
tune am to set aS .

D.

Numerical simulations

We perform numerical simulations of the epidemic
model on the adaptive activity-driven network: the network dynamics and epidemic spreading are implemented
by a continuous time Gillespie-like algorithm. We consider an activity-driven network of N nodes. The results
are averaged over several realizations of the disorder and
of the dynamical evolution, so that the error on the infection peak height is lower than 6%. The initial conditions
are imposed by infecting the node with the highest activity aS and the CT protocols are immediately adopted. A
detailed description of the simulations is reported in the
SI.

[10]

[11]
[12]

[13]

Society of London. Series B: Biological Sciences 270,
2565 (2003).
C. Fraser, S. Riley, R. M. Anderson, and N. M. Ferguson,
Proceedings of the National Academy of Sciences 101,
6146 (2004).
D. Klinkenberg, C. Fraser, and H. Heesterbeek, PLOS
ONE 1, 1 (2006).
S. Kojaku, L. Hébert-Dufresne, E. Mones, S. Lehmann,
and Y.-Y. Ahn, “The effectiveness of contact tracing in
heterogeneous networks,” (2020), arXiv:2005.02362 [qbio.PE] .
E. McLean et al., Epidemiology & Infection 138, 1531
(2010).

9
[14] P. Crook et al., Emerging infectious diseases 23, 2081
(2017).
[15] D. M. Bell, W. H. O. W. G. on International, and C. T.
of SARS, Emerging infectious diseases 10, 1900 (2004).
[16] A. Wilder-Smith, C. J. Chiew, and V. J. Lee, The Lancet
Infectious Diseases 20, e102 (2020).
[17] J. Hellewell et al., The Lancet Global Health 8, e488
(2020).
[18] “Privacy-preserving contact tracing,” https://covid19.
apple.com/contacttracing (2020).
[19] C. Troncoso et al., “Decentralized privacy-preserving
proximity tracing,” (2020), arXiv:2005.12273 [cs.CR] .
[20] N. Oliver et al., Science Advances 6, eabc0764 (2020).
[21] N. Ahmed et al., IEEE Access 8, 134577–134601 (2020).
[22] P. Sapiezynski, J. Pruessing, and V. Sekara, “The fallibility of contact-tracing apps,” (2020), arXiv:2005.11297
[cs.CY] .
[23] I. Braithwaite, T. Callender, M. Bullock, and R. W.
Aldridge, The Lancet Digital Health (2020).
[24] M. Zastrow, Nature (2020), Technology Feature, 202005-19.
[25] G. Cencetti et al.,
“Digital proximity tracing in
the covid-19 pandemic on empirical contact networks”
(2020), medRxiv:2020.05.29.20115915 .
[26] J. Almagor and S. Picascia, “Can the app contain the
spread? an agent-based model of covid-19 and the effectiveness of smartphone-based contact tracing,” (2020),
arXiv:2008.07336 [cs.CY] .
[27] B. F. Nielsen, K. Sneppen, L. Simonsen, and J. Mathiesen, “Social network heterogeneity is essential for contact tracing,” (2020), medRxiv:2020.06.05.20123141 .
[28] M. E. Kretzschmar et al., The Lancet Public Health 5,
e452 (2020).
[29] A. Barrat, C. Cattuto, M. Kivelä, S. Lehmann, and
J. Saramäki, “Effect of manual and digital contact tracing on covid-19 outbreaks: a study on empirical contact
data,” (2020), medRxiv:2020.07.24.20159947 .
[30] L. Alessandro, Sole24Ore (2020), 2020-09-09.
[31] P. H. O’Neill, Ryan-Mosley, and B. Johnson, MIT Technology Review (2020), Tech policy/Privacy, 2020-05-07.
[32] MIT Technology Review, “Covid tracing tracker,”
(2020), accessed on: 2020-09-29.
[33] N. Perra, B. Gonçalves, R. Pastor-Satorras,
and
A. Vespignani, Scientific Reports 2, 469 (2012).
[34] E. Ubaldi et al., Scientific Reports 6, 35724 (2016).

[35] I. Pozzana, K. Sun, and N. Perra, Phys. Rev. E 96,
042310 (2017).
[36] E. Ubaldi, A. Vezzani, M. Karsai, N. Perra, and R. Burioni, Scientific Reports 7, 46225 (2017).
[37] M. Starnini, A. Baronchelli, and R. Pastor-Satorras,
Phys. Rev. Lett. 110, 168701 (2013).
[38] W. Guan et al., New England Journal of Medicine 382,
1708 (2020).
[39] L. Di Domenico, G. Pullano, C. E. Sabbatini, P.-Y.
Boëlle, and V. Colizza, BMC Medicine 18, 240 (2020).
[40] World Health Organization, Report of the WHO-China
Joint Mission on Coronavirus Disease 2019 (COVID-19)
(2020), accessed on: 2020-09-29.
[41] K. Van Kerckhove, N. Hens, W. J. Edmunds, and
K. T. D. Eames, American Journal of Epidemiology 178,
1655 (2013).
[42] M. Mancastroppa, R. Burioni, V. Colizza, and A. Vezzani, Phys. Rev. E 102, 020301 (2020).
[43] E. P. Fenichel et al., Proceedings of the National
Academy of Sciences 108, 6306 (2011).
[44] European Center for Disease Prevention and Control,
“Resource estimation for contact tracing, quarantine and
monitoring activities for covid-19 cases in the eu/eea,”
(2020), 2020-03-02.
[45] Centers for Disease Control and Prevention, “Scaling up
staffing roles in case investigation and contact tracing,”
(2020), accessed on: 2020-09-29.
[46] J. Mossong et al., PLOS Medicine 5, 1 (2008).
[47] Y. Liu et al., The Lancet Infectious Diseases 20, 656
(2020).
[48] G. F. de Arruda, G. Petri, F. A. Rodrigues, and
Y. Moreno, Phys. Rev. Research 2, 013046 (2020).
[49] M. Mancastroppa, A. Vezzani, M. A. Muñoz, and R. Burioni, Journal of Statistical Mechanics: Theory and Experiment 2019, 053502 (2019).
[50] J. A. Firth et al., Nature Medicine (2020).
[51] M. J. Keeling, T. D. Hollingsworth, and J. M. Read,
Journal of Epidemiology & Community Health 74, 861
(2020).
[52] European Center for Disease Prevention and Control,
“Contact tracing for covid-19: current evidence, options
for scale-up and an assessment of resources needed,”
(2020), 2020-04.

Supplemental Information for ”Stochastic sampling effects favor manual over digital
contact tracing”
Marco Mancastroppa,1, 2 Claudio Castellano,3 Alessandro Vezzani,4, 1 and Raffaella Burioni1, 2
1

arXiv:2010.03399v1 [physics.soc-ph] 7 Oct 2020

Dipartimento di Scienze Matematiche, Fisiche e Informatiche,
Università degli Studi di Parma, Parco Area delle Scienze, 7/A 43124 Parma, Italy
2
INFN, Sezione di Milano Bicocca, Gruppo Collegato di Parma,
Parco Area delle Scienze, 7/A 43124 Parma, Italy
3
Istituto dei Sistemi Complessi (ISC-CNR), Via dei Taurini 19, I-00185 Roma, Italy
4
Istituto dei Materiali per l’Elettronica ed il Magnetismo (IMEM-CNR),
Parco Area delle Scienze, 37/A-43124 Parma, Italy
(Dated: October 8, 2020)

In this supplemental information we derive the mean-field equations for the temporal evolution of the epidemic
model on adaptive activity-driven networks. We also derive analytically the epidemic threshold and we describe a
scheme of the continuous-time Gillespie-like algorithm used for the numerical approach to the temporal evolution of
the network and of the epidemic. Finally, we discuss in detail the robustness of the results.
I.

MEAN-FIELD EQUATIONS AND ANALYTICAL DERIVATION OF THE EPIDEMIC THRESHOLDS

We consider the epidemic model proposed in the main text evolving on an adaptive activity-driven network in the
presence of contact tracing of asymptomatic nodes.
The epidemic model proposed is a Susceptible-Infected-Recovered (SIR) model, with a further distinction for the
states of infection I. The distinction is based on the presence of symptoms, on tracing and isolation and it models
changes in social behaviour depending on nodes’ health status. We do not consider here burstiness effects [1] nor
memory [2]. The model is an exact mean-field since local correlations are continuously destroyed due to link reshuffling:
thus the epidemic threshold of the SIR and SIS epidemic models are the same [2]. Therefore, to obtain the epidemic
threshold we consider the mean-field equations for the SIS version of the model, in which the recovered nodes become
susceptible again without gaining immunity.
A.

Manual CT

We now focus on the manual CT and we apply an activity-attractiveness based mean-field approach, dividing the
population in classes of nodes with same (aS , bS ) and considering them statistically equivalent. We assigne initially
to each node the status of symptomatic (with probability δ) or asymptomatic (with probability 1 − δ), instead of
assigning it at the time of infection. This choice is completely equivalent to the epidemic model described and allows
us to write the mean-field equations in a simpler way. Thus, at the mean-field level, the epidemic dynamics is described
by the probabilities:
• PaS ,bS (t) for a symptomatic node to be infected pre-symptomatic at time t;
• IaS ,bS (t) for a symptomatic node to be infected symptomatic at time t;
• 1 − IaS ,bS (t) − PaS ,bS (t) to be susceptible at time t, for a node which will develop symptoms;
• AaS ,bS (t) for an asymptomatic node to be infected asymptomatic at time t;
• TaS ,bS (t) for an asymptomatic node to be infected traceable at time t;
• QaS ,bS (t) for an asymptomatic node to be infected isolated at time t;
• 1 − AaS ,bS (t) − QaS ,bS (t) − TaS ,bS (t) to be susceptible at time t, for a node which will not develop symptoms.
In this
R case the average attractiveness at time t is hb(t)i = bS − (1 − δ)bS Q(t) − δbS I(t) where we define in general
g = daS dbS ρ(aS , bS )gaS ,bS . We consider the system in the thermodynamic limit. The probabilities previously
introduced evolve accordingly to the following equations:

2

∂t PaS ,bS (t) = −γP PaS ,bS (t) + λaS (1 − IaS ,bS (t) − PaS ,bS (t))

δbS P (t) + (1 − δ)[bS T (t) + bS A(t)]
bS − (1 − δ)bS Q(t) − δbS I(t)

δaS P (t) + (1 − δ)[aS T (t) + aS A(t)]
+ λbS (1 − IaS ,bS (t) − PaS ,bS (t))
bS − (1 − δ)bS Q(t) − δbS I(t)

(1)

where the first term on right hand side accounts for symptoms onset; the second and third terms account for contagion
processes of a susceptible node who engages a contact with a pre-symptomatic or a non-isolated asymptomatic infected
node, respectively for the activation of the susceptible and of the infected node. Both terms are averaged over all the
activity-attractiveness classes of the infected node.
∂t IaS ,bS (t) = −µI IaS ,bS (t) + γP PaS ,bS (t)

(2)

where the first term on the right hand side accounts for spontaneous recovery and the second term for spontaneous
symptoms development.
∂t AaS ,bS (t) = −µAaS ,bS (t) + λaS (1 − AaS ,bS (t) − TaS ,bS (t) − QaS ,bS (t))
+ λbS (1 − AaS ,bS (t) − TaS ,bS (t) − QaS ,bS (t))
− λaS δAaS ,bS (t)

δ[bS P (t) − εbS P (t)] + (1 − δ)[bS T (t) + bS A(t)]
bS − (1 − δ)bS Q(t) − δbS I(t)

δ[aS P (t) − εaS P (t)] + (1 − δ)[aS T (t) + aS A(t)]
(3)
bS − (1 − δ)bS Q(t) − δbS I(t)

εbS − εbS I(t) − εbS P (t)
εaS − εaS I(t) − εaS P (t)
− λbS δAaS ,bS (t)
bS − (1 − δ)bS Q(t) − δbS I(t)
bS − (1 − δ)bS Q(t) − δbS I(t)

where the first term on right hand side accounts for spontaneous recovery; the second and third terms account for
contagion processes of a susceptible node who engages a contact with a non-isolated asymptomatic infected node or
with a pre-symptomatic node and their contact is not traced ((1 − ε(a0S )), with a0S activity of the pre-symptomatic
node). Both terms are averaged over all the activity-attractiveness classes of the infected node. The fourth and
fifth terms correspond to contact tracing of infected asymptomatic due to infection of a susceptible symptomatic and
effective CT of the link (ε(a0S ), with a0S activity of the pre-symptomatic node). Both terms are averaged over all the
activity-attractiveness classes of the susceptible node.

∂t TaS ,bS (t) = −(µ + γA )TaS ,bS (t) + λbS (1 − AaS ,bS (t) − TaS ,bS (t) − QaS ,bS (t))
+ λaS (1 − AaS ,bS (t) − TaS ,bS (t) − QaS ,bS (t))

δεaS P (t)
bS − (1 − δ)bS Q(t) − δbS I(t)

δεbS P (t)
bS − (1 − δ)bS Q(t) − δbS I(t)

εaS − εaS I(t) − εaS P (t)
+ λbS δAaS ,bS (t)
bS − (1 − δ)bS Q(t) − δbS I(t)
+ λaS δAaS ,bS (t)

(4)

εbS − εbS I(t) − εbS P (t)
bS − (1 − δ)bS Q(t) − δbS I(t)

where the first term on right hand side accounts for isolation and recovery: the rate of isolation is γA = 1/(τC + τP ),
since a node became traceable T at time t in which it engages the traceable link, thus we need to take into account
the time for both isolation and symptoms onset. The second and third terms account for contagion processes of
a susceptible node who engage a contact with a pre-symptomatic node and their contact is traced (ε(a0S ), with a0S
activity of the pre-symptomatic node). Both terms are averaged over all the activity-attractiveness classes of the
infected node. The fourth and fifth terms correspond to contact tracing of infected asymptomatic due to infection of
a susceptible symptomatic and effective CT of the link (ε(a0S ), with a0S activity of the pre-symptomatic node). Both
terms are averaged over all the activity-attractiveness classes of the susceptible node.
∂t QaS ,bS (t) = −µQaS ,bS (t) + γA TaS ,bS (t)

(5)

where the first term on right hand side accounts for spontaneous recovery and the second term for isolation of traceable
asymptomatic infected nodes.

3
This set of equations admits as a stationary state the absorbing state, a configuration where all the population is
susceptible. To obtain the condition for the stability of the absorbing state, i.e. the epidemic threshold, we apply a
linear stability analysis around the absorbing state.
Let us now consider the case of realistic correlations between the activity and attractiveness [3, 4]: ρ(aS , bS ) =
ρS (aS )δ(bS − aS ), with generic ρS (aS ). If we average the equations on all activity classes, we obtain the temporal
evolution of the average probabilities P (t), I(t), A(t), T (t), Q(t); similarly we obtain the temporal evolution of aS T (t),
aS A(t), aS P (t) and εaS P (t) multiplying the equations for aS ρS (aS ) or ε(aS )aS ρS (aS ) and integrating. Neglecting
second order terms in probabilities, we obtain a linearized set of 9 differential equations:
∂t I(t) = −µI I(t) + γP P (t)

(6)

∂t Q(t) = −µQ(t) + γA T (t)

(8)

∂t P (t) = −γP P (t) + 2λ[δaS P (t) + (1 − δ)(aS T (t) + aS A(t))]
∂t T (t) = −(µ + γA )T (t) + 2λδεaS P (t) + 2λδaS A(t)

εaS
aS

∂t A(t) = −µA(t) + 2λ[δ(aS P (t) − εaS P (t)) + (1 − δ)(aS T (t) + aS A(t))] − 2λδaS A(t)
∂t aS P (t) = −γP aS P (t) + 2λ

(9)
εaS
aS

a2S
[δaS P (t) + (1 − δ)(aS T (t) + aS A(t))]
aS

∂t εaS P (t) = −γP εaS P (t) + 2λ

εa2S
[δaS P (t) + (1 − δ)(aS T (t) + aS A(t))]
aS

∂t aS T (t) = −(µ + γA )aS T (t) + 2λδ
∂t aS A(t) = −µaS A(t) + 2λ

(7)

a2S
εaS
εaS P (t) + 2λδa2S A(t)
aS
aS

a2S
εaS
[δ(aS P (t) − εaS P (t)) + (1 − δ)(aS T (t) + aS A(t))] − 2λδa2S A(t)
aS
aS

(10)
(11)
(12)
(13)
(14)

The linearized equations for the dynamic evolution of anS A(t) and anS T (t) always involve terms like an+1
A(t), due
S
to the contact tracing terms. This would produce an infinite set of coupled linear differential equations: to close
the equations and obtain a complete set of linearized equations, we express a2S A(t) in terms of the other average
R
probabilities. By definition a2S A(t) = daS ρS (aS )a2S AaS (t): since we are interested in studying the absorbing steady
state, we consider Eq. (3) for ρ(aS , bS ) = ρS (aS )δ(bS − aS ), linearized around the absorbing state and near the
stationary condition ∂t AaS (t) ∼ 0:
AaS (t) '

2λaS [δ(aS P (t) − εaS P (t)) + (1 − δ)(aS T (t) + aS A(t))]
µaS + 2λδaS εaS

(15)

Thus, setting r = λ/µ and replacing Eq. (15) into the definition of a2S A(t) we obtain:
a2S A(t) '
where K =

a3S
1+2rδaS

εaS
aS

=

R

2r
[δ(aS P (t) − εaS P (t)) + (1 − δ)(aS T (t) + aS A(t))]K
aS

daS ρS (aS )

a3S
1+2rδaS

εaS
aS

(16)

.

In this way we obtain the following linearized equations for aA T (t) and aS A(t), near the absorbing stationary state:

∂t aS T (t) = −(µ + γA )aS T (t) + 2λδ

a2S
εaS
εaS P (t) + 4λr 2 δK[δ(aS P (t) − εaS P (t)) + (1 − δ)(aS T (t) + aS A(t))] (17)
aS
aS

a2S
[δ(aS P (t) − εaS P (t)) + (1 − δ)(aS T (t) + aS A(t))]
aS
εaS
− 4λr 2 δK[δ(aS P (t) − εaS P (t)) + (1 − δ)(aS T (t) + aS A(t))]
aS

∂t aS A(t) = −µaS A(t) + 2λ

(18)

4
We focus on the Jacobian matrix of this set of 9 linearized equations:

−µI γP
0
0
0
0
 0 −γP 0
0
0
2λδ

 0
0 −µ
γA
0
0

 0
0
0
−µ
−
γ
0
0
A

J =
0
0
0
−µ
2λδ
 0
 0
0
0
0
0 −γP + ∆

 0
0
0
0
0
φ

 0
0
0
0
0
θ
0
0
0
0
0
∆−θ
a2

a2


0
0
0

0
2λ(1 − δ)
2λ(1 − δ)


0
0
0

S
 

2λδ
0
2λδ εa
aS

A(5x5) C(5x4)
εaS 
=
−2λδ
2λ(1 − δ) 2λ(1 − δ) − 2λδ aS 
O(4x5) B(4x4)

0
Γ
Γ


−γP
Φ
Φ


∆ − θ −µ − γA + Ψ
Ψ
θ−∆
Γ−Ψ
−µ + Γ − Ψ
(19)

εa2

εa2

where ∆ = 2λδ aSS , Γ = 2λ(1 − δ) aSS , φ = 2λδ aSS , Φ = 2λ(1 − δ) aSS , θ = 4λrδ 2 aεaSS2 K and Ψ = 4λrδ(1 − δ) aεaSS2 K.
The Jacobian matrix is a block matrix and the condition for the stability of the absorbing state is obtained imposing
all eigenvalues to be negative. We can consider separately the two blocks on the diagonal: for the first block A it is
evident that the eigenvalues are ξ1,2 = −µ, ξ3 = −µI , ξ4 = −γP , ξ5 = −µ − γA , all negative. Therefore, it is sufficient
to study block B, which is a matrix 4x4. The characteristic polynomial of B is a polynomial of degree 4, thus we
apply the Descartes’ rule of signs to impose all roots to be negative and we obtain the condition for the stability of
the absorbing state:
"
#
2 εa
3
3
εa
a
a
γ
γ
γA
S
P
A
S
S
8r3 δ 2 (1 − δ) S
− 4r2 δ(1 − δ) εa2S a2S +
εaS
εaS
S µ
aS 1 + 2rδaS εa
µ
µ
1 + 2rδaS aS
aS





γP
γA
γP γA
+1
δ+
(1 − δ) − aS 2
+1 <0
+ 2ra2S aS
µ
µ
µ
µ

(20)

By setting the equality, the equation allows to obtain a closed relation for estimating the epidemic threshold rC .
The epidemic threshold obtained with the mean-field approach is exact and it holds for manual contact tracing, with
arbitrary delay τC (encapsulated in γA ), for arbitrary ρS (aS ) and ε(aS ).
B.

App-based CT

Analogously we apply the activity-attractiveness based mean-field approach to the app-based CT. At the mean-field
level, the epidemic dynamics is described by the probabilities:
• PaS ,bS (t) for a symptomatic node without app to be infected pre-symptomatic at time t;
• IaS ,bS (t) for a symptomatic node without app to be infected symptomatic at time t;
• 1 − PaS ,bS (t) − IaS ,bS (t) to be susceptible at time t, for a node without app and which will develop symptoms;
• AaS ,bS (t) for an asymptomatic node without app to be infected asymptomatic at time t;
• 1 − AaS ,bS (t) to be susceptible at time t, for a node without app and which will not develop symptoms;
• PaαS ,bS (t) for a symptomatic node with app to be infected pre-symptomatic at time t;
• IaαS ,bS (t) for a symptomatic node with app to be infected symptomatic at time t;
• 1 − PaαS ,bS (t) − IaαS ,bS (t) to be susceptible at time t, for a node with app and which will develop symptoms;
• Aα
aS ,bS (t) for an asymptomatic node with app to be infected asymptomatic at time t;
• TaαS ,bS (t) for an asymptomatic node with app to be infected traceable at time t;
• Qα
aS ,bS (t) for an asymptomatic node with app to be infected isolated at time t;
α
α
• 1 − Aα
aS ,bS (t) − QaS ,bS (t) − TaS ,bS (t) to be susceptible at time t, for a node with app and which will not develop
symptoms.

5
In this case the average attractiveness at time t is hb(t)i = bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t)).
We consider the system in the thermodynamic limit: the probabilities previously introduced evolve according to the
following equations, obtained analogously to those for manual CT:
∂t IaS ,bS (t) = −µI IaS ,bS (t) + γP PaS ,bS (t)
∂t PaS ,bS (t) = − γP PaS ,bS (t)

(21)

+ λaS (1 − IaS ,bS (t) − PaS ,bS (t))
+ λbS (1 − IaS ,bS (t) − PaS ,bS (t))
∂t IaαS ,bS (t)
∂t PaαS ,bS (t)

=
=

−µI IaαS ,bS (t) +
− γP PaαS ,bS (t)

δ(f bS P α (t) + (1 − f )bS P (t)) + (1 − δ)(f bS T α (t) + f bS Aα (t) + (1 − f )bS A(t))
bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

δ(f aS P α (t) + (1 − f )aS P (t)) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))
bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

γP PaαS ,bS (t)

(23)

+ λaS (1 − IaαS ,bS (t) − PaαS ,bS (t))

δ(f bS P α (t) + (1 − f )bS P (t)) + (1 − δ)(f bS T α (t) + f bS Aα (t) + (1 − f )bS A(t))

+ λbS (1 − IaαS ,bS (t) − PaαS ,bS (t))

δ(f aS P α (t) + (1 − f )aS P (t)) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))

bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

∂t AaS ,bS (t) = − µAaS ,bS (t)

+ λbS (1 − AaS ,bS (t))
= −

δ(f bS

P α (t)

+ (1 − f )bS P (t)) + (1 − δ)(f bS

f bS − f bS

P α (t)

δ(1 − f )bS P (t) + (1 − δ)(f bS T α (t) + f bS Aα (t) + (1 − f )bS A(t))
bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))
bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

− f bS I α (t)

bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))
f aS − f aS P α (t) − f aS I α (t)

bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

α
α
∂t Qα
aS ,bS (t) = −µQaS ,bS (t) + γP TaS ,bS (t)
∂t TaαS ,bS (t) = − (µ + γP )TaαS ,bS (t)

(26)
(27)
(28)

α
α
+ λaS (1 − Aα
aS ,bS (t) − TaS ,bS (t) − QaS ,bS (t))
α
α
+ λbS (1 − Aα
aS ,bS (t) − TaS ,bS (t) − QaS ,bS (t))

+ λδbS Aα
aS ,bS (t)

+ (1 − f )bS A(t))

bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

α
α
+ λbS (1 − Aα
aS ,bS (t) − TaS ,bS (t) − QaS ,bS (t))

+ λδaS Aα
aS ,bS (t)

+ f bS

Aα (t)

bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

α
α
+ λaS (1 − Aα
aS ,bS (t) − TaS ,bS (t) − QaS ,bS (t))

− λδbS Aα
aS ,bS (t)

T α (t)

δ(f aS P α (t) + (1 − f )aS P (t)) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))

µAα
aS ,bS (t)

− λδaS Aα
aS ,bS (t)

(24)
(25)

+ λaS (1 − AaS ,bS (t))

∂t Aα
aS ,bS (t)

(22)

δf bS P α (t)
bS − (1 − δ)f bS
bS − (1 − δ)f bS

f bS − f bS P α (t) − f bS I α (t)

Qα (t)

− δ(f bS I α (t) + (1 − f )bS I(t))

δf aS P α (t)

Qα (t)

− δ(f bS I α (t) + (1 − f )bS I(t))

bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))
f aS − f aS P α (t) − f aS I α (t)

bS − (1 − δ)f bS Qα (t) − δ(f bS I α (t) + (1 − f )bS I(t))

This set of equations admits as a stationary state the absorbing state, a configuration where all the population is
susceptible. To obtain the condition for the stability of the absorbing state, i.e. the epidemic threshold, we apply a
linear stability analysis around the absorbing state.
Let us now consider the case of realistic correlations between the activity and attractiveness: ρ(aS , bS ) =
ρS (aS )δ(bS − aS ), with general ρ(aS ). If we average on all activity classes, we obtain the temporal evolution of the
average probabilities P (t), I(t), A(t), P α (t), I α (t), Aα (t), Qα (t), T α (t); similarly we obtain the temporal evolution of

6
f aS P α (t), f aS T α (t), aS Aα (t), f aS Aα (t), (1 − f )aS P (t), (1 − f )aS A(t), multiplying the equations for f (aS )aS ρS (aS )
or aS ρS (aS ) or (1 − f (aS ))aS ρS (aS ) and integrating over all activity classes. We neglect the terms of second order in
probabilities obtaining a linearized set of 14 differential equations:
∂t I(t) = −µI I(t) + γP P (t)

(29)

∂t P (t) = −γP P (t) + 2λ[δ(f aS

∂t
∂t

I α (t)

P α (t)

= −µI

I α (t)

= −γP

P α (t)

+ γP

P α (t)

P α (t)

+ 2λ[δ(f aS

∂t A(t) = −µA(t) + 2λ[δ(f aS

P α (t)

P α (t)

∂t Qα (t) = −µQα (t) + γP T α (t)

+ (1 − f )aS P (t)) + (1 − δ)(f aS

T α (t)

+ (1 − f )aS P (t)) + (1 − δ)(f aS

+ (1 − f )aS P (t)) + (1 − δ)(f aS

∂t T α (t) = −(µ + γP )T α (t) + 2λδf aS P α (t) + 2λδaS Aα (t)

+ f aS

T α (t)

T α (t)

Aα (t)

+ f aS

+ f aS

+ (1 − f )aS A(t))]

Aα (t)

Aα (t)

+ (1 − f )aS A(t))]

+ (1 − f )aS A(t))]

f aS
aS

∂t Aα (t) = − µAα (t) + 2λ[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]

(30)
(31)
(32)
(33)
(34)
(35)
(36)

f aS
− 2λδaS Aα (t)
aS

∂t aS Aα (t) = − µaS Aα (t) + 2λ

a2S
[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]
aS

f aS
aS
∂t f aS P α (t) = − γP f aS P α (t)

(37)

− 2λδa2S Aα (t)

+ 2λ

(38)

f a2S
[δ(f aS P α (t) + (1 − f )aS P (t)) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]
aS

∂t (1 − f )aS P (t) = − γP (1 − f )aS P (t)
+ 2λ

f )a2S

(1 −
aS

(39)

[δ(f aS P α (t) + (1 − f )aS P (t)) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]

∂t (1 − f )aS A(t) = − µ(1 − f )aS A(t)
+ 2λ

(40)

(1 − f )a2S
[δ(f aS P α (t) + (1 − f )aS P (t)) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]
aS

∂t f aS T α (t) = −(µ + γP )f aS T α (t) + 2λδ
∂t f aS Aα (t) = − µf aS Aα (t) + 2λ
− 2λδf a2S Aα (t)

f a2S
f aS
f aS P α (t) + 2λδf a2S Aα (t)
aS
aS

f a2S
[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]
aS

(41)
(42)

f aS
aS

Similarly to the manual CT, in order to close the equations and obtain a complete set of linearized equations, we
express f a2S Aα (t) and a2S Aα (t) in terms of the other average probabilities using their own definition. By definition
R
R
2 α
f a2S Aα (t) = daS ρS (aS )f (aS )a2S Aα
daS ρS (aS )a2S Aα
aS (t) and aS A (t) =
aS (t): since we are interested in studying
the steady state and its stability, we consider the Eq. (26) for ρ(aS , bS ) = ρS (aS )δ(bS − aS ), linearized around the
absorbing state and near to the stationary condition ∂t Aα
aS (t) ∼ 0:
Aα
aS (t) '

2λaS [δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]
µaS + 2λδaS f aS

(43)

Thus,
2
r[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]H
aS
2
a2S Aα (t) '
r[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]Z
aS

f a2S Aα (t) '

(44)
(45)

7
where H =

f a3S
1+2rδaS

f aS
aS

=

R

daS ρS (aS )

f (aS )a3S
1+2rδaS

f aS
aS

,Z=

a3S
1+2rδaS

f aS
aS

.

In this way we obtain the following linearized equations for f aS T α , f aS Aα and aS Aα near the absorbing stationary
state:

∂t aS Aα (t) = − µaS Aα (t) + 2λ
− 4λrδ

a2S
[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]
aS

f aS
[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]Z
aS 2

∂t f aS T α (t) = − (µ + γP )f aS T α (t) + 2λδ
+ 4λrδ

f a2S
f aS P α (t)
aS

(47)

f aS
[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]H
aS 2

∂t f aS Aα (t) = − µf aS Aα (t) + 2λ
− 4λrδ

(46)

f a2S
[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]
aS

(48)

f aS
[δ(1 − f )aS P (t) + (1 − δ)(f aS T α (t) + f aS Aα (t) + (1 − f )aS A(t))]H
aS 2

Focusing on the Jacobian matrix of this set of 14 linearized equations:



−µI γP
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
2λδ
2λδ
2λ(1 − δ)
2λ(1 − δ)
2λ(1 − δ) 
 0 −γP


0 −µI γP
0
0
0
0
0
0
0
0
0
0
 0



0
0 −γP 0
0
0
0
0
2λδ
2λδ
2λ(1 − δ)
2λ(1 − δ)
2λ(1 − δ) 
 0
 0
0
0
0 −µ 0
0
0
0
2λδ
2λδ
2λ(1 − δ)
2λ(1 − δ)
2λ(1 − δ) 


 0

0
0
0
0
−µ
+γ
0
0
0
0
0
0
0
P




 0

0
0
0
0
0 −µ − γP 0
2λδ faaSS
2λδ
0
0
0
0

J =
 0
f aS
0
0
0
0
0
0
−µ −2λδ aS
0
2λδ
2λ(1 − δ)
2λ(1 − δ)
2λ(1 − δ) 



Z
Z
Z
Z
 0

0
0
0
0
0
0
0
−µ
0
∆ + φ − ΦH
θ + Γ − ΨH
θ + Γ − ΨH
θ + Γ − ΨH


0
0
0
0
0
0
0
0
−γP + ∆
∆
Γ
Γ
Γ
 0



0
0
0
0
0
0
0
0
0
φ
−γ
+
φ
θ
θ
θ


P


0
0
0
0
0
0
0
0
φ
φ
−µ + θ
θ
θ
 0

 0

0
0
0
0
0
0
0
0
∆
Φ
Ψ
−µ − γP + Ψ
Ψ
0
0
0
0
0
0
0
0
0
0
∆−Φ
Γ−Ψ
Γ−Ψ
−µ + Γ − Ψ


A(9x9) C(9x5)
=
O(5x9) B(5x5)
(49)

where ∆ = 2λδ

f a2S
aS ,

Γ = 2λ(1 − δ)

f a2S
aS ,

φ = 2λδ

(1−f )a2S
,
aS

θ = 2λ(1 − δ)

(1−f )a2S
,
aS

Φ = 4λrδ 2 faaSS2 H and Ψ =

4λrδ(1 − δ) faaSS2 H.
The Jacobian matrix is a block matrix and we can consider separately the two blocks on the diagonal: for the first
block A it is evident that the eigenvalues are ξ1,2 = −µI , ξ3,4,5,6 = −µ, ξ7,8 = −γP , ξ9 = −µ − γP , all negative.
Therefore, it is sufficient to study block B, which is a matrix 5x5. The characteristic polynomial of B is a polynomial
of degree 5: we apply the Descartes’ rule of signs, to impose all roots to be negative and we obtain the condition for
the stability of the absorbing state:

8r3 δ 2 (1 − δ)

f a2S

f a3S



f a3S



2
f aS
γP
γP
 γP
− 4r2 δ(1 − δ) f a2S +
f aS
f aS µ
f aS
aS
µ
µ
1 + 2rδaS aS
1 + 2rδaS aS





γP
γP
γP
2 γP
2
+ 2raS aS
+1
δ+
(1 − δ) − aS
+1 <0
µ
µ
µ
µ

(50)

By setting the equality, the equation allows to obtain a closed relation for an estimate of the epidemic threshold.
The epidemic threshold obtained with the mean-field approach is exact and it holds for digital contact tracing, with
arbitrary ρS (aS ) and f (aS ).

8
C.

Limit cases

The obtained closed relations for the stability of the absorbing state in the manual and digital CT hold for arbitrary
ρS (aS ), for completely general f (aS ) and ε(aS ) and for general delays: this allows to introduce complicated effects,
such as delay in isolation, activity heterogeneities and limited scalability of the system.
Due to the complicated structure of the equations for the stability (Eq. (20) and Eq. (50)), it is possible to derive
the epidemic threshold rC only by solving the equation numerically. However, there are some simple limit cases in
which the equations are considerably simplified, allowing to obtain the epidemic threshold in an explicit analytic form.
1.

Non-adaptive case (NA)

Here we consider the non-adaptive case, in which no adaptive behaviour are implemented, i.e. infected nodes
behave as if they were susceptible, with (aI , bI ) = (aS , bS ). Thus, in this case f (aS ) = ε(aS ) = 0, ∀aS and γP /µ = 1.
Replacing these values either in Eq. (20) or in Eq. (50) we obtain, as expected:
2ra2S aS − aS 2 = 0
So we obtain an explicit form for the epidemic threshold rC in the non-adaptive case:
NA
rC
=

aS

(51)

2a2S

which is the Eq. (3) in the main paper. It reproduces the results previously obtained in Refs. [3, 5].
2.

Isolation of only symptomatic nodes

Here we consider the case in which only symptomatic nodes are isolated as soon as they develops symptoms, i.e.
no CT is implemented. Thus, in this case f (aS ) = ε(aS ) = 0, ∀aS , while (aI , bI ) = (0, 0) . Replacing these values
either in Eq. (20) or in Eq. (50) we obtain, as expected:

2ra2S aS



γP
γP
=0
δ + (1 − δ)
− aS 2
µ
µ

So we obtain an explicit form for the epidemic threshold rC :

SY M P T O
NA
rC
= rC

γP
µ

δ + (1 − δ) γµP

(52)

which is the Eq. (4) in the main paper. For instantaneous symptoms development γP /µ → ∞ it reproduces the
results previously obtained in Ref. [5], and for γP /µ = 1 it reproduces the NA case (Eq. (51)).
3.

Homogeneous case without delays and without limited scalability

Here we consider the case in which the population is homogeneous, i.e. ρ(aS , bS ) = δ(aS −a)δ(bS −b), with constant
probability of downloading the app in digital CT, i.e. f (aS ) = f , and constant probability for a contact to be traced
in manual CT, i.e. ε(aS ) = ε. Moreover we assume τC = 0, that is γA = γP . Replacing these values in the Eq. (20),
for the manual CT we obtain a quadratic equation in r:


γP
γP
4a2 δ 2 εr2 + 2a δ +
(1 − δ − δε) r −
=0
µ
µ
The equation can be solved and we obtain:

9

M AN U AL
rC

=

NA
rC

δ + (1 − δ − εδ) γµP +

q

2 γµP
(δ + (1 − δ − εδ) γµP )2 + 4δ 2 ε γµP

(53)

which is the Eq. (5) in the main paper.
Analogously, replacing the values in the Eq. (50) for the digital CT we obtain an equation of second degree in r:

2

4a δf






γP
γP
γP
2
δ+
(1 − δ)(1 − f ) r + 2a δ +
(1 − δ − δf ) r −
=0
µ
µ
µ

The equation can be solved and we obtain:

AP P
NA
rC
= rC

δ + (1 − δ − f δ) γµP +

which is the Eq. (6) in the main paper.
II.

q

2 γµP
(δ + (1 − δ − f δ) γµP )2 + 4δf γµP (δ +

γP
µ

(1 − f )(1 − δ))

(54)

CONTINUOUS TIME GILLESPIE-LIKE ALGORITHM FOR NETWORK DYNAMICS AND
EPIDEMIC EVOLUTION

The network dynamics is performed by a continuous-time Gillespie-like algorithm [6]: we assign to each node the
activity aS and attractiveness bS drawn from the joint distribution ρ(aS , bS ). Initially, the network evolves in the
absorbing state, i.e. all nodes are susceptible and infection does not propagate, up to a relaxation time t0 , to reach
the equilibrium of activation dynamics:
i

1. The first activation time, ti , of each node i is drawn from ΨaiS (ti ) = aiS e−aS ti at time t = 0.
2. The node i with the lowest ti activates and connects m randomly-selected nodes, with probability proportional
to their attractiveness bS .
3. The next activation time ti for node i is set to ti + τ , with τ inter-event time drawn from ΨaiS (τ ).
4. All links are destroyed and the process is iterated from point 2.
Then we start the epidemic and contact tracing dynamics as follows:
1. At time t = t0 the population is divided into a configuration of susceptible (S) and infected (P or A) nodes,
moreover each node has an activation time ti > t0 = t obtained from the initial relaxation dynamics.
2. Node i with the lowest ti activates. Asymptomatic (A, T and Q) and symptomatic nodes (I) at time t recover
at ti with probability respectively 1 − e−µ(ti −t) and 1 − e−µI (ti −t) : recovered nodes change their activity and
attractiveness into (aR , bR ) = (aS , bS ). Traceable nodes at time t are isolated at ti with probability 1−e−(ti −t)/τC
(with τC > 0 for manual CT and τC = 0 for digital CT) and set their activity and attractiveness to zero
(aQ , bQ ) = (0, 0).
3. Pre-symptomatic nodes at time t develop symptoms at ti with probability 1 − e−γP (ti −t) : they set to zero their
activity and attractiveness (aI , bI ) = (0, 0) and the contact tracing is activated.
Manual CT: the protocol is enabled for every symptomatic node. Every contact made in the last TCT period
has ε(aS ) probability of being identified and tested, with aS activity of the symptomatic node. Every node
tested and found infected asymptomatic A becomes traceable T .
Digital CT: the protocol is enabled only if the symptomatic node has downloaded the app. Each contact made
in the last TCT period with an individual who downloaded the app is identified and tested. Every node tested
and found infected asymptomatic A becomes traceable T .

10
4. We set the actual time t = ti and the active agent i generates exactly m links with m nodes randomly-chosen
with probability proportional to their attractiveness b at time t (depending on their status and isolation). The
contacts are registered in the contact list of both nodes engaged in the connection. If the link involves a
susceptible and an infected node (P , A or T ), a contagion can occur with probability λ and the susceptible node
becomes pre-symptomatic with probability δ or asymptomatic with probability 1 − δ.
5. The new activation time of node i is ti = t + τ and it is obtained drawing the inter-event time τ from the
i
inter-event time distribution Ψai (τ ) = ai e−a τ , where ai is the activity of node i at time t. All the links are
deleted and the process is iterated from point 2.
III.

ROBUSTNESS OF THE RESULTS

The advantage of the manual CT is robust relaxing many assumptions and changing most parameters in the
modelling scheme.
The results are robust to changes in the maximum number of traceable contacts kc in the manual CT: an increase
in kc reduces the effects of limited scalability; similarly, its reduction makes the effects of limited scalability stronger.
However, modifying kc with realistic values changes only slightly the epidemic threshold of the manual contact tracing
protocol, without changing qualitatively the results, since the manual protocol remains more effective than the digital
one, for small ε̄ = f 2 values (Fig. 1(a)).
The results are also robust when considering changes in the social properties of the population, i.e. assuming
a different functional form of the ρ(aS , bS ) distribution. For example, we can assume that all nodes feature equal
attractiveness b and different activity: ρ(aS , bS ) = ρS (aS )δ(bS − b). In this case the correlations between activity and
attractiveness are removed: however, again the manual CT is more effective than the digital one in heterogeneous
populations and for small ε̄ = f 2 (Fig. 1(b)). The differences between the two methods are reduced, compared to the
case with correlations (see the inset of Fig. 1(b)), due to the reduction in heterogeneities, since homogeneous terms
are introduced assuming all the nodes having the same attractiveness. However, differences between the two protocols
remain evident, even in the presence of delays τC > 0 and limited scalability in the manual CT.
Similarly, the advantage of manual contact tracing holds also considering limited scalability and stronger delays in
manual contact tracing τC : even for a delay of 7 days the manual CT remains more effective than the digital one, for
small ε̄ = f 2 and in heterogeneous populations (Fig. 1(c)).
The results are also robust when considering the effects of contact tracing on the active phase of the epidemic: as
expected from the analysis on the epidemic threshold, the differences between the two methods are reduced increasing
τC , however even with considerable delays τC the manual CT for small values of ε = f 2 is more effective in flattening
the infection peak and in lowering the epidemic final-size (Fig. 2). Indeed, its effectiveness, compared to the digital
CT, is maximized for τC = 0 (Fig. 2(a)); the differences are reduced but still present considering strong delays in
manual CT, such as τC = 5 days (Fig. 2(b)). The differences remain even if we consider the system deeply in the
active phase, that is for r  rC : in this case the differences are sightly reduced due to the high infectivity of the
system, however again the manual method for small ε is more effective than digital CT (Fig. 2(c)). Finally, as
observed for the epidemic threshold, for very large ε = f 2 = 0.6 and strong delays τC = 5 days, the digital protocol
becomes more effective in reducing the impact of the epidemic, further flattening the infection peak and reducing the
epidemic final-size (Fig. 2(d)). This again confirms that the effects of the protocols on the active phase are similar to
those observed on the epidemic threshold, including the differences in the two approaches.

11
b)

a)

3.2

3.4

1.3

1.3

3.2

1.2

3

1.2

3

1.1

1.1

2.8

2.8
1

1
1

2

3

2.6

1

2.6

2

3

4

5

2.4
Manual CT - kc=130

2.2
2

2.4

Manual CT - w/o scalability
App-based CT
Manual CT - kc=65
Manual CT - kc=260

1

1.5

2

2.5

3

3.5

2.2

1

2

3

4

5

c)
2.9
Manual CT
App-based CT

2.8

1.2

2.7
1.1

2.6
2.5

1

2.4
2

4

2.3
2.2
2.1

1

2

3

4

5

FIG. 1: Robustness of the results for the epidemic threshold. In all panels we plot the ratio between the epidemic
NA
. The ratio is
threshold rC in the presence of contact tracing protocols and the epidemic threshold of the non-adaptive case rC
plotted for both manual and digital contact tracing, as a function of ν. In all the inserts we plot the ratio between the epidemic
M AN U AL
AP P
threshold of the manual contact tracing rC
and that of the app-based contact tracing rC
, as a function of ν. In
panel (a) the ratio for the manual CT is plotted for several values of kc and also when scalability is not considered (legend),
setting τC = 3 days and ρ(aS , bS ) ∼ a−(ν+1) δ(bS − aS ). In panel (b) the ratio is plotted both for ρ(aS , bS ) ∼ a−(ν+1) δ(bS − aS )
and for ρ(aS , bS ) ∼ a−(ν+1) δ(bS − b) (legend), setting τC = 3 days and kc = 130. In panel (c) the ratio is plotted for
ρ(aS , bS ) ∼ a−(ν+1) δ(bS − aS ) setting τC = 7 days and kc = 130. In all panels ε = f 2 = 0.1, ν = 1.5, δ = 0.57, τP = 1.5 days,
τ = 14 days, TCT = 14 days, aS ∈ [aM , aM ] with aM /am = 103 , aS = 6.7 days−1 .

12
a)

b)

10-3

9

10-3

2

8
7

1.5

6

1

5

0.5

10-3

6

Inf(t) Manual CT
R(t) Manual CT
Inf(t) App-based CT
R(t) App-based CT

1.01

5

1
Manual CT
App-based CT
Manual CT
App-based CT

0.99

4
10-3

0.98

3
4

0

0

0.97
200

100

2

3
Inf(t) Manual CT
R(t) Manual CT
Inf(t) App-based CT
R(t) App-based CT

2
1
0

0

c)

50

100

150

0.5

0

0

200

0

50

4

10

4

Manual CT
App-based CT
Manual CT
App-based CT

0

50

0.99

0.97

0

0.96
150

0

50

100

100

150

150

200

1
Manual CT
App-based CT
Manual CT
App-based CT

1

2

0.98

1

0.98
150

100

10-3

1

2

0

50

Inf(t) Manual CT
R(t) Manual CT
Inf(t) App-based CT
R(t) App-based CT

1.5

3

5

0

100

3
10-3

0.99

10-3

5

Inf(t) Manual CT
R(t) Manual CT
Inf(t) App-based CT
R(t) App-based CT

0.995

0.985

d)

15

Manual CT
App-based CT
Manual CT
App-based CT

1

10-3
20

1

1

0.99
0.98

0.5

1
0

200

0

0

50

0

100

100

0.97
200

150

200

FIG. 2: Robustness of the results for the epidemic active phase. In all panels we plot the temporal evolution of the
fraction of infected nodes Inf (t), i.e. infected asymptomatic and infected symptomatic, and of the fraction of removed nodes
R(t), for both manual and digital CT. In the insets we plot the temporal evolution of the fraction of isolated nodes Iso(t) (right
y-axis) and of the average activity of the population ha(t)i (left y-axis), normalized with aS . All curves are averaged on several
NA
realization of disorder and temporal evolution. In panel (a) we set τC = 0, ε = f 2 = 0.1 and r/rC
= 4.0; in panel (b) we set
2
NA
2
NA
τC = 5 days, ε = f = 0.1 and r/rC = 3.1; in panel (c) we set τC = 5 days, ε = f = 0.1 and r/rC
= 7.0; in panel (d) we
−(ν+1)
NA
set τC = 5 days, ε = f 2 = 0.6 and r/rC
= 4.5. In all panels ρ(aS , bS ) ∼ aS
δ(bS − aS ) with aS ∈ [am , aM ], aM /am = 103 ,
ν = 1.5, aS = 6.7 days−1 , N = 5 103 , δ = 0.57, τP = 1.5 days, τ = 14 days, kc = 130, TCT = 14 days.

13

[1]
[2]
[3]
[4]
[5]
[6]

M. Mancastroppa, A. Vezzani, M. A. Muñoz, and R. Burioni, J. Stat. Mech.: Theory Exp 2019, 053502 (2019).
M. Tizzani, S. Lenti, E. Ubaldi, A. Vezzani, C. Castellano, and R. Burioni, Phys. Rev. E 98, 062315 (2018).
I. Pozzana, K. Sun, and N. Perra, Phys. Rev. E 96, 042310 (2017).
G. Ghoshal and P. Holme, Physica A 364, 603 (2006).
M. Mancastroppa, R. Burioni, V. Colizza, and A. Vezzani, Phys. Rev. E 102, 020301 (2020).
D. T. Gillespie, J. Comput. Phys. 22, 403 (1976).

