Received -;

Revised -;

Accepted -

DOI: xxx/xxxx

COVID-19 pandemic: a mobility-dependent SEIR model with

arXiv:2005.08882v1 [q-bio.PE] 18 May 2020

undetected cases in Italy, Europe and US
Nicola Picchiotti1,2 | Monica Salvioli*3 | Elena Zanardini4 | Francesco Missale5,6
1 Department

of Mathematics, University of
Pavia, Pavia, Italy
2 Internal Model Validation, Banco BPM
S.p.A., Verona, Italy
3 Department of Mathematics, Politecnico di
Milano, Milano, Italy
4 Department of Medical and Surgical
Specialties, Radiological Sciences and
Public Health, University of Brescia,
Brescia, Italy
5 Department of Molecular and Translational
Medicine, University of Brescia, Brescia,
Italy
6 IRCCS Ospedale Policlinico San Martino,
Genova, Italy

Abstract
Background
The outbreak of Coronavirus disease 2019 (COVID-19) emerged in China at the end
of 2019 and has spread worldwide within few weeks reaching a pandemic status.
China and Italy, followed by other countries, have implemented strict control measures including complete lockdown. The effects of such measures and the optimal
strategies to relax them are major Public Health concerns.
Method
We introduce a SEIR compartmental model describing the COVID-19 pandemic,
taking into account the region-specific fraction of undetected cases, the effects of
mobility restrictions fitting Google COVID-19 Community Mobility Report data,

Correspondence
*Monica Salvioli, Department of
Mathematics, Politecnico di Milano, Piazza
Leonardo da Vinci 32, 20133 Milano, Italy.
Email: monica.salvioli@polimi.it

and the personal protective measures adopted as frequent hand washing or use of
masks.
Results
The model is experimentally validated with data of Italian regions, European countries and US, obtaining fitting parameters in good agreement with previous literature.
The mean absolute percentage error analysis for forecasting accuracy judgement
showed that our model was highly accurate in 12 regions (46%), good in 7 (27%)
and reasonable in 7 (27%). The estimation of the undetected cases allows to evaluate
different post-lockdown scenarios which is crucial for public-health decision makers.
Conclusions
The proposed model, calibrated and designed on measured or literature-based parameters, was successfully applied in all scenarios analyzed and the estimation of the
dynamic of the whole number of infectious individuals could help the planning of
different strategies aimed at relaxing the lockdown measures.
KEYWORDS:
COVID-19; Models, Theoretical; SEIR; Public Health; Epidemiology; Lockdowns

2

Picchiotti et al

HIGHLIGHTS
• COVID-19 pandemic size and evolution is highly dependent on both detected and undetected cases.
• Undetected cases are estimable from lethality data and death records.
• A SEIR model for COVID-19 pandemic calibrated on mobility data changing.
• Different scenarios depending on when and how the lockdown measures are relaxed.

1

INTRODUCTION

Italy was the first European country experiencing a substantial outbreak of the coronavirus disease 2019 (COVID-19) and
consequently applying lockdown emergency measures to contain the spread of the epidemic, similarly to the Chinese strategy. In
particular, as the number of infections was growing exponentially [1], the Italian authorities decided to close all schools on March
5th 2020 and introduced community containment lockdown measures starting on March 9th. Spain, France, Germany, United
Kingdom (UK) and United States (US) are the countries with the highest number of infections and deaths. All these countries
adopted public health measures and, most of them, implemented a complete lockdown, but such measures were introduced at
different time points following local outbreaks and with different strengths [1].
The aim of our work is to model the evolution of the COVID-19 pandemic in different regions, taking into account major
confounders such as undetected cases, related to the different case fatality ratio measured and taking into account background
death data, and different mobility changes as effect of public health measures.
Assuming that isolation is successfully applied to the positive detected cases, undetected and asymptomatic cases will represent
the main source of infections in the near future, potentially determining new outbreaks. This poses a crucial challenge for public
health decision makers, namely to determine when and how to relax the control measures implemented so far, taking into account
the whole number of estimated infectious individuals and not only the tested cases.
Our model provides an accurate estimation of the undetected and asymptomatic cases, therefore allowing to predict future
epidemic peaks and design the most effective way to relax the control measures, in terms of timing and strength in term of

Picchiotti et al

3

mobility restrictions and adoption of personal protective behavior. Moreover, it can be expanded and tailored when more and
new region-specific data will become available.

2

MATERIAL AND METHODS

We model the spread of the COVID-19 pandemic in different geographical regions using a modified SEIR compartmental model
[2], fitted using publicly available data from the 2019-nCoV Data Repository by Johns Hopkins CSSE and from the Italian
official repository updated as of 24th April [3]
In a classical SEIR model the population is divided into four classes: Susceptible, Exposed, Infected, and Recovered. In our
specific case, illustrated in Supplementary Methods, we added the classes of Positive tested, Undetected infected and, both for
detected and undetected ones, the two possible ending point, Healing and Death (Figure 1A). Disease-specific parameters were
derived from the recent literature, including a mean incubation time (𝜂 −1 ) of 5.1 days [4], a mean time to isolation (𝛾1−1 ) of 4.8
days [5], a mean recovery time for undetected cases of 10 days [6] and time to death from onset of 17.8 days [7]. The time
of recovery’s notification by the Public Health System, after isolation of the detected cases, was fitted. For the lethality rate of
COVID-19 we used the adjusted Case Fatality Rate (aCFR) of 1.4% (CI95% 1.2-1.7%), derived by Shim et al. [8]
We compared available Italian death records data from years 2015-2020 (considering only February and March) and assumed
that the increase in deaths registered in 2020 until 28th March in each Italian region is entirely related to the COVID-19 pandemic,
even though only a fraction was confirmed as positive. In particular, we estimated that undetected COVID-19 cases in Italy
represent 53% of the registered COVID-19 deaths (Table 1), which is consistent with other scenarios. For instance, on 17th
April 2020 the Chinese government announced that in Hubei province there are 1290 COVID-19-related deaths (occurred from
the beginning of the pandemic), which were not previously registered as COVID-19 deaths, and that represent about 40% of
the officially registered deaths [9]. This fact supports the use of the Italian estimation for all analyzed countries. Therefore, by
combining the background death records data with the measured Naïve Case fatality Rates (nCFRs) up to 10th March, ranging
from 2.26% in Germany to 18.27% in Lombardy (Italy), to obtain an aCFR of 1.4% (CI95% 1.2-1.7%) [8], it is possible to give
a reasonable estimate of the proportion of undetected cases in different regions.
We introduced in the model the public health measures, taking into account the effects of mobility changes as well as the potential
effects of adopting a personal protective behavior, like frequent hands washing and wearing a mask. The former is modelled

4

Picchiotti et al

with a decreasing logistic function, where the target plateau is the average mobility change reported by Google COVID-19
Community Mobility Report in each geographical area over the last 7 available observations (11th-17th April) and the shape is
calibrated knowing the date of the implementation of public health measures (social distancing advisement or school closures)
[1] and date of the maximum reduction of the mobility (Figure 1B-D).

A

B

C

D

Figure 1 (A) The scheme of the compartmental model: S, susceptible; E, exposed; I, infected; P, positive tested; R, recovered;
D, deaths; ∼ indicates undetected groups. (B) The method for the 𝜀(𝑡)𝜎(𝑡) logistic function building, extensively treated in
Supplementary Mehods considering both mobility and personal protective measures (PPM) effect: 𝑘, plateau level of mobility
decreasing; 𝜀(𝑡), logistic function interpolating the mobility changes; 𝛼, coefficient representing the effect of PPM; 𝑇𝑖 , start of
public health measures; 𝑏, inflection time point of 𝜀(𝑡)𝜎(𝑡) and 𝜀(𝑡) logistic functions. (C) and (D) showing the 𝜀(𝑡)𝜎(𝑡) logistic
functions (black thick lines) used in each scenario considering measured actual Google data of mobility changes, respectively
in Italian regions and across countries.

Picchiotti et al

5

The effect of the adoption of a personal protective behavior as frequent handwashing or masks wearing, recommended worldwide
[10], was derived from a metanalysis of studies performed in the context of SARS epidemic [11], estimating an Odds Ratio (OR)
of the use of masks of 0.32 (CI95% 0.25-0.40) and an OR of frequent handwashing of 0.45 (CI95% 0.36-0.57) for the risk of
infection. The models are fitted until 17th April leaving the last 7 observed days for the accuracy analysis of models’ predictions
through Mean Absolute Percentage Error (MAPE) analysis [12]. The model is deterministic, thus the reasonable confidence
intervals of fitted estimates were derived considering the CI95% of the aCFR and the CI95% of personal protective measures
ORs derived from literature data [8, 11] Mathematical details of the model, including the equations, parameters calibration and
fitting procedure are illustrated in the Supplementary Methods.

3
3.1

RESULTS
Pandemic dynamics in different geographical contexts

In the Italian scenario the undetected proportion of cases ranges from 76% in Lazio to 96% in Sardinia, being 93% for the whole
Italy (Table 1, Figure 2A). Epidemic curves obtained using the calibrated SEIR models are reported in Figure 2B; the accuracy
analysis of forecasting showed a median MAPE of 9.2% [Interquartile Range (IQR) 3.6-14.5%; range 0.9-34.8%; Table 1].
The forecasting procedure permits an estimate on 24th April of the whole fraction of infected population, including undetected
cases, ranging from 0.4% (CI 0.3-0.5%) for Campania to 13.6% (CI 13.4-13.9%) for Lombardy, being ≈ 5 to 40-fold higher than
positive tested cases, as shown in Table 1 and in heatmaps in Figure 2A. This is coherent with recent literature results estimating
the COVID-19 prevalence, until 7th April, ranging from 0.35% to 11.2% across different Italian regions [13].
In the international context the number of supposed undetected cases ranges from 60% in Germany to 92% in UK. The application
of the SEIR models, tested in the whole Italy, France, Germany, UK, Spain, and US was satisfactory, permitting also to show
the trajectories of overall cases, including undetected ones (Figure 3A). Analyzing the forecasting accuracy in the international
context, the median MAPE was 21.9% (IQR 12.3-28.8%; range 8.5-31.8%; Table 1), statistically comparable to Italian?s regions
ones (p=0.08) by Mann-Whitney test. Considering the Lewis criteria [12] for the forecasting accuracy judgement, our model
was highly accurate in 12 cases (46%), good in 7 (27%) and reasonable in 7 (27%).

0.00

0.00
0.05

2.0

5.8

4.5

1.2

5.9

Calabria

Campania

Emilia-Romagna

Friuli-Venezia Giulia

Lazio

4.65
0.49

1.5

0.3

4.4

1.6

Marche

Molise

Piedmont

Sardinia

0.53
0.53

3.7

0.9

4.9

67.0

83.0

60.3

46.9

66.7

328

Tuscany

Umbria

Veneto

France

Germany

Italy

Spain

United Kingdom

United States

76

92

91

93

60

91

85

84

89

86

90

96

92

91

91

95

90

76

82

93

79

85

95

1.38

1.27

1.92

1.17

1.72

1.71

0.91

1.48

1.74

2.26

1.53

1.62

0.93

0.90

1.77

0.97

1.01

2.50

1.53

1.10

1.79

2.20

1.47

2.07

1.77

1.96

𝛽(0)𝑃

6.6

6.1

9.2

5.6

8.3

8.2

4.4

7.1

8.4

10.8

7.3

7.8

4.4

4.3

8.5

4.6

4.9

12

7.3

5.3

8.6

10.5

7

9.9

8.5

9.4

𝑅(0)𝑃

13.9

12.7

19.3

11.7

17.3

17.1

9.1

14.9

17.5

22.7

15.3

16.2

9.3

9

17.8

9.7

10.2

25.1

15.4

11

17.9

22

14.7

20.8

17.8

19.7

𝑅(0)𝐻

12.1

12.2

18.4

11.2

13.6

16.3

8.4

13.6

16.5

21

16

19.9

9.3

8.9

16.9

9.5

9.6

21.9

13.9

10.6

16

21.2

17.8

20

18.5

18.5

𝑅(0)

8.5

24.9
100

10.2

26

18.8

30.0

31.8

5.3

34.8

2.2

9.7

12.4

29.7

12.4

7.9

18.6

8.6

0.9

2.7

3.7

13.2

3.2

28.0

31.4

2.8

12.3

3.8

MAPE (%)

10000∗

81

15

66

61

23

100

42

98

57

47

100

40

32

33

77

29

42

100

82

75

100

33

100

1∕𝛾2

905.4

143.5

219.8

193.0

155.0

158.6

17.2

1.4

8.9

6.2

3.0

1.3

23.8

0.3

6.0

71.3

7.2

6.1

2.9

24.0

4.3

1.1

0.4

3.9

1.1

2.8

24/4*1000

Actual Pos. Test.

814 (574-1415)

102.4 (84.3-139.5)

193.1 (148.8-295.6)

153.0 (129.2-202.4)

214.0 (159.8-396.4)

110.7 (84.5-170.6)

17.9 (16-21.6)

1.9 (1.5-2.8)

9.2 (7-14.3)

7.0 (5.1-11.7)

3.3 (2.7-4.7)

1.7 (1.3-2.7)

26.9 (23.9-32.2)

0.3 (0.2-0.3)

7.3 (5.5-11.3)

63.6 (55.8-78.2)

7.1 (6.1-9.1)

6.4 (4.7-11.4)

3.0 (2.4-4.5)

27.3 (23.1-35.5)

4.1 (3.3?6.0)

1.4 (1.1-2.3)

0.5 (0.4-0.7)

4.0 (2.9-6.9)

1.3 (1.0-1.9)

2.7 (2.0-4.4)

24/4*1000 (CI)

Est Pos. Test.

3785 (2949-5911)

1474 (1374-1739)

2294 (2003-3048)

2212 (2149-2476)

610 (501-1020)

1376 (1186-1852)

127 (125-128)

13 (12-16)

86 (74-116)

53 (44-78)

37 (34-45)

50 (43-68)

373 (369-377)

3.0 (3.0-3.1)

82 (70-110)

1370 (1353-1395)

77 (76-83)

29 (24-45)

17 (16-22)

426 (414-470)

21 (19-26)

10 (8-15)

11 (10-14)

63 (51-95)

12 (11-15)

26 (22-38)

24/4 *1000 (CI)

Est. Tot. Inf.

1.2 (0.9-1.8)

2.2 (2.1-2.6)

4.9 (4.3-6.5)

3.7 (3.6-4.1)

0.7 (0.6-1.2)

2.1 (1.8-2.8)

2.6 (2.5-2.6)

1.5 (1.3-1.8)

2.3 (2.0-3.1)

5.0 (4.1-7.3)

0.7 (0.7-0.9)

3.1 (2.6-4.1)

8.6 (8.5-8.7)

1.0 (1.0-1.0)

5.4 (4.6-7.2)

13.6 (13.4-13.9)

5 (4.9-5.4)

0.5 (0.4-0.8)

1.4 (1.3-1.8)

9.6 (9.3-10.5)

0.4 (0.3-0.5)

0.5 (0.4-0.7)

2.0 (1.8-2.5)

1.6 (1.3-2.4)

9.6 (8.5-12.3)

2.0 (1.7-2.9)

24/4 % (CI)

Popol. Tot. Inf.

84.0

95.3

94.4

95.6

71.5

94.6

90.7

90.2

93.0

91.1

94.1

97.7

95.1

94.4

94.2

97.1

94.1

84.2

88.4

95.9

86.6

90.3

97.1

95.9

92.9

93.3

𝐼 𝐻 ∕𝑃 (%)

83.5

95.0

94.1

95.3

70.8

94.3

90.2

89.6

92.6

90.7

93.8

97.6

94.9

94.0

93.9

96.9

93.8

83.5

87.7

95.7

85.8

89.9

97.0

95.6

92.5

92.9

𝐼 𝐻 ∕𝑇 (%)

N. population size; M, millions of inhabitants; 𝐷𝐻 ∕𝐷𝑃 , ratio between estimated undetected COVID-19 deaths and reported ones from Italian death records data, countries? values are assumed equal to whole Italian one; 𝐻, percentage fraction of undetected cases; 𝛽(0), transmission rate at time 0; 𝑅(0)𝑃 , basic

0.53

0.53

0.53

0.53

0.57

1.23

0.00

0.83

5.0

1.1

Sicily

Trentino-South. Tyrol

0.69

1.84

0.10

0.58

1.6

10.1

Liguria

Lombardy

0.00

0.65

5.00

93

89

89

𝐻(%)

ones until 24/4/2020; 𝐼 𝐻 ∕𝑇 , fraction of the overall new cases derived from undetected ones until 24/4/2020; * since 13th April 2020 public data regarding reported recovery cases are not anymore available.

reproductive number imputable to positive tested cases; 𝑅(0)𝐻 , basic reproductive number imputable to undetected cases; 𝑅(0), overall basic reproductive number; 1∕𝛾2 , fitted recovery notification time; MAPE, mean absolute percentage error; CI, reasonable confidence interval; 𝐼 𝐻 ∕𝑃 , fraction of detected cases derived from undetected

Table 1

0.26

0.6

Basilicata

0.00
1.40

0.1

4.0

Aosta

Apulia

0.30

1.3

Abruzzo

𝐷𝐻 ∕𝐷𝑃

𝑁(𝑀)

Regions

6
Picchiotti et al

7

Picchiotti et al

A

B

Figure 2 (A) Heatmaps of the Italian regions illustrating: heterogeneity across region of population size; mean mobility change
(11th-17th April 2020) compared to baseline; estimated percentage fraction of undetected COVID-19 cases; actual cumulative
fraction of population positive tested, and estimated cumulative fraction of overall infected cases (including undetected) until
24th April 2020. (B) Epidemic predicted and actual reported data in different Italian regions; overall infected and deaths include
undetected cases. The models were fitted on actual data until 17th April (black line), cumulative observed values from 18th
April to 24th April are used for judging models’ accuracy. The shadow regions represent the reasonable confidence intervals.

The best fit in each region of the recovery notification time (1∕𝛾2 ), has median value of 63 days (IQR 38-99; range 1510’000 days), possibly representing different efficiency of recovery reporting in each geographical scenario. The estimation

8

Picchiotti et al

of the basic reproductive number (𝑅0 ) was derived from the model through the Next Generation Matrix Method [14]. The
contribution of positive detected cases or undetected ones for the generation of secondary cases is weighted to obtain the overall
reproductive number (𝑅0 ), representing the overall number of newly cases generated along the infectious time of an affected
case (Table 1). The mean 𝑅0 related to detected cases (𝑅𝑃0 ) is 7.5 ± 2.1, the one related to undetected ones (𝑅𝐻
)15.7±4.5,
0
determining an overall weighted 𝑅0 value of 15.1± 4.3.

3.2

Modeling the lockdown relaxation

Knowing the daily fraction of undetected infectious cases on overall infectious ones (average 92.0±5.6%), it was possible to
estimate that until 24th April 91.8% of new positive detected cases were determined by undetected ones, these explaining the
91.4% of the total new infections (Table 1); specifically our results in the Chinese scenario (86.7% and 85.2%, respectively) are
in agreement with previous literature estimating in the same context those percentages to be 79% and 86.2%, respectively [15].
Therefore, the possibility to estimate the amount and the dynamics of undetected cases is a key point when planning to loosen
lockdown measures.
We applied our model for the Hubei case study, where on 7th April the Chinese government decided to relax the lockdown
measures, showing different possible scenarios (Figure 3B). According to our model, there were 2502 (CI 2251-3205) infectious
subjects on 7th April, most of those being undetected (96.4%). We show how the infection dynamics depend on the level of target
mobility that is restored, compared to the baseline, and on the adoption of personal protective measures. These two factors can
make the difference between a huge and rapid secondary epidemic peak or a more delayed and manageable one (Figure 3B).

4

DISCUSSION

Since its first discovery as a new human virus on January 8th in Wuhan, China, the novel severe acute respiratory syndrome
coronavirus 2 (SARS-CoV-2) has spread worldwide, determining the COVID-19 pandemic that up to 6th May 2020 has caused
over 3 588 773 confirmed cases and 245 503 death [16]. The main public health issue regarding COVID-19 disease is that 5%
to 10% of the patients need intensive care recovery with artificial ventilation for onset of pneumonia complicated with acute
respiratory distress syndrome (ARDS); as a consequence, the number of intensive care beds, which is often limited, can become

9

Picchiotti et al

A

B

Figure 3 (A) Epidemic predicted and actual reported data in different countries; overall infected and deaths include undetected
cases. The models were fitted on actual data until 17th April (black line), cumulative observed values from 18th April to 24th
April are used for judging models’ accuracy. The shadow regions represent the reasonable confidence intervals. (B) From left to
right: panel showing the estimated positive detected fitted cases in Hubei region, infectious patients (undetected or not already
detected cases) are represented with orange line with shadow showing the reasonable confidence of interval; central panel
showing the shape of different 𝜀(𝑡)𝜎(𝑡) functions after the restoration of partial or full mobility (M), with or without the use of
personal protective measures (PPM) after 7th April; the right panel showing different scenarios of overall infected secondary
epidemic peaks adopting different strategies of lockdown’s mitigation.

insufficient [17].
Despite the proven effectiveness of lockdown measures, as shown in the Chinese epidemic, the challenge is now to assess their
efficacy and to plan strategies to progressively relax them [18, 19]. Mathematical models can help to determine the trajectories

10

Picchiotti et al

of the pandemic, considering the confirmed cases and estimating the undetected ones. In particular, the SIR or SEIR compartmental models have the advantage of providing useful insights for health care decision makers and of being easily manageable
from a mathematical point of view [2, 20]. Moreover, if adequately calibrated with good literature-based parameters the simplicity of these models can avoid overfitting results [2]. The supposed proportion of undetected cases is reported to be highly
variable. Its estimation from case fatality rates was already proposed [1], but its integration with background death records data
can further improve this estimate.
In the available published literature, searching PubMed between Dec 1st 2019 and April 19th 2020, we found several papers
modelling the COVID-19 pandemic using SEIR models, most of them studying the evolution of the epidemic in Wuhan or
Hubei or in single geographical context, and proposing different scenarios depending on different transmission rates. However,
only few of them take into account a measurable effect of public health intervention (e.g., mobility changes) [21]. The work
by Gatto et. al. [21] is of major interest, as they apply a modified SEIR model (SEPIA) using data of geo-located smartphone
users to estimate the effect of lockdown intervention measures on the Italian epidemic evolution [22]. Our results in the Italian case-study report the cumulative number of overall affected cases as of March 25th and March 28th equal to 1.46*106 (CI
1.31*106-1.60*106) and 1.60*106 (CI 1.48*106-1.76*106), respectively. Our estimates have the same order of magnitude of
those by Gatto et. al (median 0.6*106 on March 25th) and those by the Imperial College Group [1] (5.9*106 on March 28th, CI
1.9*106-15.2*106), much higher than the 74?286 and 92?472 confirmed cases until these dates.
To the best of our knowledge our is the first SEIR compartmental model taking into account the mobility changes measured by
Google in order to track the effect of lockdown measures. The decreasing logistic function permitted to solve the system analytically and to integrate the effect of the adoption of personal protective measures (hand washing an masks wearing) derived
from literature estimates [11].
Fitting the recovery reporting time after the isolation of positive tested cases permitted to depict wide differences among countries (IQR 36-95 days) but also in-between Italian regions (IQR 38-99 days); of note the fitted value of 10?000 days for UK
is the consequence of the interruption of disclosing publicly recovery data since the beginning of April 2020. Recovery?s reporting time heterogeneity is of main interest as the removal time of recovered individuals is expected to influence the shape
of the epidemic curves of active cases before and after relaxing the lockdown measures. Furthermore, as shown in the Hubei
case-study (Figure 3B), the outputs of our model in term infectious groups (undetected or not already confirmed cases) can be

Picchiotti et al

11

used to draw possible different trajectories of secondary epidemics after the abolishment or mitigation of mobility restrictions,
considering different kind of self-protective behavior.

5

CONCLUSIONS

Even though specific and quantitative predictions from a mathematical model need to be taken with caution, some key messages
can be derived, as the estimation and the evolution of complex phenomena that are hardly imaginable by the common sense, for
instance the hidden dynamic of undetected cases parallel to the dynamic of detected ones [23]. Despite having some limitations,
not considering spatial-temporal dynamics and stochastic features, the main advantage of our system is its easy application,
that can be even improved by further updating mobility information, nowadays publicly available, and acquiring region-specific
background death records data.

6

FUNDING

None.

7

CONFLICTS OF INTEREST

None declared.

8

ETHICS APPROVAL

Because this study involved the use of publicly available aggregate data, approval by a research ethics board was not required.

9

DATA AVAILABILITY

All data used in this manuscript are publicly available. COVID-19 epidemiological data for Italy are available at
https://github.com/pcm-dpc/COVID-19, and for countries at https://github.com/CSSEGISandData/COVID-19. Italian death
records data are available at https://www.istat.it/it/archivio/240401#Decessidel2020-0, (downloaded on 11th April 2020).

12

Picchiotti et al

Google COVID-19 Community Mobility Report are available at https://www.google.com/covid19/mobility/ (downloaded on
23rd April 2020).

10

SUPPLEMENTARY METHODS

Herein, we introduce the mathematical details of the epidemiological model presented in this study. It is a modified version of
the well-known SEIR (susceptible-exposed-infected-recovered) compartmental model, accounting both for specific features of
the COVID-19 infection and for the impact of public health protective measures on the dynamic of the transmission rate. The
population is divided into nine classes representing the possible states of the individual in relation to the diseases:

• Susceptible (S), it is the class containing individuals that can potentially contract the disease;

• Exposed (E), includes individuals that have been exposed to disease (infected) but are not yet capable of transmission (not

yet infectious);

• Infected (I), includes individuals that are both infected and infectious;

• Positive Tested (P), contains individuals recognized as positive by the health national system and assumed to be well

isolated (either hospitalized or quarantined) and not infectious anymore;

• Recovered (R), includes subjects healed and whose recovery is notified by the health system;

• Dead (D);

̃ includes subjects affected by the disease (either asymptomatic or symptomatic) but not officially
• Hidden Infected (𝐼),
tested and registered as infected by the health national system;

̃ includes individuals recovered form the disease, but previously not registered as positive by the
• Hidden Recovered (𝑅),
health national system;

̃ includes individuals not officially registered by the health national system, who were infected and died;
• Hidden Dead (𝐷)

13

Picchiotti et al

The mathematical model is described by the following set of nine ordinary differential equations (ODEs), representing the time
rates of change of the introduced variables in a population of size 𝑁:
̃
𝐼(𝑡) + 𝐼(𝑡)
𝑑𝑆
= −𝛽(𝑡) 𝑆(𝑡)
𝑑𝑡
𝑁
̃
𝐼(𝑡) + 𝐼(𝑡)
𝑑𝐸
= 𝛽(𝑡) 𝑆(𝑡)
− 𝜂𝐸(𝑡)
𝑑𝑡
𝑁

(1)
(2)

𝑑𝐼
= (1 − 𝑝ℎ ) 𝜂 𝐸(𝑡) − 𝛾1 𝐼(𝑡)
𝑑𝑡

(3)

𝑑𝑃
= 𝛾1 𝐼(𝑡) − (1 − 𝑝𝑑 ) 𝛾2 𝑃 (𝑡) − 𝑝𝑑 𝜃𝑃 (𝑡)
𝑑𝑡

(4)

𝑑𝑅
= (1 − 𝑝𝑑 ) 𝛾2 𝑃 (𝑡)
𝑑𝑡

(5)

𝑑𝐷
𝑑𝑡
𝑑 𝐼̃
𝑑𝑡
𝑑 𝑅̃
𝑑𝑡
𝑑 𝐷̃
𝑑𝑡

= 𝑝𝑑 𝜃 𝑃 (𝑡)

(6)

̃ − 𝑝̃𝑑 𝜃̃ 𝐼(𝑡)
̃
= 𝑝ℎ 𝜂 𝐸(𝑡) − (1 − 𝑝̃𝑑 ) 𝛾̃ 𝐼(𝑡)

(7)

̃
= (1 − 𝑝̃𝑑 ) 𝛾̃ 𝐼(𝑡)

(8)

̃
= 𝑝̃𝑑 𝜃̃ 𝐼(𝑡)

(9)

In the equations above, the number of Susceptible individuals (𝑆) decreases over time due to contacts with the infectious
̃ The force of the infection is driven by the transmission rate parameter 𝛽 defined as the probability of disease
population (𝐼 + 𝐼).
transmission in a single contact times the average number of contacts per unit time per person.All the other parameters represent
the rates at which individuals pass from a compartment to the subsequent one; they can be seen as the inverse of the number
of days on average spent in the former class. Specifically, for an Exposed individual, 𝜂 is the rate of change from the class 𝐸
̃ ones. 𝛾1 is the rate of change from the Infected class 𝐼 to the 𝑃 class. The
to either the Infected (𝐼) or the hidden Infected (𝐼)
parameter 𝛾2 and 𝛾̃ represent, respectively, the recovery rate of a hidden infected or the recovery’s notification rate by the health
system of a positive tested subject. Similarly, 𝜃 and 𝜃̃ are the mortality rates.
As said before, the number of days spent in each class is given by the inverse of the corresponding rate: the incubation period
𝑡𝜂 = 𝜂 −1 , the infectious period of visible Infected 𝑡𝛾1 = 𝛾1−1 , the average diagnosis time for an Exposed individual to being
Positive tested 𝑡𝛾2 = 𝛾2−1 and the average dead period of both Positive tested 𝑡𝜃 = 𝜃 −1 and hidden Infectious 𝑡𝜃̃ = 𝜃̃ −1 . The
recovery periods of the hidden infectious is given by 𝑡𝛾̃ = 𝛾̃ −1 . We stress the fact that the recovery period of the visible infected
(
)−1
individual is given by 𝑡𝛾 = 𝛾1 + 𝛾2 .
As regards the other parameters, 𝑝𝑑 and 𝑝̃𝑑 represents the probability for an individual respectively in 𝑃 or 𝐼̃ to end in the

14

Picchiotti et al

̃ whereas the parameter 𝑝ℎ is the fraction of 𝐸 that becomes Hidden Infectious 𝐼.
̃ In Figure 1A of the main
dead class 𝐷 or 𝐷,
text we report the compartmental diagram illustrating the model, as well as the introduced parameters. The ODEs system is
supplemented by the initial conditions:
̃ = 𝐼̃0 ,
𝑆(0) = 𝑆0 , 𝐼(0) = 𝐼0 , 𝐼(0)
and
̃
̃
𝐸(0) = 𝑃 (0) = 𝑅(0) = 𝐷(0) = 𝑅(0)
= 𝐷(0)
= 0.
̃ 𝐷 and 𝐷̃ are cumulative and that the system has the mass conservation property: since
Note that the variables 𝑅, 𝑅,
𝑑𝑅 𝑑𝐷 𝑑 𝐼̃ 𝑑 𝑅̃ 𝑑 𝐷̃
𝑑𝑆 𝑑𝐸 𝑑𝐼 𝑑𝑃
+
+
+
+
+
+
+
+
=0
𝑑𝑡
𝑑𝑡
𝑑𝑡
𝑑𝑡
𝑑𝑡
𝑑𝑡
𝑑𝑡
𝑑𝑡
𝑑𝑡
the total population is constant over time:
̃ + 𝑅(𝑡)
̃ + 𝐷(𝑡)
̃ = 𝑁.
𝑆(𝑡) + 𝐸(𝑡) + 𝐼(𝑡) + 𝑃 (𝑡) + 𝑅(𝑡) + 𝐷(𝑡) + 𝐼(𝑡)

The time dependent transmission rate
The main novelty of our approach is the introduction of a time-dependent transmission rate. Specifically, we suppose that the
transmission rate decreases over time as a consequence of the implementation of mobility reduction and of the adoption of
personal protective measures. It is important to recall that 𝛽(𝑡) can be seen as the product of the average number of contacts per
unit time, denoted as 𝜆(𝑡), and of the probability of transmission per contact 𝜌(𝑡):
𝛽(𝑡) = 𝜆(𝑡) 𝜌(𝑡).
In our model, the average number of contacts is described by considering an initial constant value 𝜆0 reduced over time by a
decreasing function 𝜖(𝑡) with 𝜖(0) = 1:
𝜆(𝑡) = 𝜆0 𝜖(𝑡).
Similarly, for the probability of transmission we have:
𝜌(𝑡) = 𝜌0 𝜎(𝑡).
The modelling of the mobility time dependent part 𝜖(𝑡) is given by a decreasing logistic function with a plateau defined as:
𝜖(𝑡) =

𝐶(𝑎, 𝑏)
+ 𝑘,
1 + 𝑒 𝑎 (𝑡−𝑏)

(10)

15

Picchiotti et al

where the normalization constant granting 𝜖(0) = 1 is:
(
)
𝐶(𝑎, 𝑏) = 1 + 𝑒−𝑎 𝑏 (1 − 𝑘).
In Eq.(10), the parameter 𝑏 is the abscissa of the inflection point and the parameter 𝑎 is related to the first derivative calculated
in that point, that is the steepness of the function. The parameter 𝑘 is the plateau of the function:
𝑘 = lim 𝜖(𝑡).
𝑡→inf

The parameter 𝑘 is calibrated using the Google COVID-19 Community Mobility Report data by computing the average mobility
changes for the period 11th-17th April for the four categories: retail and recreation, grocery and pharmacy, transit stations and
workplaces mobility. As regards the second effect of personal protective measures, we do not assume an explicit behaviors of the
𝜎(𝑡) function. Instead, we incorporated its effect as a reduction of the plateau 𝑘. The consequent transformation of the mobility
decreasing function can be described by considering the aggregate product of both the time dependent terms as:
(
𝜖(𝑡) ⋅ 𝜎(𝑡) ∶= 𝛼

)
𝐶
+ 𝑘 + (1 − 𝛼).
1 + 𝑒 𝑎 (𝑡−𝑏)

(11)

Note that, despite this transformation, the second derivative is invariant and the abscissa of the inflection point is still the same
of 𝜖(𝑡). In order to fit the function 𝜆 with the actual data, we note that the derivative in the inflection point is equal to
𝛼 𝐶(𝑎, 𝑏) 𝑎
𝑑𝜆 |
.
| =−
𝑑𝑡 |𝑡=𝑏
4
Let us denoted as (𝑇𝑖 , 1) the point where the tangent line in the inflection point meets the horizontal line 𝑦 = 1. The derivative
in the inflection point can be written as:
𝜆(𝑏) − 1
𝑑𝜆 |
=
| =
𝑑𝑡 |𝑡=𝑏
𝑏 − 𝑇𝑖

𝛼

(

𝐶
2

)
+ 𝑘 + (1 − 𝛼) − 1
𝑏 − 𝑇𝑖

Since 𝑏 can be retrieved from the Google COVID-19 Community Mobility Report data and 𝑇𝑖 from the public information on
the starting day of protective measures (i.e., first date in-between school closures and social distancing advisement), we are able
to compute the parameter 𝑎 by solving the transcendental equation:
(
)
𝐶(𝑎,𝑏)
𝛼
+
𝑘
+ (1 − 𝛼) − 1
2
𝑎 𝐶(𝑎, 𝑏) 𝑎
−
=
.
4
𝑏 − 𝑇𝑖
The initial date of the transition can be written as a function of 𝑎 and 𝑏:
𝑇𝑖 =

4
𝑎𝐶

(

)
𝐶
+𝑘−1 +𝑏
2

16

Picchiotti et al

and similarly, the final date 𝑇𝑓 of the transition is:
𝑇𝑓 =

2
+ 𝑏.
𝑎

In Figure 1B of the main text we report with a dashed line an example of the 𝜖(𝑡) function introduced in Eq.10, with the solid
one the function 𝜖(𝑡) ⋅ 𝜎(𝑡) of Eq. 11 and in blue the function defined by the derivative in the inflection point between 𝑇𝑖 and 𝑇𝑓 :
⎧
⎪1
(
)
⎪ 𝛼𝑎𝐶
𝐶
⎨− 4 𝑡+𝛼 2 +𝑘 +
⎪
⎪ 𝛼(𝑘 − 1) + 1
⎩

𝑡 ≤ 𝑇𝑖
𝛼𝑎𝑏𝐶
4

𝑇𝑖 ≤ 𝑡 ≥ 𝑇𝑓
𝑡 ≥ 𝑇𝑓

The parameters 𝛽0 = 𝜆0 𝜌0 and 𝛾2 are obtained with the minimum least squares fit of the resulting model curves (𝑃 ) and (𝑅) with
actual dataset of Positive Tested and Recovered (a weight of 80% is setted for the Positive Tested loss). The fitting procedure is
done by exploiting the Pyton Scipy routine solve_ivp.

Computation of the 𝑅0 parameter through the Next Generation Matrix Method
The parameter 𝑅0 is defined as the âĂŸaverage number of secondary cases arising from a typical primary case in an entirely
susceptible population. We exploit the next generation matrix method (Van den Driessche et al, 2002) in order to obtain a formula
for the computation of the 𝑅0 in our model framework. Let us consider only the compartments with individuals that are in any
stage of the infection and are infectious. In our model those are the Exposed (𝐸), the Infectious (𝐼) and the Hidden Infectious
̃ individuals. The vector 𝑥 represents the populations of these three compartments, 𝑥 = (𝐸, 𝐼, 𝐼).
̃ With 𝑦 we denote the vector
(𝐼)
̃ 𝐷).
̃ It is important to recall that at the disease-free equilibrium (DFE) point
of all the other compartments, 𝑦 = (𝑆, 𝑃 , 𝑅, 𝐷, 𝑅,
(𝑥∗ , 𝑦∗ ) there are no infected individuals in the population, 𝑥∗ = (0, 0, 0), and the entire population is susceptible to the infection,
𝑦∗ = (𝑁, 0, 0, 0, 0, 0). Let 𝑖 be the vector representing the rates of appearance of new infections in compartment 𝑖 and 𝑖 the
rate of transfer of individuals into or out of compartment 𝑖. The system of equations (2)(3)(7) can be written as:
𝑑𝑥
=  (𝑥) − (𝑥)
𝑑𝑡
where
⎡
𝐼+𝐼̃ ⎤
⎢𝛽0 𝑆 𝑁 ⎥
⎥
⎢
 =⎢ 0 ⎥
⎢
⎥
⎢
⎥
⎢ 0 ⎥
⎦
⎣

17

Picchiotti et al

and
⎡
⎤
0
⎢
⎥
⎢
⎥
⎥.
 =⎢
−(1 − 𝑝ℎ ) 𝜂 𝐸 + 𝛾1 𝐼
⎢
⎥
⎢
⎥
⎢−𝑝 𝜂 𝐸 + (1 − 𝑝̃ ) 𝛾̃ 𝐼̃ + 𝑝̃ 𝜃̃ 𝐼̃⎥
𝑑
𝑑
⎣ ℎ
⎦

Then, the Jacobians in the DFE point (𝑥∗ , 𝑦∗ )

]

[

𝜕𝑖 ∗ ∗
(𝑥 , 𝑦 )
𝐹 =
𝜕𝑥𝑗

[

]

𝜕𝑖 ∗ ∗
𝑉 =
(𝑥 , 𝑦 )
𝜕𝑥𝑗

are computed for both the vectors as
⎡
⎤
⎢0 𝛽 𝛽 ⎥
⎢
⎥
𝐹 = ⎢0 0 0⎥
⎢
⎥
⎢
⎥
⎢0 0 0⎥
⎣
⎦
and
⎤
⎡
𝜂
0
0⎥
⎢
⎥
⎢
⎥
𝑉 = ⎢−(1 − 𝑝 )𝜂
0
𝜇⎥
ℎ
⎢
⎥
⎢
⎢ −(𝑝 )𝜂 𝑝̃ 𝜃̃ + (1 − 𝑝̃ )̃𝛾 0 ⎥
ℎ
𝑑
𝑑
⎦
⎣
The 𝑅0 is given by the spectral radius of the next generation matrix
(
)
𝑅0 = 𝜌 𝐹 𝑉 −1
giving
𝑅0 = (1 − 𝑝ℎ )

𝛽0
𝛽0
+ 𝑝ℎ
.
̃
𝛾1
𝑝̃𝑑 𝜃 + (1 − 𝑝̃𝑑 ) 𝛾̃

We note that the 𝑅0 formula is a weighted average of the visible infectious contribute

𝛽0
𝛾1

and the hidden one

𝛽0
.
̃
𝑝̃𝑑 𝜃+(1−
𝑝̃𝑑 ) 𝛾̃

Model analysis, simulations and graphs plotting are performed using Python (Python Software Foundation. Python Language
Reference, version 3.7. Available at http://www.python.org) and R (version 3.6.3).

References
1. Flaxman, S. et al. Report 13: Estimating the number of infections and the impact of non-pharmaceutical interventions on
COVID-19 in 11 European countries (2020).

18

Picchiotti et al

2. Pétard, H. A contribution to the mathematical theory of big game hunting. Amer. Math. Monthly 45, 446–447 (1938).
3. Dong, E., Du, H. & Gardner, L. An interactive web-based dashboard to track COVID-19 in real time. The Lancet infectious
diseases (2020).
4. Lauer, S. A. et al. The incubation period of coronavirus disease 2019 (COVID-19) from publicly reported confirmed cases:
estimation and application. Annals of internal medicine (2020).
5. Kraemer, M. U. et al. The effect of human mobility and control measures on the COVID-19 epidemic in China. Science
368, 493–497 (2020).
6. Wang, Y. et al. Clinical Outcomes in 55 Patients With Severe Acute Respiratory Syndrome Coronavirus 2 Who Were
Asymptomatic at Hospital Admission in Shenzhen, China. The Journal of Infectious Diseases (2020).
7. Verity, R. et al. Estimates of the severity of coronavirus disease 2019: a model-based analysis. The Lancet Infectious
Diseases (2020).
8. Shim, E., Mizumoto, K., Choi, W. & Chowell, G. Estimating the risk of COVID-19 death during the course of the outbreak
in Korea, February-March, 2020. medRxiv (2020).
9. Organization, W. H. Practice BB. Coronavirus disease 2019 (COVID-19) Situation Report ? 88, 2633 (2020).
10. WHO. Coronavirus disease (COVID-19) advice for the public. https://www.who.int/emergencies/diseases/novelcoronavirus-2019/advice-for-public.
11. Jefferson, T. et al. Physical interventions to interrupt or reduce the spread of respiratory viruses: systematic review. Bmj
336, 77–80 (2008).
12. Lewis, C. D. Industrial and business forecasting methods: A practical guide to exponential smoothing and curve fitting
(Butterworth-Heinemann, 1982).
13. Signorelli, C., Scognamiglio, T. & Odone, A. COVID-19 in Italy: impact of containment measures and prevalence
estimates of infection in the general population. Acta Bio-medica: Atenei Parmensis 91, 175–179 (2020).
14. Van den Driessche, P. & Watmough, J. Reproduction numbers and sub-threshold endemic equilibria for compartmental
models of disease transmission. Mathematical biosciences 180, 29–48 (2002).

Picchiotti et al

19

15. Li, R. et al. Substantial undocumented infection facilitates the rapid dissemination of novel coronavirus (SARS-CoV-2).
Science 368, 489–493 (2020).
16. Organization, W. H. Practice BB. World Health Organization - Coronavirus disease 2019 Situation Report ? 107, 489–493
(2633).
17. Remuzzi, A. & Remuzzi, G. COVID-19 and Italy: what next? The Lancet (2020).
18. Wu, Z. & McGoogan, J. M. Characteristics of and important lessons from the coronavirus disease 2019 (COVID-19)
outbreak in China: summary of a report of 72 314 cases from the Chinese Center for Disease Control and Prevention.
Jama 323, 1239–1242 (2020).
19. Wilder-Smith, A. & Freedman, D. O. Isolation, quarantine, social distancing and community containment: pivotal role for
old-style public health measures in the novel coronavirus (2019-nCoV) outbreak. Journal of travel medicine 27, taaa020
(2020).
20. Blackwood, J. C. & Childs, L. M. An introduction to compartmental modeling for the budding infectious disease modeler.
Letters in Biomathematics 5, 195–221 (2018).
21. Gatto, M. et al. Spread and dynamics of the COVID-19 epidemic in Italy: Effects of emergency containment measures.
Proceedings of the National Academy of Sciences (2020).
22. Pepe, E. et al. COVID-19 outbreak response: a first assessment of mobility changes in Italy following national lockdown.
medRxiv (2020).
23. Jewell, N. P., Lewnard, J. A. & Jewell, B. L. Predictive mathematical models of the covid-19 pandemic: Underlying
principles and value of projections. JAMA (2020).

