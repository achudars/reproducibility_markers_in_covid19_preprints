UNCERTAINTY-DRIVEN ENSEMBLES OF DEEP ARCHITECTURES FOR MULTICLASS
CLASSIFICATION. APPLICATION TO COVID-19 DIAGNOSIS IN CHEST X-RAY IMAGES
Juan E. Arco1,∗ , Andrés Ortiz2 , Javier Ramı́rez1 , Francisco J. Martı́nez-Murcia2 ,
Yu-Dong Zhang3 , Juan M. Górriz1
1

Department of Signal Theory, Networking and Communications, Universidad de Granada
Department of Signal Theory, Networking and Communications, Universidad de Malaga
3
School of Informatics, University of Leicester, Leicester, LE1 7RH, Leicestershire, UK

arXiv:2011.14894v1 [eess.IV] 27 Nov 2020

2

ABSTRACT
Respiratory diseases kill million of people each year. Diagnosis of these pathologies is a manual, time-consuming process
that has inter and intra-observer variability, delaying diagnosis and treatment. The recent COVID-19 pandemic has demonstrated the need of developing systems to automatize the
diagnosis of pneumonia, whilst Convolutional Neural Network (CNNs) have proved to be an excellent option for the automatic classification of medical images. However, given the
need of providing a confidence classification in this context it
is crucial to quantify the reliability of the model’s predictions.
In this work, we propose a multi-level ensemble classification system based on a Bayesian Deep Learning approach in
order to maximize performance while quantifying the uncertainty of each classification decision. This tool combines the
information extracted from different architectures by weighting their results according to the uncertainty of their predictions. Performance of the Bayesian network is evaluated in
a real scenario where simultaneously differentiating between
four different pathologies: control vs bacterial pneumonia vs
viral pneumonia vs COVID-19 pneumonia. A three-level decision tree is employed to divide the 4-class classification into
three binary classifications, yielding an accuracy of 98.06%
and overcoming the results obtained by recent literature. The
reduced preprocessing needed for obtaining this high performance, in addition to the information provided about the reliability of the predictions evidence the applicability of the
system to be used as an aid for clinicians.
Index Terms— Pneumonia; COVID-19; Bayesian Deep
Learning; Uncertainty; Ensemble classification.
1. INTRODUCTION
Respiratory illness is the most common cause of death and disability in the world. According to the World Health Organization (WHO), tuberculosis kills 1.4 million people each year,
whereas pneumonia is a leading cause of death among children under 5 years old (World Health Organization, 2017). Although the rate of pneumonia is decreasing worldwide (World
*

Corresponding author: jearco@ugr.es

Health Organization, 2016), an annual fatality rate of approximately 4 million is still observed. This disease is a form
of acute respiratory infection that affects lungs, and based
on the infectious pathogen, it can be bacterial, viral and fungal (Gilani et al., 2012). Doctors can identify the presence
of pneumonia from a wide range of medical imaging such
as computed tomography (CT) (Feng et al., 2015), chest Xray (CXR) (Kunz et al., 2018) or magnetic resonance imaging (MRI) (Syrjala et al., 2017). The quality improvement
in X-ray imaging and its low cost has popularized the use
of CXR as a diagnostic tool for pneumonia. However, this is
not a straightforward task and success in pneumonia detection depends on many factors. One of the most important ones
is that diagnosis is still largely dependent on the expertise of
the radiologist (Chandra et al., 2020). The pathology associated with pneumonia is often overlapping with other abnormal conditions of the lungs. Besides, the complex and vague
anatomical structures in the lung fields can also affect the expert’s opinion (Maduskar et al., 2015). This leads to a manual,
time-consuming process that has inter and intra-observer variability, which may delay diagnosis and treatment. The use of
image processing methods along with machine learning algorithms directed to find disease-related patterns play a decisive
role in the improvement of the diagnosis accuracy.
Previous works have employed machine learning (ML) algorithms for the automatic detection of a wide range of pathologies such as Parkinson’s or Alzheimer’s disease (CastilloBarnes et al., 2018; Górriz et al., 2020; Zhang et al., 2020b),
and most recently, pneumonia (Chandra et al., 2020; Elaziz
et al., 2020; Wang et al., 2021a; Zhang et al., 2020). In this direction, CAD (computer-aided diagnosis) systems can be an
excellent tool for overcoming the weakness of current procedures for detecting pneumonia. In fact, they can assist radiologists by reducing their workload, serving as an B-reader in
diagnosis and reducing the variability across doctors. Classification systems employed in CAD tools have the following general structure: i) delimitation of the regions of interest (ROI)
to focus the analysis on them, ii) features extraction from these regions, iii) classification based on those features (Jaeger
et al., 2014; Liu and Pang, 2020; Xu et al., 2006). Since pneu-

monia affects lungs, it seems obvious that the ROI must delimit the shape and boundaries of lungs (Hogeweg et al., 2015;
Van Ginneken et al., 2001). Several studies have provided different methods for lung segmentation (Ahmad et al., 2015;
Candemir et al., 2014; Guan and Huang, 2020; Hassen et al.,
2013; J et al., 2017; Vajda et al., 2018; Yang et al., 2018). Ahmad et al. (2015) proposed an unsupervised approach based
on Gaussian derivatives filters and Fuzzy C-Means clustering.
This method demonstrated not only good performance measures (accuracy of 0.9) but also robustness and speed. Regardless how features are computed they are then classified using
a specific algorithm. Previous studies have successfully employed a wide range of classifiers for the detection of pulmonar diseases, such as DT (Decision Tree,Porcel et al., 2008;
Zhang et al., 2020a), NB (Naı̈ve Bayes, Chapman et al., 2011;
Ma et al., 2015), or KNN (k-Nearest Neighbors (KNN), Ajin
and Mredhula, 2017; Chen et al., 2015). However, literature
has shown that Support Vector Machine (SVM) (Gu et al.,
2018; Yahyaoui and Yumusak, 2018) usually outperforms the
other algorithms (Chandra et al., 2020; Uppaluri et al., 1999).
Unlike classical methods based on the extraction of predefined features, deep neural networks build a specific feature
space for the optimal class separation by means of a learning
process. The emergence of these approaches has revolutionized the automatic classification of medical images. Recently, a number of studies have demonstrated the high flexibility
and performance that this approach provides (Kermany et al.,
2018; Mittal et al., 2020; Varshni et al., 2019; Wang et al.,
2017). Rajpurkar et al. (2017) proposed a 121-layer convolutional neural network (CNN) to identify pneumonia and localize the most indicative areas of this pathology. The algorithm
provided a relatively low accuracy (76.8%), but it was able to
distinguish between 14 different pathologies. Other works have utilized transfer learning on the ImageNet dataset, yielding
an accuracy of 82%, 87% and 92% for Xception, VGG16 and
VGG19 models, respectively (Abiyev and Ma’aitah, 2018).
It is clear that deep learning models can effectively identify
the presence of a certain pathology. However, there are some scenarios where they take a decision (i.e. if a patient suffers from pneumonia or not) even though they do not know
the answer since the classification outcome only relies on the
most activated neuron of the output layer. Kendall and Gal
(2017) demonstrated the need of evaluating the uncertainty
of a model’s predictions in order to improve the decisions of
the system. Bayesian deep learning models offer a practical
solution for understanding the uncertainty of the decisions of
a deep learning model (Gal, 2016). Specifically, they model
a combination of aleatoric and epistemic uncertainty in order
to increase loss robustness to noisy data, which usually leads
to a boost in performance (Kendall and Gal, 2017). Most importantly, the additional information related to the reliability
of the classification results makes this alternative quite interesting for being used in situations where the consequences of
an error could be critical.

The recent COVID-19 pandemic has demonstrated the
need of developing systems to automatize the diagnosis of
pneumonia. It seems clear that a wrong diagnosis can have a
dramatic effect in patient’s health. In this work, we employ
an ensemble classification system based on a Bayesian Deep
Learning approach in order to maximize performance while
quantifying the uncertainty of each classification decision. In
particular, we combine seven CNN with the same structure,
but differing in the kernel sizes of their convolutional layers.
This allows the classification system to extract relevant features of different size and shape. The global classification is
performed by combining the predictions of the different classifiers. The contribution of each individual classifier depends
on the uncertainty of their predictions: the lower the uncertainty, the higher the weight, and vice versa. Performance of
the Bayesian network is evaluated in a range of real scenarios of incremental difficulty: from the simplest one where
trying to distinguish between control vs pneumonia patients
to a multiclass context where simultaneously differentiating between four different pathologies: control vs bacterial
pneumonia vs viral pneumonia vs COVID-19 pneumonia.
The main contributions of our work can be summarized as
follows:
• A novel and accurate tool for the automatic diagnosis
of pneumonia, in addition to the identification of the
cause of the pathology (bacteria, virus, COVID-19).
• The Bayesian nature of the Residual Network proposed
in this work quantifies the reliability of the classification predictions.
• The combination of networks with different kernel sizes allows the identification of pneumonia patterns regardless of their shape and extension.
• Our approach employs the uncertainty of the predictions of each individual classifier to weigh their contribution to the ensemble global decision.
2. MATERIAL
2.1. Dataset
We have used the dataset available in Kaggle (2020b) for
controls and patients who suffered from a bacterial or a noCOVID19 pneumonia. According to the information described in Kermany et al. (2018), the CXR images were selected
from retrospective cohorts of pediatric patients of one to five
years old from Guangzhou Women and Children’s Medical
Center, Guangzhou. All CXR images were obtained as part
of patient’s routines clinical care. Institutional Review Board
(IRB)/Ethics Committee approvals were obtained. The work
was conducted in a manner compliant with the United States
Health Insurance Portability and Accountability Act (HIPAA)

Control

Covid-19 Pneumonia

Viral Pneumonia

Bacterial Pneumonia

Fig. 1. From left to right, CXR image of a control, bacterial pneumonia, viral pneumonia and COVID-19 pneumonia. Note
some clear artifacts in COVID-19 image.
and was adherent to the tenets of the Declaration of Helsinki. Kermany et al. (2018) collected and labeled a total of
6374 CXR images from children, including 4273 characterized as depicting pneumonia and 1583 normal. From those patients diagnosed with pneumonia, 2786 were labeled as bacterial pneumonia, whereas 1487 were labeled as viral pneumonia. The dataset containing COVID-19 patients is available in
Kaggle (2020a) and includes 576 CXR images from adults.
Figure 1 shows the CXR image from a control (CTL), and a
patient suffering from a bacterial (BAC), a viral (VIR) and a
COVID19 (CVD19) pneumonia.
2.2. Image preprocessing
When working with medical images, it is crucial to apply a
preprocessing that improves the subsequent classification performance.This is especially important in CXR images, where
low X-ray radiation and movement during image acquisition
result in noisy and low-resolution images. However, this preprocessing must adapt images to the needs of the neural network. Due to computational and memory requirements, we
downsampled the input images to obtain a final map of size
224x224. We also performed an intensity normalization procedure for each individual image based on standardization.
Each image was transformed such the resulting distribution
has a mean (µ) of 0 and a standard deviation (σ) of 1, as follows:
I0 =

I −µ
σ

(1)

where I is the original image and I’ is the resulting one.
3. METHODS

This architecture emerged as an attempt of replicating the behavior of neurons. Briefly, CNNs combine different steps based on convolution and pooling to allow the identification of
different patterns and low and high-level features (Martı́nezMurcia et al., 2018; Payan and Montana, 2015). The main
component of a CNN is known as convolutional layer. This
operator takes the tensor Vi−1 containing the activation map
of the previous layer i − 1. Thus, the target layer (i) learns a
set of N filters Wi with a bias term bi , as follows:
Vi = fa (Wi ∗ Vi−1 + bi )

(2)

where fa (∗) is the activation function (Martı́nez-Murcia et al.,
2018). For a three-dimensional environment (Vi−1 ) of size
H ×W ×D×C (height, width, depth and number of channels,
respectively), Wi is of size P × Q × R × S × K where K
is the number of filters. The kth convolution term for the kth
filter is

Wik ∗ Vi−1 =

P
−1 Q−1
X
X
X R−1

[Wik (P − u, Q − v, R − w)

u=0 v=0 w=0

Vi−1 (x + u, y + v, z + w)]
(3)
Once convolution is performed, the activation of the filters
in layer i are stored and passed to the next layer i + 1. It
is of great importance to set properly the values for all the
hyperparameters, striking a balance between performance and
model complexity. One of these parameters is the number of
filters: the higher this number is, the more patterns the model
is able to learn. There is no consensus in literature about the
ideal number of filters, probably because different problems
need CNNs with different configurations, but numbers that
are a power of 2 are usually taken.

3.1. Deep learning
The use of algorithms based on deep learning has revolutionized the analysis of medical images (Krizhevsky et al., 2012;
Martı́nez-Murcia et al., 2018; Ortiz et al., 2016; Segovia et al.,
2016). From the ImageNet classification benchmark (Schmidhuber, 2015), CNNs have been used more than any other pattern recognition algorithm in medical image classification.

3.2. Bayesian Deep learning
Despite the high performance that Deep Learning models have demonstrated, recent works have claimed the need of computing the uncertainty of a model, a measure that allows to
identify situations where the classifier does not know the answer. To do so, it would be necessary to estimate the level of

uncertainty of a prediction in order to reject it in case its value
was too high. Bayesian deep learning offers a framework for
understanding uncertainty with deep learning models (Wang
and Yeung, 2016). There are two main types of uncertainty
that can be estimated in Bayesian modeling: epistemic and
aleatoric (Gal, 2016; Kiureghian and Ditlevsen, 2009). Epistemic uncertainty is inherent to the model, which means that
it can be reduced by increasing the data processed by the model. Estimating the epistemic uncertainty requires to model
distributions over the different parameters of the model. This
allows to optimize the network according to the average of all
possible weights.
Let x be a feature vector and W the weights of a Bayesian Neural Network (BNN). Considering the output of the
network as f W (x), the model likelihood can be defined as
p(y|f W (x)). For a given dataset X = {x1 , · · · , xN }, Y =
{y1 , · · · , yN }, the Bayesian inference computes the posterior
probability over the weights p(W|X, Y).
Cipolla et al. (2018) demonstrated that applying dropout
before every weight layer in a neural network is mathematically equivalent to an approximation to the probabilistic
deep Gaussian process (Damianou and Lawrence, 2013).
Briefly, they showed that the dropout objective minimizes the
Kullback-Leibler divergence between an approximate distribution and the posterior one of a deep Gaussian process. A
popular technique relies on the use of Monte Carlo dropout
sampling to place a Bernoulli distribution over the network’s
weights. Dropout is widely used as a regularization procedure during training (Srivastava et al., 2014). However, when
applied during the testing phase, this method allows to obtain
a distribution for the output predictions (Jospin et al., 2020;
Li and Gal, 2017). The statistics of this distribution reflect the
model’s epistemic uncertainty.
Aleatoric uncertainty is usually referred as the uncertainty inherent to the data, and can be divided into two subcategories: i) homoscedatic uncertainty, which remains stable
for every input of the model; and ii) heteroscedastic, which
assumes that noise varies for the different inputs of the model
(Le et al., 2005; Nix and Weigend, 1994). Heteroscedastic
uncertainty can be modeled by modifying the loss function
used by the neural network. Since this uncertainty is a function of the input data, employing a deterministic mapping
from inputs to model outputs can allow the estimation of the
uncertainty. For a typical Euclidean loss L = ||y − ŷ||2 , the
2
+ 21 log σ 2 . In
Bayesian version will be given by L = ||y−ŷ||
2σ 2
the latter one, the model predicts both ŷ and variance σ 2 , so
that if model prediction is not good, the residual term will be
attenuated by increasing σ 2 . Therefore, the term log σ 2 prevents uncertainty growing until infinite, leading to a learned
loss attenuation. The process for homoscedastic uncertainty
is essentially the same, but considering the uncertainty like a
free parameter instead of a model output.
In this work, we have employed a Bayesian version of
the ResNet-18 CNN (He et al., 2016). The output layer con-

tained 2 neurons with softmax activation. Besides, dropout
was used to prevent overfitting, and Batch Normalization for
convergence. The Bayesian nature of this net is obtained by
replacing the deterministic weights along the network by a
distribution over these parameters.This means that instead of
optimising the network weights, an average of all possible
weights was computed. As a result, the loss function depends
on two factors: the softmax values (as in the non-Bayesian
modality) and the Bayesian categorical cross entropy, which
is based on the input variance (see Kendall and Gal (2017)
for more details). Figure 2 summarizes the architecture of the
Bayesian network.
3.3. Multi-level Ensemble Classification
Patterns associated with each type of pneumonia are similar
among different subjects. However, there are some factors like the virulence of the disease and the presence of other pulmonary findings that can affect the identification of the patterns associated with the different pathologies. One crucial
aspect is to select an optimal kernel size for the convolutional
operators of the neural network that can properly extract the
relevant information. Moreover, this is even more important
when images used to train the network come from different
sources, and when they can have different sizes and aleatory
artifacts. To overcome this issue, we employed seven neural
networks, each one of them with a different kernel size value
in the range [3 − 15] with increments of two. This means that
the kernel size assigned to the first network was 3, 5 for the
second network and so on, until a size of 15 for the seventh
CNN. The number of neural networks and their kernel sizes
were selected in order to strike a balance between performance and computational cost. Finally, each individual classifier
was then combined into a global one following an ensemble
classification procedure.
Previous studies have employed majority voting to fuse
the output of the base classifiers (Chandra et al., 2021; Zhou
et al., 2020). Given the Bayesian nature of the networks employed in this work, we computed the weights of each classifier as a function of the uncertainty given by each one of them
for each test image (see Figure 3). If the uncertainty of a classifier in a specific prediction was high, it would have a low
contribution to the final ensemble, and vice versa (Liu et al.,
2012). Defining ukl (y) as the uncertainty of the test sample
y obtained from the k-th classifier corresponding to the l-th
class, the empirical average of the l-th weights (inverse of uncertainties) over the K classifiers can be calculated as follows:
PK
El (y) =

1
k=1 uk
l (y)

(4)
K
The class label of the test sample y is then assigned to the
class with the maximum average weight as:
Label(y) = arg max El (y)
l

(5)

RB

BN

Batch Normalization

Convolution
Filters = 16
Kernel size = [3-15]

Residual Block
Filters = 16
Kernel size = [3-15]

BN

Batch Normalization

…

INPUT
(224 x 224 x 1)

F
l
a
t
t
e
n

Dense
N=500

Softplus

BN

BN

Softmax

…

Batch Normalization

Dense

Dense

N=1

N=100

Batch Normalization

…
Dense
N=n classes

Fig. 2. Diagram of the bayesian framework of each individual network within the ensemble.
Detecting the presence of pneumonia when comparing
to healthy subjects is an interesting initial step in the development of a CAD system. However, it is much more useful
to identify exactly the type of pneumonia patients suffer
from. As described in Section 2.1, the database used in this
work contains CXR images of healthy subjects (controls) and
images from three types of pneumonia: bacterial, viral and
COVID-19. In order to perform the multiclass classification,
we employed a decision tree based on the One-versus-all
(OVA) approach (Galar et al., 2011; Gao et al., 2021; Zhou
and Fujita, 2017). This alternative divides a multiclass problem into a number of binary sub-problems. In each one of
them, one of the classes is considered as the positive class,
whereas the other classes are the negative class. Following
this framework, we used a decision tree with three levels in order to distinguish between the different pathologies. In each
level, an ensemble of different kernel sizes was employed.
This led to a two-level ensemble classification: one ensemble for the combination of different kernels, and another one
for combining binary classifiers to perform multiclass classification. The decision tree relies on a process that can be
summarized as follows:
• First level: classification between normal vs pneumonia. The second class contains subjects diagnosed from
the three different types of pneumonia (bacterial, viral,
and COVID-19).

• Second level: classification between bacterial vs viral
pneumonia. The second class corresponds to images
from subjects with pneumonia due to different viruses
(no-COVID-19 or COVID-19).
• Third level: classification between no-COVID-19 vs
COVID-19.
Figure 4 depicts a visual representation of how the decision tree works. Images that are labelled as pneumonia in
the first level are passed to the second one. Similarly, images
labelled as viral pneumonia continue to the third level in order to identify whether the virus that produced the pneumonia
was COVID-19 or not. It is worth mentioning that the binary classifier employed in each level has the same ensemble
structure that the one explained in Section 3.3.

3.4. Performance evaluation
For all experiments, a 5-fold stratified cross-validation scheme was used to estime the generalization ability of our method (Kohavi, 1995). The performance of the classification
frameworks was evaluated in terms of different parameters
from the confusion matrix, which can be computed as follows:

Dataset

Training

Bayesian
Network

Bayesian
Network

Bayesian
Network

Kernel
size = 3

Kernel
size = 5

Kernel
size = 7

Trained
Model

Trained
Model

Trained
Model

…

Bayesian
Network
Kernel
size = 15

…

Trained
Model

Test

Predicted
label 1

Uncertainty
1

𝑤! =

Predicted
label 2

1
𝑢!" (𝑦)

Uncertainty
2

𝑤# =

Predicted
label 3

1
𝑢"# (𝑦)

&

Predicted
label k

Uncertainty
3

𝑤$ =

1
𝑢"$ (𝑦)

Uncertainty
k

𝑤% =

1
𝑢"% (𝑦)

&

If ) 𝑤% (𝑝𝑟𝑒𝑑𝑖𝑐𝑡𝑒𝑑 𝑙𝑎𝑏𝑒𝑙 == 0) > ) 𝑤% (𝑝𝑟𝑒𝑑𝑖𝑐𝑡𝑒𝑑 𝑙𝑎𝑏𝑒𝑙 == 1)
%'!

%'!

&

&

Predicted label = 0

If ) 𝑤% (𝑝𝑟𝑒𝑑𝑖𝑐𝑡𝑒𝑑 𝑙𝑎𝑏𝑒𝑙 == 0) < ) 𝑤% (𝑝𝑟𝑒𝑑𝑖𝑐𝑡𝑒𝑑 𝑙𝑎𝑏𝑒𝑙 == 1)
%'!

Predicted label = 1

%'!

Fig. 3. Schema of the ensemble architecture proposed in this work based on the uncertainty in the prediction of each individual
classifier.

VS
ol
ntr
Co

Control vs Pneumonia

Pn
eu
mo
nia

Controls
Bacterial vs Viral
Pneumonia

VS
Bacterial pneumonia

l
r ia
cte
Ba

Vi
ra
l

Viral pneumonia
(no COVID-19)

No COVID-19
vs COVID-19

VS
Viral pneumonia
(COVID-19)

No

DVI
CO

19

CO
VI
D-

19

Fig. 4. Schematic representation of the decision tree employed for the multiclass classification.

TP + TN
TP
Sens =
TP + TN + FP + FN
TP + FN
1TP
TN 
TN
AU C =
+
Spec =
TN + FP
2 P
N
TP
2 × P rec × Sens
P rec =
F 1 − score =
TP + FP
P rec + Sens
(6)

where uc (y) is the combined uncertainty, ci is the sensitivity
coefficient and u(xi ) is the standard uncertainty.

Acc =

where TP is the number of pneumonia patients correctly classified (true positives), TN is the number of control patients
correctly classified (true negatives), FP is the number of control subjects classified as pneumonia (false positives) and FN
is the number of pneumonia patients classified as controls
(false negatives). We also employed the area under the curve ROC (AUC) as an additional measure of the classification
performance (Hajian-Tilaki, 2013; Mandrekar, 2010). Since
classes were unbalanced (e.g. the number of pneumonia patients was higher than controls), we incorporated the weights
of the classes into the cost function in order to the majority
class does not contribute more than the minority one.
Given the ensemble nature of the system proposed in this
work, we employed a kappa-uncertainty diagram to evaluate
the level of agreement of the different classifier outputs while correcting for chance (Rodriguez et al., 2006; Wang et al.,
2019). This measure is based on Cohen’s kappa coefficient
(Cohen, 1960), which is widely accepted as the de facto standard for measurement of interannotator agreement (Di Eugenio and Glass, 2004). Specifically, the kappa statistic compares an observed accuracy with an accuracy obtained by chance, providing a measure of how closely instances classified by
a classifier match the ground truth. Mathematically, Cohen’s
kappa can be defined as:
k=

pA − pE
1 − pE

(7)

where pA is the observed relative agreeement between two
annotators, and pE is the probability of agreement by chance.
Although acceptable kappa statistic values vary on the context, the closer to 1, the better the classification. Section 5
summarizes the kappa scores obtained by different members
of the ensemble classifier, as well as revealing the relationship between the uncertainty of Bayesian networks and kappa
values.
As explained in Section 3.3, a decision tree was employed for multiclass classification. In order to build the kappauncertainty diagram explained above, a combination of the
uncertainties of the different levels of the tree has to be computed. To do so, we employed a method known as summation
in quadrature (White, 2008), described as follows:
v
u n
uX
(8)
uc (y) = t [ci u(xi )]2
i=1

4. EVALUATION
4.1. Experimental setup
In this work we propose a method to extract the relevant information from CXR images that allows the identification of
pneumonia. To do so, we define two experiments:
• Experiment 1: Binary Classification between different
groups under three scenarios: CTL vs PNEU, which includes all images labelled as CTL and PNEU; BAC vs VIR,
which divides the images from people diagnosed from
pneumonia regarding the cause of the disease is a bacteria
or a virus; NO-COVID-19 vs COVID-19 for viral pneumonia. The aim is to identify whether the virus that produced
pneumonia was COVID-19 or not. The whole Bayesian
CNN was trained using the Adam optimization algorithm
(Kingma and Ba, 2017), with learning rate 0.001, φ = 0.9
and a decay of 0.001). The number of epochs employed
for training the system was 15, 20 and 25, for the CTL
vs PNEU, BAC vs VIR and NO-COVID-19 vs COVID19 scenarios, respectively. We used the Keras library over
Tensorflow with some custom modules.
• Experiment 2: Multiclass Classification by using a decision tree in order to distinguish between the four different pathologies contained in the database. A binary classification
is employed in each of the three levels of the tree. The first
level corresponds to the CTL vs PNEU classification, the
second one contains the BAC vs VIR comparison, whereas
in the third level, the distinction between NO-COVID-19 vs
COVID-19 is performed. These binary classifiers employ
the same framework and configuration as in Experiment 1.
5. RESULTS
We first explore how performance varies for the different kernel sizes of the individual classifiers for all the binary classifications performed (see Figure 5). We can see that kappa
score slightly varies when increasing the kernel size in the
three classification contexts. With reference to uncertainty,
only in the BAC vs VIR scenario uncertainty values drastically change for different kernel sizes. Therefore, there is not a
tendency that let us assure that there is a relationship between
these two variables. It is important to note the high levels of
uncertainty in this classification context when comparing to
the first and the third one, which manifests the extreme difficulty of this specific classification. It is not surprising that differentiating between a control and a patient who suffer from
pneumonia is a considerably easier task. However, these findings point out that there is a larger difference in the spatial
patterns associated with COVID-19 vs no-COVID-19 than in

Table 1. Performance of the ensemble classification approach proposed in this work in the different contexts evaluated.
Experiment
Acc (%)
Sens (%)
Spec (%)
Prec (%)
AUC (%)
F1-score (%)
CTRL vs PNEU
97.27 ±3.37 96.41 ±4.47 99.94 ±0.13 99.98 ±0.04 98.17 ±2.22
98.11 ±2.38
BAC vs VIR
98.43 ±0.95 98.16 ±1.17 98.79 ±0.73 99.09 ±0.56 98.48 ±0.92
98.62 ±0.84
COVID-19 vs NO COVID-19 99.69 ±0.56 99.83 ±0.35
99.6 ±0.8
99 ±1.98
99.71 ±0.4
99.4 ±0.99
Multiclass
98.06 ±1.63 97.24 ±2.67 99.38 ±0.33
99.6 ±0.21
98.31 ±1.33
98.39 ±1.38

Fig. 5. Performance associated with the different kernel sizes for the three classification contexts under study. Scores evaluated
were kappa and uncertainty.
the one between bacterial vs viral. This can be explained by
the severity of the pulmonary affection that COVID-19 usually causes, whereas pneumonia derived from another viruses
can show a more heterogeneous severity.
We observe that the discrimination ability of the system
is very high for the three binary classifications regardless of
the kernel size employed . Results in terms of different performance measures are shown in Table 1, whereas Figure 6
depicts the ROC curves for the different classifiers. Large values are obtained, as expected, in the CTL vs PNEU context.
However, these results confirm that our system can also separate patients with the same diagnosis (pneumonia) but with a
different cause (bacteria, virus, COVID-19). We also use the
kappa-uncertainty diagram to evaluate the level of agreement
between the classifier outputs. Figure 7 shows these diagrams
for the three binary classifiers and the multiclass derived from
the decision tree, represented by a different colour. The cloud
points represent the kappa score-uncertainty obtained in each
fold of the cross-validation scheme, whereas large stars represent the centroid of the resulting distribution. From this figure,
we can see that there is not a great difference between individual classifiers, in consonance with results derived from ROC

curves.

It is interesting how this figure reveals that the combination of classifiers with a certain performance (high kappa score and low uncertainty) leads to an ensemble classifier with
these features. However, uncertainty is higher in the multiclass classifier for a similar kappa score compared to individual
ones.This means that, although classification performance of
the decision tree is high, the uncertainty of the resulting prediction is also higher than in binary classification. This evidences the extreme utility of this kind of diagrams in Bayesian
deep learning and in contexts when reliability of predictions is
of core interest. According to Table 1, the multiclass classifier
has a superior performance than the CTRL vs PNEU in most
of metrics evaluated. However, the uncertainty of the predictions is also higher (centroid of the multiclass is farther to the
right than the CTRL vs PNEU centroid). Further discussion
regarding the results obtained and their clinical implications
are provided in Section 6.

1.0

Sensitivity

0.8
0.6
0.4
0.2
0.0

CTL vs PNEU (AUC=0.981)
BAC vs VIR (AUC=0.986)
NO COVID-19 vs COVID-19 (AUC=0.997)
0.0

0.2

0.4
0.6
1 - Specificity

0.8

1.0

Fig. 6. ROC curves obtained by the classifiers of each level of the decision tree.

1.00

kappa diversity

0.95
0.90
0.85
0.80

CTL vs PNEU
BAC vs VIR
NO-COVID vs COVID
Multiclass

0.75
0.70

0.00

0.02

0.04
0.06
0.08
Classifier uncertainty

0.10

0.12

Fig. 7. Diversity-uncertainty diagrams of the different levels of the multiclass classifier. The x-axis represents the combined
uncertainty of each individual classifier and the resulting mutlticlass. The y-axis represents diversity of the classifiers evaluated
by the kappa measure. Each dot represents the kappa-uncertainty score obtained by a classifier in one fold, whereas large stars
represent the centroid of the resulting distribution.

6. DISCUSSION
In this study, we proposed a classification method for the detection of different types of pneumonia from CXR images.
This approach relies on the use of a Bayesian version of a
Residual Network (ResNet), which allows the optimization
of the network according to the uncertainty of its predictions.
We employed different networks modifying their kernel sizes
and combined them within an ensemble classifier so that the
contribution of each individual network depends on the uncertainty of its predictions. We evaluated the performance of
this approach in different classification scenarios. In the first
context, the two classes generated relatively big differences
in the observed pattern (pneumonia vs control), whereas in
the second (bacterial vs viral pneumonia) and in the third one
(COVID-19 vs no-COVID-19) these differences were extremely small. Besides, the performance of a multiclass classifier
was also evaluated in order to check if this method could simultaneously differentiate between the different pathologies.
The high performance shown by the proposed method in
all scenarios provides us with a new tool to detect the presence
of pneumonia in CXR images, in addition to distinguish whether the source of the pathology is viral or bacterial, and if the
virus is COVID-19 or not. The features extracted by convolutional blocks of different kernel sizes contained relevant information that enhanced the separability between the different
classes. The combination of convolutional blocks of different
kernel sizes is especially interesting in this context where the
database contains images of people from a wide range of age.
Pulmonary affections caused by the different pathologies evaluated in this work mainly depend on the severity of the disease. However, the shape and size of these manifestations also
depend on the shape and size of lungs. The ensemble method
proposed in this work allows the identification of patterns associated with pneumonia without focusing on a specific size
for the informative regions.
Another crucial aspect of the method proposed in this
work is its Bayesian nature. The aim of CAD systems regardless of the application context is to maximize the classification performance, in terms of accuracy, AUC, etc. However,
in most scenarios it is also important to know the reliability
of the prediction itself. Neural networks are prone to overfitting, which means that taking decisions based only on the
prediction can be counterproductive. In an extreme case, it
is possible that the classifier does not know the class a test
image belongs to, but it always has to assign a label, even
though the output probability is near to chance level. This is
particularly problematic when developing a tool for the diagnosis of a disease. Doctors need to know not only the global
accuracy obtained during the training and test of the model,
but how reliable is the prediction of new individual samples.
This problem is addressed with the inclusion of Bayesian elements in neural networks. However, our findings reveal that
this is not the only advantage that this approach provides. We

have demonstrated the high performance of ensemble classification, even in situations where differences between the
pulmonary patterns of the different pathologies are extremely
small. The novelty of our approach relies on the way the contribution of each individual classifier to the global decision is
computed. Weights are usually derived from the accuracy of
each individual classifier. However, results can be biased if
part of the predictions are obtained by chance, i.e. when the
output probabilities of the different classes are almost equal.
We overcome this problem by weighting the contribution of
each classifier according to the uncertainty of its predictions.
It is worth remembering that part of the database (normal, bacterial and viral (no-COVID) pneumonia patients)
contains pediatric chest radiographies, whereas COVID-19
images correspond to adults. Detecting pneumonia from pediatric chest radiographies is more challenging than in adults
for several reasons. First, the dose of X-ray radiation is considerably lower than in adults, which results in a reduced
image resolution and a higher overlapping between the different anatomical parts. Second, lungs appearance changes
dramatically along the pediatric development stages, both
in size and shape (more similar to a triangle in infants).
The dataset employed in this work contains CXR images of
children of a wide range of ages, increasing variability and
complexity of the classification process. Finally, CXRs are
noisier than in adults because of movement, legs positioning or when they are being hold by adult hands. For this
reason, it is worth highlighting the high performance obtained in this work, improving the results obtained in previous
works even when applied to detect pneumonia in children
(Jain et al., 2020b; Liang and Zheng, 2020; Rajaraman et al.,
2018), adults (Schwyzer et al., 2020; Toğaçar et al., 2020; Yu
et al., 2021), and also when tried to identify the presence of
COVID-19 (Jain et al., 2020a; Mahmud et al., 2020; Panwar
et al., 2020; Wang et al., 2021b).
We have developed a tool that is able to distinguish between patterns associated with different pathologies, but it
is worth highlighting the high performance obtained in the
multiclass classification. In this case, the accuracy and the
AUC obtained were 98.06% and 98.31%, respectively, which
is considerably higher than the results provided by similar
techniques in previous studies (Apostolopoulos and Tzani,
2020; Hemdan et al., 2020; Wang et al., 2020; Zhang et al.,
2020; Zhou et al., 2020). There are two main relevant aspects
derived from these excellent results to be mentioned. First,
the only preprocessing applied to the data was the rescaling
of the images to a lower resolution in order to reduce the
computational burden of the classification pipeline. We did
not perform other complex processes such as lung segmentation, but the RAW rescaled images were used as the inputs
of the classification system. Thus, it is remarkable the high
performance obtained by the method proposed in this extreme
situation. Second, results obtained in the multiclass scenario
allow the application of the tool proposed in this work in a

more real context. The multiclass scenario is more similar to
a real context than binary classifications, where the simplest
case only distinguishes the presence (or not) of pneumonia. Results obtained by the multiclass classifier reveal the
usefulness of this kind of techniques.
7. CONCLUSION
Respiratory illness is leading cause of death and disability in
the world. The annual fatality rate of pneumonia is approximately 4 million people, whereas is the leading cause of
death among children under 5 years old. The pathology associated with pneumonia is often overlapping with other abnormal conditions of the lung, leading to a time-consuming
process that may delay diagnosis and treatment. In this paper
we proposed an uncertainty-driven ensemble of deep neural
networks to identify patterns associated with different types
of pneumonia. This tool combined the information extracted
from different architectures according to the uncertainty of
their predictions, instead of using the accuracy of individual
classifiers as most studies usually do. The information provided about the reliability of the predictions, in addition to the
large performance obtained (accuracy of 98.06% when distinguished between four pathologies) evidences the applicability
of the system to be used as an aid for clinicians. The combination of CNNs of different kernel sizes allows the identification of pneumonia patterns regardless of their size and shape. Moreover, the reduced preprocessing needed for obtaining
these results guarantees a limited computational cost. Our results pave the way for the application of Bayesian deep neural
networks to other image modalities such as CT, which offers
much more resolution than XR images and can provide key
information for the detection of pneumonia.

Acknowledgments
This work was partly supported by the MINECO/ FEDER
under the PGC2018-098813-B-C32, RTI2018-098913-B100,
CV20-45250 and A-TIC-080-UGR18 projects.

References
Abiyev, R., Ma’aitah, M., 08 2018. Deep convolutional neural
networks for chest diseases detection. Journal of Healthcare Engineering 2018, 1–11.
Ahmad, W. S. H. M. W., Zaki, W. M. D. W., Fauzi, M. F. A.,
2015. Lung segmentation on standard and mobile chest radiographs using oriented gaussian derivatives filter. BioMedical Engineering OnLine 14.
Ajin, M., Mredhula, L., 2017. Diagnosis of interstitial lung disease by pattern classification. Procedia Computer Science
115, 195 – 208, 7th International Conference on Advances in Computing & Communications, ICACC-2017, 2224 August 2017, Cochin, India.
Apostolopoulos, I., Tzani, M., 03 2020. Covid-19: Automatic detection from X-ray images utilizing transfer learning
with convolutional neural networks. Australasian physical
& engineering sciences in medicine / supported by the Australasian College of Physical Scientists in Medicine and
the Australasian Association of Physical Sciences in Medicine 43.
Candemir, S., Jaeger, S., Palaniappan, K., Musco, J. P., Singh, R. K., Xue, Z., Karargyris, A., Antani, S., Thoma, G.,
McDonald, C. J., 2014. Lung segmentation in chest radiographs using anatomical atlases with nonrigid registration.
IEEE Transactions on Medical Imaging 33 (2), 577–590.
Castillo-Barnes, D., Ramı́rez, J., Segovia, F., Martı́nezMurcia, F. J., Salas-Gonzalez, D., Górriz, J. M., 2018.
Robust ensemble classification methodology for i123ioflupane SPECT images and multiple heterogeneous biomarkers in the diagnosis of Parkinson’s disease. Frontiers
in Neuroinformatics 12, 53.
Chandra, T. B., Verma, K., Singh, B. K., Jain, D., Netam,
S. S., 2020. Automatic detection of tuberculosis related abnormalities in chest X-ray images using hierarchical feature extraction scheme. Expert Systems with Applications
158, 113514.
Chandra, T. B., Verma, K., Singh, B. K., Jain, D., Netam,
S. S., 2021. Coronavirus disease (COVID-19) detection in
chest X-ray images using majority voting based classifier
ensemble. Expert Systems with Applications 165, 113909.
Chapman, B. E., Lee, S., Kang, H. P., Chapman, W. W., 2011.
Document-level classification of CT pulmonary angiography reports based on an extension of the context algorithm.
Journal of Biomedical Informatics 44 (5), 728 – 737.
Chen, C.-H., Huang, W.-T., Tan, T.-H., Chang, C.-C., Chang,
Y.-J., 2015. Using k-nearest neighbor classification to diagnose abnormal lung sounds. Sensors (Basel, Switzerland)
15, 13132 – 13158.

Cipolla, R., Gal, Y., Kendall, A., 2018. Multi-task learning
using uncertainty to weigh losses for scene geometry and
semantics. In: 2018 IEEE/CVF Conference on Computer
Vision and Pattern Recognition. pp. 7482–7491.
Cohen, J., 1960. A coefficient of agreement for nominal scales. Educational and Psychological Measurement 20, 37 –
46.
Damianou, A., Lawrence, N., 2013. Deep gaussian processes. Vol. 31 of Proceedings of Machine Learning Research.
PMLR, pp. 207–215.

URL http://dx.doi.org/10.1016/j.neucom.
2020.05.078
Gu, X., Pan, L., Liang, H., Yang, R., 2018. Classification
of bacterial and viral childhood pneumonia using deep
learning in chest radiography. In: Proceedings of the
3rd International Conference on Multimedia and Image
Processing. ICMIP 2018. Association for Computing
Machinery, New York, NY, USA, p. 88–93.
URL
https://doi.org/10.1145/3195588.
3195597

Di Eugenio, B., Glass, M., 2004. The kappa statistic: A second look. Comput. Linguist. 30 (1), 95–101.

Guan, Q., Huang, Y., 2020. Multi-label chest X-ray image
classification via category-wise residual attention learning.
Pattern Recognit. Lett. 130, 259–266.

Elaziz, M. A., Hosny, K. M., Salah, A., Darwish, M. M., Lu,
S., Sahlol, A. T., 2020. New machine learning method for
image-based diagnosis of covid-19. PLOS ONE 15 (6), 1–
18.

Hajian-Tilaki, K., 09 2013. Receiver operating characteristic
(ROC) curve analysis for medical diagnostic test evaluation. Caspian journal of internal medicine 4, 627–635.

Feng, F., Xia, G., Wang, Q., Shi, Y., Zhang, Z., 2015. Initial
computed tomography findings of pneumonia in patients
with human infected avian influenza (H7N9). Radiology
of Infectious Diseases 1 (2), 57 – 63.
URL
http://www.sciencedirect.com/
science/article/pii/S2352621115000066
Gal, Y., 2016. Uncertainty in deep learning. Ph.D. thesis, University of Cambridge.
Galar, M., Fernández, A., Barrenechea, E., Bustince, H., Herrera, F., 2011. An overview of ensemble methods for binary classifiers in multi-class problems: Experimental study
on one-vs-one and one-vs-all schemes. Pattern Recognition 44 (8), 1761 – 1776.
Gao, X., He, Y., Zhang, M., Diao, X., Jing, X., Ren, B., Ji,
W., 2021. A multiclass classification using one-versus-all
approach with the differential partition sampling ensemble. Engineering Applications of Artificial Intelligence 97,
104034.
Gilani, Z., Kwong, Y., Levine, O., Deloria-Knoll, M., Scott,
J. A., O’Brien, K., Feikin, D., 04 2012. A literature review and survey of childhood pneumonia etiology studies:
2000–2010. Clinical infectious diseases: an official publication of the Infectious Diseases Society of America 54
Suppl 2, S102–8.
Górriz, J., Ramı́rez, J., Ortı́z, A., Martı́nez-Murcia, F., Segovia, F., Suckling, J., Leming, M., Zhang, Y., Álvarez
Sánchez, J., Bologna, G., Bonomini, P., Casado, F., Charte,
D., Charte, F., Contreras, R., Cuesta-Infante, A., Duro, R.,
Fernández-Caballero, A., Fernández, J., 2020. Artificial intelligence within the interplay between natural and artificial
computation: Advances in data science, trends and applications. Neurocomputing 410, 237–270.

Hassen, D. B., Taleb, H., Yaakoub, I. B., Mnif, N., 2013. A
Fuzzy Approach to Chest Radiography Segmentation Involving Spatial Relations. International Journal of Computer Applications.
He, K., Zhang, X., Ren, S., Sun, J., 2016. Deep residual
learning for image recognition. In: 2016 IEEE Conference
on Computer Vision and Pattern Recognition (CVPR). pp.
770–778.
Hemdan, E. E.-D., Shouman, M. A., Karar, M. E., 2020.
COVIDX-Net: A framework of deep learning classifiers to
diagnose COVID-19 in X-ray images.
Hogeweg, L., Sánchez, C. I., Maduskar, P., Philipsen, R., Story, A., Dawson, R., Theron, G., Dheda, K., Peters-Bax, L.,
van Ginneken, B., 2015. Automatic detection of tuberculosis in chest radiographs using a combination of textural,
focal, and shape abnormality analysis. IEEE Transactions
on Medical Imaging 34 (12), 2429–2442.
J, A., M, A., Daniel, A., Singerji, A., 2017. A robust automated lung segmentation system for chest X-ray (CXR)
images. International Journal of Engineering Research and
6.
Jaeger, S., Karargyris, A., Candemir, S., Folio, L., Siegelman, J., Callaghan, F., Xue, Z., Palaniappan, K., Singh,
R. K., Antani, S., Thoma, G., Wang, Y., Lu, P., McDonald, C. J., 2014. Automatic tuberculosis screening using
chest radiographs. IEEE Transactions on Medical Imaging
33 (2), 233–245.
Jain, G., Mittal, D., Thakur, D., Mittal, M. K., 2020a. A deep learning approach to detect covid-19 coronavirus with
X-ray images. Biocybernetics and Biomedical Engineering
40 (4), 1391 – 1405.

Jain, R., Nagrath, P., Kataria, G., Sirish Kaushik, V., Jude
Hemanth, D., 2020b. Pneumonia detection in chest X-ray
images using convolutional neural networks and transfer
learning. Measurement 165, 108046.

Le, Q. V., Smola, A. J., Canu, S., 2005. Heteroscedastic gaussian process regression. In: Proceedings of the 22nd International Conference on Machine Learning. ICML ’05. Association for Computing Machinery, p. 489–496.

Jospin, L. V., Buntine, W. L., Boussaid, F., Laga, H., Bennamoun, M., 2020. Hands-on bayesian neural networks - a
tutorial for deep learning users. ArXiv abs/2007.06823.

Li, Y., Gal, Y., 2017. Dropout inference in bayesian neural
networks with alpha-divergences. In: ICML.

Kaggle, 2020a. Chest X-Ray Images (Covid-19 & Pneumonia).
URL https://www.kaggle.com/prashant268/
chest-xray-covid19-pneumonia
Kaggle, 2020b. Chest X-Ray Images (Pneumonia) dataset.
URL
https://www.kaggle.
com/paultimothymooney/
chest-xray-pneumonia?
Kendall, A., Gal, Y., 2017. What uncertainties do we need in
bayesian deep learning for computer vision? In: Guyon, I.,
Luxburg, U. V., Bengio, S., Wallach, H., Fergus, R., Vishwanathan, S., Garnett, R. (Eds.), Advances in Neural Information Processing Systems. Vol. 30. Curran Associates,
Inc., pp. 5574–5584.
Kermany, D. S., Goldbaum, M., Cai, W., Valentim, C. C., Liang, H., Baxter, S. L., McKeown, A., Yang, G., Wu, X.,
Yan, F., Dong, J., Prasadha, M. K., Pei, J., Ting, M. Y., Zhu,
J., Li, C., Hewett, S., Dong, J., Ziyar, I., Shi, A., Zhang, R.,
Zheng, L., Hou, R., Shi, W., Fu, X., Duan, Y., Huu, V. A.,
Wen, C., Zhang, E. D., Zhang, C. L., Li, O., Wang, X.,
Singer, M. A., Sun, X., Xu, J., Tafreshi, A., Lewis, M. A.,
Xia, H., Zhang, K., 2018. Identifying medical diagnoses
and treatable diseases by image-based deep learning. Cell
172 (5), 1122 – 1131.e9.

Liang, G., Zheng, L., 2020. A transfer learning method with
deep residual network for pediatric pneumonia diagnosis. Computer Methods and Programs in Biomedicine 187,
104964.
Liu, C., Pang, M., 2020. Automatic lung segmentation based
on image decomposition and wavelet transform. Biomedical Signal Processing and Control 61, 102032.
Liu, M., Zhang, D., Shen, D., 2012. Ensemble sparse classification of Alzheimer’s disease. NeuroImage 60 (2), 1106 –
1116.
Ma, L., Liu, X., Song, L., Zhou, C., Zhao, X., Zhao, Y., 2015.
A new classifier fusion method based on historical and
on-line classification reliability for recognizing common
CT imaging signs of lung diseases. Computerized Medical
Imaging and Graphics 40, 39 – 48.
Maduskar, P., Philipsen, R., Melendez, J., Scholten, E., Chanda, D., Ayles, H., Sánchez, C., Ginneken, B., 12 2015. Automatic detection of pleural effusion in chest radiographs.
Medical Image Analysis 28, 22–32.

Kingma, D. P., Ba, J., 2017. Adam: A method for stochastic
optimization.

Mahmud, T., Rahman, M. A., Fattah, S. A., 2020. Covxnet: A
multi-dilation convolutional neural network for automatic
COVID-19 and other pneumonia detection from chest
X-ray images with transferable multi-receptive feature
optimization. Computers in Biology and Medicine 122,
103869.
URL
http://www.sciencedirect.com/
science/article/pii/S0010482520302250

Kiureghian, A. D., Ditlevsen, O., 2009. Aleatory or epistemic? does it matter? Structural Safety 31 (2), 105 – 112,
risk Acceptance and Risk Communication.

Mandrekar, J. N., 2010. Receiver operating characteristic curve in diagnostic test assessment. Journal of Thoracic Oncology 5 (9), 1315 – 1316.

Kohavi, R., 1995. A study of cross-validation and bootstrap
for accuracy estimation and model selection. In: Proceedings of the 14th International Joint Conference on Artificial Intelligence - Volume 2. IJCAI’95. Morgan Kaufmann
Publishers Inc., San Francisco, CA, USA, p. 1137–1143.

Martı́nez-Murcia, F., Gorriz, J., Ramı́rez, J., Ortiz, A., 07
2018. Convolutional neural networks for neuroimaging in
Parkinson’s disease: Is preprocessing needed? International
Journal of Neural Systems 28.

Krizhevsky, A., Sutskever, I., Hinton, G., 01 2012. Imagenet classification with deep convolutional neural networks.
Neural Information Processing Systems 25.

Mittal, A., Kumar, D., Mittal, M., Saba, T., Abunadi, I., Rehman, A., s. Roy., 2020. Detecting pneumonia using convolutions and dynamic capsule routing for chest X-ray image.
Sensors 20 (4), 1068.

Kunz, W. G., Patzig, M., Crispin, A., Stahl, R., Reiser, M. F.,
Notohamiprodjo, M., 2018. The value of supine chest Xray in the diagnosis of pneumonia in the basal lung zones.
Academic Radiology 25 (10), 1252 – 1256.

Nix, D. A., Weigend, A. S., 1994. Estimating the mean and
variance of the target probability distribution. In: Proceedings of 1994 IEEE International Conference on Neural
Networks (ICNN’94). Vol. 1. pp. 55–60 vol.1.

Ortiz, A., Martı́nez-Murcia, F., Garcı́a-Tarifa, M., Lozano, F.,
Gorriz, J., Ramı́rez, J., 06 2016. Automated diagnosis of
Parkinsonian syndromes by deep sparse filtering-based features. In: Innovation in Medicine and Healthcare 2016. pp.
249–258.
Panwar, H., Gupta, P., Siddiqui, M. K., Morales-Menendez,
R., Bhardwaj, P., Singh, V., 2020. A deep learning and
grad-cam based color visualization approach for fast detection of COVID-19 cases using chest X-ray and CT-scan
images. Chaos, Solitons & Fractals 140, 110190.
URL
http://www.sciencedirect.com/
science/article/pii/S0960077920305865
Payan, A., Montana, G., 02 2015. Predicting Alzheimer’s disease: a neuroimaging study with 3d convolutional neural
networks. ICPRAM 2015 - 4th International Conference
on Pattern Recognition Applications and Methods, Proceedings 2.
Porcel, J. M., Alemán, C., Bielsa, S., Sarrapio, J., Fernández
de Sevilla, T., Esquerda, A., 2008. A decision tree for differentiating tuberculous from malignant pleural effusions.
Respiratory Medicine 102 (8), 1159 – 1164.
Rajaraman, S., Candemir, S., Kim, I., Thoma, G., Antani, S.,
09 2018. Visualization and interpretation of convolutional
neural network predictions in detecting pneumonia in pediatric chest radiographs. Applied Sciences 8, 1715.
Rajpurkar, P., Irvin, J., Zhu, K., Yang, B., Mehta, H., Duan, T., Ding, D., Bagul, A., Langlotz, C., Shpanskaya, K.,
Lungren, M., Ng, A., 11 2017. Chexnet: Radiologist-level
pneumonia detection on chest X-rays with deep learning.
Rodriguez, J. J., Kuncheva, L. I., Alonso, C. J., 2006. Rotation
forest: A new classifier ensemble method. IEEE Transactions on Pattern Analysis and Machine Intelligence 28 (10),
1619–1630.
Schmidhuber, J., 2015. Deep learning in neural networks: An
overview. Neural Networks 61, 85 – 117.
URL
http://www.sciencedirect.com/
science/article/pii/S0893608014002135
Schwyzer, M., Martini, K., Skawran, S., Messerli, M., Frauenfelder, T., 2020. Pneumonia detection in chest X-ray
dose-equivalent ct: Impact of dose reduction on detectability by artificial intelligence. Academic Radiology.

neural networks from overfitting. J. Mach. Learn. Res. 15,
1929–1958.
Syrjala, H., Broas, M., Ohtonen, P., Jartti, A., Pääkkö, E.,
2017. Chest magnetic resonance imaging for pneumonia
diagnosis in outpatients with lower respiratory tract infection. European Respiratory Journal 49 (1).
Toğaçar, M., Ergen, B., Cömert, Z., Özyurt, F., 2020. A deep
feature learning model for pneumonia detection applying a
combination of mRMR feature selection and machine learning models. IRBM 41 (4), 212 – 222.
Uppaluri, R., Hoffman, E., Sonka, M., Hartley, P., Hunninghake, G., McLennan, G., 1999. Computer recognition of
regional lung disease patterns. American journal of respiratory and critical care medicine 160 (2), 648—654.
Vajda, S., Karargyris, A., Jäger, S., Santosh, K. C., Candemir,
S., Xue, Z., Antani, S. K., Thoma, G. R., 2018. Feature selection for automatic tuberculosis screening in frontal chest
radiographs. Journal of Medical Systems 42, 1–11.
Van Ginneken, B., Ter Haar Romeny, B. M., Viergever, M. A.,
2001. Computer-aided diagnosis in chest radiography: a
survey. IEEE Transactions on Medical Imaging 20 (12),
1228–1241.
Varshni, D., Thakral, K., Agarwal, L., Nijhawan, R., Mittal, A., 2019. Pneumonia detection using CNN based feature extraction. In: 2019 IEEE International Conference
on Electrical, Computer and Communication Technologies
(ICECCT). pp. 1–7.
Wang, H., Yeung, D., 2016. Towards bayesian deep learning:
A framework and some existing methods. IEEE Transactions on Knowledge and Data Engineering 28, 3395–3408.
Wang, J., Yang, Y., Xia, B., 2019. A simplified cohen’s kappa
for use in binary classification data annotation tasks. IEEE
Access 7, 164386–164397.
Wang, S., Kang, B., Ma, J., Zeng, X., Xiao, M., Guo, J., Cai,
M., Yang, J., Li, Y., Meng, X., Xu, B., 2020. A deep learning algorithm using CT images to screen for corona virus
disease (covid-19). medRxiv.

Segovia, F., Garcı́a-Pérez, M., Gorriz, J., Ramı́rez, J.,
Martı́nez-Murcia, F., 10 2016. Assisting the diagnosis
of neurodegenerative disorders using principal component
analysis and tensorflow. In: International Joint Conference
SOCO’16-CISIS’16-ICEUTE’16. pp. 43–52.

Wang, S.-H., Govindaraj, V. V., Górriz, J. M., Zhang, X.,
Zhang, Y.-D., 2021a. Covid-19 classification by FGCNet
with deep feature fusion from graph convolutional network
and convolutional neural network. Information Fusion 67,
208 – 229.
URL
http://www.sciencedirect.com/
science/article/pii/S1566253520303705

Srivastava, N., Hinton, G. E., Krizhevsky, A., Sutskever, I.,
Salakhutdinov, R., 2014. Dropout: a simple way to prevent

Wang, X., Peng, Y., Lu, L., Lu, Z., Bagheri, M., Summers,
R. M., 2017. ChestX-Ray8: Hospital-Scale Chest X-Ray

Database and Benchmarks on Weakly-Supervised Classification and Localization of Common Thorax Diseases. In:
2017 IEEE Conference on Computer Vision and Pattern
Recognition (CVPR). pp. 3462–3471.
Wang, Z., Xiao, Y., Li, Y., Zhang, J., Lu, F., Hou, M., Liu, X.,
2021b. Automatically discriminating and localizing covid19 from community-acquired pneumonia on chest X-rays.
Pattern Recognition 110, 107613.
White, G., 09 2008. Basics of estimating measurement uncertainty. The Clinical biochemist. Reviews / Australian Association of Clinical Biochemists 29 Suppl 1, S53–60.
World Health Organization, 2016. Global tuberculosis report
2016.
URL http://www.who.int/tb/publications/
global_report/en/
World Health Organization, 2017. The global impact of respiratory diseases - second edition. Forum of International
Respiratory Societies (FIRS).
Xu, Y., van Beek, E. J., Hwanjo, Y., Guo, J., McLennan, G.,
Hoffman, E. A., 2006. Computer-aided classification of interstitial lung diseases via mdct: 3d adaptive multiple feature method (3d amfm). Academic Radiology 13 (8), 969 –
978.
Yahyaoui, A., Yumusak, N., 2018. Decision support system
based on the support vector machines and the adaptive support vector machines algorithm for solving chest disease
diagnosis problems. Biomedical Research-tokyo 29, 1474–
1480.
Yang, W., Liu, Y., Lin, L., Yun, Z., Lu, Z., Feng, Q., Chen, W.,
2018. Lung field segmentation in chest radiographs from
boundary maps by a structured edge detector. IEEE Journal
of Biomedical and Health Informatics 22 (3), 842–851.
Yu, X., Wang, S.-H., Zhang, Y.-D., 2021. Cgnet: A graphknowledge embedded convolutional neural network for detection of pneumonia. Information Processing & Management 58 (1), 102411.
Zhang, K., Liu, X., Shen, J., Li, Z., Sang, Y., Wu, X., Zha,
Y., Liang, W., Wang, C., Wang, K., Ye, L., Gao, M., Zhou,
Z., Li, L., Wang, J., Yang, Z., Cai, H., Xu, J., Yang, L.,
Cai, W., Xu, W., Wu, S., Zhang, W., Jiang, S., Zheng, L.,
Zhang, X., Wang, L., Lu, L., Li, J., Yin, H., Wang, W., Li,
O., Zhang, C., Liang, L., Wu, T., Deng, R., Wei, K., Zhou,
Y., Chen, T., Lau, J. Y.-N., Fok, M., He, J., Lin, T., Li, W.,
Wang, G., 2020a. clinically applicable ai system for accurate diagnosis, quantitative measurements, and prognosis
of covid-19 pneumonia using computed tomography”. Cell
181 (6), 1423 – 1433.e11.

Zhang, Y.-D., Dong, Z., Wang, S.-H., Yu, X., Yao, X., Zhou,
Q., Hu, H., Li, M., Jiménez-Mesa, C., Ramirez, J., Martinez, F. J., Gorriz, J. M., 2020b. Advances in multimodal
data fusion in neuroimaging: Overview, challenges, and novel orientation. Information Fusion 64, 149 – 187.
Zhang, Y. D., Satapathy, S. C., Zhu, L. Y., Górriz, J. M.,
Wang, S. H., 2020. A seven-layer convolutional neural network for chest CT based covid-19 diagnosis using stochastic pooling. IEEE Sensors Journal, 1–1.
Zhou, L., Fujita, H., 2017. Posterior probability based ensemble strategy using optimizing decision directed acyclic
graph for multi-class classification. Information Sciences
400-401, 142 – 156.
URL
http://www.sciencedirect.com/
science/article/pii/S0020025516314207
Zhou, T., ling Lu, H., Yang, Z., Qiu, S., qiang Huo, B., Dong,
Y., 2020. The ensemble deep learning model for novel
covid-19 on CT images. Applied Soft Computing, 106885.

