arXiv:2006.16539v1 [stat.ME] 30 Jun 2020

Autoregressive Mixture Models for Serial
Correlation Clustering of Time Series Data
Benny Ren
Department of Biostatistics, Epidemiology, and Informatics,
University of Pennsylvania, Philadelphia, USA
and
Ian Barnett
Department of Biostatistics, Epidemiology, and Informatics,
University of Pennsylvania, Philadelphia, USA
July 1, 2020

Abstract
Clustering individuals into similar groups in longitudinal studies can improve time
series models by combining information across like individuals. While there is a well
developed literature for clustering of time series, these approaches tend to generate
clusters independently of the model training procedure which can lead to poor model
fit. We propose a novel method that simultaneously clusters and fits autoregression models for groups of similar individuals. We apply a Wishart mixture model so
as to cluster individuals while modeling the corresponding autocorrelation matrices
at the same time. The fitted Wishart scale matrices map to cluster-level autoregressive coefficients through the Yule-Walker equations, fitting robust parsimonious
autoregressive mixture models. This approach is able to discern differences in underlying serial variation of time series while accounting for an individual’s intrinsic
variability. We prove consistency of our cluster membership estimator and compare
our approach against competing methods through simulation as well as by modeling
regional COVID-19 infection rates.

Keywords: Time series clustering, Wishart distribution, Expectation-Maximization, YuleWalker, Latent variable modeling

1

1

Introduction

Modern technologies have accelerated the pace at which data is collected, leading to new
frontiers in quantitative research. For example, the proliferation of wearable devices, sensors that continuously capture detailed behavioral data at an individual level, has led to
large numbers of observations and data types observed for each individual over time. When
the dimension of the available data and the number of observations per person increases,
over-parameterized models can lead to poor efficiency and overfitting. This problem can
be addressed by combining information across similar individuals within a sample of heterogenous longitudinal time series data.
Longitudinal data can be characterize by repeated observations collected for multiple
individuals over a period of time. Here we consider data collected at equally spaced time
series for each individual. Individuals will inevitably have varying participation, differences in the sparsity of data, i.e. varying length of time series, and different patterns and
frequency of missing data. In addition, time series for different individuals often differ in
their trend as well as their lagged covariance structure. We consider these differences to be
elements of heterogeneity that can be modeled. Centroid based clustering would separate
differences in means, and may miss out on more nuanced differences that could be observed
by evaluating the time series covariance structure.
Existing methods rarely accommodates these elements of heterogeneity. Classical functional clustering methods have difficulty handling some missing data mechanisms (Chiou
and Li, 2007; James and Sugar, 2003). Popular longitudinal clustering methods are based
on calculating distances measures between individuals, which may not properly capture
2

the true underlying signal (Montero et al., 2014; Ferreira and Zhao, 2016; Genolini et al.,
2015). We propose a method to cluster individuals that also addresses these elements of
heterogeneity by evaluating the autocorrelations of time series data. Correlations are ancillary with respect to mean and variance and autocorrelations can be calculated pairwise
when there is missing data. Furthermore, by clustering through a latent random effect,
clusters will be identified during our model training and will therefore be selected so as to
optimize model fit. This approach will be able to discern differences in underlying serial
variation of time series between individuals while accounting for some variability intrinsic
to an individual.
We use the Wishart mixture model (WMM), defined in Hidot and Saint-Jean (2010), to
cluster individuals by their K dimensional autocorrelation matrices while simultaneously
estimating group specific autocorrelations matrices. This WMM incorporates the sparsity
of the time series into the Wishart distribution as the degrees of freedom parameter, allowing the model to account for varying time series sample size across individuals. As
a result, low degrees of freedom corresponds with reduced influence in the model. Together, the WMM of autocorrelations can accommodate these elements of heterogeneity:
differences in mean, variance, and sparsity. We then use the respective estimated group
autocorrelation matrix to estimate group specific autoregression (AR) coefficients using
Yule-Walker equations (Yule, 1927; Walker, 1931). The derivation of these AR estimates
have the advantage of using pooled information across individuals, resulting in a robust
and parsimonious population level autoregressive mixture model (ARMM).
In Section 2, we derive the WMM model under a variety of parametric assumptions and

3

we detail an EM algorithm to estimate model parameters in each case. Next, we estimate
the ARMM using the results from the WMM and outline an AIC model selection procedure
as well as detail competing methods. In Section 3, we compare the WMM with competing
approaches through simulation studies and an application with COVID-19 infection rate
data. Ultimately we find WMM to be a powerful approach for clustering of longitudinal
time series data, particularly in the presence of nuanced AR coefficients differences.

2

Methods

2.1

Assumptions and Notation

Our data consist of I individuals, with times series vector yi , with measurements equispaced over time for individual i ∈ {1, 2, 3, ..., I}. Individual i, has a time series vector of length n∗i and we denote the time point index through the superscript in yi =
o
n
(n∗ )
(t)
(1) (2) (3)
yi , yi , yi , . . . , yi , . . . , yi i . When there is no missing data n∗i is equal to the number of observations, the sample size of time series yi .
Using the Wishart distribution, we evaluate Ci , a square K dimension non-singular autocorrelation matrix with a Toeplitz, bi-symmetric structure such that [Ci ]rc = ρ̂i (|r − c|)


(t) (t−k)
where r and c indicate the elements of matrix Ci . ρ̂i (k) = Corr yi , yi
, the autocorre(t)

(t−k)

lation between data points separated by lag k where yi and yi

are the observations at

time point index t and t − k. Under situations with missing data, ρ̂i (k) is calculated using
pairwise autocorrelations to achieve the best possible estimation given the data available.
The degrees of freedom, ni paired with Ci is given by number of rows without missing data

4

(K+r−c)

∗

from design matrix Di ∈ R(ni −K+1)×K where [Di ]rc = yi

. When there is no missing

data, ni = n∗i − K + 1.
The corresponding group AR model is given by
(t)
yi

= αi +

K−1
X

(t−k)

φ(k)
g yi

(t)

+ ei ,

(t)

ei ∼ N 0, τi2



(1)

k=1
(k)

where φg is are the AR coefficients shared by the group, g denotes the group index, and k
is the lag index. The αi and the τi2 are the intercept and variance of the AR model specific
to individual i, respectively.

2.2

Autoregressive Mixture Model

Yule-Walker estimates are consistent method of moment estimates for causal AR processes,
which rely on the autocovariance or autocorrelation matrices (Brockwell et al., 1991). In a
study population there may exist only a few types of autocorrelation matrices, which can
be clustered together to form a population level model for each group, thereby combining
signals across individuals. The WMM is a means to cluster individuals by their autocorrelation matrices and estimate group Wishart scale matrices. Using the group scale matrices,
we can perform Yule-Walker estimation for group AR coefficients.

5

2.2.1

Wishart Mixture Model

First we define the Wishart mixture model for G total number of groups or clusters,
Zig ∼ Mult (1; π1 , π2 , . . . , πG )
Ci | {Zig = 1} ∼ WK (Σg , ni )


|Ci |(ni −K−1)/2 exp − 12 trace Σ−1
g Ci
fW (Ci |Σg , ni ) =

Q
ni −k+1
2ni K/2 π K(K−1)/4 |Σ|ni /2 K
k=1 Γ
2
where g ∈ {1, 2, . . . , G}, the missing group indicators Zig follows a multinomial distribution
with π1 , π2 , . . . , πG as the mixing probability and Ci follows a Wishart distribution with
Σg as group scale matrix and ni degrees of freedom. ni controls the peakedness of the
Wishart probability density function. A small ni corresponding to a flatter distribution;
thus a lower contribution to the likelihood and less influence in the WMM. The complete
data likelihood for Θ = {π1 , . . . , πg , Σ1 , . . . , Σg } is given as
L(Θ) =

I Y
G
Y

(πg fW (Ci |Σg , ni ))zig

(2)

i=1 g=1

Using the EM algorithm, we estimate πg , Σg , and impute zig (Dempster et al., 1977).


(t)
In the estimation step, the function Q Θ, Θ̂ , with current estimate Θ̂(t) , is given as


h
i
Q Θ, Θ̂(t) = E log L(Θ)|C1 , C2 , . . . , CI , Θ̂(t)
=

I X
G
X

h

i

!

E zig |Ci , Θ̂(t) log (πg fW (Ci |Σg , ni )) .

i=1 g=1
(t+1)

After conditioning and noting that ẑig

(t+1)

ẑig

h
i
h
i
= E zig |Ci , Θ̂(t) = P Zig = 1|Ci , Θ̂(t) , we get





(t)
(t)
(t)
P (Zig = 1) f Ci |Zig = 1; Σ̂g , ni
π̂g fW Ci |Σ̂g , ni



.
=
=P
(t)
(t)
G
f Ci |Θ̂(t)
π̂
f
C
|
Σ̂
,
n
g
W
i
i
g=1 g

6

(3)

Here ni controls the degree of influence an individual has on the likelihood. A small ni ,
often associated with a noisy estimate of Ci , results in a flat fW (Ci |Σg , ni ), leading to
mixed soft clustering assignments through equation (3). This allows the data from noisy
individuals to be dispersed throughout the each group’s estimation rather than assumed
by any individual group, contrary to hard clustering techniques.


P
(t+1)
(t)
In the maximization step, maximizing Q Θ, Θ̂
under the constraint G
= 1,
g=1 π̂g
(t+1)

yields our update for the mixing probability π̂g

as

I

π̂g(t+1) =
The score function for Σg is


∂Q Θ, Θ̂(t)
∂Σg

=

I
X

(t+1)
ẑig

i=1

1 X (t+1)
ẑ
.
I i=1 ig



1 −1
ni −1
Σg Ci Σ−1
Σ
g −
2
2 g

(4)


=0

which yields our update as
(t+1)
Ci
i=1 ẑig
.
PI
(t+1)
i=1 ni ẑig

PI
Σ̂g(t+1)

=

(5)

The estimation of Σ̂g , which maps to the group AR model, is done simultaneously along
with clustering, allowing all individuals to be leveraged for the estimation of each group
model under the soft clustering assignments. Repeating the EM algorithm, equations, (3),
(4), and (5) until convergence leads to the estimate of Θ. The final group indicator, to
be used in the ARMM, is imputed as the index that maximizes ẑig , also known as the
maximum a posteriori rule for values zig such that zig∗ = 1 where g ∗ = argmax {ẑig }.
g

2.2.2

Variations of the WMM

Computing Wishart densities can be numerically unstable when ni is large as the distribution function becomes very peaked, making convergence highly sensitive to initial
7

parameter values. In addition, there may arise scenarios where ni is unknown despite the
AR model fit being known, such as in meta-analyses. We address missingness as well as
the numerical instability due to large ni with a modified version of the above proposed EM
algorithm where we assume a constant degrees of freedom , ng , at a group level, where
η = {n1 , n2 , . . . , nG }. While allowing ni to match the true number of data points for the
ith individual seems intuitive, recall that the WMM is only an approximation as the observations forming the autocorrelation matrix are not independent. Thus allowing degrees of
freedom to be flexible parameters may allow for a better model fit. We do this by solving
the score function
I
K
I

 X
X
X
Ci Σ̂−1
∂
g
ψ
−
ẑig
Q Θ, η, Θ̂, η̂ =
ẑig log
∂ng
2
i=1
i=1
k=1



1
(ng − k + 1)
2


=0

where ψ is the digamma function. Updates for equation (4) remains the same, but the
updates for (3), and (5) now become
(t+1)

ẑig



(t)
(t)
(t)
π̂g fW Ci |Σ̂g , n̂g


=P
(t)
(t)
(t)
G
g=1 π̂g fW Ci |Σ̂g , n̂g

(6)

(t+1)
Ci
i=1 ẑig
.
(t+1)
(t) PI
n̂g
ẑ
i=1 ig

PI

Σ̂(t+1)
g

=

(7)

We numerically update ng solving
n̂(t+1)
= argmin
g
ng

(



∂
Q Θ, η, Θ̂(t+1) , η̂ (t)
∂ng

2 )
(8)

such that ng ∈ (K − 1, U ], under pre-specified U , using the constrained Broyden-FletcherGoldfarb-Shanno algorithm (Byrd et al., 1995). Under this second algorithm, we repeat,
in order, (6), (4), (7), and (8) until convergence.

8

Again, as our design matrix Di does not follow the classical definition of a Wishart
distribution which relates to covariance matrices of independent multivariate normal observatinos, as we make no such assumptions on our data the degrees of freedom ni has a
different meaning. Even with our modified algorithm equation (8) which allows for ng to
be estimated at the cluster level instead of at the individual level, we may still want the
degrees of freedom to somewhat reflect the amount of data different individuals have. As
somewhat of a balance between the two approaches we propose a third extension of the
EM algorithm which adjusts degrees of freedom at a cluster level by the adding a λg adjustment term to ni , the degrees of freedom of the individual, where Λ = {λ1 , λ2 , . . . , λG }.
The update of λg is calculated by solving score function
I
I
K

 X
X
X
Ci Σ̂−1
∂
g
ψ
Q Θ, Λ, Θ̂, Λ̂ =
ẑig log
−
ẑig
∂λg
2
i=1
i=1
k=1



1
(ni + λg − k + 1)
2

Updates for equations (3), and (5) now become


(t)
(t)
(t)
π̂g fW Ci |Σ̂g , ni + λ̂g
(t+1)


ẑig = P
(t)
(t)
(t)
G
π̂
f
C
|
Σ̂
,
n
+
λ̂
g
g
g
W
i
i
g=1
Σ̂(t+1)
g

PI
(t+1)
Ci
i=1 ẑig

=P 
.
(t)
(t+1)
I
n
+
λ̂
ẑ
g
i
ig
i=1


= 0.

(9)

(10)

We numerically update λg using
λ̂(t+1)
= argmin
g
λg

(

)

2
∂
Q Θ, Λ, Θ̂(t+1) , Λ̂(t)
∂λg

(11)

such that λ ∈ (K − min(ni ) − 1, U ]. Upper bound U prevents numerically instability
incurred due to having a large degree of freedom. For this third algorithm, repeat, in
order, (9), (4), (10), and (11) until convergence. The above three versions of the proposed
EM algorithm allow for different assumptions on the Wishart distribution, namely with
9

respect to how the degrees of the freedom parameter are handled, and as such we treat the
three approaches as competing methods. Our subsequent analyses were conducted with
U = 50 for both variations of EM.

2.2.3

Yule-Walker Estimators

The ARMM representation of the WMM through the use of the Yule-Walker equations
can provide an alternative representation of the model that can provide some advantages.
The mean of Wishart distribution is ni Σg , the mean of autocorrelation matrices, Ci . The
cluster level covariance Σ̂g is an intuitive and proportional estimator of the autocorrelation
matrix for each group. We can use Σ̂g in the Yule-Walker estimator for AR coefficients as
it relies on a matrix that is proportional to the autocovariance matrix. The matrix can be
blocked as





T
 qg ug 
,

Σ̂g = 

ug Qg

where qg is scalar, ug is a K − 1 vector, and Qg is a K − 1 square matrix. The YuleWalker system for estimating AR coefficients is given as the method of moments estimator
h
iT
(1)
(2)
(K−1)
Φ̂g = φ̂g , φ̂g , . . . , φ̂g
= Q−1
g ug .
The Yule-Walker estimation results in group AR models given in equation (1) where αi
and τi are the only parameters specific to individual i. Early on, we disregarded variance
by working with autocorrelations, and now it reappears in the model as τi , the parameter
(k)

for individual specific variance. The Σ̂g maps to the autoregressive parameters, φ̂g

and

is estimated using data across individuals, creating a robust group model. Incorporating

10

individual i’s group indicator, zig from the WMM, we arrive at the final ARMM
(t)
yi

= αi +

G
X
g=1

zig

"K−1
X

#
(t−k)
φ(k)
g yi

(t)


(t)
ei ∼ N 0, τi2 .

+ ei ,

(12)

k=1
(k)

The zig govern AR model membership for individual i; φg characterizes the autoregressive
behavior; αi and τi2 allows for across individual heterogeneity; and ni is incorporated into
the WMM likelihood in equation (2) and modulates the influence of individual i.

Figure 1: Schematic of Parameter Estimation for the Wishart Mixture Model.
In the first phase, four example time series are mapped to autocorrelation matrices, Ci , and
are processed by the WMM. In the second phase, Σ̂g is used to estimate the AR coefficients
φg via Yule-Walker estimation. In the third phase, group indicators zig are combined with
the group AR models to create the ARMM.

11

2.2.4

Selecting G and K

We can use a pre-specified number of clusters G and lag K, based off of prior knowledge, or
it can selected based on a penalization criteria such as AIC (Akaike, 1974). The complete
data likelihood of ARMM model presented in equation (12) is
L(ΘAR , Φ1 , . . . , ΦG ) =

zig
n∗i
I Y
G


Y
Y
(t)
(t−1)
(t−K+1) 
 πg
f yi |αi , τi2 , Φg , yi
, . . . , yi
i=1 g=1

(13)

t=K

where

ΘAR, = π1 , . . . , πG ; α1 , . . . , αI ; τ12 , . . . , τI2 ,


(2)
(K−1)
Φg = φ(1)
,
g , φg , . . . , φg



(t−K+1)
(t−1) (t−2)
(t)
is the conditional normal pdf of the AR model
, . . . , yi
, yi
f yi |αi , τi2 , Φg , yi
and π̂g , Φ̂g , and zig are already calculated using the WMM. At this point, we only need
Pn∗i (t)
to estimate αi and τi2 as α̂i = n1i t=K
ri , and τ̂i2 =
i
hP
P
(t)
K−1 (k) (t−k)
G
.
yi −
k=1 φ̂g yi
g=1 zig

1
ni

Pn∗i

(t)
t=K (ri

(t)

− α̂i )2 where ri

=

There are 2I parameters for αi and τi2 but they do not depend on group number G. The
only parameters that depend on G are Φg and πg , which exist on a G dimension simplex.
Therefore, we propose using the AIC to identify G and K, more specifically by minimizing:
AIC = 2(G × K − 1) − 2 log L(Θ̂AR , Φ̂1 , . . . , Φ̂G ).

2.3

(14)

Competing Methods

We consider a few other time series clustering methods to compare performance with. As
one naive alternative approach to consider, each individual is fitted with a AR model and
12

the AR coefficients are averaged across individuals to obtain the model average. We use
a Gaussian mixture model (GMM) and treat individual i’s Yule-Walker AR coefficients,
iT
h
(1)
(2)
(K−1)
bi = φ̂i , φ̂i , . . . , φ̂i
as observations of a multivariate normal distribution. We
elect to use Yule-Walker coefficients due to the computational burden of finding maximum
likelihood estimates for each individual. The GMM complete data likelihood is given as
L(π1 , . . . , πG , Φ1 , . . . , ΦG , Ω1 , . . . , ΩG ) =

I Y
G
Y

(πg f (bi |Φg , Ωg ))zig

i=1 g=1

where bi | {Zig = 1} ∼ N (Φg , Ωg ). We calculate π̂g , Φ̂g , and ẑig using the GMM, rather
than the WMM, using R package mclust (Fraley et al., 2014).
We also explore additional clustering methods that calculate pairwise distances between
all individuals for hierarchical clustering, a variety of which are outlined in Montero et al.
(2014). Alternatively, these distances can be calculated using a network community detection approach outlined in Ferreira and Zhao (2016). When working with concave distances,
Valk and Pinheiro (2012), outlined a quasi U-statistics approach. We compared hierarchical
clustering based on three relevant distance measures. These methods fall under the class
of hard clustering and do not estimate the ARMM model; while WMM and GMM are soft
clustering methods and do estimate the ARMM model. Therefore, for the hard clustering
methods after we obtain zig we estimate πg , Σg , using equations (4), (5) and estimate the
ARMM coefficients using Yule-Walker equations so we may compare models using AIC.
First we consider the distance defined by Galeano and Peña (2001) between two time
series derived using autocorrelations
dACF

v
uK−1
uX
(ρ̂i (k) − ρ̂j (k))2 .
(yi , yj ) = t
k=1

13

Next, we define dP ACF (yi , yj ), as dACF (yi , yj ), replacing the autocorrelation with partial
autocorrelation as our second distance measure. Finally, we use Piccolo distance defined
as
v
uK−1 
2
u X (k)
(k)
φ̂i − φ̂j
,
dP IC (yi , yj ) = t
k=1
(k)

where φ̂i

are Yule-Walker AR coefficients, for our third distance measure (Piccolo, 1990).

These set of methods are compared through simulation to determine relative accuracy in
identifying true cluster membership.

3
3.1

Results
Consistency of Estimators

It is well known that EM converges to the local maximum; typically multiple runs from
random starting guesses are executed to determine the MLE. In practice, it’s difficult to
recruit more individuals in a study. Computationally, the MLE of the ARMM likelihood
given in equation (13) is a difficult optimization problem, while the WMM offers a simplified estimation procedure. We have found that, under certain conditions, the WMM is a
consistent estimator as ni increases i.e. as more observations per individual are obtained:

Condition 1. The EM algorithm is initialized in a strictly concave region of the global
maximum.
Condition 2. The yi is a causal AR(K − 1) process for all i.
Condition 3. The number of groups, G is correctly specified.

14

Theorem 3.1. Let Conditions 1–3 hold, and ni → ∞ for all i, then Ci converges in
probability to its true autocorrelation matrix, ẑig converges in distribution to an indicator
function for true labels and AR coefficient estimates converge in distribution to the true
d

parameters, Φ̂g → Φg .
Proof. The proof is left to Appendix 5.

3.2

Simulation Studies

To evaluate the performance of competing methods, we conducted two simulation studies.
We have labeled the following algorithmic denotations: EM1: (3)–(5), EM2: (6)–(8) and
EM3: (9)–(11). The other methods considered are the Gaussian mixture model (GMM), the
autocorrelation distance clustering (ACF), the partial autocorrelation distance clustering
(PACF), and the Piccolo distance clustering (PIC). We simulated I = 200 individuals with
G = 2 groups and 100 individuals in each group. For g = 1, we simulated 100 time series
h
i
(1)
(2)
using autocorrelation [ρ(1), ρ(2)] = [0.9, 0.8] mapped to AR(2) coefficients φ1 , φ1
=
[0.9474, −0.0526] with the Yule-Walker equation. For g = 2, we simulated 100 time series
h
i
(1)
(2)
using autocorrelation [ρ(1), ρ(2)] = [0.75, 0.5] mapped to AR(2) coefficients φ2 , φ2 =
[0.8571, −0.1429]. We repeated this procedure 1000 times for two cases, varying in their
time series sample size. In the first case the time series sample size of each individual was
drawn from n∗i ∼ P oisson(50) while in the second case n∗i ∼ P oisson(100).

15

Figure 2: Plot of Simulated Data and Label Recovery Accuracy. The first row are
the simulation results for Case 1 and second row are the results for Case 2. First column
shows the plot of the simulated autocorrelations, red being g = 1 blue being g = 2, and
the true autocorrelations in solid black lines. Second column shows estimated Φ̂g for each
time series (g = 1: ◦, g = 2: +) and the true Φg in solid black dots. Third column shows
box plot of accuracy of true zig label recovery for each method over 1000 simulations.

16

Table 1: Contingency Table of Method Selection Frequency Based on AIC. For
both cases and at each of the 1000 simulation, all methods were applied to the data at
different clusters sizes. Using AIC, a method was selected for each simulation.

Method

Case 1

Case 2

G = 1 G = 2 G = 3 Total

G = 1 G = 2 G = 3 Total

GMM

2

141

3

146

0

236

17

253

ACF

58

209

9

276

1

221

5

227

PACF

0

2

1

3

0

1

0

1

PIC

0

0

0

0

0

0

0

0

EM1

0

20

0

20

0

39

0

39

EM2

5

492

1

498

0

450

0

450

EM3

3

54

0

57

0

30

0

30

Total

68

918

14

1000

1

977

22

1000

In Figure 2, the first two columns of plots shows that the autocorrelation and coefficients
exhibits distinct separation as time series sample size increases. The third column of plots
shows WMM methods outperforms the competing methods at label recovery of the true
zig , with EM2 marginally out performs the other WMM methods at label recovery. Table
1 shows that as the time series sample size increases, overall model selection of the correct
G improves. The WMM methods are favored by AIC selection, with EM2 out performing
all other methods. EM2, which assumes group-level degrees of freedom (as opposed to
individual-level) estimates ng and performs well in settings which the time series sample
17

size is homogenous, such as our simulation study. However, in subsequent analysis, we
find that EM1 and EM3 out perform EM2 when time series sample size is variable across
individuals.
Outside of WMM methods, ACF performs best at label recovery and AIC model selection. ACF is closely relate to the WMM, as both utilize autocorrelations to cluster
individuals. However, the WMM is better suited for clustering autoregressive time series,
weight is increased relatively on the shorter lags as the jth lag only has 2(K − j) entries in
the autocorrelation matrix, whereas each lag has equal weight in the AR coefficient-based
models. As a result the GMM and AR coefficient-based methods are not able to discern
the true difference between individuals as distance measures appear small, while differences
across the respective correlation matrices are more easily detected.

3.3

Application: COVID-19

The COVID-19 time series data for 50 U.S. states, Puerto Rico (PR), and Washington
D.C (DC) was obtained from the The New York Times GitHub: https://github.com/
nytimes/covid-19-data (Times, 2020). Time series data for each state consist of cumulative number of cases, recorded daily, from January 21, 2020 to May 22, 2020. In our
analysis, we applied a log transformation on the time series data. We also omitted any
time points with cumulative cases less than 100, as data collection often was inconsistent
during the onset of an outbreak (COVID et al., 2020). An ARMM was fit in order to
estimate varying rates of disease transmission over time in the U.S. We used a combination
of G = 1, 2, 3, 4 clusters and AR(1)–AR(3) models, using WMM and competing methods

18

with AIC, defined in equation (14), for model selection.
Table 2: ARMM AIC Value of Each Method. AIC value of AR(1)–AR(3) models
paired with cluster count G for each model fitting method. Based on AIC: a First choice,
b

Second choice, c Third choice
AR(K − 1)

G

GMM

ACF

PACF

PIC

EM1

EM2

EM3

AR(1)

1

-10656.04

-10656.04

-10656.04

-10656.04

-10656.04

-10656.04

-10656.04

2

-11058.52

-11043.86

-11043.86

-11043.86

-11089.45

-10942.41

-11090.52

3

-10950.88

-11109.24

-11109.24

-11109.24

-11056.48

-10938.41

-11069.53

4

-10963.39

-11136.26c

-11136.26c

-11136.26c

-11007.81

-10934.35

-11053.41

1

-10755.23

-10781.97

-10781.97

-10781.97

-10781.97

-10781.97

-10781.97

2

-10777.17

-11046.40

-10777.33

-10785.20

-11151.43b

-11125.95

-11055.75

3

-11064.42

-11035.87

-10749.92

-10762.28

-11128.24

-11119.95

-11158.41a

4

-10729.86

-11086.69

-10791.50

-10836.40

-11069.16

-11113.93

-11131.35

1

-10722.52

-10761.41

-10761.41

-10761.41

-10761.41

-10761.41

-10761.41

2

-10888.48

-11041.14

-10784.64

-10770.29

-11038.40

-11003.13

-10951.08

3

-10806.01

-11023.35

-10793.72

-10725.05

-11042.39

-10995.13

-11093.64

4

-10743.71

-11030.20

-10757.91

-10711.63

-11014.16

-10968.46

-11035.71

AR(2)

AR(3)

From Table 2 we see that ACF, PACF, PIC, and WMM have the same value for G = 1 as
they share the same AR estimation procedure. Under the AR(1) model, ACF, PACF, PIC
are equivalent due to the autocorrelation being equal to the Yule-Walker AR coefficient,
which is the same for each. In fact, under AR(1) and G = 1 all methods are equivalent as
the autocorrelation is equal to the Yule-Walker AR coefficient. The AIC of GMM differs for
AR(2) or G = 2 because we no longer have the autocorrelation equaling the Yule-Walker
AR coefficients and GMM does not use distance measures for clustering.
AR coefficient-based methods outperforms WMM in the AR(1) setting as G increases,

19

allowing clustering to tease out more specific group models. However, a single lag model
may not be sufficient to capture the autoregressive trend present in the data. Based on
AIC: AR(2), G = 3, EM3, is the preferred model, with AR(2), G = 2, EM1 being the
next choice. Equation (13) highlights how the likelihood of the ARMM benefits from high
sample size states having accurate coefficient estimates. Only EM1 and EM3 incorporates
each state’s time series sample size into the estimation process, which serves to mitigate the
influence of low sample size states. EM3 allows extra flexibility in the degree of freedom
parameter and subsequently was able to discern three distinct autocorrelation structures,
with their respective AR coefficients shown in Table 3.
Table 3: Table of AR(2) Coefficients. Group models were ranked by their effect size,
resulting in three distinct autoregressive models for transmission among U.S. states.
(1)

Transmission

φ̂g

(2)

φ̂g

high

0.9836

-0.0371

moderate

0.9470

-0.0199

low

0.8939

0.0024

20

Figure 3: Principal Component Plot of Group Labels. Jittered principal component
plot of ẑig is provided for visualizing three clusters. CA, MA and NY were clustered together
with the highest effect size among our models, suggesting a high disease transmission rate
over the study period. States such as HI, ID, MO, MT, OK, PR, WY and VT belong to the
cluster with low transmission rate. The remaining states are clustered into the moderate
transmission group.

The group ranks for transmission rates and state memberships are provided in Table
3 and Figure 3. Estimation of AR models and clustering is agnostic of gross number of
cases, but models lag conditional growth over time. This prevents clustering states by
total cumulative number of cases, as NY state’s case count far exceeds all other states and
is still clustered together with CA and MA. Our results suggest that these three states,
CA, MA and NY, exhibit a high transmission rate throughout the study period, and is
corroborated by initial findings from the Center of Disease Control (CDC) Morbidity and
Mortality Weekly Report (MMWR) for February 12–April 7, 2020 (COVID et al., 2020).
The MMWR listed states such as, CA, MA and NY, as contributors to the majority of
21

nationwide wide cases, suggesting high transmission within these states. Our findings show
that high transmission was sustained in the following weeks, after the initial MMWR, in
CA, MA and NY.
Our underlying assumption is that each cluster of states shares unobserved characteristics, i.e. a latent group variable, which confounds the outcome of each group model. For
example, a hypothesized explanation is low population density among low transmission
states having inhibited the spread of COVID-19. These unobserved group characteristics
are well elucidated by our latent group model.

4

Conclusion

With the goal of estimating time series models, we took advantage of the longitudinal
nature of the data to cluster individuals through a WMM framework, which relies on discerning difference between autocorrelation matrices across individuals which may not be
obviously reflected in AR coefficients or stand alone autocorrelations. The WMM likelihood incorporates an individual’s time series sample size, allowing it to weight the influence
of each individual, and allows some general flexibility to model autocorrelation matrices
simultaneously while identifying group membership. Using the group estimate of Wishart
scale matrices and the Yule-Walker equations, we estimate group AR coefficients which are
consistent as time series sample sizes increase. Combining all group models, we arrive at
a parsimonious ARMM for the study population. We found that WMM performs better
at latent group label recovery in a variety of empirical settings than competing methods.
In addition, using the WMM to estimate the ARMM we found three clusters that natu22

rally divided regions into different degrees of infection and transmission rates of COVID-19
over states/regions of the United States. In particular, the latent group structure estimates naturally clustered states into three ordered categories of high, moderate and low
transmission.

SUPPLEMENTARY MATERIAL

5

Proof of Theorem 3.1

Since we evaluate the estimator as all ni → ∞, for ease of notation, assume ni = n ∀i and
n → ∞. In addition, assume that Di is zero centered. By the asymptotic behavior of the
Yule-Walker estimates for causal AR processes, autocorrelation matrices as a sequence of
n, given as
Ci (n) = (nVar(yi ))−1 DTi Di
P

converges in probability to their correct group autocorrelation matrix, Ci (n) → Vg , g =
1, 2, 3, . . . , G, and G ≤ I. Vg and Ci matrices are positive definite. Evaluating Σ̂g
PI
Σ̂g =

i=1 zig Ci (n)
P
n Ii=1 zig

Suppose labels zig are correct for group g, Σ̂g becomes: Σg =

Vg
n

and nΣg = Vg .

Update for the label are given as
πg fW (Vj |Σg , n)
πg fW (Ci (n)|Σg , n)
zig = PG
= PG
g=1 πg fW (Ci (n)|Σg , n)
g=1 πg fW (Vj |Σg , n)

23

(15)

P

where Ci (n) → Vj for j = 1, 2, 3, . . . , G. The pdf of the Wishart distribution is given as:


n/2

|Vj |−(K+1)/2 Vj Σ−1
1
−1
g
−1
fW (Vj |Σg , n) = K(K−1)/4
trace Σg Vj
exp

QK
n−k+1
2
| π {z
} | 2{z
}|
{z
} | k=1 Γ{z 2 }
M1

A

B

C

where M1 is a constant w.r.t. n.
−1
When j = g, the individual is in the correct group, then Σ−1
g Vj = nVg Vg = nI,
  K
Kn/2

n n/2
, B = exp −nK
and
AB
=
A = n2
. Evaluating the lower bound for C
2
2e

at k = 1,
C > QK

1

k=1 Γ

n
2

=

!K

1
Γ

n
2



and the lower bound of ABC is given as
ABC >


n n/2
2e 
Γ n2

!K
= DK .

Using the Laplace method or Stirling’s formula for gamma function,
r   
 
2π z z
1
Γ(z) =
1+O
z e
z
√n
√
to evaluate D, we get D = 1+O 4π1 = O( n). Thus, limn→∞ fW (Vj |Σg , n) = ∞, when
(n)
j = g.
−1
When j 6= g, the individual is in the incorrect group, then Σ−1
g Vj = nVg Vj = nW
n/2
Kn/2 QK
and wi > 0 are the eigenvalues of W. The rest is given as A = n2
w
, and
i
i=1

K
P
−n/2
K
1
B = exp
. Evaluating the upper bound for C at k = K, C < Γ n−K+1
.
i=1 wi
( 2 )

Thus, the upper bound for ABC is given as
n/2
!n/2 
K
 n Kn/2 Y
1

P

ABC <
wi
K
2
exp
i=1
i=1 wi
!
!
K

n/2
K
n n/2
Y
wi
2

=
exp (wi )
Γ n−K+1
2
|
{z
} i=1
EK

24

!K

1
Γ

n−K+1
2



Using Stirling’s formula to evaluate E, we get
n n/2
2

n−K+1
2



E=

Γ

=q


n n/2
2
4π
n−K+1

=

=

=

=


n n/2
2

 n−K+1
2

1+O

1
n



√

n−K +1
n−K+1


2
4π n−K+1
1 + O n1
2e
 √
 n−K+1
n n/2
2e
2
n
−
K
+
1
2
n−K+1
√

4π 1 + O n1
 √
 n2
 −K+1
n n/2
2e
2e
2
n
−
K
+
1
2
n−K+1
n−K+1
√

4π 1 + O n1
 n2
 −K+1
√
n
2e
2
n − K + 1en/2 n−K+1
n−K+1
√

4π 1 + O n1
 n2
 −K+1
√
−K+1
n
2
2
n − K + 1en/2 n−K+1
e 2
n−K+1
√

4π 1 + O n1
 n2 n−K+1  K−1
√
−K+1
n
2
n − K + 1en/2 n−K+1
e 2
2
√

4π 1 + O n1

=√

=

n−K+1
2e

Because we are working in asymptotic behavior, n → ∞, we use the following limit representation of e,
−K+1

e


=

1
1 + (−K + 1)
n

n


=

n−K +1
n

25

n
=⇒ e

−K+1
2


=

n−K +1
n

 n2
.

Continuing the derivation for E, we get
√
E=
√
=
=

n − K + 1en/2

n
n−K+1

√

n − K + 1en/2
√
4π 1 + O

 n2

n−K+1
2

1
O n

 K−1
2

n−K+1
n

 n2

4π 1 +
 K−1
n−K+1
2
2

1
n

(n − K + 1)1/2 en/2 (n − K + 1)
√
 K−1
4π 1 + O n1 2 2

K−1
2

K

en/2 (n − K + 1) 2
=√
 K−1
4π 1 + O n1 2 2
= O en/2 nK/2



The upper bound of ABC is now given as
K
ABC < en/2 nK/2

K
Y
i=1

wi
exp (wi )

where M2 is a constant w.r.t. n. Finally,

!n/2
= nM 2

wi
exp(wi −1)

K
Y
i=1

wi
exp (wi − 1)

!n/2

≤ 1 and the equality only holds when

wi = 1, but in our case wi 6= 1 for every i because W 6= I. Thus, r =

QK

wi
i=1 exp(wi −1) ,

and 0 <


r < 1. The upper bound for ABC is given as O nM2 rn/2 . Thus, limn→∞ fW (Vj |Σg , n) =
0, when j 6= g.
In a single causal AR process, Ci and Φ̂i converges in probability to the true values.
Under, strict concavity, iterative convergence of the EM algorithm, our label zig given in
(15) converge 
in distribution
 to the indicator function for the correct group, as n increases.
T
 qg ug 

 is a consistent AR coefficient estimator through Yule-Walker
Vg ∝ Σg = 

ug Qg

equations, Φg = Q−1
g ug and therefore also converges in distribution.

26

References
Akaike, H. (1974), “A new look at the statistical model identification,” IEEE transactions
on automatic control, 19, 716–723.
Brockwell, P. J., Davis, R. A., and Fienberg, S. E. (1991), Time series: theory and methods:
theory and methods, Springer Science & Business Media.
Byrd, R. H., Lu, P., Nocedal, J., and Zhu, C. (1995), “A limited memory algorithm for
bound constrained optimization,” SIAM Journal on scientific computing, 16, 1190–1208.
Chiou, J.-M., and Li, P.-L. (2007), “Functional clustering and identifying substructures of
longitudinal data,” Journal of the Royal Statistical Society: Series B (Statistical Methodology), 69, 679–699.
COVID, C., Stephanie, B., Virginia, B., Nancy, C., Aaron, C., Ryan, G., Aron, H.,
Michelle, H., Tamara, P., Matthew, R. et al. (2020), “Geographic differences in
COVID-19 cases, deaths, and incidenceUnited States, February 12–April 7, 2020,”
https://www.cdc.gov/mmwr/volumes/69/wr/pdfs/mm6915e4-H.pdf.
Dempster, A. P., Laird, N. M., and Rubin, D. B. (1977), “Maximum likelihood from
incomplete data via the EM algorithm,” Journal of the Royal Statistical Society: Series
B (Methodological), 39, 1–22.
Ferreira, L. N., and Zhao, L. (2016), “Time series clustering via community detection in
networks,” Information Sciences, 326, 227–242.

27

Fraley, C., Raftery, A., and Scrucca, L. (2014), “mclust: Normal mixture modeling for
model-based clustering, classification, and density estimation,” R package version, 4.
Galeano, P., and Peña, D. (2001), “Multivariate analysis in vector time series,” .
Genolini, C., Alacoque, X., Sentenac, M., Arnaud, C. et al. (2015), “kml and kml3d: R
packages to cluster longitudinal data,” Journal of Statistical Software, 65, 1–34.
Hidot, S., and Saint-Jean, C. (2010), “An Expectation–Maximization algorithm for the
Wishart mixture model: Application to movement clustering,” Pattern Recognition Letters, 31, 2318–2324.
James, G. M., and Sugar, C. A. (2003), “Clustering for sparsely sampled functional data,”
Journal of the American Statistical Association, 98, 397–408.
Montero, P., Vilar, J. A. et al. (2014), “TSclust: An R package for time series clustering,”
Journal of Statistical Software, 62, 1–43.
Piccolo, D. (1990), “A distance measure for classifying ARIMA models,” Journal of Time
Series Analysis, 11, 153–164.
Times, T. (2020), “Coronavirus (Covid-19) Data in the United States,” .
Valk, M., and Pinheiro, A. (2012), “Time-series clustering via quasi U-statistics,” Journal
of Time Series Analysis, 33, 608–619.
Walker, G. T. (1931), “On periodicity in series of related terms,” Proceedings of the Royal
Society of London. Series A, Containing Papers of a Mathematical and Physical Character, 131, 518–532.
28

Yule, G. U. (1927), “VII. On a method of investigating periodicities disturbed series, with
special reference to Wolfer’s sunspot numbers,” Philosophical Transactions of the Royal
Society of London. Series A, Containing Papers of a Mathematical or Physical Character,
226, 267–298.

29

