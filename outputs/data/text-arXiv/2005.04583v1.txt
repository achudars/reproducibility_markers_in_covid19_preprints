Modeling the spread of infectious disease in urban areas with travel
contagion
Xinwu Qian, Satish Ukkusuri

arXiv:2005.04583v1 [physics.soc-ph] 10 May 2020

Lyles School of Civil Engineering, Purdue University

Abstract
Urban mass transportation system satisfies the essential mobility needs of the large-scale urban population,
but it also creates an ideal environment that favors the spread of infectious diseases, leading to significant risk
exposure to the massive urban population. In this study, we develop the mathematical model to understand
the coupling between the spreading dynamics of infectious diseases and the mobility dynamics through urban
transportation systems. We first describe the mobility dynamics of the urban population as the process
of leaving from home, traveling to and from the activity locations, and engaging in activities. We then
embed the susceptible-exposed-infectious-recovered (SEIR) process over the mobility dynamics and develops
the spatial SEIR model with travel contagion (Trans-SEIR), which explicitly accounts for contagions both
during travel and during daily activities. We investigate the theoretical properties of the proposed model and
show how activity contagion and travel contagion contribute to the average number of secondary infections.
In the numerical experiments, we explore how the urban transportation system may alter the fundamental
dynamics of the infectious disease, change the number of secondary infections, promote the synchronization
of the disease across the city, and affect the peak of the disease outbreaks. The Trans-SEIR model is further
applied to the understand the disease dynamics during the COVID-19 outbreak in New York City, where
we show how the activity and travel contagion may be distributed and how effective travel control can be
implemented with only limited resources. The Trans-SEIR model along with the findings in our study may
have significant contributions to improving our understanding of the coupling between urban transportation
and disease dynamics, the development of quarantine and control measures of disease system, and promoting
the idea of disease-resilient urban transportation networks.
Keywords: Network modeling, Infectious disease, Travel contagion, Urban transportation system

1. Introduction
As of 2018, there were over 4.2 billion people living in urban areas and the number is estimated to reach
6.3 billion (70% of the total world population) in 2050 [1]. The rapid growth of the urban population gives
rise to the prosperity of the urban economy with much more travel and intensive daily activities. A notable
example is the development of urban mass transit systems. As the only affordable mobility solution to the
general urban public, it has grown to enormous scale in large cities with buses and metros serving over 53

Preprint submitted to Elsevier

May 12, 2020

billion passengers worldwide as of 2017 [2]. Behind the giant number, however, is an environment that favors
the spread of infectious diseases which constitutes a significant health risk to the entire urban community.
On the one hand, the urban population is making more trips and traveling a longer distance, with the average
annual person-mile traveled in the United States increased by 169% from 1969 to 2009 [3]. On the other
hand, people are spending more time in the transportation system especially in urban areas. For New York
City, the average commuting to work time exceeds 40 minutes for 69% of the city’s neighborhoods, and 59%
of New York commuters use mass transit as the tool for commuting. To meet the growing mobility needs
with limited mobility resources, the mass transit systems are developed to carry as many passengers, leading
to enclosed compartments with high population density, close proximity, and long duration. This represents
sufficient exposure duration and a close-enough distance that allows for the pathogens to migrate among
unprotected daily commuters. A direct consequence is the recent outbreaks of the COVID-19 in major cities
worldwide [4] with over 4 million confirmed cases and 270 thousand deaths as of May 2020. Despite the
significant risks associated with the urban transportation system and the outrageous consequences caused
by numerous infectious diseases, the role played by the urban transportation system during the outbreaks of
infectious diseases in urban areas remains largely unexplored. This motivates us to make the initial attempt
to model the contagion process during travel and further explore possible mitigation measures that may help
to curb the spread of infectious diseases.
There are two main approaches in the literature for characterizing the dynamics of infectious diseases.
The first approach comprises of the compartment model, where the initial SIR model (also known as
Kermack-McKendrick model) divides the population into compartments of susceptible, infected, and recovered, and non-linear ordinary differential equations (ODE) are used to model the dynamics among the
compartments [5]. Based on the SIR model, a variety of models have been developed to account for more realistic disease nature, including models which consider the incubation period [6], the vertical transmission [7],
the age structure [8], and the vaccine strategy [9, 10]. And extensive efforts were made to understand the
property of the model and analyze the local and global stability of the non-linear ODEs, where surveys of
related works can be found in [11, 12]. One major criticism for the compartment model is the oversimplified
assumptions, where the population in each compartment is assumed to be fully mixed and therefore each
individual has the same behavior. Therefore, the model may fail to represent the complex mobility and
contact patterns for many real-world diseases. To address this shortcoming, the second approach models the
disease propagation at the individual level over large-scale networks, where each individual is represented by
a node and their contact structure is captured by the set of edges [13, 14]. The approach was developed based
on the method of bond percolation model, and the generation function was used for deriving the important
attributes of a certain contact network, including the average degree and excessive degree, which later used
to calculate the size of the disease outbreaks. Danon et al. [15] conducted a comprehensive review of the
works in this approach. The contact network model helps to capture diverse interactions among individuals
with given distribution and contributes to the understanding between disease dynamics and the network

2

topology. However, it is not applicable to understand the spread of infectious disease in densely populated
urban areas: it is computationally intractable to construct the individual contact network for all urban
populations and it is also impossible to obtain the necessary input for the contact network as evaluating the
individual’s contact pattern will be very expensive.
In light of the existing efforts and issues, to model the spread of infectious diseases for the urban areas,
the compartment model is still the ideal choice due to its well-explored mathematical properties and the
scalability when it comes to model the mass urban population. However, the simplistic assumption of
homogeneous population mixing needs to be corrected as the population dynamics are highly heterogeneous
in large cities. In particular, since human mobility is the driving factor for the spread of infectious diseases,
it is necessary for the compartment model to account for the mobility dynamics around the city. And the
needs of mobility dynamics assert two additional challenges for developing appropriate compartment models
to represent the urban disease dynamics. First, the diverse land use and activity patterns in urban areas
suggest the necessity to incorporate the spatial-varying mobility patterns and activity patterns into each of
the original disease-related compartments, so that the rate of transmission and the amount of population
should be differentiated at individual subareas of a city. On the other hand, while the spatial movements
bring people to their activity locations, it also results in massive contact and contagion during travel which
is negligible given the existence of urban mass transit systems. This together with the spatial heterogeneity
require additional consideration to explicitly capture the contact and the disease transmission during travel
as separate compartments. To address these challenges, we propose the spatial SEIR model with travel
contagion (Trans-SEIR) to characterize the spread of infectious diseases in urban areas. The proposed model
overcomes the first challenge by developing an urban mobility model to represent the mobility dynamics of
leaving home, traveling to-and-from activity locations and activity engagements. Then the SEIR process
can then be overlaid with the mobility model to reflect the spatial heterogeneity of the disease dynamics. In
addition, the Trans-SEIR model considers two types of contagion, namely the activity contagion and travel
contagion, to explicitly separate the infections due to urban travel activities and the infections that arise
from daily activities such as work and entertainment. Based on the Trans-SEIR model, we further explore
the implementation of entrance control in the urban transportation system and develop the optimal resource
allocation problem which determined the distribution of limited medical resources and manpower over the
travel segments in urban areas to minimize the risk from the infectious diseases. To this end, the proposed
Trans-SEIR model represents a realistic modeling framework to understand the complete trajectories of
disease outbreaks in urban areas, and serves as the essential modeling components for devising optimal
control strategies and policies, which have significant implications to both preventative prevention as well as
disease mitigation from the urban transportation system perspective.
The rest of the study is organized as follows. In the next section, we briefly introduce the background of
epidemic modeling with compartment models and establish the basics for modeling the mobility dynamics.
In Section 3, we present the mathematical formulations for the Trans-SEIR model and analyze the theoretical

3

properties of the model, followed by the optimal entrance control model for urban transportation systems
in Section 4. In Section 5, we present the numerical experiments of both toy networks and the real-world
case study for the COVID-19 outbreak in New York City (NYC). Finally, we conclude our study with major
findings and insights in Section 6.

2. Modeling preliminaries
2.1. Notation
We summarize the list of variables used in this section as follows:
Table 1: Table of notation

Notation
S
E
I
R
Nip
Nir
Nij
β
1/σ
1/γ
µ
P
αi
gi
mij
rij
dM

Description
Variables
Susceptible population.
Exposed (latent) population.
Infected population.
The population who recovered from disease and got immunity.
Total amount of visitors who are current present at zone i.
Resident population at zone i.
The amount of people who are residents of zone i and currently present at zone j.
Fixed parameters
Contagion rate between S and I.
Length of latent period for population E.
Length of infectious period for population I.
Death and birth rate.
Total number of zonees in the area.
Arrival (departure) rate of external population for zone i.
Total departure rate of zone i.
P
The rate of movement from zone i to zone j, where j mij = 1.
The rate of return from zone j to zone i
Control rate of travel mode M .

2.2. Epidemic modeling
The well-known compartment model for capturing the dynamics of infectious diseases was proposed by
W.O.Kermack and A.G.McKendrick [5], where they consider that the population may experience three states
over time:
• Susceptible class or S(t) is used to represent the number of individuals not yet infected with the disease
at time t, or those susceptible to the disease.
• Infected class or I(t) denotes the number of individuals who have been infected with the disease and
are capable of spreading the disease to those in the susceptible category.
4

• Removed class or R(t) is the compartment used for those individuals who have been infected and then
removed from the disease, either due to immunization or due to death. Those in this category are not
able to be infected again or to transmit the infection to others.
And the compartment model has several key assumptions: (1) each individual in the population has an
equal probability of contracting the disease with a rate of β, (2) the population leaving the susceptible class
is equal to the number of people entering the infected class, (3) people recovered from the disease with a
mean recovery of 1/γ gain permanent immunity to the disease, and (4) the death rate is the same as the
birth rate so that the total population is fixed.
In reality, people who are infected by certain diseases may not present any symptoms until the end of
the incubation period, and it is important to take this latent period into consideration for more accurate
representation of disease dynamics. Consequently, the SEIR model was introduced with an additional compartment which is known as the latent class (E(t)) [16]. The population of E are considered as exposed but
not infectious, and will proceed into the infectious state with an average length of latent period of

1
σ.

Such

disease dynamics can be mathematically represented as:
dS
= −βSI + µ(N − S)
dt

(1)

dE
= βSI − µE − σE
dt

(2)

dI
= σE − γI − µI
dt

(3)

dR
= γI − µR
dt

(4)

2.3. Mobility model
The spread of infectious disease is closely interacted with the mobility pattern of urban population. Before
discussing the mathematical model for capturing disease dynamics, we first present the mobility model that
is followed by urban population.
The mobility model used in this study is adapted from the intra-city mobility model proposed by Sattenspiel and Dietz [17]. Different from the previous study, here we explicitly captures the mobility dynamics of
population during travel which is especially important for modeling the mobility dynamics in densely populated urban areas. Specifically, we divide the urban area into a collection of P zones and the population are
further classified into two groups: residents and visitors. Residents of zone i will be in one of the four states:
staying at the resident location, travelling to the activity location, engaging in activities, and travelling back
→
−
to the home location. Let N ij be the population who are residents of zone i and travel from i to j, Nij be
←
−
the population of residents of zone i who are currently at zone j, N ij be the population who travel from

5

j back to i and Ni be the population who remain at the resident location at i. We have the following two
equations to capture the total residents and visitors for a given zone:

Nir =

P
X

− + N←
−, ∀ i
Nij + N→
ij
ij

(5)

j=1

Nip

=

P
X

Nji , ∀ i

(6)

j=1

Equation 11 suggests that the amount of residents at zone i can be calculated as the summation of population
who are residents of zone i and currently at zone j. Similarly, equation 12 states that visitor population at
zone i consist of the residents of zone i who remain in i, as well as the population who reach zone i from
other zones.
For people in different groups, we assume a constant rate of death µ and an equal rate of birth. New
births of zone i are assumed to join the residents of the same zone (Ni ). For residents at zone i, a constant
departure rate is assumed (gi ) and the departed population may visit zone j for various daily activities (e.g.,
P
work or entertainment) with the split ratio of mij and j mij = 1. The departed population then join the
− . The population at activity
population in travel and will arrive at the activity location with a rate of α→
ij

location will return to their home at the rate of rij , who again join the population in travel and eventually
− . With the above description, we have the following system of ordinary
arrive at home with the rate of α←
ij

differential equations (ODE) for computing the mobility dynamics within a urban area:
−
dN→
ij

− N→
− − µN→
−
= gi mij Ni − α→
ij ij
ij

(7)

− N←
− − µN←
−
= rij Nij − α←
ij ij
ij

(8)

dNij
− N→
− − µNij
= −rij Nij + α→
ij ij
dt

(9)

dt
−
dN←
ij

dt

P

X
dNi
− N←
− − gi Ni − µNi + µNir
=
α←
ij ij
dt
j=1

(10)

With the above system of equations, we can calculate the rates of change for resident and visitor population as:

P
−
−
X
N←
N→
Nir
Nij
ij
ij
=
+
+
dt
dt
dt
dt
j=1

(11)

P

X Nji
Nip
=
dt
dt
j=1

(12)

The described system of equations will reach the equilibrium if equations 7 to 10 equal zero, e.g., there is

6

no change of population for each compartment. Consequently, for the equilibrium solution of the mobility
dynamics, we arrive at the following proposition:
Proposition 1. The system described by equations 7 to 10 is linear and has a unique equilibrium solution,
and the solution is globally asymptotically stable. In particular, at equilibrium, we have
Ni∗ +

P
X

∗
Kij Nij
= Nir

(13)

1
PP

(14)

j=1

Ni∗ =
where Kij = gi mij ( r1ij +

1
−
α←
ij

+

1+

j=1 Kij

Nir

1
).
−
α→
ij

Proof. Since the system is linear, and the matrix constitutes a strongly connected graph. The equilibrium
solution of the system can be calculated by setting equation 7 to 12 to zero. We have:
∗
N→
− =
ij

Let Kij =

gi mij
− +µ
α→
ij

−
− rij
gi mij α→
gi mij α→
gi mij
ij
ij
∗
∗
Nii∗ , Nij
=
Nii∗ , , N←
Nii∗
− =
ij
− +µ
→
− + µ)
→
− + µ)(α←
− + µ)
α→
(r
−
µ)(α
(r
−
µ)(α
ij
ij
ij
ij
ij
ij
−
gi mij α→

(15)

− rij
gi mij α→

ij
ij
+ (rij −µ)(α→
+ (rij −µ)(α→
. Based on equation 11 and the fact that Nir is fixed,
− +µ)
− +µ)(α←
− +µ)
ij

ij

we have:
Nii∗ +

ij

P
X

Kij Nii∗ = Nir

(16)

j=1,j6=i

We therefore have
Nii∗ =

1
1+

PP

j=1,j6=i

Kij

Nir

(17)

which gives equation 14.
To prove that the equilibrium solution is G.A.S, one can write the whole matrix M for system dN/dt =
M N . Since the urban areas can be viewed as a connected network, it can be easily shown that diagonal
entries in M are strictly negative (either −µ or −gi + µ) and the matrix M has all negative real eigenvalues,
which implies that the equilibrium point is G.A.S.
∗
In the following sections, we will write Nij to denote equilibrium population flow Nij
for notation sim-

plicity.

3. Modeling disease spreading with travel contagion
3.1. Notation
We summarize the list of variables used in this section as follows

7

Table 2: Table of notation

Notation
Sij
Eij
Iij
Rij
− , S←
−
S→
ij
ij
Nip
Nij
D
d
βA
βdT
cdij
1/σ
1/γ
κij
κdij,kl

Description
Variables
Susceptible population who are residents of zone i and currently in zone j.
Exposed (latent) population who are residents of zone i and currently in zone j.
Infected population who are residents of zone i and currently in zone j.
Recovered population who are residents of zone i and currently in zone j.
Susceptible population in travel from i to j and from j to i respectively. Similar notations
are used for E, I and R population.
Population at zone i.
The amount of people currently at zone j who are the residents of zone i.
Fixed parameters
Total number of travel modes available.
Travel mode d, where d = 1, 2, ..., D.
Disease transmission rate per valid contact at the activity location.
Disease transmission rate per valid contact during travel using mode d.
The ratio of people who choose travel mode d between zone i and zone j.
The expected latent duration remaining in E before moving to I.
The expected recover duration remaining in I before moving to R.
Expected number of valid contacts for residents of i who are currently at zone j.
Expected number of valid contacts for travelers from i to j who come across with travelers
from k to l using the same travel mode d.

3.2. System dynamics
Important components missing from the previously discussed SEIR model are the spatial movement of
urban population and the transmission of infectious diseases due to contacts during travel. The model
only considers local dynamics, but it is essential for urban areas to model explicitly how population flow
moving around the city. In particular, these flows are driven by various activities, such as work, school,
or entertainment. And people get in contact with others by taking different activities through various
transportation tools. As long as some individuals are infected, their activities and the urban transportation
mobility will take the disease to every corner of the city. This motivates us to understand the the spread of
infectious disease in urban area by modeling the system with the following 6 dynamics:
1. The mobility dynamics of urban population follows the model as discussed in Section 2.3.
2. Similar to the SEIR model, we consider Sij being affected by Iij with the inner-zone activity contagion
rate β A .
3. In addition to the spread of diseases due to activity engagement, we also consider people get infected
during travel. That is, Sij may be infected by contacting with Iij if they use the same travel mode d,
with the contagion rate of βdT .

8

4. Once people in Sij are infected, they become Eij . They are not infectious until the end of the latent
period, and the length of latent period is characterized by 1/σ.
5. People in Eij become Iij at the end of the latent period. And the length of the infectious period is
characterized by 1/γ.
6. At the end of their infectious period, people in Iij become Rij . For simplicity, we consider that they
gain permanent immunity to the disease (e.g., death, vaccinated, or fully treated) and will no longer
be infected.
In particular, the contagion process between susceptible and infected population can be illustrated by
the example of a 3-zone network as shown in Figure 1 For the illustration network, there are two travel links

1

2

3

𝑆𝑆11

𝑆𝑆12

𝑆𝑆22

𝑆𝑆13

𝑆𝑆23

𝑆𝑆33

𝐼𝐼11

𝐼𝐼12

𝐼𝐼22

𝐼𝐼13

𝐼𝐼23

𝐼𝐼33

Legend
1

Patch

Travel
link

Travel
contagion

Within-patch
contagion

Figure 1: Illustration of the disease contagion process in a 3-zone network

1-2 and 2-3 and three possible routes: from zone 1 to zone 2, from zone 1 to zone 3, and from zone 2 to zone
3. And we have two different contagions in this network. One is the inner-zone contagion which takes place
between S and I population in the same zone (1-3). Additionally, there is travel contagion (shown in dashed
line), which may happen if two population share overlay segments in their travel routes. Consequently, we
have two possible travel contagions: between people travel from 1 to 2 and 1 to 3, between people travel
from 1 to 3 and 2 to 3, and vice versa. While this is only an illustration, the overlay segments should also
be distinguished depending on the particular mode chosen by the commuters.

9

3.3. Formulation
With the above discussions on the system dynamics, we first differentiate the two contagion dynamics:
activity contagion and travel contagion, and can be written mathematically as:
fij (S, I) = βjA κij

fi (S, I) = βiA κi

− (S, I) =
h←
ij

D
X

−[
cdij βdT S←
ij

d=1

− (S, I) =
h→
ij

D
X
d=1

PN
Sij (Ij + k=1 Ikj )
Njp
PN

Si (Ii +

k=1 Iki )

(19)

Nip

P X
P κd
−
←
−←
− I←
X
kl, ij kl
k=1 l=1

−[
cdij βdT S→
ij

(18)

−
N←
kl

P X
P κd
−
←
−→
− I←
X
kl, ij kl
k=1 l=1

−
N←
kl

+

+

d
−
κ→
− ←
− I→
kl
kl, ij

−
N→
kl
d
−
κ→
− →
− I→
kl
kl, ij

−
N→
kl

]

(20)

]

(21)

Equation 20 summarizes the S population who returns to home i and get infected during travel, by
encountering I population to-and-from resident location in other places. Specifically, cdij gi mij Sii captures
the ratio of Sii who leaves for destination j using transportation mode d.

κd
kl,ij Ikl
Nkl

denotes the contact rate

with infectious population returning from l to k, which is simplified from:
κdkl,ij cdkl rkl Ikl
cdkl rkl Nkl

(22)

and κdkl,ij refers to the number of contacts on average between ODs kl and ij, and is a function of the travel
time. Similarly,

κd
kl,ij Ikk
Nkk

represents the contact rate with the infectious population leaving from k to l, which

is simplified from:
κdkl,ij cdkl gk mkl Ikk
cdkl gk mkl Nkk

(23)

With the above four different incidences for possible disease transmission, we can formally express the math-

10

ematical formulations that describe the transportation disease spreading process in urban area as follows:
P
X
Ei
− E←
− − σEi + fi (S, I) − µEi
= − gi Ei +
α←
ij ij
dt
j=1

Eij
− E→
− − σEij + fij (S, I) − µEij
= − rij Eij + α→
ij ij
dt
−
E→
ij
− (S, I) − α→
− E→
− − σE→
− − µE→
−
=gi mij Ei + h→
ij
ij ij
ij
ij
dt
−
E←
ij
− (S, I) − α←
− E←
− − σE←
− − µE←
−
=rij Eij + h←
ij
ij ij
ij
ij
dt
P
X
Ii
− I←
− + σEi − γIi − µIi
= − gi Ii +
α←
ij ij
dt
j=1
Iij
− I→
− + σEij − γIij − µIij
= − rij Iij + α→
ij ij
dt
−
I→
ij
− I→
− + σE→
− − γI→
− − µI→
−
=gi mij Ii − α→
ij ij
ij
ij
ij
dt
←
−
I ij
− I←
− + σE←
− − γI←
− − µI←
−
=rij Iij − α←
ij ij
ij
ij
ij
dt
P
X
Si
− S←
− − fi (S, I) + µ(Nir − Si )
= − gi Si +
α←
ij ij
dt
j=1

(24)

Sij
− S→
− − fij (S, I) − µSij
= − rij Sij + α→
ij ij
dt
−
S→
ij
− (S, I) − α→
− S→
− − µS→
−
=gi mij Si − h→
ij
ij ij
ij
dt
−
S←
ij
− (S, I) − α←
− S←
− − µS←
−
=rij Sij − h←
ij
ij ij
ij
dt
P
X
Ri
− R←
− + γIi − µRi
α←
= − gi Ri +
ij ij
dt
j=1
Rij
− R→
− + γIij − µRij
= − rij Rij + α→
ij ij
dt
−
R→
ij
− R→
− + γI→
− − µR→
−
=gi mij Ri − α→
ij ij
ij
ij
dt
←
−
R ij
− R←
− + γI←
− − µR←
−
=rij Rij − α←
ij ij
ij
ij
dt
The system described by equation 24 can be easily understood by decomposing each equation into the
part of mobility dynamics and the part of disease dynamics. For the mobility dynamics, the system of
equations is consistent with the mobility model which captures the movement of S, E, I, R population across
the city as well as the death and birth (only into susceptible population). As for the disease dynamics,
it involves the migration of population between compartments following the contagion process, the end of
latent period and the end of infectious period.

11

Proposition 2. Based on equation 24, we can decompose the system into F − V where we have


fi





(gi + µ + σ)Ei −

PP

j=1

− E←
−
α←
ij ij





 


 
− E→
−


 fij 
(rij + µ + σ)Eij − α→
ij ij


 


 
→
−
→
−
−

h→
(µ + σ + α ij )E ij − gi mij Ei 


 ij 


 
←
− )E←
− − rij Eij
−


h←
(µ
+
σ
+
α
ij
ij
ij 



F =  ,V = 
PP

− − σEi 
 (gi + µ + γ)Ii − j=1 I←
 0 
ij


 


 
− I→
− − σEij 
 (rij + µ + γ)Iij − α→
 0 
ij ij


 


 
− )I→
− − gi mij Ii − σE→
−
(µ + γ + α→
 0 
ij ij
ij 

 
− )I←
− − rij Iij − σE←
−
(µ + γ + α←
0
ij ij
ij

(25)

Considering that an infectious disease has been introduced into a city and follows the system described in
equation 24, an essential question to be answered is that if the disease will eventually invade the population.
Specifically, the above system compromises two equilibrium points as following:
Definition 3. The disease dynamic system characterized by equation 5.1-5.8 has two equilibrium points.
The first equilibrium point x0 is the disease free equilibrium (DFE):
Sij = Nij , Eij = Iij = Rij = 0

(26)

x0 = (N, 0, 0, 0)

(27)

The second equilibrium point is the endemic equilibrium with:
X

Iij > 0

(28)

ij

such that a strictly positive fraction population will be in the infectious state.
To address the previous question, it requires the understanding of the stability of disease free equilibrium
(DFE). In particular, if the DFE is stable, then the disease will be absent from the population, otherwise
it is always possible for disease outbreak. We next discuss the stability of the DFE with the presented
Trans-SEIR model.
3.4. Model analysis
To better analyze the model properties, we first rearrange the modeling parameters in the following order:
− , E←
− , E12 , E→
− , E←
− , . . . , Enn
←
− , I1 , I11 I→
− , I←
−, . . .
E1 , E11 , E→
11
11
12
12
11 11

− , I←
− , E→
− , I→
− being strictly zero as we do not consider within zone travels. We denote ZiE and ZiI
with E←
ii
ii
ii
ii

as the set of E and I population compartments that are associated with residents of zone i, e.g., ZiE =
12

− , E←
− , E12 , ..., E←
− }.
{E11 , E→
nn
11
11

If we linearize the system at the DFE point x0 , we have DF(x0 ) as:

0 0


0 0
DF(x0 ) = 

0 0

0 0

dfii (x0 )
dIii
dfij (x0 )
dIii

+
+

dhii (x0 )
dIii
dhij (x0 )
dIii

dfii (x0 )
dIij
dfij (x0 )
dIij

+
+

0

0

0

0



dhii (x0 )
dIij 
dhij (x0 ) 

dIij 

(29)





We can further partition matrix V as in the following format:



VE
V =
−Σ


V (1)
 E

..

.
 

VE (n)
0  
=

VI
VI (1)



−Σ





0

..

.















VI (n)

(30)

where Σ represents the diagonal matrix of σ. We use VE (i), with dimension 3n+1×3n+1, to represent the
block Jacobian matrix with respect to elements the corresponding population compartments in {i1, i2, ..., in}.
We can formally express each block of the corresponding matrix as:

Ei1

r













VE (i) = 

















i1 + µ + σ

E−
→
i1

E←
−
i1

...

−α−
→
i1
α−
→ +µ+σ
i1

−ri1

Ei

...

Ein

E−
→
in

E←
−
in

−gi mi1
.
.
.

α←
− +µ+σ
i1
.
−α←
−
i1

.

.

...

gi + µ + σ
.
.
.

−α←
−
in

...
.

.

.
rin + µ + σ

−gi min
−rin

−α−
→
in
α−
→ +µ+σ
in
α←
− +µ+σ
in



Ei1
































E−
→
i1
E←
−
i1
.
.
.

(31)

Ei
.
.
.
Ein
E−
→
in
E←
−
in

Finally, we have the same formulation for the corresponding block diagonal matrices (VI (i)) of I, with
the only differences being that all σ are replaced by γ. As a consequence, V is a lower-triangular matrix.
As for the transmission part of the formulation which corresponds to the new generation of infectious
population, we should have:


0
F =
0
13

F +H

0




(32)

In the equation, F represents the disease transmission that are related to local compartments and H accounts
for all transmissions that happen during travel. In this regard, we can also break F + H into n2 blocks of
matrix with each block (F + H)(ZiE , ZjI ) being a 3n × 3n matrix of the following form:

F + H(Z1E , Z1I ) . . .


F + H(Z2E , Z1I ) . . .
F +H =
..

..

.
.

F + H(ZnE , Z1I ) . . .
I−
→
j1

Ij1
N
 A
β1 κi1 i1
p
N1









E
I
(F + H)(Zi , Zj ) = 













I←
−
j1


F + H(Z1E , ZnI )


F + H(Z2E , ZnI )
,
..


.

F + H(ZnE , ZnI )

...

I−
→
jn

Ijn

(33)

I←
−
jn


h−
→ →
−
i1,j1
h←
− →
−
i1,j1

h−
→ ←
−
i1,j1
h←
− ←
−
i1,j1

h−
→ −
→
i1,jn
h←
− −
→
i1,jn

...
...
.

.

.
Aκ
βn
in

h−
→ →
−
in,j1

h−
→ ←
−
in,j1
h←
− ←
−
in,j1

h←
− →
−
in,j1

Nin
p
Nn
h−
→ −
→
in,jn
h←
− −
→
in,jn

...
...



h−
→ ←
−
i1,jn 


h←
− ←
−
i1,jn 











h−
→ ←
−
in,jn 

h←
− ←
−
in,jn

Ėi1
Ė−
→
i1
Ė←
−
i1
.
.
.

(34)

Ėin
Ė−
→
in
Ė←
−
in

and each h being represented as:

− =
−→
h←
ij , kl

− =
−←
h←
ij , kl

D
X

d
cdij βdT κ→
− ←
−

−
N←
ij

d=1

−
N→
kl

D
X

−
N←
ij

kl, ij

cdij βdT κd←
−←
−
kl, ij

d=1

−
N←
kl

,

,

− =
− →
h→
ij , kl

− =
− ←
h→
ij , kl

D
X

d
cdij βdT κ→
− →
−

−
N→
ij

d=1

−
N→
kl

D
X

−
N→
ij

kl, ij

cdij βdT κd←
−→
−
kl, ij

d=1

(35)

−
N←
kl

Proposition 4. VE (i) and VI (i) in V are invertible and VE (i)−1 and VI (i)−1 are strictly positive.
Proof. Since VE (i) and VI (i) have similar structure, without loss of generality, we here only show that VE (i)
is invertible and same argument can be applied to VI (i).
We note that, for VE (i), all diagonal elements are strictly positive and all off diagonal elements are either
zero or strictly negative. In this regard, VE (i) satisfies the Z-sign pattern. In addition, we have the column
sum for each column of VE (i) being µ + σ, which is also strictly positive. This suggests that all eigenvalues
of VE (i) have positive real part. This combines with the Z-sign pattern imply that VE (i) is a non-singular
M-matrix and this leads to VE (i)−1 > 0.
Based on Proposition 4, we can write the inverse of V as following:

V

−1

VE−1

=
VI−1 ΣVE−1

14

0
VI−1




(36)

And F V −1 is expressed as:

F V −1


(F + H)VI−1 ΣVE−1
=
0

HVI−1
0




(37)

As the (1,1) entry in equation 37 denotes the number of secondary infections that a new entrance in E
will produce, we can therefore determine the basic reproduction number (R0 ) by
R0 = σρ((F + H)(VE VI )−1 )

(38)

where ρ refers to the spectral radius (the real part of the largest eigenvalue) and (VE VI )−1 is a block diagonal
matrix.
Proposition 5. The average number of secondary infectious due to a single infectious person into a fully
susceptible population is given by R0 = ρ{(F + H)V −1 }, with ρ denoting the spectral radius. In addition,
if R0 < 1 then the DFE is locally asymptotically stable. Otherwise the DFE is unstable and the disease will
invade the population.
We omit the proof of Proposition 5 as it follows directly from Theorem 2 in [18]. Note that the each entry
in F + H has specific physical interpretations, with the (ij, kl)th entry representing the new infections that
an additional infectious person in kl compartment will produce in the ij compartment. Consequently, each
eigenvalue corresponds to the column of (F + H)V −1 refers to the R0 value of that particular compartment,
and that the R0i for zone i is determined by the largest R0 value among all compartments that are associated
with the residents of i.
We further observe that the column sum of VE is µ + σ, and the column sum of VI is µ + γ. As a result,
the row sum of each column in (VE VI )−1 is given by

1
(µ+γ)(µ+σ) .

Since (VE VI ) is a block diagonal matrix, so
←
−
is (VE VI )−1 . Then for the ijth column of the ith block, only the entries in rows i1, ..., in may be non-zero
and all other entries of the column are strictly 0. Then we can write out the vector for column sum Cij
explicitly as:
X
−1
Cij = 1| (
fi (VE VI )−1
ij + h(VE VI )ij )
i

N11
N1n
N21
N2n
Nnn
A
A
A
A
vij,in
p vij,i1 + · · · + βn κ1n
p vij,in + β1 κ21
p vij,i1 + · · · + βn κ2n
p vij,in + · · · + βn κnn
N1
Nn
N1
Nn
Nnp
n X
n X
n
n X
n
X
X
→
−
←
−
−
→
− ←
−←
−
−
→
−
→
− + h←
− )v ←
+
h→
(
h kl,im + h kl,im )vij,im + (
kl,im
kl,im ij,im

= β1A κ11

=
+

m=1 k=1 l=1
n
X
N1m
A
(βm
κ1m p
Nm
m=1
n
n
n
X XX

(

m=1 k=1 l=1

k=1 l=1
A
+ · · · + βm
κnm

Nnm
p )vij,im
Nm

− −
−−
→+(
→ )v −
→ + h←
h→
kl,im
kl,im ij,im

n X
n
X

− ←
−←
−
− + h←
− )v ←
h→
kl,im
kl,im ij,im

k=1 l=1

15

(39)

1
(µ+γ)(µ+σ) ,

As the column sum of Cij equals

n
X

we then have
1
(µ + γ)(µ + σ)

vij,im =

m=1

(40)

A
A
Denote βmin
κmin and βmax
κmax be the the greatest of all activity compartments, e.g.,

A
βmax
κmax =

max

i,j=1,...,n

βiA κji ,

A
βmin
κmin =

min

i,j=1,...,n

βiA κji

(41)

and hmax and hmin as the the trip segment with the highest and lowest contagious rate:
hmax = max{ max

i,j=1,...,n

hmin = min{ min

i,j=1,...,n

n X
X

−→
− →
−,
− + h←
h→
kl, ij
kl, ij

k=1 l=1
n X
X

− →
−→
− + h←
−,
h→
kl, ij
kl, ij

k=1 l=1

max

i,j=1,...,n

min

i,j=1,...,n

n X
X

−←
− ←
−}
− + h←
h→
kl,im
kl,im

(42)

− ←
−←
− + h←
−}
h→
kl,im
kl,im

(43)

k=1 l=1
n X
X
k=1 l=1

Then we have
A
A
min{βmin
κmin , hmin }
κmax , hmax }
max{βmax
≤C≤
(µ + σ)(µ + γ)
(µ + σ)(µ + γ)

(44)

A
A
κmax , hmax }
σ max{βmax
σ min{βmin
κmin , hmin }
≤ R0 ≤
(µ + σ)(µ + γ)
(µ + σ)(µ + γ)

(45)

and

A
A
κmax be the highest within zone contagion rate of all zones, and βmin
κmin be the
Corollary 6. Let βmax

lowest within zone contagion rate of all zones. If we assume κij being the same at all activity locations, then
R0 is bounded by the travel segments with the highest contagion rate.

4. Control the spread of disease within urban transportation system
With the Trans-SEIR model capturing the mobility and disease dynamics, we next investigate the research
question on the control of infectious diseases by placing entrance screening for transportation system. In
particular, we have seen the implementation of radiation thermometers during the 2003 SARS, 2012 MERS
and 2020 COVID-19 outbreaks at subway and bus stations and major transportation hubs. The entrance
screening aims to identify passengers at risk with abnormal body temperature or susceptible symptoms. And
additional measures such as distributing masks and random inspection by medical workers at the entrance
of transportation systems may also be efficient to reduce the risk exposure during travel. While entrance
screening can be of great value for the preventative purpose before the actual outbreak or to slow down
the invasion of diseases during an outbreak, there is a trade-off among the success rate of screening, the
amount of travelers that need to be examined and the incurred externalities such as excessive entry delays
and limited manpower and medical resources. In this regard, the essential issue to be addressed is how to
optimally distribute the available resources over the urban transportation systems to effectively curb the
16

spread of infectious diseases.
For the real-world transportation system, it is hardly possible to perform the entry control for all travel
modes. Instead, it is only viable to conduct such control over the medium and high capacity travel modes,
such as buses and metros. As a consequence, in our study, we assume that the travel modes are divided into
three categories:
1. Low capacity mode such as private vehicles and taxis
2. Medium capacity mode such as vans and buses
3. High capacity mode such as metro system
We do not consider the low capacity mode as the control target, and the low capacity mode typically
has fewer passengers per vehicle and therefore constituting the lowest chance of getting infected. On the
contrary, passengers using medium or high capacity mode are usually exposed to more co-riders in an
enclosed compartment for longer trip duration, and are therefore prone to higher chance of being infected.
To frame the optimal entrance control problem, we introduce additional parameters  and ξ, where ξ denotes
the success rate of screening of infectious travelers and ij represents the fraction of passengers traveling
between i and j that will be screened, with ij ∈ [0, 1]. For simply, here we only consider that the same
ξ and ij will be applied to all different modes, which can be easily extended to account for mode-specific
control parameters.
As the first step of framing the optimal control problem, we focus on scenario without resource constraint
and entrance control alters the disease dynamics by reducing the number of infectious passengers entering
− and I←
− once they are identified to be infected at the entrance. We consider
the travel compartments I→
ij
ij

that the identified infectious passengers will be permanently quarantined until they are no longer infectious,
− and R←
− respectively and shall no longer produce
so that they join the recovered travel compartments R→
ij
ij

further infections. In this regard, we can rewrite part of the disease system as:
−
I→
ij

dt
−
I←
ij
dt
−
R→
ij
dt
−
R←
ij
dt

− )gi mij Iii − α→
− I→
− + σE→
− − γI→
− − µI→
−
=(1 − →
ij
ij ij
ij
ij
ij
− )r I − α←
− I←
− + σE←
− − γI←
− − µI←
−
=(1 − ←
ij ij ij
ij ij
ij
ij
ij

(46)

− R→
− + γI→
− − µR→
−
=gi mij (Rii + Iii ) − α→
ij ij
ij
ij
− R←
− + γI←
− − µR←
−
=rij (Rij + Iij ) − α←
ij ij
ij
ij

so that the whole disease system is still well defined and the summation of all population still equals N .
Without loss of generality, we consider the corresponding control effectiveness of the mode m being m , then
 simply refers to
ij =

X
m

17

m
cm
ij 

(47)

By controlling the system without resource limitation, we may let  = 1, e.g. all travelers will be examined,
and the resulting system dynamics can be decomposed into F − Ṽ where Ṽ takes the form:

V (1)
 E

..

.
 

VE (n)
0  
=

ṼI
ṼI (1)



−Σ





VE
Ṽ = 
−Σ



0

..

.















ṼI (n)

(48)

Specifically, ṼI (i) has the same diagonal elements of VI (i) but all its off-diagonal elements are zero. In this
regard, each ṼI (i) is also a diagonal matrix and hence of larger dominant eigenvalue as compared to VI (i),
suggesting an overall shorter infection period for the travelers. Following the same approach as discussed in
the previous section, we can derive the reproduction number after transit control as:
R̃0 = ρ(F Ṽ −1 )

(49)

With curbing the spread of infectious through transportation control as the primary goal, we seek to identify
proper  to minimize the R̃0 , and the gap between R0 and R̃0 is therefore the reduction by controlling travel
contagion. We note, however, there is no clean and close representation to formulate the relationship between
 and R̃0 , which creates a barrier for devising optimal allocation strategy of limited resources. To overcome
this barrier, we seek an alternate approach to avoid this complication and build the connection between the
two variables through a modified next generation matrix where we have


0
F () = 
0

F +H
V¯I (),





VE



0

 , Ṽ = 
−Σ ṼI

(50)

where ṼI contains only the diagonal elements of VI and −V̄I includes all the off-diagonal entries of VI :
Ii1









− )r
(1 − ←

i1 i1




V̄I (i, ) = 

















I−
→
i1

I←
−
i1

...

Ii

...

Iin

I−
→
in

I←
−
in

α−
→
i1
(1 − −
→ )gi mi1
i1
.
.
.
.
α←
−
i1

.

.
α←
−
in

...
.
.
.

.

.

.
α−
→
in

(1 − −
→ )g m
in i in
(1 − ←
− )r
in in

18



Ii1
































I−
→
i1
I←
−
i1
.
.
.
Ii
.
.
.
Iin
I−
→
in
I←
−
in

(51)

We denote K̃ as the next generation matrix following F ()Ṽ −1 and K being the original next generation
matrix. We have the following propositions
Proposition 7. R0 > 1 if and only if R̃0 > 1, R0 =0 if and only if R̃0 = 0, and R0 < 1 if and only if R̃0 < 1

Proof. We have that R0 = 1 while s(F − V ) = 0, and R0 > 1 if s(F − V ) > 0, and R0 < 1 if s(F − V ) < 0.
By deriving R̃0 , we see that the corresponding F − Ṽ still holds. This completes the proof.
Proposition 8. A disease is controllable through entrance screening in transportation system if and only if
ρ(F (1)Ṽ −1 ) < 1.
The proof for Proposition 8 follows from the results of Proposition 7, where ρ(F (1)Ṽ −1 ) suggests that
R̃0 < 1 when  = 1 and R̃0 < 1 is equivalent to R0 < 1. Hence the proposition states that the disease
is controllable through public transportation if we may have access to unlimited resources to completely
quarantine all infectious travelers and reduce the R0 lower than 1.
In addition, Proposition 7 states that the we can focus on controlling R̃0 instead of R0 to mitigate the
impact from infectious disease, and more importantly eliminating the disease if we can lower R̃0 to be smaller
than 1. Cautions should be exercised, however, as R̃0 does not have the same physical meaning as R0 and
can not be interpreted as the number secondary infections. Based on this equivalency, we can rephrase
Corollary 6 to derive the corresponding value for R̃0 by measuring the column sum for F ()Ṽ −1 as:
X
−1
−1
C̃ij () = 1| (
fi (VE ṼI )−1
ij + h(VE ṼI )ij + V̄ (VE ṼI )ij )
i

=

β1A κ11 +

Pp

− )g1 m1j N
− →
− )r
βnA κ1n + (1 − ←
11
1j
1n 1n N1n
ṽij,in
p ṽij,i1 + · · · +
g1 + γ + µ
N1
r1n + γ + µ
Nnp
j=1 (1

Pp
→ )g m
βnA κnn + j=1 (1 − −
− )r
− )r
β1A κ21 + (1 − ←
βnA κ2n + (1 − ←
nj n nj Nnn
2n 2n N2n
21 21 N21
ṽij,in
+
p ṽij,i1 + · · · +
p ṽij,in + · · · +
r21 + γ + µ
N1
r2n + γ + µ
Nn
gn + γ + µ
Nnp
n X
n X
n h→
n X
n h→
− −
−−
− ←
→
−←
−
→ + h←
→ + 2α−
− + h←
− + 2α←
X
X
im
im
kl,im
kl,im
kl,im
kl,im
→+(
−
+
(
)ṽij,−
)ṽij,←
im
im
−
→+γ+µ
←
−+γ+µ
α
α
im
im
m=1
k=1 l=1

k=1 l=1

n
A
A
X
− )r
βm
κ1m + (1 − ←
− )rnm Nnm
βm
κnm + (1 − ←
nm
im im N1m
=
(
p + ··· +
p )ṽij,im
rim + γ + µ
Nm
rnm + γ + µ
Nm
m=1

+

n X
n X
n h→
n X
n h→
− −
−−
→
− ←
−←
−
→ + h←
→ + 2α−
− + h←
− + 2α←
X
X
im
im
kl,im
kl,im
kl,im
kl,im
→+(
−
(
)ṽij,−
)ṽij,←
im
im
→+γ+µ
−+γ+µ
α−
α←
im
im
m=1
k=1 l=1

k=1 l=1

(52)
where we use ṽ(ij, kl) to denote the corresponding the (ij, kl) entry of

VE−1 .

Specifically, all ṽ(ij, kl)

values are known once the parameters for VE are set. Considering the case where the screening cost is
linearly increasing with higher effort level ij as well as a greater number of travelers Iij , in order to reduce
the risk of infectious disease, our objective is therefore to optimally allocate a given resource B such that the
maximum eigenvalue of F ()Ṽ −1 is minimized. This can be well approximated by minimizing the maximum
column sum C̃ij through optimally resource allocation. And we can therefore express the optimal resource
19

allocation problem for controlling the disease through urban transportation system as following:
min max C̃ij ()

(53)

ij ≥ 0, ∀i, j
X
XX
−r N + c
− gi mij Ni ≤ B, ∀i, j
c
←
→
ij ij ij
ij

(54)



ij

subject to

i,j

i

j

Specifically, equation 54 denotes the resource constraint as the total screened passengers across all travel
segments should not exceed the available manpower. As a min-max linear programming problem, the optimal
resource allocation problem can be easily transferred into an equivalent linear programming problem:
min z

(55)

subject to
z ≥ C̃ij (), ∀i, j
ij ≥ 0, ∀i, j
X
XX
−r N + c
− gi mij Ni ≤ B, ∀i, j
c
←
→
ij ij ij
ij
ij,i6=j

i

(56)

j

The system of equation can be easily solved using commercial solvers, and for the numerical experiments we
use CPLEX in Matlab to obtain the optimally allocated resources.

5. Results
5.1. Experiment setting
The numerical experiments are conducted on a desktop with @3.5 GHz CPU and 32GB RAM. The codes
are written in Matlab and the disease trajectories are simulated using the ODE 45 solver. The numerical
experiments in this study consist of two parts. Based on toy networks as shown in Figure 2, the first part
is to compare the resulting disease dynamics with and without modeling the urban transportation system,
including the differences in disease trajectories, the impact on R0 values and the city-wide synchronization
of the diseases. We also investigate how disease outbreaks may evolve with varying urban structures and
transportation systems. The networks have 5 nodes and 25 OD pairs, meaning that each node is accessible
from the other. As each OD pair may have four states (S,E,I,R), the ODE system of this test network
therefore has 300 state variables and 300 equations. For the second experiment, we focus on validating
the effectiveness of the Trans-SEIR model with real-world networks. We choose New York City (NYC)
as the study area and verify the model outputs when compared to the reported data during the COVID19 outbreak. The NYC network is shown in Figure 7. NYC is divided into 15 zones and the network is

20

established following the Google transit information. The 15 zones lead to a system of 2760 state variables
and 2760 equations for the ODE system.

A

B
2

2

3

3

1

5

C

2
3

1

4

1

5

5

4

4
From\To
1
2
3
4
5

1
0.7
0.4
0.5
0.4
0.5

2
0.05
0.3
0.1
0.1
0.1

3
0.1
0.1
0.2
0.1
0.1

4
0.05
0.1
0.1
0.3
0.1

5
0.1
0.1
0.1
0.1
0.2

Residents

0.1

0.2

0.25

0.2

0.25

Figure 2: Network layouts of three sample networks

5.2. Results on toy networks
We first demonstrate the results of the Trans-SEIR model on the toy networks, and we focus on the
validity of the disease threshold, the dynamics of the disease trajectories and the impacts of the travel
related contagions. Figure 3a shows the disease of dynamics of two different scenarios in network A, where
case 1 serves as the base scenario and case 2 doubles the transmission rates of those in case 1. Both cases have
a total population of 10 million and start with an initial infectious population of 1,000 which are uniformly
distributed among the residents of all five zones. Since case 1 has the R0 value of 0.84, we observe that
the number of infectious people decays exponentially fast and the system quickly moves towards the DFE
state. On the contrary, case 2 has the R0 value of 1.68 and exponential growth in the number of exposed
and infectious populations can be immediately observed. The disease in case 2 eventually invades around
66.7% of the total population before it dies out. While the complete trajectory was not shown here, we
report that there is a strictly positive proportion of the population that remains infectious which agrees with
the endemic equilibrium with R0 > 1. For these two cases, we also compare the results with the outcomes
when travel contagion is not considered (e.g., β T = 0). We can see that the two systems differ significantly
and the results suggest that we may underestimate the risks of an urban disease outbreak if travel contagion
is ignored, or equivalently we may overestimate the transmissibility of an infectious disease if conventional
disease models are fitted to the historical data in urban areas. And the results therefore highlight the
importance of considering travel contagion in transit systems for the most accurate understanding of urban
disease dynamics and devising proper intervention and control strategies. Moreover, we find that, given the

21

same population distribution and mobility patterns, the network structure of urban transit systems may
have great impacts on the disease trajectories as shown in Figure 3b. The network layouts of the three cities
reflect different planning philosophies regarding the trade-off between accessibility and system efficiency.
Network B represents the highest accessibility between trip ODs but also the highest operation costs with
numerous direct transit routes. On the other hand, network C achieves the maximum transit usage with the
minimum number of transit lines, but also leads to the highest number of passengers sharing overlapping trip
hence the greatest risk of travel contagion. Based on the results of the toy network, we see that the number
of secondary infections in network C may be 7.4% higher than that of network B and 3% higher than that of
network A. As all these networks will reach the endemic equilibrium, the excessive contacts during travel in
network C may increase the total infected population of network B by over 7.26% and result in the arrival
of the peak nearly 30 days earlier. And the early peak is primarily driven by the spatial synchronizations
of the disease dynamics which is facilitated by the travel contagion, as shown in Figure 3c. In particular,
we measure the rate of synchronization as the standard deviation of the change rates of the total infectious
population of each zone. Higher std stands for the larger discrepancy among the zonal change rates and
hence the disease dynamics are less synchronized. As the spread of disease usually starts with the first few
external visitors in local areas, the rate of spatial synchronization therefore determines the pace and the scale
of the citywide outbreak. The results in Figure 3c suggest that the disease dynamics across different zones
are synchronized at an exponential rate, and the exponential decay rate for network C is 20% higher than
that without travel contagion or 10.2% higher than that for network B, highlighting the catalyst effect of
the urban transit system and travel contagion in promoting a faster pace for spatial synchronization. While
urban transit systems have long been designed as an affordable mobility solution for the mass population,
these results clearly assert an emerging need to rethink the planning and operation of the urban transit
systems to balance the goal of efficiency maximization and the risk of infectious disease during extreme
pandemics.
The previous discussion demonstrates the significant role played by the urban transportation system in
boosting the spread of infectious diseases. Nevertheless, we further report that direct transmission during
travel in the public transit systems may not constitute a major source of infections during an urban disease
outbreak. To see this, we summary the cumulative dynamics of the total number of infectious (as the
percentage of the total population), direct travel contagion and activity contagion, and the results can be
found in Figure 4. It is observed that, depending on the particular network layout, direct travel contagion
may account for a small proportion (10.0% - 17.6%) of total infected cases and the majority of the infections
arise from non-travel related activity engagement such as work and entertainment. The reason is that the
number of travelers in the transit system and the exposure duration are both lower than those during regular
activities. While direct travel contagion is the most straightforward measure to quantify the impacts of the
urban transportation system, the metric is not comprehensive as it does not capture the secondary cases
produced by travel infections. To this end, we introduce the notion of induced travel contagion to measure

22

Case 1: R0 =0.84, R NT
=0.73
0

106

Total infected cases

105

Total infected cases

Case 2: R0 =1.68, R NT
=1.46
0

108

100

S
E
I
R

104
102

S NT
E NT
INT

100

R NT

10-2
10-5

0

100

200

300

10-4

400

0

100

200

Date

300

400

Date

(a) Disease dynamics of two scenarios in Network A

10-1

106

Network A
Network B
Network C
No travel contagion

105

std among different zones

Total infected cases

10-2

E A (R 0 =1.68)
E B (R 0 =1.61)
E C (R 0 =1.73)

104

10-3

10-4

10-5

10-6

10

3

0

50

100

150

10-7

200

50

Day

100

150

200

Day

(b) Comparison of E and I curves for different cities using disease
parameters in case 2

(c) Synchronization among different zones

Figure 3: Disease dynamics in two scenarios

Network A

Network B

80

40

20

60

40

20

0
100

200

Days

300

60

40

Travel contagion
Activity contagion
Infected population

20

0
0

Network C

80

Population (%)

60

Population (%)

Population (%)

80

0
0

100

200

Days

300

0

100

200

300

Days

Figure 4: Cumulative dynamics of infected population, activity contagion and travel contagion in the three toy networks.

the amount of infected population who are transmitted at activity locations by contacting people who are
infected during travel. The induced travel contagion is calculated as the difference between the amount
of activity contagion with and without travel infections, and the results are shown in Figure 5. We note
23

that the induced travel contagion in these three networks may account for an additional 4.27% to 5.55% of
new infections. This implies that travel-related contagion may contribute to 16.9% to 25.6% of the total
infections. Moreover, all the results are carried out based on the assumption that the transmission rate in
the transit system is half of that at activity locations. We further illustrate how travel-related contagion
may change by altering the travel transmission rate, and the results are shown in Figure 6. Specifically, we
vary the travel transmission rate from 50% to 250% of the base travel transmission rate, and we observe that
direct travel contagion increases linearly with respect to higher travel transmission rate, while the induced
travel rate is found to be a concave function of the travel transmission rate. We further note that the linear
relationship is only a local property within the evaluated range of travel transmission rate, which will turn
into a concave function as we further increase the transmission rate. And the results suggest that, if we
consider that the strengths of travel transmission and activity transmission being the same, the total travelrelated infections may eventually account for over 35% of the total infected cases during an urban disease
outbreak.
70

Percentage of total population

60

56.96

57.28

55.99
51.73

51.73

51.73

50

40

30

20
12.27
10

9.72
5.24

6.22

4.27

5.55

0
Network A
Activity contagion
Activity contagion w/o travel

Network B

Network C

Travel contagion
Travel induced activity contagion

Figure 5: Number of induced travel contagions in different cities.

5.3. NYC experiments
We use a combination of the United States 2010 census survey, 2010 NYC peripheral transportation
study [19], NYC Neighborhood Tabulation Areas shapefile and the reported confirmed COVID-19 cases in
NYC [20] to prepare the data for our case study. To better account for the mobility dynamics, we set each
step of the simulation as a 2-hour period and the modeling parameters are tailored to the time interval
accordingly. There are two sets of parameters to be calibrated. For the mobility dynamics, we use the 2010
census survey along with the 2010 peripheral transportation study, projected into 2020 population values, to
obtain the population and the travel rate between nodes in the network. The mobility model at equilibrium
estimates around 2.7 million daily commuters within NYC, and this number agrees with the value of the

24

Network A

75

Population (%)

Population (%)

75

60
30

15

0
0.5

Network B

90

Network C

Direct Travel Contagion
Induced Travel Contagion
Total Travel Contagion
Total infected population

60
30

15

0.9

1.3

1.7

2.1

Level of travel contagion

0
0.5

Direct Travel Contagion
Induced Travel Contagion
Total Travel Contagion
Total infected population

75

Population (%)

90

60
30

15

0.9

1.3

1.7

2.1

Level of travel contagion

0
0.5

0.9

1.3

1.7

2.1

Level of travel contagion

Figure 6: Sensitivity of travel contagion with respect to the change in transmission rate during travel (β T )

peripheral transportation study [19]. For disease parameters, we set σ=0.016 (average duration of incubation
period being 5.1 days [21]) and γ = 0.013 (average duration of recovery or death of 6.5 days) based on the
calibrated parameters from the reported data in Hubei province, China [22].
As the focus of our study is to understand the impacts of travel contagion rather than predicting the
trajectories of the disease dynamics, we calibrate the disease transmission rate and the average number of
contacts through a simple line search. And the parameters are finalized when the model is observed to align
with the trend of the reported confirmed cases in general. The outputs from the calibrated model and its
comparison with the reported confirmed cases in NYC can be seen in Figures 8 and 9. In general, we find
that the Trans-SEIR model may well capture the COVID-19 dynamics based on the calibrated parameters
from the NYC census and travel data for daily commuting patterns. We observe that the dynamics of
cumulative confirmed cases match well with the period between March 20 to April 5 when a large number
of tests were performed so that the reported values were closer to the actual disease dynamics. Moreover,
the model results are also consistent with the reported cases in each borough. This suggests the potential of
the Trans-SEIR model for prediction tasks if more rigorous parameter calibration may be conducted. The
disease dynamics is highly spatially heterogeneous. Following equation 38, the model gives the R0 value of
3.295 and the similar values were also reported in the literature [23]. But this value only represents the
average level of secondary infections over the entire NYC, and the values are significantly higher in certain
boroughs. Specifically, we see that the transmission rates in Bronx, Brooklyn and Queens are over 30%
higher than that of Manhattan, despite Manhattan being the most densely populated borough. There are
several possible reasons that may result in this observation. For instance, one possible explanation is the
under-reporting or lack of testing in Manhattan. However, there may be other factors such as the differences
in income level, level of education, age group, and the adoption of early preventative measures among the
boroughs that lead to this high discrepancy. These other factors may worth further investigation.

25

Node
M1
M2
M3
S
BK1
BK2
BK3
BK4
BK5
Q1
Q2
Q3
Q4
BX1
BX2

Zone ID
36102
36103
36101
36130
36122
36121
36123
36125
36124
36111
36114
36112
36113
36092
36091

Bx2
Bx1

M3

M2

Q3

Q1

M1
Bk2

Q2
Q4

Bk1

Bk3
Bk5

Bk4

S

Figure 7: Network layout for the NYC case study

7

104

NYC

Cumulative infections

6
5
4
3
2

Trans-SEIR
Reported data
City emergency on 3/13

1
0
2/15

3/1

3/15

3/26

4/1

Date

Figure 8: Fitted data for the Covid-19 case

1
0.5
0

10000

5000

0
2/15

3/1

3/15 3/264/1

Date

2.5

104 Brooklyn

2.5

2
1.5
1
0.5
0

2/15

3/1

3/15 3/264/1

Date

104

Queens

5000

Total infected cases

1.5

The Bronx

15000

Total infected cases

2

Total infected cases

104 Manhattan

Total infected cases

Total infected cases

2.5

2
1.5
1
0.5

3000

3/1

3/15 3/264/1

Date

Cumulative infected cases
Reported data

2000
1000

0
2/15

Staten Island

4000

0
2/15

3/1

3/15 3/264/1

Date

2/15

3/1

3/15 3/264/1

Date

Figure 9: Fitted data for the Covid-19 case

Since the Trans-SEIR model considers the spatial movement of urban travelers, the results also allow for
revealing the travel segments and activity locations that are associated with the greatest number of infections
and we visualize the results in Figure 10. The strong spatial heterogeneity in terms of both activity and
travel contagion can be readily observed in Figure 10a, where total contagion during travel may account for
28.8% of the total cases in NYC as of March 26 but the values differ based on the residential locations of the
commuters. In particular, Staten Island is the place with the minimum travel contagion as most of the trips
are within the same area and travelers are least dependent on public transit. On the contrary, the north
Manhattan area has the highest ratio of travel contagion with its heavy usage of buses and metros. For
commuters of the same residential location, the split ratios of travel contagion and activity contagion also
vary significant based on their activity locations. Figure 10b presents the relative proportion of travelers

26

(represented as the thickness of the flow curves) who are residents of zones in the top and get infected in
the transit system while traveling to and from the bottom zones. It can be observed that east Manhattan
is the activity location that is associated with the highest number of the infected population during travel.
Moreover, east Manhattan is also the primary destination that contributes to the highest number of travel
contagions for residents of each zone except for Staten Island where most of the commuting trips take place
within the same area. The major reasons behind this observation are threefold: east Manhattan is the major
trip attractor for other areas in NYC, transit such as bus and metro are the major modes for commuting to
the area, and long commuting trips are expected for people living outside the Manhattan area. These lead to
both high population density and prolonged contact duration for the transit routes linking to east Manhattan
which significantly exacerbates the contagion risk level. Besides, we find that west & lower Manhattan and
Ft. Greene/Bay of Brooklyn are the other two major destination locations for infections during travel. The
source of travel contagions who arrive at west & lower Manhattan are again the commuters from outside
Manhattan. But the corresponding source of travelers who arrive at Ft. Greene/Bay of Brooklyn are
primarily the residents within the Brooklyn area, and similar patterns are observed for the other activity
locations. The distribution of activity contagion largely resembles that of travel contagion as shown in
Figure 10c. The major difference is that activity locations are mostly observed within the same location for
areas such as Ft.Greene of Brooklyn, northwest Queens and the Bronx. The reason is that majority of the
residents in these locations also have activity locations in the same areas, and trips within these areas are
mostly made by private vehicles so that travel contagion is not the major threat. Based on these findings, we
arrive at a better understanding of the spatial trajectories of the disease dynamics where the east and west
& lower Manhattan areas are likely the intermediate stops before the disease reaches every corner of NYC.
This also hints at the potential locations where entrance screening may be placed to mitigate the spread of
the diseases, which require further validation based on the results of the optimal control problem.
We summarize the results of optimal entrance control in Figures 11 and 12. We report that entrance
control for urban transit system can be a highly effective countermeasure against the outbreak of infectious
diseases in urban areas, for both preventative and reactive purposes. If limited resources are distributed
in an optimal manner, we are able to curb the disease and drive it to the disease-free equilibrium state,
and will contribute to a significant reduction in the number of total infections. To validate the proposed
solution approach, we compare the effectiveness among optimal control as devised in our study and two other
benchmark methods: the uniform control where equal resources are distributed among all travel segments
and the high-demand control where travel segments with higher demand are prioritized for resources. The
measure of effectiveness is the R0 value after control as shown in Figure 11, where the x-axis denotes the
number of resources spent (manpower used for screening travelers). We observe that, by only focusing on
medium and high capacity modes and if we can distribute the resources optimally, we are able to lower the
R0 to 1.2 by screening approximately 10,000 daily travelers per time step, or less than 4.5% of total daily
commuters. While the screening of 10,000 travelers can be expensive in practice and may lead to excessive

27

Cumulative number of latent population as of 3/26

2500
Travel contagion
Activity contagion

2000

1500

1000

500

0
BX2

BX1

M3

M1

M2

Q1

Q3

Q4

Q2

BK2

BK1

BK3

BK5

BK4

S

(a) Number of travel contagion and activity contagion in each area

(b) Alluvial flow diagram for the amount of travel contagion between pairs of zones.

(c) Alluvial flow diagram for the amount of activity contagion between pairs of zones.
Figure 10: The distributions of travel contagion and activity contagion during the COVID-19 outbreak in NYC, measured by
the amount of people in latent class (E) as of March 26.

28

3.5

3
R 0 optimal

2.5

R0

R 0 high demand
R 0 uniform

2

1.5

1
0

2000

4000

6000

8000

10000

Budget level

Figure 11: Effectiveness of transportation control with different budget level

Budget manpower 1000
S
BK4
BK5
BK3
BK1
BK2
Q2
Q4
Q3
Q1
M2
M1
M3
BX1
BX2

Budget manpower 5000

1

S
BK4
BK5
BK3
BK1
BK2
Q2
Q4
Q3
Q1
M2
M1
M3
BX1
BX2

0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0

BX2 BX1 M3 M1 M2 Q1 Q3 Q4 Q2 BK2 BK1 BK3 BK5 BK4 S

Budget manpower 20000
S
BK4
BK5
BK3
BK1
BK2
Q2
Q4
Q3
Q1
M2
M1
M3
BX1
BX2

1
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0

BX2 BX1 M3 M1 M2 Q1 Q3 Q4 Q2 BK2 BK1 BK3 BK5 BK4 S

Budget manpower 50000

1

S
BK4
BK5
BK3
BK1
BK2
Q2
Q4
Q3
Q1
M2
M1
M3
BX1
BX2

0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0

BX2 BX1 M3 M1 M2 Q1 Q3 Q4 Q2 BK2 BK1 BK3 BK5 BK4 S

1
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0

BX2 BX1 M3 M1 M2 Q1 Q3 Q4 Q2 BK2 BK1 BK3 BK5 BK4 S

Figure 12: Distribution of control resources under different budget level

externalities such as heavy delay, we also find that an exponential rate of reduction in R0 can be achieved
with optimal control strategy for a small number of initial efforts. If we may perform the screening of 2000
travelers with a success rate of 70%, we will be able to lower the R0 in NYC to 2.32 which represents a
29.6% reduction in the number of secondary infections and implies significant potential saving of lives and
medical resources. Note that this level of control effectiveness is achieved through the compartment model
and control strategy being implemented at the aggregate level, an encouraging finding is that the outcomes
of the optimal control approach are comparable to that of the target control strategy at the individual level
with perfect information on the contact network structure and the state of each travelers [24]. Meanwhile,
the other two benchmark approaches are found to be barely effective. Despite direct and induced travel
contagions, we need to pay attention to the case that infectious people will need to travel using the urban
transit system to further spread the disease. If the resources and screening manpower can be optimally

29

allocated, we can effectively identify these infectious travelers, put them into quarantine and stop them from
producing new infections. To this end, we also visualize the optimal distribution of resources across the
travel segments as shown in Figure 12. The major findings echo to the general observations in Figure 8,
where east Manhattan is the target area to place the majority of the resources and should be exclusively
controlled with very limited resources (budget¡5000). Moreover, for commuters with east Manhattan as the
activity location, the optimal solution suggests targeting those from Staten Island, Queens and the Bronx
with top priority. This can help to prevent infectious travelers from resulting in secondary cases within their
areas where massive activity contagions are observed. With more resources available, the optimal solution
recommends focusing on residents of the above-mentioned areas who have their activity locations in west &
and lower Manhattan and part of the Brooklyn area, before placing stricter screening for residents within
the Manhattan area due to the relatively low activity contagion rates. In conclusion, the results of the
optimal control method suggest a highly promising direction for the control of urban transportation systems
in densely populated areas. And the Trans-SEIR model with the travel control approach may have significant
implications towards the operation of public transit systems after the reopening of businesses to mitigate
further risks of the COVID-19 outbreak.
6. Conclusion
In this study, a realistic Trans-SEIR model is presented for understanding the spread of infectious disease
in urban areas considering the spatial-varying mobility dynamics and the presence of both travel contagions
and activity contagions. The Trans-SEIR model starts with the dynamic system to capture the population
movement among different zones and derive the equilibrium flow pattern for the urban areas. Based on
the stable commuting pattern, the spread of infectious disease in urban areas is formulated as a spatial
SEIR system with travel contagion, and an entrance control framework for urban transportation is further
proposed for the optimal allocation of limited resources for reducing the risks from the infectious diseases.
The presented modeling approach along with the optimal control framework will allow for advances in
understanding the disease dynamics in urban areas and contribute to the framing controlling strategies and
policies for mitigating the risk of infectious diseases from the urban transportation perspective.
References
[1] Department of Economic and Social Affairs, United Nations, 68% of the world population projected to
live in urban areas by 2050, says un (2018). [Accessed Feb, 2020].
[2] Richard Florida, CITYLAB., The global mass transit revolution (2018). [Accessed Feb, 2020].
[3] M. Chambers, J. Goworowska, S. Smith, Passenger travel facts and figures 2015 (2015).
[4] E. Dong, H. Du, L. Gardner, An interactive web-based dashboard to track covid-19 in real time, The
Lancet infectious diseases (2020).
30

[5] W. O. Kermack, A. G. McKendrick, A contribution to the mathematical theory of epidemics, in:
Proceedings of the Royal Society of London A: mathematical, physical and engineering sciences, volume
115, The Royal Society, pp. 700–721.
[6] M. Y. Li, J. S. Muldowney, Global stability for the seir model in epidemiology, Mathematical biosciences
125 (1995) 155–164.
[7] H. L. Smith, L. Wang, M. Y. Li, Global dynamics of an seir epidemic model with vertical transmission,
SIAM Journal on Applied Mathematics 62 (2001) 58–69.
[8] C. Castillo-Chavez, H. W. Hethcote, V. Andreasen, S. A. Levin, W. M. Liu, Epidemiological models
with age structure, proportionate mixing, and cross-immunity, Journal of mathematical biology 27
(1989) 233–258.
[9] B. Shulgin, L. Stone, Z. Agur, Pulse vaccination strategy in the sir epidemic model, Bulletin of
mathematical biology 60 (1998) 1123–1148.
[10] A. d’Onofrio, On pulse vaccination strategy in the sir epidemic model with vertical transmission, Applied
Mathematics Letters 18 (2005) 729–732.
[11] H. W. Hethcote, H. W. Stech, P. van den Driessche, Periodicity and stability in epidemic models:
a survey, Differential Equations and Applications in Ecology, Epidemics and Population Problems,
Academic Press, New York (1981) 65–82.
[12] W.-m. Liu, H. W. Hethcote, S. A. Levin, Dynamical behavior of epidemiological models with nonlinear
incidence rates, Journal of mathematical biology 25 (1987) 359–380.
[13] M. E. Newman, Spread of epidemic disease on networks, Physical review E 66 (2002) 016128.
[14] L. Meyers, Contact network epidemiology: Bond percolation applied to infectious disease prediction
and control, Bulletin of the American Mathematical Society 44 (2007) 63–86.
[15] L. Danon, A. P. Ford, T. House, C. P. Jewell, M. J. Keeling, G. O. Roberts, J. V. Ross, M. C. Vernon,
Networks and the epidemiology of infectious disease, Interdisciplinary perspectives on infectious diseases
2011 (2011).
[16] A. L. Lloyd, R. M. May, Spatial heterogeneity in epidemic models, Journal of theoretical biology 179
(1996) 1–11.
[17] L. Sattenspiel, K. Dietz, A structured epidemic model incorporating geographic mobility among regions,
Mathematical biosciences 128 (1995) 71–91.
[18] P. Van den Driessche, J. Watmough, Reproduction numbers and sub-threshold endemic equilibria for
compartmental models of disease transmission, Mathematical biosciences 180 (2002) 29–48.
31

[19] NYC Department of City Planning - Transportation Division, Peripheral travel study. (2010). [Accessed
March, 2020].
[20] NYC Health Department, COVID-19: Data (2020). [Accessed April, 2020].
[21] S. A. Lauer, K. H. Grantz, Q. Bi, F. K. Jones, Q. Zheng, H. R. Meredith, A. S. Azman, N. G. Reich,
J. Lessler, The incubation period of coronavirus disease 2019 (covid-19) from publicly reported confirmed
cases: estimation and application, Annals of internal medicine (2020).
[22] Z. Yang, Z. Zeng, K. Wang, S.-S. Wong, W. Liang, M. Zanin, P. Liu, X. Cao, Z. Gao, Z. Mai, et al., Modified seir and ai prediction of the epidemics trend of covid-19 in china under public health interventions,
Journal of Thoracic Disease 12 (2020) 165.
[23] Y. Liu, A. A. Gayle, A. Wilder-Smith, J. Rocklöv, The reproductive number of covid-19 is higher
compared to sars coronavirus, Journal of travel medicine (2020).
[24] X. Qian, L. Sun, S. V. Ukkusuri, Scaling of contact networks for epidemic spreading in urban transit
systems, arXiv preprint arXiv:2002.03564 (2020).

32

