C OV-ABM: A STOCHASTIC DISCRETE - EVENT AGENT- BASED
FRAMEWORK TO SIMULATE SPATIOTEMPORAL DYNAMICS OF

arXiv:2007.13231v1 [physics.soc-ph] 26 Jul 2020

COVID-19

Masoud Jalayer 1 ∗
masoud.jalayer@polimi.it

Carlotta Orsenigo 1
carlotta.orsenigo@polimi.it

Carlo Vercellis 1
carlo.vercellis@polimi.it
1

Department of Management, Economics and Industrial Engineering
Politecnico di Milano, via Lambruschini 4B, 20156, Milan, MI, Italy

A BSTRACT
The paper develops a stochastic Agent-Based Model (ABM) mimicking the spread of infectious
diseases in geographical domains. The model is designed to simulate the spatiotemporal spread of
SARS-CoV2 disease, known as COVID-19. Our SARS-CoV2-based ABM framework (CoV-ABM)
simulates the spread at any geographical scale, ranging from a village to a country and considers
unique characteristics of SARS-CoV2 viruses such as its persistence in the environment. Therefore,
unlike other simulators, CoV-ABM computes the density of active viruses inside each location space
to get the virus transmission probability for each agent. It also uses the local census and health
data to create health and risk factor profiles for each individual. The proposed model relies on a
flexible timestamp scale to optimize the computational speed and the level of detail. In our framework
each agent represents a person interacting with the surrounding space and other adjacent agents
inside the same space. Moreover, families’ stochastic daily tasks are formulated to get tracked by
the corresponding family members. The model also formulates the possibility of meetings for each
subset of friendships and relatives. The main aim of the proposed framework is threefold: to illustrate
the dynamics of SARS-CoV diseases, to identify places which have a higher probability to become
infection hubs and to provide a decision-support system to design efficient interventions in order to
fight against pandemics. The framework employs SEIHRD dynamics of viral diseases with different
intervention scenarios. The paper simulates the spread of COVID-19 in the State of Delaware, United
States, with near one million stochastic agents. The results achieved over a period of 15 weeks with a
timestamp of 1 hour show which places become the hubs of infection. The paper also illustrates how
hospitals get overwhelmed as the outbreak reaches its pick.
Keywords Agent-based Model · SARS Coronavirus · SEIR Epidemic Model · Stochastic Epidemic Model · GIS
Application · Discrete-Event Simulation Model

1

Introduction

The COVID-19 pandemic is growing every day across the planet and, apart from its impact on the global economy,
it is causing a dramatic loss of lives. Since its first report on December 31st, 2019 in Wuhan, China, it has speedily
reached 213 countries. As of today, over 7 million people have been diagnosed positive with over 400.000 casualties
[42]. Policymakers and scholars all over the globe are under pressure to make effective decisions with the purpose
of controlling and mitigating the outbreak in the short run, and of designing valid actions to contrast future possible
∗

Corresponding author

M. Jalayer et al.

C OV-ABM

upsurges.
Some non-pharmaceutical interventions have being carried out by governments and people aiming at “flattening the
curve”, e.g. home quarantine, intensive hand hygiene, closure of schools and shops, prohibition of mass events [26].
However, these counter-measures caused controversies in many countries; as an example, several protests arose in the
US against the closure of businesses and stay-at-home impositions [15]. One of the aims of the present work is to
illustrate how these provisions can effectively flatten the curve of infected people and save lives.
Since 1920s many stochastic epidemic models have been proposed using differential equations of SIR (SusceptibleInfectious-Recovered) and SEIR (Susceptible-Exposed-Infectious-Recovered) to study the dynamics of diseases on
populations [28]. Due to their generalized nature, however, differential equations cannot explain the effect on the
outbreaks of different scenarios, geographical features or population age distribution [19]. Hence, during the past
two decades computer simulations and agent-based models were proposed to address the structure and dynamics of
transmission networks [32]. Some studies considered static graphs as the main platforms of the disease diffusion [37],
and employed graph features and algorithms to identify the influential nodes [22]. Other studies resorted, instead, to
spatial models for investigating such phenomena. As an example, Balcan et al. [4] developed a discrete stochastic
epidemic model based on gridded population at the worldwide scale, whereas Cliff et al. [9] built a spatiotemporal
simulator to analyse the spread of influenza in Australia using census data.
Some works addressing the new outbreak, SARS-CoV2, have been recently proposed. Kai et al. [24] developed
two SEIR models to predict the effect on the spread of the virus of wearing face masks in the society. The first
model uses stochastic dynamic networks to simulate the transmission among the individuals, represented by the
nodes of the network. The second model, instead, employs an agent-based framework which indicates that “the early
universal masking” policy can effectively mitigate the pandemic. Cuevas [11] proposed an agent-based simulator to
mimic the spatiotemporal transmission process of COVID-19. In this work, each agent has a health profile and social
characteristics, and makes decisions about its movements and interactions with other agents inside a square, which
represents a generic geographical area. The results of this study show that simulations provide useful information to
base the decisions aimed at mitigating the transmission risks of COVID-19 within the facilities. In [21] Ivorra et al.
developed a mathematical model to study the importance of undetected infections. They proposed a modified SEIR
model, called θ-SEIHRD, where θ implies the fraction of detected cases over the actual total number of infectious
cases, and H denotes the state of the people who are hospitalized or self-quarantined. The authors compared their
differential equation results with the adjusted number of COVID-19 cases in China, and analysed some different
scenarios consequently. In another study [14], the authors developed an agent-based model to simulate the spread of
COVID-19 based on the movements of the agents in closed built environments, such as buildings, and studied some
different social-distancing scenarios. The model there proposed is calibrated on experimental data collected from the
Diamond Princess cruise, and relies on two factors to determining if the virus transmits: the distance between the virus
carrier and the susceptible agents, and the duration of the exposure.
In this paper, we propose an agent-based model which simulates agents capable of working, resting, taking part in
social events, meeting friends and visiting relatives stochastically. The model uses census data referred to the working
context and to the health risk factors in a given geographical area, to create a realistic society. Moreover, it simulates
the placement of facilities and buildings in that area by using Geographic Information System (GIS) tools to retrieve
real-world geographical data, and associates them to agents who live, work or simply visit that locations. In our work
distinctive traits of SARS-CoV2 are also considered; in particular, our model assumes that the virus persists inside the
buildings or in outdoor areas for rather long time periods, and stochastically infects the agents in these places.
The main aim of the proposed framework is threefold. First, to enable a detailed description of the dynamics of
the SARS-CoV2 spread. Second, to identify the high-risk places that accelerate the outbreak. Third, to provide a
decision-support system to design efficient interventions, in order to fight against the current pandemic or similar
worldwide epidemics that may occur in the future.
The rest of the paper is organized as follows. Section 2 describes the proposed framework, the characteristics of the
agents, their set of actions, and the rules to generate the communities in which they are organized. The infection
dynamics and the virus transmission mechanisms are explained in detail in the same section. The simulation assumptions,
the investigated scenarios, the data collection process, the model’s calibration and the results achieved for a given
geography, represented by the State of Delaware, are illustrated in Section 3. The research findings are discussed in
Section 4, while Section 5 provides some conclusions and opportunities for future studies.

2

CoV-ABM: the simulation model

The paper proposes a novel Agent-Based Model, called CoV-ABM, as a simulator of the SARS-CoV2 infectious disease
spread. An overview of the proposed framework is depicted in Figure 1. Once the corresponding census and health data
are collected, the simulator first resorts to the Open Street Map Networkx (OSMnx) library [6] for retrieving the GIS
data of the geographical areas under investigation. Then, it proceeds with the generation of the buildings, the street
2

M. Jalayer et al.

C OV-ABM

Figure 1: The proposed CoV-ABM framework
maps, and the agents. Based on the health and census data, each agent is associated to a health profile, the households
are created and placed in vacant houses. Different workplaces are generated based on the buildings’ information and
census data. Agents are then assigned to professional tasks or scholar activities inside these workplaces, based on their
profiles and geographical locations. Afterwards, CoV-ABM proceeds with making social communities as described in
Section 2.2. Each of the aforementioned steps is described in detail in the following subsections.

2.1

Generating the agents

Based on census data, CoV-ABM stochastically generates agents representing citizens living, working, pursuing their
needs and travelling inside a geographical environment. To rely on a detailed and realistic simulator, each agent is
described in terms of a set of variables, defining its condition at each timestamp. These variables are briefly depicted
in Table 1. It should be emphasized that, to the best of our knowledge, this is the first time that such a detailed agent
profile is proposed in the literature.
When the agents are created, the model associates one with each other to generate families based on the household
size, and set their arrangement so to be proportionate to the census data. As an example, if a family includes a kid
there must be at least an adult in the same household. In what follows, each agent will be indicated as au,v , whereas
fi = {av,u |v = i} will represent the ith family. To reduce unnecessary complexity, the agents do not have a gender.
Moreover, their disability values, defined in Table 1, are stochastically chosen based on a Bernoulli distribution as
follows:
av,u (d) ∼ Ber(pgd )
pgd

(1)

where is the percentage of people with severe disabilities within the age-group g, based on the census data. These
people seldom do outdoor daily activities, like going for grocery shopping, and mostly rely on someone else for
3

M. Jalayer et al.

C OV-ABM

Table 1: Variables defining each agent
Variable

Notation

Type

Description

Name
Family

u
v

string
string

Home

m

string

Age
Health vulnerability

ζ
h

integer
float

Risk factor

ϕ

array

Disability
SEIHRD
Job

d
s
j

binary
string
string

Workplace

w

string

Working table
Location

W d,h
%

array
string

Free

φ

binary

A 4-digit string as the agent’s first name
An 8-digit string as the agent’s family ID
A GIS location + 3-digit string indictating the
building unit
where the agent dwells
An integer between 1 land 100
A real number between 0 and 0.9999
A vector of binary values with respect to different risk factors 1: if the agent has the risk
factor, 0: otherwise
1: severe disability, 0: without disability
The epidemiological state of the agent
The agent’s job name
A GIS location + 3-digit string to indicate the
building unit
where the agent works
A matrix W = (wd,h ) ∈ N7×24
The location where the agent is at time t
1: if the agent is free to perform non-emergency
tasks at time, 0: otherwise

assistance.
CoV-ABM defines the “health vulnerability” variable for each agent, which determines how vulnerable or strong an
agent can persist against the SARS-CoV2. A strong agent has a higher probability to get recovered after inhaling the
virus. Despite some health factors seem to play a key role in the pathogenesis of COVID-19 infection, their relative
importance is however still unclear [23]. So far, age showed a significant correlation with the fatality rate among
infectious people. As of today, more than 70% of death cases involved individuals older than 65, while the share of
fatalities for people under 18 is just 0.04%. At the same time, recent research findings showed that Body Mass Index
(BMI) impacts on the condition of the patients with SARS-CoV2, since obesity compromises pulmonary function and
makes the ventilation more difficult. As a consequence, SARS mortality rate significantly increases among patients with
BMI values over than 27 [13, 27]. Moreover, Ashokka et al. [2] demonstrated that, although the risk of severe illness for
pregnant patients in the COVID-19 pandemic is less than that of similar cases observed during the H1N1 counterpart,
the virus seems to exert significant adverse effects in case of childbearing. Indeed, the data provided in their study
showed that roughly 9% of the patients had serious morbidities with respiratory failure or other organs shock. There are
also evidences illustrating that the history of smoking is correlated with the deterioration of the patients’ conditions [36].
Finally, recent studies showed that, despite acute respiratory failure is associated with higher mortality, lungs are not the
only organs involved since kidney and cardiovascular system health conditions play prominent roles as well [8, 45].
In light of these remarks, therefore, we supposed that every agent can have each of these risk factors with a Bernoulli
distribution as follows:
av,u (ϕf ) ∼ Ber(pgf )
(2)
where pgf represents the prevalence of having the factor f within the age-group g. Moreover, since correlations might
exist among these different determinants, we introduced an upper and a lower health bound for each agent, from which
the health vulnerability value is stochastically chosen by using a uniform distribution:
bupper (av,u ) = min((1 − qf )a
blower (av,u ) =

Y

v,u

(ϕf )

|f ∈ riskf actors)
v,u

(1 − qf )a

(3)

(ϕf )

(4)

av,u (h) ∼ unif (blower (av,u ), bupper (av,u ))

(5)

f ∈riskf actors

where qf represents the percentage of severe morbidity cases with the risk factor f among SARS-CoV2 patients in
the age-group g. People with health vulnerability values lower than a specific threshold were considered as in need
of hospital care and treatment. Since they barely perform shopping or similar tasks, we considered them like agents
4

M. Jalayer et al.

C OV-ABM

Table 2: Risk factors for the age-group 25-29 in the US
Risk factors

Census-based prevalence pgf
Value References

Severe morbidity probability qf
Value References

Age
Obesity
Pregnancy
Smoking
Chronic respiratory diseases
Acute renal disease
Heart disease
Diabetes

1
0.35
0.08
0.16
0.001
0.001
0.05
0.03

0.02
0.1
0.09
0.15
0.08
0.91
0.13
0.09

[17]
Statista1
[10], CDC2
[43]
[33]
[35]
[34]

[41]
[27, 13]
[2]
[36]
[41]
[7, 8]
[41]
[41]

with a serious disability, i.e. av,u (d) = 1. Notice that, in an unrealistic situation where no correlations exist, so that
risk factors can be deemed independent one from each other, based on the Bayes’ theorem the probability of their
coincidences is the product of the probability of their solely occurrences, which is equal to the lower health bound. At
the other extreme, if all the events’ probability spaces are subsets of each other, the probability of their coincidences is
given by the probability of the rarest event, which in its turn is equal to the upper health bound. Table 2 shows the pgf
and qf values for the group composed of people between 25 and 29 years old for a city in the US, based on census data.
In the CoV-ABM framework two types of agents are generated: those who have a job, in the form of a working or a
school activity, which has been assigned to them with a random job-filler algorithm which considers their profiles, and
those who aren’t associated to any job. This second group includes job-seekers, whose population size has been set
according to the most recent observed unemployment rate, children at preschool (av,u (ζ) < 7) or people older than
xretired , where this last threshold is given by a stochastic number having a normal distribution as follows:
2
xretired ∼ N (µretired , σretired
)

(6)

where and represent, respectively, the average and the standard deviation of the retirement age recorded in the
geographical area under investigation.
Finally, at each timestamp every working agent decides whether to travel to the workplace or not. To rely on a realistic
simulator, agents are not always on-time and they might be up to two timestamps late or one timestamp in advance
when they go to work or come back home.
2.2

Generating communities

In the proposed model, agents belong to different friendship groups or communities of relatives. Friendship groups
are composed on average by four individuals, whose membership is not exclusive. This means that agents av1 ,u1 and
av2 ,u2 can be friends in more than one group and can share different sets of common friends. At every timestamp, each
friendship group stochastically searches among its members with the aim of finding those willing to organize a meetup,
where the probability of this event differs according to the specific day in the week and time in the day. The likelihood
of successfully arranging a meeting, for example, is much higher for a weekend evening compared to any other evening
during the week. If such a meetup is made possible, the available members decide where to go and the place is chosen
randomly either from the members’ homes or from open public places in their city, e.g. parks, cafes, shopping centres or
stadiums. The model assumes that if an agent attends a meetup it is engaged for a given time interval and, therefore, it
is not able to take part to any other meeting for that period. In what follows, W t will denote the set of willing members
at time t, and y, the place where they choose to go from timestamp t + 1 to t + l:
∀(v, u) ∈ W t : av,u (φi |i ∈ {t + 1, . . . , t + l}) = 0

(7)

∀(v, u) ∈ W t : av,u (%i |i ∈ {t + 1, . . . , t + l}) = y
It is worth mentioning that the friendship groups comply with the following rules:

(8)

1. Let av,u denote the first agent included in a group. The other members are selected so that they are approximately at its own age. Specifically, the age of the other agents is taken from the range av,u (ζ) ∓ (2 × σage ),
where σage ∝ av,u (ζ). As a consequence, in our framework adolescents or young people have only other
adolescents or young people as friends. For older individuals friends are chosen similarly but considering a
wider range for the age.
5

M. Jalayer et al.

C OV-ABM

2. Agents younger than a certain age do not join any friendship group. The rationale behind this rule is that
children are supposed to meet their friends only at school or preschool and aren’t able to organize meetups in
public places.
Beside friendship groups, the model includes also communities of relatives involving different families. In this case
the membership is exclusive so that each family belongs to at most one of these groups. At every timestamp, each
community stochastically searches among its families to find those available to organize a meetup. A family is declared
available when at least half of its members are willing to attend the meeting. Once a meeting is set up and its location is
chosen, the available family members will attend it and won’t be free for a certain time.
Notice that, unlike other agent-based models proposed in the literature which resort to random graphs to represent
interactions among the agents, our model relies on a more detailed relationship framework to better reflect the real-world
interpersonal interactions. This feature plays an important role since it allows to study quarantine scenarios and social
distancing impositions with higher realism and precision. For instance, if people are forced to forego the meetups with
their friends due to lockdown or other social restrictions, they are still in contact with their own family members, they
might still visit some of their relatives, like grandparents, or they might want to limit the meeting locations to their own
houses. As far as we know, the models so far proposed lack such representation capabilities.
2.3

Agents’ needs and actions

As the discrete-event model starts, each family is stochastically associated to a variety of needs which have to be
fulfilled. These needs can take the form of emergency needs, which are strictly connected to the family members’ health
conditions, and of daily needs, which are instead referred to every-day activities such as food provisioning, shopping,
refueling and so on. The probability of having daily needs depends on the frequency of each need in the real society
and it is here assumed to be equal for all families. The likelihood for an emergency need to arise is, instead, dependent
on each member’s health conditions, av,u (h) and av,u (s), as follows:
regular
v,u
vemergency
(u)t ∼ Ber(pregular
(h))
emergency a
COV ID
vemergency
(u)t ∼ Ber((pti→h )v,u ); {(v, u)|av,u (s) = inf ected}

(9)
(10)

pregular
emergency

where
is the likelihood of being hospitalized for a “highly strong agent”, defined in this study as an agent
with a health vulnerability value near to 1, as indicated in Table 1. Whereas pti→h represents the likelihood of being
hospitalized due to COVID-19. This second term will be explained in more details in Section 2.4.
Emergency needs involve a given family member and can be satisfied at a specific hospital located in the county where
he/she lives. When an emergency need arises, the affected agent immediately plans to go to the hospital with the aim
of fulfilling that need. In case of disability or precarious state, a good health adult belonging to the same family is
randomly selected to help the member in need.
In our model, the length of staying (LOS) at the hospital for patients affected by COVID-19 is defined as the number of
days elapsed between hospitalization and discharge (in case of both recovery and death), while for the other patients it
is set to a stochastic number. Notice that, the average LOS value may vary from city to city and for different diseases.
However, for the sake of simplicity its value was here set to 4.5 days, which corresponds to the average hospital LOS
recorded in the US [39].
Harini et al. observed that non-transformed distributions cannot fit the LOS data appropriately, and suggested to use the
gamma-pareto distribution for hospitals LOS fitting purposes [18]. In our model, therefore, each non-COVID patient
stays at the hospital for a period of days, which follows a gamma-pareto distribution [1]
L ∼ Gamma − P areto(αLOS , cLOS , θLOS )
(11)
with parameter values αLOS = 7, cLOS = 0.2 and θLOS = 1, as suggested in [18].
Daily needs are by their nature less urgent and can ideally be satisfied by any eligible member of the family. The
eligibility is given to not-disabled members showing health vulnerability values greater than a given threshold. In
particular, as soon as an eligible member manages to find the time and the right place is open, he/she goes there to fulfill
the need. In the event that several places are available, the priority is given to the closer destination. To this aim, we
resorted to a graph-based shortest path algorithm proposed in NetworkX [16]. Furthermore, to govern the complexity,
we assumed that on average each family daily need requires one hour to be satisfied.
The model uses a Bernoulli trial to generate new needs for each family, the probability of which is given by:
n,t
vdaily
∼ Ber(ϑn dt/24); n ∈ N

(12)

where ϑn is the frequency of expressing the daily need n. dt denotes the timestep and N is the set of different daily
needs.
6

M. Jalayer et al.

C OV-ABM

Figure 2: Schematic diagram of the proposed SEIHRD model, where arrows indicate possible transitions with the
corresponding probability notations
When an agent is selected to satisfy a need, either an emergency or a daily one, it won’t be free to accomplish other
tasks until the need is fulfilled. For a family, if a daily need is not yet satisfied and a new similar need is generated,
these two needs are merged into a single one.
2.4

Infection dynamics

In this paper we propose a novel way of disease transmission among the agents. Specifically, we assume that the
individual suffering from the disease can infect other agents indirectly by spreading the virus in the environment. As
of today, it is believed that COVID-19 is often transmitted through respiratory droplets produced by coughing and
sneezing. This virus can however remain suspended in the air for a significant period of time [5] and may also persist
on surfaces like metal, plastic or glass for up to 9 days [25]. Developing a model which accounts for such an important
characteristic is fundamental to properly represent the spread of SARS-CoV2. Hence, unlike other agent-based models
which assume directly contacts as the only mean of transmission, we suppose that the environment itself (the air and/or
a surface) can convey the virus from one agent to the other.
In the CoV-ABM framework each location, either indoor or in the form of an outdoor area, can contain a given amount
of virus. The volume of the virus persisting in the given location divided by the volume of the location itself determines
the probability of infection. The persistence of the virus is not yet exactly known and is estimated to range between two
hours and several days, depending on the environmental conditions [25]. However, we can suppose that in a given venue
COVID-19 gets inactivated in the environment after k hours on average. Thus, after each timestamp a portion of virus
equal to δ = dt/k at each location disappears. Note that the value of k can change by applying different mitigation
measures, such as the use of detergents and UV lamps. According to this model, an agent is be able to transmit the
virus to any other agent residing or visiting the locations it stayed or passed by. To the best of our knowledge, none of
the existent agent-based models in the literature relies on such an assumption.
In this study an extension of the SEIR model, called SEIHRD, is used to shape the epidemiological phases of the
disease. As discussed earlier in Section 1., some SEIR extensions have been proposed in the literature addressing the
spread of COVID-19 [21, 44] and [26]. As it is shown in Figure 2, our SEIHRD model comprises 6 states: Susceptible
(S), Exposed or Asymptomatic Infectious (E), (Symptomatic) Infectious (I), Hospitalized (H), Recovered (R) and Dead
(D). For the sake of simplicity, unlike some recent works [30], we do not separate ICU beds and regular beds.
By default, all the agents are susceptible except for the initial spreaders, called seeds:

susceptible; ∀(v, u) ∈
/ seeds
av,u (st=0 ) =
(13)
exposed; ∀(v, u) ∈ seeds
At each timestamp, exposed and infectious agents spread the virus in the locations where they resided or passed by. For
each location y, the infection is calculated as:
X
v,u t
y(∆t ) = y(∆t−1 )(1 − δ) +
a (s ) ; Aty = {(v, u)|av,u (%t ) = y}
(14)
(v,u)∈Aty
v,u

t

where y(∆t ) is the volume of active viruses inside y, and a (s ) represents the average quantity of virus being spread
in the environment, at a given timestamp, by an agent who is in the epidemiological state st . Aty is the set of agents
located in y at time t.
7

M. Jalayer et al.

C OV-ABM

Figure 3: Hospital factor with different parameter values
The probability of being infected for any susceptible agent inside the given area is then determined by a Bernoulli trial
with transmission probability pts→e . Specifically, for agent av,u at time t this probability can be computed as:
pts→e = α(av,u (%t )(∆t )/av,u (%t )(Ωt ))

(15)
t

where α is the infectiousness rate of the disease, which is a real number between 0 and 1, and y(Ω ) denotes the volume
of location y.
If the agent receives the virus, during the “exposed” phase it won’t show any clinical symptom. Therefore, it will work
and live like a susceptible agent while spreading the virus over the places it visits or resides in. After a stochastic period,
whose average is Le (hours), the agent is either “infectious” or “recovered”:
pte→i = β(1 − ρer (av,u (ht )))

(16)

pte→r = βρer (av,u (ht ))
(17)
where β = dt/L, and ρer is the rate of being directly recovered after being asymptomatic infectious for a highly
strong agent. Thus, as av,u (ht ) decreases, the probability of being “infectious” raises. During the “infected” phase the
agent shows symptoms; it still spreads the virus but with a different rate inf ectious . The average time length of being
infectious for a highly strong agent is given by Li (hours). Let γ = dt/Li be the rate of being “recovered” for a highly
strong agent. The probability of becoming “hospitalized”, “recovered” or “dead” at each timestamp is:
pti→r = γ(av,u (ht ))

(18)

pti→h = ρih (av,u (ht ))

(19)

pti→d = ρid (1 − γ(av,u (ht )))
(20)
where ρih and ρid represent the hospitalization and the death rate, respectively, among the strong individuals who are
not hospitalized. For hospitalized patients, instead, the probability of being “recovered” is still the same, since there is
no evidence illustrating that hospitalized people have shorter period of infection: pti→r = pth→r . However, due to the
presence of dedicated facilities such as Intensive Care Units and of special medical equipment, hospitalization reduces
the death rate. Consequently, we propose to compute this probability as:
pth→d = pti→d /Hqt

(21)

where Hqt represents the efficiency of hospital q at time t, called “hospital factor”. If hospital q has a treatment capacity
equal to Cqt , the hospital reaches its maximum efficiency if there are less than Cqt agents being hospitalized. If the
number of hospitalized individuals at q increases, the hospital factor plunges due to the saturation of the structures and
the scarcity of available care beds. Let nt be the number of patients in hospital q at time t; we propose a modified
pareto curve to calculate the efficiency values as follows:
Hqt = 1 + τ0 Cqt /(Cqt + τ1 nt )

(22)

Figure 3 illustrates the hospital factors with different parameter values. These values may change from city to
city and hospital to hospital, so a parameter tuning needs to be accomplished. The pseudocodes of the proposed
SEIHRD diffusion model and the main discrete-event of CoV-ABM are provided in Algorithm 1 and Algorithm 2 (see
appendix A).
8

M. Jalayer et al.

C OV-ABM

Figure 4: Street networks of New Castle County (left), Sussex County (middle) and Kent County (right)

3

Simulation results

In this section we illustrate how the model can simulate the spread of COVID-19 in the State of Delaware, USA, which
has a population around one million people. This state is divided into three counties, New Castle, Sussex, and Kent,
with populations over 558, 234 and 180 thousand, respectively. Delaware is one of the smallest states in the US and
ranked 46th out of the fifty US states in terms of population. However, the virus there has been spreading widely in
the recent weeks. As of today, Delaware is ranked 6th in the US in terms of total COVID-19 positive cases per one
million population, with near 10,000 approved cases [34]. Figure 4 depicts the network of streets of the three counties,
separately.

3.1

Simulation assumptions and different scenarios

In order to govern the complexity of the simulator we assumed the environment to be isolated. Consequently, the model
doesn’t account for incoming or outgoing travels from the region at hand. Notice that, this hypothesis well fits with
our simulation environment since the State of Delaware occupies the north-eastern portion of the Delmarva Peninsula,
besides some islands and territory within the Delaware River, and is therefore less connected to other states compared
to inland states.
Further assumptions were then introduced to cope with the lack of complete information, preserving however the
compatibility and the adherence to detailed census data. From one side, some buildings in the state were randomly
assigned to different uses, being unaware of their actual usage. From the other, the unavailability of census data
reporting an exhaustive list of job titles and workplace types, required to synch the environment generator, forced us to
simplify jobs, workplaces and the corresponding working staffs. Table 3 shows the different working and living spaces
investigated in the present study. The amount of working hours was randomly assigned to each worker, by assuming
that no healthy individual works less than 6 hours or more than 10 hours, daily. Moreover, some workplaces such as
hospitals, public transportations or police stations were supposed to be always up and running.
In our framework, friends and relatives can get together in one of the places comprised in the categories Residential,
Amenity, Event or Cultural, with different probabilities, which take into account the specificity of both location and
meeting attendees. For example, the likelihood for a reunion to take place in a café is higher than in a museum; at the
same time, friends tend to meet in Stadiums, Cafés, Gyms, Parks, while relatives are more inclined to visit each other at
their own houses.
According to the hypothesis made in [9], we further assumed that schools and kindergartens admit people from the
9

M. Jalayer et al.

C OV-ABM

Table 3: Categories of workplaces and living spaces
Categories

Working and living spaces

Education
Emergency
Amenity
Event

University, College, School, Kindergarten
Hospitals, Fire stations, Police stations
Parks, Cafés, Restaurants, Gyms, Casinos
Pubs, Stadiums
Banks, Post Offices, Courts, Supermarkets,
Drugstores, Gas stations, Public transportations, Crucial factories, Power plants
Museums, Churches, Mosques, Zoos
Shops, Industrial plants, Offices
Apartments, Detached houses, Villas

Crucial
Cultural
Private
Residential

closer districts. Hence, the school located closest to a child’s home had a higher probability to be selected. Finally, to
limit the computational effort the model was run on each county separately, and the results were then summed together.
Notice that, the same framework can be run on the whole country with few minor modifications at the expense of an
increase of the simulation time.
With the aim of studying the usefulness of some virus counter-measures and investigate at what extent they can affect
the curves of infected people and cause different spread outcomes, two alternative scenarios were defined as follows:
• No interventions: All places remain open and practicable full-time. The probability of visiting friends is
1/14(day −1 ) and relatives is 1/30(day −1 ).
• Quarantine: All the places in the Education, Amenity, Cultural and Event categories are closed with their staff
staying at home. The probability of visiting friends and relatives drops to 1/30(day −1 ) and 1/60(day −1 ),
respectively. In this case, therefore, people still have contacts with friends and relatives; however, meeting
destinations are no longer represented by public places like parks or cafés, closed by the restrictions, but are
replaced by the individuals’ own houses.
It is worthwhile to observe that the previous scenarios were conceived for the purpose of analyzing the effectiveness on
the mitigation of the outbreak of two specific types of interventions, represented by the drastically reduction of social
meetings and the closure of non-critical places.
3.2

Simulation of agents on census data

In order to generate the simulated environment and the agents’ profiles all the necessary demographic and health
information about Delaware’s counties were gathered from US census and US health reports. In particular, data on
each county’s hospitals and relative capacities were collected from the American Hospital Directory website1 , whereas
the Open Street Map tools2 , e.g. OSMnx, were used to retrieve information about locations, building usage and street
graphs.
Once the agents were generated based on the census and health data, their profiles were analysed to verify the validity
of the achieved population. Table 4 compares the population of the simulated agents, divided into 5 age-groups, with
the real-world census, and shows the close correspondence between the created and the actual population’s demography.
Figure 5, instead, illustrates the number of generated agents affected by the different risk factors in each county.

3.3

Simulating the spread of SARS-CoV2

Simulations were performed by using a mid-range personal laptop with an i7 processor and 8GB of memory on an
Ubuntu 18 operating system. The simulator was coded in Python 3.8 and the model was run on each scenario 5 times
iteratively, to average the results. The runtime of each iteration for the counties Kent, Sussex and New Castle was
roughly 2, 2.5 and 7 hours, respectively.
1
2

https://www.ahd.com/states/hospital_DE.html
https://wiki.openstreetmap.org/wiki/Main_Page

10

M. Jalayer et al.

C OV-ABM

Table 4: Population of agents in different age-groups
Risk factors

New Castle County
Simulated Real-world

Sussex County
Simulated Real-world

Kent County
Simulated Real-world

<5
5 - 17
18 - 44
45 - 64
65 +

5.5%
16.3%
37.1%
25.3%
15.9%

5.2%
14.8%
30.3%
25.1%
24.6%

5.5%
16.3%
36.9%
25.1%
16.2%

5.6%
15.7%
36.1%
26.7%
15.6%

5.2%
14.0%
27.1%
28.4%
25%

6.3%
17%
35.6%
25.3%
15.8%

Figure 5: Risk factors among the simulated agents

3.3.1

Simulator calibration

In order to run the simulator on the State of Delaware, we first set some initial parameters, described in Section 2., as
shown in Table 5.
As it is defined in Section 2.4, the infectiousness rate α determines how easily the virus transmits to a susceptible
individual. The exact value of the infectiousness rate is unknown and depends on several factors, such as the virus
characteristics, the environment (e.g. humidity, temperature, wind speed) and the personal protective behaviour. As
an example, facial masking and careful hand hygiene can reduce the transmission, so that the infectiousness rate in
societies with rigorous protective behaviours is usually lower.
In order to figure out how the infectiousness rate affects the viral spread dynamics and to properly set its value, we
performed several simulations on the Kent county with different values, ranging from 0 to 0.25 with a step size equal to
0.05. Figures 6 to 10 depict the impact of the infectiousness rate on the SEIHRD phases’ surfaces. As it can be seen,
high values result in more infected people and more deaths. Moreover, from the same charts it can be inferred that
quarantine and lower infectiousness rates make the whole spread process slower and longer, eventually leading to fewer
casualties.
Figure 11 depicts the infected places in Kent County, with different infectiousness rate values, at the corresponding
infection peaks. Notice that, due to the virus inactivation period, the highlighted locations only represent the places
where the virus still persists and is not disabled. The blue circles are proportional to the virus densities inside the
corresponding areas.
11

M. Jalayer et al.

C OV-ABM

Table 5: Parameters and their values for simulating on the State of Delaware
Parameter

Description

dt
hr

Timestamp
Average time length of virus persistence
in the environment.

α

Infectiousness rate

Le
Li
ρer

Average time length of being exposed
Average time length of being infectious
Proportion of cases having no symptoms
Hospitalization rate for an infectious case without risk factors
Death rate for an infectious case without risk
factors
Average quantity of virus being spread hourly
in the environment by an asymptomatic agent
Average quantity of virus being spread hourly
in the environment by a symptomatic agent

ρih
ρid
exposed
inf ectious

Estimated
value

References

1 (hour)
20 (hours)

[25]

0 to 0.25
(1/hour)
120 (hours)
110 (hours)
80%

Estimated
[29, 38]
[31]
[40, 3]

10%

Assumed

5%

Assumed

0.5 (1/hour)

Assumed

1 (1/hour)

Assumed

Figure 6: The impact of α on the number of susceptible agents in Kent County with No intervention (left) vs. Quarantine
(right)

Figure 7: The impact of α on the number of exposed agents in Kent County with No intervention (left) vs. Quarantine
(right)

12

M. Jalayer et al.

C OV-ABM

Figure 8: The impact of α on the number of infectious agents in Kent County with No intervention (left) vs. Quarantine
(right)

Figure 9: The impact of α on the number of recovered agents in Kent County with No intervention (left) vs. Quarantine
(right)

Figure 10: The impact of α on the number of dead agents in Kent County with No intervention (left) vs. Quarantine
(right)

13

M. Jalayer et al.

C OV-ABM

Figure 11: Infected places in Kent County after 7 weeks:α = 0.1(left), α = 0.15(middle), α = 0.2(right)

Figure 12: SEIHRD dynamics in the State of Delaware when α = 0.15 - No intervention (left) vs. Quarantine (right)
Once observed the effect of the infectiousness rate at different intensity levels and compared it with the actual curves
derived from the available reports, we consequently set it at α = 0.15 to proceed with the remaining simulations.

3.4

Simulation results for Delaware

As it is shown in Figure 12 and Figure 13, the quarantine measures can drastically flatten the curves. Notice that, our
quarantine scenario doesn’t impose extreme restrictions, since people can still interact with their relatives and friends
and private offices, factories and crucial workplaces are still open with regular opening hours. Therefore, the results
achieved emphasize that even small actions can play a prominent role.
Table 6 shows the number of deaths in different age groups after 15 weeks of simulation and demonstrates how
14

M. Jalayer et al.

C OV-ABM

Figure 13: SEIHRD dynamics in each county when α = 0.15 - No intervention (left) vs. Quarantine (right)
vulnerable old people are and how the interventions can save their lives.
The reports from Delaware, Division of Public Health [12], state that the first positive case has been identified in March
10th, 2020. As of today, after 12 weeks of spread, COVID-19 casualties raised to 149, 126 and 56 cases, for the New
Castle, Sussex and Kent counties, respectively. These reports show that Sussex has a higher percentage of deaths, which
matches our “no intervention” scenario. It is worth mentioning that, the infection process can be highly path-dependent
when the ratio between the number of seeds and the overall population is infinitesimal. In such cases, the number of
deaths can significantly vary in each iteration, and relies on the selection of the seed sets and on their actions during
their infectious period. For example, if there are only few seeds with too few interactions, or they are in good health
conditions to get recovered speedily, the infection won’t sprout up and won’t last for a long period.
Another important issue during the outbreak is the saturation of health facilities. Figure 14 illustrates the number of beds
required for the patients in each of the hospitals in the three counties. During the quarantine scenario this demand is
less urgent since the speed of the virus spread slows down. The plotted lines are the cumulative of both COVID-related
and non-COVID hospitalization needs.

3.5

Identifying the hubs of infection

Our simulator has the power to monitor the spread of the virus and identify hazardous places where the probability of
transmission rises. To show the phenomenon with a closer lens, we separately ran the model on the city of Dover, the
capital of Delaware, with 38,000 agents. Figure 15 and 16 depict the infected places through the time. The plots were
taken at the end of every 2 weeks and illustrate the growth and decline of the outbreak in the city.
In order to identify the places with higher transmission potential, we extracted the areas where each “exposed” agent
received the virus and became exposed. For the “no intervention” scenario, the place types inside which at least 100
incidents occurred are listed in Table 7. Educational places collectively incubated more than half of all the virus
transmissions, with approximately 7500 incidents on average. It must be pointed out that most of these cases involved
young and healthy people; therefore, only a small portion of them became symptomatic infectious. On the contrary,
these exposed young people conveyed the virus to their houses and made their family members exposed as well. This is
one of the reasons why the number of virus transmissions inside the houses was high on average (with almost 3800
cases).
For the “quarantine” scenario, on the other hand, the city witnessed a dramatic decrease in the number of transmissions
inside the houses due to the lock down of the educational and cultural places. Despite houses remain among the most
risky locations, the average number of transmissions therein plunged to one-fifth.
According to Table 8, in the quarantine scenario hospitals were the most hazardous places in terms of virus transmission.
It should be emphasized that, an agent with poor health conditions or disabilities needed an eligible family member to
accompany it to the hospital. On such occasion, it is very likely that the attendant gets exposed in the hospital, if he/she
15

M. Jalayer et al.

C OV-ABM

Table 6: Average number of dead agents after 15 weeks with different measurements
Age Group

New Castle County
No intervention
Quarantine
Deaths %of the age group Deaths %of the age group

<5
5 - 17
18 - 44
45 - 64
65 +
Total

0.0
20.4
273.4
911.0
2085.8
3290.6

Age Group

Sussex County
No intervention
Quarantine
Deaths %of the age group Deaths %of the age group

<5
5 - 17
18 - 44
45 - 64
65 +
Total

0.0
0.0
49.4
330.2
1401.6
1781.2

Age Group

Kent County
No intervention
Quarantine
Deaths %of the age group Deaths %of the age group

<5
5 - 17
18 - 44
45 - 64
65 +
Total

0.0
6.6
52.2
303.0
916.8
1278.6

0.000%
0.022%
0.132%
0.645%
2.350%
0.5889%

0.0
0.0
13.4
27.2
119.2
159.8

0.000%
0.000%
0.070%
0.562%
2.433%
0.7604%

0.0
0.0
0.0
2.8
50.6
53.4

0.000%
0.022%
0.078%
0.668%
3.130%
0.7072%

0.0
0.0
4.2
3.2
9.8
17.2

0.000%
0.000%
0.006%
0.019%
0.134%
0.0286%

0.000%
0.000%
0.000%
0.005%
0.088%
0.0228%

0.000%
0.000%
0.006%
0.007%
0.033%
0.0096%

Figure 14: Occupied or needed beds in different hospitals - No intervention (left) vs. Quarantine (right)

16

M. Jalayer et al.

C OV-ABM

Table 7: The places with the most transmission incidents (No intervention)
Number of incidents
Standard deviMean
ation(%)

Location type
Schools and Kindergartens
Houses
Universities and Colleges
Churches
Hospitals
Public transportations
Gyms
Café and Restaurants
Museums
Private Offices
Industrial plants

5914.8
3792.0
1596.0
1127.2
1012.6
878.2
345.4
269.2
201.0
154.8
150.4

4.2%
6.6%
3.7%
4.5%
2.5%
3.2%
8.0%
20.4%
20.3%
1.0%
23.4%

Table 8: The places with the most transmission incidents (Quarantine)
Number of incidents
Standard deviMean
ation(%)

Location type
Hospitals
Public transportations
Houses
Groceries
Private Offices
Industrial plants
Shops
Banks
Gas stations

934.0
802.2
687.0
37.2
29.2
28.0
13.6
13.4
11.0

0.8%
8.3%
3.2%
24.0%
9.1%
3.6%
23.5%
22.9%
39.6%

did not inhale the virus at home or anywhere else. Also public transportation had an important role in the viral spread,
since in both scenarios it led to more than 800 incidents, on average, with a small standard deviation.
The comparison between Figure 15 and 16 graphically demonstrates the effectiveness of the quarantine measures in
terms of the outbreak mitigation. During the quarantine, indeed, the prevalence and density of the virus inside the city
buildings and the outdoor areas are considerably lower with respect to the other scenario.
Moreover, both figures show that the buildings in the city downtown (the center of the map) can reach the highest virus
densities. In particular, Figure 15 illustrates that the areas with a higher number of churches, colleges and schools (e.g.
the downtown), the south-eastern district and the northern district, where Delaware State University and Wilmington
University are located, have higher likelihoods to become virus hubs.

4

Discussion

ABM is one of the computational approaches which can simulate individuals and their decisions based on the rules
and the set of actions that are programmed in it. These rules are configured so that the simulator can better mimic the
behaviour of its real-world counterpart. Such simulators can be of great importance when the interactions among the
citizens and their decisions profoundly shape the dynamics of the system. Thus, since the intensity of the outbreaks
is highly reliant upon the behaviour of the individuals, this paper proposes an ABM framework, named CoV-ABM,
considering such actions and decisions in a higher detail compared to other existing frameworks. In addition, due to the
unique epidemiological and clinical features of the novel coronavirus SARS-CoV2 [38], and its remarkable durability
and persistence in the environment [25], the development of a simulator being able to consider these characteristics was
needed.
During the past few months, the COVID-19 pandemic heavily affected the lives of billions of people around the world,
17

M. Jalayer et al.

C OV-ABM

Figure 15: Simulating the spread of COVID-19 in Dover, DE with no intervention. The size of the circles represents the
locations’ virus density

Figure 16: Simulating the spread of COVID-19 in Dover, DE in quarantine. The size of the circles represents the
locations’ virus density

18

M. Jalayer et al.

C OV-ABM

as well as the global economy. Different countries and international organizations are taking unprecedented measures
to combat its spread [20]. In this scenario, CoV-ABM can be used as a decision-support tool for policymakers and
researchers to analyse the consequences of different decisions and regulations devoted to halt the outbreak and prevent
future potential occurrences.
This paper proposes a novel extension of SEIR, called SEIHRD, which formulates the hospitalized cases and the
saturation of the facilities and considers both symptomatic and asymptomatic cases. According to a study from China
[3], approximately 80% of SARS-CoV2 cases had no clinical symptoms, even though they could release large amounts
of viruses at the early phases of the infection. CoV-ABM was developed to being able of tracking the active viruses
existing at every indoor or outdoor areas, and computing the transmission probability based on the virus density at each
location. In the proposed model, indeed, a place visited by infectious people remains infectious until all its viruses get
inactivated.
This novel assumption, unlike that of studies whose diffusion models rely on social networks or agent-agent interactions,
is totally compatible with the peculiarity of SARS-CoV2. Former studies assumed that an agent directly transmits the
virus to another agent when both are close enough for a certain period or time, or when a graph-edge gets activated. In
our model, instead, an agent can infect any other individual indirectly through the environment. As an example, agent
avi ,uj releases an amount of virus at location y, where it passes by y at time t. Any susceptible agent avm ,un who visits
the same location at time t might get exposed regardless of having a social link with agent avi ,uj , until the viruses in
t
that area are not disabled (i.e. y ∆ > 0). In graph-based models this can be possible only if the graph is complete.
Another novelty of this research is how the agent communities and their interactions were modelled, specifically the
interactions among family members, relatives and friends. In our framework, each agent is a member of a family, has a
group of relatives and a set of friendship groups. When a group of friends or relatives decide to visit each other, they
choose a destination among the possible open locations where they can go together. Even if no open public places
exist, they still have the chance to set the destination to one of the available members’ houses; this possibility enables
the escalation of the virus spread. Hence, an effective mitigating scenario should consider not only limitations of the
opening hours of public places but also measures devoted to lowering as possible the probability of interactions among
individuals.
By defining two scenarios, “no intervention” and “quarantine”, this study aims at demonstrating how lock down
measures can halt the outbreak and “flatten the curve”. In particular, the simulation results for the State of Delaware
showed that the restrictions can hugely reduce the number of infected people and, consequently, the number of victims
and the hospital bed demand. From this it can be inferred that in the “no intervention” scenario, Delaware hits the peak
of outbreak between the 2nd and the 3rd week, and the number of active persons remains relatively high for about 9
more weeks. In the “quarantine” scenario, instead, the outbreak peak happens somewhere between the 6th and the 12th
weeks while the number of active agents is relatively low and lasts without any significant change by the end of our
simulation period. The results also illustrated that the spread dynamics slightly differ in different counties, maybe due
to their different health structures and urban arrangements. This opens up an opportunity for future studies to investigate
the impact of urban design and street graphs on the spread of COVID-19.
By tracking the locations of all transmission incidents and calculating the virus densities for different areas, CoV-ABM
highlighted the high-risk places inside the geographical environment. For the city of Dover, the simulation results
showed how educational and cultural places can become hubs of infection that accelerate the outbreak. In the “no
intervention” scenario, educational buildings caused roughly 48% of all the transmissions. The same percentage for
cultural places, including churches and museums, was just over 8% on average. On the other hand, our results draw
attention on the protection policies inside hospitals and public transportation, since the simulations showed that these
places, taken together, can cause more than 70% of all the infection incidents during the quarantine. Households achieved
a share of 25% and 23% of all the incidents for the “quarantine” and the “no intervention” scenarios, respectively.
Notice that, this paper tried to gather and use all the available real-world data to generate a simulation environment
as accurate as possible. However, there was still a substantial portion of urban and suburban buildings for which
complete information was missing, such as their usage, their indoor volume size and their opening hours. In such
cases, CoV-ABM assigned random values to make the environment complete. In order to enhance the precision of the
simulator, more comprehensive census and geographical information databases are required.

5

Conclusion and future opportunities

In this paper we proposed a novel spatiotemporal simulation framework, called CoV-ABM, to mimic the spread of
SARS-CoV2 virus in different geographical domains. This framework uses census data and GIS information to generate
a realistic geographical environment where people live, work, and interact with each other. CoV-ABM employs a new
extension of SEIHRD diffusion model which considers the virus characteristics and its ability to persist in the air and/or
on surfaces for long periods of time. Our diffusion model works based on the density of active SARS-CoV2 viruses at
each place’s volume. Therefore, unlike other simulators proposed in the literature, agents in our framework can inhale
19

M. Jalayer et al.

C OV-ABM

the virus in an infectious place, even if there is no other agent around. Moreover, the diffusion model considers also the
actual number of infectious people who can have asymptomatic periods of illness, and not only those who have been
tested, and some risk factors, such as pregnancy, smoking record, heart diseases and kidney misfunctioning, to generate
the health profiles for each population based on the local health information.
CoV-ABM simulates the agents’ daily needs and their social interactions with a high resolution, which enabled us to
study the consequences of different mitigation policies. Therefore, in this study we examined the impact of two different
scenarios on the dynamics of the outbreak in the State of Delaware, with a population of one million. The simulation
results illustrated that the number of deaths drastically grew in different age-groups in case of no interventions compared
to the quarantine scenario. Our framework assumed that the plethora of agents inside hospitals and the higher number
of hospitalizations reduced the hospital efficiency, and compared the difference between the hospitals’ bed demands in
the two scenarios.
Finally, CoV-ABM identified the high risky locations and buildings, in terms of the virus transmission likelihood,
in the geographical areas under investigation. According to the simulation results, the top three virus hubs were
schools, houses and universities when no restrictions were imposed, while the top-ranked places were hospitals, public
transportations and houses in the quarantine scenario. These outcomes can be of great importance for policymakers to
understand the consequences of their decisions, in particular of laws and protective regulations focused on limiting the
attendance of such locations.
The current implementation of CoV-ABM was run by simulating millions of agents at a country-level geography, to
control the computational effort and enable its usage on a personal computer. The proposed simulator, however, could
be applied on continental domains and/or on a world-wide scale by adding or removing few assumptions. Several
research opportunities and working directions are identified and recommended as follows: (1) developing a variety of
different scenarios based on the current or future policy responses to COVID-19; (2) extending the SEIHRD model to
separate the ICU beds and regular beds for patients with different morbidity conditions at hospitals and considering the
effect of self-quarantine; (3) adding airports and harbours to the model and investigating the impact of travellers and
tourists on the spread dynamics;(4) investigating the influence of different urban designs on the severity of outbreak.

Acknowledgement
This research did not receive any specific grant from funding agencies in the public, commercial, or not-for-profit
sectors.

CRediT author statement
Masoud Jalayer: Methodology, Conceptualization, Software, Data Curation, Investigation, Visualization, WritingOriginal draft preparation. Carlotta Orsenigo: Validation, Writing- Reviewing and Editing, Supervision. Carlo
Vercellis: Supervision

20

M. Jalayer et al.

A

C OV-ABM

Algorithms

Algorithm 1: Pseudo-code of the SEIHRD model
Data: t, av,u , locations, parameters
Result: av,u , locations
if av,u (st ) = inf ectious then
infect av,u (%t ) ; calculate av,u (φt+dt ) ;
if av,u (%t ) 6= av,u (%t+dt ) then
t+dt
infect av,u (%tout ) and av,u (%out
);
if av,u (%t ) ∈ hospitals then
calculate Hqt ;
if random<pth→d then
set av,u (st ) ← dead; set av,u (%t+dt ) ← a cemetery nearby
else if random<pth→r then
set av,u (st ) ← recovered;
else
if random<pti→d then
set av,u (st ) ← dead; set av,u (%t+dt ) ← a cemetery nearby
else if random<pti→r then
set av,u (st ) ← recovered;
else if av,u (st ) = exposed then
infect av,u (%t );
if av,u (%t ) 6= av,u (%t+dt ) then
t+dt
);
infect av,u (%tout ) and av,u (%out
t
if random<pe→r then
set av,u (st ) ← recovered;
else if random<pte→i then
set av,u (st ) ← inf ectious;
else if av,u (st ) = susceptible then
if random<pts→e then
set av,u (st ) ← exposed;

21

M. Jalayer et al.

C OV-ABM

Algorithm 2: Pseudo-code of the CoV-ABM discrete-event model
Initialization: set objects to default values; for (v, u) ∈ seeds then set av,u (s0 ) ← exposed;
Main loop:
while t < tmax do
foreach % ∈ locations do
update %(∆t )
foreach v ∈ families do
foreach n ∈ daily needs do
update vnt
foreach u ∈ v(members) do
regular
update vemergency
(u)t ;
regular
t
if vemergency (u) = 1 then
regular
set av,u (%t+dt ) ← a related place nearby; set vemergency
(u)(t0 ) ← t + dt
update av,u (φt+dt ); update av,u , locations ← SEIHRD(t, av,u , locations, parameters)
if av,u (st ) = inf ectious & av,u (%t ) ∈
/ hospitals then
update pti→h
if random < pti→h then
COV ID
(u)t ; set av,u (%t+dt ) ← a related emergency place nearby
update vemergency
foreach n ∈ needs = {n|vnt 6= ∅} do
if av,u is eligible then set Ont+dt ← {oi |kshortestpath(oi , av,u (%t )k < 2km};
if Ont+dt 6= ∅ then
set av,u (%t+dt ) ← random choice from Ont+dt ; set vnt ← ∅; set vnt+dt ← ∅;
S regular
COV ID
(u)t } =
6 ∅ then
(u)t vemergency
if {vemergency
v,u
v,u
if a (ζ) < 18 or a (h) < 0.3 or av,u (d) = 1 then
av,q ← random choice from eligible family members (if any) for help;
set av,q (%t+dt ) ← av,u (%t+dt )
COV ID
(u)t 6= ∅ then
if vemergency
v,u t
COV ID
if a (s ) 6= inf ectious then set vemergency
(u)t ← ∅
regular
(u)(t0 ) ≥ L then
else if t − vemergency
regular
set vemergency (u)t ← ∅

foreach g ∈ f riendgroups do
set F ← {(v, u)|av,u (φt+dt ) = 1};
if random < pf riends × timef actor(t + dt) and kF k > 1 then
set l ← a random location where they can get together;
foreach (v, u) ∈ g do
set av,u (%t+dt ) ← l; set av,u (φt+dt ) ← 0
foreach g ∈ relativesgroups do
foreach v ∈ g do
set Φv ← {(v, u)|av,u (φt+dt ) = 1}
set Fg ← {vi |kΦvi k > 1};
if random < prelatives × timef actor(t + dt) and kFg k > 1 then
set l ← a random location where they can get together;
foreach v ∈ g do
foreach u ∈ Φv do
set av,u (%t+dt ) ← l; set av,u (φt+dt ) ← 0
foreach h ∈ hospitals do
update Hht
set t ← t + dt

22

M. Jalayer et al.

C OV-ABM

References
[1] A. Alzaatreh, F. Famoye, and C. Lee. Gamma-Pareto distribution and its applications. Journal of Modern Applied
Statistical Methods, 11(1):78–94, 2012. ISSN 15389472. doi: 10.22237/jmasm/1335845160.
[2] B. Ashokka, M.-H. Loh, C. H. Tan, L. L. SU, B. E. Young, D. C. Lye, A. Biswas, S. E Illanes, and M. Choolani.
Care of the Pregnant Woman with COVID-19 in Labor and Delivery: Anesthesia, Emergency cesarean delivery,
Differential diagnosis in the acutely ill parturient, Care of the newborn, and Protection of the healthcare personnel.
American Journal of Obstetrics and Gynecology, 2020. ISSN 00029378. doi: 10.1016/j.ajog.2020.04.005. URL
https://doi.org/10.1016/j.ajog.2020.04.005.
[3] Y. Bai, L. Yao, T. Wei, F. Tian, D.-Y. Jin, L. Chen, and M. Wang. Presumed Asymptomatic Carrier Transmission
of COVID-19. JAMA, 323(14):1406, apr 2020. ISSN 0098-7484. doi: 10.1001/jama.2020.2565. URL https:
//jamanetwork.com/journals/jama/fullarticle/2762028.
[4] D. Balcan, B. Gonzalves, H. Hu, J. J. Ramasco, V. Colizza, and A. Vespignani. Modeling the spatial spread of
infectious diseases: The global epidemic and mobility computational model. Journal of Computational Science, 1
(3):132–145, 2010. ISSN 18777503. doi: 10.1016/j.jocs.2010.07.002.
[5] Y. M. Bar-On, A. Flamholz, R. Phillips, and R. Milo. Sars-cov-2 (Covid-19) by the numbers. eLife, 9:1–15, 2020.
ISSN 2050084X. doi: 10.7554/eLife.57309.
[6] G. Boeing. OSMnx: New methods for acquiring, constructing, analyzing, and visualizing complex
street networks. Computers, Environment and Urban Systems, 65:126–139, sep 2017. ISSN 01989715.
doi: 10.1016/j.compenvurbsys.2017.05.004. URL https://linkinghub.elsevier.com/retrieve/pii/
S0198971516303970.
[7] Y. Cheng, R. Luo, K. Wang, M. Zhang, Z. Wang, L. Dong, J. Li, Y. Yao, S. Ge, and G. Xu. Kidney disease is
associated with in-hospital death of patients with COVID-19. Kidney International, 97(5):829–838, 2020. ISSN
15231755. doi: 10.1016/j.kint.2020.03.005. URL https://doi.org/10.1016/j.kint.2020.03.005.
[8] K. H. Chu, W. K. Tsang, C. S. Tang, M. F. Lam, F. M. Lai, K. F. To, K. S. Fung, H. L. Tang, W. W. Yan, H. W. Chan,
T. S. Lai, K. L. Tong, and K. N. Lai. Acute renal impairment in coronavirus-associated severe acute respiratory
syndrome. Kidney International, 67(2):698–705, 2005. ISSN 00852538. doi: 10.1111/j.1523-1755.2005.67130.x.
[9] O. M. Cliff, N. Harding, M. Piraveenan, E. Y. Erten, M. Gambhir, and M. Prokopenko. Investigating spatiotemporal
dynamics and synchrony of influenza epidemics in Australia: An agent-based modelling approach. Simulation
Modelling Practice and Theory, 87(July):412–431, 2018. ISSN 1569190X. doi: 10.1016/j.simpat.2018.07.005.
[10] M. L. R. Creamer, T. W. Wang, S. Babb, K. A. Cullen, H. Day, G. Willis, A. Jamal, and L. Neff. Tobacco Product
Use and Cessation Indicators Among Adults - United States, 2018. MMWR. Morbidity and mortality weekly
report, 68(45):1013–1019, 2019. ISSN 1545861X. doi: 10.15585/mmwr.mm6845a2.
[11] E. Cuevas. An agent-based model to evaluate the COVID-19 transmission risks in facilities. Computers in Biology
and Medicine, 121(April):103827, 2020. ISSN 18790534. doi: 10.1016/j.compbiomed.2020.103827. URL
https://doi.org/10.1016/j.compbiomed.2020.103827.
[12] Delaware Division of Public Health. Delaware COVID-19, 2020. URL https://coronavirus.delaware.
gov/.
[13] W. Dietz and C. Santos-Burgoa. Obesity and its Implications for COVID-19 Mortality, 2020. ISSN 1930739X.
[14] M. D’Orazio, G. Bernardini, and E. Quagliarini. How to restart? An agent-based simulation model towards
the definition of strategies for COVID-19 "second phase" in public buildings. pages 1–21, apr 2020. URL
http://arxiv.org/abs/2004.12927.
[15] O. Dyer. Covid-19: Trump stokes protests against social distancing measures. BMJ, page m1596, apr 2020. ISSN
1756-1833. doi: 10.1136/bmj.m1596. URL http://www.bmj.com/lookup/doi/10.1136/bmj.m1596.
[16] A. A. Hagberg, D. A. Schult, and P. J. Swart. Exploring Network Structure, Dynamics, and Function using
NetworkX. In Proceedings of the 7th Python in Science conference (SciPy 2008), pages 11–15, 2008.
[17] C. M. Hales, M. D. Carroll, C. D. Fryar, and C. L. Ogden. Prevalence of Obesity Among Adults and Youth:
United States, 2015–2016. NCHS data brief, no 288. Hyattsville, MD: National Center for Health Statistics.
NCHS data brief, no 288. Hyattsville, MD: National Center for Health Statistics., (288):2015–2016, 2017. URL
https://www.cdc.gov/nchs/products/databriefs/db288.htm.
[18] S. Harini, M. Subbiah, and M. R. Srinivasan. Fitting length of stay in hospitals using transformed distributions.
Communications in Statistics Case Studies Data Analysis and Applications, 4(1):1–8, 2018. ISSN 23737484. doi:
10.1080/23737484.2018.1445979. URL https://doi.org/10.1080/23737484.2018.1445979.
23

M. Jalayer et al.

C OV-ABM

[19] E. Hunter, B. M. Namee, and J. Kelleher. A taxonomy for agent-based models in human infectious disease
epidemiology. Jasss, 20(3), 2017. ISSN 14607425. doi: 10.18564/jasss.3414.
[20] International Labour Organization. COVID-19 and the world of work: Country policy responses, 2020. URL
https://www.ilo.org/global/topics/coronavirus/country-responses/lang--en/index.htm.
[21] B. Ivorra, M. Ferrández, M. Vela-Pérez, and A. Ramos. Mathematical modeling of the spread of the coronavirus
disease 2019 (COVID-19) taking into account the undetected infections. The case of China. Communications
in Nonlinear Science and Numerical Simulation, 88:105303, 2020. ISSN 10075704. doi: 10.1016/j.cnsns.2020.
105303. URL https://doi.org/10.1016/j.cnsns.2020.105303.
[22] M. Jalayer, M. Azheian, and M. Agha Mohammad Ali Kermani. A hybrid algorithm based on community
detection and multi attribute decision making for influence maximization. Computers and Industrial Engineering,
120:234–250, apr 2018. ISSN 03608352. doi: 10.1016/j.cie.2018.04.049. URL https://doi.org/10.1016/j.
cie.2018.04.049.
[23] R. E. Jordan, P. Adab, and K. K. Cheng. Covid-19: Risk factors for severe disease and death. The BMJ, 368(March):
1–2, 2020. ISSN 17561833. doi: 10.1136/bmj.m1198. URL http://dx.doi.org/doi:10.1136/bmj.m1198.
[24] D. Kai, G.-P. Goldstein, A. Morgunov, V. Nangalia, and A. Rotkirch. Universal Masking is Urgent in the
COVID-19 Pandemic: SEIR and Agent Based Models, Empirical Validation, Policy Recommendations. 2020.
URL http://arxiv.org/abs/2004.13553.
[25] G. Kampf, D. Todt, S. Pfaender, and E. Steinmann. Persistence of coronaviruses on inanimate surfaces and their
inactivation with biocidal agents. Journal of Hospital Infection, 104(3):246–251, 2020. ISSN 15322939. doi:
10.1016/j.jhin.2020.01.022. URL https://doi.org/10.1016/j.jhin.2020.01.022.
[26] M. Kantner and T. Koprucki. Beyond just "flattening the curve": Optimal control of epidemics with purely
non-pharmaceutical interventions. 2020.
[27] R. Kassir. Risk of COVID-19 for patients with obesity, 2020. ISSN 1467789X.
[28] M. J. Keeling and P. Rohani. Modeling infectious diseases in humans and animals. Princeton University Press,
2011.
[29] Q. Li, X. Guan, P. Wu, X. Wang, L. Zhou, Y. Tong, R. Ren, K. S. Leung, E. H. Lau, J. Y. Wong, X. Xing, N. Xiang,
Y. Wu, C. Li, Q. Chen, D. Li, T. Liu, J. Zhao, M. Liu, W. Tu, C. Chen, L. Jin, R. Yang, Q. Wang, S. Zhou, R. Wang,
H. Liu, Y. Luo, Y. Liu, G. Shao, H. Li, Z. Tao, Y. Yang, Z. Deng, B. Liu, Z. Ma, Y. Zhang, G. Shi, T. T. Lam, J. T.
Wu, G. F. Gao, B. J. Cowling, B. Yang, G. M. Leung, and Z. Feng. Early transmission dynamics in Wuhan, China,
of novel coronavirus-infected pneumonia. New England Journal of Medicine, 382(13):1199–1207, 2020. ISSN
15334406. doi: 10.1056/NEJMoa2001316.
[30] S. M. Moghadas, A. Shoukat, M. C. Fitzpatrick, C. R. Wells, P. Sah, A. Pandey, J. D. Sachs, Z. Wang, L. A.
Meyers, B. H. Singer, and A. P. Galvani. Projecting hospital utilization during the COVID-19 outbreaks in
the United States. Proceedings of the National Academy of Sciences of the United States of America, 117(16):
9122–9126, 2020. ISSN 10916490. doi: 10.1073/pnas.2004064117.
[31] A. Shoukat, C. R. Wells, J. M. Langley, B. H. Singer, A. P. Galvani, and S. M. Moghadas. Projecting demand for
critical care beds during COVID-19 outbreaks in Canada. Cmaj, 192(19):E489–E496, 2020. ISSN 14882329. doi:
10.1503/cmaj.200457.
[32] F. Squazzoni, J. G. Polhill, B. Edmonds, P. Ahrweiler, P. Antosz, G. Scholz, E. Chappin, M. Borit, H. Verhagen,
F. Giardini, and N. Gilbert. Computational models that matter during a global pandemic outbreak: A call to action.
Jasss, 23(2), 2020. ISSN 14607425. doi: 10.18564/jasss.4298.
[33] US Department of Health and Human Services.
Chronic Kidney Disease in the United States,
2019.
Technical report, 2019.
URL https://www.cdc.gov/kidneydisease/pdf/2019/
National-Chronic-Kidney-Disease-Fact-Sheet.pdf.
[34] US Department of Health and Human Services. National Diabetes Statistics Report, 2020. Technical report, 2020.
[35] US National Center for Health Statistics. Summary Health Statistics: National Health Interview Survey, 2018.
Technical report, 2018. URL http://www.cdc.gov/nchs/nhis/SHS/tables.htm.
[36] C. I. Vardavas and K. Nikitara. COVID-19 and smoking: A systematic review of the evidence. Tobacco Induced
Diseases, 18(March):1–4, 2020. ISSN 16179625. doi: 10.18332/tid/119324.
[37] Y. Wang, J. Cao, A. Alsaedi, and B. Ahmad. Edge-based SEIR dynamics with or without infectious force in latent
period on random networks. Communications in Nonlinear Science and Numerical Simulation, 45:35–54, 2017.
ISSN 10075704. doi: 10.1016/j.cnsns.2016.09.014.
24

M. Jalayer et al.

C OV-ABM

[38] Y. Wang, Y. Wang, Y. Chen, and Q. Qin. Unique epidemiological and clinical features of the emerging 2019 novel
coronavirus pneumonia (COVID-19) implicate special control measures, 2020. ISSN 10969071.
[39] W. P. Witt, A. J. Weiss, and A. Elixhauser. Overview of Hospital Stays for Children in the United States, 2012:
Statistical Brief 187. Healthcare Cost and Utilization Project (HCUP) Statistical Briefs, (425):1–14, 2006. URL
http://www.ncbi.nlm.nih.gov/pubmed/25695124.
[40] World Health Organization. Report of the WHO-China Joint Mission on Coronavirus Disease 2019 (COVID-19).
Technical Report February, 2020. URL https://www.who.int/docs/default-source/coronaviruse/
who-china-joint-mission-on-covid-19-final-report.pdf.
[41] Worldometers. Age, Sex, Existing Conditions of COVID-19 Cases and Deaths, 2020. URL https://www.
worldometers.info/coronavirus/coronavirus-age-sex-demographics/.
[42] Worldometers. Coronavirus statistics, 2020. URL https://www.worldometers.info/coronavirus.
[43] M. Xie, X. Liu, X. Cao, M. Guo, and X. Li. Trends in prevalence and incidence of chronic respiratory diseases
from 1990 to 2017. Respiratory Research, 21(1):1–13, 2020. ISSN 1465993X. doi: 10.1186/s12931-020-1291-8.
[44] Z. Yang, Z. Zeng, K. Wang, S.-S. Wong, W. Liang, M. Zanin, P. Liu, X. Cao, Z. Gao, Z. Mai, J. Liang, X. Liu, S. Li,
Y. Li, F. Ye, W. Guan, Y. Yang, F. Li, S. Luo, Y. Xie, B. Liu, Z. Wang, S. Zhang, Y. Wang, N. Zhong, and J. He.
Modified SEIR and AI prediction of the epidemics trend of COVID-19 in China under public health interventions.
Journal of Thoracic Disease, 12(3):165–174, mar 2020. ISSN 20721439. doi: 10.21037/jtd.2020.02.64. URL
http://jtd.amegroups.com/article/view/36385/html.
[45] Y.-Y. Zheng, Y.-T. Ma, J.-Y. Zhang, and X. Xie. COVID-19 and the cardiovascular system. Nature Reviews
Cardiology, 17(5):259–260, may 2020. ISSN 1759-5002. doi: 10.1038/s41569-020-0360-5. URL http://dx.
doi.org/10.1038/s41569-020-0360-5http://www.nature.com/articles/s41569-020-0360-5.

25

