arXiv:2004.04019v1 [stat.OT] 8 Apr 2020

A machine learning methodology for real-time
forecasting of the 2019-2020 COVID-19 outbreak
using Internet searches, news alerts, and estimates
from mechanistic models
Dianbo Liu†,1,2 , Leonardo Clemente†,1,2,3 , Canelle Poirier†,1,2 ,
Xiyu Ding1,4 , Matteo Chinazzi5 , Jessica T Davis5 , Alessandro Vespignani5,6 ,
Mauricio Santillana∗,1,2,4
1

Computational Health Informatics Program, Boston Children’s Hospital, Boston MA 02215
2

Department of Pediatrics, Harvard Medical School, Boston MA 02215
3

Tecnolgico de Monterrey, 64849, Monterrey, N.L., Mexico
4
Harvard T.H. Chan School of Public Health, Boston MA 02215
5

Laboratory for the Modeling of Biological and Socio-technical Systems,
Northeastern University, Boston, MA USA
6

ISI Foundation, Turin, Italy
∗
Corresponding author: Mauricio Santillana, msantill@g.harvard.edu
†

These authors contributed equally to this paper.

Abstract
We present a timely and novel methodology that combines disease estimates from mechanistic models with digital traces, via interpretable machine-learning methodologies, to
reliably forecast COVID-19 activity in Chinese provinces in real-time. Specifically, our
method is able to produce stable and accurate forecasts 2 days ahead of current time, and
uses as inputs (a) official health reports from Chinese Center Disease for Control and Prevention (China CDC), (b) COVID-19-related internet search activity from Baidu, (c) news
media activity reported by Media Cloud, and (d) daily forecasts of COVID-19 activity
from GLEAM, an agent-based mechanistic model. Our machine-learning methodology
uses a clustering technique that enables the exploitation of geo-spatial synchronicities of
COVID-19 activity across Chinese provinces, and a data augmentation technique to deal
with the small number of historical disease activity observations, characteristic of emerging outbreaks. Our model’s predictive power outperforms a collection of baseline models

1

in 27 out of the 32 Chinese provinces, and could be easily extended to other geographies
currently affected by the COVID-19 outbreak to help decision makers.

Introduction
First detected in Wuhan, China, in December 2019, the SARS-CoV-2 virus had rapidly spread
by late January 2020 to all Chinese provinces and many other countries (1–4). On January 30,
2020, the World Health Organization (WHO) issued a Public Health Emergency of International
Concern (PHEIC) (5–8); and on March 11th, the WHO declared a pandemic for the Coronavirus
Disease (COVID-19) (5). By April 6, 2020, the virus had affected more than 1,200,000 people
and caused the deaths of 70,000 in more than 180 countries. (7).
In the last decade, methods that leverage data from Internet-based data sources and data from
traditional surveillance systems have emerged as a complementary alternative to provide near
real-time disease activity (e.g. Influenza, dengue) estimates (9–13). Despite the fact that these
methodologies have successfully addressed delays in the availability of health reports as well as
case count data quality issues, developing predictive models for an emerging disease outbreak
such as COVID-19 is an even more challenging task (14). There are multiple reasons for this,
for example, the availability of epidemiological information for this disease is scarce (there is
no historical precedent about the behavior of the disease), the daily/weekly epidemiological reports that become available are frequently revised and corrected retrospectively to account for
mistakes in data collection and reporting (a common practice in public health reports), and the
presence of a diverse array of uncertainties about disease burden due in part to underreporting
of cases (15).
Most efforts to estimate the time evolution of COVID-19 spread and the effect of public health
interventions have relied on mechanistic models that parameterize transmission and epidemiological characteristics to produce forecasts of disease activity (16, 17). In contrast, few studies
have investigated ways to track COVID-19 activity, leveraging internet search data (1, 13, 18),
and none to the best of our knowledge have combined Internet-based data sources and mechanistic estimates to forecast COVID-19 activity.
Our contribution: We present a novel methodology that combines mechanistic and machinelearning methodologies to successfully forecast COVID-19 in real-time at the province level
in China. Augmented ARGONet uses a data-driven approach to incorporate inputs from (a)
official health reports from China CDC, (b) COVID-19-related internet search activity from
Baidu, (c) news media activity reported by Media Cloud, and (d) daily forecasts of COVID19 activity from GLEAM, an agent-based mechanistic model (16). Inspired by a methodology previously used to successfully forecast seasonal influenza in the United States at the state
level (11) and previous methods to monitor emerging outbreaks (19,20), Augmented ARGONet
2

is capable of reliably forecasting COVID-19 activity even when limited historical disease activity observations are available. From a methodological perspective, the novelty in our approach
comes from a clustering technique that enables the exploitation of geo-spatial synchronicities of
COVID-19’s activity across Chinese provinces, and a data augmentation technique to mitigate
the scarcity of historical data for model-training.

Results
We produced 2-day ahead (strictly out-of-sample) and real-time COVID-19 forecasts for 32
Chinese provinces, for the time period spanning February 3, 2020 to February 21, 2020. In
other words, our study was not retrospective, it was conducted as the outbreak unfolded. The
forecasting (case aggregation) time horizon of our predictions was chosen to be 2 days to enhance the signal to noise ratio. Based on geo-spatial synchronicities in COVID-19 activity in
each province during the (dynamically increasing) training period, groups of Chinese provinces
were clustered, every two days, to train a separate machine learning model per cluster to produce predictions. COVID-19 historical information from official health reports, Baidu search
engine frequencies, news reports from Media Cloud, and mechanistic model estimates were
then included into separate datasets for each cluster of provinces. Additionally, a data augmentation procedure aimed at increasing the size of each cluster’s training dataset was implemented
to deal with the scarce number of observations during this relatively-short (local) outbreak. A
visual representation of our out-of-sample model forecasts is shown in Figure 1 along with the
subsequently observed COVID-19 cases, as reported by China CDC.
To quantitatively evaluate the predictive power of Augmented ARGONet, we compared our
forecasts with a collection of baseline forecasts obtained with (a) a “persistence model” that
forecasts that the number of new COVID-19 cases (in the next two days) will exactly be the
number of cases observed in the past two days (used as the baseline for all models), (b) an
autoregressive model that only uses historical COVID-19 activity as input, and (c) an enhanced
version of ARGONet, without the incorporation of mechanistic model outputs (see details in
Materials and Methods section). Our results show that Augmented ARGONet, outperforms the
persistence model in 27 out of the 32 Chinese provinces. Even in provinces where Augmented
ARGONet failed to produce improvements to the baseline model, our model produced reasonable disease estimates as seen in Figure 1. These provinces include Shanxi, Liaoning, Taiwan,
Hong Kong and Guangxi; the latter three with very different administration (and likely healthcare) systems compared to the rest of the provinces.
Models built with only local data do not produce significantly better predictions than the
baseline. We analyzed the performance of models built using only local province-level epidemiological data as input. We generated an autoregressive (AR) model for each province, built
on COVID-19 cases that occurred in the previous 3 autoregressive lags (i.e. the previous 3,
3

2-day reports), and compared our estimates with the baseline. Our results, presented in Figure
2 labeled AR, show that the autoregressive model predictive power was overall inferior to the
baseline’s performance, with exception to Jilin, Tianjin, Hebei, Hubei and Heilongjiang. Subsequently, we incorporated local disease-related internet search information from Baidu and
news alert data from media cloud as inputs to build ARGO-type models (9). These ARGO-type
models showed marginal predictive power improvements when compared with autoregressive
models (AR) and only outperformed the baseline in 7 provinces.
Dynamic clustering of Chinese provinces. Based on prior work on Influenza activity prediction (11), we added historical COVID-19 activity information for all Chinese provinces to the
input of our local models. We calculated the pairwise correlation matrix for confirmed COVID19 cases between all Chinese provinces, between February 1 and February 21 2020 (Figure S1).
Our results showed that most of the provinces experienced similar epidemic trends. To build
our (clustered) predictive models we combined the data available from several provinces with
similar trends (in terms of correlation, which was strictly calculated within our training period
at the time-step of prediction). The clustering modeling approach, which incorporated Internetbased data sources as the ARGO-type models, produced forecasts that led to error reductions
for 17 out of 32 provinces compared to the persistence model, and improved correlation values
in 20 out of 32 provinces.
Data augmentation. As an additional way to increase the number of observations in the training set of each cluster, we implemented a data augmentation technique. This process consisted
of generating new observations via a Bootstrap method and addition of random Gaussian noise
( ∼ N (0, 0.01)) to every randomly selected observation.
The results of incorporating both clustering and augmentation techniques can be seen in Figure
2. For simplicity, we labeled these predictions ARGONet, even though this implementation
of ARGONet is an enhanced version specifically designed for emerging outbreaks where data
is scarce. In terms of RMSE, our results show that ARGONet’s predictive power was able to
outperform AR and the persistence model in 25 of the 32 Chinese provinces. In terms of correlation, ARGONet outperformed the baseline (persistence) model in 18 provinces.
Augmented ARGONet. We included forecasts produced by mechanistic model as an additional input in our models (prior to the clustering and augmentation steps). The results of
incorporating these estimates can be seen in Figure 2 with the name of Augmented ARGONet.
Our results show that the inclusion of mechanistic model estimates improved ARGONet’s predictive power across the majority of provinces. Augmented ARGONet led to error reductions in
27 out of 32 provinces compared to the baseline. In terms of correlation, it improved in 26 out
of 32 provinces. Provinces like Qinghai, Hunan and Jiangxi showed the biggest improvement,
whereas Taiwan, Hong Kong, Shanxi and Liaoning did not display error reductions.

4

As an alternative way to visualize Augmented ARGONet’s predictive performance, we plotted a
map with Chinese provinces (Figure 3) color-coded based on the improvement shown in Figure
2. From a geographical perspective, the provinces where Augmented ARGONet had the most
improvement (Anhui, Jiangxi, Fujian, Sichuan, Guangdong) were located in South Central of
China. Shanxi, Liaoning, Taiwan, Hong Kong, and Guangxi are the provinces where our models were not able to reduce the error compared to the baseline. While Augmented ARGONet’s
performance in these provinces was not superior to the baseline, its predictions were within a
reasonable range as seen in Figures 1 and 2. We suspect that the reason why performance in Taiwan, Hong Kong, and Guangxi did not improve is due to the different administrative (and likely
healthcare) systems of these provinces. We were not able to perform any analysis on Tibet, one
of the largest province in China, and Macau given their low count of detected COVID-19 cases.
Analysis of the importance of the sources of information over time. To minimize the prediction errors in our estimates, the dynamic design of our methodology utilizes different sources
of information as needed over time. This means that, for each province (or group of provinces
within a cluster), we can quantify the predictive power of different features used in our models
as time evolves. Our analysis, visualized in Figure 4, shows that historical COVID-19 confirmed cases, and suspected cases were consistently relevant sources of information over most
of the study period. Internet-based search terms from Baidu were also frequently used. Daily
news counts were used by our models in a selected number of provinces. However, for many
of these provinces, the importance of media article counts decrease over time. Estimates from
mechanistic models contributed to our model prediction, especially in early February, 2020.

5

0

Zhejiang
200

10

100

20

0
40

200

20

100

0

0

Inner Mongolia 10

10
0

10

2020-02-21

2020-02-03

2020-01-18

0

Prediction Date

Heilongjiang
50
0

Chongqing

0

Liaoning

20

0

Shanxi

20

10

10

0

0

Guangxi
20

50

0

Hong Kong

0

Hubei

10000

0

10

40
20
0

20000

100

Hainan
20

Beijing

0

Hunan

0

Shandong

Ningxia

5

5

50

0

Hebei

0

Jiangsu

10

Tianjin

10

0

Jilin

Taiwan
5
0

Prediction Date

2020-01-18

20

20

2020-02-21

0

2020-02-21

Number of Cases

10

Guizhou

Shaanxi

40

2020-02-21

0

0

Gansu

5

0

Number of Cases

0.0

2020-02-03

Number of Cases

20

100

Xinjiang

10

Henan

200

2.5

0

Yunnan

Qinghai
5.0

100

0

0

Guangdong

200

100

20

0

2020-02-03

Jiangxi

Training Period

Fujian

40

50

2020-01-18

0

Augmented ARGONet

Sichuan

2020-02-03

40
20
0

100

20

Baseline

Shanghai

2020-01-18

Number of Cases

COVID-19 Confirmed Cases

Anhui

Figure 1: Graphical visualization of the number of new confirmed cases for COVID-19, as
reported by China CDC, along with Augmented ARGONet (solid red) 2-day ahead of time
estimates between February 3 2020, through February 21 2020. As a comparison, the dotted
blue line represents the persistence model.

6

BASELINE
Error Improvement (RMSE
RMSEMODEL )

Augmented ARGONet

2.0

ARGONet

AR

1.5

1.0

0.5

Anhui
Shanghai
Sichuan
Fujian
Jiangxi
Guangdong
Qinghai
Henan
Yunnan
Xinjiang
Gansu
Shaanxi
Guizhou
Zhejiang
Jilin
Jiangsu
Tianjin
Hebei
Shandong
Hainan
Inner Mongolia
Ningxia
Beijing
Heilongjiang
Hunan
Hubei
Chongqing
Guangxi
Hong Kong
Liaoning
Shanxi
Taiwan

0.0

ARGONet

0.4

0.2

0.0

0.2

0.4

Qinghai
Gansu
Taiwan
Xinjiang
Hebei
Ningxia
Hubei
Hong Kong
Jilin
Heilongjiang
Tianjin
Anhui
Jiangxi
Shanghai
Yunnan
Hainan
Henan
Guizhou
Sichuan
Shanxi
Fujian
Jiangsu
Shaanxi
Guangxi
Guangdong
Hunan
Zhejiang
Beijing
Shandong
Liaoning
Chongqing
Inner Mongolia

Correlation Improvement |

Model

Baseline|

Augmented ARGONet

Figure 2: Comparison of the improvement in terms of RMSE (top) and Pearson Correlation
(bottom) for each model used in the study. To facilitate comparison between model scores in
each province in terms of RMSE, we normalized the RMSE score of each model by the baseline’s RMSE and visualized its inverse value. In this way, scores above 1 imply an improvement
(RMSE reduction), whereas score below 1 imply the model had a bigger RMSE in comparison
to the baseline. In the case of correlation, we plotted the difference between the absolute values
between each model’s correlation and the baseline. Each panel is ordered, from left to right,
based on the metric performance of Augmented ARGONet (solid red).

7

AR

RM SEmodel
Figure 3: Geographical visualization of the relative improvement ( RM
). Chinese
SEbaseline
provinces that show an increase in performance relative to the baseline are shaded green, while
provinces that did not perform better than our baseline are shaded purple. Provinces with the
highest improvement (Anhui, Shanghai, Sichuan, Fujian, Jiangxi, Guangdong, Qinghai) and
underperformance (Taiwan, Shanxi, Liaoning, Hong Kong, and Guangxi) are identified by a
red dot over the province.

8

Anhui

Shanghai

Sichuan

Fujian

Jiangxi

Guangdong

Qinghai

Henan

Yunnan

Xinjiang

Gansu

Shaanxi

Guizhou

Zhejiang

Jilin

Jiangsu

Tianjin

Hebei

Shandong

Hainan

Inner Mongolia

Ningxia

Beijing

Heilongjiang

Hunan

Hubei

Chongqing

Guangxi

Hong Kong

Liaoning

Shanxi

Taiwan

Intercept
Confirmed Cases (t-1)
Confirmed Cases (t-3)
Cumulative confirmed cases (t)
Media Cloud Count (t)
Baidu Term "how many degree is fever" (t)
Mechanistic Model Estimate (t)
Confirmed Cases (t)
Confirmed Cases (t-2)
New suspected cases (t)
Cumulative suspected cases (t)
Baidu Term "coronavirus symptom" (t)
Baidu Term "symptom of fever" (t)
Intercept
Confirmed Cases (t-1)
Confirmed Cases (t-3)
Cumulative confirmed cases (t)
Media Cloud Count (t)
Baidu Term "how many degree is fever" (t)
Mechanistic Model Estimate (t)

0.6

0.4

0.2

0.0

0.2

0.4

Figure 4: Time evolution of the value (averaged over the 20 experiments) of the linear coefficients for the features used in our methodology, visualized per province. Every heatmap
includes the same number of features (rows) and is organized in the same order.

9

0.6

2020-02-19

2020-02-15

2020-02-11

2020-02-07

2020-02-03

2020-02-19

2020-02-15

2020-02-11

2020-02-07

2020-02-03

2020-02-19

2020-02-15

2020-02-11

2020-02-07

2020-02-03
2020-02-19

2020-02-15

2020-02-11

2020-02-07

2020-02-03

2020-02-19

2020-02-15

2020-02-11

2020-02-07

2020-02-03

2020-02-19

2020-02-15

2020-02-11

2020-02-07

2020-02-03

2020-02-19

2020-02-15

2020-02-11

2020-02-03

Intercept
Confirmed Cases (t-1)
Confirmed Cases (t-3)
Cumulative confirmed cases (t)
Media Cloud Count (t)
Baidu Term "how many degree is fever" (t)
Mechanistic Model Estimate (t)

2020-02-07

Confirmed Cases (t)
Confirmed Cases (t-2)
New suspected cases (t)
Cumulative suspected cases (t)
Baidu Term "coronavirus symptom" (t)
Baidu Term "symptom of fever" (t)

Discussion
We presented a methodology capable of producing meaningful and reliable short-term (2-day
ahead) forecasts of COVID-19 activity, at the province level in China, by combining information from reports from China CDC, Internet search trends, news article trends, and information
from mechanistic models. Our approach is capable of overcoming multiple challenges characteristic of emerging outbreaks caused by novel pathogens. These challenges include: the lack of
historical disease activity information to calibrate models, the low volume of case count data,
and the inherent delay to gain access to data. Methodologically speaking, our method maximizes the use of limited number of observations as the outbreak unfolded by (a) choosing an
appropriate aggregation time-window (2 days) to improve the signal to noise ratio , (b) leveraging synchronicities in the spatio-temporal trends in COVID-19, across provinces, to produce
cluster-specific models of prediction, and (c) using data augmentation methods to increase the
stability in the training of our models.
Previous methods, such as the ARGONet model (11, 21), have been shown to make accurate
real-time prediction, at the state-level in the USA for seasonal infectious diseases such as Influenza. In addition, Chinazzi et al. (16), showed that it was possible to estimate the evolution of
an emerging outbreak using a mechanistic model. Nevertheless, as far as we know, reliable realtime methodologies to forecast new case counts for an emerging disease outbreak remained an
unsolved problem. In this study, we showed that dynamically trained machine learning model
can produce accurately real-time estimates for COVID-19 outbreak.
In terms of prediction error, our proposed methodology, Augmented ARGONet, was able to
outperform the persistence model in 27 out of 32 provinces. While our method does not show
prediction error improvements in Guangxi, Liaoning, Shanxi, Taiwan, and Hong Kong, our
forecasts are still within range in all provinces except for Taiwan, where very few cases were
reported during the time-period of this study. It is important to note that Taiwan , Hong Kong
and Guangxi have different administrative (and likely healthcare) systems compared with other
provinces. This, could explain the differences in COVID-19 trends in these regions and could
help explain why our models do not seem to add value to the persistence model. Features studies should investigate if incorporating disease activity estimates from other mechanistic models,
designed with likely different assumptions and mathematical formulations, could lead to further
improvements.
We were unable to identify an accurate (daily) parametrization of changes in human mobility
due to the widespread local lockdowns during the period of our study (February 3-21, 2020),
and thus, we did not include this data source as a potential predictor. Future studies may incorporate (high temporal resolution) human mobility data as a modulator of transmission and
predictor of disease activity. When looking at the entire time-period of this study; however,
we observed that the data-driven clustering of provinces used in our approach and based on
10

COVID-19 activity, appears to have similarities with the clustering one would obtain using
human mobility data made available by Baidu (22) (Figure S1). This result aligns with the conclusion of other available studies that find that the time evolution of the COVID-19 outbreak
in China, was importantly influenced by changes in human mobility (consequence of public
health interventions) (16, 17, 23), and in the early stages, associated to the percentage of people
traveling from Wuhan.
Our findings suggest that, it is possible to use very limited amounts of data from multiple data
sources to conduct real time forecasting in the early stage of an emerging outbreak. We believe
that our method, Augmented ARGONet, could prove to be useful for public health officials
to monitor (and perhaps prevent) the spread of the virus (8, 11, 24, 25). As the SARS-CoV-2
virus continues to spread around the world, extensions of our methods could be implemented to
provide timely and reliable disease activity estimates to decision makers.

Materials and Methods
Data sources. We used the following data sources for our study: COVID-19 activity reports
from China Centers for Disease Control and Prevention (CDC), Internet search frequencies
from Baidu, the number of related news reports from 311 media sources, as reported by the
Media Cloud platform, and COVID-19 daily forecasts from the Global Epidemic and Mobility
Model. We provide details about each of these data sources in the next paragraphs.
Daily reports of COVID-19. Case counts of COVID-19 were obtained from China CDC .
This data is curated and publicly available via the Models of Infectious Disease Agent Study
(MIDAS) association (github.com/midas-network/COVID-19/tree/master/data/cases). All data
were collected on the original date they became available. Indeed, case counts released by
China CDC can be revised, up to several weeks later. In this study, we only used unrevised
data, which is the real case scenario to produce real time estimates. The reports, available for
all the provinces, include various activity trends such as: new diagnosed cases, new suspected
cases, and new reported deaths. For our study, we selected the number of confirmed cases as
the epidemiological target, and collected activity reports from January 10, 2020 to February 21,
2020.
Baidu Internet search activity. We collected the daily search fraction for three different
COVID-19-related search terms in Mandarin (translated in English they are ”COVID-19 symptoms”, ”how many degrees” and ”symptoms of fever”). These terms were selected based on
their correlation and potential association with case counts of COVID-19 (26), and collected
individually for each province from January 1, 2020 to February 21, 2020. Our decision to use
Internet activity as a source of information is based on the hypothesis that search frequencies
from COVID-19-related keywords reflect, to an extent, the number of people presenting symptoms related to COVID-19 before their arrival to a clinic. Given Baidu imposes limits to the data
11

access for researchers, we were unable to conduct a broad analysis on a wide range keywords.
A visualization of the Baidu search term timeseries can be seen in S3.
News reports. An online open-source platform called Media Cloud, that allows the tracking and analysis of media for any topic of interest through the matching of keywords, was used.
We obtained volumes of the number of news articles available over time from a collection of
311 Chinese media websites using the keywords “coronavirus” ,“COVID-19”, “2019-nCoV”,
“pneumonia”,“fever”,“cough” and the name of each province to generate province-specific
news activity trends. Media data from January 1, 2020 to February 21, 2020 were collected
and used as an additional source information.
Aggregation of daily reports. To enhance signal and reduce noise, we aggregated case count,
searches volume and media articles count for each δt =2 days window.
As COVID-19 is an emerging outbreak, the amount of epidemiological-related information,
either official or non-official, is low, and thus, limits our capacity to build predictive models. To
maximize usage of data, we applied the following strategies:
Clustering. We clustered the 32 provinces into several groups and train a model for each
group. Clustering and model retraining processes were repeated on every single new prediction
date. To know the similarity of outbreak pattern among Chinese provinces, we calculated the
pairwise correlation matrix for confirmed COVID-19 cases by using all historical data available.
Then, based on similarity matrix, provinces were clustered by using complete linkage hierarchical clustering, which is an agglomerative hierarchical clustering method, creating clusters
based on most dissimilar pairs. (27). The number of clusters K was determined by choosing the
K, maximizing Calinski-Harabasz index (28).
Data Augmentation. We conducted data augmentation by using bootstrap method to re-sample
each data point of the training dataset. We made 100 bootstrap samples for each data point to
which we added a random Gaussian noise with a mean of 0 and a standard deviation of 0.01.
Due to stochasticity of both clustering algorithm and model training processing, on each prediction day, we run the whole clustering-training process twenty times and take an average of
the outputs as our final prediction.
Predictive model. For our prediction task, we fitted a LASSO multi-variable regularized linear model for every data set generated from our clustering and augmentation steps at time t.
The LASSO technique minimizes the mean squared error between observations and predictions
subject to a L1 norm constraint. The number of new confirmed COVID-19 cases for the next

12

bi-day can be then expressed as:
yT +δt =

3
X

αi yT −iδt + βST + γMT + δDT + ψCT + T +δt

(1)

i=0

where
• yT +δt is the estimate at date T + δt,where δt = 2 days
• yT is the number of cases at date T .
• ST is the searches volume at date T .
• MT is the number of media article at date T .
• DT is the number of deaths at date T .
• CT is the number of cumulative cases at date T .
• T +δt is the normally distributed error term.
Model were dynamically recalibrated, similar to the method presented in Santillana et al. 2014
(29) and Lu et al. 2019 (11). Our method was implemented in R 3.5.3 environment with glmnet
3.0-2 library.
Global Epidemic and Mobility Model (GLEAM) GLEAM, the mechanistic model used in
this study, is an individual-based, stochastic, and spatial epidemic model (16, 30–32). GLEAM
uses a meta-population network approach which was integrated with real-world data. In GLEAM,
the world population is divided into sub-populations centered around major transportation hubs
(usually airports). The sub-populations are connected by the flow of individuals traveling daily
among them. Over 3,000 sub-populations in about 200 different countries and territories are
included in the model. The airline transportation data consider daily origin-destination traffic
flows obtained from the Official Aviation Guide (OAG) and IATA databases (updated in 2019).
Ground mobility flows are derived by the analysis and modeling of data collected from the
statistics offices for 30 countries on 5 continents (30). Mobility variations in Mainland China
were adapted from information from Baidu Location-Based Services (LBS). Within each subpopulation, the human-to-human transmission of COVID-19 is modeled using a compartmental
representation of the disease where each individual can occupy one of the following four states:
Susceptible (S), Latent (L), Infectious (I) and Removed (R). Susceptible individuals can acquire the virus through contacts with individuals in the infectious state, and become latent,
meaning they are infected but can not transmit the infection yet. Latent individuals progress to
the infectious stage with a rate inversely proportional to the latent period. Infectious individuals
progress into the removed stage with a rate inversely proportional to the infectious period. The

13

sum of the average latent and infectious periods defines the generation time. Removed individuals represent those who can no longer infect others, meaning they were isolated, hospitalized,
died, or have recovered.
The model produces an ensemble of possible epidemic scenarios described by the number of
newly generated infections, times of disease arrival in each subpopulation, and the number of
traveling infection carriers. We make an assumption that a starting date of the epidemic that
falls between November, 15 2019 and December 1, 2019, with 40 cases IS caused by zoonotic
exposure (33–36). The transmission dynamic is calibrated by using an Approximate Bayesian
Computation approach to estimate the posterior distribution of the basic reproductive number
R0 (37). We assume that the world has a detection of imported cases as low as 40% (38, 39).
Data on importation of cases were derived from currently available published line lists (40, 41).
Performance of model and relevance of predictors. Two different metrics were used to
measure the performance of our predictive model : 1) The root mean square error (RMSE),
2) The Pearson correlation. To assess the predictive power of our methodology, we compared
our performance against the following models:
1. Persistence rule (Baseline): A rule-based model that uses the new case count at date T as
estimate of prediction for T + δt so that (yT +δt = yT )
2. Autoregressive (AR): A simple autoregressive model built on COVID-19 cases that occurred in the previous 3 autoregressive lags (2-day reports). Please refer to Supplementary
Materials for more information on this model.
3. ARGONet : An alternate version of our methodology that does not include any mechanistic information.
As linear models are used in this study, relevance of predictors in predicting new cases can be
defined thanks to the associated factor of each term in the trained model. As all data were normalized using the z-score (strictly within the training datasets) during training and prediction,
the associated factor can be approximately understood as, how many standard deviations the
predicted new cases yT +δt will change if 1 standard deviation change in the predictor.

Acknowledgments
We thank Dr. Wei Luo for his assistance and guidance on the interpretation of mobility data for
Chinese provinces. MC and AV acknowledge support from Google Cloud Healthcare and Life
Sciences Solutions via GCP research credits program.

14

Funding statement
CP, AV, and MS were partially supported by the National Institute of General Medical Sciences
of the National Institutes of Health under Award Number R01GM130668. The content is solely
the responsibility of the authors and does not necessarily represent the official views of the
National Institutes of Health.

Author contributions
DL, LC, CP, AV, and MS conceived and designed the study. DL, LC, CP, XD, MC collected the
different data sources. MC, JTD, and AV, produced predictions using the GLEAM modeling
platform. DL, LC, CP, implemented the Augmented ARGONet methodology. DL, LC, CP,
and MS analyzed the results. DL, LC, CP, and MS wrote the first draft of the manuscript. All
authors contributed to and approved the final version of the manuscript.

Competing interests
The authors have declared no competing interest.

Data sharing
All codes and data will be made available via the Harvard dataverse.

References and Notes
1. Li, Q. et al. Early transmission dynamics in wuhan, china, of novel coronavirus–infected
pneumonia. New England Journal of Medicine (2020).
2. Zhu, N. et al. A novel coronavirus from patients with pneumonia in china, 2019. New
England Journal of Medicine (2020).
3. Chan, J. F.-W. et al. A familial cluster of pneumonia associated with the 2019 novel coronavirus indicating person-to-person transmission: a study of a family cluster. The Lancet
(2020).
4. Gilbert, M. et al. Preparedness and vulnerability of african countries against introductions
of 2019-ncov. medRxiv (2020).

15

5. WHO. Statement on the second meeting of the international health regulations (2005)
emergency committee regarding the outbreak of novel coronavirus (2019-ncov). URL
https://www.who.int/news-room/detail/. [Online; accessed 18-February2020].
6. Du, Z. et al. Risk of 2019 novel coronavirus importations throughout china prior to the
wuhan quarantine. medRxiv (2020).
7. Sun, K., Chen, J. & Viboud, C. Early epidemiological analysis of the 2019-ncov outbreak
based on a crowdsourced data. medRxiv (2020).
8. Wang, C., Horby, P. W., Hayden, F. G. & Gao, G. F. A novel coronavirus outbreak of global
health concern. The Lancet (2020).
9. Yang, S., Santillana, M. & Kou, S. C. Accurate estimation of influenza epidemics using
google search data via argo. Proceedings of the National Academy of Sciences 112, 14473–
14478 (2015).
10. Santillana, M. et al. Combining search, social media, and traditional data sources to improve influenza surveillance. PLoS computational biology 11 (2015).
11. Lu, F. S., Hattab, M. W., Clemente, C. L., Biggerstaff, M. & Santillana, M. Improved statelevel influenza nowcasting in the united states leveraging internet-based data and network
approaches. Nature communications 10, 1–10 (2019).
12. Cleaton, J. M., Viboud, C., Simonsen, L., Hurtado, A. M. & Chowell, G. Characterizing
ebola transmission patterns based on internet news reports. Clinical Infectious Diseases 62,
24–31 (2016).
13. Li, C. et al. Retrospective analysis of the possibility of predicting the covid-19 outbreak
from internet searches and social media data, china, 2020. Eurosurveillance 25, 2000199
(2020).
14. Lipsitch, M. & Santillana, M. Enhancing situational awareness to prevent infectious disease
outbreaks from becoming catastrophic. Curr. Top. Microbiol. Immunol. 424, 59–74.
15. Li, R. et al. Substantial undocumented infection facilitates the rapid dissemination of novel
coronavirus (sars-cov2). Science (2020).
16. Chinazzi, M. et al. The effect of travel restrictions on the spread of the 2019 novel coronavirus (covid-19) outbreak. Science (2020).
17. Lai, S. et al. Effect of non-pharmaceutical interventions for containing the covid-19 outbreak: an observational and modelling study. medRxiv (2020).

16

18. Jung, S.-m. et al. Real-time estimation of the risk of death from novel coronavirus (covid19) infection: Inference using exported cases. Journal of Clinical Medicine 9, 523 (2020).
19. Aiken, E. L. et al. Real-time estimation of disease activity in emerging outbreaks using
internet search information. medRxiv 19010470 (2019).
20. McGough, S. F., Brownstein, J. S., Hawkins, J. B. & Santillana, M. Forecasting zika
incidence in the 2016 latin america outbreak combining traditional disease surveillance
with search, social media, and news report data. PLoS neglected tropical diseases 11,
e0005295 (2017).
21. Poirier, C. et al. Influenza forecasting for the french regions by using ehr, web and climatic
data sources with an ensemble approach argonet. medRxiv 19009795 (2019).
22. Network systems science and advanced computing, baidu mobility data for january, 2020
(2020).
23. Kraemer, M. U. G. et al. The effect of human mobility and control measures on the covid19 epidemic in china. Science (2020).
24. Wu, J. T., Leung, K. & Leung, G. M. Nowcasting and forecasting the potential domestic and
international spread of the 2019-ncov outbreak originating in wuhan, china: a modelling
study. The Lancet (2020).
25. Phan, L. T. et al. Importation and human-to-human transmission of a novel coronavirus in
vietnam. New England Journal of Medicine (2020).
26. Xiaoxuan, L., Qi, W. & Benfu, L. Can search query forecast successfully in china’s 2019ncov pneumonia? medRxiv (2020).
27. Defays, D. An efficient algorithm for a complete link method. The Computer Journal 20,
364–366 (1977).
28. Caliński, T. & Harabasz, J. A dendrite method for cluster analysis. Communications in
Statistics-theory and Methods 3, 1–27 (1974).
29. Santillana, M., Nsoesie, E. O., Mekaru, S. R., Scales, D. & Brownstein, J. S. Using clinicians search query data to monitor influenza epidemics. Clinical infectious diseases: an
official publication of the Infectious Diseases Society of America 59, 1446 (2014).
30. Balcan, D. et al. Modeling the spatial spread of infectious diseases: The global epidemic
and mobility computational model. Journal of computational science 1, 132–145 (2010).
31. Gomes, M. F. et al. Assessing the international spreading risk associated with the 2014
West African Ebola outbreak. PLoS currents 6 (2014).
17

32. Zhang, Q. et al. Spread of Zika virus in the Americas. Proceedings of the National Academy
of Sciences 114, E4334–E4343 (2017).
33. Rambaut, A. Phylogenetic analysis of ncov-2019 genomes (2020). [Online; accessed 05February-2020].
34. Report 3:
Transmissibility of 2019-ncov (2020).
URL https://www.
imperial.ac.uk/mrc-global-infectious-disease-analysis/
news--wuhan-coronavirus. [Online; accessed 05-February-2020].
35. Andersen, K. Estimates of the clock and TMRCA for 2019-nCoV based on 27 genomes
(2020). [Online; accessed 05-February-2020].
36. Bedford T, Neher R, Hadfield J, Hodcroft E, Ilcisin M, Mller N. Genomic analysis of
nCoV spread. Situation report 2020-01-23 (2020). URL https://nextstrain.org/
narratives/ncov/sit-rep/2020-01-23. [Online; accessed 05-February-2020].
37. Sunnker, M. et al. Approximate bayesian computation. PLOS Computational Biology 9
(2013).
38. Niehus, R., De Salazar, P. M., Taylor, A. & Lipsitch, M. Quantifying bias of covid-19
prevalence and severity estimates in wuhan, china that depend on reported cases in international travelers. medRxiv (2020).
39. De Salazar, P. M., Niehus, R., Taylor, A., Buckee, C. O. & Lipsitch, M. Using predicted
imports of 2019-ncov cases to determine locations that may not be identifying all imported
cases. medRxiv (2020).
40. Sun, K., Chen, J. & Viboud, C. Early epidemiological analysis of the coronavirus disease
2019 outbreak based on crowdsourced data: a population-level observational study. The
Lancet Digital Health (2020).
41. Pinotti, F. et al. Lessons learnt from 288 covid-19 international cases: importations over
time, effect of interventions, underdetection of imported cases. medRxiv (2020).

Supplementary
Mobility data correlation
Human mobility data. As an additional source, we collected the daily human mobility (in
terms of percentage) between the Chinese provinces via Baidu. We decided to not include human mobility information as a source of information for our methodology given the absence of
data during February.

18

To investigate the impact of human mobility on new confirmed cases, we performed a similar analysis on Baidu mobility data. Baidu mobility data was obtained from a public available archive (https://doi.org/10.18130/V3/YQLJ5W) (22), which was originally
scraped from (qiangxi.baidu.com) website. The dataset contains daily inbound (i.e.
percentage of people traveling to the city from all the cities in China) and outbound (i.e. percentage of people traveling from the city to all the cities in China) mobility data for all cities
(except Hong Kong, Macau and Taiwan) in China on each day from January 1, 2020 to January
31, 2020.
For this study, we were particularly interested in the relationship between the amount of people
traveling from Wuhan/Hubei to other provinces and the number of new confirmed cases in those
provinces. Given the original data from Baidu is city-level, we first extracted all the outbound
data from Wuhan (which is the capital of Hubei and the first city with confirmed COVID-19
cases) and mapped all the cities belonging to the same province to get province-level outbound
mobility from Wuhan. We obtained a 31x31 matrix, where each row is a province in China, and
each column is one day in January, each element shows the percentage of people traveling out
of Wuhan to the other provinces, among all people traveling from Wuhan on that day.
To understand the similarity of the human mobility from Wuhan among Chinese provinces
and investigate the potential impact of mobility on the confirmed cases of each province, we
calculated the pairwise correlation matrix for the percentage of people traveling from Wuhan
to each province by using the data from January 1, 2020 to January 31, 2020 (see Figure S1).
If the pairwise correlation between the two provinces is high, it indicates that the trend in the
percentage of people traveling from Wuhan to the two provinces are similar. We calculated the
pairwise correlation matrix for new confirmed cases using data from February 1, 2020 to February 21, 2020, and we found that provinces which are geographically closed are not necessarily
clustered together, indicating geographical distance would not be able to explain the similarity
in the new confirmed cases. To further explore the potential impact of mobility on the new confirmed cases of each province, we then calculated the Pearson correlation and cosinus similarity
between the two correlation matrices. To do this, we first converted the two matrices into two
vectors and calculated the correlation between the two vectors. We got Pearson correlation of
0.1473 and cosinus similarity of 0.4729.

19

Figure S1: Visualization of the pairwise correlation matrix of human mobility from Wuhan to
each Chinese province. During the period of January, we can see a similar trend of mobility for
a big cluster of provinces (the mobility matrix has been rearranged in the same province order
than the COVID-19 case counts correlation matrix to facilitate visualization of the similarity).

20

20

10

Qinghai

50

0
50

Zhejiang

Jilin

Hebei

10

Inner Mongolia 5

0
5

Hunan

25
0
25

2020-02-21

10

0

5

20

Heilongjiang
0
20

Hubei

Chongqing
0
50

Liaoning

Shanxi

10

Guangxi

10
0
10

Taiwan

5
0

0

20
2020-02-03

200

Hainan

Beijing

0

Prediction Date

0

0

Hong Kong

5
0
5

100

Ningxia

10000
0
10000

10

Shandong

0

0

5

0

10

20

0

Jiangsu

20

0

50

Tianjin

10

10

0

10

0

0

50

Guizhou

Shaanxi

10

5

Prediction Date

2020-02-21

10

Gansu

10

2020-02-03

0

10

Xinjiang

2.5
0.0
2.5

Henan

50

5

Yunnan

Fujian

10

0

0

ARGONet

0

Guangdong

2020-02-21

Error (Number of Cases)

0

50

0

Error (Number of Cases)

Sichuan

10

0

Augmented ARGONet

2020-02-21

Jiangxi
0

Error (Number of Cases)

Shanghai

20

Baseline

2020-02-03

Anhui

25
0
25

2020-02-03

Error (Number of Cases)

COVID-19 Confirmed Cases

Figure S2: Graphical visualization of the out-of-sample COVID-19 error (ŷ−y) between February 03, 2020, to February 21, 2020.
21

Autoregressive Model
An autoregressive model (AR) was built using only COVID-19 local (in contrast to Augmented
ARGONet’s clustering methodology) historical confirmed case counts from the past three 2-day
reports. Based on this formulation, our 2-day forecast (ŷt+2 ) of COVID-19 confirmed cases is
estimated as follows:
P
yT +δt = 3i=0 αi yT −iδt + T +δt
(2)
where
• yT +δt is the estimate at date T + δt,where δt = 2 days
• yT is the number of cases at date T .
• t ∼ N (0, σ 2 ), residuals
As for Augmented ARGONet, our version of AR was dynamically trained.

22

Baidu search ("coronavirus symptoms")
Baidu search ("fever how many degrees")
1.0 Anhui

Official Province Lockdown
Confirmed Cases (normalized)

Beijing

Chongqing

Fujian

Gansu province

Guangxi Zhuang

Guizhou

Hainan

Hebei

Henan

Hong Kong

Hubei

Hunan

Jiangsu

Jiangxi

Jilin

Liaoning

Ningxia

Qinghai

Shaanxi

Shandong

Shanxi

Sichuan

Taiwan

Tianjin

Xinjiang

Yunnan

Zhejiang

0.5
0.0
1.0 Guangdong
0.5
0.0
1.0 Heilongjiang
0.5
0.0
1.0 Inner Mongolia
0.5
0.0
1.0 Macau
0.5
0.0
1.0 Shanghai
0.5

0.5

3
-02-2
2020

-01-0
2020

1.0 Tibet

5

0.0

3
-02-2
2020

5
-01-0

3

2020

2020

-02-2

5
-01-0

3

2020

-02-2
2020

5
-01-0

3

2020

-02-2
2020

2020

-01-0

5

0.0

Figure S3: Visualization for the evolution of Covid-19 cases (green and orange), and Baidu
search trends (red) in China. All timeseries have been smoothed for visualization purposes.
23

