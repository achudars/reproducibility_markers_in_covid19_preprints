Simulating COVID-19 in a University Environment
Philip T. Gressman1 and Jennifer R. Peck2

arXiv:2006.03175v2 [q-bio.PE] 28 Jun 2020

1

Department of Mathematics, University of Pennsylvania
2
Department of Economics, Swarthmore College
June 30, 2020
Abstract

Residential colleges and universities face unique challenges in providing in-person instruction during the
COVID-19 pandemic. Administrators are currently faced with decisions about whether to open during
the pandemic and what modifications of their normal operations might be necessary to protect students,
faculty and staff. There is little information, however, on what measures are likely to be most effective
and whether existing interventions could contain the spread of an outbreak on campus. We develop a
full-scale stochastic agent-based model to determine whether in-person instruction could safely continue
during the pandemic and evaluate the necessity of various interventions. Simulation results indicate
that large scale randomized testing, contact-tracing, and quarantining are important components of a
successful strategy for containing campus outbreaks. High test specificity is critical for keeping the size
of the quarantine population manageable. Moving the largest classes online is also crucial for controlling
both the size of outbreaks and the number of students in quarantine. Increased residential exposure can
significantly impact the size of an outbreak, but it is likely more important to control non-residential
social exposure among students. Finally, necessarily high quarantine rates even in controlled outbreaks
imply significant absenteeism, indicating a need to plan for remote instruction of quarantined students.
Keywords: COVID-19, coronavirus, SARS-CoV-2, epidemics, computational epidemiology, agentbased modeling, higher education, post-secondary education

1

Introduction

In March of 2020, most American colleges and universities closed to in-person instruction, moving classes
online and sending nearly all residential students home. In the coming fall, as many as 17 million of these
graduate and undergraduate students could return to campuses, over two million of whom would likely
live on campus [30].1 In the midst of the global COVID-19 pandemic, this presents an unprecedented
public health and logistical challenge. At the same time, reopening to in-person instruction is viewed as
extremely important both pedagogically and financially [24]. The experience of many institutions in the
spring reveals that on-campus instruction is important even if it doesn’t all occur in person: there were
widespread reports of students experiencing limited access to computing resources, intermittent internet
access, and even homelessness [29]. In providing these resources, residential colleges facilitate both instruction
and appropriate evaluation of student learning.
Residential universities face a unique challenge in balancing the benefits of on-campus and in-person
instruction with the risks and costs of operating during the pandemic. One the one hand, universities are
extremely constrained in their ability to control the spread of a virus on campus: students, faculty and staff
all have repeated, regular personal interactions in a closed space, and institutions have limited resources to
1 In

2015-2016, 10.8 percent of undergraduates and 27.3 percent of graduate students took all of the courses for their degrees
online [30]. Approximately 16% of U.S. undergraduate postsecondary students live in university-owned housing.

1

test and quarantine students. At the same time, administrators also have an extremely high degree of control
over the parameters of many of these interactions, and can set what students are in which classes, when
those classes meet, and who students interact with in a residential setting. Because of these unique features,
standard epidemiological models are of limited value for assessing the spread of a COVID-19 outbreak on
a college campus and for identifying the tools administrators could most effectively use to minimize the
likelihood and magnitude of such an outbreak. Many residential colleges and universities around the country
and the world are therefore currently facing critical decisions about how to adapt their normal operations to
protect students, faculty, and staff from COVID-19 during the coming academic year. An April 22nd Inside
Higher Ed article [21] lists 15 different possible approaches to the problem, each with clear strengths and
weaknesses. In the absence of relevant prior experience, these institutions are largely in the dark about how
one might expect a COVID-19 outbreak to evolve in the unique environment of a college campus and how
much of an effect the many possible mitigation strategies should be expected to produce.
To address the absence of reliable evidence, we have we have endeavored to create a simulation which is
as realistic as is reasonably possible. Our simulation2 is a full-scale stochastic agent-based model (ABM) of
a reasonably large research university. In it, we are able to study the spread of a highly virulent illness like
COVID-19 and monitor the efficacy of tools like quarantining and contact tracing, mask-wearing policies,
partial transitions to online instruction, and others. Agent-based models such as ours are uniquely well-suited
to the situation we study because behavior of both instructors and students in an academic environment is
highly structured spatially and temporally, which can lead to consistent overestimates of disease incidence
when other tools like structured metapopulation models are used [1]. The modest scale (22,500 total agents)
of a university community also means that concerns about computational complexity of ABMs like ours are
not applicable.
It is important to emphasize that despite the many realistic features we have incorporated, any such
simulation is, by its nature, a fundamentally limited caricature of a complex real-world situation. However,
there are some key lessons that we believe can be reasonably carried over to inform real-world decisions:
• Testing accuracy is a critical issue which needs immediate attention. In an aggressive contacttracing scenario, it is reasonable to expect every positive test result to lead to the quarantining of 10–20
students. In a population with a low infection rate, a high quarantine rate can still result if testing
is not extremely high accuracy. In particular, the most important driver of quarantine population is
the false positive rate of the test. The functional difference between tests with 1% and 0.01% false
positive rates are enormous in the university setting, but none of the existing molecular tests have
been examined closely enough to carefully determine the order of magnitude of the false positive rate.
At least a few have been shown to have rates higher than 1%, which could lead to the unnecessary
quarantining of literally thousands of students over the course of a semester.
• Holding large classes greatly increases the risk of a significant outbreak on campus. Our
simulation finds that all reasonably successful strategies involve moving instruction for large classes
entirely online. In particular, dividing large classes into smaller sections which still physically meet
does not appear to have a strong enough effect to protect students and instructors.
• It is extremely important that students refrain from all contact outside of academic and
residential settings. Even very small rates of contact in large group settings like dining halls or
2 Source

code is available online at https://www.github.com/gressman/covid_university.

2

parties may be sufficient to sustain an outbreak on campus regardless of any other protective measures
which have been put into place.
• All instructors need to prepare for extended student absences due to quarantine. In
our best-case scenario, classes spend an average of 1-2 weeks of the semester with at least 10% of
the students absent due to quarantine. For this reason, we expect that even small classes which
are permitted to meet in person will still need procedures in place for continuity of instruction for
quarantined students.
Our study is a complement to recent work by Weeden and Cornwell on how large enrollment networks
might contribute to the spread of disease on campus [31]. They show that students are highly interconnected
through their courses and argue that the “small world” nature of enrollment networks makes the student
population susceptible to high rates of disease transmission. Removing large courses from the university
network (by moving them online) decreases the connectivity in these networks, but is not by itself enough to
contain outbreaks. Our work examines these enrollment networks with simulated rather than empirical network data, and includes instructor interactions, models residential exposure, and allows for non-residential
exposure. We also include heterogeneity in the amount of contact that students experience with one another
in classes and account for temporal variation as courses meet throughout the week. Incorporating current
best-known immunological and epidemiological parameters also allows us to examine how different intervention measures might complement one another in slowing disease transmission. Because the specific question
about the effect of moving large classes online is so important, we also include a simpler analytical model in
the Appendix which reinforces what we see in our ABM.
The remainder of the paper describes the structure of our ABM and discusses some of its most significant
parameters (Section 2). We then present some key implications for the spread of infection and the size of
the quarantine population corresponding with different control methods (Section 3). Section 4 concludes.

2

Methods

In this section we give a description of the overall structure of our model and highlight several of the more
significant parameters. Our choice of ABM to approach this problem is motivated by several factors. First
and foremost, ABM allows us to incorporate very precise information about contact heterogeneity between
populations (instructors and students) and even among students at different stages of their university careers.
It is well-known that contact heterogeneity can significantly affect dynamics [27, 22] as can temporal contact
structure [28], which are both fundamental features of interaction in a university setting. In situations when
behavior is highly structured, it is known that maintaining the identity of individuals is important [15, 1].
For these reasons, ABMs are uniquely well-suited to small-scale problems such as ours and have already been
used in studies of COVID-19 [23, 6].

2.1

Viral Dynamics

Each individual has a state which reflects their health status: Susceptible (S), Infected (I), or Removed (R).
Infected individuals have refined states which reflect the incubation period they will experience, whether
or not they are symptomatic, and how many days their infection has progressed. Independently of health
status, individuals may also be quarantined; when quarantined it is assumed that susceptible individuals
cannot become infected and infected individuals cannot transmit infection to others.
3

The sequence of events in a simulated day is straightforward:
1. Illness Testing: A predetermined fraction of the population is randomly selected for testing. The
default value is set at 3%, which means that members of the community will be tested approximately
once per month. Anyone who was flagged via contact tracing on the previous day is also tested.
2. Quarantining: Anyone from the Illness Testing step whose test results were positive and any symptomatic infected individuals who develop symptoms on this day are quarantined immediately if not
already quarantined. Additionally, such individuals are flagged to have their recent contacts traced.
3. Status Updates: Individuals who have been quarantined for 14 days are released. If they were susceptible when entering quarantine, they emerge as still susceptible; those who were infected or removed
upon entering quarantine emerge as removed. Similarly, individuals who have been infected for 14 days
are updated to removed (R) status. We note that while there is some evidence to suggest that a small
fraction (∼1%) of infected individuals become symptomatic 14 days or more after infection [16], we
neglect this possibility.
4. Contact Tracing: Every individual who was flagged earlier in the day (due to testing positive or
developing symptoms) has their contacts traced. This includes all of their (non-quarantined) contacts
from the previous two days (not including today, and not including days when the flagged individual
was quarantined).3 These contacts are flagged for testing tomorrow and are quarantined immediately.
The purpose of testing these individuals after they have already been quarantined is to trace their
contacts (after the test on the next day) if the test is positive.
5. Infection Transmission: Non-quarantined susceptible individuals who contact non-quarantined infected
individuals become infected themselves with a probability that depends on the infection state of the
infected. Additional details about the model of transmission dynamics appear below.
6. Outside Transmission: On any particular day, there is a 25% chance that one non-quarantined susceptible individual becomes spontaneously infected due to presumed transmission from non-university
contact. By the state-level standards in the “Process to Reopen Pennsylvania,” this rate is rather low,
roughly 1/3 of the amount which allows transitioning from the most restrictive “Red” phase to the
“Yellow” phase (which corresponds to at most 50 new cases total per 100,000 in a 14-day period). Thus
our default scenario models a relatively low level of transmission outside the university. Whether this
low level can be achieved broadly in the U.S. by late August is a question of growing concern; results
based on higher levels of outside transmission are summarized in Tables 4 and 5 in the Appendix.
The incubation period for each infected individual is fixed to have mean 5.2 days and is randomly assigned
to an individual upon infection. The exact distribution used is a discretized Gamma distribution with shape
parameter k = 4 (details are in Section 5.1.3 of the Appendix). The overall mean of 5.2 days is consistent
with several estimates in the literature [16, 17].
The infectiousness of an infected individual is a function of the time since infection. The serial interval
is based on an estimate of 5.8 days [13] by setting transmission probability, which is the probability that
any one potential transmission contact actually results in infection, to be proportional to probability density
function of a discretized Gamma distribution with mean 5.8 and shape k = 4. Transmission probabilities
3 The choice of two days is consistent with current CDC guidelines (revised May 29, 2020) on the contact elicitation window.
This protocol matches the recommendations of the WHO, European CDC, and Public Health Canada.

4

are unknown parameters, so we calibrate the model in such a way that the basic reproduction number R0
for non-residential contacts roughly matches the most relevant estimates in the literature. In particular,
we normalize transmission probabilities based on expected rates of contact (described in the next section)
so that an infected individual not subject to quarantine would transmit the disease to an average of 3.8
individuals over the course of the illness. In other words, probabilities have been adjusted so that when
residential effects are ignored, the basic reproduction number R0 for the simulation is effectively 3.8. As
with the expected number of contacts, it is important to emphasize that the actual reproduction number
will depend on the circumstances being simulated : as various prevention measures are taken, the value of
R0 decreases relative to a scenario where all contacts are susceptible and no measures are taken to combat
illness. While the earliest analyses of the Wuhan outbreak estimated R0 to be closer to 2.2, subsequent work
tends to point towards somewhat higher values. For example, Sanche et al. estimate R0 to be 5.7 (95% CI:
3.8–8.9) [26] and Flaxman et. al. find a similar value of 3.87 (95% CI: 3.01–4.66) [11]. Given the reasonable
expectation that contact rates on college campuses will be higher than the general population, it is natural
to assume that these higher estimates are more appropriate for the current modeling purposes. This is
consistent with estimates of R0 for influenza outbreaks [2], which tend to be higher in confined settings like
schools, military bases, and ships.4 We have also investigated the stability of our results with respect to
alternate choices of R0 and have summarized the results in Tables 4 and 5 in the Appendix.
Additional features of the dynamical aspects of the simulation are as follows:
• We assume that 75% of those infected have cases which are mild, asymptomatic, or simply unidentified.
These individuals do not spontaneously self-report for quarantine in Step 2 above; they are modeled
as half as infectious as symptomatic counterparts [18].
• There is a global parameter to account for a variety of nonpharmacological interventions (e.g., maskwearing). The default value is chosen to so that transmission probabilities are reduced to 50% of
the values identified above. This decreased transmission is included reflect the expected effects of
universal mask-wearing policies. MacIntyre et al. [20] find that masks in the home reduce transmission
rates to roughly 30% of their otherwise-expected values, but caution against extrapolating their results
to repeat-contact settings such as this one. Because our model explicitly tracks differences between
individual and repeat contacts, it seems reasonable to expect that every individual transmission event
in our setting will see roughly similar benefits to those found in the home.
• We assume that on the first day of classes, 5% of the community has already obtained immunity (and
hence reside in the R state). These individuals are not assumed to be known to the administration,
and consequently are subject to quarantine if they have been identified to have recent contact with an
individual known to be infected.
Each simulation is initialized with zero infected individuals and runs for 100 days.

2.2

False Positive Rate (FPR)

One feature which is critical to the dynamics of quarantine populations is false positive results during the
Illness Testing phase. We assume that the false positive rate (FPR) is 0.1% and the false negative rate is
4 A review of the literature on R estimates for influenza [2] finds generally higher point estimates for R in confined settings
0
0
in all but the 1968 pandemic. Median R0 point estimates in confined settings were 3.82 for the 1918 pandemic and 1.96 for the
2009 pandemic compared with 1.80 and 1.46 in community settings.

5

3.0% in the main analysis. We have endeavored to select these parameters to be consistent with what is
possible with existing tests [9]. Tables 6 and 7 also show results for a wide range of values of the FPR and
FNR; there is additional discussion of the FPR in Section 3. One can see from the tables that outcomes do
not depend sensitively on the FNR but can vary by orders of magnitude under different values of the FPR.
It is extremely difficult to identify a reasonable value for the FPR given the current data on available
tests. The clinical evaluations reported in Emergency Use Authorizations (EUAs) for many molecular tests
currently approved by the FDA involve testing only 30 negative reference samples. This sample size is too
small to guarantee an FPR of much below 3%, which in our simulation leads to catastrophically high rates
of quarantine. At the same time, however, very high specificity (i.e., a lower FPR) is not ruled out by the
absence of testing. To arrive at a reasonable order of magnitude, we consulted results from the Foundation
for Innovative New Diagnostics, which established an average clinical specificity of 99.4% for a number of
the most widely-used molecular tests [12]; these results are considered tentative, as it is perhaps possible
that they are a function of improperly defined negative reference standards (i.e., the level at which a result
is considered negative) rather than true false positives. We also reviewed 61 EUAs approved by the FDA
for molecular tests and found six that reported false positive test results with small sample sizes (∼30) [10].
Thus it may be reasonable to expect that a realistic FPR may be on the order of 0.3%–0.6%. Scholarly work
on the FPR of COVID-19 testing is extremely rare, but once source makes a conservative estimate of the
FPR at 0.8% based on external quality assessments of similar assays [7].
A simple calculation illustrates a serious problem with this FPR: in a community of 22,500 people, 3%
daily testing means conducting 675 tests per day. A false positive rate of 0.8% means that an average of 5.4
tests per day will result in false positives assuming that the prevalence of true infections is small or zero. In
isolation this is a modest number; however, when combined with contact tracing, 5.4 false positives per day is
clearly infeasibly high when one considers that 10–20 individuals will be quarantined for each (falsely) positive
individual. This means that a university that is entirely disease-free would send 54–108 people per day into
quarantine. If individuals are kept in quarantine for 14 days, this means a peak quarantine population would
be 750–1,500 in quarantine at any given moment (about 3%–7% of the university population). Over the
course of the semester, 5,000–10,000 individuals would be sent into quarantine at one point or another, which
is 22%–44% of the population, even in the absence of any true infections.
In short, a naive approach to mass testing in a university environment can be reasonably expected to
quickly lead to a crisis of over-quarantining. The good news is that such a scenario is entirely avoidable with
proper planning. By developing testing protocols under which (for example) positive samples are always
retested, the FPR can be effectively lowered to a more sensible level. Pooling samples may also allow for
reasonable retesting strategies at minimal cost. As the benefit of such protocols so vastly outweighs this
cost, we assume that reasonable institutions will do so and set the FPR for the testing protocol in our main
simulation to 0.1%.
The selection of a FNR of 3% is also consistent with values reported in many EUAs. When the overall
prevalence is illness is low, we find that the disease and quarantine dynamics are not significantly affected by
substantial variation of this parameter (see the Appendix): when the total number of infected individuals is
below 100 for the entire semester (as it is in a number of scenarios we model), the number of false negative
results encountered is correspondingly small–only 2 or 3 total in a semester. This is vastly different than the
case of the FPR when thousands of true negative tests can lead to hundreds of false positive results.

6

2.3

Contact Patterns

Every run of the simulation consists of 20, 000 students and 2, 500 instructors who interact daily for 100
days. Every day, simulated individuals experience contacts with each other, and these contacts are the basis
for both disease transmission and the mitigation strategy of contact tracing. We allow for contacts to be
asymmetric (so that the likelihood of transmission from person a to person b need not necessarily be the
same as the likelihood of transmission in the reverse direction) but in almost all situations we model both
directions of transmission as equally likely. We also categorize contacts as traceable or nontraceable. This
latter category is meant to model contacts which are incidental or otherwise not sufficiently memorable to
be recalled upon reflection.
There are two main sorts of contacts in the simulation. The most common sort of contact is Poisson
contact, generated by a Poisson point process whose rate is determined by a detailed scoring system which
takes into account whether the two individuals have any common activities on a given day and the nature
of their roles in those activities (e.g., a student and an instructor in a class will have a higher rate of contact
than two random students in the same class, but lower than the rate of contact of two friends in the class).
Activities include classes, recitations, department memberships, and friendships (which are formed at the
beginning of the simulation between smaller groups of individuals within larger classes, recitations, and
departments). These contacts model a wide variety of possible scenarios that one might encounter in a
university setting. Details can be found in Section 5.1.2 of the Appendix. In particular, there are several
key “scales” on which contacts occur: a close contact scale which captures interactions like friendships and
nearest classmates in a classroom, a classroom scale which includes all individuals in a room at the time of
class, environmental contacts that occur around physical presence in a building or department (like shared
elevators or hallways), and broad environmental contacts which can occasionally occur between any two
individuals on campus. We model contacts on each of these four scales as roughly equally likely to occur,
and consider the close contact and classroom scale contacts to be traceable and the department and broad
environmental contact scales to be nontraceable. For convenience, we refer to all the forms of contact above
as “academic contacts” to emphasize that they are all heavily influenced by the overall rate of in-person (as
opposed to online) academic activity. We also include a category of broad social contacts within the Poisson
contact system to capture contacts at a large social scale which are not directly tied to the acts of going to
or from classes.
The second type of contact is residential contact, which is guaranteed to occur every day. Residential
contacts are de facto stronger than other contacts in the sense that transmission in both directions is always
allowed (whereas under normal circumstances there is effectively only a 50% chance of a particular direction
of transmission being allowed for a Poisson contact.) As a robustness check, we constructed two distinct
models of residential contacts: a “discrete” model in which students are assembled into permanent, small
residential groups of fixed size, and a “linear” model in which students are effectively arranged in linear
dormitories and have permanent contact with small numbers of adjacent students. Both models gave very
similar results, so we have adopted the linear model as standard. We assume under normal circumstances
that students have an average of 1 residential contact, which means that the typical residential arrangement
is that students are housed in pairs (i.e., an average student has one daily residential contact with some
other student). We also test the effects of increasing the number of these types of residential (and other)
contacts.
It is important to emphasize that the average daily number of contacts for a simulated individual is a
function of many factors and is not an adjustable parameter. Our contact system is normalized to yield an

7

average of approximately 11 traceable and 8 nontraceable contacts per person per day when all classes are
meeting physically and no social distancing is being exercised. This is consistent with a number of surveys of
the general public which found that participants’ self-reported average daily contacts fell in the range of 10
to 14 per day [14, 32]. Determining a realistic rate for nontraceable contacts is a bit more challenging, but
we note that under our normalization, the attack rate in a residential setting (i.e., the rate of transmission to
individuals contacted every day) is 32.9%, which is similar to the observed secondary attack rate to spouses
in a household setting [19]. We examine the sensitivity of the results to the total number of daily contacts
in Tables 2 and 3 in the Appendix. We emphasize that the average student in our simulation has at least
one class in common with 244 others on average, so the contact process necessarily assumes that it is rather
unlikely that a student will experience contact with any particular one of those individuals on any given day.
The number of courses is variable but is 3, 750 in expectation. Very large classes with more than 150
students are split roughly evenly into sections. Classes are independently randomly scheduled as Monday,
Wednesday, Friday (40%), Tuesday-Thursday (40%), or Monday-Wednesday (20%). Classes of more than 50
students are also assigned teaching assistants who run additional once-per-week recitations with 20 students
at once. Each assistant is also a student; any student who is not taking the given course or any other course
of lower difficulty is eligible to be an assistant, and assistants are limited to be responsible for at most 80
students. Recitations meet only one day per week, and never on the day that the corresponding lecture is
held.
Students are evenly distributed into 8 large cohorts. An individual’s cohort affects the probability that
they will enroll in a particular course, with students in cohort 0 (corresponding to freshmen) being most likely
to select courses of lowest difficulty and students in cohort 7 (roughly, advanced graduate students) being
most likely to select courses of highest difficulty. Each student enrolls in either 4 or 5 courses (with both being
equally likely) The precise distributions for course preferences were designed in an ad hoc way to generate
a distribution of class sizes which is consistent with reported data at the University of Pennsylvania. The
distribution of class sizes for a typical randomly-generated university are summarized in Figure 1. Additional
implementation details are given in Section 5.1.1 of the Appendix. We also note a few important statistical
features of our simulated contact process which are similar to the values found in the actual academic
enrollment network at Cornell as reported in [31]:
• The mean class size in our simulated university is 24.
• Roughly 90% of classes have 50 or fewer students.
• The graph-theoretic properties of our simulated university also closely mirror real-world data: students
are, on average, connected 1.2% of the entire student body through common courses (i.e., the average
student has a common classmate with 244 others). The collection of classmates-of-classmates for an
average student includes nearly half the student body (i.e., the average student is connected to 50.0%
of all others via a 1- or 2-edge path), and by the next step, 99.2% of the student body can be reached
via a path of length at most 3. There are, on average, 2.5 “degrees of separation” between a typical
pair of students (i.e., the average geodesic distance in the classmates graph is approximately 2.5).
Within each class with at least 5 students, it is assumed that students make smaller friend groups (the
so-called “close contact” scale from the previous section) with size that scales like the square root of the
overall class size (e.g., a class of 100 students would be subdivided into roughly 10 social groups of 10 students
each). This is meant to reflect natural social tendencies of students and to reflect the fact that students tend

8

40%
30%

35.5%
29.2%

20%

15.3%

10%

6.2%

8.1%
3.3%

1.9%

0.6%

100-199

200+

0%
2-9

10-19

20-29

30-39

40-49

50-99

Figure 1: Distribution of class sizes (before splitting very large classes into smaller sections) averaged over 100
randomly-generated universities. Here the proportion indicates the fraction of all ∼3,750 courses which fall
into the given size bin. The largest class in the university has approximately 800 students before subdivision.
to arrange themselves in the classroom in similar ways from day to day, so that contacts inside a classroom
environment are unlikely to be uniformly random. Friends are most likely to meet on the days when their
common activity is in session, but still have a smaller but positive rate of contact on other days as well.
Classes are also randomly assigned to one of 120 departments with frequency which is exponentially
decaying, so that the largest department is expected to be ten times the size of the smallest department in
terms of the number of courses offered. Once classes are assigned to departments, instructors are assigned
to departments in proportion to the number of classes taught by each department (very small departments
are guaranteed at least one instructor). Instructors within the same department have additional positive
contributions to their Poisson contact rates during the week but not during the weekend. As with students,
instructors also form friendships within their department.

3

Results

As a small validation of the model, we analyzed the early-phase doubling period for uncontrolled growth
when no intervention scenarios are applied. Specifically, we compute the doubling period for cumulative
infections over the range of days beginning with the first infection and ending on the day when at least
2000 individuals have been infected (note: all 500 simulated runs exceeded 2000 infected individuals). We
found that the median early-phase doubling period for our model was 2.185 days, with 50% of simulations
falling between 2.004 and 2.365 days. The observed doubling period of cases in the United States between
March 1 and March 31 was 2.53 days [5]. It is reasonable to expect the doubling period within an American
university to be somewhat shorter than was observed in the general population. To develop a sense of what
realistically short doubling periods might be, we observe that data from Quebec’s Federal Training Centre
prison showed a doubling period of approximately 1.94 days between April 10 and April 21 [3].
Our two main outcome variables are the total number of people infected and the peak number of students
in quarantine during the semester. These two outcomes summarize the risk to the campus community from
the disease and the costs and academic disruption involved in having students in quarantine on campus.
Our baseline level of intervention (the “standard intervention”5 ) consists of the combination of quarantine
5 We have constructed the standard intervention as a tool to study the most widely-discussed and broadly-applicable oncampus infection mitigation strategies, but we note that there are many other potential strategies which institutions might
develop around their own needs and capabilities. One such interesting idea is the formation of smaller, separated academic

9

and contact tracing, universal mask-wearing, daily randomized testing of 3% of the university community,
and transitioning all classes with 30 or more students to online-only interaction6 . As part of the online
transition, we model the social distancing which is afforded by moving smaller classes into the physical
classrooms vacated by larger classes which have moved online. It’s worth noting that there are two main
classes of intervention: those that reduce both infections and quarantine (mask-wearing, social distancing,
transitioning large classes) and those that reduce infections but increase quarantine (quarantine and contacttracing, randomized testing). Increasing testing accuracy (reducing the FPR) would be expected to reduce
quarantine without significantly affecting infections.

3.1

Overview of Control Measures

Although implementing the standard intervention is costly, it is also crucial for controlling disease outbreaks.
In the absence of any intervention, all scenarios end with effectively all susceptible community members
developing COVID-19 by the end of the semester, with peak infection rates reached between 20 and 40
days into the semester (Figure 2). In contrast, the standard intervention avoids the epidemic tipping point
altogether (i.e., R0 remains well below 1) and keeps cumulative infections below 66 in more than 95% of
simulations.7 As we discuss later, the results are sensitive to the rates of social contact among students:
increasing expected broad social contacts from 2 per day (as in panel (b)) to 17 per day (as in panel (c))
increases the median cumulative number of infections from 44 to 461 even with the full standard intervention.
Which measures in the standard intervention are the most important? To control infections, the online
transition for classes with more than 30 students is very effective: allowing in-person meetings of large
classes increases infections from 43 to 538 in the median simulation run (Figure 3). Requiring masks is
moderately important: not requiring masks increases median infections to 131. Random testing and contact
tracing have the lowest individual impacts, and removing either of these measures (while keeping all others)
increases median infections to 50 and 47, respectively.8 The effect of moving classes into larger spaces (social
distancing) is also small; failing to capitalize on this opportunity raises the median infection total to 48.5.9
The standard intervention results in a median peak quarantine level of 150. In-person large class meetings
drastically increase this number both by increasing the number of infections and increasing the number of
students exposed to each positive case: 1,815 students are in quarantine at peak. Removing contact tracing
and random testing all reduce this number (to 20 and 50) at the cost of increasing the cumulative number
of infections. Not requiring masks nearly doubles the peak number of quarantined students to 272. To
emphasize the challenge these numbers represent, let us also note that in the standard intervention, the
median number of unique individuals quarantined at some point during the semester is 602, which means
that even in this full-strength mitigation scenario, it often happens that 3% of all students spend some
fraction of the semester in quarantine.
As noted in Section 2.1, we find that the false positive rate has a very large effect on the peak quarantine
size. Table 7 in the Appendix, for example, shows that a FPR of 2% can increase the median peak quarantine
cohorts [25], which may be able to capitalize on the structure of social networks to limit disease spread [4].
6 We investigated several other possible interventions, including dividing large classes into many smaller sections and/or
bringing only certain cohorts of students back to campus. These alternatives were found to be far less effective than moving
large classes online, so we will not focus on them here.
7 Regular flatter portions of the graph indicate weekends: new infections are largest during the week when classes are in
session. We note that others have observed that weekends play a critical social distancing role in reducing influenza spread [8].
8 We note, however, that although random testing has only a small direct effect on reducing infections it may be essential
for monitoring and responding to the prevalence of the disease on campus.
9 Infection and quarantine rates for additional intervention bundles are reported in the robustness checks in Appendex Tables
2 and 3.

10

20000

60

17500

50
Cumulative Infected

Cumulative Infected

15000
12500
10000
7500
5000

40
30
20
10

2500
0
0

20

40

Day

60

80

0

100

0

(a) No Intervention

20

40

Day

60

80

100

(b) Standard Intervention

800
700
Cumulative Infected

600
500
400
300
200
100
0
0

20

40

Day

60

80

100

(c) Standard Intervention with High Social Contact

Figure 2: Cumulative infections over a 100-day semester. The black curve is the median daily value for
500 independent runs of the simulation and the dark and light regions indicate quantiles around the median
containing 50% and 90% of outcomes, respectively. Under no intervention the median cumulative number
of new infections reaches 20,126 (falling between 20,026 and 20,212 in 90% of simulations), or 89.4% of the
total campus population.
size from 150 to 1,443. Given the uncertainty around what constitutes a realistic FPR, we also simulated
a “high accuracy” testing regime in which the FPR is set to 10−6 and the false negative rate is set to 6%.
This corresponds roughly to a policy of mandatory retesting of every positive result and a presumption of
negativity when the second test is negative. Even with the increased false negative rate, the change to high
accuracy testing has only a minor effect on total infections (the median is 45 instead of 43). The main
difference is a more than twofold reduction in the number of students in quarantine: median peak is lowered
from 150 to 66. The effect on the total number of individuals quarantined is even more dramatic: the median
number of unique individuals experiencing quarantine drops from 602 in the standard intervention to 178
with high accuracy testing.
We also examine the sensitivity of these results to increasing the rates of different types of social inter-

11

(a) Total Infections

(b) Peak Quarantine Population

Figure 3: Median number of total community members infected over the course of the semester and peak
number of students in quarantine by intervention bundle, plotted on a log scale. Bars indicate quantiles
around the median containing 50% and 90% of outcomes, respectively.
actions. We increased interaction rates for academic interactions (in and around the classroom), residential,
and broad social contacts to simulate an additional 5, 10, or 15 contacts per day. (In the case of academic
contacts, we note that the standard intervention leads to only some fraction of these additional contacts
actually occurring). Table 1 summarizes the new levels of cumulative total infected and peak quarantine
size under these different scenarios.
Cumulative Total Infected
Extra Contacts/Day
+5
+10
+15
Academic
50
60
71.5
Residential
89.5 163.5
279
Broad Social
72
162
461

Peak Quarantine Size
Extra Contacts/Day
+5
+10
+15
Academic
168
197
227
Residential
334
621 1059.5
Broad Social 408.5 964 2587.5

Table 1: Effect of increased rates of contact on cumulative total infected (left) and peak quarantine size
(right).
Our model is relatively insensitive to additional academic contacts; an additional 15 academic contacts
per day almost doubles the overall rate of academic contact but does not double the total number of infected
individuals or the peak quarantine size. On the other hand, an increase of 5 additional residential contacts
raises the total number of infections to 89.5, which is more than double the default level of 43. Peak
quarantine size is also more than doubled. Increasing broad social contacts by 5 per day has a slightly
weaker effect on total infections than does the corresponding increase for residential contacts, but peak
quarantine size increases to 476, which is 272% of the default level. Thus there is a clear difference in our
model between the risk involved with additional academic versus non-academic contact, and it is the latter
which has stronger undesirable consequences. Between residential and broad social contacts, the comparison
is more difficult, but as the number grows larger, broad social contacts become clearly more problematic than
residential contacts. This is likely due to the fact that residential contacts are far more compartmentalized

12

than broad social contacts, which places stronger limits on the overall rate of transmission that can occur
exclusively within the residential contact network. Because residential contacts are a closer form of contact
than broad social contact, it further seems relatively unlikely that real-world students would be able to form
very close residential contacts with 10 or more individuals, while it would be rather easy to come into regular
broad social contact with much larger numbers of people through extracurricular activities and social events.

3.2

Moving Large Classes Online

A key component of managing both infection rates and quarantine peak is to move the largest classes
online. Our baseline standard intervention scenario moves all classes with more than 30 students online;
this represents approximately 20% of the classes in our modeled university (Figure 1). This intervention
is highly effective and presents important tradeoffs. Teaching effectively online is more costly in terms of
course preparation and potentially less appealing to students. Limiting large classes also drastically reduces
infection rates by reducing the number of students exposed to an infected individual and reduces quarantine
rates by reducing the number of students identified for quarantine via contact tracing in response to a positive
test. Large classes are also more dangerous for instructional staff. Moving large classes online has the added
benefit of facilitating social distancing measures in existing classes by making larger capacity classrooms
available for smaller classes.

2500
2000

600

Peak Quarantined

Total Infected

800

400
200
0

1500
1000
500

20

40

60
80
100
120
Maximum In-person Class Size

0

140

20

40

60
80
100
120
Maximum In-person Class Size

140

(b) Peak Quarantine Population

(a) Total Infections

Figure 4: Total infections and peak quarantine population as a function of the online class size threshold.
The black curve is the median value for 500 independent runs of the simulation and the dark and light
regions indicate the 50% and 90% quantiles, respectively.
How sensitive are our outcomes to the threshold for moving to online instruction? Figure 4 shows the
response of both the infection count and peak quarantine to changes in the in-person class size cap. These
figures show that eliminating the largest classes is crucially important: allowing all classes to meet in person
increases the median number of infections from 43 to 527 and the median peak quarantine from 150 to 1,813.
In 5% of simulations, the peak number of students in quarantine reaches 2,697 and 893 people are infected
by the end of the semester. The responses to class size are very nonlinear: relaxing the cap at 30 leads
to only mild growth in infection and quarantine, while increasing beyond 100 leads to larger growth, and
increasing beyond 120 rapidly expands the magnitude of the outbreak. The exact threshold at which this
13

rapid escalation occurs is, of course, a function of the other interventions in place (3% daily random testing,
contact tracing and quarantine, and mask wearing) and should not be expected to persist in all or even
most real-world environments. However, there does appear to be a general principle at work here, which
is that although the connectivity of the academic network graph is still high, the number of transmission
opportunities is greatly diminished: with no online transition, students are classmates with an average of
1.2% of the student body, and when classes of 30 and greater transition online, the proportion drops to only
0.2%. This roughly means that more than 80% of the edges in the graph connecting students result from
the largest 20% of classes. Such a drop does not in and of itself guarantee successful containment, but in our
model combines with the other interventions to result in a decrease of the median reproduction number from
1.125 in the uncapped case (which is technically uncontrolled, but close enough to 1 that exponential growth
is difficult to detect on the span of 100 days) down to 0.44, which is safely outside the range of uncontrolled
exponential growth.
The class size cap also has a significant impact on the viability of courses as the semester progresses.
Figure 5 plots the number of days in which more than 10% of students in an average class are quarantined
as a function of the online class size threshold. This reflects a heightened likelihood that a substantial
number of classes have a practically meaningful number of students absent due to quarantine. This follows
the pattern of the number of students in quarantine: there is prevalent absenteeism for about 5.5 days on
average when classes are capped at 100 students, with this increasing to about 10.5 days for the top 5%
most extreme simulations. Capping class size at 150 leads to an expected 22 days of significant absenteeism,
with the top 5% of simulation runs resulting in more than five weeks of widespread absence. This presents
a significant challenge for large, in-person classes: holding large 100+ student classes in person does not
resolve the problem that those classes spend weeks of the semester with at least 10 students in quarantine
and in need of remote instruction. Planning for this by offering large classes online has the added benefit of
decreasing absenteeism in smaller classes as well.

Days with 10% Students Quarantined

35
30
25
20
15
10
5
0

20

40

60
80
100
120
Maximum In-person Class Size

140

Figure 5: Number of days that an average class experiences ≥ 10% of students in quarantine as a function
of the online class size threshold. The black curve is the median value for 500 independent runs of the
simulation and the dark and light regions indicate the 50% and 90% quantiles, respectively.
Finally, while we have chosen our parameter values (number of daily contacts, R0 , external infection
rates, FPR and FNR) to be as realistic as possible, it is important to examine how our results vary with

14

these inputs. These results are discussed in more detail in the Appendix, but broadly indicate that the
standard intervention is relatively effective across a range of parameter values. Infections and quarantine
remain manageable (less than 200 infections and 300 in quarantine) under the standard intervention as long
as daily contacts are less than 31.5 (baseline of 19) and the expected number of external infections is less
than 1.0 or 2.0 per day (baseline of 0.25) (Tables 2, 3, 4, and 5). These external infection rates reflect a
scenario where the spread of coronavirus regionally is well under control: a local outbreak of the virus will be
reflected in highly elevated infection and quarantine numbers on campus. The standard intervention bundle
is extremely robust to all reasonable values of R0 : predicted infections and number quarantined reach a peak
of 73 and 193 respectively when R0 is raised from 3.8 to 5.8. Outcomes under less rigorous intervention
bundles are much more sensitive to increases in these parameters. The total number of infected is largely
insensitive to changes in testing accuracy (both the FPR and the FNR), while quarantine grows very quickly
with the FPR (but not the FNR).

4

Conclusion

The control of the spread of the novel coronavirus on campus is a critical challenge for colleges and universities
planning to open for in-person instruction in the fall. Our agent-based model of the spread and containment
of this disease on campus is an effort to be as realistic as possible: engaging the current state of the
epidemiological understanding of this illness as well as capturing some of the idiosyncrasies of the residential
university setting. We are able to model behavior that is highly structured and fully individualized using a
relatively manageable number of agents. This allows our model to more accurately capture disease dynamics
than a traditional compartmental model. We find important implications for the impact of different control
measures on both the spread of the disease and on the disruption of academic life. Our results suggest that
it is important to have a robust portfolio of interventions, and that universities should be keenly focused on
the specificity of their testing regime. Moving the largest classes online is an effective tool in the arsenal to
stop the spread of the disease and to minimize the disruption caused by quarantining potentially exposed
students. We also find significant differences between the risks involved with academic and other types of
regular contact, with spread through broad social contact representing being more dangerous than residential
contact in the extreme of many additional contacts.
There are several important limitations of our analysis. First, we have not included seasonal effects
in transmission patterns or the arrival of infections from off-campus. These effects may require additional
control measures and have motivated several universities to shorten their semester to avoid extending into
December. To gain some very basic understanding of the potential magnitude of the challenge this may
present, we have included results in Tables 4 and 5 in the Appendix which suggest that the total number
of those infected and the peak quarantine size depend linearly on the rate of infections from outside the
university. There may also be additional unmodeled heterogeneity in the intensity of contact between
students in different types of class settings: interactions in large lectures, small seminars, and labs may yield
different transmission rates between students. Some students may also opt to continue their instruction
remotely (e.g., due to travel restrictions), which will further decrease on-campus transmission for a given
enrollment. Finally, we have not accounted for the fact that compliance with mask-wearing policies will
likely be diminished in residential settings and social settings; our modeling leads us to believe that that this
will lead to modest increases in infection and quarantine rates.
Although we include instructors in this model, their off-campus behavior and infection risk is largely

15

unmodeled. In the standard intervention, we find that a median of only 5 instructors are infected during
the semester, so the effect of additional within-university interactions (between faculty and staff or administration, for example) may ultimately be a more significant risk to faculty than direct faculty-student
interactions. Faculty and staff may also be exposed to the disease through their social and residential contacts: in an urban setting, for example, public transit may be a particularly significant risk to faculty and
staff and may indirectly lead to more student infections as well.
Finally, this model has limited applicability to other types of university settings, such as partial-residential
and non-residential campuses. Small colleges may be importantly different than the university modeled here
in that large classes are less common (and smaller) and that social networks may differ in ways that affect
disease spread. Liberal arts colleges seem to present an especially difficult challenge since daily academic
contacts would be much fewer (in a way that should be relatively easy to model) but of a sort more likely
to transmit infection (which would be a more difficult feature to reasonably quantify or calibrate without
additional data). Nonetheless, many of the main observations are likely to generalize well: increasing testing
accuracy, limiting large classes, minimizing non-residential social contacts and preparing to accommodate
unpredictable absences are likely to be useful across many contexts.

References
[1] M. Ajelli, B. Gonçalves, D. Balcan, V. Colizza, H. Hu, J. Ramasco, S. Merler, and
A. Vespignani, Comparing large-scale computational approaches to epidemic modeling: Agent-based
versus structured metapopulation models, BMC Infectious Diseases, 10 (2010). DOI: 10.1186/1471-233410-190.
[2] M. Biggerstaff, S. Cauchemez, C. Reed, M. Gambhir, and L. Finelli, Estimates of the reproduction number for seasonal, pandemic, and zoonotic influenza: a systematic review of the literature,
BMC Infectious Diseases, 14 (2014). DOI: 10.1186/1471-2334-14-480.
[3] A. Blair, A. Parnia, and A. Siddiqi, Testing lags and emerging COVID-19 outbreaks in federal
penitentiaries in Canada. DOI: 10.1101/2020.05.02.20086314, 2020.
[4] P. Block, M. Hoffman, I. J. Raabe, et al., Social network-based distancing strategies to flatten
the covid-19 curve in a post-lockdown world, Nature Human Behavior, 4 (2020), pp. 588–596. DOI:
10.1038/s41562-020-0898-6.
[5] CDC, Cases in the U.S. <https://www.cdc.gov/coronavirus/2019-ncov/cases-updates/casesin-us.html>, accessed 2020-5-19.
[6] S. L. Chang, N. Harding, C. Zachreson, O. M. Cliff, and M. Prokopenko, Modelling transmission and control of the COVID-19 pandemic in Australia. arXiv:2003.10218, 2020.
[7] A. N. Cohen and B. Kessel, False positives in reverse transcription PCR testing for SARS-CoV-2.
DOI: 10.1101/2020.04.26.20080911, 2020.
[8] P. C. Cooley, S. M. Bartsch, S. T. Brown, W. D. Wheaton, D. K. Wagener, and B. Y.
Lee, Weekends as social distancing and their effect on the spread of influenza, Computational and
Mathematical Organization Theory, 22 (2016), pp. 71–87. DOI: 10.1007/s10588-015-9198-5.

16

[9] V. M. Corman, O. Landt, M. Kaiser, R. Molenkamp, A. Meijer, D. K. Chu, T. Bleicker,
S. Brünink, J. Schneider, M. L. Schmidt, et al., Detection of 2019 novel coronavirus (2019nCoV) by real-time RT-PCR, Euro Serveill., 25 (2020). DOI: 10.2807/1560-7917.ES.2020.25.3.2000045.
[10] FDA, Emergency use authorizations.

<https://www.fda.gov/medical-devices/emergency-

situations-medical-devices/emergency-use-authorizations#covid19ivd>, accessed 2020-5-18.
[11] S. Flaxman, S. Mishra, A. Gandy, et al., Estimating the number of infections and the impact
of nonpharmaceutical interventions on COVID-19 in 11 European countries, Imperial College London,
(2020). DOI: 10.25561/77731.
[12] Foundation for Innovative New Diagnostics, SARS-COV-2 molecular assay evaluation: Results.
<https://www.finddx.org/covid-19/sarscov2-eval-molecular/molecular-eval-results/>, accessed 2020-4-29.
[13] X. He, E. H. Y. Lau, P. Wu, et al., Temporal dynamics in viral shedding and transmissibility of
COVID-19, Nature Medicine, 26 (2020), pp. 672–675. DOI: 10.1038/s41591-020-0869-5.
[14] C. I. Jarvis, K. V. Zandvoort, A. Gimma, K. Prem, et al., Quantifying the impact
of physical distance measures on the transmission of COVID-19 in the UK.

medRxiv, DOI:

10.1101/2020.03.31.20049023, 2020.
[15] M. J. Keeling, L. Dannon, M. C. Vernon, and T. A. House, Individual identity
and movement networks for disease metapopulations, PNAS, 107 (2010), pp. 8866–8870.

DOI:

10.1073/pnas.1000416107.
[16] S. A. Lauer, K. H. Grantz, Q. Bi, F. K. Jones, Q. Zheng, H. R. Meredith, A. Azman,
N. G. Riech, and J. Lessler, The incubation period of coronavirus disease 2019 (COVID-19) from
publicly reported confirmed cases: Estimation and application, Annals of Internal Medicine, (2020). DOI:
10.7326/M20-0504.
[17] Q. Li, X. Guan, P. Wu, X. Wang, L. Zhou, Y. Tong, R. Ren, K. S. Leung, E. H. Lau,
J. Y. Wong, X. Xing, N. Xiang, et al., Early transmission dynamics in Wuhan, China, of novel
coronavirus-infected pneumonia, The New England Journal of Medicine, 382 (2020), pp. 1199–1207.
DOI: 10.1056/NEJMoa2001316.
[18] R. Li, S. Pei, B. Chen, Y. Song, T. Zhang, W. Yang, and J. Shaman, Substantial undocumented
infection facilitates the rapid dissemination of novel coronavirus (SARS-CoV-2), Science, 368 (2020),
pp. 489–493. DOI: 10.1126/science.abb3221.
[19] W. Li, B. Zhang, J. Lu, S. Liu, Z. Chang, P. Cao, X. Liu, P. Zhang, Y. Ling, K. Tao, and
J. Chen, The characteristics of household transmission of COVID-19, Clinical Infectious Diseases,
(2020). DOI: 10.1093/cid/ciaa450.
[20] C. R. MacIntyre, S. Cauchemez, D. E. Dwyer, H. Seale, et al., Face mask use and control of respiratory virus transmission in households, Emerging Infectious Diseases, 15 (2009). DOI:
10.3201/eid1502.081167.
[21] E. J. Maloney and J. Kim, 15 fall scenarios.

https://www.insidehighered.com/digital-

learning/blogs/learning-innovation/15-fall-scenarios, Accessed 2020-05-12.
17

[22] S. R. Meakin and M. J. Keeling, Correlations between stochastic epidemics in two interacting
populations, Epidemics, 26 (2019), pp. 58–67. DOI: 10.1016/j.epidem.2018.08.005.
[23] M. A. A. na Zegarra, M. Santana-Cibrian, and J. X. Velasco-Hernandez, Modeling behavioral change and COVID-19 containment in Mexico: A trade-off between lockdown and compliance,
Mathematical Biosciences, 325 (2020). DOI: 10.1016/j.mbs.2020.108370.
[24] C. Paxson, College campuses must reopen in the fall. Here’s how we do it., New York Times, (2020).
April 26, 2020. https://www.nytimes.com/2020/04/26/opinion/coronavirus-colleges-universities.html,
Accessed 2020-05-19.
[25] P. Plavchan, The case for cohorts.

https://www.insidehighered.com/views/2020/06/09/colleges-

should-consider-cohort-approach-help-reopen-fall-more-safely-opinion, Accessed 2020-06-22.
[26] S. Sanche, Y. T. Lin, C. Xu, E. Romerero-Severson, N. Hengartner, and R. Ke, High
contagiousness and rapid spread of severe acute respiratory syndrome coronavirus 2, Emerging Infectious
Diseases, 26 (2020). DOI: 10.3201/eid2607.200282.
[27] L. Sattenspiel and K. Dietz, A structured epidemic model incorporating geographic mobility among
regions, Mathematical Biosciences, 128 (1995), pp. 71–91. DOI: 10.1016/0025-5564(94)00068-b.
[28] H. Seno, An SIS model for the epidemic dynamics with two phases of the human day-to-day activity,
Journal of Mathematical Biology, (2020). DOI: 10.1007/s00285-020-01491-0.
[29] S.

Snyder,

cause

of

the

Homeless

and

coronavirus,

hungry
The

college

Philadelphia

students

will

Inquirer,

face
(2020).

greater

challenges

April

28,

be2020.

https://www.inquirer.com/health/coronavirus/hungry-homeless-college-students-temple-ccpcoronavirus-20200429.html, Accessed 2020-05-19.
[30] T. Snyder, C. de Brey, and S. Dillow, Digest of Education Statistics 2018 (NCES 2020-009),
tech. rep., National Center for Education Statistics, Institute of Education Sciences, U.S. Department
of Education, Washingnton, D.C., 2019.
[31] K. A. Weeden and B. Cornwell, The small world network of college classes: Implications for epidemic spread on a university campus, Sociological Science, (forthcoming). <https://osf.io/j2bgm/>.
[32] J. Zhang, M. Litvinova, Y. Liang, Y. Wang, W. Wang, S. Zhao, Q. Wu, S. Merler, et al.,
Age profile of susceptibility, mixing, and social distancing shape the dynamics of the novel coronavirus
disease 2019 outbreak in China. medRxiv, DOI: 10.1101/2020.03.19.20039107, 2020.

18

5

Appendix

5.1
5.1.1

Additional Model Details
University Structural Modeling

As described in Section 2.3, our goal is to generate simulated course rosters which yield a realistic distribution
of class sizes as summarized in Figure 1. The process used to accomplish this task is as follows:
• From fixed histogram data, we generate a static probability density function for class size. Classes
are assumed to be arranged from largest to smallest, and this ordering is also regarded as an ordering
from less advanced to more advanced. To accelerate the process of generating simulated schedules, we
cluster classes into groups of 5 (by order) to give a total of 750 different groups.
• Students randomly and independently choose 4-5 different course clusters. Once the clusters are
selected, courses are assigned by choosing specific classes within each cluster uniformly at random.
This gives a computationally efficient way to produce the desired marginal distribution of class sizes.
Because the distribution is not uniform, we found that other methods (e.g., drawing from a full list of
3750 and repeating until all 4-5 selections were distinct) resulted in changes to the marginal distribution
which tended to somewhat overrepresent large courses. The advantage of our approach is that the final
marginal distribution of class sizes will simply be proportional to the selection probabilities.
• To account for the differing enrollment behaviors of students in different courses, we construct different
probability densities for each cohort. To keep the marginal distribution fixed, we construct custom
distributions as follows. Let X0 , . . . , X7 be i.i.d. random variables with a fixed distribution on the set
{1, . . . , 750}. From these variables, we let Y0 , . . . , Y7 be the values of X0 , . . . , X7 sorted from smallest
to largest, i.e., Y0 ≤ Y1 ≤ · · · ≤ Y7 and Y0 = Xi0 , . . . , Y7 = Xi7 for i0 , . . . , i7 distinct. When selecting
course groups, students in cohort k choose using the same distribution as Yk . This yields, for example,
a very small but nonzero probability that a course will be simultaneously taken by a student in cohort
0 (freshmen) and another in cohort 7 (advanced graduate students).
• To group students into close contacts/friends, we simply order students in each class of at least 5 by
the order in which they enrolled and form groups of minimal size meeting or exceeding the desired
target size (the square root of the overall size). This yields at most one group in each class which
is significantly smaller than the target and no groups which are significantly larger. Because each
student’s cohort is chosen uniformly at random at the time of enrollment and students choose their
courses independently, the order of students within a single course is effectively uniformly random.
With this method, there is the possibility for correlation of grouping across classes when students have
more than one class in common, which desirable in a model of close social contacts.
5.1.2

Contact Processes

As mentioned earlier, our model has two basic categories of contact which may occur; the first, Poisson
contact, is generated via a Poisson point process. For two individuals, a and b, the process may generate
a contact which allows a to transmit to b (which we denote a → b) or vice versa (b → a). Poisson point
processes also sometimes generate contacts with multiplicity greater than 1, which we interpret to mean that
multiple instances of the same sort of contact occur on the same day; each instance is regarded independently

19

of any others from the perspective of determining whether a susceptible individual becomes infected. To be
clear, any two contacts are generated independently of one another, so that a → b can occur whether or not
b → a occurs. In most cases, each of these two options is as likely as the other, but we do allow for one
exception: within the classroom, we assume that instructors are more likely to transmit to a student than
the student is likely to transmit to them. This is meant to reflect the situation that a professor actively
lecturing for an hour is likely to shed more virus particles than a student is while listening to the lecture.
The rate for a particular contact a → b on any given day is a sum of a number of individual terms
which depend on the activities that a and b have in common. Below we list all the possible contributions.
In each case, the rates described below are all summed to determine the overall rate. If a category does
not apply to a particular pair a, b, the corresponding contribution to the rate for that day is simply zero.
Note that residential contacts are an exception and do not contribute to the Poisson rate; instead, residential
contacts are guaranteed to occur every day and are counted with multiplicity 1 in addition to all the contacts
generated by the point process.
• Poisson Contacts: Academic contacts
There are five subcategories of interactions which are included under the broad heading of Poisson
contacts which are collectively referred to as “academic contacts.”
1. Close Academic Contacts (average 4/day by default with no interventions applied)
– Modeled Behaviors: students regularly sitting near one another in class, occasionally meeting outside of class to work on class activities, making friends in class; instructors having
departmental neighbors or friends
– Mechanics: Classes and recitations of size N ≥ 5 are subdivided into groups of size

√

N ±1 (all

but one group must lie in this range). Students in the same group receive a fixed contribution
to the Poisson rate for their contacts (both a → b and b → a occur at the same rate) on
“active” days when the corresponding class or recitation is in session. On inactive days, the
contribution to the rate is 1/4 the active rate. The rate is never adjusted for social distancing.
√
Likewise, departments of size N are subdivided into groups of size N . Instructors in the
same group experience the active rate on Monday through Friday and experience 0 contact
rate for this contact on weekends.
By default, it is normalized to produce an average of 4 contacts per day for an average
individual under normal circumstances (i.e., a experiences approximately 4 contacts of the
form a → b or b → a for other individuals b). In expectation, half of those contacts involving
persons a and b will be opportunities for a to transmit to b and vice-versa. Contacts from
a Poisson point process occur with multiplicity, so it is also possible for several instances
of a → b to occur in a particular day, and each is treated independently (so that multiple
contacts increase the probability of transmission). For similar reasons, it is also possible for
potential transmissions to occur in either direction a → b or b → a on the same day.
2. Classroom Contacts (average 4/day when combined with Department Professional Contacts below)
– Modeled Behaviors: Classroom interactions
– Mechanics: Each class meets on a recurring schedule which is either MWF (40% of classes),
TTh (40%), or MW (20%). Recitations meet one weekday per week on a day in which the
corresponding section does not meet. On days when the class or recitation is in session,
20

students receive a fixed contribution to their contact rate for each class that they have in
common. For individuals a, b in the classroom, the rate of a → b contacts is proportional to
a product Ia Sb , where Ia = Sa = 1 when a is a student, Ia = 4, Sa = 2 if a is an assistant
attending the section they are assigned to, and Ia = 10, Sa = 5 if a is the instructor of the
class or is the assistant in a recitation.
The rate of contact is also affected by social distancing when available. It is assumed that all
classes, recitations, etc., which are over the online transition threshold vacate a physical room
which can then be claimed for use by a smaller class or recitation. New rooms are assigned
beginning with the largest active classes first and moving to smaller ones. If the class whose
space was vacated (the “vacated class”) had at least 20 students and was strictly more than
50% larger than the active class moving up, the rate of contact in the active class is multplied
by the factor


max{class size, 10}
CSD = min 1,
.
vacated class size
When social distancing is active, an average value of this constant is computed by weighting
classes according to the square of their size. This is called the “crowd reduction factor” and
is used in other instances of social distancing listed below.
When social distancing is enabled, the contact rate in every classroom is also multiplied by
the proportion of nonquarantined students each day contacts are constructed. This feature
models a small amount of additional distancing which is possible when attendance rates are
lower than 100%.
3. Department Professional Contacts
– Modeled Behaviors: Instructors interacting in common departmental areas like mailrooms,
department meetings
– Mechanics: On Mondays through Fridays, all instructors in the same department experience
a fixed rate of contact (equal for a → b and b → a). The rate is fixed to be 8 times the rate
of student-to-student contact in a classroom without social distancing.
4. Department Environmental Contacts (average 4/day by default with no interventions applied)
– Modeled Behaviors: sharing elevators, walking through common hallways, touching surfaces
or doorhandles, eating food at nearby food trucks, etc.
– Mechanics: Every day that an individual (instructor, student, or assistant) travels to any given
department, that individual belongs to a pool associated to that department. If an individual
has multiple appointments in the department, they occur in the pool with a corresponding
multiplicity. Poisson contacts are drawn between pairs of individuals in the pool at a rate
which is proportional to the product of their multiplicities. When social distancing is active,
the rate is also multiplied by the crowd reduction factor from above.
These contacts are assumed to be non-traceable, which means that they are not included in
any contact tracing activities. They do not occur on weekends.
5. Broad Environmental Contacts (average 4/day by default with no interventions applied)
– Modeled Behaviors: interactions on the street going to or from class, contact in local businesses or restaurants, infrequent professional interactions of individuals across departments,
etc.
21

– Mechanics: Every day that an individual has any physical class, they belong to a pool of
individuals active that day. As with department environmental contacts, individuals occur
with multiplicity if they have multiple physical destinations that day. The rate of contact
is proportional to the product of multiplicities, and also to the crowd reduction factor when
social distancing is available. These contacts are non-traceable and do not occur on weekends.
• Poisson Contacts: Broad Social Contacts (average 2/day by default with no interventions applied)
– Modeled Behaviors: Dining halls or restaurants, social events, extracurricular activities
– Mechanics: Any two individuals experience broad social contact on a given day with a rate which
is independent of the individual. The rate of broad social contact is twice as high on the weekends
as it is on weekdays.
• Residential Contacts (by default: each student linked to an average of one other)
– Modeled Behaviors: Students living in residential colleges
– Mechanics: In each cohort of students, individuals are randomly ordered. Each individual is linked
with a random number of predecessors in the cohort, drawn from an exponential distribution
whose mean is 1/2 the desired number of neighbors. Links are considered symmetric, so that
each student is also linked to another 1/2 the desired number of neighbors by symmetry. Note
that links are specifically not transitive, so that it is possible to find long chains for potential
transmission when the number of neighbors is moderately large.
When students a and b are linked residentially, the contacts a → b and b → a are both guaranteed
to occur at least once every day (they can occur more than once if these contacts also arise
from other means). In this sense, a residential contact is a stronger form of contact than either
acadmeic or broad social contacts, more akin to a roommate or a very close neighbor than to
casual friendships (which are closer to broad social contacts).
5.1.3

Discretized Gamma Distribution

We use a discretized Gamma distribution to generate both the incubation period and daily infectiousness for
each infected individual. The Gamma distribution is widely used in connection with COVID modeling [11]
for these parameters; we formulate a discretized version to ensure accuracy in our discrete-time simulation.
We let Γd (k, θ) denote our discretized Gamma distribution of shape k (a positive integer) and scale θ > 1.
The variable takes values in the nonnegative integers and has PDF
P(Γd (k, θ) = n) :=

n · · · (n + k − 2)
(1 − θ−1 )n−1 .
(k − 1)!θk

To see that the probabilities sum to 1, one can simply differentiate the power series expansion for (1 − x)−1

22

a total of k − 1 times and perform a reindexing. Specifically,
(k − 1)!θk = (k − 1)!(1 − (1 − θ−1 ))−k =
=
=

dk−1
dxk−1
∞
X

∞
X
x=1−θ −1

xn =

n=0

∞
X

dk−1
dxk−1

(1 − x)−1
x=1−θ −1

n · · · (n − k + 2)(1 − θ−1 )n−k+1

n=0

(n + k − 2) · · · n(1 − θ−1 )n−1 ,

n=0

where the last line follows by reindexing the sum by sending n to n + k − 2. The lower limit of summation
does not change because the corresponding terms are zero. The mean µ and variance σ 2 of this distribution
satisfy
σ 2 = kθ(θ − 1).

µ = 1 + k(θ − 1),

In the former case, one can quickly establish by writing n = kθ n+k−1
+ 1 − k and then rewriting the sum
kθ
for µ in terms of the sums just computed for shapes k + 1 and k. Likewise, in the latter case, one uses the
identity
n2 = (n + k)(n + k − 1) − (2k − 1)(n + k − 1) + (k − 1)2
and relates the resulting series to the distributions of Γd (k, θ), . . . , Γd (k + 2, θ).

5.2

Robustness Testing

To map the dependence of our result on various parameter choices, we ran a wide array of 50-simulation
batches under various alternate calibrations. In each case, we report the median value (rounded to the nearest
whole number) for that calibration under various combinations of interventions. To simplify matters, we
adopt the following abbreviations for certain basic combinations:
• TTQ = mass testing, contact tracing, and quarantine
• OLSD = transitioning courses of 30 or more students to online-only together with social distancing via
moving classes into larger vacated classrooms.
• SI = TTQ, OLSD, and universal mask-wearing.
Tables 2 and 3 show the first collection of such results where the overall rate of daily contact has been varied.
For simplicity, each of the various types of contact (academic, residential, and broad social) has been varied
proportionally relative to the default configuration (so that 38 contacts per day would consist of a total of
32 contacts from the close social, classroom, department professional, department environmental, and broad
environmental categories, 4 broad social contacts per day, and 2 residential contacts). We opted to end the
simulation of very large numbers of contacts in each scenario after a threshold of 3,000 total infected or 5,000
peak quarantine had been reached, as any more extreme scenario than this is clearly to be avoided in reality.
Bolded columns represent the default parameter values of 19 daily contacts, and these scenarios correspond
to the ones plotted in Figure 3 (but we note that the figure summarizes the results of 500 total simulations).

23

Table 2: Cumulative total infected for various alternate calibrations of contact rates

Daily Contacts
6.3

12.5

19.0

25.3

31.5

50.0

75.0

SI

29

37

44

65

73

453

1577

No Mass Testing

29

37

46

68

125

1333

2985

No Distancing

30

37

48

65

113

1135

2671

No TTQ

31

47

83

310

2066

14643

No Masks

36

61

138

519

1876

4056

1335

2043

No OLSD

42

98

510

Only TTQ

114

2883

5398

Only OLSD

45

257

7791

Only Masks

60

3707

No Intervention

3291

Each cell is the median value (rounded to the nearest whole number) of 50 independent runs of the specified
scenario. The bold column represents the default parameter values of 19 daily contacts. Empty cells are
those scenarios for which some strictly less severe scenario has already reached either 3000 infected or 5000
peak quarantined.

Table 3: Peak quarantine size for various alternate calibrations of contact rates

Daily Contacts
6.3

12.5

19.0

25.3

31.5

50.0

75.0

SI

56

99

156

227

281

1448

5187

No Mass Testing

11

29

48

88

167

2785

6870

No Distancing

57

106

162

244

408

3426

7973

No TTQ

∗

∗

∗

∗

∗

∗

No Masks

61

118

275

1052

3458

7661

No OLSD

96

369

1760

4220

5884

Only TTQ

190

4691

8673

Only OLSD

∗

∗

∗

Only Masks

∗

∗

No Intervention

∗

Each cell is the median value (rounded to the nearest whole number) of 50 independent runs of the specified
scenario. The bold column represents the default parameter values of 19 daily contacts. Empty cells are
those scenarios for which some strictly less severe scenario has already reached either 3000 infected or 5000
peak quarantined. A star indicates that the intervention does not include quarantine so peak quarantine is
trivially zero.
As can be seen from the table, we note that dropping the OLSD combination of interventions from the
24

standard intervention results in greater numbers of additional infections and peak quarantine size than does
dropping the use of masks at any of the simulated contact rates. It is likewise true that dropping OLSD
results in more additional infections than does dropping TTQ until the level of 31.5 daily contacts, at which
point the effects are comparably severe.
The next series of results demonstrates dependence of our main outcome variables on the chosen values of
R0 and the rate of infection from external sources. We find that there is only modest change in the standard
intervention as R0 varies over the full interval of reasonable values from 2.8 to 5.8. Similarly, the number of
total infections depends in a roughly linear way on the rate of external infections (i.e., there is no indication
of strong nonlinear dependence). Results are summarized in Tables 4 and 5.
Table 4: Cumulative total infected for various alternate values of R0 and rates of infection from outside
sources

R0

External Infections Per Day

2.8

3.8

4.8

5.8

0.25

0.5

1.0

2.0

4.0

SI

36

44

49

73

44

91

181

352

689

No Mass Testing

40

46

62

87

46

101

194

386

764

No Distancing

42

48

66

92

48

99

197

400

769

No TTQ

50

83

180

936

83

181

354

686

1344

No Masks

60

138

367

1875

138

264

506

884

1542

No OLSD

119

510

1457

2650

510

729

1060

1415

1975

Only TTQ

2880

5398

5398

Only OLSD

734

7791

7791

Only Masks

8182

No Intervention

18590

Table 5: Peak quarantine size for various alternate values of R0 and rates of infection from outside sources
R0

External Infections Per Day

2.8

3.8

4.8

5.8

0.25

0.5

1.0

2.0

4.0

SI

139

156

152

193

156

191

261

416

643

No Mass Testing

41

48

65

100

48

83

129

230

404

No Distancing

149

162

189

242

162

209

294

460

752

No TTQ

∗

∗

∗

∗

∗

∗

∗

∗

∗

No Masks

171

275

649

2472

275

403

617

881

1356

No OLSD

530

1760

3673

5082

1760

2124

2553

2798

3488

Only TTQ

6079

8673

8673

Only OLSD

∗

∗

∗

Only Masks

∗

No Intervention

∗

25

The final parameters we vary are the false positive rate and the false negative rate. Results are summarized in Tables 6 and 7. The tables show a very strong dependence of the peak quarantine size on the
FPR but much more muted relationships between FPR and total infections as well as FNR and both total
infections and peak quarantine size.
Table 6: Cumulative total infected for various alternate values of FPR and FNR

False Positive Rate
−4

10

False Negative Rate

0.001

0.005

0.01

0.02

0.015

0.03

0.06

0.12

0.24

SI

45

44

41

43

40

44

44

42

43

45

No Mass Testing

54

46

50

46

50

49

46

49

52

45

No Distancing

49

48

49

43

44

49

48

52

51

49

No TTQ

87

83

81

74

89

82

83

78

89

78

No Masks

136

138

105

110

89

119

138

128

131

159

No OLSD

544

510

408

297

165

538

510

559

617

634

Table 7: Cumulative total infected for various alternate values of FPR and FNR

False Positive Rate
−4

10

False Negative Rate

0.001

0.005

0.01

0.02

0.015

0.03

0.06

0.12

0.24

SI

77

156

444

791

1443

157

156

146

148

151

No Mass Testing

55

48

53

54

61

41

48

52

57

49

No Distancing

91

162

454

801

1462

166

162

164

159

163

No TTQ

∗

∗

∗

∗

∗

∗

∗

∗

∗

∗

No Masks

172

275

509

881

1487

267

275

268

278

295

No OLSD

1754

1760

1780

1982

2499

1746

1760

2009

1977

2008

5.3

Analytical Model

In this section, we present a simple theoretical model which gives further support for the observed results of
our more general ABM. The theoretical model is essentially a discrete-time compartmental model regarding
susceptible, infected, and removed individuals in each classroom as their own compartment. Because the
compartments are not disjoint (i.e., because each student belongs to multiple classes), we include “bookkeeping transmission” between classes to properly reflect the effects of simultaneous membership in multiple
classes. We find that the whole system can be conveniently understood in terms of an effective reproduction
number R̃ given by
P α` (S`0 )2
` 1−α` S`0

R̃ := γ + c P

S`0
` 1−α` S`0

,

(1)

where S`0 is the initial susceptible population in class `, α` is the per-person rate of transmission in class ` (so
that an initial infected individual in class ` would be expected to infect α` S`0 total susceptible individuals), c is
26

the average number of classes per student10 , and γ is a dimensionless transmission rate for all non-classroom
transmission. To avoid uncontrolled transmission within each classroom, it is necessary that α` S`0 < 1
for each `. Likewise, even if each individual classroom is below this threshold, uncontrolled transmission
throughout the university is possible when R̃ > 1.
Before we explain the derivation of (1), we briefly explain why this formula further supports the idea
that the largest classes have the biggest impact on disease dynamics. In classroom `, the product α` S`
corresponds to the “local” reproduction number within that classroom. The ratio
α` (S`0 )2
` 1−α` S`0

P

S`0
` 1−α` S`0

P

is a weighted average of these local reproduction number, with the weight in classroom ` being S`0 /(1−α` S`0 ).
The weights favor larger classes because of the factor of S`0 in the numerator, and they also favor classes
with higher local reproduction numbers because of the denominator (1 − α` S`0 ). Since in our case α` S`0
is an increasing function of class size, we expect (1) overall to be far more significantly impacted by larger
classes than smaller ones. Using the contact rates and transmission dynamics from our ABM, it is possible to
compute R̃ explicitly under the assumption that only classes below a given threshold are meeting in person.
Based on the parameters of our ABM, the parameters which most naturally correspond to it are γ = 0.2 and

α` =


0.001392

S`0 ≤ 4,

0.001392 + 0.01728
√ 0
S`

S`0 ≥ 5.

These values roughly mirror the standard intervention in the presence of no residential contacts and with
environmental contacts replaced by equal numbers of close academic and classroom contacts. If all classes of
30 or more are moved entirely online, the value of R̃ given by (1) is 0.52 for a typical simulated distribution of
class sizes; in our ABM we observe a median R0 of 0.44 in this situation. In particular, the theoretical model
agrees with the ABM that this scenario is well below the threshold for uncontrolled exponential growth of
infections.
A number of other values for different class size cutoffs are summarized in Table 8 below. The agreement
is somewhat reduced as class size increases, but this is to be expected since our theoretical model is based
on the assumption that the total number of cases is small, which becomes less appropriate as R̃ increases.
Table 8: Computed R̃ versus simulation for various class size caps

Class Size Cap

Computed R̃

Simulated R0

10

0.29

0.27

20

0.43

0.33

30

0.52

0.44

60

0.66

0.54

90

0.92

0.76

10 Formally, the parameter c is a dimensionless parameter equal to the sum of all class sizes divided by the total number of
students.

27

The model equations are as follows. We will treat time as a discrete variable and let Skn represent the
number of susceptible students in class k on day n; the difference Ikn := Skn−1 − Skn represents the number
of new cases in class k on day n. We assume that the number of new cases in class k which are due to
P14
d n−d+1
I`
in the limit of very small transmission
individuals infected in class ` is roughly equal to Skn d=1 Rk`
d
proportions Rk` . We also assume that there is an external source causing Fkn+1 Skn additional infections in
the limit of small Fkn+1 . Our equations are
Skn+1

:=

Skn

−Fkn+1

exp

−

!

14 X
X
d=1

d n−d+1
Rk`
I`

.

(2)

`

Note that when Fkn is identically zero, (2) admits solutions which are constant for all time. To cleanly
identify physically-realistic initial conditions, we define Skn := Sk0 for all n < 0, which effectively means that
we are identifying those solutions which existed in constant equilibrium before the introduction of external
infections on days n ≥ 0. We note that in the regime of small outbreaks, each I`n−d+1 will be order 1, so in
d
the limit as Fkn+1 , Rk`
→ 0, we have a valid expansion of the exponential (2)

Skn+1

=

Skn

1−

Fkn+1

−

14 X
X
d=1

!
d n−d+1
Rk`
I`

+ (higher order terms).

(3)

`

Even though we are in a perturbative regime, it is helpful to work directly with (2) rather than the expansion
(3) because (2) admits useful conserved quantities which allow for an easier understanding of the limiting
behavior as n → ∞. Specifically, fixing
Φnk := Skn exp −

14 X
X
d=1

!
d
Rk`
S`n−d

`

and using the identity I`n−d+1 = S`n−d − S`n−d+1 gives the identity
n+1

Φn+1
= Φnk e−Fk
k

.

When the Fkn are nonnegative, it is easy to see by induction that the quantities Skn and Φnk are strictly
positive and nonincreasing in n; thus the limits Sk := limn→∞ Skn and Φk := limn→∞ Φnk exist and
Sk exp −

14 X
X
d=1

!
d
Rk`
S`

=

Sk0

exp −

∞
X

Fkn

−

n=1

`

14 X
X
d=1

!
d
Rk`
S`0

.

`

d
Among other features, we see that the temporal structure of the transmission parameters Rk`
will affect the

temporal dynamics but only their sum is needed to understand the limiting behavior; for convenience, we
P14
P∞
d
and Fk := n=1 Fkn and work directly with these quantities. This means that
simply let Rk` := d=1 Rk`
the limiting values Sk satisfy
!
Φk = Sk exp −

X

Rk` S`

!
= Sk0 exp −Fk −

`

X

Rk` S`0

= e−Fk Φ0k .

(4)

`

provided that Fk < ∞ for each k, the right-hand side of (4) is always strictly positive, which means that the
limit values Sk are also strictly positive.
28

We will model the transmission proportions Rk` as a sum of two terms: Rk` = αk δk` + βT −1 , where
δk` is the Kronecker delta. Here each αk models transmission within classroom k, and βT −1 is a parameter
which will account for broad transmission as well as necessary “bookkeeping” reflect the fact that individual
students are enrolled in multiple courses (here T is simply the total number of students times the average
number of courses per student). The equation (4) becomes
β

Sk e−αk Sk e− T

P

`

S`

0

β

= e−Fk Sk0 e−αk Sk e− T

P

`

S`0

.

(5)

This identity can be rewritten as
0

β

Sk e−αk Sk = e−Fk Sk0 e−αk Sk e− T

0
` (S` −S` )

P

;
0

and treating the right-hand side as an arbitrary fixed, small perturbation of Sk0 e−αk Sk , the equation will
admit a solution Sk near to Sk0 varying smoothly with the perturbation if and only if αk Sk0 < 1, simply
because the function xe−αx has a critical point at x = 1/α. Thus, to prevent a localized, uncontrolled
outbreak in class k, it is necessary that αk Sk0 < 1. Returning to (5), we must also compute the Jacobian
matrix ∂Φ/∂S. To that end, we compute:
β
∂
Sk e−αk Sk e− T
∂S`

P

`

S`


=



β
1
β
Sk e−αk Sk e− T
− αk δk` −
Sk
T

P

`

S`

.

Treating the right-hand side of (5) as a small perturbation of Φ0k for each k, we also know that the solutions
Sk will vary smoothly in this perturbation only when β is sufficiently small that the Jacobian matrix is
invertible. For convenience, we give the matrix entries just computed names: if Mk` := ∂Φk /∂S` , then
Mk` := Φ0k





Sk−1 − αk δk` − βT −1 .

One can see by an explicit calculation that M is invertible as long as
S`
βX
<1
T
1 − α` S`

(6)

`

and that M has inverse
"

−1
M`j

β
S` δ`j
+
=
P
1 − α` S`
T −β m

Sm
1−αm Sm

#
S` Sj
1
.
(1 − α` S` )(1 − αj Sj ) Φ0j

(We note that the solution map must be discontinuous when the left-hand side of (6) is strictly positive
since in this case M −1 has negative entries, which, if the map were continuous, would mean that increasing
Fk for certain k would decrease the number of infected in some classroom k 0 , which can be easily ruled out
by an elementary analysis of the equations (2).) In particular, in the limit of small Fk ’s, one has the linear
approximation
Sk ∼ Sk0 −

Sk0 Fk
β
−
P
0
1 − αk Sk
T −β m

0
Sm
0
1−αm Sm

X Fj Sj0
Sk0
.
1 − αk Sk0 j 1 − αj Sj0

To correctly choose β, we momentarily fix each αk = 0 and we let Fk0 = (Sk00 )−1 for a single index k = k0
and set Fk = 0 otherwise. This represents the introduction of an external infection into class k of size . We

29

get
Sk ∼ Sk0 − δkk0 −

β
S 0 ,
(1 − β)T k

(7)

and summing over k gives
T−

X


Sk ∼  1 +

k


β

=
.
1−β
1−β

If the model were capturing only broad contact across the entire university, we would expect the right-hand
side to equal c(1 − γ)−1 , where c counts the average number of courses a student takes. Thus we should fix
1 − β = c−1 (1 − γ). We also see from (7) that the term
β
S0
(1 − β)T k
does not depend on the initial classroom k0 and is proportional to Sk0 , which means that we are effectively
assuming that students choose their courses independently with probability proportional to class size.
Making the choice of β identified above and rewriting (6) at the initial data Sk0 gives the stability criterion
S`0
1 − c−1 (1 − γ) X
< 1,
T
1 − α` S`0
`

and using the fact that T =

P

`

S`0 to rewrite this condition gives the equivalent condition
α` (S`0 )2
` 1−α` S`0

P
R̃ = γ + c P

S`0
` 1−α` S`0

< 1.

As above, if we let Fk =  for each k and let  → 0, we have
X
T c
(Sk0 − Sk ) ∼
.
1 − R̃
k
This formula is what motivates our description of R̃ as an effective reproduction number. Setting Fk = 
for each k corresponds to a total of T  infections from outside sources, the factor of c merely reflects the
bookkeeping requirement that one infection from an external source contributes an amount of c when counted
with multiplicity across all classes. Therefore one sees that R̃ is an effective reproduction number for the
system when individuals are subjected to a small external source of infections.

30

