A Closed-Loop Framework for Inference, Prediction and Control of
SIR Epidemics on Networks

arXiv:2006.16185v1 [physics.soc-ph] 23 Jun 2020

Ashish R. Hota, Jaydeep Godbole, Pradhuman Bhariya and Philip E. Paré∗

Abstract
Motivated by the ongoing pandemic COVID-19, we propose a closed-loop framework that
combines inference from testing data, learning the parameters of the dynamics and optimal
resource allocation for controlling the spread of the susceptible-infected-recovered (SIR) epidemic
on networks. Our framework incorporates several key factors present in testing data, such as
high risk individuals are more likely to undergo testing and infected individuals potentially act
as asymptomatic carriers of the disease. We then present two tractable optimization problems to
evaluate the trade-off between controlling the growth-rate of the epidemic and the cost of nonpharmaceutical interventions (NPIs). Our results provide compelling insights for policy-makers,
including the significance of early testing and the emergence of a second wave of infections if
NPIs are prematurely withdrawn.

1

Introduction

Mathematical modeling of infectious diseases that spread through the human population has a
long history. A plethora of models that capture the dynamic evolution of epidemics have been
proposed (see [Hethcote, 2000, Pastor-Satorras et al., 2015] for detailed surveys). However, there
are two broad classes of models: one where a person who has recovered from the disease is immune
from re-infection (at least for a few months or years) and second where there is a possibility of
re-infection.
One of the most fundamental mathematical models pertaining to the first class of epidemics is
the susceptible-infected-recovered (SIR) epidemic where individuals can be in one of three possible
compartments or states: susceptible, infected or recovered. Individuals who are susceptible get
potentially infected by coming into contact with infected neighbors, while infected individuals
recover at a certain rate. While several other models with additional compartments (such as
death, quarantine, exposed, etc) have been proposed, the SIR epidemic remains one of the most
fundamental models. Early work on (SIR) epidemics focused on the homogeneous population
setting, while more recent works model the interactions between individuals via an underlying
network. Detailed overviews of different epidemic models over networks are given in [Barrat et al.,
2008, Draief and Massouli, 2010, Pastor-Satorras et al., 2015, Nowzari et al., 2016, Mei et al., 2017].
Since there is no strong evidence of re-infection in the ongoing COVID-19 pandemic, it may be
assumed to fall under the first class of epidemics [Ota, 2020]. Consequently, we focus on estimation
and control of SIR epidemics on networks in this work. Specifically, we
• highlight the challenges associated with computing optimal NPIs to control the SIR epidemic
on networks,
∗

Ashish R. Hota, Jaydeep Godbole and Pradhuman Bhariya are with the Department of Electrical Engineering,
IIT Kharagpur, India. Philip E. Paré is with the School of Electrical and Computer Engineering, Purdue University,
USA. E-mail: ahota@ee.iitkgp.ac.in, jgodbole7@gmail.com, pradhumanbhariya2@gmail.com, philpare@purdue.edu.

1

• identify key characteristics inherent in testing data that have not been systematically captured
by the existing work on inference and prediction of epidemics,
• rigorously establish the behavior of the discrete-time SIR epidemic on networks,
• propose a stochastic non-linear observer model that relates testing data with the underlying
epidemic states,
• propose a closed-loop framework that integrates inference, learning and optimal allocation of
NPIs, and
• uncover compelling insights on the behavior of the SIR epidemic under different NPIs via
extensive empirical evaluations.
Nevertheless, the proposed estimation and control approaches can naturally be extended to a large
class of models with more compartments provided that there is no possibility of re-infection.

1.1

SIR Epidemic Dynamics on Networks

In order to provide better clarity regarding the gaps in the existing literature and how our proposed framework fills those gaps, we first introduce the continuous-time SIR epidemic dynamics on
networks [Mei et al., 2017]. Let G = (V, E) be a network or graph where V is the set of nodes with
|V | = n and E ⊆ V × V is the set of edges. We consider a large-population regime where each node
represents a sub-population (such as a city or a county/district or a state) as opposed to a single
individual. We denote the size of sub-population i as Ni .
We denote by βij ∈ R≥0 the rate at which the infection can spread through the edge (vj , vi ) ∈ E,
and by γi ∈ R>0 the rate at which an individual in sub-population i recovers from the infection.
If two nodes vi and vj are not neighbors, then βij = 0. We assume that βii 6= 0 for every
node vi since the individuals inside sub-population i come in contact with each other. We define
Vi := {j ∈ V |βij 6= 0} to be the set of neighbors of node vi . In the literature, the notation aij is
often used to denote the weight or contact pattern between nodes i and j and βi is used to denote
the rate at which node i is infected by its infected neighbors. The formulations are equivalent if we
define βij = βi aij .
The proportions of the sub-population at node vi that are susceptible, infected and recovered
at time t are denoted by si (t), xi (t) and ri (t), respectively. Accordingly, we have si (t), xi (t), ri (t) ∈
[0, 1] and si (t) + xi (t) + ri (t) = 1 for all t and vi ∈ V . The deterministic continuous-time evolution
of the SIR epidemic is given by
ṡi (t) = −si (t)

n
X


βij xj (t) ,

(1a)

j=1
n
X

ẋi (t) = si (t)
βij xj (t) − γi xi (t),

(1b)

j=1

ṙi (t) = γi xi (t),

∀i ∈ [n] := {1, 2, . . . , n}.

(1c)

Note that ṡi (t) + ẋi (t) + ṙi (t) = 0. The evolution of the proportion or fraction of infected nodes
can be written in a compact form as


ẋ(t) = diag(s(t))B − diag(γ) x(t),
(2)

2

where x(t) ∈ Rn , B is the matrix with (i, j)-th entry βij and diag(γ) is a diagonal matrix with
diagonal entries being the entries of the vector γ. As analyzed in [Mei et al., 2017], the trajectory
of the infected
population depends critically on the largest eigenvalue of the matrix diag(s(t))B −

diag(γ) , denoted by λmax (t). If λmax (0) > 0, then x(t) initially shows an exponential growth.
Eventually, there exists a t̄ > 0 with λmax (t̄) < 0, and the fraction infected monotonically decreases
for t ≥ t̄. However, the proportion of the susceptible (recovered) population is monotonically
decreasing (increasing) with t.
Many infectious diseases, including COVID-19, show the above characteristic and such diseases,
if unchecked, can potentially infect millions of people throughout the world in the span of several
weeks. In the absence of appropriate medicine and vaccines at the early stages of an outbreak (as is
the case for COVID-19) non-pharmaceutical intervention (NPI) strategies must be deployed. The
primary NPIs to control the spread of such epidemics include
• reducing the interaction between nodes (for example, by restricting travel and imposing lockdown measures), and
• deploying more resources (in terms of healthcare personnel, dedicated hospitals and medical
equipment) thereby increasing the rate at which infected individuals get cured.
The former corresponds to reducing the βij parameters and the latter corresponds to increasing the
curing rates (γi ’s). Both of these interventions are costly; the former with a significant economic
cost. Furthermore, different nodes have different degrees of epidemic outbreak, and require different
degrees of interventions.

1.2

Related work and research gaps

Following early works in [Wan et al., 2007, 2008, Preciado et al., 2014], the existing literature on
resource allocation for controlling the spread of epidemics has primarily focused the SIS epidemic
on networks. In contrast with the SIR epidemic, under the SIS epidemic an individual after recovery can potentially be infected again if she/he comes in contact with other infected individuals.
Nevertheless, for the SIS epidemic, there is a simple spectral condition which characterizes whether
the disease persists in the population or the fraction of infected nodes/populations decays quickly
to zero. It was shown in [Preciado et al., 2014] that the problem of optimal resource allocation to
ensure that the disease is eradicated is an instance of a geometric program (GP) [Boyd et al., 2007]
which can be solved efficiently. This approach has been extended in several directions, such as to
account for dynamic networks [Ogura and Preciado, 2017, Ogura et al., 2019], uncertainty in the
network structure [Han et al., 2015], distributed algorithms [Ramı́rez-Llanos and Martı́nez, 2018,
Mai et al., 2018], among others. However, the above optimization problems are solved off-line and
do not use feedback to adapt the solution as the epidemic spreads.1
In contrast, investigations of optimal resource allocation to contain the spread of the SIR epidemic have been few with [Ogura and Preciado, 2016] being an exception. It is shown in [Ogura
and Preciado, 2016] that a GP can be formulated to minimize the expected cumulative number of
people who get infected when λmax (0) < 0. However, this condition is restrictive since for most
epidemics the fraction of infected individuals shows an initial exponential increase before declining.
Optimal resource allocation for the SIR epidemic is particularly challenging because
1
Online approaches based on optimal control theory have been studied in [Eshghi et al., 2014, Zaman et al., 2008]
to compute vaccination strategies, which are different from NPIs considered in this work.

3

• there is no known tractable characterization of the eventual number of recovered individuals
for the SIR epidemic which can be minimized in an off-line manner,2 and
• the instantaneous growth rate λmax (t) depends on the fraction of the susceptible population
at each node which is time-varying and may not be accurately known.
In this paper, we investigate a potential approach to minimize λmax (t) in an online manner.
As mentioned above, this requires knowledge of the proportion of the susceptible sub-population
at each node of the network. As a result, the current proportions of susceptible, infected, and
recovered sub-populations at different nodes and the parameters that govern the dynamics of the
epidemic (such as infection and curing rates) need to be learned from testing data (number of tests
carried out, number of confirmed cases and number of recoveries) that is made available every day
by different jurisdictions.
Earlier work has primarily focused on learning the parameters of the epidemic dynamics. In
particular, [Paré et al., 2020] presents a data-driven framework for learning the parameters of networked SIS epidemic dynamics. However, literature on SIR epidemic models have mostly focused
on the scalar dynamics (without any network structure). In [Chen and Qiu, 2020], a least squares
based parameter identification was carried out assuming that the proportion of infected and recovered sub-population and the daily change in the above (i.e., the state information) is proportional
to the respective fractions in the testing data. An analogous assumption was made in a recent work
[Casella, 2020] on COVID-19 as well. In [Osthus et al., 2017, Song et al., 2020], Bayesian Markov
Chain Monte Carlo (MCMC) techniques were used for estimating the states and parameters. An
overview of the above approaches is discussed in [Abadie et al., 2020].
However, the above models do not consider the networked SIR epidemic dynamics, and do not
capture the following characteristics inherent in testing data.
• Real testing strategy is not uniform. Due to limited testing capacity, high-risk (symptomatic
with travel history) individuals are more likely to get tested [Cohen and Kupferschmidt, 2020].
• For some diseases, such as COVID-19, individuals often show symptoms a few days after
becoming infected (while they continue to infect others despite being asymptomatic).

1.3

Proposed approach and contributions

In light of the above research gaps, we propose a closed-loop framework that integrates inferring
the state of the epidemic from testing data, learning the parameters of the epidemic dynamics
and optimal resource allocation for the SIR epidemic on networks. The schematic of the proposed
scheme is shown in Fig. 1.
In Section 2, we first introduce a discrete-time counterpart of the SIR epidemic dynamics stated
in (1), and provide assumptions required for the model to be well defined. We then derive several
properties of the state trajectories under the discrete-time dynamics, including expanding the idea
of the reproduction number3 to the networked SIR model and showing at least linear convergence
to equilibria where no one is infected after some time.
As discussed above, one of the key requirements towards controlling the evolution of the infected
population is to infer the current fraction of susceptible population from testing data. We denote
the testing data at node i for a given time k as Ωi (k) := (zi (k), ci (k), di (k)), where zi (k) denotes
2

Estimating the final size of the recovered population is challenging, and existing approaches rely on approximations that are not amenable for tractable optimization [Miller, 2012].
3
In epidemiology, the reproduction number is the number of infections one infection generates on average over the
course of its infectious period. If less than one, the virus quickly dies out.

4

Optimization
Solver

Bk∗ , γk∗

Discrete-Time
SIR Dynamics

θ(k)

Data from
Testing

b
θ(k)
Parameter
Identification

Inference

b − τ)
θ(k

Ω(k)

Figure 1: Schematic of the proposed framework. Here θ(k) = (s(k), x(k), r(k)) denotes the epidemic
b
state at time k, Ω(k) denotes the testing data, θ(k)
denotes the inferred epidemic states and τ
denotes the delay factor as explained in Section 1.3.

the number of tests carried out, ci (k) denotes the number of confirmed cases and di (k) denotes the
number of recoveries. While prior work has assumed that zcii (k)
(k) is proportional to the (change in)
fraction of infected population (xi (k)) [Chen and Qiu, 2020, Casella, 2020], we incorporate the fact
that individuals at a higher risk of being infected are more likely to undergo testing than healthy
individuals. Furthermore, in order to capture the fact that for some diseases (such as COVID19) an infected individual can remain asymptomatic for several days while being contagious, we
assume that testing data is reflective of the epidemic state at a past time rather than the current
time. We denote this lag or delay by τ . In practice, τ is different for each individual, and could
be modeled as a random variable. However, as a first step, we assume τ to be deterministic
and homogeneous across the population. In Section 3, we propose a stochastic nonlinear observer
model that relates the testing data with the underlying states by incorporating the two factors
discussed above. By leveraging the above model, we discuss how to infer the epidemic states
b − τ ) = (b
θ(k
si (k − τ ), x
bi (k − τ ), rbi (k − τ )) from testing data at time k.
b
The delay factor τ necessitates estimating the current state of the epidemic, θ(k)
:=
b
(b
s(k), x
b(k), rb(k)), from the inferred values θ(k − τ ). If the parameters of the epidemic dynamics (βij (κ)’s and γi (κ)’s) are known for κ ∈ [k − τ, k], then the current state can be predicted
from the dynamics. In the initial stages (before any interventions are deployed), these parameters
may be learnt from the available data. Eventually, once the optimal contact and curing rates are
deployed, they may be used for predicting the current state. We present a least-square formulation
to identify the virus spread parameters in Section 4 in order to achieve this goal.
In Section 5, we formulate two complementary GPs to evaluate the trade-off between minimizing
the cost of NPIs and the growth-rate (analogous expression of λmax (t) for the discrete-time model).
The optimal solutions are then deployed, and at the next iteration, new testing results are used
to update the parameters and the predicted states, and the process repeats over time in a manner
similar to that of receding horizon control.4
Finally, in Section 6, we illustrate the performance of the proposed inference, prediction and
NPI allocation in controlling the spread of the SIR epidemic on networks. Our results highlight
the importance of early testing for accurate estimation and control performance, and the risk of
a second wave of infection if NPIs are prematurely withdrawn. We now present the discrete-time
dynamics, inference, parameter identification and optimization formulations in the following four
sections, respectively.
4

Similar approaches have been investigated for the class of SIS epidemics in [Watkins et al., 2019]. However, to
the best of our knowledge, they have not been studied in the context of SIR epidemics.

5

2

Discrete-Time SIR Epidemic Dynamics on Networks

The continuous-time dynamics in (1) is often viewed as a mean-field approximation of a continuoustime Markov chain model of the evolution of the disease. However, since the (testing) data is often
available in discrete points of time, we develop the proposed inference, learning and control tasks
for a discrete-time version of the above dynamics motivated by a similar approach proposed in [Paré
et al., 2020] for SIS epidemics. We now state the discrete-time SIR epidemic dynamics obtained via
Euler discretization of (1). For a small enough sampling time h > 0, the deterministic discrete-time
evolution of the SIR epidemic is approximately given by
n
X


si (k + 1) = si (k) + h − si (k)
βij xj (k) ,

(3a)

j=1
n
X


xi (k + 1) = xi (k) + h si (k)
βij xj (k) − γi xi (k) ,

(3b)

j=1

ri (k + 1) = ri (k) + hγi xi (k).

(3c)

The initial conditions need to be specified such that si (0), xi (0), ri (0) ∈ [0, 1] and si (0) + xi (0) +
ri (0) = 1 for every node i. In vector form the model becomes
s(k + 1) = s(k) − hdiag(s(k))Bx(k),

(4a)

x(k + 1) = x(k) + hdiag(s(k))Bx(k) − hdiag(γ)x(k)
= [In + hdiag(s(k))B − hdiag(γ)]x(k) =: Ak x(k),
r(k + 1) = 1n − s(k + 1) − x(k + 1),

(4b)
(4c)

where 1n is the vector of dimension n with all entries equal to 1. Note that we have defined
Ak := In + hdiag(sk )B − hdiag(γ). We now assume the following on the parameters such that the
dynamics is well behaved.
P
Assumption 1. For all i ∈ [n], we have 0 < hγi ≤ 1 and h nj=1 βij < 1. Furthermore, the matrix
B is irreducible.
Note that Assumption 1 is satisfied when the sampling parameter h is chosen to be sufficiently
small. If h is not sufficiently small (i.e., sampling is infrequent), then it is possible for the states
to become negative or exceed 1, both of which are incompatible with their physical interpretation.
The assumption also implies that Ak is an irreducible non-negative matrix. Therefore, by the
Perron-Frobenius Theorem for irreducible non-negative matrices [Varga, 2000, Theorem 2.7 and
k
Lemma 2.4], Ak has a positive real eigenvalue equal to its spectral radius, which, we denote by λA
max .
We have the following result on the behavior of the discrete-time dynamics under the above
assumption. These are similar to the behavior of the continuous-time dynamics [Mei et al., 2017],
but to the best of our knowledge, have not been formally proven in the literature. Our result also
strengthens some of the observations in [Mei et al., 2017].
Theorem 1. Consider the model in (4) under Assumption 1. Suppose si (0), xi (0), ri (0) ∈ [0, 1],
si (0) + xi (0) + ri (0) = 1 for all i ∈ [n] and xi (0) > 0 for some i. Then, for all k ≥ 0 and i ∈ [n],
1) si (k), xi (k), ri (k) ∈ [0, 1] and si (k) + xi (k) + ri (k) = 1,
2) si (k + 1) ≤ si (k),
6

3) limk→∞ xi (k) = 0 for i ∈ [n],
k
4) λA
max is monotonically decreasing as a function of k,
k
5) there exists k̄ such that λA
max < 1 for all k ≥ k̄, and

6) there exists k̄, such that xi (k) converges linearly to 0 for all k ≥ k̄, i ∈ [n]. Further, if
limk→∞ si (k) = 0 and hγi = 1 for all i ∈ [n], there exists k̄¯, such that xi (k) converges
superlinearly to 0 for all k ≥ k̄¯.
Proof. See Appendix A.
Theorem 1 shows that the model in (4) is well-defined, the susceptible proportions and the
growth rate decrease monotonically over time, the growth rate will eventually be less than 1, and
the infected proportion of the population will go to 0, in at least linear time for large enough k.
k
Remark 1. The largest eigenvalue λA
max is a generalization of the reproduction number to the
k
networked epidemic setting, that is, if λA
max < 1 the virus quickly dies out. Our result rigorously
proves the observation that for epidemics that follow an SIR-type dynamic, such as COVID-19, the
reproduction number eventually falls below 1.

We use these results as the framework for the control techniques presented in Section 5, which
also require inferring the states from the testing data (Section 3) and estimating the spread parameters for forecasting the states (Section 4).

3

Nonlinear Observer Model and Inference from Testing Data

As discussed earlier, part of the challenge in controlling the spread of infectious diseases such as
COVID-19 is that the prevalence (i.e., the underlying state) of the disease in a given population
is highly uncertain. Individuals need to be tested in order to determine if they are infected by
the disease or pathogen under consideration. At early stages of the epidemic, many countries and
regions do not have enough capacity to test a large number of people since their testing kits are
limited. As a result, testing is conducted on individuals who show symptoms (such as fever and
shortness of breath associated with COVID-19). However, drawing inference about the underlying
spread of the epidemic from such testing data is not straightforward since (i) a large fraction of
infected and contagious individuals never show any symptoms, and (ii) similar symptoms are also
exhibited by patients who suffer from other related illnesses [Hu et al., 2020]. Furthermore, testing
data on a given day reveals individuals who became infected a few days earlier (as opposed to
information about the new infections on that day).
In this section, we focus on inferring the epidemic state (s(k), x(k), r(k)) from testing data.
Specifically, we develop a nonlinear observer model that relates the observations with the underlying
epidemic states following a Bayesian approach. We then leverage the proposed model for state
inference. We denote the inferred states with the symbol b· .
Recall that the testing data at time k at node vi is denoted by Ωi (k) and consists of the number
of tests carried out (zi (k)), the number of confirmed (ci (k)) and removed (including both recoveries
and deaths)
P (di (k)) cases. We denote
P the cumulative number of confirmed and removed cases by
Ci (k) := kl=0 ci (l) and Di (k) := kl=0 di (l), respectively. Accordingly, the number of known or
active cases is given by Ai (k) := Ci (k) − Di (k) and the daily change in the number of known/active
cases is given by ai (k) = ci (k) − di (k).

7

3.1

Nonlinear Observer Model of Testing Data

Note from the above discussion that testing enables us to observe the infection states of tested and
confirmed individuals. In particular, the known active cases are analogous to the proportion of
infected individuals. As a result, it is reasonable to treat the proportion of new infections at time
k (i.e., zcii (k)
(k) ) as representative of the fraction of new infections at node vi . However, as discussed
earlier, the confirmed cases at time k are often found to have caught the infection several days
prior to being tested and with the delay denoted by τ ≥ 1. Therefore, we assume zcii (k)
(k) to be
representative of the decrease in the proportion of susceptible individuals at time k − τ , i.e., the
quantity −∆si (k − τ ) = ∆xi (k − τ ) + ∆ri (k − τ ). In a departure from prior work which assumes
ci (k)
zi (k) to be proportional to xi (k) and/or −∆si (k), we propose a Bayesian framework to model the
fact that testing strategies are not uniform, and formally relate zcii (k)
(k) to ∆si (k − τ ).
We assume that a proportion hi (k) of the population at node vi belongs to a high risk category
while li (k) := 1 − hi (k) comes under a low risk category. Individuals may be deemed high risk if
they exhibit symptoms associated with the disease, are known contacts of confirmed cases, have a
travel history in affected regions, or any combinations thereof.
Now, let Hi (k) be a random variable with Hi (k) = 1 (resp. Hi (k) = 0) if a randomly chosen
individual belongs to the high risk (resp. low risk) category. Accordingly, P(Hi (k) = 1) = hi (k).
We also define a {0, 1}-valued random variable DXi (k) with DXi (k) = 1 (resp. DXi (k) = 0) if a
randomly chosen individual became infected at time k. We now introduce the following notation
to denote certain conditional probabilities of interest. In particular, we define
phx,i (k) := P(Hi (k) = 1|DXi (k − τ ) = 1) =⇒ P(Hi (k) = 0|DXi (k − τ ) = 1) = 1 − phx,i (k),
phh,i (k) := P(Hi (k) = 1|DXi (k − τ ) = 0) =⇒ P(Hi (k) = 0|DXi (k − τ ) = 1) = 1 − phh,i (k),
where phx,i (k), phh,i (k) ∈ [0, 1]. The parameter phx,i (k) captures the proportion of high risk individuals (i.e., those who show symptoms) who became infected at k − τ and depends on the
characteristics of the epidemic and the population (e.g., age, level of immunity against the disease,
prevalence of comorbidity) at node vi . The parameter phh,i (k) captures the proportion of healthy
individuals who belong to the high risk category (i.e., they show similar symptoms or have travel
history), but did not become infected τ time steps earlier.
With the above notation in place, we now apply Bayes’ law to compute the probability of a
randomly chosen high risk individual being infected τ time steps earlier. Specifically, we compute
P(Hi (k) = 1|DXi (k − τ ) = 1)P(DXi (k − τ ) = 1)
P(Hi (k) = 1)
phx,i (k)(−∆si (k − τ ))
=
=: pxh,i (k).
phx,i (k)(−∆si (k − τ )) + phh,i (k)(1 − (−∆si (k − τ )))

P(DXi (k − τ ) = 1|Hi (k) = 1) =

(5)

Similarly, the probability of a randomly chosen low risk individual being infected τ time steps
earlier is
P(Hi (k) = 0|DXi (k − τ ) = 1)P(DXi (k − τ ) = 1)
P(Hi (k) = 0)
(1 − phx,i (k))(−∆si (k − τ ))
=
=: pxl,i (k). (6)
(1 − phx,i (k))(−∆si (k − τ )) + (1 − phh,i (k))(1 − (−∆si (k − τ )))
P
Recall that −∆si (k) = si (k − 1) − si (k) = hsi (k − 1) nj=1 βij xj (k − 1) ≥ 0. Furthermore, both
pxh,i (k) and pxl,i (k) are monotonically increasing in −∆si (k).
P(DXi (k − τ ) = 1|Hi (k) = 0) =

8

We now relate the number of tests and confirmed positive cases with the underlying states. At
time k, the authorities at node vi decide to carry out zh,i (k) ∈ [0, zi (k)] number of tests on high
risk individuals and zi (k) − zh,i (k) number tests on low risk individuals. Assuming that the testing
is accurate (with false positive and false negative rates being 0),5 the confirmed cases among those
tested is the sum of the number of confirmed cases among tested high risk individuals and among
tested low risk individuals. Accordingly, we model
ci (k) ∼ Bin(zh,i (k), pxh,i (k)) + Bin(zi (k) − zh,i (k), pxl,i (k)),

(7)

where Bin(n, p) denotes the binomial distribution with parameters n and p. In control-theoretic
terms, we model ci (k) as the output of a time-varying (due to its dependance on parameters phx,i (k)
and phh,i (k)) stochastic nonlinear observer given by
ci (k) = gk (∆si (k), zi (k), zh,i (k), ξ),

(8)

where ξ captures the randomness in the observation.
We now relate the observed number of recoveries (di (k)) with the underlying states in an
analogous manner. Recall that under the SIR epidemic dynamics, the change in the proportion of
recovered individuals, ∆ri (k) = ri (k) − ri (k − 1) = γi xi (k − 1). In the observed data, the quantity
analogous to the change in the fraction of recovered individuals is di (k), which denotes the number
of known removed cases among the known active cases Ai (k − 1). Accordingly, we assume
di (k) ∼ Bin(Ai (k − 1), γi ).

(9)

In other words, each known active case recovers with probability γi . When the number of active
cases is large, di (k) is approximately equal to γi Ai (k − 1).

3.2

Inference from Testing Data

The above analysis formally relates the observed quantities with the underlying epidemic states. If
the parameters phx,i (k) and phh,i (k) and the number of confirmed cases among the tested high and
low risk populations are known, then maximum likelihood inference of −∆si (k−τ ) can be computed
without much difficulty as both pxh,i (k) and pxl,i (k) are monotonically increasing in −∆si (k − τ ).
Nevertheless, in the rest of the section as well as in our numerical results, we focus on a
practically motivated special case where only high risk individuals undergo testing, i.e., zh,i (k) =
zi (k). Note that this has been the practice in many jurisdictions in the world during the ongoing
COVID-19 pandemic [Cohen and Kupferschmidt, 2020]. Following (5), we have
"

#−1 "

#−1
phh,i (k)
ci (k)
1
1
1
= pd
−1
= 1+
−1
,
xh,i (k) = 1 +
c i (k − τ )
c i (k − τ )
zi (k)
phx,i (k) −∆s
αi (k) −∆s
(10)
phx,i (k)
.
In
other
words,
we
only
need
to
know
ratio
of
the
probability
of
an
infected
where αi (k) := phh,i
(k)
individual being high risk (or undergoing testing) and the probability of a healthy individual being
high risk (or undergoing testing). The parameter αi (k) potentially depends on the number of tests
carried out in a given day. Intuition suggests that as zi (k) increases, αi (k) should converge to 1,
while for small values of zi (k), it should be very large. The parametric function αi (k) = 1+ ziF(k) with
F being a large constant is a potential candidate that satisfies the above requirements. Another
5

Modifying the proposed Bayesian approach to incorporate inaccuracy in testing data is beyond the scope of this
paper and will be explored in follow up work.

9

i
candidate is αi (k) = ziN(k)
where, recall that, Ni is the size of sub-population i. Note that if
αi (k) = 1, i.e., a healthy person is equally likely to undergo testing compared to an infected person,
c i (k − τ ) = ci (k) .
then we have −∆s
zi (k)
Given the testing data and assuming that we know αi (k), we now discuss how to infer the
underlying states. In particular, for every node i ∈ [n], suppose that the daily testing data Ωi (k)
is available to us over the time interval k ∈ [T1 + τ, T2 + τ ]. Accordingly, we define the inferred
fraction of new infections at node vi as

h
i−1
c i (k) = ∆x
c i (k) + ∆r
c i (k) = 1 − αi (k + τ ) + αi (k + τ ) zi (k + τ )
,
− ∆s
ci (k + τ )

k ∈ [T1 , T2 ].

(11)

However, the above information is not enough to uniquely infer the states. Therefore, we first
c i (k) = 0 for
assume that for k < T1 , x
bi (k) = rbi (k) = 0 and sbi (k) = 1. In addition, let ∆r
c i (k) = −∆s
c i (k) for k ∈ [T1 , T1 + τ − 1].
k ∈ [T1 , T1 + τ − 1]. Consequently, from (11), we have ∆x
With the above information, we recursively define
c i (k),
sbi (k) = sbi (k − 1) + ∆s

c i (k),
x
bi (k) = x
bi (k − 1) + ∆x

c i (k),
rbi (k) = rbi (k − 1) + ∆r

(12)

for k ∈ [T1 , T1 + τ − 1].
Now following (9), we infer the change in the fraction of recovered individuals as
c i (k) :=
∆r

di (k)
di (k)
x
bi (k − 1) =
x
bi (k − 1),
Ai (k − 1)
Ci (k − 1) − Di (k − 1)

k ∈ [T1 + τ, T2 ],

(13)

where x
bi (k − 1) is the inferred fraction of infected individuals that is computed recursively following
c i (k) = 0.
(11) and (12).6 In the pathological case with Ai (k) = 0, we assume ∆r
To summarize, employing (11), (12), and (13) together with the appropriate initialization, we
can infer the underlying epidemic states if testing data is made available over an interval.
Note that the inference can be inaccurate when the aforementioned assumptions on the initial
conditions are not met. This is indeed the case when testing is carried out after the disease has
already spread for a while (i.e., when T1 is large). However, as illustrated in Section 6, simulations
show that the inferred proportion of infected sub-populations eventually converge to the true values.
Remark 2. The inference problem described above assume knowledge of the parameters αi (z)’s.
If these parameters are not known, then one potential approach is to infer the states and solve the
least square problem for different values of αi (z)’s; the one with the smaller cost is likely to be closer
to the true underlying αi (z).
In the following section, we describe how the inferred data can be used to learn the model
parameters of the SIR epidemic and predict the current state of the epidemic.

4

Epidemic Parameter Identification and Forecasting

Recall from prior discussion that optimal resource allocation to minimize the growth rate of the
disease, or the cost of NPIs, for the SIR epidemic, requires knowledge of the current proportion
of susceptible individuals at each node of the network. However, due to the delay τ , testing data
up to time k only suffice to infer the epidemic states up to k − τ . As a result, we need to predict
6

c i (k) from our knowledge of ∆r
c i (k) and −∆s
c i (k) and compute x
Specifically, we compute ∆x
bi (k) = x
bi (k − 1) +
d
∆xi (k) for k ∈ [T1 + τ, T2 ].

10

the current proportion of susceptible individuals using the inferred states up to k − τ . Prediction,
or forecasting the future trajectory, of the epidemic is also of independent interest (beyond the
optimal resource allocation problem). If the parameters of the epidemic dynamics are known, then
those can be used to predict the current state of the epidemic from the inferred states up to k − τ .
However, at the early stages of the epidemic, there is substantial uncertainty regarding the values
of βij and γi parameters. In this section, we extend the least squares estimation technique proposed
in [Chen and Qiu, 2020] for scalar SIR epidemics to learn the unknown βij and γi parameters in
the case of networked SIR epidemics.
Specifically, suppose at every node i ∈ [n], the daily testing data Ωi (k) is available to us
over the time interval k ∈ [T1 + τ, T2 + τ ]. Following (11)-(13), we can infer the underlying
states over the interval [T1 , T2 ] from testing data. Subsequently, we can learn the parameters
{{γi }i∈[n] , {βij }(i,j)∈E } ∈ Rn+|E| of the epidemic dynamics by solving the least-square problem:
min

γ∈Rn ,β∈R|E|

T2 
T2 
n hX
2
2 i
X
X
X
c i (k) − γi x
c i (k) + ∆x
c i (k) −
sbi (k)b
xj (k)βij +
∆r
bi (k)
. (14)
∆r
i=1 k=T1

j∈Vi

k=T1 +τ

If additional information such as bounds or the sparsity-pattern (specified by the network structure)
of βij parameters are available, those may be incorporated as constraints in (14). We denote the
optimal solutions of (14) as γ
bi and βbij .
The above formulation assumes that the parameters {{γi }i∈[n] , {βij }(i,j)∈E } ∈ Rn+|E| do not
significantly change over the interval [T1 , T2 ]. If the parameters change due to NPIs by the authorities, then the above formulation can be suitably modified to learn the epidemic parameters both
before and after the imposition of NPIs by considering suitable sub-intervals during which different
NPIs were in place. Other approaches such as [Chen and Qiu, 2020] define βij ’s to be parametric
functions of NPIs. These settings can also be handled by suitably modifying the above formulation.
Remark 3. The formulation in (14) admits a separable structure and as a result, each node vi
can learn their respective βij and γi values using local information from their own testing data and
obtaining the estimates x
bj (k) from their neighbors.
The learned parameters of the epidemic dynamics from (14), γ
bi and βbij , can now be used to
predict the current and future state of the epidemic using the inferred states as the initial conditions.
In order to avoid introducing additional notation, we use b· to also denote the predicted states.
Specifically, for k ≥ T2 , we compute the predicted states as
b x(k),
sb(k + 1) = sb(k) − hdiag(b
s(k))Bb
b x(k) − hdiag(b
x
b(k + 1) = x
b(k) + hdiag(b
s(k))Bb
γ )b
x(k),

(15a)
(15b)

b is the matrix with (i, j)-th entry βbij and diag(b
where B
γ ) is a diagonal matrix with diagonal entries
equal to γ
bi . In the following section, we formulate optimization problems to compute optimal NPIs
to control the spread of the epidemic using the predicted state from (15).

5

Optimal Resource Allocation via Geometric Programming

Recall from Theorem 1 that the growth rate of the infected fraction of the population at time k is
k
given by λA
max (the largest eigenvalue of the matrix In + hdiag(s(k))B − hdiag(γ)). Since Ak is a
function of s(k), in the absence of perfect knowledge of s(k), we use the inferred/predicted value of
s(k), denoted by sb(k) (given in (15a)). The goal of the social planner is to control the spread of the
11

epidemic by choosing the curing rates, i.e., the γi parameters (which, for instance, correspond to
deploying a larger number of healthcare personnel and/or medical equipment) and the contact rates,
i.e., the βij parameters (which correspond to imposing social distancing or lock-down measures).
We present two geometric programming formulations to aid the social planner’s decision-making
with regards to NPIs in a rigorous manner. First, we consider the problem of minimizing the
k
instantaneous growth rate λA
max by optimally allocating the NPIs subject to budget constraints.
Following analogous arguments in [Han et al., 2015, Preciado et al., 2014], this problem is equivalent
to a GP given by:
min λ
X
s.t.
hb
si (k)βij wj /wi + γ̄i ≤ λ

(16a)

λ,γ̄,w,β

∀i ∈ [n],

(16b)

j∈Vi

X

fij (βij ) ≤ C1 ,

(16c)

(vi ,vj )∈E
n
X

gi (γ̄i ) ≤ C2 ,

(16d)

i=1

γl ≤ γ̄ ≤ γu ,

βl ≤ β ≤ βu ,

λ ∈ R+ , γ̄ ∈ Rn+ , w ∈ Rn+ , β ∈

(16e)
|E|
R+ ,

(16f)

where the new variable γ̄i := 1 − hγi is used so that the constraints in (16b) remain posynomials,
the constraints in (16e) correspond to bounds on the contact and curing rates, the functions f and
g are cost functions of NPIs, the constraints in (16c) and (16d) are budget constraints on NPIs
with C1 and C2 being the budgets for contact rates and curing rates, respectively.
The optimal value λ∗k corresponds to the largest eigenvalue of Ak with parameters γk∗ and βk∗ ; the
latter denote the optimal curing and contact rates, respectively. The optimal wk∗ is the eigenvector
corresponding to λ∗k . Furthermore, λ∗k is the smallest possible value that can be achieved given the
budget constraints. The above problem is solved repeatedly in an online manner. At time step
k + 1, we again obtain sb(k + 1) via feedback, and solve (16) with Ak replaced by Ak+1 .
A problem complementary to (16) is to minimize the cost of NPIs subject to the constraint that
the growth rate is bounded by λk . This problem is given by:
X

min Ψ(β, γ̄) :=

γ̄,w,β

s.t.

fij (βij ) +

gi (γ̄i )

(17a)

∀i ∈ [n],

(17b)

i=1

(vi ,vj )∈E

X

n
X

hb
si (k)βij wj /wi + γ̄i ≤ λk

j∈Vi

γl ≤ γ̄ ≤ γu ,

βl ≤ β ≤ βu ,
|E|

γ̄ ∈ Rn+ , w ∈ Rn+ , β ∈ R+ .

(17c)
(17d)

The above formulation corresponds to imposing NPIs in a cost-optimal manner while ensuring that
the reproduction number stays below a certain threshold.
Remark 4. Note that in Section 4 we estimated the virus spread parameters while in this section
we allow a social planner to control the spread of the virus by setting these parameters. There are
two ways to interpret this discrepancy: 1) before the social planner is able or decides to exert efforts
to mitigate the spread of the virus, they must estimate the state of the system from testing data
12

DE

FR

CH

AT

IT
(a) Graph topology analyzed in Section 6.
(b) Evolution of infected sub-population
Figure 2: Network topology and evolution SIR epidemic without NPIs.

Figure 3: Daily and cumulative synthetic test data for node FR with α = 10.

which, given the delay τ , requires estimating the spread parameters, and 2) even after the social
planner is able and decides to implement preventative measures, the population may not follow the
restrictions or they may be less effective (or more extreme) than needed; therefore estimating the
actual parameters is necessary.
We now evaluate the performance of the proposed framework in the following section via simulations.

6

Empirical Evaluation

In this section, we evaluate the proposed approach on a relatively small network with 5 nodes
with topology given in Fig. 2a. The nodes are roughly modeled after five countries in continental
Europe: France (FR), Germany (DE), Italy (IT), Austria (AT) and Switzerland (CH). Two nodes
are neighbors if they share a border. We choose the initially infected proportion to be 0.02 at node
IT and 0 elsewhere. The contact and curing rates are chosen such that Assumption 1 is satisfied.
The evolution of the infected sub-population at all the nodes is shown in Figure 2b.

6.1

Synthetic test data and inference

We now generate synthetic test data using the stochastic nonlinear observer proposed in Section 3.
We assume that only the high risk (e.g., symptomatic) population undergoes testing, and daily
13

Figure 4: Daily and cumulative synthetic test data for node FR with α = 1000.

number of tests zi (k) = 5000 is constant. We generate testing data starting from T1 = 15 to
T2 = 200 with delay factor τ = 5 by sampling the binomial distribution as shown in (7) and (9).
The daily and cumulative numbers of confirmed infections and recoveries as the daily active cases
at node FR are shown in Figure 3 and Figure 4 for αFR (k) = 10 and αFR (k) = 1000, respectively.
(k)
Recall that zcFR
captures the proportion of new infections suitably adjusted by the risk factor
FR (k)
αFR (k). Recall that αFR (k) is the ratio of the probability of an infected individuals being a high
risk and the probability of a healthy individuals being a high risk. As a result, when we only test
(k)
high risk individuals, the proportion of confirmed cases zcFR
is much larger when αFR (k) is large,
FR (k)
and vice versa. In addition, for k ≥ 180, the proportion of infected population begins to decline as
shown in Figure 2b which is also reflected in the active cases in testing data.
In Figure 5 we compare the true state trajectory with the inferred state trajectory at node IT for
different parameter configurations described in the legend. The figures on the top row have T1 = 25
(i.e., testing is relatively delayed) while all figures on the bottom row have T1 = 10. The figures
show that in the absence of early testing, we lack critical information about the initial epidemic
states, and consequently, the inferred values deviate for quite some time from the true values.
While the inferred infected proportion is eventually indistinguishable from the true proportion, the
inferred recovered proportion remains below the true recovered proportion as the initial information
was not available, and hence was not incorporated into the inference.
The middle and right plots on the top row of Figure 5 differ in the value of α. The figures
show that as long as α is correctly known and used, the inferred states closely track the true
states. All the figures compare the inferred states and the delayed true states. Next the impact
of the parameter estimation and state prediction will be highlighted in the context of optimal NPI
computation.

6.2

Performance of online resource allocation with true state information

In order to isolate the performance of the online optimization approaches described in Section 5, we
first assume that s(k) is exactly known, and solve the problems stated in (16) and (17). Following
[Preciado et al., 2014], we define the cost functions for NPIs as
fij (βij ) =

−1
−1
βij
− βu,ij
−1
−1
βl,ij
− βu,ij

,

and gi (γ̄i ) =

−1
γ̄i −1 − γu,i
−1
−1
γl,i
− γu,i

;

recall that γ̄i = 1 − hγi . We also set h = 0.1. Note that fij is monotonically decreasing (i.e.,
it is costly reduce contact rates) and for βij ∈ [βl,ij , βu,ij ], fij (βij ) ∈ [0, 1]. Thus, the range of
the cost function is normalized to the interval [0, 1]. The function gi also has similar properties.
14

Figure 5: Inferred vs. true state trajectories for node IT. Top left and top middle: recovered and
infected sub-population for T1 = 25, τ = 8 and α = 1000. Top right: infected sub-population for
T1 = 25, τ = 8 and α = 10. Bottom left and middle: T1 = 10, τ = 8 and α = 1000. Bottom right:
T1 = 10, τ = 1 and α = 10.

The upper and lower limits on βii and βij are chosen differently to reflect the fact it is easier to
reduce contact between individuals from different sub-populations compared to individuals within
a sub-population.
We first report the results obtained by solving (16) in an online manner for different budget
combinations. We assume that the initial fraction of infected nodes is 10−2 in DE, and 0 for all
other nodes. Fig. 6 shows the evolution of the fraction infected and fraction recovered for node
DE, and the instantaneous growth rate λ∗k at the optimal NPIs. The figure shows that higher
budgets lead to “flattening” of the curve of the infected population. The peak of the infected
sub-population is smaller and occurs much later compared to the baseline setting without NPIs.
Furthermore, the cumulative number of people who become infected shows significant reduction
depending on the budget. When the budget is sufficiently high, not many people become infected
in the first place. Consequently, the proportion of susceptible individuals remains high, which
(perhaps counter-intuitively) results in a larger value of λ∗k compared to the case with smaller
budgets for NPIs. Nevertheless, the proportion of infected individuals decreases to 0.
The evolution of the infected proportion at node FR and the optimal cost obtained by solving
k
(17) are shown in Fig. 7. We constrain λA
max to be 1.02 for 0 ≤ k ≤ 100, followed by 0.95 for
k > 100 until the withdrawal of NPIs at k = 200, 300 and 500 corresponding to early, intermediate
and late withdrawals. When the constraint is 0.95, meeting the condition in Theorem 1 for linear
convergence to zero, a significantly larger cost is borne by the social planner.
Fig. 7 also shows that early and intermediate withdrawals lead to an exponential increase
in the infected proportion, which occurs because, due to the initial interventions, the susceptible
k
proportion is high and as a result, λA
max is large, in the absence of NPIs. Therefore, the social planner
incurs a heavy cost for maintaining the growth rate below 1. Unless the NPIs are maintained for a

15

Figure 6: Evolution of the infected and recovered proportions of node DE and λ∗k under optimal
budget-constrained NPIs obtained by solving (16). The baseline scenario refers to the case without
NPIs.

Figure 7: The infected proportion and the optimal cost obtained by solving (17) for different
Ak
constraints on λmax
.

significantly long period to drive down the infected fraction to a negligible amount, there remains
a serious risk of a subsequent flare-up.
We are currently investigating the performance of NPIs when the true proportion of the susceptible sub-population is not known, but rather the inferred state information is used to solve
the above optimization problems. Furthermore, inference and parameter estimation using the real
testing data for the countries mentioned above are being carried out. Results pertaining to both
the above factors will be added in a follow up version of this working paper.

7

Conclusion

In this paper, we introduce a closed-loop framework to estimate and control the spread of the
SIR epidemic on networks. We first rigorously establish the behavior of the discrete-time SIR
epidemic dynamics; specifically that the dynamics is well-defined, the susceptible proportions and
the growth rate decrease monotonically over time, the growth rate eventually falls below 1, and after
some point the infected proportions of the population converge at least linearly to zero. We also
generalize the reproduction number to the network-dependent setting. Furthermore, we incorporate
several characteristics of real-world testing data in the state estimation task and examine the
impacts of allocating NPIs (such as reducing contact rates and augmenting healthcare equipment
and personnel) by solving suitable GPs in an online manner.
16

Preliminary results reported here provide compelling insights on the behavior of the epidemic
dynamics under NPIs. For instance, we show that (i) ignoring the fact that only individuals at a
higher risk of being infected are being tested can have serious impact on inferring the true states
and consequently on the optimal deployment of NPIs, and (ii) premature withdrawal of NPIs could
lead to emergence of a second wave of infections. Nevertheless, this work presents a first attempt
at using a closed-loop approach that integrates testing, through forecasting, all the way to control,
as opposed to looking at control and forecasting separately. We now summarize several interesting
open problems for the community to explore moving forward.
• As mentioned before, we considered the networked SIR model given its strength as a fundamental and general model. For future work, we would like to expand these ideas to a richer
class of epidemic models with potentially more compartments (such as death, quarantine,
exposed, etc) such as the one proposed in [Giordano et al., 2020].
• Similarly, the classical SIR and SEIR models do not fully capture the fact that many individuals that become infected with COVID-19 never show any symptoms yet remain infectious.
Therefore, a richer class of models with possibly more compartments and/or non-Markovian
transitions should be developed that may better capture the behavior of the COVID-19 pandemic and other possible outbreaks in the future.
• For the estimation part, in Section 4, we have focused on the least-square formulation due
to its simplicity and universality. Other approaches such as Bayesian Markov Chain Monte
Carlo [Osthus et al., 2017] may also be used in conjunction with the observation model given
in (7) and (9).
• Our numerical evaluations have relied on synthetic data. As was illustrated by the simulations,
it is challenging to infer the states when the testing approach is not known and testing
does not start at the beginning of the outbreak. Ongoing work is focused on inference and
learning from real-data pertaining to COVID-19 pandemic using the proposed framework and
providing insights into the NPIs imposed by various jurisdictions.
• Given that the state inference is inaccurate when the deployment of testing is delayed, the
impact of this inaccuracy on the optimal NPI techniques needs to be quantified explicitly in
order to understand the importance of early testing.
• Further, if we impose NPIs too soon with the hope of reducing the growth of infections, we may
not have rich enough data to learn the epidemic parameters, which will hinder our forecasting
abilities. Without understanding the spread of the disease, it is difficult to know when to
withdraw NPIs. Therefore, studying the trade-off between exploration and exploitation is
essential.
• The success of NPIs depend on the effectiveness with which they are enforced. While the social
planner computes the optimal contact rates leading to policy guidelines, individuals may or
may not follow them based on their own perceived risk. Therefore, game-theoretic models of
human decision-making7 need to be integrated into the proposed closed-loop framework for
improved prediction and control of the epidemic.
Overall, the proposed framework establishes the mathematical foundations for computing optimal
NPIs, highlights a number of interesting future research problems and will be a valuable tool for
policy-makers.
7

This problem was recently investigated for the class of SIS epidemics in [Hota and Sundaram, 2019].

17

Acknowledgement
The authors thank Prof. Shreyas Sundaram (Purdue University) and Damir Vrabac (Stanford
University) for helpful discussions that contributed to this work. The authors thank Sanket Kumar
Singh (IIT Kharagpur) for his contributions in data analysis and visualizations.

References
Alberto Abadie, Paolo Bertolotti, Ben Deaner, Arnab Sarker, and Devavrat Shah. Epidemic modeling and estimation,
2020. Working Paper, MIT.
Alain Barrat, Marc Barthelemy, and Alessandro Vespignani. Dynamical processes on complex networks. Cambridge
university press, 2008.
Stephen Boyd, Seung-Jean Kim, Lieven Vandenberghe, and Arash Hassibi. A tutorial on geometric programming.
Optimization and engineering, 8(1):67, 2007.
Francesco Casella. Can the COVID-19 epidemic be managed on the basis of daily data?, 2020. arXiv preprint
arXiv:2003.06967.
Xiaohui Chen and Ziyi Qiu. Scenario analysis of non-pharmaceutical interventions on global COVID-19 transmissions,
2020. arXiv preprint arXiv:2004.04529.
Jon Cohen and Kai Kupferschmidt. Countries test tactics in war against COVID-19, 2020.
Moez Draief and Laurent Massouli. Epidemics and rumours in complex networks. Cambridge University Press, 2010.
Soheil Eshghi, MHR Khouzani, Saswati Sarkar, and Santosh S Venkatesh. Optimal patching in clustered malware
epidemics. IEEE/ACM Transactions on Networking, 24(1):283–298, 2014.
Giulia Giordano, Franco Blanchini, Raffaele Bruno, Patrizio Colaneri, Alessandro Di Filippo, Angela Di Matteo, and
Marta Colaneri. Modelling the COVID-19 epidemic and implementation of population-wide interventions in italy.
Nature Medicine, pages 1–6, 2020.
Shuo Han, Victor M Preciado, Cameron Nowzari, and George J Pappas. Data-driven network resource allocation for
controlling spreading processes. IEEE Transactions on Network Science and Engineering, 2(4):127–138, 2015.
Herbert W Hethcote. The mathematics of infectious diseases. SIAM Review, 42(4):599–653, 2000.
Ashish R Hota and Shreyas Sundaram. Game-theoretic vaccination against networked SIS epidemics and impacts of
human decision-making. IEEE Transactions on Control of Network Systems, 6(4):1461–1472, 2019.
Zhiliang Hu, Ci Song, Chuanjun Xu, Guangfu Jin, Yaling Chen, Xin Xu, Hongxia Ma, Wei Chen, Yuan Lin, Yishan
Zheng, et al. Clinical characteristics of 24 asymptomatic infections with COVID-19 screened among close contacts
in nanjing, china. Science China Life Sciences, 63(5):706–711, 2020.
Van Sy Mai, Abdella Battou, and Kevin Mills. Distributed algorithm for suppressing epidemic spread in networks.
IEEE Control Systems Letters, 2(3):555–560, 2018.
Wenjun Mei, Shadi Mohagheghi, Sandro Zampieri, and Francesco Bullo. On the dynamics of deterministic epidemic
propagation over networks. Annual Reviews in Control, 44:116–128, 2017.
Joel C Miller. A note on the derivation of epidemic final sizes. Bulletin of mathematical biology, 74(9):2125–2141,
2012.
Cameron Nowzari, Victor M Preciado, and George J Pappas. Analysis and control of epidemics: A survey of spreading
processes on complex networks. IEEE Control Systems, 36(1):26–46, 2016.
Masaki Ogura and Victor M Preciado. Efficient containment of exact SIR Markovian processes on networks. In 2016
IEEE 55th Conference on Decision and Control (CDC), pages 967–972. IEEE, 2016.

18

Masaki Ogura and Victor M Preciado. Optimal containment of epidemics in temporal and adaptive networks. In
Temporal Network Epidemiology, pages 241–266. Springer, 2017.
Masaki Ogura, Victor M Preciado, and Naoki Masuda. Optimal containment of epidemics over temporal activitydriven networks. SIAM Journal on Applied Mathematics, 79(3):986–1006, 2019.
Dave Osthus, Kyle S Hickmann, Petruţa C Caragea, Dave Higdon, and Sara Y Del Valle. Forecasting seasonal
influenza with a state-space SIR model. The Annals of Applied Statistics, 11(1):202, 2017.
Miyo Ota. Will we see protection or reinfection in COVID-19?, 2020.
Philip E Paré, Ji Liu, Carolyn L Beck, Barrett E Kirwan, and Tamer Başar. Analysis, estimation, and validation of
discrete-time epidemic processes. IEEE Transactions on Control Systems Technology, 28(1):79–93, 2020.
Romualdo Pastor-Satorras, Claudio Castellano, Piet Van Mieghem, and Alessandro Vespignani. Epidemic processes
in complex networks. Reviews of Modern Physics, 87(3):925, 2015.
Victor M Preciado, Michael Zargham, Chinwendu Enyioha, Ali Jadbabaie, and George J Pappas. Optimal resource
allocation for network protection against spreading processes. IEEE Transactions on Control of Network Systems,
1(1):99–108, 2014.
Eduardo Ramı́rez-Llanos and Sonia Martı́nez. Distributed discrete-time optimization algorithms with applications
to resource allocation in epidemics control. Optimal Control Applications and Methods, 39(1):160–180, 2018.
Peter X Song, Lili Wang, Yiwang Zhou, Jie He, Bin Zhu, Fei Wang, Lu Tang, and Marisa Eisenberg. An epidemiological forecast model and software assessing interventions on COVID-19 epidemic in china, 2020. medRxiv.
Richard S. Varga. Matrix Iterative Analysis. Springer-Verlag, 2000.
Yan Wan, Sandip Roy, and Ali Saberi. Network design problems for controlling virus spread. In 46th IEEE Conference
on Decision and Control, pages 3925–3932. IEEE, 2007.
Yan Wan, Sandip Roy, and Ali Saberi. Designing spatially heterogeneous strategies for control of virus spread. IET
Systems Biology, 2(4):184–201, 2008.
Nicholas J Watkins, Cameron Nowzari, and George J Pappas. Robust economic model predictive control of continuoustime epidemic processes. IEEE Transactions on Automatic Control, 65(3):1116–1131, 2019.
Gul Zaman, Yong Han Kang, and Il Hyo Jung. Stability analysis and optimal vaccination of an SIR epidemic model.
BioSystems, 93(3):240–249, 2008.

A

Appendix: Proof of Theorem 1.

Proof. We present the proof for each part of the theorem, starting with 1).
1) We prove this result by induction. By assumption si (0), xi (0), ri (0) ∈ [0, 1] and
Pnsi (0)+xi (0)+
ri (0) = 1 for all i ∈ [n]. Therefore, by Assumption 1 and (3a), si (1) ≥ (1 − h j=1 βij )si (0) ≥


P
0. Since h − si (0) nj=1 βij xj (0) ≤ 0, s(1) ≤ s(0) ≤ 1. By Assumption 1 and (3b), xi (1) ≥
(1 − hγ
i )xi (0) ≥ 0. Since xj (0) ≤ 1 for all j ∈ [n], by (3b) and Assumption 1, xi (1) ≤ xi (0) +
P
si (0)h nj=1 βij ≤ xi (0)+si (0) ≤ 1. By (3c) and the non-negativity of h and γi , and since xi (0) ≥ 0,
we have ri (1) ≥ ri (0) ≥ 0. By (3b) and Assumption 1, we have ri (1) ≤ ri (0) + xi (0) ≤ 1. Adding
up (3a)-(3c), gives that si (1) + xi (1) + ri (1) = si (0) + xi (0) + ri (0), which by assumption equals 1.
Now assume for an arbitrary k, si (k), xi (k), ri (k) ∈ [0, 1] and si (k)+xi (k)+ri (k) = 1. Following
the exact same arguments as for the base case except replacing 0 with k and 1 with k + 1, it can be
shown that si (k + 1), xi (k + 1), ri (k + 1) ∈ [0, 1] and si (k + 1) + xi (k + 1) + ri (k + 1) = 1. Therefore,
by induction, si (k), xi (k), ri (k) ∈ [0, 1] and si (k) + xi (k) + ri (k) =1 for all P
k ≥ 0 and i ∈ [n].
2) By 1) and the non-negativity of the βij ’s, it follows that h − si (k) nj=1 βij xj (k) ≤ 0 for
all k ≥ 0. Therefore, from (3a), we have si (k + 1) ≤ si (k).
19

3) Since the rate of change of s(k), −hdiag(s(k))Bx(k), is non-positive for all k ≥ 0 and s(k)
is lower bounded by zero, by 1), we conclude that limk→∞ s(k) exists. Therefore
lim −hdiag(s(k))Bx(k) = 0n ,

(18)

k→∞

where 0n is the vector of dimension n with all entries equal to 0. Therefore, limk→∞ x(k+1)−x(k) =
limk→∞ −hγx(k). Thus, by the assumption that hγi > 0 for all i ∈ [n], limk→∞ xi (k) = 0 for i ∈ [n].
4) Recall that by Assumption 1, Ak is an irreducible non-negative matrix and thus by the
Perron-Frobenius Theorem for irreducible non-negative matrices [Varga, 2000, Theorem 2.7 and
k
Lemma 2.4], λA
max = ρ(Ak ), where ρ(·) indicates the spectral radius. By [Varga, 2000, Theorem 2.7],
ρ(Ak ) increases when any entry of Ak increases. Therefore, by 2) and since Ak is defined as
In + hdiag(sk )B − hdiag(γ), we have that
ρ(Ak ) ≥ ρ(Ak+1 ),
which implies
A

k+1
k
λA
max ≥ λmax .

5) There are two possible types of equilibria for the SIR model: i) limk→∞ s(k) = 0n , or
ii) limk→∞ s(k) = s∗ 6= 0n . We explore the two cases separately.
i) If limk→∞ s(k) = 0n , then the rate of change of x(k) converges to −hγx(k). Therefore, by
Ak
k
the definition of λA
max , there exists a k̄ such that λmax < 1 for all k ≥ k̄.
∗
ii) If limk→∞ s(k) = s 6= 0n , then, by 3), for any (s(0), x(0), r(0)) the system dynamics converge
to some equilibria of the form (s∗ , 0n , 1n − s∗ ), for some nonzero s∗ . Define
s (k) := s(k) − s∗ and x (k) := x(k) − 0n .

(19)

By 2) and 1), respectively, we know that s (k) ≥ 0 and x (k) ≥ 0 for all k ≥ 0. Furthermore, we
know that s (k + 1) ≤ s (k) for all k ≥ 0, limk→∞ s (k) = 0n , and limk→∞ x (k) = 0n .
Linearizing the dynamics of s (k) and x (k) around (s∗ , 0n ) gives
s (k + 1) = s (k) − hdiag(s∗ )Bx (k),

(20a)

∗

x (k + 1) = x (k) + hdiag(s )Bx (k) − hdiag(γ)x (k).

(20b)

∗

Let λAmax be the maximum eigenvalue of In +hdiag(s∗ )B−hdiag(γ) with corresponding normalized
left eigenvector w∗ , that is,
∗

w∗> (In + hdiag(s∗ )B − hdiag(γ)) = λAmax w∗> .
∗

(21)

If λAmax > 1, then the system in (20) is unstable. Therefore, by Lyapunov’s Indirect Method,
limk→∞ (s (k), x (k)) 6= (s∗ , 0n ), which is a contradiction.
∗
Now consider the case where λAmax = 1. Left multiplying the equation for x(k + 1) in (4b) by
w∗> and using (19) and (21) gives
w∗> x (k + 1) = w∗> [In + hdiag(s (k) + s∗ )B − hdiag(γ)]x (k)
∗

= λAmax w∗> x (k) + w∗> hdiag(s (k))Bx (k)
= w∗> x (k) + w∗> hdiag(s (k))Bx (k),
∗

where the last equality holds since λAmax = 1. Thus,
w∗> (x (k + 1) − x (k)) = w∗> hdiag(s (k))Bx (k) ≥ 0,
20

k
which contradicts that limk→∞ x(k) = 0n . Therefore, there exists a k̄ such that λA
max < 1 for all
k ≥ k̄.
Ak
k
6) Since, by 5), there exists a k̄ such that λA
max < 1 for all k ≥ k̄, and we know that λmax =
ρ(Ak ) ≥ 0 by Assumption 1, we have

kx(k + 1)k
kAk x(k)k
k
=
= λA
max < 1.
k→∞
kx(k)k
kx(k)k
lim

(22)

Therefore, for k ≥ k̄, x(k) converges linearly to 0n .
k
Further, if limk→∞ si (k) = 0 and hγi = 1 for all i ∈ [n], there exists k̄¯, such that λA
max = 0.
¯
Therefore, by (22), xi (k) converges superlinearly to 0 for all k ≥ k̄ .

21

