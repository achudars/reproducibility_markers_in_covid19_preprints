Assessing Vaccine Durability in Randomized Trials
Following Placebo Crossover
Jonathan Fintzi and Dean Follmann,
Biostatistics Research Branch, National Institute of Allergy and Infectious Diseases
Rockville, Maryland, U.S.A.
email addresses: jon.fintzi@nih.gov and dean.follmann@nih.gov

arXiv:2101.01295v4 [stat.AP] 5 Apr 2021

Abstract
Randomized vaccine trials are used to assess vaccine efficacy and to characterize the
durability of vaccine induced protection. If efficacy is demonstrated, the treatment of
placebo volunteers becomes an issue. For COVID-19 vaccine trials, there is broad consensus that placebo volunteers should be offered a vaccine once efficacy has been established.
This will likely lead to most placebo volunteers crossing over to the vaccine arm, thus
complicating the assessment of long term durability. We show how to analyze durability
following placebo crossover and demonstrate that the vaccine efficacy profile that would
be observed in a placebo controlled trial is recoverable in a trial with placebo crossover.
This result holds no matter when the crossover occurs and with no assumptions about
the form of the efficacy profile. We only require that the vaccine efficacy profile applies
to the newly vaccinated irrespective of the timing of vaccination. We develop different
methods to estimate efficacy within the context of a proportional hazards regression model
and explore via simulation the implications of placebo crossover for estimation of vaccine
efficacy under different efficacy dynamics and study designs. We apply our methods to
simulated COVID-19 vaccine trials with durable and waning vaccine efficacy and a total
follow-up of two years.

Keywords: COVID-19, Proportional hazards regression, Vaccine efficacy, Vaccine trial design.

1

1

Introduction

Randomized phase III clinical trials are used to definitively demonstrate the efficacy of candidate vaccines. Volunteers are randomized to receive vaccine or a placebo and followed for a
period of time to assess whether the vaccine reduces the rate of disease acquisition. An important question in vaccine development is whether vaccine induced protection is durable. For
COVID-19 vaccines, questions surrounding vaccine durability are important as acquired immunity against seasonal and other coronaviruses ranges from six months to two years (Poland
et al., 2020, Choe et al., 2020). Clinical trials for vaccines against COVID-19 plan to follow
participants for up to two years (Moderna, 2020).
To assess long term safety and durability, long term blinded follow-up of the original placebo
and vaccine arms is ideal (World Health Organization, 2020). From an ethical perspective,
placebo volunteers should be offered a vaccine once efficacy is established (Wendler et al.,
2020). However, vaccination of placebo volunteers may occur before it is known whether vaccine
induced protection is durable. Besides waning of efficacy, there is concern that the vaccine
might eventually cause harm, i.e. negative vaccine efficacy, in subgroups. Such harm is known
as vaccine associated enhanced disease (VAED) and has been observed in other contexts, such
as the Dengvaxia vaccine in seronegative individuals (Sridhar et al., 2018).
It might seem that the ability to assess vaccine durability following placebo crossover is
completely lost once there is no longer an unvaccinated control group (World Health Organization, 2020). However, at the point of crossover the study remains a randomized trial, albeit
of immediate vs deferred vaccination. This contrast allows the vaccine efficacy (VE) profile for
a standard non-crossover trial to be recovered with placebo crossover (Follmann et al., 2020).
The only additional assumption that is required is that the same VE profile applies to the newly
vaccinated irrespective of the timing of vaccination e.g. June or December.
Crossover trials for absorbing endpoints, such as infection or death, have been discussed
in the literature (Nason and Follmann, 2010, Makubate and Senn, 2010). However, these
methods apply to estimation of a intervention effect that stops once the intervention is removed.
Vaccination is different as the benefit lingers and our goal is to see how the intervention effect
varies with time. Crossover has been discussed for vaccine trials, but only for the placebo
arm and only to measure immune response (Follmann, 2006). Delayed vaccination has been
used in an Ebola vaccine trial, but to serve as control group prior to deferred vaccination
(Henao-Restrepo et al., 2017).
We establish that vaccine durability can be accurately assessed following placebo crossover
under fairly mild assumptions. We demonstrate how to estimate VE as a function of time since
vaccination under placebo crossover using proportional hazards (PH) regression (Cox, 1972)
where VE, defined as as 1 minus the hazard ratio (HR), is allowed to depend on time through
use of time-varying covariates (Therneau and Grambsch, 2013). We specify log-linear and Pspline functions to allow for a variety of shapes for the VE profile and provide a justification for
using calendar time as the natural timescale in vaccine trials where risk can vary substantially
with calendar time. We discuss and evaluate different approaches for crossing over placebo
participants, and estimation is affected by the timing and pace of crossover, and unobservable
heterogeneity in risk. We evaluate our methods by simulation and analyze two simulated
COVID-19 vaccine trials that vaccinate placebo volunteers after efficacy is established.

2

2
2.1

Vaccine Efficacy Under Placebo Crossover
Conceptual Development

Consider a vaccine trial where volunteers are randomized to receive vaccine or placebo. For
now, assume that everyone is enrolled at the same time, so calendar time and time since
randomization are aligned. All participants are followed over the period [0, 2τ ], and a blinded
crossover occurs at time τ , at which point the volunteers randomized to vaccine receive placebo,
and the volunteers randomized to placebo receive vaccine. Following crossover, both arms are
vaccinated and thus comparative efficacy might seem lost as there is no control group. However,
a randomized trial remains, though now as a trial of immediate vs deferred vaccination; these
assignments correspond to the original vaccine and placebo arms. This ’rebranded’ randomized
trial can still provide information about vaccine durability, even after the point of crossover.
To illustrate, suppose we have case counts for the two randomization arms over the two
periods, (0, τ ] and (τ, 2τ ]. Suppose that the vaccine:placebo case split is 20:100 in period
one, and in period two we observe a case split of 20:12 in the original vaccine arm:deferred
vaccination arm. Using a person-time analysis, and imagining the denominators are so large
d
that they cancel out, we obtain a simple estimate of the period one VE as V
E 1 = 1 − 20/100 =
0.80. Assume now that this VE applies to the newly vaccinated participants in the second
period with 12 cases. With this assumption we can estimate N2plac , the number of cases for a
ˆ
counterfactual placebo group in period two, as we are assuming 0.80 = 1 − 12/N2plac , which
yields N2plac = 12/.2 = 60. We then contrast the counterfactual placebo case count of 60 to the
20 observed cases in the original vaccine arm to obtain an estimate of placebo controlled VE in
d
period two, V
E 2 = 1 − 20/60 = 0.667. Based on these crude estimates, we conclude that VE
has waned as efficacy has dropped from 80% in period one to 66.7% in period two.
The crux of this example is that the VE among the newly vaccinated is portable across
periods. That is, the original placebo arm receives the same immediate benefit from vaccination that the original vaccine group received, regardless of changes in the population attack
rate. Additional considerations for a period focused approach are discussed in Follmann, et
al. (2020)Follmann et al. (2020). While a period focused approach is simple and clear, a more
natural development allows VE to vary smoothly with time. The Cox proportional hazards
(PH) model allows this to be easily accomplished. Under the PH model, the baseline placebo
hazard function for the time to disease is arbitrary and the effect of vaccination induces a hazard proportional to the baseline hazard. We can formulate the hazard function corresponding
to the previous example for a standard trial with no crossover as
h(t) = h0 (t) exp{ZI{t < τ }θ1 + ZI{t ≥ τ }θ2 },

(1)

where t is time since randomization, h0 (t) is the placebo hazard function, and Z is the vaccine
assignment indicator. Vaccine efficacy is defined as the relative change in the instantaneous
risk of acquiring disease, and is given by 1 − exp(θ1 ) for period one and 1 − exp(θ2 ) for period
two.
Suppose placebo volunteers are vaccinated at the end of period one. Assuming the vaccine
effect for the newly vaccinated applies in period two, we can write
h(t) = h0 (t) exp{ZI{t < τ }θ1 + ZI{t ≥ τ }θ2 + (1 − Z)I{t ≥ τ }θ1 }
= λ0 (t) exp{ZI{t < τ }θ1 + ZI{t ≥ τ }θ2 },

3

where the baseline hazard λ0 (t) = h0 (t) exp{I{t ≥ τ }θ1 } applies to the original placebo arm for
both periods. The first line parameterizes the placebo controlled VE for the newly vaccinated
in period two as 1 − exp(θ1 ) and the VE for the original vaccinees in period two as 1 − exp(θ2 ).
Analogous to the simple example where we recovered the placebo case count N2plac after time
τ , here we can recover the counterfactual placebo hazard function h0 (t) for t ≥ τ as h0 (t) =
λ0 (t) exp(−θ1 ).
Equation (1) is deceptively simple. Generalizations of this idea allow us to recover an arbitrary placebo controlled VE curve long after the placebo group has been completely vaccinated
and with no assumptions about the baseline hazard function for an actual or counterfactual
placebo arm. To illustrate, suppose that the placebo controlled hazard is given by a log-linear
function of time.
h(t) = h0 (t) exp{Z(θ1 + θ2 t)}
(2)
If crossover to vaccine occurs at time τ in the placebo arm, the resultant hazard is
h(t) = h0 (t) exp {Z(θ1 + θ2 t) + (1 − Z)I{t ≥ τ }(θ1 + θ2 (t − τ ))} .
= λ0 (t) exp {Zθ2 t + (1 − Z)I{t ≥ τ }θ2 (t − τ )} .

(3)

where λ0 (t) = h0 (t) exp(I{t ≥ τ }θ1 ). A visualization of this hazard function is given in Figure
1.
To better understand what happens in terms of estimation, suppose that an event occurs in
the original placebo arm at time t = s < τ , which is post randomization, but before crossover.
This scenario is illustrated in Figure 1. The partial likelihood contribution for this event under
model (3) reduces to
1
P
i∈R(s) exp{Zi (θ1 + θ2 s)}
where R(s) is the set of indices for volunteers who remain event free at time s. Thus events prior
to τ allow estimation of θ2 and, crucially, θ1 . Next suppose an event occurs at time t = τ + s
post randomization to an individual in the original placebo arm who was vaccinated at time τ
and who now has been vaccinated for s days (Figure 1). The partial likelihood contribution for
this event is
exp(θ2 s)
P
.
i∈R(τ +s) exp{Zi (τ + s)θ2 + (1 − Zi )sθ2 }
We see that θ1 is gone as the baseline hazard, λ0 (τ + s) = h0 (τ + s) exp(θ1 ), cancels out of
the numerator and denominator. Thus the pre-crossover period completely determines the
reliability of the estimate of θ1 . As a result, longer pre-crossover periods with more events are
desirable to better estimate θ1 Additionally, as τ approaches zero, the covariate value for the
original vaccine arm (τ + s) is very close to the covariate value for the original placebo arm
s. Insufficient variation in covariate values makes estimation of the associated regression slope
more difficult. Thus the benefit of a longer pre-crossover period persists in estimation of θ2 .
in addition to helping to estimate θ1 . We note that there is nothing really special about this
kind of cancellation. Consider a Cox regression with two covariates; a treatment indicator and
a sex indicator. Even if all the women eventually dropout or have events, we continue to accrue
information about the effect of treatment, provided we still have men at risk.

2.2

General Development

We now develop this approach for the more realistic setting of a staggered entry trial and consider more general models for VE over time. Let t ≥ 0 now index time since study initiation, not
4

Placebo
crossover

log hazard

Participant j
(Vaccine arm)

V E(s)

V E(s)
Participant i
(Placebo arm)

0

s

τ

τ +s

Time

Figure 1: Log hazard for two study participants: i, who is initially given placebo (orange
line), and j who is initially given vaccine (green line). Vaccine efficacy wanes (i.e. log hazard
increases) as a function of time since vaccination. At time τ , participant i is given vaccine and
follows the same efficacy profile as participant j. The ’baseline’ hazard function for original
placebo participant i is λ0 (t) = h0 (t) prior to crossover and λ0 (t) = h0 (t) exp{θ1 + θ2 (t − τ )}
after crossover. In this figure, h0 (t) is constant, but this is not required.

5



(e)
(v)
time since randomization. For each subject, i, i ∈ 1, . . . , N , the data, τi , τi , Ti , Ci , Zi , Xi ,
(e)

(v)

(v)

(e)

consist of the times of study entry and vaccination, τi and τi , with τi ≥ τi > 0,, the time
to symptomatic COVID-19 or end-of-followup, Ti = min(Yi , Ci ) with Yi the true but possibly
unobserved event time, treatment assignment Zi , and baseline covariates Xi . By convention,
(v)
we take τi to be greater than the study duration if disease occurs prior to vaccination. We
(v)
also define a time-dependent vaccination indicator, Zi (t) = I{t > τi }.
The hazard for participant i is
(
(e)
0
, t ≤ τi ,
h


i
hi (t) =
(4)
(v)
(e)
h0 (t) exp Zi (t)f t − τi ; θ + X 0 β , t > τi ,
where h0 (t) is the arbitrary ‘reference’ hazard for a placebo group, θ a vector of parameters
governing VE over time, X a vector of baseline covariates and β a vector of parameters. The
hazard is zero before an individual enters the trial by convention as the hazard function applies
to volunteers who are uninfected when randomized. We calculate VE at time s post–vaccination
as one minus the ratio of vaccine to placebo hazards, i.e.,
V E(s) = 1 − exp[f (s; θ)].
(v)

The model, (4), encompasses standard trials with parallel arms in which case τi = ∞ for
(e)
(v)
placebo volunteers and placebo-crossover trials in which case τi > τi for participants on the
placebo arm. Following crossover of all placebo subjects, Zi (t) = 1 for all study participants,
hence the hazard ratio for any pair of subjects with the same X is only depends on the contrast
in their times since vaccination:
(v)

exp{f (t − τi ; θ)}
hi (t)
=
.
(v)
hj (t)
exp{f (t − τj ; θ)}
This ratio is 1 for a constant VE model and so following crossover, there is no additional
information about a constant VE, just as there is no additional information about θ1 in the loglinear decay model. This differs from the standard parallel arms trial where such information
accrues throughout follow-up.
While it is standard to have the time index for the Cox model be time since randomization,
calendar time is a more natural index for the Cox model as specified in (4) for trials where
risk can wax and wane over time. In our setting, aligning the data on study entry induces
non-proportional hazards and distorts the risk set in the Cox partial likelihood at each event
time. These phenomena are diagrammed in Figure 2.
Suppose participant i acquires disease at calendar time ti after being on study for a period
(e)
si = ti − τi (Panels A and B) and we use model (4) with calendar time index (Panel C).
Setting aside baseline covariates, the partial likelihood contribution at calendar time ti is
(v)

h0 (ti ) exp{Zi (ti )f (ti − τi ; θ)}
P

(v)

j∈R(ti )

h0 (ti ) exp{Zj (ti )f (ti − τj ; θ)}

and the baseline hazards cancel out as they should.
Now, suppose we align participants on their times of study entry. The event of person i at
e i ). The calendar
calendar time ti is at study time si and the associated study time risk set is R(s
6

(A) Participant histories, calendar time

(B) Participant histories, time on study

k

k

j

j

i

i

ti

Calendar time

si

Time on study

(D) Baseline hazard, time on study

Baseline hazard

Baseline hazard

(C) Baseline hazard, calendar time

Time on study

Calendar time

Figure 2: Participant histories and baseline hazards when the data are indexed in calendar time
or aligned on times of study entry. The true data generating mechanism is indexed in calendar
time. (A) vs. (B): Aligning the data on study entry changes the risk set as k falls out of the
risk set at i’s event time and j is incorrectly introduced into the risk set. (C) vs. (D): Baseline
hazards are no longer proportional after the data are aligned on study entry.

7

(e)

time for participant i is ti = si +τi , whereas for a generic participant j it is a different calendar
(e)
time tj = si + τj . Since the hazard truly depends on calendar time, the partial likelihood
contribution at study time si is
P

h0 (τie + si ) exp{Zi (τie + si )f (s∗i (si ); θ)}
e
e
∗
j∈R̃(si ) h0 (τj + si ) exp{Zj (τj + sj )f (sj (si ); θ)}

where s∗j (si ) is the time since vaccination at study time si for person j. With alignment on time
since study entry, the baseline hazards do not cancel out and a partial likelihood contribution
which assumes they do will be misspecified.

2.3

Flexible Models for VE(s)

The log-linear and piecewise-constant forms of VE(s) discussed above are simple and useful
to understand behavior of the model and estimation. However, the form of waning vaccine
efficacy can be hard to anticipate for new vaccines and high constant efficacy followed by a
quick or smooth decay is possible as are other shapes. It is thus appealing to model f (·)
semi-parametrically e.g. using penalized cubic P-splines (Eilers and Marx, 1996, Wood, 2017,
Perperoglou et al., 2019). Let PL (t; k, δ) denote a P-spline basis of degree δ = 3 with L basis
terms and vector of knot locations k, and let γ be a vector of coefficients, with γ0 reserved for
the log-hazard ratio immediately following vaccination. The hazard for participant i is
(
(e)
0
, t ≤ τi ,


P
(5)
hi (t) =
(e)
(v)
h0 (t) exp Zi (t){γ0 + L`=1 γ` P` (t − τi ; k, δ)} , t > τi .
In practice, we center the decay component estimated by the P-spline at zero to ensure identifiability of γ0 . Note that we need to evaluate the hazard for each participant at every event time,
not merely at the time when a person experiences their own event (Therneau et al., 2017).
Splines can be implemented in the SAS procedure PROC PHREG and in R using the survival
package (Therneau, 2020). The latter provides users with a convenient summary method for
the linear and non–linear spline effects, which is useful for testing for non-linearity in the decay
profile.

2.4

Crossing Over

Our development up to now has implicitly started counting cases immediately after the first
dose of vaccine. In practice vaccine trials often use a per-protocol primary analysis that forgoes counting disease cases until after the immunization schedule is complete, e.g. seven days
following the last dose. Such an analysis better evaluates the full benefit of immunization. For
such analyses, we need to symmetrically avoid counting cases in both arms during the second
immunization period even if it is counterfactual, that is if volunteers randomized to vaccine
are unblinded and not immunized. To achieve this symmetry, a ‘blackout’ period of length
∆ can be defined by the hazard function h(t){1 − I(t ∈ [τ (x) , τ (x) + ∆]}, where τ (x) is the
start of the crossover or unblinding for an individual, and ∆ the time from first dose to when
cases are counted. The consequence is to define discontinuous pre and post crossover risk intervals for volunteers who complete crossover without having an event. Volunteers who have an
event before or during crossover have a single risk interval which ends in an event or censoring,
respectively.
8

Placebo crossover might happen in a blinded or unblinded (open label) manner. Blinded
crossover is preferred to avoid potentially differential risk behavior as the recently unblinded
volunteers originally randomized to vaccine, who now know they are protected, might forgo risk
avoidance behavior Follmann et al. (2020). With open label crossover such differential behavior
could cause a spurious waning efficacy in the period immediately following unblinding. One
complex approach to address potential bias from unblinded crossover would be to use covariate
adjustment and stratification. Let X denote a vector of covariates measured at baseline, or pre
or post unblinding that predict risk behavior. While clinical trials typically avoid use of postbaseline variables for adjustments, in the open label setting such adjustment may ameliorate
bias. Once an individual is unblinded, a new hazard function applies. We illustrate using
log-linear decay:

h∗ (t) = λ∗0 (t) exp θ2 (t − τ (v) ) + X 0 β ,
(6)
where λ∗0 (t) is the new baseline hazard for the original placebo arm in this new open label milieu.
Because crossover of all subjects cannot occur at the same time, there will be a crossover
interlude during which the placebo volunteers become vaccinated. Thus, at calendar time t
during the crossover interlude, the expanding unblinded cohort would use hazard h∗ (t) given
by (6) while the dwindling blinded cohort would use hazard h(t) given by (2). Following the
crossover interlude (6) would apply to all and at some point, the term exp(Xβ) might not
be needed if the volunteers in the two arms behave similarly. This construction is a form of
time-dependent stratification.
A simpler way to address open label crossover bias is to define a blackout period of length
∆∗ such that behavior is presumed to be similar after the end of the period. Similarity should
happen at some point as all trial volunteers will know they are vaccinated and protected. As
above, time dependent stratification would make sense with different baseline hazards before
unblinding and after the crossover blackout period. To be specific, for the log-linear decay
model we would have h(t) = λ0 (t) exp{Z(t)[θ1 + θ2 (t − τ (v) )]} prior to unblinding and h∗ (t) =
λ∗0 (t) exp{θ2 (t − τ (v) )} at time ∆∗ post unblinding.
If the VE dropped substantially during a black-out period, later estimates of VE might be
compromised. As an extreme example, suppose all volunteers enroll at the same time, and
all are blacked out during τ, τ + ∆∗ which is exactly when VE drops. Then the estimated
VE curve pre- and post-crossover would incorrectly appear constant. In practice this scenario
can be avoided with a staggered entry trial by exploiting the induced variation in time since
vaccination at any calendar time. To illustrate what not to do, suppose that enrollment took 2
months, crossover took 2 months and the crossover order was in exact sync with the enrollment
order. Then all would be crossed over at some time τ since randomization and all blacked out
for the period τ, τ + ∆∗ . To minimize the problem, crossover could occur in reverse order with
the first enrollees being crossed over last. Logistical considerations and placebo volunteers’
sense of fairness could also come into play.

3

Assumptions

To recover a VE curve under a standard trial with no crossover requires that the volunteers in
each arm remain similar over time and that the external environment remain similar over time.
• Volunteers in each arm remain similar over time. This can be violated if there is differential dropout in the two arms and dropout is related to underlying risk of disease.
Relatedly, unobserved heterogeneity in risk can result in differential culling by infection
9

of the vaccine and placebo groups. Thus after a while, the remaining placebo arm volunteers tend to be a less risky group than the remaining vaccine arm volunteers and VE
can appear to decrease, see Lipsitch (2019), Durham et al. (1998), Aalen et al. (2015).
COVID-19 trials with 30,000 or more enrolled and perhaps 200-1000 cases over follow-up,
such bias may be small. Of course one can can explicitly model the heterogeneity (Kanaan
and Farrington, 2002). Such methods are beyond the scope of this paper. In practice,
covariate adjustment for baseline risk factors can be used to mitigate this assumption.
• Study environment similar. The proportional hazards model allows for the attack rate
to change with time. But if the pathogen mutates to a form that is resistant to vaccine
effects, efficacy may appear to wane. Another possibility is if human behavior changes in
such a way that the vaccine is less effective. For example, if there is less mask wearing in
the community over the study, the viral inoculum at infection may increase over the study
and overwhelm the immune response for later cases. Vaccines may work less well against
larger inoculums and thus VE might appear to wane. For viral mutation, analyses could
be run separately for different major strains provided they occur both prior and post
crossover. More elaborate methods could also be developed to address viral mutation,
but are beyond the scope of this paper.
The only additional assumption that is required to recover the VE profile under placebo
crossover is that the effect of vaccination be the same no matter when the vaccine is given.
Interestingly, this is a common assumption; for vaccine trials with staggered entry it is implicitly
assumed that the VE for early enrollees is the same as for the late enrollees. Importantly, both
standard and crossover designs allow for a varying attack rate through the arbitrary hazard
h0 (t) whether due to seasonality, vaccination coverage, or other reasons.

4

Simulated COVID-19 Trials

In this section, we explore how placebo crossover, the dynamics of durability, and the baseline
hazard affect our estimates of vaccine efficacy and durability. Since several COVID-19 vaccine
trials are powered to accrue 150 cases and follow all volunteers for two years, we evaluate three
different designs: i) crossover at 150 cases, ii)crossover at 1 year and iii) a standard parallel
arm trial (Moderna, 2020). We consider two settings for vaccine dynamics: constant VE of
75%, and VE waning linearly on the log-hazard scale from 85% to 35% over 1.5 years. In
the crossover scenarios, placebo arm volunteers cross over during a four week interlude. For
each of the six settings we simulated 10,000 trials. Each trial enrolled 3,000 participants in a
1:1 randomization with linear accrual of participants over an initial three month period and
followed participants for two years post enrollment. While COVID-19 trials are larger, we
evaluated 3,000 participants to lessen our computational burden. The baseline hazard was
piecewise-constant and calibrated to yield an average of 50, 75, 50, and 25 cases per three
month period in the placebo arm in the first year, and either the same or half the year one case
rates in the second study year. The data were analyzed in each simulation using the log-linear
decay model, (2), and the P-spline model, (5).
The simulations demonstrate that we can accurately estimate VE(s) and the change in
VE in all simulation settings using both the log-linear and P-spline model (Tables 1 and 4).
Coverage probabilities of 95% confidence intervals were near their nominal levels or somewhat
conservative. The P-spline model performs similarly to the log-linear model except for the
10

estimates at year two where the variance becomes notably larger. Initiating crossover at one
year resulted in an average accrual of 44% more cases prior to crossover compared with trials
that initiated crossover at 150 cases. We found that this improved the precision of our estimates
for all quantities of interest. One way to quantify the relative performance of placebo crossover
and parallel arm trials is by the ratio of empirical variances. We focus on the empirical variances
of estimates of the linear predictor in the log-linear model in the constant VE(s) setting in Table
c
1. The cross at 150:cross at one year variance ratios for VE(s)
are 0.051/0.029=1.8, 2.4, 2.5,
and 2.4 at 0.5, 1, 1.5, and two years. This underscores the potential benefit of additional case
accrual during the pre-crossover period leading into the second year when the baseline hazard
was halved. We next compare the crossover at one year design to a standard parallel trial using
the log-linear model. This comparison is more of a benchmark as a standard trial is may not be
ethically possible following vaccine approval. The analogous empirical variance ratios for cross
at one year compared to a standard trial are 0.029/0.022=1.3, 2.5, 2.3 and 2.0 respectively.
Results are broadly similar for the P-spline model and for waning VE.
In Tables 2 and 5 we provide estimates of the intercept and linear trend of the VE profile for
the scenarios where the baseline hazards was the same or halved in year two, respectively. All
estimates have negligible bias and good coverage. For the constant VE scenario and log-linear
model, the variance ratios for cross at 150 cases and cross at one year are 0.051/0.040=1.3 and
0.192/0.084=2.3 for the intercept and slope, respectively. Thus there is a big advantage in slope
estimation with delayed crossover. When we compare crossover at one year to a standard trial,
the variance ratios are .040/.052=0.8 and .087/.065=1.3 respectively. Interestingly, crossover
improves the intercept estimate as during the crossover interlude, the newly vaccinated placebo
volunteers contribute additional information about the intercept. The P-spline and log-linear
model have similar empirical variances for the slope but the log-linear model has about half
the empirical variance of the P-spline model for the intercept. Finally, for the constant VE
scenario we compared the intercept estimates to a constant VE model (top half of Table 2).
Under crossover, the empirical variance was modestly improved under this model compared to
the log-linear model. Conclusions are broadly similar for the waning VE scenario.

4.1

Crossover Interlude

A design question is how estimation efficiency varies with the length of the crossover interlude.
To explore this design question, we did additional simulations where we evaluated a standard
parallel trial of two years, a trial where all placebo participants are crossed over at one year,
and a trial where the times of vaccination for all volunteers were uniformly distributed over two
years. The baseline hazard was constant over the two year period. Under the constant VE(s)
scenario, the empirical variances for the intercept term were 0.051, 0.035, 0.031, respectively
while the variances for the slope were 0.039, 0.039, and 0.034 respectively (Table 6). This
suggests a longer crossover interlude is somewhat better for estimation of the intercept and the
slope.

4.2

Unobserved Heterogeneity in Risk

Unobserved heterogeneity in the risk of disease can lead to bias in estimates of VE(s) and
complicate the task of separating time-varying efficacy from increased removal of the riskier
individuals from the placebo arm (Balan and Putter, 2020). We simulated placebo crossover
and parallel arm trials with 30,000 participants and gamma distributed frailties with mean
11

log(1 − V E(s))
Design

Model

Time

log(1 − V E(s)) − log(1 − V E(0))

Bias

Emp. Var.

Covg.

Bias

Emp. Var.

Covg.

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

-0.013
-0.011
-0.009
-0.007
-0.016
-0.017
-0.014
-0.015

0.051
0.146
0.338
0.626
0.067
0.194
0.369
0.951

0.948
0.951
0.953
0.953
0.967
0.965
0.958
0.974

0.002
0.004
0.006
0.008
0.006
0.004
0.008
0.006

0.048
0.192
0.433
0.769
0.142
0.288
0.460
1.043

0.952
0.952
0.952
0.952
0.971
0.959
0.956
0.972

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

-0.009
-0.009
-0.008
-0.007
-0.013
-0.014
-0.010
-0.024

0.029
0.061
0.137
0.256
0.041
0.084
0.160
0.671

0.949
0.953
0.952
0.953
0.982
0.976
0.969
0.987

0.001
0.001
0.002
0.002
0.005
0.004
0.008
-0.006

0.022
0.087
0.195
0.347
0.146
0.178
0.240
0.786

0.953
0.953
0.953
0.953
0.978
0.969
0.972
0.983

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

-0.010
-0.010
-0.011
-0.011
-0.012
-0.013
-0.024
-0.071

0.022
0.024
0.059
0.125
0.039
0.056
0.073
0.447

0.948
0.951
0.949
0.949
0.981
0.981
0.980
0.981

-0.001
-0.001
-0.002
-0.002
0.014
0.012
0.002
-0.045

0.016
0.065
0.145
0.258
0.173
0.208
0.194
0.560

0.952
0.952
0.952
0.952
0.979
0.967
0.974
0.981

True vaccine efficacy constant at 75%
Cross at 150 cases
τx = 0.6 ± 0.05

log-linear

P-spline

Cross at 1 year
Nx = 216 ± 13

log-linear

P-spline

Parallel trial

log-linear

P-spline

Vaccine efficacy wanes from 85% to 35% over 1.5 years
Cross at 150 cases
τx = 0.63 ± 0.05

log-linear

P-spline

Cross at 1 year
Nx = 211 ± 13

log-linear

P-spline

Parallel trial

log-linear

P-spline

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

-0.014
-0.010
-0.007
-0.004
-0.015
-0.008
0.000
0.005

0.051
0.108
0.225
0.405
0.067
0.162
0.247
0.475

0.951
0.951
0.951
0.950
0.964
0.965
0.960
0.962

0.003
0.007
0.010
0.014
0.011
0.018
0.027
0.031

0.031
0.123
0.276
0.491
0.143
0.277
0.359
0.587

0.953
0.953
0.953
0.953
0.977
0.964
0.960
0.962

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

-0.010
-0.006
-0.001
0.003
-0.013
-0.005
0.008
0.016

0.031
0.053
0.107
0.195
0.039
0.072
0.119
0.352

0.950
0.952
0.950
0.951
0.976
0.973
0.966
0.977

0.004
0.008
0.013
0.017
0.014
0.022
0.035
0.043

0.017
0.066
0.149
0.265
0.142
0.182
0.208
0.469

0.949
0.949
0.949
0.949
0.983
0.970
0.973
0.976

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

-0.010
-0.006
-0.002
0.002
-0.012
-0.007
-0.004
-0.006

0.024
0.016
0.031
0.071
0.036
0.038
0.039
0.203

0.948
0.946
0.951
0.950
0.982
0.983
0.980
0.979

0.004
0.008
0.012
0.015
0.022
0.027
0.030
0.028

0.012
0.048
0.107
0.191
0.164
0.213
0.182
0.337

0.951
0.951
0.951
0.951
0.984
0.970
0.975
0.976

Table 1: Bias, empirical variance, and coverage for the linear predictor in Cox PH models with
time-varying VE in simulated trials where the baseline hazard in year two was half the baseline
hazard in year one. The log-linear and P-spline models correspond to (2) and (5), respectively.
The average time of crossover (in years), τx , and the average number of events at crossover, Nx ,
along with standard deviations beneath the crossover grouping in the design column. Time is
12
given in years since study initiation.

Intercept

Vaccine efficacy constant at 75%
Cross at 150 cases Constant VE
log-linear
P-spline
Cross at 1 year
Constant VE
log-linear
P-spline
Parallel trial
Constant VE
log-linear
P-spline
Vaccine efficacy wanes from 85%
Cross at 150 cases log-linear
P-spline
Cross at 1 year
log-linear
P-spline
Parallel trial
log-linear
P-spline

Linear trend

Bias

Emp. Var.

Covg.

Bias

Emp. Var.

Covg.

-0.012
-0.015
-0.022
-0.008
-0.010
-0.018
-0.005
-0.009
-0.026

0.039
0.051
0.086
0.028
0.040
0.104
0.018
0.052
0.126

0.952
0.951
0.973
0.950
0.950
0.978
0.949
0.951
0.974

—
0.004
0.005
—
0.001
0.001
—
-0.001
0.006

—
0.192
0.188
—
0.087
0.084
—
0.065
0.063

—
0.952
0.956
—
0.953
0.959
—
0.952
0.955

0.951
0.975
0.952
0.981
0.950
0.978

0.007
-0.002
0.008
-0.003
0.008
0.003

0.123
0.121
0.066
0.065
0.048
0.047

0.953
0.955
0.949
0.951
0.951
0.952

to 35% over 1.5 years
-0.017
0.056
-0.027
0.102
-0.014
0.043
-0.027
0.116
-0.014
0.057
-0.034
0.145

Table 2: Empirical variance and coverage for estimates of the intercept and linear trend in
vaccine efficacy under the log–linear model, (2), and semi–parametric model, (5). Here, the
time–varying baseline hazard in year two was half the baseline hazard in year one.
one, and variance equal to either one or four. Crossover trials initiated vaccination of the
placebo arm at one year. The baseline hazard was constant and calibrated to yield either
50 or 300 cases per six month period on the placebo arm, and VE(s) was either constant or
waned linearly on the log hazard scale, as before. The frailty distributions in the original
placebo and vaccine arms at the end of followup were more similar in the placebo crossover
trials than in the standard parallel trials (Table 8). In the low baseline hazard scenario, where
the dominant contribution to a participant’s propensity for disease was their underlying frailty,
placebo crossover trials yielded less biased estimates of VE(s) relative to the standard parallel
design (Tables 9 and 10). Higher baseline hazards resulted in more differential culling of the risk
set and increased bias in estimates of VE(s). In the high baseline hazard scenario, the common
baseline hazard dominated heterogeneity in the frailty distribution, and in this setting the bias
in VE(s) estimates under placebo crossover was comparable to the bias that was observed with
parallel trials. However, the absolute bias was modest. Under a constant VE of 75%, the
estimates at two years were about 70% on average under either design. This scenario with a
variance of four had substantial heterogeneity in the risk of disease with the riskiest 1% in the
placebo arm having a median probability of disease over two years of 0.60. The least risky
1% had a median probability of 1 × 10−10 . In practice, we could mitigate biases resulting
from heterogeneity in the frailty distribution by adjusting for known risk factors of disease and
stratifying our analyses by site or geographic region.

13

5

Analysis of Two Simulated Trials

In this section, we present detailed analyses of two simulated COVID-19 vaccine trials where
the true VE profile was either constant at 75% or waned linearly on the log–hazard scale from
85% to 35% over 1.5 years. Each trial enrolled 30,000 participants with linear accrual over three
months in a 1:1 randomization to vaccine or placebo. The baseline attack rate was piecewise
constant with changepoints every three months, and was calibrated to yield 50, 75, 50, and
25 cases on the placebo arm in each period in the first year, and half the expected number of
cases per period on the placebo arm in year two. In this example, interim analyses are planned
at 150 cases, which ultimately result in crossover at the end of year one following evaluation
and vetting of the efficacy by a regulatory agency. Placebo crossover occurs over a four week
period. Each volunteer was followed for a total of two years.
The two simulated trials are summarized in Table 3. In the constant VE scenario, the trial
reached 150 cases in 222 days, and recorded 223 events by the one year crossover time–point
and 273 events, overall. In the waning VE scenario, the trial reached 150 cases in 242 days, and
recorded 199 events by the one year crossover time–point and 292 events, overall. The case split
across treatment arms declined from roughly 83% on the placebo arm at the 150 case interim
look to 76.2% at the completion of the study in the constant VE scenario, and from 82% to
65.2% in the waning VE scenario. The overall VE estimate at the one year crossover, estimated
using a proportional hazards model without adjustment for time since vaccination, was 76.6%
(95% CI: 67.2%, 83.3%) in the constant VE(s) case and 80.1% (95% CI: 71.0%, 86.3%) in the
waning VE(s) scenario (the true geometric mean VE(s) to one year post–vaccination is 75.6%).
Point estimates for VE(0) and the linear trend in log VE(s) from the log–linear and Pspline models were close in both scenarios, although confidence intervals in the P-spline models
were wider. The estimated efficacy profiles obtained with both methods were in agreement
and recovered the true VE profile (Figure 3). The P-spline estimates had wider point-wise
confidence intervals, but the inflation in the variance appears to be fairly modest for the period
spanning the end of study enrollment through, roughly, year 1.5 post–vaccination. In practice,
both the log–linear decay model and the P-spline model could be used to test a hypothesis
of time–varying VE(s). This is straightforwardly carried out for the log–linear model via a
likelihood ratio test (LRT) for the slope parameter in (2) where the test statistic is compared
to a chi–square distribution with one degree of freedom. For the P-spline models, we perform
a likelihood ratio test for whether all of the P-spline basis coefficients are jointly equal to zero,
and compare the test statistic to a chi–square distribution with 3.1 degrees of freedom (the
effective degrees of freedom for the P-splines in our models). In the waning VE(s) scenario,
we resoundingly reject the null hypothesis of time-homogeneous VE(s), and fail to reject the
null in the constant VE(s) scenario (Table 3) at the end of two years of follow-up. The benefit
of an additional year of follow-up past crossover is substantial in terms of evaluating the long
term durability of the vaccine. Under the waning VE scenario, the p-value for testing the null
hypothesis of constant VE is close to 0.05 at one year and convincing at two years for both
the log-linear and P-spline models. These simulated examples show that for both the waning
and constant VE scenarios, accurate inference about the behavior of the VE over time can be
recovered.

14

Time of 150 case interim look
Case split by original arm
at interim look
at 1 year crossover
at 2 year follow-up
Estimates at interim look
log-linear model
Intercept
Linear trend
LRT for time-varying VE
P-spline model
Intercept
Linear trend
LRT for time-varying VE
Estimates at 1 year crossover
log-linear model
Intercept
Linear trend
LRT for time-varying VE
P-spline model
Intercept
Linear trend
LRT for time-varying VE
Estimates at 2 year follow-up
log-linear model
Intercept
Linear trend
LRT for time-varying VE
P-spline model
Intercept
Linear trend
LRT for time-varying VE

True VE Constant at 75%

True VE Wanes from 85% to 35%

Day 222

Day 242

Placebo = 124, Vaccine = 26
Placebo = 181, Vaccine = 42
Placebo = 208, Vaccine = 65

Placebo = 131, Vaccine = 19
Placebo = 166, Vaccine = 33
Placebo = 191, Vaccine = 101

-0.84 (95% CI: -1.6, -0.09)
-3.06 (95% CI: -6.05, -0.07)
0.039

-2.16 (95% CI: -3.17, -1.16)
0.81 (95% CI: -2.13, 3.75)
0.589

-1.41 (95% CI: -2.77, -0.05)
-3.02 (95% CI: -6.36, 0.32)
0.037

-2.43 (95% CI: -4.23, -0.62)
0.8 (95% CI: -2.13, 3.73)
0.605

-1.34 (95% CI: -1.98, -0.7)
-0.29 (95% CI: -1.74, 1.17)
0.698

-2.36 (95% CI: -3.17, -1.55)
1.8 (95% CI: 0.2, 3.4)
0.027

-1.14 (95% CI: -2.17, -0.1)
-0.28 (95% CI: -1.66, 1.1)
0.133

-2.26 (95% CI: -3.68, -0.83)
1.8 (95% CI: 0.22, 3.37)
0.054

-1.37 (95% CI: -1.77, -0.97)
-0.13 (95% CI: -0.7, 0.43)
0.641

-2.19 (95% CI: -2.62, -1.75)
1.33 (95% CI: 0.82, 1.83)
¡0.001

-1.33 (95% CI: -2.09, -0.58)
-0.13 (95% CI: -0.7, 0.44)
0.178

-2.26 (95% CI: -3.15, -1.36)
1.28 (95% CI: 0.77, 1.8)
¡0.001

Table 3: Summary of example trials simulated under constant and waning vaccine efficacy (VE)
at times of interim analysis and placebo crossover. The intercept and linear trend correspond
to the immediate effect of vaccination and the time–trend for VE(s) under model (2), and the
true values were set to θ1 = −1.39 and θ2 = 0 in the constant VE scenario, and θ1 = −1.9 and
θ2 = 0.98 in the waning VE setting. The likelihood ratio test (LRT) for waning VE compares
models (2) and (5) to a PH model without adjustment for time since vaccination.

15

Number of events by treatment arm
40
20
0
60

Waning VE

Number of events

Constant VE

60

40
20
0
(0, 0.25]

(0.25, 0.5] (0.5, 0.75]

(0.75, 1]

(1, 1.25]

(1.25, 1.5] (1.5, 1.75]

(1.75, 2]

Years since vaccination
Arm

Placebo

Delayed vaccination

Immediate vaccination

Vaccine efficacy vs. years since vaccination
log−linear

P−spline
Constant VE

0.6
0
1
0.9
0.6
0
−1.7

Waning VE

Vaccine efficacy

0.9

0.0

0.5

1.0

1.5

2.0 0.0

0.5

1.0

1.5

2.0

Years since vaccination
Figure 3: (Top) Number of events per quarter by arm. The delayed vaccination arm consists of
the original placebo participants after they have been crossed over. (Bottom) Vaccine efficacy
(VE) as a function of time since vaccination. Dashed lines are the true VE(s), solid curves and
ribbons are pointwise means and 95% confidence intervals.

16

6

Discussion

Knowing the durability of vaccine induced protection is a key question in vaccine development,
especially for COVID-19 vaccines. With placebo volunteers being offered vaccine before long
term follow-up has completed, it seems the ability to assess durability is lost. In this paper
we demonstrated that placebo controlled VE can be accurately assessed long after the placebo
group has disappeared. Our method is the familiar Cox proportional hazards model. To reflect
seasonal or outbreak variation in the attack rate, we used calendar time as the time index.
To recover different VE curves we specified flexible models for VE decay. If crossover occurs
quickly, the early VE(s) will remain poorly estimated, no matter how many post-crossover
cases occur which will impact later estimates of VE(s). Our results point out the advantages
of delaying crossover and longer crossover interludes to help improve the estimation. We also
provide suggestions on how to manage the crossover interlude, discuss how to perform perprotocol analyses, and discuss solutions for open label crossover where risk behavior might
increase for the recently unblinded vaccinees. While developing this approach we became aware
of two related methods that assess vaccine durability. Both use hazard function models with
calendar time as the index and consider the pre-crossover Lin et al. (2021) and both the pre
and postcrossover period Tsiatis and Davidian (2021). The latter focuses on methods when
crossover is open label and confounding an issue.
Future work could develop random effects or frailty type models. Such models seem especially suited for settings with a relatively high attack rate. Our work focused on the setting
where the disease event was continuously monitored. An important endpoint in vaccine trials is
seroconversion, or the development of antibodies to the pathogen of interest. Seroconversion is
typically measured rarely which results in an interval censored endpoint. The extension of these
methods to interval censored data will be important. Another potential generalization of these
methods is for observational data where methods could be developed that address confounding
of risk with vaccine uptake. Finally, an emerging issue in the context of COVID-19 is how to
estimate vaccine durability in the presence of emerging strains. This could be addressed within
a competing risks framework in which times to first acquiring disease due to different strains
are treated as competing events. The framework developed in this paper are easily extended to
this setting since our models could straightforwardly be applied to the sub-distribution hazards
in a competing risks model.

Acknowledgments
This work utilized the computational resources of the NIH HPC Biowulf computing cluster
(http://hpc.nih.gov). The authors would like to thank Keith Lumbard for help with simulations,
as well as Michael Fay, Anastasios Tsiatis, Danyu Lin, Peter Gilbert, Holly Janes, and Larry
Molton for helpful discussions regarding this work.

Supplementary Materials
Code demonstrating how to simulate data and reproduce the results presented in this manuscript
is made available in the following GitHub repository: https://github.com/fintzij/ve_
placebo_crossover. A minimal working example with R and SAS code is provided in the
appendix.
17

References
Odd O Aalen, Richard J Cook, and Kjetil Røysland. Does Cox analysis of a randomized survival
study yield a causal treatment effect? Lifetime Data Analysis, 21:579–593, 2015.
Theodor A Balan and Hein Putter. A tutorial on frailty models. Statistical Methods in Medical
Research, 29:3424–3454, 2020.
Pyoeng Gyun Choe, Chang Kyung Kang, Hyeon Jeong Suh, Jongtak Jung, Kyoung-Ho Song,
Ji Hwan Bang, Eu Suk Kim, Hong Bin Kim, Sang Won Park, Nam Joong Kim, et al.
Waning antibody responses in asymptomatic and symptomatic sars-cov-2 infection. Emerging
Infectious Diseases, 27:327–329, 2020.
David R Cox. Regression models and life-tables. Journal of the Royal Statistical Society: Series
B (Methodological), 34(2):187–202, 1972.
L Kathryn Durham, Ira M Longini Jr, M Elizabeth Halloran, John D Clemens, Nizam Azhar,
and Malla Rao. Estimation of vaccine efficacy in the presence of waning: application to
cholera vaccines. American Journal of Epidemiology, 147(10):948–959, 1998.
Paul HC Eilers and Brian D Marx. Flexible smoothing with b-splines and penalties. Statistical
Science, pages 89–102, 1996.
DA Follmann, J Fintzi, et al. Assessing durability of vaccine effect following blinded crossover
in COVID-19 vaccine efficacy trials. medRxiv, 2020.
Dean Follmann. Augmented designs to assess immune response in vaccine trials. Biometrics,
62(4):1161–1169, 2006.
Ana Maria Henao-Restrepo, Anton Camacho, Ira M Longini, Conall H Watson, W John
Edmunds, Matthias Egger, Miles W Carroll, Natalie E Dean, Ibrahima Diatta, Moussa
Doumbia, et al. Efficacy and effectiveness of an rvsv-vectored vaccine in preventing ebola
virus disease: final results from the guinea ring vaccination, open-label, cluster-randomised
trial (ebola ça suffit!). The Lancet, 389(10068):505–518, 2017.
Mona N Kanaan and C Paddy Farrington. Estimation of waning vaccine efficacy. Journal of
the American Statistical Association, 97(458):389–397, 2002.
Danyu Lin, Donglin Zeng, and Peter Gilbert. Evaluating the long-term efficacy of covid-19
vaccines. medRxiv, 2021.
Marc Lipsitch. Challenges of vaccine effectiveness and waning studies. Clinical Infectious
Diseases, 68:1631––1633, 2019.
Boikanyo Makubate and Stephen Senn. Planning and analysis of cross-over trials in infertility.
Statistics in Medicine, 29:3203–3210, 2010.
Moderna. A phase 3, randomized, stratified, observer-blind, placebo-controlled study to evaluate the efficacy, safety, and immunogenicity of mrna-1273 sars-cov-2 vaccine in adults
aged 18 years and older. https://www.modernatx.com/sites/default/files/mRNA-1273-P301Protocol.pdf. Access date Nov 17, 2020., 2020.

18

Martha Nason and Dean Follmann. Design and analysis of crossover trials for absorbing binary
endpoints. Biometrics, 66(3):958–965, 2010.
Aris Perperoglou, Willi Sauerbrei, Michal Abrahamowicz, and Matthias Schmid. A review of
spline function procedures in r. BMC Medical Research Methodology, 19, 2019.
Gregory A Poland, Inna G Ovsyannikova, and Richard B Kennedy. SARS-CoV-2 immunity:
Review and applications to phase 3 vaccine candidates. The Lancet, 2020.
Saranya Sridhar, Alexander Luedtke, Edith Langevin, Ming Zhu, Matthew Bonaparte, Tifany
Machabert, Stephen Savarino, Betzana Zambrano, Annick Moureau, Alena Khromava, et al.
Effect of dengue serostatus on dengue vaccine safety and efficacy. New England Journal of
Medicine, 379(4):327–340, 2018.
Terry Therneau, Cindy Crowson, and Elizabeth Atkinson. Using time dependent covariates
and time dependent coefficients in the cox model. Survival Vignettes, 2017.
Terry M Therneau.
A package for survival analysis in r.
project.org/package=survival, 2020. R package version 3.2-7.

https://CRAN.R-

Terry M Therneau and Patricia M Grambsch. Modeling survival data: Extending the Cox model.
Springer Science & Business Media, 2013.
Anastasios A Tsiatis and Marie Davidian. Estimating vaccine efficacy over time after a randomized study is unblinded. arXiv preprint arXiv:2102.13103, 2021.
David Wendler, Jorge Ochoa, Joseph Millum, Christine Grady, and Holly A Taylor. COVID-19
vaccine trial ethics once we have efficacious vaccines. Science, 2020.
Simon N Wood. Generalized additive models: an introduction with R. CRC press, 2017.
World Health Organization. Placebo-controlled trials of covid-19 vaccines—why we still need
them. New England Journal of Medicine, 2020.

19

A

Illustrative Computer Code

In this section we present a minimal example with SAS and R code to estimate a log-linear
waning efficacy curve. In this trial, a per-protocol analysis is used and disease cases are counted
starting 30 days after the first dose. Calendar time is relative to 1 January 2021, so the volunteer
depicted in the first row was dosed on 5 January 2021. Thus during the crossover period, cases
are not counted for 30 days. A blinded crossover is assumed so the same placebo baseline hazard
applies throughout the study without time-dependent stratification. If an open label crossover
were pursued, an additional ’stratum’ variable could be created that identified whether a risk
interval was blinded or open label. The ’stratum’ variable would then be used as a stratification
variable in the proportional hazards model.
We assume the data is arranged so that anyone who gets the crossover dose has both the
start and end date of crossover recorded and that if someone drops out or has an event before
the start of the crossover period the start and end date of crossover are missing.
Volunteers 1, 2, 6, and 7 are censored after crossover while Volunteer 4 has an event after
crossover. Volunteer 3 is censored before crossover while volunteers 5 and 8 have events before
crossover. Volunteers 9 and 10 enter the crossover interlude but have an event and dropout,
respectively, thus they are censored at the start of the crossover interlude.
The variables below are
id
arm
entry
Xstart
Xend
eveenttime
status

A.1

=
=
=
=
=
=
=

subject identfier
original randomization arm 1=vaccine 0=placebo
# of days from 01-Jan-2021 to 30 days past 1st dose
# of days from 01-Jan-2021 to crossover start
# of days from 01-Jan-2021 to 30 days post 1st crossover dose
# of days from 01-Jan-2021 to a disease event or censoring
1 if a disease event at eventtime 0 otherwise

SAS code

DATA new;
INPUT id arm entry Xstart Xend eventtime
CARDS;
1 0 35 65
95 370 0
2 1 45 80 110 400 0
3 0 55 .
. 150 0
4 1 60 170 200 310 1
5 0 65 .
.
80 1
6 1 80 190 210 410 0
7 0 85 215 245 420 0
8 1 70
.
. 90 1
9 0 58 160 190 180 1
10 1 71 160 190 166 0
;

20

status;

/* did not start crossover*/
DATA data1; SET new;
IF Xstart=. AND Xend = .;
period=1; start=entry; stop=eventtime; event=status;
/* event or dropout during crossover interlude: censor at start of period 1*/
DATA data2; SET new;
IF Xstart^=. AND Xstart<=eventtime AND eventtime<=Xend;
period=1; start=entry; stop=Xstart; event=0;
/* did pass crossover so outputs for per and post-crossover periods*/
DATA data3; SET new;
IF Xstart^=. AND eventtime>Xend;
period=1; start=entry; stop=Xstart;
event=0; OUTPUT;
period=2; start=Xend; stop=eventtime; event=status; OUTPUT;

/* Merge the three datasets and mark the vaccination time and status*/
DATA newest;
SET data1 data2 data3;
IF arm=0 THEN DO; timevact=Xend; IF period=1 THEN vac=0; ELSE vac=1; END;
IF arm=1 THEN DO; timevact=entry;
vac=1; END;
/* Run the code with a log-linear VE decay, fix so no missing vactime*/
PROC PHREG DATA=newest;
MODEL (start, stop)*event( 0 )= vac vactime
/ itprint rl ;
vactime=vac*(stop-timevact);
IF vac=0 THEN vactime=0;
RUN;
/* Print out the dataset, sorted*/
PROC SORT DATA=newest;
BY id period;
PROC PRINT;
RUN;

Obs id
1 1
2 1
3 2
4 2
5 3
6 4

arm period start stop event vac timevact
0
1
35
65 0
0
95
0
2
95
370 0
1
95
1
1
45
80 0
1
45
1
2
110
400 0
1
45
0
1
55
150 0
0
.
1
1
60
170 0
1
60

21

7
8
9
10
11
12
13
14
15

4
5
6
6
7
7
8
9
10

1
0
1
1
0
0
1
0
1

2
1
1
2
1
2
1
1
1

200
65
80
210
85
245
70
58
71

310 1
80 1
190 0
410 0
215 0
420 0
90 1
160 0
160 0

1
0
1
1
0
1
1
0
1

60
.
80
80
245
245
70
190
71

In this minimal example, the estimates of (θ1 , θ2 ) are (−0.82335, 0.02649), respectively,
which correspond to estimates of V E(0), V E(30) of 1 − exp(−0.82335) = 0.561 and 1 −
exp(−0.82335 + 30 × 0.02649) = 0.028.

A.2

R code

library(survival)
library(tidyverse) # for dplyr and piping %>%
dean_dat = read.table("manuscript/dean_dat.txt")
# dataset
dat_raw =
data.frame(
id
=
arm
=
entry
=
Xstart
=
Xend
=
eventtime =
status
=
)

c(1,2,3,4,5,6,7,8,9,10),
c(0,1,0,1,0,1,0,1,0,1),
c(35,45,55,60,65,80,85,70,58,71),
c(65,80,NA,170,NA,190,215,NA,160,160),
c(95,110,NA,200,NA,210,245,NA,190,190),
c(370,400,150,310,80,410,420,90,180,166),
c(0,0,0,1,1,0,0,1,1,0)

# reshape dataset into start-stop format
# add new variables for time-varying vaccine status and vaccination time
dat_long =
dat_raw %>%
group_by(id) %>%
summarize(id = rep(id, 2),
arm = rep(arm, 2),
tstart = c(entry, Xend),
tstop = c(min(eventtime, Xstart, na.rm = T), eventtime),
status =
case_when(is.na(Xstart) ~
c(status, NA), # event happens before crossover
22

between(eventtime, Xstart, Xend) ~
c(0, NA),
# no event, then blackout period
eventtime > Xend ~
c(0, status)), # no event, then record status
vacc_status =
case_when(arm == 1 ~ rep(1, 2),
arm == 0 ~ c(0, 1)),
vacc_time =
case_when(arm == 1 ~ rep(entry, 2),
arm == 0 & is.na(Xstart) & is.na(Xend) ~ Inf,
arm == 0 & !is.na(Xstart) & !is.na(Xend) ~ rep(Xend, 2))) %>%
drop_na() %>%
as.data.frame()
print(dat_long, row.names = FALSE)
# id arm tstart tstop status vacc_status vacc_time
# 1
0
35
65
0
0
95
# 1
0
95
370
0
1
95
# 2
1
45
80
0
1
45
# 2
1
110
400
0
1
45
# 3
0
55
150
0
0
Inf
# 4
1
60
170
0
1
60
# 4
1
200
310
1
1
60
# 5
0
65
80
1
0
Inf
# 6
1
80
190
0
1
80
# 6
1
210
410
0
1
80
# 7
0
85
215
0
0
245
# 7
0
245
420
0
1
245
# 8
1
70
90
1
1
70
# 9
0
58
160
0
0
190
# 10
1
71
160
0
1
71
# fit that model!
vacc_dur =
coxph(formula =
Surv(time = tstart,
time2 = tstop,
event = status) ~ vacc_status + tt(vacc_time),
tt = function(vacc_time, t, ...) {
pmax(0, t - vacc_time)
},
data = dat_long)
The parameter estimates are (θ̂1 , θˆ2 ) = (-0.82336, 0.02649).

23

B
B.1

Additional Simulation Results
Trials with Year Two Baseline Hazard Equal to Year One Baseline Hazard

In this section we provide simulation results where the baseline hazard function in year two is
the same as in year one. Table 4 is the analogue to Table 1 and Table 5 is the analogue to
Table 2.

24

log(1 − V E(s))
Design

Model

Time

log(1 − V E(s)) − log(1 − V E(0))

Bias

Emp. Var.

Covg.

Bias

Emp. Var.

Covg.

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

-0.012
-0.011
-0.010
-0.010
-0.015
-0.014
-0.013
-0.019

0.046
0.102
0.213
0.379
0.064
0.148
0.226
0.461

0.950
0.951
0.950
0.951
0.962
0.960
0.957
0.966

0.001
0.002
0.003
0.003
0.003
0.004
0.005
-0.001

0.028
0.111
0.249
0.443
0.118
0.229
0.303
0.536

0.952
0.952
0.952
0.952
0.975
0.960
0.957
0.963

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

-0.008
-0.009
-0.010
-0.011
-0.010
-0.010
-0.013
-0.021

0.027
0.043
0.080
0.138
0.035
0.056
0.087
0.271

0.950
0.951
0.953
0.953
0.976
0.971
0.969
0.977

-0.001
-0.002
-0.002
-0.003
0.005
0.005
0.002
-0.005

0.011
0.042
0.095
0.170
0.101
0.117
0.132
0.336

0.953
0.953
0.953
0.953
0.981
0.965
0.977
0.977

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

-0.008
-0.008
-0.008
-0.008
-0.010
-0.007
-0.012
-0.039

0.020
0.013
0.027
0.060
0.033
0.033
0.035
0.171

0.948
0.950
0.949
0.949
0.981
0.983
0.981
0.977

0.000
0.000
0.000
0.000
0.012
0.016
0.011
-0.016

0.010
0.040
0.089
0.158
0.134
0.164
0.142
0.274

0.950
0.950
0.950
0.950
0.983
0.968
0.975
0.976

True vaccine efficacy constant at 75%
Cross at 150 cases
τx = 0.6 ± 0.05

log-linear

P-spline

Cross at 1 year
Nx = 216 ± 13

log-linear

P-spline

Parallel trial

log-linear

P-spline

Vaccine efficacy wanes from 85% to 35% over 1.5 years
Cross at 150 cases
τx = 0.63 ± 0.05

log-linear

P-spline

Cross at 1 year
Nx = 211 ± 13

log-linear

P-spline

Parallel trial

log-linear

P-spline

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

-0.015
-0.014
-0.013
-0.012
-0.015
-0.010
-0.008
-0.007

0.048
0.078
0.140
0.234
0.063
0.127
0.167
0.254

0.952
0.949
0.950
0.949
0.963
0.962
0.953
0.959

0.001
0.002
0.004
0.005
0.009
0.015
0.017
0.018

0.016
0.064
0.144
0.255
0.108
0.208
0.243
0.329

0.952
0.952
0.952
0.952
0.981
0.968
0.965
0.962

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

-0.009
-0.008
-0.006
-0.005
-0.010
-0.006
-0.002
0.001

0.030
0.039
0.065
0.106
0.034
0.051
0.070
0.154

0.948
0.952
0.952
0.954
0.972
0.968
0.966
0.973

0.001
0.003
0.004
0.006
0.012
0.016
0.020
0.023

0.008
0.031
0.071
0.126
0.089
0.116
0.118
0.218

0.953
0.953
0.953
0.953
0.987
0.969
0.980
0.974

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

-0.008
-0.004
-0.001
0.003
-0.011
-0.004
-0.001
-0.003

0.022
0.010
0.014
0.034
0.030
0.023
0.020
0.076

0.952
0.947
0.947
0.949
0.980
0.983
0.978
0.975

0.004
0.007
0.011
0.014
0.019
0.026
0.029
0.027

0.008
0.031
0.071
0.125
0.119
0.166
0.144
0.197

0.948
0.948
0.948
0.948
0.990
0.973
0.976
0.977

Table 4: Bias, empirical variance, and coverage for the linear predictor in Cox PH models for
simulated trials where the baseline hazard in year two was the same as the baseline hazard
in year one. The log-linear and P-spline models correspond to (2) and (5), respectively. The
average time of crossover (in years), τx , and the average number of events at crossover, Nx ,
along with standard deviations beneath the crossover grouping in the design column. Time is
given in years since study initiation.
25

Intercept

Vaccine efficacy constant at 75%
Cross at 150 cases Constant VE
log-linear
P-spline
Cross at 1 year
Constant VE
log-linear
P-spline
Parallel trial
Constant VE
log-linear
P-spline
Vaccine efficacy wanes from 85%
Cross at 150 cases log-linear
P-spline
Cross at 1 year
log-linear
P-spline
Parallel trial
log-linear
P-spline

Linear trend

Bias

Emp. Var.

Covg.

Bias

Emp. Var.

Covg.

-0.012
-0.013
-0.018
-0.007
-0.008
-0.015
-0.004
-0.007
-0.023

0.039
0.046
0.076
0.027
0.033
0.079
0.013
0.046
0.110

0.951
0.953
0.970
0.949
0.952
0.977
0.951
0.950
0.977

—
0.002
0.002
—
-0.002
-0.002
—
0.000
0.002

—
0.111
0.109
—
0.042
0.042
—
0.040
0.039

—
0.952
0.954
—
0.953
0.956
—
0.950
0.952

0.951
0.975
0.952
0.979
0.950
0.980

0.002
-0.002
0.003
-0.004
0.007
0.003

0.064
0.063
0.031
0.031
0.031
0.031

0.952
0.953
0.953
0.955
0.948
0.949

to 35% over 1.5 years
-0.016
0.050
-0.025
0.086
-0.010
0.036
-0.022
0.085
-0.011
0.049
-0.030
0.124

Table 5: Bias, empirical variance, and coverage for estimates of the intercept and linear trend
in vaccine efficacy under the log–linear model, (2), and semi–parametric model, (5). Here, the
time–varying baseline hazard in year two the same as the baseline hazard in year one.

B.2

Comparing Uniform Crossover, Crossover at One Year, and
Parallel Trials

This section contains results for a set of idealized trials with constant baseline hazard, instantaneous enrollment and crossover, and constant VE. Trials either crossed placebo participants to
the vaccine arm at one year, uniformly over the two year study period, or never (corresponding
to a standard parallel arm design). Table 6 provides the results for the vaccine efficacy over
time while Table 7 provides the parameter estimates.

26

log(1 − VE(s))
Model

Time

Bias

Empir. Var.

log(1 − VE(s)) − log(1 − VE(0))

Coverage

Bias

Empir. Var.

Coverage

0.031
0.016
0.018
0.037
0.074
0.072
0.023
0.029
0.044
0.183

0.950
0.951
0.949
0.951
0.950
0.979
0.981
0.976
0.973
0.976

—
0.003
0.007
0.010
0.013
—
0.010
0.012
0.018
0.027

—
0.009
0.034
0.077
0.137
—
0.082
0.104
0.103
0.234

—
0.950
0.950
0.950
0.950
—
0.983
0.967
0.970
0.980

Continuous uniform crossover
log-linear

P-spline

0.0
0.5
1.0
1.5
2.0
0.0
0.5
1.0
1.5
2.0

-0.008
-0.004
-0.001
0.002
0.006
-0.017
-0.006
-0.004
0.002
0.011

Crossover at one year
log-linear

P-spline

0.0
0.5
1.0
1.5
2.0
0.0
0.5
1.0
1.5
2.0

-0.008
-0.008
-0.007
-0.007
-0.007
-0.018
-0.009
-0.012
-0.010
-0.002

0.035
0.026
0.037
0.068
0.117
0.100
0.032
0.048
0.078
0.237

0.953
0.954
0.947
0.947
0.946
0.984
0.982
0.975
0.970
0.980

—
0.000
0.000
0.000
0.000
—
0.009
0.005
0.007
0.016

—
0.010
0.039
0.088
0.156
—
0.112
0.122
0.130
0.333

—
0.947
0.947
0.947
0.947
—
0.986
0.971
0.981
0.975

0.0
0.5
1.0
1.5
2.0
0.0
0.5
1.0
1.5
2.0

-0.006
-0.007
-0.007
-0.008
-0.008
-0.021
-0.011
-0.010
-0.010
-0.024

0.051
0.022
0.013
0.024
0.054
0.131
0.032
0.033
0.034
0.133

0.950
0.950
0.949
0.951
0.953
0.981
0.982
0.981
0.983
0.982

—
0.000
-0.001
-0.001
-0.002
—
0.010
0.010
0.011
-0.004

—
0.010
0.039
0.088
0.157
—
0.140
0.186
0.165
0.261

—
0.951
0.951
0.951
0.951
—
0.986
0.968
0.973
0.977

Parallel trial
log-linear

P-spline

Table 6: Bias, empirical variance, and coverage for the linear predictor in Cox PH models for
simulated trials in an idealized scenario with constant baseline hazards and either continuous
crossover, instantaneous crossover at one year, or a standard trial. The log-linear and P-spline
models correspond to (2) and (5), respectively.

27

Intercept
Bias

Emp. Var.

Linear trend
Covg.

Bias

Emp. Var.

Covg.

log-linear -0.008
0.031
P-spline
-0.016
0.071
Crossover at one year

0.950
0.973

0.007
0.003

0.034
0.034

0.950
0.952

log-linear -0.008
P-spline
-0.018
Parallel trial

0.035
0.099

0.953
0.978

0.000
-0.002

0.039
0.038

0.947
0.952

0.051
0.130

0.950
0.977

-0.001
-0.001

0.039
0.039

0.951
0.952

Continuous uniform crossover

log-linear
P-spline

-0.006
-0.021

Table 7: Empirical variance and coverage for estimates of the intercept and linear trend in
vaccine efficacy under the log–linear model, (2), and semi–parametric model, (5), in an idealized
scenario with constant baseline hazards and continuous crossover, instantaneous crossover at
one year, or a standard trial.

B.3

Frailty simulation results

This section presents results from simulated trials in where participants were heterogeneous
in their baseline hazards. Simulation was analogous to trials simulated elsewhere in this
manuscript, except that each trial consisted of 30,000 participants and the participant level
hazard was e
hi (t) = Ui hi (t), with hi (t) corresponding to either a constant VE or log-linear VE
model. In both cases the baseline hazard was constant. We considered two settings for the
baseline hazard: a low event rate scenario calibrated to yield 100 cases per year on placebo or a
high event rate scenario calibrated to yield 600 cases per year on placebo. Participant frailties
were drawn from a gamma distribution with mean one and a variance of either one (low frailty
variance scenario) or four (high frailty variance scenario).
Tables 8, 9, and 10 present the results.

28

Frailty distribution summary statistics
Baseline
Hazard

Frailty
Variance

Design

Original arm

Mean

SD

25%ile

50%ile

75%ile

Cross at 1 year

Placebo
Vaccine
Placebo
Vaccine
Placebo
Vaccine
Placebo
Vaccine

0.992
0.997
0.987
0.997
0.969
0.987
0.949
0.987

0.992
0.996
0.987
0.996
1.937
1.973
1.897
1.973

0.285
0.287
0.284
0.287
0.010
0.010
0.010
0.010

0.688
0.691
0.684
0.691
0.169
0.172
0.166
0.172

1.375
1.382
1.368
1.382
1.010
1.028
0.989
1.028

Placebo
Vaccine
Placebo
Vaccine
Placebo
Vaccine
Placebo
Vaccine

0.955
0.980
0.926
0.980
0.841
0.926
0.757
0.926

0.955
0.980
0.926
0.980
1.681
1.851
1.514
1.851

0.275
0.282
0.266
0.282
0.009
0.010
0.008
0.010

0.662
0.680
0.642
0.680
0.147
0.162
0.132
0.162

1.323
1.359
1.283
1.359
0.876
0.965
0.790
0.965

Placebo
Vaccine
Placebo
Vaccine
Placebo
Vaccine
Placebo
Vaccine

0.992
0.994
0.987
0.994
0.968
0.975
0.949
0.975

0.992
0.994
0.987
0.994
1.936
1.950
1.897
1.950

0.285
0.286
0.284
0.286
0.010
0.010
0.010
0.010

0.688
0.689
0.684
0.689
0.169
0.170
0.166
0.170

1.375
1.378
1.368
1.378
1.009
1.017
0.989
1.017

Placebo
Vaccine
Placebo
Vaccine
Placebo
Vaccine
Placebo
Vaccine

0.954
0.964
0.926
0.964
0.838
0.870
0.757
0.870

0.954
0.964
0.926
0.964
1.676
1.740
1.514
1.740

0.274
0.277
0.266
0.277
0.009
0.009
0.008
0.009

0.661
0.668
0.642
0.668
0.146
0.152
0.132
0.152

1.322
1.337
1.283
1.337
0.874
0.907
0.790
0.907

VE constant at 75%
Low

Low

Parallel trial
High

Cross at 1 year
Parallel trial

High

Low

Cross at 1 year
Parallel trial

High

Cross at 1 year
Parallel trial

VE wanes from 85% to 35% over 1.5 years
Low

Low

Cross at 1 year
Parallel trial

High

Cross at 1 year
Parallel trial

High

Low

Cross at 1 year
Parallel trial

High

Cross at 1 year
Parallel trial

Table 8: Summary statistics of the frailty distribution of participants still in the risk set at the
end of two years of followup. We report geometric means of summary statistics of each frailty
distribution from 10,000 simulated trials.

29

Placebo crossover
Frailty
variance

Model

Parallel trial

Time

log(1 − VE(s))

log(1 − VE(s))−
log(1 − VE(0))

log(1 − VE(s))

log(1 − VE(s))−
log(1 − VE(0))

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

-0.014
-0.015
-0.015
-0.015
-0.017
-0.022
-0.020
-0.032

0.000
0.000
-0.001
-0.001
0.022
0.016
0.018
0.006

-0.013
-0.012
-0.011
-0.010
-0.017
-0.017
-0.019
-0.046

0.001
0.002
0.003
0.005
0.043
0.043
0.040
0.014

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

-0.009
0.000
0.010
0.019
-0.014
-0.007
0.003
0.005

0.009
0.019
0.028
0.038
0.021
0.028
0.038
0.041

-0.007
0.004
0.015
0.026
-0.014
0.001
0.008
-0.017

0.011
0.022
0.032
0.043
0.041
0.057
0.063
0.039

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

0.011
0.026
0.042
0.058
0.010
0.026
0.042
0.052

0.016
0.031
0.047
0.063
0.017
0.033
0.050
0.059

0.012
0.027
0.041
0.056
0.010
0.027
0.042
0.046

0.015
0.029
0.044
0.059
0.018
0.036
0.050
0.054

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

0.054
0.108
0.162
0.216
0.052
0.108
0.162
0.210

0.054
0.108
0.162
0.216
0.054
0.109
0.164
0.211

0.055
0.105
0.154
0.204
0.053
0.108
0.154
0.190

0.050
0.100
0.149
0.199
0.057
0.112
0.159
0.194

Low baseline hazard
Low

log-linear

P-spline

High

log-linear

P-spline

High baseline hazard
Low

log-linear

P-spline

High

log-linear

P-spline

Table 9: Bias of estimates of the linear predictor for VE and change in the linear predictor for
VE in Cox PH models for trials simulated with constant VE at 75% and gamma distributed
frailties. The low baseline hazard scenario was calibrated to yield an average of 50 cases per
six month period on the placebo arm, while the high baseline hazard scenario was calibrated
to yield 300 cases per six month period. The frailty distribution had mean one and a variance
of either one (low variance) or four (high variance).

30

Placebo crossover
Frailty
variance

Model

Parallel trial

Time

log(1 − VE(s))

log(1 − VE(s))−
log(1 − VE(0))

log(1 − VE(s))

log(1 − VE(s))−
log(1 − VE(0))

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

-0.016
-0.010
-0.005
0.001
-0.019
-0.010
-0.001
0.009

0.005
0.011
0.016
0.022
0.036
0.045
0.054
0.064

-0.013
-0.005
0.002
0.010
-0.020
-0.006
0.000
0.005

0.008
0.015
0.023
0.030
0.058
0.071
0.077
0.083

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

-0.008
0.003
0.014
0.026
-0.012
0.005
0.020
0.030

0.011
0.022
0.033
0.044
0.037
0.054
0.069
0.079

-0.004
0.009
0.022
0.034
-0.014
0.011
0.022
0.022

0.013
0.025
0.038
0.051
0.059
0.083
0.095
0.095

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

0.011
0.023
0.035
0.046
0.011
0.027
0.038
0.041

0.012
0.023
0.035
0.047
0.021
0.037
0.048
0.051

0.015
0.025
0.035
0.046
0.011
0.029
0.038
0.038

0.010
0.021
0.031
0.041
0.022
0.040
0.049
0.049

0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0

0.056
0.095
0.133
0.172
0.056
0.108
0.142
0.151

0.038
0.077
0.115
0.154
0.059
0.110
0.145
0.153

0.063
0.096
0.128
0.161
0.057
0.109
0.135
0.136

0.033
0.066
0.099
0.131
0.063
0.114
0.141
0.141

Low baseline hazard
Low

log-linear

P-spline

High

log-linear

P-spline

High baseline hazard
Low

log-linear

P-spline

High

log-linear

P-spline

Table 10: Bias of estimates of the linear predictor for VE and change in the linear predictor
for VE in Cox PH models for for trials simulated with VE waning from 85% to 35% linear on
the log hazard scale and gamma distributed frailties. The low baseline hazard scenario was
calibrated to yield an average of 50 cases per six month period on the placebo arm, while the
high baseline hazard scenario was calibrated to yield 300 cases per six month period. The frailty
distribution had mean one and a variance of either one (low variance) or four (high variance).

31

