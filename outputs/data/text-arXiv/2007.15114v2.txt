1

Control Strategies for COVID-19 Epidemic with
Vaccination, Shield Immunity and Quarantine: A
Metric Temporal Logic Approach

arXiv:2007.15114v2 [eess.SY] 13 Aug 2020

Zhe Xu, Bo Wu and Ufuk Topcu

Abstract—Ever since the outbreak of the COVID-19 epidemic,
various public health control strategies have been proposed and
tested against the coronavirus SARS-CoV-2. We study three
specific COVID-19 epidemic control models: the susceptible,
exposed, infectious, recovered (SEIR) model with vaccination
control; the SEIR model with shield immunity control; and
the susceptible, un-quarantined infected, quarantined infected,
confirmed infected (SUQC) model with quarantine control. We
express the control requirement in metric temporal logic (MTL)
formulas (a type of formal specification languages) which can
specify the expected control outcomes such as “the deaths from the
infection should never exceed one thousand per day within the next
three months” or “the population immune from the disease should
eventually exceed 200 thousand within the next 100 to 120 days”.
We then develop methods for synthesizing control strategies with
MTL specifications. To the best of our knowledge, this is the
first paper to systematically synthesize control strategies based
on the COVID-19 epidemic models with formal specifications. We
provide simulation results in three different case studies: vaccination control for the COVID-19 epidemic with model parameters
estimated from data in Lombardy, Italy; shield immunity control
for the COVID-19 epidemic with model parameters estimated
from data in Lombardy, Italy; and quarantine control for the
COVID-19 epidemic with model parameters estimated from data
in Wuhan, China. The results show that the proposed synthesis
approach can generate control inputs such that the time-varying
numbers of individuals in each category (e.g., infectious, immune)
satisfy the MTL specifications. The results also show that early
intervention is essential in mitigating the spread of COVID19, and more control effort is needed for more stringent MTL
specifications. For example, based on the model in Lombardy,
Italy, achieving less than 100 deaths per day and 10000 total
deaths within 100 days requires 441.7% more vaccination control
effort than achieving less than 1000 deaths per day and 50000
total deaths within 100 days.
Index Terms—COVID-19 epidemic, vaccination, shield immunity, quarantine, metric temporal logic

I. I NTRODUCTION
The COVID-19 pandemic [1] has caused over 20 million
confirmed cases and over 0.74 million deaths globally as
of August 12, 2020. Ever since the outbreak of COVID-19,
various public health control strategies have been proposed
and tested against the coronavirus SARS-CoV-2 [2].
Currently, over 90 vaccines are being developed against
SARS-CoV-2 by research teams across the world [3]. Besides
Zhe Xu and Bo Wu are with the Oden Institute for Computational Engineering and Sciences, University of Texas, Austin, Austin, TX 78712, Ufuk
Topcu is with the Department of Aerospace Engineering and Engineering Mechanics, and the Oden Institute for Computational Engineering and Sciences,
University of Texas, Austin, Austin, TX 78712, e-mail: zhexu@utexas.edu,
bowu86@gmail.com, utopcu@utexas.edu.

vaccination, other strategies have also been proposed to control
the spread of SARS-CoV-2. In [4], the authors proposed shield
immunity to protect the susceptible people from getting infected with SARS-CoV-2. Specifically, shield immunity works
by first identifying and deploying recovered individuals who
have protective antibodies to SARS-CoV-2, and then increasing the proportion of interactions with recovered individuals as
opposed to other individuals. In [5], the authors analyzed how
quarantine has mitigated the spread of SARS-CoV-2 based on
a model that differentiates quarantined infected individuals and
un-quarantined infected individuals.
Despite the fact that various promising control strategies
have been proposed against SARS-CoV-2, such control strategies still suffer from several limitations. (a) The control strategies against SARS-CoV-2 often treat the control inputs (e.g.,
the shield strength in shield immunity and the quarantine rate
in quarantine control) as parameters that stay constant during
one stage of time, while in reality such parameters may change
on a daily basis with more fine-tuned control. (b) The control
inputs in the literature are often tuned manually through
trial-and-error instead of being synthesized systematically. (c)
There is a lack of specific and formal specifications for the
expected effects and outcomes of the control strategies.
To address these limitations, we propose a systematic control synthesis approach for three control strategies against
SARS-CoV-2. We use metric temporal logic (MTL) formulas
to specify the expected control outcomes such as “the deaths
from the infection should never exceed one thousand per day
within the next three months” or “the population immune from
the disease should eventually exceed 200 thousand within the
next 100 to 120 days”. Such temporal logic formulas have
been used as high-level knowledge or specifications in many
applications in artificial intelligence [6], robotic control [7],
power systems [8], etc.
The proposed control synthesis approach is based on three
specific COVID-19 epidemic mitigation models: the susceptible, exposed, infectious, recovered (SEIR) model with
vaccination control; the SEIR model with shield immunity
control; and the susceptible, un-quarantined infected, quarantined infected, confirmed infected (SUQC) model with quarantine control. We develop methods for synthesizing control
strategies based on the three specific COVID-19 epidemic
models with MTL specifications. Specifically, we convert the
synthesis problem into mixed-integer bi-linear programming or
mixed-integer fractional constrained programming problems,
and solve the optimization problems using highly efficient

2

solvers [9].
We provide simulation results in three different case studies:
vaccination control for COVID-19 epidemic with model parameters estimated from data in Lombardy, Italy; shield immunity control for COVID-19 epidemic with model parameters
estimated from data in Lombardy, Italy; and quarantine control
for COVID-19 epidemic with model parameters estimated
from data in Wuhan, China. The proposed synthesis approach
can generate control inputs such that the time-varying numbers
of individuals in each category (e.g., infectious, immune)
satisfy the MTL specifications.
Based on the simulation results, we observe that early
control is essential in mitigating the spread of COVID-19,
and more control effort is needed for more stringent MTL
specifications. For example, based on the model in Lombardy,
Italy, achieving less than 100 deaths per day and 10000 total
deaths within 100 days requires 441.7% more vaccination
control effort than achieving less than 1000 deaths per day
and 50000 total deaths within 100 days. As the control inputs
are generated on a daily basis, the proposed approach can be
used to assist and provide quantitative guidelines in public
health control strategies to achieve specific specifications for
mitigating the spread of COVID-19.
II. R ELATED W ORK
COVID-19 epidemic modeling and control strategies: Ever
since the outbreak of COVID-19, there has been numerous
research focusing on the modeling of COVID-19 epidemic
based on data collected from both the epicenters and other
places [10], [11], [12], [13]. Among the various models,
compartmental models such as SEIR and SUQC models have
been used frequently for the analysis of COVID-19. There
has also been work in analyzing or predicting the spread of
COVID-19 using artificial intelligence models [14], stochastic
intensity models [11], etc. The models we use in this paper
are based on the SEIR (both the standard and with shield
immunity) and SUQC models, but we have replaced some essential parameters (e.g., the shield strength in shield immunity,
the quarantine rate in quarantine control) with control inputs
which can be synthesized to vary on a daily basis.
Optimal control of epidemic models: There exist work in
designing vaccination control for the SEIR or SIR models of
epidemics [15], [16]. However, such methods have not been
applied in the setting of COVID-19. Besides, there has been
no work in optimal control of epidemic models with formal
specifications (e.g., expressed in temporal logic formulas).
Control synthesis with temporal logic specifications: There
are three main categories of approaches to designing controllers that meet temporal logic specifications [17], [18], [19],
[20], [21], [22], [23], [24], [25], [26], [27]. The first category
of approaches abstract the system as a transition system
and transform the control syntheses problem into a series of
constrained reachability problems [28], [29], [30]. The second
category of approaches mainly focus on linear dynamical
systems and they convert the control synthesis problem into
a mixed-integer linear programming (MILP) problem [31],
[32], [33], [34], [35], [36] which can be solved efficiently

by MILP solvers. The third category of approaches substitute
the temporal logic constraint into the objective function of the
optimization problem and apply a functional gradient descent
algorithm on the resulting unconstrained problem [37], [38],
[8], [39]. The control synthesis approach in this paper is based
on the second category of approaches, but we have extended
the method to non-linear dynamical systems to fit the epidemic
models for COVID-19.
III. M ETRIC T EMPORAL L OGIC (MTL)
In this section, we briefly review metric temporal logic
(MTL) [40] interpreted over discrete-time trajectories. The
state x (e.g., representing the susceptible, exposed, infectious,
recovered population of a certain region) belongs to the
domain X ⊂ Rn . The time set is T = R≥0 . The domain
B = {True, False} is the Boolean domain, and the time index
set is I = {0, 1, . . . }. We use t[k] ∈ T to denote the time
instant at time index k ∈ I and x[k] , x(t[k]) to denote
the value of x at time t[k]. We use ξ to denote a trajectory
as a function from T to X . A set AP is a set of atomic
propositions, each mapping X to B. The syntax of MTL is
defined recursively as follows:
ϕ := > | π | ¬ϕ | ϕ1 ∧ ϕ2 | ϕ1 ∨ ϕ2 | ϕ1 UI ϕ2 ,
where > stands for the Boolean constant True, π ∈ AP is
an atomic proposition, ¬ (negation), ∧ (conjunction), ∨ (disjunction) are standard Boolean connectives, U is a temporal
operator representing “until”, I is a time index interval of the
form I = [i1 , i2 ] (i1 ≤ i2 , i1 , i2 ∈ I). We can also derive
two useful temporal operators from “until” (U), which are
“eventually” ♦I ϕ = >UI ϕ and “always” I ϕ = ¬♦I ¬ϕ.
For example, the MTL formula [0,100] (DeathsP erDay ≤
0.001) ∧ ♦[40,60] (Recovered ≥ 6) means “the deaths from
infection should never exceed 0.001 million (one thousand)
per day within the next 100 days, and the immune population
should eventually exceed 6 million after 40 to 60 days” (we
assume that the unit in π is million and the unit in I is day
in this paper, unless otherwise indicated).
We define the set of states that satisfy the atomic proposition
π as O(π) ∈ X . We denote hhϕii(ξ, k) = > if the trajectory
ξ satisfies the formula ϕ at discrete-time instants t[k] (k ∈ I).
Then the Boolean semantics of MTL are defined recursively
as follows [41]:
hh>ii(ξ, k) :=>,
hhπii(ξ, k) :=x[k] ∈ O(π),
hh¬ϕii(ξ, k) :=¬hhϕii(ξ, k),
hhϕ1 ∨ ϕ2 ii(ξ, k) :=hhϕ1 ii(ξ, k) ∨ hhϕ2 ii(ξ, k),
_
^
hhϕ1 UI ϕ2 ii(ξ, k) :=
hhϕ2 ii(ξ, k 0 ) ∧
k0 ∈(k+I)

00

hhϕ1 ii

k≤k00 <k0

(ξ, k ) ,

where k + I = {k + k̃|k̃ ∈ I}.
IV. COVID-19 M ODELS WITH C ONTROL S TRATEGIES
In this section, we study three models for COVID-19
epidemic [12], [4], [5] and introduce the corresponding models

3

with vaccination control, shield immunity control and quarantine control.

V
vaccination

A. COVID-19 SEIR Model with Vaccination Control

birth

The susceptible, exposed, infectious, recovered (SEIR)
model has been frequently used in epidemic analyses. As
shown in Fig. 1, the total population is divided into five
subgroups:
•
•
•
•

•

The susceptible population S: everyone is susceptible to
the disease by birth since immunity is not hereditary;
The exposed population E: the individuals who have been
exposed to the disease, but are still not infectious;
The infectious population I: the individuals who are
infectious;
The immune (recovered) population R: the individuals
who are vaccinated or recovered from the disease, i.e.,
the population who are immune to the disease;
The dead population D: the dead individuals from the
disease.

We consider a COVID-19 SEIR model [12], [13] with
vaccination control [15] as follows.
I˙ = E − (γ + µ + α)I;

S

E

I

R

susceptible

exposed

infectious

recovered

natural death

D
dead from
infection

Fig. 1: Block diagram of the COVID-19 SEIR model with
vaccination control.

shield
immunity

birth

S

E

I

R

susceptible

exposed

infectious

immune

natural death

Ė = βSI/N − (µ + )E;
Ṡ = λN − µS − βSI/N − V ;

(1)

Ṙ = γI − µR + V ;
Ḋ = −I˙ − Ė − Ṡ − Ṙ,
where the control input V is the number of vaccinated individuals per day, N = S + E + I + R ≤ N0 is the total
population in the region (N0 is the initial total population in
the region), S, E, I, R and D are the number of susceptible,
exposed, infectious and recovered population in the region,
respectively, and D is the number of deaths from SARSCoV-2 in the region. For the parameters, λ denotes the percapita birth rate, µ is the per-capita natural death rate (death
rate from causes unrelated to SARS-CoV-2), α is the SARSCoV-2 virus-induced average fatality rate, β is the probability
of disease transmission per contact (dimensionless) times the
number of contacts per unit time,  is the rate of progression
from exposed to infectious (the reciprocal is the incubation
period), and γ is the recovery rate of infectious individuals
(the reciprocal is the infectious period). Note that in (1),
D = N0 − I − E − S − R = N0 − N holds as we have
assumed that the birth rate and the natural death rate are the
same for the population we are investigating, i.e., λ = µ.
Remark 1. Note that one difference between this model and
the vaccination control model in [15] is that we control V
as the number of vaccinated individuals per day (constrained
to be less than the susceptible population S), while in [15]
the control input is the ratio of the vaccinated individuals
per day to the average born population per day. We found
it more convenient this way for computational convenience in
the control synthesis in later sections.

D
dead from
infection

Fig. 2: Block diagram of the COVID-19 SEIR model with
shield immunity control.
B. COVID-19 SEIR Model with Shield Immunity Control
Shield immunity is a strategy recently proposed in [4] to
limit the transmission of SARS-CoV-2. The basic idea of
this strategy is to increase the proportion of interactions with
recovered individuals as opposed to the other individuals in
the population. The effectiveness of this strategy is based on
the assumption that recovered individuals (virus-negative and
antibody-positive) can safely interact with both susceptible and
infectious individuals without getting infected with the disease.
As the model used in [4] is modified from an SIR model, we
consider a corresponding SEIR model with shield immunity
control as follows (see Fig. 2 as an illustration).
I˙ = E − (γ + µ + α)I;
Ė = βSI/(N + χR) − (µ + )E;
Ṡ = λN − µS − βSI/(N + χR);

(2)

Ṙ = γI − µR;
Ḋ = −I˙ − Ė − Ṡ − Ṙ,
where the states and parameters are the same as in (1), while
χ(·) is the shield strength [4] as control input to be synthesized
for the recovered population to substitute the contact for the
susceptible population.
C. COVID-19 SUQC Model with Quarantine Control
The susceptible, un-quarantined infected, quarantined infected, confirmed infected (SUQC) model was recently pro-

4

S[k + 1] = S[k] + Ts λN [k] − Ts µS[k] − Ts βS[k]I[k]/N [k]
S
susceptible

U

q

un-quarantined
infected

Q
quarantined
infected

− Ts V [k];
C

R[k + 1] = R[k] + Ts γI[k] − Ts µR[k] + Ts V [k];

confirmed

D[k] = N0 − I[k] − E[k] − S[k] − R[k],
(4)

Fig. 3: Block diagram of the COVID-19 SUQC model with
quarantine control.

posed in [5] based on the COVID-19 data in Wuhan, China. As
shown in Fig. 3, we consider four subgroups in the population:
• The susceptible population S: everyone is susceptible to
the disease by birth since immunity is not hereditary;
• The un-quarantined infected population U : the individuals who are infected and un-quarantined, and they can be
either asymptomatic or symptomatic;
• The quarantined infected population Q: the individuals
who are infectious and quarantined (the un-quarantined
infected become quarantined infected by isolation or
hospitalization, and the quarantined infected lose the
ability of infecting the susceptible individuals);
• The confirmed infected population C: the individuals who
are confirmed to be infected with the disease (i.e., the
positive cases).
We consider the SUQC model with quarantine control as
follows.

Q̇ = qU − (γ2 + (1 − γ2 )σ)Q;

where q is the quarantine rate (for an un-quarantined infected
to be quarantined) as control input to be synthesized, S, U , Q
and C are the number of susceptible, un-quarantined infected,
quarantined infected and confirmed infected population in
the region, respectively, β0 is the infection rate (i.e., the
mean number of new infected caused by an un-quarantined
infected per day), γ2 is the confirmation rate of Q (i.e.,
the probability that the quarantined infected are identified to
be confirmed cases through conventional methods such as
laboratory diagnosis), σ is the subsequent confirmation rate
of those infected that are not confirmed by the conventional
methods, but confirmed with additional tests.
V. C ONTROL S YNTHESIS OF COVID-19 E PIDEMIC WITH
M ETRIC T EMPORAL L OGIC S PECIFICATIONS
In this section, we present the control synthesis methods
for the three COVID-19 epidemic models in Section IV with
vaccination control, shield immunity control and quarantine
control, respectively.
Vaccination control: For the COVID-19 SEIR model with
vaccination control, we discretize the model in (1) as follows.
E[k + 1] = E[k] + Ts βS[k]I[k]/N [k] − Ts (µ + )E[k];

The vaccination control synthesis problem can be formulated as a constrained optimization problem as follows.
min kV [·]k
V [·]

s.t. I[k + 1] = I[k] + Ts E[k] − Ts (γ + µ + α)I[k],
E[k + 1] = E[k] + Ts βS[k]I[k]/N [k] − Ts (µ + )E[k],

(3)

Ċ = (γ2 + (1 − γ2 )σ)Q,

I[k + 1] = I[k] + Ts E[k] − Ts (γ + µ + α)I[k];

Problem 1 (Vaccination control). Given the SEIR model with
vaccination control in (4) and an MTL specification ϕV ,
compute the control input V [·] that minimizes the vaccination
V
control efforts kV [·]k while satisfying hhϕV ii(ξ·;x
init ,V , 0) =
V
V
>, i.e., the trajectory ξ·;xinit ,V satisfies the MTL specification
V
ϕV .

∀k = 0, . . . , T − 1,

Ṡ = −β0 U S/N ;
U̇ = β0 U S/N − qU ;

where Ts is the sampling period. We also use ∆D[k] = D[k]−
D[k − 1] to denote the number of deaths from the infection at
day k.
Following the notations in Section III, we use xV =
V
[I, E, S, R, D] to denote the state of (4) and ξ·;x
init ,V
V
init
to denote the trajectory of (4) starting from xV
=
[I[0], E[0], S[0], R[0], D[0]] and vaccination control input
V [·].

∀k = 0, . . . , T − 1,
S[k + 1] = S[k] + Ts λN [k] − Ts µS[k] − Ts βS[k]I[k]/N [k]
− Ts V [k], ∀k = 0, . . . , T − 1,
R[k + 1] = R[k] + Ts γI[k] − Ts µR[k] + Ts V [k],
∀k = 0, . . . , T − 1,
D[k] = N0 − I[k] − E[k] − S[k] − R[k], ∀k = 0, . . . , T,
0 ≤ V [k] ≤ S[k], ∀k = 0, . . . , T,
V
hhϕV ii(ξ·;x
init ,V , 0) = >,
V

where T ∈ I is the maximal time index we consider.
The above optimization problem is generally a mixedinteger non-linear programming problem. We refer the
readers to [34] for a detailed description of how the constraint
V
hhϕV ii(ξ·;x
init ,V , 0) = > is encoded to satisfy an MTL
V
specification ϕV . The integer variables are introduced
when a big-M formulation [42] is needed to satisfy MTL
specifications such as ♦[0,10] ϕ (ϕ should hold true for at
least one day during the first 10 days) or ϕ1 ∨ ϕ2 (at least
one of the MTL formulas ϕ1 , ϕ2 should hold true). As the
change of total population is relatively small compared to the
multiplication of the susceptible population and the infectious
population, we approximate the term Ts βS[k]I[k]/N [k]
with Ts βS[k]I[k]/N0 . With such an approximation, the
optimization problem becomes a mixed-integer bi-linear
programming problem, which can be more efficiently solved
using techniques such as McCormick’s relaxation [43], [44].
Furthermore, if the MTL specification ϕ consists of only

5

conjunctions (∧) and the always operator (), the integers
in the optimization problem can be eliminated [34] and the
problem becomes a bi-linear programming problem.
Shield immunity control: For the COVID-19 SEIR model
with shield immunity control, we discretize the model in (2)
as follows.

Quarantine control: For the COVID-19 SUQC model with
quarantine control, we discretize the model in (3) as follows.
S[k + 1] = S[k] − Ts β0 U [k]S[k]/N [k];
U [k + 1] = U [k] + Ts β0 U [k]S[k]/N [k] − q[k]U [k];
Q[k + 1] = Q[k] + Ts q[k]U [k] − Ts (γ2 + (1 − γ2 )σ)Q[k];
C[k + 1] = C[k] + Ts (γ2 + (1 − γ2 )σ)Q[k],
(6)

I[k + 1] = I[k] + Ts E[k] − Ts (γ + µ + α)I[k];
E[k + 1] = E[k] + Ts βS[k]I[k]/(N [k] + χ[k]R[k])
− Ts (µ + )E[k];
S[k + 1] = S[k] + Ts λN [k] − Ts µS[k] − Ts βS[k]I[k]/(N [k]
+ χ[k]R[k]);
R[k + 1] = R[k] + Ts γI[k] − Ts µR[k];

where Ts is the sampling period. We also use ∆C[k] =
C[k] − C[k − 1] to denote the number of confirmed infected
individuals at day k.
Following the notations in Section III, we use xQ =
Q
[S, U, Q, C] to denote the state of (6) and ξ·;x
init ,q
Q

D[k] = N0 − I[k] − E[k] − S[k] − R[k],
(5)
where Ts is the sampling period.
Following the notations in Section III, we use xS =
S
[I, E, S, R, D] to denote the state of (5) and ξ·;x
init ,χ
S
init
to denote the trajectory of (5) starting from xS
=
[I[0], E[0], S[0], R[0], D[0]] and shield immunity control input
χ[·].
Problem 2 (Shield immunity control). Given the SEIR model
with shield immunity control in (5) and an MTL specification ϕS , compute the control input χ[·] that minimizes
the shield immunity control efforts kχ[·]k while satisfying
S
S
hhϕS ii(ξ·;x
init ,χ , 0) = >, i.e., the trajectory ξ·;xinit ,χ satisfies
S
S
the MTL specification ϕS .

to denote the trajectory of (6) starting from xinit
Q
[S[0], U [0], Q[0], C[0]] and quarantine control input q[·].

=

Problem 3 (Quarantine control). Given the SUQC model
with quarantine control in (6) and an MTL specification ϕQ ,
compute the control input q[·] that minimizes the quarantine
Q
control efforts kq[·]k while satisfying hhϕQ ii(ξ·;x
init ,q , 0) = >,
Q

Q
i.e., the trajectory ξ·;x
init ,q satisfies the MTL specification ϕQ .
Q

The quarantine control synthesis problem can be formulated
as a constrained optimization problem as follows.
min kq[·]k
q[·]

s.t. S[k + 1] = S[k] − Ts β0 U [k]S[k]/N [k], ∀k = 0, . . . , T − 1,
U [k + 1] = U [k] + Ts β0 U [k]S[k]/N [k] − q[k]U [k],
∀k = 0, . . . , T − 1,

The shield immunity control synthesis problem can be
formulated as a constrained optimization problem as follows.

Q[k + 1] = Q[k] + Ts q[k]U [k] − Ts (γ2 + (1 − γ2 )σ)Q[k],

min kχ[·]k

C[k + 1] = C[k] + Ts (γ2 + (1 − γ2 )σ)Q[k],

χ[·]

s.t. I[k + 1] = I[k] + Ts E[k] − Ts (γ + µ + α)I[k],
∀k = 0, . . . , T − 1,
E[k + 1] = E[k] + Ts βS[k]I[k]/(N [k] + χ[k]R[k])
− Ts (µ + )E[k], ∀k = 0, . . . , T − 1,

∀k = 0, . . . , T − 1,
∀k = 0, . . . , T − 1,
0 ≤ q[k] ≤ qmax , ∀k = 0, . . . , T,
Q
hhϕQ ii(ξ·;x
init ,q , 0) = >,
Q

where T ∈ I is the maximal time index we consider, and qmax
is the maximal quarantine rate.
The above optimization problem is generally a mixed× I[k]/(N [k] + χ[k]R[k]), ∀k = 0, . . . , T − 1,
integer non-linear programming problem. As the change
R[k + 1] = R[k] + Ts γI[k] − Ts µR[k], ∀k = 0, . . . , T − 1,
of total population is relatively small compared to the
D[k] = N0 − I[k] − E[k] − S[k] − R[k], ∀k = 0, . . . , T, multiplication of the susceptible population and the unquarantined infectious population, we approximate the term
0 ≤ χ[k] ≤ χmax , ∀k = 0, . . . , T,
S
Ts β0 U [k]S[k]/N [k] with Ts β0 U [k]S[k]/N̂0 (we use N̂0 to
hhϕS ii(ξ·;xinit ,χ , 0) = >,
S
denote the initial population in the region in the scenario
where T ∈ I is the maximal time index we consider, and χmax with quarantine control). With such an approximation, the
is the maximal shield strength.
optimization problem becomes a mixed-integer bi-linear
The above optimization problem is generally a mixed- programming problem, which can be more efficiently solved
integer fractional constrained programming problem. If the using techniques such as McCormick’s relaxation [43], [44].
MTL specification ϕ consists of only conjunctions (∧) and Furthermore, if the MTL specification ϕ consists of only
the always operator (), the integers in the optimization conjunctions (∧) and the always operator (), the integers
problem can be eliminated [34] and the problem becomes a in the optimization problem can be eliminated [34] and the
fractional constrained programming problem.
problem becomes a bi-linear programming problem.
S[k + 1] = S[k] + Ts λN [k] − Ts µS[k] − Ts βS[k]

6

TABLE I: Parameters of COVID-19 SEIR model estimated
from data from Lombardy, Italy from February 23 to March
16 (2020) with no isolation measures [12].
parameter
λ
µ
α
β

value
1/30295
1/30295
0.006/day
0.75/day

parameter

γ
N0
Ts

value
0.2/day
0.2/day
10 million
1 day

(a) Number of individuals

(b) Number of deaths

TABLE II: MTL specifications and simulation results for
vaccination control (Section VI-A).
MTL specification
ϕ1V = [0,100] (∆D ≤ 0.001)
∧ [0,100] (D ≤ 0.05)
∧ ♦[40,60] (R ≥ 6)
ϕ2V = [0,100] (∆D ≤ 0.0005)
∧ [0,100] (D ≤ 0.02)
∧ ♦[40,60] (R ≥ 6)
ϕ3V = [0,100] (∆D ≤ 0.0001)
∧ [0,100] (D ≤ 0.01)
∧♦[40,60] (R ≥ 6)

control
effort

computation
time

1.28

1.365 s
(c) Number of deaths per day

1.927

2.276 s

6.934

3.289 s

VI. S IMULATION R ESULTS
In this section, we implement the proposed control synthesis
approach in the three different control models as introduced
in Section IV.
A. COVID-19 SEIR Model with Vaccination Control
The parameters of the COVID-19 SEIR model are shown
in Table I. They were estimated in [12] from the data in
the early days (from February 23 to March 16, 2020) in
Lombardy, Italy with no isolation measures. The start time for
the simulations in this subsection are February 23, 2020. We
consider three MTL specifications as shown in Table II. For
example, ϕ1V = [0,100] (∆D ≤ 0.001) ∧ [0,100] (D ≤ 0.05) ∧
♦[40,60] (R ≥ 6), which means “the deaths from infection
should never exceed 0.001 million (i.e., one thousand) per
day and 0.05 million (i.e., 50 thousand) in total within the
next 100 days, and the immune population should eventually
exceed 6 million after 40 to 60 days”. We choose the initial
values of the states as I[0] = 1000 (people), E[0] = 0.02
million, S[0] = 9.979 million, R[0] = 0 and D[0] = 0,
with S[0] + E[0] + I[0] + R[0] + D[0] = N0 = 10 million.
Fig. 4 shows the simulation results without any vaccination.
It can be seen that the three MTL specifications ϕ1V , ϕ2V and
ϕ3V are all violated in such a situation. Note that as isolation
measures (i.e., home isolation, social distancing and partial
national lockdown) were taken since March 16 in Lombardy,
Italy, the real situation was better than those shown in Fig.
4. Now we investigate the hypothetical scenario where the
isolation measures are replaced by vaccination.
We use the solver GEKKO [9] to solve the optimization
problems formulated in Section V. Fig. 5 and Table II show the

Fig. 4: Simulation results for COVID-19 SEIR model estimated from data from Lombardy, Italy with no isolation
measures.
simulation results for vaccination control of COVID-19 SEIR
model with MTL specifications ϕ1V , ϕ2V and ϕ3V , respectively.
The results show that the MTL specifications ϕ1V , ϕ2V and ϕ3V
are satisfied with the synthesized vaccination control inputs
respectively. It can be seen that vaccination within the first 40
days after the outbreak can mitigate the spread of SARS-CoV2 in the most efficient manner. The results also show that the
control effort for satisfying ϕ1V is less than that for satisfying
ϕ2V , which is still less than that for satisfying ϕ3V . This is
consistent with the fact that ϕ2V implies ϕ1V , and ϕ3V implies
both ϕ1V and ϕ2V . For all three specifications, the computations
are completed within 4 seconds on a MacBook Laptop with
1.40-GHz Core i5 CPU and 16-GB RAM.
B. COVID-19 SEIR Model with Shield Immunity Control
We use the same parameters of the COVID-19 SEIR model
as shown in Table I. We also choose the same initial values
of the states as I[0] = 1000 (people), E[0] = 0.02 million,
S[0] = 9.979 million, R[0] = 0 and D[0] = 0, with
S[0] + E[0] + I[0] + R[0] + D[0] = N0 = 10 million. We
set χmax = 100. The start time for the simulations in this
subsection are February 23, 2020. We set the three MTL
specifications ϕ1S , ϕ2S and ϕ3S (as shown in Table III) to be
less stringent than the MTL specifications with the vaccination
control, as shield immunity is generally less effective than vaccination. It can be shown that without any control strategies the
three MTL specifications ϕ1S , ϕ2S and ϕ3S are all violated. Now
we investigate the hypothetical scenario where the isolation
measures are replaced by shield immunity control.
Fig. 6 and Table III show the simulation results for shield
immunity control of the COVID-19 SEIR model with MTL
specifications ϕ1S , ϕ2S and ϕ3S , respectively. The results show
that the MTL specifications ϕ1S , ϕ2S and ϕ3S are satisfied with
the synthesized shield immunity control inputs respectively.

7

(a) Number of individuals

(b) Vaccinated individuals per day

(c) Number of deaths

(d) Number of deaths per day

Fig. 5: Simulation results for the COVID-19 SEIR model with vaccination control and MTL specifications ϕ1V (first row), ϕ2V
(second row) and ϕ3V (third row).
TABLE III: MTL specifications and simulation results for
shield immunity control (Section VI-B).
MTL specification
ϕ1S = [0,100] (∆D ≤ 0.003)
∧ [0,100] (D ≤ 0.1)
∧ ♦[40,60] (R ≥ 1)
ϕ2S = [0,100] (∆D ≤ 0.002)
∧ [0,100] (D ≤ 0.07)
∧ ♦[40,60] (R ≥ 1)
ϕ3S = [0,100] (∆D ≤ 0.002)
∧ [0,100] (D ≤ 0.06)
∧♦[40,60] (R ≥ 1)

control
effort

computation
time

16879.53

2.112 s

45595.10

2.881 s

67786.88

5.323 s

We observe that with the three MTL specifications, the synthesized shield immunity control inputs all increase to a peak
after approximately 20 to 40 days and then gradually decrease.
These observations indicate that shield immunity at early days
of COVID-19 is more efficient than shield immunity at later
days. The results also show that the control effort for satisfying
ϕ1S is less than that for satisfying ϕ2S , which is still less than
that for satisfying ϕ3S . This is consistent with the fact that ϕ2S
implies ϕ1S , and ϕ3S implies both ϕ1S and ϕ2S .
C. COVID-19 SUQC Model with Quarantine Control
The parameters of the COVID-19 SUQC model are shown
in Table IV. They were estimated in [5] from the data in

Wuhan, China. We choose the initial values of the states
as S[0] = 8.9 million, U [0] = 0.001 million, Q[0] = 0
and C[0] = 0. We set qmax = 1. We consider three MTL
specifications as shown in Table V. For example, ϕ1Q =
[0,200] (∆C ≤ 0.001) ∧ [0,200] (C ≤ 0.1) means “the
confirmed infected population should never exceed 0.001
million (i.e., one thousand) per day and 0.1 million (i.e., 100
thousand) in total within the next 200 days”. The start time
for the simulations in this subsection are January 20, 2020.
Fig. 7 shows the simulation results for the COVID-19 SUQC
model estimated from data in Stage I (January 20 to January
30, 2020) of Wuhan, China. It can be seen that the three
MTL specifications ϕ1Q , ϕ2Q and ϕ3Q are all violated in such
a situation (with quarantine rate being always 0.063). Now
we investigate the scenario where the quarantine rate can be
controlled to satisfy the MTL specifications.
Fig. 8 and Table V show the simulation results for quarantine control of the COVID-19 SUQC model with MTL
specifications ϕ1Q , ϕ2Q and ϕ3Q , respectively. The results show
that the MTL specifications ϕ1Q , ϕ2Q and ϕ3Q are satisfied with
the synthesized quarantine control inputs respectively. The
results also show that the control effort for satisfying ϕ1Q is
less than that for satisfying ϕ2Q , which is still less than that
for satisfying ϕ3Q . This is consistent with the fact that ϕ2Q
implies ϕ1Q , and ϕ3Q implies both ϕ1Q and ϕ2Q . We observe
that with ϕ1Q , the synthesized quarantine control inputs first
increase to a peak at approximately 90 days and then gradually
decrease; with ϕ2Q , the synthesized quarantine control inputs
first increase to a peak at approximately 50 days and then

8

(a) Number of individuals

(b) Shield strength

(c) Number of deaths

(d) Number of deaths per day

Fig. 6: Simulation results for the COVID-19 SEIR model with shield immunity control and MTL specifications ϕ1S (first row),
ϕ2S (second row) and ϕ3S (third row).
TABLE IV: Parameters of the COVID-19 SUQC model estimated from data in Stage I (January 20 to January 30, 2020)
of Wuhan, China [5].
parameter
β0
N̂0
Ts

value
0.2967
8.9 million
1 day

parameter
γ2
σ

value
0.05
0.001
(a) Number of un-quarantined and (b) Number of confirmed infected
quarantined infected individuals individuals

gradually decrease; and with ϕ3Q , the synthesized quarantine
control inputs are at a peak from the beginning and gradually
decrease. These observations indicate that quarantine in the
early days of COVID-19 can reduce the number of confirmed
infected cases more efficiently than quarantine in the later
days, and more stringent control specifications require stronger
quarantine measures to be implemented.
VII. C ONCLUSION
In this paper, we proposed a systematic control synthesis
approach for mitigating the COVID-19 epidemic based on
three control models with vaccination, shield immunity and
quarantine, respectively. We used metric temporal logic (MTL)
formulas to formally specify the required performance of the
control strategies. The proposed approach can synthesize control inputs that lead to satisfaction of the MTL specifications.
The work in this paper opens the door to the formal synthesis of control strategies based on epidemic models. We list
several future directions as follows. First, we will investigate

(c) Number of confirmed infected
individuals per day

Fig. 7: Simulation results for the COVID-19 SUQC model
estimated from data in Stage I of Wuhan, China.

the effects of model uncertainties and parameter uncertainties
in the control synthesis, and explore robust control synthesis
methods in the presence of such uncertainties. Second, we
will extend this work to online control synthesis so that

9

(a) Number of un-quarantined and
quarantined infected individuals

(b) Quarantine rate

(c) Number of confirmed infected (d) Number of confirmed infected
individuals
individuals per day

Fig. 8: Simulation results for the COVID-19 SUQC model with quarantine control and MTL specifications ϕ1Q (first row), ϕ2Q
(second row) and ϕ3Q (third row).
TABLE V: MTL specifications and simulation results for
quarantine control (Section VI-C).
MTL specification
ϕ1Q = [0,200] (∆C ≤ 0.001)
∧ [0,200] (C ≤ 0.1)
ϕ2Q = [0,200] (∆C ≤ 0.0005)
∧ [0,200] (C ≤ 0.05)
ϕ3Q = [0,200] (∆C ≤ 0.0005)
∧ [0,200] (C ≤ 0.03)

control
effort

computation
time

19.502

2.296 s

20.023

2.598 s

20.3

4.578 s

control inputs can be generated in real-time based on the
latest information (e.g., using online parameter identification
and receding horizon control). Finally, as we investigated the
three control strategies separately in this paper, we will study
the benefits and costs of joint control of different control
strategies (vaccination, shield immunity and quarantine) so
that the specifications can be satisfied with coordinated efforts.
R EFERENCES
[1] A. S. Fauci, H. C. Lane, and R. R. Redfield, “COVID-19 navigating
the uncharted,” New England Journal of Medicine, vol. 382, no. 13, pp.
1268–1269, 2020, pMID: 32109011.
[2] G. Stewart, K. Heusden, and G. A. Dumont, “How control theory can
help us control COVID-19,” IEEE Spectrum, vol. 57, no. 6, pp. 22–29,
June 2020.
[3] E. Callaway, “The race for coronavirus vaccines: a graphical guide,”
Nature, vol. 580, pp. 576–577, 04 2020.

[4] J. Weitz, S. Beckett, A. Coenen, D. David, M. Dominguez-Mirazo,
J. Dushoff, J. Leung, G. Li, A. Magalie, S. Park, R. Rodriguez-Gonzalez,
S. Shivam, and C. Zhao, “Intervention serology and interaction substitution: Modeling the role of ‘shield immunity’ in reducing COVID-19
epidemic spread,” Nature Medicine, pp. 849–854, 2020.
[5] S. Zhao and H. Chen, “Modeling the epidemic dynamics
and control of COVID-19 outbreak in china,” medRxiv, 2020.
[Online]. Available: https://www.medrxiv.org/content/early/2020/03/09/
2020.02.27.20028639
[6] Z. Xu and U. Topcu, “Transfer of temporal logic formulas in reinforcement learning,” in Proc. IJCAI’2019, 7 2019, pp. 4010–4018.
[7] C. K. Verginis, C. Vrohidis, C. P. Bechlioulis, K. J. Kyriakopoulos, and
D. V. Dimarogonas, “Reconfigurable motion planning and control in
obstacle cluttered environments under timed temporal tasks,” in 2019
International Conference on Robotics and Automation (ICRA), May
2019, pp. 951–957.
[8] Z. Xu, A. Julius, and J. H. Chow, “Energy storage controller synthesis
for power systems with temporal logic specifications,” IEEE Systems
Journal, Early access on IEEE Xplore.
[9] L. Beal, D. Hill, R. Martin, and J. Hedengren, “Gekko optimization
suite,” Processes, vol. 6, no. 8, p. 106, 2018.
[10] A. L. Bertozzi, E. Franco, G. Mohler, M. B. Short, and D. Sledge,
“The challenges of modeling and forecasting the spread of COVID-19,”
Proceedings of the National Academy of Sciences, vol. 117, no. 29, pp.
16 732–16 738, 2020.
[11] Z. Chen, A. Dassios, V. Kuan, J. W. Lim, Y. Qu, B. Surya, and H. Zhao,
“A two-phase dynamic contagion model for COVID-19,” London School
of Economics and Political Science, LSE Library, LSE Research Online
Documents on Economics 105064, Jun. 2020.
[12] J. M. Carcione, J. E. Santos, C. Bagaini, and J. Ba, “A simulation
of a COVID-19 epidemic based on a deterministic SEIR model,”
Frontiers in Public Health, vol. 8, p. 230, 2020. [Online]. Available:
https://www.frontiersin.org/article/10.3389/fpubh.2020.00230
[13] R. Elie, E. Hubert, and G. Turinici, “Contact rate epidemic control of
COVID-19: an equilibrium view,” 04 2020.
[14] N. Zheng, S. Du, J. Wang, H. Zhang, W. Cui, Z. Kang, T. Yang, B. Lou,
Y. Chi, H. Long, M. Ma, Q. Yuan, S. Zhang, D. Zhang, F. Ye, and

10

[15]

[16]

[17]
[18]

[19]

[20]
[21]
[22]

[23]

[24]
[25]

[26]
[27]

[28]
[29]
[30]
[31]

[32]
[33]

[34]
[35]

J. Xin, “Predicting COVID-19 in China using hybrid AI model,” IEEE
Transactions on Cybernetics, vol. 50, no. 7, pp. 2891–2904, July 2020.
S. Alonso-Quesada, M. De la Sen, R. Agarwal, and A. Ibeas, “An
observer-based vaccination control law for a SEIR epidemic model based
on feedback linearization techniques for nonlinear systems,” Advances
in Difference Equations, vol. 2012, 09 2012.
M. d. R. de Pinho, I. Kornienko, and H. Maurer, “Optimal control of a
SEIR model with mixed constraints and L1 cost,” in CONTROLO’2014
– Proceedings of the 11th Portuguese Conference on Automatic Control,
A. P. Moreira, A. Matos, and G. Veiga, Eds.
Cham: Springer
International Publishing, 2015, pp. 135–145.
H. Kress-Gazit, G. Fainekos, and G. Pappas, “Temporal-logic-based
reactive mission and motion planning,” Robotics, IEEE Trans., vol. 25,
no. 6, pp. 1370–1381, Dec 2009.
V. Raman, C. Finucane, and H. Kress-Gazit, “Temporal logic robot
mission planning for slow and fast actions,” in Intelligent Robots and
Systems (IROS), 2012 IEEE/RSJ International Conference on, Oct 2012,
pp. 251–256.
K.-H. Lin, K.-M. Lam, and W.-C. Siu, “A new approach using modified
hausdorff distances with eigenface for human face recognition,” in
Control, Automation, Robotics and Vision, 2002. ICARCV 2002. 7th
International Conference on, vol. 2, Dec 2002, pp. 980–984 vol.2.
M. Hibbard, Y. Savas, Z. Xu, A. A. Julius, and U. Topcu, “Minimizing
the information leakage of high-level task specifications,” in 21st IFAC
World Congress, 2020.
S. Smith, J. Tumova, C. Belta, and D. Rus, “Optimal path planning under
temporal logic constraints,” in Intelligent Robots and Systems (IROS),
2010 IEEE/RSJ Int. Conf., Oct 2010, pp. 3288–3293.
A. Ulusoy, S. Smith, X. C. Ding, C. Belta, and D. Rus, “Optimal
multi-robot path planning with temporal logic constraints,” in Intelligent
Robots and Systems (IROS), 2011 IEEE/RSJ Int. Conf., Sept 2011, pp.
3087–3092.
Z. Liu, B. Wu, J. Dai, and H. Lin, “Distributed communicationaware motion planning for multi-agent systems from stl and spatel
specifications,” in 2017 IEEE 56th Annual Conference on Decision and
Control (CDC). IEEE, 2017, pp. 4452–4457.
F. Djeumou, Z. Xu, and U. Topcu, “Probabilistic swarm guidance with
graph temporal logic specifications,” in Proc. Robotics: Science and
Systems (RSS), 2020.
Z. Liu, J. Dai, B. Wu, and H. Lin, “Communication-aware motion planning for multi-agent systems from signal temporal logic specifications,”
in 2017 American Control Conference (ACC). IEEE, 2017, pp. 2516–
2521.
Z. Liu, B. Wu, J. Dai, and H. Lin, “Distributed communication-aware
motion planning for networked mobile robots under formal specifications,” IEEE Transactions on Control of Network Systems, 2020.
M. Cubuktepe, Z. Xu, and U. Topcu, “Policy synthesis for factored
mdps with graph temporal logic specifications,” in Proc. International
Conference on Autonomous Agents and Multiagent Systems (AAMAS),
2020.
E. M. Wolff, U. Topcu, and R. M. Murray, “Automaton-guided controller
synthesis for nonlinear systems with temporal logic,” in Proc. IEEE/RSJ
Int. Conf. Intell. Robots and Syst., Nov 2013, pp. 4332–4339.
A. Nikou, J. Tumova, and D. V. Dimarogonas, “Cooperative task
planning of multi-agent systems under timed temporal specifications.”
CoRR, vol. abs/1509.09137, 2015.
S. Coogan, E. A. Gol, M. Arcak, and C. Belta, “Traffic network control
from temporal logic specifications,” IEEE Transa. Control of Network
Systems, vol. 3, no. 2, pp. 162–172, June 2016.
A. Donze and V. Raman, “BluSTL: Controller synthesis from signal
temporal logic specifications,” in ARCH14-15. 1st and 2nd International
Workshop on Applied veRification for Continuous and Hybrid Systems,
ser. EPiC Series in Computing, G. Frehse and M. Althoff, Eds., vol. 34.
EasyChair, 2015, pp. 160–168.
Z. Xu, F. M. Zegers, B. Wu, W. Dixon, and U. Topcu, “Controller
synthesis for multi-agent systems with intermittent communication. a
metric temporal logic approach,” in Allerton’19, pp. 1015–1022.
Z. Xu, K. Yazdani, M. T. Hale, and U. Topcu, “Differentially private
controller synthesis with metric temporal logic specifications,” in To
appear in Proc. International Conference on Autonomous Agents and
Multiagent Systems (AAMAS), 2020.
S. Saha and A. A. Julius, “An MILP approach for real-time optimal
controller synthesis with metric temporal logic specifications,” in Proc.
IEEE Amer. Control Conf., July 2016, pp. 1105–1110.
Z. Xu, S. Saha, B. Hu, S. Mishra, and A. A. Julius, “Advisory temporal
logic inference and controller design for semiautonomous robots,” IEEE
Trans. Autom. Sci. Eng., pp. 1–19, 2018.

[36] Z. Xu, A. A. Julius, and J. H. Chow, “Coordinated control of wind
turbine generator and energy storage system for frequency regulation
under temporal logic specifications,” in Proc. Amer. Control Conf., 2018,
pp. 1580–1585.
[37] A. K. Winn and A. A. Julius, “Optimization of human generated
trajectories for safety controller synthesis,” in Proc. IEEE Amer. Control
Conf., June 2013, pp. 4374–4379.
[38] H. Abbas, A. Winn, G. Fainekos, and A. A. Julius, “Functional gradient
descent method for metric temporal logic specifications,” in Proc. IEEE
Amer. Control Conf., June 2014, pp. 2312–2317.
[39] Z. Xu, A. Julius, and J. H. Chow, “Optimal energy storage control
for frequency regulation under temporal logic specifications,” in 2017
American Control Conference (ACC), May 2017, pp. 1874–1879.
[40] G. E. Fainekos and G. J. Pappas, “Robustness of temporal logic specifications,” in Formal Approaches to Testing and Runtime Verification,
in: LNCS, vol. 4262, Springer, 2006.
[41] G. E. Fainekos and G. J. Pappas, “Robustness of temporal logic specifications for continuous-time signals,” Theoretical Computer Science,
vol. 410, no. 42, pp. 4262 – 4291, 2009.
[42] A. Schrijver, Theory of Linear and Integer Programming. John Wiley
& Sons, Chichester, 1986.
[43] G. P. McCormick, “Computability of global solutions to factorable
nonconvex programs: Part I — convex underestimating problems,”
Mathematical Programming, 1976.
[44] A. Gupte, S. Ahmed, M.-S. Cheon, and S. S. Dey, “Solving mixed
integer bilinear problems using MILP formulations,” SIAM J. Optim.,
vol. 23, pp. 721–744, 2013.

Zhe Xu received the B.S. and M.S. degrees in
Electrical Engineering from Tianjin University, Tianjin, China, in 2011 and 2014, respectively. He received the Ph.D. degree in Electrical Engineering
at Rensselaer Polytechnic Institute, Troy, NY, in
2018. He is currently a postdoctoral researcher in
the Oden Institute for Computational Engineering
and Sciences at the University of Texas at Austin,
Austin, TX. He will join the School for Engineering
of Matter, Transport and Energy at Arizona State
University as an assistant professor in January 2021.
His research interests include formal methods, autonomous systems, biological
systems, control systems and reinforcement learning.

Bo Wu received his B.E. degree from Harbin Institute of Technology, China, in 2008, an M.S. degree
from Lund University, Sweden, in 2011 and Ph.D.
degree from the University of Notre Dame, USA, in
2018, all in electrical engineering. He is currently
a postdoctoral researcher at the Oden Institute for
Computational Engineering and Sciences at the University of Texas at Austin. His research interest is
to apply formal methods, learning, and control in
autonomous systems, such as robotic systems, communication systems, and human-in-the-loop systems,
to provide privacy, security, and performance guarantees.

Ufuk Topcu Ufuk Topcu joined the Department of
Aerospace Engineering at the University of Texas at
Austin as an assistant professor in Fall 2015. He
received his Ph.D. degree from the University of
California at Berkeley in 2008. He held research
positions at the University of Pennsylvania and California Institute of Technology. His research focuses
on the theoretical, algorithmic and computational
aspects of design and verification of autonomous
systems through novel connections between formal
methods, learning theory and controls.

