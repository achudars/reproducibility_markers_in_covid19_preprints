Optimal frequency setting of metro services in the age of COVID-19
distancing measures

arXiv:2006.05688v1 [physics.soc-ph] 10 Jun 2020

Konstantinos Gkiotsalitisa and Oded Catsb
a
b

University of Twente, Horst-Ring Z-222, P.O. Box 217, 7500 AE Enschede, The Netherlands;
Delft University of Technology, P.O. Box 5048, 2600 GA Delft, The Netherlands
ARTICLE HISTORY
Compiled June 11, 2020
ABSTRACT
Public transport is one of the most disrupted sectors of the COVID-19 pandemic
with reported ridership drops up to 90% in majorly affected countries. As many
government authorities strive to partially resume activities, public transport operators are in an urgent need for models that can evaluate the impact of different social
distancing policies on operational and passenger-related costs. In this study, we introduce a mixed-integer quadratic programming model for the redesign of public
transport services considering the operational, passenger, and revenue loss-related
costs by evaluating the effects of different social distancing policies. Our model is
applied at the metro network of Washington D.C. and provides optimal redistribution of vehicles across lines for different social distancing scenarios. This model
can be used as a decision support tool by other policymakers and public transport
operators that are in need of evaluating the costs related to the implementation of
different social distancing policies.
KEYWORDS
public transport; metro; social distancing; COVID-19; operational costs; revenue
losses.

Word Count: 6,320; Tables: 6 and Figures: 6
1.

Introduction

Coronaviruses are highly contagious respiratory pathogens leading public authorities
to implement strict distancing measures in closed spaces, such as schools, shops, working places, and public transport. The COVID-19 epidemic was first reported to the
World Health Organization (WHO) on December 31, 2019 and it was recognized as a
pandemic on March 11, 2020 (WHO 2020). Public transport is one of the most disrupted sectors of the COVID-19 pandemic with early estimates suggesting that the
drop has been as much as 80-90% in major cities in China, Iran and the U.S., and as
much as 70% for some operators in the U.K (UITP 2020).
Several public transport operators have reduced their service span (e.g. have canceled night services), have reduced service frequencies, and have closed selected public
transport stations. For example, Transport for London (TfL) has suspended the night
tube service and closed 40 metro stations that do not interchange with other lines (TfL
CONTACT: K. Gkiotsalitis. Email: k.gkiotsalitis@utwente.nl; ORCID: https://orcid.org/0000-0002-30091527

2020). Similarly, the Washington Metropolitan Area Transit Authority (WMATA)
closed 19 metro stations out of 91 and requested all passengers to wear a cloth facecovering (WMATA 2020b). In addition, it has reduced the service frequencies from 10
trains per hour to 3 or 4 trains per hour during peak hours and has imposed early rail
closures at 9pm (WMATA 2020a).
Government authorities propose social distancing rules ranging from 1- to 2-meter
distancing in closed spaces because large droplets do not travel further than 2 meters
(Bahl et al. 2020; Jarvis et al. 2020). Consequently, public transport service providers
have to re-design their services while considering the local distancing regulations. This
calls for the development of novel methods for managing the limited capacity available
and allocating resources accordingly so as to minimize the ramifications of the newly
imposed constraints driven by public health considerations.
The limited capacity implied by the corona-related distancing measures requires
the reallocation of public transport resources so as to cater most efficiently and effectively for the prevailing demand patterns while maintaining the functionality of the
public transport system. Notwithstanding, even when all available resources (vehicles,
drivers) are deployed, it is expected that not all passenger demand can be absorbed
along the busiest service segments. Determining the optimal reallocation of service
resources, which also implies the determination of which demand segments may not
be satisfied, is not trivial. Most public transport networks are denser in their highdemand core and become thinner as they branch out. During peak periods, passenger
load levels in the core of the network are often such that it is not possible to safely
transport all passengers. Moreover, passengers boarding at the edges of the central
area may not be able to board as the occupancy level is already approaching the new
corona-era capacity standard, leaving many stranded passengers. Should one cater for
the long-distance low-volume travel from the branches to the core and vice-versa or
for the short-distance high-volume demand within the network core?
Existing public transport network design (Mandl 1980; Ceder and Wilson 1986; Pattnaik, Mohan, and Tom 1998; Borndörfer, Grötschel, and Pfetsch 2007; Szeto and Wu
2011; Ul Abedin et al. 2018) and frequency setting (Gkiotsalitis and Cats 2018; Sun
and Szeto 2019; Gkiotsalitis, Wu, and Cats 2019) methods cannot answer the abovementioned research question because they consider only the trade-off between operational costs (e.g., running costs, in-vehicle occupancy levels) and passenger-related
costs (e.g., waiting times at stations, total trip travel times). Thus, these models do
not account for the implications of the implementation of social distancing measures
and cannot, therefore, support public transport service providers in the planning of
their services in the era of COVID-19.
To this end, we develop a method that supports the re-design of mass transit services
in the context of complying with COVID-19 distancing measures. More specifically,
we formulate and solve a network-wide model that can set the optimal frequencies of
services lines under different social distancing scenarios. The proposed model extends
on the classic trade-off between operational-related and passenger-related costs by
considering the revenue losses associated with the unaccommodated passenger demand
when complying with the distancing measures. Our network-wide frequency setting
model can be used by public transport operators that seek to re-design their services
under different distancing scenarios and investigate their performance in terms of
passenger waiting time costs, operational costs, in-vehicle occupancy levels, violations
of distancing standards, and revenue losses due to denied boarding.
The remainder of this study is structured as follows: in section 2 we review frequency
setting models and introduce the well-established model of Furth and Wilson (1981)
2

which is adopted and adapted in this study. Section 3 presents our network-wide
frequency setting model that considers the impacts of distancing measures. Our model
is formulated as a mixed-integer nonlinear program (MINLP) and it is reformulated
to an easier-to-solve mixed-integer quadratic program (MIQP) that can be applied to
different case studies. In our case study (section 4), we apply our model to compute
the optimal service frequencies of the Washington D.C. metro lines under different
distancing policies (no distancing, 1-meter distancing, 1.5-meter distancing, 2-meter
distancing). In addition, we investigate the impact of different distancing policies on
operational costs, passenger-related costs, vehicle occupancy levels, and revenue losses
due to denied boarding. This is instrumental for public transport service providers
that need to plan their operations while taking into consideration public health risks
and the operational/passenger-related costs, as elaborated in our discussion (section
5).

2.

Literature review and baseline frequency setting model

Frequency setting models determine the allocation of the available fleet to different
line services by considering the trade-off between productivity and operational costs
(Ibarra-Rojas et al. 2015). Earlier works were limited to determining the frequency
of a single line at a time (Furth and Wilson 1981; Ceder 1984, 2002). Ceder (1984)
proposed closed-form expressions that do not need to solve complex mathematical
programs when determining the frequency of a single line (namely, the maximum load
and the load profile methods).
In the last decade, a series of models have been proposed for setting service frequencies network-wide by determining the optimal resource allocation subject to limited
resources. Yu, Yang, and Yao (2010) proposed a bi-level programming model for the
frequency setting problem which determines the optimal frequencies by minimizing
the total travel time of passengers subject to overall fleet size limitations. The optimal frequency setting and allocation of a mixed-fleet was considered by Cats and
Glück (2019) and dellOlio, Ibeas, and Ruisánchez (2012). Using meta-heuristics, the
frequency setting problem was integrated with the route design by Szeto and Wu
(2011) and Arbex and da Cunha (2015). Cipriani, Gori, and Petrelli (2012) also addressed the frequency setting problem as an exercise of balancing the passenger demand
with the available supply. Verbas and Mahmassani (2013); Verbas et al. (2015); Verbas and Mahmassani (2015); Gkiotsalitis and Cats (2017) and Gkiotsalitis, Wu, and
Cats (2019) developed frequency setting models that consider flexible virtual lines
(e.g., short-turning/interlining lines) to exploit the available vehicle/driver resources
as much as possible. The works of Delle Site and Filippi (1998) and Cortés, Jara-Dı́az,
and Tirachini (2011) also focus on generating short-turning lines to serve the excessive
demand at crowded line segments.
In this study we adopt the model formulation proposed by Furth and Wilson (1981)
as a baseline. This formulation is limited to a single line and considers the operational
costs expressed by the number of vehicles required and the passenger-related costs
expressed by the total passenger waiting times.
To describe the approach of Furth and Wilson (1981), let us consider a time period
of one hour and a number of available vehicles, N . Let also x be the number of
vehicles allocated to the service line and f the resulting frequency. Finally, let T
be the round-trip travel time and Bsy the expected passenger demand between any
origin-destination pair within the 1-hour time period (note that Bsy corresponds to the
3

hourly passenger arrival rate). Then, the optimal service frequency is determined by
the model of Furth and Wilson (1981) by solving the following mixed-integer nonlinear
program (MINLP):
|S|−1

(MINLP)

W ·x+

min
x,f

|S|
X X
s=1 y=s+1

Bsy

1
f

x≤N
f ≤ fmax
x
f≤
T
x ∈ Z≥0
f ∈ R≥1

subject to

(1)
(2)
(3)
(4)
(5)
(6)

The objective function of the above program minimizes two components: (i) W x
which is the operational cost expressed by the number of assigned vehicles x multiplied
by a weight factor W associated with the cost of operating an extra vehicle, and (ii)
|S|
|S|−1
P P
Bsy f1 which is the passenger-related cost expressed by the number of pass=1 y=s+1

sengers traveling between each origin-destination pair sy multiplied by the inverse of
the service frequency f (note that the higher the service frequency, the less passengers
Bsy will have to wait at stations thus reducing the passenger-related costs).
Constraint (2) ensures that we will not assign more vehicles than the total number of vehicles available, N , constraint (3) ensures that the selected frequency is not
higher than the maximum allowed frequency, constraint (4) ensures that the service
frequency is lower than the number of vehicles divided by the round-trip travel time
and constraint (6) that the determined frequency can only take values greater than 1
vehicle per hour. In the next section, we expand the approach of Furth and Wilson
(1981) to a network-wide frequency settings problem by allowing the redistribution
of vehicles among lines and adding elements to the problem formulation in order to
account for the impact of distancing measures.

3.
3.1.

Network-wide frequency setting model that considers distancing
Model formulation

Let us consider a set of lines L = {1, ..., l, ..., |L|} operating in a metro network. Each
line l serves a number of metro stations Sl = {1, 2, ..., |Sl |}. Let Bl,sy be the expected
passenger demand between station s ∈ Sl \ {|Sl |} and station y ∈ Sl | y > s of
line l within an 1-hour period (corresponding to the passenger arrival rate). Before
introducing our nomenclature, we list the main assumptions of our study:
(1) The passenger arrival rate Bl,sy is stable within each 1-hour period of the day.
That is, passenger arrivals at stations are uniformly distributed within the 1-hour
period (see Furth and Wilson (1981); Fu and Yang (2002)).
(2) The obtained passenger demand patterns from historical data are inelastic to
the changes made in service frequencies.

4

The detailed nomenclature of our network-wide frequency setting model that considers distancing measures is presented in Table 1.
Table 1.: Nomenclature
Sets
L = h1, ..., l, ...|L|i
Sl = h1, 2, ..., |Sl |i
A = h1, 2, ..., |A|i

ordered set of metro lines (note that a bi-directional line is considered as a single line that continues its service in the opposite
direction)
ordered set of metro stations served by line l ∈ L
set of arcs in the metro network system. An arc connects successive
stations and can be served by more than one line if they share the
same track corridor

Indices
l
s

train line
metro station

Parameters
Bl,sy
Tl
cl
kl
W
V
M
dl,sy
fl,max
N

expected hourly passenger arrival rate at station s for passengers
whose destination is y and are willing to use line l
round-trip travel time of line l ∈ L considering both directions in
case of a bi-directional line
capacity of trains operating in line l
maximum passenger load inside each train operating in line l to
conform with social distancing
cost of deploying an extra train
value of passenger’s time
fare price per km traveled
traveling distance between stations s and y of line l ∈ L
maximum possible line frequency for line l ∈ L to maintain safe
headways among successive trains serving the same arc (e.g., track
corridor)
number of available trains that can be distributed among all lines

Variables
xl
fl
hl
γl,s
bl,sy
b̃l,sy

number of trains assigned to line l ∈ L
hourly frequency of line l ∈ L
time headway among successive trains of line l ∈ L
train load of each train serving line l when it departs from station
s
hourly passenger demand between stations s and y of line l that
can be served by the trains of line l while conforming to distancing
requirements
hourly passenger demand between stations s and y of line l that
cannot be accommodated by the metro services due to distancing
requirements

Let xl be the number of trains assigned to each line l ∈ L within a certain time
period. Let also Tl be the round-trip travel time of line l. Then, the hourly frequency
of line l should satisfy the inequality constraint (7) because the service frequency is
limited by the number of assigned vehicles to line l:

5

fl ≤

xl
Tl

( ∀l ∈ L )

(7)

In addition, the service frequencies of all lines l ∈ L traversing arc a ∈ A should
not exceed a maximum allowed frequency to ensure safe headways between trains
operating in the same corridor (e.g., we cannot allow trains operating too close to
each other because tracks are split into blocks into which only one train can enter at
a time due to traffic safety constraints). That is,

fl ≤ fl,max

( ∀l ∈ L )

(8)

Next, let γl,s be the average train load of each train serving line l when it departs
from station s. We hereby assume that:
(1) passengers within each train try to maintain the maximum possible distance
between each other,
(2) and all trains serving line l have the same capacity, cl .
This implies a new corona-era capacity limit, kl , where kl < cl is the maximum
train load for trains of line l below which all passengers can keep a safe distance with
each other. This corona-era capacity limit should not be exceeded at any station to
ensure that the risk of COVID-19 infections is minimized. This can be expressed by
the following inequality constraint:

γl,s ≤ kl

( ∀l ∈ L, ∀s ∈ Sl )

(9)

If bl,sy ≤ Bl,sy is the actual passenger demand between stations s and y that can
be accommodated by the allocated trains to line l without exceeding the corona-era
capacity limit, then

bl,sy = Bl,sy − b̃l,sy

( ∀l ∈ L, ∀s ∈ Sl , ∀y ∈ Sl | y ≥ s )

(10)

where b̃l,sy is the unaccommodated passenger demand that should be served outside
our metro system. The passenger demand that is not accommodated by the metro
system represents a loss. When refusing to accommodate demand b̃l,sy , the public
transport service provider incurs a loss. From a societal perspective this loss can mean
reduced accessibility. From the service provider perspective this may mean offering a
compensation, arranging alternative means of transport, or simply the revenue loss of
ticket sales. We hereby assume that the loss is proportional to the travel distance and
we adopt the distance-based fare as a proxy of the loss per unserved passenger-km.
If dl,sy is the distance between stations s and y of metro line l, the operator will lose
a revenue of M · b̃l,sy · dl,sy because b̃l,sy passengers are refused service and M is the
average ticket fee per km traveled. Then, our objective function for the network-wide
frequency setting problem that considers social distancing becomes:

6

z(x, f, b, b̃) := W

X
l∈L

xl +V

X

X

X

bl,sy

l∈L s∈Sl \{|Sl |} y∈Sl | y>s

1 X
+
fl

X

X

M dl,sy b̃l,sy

l∈L s∈Sl \{|Sl |} y∈Sl | y>s

(11)
The first term is the cost of operating the vehicles, the second term is the cost
related to passengers’ waiting times and the third term is the cost of the revenue
losses associated with the passengers that are refused service. The objective function
is formulated as a compensatory monetary term and expresses a generalized cost.
Considering the above formulation, the mathematical program for the network-wide
frequency setting problem that considers distancing measures is formulated as follows:

(Q)

min

z(x, f, b, b̃)

(12)

X

(13)

x,f,b,b̃

s.t.

xl ≤ N

l∈L

xl
( ∀l ∈ L )
(14)
Tl
fl ≤ fl,max ( ∀l ∈ L )
(15)
γl,s ≤ kl ( ∀l ∈ L, ∀s ∈ Sl )
(16)
X
1
( ∀l ∈ L )
(17)
=
bl,1y
fl
fl ≤

γl,1

y∈Sl

γl,s = γl,s−1 −

X
y∈Sl | y<s

1
bl,ys +
fl

X

bl,sy

y∈Sl | y>s

1
( ∀l ∈ L, ∀s ∈ Sl \ {1} )
fl
(18)

bl,sy = Bl,sy − b̃l,sy ( ∀l ∈ L, ∀s ∈ Sl , ∀y ∈ Sl | y ≥ s )
(19)
xl ∈ Z≥0 ( ∀l ∈ L )
fl ∈ R≥1 ( ∀l ∈ L )

(20)
(21)

Note that constraint (13) ensures that the number of all assigned trains within
our time period does not exceed N . In addition, constraint (17) determines the train
load when a train departs the terminal as the number of passengers that board at
station 1 and will alight at any other station y within our 1-hour time period, bl,sy ,
divided by the hourly frequency, fl . Similarly, the recursive equation (18) determines
the train load when a train belonging to line l departs from station s ∈ Sl \ {1}. This
is a passenger flow conservation equation where the train load is equal to the train
load when departing from the
Pprevious1station, γl,s−1 , minus the number of passengers
that alight at station s,
bl,ys fl , plus the number of passengers that board at
y∈Sl | y<s

station s and will alight at any other station y > s of line l.
The mathematical program for the network-wide frequency setting problem that
considers distancing measures, (Q), is a mixed-integer nonlinear programming problem
(MINLP) because of its fractional objective function and its fractional constraints (17)
and (18).
7

3.2.

Reformulation to a mixed-integer quadratic program (MIQP)

The MINLP problem (Q) can be transformed to an easier-to-solve mixed-integer
quadratic program (MIQP) that neither contains a fractional objective function nor
fractional constraints. Let us consider a line headway of hl = f1l , ∀l ∈ L. Then,
P
the fractional constraint in Eq.(17) becomes γl,1 =
hl ( ∀l ∈ L ). In
y∈Sl bl,1yP
addition, the fractional constraint (18) becomes γl,s = γl,s−1 − y∈Sl | y<s bl,ys hl +
P
y∈Sl | y>s bl,sy hl ( ∀l ∈ L, ∀s ∈ Sl \ {1} ).
Constraint (14) is transformed into the following quadratic constraint: hl xl ≥
1
Tl ( ∀l ∈ L ). Finally, constraint (15) becomes hl ≥ fl,max
( ∀l ∈ L ) and the
objective function takes the following form:

z(x, h, b, b̃) := W

X

xl +V

l∈L

X

X

X

X
bl,sy hl +

l∈L s∈Sl \{|Sl |} y∈Sl | y>s

X

X

M dl,sy b̃l,sy

l∈L s∈Sl \{|Sl |} y∈Sl | y>s

(22)
This reformulation results in the following MIQP:

(Q̃)

min

z(x, h, b, b̃)

(23)

X

(24)

x,h,b,b̃

s.t.

xl ≤ N

l∈L

hl xl ≥ Tl ( ∀l ∈ L )
1
( ∀l ∈ L )
hl ≥
fl,max

(25)
(26)

γl,s ≤ kl ( ∀l ∈ L, ∀s ∈ Sl )
(27)
γl,1 =

X

bl,1y hl ( ∀l ∈ L )

(28)

y∈Sl

γl,s = γl,s−1 −

X

bl,ys hl +

y∈Sl | y<s

X

bl,sy hl ( ∀l ∈ L, ∀s ∈ Sl \ {1} )

y∈Sl | y>s

(29)
bl,sy = Bl,sy − b̃l,sy ( ∀l ∈ L, ∀s ∈ Sl , ∀y ∈ Sl | y ≥ s )
(30)
xl ∈ Z≥0 ( ∀l ∈ L )
hl ∈ R≥0 ( ∀l ∈ L )

4.
4.1.

(31)
(32)

Model application
Case study description

We apply our model to the case study of the Washington D.C. Metro system of the
Washington Metropolitan Area Transit Authority (WMATA). It is a rapid transit
system serving the Washington metropolitan area in the United States. The network
consists of six lines, ninety-one metro stations. The metro system serves the District

8

of Columbia, as well as several jurisdictions in the states of Maryland and Virginia.
It is the second busiest rapid transit system in the United States with 295 million
passenger trips in 2018 (WMATA 2019a). In 2019, the average weekday ridership was
626 thousand trips (WMATA 2019b). Passengers validate their smart card (SmartTrip) upon entering an origin station and leaving a destination station, and the fee is
determined based on the traveled distance of the origin-destination combination. The
network configuration consisting of the six metro lines is presented in Fig.1.

Figure 1.: Washington D.C. metro network map, source: www.wmata.com
Due to infrastructure capacity limits, the maximum allowed frequency per track
segment is 30 vehicles per hour, resulting in a minimum permitted headway of 2
minutes at common track corridors. From Fig.1 one can note that there are several
track corridors that are traversed by vehicles serving more than one line. For the
purpose of our case study, we assume the availability of N = 140 trains. Table 2
provides information on each of the service lines, including the number of stations,
total bi-directional track length, and the names of the terminal stations.

9

Table 2.: Terminals and line distances
Terminals
stations
(per direction)

distance in km
(both directions)

Western/Southern

26
27
28
21
26
22

85
97.6
95.2
74.16
102.6
48.5

Vienna
FranconiaSpringfield
WiehleReston East
Branch Avenue
Shady Grove
Huntington

orange line
blue line
silver line
green line
red line
yellow line

Eastern/Northern
New Carrollton
Largo Town Center
Largo Town Center
Greenbelt
Glenmont
Greenbelt

In order to investigate the impact of distancing measures, we concentrate on the
rush hour (8:00-9:00 am) of a typical weekday. In particular, we examine the need to
deploy additional trains and possibly refuse boardings. The hourly rate of passengers
arriving at station s of line l and destined to station y is presented in Fig.2 as a
percentage of the vehicle capacity. This expected hourly arrival rate is derived from the
analysis of historical smart card data with complete information regarding passenger
boarding and alighting locations from 20 working days in September 2018. The linespecific origin-destination matrices have been inferred using the origin, destination,
and transfer inference (ODX) method as detailed in (Sánchez-Martı́nez 2017).
50%
ORANGE LINE

1
5

40%

10
15

26

1

5

10

15

20

26

BLUE LINE

1
5

40%

GREEN LINE

15
20

15
20% 20

20%

10% 27

25
10% 28

5

1 5

10 15 20

27

20%

21

1

5

10

15

21

10%
1 5

10 15 20 25 28

0%
50%
RED LINE

1
5

40%
30%

15

YELLOW LINE

1

40%
30%

10

20% 15

20

10% 26

0%
50%

5

30% 10

15

40%
30%

40%

10

SILVER LINE

1
5

30% 10

0%
50%
1

50%

30% 10
20%

20

50%

1

5

10

15

0%

20

26

10% 22
0%

20%
10%
1

5

10

15

22
0%

Figure 2.: Hourly passenger demand per origin-destination pair for each line during
the peak hour of 8-9am as a percentage of the actual vehicle capacity
The distances travelled by each of the metro lines vary considerably. Fig.3 shows the
share of passenger trips of a certain traveled distance for each of the lines. This share
is calculated as the number of passenger trips of a line for a specific travel distance
divided by the total number of trips performed by all lines. As can be seen in Fig.3 the
10

Red line has up to three times more passenger trips than other lines and passengers
trips on the Red, Orange and Silver lines travel longer distances than those on the
Blue, Yellow and Green lines.

Share of total passenger trips

3.5%

orange line
blue line
silver line
green line
red line
yellow line

3%
2.5%
2%
1.5%
1%
0.5%
0%
0

10

20

30
Distance (km)

40

50

Figure 3.: Share of passenger trips of each metro line from 8am to 9am with respect
to the traveled distance
The values of the remaining model parameters are given in Table 3. Each metro train
consists of 6 to 8 rail cars, with an average maximum capacity of 1700 people. During
the morning period (5am-12pm) a metro train carries an average of 133 travelers at any
given time. This value, however, varies greatly with some central segments reaching
capacity limits. Assuming that passengers are evenly spaced across platforms, each
train operating in any line l ∈ L can carry only kl = 703 people at any given time to
satisfy a 1-meter distancing requirement, kl = 312 to fulfill a 1.5-meter distance, and
kl = 176 to comply with a 2-meter distance (see Krishnakumari and Cats (2020)).
Table 3.: Parameter values
lines

Tl (minutes)
cl (passengers per train)
kl without social distancing
kl with 1 meter social distancing
kl with 1.5 meter social distancing
kl with 2 meters social distancing

orange

blue

silver

green

red

yellow

150
1700
1700
703
312
176

156
1700
1700
703
312
176

170
1700
1700
703
312
176

122
1700
1700
703
312
176

160
1700
1700
703
312
176

120
1700
1700
703
312
176

Passengers’ value of time in our case study is V = 14.67$ per hour, or, equivalently,
24.4 cents per minute (based on the value of travel time reported in White (2016)
and adjusting the value by 1% per year). In addition, we have two parameters W
and M corresponding to the operational cost of using an extra train and the cost
associated with the travel distances of passengers who are refused service, respectively.
The value of parameter W depends on the preferences of the metro operator since some
operators might be willing to use all their available trains to reduce the passenger
waiting times, whereas other operators might seek an economically beneficial trade11

off between operational costs and passenger waiting times. We tested our model with
different values of W and selected a cost of W = 36.675$ per extra train since this
cost returns the same train allocation to lines when solving program (Q̃) for the case
of no distancing (i.e. normal capacity levels) as the planned train allocation actually
performed by the metro operator. Further, the passenger fare at the metro system
depends on the travel distance and the time period (peak/off-peak periods). The 8am9am is a peak hour and the fare cost per passenger is found to have an average value
of M = 0.7$ per km traveled.
4.2.

Scenario design and implementation

The topic of distancing is currently contested as the transmission of COVID-19 is not
yet well characterized. It is likely to be similar to SARS, which was spread by contact,
droplet, and airborne routes (Yu et al. 2004). The World Health Organization and
most countries recommend an 1.5- to 2-meter social distancing. In a study with 94
patients of influenza, Bischoff et al. (2013) showed that the virus can be transmitted
up to ∼1.9 meters from patients during nonaerosol-generating patient-care activities.
It is important to note that increasing the distance among passengers does not proportionally decrease the probability of transmitting COVID-19.
To assess the impact of distancing measures, we consider the following four scenarios:
(I) the do-nothing scenario that does not consider distancing measures and can
utilize the full capacity of 1700 passengers per train;
(II) the 1-meter distancing scenario that allows train loads of up to 703 passengers
per train;
(III) the 1.5-meter distancing scenario that allows train loads of up to 312 passengers
per train;
(IV) the 2-meter distancing scenario that allows train loads of up to 176 passengers
per train.
We program and solve our MIQP model in program (Q̃) using LINGO 18.0. LINGO
uses the LINDO software package for nonlinear integer optimization (Schrage 1986).
Our numerical experiments are executed in a general-purpose computer with Intel
Core i7-7700HQ CPU @ 2.80GHz and 16 GB RAM. In all four scenarios, LINGO
was capable of returning a locally optimal solution within less than 20 seconds using
branch and bound and quadratic programming. To facilitate the reproduction of our
model to other networks, its source code is publicly released at Gkiotsalitis (2020).
4.3.

Results and analysis

The objective function score(s) of the solution of each scenario as well as the computation times are presented in Table 4.

12

Table 4.: Objective function value of the respective solution, iterations until convergence, and computational costs
Objective function score ($)

iterations until convergence

computation time (sec)

5980.5
6362.3
85390.5
210835.9

626
259
747
244

17.08
15.78
16.33
14.95

I. Do-nothing
II. 1-meter
III. 1.5-meter
IV. 2-meter

The decision variable values in the optimal solutions under each distancing scenario
are reported in Table 5 and present the allocated vehicles per line and the resulting
service headway.
Table 5.: Assigned trains, xl , and headway (in minutes), hl , per line l ∈ L at each one
of the social distancing scenarios
social distancing scenarios
I. Do-nothing

II. 1-meter

III. 1.5-meter

IV. 2-meter

trains

headway

trains

headway

trains

headway

trains

headway

orange
blue
silver
green
red
yellow

15
10
15
10
25
7

10
16
12
13
7
18

19
14
19
14
41
7

8
12
9
9
4
18

23
9
23
15
66
4

7
18
8
9
3
30

28
6
24
9
69
4

6
26
7
14
3
30

total

82

n/a

114

n/a

140

n/a

140

n/a

From Table 5 one can note that at the do-nothing case we only deploy 82 trains
out of the N = 140. The same passenger demand requires the utilization of 114 trains
in the case of 1-meter distancing (case II). Finally, scenarios III and IV require the
deployment of all available trains.
In addition to the increase in operational costs due to the deployment of more
vehicles and train drivers, a number of passengers are also refused service in scenarios
III and IV. In Fig.4 we present the train load at each station for each one of the six lines.
The normal vehicle capacity of cl = 1700 passengers is not reached at the base case
scenario once the fleet is optimally allocated. The respective optimal solution results in
train loads that never exceed 1250 passengers. It can also be observed that the optimal
allocation results with trains loads not exceeding 703 passengers per train on the Yellow
line in the base case (scenario I). Consequently, there is sufficient residual capacity to
also accommodate the demand when subject to 1-meter distancing (scenario II). In
contrast, all other lines require re-allocating trains to ensure that the new capacity
limit is not violated when switching from scenario I to scenario II, as can be seen in
Table 5.

13

250
0
1

20 30
Station

40

750
500
250
0
1

10

20
30
Station

500
250
0
1

10

20 30 40
Station

750
500
250
0

42

1

10

20 30
Station

750
500
250
0

1 10 20 30 40
Station

40

56

YELLOW LINE

1250

no social distancing
1m distancing
1.5m distancing
2m distancing

1000

no social distancing
1m distancing
1.5m distancing
2m distancing

1000

54

RED LINE

1250

no social distancing
1m distancing
1.5m distancing
2m distancing

1000

750

52

GREEN LINE

1250
Load in passengers per train

10

no social distancing
1m distancing
1.5m distancing
2m distancing

1000

SILVER LINE

1250
Load in passengers per train

500

Load in passengers per train

750

Load in passengers per train

Load in passengers per train

no social distancing
1m distancing
1.5m distancing
2m distancing

1000

BLUE LINE

1250

Load in passengers per train

ORANGE LINE

1250

no social distancing
1m distancing
1.5m distancing
2m distancing

1000
750
500
250
0

52

1

10

20 30
Station

44

Figure 4.: Passenger load of each train operating from 8-9am at each metro station in
scenarios I, II, III and IV. The red markers indicate the change of line direction.
As specified in the problem constraints, the optimal solution for case II does not
allow train loads of more than 703 passengers, for case III of more than 312, and for
case IV of more than 176. This results in different train occupancy levels for each
distancing scenario. Let the train occupancy be defined as the train load divided by
the number of seats (in our case study, each train has c̃l = 616 available seats):

Occupancy =

1 X γl,s
|Sl |
c̃l

(∀l∈L)

(33)

s∈ Sl

The average train occupancy level per line for each one of the distancing scenarios
is presented in Table 6. The occupancy level averaged over all line segments ranges
in the optimal solution for the base case from 28% for the Blue and Yellow lines to
66% for the Red line. These levels drop to 14%-19% for all lines when complying with
2-meter distancing (scenario IV).
Table 6.: Average train occupancy for each distancing scenario
social distancing scenarios

orange
blue
silver
green
red
yellow

I. Do-nothing

II. 1-meter

III. 1.5-meter

IV. 2-meter

50%
28%
47%
36%
66%
28%

39%
19%
39%
25%
39%
28%

28%
19%
28%
19%
22%
22%

19%
17%
19%
18%
17%
14%

14

When enforcing distancing measures of 1.5- or 2-meters, even after optimally reallocating the fleet, some passengers are refused service. In Fig.5 we report the number of
refused boardings at each metro station for the 1.5- and 2-meters distancing policies.
The Red line which has the highest passenger demand also sees the highest number of
refused passenger boardings. This happens in spite of our optimization model assigning
66 and 69 trains to the Red line in the cases of 1.5- and 2-meter distancing, respectively (see Table 5). Note that allocating more trains to the Red line (i.e. 70 trains)
would have resulted in violating the maximum frequency constraint that requires a
minimum headway of 2 minutes.
ORANGE LINE

750
500
250

500
250
0

1

10

20 30
Station

40

52

1.5m distancing
2m distancing

Refused boardings

1000
750
500
250
0
1

10

20
30
Station

42

1.5m distancing
2m distancing

1000
750
500
250
0

1

GREEN LINE

1250
Refused boardings

750

10

20 30 40
Station

54

1 10 20 30 40
Station

RED LINE

2750
2500
2250
2000
1750
1500
1250
1000
750
500
250
0

1.5m distancing
2m distancing

56

YELLOW LINE

1250
Refused boardings

0

1000

SILVER LINE

1250

1.5m distancing
2m distancing

Refused boardings

1000

BLUE LINE

1250

1.5m distancing
2m distancing

Refused boardings

Refused boardings

1250

1.5m distancing
2m distancing

1000
750
500
250
0

1

10

20 30
Station

40

52

1

10

20 30
Station

44

Figure 5.: Refused passenger boardings per station during the 8-9am period in 1.5- and
2-meter distancing scenarios. The red markers indicate the change of line direction
To summarize the results of the impact of considering social distancing in the planning phase of metro operations, we use the following key performance indicators:
(1) the average value of the maximum possible passenger waiting times,
O1 :=

XX

X

l∈L s∈Sl y∈Sl | y≥s

bl,sy

1
fl

(2) the number of trains that are P
needed to operate the metro service, which indicate
the operational costs, O2 :=
xl
l∈L

(3) the average train occupancy, O3 (%)
(4) the number of instances where passengers
P P cannot maintain a distance of at least
1.5 meter from each other, O4 :=
rl,s where rl,s = 0 if γl,s ≤ 312, and
l∈L s∈Sl

rl,s = 1 otherwise.
15

(5) the number of passengers
who are refused service multiplied by their traveled
P P
P
distance, O5 :=
b̃l,sy · dl,sy
l∈L s∈Sl y∈Sl | y>s

(6) the number of passengers who are refused service, O6 :=

P P

P

b̃l,sy

l∈L s∈Sl y∈Sl | y>s

1

2

140

10000

Utilized trains

Maximum passenger
waiting times (min)

12500

7500
5000
No distancing 1-meter 1.5-meter
Social distancing policy

Instances where the 1.5-meter
distancing is not kept

Average train occupancy

100
80
No distancing 1-meter 1.5-meter
Social distancing policy

2-meter

3

45%
40%
35%
30%
25%
20%
15%
10%
No distancing 1-meter 1.5-meter
Social distancing policy

120

2-meter

100

50
25
0
No distancing 1-meter 1.5-meter
Social distancing policy

2-meter

6

Refused passenger boardings

Refused passenger-km

4

75

5

300000
250000
200000
150000
100000
50000
0
No distancing 1-meter 1.5-meter
Social distancing policy

2-meter

2-meter

30000
20000
10000
0
No distancing 1-meter 1.5-meter
Social distancing policy

2-meter

Figure 6.: Values of key performance indicators under different social distancing scenarios

5.

Discussion and conclusion

We propose a network-wide model that can set the optimal frequencies of services
lines under different distancing scenarios and apply it to the case study network of
the Washington D.C. metro. The model determines the optimal fleet allocation while
considering unsatisfied demand in the event that not all demand can be absorbed due
to the varying capacity limits of different distancing policies.
16

The results of our model indicate that the normal capacity limit is not binding
in the optimal solution for the base case scenario with no distancing requirements.
Moreover, all passenger demand can be satisfied when deploying 82 out of the 140
trains available so as to optimally balance between the operational costs and the
passenger waiting times at stations. Furthermore, it is possible to comply with the 1m
distancing requirements while still accommodating all passengers by increasing the
service frequency, hence requiring a larger fleet size of 114 vehicles. This also yields
shorter passenger waiting times. This does imply, however, that in about 25% of the
instances, a distancing of less than 1.5m occurs, potentially inducing public health
risks (see the graph of the key performance indicator O4 in Fig.6).
Stricter distancing policies come at a greater cost. Enforcing 1.5m distancing requires deploying the maximum number of trains assumed available in our case study.
Even though the entire fleet of 140 vehicles is utilized, 16,456 passenger-trips of more
than 112,582 passenger-km cannot be accommodated. These numbers increase twofold (34,025 pass trips) and almost three-fold (292,412 pass-km), respectively, when
imposing 2m distancing. In the latter case, the average train occupancy considering
only the seated capacity plummets below 20% for all metro lines (see Table 6).
As can be expected, our model allocates as many vehicles as possible to the most
heavily-utilized line (i.e. Red line) given the safety-related 2-min minimum headway
constraint. In contrast, for some other lines (e.g. Yellow), there are more allocated vehicles in the base case scenario with no distancing measures than in the scenarios with
1.5m and 2m distancing where 58 more vehicles are deployed (see Table 5). This is an
interesting finding since one might have expected that the number of trains assigned
to each line will increase (or at least will not decrease) when allocating an overall
larger fleet and imposing stricter capacity constraints. However, when the permitted
vehicle capacity is enough to satisfy the passenger demand (i.e. in the base case scenario), the relatively lightly-utilized lines receive more vehicles to reduce passenger
waiting times at stations since this is one of our main objectives. Notwithstanding,
when the permitted capacity is reduced to comply with the distancing policies and
we cannot anymore accommodate all passengers despite having employed all available
resources, then vehicles are redistributed from lightly-utilized lines to heavily-utilized
lines that already have to refuse many passengers (see Fig.3). That is, the inability to
accommodate the passenger demand in some lines results in the redistribution of vehicles because of the higher priority given to reducing the number of refused passengers
compared to shortening waiting times.
Our model formulation strives for minimizing refused pass-km so as to minimize the
associated loss revenues or costs inflicted. The reallocation of trains over lines under
stricter distancing policies is hence not only driven by the wish to reduce the number of
denied boardings, but more specifically the objective to reduce unsatisfied passengerkm. This implies that the model seeks to prioritize the allocation of resources to lines
characterized by longer passenger trips over lines that are mostly used for shorter trips.
This effect is visible in Table 5 as vehicles are reallocated from lines characterized by
short passenger trips (e.g. Green, majority of the trips are less than 10km, see Fig. 3)
to lines characterized by longer passenger trips (e.g. Orange, many trips are between
10 and 20km) when switching from 1.5m to 2m distancing. This change in resource
allocation is hence driven by the underlying demand patterns - passenger volumes and
travel distance.
The aforementioned findings of our network-wide frequency setting approach that
considers distancing measures can support planning decisions made by public transport
service providers in the phasing of exit strategies and the aftermath of the corona crisis.
17

Model formulation strives to balance between operational, passenger, revenue loss, and
health-risk related considerations. Depending on the local circumstances, planners and
policymakers may assign different terms to the different objectives and compare the
resulting performance under different distancing requirements. The model can also be
used to dimension service supply for different demand levels during lock-down periods
and potential changes associated with the outbreak and evolution of an epidemic.
Primary directions for further research pertain to refining and modeling the impact
of refused demand. The cost associated with unsatisfied demand can be modified to
account for aspects extending beyond revenue losses, such as reduced access to activities, customer retention effect, externalities caused by switching to using a car, or the
cost of offering compensation or an alternative mean of transport. Future analysis may
consider the equity implications of alternative solutions. The potential of partnerships
with on-demand service providers to cater for the unsatisfied demand that exceeds the
permitted capacity limits by offering them a (shared)ride as well as the operations of
such services can possibly be the subject of further investigation.

6.

Acknowledgements

The authors thank Washington Metropolitan Area Transit Authority and in particular
Jordan Holt for their invaluable cooperation and for providing the data that made this
study possible.

References
Arbex, Renato Oliveira, and Claudio Barbieri da Cunha. 2015. “Efficient transit network
design and frequencies setting multi-objective optimization by alternating objective genetic
algorithm.” Transportation Research Part B: Methodological 81: 355–376.
Bahl, Prateek, Con Doolan, Charitha de Silva, Abrar Ahmad Chughtai, Lydia Bourouiba,
and C Raina MacIntyre. 2020. “Airborne or droplet precautions for health workers treating
COVID-19?” The Journal of infectious diseases .
Bischoff, Werner E, Katrina Swett, Iris Leng, and Timothy R Peters. 2013. “Exposure to
influenza virus aerosols during routine patient care.” The Journal of infectious diseases 207
(7): 1037–1046.
Borndörfer, Ralf, Martin Grötschel, and Marc E Pfetsch. 2007. “A column-generation approach
to line planning in public transport.” Transportation Science 41 (1): 123–132.
Cats, Oded, and Stefan Glück. 2019. “Frequency and vehicle capacity determination using a
dynamic transit assignment model.” Transportation Research Record 2673 (3): 574–585.
Ceder, Avishai. 1984. “Bus frequency determination using passenger count data.” Transportation Research Part A: General 18 (5-6): 439–453.
Ceder, Avishai. 2002. “Urban transit scheduling: framework, review and examples.” Journal
of urban planning and development 128 (4): 225–244.
Ceder, Avishai, and Nigel HM Wilson. 1986. “Bus network design.” Transportation Research
Part B: Methodological 20 (4): 331–344.
Cipriani, Ernesto, Stefano Gori, and Marco Petrelli. 2012. “Transit network design: A procedure and an application to a large urban area.” Transportation Research Part C: Emerging
Technologies 20 (1): 3–14.
Cortés, Cristián E, Sergio Jara-Dı́az, and Alejandro Tirachini. 2011. “Integrating short turning
and deadheading in the optimization of transit services.” Transportation Research Part A:
Policy and Practice 45 (5): 419–434.
Delle Site, Paolo, and Francesco Filippi. 1998. “Service optimization for bus corridors with

18

short-turn strategies and variable vehicle size.” Transportation Research Part A: Policy and
Practice 32 (1): 19–38.
dellOlio, Luigi, Angel Ibeas, and Francisco Ruisánchez. 2012. “Optimizing bus-size and headway in transit networks.” Transportation 39 (2): 449–464.
Fu, Liping, and Xuhui Yang. 2002. “Design and implementation of bus-holding control strategies with real-time information.” Transportation Research Record: Journal of the Transportation Research Board (1791): 6–12.
Furth, Peter G, and Nigel HM Wilson. 1981. “Setting frequencies on bus routes: Theory and
practice.” Transportation Research Record 818 (1981): 1–7.
Gkiotsalitis, K. 2020. “Covid-19 frequency setting model source code.” https://github.com/
KGkiotsalitis/covid-19-frequency-setting-model.
Gkiotsalitis, K, and O Cats. 2018. “Reliable frequency determination: Incorporating information on service uncertainty when setting dispatching headways.” Transportation Research
Part C: Emerging Technologies 88: 187–207.
Gkiotsalitis, Konstantinos, and Oded Cats. 2017. “Exact optimization of bus frequency settings
considering demand and trip time variations.” In Proceedings of the Transportation Research
Board 96th Annual Meetings, .
Gkiotsalitis, Konstantinos, Zongxiang Wu, and O Cats. 2019. “A cost-minimization model
for bus fleet allocation featuring the tactical generation of short-turning and interlining
options.” Transportation Research Part C: Emerging Technologies 98: 14–36.
Ibarra-Rojas, OJ, F Delgado, R Giesen, and JC Muñoz. 2015. “Planning, operation, and
control of bus transport systems: A literature review.” Transportation Research Part B:
Methodological 77: 38–75.
Jarvis, Christopher I, Kevin Van Zandvoort, Amy Gimma, Kiesha Prem, Petra Klepac,
G James Rubin, and W John Edmunds. 2020. “Quantifying the impact of physical distance measures on the transmission of COVID-19 in the UK.” BMC medicine 18 (1): 1–10.
Krishnakumari,
Panchamy,
and
Oded
Cats.
2020.
“Virus
spreading
in
public
transport
networks:
the
alarming
consequences
of
the
business
as
usual
scenario.”
https://www.linkedin.com/pulse/
virus-spreading-public-transport-networks-alarming-usual-krishnan/.
Mandl, Christoph E. 1980. “Evaluation and optimization of urban public transportation networks.” European Journal of Operational Research 5 (6): 396–404.
Pattnaik, SB, S Mohan, and VM Tom. 1998. “Urban bus transit route network design using
genetic algorithm.” Journal of transportation engineering 124 (4): 368–375.
Sánchez-Martı́nez, Gabriel E. 2017. “Inference of public transportation trip destinations by
using fare transaction and vehicle location data: Dynamic programming approach.” Transportation Research Record 2652 (1): 1–7.
Schrage, Linus. 1986. Linear, integer and quadratic programming with LINDO. The Scientific
Press.
Sun, S, and WY Szeto. 2019. “Optimal sectional fare and frequency settings for transit networks with elastic demand.” Transportation Research Part B: Methodological 127: 147–177.
Szeto, Wai Yuen, and Yongzhong Wu. 2011. “A simultaneous bus route design and frequency
setting problem for Tin Shui Wai, Hong Kong.” European Journal of Operational Research
209 (2): 141–155.
TfL. 2020. “Check the latest travel information and find out how we’re responding to coronavirus.” https://tfl.gov.uk/campaign/coronavirus-covid-.
UITP. 2020. “Public transport authorities and COVID-19 impact and response
to a pandemic.” https://australia-newzealand.uitp.org/sites/default/files/V1_
COVID-19%20impacts_AJ_v03.pdf.
Ul Abedin, Zain, Fritz Busch, David ZW Wang, Andreas Rau, and Bo Du. 2018. “Comparison
of public transport network design methodologies using solution-quality evaluation.” Journal
of Transportation Engineering, Part A: Systems 144 (8): 04018036.
Verbas, İ Ömer, Charlotte Frei, Hani S Mahmassani, and Raymond Chan. 2015. “Stretching
resources: sensitivity of optimal bus frequency allocation to stop-level demand elasticities.”

19

Public Transport 7 (1): 1–20.
Verbas, İ Ömer, and Hani S Mahmassani. 2013. “Optimal allocation of service frequencies over
transit network routes and time periods: formulation, solution, and implementation using
bus route patterns.” Transportation research record 2334 (1): 50–59.
Verbas, İ Ömer, and Hani S Mahmassani. 2015. “Exploring trade-offs in frequency allocation
in a transit network using bus route patterns: Methodology and application to large-scale
urban systems.” Transportation Research Part B: Methodological 81: 577–595.
White, V. 2016. “Revised Departmental Guidance on Valuation of Travel Time in Economic
Analysis.” Office of the Secretary of Transportation, US Department of Transportation,
Available at: transportation. gov/sites/dot. gov/files/docs/2016% 20Revised% 20Value%
20of% 20Travel% 20Time% 20Guidance. pdf .
WHO. 2020. “Rolling updates on coronavirus disease (COVID-19).” https://www.who.int/
emergencies/diseases/novel-coronavirus-2019/events-as-they-happen.
WMATA.
2019a.
“Metro
Snapshot.”
https://www.wmata.com/about/upload/
2019-Metro-Snapshot-Fact-Sheet.pdf.
WMATA. 2019b. “Metrorail ridership grew by 20,000 trips per weekday in 2019.” https:
//www.wmata.com/about/news/2019-Metrorail-ridership.cfm.
WMATA. 2020a. “Covid-19 Service Information.” https://www.wmata.com/service/
status/details/covid-operating-status.cfm.
WMATA. 2020b. “Customers should wear cloth face coverings on Metro.” https://www.
wmata.com/service/status/details/covid-face-covering.cfm.
Yu, Bin, Zhongzhen Yang, and Jinbao Yao. 2010. “Genetic algorithm for bus frequency optimization.” Journal of Transportation Engineering 136 (6): 576–583.
Yu, Ignatius TS, Yuguo Li, Tze Wai Wong, Wilson Tam, Andy T Chan, Joseph HW Lee,
Dennis YC Leung, and Tommy Ho. 2004. “Evidence of airborne transmission of the severe
acute respiratory syndrome virus.” New England Journal of Medicine 350 (17): 1731–1739.

20

