OPTIMAL CONTROL OF COVID-19 INFECTION RATE
CONSIDERING SOCIAL COSTS ∗

arXiv:2007.13811v3 [math.OC] 12 Feb 2021

AARON Z. PALMER† , ZELDA B. ZABINSKY‡ , AND SHAN LIU‡
Abstract. The COVID-19 pandemic has posed a policy making crisis where efforts to slow down
or end the pandemic conflict with economic priorities. This paper provides mathematical analysis
of optimal disease control policies with idealized compartmental models for disease propagation and
simplistic models of social and economic costs. Two locally optimal control strategies are found
and categorized as ‘suppression’ and ‘mitigation’ strategies. We analyze how these strategies change
when we incorporate vaccination into the model and find a new optimal ‘delay-mitigation’ strategy.
Key words. Optimal control, SIR model, COVID-19
AMS subject classifications. 92D30; 93C95, 90C90

1. Introduction. The spread of infectious diseases in a population can be modeled in a variety of ways. Here we focus on the optimization and control of stochastic
and deterministic ‘compartmental’ models, where the population is grouped into a
handful of states that represent the progression of the disease. These models have the
benefit of having relatively few variables and parameters, and can be comprehended
intuitively.
Our main contribution is to study the optimal control of models pertaining to
COVID-19 with control implemented through influencing the infection rate, e.g., by
social distance policies. For instance, stay-at-home orders, wearing masks, and other
non-pharmaceutical interventions (NPIs) can serve to reduce the infection rate, while
relaxing NPIs and opening up society increases infection rate. Our analysis focuses on
qualitative aspects of the optimal control policies with an aim to better understand
the effective strategies for combating COVID-19. In the optimal control model, we
optimize over a combination of: (i) the end time, which represents the time the disease
is below a given threshold and considered under control; (ii) a running cost due to
controlling infection rate, that may be interpreted as the societal cost of implementing
NPIs; (iii) a running hospitalization cost; and (iv) a death cost at end time.
We use realistic parameters for COVID-19, and solve for optimal control policies.
The optimal polices fall into one of two categories that are widely used to describe
real world responses: ‘suppression’ strategies that aim to eliminate the disease in a
population, and ‘mitigation’ strategies that aim to reduce the negative impact of the
disease. We find that the ‘suppression’ strategy performs significantly better than the
‘mitigation’ or any other strategy.
We then incorporate vaccinations and find that while the ‘suppression’ strategy
remains a viable solution under some conditions, the ‘mitigation’ strategy transforms
into a globally optimal ‘delay-mitigation’ strategy, where the spread of the disease is
delayed until vaccination takes effect.
1.1. Literature Review. There is a long history of ‘compartmental’ models
including previous research into optimization and control and applications to the
COVID-19 pandemic. We provide a non-exhaustive summary of relevant works. In
∗ This

work has been funded in part by the National Science Foundation grant CMMI-1935403.
Department, University of British Columbia, Vancouver BC, Canada
(azp@math.ubc.ca).
‡ Department of Industrial & Systems Engineering, University of Washington, Seattle WA
(zelda@uw.edu, liushan@uw.edu).
† Mathematics

1

2

AARON Z. PALMER, ZELDA B. ZABINSKY, AND SHAN LIU

these works it can be seen how different specifications of the problem yield distinct
results. Despite the differences, these results share important qualitative features that
are also reflected in the results of our approach.
A classic optimal control formulation for deterministic and stochastic SusceptibleInfectious-Recovered (SIR) compartmental models is analyzed in [24]. The control
variable adjusts the rate at which to remove individuals from the infected population
by isolation. The solutions that are found either expend all or none of the resources.
Deterministic SIR and Susceptible-Exposed-Infectious-Recovered (SEIR) models are
considered in [2] with control by vaccination, quarantine, screening, or health campaigns. It is found that in all cases the optimal policy to minimize number of infected
is to apply maximum effort on an initial time interval. A similar finding was made for
an SEIR type model applied to COVID-19 in [18] with control on the infection rate.
An SEIR model with logistic population growth is considered in [21], where the control found by numerical optimization appears to approach a state where the disease
is endemic in the population. An SEIR type model has been applied to COVID-19
in [7] with the infection rate controlled up until a vaccine is developed. The optimal
control found suppresses the disease until near the development of the vaccine when
the control is relaxed. A variation is considered [11] where instead of vaccination it is
assumed that control reverts back to the norm, and the result is a mitigation strategy
that brings the susceptible population to herd immunity. A deterministic SIR model
with control by vaccination and isolation is considered in [9]. They minimize total
outbreak size, and show that it is optimal to allocate the available resources to until
the resources run out.
A discounted deterministic Susceptible-Infectious-Susceptible (SIS) model with
two geographic regions appears in [20], where the allocation of medical resources
between the two regions is optimized. The main finding is that it is better to treat
the region with less incidence of disease first. A review of epidemic models and control
was undertaken in [17] with an emphasis of effects from the network of individuals
(not seen in compartmental models). A spatial SIR model is considered in [12] with
control of spatial dynamics.
The distinction between open loop and feedback control for a stochastic epidemic
simulation model is studied in [3], where the feedback control is found to perform
better because the approximate model loses accuracy across the entire time domain.
In this paper, we focus on open loop control and consider some aspects of feedback
control in the appendix.
The report [8] provides an analysis of ‘suppression’ and ‘mitigation’ strategies for
the COVID-19 pandemic, although optimality is not addressed. Numerous papers
have analyzed the efficacy of different non-pharmaceutical interventions for COVID19, including [1], [13], [16], [23]. We do not address specific non-pharmaceutical
interventions, but recognize that various interventions (e.g., social distancing, mask
wearing, lock-down orders) impact the infection rate, which is our control variable.
The recent work [15] considers optimal control using piecewise constant strategies, and
compares the optimal ‘suppression’ strategy with a non-optimal ‘mitigation’ strategy.
In our results, both the ‘suppression’ strategy and the ‘mitigation’ strategy are found
to be locally optimal, however, the end time for the ‘mitigation’ strategy is much
longer than that of the ‘suppression’ strategy.
We summarize the elements of our model and results that have not appeared in
prior works:
• The form of the cost function includes a social and economic control cost that
represents the impact of NPI’s, as well as hospitalization and death costs.

OPTIMAL CONTROL OF COVID-19 INFECTION RATE WITH SOCIAL COSTS

3

The optimal control policy maintains positivity of the controlled infection
rate while allowing for a continuum of values.
• The end time in our model is determined by elimination of the disease (below
a threshold) in the population.
• We find two locally optimal strategies, both of which are the global optimum
for different choices of parameters.
• We combine the control of infection rate with a vaccination roll-out to find a
qualitatively novel strategy.
1.2. Model Assumptions. We consider a model that has six states: susceptible, exposed, infectious, hospitalized, recovered, and dead. We optimize a cost
comprised of the cost of hospitalizations, the cost of deaths, and the social/economic
costs of reducing the infection rate by social distancing policies and other NPIs. The
model terminates when the disease has been eliminated from the population (below
a small threshold). We also incorporate a vaccine, that removes individuals from
the susceptible population at a fixed rate. We assume that the entire susceptible
population is willing to get vaccinated, and that, once vaccinated, achieve immunity.
Realistic parameters for transition rates and costs are chosen from related literature and data on COVID-19. We also test the model with ranges of values for
some parameters, including population size, mean infectious period, cost coefficient,
vaccination rate, and initial conditions.
Our model assumes a negligible portion of the population can be re-infected with
the disease after recovering, and omits births and immigration. By assuming that the
parameters of the disease remain constant, we ignore the possibility that mutations
of the virus may change its parameters or allow the mutated virus to infect previously recovered or vaccinated individuals. In the appendix, we propose a stochastic
optimal control model, which could incorporate uncertainty due to mutations as well
as uncertainty in the development of future vaccines.
1.3. Results. Our first result is to find two locally optimal strategies in the
deterministic model that we characterize as ‘suppression’ and ‘mitigation’ strategies.
The locally optimal strategies balance the cost of the control (e.g., social and economic
cost) with the cost of hospitalization and death. The ‘suppression’ strategy reduces
the reproduction number well below 1 and it remains below 1 until the disease has
been eliminated. This strategy is qualitatively similar to the strategies in the literature that apply maximum control at the beginning of an outbreak, and also resembles
the strategy up to vaccination time found in [7]. The ‘mitigation’ strategy instead
applies control around the peak of the epidemic rather than at the initial time. The
reproduction number is then brought below 1 by a combination of control and the
development of herd immunity. By the time the disease is eliminated from the population, the majority of the population will have gotten infected when following the
‘mitigation’ strategy. This strategy is similar to what is found in [11]. We find both
of these solutions exist as local optima with reasonable parameters for COVID-19,
while the suppression strategy is the global minimum.
When accounting for the roll-out of vaccinations, we find that the ‘suppression’
strategy remains a local optimum, as long as the time to elimination is shorter than the
roll-out time of the vaccine. However, a new strategy that we call ‘delay-mitigation’ is
the global optimum. The ‘delay-mitigation’ is a more complex form of the ‘mitigation’
strategy that combines early suppression with later mitigation as the vaccine rolls out.
In this new strategy, the reproduction number is maintained near 1 until vaccination
of the population drives it down. The delay-mitigation strategy is consistent with

4

AARON Z. PALMER, ZELDA B. ZABINSKY, AND SHAN LIU

U.S. public health messaging that the control (e.g., NPIs) can be relaxed when a
large portion of the population is vaccinated.
We also consider a stochastic model in the appendix that naturally provides a
globally optimal feedback control and yields threshold values of infected populations
for which to apply different policies. For example, when the infectious population
reaches a threshold, more control is exercised (in the form of NPIs) at a social and
economic cost. This model captures the fluctuations of the end time, which leads
to high variability of the cost for the ‘suppression’ strategy. The development of a
vaccine allows the optimal feedback control to lessen, however, when the number of
cases is still small, the optimal feedback control strengthens to reduce the infection
rate upon development of the vaccine.
The code (written in Python with NumPy and Matplotlib for figures) and numerically generated data (JSON format) that we used is available at https://github.
com/AaronZPalmer/SEIHRD.git.

2. Epidemic Model.

2.1. Susceptible-Exposed-Infectious-Hospitalized-Recovered-Dead
(SEIHRD) Model. We assume that individuals are indistinguishable and reside in
one of six states: susceptible, exposed, infectious, hospitalized, recovered, and dead.
The state variables, which represent number of individuals in each state at a given
time, are:
• St , the number of ‘susceptible’ individuals at time t;
• Et , the number of ‘exposed’ individuals at time t;
• It , the number of ‘infectious’ individuals at time t;
• Ht , the number of ‘hospitalized’ individuals at time t;
• Rt , the number of ‘recovered’ individuals at time t;
• Dt , the number of ‘dead’ individuals at time t.
The total population size N accounts for all individuals N = St +Et +It +Ht +Rt +Dt .
We assume that the following individual transitions occur at exponentially distributed times:
It
;
• Susceptible to exposed at rate β N
• Exposed to infectious at rate α;
• Infectious to hospitalized at rate λ0 ;
• Infectious to recovered at rate γ0
• Infectious to dead at rate δ0 ;
• Hospitalized to recovered at rate γ1 ;
• Hospitalized to dead at rate δ1 .
The transition of any susceptible person to become infected, in other words St
becomes St − 1 occurs as the first of St independent random times with exponential
It
distributions of rate β N
. The first of these times that marks the transition from St
It
to St − 1 is exponentially distributed with rate β St N
. The same holds for the other
transitions. An illustration of the SEIHRD rate transition diagram is in Figure 1.
The dashed line in Figure 1 represents the transition due to vaccination, discussed in
Section 4.
When N is large and the macroscopic state variables are of order N , we can

OPTIMAL CONTROL OF COVID-19 INFECTION RATE WITH SOCIAL COSTS

St

𝛽! 𝑆! 𝐼! /𝑁

Et

𝑆!

5

𝛽! 𝑆! 𝐼! /𝑁

𝛼𝐸!

𝑜𝑁

𝛼𝐸!

𝐸!
It
𝑜𝑁
𝛾" 𝐼!

λ" 𝐼!

𝐼!

𝛿" 𝐼!
𝛾" 𝐼!

Ht
𝛾# 𝐻!

Rt

λ" 𝐼!

𝛿" 𝐼!

𝐻!

𝛿# 𝐻!

Dt

𝛾# 𝐻!

𝛿# 𝐻!

𝑅!

𝐷!

Fig. 1: Rate transition diagram for SEIHRD model. The dashed line represents the
rate transition as vaccines roll-out.

approximate the epidemic dynamics by the system of differential equations
(2.1)

dSt
dt
dEt
dt
dIt
dt
dHt
dt
dRt
dt
dDt
dt

= − βt St

It
N

It
− α Et
N

= βt St

= α Et − γ0 It − λ0 It − δ0 It
= λ0 It − γ1 Ht − δ1 Ht
= γ0 It + γ1 Ht
= δ0 It + δ1 Ht .

A common theme of epidemic models is that the dynamic behavior is characterized by a single ‘reproduction number,’ which when greater than 1 corresponds to
exponential growth and when less than 1 corresponds to exponential decline of the
disease in the population. The reproduction number R0 is the average number of
infections caused by a single infected individual in a susceptible population. This is
calculated, in our notation, as the infection rate β times the expected duration of the
disease,
(2.2)

R0 =

β
.
λ 0 + δ 0 + γ0

The effective reproduction number, in our notation, is
(2.3)

Re = R0

S
βN
S
=
,
N
λ0 + δ0 + γ0

6

AARON Z. PALMER, ZELDA B. ZABINSKY, AND SHAN LIU

that is, the number of infections generated in the current state of a population (rate
of infection per infected individual, β S/N , times average infection duration 1/(λ0 +
δ0 + γ0 )), under the simplifying assumption that S is constant in the relevant time
interval. The effective reproduction number governs whether the disease level in the
population will increase, Re > 1, or decrease, Re < 1.
2.2. Equilibria. After a sufficiently long time the solutions of (2.1) will approach
equilibrium points where the right hand sides of the differential equations are zero.
dR
An equilibrium requires that E = I = H = 0, since dH
dt = 0 and dt = 0 imply
I = H = 0, and then dE
dt = 0 implies E = 0. It is then clear that S, R, and D can
take any values in equilibrium and this allows us to determine all of the equilibrium
points. In Appendix A we further investigate the stability of the equilibria following
standard techniques and provide illustrations of how the SEIHRD model reaches an
equilibrium.
2.3. Parameter Settings for the SEIHRD Model of COVID-19. We use
published parameters from scientific papers and in some cases, parameters based on
COVID-19 data for the United States [5]. Each parameter in Table 1 is a rate per day
per person except for N . Some of the parameters can be obtained directly from the
literature and other parameters are calculated. We also perform a sensitivity analysis
on several parameters.
To determine δ1 , we use γ1 = 0.1 and the value 11.8% for the percentage of hos1
= 0.118. Similarly,
pitalizations that lead to death (from [14]) and set the ratio γ1δ+δ
1
we note that [14] provides λ0 +γ0 +δ0 = 0.217 and [5] provides the percentage of infecλ0
tions that lead to hospitalization as 3.69%, then we use the ratio λ0 +γ
= 0.0369
0 +δ0
to calculate λ0 .
To determine δ0 we calculate the percentage of infections that lead to death by


1
δ0 + λ0 γ1δ+δ
1.4 ∗ 346, 927
Total Deaths
1
=
=
λ0 + γ0 + δ0
Total Cases
4.6 ∗ 20, 112, 544
where total deaths and total cases are reported numbers from the United States as of
January 1, 2021 [4], and 40% additional deaths is a reported number in [6], and 4.6
times as many cases than confirmed cases comes from [5].
We treat the infection rate β as our control variable, and note that a range of
infection rates between 0.11 and 0.87 corresponds to values of R0 from 0.5 to 4.
We choose the initial values consistent with COVID-19 infection levels in Washington State, as of June 1, 2020. We set D0 = 0 in the initial conditions, so Dt
represents cumulative deaths since June 1, 2020 in our criterion. The initial conditions for Washington State, based on June 1, 2020 are

 
 

S0
7, 600, 000 − E0 − I0 − H0 − R0
7, 497, 705
 E0  
  7, 044 
294 ∗ 4.6/α

 
 

 I0  
  6, 221 
294
∗
4.6/(λ
+
γ
+
δ
)
0
0
0





.
(2.4)
 H0  = 
=

178 ∗ 1.9
338

 
 

 R0   22, 238 ∗ 4.6 − E0 − I0 − H0   88, 692 
D0
0
0
We used 294 for daily confirmed cases from the 7-day rolling average of daily confirmed
cases on June 1, 2020, 178 current hospitalizations as of May 31, 2020, and 22,238
total cases as of June 1, 2020 in Washington State [10]. We used the estimate of 4.6

OPTIMAL CONTROL OF COVID-19 INFECTION RATE WITH SOCIAL COSTS

7

Table 1: Parameter settings
α

0.192

λ0 + γ0 + δ0

0.217

λ0

0.008

δ0

0.000195

γ0

0.209

γ1

0.1

δ1

0.013

N

7,600,000

The exposed to infectious rate is the reciprocal of
the mean incubation period of 5.2 days. [14]
The total rate of leaving state I is the reciprocal
of the mean infectious period, 4.6 days. [14]
We also consider a range of 4 to 10 days.
The hospitalization rate is calculated from
3.69% hospitalized. [5]
The death rate is calculated from US data, [4]
and assumes 40% excess deaths. [6]
The recovery rate is the remainder, such that
λ0 + γ0 + δ0 equals total rate of leaving state I.
The recovery rate from the hospital is the reciprocal
of the mean length of hospital stay, 10 days. [14]
The hospital death rate is calculated from 11.8%
1
of those hospitalized die, so that 0.118 = γ1δ+δ
. [14]
1
Population of Washington State.
We also consider a range from 1 million to
the U.S. population (328.2 million),
and the world population (7.8 billion).

times more cases than confirmed cases and 1.9 times more hospitalized cases than
reported, as in [5]. These initial conditions are used in the examples unless otherwise
stated.
3. Optimal Control. We now pose an optimal control problem supposing that
the infection rate βt can be controlled over time through social distancing and other
non-pharmaceutical interventions.
We assume the dynamics of (2.1), and we optimize over the end time T and
control policy (βt )t∈[0,T ] . The cost consists of a running control cost L, a running
hospitalization cost F , and a terminal death cost G, which has the form
Z Th
i


(3.1)
J (βt )t∈[0,T ] , T =
L(βt ) + F (Ht ) dt + G(DT ).
0

We constrain the final state by
(3.2)

ET + IT + HT ≤ e−1

to represent that the disease has been eliminated from the population. The end time T
is the first time for which this constraint is satisfied. The threshold value of e−1 is used
in (3.2) so that the end time T coincides with the expected time that Et = It = Ht = 0
in a probabilistic model where the end time is exponentially distributed. For example
if I0 = 1, then the expected time to transition to It = 0 coincides with the time t
such that E[It ] = e−1 .
Thus the optimal control problem has the following elements:
• Decision variables T and (βt )t∈[0,T ] ;
• Dynamics determined by (2.1);
• Objective function (3.1);

8

AARON Z. PALMER, ZELDA B. ZABINSKY, AND SHAN LIU

• Terminal constraint (3.2).
Note that while the solution to the SEIHRD model scales linearly with the population size N , the end time is nonlinear in N . This is important in interpreting the
optimal control policy, and its dependence on population size and end time. For this
reason, and to better illustrate the relative scale of the solution, we have left the state
variables as total number of individuals rather than rescaling to dimensionless ratios
like St /N , etc.
We select cost functions for the optimal control criterion in (3.1) by a phenomenological approach:


β β
(3.3)
+ −1 ,
L(β) = N k − log
b
b
c1 2
F (H) = c0 H +
(3.4)
H ,
N
(3.5)
G(D) = d D.
The control cost is a function of the control β, the baseline infection rate b, and
a control cost coefficient k that reflects the cost of a proportional reduction in R0 .
We choose a convex form for the control cost L(β) ≥ 0 when β ≥ 0 and assume
that L(β) = +∞ if β ≤ 0. We set L(b) = 0, where the parameter b is the baseline
infection rate, so there is no additional control cost. The logarithmic term in L reflects
that the cost to reduce the infection rate (and hence the reproduction factor) by 1%
is a constant N k/100. The linear and constant terms of L normalize so that the
minimum is at β = b and has zero cost; values of L for β ≥ b are not important as it
is never optimal to increase the infection rate beyond the natural baseline infection
rate. This choice of a logarithmic term in L is consistent with the phenomenon that
independent methods of intervention have additive costs and multiplicative reduction
of β. A more common quadratic optimal control cost, e.g., (β − b)2 , should not be
used here as it fails to enforce the infection rate to remain positive, unrealistically
allowing the infection rate to be zero with a finite cost.
A quadratic term is included in the hospitalization cost F to reflect the cost of
passing a hospital occupancy threshold. The linear death cost reflects each human
life being of equal value.
3.1. Control Parameter Settings. The cost functions of (3.3), (3.4) and (3.5)
have five parameters: the control cost coefficient k, the baseline infection rate b, the
hospitalization cost rates c0 , c1 and the death cost coefficient d. We attempt to choose
reasonable values in USD, shown in Table 2, though further specification is ultimately
subjective. The control cost coefficient k reflects the cost of a proportional reduction
in R0 . We tested a range of values for k, from 50 to 250. It is hopeful that an efficient
handling of the epidemic would significantly lower the control cost coefficient, k. We
also vary the population size N and note the resulting end time.
3.2. Deterministic Dynamics Results. Numerically, we find two locally optimal solutions, the ‘suppression’ strategy where β stays low enough so that R0 < 1
and the ‘mitigation’ strategy where β is near b except at the peak of the epidemic, and
the epidemic runs its course. This qualitative finding is not sensitive to the choices of
parameters.
The two locally optimal solutions, ‘suppression’ strategy and ‘mitigation’ strategy,
are plotted in Figure 2. The ‘suppression’ strategy keeps β low at a high control cost
but low hospitalization and death costs. In contrast, the ‘mitigation’ strategy starts
with a high value of β (reflecting a relatively open society), and lowers β as the disease

OPTIMAL CONTROL OF COVID-19 INFECTION RATE WITH SOCIAL COSTS

9

Table 2: Control parameter settings
b
k

0.87
100

c0

3,500

c1

c0 /2

d

7,000,000

Choose b = β such that R0 = 4.
An approximate value is chosen such that, when
R0 = 1/2, the cost L(β) = $120N
and when R0 = 1, the cost is L(β) = $64N ,
consistent with analysis in [6].
Calculated for a total cost per patient of
$35,000 divided by an average stay
of 10 days. [19]
Chosen to be the same order of magnitude
as c0 .
The cost of a single death used in [6].

surges and raises β again, resulting in a low control cost and high hospitalization and
death costs. The globally optimal solution is the ‘suppression’ strategy, with a cost
about a third of the cost of the ‘mitigation’ strategy.
The cost of the ‘suppression’ strategy is approximately $15,137 per person, with
a total cost of $115 billion, and is mostly from the control cost. The cost of the
‘mitigation’ strategy is $30,226 per person, a total cost of $229 billion, and mostly
from the cost of deaths.
The end time T for the ‘mitigation’ strategy is much longer than that for the
‘suppression’ strategy. In the ‘suppression’ strategy T = 91 and in the ‘mitigation’
strategy T = 4, 061 (only the first 365 days are shown in Figure 2). The long time
to elimination for the ‘mitigation’ strategy is due to the end state being very near to
ST = N/R0 .
The cost of the ‘suppression’ strategy is proportional to N T , and T is determined
by the end-time threshold. The control variable β is kept low so that It , Et , and
Ht decay exponentially, and the end time is achieved relatively quickly. If the whole
model is scaled by N , and the end-time threshold remains constant, then the end time
T is proportional to log N . The cost of the ‘mitigation’ strategy is proportional to N
but less influenced by the end time, so the control variable β can reach the initial,
uncontrolled, infection rate b. The total cost for a range of N values, with initial
conditions scaled proportional to N , is shown in Figure 3, which demonstrates the
above mentioned scaling.
The marginal cost of the end-time constraint, as reflected by the Lagrange multiplier σ (see Appendix C), indicates the savings for being allowed to stop while
one person is still infected. This marginal cost for the ‘suppression’ strategy (σ is
$2,841,000,000) is much larger than the marginal cost for the ‘mitigation’ strategy (σ
is $2,433,000). The ‘suppression’ strategy terminates much faster than the ‘mitigation‘ strategy, so an additional day for the shorter time frame of ‘suppression’ strategy
(T = 91) has more impact than an additional day for the longer time frame of the
‘mitigation’ strategy (T = 4, 061).
Figure 4 illustrates the impact of a range of values for the control cost coefficient
k, ranging from 50 to 250, on the cost per person and the end time for both the
‘suppression’ strategy and the ‘mitigation’ strategy. We find that for a range of k
values from 70 to 90, the end time for the ‘mitigation’ strategy effectively diverges to
+∞, so numerically, we capped the end time to 6,000 in this range.

10

AARON Z. PALMER, ZELDA B. ZABINSKY, AND SHAN LIU

Figure 5 compares the effective reproduction number (as in (2.3)) of the two
strategies over time. This gives a useful perspective on the qualitative nature of the
two solutions. We observe that, in the ‘mitigation strategy’, Re appears to approach 1
asymptotically with these parameters.
Figure 6 provides a final ‘stress test’ of some of our parameters, plotting the
optimal cost for both strategies for a range of initial conditions (where E0 , H0 , and
R0 are scaled proportional to I0 ) and for a range of values for the mean infectious
duration (corresponding to (λ0 + γ0 + δ0 )−1 with λ0 , γ0 , δ0 scaled accordingly). We
find the solutions remain qualitatively similar and the preference of the ‘suppression’
strategy as the global optimum remains for a wide range of these parameters.
4. Vaccinations. We now consider the effect of vaccination on optimal control of
the COVID-19 pandemic. We introduce an additional transition from the susceptible
state, S, to the recovered state, R, representing an individual gaining an immunity to
COVID-19 by vaccination. See illustration in Figure 1. We assume that the vaccine
is distributed at a constant rate, determined by the parameter o for the ratio of
population vaccinated per day. Thus the equation for the susceptible population,
when St > 0, becomes
It
dSt
= − βt St
− o N.
dt
N
Clearly, this results in St reaching 0 in a finite time (before t = o−1 ) , after which
we assume that St remains at 0. The only other modification of the model to include
vaccinations is the addition of the o N term in the recovered population,
dRt
= γ0 It + γ1 Ht + o N.
dt
4.1. Vaccination Parameters. The rate of vaccination, o N , depends on the
parameter o, where o−1 represents the number of days to vaccinate the entire population. We consider the parameter values ranging from o = 1/250, reflecting if
vaccination begins on January 1, 2021 then the entire population is vaccinated by
September 8, 2021, to o = 1/500, where if vaccination begins on January 1, 2021 then
the entire population is vaccinated by May 16, 2022.
We also consider a second set of initial conditions, which are chosen to represent
COVID-19 in the U.S. as of January 1, 2021, with N = 328.2 million, and

 
 

S0
328, 200, 000 − E0 − I0 − H0 − R0
235, 682, 298
 E0  
  4, 569, 525 
190, 728 ∗ 4.6/α

 
 

 I0  
  4, 035, 804 
190, 728 ∗ 4.6/(λ0 + γ0 + δ0 )
=
=

(4.1) 
 H0  
  237, 589  .
125, 047 ∗ 1.9

 
 

 R0   20, 112, 544 ∗ 4.6 − I0 − E0 − H0   83, 674, 784 
D0
0
0
We used 190,728 for the 7-day rolling average of daily confirmed cases and 20,112,544
total cases [4] on Jan 1, 2020. We used 125,047 current hospitalizations as of Jan 1,
2021 [22]. We again used the estimate of 4.6 times more cases than confirmed cases,
and 1.9 times more hospitalized cases than reported [5].
4.2. Vaccination Results. We find a new optimal strategy, which we call
‘delay-mitigation,’ that delays the epidemic by maintaining disease levels at a near
constant state, until the majority of the population has been vaccinated and the infection dies out in the population due to immunity. This new strategy takes the place

OPTIMAL CONTROL OF COVID-19 INFECTION RATE WITH SOCIAL COSTS

11

(a) Supression strategy, with end time 91 days.

(b) Mitigation strategy, with end time 4,061 but only graphed to 365 days.

Fig. 2: The ‘suppression’ and ‘mitigation’ strategies, top (a) and bottom (b), respectively. Parameters are from Table 1 and Table 2 with initial conditions (2.4). See
Appendix C for details on the numerical approximation.

12

AARON Z. PALMER, ZELDA B. ZABINSKY, AND SHAN LIU

(a) Total cost per person versus N .

(b) End time T versus N .

Fig. 3: The total cost per person (a) and the end time T (b) for a range of N values
from 1 million to 7.8 billion (world population) on a log scale. The mitigation strategy
is nearly identical for different N values and its end time is not plotted as it is very
large. The solutions are qualitatively similar across N values.

(a) Total cost per person versus k.

(b) End time T versus k.

Fig. 4: The total cost per person (a) and the end time T (b) is plotted for a range of k
values and the two locally optimal strategies. The solutions are qualitatively similar
across k values, although the end time shows a large variation for the ‘mitigation’
strategy (for the ‘suppression’ strategy the end time simply decreases from 95 to 88
across the k values). The end time is capped at 6000, which is reached for k = 70
through k = 90. The ‘mitigation’ strategy is no longer found as a locally optimal
policy at k = 50.

of the ‘mitigation’ strategy, because the end time for the ‘mitigation’ strategy greatly
exceeds the time to vaccinate the entire population, o−1 .
For the initial conditions (2.4) reflecting Washington State, and values of o−1 ≥
300 (i.e., o ≤ 1/300), we still find a ‘suppression’ strategy as a local optima that is
nearly identical to the ‘suppression’ strategy found in Section 3.2. However, the ‘delaymitigation’ strategy is the global optima. When o = 1/250, the ‘suppression’ strategy

OPTIMAL CONTROL OF COVID-19 INFECTION RATE WITH SOCIAL COSTS

13

Fig. 5: The effective reproduction number in each strategy over time. The ‘suppression’ strategy ends much sooner than the ‘mitigation’ strategy. Note that, in the
‘mitigation’ strategy, Re appears to approach 1 asymptotically with these parameters.

(a) Total cost per person versus initial infec- (b) Total cost per person versus mean infectious population I0 .
tious period.

Fig. 6: The total cost per person is plotted for a range of I0 values (other initial values
scaled accordingly) and a range of the mean infectious period (1/(λ0 + γ0 + δ0 ) used
to determine λ0 , δ0 , γ0 ). The solutions are qualitatively similar.

is not locally optimal, because it is better to vaccinate more of the population by
extending the end time. With o = 1/300 and initial conditions (2.4), the ‘suppression’
and ‘delay-mitigation’ strategies are shown in Figure 7.
For the initial conditions (4.1) reflecting the U.S., we never find the ‘suppression’
strategy to be locally optimal, and the only local optimal strategy is the ‘delaymitigation’, which is shown in Figure 8.
For the parameter value o = 1/300, we find:
• With initial conditions (2.4), the cost of the ‘suppression’ strategy is $13,701
per person, down only slightly with the introduction of the vaccine, and the
cost of the ‘delay-mitigation’ strategy is $8,041 per person, with the cost
mostly from the control cost (compared with the ‘mitigation’ strategy, which
had cost mostly due to deaths). However, the end time for the the ‘sup-

14

AARON Z. PALMER, ZELDA B. ZABINSKY, AND SHAN LIU

•

•

•

•

pression’ strategy is less than half that of the ‘delay-mitigation’ strategy. In
the ‘suppression’ strategy, the disease ends with nearly half the population
in the Susceptible compartment, whereas in the ‘delay-mitigation’ strategy,
the entire population has left the Susceptible compartment by the end time.
In the ‘suppression’ strategy, about half the population is vaccinated by the
time the disease is under control. The dynamics, control, and cost are plotted
for the ‘suppression’ strategy and the ‘delay-mitigation’ strategy in Figure 7
with initial conditions (2.4).
With initial conditions (4.1), only the ‘delay-mitigation’ strategy is found to
be optimal, with total cost $7,556 per person. We note the cost per person is
slightly lower than that using initial conditions (2.4), even though the disease
levels are higher, because a larger proportion of the population has already
recovered from the disease. The dynamics, control, and cost are plotted for
the single optimal, ‘delay-mitigation’ strategy with initial conditions (4.1) in
Figure 8.
The end time T for the ‘delay-mitigation’ strategy is T = 323 and T = 270,
for initial conditions (2.4) and (4.1), respectively, finishing after the entire
population has been vaccinated and the last infected person has recovered.
In the ‘suppression’ strategy, the end time is shorter, T = 119, which is similar
but slightly longer than the end time without a vaccine.
We observe a new shape for the control policy in the ‘delay-mitigation’ strategy, as is evident in the shape of the effective reproduction number, which is
maintained near 1, until the majority of the population has been vaccinated.
A plot of Re is in Figure 9(a) and (b), for different initial conditions. As
the remainder of the population receives a vaccine we observe the effective
reproduction number falls to 0. When we use the initial conditions (4.1),
we see that Re remains below 1 due to the higher disease level in the initial
population.
The total cost per person of the ‘suppression’ strategy only varies slightly with
the vaccine rate o, while the total cost per person of the ‘delay-mitigation’
strategy appears to depend linearly on o−1 as observed in Figure 9(c) and (d).

5. Conclusion. We have analyzed the optimal control of an idealized epidemic
model of COVID-19. We found two locally optimal strategies, ‘suppression’ and
‘mitigation’, which correspond to qualitatively distinct approaches to combat the
epidemic, and the ‘suppression’ strategy is the global optimum. By considering a wide
range of parameters we find the solutions to be fairly robust. The optimal control
strategies provide insight into how the strength or relaxation of control impacts the
population and associated costs over time, as well as the impact of the end time.
In the ‘suppression’ strategy, the susceptible population remains high, while in the
‘mitigation’ strategy, nearly the entire population contracts the disease. We also see
that the end time for the ‘suppression’ strategy is much shorter than the end time for
the ‘mitigation’ strategy.
When accounting for vaccinations, we find a globally optimal ‘delay-mitigation’
strategy that delays the spread of the disease until the majority of the population has
received a vaccine. The ‘susceptible’ strategy is not globally optimal when vaccination
is present, and only appears as a local optimum under certain parameter values. We
vary the time it takes to vaccinate the entire population and initial conditions and
observe the associated change in the effective reproduction number and the total cost
per person.

OPTIMAL CONTROL OF COVID-19 INFECTION RATE WITH SOCIAL COSTS

15

(a) Supression strategy, with vaccine.

(b) Delay-mitigation strategy, with vaccine.

Fig. 7: The ‘suppression’ strategy (a) and ‘delay-mitigation’ strategy (b) with vaccinations. Parameters are from Table 1 and Table 2 with o = 1/300 and initial conditions
(2.4) reflecting Washington State.

16

AARON Z. PALMER, ZELDA B. ZABINSKY, AND SHAN LIU

Fig. 8: The ‘delay-mitigation’ strategy is the only optimal strategy when we choose
initial conditions (4.1) reflecting the US population at the beginning of 2021 (N =
328, 200, 000), with o = 1/300.

There are many additional features that we have not attempted to model. One
feature is that the control cost will likely depend on the number of infected individuals. In particular, targeted contact tracing and quarantine may serve to reduce
the infection when the number of infections is small with less cost than overarching
social distancing policies. Similarly, targeted vaccination can also effectively reduce
the infection rate as well as remove individuals from the susceptible population.
We have not accounted for the possibility of mutations of the virus that could
change the parameters and reduce the effectiveness of immunity in the recovered
population. We consider a stochastic model (in the appendix) as a starting point to
analyze the uncertainty introduced by mutations, which would be an important area
for further research.
Another feature is the network dependence of epidemic spread, either through
social networks or geographic distance. This is an active area of research with many
different existing approaches.
A final feature to mention is the role of information. Our idealized model has
assumed perfect information about the state of the disease, which is not realistic.
Gaining accurate information about the parameters and progression of the disease is
needed for implementing optimal epidemic control.

OPTIMAL CONTROL OF COVID-19 INFECTION RATE WITH SOCIAL COSTS

17

(a) Effective reproduction number in each (b) Effective reproduction number with inistrategy with initial conditions of (2.4).
tial conditions of (4.1).

(c) Total cost per person versus o−1 with (d) Total cost per person versus o−1 with
initial conditions (2.4).
initial conditions (4.1).

Fig. 9: The effective reproduction number shown with initial conditions (2.4) in (a)
and (4.1) in (b). The total cost per person for ranges of time to vaccinate the entire
population o−1 , ranging from 250 to 500 (o values ranging from 1/250 to 1/500), with
initial conditions (2.4) reflecting Washington state in (c), and with initial conditions
(4.1) reflecting the US in (d).

Acknowledgments. This work has been funded in part by the National Science
Foundation grant CMMI-1935403.

Appendix A. Equilibria Analysis.
We investigate the Jacobian matrix and its eigenvalues to parametrically characterize the system stability near equilibrium. If all eigenvalues are less than or equal
to zero, the system is stable. The zero eigenvalues represent the degrees of freedom
of equilibria, which are simply S, R, and D, and do not complicate the analysis.

18

AARON Z. PALMER, ZELDA B. ZABINSKY, AND SHAN LIU

The Jacobian matrix associated with the dynamics in (2.1) is
 βI

S
−N
0
−β N
0
0 0
S
 βI
−α
βN
0
0 0 
 N

 0
α −(λ0 + γ0 + δ0 )
0
0 0 

.
 0
0
λ0
−γ1 − δ1 0 0 


 0
0
γ0
γ1
0 0 
0
0
δ0
δ1
0 0
At an equilibrium point, the first column becomes zero because I = 0, and we can
compute the eigenvalues  by finding the roots of the characteristic polynomial, solving


S
−
0
−β N
0
0
0
S
 0 −α − 
βN
0
0
0 


 0
α
−(λ0 + γ0 + δ0 ) − 
0
0
0 
,
0 = det 
 0
0
λ0
−γ1 − δ1 −  0
0 


 0
0
γ0
γ1
− 0 
0
0
δ0
δ1
0 −
which yields

S
0 = 3 (γ1 + δ1 + ) (α + )(λ0 + γ0 + δ0 + ) − α β
.
N
There is a zero eigenvalue with multiplicity three, −γ1 − δ1 is an eigenvalue, and
the other two eigenvalues solve

S
0 = 2 + α + [λ0 + γ0 + δ0 ]  + α [λ0 + γ0 + δ0 ] − α β
N
so
=

2
 q
α + [λ0 + δ0 + γ0 ] − 4 α [λ0 + δ0 + γ0 ] − β
− α + [λ0 + δ0 + γ0 ] ±
2

S
N


.

Both of these eigenvalues are negative if and only if
λ0 + δ0 + γ0 > β

S
.
N

This eigenvalue analysis provides a condition on parameters that ensure system stability.
We plot the equilibrium value of S at a large time T for a range of R0 values
in Figure 10. The R0 value of COVID-19 without interventions has been estimated
to be greater than 2, which would result in the majority of the population becoming
infected. A clear qualitative feature shown in Figure 10 is that ST is near N when
R0 ≤ 1 and the final state of ST always lies below an upper bound of RN0 . We find in
Section 3.2 that the optimal ‘mitigation’ strategy achieves the end result of ST ≈ RN0 .
Appendix B. Pontryagin Maximum Principle.
We recall the dynamics (2.1) and define (Σ)t∈[0,T ] = (St , Et , It , Ht , Rt , Dt ) and
let f (Σ, β) ∈ Rd denote the righthand side, i.e.,
(B.1)

dΣt
= f (Σt , βt ).
dt

OPTIMAL CONTROL OF COVID-19 INFECTION RATE WITH SOCIAL COSTS

19

Fig. 10: The final state ST as function of R0 , a theoretical upper bound in the dashed
blue line and simulations in yellow. Parameters are as in Table 1 with β ranging as a
function of R0 , β = (λ0 + γ0 + δ0 ) R0 . The end time for the simulations is taken to
be T = 6,000 days.

We let (Pt )t∈[0,T ] = (PtS , PtE , PtI , PtH , PtR , PtD )t∈[0,T ] be the costate and define
the Hamiltonian
H(Σ, P, β) = f (Σ, β) · P − L(β) − F (H).
Then we let (Pt )t∈[0,T ] solve the costate equation, applying a differential operator to
the Hamiltonian,
dPt
= −DΣ H(Σt , Pt , βt ),
dt

(B.2)
with










PTS
E
PT + σ
PTI + σ
PTH + σ
PTR
PTD





 = −DΣ G(ΣT ).




Here σ ≥ 0 is a Lagrange multiplier for the target constraint. The free end time yields
the additional transversality condition
(B.3)

sup H(ΣT , PT , β) = 0.
β

The Pontryagin Maximum Principle states:
Theorem B.1. If T and (βt )t∈[0,T ] are optimal and (Σt )t∈[0,T ] solves (2.1) with
(3.2) satisfied, then there is σ ≥ 0 and (Pt )t∈[0,T ] that solves (B.2) with terminal
conditions, such that σ (IT + ET + HT − e−1 ) = 0, the transversality condition (B.3)
is satisfied, and for almost every t ∈ [0, T ],
βt ∈ argmax{H(Σt , Pt , ·)}.
We note that βt ∈ argmax{H(Σt , Pt , ·)} provides optimal βt given the state Σt ,
and co-state Pt . The Pontryagin Maximum Principle provides necessary, but not

20

AARON Z. PALMER, ZELDA B. ZABINSKY, AND SHAN LIU

sufficient conditions for optimality. We numerically discover two local optima that
satisfy these conditions, that we call ‘suppression’ and ‘mitigation’ strategies.
We let Jσ denote the augmented cost





Jσ (βs )s∈[0,T ] , T = J (βs )s∈[0,T ] , T + σ IT + ET + HT − e−1 ,
and note that for σ of Theorem B.1, T and (βt )t∈[0,T ] minimize Jσ over policies unconstrained by the end-time threshold (3.2). For any smooth (βt )t∈[0,T ] , and solutions
(Σt )t∈[0,T ] and (Pt )t∈[0,T ] , we can calculate the functional derivative


(B.4)
D(βs )s∈[0,T ] Jσ (βs )s∈[0,T ] , T (t) = −Dβ H(Σt , Pt , βt ),
and
(B.5)



DT Jσ (βs )s∈[0,T ] , T = −H(ΣT , PT , βT ).

Note that even if L, F , and G are convex, our problem is not convex due to the
nonlinear dynamics. We use a discretized version of the functional gradients to search
for local optima, and compare the overall cost of the strategies to determine the global
optimum.
Appendix C. Deterministic Control Numerics.
We discretize time in fixed increments of ∆t = 1. Dynamics are approximated
by a first order Euler scheme, which allows for an easy and exact calculation of the
discrete gradients corresponding to (B.4) and (B.5). The target constraint is relaxed
by adding the quadratic penalty function to the cost:
2
N
max{0, ET + IT + HT − e−1 }
2µ
and the Lagrange multiplier is retrieved simply as σ = N
µ max{0, ET + IT + HT −

−1
e } . We use µ = 0.01.
We then calculate the gradient of the cost with respect to the control variable
by back propagation (equivalent to (B.4) and a discretization of costate equations)
and employ momentum gradient descent (momentum factor is 0.9). The gradient
step is chosen to be around 10−4 /N ∼ 10−5 /N for different parameter values. Larger
gradient steps lead to instabilities and slow convergence, especially when there is a
long time horizon.
To find the optimal end time we implement the simple algorithm that if the
Hamiltonian at the current end time T is positive, we increase the end time by one
increment, and otherwise, if the Hamiltonian at T − ∆t is negative we decrease the
end time to T − ∆t. We find this approach works numerically.
Appendix D. Stochastic Epidemic Control.
D.1. Stochastic Considerations. We presented a deterministic model, with
continuously varying state variables, as an approximation to a stochastic model, which
would consider the transitions between states as random jumps corresponding to
individual infections/recoveries/etc. When the population is large, the transition of a
single individual is small relative to the number of individuals in the state. However,
there are features of the stochastic model that are not captured in the deterministic
model. One of these features is the distribution of the end time. As a proof of concept,
we now consider the stochastic version of the deterministic models in the paper. This

OPTIMAL CONTROL OF COVID-19 INFECTION RATE WITH SOCIAL COSTS

21

illustrates the possibility of including other uncertain aspects such as the introduction
of a new strain of COVID-19 with uncertain characteristics.
The error of a deterministic approximation to a stochastic model at a given time
is proportional
√ to the standard deviation of the macroscopic state variables, which
is of order N , so that the relative error, of order √1N , becomes small when N is
large. The time to reach equilibrium is finite in the stochastic model, which we have
incorporated into the deterministic model by ending when the infected population
reaches a given threshold, e−1 . If R0 < 1, the end time is of order log(N ), and
the error of the deterministic
p approximation is again proportional to the standard
deviation, which is of order log(N ). At least for the ‘suppression’ type strategy, the
cost is of order N T ∼ N log(N ) and the relative error grows if we scale by N .
A second interesting note is that when approaching this problem from a dynamic
programming perspective, the discretization of the deterministic model naturally leads
to a stochastic interpretation by addition of numerical viscosity. We proceed to take
this dynamic programming perspective and properly account for the fluctuations of
the stochastic SEIHRD model.
An alternative approach to account for the stochastic fluctuations, which we do
not consider here, is to approximate the problem near the deterministic solution as
a linear quadratic Gaussian (LQG) stochastic optimal control problem. Since the
dynamics of the SEIHRD model are not linear, this approximation must be done
carefully. The LQG problem can then be solved as a system of Ricatti differential
equations. It is not clear if the LQG approach can account for the fluctuations of the
end time since it is usually done with a fixed end time, but it has proven very effective
in many applications and can also account for noisy and incomplete observations of
the state variables.
D.2. Stochastic Simplified Problem. We now use the dynamic programming
approach to better understand the stochastic nature of the epidemic model. This
approach also has the feature that it finds the globally optimal strategy, where as the
approach of Section 3 centered around finding local optima.
The dynamic programming approach is not practical to solve with six state variables, as it would require a computational complexity on the order of N 6 . Instead
˜ R̃, as depicted in Figure 11, where
we reduce to a simplified three state model S̃, I,
˜
I includes both exposed and infectious states and R̃ includes the recovered, hospitalized, and dead states. The model is further reduced to two dimensions by setting
˜ When N is large it is necessary to apply a course-grained discretization
R̃ = N − S̃ − I.
˜ We approximate the parameters for the
to the remaining state variables, S̃ and I.
simplified model so that the solution can be fed back to the full stochastic SEIHRD
model. We note that the suppression strategy could probably be approximated in
one dimension with the assumption that S = N , and using a very high cost set at an
arbitrary I˜ threshold. Since, we aim to demonstrate that the strategy is the global
optimum as compared also to mitigation strategies, we do not take this approach.
˜ A transition occurs
For the simplified model there are now two states S̃ and I.
I˜
˜
˜
from (S̃, I) to (S̃ − 1, I + 1) at rate β S̃ N (neglecting the effect of the incubation
˜ to (S̃, I˜ − 1) at rate λ̃ I,
˜ where λ̃ =
period), and a transition occurs from (S̃, I)
0
λ0 + γ0 + δ0 ≈ 0.217. We can then approximate H̃ = pH I˜ with pH = γ1λ+δ
≈ 0.071
1
˜
by considering the quasi-equilibrium when I is near constant, and similarly D̃ = pD R̃
δ0 +λ0



δ1
γ1 +δ1



with pD =
≈ 0.0051.
λ̃
We run the model until the infection dies out, that is, until the first time t is

22

AARON Z. PALMER, ZELDA B. ZABINSKY, AND SHAN LIU
SEIHRD Model
𝑆!

Simplified 𝑆! 𝐼!𝑅$ Model

𝛽! 𝑆! 𝐼! /𝑁

𝑆'!

𝛼𝐸!

𝐸!

,
𝛽 𝑆, 𝐼/𝑁

𝐼!
𝛾" 𝐼!

λ" 𝐼!

𝛿" 𝐼!

𝐼'!

𝐻!
𝛾# 𝐻!

𝑅!

𝜆, 𝐼,
𝛿# 𝐻!

𝐷!

𝑅(!

Fig. 11: Rate transition diagram for SEIHRD alongside the simplified S̃ I˜R̃ model.

reached such that I˜t = 0. We now assume β has a feedback form,
˜
(β) = (β(S̃, I))
˜
(S̃,I)∈{0,...,N
}2 .
The cost is
hZ
 
J (β) = E

T


i


L β(S̃t , I˜t ) + F (H̃t ) dt + G(D̃T ) ,

0

where H̃ and D̃ are approximated as above, and L, F , and G are the same as (3.3),
(3.4), and (3.5).
We solve for the value function
n
hZ T 

i
o

˜
˜ ,
V (S̃, I) = sup − E
L β(S̃t , I˜t ) + F (H̃t ) dt + G(D̃T ) ; (S̃0 , I˜0 ) = (S̃, I)
(β)

0

which satisfies V (S̃, 0) = −G(D̃) and solves the Bellman equation
n
o


I˜
˜ +γ̃ I˜ V (S̃, I˜−1)−V (S̃, I)
˜ −L(β)−F (H̃) = 0.
max β S̃
V (S̃+1, I˜−1)−V (S̃, I)
β
N
It is an interesting challenge how to approximate the solution at a coarser discretization of the population variables in order to handle large N . Special care must
be taken near I˜ = 0 to ‘renormalize’ the coefficients and accurately take into account
the logarithmic behavior of the end time. More details are given in Appendix D.6.
D.3. Stochastic Simplified Problem Results. We plot five simulations of
the SEIHRD model under ‘optimal control’ from the simplified S̃ I˜R̃ model (the correspondence between the simulations and the value function is only approximate), see
Figure 12 as a comparison to the deterministic suppression strategy in Figure 2(a).
As expected there is variability in the cost due to the fluctuations of the end time.
For this approach we find only the globally optimal, ‘suppression’, strategy and while
the exact values differ due to the coarse approximation, qualitatively the strategy is
the same.
The main qualitative difference in the solutions from the finite time horizon,
deterministic dynamics problem is that there is now a finite time where the infection
dies out and the control returns to β = b.

OPTIMAL CONTROL OF COVID-19 INFECTION RATE WITH SOCIAL COSTS

23

Fig. 12: Five simulated optimal solutions, with the same parameters as in Figure 2(a).
Note the fluctuations in the end time, while the other fluctuations are not noticeable.
Individual simulations can be identified by matching the end time with the point the
cost flattens.

(a) Control β versus infected population (b) Control β versus susceptible population
sizes with the susceptible population fixed. sizes with the infected population fixed.

Fig. 13: Continuous and discretized optimal β values plotted as a function of infected
population sizes with the susceptible population fixed on the left (a), and as a function
of susceptible population values with the infected population size fixed on the right
(b). Same parameters as Figure 12.

24

AARON Z. PALMER, ZELDA B. ZABINSKY, AND SHAN LIU

D.4. Switching Times for Discrete β. Instead of allowing continuous values
for β we now consider when β is restricted to only four values calculated from R0 =
0.5, 1, 2, and 4. The motivation for discretizing β is to reflect four policies that impact
R0 through non-pharmaceutical interventions.
The feedback control β, for both the continuous version and the discrete version,
is plotted as a function of the infected population in Figure 13, where ‘suppression’
and ‘mitigation’ regimes can be identified. Indeed, the optimal discrete policy is very
close to the policy with continuous β rounded to the nearest admissible value. We also
plot the optimal β for differing values of I˜ and S̃ in Figure 13(a) and (b), respectively.
The “switching time” between policies is shown in terms of infected and susceptible population size, providing feedback information on when to change policies. For
example, given a value for S̃, a decision-maker may identify the discretized level of
optimal β. As S̃ changes, Figure 13(b) shows how this affects the feedback control
policy, and when to switch to a different control level.
D.5. Vaccinations. We also demonstrate the stochastic model with vaccinations. A new transition is added to reflect individuals leaving S̃ at a rate of o N . The
Bellman equation becomes
(D.1)

n

I˜
˜
V (S̃ + 1, I˜ − 1) − V (S̃, I)
0 = sup β S̃
N
β

˜
˜
+ γ̃ I V (S̃, I˜ − 1) − V (S̃, I)
o

˜ − V (S̃, I)
˜ − L(β) − F (H̃) .
+ o N V (S̃ − 1, I)

We solve the stochastic problem with vaccinations and run simulations using the
same parameters from the US COVID-19 data as of January 1, 2021, (4.1). As shown
in the top graph in Figure 14, the susceptible population S drops off linearly to near
zero, as the vaccination takes affect. Comparing Figure 12 with Figure 14, it is clear
that the solutions are qualitatively the same, as the control β starts off low and
increases later, while cost is largely due to the control cost in both situations.
With the same parameters we view how the vaccination affects the β thresholds
in Figure 15. The overall solution remains close to the solution without vaccinations
of Figure 12. Figure 15 plots the effect on the threshold of β values, with and without
a vaccine. A surprising feature is that the optimal β is almost always lower with a
vaccine compared to without one. While vaccination allows for a faster relaxation of
the control, it is only due to the decrease of the susceptible population and at the same
susceptible population a stricter control should be used alongside the vaccinations.
D.6. Stochastic Control Numerics. The Bellman equations (D.1) can be
solved in a single sweep of value iterations making sure that we first increase S̃ then
˜ and with vaccinations we start with u = 1 and then do u = 0. We discretize
increase I,
β in increments of 0.01.
When N is much larger than 1000 we do not solve the equations directly as the
computational cost is of order N 2 . Instead we discretize the population variable in
1000 increments. We let ∆k = 0.001 N denote the discretization increment (which we
assume is greater than 1). It is then possible to solve approximate Bellman equations,
where we replace
˜
˜
˜ u) ≈ V (S̃, I − ∆k, u) − V (S̃, I, u) .
V (S̃, I˜ − 1, u) − V (S̃, I,
∆k

OPTIMAL CONTROL OF COVID-19 INFECTION RATE WITH SOCIAL COSTS

25

Fig. 14: Simulations for the stochastic model with vaccinations. Parameters are the
same as Table 1 and Table 2 with initial conditions from (4.1) reflecting the US
COVID-19 data as of January 1, 2021, and o = 1/300.

(a) Control β, with and without vaccine, ver- (b) Control β, with and without vaccine, versus infected population sizes with the suscep- sus susceptible population sizes with the intible population fixed.
fected population fixed.

Fig. 15: Optimal β thresholds, with and without a vaccine, with the susceptible
population fixed at S̃ = 294,000,000 in (a), and with the infected population fixed at
I˜ = 6,500,000 in (b). Parameters are the same as Table 1 and Table 2 with initial
conditions from (4.1) reflecting the US COVID-19 data as of January 1, 2021, and
o = 1/300.

26

AARON Z. PALMER, ZELDA B. ZABINSKY, AND SHAN LIU

Unfortunately, this leads to a bad approximation when I˜ is small. For example
the expected time to transition from I˜ = ∆k to I˜ = 0 with S̃ = 0 is approximated by
1
α , whereas the correct expected time can be computed as
∆k

1X1
,
α j=1 j
which is about 7.5 times larger when ∆k = 1000. Since I˜ = ∆k must be visited
by any solution before the end time, this error would propagate through the whole
problem. Because of this we renormalize the coefficient α at state I˜ using the formula
1
1
→
α
α

I˜
X
˜
j=I−∆k+1

1
.
j

The sum is approximated using the standard formula
k
X
1
j=1

j

≈ log(k) + γe +

1
1
−
2k 12k 2

where γe ≈ 0.577 is the Euler-Mascheroni constant.
REFERENCES
[1] M. A. Acuña-Zegarra, M. Santana-Cibrian, and J. X. Velasco-Hernandez, Modeling
behavioral change and COVID-19 containment in Mexico: A trade-off between lockdown
and compliance, Mathematical Biosciences, (2020), p. 108370.
[2] H. Behncke, Optimal control of deterministic epidemics, Optimal control applications and
methods, 21 (2000), pp. 269–285.
[3] E. H. Bussell, C. E. Dangerfield, C. A. Gilligan, and N. J. Cunniffe, Applying optimal
control theory to complex epidemiological models to inform real-world disease management,
Philosophical Transactions of the Royal Society B, 374 (2019), p. 20180284.
[4] CDC, Covid data tracker, January 01, 2021, 2021, https://covid.cdc.gov/covid-data-tracker/
#trends totalandratecases (accessed 2021-01-22).
[5] CDC, Estimated disease burden of COVID-19, January 19, 2021, 2021, https://www.cdc.gov/
coronavirus/2019-ncov/cases-updates/burden.html (accessed 2021-01-22).
[6] D. M. Cutler and L. H. Summers, The COVID-19 pandemic and the 16 trillion virus, JAMA,
324 (2020), pp. 1495–1496.
[7] R. Djidjou-Demasse, Y. Michalakis, M. Choisy, M. T. Sofonea, and S. Alizon, Optimal
COVID-19 epidemic control until vaccine deployment, medRxiv, (2020).
[8] N. Ferguson, D. Laydon, G. Nedjati Gilani, N. Imai, K. Ainslie, M. Baguelin, S. Bhatia,
A. Boonyasiri, Z. Cucunuba Perez, G. Cuomo-Dannenburg, et al., Report 9: Impact
of non-pharmaceutical interventions (NPIs) to reduce COVID-19 mortality and healthcare
demand, tech. report, Imperial College London, 2020.
[9] E. Hansen and T. Day, Optimal control of epidemics with limited resources, Journal of mathematical biology, 62 (2011), pp. 423–451.
[10] W. health department, Washington state health department COVID-19 data dashboard,
june 1, 2020, 2021, https://www.doh.wa.gov/Emergencies/COVID19/DataDashboard (accessed 2021-01-22).
[11] D. I. Ketcheson, Optimal control of an SIR epidemic through finite-time non-pharmaceutical
intervention, arXiv preprint arXiv:2004.08848, (2020).
[12] W. Lee, S. Liu, H. Tembine, W. Li, and S. Osher, Controlling propagation of epidemics via
mean-field games, 2020, https://arxiv.org/abs/2006.01249.
[13] Q. Li, B. Tang, N. L. Bragazzi, Y. Xiao, and J. Wu, Modeling the impact of mass influenza
vaccination and public health interventions on COVID-19 epidemics with limited detection
capability, Mathematical Biosciences, (2020), p. 108378.

OPTIMAL CONTROL OF COVID-19 INFECTION RATE WITH SOCIAL COSTS

27

[14] S. M. Moghadas, A. Shoukat, M. C. Fitzpatrick, C. R. Wells, P. Sah, A. Pandey, J. D.
Sachs, Z. Wang, L. A. Meyers, B. H. Singer, et al., Projecting hospital utilization
during the COVID-19 outbreaks in the United States, Proceedings of the National Academy
of Sciences, 117 (2020), pp. 9122–9126.
[15] L. Ó. Náraigh and Á. Byrne, Piecewise-constant optimal control strategies for controlling
the outbreak of COVID-19 in the Irish population, Mathematical Biosciences, 330 (2020),
p. 108496.
[16] C. N. Ngonghala, E. Iboi, S. Eikenberry, M. Scotch, C. R. MacIntyre, M. H. Bonds, and
A. B. Gumel, Mathematical assessment of the impact of non-pharmaceutical interventions
on curtailing the 2019 novel Coronavirus, Mathematical Biosciences, 325 (2020), p. 108364.
[17] C. Nowzari, V. M. Preciado, and G. J. Pappas, Analysis and control of epidemics: A survey
of spreading processes on complex networks, IEEE Control Systems Magazine, 36 (2016),
pp. 26–46.
[18] A. Perkins and G. Espana, Optimal control of the COVID-19 pandemic with nonpharmaceutical interventions, medRxiv, (2020).
[19] M. Rae, G. Claxton, N. Kurani, D. McDermott, and C. Cox, Potential costs of COVID19 treatment for people with employer coverage, 2020, https://www.healthsystemtracker.
org/brief/potential-costs-of-coronavirus-treatment-for-people-with-employer-coverage/
(accessed 2020-07-25).
[20] R. E. Rowthorn, R. Laxminarayan, and C. A. Gilligan, Optimal control of epidemics in
metapopulations, Journal of the Royal Society Interface, 6 (2009), pp. 1135–1144.
[21] M. Thäter, K. Chudej, and H. J. Pesch, Optimal vaccination strategies for an SEIR model
of infectious diseases with logistic growth, Mathematical Biosciences & Engineering, 15
(2018), p. 485.
[22] The COVID Tracking Project, US currently hospitalized, https://covidtracking.com/data/
charts/us-currently-hospitalized (accessed 2021-01-22).
[23] A. R. Tuite, D. N. Fisman, and A. L. Greer, Mathematical modelling of COVID-19 transmission and mitigation strategies in the population of Ontario, Canada, CMAJ, 192 (2020),
pp. E497–E505.
[24] K. Wickwire, Optimal isolation policies for deterministic and stochastic epidemics, Mathematical biosciences, 26 (1975), pp. 325–346.

