Effect of lockdown interventions to control the
COVID-19 epidemic in India
Ankit Sharma1 , Shreyash Arya1 , Shashee Kumari1 , and Arnab Chatterjee1
1 TCS

Research, New Delhi, India

arXiv:2009.03168v1 [physics.soc-ph] 7 Sep 2020

ABSTRACT
The pandemic caused by the novel Coronavirus SARS-CoV2 has been responsible for life threatening health complications,
and extreme pressure on healthcare systems. While preventive and definite curative medical interventions are yet to arrive,
Non-Pharmaceutical Interventions (NPIs) like physical isolation, quarantine and drastic social measures imposed by governing
agencies are effective in arresting the spread of infections in a population. In densely populated countries like India, lockdown
interventions are partially effective due to social and administrative complexities. Using detailed demographic data, we
present an agent based model to imitate the behavior of the population and its mobility features, even under intervention.
We demonstrate the effectiveness of contact tracing policies and how our model efficiently relates to empirical findings on
testing efficiency. We also present various lockdown intervention strategies for mitigation – using the bare number of infections,
the effective reproduction rate, as well as using reinforcement learning. Our analysis can help assess the socio-economic
consequences of such interventions, and provide useful ideas and insights to policy makers for better decision making.

1 Introduction
The rapidly spreading infectious disease COVID-19 is caused by the novel coronavirus SARS-CoV-2, has become a global
pandemic1 . Spreading fast, with short doubling times there are usually long delays in showing effects from interventions2 .
With increasing number of complex, life threatening infections3 , it has overwhelmed healthcare systems around the world
and caused thousands of deaths worldwide. A majority of infected individuals need medical treatment, some of them critical
attention. The current case fatality ratio (CFR) stands around 7%, although countries across the world show variations between
1% and 15%4 . While the World Health Organization (WHO) currently maintains that there are no reports of reinfection yet,
they were cautious in stating that there is “currently no evidence that people who have recovered from COVID-19 and have
antibodies are protected from a second infection”5 .
The propagation of a transmitting infection is usually well understood by the basic reproduction number ρ0 which is the
average number of infections caused by a single individual in a fully susceptible population, or in other words, a population
without any immunity. When immunity develops in a population, or otherwise, when other mitigating factors are in play, the
effective reproduction number ρt (reproduction number when both susceptible and non-susceptible are present) decreases to
below unity, thereby rapidly decreasing the proportion of infected population. Suppressing infections is an alternative way of
stopping the spreading, since the population still remains susceptible. True immunity is only achieved using pharmaceutical
intervention like vaccination. In a well mixed population, the herd immunity is either achieved by naturally recovering from
infections or by vaccinations, when 1 − ρ10 fraction of population becomes immune.
In absence of vaccines and consensus on effective medication for treatment, drastic Non-Pharmaceutical Interventions
(NPIs) are the only possible ways to control the contact mixing of the population that is the basis of the spreading of any
contact mediated infectious disease. The effect of such interventions only delay the spread of the infections in the susceptible
population, thereby reducing the pressure on the healthcare system, and buying time for viable, effective pharmaceutical
answers.
One of the basic and widely used intervention is to impose strict restriction on population contact, mixing and movement,
usually regulated by governing authorities, and are commonly termed as lockdowns. When the duration of lockdowns keeps
increasing, the public costs can be immense, both in terms of its economic and financial fall-outs, as well as from the social and
psychological perspective. Recent proposals of isolation and other restrictions6 have barely been able to flatten the curve and
keep the critical cases below the healthcare capacity. Flattening the curve along with managing social and economic costs is not
possible unless NPIs are introduced and relaxed to re-start the social and economic activities in a civil society.
One of the effective ways of monitoring and controlling the spread of infections is through the efficient use of instantaneous
contact tracing data7 acquired through smartphone based application (app), and administer regulated interventions accordingly.
The app keeps track of proximity contacts and notifies individuals at risk, who can isolate, quarantine or get tested and treated.
Such targeted recommendations can serve as a better alternative for infection control, compared to mass quarantines, which can

have heavy socio-economic consequences. However, this can only be possible if the application can be used by a large fraction
of the population. A recent study8 argued that while almost 87% of Indian population has access to a mobile phone9 , the
number of smartphone users is still well below 40%. If there is a mechanism to augment the location data from non-smartphone
users using basic feature phones, the Indian population can achieve digital herd immunity, thereby facilitating the government
authorities to track individuals, trace their contacts and impose targeted interventions like isolation, testing and quarantine.
However, such a theoretical possibility is yet to mature to a practical reality.
Modeling epidemics on graphs10 has been an extremely important and fertile area of research. The natural reason is to
understand the mechanisms of disease propagation in closely connected and mixing population in human societies, using a
variety of frameworks from paradigmatic toy models to detailed, data driven, agent based models. The huge amount of data
gathered through a multitude of sources to create a multi-scale data of demographics, mobility and other essential components
have opened up the possibility to perform large scale data-driven simulations. This helps to answer important, specific and
detailed questions related to epidemics, and particularly for prediction and forecasting purposes.
In this paper, we introduce an agent based model of the Indian population, with demographic and mobility features modeled
using publicly available data sources. The COVID-19 epidemic is studied using a microscopic model that takes into account the
available data on transmission, infections and mortality. Under this detailed framework, we study the consequences of a few
lockdown strategies that can be effective in containing the spread of infections as well as possibly minimize the socio-economic
footprints. In the following section, we describe our model framework in detail by introducing the structured population and
then the epidemic process. Next, we discuss our results and conclude with discussions.

2 Model
We separate our model into two distinct parts. First of all, we model the population and its contacts as a hierarchically structured
graph, in order to facilitate the effect of lockdown intervention at different spatial scales by rearranging and removing links
systematically. The movement related behavior of individuals depend on several demographic features. The second part of the
model deals with the epidemic dynamics and its details.
2.1 Modeling the population
We build a hierarchically modular network to simulate a structured population (See, e.g. Ref.11 ) where the basic units
are individuals. While the individual agents are the nodes, the links represent the close physical proximity or contact and
associations over a short period of time, which can be dynamic in nature. We will interchangeably use the term agents to refer
to individuals in the rest of the paper, since they will eventually have several static and dynamic features depending on spatial
and temporal properties. This can be imagined to be the aggregated network of all contact graphs of agents over a short period
of time. The modular graph is conceived and constructed using the following steps:

Figure 1. The hierarchical structure of the population: the basic units are individuals, forming families residing in residential
zones which also contain retail. The contact networks between families are governed by Barabási-Albert type networks. There
are also zones for education and entertainment, as well as employment (public or private) opportunities. Combinations of these
zones create district. Travel between various areas create contact networks between individuals. Several such districts
constitute a state. Contact networks between districts are created using gravity law.

• Individuals (agents) form the basic units of a society. However, at the basic level, several of them constitute a family. It is
fair to assume that individuals in a family form a complete graph or a clique, because they come in close contact in their
residential space.
• In a residential neighborhood, several families live in close proximity. It is fair to assume that number of contacts with
others across different families have a broad distribution. In fact, there are strong empirical evidences that the degree
distribution of physical social networks have power law tails (see, e.g.12 ). We construct a neighborhood using different
2/21

families as units. We use the Barabási-Albert algorithm for preferential attachment13 to connect a new family of size
nk to an existing family i, with probability ni / ∑ j n j , where n j are the sizes of existing families. Once a target family
is selected, we create a single link between any two members of the two families to keep the connectivity sparse. The
family size distribution is sampled from the Census data14 . See Appendix for details in Algorithm 1.
• Next, we introduce the concept of zones as a spatial feature. Each zone is tagged to some special amenities like residential
neighborhoods (defined in the previous paragraph), retail outlets, entertainment centers, educational institutions, office
spaces, etc., which provide distinguishing characteristic to it. In a simplistic picture, we assume that there are 4 different
types of zones in a district: (i) residential and retail (RR), (ii) education and entertainment (EE), (iii) private employment
(EPV), and (iv) public employment (EPB). A district usually comprises of several of the above zones. Zones in each
district are assumed to be distributed uniformly for sake of simplicity. For instance, Mumbai Suburban district has a total
of 25 zones divided in ratio 8:5:5:7 for RR:EE:EPV:EPB respectively.
• Agents are embellished with various features from the demographic data available from Census of India 201114 . We use
age, gender (male or female) and employment status. We consider 3 broad age classes – (i) 0-19 years, (ii) 20-59 years
and (iii) 60 years and above. We also have employment status as – (i) employed or (ii) unemployed. The unemployed do
not move to the employment zones. The employed in turn also fall in two categories – (i) essential and (ii) non-essential
workers. The essential workers have the liberty to move around different zones even during the lockdown. For instance,
48.73% of Mumbai Suburban’s population is employed out of which 1% of agents are tagged as essential workers
randomly (See Appendix Table 1 for parameter details, Fessential ).
• We consider 4 time bins – (i) morning, (ii) afternoon, (iii) evening and (iv) night, which sets the time granularity of our
model. Thus, 4 time steps correspond to one day in our subsequent simulations.
Inspired by models of intra-urban mobility (see, e.g., Ref15 ), we simulate the movement of agents across different zones
as a function of their age and time of the day, using probabilities for transiting from one zone to another. We also
construct a similar set of conditional probability tables for the lockdown periods taking ideas from 15, 16 , when movement
is rarely allowed outside residential zones except for obtaining essential commodities.
At this point it is important to note that the mobility data at the level of individuals is useful, to compute origin-destination
matrices, dwell estimates at hotspots, amount of time spent at various locations, and also contact matrices17 . Compared
to other countries like Italy18 , the data at this level of detail is not available for India. However, aggregate mobility
trends16 give a rough idea of the time aggregated mobility across a variety of locations like retail and recreation, groceries
and pharmacy, parks, transit stations, workplaces and residential areas. See Appendix Table 6, Table 7, and Table 8 for
details.
• Restructuring the network due to mobility: We model the movement of agents across different zones and the resulting
contact structure with others, using a process of removing and adding links in the existing graph. If an agent does not
move out of its own zone, it breaks one of its existing links with probability Pre and creates a new link inside the zone
with probability Pce . In case if it moves out of its own zone to a target zone (can be within or outside its own district), all
links from its previous zone are broken with a probability Pre and a new link is created in the target zone with probability
Pce . An agent moves to another district as per the inter-district mobility matrix MDD . This dynamics of links effectively
captures the properties of temporal contact graphs at the granularity of 4 time steps in a single day. At night, agents
return back to their residence locations with a probability CH , restores their family links with probability Pce , and their
existing links are removed with a probability Pf e . As soon as an agent is tested positive, its existing links are broken with
probabilities CI and CE depending upon the current state of agent i.e., Infected (symptomatic) or Exposed (asymptomatic)
respectively (See Sec. 2.2 for epidemic states). If an agent dies, all its links are broken and the agent is removed from the
system. To restrict/limit inter-district mobility, inter-district links are broken with a probability CBS when lockdown is
imposed. During lockdown, parameters are changed to bring in the effect of social distancing. Refer to Table 3, Table 4,
and Algorithm 3 in Appendix for details.
• Connections across districts: Empirical evidences regarding population movement across space is a well studied and
debated problem. While earliest research pointed the flux between two population agglomerations to be proportional to
the respective population sizes and a inverse dependence on the distance separating them19, 20 , recent studies present
strong evidence in favour of a generalized gravity law21, 22 , which holds reasonably well depending on the scale under
consideration. In absence of empirical data for population flux in India, we assume that the gravity law holds, as in the
case of Korean highways23 .
3/21

We assume that the number of links across districts is directly proportional to the population flux between two districts of
population sizes Pi and Pj , separated by distance di j , and is given by
Fi j = C

Pi Pj
.
di2j

(1)

The normalization factor C is set to unity. In each district, nodes are chosen randomly to connect with randomly chosen
nodes from other districts. We use data from Census data of 201114 to create population samples for districts.
• Mobility during lockdown: When lockdown interventions are imposed at different stages, the corresponding links are
broken and mobilty is restricted inside different zones, along with a compliance factor. Severity of lockdown can be
manyfold – from containment zones, district lockdown and sealing of state border. See Table 3, Table 4, and Table 8 in
appendix for details.
2.2 Modeling the epidemic
In the standard mathematical treatments of epidemics, there is a concept of the basic reproduction number ρ0 which is the
expected number of cases generated by an infected one in a population where there is no immunity and all are susceptible to
infection. This is not a fundamental constant, and depends on behavioral properties of the given population, and hence can differ
across countries for the same disease. In fact, recent reports on dependence of weather suggest that the effective reproduction
number ρ for COVID-19 decreases by around 3% per degree of increase of temperature beyond 25C24 . The generation and
incubation times are rather more fundamental, as is the serial interval of infections. In case a fraction f attains immunity to the
disease due to some reason, an infected individual will, on the average, infect ρ = ρ0 (1 − f ). For the epidemic to die, needs to
satisfy the condition ρ < 1, i.e., f > 1 − ρ10 . fc = 1 − ρ10 is known as the herd immunity threshold. In this simplistic picture,
this infection spreading is a branching process, and is basically a percolation problem25 , in the language of statistical physics.
There is a critical phenomenon associated with the phase transition, with the critical point at fc , separating the epidemic phase
( f < fc ) and the immune phase ( f > fc ) (Fig. 2).
epidemic
0

immune
 fc

= 1 − ρ10
herd immunity
threshold

1

Figure 2. The epidemic phase diagram with the herd immunity threshold fc in terms of the basic reproduction number ρ0 .
While the early findings from COVID-19 cases in China suggested a value of 2.2 − 2.7, the latest findings suggest a much
higher average value of ρ0 around 5.726 , which pushes the herd immunity threshold from around 60% to above 80%. This
implies that more than 80% of the population needs to have immunity, naturally by recovering or through vaccination, for the
infections to stop spreading further.
The transmission of the virus is known to happen through various routes, mostly through exhaled droplets, but surfaces
and fecal-oral contamination have also been reported. The transmission are either through the symptomatic, pre-symptomatic,
asymptomatic or environmental in nature. In what follows, we do not take the environment into account, explicitly. As in
a macroscopic mathematical description of the epidemic27, 28 , we model the states of an individual in a population as the
following: (i) Susceptible S, (ii) Exposed E, (iii) Infected I, (iv) Recovered R and (v) Dead D. We will denote the corresponding
fractions of these states in the population as S, E, I, R and D respectively. This is similar to the SEIR model with an additional
state D corresponding to the dead. The microscopic dynamics of the states of the model are described in the following.
The initial state for the entire population is set to S. Epidemic spread is initialised with a few infected agents Iinit
which represent imported cases. With each passing time-step, agents move and interact with other agents, and the mobility
characteristics are dictated by the agent level features as described in Sec. 2.1. The infected I coming in contact with S can
convert them to E with rate βI . Once the state E is produced in the population, they in turn can convert the susceptible S into E
with rate βE . Fsym of the total exposed agents E can mature into infected I. 1 − Fsym of the total exposed agents E may stay
asymptomatic and eventually recover to state R. An early report from ICMR 1 claimed that the asymptomatic cases constituted
80% of the total COVID cases29 . However, we have used 60% asymptomatic cases in our epidemic modelling (refer to Table 2
in Appendix for the value of the fraction Fsym ). The infected agents may decease to D dictated by probability Pµ or I can
eventually recover to R by probability 1 − Pµ . Transitions to I, R and D are bounded by their corresponding time periods – the
1 Indian

Council of Medical Research, https://www.icmr.gov.in/, (2020), [accessed 20 April 2020]

4/21

S

β E , βI

E

Fsym

1 − Fsym

Pµ

I

D

1 − Pµ
R

Figure 3. The basic SEIRD model: Susceptible S can come in contact with the exposed E or the infected I to transition to
exposed E with rates βE and βI respectively. Fsym of the total exposed agents E can mature into infected I. 1 − Fsym of the total
exposed agents E may stay asymptomatic and eventually recover to state R. Infected agents may die to D with a probability Pµ
or can recover to R by probability 1 − Pµ .
time to infection TI , recovery from infected TRI , asymptomatic recovery from exposed TRE , and mortality time TM . Lockdown
intervention mechanism is also triggered which locks out districts depending upon the deployed strategy (for details refer
to Sec. 3.2). This controls the contact process and hence the rapid spread of the infections. Fig. 9 in Appendix shows an
illustration of epidemic spread for Mumbai suburban district at different temporal snapshots.
In order to keep track of the individuals in our agent based model, we carry out the microscopic simulation of the above
dynamics using the Gillespie algorithm30 .

3 Results
We use the model described in the previous section to simulate the behavior of agents in a population, with the epidemic process
running on top of it, spreading through the process of contacts between individuals and spatially propagating due to mobility of
exposed and infected individuals.
We initiate our simulations with susceptible agents in the population, while we seed the epidemic process by assuming a
few infected agents. The first quantities to calculate are the fractions S, E, I, R and D and their evolution over time. Using a
model of their choice, the usual studies compute the infected fraction and try to match the numbers from reported data. In
reality, reported data does not give us the correct number of infected population, specially for a socially complex, and populous
country like India. This is because, it is practically impossible to test each individual and trace their contacts for possible further
testing. Usually, the rate of testing is low and is unable to capture the real numbers. Moreover, there is a lag between testing and
reporting of results, and this can be a major factor which makes tracing difficult. Trying to attempt to match reported number of
cases with simulations will be a futile exercise.
In our work, we do not attempt to match the number or fraction of infected individuals to real data. Our model, on the other
hand, keeps information regarding each individual’s movements in space and contact with others, enabling us to theoretically
match the tracing and testing scenario, within the limits of practical error in real data.
3.1 Contact Tracing
For a disease like COVID-19, where the incubation period is long and the fraction of asymptomatic population is quite large, a
standard method of relying on people’s reporting accuracy to trace who they came in contact with, is insufficient. In that case,
the tracing starts with an individual showing symptoms and its contacts can possibly be traced both forward and backward in
time, the latter being more important because it can enable tracing the other possible paths the infection has branched into,
and thus recursively trace the parent of the transmission sub-tree. In this digital era of smartphones, contact tracing can be
enhanced, not only in terms of the number of contacts but also in real time. The theoretically zero time lag between occurrence
of a contact and it being reported is a matter of technology.
3.1.1 Testing rate

The most important part of creating a microscopic agent based model with a variety of agent features, mobility behavior and
detailed epidemic parameters, is to be able to correspond to the scenario where each agent can be traced spatio-temporally
for its contacts. In real data, the testing rate is defined as the number of individuals tested per unit population. Another
important quantity of our interest is the test positive rate, which is given by the number of individuals testing positive per
unit tested population. In reality, individuals are rarely tested completely randomly because that is economically inefficient.
Usual procedures include testing someone who reports a symptom, then test a list of its contacts, and maybe more – secondary
contacts, and so on. Often individuals who have been in vicinity of an area which reports a lot of infected cases, are also tested.
5/21

fraction of positive cases from tests

population fraction in epidemic states

10-1
-2

10

10-3
Maharashtra
E
I
R
D

10-4
10-5
18/3

07/4

27/4

17/5

06/6

26/6

16/7

0.8

model
real
Maharashtra

0.7
0.6
0.5
0.4
0.3
0.2
0.1
0
05/4

05/8

25/4

15/5

10-1
10-2
10-3
Tamil Nadu
E
I
R
D

10-4
10-5
18/3

07/4

27/4

17/5

06/6

days

04/6

24/6

14/7

days

26/6

16/7

05/8

fraction of positive cases from tests

population fraction in epidemic states

days

model
real
Tamil Nadu

0.2

0.1

0
05/4

25/4

15/5

04/6

24/6

14/7

days

Figure 4. (Left Panel) The fractions E, I, R and D over time as observed in numerical simulations. (Right panel) The
corresponding test positive rates compared with real data over time (right panels) for the states of Maharashtra and Tamil Nadu.
The results are shown for 10 networks and 10 runs for each network for both the states. Maharashtra has 35 districts and Tamil
Nadu has 32 districts (as per 2011 census) and our simulation results are shown for a sample population of 19944 agents and
19727 for Maharashtra and Tamil Nadu respectively. The vertical lines correspond to the change in intervention (lockdown)
rules in India (25/03, 15/04, 04/05, 18/05, 01/06).
We use the real data31 of testing and test positive rate in a given state and try to fit that from our simulation results. In doing
so, a set a parameters are used for fitting. When an agent gets infected, all the contacts of the agent for the last TLB days along
with NRT number of random agents are tested for the infection. The real scenario corresponds to the infected agent being able
to recollect (or through a tracing app) all other agents who came in contact in that span of time TLB . NRT can be interpreted as
an offset term taking care of the error and delay in tracing. In Fig. 4 we show the correspondence between the real data for the
fraction of positive cases over time, and tried to match our simulation results by tuning several parameters related to mobility
and lockdown compliance (see Table 3 in Appendix for details). We find the best fits for TLB = 5 days and NRT is either 2 or 3
depending on the lockdown regime.
In our simulations, we constructed 10 different networks for the sample populations and simulated 10 runs of the epidemic
process on each of them. The mean and standard deviations of the test positive rates are shown, along with the real data. In
the Indian context, the strictness of the lockdown had varied through the timeline and thus the parameters have been altered
accordingly (see Table 3 in Appendix for details). These are also taken into consideration during the simulation. However,
there are irregular spikes in the empirical data since the reporting is known to irregular, with data missing for few days and
being accumulated for a particular day when they are actually available.
The corresponding density of different epidemic states in the population is also shown (left panels of Fig. 4) for the sample
populations from Indian states of Maharashtra and Tamil Nadu. The growth of the infected state I is found to be slow, with a
slow growth rate consistent what is observed in empirically reported data.
3.2 Restricting movement using lockdown strategies
Containing infections being the main objective, the primary task is restricting the contacts of the population by arresting their
movement at different scales. This leads to asking the question that what could be a viable strategy which is both operationally
easy and functional, as well as effective in containment. Of course, the brute global lockdown can slow down the spreading but
is not the best option for several reasons, mainly because certain economic sectors need to mobilize to facilitate the restart of
the economy, which otherwise during the restriction period comes to a standstill.
In the following, we discuss a few different strategies that can be realized. We try to use the information about the bare
fraction of infections in a given area and subsequently use the instantaneous reproduction number for the infections as triggers
for deciding when to impose and relax restrictions in the different constituent districts of a given state. We also try a more
6/21

sophisticated reinforcement learning based protocol to make the same decisions. In all the results that follow, we assume that
no pharmaceutical interventions are being used, and the population is left to itself to acquire immunity through recovering from
the infections. Our simulated time horizons are long for demonstration, as a consequence of the above assumption.
3.2.1 Using fraction of infected cases

10-1

35

-2

10

10-3
Maharashtra
E
I
R
D

10-4
10-5

0

200

400

600

800

1000

1200

districts under lockdown

population fraction in epidemic states

The natural trigger for imposing lockdown interventions will be by looking at the fraction of infections in a particular area.
We use districts as the geographical entity where the fraction of infections is calculated and depending on thresholds Iu and
Id , the interventions are turned on or off. In our simulations, shown in Fig. 5, we demonstrate the case when the intervention
switch is Iu = 1.75 × 10−3 , i.e. 0.175%, i.e. interventions are effective when I(t) > Iu and relaxed when I(t) < Id with
Id = 1.3125 × 10−3 , i.e. 0.13125% (See Table 5 in Appendix). In the figure, we also demonstrate how the number of districts
under lockdown behave for a single run on a particular network, showing considerable fluctuation around the average value.
average
single run

30
25
20
15
10
5

Maharashtra

0

1400

0

200

400

days

600

800

1000

1200

1400

days

Figure 5. The simulation results for lockdown on districts depending on the fraction of infections. Lockdown interventions
are activated when infections are greater than Iu and deactivated when less than Id . The result shown is the average for 50 runs
(10 runs each on 5 networks ). (Left panel) The fractions E, I, R and D over time. (Right panel) The average number of districts
under lockdown at a certain day for the state of Maharashtra. The grey shaded region denotes one standard deviation. The
averaged data is compared with a single run on a particular network realisation. Maharashtra has 35 districts (as per 2011
census) and our simulation results are shown for a sample population of 19943 agents.

3.2.2 Using reproduction rate

100

30

-1

10

10-2
10-3

Maharashtra
E
I
R
D

10-4
-5

10

0

200

400

600

days

800

1000

1200

1400

districts under lockdown

population fraction in epidemic states

Compared to using the fraction of infected cases, one can imagine a rather sophisticated way of designing a lockdown trigger
by using the instantaneous effective reproduction number ρ(t). The values of ρ(t) can be calculated at the level of different
states of India (following the recipe of Ref.32 and is shown in Fig. 8 in Appendix). In our model simulations, we compute
the values of ρ(t) for each district. We prescribe a rule where a district goes under lockdown if the ρ(t) exceeds a particular
threshold, ρ(t) > ρu and is relaxed when is below another low threshold, ρ(t) < ρd . In Fig. 6, we show the case when the
interventions are in place while ρu = 1 and relaxed when ρd = 0.5 (See Table 5 in Appendix).

25

Maharashtra

20
15
10
5
0
0

200

400

600

800

1000

1200

1400

days

Figure 6. The simulation results for lockdown on districts depending on the reproduction rate ρ(t). Lockdown interventions
are activated when reproduction rate ρ(t) is greater than 1 and deactivated when less than 0.5. The results are averaged over 25
runs (5 runs each on 5 networks). (Left panel) The fractions E, I, R and D over time. (Right panel) The average number of
districts under lockdown at a certain day for the state of Maharashtra. The grey shaded region denotes one standard deviation.
Maharashtra has 35 districts (as per 2011 census) and our simulation results are shown for a sample population of 19943 agents.

7/21

3.2.3 Using reinforcement learning

10-1

35

10-2
10-3
-4

Maharashtra
E
I
R
D

10

10-5
-6

10

0

100

200

300

days

400

500

600

districts under lockdown

population fraction in epidemic states

Critical factors in decision making while imposing lockdown include infections, recoveries, deaths and economic loss. In
previous sub-sections, we focused on infection and recovery as triggers whereas death and economic impact were not considered.
To address this, we used reinforcement learning (RL). Reinforcement Learning is a technique in which an agent learns and
improves using its experience and performs actions while interacting with environment with a goal to maximize reward.
Observable characteristics of the environment is referred to as state and its representation is given as context to the agent.

30
25
20
15
10
5

Maharashtra

0
0

100

200

300

400

500

600

days

Figure 7. The simulation results for lockdown on districts as proposed by reinforcement learning. The results are shown for 5
networks and 3 runs each of 100 episodes for each network. (Left panel) The fractions E, I, R and D over time. (Right panel)
The average number of districts under lockdown at a certain day for the state of Maharashtra.The grey shaded region denotes
one standard deviation. Maharashtra has 35 districts (as per 2011 census) and our simulation results are shown for a sample
population of 19943 agents.
We trained a Deep Q Network (DQN)33 agent to learn an optimal intervention strategy. State representation presented to
the RL agent in order to choose an action (imposing lockdown or not for every district) consisted of district-wise population,
infections, recoveries, deaths, infection rate, recovery rate and the death rate at every time-step. An action with a higher Q
value is chosen greedily by the RL agent during exploitation phase. Whereas, in the exploration phase, actions are chosen
randomly. Rewards are calculated on the basis of number of districts under lockdown, infection count and death count for every
district. Training was carried out using 2 hidden layers with learning rate = 0.001 and momentum = 0.8 for 10 epochs (similar
to Ref34 ) using the mean squared error as the loss function. Fig. 7 shows the essentials of epidemic spread using trained DQN
agent for the state of Maharashtra.

4 Discussions
The COVID-19 pandemic has become one of the threats to humanity, by spreading rapidly, causing life threatening clinical
complications by itself and somewhat fatal for individuals with other co-morbidities35 . With less information about the
epidemic in the first few months, healthcare systems were overwhelmed with critical cases. With time, some reliable scientific
information has helped healthcare systems across different countries to cope with the pandemic. However, the number of cases
have multiplied by then. Researchers have explored various classical and improvised modeling techniques to understand and
predict the rising number of cases, with little success.
Modeling epidemics in real populations for studying various possible scenarios and enable prediction is an extremely
challenging task. While basic mathematical models established over time provide the necessary framework for realizing the
population and the processes of spreading, relating to real data is tricky. This is mainly because the data captured through
surveys, reporting and testing are not at par with the actual information on the infections in the population. For new pathogens,
whose transmission and infectious behavior (e.g., symptoms, detection, etc.) are not well established or known, the ambiguity
contributes to the error in estimating the actual number of infections and its temporal characteristics. In most countries, the test
protocol and reporting of results are quite erratic and thus the gap between the actual infections and the measured, is beyond the
scope of modeling. Under these circumstances, almost all of the modeling efforts for COVID-19 are thus, not accurately able to
estimate or predict the actual number of infections. In our study, we do not attempt to match the actual number of reported
cases as well.
In our approach, we have constructed a framework that takes into account the spatio-temporal complexity of the population
and its contact characteristics. Our study, for the case of India, makes use of the available Census data for extracting social,
demographics and the spatial population features, along with hypothesis driven modeling of spatially hierarchical organization
of population movement and contact. This enables us to monitor the dynamics of the epidemic through contact at various
spatial scales. Using our microscopic, agent based model of the COVID-19 epidemic for Indian population, we demonstrate our
8/21

results for sample populations at the level of ‘states’, the basic federal administrative units of India. However, the framework
can be used to focus small populations in municipalities. On the other hand, the model can be scaled up to the level of the
country using appropriate modifications due to realization of multiple ‘states’. The simple, toy model approaches help in
understanding the gross behavior of the epidemic and its states, but mostly fail to answer detailed questions related to the
population, demographic and spatial features. Although our detailed model contains many parameters, most of them can be
tuned and validated with real data, whenever and wherever they are available. In that way, our approach provides a possibility
of answering several fine grained questions.
We demonstrated how the framework can be used to compute the fraction of cases tested positive in a sample population
whose contact behavior is regulated by the restrictions in movement due to imposed lockdowns. The proposed framework
also allows to test hypothetical lockdown protocols to study the time evolution of densities of epidemic states. In fact, we
demonstrated the use of three different lockdown strategies for a particular state of India. To study this, we utilized the fraction
of infections I(t), the reproduction rate ρ(t) and also reinforcement learning to decide which of the districts should come under
lockdown restrictions. Our results show that these three methods can be utilized to dynamically decide lockdown in various
districts and thereby restrict the spread of infections. However, from the point of view of socio-economic impact of lockdowns,
one can compare these protocols as well as new ones to decide which can be deployed in a real population. Regarding the
feasibility as well as practicality of switching lockdowns on and off at a rapid rate, our results merely demostrate a possibility,
which can be modified according to administrative capabilities. In a realistic scenario, lockdowns may not be implemented
with a possibility of changing state at the scale of a single day. In addition, our model formulation is flexible in answering
feature related queries, as well as adapting to new features which may be added for the population, spatial information as well
as disease characteristics.

References
1. World
Health
Organization.
WHO
Director-General’s
opening
remarks
at
the
media
briefing
on
COVID-19
11
March
2020.
https://www.who.int/dg/speeches/detail/
who-director-general-s-opening-remarks-at-the-media-briefing-on-covid-19---11-march-2020 (2020). [accessed 5 May
2020].
2. Pellis, L. et al. Challenges in control of Covid-19: short doubling time and long delay to effect of interventions. arXiv
preprint arXiv:2004.00117 (2020).
3. Guan, W.-j. et al. Clinical Characteristics of Coronavirus Disease 2019 in China. New England Journal of Medicine 382,
1708–1720 (2020).
4. Johns Hopkins Coronavirus Resource Center. Mortality Analyses. https://coronavirus.jhu.edu/data/mortality (2020).
[accessed 5 May 2020].
5. World Health Organization. "Immunity passports" in the context of COVID-19. https://www.who.int/news-room/
commentaries/detail/immunity-passports-in-the-context-of-covid-19 (2020). [accessed 5 May 2020].
6. Ferguson, N. et al. Report 9: Impact of non-pharmaceutical interventions (npis) to reduce covid19 mortality and healthcare
demand. Imp. Coll. Lond. 10, 77482 (2020).
7. Ferretti, L. et al. Quantifying SARS-CoV-2 transmission suggests epidemic control with digital contact tracing. Science
DOI: 10.1126/science.abb6936 (2020).
8. Bulchandani, V. B., Shivam, S., Moudgalya, S. & Sondhi, S. Digital herd immunity and covid-19. arXiv preprint
arXiv:2004.07237 (2020).
9. Telecom Regulatory Authority of India. Telecom Subscription Data. https://www.trai.gov.in/sites/default/files/PR_No.
17of2020_0.pdf (2020). [accessed 5 May 2020].
10. Pastor-Satorras, R., Castellano, C., Van Mieghem, P. & Vespignani, A. Epidemic processes in complex networks. Reviews
of Modern Physics 87, 925 (2015).
11. Davis, J. T., Perra, N., Zhang, Q., Moreno, Y. & Vespignani, A. Phase transitions in information spreading on structured
populations. Nature Physics DOI: 10.1038/s41567-020-0810-3 (2020).
12. Eubank, S. et al. Modelling disease outbreaks in realistic urban social networks. Nature 429, 180–184 (2004).
13. Barabási, A.-L. & Albert, R. Emergence of scaling in random networks. Science 286, 509–512 (1999).
14. Office of the Registrar General & Census Commissioner, India. Census of India 2011. http://censusindia.gov.in/2011census
(2020). [accessed 15 April 2020].
9/21

15. Serok, N. & Blumenfeld-Lieberthal, E. A simulation model for intra-urban movements. PloS One 10 (2015).
16. Community Mobility Reports. COVID-19 Community Mobility Report. https://www.gstatic.com/covid19/mobility/
2020-04-30_IN_Mobility_Report_en.pdf (2020). [accessed 5 May 2020].
17. Oliver, N. et al. Mobile phone data for informing public health actions across the COVID-19 pandemic life cycle. Science
Advances DOI: 10.1126/sciadv.abc0764 (2020).
18. Pepe, E. et al. COVID-19 outbreak response: a first assessment of mobility changes in Italy following national lockdown.
medRxiv 2020.03.22.20039933 (2020).
19. Tinbergen, J. Shaping the world economy; suggestions for an international economic policy (The Twentieth Century Fund,
New York, 1962).
20. Ravenstein, E. G. The laws of migration. Journal of the Royal Statistical Society 52, 241–305 (1889).
21. Balcan, D. et al. Multiscale mobility networks and the spatial spreading of infectious diseases. Proceedings of the National
Academy of Sciences 106, 21484–21489 (2009).
22. Viboud, C. et al. Synchrony, waves, and spatial hierarchies in the spread of influenza. Science 312, 447–451 (2006).
23. Jung, W.-S., Wang, F. & Stanley, H. E. Gravity model in the Korean highway. EPL (Europhysics Letters) 81, 48005 (2008).
24. Xu, R. et al. Weather Conditions and COVID-19 Transmission: Estimates and Projections. medRxiv (2020).
25. Stauffer, D. & Aharony, A. Introduction To Percolation Theory (CRC Press, 1994).
26. Sanche, S. et al. High Contagiousness and Rapid Spread of Severe Acute Respiratory Syndrome Coronavirus 2. Emerging
Infectious Diseases 26 (2020).
27. Kermack, W. O. & McKendrick, A. G. A contribution to the mathematical theory of epidemics. Proceedings of the Royal
Society of london. Series A 115, 700–721 (1927).
28. Aron, J. L. & Schwartz, I. B. Seasonality and period-doubling bifurcations in an epidemic model. Journal of Theoretical
Biology 110, 665–679 (1984).
29. ICMR. Coronavirus: 80% cases asymptomatic, but no need to revise testing criteria, says icmr (2020). [accessed 20 April
2020].
30. Gillespie, D. T. A general method for numerically simulating the stochastic time evolution of coupled chemical reactions.
Journal of Computational Physics 22, 403–434 (1976).
31. Group, C. I. O. D. O. https://api.covid19india.org/ (2020). [accessed 31 July 2020].
32. Bettencourt, L. M. & Ribeiro, R. M. Real time Bayesian estimation of the epidemic potential of emerging infectious
diseases. PLoS One 3 (2008).
33. Mnih, V. et al. Human-level control through deep reinforcement learning. Nature 518, 529–533 (2015).
34. Khadilkar, H., Ganu, T. & Seetharam, D. P. Optimising Lockdown Policies for Epidemic Control using Reinforcement
Learning. arXiv preprint arXiv:2003.14093 (2020).
35. Clark, A. et al. Global, regional, and national estimates of the population at increased risk of severe covid-19 due to
underlying health conditions in 2020: a modelling study. The Lancet Glob. Heal. 8, e1003–e1017 (2020).
36. Golding, N. et al. Reconstructing the global dynamics of under-ascertained covid-19 cases and infections. medRxiv DOI:
10.1101/2020.07.07.20148460 (2020). https://www.medrxiv.org/content/early/2020/07/08/2020.07.07.20148460.full.pdf.
37. Linton, N. M. et al. Incubation Period and Other Epidemiological Characteristics of 2019 Novel Coronavirus Infections
with Right Truncation: A Statistical Analysis of Publicly Available Case Data. Journal of Clinical Medicine 9, 538 (2020).
38. Lauer, S. A. et al. The incubation period of coronavirus disease 2019 (COVID-19) from publicly reported confirmed cases:
estimation and application. Annals Intern. Medicine (2020).
39. World Health Organization. Report of the WHO-China Joint Mission on Coronavirus Disease 2019 (COVID-19). https:
//www.who.int/docs/default-source/coronaviruse/who-china-joint-mission-on-covid-19-final-report.pdf (2020). [accessed
18 March 2020].
40. Wilson, N., Kvalsvig, A., Barnard, L. T. & Baker, M. G. Case-fatality risk estimates for covid-19 calculated by using a lag
time for fatality. Centers for Dis. Control. Prev. 26, DOI: 10.3201/eid2606.200320 (2020).

10/21

Appendix
Transition rates in the epidemic model
Rate parameters α, δ , γ, µ are respectively used in Algorithm 2 and Algorithm 4 for calculating the total infection, recovery
from exposure, recovery from infection and death rates respectively. The corresponding time periods are already defined as TI ,
TER , TIR and TM respectively in Sec. 2.2. These rates are used to decide the transition, whereas parameters Fsym and Pµ are used
for selecting eligible nodes for transition.
Tuning and changing parameters during the lockdown periods
Isolation compliance for infected CI has been kept a constant throughout the simulation period as symptomatic agents have
been following the same norms throughout. As testing rate has increased gradually in different phases of lockdowns, isolation
compliance for exposed agents CE increases with the increasing phases of lockdowns. Border seal compliance CBS decreases
with lockdown phases as border seal policies become less stringent with passing time and inter-district mobility is allowed with
varying degrees in different phases of the lockdown. The probability of returning to home CH is least when there is no lockdown
as people are free to move and stay away from their homes when there is no intervention. It increases in the first phase of the
lockdown due to curbing of mobility and then decreases in the subsequent phases (constant in last three phases) as restrictions
are lifted gradually to some extent. The probability of removing an edge Pre is the probability of breaking an existing edge of
an agent when it moves to the same or a different zone. This probability is very low when there is no lockdown and is high
during lockdowns as agents tend to break contacts and keep it to minimum during lockdowns. The probability of creating an
edge Pce is kept high when there is no lockdown as agents move and make contacts freely. However, this probability is very low
in the first phase of lockdown due to strict social distancing norms and increases with small values in the subsequent phases
as restrictions on mobility are lifted gradually. As inter-family interactions are limited during lockdowns, the probability of
removing edges between families is quite high during lockdowns and decreases with lockdown phases as families start moving
and interacting with each other with more liberty. The probability of moving to a different district MDD is comparatively lower
during lockdowns as agents move to other districts only if it is very urgent. Refer to Table 3 for the values of these parameters
during different lockdown phases.

11/21

Table 1. Parameters of network part of the model, with notations for the variables and parameters
Network Parameter
Population network
Household size distribution for a district
Age distribution for a district
Gender distribution for a district
Age-wise probability of employment
Fraction of essential workers
Number of zones
Minimum number of families in a district
Name of the district
Name of the state
District’s Latitude-Longitude
State’s Latitude-Longitude
Epidemic state of a node
Last update time of a node
Node’s free mobility flag

Notation
N
Phousehold
Page
Pgender
Pemp
Fessential
Nzones
Min f amilies
district_name
state_name
district_latlong
state_latlong
ep_st
time
is_ f ree

Remarks
Hierarchical network formed using Algorithm 1
India Census 2011 data14
India Census 2011 data14
India Census 2011 data14
India Census 2011 data14
0.01
25
Backtracked from state’s population size to get 20k nodes for each network
India Census 2011 data14
India Census 2011 data14
Mapped from GeoPy 2
Mapped from GeoPy
Susceptible(S), Exposed(E), Infected(I), Recovered(R), Dead(D)
Day(relative to start of the simulation) when the state of agent changed last
Parameter to control node’s movement

Table 2. Parameters of epidemic part of the model and notations for variables and parameters
Epidemic Model Parameter
Initial infections
Contact rate for exposed population
Contact rate for infected population
Adjusted case fatality ratio
Fraction of symptomatic nodes
Incubation time
Recovery time from infection
Recovery time from exposure
Mortality time from infection
Maximum simulation days

Notation
Iinit
βE
βI
Pµ
Fsym
TI
TRI
TRE
TM
Tmax

Remarks
2
Sampled on daily basis for each node from Gamma distribution, shape=8.0, scale=0.6, constant=1.27
Sampled on daily bases for each node from Gamma distribution, shape=18.0, scale=0.4, constant=0.857
Specific to each Indian state (Code 3 , Data 436 )
0.4 29
Gamma distribution, shape=5.8, scale=0.9537, 38
Gamma distribution, shape=1400.0, scale=0.01 39
Gamma distribution, shape=25.0, scale=0.9 39
13 days40
136

12/21

Table 3. Parameters of model and notations for variables and parameters: Fixed day intervention
Epidemic Model Parameter
Intervention application dates (DD/MM)
Isolation compliance for infected
Isolation compliance for exposed
Border seal compliance
Probability of returning to home at night
Probability of removing an edge when an agent moves
Probability of creating an edge when an agent moves
Probability of removing edges between families
Inter-district mobility matrix
Look back period for contact tracing (in days)
Random testing for contact tracing

Notation
DtInt
CI
CE
CBS
CH
Pre
Pce
Pf e
MDD
TLB
NRT

No Intervention
18/03
0.7
0.3
0
0.8
0.2
0.85
0
0.3
5
2

Intervention 1
25/03
0.7
0.35
0.7
0.9
0.7
0.4
0.8
0.2
5
2

Intervention 2
15/04
0.7
0.4
0.65
0.875
0.7
0.45
0.7
0.2
5
3

Intervention 3
04/05
0.7
0.5
0.6
0.85
0.7
0.5
0.6
0.2
5
3

Intervention 4
18/05
0.7
0.55
0.5
0.85
0.7
0.525
0.5
0.2
5
0

Intervention 5
01/06
0.7
0.6
0.4
0.85
0.7
0.55
0.4
0.2
5
0

Table 4. Parameters of model and notations for variables and parameters: Interventions based on (a) Number of infections in a
district I(t), (b) Effective Reproduction Number ρ(t), and (c) Reinforcement Learning.
Epidemic Model Parameter
Isolation compliance for infected
Isolation compliance for exposed
Border seal compliance
Probability of returning to home at night
Probability of removing an edge when an agent moves
Probability of creating an edge when an agent moves
Probability of removing edges between families
Inter-district mobility matrix
Random testing for contact tracing
Maximum simulation days for I(t) and ρ(t)
Maximum simulation days for RL

Notation
CI
CE
CBS
CH
Pre
Pce
Pf e
MDD
NRT
Tmax
Tmax

No Intervention
0.7
0.3
0
0.8
0.2
0.85
0
0.3
2
306
136

Intervention
0.9
0.9
0.9
0.95
0.7
0.5
0.8
0.2
5

Table 5. Threshold for intervention
Epidemic Model Parameter
I(t)
ρ(t)

Upper threshold
Iu = 0.00175
ρu = 1

Lower threshold
Id = 0.00131
ρd = 0.5

Table 6. Mobility Matrix (MZZ ) for weekdays in the absence of intervention (lockdown) for all source zones
Age group

Age Bracket 1

Age Bracket 2

Age Bracket 3

Time bin
Morning
Afternoon
Evening
Night
Morning
Afternoon
Evening
Night
Morning
Afternoon
Evening
Night

RR
0.4
0.4
0.47
0.46
0.05
0.2
0.225
0.29
0.2
0.25
0.3
0.55

Destination zone
EE
EPB
EPV
0.45
0.01
0.04
0.45
0.01
0.04
0.34
0.07
0.02
0.29
0.13
0.02
0.5
0.25
0.1
0.45
0.15
0.1
0.375 0.175 0.125
0.13
0.24
0.24
0.6
0.05
0.05
0.55
0.05
0.05
0.5
0.05
0.05
0.25
0.05
0.05

NM
0.1
0.1
0.1
0.1
0.1
0.1
0.1
0.1
0.1
0.1
0.1
0.1

13/21

Table 7. Mobility Matrix (MZZ ) for weekends in the absence of intervention (lockdown) for all age brackets
Source zone

RR

EE

EPB

EPV

Time bin
Morning
Afternoon
Evening
Night
Morning
Afternoon
Evening
Night
Morning
Afternoon
Evening
Night
Morning
Afternoon
Evening
Night

RR
0.22
0.29
0.33
0.43
0.22
0.29
0.33
0.43
0.225
0.295
0.335
0.655
0.225
0.295
0.335
0.655

Destination zone
EE
EPB
EPV
0.52 0.1
0.06
0.48 0.07
0.06
0.41 0.1
0.06
0.19 0.16
0.12
0.66 0.01
0.01
0.59 0.01
0.01
0.55 0.01
0.01
0.45 0.01
0.01
0.05 0.62
0.005
0.05 0.55
0.005
0.41 0.15
0.005
0.19 0.05
0.005
0.05 0.005 0.62
0.05 0.005 0.55
0.41 0.005 0.15
0.19 0.005 0.05

NM
0.1
0.1
0.1
0.1
0.1
0.1
0.1
0.1
0.1
0.1
0.1
0.1
0.1
0.1
0.1
0.1

Table 8. Mobility Matrix (MZZ ) during intervention (lockdown) for all zones and all age brackets.
Time bin
Morning
Afternoon
Evening
Night

RR
0.3
0.1
0.3
0.5

Destination zone
EE
EPB EPV
0.001 0.02 0.01
0.001 0.02 0.01
0.001 0.02 0.01
0.001 0.02 0.01

NM
0.669
0.869
0.669
0.469

14/21

Algorithm 1 Network Model
create_zones_grid(.): Assigns random zones to the grid within a district.
get_distributions(.): Returns the distribution of household size, age, gender and employment according to age for each district
from census data.
get_complete_graph(.): Create complete graph according to Phousehold .
assign_attributes(.): Assigns state, district, zone, grid and global (district) coordinates, age bucket, employment, gender,
essential traveller flag (1 = essential, 0 = non-essential), epidemic state, last update time (used in epidemic modeling), mobility
flag (1 = movable, 0 = non-movable) attributes to each node of a complete family graph.
connect_ f amilies(.): Connect families based on preferential attachment rule.
get_gravity_attributes(.): Returns district’s size and latitude-longitude.
size_district ×size_district j
gravity_law(.): Returns edges based on formula: d (latlong_districti ,latlong_district
; where dH is haversine distance.
)2
H

i

j

get_dis joint_union(.): Returns a disjoint union graph of all districts without edges between them.
sample_nodes(.): Returns sampled nodes from two input district graphs based on the edges (calculated from gavity law)
between them (with replacement).
connect_edges(.): Connect the sampled nodes in the disjoint union graph.
1:
2:
3:
4:
5:
6:
7:
8:
9:
10:
1:
2:
3:
4:
5:
6:
7:
8:
9:
10:
11:
12:
13:
14:
15:
16:

procedure create_network(Min f amilies , Fessential , Nzones , state_name, district_name, district_latlong, ep_st,time,
is_ f ree)
position_zone_mapping = create_zones_grid(Nzones )
Phousehold , Page , Pgender , Pemp = get_distributions(Min f amilies )
for complete_graph in get_complete_graphs(Phousehold ) do
f amilies = assign_attributes(complete_graph, Phousehold , Page , Pgender , Pemp , Fessential , state_name, district_name,
district_latlong, position_zone_mapping, ep_st,time, is_ f ree)
end for
districts = connect_ f amilies( f amilies)
state_graph = connect_districts(districts)
return state_graph
end procedure
procedure connect_districts(districts)
for districti in districts do
for district j in districts do
sizei , size j , latlongi , latlong j = get_gravity_attributes(districti , district j )
edges_btw_districtsi, j = gravity_law(sizei , size j , latlongi , latlong j )
end for
end for
dis joint_union_graph = get_dis joint_union(districts)
for districti in districts do
for district j in districts do
nodesi , nodes j = sample_nodes(districti , district j , edges_btw_districtsi, j )
dis joint_union_graph = connect_edges(nodesi , nodes j , dis joint_union_graph)
end for
end for
return dis joint_union_graph
end procedure

15/21

Algorithm 2 Epidemic spread model
num_time_o f _day: 4 divisions within a day: morning, noon, evening and night.
set_time(.): Initializes incubation, recovery and mortality time for every node.
rand(a, b): Returns a random number between a and b.
get_exp_in f _nodes(.): Returns exposed and infected nodes eligible for recovery.
get_exp_nodes(.): Returns exposed nodes eligible for infection.
get_scp_nodes(.): Returns susceptible nodes eligible for exposure.
get_in f _nodes(.): Returns infected nodes eligible for death.
get_lockdown_ f lags(.): Returns district-wise lockdown flags on the basis of the current network state.
α (infection rate) = 1/TI
γ (recovery rate from infection) = 1/TRI
δ (recovery rate from exposure) = 1/TRE
1:
2:
3:
4:
5:
6:
7:
8:
9:
10:
11:
12:
13:
14:
15:
16:
17:
18:
19:
20:
21:
22:
23:
24:
25:
26:
27:
28:
29:
30:
31:
32:
33:
34:
35:
36:
37:
38:
39:
40:
41:
42:
43:
44:

procedure GillespieSEIRD (N, Iinit , βE , βI , α, δ , γ, µ, TI , TRI , TRE , TM , CI , CE , CBS , Pre , Pce „ MDD , MZZ , Tmax )
num_time_o f _day = 4
N = set_time(N, TI , TRI , TRE , TM )
N, in f ected_nodes = set_initial_in f ections(N, Iinit )
exposed_nodes = get_exposed_nodes(N)
nw_params = get_nw_params(N, exposed_nodes, in f ected_nodes, βE , βI , α, δ , γ, µ)
day_count = 0
nw_tra jectory = []
while day_count < Tmax and nw_params.tot_rt > 0 do
day_count+ = 1
time_o f _day = 0
while time_o f _day < num_time_o f _day do
time_o f _day+ = 1
ct = get_current_time(day_count,time_o f _day)
if not (day_count == 1 and time_o f _day == 1) then
N = mobilize(N, day_count,time_o f _day,CI ,CE ,CBS , Pre , Pce , MDD , MZZ , lockdown_ f lags)
nw_params = get_nw_params(N, exposed_nodes, in f ected_nodes, βE , βI , α, δ , γ, µ)
end if
r = rand(0, 1)
PR = nw_params.tot_rec_rt
nw_params.tot_rt
f _rt
PI = nw_params.tot_in
nw_params.tot_rt
PE = nw_params.tot_exp_rt
nw_params.tot_rt
PD = nw_params.tot_mor_rt
nw_params.tot_rt
if r < PR then
exp_in f _nodes = get_exp_in f _nodes(Pµ , Fsym , exposed_nodes, in f ected_nodes)
for ei in exp_in f _nodes do
if ei.ep_st == I and ct − ei.time >= TRI (ei) then
N.ei.ep_st = R
N.ei.time = ct
else if ei.ep_st == E and ct − ei.time >= TRE (ei) then
N.ei.ep_st = R
N.ei.time = ct
end if
end for
else if PR <= r < PR + PI then
exp_nodes = get_exp_nodes(Fsym , nw_params.in f _prob_mapping)
for e in exp_nodes do
if ct − e.time >= TI (e) then
exposed_nodes.remove(e)
in f ected_nodes.append(e)
N.e.ep_st = I
N.e.time = ct
end if
end for

16/21

45:
46:
47:
48:
49:
50:
51:
52:
53:
54:
55:
56:
57:
58:
59:
60:
61:
62:
63:
64:
65:
66:
67:
68:
69:
70:
71:
72:
73:

else if PR + PI <= r < PR + PI + PE then
scp_nodes = get_scp_nodes(nw_params.exp_prob_mapping)
for s in scp_nodes do
exposed_nodes.append(s)
N.s.ep_st = E
N.s.time = ct
end for
else
in f _nodes = get_in f _nodes(Pµ , in f ected_nodes)
for i in in f _nodes do
if ct − i.time >= TM (i) then
in f ected_nodes.remove(i)
N.i.ep_st = D
N.i.time = ct
end if
end for
end if
lockdown_ f lags = get_lockdown_ f lags(N)
nw_tra jectory.append(N)
if nw_params.tot_rt <= 0 then
break
end if
end while
if nw_params.tot_rt <= 0 then
break
end if
end while
return nw_tra jectory
end procedure

17/21

Algorithm 3 Mobility model
isolate_in f ected(.): Isolates infected nodes with a compliance probability CI and sets is_ f ree attribute to 0.
isolate_exposed(.): Isolates exposed nodes with a compliance probability CE and sets is_ f ree attribute to 0.
isolate_dead(.): Isolates dead nodes and sets is_ f ree attribute to 0.
seal_borders(.): Disconnects districts on the basis of lockdown_ f lags with a compliance probability CBS .
contact_tracing_and_isolation(.): Traverses and tests the neighbourhood of infected agents and isolates them if tested positive.
get_lckdwn_ f lag(.): Returns lockdown flag for the current district.
get_mat(.): Returns the appropriate matrix with movement probabilities on the basis of day of week, current time and lockdown.
get_target(.): Returns the target district and zone on the basis of mvmnt_mat and agent features like employment status etc. It
also ensures that at night, agents return to their respective residential districts with probability CH and inter family edges are
removed with a probability Pf e .
update_edges(.): Updates network interactions on the basis of target district and target zone. In case of short range movement(within the same zone of the same district), single edge is removed with Pre and another is created with Pce . Otherwise, all
edges are removed with Pre and a single edge is created in the target area with Pce . No changes are made if the node does not
move.
update_spatial_con f ig(.): Updates latitude-longitude and zonal coordinates as per the movement.
1:
2:
3:
4:
5:
6:
7:
8:
9:
10:
11:
12:
13:
14:
15:
16:
17:
18:
19:
20:
21:
22:

procedure mobilize(N, day_count,time_o f _day,CI ,CE ,CBS , Pre , Pce , MDD , MZZ , lockdown_ f lags)
ct = get_current_time(day_count,time_o f _day)
N = isolate_in f ected(N,CI )
N = isolate_exposed(N,CE )
N = isolate_dead(N)
N = seal_borders(N,CBS , lockdown_ f lags)
N = contact_tracing_and_isolation(N, TLB , NRT )
for node in N.nodes do
if node.is_ f ree then
if node.is_essential_service_provider then
mvmnt_mat = get_mat(node, ct, 0, MDD , MZZ )
else
lckdwn_ f lg = get_lckdwn_ f lag(lockdown_ f lags, node.curr_dist)
mvmnt_mat = get_mat(node, ct, lckdwn_ f lg, MDD , MZZ )
end if
target_dist, target_zone = get_target(node, mvmnt_mat, ct,CH , Pf e )
N = update_edges(node,target_dist,target_zone, N, Pre , Pce )
N = update_spatial_con f ig(node,target_dist,target_zone, N)
end if
end for
return N
end procedure

18/21

Algorithm 4 Get Network Parameters
num_neighbors(.): Returns number of neighbors of a node in a specific epidemic state.
procedure get_nw_ params(N, exposed_nodes, in f ected_nodes, βE , βI , α, δ , γ, µ)
nodes_at_risk_o f _exposure = []
neighbors_o f _exposed = N.neighbors(exposed_nodes)
neighbors_o f _in f ected = N.neighbors(in f ected_nodes)
nodes_at_risk_o f _exposure.append(neighbors_o f _exposed)
nodes_at_risk_o f _exposure.append(neighbors_o f _in f ected)
exp_prob_mapping = dict()
tot_exp_rt = 0
for node in nodes_at_risk_o f _exposure do
er = βE × num_neighbors(node, E) + βI × num_neighbors(node, I)
exp_prob_mapping[node] = er
tot_exp_rt+ = er
end for
in f _prob_mapping = dict()
tot_in f _rt = 0
for node in exposed_nodes do
in f _prob_mapping[node] = α
tot_in f _rt+ = α
end for
tot_rec_rt = γ × len(in f ected_nodes) + δ × len(exposed_nodes)
tot_mor_rt = µ × len(in f ected_nodes)
tot_rt = tot_exp_rt + tot_in f _rt + tot_rec_rt + tot_mor_rt
return nw_params(exp_prob_mapping, in f _prob_mapping,tot_exp_rt, tot_in f _rt,tot_rec_rt,tot_mor_rt,tot_rt)
end procedure

19/21

5

5

5

AP

5

BR

CH

DL

4

4

4

4

3

3

3

3

2

2

2

2

1

1

1

1

0
20/3

0
20/3

0
20/3

20/4

20/5

20/6

20/7

5

20/4

20/5

20/6

20/7

5

20/4

20/5

20/6

0
20/3

20/7

5

GJ

HR
4

4

3

3

3

3

2

2

2

2

1

1

1

1

20/5

20/6

20/7

5

0
20/3

20/4

20/5

20/6

20/7

5

0
20/3

20/4

20/5

20/6

0
20/3

20/7

5

MH

4

3

3

3

3

2

2

2

2

1

1

1

1

20/6

20/7

5

0
20/3

20/4

20/5

20/6

20/5

20/7

5

20/6

20/7

RJ

4

20/5

20/4

OR

4

20/4

20/7

5

MP

4

0
20/3

20/6

KA

4

20/4

20/5

JK

4

0
20/3

20/4

5

0
20/3

20/4

20/5

20/6

0
20/3

20/7

20/4

20/5

20/6

20/7

5

TG

TN

4

4

3

3

2

2

1

1

INDIA
4

3
0
20/3

20/4

20/5

20/6

20/7

5

0
20/3

20/4

20/5

20/7

5

UP
4

3

3

2

2

1

1

20/4

20/5

20/6

2

WB

4

0
20/3

20/6

20/7

0
20/3

1

0
20/4

20/5

20/6

20/7

20/3

20/4

20/5

20/6

20/7

Figure 8. The evolution of the effective reproduction rate ρ(t) with time for some states of India as well as the whole country
(shown until 31/07/2020). ρ(t) calculated using code from
https://github.com/k-sys/covid-19/blob/master/Realtime%20R0.ipynb and statewise India data
from Covid19india API.

20/21

Figure 9. The simulated connected network of families in a single residential zone of Mumbai suburban district in
Maharashtra during the epidemic on (a) day 6 (b) day 26 and (c) day 75 at night time. Some nodes are absent and new nodes
are present due to mobility across zones and districts. The colors depict the epidemic states of the individuals. Susceptible S
(cyan), Exposed E (blue), Infected I (red), Recovered R (green), Dead D (grey). This is one of the simulated networks for the
data presented in Fig. 4.

21/21

