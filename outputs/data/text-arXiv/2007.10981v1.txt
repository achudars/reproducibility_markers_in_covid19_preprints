Forecasting Brazilian and American COVID-19 cases based on
artificial intelligence coupled with climatic exogenous variables
Ramon Gomes da Silvaa,∗, Matheus Henrique Dal Molin Ribeiroa,b , Viviana Cocco
Marianic,d , Leandro dos Santos Coelhoa,d

arXiv:2007.10981v1 [q-bio.PE] 21 Jul 2020

a

Industrial & Systems Engineering Graduate Program (PPGEPS), Pontifical Catholic University of Parana
(PUCPR). 1155, Rua Imaculada Conceicao, Curitiba, PR, Brazil. 80215-901
b
Department of Mathematics, Federal Technological University of Parana (UTFPR). Via do Conhecimento,
KM 01 - Fraron, Pato Branco, PR, Brazil. 85503–390
c
Mechanical Engineering Graduate Program (PPGEM), Pontifical Catholic University of Parana
(PUCPR). 1155, Rua Imaculada Conceicao, Curitiba, PR, Brazil. 80215-901
d
Department of Electrical Engineering, Federal University of Parana (UFPR). 100, Avenida Coronel
Francisco Heraclito dos Santos, Curitiba, PR, Brazil. 81530-000

Abstract
The novel coronavirus disease (COVID-19) is a public health problem once according to the
World Health Organization up to June 10th, 2020, more than 7.1 million people were infected,
and more than 400 thousand have died worldwide. In the current scenario, the Brazil and the
United States of America present a high daily incidence of new cases and deaths. Therefore,
it is important to forecast the number of new cases in a time window of one week, once this
can help the public health system developing strategic planning to deals with the COVID19. The application of the forecasting artificial intelligence (AI) models has the potential
of deal with difficult dynamical behavior of time-series like of COVID-19. In this paper,
Bayesian regression neural network, cubist regression, k-nearest neighbors, quantile random
forest, and support vector regression, are used stand-alone, and coupled with the recent preprocessing variational mode decomposition (VMD) employed to decompose the time series
into several intrinsic mode functions. All AI techniques are evaluated in the task of timeseries forecasting with one, three, and six-days-ahead the cumulative COVID-19 cases in five
Brazilian and American states, with a high number of cases up to April 28th, 2020. Previous
cumulative COVID-19 cases and exogenous variables as daily temperature and precipitation
were employed as inputs for all forecasting models. The models’ effectiveness are evaluated
based on the performance criteria. In general, the hybridization of VMD outperformed single
forecasting models regarding the accuracy, specifically when the horizon is six-days-ahead,
the hybrid VMD–single models achieved better accuracy in 70% of the cases. Regarding
the exogenous variables, the importance ranking as predictor variables is, from the upper
to the lower, past cases, temperature, and precipitation. Therefore, due to the efficiency
of evaluated models to forecasting cumulative COVID-19 cases up to six-days-ahead, the
∗

Corresponding author
Email address: gomes.ramon@pucpr.edu.br (Ramon Gomes da Silva)

Preprint submitted to Chaos, Solitons & Fractals

July 22, 2020

adopted models can be recommended as a promising models for forecasting and be used to
assist in the development of public policies to mitigate the effects of COVID-19 outbreak.
Keywords: Artificial intelligence, COVID-19, Exogenous variables, Forecasting,
Variational mode decomposition, Machine learning
1. Introduction
The new coronavirus disease (COVID-19) is a virus infectious disease induced by severe
acute respiratory syndrome coronavirus 2 (SARS-CoV2). According to the World Health
Organization (WHO), most of the population will mild to moderate respiratory illness and
recover without requiring special treatment [1]. However, several studies are being developed, and preliminary results indicated that people with underlying medical problems like
cardiovascular disease, diabetes, chronic respiratory disease, obesity, and cancer are more
likely to develop serious injuries [2, 3, 4, 5, 6, 7]. Also, the COVID-19 can cause extensive and multiple lung injuries [8], thus compromising the respiratory system of patients.
In this context, the demand for devices that assist in the performance of breathing-related
movements have increased.
Due to the serious damage caused by COVID-19, according to WHO, up to June 10th
2020, more than 7.1 million people were already infected, as well as more than 400 thousand people worldwide have now died with the coronavirus. Indeed, considering the current
scenario of the health system worldwide, the overcrowding could be observed in some countries, like Italy, Spain and perhaps Brazil. In Brazil context, believed that the average of
3388 municipalities could have a significant deficit in hospital beds. Especially, the deficit is
projected to occur in Brazilian North and Northeast regions, which means exceeding health
care capacity due to the COVID-19 [9].
Considering the importance of knowing the difficult epidemiological scenario for COVID19 on a short-term horizon, to mitigate the effects of this pandemic, the development of
efficient and effective forecasting models also has a positive impact on product reasonably
accurate success rates forecasts the immediate future. Also, these models allow health managers to develop strategic planning and perform decision-making as assertively as possible.
For this purpose, epidemiological models can be used, as it has been widely adopted in
[10, 11]. Alternatively, linear forecasting models [12, 13, 14], artificial intelligence (AI) approaches [15, 16], as well as hybrid forecasting models [17, 18] proved to be effective tools to
forecast COVID-19 cases. The advantages of AI approaches for time series forecasting lie in
the flexibility of dealing with different kinds of response variables, as well as to the ability of
these approaches to learning data dynamical behavior, complexity and accommodate nonlinearities, such as the observed in epidemiological data [19]. Besides, hybrid methodologies
allow us to combine several techniques such as pre-processing methods and single forecasting
models.
By the coupling of some methods, it is possible to use the specialty of each one to deal
with different characteristics and therefore building an effective model. In context of the
preprocessing techniques, especially signal decomposition methods, the variational mode
2

decomposition (VMD) [20] is an effective approach to decompose a dimensional signal into
an ensemble of band-limited modes with specific bandwidth in a spectral domain applied in
several fields [21, 22, 23], once can deal with nonlinearities, and non-stationarity inherent to
time series. Considering the intrinsic mode function (IMF) obtained through VMD, it is hard
to choose AI models to train and forecasting the VMD components. Therefore, based on
this understanding, some models are coupled with VMD and are described in the following.
Due to the necessity of understanding the COVID-19 outbreak, and the associated factors,
or exogenous variables, some studies are being conducted considering the social environment,
climatic variables, pollution, and population density [24, 25, 26, 27, 28]. In this direction, in
a general aspect, Sobral et al. [29] investigated the effects of climatic variables in COVID-19
spread for 166 countries. The authors argued that increasing the temperature reduced the
COVID-19 cases, and precipitation also has a positive correlation with SARS-CoV2 cases.
In the sequence, for Brazil, Auler et al. [30] evaluated how meteorological conditions such
as temperature, humidity, and rainfall can affect the spread of COVID-19 in five Brazilian
cities. The authors concluded that higher mean temperatures and average relative humidity
might support the COVID-19 transmission. Considering the United States of America (USA)
weather aspects, especially for the New York state, Bashir et al. [31] inferred that average
and minimum temperature and air quality are significantly associated with the COVID-19
pandemic. All previously mentioned studies tried related the climatic variables with COVID19 but in those papers were not incorporated in time series models to forecasting COVID-19
cases. However, we think that incorporating the exogenous climatic variables in forecasting
models can help to understand the data dynamic, and perhaps more efficient forecasting
models could be obtained [32].
In this respect, for forecasting of cumulative cases of COVID-19, the objective of this
paper is to explore and compare the predictive capacity of Bayesian regression neural network (BRNN), cubist regression (CUBIST), k-nearest neighbors (KNN), quantile random
forest (QRF), and support vector regression (SVR) when are used stand-alone, and a hybrid
framework composed by VMD coupled with previously mentioned models. In this study were
used as datasets the number about the cumulative cases of COVID-19 from five Brazilian
states (Amazonas - AM, Ceara - CE, Pernambuco - PE, Rio de Janeiro - RJ, and Sao Paulo
- SP), the first state from north region, the second and third states from northeast region,
and the other two states from southeast region. Also were considered five American states
(California - CA, Illinois - IL, Massachusetts - MA, New Jersey - NJ, and New York - NY).
The choice of these states was made through the largest number of new cases of COVID-19
up to 28 April 2020.
In the task of forecasting horizons of the time series one, three, and six-days-ahead
of cumulative COVID-19 cases are adopted to evaluates the forecasting efficiency of the
different models. Additionally, previous COVID-19 cases, and exogenous variables such as
daily temperature (maximum and minimum), and precipitation are employed as inputs for
each evaluated model. The output-of-sample forecasting accuracy of each model is compared
by performance metrics such as the improvement percentage index (IP), symmetric mean
absolute percentage error (sMAPE), and relative root mean squared error (RRMSE). Also,

3

the importance of each input variable is presented for each country.
Forecasting models are impacted by the small dataset effect and the prediction of cases of
COVID-19 a challenging task. The choice of the forecasting and pre-processing approaches
is due to the fact that even that non-linear and AI models need large datasets to properly
learn the data pattern, the use of exogenous variables (climate variables) and past values of
the response variable overcomes this drawback.
VMD decomposes a time series into its intrinsic mode functions adaptively and nonrecursively obtaining a set of sub-series with different features from low-frequency to highfrequency. The adoption of VMD with modes in conjunction with nonlinear prediction
models of machine learning is a powerful framework to approach small datasets in forecasting
task. In addition, BRNN and SVR approaches are capable of handling small samples, which
makes them attractive for this study.
The contributions of this paper can be summarized as follows:
• The first contribution is related to the proposal of two frameworks, non-decomposed
and decomposed models, applied in the task of forecasting the new cumulative cases
of COVID-19 in five Brazilian and American states. It is expected that these evaluated models can be used as most accurate approaches to perform decision-making to
structure the health system to avoid overcrowding in hospitals, and preventing new
deaths.
• The second contribution, we can highlight the use of a distinct set of AI models based
on machine learning approaches regarding learning structure, even as the recent effective pre-processing VMD to forecasting the Brazilian and American COVID-19 new
cumulative cases. The forecasting models BRNN, CUBIST, KNN, QRF, SVR, and
pre-processing VMD method were chosen once that have reached success into several
fields of regression and time series forecasting [33, 34, 35, 36];
• Also, this paper evaluates AI models in a multi-day-ahead forecasting strategy coupled
with climatic exogenous inputs. The range of the forecasting time horizon allows us to
verify the effectiveness of the predicting models in different scenarios, associated with
inputs such as previous COVID-19 cumulative cases, temperature, and precipitation,
allowing that the models achieve high forecasting accuracy. Finally, their results can
help in planning actions to improve the health system to contain the COVID-19 deaths.
The remainder of this paper is organized as follows: Section 2.1 a brief description of
the dataset adopted in this paper is presented. The forecasting models applied in this
study are described in Section 2.2. Section 3 details the procedures applied in the research
methodology. Results obtained and related discussion about models’ forecasting performance
are mentioned in Section 4. Finally, Section 5 concludes this study with considerations and
some directions for future research proposals.

4

2. Material and Methods
This section presents a description of the material analyzed (Section 2.1), as well as the
model’s description applied in this paper (Section 2.2).
2.1. Dataset Description
The collected dataset refers to the COVID-19 cumulative cases that occurred in five states
of the Brazil and the USA until April 20th, 2020. For the Brazilian context, the dataset
was collected from an API (Application Program Interface) [37] that retrieves the daily
information about COVID-19 cases from all 27 Brazilian State Health Offices, assembles
and makes them publicly available. And for USA context, the dataset was collected from
“COVID-19 Data Repository” on Github provided by the Center for Systems Science and
Engineering (CSSE) at Johns Hopkins University [38]. The cumulative confirmed cases and
deaths of each state, and the period from the first and last reports, are illustrated in Table 1.
Table 1: Summary of COVID-19 cases by country and state

Country

Brazil

USA

State
AM
CE
PE
RJ
SP
CA
IL
MA
NJ
NY

Number of
observed days
47
44
48
55
64
94
96
87
55
58

Fist
reported
13/03/2020
16/03/2020
12/03/2020
05/03/2020
25/02/2020
26/01/2020
24/01/2020
01/02/2020
05/03/2020
02/03/2020

Last
reported
28/04/2020
28/04/2020
28/04/2020
28/04/2020
28/04/2020
28/04/2020
28/04/2020
27/04/2020
28/04/2020
28/04/2020

Cumulative
cases
4337
6985
5724
8504
24041
46164
48102
56462
113856
295106

Cumulative
deaths
351
403
508
738
2049
1864
2125
3003
6442
22912

The climatic exogenous variables were retrieved from the “Instituto Nacional de Meteorologia” (INMET) [39] for data from Brazil, while the USA climate dataset were taken
into a count from the daily global historical climatology network that was retrieved from
the National Centers for Environmental Information (NCEI) from the National Oceanic and
Atmospheric Administration [40], by using rnoaa package [41]. For each state, considering
the daily available information, minimum and maximum temperature (o C ), and precipitation (mm) were select as climatic exogenous inputs to each forecasting model applied in this
study. The measurement period of each state is variable, this is due because the record of
the first case of the disease may differ from state to state. The summary of the climatic
variables used is described in Table 2.
The heat-map of the cumulative confirmed cases from the Brazil and the USA in each
of the five states analyzed are presented in Figure 1. In that figure can be seen that the
states with the highest number of COVID-19 cumulative cases are SP and NY, respectively,
in Brazil and the USA, the states with the highest demographic index in both countries.
5

Table 2: Descriptive measures for climatic variables by country and state
Country

State
AM

CE

Brazil

PE

RJ

SP

CA

IL

USA

MA

NJ

NY

AM

Variable
Minimum temperature (o C )
Maximum temperature (o C )
Precipitation (mm)
Minimum temperature (o C )
Maximum temperature (o C )
Precipitation (mm)
Minimum temperature (o C )
Maximum temperature (o C )
Precipitation (mm)
Minimum temperature (o C )
Maximum temperature (o C )
Precipitation (mm)
Minimum temperature (o C )
Maximum temperature (o C )
Precipitation (mm)
Minimum temperature (o C )
Maximum temperature (o C )
Precipitation (mm)
Minimum temperature (o C )
Maximum temperature (o C )
Precipitation (mm)
Minimum temperature (o C )
Maximum temperature (o C )
Precipitation (mm)
Minimum temperature (o C )
Maximum temperature (o C )
Precipitation (mm)
Minimum temperature (o C )
Maximum temperature (o C )
Precipitation (mm)

Minimum
24.76
25.29
0.00
25.14
25.91
0.00
23.36
24.27
0.00
19.07
19.69
0.00
17.60
18.76
0.00
-1.76
10.60
0.01
-19.42
-6.39
0.00
-14.75
-2.77
0.00
-11.80
0.54
0.00
-20.48
-7.98
0.00

Median
26.20
27.05
0.11
26.62
27.73
0.12
25.18
26.30
0.14
21.23
22.16
0.03
19.99
21.11
0.00
4.90
18.33
4.66
-0.42
8.40
4.29
-0.86
8.32
6.84
1.60
10.78
5.44
-2.61
5.62
9.94

Mean
26.36
27.24
0.33
26.60
27.68
0.25
25.05
26.10
0.23
21.57
22.56
0.13
20.09
21.37
0.12
4.91
18.54
20.98
-0.75
8.99
23.30
-1.76
8.16
34.66
0.96
11.22
31.53
-3.75
6.23
27.61

Maximum
28.28
29.55
2.40
27.90
28.99
1.31
26.74
27.96
1.33
25.33
26.49
1.32
23.40
25.03
1.19
11.92
28.59
162.67
14.63
26.06
196.47
5.39
18.70
320.86
7.27
22.02
274.04
4.60
17.88
167.94

CE
PE

Cumulative
confirmed cases

NY

30000

MA

Cumulative
confirmed cases

25000

IL

20000

NJ

10000

SP

250000
200000

15000

CA

150000
100000

RJ

50000

(a) Brazil

(b) USA

Figure 1: Heatmap of the cumulative confirmed cases to five states from Brazil and USA.

2.2. Methodologies
This section presents a summary of each model employed in the data analysis.
• BRNN is a kind of feedforward neural network, a two-layer neural network, composed
by one input and one hidden layer, which uses the Bayesian methods, such as empirical
Bayes, for parameter estimation, to avoid overfitting [42]. In the BRNN formulation,
6

the variances are regularization parameters, in which the trade-off between goodnessof-fit and smoothing can be controlled. Also, in this approach the method of [43] is used
to assign initial weights of neural network and the Gauss-Newton training algorithm to
perform the optimization. For the datasets evaluated in this paper, the BRNN becomes
attractive once it can deal with small samples, as well as it has a lower computational
cost.
• CUBIST is a rule-based algorithm used to build forecasting models (in the time series
field) based on the analysis of input data [44]. It estimates the target values by establishing regression models with one or more rules (committee/ensemble of rules) based
on the input set. These rules are employed based on a combination of conditions with
a linear function (in general linear regression). When the rule satisfies all conditions
defined in the learning process, this approach can execute multiple rules once and find
different linear functions suitable to forecast COVID-19 cases. However, if the standard deviation reduction value is smaller or equal to the expected error for sub-tree,
some leaves are pruned to avoid overfitting [15].
• KNN is an instance-based learner model designed to solve classification and regression
problems [45]. In fact, in the time series context, the KNN searches k nearest past
similar values in the input set (past COVID-19 values, and climatic variables), in which
these k values are namely nearest neighbors. In this context, to find the nearest values,
a similarity measure is adopted. The k -nearest neighbors are those that similarity
measure between past cases and new cases is the smallest. Considering that the set
of k -nearest neighbors are defined, the forecasting of new COVID-19 cases is obtained
through of average of past similar values. In contrast to the simplicity of this supervised
learning, the computational cost may be a disadvantage [32].
• QRF approach is an extension of the random forests (RF) ensemble model [46]. It
provides information about the full conditional distribution of the response variable,
not only about the conditional mean. In this approach, the use of conditional quantile is
to enhance the RF performance, which makes this a consistent approach [47]. The main
assumption about QRF lies in that weighted observations can be used for estimating
the conditional mean [48]. Additionally, while the RF approach keeps in the results
information as regards the average cases of COVID-19 of the leaves, the QRF keeps
all COVID-19 cases contained in the leaves.
• SVR is a type support vector machine that consists in determining support vectors
close to a hyperplane, which maximizes the margin between two-point classes obtained
from the difference between the target value and a threshold. To deal with nonlinear problems SVR takes into account kernel functions, which calculates the similarity
between two observations through the inner product. In this paper, the linear kernel
is adopted. The main advantages of the use of SVR lie in its capacity to capture the
predictor non-linearity and then use it to improve the forecasting cases. Also, it is

7

advantageous to employ to forecast COVID-19 cumulative cases, once the samples are
small [49, 15].
• VMD is a pre-processing technique in the field of decomposition approaches, which
decomposes a time series into a finite and predefined k number of Intrinsic Mode
Functions (IMF) or mode functions. In a general way, VMD reproduces the decomposed signal with different sparsity properties [20]. There are three main concepts
related to VMD, which are Wiener filtering, Hilbert transform and analytic signal, and
frequency mixing and heterodyne demodulation. Sparsity prior of each mode is chosen
as bandwidth in the spectral domain and can be accessed by the following scheme for
each model: (i) compute associated analytic signal utilizing the Hilbert transform to
obtain a unilateral frequency spectrum; (ii) shift frequency spectrum of mode to baseband by mixing the exponential tune to the respective estimated center frequency; and
(iii) the bandwidth estimated through the Gaussian smoothness of the demodulated
signal [21].
3. Proposed forecasting framework
This section describes the main steps in the data analysis adopted by BRNN, CUBIST,
KNN, QRF, SVR, and VMD based models.
Step 1: First, the dataset output variables are decomposed into five IMFs by performing
VMD. The lag equal 2 was chosen by grid-search, applied on the IMFs creating four inputs
from the lags, and applied on the exogenous inputs as well. Further, the new data is split
into training and test sets. The test set consists of the last six observations and the training
set defined by the remaining samples. In the training state, leave one-out-cross-validation
with time slice was adopted, such as developed by [32].
Step 2: Each IMF is trained with each model described in Section 2.2 using time-slice
validation approach. Next, the IMF predictions were reconstructed by a simple summationgrouping model, in other words, the IMF is trained by the same model and is summed. Then,
five predictions outputs were generated named VMD–BRNN, VMD–CUBIST, VMD–KNN,
VMD–QRF, and VMD–SVR.
Step 3: A recursive strategy is employed to develop multi-days-ahead COVID-19 cases
forecasting [15]. Regarding this, one model is fitted for one-day-ahead forecasting, then the
recursive strategy uses this forecasting result as an input for the same model to forecast
the next step, continuing until the desirable forecasting horizon. In this study, the aim is to
obtain the cases up to H next days, especially up to 1 (ODA, one-day-ahead), 3 (TDA, threedays-ahead), and 6-days-ahead (SDA, six-days-ahead), respectively. The following structures
are considered,
 
ˆ

if h = 1,
f y(t+h−1) , y(t+h−2) , X(t+h−1)
ŷ(t+h) = fˆ ŷ(t+h−1) , ŷ(t+h−2) , X(t+h−3)
(1)
if h = 3,

 ˆ
f ŷ(t+h−1) , ŷ(t+h−2) , X(t+h−6)
if h = 6,
where fˆ is a function that maps the cumulative COVID-19 cases, ŷ(t + h) is the forecast
of cumulative cases in horizon h =1, 3 and 6, y(t + h − 1), y(t + h − 2) are the previous
8

observed, ŷ(t + h − 1), ŷ(t + h − 2) are the predicted cumulative cases, X(t + h − nx ) is the
exogenous inputs vector at the maximum lag of inputs (nx = 1 if h = 1, nx = 3 if h = 3,
and nx = 6 if h = 6).The analyses are developed using R software [50]. All hyperparameters
employed in this study are presented in Tables B.1 and B.2 in Appendix B.
Step 4: To evaluate the effectiveness of adopted models, from obtained forecasts out-ofsample (test set), performance IP (2), sMAPE (3), and RRMSE (4) criteria are computed
as
Mc − Mb
(2)
IP = 100 ×
,
Mc
n
2 X |yi − ŷi |
sMAPE =
,
(3)
n i=1 |yi | + |ŷi |
s n
X
1
(yi − ŷi )2
n
i=1

RRMSE =

1
n

n
X

,

(4)

yi

i=1

where n is the number of observation, yi and ŷi are the i -th observed and predicted values,
respectively. Also, the Mc and Mb represent the performance measure of compared and best
models, respectively.
Figure 2 presents the proposed forecasting framework.
4. Results
This section describes the results of the developed experiments in forecasting out-ofsample (test set). First, Section 4.1 compares the results of evaluated models over ten
datasets and three forecasting horizons adopted. In Tables A.1 and A.2 in Appendix A, the
best results regarding accuracy are presented in bold. Additionally, Figures 3 and 4 illustrate
the relation between observed and predicted values achieved by models with the best set of
performance measures depicted in Tables A.1 and A.2, as well as box-plots for out-of-sample
errors, are illustrated in Figure 5. Also, Figure 6 illustrates the variable importance of each
input (both lags and exogenous inputs) used in the models’ predictions.
4.1. Performance measures for compared models
In this section, the main results achieved by the best model regarding sMAPE and
RRMSE criteria are presented for short-term forecasting multi-days-ahead of cumulative
cases of COVID-19 from five Brazilian and five American states.
Firstly, considering the results for the Brazil context, the main results are highlighted as
follows.
• AM: In this state, VMD–BRNN could be considered to forecasting COVID-19 cases,
once the model outperformed all the single and VMD models in both performance criteria in all forecasting horizons. The improvement in the sMAPE achieved by VMD–
BRNN ranges between 39.47% - 96-06%, 55.97% - 94.88%, and 67.41% - 94.25%,
9

1

Climatic variables

2

General approaches
KNN

SVR

BRNN

QRF
CUBIST

3

VMD

Hybrid Model Flowchart
IMF1, IMF2 , IMF3, IMF4, and IMF5

Climatic
variables

Raw data of
Brazil / USA
states

BRNN

VMD-BRNN
VMD-CUBIST
VMD-KNN
VMD-QRF
VMD-SVR

IMF predictions

CUBIST
COVID-19
cases

IP

KNN
VMD

QRF

∑

RRMSE

SVR
Decomposition phase

sMAPE

Training and Integration phase

Performance Metrics

Figure 2: Proposed forecasting framework

for ODA, TDA, and SDA horizon respectively. Regarding RRMSE analysis, the improvement ranges between 9.86% - 94.81%, 33.44% - 93.29%, and 56.66% - 93.89%,
respectively.
• CE, RJ, and SP: For these states, in all forecasting horizons, the VMD–CUBIST
approach achieved better accuracy than other models, for both sMAPE and RRMSE
criteria in the multi-days-ahead forecasting task of the confirmed number of COVID-19.
In fact, the improvement in sMAPE is ranged in 8.67% - 96.57%, 12.15% - 97.78%, and
59.37% - 97.09%, respectively, in ODA, TDA, and SDA forecasting horizons. Moreover,
the improvement in RRMSE is ranged in 12.41% - 97.32%, 2.61% - 98.29%, and 49.99%
- 97.95%, respectively.
• PE: In this state, CUBIST and SVR present better performance to forecasting COVID19 cases. For ODA and TDA, CUBIST outperforms models, while for SDA the SVR
achieves better accuracy regarding sMAPE and RRMSE than others. The improvement in the sMAPE for ODA and TDA achieved by CUBIST ranges between 6.81% –
97.93%, and 24.94% – 98.23%, respectively. For SDA, SVR outperforms other models,
and this criterion is reduced in the range of 49.36% - 98.27%. Moreover, the same
behavior is observed when the improvement in the RRMSE criterion is obtained.
10

Remark: In this experiment, regarding the Brazilian states, 150 scenarios (5 datasets,
3 forecasting horizons, and 10 models) were evaluated for the task of forecasting cumulative
COVID-19 cases. In an overview, the best models for each state, obtained sMAPE ranged
between 1.14% - 3.05%, 1.06% - 2.79%, and 1.05% - 3.03% for ODA, TDA, and SDA forecasting, respectively. In the Brazilian context, the ranking of the model in all scenarios
is VMD–CUBIST, VMD–BRNN, SVR, CUBIST, VMD–SVR, BRNN, VMD–QRF, QRF,
VMD–KNN, and KNN. From a broader perspective, the efficiency of the VMD models is
due to the capability of the approach to deal with non-linearity and non-stationarity of the
data. Moreover, the efficiency of the CUBIST is due mainly to its ensemble learning of rules,
in which the approach takes advantage of each rule based on the input set. On the other
hand, the difficulty of the KNN model to forecasting cumulative COVID-19 cases could be
attributed to the fact that this approach requires more observations to effectively learn the
data pattern, once the forecasting is obtained by an average of past similar values.
In the next, considering the results for the USA context, the main results are highlighted
as follows.
• CA: In CA state, BRNN outperformed other models, in all forecasting horizons, for
both sMAPE and RRMSE criteria. In this aspect, the improvement in sMAPE ranges
between 29.98% - 97.86%, 4.64% - 97.71%, and 48.56% - 97.99%, for ODA, TDA, and
SDA, respectively. Regarding RRMSE, the improvement ranges in 24.00% - 97.67%,
6.57% - 97.78%, and 48.62% - 98.11%, respectively.
• IL, MA, and NJ: For both performance criteria, CUBIST outperformed other models
in ODA, for IL and NJ states, and TDA, for IL. BRNN presented better accuracy than
other models, for MA state in ODA and TDA. Moreover, VMD–CUBIST outperformed
other models in SDA for these three states. In fact, the improvement in sMAPE is
ranged in 6.63% - 98.76%, 31.89% - 98.09%, and 3.76% - 97.98%, respectively, in
ODA, TDA, and SDA forecasting horizons. Moreover, regarding the RRMSE, the
improvement ranges between 7.54% - 98.48%, 0.83% - 98.25%, and 3.25% - 98.11%,
respectively.
• NY: For NY state, in both performance criteria, VMD–CUBIST presented better accuracy than other model in ODA forecasting, while SVR outperformed the other models
in TDA and SDA forecasting. Regarding sMAPE, the improvement ranges 17.86% 95.44%, 16.12% - 95.69%, and 42.39% - 92.71%, for ODA, SDA, and TDA, respectively.
For RRMSE, the improvement ranges 25.78% - 96.09%, 7.78% - 95.43%, and 43.76% 93.45%, respectively.
Remark: In this experiment, regarding the American states, 150 scenarios (5 datasets,
3 forecasting horizons, and 10 models) were evaluated for the task of forecasting cumulative
COVID-19 cases. In an overview, the best models for each state, obtained sMAPE ranged
between 0.54% - 1.90%, 0.55% - 1.59%, and 0.62% - 3.08% for ODA, TDA, and SDA forecasting, respectively. In the American context, the ranking of the models in all scenarios
is VMD–CUBIST, BRNN, CUBIST, SVR, VMD–BRNN, VMD–SVR, VMD–QRF, QRF,
11

KNN, and VMD–KNN. The same behavior presented in Brazilian cases is presented in the
American, which the VMD–CUBIST in overall had better average performance compared
to the other models.
According to the information depicted in Figures 3 and 4 it is possible to identify that the
behavior of the data is learned by the evaluated models, which can forecasting compatible
cases with the observed values. In most states, the good performance presented in the
training stage persists in the test phase. In Figures 3a, 3c, 4a, and 4e the models presented
some difficulties to capture the behavior of the data in the training stage, however in test
phase the models could perform accurately presenting low errors.
Furthermore, Figure 5 presents the box-plots of test set forecasting errors in the SDA
horizon for each model and each state. Due to the recursive strategy adopted, the SDA
horizon was chosen to the analysis, once the errors tend to grow as the forecast horizon
increases. The box diagram depicts the variation of absolute errors for each model, which
reflects the stability of each model. In this context, the dots out of boxes are considered
outliers errors.
Analyzing the box-plot, models with lower variation in the errors are indicated by the
boxes with a smaller size. Figure 5 corroborates the results presented in Tables A.1 and A.2.
Models with lower errors achieve better stability, which means that the most appropriate
model for each state can maintain a learning pattern, obtaining homogeneous forecasting
errors.
The variable importance is an overall quantification of the relationship between the predictor variables (inputs) and the predicted value. Finally, Figure 6 is presented the variable
importance of each input used to fit and train the models. As expected, the lag inputs
present high importance due to their high correlation to the output. However, it is important to notice that climate data indeed presented some influence in predicting COVID-19
cumulative cases, especially in the Brazilian context, that the variance of the Temperature
data reaches up to 50% of importance. In other words, the climatic exogenous inputs are in
some level relevant to the prediction of cumulative cases of COVID-19 in both Brazil’s and
USA’s context for the five evaluated states.
5. Conclusion and Future Research
In this paper, machine learning approaches named BRNN, CUBIST, KNN, QRF, and
SVR, as well as VMD approach, were employed in the task of forecasting one, three, and
six-days-ahead the COVID-19 cumulative confirmed cases in five Brazilian states and five
American states with a high daily incidence. The COVID-19 cumulative confirmed cases for
AM, CE, PE, RJ, and SP states, as well as CA, IL, MA, NJ, and NY were used. The IP,
sMAPE and RRMSE criteria were adopted to evaluate the performance of the compared
approaches. The stability of out-of-sample errors was evaluated through box-plots. Further,
the variable importance of the lag and climatic exogenous inputs were analyzed.
In respect of obtained results, it is possible to infer that CUBIST coupled with the
VMD model are suitable tools to forecast COVID-19 cases for most of the adopted states,
once that these approaches were able to learn the non-linearities inherent to the evaluated
12

6,000
4,000

Cumulative confirmed cases

Training

Test

0

Test

Observed
ODA.VMD.CUBIST
TDA.VMD.CUBIST
SDA.VMD.CUBIST

2,000

4,000
3,000
2,000
1,000

Training

0

Cumulative confirmed cases

Observed
ODA.VMD.BRNN
TDA.VMD.BRNN
SDA.VMD.BRNN

0

10

20

30

40

0

10

20

Day

40

(b) CE

Test

6,000
4,000

Training

Test

0

0

Training

Observed
ODA.VMD.CUBIST
TDA.VMD.CUBIST
SDA.VMD.CUBIST

2,000

2,000

4,000

Observed
ODA.CUBIST
TDA.CUBIST
SDA.SVR

Cumulative confirmed cases

8,000

6,000

(a) AM

Cumulative confirmed cases

30

Day

10

20

30

0

20

40

Day

Day

(c) PE

(d) RJ

10,000

15,000

20,000

Observed
ODA.VMD.CUBIST
TDA.VMD.CUBIST
SDA.VMD.CUBIST

5,000

Training

Test

0

Cumulative confirmed cases

25,000

0

0

20

40

60

Day

(e) SP
Figure 3: Prediction versus observed COVID-19 cases for Brazilian States

epidemiological time series. Also, BRNN and SVR models deserve attention for the development of this task as well. Therefore, the ranking of models in all scenarios for Brazilian
states is VMD–CUBIST, VMD–BRNN, SVR, CUBIST, VMD–SVR, BRNN, VMD–QRF,
13

50,000
40,000
30,000
20,000

Cumulative confirmed cases

Training

Test

0

Test

Observed
ODA.CUBIST
TDA.CUBIST
SDA.VMD.CUBIST

10,000

40,000
30,000
20,000
10,000

Training

0

Cumulative confirmed cases

Observed
ODA.BRNN
TDA.BRNN
SDA.BRNN

0

25

50

75

0

25

50

Day

75

100

Day

(b) IL

90,000
60,000

Cumulative confirmed cases

Test

Training

Test

0

Training

Observed
ODA.CUBIST
TDA.BRNN
SDA.VMD.CUBIST

30,000

20,000

40,000

Observed
ODA.BRNN
TDA.BRNN
SDA.VMD.CUBIST

0

Cumulative confirmed cases

120,000

(a) CA

0

25

50

75

0

20

40

Day

Day

(d) NJ

100,000

200,000

Observed
ODA.VDM.CUBIST
TDA.SVR
SDA.SVR

Training

Test

0

Cumulative confirmed cases

300,000

(c) MA

0

20

40

60

Day

(e) NY
Figure 4: Prediction versus observed COVID-19 cases for American States

QRF, VMD–KNN, and KNN, and for USA states is VMD–CUBIST, BRNN, CUBIST,
SVR, VMD–BRNN, VMD–SVR, VMD–QRF, QRF, KNN, and VMD–KNN. Also, looking
for COVID-19 forecasts six-days-ahead, hybrid models are more suitable tools than non14

AM

3,000

CE

PE

RJ

SP

3,000
4,000
2,000

3,000

3,000

9,000

2,000

6,000

1,000

1,000

3,000

0

0

0

2,000

CA
15,000

IL

MA

40,000

25,000

30,000

20,000

B
C RN
U N
B
IS
K T
N
N
Q
V
R
V MD S F
M − V
D B R
− R
V CU NN
M B
D
V − IST
M K
V D− NN
M S
R V
− R
Q
R
F

B
C RN
U N
B
IS
K T
N
N
Q
V
R
V MD S F
M − V
D B R
− R
V CU NN
M B
D
V − IST
M K
V D− NN
M S
R V
− R
Q
R
F

0

B
C RN
U N
B
IS
K T
N
N
Q
V
R
M
V D S F
M − V
D B R
− R
V CU NN
M B
D
V − IST
M K
V D− NN
M S
R V
− R
Q
R
F

0
B
C RN
U N
B
IS
K T
N
N
Q
V
R
V MD S F
M − V
D B R
− R
V CU NN
M B
D
V − IST
M K
V D− NN
M S
R V
− R
Q
R
F

NJ

NY

40,000
100,000
30,000

15,000
20,000

5,000

5,000

10,000

0

0

0

0

B
C RN
U N
B
IS
K T
N
N
Q
V
R
V MD S F
M − V
D B R
− R
V CU NN
M B
D
V − IST
M K
V D− NN
M S
R V
− R
Q
R
F

B
C RN
U N
B
IS
K T
N
N
Q
V
R
M
V D S F
M − V
D B R
− R
V CU NN
M B
D
V − IST
M K
V D− NN
M S
R V
− R
Q
R
F

20,000

B
C RN
U N
B
IS
K T
N
N
Q
V
R
V MD S F
M − V
D B R
− R
V CU NN
M B
D
V − IST
M K
V D− NN
M S
R V
− R
Q
R
F

10,000

10,000

50,000

0
B
C RN
U N
B
IS
K T
N
N
Q
V
R
V MD S F
M − V
D B R
− R
V CU NN
M B
D
V − IST
M K
V D− NN
M S
R V
− R
Q
R
F

10,000

B
C RN
U N
B
IS
K T
N
N
Q
V
R
V MD S F
M − V
D B R
− R
V CU NN
M B
D
V − IST
M K
V D− NN
M S
R V
− R
Q
R
F

Absolute error

1,000

B
C RN
U N
B
IS
K T
N
N
Q
V
R
V MD S F
M − V
D B R
− R
V CU NN
M B
D
V − IST
M K
V D− NN
M S
R V
− R
Q
R
F

2,000

1,000

Model
Country

Brazil

USA

Figure 5: Box-plot for absolute error according to model and state for COVID-19 forecasting for SDA
1.00

Variable Importance

0.75

Country
0.50

Brazil
USA

0.25

0.00
Lag1

Lag2

Precipitation

Maximum
Temperature

Minimum
Temperature

Variable

Figure 6: Variable importance for Brazil and USA

decomposed models. Further, it was observed that climatic variables, such as temperature
and precipitation indeed influence increasing the accuracy when predicting COVID-19 cases,
wherein some cases climate inputs reached up to 50% of importance in the forecasting model.
For future works, it is intended to adopt (i) deep learning approaches, (ii) different

15

decomposition approaches, (iii) multi-objective optimization to tune hyperparameters of
forecasting models, and (iv) more climatic data and demographic features.
CRediT Author Statement
Ramon Gomes da Silva: Conceptualization, Methodology, Formal analysis, Validation, Writing - Original Draft, Writing - Review & Editing. Matheus Henrique Dal
Molin Ribeiro: Conceptualization, Methodology, Formal analysis, Validation, Writing Original Draft, Writing - Review & Editing. Viviana Cocco Mariani: Conceptualization,
Writing - Review & Editing. Leandro dos Santos Coelho: Conceptualization, Writing Review & Editing.
Declaration of Competing Interest
The authors declare that they have no known competing financial interests or personal
relationships that could have appeared to influence the work reported in this paper.
Acknowledgments
The authors would like to thank the National Council of Scientific and Technologic
Development of Brazil – CNPq (Grants number: 307958/2019-1-PQ, 307966/2019-4-PQ,
404659/2016-0-Univ, 405101/2016-3-Univ), PRONEX ‘Fundação Araucária’ 042/2018, and
Coordenação de Aperfeiçoamento de Pessoal de Nı́vel Superior - Brasil (CAPES) - Finance
Code 001 for financial support of this work. Furthermore, the authors wish to thank the Editor and anonymous reviewers for their constructive comments and recommendations, which
have significantly improved the presentation of this paper.
References
[1] World Health Organization (WHO), . Coronavirus (COVID-19). 2020. URL: https:
//www.who.int/health-topics/coronavirus#tab=tab_1; (accessed in 14 May, 2020).
[2] Bansal, M.. Cardiovascular disease and COVID-19. Diabetes & Metabolic Syndrome:
Clinical Research & Reviews 2020;14(3):247–250. doi:10.1016/j.dsx.2020.03.013.
[3] Lai, C.C., Shih, T.P., Ko, W.C., Tang, H.J., Hsueh, P.R.. Severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2) and coronavirus disease-2019 (COVID19): The epidemic and the challenges. International Journal of Antimicrobial Agents
2020;55(3):105924. doi:10.1016/j.ijantimicag.2020.105924.
[4] Hussain, A., Bhowmik, B., do Vale Moreira, N.C.. COVID-19 and diabetes:
Knowledge in progress. Diabetes Research and Clinical Practice 2020;162:108142.
doi:10.1016/j.diabres.2020.108142.

16

[5] Moujaess, E., Kourie, H.R., Ghosn, M.. Cancer patients and research during COVID19 pandemic: A systematic review of current evidence. Critical Reviews in Oncology/Hematology 2020;150:102972. doi:10.1016/j.critrevonc.2020.102972.
[6] Abbas, A.M., Fathy, S.K., Fawzy, A.T., Salem, A.S., Shawky, M.S.. The mutual
effects of COVID-19 and obesity. Obesity Medicine 2020;19:100250. doi:10.1016/j.
obmed.2020.100250.
[7] Su, H., Yang, M., Wan, C., Yi, L.X., Tang, F., Zhu, H.Y., et al. Renal histopathological analysis of 26 postmortem findings of patients with COVID-19 in China. Kidney
International 2020;doi:10.1016/j.kint.2020.04.003.
[8] Guan, W.j., Ni, Z.y., Hu, Y., Liang, W.h., Ou, C.q., He, J.x., et al. Clinical
characteristics of coronavirus disease 2019 in China. New England Journal of Medicine
2020;382(18):1708–1720. doi:10.1056/NEJMoa2002032.
[9] Requia, W.J., Kondo, E.K., Adams, M.D., Gold, D.R., Struchiner, C.J.. Risk of
the Brazilian health care system over 5572 municipalities to exceed health care capacity
due to the 2019 novel coronavirus (COVID-19). Science of The Total Environment
2020;730:139144. doi:10.1016/j.scitotenv.2020.139144.
[10] Ndaı̈rou, F., Area, I., Nieto, J.J., Torres, D.F.. Mathematical modeling of COVID19 transmission dynamics with a case study of Wuhan. Chaos, Solitons & Fractals
2020;135:109846. doi:10.1016/j.chaos.2020.109846.
[11] Barmparis, G., Tsironis, G.. Estimating the infection horizon of COVID-19 in eight
countries with a data-driven approach. Chaos, Solitons & Fractals 2020;135:109842.
doi:10.1016/j.chaos.2020.109842.
[12] Zhang, X., Ma, R., Wang, L.. Predicting turning point, duration and attack
rate of COVID-19 outbreaks in major Western countries. Chaos, Solitons & Fractals
2020;135:109829. doi:10.1016/j.chaos.2020.109829.
[13] Ceylan, Z.. Estimation of COVID-19 prevalence in Italy, Spain, and France. Science
of The Total Environment 2020;729:138817. doi:10.1016/j.scitotenv.2020.138817.
[14] Ahmar, A.S., del Val, E.B.. SutteARIMA: Short-term forecasting method, a
case COVID-19 and stock market in Spain. Science of The Total Environment
2020;729:138883. doi:10.1016/j.scitotenv.2020.138883.
[15] Ribeiro, M.H.D.M., da Silva, R.G., Mariani, V.C., Coelho, L.S.. Short-term forecasting COVID-19 cumulative confirmed cases: Perspectives for Brazil. Chaos, Solitons
& Fractals 2020;135:109853. doi:10.1016/j.chaos.2020.109853.
[16] Chimmula, V.K.R., Zhang, L.. Time series forecasting of COVID-19 transmission in
Canada using LSTM networks. Chaos, Solitons & Fractals 2020;135:109864. doi:10.
1016/j.chaos.2020.109864.
17

[17] Chakraborty, T., Ghosh, I.. Real-time forecasts and risk assessment of novel
coronavirus (COVID-19) cases: A data-driven analysis. Chaos, Solitons & Fractals
2020;135:109850. doi:10.1016/j.chaos.2020.109850.
[18] Singh, S., Parmar, K.S., Kumar, J., Makkhan, S.J.S.. Development of new hybrid
model of discrete wavelet decomposition and autoregressive integrated moving average
(ARIMA) models in application to one month forecast the casualties cases of COVID-19.
Chaos, Solitons & Fractals 2020;135:109866. doi:10.1016/j.chaos.2020.109866.
[19] Ribeiro, M.H.D.M., da Silva, R.G., Fraccanabbia, N., Mariani, V.C., Coelho, L.d.S..
Forecasting epidemiological time series based on decomposition and optimization approaches. In: 14th Brazilian Computational Intelligence Meeting (CBIC). Belém, Brazil;
2019, p. 1–8.
[20] Dragomiretskiy, K., Zosso, D.. Variational mode decomposition. IEEE Transactions
on Signal Processing 2014;62(3):531–544.
[21] Moreno, S.R., da Silva, R.G., Mariani, V.C., Coelho, L.d.S.. Multi-step wind
speed forecasting based on hybrid multi-stage decomposition model and long shortterm memory neural network. Energy Conversion and Management 2020;213:112869.
doi:10.1016/j.enconman.2020.112869.
[22] Wu, Q., Lin, H.. Daily urban air quality index forecasting based on variational mode
decomposition, sample entropy and lstm neural network. Sustainable Cities and Society
2019;50:101657. doi:10.1016/j.scs.2019.101657.
[23] Li, J., Zhu, S., Wu, Q.. Monthly crude oil spot price forecasting using variational mode
decomposition. Energy Economics 2019;83:240–253. doi:10.1016/j.eneco.2019.07.
009.
[24] Prata, D.N., Rodrigues, W., Bermejo, P.H.. Temperature significantly changes
COVID-19 transmission in (sub)tropical cities of Brazil. Science of The Total Environment 2020;729:138862. doi:10.1016/j.scitotenv.2020.138862.
[25] Coccia, M.. Factors determining the diffusion of COVID-19 and suggested strategy
to prevent future accelerated viral infectivity similar to COVID. Science of The Total
Environment 2020;729:138474. doi:10.1016/j.scitotenv.2020.138474.
[26] Shi, P., Dong, Y., Yan, H., Zhao, C., Li, X., Liu, W., et al. Impact of temperature on
the dynamics of the COVID-19 outbreak in China. Science of The Total Environment
2020;728:138890. doi:10.1016/j.scitotenv.2020.138890.
[27] Wu, Y., Jing, W., Liu, J., Ma, Q., Yuan, J., Wang, Y., et al. Effects of temperature
and humidity on the daily new cases and new deaths of COVID-19 in 166 countries.
Science of The Total Environment 2020;729:139051. doi:10.1016/j.scitotenv.2020.
139051.
18

[28] Ahmadi, M., Sharifi, A., Dorosti, S., Jafarzadeh Ghoushchi, S., Ghanbari, N..
Investigation of effective climatology parameters on COVID-19 outbreak in Iran. Science
of The Total Environment 2020;729:138705. doi:10.1016/j.scitotenv.2020.138705.
[29] Sobral, M.F.F., Duarte, G.B., da Penha Sobral, A.I.G., Marinho, M.L.M.,
de Souza Melo, A.. Association between climate variables and global transmission
of SARS-CoV-2. Science of The Total Environment 2020;729:138997. doi:10.1016/j.
scitotenv.2020.138997.
[30] Auler, A., Cássaro, F., da Silva, V., Pires, L.. Evidence that high temperatures and
intermediate relative humidity might favor the spread of COVID-19 in tropical climate:
A case study for the most affected Brazilian cities. Science of The Total Environment
2020;729:139090. doi:10.1016/j.scitotenv.2020.139090.
[31] Bashir, M.F., Ma, B., Bilal, , Komal, B., Bashir, M.A., Tan, D., et al. Correlation
between climate indicators and COVID-19 pandemic in New York, USA. Science of
The Total Environment 2020;728:138835. doi:10.1016/j.scitotenv.2020.138835.
[32] Ribeiro, M.H.D.M., Coelho, L.d.S.. Ensemble approach based on bagging, boosting and
stacking for short-term prediction in agribusiness time series. Applied Soft Computing
2020;86(105837). doi:10.1016/j.asoc.2019.105837.
[33] Ribeiro, V.H.A., Reynoso-Meza, G.. Multi-objective support vector machines ensemble generation for water quality monitoring. In: IEEE Congress on Evolutionary
Computation (CEC). Rio de Janeiro, Brazil: IEEE; 2018, p. 1–6.
[34] Fernández-Delgado, M., Sirsat, M., Cernadas, E., Alawadi, S., Barro, S., FebreroBande, M.. An extensive experimental survey of regression methods. Neural Networks
2019;111:11–34. doi:10.1016/j.neunet.2018.12.010.
[35] Zuo, G., Luo, J., Wang, N., Lian, Y., He, X.. Decomposition ensemble model based on
variational mode decomposition and long short-term memory for streamflow forecasting.
Journal of Hydrology 2020;585:124776. doi:10.1016/j.jhydrol.2020.124776.
[36] Zhu, Q., Zhang, F., Liu, S., Wu, Y., Wang, L.. A hybrid VMD–BiGRU model
for rubber futures time series forecasting. Applied Soft Computing 2019;84:105739.
doi:10.1016/j.asoc.2019.105739.
[37] Justen, A.. COVID-19: Coronavirus newsletters and cases by municipality per day.
2020. URL: https://brasil.io/api/dataset/covid19/caso/data/?place_type=
state; (accessed in 28 April, 2020).
[38] Center for Systems Science and Engineering (CSSE), . Novel coronavirus (COVID-19)
cases, provided by JHU CSSE. 2020. URL: https://github.com/CSSEGISandData/
COVID-19; (accessed in 28 April, 2020).

19

[39] Brazil, . Instituto Nacional de Meteorologia (INMET), Ministério da Agricultura,
Pecuária e Abastecimento. 2020. URL: http://www.inmet.gov.br/portal/index.
php?r=estacoes/estacoesAutomaticas; (accessed in 28 April, 2020), (in Portuguese).
[40] U.S., . National Oceanic and Atmospheric Administration (NOAA): National Centers
for Environmental Information. 2020. URL: https://www.ncdc.noaa.gov/; (accessed
in 28 April, 2020).
[41] Chamberlain, S.. rnoaa: ‘NOAA’ weather data from R. 2020. URL: https://CRAN.
R-project.org/package=rnoaa; R package version 0.9.6.
[42] MacKay, D.J.C.. Bayesian interpolation. Neural Computation 1992;4(3):415–447.
doi:10.1162/neco.1992.4.3.415.
[43] Nguyen, D., Widrow, B.. Improving the learning speed of 2-layer neural networks by
choosing initial values of the adaptive weights. In: IJCNN International Joint Conference on Neural Networks; vol. 3. San Diego, USA; 1990, p. 21–26.
[44] Quinlan, J.R.. Learning with continuous classes. In: 5th Australian Joint Conference
on Artificial Intelligence; vol. 92. Hobart, Tasmania: World Scientific; 1992, p. 343–348.
[45] Aha, D.W., Kibler, D., Albert, M.K.. Instance-based learning algorithms. Machine
Learning 1991;6(1):37–66. doi:10.1007/BF00153759.
[46] Breiman, L.. Random forests. Machine Learning 2001;45(1):5–32. doi:10.1023/A:
1010933404324.
[47] Meinshausen, N.. Quantile regression forests. Journal of Machine Learning Research
2006;7:983–999.
[48] Vaysse, K., Lagacherie, P.. Using quantile regression forest to estimate uncertainty of
digital soil mapping products. Geoderma 2017;291:55–64. doi:10.1016/j.geoderma.
2016.12.017.
[49] Drucker, H., Burges, C.J.C., Kaufman, L., Smola, A.J., Vapnik, V.. Support vector
regression machines. In: Mozer, M.C., Jordan, M.I., Petsche, T., editors. Advances
in Neural Information Processing Systems 9. MIT Press; 1997, p. 155–161.
[50] R Core Team, . R: A language and environment for statistical computing. R Foundation
for Statistical Computing; Vienna, Austria; 2018.

20

Appendix A. Performance Measures
Tables A.1 and A.2 present the performance measures for each model in each state and
forecasting horizon.
Table A.1: Performance measures for each evaluated model for Brazilian states
Country

State

Forecasting
Horizon
ODA

AM

TDA
SDA
ODA

CE

TDA
SDA
ODA

BRA

PE

TDA
SDA
ODA

RJ

TDA
SDA
ODA

SP

TDA
SDA

Criteria
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE

BRNN CUBIST
KNN
QRF
SVR
11.59%
5.34%
50.92% 45.99% 5.40%
12.96%
5.88%
73.92% 65.17% 5.59%
14.54%
8.86%
52.37% 45.99% 7.65%
17.00% 11.05%
77.14% 65.17% 9.20%
19.62% 19.15%
63.80% 45.99% 14.48%
24.11% 23.31% 102.85% 65.17% 16.62%
7.97%
2.70%
53.33% 45.42% 5.49%
9.48%
3.89%
78.05% 64.86% 5.52%
13.17%
4.24%
55.23% 45.42% 8.46%
16.46%
4.26%
82.59% 64.86% 8.85%
16.69%
5.91%
56.75% 45.42% 14.36%
21.78%
6.62%
86.22% 64.86% 16.85%
10.43% 1.14%
54.97% 45.27% 1.22%
13.54% 1.36%
83.80% 66.03% 1.86%
12.21% 1.06%
60.19% 45.27% 1.42%
16.57% 1.39%
94.20% 66.03% 2.33%
15.32%
2.08%
61.09% 45.27% 1.05%
21.34%
2.53%
96.22% 66.03% 1.81%
4.87%
3.65%
34.70% 28.70% 3.54%
5.82%
4.37%
46.38% 38.06% 4.62%
6.68%
5.62%
34.95% 28.70% 5.34%
9.23%
7.00%
46.81% 38.06% 6.72%
9.38%
8.95%
34.95% 28.70% 7.57%
12.73% 11.40%
46.81% 38.06% 9.83%
4.70%
3.58%
29.85% 26.12% 2.81%
6.81%
4.82%
39.71% 34.83% 4.22%
6.44%
4.56%
29.85% 26.12% 3.17%
9.62%
6.45%
39.71% 34.83% 4.74%
10.67% 11.29%
32.05% 26.12% 5.95%
14.65% 14.92%
43.16% 34.83% 8.19%

21

Model
VMD–BRNN VMD–CUBIST
2.00%
3.31%
3.83%
4.25%
2.68%
6.09%
5.18%
7.77%
3.67%
11.26%
6.29%
14.50%
2.55%
1.83%
3.52%
2.09%
3.46%
1.23%
5.35%
1.41%
5.08%
1.82%
7.71%
2.08%
2.54%
2.09%
3.32%
2.39%
3.30%
1.78%
4.37%
2.11%
3.28%
2.16%
4.15%
3.08%
3.61%
3.05%
5.32%
3.60%
5.58%
2.73%
9.02%
3.30%
7.67%
3.02%
12.35%
3.95%
3.73%
2.57%
5.85%
4.22%
6.14%
2.79%
10.04%
4.62%
8.71%
2.42%
13.68%
4.10%

VMD–KNN
38.17%
50.10%
51.73%
75.87%
63.53%
102.53%
40.75%
56.19%
52.98%
79.73%
62.54%
101.64%
37.56%
51.61%
44.05%
62.59%
48.27%
71.19%
16.88%
21.62%
18.69%
23.93%
21.92%
28.99%
32.58%
43.82%
37.21%
52.39%
40.67%
58.44%

VMD–QRF
20.32%
23.55%
24.93%
30.25%
38.35%
52.68%
17.82%
20.56%
22.64%
26.70%
35.71%
49.40%
26.69%
32.54%
30.83%
40.21%
39.07%
55.22%
15.87%
19.64%
20.51%
25.51%
28.10%
37.48%
20.39%
27.35%
21.95%
29.47%
23.02%
31.18%

VMD–SVR
4.30%
5.11%
9.58%
11.99%
18.68%
24.83%
3.26%
3.85%
8.03%
9.57%
16.20%
22.04%
1.96%
2.65%
6.11%
7.94%
12.76%
17.24%
3.80%
5.24%
7.67%
9.88%
14.24%
19.27%
3.91%
5.06%
6.65%
8.73%
11.82%
15.78%

Table A.2: Performance measures for each evaluated model for American states
Country

State

Forecasting
Horizon
ODA

CA

TDA
SDA
ODA

IL

TDA
SDA
ODA

USA

MA

TDA
SDA
ODA

NJ

TDA
SDA
ODA

NY

TDA
SDA

Criteria
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE
sMAPE
RRMSE

BRNN
0.56%
0.73%
0.66%
0.78%
0.62%
0.72%
1.07%
1.24%
1.84%
2.39%
2.89%
3.78%
1.90%
2.42%
1.59%
2.39%
4.38%
5.33%
0.97%
1.01%
0.55%
0.62%
1.02%
1.27%
3.26%
3.63%
5.40%
6.43%
7.64%
9.37%

CUBIST
0.90%
0.96%
1.10%
1.22%
1.87%
2.18%
0.54%
0.92%
1.05%
1.51%
2.58%
3.00%
2.45%
3.46%
3.41%
5.34%
8.98%
10.98%
0.88%
0.93%
1.25%
1.48%
1.99%
2.40%
1.26%
1.43%
2.20%
2.69%
4.54%
5.30%

KNN
26.37%
31.31%
28.87%
35.11%
30.85%
38.04%
34.26%
44.21%
36.63%
47.86%
52.64%
78.46%
30.79%
39.30%
31.52%
40.65%
32.54%
42.30%
21.41%
24.93%
22.03%
25.81%
23.76%
28.32%
16.81%
19.88%
18.23%
22.36%
21.02%
26.69%

QRF
19.05%
22.12%
19.05%
22.12%
19.05%
22.12%
25.04%
31.31%
25.04%
31.31%
25.04%
31.31%
28.07%
35.70%
28.07%
35.70%
28.07%
35.70%
17.87%
20.38%
18.20%
20.82%
18.20%
20.82%
12.09%
13.64%
12.09%
13.64%
12.09%
13.64%

SVR
1.80%
1.96%
2.40%
2.97%
2.41%
3.01%
3.05%
3.13%
4.73%
5.18%
8.10%
9.53%
3.01%
3.59%
3.35%
4.58%
6.92%
8.18%
0.94%
1.03%
1.09%
1.17%
0.94%
1.14%
1.02%
1.23%
0.92%
1.27%
1.75%
2.05%

22

Model
VMD–BRNN VMD–CUBIST
2.19%
0.80%
2.63%
1.07%
4.66%
0.69%
6.08%
0.84%
8.20%
1.21%
10.86%
1.40%
3.16%
1.83%
4.43%
2.63%
6.33%
1.55%
8.95%
2.07%
11.03%
1.42%
15.66%
2.04%
4.51%
2.65%
5.39%
2.69%
8.25%
2.34%
10.86%
2.41%
14.65%
3.08%
20.17%
3.16%
1.63%
0.99%
2.18%
1.32%
3.52%
0.83%
4.74%
1.21%
6.54%
0.91%
8.95%
1.23%
1.46%
0.84%
1.64%
0.92%
2.76%
1.10%
3.31%
1.38%
5.23%
3.05%
6.65%
3.65%

VMD–KNN
24.23%
28.42%
25.63%
30.44%
26.23%
31.31%
43.71%
60.63%
49.22%
70.55%
67.54%
107.77%
26.67%
33.79%
31.47%
40.87%
35.52%
47.50%
25.40%
30.87%
28.62%
35.63%
35.12%
45.47%
18.44%
23.44%
21.34%
27.91%
24.06%
31.38%

VMD–QRF
11.44%
12.87%
13.07%
14.62%
15.89%
18.44%
17.74%
21.50%
19.41%
23.08%
23.61%
29.59%
17.49%
21.69%
19.83%
24.21%
22.66%
28.56%
9.88%
10.99%
11.17%
12.36%
13.20%
15.09%
5.51%
6.30%
6.39%
7.28%
7.96%
9.32%

VMD–SVR
3.60%
3.76%
6.11%
6.74%
10.75%
12.38%
3.80%
4.49%
6.98%
8.53%
12.43%
16.27%
3.91%
4.77%
7.12%
8.82%
13.85%
18.13%
3.78%
3.92%
6.75%
7.47%
12.35%
14.70%
3.27%
3.38%
5.85%
6.62%
10.97%
12.93%

Appendix B. Hyperparameters
Tables B.1 and B.2 present the hyperparameters obtained by grid-search for the models
employed in this paper.
Table B.1: Hyperparameters selected by grid-search for each evaluated model for Brazilian states
Country

State

AM

CE

BRA

PE

RJ

SP

Component
IMF1
IMF2
IMF3
IMF4
IMF5
Non-decomposed
IMF1
IMF2
IMF3
IMF4
IMF5
Non-decomposed
IMF1
IMF2
IMF3
IMF4
IMF5
Non-decomposed
IMF1
IMF2
IMF3
IMF4
IMF5
Non-decomposed
IMF1
IMF2
IMF3
IMF4
IMF5
Non-decomposed

BRNN

CUBIST

KNN

# of Neurons

# of Committees

# of Instances

# of Neighbors

4
5
3
5
4
3
3
5
5
5
5
1
2
5
1
5
5
5
3
1
4
5
5
1
2
5
5
5
1
1

1
20
20
10
1
1
1
20
10
10
10
1
10
20
20
1
10
10
10
1
20
1
1
20
10
1
10
20
10
10

0
5
0
0
5
5
5
5
9
9
0
9
0
5
5
9
9
0
0
0
5
5
5
5
0
9
5
0
5
0

9
5
5
7
5
5
13
5
13
5
5
5
13
5
13
5
11
5
5
5
5
5
5
5
11
5
13
5
5
5

23

QRF
# of Randomly
Selected Predictors
5
5
5
5
5
4
2
5
5
5
5
4
3
3
3
3
5
4
5
4
5
5
5
4
4
4
4
5
5
5

SVR
Cost
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1

Table B.2: Hyperparameters selected by grid-search for each evaluated model for American states
Country

State

CA

IL

USA

MA

NJ

NY

Component
IMF1
IMF2
IMF3
IMF4
IMF5
Non-decomposed
IMF1
IMF2
IMF3
IMF4
IMF5
Non-decomposed
IMF1
IMF2
IMF3
IMF4
IMF5
Non-decomposed
IMF1
IMF2
IMF3
IMF4
IMF5
Non-decomposed
IMF1
IMF2
IMF3
IMF4
IMF5
Non-decomposed

BRNN

CUBIST

KNN

# of Neurons

# of Committees

# of Instances

# of Neighbors

1
1
4
5
5
1
5
1
5
5
5
1
3
1
4
4
5
1
1
5
5
4
5
1
1
5
5
3
5
5

1
1
1
20
1
20
20
20
20
20
10
20
1
20
20
20
1
20
10
20
10
10
1
20
1
20
1
10
1
20

9
0
9
0
5
5
5
5
5
9
0
5
5
5
5
5
0
5
0
5
9
9
0
5
0
5
0
5
5
0

5
5
11
9
5
5
5
5
5
5
5
5
5
5
5
13
5
5
5
5
5
13
5
5
13
5
5
9
5
5

24

QRF
# of Randomly
Selected Predictors
4
4
3
5
5
4
5
4
3
5
5
4
5
4
4
5
5
5
5
4
4
5
5
5
5
5
5
5
5
4

SVR
Cost
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1

