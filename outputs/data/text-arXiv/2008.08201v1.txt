1

Estimating the Effective Reproduction Number
and Variables of Disease Models for the
COVID-19 Epidemic
arXiv:2008.08201v1 [math.OC] 19 Aug 2020

Mauricio C. de Oliveira
August 20, 2020

Abstract—This paper deals with the problem of estimating variables in nonlinear models for the spread of
disease and its application to the COVID-19 epidemic.
First unconstrained methods are revisited and they are
shown to correspond to the application of a linear filter
followed by a nonlinear estimate of the effective reproduction number after a change-of-coordinates. Unconstrained
methods often fail to keep the estimated variables within
their physical range and can lead to unreliable estimates
that require aggressively smoothing the raw data. In order
to overcome these shortcomings a constrained estimation
method is proposed that keeps the model variables within
pre-specified boundaries and can also promote smoothness
of the estimates. Constrained estimation can be directly
applied to raw data without the need of pre-smoothing and
the associated loss of information and additional lag. It can
also be easily extended to handle additional information,
such as the number of infected individuals. The resulting
problem is cast as a convex quadratic optimization problem
with linear and convex quadratic constraints. It is also
shown that both unconstrained and constrained methods
when applied to death data are independent of the fatality
rate. The methods are applied to public death data from
the COVID-19 epidemic.

I. I NTRODUCTION
Several authors have attempted to estimate variables
and parameters that can shed light into the progression
of the COVID-19 epidemic [1], [2], [3], [4]. The majority
of these works utilize classical compartmental epidemic
models [5], upon which many predictions and recommendation regarding COVID-19 are being built upon [6].
Such models have also been used to study the epidemic’s
behavior in the presence of feedback [7], [8], [9].
Compartmental models are nonlinear low-order
continuous-time ordinary differential equations that are
suitable to analysis at population levels. One of their
main features is the relative low complexity and limited number of parameters which are of easy interpretation [5]. Among the existing works that attempt to
estimate such parameters from the available data, for
instance [1], [2], [3], [4], none seem to take advantage
University of California San Diego, Dept of Mechanical and
Aerospace Enigineering, La Jolla, CA, USA. mauricio@ucsd.edu

of the inherent properties of the model’s variables in the
process of estimation. This means that, in the inevitable
presence of noise, the estimated variables and parameters
will often not be compatible with the underlying model
and lead to inconsistent estimates. To mitigate such
difficulties, virtually all works seem to resort to heavy
pre-filtering of the data. Smoothing filters unavoidably
lead to information loss as well as delays in the estimates.
The main contribution of the present paper is to
introduce a framework in which the model variables and
parameters can remain constrained during the process of
estimation. One advantage is that all data can be used
for estimation without the need of a smoothing pre-filter,
therefore without incurring the associated data loss and
lag. Susceptible-Infected-Resolving-Deceased-reCovered
(SIRDC) models such as the on in [2] are the basic
dynamic models used in the present paper. A number
of steps is involved.
First, in Section II, the number of equations in the
model is reduced from five to three. Then a change of
coordinates is introduced with the purpose of isolating all
nonlinearities to a single equation and rewrite the model
in terms of the Effective Reproduction Number (R) [10].
Parametrizing the model in terms of R will be key in
rendering certain model constraints linear.
Based on this reformulated model, in Section III, the
unconstrained method of [2] is shown to be equivalent
to the application of a linear filter followed by the calculation of a nonlinear estimate for R. This reformulation
brings to light certain properties of the method including
the invariance of the estimate of R on the fatality rate.
In Section IV, the problem of estimating the variables
and the parameter R of an SRIDC model is reformulated
as a quadratic optimization problem involving an auxiliary linear dynamic system. It is this reformulation that
enables the incorporation of explicit constraints on the
model’s variables and the effective reproduction number,
R, and its derivative, Ṙ. All such constraints are shown
to be linear in the variables of this auxiliary dynamic
system. The resulting optimization problem is a convex
quadratic program with linear constraints that can be

2

solved efficiently using off-the-shelf algorithms [11].
Besides enforcing constraints, the proposed method also
allows one to trade-off accuracy versus smoothness of
the estimates, all without requiring any pre-filtering or
smoothing of the data. As with the unconstrained approach, the constrained estimate of R is also shown
to be independent of the fatality rate. But unlike the
unconstrained method, it can be naturally extended to
cover the availability of measurements of other variables,
such as the number of infected individuals.
The paper is closed in Section V with brief conclusion
and the application of the constrained estimation method
to publicly available data of the COVID-19 epidemic
from several countries [12].
II. T HE SIRDC MODEL FOR S PREAD OF D ISEASE
The model used in the present papes is the following Susceptible-Infected-Resolving-Deceased-reCovered
(SIRDC) model [2]. Consider the following variables:
• x1 : the population Susceptible (S) to a disease;
• x2 : the population Infected (I) by a disease;
• x3 : the population Resolving (R) from the disease.
• x4 : the population that Died (D) from the disease.
• x5 : the population reCovered (C) from the disease.
In the present paper all variables above are taken as
fractions of a total constant population. The complete
SIRDC model is the following system of nonlinear
ordinary differential equations:

to potential variations due to local conditions [14], [15],
[16]. As it will be seen later, the methods proposed in
the present paper, as far as the estimation of R from
death records is concerned, are independent of the exact
knowledge of δ, which will affect the model’s variables
but not R. The values of γ and θ above were the ones
used in [2].
A. Reduced order model
Note that not all equations in the SDIRC model (1)–(5)
are independent. For instance
ẋ1 + ẋ2 + ẋ3 + ẋ4 + ẋ5 = 0
which imply
x1 (t) + x2 (t) + x3 (t) + x4 (t) + x5 (t) =
x1 (0) + x2 (0) + x3 (0) + x4 (0) + x5 (0) = 1
which reflects the assumption that the total population is
constant. Also
ẋ1 + ẋ2 + ẋ3 + δ −1 ẋ4 = 0
which implies
x1 (t) + x2 (t) + x3 (t) + δ −1 x4 (t) = c,
where c is a constant. The value of this constant can be
determined as follows. Integrate (4)–(5) to obtain
Z t
x4 (t) = x4 (0) + δ
θx3 (τ ) dτ,
0
Z t
x5 (t) = x5 (0) + (1 − δ)
θx3 (τ ) dτ

ẋ1 = −β x1 x2

(1)

ẋ2 = β x1 x2 − γ x2

(2)

ẋ3 = γ x2 − θx3 ,

(3)

ẋ4 = δθx3

(4)

(1 − δ) (x4 (t) − x4 (0)) = δ (x5 (t) − x5 (0)).

ẋ5 = (1 − δ)θx3

(5)

For instance, if one assumes that x4 (0) = x5 (0) = 0, as
in the beginning of the disease, then

The main goal of this paper is to estimate all variables
in the above model along with the time-varying parameter β. As it will be seen soon, it is more convenient to
work with the effective reproduction number R [10]
R=

βx1
> 0.
γ

(6)

The remaining parameters are characteristic of the disease and here are assumed to be constant and known:
• γ: corresponds to the inverse ammount of time a
person is infectious, here 5 days that is γ ≈ 0.2.
• θ: corresponds to the inverse ammount of time a
case resolves, here 10 days that is θ ≈ 0.1.
• δ: the fatality rate, assumed to be 0.65% [13].
Whereas the values of γ and θ are relatively well studied
and can be safely assumed to be known, the fatality rate
δ carries a large degree of uncertainty, with a variety
of studies producing conflicting numbers and alluding

0

from which it follows that

δ −1 x4 (t) = x4 (t) + x5 (t)
which implies that c = 1.
The above relationships means that the SIRDC model
can be reduced to its first three equations
ẋ1 = −β x1 x2 ,

(7)

ẋ2 = β x1 x2 − γ x2 ,

(8)

ẋ3 = γ x2 − θ x3 ,

(9)

since the remaining variables
x4 = δ [1 − (x1 + x2 + x3 )] ,
x5 = (1 − δ) [1 − (x1 + x2 + x3 )] ,
can be obtained from the reduced order model variables.
The measurement
y = x4 = δ [1 − (x1 + x2 + x3 )]

(10)

3

can also be obtained from the first three variables.
The following basic properties of the variables in the
SIRDC model will be explicitly used later. Because β >
0, it follows that
xi ∈ [0, 1],

i = 1, 2, 3,

ẋ1 ≤ 0

(11)

so that x1 is monotonically decreasing. Indeed a distinctive aspect of the approach in the present paper is
that such constraints will be enforced throughout the
estimation process.

will be used. The main goal is to estimate the timevarying parameter R(k) and the variables x1 (k) through
x3 (k) from the measurement y(k) satisfying the constraints
zi (k) ∈ [0, 1],

i = 1, 2, 3,

z1 (k) ≤ z2 (k) ≤ z3 (k),

z1 (k + 1) ≤ z1 (k), (21)

which are the discrete-time counterparts to (16).
III. U NCONSTRAINED E STIMATION

B. Change of coordinates
The reduced model (7)–(10) is still nonlinear, with
the first and second equations containing products of the
model variables. The following change of coordinates
can confine the nonlinearities to a single equation, a
key fact that will be used afterwards, and express the
dynamics in terms of the effective reproduction number,
R, defined in (6). Consider the change of coordinates
  
   

z1
x1
x1
z1
z2   x1 + x2  x2  z2 − z1 
 =
   

z3  x1 + x2 + x3  , x3  = z3 − z2 
R
βz1 /γ
β
γR/z1

In the presence of the entire state evolution one could
estimate R(k) by solving equation (17), that is
R̂(k) =

(12)

ż2 = −γ (z2 − z1 ),

(13)

ż3 = −θ (z3 − z2 ),

(14)

and the measurement
y = δ [1 − z3 ] .

(15)

Note that the above change of coordinates is well defined
because for any initial condition in which x1 (0) > 0
then x1 (t) > 0 for all t ≤ 0. The properties (11) can be
translated in terms of the new variables as
zi ∈ [0, 1],

i = 1, 2, 3,

z1 ≤ z2 ≤ z3 , ż1 ≤ 0 (16)

where the ranking of the new variables come from the
fact that they are accumulated sums of non-negative
values.
C. Discrete-time model
For most of the remaining of this paper the following
first-order (Euler) approximation of the system (12)–(15)
z1 (k + 1) = z1 (k) − γR(k)(z2 (k) − z1 (k)),

(17)

z2 (k + 1) = z2 (k) − γ (z2 (k) − z1 (k)),

(18)

z3 (k + 1) = z3 (k) − θ (z3 (k) − z2 (k)),

(19)

and the measurement
y(k) = δ − δ z3 (k),

(20)

(22)

In fact, assuming that the measurement y(k) is free of
noise, it is possible to recursively rewrite z1 (k), z2 (k)
and z3 (k) in terms of y(k) and apply (22). This process
is equivalent to the method proposed in [2], leading to
the exact same results.
As a first contribution of the present paper, it is shown
in the Appendix, that this recursion amounts to applying
the following linear filter with state space realization

and apply it to (7)–(10) to obtain the equivalent model
ż1 = −γR (z2 − z1 ),

z1 (k) − z1 (k + 1)
.
γ(z2 (k) − z1 (k))

x̂(k + 1) = A x̂(k) + B û(k)

(23)

ẑ(k) = C x̂(k) + D û(k)

(24)

in which


 
 −1 −1 
0 0
1
γ θ
A=
, B=
, D=
,
(25)
1 0
0
0
 −1

θ +γ −1 −2 θ−1 γ −1 (1−θ−1 )(1−γ −1 )
C=
,
θ−1
(1 − θ−1 )
(26)
to the input
û(k) = 1 − δ −1 y(k),

(27)

so as to produce the vector of estimates


ẑ1 (k)
ẑ(k) =
ẑ2 (k)
from which R̂ can be calculated as in (22) after substituting z1 and z2 by the estimates ẑ1 and ẑ2 . The filter’s
initial condition should be initialized as in
x̂(0) = C −1 (ẑ(0) − Dû(0)) ,

 

ẑ1 (0)
x̂1 (0)
ẑ(0) =
=
ẑ2 (0)
x̂1 (0) + x̂2 (0)

(28)

where x̂1 (0) and x̂2 (0) are estimates of the initial susceptible and infected populations.
One problem with the above approach is that, in
the presence of noise, there are no guarantees that the
estimated variables ẑ1 (k) and ẑ2 (k) satisfy the structural

4

ACCUMULATED DEATHS
160
140

0.9

80

40

60

%

20
20

40

60

80

100

120

140

160

NEW DAILY DEATHS
new deaths
MA-7
MA-30

2.5
2.0

20

40

60

0

20

40

60

120

140

160

80

100

120

140

160

80 100
DAYS

120

140

160

Fig. 2. Estimates x̂1 = ẑ1 and x̂2 = ẑ2 − ẑ1 produced by the
filter (22)–(28) for United States data from Fig. 1 for raw and centered
moving averages with periods 7 and 30 days. Note how x̂1 = ẑ1 is
not monotically decreasing, and x̂2 = ẑ2 − ẑ1 and ẑ1 (k) − ẑ1 (k + 1)
often become negative, even after smoothing.

1.5

R̂

1.0

4.0

0.5

2.0

0.0

100

x̂2 = ẑ2 − ẑ1

0.5
0.0

0

80

ẑ1(k) − ẑ1(k + 1)

0

40

THOUSANDS

20

0.0

60

0

0

0.2

100

%

THOUSANDS

120

raw
MA-7
MA-30

x̂1 = ẑ1

1.0

deaths
MA-7
MA-30

0

20

40

60

80 100
DAYS

120

140

160

Fig. 1. Accumulated and new daily deaths attributed to COVID–19
in the United States from 01/22/2020 through 08/16/2020 [12]. Day 0
corresponds to the first day in this range in which a non-zero number
of deaths was reported. Also shown is the result of the centered moving
average with periods of 7 and 30 days. Note the large lags introduced
by smoothing.

constraints (21). Take for example the series of accumulated COVID-19 deaths in the United States shown
in Fig. 1 obtained from the COVID-19 Data Repository
by the Center for Systems Science and Engineering
(CSSE) at Johns Hopkins University [12]. The corresponding estimates ẑ1 and ẑ2 and the key differences
ẑ1 (k) − ẑ1 (k + 1) and ẑ2 (k) − ẑ1 (k) are shown in
Fig. 2. Note how these estimates do not satisfy (21).
What this means is that the resulting R̂ estimate (22)
will experience wild swings and even take negative or
very large values. In the example in Fig. 3, even the
highly smoothed 30-day moving average estimate swings
below 0 and above 5. The raw and 7-day moving average
estimates are basically useless.
While smoothing the input does improve the quality
of the estimates, it does so at the expense of unavoidable
loss of information as well as additional lags from
filtering. Indeed, the authors of [2] explicitly mention

0.0
-2.0
raw
MA-7
MA-30

-4.0
0

20

40

60

80 100
DAYS

120

140

160

Fig. 3. Unconstrained estimation of R produced by the filter (22)–
(28) corresponding to the United States deaths in Fig. 1 based on
raw and centered moving average with periods of 7 and 30 days. All
estimates display wide excursion range that take negative and large
positive values.

that the above procedure should be fed a smoothed out
version of the signal y(k). Related approaches, such
as [3], also seem to rely heavily on smoothing. These
difficulties are the main motivation for the alternative
constrained approach to be introduced in the next section.
This section is closed by presenting a property that is
not apparent in [2], given in the following proposition.
Proposition 1. For k ≥ 2 the estimate
R̂(k) =

ẑ1 (k) − ẑ1 (k + 1)
γ(ẑ2 (k) − ẑ1 (k))

(29)

in which ẑ1 and ẑ2 are the components of the output of

5

the time-invariant linear filter (23)–(26) driven by the
input (27) is independent of the value of fatality rate, δ.
Proof. Use linearity to write
ẑ(k) = z̄(k) − δ −1 z̃(k)
in which z̄ and z̃ are such that
x̄(k + 1) = A x̄(k) + B,
z̄(k) = C x̄(k) + D,

x̄(0) = x0 ,

and

As it will be seen shortly, this alternative approach has
several advantages. First, the resulting estimation problem is a convex problem that can be solved efficiently
even with large number of data points. Second, the basic
constraints (21) are all linear constraints that can be
easily incorporated to the problem without compromising
convexity. Third, it is possible to add constraints that will
control the range of R and its derivative, Ṙ, as well as
explicitly promote smoothness of the estimates.
In order to arrive at the desired problem formulation
first introduce the estimator
x̂(k + 1) = A x̂(k) + B û(k)

x̃(k + 1) = A x̃(k) + B y(k),
z̃(k) = C x̃(k) + D y(k),

x̃(0) = 0.

Then
R̂(k) =

z̄1 (k) − z̄1 (k + 1) − δ −1 (z̃1 (k) − z̃1 (k + 1))
.
γ (z̄2 (k) − z̄1 (k) − δ −1 (z̃2 (k) − z̃1 (k)))

Because Ai = 0, i ≥ 2 and B + AB = Ce + D = e,
where e ∈ R2 is a vector of ones, for any k ≥ 2,
z̄(k) = C x̄(k) + D = x̄(k) = Ak x0 +

k−1
X

Ai B = e.

i=0

Because z̄1 (k) = z̄1 (k + 1) = z̄2 (k) = 1 it follows that
R̂(k) =

−δ −1 (z̃1 (k) − z̃1 (k + 1))
z̃1 (k) − z̃1 (k + 1)
=
−δ −1 γ(z̃2 (k) − z̃1 (k))
γ(z̃2 (k) − z̃1 (k))

is independent of δ for k ≥ 2.

in which


1
A = γ
0


0
0
(1 − γ)
0 ,
θ
(1 − θ)


 
ẑ1 (k)
−1
x̂(k) = ẑ2 (k) . (36)
B =  0 ,
ẑ3 (k)
0

Equations (35)–(36) correspond to a state-space representation of (30)–(32) if û(k) = u(k), x̂(k) = x(k), and
x̂(0) = x(0). Consider also the measurement (20) and


ŷ(k) = 1 + C x̂(k),
C = 0 0 −1 .
(37)
Note that if û(k) = u(k) and x̂(0) = x(0) then δ ŷ(k) =
y(k). This motivates the introduction of the cost function
φy (w) =

IV. C ONSTRAINED E STIMATION
Some basic properties of the variables in the SRIDC
model were listed in (21). In this section an alternative
method for estimating the model variables and the timevarying parameter R(k) will be introduced that allows
one to enforce such and other constraints.
Consider the auxiliary linear time-invariant system

N −1
1 X
2
q(k) (y(k) − w(k))
N

and the associated optimal estimation problem
min

ŷ,x̂,û

s.t.

φy (δ ŷ)
x̂(k + 1) = Ax̂(k) + B û(k)
ŷ(k) = 1 + C x̂(k)

(30)

û(k) ≥ 0,

z2 (k + 1) = z2 (k) − γ z2 (k) + γz1 (k)

(31)

(x̂, û) ∈ Ω

z3 (k + 1) = z3 (k) − θ (z3 (k) − z2 (k))

(32)

u(k) = γ R(k)(z2 (k) − z1 (k)).

(33)

This means that instead of estimating R(k) from the
nonlinear model (17)–(19) it is possible to use (33) to
calculate
û(k)
,
(34)
R̂(k) =
γ (ẑ2 (k) − ẑ1 (k))
in which the input û and the variables ẑ1 and ẑ2 are
estimated from the linear time-invariant model (30)–(32).

(38)

k=0

z1 (k + 1) = z1 (k) − u(k)

in which u(k) is an input to be determined. Equations (17)–(19) and (30)–(32) will have the exact same
trajectories if they have the same initial conditions and

(35)

(39)

k = 0, · · · , N − 1

in which Ω is a constraint set that will be detailed below.
In this paper, Ω will be comprised of linear constraints,
hence Problem (39) will be a convex optimization problem [11].
The objective of Problem (39) is to produce a nonnegative input û(k) that minimizes the weighted sum of
squares of the error between the available measurement
y(k), in this case the deaths, and δ ŷ(k) produced by
the dynamic model (35)–(36), in the presence of the
additional convex constraints expressed in the set Ω.
The weighting function q(k) can be used to reflect
the uncertainty level of each measurement. For example,
under the assumption that the measurement noise can
be modeled as a zero-mean and Gaussian white noise

6

process a natural choice would be q(k) = v(k)−1 ,
where v(k) is the variance of the measurement error
at time k [17]. The above problem is a variation on a
standard finite-horizon linear quadratic optimal control
problem [18].
The non-negativity constraint on û(k) follows from
one of the basic constraints in (21). Indeed û(k) =
ẑ1 (k) − ẑ1 (k + 1) ≥ 0. The remaining constraints in (21)
can be expressed in the form

Ωb = (x̂, û) : 0 ≤ x̂(k) ≤ 1,
F x̂(k) ≤ 0,

k = 0, · · · , N ,

in which the matrix

1
F =
0

−1
1


0
.
−1

A. Constraints on R and Ṙ
Constraints on the estimates of R and Ṙ can be
translated as constraints on x̂ and û. The constraints
discussed in this section implicitly assume that z2 > z1 ,
which will be the case whenever z2 − z1 = x2 > 0, that
is whenever the number of infected is still positive.
If lower- and upper-bounds on the value of R ∈ [R, R]
are available then the same constraint applied on the
estimate (34) can be translated as
γR(ẑ2 (k) − ẑ1 (k)) ≤ û(k) ≤ γR (ẑ2 (k) − ẑ1 (k))
which can be represented by the set of linear constraints

ΩR = (x̂, û) : γR Gx̂(k) ≤ û(k) ≤ γR Gx̂(k),

Therefore, since z2 > z1 , if
(ż2 − ż1 )R + Ṙ(z2 − z1 ) ≤ γ −1 u̇ ≤
(ż2 − ż1 )R + Ṙ(z2 − z1 ),
then Ṙ ∈ [Ṙ, Ṙ]. These inequalities can be expressed
approximately in terms of the discrete-time variables in
model (30)–(32) upon substituting
u̇ ≈ u(k + 1) − u(k),
ż2 − ż1 ≈ z2 (k + 1) − z1 (k + 1) − z2 (k) + z1 (k)
= u(k) + γ(z1 (k) − z2 (k)),
leading to the constraints on the estimates
(γR − Ṙ)ẑ1 (k) − (γR − Ṙ)ẑ2 (k) + Rû(k) ≤
γ −1 (û(k + 1) − û(k)) ≤
(γR − Ṙ)ẑ1 (k) − (γR − Ṙ)ẑ2 (k) + Rû(k).
An extension is to have bounds on Ṙ(k) that vary
depending on k. This is especially useful to capture the
higher uncertainties associated with the beginning of the
pandemic, a period when noisy date might suggest a
wider variation on R and hence its derivative. Such time
dependent constraint can be represented by the set

ΩṘ = (x̂, û) :
γH(k)x̂(k) + γRu(k) ≤ û(k + 1) − û(k),
û(k + 1) − û(k) ≤ γH(k)x̂(k) + γRu(k),
k = 0, · · · , N − 1

k = 0, · · · , N − 1
in which

in which the matrix

G = −1

1


0 .

Note how important is to formulate the estimation problem in terms of R rather than β: the equivalent constraints in β would be nonlinear while the ones in R are
linear.
It is also useful to constrain the derivative of R, that is
Ṙ, which is easier to manipulate in the continuous-time
version of model (30)–(32), namely



H(k) = (γR − Ṙ(k)) −(γR − Ṙ(k)) 0 ,
h
i
H(k) = (γR − Ṙ(k)) −(γR − Ṙ(k)) 0 ,
and Ṙ(k) ∈ [Ṙ(k), Ṙ(k)]. Even though the above constraints, having been ported from the continuous-time
model to the discrete-time model, are approximations,
they are very effective, as it will be illustrated by
examples later.

ż1 = −u,
ż2 = −γ (z2 − z1 ),

B. Initial Condition

ż3 = −θ (z3 − z2 ),

It is not necessary to have an estimate of the initial
condition, x̂(0), to solve Problem (39). The optimal
solution will provide a suitable estimate of the initial
condition. However, it is interesting to note that it is
always possible to chose x̂(0) so that ŷ(k) = δ −1 y(k) for
k = {0, 1, 2} without further constraining û(k). Indeed,
verify that

from which
u
u̇(z2 − z1 ) − (ż2 − ż1 )u
, and Ṙ =
.
R=
γ(z2 − z1 )
γ(z2 − z1 )2
If R ∈ [R, R] then
u̇ − γ(ż2 − ż1 )R
u̇ − γ(ż2 − ż1 )R
≤ Ṙ ≤
γ(z2 − z1 )
γ(z2 − z1 )

CB = CAB = 0

7

and that






C
y(0)
 CA  x(0) = δ −1 y(1) − e,
CA2
y(2)
in which e ∈ R3 is a vector of ones. Because the
above coefficient matrix is the Observability Matrix [18]
associated with the pair (A, C) which, for A and C
from (36) and (37), is square and non-singular, one can
calculate

−1  −1

C
δ y(0) − 1
µ0 =  CA  δ −1 y(1) − 1 .
(40)
CA2
δ −1 y(2) − 1
As discussed above, fixing x̂(0) = µ0 may not lead to the
best possible overall estimate but one could incorporate
such knowledge, if desired, by adding the function
φ0 (x̂(0)) = kΠ(x̂(0) − µ0 )k22

(41)

to the cost of Problem (39). Matrix Π can be used
to weigh the user confidence on the estimate µ0 . The
examples shown in the present paper do not make use
of (41). However, weighing prior knowledge on the initial
condition can be useful in the presence of additional
measurements, to be discussed in Section IV-G.
C. Smoothness Cost
The estimation Problem (39) takes the form of a
finite horizon optimal control problem [18]. However,
a typical finite horizon optimal control problems is often
formulated with two more types of costs: a penalty on the
terminal state and a direct penalty on the control cost,
typically a measure of the energy of the signal û(k).
There are lots of good reasons for such penalties to be
part of the cost [18]. Here a penalty on the signal û will
be used as a way to promote smoothness of the estimates.
Consider first a penalty on the terminal state. As it is
typical of discrete-time dynamic systems, the effects of
the input signal û may not appear in the output signal ŷ
until a number of iterations has taken place. In the case of
the model (35)–(37), since BC = BAC = 0, it takes at
least two iterations for the input to show up at the output.
That is, the value of the input û(k) will only appear in the
output ŷ(k + 2). See also the discussion in Section IV-B.
This means that the final two values of û(k) have no
effect on the cost function of Problem (39). However,
they will have an effect on the state, which ultimately
affects the estimate R̂(k). This means that the last two
estimates of R̂(k) should probably not be trusted. This
is equivalent to the two-step delay of the unconstrained
estimator discussed earlier in Section III.
In a typical control problem, a terminal cost ensures
that, even in the absence of measurements that can help
determine u(k) on those final instants, the final state is

steered toward a desired state. However, in Problem (39)
there does not seem to be a clear choice of a desired state,
unless the analysis pertains to past events in which the
disease has already reached equilibrium and information
on the equilibrium state is available. For this reason,
in the context of the COVID-19 epidemic, no terminal
constraint shall be imposed.
As for a running cost on the signal û, solutions to
Problem (39) are likely to still produce a signal û(k)
that can have significant variations, even after imposing
the constraints discussed so far. Indeed, the very nature
of the Problem (39) is to produce an optimal û(k) that
will do its best to capture the variations implied by a
changing y(k). However, as far as estimating R(k), it
may not be important to capture every single variation,
but rather to smooth out the trends. This goal is achieved
by adding the smoothness cost
φs (û) =
1
N −2

r(0)|û(0)|2 +

N
−3
X

!
r(k) |û(k) − û(k − 1)|

2

k=1

(42)
which penalizes the total variations of û measured
at consecutive samples. This cost function promotes
smoothness of û(k), which in turns promotes smoothness
of R̂(k), as it will be seen in the examples. Note
also that (42) does not penalize the last two values of
û(k) since, as discussed above, they do not affect the
measurements at k = N − 2 and N − 1.
D. Trading-off Accuracy Versus Smoothness
This section will illustrate how the optimization problem and the constraints discussed so far can be used to
produce smooth estimates of the SIRDC model variables
and the parameter R. Let us start by solving Problem (39)
for the United States data shown before in Fig. 1. The
following constant parameters were used:
γ = 0.2,

θ = 0.1,

δ = 0.065, R = 3,

R = 0.1,

with the constraint set
Ω = Ωb ∩ ΩR ∩ ΩṘ .
The derivative of R, Ṙ, was constrained by the timedependent bounds
Ṙ(k) = −Ṙ(k),
(
0.5(k/30) + 0.1(1 − k/30),
Ṙ(k) =
0.1,

k ≤ 30,
k > 30,

which allows larger variations at the beginning of the
epidemic, and a constant weight
q(k) = 1,

k = 0, · · · , N − 1,

8

ACCUMULATED DEATHS
deaths

160

β=1
β = 1.02

140

β = 1.05

%

100

%

20
0

0

20

40

60

0

20

40

60

80

100

120

140

160

new deaths

2.5

β=1
β = 1.02

140

160

0

20

40

60

80

100

120

140

160

120

140

160

x̂2 = ẑ2 − ẑ1

0

20

40

60

80 100
DAYS

Fig. 6. Constrained estimates x̂1 = ẑ1 and x̂2 = ẑ2 − ẑ1 produced
by solving Problem (43) for various values of β for the data in Fig. 4.
Note how x̂1 = ẑ1 is monotonically decreasing and remains below
one, and x̂2 = ẑ2 − ẑ1 and ẑ1 (k) − ẑ1 (k + 1) remain positive.

was used in the cost function. No penalty on the initial
condition was imposed.

1.0
0.5
0

20

40

60

80 100
DAYS

120

140

160

Fig. 4. Accumulated and new daily deaths attributed to COVID–19
in the United States from 01/22/2020 through 08/16/2020 [12]. Day 0
corresponds to the first day in this range in which a non-zero number
of deaths was reported. Also shown is the corresponding constrained
estimates produced by solving Problem (43) for various values of β.
The solution to Problem (39) corresponds to β = 1.

β=1

R̂

3

β = 1.02
β = 1.05

2

β = 1.1

1

0.50
0.25
0.00
0.25
0.50

120

β = 1.1

1.5

0

100

β = 1.05

2.0

0.0

80

ẑ1(k) − ẑ1(k + 1)

0.5
0.0

NEW DAILY DEATHS

THOUSANDS

β = 1.1

60
40

β = 1.02
β = 1.05

0.1
0.0

80

β=1

x̂1 = ẑ1

β = 1.1

120
THOUSANDS

1.00
0.95
0.90

0

20

40

60

80

100

120

140

160

ˆ
Ṙ

The estimated deaths and new daily deaths and the
corresponding estimates for R and Ṙ obtained by Problem (39) are shown in Fig. 4 and 6, with the label β = 1.
Note how the constraints on R are enforced at all times
while the constraints on Ṙ are approximately enforced,
as discussed in Section IV-A. All numerical examples
in this paper were formulated using CVXPY [19] and
solved using MOSEK’s conic solver [20].
Enforcing the constraints on the model variables and
parameters during the estimation process ensures that
the estimates produced are much better behaved and
smoother when compared with the estimates obtained
by the unconstrained estimation methods of Section III.
The smoothness of the estimate can be further enhanced
by incorporating a smoothness cost as discussed in
Section IV-C. As it is customary, one could modify
Problem (39) by replacing its cost function by

φy (δ ŷ) + η φs (û)

where η > 0 is a penalty parameter. The correct tuning of
the parameter η can however be tricky. Instead, perform
the following two step procedure:
0

20

40

60

80 100
DAYS

120

140

160

Fig. 5. Constrained estimates produced by solving Problem (43) for
various values of β for the data in Fig. 4. The constraints imposed on
the estimated R and Ṙ are shown by the dashed lines.

1) Solve the convex optimization Problem (39) and
determine its global optimal solution and cost. Let
ρ∗ be the minimal cost.
2) Select β ≥ 1 and solve the convex quadratic optimization problem with linear and convex quadratic

9

constraints
min

ŷ,x̂,û

s.t.

in which

Ω̂ = (ŷ, x̂, û) :

2

δ φs (û)
x̂(k + 1) = Ax̂(k) + B û(k)
ŷ(k) = C x̂(k) + Er(k)
û(k) ≥ 0,

ŷ(k) = 1 + C x̂(k),

φy (δ ŷ) ≤ β ρ∗
The reason for scaling the cost function by the square of
the fatality rate δ will be made clear in Section IV-E.
The parameter β ≥ 1 can be interpreted as how
much accuracy one is willing to trade for smoothness.
Indeed when β = 1, Problems (39) and (43) admit
the exact same optimal solution. However, as β increases, smoother solutions are possible at the expense
of a higher estimation error. In the case of the United
States COVID-19 data, the estimates produced with
β = {1.02, 1.05, 1.1} are also shown in Figs. 4–6.
The impact of the value of β is still data dependent. Indeed, the more noise is present in the data the less smooth
one would expect the solution to Problem (39) to be, and
the higher one might need to set β for the desired level
of smoothness. Note also that as the penalty β increases
the constraints on R and its derivative becomes less
and less active. However, solving Problem 39 without
these constraints would make the choice of β much more
difficult, as the value of the cost function of Problem 39
is allowed to be reduced further by increasingly less
smooth solutions. By enforcing these constraints earlier
in Problem (39) it is found that a choice of β ∈ [1, 2]
is enough to produce suitable solutions for data from
diverse countries, to be presented in Section V.

The constrained estimator obtained as the solution to
the optimization problems (39) and (43) enjoy the same
independence of the fatality rate, δ, as the unconstrained
estimator from Section III. The following result is analogous to Proposition 1. Its proof reveals the need for the
scaling of the objective function in Problem (43).

for A, B, and C from (36)–(37). Since δ only affects
the value of the cost function, there will exist an optimal
solution for any δ > 0 as long as Ω̂ 6= ∅.
Now let 0 < λ ≤ 1, and calculate
x̂λ (k + 1) = A x̂λ (k) + B ûλ (k),
x̄λ (0) = λ x̂δ (0) + (1 − λ) e,

Proposition 2. The estimate
û(k)
γ(ẑ2 (k) − ẑ1 (k))

(44)

in which ẑ1 and ẑ2 are obtained as solutions to Problem (39) or Problem (43) is independent of the value of
the fatality rate, δ.
Proof. Let ŷδ , x̂δ and ûδ be the optimal solution to
Problem (39) for some δ > 0, that is
min

ûλ (k) = λ ûδ (k),

in which e ∈ R3 is a vector of ones, and use the fact
that Ak e = e, k = 0, 1, · · · , to show that
x̂λ (k) = λ x̂δ (k) + (1 − λ) e.
Since 0 ≤ x̂δ (k) ≤ e and 0 < λ ≤ 1
0 ≤ x̂λ (k) ≤ e.
Furthermore F e = 0 so that
F x̂λ (k) = λ F x̂δ (k) ≤ 0
and x̂λ (k) ∈ Ωb . Likewise, because G e = 0, H(k) e =
H(k) e = 0, x̂λ (k) ∈ ΩR ∩ ΩṘ . Finally, using the fact
that C e = −1,
ŷλ (k) = 1 + C x̂λ (k) =
1 + (1 − λ) Ce + λ C x̂δ (k) = λ ŷδ (k),
from which one concludes that (ŷλ , x̂λ , ûλ ) ∈ Ω̂.
Note that for any y, z and 0 < λ ≤ 1 it is true that

≥ λ−1 kzk2Q − 2 z T Qy + kyk2Q
≥ ky − zk2Q = N φy (z),
in which Q = diag(q(0), · · · , q(N − 1)) and kxk2Q =
xT Q x, so that
φy (λ−1 δ ŷ) ≥

min
(ŷ,x̂,û)∈Ω̂

(ŷ,x̂,û)∈Ω̂

k = 1, · · · , N − 1,

N φy (λ−1 z) = ky − λ−1 zk2Q

E. Independence of the Fatality Rate

(ŷδ , x̂δ , ûδ ) = arg

û(k) ≥ 0,

(x̂, û) ∈ Ω = Ωb ∩ ΩR ∩ ΩṘ ,

(43)

k = 0, · · · , N − 1

(x̂, û) ∈ Ω

R̂(k) =

x̂(k + 1) = Ax̂(k) + B û(k),

φy (δ ŷ)

min

φy (δ ŷ) = φy (δ ŷδ ).

(ŷ,x̂,û)∈Ω̂

On the other hand, since (ŷλ , x̂λ , ûλ ) ∈ Ω̂,
φy (λ−1 δ ŷ) ≤ φy (λ−1 δ ŷλ ) = φy (δ ŷδ ).

min
(ŷ,x̂,û)∈Ω̂

Combining these two inequalities it is possible to conclude that
min

φy (λ−1 δ ŷ) = φy (δ ŷδ ),

for all 0 < λ ≤ 1,

(ŷ,x̂,û)∈Ω̂

which proves the proposition for Problem (39) since the
above discussion holds for any small enough δ > 0.

10

As for Problem (43), the above discussion means that
the constraint

in which Q = diag(q(0), · · · , q(N − 1)) and


φy (δ ŷ) ≤ β ρ∗
will be unaffected by the choice of δ since ρ∗ is independent of δ. Therefore, an argument similar to the one
used for Problem (43) in which
(ŷδ , x̂δ , ûδ ) = arg

δ 2 φs (û),

min
(ŷ,x̂,û)∈Ω̂s

Ω̂s = {(ŷ, x̂, û) ∈ Ω̂ :

φy (δ ŷ) ≤ β ρ∗ },







y=
,




y(N − 1) − δ

Π
0
 δC
0


δ CB
A =  δ CA

..
..

.
.
δ CAN −1

leads to
λ−2 δ 2 φs (û) ≥

min



Π µ0
y(0) − δ
y(1) − δ
..
.

(ŷ,x̂,û)∈Ω̂s

δ 2 φs (û) = δ 2 φs (ûδ )

min
(ŷ,x̂,û)∈Ω̂s

for all 0 < λ ≤ 1 and, since (ŷλ , x̂λ , ûλ ) ∈ Ω̂s ,
λ−2 δ 2 φs (û) ≤ λ−2 δ 2 φs (ûλ ) = δ 2 φs (ûδ ),

min
(ŷ,x̂,û)∈Ω̂s

λ−2 δ 2 φs (û) = δ 2 φs (ûδ ),

min

0 ≤ T x ≤ 1,



(ŷ,x̂,û)∈Ω̂s

for all 0 < λ ≤ 1, as in Problem (39).

F. Problem Summary
The optimization problems (39) and (43) are convex
quadratic programs with linear and convex quadratic
constraints. It is possible to take advantage of the linear
nature of the equations (35)–(36) to propagate the state
evolution as a function of the inputs and the initial
condition. That is the entire state x̂(k), k = 0, · · · , N ,
can be written as




x̂0
x̂(0)
 û(0) 
 x̂(1) 






x =  û(1) 
 ..  = T x,


 . 
..


.
x̂(N )
û(N − 1)
in which


I
A

T= .
 ..
AN

0
B
..
.

0
0
..
.

AN −1 B

AN −2 B

···
···
..
.
···



0
0

..  .
.
B

Using the above, one can write
φ0 (x̂(0)) + φy (δ ŷ) = kQ1/2 (A x − y) k22

···
···
···
..
.

δ CAN −3 B


0
0

0
.
.. 
.

···

0

The cost function of Problem (39) is a special case in
which Π = 0.
Similar manipulations can convert the linear constraints Ωb and ΩR to the form


in which I = 0

from which

δ CAN −2 B

0
0
0
..
.

F x ≤ 0,

γ R G x ≤ I x ≤ γ R G x,


I ,

F
FA
..
.

0
FB
..
.



F=

F AN F AN −1 B

G
0
 GA
GB

G=
..
..

.
.
GAN −1

GAN −2 B

···
···
..
.

0
0
..
.
F AN −2 B
0
0
..
.
GAN −3 B

0
0
..
.




,


···

FB

0
0

..  .
.
··· 0

···
···
..
.

The constraints in ΩṘ can be reformulated as
γ Hx ≤ Dx ≤ γ Hx
in which


H(0)
H(1)A
..
.



H=

H(N − 1)AN −1

H(0)

H(1)A

H=
..

.

R
H(1)B
..
.

···
···
..
.

H(N − 1)AN −2 B


0
0

..  ,
.

···

R

R
H(1)B
..
.

···
···
..
.


0
0

..  ,
.

···

R

H(N − 1)AN −1 H(N − 1)AN −2 B


0 −1 1 · · · 0
0 0 −1 · · · 0


D = .
..
..
..  .
..
 ..
. .
.
.
0 0
0 ··· 1

11

The above can be put together to reformulate Problem (39) as the following convex quadratic program with
linear constraints
x

0 ≤ T x ≤ 1,

min

ŷ,x̂,û

s.t.

min kQ1/2 (A x − y) k22
s.t.

resulting into the optimization problem

F x ≤ 0,

γ R G x ≤ I x ≤ γ R G x,

φy (ŷ)
x̂(k + 1) = Ax̂(k) + B û(k)
ŷ(k) = g + H x̂(k)
û(k) ≥ 0,

(45)

k = 0, · · · , N − 1

(x̂, û) ∈ Ω

γ Hx ≤ Dx ≤ γ Hx
Likewise, the cost φs can be expressed as
φs (û) = kR1/2 B xk22
in which R = diag(r(0), · · ·

0 1
0 −1

B = .
..
 ..
.
0

0

, r(N − 1)),

0 ··· 0
1 · · · 0

.. . .
. .
. .. 
.
0 ···

1

This means that problem (43) can be formulated as the
convex quadratic program with quadratic constraints
min δ 2 kR1/2 B xk22

Note how the fatality rate has been incorporated into the
matrix H and vector g. It should not be expected that
the independence property of Proposition 2 holds in the
presence of the additional measurements since scaling
the infected and resolving population to match a given
fatality rate, as done in the proof of Proposition 2, will
no longer preserve optimality. In fact, one might use the
additional data to jointly estimate the parameter δ.
Another possible extension that might be especially
useful in the presence of additional measurement is
the relaxation of the dynamic equality constraints in
Problem (45) as a penalty function, as usually done in
smoothing problems [17]. Additional nonlinear model
features could also be added at the expense of loosing
convexity of the overall optimization problem.

x

s.t.

0 ≤ T x ≤ 1,

F x ≤ 0,

γ R G x ≤ I x ≤ γ R G x,

V. C ONCLUSIONS AND D ISCUSSION

The present paper has revisited unconstrained and
proposed new constrained methods for estimation of the
kQ1/2 (A x − y) k22 ≤ β ρ∗
variables and time-varying parameters of compartmental
models with application to the present COVID-19 epiThe above problems can be formulated and solved ef- demic. Even though the underlying model is nonlinear, a
ficiently using modern convex optimization algorithms change of coordinates enables the estimation to be done
in stock desktop computers for problems with tens of using an auxiliary linear model that results in convex
thousands of variables and constraints.
quadratic optimization problems which can be solved
globally and very efficiently, as well as be applied to
large data sets. The constrained method has been shown
G. Handling Additional Measurements
to preserve the physical properties of the model variables
The proposed constrained optimization approach can throughout the estimation. Through an additional penalty
be extended to handle additional measurements. For on the total variation of the estimates one can trade-off
example, one could leverage testing data to estimate the accuracy versus smoothness of the obtained estimates.
The paper is concluded by showing the results obcurrent number of infected and resolving cases, that is to
tained
by solving the constrained estimation Probprovide additional measurements of the model variables
lem
(43)
for COVID-19 death records for select countries
x2 and x3 . By grouping these measurements into a
3
obtained
from the COVID-19 Data Repository by the
vector y(k) ∈ R in which the first entry is the fraction
Center
for
Systems Science and Engineering (CSSE) at
of deaths, the second entry is the fraction of infected
Johns
Hopkins
University [12]. The selected countries
individuals, and the third entry is the fraction of resolving
were:
United
States
of America (already considered
individuals, one can calculate the best constrained estiearlier),
Belgium,
Brazil,
United Kingdom, Italy, Spain,
mate by using the exact same estimator dynamic model
Germany,
Sweden,
all
with
the same settings used before
as (35)–(36) with the extended measurement model
in
Section
IV-D
except
for
the parameter β, which was


 
0
0 −δ
δ
selected differently for each country depending on the
0 , g = 0, noise levels of the data. The results and the corresponding
ŷ(k) = g + H x̂(k), H = −1 1
0 −1 1
0
value of β is shown for each country in Figs. 7–10.
γ H x ≤ D x ≤ γ H x,

12

UNITED STATES OF AMERICA (β = 1.1)

1.5
1.0

1.0

0.5

0.5

0.0

0.0

0

20

40

60

80 100 120 140 160
DAYS

BELGIUM (β = 1.5)

2.5

R̂

0.5
0.0

0

20

40

60

80 100
DAYS

120

140

0.4
0.2
0

20

40

60

80
DAYS

100

120

140

0.0

UNITED KINGDOM (β = 1.2)

3.0

new deaths
1.2
estimated deaths
MA-7
1.0
R̂

2.5
2.0

0.8

1.5

0.6

1.0

0.4

0.1

0.5

0.2

0.0

0.0

0.2

1.0

0.6

0.5

0.3

1.5

0.8

1.0

0.5
new deaths
estimated deaths
MA-7
0.4
R̂

2.0

1.0

1.5

0.0

NEW DAILY DEATHS (THOUSANDS)

3.0

1.6
new deaths
estimated deaths
1.4
MA-7
R̂
1.2

NEW DAILY DEATHS (THOUSANDS)

1.5

2.0

Fig. 7. New daily deaths attributed to COVID–19 in the United States
and Belgium from 01/22/2020 through 08/16/2020 [12] along with
estimates for new deaths and R produced by solving Problem (43). The
value of β used is shown in the legends. Also show for comparison is
a 7-day moving average of new deaths.

R̂

R̂

2.0

2.5

R̂

NEW DAILY DEATHS (THOUSANDS)

2.5

BRAZIL (β = 1.1)

3.0

new deaths
estimated deaths 2.5
MA-7
R̂
2.0

NEW DAILY DEATHS (THOUSANDS)

3.0

20

40

60

80 100
DAYS

120

140

160

0.0

Fig. 8. New daily deaths attributed to COVID–19 in the Brazil and the
United Kingdom from 01/22/2020 through 08/16/2020 [12] along with
estimates for new deaths and R produced by solving Problem (43). The
value of β used is shown in the legends. Also show for comparison is
a 7-day moving average of new deaths.

R EFERENCES
[1] W. Yang, D. Zhang, L. Peng, C. Zhuge, and L. Hong, “Rational
evaluation of various epidemic models based on the COVID-19
data of China.” medRxiv preprint, Mar. 2020.
[2] J. Fernndez-Villaverde and C. I. Jones, “Estimating and simulating a SIRD model of COVID-19 for many countries, states, and
cities.” NBER Working Paper No. 27128, May 2020.
[3] S. R. Buckman, R. Glick, K. J. Lansing, N. Petrosky-Nadeau, and
L. M. Seitelman, “Replicating and projecting the path of COVID19 with a model-implied reproduction number.” Federal Reserve
Bank of San Francisco Working Paper 2020-24, July 2020.
[4] C. Anastassopoulou, L. Russo, A. Tsakris, and C. Siettos, “Databased analysis, modelling and forecasting of the COVID-19
outbreak,” PLOS ONE, 2020.
[5] H. W. Hethcote, “The mathematics of infectious diseases,” SIAM
Review, vol. 42, no. 4, pp. 599–653, 2000.
[6] N. Ferguson, D. Laydon, G. Nedjati Gilani, N. Imai,
K. Ainslie, M. Baguelin, S. Bhatia, A. Boonyasiri, Z. Cucunuba Perez, G. Cuomo-Dannenburg, A. Dighe, I. Dorigatti,
H. Fu, K. Gaythorpe, W. Green, A. Hamlet, W. Hinsley, L. Okell,
S. Van Elsland, H. Thompson, R. Verity, E. Volz, H. Wang,
Y. Wang, P. Walker, C. Walters, P. Winskill, C. Whittaker, C. Donnelly, S. Riley, and A. Ghani, “Impact of non-pharmaceutical

0

[7]

[8]
[9]
[10]
[11]
[12]
[13]
[14]
[15]

interventions (NPIs) to reduce COVID19 mortality and healthcare
demand,” tech. rep., Imperial College, 2020.
M. M. Morato, S. B. Bastos, D. O. Cajueiro, and J. E. NormeyRico, “An optimal predictive control strategy for COVID-19
(SARS-CoV-2) social distancing policies in Brazil,” Annual Reviews in Control, 2020. In Press, Corrected Proof.
G. Stewart, K. van Heusden, and G. A. Dumont, “How control
theory can help us control COVID-19,” IEEE Spectrum, 2020.
J.
Cochrane,
“An
SIR
model
with
behavior.”
https://johnhcochrane.blogspot.com/2020/05/
an-sir-model-with-behavior.html, May 2020.
P. L. Delamater, E. J. Street, T. F. Leslie, Y. T. Yang, and K. H.
Jacobsen, “Complexity of the basic reproduction number (R0 ),”
Emerging Infectious Diseases, vol. 25, pp. 1–4, Jan. 2019.
S. P. Boyd and L. Vandenberghe, Convex Optimization. Cambridge University Press, 2004.
E. Dong, H. Du, and L. Gardner, “An interactive webbaseddashboard to trackcovid-19 in real time,” The Lancet Infectious Diseases, vol. 20, pp. 533–534, Feb. 2020.
U. S. C. for Disease Control and Prevention www.cdc.gov/
coronavirus/2019-ncov/hcp/planning-scenarios.html.
A. Atkeson, “How deadly is COVID-19? Understanding the
difficulties with estimation of its fatality rate.” NBER Working
Paper No. 26965, Apr. 2020.
T. W. Russell, J. Hellewell, C. I. Jarvis, K. Van Zandvoort,

13

ITALY (β = 1.5)

R̂

R̂

0.4

1.0

0

20

40

60

0.0

new deaths
estimated deaths 1.2
MA-7
R̂
1.0

3.0

SPAIN (β = 1.1)
NEW DAILY DEATHS (THOUSANDS)

3.0
2.5
2.0

0.8

0.5

0.2

0.5

0.0

0.0

80 100
DAYS

120

140

160

Fig. 9. New daily deaths and 7-day moving average attributed
to COVID–19 in Italy and Spain from 01/22/2020 through
08/16/2020 [12] along with estimates for new deaths and R produced
by solving Problem (43). The value of β used is shown in the legends.
Also show for comparison is a 7-day moving average of new deaths.

[16]

[17]
[18]
[19]

[20]

S. Abbott, R. Ratnayake, S. Flasche, R. M. Eggo, W. J. Edmunds,
and A. J. Kucharski, “Estimating the infection and case fatality
ratio for COVID-19 using age-adjusted data from the outbreak
on the Diamond Princess cruise ship,” February 2020. Euro
Surveillance, vol. 12, pp. 1–5, Feb. 2020.
R. Verity, L. C. Okell, I. Dorigatti, P. Winskill, C. Whittaker, N. Imai, G. Cuomo-Dannenburg, H. Thompson, P. T.
Walker, H. Fu, A. Dighe, J. T. Griffin, M. Baguelin, S. Bhatia,
A. Boonyasiri, A. Cori, Z. Cucunub, R. FitzJohn, K. Gaythorpe,
W. Green, A. Hamlet, W. Hinsley, D. Laydon, S. Nedjati-Gilani,
G.and Riley, S. van Elsland, E. Volz, H. Wang, Y. Wang, X. Xi,
C. A. Donnelly, A. C. Ghani, and N. M. Ferguson, “Estimates
of the severity of coronavirus disease 2019: A model-based
analysis,” Lancet Infectious Diseases, vol. 20, pp. 669–677, Mar.
2020.
B. D. O. Anderson and J. B. Moore, Optimal Filtering. Englewood Cliffs, NJ: Prentice Hall, 1979.
H. Kwakernaak and R. Sivan, Linear optimal control systems.
New York: Wiley-Interscience, 1972.
S. Diamond and S. Boyd, “CVXPY: A Python-embedded modeling language for convex optimization,” Journal of Machine
Learning Research, vol. 17, no. 83, pp. 1–5, 2016.
E. D. Andersen, C. Roos, and T. Terlaky, “On implementing a
primal-dual interior-point method for conic quadratic optimization,” Mathematical Programming, vol. 95, Feb. 2003.

60

80 100
DAYS

120

140

0.0
160

SWEDEN (β = 1.1)
new deaths
estimated deaths 0.175
MA-7
0.150
R̂
0.100

1.0

60

40

1.5

0.4

40

20

0.125

1.0

20

0

2.0

0.6

0

0.1

2.5

1.5

0.0

0.2

0.5

0.0

80 100 120 140 160
DAYS

0.3

1.5
1.0

0.2

0.5

R̂

2.0

0.6

1.5

0.0

2.5

R̂

R̂

2.0

new deaths
0.5
estimated deaths
MA-7
R̂
0.4

NEW DAILY DEATHS (THOUSANDS)

NEW DAILY DEATHS (THOUSANDS)

2.5

GERMANY (β = 1.1)

3.0

new deaths
estimated deaths
0.8
MA-7

NEW DAILY DEATHS (THOUSANDS)

3.0

0.075
0.050
0.025
0

20

40

60

80 100
DAYS

120

140

0.000

Fig. 10. New daily deaths and 7-day moving average attributed
to COVID–19 in Germany and Sweden from 01/22/2020 through
08/16/2020 [12] along with estimates for new deaths and R produced
by solving Problem (43). The value of β used is shown in the legends.
Also show for comparison is a 7-day moving average of new deaths.

A PPENDIX
One can rearrange the last two equations from (17)–
(19) as in
z1 (k) = γ −1 z2 (k + 1) + (1 − γ −1 )z2 (k)
z2 (k) = θ−1 z3 (k + 1) + (1 − θ−1 )z3 (k)
where z1 and z2 are the system’s state and
z3 (k) = 1 − δ −1 y(k)
can be thought of as an input. The above dynamic system
is clearly non-causal as the present values of the state
depend on future values of the inputs. Making use of the
z-transform operator [18] one can relate the transform of
the output z1 , z2 with the transform of the input z3 as
the following inproper transfer-functions


Z1 (z) = γ −1 z + (1 − γ −1 ) θ−1 z + (1 − θ−1 ) Z3 (z)

Z2 (z) = θ−1 z + (1 − θ−1 ) Z3 (k)

14

A causal filter can be constructed by delaying the output
by two samples, that is the filter
Ẑ1 (z) = z −2 Z1 (z),

Ẑ2 (z) = z −2 Z2 (k)

which corresponds to the state-space realization (23)–
(26). Because matrix C is invertible, the initial conditions
must satisfy




ẑ1 (0)
x1 (0)
=C
+ D u(0)
ẑ2 (0)
x2 (0)
which can be inverted to produce (28).

