Impact of Pre-symptomatic Transmission on Epidemic Spreading in Contact Networks
Bo Li1, ∗ and David Saad1, †

arXiv:2010.14598v2 [physics.soc-ph] 21 Dec 2020

1

Non-linearity and Complexity Research Group, Aston University, Birmingham, B4 7ET, United Kingdom
Infectious diseases that incorporate pre-symptomatic transmission are challenging to monitor,
model, predict and contain. We address this scenario by studying a variant of stochastic susceptibleexposed-infected-recovered (SEIR) model on arbitrary network instances using an analytical framework based on the method of dynamic message-passing. This framework provides a good estimate of
the probabilistic evolution of the spread on both static and contact networks at a low computational
cost compared to numerical simulation. It facilitates the derivation of epidemic thresholds, which
are phase boundaries separating parameter regimes where infections can be effectively contained
from those where they cannot. These have clear implications on different containment strategies
through topological (reducing contacts) and infection parameter changes (e.g., social distancing and
wearing face masks), with relevance to the recent COVID-19 pandemic. Our studies show quantitatively the deficiency of using the reproduction number as a measure for predicting the spreading
rate in some topologies, how effective isolation reduces the need in strict social distancing measures,
and the importance of mass testing in scenarios with long asymptomatic exposure since isolation of
symptomatic individuals is insufficient to mitigate the spread.

I.

INTRODUCTION

Rapid spreading of infectious diseases has had devastating impact on societies throughout human history, but
has become more critical in the modern society due to
the dense population in urban areas and the increase in
human mobility facilitated by the global transportation
networks. A recent threat is the spread of the COVID-19
disease caused by the SARS-CoV-2 virus, which has led
to a pandemic with severe impact on the public health
and the global economy. One prominent feature of this
disease is that the pre-symptomatic and asymptomatic
viral carriers can spread the disease as well, which poses
a big challenge on contact tracing and disease containment [1–4]. Therefore it is crucial to understand the signiﬁcance of these undetected transmissions and estimate
their impact. Of particular importance are parameter
regimes where pre- and asymptomatic infections result in
a complete breakdown of our ability to identify infected
individuals and contain the spread.
Numerous studies that investigate the spread of the
COVID-19 disease aim at predicting the causes of the
spreading processes and examine the eﬀectiveness of nonpharmaceutical intervention strategies [5–7]. It is common to model the evolution of the population mass of
each group (e.g. susceptible, exposed, infected and recovered) by deterministic diﬀerential equations [4, 5, 8].
While being simplistic and tractable, such method assumes homogeneous mixing of the population (in a city or
within an age group) and neglects the social contact network structures of the speciﬁc instance investigated [9].
Large scale agent-based simulations are also widely used,
which provide a more detailed picture of the spreading
processes but are very computationally demanding and

∗
†

b.li10@aston.ac.uk
d.saad@aston.ac.uk

suﬀer from a lack of a principled understanding [10–13].
To obtain a reliable statistical description of the process
one has to increase the number of samples signiﬁcantly as
the system size increases, which makes the computation
prohibitive for large systems. Analytical treatments to
the epidemic spreading processes on heterogeneous contact networks are valuable both in providing solutions
in speciﬁc instances and in exploring the typical macroscopic behavior of ensemble of systems with similar characteristics; the latter also results in generic and intuitive
understanding.
In this work, we analyze diseases spreading with presymptomatic transmission such as COVID-19 by studying a variant of stochastic susceptible-exposed-infectedrecovered (SEIR) model on contact networks, in which
nodes in exposed state can also spread the disease without showing symptoms. For simplicity, the contact networks are viewed as static, serving as substrates on which
the disease spreads. We derive the dynamic messagepassing equations for this model, which provide a good
approximation to the complex stochastic spreading dynamics on general networks and facilitates theoretical
analyses [14–17]. Based on this framework, we derive
the epidemic thresholds and their dependence on diﬀerent intervention methods. The emphasis of this work is
not on predicting the exact dynamics of the COVID-19
epidemic, but to obtain a more intuitive physical pictures
and clarify the eﬀects of some containment strategies.
The remainder of the paper is organized as follows.
We introduce the SEIR model in Sec. II, and derive
the dynamical equations in Sec. III. We then perform
a linear stability analysis of the dynamical equations in
Sec. IV, based on which the epidemic thresholds are obtained and analyzed in Sec. V. In Sec. VI, we show that
non-backtracking centrality can be used to predict the
outbreak proﬁle. In Sec. VII, we investigate the eﬀects
of reducing contacts on slowing down the spread of the
disease. Finally, we summarize our ﬁndings and discuss
some limitations and outlook.

2
II.

THE MODEL

The contact network is represented by a graph G(V, E)
where V is the set of nodes and E is the set of edges. We
assume that the network has only one connected component. Each individual resides on a node, assuming one
of four states, susceptible (S), exposed (E), infected (I)
and recovered (R) at any particular time step. We assume that a node in the exposed state has contracted the
disease but has not developed symptoms yet. Unlike the
usual SEIR model [18], the exposed nodes can also spread
the disease. The dynamical process of the modiﬁed SEIR
model in discrete time is deﬁned in the form of transition
probabilities of states of neighboring nodes (say i and j)
and the state evolution of an individual node i
αji

S(i) + E(j) −−→ E(i) + E(j),

(1)

S(i) + I(j) −−→ E(i) + I(j),

(2)

βji

νi

E(i) −→ I(i),

(3)

I(i) −→ R(i),

(4)

µi

where αji (βji ) is the probability that node j being in the
exposed(infected) state transmits the disease to its susceptible neighboring node i at a certain time step. We
assume that each time step corresponds to one day, keeping in mind that a ﬁner time scale can also be considered.
At each time step, an existing exposed node i becomes
infected (i.e., develops symptoms) with probability νi ,
while an existing infected node i recovers with probability µi . Therefore, the average periods of incubation and
recovery are 1/νi and 1/µi , respectively. At a certain
time step, the symptom-development and recovery processes are assumed to occur after possible transmission
activities. Since we will contrast the properties of the
SEIR and SIR models, we also introduce the transition
probabilities of the latter

from 2.3 days before the onset of symptoms [3], while
it is argued [21] that infectiousness can start much earlier (one needs to look back at 5 days to catch 97% of
pre-symptomatic infections). The time needed for the
symptoms to disappear depends on disease severity of
the patient. In [3], it is inferred that infectiousness declines rapidly within 7 days. In [22], it is found (from
patients with mostly mild COVID-19) that viral subgenomic RNA, which provide evidence of replicative intermediates of the virus, were detectable up to 8 days after
the onset of symptoms. In this work, we deﬁne the recovered (R) state where the exposed/infected individual
eﬀectively looses infectiousness, irrespective of whether
the symptoms persist or not. Therefore, an infected individual who has been put into isolation and can no longer
infect others is also categorized to be in state R. To address the COVID-19 disease, we set νi = 1/5, µi = 1/8
according to these previous ﬁndings.
The transmission probabilities αji , βji are more difﬁcult to estimate. In [2], the transmission rate of undocumented infections was estimated to be 55% of that
of documented infections. Based on this ﬁnding, we set
αji = βji /2. For simplicity, we also assume that the parameters are homogeneous, i.e., αij = α, βij = β, νi =
ν, µi = µ. Our framework can accommodate any infection/recovery parameter distributions, but the insight
gained from such detailed parameter sets are more limited. Various intervention strategies have diﬀerent impacts on these epidemiological parameters. Some studies
report cases where infected individuals remain asymptomatic throughout the course of the infection; however,
these cases are the minority and seem to have a much
lower secondary attack rate [23, 24]. To keep the analysis
simple, we do not consider asymptomatic individuals who
do not become infected prior to recovery but brieﬂy discuss how the frameworks used could accommodate such
cases in Appendix B.

III.
βji

S(i) + I(j) −−→ I(i) + I(j),

(5)

I(i) −→ R(i),

(6)

µi

which has been widely studied in the literature [9]. We
remark that both models are Markovian processes, implying an exponential distribution for both symptomdevelopment and recovery times, which may not be fully
realistic for many diseases including COVID-19 [9, 19].
Nevertheless, they both represent relevant models that
are amenable to analysis and would provide important
generic insight.
The epidemiological parameters depend on the nature
of the disease and the intervention strategies being imposed; they are usually estimated based on observations
and can be subject to a high degree of uncertainty. As
for COVID-19, the average incubation period is about
5.2 days [3, 20]. Infectiousness is estimated to start

A.

THEORETICAL FRAMEWORKS

Individual-Based Mean-Field Approach

Since the exact solutions of the stochastic spreading
processes Eq. (1)-(4) are diﬃcult to obtain, various approximation methods have been developed to tackle such
complex dynamics [9]. A simple method is the individualbased mean-ﬁeld (IBMF) approach [9, 25], which expresses the evolution of the marginal distribution Pσi (t)
that each node i belongs to state σ by assuming the independence on the probabilities of neighboring nodes.
Consider the SEIR model deﬁned in Sec. II. For node i
being in the susceptible state S, it will remain in state S
in the next time step if none of its neighbors transmits an
infection signal to node Q
i. In the
 IBMF framework, this

occurs with probability k∈∂i 1 − αki PEk (t) − βki PIk (t) ,
where ∂i denotes the set of nodes adjacent to node i.
Therefore the evolution of the marginal probability node

3
i in state S is given by
PSi (t + 1) = PSi (t)

Y

k∈∂i


1 − αki PEk (t) − βki PIk (t) . (7)

The probability of node i in the exposed state E increases
if there is an infection signal from its neighbors, while it
decreases with rate νi (probability of transforming into
state I) as infection symptoms appear. The corresponding IBMF dynamical equation is
PEi (t + 1) =(1 − νi )PEi (t)


Y

+PSi (t) 1 −
1 − αki PEk (t) − βki PIk (t) , (8)
k∈∂i

Similarly, the evolution of PIi (t) and PRi (t) are given by
PIi (t + 1) =(1 − µi )PIi (t) + νi PEi (t),

PRi (t

+ 1)

=PRi (t)

+

µi PIi (t).

(9)
(10)

This approach has been used to investigate similar
models addressing the COVID-19 pandemic [26, 27].
However, the drastic simpliﬁcation based on the independence assumption of probabilities may lead to large
approximation errors [25]. One source of errors comes
from the mutual infection eﬀect due to this decorrelation
assumption [17, 28]. For instance, suppose that a node
i, having probability PEi (t) in the exposed state, infects
its susceptible neighboring node k at time t, then node
k can also reinfect node i at time t + 1 with some probability, which is an artifact of neglecting the correlation
between nodes i and k. Such eﬀects need to be correctly
accounted for in order to improve accuracy.
B.

Dynamic Message-passing Approach

The dynamic message-passing (DMP) approach, an algorithm that originates from the statistical physics literature [14–16] avoids the mutual infection eﬀect by considering the irreversible complete trajectories of the system. Formally, the DMP equations can be derived from
the belief propagation equations of dynamical trajectories, which is especially useful when the correct set of
dynamical variables are diﬃcult to determine straightforwardly [16, 29]. In this section, we provide an intuitive derivation of the DMP equations of the SEIR model,
while we give the more formal derivation based on belief
propagation in Appendix A.
Similar to the IBMF approach, the DMP method aims
at deriving the evolution of the marginal distributions.
Consider the marginal probability PSi (t) of node i being
at state S at time t, it is given by
Y
PSi (t) = PSi (0)
θk→i (t),
(11)
k∈∂i

where θk→i (t) is the probability that node i has not contracted the disease from node k up to time t. We have
made the assumption that the probability which node i
has not contracted the
Q disease from its neighbors up to
time t factorizes as k∈∂i θk→i (t). This assumption is
valid in tree graphs but constitutes a good approximation in many loopy networks [16].
The message θk→i decreases if node k transmits the
infection signal to node i, which occurs with probability
αki if node k is in state E or with probability βki if node
k is in state I. Therefore, it follows the update rule
θk→i (t + 1) =θk→i (t) − αki ψ k→i (t) − βki φk→i (t), (12)

where ψ k→i (t) is the probability that k is in state E but
has not transmitted the infection signal to node i, and
φk→i (t) is the cavity probability (on a graph where node
i is absent - a cavity) that k is in state I but has not
transmitted the infection signal to node i up to time t.
The message φk→i decreases if node k transmits the
infection signal to node i or changes from state I into
state R; note that the two processes can occur at the
same time step. On the other hand, it increases if node
k changes from state E into I. Therefore, it is updated
according to


φk→i (t + 1) = 1 − βki 1 − µk φk→i (t)

+ 1 − αki νk ψ k→i (t).

(13)

Similarly, the message ψ k→i (t) decreases if node k
transmits the infection signal to node i or changes from
state E into state I, while it increases if node k changes
from state S into E. In computing the probability increment due to the latter case, one needs to exclude the
contribution from node i to node k in the previous time
steps in order to avoid the eﬀect of mutual infection. This
is achieved through deﬁning
Y
θl→k (t),
(14)
PSk→i (t) = PSk (0)
l∈∂k\i

which is computed in the cavity graph assuming that
node i has been removed. Then the message ψ k→i (t)
follows the update rule

ψ k→i (t + 1) =(1 − αki ) 1 − νk ψ k→i (t)


+ PSk→i (t) − PSk→i (t + 1) .

(15)

Upon
computing
the
messages
{θk→i (t), φk→i (t), ψ k→i (t), PSi→j (t)} from the update
rules, the marginal probability PSi (t) can be obtained by
Eq. (11). The marginal probabilities of other states can
also be determined as
PRi (t + 1) =PRi (t) + µi PIi (t),
PIi (t
PEi (t

+ 1)
+ 1)

=(1 − µi )PIi (t) + νi PEi (t),
=1 − PSi (t + 1) − PIi (t + 1)

(16)
(17)
−

PRi (t

+ 1),
(18)

4

(20)

Evaluation on Contact Networks

(b)

identity
IBMF
DMP

0.9
0.6

80

100

(c)

0.9
0.6

PE (t)

0.3

0.3

i

0.0

0.0

0.3

i
PS (t)

0.6

by MC

0.9

0.0

(d)

0.6
0.3
0.0

0.0

0.3
i

0.6

by MC

0.0

0.3
i

PE (t)

0.9

PI (t)

Here we evaluate the eﬀectiveness of the developed
theories on contact networks, which are either artiﬁcially generated or adapted from some realistic human
contact data. The realistic contact networks are taken
from data sets obtained in the SocioPatterns collaboration [31], where the temporal face-to-face human contacts
are projected to static contact networks as described in
Appendix C.
Many realistic contact networks exhibit community
structures. For instance, in workplaces, people usually
interacts more frequently with other people from the
same department compared to those from other departments; in schools, students from the same class also interacts more frequently. An exemplar contact network in
the workplace (WP2015) from the SocioPatterns data is
depicted in Fig. 1(a). We run the DMP algorithm for this
contact network by randomly selecting 5 nodes as the initial exposed nodes and iterating for T = 100 time steps.
The evolution of the population of each compartment is
shown in Fig. 1(b). The number of exposed or infected
cases ﬁrst rises and then decreases, and eventually dies
out when herd immunity is reached. The trajectories predicted by the DMP approach match well with those from
MC simulation in this case.

60

by theory

(a)

i

C.

40

Figure 1. (a) Structure of a contact network in the workplace
taken from the SocioPatterns data (WP2015). The color of
a node represents the department that the individual belongs
to. (b) Evolution of the average population of each state. The
parameters used are ν = 0.2, µ = 0.125, β = 0.016, α = β/2.
At time t = 0, there are 5 exposed nodes. The trajectories
predicted by the DMP approach (represented by lines) match
well with those from MC simulation (averaged over 104 realizations, represented by dots).

PI (t)

If node i is selected as the initial exposed node, the initial
condition is simply set as PEi (0) = 1, PSi (0) = PIi (0) =
PRi (0) = 0. Based on the initial data, the messages are
solved by updating the DMP Equations (12)-(15) forward in time, after which the marginal probabilities are
determined by Equations (11), (16), (17)and (18). The
computational complexity of the DMP algorithm is linear in number of time steps and in number of edges as
O(|E|T ). Therefore, the DMP approach saves a significant amount of computational resources compared to
Monte Carlo (MC) simulations, which requires many realizations to obtain reliable results. On the other hand, it
is more demanding than the IBMF approach which deals
with node-wise variables rather than edge-wise variables.
Nevertheless, if the network is sparse, i.e., the average
degree hdi = 2|E|/N ≪ N , then the DMP approach has
the same order of computational complexity as the IBMF
approach. This is relevant to the case of disease spreading as the number of close contacts each person has is
limited [30], except for super-spreaders.

i

(22)

PI (t)]

= PRi (0) = 0.

20

t

i

(21)

=1−

50
0
0

[PE (t) +

PSi (0),

i

(0) = 0,

by theory

(0) = φ

PEi (0)
PIi (0)

(19)

i

i→j

susceptible
exposed
infected
recovered

100

PS (t)

θ

i→j

150

by theory

ψ i→j (0) = 1 − PSi (0),

(b) 200

(a)

population

We assume that the nodes are either in susceptible or exposed states at time t = 0, such that the initial conditions
are solely determined by PSi (0) as

0.9

32
24

0.6

by MC

0.9

IBMF
DMP
MC

16
8
00

8

16

24

32

t

Figure 2. Comparison between theory and MC simulation
(averaged over 104 realizations). The underlying network is a
random regular graph with N = 100, d = 10. The parameters
used are T = 30, ν = 0.2, µ = 0.125, β = 0.03, α = β/2. At
time t = 0, there is only one exposed node. The accuracy
of the DMP approximation is much better than the IBMF
approach.

As another example, we evaluate the eﬃcacy of our
framework on random regular graphs, where all nodes
have the same degree and are connected randomly. Only
one node is selected as the initial exposed node, and the
system is simulated for T = 30 time steps. The results are
shown in Fig. 2, exhibiting a much better approximation
accuracy of the DMP approach compared to IBMF. Due
to the eﬀect of mutual infection, both IBMF and DMP
tend to overestimate the outbreak.
In Fig. 3, we systematically compare the results between theories and MC simulation, showing that DMP
provides a much better approximation than the IBMF
approach. It is found that the prediction errors of both
theoretical approaches generally increase with the epi-

5

prediction error

IBMF
DMP

0.12

β = 0.02
β = 0.03
β = 0.04

0.08

IBMF
DMP

0.06

β = 0.005
β = 0.01
β = 0.015

0.04

0.04
0.00

(b) 0.08

prediction error

(a) 0.16

0.02

2

4

6

8

10

no. of initial exposed nodes

0.00

2

4

6

8

10

no. of initial exposed nodes

Figure 3. Comparison between theory and MC simulation for
different
the prediction error is calculated
P parameters,
P where
i
i
1
as NT
|P
(t)−Ptheory,σ
(t)|. The pasimulation,σ
σ∈{S,E,I}
i,t
rameters used are T = 30, ν = 0.2, µ = 0.125, α = β/2. Each
data point is average over 5 instances with different sets of
randomly selected initial exposed nodes. (a) Random regular graph with N = 100, d = 10. (b) Contact network in
the workplace taken from the SocioPatterns data (WP2015).
The prediction errors depend on the number of initial exposed
nodes and the epidemiological parameter β.

demiological parameter β, and also depend on the number of initial exposed nodes. Intuitively, large values of β
lead to larger growth rate of the infections, in which case
a small approximation error in early time steps could be
ampliﬁed in late times. For large β, the prediction errors typically decrease as the number of initial exposed
nodes increases. One possible reason is that the infections
spread out from a unique source are correlated, so that
the independence assumption in the IBMF and DMP approaches deteriorates [32], e.g., the assumption that the
messages in Eq. (11) factorize does not hold strictly. On
the other hand, if there are multiple initial seeds that trigger the outbreak, the infection signals into a node will be
less correlated, which partly preserves the decorrelation
assumption.
The network topology also impacts on the approximation accuracy of the theories as shown in Appendix D. As
mentioned before, DMP avoids the mutual infection by
excluding one step backtracking interaction, it does not
take into account mutual infections due to backtracking
of multiple steps, which can be non-negligible in networks
with many short loops. In Appendix D, we ﬁnd that the
approximation accuracy deteriorates signiﬁcantly when
the localization of non-backtracking centrality is present,
an eﬀect we will discuss below.
IV.
A.

LINEARIZED DYNAMICS AND STABILITY
Linearized Dynamics of the DMP Equations

The fate of the spreading processes depends on the epidemiological parameters. For large transmission probabilities β and α, the disease can spread out to a large
fraction of the network, while it tends to die out quickly
for small transmission probabilities. There exist thresholds for these parameters, above which the epidemic outbreaks occur. One commonly used method to determine

epidemic thresholds is to examine whether the diseasefree state is linearly stable to small perturbations [9, 33].
Speciﬁcally, the initial disease-free state is perturbed
inﬁnitesimally as PSi (0) = 1 − ǫi ; if such perturbation
diverges, then the outbreak tend to spread out globally.
At the initial stage, the message θk→i (t), which denotes
the probability node k has not passed the infection signal
to node i, can also be expressed as θk→i (t) = 1 − δ k→i (t).
At time t + 1, we have
θk→i (t + 1) =1 − δ k→i (t + 1)
=1 − δ

k→i

(t) − αki ψ

(23)
k→i

k→i

(t) − βki φ

(t),

which implies
δ k→i (t + 1) = δ k→i (t) + αki ψ k→i (t) + βki φk→i (t), (24)
where δ k→i (t), ψ k→i (t) and φk→i (t) have small values.
Expanding Eq. (14) and keeping ﬁrst order of ψ k→i (t)
and φk→i (t) leads to
PSi→j (t + 1) ≈PSi→j (t) −

X 

αki ψ k→i (t) + βki φk→i (t) .

k∈∂i\j

(25)

Then ψ k→i (t + 1) in Eq. (15) can be approximated as
ψ i→j (t + 1) ≈ (1 − αij )(1 − νi )ψ i→j (t)
X 

αki ψ k→i (t) + βki φk→i (t) .
+

(26)

k∈∂i\j

Equations (26) and (13) constitute a linear dynamical
system of the messages {φi→j (t), ψ i→j (t)}.
In the following, we use homogeneous parameters
αij = α, βij = β, νi = ν, µi = µ. To make the linearized dynamical equations more compact, we introduce
the 2|E| × 2|E| non-backtracking (NB) matrix with elements
(27)

Bi→j,k→l = δil (1 − δjk ),

which are non-zero if and only if the directed edge i → j
follows right after edge k → l, i.e., in a conﬁguration like
k → l(= i) → j, but edge i → j does not backtrack to
node k [34]. Then Eqs. (26) and (13) can be written in
the matrix form as




ψ(t)
ψ(t + 1)
,
(28)
=J
φ(t)
φ(t + 1)
where the J is the Jacobian matrix of the dynamical
system deﬁned as

J =



(1 − α)(1 − ν)I + αB
βB
(1 − α)νI
(1 − β)(1 − µ)I



, (29)

6
where I is the 2|E|-dimensional identity matrix. The
spectral radius ρ(J ) of the Jacobian J determines the
growth rate of the fastest mode of the linearized dynamics. The appearance of the NB matrix B in the linearized
dynamical equation is rooted in the fact the one-step
backtracking infection is excluded in the DMP equations
(e.g., through Eq. (14)), therefore it also appears in other
algorithms for complex networks based on linearizing belief propagation, such as the applications in community
detection [35] and percolation [36].
B.

Spectral Properties of the Jacobian

The condition that ρ(J ) ≥ 1 corresponds to an exponential growth of the linearized dynamics in Eq. (28),
which implies that the disease is likely to spread out
globally. The solution of ρ(J ) = 1 marks the phase
boundary of the epidemiological parameters. Since the
matrix elements of J are non-negative, the PerronFrobenius theorem asserts that (i) its leading eigenvalue
λmax
(deﬁned as the eigenvalue having the largest real
J
part) equals its spectral radius ρ(J ) and therefore is
real and non-negative; (ii) there exists an eigenvector
with non-negative and nonzero elements corresponding
to λmax
[37].
J
Consider the eigenvalue equation of the Jacobian matrix J
 
 
u
u
,
(30)
= λJ
J
v
v
which can be simpliﬁes to
(1 − α)ν
u,
λJ − (1 − β)(1 − µ)
λJ − (1 − α)(1 − ν)
Bu =
u.
(1−α)ν
α + β λJ −(1−β)(1−µ)
v=

which only depends on the averaged degree hdi, but neglects possible higher order structures of the contact networks. It has long been recognized that the R0 measure
is deﬁcient in network epidemiology [9, 25].
The computation of the leading eigenvalue λmax
can be
B
demanding as the NB matrix is of size 2|E| × 2|E|, which
is a large matrix if the underlying network is relatively
dense. It has been observed that the spectrum of B can
be obtained from a much smaller matrix of size 2N ×
2N [35, 38]


0 D − IN
,
(35)
M=
−IN
A
where IN is the N -dimensional identity matrix, D is the
diagonal matrix of node degrees with elements Dij =
di δij , and A is the adjacency matrix with elements satisfying Aij = 1 if (i, j) ∈ E and Aij = 0 otherwise. Intuitively speaking, the reduction of complexity comes from compressing the edge-based data, e.g.,
φi→j (t) and ψ i→j (t), to node-based data [35] as shown
in Appendix G. This allows us to work with networks of
relatively large sizes.
V.

(31)

A.

(32)



 
(1−α)ν
It implies that λJ −(1−α)(1−ν) / α+β λJ −(1−β)(1−µ)
is an eigenvalue of the NB matrix B with eigenvector u,
denoted as λB . The Perron-Frobenius theorem also guarantees that the leading eigenvalue λmax
of B is real and
B
non-negative. It can be shown that the leading eigenvalue
λmax
is related to λmax
as shown in Appendix E
J
B
λmax
J

to the growth rate given by the commonly used basic reproduction number R0 , deﬁned as the expected number
of secondary cases caused by a single randomly-selected
exposed individual when the rest of the population are
susceptible. In the SEIR model considered here, the R0
is estimated to be (see Appendix F)


α β
R0 = hdi
,
(34)
+
ν
µ


1
= (1 − α)(1 − ν) + (1 − β)(1 − µ) + αλmax
B
2 
2
1
+
(1 − α)(1 − ν) − (1 − β)(1 − µ) + αλmax
B
2
1/2
max
.
(33)
+ 4(1 − α)νβλB

In this way, we relate the dynamical properties of the
SEIR model to the epidemiological parameters and network structure properties, where the latter is subtly conveyed through the eigenvalue λmax
B . This is in contrast

EPIDEMIC THRESHOLD

Determining the Critical Points

Equation (33) gives rise to the epidemic threshold as
predicted by the DMP approach through the solution of
max
max
λmax
=
J (β, α, ν, µ, λB ) = 1, keeping in mind that λJ
ρ(J ).
The same derivation can also be applied to the IBMF
equations, as shown in Appendix G, leading to

1
(36)
(1 − ν) + (1 − µ) + αλmax
A
2
1/2

2
1
,
+ 4νβλmax
(1 − ν) − (1 − µ) + αλmax
+
A
A
2

λmax
J MF =

which relates the maximal eigenvalue λmax
J MF of the JacoMF
bian matrix J
of the IBMF equations in Sec. III A
and the adjacency matrix A of the network. Solving
max
λmax
J MF (β, α, ν, µ, λA ) = 1 yields the epidemic threshold
as predicted by the IBMF approach.
The epidemic thresholds obtained by the two theoretical approaches are to be contrasted with those obtained

7

p
hr2 i − hri2
,
Cr =
hri

(37)

which peaks at the critical point.

B.

Phase Transition in Random Regular Graphs

As an example, we consider random regular graphs of
degree d = 10, where the leading eigenvalues of the matrices A and B have exact expressions as λmax
= d =
A
10, λmax
= d − 1 = 9, irrespective of the network size,
B
as described in Appendix G. We also ﬁx the values of
ν and µ, let α = β/2 and consider the phase transition
by varying β. It is shown in Fig. 4(a) that a signiﬁcant
fraction of the systems nodes are aﬀected by the epidemic
outbreak above the critical point βc . In Fig. 4(b), we pinpoint the critical point βc from MC simulations through
the variability measure Cr , and compare them to those
obtained via the IBMF and the DMP approaches, where
it is observed that the DMP approach provides a much
better estimation. In Appendix G we observed that the
epidemic has a small probability to die out even for large
β, a behavior that also appears in the SIR model [39]
and may impact on the estimation of βc through simulations [28]. This is not captured by the theories which only
consider averaged quantities. It would be an interesting
future direction to study the deviations from the mean
behaviors [40] and possible heterogeneous structures [41].

C.

Phase Diagram of the SEIR Model

We examine the phase diagrams in parameter subspace
spanned by β and α in diﬀerent scenarios via the DMP
approach in Fig. 5. We expect that various social distancing measures eﬀectively reduce β and α, though it
is diﬃcult to quantify the exact reduction due to a particular policy. The critical line separating the parameter
regions of localized infections and global outbreaks, obmax
tained by solving λmax
J (β, α, ν, µ, λB ) = 1 for α, has the
following expression


β(λmax
B



αc (β) =ν
+ µ − 1) − µ /

β(1 − µ)(1 − ν) + βλmax
B (µ + ν − 1)

max
− µ(λB + ν − 1) .
(38)

(a)

(b)

∞)

βc

N = 1600
N = 3200
N = 6400

i

PR (

IBMF
DMP
MC

0.011

1.2

N = 800

0.010
0.009

Cr

/N

N = 400

0.6

10

0.6

0.3

3

N

10

4

i

from numerical simulations, where the large time limit is
taken such that the outbreaks saturate and the ﬁnal state
of each node i is either susceptible or recovered. The fraction of nodes
P that have been infected is an order parameter r = i PRi (∞)/N deﬁning the phase transition from
localized infections to global epidemics. Since statistical
ﬂuctuation is large near criticality, one can estimate the
critical point through the variability measure [39]

0.0
0.000

0.008

0.016

0.0
0.000

0.008

β

β

0.016

Figure 4. Phase transition behavior of the SEIR model in
random regular graphs of degree d = 10. The parameters are
ν = 0.2, µ = 0.125, α = β/2, while λmax
= 10, λmax
= 9.
A
B
The systems are initiated with 5 exposed nodes and are simulated for a sufficiently long time such that every node that
has contracted the disease has recovered. In both (a) and (b),
the three vertical lines correspond to the critical points βc obtained via different approaches, and different lines correspond
to networks of different sizes. In both the IBMF and the DMP
approaches, βc is the same for networks of different sizes as
the degree is fixed. In MC simulation, βc is obtained through
the largest network
P i (N = 6400) considered. (a) Order parameter r =
i PR (∞)/N as a function of β, obtained in
MC simulations.
(b) Variability of the order parameter, i.e.,
p
Cr = hr 2 i − hri2 /hri, as a function of β. Since the variability Cr obtained in simulations (data points in circle markers)
is subject to fluctuations, we apply curve fitting to the experimental data using Gaussian processes with a radial basis
function kernel (the fitted curves are shown in solid lines) [42].
The maximum point of Cr in the fitted curve (diamond-shape
marker) is marked as the critical point obtained from MC simulations. Inset of (b) shows that the critical point βc obtained
in MC simulations approaches the one obtained by the DMP
approach as the network size increases.

While there is no pre-symptomatic transmission in the
SIR model deﬁned by Eqs. (5) and (6), we can compare
with the expression obtained for the critical transmission
probability [28]
βcSIR =

µ
.
λmax
+
µ−1
B

(39)

As a comparison, we sketch the phase boundaries αc (β)
of the SEIR model and β = βcSIR of the SIR model for
in Fig. 5(a). The epidemic will not
certain ν, µ and λmax
B
spread globally when the parameters are in both regions
(I) and (II) in the SIR model. In contrast, the disease
will die out only in region (I) in the SEIR model. Particular caution is needed in region (II), where β is small
enough so that it is safe for the SIR model, but the presymptomatic transmission is suﬃciently signiﬁcant (i.e.,
α > αc (β)) to cause a global epidemic.
Consider the special case α = 0, solving αc (β) = 0
gives
βcSEIR |α=0 =

µ
,
λmax
+
µ−1
B

(40)

which coincides with βcSIR . It indicates that the intersection of the two critical lines occurs at α = 0 (as shown
in Fig. 5(a)) is a general phenomenon. Physically, this

8

ν
,
λmax
+
ν −1
B

(41)

which is eﬀectively the critical point of an SIR model
viewing the state I as “recovered”, as expected. Equations (40) and (41) explain some of the behaviors in
Fig. 5(b)(c)(d), as explained below.
When ν and λmax
are ﬁxed, varying µ will only afB
fect the intersects of the phase boundary on the β-axis
(βcSEIR |α=0 depends on µ) but not the α-axis (αSEIR
|β=0
c
is independent of µ), as seen in Fig. 5(b). Physically,
since diﬀerent values of µ represent diﬀerent recovery
rates, increasing µ can be eﬀectively realized by isolating
all nodes in state I before they recover. If such a policy
can be executed strictly and timely, it corresponds to a
large µ that can signiﬁcantly expand the parameter region of the epidemic-free phase, leaving a lot of ﬂexibility
in implementing social distancing measures (i.e., many
usual social interactions can still be allowed). Nevertheless, if the pre-symptomatic transmission probability α
is large enough, e.g., α > αSEIR
|β=0 , then isolating the
c
patients in state I alone is insuﬃcient to slow down the
spread; in this case, identifying nodes in state E through
contact tracing or mass testing, and/or implementing
stricter social distancing measure become necessary.
Similarly, when µ and λmax
are ﬁxed, varying ν will
B
only impact on the intersects of the phase boundaries
with the α-axis but not those with the β-axis, as seen
in Fig. 5(d). Physically, diﬀerent ν values correspond to
diseases with diﬀerent incubation periods. For smaller
ν, the exposed nodes have a longer time to infect their
neighbors, which makes it more diﬃcult to combat the
epidemic spreading.
Finally, although the phase boundary αc (β) of the
SEIR model is in general nonlinear, the cases considered
in Fig. 5 exhibit an almost linear relation, except for a
very small λmax
B . This can be seen more explicitly in
the limit of large λmax
B , where one of the suﬃcient conditions is that the network has a large average degree (e.g.,
λmax
= d − 1 in random regular graphs), and requires the
B
transmission probability β and α to be small enough for
the disease to die out. Under the condition of large λmax
B
and small β, Eq. (38) can be approximated as
ν(λmax
+ µ − 1)
ν
B
β + max
,
max
µ(λB + ν − 1)
λB + ν − 1
ν
ν
≈ − β + max .
(42)
µ
λB

αc (β) ≈ −

Equation (42) explains that phenomena shown in
is reduced,
Fig. 5(c) that when ν and µ are ﬁxed but λmax
B
the epidemic-free region expands, but the slope of the
phase boundary remains roughly unchanged. Physically,

(b)
0.024

II

0.016

α

α

0.016

0.008

III

0.008

I

0.000
0.000

0.015

0.030

β

(c) 0.08

λBmax = 9
λBmax = 7
λBmax = 5
λBmax = 3

0.06

0.04

0.000
0.00

0.05

β

0.10

(d)

0.15

ν = 0.2
ν = 0.4
ν = 0.8
ν=1

0.024

0.016

0.008

0.02

0.00
0.00

µ = 0.125
µ = 0.25
µ = 0.5
µ=1

0.024

α

αSEIR
|β=0 =
c

(a)

α

special case corresponds to the traditional SEIR model
where the exposed nodes are not infectious, which has
the same epidemic thresholds with the SIR model, irrespective of the incubation period 1/ν.
Similarly, consider the special case β = 0, then

0.05

β

0.10

0.15

0.000
0.000

0.015

β

0.030

Figure 5. Phase diagrams of the SEIR model in the (β, α)plane. In panels (b)(c)(d), the critical lines are obtained by
solving Eq. (38). (a) The parameters used are ν = 0.2, µ =
0.125, λmax
= 9. The phase boundary separating region (I)
B
from the others is given by Eq. (38), while the line separating region (II) and region (III) is β = βcSIR , where βcSIR is
given by Eq. (39). The transmission probabilities β, α can
be reduced by imposing measures such as maintaining social distance and wearing face mask. (b) The parameters
used are ν = 0.2, λmax
= 9. The arrow points to the diB
rection of change in phase boundary due to increasing µ,
which enlarges the disease-free region and can be realized
by identifying and isolating nodes in state I more effectively.
(c) The parameters used are ν = 0.2, µ = 0.125. The arrow points to the direction of change in phase boundary due
to increasing λmax
B , which can be realized by reducing contacts (self-isolation, lock-down). (d) The parameters used are
µ = 0.125, λmax
= 9. Different ν values correspond to diseases
B
with different incubation periods.

reducing λmax
can be achieved by limiting the number of
B
contacts between nodes, as will be shown in Sec. VII.
A similar linear relation of the phase boundary can
be obtained by the condition R0 = 1, where R0 satisﬁes
Eq. (34), yielding
ν
ν
0
,
αR
c (β) = − β +
µ
hdi

(43)

as hdi.
which coincides with Eq. (42) if we identify λmax
B
It turns out that the condition λmax
= hdi holds approxB
imately for Poisson random graphs [43], as will also be
shown in section VII. Therefore, the critical line obtained
via the basic reproduction number is a good estimation in
dense Poisson random graphs, but may become a poor
approximation otherwise.
VI. PREDICTION OF OUTBREAK PROFILE
BY THE NON-BACKTRACKING CENTRALITY

Similar to the eigenvalues, the eigenvectors of the Jacobian matrix also provide valuable information on the

9

PSi (t) − PSi (t + 1) ≈

X

k∈∂i


αψ k→i (t) + βφk→i (t) . (44)

Therefore, we need to consider the incoming vector of the
leading eigenmode ũ
X
ũin
ũk→i ,
(45)
i :=
k∈∂i

which is known as the non-backtracking centrality [43].
Interestingly, in addition to the leading eigenvalue λmax
B ,
the NB centrality ũin can be obtained through the much
smaller matrix M [35] as shown in Appendix G.
Eq. (44), the probability
of newly infection
 onk→i

PBased
k→i
αψ
(t)
+
βφ
(t)
can
be
identiﬁed as the
k∈∂i
incoming vectors of the messages as αψiin (t) + βφin
i (t),
which will be increasingly more aligned with ũin
as
time
i
evolves. Thus, we can use ũin to predict the relative
strengths of the outbreak, indicated by {1 − PSi (t)}. Figure 6(a) demonstrates that, for β large enough, the evolution of correlation coeﬃcient ρ between ũin and the
proﬁle of the outbreak on the WP2015 network generally
increases with time. For small β = 0.002, the correlation
remains low as the disease will die out. For a rather large
β = 0.016, the correlation coeﬃcient ρ increases rapidly
in the initial stage of the development of the spreading,
and then decreases to a lower level. This is because for a
very large β, most nodes are likely to be infected eventually, irrespective of the spatial structure of the network.
As shown in Fig. 6(b), such relation between ρ and β is
also observed in other networks, including a graph generated by a stochastic block model (SBM) and a scale-free
network (SF) with degree exponent γ = 2 (details of the
networks will be discussed in Sec. VII).
Similarly, the IBMF approach dictates that the leading eigenvector of the adjacency matrix A (known as
the eigenvector centrality [43]) is a predictor of the outbreak proﬁle [27]. Comparison between diﬀerent centrality measures is brieﬂy discussed in Appendix D, where

(b)

0.75

0.8
β = 0.002

0.6

0.50

β = 0.004
β = 0.008

0.4

in

in

β = 0.016

0.2
0.0
0

1.00

ρ(ũ , 1 − PS (∞))

1.0

−P

S (t))

(a)

ρ(ũ , 1

dynamics. Consider
P the eigen-decomposition of the Jacobian as J = a λaJ ξ a (ξ −1 )a , and note that the messages can be decomposed
using the eigenvectors as bases,
 P
i.e., ψ(t), φ(t) = a ca (t)ξ a . In light of the linearized
dynamics, the component cmax (t) corresponding to the
max
leading eigenvalue λmax
> 1
J , will dominate when λJ
as the system evolves. Therefore, we can use the leading eigenvector ξ max of the Jacobian J to predict the
outcome ψ(T ), φ(T ) of the dynamics.
According to Eq. (31), the two components of ξ max =
(ũ, ṽ) are proportional to each other, i.e., ṽ ∝ ũ. Thus,
it is suﬃcient to examine one component only. In what
follows, we consider ũ, which is the leading eigenvector
of the NB matrix B according to Eqs. (32) and (33).
Furthermore, we are ultimately interested in the marginal
probabilities, which relate to the incoming messages to
each node as seen in Eq. (11). In the linearized dynamics,
the probability of newly infection of node i is given by

20

40

60

t

80

100

0.25

SBM
SF, γ = 2
WP2015

0.00
0.000

0.006

0.012

β

0.018

Figure 6.
Correlation coefficient ρ between the nonbacktracking centrality uin
i and the outbreak profile, measured
by the probability that each node i has been infected, i.e.,
1 − PSi (t). The parameters are ν = 0.2, µ = 0.125. At time
t = 0, there are 5 initial exposed nodes. (a) Correlation coefficient ρ of the spread on the WP2015 network as a function
of time. (b) Correlation coefficient ρ as a function of β in different networks in the large time limit, where the spreading
processes have saturated. Each data point is averaged over 5
instances with different sets of randomly selected initial exposed nodes.

the NB centrality generally provides a better prediction
than the eigenvector centrality. As was mentioned before, the DMP approach only avoids the eﬀect of mutual
infection due to one-step backtracking, and the approximation accuracy can deteriorate if counteracting the effect of one-step backtracking is insuﬃcient. This is of
particular concern when the NB centrality ũin displays
the localization phenomenon, where the centrality values
of a few nodes are much larger than the others [43, 44]. In
Appendix D we demonstrated the degradation of the approximation power of the DMP equations and the NB
centrality in random networks with a relatively large
planted clique (i.e., a complete subgraph), which possesses the localization property [43]; we also observed a
poor approximation accuracy in one of the contact networks from the SocioPatterns data, recorded in a high
school in 2013 (HS2013) [45], where the NB centrality
ũin is more localized on a few communities.

VII.

EFFECT OF REDUCING CONTACTS

In addition to the social distancing rules that lower
the transmission probabilities β and α, reducing social
contacts between individuals is also an eﬀective measure to slow down the spread of the disease. We examine its eﬀects in the static contact networks considered
here, by removing edges between nodes. Such measure
will change the network structure and reduce the leading
eigenvalue λmax
of the matrix B, which can enlarge the
B
epidemic-free region in the parameter space as shown in
Fig. 5(c). In general, the leading eigenvalue λmax
can
B
depend intricately on the network structure. In the special case of conﬁguration model where the node degrees
follow a given distribution P (d) and the nodes are wired
randomly, it is found in [35, 43] that λmax
can be approxB

10

which already indicates that even in the high degree limit,
the epidemic thresholds obtained by R0 in Eq. (43) do
not generally coincide with those obtained in the DMP
approach in Eq. (42). Speciﬁcally, the second moment
of the degree distribution is also relevant for epidemic
thresholds in uncorrelated random networks [9], which is
not captured by Eq. (43). A more reﬁned approximation
taking into account the relation of degrees of neighboring
nodes is given in [44]. The accuracy of these approximations depends on the validity of the uncorrelated random
network assumption and/or the presence of localization
of NB centrality [44] (see also Appendice G 4).
In Fig. 7(a), Erdős–Rényi (ER) random graphs and
networks generated via a stochastic block model (SBM)
are considered. A network generated by SBM has 4
communities, where each community comprises 50 nodes;
node i in community a is connected to cab nodes of community b on average. Here, we consider cab = 4, ∀a 6= b
and caa = 10, ∀a 6= 1, while diﬀerent values of c11 are
considered. When c11 = 10, all four communities are statistically equivalent, and the node degrees follow a Poisson distribution, similar to the ER random graphs. For
such Poisson random graphs, λmax
≈ hdi according to
B
Eq. (46), which is justiﬁed experimentally by the numerical results of Fig. 7(a). On the other hand, λmax
deviates
B
from hdi in SBM networks with c11 > 0. The networks
become sparser when edges are removed randomly, and
λmax
decreases linearly with hdi. A quasi-linear decreasB
ing trend is also observed in the random edge removal
experiments in contact networks from the SocioPatterns
collaboration as shown in Fig. 7(b), as well as in scalefree networks where the node degrees follow the powerPdmax
law distribution P (d) = d−γ / d=dmin d−γ , as shown in
Fig. 7(c).
In Fig. 7(c), the leading eigenvalues λmax
of scale-free
B
networks can deviate signiﬁcantly from hdi, especially
for more heterogeneous networks with a small γ value.
Therefore, predicting the cause of the spread through
R0 becomes very unreliable in scale-free networks, an effect which has been observed in network epidemiology
studies [9]. Physically, there exist a small number of
hubs (i.e., nodes with very large degrees) in scale-free
networks, which can be viewed as super-spreaders that
signiﬁcantly facilitate the spread of the disease. In light
of this, restricting contacts of these high-degree nodes
preferentially can eﬀectively reduce λmax
as shown in
B
Fig. 7(d), and consequently lower the epidemic thresholds.
VIII.

DISCUSSION AND OUTLOOK

In this work, we studied the SEIR model with presymptomatic transmissions, a feature of the COVID-19

30

λBmax

(46)

(b) 60

SBM, c11 = 30
SBM, c11 = 20
SBM, c11 = 10
ER

40



d

00
(c) 24

16

8

 16

d

00

24

(d) 24

γ=2
γ = 2.5
γ=3
γ = 3.5

d

16

8
0
0

PS2014
HS2013
WP2015
WP2013

d

20

15

λBmax

λmax
B

hd i − hdi
,
≈
hdi

45

λBmax

(a)

2

λBmax

imated as

4

 8

d

20

d

30

γ = 2, i. i. d.
γ = 2, h = 2
γ = 2, h = 4

d

8
0
0

12

10

4

 8

d

12

Figure 7. Leading eigenvalue λmax
of the non-backtracking
B
matrix B vs average degree hdi of the network. The rightmost dot of a curve represents the original network, while
other dots correspond to the networks obtained by removing existing edges while keeping the largest connected component. Edges are removed randomly in panels (a)(b)(c),
while edges adjacent to high-degree nodes are removed preferentially in panel (d). (a) ER random graph and networks
generated through SBM with N = 200. (b) Contact networks extracted from data in the SocioPatterns collaboration, including a network in a primary school (PS2014) [46],
in a high school (HS2013) [45] and workplaces (WP2013,
WP2015) [47, 48]. (c) Scale-free networks generated from the
configuration model. The network size is N = 400 and the
node degree is limited with d < dmax = 100. (d) Scale-free
network with γ = 2 (same as the one in panel (c)). In the
edge removal process, a node i is firstly selected according
dh

to the probability pi = P idh , h > 0, which is biased toward
i i
high-degree nodes; then one of the edges adjacent to node i
is randomly selected and removed. Different fractions of removed edges result in networks of different average degrees
hdi.

disease, in both artiﬁcial and realistic contact networks
through the dynamic message-passing method. The
DMP approach provides a much better approximation
compared to the IBMF approach, while being much less
computational demanding than MC simulations. The linear stability analysis of the DMP equations gives rise to
the epidemic thresholds and phase diagrams of the models, where their dependence on epidemiological parameters and the network structure are elucidated. A larger
pre-symptomatic transmission probability value α leads
to a lower critical point βc , which makes the strategy
of blocking only symptomatic transmission less eﬀective.
We also show that diﬀerent intervention strategies impact
on the epidemic thresholds in diﬀerent manners. The
inﬂuence of network structure on the epidemic thresholds is represented by the leading eigenvalue λmax
of the
B
non-backtracking matrix B, which encodes more subtle
structural information in contrast to the average num-

11
ber of contacts hdi appeared in the basic reproduction
number R0 . Additionally, we demonstrated that the nonbacktracking centrality ũin related to the leading eigenvector of the matrix B can eﬀectively predict the relative
strength of the outbreak.
On the other hand, it is worthwhile mentioning some
limitations of the DMP method. Firstly, as the DMP
approach is based on the decorrelation assumption of the
infection signals, it may become a less accurate approximation when the correlations between trajectories are
non-negligible, which can happen when there is a single
initial exposed node seeding the dynamics and/or there
are many short loops in the network. Secondly, the approximation accuracy of the DMP approach also deteriorates when counteracting one-step backtracking reaction is insuﬃcient to avoid the eﬀect of mutual infection; this eﬀect has been observed in networks where the
non-backtracking centrality exhibits a localization phenomenon as shown in Appendix D. It is an interesting
future direction to further characterize the condition of
non-backtracking centrality localization, its impact on
spreading processes and possible improvements [44].
The theoretical frameworks were mostly applied to
contact networks in some speciﬁc scenarios or those exhibiting particular characteristics, such as the presence
of community structure or high-degree hubs. The ap-

plications in a wider scale (e.g., in a city) require considering additional network characteristics, such as the
mixing pattern of diﬀerent age groups [30], the household structure and so on [49]. Additional states, such as
hospitalized and dead, can also be considered in order to
model the pressure on public-health services and social
cost. Since pre-symptomatic transmissions make it more
diﬃcult to contain the disease by dealing with the symptomatic cases only, an extension of particular interest is
to examine the eﬀectiveness and limitation of (manual or
digital) contact tracing, mass testing and other strategies which can identify exposed individuals that have
not shown symptoms. The DMP equations developed
here will also beneﬁt future works which aim at optimal deployment of resources (e.g., vaccines) to contain
the spread of epidemics with pre-symptomatic transmissions [32, 50].
ACKNOWLEDGMENTS

B.L. and D.S. acknowledge support from European
Union’s Horizon 2020 research and innovation program
under the Marie Skłodowska-Curie grant agreement
No. 835913. D.S. acknowledges support from the EPSRC program grant TRANSNET (EP/R035342/1).

Appendix A: Deriving DMP Equations From Dynamic Belief Propagation
1.

Belief Propagation Equations of Trajectories

In this section, we derive the DMP equations from the principled dynamic belief propagation established in [16].
It is based on the message mi→j (~σi |~σj ), which is the cavity probability of the dynamical trajectory ~σi = [σi0 , ..., σiT ]
(where σit ∈ {S, E, I, R}) of node i in the cavity graph in which node j has been removed. Since the transition between
states is irreversible (only permitted in the order S → E → I → R), the trajectory ~σi can be parametrized by three
transition times (τi , ωi , εi ) as ~σi = |S0 SSEτi EEIωi IIIRεi RRT i.
The dynamic belief propagation for the modiﬁed SEIR model takes the following form
Y
X
mk→i (τk , ωk , εk |τi , ωi , εi ),
(A1)
WSEIR
mi→j (τi , ωi , εi |τj , ωj , εj ) =
{τk ,ωk ,εk }k∈∂i\j

k∈∂i\j

where WSEIR is the transition kernel

WSEIR


= PEi (0)I(τi = 0) + PSi (0)I(τi > 0)
×

τY
i −2


Y
′
′
′
′
1 − αki I(τk ≤ t )I(ωk ≥ t + 1) − βki I(ωk ≤ t )I(εk ≥ t + 1)

t′ =0 k∈∂i



Y
× 1−
1 − αki I(τk ≤ τi − 1)I(ωk ≥ τi ) − βki I(ωk ≤ τi − 1)I(εk ≥ τi )
k∈∂i

×

 ωY
i −2

t′′ =τi

  εY

i −2
Y
(1 − νi ) νi
(1 − µi ) µi I(τi < ωi < εi )
I(τk < ωk < εk ).
t′′′ =ωi

k∈∂i

(A2)

12
The marginal of a trajectory of node i is computed as
X
Y
mi (τi , ωi , εi ) =
WSEIR
mk→i (τk , ωk , εk |τi , ωi , εi ),
{τk ,ωk ,εk }k∈∂i

(A3)

k∈∂i

The cavity probability of a trajectory has the following properties
mi→j (τi , ωi , εi + 1|·) = (1 − µi )mi→j (τi , ωi , εi |·),
1 − νi i→j
m
(τi , ωi , εi |·)I(εi > ωi + 1),
mi→j (τi , ωi + 1, εi |·) =
1 − µi
mi→j (τi , ωi + 1, εi + 1|·) = (1 − νi )mi→j (τi , ωi , εi |·),

(A4)
(A5)
(A6)

where similar relations hold for mi (τi , ωi , εi ). In addition, if τj ≥ τi , we have
mi→j (τi , ωi , εi |τj , ·, ·) = mi→j (τi , ωi , εi |T, ωj , εj ),
2.

∀T ≥ τi .

(A7)

Deriving the Messages and Probability of Being in State S

The cavity probability of node i being in state S at time t is obtained by tracing over the probability of trajectories
mi→j in the cavity graph (assuming node j is absent by setting τj = T ),
PSi→j (t) =

X

τi ,ωi ,εi

I(t < τi < ωi < εi )mi→j (τi , ωi , εi |T, ·, ·),

(A8)

where a similar relation holds between PSi (t) and mi (τi , ωi , εi ).
Using the above deﬁnition, we compute the cavity probability PSi→j (t + 1) as
PSi→j (t + 1) =

X X

X

τi >t+1 ωi >τi εi >ωi

=

mi→j (τi , ωi , εi |T, ·, ·)

X X

X

X

τi >t+1 ωi >τi εi >ωi {τk ,ωk ,εk }k∈∂i\j

Y  X

=PSi (0)

k∈∂i\j

×

t
Y

t′ =0

=:PSi (0)



τk ,ωk ,εk

WSEIR

Y

k∈∂i\j

mk→i (τk , ωk , εk |τi , ωi , εi )

I(τk < ωk < εk )mk→i (τk , ωk , εk |T, ·, ·)


1 − αki I(τk ≤ t′ )I(ωk ≥ t′ + 1) − βki I(ωk ≤ t′ )I(εk ≥ t′ + 1)

Y

θk→i (t + 1),

(A9)

k∈∂i\j

Q
Q
where we have replaced k∈∂i\j mk→i (τk , ωk , εk |τi , ωi , εi ) in the second line by k∈∂i\j mk→i (τk , ωk , εk |T, ·, ·) (a
property imposed by the transition kernel and Eq. (A7)) and traced over the τi , ωi , εi [16]; the message θk→i (t + 1) is
deﬁned as
θk→i (t + 1) :=

X

τk ,ωk ,εk

×

I(τk < ωk < εk )mk→i (τk , ωk , εk |T, ·, ·)


t 
Y
1 − αki I(τk ≤ t′ )I(ωk ≥ t′ + 1) − βki I(ωk ≤ t′ )I(εk ≥ t′ + 1) ,

(A10)

t′ =0

which has the physical meaning of the cavity probability that node k (in either exposed or infected state) has not
transmitted the infection signal to node i up to time t + 1. In order to eliminate the explicit dependence on the
microscopic trajectories, we compute the iteration scheme of θk→i (t + 1) as

13

θk→i (t + 1) − θk→i (t) =

X

τk ,ωk ,εk

×
×

t−1
Y

t′ =0



I(τk < ωk < εk )mk→i (τk , ωk , εk |·)



′
′
′
′
1 − αki I(τk ≤ t )I(ωk ≥ t + 1) − βki I(ωk ≤ t )I(εk ≥ t + 1)


− αki I(τk ≤ t)I(ωk ≥ t + 1) − βki I(ωk ≤ t)I(εk ≥ t + 1)

=: − αki ψ k→i (t) − βki φk→i (t),
(A11)


t−1
Y
X
k→i
′
′
′
′
φ
(t) :=
I(τk < ωk < εk )
1 − αki I(τk ≤ t )I(ωk ≥ t + 1) − βki I(ωk ≤ t )I(εk ≥ t + 1)
t′ =0

τk ,ωk ,εk

k→i

(τk , ωk , εk |·)I(ωk ≤ t)I(εk ≥ t + 1),
(A12)


t−1
Y
X
k→i
′
′
′
′
ψ
(t) :=
I(τk < ωk < εk )
1 − αki I(τk ≤ t )I(ωk ≥ t + 1) − βki I(ωk ≤ t )I(εk ≥ t + 1)
×m

t′ =0

τk ,ωk ,εk

×m

k→i

(τk , ωk , εk |·)I(τk ≤ t)I(ωk ≥ t + 1)

t−1
Y
X
′
=
I(τk < ωk < εk )
1 − αki I(τk ≤ t ) mk→i (τk , ωk , εk |·)I(τk ≤ t)I(ωk ≥ t + 1),
t′ =0

τk ,ωk ,εk

(A13)

where we have introduced the message φk→i (t) (the cavity probability that k is in state I but has not transmitted
the infection signal) and ψ k→i (t) (the cavity probability that k is in state E but has not transmitted the infection
signal).
The message φk→i (t) is computed as

φk→i (t) ==

X

I(τk < ωk < εk )

t−2
Y



1 − αki I(τk ≤ t′ )I(ωk ≥ t′ + 1) − βki I(ωk ≤ t′ )I(εk ≥ t′ + 1)

t−2
Y



′
′
′
′
1 − αki I(τk ≤ t )I(ωk ≥ t + 1) − βki I(ωk ≤ t )I(εk ≥ t + 1)

t′ =0

τk ,ωk ,εk



× 1 − αki I(τk ≤ t − 1)I(ωk ≥ t) − βki I(ωk ≤ t − 1)I(εk ≥ t)


× mk→i (τk , ωk , εk |·) I(ωk ≤ t − 1)I(εk ≥ t + 1) + I(εk ≥ t + 1)δωk ,t
=

X

I(τk < ωk < εk )

t′ =0

τk ,ωk ,εk


× mk→i (τk , ωk , εk |·) 1 − βki I(ωk ≤ t − 1)I(εk ≥ t + 1)

t−2
Y
X
 k→i
′
+
I(τk < t < εk )
1 − αki I(τk ≤ t ) m
(τk , t, εk |·) 1 − αki I(τk ≤ t − 1)
t′ =0

τk ,εk

k→i

=(1 − βki )(1 − µk )φ

(t − 1) +

X

I(τk < t < εk )

τk ,εk

t−1
Y

t′ =0

where the second term in the last line needs to be simpliﬁed.
To proceed further, we ﬁrst compute the update rule of ψ k→i (t) as



′
1 − αki I(τk ≤ t ) mk→i (τk , t, εk |·),

(A14)

14

X

ψ k→i (t) =

I(τk < ωk < εk )

t−2
Y

t′ =0

τk ,ωk ,εk



1 − αki I(τk ≤ t′ )





× 1 − αki I(τk ≤ t − 1) mk→i (τk , ωk , εk |·) I(τk ≤ t − 1)I(ωk ≥ t + 1) + δτk ,t I(ωk ≥ t + 1)
= (1 − αki )
×m

k→i

X

I(τk < ωk < εk )

t−2
Y

t′ =0

τk ,ωk ,εk



1 − αki I(τk ≤ t′ )

(τk , ωk , εk |·)I(τk ≤ t − 1)I(ωk ≥ t + 1) +

′
let ωk =ωk
+1,εk =ε′k +1

X

ωk ,εk

I(t < ωk < εk )mk→i (t, ωk , εk |·)

===============⇒
= (1 − αki )

X

I(τk < ωk′ < ε′k )

′ ,ε′
τk ,ωk
k

t−2
Y

t′ =0



1 − αki I(τk ≤ t′ )

× (1 − νk )mk→i (τk , ωk , εk |·)I(τk ≤ t − 1)I(ωk′ ≥ t) +
= (1 − αki )(1 − νk )ψ

k→i

= (1 − αki )(1 − νk )ψ

k→i

We observed that the message ψ
ψ k→i (t) =

k→i

(t − 1) +

X

ωk ,εk

X

ωk ,εk

I(t < ωk < εk )mk→i (t, ωk , εk |·)

I(t < ωk < εk )mk→i (t, ωk , εk |·)


(t − 1) − PSk→i (t) − PSk→i (t − 1) .

(A15)

(t) can also be expressed in another form

X

I(τk < ωk < εk )

t−2
Y

t′ =0

τk ,ωk ,εk




1 − αki I(τk ≤ t′ )



× 1 − αki I(τk ≤ t − 1) mk→i (τk , ωk , εk |·)


× I(τk ≤ t − 1)I(ωk ≥ t) + δτk ,t I(ωk ≥ t) − δωk ,t I(τk ≤ t − 1)
X

I(t < ωk < εk )mk→i (t, ωk , εk |·)
= 1 − αki ψ k→i (t − 1) +
ωk ,εk

−

X

I(τk < t < εk )

t−1
Y

t′ =0

τk ,εk



1 − αki I(τk ≤ t′ ) mk→i (τk , t, εk |·)



= 1 − αki ψ k→i (t − 1) − PSk→i (t) − PSk→i (t − 1)

t−1
Y
X
−
I(τk < t < εk )
1 − αki I(τk ≤ t′ ) mk→i (τk , t, εk |·),

(A16)

t′ =0

τk ,εk

Comparing Eq. (A15) and Eq. (A16) yields
X

τk ,εk

I(τk < t < εk )

t−1
Y

t′ =0


1 − αki I(τk ≤ t′ ) mk→i (τk , t, εk |·) = (1 − αki )νk ψ k→i (t − 1),

(A17)

Inserting Eq. (A17) into Eq. (A14) gives the update rule of φk→i (t)

φk→i (t) = (1 − βki )(1 − µk )φk→i (t − 1) + (1 − αki )νk ψ k→i (t − 1),

(A18)

which closes the update rules of the messages θi→j , φi→j , ψ i→j and PSi→j . Collecting the incoming messages to node
i gives rise to the marginal probability of node i being in state S
Y
PSi (t) = PSi (0)
θk→i (t).
(A19)
k∈∂i

15
Probabilities of Being in State E, I, R

3.

Finally, we consider the marginal probabilities of node i in state E, I, R, deﬁned as

PEi (t) =

X

I(τi ≤ t < ωi < εi )mi (τi , ωi , εi ),

(A20)

I(τi < ωi ≤ t < εi )mi (τi , ωi , εi ),

(A21)

X

I(τi < ωi < εi ≤ t)mi (τi , ωi , εi ),

(A22)

X

I(τi < ωi < εi ≤ t + 1)mi (τi , ωi , εi )

τi ,ωi ,εi

PIi (t) =

X

τi ,ωi ,εi

PRi (t) =

τi ,ωi ,εi

We ﬁrst compute
PRi (t + 1) =

τi ,ωi ,εi

= PRi (t) +

X

τi ,ωi

I(τi < ωi ≤ t)mi (τi , ωi , t + 1),

(A23)

and notice that

(1 − µi )PIi (t) = (1 − µi )
X

=

τi ,ωi ,εi

X

τi ,ωi ,εi

I(τi < ωi ≤ t < εi )mi (τi , ωi , εi )

I(τi < ωi ≤ t < εi )mi (τi , ωi , εi + 1)

let ε′ =εi +1

====i====⇒
X
=
I(τi < ωi ≤ t < ε′i − 1)mi (τi , ωi , ε′i )
τi ,ωi ,ε′i

X 

=

τi ,ωi ,ε′i

= PIi (t) −
µi PIi (t) =

X

τi ,ωi


I(τi < ωi ≤ t < ε′i ) − δε′i ,t+1 I(τi < ωi ≤ t) mi (τi , ωi , ε′i )
X

τi ,ωi

I(τi < ωi ≤ t)mi (τi , ωi , t + 1),

I(τi < ωi ≤ t)mi (τi , ωi , t + 1),

(A24)
(A25)

where we have made use of the property Eq. (A4). Inserting Eq. (A25) into Eq. (A23) gives rise to
PRi (t + 1) = PRi (t) + µi PIi (t).

(A26)

Similarly, we compute
PIi (t + 1) =

X

τi ,ωi ,εi

I(τi < ωi ≤ t + 1 < εi )mi (τi , ωi , εi ),

= (1 − µi )PIi (t) +
and make use of the property Eq. (A6) to compute

X

τi ,εi

I(τi ≤ t)I(εi > t + 1)mi (τi , t + 1, εi ),

(A27)

16

(1 − νi )PEi (t) = (1 − νi )
=

X

τi ,ωi ,εi

X

τi ,ωi ,εi

I(τi ≤ t < ωi < εi )mi (τi , ωi , εi )

I(τi ≤ t < ωi < εi )mi (τi , ωi + 1, εi + 1)

let ωi′ =ωi +1,ε′i =εi +1

==============⇒
X
=
I(τi ≤ t < ωi′ − 1)I(ωi′ < ε′i )mi (τi , ωi′ , ε′i )
τi ,ωi′ ,ε′i


X 
′
I(τi ≤ t < ωi ) − δωi′ ,t+1 I(τi ≤ t) I(ωi′ < ε′i )mi (τi , ωi′ , ε′i )
=
τi ,ωi′ ,εi

= PEi (t) −
νi PEi (t) =

X

τi ,εi

X

τi ,ε′i

I(τi ≤ t)I(εi > t + 1)mi (τi , t + 1, ε′i ),

I(τi ≤ t)I(εi > t + 1)mi (τi , t + 1, εi ).

(A28)
(A29)

Inserting Eq. (A29) into Eq. (A27) gives rise to
PIi (t + 1) = (1 − µi )PIi (t) + νi PEi (t).

(A30)

Upon obtaining PSi (t + 1), PIi (t + 1), PRi (t + 1), the probability PEi (t + 1) is given by the normalization condition
PEi (t + 1) = 1 − PSi (t + 1) − PIi (t + 1) − PRi (t + 1),

(A31)

which closes the DMP equations.
Appendix B: Modeling Asymptomatic Transmission

As for the COVID-19 epidemic, there is a relatively small number of patients who remain asymptomatic prior
to recovery. Here, we discuss how to accommodate potential disease transmissions due to having asymptomatic
individuals in our framework. Patients who do not exhibit symptoms at the time of exposure but developed symptoms
at a later time are termed pre-symptomatic as described in the main text. There are many possible scenarios to model
asymptomatic infections. One example is that each individual has a certain probability to become either asymptomatic
or pre-symptomatic upon contracting the virus, in which case an additional asymptomatic state is required to model
such stochastic transitions. The DMP equations can be derived accordingly, but will diﬀer from those in this study.
Another perspective is based on the observation that whether an exposed individual will develop symptoms not seems
to vary from person to person, based on age and pre-existing medical condition, e.g., children are more likely to have
mild or no symptoms [23]. In light of this, one can assign each node i a label ℓi (either probabilistically or according
to additional existing information information), such that ℓi = 1 if the individual is expected to develop symptoms
when exposed and ℓi = 0 otherwise. Nodes with diﬀerent labels may have diﬀerent epidemiological parameters. The
disease transmission dynamics still obeys the transition rules of Sec. II, and the DMP equations in Sec. III B also
apply. The only diﬀerence is that when a node i is in state I, one should interpret it as infected with symptoms if
ℓi = 1, or asymptomatic if ℓi = 0. In this way, our theoretical framework can readily accommodate asymptomatic
transmission, except that a weighted-version of non-backtracking is needed to accommodate diﬀerent characteristics
of symptomatic and asymptomatic individuals.
Appendix C: Contact Networks
1.

Realistic Networks

The realistic contact networks are taken from data sets obtained from the SocioPatterns collaboration website [31],
where the face-to-face contacts were recorded through wearable sensors over a certain period. Each data set contains
a lists of active contacts between two individuals lasting for 20 seconds and the membership information of each

17
individual (belonging to a class or department). To build the contact network, we ﬁrst aggregate the contacts
between any two individuals i and j, and consider the link between node i and node j as active if the cumulative
contact duration between them in the recording period is not less than 60 seconds. A more precise treatment is to
retain the information of contact duration in the transmission probabilities βji , αji . However, this results in a graph
with a weighted non-backtracking (NB) matrix, which complicates the analysis. For simplicity, we only preserve the
topological information of the resulting networks, keeping in mind that the contact duration information can also be
incorporated in our framework. In this work, we consider contact networks in a primary school (PS2014) [46], a high
school (HS2013) [45] and workplaces (WP2013, WP2015) [47, 48].
2.

Artificial Networks

Artiﬁcially generated networks are also considered in this work, including Erdős–Rényi (ER) random graphs, random
networks with community structures, scale-free networks and random networks with planted subgraph structures.
a.

Random Networks with Community Structure

Random networks with community structures are generated through the stochastic block model. It is speciﬁed by a
list of population of each block (n1 , n2 , ..., nr ) and a r × r symmetric probability matrix Pab , where r is the number of
blocks. Suppose node i is assigned to block a and node j is assigned to block b, then node i and node j are connected
with probability Pab . The average number of neighbors of node i (assigned to block a) belonging to block b is given
by
(
Paa (na − 1) if a = b,
cab =
(C1)
Pab nb
otherwise.
b.

Scale-free Networks

The scale-free networks are generated through the conﬁguration model. We ﬁrst generate a degree sequence
(d1 , d2 , ..., dN ) of size N where each element follows the power law distribution
d−γ
P (di ) = Pdmaxi

dj =dmin

d−γ
j

,

(C2)

where dmin and dmax are the minimum and maximum of the admissible degrees. In this study, we set dmin = 5 and
dmax = 100, considering the maximal number of people that one contacts can not be arbitrarily large. After assigning
a degree to each node, we randomly connect diﬀerent nodes such that each node i has di connections. The resulting
graph may have a few self-loops and multiple edges between two nodes, which are simply removed to form a simple
graph.
c.

Random Networks with Planted Subgraph Structures

We also look at random networks with planted subgraph structures, primarily for the purpose of examining the
eﬀect of localization. Following [43], we consider the ER random graph (with average degree hdi) with a planted hub
(of degree dh ), which is constructed by adding a hub to the existing ER network through creating connections from the
hub to dh randomly selected nodes. When dh is large enough, i.e., dh > hdi(hdi + 1), it is argued that the eigenvector
centrality (i.e., the leading eigenvector of the adjacency matrix) is localized at the hub, while the non-backtracking
centrality does not suﬀer from localization [43]. The intuition behind the localization of eigenvector centrality is that
the hub and its neighbors are reinforcing each other, similar to the mutual infection eﬀect of the IBMF approach to
epidemic spreading. The NB centrality avoids this problem due to the hub by forbidding one-step backtracking.
On the other hand, it is noticed in [43] that a relatively large clique (i.e., a complete subgraph) can cause the NB
centrality to localize as well. Therefore, we consider the ER random graph (with average degree hdi) with a planted
clique (of size Nclique ), which is constructed by randomly selecting Nclique nodes of the existing ER network to form
a complete subgraph. For the original ER graph, the leading eigenvalue of the NB matrix B is given by λmax
≈ hdi.
B

18

30

60
t

90

8
00

i

i

16

PI (t)]

24

(c) 40

[PE (t) +

32

RRG, no. of seeds = 2
IBMF
DMP
MC

i

8
00

i

i

16

PI (t)]

24

(b) 40

[PE (t) +

32

RRG, no. of seeds = 1
IBMF
DMP
MC

i

i

i

[PE (t) +

i

PI (t)]

(a) 40

30

60

90

32
24

RRG, no. of seeds = 5
IBMF
DMP
MC

16
8
00

30

t

60

90

t

P
Figure 8. Evolution of the average number of individuals in state E or I, i.e., i [PEi (t) + PIi (t)] vs t. The underlying network is
a random regular graph with N = 100, d = 10. The parameters are T = 100, ν = 0.2, µ = 0.125, β = 0.03, α = β/2. The initial
exposed nodes are randomly selected. (a) One initial exposed node. (b) Two initial exposed nodes. (a) Five initial exposed
nodes. In general, when there are more initial seeds, the approximation accuracy of the theory becomes better.

In the presence of the clique, the leading eigenvalue satisﬁes λmax
> Nclique − 2, which can easily exceed hdi for
B
large Nclique , so that the NB centrality is dictated by the clique [43]. There are also other subgraph structures that
can cause the NB centrality to localize, such as dense subgraphs and overlapping hubs [44]. The intuition behind
the localization of the NB centrality is that there is a subgraph sharing many neighbors, and avoiding one-step
backtracking is insuﬃcient to counteract the self-reinforcement among them.

Appendix D: Additional Experiments
1.

Approximation Accuracy of the Theory on Different Networks

In this section, we give more examples of spreading processes experiments to support the ﬁndings in the main text.
In Fig. 8, it is shown that the approximation accuracy of the theories improves as the number of initial exposed nodes
increases; we expect that it also depends on the locations of the initial seeds.
In Fig. 9, we examine the theoretical results on ER random networks with diﬀerent average degrees and/or diﬀerent
planted subgraph structures. We remark that there is no absolute fair comparison among diﬀerent networks, as they
have diﬀerent dependencies on the epidemiological parameters (e.g., as in Fig. 3 of the main text). Here, we ﬁx the
values of ν, µ and let α = β/2, and choose β such that approximately 70% of the population have contracted the
disease in the ﬁnal time T = 100. Fig. 9 demonstrates that the IBMF approach becomes a better approximation when
the network is denser. This implies that the DMP approach is superior to the IBMF approach, especially in sparsely
connected networks. When the average degree becomes higher, the trajectories obtained by the IBMF equations is
approaching those by the DMP equations. In the limit of very dense random network, the mass-action approximation
becomes a good approximation [9]. As mentioned before, a planted hub of relatively large degree can cause the leading
eigenvector of the adjacency matrix A to localize [43], which impairs the accuracy of the IBMF approach. We show
in Fig. 9(b) that such a planted hub does not have a noticeable eﬀect on the approximation accuracy of the DMP
approach. However, a planted clique which can cause the non-backtracking centrality to localize [43, 44], does impair
the approximation accuracy of the DMP approach as shown in Fig. 9(c).
In Fig. 9, we examine the theories on the networks extracted from contact data obtained in the SocioPatterns
collaboration. The approximation accuracy of the HS2013 network is much poorer than the other networks, which
may be attributed to the weakly localization of the non-backtracking centrality as shown in Fig. 13.

2.

Evolution and Distribution of the Epidemic Outbreak

P
In Fig. 4 of the main text, the normalized outbreak size at large time r = i PRi (∞)/N was used to identify the
critical point βc of the SEIR model. In Fig. 11(a), we show the transient evolution
of the normalized outbreak size,
P
which is deﬁned by the fraction of nodes that has contracted the disease as 1 − i PSi (t)/N . The normalized outbreak
size increases only gently near criticality, while it grows rapidly above the critical point βc .
As the epidemic outbreaks are triggered by a few initial seeds, there is always a small probability that the disease
will die out before spreading out further (e.g., the infected node transforming into state R much faster than average,
or the infection signal not being transmitted to neighbors). This can also happen when β > βc , indicating that there

60

40

ER(

d

10)

IBMF
DMP
MC

20

(e) 40

i

30

60

d

60

IBMF
DMP
MC

 ≈

30

t

ER(

d

16
8
30

60

 ≈

90

t

20)

(f) 40

24

00

90

5

15
00

90

32

i

10
30

  ≈ ) + clique

ER(

t

30

00

30

[PEi (t) + PIi (t)]

 ≈

15
00

90

[PEi (t) + PIi (t)]

(d)

45

IBMF
DMP
MC
60

i

30

(c) 60

i

IBMF
DMP
MC

t

[PEi (t) + PIi (t)]

5

i

15
00

i

d

i

30

  ≈ ) + hub

ER(

PI (t)]

45

i

i

i

IBMF
DMP
MC

(b) 60

[PE (t) +

5

i

d

PI (t)]

 ≈ )

ER(

[PE (t) +

30

i

PI (t)]

45

[PE (t) +

(a) 60

19

90

t

ER(

d

40)

32
24
16
8
00

30

IBMF
DMP
MC
60

90

t

P i
i
Figure 9.
i [PE (t) + PI (t)] vs t. The networks are ER random graphs of size N = 200 with different average degrees and/or
different planted subgraph structures. The systems start with 5 initial exposed nodes. The parameters are T = 100, ν =
0.2, µ = 0.125, α = β/2, while β is selected such that in the final time T = 100, there are approximately 70% of the population
that have contracted the disease. Comparing panels (a)(d)(e)(f), it is observed that the IBMF approach becomes a better
approximation when the network is denser (i.e., hdi is larger). In panel (b), a planted hub of degree dh = 40 is created in
the networks; the DMP approach is still a rather good approximation in this case. In panel (c), a planted clique (or complete
subgraph) of size Nclique = 20 is created in the networks; the approximation accuracy of the DMP approach is comparable
poorer than other networks.

are some instances where the outbreak size is small although the system is in the global-epidemic phase, as shown in
Fig. 11(b). This phenomenon has been observed in the SIR model [28, 39]. While the theoretical frameworks only
concern the average behaviors, they do not capture such variability of trajectories due to stochastic ﬂuctuations. A
detailed theoretical investigation into these aspects will be an interesting topic for future studies.

3.

Non-backtracking Centrality

As mentioned in the main text and in Sec. D 1, the degradation in accuracy of the approximation of the theory
(IBMF or DMP method) is correlated with the localization phenomenon of the corresponding centrality measure,
where the centrality values of a few nodes are much larger than the others. We have showcased this in Fig. 9
by considering some planted subgraph structures in a random network. We further examine the prediction of the
centrality measures on the outbreak proﬁles in these planted random networks. In Fig. 12(a), it is shown that in
the ER graph, both the eigenvector centrality and the NB centrality (coming from the linear approximation of the
IBMF and DMP approaches), as well as the degree, are good predictors of the outbreak proﬁle, despite the poor
approximation of the full nonlinear IBMF approach in Fig. 9(a). On the other hand, a planted hub causing the
eigenvecter centrality to localized, degrades its prediction accuracy as shown in Fig. 12(b), while the NB centrality
appears to be a much better predictor. In the presence of a clique, the NB centrality also predicts the outbreak poorly
as shown in Fig. 12(c) due to the localization phenomenon.
In all three cases, the degree appears to be a good predictor of the outbreak proﬁle; in random networks, having
more neighbors usually implies a higher chance to contract the disease. However, this does not hold in general, e.g.,
consider a hub connected to many dangling nodes but linked to the bulk of the network through only a few edges,
such a hub node is not likely to be at high risk as indicated by its degree.
It has been shown in Fig. 10 that the approximation accuracy of the HS2013 network is much poorer than the other
networks from the SocioPatterns data sets. In Fig. 13, we show the NB centralities on the corresponding networks.
Comparing to other networks, the NB centrality ũin of HS2013 concentrates on two communities, which may cause
the approximation of the DMP equations to be less accurate.

20
WP2013

i

15

PI (t)]

20

i

10
5
00

30

WP2015

(b)

IBMF
DMP
MC

i

i

i

[PE (t) +

i

PI (t)]

25

[PE (t) +

(a)

60

40

IBMF
DMP
MC

30
20
10
00

90

30

t

PS2014

(d)

90

30

60
40

i

40

IBMF
DMP
MC

i

20

HS2013

80

PI (t)]

IBMF
DMP
MC

10

i

i

i

[PE (t) +

i

PI (t)]

50

[PE (t) +

(c)

60
t

00

30

60

20
00

90

30

t

60

90

t

P i
i
Figure 10.
i PE (t) + PI (t) vs t. The networks are extracted from contact data obtained in the SocioPatterns collaboration.
The systems start with 5 initial exposed nodes. The parameters are T = 100, ν = 0.2, µ = 0.125, α = β/2, while β is selected
such that in the final time T = 100, there are approximately 70% of the population that have contracted the disease. The
approximation accuracy of the HS2013 network is much poorer than the other networks.

β = 0.01

0.09

β = 0.013

relative frequency

(b)10-1

0.12

10-2

β = 0.0115

10-3

1−

i

i

PS (t)/N

(a)

0.06

10-4

β = 0.01
β = 0.0115
β = 0.013

10-5

0.03

0.00
0

100

200

300

400

10-6

500

t

101

102
103
outbreak size

Figure 11. Evolution and distribution of the epidemic outbreak on a random regular graph with N = 6400, d = 10 in MC
simulation. The systems start with 5 initial exposed nodes. The parameters are ν = 0.2, µ = 0.125,
Pα = β/2. The critical point
is given by βc ≈ 0.0115. (a) Fraction of nodes that has contracted the disease, defined as 1 − i PSi (t)/N , as a function of
P i
time. (b) Distribution of outbreak size at large time, i.e., i PR (∞).

0.25

ũ in

eig(A)
degree

0.00
20

40

60
t

80

100

ρ(centrality, 1

ρ(centrality, 1

0.50

0



ER(

d=5

) + hub

(c)

0.75

−P

0.75

1.00

S (t))

(b)

0.50
ũ in

0.25
0.00
0

1.00



ER(

d=5

) + clique

0.75

−P

)

S (t))

d=5

eig(A)
degree

20

40

60
t

80

100

ρ(centrality, 1



ER(

1.00

−P

S (t))

(a)

0.50
ũ in

0.25
0.00
0

eig(A)
degree

20

40

60

80

100

t

Figure 12. Correlation coefficient ρ between various centrality measures and the outbreak profile 1 − PS (t), as a function of
time. Here, eig(A) stands for the eigenvector centrality and ũin is the NB centrality. The networks and the parameter settings
correspond to those in Fig. 9(a)(b)(c).

21
(a)

WP2013

(b)

WP2015

(c)

PS2014

(d)

HS2013

Figure 13. NB centrality ũin of contact networks from the SocioPatterns data. The marker size of node i is proportional to
the NB centrality value ũin
i .

Appendix E: Additional Details on The Derivation of Epidemic Threshold
1.

Perron-Frobenius Theorem

For a non-negative matrix X which satisﬁes Xij ≥ 0, the Perron-Frobenius (PF) theorem asserts that (i) the
spectral radius ρ(X) is an eigenvalue of X, which implies that the leading eigenvalue of X (deﬁned as the eigenvalue
having the largest real part) satisﬁes λmax
= ρ(X), which is real and non-negative; (ii) there is a nonnegative and
X
nonzero vector u (satisfying ui ≥ 0, u 6= 0) such that Xu = ρ(X)u; more properties of the leading eigenvalue and
eigenvector can be deduced if the matrix X is irreducible [37].

2.

Leading Eigenvalue of the Jacobian of the DMP Equations

In the main text, we have shown that the eigenvalue of the Jacobian J and the eigenvalue of the non-backtracking
matrix has the relation
λB =

λJ − (1 − α)(1 − ν)
(1−α)ν
α + β λJ −(1−β)(1−µ)

,

which can be solved for λJ , leading to

1
±
λJ = (1 − α)(1 − ν) + (1 − β)(1 − µ) + αλB
2

q
2
±
(1 − α)(1 − ν) − (1 − β)(1 − µ) + αλB + 4(1 − α)νβλB .

(E1)

(E2)

From this relation, one can ﬁgure out the principal eigenvalue of J . Noticing that λmax
= ρ(J ) ≥ 0, λmax
= ρ(B) ≥ 0
J
B
+
due to the Perron-Frobenius theorem, we can focus on λJ and λB ∈ R since the eigenmode with a fastest growth rate
will not be realized by negative or complex eigenvalue of J . We also assume that ρ(J ) and ρ(B) are non-zero. To

22
simplify the notation,
denote a = (1 − α)(1 − ν), b = (1 − α)ν,

 c = (1 − β)(1 − µ), all of which are nonnegative, such
p
+
that λJ (λB ) = 21 a + c + αλB + (a − c + αλB )2 + 4bβλB . We ﬁrst consider the case λB > 0


dλ+
(a − c + αλB ) + 2bβ
α
J
α
1+ p
=
dλB
2
(a − c + αλB )2 + 4bβλB


(a − c + αλB )
α
1+ p
>
2
(a − c + αλB )2 + 4bβλB
> 0,

where we have made use of the fact that

2bβ
α

(a−c+αλB )
(a−c+αλB )2 +4bβλB

> 0 and √

(E3)

< 1 by assuming λB > 0. It implies that

+
+
+
max
maxλB >0 λ+
J (λB ) = λJ (λB ). Furthermore, it can be easily shown that λJ (x) ≥ λJ (−x) for x ≥ 0, which leads to
+
+
+
max
the fact that ∀λB < 0, λJ (λB ) < λJ (|λB |) < λJ (λB ). Hence, we can conclude that the maximal eigenvalue of J is
max
given by λmax
= λ+
J
J (λB ), i.e.,

λmax
=
J


1
(1 − α)(1 − ν) + (1 − β)(1 − µ) + αλmax
B
2 q
2
1
+
(1 − α)(1 − ν) − (1 − β)(1 − µ) + αλmax
+ 4(1 − α)νβλmax
B
B .
2

(E4)

max
The epidemic threshold is obtained by solving λmax
J (β, α, ν, µ, λB ) = 1.

3.

Epidemic Threshold by the IBMF Approach

Similar to the DMP approach, we can also derive the epidemic thresholds through the individual-based mean-ﬁeld
(IBMF) approach. The initial disease-free state is perturbed inﬁnitesimally as PSi (0) = 1 − ǫi , in which case the
probabilities PEi (t) and PIi (t) are also of order ǫi in the initial stage. We expand Eq. (8) and neglect terms of higher
order of ǫi , leading to
X

PEi (t + 1) ≈ (1 − νi )PEi (t) + PSi (t)
αki PEk (t) + βki PIk (t) .
(E5)
k∈∂i

Equations (E5) and (9) constitute a linear dynamical system of the probabilities {PEi (t), PIi (t)}. They can be written
in the matrix form as




PE (t)
PE (t + 1)
MF
,
(E6)
=J
PI (t)
PI (t + 1)
where the 2N × 2N Jacobian matrix J MF is deﬁned as


(1 − ν)I + αA
βA
MF
,
J
=
νI
(1 − µ)I

(E7)

where I is the identity matrix and A is the adjacency matrix of the graph. The spectral radius ρ(J MF ) determines
the growth rate of the fastest mode of Eq. (E6). Due to the Perron-Frobenius theorem, ρ(J MF ) equals the leading
MF
eigenvalue λmax
, which is related to the leading eigenvalue λmax
of the adjacency matrix of the graph. A
A
J MF of J
similar argument as in the DMP approach results in
λmax
J MF =


1
(1 − ν) + (1 − µ) + αλmax
A
2 q
2
1
+
(1 − ν) − (1 − µ) + αλmax
+ 4νβλmax
A
A .
2

max
The epidemic threshold is obtained by solving λmax
J MF (β, α, ν, µ, λA ) = 1.

(E8)

23
Appendix F: Basic Reproduction Number of The SEIR Model

In this appendix, we provide a simple estimation of the basic reproduction number R0 for the SEIR model under
investigation, which is deﬁned as the expected number of secondary infections from a single infection in a population
where all subjects are susceptible. We assume at time t = 0, a node randomly chosen from the network is exposed to
the virus. The exposed node has hdi susceptible neighbors on average; the average number of neighbors it infects is
computed as

t
∞ 
X
X
(1 − ν)t−1 α +
(1 − ν)ω−2 ν(1 − µ)t−ω β ,
(F1)
R0 = hdi
ω=2

t=1

where ω is the time that the initial exposed node turns into the infectious state and we have assumed that at the
same step, the process E → I or I → R occurs after the infection being transmitted. The above expression can be
simpliﬁed as



1−ν t−1
t−2


(1
−
µ)
1
−
∞
1−µ
X
t−1
(1 − ν) α +
νβ
R0 =hdi
1−ν
1 − 1−µ
t=1

∞ 
X
(1 − µ)t−1 − (1 − ν)t−1
t−1
νβ
(1 − ν) α +
=hdi
ν −µ
t=1



α
1
νβ
1
=hdi
+
−
ν
ν −µ µ ν


α β
.
(F2)
+
=hdi
ν
µ
The R0 deﬁned in this way only captures the average number of contacts through hdi, but neglects higher order
structures of the contact networks which could be very heterogeneous.
Appendix G: The Leading Eigenvalue and Eigenvector of Matrix B
1.

Reduction from Matrix B to Matrix M

In the main text, we claimed that the spectrum of the 2|E| × 2|E| non-backtracking matrix can be obtained from a
much smaller 2N × 2N matrix M deﬁned as


0 D − IN
M=
,
(G1)
−IN
A
where IN is the N -dimensional identity matrix. The reduction to Eq. (G1) is a manifest of the Ihara-Bass formula [51],
where an intuitive derivation of the reduction can be found in Ref. [35]. The Ihara-Bass formula has also been
generalized to weight graphs and linked to Bethe free energy in belief propagation [38], which is relevant in our study
when heterogeneous transmission probabilities {βij , αij } are considered.
For completeness, we provide a derivation using the matrix notation in this section. To this end, we deﬁne the
N × 2|E| source matrix S and target matrix T
(
1 if node i is the source of directed edge e, i.e., ∃j, e = i → j,
Sie =
(G2)
0 otherwise,

Tie =

(

1 if node i is the target of directed edge e, i.e., ∃j, e = j → i,
0 otherwise,

(G3)

and a 2|E| × 2|E| auxiliary matrix
J=



0
I2|E|

I2|E|
0



,

(G4)

24
where I2|E| is the 2|E|-dimensional identity matrix. We further index the set of directed edges according to the order
(e1 , ...e|E| , e|E|+1 , ...e2|E| ) such that for n ≤ |E|, en = i → j, one has en+|E| = j → i. Under this notation, the
non-backtracking matrix B can be written as
B = S ⊤ T − J.

(G5)

ST ⊤ = T S ⊤ = A,
SS ⊤ = T T ⊤ = D,
SJ = T ,
T J = S,

(G6)
(G7)

It can also be easily veriﬁed that

The key element of the derivation in Ref. [35] is that for a given 2|E|-dimensional u, one deﬁnes the corresponding
N -dimensional incoming and outgoing vectors
X

uin
i =

uout
=
i

uj→i ,

j∈∂i

X

ui→j ,

(G8)

j∈∂i

which can be expressed in the matrix form as
uin = T u,

uout = Su.

(G9)

Consider the vectors (Bu)out and (Bu)in , written in the matrix form as
SBu = S(S ⊤ T − J)u = SS ⊤ T u − SJu
= DT u − T u = (D − IN )(T u),
⊤

(G10)

⊤

T Bu = T (S T − J)u = T S T u − T Ju
= A(T u) − (Su),

(G11)

where we have made used of the relations in Equations (G6) and (G7). The above expressions can be written as







Su
Su
0 D − IN
S 0
,
(G12)
=: M
Bu =
Tu
Tu
−IN
A
0 T
where we identify the matrix M deﬁned in Eq. (G1). Now suppose u is an eigenvector of B with eigenvalue λB , then
Eq. (G12) leads to




Su
Su
.
(G13)
= λB
M
Tu
Tu
  out 
u
Su
is the eigenvector of M with eigenvalue λB . Therefore, we can work with the
or
Tu
uin
much smaller matrix M for computing the spectrum of the non-backtracking matrix B.
in
Physically, this reduction comes from compressing the edge-based data {ui→j } to node-based data {uout
i , ui }. In
the context of spreading processes, they correspond to edge-based messages and node-based marginal probabilities,
e.g., the cavity probability PSi→j in the linearized dynamics satisﬁes
which implies that



PSi→j (t + 1) ≈ PSi→j (t) −

X 

k∈∂i\j


αψ k→i (t) + βφk→i (t) ,

(G14)

while the marginal probability satisﬁes
PSi (t + 1) ≈ PSi (t) −
where the probability of newly infection
messages as αψ in (t) + βφin (t).

P

k∈∂i

X

αψ k→i (t) + βφk→i (t) ,

(G15)

k∈∂i

 k→i

αψ
(t) + βφk→i (t) corresponds to the incoming vectors of the

25
2.

Eigenvalues and Eigenvectors of Matrix M

Consider the eigenvalue equation of M


0 D − IN
−IN
A



uout
uin



= λM



uout
uin



,

(G16)

or explicitly
(

(D − IN )uin = λM uout ,
−uout + Auin = λM uin .

(G17)

The above equations can be reduced to a nonlinear eigenvalue problem



λ2M I − λM A + (D − I) uin = 0,

(G18)

and implies a relation between the outgoing-component uout and the incoming-component uin of the eigenmode as
uout
=
i

di − 1 in
u .
λM i

(G19)

In the main text, it is argued that the leading eigenvector of the matrix B (denoted as ũ), and the corresponding
incoming vector ũin = T ũ (i.e., the non-backtracking centrality), are useful in predicting the outcome of the epidemics.
From the analysis in this section, both the leading eigenvalue λmax
and the non-backtracking centrality ũin can be
B
obtained through the matrix M , which signiﬁcantly reduces the computational complexity. The Perron-Frobenius
theorem guarantees that the leading eigenvector ũ of the matrix B can be chosen to be non-negative, so does the
non-backtracking centrality ũin .

3.

Exact Expression in Random Regular Graphs

The leading eigenvalue of the matrix M can be computed exactly for random regular graphs. We ﬁrst notice that
= 0 [52]. For regular graphs with degree
the smallest eigenvalue of the Laplacian matrix L = D − A of a graph is λmin
L
d, we have D = dI, and therefore L commutes with A. It suggests that the largest eigenvalue of A is
= d.
λmax
A

(G20)

Equation (G18) can be expressed as
Auin =

which implies that λM +

d−1
λM





d−1
uin ,
λM +
λM

(G21)

is an eigenvalue of the adjacency matrix A with eigenvalue uin , denoted as λA . The

eigenvalue λM of M is related to λA as
λM =



q
1
λA ± λ2A − 4(d − 1) .
2

(G22)

Therefore, the leading eigenvalue λmax
of M , which is equal to the leading eigenvalue λmax
M
B , is identiﬁed as
λmax
M

=

λmax
B



q
2
1 max
max
λ
+
λA
− 4(d − 1)
=
2 A
= d − 1.

(G23)

26
network
ER(hdi ≈ 20)
SBM, c11 = 10
SBM, c11 = 20
SBM, c11 = 30
WP2013
WP2015
PS2014
HS2013
SF, γ = 2
SF, γ = 2.5
SF, γ = 3
SF, γ = 3.5
ER(hdi ≈ 5)
ER(hdi ≈ 5) + hub
ER(hdi ≈ 5) + clique

N
200
200
200
200
91
213
242
326
400
400
400
400
200
200
200

λmax
B
20
21.79
26.19
33.26
10.17
24.49
42.18
25.19
24.43
16.75
11.27
8.55
5.02
6.05
18.15

hdi
20.09
21.94
24.64
27.15
8.55
21.22
36.65
20.47
13.29
10.18
8.4
7.48
5.2
5.54
7.05

max,an
λB
20.02
21.8
25.38
29.9
10.26
24.2
40.64
23.38
25.9
17.87
12.14
8.88
5.1
6.48
11.09

max,un
λB
20
21.8
25.8
31.59
10.08
24.34
41.57
23.64
24.48
16.83
11.36
8.67
5.04
6.08
15.31

rd
-0.0182
-0.0041
0.2419
0.4274
-0.0525
0.0432
0.1993
0.0774
-0.0773
-0.06
-0.0653
-0.0347
-0.0582
-0.0575
0.6146

Table I. Approximation of the leading eigenvalue λmax
of the NB matrix.
B

4.

Approximations of the λmax
in Uncorrelated Random Networks
B

For uncorrelated random networks, approximate expressions of the leading eigenvalue λmax
can be derived, which
B
can be useful for estimating epidemics properties in large networks. In the annealed approximation where only the
information of the degree distribution P (d) is retained, λmax
is approximated as [35, 43]
B
λmax,an
≈
B

hd2 i − hdi
.
hdi

(G24)

In a more reﬁned approximation assuming uncorrelated networks but taking into neighborhood information, λmax
is
B
approximated as [44]
λmax,un
B

≈

P

ij (di

P

− 1)Aij (dj − 1)

i

di (di − 1)

.

(G25)

To examine the validity of the uncorrelated random network assumption, we consider the degree correlation coeﬃcient [53]
max

d
1 X
rd = 2
kl(ekl − qk ql ),
σ

(G26)

k,l=1

where ekl is the element of the degree correlation matrix (i.e., the probability of ﬁnding an edge connecting two nodes
(k)
of degree k and degree l), qk = kPhdi
(with P (k) being the degree distribution) is the probability of ﬁnding an edge
Pdmax 2 2
Pdmax
2
is the variance of the measure q. The neutrality
whose one end has degree k, and σ = k=1 k 2 qk −
k=1 k qk
condition rd = 0 needs to be (at least roughly) satisﬁed for a network to be uncorrelated.
In Table. I, we examine the approximations oﬀered by Eqs (G24) and (G25) for the networks considered in this
work. In general, λmax,un
provides a better approximation than λmax,an
, both of which predict λmax
quite well when
B
B
B
rd is low. The two cases with a relatively poor approximation (especially for λmax,an
) are the SBM network with
B
c11 = 30 and the ER network with a clique. These two networks exhibit high values of the degree correlation coeﬃcient
rd , violating the assumption of uncorrelated random network. On the other hand, the existence of dense subgraph
structures can cause localization of the NB centrality, which also makes the approximation inaccurate. In light of this,
it has been proposed in Ref. [44] to identify some characteristic subgraph structures for an improved approximation
of λmax
B .

27

[1] Yixuan Wang, Yuyi Wang, Yan Chen, and Qingsong
Qin, “Unique epidemiological and clinical features of the
emerging 2019 novel coronavirus pneumonia (COVID-19)
implicate special control measures,” Journal of Medical
Virology 92, 568–576 (2020).
[2] Ruiyun Li, Sen Pei, Bin Chen, Yimeng Song, Tao Zhang,
Wan Yang, and Jeffrey Shaman, “Substantial undocumented infection facilitates the rapid dissemination of
novel coronavirus (sars-cov-2),” Science 368, 489–493
(2020).
[3] Xi He, Eric H. Y. Lau, Peng Wu, Xilong Deng, Jian
Wang, et al., “Temporal dynamics in viral shedding
and transmissibility of COVID-19,” Nature Medicine 26,
672–675 (2020).
[4] Seyed M. Moghadas, Meagan C. Fitzpatrick, Pratha Sah,
Abhishek Pandey, Affan Shoukat, Burton H. Singer, and
Alison P. Galvani, “The implications of silent transmission for the control of COVID-19 outbreaks,” Proceedings
of the National Academy of Sciences 117, 17513–17515
(2020).
[5] Marino Gatto, Enrico Bertuzzo, Lorenzo Mari, Stefano
Miccoli, Luca Carraro, Renato Casagrandi, and Andrea
Rinaldo, “Spread and dynamics of the COVID-19 epidemic in italy: Effects of emergency containment measures,” Proceedings of the National Academy of Sciences
117, 10484–10491 (2020).
[6] Matteo Chinazzi, Jessica T. Davis, Marco Ajelli, Corrado
Gioannini, Maria Litvinova, et al., “The effect of travel
restrictions on the spread of the 2019 novel coronavirus
(COVID-19) outbreak,” Science 368, 395–400 (2020).
[7] Xingjie Hao, Shanshan Cheng, Degang Wu, Tangchun
Wu, Xihong Lin, and Chaolong Wang, “Reconstruction of the full transmission dynamics of COVID-19 in
wuhan,” Nature 584, 420–424 (2020).
[8] Seyed M. Moghadas, Affan Shoukat, Meagan C. Fitzpatrick, Chad R. Wells, Pratha Sah, et al., “Projecting
hospital utilization during the COVID-19 outbreaks in
the united states,” Proceedings of the National Academy
of Sciences 117, 9122–9126 (2020).
[9] Romualdo Pastor-Satorras, Claudio Castellano, Piet
Van Mieghem, and Alessandro Vespignani, “Epidemic
processes in complex networks,” Rev. Mod. Phys. 87,
925–979 (2015).
[10] N Ferguson, D Laydon, G Nedjati Gilani, N Imai,
K Ainslie, et al., “Report 9:
Impact of nonpharmaceutical interventions (NPIs) to reduce
covid19 mortality and healthcare demand,” (2020),
10.25561/77482.
[11] David Adam, “Special report: The simulations driving
the world’s response to COVID-19,” Nature 580, 316–318
(2020).
[12] Ofir Reich, Guy Shalev, and Tom Kalvari, “Modeling COVID-19 on a network:
super-spreaders,
medRxiv
(2020),
testing and containment,”
10.1101/2020.04.30.20081828.
[13] Nicholas G. Davies, Adam J. Kucharski, Rosalind M.
Eggo, Amy Gimma, W. John Edmunds, et al., “Effects
of non-pharmaceutical interventions on COVID-19 cases,
deaths, and demand for hospital services in the uk: a
modelling study,” The Lancet Public Health 5, e375–e385
(2020).

[14] Brian Karrer and M. E. J. Newman, “Message passing
approach for general epidemic models,” Phys. Rev. E 82,
016101 (2010).
[15] Andrey Y. Lokhov, Marc Mézard, Hiroki Ohta, and
Lenka Zdeborová, “Inferring the origin of an epidemic
with a dynamic message-passing algorithm,” Phys. Rev.
E 90, 012801 (2014).
[16] Andrey Y. Lokhov, Marc Mézard, and Lenka Zdeborová, “Dynamic message-passing equations for models
with unidirectional dynamics,” Phys. Rev. E 91, 012811
(2015).
[17] Munik Shrestha, Samuel V. Scarpino, and Cristopher
Moore, “Message-passing approach for recurrent-state
epidemic models on networks,” Phys. Rev. E 92, 022821
(2015).
[18] Matt J. Keeling and Pejman Rohani, Modeling Infectious
Diseases in Humans and Animals (Princeton University
Press, 2008).
[19] Liang Tian, Xuefei Li, Fei Qi, Qian-Yuan Tang, Viola
Tang, Jiang Liu, Zhiyuan Li, Xingye Cheng, Xuanxuan
Li, Yingchen Shi, Haiguang Liu, and Lei-Han Tang,
“Calibrated intervention and containment of the COVID19 pandemic,” arXiv:2003.07353 (2020).
[20] Qun Li, Xuhua Guan, Peng Wu, Xiaoye Wang, Lei
Zhou, et al., “Early transmission dynamics in wuhan,
china, of novel coronavirus-infected pneumonia,” New
England Journal of Medicine 382, 1199–1207 (2020),
pMID: 31995857.
[21] Peter Ashcroft, Jana S Huisman, Sonja Lehtinen, Judith A Bouman, Christian L Althaus, Roland R Regoes, and Sebastian Bonhoeffer, “COVID-19 infectivity profile correction,” Swiss Medical Weekly (2020),
10.4414/smw.2020.20336.
[22] Ranawaka A.P.M. Perera, Eugene Tso, Owen T.Y.
Tsang, Dominic N.C. Tsang, Kitty Fung, et al., “SARSCoV-2 virus culture and subgenomic RNA for respiratory specimens from patients with mild coronavirus disease,” Emerging Infectious Diseases 26 (2020),
10.3201/eid2611.203219.
[23] Wee Chian Koh, Lin Naing, Liling Chaw, Muhammad Ali Rosledzana, Mohammad Fathi Alikhan, Sirajul Adli Jamaludin, Faezah Amin, Asiah Omar, Alia
Shazli, Matthew Griffith, Roberta Pastore, and Justin
Wong, “What do we know about SARS-CoV-2 transmission? a systematic review and meta-analysis of the secondary attack rate and associated risk factors,” PLOS
ONE 15, e0240205 (2020).
[24] Oyungerel Byambasuren, Magnolia Cardona, Katy Bell,
Justin Clark, Mary-Louise McLaws, and Paul Glasziou,
“Estimating the extent of asymptomatic COVID-19 and
its potential for community transmission: Systematic
review and meta-analysis,” Official Journal of the Association of Medical Microbiology and Infectious Disease Canada COVID-19, Accepted version, e20200030
(2020).
[25] Mina Youssef and Caterina Scoglio, “An individual-based
approach to SIR epidemics in contact networks,” Journal
of Theoretical Biology 283, 136 – 144 (2011).
[26] Baichuan Mo, Kairui Feng, Yu Shen, Clarence Tam,
Daqing Li, Yafeng Yin, and Jinhua Zhao, “Modeling
epidemic spreading through public transit using time-

28
varying encounter network,” arXiv:2004.04602 (2020).
[27] Lasko Basnarkov, “SEAIR epidemic spreading model of
COVID-19,” arXiv:2005.11815 (2020).
[28] Andreas Koher, Hartmut H. K. Lentz, James P. Gleeson,
and Philipp Hövel, “Contact-based model for epidemic
spreading on temporal networks,” Phys. Rev. X 9, 031017
(2019).
[29] Hanlin Sun, David Saad, and Andrey Y. Lokhov, “Competition, collaboration and optimization in multiple interacting spreading processes,” arXiv:1905.04416 (2019).
[30] Joël Mossong, Niel Hens, Mark Jit, Philippe Beutels,
Kari Auranen, et al., “Social contacts and mixing patterns relevant to the spread of infectious diseases,” PLoS
Medicine 5, e74 (2008).
[31] http://www.sociopatterns.org/.
[32] F. Altarelli, A. Braunstein, L. Dall’Asta, J. R. Wakeling, and R. Zecchina, “Containing epidemic outbreaks
by message-passing techniques,” Phys. Rev. X 4, 021024
(2014).
[33] Marián Boguñá and Romualdo Pastor-Satorras, “Epidemic spreading in correlated complex networks,” Phys.
Rev. E 66, 047104 (2002).
[34] We remark that there are other conventions used when
defining the NB matrix in the literature; a common convention corresponds to the transpose of B defined in
Eq. (27) [35].
[35] Florent Krzakala, Cristopher Moore, Elchanan Mossel,
Joe Neeman, Allan Sly, Lenka Zdeborová, and Pan
Zhang, “Spectral redemption in clustering sparse networks,” Proceedings of the National Academy of Sciences
110, 20935–20940 (2013).
[36] Brian Karrer, M. E. J. Newman, and Lenka Zdeborová,
“Percolation on sparse networks,” Phys. Rev. Lett. 113,
208702 (2014).
[37] Roger A. Horn and Charles R. Johnson, Matrix Analysis,
2nd ed. (Cambridge University Press, New York, 2012).
[38] Yusuke Watanabe and Kenji Fukumizu, “Graph zeta
function in the bethe free energy and loopy belief propagation,” in Advances in Neural Information Processing
Systems 22 , edited by Y. Bengio, D. Schuurmans, J. D.
Lafferty, C. K. I. Williams, and A. Culotta (Curran Associates, Inc., 2009) pp. 2017–2025.
[39] Panpan Shu, Wei Wang, Ming Tang, and Younghae
Do, “Numerical identification of epidemic thresholds for
susceptible-infected-recovered model on finite-size networks,” Chaos: An Interdisciplinary Journal of Nonlinear
Science 25, 063104 (2015).

[40] Ginestra Bianconi, “Rare events and discontinuous percolation transitions,” Phys. Rev. E 97, 022314 (2018).
[41] Reimer Kühn and Tim Rogers, “Heterogeneous microstructure of percolation in sparse networks,” EPL (Europhysics Letters) 118, 68003 (2017).
[42] Carl Edward Rasmussen and Christopher K. I. Williams,
Gaussian Processes for Machine Learning, Adaptive
computation and machine learning (The MIT Press,
2006).
[43] Travis Martin, Xiao Zhang, and M. E. J. Newman, “Localization and centrality in networks,” Phys. Rev. E 90,
052808 (2014).
[44] Romualdo Pastor-Satorras and Claudio Castellano, “The
localization of non-backtracking centrality in networks
and its physical consequences,” arXiv:2005.03913 (2020).
[45] Rossana Mastrandrea, Julie Fournet, and Alain Barrat,
“Contact patterns in a high school: A comparison between data collected using wearable sensors, contact diaries and friendship surveys,” PLOS ONE 10, e0136497
(2015).
[46] Valerio Gemmetto, Alain Barrat, and Ciro Cattuto,
“Mitigation of infectious disease at school: targeted class
closure vs school closure,” BMC Infectious Diseases 14
(2014), 10.1186/s12879-014-0695-9.
[47] Mathieu Génois, Christian L. Vestergaard, Julie Fournet,
André Panisson, Isabelle Bonmarin, and Alain Barrat,
“Data on face-to-face contacts in an office building suggest a low-cost vaccination strategy based on community
linkers,” Network Science 3, 326–347 (2015).
[48] Mathieu Génois and Alain Barrat, “Can co-location be
used as a proxy for face-to-face contacts?” EPJ Data Science 7, 11 (2018).
[49] Kiesha Prem, Alex R. Cook, and Mark Jit, “Projecting social contact matrices in 152 countries using contact
surveys and demographic data,” PLOS Computational
Biology 13, 1–21 (2017).
[50] Andrey Y. Lokhov and David Saad, “Optimal deployment of resources for maximizing impact in spreading
processes,” Proceedings of the National Academy of Sciences 114, E8138–E8146 (2017).
[51] Hyman Bass, “The Ihara-Selberg zeta function of a
tree lattice,” International Journal of Mathematics 03,
717–797 (1992).
[52] Chris Godsil and Gordon Royle, Algebraic Graph Theory
(Springer New York, 2001).
[53] A.L. Barabási and M. Pósfai, Network Science (Cambridge University Press, Cambridge, United Kingdom,
2016).

