TIME SERIES ANALYSIS OF COVID-19 INFECTION CURVE:
A CHANGE-POINT PERSPECTIVE

arXiv:2007.04553v1 [econ.EM] 9 Jul 2020

By Feiyu Jiang‡∗ , Zifeng Zhao§ and Xiaofeng Shao¶†
Tsinghua University‡ , University of Notre Dame§ and University of Illinois at Urbana
Champaign¶
In this paper, we model the trajectory of the cumulative confirmed cases and deaths of COVID-19 (in log scale) via a piecewise
linear trend model. The model naturally captures the phase transitions of the epidemic growth rate via change-points and further enjoys great interpretability due to its semiparametric nature. On the
methodological front, we advance the nascent self-normalization (SN)
technique (Shao, 2010) to testing and estimation of a single changepoint in the linear trend of a nonstationary time series. We further
combine the SN-based change-point test with the NOT algorithm
(Baranowski et al., 2019) to achieve multiple change-point estimation. Using the proposed method, we analyze the trajectory of the
cumulative COVID-19 cases and deaths for 30 major countries and
discover interesting patterns with potentially relevant implications for
effectiveness of the pandemic responses by different countries. Furthermore, based on the change-point detection algorithm and a flexible extrapolation function, we design a simple two-stage forecasting
scheme for COVID-19 and demonstrate its promising performance in
predicting cumulative deaths in the U.S.
∗

Jiang is supported by the National Key Research and Development Program of China (No.

2018YFC1603105), China Scholarship Council (No.201906210093), National Natural Science Foundation
of China (No.11571348 and No.11771239) and acknowledges that the work was carried out during the visit
at Department of Statistics, University of Illinois at Urbana-Champaign.
†
Shao is supported in part by NSF-DMS 1807032.

1

2

1. Introduction. Since the initial outbreak of the novel coronavirus in Wuhan, China
in early January 2020, the COVID-19 pandemic has rapidly spread across the world. Due
to the high infectivity of the virus and the lack of immunity in the human population, the
epidemic grows exponentially without intervention, and thus can greatly stress the public
health system and bring enormous disruption to economy and society. Thus, a crucial
task facing every country is to reduce the transmission rate and flatten the (infection)
curve. Various emergency measures, such as regional lockdown and mass testing, have
been taken by different countries and a natural question is whether (and to what degree)
these interventions are effective in slowing down the pandemic. Additionally, each country
is at a different stage of the epidemic and it is essential for countries to understand its
own pattern of virus growth, as such information is critical for important policy decisions
such as extending lockdown or reopening. To (at least partially) answer these questions,
a natural step is to analyze the trajectory of the infection curve of COVID-19 since the
initial outbreak in each country.
In this paper, we propose to model the time series of cumulative confirmed cases and
deaths (in log scale) of each country via a piecewise linear trend model (see formal definition
later). In other words, we model the mean of the logarithm of cumulative infection as a
linear trend with an unknown number of potential changes in the intercept and slope, as
it is natural to expect that the spread of COVID-19 may experience several phases, where
the initial growth is typically rapid due to absence of immunity and lack of preparation,
and the spread may then evolve into phases with slower growth depending on government
intervention and public health responses (i.e. flattening the curve). The estimation of such
a model can be formulated as a change-point detection problem.
In recent years, change-point analysis has become an increasingly active research area
in statistics and econometrics thanks to its applications across a wide range of fields,
including bioinformatics (Fan and Mackey, 2017), climate science (Gromenko et al., 2017),
economics (Bai, 1994, 1997; Cho and Fryzlewicz, 2015), finance (Fryzlewicz, 2014), medical

3

science (Chen and Gupta, 2011), and signal processing (Chen and Gu, 2018); see Perron
(2006), Aue and Horváth (2013) and Truong et al. (2020) for some recent reviews. However,
most existing change-point literature operates under the piecewise stationarity assumption,
where it is assumed that the time series of interest is (potentially) non-stationary but can be
partitioned into piecewise stationary segments such that observations within each segment
are stationary and share a common parameter of interest such as mean or variance. While
the piecewise stationarity assumption is proven to be reasonable and fruitful for many
applications, methods developed under this framework cannot handle time series with
intrinsic non-stationarity, such as the cumulative infection curve of COVID-19.
A simple but important class of time series with intrinsic non-stationarity is the piecewise
linear trend model, which has the following mathematical formulation. Let the time series
{Yt }nt=1 admit
(1.1)

Yt = at + bt (t/n) + ut , t = 1, · · · , n,
(i)

(i)

(at , bt ) = β (i) = (β0 , β1 )⊤ , τi−1 + 1 ≤ t ≤ τi , for i = 1, · · · , m + 1,
where (at , bt ) is the linear trend (intercept and slope) of E(Yt ) at time t, {ut } is a weakly
dependent stationary error process, τ = (τ1 , · · · , τm ) denotes the m ≥ 0 change-points

with the convention that τ0 = 0 and τm+1 = n, and we require β (i) 6= β (i+1) , i = 1, · · · , m.
In this paper, we set {Yt }nt=1 to be the time series of daily cumulative confirmed cases or

deaths (in log scale) of COVID-19. Due to the log transformation, the slope bt naturally
measures the growth rate of the virus at day t.
The piecewise linear trend model is intuitive, interpretable and is useful for tracking
the dynamics of a pandemic as it naturally segments the spread process into phases with
(approximately) the same growth rate. The slope of the last segment can shed light on the
current status of the pandemic and provide short-term forecast, while the estimated changepoints can be compared with dates when emergency measures such as lockdown were
introduced to help assess the effectiveness of different policies. Also, the semiparametric
nature of (1.1) helps to achieve model flexibility while maintaining simplicity, which is

4

advantageous for modeling the cumulative cases at the early stage of a pandemic as the
time series is relatively short, curbing the use of sophisticated fully nonparametric methods.
An important part in estimation of (1.1) is to recover the unknown number m and location τ of the change-points. As discussed above, such a problem has mostly been ignored
in the change-point literature with only a few exceptions. A CUSUM based detection algorithm is proposed in Baranowski et al. (2019), and a model selection based procedure
is derived in Maidstone and Letchford (2019). However, both methods assume temporal
independence of {ut }, which can be restrictive as serial dependence is commonly found in
time series data. Although Baranowski et al. (2019) briefly discussed possible extensions
to temporally dependent series, potentially important issues such as choice of tuning parameters seem not carefully addressed. Bai and Perron (1998) can detect structural breaks
in the linear trend model under serial dependence. However, numerical study (see Section 4) suggests that their method is relatively sensitive to positive temporal dependence,
which is indeed exhibited by the COVID-19 data, and may give less favorable estimation
performance under small sample size.
Based on the self-normalization (SN) idea in Shao (2010), we propose a novel SN-based
change-point detection procedure for the estimation of (1.1) that is robust to temporal
dependence both in asymptotic theory and in finite sample. The essential idea of SN is
using an inconsistent variance estimator to absorb the unknown serial dependence in the
data. See a brief review of SN in Section 2.1 and Shao (2015) for a comprehensive overview
of recent developments of SN for low dimensional time series.
Using the proposed SN method and the piecewise linear trend model, we analyze the
time series of cumulative confirmed cases and deaths of COVID-19 (in log scale) in 30
major countries. We find that the spread of coronavirus in each country can typically be
segmented into several phases with distinct growth rates and countries with geographical
proximity share similar spread patterns, which is particularly evident for continental European countries and developing countries in Latin America. In addition, the transition

5

date from rapid growth phases to moderate growth phases is typically associated with the
initiation of emergency measures such as lockdown and mass testing with contact tracing, which partiallyprovides evidence that strict social distancing rules help slow down the
virusgrowth and flatten the curve. Moreover, our analysis further indicates that compared
to developed countries, most developing countries are still in the earlystages of the pandemic and are generally less efficient in terms of controlling the spread of coronavirus, thus
may need more international aids to help contain the epidemic.
Combining the SN-based change-point detection algorithm with a flexible extrapolation
function, we further design a simple two-stage forecasting scheme for COVID-19. The
proposed method is used to forecast the cumulative deaths in the U.S. and is found to
deliver accurate prediction valuable to data-driven public health decision-making.
2. Methodology. In this section, we propose a novel SN-based method for changepoint detection in model (1.1) that is robust against a wide range of temporal dependence.
Specifically, an SN-based test statistic is first proposed for testing a single change-point
alternative and then modified to consistently estimate the change-point. A multiple changepoint estimation procedure is further developed by combining the proposed SN test with
the NOT algorithm in Baranowski et al. (2019).
2.1. Testing for a single change-point. We start with a change-point testing problem
where for model (1.1) we want to test the null hypothesis H0 of no change-point against
the alternative Ha of one change-point:
H0 : β 1 = · · · = β n = β

v.s.


 β (1) ,
1≤t≤τ
Ha : β t =
 β (2) , τ + 1 ≤ t ≤ n,

such that β (1) 6= β (2) ,

where β t = (at , bt ), τ = ⌊κn⌋ is an unknown change-point satisfying ǫ < κ < 1 − ǫ for some
0 < ǫ < 1/2 and ǫ is the commonly used trimming parameter in the change-point analysis
(see e.g. Andrews (1993)).
Throughout this paper, we operate under the following mild assumption of {ut }, which

6

covers a wide range of weakly dependent error process and is weaker than most existing
literature where independence of {ut } is assumed.
The error process {ut } is strictly stationary such that E(ut ) = 0,
P
E(u4t ) < ∞ and the long-run variance satisfies Γ2 = lim Var(n−1/2 nt=1 ut ) ∈ (0, ∞).
Assumption 2.1.

n→∞

Denote {et } as a sequence of i.i.d. random variables with zero mean and unit variance, we
further assume that {ut } admits one of the following two representations:
P
P∞
(i). ut = ∞
j=0 cj et−j and
j=0 |jcj | < ∞.

(ii). ut = G(Ft ) for some measurable function G and Ft = (et , et−1 , · · · ). For some

χ ∈ (0, 1), kG(Fk ) − G({F−1 , e′0 , e1 , · · · , ek })k4 = O(χk ) if k ≥ 0 and 0 otherwise. Here e′0

is an i.i.d. copy of e0 and kXk4 = (E(X 4 ))1/4 for a random variable X.

Assumption 2.1(i) is popular in the linear process literature to ensure the central limit
theorem and the invariance principle. Assumption 2.1(ii) is basically equivalent to the
geometric moment contracting condition for the nonlinear causal process (Wu and Shao
(2004), Wu (2005)), which implies invariance principle.
Earlier works on this testing problem include Andrews (1993) and Bai and Perron (1998)
where Lagrangian multiplier, Wald, likelihood ratio and F statistics are considered. These
tests typically require an estimator of the long-run variance (LRV) Γ due to the unknown
temporal dependence of the error process {ut }. However, as pointed out in Shao and Zhang
(2010), the size and power performance of these tests may depend crucially on the selection
of various tuning parameters. In particular, if a data-driven bandwidth parameter is used
for the estimation of LRV, an undesirable non-monotonic power phenomenon may occur;
see Crainiceanu and Vogelsang (2007) and Shao and Zhang (2010). To avoid the bandwidth
selection involved in the estimation of LRV, we instead adapt the idea of self-normalization
in Shao (2010), which was originally proposed for inference of stationary time series and
was generalized to change-point testing for piecewise stationary time series in Shao and
Zhang (2010) and Zhang and Lavitas (2018). See Shao (2015) for a review of SN.

7

To proceed, we first introduce some notations. Given ǫ, denote h = ⌊ǫn⌋. For a vector x,

denote the l2 norm as kxk2 and denote x⊗2 = xx⊤ . Define F (s) = (1, s)⊤ , for 1 ≤ i < j ≤ n,
hP
i−1 P
j
j
⊤
we denote βbi,j =
F
(t/n)F
(t/n)
t=i
t=i F (t/n)Yt as the OLS estimator of β based
2
and a potential
on {Yt }jt=i . For any 1 ≤ t1 < k < t2 ≤ n, given the subsample {Yt }tt=t
1

change-point k, we define a contrast statistic Dn where
Dn (t1 , k, t2 ) =

(2.1)

(k − t1 + 1)(t2 − k) b
(β t1 ,k − βbk+1,t2 ).
(t2 − t1 + 1)3/2

Note that Dn (t1 , k, t2 ) is a normalized difference between the OLS estimates of β with pre-k
2
samples {Yt }kt=t1 and post-k samples {Yt }tt=k+1
. Intuitively, a large maxh≤k≤n−h kDn (1, k, n)k2

leads to the rejection of H0 . However, the asymptotic distribution of Dn (1, k, n) depends
on the unknown LRV of {ut }, and as discussed before the accurate estimation of LRV is
rather challenging and problematic in practice.
To bypass the problematic estimation of LRV, we utilize the self-normalization technique. Define 0 < δ < ǫ/2 as a local trimming parameter, we define the self-normalizer
Vn,δ (t1 , k, t2 ) = Ln,δ (t1 , k, t2 ) + Rn,δ (t1 , k, t2 ) where
k−2−⌊nδ⌋

(2.2)

X

(i − t1 + 1)2 (k − i)2
(βb − βb i+1,k )⊗2 ,
(k − t1 + 1)2 (t2 − t1 + 1)2 t1 ,i

t2 −1−⌊nδ⌋

(i − 1 − k)2 (t2 − i + 1)2 b
(β i,t2 − βbk+1,i−1 )⊗2 .
(t2 − t1 + 1)2 (t2 − k)2

Ln,δ (t1 , k, t2 ) =

i=t1 +1+⌊nδ⌋

(2.3)

Rn,δ (t1 , k, t2 ) =

X

i=k+3+⌊nδ⌋

The local trimming parameter δ is introduced to make sure all the subsample estimates
of β in the self-normalizer Vn,δ (t1 , k, t2 ) are constructed with a subsample of size being a
positive fraction of n, which is a technical condition necessary in our theoretical analysis.
We later discuss the implication of the trimming parameters (ǫ, δ).
Based on the contrast statistic Dn (1, k, n) and the self-normalizer Vn,δ (1, k, n), we propose an SN-based test statistic Gn for testing the single change-point alternative where
(2.4)

Gn =

max

k∈{h,··· ,n−h}

Tn,δ (k),

Tn,δ (k) = Dn (1, k, n)⊤ Vn,δ (1, k, n)−1 Dn (1, k, n).

8

Intuitively, due to the presence of the self-normalizer, the LRVs in Dn (1, k, n) and Vn,δ (1, k, n)
cancel out with each other, leading to a test statistic Gn that is invariant to LRV. This
phenomenon is made formal in Theorem 2.1.
R
D
β (1) . Define Q(r) = 0r F (s)F (s)⊤ ds
Denote −→ as convergence in distribution and b = β (2) −β
Rr
and BF (r) = 0 F (s)dB(s) where B(·) is a standard Brownian motion. Theorem 2.1 states
the asymptotic behavior of the SN test statistic Gn under H0 and Ha respectively.
Theorem 2.1.

Suppose Assumption 2.1 holds. Let Gn be defined in (2.4), we have

(i) under H0 , we have
D

Gn −→ G(ǫ, δ) :=

(2.5)

sup

D(η)⊤ Vδ (η)D(η),

η∈(ǫ,1−ǫ)

n
o
where D(η) = η(1 − η) Q(η)−1 BF (η) − [Q(1) − Q(η)]−1 [BF (1) − BF (η)] and Vδ (η) =
R η−δ r2 (η−r)2 
⊗2
Q(r)−1 BF (r)−[Q(η)−Q(r)]−1 [BF (η)−BF (r)]
dr,
Lδ (η)+Rδ (η) with Lδ (η) = δ
η2
R 1−δ (r−η)2 (1−r)2 
× [Q(1) − Q(r)]−1 [BF (1) − BF (r)] − [Q(r) − Q(η)]−1 [BF (r) −
Rδ (η) = η+δ
(1−η)2
BF (η)]

⊗2

dr.

(ii) under Ha , given that nkbk22 → L, we have
lim lim Gn = ∞,

L→∞ n→∞

in probability.

Due to self-normalization, the limiting distribution G(ǫ, δ) in (2.5) is pivotal and invariant to the LRV. The corresponding critical values can be easily obtained via simulation.
Table 2.1 gives the 1 − α quantiles of G(ǫ, δ) for some combinations of (ǫ, δ) (based on
10000 replications). Note that the limiting null distribution G(ǫ, δ) explicitly depends on
the choice of (ǫ, δ), thus the impact of trimming parameters (ǫ, δ) is accounted for at the
first order, in the same spirit of the fixed-b asymptotics (Kiefer and Vogelsang (2005)). See
also Zhou and Shao (2013). Throughout the paper, we set (ǫ, δ) = (0.1, 0.02).

9
Table 2.1
Simulated quantiles of G
ǫ
0.1

0.2

1−α
δ
0.01
0.02
0.03
0.04
0.01
0.02
0.03
0.04

90%

95%

99%

99.5%

99.9%

14.963
24.959
38.277
54.569
4.656
7.217
10.526
14.439

19.284
32.727
50.872
76.244
5.905
9.404
13.767
19.075

32.168
53.645
83.713
116.497
9.691
15.486
23.060
33.049

36.145
64.898
107.062
144.437
12.037
18.389
26.758
37.426

45.354
92.982
137.433
182.786
14.148
24.079
36.388
49.495

Give that the null hypothesis H0 is rejected, we estimate the change-point τ by τb =

arg maxk∈{h,··· ,n−h} Tn,δ (k). The following theorem gives the consistency result of κ
b = n−1 τb.
Theorem 2.2.

Under Ha , suppose Assumption 2.1 holds, and nkbk22 → ∞ as n → ∞.

Then, we have that for any η > 0,
lim P(|b
κ − κ| < η) = 1.

n→∞

Theorem 2.2 allows a diminishing change size kbk2 with the sample size n as long as

nkbk22 → ∞. Note that no consistency result is provided in Shao and Zhang (2010) for the
change-point location estimation, and our result seems to be the first formal attempt based
on the SN technique. However, it is challenging to obtain an explicit rate of convergence
for τb due to the complicated nature of the self-normalizer Vn,δ and we leave it for future
investigation.

2.2. Multiple change-point estimation. To extend single change-point testing to multiple change-point estimation, the classical idea is to combine the change-point test with
binary segmentation (BS). Although conceptually and computationally simple, it is well
known that BS can cause severe power loss for detecting non-monotonic changes (Olshen
et al., 2004), which is common in real data. Several variants of BS have been proposed
to address this drawback, such as wild binary segmentation (WBS) (Fryzlewicz (2014))
and Narrowest-Over-Threshold (NOT) (Baranowski et al. (2019)). Since NOT is shown to

10

be superior to WBS, we combine the SN-based test with the NOT algorithm to estimate
multiple change-points and name our algorithm SN-NOT.
The essential idea of SN-NOT is to compute the SN test on a large collection of random
subsamples of {Yt }nt=1 instead of the entire sample {Yt }nt=1 . With high probability, some
subsamples will only contain a single change-point, where the SN test statistics are expected
to exhibit large values, leading to the discovery of a change-point.
Denote FnM = {(si , ei ) : i = 1, · · · , M } as the set of M random intervals such that each
pair of integers (si , ei ) are drawn uniformly from {1, · · · , n} and satisfy 1 ≤ si < ei ≤ n
and ei − si + 1 ≥ 2h. For each random interval (s, e) ∈ FnM , we calculate the SN test
Gn,δ (s, e) =

max

k∈{s+h−1,··· ,e−h}

Tn,δ (s, k, e),

Tn,δ (s, k, e) = Dn (s, k, e)Vn,δ (s, k, e)−1 Dn (s, k, e)⊤ .

SN-NOT finds the narrowest interval (s, e) ∈ FnM where the test statistic Gn,δ (s, e) exceeds
a given threshold ζn and estimates the change-point as τb = arg maxk∈{s+h−1,··· ,e−h} Tn,δ (s, k, e).
Note that for large M , with high probability there is only one change-point in this narrowest interval, which thus remedies the drawback of BS in detecting non-monotonic changes.
Once a change-point τb is identified, SN-NOT then divides the sample into two subsamples

accordingly and apply the same procedure on each of them. The process is implemented

recursively until no change-point is detected. In addition to the advantage of detecting
non-monotonic changes, SN-NOT broadens the applicability of the NOT algorithm itself
by allowing for temporal dependence in the error process thanks to the self normalization
technique.
The detailed implementation of SN-NOT is given in Algorithm 1. We propose to select
the threshold ζn as follows. Generate B sequences of i.i.d N (0, 1) random variables {εbt }nt=1 ,
b = 1, · · · , B; for the bth sample, we calculate
ζnb = arg max Gn,δ (si , ei ),
i=1,··· ,M

b = 1, · · · , B.

The threshold ζn is set as the 95% sample quantile of {ζnb }B
b=1 . Since the SN test statistic is
asymptotically pivotal, this threshold is expected to well approximate the 95% quantile of

11

the finite sample distribution of the maximum SN test statistic on the M random intervals
under null. Throughout this paper, we set B = 1000, M = 300.
Algorithm 1: SN-NOT

1
2
3
4
5
6
7
8

M
Input: Data {Yt }n
t=1 , threshold ζn , trimming size d = ⌊δn⌋ and h = ⌊ǫn⌋, random intervals Fn .
Output: Estimated number of change-points m
b and estimated change-points set τb
Initialization: SN-NOT(1, n, ζn )
Procedure: SN-NOT(s, e, ζn )
if e − s + 1 < 2h then
Stop
else
M(s,e) := {i : [si , ei ] ∈ FnM , [si , ei ] ⊂ [s, e], ei − si + 1 ≥ 2h} ;
if M(s,e) = ∅ then
Stop
else
n
o

O(s,e) := i ∈ M(s,e) : Gn,δ (si , ei ) > ζn ;

if O(s,e) = ∅ then
Stop
else
i∗ = arg mini∈O(s,e) |ei − si + 1|;
τ ∗ = arg maxk∈{s∗i +h−1,··· ,e∗i −h} Tn,δ (si∗ , k, ei∗ ) ;
τb = τb ∪ τ ∗ , m
b =m
b + 1;
SN-NOT(s, τ ∗ , ζn );
SN-NOT(τ ∗ + 1, e, ζn );
end

9
10
11
12
13
14
15
16
17
18
19

end
end

3. Simulation. In this section, we study the finite sample performance of the SN test
in testing single change-point and the SN-NOT algorithm in detecting multiple changepoints through numerical experiments. All results are reported based on 1000 replications.
3.1. Testing size and Power. We generate the data from model (1.1) with sample size
n = 100, 500 and 1000 respectively. For the size performance, we let β = (3, 0.05n) while
for the power performance, we let β (1) = (3, 0.06n) and β (2) = (3 + 0.015n, 0.03n) with
the change-point τ = n/2. The error process {ut } is generated via an AR(1) model where
i.i.d.

ut = ρut−1 + et , et ∼ N (0, (1 − ρ2 )σ 2 ) with ρ = 0, ±0.2, ±0.5 and σ = 0.15.

For comparison, we also implement the supLM test defined in Andrews (1993) (using

12
Table 3.1
Size and size-adjusted power for SN test and supLM test.
α

ρ

-0.5

-0.2

SN
0

0.2

0.5

-0.5

-0.2

supLM
0

0.2

0.5

Size
5%
10%

n = 100

0.003
0.008

0.012
0.028

0.026
0.053

0.042
0.091

0.093
0.160

0.043
0.091

0.023
0.064

0.016
0.047

0.012
0.035

0
0.018

5%
10%

n = 500

0.022
0.051

0.033
0.064

0.036
0.074

0.045
0.085

0.057
0.105

0.049
0.101

0.042
0.089

0.032
0.082

0.030
0.078

0.020
0.064

5%
10%

n = 1000

0.040
0.086

0.045
0.086

0.045
0.089

0.045
0.092

0.049
0.096

0.042
0.108

0.037
0.096

0.036
0.090

0.034
0.079

0.025
0.067

5%
10%

n = 100

1
1

0.990
1

0.909
0.983

0.654
0.879

0.269
0.531

1
1

0.999
1

0.965
0.996

0.846
0.925

0.438
0.587

5%
10%

n = 500

1
1

1
1

1
1

1
1

1
1

1
1

1
1

1
1

0.989
0.998

0.277
0.568

5%
10%

n = 1000

1
1

1
1

1
1

1
1

1
1

1
1

1
1

1
1

1
1

0.906
0.989

Power

function sctest of the R package strucchange) with the same trimming parameter ǫ = 0.1.
The results are summarized in Table 3.1 at significance levels α = 5% and 10%. It can be
seen that when n is small, both methods have distorted sizes. In particular, SN is prone
to be conservative when ρ is negative and oversized when ρ is positive while supLM is
undersized in all cases. As n increases, we find that both tests tend to have more accurate
sizes. For n = 100, supLM test has slightly higher power than SN test while for n = 500
and n = 1000, SN test beats supLM test under positive ρ. Note that both tests are more
powerful under negative ρ.

13

3.2. Multiple change-point estimation. We examine the numerical performance of SNNOT by considering the following DGP with n = 100:



3 + 3.2(t/n) + ut ,
1 ≤ t ≤ 20,






 5.8 + 1.8(t/n) + ut ,
21 ≤ t ≤ 40,
Yt =


9.8 + 0.8(t/n) + ut ,
41 ≤ t ≤ 70,






 15.05 + 0.05(t/n) + ut , 71 ≤ t ≤ 100.

i.i.d.

The error process {ut } is generated via an AR(1) model where ut = ρut−1 + et , et ∼

N (0, (1 − ρ2 )σ 2 ) with ρ = 0, ±0.2, ±0.5 and σ = 0.15. For comparison, we also implement the multiple change-point detection procedure proposed in Bai and Perron (1998)
(denoted as BP hereafter), which is the most widely used detection algorithm allowing for
temporal dependence in the error term of model (1.1). BP is implemented using function
breakpoints of the R package strucchange.
To assess the accuracy of change-point estimation, we define the Hausdorff distance between two sets. Denote the set of true change-points as τ o and the set of estimated changepoints as τb, we define d1 (ττ o , τb) = maxτ1 ∈bτ minτ2 ∈ττ o |τ1 −τ2 | and d2 (ττ o , τ̂τ ) = maxτ1 ∈ττ o minτ2 ∈bτ |τ1 −
τ2 |, where d1 measures the over-segmentation error of τb and d2 measures the under-

segmentation error of τb. The Hausdorff distance is then defined as dH (ττ o , τb) = max(d1 (ττ o , τb), d2 (ττ o , τb)).
In addition, we report the adjusted Rand index (ARI) which measures the similarity be-

tween two partitions of the same observations. Roughly speaking, a higher ARI (with the
maximum value of 1) means more accurate change-point estimation. For the definition and
detailed discussions of ARI, we refer to Hubert and Arabie (1985).
Table 3.2 summarizes the numerical result where we report ARI, d1 , d2 , dH and the
frequency of |m
b − mo | for SN-NOT and BP. It can be seen that SN-NOT is overall better

than BP in terms of ARI, dH and the estimated number of change-points when ρ ≥ 0.
This finding suggests using SN-NOT could be more advantageous for analyzing COVID-19
data, which exhibit positive temporal dependence (see the last column of Table 4.1). For

14

applications where negatively correlated error is expected, BP could be a better choice.
Table 3.2
Estimation results for SN-NOT and BP
ρ
ARI
d1
d2
dH
m
b =3
|m
b − 3| = 1
|m
b − 3| > 1

-0.5
0.844
4.817
2.949
4.830
0.902
0.098
0

-0.2
0.852
3.846
3.170
3.877
0.955
0.045
0

SN-NOT
0
0.849
3.953
3.574
4.141
0.950
0.050
0

0.2
0.828
4.765
3.964
4.960
0.922
0.078
0

0.5
0.784
6.049
6.032
7.152
0.808
0.186
0.006

-0.5
0.863
2.854
2.854
2.854
1
0
0

-0.2
0.852
3.176
3.252
3.252
0.989
0.011
0

BP
0
0.840
3.379
3.915
3.915
0.930
0.069
0.001

0.2
0.805
3.970
5.605
5.605
0.775
0.198
0.027

0.5
0.714
4.837
10.457
10.457
0.337
0.402
0.261

4. Analysis for cumulative confirmed cases and deaths of COVID-19. In this
section, based on the proposed SN-NOT algorithm, we provide detailed in-sample analysis
of the cumulative confirmed cases (Section 4.2-4.3) and deaths (Section 4.4) of COVID19 (in log scale) in 30 major countries.
4.1. Data and method. We focus on G20 (with 19 sovereign countries1 ) and 11 other
countries leading the total infected cases as of May 27, 2020, including Australia (AUS),
Argentina (ARG), Belgium (BEL), Brazil (BRA), Canada (CAN), Chile (CHI), China
(CHN), France (FRA), Germany (GER), India (IND), Indonesia(INA), Iran (IRI), Italy
(ITA), Japan (JPN), Mexico (MEX), Netherlands (NED), Pakistan (PAK), Peru (PER),
Portugal (POR), Qatar(QAT), Russia (RUS), Saudi Arabia (KSA), Spain (ESP), South
Africa (RSA), South Korea (ROK), Sweden (SWE), Switzerland (SUI), Turkey (TUR),
United Kingdom (GBR), United States (USA).
We obtain the data from https://ourworldindata.org/coronavirus-source-data
maintained by “Our World in Data”, where cumulative measures such as confirmed cases
and deaths are updated daily for each nation. For each country, the logarithm of cumulative
1

G20 is an international forum for the governments and central bank governors from 19 countries and

the European Union. We will view members of the European Union as individual countries because the
responses to COVID-19 usually come from the national level.

15

confirmed cases (or deaths) {Yt } starts on the date when the cumulative cases (or deaths)
exceeded 20 and ends on May 27.
We study the cumulative confirmed cases and deaths (in log scale) of each country via
the piecewise linear trend model (1.1), where given {Yt }, the change-points (τ1 , · · · , τm
b)
is estimated by the SN-NOT algorithm. An OLS is then used to recover the linear model
τbi
for the ith estimated segment {Yt }t=b
b + 1. With a slight abuse of
τi−1 +1 , i = 1, 2, · · · , m

notation, denote bbi as the estimated slope for the ith segment. We define the normalized
slope Si = bbi /n for each segment. As can be seen from (1.1), the normalized slope Si

measures E[Yt+1 − Yt ] for the ith segment, which can be interpreted as the “log-return”
and measures the daily growth rate of the cumulative confirmed cases (or deaths) in the
original scale.
Methodologically speaking, for cumulative confirmed cases, the piecewise linearity allows
us to assess the growth rate of the coronavirus at any given time and further facilitates
short-term forecast. In particular, the estimated slope Si of each segment indicates the
pace of the growth rate during the corresponding period. Moreover, by comparing the slope
before and after each change-point, we can quantitatively assess the changes in growth rate,
which partially measure the effectiveness of policies taken by the government.
4.2. Detailed analysis of cumulative confirmed cases in 8 representative countries. We
first conduct a detailed case study for eight representative countries that either lead confirmed cases (the U.S., Brazil, Russia, and India) in the corresponding continent or receive
most media attention (the U.K., Spain, Italy, and South Korea).
Table 4.1 summarizes the detailed estimation result for each country (in descending
order of the cumulative confirmed cases), where we report the starting date of the series,
length of the series n, the estimated number of change-points, dates of the first, second and

latest estimated change-point. The first (S1 ), the second (S2 ) and the current normalized
slope (Sm+1
) are also presented. In addition, we report the lag-1 sample autocorrelation ρb
b

of the error process. From the table, we can see all of these countries have been affected

16

by the coronavirus for more than two months. The average length of segments between
two adjacent change-points is around 13-20 days, indicating that the spread rate can be
relatively steady for a window of 2-3 weeks. The latest change-point for most countries
appeared in May except for Brazil. We also note that the current normalized slopes (i.e.
growth rate) vary considerably across countries with comparably large values in Brazil and
India. Meanwhile, the lag-1 sample autocorrelation ρb are all positive, which suggests the

use of SN-NOT instead of BP as discussed in Section 3.2. In Figures C.1 and C.2 of the
supplementary material, we further plot the lag-1 to lag-30 ACF and PACF of the residuals,
which rules out the scenario of long memory and supports the validity of Assumption 2.1.
Figure 4.1 visualizes the estimated piecewise linear models for the eight countries, which
gives a more direct perception of how the growth rate changes over time. Note that the U.S.
and South Korea are the only two countries that witnessed an increase in the slope after
the first change-point. For the U.S., the first change-point is March 4, one day after the first
confirmed case appeared in New York. Since then, the pandemic underwent an outbreak in
the New York state, which has been the leading state in the U.S. in terms of infected cases.
The second change-point appeared on March 24, after which the slope began to drop. This
is also noteworthy as on March 20, the U.S. began barring entry of foreign nationals who
had traveled to 28 European countries within the past 14 days. While in South Korea, after
February 18, the infected cases increased drastically, and the slope dropped after March 3.
We find that the first change-point is the day when the first super-spreader in South Korea
was diagnosed 2 . The second change-point, March 3, is when the drive-through testing was
made widely available to Korean citizens.
The growth rate decreased after the first change-point in other countries. For the U.K.,
the first and second change-points are quite close. In particular, we find the U.K. governments gradually increased the restrictions on freedom of movement for the general
2

A member of the Shincheonji religious organization was diagnosed as 31st case in Daegu, see https:

//foreignpolicy.com/2020/02/27/coronavirus-south-korea-cults-conservatives-china/

17

public between these two change-points (March 20 and March 29). This could help explain
why both change-points are associated with significant drops in the virus growth rate.
In addition, we find that Italy extended the quarantine lockdown from region-focused to
nationwide on March 10, one day after the first estimated change-point. For Spain, the
first change-point is estimated as March 14, which is one day after Spain declared the nationwide state of emergency. Similar to Italy, the slopes dropped drastically after the first
change-point. Generally speaking, the first or second change-point of these countries are
closely associated with the date when local or nationwide interventions from the governments were initiated. These countries typically transition from a rapid growth phase to a
moderate growth phase after the first or second change-point. This may serve as evidence
that government intervention such as lockdown and massive testing could effectively slow
down the spread of the coronavirus.
From Figure 4.1, we also find the situations in Brazil, Russia and India rather somber, as
of May 27. Russia is still transitioning from the rapid growth phase to the moderate growth
phase, while the fast growing trend in Brazil has not changed since April 12. Even though
Brazil managed to bring down the slope by a significant amount at the first change-point
on March 25, it seemed the right-wing government took few follow-up effective measures.
The situation in India is also grim where the decreases of growth rate at the first and
second change-points are quite small and the current growth rate is still high, suggesting
that stricter measures to be taken. In summary, these three countries still have a long way
to go in terms of slowing down the spread of COVID-19.

18
Table 4.1
Summary of estimated models (1.1) for cumulative confirmed cases in 8 representative countries
Country
United States
Brazil
Russia
United Kingdom
Spain
Italy
India
South Korea

Start
Feb-22
Mar-09
Mar-12
Mar-01
Feb-28
Feb-23
Mar-05
Feb-06

n
96
80
77
88
90
95
83
112

No.CP
5
2
4
5
5
6
5
6

1st CP (S1 )
Mar-04 (0.113)
Mar-25 (0.301)
Apr-05 (0.218)
Mar-20 (0.254)
Mar-14 (0.359)
Mar-09 (0.289)
Mar-24 (0.159)
Feb-18 (0.022)

2nd CP (S2 )
Mar-24 (0.292)
Apr-12 (0.129)
Apr-21 (0.146)
Mar-29 (0.181)
Mar-27 (0.176)
Mar-22 (0.151)
Apr-02 (0.142)
Mar-03 (0.360)

Brazil
May−09

10

10

Apr−05

Apr−12

Yt

8

Yt

Mar−24

8

12

Apr−20

12

14

United States

Latest CP (Sm+1
)
b
May-09 (0.015)
Apr-12 (0.066)
May-17 (0.028)
May-12 (0.011)
May-01 (0.004)
May-18 (0.003)
May-09 (0.052)
May-08 (0.002)

4

4

6

6

Mar−25

Mar−04
Feb−22

Mar−11

Mar−30

Apr−18

May−07

May−27

Mar−09

Mar−24

Apr−25

May−11

May−27

United Kingdom

12

12

Russia

Apr−09

Apr−15

10

10

May−17
May−08
Apr−21

Apr−26

May−12

8

Yt

8

6

Mar−20

4

4

6

Yt

Mar−29
Apr−05

Mar−12

Mar−26

Apr−10

Apr−25

May−10

May−27

Mar−01

Mar−17

Apr−03

May−27

12

May−01
Apr−09Apr−19
10

Yt

Mar−14

8

Mar−31
Mar−22

8

10

Mar−27

Apr−14

May−03

May−18

Mar−09

4

6

6

Yt

May−07

Italy

12

Spain

Apr−20

Feb−28

Mar−16

Apr−03

Apr−21

May−09

May−27

Feb−23

Mar−12

Apr−19

May−08

May−27

South Korea
Apr−09Apr−22 May−08

7

Yt

8

Apr−14

5

6

Apr−02

4

Mar−24
4

Feb−18
3

Yt

Mar−16
Mar−03

8

May−09
Apr−24

6

10

9

12

India

Mar−31

Mar−05

Mar−21

Apr−06

Apr−22

May−08

May−27

Feb−06

Feb−27

Mar−20

Apr−11

May−03

May−27

ρb
0.492
0.438
0.573
0.575
0.611
0.616
0.375
0.749

19

4.3. Analysis of cumulative confirmed cases in 30 countries. We further extend the
scope of analysis to 30 countries to obtain a relatively complete picture of the pandemic
situations around the world. Specifically, we conduct a comparative study based on two
important quantities: the maximum normalized slope and the current normalized slope,
which are estimated by Smax = max1≤i≤m+1
n−1bbi and Scur = n−1bbm+1
respectively. Comb
b

bined together, the two measures allow us to obtain an overall picture of the phase when
the virus transmitted fastest and the current situation in each country. In particular, Smax
provides information on the growth rate at the early stage of the pandemic for a particular
country. In this phase, often no government regulations are imposed so it depicts the worst
scenario if no emergency measure is taken. Scur gives the ongoing epidemic growth rate
and could help make predictions in the short run.
In Figure 4.2, we plot Smax against Scur for each country. Note that by their relative
positions in Figure 4.2, the 30 countries can be roughly grouped into three clusters: East
Asian countries and Australia, European and North American countries and Other developing countries. We find that countries within the same cluster tend to have similar current
growth rate. China, South Korea, and Australia are among the best with Scur close to zero.
Most European and North American countries are in the second tier while countries in continental Europe generally have slower ongoing virus growth than the U.K., the U.S. and
Canada. The only exceptions are Sweden and Russia. In fact, Sweden adopted a different
strategy than other countries in that no lockdown has been imposed by the government
and large parts of its society remain open. Note that Figure 4.2 does not take the time
effect into account, thus the cluster along the horizontal direction may also be attributed
to the cluster of similar eruption time of the virus. This could help explain why Russia is
closer to developing countries and why Latin American countries have the largest Scur .
To take the time factor into consideration, in Figure 4.3, we plot the ratio Scur /Smax
against the days in between (i.e. τcur − τmax with τmax as the start date for the segment
with the largest slope and τcur = τm
b as the latest change-point), which allows us to further

20

understand how the growth rate changes from its peak to the current status with time.
Horizontally speaking, for the same ratio Scur /Smax , if country A is to the left of country B,
then A acts faster than B in bringing down the virus growth from its peak value. Vertically
speaking, for the same time length τcur − τmax , if A is below B, then A is more effective
than B in reducing the growth rate.
We again find that most European and North American countries tend to share similar
characteristics. The growth rates in the current phases for these countries are less than
one-tenth of their peak value, and it took them about two to three months to achieve
that. From the lower panel in Figure 4.3, we find that South Korea, China and Australia
outperform other countries as the ratios were brought to near zero in around 65 days.
Again, we find that continental European countries (except Russia and Sweden) perform
better than U.S, Canada and U.K.
Most developing countries are on the top-left of the plot, suggesting that they are still
in the relatively early stage of the pandemic and the situation has not improved much
since the beginning of the outbreak. In addition, we find Latin American countries, such as
Mexico, Brazil, Chile, and Peru, tend to cluster. Given their geographical proximity, this
is not a surprise. We note that developing countries tend to be less efficient in slowing the
spread of COVID-19. For example, with roughly the same amount of time, the ratios in
India and Argentina are three times larger than developed countries. In summary, more
caution and attention should be given to the epidemic in developing countries as they may
need more international aids compared to the developed countries.
4.4. Analysis of cumulative deaths in 30 countries. Based on the same methodology,
we analyze cumulative deaths in the 30 countries. Note that unlike confirmed cases, public
health interventions naturally have a longer lagged effect on coronavirus-related deaths, as
severe symptoms may not develop immediately upon infection. Thus, we believe a changepoint analysis on cumulative confirmed cases should be preferred in terms of quantifying
the effectiveness of emergency policies. Additionally, the criteria for certifying deaths due

21

to COVID-19 vary from nation to nation, thus comparative analysis across countries should
be interpreted with caution.
Table 4.2 summarizes the detailed estimation result for cumulative deaths in the eight
representative countries. Notably, for each country, the estimated number of change-points
for deaths is smaller than or equal to that for cumulative confirmed cases in Table 4.1.
This is intuitive as the history of cumulative deaths is shorter and number of deaths largely
depend on infections (with a lag). Note that the duration between the starting date and
the first change-point for cumulative deaths is around 2-3 weeks, which is consistent with
that for confirmed cases in Table 4.1. The same phenomenon also applies to the duration
between the first and second change-points. This consistency in part confirms the validity of
the change-point estimation results and indicates a 2-3 weeks response lag between changes
in growth rate of infections and changes in growth rate of deaths. We note that Italy and
Spain have the highest growth rate of cumulative deaths before the first change-point,
which highlights the extreme importance of “flattening the curve”, as it is known that
the exponential surge of coronavirus cases exhausted the public health system in the two
countries at the early stage of the pandemic.
Figure 4.4 further plots the estimated piecewise linear models for cumulative deaths in
the eight countries. The pattern exhibited by each country is largely consistent with its
pattern in Figure 4.1, except for South Korea. Note that the start date of the cumulative
death curve in South Korea is almost 30 days later than the start date of the cumulative
confirmed cases, which partially explains the different pattern around its first change-point.
We further conduct a comparative analysis for cumulative deaths in 30 countries. We
exclude China, Spain and Qatar in the analysis as the death tolls were either revised or
unavailable3 . Figure 4.5 plots Smax against Scur for each country. Similar to the results
for confirmed cases in Figure 4.2, European and North American countries tend to cluster
3

China revised its death toll upwards on April 17, see https://www.nytimes.com/2020/04/17/world/

asia/china-wuhan-coronavirus-death-toll.html. The death toll is not available for Qatar.

22
Table 4.2
Summary of estimated models (1.1) for cumulative deaths in 8 representative countries
Country
United States
Brazil
Russia
United Kingdom
Spain
Italy
India
South Korea

Start
Mar-09
Mar-23
Apr-02
Mar-15
Mar-10
Feb-29
Mar-29
Mar-02

n
80
66
56
74
79
89
60
87

No.CP
5
2
3
4
5
6
3
4

1st CP (S1 )
Mar-26 (0.229)
Apr-11 (0.195)
Apr-22 (0.149)
Apr-03 (0.254)
Mar-27 (0.307)
Mar-14 (0.305)
Apr-13 (0.179)
Mar-13 (0.100)

2nd CP (S2 )
Apr-09 (0.195)
May-01 (0.086)
May-03 (0.093)
Apr-19 (0.099)
Apr-05 (0.121)
Mar-22 (0.167)
May-06 (0.070)
Mar-30 (0.0518)

Latest CP (Sm+1
)
b
May-15 (0.012)
May-01 (0.056)
May-11 (0.043)
May-15 (0.008)
May-15 (-0.000∗ )
May-08 (0.005)
May-20 (0.039)
May-07 (0.003)

ρb
0.556
0.696
0.366
0.657
0.507
0.287
-0.012
0.363

∗. Spain revised its death toll downwards on May 25, see https://english.elpais.com/society/
2020-05-26/spanish-health-ministry-lowers-coronavirus-death-toll-by-nearly-2000.html.

while developing countries generally have higher ongoing growth rates Scur .
Note that South Korea and Australia deliver the best responses with small Smax and
near-zero Scur for cumulative deaths. However, it is unexpected to see that western developed countries, such as Italy and the U.K., experience the largest maximum growth rate.
Since the maximum growth rate always takes place in the first segment of the cumulative
death curve, it indicates that the coronavirus may take these countries by surprise and the
health systems may not be well prepared for the flood of coronavirus patients in the early
stage of the pandemic. Another notable pattern is that Latin American countries tend
to have larger values in both maximum and current growth rates than other developing
countries, signaling the possibility of Latin America becoming the next epicenter of the
COVID-19 pandemic.
Figure 4.6 plots Scur /Smax against τcur − τmax for cumulative deaths in each country,
where the observed patterns are similar to the ones for cumulative confirmed cases in
Figure 4.6. Specifically, developing countries again tend to be less efficient in slowing the
spread of COVID-19, where with roughly the same amount of time, the ratios Scur /Smax
in developing countries are noticeably larger than developed countries.

23

5. SN-NOT based forecast for cumulative deaths. As stated by the Centers for
Disease Control and Prevention (CDC)4 , accurate forecast of COVID-19 deaths is critical
for public health decision-making, as it projects the likely impact of coronavirus to health
systems in coming weeks and helps government officials develop data-driven public health
policies for controlling the pandemic.
In Section 5.1, we propose a simple and intuitive forecasting scheme for cumulative
deaths due to COVID-19 by combining SN-NOT with a flexible extrapolation function.
In Section 5.2, we further demonstrate its promising performance in predicting cumulative
deaths in the U.S.
5.1. Method. As suggested by the analysis in Section 4, the spread of coronavirus typically experiences several different stages due to external interventions. While a sophisticated
epidemiology model based on differential equations may manage to take into account information about interventions and characterize the entire cumulative death curve, a more
natural (and simpler) solution from the change-point aspect is to first segment the time
series into periods with relatively stable behavior and then generate forecast based on
observations in the last segment, see for example, Pesaran and Timmermann (2002) and
Bauwens et al. (2015).
Following this idea, we propose an SN-NOT based two-stage approach for cumulative
deaths prediction. Specifically, in the first stage, given the cumulative deaths (in log scale)
{Yt }nt=1 , a piecewise linear trend model is estimated via SN-NOT with change-points τb. In
the second stage, a flexible function f (t) is fitted on the last segment {Yt }nt=bτmb +1 with the

assumption that E(Yt ) = f (t) and the k-day ahead forecast for cumulative deaths can be
readily made via extrapolation of fb(t).

Note that the purpose of the first stage (in-sample) change-point analysis is to identify

the most recent segment where {Yt }nt=1 exhibits relatively stable behavior and thus facili4

https://www.cdc.gov/coronavirus/2019-ncov/covid-data/forecasting-us.html#

why-forecasting-critical

24

tates the second stage (out-of-sample) forecast. As demonstrated in Section 4, the piecewise
linear trend model with SN-NOT is sufficient for this task. However, as for prediction in the
second stage, any flexible extrapolation function f (t) can be considered, as it is expected
that a linear function may only provide a reasonable forecast for short horizons due to its
limited flexibility.
In the following, we consider three commonly used extrapolation functions (in the order
of increasing flexibility) in the literature, including the linear function f (t) = a + b(t/n),
the quadratic function f (t) = c + d(t/n) + e(t/n)2 and the logistic function f (t) =
L
.
1 + exp − α(t/n − t0 )
Based on {Yt }nt=bτmb +1 , a standard OLS can be used to estimate the linear and quadratic
functions and a standard nonlinear least square can be used to estimate the logistic function.
The k-day ahead forecast for Yn+k is formulated respectively as
SN-NOT + Linear [SNL]:

Ybn+k = b
a + bb(1 + k/n),

b + k/n) + eb(1 + k/n)2 ,
SN-NOT + Quadratic [SNQ]: Ybn+k = b
c + d(1

SN-NOT + Logistic [SNLG]:

Ybn+k =

b
L
.
1 + exp − α
b(1 + k/n − b
t0 )

\ n+k = exp(Ybn+k ).
The prediction for cumulative deaths on day n + k is Death

5.2. Data and prediction results. We apply the SN-NOT based prediction method to
forecast cumulative deaths in the U.S. and compare its performance with other forecasting
models listed on the CDC website5 . Specifically, following the CDC website, the forecast is
generated on five dates, April-27, May-04, May-11, May-18 and May-25, and the forecast
horizon is 5-day (one-week) ahead and 12-day (two-week) ahead.
We compare with five forecasting models6 available on the CDC website: “LANL” by
Los Alamos National Laboratory (2020), “Imperial” by Unwin et al. (2020), “UT” by
5
6

https://www.cdc.gov/coronavirus/2019-ncov/covid-data/forecasting-us.html
Other models can be found on the CDC website. The five models are chosen as their predictions are

available on all the aforementioned dates while other models only report on some of the recent dates.

25

University of Texas (2020), “YYG” by Gu (2020) and “MOBS” by Laboratory for the
Modeling of Biological and Socio-technical Systems (2020). These forecasting methods are
mainly ensembles of complex mechanistic models (such as SEIR and SEIS), known as
compartmental models in epidemiology, which track the spread of infectious disease via a
system of differential equations. To highlight the importance of the first-stage change-point
analysis, we additionally report the forecast given by fitting a logistic function on the entire
time series without segmentation (and name it “Logistic”).
Table 5.1 reports the prediction results and the findings can be summarized as follows.
(1) SNL gives comparable performance to other methods for the 5-day ahead forecast,
while it considerably overestimates deaths at the 12-day horizon. In other words, linear
extrapolation can only be used for short-term forecasts. This is not surprising as the linear
function essentially assumes a constant growth rate for the cumulative deaths. While such
an approximation is reasonable for short-term, it may not be able to track the growth rate
for a long period to make accurate predictions. SNQ generally performs better than SNL
due to its increased flexibility, though it tends to underestimate at the 12-day horizon as
the quadratic function may pass its peak for long-horizon extrapolation.
(2) SNLG is consistently a top performer among all models thanks to the flexibility
of the logistic function, which ensures the fitted curve is non-decreasing and is capable
of tracking both increasing and decreasing growth rate. Note that there is a drastic performance difference between the two-stage SNLG forecast and the pure Logistic forecast,
which indicates the value of the first-stage change-point estimation for identifying the most
recent segment where cumulative deaths exhibit relatively stable behavior.
In summary, the SN-NOT based two-stage prediction, in particular SNLG, provides
decent forecasts for the cumulative deaths in the U.S. Considering that SNLG is solely
based on the time series of cumulative deaths, this result is rather promising and further
confirms the value and validity of the change-point analysis. Though by no means SNLG
can replace the complex mechanistic models built on epidemiology principles, we believe

26

it can serve as a meaningful addition to the existing set of forecasting models for tracking
the COVID-19 pandemic.
Table 5.1
Prediction performance for cumulative deaths in the U.S. (the top 3 performers on each forecast date are
highlighted in bold).
Date

Target

True

Imperial

LANL MOBS
UT
End-of-Week
Forecast 66527
66837
69410 63029 58720
Apr-27 May-02
Rel.error
/
0.47% 4.33% -5.26% -11.74%
Forecast 78946
79511
78755 77035 70646
May-04 May-09
Rel.error
/
0.72% -0.24% -2.42% -10.51%
Forecast 88893
91528
87022 88922 87666
May-11 May-16
Rel.error
/
2.96%
-2.10% 0.03% -1.38%
Forecast 97220
98076
96582 97252 96128
May-18 May-23
Rel.error
/
0.88%
-0.66% 0.03% -1.12%
Forecast 103915 104671 104085 104241 104736
May-25 May-30
Rel.error
/
0.73% 0.16% 0.31% 0.79%
Date Target
True Imperial∗ LANL MOBS
UT
Two-week
84837 70156 65903
Forecast 78946
Apr-27 May-09
Rel.error
/
7.46% -11.13% -16.52%
Forecast 88893
90078 85827 78243
May-04 May-16
Rel.error
/
1.33% -3.45% -11.98%
Forecast 97220
93997 97513 96232
May-11 May-23
Rel.error
/
-3.32% 0.30% -1.02%
Forecast 103915
103461 104443 101060
May-18 May-30
Rel.error
/
-0.44% 0.51% -2.75%
Forecast 109802
110640 110285 111759
May-25 June-06
Rel.error
/
0.76% 0.44% 1.79%

YYG

SNLG

SNL

SNQ

Logistic

73317
10.21%
77522
-1.80%
88767
-0.14%
97625
0.42%
104436
0.50%
YYG

65067
-2.19%
77178
-2.24%
88128
-0.76%
97573
0.36%
103923
0.01%
SNLG

70376
5.79%
85775
8.65%
86331
2.88%
99432
2.28%
108080
4.01%
SNL

63775
-4.14%
75703
-4.11%
84965
-4.42%
97307
0.09%
103197
-0.69%
SNQ

55480
-16.61%
62930
-20.29%
69702
-21.59%
75659
-22.18%
80887
-22.16%
Logistic

77336
-2.04%
87608
-1.45%
98365
1.18%
106432
2.42%
111799
1.82%

74244
-5.96%
85896
-3.37%
96136
-1.11%
105985
1.99%
109708
-0.09%

93730
18.73%
109953
23.69%
124580
28.14%
111822
7.61%
119971
9.26%

67565
-14.42%
79531
-10.53%
89205
-8.24%
104819
0.87%
106995
-2.56%

58341
-29.72%
64625
-29.21%
70719
-27.26%
76269
-26.60%
81251
-26.00%

∗. Imperial only gives one-week ahead forecast.

References.
Andrews, D. W. (1993). Tests for parameter instability and structural change with unknown change point.
Econometrica 61 (4), 821–856.
Aue, A. and L. Horváth (2013). Structural breaks in time series. Journal of Time Series Analysis 34 (1),
1–16.
Bai, J. (1994). Least squares estimation of a shift in linear processes. Journal of Time Series Analysis 15 (5),
453–472.
Bai, J. (1997). Estimation of a change point in multiple regression models. Review of Economics and
Statistics 79 (4), 551–563.

27
Bai, J. and P. Perron (1998). Estimating and testing linear models with multiple structural changes.
Econometrica 66 (1), 47–78.
Baranowski, R., Y. Chen, and P. Fryzlewicz (2019). Narrowest-over-threshold detection of multiple change
points and change-point-like features. Journal of the Royal Statistical Society: Series B (Statistical
Methodology) 81 (3), 649–672.
Bauwens, L., G. Koop, D. Korobilis, and J. V. Rombouts (2015). The contribution of structural break
models to forecasting macroeconomic series. Journal of Applied Econometrics (30), 596620.
Chen, J. and A. K. Gupta (2011). Parametric statistical change point analysis: with applications to genetics,
medicine, and finance. Springer Science & Business Media.
Chen, Y. J. Y. and Y. Gu (2018). Subspace change-point detection: A new model and solution. IEEE
Journal of Selected Topics in Signal Processing 12(6), 1224–1239.
Cho, H. and P. Fryzlewicz (2015). Multiple change-point detection for high-dimensional time series via
sparsified binary segmentation. Journal of the Royal Statistical Society: Series B (Statistical Methodology) 77 (2), 475–507.
Crainiceanu, C. and T. Vogelsang (2007). Nonmonotonic power for tests of mean shift in a time series.
Journal of Statistical Computation and Simulation 77(6), 457–476.
Fan, Z. and L. Mackey (2017). An empirical bayesian analysis of simultaneous changepoints in multiple
data sequences. The Annals of Applied Statistics 11(4), 2200–2221.
Fryzlewicz, P. (2014). Wild binary segmentation for multiple change-point detection. The Annals of
Statistics 42 (6), 2243–2281.
Gromenko, O., P. Kokoszka, and M. Reimherr (2017). Detection of change in the spatiotemporal mean
function. Journal of the Royal Statistical Society: Series B (Statistical Methodology) 79 (1), 29–50.
Gu, Y. (2020). YYG Model. https://covid19-projections.com/.
Hubert, L. and P. Arabie (1985). Comparing partitions. Journal of Classification 2 (1), 193–218.
Kiefer, N. and T. Vogelsang (2005). A new asymptotic theory for heteroskedasticity-autocorrelation robust
tests. Econometric Theory 21, 1130–1164.
Laboratory for the Modeling of Biological and Socio-technical Systems (2020).

Modeling of covid-

19 epidemic in the united states. https://uploads-ssl.webflow.com/58e6558acc00ee8e4536c1f5/
5e8bab44f5baae4c1c2a75d2_GLEAM_web.pdf/.
Los Alamos National Laboratory (2020). LANL Model. https://covid-19.bsvgateway.org/.
Maidstone, P. F. R. and A. Letchford (2019). Detecting changes in slope with an L0 penalty. Journal of
Computational and Graphical Statistics 28 (2), 265–275.
Olshen, A. B., S. Venkatraman, R. Lucito, and M. Wigler (2004). Circular binary segmentation for the
analysis of array-based dna copy number data. Biostatistics 5 (4), 557–572.

28
Perron, P. (2006). Dealing with structural breaks. Palgrave Handbook of Econometrics 1 (2), 278–352.
Pesaran, M. H. and A. Timmermann (2002). Market timing and return prediction under model instability.
Journal of Empirical Finance 9 (5), 495–510.
Rho, Y. and X. Shao (2015). Inference for time series regression models with weakly dependent and
heteroscedastic errors. Journal of Business & Economic Statistics 33 (3), 444–457.
Shao, X. (2010). A self-normalized approach to confidence interval construction in time series. Journal of
the Royal Statistical Society: Series B (Statistical Methodology) 72 (3), 343–366.
Shao, X. (2015). Self-normalization for time series: a review of recent developments. Journal of the American
Statistical Association 110 (512), 1797–1817.
Shao, X. and X. Zhang (2010). Testing for change points in time series. Journal of the American Statistical
Association 105 (491), 1228–1240.
Truong, C., L. Oudre, and N. Vayatis (2020). Selective review of offline change point detection methods.
Signal Processing 167.
University of Texas (2020). The University of Texas COVID-19 Modeling Consortium. https://covid-19.
tacc.utexas.edu/projections/.
Unwin, H. J. T., S. Mishra, V. C. Bradley, et al. (2020). Report 23 - state-level tracking of covid-19 in the
united states. doi:https://doi.org/10.25561/79231.
Wu, W. (2005). Nonlinear system theory: Another look at dependence. Proceedings of the National Academy
of Sciences of the United States of America 102(40), 14150–14154.
Wu, W. and X. Shao (2004). Limit theorems for iterated random functions. Journal of Applied Probability 41, 425–436.
Zhang, T. and L. Lavitas (2018). Unsupervised self-normalized change-point testing for time series. Journal
of the American Statistical Association 113 (522), 637–648.
Zhou, Z. and X. Shao (2013). Inference for linear models with dependent errors. Journal of the Royal
Statistical Society: Series B (Statistical Methodology) 75 (2), 323–343.

29

Smax vs Scur (confirmed cases)
IRI

0.4
0.3
0.2

Smax

East Asia and Australia
Europe and North America
Other Developing Countries

PAK

CHI

CHN
TUR
ESP
NED
POR
FRA
ROK BEL
GER
ITA
GBR
SUI
AUS

SWE

PER

BRA

USA

RSA
INA

CAN

RUS

KSA

MEX

ARG

0.1

IND
QAT
JPN

0.00

0.01

0.02

0.03

0.04

0.05

0.06

Scur

0.35

Smax vs Scur (confirmed cases) in the dashed frame

CHN

TUR

0.30

NED
POR

FRA
BEL

ROK

0.25

Smax

ESP

GER
ITA

GBR

SUI

0.20

AUS

0.000

0.002

0.004

0.006

0.008

0.010

Scur

Fig 4.2. Plot of maximum normalized slope Smax and normalized slope after the latest change-point Scur for
cumulative confirmed cases of each country. Black ∆: East Asian Countries and Australia; red +: European
and North American Countries; blue •: Other developing countries.

30

0.4

Scur/Smax vs τcur − τmax (confirmed cases)

IND

East Asia and Australia
Europe and North America
Other Developing Countries
ARG

0.2

MEX
RSA

KSA

CHI
INA PER

0.1

Scur/Smax

0.3

QAT

RUS
PAK

JPN

CAN

0.0

POR

40

TUR
ROK
CHN

50

60

NED
AUS

USA
SWE
IRI
BEL
ESP

70

GBR
FRA GER
SUI

ITA

80

τcur − τmax

Scur/Smax v. s. τcur − τmax (confirmed cases) in the dashed frame

GBR

IRI

0.02

Scur/Smax

0.04

USA
SWE

TUR
BEL
NED
AUS

ROK

0.00

GER
FRA

ESP
SUI

CHN

60

65

70

75

80

τcur − τmax

Fig 4.3. Plot of ratio between the current normalized slope Scur and maximum normalized slope Smax against
days from the start date for the segment with the largest slope to the start date for the latest segment for
cumulative confirmed cases of each country. Black ∆: East Asian Countries and Australia; red +: European
and North American Countries; blue •: Other developing countries.

31

Brazil

Apr−30

May−15

8

Apr−20

9

10

10

United States

May−01

7

Apr−11

6

Yt

Yt

8

Apr−09

3

4

4

5

6

Mar−26

Mar−09

Mar−24

Apr−09

Apr−25

May−11

May−27

Mar−23

Apr−04

Apr−17

May−27

10
9

7

May−15

Apr−03

3

4

4

5

6

Apr−22

7

Yt

6

May−03

5

May−02

Apr−19

8

May−11

Yt

May−13

United Kingdom

8

Russia

Apr−30

Apr−02

Apr−12

Apr−23

May−04

May−15

May−27

Mar−15

Mar−28

Apr−11

May−27

10

May−03 May−15

9

Apr−19

Apr−12
Apr−03

Apr−26 May−08

8

8

Apr−05
Mar−22

Yt

Mar−14

6

7

Mar−27

4

4

5

6

Yt

May−09

Italy

10

Spain

Apr−25

Mar−10

Mar−24

Apr−08

Apr−23

May−08

May−27

Feb−29

Mar−16

Apr−19

May−06

May−27

South Korea
May−07

Mar−30

May−06

5

4.0

Yt

4.5

7

May−20

6

Apr−20

5.0

8

5.5

India

Mar−13

3.5

Apr−13

3.0

4

Yt

Apr−02

Mar−29

Apr−09

Apr−21

May−03

May−15

May−27

Mar−02

Mar−18

Apr−04

Apr−21

May−08

May−27

Fig 4.4. Estimated piecewise linear trend for cumulative deaths in 8 representative countries

32

0.20

East Asia and Australia
Europe and North America
Other Developing Countries

ITA
GBR
BEL
FRA
GER
NED
TUR
SUI

USA
PER

POR
SWE

MEX
BRA

CAN

IND

0.15

IRI

0.10

Smax

0.25

0.30

Smax vs Scur (deaths)

RUS

INA

CHI

ARG KSA

ROKAUS

RSA

0.05

PAK
JPN

0.00

0.02

0.04

0.06

Scur

0.30

Smax vs Scur (deaths) in the dashed frame

0.26

ITA

GBR

Smax

BEL
FRA

0.22

GER
NED
TUR

0.18

SUI

IRI

0.002

0.003

0.004

0.005

0.006

0.007

0.008

0.009

Scur

Fig 4.5. Plot of maximum normalized slope Smax and normalized slope after the latest change-point Scur
for cumulative deaths of each country. Black ∆: East Asian Countries and Australia; red +: European and
North American Countries; blue •: Other developing countries.

33

Scur/Smax vs τcur − τmax (deaths)
East Asia and Australia
Europe and North America
Other Developing Countries

0.4

CHI

PAK
BRA

RUS
ARG
JPN

0.2

Scur/Smax

0.6

RSA

KSA
MEX

IND

INA

PER
CAN

0.0

POR

SWE
AUS

30

SUI

40

NED

TUR

50

BEL

GBR
GER

60

USA
IRI
ROK ITA
FRA

70

τcur − τmax

0.06

Scur/Smax v. s. τcur − τmax (deaths) in the dashed frame

0.04

IRI

GBR
ROK

0.02

Scur/Smax

USA

ITA

GER
BEL

0.00

FRA

60

65

70

τcur − τmax

Fig 4.6. Plot of ratio between the current normalized slope Scur and maximum normalized slope Smax
against days from the start date for the segment with the largest slope to the start date for the latest segment
for cumulative deaths of each country. Black ∆: East Asian Countries and Australia; red +: European and
North American Countries; blue •: Other developing countries.

34

Supplement to “Time series analysis of COVID-19 Infection Curve: a
change-point perspective”
This supplement consists of three parts. Appendix A contains technical proofs. Appendix
B extends the piecewise linear structure of model (1.1) to piecewise polynomial and presents
an analysis for cumulative confirmed cases in 8 representative countries using a piecewise
quadratic model. Appendix C provides the lag-1 to lag-30 (P)ACF plots of the residuals
for cumulative confirmed cases in the 8 countries presented in Section 4.2.
APPENDIX A: PROOFS
In what follows, we denote ⇒ as the weak convergence on D[ǫ, 1], the space of functions
on [ǫ, 1] which are right continuous and have left limits, endowed with Skorohod metric.
Let Xn ∈ Rd with dimension d > 0 be a set of random vector defined in a probability space
(Ω, P, F). For a corresponding set of constants an , we say Xn = Ops (an ) if for any ε > 0,
there exists a finite M > 0 and a finite N > 0 such that for n > N ,
P(kXn /an kd > M ) + P(kXn /an kd < 1/M ) < ε,
where kkd denotes the Ld norm.
Proof of Theorem 2.1 (i) It is a direct application of Theorem 3.1 in Rho and Shao
(2015) and continuous mapping theorem. In particular, the result of (i) in Theorem 3.1 in
Rho and Shao (2015) corresponds to the case of (i) in Assumption 2.1 for linear processes
while the result of (ii) in Theorem 3.1 in Rho and Shao (2015) corresponds to the case of
(ii) in Assumption 2.1 for nonlinear processes.
(ii) On one hand, note that the continuous mapping theorem indicates that
Ln,δ (1, τ , n) ⇒ Γ2 Lδ (κ),

and

Rn,δ (1, τ , n) ⇒ Γ2 Rδ (κ).

and it follows that Vn,δ (1, τ , n) ⇒ Γ2 Vδ (κ).
On the other hand,

√
√ 
Dn (1, τ , n) =κ(1 − κ) n βb 1,ττ − βbτ +1,n + b − κ(1 − κ) nb,

35

and it is clear that

√ b
b
κ(1 − κ) n β
1,ττ − β τ +1,n + b

⇒κ(1 − κ)ΓQ(κ)−1 BF (κ) − Γ[Q(1) − Q(κ)]−1 [BF (1) − BF (κ)] = ΓD(κ).
Then the continuous mapping theorem indicates that
(nkbk22 )−1 Dn (1, τ , n)⊤ Vn,δ (1, τ , n)−1 Dn (1, τ , n)

(A.1)

−1
⊤
−1
s
⇒κ2 (1 − κ)2 (kbk−1
2 b) Vδ (κ) (kbk2 b) = Op (1).

Here the last equality uses the fact that RHS of (A.1) is greater than 0 with probability 1,
or equivalently, Lδ (κ) and Rδ (κ) is positive definite with probability 1, which will hold by
similar arguments in Lemma A.1 using CauchySchwarz inequality.
Observe that maxk Tn,δ (k) ≥ Dn (1, τ , n)⊤ Vn,δ (1, τ , n)−1 Dn (1, τ , n) = Ops (nkbk22 ). The

result follows by noting nkbk22 → L and L → ∞,

Proof of Theorem 2.2 Note that by (A.1), we have shown that with probability
−1
⊤
−1
s
tending to one, (nkbk22 )−1 Tn,δ (ττ ) ≥ κ2 (1 − κ)2 (kbk−1
2 b) Vδ (κ) (kbk2 b) = Op (1).

Then, let Mn,η = {k : | nk − κ| > η}, it suffices to show that
(nkbk22 )−1

max

k∈[h,n−h]∩Mn,η

Dn (1, k, n)⊤ Vn,δ (1, k, n)−1 Dn (1, k, n) = op (1).
(1)

(1)

By symmetricity, we can consider Mn,η = {k : nk < κ − η}, and on {k ∈ Mn,η }, we have
k
τ
k(n − k) n
β (1) − β (2) )
[Qn (1) − Qn ( )]−1 [Qn (1) − Qn ( )](β
Dn (1, k, n) =
3/2
n
n
n

k
k −1 
k o
k
Bn,F (1) − Bn,F ( ) .
+ n−1/2 Qn ( )−1 Bn,F ( ) − n−1/2 Qn (1) − Qn ( )
n
n
n
n
k
n→∞ n

Let ν = lim

:= lim

n→∞

k(n)
n ,

then by similar arguments in (i) of Theorem 2.1, we have

(A.2)
−1
−1
−1/2
n−1/2 kbk−1
kbk−1
2 Dn (1, k, n) = ν(1 − ν)[Q(1) − Q(ν)] [Q(1) − Q(κ)]kbk2 b + Op (n
2 ).

Next, since k < τ − nη, we decompose Rn,δ (1, k, n) by
Rn,δ (1, k, n) =

h

τ +⌊nδ⌋−1

X

i=k+3+⌊nδ⌋

+

n−1−⌊nδ⌋ i

X

i=ττ +⌊nδ⌋

(i − 1 − k)2 (n − i + 1)2 b
(β i,n − βb k+1,i−1 )⊗2
n2 (n − k)2

36

:=Rn,δ,1 (1, k, n) + Rn,δ,2 (1, k, n).
It follows easily that Vn,δ (1, k, n)−1 ≤ Rn,δ (1, k, n)−1 ≤ Rn,δ,2 (1, k, n)−1 where for semipositive definite matrices A and B, A ≤ B indicates B − A is semi-positive definite.
In addition, we have
n−1−⌊nδ⌋

Rn,δ,2 (1, k, n) =

X

i=ττ +⌊nδ⌋

(i − 1 − k)2 (n − i + 1)2 b
(β i,n − βbk+1,i−1 )⊗2 ,
n2 (n − k)2

where for r ∈ (κ, 1) uniformly, we can show

√ b
n β ⌊nr⌋,n − βb ⌊nν⌋+1,⌊nr⌋−1 − [Q(r) − Q(ν)]−1 [Q(κ) − Q(ν)]b


−1 

⇒Γ[Q(1) − Q(r)]−1 [BF (1) − BF (r)] − Γ Q(r) − Q(ν)
BF (r) − BF (ν) = Ops (1).
Therefore, if follows that
(nkbk22 )−1 Rn,δ,2 (1, k, n)
Z 1−δ
(A.3)
o⊗2
(r − ν)2 (1 − r)2 n
−1
−1
kbk
[Q(r)
−
Q(ν)]
[Q(κ)
−
Q(ν)]b
dr := Rδ,2 (ν).
⇒
2
(1 − ν)2
κ+δ
By Lemma A.1, when ν < κ, Rδ,2 (ν) is invertible, hence
(A.4)
(nkbk22 )−1 Dn (1, k, n)⊤ Vn,δ (1, k, n)−1 Dn (1, k, n)
−1  −1/2


⊤ 
n
kbk−1
(nkbk22 )−1 Rn,δ,2 (1, k, n)
=(nkbk22 )−1 n−1/2 kbk−1
2 Dn (1, k, n)
2 Dn (1, k, n)
n
o⊤
b
⇒(nkbk22 )−1 ν(1 − ν)[Q(1) − Q(ν)]−1 [Q(1) − Q(κ)]kbk−1
Rδ,2 (ν)
2
n
o
× ν(1 − ν)[Q(1) − Q(ν)]−1 [Q(1) − Q(κ)]kbk−1
2 b ⇒0
by (A.2) and (A.3).

Lemma A.1.

Rδ,2 (ν), defined in (A.3), is invertible for ν < κ and kbk2 6= 0.

37

Proof of Lemma A.1
Note that


[Q(κ) − Q(ν)] =(κ − ν) 

1

κ+ν
2

κ+ν
2

ν 2 +κ2 +κν
3



r 2 +ν 2 +rν
3
−3 

[Q(r) − Q(ν)]−1 =12(r − ν)

− r+ν
2



,
− r+ν
2
1



.

We first let b = (b1 , b2 )⊤ , then


−1 
[Q(κ) − Q(ν)]kbk−1
2 b = (κ − ν)kbk2

κ+ν
2 b2

b1 +
κ+ν
2 b1

+

ν 2 +κ2 +κν
b2
3



 := (w1 , w2 )′ .

Therefore we obtain


r+ν
r 2 +ν 2 +rν
w
−
w
12(1
−
r)
(r − ν)(1 − r)
1
2
3
2


[Q(r) − Q(ν)]−1 [Q(κ) − Q(ν)]kbk−1
2 b=
r+ν
(1 − ν)
(r − ν)2 (1 − ν)
w +w
−
2


⊤
:= g1 (r, ν, κ, b1 , b2 ), g2 (r, ν, κ, b1 , b2 ) .

1

2

Then, since
Rδ,2 (ν) =

Z

1−δ
κ+δ



⊤ 

(g1 (r, ν, κ, b1 , b2 ), g2 (r, ν, κ, b1 , b2 )
(g1 (r, ν, κ, b1 , b2 ), g2 (r, ν, κ, b1 , b2 ) dr,

the invertibility of Rδ,2 (ν) is equivalent to that det(Rδ,2 (ν)) > 0 (as Rδ,2 (ν) is clearly
semi-positive definite), i.e.
Z
Z 1−δ
2
g1 (r, ν, κ, b1 , b2 ) dr
κ+δ

1−δ

κ+δ

Z
g2 (r, ν, κ, b1 , b2 ) dr−[
2

1−δ

g1 (r, ν, κ, b1 , b2 )g2 (r, ν, κ, b1 , b2 )dr]2 > 0,

κ+δ

which is implied by CauchySchwarz inequality as long as
(A.5)

g1 (r, ν, κ, b1 , b2 )
2(r 2 + ν 2 + rν)w1 − 3(r + ν)w2
=
g2 (r, ν, κ, b1 , b2 )
−6(r + ν)w1 + 12w2

is not a constant for all r ≥ κ.

38

To see this, suppose Rδ,2 (ν) is not invertible, then (A.5) is a constant for all r ≥ κ. Note
that the numerator and the denominator of RHS of (A.5) can be written in a quadratic
form of r as
(A.6)

2w1 r 2 + (2νw1 − 3w2 )r + (2ν 2 w1 − 3νw2 ),

(A.7)

0r 2 − 6w1 r + (−6νw1 + 12w2 ),

respectively.
Therefore, comparing coefficients of the quadratic functions (A.6) and (A.7) w.r.t r, it
must hold that w1 = 0, and hence w2 = 0, i.e.
b1 +

κ+ν
b2 = 0,
2

and

κ+ν
ν 2 + κ2 + κν
b1 +
b2 = 0.
2
3

Solving these equations for b1 and b2 we obtain that b1 = b2 = 0, contradiction.
Hence, Rδ,2 (ν) is invertible.

APPENDIX B: PIECEWISE POLYNOMIAL TREND MODEL
In this section, we extend the piecewise linear structure in model (1.1) of the main text
to a piecewise polynomial structure. We further apply a piecewise quadratic trend model
to analyze the cumulative confirmed cases in 8 representative countries as in Section 4.2.
B.1. Model formulation and inference.

We extend the piecewise linear trend

model (1.1) by allowing higher order polynomial terms. Specifically, let the time series
{Yt }nt=1 admit
(p)

(B.1) Yt = β ⊤
t Ft

+ ut = β0,t + β1,t (t/n) + · · · + βp,t (t/n)p + ut , t = 1, · · · , n,
(i)

(β0,t , · · · , βp,t )⊤ = β (i) = (β0 , · · · , βp(i) )⊤ , τi−1 + 1 ≤ t ≤ τi , for i = 1, · · · , m + 1,
(p)

where Ft

= (1, t/n, · · · , (t/n)p )⊤ and β t = (β0,t , · · · , βp,t )⊤ are the coefficients at time

t with fixed p ≥ 1. Same as in model (1.1), {ut } is a weakly dependent stationary error

39

process, τ = (τ1 , · · · , τm ) denotes the m ≥ 0 change-points with the convention that τ0 = 0
and τm+1 = n, and we require β (i) 6= β (i+1) , i = 1, · · · , m. Model (B.1) extends the piecewise

linear model by allowing for polynomial trends and provides more flexibility of modeling
observations in each segment.
The estimation procedure of model (B.1) is essentially the same as the one for model
(1.1). Given the grid parameter ǫ, we let h = ⌊ǫn⌋. Define F (p) (s) = (1, s, · · · , sp )⊤ . For
i−1 P
hP
j
j
(p) (t/n)Y as the
(p)
(p)
⊤
b
β
1 ≤ i < j ≤ n, we denote i,j =
(t/n)F (t/n)
t
t=i F
t=i F
OLS estimator of β based on {Yt }jt=i . Let the trimming parameter satisfy 0 ≤ δ < ǫ/2.
2
For any 1 ≤ t1 < k < t2 ≤ n, given the subsample {Yt }tt=t
and a potential change-point
1

(p)

(p)

k, we define a contrast statistic Dn (t1 , k, t2 ), and the self-normalizer Vn,δ (t1 , k, t2 ) =
(p)

(p)

Ln,δ (t1 , k, t2 ) + Rn,δ (t1 , k, t2 ) in the same spirit as (2.1), (2.2) and (2.3) by:
Dn(p) (t1 , k, t2 ) =

(k − t1 + 1)(t2 − k) b
(β t1 ,k − βb k+1,t2 ),
(t2 − t1 + 1)3/2
k−p−1−⌊nδ⌋

(p)
Ln,δ (t1 , k, t2 )

X

=

i=t1 +p+⌊nδ⌋

(i − t1 + 1)2 (k − i)2
(βb − βb i+1,k )⊗2 ,
(k − t1 + 1)2 (t2 − t1 + 1)2 t1 ,i

t2 −p−⌊nδ⌋
(p)
Rn,δ (t1 , k, t2 )

X

=

i=k+2+p+⌊nδ⌋

(i − 1 − k)2 (t2 − i + 1)2 b
(β i,t2 − βbk+1,i−1 )⊗2 .
(t2 − t1 + 1)2 (t2 − k)2

Then, the test statistic targeting against the one change-point alternative is defined as:
Gn(p) =

(p)

max

k∈{h,··· ,n−h}

Define Q(p) (r) =

Rr
0

Tn,δ (k),

(p)

(p)

Tn,δ (k) = Dn(p) (1, k, n)⊤ Vn,δ (1, k, n)−1 Dn(p) (1, k, n).
(p)

F (p) (s)F (p) (s)⊤ ds and BF (r) =

Rr
0

F (p) (s)dB(s) where B(·) is a

standard Brownian motion. The following theorem extends Theorem 2.1 in the main text.
Theorem B.1.

Suppose Assumption 2.1 holds. Then,

(i) under H0 , we have
D

Gn(p) −→ G(p) (ǫ, δ) :=

sup
η∈(ǫ,1−ǫ)

(p)

D (p) (η)⊤ Vδ (η)D (p) (η),

40
(p)

(p)

(p)

where D (p) (η) and Vδ (η) = Lδ (η) + Rδ (η) have the similar expression as given in
Theorem 2.1, except F (·) and Q(·) are replaced by F (p) (·) and Q(p) (·) respectively.
(ii) under Ha , given that nkbk22 → L, we have
lim lim Gn(p) = ∞,

L→∞ n→∞

in probability.

The proof is a simple extension of Appendix A, hence omitted.
B.2. Analysis of cumulative confirmed cases in 8 representative countries.
We use the piecewise quadratic trend model, i.e. model (B.1) with p = 2 to re-analyze
the cumulative confirmed cases in the 8 countries as in Section 4.2. Figure B.1 gives the
estimated models for each country. As can be seen, compared to Figure 4.1 in the main
text, the estimated number of change-points decreases for every country, which is intuitive
as more flexibility is brought into the model. For most countries, a piecewise quadratic
model with one or two change-points fits the data reasonably well.
However, compared to the piecewise linear trend model, the quadratic model losses its
interpretability as the parameters of each segment cannot be naturally linked to growth
rate. Thus the meaning of “change-point” needs a more delicate definition. Moreover,
within each segment, the growth rate of the virus still changes from day to day, making it
difficult to interpret the behavior of the estimated segments. For example, we find that most
estimated change-points can hardly be associated with the initiations of emergency public
health measures, as the intervention effect may have been absorbed into the quadratic
function. Therefore, we prefer the piecewise linear trend model for the analysis.

41

Brazil
12

14

United States

Mar−31

4

4

6

6

8

Mar−21

8

Yt

Yt

10

10

12

Apr−10

Feb−22

Mar−11

Mar−30

Apr−18

May−07

May−27

Mar−09

Mar−24

12

May−15

May−27

Yt

10

6

8

8

10

Apr−23

4

4

6

Yt

May−11

United Kingdom

Apr−26

Mar−12

Mar−26

Apr−10

Apr−25

May−10

May−27

Mar−01

Mar−17

Apr−03

Apr−20

May−07

May−27

Italy
12

12

Spain
May−06

Apr−05

May−12

8

8

Yt

10

10

Apr−01

4

6

6

Yt

Apr−25

12

Russia

Apr−09

Feb−28

Mar−16

Apr−03

Apr−21

May−09

May−27

Feb−23

Mar−12

India

Mar−31

Apr−19

May−08

May−27

9

12

South Korea

8

Apr−04

Apr−21May−04

7

Yt

8

4

5

6

Apr−06

4

Feb−17
3

Yt

Mar−12

6

10

May−10
Apr−25

Mar−05

Mar−21

Apr−06

Apr−22

May−08

May−27

Feb−06

Feb−27

Mar−20

Apr−11

May−03

Fig B.1. Estimated piecewise quadratic trend for 8 representative countries

May−27

42

APPENDIX C: ACF AND PACF PLOTS OF RESIDUALS (AFTER FITTING
PIECEWISE LINEAR TREND MODEL) FOR CUMULATIVE
CONFIRMED CASES IN 8 COUNTRIES

0.5
ACF
0.0
−0.5

−0.5

0.0

ACF

0.5

1.0

Brazil, ACF

1.0

United States, ACF

10

15

20

25

30

0

5

10

15

20

25

30

20

25

30

20

25

30

20

25

30

Lag

Lag

Russia, ACF

United Kingdom, ACF

0.5
ACF
0.0
−0.5

−0.5

0.0

ACF

0.5

1.0

5

1.0

0

10

15

20

25

30

0

5

10

15

Lag

Lag

Spain, ACF

Italy, ACF

0.5
ACF
0.0
−0.5

−0.5

0.0

ACF

0.5

1.0

5

1.0

0

10

15

20

25

30

0

5

10

15

Lag

Lag

India, ACF

South Korea ,ACF

0.5
ACF
0.0
−0.5

−0.5

0.0

ACF

0.5

1.0

5

1.0

0

0

5

10

15
Lag

20

25

30

0

5

10

15
Lag

Fig C.1. ACF plot of residuals for 8 representative countries

43

15

20

25

30

0

10

15

20

25

30

20

25

30

20

25

30

25

30

Lag

Russia, PACF

United Kingdom, PACF

Partial ACF

−0.2
−0.6

−0.6

10

15

20

25

30

0

5

10

15

Lag

Lag

Spain, PACF

Italy, PACF

Partial ACF

−0.2
−0.6

−0.6

−0.2

0.2 0.4 0.6 0.8

5

0.2 0.4 0.6 0.8

0

5

10

15

20

25

30

0

5

10

15

Lag

Lag

India, PACF

South Korea, PACF

−0.2
−0.6

−0.6

−0.2

Partial ACF

0.2 0.4 0.6 0.8

0

0.2 0.4 0.6 0.8

Partial ACF

5

Lag

0.2 0.4 0.6 0.8

10

0.2 0.4 0.6 0.8

5

−0.2

Partial ACF

0

Partial ACF

0.2 0.4 0.6 0.8
−0.6

−0.6

−0.2

Partial ACF

0.2 0.4 0.6 0.8

Brazil, PACF

−0.2

Partial ACF

United States, PACF

0

5

10

15
Lag

20

25

30

0

5

10

15
Lag

Fig C.2. PACF plot of residuals for 8 representative countries

20

44
Center for Statistical Science

Department of Information Technology, Analytics, and Operations

and Department of Industrial Engineering Mendoza College of Business
Tsinghua University

University of Notre Dame

Beijing 100084, China

Notre Dame, Indiana 46556, U.S.A.

E-mail: jfy16@mails.tsinghua.edu.cn

E-mail: zzhao2@nd.edu

Department of Statistics
University of Illinois at Urbana Champaign
Champaign, Illinois 61820, U.S.A.
E-mail: xshao@illinois.edu

