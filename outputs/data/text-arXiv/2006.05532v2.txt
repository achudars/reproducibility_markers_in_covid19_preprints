arXiv:2006.05532v2 [q-bio.PE] 7 Jul 2020

Masks and COVID-19: a causal framework for
imputing value to public-health interventions
Andres Babino,1∗ Marcelo O. Magnasco,1
1

Laboratory of Integrative Neuroscience, Rockefeller University,
∗

Corresponding author. E-mail: ababino@rockefeller.edu.

During the COVID-19 pandemic, the scientific community developed predictive models to evaluate potential governmental interventions. However, the
analysis of the effects these interventions had is less advanced. Here, we propose a data-driven framework to assess these effects retrospectively. We use a
regularized regression to find a parsimonious model that fits the data with the
least changes in the Rt parameter. Then, we postulate each jump in Rt as the
effect of an intervention. Following the do-operator prescriptions, we simulate
the counterfactual case by forcing Rt to stay at the pre-jump value. We then
attribute a value to the intervention from the difference between true evolution
and simulated counterfactual. We show that the recommendation to use facemasks for all activities would reduce the number of cases by 170000 (95% CI
160000 to 180000) in Connecticut, Massachusetts, and New York State. The
framework presented here might be used in any case where cause and effects
are sparse in time.
The burst of the COVID-19 pandemic forced governments around the globe to take health
1

care interventions. One that caused significant controversies is the use of masks among the general public (1–3). Initially, it was assumed that the primary mode of transmission of SARS-CoV-2
was through coughing or contact with surfaces. Extensive shortages of personal protective
equipment for health workers led to an initial recommendation for the general population not to
wear masks. While no extant studies show surgical masks reduce transmission of SARS-CoV-2
in humans, surgical masks do reduce viral shedding of other coronaviruses (4), and transmission
of SARS-CoV-2 in animal models (5). Also, cloth masks might filter SARS-CoV-2 (6).
The Centers for Disease Control and Prevention (CDC) changed its guidelines on April 3,
2020, and recommended the widespread use of masks (7). According to the CDC, the rationale
behind its policy change was the increase in evidence that asymptomatic and presymptomatic
people are infectious (8–13) and that there are many undetected cases (14). On June 5, the
World Health Organization (WHO) changed its guidelines and recommended governments to
encourage the general public to wear masks in specific situations, like grocery stores (15). However, WHO specifies: “At present, there is no direct evidence (from studies on COVID19 and in
healthy people in the community) on the effectiveness of universal masking of healthy people in
the community to prevent infection with respiratory viruses, including COVID-19” (15). Meanwhile, according to The European Centre for Disease Prevention and Control (ECDC), there is
no evidence that masks can prevent people from being infected (16), and they suggest the use of
masks may increase the risk of infection. The reason for the WHO and ECDC statements is that
there is no work on the widespread use of masks by the general public as a non-pharmaceutical
intervention (NPI). In this paper, we aim to fill this gap by testing the hypothesis that the policy
change regarding masks by the CDC (and local governments) decreased the number of positive
cases in the states of Connecticut (CT), Massachusetts (MA), New York (NY), Rhode Island
(RI), and Virginia (VA).
To assess causality, we need to evaluate both branches of an intervention (17): one in which
2

the intervention did happen, and one in which it did not. The gold standard to do so is the
double-blind randomized control trial (RCT) paradigm. Although possible (18), RTCs are not
the norm in public health epidemiological intervention. Even if implemented, there is no such
thing as a “placebo arm” for travel restrictions or a double-blind school closure. Since a placebo
or double-blind trials are not possible, there is an indirect causal path between the treatment and
the outcome (19,20). For example, people in zip codes with open schools might be more careful
with their hygiene because they know that they are at a higher risk than people in zip codes
where the schools are closed. When the second branch of the intervention did not happen, it is
called a counterfactual (“contrary to the facts”). One option to measure the direct effect of an
intervention, and the one that we use in this work, is to estimate or simulate the counterfactual
branch (21, 22).
Here, we present a framework to analyze data from the COVID-19 epidemic that can simulate counterfactual scenarios in which specific NPI did not occur. In this framework, we use the
odds of a positive test as the dependent variable, rather than the number of positive tests (23)
or deaths (24). We motivate a linear equation for the evolution of this dependent variable using
the Susceptible-Infected-Recovered (SIR) model (25, 26). Finally, we carry out a LASSO (27)
regression to fit the data, to obtain a piecewise-linear fit to the logarithm of the odds with the
smallest number of breaks (see the supplementary material). This regression finds the times
when interventions started, allowing us to simulate alternative scenarios where these interventions did not happen and assess their net impact.
The daily number of cases and tests are highly variable (Fig. 5). To reduce this variability, we compute the log-odds, the logarithm of the number of positive tests over the number
of negative ones. Doing this, reveals a piecewise linear pattern that we fit using the LASSO
regression (Fig. 6). These regressions show three breakpoints in the log-odds in NY, two in CT,
MA, MI, and RI, and one in VA. We should stress the fact that these breaks are not an input
3

of the user. On the contrary, this is the result of applying the LASSO regularization. These
changepoints happen after different NPIs. The first change in CT and MA, and the first and
second in NY, are due to mobility restrictions (school closure, ban mass gatherings, restriction
the non-essential workforce, and stay-at-home orders). In these states, the last break happens
after the CDC changed its guidelines regarding masks. In MI, RI, and VA, the stay at home
orders and the CDC recommendation to wear masks happened closer in time, making it hard to
disentangle their effects. However, the MI government only enforced the use of masks in closed
areas (like grocery stores), and the VA government never recommended the use of masks. We
assume that the lack of local orders correlates negatively with local compliance with the CDC
guidelines, and that explains why we do not see the masking effect on MI and VA.
We use the slopes of the regression to compute the Rt , the instantaneous reproduction number (28). This parameter expresses the average number of people infected from one positive
case on day t. In Fig. 7, we show Rt as a function of time. The NY plot, in Fig. 7, shows
Rt dropping down from 2.1 to 1.6 and then to 0.72 on March 30, 8 days after the closure of
all nonessential business. Taking them together, this translates to a reduction by 65 % on Rt
due to mobility restrictions. There is a third drop from 0.72 to 0.44 on April 14, 11 days after
the CDC changed their guidelines and recommended to wear masks, and two days after NY
enforced the use of masks for public employees. In CT, the stay-at-home orders reduced the
value of Rt by 51%. Moreover, after the new CDC recommendation on masks, it dropped by
40%. Remarkably, in MA, after the stay at home order the Rt value dropped from 1.9 to 1.1,
still above 1. Only after the recommendation of wearing masks it fell to 0.66, below 1. As we
already mentioned, we do not see the effect of masks in MI or VA, and we attribute this to the
lack of local compliance. In MI, the government only enforced the use of masks in enclosed
areas, and the VA government never ruled on the use of masks. The data from RI is harder to
interpret because stay-at-home orders and masks guidelines happened close in time, and data
4

from before April are unreliable (with less than 500 tests a day). Nonetheless, there is an effect
from the CDC guidelines and from local governments making masks mandatory.
Finally, one advantage of the sparsifying framework is that we can simulate counterfactual
scenarios by removing a breakpoint. Then, the regressed line would have continued at the previous slope. Take the case of the public wearing masks. From the fit shown in Fig. 4, we observe
that on April 14 in NY, Rt changed from 0.72 to 0.44. We interpret that the counterfactual to
this intervention is that if the public had not used masks, Rt would have stayed at 0.72, or in
causal inference jargon do(no masks). Fig. 4 (green line) shows that removing the intervention
would have resulted in a much more drawn-out dwindling of the case curve. Now, we can use
the counterfactual odds to calculate the counterfactual number of positive and compare it with
the actual number of positive cases Doing this yields that, between Apr. 14 and May 15, wearing masks had the effect of decreasing the number of infections by 71000 cases (95% CI 64000
to 78000), in NY. Similarly, the use of masks reduced the number of positive cases by 68000
cases (95% CI 65000 to 70000) in MA between Apr. 13 and May 19, and by 29000 cases (95%
CI 27000 to 31000) in CT from Apr. 14 to May 17.
In conclusion, we found that masks reduced the spread of the virus in CT, MA, and NY.
In those states, our calculations showed that the intervention reduced the Rt by 40%, and we
estimate that masking prevented 170000 cases (95% CI 160000 to 180000) from the moment
they were adopted until the end of the stay-at-home orders. These results are consistent with
recently published results by Mitze and colleagues that found the same effect in Germany (29).
Also, we estimate that in New York City alone, masks reduced the number of cases by 17900
(95% CI 15800 to 20000) between April 17 and May 9. This number is below the one estimated
by Zhang and colleagues who estimated a reduction in 66000 cases during the same period in
New York City (30). We believe the discrepancy can be accounted for by noting that Zhang and
colleagues did not consider the increase in testing during the stay-at-home order in, leading to
5

a higher difference after the masking order at which point the testing was more stable.
The framework that we presented is data-driven, and therefore it relies on only a handful
of hypotheses as compared to other methods For example, the counterfactual analysis relies on
one hypothesis: the log-odds are piecewise linear (see Eq. 6 in the supplementary material)–
without the need to assume any of the hypotheses of the SIR model. Based on the goodness of
fit, we are confident that this hypothesis holds for the datasets presented here (see Fig. 2 and
the supplementary material). Also, to put the framework to the test, we apply the method to
synthetic data, and we found that it was able to find the corresponding breakpoints and slopes
(see the supplementary text). Nevertheless, when there are no reliable figures on negative test
results, our framework fails to fit the data (see the supplementary material). More detailed data
will be necessary to build better models in the future. Ideally, the data would be organized in a
case-by-case fashion and it would contain information on the sample criterion. Fundamentally,
this information should also be available also for negative tests.
Overall, we found evidence that masks reduce the spread of the SARS-CoV-2 and prevent
new infections. We hope that our findings will persuade local authorities and intergovernmental
institutions to strongly recommend the use of masks to prevent the spread of SARS-CoV-2. We
arrived at this conclusion by merging two different traditions: causal inference and regularized
regression. We believe that the union of these techniques will be fruitful in other contexts where
the causes and effects are sparse in time.

Acknowledgments
We thank Will Meierjurgen Farr, Gustavo Stolovitzky, and Joel E. Cohen for their comments
and suggestions. Authors contributions: AB performed the data curation, the formal analysis and the software development. MOM supervised the project and provided resources.
All authors contributed to the conceptualization and the preparation the original draft. Com6

peting interests: The authors declare no competing interests. Data and materials availability:

all the data and codes to reproduce our analysis are publicly available at https:

//github.com/ababino/corona.

Supplementary materials
Materials and Methods
Supplementary Text
Figs. S1 to S5
Tables S1 to S4
References (31-35)

References
1. K. A. Prather, C. C. Wang, R. T. Schooley, Science (New York, N.Y.) (2020).
2. L. Morawska, J. Cao, Airborne transmission of SARS-CoV-2: The world should face the
reality (2020).
3. S. Feng, et al., The Lancet Respiratory 8, 434 (2020).
4. C. C. Leung, T. H. Lam, K. K. Cheng, Mass masking in the COVID-19 epidemic: people
need guidance (2020).
5. J. F.-W. Chan, et al., Clinical Infectious Diseases .
6. A. Konda, et al., ACS Nano 14, 6339 (2020).
7. Recommendation Regarding the Use of Cloth Face Coverings — CDC (2020 (accessed June 3, 2020)). https://www.cdc.gov/coronavirus/2019-ncov/
prevent-getting-sick/cloth-face-cover.html.
7

8. C. Rothe, et al., New England Journal of Medicine 382, 970 (2020).
9. L. Zou, et al., SARS-CoV-2 viral load in upper respiratory specimens of infected patients
(2020).
10. X. Pan, et al., Asymptomatic cases in a family cluster with SARS-CoV-2 infection (2020).
11. Y. Bai, et al., Presumed Asymptomatic Carrier Transmission of COVID-19 (2020).
12. A. Kimball, et al., Asymptomatic and presymptomatic SARS-COV-2 infections in residents
of a long-term care skilled nursing facility - King County, Washington, March 2020 (2020).
13. W. E. Wei, et al., MMWR. Morbidity and mortality weekly report 69, 411 (2020).
14. R. Li, et al., Science (New York, N.Y.) 368, 489 (2020).
15. W. H. Organization, et al., Advice on the use of masks in the context of covid-19: interim
guidance, 5 june 2020, Tech. rep., World Health Organization (2020).
16. Q & A on COVID-19 (2020 (accessed June 3, 2020)). https://www.ecdc.europa.
eu/en/covid-19/questions-answers.
17. J. Pearl, Causality (Cambridge university press, 2009).
18. J. Haushofer, C. J. E. Metcalf, Science p. eabb6144 (2020).
19. L. Kennedy-Shaffer, M. Lipsitch, medRxiv p. 2020.05.01.20087429 (2020).
20. R. Kahn, A. Rid, P. G. Smith, N. Eyal, M. Lipsitch, PLoS Medicine 15 (2018).
21. H. Fang, L. Wang, Y. Yang, Human mobility restrictions and the spread of the novel coronavirus (2019-ncov) in china, Working Paper 26906, National Bureau of Economic Research
(2020).
8

22. H. Tian, et al., Science (New York, N.Y.) 368, 638 (2020).
23. V. P. Jonas Dehning, Johannes Zierenberg, F. Paul Spitzner, Michael Wibral, Joao Pinheiro
Neto, Michael Wilczek, Science eabb9789 (2020).
24. S. Flaxman, et al., Imperial College London pp. 1–35 (2020).
25. W. O. Kermack, A. G. McKendrick, Proceedings of the royal society of london. Series A,
Containing papers of a mathematical and physical character 115, 700 (1927).
26. H. W. Hethcotet, SIAM Review 42, 599 (2016).
27. R. Tibshirani, Journal of the Royal Statistical Society: Series B (Methodological) 58, 267
(1996).
28. L. M. Bettencourt, R. M. Ribeiro, PLoS ONE 3 (2008).
29. T. Mitze, R. Kosfeld, J. Rode, K. Wälde (2020).
30. R. Zhang, Y. Li, A. L. Zhang, Y. Wang, M. J. Molina, Proceedings of the National Academy
of Sciences 117, 202009637 (2020).
31. Q. Li, et al., New England Journal of Medicine 382, 1199 (2020).
32. Q. Bi, et al., medRxiv (2020).
33. Z. Du, et al., Emerging infectious diseases 26, 2019 (2020).
34. B. Efron, et al., Annals of Statistics 32, 407 (2004).
35. G. Schwarz, et al., The annals of statistics 6, 461 (1978).

9

Figure 1: Daily number of new cases and test for each state in the dataset.

10

Figure 2: The odds of a positive test in logarithmic scale. Under the assumptions of the model,
this variable should be piece-wise linear. The blue dots are the data points. The orange lines
regressed model and the orange shades are is the 95% C.I.

11

Figure 3: Rt as a function of time. The dashed vertical lines indicate different governmental interventions. Orange lines indicate mobility restriction orders such as closing bars, gyms, movie
theaters, schools, and banning non essential work. The black line show the moment at which
the CDC updated its guidelines to recommend wearing masks. The green lines show moments
at which the local states changed their guidelines regarding masks. NY and RI enforced the
use of masks for some jobs first, and later on they enforced mask wearing policies among the
general public. MA and CT enforced the use masks by the general public. MI only enforced
the use of masks in enclosed public areas, such as grocery stores. VA never enforced the use of
masks.
12

Figure 4: Actual and counterfactual scenarios. The blue dots are the data points. The orange
lines show the regressed model, and the orange shades are the 95% C.I. The green lines show
the counterfactual odds of the scenario where masks were not recommended; in causal inference
jargon, do(not masks); and the green shaded areas are the 95% C.I.

13

Supplementary Materials for
Masks and COVID-19: a causal framework for imputing value
to public-health interventions
This PDF file includes:
Materials and Methods
Supplementary Text
Figs. S1 to S5
Tables S1 to S4

Materials and Methods
Data
We collected data from States that offer raw data on the number of tests and positive cases each
day. We found that 16 States offer that information. Some of them offer an Abstraction Protocol
Interface (API). Others serve a file with the information. Many states offer a visual dashboard
with information on testing, but if they do not offer raw data, we did not use it. There is at least
one project that collects data on testing from all the states: https://covidtracking.
com/. This aggregator builds its database based on snapshots of the dashboards published by
the states. The information in these snapshots is averaged three or four times a day. This process
makes the accumulated number of tests and positives reliably, but not their daily change. That is
why we did not use information from this aggregator, and we only use direct information from
official sources. We provide links to each dataset in Table 1
In the main text, we show results for six datasets with the highest R2 . To show the robustness
and also limitations of the framework here, we show an analysis for all the states where we
found data on the daily number of cases and tests. In the main text, we limit the analysis to the

14

time in which NYS, MA, and CT ended their stay-at-home order. To show the robustness of the
framework, here we show the results when we apply the method to a bigger timespan. Since,
due to backlog, some states have a delay in reporting of about one week, we included data until
the last day we find reliable data.

The odds as the dependent variable
As can be seen in Fig. 5 the number of daily positive tests, Positivet , oscillates in synchrony
with the number of tests. To overcome this source of noise, we propose to use the odds of a
positive test:
Oddst =

Positivet
Negativet

where Negativet is the number of negative tests on day t.
We show the number of positives and the number of tests for each dataset in Fig. 5
We show the evolution of the Odds in Fig. 6. The noise due to the variation in the number
of tests is reduced, and a trend emerges.

The evolution of the Odds
As shown previously (28), under the SIR model hypotheses, the number of newly infected
individuals in a given day, kt , can be approximated as:
kt = kt−1 e(Rt−1 −1)γ
where Rt is the instantaneous reproduction number (28), and γ −1 is the average infectious
period (26) estimated as 7.5 days (95% CI 5.3 to 195.3) according to (31) (in agreement with
(32), but higher than reported in (33)).
Since we do not have access to the total number of infected individuals, but only to the
tested population, we have to use some statistical assumptions about this population. If we
15

assume that the people being tested is a random sample of the population with COVID-19-like
symptoms, we can state that1 :

Positivet = Pt (I|symptoms)Pt (symptoms)N ft

(1)

where Pt (I|symptoms) is the probability of a patient being positive for SARS-CoV-2 given
that she is symptomatic, Pt (symptoms) is the probability of having COVID-19-like symptoms,
N is the total population, and ft is the fraction of people with symptoms that are selected to
be tested (this number can be different each day, for example, if the number of tests available
changes). Similarly:
Negativet = Pt (notI|symptoms)Pt (symptoms)N ft

(2)

where Pt (notI|symptoms) is the probability of a patient being SARS-CoV-2 negative given he
has COVID-19-like symptoms.
Now, if we assume that Pt (symptoms|I) = cte, we can use Bayes theorem to show that:

Pt (I|symptoms)Pt (symptoms) ∝ Pt (I) =

kt
N

Then:
Pt (I|symptoms)Pt (symptoms) ∝ kt

(3)

Finally, if we assume that Pt (notI|symptoms)Pt (symptoms) = cte:
Oddst =

Pt (I|symptoms)Pt (symptoms)N ft
Pt (notI|symptoms)Pt (symptoms)N ft

Oddst =

Pt (I|symptoms)Pt (symptoms)
Pt (notI|symptoms)Pt (symptoms)
Oddst ∝ kt

1

The following derivation was suggested to us by Will Meierjurgen Farr on this GitHub Issue https://
github.com/k-sys/covid-19/issues/45#issuecomment-623782130

16

Oddst = Oddst−1 e(Rt−1 −1)γ

(4)

We used four sets of hypotheses. First, we use the assumptions of the SIR model. Second,
we use that the tested population is a random sample from the population with COVID-19like symptoms (Eqs. 1 and 2). This assumption does not hold, for example, if the basis for
testing someone is that she was in contact with a confirmed case. Third, we assume that
Pt (notI|symptoms)Pt (symptoms) = cte. This hypothesis is equivalent to say that the number
of people with COVID-19-like symptoms but without the SARS-CoV-2 (for example, people
with the flu) is constant, or its change rate is negligible compared with the change rate in the
number of symptomatic people with SARS-CoV-2. Fourth, we use that the symptoms show up
instantaneously and that the tests are performed and processed on the same day (Eq. 3). This last
hypothesis is not true, and it is the reason why, in our analysis, the effects of the interventions
show a delay to onset between 8 and 11 days.

Linearization
We write Eq. 4 as a linear function of the rate of change of Rt . Defining

bt = e(Rt −1)γ

(5)

Oddst = bt−1 ∗ Oddst−1

(6)

We can write Eq. 4 as:

Now, instead of using bt as the parameters to estimate we decompose each bt as follows:

bt =

t
Y
i=0

17

ai

(7)

The ai s represent the rate of change of the variable bt in logarithmic scale. Next, we replace
the 7 in 6

Oddst =

t−1
Y

ai ∗ Oddst−1

i=1

Oddst =

t−1
Y

ai ∗

i=1

t−2
Y

ai ∗ Oddst−2

i=1
t−1
k
YY

Oddst =

ai ∗ Odds1

k=1 i=1

Oddst =

t−1
Y

at−i
∗ Odds1
i

i=1

Now, we linearize this result, and we generalize it to the case where t = 0 using the max
function:
max(t−1,1)

log(Oddst ) =

X

(t − i)log(ai ) + log(Odds1 )

(8)

i=1

We can write 8 as a linear problem with the following definitions:

y = Xβ + β0

(9)

yt = log(Oddst )

(10)

Xt,i = max(t − i, 0)

(11)

βt = log(at )

(12)

Importantly, the SIR hypotheses are only necessary to draw the connection to Rt (Eq. 5).
However, Eq. 8 might hold even if the SIR hypotheses do not. What would change is the
interpretation of the parameters.

18

LASSO regression and feature selection
Since in Eq. 9, we have as many regressors as samples, and we assume that the changes in a
are only due to top-down interventions we use a LASSO regression to fit the data (27). This
regression minimizes the loss function:
Err =

n
n−1
n−1
X
X
1X
(yt − β0 −
βi Xt,i )2 + α
|βi |
n t=1
i=1
i=0

(13)

This approach finds a sparse set of βi . We add two extra steps to sparsify even further this set
of parameters. If there are contiguous βi 6= 0, we set to zero all of them but the first in the chunk.
Then, we fit the selected regressors using ordinary least squares, and we recursively remove the
betai with p-values∗ > 0.01, where p-values∗ are the Bonferroni corrected p-values. Using
the LARS algorithm (34), we repeat these steps for different values of the hyperparameter α,
and we use the fit that minimizes the Bayesian Information Criterion (35).
We show the result of this procedure in Fig. 8. In the top row of the figure, we show the
change in the parameters as the value of α changes. In the second row, we show, for a given α,
the set of parameters yielded by the LASSO regression–most of these values are zero. The dots
in the second row are the parameters that are selected because they are the first of a non-zero
chunk, and their p-values∗ after applying a linear regression are smaller than 0.01. Finally, in
the third row, we show the BIC value of all the possible models. We show the goodness of fit of
the final stage of the framework for each dataset in Table 2, and the value and statistics of each
parameter in Table 3.

From fitted parameters to Rt
To compute the value of Rt from fitter parameters, we have to use equations 12, 7 and 5. From
these equations, we arrive at the following equality:
Pt

Rt =

i=0

γ
19

βi

+1

(14)

Where most of the βi values are zero. Using this formula, we arrive at the values presented in
Fig. 3 and Table 1 (main text). We show the Rt values for all states with data in Fig. 7.

Supplementary Text
Simulations
To test the framework, we show that it is able to estimate the parameters from simulated data.
We use the SIR equations:
dS
SI
= −β
dt
N
SI
dI
=β
− γI
dt
N
dR
= γI
dt

(15)
(16)
(17)

where S is the number of susceptible individuals, I the number of infected individuals, R the
number of recovered (or death) individuals, β is the contact rate and γ the inverse of the average
infectious period. Also, R0 = β/γ
In our simulation we change the value of β at times t = 21, t = 41, and t = 61, from a initial
value of β = 0.26 to β = 0.2, and then to β = 0.093 and β = 0.053. Also we set γ = 7.5−1
We chose these values because the Rt are similar to the one in the NYS dataset. After carrying
out the simulation we compute the log-odds= log(I/S) and add noise  N (0, 0.05) We show
the results applying the framework to this data in Fig. 9 and the real and estimated values in
Table 4. Initially, the framework estimates Rt = 1.7 (1.95, 2.0) 95% CI. This value is below the
R0 = 2 of the model, which is reasonable given that the framework should estimate the mean
value of Rt in a segment, which is always below R0 (26). The second discontinuity is found at
t = 39 and last one at t = 59, two days before the real change.
This analysis shows that the framework can detect the number of discontinuities correctly,
and it also estimates the value of Rt accurately and the times of the breaks with no more than 2
20

Table 1: Information about the source of the datasets used in this work
Link to information
https://coronavirus-response-alaska-dhss.hub.arcgis.com/datasets/dailytest-positivity/data
Colorado
https://data-cdphe.opendata.arcgis.com/datasets/cdphe-covid19-dailystate-statistics/data
Connecticut
https://data.ct.gov/Health-and-Human-Services/COVID-19-PCR-BasedTest-Results-by-Date-of-Specime/qfkt-uahj
Delaware
https://myhealthycommunity.dhss.delaware.gov/locations/state
Indiana
https://hub.mph.in.gov/dataset/covid-19-case-trend/resource/182b6742edac-442d-8eeb-62f96b17773e
Iowa
https://coronavirus.iowa.gov/
Massachusetts https://www.mass.gov/info-details/covid-19-response-reporting
Michigan
https://www.michigan.gov/coronavirus/0,9753,7-406-98163 98173—
,00.html
Minnesota
https://www.health.state.mn.us/diseases/coronavirus/situation.html
New York
https://health.data.ny.gov/Health/New-York-State-Statewide-COVID-19Testing/xdss-u53e
Rhode Island https://docs.google.com/spreadsheets/d/1n-zMS9Al94CPj Tc3K7AdintN9x1RSjjx2UzJ4SV7Q/edit#gid=590763272
Tennessee
https://www.tn.gov/health/cedep/ncov/data/downloadable-datasets.html
Texas
https://www.dshs.texas.gov/coronavirus/
Virginia
https://www.vdh.virginia.gov/coronavirus/
Wisconsin
https://data.dhsgis.wi.gov/datasets/covid-19-historical-datatable/data?where=GEO%20%3D%20%27State%27
Wyoming
https://health.wyo.gov/publichealth/infectious-disease-epidemiologyunit/disease/novel-coronavirus/covid-19-testing-data/
Dataset
Alaska

days of error.

21

Figure 5: Daily number of new cases and tests for each state in the dataset.
22

Figure 6: The odds of a positive test in logarithmic scale. Under the assumptions of the model,
this variable should be piecewise linear. The blue dots are the data points. The orange line is
the LASSO fit, and the orange shade is the 95% C.I.
23

Figure 7: Rt as a24function of time.

Figure 8: Steps of the framework. First row: coefficient values as a function of the parameter
α. As the value of α increases, the parameters collapse to zero. The black vertical line shows
the selected value of α. Second row: coefficient values at the selected α. At the final α, most
of the coefficients are zero; if two of them are non zero in a row, we select the first one in the
chunk. With the selected coefficients, we carry out a linear fit, and we iteratively remove the
coefficients with p-value∗ < 0.01. The dots indicate the parameters that were selected, either
for being the first of a chunk or being significant. Third row: BIC as a function of α. Since we
performed these steps for all the α values, we compute the BIC for each of them. Then, we pick
the one with the lowest BIC value.

25

Figure 9: Simulated data using the SIR equations and the results from applying the framework.
Left panel: estimated Rt as a function of time. Right panel: simulated odds and final fit.

Table 2: Goodness of fit for each dataset.
State
R2
N D.F.
F-value
p-value
New York
0.996 102
4 6308.081088 2.989901e-116
Massachusetts 0.984
87
3 1666.265804 5.057106e-74
Michigan
0.983
89
5 987.866820 2.324393e-72
Connecticut
0.981
88
3 1438.831575 4.534263e-72
Rhode Island 0.952
85
2 810.885200 9.517308e-55
Virginia
0.918
86
3 305.468584 2.184829e-44
Delaware
0.886
92
3 228.607283 2.038413e-41
Iowa
0.872 86
3 185.719315 1.862787e-36
Wisconsin
0.811 83
2 171.824297 1.105016e-29
Colorado
0.804
96
2 191.334575 1.095911e-33
Minnesota
0.640
84
2
71.849515 1.131865e-18
Alaska
0.589
89
2
61.705125 2.401719e-17
Indiana
0.457 92
2
37.520871 1.521898e-12
Tennessee
0.398
88
2
28.101998 4.283584e-10
Wyoming
0.203
84
2
10.312295 1.023745e-04
Texas
0.079 34
1
2.752898 1.068493e-01

26

Table 3: Parameter values and statistics for the selected model for each dataset
Dataset
Coef. Name Coefficient 95% C.I.
p-value
New York
x1
0.146
(0.126, 0.167)
1.94e-20
New York
x2
−0.071
(−0.106, −0.036) 1.60e-04
New York
x3
−0.112
(−0.135, −0.089) 7.51e-14
New York
x4
−0.038
(−0.047, −0.029) 8.96e-12
New York
const
−1.70
(−1.81, −1.59)
4.50e-37
Connecticut
x1
0.128
(0.104, 0.152)
2.90e-15
Connecticut
x2
−0.132
(−0.163, −0.101) 9.93e-12
Connecticut
x3
−0.052
(−0.064, −0.039) 2.57e-11
Connecticut
const
−1.54
(−1.70, −1.39)
6.68e-27
Massachusetts x1
0.118
(0.110, 0.126)
2.02e-38
Massachusetts x2
−0.102
(−0.113, −0.091) 2.55e-26
Massachusetts x3
−0.062
(−0.068, −0.056) 1.43e-28
Massachusetts const
−2.65
(−2.72, −2.58)
5.36e-61
Michigan
x1
0.062
(0.052, 0.071)
5.51e-19
Michigan
x2
−0.140
(−0.154, −0.126) 2.03e-27
Michigan
x3
0.034
(0.022, 0.047)
1.22e-06
Michigan
const
−1.42
(−1.54, −1.30)
1.67e-31
Rhode Island x1
0.010
(0.001, 0.018)
3.12e-02
Rhode Island x2
−0.048
(−0.061, −0.035) 2.45e-09
Rhode Island const
−1.93
(−2.04, −1.81)
7.02e-33
Virginia
x1
0.0171
(0.0141, 0.0202)
1.21e-15
Virginia
x2
−0.030
(−0.035, −0.025) 1.18e-15
Virginia
const
−2.22
(−2.27, −2.16)
1.24e-56

Table 4: Simulated and estimated values of Rt
t β/γ t̂
Rt
95% CI
0
2
0 1.97 (1.95, 1.99)
21 1.5 21 1.50 (1.47, 1.51)
41 0.7 39 0.73 (0.71, 0.75)
61 0.4 59 0.39 (0.38, 0.40)

27

