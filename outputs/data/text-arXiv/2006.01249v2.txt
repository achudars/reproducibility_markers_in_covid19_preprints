arXiv:2006.01249v2 [math.OC] 10 Nov 2020

CONTROLLING PROPAGATION OF EPIDEMICS VIA MEAN-FIELD
CONTROLS
WONJUN LEE, SITING LIU, HAMIDOU TEMBINE, WUCHEN LI, AND STANLEY OSHER

Abstract. The coronavirus disease 2019 (COVID-19) pandemic is changing and impacting lives on a global scale. In this paper, we introduce a mean-field control model
in controlling the propagation of epidemics on a spatial domain. The control variable,
the spatial velocity, is first introduced for the classical disease models, such as the SIR
model. For this proposed model, we provide fast numerical algorithms based on proximal primal-dual methods. Numerical experiments demonstrate that the proposed model
illustrates how to separate infected patients in a spatial domain effectively.

1. Introduction
The outbreak of COVID-19 epidemic has resulted in over millions of confirmed cases
and hundred thousands of deaths globally. It has a huge impact on global economy as well
as everyone’s daily life. There has been a lot of interest in modeling the dynamics and
propagation of the epidemic. One of the well-known and basic models in epidemiology
is the SIR model proposed by Kermack and McKendrick [1] in 1927.
Here, S, I, R
represent the number of susceptible, infected and recovered people respectively. They use
an ODE system to describe the transmission dynamics of infectious diseases among the
population. As the propagation of COVID-19 has significant spatial characteristic, actions
such as travel restrictions, physical distancing and self-quarantine are taken to slow down
the spread of the epidemic. It is important to have a spatial-type SIR model to study the
spread of the infectious disease and movement of individuals [2, 3, 4].
Since the epidemic has affected the society and individuals significantly, mean-field
games and mean field controls (MFG, MFC) provide a perspective to study and understand
the underlying population dynamics. Mean-field games were introduced by Jovanovic and
Rosenthal [5], Huang, Malhamé, and Caines [6], and Lasry and Lions [7, 8]. They model
a huge population of agents playing dynamic games. There is growing research interest
in this direction. For a review of MFG theory, we refer to [9, 10]. With wide application
to various fields [11, 12, 13, 14], computational methods are also designed to solve related
high dimensional MFG problems [15, 16, 17, 18, 19, 20].
In this paper, we combine the above ideas of spatial SIR model and MFG. In other
words, we introduce a mean-field game (control) model for controlling the virus spreading
within a spatial domain. Here the goal is to minimize the number of infectious agents
and the amount of movement of the population. In short, we formalize the following
This work is supported by AFOSR MURI FA9550-18-1-0502.
1

2

LEE, LIU, TEMBINE, LI, AND OSHER

constrained optimization problem
Z
inf
(ρi ,vi )i∈{S,I,R}

T

Z

X

E(ρI (T, ·)) +
0

Ω i∈{S,I,R}

αi
c
ρi |vi |2 + (ρS + ρI + ρR )2 dxdt
2
2

subject to

η2


∂t ρS + ∇ · (ρS vS ) + βρS ρI − S ∆ρS = 0


2




η2

∂t ρI + ∇ · (ρI vI ) − βρS ρI + γρI − I ∆ρI = 0
2

2


η


∂t ρR + ∇ · (ρR vR ) − γρI − R ∆ρR = 0


2


ρ (0, ·), ρ (0, ·), ρ (0, ·) are given.
S

I

R

Here ρi represents population density and vi describes the movement, with i ∈ {S, I, R}
corresponding to the susceptible, infected and recovered compartmental state or class. We
consider the spatial SIR model with nonlocal spreading modeled by an integration kernel
K representing the physical distancing and a spatial diffusion of population, and set it as
dynamic to our mean-field control problem, which is the constraint to the minimization
problem. The minimization objective include both the movement and the congestion of
the population. The kinetic energy terms describes the situation that, if population (the
susceptible, infected or recovered) needs to be moved to alleviate local medical shortage,
there is a cost behind it. The congestion term models the fact that government don’t
want the population gets too concentrated in one place. This might increase the risk of
disease outbreaks and their faster and wider spread. Due to the multiplicative nature
of the interaction term between susceptible and infectious agents βρS ρI , the mean-field
control problem is a non-convex problem. With Lagrange multipliers, we formalize the
mean-field control problem as an unconstrained optimization problem. Fast numerical
algorithms are designed to solve the non-convex optimization problem in 2D with G−prox
preconditioning [21].
In the literature, spatial SIR models in the form of a nonlinear integro-differential
[22, 23, 24] and reaction-diffusion system [3, 4] have been studied. Traveling waves are
studied to understand the propagation of various type of epidemics, such as Lyme disease,
measles etc, and recently, COVID-19 [25, 26, 27, 28]. In [28], they introduce a SIRT model
to study the effects of the presence of a road on the spatial propagation of the epidemic.
For surveys, see [29, 30]. As for numerical modelling of epidemic model concerning spatial
effect, finite-difference methods are used to discretize the reaction-diffusion system and
solve the spatial SIR model and its various extensions [31, 32, 33]. Epidemic models
have been treated using optimal control theory, with major control measures on medicare
(vaccination) [34, 35, 36]. In [36], a feedback control problem of SIR model is studied
to help determine the vaccine policy, with the goal to minimize the number of infected
people. In [37], they introduce a nonlinear SIQS epidemic model on complex networks
and study the optimal quarantine control. Compared to previous works, our model is the
first to consider an optimal control problem for SIR model on a spatial domain, combining
optimal transport and mean field controls. As SIR model can be interpreted in terms of
stochastic processes of agent-based models, it can be obtained as a motion of the law of a
three-state Markov chain with the transition from S to I and I to R.[38] Here we formulate

CONTROLLING PROPAGATION OF EPIDEMICS VIA MEAN-FIELD CONTROLS

3

velocity fields among S, I, R populations as control variables. And our model applies a
pair of PDEs, consisting Fokker-Planck equation and Hamilton-Jacobi equation. These
equations describe how different populations (susceptible, infected or recovered) react to
the propagation of pandemic on a spatial domain.
Our paper is organized as follows. In section 2, we introduce the mean field control
model for propagation of epidemics. We introduce a primal-dual hybrid gradient algorithm
for this model in section 3. In section 4, several numerical examples are demonstrated.
2. Model
In this section, we briefly review the classical epidemics models, e.g. SIR dynamics.
We then introduce a mean field control model for SIR dynamics on a spatial domain. We
derive a system to find the minimizer of the proposed model.
2.1. Review. We first review the classical SIR model.

dS(t)


= −βS(t)I(t)


 dt


dI(t)
= βS(t)I(t) − γI(t)

dt




dR(t)


= γI(t)
dt
where S, I, R : [0, T ] → [0, 1] represent the proportion of the susceptible population,
infected population, and recovered population, respectively, given time t ∈ [0, T ]. Susceptible people become infected with a rate β and infected people are recovered with a rate
γ. The SIR model can be derived based on the mean-field assumptions, thus it can be
interpreted as the mean field equations for a three-state Markov chain on S, I, R states.
2.2. Spatial SIR variational problem. We consider the spatial dimension of the S, I,
R functions. Let Ω ⊂ Rd be a bounded domain. Consider the following functions
ρS , ρI , ρR : [0, T ] × Ω → [0, ∞).
Here, ρS , ρI , and ρR represent susceptible, infected and recovered populations, respectively. We assume ρi for each i ∈ {S, I, R} moves on a spatial domain Ω with velocities
vi . We can describe these movements by continuity equations.

η2



∂t ρS + ∇ · (ρS vS ) + βρS ρI − S ∆ρS = 0


2




η2

∂t ρI + ∇ · (ρI vI ) − βρS ρI + γρI − I ∆ρI = 0
(1)
2

2


η


∂t ρR + ∇ · (ρR vR ) − γρI − R ∆ρR = 0


2


ρ (0, ·), ρ (0, ·), ρ (0, ·) are given.
S
I
R
where vi : [0, T ] × Ω → Rd (i ∈ {S, I, R}) are vector fields that represent the velocity
fields for ρi (i ∈ {S, I, R}) and nonnegative constants ηi (i ∈ {S, I, R}) are coefficients
for viscosity terms. We add these viscosity terms to regularize the systems of continuity

4

LEE, LIU, TEMBINE, LI, AND OSHER

equations, thus stabilize our numerical method that will be discussed in later sections. In
addition, we assume zero flux conditions by the Neumann boundary conditions, that is no
mass can flow in or out of Ω. These systems of continuity equations satisfy the following
equality:
Z
∂
ρS (t, x) + ρI (t, x) + ρR (t, x)dx = 0,
∂t Ω
i.e., the total mass of the three populations will be conserved for all time.
Lastly, we introduce the proposed mean field control models. Consider the following
variational problem:
Z TZ
X αi
c
inf
E(ρI (T, ·)) +
ρi |vi |2 + (ρS + ρI + ρR )2 dxdt
2
2
(ρi ,vi )i∈{S,I,R}
0
Ω
(2)
i∈{S,I,R}

subject to (1) with fixed initial densities.
Here E is a convex functional and αi (i ∈ {S, I, R}) and c are nonnegative constants.
The formulation is mainly divided into two parts: a terminal cost and a running cost.
The functional E is a terminal cost which increases if there is greater Rmass of infected
population at the terminal time. For example, we choose E(ρ(T, ·)) = 12 Ω ρ2 (T, x)dx for
the experiments (Section 4). The rest of the terms besides the functional E are running
costs. Kinetic energy terms α2i ρi |vi |2 (i ∈ {S, I, R}) represent the cost of moving the
density ρi with velocities vi over time 0 ≤ t ≤ T . A high value of αi means it is expensive
to move ρi for corresponding i ∈ {S, I, R}. In the numerical experiments (Section 4), we
assume αS = αR = 1 and αI = 10 to simulate the real life scenario where infected group
is harder to move than other groups. The last term in the running cost, 2c (ρS + ρI + ρR )2 ,
penalizes congestion of the total population. A high value of c means more penalization
on the congestion. The minimizers of the variational problem will provide the optimal
movements for each population while minimizing the terminal cost functional with respect
to the infected population ρI .
We note that the function (ρi , vi ) 7→ ρi |vi |2 is not convex. By introducing new variables
mi := ρi vi , we convert the cost function to be convex.
min

P (ρi , mi )i∈{S,I,R}

ρi ,vi

(3a)

subject to

ηS2



∂
ρ
+
∇
·
m
+
βρ
ρ
−
∆ρS = 0
t S
S
S I


2




η2

∂t ρI + ∇ · mI − βρS ρI + γρI − I ∆ρI = 0
2

2


η


∂t ρR + ∇ · mR − γρI − R ∆ρR = 0


2


ρ (0, ·), ρ (0, ·), ρ (0, ·) are given
S

I

(3b)

R

where
Z
P (ρi , mi )i∈{S,I,R} =E(ρI (T, ·)) +
0

T

Z

X

Ω i∈{S,I,R}

αi |mi |2
c
+ (ρS + ρI + ρR )2 dxdt.
2ρi
2

CONTROLLING PROPAGATION OF EPIDEMICS VIA MEAN-FIELD CONTROLS

5

From an optimization viewpoint, we note that the minimization problem is not a convex
problem since the coupling terms, βρS ρI , in constraints make the feasible set nonconvex.
We replace the nonconvex coupling term βρS ρI with convolution. Note that Kendall [2]
introduced this kernel for modeling pandemic dynamics and took the nonlocal exposure
to infectious agents into consideration. This term also helps regularize the minimization
problem.
min
P (ρi , mi )i∈{S,I,R}
(4a)
(ρi ,vi )i∈{S,I,R}

subject to
Z

ηS2


∆ρS (t, x) = 0
∂
ρ
(t,
x)
+
∇
·
m
(t,
x)
+
βρ
(t,
x)
K(x,
y)ρ
(t,
y)dy
−
t
S
S
S
I


2

Ω


Z


η2

∂t ρI (t, x) + ∇ · mI (t, x) − βρI (t, x) K(x, y)ρS (t, y)dy + γρI (t, x) − I ∆ρI (t, x) = 0
2
Ω


2

η



∂t ρR (t, x) + ∇ · mR (t, x) − γρI (t, x) − R ∆ρR (t, x) = 0


2


ρS (0, ·), ρI (0, ·), ρR (0, ·) given.
(4b)
Here, K(x, y) is a symmetric positive definite kernel. In this paper, we focus on a Gaussian
kernel


d
Y
1
|xk − yk |2
1
exp −
K(x, y) = p
.
σk
2σk2
(2π)d
k=1

The variance σk of Gaussian kernel can be viewed as a parameter for modeling the spatial
spreading effect
R of virus. Let’s consider the convolution term in the first continuity equation, ρS (t, x) Ω K(x, y)ρI (t, y)dy. Larger values of variance σk ’s in K mean a susceptible
agent located at position x can be affected by infectious agents farther away from x. Note
that by letting σk → 0, we get
Z
ρS (t, x) K(x, y)ρI (t, y)dy → ρS (t, x)ρI (t, x).
Ω

Thus, when σk becomes close to 0, the susceptible agent is only affected by infectious
agents nearby. If we let σk → ∞, then
Z
Z
ρS (t, x) K(x, y)ρI (t, y)dy → ρS (t, x) ρI (t, y)dy,
Ω

Ω

which means the susceptible group is affected by the total number of infected population.
Remark 1. The formulation is not limited to the SIR model we chose in this paper. It can
be used to solve any types of spatial epidemiological models. For example, if we use SEIR
model where E stands for exposed group, we just add one additional variable ρE and add
one more continuity equation.
2.3. Properties. We next derive the mean field control system, i.e. the minimizer system
associated with spatial SIR variational problem (4). We introduce three dual variables φi
(i ∈ {S, I, R}) to convert the minimization problem (4) into a saddle problem.

inf
P (ρi , mi )i∈{S,I,R} : subject to (4b)
(ρi ,vi )i∈{S,I,R}

6

LEE, LIU, TEMBINE, LI, AND OSHER

=

inf

sup

(ρi ,vi )i∈{S,I,R} (φi )i∈{S,I,R}

Z

T

−
0

Z

T

−
0

Z
−
0

T

P (ρi , mi )i∈{S,I,R}



η2
φS ∂t ρS + ∇ · mS + βρS K ∗ ρI − S ∆ρS dxdt
2
Ω


Z
η2
φI ∂t ρI + ∇ · mI − βρS K ∗ ρI + γρI − I ∆ρI dxdt
2
Ω


Z
2
η
φR ∂t ρR + ∇ · mR − γρI − R ∆ρR dxdt.
2
Ω

Z

Simplifying the above function, we define the Lagrangian functional

L((ρi , mi , φi )i∈{S,I,R} )
Z TZ
=P (ρi , mi )i∈{S,I,R} −
0

Z

T

X

Ω i∈{S,I,R}



ηi2
φi ∂t ρi + ∇ · mi − ∆ρi dxdt
2

(5)

Z
βρS (φI − φS )K ∗ ρI + γρI (φR − φI )dxdt.

+
0

Ω

Thus, we have the following saddle problem:

inf

sup

(ρi ,mi )i∈{S,I,R} (φi )i∈{S,I,R}

L((ρi , mi , φi )i∈{S,I,R} ).

(6)

The existence of the saddle point of this minimax problem is based on the assumption
that the dual gap is zero. In other words, given a primal solution with respect to optimal
primal variables (ρ∗i , m∗i )i∈{S,I,R} and a dual solution with respect to optimal dual variables
(φ∗i )i∈{S,I,R} , the difference between these two solutions is zero. However, the dual gap
may not be zero for this problem because the nonconvex functional (ρS , ρI ) 7→ ρS K ∗ ρI
makes feasible set of the problem nonconvex. Throughout the paper, we assume the dual
gap is zero to get properties of saddle points.
The following propositions are the properties of the saddle point problem derived from
optimality conditions (Karush–Kuhn–Tucker (KKT) conditions).

CONTROLLING PROPAGATION OF EPIDEMICS VIA MEAN-FIELD CONTROLS

7

Proposition 1 (Mean-field control SIR system). By KKT conditions, the saddle point
(ρ∗i , m∗i , φ∗i ) of (6) satisfies the following equations.

η2
αS


|∇φ∗S |2 + S ∆φ∗S + c(ρ∗S + ρ∗I + ρ∗R ) + β(φ∗I − φ∗S )K ∗ ρ∗I = 0
∂t φ∗S −



2
2



2

η
αI


∂t φ∗I −
|∇φ∗I |2 + I ∆φ∗I + c(ρ∗S + ρ∗I + ρ∗R )


2
2




+ βK ∗ (ρS (φI − φS )) + γ(φ∗R − φ∗I ) = 0






η2
α

∂t φ∗R − R |∇φ∗R |2 + R ∆φ∗R + c(ρ∗S + ρ∗I + ρ∗R ) = 0

2
2
ηS2
1

∗
∗
∗
∗
∗

∂
ρ
−
∇
·
(ρ
∇φ
)
+
βρ
K
∗
ρ
−
∆ρ∗S = 0

t
S
S
S
I

 S αS
2




η2
1
 ∗


∇ · (ρ∗I ∇φ∗I ) − βρ∗S K ∗ ρ∗I + γρ∗I − I ∆ρ∗I = 0
∂t ρI −


αI
2



2

η

1


∂t ρ∗R −
∇ · (ρ∗R ∇φ∗R ) − γρ∗I − R ∆ρ∗R = 0


αR
2


 ∗
φI (T, ·) = δE(ρ∗I (T, ·)).

(7)

Proof. By integration by parts, we reformulate the Lagrangian function (6) as follows.
L((ρi , mi , φi )i∈{S,I,R} )
Z TZ
c
=E(ρI (T, ·)) +
(ρS + ρI + ρR )2 + βρS (φI − φS )K ∗ ρI + γρI (φR − φI )dxdt
0
Ω 2
X Z T Z αi |mI |2
η2
+
+ ρi ∂t φi + mi · ∇φi + i ρi ∆φi dxdt
2ρi
2
Ω
i∈{S,I,R} 0
X Z
+
ρi (0, x)φi (0, x) − ρi (T, x)φi (T, x)dx
i∈{S,I,R} Ω

If (ρ∗i , m∗i , φ∗i ) are saddle points of the Lagrangian, the differential of Lagrangian with
respect to ρi , mi , φi (i ∈ {S, I, R}) and ρI (T, ·) equal to zero. We have
δL ∗ ∗ ∗
δL ∗ ∗ ∗
δL ∗ ∗ ∗
δL
(ρi , mi , φi ) =
(ρi , mi , φi ) =
(ρi , mi , φi ) =
(ρ∗ , m∗ , φ∗ ) = 0.
δρi
δmi
δφi
δρI (T, ·) i i i
δL
∗ ∗
∗
∗
∗
∗
∗ ∗
From δρIδL
(T,·) (ρi , mi , φi ) = 0 and δmi (ρi , mi , φi ) = 0, we have φI (T, ·) = δE(ρI (T, ·)) and
m∗i = − α1i ρ∗i ∇φ∗i (i ∈ {S, I, R}), respectively. Plugging in these equations into the rest of
the equations, we derive the result.


We note that dynamical system (7) models the optimal vector field strategies for S, I,
R populations. It combines both strategies from mean field controls and SIR models. For
this reason, we call (7) Mean-field control SIR system.

8

LEE, LIU, TEMBINE, LI, AND OSHER

3. Algorithm
In this section, we implement optimization methods to solve the proposed SIR variational problems. Specifically, we use G-Prox Primal Dual Hybrid Gradient (G-Prox
PDHG) method [21]. This is a variation of Chambolle-Pock primal-dual algorithm [39, 40].
G-Prox PDHG proposes a way of choosing proper norms for the optimization based on
the given minimization problem whereas Chambolle-Pock primal-dual algorithm just uses
L2 norms. Choosing appropriate norms results in faster and more robust convergence of
the algorithm.
3.1. Review of primal-dual algorithms. The PDHG method solves the minimization
problem
min f (Ax) + g(x)
x

by converting it into a saddle point problem
min sup {L(x, y) := hAx, yi + g(x) − f ∗ (y)} .
x

y

Here, f and g are convex functions with respect to a variable x, A is a continuous linear
operator, and
f ∗ (y) = sup x · y − f (x)
x

is a Legendre transform of f . For each iteration, the algorithm finds the minimizer x∗
by gradient descent method and the maximizer y∗ by gradient ascent method. Thus, the
minimizer and maximizer are calculated by iterating

1
k 2
k+1
k

x 1 = arg minx L(x, y ) + 2τ kx − x k
1
y k+ 2 = arg maxy L(xk+1 , y) + 2σ
ky − y k k2

1
 k+1
y
= 2y k+ 2 − y k
where τ and σ are step sizes for the algorithm.
G-Prox PDHG is a modified version of PDHG that solves the minimization problem
by choosing the most appropriate norms for updating x and y. Choosing the appropriate
norms allows us to choose larger step sizes. Hence, we get a faster convergence rate. In
details,

1
k+1
k
k 2

x 1 = arg minx L(x, y ) + 2τ kx − x kH
1
y k+ 2 = arg maxy L(xk+1 , y) + 2σ
ky − y k k2G

1
 k+1
y
= 2y k+ 2 − y k
where H and G are some Hilbert spaces with the inner product
(u1 , u2 )G = (Au1 , Au2 )H .
In particular, we use G-Prox PDHG to solve the minimization problem (4) by setting
H = L2 and G = H 2 . Furthermore,
(
0
if Ax = (0, 0, γρI )
x = (ρS , ρI , ρR , mS , mI , mR ), g(x) = P (ρi , mi )i∈{S,I,R} , f (Ax) =
∞ otherwise.

CONTROLLING PROPAGATION OF EPIDEMICS VIA MEAN-FIELD CONTROLS

9

η2
∆ρS + βρS K ∗ ρI ,
2
η2
∂t ρI + ∇ · mI − ∆ρI − βρI K ∗ ρS + γρI ,
2
η2
∂t ρR + ∇ · mR − ∆ρR ).
2

Ax = (∂t ρS + ∇ · mS −

Thus, we have the following inner products
T

Z

Z

Z
u1 (t, x)u2 (t, x)dxdt,

(u1 , u2 )L2 =
0

T

Z
Au1 (t, x)Au2 (t, x)dxdt.

(u1 , u2 )H 2 =
0

Ω

Ω

Note that the operator A is not linear. In the implementation, we approximate the operator with the following linear operator
η2
∆ρS + βρS ,
2
η2
∂t ρI + ∇ · mI − ∆ρI + (γ + β)ρI ,
2
η2
∂t ρR + ∇ · mR − ∆ρR ).
2

Ax ≈ (∂t ρS + ∇ · mS −

3.2. G-Prox PDHG on SIR variational problem. In this section, we implement GProx PDHG to solve the saddle problem (6). For i ∈ {S, I, R},
(k+1)

ρi

(k+1)

mi

(k+ 21 )

φi

(k+1)

φi

1
(k)
kρ − ρi k2L2
ρ
2τi
1
(k)
(k+1)
(k)
km − mi k2L2
= arg min L(ρi
, m, φi ) +
m
2τi
1
(k+1)
(k+1)
(k)
= arg max L(ρi
, mi
, φ) −
kφ − φi k2H 2
φ
2σi
(k)

(k)

= arg min L(ρ, mi , φi ) +

(k+ 21 )

= 2φi

(k)

− φi

where τi , σi (i ∈ {S, I, R}) are step sizes for the algorithm and by G-Prox PDHG, L2
norm and H 2 norm are defined as
kuk2L2

Z

T

Z

=

2

u dxdt,
0

Ω

kuk2H 2

Z

T

Z

=
0

Ω

(∂t u)2 + |∇u|2 +

η4
(∆u)2 dxdt
4

for any u : [0, T ] × Ω → [0, ∞).
By formulating these optimality conditions, we can find explicit formulas for each variable.

10

LEE, LIU, TEMBINE, LI, AND OSHER

(k+1)
ρS

(k+1)

ρI

(k+1)

ρR




η2
τS
1 (k)
(k)
(k) (k)
(k)
(k)
(k)
= root+
∂t φS + S ∆φS − ρS + β K ∗ (φI ρI ) − φS K ∗ ρI
1 + cτS
2
τS
!

(k)
τS αS (mS )2
+ c(ρI + ρR ) , 0, −
2(1 + cτS )



ηI2
τI
1 (k)
(k)
(k)
(k)
(k) (k)
(k)
= root+
∂t φI + ∆φI − ρI + β φI K ∗ ρS − K ∗ (φS ρS )
1 + cτI
2
τI
!

(k)
τI αI (mI )2
+ γ(φR − φI ) + c(ρS + ρR ) , 0, −
2(1 + cτI )
!


(k) 2
2
τ
α
(m
)
η
τR
1
R R
(k)
(k)
(k)
R
= root+
ρ + c(ρS + ρI ) , 0, −
∂t φR + R ∆φR −
1 + cτR
2
τR R
2(1 + cτR )
(k+1)

(k+1)

mi

(k+1)
φS

(k+ 12 )

φI

(k+ 1 )
φR 2

=

(k)
φS

+

ρi

=

(k+1)

τ αi + ρi

σS (ATS AS )−1



(k)

mi

(k)

− τ ∇φi



,

(i ∈ {S, I, R})



ηS2
(k+1)
(k+1)
(k+1)
(k+1)
(k+1)
−∂t ρS
− ∇ · mS
− βρS
K ∗ ρI
+ ∆ρS
2


(k)
(k+1)
(k+1)
(k+1)
(k+1)
= φI + σI (ATI AI )−1 −∂t ρI
− ∇ · mI
+ βρI
K ∗ ρS

ηI2
(k+1)
(k+1)
− γρI
+ ∆ρI
2

=

(k)
φR

+

σR (ATR AR )−1



2
ηR
(k+1)
(k+1)
(k+1)
(k+1)
−∂t ρR
− ∇ · mR
+ γρI
+
∆ρR
2

where root+ (a, b, c) is a positive root of a cubic polynomial x3 + ax2 + bx + c = 0 and
ηS4 2
∆ − (1 + 2βηS )∆ + β 2
4
η4
ATI AI = −∂tt + I ∆2 − (1 + 2(γ + β)ηS )∆ + (γ + β)2
4
η4
ATR AR = −∂tt + R ∆2 − ∆.
4
ATS AS = −∂tt +

We use FFTW library to compute (ATi Ai )−1 (i ∈ {S, I, R}) and convolution terms by
Fast Fourier Transform (FFT), which is O(n log n) operations per iteration where n is the
number of points. Thus, the algorithm takes just O(n log n) operations per iteration.
In all, we summarize the algorithm as follows.

CONTROLLING PROPAGATION OF EPIDEMICS VIA MEAN-FIELD CONTROLS

11

Algorithm: G proximal PDHG for mean-field control SIR system
Input: ρi (0, ·) (i ∈ {S, I, R})
Output: ρi , mi , φi (i ∈ {S, I, R}) for x ∈ Ω, t ∈ [0, T ]
While relative error > tolerance
(k+1)
(k) (k)
ρi
= arg minρ L(ρ, mi , φi ) +

(k) 2
1
2τi kρ − ρi kL2
(k)
(k+1)
(k)
mi
= arg minm L(ρ(k+1) , m, φi ) + 2τ1i km − mi k2L2
1
(k+ )
(k+1)
(k)
, φ) − 2σ1 i kφ − φi k2H 2
φi 2 = arg maxφ L(ρ(k+1) , mi
1
(k+ )
(k+1)
(k)
φi
= 2φi 2 − φi

end
Here, the relative error is defined as
(k+1)

relative error =

|P (ρi

(k+1)

, mi

(k)

(k)

) − P (ρi , mi )|

(k)

(k)

.

|P (ρi , mi )|
4. Experiments
In this section, we present several sets of numerical experiments using the algorithm
with various parameters. We wrote C++ codes to run the numerical experiments. Let
Ω = [0, 1]2 be a unit cube in R2 and T = 1. The domain Ω is discretized with the regular
rectangular mesh
1
1
1
∆x =
, ∆y =
, ∆t =
Nx
Ny
Nt − 1
xkl = ((k + 0.5)∆x, (l + 0.5)∆y) , k = 0, · · · , Nx − 1, l = 0, · · · , Ny − 1
tn = n∆t,
n = 0, · · · , Nt − 1
where Nx , Ny are the number of data points in space and Nt is the number of data points
in time. For all the experiments, we use the same set of parameters,
Nx = 128,

Ny = 128,

Nt = 32

c = 0.01, ηi = 0.01 (i ∈ {S, I, R})
αS = 1, αI = 10, αR = 1
and choose the same terminal cost functional
Z
1
E(ρI (1, ·)) =
ρ2 (1, x)dx.
2 Ω I
By setting higher value for αI , we penalize the movement of infected population more than
other populations. Considering the immobility of infected individuals, this is a reasonable
choice in terms of real-world applications.
σ = 0.02,

To minimize the terminal cost functional E(ρI (T, ·)), a solution needs to reduce the
number of infected population. There are mainly two ways of reducing the number of
infected. One way is to recover infected to recovered population. However, it may not be
feasible if a rate of recovery γ is small. Another way to reduce the number of infected is

12

LEE, LIU, TEMBINE, LI, AND OSHER

by separating susceptible population from infected population. The number of infected
doesn’t increase if there are no susceptible people near infected. However, the total cost
increases when densities move due to the kinetic energy term ρi |vi |2 (i ∈ {S, I, R}) in
the running cost. A solution needs to find the optimal balance between the terminal cost
and the running cost. Experiment 1 shows the effectiveness of controlling populations’
movements. We compute two solutions of the model: with and without control of movements. The comparison between these solutions shows that the number of infected people
at the terminal time can be reduced effectively with control. Experiment 2 shows that the
algorithm finds the proper solutions based on different recovery rates given nonsymmetric initial densities. In Experiment 3, we consider a more complicating terminal energy
functional E(ρI (T, ·)), and compute the solutions based on different infection rates.
4.1. Experiment 1. In this experiment, we compare the solutions of SIR model with and
without control. We set initial densities for susceptible, infected and recovered populations
as


ρS (0, x = (x1 , x2 )) = 0.6 exp −10 (x1 − 0.5)2 + (x2 − 0.5)2


ρI (0, x = (x1 , x2 )) = 0.6 exp −35 (x1 − 0.6)2 + (x2 − 0.6)2
ρR (0, x = (x1 , x2 )) = 0
Susceptible population and infected population are Gaussian distributions centered at
(0.5, 0.5) and (0.6, 0.6), respectively. We set β = 0.7 and γ = 0.1.
We show two different numerical results: one with control and one without control. The
formulation without control has the following system of equations,
∂ρS (t, x)
= −βρS (t, x)ρI (t, x)
dt
∂ρI (t, x)
= βρS (t, x)ρI (t, x) − γρI (t, x)
dt
∂ρR (t, x)
= γρI (t, x).
dt
By removing the velocity terms, we assume no movements of population. We solve these
equations by using Euler’s method. Thus, the solution can be computed by iterating
n = 0, · · · , Nt − 2,
ρS (tn+1 , xkl ) = ρS (tn , xkl ) − ∆tβρS (tn , xkl )ρI (tn , xkl )
ρI (tn+1 , xkl ) = ρI (tn , xkl ) + ∆t (βρS (tn , xkl )ρI (tn , xkl ) − γρI (tn , xkl ))
ρR (tn+1 , xkl ) = ρR (tn , xkl ) + ∆tγρI (tn , xkl ),
for k = 0, · · · , Nx − 1, l = 0, · · · , Ny − 1. The results can be seen in Figure 1 and Figure 2.
Figure 1 shows snapshots of the initial and terminal densities. The first row shows the
initial densities of susceptible, infected and recovered (from left to right) based on the
equations above. The second row and the third row show the terminal densities without
control and with control, respectively. Figure 2 shows a quantitative comparison between
these two solutions. The
R graphs indicate the total sum of each group over time. More
specifically, they show Ω ρi (t, x)dx for i ∈ {S, I, R} from t = 0 to t = 1.

CONTROLLING PROPAGATION OF EPIDEMICS VIA MEAN-FIELD CONTROLS

13

In Figure 1, when we compare the susceptible groups from second and third rows, the
susceptible group with control moves more than the susceptible group without control. If
there is no control (the second row in Figure 1), the groups don’t move and the susceptible
group is exposed to infected group which leads to a high chance of susceptible being
infected over time. If population is in control (the third row in Figure 1), we see a
clear separation between susceptible and infected at the terminal time. This separation
decreases the exposure of susceptible to infected effectively and, as a result, we see less
number of infected and more number of susceptible at the terminal time from the solution
with control.

Figure 1. Snapshots of susceptible (column 1), infected (column 2) and
recovered populations (column 3). The first row shows the initial densities,
the second row shows the solution without control at the terminal time and
the third row shows the solution with control at the terminal time.

14

LEE, LIU, TEMBINE, LI, AND OSHER

(a) ρS

(b) ρI

(c) ρR

Figure 2. The comparison between solutions with and
R without control.
The graphs show the total population of each group Ω ρi (t, x)dx for 0 ≤
t ≤ 1 and i ∈ {S, I, R}.
4.2. Experiment 2. In this experiment, we consider nonsymmetric initial densities.


ρS (0, x) = 0.45 exp −15((x − 0.3)2 + (y − 0.3)2 )

+ exp −25((x − 0.5)2 + (y − 0.75)2 )

+ exp −30((x − 0.8)2 + (y − 0.35)2 )

ρI (0, x) = 10 0.04 − (x − 0.2)2 − (y − 0.65)2 +

+ 12 0.03 − (x − 0.5)2 − (y − 0.2)2 +

+ 12 0.03 − (x − 0.8)2 − (y − 0.55)2 +
ρR (0, x) = 0.
Susceptible population is the sum of three Gaussian distributions and infected population
is the sum of positive part of quadratic polynomials. We conduct this experiment to show
that the algorithm works well for nonsymmetric initial densities. Moreover, we choose
β = 0.34 (an infection rate) and γ = 0.12 (a recovery rate) from [41] based on the data in
California, U.S. from March to May 2020. Figure 3 shows the evolution of densities using
these parameters. We repeat the experiment with same initial densities and β but with
different γ (Figure 4). In this experiment, we show the solution of the problem based on a
large γ = 0.36. This experiment is under the scenario when vaccine comes to the public. In
both figures, evolutions of densities ρi (i ∈ {S, I, R}) are shown at t = 0, 0.21, 0.47, 0.74, 1.
The total population
R of each density is indicated as sum in the subtitle of each plot, and
it is calculated as Ω ρi (t, x)dx for 0 ≤ t ≤ T and i ∈ {S, I, R}.
When γ = 0.12 (a low recovery rate), the solution separates susceptible population away
from infected population. By separating susceptible from infected, the solution prevents
susceptible population becoming infected, thus reduces the terminal cost at t = 1. When
γ = 0.36 (a high recovery rate), recovering the infected is considered to be a better
choice than separating susceptible population from infected population. In Figure 4, the
susceptible population barely moves over time. We also observe that less number of

CONTROLLING PROPAGATION OF EPIDEMICS VIA MEAN-FIELD CONTROLS

15

infected and more number of recovered. The total population of infected at the terminal
time in Figure 4 is 0.045 which is smaller than the total population of infected in Figure 3.
This experiment tells us that, with a high recovery rate, the optimal way of minimizing
the number of infected is by focusing on recovering them rather than moving susceptible
population.

Figure 3. Experiment 2. The evolution of populations from t = 0 to
t = 1 with β = 0.34 and γ = 0.12. The first row represents susceptible, the
second row represents infected, and the last row represents recovered.
4.3. Experiment 3. In this experiment, we consider the initial densities
(
(
0.4 if x ∈ B0.3 (0.5, 0.5)
0.4 if x ∈ B0.2 (0.5, 0.5)
ρS (0, x) =
, ρI (0, x) =
,
0
else
0
else

ρR (0, ·) = 0

where BR (x1 , x2 ) is a ball of radius R centered at (x1 , x2 ) with value. Furthermore, we
consider the following energy functional:
Z
1 2
E(ρI (T, ·)) =
ρI (T, x) + ρI (T, x)V (x)dx
Ω 2
where, for x = (x1 , x2 ),
(
1 if |x1 − 0.5| < 0.1 and |x2 − 0.5| < 0.1
V (x) =
0 otherwise.

16

LEE, LIU, TEMBINE, LI, AND OSHER

Figure 4. Experiment 2. The evolution of populations from t = 0 to
t = 1 with β = 0.34 and γ = 0.36. The first row represents susceptible, the
second row represents infected, and the last row represents recovered.

Here V (x) is a step function that equals 1 on a square with a side length 0.2 at the center
of the domain and 0 elsewhere. This energy penalizes if there is positive infected density
on the square. Thus, the solution has to move the infected density away from the square
region while minimizing the total infected population. In this set of experiments, we show
how the solution changes based on an infection rate β. We consider the case with a high
infection rate β = 0.96, γ = 0.12 (Figure 5) and with β = 0.34, γ = 0.12 (Figure 6) same
as Experiment 2.
When β = 0.96 (a high infection rate), the solution minimizes the total infected population by separating the susceptible from infected. Due to the usage of this energy
functional, the infected population has to move away from the square region at the center.
Since there is going to be no infected population in this square region at the terminal time,
the optimal place for susceptible population is inside this square region. As a result, we
can see the concentrated susceptible population inside this square at the terminal time.
When β = 0.32 (a low infection rate), the susceptible population does not move as much
as in the case when β is large. There are more overlaps between susceptible and infected
groups at the terminal time when β is small. However, when β is large, there is a complete
separation between these groups. Thus, based on β and γ values, the solution of our model

CONTROLLING PROPAGATION OF EPIDEMICS VIA MEAN-FIELD CONTROLS

17

can find the most cost-effective way of moving susceptible and infected populations while
minimizing the total infected population.

Figure 5. Experiment 3. The evolution of populations from t = 0 to
t = 1 with β = 0.96 and γ = 0.12. The first row represents susceptible, the
second row represents infected, and the last row represents recovered.

5. Discussion
In this paper, we introduce a mean-field control model for controlling the virus spreading
of a population in a spatial domain, which extends and controls the current SIR model
with spatial effect. Here the state variable represents the population status, such as S,
I, R, etc with a spatial domain, while the control variable is the velocity of motion of
the population. The terminal cost forms the goal of government, which balances the
total infection number and maintain suitable physical movement of essential tasks and
goods. Numerical algorithms are derived to solve the proposed model. Several experiments
demonstrate that our model can effectively demonstrate how to separate the infected and
susceptible population in a spatial domain.
Our model opens the door to many questions in modeling, inverse problems and computations, especially during this COVID-19 pandemic. On the modeling side, first, we are
interested in generalize the geometry of the spatial domain. Second, our current model
only focuses on the control of population movement. The control of the diffusion operator

18

LEE, LIU, TEMBINE, LI, AND OSHER

Figure 6. Experiment 3. The evolution of populations from t = 0 to
t = 1 with β = 0.34 and γ = 0.12. The first row represents susceptible, the
second row represents infected, and the last row represents recovered.
among populations is also of great interests in future work. Third, the government can
also put restrictions on the interaction for different class of populations, depending on
their infection status. Fourth, in real life, the spatial domain is often inhomogeneous, containing airports, schools, subways etc. We also need to formulate our mean-field control
model on a discrete spatial graph (network). In addition, our model focus on the forward
problem of modeling the dynamics of the virus. In practice, real time data is generated as
the virus spreading across different regions. To effectively model this dynamic, a suitable
inverse mean-field control problem needs to be constructed. On the computational side,
our model involves a non-convex optimization problem, which comes from the multiplicative term of the SIR model itself. In future work, we expect to design a fast and reliable
algorithm for these advanced models. We also expect to develop and apply AI numerical
algorithms to compute models in high dimensions.
References
[1] William Ogilvy Kermack and Anderson G McKendrick. A contribution to the mathematical theory of
epidemics. Proceedings of the royal society of london. Series A, Containing papers of a mathematical
and physical character, 115(772):700–721, 1927.
[2] David G Kendall. Mathematical models of the spread of infection. Mathematics and computer science
in biology and medicine, pages 213–225, 1965.

CONTROLLING PROPAGATION OF EPIDEMICS VIA MEAN-FIELD CONTROLS

19

[3] Anders Källén. Thresholds and travelling waves in an epidemic model for rabies. Nonlinear Analysis:
Theory, Methods & Applications, 8(8):851–856, 1984.
[4] Yuzo Hosono and Bilal Ilyas. Traveling waves for a simple diffusive epidemic model. Mathematical
Models and Methods in Applied Sciences, 5(07):935–966, 1995.
[5] Boyan Jovanovic and Robert W. Rosenthal. Anonymous sequential games. Journal of Mathematical
Economics, 17(1):77 – 87, 1988.
[6] M. Huang, R. P. Malhamé, and P. E. Caines. Large population stochastic dynamic games: closed-loop
McKean-Vlasov systems and the Nash certainty equivalence principle. Commun. Inf. Syst., 6(3):221–
251, 2006.
[7] Jean-Michel Lasry and Pierre-Louis Lions. Jeux à champ moyen. I. Le cas stationnaire. C. R. Math.
Acad. Sci. Paris, 343(9):619–625, 2006.
[8] Jean-Michel Lasry and Pierre-Louis Lions. Jeux à champ moyen. II. Horizon fini et contrôle optimal.
C. R. Math. Acad. Sci. Paris, 343(10):679–684, 2006.
[9] Jean-Michel Lasry and Pierre-Louis Lions. Mean field games. Japanese journal of mathematics,
2(1):229–260, 2007.
[10] Diogo A Gomes et al. Mean field games models—a brief survey. Dynamic Games and Applications,
4(2):110–154, 2014.
[11] Diogo A Gomes, Levon Nurbekyan, and Edgard A Pimentel. Economic models and mean-field games
theory. IMPA Mathematical Publications. Instituto Nacional de Matemática Pura e Aplicada (IMPA),
Rio de Janeiro, 2015.
[12] Martin Burger, Marco Di Francesco, Peter Markowich, and Marie-Therese Wolfram. Mean field games
with nonlinear mobilities in pedestrian dynamics. arXiv preprint arXiv:1304.5201, 2013.
[13] Aimé Lachapelle, Jean-Michel Lasry, Charles-Albert Lehalle, and Pierre-Louis Lions. Efficiency of
the price formation process in presence of high frequency participants: a mean field game analysis.
Mathematics and Financial Economics, 10(3):223–262, 2016.
[14] Yves Achdou and Jean-Michel Lasry. Mean field games for modeling crowd motion. In Contributions
to partial differential equations and applications, volume 47 of Comput. Methods Appl. Sci., pages
17–42. Springer, Cham, 2019.
[15] J.-D. Benamou and G. Carlier. Augmented Lagrangian methods for transport optimization, mean
field games and degenerate elliptic equations. J. Optim. Theory Appl., 167(1):1–26, 2015.
[16] L. M. Briceño Arias, D. Kalise, and F. J. Silva. Proximal methods for stationary mean field games
with local couplings. SIAM J. Control Optim., 56(2):801–836, 2018.
[17] Weinan E, Jiequn Han, and Qianxiao Li. A Mean-Field Optimal Control Formulation of Deep Learning. arXiv:1807.01083 [cs, math], 2018.
[18] Alex Tong Lin, Samy Wu Fung, Wuchen Li, Levon Nurbekyan, and Stanley J. Osher. Apac-net: Alternating the population and agent control via two neural networks to solve high-dimensional stochastic
mean field games, 2020.
[19] Lars Ruthotto, Stanley Osher, Wuchen Li, Levon Nurbekyan, and Samy Wu Fung. A machine learning
framework for solving high-dimensional mean field game and mean field control problems, 2019.
[20] Siting Liu, Matthew Jacobs, Wuchen Li, Levon Nurbekyan, and Stanley J Osher. Computational
methods for nonlocal mean field games with applications. arXiv preprint arXiv:2004.12210, 2020.
[21] Matt Jacobs, Flavien Léger, Wuchen Li, and Stanley Osher. Solving Large-Scale Optimization Problems with a Convergence Rate Independent of Grid Size. arXiv:1805.09453 [math], 2018.
[22] DG Aronson. The asymptotic speed of propagation of a simple epidemic. In Nonlinear diffusion,
volume 14, pages 1–23. Pitman London, 1977.
[23] Odo Diekmann. Run for your life. a note on the asymptotic speed of propagation of an epidemic.
Journal of Differential Equations, 33(1):58–73, 1979.
[24] HR Thieme. A model for the spatial spread of an epidemic. Journal of Mathematical Biology, 4(4):337–
351, 1977.
[25] Thomas Caraco, Stephan Glavanakov, Gang Chen, Joseph E Flaherty, Toshiro K Ohsumi, and
Boleslaw K Szymanski. Stage-structured infection transmission and a spatial epidemic: a model for
lyme disease. The American Naturalist, 160(3):348–359, 2002.
[26] Bryan T Grenfell, Ottar N Bjórnstad, and Jens Kappey. Travelling waves and spatial hierarchies in
measles epidemics. Nature, 414(6865):716–723, 2001.

20

LEE, LIU, TEMBINE, LI, AND OSHER

[27] Zhi-Cheng Wang and Jianhong Wu. Travelling waves of a diffusive kermack–mckendrick epidemic
model with non-local delayed transmission. Proceedings of the Royal Society A: Mathematical, Physical
and Engineering Sciences, 466(2113):237–261, 2010.
[28] Henri Berestycki, Jean-Michel Roquejoffre, and Luca Rossi. Propagation of epidemics along lines with
fast diffusion. arXiv preprint arXiv:2005.01859, 2020.
[29] JD Murray. Mathematical biology II: spatial models and biomedical applications. Springer New York,
2001.
[30] Shigui Ruan. Spatial-temporal dynamics in nonlocal epidemiological models. In Mathematics for life
science and medicine, pages 97–122. Springer, 2007.
[31] Settapat Chinviriyasit and Wirawan Chinviriyasit. Numerical modelling of an sir epidemic model with
diffusion. Applied Mathematics and Computation, 216(2):395–409, 2010.
[32] Atit Jaichuang and Wirawan Chinviriyasit. Numerical modelling of influenza model with diffusion.
International Journal of Applied Physics and Mathematics, 4(1):15, 2014.
[33] István Faragó and Róbert Horváth. Qualitatively adequate numerical modelling of spatial sirs-type
disease propagation. Electronic Journal of Qualitative Theory of Differential Equations, 2016(12):1–14,
2016.
[34] Suresh P Sethi and Preston W Staats. Optimal control of some simple deterministic epidemic models.
Journal of the Operational Research Society, 29(2):129–136, 1978.
[35] A Lahrouz, H El Mahjour, A Settati, and A Bernoussi. Dynamics and optimal control of a nonlinear epidemic model with relapse and cure. Physica A: Statistical Mechanics and its Applications,
496:299–317, 2018.
[36] Junyoung Jang, Hee-Dae Kwon, and Jeehyun Lee. Optimal control problem of an sir reaction–diffusion
model with inequality constraints. Mathematics and Computers in Simulation, 171:136–151, 2020.
[37] Kezan Li, Guanghu Zhu, Zhongjun Ma, and Lijuan Chen. Dynamic stability of an siqs epidemic
network and its optimal control. Communications in Nonlinear Science and Numerical Simulation,
66:84–95, 2019.
[38] Linda JS Allen. A primer on stochastic epidemic models: Formulation, numerical simulation, and
analysis. Infectious Disease Modelling, 2(2):128–142, 2017.
[39] Antonin Chambolle and Thomas Pock. A first-order primal-dual algorithm for convex problems with
applications to imaging. J. Math. Imaging Vision, 40(1):120–145, 2011.
[40] Antonin Chambolle and Thomas Pock. On the ergodic convergence rates of a first-order primal-dual
algorithm. Math. Program., 159(1-2, Ser. A):253–287, 2016.
[41] Andrea L Bertozzi, Elisa Franco, George Mohler, Martin B Short, and Daniel Sledge. The challenges
of modeling and forecasting the spread of covid-19. arXiv preprint arXiv:2004.04741, 2020.

