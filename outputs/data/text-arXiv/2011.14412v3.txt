CLUSTERING US STATES BY TIME SERIES OF COVID-19 NEW
CASE COUNTS WITH NON-NEGATIVE MATRIX FACTORIZATION

JIANMIN CHEN

arXiv:2011.14412v3 [stat.AP] 15 Jan 2021

JUN YAN
Department of Statistics, University of Connecticut, Storrs, CT 06269

PANPAN ZHANG
Department of Biostatistics, Epidemiology and Informatincs, University of
Pennsylvania, Philadelphia, PA 19104

Abstract. The spreading pattern of COVID-19 differ a lot across the US states under
different quarantine measures and reopening policies. We proposed to cluster the US
states into distinct communities based on the daily new confirmed case counts via a
nonnegative matrix factorization (NMF) followed by a k-means clustering procedure on
the coefficients of the NMF basis. A cross-validation method was employed to select
the rank of the NMF. Applying the method to the entire study period from March
22 to July 25, we clustered the 49 continental states (including District of Columbia)
into 7 groups, two of which contained a single state. To investigate the dynamics of
the clustering results over time, the same method was successively applied to the time
periods with increment of one week, starting from the period of March 22 to March
28. The results suggested a change point in the clustering in the week starting on May
30, which might be explained by a combined impact of both quarantine measures and
reopening policies.

AMS subject classifications.
Primary: 62H30; 62H12
Secondary: 62M10
Key words. change point; COVID-19; k-means clustering; non-negative matrix factorization
E-mail addresses: panpan.zhang@pennmedicine.upenn.edu.
Date: January 18, 2021.
1

2

CLUSTERING US STATES BY COVID-19 COUNTS WITH NMF

1. Introduction
The COVID-19 pandemic has brought a great deal of challenges not only to the global
public health system but also to the global economy. By July 25, 2020, there had been
a total of 15,590,252 confirmed cases across the world, while the number of death cases
had reached 630,294. The United States (US), one of the countries that have been
most severely attacked by COVID-19, reported 4,009,808 confirmed cases and 143,663
death cases, respectively, by then (https://covid19.who.int). In the meantime, the
economic crisis caused by the pandemic was unprecedented in its scale. The Missouri
Economic Research and Information Center reported that the total value of exports of all
50 continental US states had fallen by 29.8%, from $414.95 billion in the second quarter
of 2019 to $291.47 billion in the second quarter of 2020 (https://meric.mo.gov/data/
us-state-exports). The unemployment rate from the US Department of Labor reached
14.7% in April, 2020, doubling that reported at the end of 2008 (7.2%) when the subprime
mortgage crisis broke out. Although the unemployment rate declined to 10.2% in July,
2020, thanks to the stimulating measures by the government, it remained at a high level.
Updated statistics on the pandemic and government policies are of genuine and critical public concern. From the beginning, the Centers for Disease Control and Prevention (CDC) has been continuously updating the progress of COVID-19 and the status of public health safety in the US in their Morbidity and Mortality Weekly Report
(https://www.cdc.gov/mmwr/index.html). A large body of literature has reported clinical characteristics of the disease [e.g., 8, 21, 10]. For the general public, however, the
case and death counts at the nation and state levels are of direct concerns. Although
there were high volumes of confirmed and death cases reported in the US in March and
April, the spread of the disease effectively slowed down in late April and early May owing
to the practice of social distancing, “mask wearing” recommendations, “stay-at-home”
and anti-gathering orders, and many other quarantine measures [e.g., 24]. However, the
number of new confirmed cases in some of the US states has surged since early June,
two weeks after the resumption of business in a majority of the states. In terms of the
dynamic pattern of the case counts, some states are more similar than others possibly
due to difference in quarantine and reopening policies.
We clustered the US states by the patterns in their COVID-19 case count series, which
was treated as a times series clustering problem. Such clustering analysis has not yet
been reported in the literature of the study for COVID-19. Feature-based algorithms are
widely used for time series clustering, where features are first generated from the raw data
and then appropriate clustering algorithms are applied to form clusters [19]. Many studies on the combination of feature generating procedure and clustering algorithms have
been done. For example, an anytime algorithm based on the Haar wavelet decomposition
followed by a modified k-means clustering was proposed by Lin et al. [20]; an agglomeration algorithm incorporated with principals component analysis was introduced by
Shaw and King [22]. An appealing alternative to solving time series clustering problems

CLUSTERING US STATES BY COVID-19 COUNTS WITH NMF

3

is to exploit functional data analysis (FDA) techniques, such as the k-centers functional
clustering algorithm [4] and an EM-based algorithm for Gaussian mixture models [3], the
latter of which has been in a COVID-19 application [23]. See Jacques and Preda [14] for
a concise survey for functional data clustering methods.
Our time series clustering was based on a non-negative matrix factorization (NMF)
followed by a k-means clustering procedure. The series of each state was properly approximated by a linear combination of a small number of bases. The coefficients of the
bases were used as features in a k-means clustering analysis. This NMF-based method is
attractive for its robustness, stability, and scalability [2, 5]. In particular, we considered
an extended NMF method allowing for missing values in the dataset. The number of
bases was determined through a cross-validation method where, facilitated by a stratification on the level of the data, a randomly selected fold of data was treated as missing
and predicted by the rest. Our clustering results provide a platform to further study
the similarities of the states that are in the same cluster and the dissimilarities of those
that are not. Further, we investigated the changes in the clustering results as additional
data became available with an increment of one week successively. The temporal changes
between the consecutive analyses were explored via similarity measures to identify possible change point(s) in the clustering of the states. Our analysis result suggests that the
policies varying among the states may have impacted the spreading or confinement of the
pandemic.
The rest of the manuscript is organized as follows. In Section 2, we introduce the
data source, basic descriptive statistics, and data preprocessing procedures. In Section 3,
we elaborate the fundamental concept of NMF, and propose an NMF-based algorithm
followed by k-means clustering. The proposed algorithm is applied to the preprocessed
data and the clustering results for different study periods are presented in Section 4. The
temporal dynamic of cluster structures is investigated in Section 4 as well. Lastly, we
address some concluding remarks and carry out some discussions in Section 5.

2. Data
Daily new confirmed cases from each US state were retrieved from a public repository
maintained by the Center for Systems Science and Engineering at the Johns Hopkins
University [7]. The start date of our study period was set to be Sunday (March 22, 2020).
President Trump declared a national emergency concerning the COVID-19 outbreak on
March 13, 2020, after which the number of tests increased substantially. On average,
it took about a week to get the results of nasal and swab tests. Hence, few confirmed
cases were reported in, for example, the District of Columbia and West Virginia, before
March 22. The end date of our study period was Saturday, July 25, 2020, when the
spread of the pandemic appeared to be slowing down in those states affected largely by
the second wave. The entire study period has 126 days.

4

CLUSTERING US STATES BY COVID-19 COUNTS WITH NMF

New York

North Carolina

600
200
400

150

100
200
50

0

0
Apr

May

Jun

Jul

Apr

Louisiana

May

Jun

Jul

Massachusetts
400

600

300
400
200
200
100
0

0
Apr

May

Jun

Jul

Apr

May

Jun

Jul

Figure 1. Daily confirmed cases in New York, North Carolina, Louisiana
and Massachusetts over the study period, where the periodicity is reflected
in vertical red dashed lines (7 days per gap).

We considered 49 continental state-level entities (including the District of Columbia),
hereafter referred to as 49 states for simplicity. Alaska and Hawaii were not included
because the population movements between the two states and the continent were rather
limited. Since the 49 states vary a lot in population size, the raw counts of cases are
not comparable across them. Thus, we standardized the raw counts by the population
estimates of the states at the end of 2019 from The US Census Bureau (https://www.
census.gov). Specifically, the standardized number of daily new confirmed cases for each
state was recorded in terms of “per million” over the study period.

CLUSTERING US STATES BY COVID-19 COUNTS WITH NMF

5

Figure 1 displays the raw daily new confirmed cases in four states with drastically
different patterns — New York, North Carolina, Louisianan and Massachusetts — over
the study period. Periodicity was observed in the series with a period of 7 days. The
vertical red dashed lines in Figure 1 are presented with 7-day gaps. The 7-day period was
possibly caused by the routine of tests available on different business days and testing
report delivery by the public health departments. In each panel, the thick blue curve
shows the 7-day moving average (with boundary adjustment) of the new confirmed cases
per million in the state. The moving averages are much smoother than the raw counts,
allowing us to observe the long-term trend in the time series and to make comparisons
among the states more easily. The moving average series are the input data for our
clustering analysis.

3. Methods
Let (xij ) be the input data matrix, i = 1, 2, . . . , 49, j = 1, 2, . . . , 126, where xij denotes
the number of confirmed cases per million (7-day moving average) of state i on day j.
With the starting date held on March 22, 2020, clustering can be done on each subperiod with incrementally extended ending date, in addition to the whole study period.
The collected analyses on these sub-periods may help identifying an increment in time
period that might have led to substantial changes in the clustering results. For a given
time period, our clustering is carried out on the coefficients of NMF bases of the series. A
potential change point in the cluster structure is suggested when the consistency measures
of every two consecutive clustering outcomes are too low. The components of our method
are presented next.
3.1. NMF. NMF is a class of matrix factorization methods where a high-dimensional
non-negative matrix is approximated by the product of non-negative low-rank matrix
factors. Consider an n × m non-negative matrix X := (xij ), where the rows and columns
respectively represent observations and features. In our data analysis, we have n = 49
rows, each representing the time series of a state, and m columns, which is the number
of days in the study period, each representing one day of all the states in the time series.
An NMF of X determines non-negative matrices W := (wij ) and H := (hij ) such that
X ≈ W H,

(1)

where W and H are, respectively, (n × r) and (r × m) matrices with r < m being the
number of NMF bases of X. In essence, each row of H is a basis vector of dimension
m; each row of X is approximated by a linear combination of these bases, where the
coefficients are stored in the rows of W . A good approximation of X indicates that most
of the variation in X is captured by the resultant linear combination of the bases. The
number of bases r is usually much smaller than m. This dimension reduction procedure
allows us to explore the (n × m) matrix X more efficiently through a low dimensional

6

CLUSTERING US STATES BY COVID-19 COUNTS WITH NMF

matrix W . That is, the series of state i is represented by a coefficient vector of dimension
r of the bases in the i-th row of W .
The algorithm that we used specifically was the weighted non-negative factorization
(WNMF) algorithm [11], which, as to be shown in the next subsection, facilitates the
selection of the tuning parameter r. Let V := (vij ) be a weight matrix of the same
dimension as X, where vij is the weight of xij , reflecting its relative importance. The
matrix approximation problem accordingly becomes
X≈V

V

(W H)

(2)

subject to the constraints of wij , hij ≥ 0 for all i, j, where
denotes the operator of
element-wise product. When all the elements in V are ones, WNMF is reduced to the
standard NMF.
Consider a squared error cost function
2

kV

(X − W H)k =

n X
m
X

vij xij − wi> hj

2

,

(3)

i=1 j=1

where wi> and hj are respectively the i-th row of W and the j-th column of H. Lee and
Seung [18] developed a multiplicative update rule that would minimize the cost function
for NMF by iteratively updating W and H. Wang et al. [25] extended the multiplicative
rule such that it would be applicable to WNMF. Let t ∈ N index the iteration process.
At the t-th iteration, the updates of W (t+1) and H (t+1) from W (t) and H (t) are given by
>

H

(t+1)

W

(t+1)

←H

W (t) (X

(t)

←W

W
(t)

(t) >

V)

[(W (t) H (t) )

(X

V )H (t)

[(W (t) H (t) )

V]

,

(4)

,

(5)

>

V ]H (t)

>

where X > represents the transpose of X. The alternating update goes on until the absolute difference between the maximum and the minimum costs over a number of successive
iterations is below a preset tolerance. Equations (4) and (5) jointly guarantee that Equation (2) is non-increasing, and, consequently, that the algorithm at least converges to a
local minimum [18]. We used the WNMF algorithm implemented in R package NMF [9].
Like any iterative algorithm, WNMF needs starting matrices W (0) and H (0) . We
used the nonnegative double singular value decomposition [1] to initialize the WNMF
algorithm. In its basic form, this method selects the starting matrices that approximate
the singular value decomposition of X by dropping the non-positive singular values and
replacing the negative entries in the unit-rank matrices formed by singular vectors with
zeros. The algorithm does not grant randomization, which ensures reproducibility. It
rapidly provides starting matrices with error almost as small as those from competing
initialization approaches.

CLUSTERING US STATES BY COVID-19 COUNTS WITH NMF

7

3.2. Rank Selection for NMF. It is critical to select an appropriate rank or the number
of bases for NMF. We selected r through a cross-validation-based scheme extended from
the method proposed by Kanagal and Sindhwani [15]. For an s-fold cross-validation, the
entries in X are partitioned randomly into s sub-groups or folds. For a given r, each of
fold is held out as testing data, while the remaining (s − 1) folds are used as training data
with the held-out entries regarded as missing values to run a NMF. The mean squared
prediction error (MSPE) of each held-out fold is computed by comparing the observed
value with predictions using the NMF based on the training data. The total MSPE
summed over all folds is used as the cross-validation criterion.
NMF for matrices with missing entries can be approached by a WNMF problem [16].
Let the weight matrix V indicate the missing values in the held-out fold:

1, if x is observed;
ij
vij =
(6)
0, if xij is missing.
The missing values can be predicted by the corresponding values in the approximation
matrix W H after implementing WNMF. Given a candidate set of r ∈ {2, 3, . . . , 12},
where the maximum candidate value was about a quarter of the number of the states,
the one with the minimum MSPE was selected for the value of r.
The right-skewness of the COVID-19 case counts in most states needs some care in
WNMF. The data magnitudes in the right columns (later time) are much larger than
those in the left (earlier time). A random partitioning of X may cause the data distribution in the testing fold significantly different from the counterparts in the training folds,
potentially resulting in poor predictions. Having this in mind, we considered a stratified
partitioning scheme. Specifically, all the entries of X were stratified into two strata based
on the magnitudes, and a simple random sampling was executed within each stratum.
The split of the two strata was set at the 75-th percentile of the observed data in the
study period, giving the most stable results based on our experiments.
3.3. Clustering Procedure. Our clustering procedure based on WNMF has two steps,
the first of which is dimension reduction with NMF. This step starts with rank selection
of NMF as presented in the last subsection. For the selected rank r,
>
x>
i ≈ wi H,

(7)

>
where x>
i is defined analogously as wi . Equation (7) implies that the (m-dimensional)
features of the i-th subject in X are well approximated by the (r-dimensional) corresponding coefficients in W , rendering a cluster analysis through W .
The second step is to perform a clustering analysis using the basis coefficients W
as input. A variety of well-developed clustering algorithms can be adopted, and our
choice was the k-means clustering as available in R [12]. Different combinations of basis
coefficients represent different groups in both the pattern of the times series and their
magnitudes. The algorithm depends on a random initialization. We used 500 random

8

CLUSTERING US STATES BY COVID-19 COUNTS WITH NMF

Algorithm 1: Pseudo-algorithm of the NMF-based k-means clustering procedure
for the daily COVID-19 case counts in 49 states.
Input: Raw COVID-19 daily COVID-19 case counts in 49 states
Output: Clustering results of the 49 states
1 Scale by population and apply 7-day moving average for each state to obtain X;
2 for r = 2 to 12 do
3
Carry out cross-validation based on WNMF of X with rank r;
4
Compute MSPEr ;
5 end
(opt)
6 Select NMF rank r
= arg minr {MSPEr };
(opt)
7 Obtain W based on NMF rank r
;
8 for g = 2 to 10 do
9
Carry out k-means for W with g clusters;
10
Compute WSS for this g, WSSg ;
11 end
(opt)
12 Select the number of clusters g
based on the elbow plot and practical
interpretation;
(opt)
13 return Result of k-means clustering for W with g
clusters;
starting point and chose the result that gave the smallest within-cluster sum of squares
(WSS). To select the number of clusters g, we used the elbow method which plots the WSS
as a function of g, and chose g as the elbow of the curve. With 49 states, we considered
candidate g ∈ {2, 3, . . . , 10}. The determination of the elbow position may vary from
case to case. Our selection considered both the curvature and the interpretation of the
clustering results.
Algorithm 1 summarizes the major steps of the NMF-based k-means clustering algorithm for the daily COVID-19 new case counts from 49 states in a given time period.
3.4. Temporal Dynamics in Cluster Structure. Algorithm 1 can be applied to the
new case count series of any time period, which facilitates an investigation of how the
clustering results change over time as more data becomes available. We fixed the starting
date at March 22, 2020 and considered a sequence of time periods with ending date
starting from March 28, 2020, with an increment of one week until July 25, 2020. The
incremental segment of 7 days is chosen according to the observed 7-day period in the
data; see Figure 1. Such arrangement led to a total of 18 study periods. The clustering
results over the 18 periods with incremental ending dates provided information about the
temporal dynamics of the cluster structure.
At each ending date, we compared the obtained clustering results with or without the
data from the most recent week. The agreement between the two clustering results was
assessed by adjusted rand index [ARI, 13]. The ARI measurement was originally proposed
to assess the accuracy of a clustering strategy by comparing its result with the ground
truth. ARI ranges between −1 and 1, with higher values indicating that the clustering
result is closer to the truth. We use it here to quantify the degree of agreement between

CLUSTERING US STATES BY COVID-19 COUNTS WITH NMF

9

basis 1

basis 2

basis 3

basis 4

basis 5

basis 6

basis 7

basis 8

basis 9

basis 10

basis 11

basis 12

20
15
10
5
0

20
15
10
5
0

20
15
10
5
0

20
15
10
5
0
Apr

May

Jun

Jul

Apr

May

Jun

Jul

Apr

May

Jun

Jul

Figure 2. NMF bases for the proposed algorithm applied to the time
series data from March 22 to July 25, 2020.
a pair cluster results. A small value of ARI suggests that the two clustering results are
quite different from each other. A big drop after a sequence of high values may indicate
a structural change in the clustering results.
4. Results
We first report the clustering results on the entire study period (from March 22 to
July 25, 2020), then investigate the temporal dynamics in the clustering results, and
finally compare the cluster structures before and after a possible change point.

10

CLUSTERING US STATES BY COVID-19 COUNTS WITH NMF

Table 1. Summary of the clustering results based on Algorithm 1 for the
entire study period (March 22 to July 25, 2020)
Cluster States
A
B
C
D
E
F

G

New Jersey, New York
Connecticut, Delaware, Massachusetts, Rhode Island
District of Columbia, Illinois, Iowa, Maryland, Minnesota, Nebraska, Virginia
Arizona
Louisiana
Alabama, Arkansas, California, Florida, Georgia, Idaho, Mississippi, Nevada,
North Carolina, South Carolina, Tennessee, Texas, Utah
Colorado, Indiana, Kansas, Kentucky, Maine, Michigan, Missouri, Montana,
New Hampshire, New Mexico, North Dakota, Ohio, Oklahoma, Oregon, Pennsylvania, South Dakota, Vermont, Washington, West Virginia, Wisconsin,
Wyoming

4.1. Clustering Result for the Entire Study Period. Algorithm 1 was applied to
the preprocessed time series data for the entire study period from March 22 to July 25,
2020. The NMF step yielded 12 bases as displayed in Figure 2. Most of the bases show
distinctive features of peaks in terms of their timings and shapes. In chronological order,
we see clearly a series of bases peaking with a size of about 10 or higher from early April
to late July. The bases have different patterns in addition to their sizes. For example,
basis 2 and 3 with early peaks are important for capturing high counts in early stage of
the study period. Basis 2 is about a week later but goes down much more slowly than
basis 3; basis 3 spans about 2 weeks while basis 2 spreads for about 5 weeks. Basis 1 and
basis 11 with later peaks are important for capturing high counts in later stage of the
study period, with basis 1 having an earlier climbing point and earlier peak than basis 11.
Bases with less obvious interpretations and lower magnitude help properly adjust the ups
and downs in describing the daily count curves of the 49 states.
The k-means step on the coefficients of the 12 bases grouped the 49 states into 7 clusters
as summarized in Table 1, with a graphic visualization presented in the left panel of
Figure 3. The means of the daily new case series per million (in population) for the
7 clusters are overlaid with the series themselves in each cluster in Figure 4. As expected,
the curves in the same cluster appear similar in shape, but present different patterns or
trends across the clusters. The states that are geographically close are likely to be in
the same cluster due to the spillover effect. Other factors such as mobility, transport
capacity, population density, and state-level social distancing measures may have been in
effect, too, as discussed next.
In the sequel, we use the two-letter state abbreviations to represent the states for
brevity in our discussion (https://www.ssa.gov/international/coc-docs/states.
html).
There are two singleton clusters D and E, which contains AZ and LA, respectively,
presenting completely different characteristics of the new case count curves as shown in

CLUSTERING US STATES BY COVID-19 COUNTS WITH NMF

03/22 to 07/25

11

03/22 to 05/30

Figure 3. Clustering result for the entire study period (from March 22
to July 25, 2020) in the left panel; clustering result for the first half of the
entire study period (from March 22 to May 30, 2020, where May 30, 2020
appears to be a potential change point of dynamics) in the right panel.
Figure 4. The curve of AZ was flat early on, but started climbing at the beginning of
June with a peak in the first week of July. Although a declining trend was observed since
then, the counts had remained high until the end of the study period. The coefficient of
basis 4 for AZ is outstanding, while the coefficient of basis 1 is relatively large as well,
together precisely presenting the curve feature. The observed curve pattern may have to
do with the state policies. The “stay at home” order in AZ was in effect from March 31
to May 15, and a second “business closing” order was issued on June 29 in response to
the fast growing confirmed cases in June. On the other hand, the LA curve has two
peaks, one in early April and the other in late July. It is the only bimodal curve in
Figure 4. The coefficients of basis 1 and 3 for LA are both relatively greater than the
counterparts of most of the other states, capturing the observed bimodal pattern. In fact,
LA was one of the states with the highest number of confirmed cases per capita among all
of the US states in July and August (https://covid.cdc.gov/covid-data-tracker/
#cases_casesper100k). The first outbreak lasted from late March to mid April, possibly
caused by the Mardi Gras festivities in late February when millions of people traveled to
New Orleans. The second wave started in late June, following the phase 2 of business
reopening. Both peaks in LA are higher than the peaks in most of the other states.
The two states in Cluster A are NY and NJ whose new count case curves resemble each
other throughout the study period. The COVID-19 broke out in NY and was rapidly
transmitted to its neighbor NJ in mid March as a large number of people working in
New York City (NYC) were resident in northern NJ across the Hudson river. The early
counts of daily new cases in NY and NJ were significantly higher than all of the other
continental states. After peaking in early April, the pandemic appeared to be wellcontrolled owing to the practice of strict (mandatory) public health policies; for instance,
the business shutdown in NYC started in mid March and the face covering order was

12

CLUSTERING US STATES BY COVID-19 COUNTS WITH NMF

Cluster A

Cluster B

Cluster C

Cluster D

Cluster E

Cluster F

400

200

0

Scaled Daily confirmed counts

400

200

0

400

200

0
Apr

Cluster G

May

Jun

Jul

400

200

0
Apr

May

Jun

Jul

Date

Figure 4. Daily confirmed case counts (after scaling and smoothing) of
the states in each cluster; the mean curves are presented by black thick
curves. Especially, each of the clusters D and E has one state member only.
issued on April 15. The number of new cases went down and did not bounce back until
July. Hence, the NY and NY curves are completely opposite to the AZ curve, reflected
in relatively large coefficients of bases 2 and 3.
The four states in Cluster B, CT, DE, MA and RI, are all geographically close to NY
and NJ. Their mean curve is similar to that of Cluster A in shape; both are unimodal
and the peaks appear in the early times. The main difference among the curves in

CLUSTERING US STATES BY COVID-19 COUNTS WITH NMF

13

Clusters A and B is reflected in magnitude; the NY and NJ curves (in Cluster A) have
been consistently higher over time. A minor difference is that the peaks in NY and NJ
both occurred in early April, compared to the peaks of the four states occurring around
late April. The four state curves did not show any tendency of rebound since May until
the end of the study period, either. The similarity among the curves in Clusters A
and B may be attributed to the similar state government policies. All of the six states
are participating parties of the Eastern States Multi-State Council which, as announced
on April 13, 2020, worked together to develop a fully integrated regional framework
to gradually lift the states’ “stay at home” orders while minimizing the risk of increased
spread of the virus (https://en.wikipedia.org/wiki/Eastern_States_Multi-state_
Council). The low counts since June appeared to support the effectiveness of their
collective efforts.
Cluster C contains 7 states, DC, IA, IL, MD, MN, NE and VA. Their mean curve is
flatter than those of Clusters A and B, and the values are smaller in magnitude in the
early and mid times. The peak of the average occurred in early May, followed by a decline
until a second increasing period that started in July. Three of them (DC, MD and VA)
belong to the Washington metropolitan area. Similar government orders were issued at
about the same time in this region. For example, public schools were closed in mid March
in DC and VA; the “stay at home” orders were issued on March 30 by all three state
governments. The other four states are contiguous midwest states. Chicago in IL and
Omaha in NE were hot spots during the outbreak early on. In particular, Chicago is one
of the biggest ports of entry in the US; both Chicago and Omaha have fully functional
interstate transportation facilities. The high mobility may have contributed to their high
case counts in May.
Cluster F contains 13 states with low counts of new cases from the start of the study
period to June, followed by a continuing rise in June and July. The states form two big
blocks respectively in the west (CA, NE, ID and UT) and south (AL, AR, FL, GA, MS,
NC, SC, TN and TX). Among them, CA was one of the first states reporting confirmed
cases, with several counties marked as hot spots. Although CA is a populated state, the
pandemic was effectively controlled due to the rapid and powerful response by the state
government. In March, CA became the first state to announce business shutdown, which
was kept in effect until early May. Several populated counties such as San Francisco,
Santa Clara, and Contra Costa even ordered residents to shelter in place for three weeks
for the purpose of slowing down the mobility. Most of the other states in this cluster
had similar orders in late March. The timely public health measures worked well to keep
the curves flat at the early and mid times. On the other hand, the increased population
mobility in May might have contributed to the rapidly increased case counts during the
later periods. Most of the states announced business reopening in late April or early May.
In addition, six of the top ten busiest airports are located in CA, GA, FL, NV and TX. It
is worthy of mentioning that the AZ curve is similar to the overall trend of the curves in

14

CLUSTERING US STATES BY COVID-19 COUNTS WITH NMF

Table 2. The selected tuning parameters for 18 study periods with end
point incremented by one week.
Study period

T1

Rank of NMF (r)
2
Number of clusters (g) 5
Study period

T10

Rank of NMF (r)
7
Number of clusters (g) 6

T2

T3

T4

T5

T6

T7

T8

T9

5
5

4
5

6
6

6
5

8
5

7
6

8
6

8
6

T11

T12

T13

T14

T15

T16

T17

T18

8
7

8
7

12
8

11
6

12
7

11
7

12
7

12
7

Cluster F. However, the AZ curve is separated in a singleton group, possibly because it
started increasing at the beginning of June, about two weeks prior to the climbing trend
observed in the states in Cluster F.
The remaining 21 states are in Cluster G. Overall, these states have relatively low
counts of new case every day, and their curves are flat throughout the study period.
States in this cluster have either low population density or mandate strict quarantine
measures. For instance, WY, MT, ND and SD are four of the top five states with the
lowest population densities. The first domestic confirmed case of the COVID-19 was
reported in Seattle, WA on January 22, and the King county (in Seattle) became one
of the earliest hot spots in the US. In response to the outbreak, the state governor
declared state emergency as early as February 29, and shut down the schools statewide
on March 3. A series of instructions and orders related to mitigating the impact of the
COVID-19 were proposed and executed subsequently. The business reopening plan in WA
was not implemented until May 26, later than most of the other states (including the
states that were much more severely hit by the coronavirus) in the US. All those efforts
may have caused that the counts of daily confirmed cases in WA started decreasing since
the second week of April, and remained at a low level until the end of the study period.

4.2. Temporal Dynamic of Cluster Structure. In this section, we look into the temporal dynamics in cluster structure. The proposed clustering method was applied to 18
sub study periods (all starting from March 22) with end point successively incremented
by one week, i.e., April 4, April 11, and so on. Let T1 , T2 , . . . , T18 indicate the 18 cumulatively incremental study periods in sequence. Table 2 summarizes the rank of NMF
(denoted r) and the number of clusters (denoted g) of each study period. The number
of bases r increases in general as the duration of the study extends. This is expected
as longer study period usually admits more complex curve patterns which require more
bases to approximate. The number of clusters g started with 5 increased a little over
time, and remained at 7 since T15 .
To identify possible structural changes in the clustering results, we checked the consistency in the resultant clusters as measured by ARI before and after each week (i.e., T1

CLUSTERING US STATES BY COVID-19 COUNTS WITH NMF

15

ARI
1.0

●
●

0.9

●

●
●

0.8

●

●

●

●

●
●

0.7
●

●

●

●

0.6

07/18

07/11

07/04

06/27

06/20

●

06/13

05/30

05/23

05/16

05/09

05/02

04/25

04/18

04/11

04/04

03/28

●

06/06

0.5

Figure 5. ARI for successive pairwise clustering results as the study period was extended by one week.

versus T2 , T2 versus T3 and so on). Figure 5 presents the ARI for each successive comparison between the clustering results from Ti versus those from Ti+1 , i = 1, 2, . . . , 17,
where the horizontal axis represents the end point of the shorter time period in each
pair. ARI has a moderate value at the very beginning, and vibrates in the early few
weeks. A tremendous drop in T10 heralds a large degree of inconsistency. Hence, possible
structural change in the clustering results may occur during the one-week periods before
and after May 30. ARI remains relatively low until a rising in T12 as the week of June 20
is included. After a slight drop at T13 , ARI stays at a high level until the end of the study
period.
The possible change in the clustering results as the study period up to the week of
May 30 is appended echoes the findings in the clustering patterns in Figure 4. It was
during the period from May 30 to June 20 that the rebound in many of the states in
Clusters C, E, and G and the rise in the states in Clusters D and F occurred. Noticing the estimated mean of incubation period is around 5.34 days with 95% confidence
interval [4.29, 6.40] [26] and that the majority (97.5%) of the infected individuals developed symptoms within 11.5 days [17], we speculated that the actual change point
was in the week between May 17 and May 23. This week coincides with the timing of business reopening in most of the states in the US; for instance, the second
phase of reopening in Texas was on May 18, 2020 (https://www.dshs.state.tx.us/
coronavirus/opentexas.aspx) and the phase one reopening of certain sectors of the
economy in Connecticut took place on May 20, 2020 (https://portal.ct.gov/DECD/
Content/Coronavirus-Business-Recovery/). It is likely that the large-scale business
reopening across the nation had an association with the change of spread pattern of
COVID-19.

16

CLUSTERING US STATES BY COVID-19 COUNTS WITH NMF

Table 3. Cluster details of the period from 03/22/2020 to 05/30/2020
Cluster States
A*
B*
C*
D*
E*

F*

New York
New Jersey, Massachusetts
Connecticut, Delaware, Rhode Island
District of Columbia, Illinois, Iowa, Maryland, Minnesota, Nebraska
Louisiana, Michigan, Pennsylvania, South Dakota
Alabama, Arizona, Arkansas, California, Colorado, Florida, Georgia, Idaho, Indiana, Kansas, Kentucky, Maine, Mississippi, Missouri, Montana, Nevada, New
Hampshire, New Mexico, North Carolina, North Dakota, Ohio, Oklahoma, Oregon, South Carolina, Tennessee, Texas, Utah, Vermont, Virginia, Washington,
West Virginia, Wisconsin, Wyoming

4.3. Comparison with the Results from Data Before May 30. The study of the
temporal dynamic of cluster structure in Section 4.2 induces a comparison between the
clustering results including and excluding the data after May 30, respectively corresponding to T18 and T10 (March 22 to May 30, 2020). As shown in Table 2, there are 6 clusters
for T10 , where the detailed clustering result is summarized in Table 3, followed by a
graphic visualization given in the right panel of Figure 3.
Specifically, the ARI score between the clustering results of T18 and T10 is 0.36. The
primary difference between the two clustering results is that Clusters D (AZ), F, and G
(the majority) from T18 are grouped in one big cluster F* from T10 . As seen in Figure 4,
the curves in Clusters D, F, and G are all flat over T10 in spite of several minor humps up
to May 30. Secondly, LA, MI, PA, and SD are in one cluster (Cluster E*) from T10 , but
from T18 , LA forms a singleton and MI, PA and SD belong to Cluster G. The four states
had early peaks between April 7 and April 20, but the counts were significantly lower
than that from NY, rendering them distinct from all the other states from T10 . Thirdly,
NJ and NY are in the same cluster from T18 , but from T10 , NY itself forms a single-state
cluster, and NJ and MA together form another cluster. Different from NY that increased
from the beginning to the first week of April and then started declining right after, NJ had
a long peak for almost two weeks in April. In addition, the magnitudes of the curves of
NJ and MA were relatively close to each other throughout T10 , consistently smaller than
that of NY. Cluster D* from T10 and Cluster C from T18 are similar, with the exception
of VA in C but not in D*.
A few factors might have caused the split of the largest group G* from T10 into Clusters D, F and G from T18 . We have closely looked into AZ in Cluster D in Section 4.1.
The counts in the states in Cluster F are obviously higher than those in Cluster G on
average after May 30. The first factor may be the various state-level quarantine measures. Almost all the state governments (in Cluster G) mandated business shutdown
(or remote working) in March; however several highly populated states in cluster F, like
FL, reopened the local business earlier than the rest. Two other states (in Cluster F),

CLUSTERING US STATES BY COVID-19 COUNTS WITH NMF

17

TX and GA, also reopened their business in early May, including some entertainment
facilities with massive gathering. Theaters and clubs were reopen in GA in late April,
while recreational trails and beaches were reopen in FL on May 4. No face covering
orders were enforced for either indoor or outdoor activities in those states. The second
possible factor is population density. Though some of the states in cluster G announced
reopening around early May (e.g., CO, IN, ME, WY and WV), none of these states have
high population density regions like the Atlanta metropolitan area in GA, the Miami-Fort
Lauderdale-West Palm Beach metropolitan area in FL or the Dallas-Fort Worth metroplex in TX. Lastly, some states in cluster F maintain a much busier traffic systems which
possibly cause larger volume of mobility.
5. Discussion
Our clustering procedure is a combination of NMF and k-means clustering. NMF is
used for dimension reduction and k-means is applied to the basis coefficients from the
NMF. NMF itself is a clustering method in which the number of clusters is the rank and
each data point is assigned to a cluster corresponding to the most highly expressed basis
[2]. When the basis are restricted to be orthogonal, NMF and k-means are equivalent in
terms of the objective function [6]. Our method is different from the traditional NMF
clustering in that the clusters are formed by the similarities in basis coefficients. It has
the advantage to capture patterns that are combinations of multiple bases, which may
not be appropriate to be clustered to the groups represented by either one of the bases.
Our method is also preferred to the standard k-means clustering because the k-means
algorithm gives equal weights to all time points. However, data of early time points may
have a much smaller magnitude. The difference in early time times may not contribute
as much as the later times. As a result, states with distinctive patterns at early times
such as NY, NJ and LA, cannot be successfully distinguished from other states by the
standard k-means.
Our clustering of the 49 states appears to be reasonably reflecting the spread and
control of the pandemic in the US up to July 25, 2020. The third wave since September
as well as the differences in quarantine and business resumption measures are expected
reshuffle the clustering reported in this paper, which merits continuing research. The
implementation of our method is publicly available at GitLab (https://gitlab.com/
covid-19-analysis/covid19-nmf.git).
References
[1] Boutsidis, C. and E. Gallopoulos (2008). SVD based initialization: A head start for
nonnegative matrix factorization. Pattern Recognition 41 (4), 1350–1362.
[2] Brunet, J.-P., P. Tamayo, T. R. Golub, and J. P. Mesirov (2004). Metagenes and
molecular pattern discovery using matrix factorization. Proceedings of the National
Academy of Sciences of the United States of America 101 (12), 4164–4169.

18

CLUSTERING US STATES BY COVID-19 COUNTS WITH NMF

[3] Chen, W.-C. and R. Maitra (2015). EMCluster: EM Agorithm for Model-Based
Clustering of Finite Mixture Gaussian Distribution. R Package. URL http://cran.
r-project.org/package=EMCluster.
[4] Chiou, J.-M. and P.-L. Li (2007). Functional clustering and identifying substructures
of longitudinal data. Journal of the Royal Statistical Society. Series B (Statistical
Methodology) 69 (4), 679–699.
[5] Devarajan, K. (2008). Nonnegative matrix factorization: An analytical and interpretive tool in computational biology. PLOS Computational Biology 4 (7), e1000029.
[6] Ding, C., X. He, and H. D. Simon (2005). On the equivalence of nonnegative matrix
factorization and spectral clustering. In H. Kargupta, J. Srivastava, C. Kamath,
and A. Goodman (Eds.), Proceedings of the 2005 SIAM International Conference on
Data Mining, Philadelphia, PA, USA, pp. 606–610. SIAM.
[7] Dong, E., H. Du, and L. Gardner (2020). An interactive web-based dashboard to
track COVID-19 in real time. The Lancet Infectious Diseases 20 (5), 533–534.
[8] Fauci, A. S., H. C. Lane, and R. R. Redfield (2020). Covid-19—Navigating the
uncharted. The New England Journal of Medicine 382 (13), 1268–1269.
[9] Gaujoux, R. and C. Seoighe (2010). A flexible R package for nonnegative matrix
factorization. BMC Bioinformatics 11, 367.
[10] Goyal, P., J. J. Choi, L. C. Pinheiro, E. J. Schenck, R. Chen, A. Jabri, M. J. Satlin,
T. R. Campion Jr., M. Nahid, J. B. Ringel, K. L. Hoffman, M. N. Alshak, H. A. Li,
G. T. Wehmeyer, M. Rajan, E. Reshetnyak, N. Hupert, E. M. Horn, F. J. Martinez,
R. M. Gulick, and M. M. Safford (2020). Clinical characteristics of Covid-19 in New
York City. The New England Journal of Medicine 382 (24), 2372–2374.
[11] Guillamet, D., M. Bressan, and J. Vitria (2001). A weighted non-negative matrix
factorization for local representations. In Proceedings of the 2001 IEEE Computer
Society Conference on Computer Vision and Pattern Recognition. CVPR 2001, Volume I, Piscataway, NJ, USA, pp. 942–947. IEEE.
[12] Hartigan, J. A. and M. A. Wong (1979). Algorithm as 136: A k-means clustering algorithm. Journal of the Royal Statistical Society. Series C (Applied Statistics) 28 (1),
100–108.
[13] Hubert, L. and P. Arabie (1985). Comparing partitions. Journal of Classification 2,
193–218.
[14] Jacques, J. and C. Preda (2014). Functional data clustering: A survey. Advances in
Data Analysis and Classification 8, 231–255.
[15] Kanagal, B. and V. Sindhwani (2010). Rank selection in low-rank matrix approximations: A study of cross-validation for NMFs. In A. Gretton, M. Mahoney, M. Mohri,
and A. Talwalkar (Eds.), Low-Rank Methods for Large-scale Machine Learning
(Workshop in NIPS ’10). https://www.cs.umd.edu/~bhargav/nips2010.pdf.
[16] Kim, Y.-D. and S. Choi (2009). Weighted nonnegative matrix factorization. In
2009 IEEE International Conference on Acoustics, Speech and Signal Processing,

CLUSTERING US STATES BY COVID-19 COUNTS WITH NMF

[17]

[18]

[19]
[20]

[21]

[22]
[23]
[24]

[25]

[26]

19

Piscataway, NJ, USA, pp. 1541–1544. IEEE.
Lauer, S. A., K. H. Grantz, Q. Bi, F. K. Jones, Q. Zheng, H. R. Meredith, A. S.
Azman, N. G. Reich, and J. Lessler (2020). The incubation period of coronavirus
disease 2019 (COVID-19) from publicly reported confirmed cases: Estimation and
application. Annals of Internal Medicine 172 (9), 577–582.
Lee, D. D. and H. S. Seung (2000). Algorithms for non-negative matrix factorization.
In T. K. Leen, T. G. Dietterich, and V. Tresp (Eds.), Proceedings of the 13th International Conference on Neural Information Processing Systems (NIPS ’00), Cambridge,
MA, USA, pp. 535–541. MIT Press.
Liao, T. W. (2005). Clustering of time series data—a survey. Pattern Recognition 38 (11), 1857–1874.
Lin, J., M. Vlachos, E. Keogh, and D. Gunopulos (2004). Iterative incremental clustering of time series. In E. Bertino, S. Christodoulakis, D. Plexousakis,
V. Christophides, M. Koubarakis, K. Böhm, and E. Ferrari (Eds.), Proceedings of the
9th International Conference on Extending Database Technology, Berlin, Heidelberg,
Germany, pp. 106–122. Springer-Verlag.
Moghadas, S. M., A. Shoukat, M. C. Fitzpatrick, C. R. Wells, P. Sah, A. Pandey, J. D.
Sachs, Z. Wang, L. A. Meyers, B. H. Singer, and A. P. Galvani (2020). Projecting
hospital utilization during the COVID-19 outbreaks in the United States. Proceedings
of the National Academy of Sciences of the United States of America 117 (16), 9122–
9126.
Shaw, C. and G. King (1992). Using cluster analysis to classify time series. Physica
D: Nonlinear Phenomena 58 (1-4), 288–298.
Tang, C., T. Wang, and P. Zhang (2020). Functional data analysis: An application
to COVID-19 in the United States. Arxiv preprint. Arxiv:2009.08363.
Tian, T., J. Tan, Y. Jiang, X. Wang, and H. Zhang (2020). Evaluate the risk of
resumption of business for the states of New York, New Jersey and Connecticut via
a pre-symptomatic and asymptomatic transmission model of COVID-19. https:
//doi.org/10.1101/2020.05.16.20103747.
Wang, G., A. V. Kossenkov, and M. F. Ochs (2006). LS-NMF: A modified nonnegative matrix factorization algorithm utilizing uncertainty estimates. BMC bioinformatics 7, 175.
Zhang, P., T. Wang, and S. X. Xie (2020). Meta-analysis of several epidemic characteristics of COVID-19. Journal of Data Science 18 (3), 536–549.

