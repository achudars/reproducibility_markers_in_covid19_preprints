DRAFT VERSION, SUBJECT TO MODIFICATION. FOLLOW THE UPDATES FROM: https://arxiv.org/abs/2003.11371

1

Mathematical Modeling of Epidemic Diseases; A
Case Study of the COVID-19 Coronavirus

arXiv:2003.11371v4 [q-bio.PE] 31 Dec 2020

Reza Sameni*
Version 4, Dec 30th 2020

Abstract—In this research, we study the propagation patterns
of epidemic diseases such as the COVID-19 coronavirus, from
a mathematical modeling perspective. The study is based on
an extensions of the well-known susceptible-infected-recovered
(SIR) family of compartmental models. It is shown how social
measures such as distancing, regional lockdowns, quarantine and
global public health vigilance, influence the model parameters,
which can eventually change the mortality rates and active
contaminated cases over time, in the real world. As with all
mathematical models, the predictive ability of the model is limited
by the accuracy of the available data and to the so-called level of
abstraction used for modeling the problem. In order to provide
the broader audience of researchers a better understanding of
spreading patterns of epidemic diseases, a short introduction on
biological systems modeling is also presented and the Matlab
source codes for the simulations are provided online.

I. I NTRODUCTION
Since the outbreak of the COVID-19 coronavirus in early
2020, the virus has affected most countries and taken the lives
of several thousands of people worldwide. By March 2020,
the World Health Organization (WHO) declared the situation a
pandemic, the first of its kind in our generation. To date, many
countries and regions have been locked-down and applied
strict social distancing measures to stop the virus propagation.
From a strategic and healthcare management perspective, the
propagation pattern of the disease and the prediction of its
spread over time is of great importance, to save lives and to
minimize the social and economic consequences of the disease.
Within the scientific community, the problem of interest has
been studied in various communities including mathematical
epidemiology [1], [2], biological systems modeling [3], [4],
signal processing [5] and control engineering [6].
The problem of pandemic modeling has significant practical importance for governments and decision-makers. Nonpharmaceutical interventions (NPIs) refer to actions and policies adopted by individuals, authorities or governments that
help slowing down the spread of epidemic diseases. NPIs
are among the best ways of controlling pandemic diseases
when vaccines or medications are not yet available1 . During
the COVID-19 pandemic, several attempts have been made to
categorize and quantify the various NPIs of different regions
and nations. The quantification of the NPI is believed to be
* R. Sameni is an Associate Professor of Biomedical Engineering at the
Department of Biomedical Informatics, Emory University School of Medicine,
101 Woodruff Circle, Atlanta, GA 30322, US (e-mail: rsameni@dbmi.emory.
edu).
1 See Centers for Disease Control and Prevention guidelines on NPIs: https://
www.cdc.gov/nonpharmaceutical-interventions/.

helpful for comparing the effectiveness of regional policies in
containing the pandemic spread. By using machine learning
techniques, the quantified NPI can be used to forecast the
future trends of the pandemic and to simulate “what if
scenarios” for the better management of human and medical
resources, and to eventually prescribe appropriate NPI for
controlling the pandemic [7]. The Oxford COVID-19 Government Response Tracker (OxCGRT) is one of the NPI tracking
projects, which were launched and regularly updated during
the COVID-19 pandemic [8]. Most recently, this project has
been used in the machine learning community to launch data
challenges for NPI-based prediction and prescription plans [9].
In this study, epidemic outbreaks are studied from
an interdisciplinary perspective, by using an extension of
the susceptible-exposed-infected-recovered (SEIR) model [2],
which is a mathematical compartmental model based on the
average behavior of a population under study. The objective
is to provide researchers a better understanding of the significance of mathematical modeling for epidemic diseases. It is
shown by simulation, how social measures such as distancing,
regional lockdowns and public health vigilance, can influence
the model parameters, which in turns change the mortality
rates and active contaminated cases over time.
It should be highlighted that mathematical models applied
to real-world systems (social, biological, economical, etc.) are
only valid under their assumptions and hypothesis. Therefore,
this research— and similar ones— that address epidemic patterns, do not convey direct clinical information and dangers for
the public, but should rather be used by healthcare strategists
for better planning and decision making. Hence, the study of
this work is only recommended for researchers familiar with
the strength points and limitations of mathematical modeling
of biological systems. The Matlab codes required for reproducing the results of this research are also online available in
the Git repository of the project [10].
In Section II, a brief introduction to mathematical modeling
of biological systems is presented, to highlight the scope of
the present study and to open perspectives for the interested
researchers, who may be less familiar with the context. The
proposed model for the outspread of the coronavirus is presented in Section III. The article is concluded with some
general remarks and future perspectives.

DRAFT VERSION, SUBJECT TO MODIFICATION. FOLLOW THE UPDATES FROM: https://arxiv.org/abs/2003.11371

II. A N

INTRODUCTION TO MATHEMATICAL

EPIDEMIOLOGY AND COMPARTMENTAL MODELING

A. Mathematical modeling
A model is an entity that resembles a system or object in
certain aspects, but is easier to work with as compared to the
original system. Models are used for the 1) identification and
better understanding of systems, 2) simulation of a system’s
behavior, 3) prediction of its future behavior, and ultimately
4) system control. Apparently, from item 1 to 4, the problem
becomes more difficult and although the ultimate objective is
to harness or control a system, this objective is not necessarily
achievable. While modeling is the first and most important step
in this path, it is highly challenging and nontrivial. The various
issues that one faces in this regard, include:
•

•

•

Models are not unique and different models can co-exist for
a single system.
A model is only a slice of reality and all models have a
scope, outside of which, they are invalid.
Modeling can be done in different levels of abstraction,
which corresponds to the level of simplification and the
specific aspects of the system that are considered by the
model.

Example 1. The response of global stock markets with numerous economic, political, industrial, social and psychological
factors, to a high impact news can in cases be modeled with
a second-order differential equation, with a step-like overdamped behavior that reaches its steady state after a while.
Or in medicine, the response of the human body— with more
that thirty-seven trillion cells— to medication can in many
cases be “resonably” modeled with a first order differential
equation.
While various types of models are used for biological
systems, we are commonly interested in mathematical models
[11], as they permit the prediction and possible control of biological systems. In choosing among different available models,
the widely accepted principle is the model parsimony, which
simply means that “a model should be as simple as possible
and as complex as necessary!”. The model parsimony, is also
an important factor for estimating the unknown model parameters using real data. A more accurate model with fewer number
of parameters is evidently preferred over a less accurate and
more complex model. But how should one select between
a more accurate complex model and a less accurate simpler
one? Measures such as the Akaike information criterion (AIC),
the Bayesian information criterion (BIC) and the minimum
description length (MDL), address the balance between the
number of observations and the model unknown parameters
to select between competing models with variable number of
parameters and different levels of accuracy [12], [13]. Finally,
the physical interpretability of the model parameters and the
ability to estimate the parameters such that the model matches
real-world data, is what makes the whole modeling framework
meaningful.

2

B. From stochastic infection propagation models to ordinary
differential (difference) equation modeling
The outbreak of a contagious disease in a large population
is a stochastic event. Starting from a single infected individual,
the infection is transmitted to others in a stochastic manner,
either by direct contact, proximity, or environmental traces (infected objects left over in the environment). The new infected
generation in turns transmits the infection (again probabilistically) to the healthy individuals that they meet or encounter.
During the primary stages of an epidemic outbreak, healthyinfected individual encounters are statistically independent. As
a result, the chance of multiple infected people meeting a
single healthy individual is probabilistically low. Therefore,
assuming that each infected individual contaminates R0 new
people on average (known as the reproduction number, more
rigorously defined in Section II-E), if R0 > 1 the disease
spreads exponentially from one time step to another (for
example on a daily basis). However, in a finite population,
the exponential growth can not continue for ever. Depending
on the population size and contact patterns, the probability
of infected people encountering independent healthy individuals decreases. Therefore, after the initial outbreak that
exponentially spreads among the population, the infected
population tend to encounter each other and repeated healthy
ones (the healthy individuals already contacted by another
infected person). Hence, the stochastic model of infection
propagation, somehow saturates2 . The probabilistic models
used for modeling such epidemic spread are commonly based
on the branching process and a Poisson distributions for the
probability of contact between infectious and healthy subjects.
The stochastic perspective to epidemic modeling has been
extensively studied in the literature [2], [14]–[16]. Herein, we
adopt a more heuristic approach for model formation, which
is less rigorous, but is equally accurate in large populations
(refer to the above references for the justification).
Suppose that x(t) denotes the number of infected individuals of a population at time t. Next, assuming that the
chance of infection increases with the number of infected
individuals, we assume that the variations in the population
of the number of infected between time t and t + ∆ (over
relatively small intervals ∆) is proportional to the number of
infected individuals, i.e.,
dx(t)
x(t + ∆) − x(t)
≈
= φ(t)x(t)
dt
∆

(1)

Let us name φ(t) the reproduction function, which models
how the infected population evolves over time. This function
accounts for the expectation of various probabilistic factors,
such as the rate of infection transmission, population density
and contact patterns. Note that although the x(t) on the right
hand side of (1) could have been unified in φ(t), the above
form has the advantages that φ(t) can be interpreted as the
exponential rate, with inverse time units.
2 Another interpretation is that after a while, it becomes more and more
difficult for the average infected person to meet R0 non-infected individuals,
and therefore the reproduction number drops and the number of new infections
decreases exponentially.

DRAFT VERSION, SUBJECT TO MODIFICATION. FOLLOW THE UPDATES FROM: https://arxiv.org/abs/2003.11371

∆

Denoting the kth generation of the infection spread by xk =
x(k∆), (1) can be discretized as follows:
xk+1 = [1 + ∆φ(k∆)]xk
∆

Now, defining the reproduction number rk = [1 + ∆φ(k∆)],
it is evident that the population at the discretized time index
k can be recursively found from the initial condition x0 :
xk = (rk−1 rk−2 · · · r0 )x0

(2)

Apparently, if for all k, rk < 1 (or equivalently φ(t) < 0),
the infection would decay to zero; otherwise if rk > 1 (or
φ(t) > 0) it spreads. In the simplest case, for which the
reproduction function is a constant φ(t) = λ, we have a
constant reproduction number R0 = 1 + λ∆, resulting in an
exponential growth/decay:
xk = x0 Rk0 ,

(3)

or in the continuous case:
x(t) = x(0)eλt

(4)

The equivalence of the discrete and continuous solutions is
evident up to the first order approximation of the derivative,
as assumed in (1).
More generally, the reproduction function φ(t) (or rk in
the discrete case) can be a time-varying function of factors
such as the total susceptible population, the population of
the exposed individuals (carriers of the disease but without
symptoms), contact patterns, and countermeasures such as
social distancing and lockdowns. As shown in the sequel,
the notion of reproduction function (number) and its impact
on epidemic outbreak generalizes to eigen-analysis of vectorvalued dynamic epidemic models (when the population is
divided into multiple groups of individuals known compartments), enabling the stability analysis of such models.
As a reminder for later use, when λ < 0, the exponential
law in (4) implies that the population of the infected cases
drops 63%, 86%, 95%, 98%, 99%, and 99.75% from its initial
value, after λ−1 , 2λ−1 , 3λ−1 , 4λ−1 , 5λ−1 , and 6λ−1 time
units, respectively. The latter indicates for example that after
6λ−1 time units, only 25 cases out of 10,000 would still be
infected. This property is later used to estimate the model
parameters from clinical experimental results. It is good to note
that although the exponential law for infection spread is the
most common assumption, depending on the application, more
accurate non-exponential models have also been considered
[17].
C. Compartmental modeling
Differential (difference) equations arise in many modeling
problems. The major application of these equations is when
the rate of change of a variable is related to other variables,
as it is so in most physical and biological systems. Many
powerful mathematical tools exist for the analysis and (numerical) solution of models based on differential equations.
Despite their vast applications, differential equations are difficult to conceive and interpret without visualization. In this
context, compartmental models are used as a visual means

3

of representing differential equations of dynamic systems. A
compartment is an abstract entity representing the quantity
of interest (volume, number, density, etc.). Depending on the
level of abstraction, each of the variables of interest (equivalent
to system states in dynamic systems) are represented by
a single compartment, conceptually represented by a box.
Each compartment is assumed to be internally homogeneous,
which implies that all entities assumed inside the compartment
are indistinguishable. For example, depending on the model
complexity selected for modeling a certain epidemic disease,
men and women at risk can be assumed to conform a single
compartment, or may alternatively be considered as different
compartments. A similar partitioning may be considered for
different age groups, ethnicities, countries, etc., at a cost of a
more complex (less parsimonious) model with additional states
and parameters to be identified. Apparently, the available realworld data may be insufficient for the parameter identification
of a more detailed (complex) model.
The compartments interact with one another through a set
of rate equations, visually represented by arrows between
the compartments. Therefore, compartmental models can be
converted to a set of first order linear or nonlinear equations
(and vice versa), by writing the net flow into a compartment.
Compartmental modeling is also known as mass transport
[18], or mass action [19], in other contexts. More technically, a
compartmental model is a weighted directed graph representation of a dynamic system. Each compartment corresponds
to a node of the graph and the linking arrows are the graph
edges. From this perspective, for an n compartment system,
the compartment variables can be considered as state variables
denoted in vector form as x(t) = [x1 (t), . . . , xn (t)]T . The
compartmental model provides a graphical representation of
the state-space model:
ẋ(t) = f (x(t), w(t); θ(t), t)
y(t) = g(x(t); θ(t), t) + v(t)

(5)

where f (·) is the state dynamics function corresponding to
the compartmental model graph (which can be possibly timevariant and nonlinear), w(t) = [w1 (t), . . . , wl (t)]T represents
deterministic or stochastic external system inputs, y(t) =
[y1 (t), . . . , ym (t)]T is the vector of observable model variables considered as outputs (the measurements), g(·) if the
function that maps the state variables to the observations
(measurements), v(t) = [v1 (t), . . . , vm (t)]T is the vector of
measurement inaccuracies, considered as additive noise and
θ(t) = [θ1 (t), . . . , θp (t)]T is a vector of model parameters
to be set or identified. Researchers familiar with estimation
theory, have already guessed that the state-space form of
(5), implies that one may eventually be able to estimate and
predict the compartment variables from noisy measurements,
using state-space estimation techniques, such as the Kalman
or extended Kalman filter [20].
With this background, the basic steps of compartmental
modeling are:
1) Identifying the quantities of interest as distinct compartments and selecting a variable for each quantity as a
function of time. These variables are the state variables
of the resulting state-space equations.

DRAFT VERSION, SUBJECT TO MODIFICATION. FOLLOW THE UPDATES FROM: https://arxiv.org/abs/2003.11371

γ

γx
u

4

x

z
α

ρ

s

β

αi

i

β

r

y
Fig. 2. The basic susceptible-infected-recovered (SIR) model
Fig. 1. A sample compartmental model corresponding to the set of dynamic
equations in (6)
•

2) Linking the compartments with arrows indicating the rate
of quantity flow from each compartment to another (visually denoted over the arrows connecting the compartments).
3) Writing the corresponding first-order (linear or nonlinear)
differential equations for each of the state variables of the
model. In writing the equations from the graph representation, the edge weights multiplied by the state variable
of their start node are added to (subtracted from) the rate
change equation of the end node (start node). External
inputs can be considered to be originated from an external
node with value 1.
4) Setting initial conditions and solving the system of equations (either analytically or numerically), which is in the
form of a first-order state-space model.
A compartmental model is linear (nonlinear), when its rate
flow factors are independent (dependent) of the state variables.
A compartmental model is time-invariant (time-variant), when
its rate flow factors are independent (dependent) of time. Compartmental models may be open or closed. In closed systems,
the quantities are only passed between the compartments,
while in open systems the quantities may flow into or out
of the whole system. In a closed compartmental model, the
sum of all the differential equations of the system is zero (for
all t).
Example 2. A three compartment model corresponding to the
following set of equations is shown in Fig. 1.
dx(t)
= u − γx(t)2 − αx(t)
dt
dy(t)
(6)
= αx(t) − βy(t)
dt
dz(t)
= γx(t)2 + βy(t) − ρz(t)
dt
which can be put in the matrix form of (5). Due to the statedependency of the rate flow between x and z, the model is
nonlinear. It is also an open system, since the sum of rate
changes is non-zero, i.e., there is net flow in and out of the
whole system (due to u and ρ).
D. Mathematical epidemiology
In order to model the propagation of epidemic diseases in a
population, certain disease- and population-specific assumptions are required. The most common assumptions in this
context include:
• The diseases are contagious and transfer via contact.
• A disease may or may not be fatal.

•

•

•

There may be births during the period of study, and the
birth may (or may not) be congenitally transferred from the
mother to the baby.
The disease can have an exposure period, during which the
contaminants carry and spread the disease, but do not have
visible symptoms.
Catching the disease may or may not result in short-term or
long-term immunity. Depending on the case, the recovered
patients can again become susceptible to the disease.
Interventions such as medication, vaccination, lockdown,
quarantine and social distancing can change the pattern of
propagation.

Let us consider an example, which is the basic model that we
later extend for the COVIC-19 virus propagation pattern.
1) The susceptible-infected-recovered model: A basic
model used for modeling epidemic diseases without lifetime
immunity is known as the susceptible-infected-recovered (SIR)
model [2], [21], [22]. In this model, the total population of
N individuals exposed to an epidemic disease at each time
instant t is divided into three groups (each represented by a
compartment): the susceptible group fraction denoted by s(t),
the infected group fraction denoted by i(t), and the recovered
group fraction denoted by r(t) (the compartment variables are
in fact the fraction of each group’s population divided by N ).
Accordingly, the system is closed and we have
s(t) + i(t) + r(t) = 1

(7)

A compartmental model for the propagation of the disease is
shown in Fig. 2. The compartmental representation of Fig. 2
is equivalent to the following set of differential equations:
ds(t)
= −αs(t)i(t) + γr(t)
dt
di(t)
= αs(t)i(t) − βi(t)
dt
dr(t)
= βi(t) − γr(t)
dt

(8)

Accordingly, moving from the susceptible group to the infected group takes place at a rate that is proportional to the
population of the infected and susceptible groups, with parameter α. At the same time, infected individuals are assumed
to recover at a constant rate of β. Finally, considering that
the disease is not assumed to result in lifetime immunity
of the subjects, the recovered individuals again return to the
susceptible group at a fixed rate of γ. From (8), it is evident
that
ds(t) di(t) dr(t)
+
+
=0
(9)
dt
dt
dt

DRAFT VERSION, SUBJECT TO MODIFICATION. FOLLOW THE UPDATES FROM: https://arxiv.org/abs/2003.11371

has only two fixed-points:

Population Ratio

1
S(t)
I(t)
R(t)

0.8

(s∗ (t), i∗ (t), r∗ (t)) = (1, 0, 0)
β
β
(s∗ (t), i∗ (t), r∗ (t)) = ( , I0 , I0 )
α
γ

(10)

0.6

γ(α − β)
. The first fixed-point corresponds to the
α(γ + β)
lack of any infected cases, and the second corresponds to a
persistent disease in the population, as illustrated in Fig. 3(b).
This situation is only reachable if β < α, i.e., when the
infection rate is greater than the recovery rate.
We can also verify whether or not the fixed-points are
stable. Various methods can be used for this purpose. Perhaps,
the most tangible approach is based on perturbation theory.
Simply stated, one can add small perturbations to the fixedpoints of the system and check whether or not the perturbations
are compensated by the system’s dynamics by pushing the
state vector back to its fixed-point. Accordingly, the first fixedpoint in (10) can be perturbed to:
∆

where I0 =

0.4
0.2
0
0

50

100

150

days
(a) Basic SIR with immunity
1

Population Ratio

5

S(t)
I(t)
R(t)

0.8
0.6

(s(t), i(t), r(t)) = (1 − ǫ, ǫ, 0)

0.4
0.2
0
0

50

100

150

days
(b) Basic SIR without immunity
Fig. 3. Simulation of a basic non-fatal SIR model with α=0.5 and β=0.05
in two cases: a) γ=0.0 (lifetime immunity) and b) γ=0.04

which is in accordance with (7) and the fact that the system
is assumed to be closed (no births or deaths have been
considered).
Assuming initial conditions for each group, the set of
nonlinear equations (8) can be (numerically) solved to find the
evolution of the population of each compartment over time.
The numerical solution of a basic (non-fatal) SIR model is
shown in Fig. 3, with and without lifetime immunity. The timestep for numerical discretizing of the differential equations of
this simulation has been chosen to be ∆=0.1 of a day. Notice
how the outbreak of a disease that does not cause lifetime
immunity (such as a typical flu), can result in a constant
rate of illness throughout time, after its transient period. For
widespread epidemic diseases, the healthcare strategists are interested in the slopes of s(t), i(t) and r(t), rather than the total
number of infected individuals (as it is currently the case for
the COVID-19 coronavirus). The prolongation of the disease
spread provides the better management of healthcare resources
such as hospitalization, medication, healthcare personnel, etc.
For later reference, it is interesting to study the fixed-point
of the SIR model (where ṡ(t) = i̇(t) = ṙ(t) = 0). Equating
the left sides of (8) with zero, it can be algebraically shown
that if α, γ 6= 0 (the non-immunizing case), the SIR model

(11)

where 0 < ǫ ≪ 1 is a small perturbation (e.g., equivalent to
a single case of disease outbreak in a large population). Now
replacing the perturbed point in (8) and neglecting second and
higher order terms containing ǫ, we obtain:
ds(t)
= −α(1 − ǫ)ǫ ≈ −αǫ < 0
dt
di(t)
= α(1 − ǫ)ǫ − βǫ ≈ (α − β)ǫ
dt
dr(t)
= βǫ > 0
dt

(12)

As a result, the first fixed-point is unstable, since due to the
sign of the derivatives of the perturbed system, the system’s
dynamics drives the state vector away from the fixed-point
(since the population of the susceptible group has a negative
derivative). However, depending on whether α > β or not, the
outbreak may or may not result in an increase in the infected
population. Simply put, if the infection rate is greater than
the recovery rate (α > β) the disease would lead into an
outspread; but if the recovery rate is faster than the infection
rate (α < β) the percentage of the infected population
will remain close to zero. In either case, for a non-fatal
non-immunizing disease, all individuals that become infected
recover after a while and move to the recovered group and
again go back to the susceptible group at a rate of γ. Note
that a SIR model with a non-zero infected population fraction
in steady-state, indicates that there is a constant flow between
the compartments, i.e., people are constantly contaminated,
recovered and again become susceptible to the disease.
Perturbing the second fixed-point results in
ds(t)
β
= −α( − ǫ)(I0 + ǫ) + βI0 ≈ ǫ(αI0 − β)
dt
α
β
di(t)
= α( − ǫ)(I0 + ǫ) − βI0 ≈ −ǫ(αI0 − β)
dt
α
dr(t)
= β(I0 + ǫ) − β(I0 + ǫ) = 0
dt

(13)

DRAFT VERSION, SUBJECT TO MODIFICATION. FOLLOW THE UPDATES FROM: https://arxiv.org/abs/2003.11371

The Jacobian of F (·) and V(·) are next calculated at the no
infection fixed-point x∗ = [0, 0, . . . , 0, x∗p+1 , . . . , x∗n ]T :




F 0
V 0
∇x F (x∗ ) =
(18)
, ∇x V(x∗ ) =
0 0
J3 J4

γ

µ∗
αi

s
µs

β

i
µi

r
µr

Fig. 4. The susceptible-infected-recovered (SIR) model with birth and death
rates

In this case, depending on whether (αI0 − β) > 0 or not, the
fixed-point may be stable or unstable.
For later use, we can show that during the outbreak of the
SIR model (s(t) ≈ 1), the number of infected cases follows
an exponential pattern:
i(t) ≈ i(0) exp[(α − β)t]

(14)

2) The fatal SIR model: A fatal version of the SIR model
with rates of birth µ∗ and with different death rates from the
susceptible (µs ), infected (µi ) and recovered (µr ) groups is
shown in Fig. 4. This system is no longer closed and its state
equations can be written as follows:
ds(t)
= γr(t) − αs(t)i(t) − µs s(t) + µ∗
dt
di(t)
= αs(t)i(t) − βi(t) − µi i(t)
dt
dr(t)
= βi(t) − γr(t) − µr r(t)
dt

(15)

E. The basic reproduction number (R0)
As noted before, the outbreak threshold of epidemiology
models is known as the basic reproduction number R0 . It is
defined as the average number of secondary infections due
to an infected individual hosted by a completely susceptible
population [23]–[25], [1, Ch. 7]. The R0 during epidemic
outbreak is generally greater than the average infections (R)
at any other time other than the outbreak.
From the mathematical modeling perspective, a formal
definition of R0 was first presented in [26]. Consider the
general dynamic representation of a compartmental model:
ẋ(t) = f (x(t))

(16)
T

where x(t) = [x1 (t), x2 (t), . . . , xp (t), xp+1 (t), . . . , xn (t)]
is the state vector (compartment variables), such that
x1 (t), . . . , xp (t) correspond to the infected compartments (exposed, infected, etc.), and xp+1 (t), . . . , xn (t) are all the other
variables (susceptibles, recovered, passed-away, etc.). We next
partition each row of f (·) as follows:
f (x(t)) = F (x(t)) + V(x(t))

6

(17)

where F (·) groups all the terms of f (x(t)), which correspond
to new infections (the portion of the population, which are
either susceptible or had fully recovered, but are becoming
exposed or infected due to contact with the exposed or
infected). On the other hand, V(·) groups all the other terms
of the equations, including removals from the infected groups
and other compartmental transitions.

Finally, the reproduction number is defined as the spectral
radius (leading eigenvalue) of the negative of the so-called
next generation matrix (NGM) FV−1 :
R0 = ρ(−FV−1 )

(19)

which is proved to have the biological properties of the
reproduction number for epidemic studies.
In fact, while the threshold between stability and instability
of an epidemic can be defined in various forms, only the
definition based on R0 is biologically popular [25]. In [26],
it is also shown how different partitionings of the state-space
model can lead to different spectral radii; however, only the
choice described in (17) leads to the biologically meaningful
definition of R0 .
Example 3. In the SIR model (8), if we replace r(t) = 1 −
s(t) − i(t) from (7), the model reduces to:
di(t)
= αs(t)i(t) − βi(t)
dt
ds(t)
= −αs(t)i(t) + γ[1 − s(t) − i(t)]
dt

(20)

Therefore,




αs(t)i(t)
−βi(t)
F=
, V=
0
−αs(t)i(t) + γ[1 − s(t) − i(t)]
(21)
and at the fixed-point x = (0, 1)


αs(t) αi(t)
∇x F (x∗ ) =
0
0 i(t)=0,s(t)=1


−β
0
∇x V(x∗ ) =
−αs(t) − γ −αi(t) − γ i(t)=0,s(t)=1
(22)
which results in the reproduction number:
α
(23)
R0 = ρ(−FV−1 ) =
β
where we can see that the epidemic stability condition R0 < 1
is identical to the stability condition α < β, found for the SIR
model in Section II-D1.
Comparing (23) and (14) we notice that although the
epidemic stability condition found from R0 is related to the
outbreak exponent (slope of infection during outbreak), but
they are not the same quantities.
In fact, a major drawback of the conventional definition
of R0 using the NGM is that the discretization time (or
generation period) is discarded in its definition and therefore,
there is no direct analogy between the discrete-time and
continuous-time outbreak behavior of the epidemic. Motivated
by this fact and based on the analogy between the discretetime and continuous-time models presented in Section II-B,
we hereby propose an alternative definition of the reproduction
number:

DRAFT VERSION, SUBJECT TO MODIFICATION. FOLLOW THE UPDATES FROM: https://arxiv.org/abs/2003.11371

Proposition: An alternative definition of the reproduction number is
R̃0 = eλ1 ∆

(24)

where λ1 is the real-part of the dominant eigenvalue
of the dynamic model’s Jacobian evaluated at the
fixed-point of interest, and ∆ is the generation time
unit (or discretization period). Accordingly, for an
irreducible dynamic model, R̃0 < 1 (or λ1 < 0)
and R̃0 > 1 (or λ1 > 0) correspond to stable and
unstable epidemic conditions, respectively.
It is clear that for small generation time units ∆ (small as
compared with the compartmental model “rate of variations”
in time), we have:
R̃0 ≈ 1 + λ1 ∆
(25)
The major advantage of the above definition for the reproduction number is that the time unit between generations appears
in the definition. Therefore, the R̃0 of different epidemics that
have been experimentally obtained from real-world data acquired with different generation time units become comparable
with one another. Moreover, our studies on various epidemic
models shows that the stability condition λ1 < 0 (or R̃0 < 1)
is exactly equivalent to the R0 < 1 condition obtained from
the common definition of the basic reproduction number using
the NGM. The mathematical proof of equivalence of the two
conditions remains as future work.
III. P ROPOSED E PIDEMIC M ODEL I
Many infectious diseases are characterized by an incubation period between exposure and the outbreak of clinical
symptoms. Subjects exposed to the infection are much more
dangerous for the public as compared to the subjects showing
clinical symptoms. The condition becomes more and more
dangerous, with the increase of the isncubation rate. A wellknown case is the HIV virus in its clinical latency stage.
The experience of the COVID-19 shows that a two-week
incubation period can spread a virus worldwide and almost
at any level of the society. Remember that any two of us
are only six handshakes apart!3 For this reason, an additional
compartment is added between the susceptibility and infection
stages of the SIR model, which accounts for the asymptomatic
exposed subjects. Moreover, since we are also interested in
minimizing the mortality rate of the disease, a termination
compartment is dedicated to the passed-away population. The
variables of the model are therefore:
1) s(t): The susceptible population fraction (the number of
individuals in danger of being infected, divided by the total
population).
2) e(t): The exposed population fraction (the number of individuals exposed to the virus but without having symptoms,
divided by the total population).
3) i(t): The infected population fraction (the number of
infected individuals with symptoms, divided by the total
population).
3 Cf.

https://en.wikipedia.org/wiki/Six degrees of separation

7

γ

s

ρ

αe e + αi i
e

κ

i

β

r

µ
p
Fig. 5. Proposed Model I: the fatal susceptible-exposed-infected-recovered
(SEIR) model for coronavirus modeling with a unique recovery group

4) r(t): The recovered population fraction (the number of
recovered individuals, divided by the total population).
5) p(t): The number of individuals that pass away due to the
disease, divided by the total population).
Keeping in mind that
s(t) + e(t) + i(t) + r(t) + p(t) = 1

(26)

the proposed model and its compartmental representation are
shown in equations (27) and Fig. 5.
Model I:
ds(t)
= −αe s(t)e(t) − αi s(t)i(t) + γr(t)
dt
de(t)
= αe s(t)e(t) + αi s(t)i(t) − κe(t) − ρe(t)
dt
di(t)
= κe(t) − βi(t) − µi(t)
dt
dr(t)
= βi(t) + ρe(t) − γr(t)
dt
dp(t)
= µi(t)
dt

(27)

In (27), similar to the classical SIR model, the interpretation
of the nonlinear terms including s(t)e(t) and s(t)i(t) is that
the rate of exposure to the virus is proportional the population
of both the susceptible and exposed/infected subjects.
Note that the system closure constraint (26) gives an excess
degree of freedom, which can be used to reduce the model
order by replacing s(t) = 1 − e(t) − i(t) − r(t) − p(t). This
simplifies the compartmental model as follows:
de(t)
= [1 − e(t) − i(t) − r(t) − p(t)][αe e(t) + αi i(t)]
dt
− κe(t) − ρe(t)
di(t)
= κe(t) − βi(t) − µi(t)
dt
dr(t)
= βi(t) + ρe(t) − γr(t)
dt
dp(t)
= µi(t)
dt
(28)

A. Measurements model
Among the state variables of the proposed model, all
except e(t) are directly measurable (with potential errors). The

DRAFT VERSION, SUBJECT TO MODIFICATION. FOLLOW THE UPDATES FROM: https://arxiv.org/abs/2003.11371

measurements can be formulated in matrix form as follows:


 



e(t)

I(t)
vi (t)
0 1 0 0  i(t)




 
(29)
 + vr (t)
R(t) =  0 0 1 0  


r(t)
0 0 0 1
P (t)
vp (t)
p(t)
where I(t) is the fraction of reported infections, R(t) is
the fraction of reported recoveries (both symptomatic and
asymptomatic), P (t) is the fraction of reported death tolls,
and v(t) = [vi (t), vr (t), vp (t)]T is measurement noise. The
evident sources of measurement noises include: unavailable
information regrading the exact population, intentional and
unintentional misreported values, mis-classified reasons of
death (especially for the elderly or subjects suffering from
multiple health issues), and the marginal cases that may be
unknown or misclassified for the healthcare system. Equation
(29) can be written in more compact form as follows:
y(t) = Cx(t) + v(t)

(30)

where x(t) = [e(t), i(t), r(t), p(t)]T is the reduced statevector. Although the variable e(t) is not directly measurable
from the available public data, we will show in Section V
that under certain conditions, e(t) can be estimated from the
measurements.
Note that in the above measurement model, it is assumed
that R(t) is the total recovery fraction of both the symptomatic
and asymptomatic cases, assuming that the asymptomatic recoveries are measurable by (random or systematic) public tests
over the population, such as the antibody tests that have been
conducted by some nations during the COVID-19 outbreak.
In Section IV, the model is modified to a more practical case,
in which only the recoveries due to the symptomatic cases are
measured.
B. Model assumptions and level of abstraction
The simplifying assumptions behind the proposed model
are:
1) The model variables are assumed to be continuous in both
amplitude and time.
2) Birth and natural deaths have been neglected. Therefore,
other parameters leading to changes in the population are
not considered. Neglecting the birth rate is also supported
by the current findings that babies are not susceptible to
this virus and to the best of our knowledge, no congenital
transmissions of the virus from mothers to fetuses have
been reported.
3) In the current study, we do not distinguish between male
and female subjects; although the current global toll of the
virus suggests that men have been more vulnerable to the
virus than women.
4) Age ranges have not been considered; although we known
that higher aged subjects are more vulnerable to the virus
and countries have different population pyramids.
5) Moreover, in this primary version, we have not yet considered the possibility of vaccination.

8

6) Geopolitical factors such as distance, country borders and
continental differences have also been ignored. But considering that different countries have adopted customized
countermeasures against the virus spread, the model parameters are fitted over country-level data.
C. Model parameters
Having formed the model, we now explain its parameters
and their relationship with real-world factors and clinical
protocols. The techniques for estimating and fitting these
parameters on real data is later detailed in Section VI.
Note that all the model parameters have the dimension of
inverse time, to balance the left and right side dimensions
of (27), and that the studied model is essentially based on
an exponential law assumption, as detailed in Section II-B.
Therefore, we can find rules of thumb for selecting the model
parameters based on clinical facts and protocols.
• κ: The rate at which symptoms appear in exposed cases,
resulting in transition from the exposed to the infected
population. The selection of this parameter is according to
the exponential law detailed in Section II-B. Assume that we
are dealing with an extremely contagious disease for which
the healthcare decision makers have agreed on the above
noted 99.75% percentage as the target infection drop-out
threshold, and advised 14 days of quarantine for the whole
population. In that case, we can select κ = 6/14 = 0.43
(inverse days) in our model. Apparently, there is a lot of
simplifications in this discussion; the age range, the subjectspecific body immune system features, the severeness of
the virus and many more factors have been neglected. But
it gives an idea about how the parameters can be tuned
in practice, up to a reasonable order of magnitude. With
this background, we now explain the interpretation of each
parameter of the model.
We should add that wide screening policies adopted by
certain countries are external factors that can significantly
accelerate the identification of the infected cases. In this
case, screening is a factor that increases κ.
• αi : The contagion factor between the infected and susceptible populations, which is related to the contagiousness of the
virus and social factors such as personal hygiene, population
density and level of human interactions. In order to find the
range (or order of magnitude) of this parameter, we can start
with the contagion factors of more known viruses, such as
flu and influenza, which are more or less influenced by the
same spreading factors.
• αe : The contagion factor between the exposed and susceptible populations. This parameter is logically far greater than
αi , since in ordinary conditions (before lockdowns and quarantine), people rarely avoid contact with an asymptomatic
individual; nor does the individual itself avoid interaction
with others.
• γ: The reinfection rate, or the rate of returning from the
recovered group to the susceptible group. This happens for
the cases that the body does not develop lifetime immunity
after recovery, or the virus itself starts to mutate over
time. This parameter is the inverse of the immunity rate

DRAFT VERSION, SUBJECT TO MODIFICATION. FOLLOW THE UPDATES FROM: https://arxiv.org/abs/2003.11371

of the virus. It is currently too early to comment about
the immunity characteristics of the COVID-19 coronavirus4.
Although at least one case of reinfection soon after recovery
has been reported, preliminary research have suggested
short-term immunity of up to four months.
• β: The recovery rate of the infected cases. By considering
the fourth equation in (27), we can denote the change in
the number of hospitalized recoveries (or under control
in any form, e.g., under home-care) by rh , resulting in
rh (t + ∆) − rh (t) ≈ ∆βi(t), where ∆ is the time unit of
approximation (for example 1 day). Therefore, the parameter
β can be approximated by dividing the daily recovery count
of the population under study, by the total infected cases
in the same day. In the real world, apart from the body
strength of the infected subject in resisting against the virus,
this parameter depends on the healthcare infrastructure of a
country (hospitalization facilities, availability of medication,
number of intensive care units, etc.).
• ρ: The recovery rate of the exposed cases (the cases that
are exposed, but recover without any symptoms). This
parameter is not directly measurable from pure observations
and requires lab-based experiments. However, we logically
expect this parameter to be of the same order or greater than
the parameter β (the recovery rate of the infected population
with symptoms).
• µ: The mortality rate of the infected cases. By approximating the last equation in (27) by p(t + ∆) − p(t) ≈ ∆µi(t),
where ∆ is the time unit of approximation (for example
1 day), the parameter µ can be approximated by dividing
the daily death toll by the total infected cases in the same
day. As with β, the mortality of the virus itself, the immune
system of the subjects, and the medical infrastructure are
important factors that influence the parameter.
• e0 : The initial exposed population (seed).
By studying the above factors, we can see that the only
parameters of the model that can be changed in the shortterm (before the development of long-term solutions such
as vaccination, medication, improvement of hospitalization
facilities, etc.), is to reduce the infection rates by minimizing
human contacts (social distancing), or to apply public screening. These are the two policies, which have been adopted
worldwide.
D. Fixed-point analysis
As with the basic SIR model presented in Example II-D1,
the fixed-point(s) of the model can be sought by letting the left
hand sides of all equations in (27) equal to zero. Accordingly,
assuming that all the model parameters are nonzero, the only
fixed-point is the no-disease case (i(t) = e(t) = r(t) = 0):

9

fixed-point with a minor exposure ǫ (which can correspond to
a single new exposed case in the real world):
(s(t), e(t), i(t), r(t), p(t)) = (1 − p0 − ǫ, ǫ, 0, 0, p0)

(32)

Putting this point in the state dynamics (27), we find:
ds(t)
dt
de(t)
dt
di(t)
dt
dr(t)
dt
dp(t)
dt

= −αe (1 − p0 − ǫ)ǫ ≈ −αe (1 − p0 )ǫ < 0
= αe (1 − p0 − ǫ)ǫ − κǫ − ρǫ ≈ (αe − αe p0 − κ − ρ)ǫ
= κǫ > 0
= ρǫ > 0
=0

(33)
which is unstable, i.e., the system’s dynamics drives it away
from the fixed-point in the direction of reducing the healthy
cases, resulting in further infection. A more rigorous study of
the system stability conditions is presented in the following
sections using eigenanalysis.

E. Model analysis during outbreak
Let us study the model during the initial outbreak of the
epidemic, when the infection toll is still much smaller than
the total population. For instance, suppose that a country
has 100,000 of exposed or infected cases, which is indeed
significant for any country, as it is far beyond the available
number of intensive care unit beds of even the most developed
countries5 . But for a 100 million population country, such an
exposure/infection toll is only 0.1% of the total population.
Therefore, during the primary phases of the disease spread,
the model can be simplified by assuming that the susceptible
population is almost constant (s(t) ≈ 1) and ds(t)/dt ≈ 0, regardless of the other parameters of the model. This assumption
practically implies that the total population is not important
during an epidemic outbreak (in low percentages of infection),
resulting in
Result 1. In low percentages of infection, the performance of epidemic control policies of states,
countries, and regions should not be evaluated by
normalizing the infection/recovery/death tolls to their
total population; but rather the net values should be
compared.

where 0 ≤ p0 ≤ 1 is the steady-state total death fraction. The
stability of this fixed-point can be addressed by perturbing the

This result has also been approved in previous research
based on model fitting on data from several epidemic diseases,
showing that the disease spread is considerably independent
of the total population size [23].

4 Refer to:
https://www.who.int/docs/default-source/coronaviruse/
who-china-joint-mission-on-covid-19-final-report.pdf

5 See for example:
https://link.springer.com/article/10.1007/s00134-012-2627-8/tables/2

(s∗ (t), e∗ (t), i∗ (t), r∗ (t), p∗ (t)) = (1 − p0 , 0, 0, 0, p0) (31)

DRAFT VERSION, SUBJECT TO MODIFICATION. FOLLOW THE UPDATES FROM: https://arxiv.org/abs/2003.11371

Under this assumption, (27) is simplified to the linear set
of equations:


de(t)
 dt  
  e(t)


αe − κ − ρ
αi
0 0
 di(t) 
 i(t)


κ
−β − µ 0 0 

 dt  


≈


ρ
β
−γ 0   r(t)
 dr(t)  


0
µ
0 0
 dt 
p(t)


dp(t)
dt
(34)
Defining x(t) = [e(t), i(t), r(t), p(t)]T , (34) can be written in
matrix form:
d
x(t) = Ax(t)
(35)
dt
where A is the 4×4 state matrix on the right hand side of (34).
Equation (35) can be solved for an arbitrary initial condition,
such as x(0) = (e0 , 0, 0, 0). The characteristic function of this
linear system is:
|λI − A| = λ(λ + γ)[λ2 + (β + µ − δ)λ − δ(β + µ) − καi ] = 0
(36)
∆
where δ = (αe − κ − ρ). Therefore the system’s eigenvalues
are:
p
δ − β − µ + (δ + β + µ)2 + 4καi
λ1 =
p 2
(37)
δ − β − µ − (δ + β + µ)2 + 4καi
λ2 =
2
λ3 = 0, λ4 = −γ
which are all real-valued. Moreover, it is straightforward to
check that λ1 > δ > λ2 . The eigenvectors corresponding to
each eigenvalue are:
λ1 − δ ραi + β(λ1 − δ) µ(λ1 − δ) T
,
]
,
αi
αi (λ1 + γ)
αi λ1
λ2 − δ ραi + β(λ2 − δ) µ(λ2 − δ) T
v2 = k2 [1,
,
]
,
αi
αi (λ2 + γ)
αi λ2
v3 = [0, 0, 0, k3 ]T , v4 = [0, 0, k4 , 0]T

v1 = k1 [1,

(38)

where k1 , k2 , k3 and k4 are arbitrary constants. The general
form of the solution of the compartmental variables is a
summation of exponential terms with the above exponential
rates and eivenvectors:
x(t) =

4
X

ak eλk t vk

(39)

k=1

Specifically, after some algebraic simplifications, we can calculate the infected and exposed populations as follows:
e0 (λ1 − δ)(δ − λ2 )
[exp (λ1 t) − exp (λ2 t)]
αi (λ1 − λ2 )
e0
[(λ1 − δ) exp (λ2 t) + (δ − λ2 ) exp (λ1 t)]
e(t) =
λ1 − λ2
(40)
From the last equation in (27), it is clear that the death toll
will not stop before i(t) = 0. Also from (40), we can see that
since λ1 is the dominant eigenvalue, the steady-state behavior
and whether or not i(t) and e(t) diverge from or converge to
zero, depends on the sign of λ1 . The necessary and sufficient
condition for the linearized system’s stability (stopping the
i(t) =

10

death doll) is λ1 < 0, which simplifies to καi + δ(β + µ) < 0,
or:
(41)
καi < (κ + ρ − αe )(β + µ)
A sufficient condition that guarantees this property is when
αi = αe = 0. The condition αi = 0 implies that the
susceptible group avoids contact with the infected ones. However, the second condition (αe = 0) is difficult to fulfill
in the real-world, since the exposed group do not have any
symptoms. This is why social distancing is required to enforce
αe ≈ 0 and to permit all the exposed subjects to move to the
infected group without infecting new individuals, after which
the asymptomatic group can be all considered clear of the
disease. Another practical case is when αi ≈ 0 (healthy people
avoid contact with the infected) and κ + ρ > αe (the rate of
recovery of the exposed or the appearance of their symptoms
is faster than the rate of new exposures). This condition is
fulfilled by social distancing and lockdown (isolation of even
the asymptomatic cases for a certain period).
However, if none of the above conditions are fulfilled and
λ1 > 0, the number of exposed and infected cases increases
exponentially at a rate of λ1 . In this case, with fixed system
parameters, the infection rate rises exponentially up to a point
at which the linear approximation does no longer hold. This
practically translates into:
Result 2. During an exponential outbreak of an
epidemic (λ1 > 0), the system is unstable and without enforcing temporary lockdowns, social distancing
and quarantine of the infected cases (resulting in the
model parameter changes), the exponential increase
in the number of infected subjects continues to a
point where a significant percentage of the population is infected.
Using the method detailed in Section II-E, we can further
show that for the epidemic model (27), the reproduction
number (spectral radius of the NGM) is equal to:
R0 =

αe (β + µ) + καi
(κ + ρ)(β + µ)

(42)

Apparently, R0 < 1 exactly simplifies to the stability condition
in (41), when λ1 < 0.
Result 3. Under countermeasures, the model eigenvalues change and λ1 (the dominant eigenvalue of the
linearized dynamic model) is the single parameter
that can be tracked as a score for evaluating how
good countermeasures such as social distancing and
quarantine are performing.
Considering that the death toll p(t) is composed of the same
exponential terms as the infected cases in (40), the above result
is indeed disturbing.
It is also interesting to observe from (40 ) that the population
of the different compartments of the model is only linearly
proportional to the initial exposed population size e0 6 . Therefore, for a large population (at the level of a populated city or
6 Note

that the COVID-19 is believed to have started from a single case.

DRAFT VERSION, SUBJECT TO MODIFICATION. FOLLOW THE UPDATES FROM: https://arxiv.org/abs/2003.11371

country), the initial infected seed size is not as important as the
other model parameters that influence the exponential behavior
of the model (such as the social contact rates). Therefore:
Result 4. The initial seed size is not the most critical
parameter for epidemic management. Regions with
smaller initial seeds of infected/exposed cases may
end up with a higher infected and death toll depending on their infection rates, defined by factors such
as human-contact rate and personal hygiene.

(43)

∆

∆

where λ̃1 = λ1 − δ and λ̃2 = δ − λ2 are both positive.
Therefore, when the terms containing exp(−λ̃2 t), which is
a decaying exponential, vanish and the epidemic model is still
in its linear phase (i(t) ≪ s(t) or s(t) ≈ 1), the ratio can be
approximated by:
i(t)
λ̃1
→
e(t)
αi

for t ≫ λ̃−1
2 and i(t) ≪ s(t)

where three pandemic waves of infection have been observed
within an interval of a few months8. A mathematical study
of sustained oscillations of similar compartmental models has
been studied in previous research [22], [28].

IV. P ROPOSED E PIDEMIC M ODEL II

Another interesting property is to check the ratio between
the number of infected (which is measurable in the real world)
and the number of exposed (which is not directly measurable).
From (40), we can find7 :
i(t)
exp(λ̃1 t) − exp(−λ̃2 t)
=
−1
e(t)
αi [λ̃1 exp(λ̃1 t) + λ̃−1
2 exp(−λ̃2 t)]

11

The proposed model can be extended from various aspects.
One such extension is to separate the recoveries from exposure from the recoveries from infection. The advantage of
this separation is that in practice, the subjects that recover
without any symptoms may only be identified by broad public
screening, which is not very practical for a large population.
While the infected individuals that recover are already known
for the healthcare system and are easy to monitor. Based on
this idea, the proposed extension of the model is as shown
in Fig. 6. Accordingly, the variables i(t), p(t) and ri (t)
(the recoveries from infection) are the variables that can be
observed and reported by the healthcare units. The dynamic
system corresponding to this model is:

(44)

which gives the following practical result:
Result 5. During the primary phases of an epidemic
outbreak (when the number of contaminated cases
has an exponential growth, but the percentage of
the infected individuals to the total population is
still small), the number of exposed subjects can be
approximated by e(t) ≈ αi λ̃−1
1 i(t), permitting its
estimation from i(t).
F. Repeated waves of epidemic
The peaks of the infected group population, and its potential
repetition in time, is important from the strategic viewpoint
[27]. These points correspond to local or global extremums of
i(t), which mathematically correspond to where di(t)/dt = 0
in (27), i.e., where i(t) = κe(t)/(β + µ). It can be shown
that this leads to a reduced order set of nonlinear dynamic
equations, which can be solved for the remaining variables
[s(t), e(t), r(t), p(t)]T . The simulations demonstrated in the
sequel, show that the infected population can have multiple
local peaks over time, with recurrent behaviors, proving that:
Result 6. The epidemic disease can repeat pseudoperiodically over time (in later seasons or years)
and turn into a persistent disease in the long term.
The amplitude and time gap of the infection peaks
depends on the model parameters.
This behavior has been observed in previous pandemics,
such as the 1918 pandemic influenza, known as the Spanish flu,
7 The numerator and denominator of (43) have been multiplied by exp(−δt)
to obtain the simplified form.

Model II:
ds(t)
= −αe s(t)e(t) − αi s(t)i(t) + γe re (t) + γi ri (t)
dt
de(t)
= αe s(t)e(t) + αi s(t)i(t) − κe(t) − ρe(t)
dt
di(t)
= κe(t) − βi(t) − µi(t)
dt
dre (t)
= ρe(t) − γe re (t)
dt
dri (t)
= βi(t) − γi ri (t)
dt
dp(t)
= µi(t)
dt
(45)
subject to s(t)+e(t)+i(t)+re (t)+ri (t)+p(t) = 1, which can
again be used to reduce the model order by omitting one of
the model variables (e.g., s(t)). In the latter case, we assume
that the observed variables are I(t), Ri (t) and P (t), resulting
in the following observation model:



I(t)





0 1


Ri (t) =  0 0
0 0
P (t)

0 0
0 1
0 0




e(t)
  i(t)  v (t)

i
0 

 
 + vr (t)
0 
r
(t)
 (46)
e



1 
vp (t)
 ri (t)
p(t)

which can be written in compact form, as in (30).
Similar to the first model, under the assumption of low
fraction of infection (during epidemic outbreak) and omitting

8 Cf.

https://en.wikipedia.org/wiki/Spanish flu

DRAFT VERSION, SUBJECT TO MODIFICATION. FOLLOW THE UPDATES FROM: https://arxiv.org/abs/2003.11371

γe

re
ρ

s

αe e + αi i

e

κ

µ

i

p

β
ri
γi

Fig. 6. Proposed Model II: an extension of the fatal SEIR model for
coronavirus modeling, with separate recovery groups from exposure and
infection

the variable s(t), (45) simplifies to:

de(t)
 dt 


 di(t)  
αe − κ − ρ


 dt  
κ
 

 dre (t)  
ρ
≈

 dt  
0


 dri (t) 
0


 dt 


dp(t)
dt


αi
0
−β − µ
0
0
−γe
β
0
µ
0

0
0
0
−γi
0

0
0
0
0
0




e(t)


  i(t)


 re (t)




 ri (t)
p(t)


(47)
Defining the state vector x(t) = [e(t), i(t), re (t), ri (t), p(t)]T ,
(47) can be written in a matrix form similar to (35), where
A is now the 5×5 state matrix on the right hand side of (47)
and solved for an arbitrary initial condition. The characteristic
function of this linear system is:
|λI−A| = λ(λ+γe )(λ+γi )[λ2 +(β+µ−δ)λ−δ(β+µ)−καi ]
(48)
∆
where as in the first model δ = (αe − κ − ρ), resulting in the
following eigenvalues:
p
δ − β − µ + (δ + β + µ)2 + 4καi
λ1 =
p 2
(49)
δ − β − µ − (δ + β + µ)2 + 4καi
λ2 =
2
λ3 = 0, λ4 = −γe , λ5 = −γi
In this case, the eigenvectors corresponding to each eigenvalue
are:

12

This requires the accurate estimation of the compartmental
model variables from reported statistics of the virus spread.
The trend estimation requirements are addressed in the sequel
for both the linearized and general form of both of the
proposed models. As noted before, these results can be used
to design an estimation scheme, based on for example a
Kalman filter, for estimation and prediction of the current
and future trends, in presence of inaccurate infection tolls.
Note that although the variable e(t) is not directly measurable
from the available public data, one may seek whether of
not this variable can be indirectly estimated from the other
measurements (assuming that the other model parameters are
known).
A. Observability during outbreak (low fraction of infection)
During the epidemic outbreak (in the low fraction of infection case), the linearized versions of Model I and Model II,
namely (34) and (47) hold, respectively. Using the notion of
observability from system theory [29], [30], for the model
matrix pair (A, C) the observability matrix is defined as
follows:


Ck
 Ck Ak 


(51)
Ok = 

..


.
Ck Akn−1

If O k has rank n (the number of state variables, in either of
the proposed models), all the state variables of the linearized
models (34) and (47) are observable at the outputs, which
means that they can be estimated from the observations in
finite time. It is straightforward to numerically calculate (51)
for arbitrary choices of the model parameters of Model I and
Model II, and to check that none of its columns are linearly
dependent9. Therefore, all the state variables, including e(t),
are observable and may be estimated using state estimation
techniques such as the Kalman filter (as the optimal linear
estimator).
B. Observability in the general case

AND CONTROL

In the general case, where the number of exposed/infected
cases exceeds several percents of the population, the variations
in s(t) is no longer negligible and one should refer to the
original nonlinear compartmental models (27) and (45). In
this case, the observability rank test (51) can be checked for
the matrix pair (A(t), C), where the matrix C is similar
to the linearized case in (29) and A(t) is the Jacobian
of the nonlinear model (28), with respect to the entries of
the reduced state-vector x(t) = [e(t), i(t), r(t), p(t)]T . The
entries of the Jacobian have been listed in Appendix A; some
of which are time-dependent. Due to the non-evident form of
the observability matrix of this case, the proof of observability
of the matrix pair (A(t), C) in its general case is cumbersome.
However, it is simple to check this property numerically for
arbitrary values of the model parameters. We have tested
this property for our later shown simulated results, as part

The ability to estimate the future trend of the epidemic
pattern is extremely important from the strategic perspective.

9 Matlab has a function called obsv for calculating the observability matrix,
from the matrix pair (A, C).

λ1 − δ
ρ
β(λ1 − δ) µ(λ1 − δ) T
v1 = k1 [1,
,
,
]
,
αi
λ1 + γe αi (λ1 + γi )
αi λ1
λ2 − δ
ρ
β(λ2 − δ) µ(λ2 − δ) T
v2 = k2 [1,
,
,
]
,
αi
λ2 + γe αi (λ2 + γi )
αi λ2
v3 = [0, 0, 0, 0, k3]T , v4 = [0, 0, k4 , 0, 0]T
v5 = [0, 0, 0, k5 , 0]T
(50)
where k1 , k2 , k3 , k4 and k5 are arbitrary constants. The
first three eigenvalues are identical to Model I. Therefore, the
outbreak properties such as exposure/infection rates, stability
conditions and reproduction number are exactly the same as
the first model, as derived in (40), (41), and (42).
V. E PIDEMIC TREND

ESTIMATION , MODEL OBSERVABILITY

DRAFT VERSION, SUBJECT TO MODIFICATION. FOLLOW THE UPDATES FROM: https://arxiv.org/abs/2003.11371

of the source codes provided online at [10]. Therefore, we
can state the following result in both the general and linear
approximated case:
Result 7. Although the number of exposed cases
of the population is not directly measurable, if the
model parameters are known (or accurately estimated), the number of exposed cases can also be
estimated from the other observations.
C. Epidemic control and model controllability
The proposed Models I and II, do not have external inputs.
Therefore, without changing the model parameters, there is no
control mechanism for the epidemic and one may only verify
the conditions under which the system is internally stable,
i.e., the effect of epidemic outbreaks would vanish, remain
bounded, or result in an exponential outbreak. However, interventions such as social distancing, quarantine, medication,
vaccination, etc., can be considered as control inputs that
change the model parameters.
VI. M ODEL PARAMETER IDENTIFICATION

IN FIXED AND

SOCIALLY CONFINED SCENARIOS

An important step in making the proposed model useful
in practice is to fit its parameters on real data. As noted
before, the general compartmental model in (5) depends on
the parameter vector θ(t), which is generally time dependent
(relies on social contact, hygiene, etc.). In order to fit the model
parameters various methods are available in the literature. We
study two approaches, which can be applied to our problem
of interest.
A. Constrained least squares parameter estimation
A general formulation for parameter identification is to
use constrained weighted least squares (CWLS) estimation.
This approach becomes equivalent to the maximum likelihood
estimate, if the measurement noises belong to specific families
of probability distributions (such as the Gaussian distribution).
Nevertheless, the CWLS is more generic as it only attempts
in finding the parameter vector that minimizes a quadratic
error cost function between the model and measurements
(without any probabilistic priors on the origin of the model
or measurement noises). We can specifically refer to the
CWLS formulation proposed in [31] and other prior research,
which have been specifically developed for nonlinear dynamic
models. Accordingly, for the general dynamic model (5), if we
define the modeling error function
∆

e(t) = y(t) − g(x(t); θ(t), t),

(52)

assuming temporarily that the model parameters θ(t) = θ
are fixed, the problem of parameter identification can be
formulated as follows:
θ̂ = argmin tr E[e(t)We(t)T ]
θ

subject to:
θmin ≤ θ ≤ θmax ,
ẋ(t) = f (x(t), w(t); θ, t),

(53)
x(0) = x0

13

Where E(·) denotes averaging over time, tr(·) denotes matrix
trace, θmin and θmax define the lower and upper bounds of
the model parameters dictated by physical constraints, and W
is the inverse of the covariance matrix of the measurement
noise vector v(t) (if available; otherwise can be set to identity
for an unweighted version). This problem is in the form
of nonlinear CWLS for which a variety of stable numerical
solvers exist. Refer to [31] for a survey of methods and [32,
Ch. 5] for methods specific to dynamic systems. In (53), since
the temporal averaging is performed over all time samples,
the procedure is only applicable to offline model fitting. Now
if θ(t) is time variant, an adaptive version of the above
algorithm can be used, by averaging the error cost function
over t0 ≤ τ ≤ t, resulting in a sample-wise updates of the
parameter vector. In the following subsection, we propose an
alternative approach for the time variant case, which is more
flexible, does not require nonlinear least-squares solvers, and
simultaneously estimates the model state variables.
B. An extended Kalman filter for joint parameter and variable
estimation
A well-known method for adaptive estimation of dynamic
system parameters is to consider the (possibly) time-varying
parameters of the model as additional state variables with
presumed dynamics and to estimate them at the same time
or in parallel with the original state vector. For this, let
us assume that all the parameters of our base epidemic
model (27) are time-variant, resulting in the parameter vector
θ(t) = [αi (t), αe (t), κ(t), β(t), ρ(t), µ(t), γ(t)]T , that should
be estimated from real-world epidemic data. From the modeling perspective, this vector can have some deterministic or
stochastic fluctuations. For example, let us assume that the
model parameters are a simple Wiener process (Brownian motion) plus deterministic inputs to model social interventions:
dαi (t)
= uαi (t) + wi (t)
dt
dκ(t)
= uκ (t) + wκ (t)
dt
dρ(t)
= uρ (t) + wρ (t)
dt
dγ(t)
= uγ (t) + wγ (t)
dt

dαe (t)
= uαe (t) + we (t)
dt
dβ(t)
= uβ (t) + wβ (t)
dt
dµ(t)
= uµ (t) + wµ (t)
dt

(54)
where w(t) = [wi (t), we (t), wκ (t), wβ (t), wρ (t), wµ (t), wγ (t)]T
is zero-mean white noise acting as process noise, and
uαi (t) and uαe (t) are the deterministic inputs due to social
intervention that change the level of social contact (considered
for modeling the effect of social distancing and quarantine).
For example, the effect of lockdown applied at time t = t0
can be modeled by combinations of functions of the form:
uαi (t) = ai − bi e−ci (t−t0 ) u(t − t0 )
uαe (t) = ae − be e−ce (t−t0 ) u(t − t0 )

(55)

where ci and ce define the speed of lockdown application,
and ai , bi , ae and be define the range of lockdown effect. The
effect of lockdown termination can be modeled in a similar
manner. In any case, as detailed in Appendix A, the above
dynamics can be state augmented with the compartmental

DRAFT VERSION, SUBJECT TO MODIFICATION. FOLLOW THE UPDATES FROM: https://arxiv.org/abs/2003.11371

model dynamics in (27) and (29) to form an augmented model,
which can be tracked using an extended Kalman filter (EKF).
The implementation of an EKF requires the Jacobian matrix
of the state augmented model with respect to all the elements
∆
of the augmented state vector x̃(t) = [x(t); θ(t)] (where ; denotes column-wise stacking), as detailed in the appendix. The
details of the EKF is beyond the scope of the current study,
which is focused on the modeling aspects of the problem.
Nevertheless, the algorithmic steps of the discretized version
of the compartmental model are presented in Appendix B.
An implementation of the EKF for epidemic model parameter
and state vector tracking will be provided online in the Git
repository of the project [10]. The interested reader is referred
to classical textbooks for the required signal processing and
algorithmic details of the EKF and its extensions [33, Ch. 5
and 6], [20], [34, P. 191], [35, Appendix 9.A and 9.B].
Note that a great advantage of using the EKF for estimating the model states and parameters is that in addition to
estimating the values, it also provides confidence intervals
for the estimates (which is an advantage of all Bayesian
inference/estimation methods). In other words, under the given
assumptions on the process and measurement noise statistics,
one can for example determine how accurate the number
of infected and exposed cases have been estimated. In the
context of interest, such confidence intervals permit healthcare
strategists to have an idea about the accuracy of the estimated
values and appropriate timing for lockdown and quarantine
management.
VII. E STIMATION PANDEMIC TREND

AND REPRODUCTION
RATE FROM NOISY REPORTS

In Section III-E, it was shown that during the outbreak of a
pandemic, the number of new cases has an exponential growth,
corresponding to the dominant eigenvalue of the dynamic
system. Tracking this exponential rate over time from daily
reported cases under social distancing and intervention plans
is of practical importance. A major limitation in this context
is the errors, inconsistencies and delays of the reported cases
over weekdays, weekends and other holidays. This has been
a recurrent issue during the COVID-19 pandemic. Therefore,
most analysts prefer to monitor the three-day or seven-day
moving average of the reported cases. We will show that an
extended Kalman filter/smoother can be effectively used for
the simultaneous prediction/filtering of the daily reports and
also the estimation of the reproduction rate under NPI or other
social distancing factors. For this, we consider the following
model, for the number of new cases for an arbitrary region
(during outbreak):
x(t + ∆) = x(t) exp[∆λ(t)] + w(t)
1
λ(t + ∆) = σ tanh{ [αλ(t) + v(t) + h(p(t))]}
σ
y(t) = x(t) + n(t)

(56)

where:
• t: is time in days.
• ∆: reporting time period (∆ = 1 for daily reports)
• x(t): the true number of new cases (to be estimated)
• y(t): the reported number of new cases (erroneous)

14

λ(t): the pandemic spread exponent
w(t): exponential model deviation error (white noise)
• v(t): autoregressive model driving noise (white noise)
• α: autoregressive model rate (0 < α < 1)
• n(t): observation/reporting error due to weekends, holidays, counting errors, etc.
L
• p(t) ∈ R : a vector of L quantitative NPI indexes such
as the Oxford COVID-19 Government Response Tracker
(OxCGRT) [8], and other indexes such as holidays,
seasonal temperature, etc.
• h(·): the NPI influence function, which is a mapping from
the NPIs to λ(t), to be found by learning mechanisms
such as least absolute shrinkage and selection operator
(LASSO) or long short-term memory (LSTM) recurrent
neural networks. Note that h(p(t)) acts as an exogenous
input for the dynamic model. Considering that the NPIs
are planned by authorities and are rather consistent for
a certain period (e.g. several weeks) until they become
effective in reducing the number of new cases, h(p(t))
commonly acts as a step-response that in the steady-state
changes the DC (average) level of λ(t).
• σ: the exponential rate saturation value set to the maximum absolute value of the anticipated λ(t) for a specific
region or country. In fact, the tanh saturation function
in (56), smoothly saturates λ(t) and guarantees model
stability. By selecting σ several times greater than the
standard deviation of λ(t) over the past several months
of each region, the saturation function will only saturate
the outliers and will not influence normal variations of
λ(t).
Note that in (56), following the proposed definition in (24),
the exponential growth factor can be related to the timevarying reproduction rate as follows: R̃(t) = eλ(t)∆ .
Having developed the model, the trend estimation consists
of two phases: the endogenous part in absence of any NPI,
and the exogenous part due to the NPIs, which are detailed
below.
•

•

A. Endogenous trend prediction
In absence of NPIs, we may assume h(p(t)) = 0 (or constant) in (56). Defining the state vector s(t) = [x(t), λ(t)]T ,
the first two equations in (56) serve as smooth differentiable
nonlinear state equations and the third equation is the linear
observation equation. In our online repository, we have implemented an extended Kalman filter (EKF) and a fixed-interval
extended Kalman smoother (EKS) based on this endogenous
model. The algorithm is summarized in Appendix C. During
the training phase, the EKS is used for smoothing the noisy
daily reports and to estimate the exponential rate λ(t). The
same model is used in an EKF during the prediction phase of
the challenge, but without having any new case reports. The
EKF and EKS may even be used for estimating the missing
dates (such as weekends and holidays that countries do not
report exact cases). The entries of the covariance matrices of
the EKF/EKS, which are integral elements of all Bayesian
estimators including the EKF/EKS are also used to calculate
confidence intervals for the estimated values.

DRAFT VERSION, SUBJECT TO MODIFICATION. FOLLOW THE UPDATES FROM: https://arxiv.org/abs/2003.11371

B. Endogenous prediction

10

During the training period, λ̂(t) (an estimate of λ(t)) is
obtained by the EKF for an arbitrary region/country. Next,
from the second equation in (56), the residual terms corresponding to the exogenous NPI input and autoregressive noise
is obtained. This term is given to regression models such
as LASSO or LSTM as the target output, together with the
regional NPIs and other indexes to learn h(·). The overall
algorithm for predicting the new cases is summarized in
Algorithm 1.

15

USA

5

3 EKS Envelopes
New Cases
7-Day MA
EKS

Number of new cases

2

Algorithm 1 Proposed algorithm for new cases forecasting
1: Training phase: apply the EKS on reported new cases to
estimate λ̂(t), the exponential rate of pandemic spread.
2: Use regression algorithms such as LASSO or LSTM to
learn h(·), the regression map from the NPIs to λ̂(t).
3: Forecasting phase: the trained model h(·) is used in the
EKF to forecast future values of the new cases and its
exponential rate, together with the confidence intervals
obtained from the covariance matrices of the EKF.

1.5

1

0.5

0
50

100

150

200

250

Days since 100th case

(a) The new case
USA

0.2

3 EKS Envelopes
Linear Fit
New case ratios geometric mean
Least Squares
EKS

0.15

C. Alternative methods for exponential rate estimation

λ(t) = argmin
λ

t
X

{y(t′ ) − x(t) exp[(t′ − t)λ]}2 (57)

t′ =t−N +1

which can be numerically solved using optimization toolboxes
such as nlinfit in Matlab or the scipy.optimize
package for Python. An approximate workaround for the
nonlinear problem in (57) is to apply a linear regression on the
logarithm of the new cases time-series over a sliding window
of N days. Another method is an empirical geometric mean
of the new cases ratios. A Matlab implementation of these
methods is provided in our online repository.
A sample result of tracking the trend of new cases and
the exponential growth using the hereby proposed extended
Kalman smoother on real daily reported cases of the US since
the 100th case report is shown in Fig. 7. For simplicity, the
effect of NPIs have not been considered in this example.
VIII. S IMULATED RESULTS
We have carried-out several simulations with different sets
of parameters, resulting in the different scenarios explained in
previous sections.
Example 4 (Life-time immune case). The first scenario is
illustrated in Fig. 8, where we have considered a single virus
outbreak in a 84 million population, with constant parameters
αe = 0.65, αi = 0.005, κ = 0.05, ρ = 0.08, β = 0.1, µ =
0.02 and γ = 0, simulated over one year. The assumption γ =
0 implies that the disease has been assumed to develop lifetime

0.1
k

Beyond the Kalman filter based approach, we have also
implemented three other methods for estimating the rate of
growth during the offline training phase. Assuming that λ(t)
is rather constant over a small windows of N days, it can
be estimated by solving the following nonlinear least squares
error problem:

0.05

0

50

100

150

200

250

Days since 100th case

(b) The exponential growth
Fig. 7. Tracking the trend of new cases and the exponential growth using the
proposed extended Kalman smoother on daily reported cases of the US, since
the 100th case report. The raw noisy daily reports have been adopted from
the Oxford COVID-19 Government Response Tracker (OxCGRT) project [8].

immunity, therefore there is no return from the recovered to
the susceptible compartment. In Fig. 8, we can observe the
constant ratio between i(t) and e(t) during the exponential
outbreak (when i(t) ≪ s(t) and before reaching the nonlinear
phase of the model), which approves the relationship derived
in (44).
Example 5 (Recurrent epidemic). The second scenario is
illustrated in Fig. 9. All the model parameters are identical
to Example 4, except for the re-susceptibility rate (loss of
immunity) that is now γ = 0.001. It is interesting to see that
in this scenario, the model has recurrent decaying peaks over
time, similar to the aforementioned 1918 Spanish flu.
Example 6 (Short lockdown period). The next scenario is
illustrated in Fig. 10. This scenario corresponds to the case
where a one month lockdown is applied by the government
to identify the exposed and infected cases. The parameters

DRAFT VERSION, SUBJECT TO MODIFICATION. FOLLOW THE UPDATES FROM: https://arxiv.org/abs/2003.11371

Population Ratio

1

Result 8. Imposing quarantines is effective in delaying and reducing the infection population peaks;
but is insufficient in the long term. Social distancing
and other measures should remain for a long period
after the initial quarantine, to make the number of
contaminated subjects equal to “zero.”

0.8

S(t)
E(t)
I(t)
R(t)
P(t)

0.6
0.4
0.2
0
0

50

100

150

days

(a) in five months
1
S(t)

Population Ratio

of the model before quarantine are αe = 0.6, αi = 0.005,
κ = 0.05, ρ = 0.08, β = 0.1, µ = 0.02 and γ = 0.001. In the
30th day after the initial outbreak, the one month lockdown is
applied, during which αe and αi are reduced to 0.1 and 0.001,
respectively, while keeping the other parameters unchanged.
After one month, αi remains 0.001 (people keep distance with
the infected ones), but αe is increased to 0.4 (much more
than the quarantine period, but two-third of the original social
contact factor). We can see that with this scenario, which
corresponds to an insufficient quarantine period, the population
of the infected and exposed peaks have decreased; but the
quarantine does not significantly change the mortality toll after
five months. But why? Because, after the quarantine period,
there is still a minor fraction of the population that is exposed,
and this very small seed can re-initiate the virus spread. We
therefore come to the following result:

16

E(t)

I(t)

R(t)

P(t)

0.8
0.6
0.4
0.2
0

β(t) = (βs − β0 )h(i(t)) + β0
µ(t) = (µs − µ0 )h(i(t)) + µ0

0

1000

2000

3000

4000

days

(b) in ten years
0.05
I(t)
E(t)

0.04

Population ratio

Example 7 (Healthcare system saturation). Our next scenario
corresponds to the case where the healthcare system reaches
its maximum capacity or break-point, due to limited test
kits, medication, hospitalization, excessive fatigue or mortality
of the healthcare personnel, economic breakdowns, etc. This
phenomenon is the worst feared case for pandemic strategists
and it can be modeled at various levels. Suppose that we
model it in its simplest form and assume that the recovery
and mortality rates of the model change as functions of the
number of infected cases:

0.03
0.02

(58)

0.01

where β0 and µ0 are the recovery and mortality rate parameters
before healthcare system saturation, βs (βs ≪ β0 ) and µs
(µs ≫ µ0 ) are the recovery and mortality rates after saturation,
and h(i(t)) is a saturation function such that h(0) ≈ 0 and

0
500

1000

1500

2000

2500

3000

3500

4000

days

(c) I(t) and E(t) in ten years
Fig. 9. Scenario B: Simulation of the fatal SEIR model with parameters αe
= 0.65, αi = 0.005, κ = 0.05, ρ = 0.08, β = 0.1, µ = 0.02, γ = 0.001, in (a)
five months and (b, c) ten years

Population Ratio

1
I(t)/E(t)

0.8

S(t)
E(t)
I(t)
R(t)
P(t)

0.2

0.6
0.1

h(∞) ≈ 1. For example, the hyperbolic tangent with a slope
parameter σ is a reasonable and common choice for modeling
such phenomena:

0.4
0
0

0.2

20

40

0
0

50

i − i0
1
[1 + tanh (
)]
(59)
2
σ
where i0 is the infection break-point of the healthcare system.
The above choice is also beneficial for parameter optimization
and tracking, due to the smoothness and differentiability of the
hyperbolic tangent function.
A simulation of this scenario is illustrated in Fig. 11. The
parameters of the model are αe = 0.6, αi = 0.005, κ = 0.05,
ρ = 0.08, and γ = 0.001. The healthcare system breakdown
parameters are β0 = 0.1, µ0 = 0.02, βs = 0.01, µs = 0.2,
h(i) =

100

150

200

250

300

days

Fig. 8. Scenario A: Simulation of the fatal SEIR model with parameters
αe = 0.65, αi = 0.005, κ = 0.05, ρ = 0.08, β = 0.1, µ = 0.02
and γ = 0, over 10 months. Notice the constant i(t)/e(t) ratio during the
exponential outbreak, which is approximately equal to αi λ̃−1
1 = 0.078.

DRAFT VERSION, SUBJECT TO MODIFICATION. FOLLOW THE UPDATES FROM: https://arxiv.org/abs/2003.11371

Population ratio

0.5
I1(t)
E1(t)
I2(t)
E2(t)

0.4
0.3

Quarantine
starts

Quarantine
ends

0.2
0.1

Population ratio

0
0

50

100

150

0.05
P1(t)
P2(t)

0
0

50

100

150

days
Fig. 10. Scenario C: Simulation of the fatal SEIR model with a quarantine
period between day 30 and 60. E1(t), I1(t) and P 1(t) correspond to the
case without quarantine and E2(t), I2(t) and P 2(t) correspond to the case
with quarantine. Refer to the text for further details and the switching of the
parameters.

0.15
i1(t)
i2(t)

0.1

Healthcare system
breakdown infection level

0.05

Population ratio Population ratio

Population ratio

σ = 1, i0 = 0.1 (although in reality, the healthcare system is
expected to reach its breakpoint far below this infection rate).
We can observe how the death rate significantly increases as
the system reaches its break-point.

0
1
r1(t)
r2(t)

0.5

0
p1(t)
p2(t)

0.2
0.1
0
0

50

days

100

150

Fig. 11. Scenario D: Simulation of the fatal SEIR model when the healthcare
system reaches its breakdown point at i(t) = 0.1. The curves i1(t), r1(t),
and p1(t) are the non-saturated cases and i2(t), r2(t), and p2(t) correspond
to the saturated cases.

IX. C ONCLUSION

AND

F UTURE W ORK

In this study we considered some of the properties of
epidemic diseases from a mathematical and signal processing

17

perspective, by using a compartmental model for the propagation of the epidemic disease. It was shown that the model
is not stable around its fixed-point (the no-infection case). We
should indeed be proactively worried about the instability of
our societies to such epidemic outbreaks; since a fatal virus
with an initial seed as small as a single subject worldwide can
trigger the avalanche of pandemic waves, killing many people
worldwide, as the COVID-19 coronavirus has shown. Note
however that from the modeling and dynamics perspective,
there is nothing specific to the coronavirus, apart from its
specific parameters. In fact, humans have always been living in
such a metastable condition and researchers from all domains
need to synergize to think a way through this condition.
The research will be continued and extended from various aspects in the future versions. Specifically, by fitting
the model over real data, the prediction of infection and
mortality rates under quarantine and vaccination, and the study
of the recurrent pattern of the epidemic disease over time.
Non-exponential law infection distributions have also been
considered in the literature [17]. This can be an interesting
track of research for the study of epidemic diseases, including
the family of coronaviruses.

A PPENDIX
A. Compartmental Model Jacobians
Following (28) and the Wiener process model for the model
parameters presented in (54), the most general form of the
proposed compartmental model with time-varying parameters
is as follows
de(t)
= [1 − e(t) − i(t) − r(t) − p(t)][αe (t)e(t) + αi (t)i(t)]
dt
−κ(t)e(t) − ρ(t)e(t)
di(t)
= κ(t)e(t) − β(t)i(t) − µ(t)i(t)
dt
dr(t)
= β(t)i(t) + ρ(t)e(t) − γ(t)r(t)
dt
dp(t)
= µ(t)i(t)
dt
dui
dαe (t)
due
dαi (t)
=
(t) + wi (t)
=
(t) + we (t)
dt
dt
dt
dt
dβ(t)
dρ(t)
dκ(t)
= wκ (t)
= wβ (t)
= wρ (t)
dt
dt
dt
dµ(t)
dγ(t)
= wµ (t)
= wγ (t)
dt
dt
(60)
If we define the variable and parameter augmented state vector:
∆

x(t) =

[e(t), i(t), r(t), p(t),
αi (t), αe (t), κ(t), β(t), ρ(t), µ(t), γ(t)]T

(61)

which can be written in the compact state-space form (5). The
Jacobian of this form is defined
∆

A(t) =

∂f (·)
∈ R11×11
∂x

(62)

DRAFT VERSION, SUBJECT TO MODIFICATION. FOLLOW THE UPDATES FROM: https://arxiv.org/abs/2003.11371

with the following non-zero entries (we have dropped the time
index of all variables and parameters for better readability):
A1,1
A1,2
A1,3
A1,5
A1,7
A2,1
A2,7
A3,1
A3,8
A4,2

= αe [1 − 2e − i − r − p] − αi i − κ − ρ
= αi [1 − e − 2i − r − p] − αe e
= −[αe e + αi i] A1,4 = −[αe e + αi i]
= i[1 − e − i − r − p] A1,6 = e[1 − e − i − r − p]
= −e A1,9 = −e
= κ A2,2 = −β − µ
= e A2,8 = −i A2,10 = −i
= ρ A3,2 = β A3,3 = −γ
= i A3,9 = e A3,11 = −r
= µ A4,10 = i
(63)

B. The extended Kalman filter algorithm for simultaneous
parameter and variable tracking
Official epidemic data are commonly reported on a daily or
weekly bases. Therefore, the measurements used for model
variable and parameter estimation are discrete time, while
the compartmental model proposed throughout this work is
continuous. As a result two approaches are available for
implementing an EKF: 1) to use continuous-discrete Kalman
filters, which mix continuous state equations with discrete
measurement equations, or 2) to discretize the dynamic model
of the system and to implement a discrete EKF. The formulation for the latter approach is detailed in Algorithm 2.
Algorithm 2 An extended Kalman filter for simultaneous
compartment variable and model parameter tracking
Input: Noisy measurements (regular reports) of the
epidemic spread yk
+
Input: Initial conditions: Q, R, x̂+
0 , P0
+
Output: x̂k (vector of state and model parameter estimates)
1:
2:
3:
4:
5:
6:
7:
8:
9:
10:
11:
12:

for k = 0 · · · T do
State prediction:
+
+
x̂−
k+1 = f (x̂k , w̄; θ̂k , k∆)
+ + +T
−
Pk+1 = Ak Pk Ak + Q
Measurement update:
−T
− − −T
−1
Kk = P−
k Ck [Ck Pk Ck + R]
−
−
−
ŷk = g(x̂k ; θ̂k , k∆)
ik = yk − ŷk−
σ̂k+ = σ̂k− + Kk ik
−
−
P+
k = [I − Kk Ck ]Pk
Check and enforce variable and parameter ranges
using hard-constraints
Performance monitoring
end for

C. The extended Kalman filter algorithm for trend tracking
from noisy data
For pandemic trend smoothing and forecasting described in
∆
Section VII, we define yk = y(k∆), sk = [x(k∆), λ(k∆)]T
∆
and wk = [w(k∆), v(k∆)]T as the discrete-time observation,

18

state vector and process noise vector. Accordingly, (56) can
be formulated in the discrete form as follows:
sk+1 = f (sk , wk ; h(p(t)))
(64)
yk = cT sk + nk = [1 0]sk + nk
The observation equation is already linear, and the Jacobian
of the state equation with respect to the state variables is


exp(∆λk ) ∆sk exp(∆λk )
∆ ∂f (·)
=
(65)
Ak =
0
α(1 − tanh(·)2 )
∂sk
where tanh(·) has the same arguments as in (56). With these
definitions, the proposed EKF algorithm is summarized in
Algorithm 2. The algorithm can be proved to be asymptotically
stable, which implies that even though the new cases might
follow an exponential growth, the EKF can track the state
vector.
The source codes for this implementation and the training
EKS implementation are available in our online repository.
Algorithm 3 An extended Kalman filter for smoothing and
forecasting the pandemic trend and its exponential rate
Input: Daily reports of the epidemic spread yk
Input: Process noise covariance matrix Q, observation noise
+
variance r, initial states ŝ+
0 with covariance matrix P0 ,
and process noise mean w̄
Output: ŝ+
k = [x̂k , λ̂k ] (vector of daily state estimates)
1: for k = 0 · · · T do
2:
State prediction:
+
3:
ŝ−
k+1 = f (ŝk , w̄; h(pk ))
+ + +T
−
4:
Pk+1 = Ak Pk Ak + Q
Measurement update:
T −
−1
5:
Kk = P−
k c[c Pk c + r]
−
T −
6:
ŷk = c x̂k
7:
ik = yk − ŷk−
−
8:
ŝ+
k = ŝk + Kk ik
+
9:
Pk = [I − Kk cT ]P−
k
10: end for

ACKNOWLEDGMENT
The first versions of this manuscript were drafted in March
2020, in the midst of the COVID-19 coronavirus outbreak,
during the affiliation of R. Sameni with GIPSA-lab, Université
Grenoble Alpes, CNRS, Grenoble INP, Grenoble, France. The
author would like to sincerely thank Professor Christian Jutten,
Emeritus Professor of Université Grenoble Alpes, for his
insightful and motivating comments throughout this study.
R EFERENCES
[1] O. Diekmann, H. Heesterbeek, and T. Britton, Mathematical tools for
understanding infectious disease dynamics. Princeton University Press,
2012, vol. 7.
[2] F. Brauer, C. Castillo-Chavez, and C. Castillo-Chavez, Mathematical
models in population biology and epidemiology. Springer, 2012, vol. 2.
[3] J. Haefner, Modeling Biological Systems: Principles and Applications.
Springer, 2005.
[4] G. de Vries, T. Hillen, M. Lewis, B. Schõnfisch, and J. Muller, A Course
in Mathematical Biology: Quantitative Modeling with Mathematical and
Computational Methods, ser. Monographs on Mathematical Modeling
and Computation. Society for Industrial and Applied Mathematics,
2006.

DRAFT VERSION, SUBJECT TO MODIFICATION. FOLLOW THE UPDATES FROM: https://arxiv.org/abs/2003.11371

[5] W. Yang, A. Karspeck, and J. Shaman, “Comparison of filtering methods
for the modeling and retrospective forecasting of influenza epidemics,”
PLoS computational biology, vol. 10, no. 4, 2014.
[6] A. Azar, Control Applications for Biomedical Engineering Systems.
Elsevier Science, 2020.
[7] “from prediction to prescription: Evolutionary optimization of nonpharmaceutical interventions in the covid-19 pandemic.”
[8] Thomas Hale and Sam Webster and Anna Petherick and Toby Phillips
and Beatriz Kira, Oxford COVID-19 Government Response Tracker,
2020, Blavatnik School of Government. [Online]. Available: https://
github.com/OxCGRT/covid-policy-tracker
[9] XPRIZE, The XPRIZE Pandemic Response Challenge, Oct 2020 – Feb
2021. [Online]. Available: https://xprize.org/pandemicresponse
[10] R. Sameni, Mathematical Modeling of Epidemic Diseases, 2020.
[Online]. Available: https://github.com/rsameni/EpidemicModeling.git
[11] J. Ottesen, M. Olufsen, and J. Larsen, Applied Mathematical Models
in Human Physiology, ser. Monographs on Mathematical Modeling and
Computation. Society for Industrial and Applied Mathematics, 2004.
[12] K. P. Burnham and D. R. Anderson, “Multimodel inference: understanding aic and bic in model selection,” Sociological methods & research,
vol. 33, no. 2, pp. 261–304, 2004.
[13] F. De Ridder, R. Pintelon, J. Schoukens, and D. P. Gillikin, “Modified
aic and mdl model selection criteria for short data records,” IEEE
Transactions on Instrumentation and Measurement, vol. 54, no. 1, pp.
144–150, 2005.
[14] T. Britton, “Stochastic epidemic models: a survey,” Mathematical biosciences, vol. 225, no. 1, pp. 24–35, 2010.
[15] L. Pellis, F. Ball, and P. Trapman, “Reproduction numbers for epidemic
models with households and other social structures. I. Definition and
calculation of R0,” Mathematical biosciences, vol. 235, no. 1, pp. 85–
97, 2012.
[16] J. C. Miller, “Distribution of outbreak sizes for sir disease in finite
populations,” arXiv preprint arXiv:1907.05138, 2019.
[17] Z. Feng, D. Xu, and H. Zhao, “Epidemiological models with nonexponentially distributed disease stages and applications to disease
control,” Bulletin of mathematical biology, vol. 69, no. 5, pp. 1511–
1536, 2007.
[18] V. C. Rideout, Mathematical and Computer Modeling of Physiological
Systems. Prentice Hall, 1991.
[19] B. Ingalls, An Introduction to Mathematical Modelling in Molecular
Systems Biology. Department of Applied Mathematics, University of
Waterloo, 2012.
[20] M. S. Grewal and A. P. Andrews, Kalman Filtering: Theory and Practice
Using Matlab, 2nd ed. John Wiley & Sons, Inc., 2001.
[21] R. M. Anderson and R. M. May, “Population biology of infectious
diseases: Part i,” Nature, vol. 280, no. 5721, pp. 361–367, 1979.
[22] R. M. May and R. M. Anderson, “Population biology of infectious
diseases: Part ii,” Nature, vol. 280, no. 5722, pp. 455–461, 1979.
[23] H. W. Hethcote, “The mathematics of infectious diseases,” SIAM review,
vol. 42, no. 4, pp. 599–653, 2000.
[24] K. Dietz, “Transmission and control of arbovirus diseases,” Epidemiology, vol. 104, pp. 104–121, 1975.
[25] J. C. Kamgang and G. Sallet, “Computation of threshold conditions
for epidemiological models and global stability of the disease-free
equilibrium (dfe),” Mathematical biosciences, vol. 213, no. 1, pp. 1–
12, 2008.
[26] P. Van den Driessche and J. Watmough, “Reproduction numbers and
sub-threshold endemic equilibria for compartmental models of disease
transmission,” Mathematical biosciences, vol. 180, no. 1-2, pp. 29–48,
2002.
[27] Z. Feng, “Final and peak epidemic sizes for seir models with quarantine
and isolation,” Mathematical Biosciences & Engineering, vol. 4, no. 4,
p. 675, 2007.
[28] S. Gonçalves, G. Abramson, and M. F. Gomes, “Oscillations in sirs
model with distributed delays,” The European Physical Journal B,
vol. 81, no. 3, p. 363, 2011.
[29] T. Kailath, Linear Systems. Prentice Hall, 1980.
[30] W. J. Terrell, Stability and stabilization: an introduction. Princeton
University Press, 2009.
[31] A. Gábor and J. R. Banga, “Robust and efficient parameter estimation
in dynamic models of biological systems,” BMC systems biology, vol. 9,
no. 1, p. 74, 2015.
[32] D. P. Moeller, Mathematical and computational modeling and simulation. Springer, 2003.
[33] S. Haykin, Ed., Kalman Filtering and Neural Networks. John Wiley
& Sons Inc., 2001.
[34] A. Gelb, Ed., Applied Optimal Estimation. MIT Press, 1974.

19

[35] A. Jazwinski, Stochastic Processes and Filtering Theory, ser. Mathematics in Science and Engineering. Elsevier Science, 1970.

