arXiv:2007.15931v2 [stat.ME] 4 Aug 2020

Nonparametric comparison
of epidemic time trends:
the case of COVID-19
Marina Khismatullina1

Michael Vogt2

University of Bonn

University of Bonn

The COVID-19 pandemic is one of the most pressing issues at present. A
question which is particularly important for governments and policy makers
is the following: Does the virus spread in the same way in different countries?
Or are there significant differences in the development of the epidemic? In
this paper, we devise new inference methods that allow to detect differences in
the development of the COVID-19 epidemic across countries in a statistically
rigorous way. In our empirical study, we use the methods to compare the
outbreak patterns of the epidemic in a number of European countries.

Key words: simultaneous hypothesis testing; multiscale test; time trend; panel
data; COVID-19.
JEL classifications: C12; C23; C54.

1

Introduction

There are many questions surrounding the current COVID-19 pandemic that are not
well understood yet. A question which is particularly important for governments
and policy makers is the following: How do the outbreak patterns of COVID-19
compare across countries? Are the time trends of daily new infections more or less
the same across countries, or is the virus spreading differently in different regions of
the world? Identifying differences between countries may help, for instance, to better
understand which government policies have been more effective in containing the
virus than others. The main aim of this paper is to develop new inference methods
that allow to detect differences between time trends of COVID-19 infections in a
statistically rigorous way.
Let Xit be the number of new infections on day t in country i and suppose we
observe a sample of data Xi = {Xit : 1 ≤ 1 ≤ T } for n different countries i. In order
to make the data comparable across countries, we take the starting date t = 1 to be
the day of the 100th confirmed case in each country. This way of “normalizing” the
data is common practice (cp. e.g. Cohen and Kupferschmidt, 2020). A simple way
1

Corresponding author. Address: Bonn Graduate School of Economics, University of Bonn, 53113
Bonn, Germany. Email: marina.k@uni-bonn.de.
2
Address: Department of Economics and Hausdorff Center for Mathematics, University of Bonn,
53113 Bonn, Germany. Email: michael.vogt@uni-bonn.de.

1

to model the count data Xit is to use a Poisson distribution. Specifically, we may assume that the random variables Xit are Poisson distributed with time-varying intensity parameter λi (t/T ), that is, Xit ∼ Pλi (t/T ) . Since λi (t/T ) = E[Xit ] = Var(Xit ),
we can model the observations Xit by the nonparametric regression equation
Xit = λi

t
T

+ uit

(1.1)

for 1 ≤ t ≤ T , where uit = Xit − E[Xit ] with E[uit ] = 0 and Var(uit ) = λi (t/T ).
As usual in nonparametric regression (cp. Robinson, 1989), we let the regression
function λi in model (1.1) depend on rescaled time t/T rather than on real time
t. Hence, λi : [0, 1] → R can be regarded as a function on the unit interval, which
allows us to estimate it by standard techniques from nonparametric regression. Since
λi is a function of rescaled time t/T , the variables Xit in model (1.1) depend on the
time series length T in general, that is, Xit = Xit,T . To keep the notation simple, we
however suppress this dependence throughout the paper. In Section 2, we introduce
the model setting in detail which underlies our analysis. As we will see there, it is
a generalized version of the Poisson model (1.1).
In model (1.1), the time trend of new COVID-19 infections in country i is described by the intensity function λi of the underlying Poisson distribution. Hence,
the question whether the time trends are comparable across countries amounts
to the question whether the intensity functions λi have the same shape across
countries i. In this paper, we construct a multiscale test which allows to identify and locate the differences between the functions λi . More specifically, let
F = {Ik ⊆ [0, 1] : 1 ≤ k ≤ K} be a family of (rescaled) time intervals Ik and
(ijk)
let H0
be the hypothesis that the functions λi and λj are the same on the interval
Ik , that is,
(ijk)
H0
: λi (w) = λj (w) for all w ∈ Ik .
(ijk)

We design a method to test the hypothesis H0
simultaneously for all pairs of
countries i and j under consideration and for all intervals Ik in the family F. The
main theoretical result of the paper shows that the method controls the familywise
error rate, that is, the probability of wrongly rejecting at least one null hypothesis
(ijk)
H0 . As we will see, this allows us to make simultaneous confidence statements of
the following form for a given significance level α ∈ (0, 1):
With probability at least 1 − α, the functions λi and λj differ on the
(ijk)
interval Ik for every (i, j, k) for which the test rejects H0 .
Hence, the method allows us to make simultaneous confidence statements (a) about
which time trend functions differ from each other and (b) about where, that is, in
which time intervals Ik they differ.
2

Even though our multiscale test is motivated by the current COVID-19 crisis, its
applicability is by no means restricted to this specific event. It is a general method to
compare nonparametric trends in epidemiological (count) data. It thus contributes
to the literature on statistical tests for equality of nonparametric regression and
trend curves. Examples of such tests can be found in Härdle and Marron (1990),
Hall and Hart (1990), King et al. (1991), Delgado (1993), Kulasekera (1995), Young
and Bowman (1995), Munk and Dette (1998), Lavergne (2001), Neumeyer and Dette
(2003) and Pardo-Fernández et al. (2007). More recent approaches were developed in
Degras et al. (2012), Zhang et al. (2012), Hidalgo and Lee (2014) and Chen and Wu
(2019). Compared to existing methods, our test has the following crucial advantage:
it is much more informative. Most existing procedures allow to test whether the
regression or trend curves under consideration are all the same or not. However,
they do not allow to infer which curves are different and where (that is, in which
parts of the support) they differ. Our multiscale approach, in contrast, conveys this
information. Indeed, it even allows to make rigorous confidence statements about
which curves λi are different and where they differ. To the best of our knowledge,
there is no other method available in the literature which allows to make such
simultaneous confidence statements. As far as we know, the only other multiscale
test for comparing trend curves has been developed in Park et al. (2009). However,
their analysis is mainly methodological and not backed up by a general theory.
In particular, theory is only available for the special case n = 2. Moreover, the
theoretical results are only valid under very severe restrictions on the family of time
intervals F.
The paper is structured as follows. As already mentioned above, Section 2 details
the model setting which underlies our analysis. The multiscale test is developed step
by step in Section 3. To keep the presentation as clear as possible, the technical
details are deferred to the Appendix and the Supplementary Material. Section 4
contains the empirical part of the paper. There, we run some simulation experiments
to demonstrate that the multiscale test has the formal properties predicted by the
theory. Moreover, we use the test to compare the outbreak patterns of the COVID19 epidemic in a number of European countries.

2

Model setting

As already discussed in the Introduction, the assumption that Xit ∼ Pλi (t/T ) leads
to a nonparametric regression model of the form
Xit = λi

t
T

+ uit

r  
t
with uit = λi
ηit ,
T
3

(2.1)

where ηit has zero mean and unit variance. In this model, both the mean and the
variance are described by the same function λi . In empirical applications, however,
the variance often tends to be much larger than the mean. To deal with this issue,
which has been known for a long time in the literature (Cox, 1983) and which
is commonly called overdispersion, so-called quasi-Poisson models (McCullagh and
Nelder, 1989; Efron, 1986) are frequently used. In our context, a quasi-Poisson
model of Xit has the form
Xit = λi

t
T

+ εit

r  
t
with εit = σ λi
ηit ,
T

(2.2)

where σ is a scaling factor that allows the variance to be a multiple of the mean
function λi . In what follows, we assume that the observed data Xit are produced by
model (2.2), where the noise residuals ηit have zero mean and unit variance but we
do not impose any further distributional assumptions on them.
Poisson and quasi-Poisson models are often used in the literature on epidemic
modelling. De Salazar et al. (2020), for example, assume that the observed COVID19 case count in country i follows a Poisson distribution with parameter λi being a
linear function of some covariate Zi , that is, λi = βZi . Pellis et al. (2020) consider
a quasi-Poisson model for the number of new COVID-19 cases. They in particular
examine (a) a version of the model where the mean function is parametrically restricted to be exponentially growing with a constant growth rate and (b) a version
where the mean function is modelled nonparametrically by splines. Tobı́as et al.
(2020) analyze data on the accumulated number of cases using quasi-Poisson regression, where the mean function is modelled parametrically as a piecewise linear curve
with known change points.
In order to derive our theoretical results, we impose the following regularity
conditions on model (2.2):
(C1) The functions λi are uniformly Lipschitz continuous, that is, |λi (u) − λi (v)| ≤
L|u − v| for all u, v ∈ [0, 1], where the constant L does not depend on i.
Moreover, they are uniformly bounded away from zero and infinity, that is,
there exist constants λmin and λmax with 0 ≤ λmin ≤ minw∈[0,1] λi (w) ≤
maxw∈[0,1] λi (w) ≤ λmax < ∞ for all i.
(C2) The random variables ηit are independent both across i and t. Moreover, for
any i and t, it holds that E[ηit ] = 0, E[ηit2 ] = 1 and E[|ηit |θ ] ≤ Cθ < ∞ for
some θ > 4.

4

(C1) imposes some standard-type regularity conditions on the functions λi . In particular, the functions are assumed to be smooth, bounded from above and bounded
away from zero. The latter restriction is required because the noise variance in
model (2.2) equals zero if λi is equal to zero. Since we normalize our test statistics
by an estimate of the noise variance as detailed in Section 3, we need this variance and thus the functions λi to be bounded away from zero. (C2) assumes the
noise terms ηit to fulfill some mild moment conditions and to be independent both
across countries i and time t. In the current COVID-19 crisis, independence across
countries i seems to be a fairly reasonable assumption due to severe travel restrictions, the closure of borders, etc. Independence across time t is more debatable, but
it is by no means unreasonable in our model framework: The time series process
Xi = {Xit : 1 ≤ t ≤ T } produced by model (2.2) is nonstationary for each i. Specifically, both the mean E[Xit ] = λi (t/T ) and the variance Var(Xit ) = σ 2 λi (t/T ) are
time-varying. A well-known fact in the time series literature is that nonstationarities
such as a time-varying mean may produce spurious sample autocorrelations (cp. e.g.
Mikosch and Stărică, 2004; Fryzlewicz et al., 2008). Hence, the observed persistence
of a time series (captured by the sample autocorrelation function) may be due to
nonstationarities rather than real autocorrelations. This insight has led researchers
to prefer simple nonstationary models over intricate stationary time series models
in some application areas such as finance (cp. Mikosch and Stărică, 2000, 2004; Fryzlewicz et al., 2006; Hafner and Linton, 2010). In a similar vein, our model accounts
for the persistence in the observed time series Xi via nonstationarities rather than
autocorrelations in the error terms.

3

The multiscale test

Let S ⊆ {(i, j) : 1 ≤ i < j ≤ n} be the set of all pairs of countries (i, j) whose trend
functions λi and λj we want to compare. Moreover, as already introduced above, let
F = {Ik : 1 ≤ k ≤ K} be the family of (rescaled) time intervals under consideration.
Finally, write M := S × {1, . . . , K} and let p := |M| be the cardinality of M. In
(ijk)
this section, we devise a method to test the null hypothesis H0
simultaneously
for all pairs of countries (i, j) ∈ S and all time intervals Ik ∈ F, that is, for all
(i, j, k) ∈ M. The value p = |M| is the dimensionality of the simultaneous test
problem we are dealing with. It amounts to the number of tests that we carry out
simultaneously. As shown by our theoretical results in the Appendix, p may be
much larger than the time series length T , which means that the simultaneous test
problem under consideration can be very high-dimensional.

5

3.1

Construction of the test statistics
(ijk)

A statistic to test the hypothesis H0
for a given triple (i, j, k) can be constructed
as follows. To start with, we introduce the expression
ŝijk,T

T

1 X t
1
∈ Ik (Xit − Xjt ),
=√
T
T hk t=1

where hk is the length of the time interval Ik , 1(·) denotes the indicator function
and 1(t/T ∈ Ik ) can be regarded as a rectangular kernel weight. A simple applica√
P
tion of the law of large numbers yields that ŝijk,T / T hk = (T hk )−1 Tt=1 1(t/T ∈
Ik ){λi (t/T ) − λj (t/T )} + op (1) for any fixed pair of countries (i, j). Hence, the
√
statistic ŝijk,T / T hk estimates the average distance between the functions λi and
λj on the interval Ik . Under (C2), it holds that
2
νijk,T

T
n  t 
 t o
σ2 X  t
1
∈ Ik λi
+ λj
.
:= Var(ŝijk,T ) =
T hk t=1
T
T
T

In order to normalize the variance of the statistic ŝijk,T , we scale it by an estimator
2
of νijk,T . In particular, we estimate νijk,T
by
2
ν̂ijk,T

T

σ̂ 2 X  t
=
∈ Ik {Xit + Xjt },
1
T hk t=1
T

where σ̂ 2 is defined as follows: For each country i, let
σ̂i2

PT
=

2
t=2 (Xit − Xit−1 )
P
2 Tt=1 Xit

P
and set σ̂ 2 = |C|−1 i∈C σ̂i2 with C = {` : ` = i or ` = j for some (i, j) ∈ S} denoting
the set of countries that are taken into account by our test. The idea behind the
estimator σ̂i2 is as follows: Since λi is Lipschitz continuous,
Xit − Xit−1

r  
t
= σ λi
(ηit − ηit−1 ) + rit ,
T

where |rit | ≤ C(1 + |ηit−1 |)/T with a sufficiently large constant C. This suggests
P
P
that T −1 Tt=2 (Xit − Xit−1 )2 = 2σ 2 {T −1 Tt=2 λi (t/T )} + op (1). Moreover, since
P
P
T −1 Tt=1 Xit = T −1 Tt=1 λi (t/T ) + op (1), we expect that σ̂i2 = σ 2 + op (1) for any
i and thus σ̂ 2 = σ 2 + op (1). In Lemma S.1 of the Supplementary Material, we
formally show that σ̂ 2 is a consistent estimator of σ 2 under our regularity conditions.

6

Normalizing the statistic ŝijk,T by the estimator ν̂ijk,T yields the expression
ψ̂ijk,T

PT
1( t ∈ Ik )(Xit − Xjt )
ŝijk,T
:=
= PTt=1 tT
,
ν̂ijk,T
σ̂{ t=1 1( T ∈ Ik )(Xit + Xjt )}1/2
(ijk)

which serves as our test statistic of the hypothesis H0
additionally introduce the statistic

. For later reference, we

1/2

PT

0
ψ̂ijk,T

(3.1)

1( Tt ∈ Ik ) σλij ( Tt )(ηit − ηjt )
=
PT
σ̂{ t=1 1( Tt ∈ Ik )(Xit + Xjt )}1/2
t=1

(3.2)
(ijk)

with λij (u) = {λi (u) + λj (u)}/2, which is identical to ψ̂ijk,T under H0

3.2

.

Construction of the test

Our multiscale test is carried out as follows: For a given significance level α ∈ (0, 1)
(ijk)
and each (i, j, k) ∈ M, we reject H0
if
|ψ̂ijk,T | > cijk,T (α),
where cijk,T (α) is the critical value for the (i, j, k)-th test problem. The critical
values cijk,T (α) are chosen such that the familywise error rate (FWER) is controlled
(ijk)
at level α, which is defined as the probability of wrongly rejecting H0
for at least
one (i, j, k). More formally speaking, for a given significance level α ∈ (0, 1), the
FWER is


FWER(α) = P ∃(i, j, k) ∈ M0 : |ψ̂ijk,T | > cijk,T (α)


= 1 − P ∀(i, j, k) ∈ M0 : |ψ̂ijk,T | ≤ cijk,T (α)


=1−P
max |ψ̂ijk,T | ≤ cijk,T (α) ,
(i,j,k)∈M0

(ijk)

where M0 ⊆ M is the set of triples (i, j, k) for which H0
holds true.
There are different ways to construct critical values cijk,T (α) that ensure control
of the FWER at level α. In the traditional approach, the same critical value cT (α) =
cijk,T (α) is used for all (i, j, k). In this case, controlling the FWER at the level α
requires to determine the critical value cT (α) such that
FWER(α) = 1 − P



max
(i,j,k)∈M0

7


|ψ̂ijk,T | ≤ cT (α) ≤ α.

(3.3)

This can be achieved by choosing cT (α) as the (1 − α)-quantile of the statistic
0
|,
Ψ̃T = max |ψ̂ijk,T
(i,j,k)∈M

0
where ψ̂ijk,T
was introduced in (3.2). (Note that both the statistic Ψ̃T and the
quantile cT (α) depend on the dimensionality p of the test problem in general. To
keep the notation simple, we however suppress this dependence throughout the
paper. We use the same convention for all other quantities that are defined in the
sequel.)
A more modern approach assigns different critical values cijk,T (α) to the test
(ijk)
problems (i, j, k). In particular, the critical value for the hypothesis H0
is allowed
to depend on the length hk of the time interval Ik , that is, on the scale of the
test problem. A general approach to construct scale-dependent critical values was
pioneered by Dümbgen and Spokoiny (2001) and has been used in many other studies
since then; cp. for example Rohde (2008), Dümbgen and Walther (2008), Rufibach
and Walther (2010), Schmidt-Hieber et al. (2013), Eckle et al. (2017) and Dunker
et al. (2019). In our context, the approach of Dümbgen and Spokoiny (2001) leads
to the critical values

cijk,T (α) = cT (α, hk ) := bk + qT (α)/ak ,
p
where ak = {log(e/hk )}1/2 / log log(ee /hk ) and bk = 2 log(1/hk ) are scale-dependent
constants and the quantity qT (α) is determined by the following consideration: Since




FWER(α) = P ∃(i, j, k) ∈ M0 : |ψ̂ijk,T | > cT (α, hk )


= 1 − P ∀(i, j, k) ∈ M0 : |ψ̂ijk,T | ≤ cT (α, hk )



= 1 − P ∀(i, j, k) ∈ M0 : ak |ψ̂ijk,T | − bk ≤ qT (α)



=1−P
max ak |ψ̂ijk,T | − bk ≤ qT (α) ,

(3.4)

(i,j,k)∈M0

we need to choose the quantity qT (α) as the (1 − α)-quantile of the statistic
0
| − bk
Ψ̂T = max ak |ψ̂ijk,T



(i,j,k)∈M

in order to ensure control of the FWER at level α. Comparing (3.4) with (3.3),
the current approach can be seen to differ from the traditional one in the following respect: the maximum statistic Ψ̃T is replaced by the rescaled version Ψ̂T
0
which re-weights the individual statistics ψ̂ijk,T
by the scale-dependent constants ak
and bk . As demonstrated above, this translates into scale-dependent critical values
8

cijk,T (α) = cT (α, hk ).
Our theory allows us to work with both the traditional choice cijk,T (α) = cT (α)
and the more modern, scale-dependent choice cijk,T (α) = cT (α, hk ). Since the latter
choice produces a test approach with better theoretical properties in general (cp.
Dümbgen and Spokoiny, 2001), we restrict attention to the critical values cT (α, hk )
in the sequel. There is, however, one complication we need to deal with: As the
quantiles qT (α) are not known in practice, we cannot compute the critical values
cT (α, hk ) exactly in practice but need to approximate them. This can be achieved
as follows: Under appropriate regularity conditions, it can be shown that
1/2

PT

0
ψ̂ijk,T

1( Tt ∈ Ik ) σλij ( Tt )(ηit − ηjt )
=
P
σ̂{ Tt=1 1( Tt ∈ Ik )(Xit + Xjt )}1/2
T
t

X
1
1
∈ Ik {ηit − ηjt }.
≈√
T
2T hk t=1
t=1

A Gaussian version of the statistic displayed in the final line above is given by
φijk,T

T
t

X
1
=√
1
∈ Ik Zit − Zjt ,
T
2T hk t=1

where Zit are independent standard normal random variables for 1 ≤ t ≤ T and
1 ≤ i ≤ n. Hence, the statistic
ΦT = max ak |φijk,T | − bk



(i,j,k)∈M

can be regarded as a Gaussian version of the statistic Ψ̂T . We approximate the
unknown quantile qT (α) by the (1 − α)-quantile qT,Gauss (α) of ΦT , which can be
computed (approximately) by Monte Carlo simulations and can thus be treated as
known.
To summarize, we propose the following procedure to simultaneously test the
(ijk)
hypothesis H0
for all (i, j, k) ∈ M at the significance level α ∈ (0, 1):
(ijk)

For each (i, j, k) ∈ M, reject H0

if |ψ̂ijk,T | > cT,Gauss (α, hk ),

(3.5)

where cT,Gauss (α, hk ) = bk + qT,Gauss (α)/ak with ak = {log(e/hk )}1/2 / log log(ee /hk )
p
and bk = 2 log(1/hk ).

9

3.3

Formal properties of the test

In Theorem A.1 of the Appendix, we prove that under appropriate regularity conditions, the test defined in (3.5) (asymptotically) controls the familywise error rate
FWER(α) for each pre-specified significance level α. As shown in Corollary A.1,
this has the following implication:


P ∀(i, j, k) ∈ M : If |ψ̂ijk,T | > cT,Gauss (α, hk ), then (i, j, k) ∈
/ M0
≥ 1 − α + o(1),
(ijk)

where M0 is the set of triples (i, j, k) ∈ M for which H0
(3.6) can be expressed as follows:

(3.6)

holds true. Verbally,

(ijk)

With (asymptotic) probability at least 1 − α, the null hypothesis H0
(ijk)
violated for all (i, j, k) ∈ M for which the test rejects H0 .

is

(3.7)

In other words:
With (asymptotic) probability at least 1−α, the functions λi and λj differ
(ijk)
on the interval Ik for all (i, j, k) ∈ M for which the test rejects H0 .

(3.8)

Hence, the test allows us to make simultaneous confidence statements (a) about
which pairs of countries (i, j) have different trend functions and (b) about where,
that is, in which time intervals Ik the functions differ.

3.4

Implementation of the test in practice

For a given significance level α ∈ (0, 1), the test procedure defined in (3.5) is implemented as follows in practice:
Step 1. Compute the quantile qT,Gauss (α) by Monte Carlo simulations. Specifically,
draw a large number N (say N = 5000) samples of independent standard
(`)
normal random variables {Zit : 1 ≤ t ≤ T, 1 ≤ i ≤ n} for 1 ≤ ` ≤ N .
(`)
Compute the value ΦT of the Gaussian statistic ΦT for each sample ` and
(`)
calculate the empirical (1 − α)-quantile q̂T,Gauss (α) from the values {ΦT :
1 ≤ ` ≤ N }. Use q̂T,Gauss (α) as an approximation of the quantile qT,Gauss (α).
Step 2. Compute the critical values cT,Gauss (α, hk ) for 1 ≤ k ≤ K based on the
approximation q̂T,Gauss (α).
Step 3. Carry out the test for each (i, j, k) ∈ M and store the test results in the
variable rijk,T = 1(|ψ̂ijk,T | > cT,Gauss (α, hk )) for each (i, j, k) ∈ M, that is,
(ijk)
let rijk,T = 1 if the hypothesis H0
is rejected and rijk,T = 0 otherwise.
10

To graphically present the test results, we produce a plot for each pair of countries
(ijk)
(i, j) ∈ S that shows the intervals Ik for which the test rejects the null H0 , that is,
the intervals in the set Freject (i, j) = {Ik ∈ F : rijk,T = 1}. The plot is designed such
min
(i, j) = {Ik ∈ Freject (i, j) :
that it graphically highlights the subset of intervals Freject
min
(i, j) are
there exists no Ik0 ∈ Freject (i, j) with Ik0 ⊂ Ik }. The elements of Freject
called minimal intervals. By definition, there is no other interval Ik0 in Freject (i, j)
which is a proper subset of a minimal interval Ik . Hence, the minimal intervals can
be regarded as those intervals in Freject (i, j) which are most informative about the
precise location of the differences between the trends λi and λj . In Section 4, we
use the graphical device just described to present the test results of our empirical
application; cp. panels (d) in Figures 3–6.
According to (3.6), we can make the following simultaneous confidence statement
about the intervals in Freject (i, j) for (i, j) ∈ S:
With (asymptotic) probability at least 1 − α, it holds that for every pair
of countries (i, j) ∈ S, the functions λi and λj differ on each interval in
Freject (i, j).

(3.9)

Hence, we can claim with statistical confidence at least 1−α that the functions λi and
λj differ on each time interval which is depicted in the plots of our graphical device.
min
Since Freject
(i, j) ⊆ Freject (i, j) for any (i, j) ∈ S, the confidence statement (3.9)
min
trivially remains to hold true when the sets Freject (i, j) are replaced by Freject
(i, j).

4

Empirical application to COVID-19 data

We now use our test to analyze the outbreak patterns of the COVID-19 epidemic.
We proceed in two steps. In Section 4.1, we assess the finite sample performance
of our test by Monte-Carlo experiments. Specifically, we run a series of experiments which show that the test controls the FWER at level α as predicted by the
theory and that it has good power properties. In Section 4.2, we then apply the
test to a sample of COVID-19 data from different European countries. Our multiscale test is implemented in the R package multiscale, available on GitHub at
https://github.com/marina-khi/multiscale.

4.1

Simulation experiments

We simulate count data X = {Xit : 1 ≤ i ≤ n, 1 ≤ t ≤ T } by drawing the observations Xit independently from a negative binomial distribution with mean λi (t/T )
and variance σ 2 λi (t/T ). By definition, Xit has a negative binomial distribution

11

Plot of the function λ

0

1000

2000

3000

4000

5000

6000

The family of intervals F

0.0

0.2

0.4

0.6

0.8

1.0

0

20

40

u

60

80

100

120

140

days

(a)

(b)

Figure 1: (a) Plot of the function λ; (b) plot of the family of intervals F.

with parameters q and r if P(Xit = m) = Γ(m + r)/(Γ(r)m!)q r (1 − q)m for each
m ∈ N ∪ {0}. Since E[Xit ] = r(1 − q)/q and Var(Xit ) = r(1 − q)/q 2 , we can use the
parametrization q = 1/σ 2 and r = λi (t/T )/(σ 2 − 1) to obtain that E[Xit ] = λi (t/T )
and Var(Xit ) = σ 2 λi (t/T ). With this parametrization, the simulated data follow a
nonparametric regression model of the form
Xit = λi

t
T

r  
t
+ σ λi
ηit ,
T

where the noise variables ηit have zero mean and unit variance. The functions λi
are specified below. The overdispersion parameter is set to σ = 15, which is similar
to the estimate σ̂ = 14.44 obtained in the empirical application of Section 4.2.
Robustness checks with σ = 10 and σ = 20 are provided in the Supplementary
Material.
We consider different values for T and n, in particular, T ∈ {100, 250, 500} and
n ∈ {5, 10, 50}. Note that in the application, we have T = 139 and n = 5. We
let S = {(i, j) : 1 ≤ i < j ≤ n}, that is, we compare all pairs of countries (i, j)
with i < j. Moreover, we choose F to be a family of time intervals Ik with length
hk ∈ {7/T, 14/T, 21/T, 28/T }. Hence, the intervals in F have length either 7, 14,
21 or 28 days (i.e., 1, 2, 3 or 4 weeks). For each length hk , we include all intervals
that start at days t = 1 + 7(j − 1) and t = 4 + 7(j − 1) for j = 1, 2, . . . A graphical
presentation of the family F for T = 139 (as in the application) is given in Figure
1b. All our simulation experiments are based on R = 5000 simulation runs.
In the first part of the simulation study, we examine whether our test controls

12

Table 1: Empirical size of the test for different values of n and T .

T = 100
T = 250
T = 500

n=5

n = 10

n = 50

significance level α
0.01
0.05
0.1

significance level α
0.01
0.05
0.1

significance level α
0.01
0.05
0.1

0.011
0.009
0.010

0.010
0.009
0.008

0.008
0.008
0.007

0.047
0.047
0.044

0.093
0.091
0.083

0.044
0.046
0.048

0.087
0.087
0.093

0.037
0.035
0.035

0.075
0.069
0.077

the FWER as predicted by the theory. To do so, we assume that the hypothesis
(ijk)
H0
holds true for all (i, j, k) under consideration, which implies that λi = λ for
all i. We consider the function
 (10u − 3)2 
+ 1000,
λ(u) = 5000 exp −
2

(4.1)

which is similar in shape to some of the estimated trend curves in the application of
Section 4.2. A plot of the function λ is provided in Figure 1a. To evaluate whether
the test controls the FWER at level α, we compare the empirical size of the test
with the target α. The empirical size is computed as the precentage of simulation
(ijk)
runs in which the test falsely rejects at least one null hypothesis H0 .
The simulation results are reported in Table 1. As can be seen, the empirical size
gives a reasonable approximation to the target α in all scenarios under investigation,
even though the size numbers have a slight downward bias. This bias gets larger as
the number of time series n increases, which reflects the fact that the test problem
becomes more difficult for larger n. Already for n = 5, the number p of hypotheses
to be tested is quite high, in particular, p = 960, 2 680, 5 560 for T = 100, 250, 500.
This number increases to p = 117 600, 328 300, 681 100 when n = 50. Hence, the
dimensionality and thus the complexity of the test problem increases considerably
as n gets larger. On first sight, it may seem astonishing that the downward bias
does not diminish notably as the time series length T increases. This, however,
has a simple explanation: The interval lengths hk remain the same (7, 14, 21 or 28
days) as T increases, which implies that the effective sample size for computing the
test statistics ψ̂ijk,T does not change as well. To summarize, even though slightly
conservative, the test controls the FWER quite accurately in the simulation setting
at hand.
In the second part of the simulation study, we investigate the power properties
of the test. To do so, we assume that λi = λ for all i > 1 and that λ1 6= λ, where
λ is defined in (4.1). Hence, only the first mean function λ1 is different from the
(ijk)
others. This implies that the hypothesis H0
holds true for all (i, j, k) with i > 1
(ijk)
and j > 1, while there is at least one hypothesis H0
with either i = 1 or j = 1
13

7000

Plot of the functions λ1 and λ

Plot of the functions λ1 and λ
λ1(u)
λ(u)

0

0 1000

1000

3000

3000

5000

5000

λ1(u)
λ(u)

0.0

0.2

0.4

0.6

0.8

1.0

0.0

0.2

0.4

u

0.6

0.8

1.0

u

(a) Scenario A

(b) Scenario B

Figure 2: Plot of the functions λ1 (black) and λ (red) in the simulation scenarios A and
B.

that does not hold true. We consider two different simulation scenarios. In Scenario
A, the function λ1 has the form
 (10u − 3)2 
+ 1000
λ1 (u) = 6000 exp −
2
and is plotted together with λ in Figure 2a. As can be seen, the two functions λ1
and λ peak at the same point in time, but the peak of λ1 is higher than that of λ.
In Scenario B, we let
(9u − 3)2 
λ1 (u) = 5000 exp −
+ 1000.
2


Figure 2b shows that the peaks of λ1 and λ have the same height but are reached
at different points in time. To evaluate the power properties of the test in Scenarios
A and B, we compute the percentage of simulation runs where the test (i) correctly
detects differences between λ1 and at least one of the other mean functions and (ii)
does not spuriously detect differences between the other mean functions. Put differently, we calculate the percentage of simulation runs where (i) the set Freject (1, j)
is non-empty at least for one j ∈ {2, . . . , n} and (ii) all other sets Freject (i, j) with
2 ≤ i < j ≤ n are empty. We call this percentage number the (empirical) power of
the test. We thus use the term “power” a bit differently than usual.
The results for Scenario A (see Figure 2a) are presented in Table 2 and those
for Scenario B (see Figure 2b) in Table 3. As can be seen, the test has substantial
power in all the considered simulation settings. It is more powerful in Scenario B
than in Scenario A, which is most presumably due to the fact that the differences
|λ1 (u) − λ(u)| are much larger in Scenario B. Moreover, it is less powerful for larger
14

Table 2: Power of the test for different values of n and T in Scenario A.

T = 100
T = 250
T = 500

n=5

n = 10

n = 50

significance level α
0.01
0.05
0.1

significance level α
0.01
0.05
0.1

significance level α
0.01
0.05
0.1

0.335
0.615
0.736

0.306
0.580
0.738

0.212
0.470
0.636

0.518
0.790
0.905

0.597
0.836
0.917

0.474
0.764
0.884

0.545
0.800
0.890

0.352
0.648
0.799

0.418
0.705
0.830

Table 3: Power of the test for different values of n and T in Scenario B.

T = 100
T = 250
T = 500

n=5

n = 10

n = 50

significance level α
0.01
0.05
0.1

significance level α
0.01
0.05
0.1

significance level α
0.01
0.05
0.1

0.824
0.991
0.997

0.812
0.991
0.995

0.738
0.991
0.996

0.910
0.972
0.973

0.903
0.941
0.949

0.893
0.960
0.961

0.890
0.920
0.923

0.847
0.965
0.969

0.857
0.933
0.932

numbers of time series n, which reflects the fact that the test problem gets more
high-dimensional and thus more difficult as n increases. As one would expect, the
power numbers tend to become larger as the time series length T and the significance
level α increase. In Scenario B (mostly for T = 250 and T = 500), however, the
power numbers drop down a bit as α gets larger. This reverse dependance can be
explained by the way we calculate power: we exclude simulation runs where the test
spuriously detects differences between the trends in countries i and j with i, j > 1.
The number of spurious findings increases as we make the significance level α larger,
which presumably causes the slight drop in power.

4.2

Analysis of COVID-19 data

The COVID-19 pandemic is one of the most pressing issues at present. The first
outbreak occurred in Wuhan, China, in December 2019. On 30 January 2020, the
World Health Organization (WHO) declared that the outbreak constitutes a Public
Health Emergency of International Concern, and on 11 March 2020, the WHO
characterized it as a pandemic. As of 22 July 2020, more than 14.56 million cases of
COVID-19 infections have been reported worldwide, resulting in more than 607 000
deaths.
There are many open questions surrounding the current COVID-19 pandemic. A
question which is particularly relevant for governments and policy makers is whether
the pandemic has developed similarly in different countries or whether there are notable differences. Identifying these differences may give some insight into which
government policies have been more effective in containing the virus than others. In
15

what follows, we use our multiscale test to compare the development of COVID-19 in
several European countries. It is important to emphasize that our test allows to identify differences in the development of the epidemic across countries in a statistically
rigorous way, but it does not tell what causes these differences. By distinguishing
statistically significant differences from artefacts of the sampling noise, the test provides the basis for a further investigation into the causes. Such an investigation,
however, presumably goes beyond a mere statistical analysis.
4.2.1

Data

We analyze data from five European countries: Germany, Italy, Spain, France and
the United Kingdom. For each country i, we observe a time series Xi = {Xit :
1 ≤ t ≤ T }, where Xit is the number of newly confirmed COVID-19 cases in
country i on day t. The data are freely available on the homepage of the European
Center for Disease Prevention and Control (https://www.ecdc.europa.eu) and
were downloaded on 22 July 2020. As already mentioned in the Introduction, we
take the day of the 100th confirmed case in each country as the starting date t = 1,
which is a common way of “normalizing” the data and making them comparable
across countries (cp. Cohen and Kupferschmidt, 2020). The time series length T is
taken to be the minimal number of days for which we have observations for all five
countries. The resulting dataset consists of n = 5 time series, each with T = 139
observations (as of July 22). Some of the time series contain negative values which
we replaced by 0. Overall, this resulted in 6 replacements. Plots of the observed
time series are presented in the upper panels (a) of Figures 3–6.
To interpret the results produced by our multiscale test, we consider the Government Response Index (GRI) from the Oxford COVID-19 Government Response
Tracker (OxCGRT) (Hale et al., 2020b). The GRI measures how severe the actions
are that are taken by a country’s government to contain the virus. It is calculated
based on several common government policies such as school closures and travel restrictions. The GRI ranges from 0 to 100, with 0 corresponding to no response from
the government at all and 100 corresponding to full lockdown, closure of schools
and workplaces, ban on travelling, etc. Detailed information on the collection of
the data for government responses and the methodology for calculating the GRI is
provided in Hale et al. (2020a). Plots of the GRI time series are given in panels (c)
of Figures 3–6.

16

4.2.2

Test results

We assume that the data Xit of each country i in our sample follow the nonparametric trend model
r  
t
t
+ σ λi
ηit ,
Xit = λi
T
T
which was introduced in equation (2.2). The overdispersion parameter σ is estimated
by the procedure described in Section 3.1, which yields the estimate σ̂ = 14.44.
Throughout the section, we set the significance level to α = 0.05 and implement the
multiscale test in exactly the same way as in the simulation study of Section 4.1.
In particular, we let S = {(i, j) : 1 ≤ i < j ≤ 5}, that is, we compare all pairs
of countries (i, j) with i < j, and we choose F to be the family of time intervals
plotted in Figure 1b. Hence, all intervals in F have length either 7, 14, 21 or 28
days.
With the help of our multiscale method, we simultaneously test the null hypo(ijk)
thesis H0
that λi = λj on the interval Ik for each (i, j, k) ∈ M. The results
are presented in Figures 3–6, each figure comparing a specific pair of countries (i, j)
from our sample. For the sake of brevity, we only show the results for the pairwise
comparisons of Germany with each of the four other countries. The remaining figures
can be found in Section S.2 of the Supplementary Material. Each figure splits into
four panels (a)–(d). Panel (a) shows the observed time series for the two countries
i and j that are compared. Panel (b) presents smoothed versions of the time series
from (a), that is, it shows nonparametric kernel estimates (specifically, NadarayaWatson estimates) of the two trend functions λi and λj , where the bandwidth is
set to 7 days and a rectangular kernel is used. Panel (c) displays the Government
Response Index (GRI) of the two countries. Finally, panel (d) presents the results
produced by our test: it depicts in grey the set Freject (i, j) of all the intervals Ik for
(ijk)
min
which the test rejects the null H0 . The minimal intervals in the subset Freject
(i, j)
are highlighted by a black frame. Note that according to (3.6), we can make the
following simultaneous confidence statement about the intervals plotted in panels
(d) of Figures 3–6: we can claim, with confidence of about 95%, that there is a
difference between the functions λi and λj on each of these intervals.
We now have a closer look at the results in Figures 3–6. Figure 3 presents
the comparison of Germany with Italy. The two time series of daily new cases in
panel (a) can be seen to be very similar until approximately day 40. Thereafter,
the German time series appears to trend downwards more strongly than the Italian
one. The smoothed data in panel (b) give a similar visual impression: the kernel
estimates of the German and Italian trend curves λi and λj are very close to each
other until approximately day 40 but then start to differ. It is however not clear

17

Comparison of Germany and Spain

(a) observed new cases per day

(a) observed new cases per day

6000

Comparison of Germany and Italy

Germany
Spain

0

0

2000

2000

4000

6000

Germany
Italy

0

20

40

60

80

100

120

140

0

20

40

60

80

100

120

140

120

140

(b) smoothed curves from (a)

0

0

2000

2000

4000

6000

6000

(b) smoothed curves from (a)

0

20

40

60

80

100

120

140

0

20

60

80

100

80
60
40
20
0

0

20

40

60

80

100

(c) government response index

100

(c) government response index

40

0

20

40

60

80

100

120

140

0

20

40

60

80

100

120

140

NA

(d) minimal intervals produced by our test

NA

(d) minimal intervals produced by our test

0

20

40

60

80

100

120

140

0

days since the hundredth case

20

40

60

80

100

120

140

days since the hundredth case

Figure 3: Test results for the comparison of
Germany and Italy.

Figure 4: Test results for the comparison of
Germany and Spain.

Note: In each figure, panel (a) shows the two observed time series, panel (b) smoothed
versions of the time series, and panel (c) the corresponding Government Response Index
(GRI). Panel (d) depicts the set of intervals Freject (i, j) in grey and the subset of minimal
min (i, j) with a black frame.
intervals Freject

18

Comparison of Germany and United Kingdom

(a) observed new cases per day

(a) observed new cases per day
2000 4000 6000 8000

Comparison of Germany and France

Germany
United Kingdom

0

0

2000

4000

6000

Germany
France

0

20

40

60

80

100

120

140

0

20

40

60

80

100

120

140

120

140

(b) smoothed curves from (a)

0

0

2000

2000

4000

6000

6000

(b) smoothed curves from (a)

0

20

40

60

80

100

120

140

0

20

60

80

100

80
60
40
20
0

0

20

40

60

80

100

(c) government response index

100

(c) government response index

40

0

20

40

60

80

100

120

140

0

20

40

60

80

100

120

140

NA

(d) minimal intervals produced by our test

NA

(d) minimal intervals produced by our test

0

20

40

60

80

100

120

140

0

days since the hundredth case

20

40

60

80

100

120

140

days since the hundredth case

Figure 5: Test results for the comparison of
Germany and France.

Figure 6: Test results for the comparison of
Germany and the UK.

Note: In each figure, panel (a) shows the two observed time series, panel (b) smoothed
versions of the time series, and panel (c) the corresponding Government Response Index
(GRI). Panel (d) depicts the set of intervals Freject (i, j) in grey and the subset of minimal
min (i, j) with a black frame.
intervals Freject

19

whether the differences between the two curve estimates reflect differences between
the underlying trend curves or whether these are mere artefacts of sampling noise.
Our test allows to clarify this issue. Inspecting panel (d), we see that the test detects
significant differences between the trend curves in the time period between day 36
and 91. However, it does not find any significant differences up to day 36. Taken
together, our results provide evidence that the epidemic developed very similarly in
Germany and Italy until a peak was reached around day 40. Thereafter, however,
the German time series exhibits a significantly stronger downward trend than the
Italian one.
Inspecting Figures 4 and 5, a quite different picture arises when comparing Germany with France and Spain. The test detects significant differences between the
German trend and the trends in France and Spain up to (approximately) day 50
but not thereafter. Hence, we find that the time trends evolve differently during
the outbreak of the crisis, but they appear to decrease in more or less the same
fashion after a peak was reached. Finally, the comparison of Germany with the UK
in Figure 6 reveals significant differences between the time trends over essentially
the whole observation window. Inspecting the time series in panel (a), it is quite
obvious that the UK trend evolves differently from the German one after day 40.
However, our test also detects differences between the trends during the onset of the
crisis, which is not obvious from the time series plot in panel (a).
4.2.3

Discussion

Having identified significant differences between the epidemic trends in the five countries under consideration, one may ask next what are the causes of these differences.
As already mentioned at the beginning of this section, this question cannot be answered by our test. Rather, a further analysis which presumably goes beyond pure
statistics is needed to shed some light on it. We here do not attempt to provide
any answers. We merely discuss some observations which become apparent upon
considering our test results in the light of the Government Response Index (GRI).
For reasons of brevity, we focus on the comparison of Germany with Italy and Spain
in Figures 3 and 4.
According to our test results in Figure 4, there are significant differences between
the trends in Germany and Spain during the onset of the epidemic up to about day
50, with Spain having more new cases of infections than Germany on most days.
After day 50, the trends become quite similar and start to decrease at approximately
the same rate. This may be due to the fact that Spain in general introduced more
severe measures of lockdown than Germany (as can be seen upon inspecting the GRI
in panel (c) of Figure 4), which may have helped to battle the spread of infection.

20

However, a much more thorough analysis is of course needed to find out whether
this is indeed the case or whether other factors were mainly responsible.
Turning to the comparison of Germany and Italy, we found that the German
trend drops down significantly faster than the Italian one after approximately day
40. Interestingly, the GRI of Italy almost always lies above that of Germany. Hence,
even though Italy has in general taken more severe and restrictive measures against
the virus than Germany, it appears that the virus could be contained better in
Germany (in the sense that the trend of daily new cases went down significantly
faster in Germany than in Italy). This suggests that there are indeed important
factors besides the level of government response to the pandemic which substantially
influence the trend of new COVID-19 cases.
This brief discussion already indicates that it is extremely difficult to determine
the exact causes of the differences in epidemic trends across countries. Since even
similar countries such as those in our sample differ in a variety of aspects that
are relevant for the spread of the virus, it is very challenging to pin down these
causes. One issue that is often discussed in the context of cross-country comparisons
are country-specific strategies to test for the coronavirus. The argument is that
differences between epidemic trends may be spuriously produced by country-specific
test procedures.
Even though we can of course not fully exclude this possibility, our test results are
presumably not driven by different test regimes in the countries under consideration.
To see this, we consider again the comparison of Germany and Italy: The test
regimes in these two countries are arguably quite different. Germany is often cited
as the country that employed early, widespread testing with more than 100 000 tests
per week even in the beginning of the pandemic (Cohen and Kupferschmidt, 2020),
while testing in Italy became widespread only in the late stages of the pandemic.
Nevertheless, visual inspection of the raw and smoothed data in panels (a) and (b) of
Figure 3 suggest that the underlying time trends are very similar up to day 36. This
is confirmed by our multiscale test which does not find any significant differences
before that day. Hence, the different test regimes in Germany and Italy towards
the beginning of the pandemic do not appear to have an overly strong effect and
to produce spurious differences between the time trends. This suggests that the
differences detected by our multiscale test indeed reflect differences in the way the
virus spread in Germany and Italy rather than being mere artefacts of different test
regimes.

21

A

Appendix

In what follows, we state and prove the main theoretical results on the multiscale
test developed in Section 3. Throughout the Appendix, we let C be a generic
positive constant that may take a different value on each occurrence. Unless stated
differently, C depends neither on the time series length T nor on the dimension p
of the test problem. We further use the symbols hmin := min1≤k≤K hk and hmax :=
max1≤k≤K hk to denote the smallest and largest interval length in the family F.
Theorem A.1. Let (C1) and (C2) be satisfied. Moreover, assume that (i) hmax =
o(1/ log T ), (ii) hmin ≥ CT −b for some b ∈ (0, 1), and (iii) p = O(T (θ/2)(1−b)−(1+δ) )
for some small δ > 0. Then for any given α ∈ (0, 1),


FWER(α) := P ∃(i, j, k) ∈ M0 : |ψ̂ijk,T | > cT,Gauss (α, hk ) ≤ α + o(1),
(ijk)

where M0 ⊆ M is the set of all (i, j, k) ∈ M for which H0

holds true.

According to Theorem A.1, the multiscale test asymptotically controls the FWER
at level α under conditions (C1)–(C2) and the restrictions (i)–(iii) on hmin , hmax and
p. Restriction (i) allows the maximal interval length hmax to converge to zero very
slowly, which means that hmax can be picked very large in practice. According to
restriction (ii), the minimal interval length hmin can be chosen to go to zero as any
polynomial T −b with some b ∈ (0, 1). Restriction (iii) allows the dimension p of the
test problem to grow polynomially in T . Specifically, p may grow at most as the
polynomial T γ with γ = (θ/2)(1 − b) − (1 + δ). As one can see, the exponent γ
depends on the number of error moments θ defined in (C2) and the parameter b that
specifies the minimal interval length hmin . In particular, for any given b ∈ (0, 1),
the exponent γ gets larger as θ increases. Hence, the larger the number of error
moments θ, the faster p may grow in comparison to T . In the extreme case where
all error moments exist, that is, where θ can be made as large as desired, p may
grow as any polynomial of T , no matter how we pick b ∈ (0, 1). Thus, if the error
terms have sufficiently many moments, the dimension p can be extremely large in
comparison to T and the minimal interval length hmin can be chosen very small.
The following corollary is an immediate consequence of Theorem A.1. It provides
the theoretical justification needed to make simultaneous confidence statements of
the form (3.7)–(3.9).
Corollary A.1. Under the conditions of Theorem A.1,




P ∀(i, j, k) ∈ M : If |ψ̂ijk,T | > cT,Gauss (α, hk ), then (i, j, k) ∈
/ M0 ≥ 1 − α + o(1)
for any given α ∈ (0, 1).
22

Proof of Theorem A.1. The proof proceeds in several steps.
0
0
Step 1. Let Ψ̂T = max(i,j,k)∈M ak (|ψ̂ijk,T
| − bk ) with ψ̂ijk,T
introduced in (3.2) and
0
define ΨT = max(i,j,k)∈M ak (|ψijk,T | − bk ) with

0
ψijk,T

T
t

X
1
1
∈ Ik (ηit − ηjt ).
=√
T
2T hk t=1

To start with, we prove that
Ψ̂T − ΨT = op (rT ),

(A.1)

where {rT } is any null sequence that converges more slowly to zero than ρT =
√
√
√
log T {log p/ T hmin + hmax log p}, that is, ρT /rT → 0 as T → ∞. Since the proof
of (A.1) is rather technical and lengthy, the details are provided in the Supplementary Material.
Step 2. We next prove that


sup P ΨT ≤ q − P ΦT ≤ q = o(1).

(A.2)

q∈R

To do so, we rewrite the statistics ΨT and ΦT as follows: Define
(ijk)
Vt

=

(ijk)
Vt,T

r
:=


t
T
∈ Ik (ηit − ηjt )
1
2T hk T

(ijk)

for (i, j, k) ∈ M and let Vt = (Vt
(ijk)
dom vector with the entries Vt
.
P
(ijk)
T
and thus
T −1/2 t=1 Vt

: (i, j, k) ∈ M) be the p-dimensional ran0
With this notation, we get that ψijk,T
=

0
ΨT = max ak |ψijk,T
| − bk



(i,j,k)∈M

T
o
n 1 X
(ijk)
= max ak √
Vt
− bk .
(i,j,k)∈M
T t=1

Analogously, we define
(ijk)
Wt

=

(ijk)
Wt,T

r
:=

t

T
1
∈ Ik (Zit − Zjt )
2T hk T
(ijk)

with Zit i.i.d. standard normal and let Wt = (Wt
: (i, j, k) ∈ M). The vector
Wt is a Gaussian version of Vt with the same mean and variance. In particular,
E[Wt ] = E[Vt ] = 0 and E[Wt Wt> ] = E[Vt Vt> ]. Similarly as before, we can write
23

φijk,T = T −1/2

(ijk)

PT

t=1

Wt

and

ΦT = max ak |φijk,T | − bk



(i,j,k)∈M

T
o
n 1 X
(ijk)
Wt
− bk .
= max ak √
(i,j,k)∈M
T t=1

For any q ∈ R, it holds that
T

n 1 X
o


(ijk)
P ΨT ≤ q = P max ak √
Vt
− bk ≤ q
(i,j,k)∈M
T t=1
T
 1 X

(ijk)
=P √
Vt
≤ cijk (q) for all (i, j, k) ∈ M
T t=1
T

 1 X
=P √
Vt ≤ c(q) ,
T t=1

where c(q) = (cijk (q) : (i, j, k) ∈ M) is the Rp -vector with the entries cijk (q) =
q/ak + bk , we use the notation |v| = (|v1 |, . . . , |vp |)> for vectors v ∈ Rp and the
inequality v ≤ w is to be understood componentwise for v, w ∈ Rp . Analogously, we
have
T
 1 X


P ΦT ≤ q = P √
Wt ≤ c(q) .
T t=1
With this notation at hand, we can make use of Proposition 2.1 from Chernozhukov
et al. (2017). In our context, this proposition can be stated as follows:
Proposition A.1. Assume that
(a) T −1

PT

t=1

PT
−1

(ijk) 2

E(Vt

) ≥ δ > 0 for all (i, j, k) ∈ M.

(ijk)

(b) T
|2+r ] ≤ BTr for all (i, j, k) ∈ M and r = 1, 2, where BT ≥ 1
t=1 E[|Vt
are constants that may tend to infinity as T → ∞.
(ijk)

(c) E[{max(i,j,k)∈M |Vt

|/BT }θ ] ≤ 2 for all t and some θ > 4.

Then
T
T
 1 X

 1 X

sup P √
Vt ≤ c − P √
Wt ≤ c
T t=1
T t=1
c∈Rp
n B 2 log7 (pT ) 1/6  B 2 log3 (pT ) 1/3 o
T
T
≤C
+
,
T
T 1−2/θ

where C depends only on δ and θ.

24

(A.3)

It is straightforward to verify that assumptions (a)–(c) are satisfied under the
conditions of Theorem A.1 for sufficiently large T , where BT can be chosen as
−1/2
BT = Cp1/θ hmin with C sufficiently large. Moreover, it can be shown that the
right-hand side of (A.3) is o(1) for this choice of BT . Hence, Proposition A.1 yields
that
T
T

 1 X

 1 X
Vt ≤ c − P √
Wt ≤ c = o(1),
sup P √
T t=1
T t=1
c∈Rp
which in turn implies (A.2).
Step 3. With the help of (A.1) and (A.2), we now show that


sup P Ψ̂T ≤ q − P ΦT ≤ q = o(1).

(A.4)

q∈R

To start with, the above supremum can be bounded by


sup P Ψ̂T ≤ q − P ΦT ≤ q
q∈R




− P ΦT ≤ q
= sup P ΨT ≤ q + ΨT − Ψ̂T
q∈R

n 

≤ sup max P ΨT ≤ q + ΨT − Ψ̂T − P ΦT ≤ q ,
q∈R


o
P ΨT ≤ q − ΨT − Ψ̂T − P ΦT ≤ q



n 

≤ sup max P ΨT ≤ q + rT − P ΦT ≤ q + P ΨT − Ψ̂T > rT ,
q∈R

o



P ΨT ≤ q − rT − P ΦT ≤ q + P ΨT − Ψ̂T > rT





≤ max sup P ΨT ≤ q + (−1)` rT − P ΦT ≤ q + P ΨT − Ψ̂T > rT
`=0,1 q∈R



`
(A.5)
= max sup P ΨT ≤ q + (−1) rT − P ΦT ≤ q + o(1),
`=0,1 q∈R

where the last line is by (A.1). Moreover, for ` = 0, 1,


`




sup P ΨT ≤ q + (−1) rT − P ΦT ≤ q
q∈R




≤ sup P ΨT ≤ q + (−1)` rT − P ΦT ≤ q + (−1)` rT
q∈R



+ sup P ΦT ≤ q + (−1)` rT − P ΦT ≤ q
q∈R



= sup P ΦT ≤ q + (−1)` rT − P ΦT ≤ q + o(1),

(A.6)

q∈R

the last line following from (A.2). Finally, by Nazarov’s inequality (cp. Nazarov,
25

2003 and Lemma A.1 in Chernozhukov et al., 2017), we have that for ` = 0, 1,


`



sup P ΦT ≤ q + (−1) rT − P ΦT ≤ q



q∈R
T
T
 1 X

 1 X

`
= sup P √
Wt ≤ c(q + (−1) rT ) − P √
Wt ≤ c(q)
T t=1
T t=1
q∈R
p
(A.7)
≤ CrT log(2p),

where C is a constant that depends only on the parameter δ defined in condition
(a) of Proposition A.1. Inserting (A.6) and (A.7) into equation (A.5) completes the
proof of (A.4).
Step 4. By definition of the quantile qT,Gauss (α), it holds that P(ΦT ≤ qT,Gauss (α)) ≥
1 − α. As shown in the Supplementary Material, we even have that
P(ΦT ≤ qT,Gauss (α)) = 1 − α

(A.8)

for any α ∈ (0, 1). From this and (A.4), it immediately follows that

P Ψ̂T ≤ qT,Gauss (α) = 1 − α + o(1),

(A.9)

which in turn implies that


FWER(α) = P ∃(i, j, k) ∈ M0 : |ψ̂ijk,T | > cT,Gauss (α, hk )



=P
max ak |ψ̂ijk,T | − bk > qT,Gauss (α)
(i,j,k)∈M0



0
=P
max ak |ψ̂ijk,T
| − bk > qT,Gauss (α)
(i,j,k)∈M0



0
≤ P max ak |ψ̂ijk,T
| − bk > qT,Gauss (α)
(i,j,k)∈M

= P Ψ̂T > qT,Gauss (α) = α + o(1).
This completes the proof of Theorem A.1.
Proof of Corollary A.1. By Theorem A.1,
1 − α + o(1) ≤ 1 − FWER(α)


= P @(i, j, k) ∈ M0 : |ψ̂ijk,T | > cT,Gauss (α, hk )


/ M0 ,
= P ∀(i, j, k) ∈ M : If |ψ̂ijk,T | > cT,Gauss (α, hk ), then (i, j, k) ∈
which gives the statement of Corollary A.1.
26

Acknowledgements
The authors gratefully acknowledge financial support by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation), grant number 430668955.

References
Chen, L. and Wu, W. B. (2019). Testing for trends in high-dimensional time series.
Journal of the American Statistical Association, 114 869–881.
Chernozhukov, V., Chetverikov, D. and Kato, K. (2017). Central limit theorems
and bootstrap in high dimensions. Annals of Probability, 45 2309–2352.
Cohen, J. and Kupferschmidt, K. (2020). Countries test tactics in ‘war’ against
COVID-19. Science, 367 1287–1288.
Cox, D. R. (1983). Some remarks on overdispersion. Biometrika, 70 269–274.
De Salazar, P. M., Niehus, R., Taylor, A., Buckee, C. and Lipsitch, M. (2020).
Using predicted imports of 2019-nCoV cases to determine locations that may not be
identifying all imported cases. medRxiv.
Degras, D., Xu, Z., Zhang, T. and Wu, W. B. (2012). Testing for parallelism among
trends in multiple time series. IEEE Transactions on Signal Processing, 60 1087–1097.
Delgado, M. A. (1993). Testing the equality of nonparametric regression curves. Statistics & Probability Letters, 17 199–204.
Dümbgen, L. and Spokoiny, V. G. (2001). Multiscale testing of qualitative hypotheses.
Annals of Statistics, 29 124–152.
Dümbgen, L. and Walther, G. (2008). Multiscale inference about a density. Annals of
Statistics, 36 1758–1785.
Dunker, F., Eckle, K., Proksch, K. and Schmidt-Hieber, J. (2019). Tests for
qualitative features in the random coefficients model. Electronic Journal of Statistics,
13 2257–2306.
Eckle, K., Bissantz, N. and Dette, H. (2017). Multiscale inference for multivariate
deconvolution. Electronic Journal of Statistics, 11 4179–4219.
Efron, B. (1986). Double exponential families and their use in generalized linear regression. Journal of the American Statistical Association, 81 709–721.
Fryzlewicz, P., Sapatinas, T. and Subba Rao, S. (2006). A Haar-Fisz technique for
locally stationary volatility estimation. Biometrika, 93 687–704.
Fryzlewicz, P., Sapatinas, T. and Subba Rao, S. (2008). Normalized least-squares
estimation in time-varying ARCH models. Annals of Statistics, 36 742–786.
Hafner, C. M. and Linton, O. (2010). Efficient estimation of a multivariate multiplicative volatility model. Journal of Econometrics, 159 55–73.

27

Hale, T., Petherick, A., Phillips, T. and Webster, S. (2020a). Variation in government responses to COVID-19. Blavatnik school of government working paper, 31.
Hale, T., Webster, S., Petherick, A., Phillips, T. and Kira, B. (2020b). Oxford
COVID-19 government response tracker. Blavatnik school of government. http://www.
bsg.ox.ac.uk/covidtracker.
Hall, P. and Hart, J. D. (1990). Bootstrap test for difference between means in
nonparametric regression. Journal of the American Statistical Association, 85 1039–
1049.
Härdle, W. and Marron, J. S. (1990). Semiparametric comparison of regression curves.
Annals of Statistics, 18 63–89.
Hidalgo, J. and Lee, J. (2014). A CUSUM test for common trends in large heterogeneous panels. In Essays in Honor of Peter C. B. Phillips. Emerald Group Publishing
Limited, 303–345.
King, E. C., Hart, J. D. and Wehrly, T. E. (1991). Testing the equality of regression
curves using linear smoothers. Statistics & Probability Letters, 12 239–247.
Kulasekera, K. B. (1995). Comparison of regression curves using quasi-residuals. Journal of the American Statistical Association, 90 1085–1093.
Lavergne, P. (2001). An equality test across nonparametric regressions. Journal of
Econometrics, 103 307–344.
McCullagh, P. and Nelder, J. (1989). Generalized linear models. Chapman and Hall.
Mikosch, T. and Stărică, C. (2000). Is it really long memory we see in financial
returns? In Extremes and Integrated Risk Management (P. Embrechts, ed.). 149–168.
Mikosch, T. and Stărică, C. (2004). Non-stationarities in financial time series, the
long-range dependence, and IGARCH effects. The Review of Economics and Statistics,
86 378–390.
Munk, A. and Dette, H. (1998). Nonparametric comparison of several regression functions: exact and asymptotic theory. Annals of Statistics, 26 2339–2368.
Nazarov, F. (2003). On the maximal perimeter of a convex set in Rn with respect to
a Gaussian measure. In Geometric Aspects of Functional Analysis, vol. 1807 of Lecture
Notes in Mathematics. Springer, 169–187.
Neumeyer, N. and Dette, H. (2003). Nonparametric comparison of regression curves:
an empirical process approach. Annals of Statistics, 31 880–920.
Pardo-Fernández, J. C., Van Keilegom, I. and González-Manteiga, W. (2007).
Testing for the equality of k regression curves. Statistica Sinica, 17 1115–1137.
Park, C., Vaughan, A., Hannig, J. and Kang, K.-H. (2009). SiZer analysis for the
comparison of time series. Journal of Statistical Planning and Inference, 139 3974–3988.
Pellis, L., Scarabel, F., Stage, H. B., Overton, C. E., Chappell, L. H., Lyth-

28

goe, K. A., Fearon, E., Bennett, E., Curran-Sebastian, J., Das, R. et al.
(2020). Challenges in control of Covid-19: short doubling time and long delay to effect
of interventions. arXiv:2004.00117.
Robinson, P. M. (1989). Nonparametric estimation of time-varying parameters. In
Statistical Analysis and Forecasting of Economic Structural Change (P. Hackl, ed.).
Springer, 253–264.
Rohde, A. (2008). Adaptive goodness-of-fit tests based on signed ranks. Annals of
Statistics, 36 1346–1374.
Rufibach, K. and Walther, G. (2010). The block criterion for multiscale inference
about a density, with applications to other multiscale problems. Journal of Computational and Graphical Statistics, 19 175–190.
Schmidt-Hieber, J., Munk, A. and Dümbgen, L. (2013). Multiscale methods for shape
constraints in deconvolution: confidence statements for qualitative features. Annals of
Statistics, 41 1299–1328.
Tobı́as, A., Valls, J., Satorra, P. and Tebé, C. (2020). COVID19-Tracker: A shiny
app to produce comprehensive data visualization for SARS-CoV-2 epidemic in Spain.
medRxiv.
Young, S. G. and Bowman, A. W. (1995). Nonparametric analysis of covariance.
Biometrics, 51 920–931.
Zhang, Y., Su, L. and Phillips, P. C. B. (2012). Testing for common trends in semiparametric panel data models with fixed effects. The Econometrics Journal, 15 56–100.

29

S

Supplementary Material

S.1

Technical details

In what follows, we provide the technical details omitted in the Appendix. To start
with, we prove the following auxiliary lemma.
Lemma S.1. Under the conditions of Theorem A.1, it holds that
σ̂ 2 − σ 2 = Op

r log p 
T

.
PT

−

T
T
 (1)
1X
σ2 X  t 
(5)
(Xit − Xit−1 )2 =
λi
(ηit − ηit−1 )2 + Ri,T + . . . + Ri,T ,
T t=2
T t=2
T

(S.1)

Proof of Lemma S.1. By definition, σ̂ 2 = |C|−1
P
Xit−1 )2 }{2 Tt=1 Xit }−1 . It holds that

P

i∈C

σ̂i2 and σ̂i2 = {

t=2 (Xit

where
(1)
Ri,T

(2)

Ri,T

(3)

T
 t − 1 r  t 
2σ X   t 
λi
λi
− λi
(ηit − ηit−1 )
=
T t=2
T
T
T
r   r 
r  
T
2σ 2 X 
t
t − 1 
t
− λi
ηit−1 (ηit − ηit−1 )
=
λi
λi
T t=2
T
T
T

Ri,T =
(4)
Ri,T

(5)

Ri,T

T
 t − 1 2
1 X  t 
λi
− λi
T t=2
T
T

T
 t − 1 r  t  r  t − 1 
2σ X   t 
λi
− λi
λi
− λi
ηit−1
=
T t=2
T
T
T
T
r   r 
T
σ2 X 
t
t − 1 2 2
=
λi
− λi
ηit−1 .
T t=2
T
T

With the help of an exponential inequality and standard arguments, it can be shown
that
T
r log p 
1 X  t 
g(ηit , ηit−1 ) − Eg(ηit , ηit−1 ) = Op
,
max
wi
i∈C T
T
T
t=2
where we let g(x, y) = x, g(x, y) = y, g(x, y) = |x|, g(x, y) = |y|, g(x, y) = x2 ,
g(x, y) = y 2 or g(x, y) = xy, and wi (t/T ) are deterministic weights with the property
that |wi (t/T )| ≤ wmax < ∞ for all i, t and T and some positive constant wmax . Using

30

this uniform convergence result along with conditions (C1) and (C2), we obtain that
T
T
r log p 
2 X t
1 X t
2
λi
(ηit − ηit−1 ) −
λi
= Op
max
i∈C T
T
T t=1
T
T
t=2

and
(`)

max max |Ri,T | = Op (T −1 ).

1≤`≤5 i∈C

Applying these two statements to (S.1), we can infer that
T
T
r log p 
1X
2σ 2 X  t 
2
max
(Xit − Xit−1 ) −
λi
= Op
.
i∈C T
T t=1
T
T
t=2

(S.2)

By similar but simpler arguments, we additionally get that
T
T
r log p 
1X
1 X t
max
= Op
.
Xit −
λi
i∈C T
T
T
T
t=1
t=1

From (S.2) and (S.3), it follows that maxi∈C |σ̂i2 − σ 2 | = Op (
p
turn implies that |σ̂ 2 − σ 2 | = Op ( log p/T ) as well.

(S.3)

p
log p/T ), which in

Proof of (A.1). Since
0
0
Ψ̂T − ΨT ≤ max ak ψ̂ijk,T
− ψijk,T
(i,j,k)∈M

0
0
≤ max ak max ψ̂ijk,T
− ψijk,T
1≤k≤K
(i,j,k)∈M
p
0
0
− ψijk,T
,
≤ C log T max ψ̂ijk,T
(i,j,k)∈M

it suffices to prove that
max
(i,j,k)∈M

0
ψ̂ijk,T

−

0
ψijk,T

= op



√

rT 
.
log T

0
To start with, we reformulate ψ̂ijk,T
as
0
∗
ψ̂ijk,T
= ψ̂ijk,T
+

where

σ

1/2 t
t
t=1 1( T ∈ Ik )λij ( T )(ηit − ηjt )
.
P
{ Tt=1 1( Tt ∈ Ik )(Xit + Xjt )}1/2

PT
∗
ψ̂ijk,T

=

σ̂


∗
− 1 ψ̂ijk,T
,

31

(S.4)

With this notation, we can establish the bound
max
(i,j,k)∈M

0
0
− ψijk,T
≤ max
ψ̂ijk,T

(i,j,k)∈M

0
∗
− ψijk,T
ψ̂ijk,T

σ
−1
σ̂
σ
−1
+
σ̂
+

max
(i,j,k)∈M

max
(i,j,k)∈M

∗
0
ψ̂ijk,T
− ψijk,T
0
ψijk,T
,

which shows that (S.4) is implied by the three statements
max
(i,j,k)∈M

∗
ψ̂ijk,T

−

max
(i,j,k)∈M

0
ψijk,T
0
ψijk,T

σ̂ 2 − σ 2


 log p
p
= Op √
+ hmax log p
T hmin
p

= Op log p
r log p 
.
= Op
T

(S.5)
(S.6)
(S.7)

Since (S.7) has already been verified in Lemma S.1, it remains to prove the statements (S.5) and (S.6).
We start with the proof of (S.6). Applying an exponential inequality along with
standard arguments yields that
max max √
i∈C 1≤k≤K

T
 t
p

1 X t
1
∈ Ik wi
ηit = Op
log p ,
T
T
T hk t=1

(S.8)

where wi (t/T ) are general deterministic weights with the property that |wi (t/T )| ≤
wmax < ∞ for all i, t and T and some positive constant wmax . This immediately
implies (S.6).
We next turn to the proof of (S.5). As the functions λi are uniformly Lipschitz
continuous by (C1), it can be shown that
Z
T
 t
C
1
1 X t
max max
1
∈ Ik λi
−
λi (w)dw ≤
.
i∈C 1≤k≤K T hk
T
T
hk w∈Ik
T hmin
t=1

(S.9)

From this, the uniform convergence result (S.8) and condition (C1), we can infer
that
max
(i,j,k)∈M

T

1 X t
1
∈ Ik (Xit + Xjt )
T hk t=1
T
Z
r log p 

1
−
λi (w) + λj (w) dw = Op
hk w∈Ik
T hmin

32

(S.10)

and
max
(i,j,k)∈M

T
 1/2  t 
1 X t
√
1
∈ Ik λij
(ηit − ηjt )
T
T
T hk t=1
R
T
t

n
λ (w)dw o1/2 1 X
w∈Ik ij
√
−
1
∈ Ik (ηit − ηjt )
hk
T
T hk t=1


p
= Op hmax log p .

(S.11)

The claim (S.5) follows from (S.10) and (S.11) along with straightforward calculations.
Proof of (A.8). The proof is by contradiction. Suppose that (A.8) does not hold
true, that is, P(ΦT ≤ qT,Gauss (α)) = 1 − α + ξ for some ξ > 0. By Nazarov’s
inequality,
p


P ΦT ≤ qT,Gauss (α) − P ΦT ≤ qT,Gauss (α) − η ≤ Cη log(2p)
for any η > 0 with C depending only on the parameter δ specified in condition (a)
of Proposition A.1. Hence,
p


P ΦT ≤ qT,Gauss (α) − η ≥ P ΦT ≤ qT,Gauss (α) − Cη log(2p)
p
= 1 − α + ξ − Cη log(2p) > 1 − α
for η > 0 sufficiently small. This contradicts the definition of the quantile qT,Gauss (α)
according to which qT,Gauss (α) = inf q∈R {P(ΦT ≤ q) ≥ 1 − α}.

33

S.2

Additional graphs for Section 4.2

Here, we provide the pairwise comparisons between Italy, France, Spain and the UK
that were omitted in Section 4.2. The plots have the same format as Figures 3–6.
Comparison of United Kingdom and Italy

(a) observed new cases per day

(a) observed new cases per day
2000 4000 6000 8000

Comparison of France and Italy

United Kingdom
Italy

0

0

2000

4000

6000

France
Italy

0

20

40

60

80

100

120

140

0

20

40

60

80

100

120

140

120

140

(b) smoothed curves from (a)

0

0

2000

2000

4000

6000

6000

(b) smoothed curves from (a)

0

20

40

60

80

100

120

140

0

20

60

80

100

80
60
40
20
0

0

20

40

60

80

100

(c) government response index

100

(c) government response index

40

0

20

40

60

80

100

120

140

0

20

40

60

80

100

120

140

NA

(d) minimal intervals produced by our test

NA

(d) minimal intervals produced by our test

0

20

40

60

80

100

120

140

0

days since the hundredth case

20

40

60

80

100

120

140

days since the hundredth case

Figure S.1: Test results for the comparison
of France and Italy.

34

Figure S.2: Test results for the comparison
of the UK and Italy.

Comparison of Spain and Italy

Comparison of Spain and United Kingdom

(a) observed new cases per day

(a) observed new cases per day

2000
0

0

2000

6000

Spain
United Kingdom

6000

Spain
Italy

0

20

40

60

80

100

120

140

0

20

40

60

80

100

120

140

120

140

2000
0

0

2000

6000

(b) smoothed curves from (a)

6000

(b) smoothed curves from (a)

0

20

40

60

80

100

120

140

0

20

60

80

100

80
60
40
20
0

0

20

40

60

80

100

(c) government response index

100

(c) government response index

40

0

20

40

60

80

100

120

140

0

20

40

60

80

100

120

140

NA

(d) minimal intervals produced by our test

NA

(d) minimal intervals produced by our test

0

20

40

60

80

100

120

140

0

days since the hundredth case

20

40

60

80

100

120

140

days since the hundredth case

Figure S.3: Test results for the comparison
of Spain and Italy.

35

Figure S.4: Test results for the comparison
of Spain and the UK.

Comparison of France and United Kingdom

(a) observed new cases per day

(a) observed new cases per day
2000 4000 6000 8000

Comparison of Spain and France

France
United Kingdom

0

0

2000

6000

Spain
France

0

20

40

60

80

100

120

140

0

20

40

60

80

100

120

140

120

140

(b) smoothed curves from (a)

0

0

2000

2000

6000

6000

(b) smoothed curves from (a)

0

20

40

60

80

100

120

140

0

20

60

80

100

80
60
40
20
0

0

20

40

60

80

100

(c) government response index

100

(c) government response index

40

0

20

40

60

80

100

120

140

0

20

40

60

80

100

120

140

NA

(d) minimal intervals produced by our test

NA

(d) minimal intervals produced by our test

0

20

40

60

80

100

120

140

0

days since the hundredth case

20

40

60

80

100

120

140

days since the hundredth case

Figure S.5: Test results for the comparison
of Spain and France.

36

Figure S.6: Test results for the comparison
of France and the UK.

S.3

Robustness checks for Section 4.1

In what follows, we supplement the simulation experiments of Section 4.1 by some
robustness checks. Specifically, we repeat the experiments with different values of
the overdispersion parameter σ. The larger we choose σ, the more noise we put on
top of the time trend, that is, on top of the underlying signal. Hence, by varying σ,
we can assess how sensitive our test is to changes in the noise-to-signal ratio. We
first repeat the size simulations for σ = 10 and σ = 20. The results are presented
in Tables S.1 and S.2, respectively. As can be seen, the empirical size numbers are
very similar to those for σ = 15 in Table 1. We next rerun the power simulations for
σ = 10 and σ = 20, where we consider the two Scenarios A and B as in Section 4.1.
The results can be found in Tables S.3–S.6. They show that the test is much more
powerful for σ = 10 than for σ = 20. This is what one would expect, since a higher
value of σ corresponds to a higher noise-to-signal ratio. In particular, the higher
σ, the more noisy the data, and thus the more difficult it is to identify differences
between the trend curves. Nevertheless, even in the very noisy case with σ = 20,
our test has quite some power, which tends to increase swiftly as T gets larger.
Table S.1: Empirical size of the test for σ = 10.

T = 100
T = 250
T = 500

n=5

n = 10

n = 50

significance level α
0.01
0.05
0.1

significance level α
0.01
0.05
0.1

significance level α
0.01
0.05
0.1

0.009
0.011
0.009

0.008
0.010
0.013

0.005
0.009
0.010

0.043
0.047
0.052

0.085
0.095
0.101

0.039
0.050
0.049

0.075
0.094
0.101

0.023
0.039
0.039

0.055
0.079
0.084

Table S.2: Empirical size of the test for σ = 20.

T = 100
T = 250
T = 500

n=5

n = 10

n = 50

significance level α
0.01
0.05
0.1

significance level α
0.01
0.05
0.1

significance level α
0.01
0.05
0.1

0.011
0.009
0.008

0.010
0.008
0.006

0.009
0.006
0.006

0.050
0.047
0.038

0.094
0.088
0.081

37

0.047
0.044
0.039

0.092
0.085
0.079

0.034
0.032
0.025

0.070
0.062
0.060

Table S.3: Power of the test in Scenario A for σ = 10.

T = 100
T = 250
T = 500

n=5

n = 10

n = 50

significance level α
0.01
0.05
0.1

significance level α
0.01
0.05
0.1

significance level α
0.01
0.05
0.1

0.836
0.986
0.996

0.833
0.984
0.994

0.777
0.980
0.992

0.915
0.971
0.975

0.911
0.938
0.946

0.903
0.956
0.965

0.898
0.918
0.927

0.874
0.961
0.963

0.882
0.924
0.918

Table S.4: Power of the test in Scenario A for σ = 20.

T = 100
T = 250
T = 500

n=5

n = 10

n = 50

significance level α
0.01
0.05
0.1

significance level α
0.01
0.05
0.1

significance level α
0.01
0.05
0.1

0.144
0.244
0.296

0.115
0.204
0.273

0.048
0.133
0.175

0.275
0.434
0.563

0.352
0.538
0.662

0.231
0.403
0.511

0.304
0.486
0.603

0.120
0.247
0.338

0.163
0.305
0.433

Table S.5: Power of the test in Scenario B for σ = 10.

T = 100
T = 250
T = 500

n=5

n = 10

n = 50

significance level α
0.01
0.05
0.1

significance level α
0.01
0.05
0.1

significance level α
0.01
0.05
0.1

0.991
0.993
0.996

0.994
0.993
0.993

0.994
0.991
0.993

0.973
0.969
0.976

0.946
0.941
0.948

0.970
0.959
0.966

0.935
0.919
0.928

0.971
0.960
0.962

0.940
0.925
0.917

Table S.6: Power of the test in Scenario B for σ = 20.

T = 100
T = 250
T = 500

n=5

n = 10

n = 50

significance level α
0.01
0.05
0.1

significance level α
0.01
0.05
0.1

significance level α
0.01
0.05
0.1

0.438
0.864
0.960

0.404
0.850
0.961

0.277
0.811
0.945

0.636
0.934
0.968

0.704
0.927
0.949

38

0.598
0.923
0.964

0.669
0.915
0.935

0.449
0.891
0.961

0.526
0.898
0.941

