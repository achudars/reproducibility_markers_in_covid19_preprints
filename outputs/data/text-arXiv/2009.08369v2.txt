Face Mask Detection using Transfer Learning of
InceptionV3
G. Jignesh Chowdary1 , Narinder Singh Punn2 , Sanjay Kumar Sonbhadra2 , and
Sonali Agarwal2

arXiv:2009.08369v2 [cs.CV] 20 Oct 2020

1

2

Vellore Institute of Technology Chennai Campus
guttajignesh.chowdary2018@vitstudent.ac.in
Indian Institute of Information Technology Allahabad
{pse2017002,rsi2017502,sonali}@iiit.ac.in

Abstract. The world is facing a huge health crisis due to the rapid
transmission of coronavirus (COVID-19). Several guidelines were issued
by the World Health Organization (WHO) for protection against the
spread of coronavirus. According to WHO, the most effective preventive measure against COVID-19 is wearing a mask in public places and
crowded areas. It is very difficult to monitor people manually in these
areas. In this paper, a transfer learning model is proposed to automate
the process of identifying the people who are not wearing mask. The proposed model is built by fine-tuning the pre-trained state-of-the-art deep
learning model, InceptionV3. The proposed model is trained and tested
on the Simulated Masked Face Dataset (SMFD). Image augmentation
technique is adopted to address the limited availability of data for better
training and testing of the model. The model outperformed the other
recently proposed approaches by achieving an accuracy of 99.9% during
training and 100% during testing.
Keywords: Transfer Learning · SMFD dataset · Mask Detection · InceptionV3 · Image augmentation.

1

Introduction

In view of the transmission of coronavirus disease (COVID-19), it was advised by
the World Health Organization (WHO) to various countries to ensure that their
citizens are wearing masks in public places. Prior to COVID-19, only a few people
used to wear masks for the protection of their health from air pollution, and
health professionals used to wear masks while they were practicing at hospitals.
With the rapid transmission of COVID-19, the WHO has declared it as the global
pandemic. According to WHO [3], the infected cases around the world are close
to 22 million. The majority of the positive cases are found in crowded and overcrowded areas. Therefore, it was prescribed by the scientists that wearing a mask
in public places can prevent transmission of the disease [8]. An initiative was
started by the French government to identify passengers who are not wearing
masks in the metro station. For this initiative, an AI software was built and
integrated with security cameras in Paris metro stations [2].

2

Chowdary, G.J. et al.

Artificial intelligence (AI) techniques like machine learning (ML) and deep
learning (DL) can be used in many ways for preventing the transmission of
COVID-19 [4]. Machine learning and deep learning techniques allow to forecast
the spread of COVID-19 and helpful to design an early prediction system that
can aid in monitoring the further spread of disease. For the early prediction
and diagnosis of complex diseases, emerging technologies like the Internet of
Things (IoT), AI, big data, DL and ML are being used for the faster diagnosis
of COVID-19 [26,19,20,21,24].
The main aim of this work is to develop a deep learning model for the detection of persons who are not wearing a face mask. The proposed model uses the
transfer learning of InceptionV3 to identify persons who are not wearing a mask
in public places by integrating it with surveillance cameras. Image augmentation
techniques are used to increase the diversity of the training data for enhancing
the performance of the proposed model. The rest of the paper is divided into 5
sections and is as follows. Sections 2 deals with the review of related works in the
past. Section 3 describes the dataset. Section 4 describes the proposed model and
Section 5 presents the experimental analysis of the proposed transfer-learning
model. Finally, the conclusion of the proposed work is presented in Section 6.

2

Literature Review

Over the period there have been many advancements in the deep learning towards object detection and recognition in various application domains [27,18].
In general, most of the works focus on image reconstruction and face recognition for identity verification. But the main aim of this work is to identify people
who are not wearing masks in public places to control the further transmission
of COVID-19. Bosheng Qin and Dongxiao Li [22] have designed a face mask
identification method using the SRCNet classification network and achieved an
accuracy of 98.7% in classifying the images into three categories namely “correct
facemask wearing”, “incorrect facemask wearing” and “no facemask wearing”.
Md. Sabbir Ejaz et al. [7] implemented the Principal Component Analysis (PCA)
algorithm for masked and un-masked facial recognition. It was noticed that PCA
is efficient in recognizing faces without a mask with an accuracy of 96.25% but
its accuracy is decreased to 68.75% in identifying faces with a mask. In a similar facial recognition application, Park et al. [12] proposed a method for the
removal of sunglasses from the human frontal facial image and reconstruction of
the removed region using recursive error compensation.
Li et al. [14] used YOLOv3 for face detection, which is based on deep learning network architecture named darknet-19, where WIDER FACE and Celebi
databases were used for training, and later the evaluation was done using the
FDDB database. This model achieved an accuracy of 93.9%. In a similar research, Nizam et al. [6] proposed a GAN based network architecture for the
removal of the face mask and the reconstruction of the region covered by the
mask. Rodriguez et al. [17] proposed a system for the automatic detection of the
presence or absence of the mandatory surgical mask in operating rooms. The

Face Mask Detection using Transfer Learning of InceptionV3

3

objective of this system is to trigger alarms when a staff is not wearing a mask.
This system achieved an accuracy of 95%. Javed et al. [13] developed an interactive model named MRGAN that removes objects like microphones in the facial
images and reconstructs the removed region’s using a generative adversarial network. Hussain and Balushi [11] used VGG16 architecture for the recognition and
classification of facial emotions. Their VGG16 model is trained on the KDEF
database and achieved an accuracy of 88%.
Following from the above context it is evident that specially for mask detection very limited number of research articles have been reported till date whereas
further improvement is desired on existing methods. Therefore, to contribute in
the further improvements of face mask recognition in combat against COVID-19,
a transfer learning based approach is proposed that utilizes trained inceptionV3
model.

3

Dataset Description

In the present research article, a Simulated Masked Face Dataset (SMFD) [1] is
used that consists of 1570 images that consists of 785 simulated masked facial
images and 785 unmasked facial images. From this dataset, 1099 images of both
categories are used for training and the remaining 470 images are used for testing
the model. Few sample images from the dataset are shown in Fig. 1.

Fig. 1. Sample images from the dataset.

4

4

Chowdary, G.J. et al.

Proposed Methodology

It is evident from the dataset description that there are a limited number of
samples due to the government norms concerning security and privacy of the
individuals. Whereas deep learning models struggle to learn in presence of a
limited number of samples. Hence, over-sampling can be the key to address
the challenge of limited data availability. Thereby the proposed methodology
is split into two phases. The first phase deals with over-sampling with image
augmentation of the training data whereas the second phase deals with the
detection of face mask using transfer learning of InceptionV3.

4.1

Image augmentation

Image augmentation is a technique used to increase the size of the training
dataset by artificially modifying images in the dataset. In this research, the
training images are augmented with eight distinct operations namely shearing,
contrasting, flipping horizontally, rotating, zooming, blurring. The generated
dataset is then rescaled to 224 x 224 pixels, and converted to a single channel
greyscale representation. Fig. 2 shows an example of an image that is augmented
by these eight methods.

Fig. 2. Augmentation of training images.

Face Mask Detection using Transfer Learning of InceptionV3

4.2

5

Transfer Learning

Deep neural networks are used for image classification because of their better performance than other algorithms. But training a deep neural network is
expensive because it requires high computational power and other resources,
and it is time-consuming. In order to make the network to train faster and
cost-effective, deep learning-based transfer learning is evolved. Transfer learning
allows to transfer the trained knowledge of the neural network in terms of parametric weights to the new model. Transfer learning boosts the performance of
the new model even when it is trained on a small dataset. There are several pretrained models like InceptionV3, Xception, MobileNet, MobileNetV2, VGG16,
ResNet50, etc. [25,5,10,23,15,9] that are trained with 14 million images from
the ImageNet dataset. InceptionV3 is a 48 layered convolutional neural network
architecture developed by Google.
In this paper, a transfer learning based approach is proposed that utilizes the
InceptionV3 pre-trained model for classifying the people who are not wearing
face mask. For this work, the last layer of the InceptionV3 is removed and is finetuned by adding 5 more layers to the network. The 5 layers that are added are an
average pooling layer with a pool size equal to 5 x 5, a flattening layer, followed
by a dense layer of 128 neurons with ReLU activation function and dropout
rate of 0.5, and finally a decisive dense layer with two neurons and softmax
activation function is added to classify whether a person is wearing mask. This
transfer learning model is trained for 80 epochs with each epoch having 42 steps.
The schematic representation of the proposed methodology is shown in Fig. 3.
The architecture of the proposed model is shown in Fig. 4.

Fig. 3. Schematic representation of the proposed work.

5

Results

The experimental trials for this work are conducted using the Google Colab
environment. For evaluating the performance of the transfer learning model

6

Chowdary, G.J. et al.

Fig. 4. Architecture of the proposed model.

several performance metrics are used namely Accuracy, Precision, Sensitivity,
Specificity, Intersection over Union (IoU), and Matthews Correlation Coefficient
(MCC as represented as follows:
(T P + T N )
(T P + T N + F P + F N )

(1)

TP
(T P + F P )

(2)

Sensitivity =

TP
(T P + F N )

(3)

Specif icity =

TN
(T N + F P )

(4)

TP
(T P + F P + F N )

(5)

Accuracy =

P recision =

IoU =
M CC = p

(T P × T N ) − (F P × F N )
(T P + F P )(T P + F N )(T N + F P )(T N + F N )
CE =

n
X

Yi log2 (pi )

(6)

(7)

i=1

In equation 7, Classification error is formulated in terms of Yi and pi where Yi
represents the one-hot encoded vector and pi represents the predicted probablitity. The other performance metrics are formulated in terms of True Positive
(TP), False Positive (FP), True Negative (TN), and False Negative (FN). The
TP, FP, TN and FN are represented in a grid-like structure called the confusion
matrix. For this work, two confusion matrices are constructed for evaluating the
performance of the model during training and testing. The two confusion metrics
are shown in Fig. 5 whereas Fig. 6, shows the comparison of the area under the
ROC curve, precision, loss and accuracy during training and testing the model.

Face Mask Detection using Transfer Learning of InceptionV3

7

The performance of the model during training and testing are shown in
Table 1. The accuracy of the transfer-learning model is compared with other
machine learning and deep learning models namely decision tree, support vector machine[16] MobileNet, MobileNetV2, Xception, VGG16 and VGG19 when
trained under the same environment, the proposed model achieved higher accuracy than the other models as represented in Fig. 7.

Fig. 5. Confusion Matrix.

Table 1. Performance of the proposed model.
Performance Metrics
Training
Accuracy
99.92%
Precision
99.9%
Specificity
99.9%
Intersection over Union (IoU)
99.9%
Mathews Correlation Coefficient (MCC) 0.9984
Classification Loss
0.0015

5.1

Testing
100%
100%
100%
100%
1.0
3.8168E-04

Output

The main objective of this research is to develop an automated approach to
help the government officials of various countries to monitor their citizens that
they are wearing masks at public places. As a result, an automated system is
developed that uses the transfer learning of InceptionV3 to classify people who
are not wearing masks. For some random sample the output of the model shows
the bounding box around the face where green and red color indicates a person
is wearing mask and not wearing mask respectively along with the confidence
score, as shown in Fig. 8.

8

Chowdary, G.J. et al.

Fig. 6. Comparison of performance of the proposed model during training and testing.

Fig. 7. Comparision of performance of the proposed model with other models.

Fig. 8. Output from the proposed model.

Face Mask Detection using Transfer Learning of InceptionV3

6

9

Conclusion

The world is facing a huge health crisis because of pandemic COVID-19. The
governments of various countries around the world are struggling to control the
transmission of the coronavirus. According to the COVID-19 statistics published
by many countries, it was noted that the transmission of the virus is more in
crowded areas. Many research studies have proved that wearing a mask in public
places will reduce the transmission rate of the virus. Therefore, the governments
of various countries have made it mandatory to wear masks in public places and
crowded areas. It is very difficult to monitor crowds at these places. So in this paper, we propose a deep learning model that detects persons who are not wearing
a mask. This proposed deep learning model is built using transfer learning of InceptionV3. In this work image augmentation techniques are used to enhance the
performance of the model as they increase the diversity of the training data. The
proposed transfer learning model achieved accuracy and specificity of 99.92%,
99.9% during training, and 100%, 100% during testing on the SMFD dataset.
The same work can further be improved by employing large volumes of data and
can also be extended to classify the type of mask, and implement a facial recognition system, deployed at various workplaces to support person identification
while wearing the mask.

Acknowledgement
This research is supported by “ASEAN- India Science & Technology Development Fund (AISTDF)”, SERB, Sanction letter no. – IMRC/AISTDF/R&D/P6/2017. Authors are also thankful to the authorities of ”Vellore Institute of
Technology”, Chennai, India and “Indian Institute of Information Technology
Allahabad”, Prayagraj, India, for providing the infrastructure and necessary
support.

References
1. Dataset, https://github.com/prajnasb/observations, online accessed May 25,
2020
2. Paris tests face-mask recognition software on metro riders, http://bloomberg.
com/, online accessed May 25, 2020
3. Who coronavirus disease (covid-19) dashboard, https://covid19.who.int/, online accessed May 25, 2020
4. Agarwal, S., Punn, N.S., Sonbhadra, S.K., Nagabhushan, P., Pandian, K., Saxena,
P.: Unleashing the power of disruptive and emerging technologies amid covid 2019:
A detailed review. arXiv preprint arXiv:2005.11507 (2020)
5. Chollet, F.: Xception: Deep learning with depthwise separable convolutions. CoRR
abs/1610.02357 (2016), http://arxiv.org/abs/1610.02357
6. Din, N.U., Javed, K., Bae, S., Yi, J.: A novel gan-based network for unmasking of
masked face. IEEE Access 8, 44276–44287 (2020)

10

Chowdary, G.J. et al.

7. Ejaz, M.S., Islam, M.R., Sifatullah, M., Sarker, A.: Implementation of principal
component analysis on masked and non-masked face recognition. In: 2019 1st International Conference on Advances in Science, Engineering and Robotics Technology
(ICASERT). pp. 1–5 (2019)
8. Feng, S., Shen, C., Xia, N., Song, W., Fan, M., Cowling, B.J.: Rational use of face
masks in the covid-19 pandemic. The Lancet Respiratory Medicine 8(5), 434–436
(2020)
9. He, K., Zhang, X., Ren, S., Sun, J.: Deep residual learning for image recognition.
CoRR abs/1512.03385 (2015), http://arxiv.org/abs/1512.03385
10. Howard, A.G., Zhu, M., Chen, B., Kalenichenko, D., Wang, W., Weyand, T., Andreetto, M., Adam, H.: Mobilenets: Efficient convolutional neural networks for
mobile vision applications. CoRR abs/1704.04861 (2017), http://arxiv.org/
abs/1704.04861
11. Hussain, S.A., Al Balushi, A.S.A.: A real time face emotion classification and
recognition using deep learning model. In: Journal of Physics: Conference Series.
vol. 1432, p. 012087. IOP Publishing (2020)
12. Jeong-Seon Park, You Hwa Oh, Sang Chul Ahn, Seong-Whan Lee: Glasses removal from facial image using recursive error compensation. IEEE Transactions
on Pattern Analysis and Machine Intelligence 27(5), 805–811 (2005)
13. Khan MKJ, Ud Din N, B.S.Y.J.: Interactive removal of microphone object in facial
images. Electronics 8(10) (2019)
14. Li, C., Wang, R., Li, J., Fei, L.: Face detection based on yolov3. In: Recent Trends in
Intelligent Computing, Communication and Devices, pp. 277–284. Springer (2020)
15. Liu, S., Deng, W.: Very deep convolutional neural network based image classification using small training sample size. In: 2015 3rd IAPR Asian Conference on
Pattern Recognition (ACPR). pp. 730–734 (2015)
16. Loey, M., Manogaran, G., Taha, M.H.N., Khalifa, N.E.M.: A hybrid deep transfer
learning model with machine learning methods for face mask detection in the era
of the covid-19 pandemic. Measurement p. 108288 (2020)
17. Nieto-Rodrı́guez A., Mucientes M., B.V.: System for medical mask detection in the
operating room through facial attributes. vol. 9117, pp. 138–145. Springer (2015)
18. Punn, N.S., Agarwal, S.: Crowd analysis for congestion control early warning system on foot over bridge. In: 2019 Twelfth International Conference on Contemporary Computing (IC3). pp. 1–6. IEEE (2019)
19. Punn, N.S., Agarwal, S.: Automated diagnosis of covid-19 with limited posteroanterior chest x-ray images using fine-tuned deep neural networks. Applied Intelligence
(2020). https://doi.org/10.1007/s10489-020-01900-3
20. Punn, N.S., Sonbhadra, S.K., Agarwal, S.: Covid-19 epidemic analysis using machine learning and deep learning algorithms. medRxiv (2020)
21. Punn, N.S., Sonbhadra, S.K., Agarwal, S.: Monitoring covid-19 social distancing
with person detection and tracking via fine-tuned yolo v3 and deepsort techniques.
arXiv preprint arXiv:2005.01385 (2020)
22. QIN, B., LI, D.: Identifying facemask-wearing condition using image superresolution with classification network to prevent covid-19 (2020)
23. Sandler, M., Howard, A.G., Zhu, M., Zhmoginov, A., Chen, L.: Inverted residuals
and linear bottlenecks: Mobile networks for classification, detection and segmentation. CoRR abs/1801.04381 (2018), http://arxiv.org/abs/1801.04381
24. Sonbhadra, S.K., Agarwal, S., Nagabhushan, P.: Target specific mining of covid-19
scholarly articles using one-class approach. arXiv preprint arXiv:2004.11706 (2020)

Face Mask Detection using Transfer Learning of InceptionV3

11

25. Szegedy, C., Vanhoucke, V., Ioffe, S., Shlens, J., Wojna, Z.: Rethinking the inception architecture for computer vision. CoRR abs/1512.00567 (2015), http:
//arxiv.org/abs/1512.00567
26. Ting, D.S.W., Carin, L., Dzau, V., Wong, T.Y.: Digital technology and covid-19.
Nature medicine 26(4), 459–461 (2020)
27. Zhao, Z.Q., Zheng, P., Xu, S.t., Wu, X.: Object detection with deep learning: A
review. IEEE transactions on neural networks and learning systems 30(11), 3212–
3232 (2019)

