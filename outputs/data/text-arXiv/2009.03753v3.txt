Data-driven Optimized Control of the COVID-19 Epidemics
arXiv:2009.03753v3 [q-bio.PE] 10 Mar 2021

Afroza Shirin1,2 , Yen Ting Lin3 , and Francesco Sorrentino1
1

Department of Mechanical Engineering, University of New Mexico, New Mexico, 87131
2
Electrical and Computer Engineering, University of New Mexico, New Mexico, 87131
3
Information Sciences Group, Computer, Computational and Statistical Sciences Division
(CCS-3), Los Alamos National Laboratory, Los Alamos, New Mexico, 87544 USA
March 12, 2021
Abstract
Optimizing the impact on the economy of control strategies aiming at containing the spread of COVID19 is a critical challenge. We use daily new case counts of COVID-19 patients reported by local health
administrations from different Metropolitan Statistical Areas (MSAs) within the US to parametrize a model
that well describes the propagation of the disease in each area. We then introduce a time-varying control
input that represents the level of social distancing imposed on the population of a given area and solve an
optimal control problem with the goal of minimizing the impact of social distancing on the economy in the
presence of relevant constraints, such as a desired level of suppression for the epidemics at a terminal time.
We find that with the exception of the initial time and of the final time, the optimal control input is well
approximated by a constant, specific to each area, which contrasts with the implemented system of reopening
‘in phases’. For all the areas considered, this optimal level corresponds to stricter social distancing than the
level estimated from data. Proper selection of the time period for application of the control action optimally
is important: depending on the particular MSA this period should be either short or long or intermediate. We
also consider the case that the transmissibility increases in time (due e.g. to increasingly colder weather), for
which we find that the optimal control solution yields progressively stricter measures of social distancing. We
finally compute the optimal control solution for a model modified to incorporate the effects of vaccinations
on the population and we see that depending on a number of factors, social distancing measures could be
optimally reduced during the period over which vaccines are administered to the population.

1

Introduction
The fast propagation of the COVID-19 pandemic has attracted unprecedented attention from both the public and
the scientific community. This has resulted in much research and funding getting redirected towards COVID-19
and stimulated strong research collaboration between countries [38]. Due to the high fatality rate of SARS-CoV-2
[42], governments throughout the world have adopted measures such as lock-down, stay-at-home, and shelter-inplace, which in turn have led to substantial economic losses, see e.g., [27]. In many countries control interventions
have been articulated in phases, usually phase 1 to phase 3, with higher phases corresponding to progressively
lower restrictions [16]. A fundamental challenge is to balance the need to suppress the spread of COVID-19
and the need to contain the economic impact of measures aiming at limiting the spread of the disease. In this
manuscript, we apply optimal control theory on a mathematical model for the propagation of the epidemics,
parametrized by real-world data describing different regions, and compute control strategies which are optimal
for each region from an economic standpoint.
A number of papers and reports have focused on both modeling and controlling the pandemic. Flaxman
et al. [14] looked at the effect of non-pharmaceutical interventions including school closures, banning of mass
gathering, social distancing, etc. on the reproductive number Rt of COVID-19. Sanche et al. [47] used a
mathematical model with data on individual cases, real-time human travel, and infections, as well as estimated
epidemiology parameters to compute R0 and found that it is higher than initially estimated. Chang et al. [11]
adopted an agent-based model to determine the efficacy of several intervention strategies on the spread of COVID19 in Australia. Anderson et al. [7] performed a Bayesian analysis to estimate the impact of social distancing
on number of reported cases and hospitalizations in British Columbia and found that when 78% participation
in social distancing has been accomplished the cases would decrease; it also noted that if the participation were
below 45%, an exponential growth would restart. Morris et al. [30] explored COVID-19 intervention methods
which are robust to implementation errors and found that these methods in conjunction with optimal timelimited methods derived from the standard SIR model can be used to mitigate the spread of the virus. Another
study analyzed an open-loop optimal control policy updated weekly using real-world feedback, and found that
this method is effective in reducing fatalities even if some measurements are inaccurate [21]. A study published
in March 2020 estimated the ICU occupancy and ventilator use from a statistical model under the conditions
of social distancing and found that the demand for hospital beds and ventilators will exceed the supply [13].
Another study explored optimal policies for decreasing economic cost and mortality rates from a multi-risk SIR
model and found that strict lock-down policies which specifically target the elderly population were most effective
in minimizing deaths and economic losses [6]. Previous work has not computed optimal controls for data driven
models. On the one hand, Refs. [11], [30], [21], [6] explicitly compute optimal control strategies, but their models
were stylized and not parametrized/calibrated by data; On the other hand, Refs. [14] [47], [7], [13] used data
to parametrize the models, but the models do not have controllers which can be used to infer optimal control
strategies.
In what follows, we first construct a mathematical model, which is parametrized by historical and regional
daily new case report. After parametrization, the data-driven model is capable to reproduce the regional progres2

sion of the COVID-19 epidemics up to the present. Then, we apply optimal control theory to the parametrized
model to compute an optimal control strategy over the course of a pre-determined period into the future to
suppress the epidemics to a desired level, while minimizing economic costs. This type of approach is suitable
for long-term planning (i.e., over the course of several months) as opposed to short-term planning, which can be
difficult to implement by the government and by businesses.
In most countries, distribution of the vaccine to the population is under way and will continue for most of
2021, which points out the need for planning interventions to contain the epidemics for several months while
only a limited part of the population has received a vaccine. Thus our proposed workflow aims to bridge the
gap until the time Tvac when an effective vaccine is massively manufactured, and administered to the majority
of the population. Another temporal consideration regards the time Therd at which a population achieves herd
immunity in the absence of a vaccine and without overflowing the medical facilities. While herd immunity from
COVID-19 is the subject of much ongoing discussion [40], in the Methods we provide a rough estimate of Therd
from available data. In this paper we proceed under the assumption that the inference period Tinf and the control
horizon Tcont are such that Tinf + Tcont < Tvac and Tinf + Tcont < Therd .
We set out the analysis by first introducing a compartmental model which describes key features of the
COVID-19 epidemics. The whole population is divided into the following compartments. The susceptible population compartment (S) includes the people who can contract the pathogen SARS-CoV-2. The exposed population
(E) are those who have been infected but have not progressed long enough into the disease to transmit it to
susceptible people. Those who can transmit the disease (‘carriers’) are divided into the asymptomatic group (A)
who do not show symptoms and the infected symptomatic groups (I) who show symptoms. Both the symptomatic
and asymptomatic groups can transmit the disease, but with different infectiousness—the asymptomatic people
are less infectious. The infected symptomatic population I is divided into three sub-compartments. The first subcompartment Isq includes those who just self quarantine and do not get tested. The second sub-compartment
Itp includes those who get tested, result positive, and get quarantined. In contrast to the previous two subcompartments, the third sub-compartment Is includes the rest of the symptomatic population. Those who were
tested positive and those who decided to self-quarantine are moved into a quarantined compartment (Q), and stop
interacting with other populations. The removed compartment (R) includes those who are completely recovered
from the disease and have acquired immunity, and those who have died because of the disease. Both groups are
not susceptible to reinfection and are removed from the system.
Mathematically, the time evolution of the population density—defined as the compartmental population
normalized by the total regional population—of each compartment is governed by the following set of coupled

3

ordinary differential equations,
Ṡ (t) = − βP 2 (t) S(t) [Is (t) + Isq (t) + Itp (t) + µA(t)]
2

Ė (t) = βP (t) S(t) [Is (t) + Isq (t) + Itp (t) + µA(t)] − λE(t)

Ȧ (t) = λ (1 − σ) E(t) − γA A(t)
I˙sq (t) = psq λσE(t) − [γI + γsq ] Isq (t)

I˙tp (t) = ptest λσE(t) − [γI + γtp ] Itp (t)
I˙s (t) = (1 − psq − ptest ) λσE(t) − γI Is (t)

Q̇ (t) = γtp Itp (t) + γsq Isq (t) + psq λσE(t) − γI Q(t)
Ṙ (t) = γA A(t) + γI [Is (t) + Itp (t) + Q(t)] ,

(1a)
(1b)
(1c)
(1d)
(1e)
(1f)
(1g)
(1h)

where β is the transmissibility, λ is the transition rate from the exposed compartment to either the asymptomatic or symptomatic compartments, γI is the transition rate from the infected compartment to the recovered
compartment, γA is the transition rate from the asymptomatic compartment to the recovered compartment, µ
is the relative infectiousness of asymptomatic individuals (compared to symptomatic individuals), σ is the fraction of exposed people who transition into the symptomatic compartments, psq is the fraction of symptomatic
people who will self-quarantine, γsq is the transition rate from from the Isq compartment into the quarantined
compartment, γtp is the transition rate from the Itp compartment into the quarantined compartment, and ptest
is the fraction of infected who get tested (but only a fraction of them will be confirmed to be positive, Itp ). The
model assumes that testing resources are not scarce, i.e., availability of a testing kit to every person in Itp ; we
also assume positive people are identified as such with 100% accuracy. The case with limited testing resources is
discussed in the SI. Realistically, the time scale associated with γtp can be several days, so we assume γtp = 0.5 (2
days). We model social distancing by the control variable 0 ≤ P (t) ≤ 1, which measures the reduction of contact
probabilities between the susceptible and the infectious populations (which include both A and I). The model
is structurally similar to the models analyzed in Refs. [7, 26], but simplified to allow for efficient calculations of
optimal control solutions. Figure 1 illustrates a schematic diagram of the model.
In order to reduce the dimensionality of the dynamical system, we introduce the following simplification:
we treat γsq as a very large number; for γsq → ∞, we assume that those becoming symptomatic immediately

4

transition into the Q compartment, yielding the following reduced-order model:
Ṡ (t) = − βP 2 (t) S(t) [Is (t) + Itp (t) + µA(t)]
2

Ė (t) =βP (t) S(t) [Is (t) + Isq (t) + Itp (t) + µA(t)] − λE(t)

Ȧ (t) =λ (1 − σ) E(t) − γA A(t)
I˙tp (t) =ptest λσE(t) − [γI + γtp ] Itp (t)

(2a)
(2b)
(2c)
(2d)

I˙s (t) = (1 − psq − ptest ) λσE(t) − γI Is (t)

(2e)

Ṙ (t) =γA A(t) + γI [Is (t) + Itp (t) + Q(t)] .

(2g)

Q̇ (t) =γtp Itp (t) + psq λσE(t) − γI Q(t)

(2f)

The schematic diagram which fits the above model in Eq. (2) is shown in the Supplementary Note 1 1.

Figure 1: Compartmental model corresponding to Eq. 2. The transition from the S (susceptible) compartment to the E (exposed) compartment is affected by the population densities S(t), Itp (t), Is (t), A(t) and by
the time-varying control input P (t). The dashed lines enclose the infectious populations.
To bridge the model and the data, we also integrate an auxiliary variable CI which counts the cumulative
confirmed cases and evolves according to
Ċtp (t) = γtp Itp (t),
5

(3)

We will fit ∆Ctp (t) := Ctp (t + 1) − Ctp (t) to the new case counts reported on each day, detailed in the section on
parametrization below.
From an economic point of view, the measures of social distancing P (t) and quarantining Q(t) have very
elevated costs for society. For example, the US real gross domestic product (GDP) dropped by roughly one third
from year to year in the second quarter of 2020 [27], due mainly to the COVID-19 pandemic, see e.g., [31].
We thus formulate the following optimal control problem,
Z tf
Z tf
Q(t)
1 − P (t)
dt + cq
dt,
(4)
min J = cp
P
P (t)
ti 1 − Q(t)
ti
cp , cq ≥ 0, subject to Eq. (2), the initial conditions, the terminal constraint
E(tf ) + Is (tf ) + Itp (tf ) + A(tf ) < ,

(5)

Is (t) + Itp (t) ≤ Imax ,

(6)

and the following path constraint
where Imax is an upper limit on the number of infected people that can receive proper treatment in the hospitals.
ti is the time at which we perform the inference and start optimizing the control action, tf is the final time of
the optimization, the previously defined control horizon Tcont = (tf − ti ).
The objective function (4) takes into account an economic cost for social distancing with an appropriate
coefficient cp > 0 and an economic cost for quarantining with an appropriate coefficient cq > 0. We set the cost
associated with social distancing per unit time to be modeled by (1 − P (t)) /P (t). By choosing this functional
form, the cost is linearly dependent on the scale of the reduction (1 − P (t)) when 1 − P (t)  1, and nonlinearly
diverges near total shut-down (P (t)  1). The economic cost increases with 1 − P (t) to indicate that stricter
measures of social distancing affect more and more ‘essential’ workers, and so increasingly larger parts of the
economy. For example, the cost of limiting large gatherings of people like concerts or sport events is lower than
the cost of limiting customers’ access to stores and restaurants. Similarly, imposing quarantine requires resources
that are linearly proportional to the quarantined population when Q is small, and diverge nonlinearly when the
quarantined population is close to the entire population Q = 1. We model such a cost by the functional form
Q(t)/ (1 − Q(t)).
Both social distancing and quarantining have a cost associated with the lack of economic return generated
by limiting person-to-person interactions. It is reasonable to assume cq ≥ cp , as strict quarantining requires
supervision costs as well as costs due to lowered productivity [17] while social distancing only incurs costs due
to lowered productivity [22].
We will also consider the alternative objective function,
Z tf
Z tf
alt
min J = cp
(1 − P (t))dt + cq
Q(t)dt,
(7)
P

ti

ti

6

for which the integrand functions are linear in P (t) and Q(t). While the formulation (7) is mathematically simpler,
it does not take into account the fact that stricter measures of social distancing may result in progressively larger
economic losses. The alternative objective function (7) is here mainly introduced in order to compare the results
to those obtained with (4).
The tunable parameter  represents the desired suppression level for the epidemics at the final time tf .
In general, selected values for  may depend on a number of factors, such as the time horizon over which
optimization is performed and the particular stage of the epidemics (initial exponential growth, intermediate
growth, or plateau.) A possibility is to require complete eradication of the epidemics, which corresponds to
setting  = 1/N , where N is the number of individuals in the population. However, the high basic reproductive
number of COVID-19 makes eradication unlikely; instead we set  to a small number indicating suppression of
the disease. The other constraint given by Imax represents the need to contain the infected population below a
given threshold at all times (or ’flatten the curve’.) In what follows, unless differently stated, we set the terminal
constraint  = 10−5 , which corresponds to imposing that the number of infected people is below one person per
100000. This number is derived from the guidelines of European countries about re-opening, see for example
[29], indicating that reopening occurred at about 2 × 10−5 . Also, European countries have official guidelines for
reimposing stricter lock-down measures, see: [15], which sets a critical population equal to 50/100000 = 5 × 10−4 .
The values of Imax are set regionally based on the capacity of the ICU beds in different metropolitan areas and
are summarized in Table 3.

7

Parametrization of the model for different US metropolitan areas.
We partitioned the model parameters into two sets: a set of fixed parameters and a set of inferred parameters
which are estimated by the daily case counts reported by regional health administration and registered in the
repository curated by the New York Times [4].
The fixed parameter sets includes S0 , λ, γI , γA , µ, σ, ptest , and psq . S0 is the regional total population, and we
used the US Census Bureau-estimated regional population of each of the Metropolitan Statistical Areas (MSAs)
or ‘cities’, which are delineated by the US Office of Management and Budget [5]. Lauer et al. [24] estimated the
median of the incubation period to be about 5.2 days, however, there is evidence that patients become infectious
roughly two days before the onset of symptoms [32], which corresponds to approximately a three-day progression
into contagiousness. We thus set a rough estimation for λ to be 1/3 (d). In a more complex model with multiple
stages of the disease progression [26], one could account for the fact that a patient can be both pre-symptomatic
and infectious. The coefficients γI and γA , which are the transition rate to recovery of the symptomatic and
asymptomatic populations, are estimated to be 0.12 (1/d) [55] and 0.26 (1/d) [46]. The relative infectiousness
µ is set at 0.9 [52], and the fraction of the symptomatic population is set at 0.64 [3, 46]. The parametrization
of γI , γA , µ, and σ are consistent with a more complex model which was used to perform daily forecasts of the
disease spread [26]. We assume ptest = 0.25 and psq = 0.4, noting that these parameters were able to reproduce
the infected population at the time of the inference (we estimated that about 15 to 20% of the total population
infected in the New York City MSA on 07-Jul-2020 when we parametrize the model.)
We used the data from 21-Jan-2020 to 07-Jul-2020 to infer the inferred parameters, which corresponds to the
previously defined inference period Tinf . We assume that the social distance function P (t) before 07-Jul-2020 is
piecewise-linear to avoid over-fitting (due to observation noise.) At the time when the analysis was performed,
multiple MSAs had shown clear second-phase resurrection of the epidemics [26, 2]. We found that a two-phase
piecewise linear function is sufficient to reproduce the data of each of the MSAs:

0,
t ≤ t0 ,




1,
t0 < t ≤ t1


 1 + p1 −1 (t − t ) , t < t ≤ t
1
1
2
t2 −t1
P (t) =
p
,
t
<
t
≤
t

1
2
3


p2 −p1

(t
−
t
)
,
t
<
t
≤
t
p
+

1
3
3
4

t4 −t3

p2
t4 < t < ti ,
where t0 is the time when the disease was introduced into a specific MSA, the monotonic t1 , t2 , t3 , and t4
(tj ≤ tj+1 ) are the times when the social-distancing behavior changes, and p1 and p2 are the two social-distancing
strengths. The two-phase model was selected by a model-selection procedure [26] and is deemed the most evident
model structure (v. one- and three-phase). We define ∆tj := tj − tj−1 for j = 1, . . . 4. The time at which we
perform the inference is t4 , which is also the time after which optimization of the control action begins. The
two-phase piecewise linear model is the minimal model that we found capable to reproduce the data, and can be
validated by the more rigorous model-selection procedure detailed in [26].
8

To fit the model by the noisy daily report new counts, we adopt a negative-binomial noise model. We brief
the procedure here, noting that the procedure is similar to the inference method detailed in [26]. Given a set
of parameters θ (a stylized notation for the set of the inferred model parameters), the model Eq. (2) predicts
a deterministic trajectory of the new positive tested case on day j, ∆Itp (j; θ). This deterministic prediction is
interpreted as the mean of a stochastic outcome, modeled by a negative binomial distribution NB(r, pj ) where r
and pj are the parameter of the distribution, and pj is constrained by the deterministic model prediction
pj =

r
.
r + ∆Ctp (j; θ)

(8)

Here, r is the dispersion parameter which describes how disperse the noise distribution is; in the limit r → ∞,
the negative binomial statistics converges to Poissonian, and in the limit r → 0 the distribution looks closer to
an exponential. The negative binomial noise model is phenomenological: it has the capability to capture a wide
variety of single-modal distributions. With the negative binomial noise model, the likelihood function given a
−1
set of N daily reported new case counts {∆Ctp (j)}N
j=0 can be formulated [26]:

−1 

 NY
∆Ctp (j) + r − 1
N −1
L θ; {∆Ctp (j)}j=0 ≡
prj (1 − pj )∆Ctp (j) .
∆Ctp (j) − 1

(9)

j=0

In summary, the inferred parameters θ include the regional-specific disease transmissibility β, onset of the
disease spread t0 , behavioral switching times t1 , t2 , t3 , t4 , the strengths of two social-distancing measures p1 ,
p2 , and a dispersion parameter r of the negative binomial noise model. These parameters were inferred by the
daily case reports from 21-Jan-2020 to 07-Jul-2020. With the formulated likelihood function (9), we used the
standard Markov chain Monte Carlo procedure (MCMC) with an adaptive sampler ([8], detailed in [26]) to
estimate the maximum likelihood estimator of the parameters θ for each of the interested MSA’s. Figure 2 shows
excellent agreement between the daily new case counts reported by local health administrations (plus signs) and
the daily new cases obtained by integrating Eq. (2) after parametrization of the model (solid line.) Table 1 is a
list of data-driven model parameters, with indication of whether they are free or fixed and of whether they are
region-dependent. Table 2 summarizes the set of model parameters that were estimated for each MSA.

9

Table 1: List of data-driven model parameters.
Parameter
S0
λ
γI
γA
µ
σ
ptest
psq
r
β
t0
∆t1
∆t2
∆t3
∆t4
P1
P2

Description
Total regional population
Transition rate constant from compartment E to I
Recovery rate constant of the asymptomatic population
Recovery rate constant of the asymptomatic population
Relative infectiousness of asymptomatic population
Fraction of exposed people who developed symptoms
Fraction of symptomatic people who took the test
Fraction of symptomatic people who self-quarantine
Dispersion parameter of the negative-binomial noise
Contact probability per person per time
Time when the disease was introduced to the region
Transition time to the first social-distancing episode
Duration of the first social-distancing episode
Transition time to the second social-distancing episode
Duration of the second social-distancing episode
Strength of the first episode of social-distancing
Strength of the second episode of social-distancing

10

Fixed/Free
Fixed
Fixed
Fixed
Fixed
Fixed
Fixed
Fixed
Fixed
Free
Free
Free
Free
Free
Free
Free
Free
Free

Region-dependent
Yes
No
No
No
No
No
No
No
Yes
Yes
Yes
Yes
Yes
Yes
Yes
Yes
Yes

C
4,000

3,000

Data
Parametrized model
400

2,000

1,000

200

New case counts

01-21-2020
01-31-2020
02-10-2020
02-20-2020
03-01-2020
03-11-2020
03-21-2020
03-31-2020
04-10-2020
04-20-2020
04-30-2020
05-10-2020
05-20-2020
05-30-2020
06-09-2020
06-19-2020
06-29-2020
07-08-2020

01-21-2020
01-31-2020
02-10-2020
02-20-2020
03-01-2020
03-11-2020
03-21-2020
03-31-2020
04-10-2020
04-20-2020
04-30-2020
05-10-2020
05-20-2020
05-30-2020
06-09-2020
06-19-2020
06-29-2020
07-08-2020

New case counts
16,000

12,000

4,000

8,000
3,000

4,000

New case counts

20,000

01-21-2020
01-31-2020
02-10-2020
02-20-2020
03-01-2020
03-11-2020
03-21-2020
03-31-2020
04-10-2020
04-20-2020
04-30-2020
05-10-2020
05-20-2020
05-30-2020
06-09-2020
06-19-2020
06-29-2020
07-08-2020

01-21-2020
01-31-2020
02-10-2020
02-20-2020
03-01-2020
03-11-2020
03-21-2020
03-31-2020
04-10-2020
04-20-2020
04-30-2020
05-10-2020
05-20-2020
05-30-2020
06-09-2020
06-19-2020
06-29-2020
07-08-2020

New case counts
A

NYC
Data
Parametrized model
B

Houston

0

11

LA

5,000

0

D
600

Data
Parametrized model

2,000

1,000
0

Seattle

Data
Parametrized model

0

Figure 2: New case counts from January 21, 2020 to July 8, 2020 in four Metropolitan Statistical
Areas within the US. Plus signs are daily new case counts reported by local health administrations. The solid
line is the daily new cases obtained by integrating Eq. (2) after parametrization of the model, which was deemed
to be sufficient to reproduce the trends in new daily case report [26]

Table 2: Parameters by Metropolitan Statistical Area (MSA)
Parameter

New York

Los Angeles

Houston

Seattle

S0

1.92E+07

1.321E+07

7.066E+06

3.979E0+6

λ

3.333E-01

3.333E-01

3.333E-01

3.333E-01

γI

1.200E-01

1.200E-01

1.200E-01

1.200E-01

γA

2.60E-01

2.60E-01

2.60E-01

2.60E-01

µ

9.00E-01

9.00E-01

9.00E-01

9.00E-01

σ

5.60E-01

5.60E-01

5.60E-01

5.60E-01

ptest

2.50E-01

2.50E-01

2.50E-01

2.50E-01

psq

4.00E-01

4.00E-01

4.00E-01

4.00E-01

r

1.183E+01

1.100E+01

5.287

1.067E+01

β

1.806

1.204

1.123

1.442

t0

2.911E+01

2.865E+01

3.195E+01

2.339E+01

∆t1

2.557E+01

3.237E+01

3.153E+01

1.388E+01

∆t2

2.148E+01

1.153+01

1.633E+01

3.549E+01

∆t3

6.423E+01

7.171E+01

1.685E+01

6.614E+01

∆t4

8.800

4.289

4.658E+01

2.016

P1

3.693E-01

5.371E-01

4.845E-01

4.160E-01

P2

4.403E-01

5.968E-01

6.391E-01

5.555E-01

12

Results: Optimal Control Solutions
Following previous work by the authors [50, 49], we use pseudo-spectral optimal control (see Supplementary
Note 7) to compute solutions for the problem formulated in Eqs. (2),(4),(5),(6). We set ti = 169 (days) and
tf = 259, corresponding to a ninety day control horizon, (tf − ti ) = 90. We wish to emphasize that our choice
of ti is somehow arbitrary and coincides with the day when we initially computed the optimal control solutions.
However, our procedure is pretty general and can be replicated for many possible choices of ti . We parametrize
the solutions in Imax ,  and cq , after setting without loss of generality cp = 1.
We focus on four different US metropolitan statistical areas: New York City (NYC), Los Angeles (LA),
Houston, and Seattle. NYC is the largest US metropolitan area; it emerged as the main early hotspot of the
epidemics in the US in March and April, but since early June has achieved stable control of the epidemics. LA is
the second largest metropolitan area in the US, it has seen a steady rise in the number of cases by the time when
we performed the inference. Houston has seen a rapid increase of the cases in June and July. Seattle was also a
very early hotspot, which has seen a decrease in the number of cases in April and May, followed by an increase
in June and July. We chose these four MSA’s to cover a wide range of different dynamics before the time of the
inference.
The solution of the optimal control problem is the function of time P ∗ (t) that minimizes the objective function
(4) subject to the constraints (2), (5), and (6). Different from the observation period t ≤ ti , for which we set P (t)
to be a piecewise linear function, in the optimization period t ∈ [ti , tf ] we let P (t) be an arbitrary function of t, for
the purpose of computing the optimal control solution.The optimal control solutions that we obtain for different
MSAs are shown in Figs. S26. These solutions are robust to parameter variations (such as different values of the
coefficient cq , see the Supplementary Note 2) and also qualitatively consistent for different MSA’s. Robustness
is also found with respect to the choice of the constraint Imax , see the Supplementary Note 2. Typically we first
observe a quick drop in P ∗ (t) (initial tightening), followed by a long nearly constant trend at Ps∗ (steady social
distancing), and by another drop near the final time (final stranglehold). We remark that Ps∗ corresponds to
the level of reduction needed to suppress the time-varying reproduction number Rt ≈ 1, and the cost per day
associated with this level of reduction is (1 − Ps∗ ) /Ps∗ . It follows that for each MSA, there is an almost constant
value of Ps∗ which well describes the optimal solution, except for the initial time and the final time. The value
of Ps∗ appears to be approximately the same for LA, Houston, and Seattle, while NYC has typically a slighter
higher value of Ps∗ . This also implies that the optimal cost function J ∗ is lower for NYC than for the other cities.
In all the four metropolitan areas, Ps∗ is lower than the ‘current’ value of P (t) estimated from data, as can be
seen from the initial dip in P ∗ (t). NYC has the smallest initial drop, indicating that the control action at the
time at which we performed the inference is the closest to optimal, followed by (in the order) Seattle, LA, and
Houston. For each metropolitan area, Imax was estimated from available data about ICU beds for different US
states, as shown in Table 3 in the Methods.
The most important parameter of the optimal control problem is the terminal suppression constraint , which
describes the level at which one is trying to suppress the epidemic. The lower is , the closer the goal is to
eradication of the disease. The optimal value attained by the objective function J ∗ versus  is shown in Figs.
13

0.3

F

Seattle(Imax = 0.0046)
0.7
0.5
0.3

G

H

0.2

0.2

0.012

0.012

0.012

Imax

0.008

0.008

0.008

Q(t)

0.004

0.004

0.004

0.000

0.000

0.000

0.012
0.008
0.004

10-08-20

08-08-20

07-08-20

0.000

09-08-20

Itp + Is

10-08-20

0.4

0.2

R(t)

0.2

09-08-20

0.6

0.4

08-08-20

0.6

0.4

S(t)

0.4

07-08-20

0.6

0.6

10-08-20

1
0.8

09-08-20

1
0.8

08-08-20

1
0.8

07-08-20

1
0.8

10-08-20

E

0.5

D

09-08-20

0.3

Houston(Imax = 0.0086)
0.7

08-08-20

0.3

0.5

C

07-08-20

0.7

LA(Imax = 0.0066)

P ∗ (t)

0.5

B

P ∗ (t)

P ∗ (t)

0.7

NYC(Imax = 0.0088)

P ∗ (t)

A

Figure 3: Optimal control solutions for different Metropolitan Statistical Areas within the US. (A-D)
Optimal control inputs for the metropolitan cities of NYC, LA, Houston, Seattle (from left to right). (E-H) Time
evolution of the states subject to the optimal control inputs. Imax are chosen as the minimum of the range in
Table 3 (ρ = 2/3) and cp = cq = 1. The legends in (F-H) are same as the legend in (E).

14

4(A) and (B). It should be noted that for each value of , J ∗ shown in Fig. 4 is the lowest possible cost that
can be attained. For all the US cities considered, this lowest possible cost increases dramatically as  is reduced,
which exemplifies the dilemma between saving human lives and protecting the economy. Again, here we are
assuming that the measures of social distancing are optimally implemented, while the cost would be higher in
case of non-optimal implementation (discussed in the Supplementary Note 7). For large values of the suppression
constraint , in all four cities considered, a different type of solution characterized by low cost emerges, which
is discussed in more detail in what follows. Qualitatively similar results were obtained when the control input
was chosen that minimizes the alternative objective function (7). A complete study of the effects of varying the
suppression constraint parameter  can be found in the Supplementary Note 3. There are deeper implications
behind Figs. 4 (A) and (B), namely setting a larger value of  corresponds to delaying the economic cost in time,
rather than removing it.
From Fig. 4 (C) and (D) we also see the effects of changing the control horizon (tf − ti ) of the optimal
control problem, from a minimum of 60 days to a maximum of 120 days. We see here that different cities behave
differently. For Houston and LA we see that a longer tf corresponds to a lower value of the optimal cost J ∗ ,
while for NYC the cost increases with tf . A complete study of the effects of varying tf can be found in the
Supplementary Note 4. In particular, we see that increasing tf has two contrasting effects on the objective
function. On the one hand the cost is integrated over a longer time period, on the other hand the longer time
period can be exploited to allow for less stringent measures of social distancing at any time (larger values of P ∗ ),
which may result in a lower value for the objective function overall. Thus it appears that finely tuning the time
horizon of the objective function may be used to critically and selectively affect different cities. The implications
are particularly significant for those cities, Houston and LA, that seem to need a longer time period to suppress
the epidemics. For Seattle we see that J ∗ is minimized for intermediate values of tf in the interval [255, 285],
indicating a specific advantage of choosing such a control horizon, see also Fig. 5. A remarkable observation is
that by comparing the left plots and the right plots in Fig. 4, it is evident that the optimal control solution is
quite independent of the particular form of the objective function (either J or J alt .) The reason for this is that
when the integrand in (4) is nonlinear the optimal solution maintains P ∗ (t) as close as possible to the linear
regime (high values of P ∗ ), which is why we do not see much difference with the linear case (7).
In general, the main constraints of the problem are provided by Imax and . However, for each case considered,
typically either one of these two constraints is dominant. In all the simulations shown in Figs. S26, the dominant
constraint is provided by , with Is (t) + Itp (t) remaining well below Imax over the entire period [ti , tf ]. These
solutions, which we will refer to as the type-1 solution, are characterized by strong measures of social distancing
(low P ∗ ) throughout the whole time interval considered, and the dominant constraint is to achieve suppression
of the epidemics at the prescribed terminal time (tf ).
We have also seen the emergence of different solutions, which we refer to as the type-2 solution, when the
dominant constraint is given by Imax . In these solutions there is at least one time t at which the constraint (6) is
satisfied with the equal sign. Overall, type 2 solutions are less expensive economic-wise than type 1 solutions, i.e.,
the value of J ∗ is lower. There are also cases when the optimal solution is actively affected by both constraints.
In order to better understand the transition between type 1 and type 2 solutions, we have investigated the
15

A
250

B
250
NYC
LA
Houston
Seattle

200

J∗

J alt

∗

200

NYC
LA
Houston
Seattle

150

150

100

10−5

10−4

C
700

10−5

10−4

10−3



D
700
NYC
LA
Houston
Seattle

NYC
LA
Houston
Seattle

∗

500

J∗

500

300

100

50

10−3



J alt

50

100

300

60

80

tf − ti

100

120

60

80

tf − ti

100

120

Figure 4: Effects of varying the terminal suppression constraint  and the control horizon tf − ti .
(A) The optimal cost J ∗ obtained as the solution of the optimization problem (4) vs. the parameter . (B)
∗
The optimal cost J alt obtained as the solution of the optimization problem (7) vs. the parameter . (C) The
optimal cost J ∗ obtained as the solution of the optimization problem vs. the control horizon (tf − ti ). (D) The
∗
optimal cost J alt obtained as the solution of the optimization problem (7) vs. the control horizon (tf − ti ). The
parameter cq and cp are both set to 1.

16

400

(tf − ti )

120

300

100

80

200

80

0
35

60

+

10−5

+
10−4



10−3

100

60

+
195

200

150

5
10

+

10−5

10−4



120

10−3

200
+

100

150
80

100
+

J∗
250

60

0

210

100

C

J∗

21
0

500

+

130

(tf − ti )

120

B

J∗

(tf − ti )

A

12

+

10−5

+
10−4

100

10−3



Figure 5: The optimal cost J ∗ in the (tf − ti ),  plane. (A) shows the case of the Los Angeles Metropolitan
Statistical Area. (B) shows the case of the NYC Metropolitan Statistical Area. (C) shows the case of the Seattle
Metropolitan Statistical Area. For each city, Imax is chosen as the maximum of the range in Table 3. Type 1
solutions (in green) are more expensive than type 2 solutions (in blue.) The regions in yellow/red correspond to
the transition between the two types of solutions. The parameter cp and cq are both set to 1.
optimal control problem (4), for the cases of LA, NYC, and Seattle, as both the suppression parameter  and
the control horizon (tf − ti ) are varied. The transition is characterized by a gradual change in J ∗ , high for type
1 solutions (in green) and low for type 2 solutions (in blue), with a transition area in between shown in yellow
and red. This is illustrated in Fig. 5 and in more detail in Fig. 19 (LA), Fig. 20 (Seattle) and Fig. 21 (NYC) of
the Supplementary Note 5. Our results show that considerations about the timescale of the control action apply
differently to different cities. As can be seen, the particular emergence of type-1 or type-2 solutions is affected
by both the choice of  and (tf − ti ). From Fig. 5 (A) for LA we see that the most expensive control solutions are
achieved when one is trying to suppress the epidemics to a low level in a short time (small  and short tf − ti .)
This is opposite to what seen for NYC in Fig. 5 (B), where longer time horizons are usually associated with
more expensive solutions. The most convenient solution arises when the suppression constant  is large but the
control horizon is short (area shown in blue.) Finally, Fig. 5 (C) for Seattle shows that in the case of small ,
expensive solutions are obtained when the control horizon is either short or long, while an intermediate control
horizon is to be preferred. We also see that setting the suppression constraint to a larger value and the control
horizon to be short can reduce the cost considerably (which is similar to NYC). In general, these results point
out the importance of carefully choosing the timescale over which one is seeking to suppress the epidemics, as
well as the suppression level. Intuitively, our results indicate that suppressing the epidemics in a short time is
more costly when the epidemics is on the rise (LA) compared to cases when it is not (NYC.)
Next, we briefly consider the case that the transmissibility varies with time, i.e., we replace β → β(t) in Eq.
(2). This is consistent e.g., with a situation in which the weather gets colder (such as during the fall season in
the Northern emisphere), which has been associated with increased numbers of contagions. We then solve the
17

optimal control problem (2) (4) (5) (6) by computing the optimal control P ∗ (t) that minimizes the objective
function J.
The results of our calculations are shown in Fig. 6, where we focus on the New York City Metropolitan
Statistical Area and compare the two cases of constant transmissibility (previously studied) and time-varying
transmissibility. For simplicity we take β(t) to increase linearly in time, from the initial value in Table 1
β(ti ) = 1.806 to the final value β(tf ) = 2 × β(ti ) = 3.612. As can be seen, the optimal control solution P ∗ (t)
for the case of linearly increasing β differs substantially from the case of time-invariant β: in the central phase
P ∗ (t) is now seen to decrease linearly in time, indicating that to a linear increase in transmissibility corresponds
a linear decrease in the control parameter (an thus increasingly stricter measures of social distancing). This can
be used to plan long-term control interventions over periods of time over which the environmental conditions are
subject to well characterized variations that affect the rate of transmissibility of the disease.
Finally, we include here computation of the optimal control solution for a model modified to incorporate the
effects of the administration of an effective vaccine against COVID-19. When we initially started working on
this paper, there was no certainty about the development and future availability of a vaccine. However, as of
February 2021, we are now seeing several effective vaccines being developed, manufactured, and administered in
different countries. An important observation is that the production and distribution of the vaccine is a process
that takes time. For example, the United States is aiming to administer one million vaccine doses per day [54],
which considering the entire US population, corresponds to a time-scale of roughly one year to achieve complete
immunization. An important question is thus how the introduction of the vaccine is going to modify the optimal
control solutions. To address this point, we (i) modify the model to include the effects of the vaccine being
administered to the population, (ii) re-parametrize the model from real data and (iii) compute new optimal
control solutions. We briefly outline this process below.
We model the effects of administration of the vaccine as an additional flow from the S compartment to the
R compartment. To accommodate for this, we keep using the set of equations (2), but replace Eq. (2a) with the
following one,
Ṡ (t) = −βP 2 (t) S(t) [Is (t) + Itp (t) + µA(t)] − κ(t − tv )
and Eq. (2g) with

Ṙ (t) = γA A(t) + γI [Is (t) + Itp (t) + Q(t)] + κ(t − tv ),

where we take t ≥ tv and tv is the time the vaccine administration started, which for the United States is 14-Dec2020. Note that the model accounts for a rate of immunization linearly increasing with time, which is consistent
with available data up to 2-Feb-2021, when we carried out this analysis.
In our calculations we focused on the MSA of Seattle, for which we estimated κ = 0.000045 (see the Supplementary Information Note 11 for more details.) We then used the same approach outlined before to parametrize
the model. The parameters were inferred by the daily case reports over the extended period of time from 21Jan-2020 to 14-Dec-2020. More information about the parametrization can also be found in the Supplementary
Note 11. We then re-computed the optimal control solution by selecting the time at which we start optimizing
the control action ti = tv + 7 and by varying the control horizon Tcont = (tf − ti ). As we already pointed out
before, we found the choice of the control horizon to strongly affect the results of the optimization.
18

A

0.5

B

0.7

Imax = 0.0088,  = 10−5 ,
β is constant

0.5

P ∗ (t)

P ∗ (t)

0.7

Imax = 0.0088,  = 10−5 ,
β is time varying

0.3

0.3

D

C

0.016

0.016

10-08-20

09-08-20

07-08-20

10-08-20

0.000
09-08-20

0.000
08-08-20

0.008

07-08-20

0.008

08-08-20

Imax
Q(t)
Itp + Is

Figure 6: Time-varying transmissibility. We consider the NYC Metropolitan Statistical Area. Left plots:
time-invariant transmissibility. Right plots: the transmissibility increases linearly in time. As can be seen, with
the exception of the initial phase and of the final phase, the case of linearly increasing transmissibility corresponds
to a linearly decreasing optimal control input P ∗ (t).
Figure 7 shows the results of our computations for the city of Seattle by choosing two different values of the
control horizon, Tcont = (tf − ti ) = 130 days (on the left) and Tcont = (tf − ti ) = 150 days (on the right.) In both
plots, we compared the two cases that the model includes the effects of vaccination (gray curve, κ = 0.000045)
or does not (black curve, κ = 0.) The full black dot indicates the point in time at which the two curves depart
from each other. Both plots show the optimal control solution to deviate at an early time, roughly 15 to 25
days after the beginning of the administration of the vaccine (which corresponds to approximately 6% to 8%
19

of the population getting vaccinated.) This indicates that vaccinations can affect the optimal control solution,
even when a relatively little percentage of the population is immunized. In all the simulations we have always
seen the optimal control solution to deviate soon after the beginning of vaccinations. Moreover, the separation
between the two curves appears to be larger over the longer control horizon. The plot on the right shows the
parameter P ∗ (t) approach 1 at the end of the control horizon, which corresponds to complete removal of the
social distancing measures.
Our results point out that in a realistic scenario the optimal level of social distancing is affected by the
introduction of vaccinations, especially over longer periods of time. This is not surprising as the expectation is
that the long-term effect of administration of the vaccines will be relaxation of the social distancing measures.
However, the advantage of our analysis is that it can be used to assess the most economically advantageous level
of social distancing while the vaccines are being administered to the population. For example, Fig. 7B shows
substantial relaxation of social distancing roughly five months after the date in which administration of the
vaccines began. We remark that the derived timescale (150 days) is subject to the simple vaccination model, in
which we optimistically assume that (1) all the doses are reserved for and administered to only the susceptible
population, and (2) the production of the vaccines remains linear in this 150 days. Our simulation shows that,
with these two assumptions, at the end of this period herd immunity is achieved and social distancing is removed.
However, such a timescale can be treated as an optimistic forecast; the real timescale to reach herd immunity
could be longer due to the violation of either of the assumptions. It is important to point out once again that the
optimization we perform is one for which the goal is to minimize the impact of social distancing on the economy,
in the presence of relevant public health constraints.

20

A
1

P ∗ (t)

0.6

0.4

0.2

0.2
385
410
Time t

435

460

Vaccine

0.6

0.4

360

Non-vaccine

0.8

Vaccine

335

tf − ti = 150

1

Non-vaccine

0.8
P ∗ (t)

B

tf − ti = 130

335

360

385

410
435
Time t

460

485

Figure 7: Effects of vaccinations on the optimal control solution. We consider the Seattle Metropolitan
Statistical Area. In A the control horizon Tcont = (tf − ti ) = 130 days and in B the control horizon Tcont =
(tf − ti ) = 150 days. For both figures, we plot P ∗ (t) by comparing the two cases that the model includes the
effects of vaccination (gray curve) or does not (black curve.) The full black dot indicates the point in time at
which the two curves depart from each other. As can be seen, the separation between the two curves appears
to be much larger over a longer control horizon. The plot on the right shows the parameter P ∗ (t) approach 1 at
the end of the control horizon, which corresponds to removal of the social distancing measures. Additional plots
showing the time evolutions of the states corresponding to the optimal solutions in A and B can be found in the
Supplementary Information, Note 11.

Discussion
Our analysis reveals that the cost of eradicating the disease—i.e., suppressing the number of infected individuals
down to a certain critical threshold, such as  1 person in the formulation of our stylized mathematical model,
even in the optimal case, is significantly higher than the cost of ‘managing’ the pandemic to avoid the saturation
of regional medical resources. In light of the current progression of the pandemic in the US, our analysis
brings rigorous scientific and quantitative foundation for the latter strategy, which is adopted by many local
administrations (e.g., State offices.)
Our conclusion that the optimal control solution is well approximated by a constant level of social distancing
contrasts with the implemented system of reopening ‘in phases’ [16]. In many countries, the expected progression
is from phase 1 to phase 2 and higher, but there have been several cases in which a premature reopening followed
by a rise in COVID-19 numbers has led to folding back into phase 1 [48, 51, 19, 25]. Based on our results,
such alternating control interventions are suboptimal because the economic benefits of momentarily relaxing the
restrictions are lower than the costs associated with the successive tightening (such as e.g., a second lockdown.)
21

Instead we have shown that in the presence of smoothly time-varying environmental conditions (e.g., affecting
the transmissibility), the optimal control solution also varies smoothly in time. This allows us to plan longterm control interventions over periods of time over which the environmental conditions are subject to well
characterized variations that affect the rate of transmissibility of the disease.
Several countries have adopted control strategies that are region-specific. For example, Italy has assigned to
its regions color-coded restrictions (yellow, orange, and red) [35], which, based on a careful monitoring of the local
progression of the disease, have been updated frequently. Our model focuses on individual MSA’s (or regions) and
as such neglects the larger-scale spatial resolution of the epidemic. The need for frequent updates of the control
interventions provides evidence of the inherent difficulty of ‘closing the control loop’, due to many possible factors,
such as partial and incorrect measurements, delays in obtaining information and implementing actions, imperfect
application of the controls, lack of resources, the effects of people traveling from area to area, and others. While
all these factors would require separate consideration, our main recommendation that interventions should be
maintained at a (nearly) constant level stands. Our work indicates that the best intervention for the economy
is one that does not fluctuate in time, while alternating control actions are suboptimal. In addition, frequently
changing interventions present other disadvantages which have made them unpopular [9]: they are difficult to
implement, and to follow, and they negatively affect business planning capability.
Occasionally, there have been claims by policy makers and/or scientists that seeking herd immunity by
exposure to the virus (in the absence of a vaccine) may provide the best long-term path-forward [34, 23]. However,
the timescales over which herd immunity can be achieved without violating the Imax constraint appear to be quite
long (see Methods) in the absence of a vaccine. By setting a very large control horizon in our simulations, we
have seen the emergence of these ‘herd immunity solutions’, shown in the Supplementary Note 6. However,
the parameters of our realistic scenarios, estimated from real data, are far away from the point at which such
solutions are optimal. In general, our study allows to quantify how ‘far’ one is in the parameter space from the
point at which a herd immunity solution becomes optimal.

Conclusion
In this paper, we have proposed an approach to optimize social distancing measures in time in order to contain the
spread of the COVID-19 epidemics, while minimizing the impact on the economy. Our analysis has been applied
to four different metropolitan statistical areas within the US, but can be directly applied to other geographical
areas. Each MSA was shown to be well described by a stylized mathematical model whose parameters were
inferred by daily new case counts reported by local health administrations. Our approach based on modeling,
inferring model parameters from real data, and computing optimal control solutions for the inferred model is
general and may be applied to other complex systems of interest.
Our choice of the objective function is quite simplified, namely we assume that increasing levels of social
distancing and quarantining result in progressively higher economical costs. In addition, we did not account for
the cost associated with medical treatments, which is important yet significantly smaller than the cost of shutting
down the economical activities of the entire society [12]. Our approach can be easily generalized to other more
22

complex, more realistic types of objective functions, see e.g., [49, 50]. Different from this study, these objective
functions may also be specific to given regions or try to capture a particular socio-economical model of interest.
We have found that the optimal control solutions are quite robust to the specific choice of the objective
function and of its parameters, such as cq . These control solutions tend to be qualitatively similar for different
cities. However, they are affected by the choice of the constraints, in particular the constraint that we have
associated to suppression of the epidemic, and by the time horizon of the control action. When these are varied,
different cities behave differently, which points out the importance of our data-driven approach. We have also
seen that small deviations from the optimal solution can lead to dramatic violations of the constraints.
It is possible to translate these optimal interventions in actual measures that can be imposed on the population,
such as restricting the access to certain businesses or venues. Available technology includes the usage of coupled
digital non-contact healthcare systems [39]. While implementation of a time-varying control may be challenging
in practice, we found that the optimal solution is typically characterized by an initial drop (due essentially to
the non-optimality of current control interventions), followed by a nearly constant control (specific to each city)
for a long time, and by a final drop, which is needed to achieve the desired suppression of the epidemics at the
final time. Thus the optimal control solution is almost constant except for the initial time and the final time,
which significantly increases the applicability of this study. The constant part of the solution could be practically
achieved by dynamical regulation to control the time-varying reproduction number Rt ≈ 1. A key observation
is that the optimal solution P ∗ is generally lower than the value of P inferred by data. The initial drop in P ∗
may provide a measure of non-optimality of current interventions. This drop was seen to be smallest for NYC
compared to other US cities, but was present in all the cities we have analyzed.
The time-scale of control interventions, i.e., the control horizon, appears to play a fundamental role. Considerations about the control horizon may vary from area to area and may be affected by a number of factors,
including the times at which a vaccine becomes available and is distributed to the population. It appears that
cities that have seen an increase of cases during the inference period need a longer control horizon to suppress the
epidemics optimally. In certain instances, the impact on the economy can be minimized by tuning the control
horizon; for example, for the city of Seattle we found that an optimal control horizon was equal to roughly 90
days when the suppression constraint  = 10−5 . We wish to emphasize that given the very large economical
impact of social distancing measures, even a small improvement in the control strategy can lead to considerable
economical benefits.
We also computed the most economically advantageous level of social distancing during the time over which
the vaccines are administered to the population. Our simulations show that the optimal control solution is affected
by the introduction of the vaccine quite early on, which indicates the possibility of gradually relaxing measures
of social distancing soon after the beginning of vaccinations and strongly reduce them roughly five months later.
While optimal control interventions computed during the vaccination period were found to be quite sensitive
to the specific choice of model and control parameters, in all of our simulations we always saw that a gradual
relaxation of social distancing measures was possible when roughly 10% of the population got vaccinated. We
acknowledge that our study on the effects of the vaccines is limited, as we only focus on one region and we see
that the optimal control solution is strongly affected by the choice of the control horizon. We also do not consider
23

the emergence of new variants against which existing vaccines may be less effective. Our assumption of a linearly
increasing rate of vaccination of the population should be validated by using region-specific data. Extending the
analysis to other regions and incorporating more realistic data would require a major effort that is beyond the
scope of this paper. Our conclusion that over longer time periods vaccination would allow substantial reductions
in the level of social distancing, should be taken with the due precautions. One should be reminded that our
objective in this paper is to minimize the impact of social distancing on the economy, in the presence of relevant
public health constraints. Nonetheless, our approach based on modeling, model parametrization, and optimal
control, could be easily adapted to different geographical areas to provide region-specific recommendations.
We briefly discuss next other limitations of our work. Limited testing capabilities may affect some of our
results. The model could benefit from incorporation of considerations about spatial effects. Many regulations
have been introduced to limit people’s mobility during the pandemic; however essential travel has often remained
in place, which has probably been responsible for much of the disease’s propagation. One first step to incorporate
spatial resolution in the model would be considering an extension of the model with two communicating regions.
This could be the subject of future work.
One relevant question is whether policy-makers can assess whether a currently employed control action is
optimal or not. The so-called HAMVET procedure, initially proposed in [6] and presented in the Supplementary
Note 9, can be used to validate a control strategy and evaluate its optimality.

References
[1] ”Daily COVID-19 vaccine doses administered”. Our World in data.
grapher/cumulative-covid-vaccinations. February 2020.

https://ourworldindata.org/

[2] LANL COVID-19 Prediction GitHub.
[3] Ministry of Health, Official report on the cruise ship Diamond Princess, May 1, 2020.
[4] New York Times repository of Covid-19 data in the United States.
[5] U.S. Office of Management and Budget Delineation Files.
[6] Daron Acemoglu, Victor Chernozhukov, Iván Werning, and Michael D Whinston. A multi-risk sir model
with optimally targeted lockdown. Technical report, National Bureau of Economic Research, 2020.
[7] Sean C Anderson, Andrew M Edwards, Madi Yerlanov, Nicola Mulberry, Jessica Stockdale, Sarafa A Iyaniwura, Rebeca C Falcao, Michael C Otterstatter, Michael A Irvine, Naveed Z Janjua, et al. Estimating the
impact of covid-19 control measures using a bayesian model of physical distancing. medRxiv, 2020.
[8] Christophe Andrieu and Johannes Thoms. A tutorial on adaptive mcmc. Statistics and computing, 18(4):343–
373, 2008.
24

[9] Crispian Balmer Balmer. Italian regions angry over government’s covid-19 zones. Reuters, 2020.
[10] Victor M Becerra. Solving complex optimal control problems at no cost with psopt. In 2010 IEEE International Symposium on Computer-Aided Control System Design, pages 1391–1396. IEEE, 2010.
[11] Sheryl L Chang, Nathan Harding, Cameron Zachreson, Oliver M Cliff, and Mikhail Prokopenko. Modelling
transmission and control of the covid-19 pandemic in australia. arXiv preprint arXiv:2003.10218, 2020.
[12] Jiangzhuo Chen, Anil Vullikanti, Stefan Hoops, Henning Mortveit, Bryan Lewis, Srinivasan Venkatramanan,
Wen You, Stephen Eubank, Madhav Marathe, Chris Barrett, et al. Medical costs of keeping the us economy
open during covid-19. Scientific reports, 10(1):1–10, 2020.
[13] IHME COVID, Christopher JL Murray, et al. Forecasting covid-19 impact on hospital bed-days, icu-days,
ventilator-days and deaths by us state in the next 4 months. MedRxiv, 2020.
[14] Seth Flaxman, Swapnil Mishra, Axel Gandy, H Unwin, Helen Coupland, T Mellan, Harisson Zhu, Tresnia
Berah, J Eaton, P Perez Guzman, et al. Report 13: Estimating the number of infections and the impact of
non-pharmaceutical interventions on covid-19 in 11 european countries. 2020.
[15] France 24. 2020.
”Germany reimposes local lockdowns after regional coronavirus outbreak”.
France 24.
https://www.france24.com/en/20200623-germany-reimposes-local-lockdown-aftercoronavirus-outbreak. August 2020.
[16] Scott Gottlieb, Caitlin Rivers, Mark B McClellan, Lauren Silvis, and Crystal Watson. National coronavirus
response: a road map to reopening. AEI Paper & Studies, 2020.
[17] Anu G Gupta, Cheryl A Moyer, and David T Stern. The economic impact of quarantine: Sars in toronto
as a case study. Journal of Infection, 50(5):386–393, 2005.
[18] Janet Christenbury. 2020. ”Study in ICU Finds 30.9% Mortality Rate From COVID-19”. Futurity. https:
//www.futurity.org/covid-19-mortality-rate-2377362-2/. August 2020.
[19] Ashifa Kassam. Spain warned of dire impact of second coronavirus lockdown. The Guardian, 2020.
[20] Donald E Kirk. Optimal control theory: an introduction. Courier Corporation, 2004.
[21] Johannes Köhler, Lukas Schwenkel, Anna Koch, Julian Berberich, Patricia Pauli, and Frank Allgöwer.
Robust and optimal predictive control of the covid-19 outbreak. arXiv preprint arXiv:2005.03580, 2020.
[22] Miklós Koren and Rita Pető. Business disruptions from social distancing. arXiv preprint arXiv:2003.13983,
2020.

25

[23] Kin On Kwok, Florence Lai, Wan In Wei, Samuel Yeung Shan Wong, and Julian WT Tang. Herd immunity–
estimating the level required to halt the covid-19 epidemics in affected countries. Journal of Infection,
80(6):e32–e33, 2020.
[24] Stephen A Lauer, Kyra H Grantz, Qifang Bi, Forrest K Jones, Qulu Zheng, Hannah R Meredith, Andrew S
Azman, Nicholas G Reich, and Justin Lessler. The Incubation Period of Coronavirus Disease 2019 (COVID19) From Publicly Reported Confirmed Cases: Estimation and Application. Annals of internal medicine,
2019, 2020.
[25] Jasmine C. Lee, Sarah Mervosh, Yuriria Avila, Barbara Harvey, and Alex Leeds Matthews. Spain warned
of dire impact of second coronavirus lockdown. The New York Times, 2020.
[26] Yen Ting Lin, Jacob Neumann, Ely F Miller, Richard G Posner, Abhishek Mallela, Cosmin Stafa, Jaideep
Ray, Gautam Thakur, Supriya Chinthavali, and William S Hlavacek. Daily Forecasting of New Cases
for Regional Epidemics of Coronavirus Disease 2019 with Bayesian Uncertainty Quantification. In press,
Emerging Infectious Diseases, preprint available at https://www.medrxiv.org/content/10.1101/2020.
07.20.20151506v2, 2021.
[27] Lisa Mataloni, Dave Wasshausen, Erich Strassner, Jeannine Aversa. 2020. ”Gross Domestic Product, Second
Quarter 2020 (Advance Estimate) and Annual Update”. U.S. Bureau of Economic Analysis. https://www.
bea.gov/sites/default/files/2020-07/gdp2q20_adv_0.pdf. August 2020.
[28] Xiaofan Liu, Hong Zhou, Yilu Zhou, Xiaojun Wu, Yang Zhao, Yang Lu, Weijun Tan, Mingli Yuan, Xuhong
Ding, Jinjing Zou, et al. Risk factors associated with disease severity and length of hospital stay in covid-19
patients. Journal of Infection, 81(1):e95–e97, 2020.
[29] Lother Wieler, Ute Rexroth, Rene Gottschalk. 2020. ”Emerging COVID-19 success story: Germany’s strong
enabling environment”. Our World in data. https://ourworldindata.org/covid-exemplar-germany.
August 2020.
[30] Dylan H Morris, Fernando W Rossine, Joshua B Plotkin, and Simon A Levin. Optimal, near-optimal, and
robust epidemic control. arXiv preprint arXiv:2004.02209, 2020.
[31] Maria Nicola, Zaid Alsafi, Catrin Sohrabi, Ahmed Kerwan, Ahmed Al-Jabir, Christos Iosifidis, Maliha
Agha, and Riaz Agha. The socio-economic implications of the coronavirus pandemic (covid-19): A review.
International journal of surgery (London, England), 78:185, 2020.
[32] Hiroshi Nishiura, Natalie M Linton, and Andrei R Akhmetzhanov. Serial interval of novel coronavirus
(covid-19) infections. International journal of infectious diseases, 2020.
[33] Jorge Nocedal and Stephen Wright. Numerical optimization. Springer Science & Business Media, 2006.
26

[34] Eric JW Orlowski and David JA Goldsmith. Four months into the covid-19 pandemic, sweden’s prized herd
immunity is nowhere in sight. Journal of the Royal Society of Medicine, 113(8):292–298, 2020.
[35] Matteo M Pelagatti. Assessing the effectiveness of the italian risk-zones policy during the second wave
of covid-19. University of Milan Bicocca Department of Economics, Management and Statistics Working
Paper, (457), 2020.
[36] Javier Perez-Saez, Stephen A Lauer, Laurent Kaiser, Simon Regard, Elisabeth Delaporte, Idris Guessous,
Silvia Stringhini, Andrew S Azman, Serocov-POP Study Group, et al. Serology-informed estimates of
sars-cov-2 infection fatality risk in geneva, switzerland. medRxiv, 2020.
[37] Pipetius Quah, Andrew Li, and Jason Phua. Mortality rates of patients with covid-19 in the intensive care
unit: a systematic review of the emerging literature. Critical Care, 24:1–4, 2020.
[38] Petar Radanliev, David De Roure, and Rob Walton. Data mining and analysis of scientific research data
records on covid-19 mortality, immunity, and vaccine development-in the first wave of the covid-19 pandemic.
Diabetes & Metabolic Syndrome: Clinical Research & Reviews, 14(5):1121–1132, 2020.
[39] Petar Radanliev, David De Roure, Rob Walton, Max Van Kleek, Rafael Mantilla Montalvo, Omar Santos,
Stacy Cannady, et al. Covid-19 what have we learned? the rise of social machines and connected devices in
pandemic management following the concepts of predictive, preventive and personalized medicine. EPMA
Journal, pages 1–22, 2020.
[40] Haley E Randolph and Luis B Barreiro. Herd immunity: Understanding covid-19. Immunity, 52(5):737–741,
2020.
[41] Anil V Rao. A survey of numerical methods for optimal control. Advances in the Astronautical Sciences,
135(1):497–528, 2009.
[42] Safiya Richardson, Jamie S. Hirsch, Mangala Narasimhan, James M. Crawford, Thomas McGinn, Karina W.
Davidson, , and the Northwell COVID-19 Research Consortium. Presenting Characteristics, Comorbidities,
and Outcomes Among 5700 Patients Hospitalized With COVID-19 in the New York City Area. JAMA,
323(20):2052–2059, 05 2020.
[43] I Michael Ross. A primer on Pontryagin’s principle in optimal control. Collegiate publishers, 2015.
[44] I Michael Ross and Mark Karpenko. A review of pseudospectral optimal control: From theory to flight.
Annual Reviews in Control, 36(2):182–197, 2012.
[45] Nick Warren Ruktanonchai, JR Floyd, Shengjie Lai, Corrine Warren Ruktanonchai, Adam Sadilek, Pedro
Rente-Lourenco, Xue Ben, Alessandra Carioli, Joshua Gwinn, JE Steele, et al. Assessing the impact of
coordinated covid-19 exit strategies across europe. Science, 2020.
27

[46] Aki Sakurai, Toshiharu Sasaki, Shigeo Kato, Masamichi Hayashi, Sei-ichiro Tsuzuki, Takuma Ishihara,
Mitsunaga Iwata, Zenichi Morise, and Yohei Doi. Natural History of Asymptomatic SARS-CoV-2 Infection.
New England Journal of Medicine, 0(0):null.
[47] Steven Sanche, Yen Ting Lin, Chonggang Xu, Ethan Romero-Severson, Nicolas W Hengartner, and Ruian
Ke. The novel coronavirus, 2019-ncov, is highly contagious and more infectious than initially estimated.
arXiv preprint arXiv:2002.03268, 2020.
[48] Allan Saul, Nick Scott, Brendan S Crabb, Suman S Majundar, Benjamin Coghlan, and Margaret E Hellard.
Victoria’s response to a resurgence of covid-19 has averted 9,000-37,000 cases in july 2020. The Medical
Journal of Australia, page 1, 2020.
[49] Afroza Shirin, Fabio Della Rossa, Isaac Klickstein, John Russell, and Francesco Sorrentino. Optimal regulation of blood glucose level in type i diabetes using insulin and glucagon. PloS one, 14(3):e0213665,
2019.
[50] Afroza Shirin, Feng Song, Yen-Ting Lin, William S Hlavacek, and Sorrentino S. Prediction of optimal drug
schedules for controlling autophagy. Scientific Reports, 9(1428), 2019.
[51] Lorenzo Tondo. Italy at crossroads as fears grow of covid-19 second wave. The Guardian, 2020.
[52] Nguyen Van Vinh Chau, Vo Thanh Lam, Nguyen Thanh Dung, Lam Minh Yen, Ngo Ngoc Quang
Minh, Le Manh Hung, Nghiem My Ngoc, Nguyen Tri Dung, Dinh Nguyen Huy Man, Lam Anh Nguyet,
Le Thanh Hoang Nhat, Le Nguyen Truc Nhu, Nguyen Thi Han Ny, Nguyen Thi Thu Hong, Evelyne Kestelyn,
Nguyen Thi Phuong Dung, Tran Chanh Xuan, Tran Tinh Hien, Nguyen Thanh Phong, Tran Nguyen Hoang
Tu, Ronald B Geskus, Tran Tan Thanh, Nguyen Thanh Truong, Nguyen Tan Binh, Tang Chi Thuong, Guy
Thwaites, Le Van Tan, and Oxford University Clinical Research Unit COVID-19 Research Group. The Natural History and Transmission Potential of Asymptomatic Severe Acute Respiratory Syndrome Coronavirus
2 Infection. Clinical Infectious Diseases, 2020.
[53] Andreas Wächter and Lorenz T Biegler. On the implementation of an interior-point filter line-search algorithm for large-scale nonlinear programming. Mathematical programming, 106(1):25–57, 2006.
[54] Xutong Wang, Zhanwei Du, Kaitlyn Johnson, Spencer Fox, Michael Lachmann, Jason S McLellan, and
Lauren Ancel Meyers. The impacts of covid-19 vaccine timing, number of doses, and risk prioritization on
mortality in the us. medRxiv, 2021.
[55] Roman Wölfel, Victor M Corman, Wolfgang Guggemos, Michael Seilmaier, Sabine Zange, Marcel A Müller,
Daniela Niemeyer, Terry C Jones, Patrick Vollmar, Camilla Rothe, et al. Virological assessment of hospitalized patients with covid-2019. Nature, 581(7809):465–469, 2020.

28

Methods
Estimation of Imax
The Imax values can be approximated with simple assumptions as seen in Table 3 for a selection of major U.S.
cities. These Imax values are a ratio of ICU beds to the population of people which require them. Following [26],
we estimate that the probability of death conditioned on symptomatic infection is equal to fH ×(1−fR ) = 0.01134,
where the two parameters fH and fR were independently computed in [36] and [42], respectively. Data [37, 18]
shows that the mortality rate for patients sent to ICU is between 30% and 40%, thus, it is reasonable to assume
that an overall fraction of infected people equal to 0.01134/0.35 = 0.0324 needs ICU beds. In the hypothetical
situation that the population of an entire state contracts COVID-19 3.24% will require an ICU bed. The ρ term
is a modifier which denotes how many ICU beds are available to COVID-19 patients as some beds could be used
for other reasons. Reasonably, the value of ρ ranges from 2/3 to 1 in Table 3. Imax is then calculated as the
number of available ICU beds (including the ρ assumption) divided by number people which contract COVID-19
and also require an ICU bed (3.24% assumption).
Table 3: Imax values for U.S. Cities
City

Imax (ρ = 2/3)

Imax (ρ = 1)

New York, NY
Los Angeles, CA
Chicago, IL
Dallas, TX
Houston, TX
Riverside, CA
Miami, FL
Philadelphia, PA
Atlanta, GA
Phoenix, AZ
Boston, MA
San Francisco, CA
Seattle, WA
Indianapolis, IN
Detroit, MI
Baltimore, MD
Denver, CO
Portland, OR
Las Vegas, NV

0.88%(5704/648000)
0.64% (8241/1280124)
1.00%(4094/410508)
0.86%(8109/939600)
0.86%(8109/939600)
0.64% (8241/1280124)
0.98% (6829/695952)
1.047%(4342/414720)
0.65%(2249/344088)
0.55%(1309/2358450)
0.4%(893/223330)
0.64% (8241/1280124)
0.46%(1143/246888)
0.83%(1811/218120)
0.71%(2315/32358)
0.40%(893/223330)
0.56%(1039/186590)
0.56%(768/136660)
0.75%(752/99792)

1.32% (8556/648000)
0.97%(12361/1280124)
1.50%(6141/410508)
1.29%(12163/939600)
1.29%(12163/939600)
0.97%(12361/1280124)
1.47%(10244/695952)
1.57%(6513/414720)
0.98%(3374/344088)
0.83%(1963/2358450)
0.60%(1340/223330)
0.97%(12361/1280124)
0.69%(1714/24688)
1.25%(2716/218120)
1.07%(3472/32358)
0.60%(1340/223330)
0.84%(1559/186590)
0.84%(1152/136660
1.13%(1129/99792)

29

For all our numerical experiments, we consider two values for Imax , one corresponding to ρ = 2/3 and another
one corresponding to ρ = 1.

Timescale for Therd
We now attempt to answer the following question. By enforcing satisfaction of the constraint with the equal sign
Is (t) + Itp (t) = Imax and in the absence of a vaccine, how long would it take before herd immunity is achieved?
By assuming long-term immunity of those recovered from the virus, we can expect herd immunity to arise when
roughly 80% of the population has been exposed [40]. Consider for example the case of NYC for which from
Table 3 we see that Imax is between 0.88 % and 1.32 %. We assume an average hospitalization of 20 days [28].
That means that the time to achieve herd immunity Therd varies between 606 days=(80 × 20/(1.32 × 2)) and 909
days=(80 × 12/(0.88 × 2)). The factor of 2 accounts for the fact that roughly one exposed person out of two
develops symptoms. Analogously, for Chicago, we estimate Therd to vary between 533 days=(80 × 20/(1.5 × 2))
and 800 days=(80 × 20/(1 × 2)). From these back-of-the-envelope calculations we see that the timescale over
which herd immunity can be achieved without violating the Imax constraint appears to be quite long and definitely
longer than the timescale over which vaccines have become available.

Acknowledgements
The authors would like to thank Bill Hlavacek, Isaac Klickstein, Neethi Thevan T., and Enrico Del Frate for
insightful discussions. Y.T.L. thanks the support from the Laboratory Directed Research and Development
Program at Los Alamos National Laboratory (Project XX01) through the Center for Nonlinear Studies(CNLS).

30

Supplemental Materials: Data-driven Optimized Control of the COVID-19
Epidemics

1

Supplementary Note 1: Model Scheme
The compartmental model described by Eq. 2 in the main text can be visualized in Figure 1 below.

Figure S1: Compartmental model

Supplementary Note 2: Robustness of the optimal control with respect to variations of the parameters cq and Imax
We now investigate the effect of varying the parameters cq and Imax on the optimal control solutions. Our main
result is that we find the optimal control solutions to be robust to variations in both cq and Imax . We choose two
values of Imax , a value corresponding to the lower value shown in Table 3 of the main manuscript (ρ = 2/3) and
a value corresponding to the larger value shown in Table 3 of the main manuscript (ρ = 1). In Figs. S2 and S3,
the states and the optimal controls are plotted for the NYC scenario, for Imax = 0.0088 and 0.0132, respectively.
In Figs. S4 and S5, the states and the optimal controls are plotted for the LA scenario, for Imax = 0.0066 and
0.0097, respectively. In Figs. S6 and S7, the states and the optimal controls are plotted for the Houston scenario,

2

for Imax = 0.0088 and 0.0129, respectively. In Figs. S8 and S9, the states and the optimal controls are plotted
for the Houston scenario, for Imax = 0.0046 and 0.0069, respectively.
All our results in Figs. S2, S3, S4, S5, S6, S7, S8 and S9 show that the optimal control solutions are robust
to variations in cq .
Imax = 0.0088, cq = 1

Imax = 0.0088, cq = 3

0.3

0.3

Q(t)

R(t)

Imax

0.1

0

0.2
Itp + Is

Q(t)

R(t)

Imax

States

0.2
Itp + Is

States

0.2

0.1

0
170

200
230
Time t

260

170

200
230
Time t

260

170

0.4

0.4

0.4

P ∗ (t)

P ∗ (t)

0.5

0.3

200
230
Time t

260

R(t)

Imax

0

0.5

0.2 170

Q(t)

0.1

0.5

0.3

Itp + Is

200
230
Time t

260

P ∗ (t)

States

Imax = 0.0088, cq = 6

0.3

0.2 170

0.3

200
230
Time t

260

0.2 170

200
230
Time t

260

Figure S2: NYC Scenario. Imax = 0.0088, minimum of the range.
Figure (S10) is analogous to Figure 3 shown in the main manuscript but for the case that Imax are chosen as
the maximum values in Table 3 of the main manuscript (ρ = 1.) As can be seen the solutions are the same as in
Figure 3 of the main manuscript.

3

Imax = 0.0132, cq = 1

Imax = 0.0132, cq = 3

0.3

0.3

Q(t)

R(t)

Imax

0.1

0

0.2
Itp + Is

Q(t)

R(t)

Imax

States

0.2
Itp + Is

States

0.2

0.1

0
170

200
230
Time t

260

170

200
230
Time t

260

170

0.4

0.4

0.4

P ∗ (t)

P ∗ (t)

0.5

0.3

200
230
Time t

260

R(t)

Imax

0

0.5

0.2 170

Q(t)

0.1

0.5

0.3

Itp + Is

200
230
Time t

260

P ∗ (t)

States

Imax = 0.0132, cq = 6

0.3

0.2 170

0.3

200
230
Time t

260

0.2 170

Figure S3: NYC Scenario. Imax = 0.0132, maximum of the range.

4

200
230
Time t

260

Imax = 0.0066, cq = 1

Imax = 0.0066, cq = 3

0.3

0.3

Q(t)

R(t)

Imax

0.1

0

0.2
Itp + Is

Q(t)

R(t)

Imax

0.1

States

0.2
Itp + Is

States

0.2

0
170

200
230
Time t

260

170

200
230
Time t

260

170

0.6

0.6

0.6

P ∗ (t)

P ∗ (t)

0.8

0.4

200
230
Time t

260

R(t)

Imax

0

0.8

0.2 170

Q(t)

0.1

0.8

0.4

Itp + Is

200
230
Time t

260

P ∗ (t)

States

Imax = 0.0066, cq = 6

0.3

0.2 170

0.4

200
230
Time t

260

0.2 170

Figure S4: LA Scenario. Imax = 0.0066, minimum of the range.

5

200
230
Time t

260

Imax = 0.0097, cq = 1

Imax = 0.0097, cq = 3

0.3

0.3

Q(t)

R(t)

Imax

0.1

0

0.2
Itp + Is

Q(t)

R(t)

Imax

0.1

States

0.2
Itp + Is

States

0.2

0
170

200
230
Time t

260

170

200
230
Time t

260

170

0.6

0.6

0.6

P ∗ (t)

P ∗ (t)

0.8

0.4

200
230
Time t

260

R(t)

Imax

0

0.8

0.2 170

Q(t)

0.1

0.8

0.4

Itp + Is

200
230
Time t

260

P ∗ (t)

States

Imax = 0.0097, cq = 6

0.3

0.2 170

0.4

200
230
Time t

260

0.2 170

Figure S5: LA Scenario. Imax = 0.0097, maximum of the range.

6

200
230
Time t

260

Imax = 0.0086, cq = 1

Imax = 0.0086, cq = 3

Imax = 0.0086, cq = 6

0.1

Itp + Is

Q(t)

R(t)

Imax

0

0.2

0.1

Itp + Is

Q(t)

R(t)

Imax

States

0.2

States

0
170

200
230
Time t

260

0.1

170

200
230
Time t

260

170

0.8

0.8

0.8

0.6

0.6

0.6

P ∗ (t)

P ∗ (t)
0.4

0.2 170

0.4

200
230
Time t

260

Itp + Is

Q(t)

R(t)

Imax

200
230
Time t

260

0

P ∗ (t)s

States

0.2

0.2 170

200
230
Time t

260

0.4

0.2 170

Figure S6: Houston Scenario. Imax = 0.0086, minimum of the range.

7

200
230
Time t

260

Imax = 0.0129, cq = 1

Imax = 0.0129, cq = 3

Imax = 0.0129, cq = 6

0.1

Itp + Is

Q(t)

R(t)

Imax

0

0.2

0.1

Itp + Is

Q(t)

R(t)

Imax

States

0.2

States

0
170

200
230
Time t

260

0.1

170

200
230
Time t

260

170

0.8

0.8

0.8

0.6

0.6

0.6

P ∗ (t)

P ∗ (t)
0.4

0.2 170

0.4

200
230
Time t

260

Itp + Is

Q(t)

R(t)

Imax

200
230
Time t

260

0

P ∗ (t)s

States

0.2

0.2 170

200
230
Time t

260

0.4

0.2 170

Figure S7: Houston Scenario. Imax = 0.0129, maximum of the range.

8

200
230
Time t

260

Imax = 0.0046, cq = 1

Imax = 0.0046, cq = 3

Imax = 0.0046cq = 6

Q(t)

R(t)

Imax

0

Itp + Is

Q(t)

R(t)

Imax

States

Itp + Is

0.1

States

0.1

States

0.1

0
170

200
230
Time t

260

170

200
230
Time t

260

170
0.8

0.6

0.6

0.6

0.4

200
230
Time t

260

R(t)

Imax

200
230
Time t

260

P ∗ (t)

P ∗ (t)

P ∗ (t)

0.8

0.2 170

Q(t)

0

0.8

0.4

Itp + Is

0.2 170

0.4

200
230
Time t

260

0.2 170

Figure S8: Seattle Scenario. Imax = 0.0046, minimum of the range.

9

200
230
Time t

260

Imax = 0.0069, cq = 1

Imax = 0.0069, cq = 3

Imax = 0.0069cq = 6

Q(t)

R(t)

Imax

0

Itp + Is

Q(t)

R(t)

Imax

States

Itp + Is

0.1

States

0.1

States

0.1

0
170

200
230
Time t

260

170

200
230
Time t

260

170
0.8

0.6

0.6

0.6

0.4

200
230
Time t

260

R(t)

Imax

200
230
Time t

260

P ∗ (t)

P ∗ (t)

P ∗ (t)

0.8

0.2 170

Q(t)

0

0.8

0.4

Itp + Is

0.2 170

0.4

200
230
Time t

260

0.2 170

Figure S9: Seattle Scenario. Imax = 0.0069, maximum of the range.

10

200
230
Time t

260

0.3

E

Seattle(Imax = 0.0069)
0.7
0.5
0.3

G

H

1

1

1

0.4

0.4

0.2

0.2

0.2

0.2

0.016

0.016

0.016

0.016

0.008

0.008

0.008

0.000

0.000

0.000

Imax

0.008

Q(t)

10-08-20

08-08-20

07-08-20

09-08-20

Itp + Is

0.000

10-08-20

0.4

09-08-20

R(t)

08-08-20

0.6

0.4

07-08-20

0.6

10-08-20

0.8

0.6

09-08-20

0.8

S(t)

08-08-20

0.8

0.6

07-08-20

0.8

0.5

D

0.3

F
1

Houston(Imax = 0.0129)
0.7

10-08-20

0.5

C

09-08-20

0.3

LA(Imax = 0.0097)

08-08-20

0.7

07-08-20

0.5

B

P ∗ (t)

NYC(Imax = 0.0132)

P ∗ (t)

P ∗ (t)

0.7

P ∗ (t)

A

Figure S10: (A-D) Optimal control strategies for the metropolitan cities NYC, LA, Houston, Seattle, respectively.
(E-F) Time evolution of the states subject to the optimal control inputs in (A-D). Imax are chosen as the maximum
of the range in Table 3 of the main manuscript (ρ = 1) and cq = 1. The legends in (F-H) are same as the legend
in (E).

Supplementary Note 3: Effects of varying the terminal suppression
constraint 
Figures 11, 12, 13, and 14 show the effects of varying the final suppression constraint  on the optimal control
solutions, for the cases of the Metropolitan Statistical Areas of NYC, LA, Houston, and Seattle, respectively.
For all cities, we see that for large enough , solutions of type 2 emerge, for which Itp (t) + Is (t) = Imax for certain
times t. More specifically, this is seen for  = 3.16 × 10−4 and  = 10−3 in Figs. 11, 12, and 13 and for  = 10−3
in Fig. 14.

11

1
0.8
0.6
0.4
0.2

S(t)
R(t)

0.02
0.01

Imax

H
1
0.8
0.6
0.4
0.2

I
1
0.8
0.6
0.4
0.2

0.02

0.02

0.01

0.01

0.00

0.00
10-08-20

09-08-20

08-08-20

07-08-20

10-08-20

09-08-20

08-08-20

10-08-20

09-08-20

08-08-20

07-08-20

0.00

07-08-20

Q(t)
Itp + Is

0.4
J

1
0.8
0.6
0.4
0.2

1
0.8
0.6
0.4
0.2

0.03

0.03

0.02

0.02

0.01

0.01

0.00

0.00
10-08-20

G

0.4

0.6

09-08-20

0.4

0.6

0.8

08-08-20

F

0.6

0.8

 = 10−3

1

07-08-20

0.4

1

P ∗ (t)

0.6

0.8

E

 = 3.16 × 10−4

10-08-20

0.4

1

D

09-08-20

0.6

0.8

 = 10−4

08-08-20

P ∗ (t)

0.8

C

07-08-20

1

 = 3.16 × 10−5

P ∗ (t)

1
P ∗ (t)

B

 = 10−5

P ∗ (t)

A

Figure S11: (A-E) Optimal control strategies for the NYC for different values of the parameter . (F-J) Evolutions
of the states subject to the optimal control inputs in (A-E). Imax are chosen from the maximum range of Table
3 of the main manuscript, ρ = 1.

12

R(t)

0.02

0.02

0.02

0.01

0.01

0.00

0.00
10-08-20

09-08-20

08-08-20

07-08-20

10-08-20

10-08-20

09-08-20

08-08-20

07-08-20

0.00

09-08-20

Itp + Is

08-08-20

Q(t)

07-08-20

Imax

0.01

P ∗ (t)

0.4

I
1
0.8
0.6
0.4
0.2

0.6

J
1
0.8
0.6
0.4
0.2

1
0.8
0.6
0.4
0.2

0.03

0.03

0.02

0.02

0.01

0.01

0.00

0.00
10-08-20

S(t)

0.4

H
1
0.8
0.6
0.4
0.2

0.6

0.8

09-08-20

0.4

G
1
0.8
0.6
0.4
0.2

0.6

0.8

 = 10−3

1

08-08-20

F

0.4

1

07-08-20

0.2

0.6

0.8

E

 = 3.16 × 10−4

10-08-20

0.4

1

D

09-08-20

0.6

0.8

 = 10−4

08-08-20

P ∗ (t)

0.8

C

07-08-20

1

 = 3.16 × 10−5

P ∗ (t)

1
P ∗ (t)

B

 = 10−5

P ∗ (t)

A

Figure S12: (A-E) Optimal control strategies for LA for different values of the parameter . (F-J) Evolutions of
the states subject to the optimal control inputs in (A-E). Imax are chosen from the maximum range of Table 3 of
the main manuscript, ρ = 1.

13

R(t)

0.02

0.02

0.02

0.01

0.01

0.00

0.00

Imax

0.01

Q(t)

10-08-20

09-08-20

08-08-20

07-08-20

10-08-20

09-08-20

08-08-20

10-08-20

09-08-20

08-08-20

07-08-20

07-08-20

Itp + Is

0.00

P ∗ (t)

0.4

I
1
0.8
0.6
0.4
0.2

0.6

J
1
0.8
0.6
0.4
0.2

1
0.8
0.6
0.4
0.2

0.03

0.03

0.02

0.02

0.01

0.01

0.00

0.00
10-08-20

S(t)

0.4

H
1
0.8
0.6
0.4
0.2

0.6

0.8

09-08-20

0.4

G
1
0.8
0.6
0.4
0.2

0.6

0.8

 = 10−3

1

08-08-20

F

0.4

1

07-08-20

0.2

0.6

0.8

E

 = 3.16 × 10−4

10-08-20

0.4

1

D

09-08-20

0.6

0.8

 = 10−4

08-08-20

P ∗ (t)

0.8

C

07-08-20

1

 = 3.16 × 10−5

P ∗ (t)

1
P ∗ (t)

B

 = 10−5

P ∗ (t)

A

Figure S13: (A-E) Optimal control strategies for Houston for different values of the parameter . (F-J) Evolutions
of the states subject to the optimal control inputs in (A-E). Imax are chosen from the maximum range of Table
3 of the main manuscript, ρ = 1.

14

0.00

P ∗ (t)

0.02

0.02

0.01

0.01

0.00

0.00
10-08-20

0.00

0.03

09-08-20

0.01

0.03

08-08-20

10-08-20

09-08-20

08-08-20

07-08-20

0.00

0.01

1
0.8
0.6
0.4
0.2

07-08-20

Itp + Is

0.02

1
0.8
0.6
0.4
0.2

10-08-20

Q(t)

0.01

0.02

0.6

J

09-08-20

Imax

0.8
0.4

08-08-20

0.02

10-08-20

R(t)

0.6

I
1
0.8
0.6
0.4
0.2

09-08-20

S(t)

1
0.8
0.6
0.4
0.2

0.8

 = 10−3

1

0.4

H

08-08-20

1
0.8
0.6
0.4
0.2

1

0.4

G

07-08-20

F

0.4

0.6

E

 = 3.16 × 10−4

07-08-20

0.2

0.6

0.8

D

10-08-20

0.4

1

09-08-20

0.6

0.8

 = 10−4

08-08-20

P ∗ (t)

0.8

C

P ∗ (t)

1

 = 3.16 × 10−5

07-08-20

1
P ∗ (t)

B

 = 10−5

P ∗ (t)

A

Figure S14: (A-E) Optimal control strategies for Seattle for values of the parameter . (F-J) Evolutions of the
states subject to the optimal control inputs in (A-E). Imax are chosen from the maximum range of Table 3 of the
main manuscript, ρ = 1.

15

Supplementary Note 4: Effects of varying tf

0.6
0.4
170

230
290
Time t

0.4

Itp + Is

Q(t)

R(t)

Imax

0.2

0.4

Itp + Is

Q(t)

R(t)

Imax

230
Time t

290

0.4

Itp + Is

Q(t)

R(t)

Imax

290

0.4

Itp + Is

Q(t)

R(t)

Imax

290

0.4
230
290
Time t

0.4
0.2

0
230
Time t

0.6

J

0.2

170

0.8

0.2
170

230
290
Time t

I

0
230
Time t

0.6
170

0.2

170

0.8

230
290
Time t

tf = 290

1

0.4

H

0
170

0.4
170

0.2

0

0.6

230
290
Time t

G

1

0.8

E

tf = 275

P ∗ (t)

1

0.8

D

tf = 260

P ∗ (t)

1

F

C

tf = 245

P ∗ (t)

1
0.8
0.6
0.4
0.2
170

B

tf = 230

P ∗ (t)

P ∗ (t)

A

Itp + Is

Q(t)

R(t)

Imax

230
Time t

290

0
170

230
Time t

290

170

Figure S15: (A-E) Optimal control strategies for the NYC for different final times tf . (F-J) Evolutions of the
states subject to the optimal control inputs. Imax is chosen as the maximum of the range in Table 3 of the main
manuscript (ρ = 1).

16

230
290
Time t

F

230
290
Time t

G
0.4

Itp + Is

Q(t)

R(t)

Imax

0.2

0.4

Itp + Is

Q(t)

R(t)

Imax

230
Time t

290

0.4

Itp + Is

Q(t)

R(t)

Imax

230
Time t

290

230
290
Time t

0.8
0.6
0.4
0.2
0
170

0.4

Itp + Is

Q(t)

R(t)

Imax

230
Time t

290

0.4
0.2

0
170

230
290
Time t

J

0.2

0
170

tf = 290

E

I

0.2

0
170

230
290
Time t

0.8
0.6
0.4
0.2
0
170

H

0.2

0

0.8
0.6
0.4
0.2
0
170

tf = 275

D

P ∗ (t)

0.8
0.6
0.4
0.2
0
170

tf = 260

C

P ∗ (t)

P ∗ (t)

P ∗ (t)

0.8
0.6
0.4
0.2
0
170

tf = 245

B

P ∗ (t)

tf = 230

A

Itp + Is

Q(t)

R(t)

Imax

230
Time t

290

0
170

230
Time t

290

170

Figure S16: (A-E) Optimal control strategies for LA for different final times tf . (F-J) Evolutions of the states
subject to the optimal control inputs. Imax are chosen as the maximum of the range in Table 3 of the main
manuscript (ρ = 1) and  = 10−5 .

17

230
290
Time t

230
290
Time t

G

F
0.4

Itp + Is

Q(t)

R(t)

Imax

0.4

Itp + Is

Q(t)

R(t)

Imax

170

230
290
Time t

230
Time t

290

230
290
Time t

1
0.8
0.6
0.4
0.2
0
170

I
0.4

Itp + Is

Q(t)

R(t)

Imax

0.4

Itp + Is

Q(t)

R(t)

Imax

230
Time t

290

230
290
Time t

0.4
0.2

0
170

tf = 290

J

0.2

0
170

E

tf = 275

P ∗ (t)

1
0.8
0.6
0.4
0.2
0
170

0.2

0

0

230
290
Time t

H

0.2

0.2

1
0.8
0.6
0.4
0.2
0
170

D

tf = 260

P ∗ (t)

1
0.8
0.6
0.4
0.2
0
170

C

tf = 245

P ∗ (t)

1
0.8
0.6
0.4
0.2
0
170

B

tf = 230

P ∗ (t)

P ∗ (t)

A

Itp + Is

Q(t)

R(t)

Imax

230
Time t

290

0
170

230
Time t

290

170

Figure S17: (A-E) Optimal control strategies for Houston for different final times tf . (F-J) Evolutions of the
states subject to the optimal control inputs. Imax are chosen from the maximum range of Table 3 of the main
manuscript (ρ = 1) and  = 10−5 .

18

P ∗ (t)

0.2
170

0.2

230
290
Time t

F

0.6

0.4

170

G
0.4

Itp + Is

Q(t)

R(t)

Imax

0.2

230
290
Time t

230
290
Time t

0.4

Itp + Is

Q(t)

R(t)

Imax

0.2

0.4

Itp + Is

Q(t)

R(t)

Imax

0.2
170

230
290
Time t

J
0.4

Itp + Is

Q(t)

R(t)

Imax

0.4
0.2

0
230
290
Time t

0.4

230
290
Time t

0.2

170

tf = 290

0.6

I

0
230
290
Time t

0.4

170

0.2

170

E

tf = 275

0.6

H

0
170

0.2
170

0.2

0

0.4

230
290
Time t

D

tf = 260

P ∗ (t)

0.6

0.4

C

tf = 245

P ∗ (t)

0.6
P ∗ (t)

B

tf = 230

P ∗ (t)

A

Itp + Is

Q(t)

R(t)

Imax

0
170

230
290
Time t

170

230
290
Time t

Figure S18: (A-E) Optimal control strategies for Seattle for different final times tf . (F-J) Evolutions of the
states subject to the optimal control inputs. Imax are chosen as the maximum of the range in Table 3 of the main
manuscript (ρ = 1) and  = 10−5 .

19

Supplementary Note 5: Detailed comparison of different cities
B
1

J ∗ = 515.58

0.8
0.6

120

0.4

J∗

0.2
500

+

0

0.00
170

130

200
Time t

230

J ∗ = 190.53

0.6

300

0.4
0.2
0

200

10−5

+

0

+

10−4



200
Time t

230

0.02
Imax
Q(t)
Itp + Is

0.00
170 200 230 260 290
Time t

170 200 230 260 290
Time t

D

100

1

10−3

J ∗ = 86.47

0.8
0.6
0.4
0.2
0

0.02
Imax
Q(t)

0.01

P∗

35

60

170

0.01

P∗

(tf − ti )

1
0.8

80

Itp + Is

C

400

100

Imax
Q(t)

0.01

P∗
A

0.02

Itp + Is

0.00
170

200
Time t

230

170

200
Time t

230

Figure S19: (A) The optimal cost J ∗ in the (tf − ti ),  plane. The parameters correspond to the Los Angeles
Metropolitan Statistical Area. Imax is chosen as the maximum of the range in Table 3 of the main manuscript
. Type 1 solutions (in green) are more expensive than type 2 solutions (in blue.) The regions in yellow/red
correspond to the transition between the two types of solutions. (B-D) Time evolutions of the optimal control
inputs and states for three different points of the (tf −ti )- plane, points shown as plus signs in (A). The parameter
cq and cp are both set to 1.

20

B
1

J ∗ = 252.98

0.8
0.6
0.4
0.2

250

0

0
21

(tf − ti )

+

10−5



J ∗ = 149.06

0.8
0.6

170

P∗

0.2
0

0.02

200
Time t

230

Imax
Q(t)

0.01

0.4

150

+
10−4

230

Itp + Is

0.00
170 200 230 260
Time t

170 200 230 260
Time t

D

100

1

10−3

J ∗ = 89.26

0.8
0.6
0.4
0.2
0

0.02

Imax
Q(t)

0.01

P∗

60

1

+
210

80

200
Time t

C

200

0
12

Itp + Is

0.00
170

120

100

Imax
Q(t)

0.01

P∗

A

J∗

0.02

Itp + Is

0.00
170

200
Time t

230

170

200
Time t

230

Figure S20: (A) The optimal cost J ∗ in the (tf − ti ),  plane. The parameters correspond to the Seattle
Metropolitan Statistical Area. Imax is chosen as the maximum of the range in Table 3 of the main manuscript
. Type 1 solutions (in red) are more expensive than type 2 solutions (in blue.) The regions in yellow and red
correspond to the transition between the two types of solutions. (B-D) Time evolutions of the optimal control
inputs and states for three different points of the (tf −ti )- plane, points shown as plus signs in (A). The parameter
cq and cp are both set to 1.

21

B
1

J ∗ = 199.22

0.8
0.6

120

0.4

J∗

0.2
0

+

200

195

170 200 230 260 290
Time t

170 200 230 260 290
Time t

C

(tf − ti )

J ∗ = 161.54

0.8

100

0.6
0.4
0.2
0

80

10−4



+

Imax
Q(t)
Itp + Is

0.00
170

100

200
Time t

170

230

200
Time t

230

D
1

10−3

J ∗ = 73.25

0.8
0.6
0.4
0.2
0

0.02

Imax
Q(t)

0.01

P∗

5
10

+

0.02
0.01

P∗

150

10−5

Itp + Is

0.00

1

60

Imax
Q(t)

0.01

P∗
A

0.02

Itp + Is

0.00
170

200
Time t

230

170

200
Time t

230

Figure S21: (A) The optimal cost J ∗ in the (tf − t1 ),  plane. The parameters correspond to the MSA of NYC.
Imax is chosen as the maximum of the range in Table 3 of the main manuscript . Type 1 solutions (in red)
are more expensive than type 2 solutions (in blue.) The regions in yellow and red correspond to the transition
between the two types of solutions. (B-D) Time evolutions of the optimal control inputs and states for three
different points of the (tf − ti )- plane, points shown as plus signs in (A). The parameters cp and cq are both set
to 1.

22

Supplementary Note 6: Herd Immunity Solutions
As stated in the main manuscript, herd immunity solutions arise when the control horizon is very large. Figure
S22 shows an example of such solution for the case of NYC, when the final time was set equal to tf = 440.
˙
˙
These solutions are characterized by three phases: (I) I(t)
> 0 and I(t) < Imax , t ∈ [ti , τ1 ), (II) I(t)
= 0 and
˙
I(t) = Imax , t ∈ [τ1 , τ2 ] and (III) I(t) < 0 and I(t) < Imax , t ∈ (τ2 , tf ], ti ≤ τ1 ≤ τ2 ≤ tf . The second phase has a
natural interpretation: one of the objectives is to minimize the usage of social distancing while in the presence
of the path constraint I(t) ≤ Imax , which results in setting I = Imax any time that the number of infected in the
absence of controls would exceed Imax . From simulations we see that this constant infection state corresponds to
approximately setting Ė = Ȧ = Q̇ = 0, t ∈ [τ1 , τ2 ]. Then, the optimal P ∗ (t) typically has a V-shape (see panel
A of Fig. S22), with stricter measures of social distancing only in the central phase.
C

B

A

0.015

1
1

P ∗ (t)

0.010
S(t)
0.5

0.5

Imax

R(t)

Q(t)

0.005

Itp + Is
0.000
0

0
170

230

290

350

Time t

410

170 230 290 350 410
Time t

170 230 290 350 410 470
Time t

Figure S22: (A) Optimal control strategy for NYC for tf = 440. (B-C) Evaluations of the states to the optimal
control input. Imax is chosen as the minimum value in Table 3 of the main manuscript (ρ = 2/3) and  = 10−3 .
The parameters cp and cq are both set to 1.

Supplementary Note 7: Implementation of non-optimal control solutions
We have provided an approach to robustly minimize the effects on the economy of social distancing measures
in the presence of relevant constraints. However, it is possible that a number of considerations may limit the
implementation of such optimized interventions. We are interested in the effects of implementation of non-optimal
controls solutions. We thus consider application of a variation of the optimal solution
P̃ (t) = min{1, (1 + α)P ∗ (t)},
23

(S1)

Table 1: Violation in the constraints Imax and  for the non-optimal solutions.
NYC: Imax = 0.0088, cq = 1, 3, 6

LA: Imax = 0.0066, cq = 1, 3, 6

α

Imax



J

α

Imax



J

0
0.1
0.2
0.3
0.4
0.5

S
S
S
S
S
S

S
272.4%
1.37E+03%
5.90E+03%
2.39E+04%
8.56E+04%

172.7213
148.8441
128.9513
112.1306
97.7420
85.3439

0
0.1
0.2
0.3
0.4
0.5

S
S
S
S
S
S

S
13.6355%
192.90%
652.79%
1.82E+03%
4.54E+03%

196.7950
170.7582
149.0710
130.7347
115.0389
101.4680

Houston: Imax = 0.0086, cq = 1, 3, 6

Seattle: Imax = 0.0046, cq = 1, 3, 6

α

Imax



J

α

Imax



J

0
0.1
0.2
0.3
0.4
0.5

S
S
S
S
S
S

S
9.17%
177.67%
602.96%
1.67E+03%
4.11E+03%

198.7045
172.4965
150.6672
132.2108
116.4129
102.7529

0
0.1
0.2
0.3
0.4
0.5

S
S
S
S
S
S

S
65.96%
432.45%
1.65E+03%
5.57E+03%
1.73E+04%

206.7624
179.8001
157.3389
138.3460
122.0895
108.0463

α > 0, and analyze violations of the constraints Imax and  as α is varied. Increasing values of α indicate
stronger deviations of the control action from the optimal one. Table 1 summarizes application of such nonoptimal interventions in all four cities, with α varying from 0.1 to 0.5. The letter ‘S’ stands for constraint
satisfied, otherwise we report the percentage by which the constraint is violated. We see that the constraint on
Imax remains always satisfied (this is expected as this constraint is not dominant) but strong violations of the
suppression constraint  are otherwise recorded. From Table 1 we see that for α = 0.5 the constraint on  in
the four areas of interest is violated by an amount that varies from roughly 4000% for Houston to 80000% for
NYC (which corresponds to a fraction of infected people at the final time in the order of 10−2 .) These results
are opposite to those observed previously. The city that is less resilient to variation in the control input is NYC,
which was previously reported to have received closer to optimal control interventions. This is due to the higher
β for NYC (see Table 1) and to the fact that the optimal P ∗ (t) for NYC is higher than for the other cities
(corresponding to less strict social distancing required); as a result, increasing P (t) further leads to the poorest
outcome. This also highlights the risk for resurgences of the epidemics after partial suppression has been achieved
[8], which is currently seen in different parts of the world.

24

Supplementary Note 8: Pseudo-spectral Optimal Control
Pseudo-Spectral Optimal Control (PSOC) is a computational method for solving optimal control problems.
PSOC [5, 7] has provided a numerical tool to let scientists and engineers solve optimal control problems
Z tf
F (x(t), u(t), t) dt
min J(x(t), u(t), t) = E (x(ti ), x(tf ), ti , tf ) +
u(t)

ti

s.t. ẋ(t) = f(x(t), u(t), t)
eL ≤ e(x(ti ), x(tf ), ti , tf ) ≤ eU

(S2)

hL ≤ h(x(t), u(t), t) ≤ hU
t ∈ [ti , tf ]

reliably and efficiently in applications such as guiding autonomous vehicles and maneuvering the international
space station [7]. PSOC is an approach by which an OCP can be discretized by approximating the integrals by
quadratures and the time-varying states and control inputs with interpolating polynomials. Here we summarize
the main concepts behind the PSOC. We choose a set of N + 1 discrete times {τi } i = 0, 1, . . . , N where τ0 = −1
and τN = 1 with a mapping between t ∈ [ti , tf ] and τ ∈ [−1, 1]. The discretization scheme includes the endpoints
and is normalized by the mapping,
tf − ti
tf + ti
t=
τ+
(S3)
2
2
The times {τi } are chosen as the roots of an (N + 1)th order orthogonal polynomial such as Legendre polynomials
or Chebyshev polynomials. The choice of dicretization scheme is important to the convergence of the full
discretized problem. For instance, if we choose the roots of a Legendre polynomial as the discretization scheme,
the associated quadrature weights can be found in the typical way for Gauss quadrature. The time-varying states
and control inputs are found by approximating them with Lagrange interpolating polynomials,
x̂(τ ) =

N
X

x̂i Li (τ )

(S4a)

ûi Li (τ ),

(S4b)

i=0

û(τ ) =

N
X
i=0

where x̂(τ ) and û(τ ) are the approximations of x(τ ) and u(τ ), respectively, and Li (τ ) is the ith Lagrange
interpolating polynomial. The Lagrange interpolating polynomials are defined as,
Li τ =

N
Y
τ − τj
τi − τj
j=0,j6=i

25

(S5)

The dynamical system is approximated by differentiating the approximation x̂(τ ) =
to time.
N
dx̂ X dLi
=
x̂i
dτ
dτ
i=0

PN

i=0

x̂i Li (τ ) with respect
(S6)

Let Dk,i = dτd Li (τk ) which allows one to rewrite the original dynamical system constraints in (S2) as the following
set of algebraic constraints.
N
X
i=0

Dk,i x̂i −

tf − ti
f(x̂k , ûk , τk ) = 0n , k = 1, . . . , N
2

x̂N − x̂0 −

N X
N
X

wk Dk,i x̂i = 0n

k=1 i=0

The last set of algebraic constraints arise from the consistency condition
the consistency condition, the integral in the cost function is,
Z

tf

J=
ti

(S7)

R tf
ti

ẋ(t)dt = x(tf ) − x0 . Similarly to

N
tf − ti X
ˆ
F (x, u, t) ≈ J =
F (x̂k , ûk , τk )
2 k=1

(S8)

The original time-varying states, control inputs, the dynamical equations constrained and the cost function
are now discretized approximation of the continuous NLP problem. Thus the discretized approximation of the
original OCP is compiled into the following nonlinear programming (NLP) problem.
min

ui
i=0,...,N

s.t.

N
tf − ti X
ˆ
J=
wi f (x̂i , ûi , τi )
2
i=0
N
X
i=0

Dk,i x̂i −

x̂N − x̂0 −

tf − ti
f(x̂k , ûk , τk ) = 0, k = 0, . . . , N
2

N X
N
X

wk Dk,i x̂i = 0n

(S9)

k=1 i=0

L

e ≤ e(x̂0 , x̂N , τ0 , τN ) ≤ eU

hL ≤ h(x̂k , ûk , τk ) ≤ hU , k = 0, . . . , N
tf − ti
tf + ti
ti =
τi +
2
2
With the above results, we now present the application to the full multi-phase optimal control problem. In
general, let us assume there are p > 1 phases where we set p = 2 for simplicity. Each phase is active within
26

(p)

(p)

the interval t ∈ [ti , tf ]. In each phase there is a cost function J (p) , a dynamical system f(p) , a set of endpoint
constraints e(p) , and a set of path constraints h(p) . If two phases, p and q, are linked, then there also exists a set
of linkage constraints Φ(p,q) .
min
u(p)

P
X

J

(p)

=

p=1

P Z
X
p=1

(p)

tf

F (p) (x(p) , u(p) , t)dt

(p)
ti

(p)

(p)

s.t. ẋ (t) = f (x(p) , u(p) , t)

(S10)

hL,(p) ≤ h(p) (x(p) , u(p) , t) ≤ hU,(p)
(p)

(p)

(p)

(p)

eL,(p) ≤ e(p) (x(p) (ti ), x(p) (tf ), ti , tf ) ≤ eU,(p)

ΦL,(p,q) ≤ Φ(p,q) (x(p) , x(q) , u(p) , u(q) ) ≤ ΦU,(p,q)
(p)

Each phase is discretized with its own set of points, {τi } so that,
(p)

(p)

x (τ ) ≈ x̂ (τ ) =

N
X

(p)

x̂i Li (τ )

(S11)

i=1

so that the full multi-phase NLP is,
min
(p)
ui

s.t.

(p)
(p) N
P
X
tf − ti X

2

p=1
N
X

(p)

−

(p)
x̂0

(p)

k=1

(p)
Dk,i x̂i

i=0
(p)
x̂N

(p)

F (p) (x̂k , ûk , τk )
(p)

tf − ti (p) (p) (p)
−
f (x̂k , ûk , τk ) = 0n ,
2

(p)
(p) N
N
X
tf − ti X
−
wk Dk,i x̂i = 0n ,
2
k=1 i=0
(p)

(p)

(p)

(p)

eL,(p) ≤ e(p) (x̂0 , x̂N , ti , tf ) ≤ eU,(p) ,
(p)

(p)

hL,(p) ≤ h(p) (x̂k , ûk , τk ) ≤ hU,(p) ,
(p)

(p)

(q)

p = 1, . . . , P,
p = 1, . . . , P

(S12)

p = 1, . . . , P

k = 1, . . . , N,

(q)

k = 1, . . . , N

ΦL,(p,q) ≤ Φ(p,q) (x̂0 , û0 , x̂N , ûN ) ≤ ΦU,(p,q) ,

p = 1, . . . P

p, q = 1, . . . , P

To perform the discretization described in this subsection, we use the open-source C++ PSOC package PSOPT
[2].
Next we show that Eq. (S12) can be expressed in the typical NLP form [4]. Let z(p) contain all of the variables

27

for phase p.


z(p)

(p)

x̂0
 ..
 .
 (p)
 x̂
N
=
 û(p)
 0
 .
 ..
(p)
ûN






 ∈ R(n+m)





(S13)

Next, let z contain the variables for every phase,



z(1)


z =  ...  ∈ R(N +1)(n+m)
z(P )

(S14)

With some algebraic manipulation, the entire discretized multi-phase OCP can be rewritten as an NLP in the
typical form.
min c(z)
z

s.t. g(z) = 0
d(z) ≤ 0

(S15)

To solve the large-scale NLP in Eq. (S15) we employ an interior-point algorithm [4]. Specific details of the
algorithm are outside the scope of this paper. We used the open-source C++ package IPOPT [9] to solve each
instance of Eq. (S15). We direct interested readers who would like to learn more about the technical detailed
involved when solving Eq. (S15) to the documentation provided with IPOPT.
The optimal solution returned, z∗ , is separated into its component parts; first by splitting it into the phases
(p)∗
z , and second by reconstructing the discrete states and control inputs, x̂∗i and û∗i . The continuous time control
inputs and states are then reconstructed using the Lagrange interpolating polynomials in Eq. (S4). With the
continuous time states and control inputs, x∗ (t) and u∗ (t), we then verify that the necessary conditions are met
to within an acceptable tolerance.

Supplementary Note 9: Necessary Conditions for PSOC Solutions
A closed form solution of Eq. (S2) may not exist. Instead one must typically turn to numerical methods, such as
PSOC. Nonetheless, it is possible to derive a set of necessary conditions that any solution to Eq. (S2) must satisfy
based on Pontryagin’s minimum principle [3]. Developing these necessary conditions allows one to construct a set
of validation criteria with which we may test the quality of any solution returned by the numerical methods. In
Ref. [6], the so-called HAMVET procedure has been proposed based on a slightly modified version of Pontryagin’s
principle to provide the necessary conditions for the general OCP in (S2).
28

The HAMVET procedure is based on the following steps:
• Construction of the Hamiltonian : (H)
• Adjoint equations : (A)
• Minimization of the Hamiltonian : (M)
• Evaluation of the Hamiltonian Value condition : (V)
• Evolution of the Hamiltonian : (E)
• Transversality conditions : (T)
In what follows, we individually describe each one of the steps of the HAMVET procedure. A detailed analysis
can be found in Ref. [6].

Construction of the Hamiltonian
The Hamiltonian H corresponding to the general OPC problem is
H(λ, x, u, t) = F (x, u, t) + λT f(x, u, t)

(S16)

where λ(t) ∈ Rn is the adjoint covector which is a function of time t. The control input that minimizes the
OCP satisfies the Hamiltonian Minimization Condition (HMC), that is,
(
min H(λ, x, u, t)
(HM C)

u(t)

s.t. hL ≤ h(x, u, t) ≤ hU

(S17)

Adjoint equations
The Karush-Kuhn-Tucker (KKT) conditions can be used to solve the HMC. We define the Lagrangian of the
Hamiltonian H̄ as
H̄(µ, λ, x, u, t) = H(λ, x, u, t) + µT h(x, u, t)

(S18)

where µ(t) ∈ Rh is the path covector which is a function of time t. Then the evolution of the adjoint covector
λ(t) is given by,
− λ̇ =
29

∂ H̄
∂x

(S19)

Note that condition in (S19) enforces the continuity but not differentiability of λ(t). So, the piecewise continuity
of λ(t) is a necessary condition for an optimal control solution.

Minimization of the Hamiltonian
By the KKT condition, the minimization condition for the Hamiltonian yields
∂ H̄
=0
∂u
with the complementary conditions for path constraints,


µi ≤ 0
if
hi (x, u, t) = hLi





µi = 0
if hLi < hi (x, u, t) < hUi

µi ≥ 0





µi unrestricted

if

hi (x, u, t) = hUi

if

hLi = hUi

(S20)

(S21)

If there are path constraints, then one of the necessary conditions is
µi (t)(hi − hLi )(hi − hUi ) = 0

(S22)

Along with the minimization of the Hamiltonian, there is an endpoint minimization condition (EMC) as well.
The endpoint minimization problem is defined as
(
min E(x(ti ), x(tf ), ti , tf )
(EM C)
(S23)
s.t. eL ≤ e(x(ti ), x(tf ), ti , tf ) ≤ eU
To solve the EMC by KKT, we define the endpoint Lagrangian Ē as
Ē(ν, x(ti ), x(tf ), ti , tf ) =E(x(ti ), x(tf ), ti , tf )
+ ν T e(x(ti ), x(tf ), ti , tf )

(S24)

where ν ∈ Re is the endpoint covector. Note that, ν is a constant vector. The complementary conditions for
event constraints are given by

30



νi ≤ 0





ν i = 0

ei (x(ti ), x(tf ), ti , tf ) = eLi

if

if eLi < ei (x(ti ), x(tf ), ti , tf ) < eUi


νi ≥ 0





νi unrestricted

if

ei (x(ti ), x(tf ), ti , tf ) = eUi

if

eLi = eUi

(S25)

Hamiltonian Value condition
The lower Hamiltonian H is defined as the Hamiltonian evaluated at u(t) = u∗ (t), the solution to the HMC
problem, i.e.,
H = min H(λ, x, u, t)
u∈U

(S26)

where U is the set of feasible control inputs, i.e., they satisfy all of the constraints imposed by Eq. (S2). The
lower Hamiltonian must satisfy the endpoint value conditions as a regular Hamiltonian
∂ Ē
∂ti
∂ Ē
H(λ(tf ), x(tf ), tf ) = −
∂tf
H(λ(ti ), x(ti ), ti ) =

(S27)

which provides another necessary conditions to check for the optimal control solution.

Time Evolution of the Hamiltonian
As the lower Hamiltonian H is obtained from the evaluation of the Hamiltonian at the u∗ (t), x∗ (t) and λ∗ (t),
where x∗ (t) and λ∗ (t) are the states and costates associated with the optimal control solution u∗ (t), H is a
function of time t only. Thus the evolution of the lower Hamiltonian H can be defined as
∂H
dH
=
dt
∂t
If H in (S16) does not depend explicitly on time, then another necessary condition is
Ḣ =

Ḣ = 0

or H = constant

31

(S28)

(S29)

Transversality conditions
The endpoints of the adjoint covector λ(t) are related to the partial derivatives of the endpoint Lagrangian Ē.
The transversality conditions for the adjoint covector λ(t) are
λ(t0 ) = −

∂ Ē
∂x(t0 )

and λ(tf ) =

∂ Ē
∂xf

(S30)

Verification of the Necessary Conditions
We have presented the necessary conditions for the general OCP. Next we develop a set of necessary conditions
for the solution of the OCP described in the main section. The OCP presented in the main text can be mapped
to the general formulation presented in Eq. (S2) with the following definitions.

T
• The state variables x(t) = S(t) E(t) A(t) Itp (t) Is (t) Q(t) R(t)
∈ R7 and the control input
u(t) ≡ P (t) ∈ R.
Rt
Rt
• The cost function J = tif (1 − P (t))dt + tif Q(t)dt (see Eq. (7) with cp = cq = 1 in the main text) so that,
from Eq. (S2), E ≡ 0 and F = 1 − P (t) + Q(t).
• The system dynamics, as presented in Eq. (1), are rewritten here,


Ṡ(t)
 Ė(t) 


 Ȧ(t) 




ẋ(t) =  I˙tp (t)  = f(x(t), u(t), t)

 ˙
 Is (t) 


 Q̇(t) 
Ṙ(t)

(S31)

• The only endpoint constraints are set at the initial time (ti ) and the terminal constraints in Eq. (4) in main
text,


S(ti )


E(ti )




A(t
)
i








Itp (ti )
x(ti )
x(ti )


 , eL =  P2  , eU =  P2  (S32)
Is (ti )
e(x(ti ), x(tf ), ti , tf ) = 




Q(ti )
0





R(ti )




P (ti )
E(tf ) + Is (tf ) + Itp (tf ) + A(tf )
32

where x(ti ) =



Sti Eti Ati Itpti Isti Qti Rti

T

are set to the values of the states at ti .

• Finally, the path constraints consist of the bounds on Itp (t) + Is (t) and possibly on P (t)


 


Itp (t) + Is (t)
0
Imax
L
U
h(x(t), u(t), t) =
, h =
, h =
P (t)
0
1

(S33)

Developing the necessary conditions allows us to construct a set of validation criteria with which we may test
the quality of any solution returned by our numerical methods. For this analysis, we consider the metropolitan
city of LA. Imax and  are set to 0.0066 and 10−5 , respectively.
Define a vector of time-varying costates (or adjoint variables) as λ(t), the Hamiltonian of the OCP in Eq. (S2)
is defined as,
H(λ, x, u, t) = F (x, u, t) + λT f(x, u, t)
(S34)
= 1 − P (t) + Q(t) + λT f(x, u, t)
where λ(t) ∈ R7 are the costates (or adjoint variables). A solution to Eq. (S2) must also be a solution of the
following minimization problem.
min H(λ, x, u, t)
u(t)
(S35)
L
U
s.t. h ≤ h(x, u, t) ≤ h

To solve Eq. (S35), we define the associated Lagrangian,
H̄(µ, λ, x, u, t) = H(λ, x, u, t) + µT h(x, u, t)
= 1 − P (t) + Q(t) + λT f(x, u, t) + µItp +Is (Itp + Is ) + µP P (t)

(S36)


T
where µ = µItp +Is µP
∈ Rh is the copath vector of the path constraints in Eq. (S33). A solution to Eq.
(S35), and thus to our original OCP, must satisfy,
∂ H̄
= µP − 1 +
∂P



∂f
∂P

T

(S37)

λ=0

where the costates evolve according to the dynamical equation,

∂ H̄
=−
λ̇ = −
∂x



∂ f̄
∂x

T

33

03

 µItp +Is

λ−
 µItp +Is

1
0








(S38)

The optimal control input P ∗ (t), must satisfy the complementarity condition

P ∗ (t) = 0

µP (t) < 0 if
µP (t) = 0 if 0 < P ∗ (t) < 1

µ (t) > 0 if
P ∗ (t) = 1
P
The path constraint Itp (t) + Is (t) must satisfy the another complementary condition

Itp (t) + Is (t) = 0

µItp +Is < 0 if
µItp +Is = 0 if 0 < Itp (t) + Is (t) < Imax


µItp +Is > 0 if
Itp (t) + Is (t) = Imax

(S39)

(S40)

In Fig. S23(A) and (B), we plot P ∗ (t) and µP (t), respectively. We note that 0 < P ∗ (t) < 1 and µP (t) remains at
zero over the the control time interval. In Fig. S23(C) and (D), we plot Itp (t) + Is (t) and µItp +Is (t), respectively.
Note that µItp +Is (t) > 0 when Itp (t) + Is (t) = Imax , µItp +Is (t) = 0 when 0 < Itp (t) + Is (t) < Imax , and when
µItp +Is (t) < 0 when Itp (t)+Is (t) ≈ 0. These necessary conditions are obtained from the complementary conditions
while minimizing the Hamiltonian.
Similarly, in order to minimize the endpoints constraints, the endpoint Lagrangian Ē in Eq. (S24) becomes,
Ē = ν T e(x(t0 ), x(tf ), t0 , tf )

(S41)

The endpoint covector must satisfy the conditions in Eq. (S25), but it is reasonable to verify at least ν9 associated
with the terminal constraint Etf + Is (tf ) + Itp (tf ) + A(tf ). We obtained ν9 < 0 suggesting that Etf + Is (tf ) +
Itp (tf ) + A(tf ) ≈ 0.
Let us now assume that we have solved Eq. (S35), that is,
H(t) = min H(λ, x, P ∗ , t)
P (t)

(S42)

The evolution of the Hamiltonian at the optimal solution can be written,
dH
∂H
=
dt
∂t

(S43)

where, since in our OCP, H does not explicitly depend on time, we expect that dH/dt = 0 and so H should be
constant. This is the next validation condition. In Fig. S23(E), we plot H(t) and it is clear that H(t) is constant
over ti < t < tf . The transversality conditions in Eq. (S30) are also verified from the numerical solution of λ(t).
In Fig. S23(F), we plot the relative discretization error at each time t. From Fig. S23, we conclude that the
necessary condition derived for the optimal control input are satisfied.
34

B

A

·10−3

P ∗ (t)

0.7

µP

0.5

0.3

0

D

C

1 · 10−2

Imax = 0.0066

0.008

µItp +Is

Itp + Is

0.016

0

0.000

F

E

1 · 10−3

local error

0.000

H

−0.400

0

10-08-20

09-08-20

08-08-20

07-08-20

−1 · 10−3

10-08-20

09-08-20

08-08-20

07-08-20

−0.800

Figure S23: HAMVET procedure applied to our solution of the optimal control problem for the metropolitan
city of LA. Imax and  are set to 0.0066 and 10−5 , respectively. A) The optimal time evolution of the control
input P ∗ (t). B) The time evolution of the path covector µP . C) The time evolution of Itp (t) + Is (t). D) The time
evolution of the path covector µItp +Is (t). E) The time evolution of the lower Hamiltonian H. F) The relative
local discretization error at each time t.
35

Supplementary Note 10: Sensitivity Analysis
It is important to check the sensitivity of the optimal control solution to small perturbations of the system
parameters. To this aim, we perturb the parameter β, i.e., the most important parameter of the model, and
compute how much the optimal control input changes. The other parameters remain unchanged. We define ξ as
the average normalized variation in the optimal control input when β is varied by a quantity equal to δ%,

 ∗
P (t) − Pδ∗ (t)
(S44)
ξ=
P ∗ (t)
where h.i indicates a time average over the control time, P ∗ (t) is the optimal input for the original value of β and
Pδ∗ (t) is the optimal control input for (1 + δ%)β. For this analysis, we consider the metropolitan city of Seattle.
Imax and  are set to 0.0046 and 10−5 , respectively. In Fig. S24, we plot ξ vs. δ%.

36

0.15

ξ

0.10

0.05

0.00

−5

0

5

10

δ%

Figure S24: Sensitivity analysis of the optimal control input to a perturbation in the parameter β for the
metropolitan city of Seattle. The average variation ξ in the optimal control input vs. the change δ in the
parameter β. Imax and  are set to 0.0046 and 10−5 , respectively.

37

Supplementary Note 11: Incorporation of Vaccinations in the Model
and Effects on the Optimal Control Solutions
Figure 25 shows very good agreement between the daily new case counts reported by local health administrations
for the city of Seattle over the extended period from January 21, 2020 to December 14, 2020 (blue symbols) and
the daily new cases obtained by integrating Eq. (2) of the main text after parametrization of a 4-phase model
(four social-distancing episodes with piece wise-linear transition of P (t); red solid line).
According to [1] a total of 1.36 million doses have been administered in the US as of February 1 2021, with the
number of doses per day increasing roughly linearly with time. Thus we model the number of doses administered
per day as κ × (t − tv ), where we set the time tv to be Dec-14-2020, the date in which vaccinations began in the
US. It becomes important to estimate the linear rate of increase κ. There is a total of 49 days from Dec-14-2020
to Feb-1-2021. Assuming each person gets 2 vaccine doses, we have κ × 49 = 1.36M/2 leading to κ = 13878
people/day nationally. The MSA of Seattle has population of roughly 4M , which is about 1.29% of the total US
population. This means the κ for Seattle should be equal to roughly 13878 × 0.0129 = 180 (person/day.) In the
non-dimensional case, this corresponds to κ = 0.000045 (1/day.)
Figure 26 shows the state time evolutions corresponding to the optimal control inputs shown in Figure 7 of
the main text. The left plots are for a shorter control horizon, Tcont = (tf − ti ) = 130 days, while the right
plots are for a longer control horizon, Tcont = (tf − ti ) = 150 days. We compare the two cases that κ = 0, i.e.,
we do not model the effects of vaccinations (in A and B), and that κ = 0.000045, i.e., we model the effects of
vaccinations (in C and D.)

38

3,500

Seattle
Data
Parametrized model

3,000

New case counts

2,500

2,000

1,500

1,000

500

01-21-2020
01-31-2020
02-10-2020
02-20-2020
03-01-2020
03-11-2020
03-21-2020
03-31-2020
04-10-2020
04-20-2020
04-30-2020
05-10-2020
05-20-2020
05-30-2020
06-09-2020
06-19-2020
06-29-2020
07-09-2020
07-19-2020
07-29-2020
08-08-2020
08-18-2020
08-28-2020
09-07-2020
09-17-2020
09-27-2020
10-07-2020
10-17-2020
10-27-2020
11-06-2020
11-16-2020
11-26-2020
12-06-2020
12-16-2020

0

Figure S25: New case counts from January 21, 2020 to December 14, 2020 for the Metropolitan Statistical Areas
of Seattle. Blue symbols are daily new case counts reported by the local health administration. The solid line is
the daily new cases obtained by integrating Eq. (2) after parametrization of the model.

39

A

B

tf − ti = 130

1

tf − ti = 150

1

Non-vaccine

Non-vaccine

S(t)

0.8

S(t)

0.8

R(t)

R(t)

0.6

0.6

0.4

0.4

0.2
0.012

0.2
0.012

0.008

0.008
Itp + Is

Itp + Is
0.004

0.004

Q(t)

Q(t)
Imax

Imax
0.000

0.000
335

360

385

410

435

460

C

335

360

385

410

435

460

485

D
1

1

Vaccine

S(t)

0.8

0.8

R(t)

0.6

Vaccine

0.6

S(t)

0.4

R(t)

0.4

0.2

0.2
0.012

0
0.012

0.008

0.008
Itp + Is

Itp + Is
0.004

0.004

Q(t)

Q(t)
Imax

Imax
0.000

0.000
335

360

385
410
Time t

435

460

335

360

385

410
435
Time t

460

485

Figure S26: Time evolution of the states subject to the optimal control inputs shown in Fig. 7 of the main text
for the city of Seattle. A and B are for the case that vaccinations are not modeled (κ = 0), while C and D are
for the case that vaccinations are modeled (κ = 0.000045). Plots on the left are for a shorter control horizon
(tf − ti ) = 130 days while the plots on the right are for a longer control horizon (tf − ti ) = 150 days. Imax are
chosen as the maximum of the range in Table 3 (ρ = 1) and cp = cq = 1.

40

Supplementary Note 12: Non-Normalized Equations
ˆ =
Consider the non-normalized quantities in the variables Ŝ(t) = N S(t), Ê(t) = N E(t), Â(t) = N A(t), I(t)
N I(t), Iˆtp (t) = N Itp (t), Q̂(t) = N Q(t), R̂(t) = N R(t), where N is the total number of individuals in the
ˆ + +Iˆtp (t) + Q̂(t) + R̂(t) = N at any time. The non-normalized
population, such as Ŝ(t) + Ê(t) + Â(t) + I(t)
quantities evolve based to following equations,
h
i
˙
ˆ + Iˆtp (t) + µÂ(t)
Ŝ (t) = − β̂P 2 (t) Ŝ(t) I(t)
h
i
˙
2
ˆ
ˆ
ˆ
Ê (t) =β̂P (t) Ŝ(t) I(t) + Isq (t) + Itp (t) + µÂ(t) − λÊ(t)

˙
Â (t) =λ (1 − σ) Ê(t) − γA Â(t)
˙
Iˆtp (t) =ptest λσ Ê(t) − [γI + γtp ] Iˆtp (t)
˙
ˆ
Iˆ (t) = (1 − psq − ptest ) λσ Ê(t) − γI I(t)
˙
Q̂ (t) =γtp Iˆtp (t) + psq λσ Ê(t) − γI Q̂(t)
h
i
˙
ˆ
ˆ
R̂ (t) =γA Â(t) + γI I(t) + Itp (t) + Q̂(t) .

(S45a)
(S45b)
(S45c)
(S45d)
(S45e)
(S45f)
(S45g)

where β̂ = N −1 β. All other parameters are the same as defined in Eq. 2 of the main manuscript.

Supplementary Note 13: Model incorporating limited testing
An extended version of the model that incorporates limited testing is the following.
Ṡ (t) = − βP 2 (t) S(t) [I(t) + Itp (t) + µA(t)]
2

Ė (t) =βP (t) S(t) [I(t) + Itp (t) + µA(t)] − λE(t)

(S46a)
(S46b)

Ȧ (t) =λ (1 − σ) E(t) − γA A(t)
I˙sq (t) =psq λσE(t) − [γI + γsq ] Isq (t)

(S46d)

I˙tp (t) =T

(S46e)

ptest σλE
∧ ptest σλE − (γI + γtp ) Itp (t)
ptest σλE + D
ptest σλE
I˙ (t) = (1 − psq ) λσE(t) − T
∧ σptest λE − γI I(t)
ptest σλE + D
Q̇ (t) =γtp Itp (t) + psq λσE − γI Q(t)
Ṙ (t) =γA A(t) + γI [I(t) + Itp (t) + Q(t)] .
41

(S46c)

(S46f)
(S46g)
(S46h)

The flux of population that will be tested is ptest σλE, and the positive detection probability is
ptest σλE
.
ptest σλE + D

(S47)

This is to assume that the number of testing kits is less than the total people needed to be tested (scarcity)
which can be described as: number of people which require testing ≈ (ptest σλE + D) ∆t in a small ∆t  1
time. Otherwise, we will assume a probability of 1 of detecting all those with COVID-19 while ignoring the false
negatives. The variable T is the flux of testing kits which are generated (so unit is number per day). We use
the standard notation a ∧ b = min{a, b}. The testing flux T is most-likely lower than ptest λE, but if we take a
temporally averaged value of T , it is likely that we can get everyone a kit at the early stage. The above general
model considers the possibility that testing kits are scarce (i.e., T < (ptest σλE + D)). However, for NY, at this
moment (subdued pandemic), it is likely that the resource is not scarce.

References
[1] ”Daily COVID-19 vaccine doses administered”. Our World in data. https://ourworldindata.org/grapher/
cumulative-covid-vaccinations. February 2020.
[2] Victor M Becerra. Solving complex optimal control problems at no cost with psopt. In 2010 IEEE International Symposium on Computer-Aided Control System Design, pages 1391–1396. IEEE, 2010.
[3] Donald E Kirk. Optimal control theory: an introduction. Courier Corporation, 2004.
[4] Jorge Nocedal and Stephen Wright. Numerical optimization. Springer Science & Business Media, 2006.
[5] Anil V Rao. A survey of numerical methods for optimal control. Advances in the Astronautical Sciences,
135(1):497–528, 2009.
[6] I Michael Ross. A primer on Pontryagin’s principle in optimal control. Collegiate publishers, 2015.
[7] I Michael Ross and Mark Karpenko. A review of pseudospectral optimal control: From theory to flight.
Annual Reviews in Control, 36(2):182–197, 2012.
[8] Nick Warren Ruktanonchai, JR Floyd, Shengjie Lai, Corrine Warren Ruktanonchai, Adam Sadilek, Pedro
Rente-Lourenco, Xue Ben, Alessandra Carioli, Joshua Gwinn, JE Steele, et al. Assessing the impact of
coordinated covid-19 exit strategies across europe. Science, 2020.
[9] Andreas Wächter and Lorenz T Biegler. On the implementation of an interior-point filter line-search algorithm
for large-scale nonlinear programming. Mathematical programming, 106(1):25–57, 2006.

42

