Exact Inference for Disease Prevalence Based on a Test with
Unknown Specificity and Sensitivity

arXiv:2011.14423v1 [stat.ME] 29 Nov 2020

Bryan Caia , John P.A. Ioannidisb , Eran Bendavidc , Lu Tiand
a

Department of Computer Science, Stanford University; b,c Department of Medicine, Stanford
University; d Department of Biomedical Data Science, Stanford University
ARTICLE HISTORY
Compiled December 1, 2020
ABSTRACT
To make informative public policy decisions in battling the ongoing COVID-19 pandemic, it is important to know the disease prevalence in a population. There are two
intertwined difficulties in estimating this prevalence based on testing results from
a group of subjects. First, the test is prone to measurement error with unknown
sensitivity and specificity. Second, the prevalence tends to be low at the initial stage
of the pandemic and we may not be able to determine if a positive test result is a
false positive due to the imperfect specificity of the test. The statistical inference
based on large sample approximation or conventional bootstrap may not be sufficiently reliable and yield confidence intervals that do not cover the true prevalence
at the nominal level. In this paper, we have proposed a set of 95% confidence intervals, whose validity is guaranteed and doesn’t depend on the sample size in the
unweighted setting. For the weighted setting, the proposed inference is equivalent to
a class of hybrid bootstrap methods, whose performance is also more robust to the
sample size than those based on asymptotic approximations. The methods are used
to reanalyze data from a study investigating the antibody prevalence in Santa Clara
county, California, which was the motivating example of this research, in addition
to several other seroprevalence studies where authors had tried to correct their estimates for test performance. Extensive simulation studies have been conducted to
examine the finite-sample performance of the proposed confidence intervals.
KEYWORDS
Exact confidence interval; sensitivity; specificity; prevalence; COVID-19

1. Introduction
Determining the proportion of people who have developed antibodies to SARS-CoV-2
due to prior exposure is an important piece of information for guiding the response
measures to COVID-19 in different populations. This proportion is also key to understanding the severity of the disease in terms of estimating the infection fatality
rate among those infected; for examples see [2, 5, 12, 20], and for an overview of 82
studies see [13]. One effective way of estimating the proportion of people who have
developed antibodies is to conduct a survey in the community of interest: sample a
subgroup of people from the target population and measure their antibody status using a test kit. The prevalence of SARS-CoV-2 antibodies can oftentimes be low, in the
range of 0-2%, especially at the early stage of viral spread in a population. In these
CONTACT Bryan Cai. Email: bxcai@stanford.edu

circumstances the simple proportion of the positive results among all conducted tests
can be a poor estimate of the true prevalence due to the simple fact that all tests
are not perfect [18]. For example, suppose that the test used in the study has a fairly
good operational characteristics: sensitivity= 95% and specificity= 99%. Then, if the
true prevalence rate in the study population is 1%, based on a simple calculation ,
1% × 95% + 99% × (1 − 99%) = 1.9% of the tests would be positive. The proportion
of positive tests in this case is almost double the true prevalence.
Therefore, the proportion of the positive tests may not represent the true prevalence
and should be adjusted for the sensitivity and specificity of the deployed test. If the
sensitivity and specificity of test is unrealistically assumed to be known, an unbiased
estimate of the true prevalence can be obtained easily and its 95% confidence interval
can be constructed [17]. However, this is usually not the case, and in practice the reported sensitivity and specificity of the test are often obtained based on limited number
of experiments and are random estimates subject to errors themselves. In the absence
of a gold reference to estimate sensitivity and specificity against, a Bayesian approach
is suggested in [6]. Therefore, it is important to develop an inference procedure to
account for the randomness from study data as well as from reported sensitivity and
specificity. When the specificity is close to one and the prevalence is low, the statistical inference based on large sample approximation such as delta-method and naive
bootstrap may not be reliable. In this paper, we have proposed an exact inference
method for the disease prevalence without requiring any large sample approximation.
The method can be useful for statistical inference of the prevalence of antibody to
SARS-CoV-2 in a given population.

2. Method
2.1. Exact inference based on random sampling
Our goal is to construct a reliable confidence interval for disease prevalence in scenarios with true specificity close to 1, where the normality assumption for the reported
sensitivity does not necessarily hold. In a typical setting, we observe three separate
estimates for the proportion of positive tests r0 , sensitivity p0 , and specificity q0 , denoted by r̂, p̂ and q̂, respectively. Specifically, we assume to observe three independent
binomials random variables.
d ∼ Bin(D, r0 ),
m ∼ Bin(M, p0 ),
n ∼ Bin(N, q0 ),
r̂ = d/D, p̂ = m/M and q̂ = n/N, where D is the sample size in the current study; M
is the number of positive reference samples used to estimate the sensitivity; and N is
the number of negative reference samples used to estimate the specificity. Normally, D
is big relative to M and N, whose typical values are in the range of tens or hundreds.
Based on the relationship
r0 = π0 p0 + (1 − π0 )(1 − q0 ),

2

the true disease prevalence satisfies
π0 = f (r0 , p0 , q0 ),
where
f (r, p, q) :=

r+q−1
.
p+q−1

A simple point estimator of the prevalence π0 adjusted for sensitivity and specificity
is thus
π̂ = f (r̂, p̂, q̂).
If min(D, M, N ) → ∞ and r0 , p0 , q0 ∈ [0, 1], then the central limit theorem suggests
the normal approximation:

√

  

0
r0 (1 − r0 )
0
0
√ D(r̂ − r0 )
 M (p̂ − p0 ) ∼ N 0 , 

0
p0 (1 − p0 )
0
√
0
0
0
q0 (1 − q0 )
N (q̂ − q0 )
By delta method, π̂ − π0 can be approximated by a mean zero Gaussian distribution
N (0, σ02 ), where
σ02 =

r0 (1 − r0 )
π02 p0 (1 − p0 )
(r0 − p0 )2 q0 (1 − q0 )
+
+
.
D(p0 + q0 − 1)2 M (p0 + q0 − 1)2
N (p0 + q0 − 1)4

The variance σ02 is unknown but can be consistently estimated by
σ̂ 2 =

r̂(1 − r̂)
π̂ 2 p̂(1 − p̂)
(r̂ − p̂)2 q̂(1 − q̂)
+
+
.
D(p̂ + q̂ − 1)2 M (p̂ + q̂ − 1)2
N (p̂ + q̂ − 1)4

Therefore, a simple 95% confidence interval for π0 can be constructed as
[π̂ − 1.96σ̂, π̂ + 1.96σ̂] .

(1)

This confidence interval can be viewed as a product of inverting a Wald test H0 : π0 = π
based on the test statistic
T̂ (π) =

π̂ − π
σ̂

which approximately follows a standard Gaussian distribution with mean zero and
unit variance under the null hypothesis H0 : π0 = π. Specifically, the p-value of the
test can be calculated as
p(π) = P (|Z| > |T̂ (π)|)
and the 95% confidence interval based on (1) can be expressed as
{π | p(π) > 0.05},
3

i.e., all π, at which we can not reject the null hypothesis at the 0.05 significance level.
Here Z ∼ N (0, 1).
Remark 1. In the extreme case, the confidence interval above may include negative
values. To preserve the appropriate range of the prevalence, one may first construct
the 95% confidence interval for logit(π0 ) as



1.96σ̂
1.96σ̂
logit(π̂) −
, logit(π̂) +
π̂(1 − π̂)
π̂(1 − π̂)
and transform it back vai expit(·) to a confidence interval for π0 .
When q0 is close to 1 and/or r0 is close to zero, the null distribution of T̂ may not
be approximated well by the standard normal and the p-value based on asymptotic
approximation, i.e. p(π), becomes unreliable. The bootstrap method has also been used
to construct the confidence interval of π0 . There are different variations of bootstrap
method. The simplest version draws
rb∗ ∼ Bin(D, r̂)/D
p∗b ∼ Bin(M, p̂)/M
qb∗ ∼ Bin(N, q̂)/N,
and calculate πb∗ = f (rb∗ , p∗b , qb∗ ) for b = 1, · · · , B, where B is a large integer specified
by the user. Then two ends of the 95% confidence interval of π0 can be constructed as
2.5 and 97.5 percentile of {πb∗ , b = 1, · · · , B}. However, the validity of the bootstrap
method also rely on large sample approximation, which may be broken in some settings
of interest.
To address this concern, we propose to calculate the exact p-value by inverting an
exact test, while accounting for nuisance parameters as in [3, 8, 9, 14, 19] through the
following steps:
(1) Construct 99.9% confidence intervals for r0 , p0 , and q0 denoted by Ir , Ip and
Iq , respectively. The high coverage level of 99.9% is chosen to ensure that the
probability of (r0 , p0 , q0 ) ∈ Ir × Ip × Iq is much greater than 95%. Other options
such 99.96% are viable as well.
(2) For a given π, define Ωπ = {(r, p, q) | f (r, p, q) = π, (r, p, q) ∈ Ir × Ip × Iq }.
(3) Select a dense net “spanning” Ωπ : {(rk , pk , qk ) ∈ Ωπ , k = 1, · · · , K} such that
for any (r, p, q) ∈ Ωπ , there exists a k ∈ {1, · · · , K} such that |rk − r| + |pk −
p| + |qk − q| ≤  for a small constant  > 0.
(4) For each (rk , pk , qk ) from the net, we simulate
rb∗ ∼ Bin(D, rk )/D
p∗b ∼ Bin(M, pk )/M
qb∗ ∼ Bin(N, qk )/N,

4

and let
πb∗ = f (rb∗ , p∗b , qb∗ )
σb∗ 2 =

rb∗ (1 − rb∗ )
πb∗ 2 p∗b (1 − p∗b )
(rb∗ − p∗b )2 qb∗ (1 − qb∗ )
+
+
∗
∗
∗
∗
D(pb + qb − 1)2 M (pb + qb − 1)2
N (p∗b + qb∗ − 1)4

for b = 1, · · · , B, where B is a large number such as 1, 000. The distribution of
T̂ (rk , pk , qk ) under the simple null hypothesis H0 : (r0 , p0 , q0 ) = (rk , pk , qk ), can
be approximated by the empirical distribution of
{Tb∗ (rk , pk , qk ), b = 1, · · · , B},
where
Tb∗ (rk , pk , qk ) =

πb∗ − π
.
σb∗

Specifically, the exact p-value for testing H0 : (r0 , p0 , q0 ) = (rk , pk , qk ) can be
estimated by
p̂(rk , pk , qk ) = B

−1

B
X

I(|Tb∗ (rk , pk , qk )| ≥ |T̂ (π)|),

b=1

where I(·) is the indicator function.
(5) Since H0 : π0 = π is a composite null hypothesis, the exact p-value for testing
H0 : π0 = π can be approximated by
p̂(π) =

max p̂(rk , pk , qk ).

k=1,··· ,K

Lastly, the 95% confidence interval for π0 can be constructed as
{π | p̂(π) ≥ 0.05 − 0.003},
i.e., all π’s with an exact p-value is greater than 0.05-0.003=0.047. The adjustment
of 0.003 in the significance level is needed to account for joint coverage level of three
confidence intervals Ir , Ip , and Iq at step (1), i.e., P ((r0 , p0 , q0 ) ∈ Ir × Ip × Iq ) ≥
1 − 0.003.
Remark 2. If Ωπ = φ, i.e., there is no (r, p, q) ∈ Ir × Ip × Iq such that f (r, p, q) = π,
then let p̂(π) = 0.
Remark 3. The construction of the grid points in Ωπ can be completed by first
considering all the points {(pi , qj )}, where {pi } is a set of evenly-spaced points over Ip
and {qj } is a set of evenly-spaced points over Iq . Then for each (pi , qj ), we may solve
the equation f (r, pi , qj ) = π in terms of r. If the solution rij ∈ Ir , then the triplet
(pi , qj , rij ) is included in dense net.
The proposed exact confidence intervals always can cover the true prevalence at
the desired level regardless of the sample size, if we ignore the Monte-Carlo error in

5

calculating the p-value p̂(rk , pk , qk ), which can be made arbitrarily small by increasing
B in the simulation and considering more dense net spanning the region Ωπ .
The computation can be slow, since for each hypothesis test, we need to simulate
the null distribution of T̂ (π) for many triplets (rk , pk , qk ) ∈ Ωπ . We can accelerate this
computation using hybrid bootstrap [4], where some nuisance parameters are fixed
to their point estimates when approximating the distribution of test statistic. For
example, we may assume p0 = p̂ and only consider pairs (r, q) such that f (r, p̂, q) = π
to generate the exact p-value of H0 : π0 = π. Specifically, we may let {qj , j = 1, · · · , J}
be evenly spaced points over Iq and let rj = π p̂ − (1 − π)(qj − 1). In the end
p̂(π) =

max

1≤j≤J,rj ∈Ir

p̂(rj , p̂, qj ).

Since p0 is fixed at p̂, the number of pairs (r, q) to be considered for each fixed level
π can be much smaller than the number of triplets (r, p, q). The price for gaining the
computation speed is sacrificing the “exact” coverage level in finite sample due to
the fact that the observed point estimator of the nuisance parameters may be quite
different from the true parameter. Consequently, the coverage level of the confidence
interval based on hybrid bootstrap is not always guaranteed in all settings. However,
we expect that it still performs better than the naive confidence interval (1), where all
unknown parameters were assumed to be their observed estimates. It can be viewed
as a compromise between the computational intensive exact inference and asymptotic
inference based on large sample approximations.
2.2. Hybrid Bootstrap for Weighted Inference
When the survey for studying disease prevalence is not conducted using a representative sample, appropriate weighting of the samples is needed to obtain an unbiased
estimate of the prevalence. There are two typical settings. (1) There are several strata
and the sampling is considered random (and thus representative) within each stratum;
In such a case, the strata-specific weighting will be employed. (2) The sampling represents a population different from the target, but a propensity score can be constructed
and individual-specific weighting will be needed. In the following, we will address these
two cases separately.
2.2.1. Stratum Specific Weighting
Suppose that the target population consists of S strata with proportions w1 , · · · , wS−1 ,
and wS . Also suppose that the underlying disease prevalence in each of the S strata
is π1 , · · · , πS−1 , and πS . The parameter of interest is the overall disease prevalence in
the target population:
πw =

S
X

ws πs .

s=1

Let the number of tests conducted in these strata be D1 , · · · , DS−1 , and DS , respectively. The number of positive tests in stratum s follows a Poisson distribution:
ds ∼ P ois(Ds rs ),

6

which can be approximated by N (Ds rs , Ds rs ), where rs = πs p0 + (1 − πs )(1 − q0 ).
Consequently,
dw =

S
X

w̃s ds ∼ N (Drw , λ0 Drw )

s=1

where D =

PS

s=1 Ds ,

w̃s = ws /(Ds /D), rw =

PS

s=1 ws rs ,

and

PS
λ0 =

s=1 w̃s ws rs

rw

is the variance inflation factor. Noting that πw = f (rw , p0 , q0 ), we can estimate πw
based on dw by
π̂w = f (r̂w , p̂, q̂),
where r̂w = dw /D. Define the test statistic
T̂w (π) =

π̂w − πw
,
σ̂w

where
2
σ̂w
=

2 p̂(1 − p̂)
λ̂r̂w
π̂w
(r̂w − p̂)2 q̂(1 − q̂)
+
+
,
D(p̂ + q̂ − 1)2 M (p̂ + q̂ − 1)2
N (p̂ + q̂ − 1)4

λ̂ =

−1
r̂w

( S
X

)
w̃s ws r̂s

,

s=1

and r̂s = ds /Ds .
To calculate the exact p-value for testing H0 : πw = π, we only need to modify the
steps (1), (4) and (5) of the algorithm in section 2.1.
(1) Construct 99.9% confidence intervals for rw denoted by Ir assuming λ0 = λ̂.
(4) For each (rk , pk , qk ) from the net for Ωπ , we simulate
∗
rwb
∼ N (Drk , λ̂Drk )/D
∗ = f (r ∗ , p∗ , q ∗ ) and
and let πwb
wb b b

∗2
σwb
=

∗ 2 p∗ (1 − p∗ )
∗ − p∗ )2 q ∗ (1 − q ∗ )
∗
πwb
(rwb
λ̂rwb
b
b
b
b
b
+
+
D(p∗b + qb∗ − 1)2 M (p∗b + qb∗ − 1)2
N (p∗b + qb∗ − 1)4

for b = 1, · · · , B. The exact p-value for testing H0 : (rw , p0 , q0 ) = (rk , pk , qk ) can

7

be estimated by
p̂w (rk , pk , qk ) = B

−1

 ∗

B
X
πwb − π
I
≥ |T̂w (π)| .
∗
σwb
b=1

(5) The exact p-value for testing H0 : πw = π can be approximated by
p̂w (π) =

max p̂w (rk , pk , qk ).

k=1,··· ,K

The 95% confidence interval for πw thus consists of all values of π such that the exact
p value for testing H0 : πw = π is greater than 0.05 − 0.003. This procedure assumes
that λ0 = λ̂ is known and thus is essentially a hybrid bootstrap method. Therefore,
the inference result may not be exact in all settings.
Remark 4. This method assumes that ds ∼ P ois(Ds rs ), which is approximately
Gaussian N (Ds rs , Ds rs ). Therefore, we implicitly assume that rs is small and Ds rs is
reasonably big, e.g., ≥ 10. If Ds rs ≈ 0 and there are very few strata, it is not clear
how to approximate the distribution of dw .
2.2.2. Individual Specific Weighting
With a slight abuse of notation, now suppose that the ith subject has a test result,
denoted by a Bernoulli random variable di ∼ Ber(ri ), and a weight wi , where ri =
D
P
πi p0 + (1 − πi )(1 − q0 ), πi is probability that the subject has the antibody, and
wi =
i=1

D. Our goal is again to estimate the weighted prevalence
πw =

D
1 X
wi π i .
D
i=1

Since di ∼ Ber(ri ), as D grows large, by central limit theorem, we can approximate
D
1 X
wi di ∼ N
D
i=1

D
D
1 X
1 X 2
wi ri , 2
wi ri (1 − ri )
D
D
i=1

!
=N

i=1

!
D
1 X 2
rw , 2
wi ri (1 − ri ) ,
D
i=1

under the Lindeberg condition that
D
1 X
E[wk2 (dk − rk )2 I {wk |dk − rk | > sn }] → 0
D→∞ s2
n

lim

k=1

for any  > 0, where rw = D−1

D
P

wi ri and sn =

i=1

D
P
k=1

wk2 rk (1−rk ). A sufficient condition

for the aforementioned convergence is
lim

max1≤j≤D wj

D
D→+∞ P
j=1

wj2 rj (1

8

− rj )

→ 0.

Since it is difficult to estimate

D
P
i=1

wi2 ri (1 − ri ), we make the further approximation

PD

2
i=1 wi ri (1

− ri )
≈
Drw (1 − rw )

λ0 =

PD

2
i=1 wi ri

Drw

PD

≈ Pi=1
D

wi2 di

i=1 wi di

= λ̂,

(2)

and
dw =

D
X



wi di ∼ N Drw , λ̂Drw (1 − rw ) .

i=1

Then we can repeat the steps above to construct the confidence interval, noting that
πw = f (rw , p0 , q0 ). We let the test statistic be
T̂w (π) =

π̂w − πw
,
σ̂w

where r̂w = dw /D, π̂w = f (r̂w , p̂, q̂), and
2
σ̂w
=

2 p̂(1 − p̂)
λ̂r̂w (1 − r̂w )
π̂w
(r̂w − p̂)2 q̂(1 − q̂)
+
+
,
D(p̂ + q̂ − 1)2 M (p̂ + q̂ − 1)2
N (p̂ + q̂ − 1)4

To calculate the exact p-value for testing H0 : πw = π, we only need to modify the
step (4) of the algorithm in section 2.1.
(4) For each (rk , pk , qk ) from the net, we simulate



∗
rwb
∼ N Drk , λ̂Drk (1 − rk ) /D
∗ = f (r ∗ , p∗ , q ∗ ) and
and let πwb
wb b b
∗2
σwb
=

∗ (1 − r ∗ )
∗ 2 p∗ (1 − p∗ )
∗ − p∗ )2 q ∗ (1 − q ∗ )
λ̂rwb
πwb
(rwb
wb
b
b
b
b
b
+
+
D(p∗b + qb∗ − 1)2 M (p∗b + qb∗ − 1)2
N (p∗b + qb∗ − 1)4

for b = 1, · · · , B.
In this proposed inference, again we assume that λ0 = λ̂ and the proposed inference
is still a hybrid bootstrap method. Although its coverage may not be “exact” for this
reason, we anticipate that it’s performance is much more robust than those asymptotic
methods.

3. Examples
We first applied our method to analyzing data gathered in [1]. The objective of this
study was to estimate the COVID-19 antibody prevalence in Santa Clara county, California, April 2, 2020. The data included D = 3, 330 volunteers tested for antibody
presence. Among them, there were 50 positive test results. Without considering the
measurement error, the crude prevalence is 1.5% with an exact 95% confidence interval of [1.11, 1.97]%. To account for the test performance, the reported sensitivity
9

of 130/157 and specificity of 368/371 based on M = 157 true positive samples and
N = 371 true negative samples, respectively, were used to adjust the antibody prevalence estimate in an initial preprint version of the study. In the meantime, far more
extensive additional data on test performance were being collected and verified. We
present the corresponding result later. For now,
r̂ =

50
130
368
, p̂ =
, q̂ =
, D = 3330, M = 157, N = 371.
3330
157
371

With delta method (with the range preserved logit transformation), the resulting 95%
confidence interval is [0.20, 3.50]%. The nonparametric bootstrap method yields a similar interval, i.e., [0.00, 1.93]%. Then, we applied our methods with B = 3, 000 and a
dense net consisting of 30 evenly spaced points in each 99.9% confidence interval for
r0 , p0 and q0 to construct the 95% exact confidence interval and the hybrid confidence
interval fixing p0 = p̂. Figure 1 plots the estimated exact p-value p̂(π), and the corresponding asymptotic p-value based on delta-method, nonparametric bootstrap, and
hybrid bootstrap fixing p0 = p̂. It is clearly that p̂(π) is higher than its asymptotic
counterparts, resulting in a wider confidence interval. The produced confidence intervals can be found in Table 1. All confidence intervals except that from delta method
with logit transformation included 0, and we were unable to make strong conclusions
about the lower bound of the prevalence with only a sample size of N = 371 for estimating the specificity. Since the resulting study cohort may not be randomly sampled
from the Santa-Clara population, weighted analysis with individual specific weighting
to reflect the demographic makeup of the target population was also conducted. The
resulting 95% confidence interval was [1.18, 3.78]% and [1.10, 3.69]% based on delta
method and nonparametric bootstrap, respectively. We also constructed the confidence interval based on proposed hybrid bootstrap fixing λ0 = λ̂ and (λ0 , p0 ) = (λ̂, p̂),
respectively. The lower ends of the hybrid bootstrap confidence intervals were closer
to 0 than that from delta method or nonparametric bootstrap, also suggesting the
uncertainty about the lower bound of the prevalence. The basic dilemma was that we
cannot reliably differentiate true positives from false positives, since we can’t estimate
the specificity level with adequate precision.
To address this difficulty, the study team assembled additional results about the
specificity based on 2,953 more measurements, bringing the total number of true negative samples used to estimate the specificity to N = 3, 324. We had used different
meta-analytic methods to combine data across subsets of control samples accounting
for potential between-datasets heterogeneity and the results were reasonably ably robust (not shown here). For illustrative purpose, we ignored the potential heterogeneity
and assumed simply pooling data in this application was appropriate. With a larger
sample size for estimating specificity (q̂ = 3, 308/3, 324, N = 3, 324), we repeated
the construction of 95% confidence intervals for the unweighted and weighted prevalence (Table 1). These resulting estimates were fairly consistent with those presented
in [1]. The unweighted results from different methods were very similar, while the
weighted results tended to have modestly wider confidence intervals with the “exact”
method and hybrid bootstrap. Figure 1 shown that the exact and asymptotic p-values
were close with each other based on the increased sample size , implying that the
distribution of π̂ − π can be approximated well by N (0, σ̂ 2 ). The lower bound of the
confidence interval based on delta-method and bootstrap for weighted prevalence was
slightly higher possibly due to the under-coverage tendency of the bootstrap method
at high specificity as our simulation study demonstrated (section 4).
10

Table 1. The point estimators and 95% confidence intervals for the weighted and unweighted
prevalence in Santa Clara study
N = 371
π̂ a
Delta Methodb
Bootstrap
Exact
H Bootstrap (p0 )
Unweighted (%) 0.85
(0.20, 3.50)
(0.00, 1.93) (0.00, 2.06)
(0.00, 2.06)
Weighted (%)
2.80
(1.18, 3.78)
(1.10, 3.72) (0.29, 5.17)
(0.29, 5.07)
N = 3, 324
Unweighted (%) 1.24
(0.77, 1.98)
(0.66, 1.84) (0.68, 1.87)
(0.68, 1.77)
Weighted (%)
2.87
(2.10, 3.6)
(2.12, 3.66) (1.39, 5.28)
(1.49, 5.08)
a Adjusted

for test sensitivity and specificity

b

Normal Logit Method

Table 2. The point estimators and 95% confidence intervals for
Brazil, USA, Denmark, and the Faroe Islands.
π̂
Delta Method
Bootstrap
Brazil
Male (%)
0.64
(0.10, 3.52)
(0.00, 1.55)
Female (%)
0.41
(0.02, 6.30)
(0.00, 1.30)
USA
Washington Male (%)
1.41
(0.67, 2.95)
(0.33, 2.42)
Washington Female (%)
1.71
(0.96, 3.03)
(0.70, 2.64)
New York Male (%)
5.94
(4.50, 7.80)
(4.33, 7.59)
5.66
(4.33, 7.38)
(4.15, 7.23)
New York Female (%)
Denmark
Capital (%)
3.23
(2.49, 4.17)
(2.36, 4.06)
Total (%)
1.87
(1.30, 2.68)
(1.13, 2.48)
Faroe Islands
Total (%)
0.59
(0.27, 1.31)
(0.19, 1.10)
Male (%)
0.59
(0.19, 1.82)
(0.00, 1.37)
Female (%)
0.59
(0.19, 1.82)
(0.00, 1.37)

the seroprevalence in studies from
Exact

H Bootstrap (p0 )

(0.00, 1.48)
(0.00, 1.15)

(0.00, 1.38)
(0.00, 1.15)

(0.10,
(0.39,
(4.17,
(3.98,

(0.10,
(0.49,
(4.27,
(4.08,

2.66)
2.84)
7.74)
7.35)

2.56)
2.74)
7.64)
7.25)

(2.13, 4.11)
(0.78, 2.55)

(2.23, 4.11)
(0.88, 2.45)

(0.00, 1.26)
(0.00, 1.67)
(0.00, 1.67)

(0.00, 1.16)
(0.00, 1.57)
(0.00, 1.57)

In order to examine the performance of different methods and the prevailing
practices for adjusting for test performances across seroprevalence studies that find
low seroprevalence estimates in the tested population, we used a recently published
overview of seroprevalence studies [13]. In four studies, crude, unadjusted seroprevalence was reported to not exceed 10% and the authors had tried to adjust for test performance. While three studies from Denmark, the Faroe Islands, and USA [7, 11, 16]
used the simple bootstrap method to make the statistical inference, the study from
Brazil [10] implemented a slightly different resampling method. In all four studies, the
adjustment for the test performance changed the seroprevalence point estimate by a
small amount reflecting the high precision of the test being used. The analysis results
using our proposed methods are summarized in Tables 2. The resulting exact 95%
confidence intervals were wider than those based on the delta method and bootstrap.
When the number of negative samples used to estimate the specificity was small such
as the study from the Faroe Islands, the difference became bigger reflecting the effect
of unknown specificity. On the other hand, when the sample sizes used to estimate
sensitivity and specificity were adequate and the observed prevalence was not low as
in the study at New York, the exact confidence intervals were only slightly wider than
those based on simple bootstrap. The data based on which the analysis were conducted
can be found in the Appendix in Table 8 and some of them were reconstructed from
the results in the published papers [7, 10, 11, 16].

4. Simulation
In this section, we have conducted extensive simulation studies to investigate the operational characteristics of the proposed method and compare it with existing methods

11

(a) N = 371

(b) N = 3324
Figure 1. Plot of p-values for various values of π according to different methods

12

Table 3. The empirical coverage probability and average length of 95% confidence interval of π0 based on exact
method, delta method, nonparametric bootstrap, and hybrid bootstraps; π = 1.2%, N = 371.
Exact Method
Delta Method
Bootstrap
Hybrid Bootstrap
p0 = p̂
r0 = r̂
(p0 , r0 ) = (p̂, r̂)
q0
Cov (Length)
Cov (Length)
Cov (Length)
Cov (Length)
Cov (Length)
Cov (Length)
97.0
0.950 (0.031)
0.934 (0.046)
0.934 (0.033)
0.949 (0.030)
0.956 (0.028)
0.947 (0.030)
98.0
0.982 (0.028)
0.944 (0.037)
0.944 (0.028)
0.957 (0.027)
0.956 (0.024)
0.941 (0.026)
98.4
0.970 (0.026)
0.952 (0.033)
0.948 (0.026)
0.966 (0.025)
0.937 (0.023)
0.943 (0.024)
98.6
0.970 (0.025)
0.920 (0.031)
0.912 (0.025)
0.961 (0.024)
0.949 (0.022)
0.938 (0.023)
98.8
0.974 (0.024)
0.926 (0.029)
0.914 (0.023)
0.963 (0.023)
0.957 (0.021)
0.941 (0.022)
99.0
0.976 (0.023)
0.932 (0.027)
0.928 (0.022)
0.952 (0.022)
0.929 (0.020)
0.946 (0.020)
99.2
0.970 (0.022)
0.922 (0.024)
0.912 (0.021)
0.961 (0.022)
0.941 (0.019)
0.948 (0.018)
99.4
0.980 (0.021)
0.892 (0.021)
0.902 (0.018)
0.959 (0.020)
0.944 (0.017)
0.963 (0.016)
99.6
0.982 (0.019)
0.886 (0.017)
0.898 (0.016)
0.977 (0.019)
0.969 (0.015)
0.960 (0.014)
99.8
0.992 (0.017)
0.908 (0.013)
0.928 (0.013)
0.993 (0.016)
0.955 (0.013)
0.838 (0.011)
99.9
0.992 (0.016)
0.940 (0.011)
0.950 (0.011)
0.992 (0.015)
0.900 (0.012)
0.673 (0.010)
100.0 0.982 (0.015)
0.948 (0.008)
0.962 (0.008)
0.975 (0.014)
0.768 (0.011)
0.459 (0.009)

in finite sample.
4.1. Unweighted Inference
In this simulation study, we mimic the Santa-Clara study by considering following
settings:
(1) the sensitivity p0 = 83%; sample size M = 157;
(2) the specificity q0 ∈ {97%, 98%, 98.4%, 98.6%, 98.8%, 99%, 99.2%, 99.4%, 99.8%, 99.9%, 100%};
sample size N = 371; and separately for N = 3, 324;
(3) the true prevalence π0 ∈ {0.4%, 1.2%, 5%, 10%}; sample size D = 3, 330.
For each setting, we have generated 1,000 sets of data and constructed the 95% confidence interval using the proposed exact method, the delta method, nonparametric bootstrap, and hybrid bootstraps where we have fixed the proportion of positive
tests (r0 ), sensitivity (p0 ), or both. In these simulations, we set B = 500 for our exact method and nonparametric bootstrap, and 1, 000 for hybrid bootstrap. Table 3
summarizes the average length and the empirical coverage level of constructed 95%
confidence intervals for π0 = 1.2% and for N = 317 only.
The exact method always has a coverage of about 95% or above as anticipated. The
delta method and nonparametric bootstrap may result in non-trivial under-coverage
when the specificity q0 is high. In addition, two hybrid bootstrap methods that fix
r also may produce confidence intervals that are too narrow. One explanation of the
failure of these hybrid bootstraps is that when fixing r0 at r̂, the sensitivity level
implied by the true prevalence π0 ,
r̂ − (1 − q)(1 − π0 )
> 1,
π0
for all qs close to q0 , excluding the true prevalence π0 from the confidence interval. On
the other hand, the hybrid bootstrap that only fixes p0 = p̂ has coverage at least 95%
for all values of q0 . The same pattern repeats in other simulation settings reported in
the supplementary materials as well (See Figures 3 and 4 of the Appendix), so moving
forward we focus on the exact method and the hybrid bootstrap that fixes p0 = p̂.
In the end, we have repeated the simulation with N = 3, 324, the reported sample
size in the Santa Clara study after pooling data from multiple sources. The results are
summarized in Table 2. In this case where the sample size used to estimate sensitivity
13

Table 4. The empirical coverage probability and average length of 95% confidence
interval of π0 based on exact method, delta method, nonparametric bootstrap, and hybrid
bootstrap; N = 3, 324.
Bootstrap
Delta Method
Exact Method
H Bootstrap
p0 = p̂
π0
q0
CovP (Length)
CovP (Length)
CovP (Length)
CovP (Length)
1.2
97.0
0.954 (0.022)
0.958 (0.020)
0.968 (0.021)
0.951 (0.020)
1.2
98.0
0.958 (0.018)
0.954 (0.018)
0.968 (0.018)
0.953 (0.018)
1.2
98.4
0.952 (0.016)
0.952 (0.016)
0.962 (0.017)
0.953 (0.017)
1.2
98.6
0.960 (0.016)
0.970 (0.016)
0.976 (0.017)
0.959 (0.016)
1.2
98.8
0.956 (0.015)
0.948 (0.015)
0.966 (0.016)
0.956 (0.015)
1.2
99.0
0.954 (0.014)
0.946 (0.014)
0.970 (0.015)
0.969 (0.014)
1.2
99.2
0.964 (0.013)
0.940 (0.013)
0.970 (0.014)
0.948 (0.013)
1.2
99.4
0.936 (0.012)
0.940 (0.012)
0.954 (0.013)
0.967 (0.012)
1.2
99.6
0.954 (0.011)
0.944 (0.011)
0.972 (0.012)
0.953 (0.011)
1.2
99.8
0.962 (0.009)
0.942 (0.010)
0.968 (0.010)
0.957 (0.010)
1.2
99.9
0.944 (0.009)
0.960 (0.009)
0.968 (0.009)
0.957 (0.009)
1.2
100.0
0.942 (0.008)
0.948 (0.008)
0.932 (0.008)
0.913 (0.008)

is large, these four methods all give reasonable coverage for tested values of q0 . Not
that in this case, the exact method is not much more conservative than other methods.
4.2. Stratum Specific Weighted Inference
In this case, the sensitivity and specificity are chosen as in section 4.1:
(1) the sensitivity is 83%; sample size M = 157;
(2) the specificity ∈ {97%, 98%, 98.4%, 98.6%, 98.8%, 99%, 99.2%, 99.4%, 99.8%, 99.9%, 100%};
sample size N = 371; and separately for N = 3, 324.
The true prevalence is stratum-specific and we have considered
Psix strata summarized
in Table 5. The true prevalence for the target population is 6s=1 ws πs = 1.2%. For
comparison purpose, we constructed the 95% confidence interval using nonparametric
bootstrap, delta method, proposed hybrid bootstrap fixing λ0 = λ̂, and faster hybrid
bootstrap fixing (λ0 , p0 ) = (λ̂, p̂). Table 6 summarizes the simulation results. The
delta-method is slightly better than nonparametric bootstrap but still produces undercovered confidence intervals for some q0 . On the other hand, the two proposed hybrid
bootstrap methods perform satisfactorily.
4.3. Individual Specific Weighted Inference
For cases needing individual specific weighting, we adopted the similar simulation
settings for sensitivity and specificity in section 4.2. The same individual weights in
[1] were used as weights, whose distribution is shown in Figure 2. The median weight
is 0.48 with an inter-quartile range of [0.22, 1.11]. To specify, πi , the probability of the
ith individual having the disease or antibody, we let
πi =

exp(−4.40 + 0.17wi )
, i = 1, · · · , D = 3, 330,
1 + exp(−4.40 + 0.17wi )

Table 5. Simulation Setting for Stratified Inference
Strata 1
Strata 2
Strata 3
Weights (ws )
0.05
0.07
0.08
Prevalence (πs )
0.03%
0.70%
0.07%
Number of tests (Ds )
500
700
300

14

Strata 4
0.15
0.07%
800

Strata 5
0.25
0.77%
230

Strata 6
0.40
2.33%
800

Table 6. The empirical coverage probability and average length of 95% confidence interval of π0 based on delta method, nonparametric bootstrap, and hybrid bootstrap for
stratum-specific weighted inference
Bootstrap
Delta Method
H Bootstrap
H Bootstrap
λ0 = λ̂
(λ0 , p0 ) = (λ̂, p̂)
π0
q0
CovP (Length)
CovP (Length)
CovP (Length)
CovP (Length)
1.2
97.0
0.938 (0.046)
0.952 (0.034)
0.964 (0.034)
0.963 (0.033)
1.2
98.0
0.934 (0.038)
0.954 (0.030)
0.962 (0.030)
0.958 (0.030)
1.2
98.4
0.922 (0.034)
0.938 (0.028)
0.964 (0.029)
0.955 (0.029)
1.2
98.6
0.920 (0.031)
0.940 (0.027)
0.968 (0.029)
0.962 (0.028)
1.2
98.8
0.902 (0.029)
0.926 (0.025)
0.962 (0.028)
0.956 (0.027)
1.2
99.0
0.918 (0.027)
0.938 (0.024)
0.978 (0.026)
0.952 (0.026)
1.2
99.2
0.902 (0.024)
0.930 (0.022)
0.972 (0.026)
0.965 (0.025)
1.2
99.4
0.882 (0.021)
0.930 (0.020)
0.970 (0.025)
0.969 (0.024)
1.2
99.6
0.858 (0.017)
0.946 (0.018)
0.986 (0.023)
0.984 (0.022)
1.2
99.8
0.836 (0.013)
0.960 (0.015)
0.996 (0.020)
0.991 (0.019)
1.2
99.9
0.844 (0.012)
0.940 (0.014)
0.984 (0.019)
0.986 (0.018)
1.2
100.0
0.802 (0.008)
0.922 (0.011)
0.970 (0.017)
0.952 (0.016)

Figure 2. The Distribution of Individual Weights in the Santa Clara Study

based on the fitted logistic regression to the observed data in Santa
P Clara study, where
the intercept is adjusted so that the weighted prevalence D−1 D
i=1 wi πi = 1.2%. This
model suggests a higher individual-specific weight wi was associated with a higher
probability πi . Again, we compared nonparametric bootstrap, delta method, proposed
hybrid bootstrap fixing λ0 = λ̂ and faster hybrid bootstrap fixing (λ0 , p0 ) = (λ̂, p̂).
The simulation results can be found in Table 7. The nonparametric bootstrap performs
poorly for most values of q0 . The delta method performs reasonably well until for q0
near 1, where the normality breaks down and the coverage starts to decrease drastically.
On the other hand, the performance of hybrid bootstrap method fixing λ0 is fairly
robust in terms of maintaining the appropriate coverage level except when q0 = 100%.
The hybrid method fixing both λ0 and p0 performs similarly.

5. Discussion
In order to estimate the prevalence of a disease using imperfect tests, we developed a
method that provides confidence intervals with appropriate coverage. This is important
because in many scenarios there is not enough data for large sample approximations

15

Table 7. The empirical coverage probability and average length of 95% confidence interval of π0 based on delta method, nonparametric bootstrap, and hybrid bootstrap for
individual-specific weighted inference
Bootstrap
Delta Method
H Bootstrap
H Bootstrap
λ0 = λ̂
(λ0 , p0 ) = (λ̂, p̂)
π0
q0
CovP (Length)
CovP (Length)
CovP (Length)
CovP (Length)
1.2
97.0
0.862 (0.046)
0.964 (0.043)
0.974 (0.049)
0.967 (0.049)
1.2
98.0
0.823 (0.037)
0.960 (0.038)
0.968 (0.047)
0.947 (0.044)
1.2
98.4
0.834 (0.034)
0.956 (0.036)
0.958 (0.043)
0.946 (0.043)
1.2
98.6
0.822 (0.031)
0.970 (0.034)
0.942 (0.042)
0.958 (0.041)
1.2
98.8
0.809 (0.029)
0.954 (0.033)
0.962 (0.043)
0.953 (0.039)
1.2
99.0
0.779 (0.027)
0.955 (0.032)
0.954 (0.039)
0.965 (0.037)
1.2
99.2
0.764 (0.024)
0.949 (0.030)
0.968 (0.038)
0.964 (0.036)
1.2
99.4
0.730 (0.021)
0.940 (0.028)
0.968 (0.036)
0.952 (0.035)
1.2
99.6
0.705 (0.017)
0.911 (0.026)
0.960 (0.034)
0.954 (0.032)
1.2
99.8
0.605 (0.013)
0.894 (0.024)
0.938 (0.031)
0.925 (0.029)
1.2
99.9
0.543 (0.011)
0.854 (0.022)
0.926 (0.029)
0.889 (0.027)
1.2
100.0
0.499 (0.008)
0.780 (0.020)
0.860 (0.027)
0.864 (0.026)

to be accurate, especially when the sensitivity p0 or specificity q0 is very close to 1,
which can cause the naive bootstrap confidence intervals to be too narrow. However,
our method is computationally more expensive than the bootstrap method by several
orders of magnitude, which translates to about half a minute to compute a single
confidence interval on a PC with a Ryzen 3900X CPU. In practice, we don’t believe this
will impose too large a burden, as typically there is no need to compute a confidence
interval many times.
In addition, only the proposed method for unweighted inference is truly exact; in
two weighted cases we still make some approximations for the distribution of rw . Such
an approximation is unavoidable due to the fact that the variance inflation factor
λ0 is unknown and may not be estimated well empirically. Also, we note that the
performance of the simple bootstrap becomes better as the sample size for estimating
specificity N rises. Therefore, while the sample size for estimating prevalence D is
important, the size of the confidence interval also heavily depends on the sample size
for estimating sensitivity and specificity, and especially the latter. Even as D grows,
the length of the confidence interval will not shrink to zero, since the uncertainty of the
sensitivity and specificity affects the estimation of the true prevalence. For experiments
aiming to estimate prevalence in settings where low values are expected, it is worth
the effort to accurately estimate the sensitivity and specificity. This prerequisite is no
longer a serious issue when the prevalence is sufficiently high.
Our review of the literature of COVID-19 seroprevalence studies [2, 5, 12, 20] shows
that many studies that estimate low crude prevalence do not even try to adjust for
test performance. Some of them may try to validate the positive samples using a
different laboratory assay [15]. Many others may assume that specificity is perfect. For
well-validated assays, this assumption may be approximately correct. For example, in
the case of the assay used in the Santa Clara study, the specificity was 99.5-99.8%
depending on how pooling or meta-analysis of control datasets would be performed.
Moreover, among the few control samples coined as “false positives”, the majority
were probably true positives that had been mischaracterized, as these control samples
came from data collected during the COVID-19 pandemic, where a negative RT-PCR
result can not rule out the possibility that a person had already been infected in the
past. Most of the remaining “false positives” that came from pre-COVID samples were
atypical cases (e.g. from people with extremely high titers of rheumatoid factor) that
are rarely encountered in the general population. This means the true specificity of
the test used in Santa Clara study may be even higher. However, our simulation study
16

shows that the simple bootstrap or delta-method may still yield suboptimal coverage
even with a perfect specificity and the method that we propose may have value in such
a setting.
Another strategy to alleviate the false positive issue would be via study design:
to retest all patients whose results are positive [18]. An important reason why it is
difficult to estimate the prevalence is because the false positive rate can be relatively
high, and the estimated prevalence is very sensitive to the false positive rate. If it is
possible to have an independent second test applied to patients who are test positive,
we can eliminate almost all false positives and overcome this obstacle.

References
[1] E. Bendavid, B. Mulaney, N. Sood, S. Shah, E. Ling, R. Bromley-Dulfano, C. Lai, Z.
Weissberg, R. Saavedra-Walker, J. Tedrow, D. Tversky, A. Bogan, T. Kupiec, D. Eichner,
R. Gupta, J. Ioannidis, and J. Bhattacharya, COVID-19 antibody seroprevalence in santa
clara county, california (2020). Available at https://doi.org/10.1101/2020.04.14.
20062463.
[2] Z. Ceylan, Estimation of COVID-19 prevalence in italy, spain, and france, Science of The
Total Environment 729 (2020), p. 138817.
[3] I.S.F. Chan and Z. Zhang, Test-based exact confidence intervals for the difference of two
binomial proportions, Biometrics 55 (1999), pp. 1202–1209.
[4] C.S. Chuang and T.L. Lai, Hybrid resampling methods for confidence intervals, Statistica
Sinica 10 (2000), pp. 1–33.
[5] W. de Souza, L. Buss, D. Candido, and et al., Epidemiological and clinical characteristics
of the COVID-19 epidemic in brazil, Nature Human Behaviour 4 (2020), pp. 856–865.
[6] C. Enøe, M.P. Georgiadis, and W.O. Johnson, Estimation of sensitivity and specificity of
diagnostic tests and disease prevalence when the true disease state is unknown, Preventive
Veterinary Medicine 45 (2000), pp. 61 – 81.
[7] C. Erikstrup, C.E. Hother, O.B.V. Pedersen, K. Mølbak, R.L. Skov, D.K. Holm, S.
Sækmose, A.C. Nilsson, P.T. Brooks, J.K. Boldsen, C. Mikkelsen, M. Gybel-Brask, E.
Sørensen, K.M. Dinh, S. Mikkelsen, B.K. Møller, T. Haunstrup, L. Harritshøj, B.A.
Jensen, H. Hjalgrim, S.T. Lillevang, and H. Ullum, Estimation of SARS-CoV-2 infection fatality rate by real-time antibody screening of blood donors (2020). Available at
https://doi.org/10.1101/2020.04.24.20075291.
[8] G.J. Feldman and R.D. Cousins, Unified approach to the classical statistical analysis of
small signals, Phys. Rev. D 57 (1998), pp. 3873–3889.
[9] J. Gronsbell, C. Hong, L. Nie, Y. Lu, and L. Tian, Exact inference for the random-effect
model for meta-analyses with rare events, Statistics in Medicine 39 (2020), pp. 252–264.
[10] P.C. Hallal, F.P. Hartwig, B.L. Horta, M.F. Silveira, C.J. Struchiner, L.P. Vidaletti,
N.A. Neumann, L.C. Pellanda, O.A. Dellagostin, M.N. Burattini, G.D. Victora, A.M.B.
Menezes, F.C. Barros, A.J.D. Barros, and C.G. Victora, SARS-CoV-2 antibody prevalence
in brazil: results from two successive nationwide serological household surveys, The Lancet
Global Health 8 (2020), pp. e1390–e1398.
[11] F.P. Havers, C. Reed, T. Lim, J.M. Montgomery, J.D. Klena, A.J. Hall, A.M. Fry, D.L.
Cannon, C.F. Chiang, A. Gibbons, I. Krapiunaya, M. Morales-Betoulle, K. Roguski,
M.A.U. Rasheed, B. Freeman, S. Lester, L. Mills, D.S. Carroll, S.M. Owen, J.A. Johnson,
V. Semenova, C. Blackmore, D. Blog, S.J. Chai, A. Dunn, J. Hand, S. Jain, S. Lindquist,
R. Lynfield, S. Pritchard, T. Sokol, L. Sosa, G. Turabelidze, S.M. Watkins, J. Wiesman,
R.W. Williams, S. Yendell, J. Schiffer, and N.J. Thornburg, Seroprevalence of antibodies
to SARS-CoV-2 in 10 sites in the united states, march 23-may 12, 2020, JAMA Internal
Medicine (2020). Available at https://doi.org/10.1001/jamainternmed.2020.4130.
[12] Y. Hu, J. Sun, Z. Dai, H. Deng, X. Li, Q. Huang, Y. Wu, L. Sun, and Y. Xu, Prevalence

17

[13]
[14]
[15]

[16]

[17]
[18]
[19]
[20]

and severity of corona virus disease 2019 (COVID-19): A systematic review and metaanalysis, Journal of Clinical Virology 127 (2020), p. 104371.
J. Ioannidis, The infection fatality rate of COVID-19 inferred from seroprevalence data
(2020). Available at https://doi.org/10.1101/2020.05.13.20101253.
H. Michael, S. Thornton, M. Xie, and L. Tian, Exact inference on the random-effects
model for meta-analyses with few studies, Biometrics 75 (2019), pp. 485–493.
D.L. Ng, G.M. Goldgof, B.R. Shy, A.G. Levine, J. Balcerek, S.P. Bapat, J. Prostko,
M. Rodgers, K. Coller, S. Pearce, S. Franz, L. Du, M. Stone, S.K. Pillai, A. SotomayorGonzalez, V. Servellita, C.S.S. Martin, A. Granados, D.R. Glasner, L.M. Han, K. Truong,
N. Akagi, D.N. Nguyen, N.M. Neumann, D. Qazi, E. Hsu, W. Gu, Y.A. Santos, B. Custer,
V. Green, P. Williamson, N.K. Hills, C.M. Lu, J.D. Whitman, S.L. Stramer, C. Wang, K.
Reyes, J.M.C. Hakim, K. Sujishi, F. Alazzeh, L. Pham, E. Thornborrow, C.Y. Oon, S.
Miller, T. Kurtz, G. Simmons, J. Hackett, M.P. Busch, and C.Y. Chiu, SARS-CoV-2 seroprevalence and neutralizing activity in donor and patient blood, Nature Communications
11 (2020). Available at https://doi.org/10.1038/s41467-020-18468-8.
M.S. Petersen, M. Strøm, D.H. Christiansen, J.P. Fjallsbak, E.H. Eliasen, M. Johansen,
A.S. Veyhe, M.F. Kristiansen, S. Gaini, L.F. Møller, B. Steig, and P. Weihe, Seroprevalence
of SARS-CoV-2–specific antibodies, faroe islands, Emerging Infectious Diseases 26 (2020),
pp. 2760–2762.
J. Reiczigel, J. Foldi, and L. Ózsvari, Exact confidence limits for prevalence of a disease
with an imperfect diagnostic test, Epidemiology and Infection 138 (2010), p. 1674–1678.
C. Sempos and L. Tian, Adjusting coronavirus prevalence estimates for laboratory test kid
error, American Journal of Epidemiology (in press) (2020).
B. Sen, M. Walker, and M. Woodroofe, On the unified method with nuisance parameters,
Statistica Sinica 19 (2009), pp. 301–314.
C. Signorelli, T. Scognamiglio, and A. Odone, COVID-19 in italy: impact of containment
measures and prevalence estimates of infection in the general population, Acta Bio Medica
Atenei Parmensis 91 (2020), pp. 175–179.

18

6. Appendix
6.1. Additional Simulation Results and Data used for the seroprevalence
in studies from Brazil, USA, Denmark, and the Faroe Islands
In Figure 3, we plot the empirical coverage levels of various confidence intervals assuming different true prevalence level, i.e., π0 ∈ {0.4%, 5%, 10%}. While most confidence
intervals retain appropriate coverage level when π0 = 10%, only the proposed exact
method and hybrid bootstrap fixing p0 at p̂ perform satisfactorily when the prevalence
π0 = 0.4%. Specifically, even when the prevalence is 5%, the 95% confidence interval
based on nonparametric bootstrap may still too liberal with a coverage level approximately 90% for some specificity values. Figure 4 plots the average length of the 95%
confidence intervals. Note that the average length of the proposal exact confidence
interval is not substantially longer than alternatives.
Table 8 includes the data used for the analysis of the seroprevalence in studies from
Brazil, USA, Denmark and the Faroe Islands. Note that some studies only reported the
confidence intervals for the test sensitivity and specificity and the corresponding data
were reconstructed based on the confidence interval, which may be slightly different
from the actual data.

19

Figure 3. Plot of coverages for varying values of specificity q for N = 371 under π = 0.4, 5.0, 10.0

20

Figure 4. Plot of confidence interval lengths for varying values of specificity q for N = 371 under π =
0.4, 5.0, 10.0

21

Table 8. Data used for the seroprevalence in studies from Brazil, USA,
and the Faroe Islands.
r (%)
p(%)
q(%)
d/D
m/M
Brazil
Male
1.50
84.79
99.03
158/10531 446/526
Female
1.31
84.79
99.03
189/14464 446/526
USA
Washington Male
1.95
96.00
99.40
26/1334
96/100
Washington Female
2.23
96.00
99.40
43/1930
96/100
New York Male
6.27
96.00
99.40
72/1149
96/100
New York Female
6.00
96.00
99.40
80/1333
96/100
Denmark
Capital
3.11
82.58
99.54
203/6528
128/155
Total
2.00
82.58
99.54
412/20640 128/155
Faroe Islands
Total
0.56
94.44 100.00
6/1075
238/252
Male
0.56
94.44 100.00
3/538
238/252
Female
0.56
94.44 100.00
3/537
238/252

22

Denmark,
n/N
513/518
513/518
497/500
497/500
497/500
497/500
648/651
648/651
308/308
308/308
308/308

