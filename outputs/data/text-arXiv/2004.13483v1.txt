Predicting Infection of COVID-19 in Japan:
State Space Modeling Approach
Genya Kobayashi1 , Shonosuke Sugasawa2 , Hiromasa Tamae3 and Takayuki Ozu3

arXiv:2004.13483v1 [stat.AP] 28 Apr 2020

1 Graduate
2 Center

School of Social Science, Chiba University,

for Spatial Information Science, The University of Tokyo

3 Nospare

Inc.

Abstract
The number of confirmed cases of the coronavirus disease (COVID-19) in Japan has
been increasing day by day and has had a serious impact on the society especially
after the declaration of the state of emergency on April 7, 2020. This study analyzes
the real time data from March 1 to April 22, 2020 by adopting a sophisticated statistical modeling tool based on the state space model combined with the well-known
susceptible-exposed-infected (SIR) model. The model estimation and forecasting are
conducted using the Bayesian methodology. The present study provides the parameter estimates of the unknown parameters that critically determine the epidemic
process derived from the SIR model and prediction of the future transition of the
infectious proportion including the size and timing of the epidemic peak with the
prediction intervals that naturally accounts for the uncertainty. The prediction results under various scenarios reveals that the temporary reduction in the infection
rate until the planned lifting of the state on May 6 will only delay the epidemic peak
slightly. In order to minimize the spread of the epidemic, it is strongly suggested that
an intervention is carried out for an extended period of time and that the government
and individuals make a long term effort to reduce the infection rate even after the
lifting.
Key words: COVID-19; epidemic peak; SIR model
1

1

Introduction

Since the first case of the coronavirus disease 2019 (COVID-19) in Japan was confirmed on January 15, 2020, the number of confirmed cases has been increasing day
by day. Although the Japanese government declared a state of emergency on April
7, it does not have a legal force to regulate individual activities and remains at only
requesting the avoidance of outings. Consequently, the number of cases has been still
increasing as shown in Figure 1. Needless to say, Japanese economy has been seriously
shocked and the public interest mainly lies on how the number of infected persons
transits in the future and when the outbreak will converge. Although there already
exists a rapidly increasing number of statistical analyses of the epidemic, the statistical evidence focusing on the situations in Japan is still limited except for [7, 5, 10].
Therefore, the purpose of this study is to provide a statistical evidence regarding the
future transition of the infectious proportion in Japan, including the intensity and
timing of the epidemic peak, based on the real-time data on the cumulative number
of confirmed, recovered and deceased persons, shown in Figure 1.
We consider the famous susceptible-infected-recovered (SIR) model [6] for modeling the epidemic process as widely adopted in the existing literature on COVID-19.
However, this deterministic model is not necessarily sufficient to explain the variability of the transition since the observed number is subject to nonignorable randomness.
To handle such randomness in the data, we employ the state spate models combined
with the SIR model (SS-SIR model) developed by [2, 12]. The model was originally
proposed for statistical modeling of the seasonal trend of influenza. The advantages
of the SS-SIR model are mainly three points; (1) the unknown parameters in the SIR
model can be estimated with little knowledge about the true values by adequately
using the data information; (2) future prediction of a variety of quantities such as
the number of infections or the epidemic peak as well as uncertainty quantification
of the prediction can be carried out easily; (3) whether the real-time data follows the
assumed SIR model or not can be assessed through the parameter estimate. These
advantages are quite essential because (1)information required for modeling the epi-

2

demic trend of a new virus is scarce, (2) it is important to compute not only point
prediction but also interval prediction to understand the possible worst and best
scenarios of future transition, and (3) understanding if the real-time data actually
follows the SIR model is critical for the reliability of future simulations based on the

10000
6000

confirmed
recovered
deceased

0 2000

Number of reported cases

SIR model.

20/01/22

20/02/12

20/03/04

20/03/25

20/04/15

day

Figure 1: The cumulative numbers of confirmed, recovered and deceased persons in
Japan.

2
2.1

Methods
Data

We use the numbers of confirmed, recovered and deceased persons collected on an open
source platform (https://www.kaggle.com/sudalairajkumar/novel-corona-virus-2019-dataset).
Although the original data starts from January 22, the numbers before the end of
February are treated collectively. This is because the confirmed numbers in this period are relatively small and using the data after March 2020 would be useful to
reliably predict the future numbers of infectious persons after May 2020. Hence, the
period of the data used in our analysis consists of T = 53 days from March 1 to April
22. We use the difference between the cumulative numbers of confirmed persons and
recovered plus deceased persons, denoted by Z(t) for t = 1 . . . , T , which can be interpreted as the number of confirmed persons being infectious. It is further assumed that
only p (0 < p ≤ 1) fraction of infectious individuals can be identified by diagnosis,
which is called identification rate hereafter. Then we define Y (t) as Z(t) = N p × Y (t)

3

where N = 1.265 × 108 is the population of Japan, thereby Y (t) is the proportion
of the infectious population at time t. Regarding the specific values of p, we follow
the discussion in [7]. Since [1] reported that 77 persons were confirmed among the
possible 940 infected population, the 95% confidence interval of p is (0.059, 0.105).
Based on this argument, the results under the following three scenarios p = 0.05, 0.1
and 0.2 are compared.

2.2

Statistical model

Here the model proposed by [12] is described. Let S(t), I(t) and R(t) denote the
proportions of individuals being susceptible, infected and recovered population at the
time t, respectively, satisfying S(t) + I(t) + R(t) = 1. The SIR model describes the
epidemic over time via the nonlinear ordinary differential equations (ODE) given by
S 0 (t) = −βS(t)I(t),

I 0 (t) = βS(t)I(t) − γI(t),

R0 (t) = γI(t),

(1)

where the unknown infection rate β > 0 and removal rate γ > 0 control the transition
from one compartment to the next and jointly determine the epidemic process. Let
θ(t) = (S(t), I(t), R(t)) define the three-dimensional vector of the unobserved true
proportion at the time t. To allow randomness in the evolution of θ(t), the following
model is considered:

θ(t)|θ(t − 1) ∼ Dir(κf (θ(t − 1); β, γ)),

t = 1, . . . , T,

(2)

where Dir(·) denotes the Dirichlet distribution, f (θ(t − 1); β, γ) is the solution of the
deterministic SIR model (1) starting the ODE at θ(t − 1) and κ > 0 is the unknown
parameter controlling the randomness in the evolution. In the above model, the
conditional expectation of θ(t) given the previous state θ(t − 1) is f (θ(t − 1); β, γ),
so the distribution of θ(t) is centered around the deterministic model (1). It is noted
that the conditional variance of θt decreases as κ increases, thus the validity of the
assumption of the deterministic model (1) can be verified through the estimate of κ.

4

Let Y (t) be the observed value of I(t). Since Y (t) is not necessarily equal to the
true I(t), Y (t) is observed based on the following probabilistic model:

Y (t)|I(t) ∼ Beta(λI(t), λ(1 − I(t))),

t = 1, . . . , T,

(3)

where Beta(·, ·) denotes the Beta distribution and λ > 0 is an unknown parameter
having a similar role to κ in (2). The statistical model for Y (t) with the combination
of (2) and (3) is seen as a state space model.
The unknown parameters in the model are the two parameters β and γ in the
SIR model and two scale parameters κ and λ that control the randomness in the two
equations (2) and (3). The estimation of these parameters and future prediction is
conducted within the Bayesian framework in which we assign prior distributions for
these parameters and compute the posterior distribution via the Bayes rule. Due to
the complexity of the model, the analytical derivation of the posterior distribution is
not feasible. Instead, we rely on the simulation-based method known as Markov Chain
Monte Carlo (MCMC) algorithm [3] to generate random numbers from the posterior
distribution. Then the parameter estimates are calculated and future prediction
is carried out based on the output of the MCMC algorithm. Regarding the prior
distributions, we assign slightly non-informative priors to reflect the uncertainty about
the new epidemic and let the data tell the truth adequately. The details of the settings
of the prior distributions and algorithm are provided in Supplementary Material.

3
3.1

Results
Prediction of epidemic peak

The SS-SIR model is applied to the Japanese data with the three identification rates
p. First, we found that the estimates of the precision parameters κ and λ are very
b = 1.75 × 105 and κ
large. For example, the point estimates are λ
b = 2.64 × 105 for
p = 0.1 indicating that the deterministic SIR model explains the transition of the
real-time data well. Table 1 reports the estimates and 95% credible intervals of the

5

representative parameters. Under the three settings for p, the point estimates of β are
between 0.21 and 0.25 and those of γ are between 0.14 and 0.18. The estimates of the
basic reproduction number R0 are between 1.41 and 1.48. For p = 0.1, for example,
the 95% credible interval of R0 is (1.22–1.64). The estimates of PI and PT appear to
vary depending on the identification rate. Figure 2 reports the future predictions of
the proportion of the infectious proportion under the three identification rates. The
figure allows us to easily understand the degree of uncertainty in prediction, and worst
and best scenarios for the future epidemic process through the interval prediction.
It is seen that the predicted timing of the epidemic peak and peak intensity depend
on the identification rate through the differences in the estimates of PT and PI.
Specifically, the point predictions of the trajectory of the infectious proportion have
the timing of the peak on July 12, July 23 and July 30 with the intensities and 95%
prediction intervals of 3.81% (1.30%–7.19%), 2.7% (0.48%–6.23%) and 2.09% (0.15%–
6.04%) for p = 0.05, 0.1 and 0.2, respectively. The sensitivity of prediction results
with respect to p was also found in [7], but that under our setting of p is far less
dramatic. Moreover, all the scenarios predict that the epidemic peak comes during
the summer 2020. This result is also consistent with [7].

3.2

Effect of intervention

On April 7, 2020, the Japanese government declared a state of emergency aiming at
reducing human contacts by 80%, which is considered to be sufficient to terminate the
epidemic. However, the government reports that the actual reduction is still limited
to around 60% or 70% (https://corona.go.jp), mainly because the state does not
have a legal force to regulate individual activities. Also the Japanese government
plans to lift the state on May 6, but the public concern lies on whether such a short
period of the state of emergency is sufficient or not.
Through simulation, we here assess the efficacy of further intervention and public
awareness on mitigating the infection risk under various scenarios. Specifically, we
consider various settings for the degrees of reduction in human contacts that are
achieved by the government during the intervention and by the public awareness
6

after the intervention, and the period of intervention denoted by T ∗ , under the state
of emergency and predict the future epidemic transitions. Here, we focus on p = 0.1.
The results under p = 0.05 and 0.2 are found in Supplementary Material. It is
recognized that the realization of the effect of reducing human contacts takes about
two weeks since the incubation period of COVID-19 is at most 2 weeks as reported
by World Health Organization. Since April 22, the last date in the real-time data,
is almost two weeks after the declaration of the state of emergency, we assume that
the infection rate changes from β to cβ from April 23. For the degree of reduction in
human contacts, the following six scenarios are considered: c = 0.6, 0.5, 0.4, 0.3, 0.2
and 0.1 If 80% reduction of human contacts was achieved, the reality would have
corresponded to c = 0.2 or 0.1. In view of the current situation, however, c = 0.4
or 0.3 would be closer to the reality. We also suppose that the intervention will
continue for T ∗ days from April 23 with the three scenarios, T ∗ = 14, 28 and 45.
Note that T ∗ = 14 corresponds to May 6 on which the government is planning
to lift the state. The other two dates to respectively correspond to the two-week
and one-month extension of the intervention that continue until May 20 and June
6, respectively. We further suppose that the infection rate becomes c∗ β after the
intervention period with the three scenarios: c∗ = 1, 0.9 and 0.8. The first scenario
implies that the level of human mobility after the intervention returns to the original
level before the intervention. The latter two scenario can reflect the remaining strain
in the public awareness on mitigating the spread of infection through, for example,
voluntary avoidance of outings and social distancing.
Figure 3 presents the nine panels on the future prediction under the combinations
of the three scenarios of each T ∗ and c∗ . Comparing the different scenarios of T ∗ ,
the figure reveals that setting c to smaller values is effective only when it is combined
with larger T ∗ . For example, the left upper panel of Figure 3 exhibits little differences
among the six choices of c when c∗ = 1 and T ∗ = 14. Contrary, the small values of c
such as c = 0.2 with T ∗ = 28 and 45 can lead to a convergence of the epidemic. Under
c = 0.2 and c∗ = 1, the epidemic can be terminated in terms of point prediction when
T ∗ = 45, while the epidemic peak belatedly comes on September 8, 2020 with 2.4%
7

of the peak intensity when T ∗ = 14. The result suggests that the termination of the
intervention due to the currently planned lifting of the state of emergency on May 6
is too early and would only result in a slight delay in the epidemic peak and a slight
reduction in the peak intensity.
The degree of reduction in β after the intervention, c∗ , also has a dramatic effect on
the consequence of the epidemic. The upper panels of Figure 3 show that the efficacy
of the temporary reduction in β under the intervention can be quite limited if β returns
to the original level after the intervention. In contrast, if at least 20% reduction in
β can be achieved for a sufficiently long period of time after the intervention, the
epidemic can be effectively suppressed. In the case of c∗ = 0.9, for example, the peak
intensity is more than halved to 1.21% with the peak on September 16 even under the
mild degree of intervention for a short period of time (c = 0.6 and T ∗ = 14). When a
longer intervention T ∗ = 45 is carried out, the peak is further delayed to November 14
with 0.93% of the peak intensity. Furthermore, in the case of c∗ = 0.8, the figure shows
the epidemic is almost completely suppressed in terms of point prediction regardless
of the degree of intervention and length of intervention period. To summarize, our
results show that not only the degree of reduction in β during the intervention but
also and more importantly the length of intervention and the long term level of β
after the intervention is critical to control the spread of the epidemic.
Table 1: Estimates and 95% credible intervals of parameters of the SS-SIR model
under the three identification rates p.
Estimate (95% interval)
p = 0.1
p = 0.2

Parameter

Description

p = 0.05

β
γ
R0 (= β/γ)
PT
PI(%)

Infection rate
Removal rate
Basic reproduction number
Peak timing
Peak intensity

0.21 (0.13–0.34)
0.14 (0.08–0.25)
1.48 (1.30–1.69)
145 (102–225)
4.48 (1.80–7.80)

4

0.23 (0.13–0.43)
0.16 (0.09–0.34)
1.43 (1.22–1.64)
161 (99–252)
3.67 (0.99–7.02)

0.25 (0.13–0.55)
0.18 (0.09–0.45)
1.41 (1.19–1.65)
157 (91–265)
3.34 (0.68–7.19)

Discussion

In this research, we have employed the probabilistic version of the famous SIR model,
called SS-SIR model, to model the real-time data on the infectious population of
8

20/09/01

20/12/01

21/03/01

0.08
0.06
0.00

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

median
95% interval

0.04

Proportion infected

0.08
0.06
0.00

20/06/01

median
95% interval

0.04

Proportion infected

0.06
0.04
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

p = 0.2

0.02

0.08

median
95% interval

0.02
0.00

Proportion infected

p = 0.1

0.02

p = 0.05

20/06/01

day

20/09/01

20/12/01

21/03/01

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

day

20/06/01

20/09/01

20/12/01

21/03/01

day

Figure 2: Results of the prediction of the proportion of the infectious population with
p = 0.05 (left), 0.1 (center) and 0.2 (right). The observed data points {Y (t), t =
1, . . . , T } are shown by the black dots.
COVID-19 in Japan. The advantage of the SS-SIR model is that we can obtain not
only future point prediction but also uncertainty quantification through, for example,
the future prediction intervals. The basic reproducing number R0 is estimated to be
approximately between 1.4 and 1.5 in this study. This is smaller than the estimate
of 2.6 in [7] obtained from the SEIR model applied to the early stage data in Japan.
Note, however, that [7] did not estimate the removal rate and onset rate but fixed their
values to those found in the existing studies. We also estimated R0 using the subset
of the data up to April 6 for p = 0.1 and the estimate is 1.44 with the 95% credible
interval (1.22–1.66). Therefore, our estimates for R0 remain unchanged even when
the observations after the state of emergency are excluded. Moreover, our estimate in
the case of Japan is also smaller than those reported from the case studies in China
[e.g. 4, 9, 8, 13, 14]. Our result may have reflected the fact that the number of cases
in Japan does not increase as rapidly as other countries [11].
Through the future prediction under various scenarios on the possible reduction
in the infection rate β and the length of the intervention period, we have obtained
the following epidemiological insights:
• Even if a large reduction in β could be achieved during the intervention period
(e.g. the state of emergency), the convergence of the epidemic can depends on
the long term value of β after the intervention.
• As long as the value of β can be maintained to be slightly smaller even after the
9

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/06/01

20/09/01

20/12/01

21/03/01

0.6
0.5
0.4

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/06/01

day

14

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/06/01

20/09/01

20/12/01

21/03/01

0.6
0.5
0.4

20/06/01

14

20/06/01

20/09/01

20/12/01

21/03/01

day

c =
c =
c =

0.6
0.5
0.4

21/03/01

20/06/01

c =
c =
c =

day

21/03/01

0.6
0.5
0.4

c =
c =
c =

45

0.3
0.2
0.1

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/06/01

28

20/09/01

20/12/01

c* = 0.8, T* =

c = 0.3
c = 0.2
c = 0.1

20/09/01

20/12/01

21/03/01

day

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/09/01

c* = 0.9, T* =

Proportion infected

Proportion infected
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/06/01

28

20/12/01

c* = 0.8, T* =

0.3
0.2
0.1

0.3
0.2
0.1

day

c = 0.3
c = 0.2
c = 0.1

20/09/01

c =
c =
c =

45

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

Proportion infected

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

c =
c =
c =

0.6
0.5
0.4

day

c* = 0.8, T* =
0.6
0.5
0.4

21/03/01

Proportion infected

c =
c =
c =

day

c =
c =
c =

20/12/01

c* = 0.9, T* =

0.3
0.2
0.1
Proportion infected

c =
c =
c =

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

Proportion infected

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

0.6
0.5
0.4

20/09/01

c =
c =
c =

day

c* = 0.9, T* =
c =
c =
c =

c = 0.3
c = 0.2
c = 0.1
Proportion infected

c =
c =
c =

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

0.3
0.2
0.1

c* = 1, T* =

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

c =
c =
c =

28

20/12/01

21/03/01

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

0.6
0.5
0.4

c* = 1, T* =

Proportion infected

c =
c =
c =

14
0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

Proportion infected

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

c* = 1, T* =

c =
c =
c =

0.6
0.5
0.4

c =
c =
c =

45

0.3
0.2
0.1

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/06/01

20/09/01

20/12/01

21/03/01

day

Figure 3: Future prediction under the nine combinations of T ∗ (the period of the
intervention) and c∗ (the multiplier for β after the intervention) for p = 0.1. The
red, black and grey curves respectively represent the future point prediction without
intervention shown in Figure 2, point prediction under each scenario and one-sided
upper 95% prediction intervals.
intervention period than that before the intervention, there is a great possibility
that the epidemic terminates with a significantly smaller epidemic size than the
case without intervention.
• The effort to reduce β should be combined with a sufficiently long intervention
period.
These findings suggest that the lifting of the state of emergency on May 6 planned
by the Japanese government will unfortunately have a too limited effect for the eco10

nomic and social disturbances caused by the epidemic and state. A long term effort
to tackle this situation is indispensable.

Acknowledgement
This research was supported by Japan Society for the Promotion of Science (KAKENHI) Grant Numbers 18K12754 and 18K12757.

References
[1] Bloomberg.
able

online:

Japan’s hokkaido may have 940 infected, researcher says availhttps://www.bloomberg.com/news/articles/2020-03-03/

japan-s-hokkaido-could-have-up-to-940-infected-researcher-says

(3

march 2020).
[2] Dukic, V., H. F. Lopes, and N. G. Polson (2012). Tracking epidemics with google
flu trends data and a state-space seir model. Journal of the American Statistical
Association 107, 1410–1426.
[3] Gamerman, D. and H. F. Lopes (2006). Matkov Chain Monte Carlo: Stochastic
Simulation for Bayesian Inference, Second Edition. Chapman and Hall/CRC.
[4] Imai, N., A. Cori, I. Dorigatti, M. Baguelin, C. Connelly, S. Riley, and N. Ferguson. Report 3: Transmissibility of 2019-ncov; imperial college london: London, uk,
2020.
[5] Karako, K., P. Song, Y. Chen, and W. Tang (2020). Analysis of covid-19 infection
spread in japan based on stochastic transition model. BioScience Trends, to appear.
[6] Kermack, W. and A. McKendrick (1927). Contribution to the mathematical theory of epidemics. Proceedings of the Royal Society of London, Series A 115, 700–
721.

11

[7] Kuniya, T. (2020). Prediction of the epidemic peak of coronavirus disease in
japan, 2020. Journal of Clinical Medicine 9, 789.
[8] Liu, T., J. Hu, M. Hang, L. Lin, H. Zhong, J. Xiao, G. He, T. Song, Q. Huang,
Z. Rong, and et al (2020). Transmission dynamics of 2019 novel coronavirus (2019ncov). bioRxive.
[9] Liu, Y., A. A. Gayle, A. Wilder-Smith, and J. Rocklov (2020). The reproductive
number of covid-19 is higher compared to sars coronavirus. Journal of Travel
Medicine 27, taaa021.
[10] Mizumoto, K., K. Kagaya, A. Zarebski, and G. Chowell (2020). Estimating the
asymptomatic proportion of coronavirus disease 2019 (covid-19) cases on board the
diamond princess cruise ship, yokohama, japan, 2020. Eurosurveillance 25.
[11] Nippon.com.

Coronavirus cases by country https://www.nippon.com/en/

japan-data/h00673/coronavirus-cases-by-country.html (24 april 2020).
[12] Osthus, D., K. Hickmann, P. C. Caragea, D. Higdon, and S. Y. Del Valle (2017).
Forecasting seasonal influenza with a state-space sir model. The Annals of Applied
Statistics 11, 202–204.
[13] Tang, B., X. Wang, Q. Li, N. Bragazzi, S. Tang, Y. Xiao, and J. Wu (2020).
Estimation of the transmission risk of the 2019-ncov and its implication for public
health interventions. Journal of Clinical Medicine 9, 462.
[14] Wu, J., K. Leung, and G. Leung (2020). Nowcasting and forecasting the potential
domestic and international spread of the 2019-ncov outbreak originating in wuhan,
china: A modelling study. Lancet 395, 689–697.

12

Supplementary Material for “Predicting
Infection of COVID-19 in Japan: State Space
Modeling Approach”
We here provide details of the prior distributions and Markov Chain Monte Carlo
algorithm to generate posterior samples.

S1

Model

The state space SIR (SS-SIR) model consists of the following two equations:
Y (t)|I(t) ∼ Beta(λI(t), λ(1 − I(t))),
(S1)
θ(t)|θ(t − 1) ∼ Dir(κf (θ(t − 1); β, γ)),
for t = 1, . . . , T with T = 53 in our analysis, where θ(t) = (S(t), I(t), R(t)), β >
0 and γ > 0 are the unknown infection rate and removal rate, respectively, and
f (θ(t − 1); β, γ) is the solution of the deterministic SIR model starting at θ(t − 1):
S 0 (t) = −βS(t)I(t),

S2
S2.1

I 0 (t) = βS(t)I(t) − γI(t),

R0 (t) = γI(t).

Prior distributions
Precision parameters κ and λ

We set κ ∼ Ga(20, 0.0001) and λ ∼ Ga(2, 0.0001), independently.

S2.2

Initial state θ(0) = (S(0), I(0), R(0))

The joint prior is constructed via the following decomposition:

π(S(0), I(0), R(0)) = π(S(0))π(I(0))π(R(0)|S(0), I(0)).

The prior distributions of S(0) and I(0) are first determined and then the prior
distribution of R(0) is determined accordingly. We assume that 95% of population
1

is initially susceptible, S(0) ∼ δ(0.95), and I(0) follows a beta distribution. The
parameters of the beta distribution is set such that E[I(0)] = 1.5−4 for p = 0.05 and
E[I(0)] = 8.0 × 10−5 for p = 0.1 and 0.2, and Var(I0 ) = 1.0 × 10−8 for all the cases.
S2.3

Key parameters β and γ in the SIR model

The prior distributions of the two important parameters β and γ through the prior
distributions of ρ = γ/β, peak intensity (PI) and timing of the peak intensity (PT).
The prior distribution of ρ, reciprocal of the basic reproduction number, is firstly
derived. If ρ ∈ [0, S(0)], I(t) starts increasing, reaches its maximum and decreases to
∞

zero as t −→ so the model is designed as epidemic. Under the SIR model, PI can be
expressed as

PI ≡ g(S(0), I(0), ρ) = I(0) + S(0) − ρ(log(S(0)) + 1 − log(ρ)),

and it is known that the unique solution ρ = g −1 (PI, S(0), I(0)) exists. Then, the
prior distribution of ρ is determined by specifying the prior distribution of PI. We
assume PI ∼ TN(I(0),1) (0.03, 0.022 ), that is, the prior peak intensity is centered around
3% of the population. Similarly, the prior distribution of PT is given by PT ∼
TN(53,413) (180, 602 ), implying the prior timing of the epidemic peak is between April
22, 2020 and April 17, 2021, and is centered around August 27, 2020.
Next, the prior distribution of β is specified following the regression approach of
[12]. We first prepare the grids on the space of β, PI and I(0) as follow:
• β: equally spaced 40 points between 0.05 and 1.0,
• PI: points equally spaced between 0.01 and 0.1 by 0.01,
• I(0): equally spaced 20 points between 0.1 × Y (1) and 0.001.
The SIR curves are simulated for all the combinations of (β, PI, I(0)) and PT is identified. Then log(β) is regressed on a subset of a fourth degree polynomial interaction
model using log(PT), log I(0), and log(ρ) as covariates. Since our grid for β covers
much smaller values than [12], our regression model contains 28 covariates in total
2

including the constant and they are collectively denoted by X. The regression coefficients and error variance are denoted by τ̂ σ̂ 2 , respectively. Based on these estimates,
we set β ∼ δ(exp(X τ̂ + 0.5σ̂ 2 )). The list of the used covariates and estimate of the
polynomial regression are presented in Table 2. Also, σ̂ 2 = 6.92 × 10−8 and R2 is
almost equal to one.
Covariate
Intercept
PT
PT2
I(0)
I(0)2
ρ
ρ2
ρ3
ρ4
I(0) × ρ
I(0)2 × ρ
I(0) × ρ2
I(0)2 × ρ2
I(0) × ρ3

τ
τ1
τ2
τ3
τ4
τ5
τ6
τ7
τ8
τ9
τ10
τ11
τ12
τ13
τ14

Estimate
-2.45
-8.55×10−1
-6.20×10−2
-1.20
-5.14×10−2
-2.58×101
-8.23×101
-1.16×102
-6.19×101
-5.52
-1.76×10−1
-1.62×10
-5.23×10−1
-2.23×10

Std. Error
2.28×10−1
4.02×10−2
1.37×10−2
4.10×10−2
1.57×10−3
2.52
1.02×10
1.76×10
1.09×10
4.55×10−1
1.67×10−2
1.84
6.76×10−2
3.17

Covariate
I(0)2 × ρ3
I(0) × ρ4
I(0)2 × ρ4
PT × I(0)
PT × ρ
PT2 × I(0)
PT × I(0)2
PT2 × ρ
PT2 × ρ2
PT3
PT4
PT3 × I(0)
PT2 × I(0)2
I(0)3

τ
τ15
τ16
τ17
τ18
τ19
τ20
τ21
τ22
τ23
τ24
τ25
τ26
τ27
τ28

Estimate
-7.22×10−1
-1.16×10
-3.77×10−1
-1.78×10−2
2.98×10−2
2.51×10−3
-4.95×10−4
-2.16×10−3
1.13×10−3
1.01×10−2
-5.61×10−4
-9.43×10−5
4.93×10−5
-6.46×10−4

Std. Error
1.16×10−1
1.97
7.23×10−2
4.42×10−3
1.07×10−2
8.68×10−4
1.93×10−4
1.19×10−3
1.03×10−3
2.33×10−3
1.51×10−4
7.19×10−5
2.04×10−5
1.21×10−5

Table 2: Regression estimates for the prior distribution of β

S2.4

Prior predictive distribution

Under the prior distributions specified as above, we generated random samples from
the prior predictive distribution given by

π(Y1:T ) =

Z Z Y
T

[f (Y (t)|θ(t), φ)g(θ(t)|θ(t − 1), φ)] π(φ)dθ1:T dφ,

t=1

where Y1:T = (Y (1), . . . , Y (T )) and θ1:T = (θ(1), . . . , θ(T )). The prior predictive
distribution presented in Figure S1 shows that the observed data are included in the
prior prediction intervals indicating that our settings of the prior distributions are
reasonable.

3

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/06/01

20/09/01

20/12/01

21/03/01

median
95% interval

Proportion infected

Proportion infected

median
95% interval

p = 0.2

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/06/01

20/09/01

20/12/01

21/03/01

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

p = 0.1
0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

Proportion infected

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

p = 0.05

median
95% interval

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/06/01

20/09/01

20/12/01

21/03/01

Figure S1: Prior predictive distributions for p = 0.05 (left), 0.1 and 0.2 (right). The
observed data points {Y (t), t = 1, . . . , T } are plotted by the black dots.

S3

Posterior distribution and Markov Chain Monte Carlo sampling
algorithm

Let φ denote the collection of the unknown parameters, φ = (β, ρ, κ, λ, I(0)), and π(φ)
denote the joint prior distribution specified in Section S2. The posterior distribution
of the latent variables θ(t) and φ is given by

π(θ1:T , φ|Y1:T ) ∝

T
Y

[f (Y (t)|θ(t); φ)g(θ(t)|θ(t − 1); φ)] π(φ),

(S2)

t=1

where f (·) and g(·) are the conditional distribution of the first and second equations in
the model (S1), respectively. Since the posterior distribution (S2) has a complicated
form, the posterior inference is based on the Markov Chain Monte Carlo (MCMC)
sampling method. Specifically, we adopt the Metropolis-Hastings (MH) within Gibbs
sampling, in which the random numbers are alternately sampled from the full conditional distributions φ and θ1:T . Our MCMC algorithm repeats the following steps:
- Sample from θ(t)|θ(t + 1), θ(t − 1), φ, Y (t) for t = 1, . . . , T .
- Sample from I(0), PI, PT, κ|θ1:T , λ, Y1:T .
- Sample from λ|θ1:T , Y1:T .
In each step, the sampling is carried out by using the Gaussian random walk MH
algorithm where the step sizes are adjusted such that the acceptance rates are between

4

0.2 and 0.4. Note that given the sampled values of I(0), PI and PT, the values of
ρ, β and hence γ = βρ and R0 = 1/ρ are immediately determined through their
prior distributions. We run the algorithm for 50000 iterations after 10000 iterations
of initial burn-in period. Then every 10th draws (5000 draws) is retained to be used
in our analysis and the point estimates and 95% credible intervals are the sample
medians and 0.025th and 0.975th sample quantiles of the MCMC output.
0

To carry out future predictions for the periods t = T + 1, . . . , T , we generate
random numbers from the posterior predictive distribution given by
0

Z Z
π(YT +1:T 0 |Y1:T ) =

T
Y

[f (Y (t)|θ(t), φ)g(θ(t)|θ(t − 1), φ)] π(φ, θ1:T |Y1:T )dθ1:T 0 dφ.

t=T +1

Given the MCMC outputs and values of c, T ∗ and c∗ as specified in our prediction scenarios, the future prediction of the epidemic is carried out by repeating the following
0

steps for t = T + 1, . . . , T :
• If t ≤ T ∗ , sample from Dir(κf (θ(t − 1); cβ, γ), otherwise sample θ(t) from
Dir(κf (θ(t − 1); c∗ β, γ).
• sample Y (t) from Beta(λI(t), λ(1 − I(t)))
Our point prediction of the trajectory of the infectious proportion is obtained
from the sample medians of the simulated Y (t) computed at each t. Similarly, the
prediction interval is obtained from the 0.025th and 0.975th sample quantiles.

S4
S4.1

Additional results
MCMC and posterior distribution of I(t)

Figure S2 presents the trace plots of the MCMC output for p = 0.1. The figure shows
that our MCMC algorithm converges to the target distributions and mixes reasonably
well. Figure S3 presents the posterior distribution of I(t) for t = 1, . . . , 53. It is shown
that the observed data points are well within the 95% credible interval.

5

S4.2

Additional prediction results for p = 0.1

In Section 3 of the main text, we assessed the effect of an intervention based on
the future prediction under several scenarios. Here the additional results under a
longer intervention period with T ∗ = 75 are provided in Figure S4. The figure shows
that even if β returns to the original level the intervention (c∗ = 1), as long as the
intervention period is sufficiently long, even a somewhat mild but realistic degree of
intervention, such as c = 0.4, can lead to the termination of the epidemic.

S4.3

Prediction results for p = 0.05 and 0.2

Figure S5 and S6 present the prediction results for p = 0.05 and 0.2 under the same
scenarios in the main text for p = 0.1. While the predicted timings of the peak
and peak intensities vary depending on the choice of p, the figures provide the same
epidemiological insights as discussed in Section 4.
PI

0.00

0e+00

0.04

4e‑05

0.08

8e‑05

I(0)

1000

2000

3000

4000

5000

0

1000

2000

iteration

iteration

PT

λ

3000

4000

5000

3000

4000

5000

3000

4000

5000

3000

4000

5000

100

200

300

100000 200000 300000

0

1000

2000

3000

4000

5000

0

1000

2000

iteration

iteration

κ

β

0.1

0.3

0.5

150000 250000 350000

0.7

0

1000

2000

3000

4000

5000

0

1000

2000

iteration

iteration

γ

R0

0.1

1.2

1.4

0.3

1.6

0.5

1.8

0

0

1000

2000

3000

4000

5000

0

iteration

1000

2000
iteration

Figure S2: Trace plots of the MCMC output (p = 0.1).

6

1e‑03
6e‑04

●
●
●●
●
●
●
●
●
●

4e‑04

●
●
●
●
●
●
●
●●
●●
●●
●●
●●
●●●●●
●●●●●●●●
●●●●●●
●●●●●●●

0e+00

2e‑04

Proportion infected

8e‑04

median
95% interval

20/03/01

20/03/15

20/03/29

20/04/12

day

Figure S3: Posterior distribution and 95% credible interval of I(t) (p = 0.1). The
observed data points are shown by the black dots.

75

c* = 0.8, T* =

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/06/01

20/09/01
day

20/12/01

21/03/01

c = 0.6
c = 0.5
c = 0.4

75

c* = 0.8, T* =

c = 0.3
c = 0.2
c = 0.1
Proportion infected

0.3
0.2
0.1

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/06/01

20/09/01
day

20/12/01

21/03/01

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

c =
c =
c =

Proportion infected

0.6
0.5
0.4

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

Proportion infected

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

c* = 1, T* =
c =
c =
c =

c = 0.6
c = 0.5
c = 0.4

75

c = 0.3
c = 0.2
c = 0.1

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/06/01

20/09/01

20/12/01

21/03/01

day

Figure S4: Future prediction with T ∗ = 75 (75 days of intervention after April 22) for
c∗ = 1 (left), 0.9 (center) and 0.8 (right). The red, black and grey curves represent
the future point prediction without intervention shown in Figure 2 in the main text,
point prediction under each scenario and one-sided upper 95% prediction intervals,
respectively.

7

20/12/01

21/03/01

20/03/01

20/06/01

20/06/01

day

20/12/01

21/03/01

0.08
0.08
0.06

20/06/01

28

0.00
20/09/01
day

20/12/01

c = 0.6
c = 0.5
c = 0.4

0.08

0.06

20/06/01

20/12/01

c* = 0.8, T* =

c = 0.3
c = 0.2
c = 0.1

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/09/01

21/03/01

21/03/01

45

c = 0.3
c = 0.2
c = 0.1

0.06

0.6
0.5
0.4

45

c = 0.3
c = 0.2
c = 0.1

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

Proportion infected

0.08

c =
c =
c =

21/03/01

day

0.04

Proportion infected

0.00
20/09/01

21/03/01

0.02

0.08
0.06
0.04

20/06/01

20/12/01

c* = 0.8, T* =

0.02
0.00

Proportion infected

14

0.3
0.2
0.1

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/09/01

20/12/01

0.04
0.00

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/09/01

c* = 0.9, T* =
c = 0.6
c = 0.5
c = 0.4

day

c* = 0.8, T* =
c =
c =
c =

20/06/01

28

c = 0.3
c = 0.2
c = 0.1

0.06

21/03/01

day

c = 0.6
c = 0.5
c = 0.4

20/03/01

Proportion infected

0.08

20/12/01

0.6
0.5
0.4

0.04

Proportion infected

0.00
20/09/01

c =
c =
c =

0.02

0.08
0.06
0.04

20/06/01

21/03/01

day

c* = 0.9, T* =

0.02
0.00

Proportion infected

14

0.3
0.2
0.1

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/12/01

day

c* = 0.9, T* =
c =
c =
c =

20/09/01

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

0.02

day

c = 0.6
c = 0.5
c = 0.4

0.06
0.00

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

45

c = 0.3
c = 0.2
c = 0.1

0.04

20/09/01

Proportion infected

0.08
0.06
0.00

20/06/01

c = 0.6
c = 0.5
c = 0.4

0.02

20/03/01

c* = 1, T* =

0.04

0.06
0.04
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

28

c = 0.3
c = 0.2
c = 0.1

0.04

c* = 1, T* =
c = 0.6
c = 0.5
c = 0.4

0.02

14

0.3
0.2
0.1
Proportion infected

0.08

c =
c =
c =

0.02
0.00

Proportion infected

0.6
0.5
0.4

0.02

c* = 1, T* =
c =
c =
c =

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/06/01

20/09/01

20/12/01

21/03/01

day

Figure S5: Future prediction under the nine combinations T ∗ (the period of the
intervention) and c∗ (the multiplier for β after the intervention) for p = 0.05. The
upper, middle and lower panels correspond to c∗ = 1, 0.9 and 0.8, respectively. The
red, black and grey curves respectively represent the future point prediction without
intervention shown in Figure 2 of the main text, point prediction under each scenario
and one-sided upper 95% prediction intervals.

8

c* = 1, T* =

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/06/01

20/09/01

20/12/01

21/03/01

Proportion infected
20/06/01

20/09/01

20/12/01

21/03/01

c =
c =
c =

0.6
0.5
0.4

20/06/01

20/09/01
day

20/12/01

21/03/01

c =
c =
c =

0.6
0.5
0.4

21/03/01

20/06/01

c = 0.6
c = 0.5
c = 0.4

day

21/03/01

45

c = 0.3
c = 0.2
c = 0.1

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/06/01

28

20/09/01

20/12/01

c* = 0.8, T* =

c = 0.3
c = 0.2
c = 0.1

20/09/01

20/12/01

21/03/01

day

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/09/01

c* = 0.9, T* =

Proportion infected

Proportion infected
20/06/01

20/12/01

c* = 0.8, T* =
0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

Proportion infected

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

14

0.3
0.2
0.1

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

28

day

c* = 0.8, T* =
c =
c =
c =

20/06/01

day

c = 0.3
c = 0.2
c = 0.1

20/09/01

45

c = 0.3
c = 0.2
c = 0.1

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

day

c = 0.6
c = 0.5
c = 0.4

21/03/01

Proportion infected

Proportion infected
20/06/01

20/12/01

c* = 0.9, T* =
0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

Proportion infected

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

14

0.3
0.2
0.1

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/09/01

c = 0.6
c = 0.5
c = 0.4

day

c* = 0.9, T* =
c =
c =
c =

c* = 1, T* =

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

day

c = 0.6
c = 0.5
c = 0.4

28

c = 0.3
c = 0.2
c = 0.1

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

20/03/01

c = 0.6
c = 0.5
c = 0.4

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

14

0.3
0.2
0.1

20/12/01

21/03/01

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

c =
c =
c =

Proportion infected

0.6
0.5
0.4

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

Proportion infected

0.00 0.01 0.02 0.03 0.04 0.05 0.06 0.07

c* = 1, T* =
c =
c =
c =

c = 0.6
c = 0.5
c = 0.4

45

c = 0.3
c = 0.2
c = 0.1

●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●
●

20/03/01

20/06/01

20/09/01

20/12/01

21/03/01

day

Figure S6: Future prediction under the nine combinations T ∗ (the period of the
intervention) and c∗ (the multiplier for β after the intervention) for p = 0.2. The
upper, middle and lower panels correspond to c∗ = 1, 0.9 and 0.8, respectively. The
red, black and grey curves respectively represent the future point prediction without
intervention shown in Figure 2 of the main text, point prediction under each scenario
and one-sided upper 95% prediction intervals.

9

