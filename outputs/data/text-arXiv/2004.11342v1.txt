Estimating the number of infections and the impact of
non-pharmaceutical interventions on COVID-19 in European
countries: technical description update
Seth Flaxman∗ , Swapnil Mishra∗ , Axel Gandy∗ , H Juliette T Unwin, Helen Coupland,

arXiv:2004.11342v1 [stat.AP] 23 Apr 2020

Thomas A Mellan, Harrison Zhu, Tresnia Berah, Jeffrey W Eaton, Pablo N P Guzman, Nora
Schmit, Lucia Callizo, Imperial College COVID-19 Response Team, Charles Whittaker, Peter
Winskill, Xiaoyue Xi, Azra Ghani, Christl A. Donnelly, Steven Riley, Lucy C Okell, Michaela
A C Vollmer, Neil M. Ferguson and Samir Bhatt∗,1

Department of Infectious Disease Epidemiology, Imperial College London
Department of Mathematics, Imperial College London
WHO Collaborating Centre for Infectious Disease Modelling
MRC Centre for Global Infectious Disease Analytics
Abdul Latif Jameel Institute for Disease and Emergency Analytics, Imperial College London
Department of Statistics, University of Oxford
∗

Contributed equally. 1 Correspondence: s.bhatt@imperial.ac.uk

1

Brief Introduction
Following the emergence of a novel coronavirus (SARS-CoV-2) and its spread outside of China, Europe has
experienced large epidemics. In response, many European countries have implemented unprecedented nonpharmaceutical interventions including case isolation, the closure of schools and universities, banning of mass
gatherings and/or public events, and most recently, wide-scale social distancing including local and national
lockdowns.
In this technical update, we extend a semi-mechanistic Bayesian hierarchical model that infers the impact
of these interventions and estimates the number of infections over time. Our methods assume that changes
in the reproductive number – a measure of transmission - are an immediate response to these interventions
being implemented rather than broader gradual changes in behaviour. Our model estimates these changes
by calculating backwards from temporal data on observed to estimate the number of infections and rate of
transmission that occurred several weeks prior, allowing for a probabilistic time lag between infection and
death.
In this update we extend our original model [2] to include (a) population saturation effects, (b) prior uncertainty
on the infection fatality ratio, (c) a more balanced prior on intervention effects and (d) partial pooling of
the lockdown intervention covariate. We also (e) included another 3 countries (Greece, the Netherlands and
Portugal).
The model code is available at https://github.com/ImperialCollegeLondon/covid19model. We are now
reporting the results of our updated model online at https://mrc-ide.github.io/covid19estimates/. We
estimated parameters jointly for all M = 14 countries in a single hierarchical model. Inference is performed in
the probabilistic programming language Stan [1] using an adaptive Hamiltonian Monte Carlo (HMC) sampler.

1

Model description

We observe daily deaths Dt,m for days t ∈ {1, . . . , n} and countries m ∈ {1, . . . , M }. These daily deaths are
modelled using a positive real-valued function dt,m = E[Dt,m ] that represents the expected number of deaths
attributed to COVID-19. The daily deaths Dt,m are assumed to follow a negative binomial distribution with
mean dt,m and variance dt,m +

dt,m
φ ,

where φ follows a positive half normal distribution, i.e.

Dt,m

d2t,m
∼ Negative Binomial dt,m , dt,m +
ψ

!
,

ψ ∼ N + (0, 5).
Here, N (µ, σ) denotes a normal distribution with mean µ and standard deviation σ. We say that X follows a
positive half normal distribution N + (µ, σ) if X ∼ |Y |, where Y ∼ N (µ, σ).
The expected number of deaths d in a given country on a given day is a function of the number of infections c
occurring in previous days. Here infections are both symptomatic and asymptomatic.

2

At the beginning of the epidemic, deaths resulting from individuals infected abroad can bias estimates of the
starting reproduction number R0 . To ensure that we are modelling deaths resulting from locally acquired
infections we only include observed deaths from the day after a country has cumulatively observed 10 deaths in
our model. We tested the sensitivity of this parameter using Pareto smoothed importance sampling leave one
out validation (PSIS-LOO) [5] and found insignificant sensitivity around our choice.
To mechanistically link our function for deaths to our latent function for infected cases, we use a previously
estimated COVID-19 infection-fatality-ratio ifr (probability of death given infection) together with a distribution
of times from infection to death π. The ifr is derived from estimates presented in Verity et al [6] which assumed
homogeneous attack rates across age-groups. To better match estimates of attack rates by age generated using
more detailed information on country and age-specific mixing patterns, we scale these estimates (the unadjusted
ifr, referred to here as ifr0 ) in the following way as in previous work [3]. Let ca be the number of infections
generated in age-group a, let Na be the underlying size of the population in that age group and let ARa = ca /Na
be the age-group-specific attack rate. The adjusted ifr is then given by:
ifra =

AR50−59 0
ifra ,
ARa

where AR50−59 is the predicted attack-rate in the 50-59 year age-group after incorporating country-specific
patterns of contact and mixing. This age-group was chosen as the reference as it had the lowest predicted
level of underreporting in previous analyses of data from the Chinese epidemic[6]. We obtained countryspecific estimates of attack rate by age, ARa , for the M countries in our analysis from a previous study which
incorporates information on contact between individuals of different ages in countries across Europe[7]. We
then obtained overall ifr estimates for each country adjusting for both demography and age-specific attack
rates. Details of this calculation can be found in [6][7].
From the above, every country has a specific mean infection-fatality ratio ifrm . To incorporate the uncertainty
inherent in this estimate we allow the ifrm for every country to have some additional noise around the mean.
Specifically we assume
ifr∗m ∼ ifrm ·N (1, 0.1).
Using estimated epidemiological information from previous studies[6, 7], we assume the distribution of times from
infection to death π (infection-to-death) to be the sum of two independent random times: the incubation period
(infection to onset of symptoms or infection-to-onset) distribution and the time between onset of symptoms
and death (onset-to-death). The infection-to-onset distribution is Gamma distributed with mean 5.1 days and
coefficient of variation 0.86. The onset-to-death distribution is also Gamma distributed with a mean of 17.8
days and a coefficient of variation 0.45. The infection-to-death distribution is therefore given by:
π ∼ Gamma(5.1, 0.86) + Gamma(17.8, 0.45).

The expected number of deaths dt,m , on a given day t, for country, m, is given by the following discrete sum:
dt,m = ifr∗m

t−1
X

cτ,m πt−τ ,

τ =0

where cτ,m is the number of new infections on day τ in country m and where π is discretized via πs =
R 1.5
R s+0.5
π(τ )dτ for s = 2, 3, ..., and π1 = 0 π(τ )dτ , where π(τ ) is the density of π.
s−0.5
3

The number of deaths today is the sum of the past infections weighted by their probability of death, where the
probability of death depends on the number of days since infection and the country-specific infection-fatalityratio (with some noise).
The true number of infected individuals, c, is modelled using a discrete renewal process. This approach has been
used in numerous previous studies and has a strong theoretical basis in stochastic individual-based counting
processes such as Hawkes process, the Erland Susceptible-Exposed-Infected-Recovered model, and the BellmanHarris process. To model the number of infections over time, we need to specify a generation distribution g
with density g(τ ), (the time between when a person gets infected and when they subsequently infect another
other people). The generation distribution is unknown, but we can approximate it by assuming it is the same
as the serial interval distribution (time from onset to onset). We choose these to be Gamma distributed:
g ∼ Gamma(6.5, 0.62).
Given the generation distribution, the number of infections ct,m on a given day t, and country, m, is given by
the following discrete convolution function:
ct,m = St,m Rt,m
St,m = 1 −

t−1
X

cτ,m gt−τ

τ =0
Pt−1
i=1 ci,m

Nm

R s+0.5
where, similar to the probability of death function, the generation distribution is discretized by gs = s−0.5 g(τ )dτ
R 1.5
for s = 2, 3, ..., and g1 = 0 g(τ )dτ . The population of country m is denoted by Nm . We include the adjustment factor St,m = 1 −

Pt−1

ci,m
Nm

i=1

to account for the number of susceptible individuals left in the population:

i.e even in the absence of interventions, herd immunity will reduce the number of daily infected. This of course
assumes reinfection over the time horizon of our model is impossible. We note here that we could include
a factor in the serial interval accounting for individuals who die before they can infect others but given the
infection-to-death distribution this factor is negligible and we have chosen to exclude it.
Infections today depend on the number of infections in the previous days, weighted by the discretized generation
distribution. This weighting is then scaled by the country-specific time-varying reproduction number, Rt,m , that
models the average number of secondary infections at a given time. The functional form for the time-varying
reproduction number was chosen to be as simple as possible to minimize the impact of strong prior assumptions:
we use a piecewise constant function that scales Rt,m from a baseline prior R0,m and is driven by known major
non-pharmaceutical interventions occurring in different countries and times.
We included 6 interventions, one of which is constructed from the other 5 interventions, which are timings
of school and university closures (k = 1), self-isolating if ill (k = 2), banning of public events (k = 3), any
government intervention in place (k = 4), implementing a partial or complete lockdown (k = 5) and encouraging
social distancing and isolation (k = 6). We denote the indicator variable for intervention k ∈ {1, . . . , 6} by Ik,t,m ,
which is 1 if intervention k is in place in country m at time t and 0 otherwise. The covariate “any government
intervention” (k = 4) indicates if any of the other 5 interventions are in effect, i.e. I4,t,m equals 1 at time t if any
of the interventions k ∈ {1, 2, 3, 5, 6} are in effect in country m at time t and equals 0 otherwise. Covariate 4
has the interpretation of indicating the onset of major government intervention. The effect of each intervention
4

is assumed to be multiplicative. Rt,m is therefore a function of the intervention indicators Ik,t,m in place at
time t in country m:
Rt,m = R0,m e−

P6

k=1

αk Ik,t,m −βm I5,t,m

The exponential form was used to ensure positivity of the reproduction number, with R0,m constrained to be
positive as it appears outside the exponential. The impacts αk are shared between all M countries and therefore
they are informed by all available data. The intervention of a lockdown has another another country-specific, or
partial pooled, random effect given by βm . We justify the inclusion of this partially pooled effect as lockdown
is the only identifiable parameter in a full pooled model.
The prior distribution for R0,m was chosen to be
R0,m ∼ N + (3.28, |κ|) with κ ∼ N + (0, 0.5),
where κ is the same among all countries to share information about the variability of R0,m . The value of 3.28
was chosen based on a previous meta analysis looking at the basic reproductive number [4].
The prior on the total reduction through one intervention (i.e. exp(−αk )) which is not lockdown and on
P6
the reduction once all interventions in place, i.e. on exp(− k=1 αk ), is displayed in the top row of Figure 1.
Bottom row illustrates the prior on the effect of lockdown (i.e. exp (−αk − βm )) and full effect of all interventions
 P

6
together (exp − k=1 αk − βm bottom right). Details of the individual prior choices that result in this are
below.
The impact of an intervention on Rt,m is characterised by a set of parameters α1 , . . . , α6 , with independent
prior distributions chosen to be
log(1.05)
,
6
i.e. the prior on each effect is a Gamma distribution with shape parameter 1/6 and scale parameter 1, shifted
αk ∼ Gamma(1/6, 1) −

to allow for negative values. This prior was chosen such that the probability that any individual intervention
does not reduce Rt,m , i.e. P (αk < 0), is about 48% and such that the joint effect of α1 , . . . , αk on Rt,m once all
P6
interventions are in-place (i.e. the distribution of exp(− k=1 αk )) is a uniform distribution on [0, 1.05]. The
intuition behind this prior is that it encodes our null belief that interventions could equally increase or decrease
Rt , and the data should inform which.
The prior on the country-specific effects of lockdown β1 , . . . , βM is given by
β1 , . . . , βM ∼ N (0, γ) where γ ∼ N + (0, .2) .
We only included such a country-specific random effect for lockdown, as the lockdown effect is the strongest in
our analysis and as other interventions do not have identifiable effects.
We assume that seeding of new infections begins 30 days before the day after a country has cumulatively
observed 10 deaths. From this date, we seed our model with 6 sequential days of an equal number of infections:
c1,m = · · · = c6,m ∼ Exponential( τ1 ), where τ ∼ Exponential(0.03). These seed infections are inferred in our
Bayesian posterior distribution.
We estimated parameters jointly for all countries in a single hierarchical model. Fitting was done in the
probabilistic programming language Stan[1] using an adaptive Hamiltonian Monte Carlo (HMC) sampler.
5

1.0
F(x)

0.0

0.2

0.4

0.6

0.8

1.0
0.8
0.6

F(x)

0.4
0.2
0.0
0.0

0.5

1.0

1.5

0.0

0.5

1.5

1.0

1.5

1.0
0.8
0.6

F(x)

0.0

0.2

0.4

0.8
0.6
0.4
0.0

0.2

F(x)

1.0
x

1.0

x

0.0

0.5

1.0

1.5

x

0.0

0.5
x

Figure 1: Cumulative distribution function of prior on total reduction through one intervention through the
fixed effect (exp (−αk ), top left), on the lockdown intervention (exp (−αk − βm ), bottom left) fixed effect

 P
6
through all interventions together (exp − k=1 αk , top right) and full effect of all interventions together
 P

6
(exp − k=1 αk − βm bottom right).

6

References
[1]

B. Carpenter et al. “Stan: A probabilistic programming language”. In: Journal of statistical software 76.1
(2017).

[2] Estimating the number of infections and the impact of non-pharmaceutical interventions on COVID-19 in
11 European countries. 2020. doi: doi:10.25561/77731.
[3]

N. Ferguson et al. Impact of non-pharmaceutical interventions (NPIs) to reduce COVID-19 mortality and
healthcare demand (Report 9). Tech. rep. url: https://www.imperial.ac.uk/mrc-global-infectiousdisease-analysis/news--wuhan-coronavirus/ (visited on 03/25/2020).

[4]

Y. Liu et al. “The reproductive number of COVID-19 is higher compared to SARS coronavirus”. In:
Journal of Travel Medicine 27.2 (Feb. 2020). taaa021. issn: 1195-1982. doi: 10 . 1093 / jtm / taaa021.
eprint: https://academic.oup.com/jtm/article- pdf/27/2/taaa021/32902430/taaa021.pdf. url:
https://doi.org/10.1093/jtm/taaa021.

[5]

A. Vehtari, A. Gelman, and J. Gabry. “Practical Bayesian model evaluation using leave-one-out crossvalidation and WAIC”. In: Statistics and computing 27.5 (2017), pp. 1413–1432.

[6]

R. Verity et al. “Estimates of the severity of COVID-19 disease”. In: Lancet Infect Dis in press (2020). doi:
https://doi.org/10.1101/2020.03.09.20033357.

[7]

P. G. T. Walker et al. Report 12: The Global Impact of COVID-19 and Strategies for Mitigation and
Suppression. url: https://www.imperial.ac.uk/mrc-global-infectious-disease-analysis/news-wuhan-coronavirus/.

7

