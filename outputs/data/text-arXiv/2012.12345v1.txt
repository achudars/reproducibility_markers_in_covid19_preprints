COVID-19 and other viruses: holding back its expansion by
massive testing
José Luis Sainz-Pardo1 , José Valero2
Centro de Investigación Operativa, Universidad Miguel Hernández de Elche,

arXiv:2012.12345v1 [stat.AP] 22 Dec 2020

Avda. Universidad s/n, 03202, Elche (Alicante), Spain
1

jose.sainz-pardo@umh.es, 2 jvalero@umh.es

Abstract
The experience of Singapur and South Korea makes it clear that under certain circumstances massive
testing is an effective way for containing the advance of the COVID-19.
In this paper, we propose a modified SEIR model which takes into account tracing and massive
testing, proving theoretically that more tracing and testing implies a reduction of the total number of
infected people in the long run. We apply this model to the spread of the first wave of the disease in
Spain, obtaining numerical results.
After that, we introduce a heuristic approach in order to minimize the COVID-19 spreading by
planning effective test distributions among the populations of a region over a period of time. As an
application, the impact of distributing tests among the counties of New York according to this method
is computed in terms of the number of saved infected individuals.

AMS Subject Classification (2010): 90-08, 34D05, 92D30
Keywords: COVID-19, coronavirus disease, optimal testing, SIR model, SEIR model, epidemic

1

Introduction

The emergence of the coronavirus disease 2019 (COVID-19) and its mutations motivated actions on the
inhabitants of several countries like isolation, social distance and others. The purpose of these restrictions
is to slow down the spread of the pandemic in order not to collapse health systems. Carrying out massive
testing is a complementary way to control the pandemic. Throughout this article we will analyse the impact
of testing on the number of infections and we will explain how we have developed an expert system to obtain
test distributions which minimize the number of infections within a region and for a temporal horizon.
The classical SIR model and its variations are a powerful mathematical tool for predicting the evolution
of epidemics around the world. The amount of literature studying the properties of solutions of such models
is huge, see e.g. Brauer and Castillo-Chávez [2012], Jiao et al. [2020], Ji and Jiang [2017], Kuniya and
Nakata [2012], Li and Muldowney [1995], Zhang and Teng [2007], Zhao et al. [2017] and the references
therein among many others. In the present, much effort is taken in order to estimate the evolution of the
COVID-19 pandemic, see e.g. Annas et al. [2020], Arcede et al. [2020], Britton et al. [2005], Chen et al.
[2020b], Chen et al. [2020a], Gomes et al. [2020], Ndaı̈rou et al. [2020], Roda et al. [2020], Sauter and Pacheco
[2020], Xu et al. [2020].
The coefficients of the models are constants in the simplest situation. However, it is more realistic in
order to estimate the evolution of an epidemic to consider them as functions of time, as given in some of
the above references. Moreover, when we need to take into account the impact of governmental actions like
confinements, quarantines, restrictions on mobility and travelling and so on, the coefficients, especially the
rate of transmission, can change abruptly. Thus, it is better to define them piecewise by choosing appropriate
time intervals depending on the moments in which the governmental restrictions are more severe or, on the
contrary, become more relaxed. This approach has been considered in several papers estimating the evolution
of the COVID-19 pandemic in several countries, see Kwuimy et al. [2020], Falco et al. [2020], Lin et al. [2020],
1

Mushayabasa et al. [2020], Niazi et al. [2020], Tang et al. [2020a]. Also, the parameters can depend on time
due to seasonality He et al. [2020].
Apart from tough measures leading to a lockdown, tracing, massive testing and isolation are very effective
tools which help to contain the spread of the illness even without restrictive social distancing, as we can
see in the examples of Singapur, South Korea and some Italian towns Romagnani et al. [2020]. The main
drawback of massive testing is the economic burden. However, as pointed out in Eichenbaum et al. [2020]
in the long run it pays off, as these policies can dramatically reduce the economic costs of the epidemic.
Thus, it is quite interesting to modify the SIR or SEIR model in order to measure their influence in the
evolution of the pandemic and also to determine the best way to carry out massive testing. In Berger et al.
[2020] the SEIR model is modified by taking into account testing and quarantine measures. It is shown that
increasing testing the governments could relax the quarantine conditions (implementing a targeted and more
efficient quarantine), so that the economic and social costs would be smaller while maintaining constant the
human costs. In Wang [2020] the author makes a qualitative analysis of a SIR model in which the infected
individuals are divided into two groups: those undetected and those detected by means of some tests, which
have a lower rate of transmission of the disease due to quarantine measures. It is shown that testing reduces
the number of infections in the long term, avoiding in this way herd immunity. In Niazi et al. [2020] a model
taking into account random massive tests is given. The impact of testing is analysed, obtaining the optimal
values for the number of tests to be carried out each day in two possible testing policies to control the
epidemic. In these papers, detection by tracing and random testing are put together. In Tang et al. [2020b]
a model in which contact tracing and quarantine are considered is used in order to estimate the evolution of
the epidemic in Wuhan. In Ubaru et al. [2020] the problem of optimal testing for individuals under limited
testing and tracing resources is studied by using a dynamic-graph based SEIR epidemiological model.
In this paper we modify the SEIR model in such a way that the impact of tracing and random testing
can be measured separately. For this aim we assume that infected people which are detected are posed in
quarantine and then they cannot infect other people any more; hence, only undetected infected individuals
are able to spread the epidemic. In our model we differentiate two kind of detected infected individuals:
people which are detected because either they are symptomatic or are direct contacts of infected individuals
(and then detected by tracing) and people which are detected by means of massive random testing. These
two methods of detection are complementary, as by tracing one detects people with symptoms and their
contacts, whereas by testing one detects asymptomatic individuals that otherwise would remain undetected
and would continue infecting other susceptible individuals.
In Section 3, we make a qualitative analysis of the model in the case where the coefficients are constants.
We show first that, as in the standard SEIR model, all the solutions converge as times increases to a fixed
point. The number of susceptible individuals in the long term determines the size of the epidemic. We prove
that the limit number of susceptible individuals is an increasing function of the parameters of tracing and
testing. That is, the more tracing and testing, the less number of infected people in the long term.
In Section 4, we estimate first the parameters of the model during the first wave of the COVID-19
epidemic in Spain if no massive testing is used. We consider the case where the parameters are functions
of time and are defined piecewise by taking into account the moments where confinement restrictions were
established or relaxed in Spain between March and June of 2020. After that we study the evolution of
the epidemic when a constant number of tests is carried out each day, calculating the number of infected
individuals which are saved in the long term for several values for the parameters which characterize tracing
and testing.
However, a constant distribution of tests per day is far to be optimal. Moreover, it could be better to
distribute the tests among different populations in a non-proportional way. Thus, the main purpose of this
work is to develop an expert system that provides an effective distribution of tests among the populations
of a region over a period of time. So, in Section 5 a heuristic method based on the proposed modified SEIR
model is introduced in order to optimize the distribution of tests. In this section it is also explained how to
estimate the parameters of the model by using the Differential Evolution technique. This technic was firstly
introduced in Storn [1996] as an evolutionary method for optimizing nonlinear functions. Also, it has been
employed for estimating parameters of infectious diseases models such as SIR, SIS, SEIR, SEIS and others
Kotyrba et al. [2015]. For example, it has been applied to estimate the SIR parameters of the COVID-19
pandemic in Italy Iorio and Li [2020]. Several improvements, versions and applications of this technique like
Yi et al. [2016], Wang et al. [2015] or the version employed in Iorio and Li [2006], which will be the one used

2

in this paper, can be found in the literature.
Finally, in Section 6 we study the effectiveness of the proposed heuristic approach by an extensive
computational analysis of the spread of the COVID-19 pandemic in the New York counties during the months
of April, May and June of 2020. The results of our distribution are also compared with a distribution which
is homogeneous in time and proportional to the size of each population.

2

The model

The classical SEIR model is the following

β
dS

= − SI,



dt
N



 dE = β SI − σE,
dt
N
dI


= σE − γI,


 dt


dR

= γI,
dt

(1)

where N is the size of the population, S (t) is the number of the susceptible individuals to the disease, E(t)
is the number of exposed people assuming that in the incubation period they do not infect anyone, I (t)
is the number of currently infected individuals which are able to infect other people, R(t) is the number
of individuals that have been infected and then removed from the possibility of being infected again or of
spreading infection (which includes dead, recovered people and those in quarantine or with immunity to
the disease). The constant β is the the average number of contacts per person per time, γ is the rate of
removal (1/γ is the average time after which an infected individual is removed), and 1/σ is the average time
of incubation of the disease. All these parameters are non-negative.
For our purposes we need to modify system (1) in several ways.
First, in a real situation the coefficients of the model are not constants but functions of time. Moreover,
these functions should not be continuous in general, because in an epidemic outburst the governments impose
restrictive measures to the population leading to a sudden change of the rate of transmission.
Second, as our intention is to analyse the efficiency of a testing method, the variable I (t) will consist
of all currently infected individuals (not only of those able to infect) and a new variable D (t), the number
of currently infected people which are detected, will be introduced. We will assume the ideal situation in
which any detected individual is placed in quarantine, so this person is not able to infect anyone from that
moment. Thus, the number of people with the capacity to infect others is I (t) − D (t) . Also, we do not take
into account that there could be people which are immune, so the variable R (t) will contain only dead and
recovered individuals but neither those in quarantine nor immune ones.
Third, we aim to estimate dead and recovered people among the detected ones separately, so R (t) is split
into three variables:
• F1 (t): number of dead individuals among the detected ones;
• R1 (t): number of recovered individuals among the detected ones;
• L (t) : number of removed individuals among the undetected ones.
As a first step, we consider the situation where mainly people with symptoms and their direct contacts
are detected, but there is no a plan for massive testing. The rate of detection is given by the variable ρ (t)
(0 < ρ (t) < 1) and, therefore, D (t) = ρ(t)I(t).

3

With these new variables at hand system (1) becomes:
dS
dt
dE
dt
dI
dt
dF1
dt
dR1
dt
dL
dt

β (t)
S (t) (1 − ρ (t))I (t) ,
N
β (t)
=
S (t) (1 − ρ (t))I (t) − σE (t) ,
N
=−

= σE(t) − ρ (t) (γ1 (t) + γ2 (t) + (1 − ρ (t))γ (t)) I (t) ,
= γ1 (t)ρ (t) I(t),
= γ2 (t) ρ (t) I(t),
= γ(t)(1 − ρ (t))I(t),

(2)

and the currently detected individuals are given by
D(t) = ρ (t) I (t) .

(3)

Here, γ1 (t) is the rate of mortality of detected people at moment t, γ2 (t) stands for the rate of recovery of
detected people at moment t, whereas γ (t) is the rate of removal among those undetected.
In a second step, we describe the situation where a massive testing is planned in order to increase the
number of detected people, which can be placed then in quarantine. For this aim we define the new variable
T (t), which stand for the number of people that have been detected at time t by the test programme among
those currently infected I (t).
Hence, system (2) becomes:
dS
dt
dE
dt
dI
dt
dT
dt
dF1
dt
dR1
dt
dL
dt

β (t)
S (t) ((1 − ρ (t))I (t) − T (t)) ,
N
β (t)
=
S (t) ((1 − ρ (t))I (t) − T (t)) − σE (t) ,
N
=−

= σE(t) − ρ (t) (γ1 (t) + γ2 (t) + (1 − ρ (t))γ (t)) I (t) ,
= ∆(t) − (e
γ1 (t) + γ
e2 (t)) T (t),
= γ1 (t)ρ (t) I(t) + γ
e1 (t)T (t),
= γ2 (t) ρ (t) I(t) + γ
e2 (t)T (t),
= γ(t)(1 − ρ (t))I(t) − (e
γ1 (t) + γ
e2 (t))T (t),

(4)

where ∆ (t) is the number of detected people by testing at day t and γ
e1 (t) (e
γ2 (t)) is the rate of death
(recovery) among those detected by testing. The currently detected people are now calculated by
D(t) = ρ (t) I (t) + T (t) .

(5)

Assuming that the individuals for the testing are chosen randomly, the variable ∆(t) is approximated by
∆(t) ' α(t)

(1 − ρ(t))I(t) − T (t)
,
N − R1 (t) − F1 (t) − ρ(t)I(t) − T (t)

with α(t) ≥ 0 being the number of tests performed at day t. This formula can be simplified if we assume
that N >> R1 (t) + F1 (t) + ρI(t) + T (t), which is true in big populations. Hence,
∆(t) ' α(t)

(1 − ρ(t))I(t) − T (t)
.
N
4

(6)

For simplicity we could assume that the rates of death and recovery are the same among the detected
e1 (t) = γ1 (t) , γ
e2 (t) = γ2 (t).
and the undetected infected people. In such a case, γ(t) = γ1 (t) + γ2 (t), and γ
Thus, model (4) would be the following:
dS
dt
dE
dt
dI
dt
dT
dt
dF1
dt
dR1
dt
dL
dt

3

β (t)
S (t) ((1 − ρ (t))I (t) − T (t)) ,
N
β (t)
=
S (t) ((1 − ρ (t))I (t) − T (t)) − σE (t) ,
N
=−

= σE(t) − (γ1 (t) + γ2 (t)) I (t) ,
= ∆(t) − (γ1 (t) + γ2 (t)) T (t),
= γ1 (t) (ρ (t) I(t) + T (t)) ,
= γ2 (t) (ρ (t) I(t) + T (t)) ,
= (γ1 (t) + γ2 (t)) ((1 − ρ (t))I(t) − T (t)) .

(7)

Qualitative analysis in the case of constant coefficients

Our first aim is to prove theoretically that massive testing helps reducing the number of infected people in
the long-term.
The qualitative behaviour of the solutions of system (1) is simple and well known Brauer and CastilloChávez [2012]. There exists an interval of fixed points given by
(S∞ , E∞ , I∞ , R∞ ) = (S∞ , 0, 0, N − S∞ ) , S∞ ∈ [0, N ],
and any solution with non-negative initial condition (S0 , E0 , I0 , R0 ) satisfying that N = S0 + E0 + I0 + R0
converges to one of this fixed points as the time t tends to +∞. Supposing that R0 = 0, the limit point is
determined by the initial value of the susceptible S and is given by the equation


S∞
β
S0
1−
.
(8)
=
log
S∞
γ
N
We consider system (7) in the following particular situation:
• The coefficients β, ρ, σ, γ1 , γ2 , γ
e1 , γ
e2 , γ are constant.
• The rates of death and recovery are the same among the detected and the undetected infected people,
so γ = γ = γ1 + γ2 , γ
e1 = γ1 , γ
e2 = γ2 .
• The number of tests which are carried out per day α is constant and positive and the approximation
(6) is valid.
With such assumptions and putting together the variables F1 , R1 , L system (7) reads as
dS
dt
dE
dt
dI
dt
dT
dt
dR
dt

=−
=

β
S((1 − ρ)I − T ),
N

β
S((1 − ρ)I − T ) − σE,
N

= σE − γI,
=α

(1 − ρ) I − T
− γT,
N

= γI.

(9)

5

What we want to show is that the solutions of system (9) behave in the same way as those of system
(1) and that the limit value S∞ is increasing with respect to the parameters α and ρ, showing in this way
theoretically that more detection implies a lower number of infected people in the long-term.
The initial condition has to satisfy that S0 + E0 + I0 + R0 = N and the variable W = S + E + I + R
remains equal to N for every time t ≥ 0. It is straightforward to see that the unique fixed points of this
system are:
(S∞ , E∞ , I∞ , T∞ , R∞ ) = (S∞ , 0, 0, 0, N − S∞ ) , S∞ ∈ [0, N ].
We observe also that the initial condition has to be non-negative. This implies that the solution is
non-negative for every forward moment of time if, moreover, (1 − ρ) I0 − T0 ≥ 0.
Lemma 1 If S0 , E0 , I0 , T0 , R0 ≥ 0 and (1 − ρ) I0 − T0 ≥ 0, then S (t) , E (t) , I (t) , T (t) , R (t) , y (t) =
(1 − ρ) I (t) − T (t) ≥ 0 for all t ≥ 0. Also, S (t) > 0, for t ≥ 0, if S0 > 0, whereas S (t) ≡ 0 if S0 = 0.
Moreover, if the solution is not a fixed point, then I (t) , T (t) , R (t) > 0 for all t > 0, and the following
statements hold true:
1. If either E0 > 0 or E0 = 0, S0 > 0 and y0 := (1 − ρ) I0 − T0 > 0, then E (t) , y (t) > 0 for all t > 0.
2. If E0 = 0, S0 = 0 and y0 > 0, then E (t) = 0, y (t) > 0 for all t > 0.
3. If E0 = 0 and y0 = 0, then E (t) ≡ y (t) ≡ 0.
Proof. It is easy to see from the first equation that S (t) ≥ 0 for all t ≥ 0. Moreover, S (t) > 0, for all t ≥ 0,
when S0 > 0 and S (t) ≡ 0 if S0 = 0.
If E0 = I0 = 0, we have a fixed point. Thus, either I0 > 0 or E0 > 0.
Let E0 > 0. If E (t) > 0 for all t ≥ 0, then it follows from the third and fourth equations in (9) that
I(t) = I0 e−γt + σ

Z

t

e−γ(t−r) E (r) dr > 0,

(10)

0

T (t) = T0 e−( N +γ )t +
α

α (1 − ρ)
N

Z

t

e−( N +γ )(t−r) I (r) dr > 0,
α

(11)

0

for all t > 0, and the function y (t) = (1 − ρ) I (t) − T (t) satisfies

dy  α
+
+ γ y = (1 − ρ) σE,
dt
N
so that

t

Z

y (t) = y (0) e−( N +γ )t +
α

e−( N +γ )(t−r) (1 − ρ) σE (r) dr > 0, ∀t > 0.
α

(12)

(13)

0

From the last equation in (9) we infer that R (t) > 0, for every t > 0, as well.
Next, we prove that the function E (t) cannot vanish at any point if E0 > 0. Assume on the contrary
the existence of a first moment of time t0 > 0 such that E (t0 ) = 0, so that E (t) > 0 for all t ∈ [0, t0 ). By
the equality in (13) we conclude that y (t) > 0 for t ∈ [0, t0 ]. Hence, from the second equation in (9) we get
E (t0 ) = E0 e−σt0 +

β
N

t0

Z

e−σ(t0 −r) S (r) ((1 − ρ)I (r) − T (r))dr > 0,

(14)

0

which is a contradiction.
Let now I0 > 0 and E0 = 0. Here we have to study three cases: 1) y0 > 0, S0 > 0; 2) y0 > 0, S0 = 0; 3)
y0 = 0.
Let y0 > 0, S0 > 0. By continuity there is ε0 > 0 such that I (t) , y (t) > 0 for t ∈ [0, ε0 ]. Making use of
(11) we obtain that T (t) > 0 for all t ∈ (0, ε0 ] as well. From the second equation in (9) we have
E (t) = E0 e−σt +

β
N

Z

t

e−σ(t−r) S (r) y (r) dr > 0, for all t ∈ (0, ε0 ],

0

6

as S (t) > 0 for every t ≥ 0. Thus, taking any 0 < ε ≤ ε0 we infer arguing as before but in the interval [ε, t]
that E (t) > 0, for all t ≥ ε, and that I (t) , y (t) , T (t) , R(t) > 0, for all t ≥ ε, as well. Since ε is arbitrarily
small, E (t) , I (t) , y (t) , T (t) , R (t) > 0, for all t > 0.
Let y0 > 0, S0 = 0. In this case, the first two equations in (9) imply that S (t) = E (t) = 0 for all t ≥ 0.
Then from the third equation in (9) and (12) we obtain that I (t) , y (t) > 0 for every t ≥ 0. Finally, by (11)
and using the last equation in (9) the inequalities T (t) , R (t) > 0, for all t > 0, hold true.
Let y0 = 0. The fact that (E (t) , y (t)) ≡ (0, 0) is the unique solution of the problem

β
dE


= S(t)y − σE,


dt N 
dy
α
=
−
+ γ y + (1 − ρ) σE,


dt
N


E (0) = y (0) = 0,
implies that y (t) ≡ 0 and E (t) ≡ 0. Then from the last three equations in (9) and T0 = (1 − ρ) I0 > 0 we
conclude that I (t) , R (t) , T (t) > 0 for t > 0.
Theorem 2 Let S0 , E0 , I0 , T0 , R0 ≥ 0 and (1 − ρ) I0 − T0 ≥ 0. Then every solution converges as t → +∞
to one fixed point. Moreover, S∞ is determined uniquely by S0 , R0 and T0 as the solution of the following
equation:
β(1 − ρ)
β(1 − ρ)
β
S∞ − log S∞ =
(N − R0 ) − T0
− log S0 .
(15)
α + γN
α + γN
α + γN
Remark 3 If the particular case where α = ρ = R0 = T0 = 0, we obtain (8).
Proof. We divide the proof into several steps.
First, we state that I (t) → 0, T (t) → 0 as t → +∞.
Summing up the first three equations we have
d
(S + E + I) = −γI.
dt

(16)

Then W (t) = S (t) + E (t) + I (t) is a non-negative smooth non-increasing function, so it has a limit as
t → +∞. Also, as
W 00 (t) = −γI 0 (t) = −γ (σE (t) − γI (t)) ≥ −γσN = −K, K ≥ 0,
the derivative of W tends to zero. Indeed, by contradiction assume that there is ν > 0 and a sequence
tn → +∞ such that W 0 (tn ) ≤ −2ν. For t ≤ tn it is clear that

W 0 (t) − W 0 (tn ) = W 00 e
t (t − tn ) ≤ −K (t − tn ) .
Hence,
W 0 (t) ≤ −2ν + K (tn − t) ,
ν
so W 0 (t) ≤ −ν if t ∈ Jn = [tn − K
, tn ]. The sequence {tn } can be chosen in such a way that the intervals
2
Jn are disjoint. In each of them the function W (t) decreases at least in the quantity νK and outside them
the function does not increase anywhere. Therefore,

W (tn ) ≤ W (0) − n

ν2
for any n.
K

For n great enough the function becomes negative, which is not possible. Thus, (16) implies that I (t) → 0
as t → +∞.
As by Lemma 1 we know that 0 ≤ T (t) ≤ (1 − ρ) I (t), it follows that T (t) → 0 as t → +∞.
Second, we establish that E (t) → 0 as t → +∞.

7

We know that W (t) = S (t) + E (t) + I (t) → η, I (t) → 0 as t → +∞. Also, as S (t) is non-increasing and
bounded from below, S (t) converges to some S∞ . Hence, E (t) → η − S∞ . We will prove that η − S∞ = 0.
If not, there would exists t0 > 0 such that
E (t) ≥

η − S∞
> 0 for all t ≥ t0 .
2

From the second equation in (9) and T (t) ≥ 0, I (t) → 0 we infer the existence of t1 ≥ t0 for which
η − S∞
dE
≤ −σ
for t ≥ t1 .
dt
4
Thus,
E (t) ≤ E (t1 ) − σ

η − S∞
(t − t1 ) → −∞,
4

which is not possible because E (t) ≥ 0.
The fact that every solution converges to a fixed point has been established.
Finally, let us prove (15). From (16) and the above convergences we have

Z ∞
Z ∞
dE
dI
dS
+
+
dt = −γ
I (t) dt
dt
dt
dt
0
0
= S∞ − (S0 + E0 + I0 ) = S∞ − N + R0 .
Integrating the fourth and first equations in (9) and putting all together we obtain
Z ∞
Z
α
Z ∞
dT
α (1 − ρ) ∞
dt = −T0 =
I (t) dt −
+γ
T (t) dt,
dt
N
N
0
0
0
log S∞ − log S0
Z
Z
β (1 − ρ) ∞
β ∞
=−
I (t) dt +
T (t) dt
N
N 0
0
Z
Z ∞
βα (1 − ρ)
β
β (1 − ρ) ∞
I (t) dt +
I (t) dt + T0
=−
N
N (α + γN ) 0
α + γN
0



β (1 − ρ)
α
S∞ − N + R0
β
=−
1−
+ T0
N
α + γN
−γ
α + γN
β (1 − ρ)
β
=−
(N − S∞ − R0 ) + T0
,
α + γN
α + γN
giving rise to relation (15).
We aim now to analyse expression (15) in order to show that S∞ is an increasing function of α and ρ.
We denote S∞ (α) the value of S∞ for α assuming the rest of the parameters being constant. In the same
way we define the function S∞ (ρ) .
Theorem 4 We assume the conditions of Theorem 2 and that S0 > 0 and either E0 > 0 or y0 > 0. Then
S∞ (α1 ) > S∞ (α2 ) , if α1 > α2 , and S∞ (ρ1 ) > S∞ (ρ2 ) , if ρ1 > ρ2 .
Proof. We write (15) in the form
(α + γN ) log

S∞
+ β (1 − ρ) (N − R0 − S∞ ) − T0 β = 0.
S0

We observe that Lemma 1 implies that y (t) > 0, for t > 0, so from the first equation in (9) we obtain that
S (t) is strictly decreasing and then S∞ < S0 . Analysing the function
f (x) = (α + γN ) log

x
+ β (1 − ρ) (N − R0 − x) − T0 β
S0

we deduce that:
8

• f (S0 ) = β (1 − ρ) (N − R0 − S0 ) − T0 β = β ((1 − ρ) (I0 + E0 ) − T0 ) ≥ 0.
• f has a maximum at x0 =

α + γN
, f (x0 ) ≥ 0.
β (1 − ρ)

• f is increasing if 0 < x < x0 and f (x) → −∞ as x → 0+ .
• f is decreasing if x > x0 and f (x) → −∞ as x → +∞.
We state that f (x0 ) > 0. Indeed, if f (x0 ) = 0, then x0 = S0 and this is moreover the only point where
the function vanishes. Then S0 = S∞ , which is impossible because S (t) is a strictly decreasing function.
Therefore, the above properties imply that the equation f (x) = 0 has exactly two solutions: 0 < x1 <
x0 , x2 > x0 . It follows from S∞ < S0 and S0 ∈ (x1 , x2 ] that S∞ = x1 .
Denote by g α (x) the function f (x) for the value α. It is easy to see that
g α1 (x) < g α2 (x) for any x < S0 if α1 > α2 ,
assuming that the other parameters are constant. From here we conclude that S∞ (α1 ) > S∞ (α2 ) if α1 > α2 .
In the same way, considering the functions hρ (x) we obtain that
hρ1 (x) < hρ2 (x) for any x ∈ (0, N − R0 ] if ρ1 > ρ2 ,
while the other parameters remain constant. Hence, S∞ (ρ1 ) > S∞ (ρ2 ) if ρ1 > ρ2 .
In the epidemic models a crucial parameter is the basic reproduction number, which is the expected
number of secondary cases produced, in a completely susceptible population, by a typical infective individual
over the course of its infection period.
The variables S and R are disease free, whereas E, I and T are the infective variables. We consider
the equilibrium (N, 0, 0, 0, 0) and the linearization around it of the subsystem of (9) corresponding to the
infective variables, which is given by


−σ β (1 − ρ)
−β
dx 
 x = Jx.
σ
−γ
0
=
(17)
dt
1−ρ
α
0
α N
−N − γ
Following van den Driessche and Watmough [2002] we calculate the reproduction number R0 by splitting
the matrix J into the rest of the Jacobian matrix associated to the rate of new infections F and the one
associated to the net rate out of the compartments V :
 


0 β (1 − ρ) −β
σ 0 0
0
0  −  −σ γ 0  .
J =F −V = 0
1−ρ
α
0 0 γ
−N
0
α N
The basic reproduction number is equal to the spectral radius of the matrix F V −1 when this matrix is
non-negative. As the eigenvalues of the matrix


β (1−ρ)
β (1−ρ)
− βγ
γ
γ


F V −1 = 
0
0
0 
α
α 1−ρ
α 1−ρ
− γN
γN
γN
are λ1 = 0 and λ2 =

1
γ

β (1 − ρ) −

α
N



, we obtain that
R0 =

1
α
β (1 − ρ) −
γ
N

provided that this quantity is non-negative, which is the usual situation as α/N is small in great populations.

9

We can easily see that the zero solution of system (17) is asymptotically stable if and only if R0 < 1.
Indeed, the characteristic equation for the eigenvalues of the matrix J is the following:
λ3 + a2 λ2 + a1 λ + a0 = 0,
where
α
a2 = σ + 2γ + ,
N
α

a1 = (σ + γ)
+ γ + σγ,
α N

a0 = σγ
+ γ − β (1 − ρ) .
N
According to the Routh-Hurwitz stability criterion, all the eigenvalues have negative real part if and only if
a2 , a0 > 0 and a2 a1 − a0 > 0. It is clear that
a2 > 0,
α


α
(σ + γ)
+ γ + σγβ (1 − ρ) > 0,
a2 a1 − a0 = σγ (γ + σ) + σ + 2γ +
N
N
a0 = σγ 2 (1 − R0 ) .
Thus, the result follows.
When the number of susceptible individuals is less than N , we replace R0 by the effective reproduction
number at time t, given by


α
1 S (t)
β (1 − ρ) −
Rt =
.
γ
N
N
Finally, we observe that R0 < 1 is equivalent to the inequality
β (1 − ρ)
< 1.
α
γ+N
e0 = β(1−ρ)
Thus, the coefficient R
could be also used as a reproduction number, which corresponds to the
α
γ+ N
one used in Niazi et al. [2020].

4

Validation of the model by applying it to the COVID-19 spread
in Spain

In this section, we estimate the parameters of model (2) during the first wave of the COVID-19 pandemic in
Spain. After estimating the parameters, we introduce the massive test detection. Solving system (4) with a
constant number of test per day we show numerically that the final number of susceptible S∞ would have
been greater had a program for testing been implemented. We show also the increasing dependence of S∞
with resect to the parameter ρ.
We will assume that the rates of death and recovery are the same among the detected and the undetected
e1 (t) = γ1 (t) , γ
e2 (t) = γ2 (t).
infected people. Therefore, γ(t) = γ1 (t) + γ2 (t), and γ
Taking into account that during the pandemic the government implemented at certain moments of time
restrictive measures of confinement leading to reduction of mobility, following Gutierrez and Varona [2020],
Lin et al. [2020], Tang et al. [2020a] the rate of transmission β (t) will be a piecewise continuous function
with a finite number of discontinuities such that in each interval of continuity the form of the function reads
as:


β (t) = β0 − β1 1 − e−α(t−t0 ) .
We extend this approach to the functions γ1 (t) , γ2 (t), so that they are also piecewise defined functions of
the form:


γi (t) = γ0,i − γ1,i 1 − e−αi (t−t0 ) .
10

As observed in Roda et al. [2020] the parameters ρ (t) and β (t) are somehow dependent, which means
that for a given sample there exist several combinations of these parameters that fit well the data. This is
the problem of nonidentifiability. To avoid this drawback we use the study of seroprevalence in Spain for
the first wave of the epidemic and choose an average value for the parameter ρ, so it is not estimated.
It has been estimated in Lauer et al. [2019] that the mean value of the incubation period of the virus is
about five days, so we take σ = 1/5. There are other studies which give a larger period of incubation. For
example, in Wu et al. [2020] the estimated value is around six.
Also, we choose an average value for ρ given by the study of seroprevalence in Spain de Salud Carlos III
[2020]. According to this work, at the end of May of 2020 5,2% of the population of Spain had been
infected by the virus (which gives about 2400000 infected people as the population is 47 millions), whereas
an approximate number of 230000 people were detected by the COVID tests at that moment. Thus, the
average rate of detection during the first wave of the pandemic in Spain was approximately equal to 0.1.
We estimate the parameters of the model in the period from February 20, 2020 to May 17, 2020. Taking
into account the points of confinement, we split this interval into the following four subintervals: 1) 20/0212/03; 2) 12/03-1/04; 3) 1/04-21/04; 4) 21/04-17/05.
We need to estimate the parameters of the functions β (t) , γ1 (t) and γ2 (t) in each subinterval. For
this aim we use the observed values of the variables D (t) , F1 (t) , R1 (t), that is, the number of currently
active infected, dead and recovered people which were detected. We have taken the sample given by the
Spanish Health Ministry (see https://github.com/datadista/datasets/tree/master/COVID%2019, sections
ccaa covid19 confirmados pcr, ccaa covid19 fallecidos, ccaa covid19 altas), using only the number of infected
people detected by means of a PCR test. The value of the constant α is 0 and the variable T (t) is equal to
0 as well (that is, there is no massive testing). The observed value at time ti will be denote by Di , F1i and
R1i , respectively. We consider in each interval the pondered average of the euclidean norm of each observed
variable:
v
v
v
u n
u n
u n
X
uX
u
uX
2
2
2
t
t
Error = α1
(Di − D (ti )) + α2
(F1i − F1 (ti )) + α3 t
(R1i − R1 (ti )) ,
(18)
i=1

i=1

i=1

where α1 + α2 + α3 = 1. We have chosen α1 = α2 = 0.35, α3 = 0.3.
On the 20th of February the number of detected active infected individuals was 3, so the estimate of the
real number of infected subjects is 3/ρ = 30. At that moment there were detected neither dead nor recovered
people. We assume that there were no removed subjects at all at the initial stage of the pandemic. Hence,
the initial value of the problem is given by:
I0 = 30, F0 = 0, R0 = 0, L0 = 0, S0 = N − I0 − E0 − F0 − R0 − L0 .
As we do not have a hint for the value of E0 , we estimate it.
The estimate of the parameters is carried out by means of the minimization of the target function (18)
after solving system (2) when the values of the parameters go through a grid of points. The results in each
interval of time are the following:
1. 20/02-12/03: β (t) = β0 = 1.04, γ1 (t) = γ0,1 = 0.0069, γ2 (t) = γ0,2 = 0.014, E0 = 160. In this
interval, we have looked for constant functions β (t) , γ1 (t) , γ2 (t), so β1 = γ1,1 = γ1,2 = 0.
2. 12/03-1/04: β (t) = 0.6 − 0.596e−0.09(t−21) , γ1 (t) = 0.012 − 0.001e−0.05(t−21) , γ2 (t) = 0.016 +
0.04e−0.025(t−21) .
3. 1/04-21/04: β (t) = 0.04 − 0.033e−0.05(t−41) , γ1 (t) = 0.0095 − 0.008e−0.065(t−41) , γ2 (t) = 0.055 −
0.025e−0.44(t−41) .
4. 21/04-17/05: β (t) = 0.02 − 0.0065e−0.09(t−61) , γ1 (t) = 0.0055 − 0.004e−0.075(t−61) , γ2 (t) = 0.025 +
0.01e−0.93(t−61) .
In figures 1-3 we can see the estimate of the detected currently infected, dead and recovered individuals
over the whole period.

11

Figure 1: Detected currently infected individuals

Figure 2: Detected dead individuals
In figure 4 we can see the prediction given by the estimate of the first two intervals, that is, using only
the observed data until the first of April. The number of currently infected people detected at the peak
of the pandemic is lower than the one given in the estimate. This reflects the fact that on 28th of March
the Spanish Government established more severe measures of confinement by forbidding any non-essential
activity. After some period this restriction was withdrawn, so the slope of the curve of observed values
increased again.
Further we intend to estimate the impact of a massive random testing on the final number of infected
people during the first wave in Spain. For this aim we solve system (7) with three different values of the
parameter α; namely, when we carry out 50000, 100000 and 150000 random tests per day.
The approximate limit values of susceptible individuals S∞ in the long run are the following:
α
0
50000
100000
150000

S∞
44364000
44452000
44535000
44614000

12

Figure 3: Detected recovered individuals

Figure 4: Detected currently infected individuals
Therefore, the number of infections which are saved with massive testing is 88000, 171000 and 250000,
respectively. In figure 5 one can see the evolution of the number of susceptible without massive tests and
carrying out 100000 tests per day.
We can measure also the effect of increasing the value of the parameter ρ while the other parameters
remain unchanged, and varying the value of α at the same time as well:
number of saved
infections

α

ρ

S∞

0
0
50000
100000
0
100000

0.1
0.15
0.15
0.15
0.3
0.3

44364000
45372000
45426000
45476000
46592000
46587000

1008 000
1062000
1112 000
2197 000
2223 000

It is important to observe that we have considered here the simple situation where a constant number of
random test is carried out each day. This procedure is very far to be optimal. In the next section we will
13

Figure 5: Susceptible individuals
consider a heuristic method to optimize the distribution of the tests in order to make massive testing much
more effective.

5

Distribution approach

In the previous section we have analysed the impact of massive testing when the number of tests which are
carried out each day is constant. It is clear that such an homogeneous distribution is not optimal. Therefore,
in this section we implement a heuristic method which allows us to increase the number of saved infections.
Unlike the previous situation, where we needed to estimate the parameters of the model only once, now it
will be necessary to make the estimation a lot of times. Due to this, the parameters have to be estimated
using an automatic method. For this aim a genetic algorithm will be implemented.

5.1

Estimation of the parameters

The expert system that we have developed uses the Differential Evolution technique for estimating the
parameters of model (7). The differences between this method and other evolutionary algorithms are mainly
in the mutation and recombination phases in which weighted differences from the space vector, despite
random quantities, are used to obtain perturbations. We have employed the Differential Evolution Algorithm
described in Iorio and Li [2006]. Each individual is codified by an array containing the values of the
parameters to be estimated. The initial population is randomly generated and Algorithm 1 describes the
procedure which generates a new population from the current population PG formed by N individuals.
Algorithm 1: New Population(PG )

4

for i = 1 : N do
Randomly select r1 , r2 , r3 ∈ {1, 2, ..., N } such that r1 6= r2 6= r3 6= i
ui,G+1 =xi,G + K( xr3,G − xi,G ) + F ( xr1,G − xr2,G )
if ui,G+1 is better than xi,G then xi,G+1 =ui,G+1 else xi,G+1 = xi,G

5

return PG+1

1
2
3

Algorithm 1 generates one descendant for each individual i belonging to the current population PG .
Basically three different individuals with index r1 6= r2 6= r3 6= i are randomly selected from PG . At Step 3,
the descendant ui,G+1 is generated by ui,G+1 =xi,G + K( xr3,G − xi,G ) + F ( xr1,G − xr2,G ). The differential

14

K( xr3,G − xi,G ) combines xr3,G and xi,G whereas the differential F ( xr1,G − xr2,G ) sets the step size. The
coefficients K, F ∈ (0, 1] are constants.
The selected individual is replaced by its descendant if it is better in the sense that the value of a fitness
function is lower. As in the previous section, we use as the fitness function the pondered average of the
euclidean norm of each observed variable, given in (18). The algorithm is repeated until no replacement
happens after a maximal number of successive generations.

5.2

Obtaining the planning distribution

The aim of the distribution method is to plan the distribution of tests among the locations of a region over
the instants of time within a temporal horizon, that is, to decide how many tests is better to assign to each
location at each instant of time. The objective of this planning is to minimize the total number of infected
individuals in a given region and in a temporal interval or, what is the same, to maximize the number of
saved infections. The main purpose of such distribution is to plan an effective massive testing combined
with tracing.
The distribution method is based on forecasting the number of infected people which would be saved
after the assignment of one testing team to one location at one instant of time within the temporal horizon.
This procedure has to be repeated for each location and each moment of time. Let K be the number of
people tested per instant (day, week or month) by a testing team, L = {l1 , ..., le } be the set of locations
(counties, towns, etc.), and T = {1, 2, ..., M } be the set of instants of time, being t the current instant.
Firstly, we calculate the gain matrix G = {gl,t }, that forecasts the number of saved infections due to the
assignment of K tests at location l and instant t. Secondly, the optimal test distribution is obtained from
this matrix according to a heuristic method that provides the distribution matrix D = {dl,t }, which indicates
the number of tests to be distributed in each location l at each instant t. So, the procedures gain matrix
(Algorithm 2) and test distribution (Algorithm 3) are used to obtain G and D, respectively.
Algorithm 2 returns the gain matrix G. Initially, the parameters (β(t), ρ(t), σ, etc.) and the initial state
variables (S(t), E(t), I(t), etc.) are estimated by the Differential Evolution technique for each location l
from the historical data of the coronavirus spread until the current instant t. Then, for each location we
solve system (7) twice with initial conditions at the moment t. Firstly, it is solved with no test assignment.
Secondly, it is solved but assigning K tests only to the location l and the instant t + i, 1 ≤ i ≤ 14. The
difference of infected cases at t + i + 14 in both predictions provides the gain value gl,t+i , that is, the number
of saved infections corresponding to testing K people in the location l and instant t. However, if the effective
reproduction number at time t + i and the location l, Rl,t+i , is lower than 1, it is considered that there
is no gain since the pandemic is in a decline phase, so gl,t+i = 0. Besides, we observe that given that the
circumstances are variable and the expert system uses the procedure in a dynamic way, running it every day,
a myopic approach that focuses on obtaining gain values for the next 14 days after the current instant t is
used.
Algorithm 2: gain matrix
1
2
3
4
5
6
7
8
9
10

foreach l ∈ L do
estimation of parameters and state variables for l
for i = 1 to 14 do
if Rl,t+i ≥ 1 then
p̄ =prediction of infected cases at t + 14 + i without testing
p =prediction of infected cases at t + i + 14 assigning K tests at t + i
gl,t+i = p̄ − p
else
gl,t+i = 0
return G

Once the gain matrix is obtained, Algorithm 3 is called in order to heuristically maximize the number of
saved infections. So, first of all the location-instant pair (l∗ , t∗ ) with largest gain value is chosen. Then, as

15

many tests as possible are allocated to the population l∗ and instant t∗ > t. This quantity dl∗ ,t∗ depends on
several constraints such as the number of remaining tests, the maximum number of people which are able to
be tested at this location per day, the number of available test teams, etc. At Step 4, the quantity of tests
assigned to (l∗ , t∗ ) is subtracted from the available tests. Then, the procedure carries on locating the second
largest gain, and so on. Once all the available tests have been distributed the procedure ends up returning
the distribution matrix D.
Algorithm 3: test distribution

5

while #tests > 0 do
Gl∗ ,t∗ = element of G with maximum value
dl∗ ,t∗ = maximum number of feasible tests distributable to location l∗ and instant t∗
#tests = #tests − dl∗ ,t∗
Gl∗ ,t∗ = 0

6

return D

1
2
3
4

We note that it is convenient to refresh the estimate of parameters and the state variables for each
moment of time t, being necessary to compute again both the gain and distribution matrices every time new
data about the coronavirus spread are reported. Thus, the proposed approach is used in a dynamic way.

6

Computational experience: distributing tests among the New
York counties

In this section we will analyse the computational results of the proposed distribution approach by measuring
the number of saved infections and also by comparing it with a distribution of tests which is homogeneous
in time and proportional to the size of each population. As an application, we will apply this method to the
New York state, which pandemic spread data are disaggregated by counties and available in Data [2020].
The period of time chosen for our study is from the first of April to the first of July of 2020. The reason
for choosing it is that it was during this period when the pandemic spread was most virulent. Although the
first case was detected on the first of March, in the majority of the counties there were no registered cases
until the 15th of March. The historical data in this period are used in order to simulate the pandemic spread
and also to measure the effectiveness of the possible distributions of tests. In this regard, the distribution
obtained by our approach is compared with the distribution of tests which is homogeneous in time and
proportional to the number of inhabitants of every county. It is important to observe that as the data about
the recovered individuals are not reported, we have estimated them by supposing an average recovery time
of 14 days. Then, the historical recovery data have been built by using the cumulative detected cases in the
last 14 days for every moment of time.
Algorithm 4 shows the procedure that has been used in order to compute the number of saved infections
after applying our distribution method. Initially, we estimate the parameters of model (7) for the whole
period of study. However, as the conditions and parameters are different according to different circumstances
as the lockdown phases, the use of masks, etc. the parameters are defined and estimated piecewise for each
week. This is similar to what is done in Section 4 but now the intervals are fixed in periods of seven days
because the purpose of this study is to develop a fully automatic decision system, avoiding thus the necessity
to define the intervals with dependence on the government restrictions as lockdown or curfew. We will refer
to these parameters as the simulation parameters.
Regarding the settings of the Differential Evolution technique which have been used in this application, a
population of N = 5 individuals has been fixed. Usually, the population size of genetic algorithms is higher
but due to the large number of parameters to be estimated this size has been adjusted to the available RAM
computer memory. The coefficients K, F ∈ (0, 1] were randomly generated at each iteration. Finally, the
estimation is stopped when a maximum number of 1000 iterations are carried out without any replacement
. Our numerical experiments were performed on a PC with a 2.33 GHz Intel Xeon dual core processor, 8.5
GB of RAM, and with the operating system LINUX Ubuntu 18.04.5.

16

Secondly, for each day t, algorithms 2 and 3 are used for planning the test distribution but computing
the gain matrix using only the historical data until t, given that we need to suppose the data of later instants
to be unknown. We need to define a matrix D0 containing the distribution of tests on each location at each
moment of time over the whole period. At any instant t we only apply the obtained test distribution for the
next day, so the column t + 1 in D0 is replaced by the column t + 1 in the matrix D, that is d0l,t+1 = dl,t+1 .
We repeat this procedure for each moment of time. We note that when we advance from t to t + 1 in order
to obtain a new matrix distribution D we need to estimate again all the parameters, as the reported data
is now available for one day more. After computing the matrix D0 we calculate the difference between the
estimated infected cases at time M without testing I0 = (M ) and the estimated infected cases after applying
0
our test distribution ID
(M ), which provides the total number of saved infections.
Algorithm 4: saving
1
2
3
4
5
6
7
8
9

simulation parameters = estimated parameters until M
t=0
while t < M do
estimation of parameters = estimated parameters until t
obtain G and D using the estimation parameters
for each l do d0l,t+1 = dl,t+1
compute I0 (M ) without testing and using the simulation parameters
compute ID0 (M ) applying distribution D0 and using the simulation parameters
return I0 (M ) − ID0 (M )

We note that in order to obtain the test distribution we employ the estimation of parameters at each
iteration, whereas the simulation parameters are used for predicting the model and measuring the effectiveness of testing. Both estimations do not need to have the same values since the first ones are calculated
with the information which is available until the current moment of time and the simulation parameters are
estimated using the data until the last instant of time. Regarding the cases which are detected from the
application of random tests, they are estimated by using expression (6), where, for each location and instant
t, α(t) is the number of tests to be applied. Besides, in our computational experiments, the detected cases
by testing have been multiplied by a factor with the following values:
• 1, which means that the testing process is fully random and posteriorly there is no COVID contact
tracing;
• 3, if it exists a process of COVID contact tracing which produces an average of 2 additional detected
cases from the initially detected case;
• 9, if besides the COVID contact tracing, testing is focused on towns or groups of determined sociodemographic features, which allows to increase 3 more times the probability of detection.
It is important to take into account that the product of this factor and the number of daily tests α (t)
cannot be greater that the total population of the location.
We have carried out two types of computational experiments for different quantities of available tests.
In the first of them, the daily testing capacity is restricted to 10000 tests per day. In the second, the daily
testing capacity is restricted to 10% of the total tests to apply in the whole period.
Table 1 shows the results obtained by our experiments. Column #T ests indicates the number of tests
to be assigned. These have been: 10, 50, 100 and 500 thousands. So, 12 simulations, corresponding to the
four possible numbers of tests and the three factor values indicated in Column F actor, have been carried
out. Hom. Inf. and Approach Inf. columns show the estimated infected cases by using the homogenous
distribution and our approach, respectively. On the other hand, Hom. Saving and Approach Saving columns
show the number of saved infections with both methods. The number of infected cases from the first of April
to the first of June of 2020, including both those detected and not detected, have been estimated in 3.365.817.
For this aim, model (7) has been used, estimating its parameters by Algorithm 1 with weekly intervals in
which the parameters can be different. No prevalence study was taking into account, so ρ(t) was also
17

estimated for each interval. Then Hom. Saving and Approach Saving were calculated as 3.365.817 minus
Hom. Inf. and Approach Inf., respectively. Finally, Column Advantage shows the difference Approach Saving
minus Hom. Saving. Therefore, the greater the difference the more advantageous the proposed approach
is. On the contrary, negative values mean that the homogeneous distribution overcomes our approach. We
can see that the proposed method improves the homogeneous distribution except in a few cases with 500000
tests. We note that such quantity of tests practically forces a homogeneous distribution in time even with
the proposed method. This explains that the results are similar except when tracing and socio-demographic
features are taking into account, in which case the homogeneous method clearly leads to better results. It is
also important to observe that in this particular case not all the available tests were distributed since 100000
tests were not assigned.
# Tests
10,000
10,000
10,000
50,000
50,000
50,000
100,000
100,000
100,000
500,000
500,000
500,000

Factor
1
3
9
1
3
9
1
3
9
1
3
9

Hom. Inf.
3,365,384
3,364,519
3,361,923
3,364,824
3,362,819
3,357,442
3,364,744
3,362,612
3,357,124
3,364,334
3,361,467
3,354,169

Approach Inf.
3,365,783
3,365,716
3,365,514
3,365,666
3,365,365
3,364,462
3,365,519
3,364,924
3,363,144
3,364,346
3,361,416
3,352,700

Hom. Saving
34
101
303
151
452
1,355
298
893
2,673
1,471
4,401
13,117

Approach Saving
433
1,298
3,894
993
2,998
8,375
1,073
3,205
8,693
1,483
4,350
11,648

Advantage
399
1,197
3,591
842
2,546
7,020
775
2,312
6,020
12
-51
-1,469

Table 1: Number of infected cases and saved infections with 10000 tests per day limitation
Regarding the total number of tests which are employed, the more tests the more infections are saved, but
the ratio saving/tests is decreasing as it can be seen in Table 2, which shows the number of saved infected
cases per hundred applied tests. These ratios have been obtained for both distributions with f actor = 9.
On the one side, the effectiveness of the proposed approach highly decreases with respect to test increments,
whereas the effectiveness of the homogeneous distribution is practically independent of the total tests. On
the other hand, the effectiveness of the proposed distribution is notoriously higher but finally, due to the
loss of its effectiveness when increasing the number of tests, both are similar for 500000 tests. At last, Table
3 specifies the corresponding distribution for 100000 tests with f actor = 1.
# Tests
10,000
50,000
100,000
500,000

% Homogeneous
3.03
2.71
2.67
2.62

% Approach
38.94
16.75
8.69
2.33

Table 2: Ratios Saving/Tests with 10000 tests per day limitation
Given that imposing a constant capacity of testing per day, which is independent of the total number
of tests, is a very strict limitation, we have also carried out experiments in which the capacity per day was
limited to 10% of the total number of tests. This computational experience is reported in Table 4. In this
case the advantage of the proposed approach is always higher than the homogeneous approach even in a new
case with 1000000 tests, which illustrates how high quantities of tests are also effective if they are not highly
restricted by the daily capacity of testing.
The saving/test ratios of the distribution with the daily limitation of 10% of the total number of tests are
reported in Table 5 for f actor = 9. The cases with 10000 and 50000 tests show again how higher restrictions
of the daily capacity reduce effectiveness given that its daily capacity is more restricted and as consequence
its ratio decreases. The cases with 500000 and 1000000 tests illustrate how a higher daily capacity allows us
to overcome the homogeneous distribution although the ratio decreases. On the contrary, the ratio of the
18

Day
12/04
16/04
20/04
23/04
24/04
25/04
26/04
27/04
28/04
29/04

County
New York City
Rensselaer
Delaware
Ulster
Franklin
Cortland
Onondaga
Fulton
Oswego
New York City

# Tests
10,000
10,000
10,000
10,000
10,000
10,000
10,000
10,000
10,000
10,000

Table 3: Planning for 100000 tests
# Tests
10,000
10,000
10,000
50,000
50,000
50,000
100,000
100,000
100,000
500,000
500,000
500,000
1,000,000
1,000,000
1,000,000

Factor
1
3
9
1
3
9
1
3
9
1
3
9
1
3
9

Hom. Inf.
3,365,783
3,365,716
3,365,514
3,365,666
3,365,365
3,364,462
3,365,519
3,364,924
3,363,144
3,364,346
3,361,416
3,352,700
3,362,884
3,357,058
3,339,880

Approach Inf.
3,365,709
3,365,494
3,364,851
3,365,280
3,364,209
3,361,026
3,364,744
3,362,612
3,357,124
3,360,256
3,354,512
3,341,480
3,355,417
3,344,645
3,316,234

Hom. Saving
34
101
303
151
452
1,355
298
893
2,673
1,471
4,401
13,117
2,933
8,759
25,937

Approach Saving
108
323
966
537
1,608
4,791
1,073
3,205
8,693
5,561
11,305
24,337
10,400
21,172
49,583

Advantage
74
222
663
386
1,156
3,436
775
2,312
6,020
4,090
6,904
1,1220
7,467
12,413
23,646

Table 4: Number of infected cases and saved infections with 10% tests per day limitation
homogeneous distribution is less variable.
# Tests
10,000
50,000
100,000
500,000
1,000,000

% Homogeneous
3.03
2.71
2.67
2.62
2.60

% Approach
9.66
9.59
8.69
4.87
4.96

Table 5: Ratios Saving/Tests with 10% tests per day limitation
Table 6 specifies the corresponding distribution planning for 1000000 tests and f actor = 1. The counties
of Chenango, Chemung, Delaware, Franklin, Washington and Orleans are fully tested (the inhabitants for
each county have been obtained from of Health [2010]). Note that for 100000 tests the distribution planning
is the same as the one reported in Table 3.

7

Conclusions

In this work a SEIR model for analysing the efficiency of test distributions has been introduced. It contemplates both detected and non-detected infected individuals in order to measure the impact of testing. Since

19

Day
12/04
17/04
19/04
21/04
22/04
23/04
24/04
25/04
26/04
26/04
27/04
28/04
29/04

County
Nassau
Oswego
Oneida
Ontario
Chemung
Nassau
Washington
Franklin
Delaware
Orleans
Chenango
Westchester
Rensselaer

# Tests
100,000
100,000
100,000
100,000
88,830
100,000
63,216
51,599
47,980
42,883
50,477
100,000
55,015

Table 6: Planning for 1000000 tests
the values of the parameters of the model can change abruptly due to severe governments measures like
lockdown, curfew, etc., the coefficients of the model are defined piecewise in given intervals of time and are
functions of time. This model has been applied to the spread of the COVID pandemic in Spain. Besides, we
have theoretically proved how massive testing helps reducing the number of infected people in the long-term.
Secondly, we describe the Differential Evolution technique, which is a genetic algorithm for the estimation
of parameters, and develop a heuristic approach for distributing tests. This approach have been applied to
the spread of COVID pandemic in the New York counties by an extensive computational experience showing
the advantages of the proposed distribution method. Also, an interesting future research line is to adapt a
similar distribution approach to the distribution of vaccines.
Acknowledgements
This work has been supported by the Generalitat Valenciana (Spain), project 2020/NAC/00022 . The
first author has also been partially supported by the Spanish Ministry of Science, Innovation and Universities, project PGC2018-099428-B-I00. The second author has also been partially supported by the Spanish
Ministry of Science, Innovation and Universities, project PGC2018-096540-B-I00, the Spanish Ministry of
Science and Innovation, project PID2019-108654GB-I00, and by Junta de Andalucı́a (Spain) and FEDER,
projects P18-FR-2025 and P18-FR-4509.

References
S. Annas, M. Isbar Pratama b, M. Rifandi, W. Sanusi, and S. Side. Stability analysis and numerical
simulation of seir model for pandemic COVID-19 spread in indonesia. Chaos, Solitons and Fractals, 139,
2020.
J.P. Arcede, R.L. Caga-anan, C.Q. Mentuda, and Y. Mammeri. Accounting for symptomatic and asymptomatic in a SEIR-type model of COVID-19. Math. Model. Nat. Phenom, 15, 2020.
D.W. Berger, K.F. Herkenhoff, and S. Mongey. SEIR infectious disease model with testing and conditional
quarantine. NBER Working Paper No. 26901, 2020.
F. Brauer and C. Castillo-Chávez. Mathematical models in population biology and epidemiology. Springer,
New-York, 2012.
T. Britton, F. Ball, and P. Trapman. The disease-induced herd immunity level for Covid-19 is substantially
lower than the classical herd immunity level. arXiv, 2005.03085, 2005.
T. Chen, J. Rui, Q. Wang, Z. Zhao, J. Cui, and L. Yin. A mathematical model for simulating the phase-based
transmissibility of a novel coronavirus. Infectious Diseases of Poverty, 9, 2020.
20

Y. Chen, P. Lu, C. Chang, and T. Liu. A Time-dependent SIR model for COVID-19 with undetectable
infected persons. IEEE Transactions on Network Science and Engineering, 2020.
US COVID-19 Data. [database]. retrieved from https://github.com/nytimes/covid-19-data/blob/
master/us-counties.csv. The New York Times, 2020.
Instituto de Salud Carlos III. Estudio ENE-COVID: Informe final. estudio nacional de sero-epidemiologı́a
de la infección por SARS-COV-2 en españa https://portalcne.isciii.es/enecovid19. 2020.
M. S. Eichenbaum, S. Rebelo, and M. Trabandt. NBER Working Paper. The macroeconomics of testing and
quarantining, 27104, 2020.
I. De Falco, A. Della Cioppa, U. Scafuri, and E. Tarantino. Coronavirus Covid–19 spreading in Italy:
optimizing an epidemiological model with dynamic social. arXiv, 2004.00553, 2020.
M.G.M. Gomes, R.M. Corder, J.G. King, C. Souto-Maior K.E. Langwig, J. Carneiro, G. Gonçalves, C. PenhaGonçalves, M.U. Ferreira, and R. Aguas. Individual variation in susceptibility or exposure to SARS-CoV-2
lowers the herd immunity threshold. medRxiv, 2020.
J.M. Gutierrez and J.L. Varona. Analisis de la posible evolución de la epidemia de coronavirus COVID-19 por
medio de un modelo SEIR https://belenus.unirioja.es/jvarona/coronavirus/SEIR-coronavirus.
pdf. 2020.
S. He, Y. Peng, and K. Sun. SEIR modeling of the COVID-19 and its dynamics. Nonlinear Dynamics,
101:1667–1680, 2020.
A.W. Iorio and X. Li. Incorporating directional information within a Differential Evolution algorithm for
multi-objective optimization. Proceeding of the Genetic and Evolutionary Computation Conference 2006,
pages 691–697, 2006.
A.W. Iorio and X. Li. Coronavirus Covid–19 spreading in Italy: optimizing an epidemiological model with
dynamic social distancing through differential evolution. arXiv, 2004.00553, 2020.
C. Ji and Jiang. The extinction and persistence of a stochastic SIR model. Advances in Difference Equations,
2017, 2017.
J. Jiao, Z.Liu, S. Cai, and Dynamics. Dynamics of a SEIR model with infectivity in incubation period and
homestead-isolation on the susceptible. Applied Mathematics Letters, 107, 2020.
M. Kotyrba, E. Volna, and P. Bujok. Unconventional modelling of complex system via cellular automata
and differential evolution. Swarm and Evolutionary Computation, 25:52–62, 2015.
T. Kuniya and Y. Nakata. Permanence and extinction for a nonautonomous SEIRS epidemic model. Applied
Mathematics and Computation, 218:9321–9331, 2012.
C. A. K. Kwuimy, F. Nazari, X. Jiao, P. Rohani, and C. Nataraj. Nonlinear dynamic analysis of an epidemiological model for COVID-19 including public behavior and government action. Nonlinear Dynamics,
101:1545–1559, 2020.
S.A. Lauer, K.H. Grantz, F.K. Jones Q. Bi, Q. Zheng, and H.R. Meredith. The incubation period of
coronavirus disease 2019 (COVID-19) from publicly reported confirmed cases: Estimation and application.
Ann. Intern. Med., 172:577–582, 2019.
M.Y. Li and J.S. Muldowney. Global stability for the SEIR model in epidemiology. Mathematical Biosciencies, 125:155–164, 1995.
Q. Lin, S. Zhao, D. Gao, Y. Lou, S. Yang, S.S. Musa, M.H. Wang, Y. Cai, W. Wang, L. Yang, and D. He. A
conceptual model for the coronavirus disease 2019 (COVID-19) outbreak in Wuhan, China with individual
reaction and governmental action. International Journal of Infectious Diseases, 93:211–216, 2020.

21

S. Mushayabasa, E.T. Ngarakana-Gwasira, and J. Mushanyu. On the role of governmental action and
individual reaction on COVID-19 dynamics in South Africa: A mathematical modelling study. Informatics
in Medicine Unlocked, 20, 2020.
F. Ndaı̈rou, I. Area, J.J. Nieto, and D.F.M. Torres. Mathematical modeling of COVID-19 transmission
dynamics with a case study of Wuhan. arXiv, 2004.10885, 2020.
M.U.B. Niazi, A. Kibangoua, C. Canudas de Wita, D. Nikitina, L. Tumasha, and .P. Bliman. Modeling and
control of COVID-19 epidemic through testing policies. arXiv, 2010.15438, 2020.
N.Y.S. Department of Health. Population, Land Area, and Population Density by County, New York State
- 2010: https://www.health.ny.gov/statistics/vital_statistics/2010/table02.htm. 2010.
W.C. Roda, M.B. Varughese, and M.Y. Li D. Han. Why is it difficult to accurately predict the COVID-19
epidemic? Infectious Disease Modelling, 5:271–281, 2020.
P. Romagnani, G. Gnone, F. Guzzi, S. Negrini, A. Guastalla, F. Annunziato, S. Romagnani, and R. De
Palma. The COVID-19 infection: lessons from the Italian experience. Journal of Public Health Policy,
pages 1–7, 2020.
T. Sauter and M.P. Pacheco. Testing informed SIR based epidemiological model for COVID-19 in Luxembourg. medRxiv, 2020, 2020.
R. Storn. On the usage of differential evolution for function optimization. Proceedings of the 1996 Biennial
Conference of the North American Fuzzy Information Processing Society, pages 519–523, 1996.
B. Tang, N.L. Bragazzi, Q. Li, S. Tang, Y. Xiao, and J. Wu. Updated estimation of the risk of transmission
of the novel coronavirus (2019-nCov). Infectious Disease Modelling, 5:248–255, 2020.
B. Tang, X. Wang, Q. Li, N.L. Bragazzi, S. Tang, Y. Xiao, and J. Wu. Estimation of the transmission risk
of the 2019-nCoV and its implication for public health interventions. J. Clin. Med., 9, 2020.
S. Ubaru, L. Horesh, and G. Cohen. Dynamic graph based epidemiological model for COVID-19 contact
tracing data analysis and optimal testing prescription. arXiv, 2009.04971, 2020.
P. van den Driessche and J. Watmough. Reproduction numbers and sub-threshold endemic equilibria for
compartmental models of disease transmission. Mathematical Biosciences, 180:29–48, 2002.
L. Wang, Y. Zeng, and T. Chen. Back propagation neural network with adaptive differential evolution
algorithm for time series forecasting. Expert Systems with Applications, 42:855–863, 2015.
Y. Wang. How testing reduces infections and prevents herd immunity: a SIR model with testing. https:
// ssrn. com/ abstract= 3577765 , 2020.
J.T. Wu, K. Leung, and G.M. Leung. Nowcasting and forecasting the potential domestic and international
spread of the 2019-nCoV outbreak originating in Wuhan, China: a modelling study. Lancet, 395:689–697,
2020.
C. Xu, Y. Yu, Y. Chen, and Z. Lu. Forecast analysis of the epidemics trend of COVID-19 in the usa by a
generalized fractional-order SEIR model. Nonlinear Dyn., 101:1621–1634, 2020.
W. Yi, Y. Zhou, L. Gao, X. Li, and J. Mou. An improved adaptive differential evolution algorithm for
continuous optimization. Expert Systems with Applications, pages 1–12, 2016.
T. Zhang and Z. Teng. On a nonautonomous SEIRS model in epidemiology. Bulletin of Mathematical
Biology, 69:2537–2559, 2007.
Y. Zhao, D. Jiang, and D. O’Regan. The extinction and persistence of the stochastic SIS epidemic model
with vaccination. Physica A: Statistical Mechanics and its Applications, 392:4916–4927, 2017.

22

