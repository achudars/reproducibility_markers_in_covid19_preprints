arXiv:2008.09866v1 [cs.CV] 22 Aug 2020

Symbolic Semantic Segmentation and Interpretation of
COVID-19 Lung Infections in Chest CT volumes based
on Emergent Languages
Aritra Chowdhury∗, Alberto Santamaria-Pang, James R. Kubricht, Jianwei
Qiu, Peter Tu
Artificial Intelligence, GE Research, 1 Research Circle, Niskayuna NY 12309

Abstract
The coronavirus disease (COVID-19) has resulted in a pandemic crippling the a
breadth of services critical to daily life. Segmentation of lung infections in computerized tomography (CT) slices could be be used to improve diagnosis and
understanding of COVID-19 in patients. Deep learning has come a long way
in providing tools to accurately characterize infections and lesions in CT scans.
However, they lack interpretability because of their black box nature. Recent
advances in methods addressing the grounding problem of artificial intelligence
have resulted in techniques that can used to develop symbolic languages to represent data in specific domains. Inspired by human communication of complex
ideas through language, we propose a symbolic framework based on emergent
languages for the segmentation of COVID-19 infections in CT scans of lungs.
We model the cooperation between two artificial agents - a Sender and a Receiver. These agents synergistically cooperate using emergent symbolic language
to solve the task of semantic segmentation. Our game theoretic approach is to
model the cooperation between agents unlike adversarial models e.g. Generative
Adversarial Networks (GANs). The Sender retrieves information from one of
the higher layers of the deep network and generates a symbolic sentence sampled from a categorical distribution of vocabularies. The Receiver ingests the
∗ Corresponding

author
Email address: aritra.chowdhury@ge.com (Aritra Chowdhury)

Preprint submitted to Journal of LATEX Templates

August 25, 2020

stream of symbols and cogenerates the segmentation mask. A private emergent
language is developed among the Sender and Receiver that forms the communication channel used to describe the task of segmentation of COVID infections.
We augment existing state of the art semantic segmentation architectures with
our symbolic generator to form symbolic segmentation models. Twenty-nine
CT volumes from two different sources of lung infection data, resulting from
COVID-19 are used in this work to demonstrate our approach. Our symbolic
segmentation framework achieves state of the art performance for segmentation
of lung infections caused by COVID-19. Our results show direct interpretation
of symbolic sentences to discriminate between normal and infected regions, infection morphology and image characteristics. We show state of the art results
for segmentation of COVID-19 lung infections in CT. Our approach is agnostic of the base segmentation model and can be used to augment any model to
improve segmentation accuracy and interpretability.
Keywords: game theory, symbolic deep learning, emergent languages, Chest
CT segmentation, COVID-19

1. Introduction
The world has faced a major health crisis since December 2019, due to the
novel coronavirus (COVID-19) (Wang et al. (2020a)), also known as Sars-COV2 (Andersen et al. (2020)). Over 6 million cases were reported resulting in over
370,000 deaths (Dong et al. (2020)) across 187 countries. A crisis of this scale
and magnitude has yet to occur in modern civilization; the severity of future
pandemics and the importance of efficient human response cannot be stressed
enough. Large scale efforts have been initiated by global health organizations
and national governments for diagnosis, testing and potential cures for the virus
(Sheridan (2020)). Reverse transcription polymerase chain reaction (RT-PCR)
has been considered the gold standard for the screening of COVID-19. However, there is a severe lack of testing equipment for environments that prohibit
accurate screening of suspected cases. In addition, the reliability of the RT-

2

PCR test has been questioned due to the high number of false negatives (Ai
et al. (2020)). This calls for taking a multi-modality approach for consistent
and robust diagnosis of COVID-19 in patients. One approach is to complement
the RT-PCR test with radiological techniques such as X-rays and CT scans
(Rubin et al. (2020); Shi et al. (2020a)). This will help to significantly reduce
the false negative rate and provide doctors with an elaborate and multifacted
understanding of the disease. Recent results have shown that chest CT analysis
can be utilized to obtain high levels of predictive performance (Ai et al. (2020)).

(a) Symbols: 189 663 277 277 925 103 155

(b) Symbols: 573 833 236 618 244 108 786

155

155

Figure 1: Examples of segmentation ground truth and predictions and the corresponding
symbolic sentences on CT scan slices consisting of COVID-19 lung infections. We observe
that our symbolic UNet provides accurate segmentation maps. In addition, the sentences
provide clues towards interpreting the infections.

CT based analysis and diagnosis is generally preferred over X-rays because
of access to three-dimensional views of organs (Ye et al. (2020)). Typical signs
of lung infections (e.g. ground-glass opacity) can be observed from CT slices
as shown in Fig. 1. The qualitative and quantitative appearance of the infection can provide important information related to detailed understanding of the
characteristics of the COVID-19 disease. There are a number of challenges in

3

segmentation of infections in chest CT slices because of the high variation in
the size, texture and position of infections in the image. For example, small
consolidations can result in false negative detection outcomes. Deep learning
based approaches to analysis of CT imagery has come a long way to address
these issues (Cheng et al. (2016)). However, as suspected, such inscrutable statistical models prove to be difficult to interpret. We propose a symbolic, game
theoretic approach based on emergent languages to understand segmentation
outputs in the context of lung infections in chest CT scans. Current limitations
in Artificial Intelligence (AI) include lack of interpretability and explainability; i.e. classical black-box approaches utilizing deep networks do not provide
adequate evidence on how and why models perform the way they do (Samek
et al. (2017)). Explainability is considered to be of paramount importance in the
medical field (London (2019)). This is necessary if we are to rely on AI and automated systems for clinical diagnosis and prognosis. In this work, we investigate
synergies between deep learning based Semantic Segmentation (Anthimopoulos et al. (2018)) and Emergent Language (EL) (Havrylov and Titov (2017))
models. We utilize properties of EL architectures to facilitate the interpretation of deep learning models and show how black box semantic segmentation
can be extended to provide semantic sentences based on interpretable symbols.
These sentences are sampled from a categorical distribution and subsequently
integrated into state of the art segmentation architectures. We show, how we
can significantly improve the performance of deep learning based segmentation
networks by incorporating a symbolic layer that generates emergent language
sentences.
In addition to the description and empirical analysis of the proposed methodology, we explore the utility of symbolic segmentation masks towards direct data
interpretability in clinical applications. In this work, we utilize CT scans of patients afflicted with COVID-19 consisting of annotations of lung infections. We
determine whether the symbolic sentences correspond to meaningful semantics
in neural images. We show through rigorous experimentation, that symbolic
segmentation networks are able to yield significant improvements over state of
4

the art black box deep learning models. The symbols generated can also be
used to interpret the results of the segmentation.

2. Related work
In this section, we detail relevant work in the area of segmentation of CT,
medical image analysis of COVID-19 data, Emergent Languages and model
interpretability in convolutional neural networks (CNNs)
2.1. CT Segmentation
CT imaging is an important modality for diagnosis of lung diseases like Pneumonia (Sluimer et al. (2006)). Information obtained from high resolution CT
data can provide important information to doctors for understanding diseases
(Gordaliza et al. (2018)). Segmentation algorithms play a big part in accurately
localizing nodules, lesions and infections in lungs. A lot of promising work has
been done recently in the area of segmentation of chest CT data. An automated
lung segmentation system based on bidirectional chain codes was presented in
Shen et al. (2015). A number of deep learning approaches have been proposed
as well to improve performance of segmentation in chest CT data. A central
focussed CNN is proposed for segmentation of lung nodules in heterogenous CT
(Wang et al. (2017)). GAN based synthetic data augmentation was used to
improve training of a discriminative model for lung segmentation in Jin et al.
(2018). A joint classification and segmentation model of an explainable COVID19 system was proposed in Wu et al. (2020). A semi supervised deep learning
framework leveraging reverse and edge attention for segmentation of lung infections on COVID-19 was proposed in Fan et al. (2020).
2.2. Medical Image Analysis of COVID-19
Technologies leveraging artificial intelligence have been proposed to combat
COVID-19 in multiple different ways at the patient scale (Wang et al. (2020b);
Chen et al. (2020)), the molecular scale (Senior et al. (2020)) and societal scale
(Hu et al. (2020)). Medical image analysis is usually applicable to analysing
5

image data on the patient scale. A modification of the inception network was
proposed in Wang et al. (2020b) for classifying COVID patients from normal
controls. A UNet++ model was trained on 46,096 CT image slices from COVID
patients in Chen et al. (2020). They show that the results of the model perform favorably when compared to expert radiologists’ prediction. In addition,
deep learning has also been used to segment infections in lung CT slices for
downstream quantitative analysis for severity assessment (Tang et al. (2020)),
screening (Shi et al. (2020b)) and lung infection quantification (Rajinikanth
et al. (2020)) of COVID-19.
2.3. Emergent Languages
The emergent languages framework is inspired from Lazaridou et al. (2016),
where the idea of using referential games for multi-agent cooperation is introduced. They show how the cooperative game leads to the emergence of an
artificial language. These ideas are extended in Havrylov and Titov (2017) by
incorporating a sequence of symbols to further approximate sentence formation
in emergent languages. The sequence of symbols is modeled using long short
term memory networks (LSTMs). Introduction of natural language priors in
models are also discussed here. Compositionality of emergent languages among
multiple agents is discussed in Cogswell et al. (2019). A series of studies investigating the properties of protocols from the language is shown in Lazaridou
et al. (2018). Semantic action analysis using emergent languages is explored
in Santamaria-Pang et al. (2019). The application of emergent languages to
cell classification in pathology is explored in Chowdhury et al. (2020). Emergent languages has also been used to generate images using symbolic variational
autoencoders (Devaraj et al. (2020)). An initial approach to symbolic segmentation was proposed recently in Santamaria-Pang et al. (2020).

6

Figure 2: Symbolic segmentation framework. Deep learning based segmentation networks are
augmented using a symbolic generator that cogenerates sentences of the emergent language
along with segmentation masks.

3. Methods
We introduce the radical approach of symbolic semantic segmentation. Traditional semantic segmentation architectures like UNet are supplemented with
a symbolic generator as shown in Fig. 2.
We make the following assumptions to describe the methodology visualized
in Figs. 2 and 4,
1. There exists a segmentation network that provides a segmentation output
x.
2. There is a vocabulary V = w1 , w2 , ..., wN , where N is the size of the
vocabulary. A sentence Sn of length n is a sequence of words or symbols
w1 , w2 , ..., wn .
3. A Sender agent or network which receives the segmentation output x and
generates a sentence Sn of length n, where Sn = Sender(x).
4. A Receiver agent or network, which obtains the symbolic Sentence Sn and
generates an output x0 = Receiver(Sn ).
5. The final segmentation is co-generated from x and x0 .
3.1. Semantic segmentation
In this work, we leverage three state of the art semantic segmentation architectures - UNet (Ronneberger et al. (2015)), UNet++ (Zhou et al. (2018)) and
7

InfNet (Fan et al. (2020)). UNet, introduced in 2015, was one of the first architectures to demonstrate how deep learning may be used to segment biomedical
images. They demonstrated that the architecture was capable of fast and precise segmentation of neuronal structures in electron microscopic stacks. The
UNet architecture consists of 3 sections - the contraction, the bottleneck and
the expansion section. The contraction section consists of multiple contraction
blocks made up of convolutional and pooling layers. The bottleneck layer, that
mediates between the contraction and expansion sections, also consists of convolutional layers. The expansion section consists of multiple expansion blocks.
These layers of convolutional and upsampling layers. Each expansion layer is
appended by the corresponding feature maps in the contraction layers. This is
what allows the architecture to preserve low level information required for accurately segmenting detailed images common in medical imaging. The UNet++
architecture, introduced in 2019 is an improvement over the UNet architecture.
It uses the idea of Dense blocks from the DenseNet architecture (Iandola et al.
(2014)) to improve performance. It differs from the original UNet in three ways.
It consists of convolutional layers on skip pathways connecting the contraction
and expansion layers. The skip connections have dense connections that improve
gradient flow. They are also trained with dense supervision, that enables model
pruning. The UNet++ architecture generates high resolution feature maps at
multiple semantic levels. In addition the loss is estimated at four semantic levels.
The UNet++ model achieves significant performace gain over UNet. InfNet is
a segmentation network has been designed specifically for segmentation of lung
infection caused by COVID-19 in CT scans. It consists of a parallel partial
decoder that is used to aggregate a global feature map. Reverse attention and
edge attention is used to model the boundaries to improve performance. They
also introduce a semi supervised framework , COVID-SemiSeg to demonstrate
state of the art performance on COVID CT data.

8

3.2. Emergent Languages

Figure 3: Original emergent language framework. The Lewis signalling game involves a Sender
and a Receiver. The Sender observes the target image and sends a symbol to the Receiver.
The Receiver observes the target image, the Receiver and the symbol and the task of the
Receiver is to pick out the target image correctly.

Fig. 3 shows the original emergent language framework that was developed to solve the cooperative referential Lewis Signalling game (Lazaridou et al.
(2016)). The basic setup involves a sender architecture, a symbol generator and
receiver architecture. The sender can be any network that extracts feature representations from input data. The sender sends the feature representations to
the symbol generator where symbols are generated. These symbols are then
fed to a receiver network that performs the classification. The only information
that flows from the sender to the receiver are discrete representations instead
of continuous features. In Fig. 3, the target image is an example of a CT scan
of a brain with an indication. The sender generates a symbol using the symbolic generator. This symbol is then forwarded to the receiver network that

9

observes the symbol, the target image and a distractor image (a normal CT
scan of the brain). Using only the information in the symbol, the receiver must
correctly guess distinguish the target image from the distractor image. In this
work, we implemented a variant for Sender and Receiver networks as reported
in Havrylov and Titov (2017), using stacked LSTM models (Hochreiter and
Schmidhuber (1997)). The sender receiver emergent language module is shown
in Fig. 4. The module in the middle consists of the Sender and Receiver LSTM
models.
The input to the Sender Network is a tensor x that can be the feature
representation of the input image I. A token < S > represents the start of the
message. The input is passed to a stacked LSTM network after performing a
linear transformation. The initial hidden state and the cell state, represented
as hs0 and cs0 are initialized to zero. The LSTM samples a single symbol from a
categorical distribution w Cat(pnv ), where pnv are the probabilities with respect
to the symbols in the vocabulary V at interation n. This operation is not differentiable and therefore gradients cannot be estimated for the backpropagation
algorithm. The Gumble-Softmax (GS) trick )Jang et al. (2016)) is therefore
used to relax the categorical distribution. We estimate a symbol or word wi is
sampled at each iteration n according to Eq. 1.
exp(log(pni ) + gi )/τ
wi = Gτ (pni ) = Pv
n
j=1 exp(log(pj ) + gj )/τ

(1)

τ is the temperature parameter that regulates the GS operator Gτ . The output of the sender is the final hidden state hsn+1 that encodes the sentence as
a sequence of words wi as hsn+1 = LST M (wi , hsn , csn ). At inference time, we
do not apply the GS operator (Jang et al. (2016)) and normal categorical sampling is done, thus making hsn+1 fully deterministic. The generated sentence is
represented as Sn = Sender(x).
The Receiver network is implemented as a standard LSTM model unlike
the Sender. The input to the Receiver is the final hidden state of the Sender that
encodes the sentence Sn . We encode the catgorical variable as a one-hot vector

10

during inference to generate a deterministic output. The initial hidden state hr0
and cell state cr0 are set to zero initially. A linear transformation Linear(hrn+1 )
is applied to the Receiver’s last hidden state. The Sender and Receiver are
encouraged to develop a communication protocol using the vocabulary provided
to it in the form of sentences generated from the Sender LSTM. If the training
is successful, which means that the optimization has converged, we conclude
that a new emergent language has been produced. The output of the receiver
is x0 = Receiver(Sn ).

Figure 4: SUNet segmentation architecture. The architecture consists of the baseline UNet
model. The EL module takes as input the outut of the linear layer. The Receiver LSTM
generates an output, that is concatenated with the output of the UNet and fed to a convolution
layer and Sigmoid that generates the segmentation mask.

3.3. Symbolic semantic segmentation
We present our Symbolic Semantic Segmentation framework for simultaneous generation of segmentation maps and emergent language. This is shown in
Fig. 2.
We demonstrate the symbolic framework using emergent languages on each
of the segmentation architectures detailed above - UNet, UNet and InfNet.
We denote their symbolic counterparts as Symbolic UNet (SUNet), Symbolic
11

UNet++ (SUNet++) and Symbolic InfNet (SInfNet). For purposes of demonstration, we show the SUNet architecture in 4. We omit the final Sigmoid
function in left of Fig. 4 to generate an output x. The Emergent Language
framework (middle) is used to generate another output x0 . The output feature maps are combined by concatenation and applying the Sigmoid function
(right). The training of the entire symbolic neural network is done end-to-end
using stochastic gradient descent for backpropagation. When the optimization
converges, we conclude that an interpretable symbolic language has emrged.
The architectures of SUNet++ and InfNet are identical except for the base architecture. Instead of UNet in Fig. 4, we replace with UNet++ and InfNet
respectively.

4. Experiments and Results
We detail the experiments and results of our symbolic semantic segmentation
framework.
4.1. Datasets
In this work, we use volumetric CT scans from 2 different data sources Radiopaedia (2020 (accessed May 30, 2020) and Jun et al.. We demonstrate our
symbolic segmentation framework on 20 volumes from Jun et al. and 9 axial
volumes from (Radiopaedia (2020 (accessed May 30, 2020)). The 9 volumes
from Radiopaedia (2020 (accessed May 30, 2020) consist of both positive and
negative COVID indications. The annotations have been created and segmented
by a radiologist. An example of a slice from a positive scan is shown in Fig.
5 (right). The 20 volumes from Jun et al. consist of infections labelled by
two radiologists and they have been verified by another experienced radiologist.
They consist of segmentations of left lung, right lung and infections. However, in
this work we only use the infection annotation. We use 26 volumes for training
and 3 volumes for testing our results.

12

(a) Example of data from Jun et al.

(b) Example of data from Radiopaedia
(2020 (accessed May 30, 2020)

Figure 5: Example of CT data. The lung infections are shown as white overlays inside the
lung in the CT slice. The CT data is gathered from two different sources. Preprocessing is
performed in order to normalize the differences in appearance of the disparate data sources.

4.2. Pre-processing
An example is shown in Fig. 5(left). There are fundamental differences in
the appearance of data from the two cohorts. For example, one of them is in
16 bit and the other is encoded in 8 bits. The intensity profile of each cohort
is different as shown in Fig. 5. Substantial preprocessing therefore needs to be
done for our analysis. A number of steps were applied prior to training. All the
volumes contained a segmentation mask for lung and COVID-19 infected lung
tissue. First, we cropped all volumes by having a distance of 20 voxels from
the lung along the x − y axis. Given that we have heterogenous datasets, we
normalized all volumes according to Buda et al. (2019) in the following manner:
First, images were normalized to mean and standard deviation and standardized
to have a maximum value of one. To account for images of different sizes, first
we introduce zero padding to make images of same size in x and y. Then, every
2D slice was resized to 400x400 pixel units in the x − y axis.
4.3. Experimental setup
We train a total of 6 different architectures. 3 are the baseline segmentation
architectures - UNet, UNet++ and InfNet. The remaining 3 are their symbolic
13

counterparts - SUNet, SUNet++ and SInfNet. The architectures of each of the
Symbolic networks are constructed according to Figs. 2 and 4.
For each of the symbolic networks, we perform ablation experiments where
we vary the the sentence length NS ∈ 8, 16 and vocabulary size V ∈ 1000, 10000.
We observe that the setting of NS = 8 and V = 1000 provide the best results.
The results of this analysis is shown in Table 4.4. We use the default settings
from each of the baseline architectures as described in the respective publications. The batch size for the experiments is set as 16, the number of epochs
for training is 300, with early stopping on validation loss with a patience of 20
epochs. The learning rate was set at 5e − 5 The images are resized to 400x400.
The data is augmented using random rotation between -5 to +5 degrees and the
scale is varied from a factor 0.97 to 1.03. The Sender and Receiver embedding
dimensions are set at 512.
4.4. Results and discussions
Table 1 shows the comparisons of segmentation metrics for each of the 6
architectures. We use Dice coefficient, Structure measure and Mean Absolute
error (MAE) to measure the quality of segmentation (Thoma (2016)). The
dice score and structure measure computes the amount of overlap between the
prediction and the ground truth, so a higher number indicates a better segmentation. The mean absolute error measures the amount of dissimilarity between
the output of the model and the ground truth so a lower value is preferable.

We observe from Table 1 that InfNet performs the best among baseline models.
UNet++ does better that Unet which is expected. The important point to
note is that each of the symbolic models perform better than their baseline
counterparts, with the best performance overall being observed in SinfNet.

14

Experiment

Dice score

Structure

MAE

measure
UNet

0.46

0.77

1.01

SUNet

0.71

0.83

0.74

UNet++

0.73

0.84

0.72

SUNet++

0.75

0.84

0.67

InfNet

0.75

0.85

0.71

SInfNet

0.77

0.85

0.63

Table 1: Segmentation results comparison with baselines. The best performance is obtained
using the Symbolic InfNet architecture (SInfNet) with a Dice score of 0.77. The symbolic
versions of the architecture show significant improvement in performance over their baseline
counterparts.

15

Figure 6: Segmentation results comparison with baselines. Each column represents a random CT slice with the ground truth and prediction. The rows are in the same order as
1, UNet(first), SUNet(second), UNet++(third), SUNet++(fourth), InfNet(fifth),
SInfNet(sixth). We observe that the quality of the predictions improve as we go from the
first to the last row. We also observe that the outputs of the Symbolic network are significantly
better than their baseline architectures

Fig. 6 visualizes the outputs for each of the 6 architectures in the same order
as Table 1. We qualitatively observe the same results as we found from the
metrics in Table 1. SinfNet shows the best quality of segmentation overall, and
each of the symbolic networks perform significantly better than their baseline
deep networks.
Fig. 7 shows the variation of the symbols generated from slices of chest
CT with the presence and absence of COVID infections. We observe that the
symbols seem to be different for every slice. Each symbol represents one or more
phenotypic characteristics and features of the input image and the shape and

16

appearance of infections in the output mask. For example, the 5th symbol in
Fig. 7(b) seems to correlate with the presence or absence of COVID-19 infection.

(a) Examples of from symbols of CT from cohort in Jun et al.

(b) Examples of from symbols of CT from cohort in Radiopaedia (2020 (accessed May 30, 2020)
Figure 7: Example of symbols for individual volumetric CT slices from the different cohorts.
The final column represents the cohort and the penultimate column shows the presence
or absence of COVID-19. The symbols are shown in the remaining columns. We oserve
that the symbols are different for each CT slice. Similarity of the symbols indicate similarity
in the features of input and outputs. Dissimilarity could denote a difference in the appearance
of the infections or the input image.

Fig. 8 shows segmentation outputs with the corresponding symbols. We
observe that there appears to be semantically uniquely symbols or words that
define a particular segmentation map. Each symbol embodies one or more
semantically meaningful attributes of the masks. There appears to be certain
symbols that correlate with the shape, size and locations of each of local areas
of infection in the lung. For example, in Row 1 (SUNet outputs), the symbol
512 seems to correspond to small infection areas on the right lung. In Row
2 (SUNet++ outputs), the symbol 579 also appears on 3 of the segmentation
maps. They could indicate small areas of infection. Row 3 corresponds to

17

SInfNet outputs and the symbol 573 appears to be common between the first
and third image.

(a) 595 428 475 497

(b) 779 54 497 497

(c) 512 69 69 428

(d) 512 185 138 428

(e) 579 472 10 670

(f) 579 469 312 670

(g) 776 619 10 622

(h) 579 469 596 596

(i) 573 618 618 618

(j) 176 618 277 439

(k) 573 319 439 632

(l) 169 210 439 618

Figure 8: Sampling of segmentation maps and the generated symbols. Here we only show
the first 4 symbols out of 8 symbols, because they capture the most important features.
Each row represents the 3 symbolic architectures. The First row (SUNet) shows different
types of segmentation output maps. We observe that the symbols represent different types
of output maps. The symbol 512 appears to represent small maps to the left of the image.
The Second row (SUNet++) shows how the symbol 579 seems to represent smaller and
scattered infections. The Third row (SInfNet) shows different symbols for different types
of infection scattering in the lungs.

An important consideration of all empirical work are ablation experiments.
We show the performance of our symbolic semantic segmentation framework

18

with respect to the important parameters of the emergent language, i.e. the
length of the sentences (NS ) and the vocabulary size (V ). Results of the ablation
experiments are shown in the following table.

Experiment

SUNet

SUNet++

SInfNet

Dice

Structure

score

measure

NS = 8, V = 1000

0.72

0.83

0.74

NS = 8, V = 10000

0.71

0.82

0.77

NS = 16, V = 1000

0.72

0.82

0.74

NS = 16, V = 10000

0.72

0.82

0.74

NS = 8, V = 1000

0.75

0.84

0.67

NS = 8, V = 10000

0.73

0.84

0.69

NS = 16, V = 1000

0.74

0.83

0.68

NS = 16, V = 10000

0.74

0.83

0.68

NS = 8, V = 1000

0.77

0.85

0.63

NS = 8, V = 10000

0.76

0.85

0.67

NS = 16, V = 1000

0.76

0.84

0.67

NS = 16, V = 10000

0.75

0.85

0.68

Parameters

MAE

Table 2: Ablation experiments. We show the ablation experiments by varying the sentence
length of the symbols NS = 8, 16 and vocabulary V = 1000, 10000. We observe that the
results are quite robust with respect to the parameters of the emergent language with a
marginal performance improvement with the combination of NS = 8 and V = 1000

.

Table 2 shows the results of the ablation experiments. We observe here that
the symbolic semantic framework is robust when we vary the crucial parameters
of the emergent language layer, NS and V . In general for each of the 3 Symbolic
models, we see that the combination NS = 8 and V = 1000 appear to perform
the best. We therefore use this combination when presenting the results in
19

Table 1. Also, this means that there is no additional information being added
by increasing the sentence length and vocabulary size and NS = 8 and V = 1000
are approximately optimal.

Parameters
Experiment

SUNet

SUNet++

SInfNet

COVID Presence

COVID Area

NS

V

S∗

2
RMcFadden

S∗

r2

8

1000

S3

0.21

S3

0.43

8

10000

S4

0.43

S4

0.63

16

1000

S4

0.28

S1

0.52

16

10000

S3

0.24

S1

0.43

8

1000

S3

0.32

S3

0.42

8

10000

S2

0.25

S4

0.43

16

1000

S2

0.33

S2

0.66

16

10000

S3

0.46

S3

0.74

8

1000

S2

0.19

S4

0.40

8

10000

S2

0.53

S1

0.50

16

1000

S4

0.40

S3

0.48

16

10000

S1

0.52

S1

0.66

Table 3: Results from logistic (COVID Presence) and linear (COVID Area) regression analyses using individual symbols as independent variables. Model performance is captured via
McFadden’s pseudo-R2 for logistic regression (values between 0.2 and 0.4 indicate excellent
fit) and squared Pearson correlation coefficient for linear regression. The S ∗ column indicates
which symbol in the sequence was most predictive of the corresponding measurement type.

Results from Table 6 and Fig. 6 indicate that symbolic expressions can be
used to successfully predict segmentation masks of lung infections in Chest CT
data. Those symbols also appear to be informative according to the qualitative
results depicted in Fig. 8. We performed further regression analyses to detemine
whether individual symbols could predict the presence or absence of COVID and
20

morphology (area) occupied by the infection. Specifically, we examined which
expression symbol (i.e. first, second, etc.) is best at predicting the outcome of
all candidate models. The results from the analysis are shown in Table 3.
The statistical model used to predict each outcome varied. For binary data
(presence or absence of COVID-19), a binary logistic regression model was
used. The linear regression was performed on data where an infection was
present. We report squared Pearson correlation coefficient R2 (Benesty et al.
(2009)) values for continuous outcomes and McFaddens pseudo-R2 (Veall and
Zimmermann (1994)) for categorical outcomes. Results indicate very high correlations between expression symbols and COVID presence and area, especially
in models where a large vocabulary size was used. Optimal predictions for
COVID presence were found using the second symbol in the expression (SInfNet
model), whereas optimal predictions for area were found using the third symbol
(SUNet++ model). All outcomes were best explained using a vocabulary size of
10000, although optimal sentence length seemed to vary between models. Taken
together, the current results demonstrate that emergent language expressions
generated in each of the proposed models carry a wealth of information about
key concepts in medical imagery.
4.5. Limitations and future work
Even though we introduce symbolic representations, the deep networks do
not automatically become completely interpretable and transparent. However,
our work is a first of it’s kind towards combining the power of statistical deep
learning with the interpretable capacity of symbolic methods for medical imaging, particularly for segmentation of lung CT infections. It is no doubt that
the sentences carry semantic information. We demonstrate preliminary methods of regression and qualitative analysis to try and interpret the meaning of
the symbols. There are other sophisticated methods that maybe used to assign
meaning and understand how the symbols interact with the input, output and
with each other.
One avenue of future work, is to use saliency maps based notions of inter21

pretability (Selvaraju et al. (2017)). In essence, we would be able to map what
each symbol represents with respect to regions in the input image. Another
approach is to use the symbolic sentences in conjunction with natural language
(Lee et al. (2017)), where we map the symbols and the vocabulary to a form of
human understandable language like English.

5. Conclusion
The COVID-19 pandemic has brought the entire world to a standstill. We
desperately need all the help we can to combat the disease. In order to fully
understand and diagnose the disease, doctors use medical imaging modalities
like CT to identify and characterize lung infections in possible COVID infected
patients. Automated segmentation plays a big part in assisting radiologists to
localize infections efficiently. In this work, we demonstrate how we can use
symbolic semantic segmentation to segment lung infections with a high degree
accuracy and interpretability. Our symbolic segmentation framework is built on
top of LSTM based emergent languages. Using this framework, we are able to
co-generate semantic segmentation maps and interpretable symbolic sentences.
We show state-of-the art segmentation performance on CT data obtained
from two cohorts. Moreover, we demonstrate the symbolic segmentation framework is flexible and can be used to augment any segmentation model to provide
significant boost in performance. The Symbolic InfNet (SInfNet) model that
is built on top of the InfNet architecture achieves state-of-the-art Dice score
of 0.77 on the validation data. We also show that each of the base models
that we augment using the symbolic semantic segmentation framework (SUNet,
SUNet++ and SInfNet) show significant increase in performance with respect
to their baseline counterparts (UNet, UNet++ and InfNet respectively). These
results are detailed in Table 1.
Additionally, we show how the symbols maybe used as a tool for interpreting
segmentation maps. Traditional deep learning systems are inherently blackbox
in nature due to the continuous nature of their internal feature representations.

22

The sentences generated from the segmentation can be used to analyse and query
the model and quantify individual aspects and features of the segmentation
masks. In Fig. 8 we show how the symbols vary with respect to the appearance
of the infections as observed on the segmentation masks. In addition, in Table
3, we show how the symbols are correlated with phenotypes such as the area and
presence of the COVID infection. Therefore, we consider our symbolic semantic
segmentation framework to provide a different paradigm of deep learning based
segmentation, where we use the emergent symbolic language to understand and
interpret the models with respect to the inputs and outputs.

References
Ai, T., Yang, Z., Hou, H., Zhan, C., Chen, C., Lv, W., Tao, Q., Sun, Z., Xia, L.,
2020. Correlation of chest ct and rt-pcr testing in coronavirus disease 2019
(covid-19) in china: a report of 1014 cases. Radiology , 200642.
Andersen, K.G., Rambaut, A., Lipkin, W.I., Holmes, E.C., Garry, R.F., 2020.
The proximal origin of sars-cov-2. Nature medicine 26, 450–452.
Anthimopoulos, M., Christodoulidis, S., Ebner, L., Geiser, T., Christe, A.,
Mougiakakou, S., 2018. Semantic segmentation of pathological lung tissue
with dilated fully convolutional networks. IEEE journal of biomedical and
health informatics 23, 714–722.
Benesty, J., Chen, J., Huang, Y., Cohen, I., 2009. Pearson correlation coefficient,
in: Noise reduction in speech processing. Springer, pp. 1–4.
Buda, M., Saha, A., Mazurowski, M.A., 2019. Association of genomic subtypes
of lower-grade gliomas with shape features automatically extracted by a deep
learning algorithm. Computers in Biology and Medicine 109. doi:10.1016/
j.compbiomed.2019.05.002.
Chen, J., Wu, L., Zhang, J., Zhang, L., Gong, D., Zhao, Y., Hu, S., Wang,
Y., Hu, X., Zheng, B., et al., 2020. Deep learning-based model for detecting

23

2019 novel coronavirus pneumonia on high-resolution computed tomography:
a prospective study. medRxiv .
Cheng, J.Z., Ni, D., Chou, Y.H., Qin, J., Tiu, C.M., Chang, Y.C., Huang, C.S.,
Shen, D., Chen, C.M., 2016. Computer-aided diagnosis with deep learning architecture: applications to breast lesions in us images and pulmonary nodules
in ct scans. Scientific reports 6, 1–13.
Chowdhury, A., Kubricht, J.R., Sood, A., Tu, P., Santamaria-Pang, A., 2020.
Escell: Emergent symbolic cellular language, in: 2020 IEEE 17th International Symposium on Biomedical Imaging (ISBI), IEEE. pp. 1604–1607.
Cogswell, M., Lu, J., Lee, S., Parikh, D., Batra, D., 2019. Emergence of
compositional language with deep generational transmission. arXiv preprint
arXiv:1904.09067 .
Devaraj, C., Chowdhury, A., Jain, A., Kubricht, J.R., Tu, P., Santamaria-Pang,
A., 2020. From symbols to signals: Symbolic variational autoencoders, in:
ICASSP 2020-2020 IEEE International Conference on Acoustics, Speech and
Signal Processing (ICASSP), IEEE. pp. 3317–3321.
Dong, E., Du, H., Gardner, L., 2020. An interactive web-based dashboard to
track covid-19 in real time. The Lancet infectious diseases 20, 533–534.
Fan, D.P., Zhou, T., Ji, G.P., Zhou, Y., Chen, G., Fu, H., Shen, J., Shao, L.,
2020. Inf-net: Automatic covid-19 lung infection segmentation from ct scans.
arXiv preprint arXiv:2004.14133 .
Gordaliza, P.M., Muñoz-Barrutia, A., Abella, M., Desco, M., Sharpe, S., Vaquero, J.J., 2018. Unsupervised ct lung image segmentation of a mycobacterium tuberculosis infection model. Scientific reports 8, 1–10.
Havrylov, S., Titov, I., 2017. Emergence of language with multi-agent games:
Learning to communicate with sequences of symbols, in: Advances in neural
information processing systems, pp. 2149–2159.

24

Hochreiter, S., Schmidhuber, J., 1997. Lstm can solve hard long time lag problems, in: Advances in neural information processing systems, pp. 473–479.
Hu, Z., Ge, Q., Jin, L., Xiong, M., 2020. Artificial intelligence forecasting of
covid-19 in china. arXiv preprint arXiv:2002.07112 .
Iandola, F., Moskewicz, M., Karayev, S., Girshick, R., Darrell, T., Keutzer, K.,
2014. Densenet: Implementing efficient convnet descriptor pyramids. arXiv
preprint arXiv:1404.1869 .
Jang, E., Gu, S., Poole, B., 2016. Categorical reparameterization with gumbelsoftmax. arXiv preprint arXiv:1611.01144 .
Jin, D., Xu, Z., Tang, Y., Harrison, A.P., Mollura, D.J., 2018. Ct-realistic
lung nodule simulation from 3d conditional generative adversarial networks
for robust lung segmentation, in: International Conference on Medical Image
Computing and Computer-Assisted Intervention, Springer. pp. 732–740.
Jun, M., Cheng, G., Yixin, W., et al., . Covid-19 ct lung and infection segmentation dataset. 2020.
Lazaridou, A., Hermann, K.M., Tuyls, K., Clark, S., 2018. Emergence of linguistic communication from referential games with symbolic and pixel input.
arXiv preprint arXiv:1804.03984 .
Lazaridou, A., Peysakhovich, A., Baroni, M., 2016. Multi-agent cooperation
and the emergence of (natural) language. arXiv preprint arXiv:1612.07182 .
Lee, J., Cho, K., Weston, J., Kiela, D., 2017. Emergent translation in multiagent communication. arXiv preprint arXiv:1710.06922 .
London, A.J., 2019. Artificial intelligence and black-box medical decisions: accuracy versus explainability. Hastings Center Report 49, 15–21.
Radiopaedia, 2020 (accessed May 30, 2020). www.radiopaedia.org. URL: https:
//radiopaedia.org/articles/covid-19-3.

25

Rajinikanth, V., Dey, N., Raj, A.N.J., Hassanien, A.E., Santosh, K., Raja, N.,
2020. Harmony-search and otsu based system for coronavirus disease (covid19) detection using lung ct scan images. arXiv preprint arXiv:2004.03431
.
Ronneberger, O., Fischer, P., Brox, T., 2015. U-net: Convolutional networks
for biomedical image segmentation, in: International Conference on Medical
image computing and computer-assisted intervention, Springer. pp. 234–241.
Rubin, G.D., Ryerson, C.J., Haramati, L.B., Sverzellati, N., Kanne, J.P., Raoof,
S., Schluger, N.W., Volpi, A., Yim, J.J., Martin, I.B., et al., 2020. The role
of chest imaging in patient management during the covid-19 pandemic: a
multinational consensus statement from the fleischner society. Chest .
Samek, W., Wiegand, T., Müller, K.R., 2017. Explainable artificial intelligence: Understanding, visualizing and interpreting deep learning models.
arXiv preprint arXiv:1708.08296 .
Santamaria-Pang, A., Kubricht, J.R., Chowdhury, A., Bhushan, C., Tu, P.,
2020. Towards emergent language symbolic semantic segmentation and model
interpretability.
Santamaria-Pang, A., Kubricht, J.R., Devaraj, C., Chowdhury, A., Tu, P., 2019.
Towards semantic action analysis via emergent language, in: 2019 IEEE International Conference on Artificial Intelligence and Virtual Reality (AIVR),
IEEE. pp. 224–2244.
Selvaraju, R.R., Cogswell, M., Das, A., Vedantam, R., Parikh, D., Batra, D.,
2017. Grad-cam: Visual explanations from deep networks via gradient-based
localization, in: Proceedings of the IEEE international conference on computer vision, pp. 618–626.
Senior, A.W., Evans, R., Jumper, J., Kirkpatrick, J., Sifre, L., Green, T., Qin,
C., Žı́dek, A., Nelson, A.W., Bridgland, A., et al., 2020. Improved protein
structure prediction using potentials from deep learning. Nature , 1–5.
26

Shen, S., Bui, A.A., Cong, J., Hsu, W., 2015. An automated lung segmentation approach using bidirectional chain codes to improve nodule detection
accuracy. Computers in biology and medicine 57, 139–149.
Sheridan, C., 2020. Fast, portable tests come online to curb coronavirus pandemic. Nat Biotechnol 10.
Shi, F., Wang, J., Shi, J., Wu, Z., Wang, Q., Tang, Z., He, K., Shi, Y., Shen,
D., 2020a. Review of artificial intelligence techniques in imaging data acquisition, segmentation and diagnosis for covid-19. IEEE Reviews in Biomedical
Engineering .
Shi, F., Xia, L., Shan, F., Wu, D., Wei, Y., Yuan, H., Jiang, H., Gao, Y.,
Sui, H., Shen, D., 2020b. Large-scale screening of covid-19 from community
acquired pneumonia using infection size-aware classification. arXiv preprint
arXiv:2003.09860 .
Sluimer, I., Schilham, A., Prokop, M., Van Ginneken, B., 2006. Computer analysis of computed tomography scans of the lung: a survey. IEEE transactions
on medical imaging 25, 385–405.
Tang, Z., Zhao, W., Xie, X., Zhong, Z., Shi, F., Liu, J., Shen, D., 2020. Severity
assessment of coronavirus disease 2019 (covid-19) using quantitative features
from chest ct images. arXiv preprint arXiv:2003.11988 .
Thoma, M., 2016.

A survey of semantic segmentation.

arXiv preprint

arXiv:1602.06541 .
Veall, M.R., Zimmermann, K.F., 1994. Evaluating pseudo-r 2’s for binary probit
models. Quality and Quantity 28, 151–164.
Wang, C., Horby, P.W., Hayden, F.G., Gao, G.F., 2020a. A novel coronavirus
outbreak of global health concern. The Lancet 395, 470–473.
Wang, S., Kang, B., Ma, J., Zeng, X., Xiao, M., Guo, J., Cai, M., Yang, J.,
Li, Y., Meng, X., et al., 2020b. A deep learning algorithm using ct images to
screen for corona virus disease (covid-19). MedRxiv .
27

Wang, S., Zhou, M., Liu, Z., Liu, Z., Gu, D., Zang, Y., Dong, D., Gevaert, O.,
Tian, J., 2017. Central focused convolutional neural networks: Developing a
data-driven model for lung nodule segmentation. Medical image analysis 40,
172–183.
Wu, Y.H., Gao, S.H., Mei, J., Xu, J., Fan, D.P., Zhao, C.W., Cheng, M.M.,
2020. Jcs: An explainable covid-19 diagnosis system by joint classification
and segmentation. arXiv preprint arXiv:2004.07054 .
Ye, Z., Zhang, Y., Wang, Y., Huang, Z., Song, B., 2020. Chest ct manifestations
of new coronavirus disease 2019 (covid-19): a pictorial review. European
Radiology , 1–9.
Zhou, Z., Siddiquee, M.M.R., Tajbakhsh, N., Liang, J., 2018. Unet++: A
nested u-net architecture for medical image segmentation, in: Deep Learning
in Medical Image Analysis and Multimodal Learning for Clinical Decision
Support. Springer, pp. 3–11.

28

