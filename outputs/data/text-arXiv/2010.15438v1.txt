Modeling and Control of COVID-19 Epidemic through
Testing Policies?

arXiv:2010.15438v1 [math.OC] 29 Oct 2020

Muhammad Umar B. Niazia,∗, Alain Kibangoua , Carlos Canudas-de-Wita ,
Denis Nikitina , Liudmila Tumasha , Pierre-Alexandre Blimanb
a Univ.

Grenoble Alpes, CNRS, Inria, Grenoble INP, GIPSA-Lab, 38000 Grenoble, France.
Université, Université Paris-Diderot SPC, Inria, CNRS, Laboratoire
Jacques-Louis Lions, équipe Mamba, 75005 Paris, France.

b Sorbonne

Abstract
Testing for the infected cases is one of the most important mechanisms to control an epidemic. It enables to isolate the detected infected individuals, thereby
limiting the disease transmission to the susceptible population. However, despite the significance of testing policies, the recent literature on the subject
lacks a control-theoretic perspective. In this work, an epidemic model that incorporates the testing rate as a control input is presented. The proposed model
differentiates the undetected infected from the detected infected cases, who are
assumed to be removed from the disease spreading process in the population.
First, the model is estimated and validated for COVID-19 data in France. Then,
two testing policies are proposed, the so-called best-effort strategy for testing
(BEST) and constant optimal strategy for testing (COST). The BEST policy is
a suppression strategy that provides a lower bound on the testing rate such that
the epidemic switches from a spreading to a non-spreading state. The COST
policy is a mitigation strategy that provides an optimal value of testing rate that
minimizes the peak value of the infected population when the total stockpile of
tests is limited. Both testing policies are evaluated by predicting the number
of active intensive care unit (ICU) cases and the cumulative number of deaths
due to COVID-19.
Keywords: COVID-19, Testing, Model design, Model validation, Parameter
estimation, Control policies.

? This work is partially supported by European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation programme (ERCAdG no. 694209,
Scale-FreeBack, website: http://scale-freeback.eu/) and by Inria, France, in the framework of the COVID-19 fast-track research program.
∗ Corresponding author
Email addresses: muhammad-umar-b.niazi@inria.fr (Muhammad Umar B. Niazi),
alain.kibangou@univ-grenoble-alpes.fr (Alain Kibangou),
carlos.canudas-de-wit@gipsa-lab.fr (Carlos Canudas-de-Wit),
denis.nikitin@gipsa-lab.fr (Denis Nikitin), liudmila.tumash@gipsa-lab.fr (Liudmila
Tumash), pierre-alexandre.bliman@inria.fr (Pierre-Alexandre Bliman)

Preprint submitted to Elsevier

October 30, 2020

1. Introduction
The COVID-19 epidemic started in Wuhan, China, at the end of 2019, was
declared to be a pandemic by the World Health Organization (WHO) on March
11, 2020. The most common symptoms of the disease include fever, cough, fatigue, shortness of breath, and loss of the sense of smell, where complications
may include pneumonia and respiratory distress known as a severe acute respiratory syndrome (SARS). At the time of writing this paper, the primary mode
of treatment has been symptomatic and supportive therapy [1, 2], and there has
been no approved vaccine or specific antiviral treatment.
The pandemic shook the economy of the whole world with a significant reduction of exports, a decline in tourism, mass unemployment, and business
closures [3]. Governments and health authorities worldwide have responded
by implementing non-pharmaceutical intervention (NPI) policies that include
travel restrictions, lockdown strategies, social distancing measures, workplace
hazard controls, closing down of schools and workplaces, curfew strategies, and
cancellation of public events. Many countries have also upgraded existing infrastructure and personnel to increase testing capabilities and facilities for focused
isolation. The public has been instructed to wash hands several times a day,
cover mouth and nose when coughing or sneezing, maintain a certain physical
distance from other people, wear a face mask in public places/gatherings, and
to monitor and self-isolate if one suspects herself/himself to be infected. The
extent to which such policies and measures have been implemented in a certain
country is called the stringency index of its government’s response [4, 5]. Each
government responded in its capacity to find a suitable balance between saving lives and saving livelihoods, which [6] termed as a problem of health versus
wealth. Livelihoods can be saved through the implementation of suitable relief and recovery measures for people and small businesses. On the other hand,
lives can be saved through the implementation of good testing and NPI policies.
In other words, there is a direct relation between the stringency index of the
government and ‘saving lives’.
All the above strategies and policies implemented by the governments are
considered to be the control mechanisms for the epidemic. Such strategies fall
under two categories: mitigation and suppression [7, 8]. The mitigation strategies slow down the rate of transmission of disease or, in other words, ‘flatten
the curve.’ However, they do not necessarily stop the spreading of the disease, which is the goal of suppression strategies. Given the required objectives
(e.g., minimizing the number of deaths caused by the epidemic) and constraints
(e.g., socio-economic costs), the problem of finding optimal strategies has been
recently studied through the framework of optimal control theory.
1.1. Literature review
To understand, predict, and control the evolution of the COVID-19 epidemic,
a huge effort has been devoted by the researchers to design models as accurate
and as effective as possible. Each model, by and large, is a variant and/or an extension of SIR (susceptible, infected, recovered) and SEIR (susceptible, exposed,
2

infected, recovered) models, which describe the flow of population through three
or four mutually exclusive stages of infection, respectively (see [9] and [10] for a
comprehensive review). These basic models have few parameters that are easy
to identify [11], and are considered as population models that view the epidemic
from the macroscopic perspective. This is in contrast with the approaches that
capture heterogeneity of population structure such as network epidemic models [12, 13, 14] or metapopulation epidemic models [15, 16, 17], that view the
epidemic from the microscopic perspective. In what follows, however, we study
the epidemic through the macroscopic perspective of population models.
Following the outbreak of COVID-19, there has been an effort to produce
comprehensive population models with a focus on different facets of the epidemic. Such models are more complex than simple SIR and SEIR, and include
several intermediate stages that accurately portray the dynamics of the epidemic. For instance, [18] develops an extension of the SEIR model that incorporates the governmental actions (e.g., preventive measures and restrictions)
and the individual behavioral reactions, whereas [19] develops an extension of
the SIR model that incorporates the number of deaths due to the epidemic. Another quite interesting model is the one developed in [20] that considers an eightcompartment model called SIDARTHE, which includes eight stages of infection:
susceptible (S), infected (I), diagnosed (D), ailing (A), recognized (R), threatened (T), healed (H), and extinct (E). A distinguishing feature of this model
is that it differentiates between the infected individuals based on the severity
of their symptoms and whether they are diagnosed by a health authority. It is
crucial, as also emphasized in [21, 22], to differentiate between diagnosed and
undiagnosed individuals because the former are typically isolated and are less
likely to spread the infection. Similar models have been adopted and extended
to study optimal control policies for the epidemic such as the implementation
of social distancing measures [23, 24, 25], lockdown strategies [26, 27, 28], and
heterogeneous policy responses based on age-groups [29, 30].
In addition to the above NPI strategies, testing and isolating the infected
population from the susceptible population is one of the most important strategies to control the epidemic spread. For instance, it has been reported that
COVID-19 was eliminated from the Italian village Vo’Euganeo through testing
both symptomatic and asymptomatic cases [31, 32]. Moreover, on his media
briefing1 of March 16, 2020, Dr. Tedros Adhanom Ghebreyesus, the DirectorGeneral of WHO, urged the following:
“Social distancing measures can help to reduce transmission and enable health systems to cope. Hand-washing and coughing into your
elbow can reduce the risk for yourself and others. But on their own,
they are not enough to extinguish this pandemic. It’s the combination that makes the difference. As I keep saying, all countries must
take a comprehensive approach. But the most effective way to pre1 Website:

WHO Director-General Speech of March 16, 2020. (Accessed 04/06/2020)

3

vent infections and save lives is breaking the chains of transmission.
And to do that, you must test and isolate. You cannot fight a fire
blindfolded. And we cannot stop this pandemic if we don’t know who
is infected. We have a simple message for all countries: TEST,
TEST, TEST.”
COVID-19 can be detected through two types of tests known as type-1 (RTPCR) and type-2 (serology). In the type-1 test, a swab is inserted into the
subject’s nose to qualitatively detect nucleic acid from SARS-CoV-2 in the upper
and lower respiratory specimens [33], which enables one to detect whether the
subject is currently infected with COVID-19. Type-2 test, on the other hand,
is a serum test in order to detect relevant antibodies, which enables one to
know whether the subject was infected in the past with COVID-19 and now
he/she has recovered. Both types of tests are important in the control of an
epidemic. Type-1 tests help to limit the disease spread by the identification
of infected individuals and their contact tracing [34]. Type-2 tests, on the
other hand, are useful in reducing the size of the testable population for type1 tests [35] that helps to increase the testing specificity. However, the type-1
test, up to now, is considered to be the only recommended method for the
identification and laboratory confirmation of COVID-19 cases according to the
WHO [36]. Moreover, only type-1 tests can provide information in real-time
related to describe the outburst of the epidemic, which is the reason that the
datasets related to testing only include type-1 tests2 .
Following the recommendation of the WHO director, with different levels
of setups, many governments increased their testing capacities, while others
feared the economic burden of intensive testing policy. However, [37, 38] show
that such a burden is only short-term and, on the contrary, intensive testing
reduces the ‘overall’ cost of the epidemic in the long run because it enables
the government to gain rapid control of the epidemic and revive the economy
of a country. Testing enables the health authority to identify and isolate the
infected people from the susceptible population, which limits the transmission
of the disease. Therefore, testing is considered to be a crucial control mechanism
for the epidemic [39]. However, few attempts have been dedicated to study the
testing policy for an epidemic from a control-theoretic perspective.
In somewhat similar to a resource allocation problem [40, 41] in epidemic
control, [42] poses the optimal test allocation as a well-known sensor selection
problem in control theory, whereas [43] poses it as a welfare maximization problem by considering specificity and sensitivity of tests. The main assumption in
these papers, however, is the availability of information portfolios of all individuals in a society, which enables the decision makers to compute the infection
probability of individuals and utility loss for each individual in case of decision errors. On the other hand, [44, 45] study the problem of testing policy
from an economic perspective, where the goal is to find an optimal testing pol2 Website:

Our World in Data: Coronavirus (COVID-19) Testing. (Accessed 30/09/2020)

4

icy that minimizes the total number of quarantined people to incur minimal
cost on the economic activity of a country while also mitigating the epidemic
spread. Without such a testing policy, governments usually resort to indiscriminate quarantining of people that burdens the economy of a country without
any reason. Therefore, testing allows to identify and isolate the positive cases
to allow for case-dependent quarantining. Another aspect of testing policy is
studied in [46], which numerically computes an optimal trade-off between testing effort and lockdown intervention under the constraint of limited Intensive
Care Units (ICU).
1.2. Contribution of the paper
We introduce a new model named SIDUR model — susceptible (S), undiagnosed infected (I), diagnosed infected (D), unidentified recovered (U), and
identified removed (R) — to study the control of an epidemic through testing.
Similar to [20, 21, 22], we differentiate between the undiagnosed and diagnosed
infected population. We assume that the diagnosed infected population are
either quarantined and/or hospitalised and only the undiagnosed infected population is responsible for the disease transmission to the susceptible population.
The identified removed population consists of people who recover or die after
being diagnosed and the unidentified recovered population consists of people
who recover without getting diagnosed.
The control input in the SIDUR model is defined as the number of tests
performed per day, where the influence of the control is directly linked with the
testing specificity. The testing specificity determines the probability of detecting
an undiagnosed infected person through a test, which, for instance, can be
increased through efficient contact tracing. As stated previously, only type-1
tests can provide information in real-time related to describe the outburst of
the epidemic. Therefore, the control input in the SIDUR model only accounts
for the type-1 (RT-PCR) tests.
In this paper, we consider the COVID-19 case of France as a benchmark
example. That is, we estimate and validate the model on French COVID19 data. Then, we propose two static testing policies in order to control the
epidemic: 1) Best effort strategy for testing (BEST) and 2) Constant optimal
strategy for testing (COST).
The best-effort strategy for testing (BEST) is a suppression strategy for an
epidemic that provides the minimum number of tests to be performed per day
in order to stop the epidemic spread. Thus, BEST is meaningful only during
the spreading phase of the disease. We provide an algorithm to compute the
number of tests required by BEST policy. Since BEST is a suppression strategy
that stops the epidemic growth immediately, it usually requires a lot of tests to
be performed per day. However, it requires less number of tests if implemented
sooner, which is illustrated for the case of France by plotting the number of
tests required by BEST with respect to time.
The constant optimal strategy for testing (COST) is a mitigation strategy
when the total stockpile of tests is limited. It provides the optimal number of
tests per day that must be allocated in a certain time interval from the onset
5

of the epidemic in order to minimize the peak of infected population. When
the stockpile finishes at the terminal time, then the tests are not performed
anymore. The main idea of COST is the consideration of two peaks of the
epidemic; one that occurs before the stockpile of tests finishes and one that
occurs after the stockpile finishes. If the stockpile of tests is allocated constantly
such that it reduces the first peak, it will however result in the increase of second
peak, and vice versa. Thus, the optimal allocation of tests per day is the one
that minimizes both peaks of the infected population, which occurs when both
peaks are equal. Both BEST and COST policies are compared with the actual
COVID-19 testing scenario of France through the prediction of the number of
active ICU cases and the cumulative number of deaths.
1.3. Paper organization
In Section 2, we describe the model, inputs, and outputs, and compute the
basic and effective reproduction numbers of the model. Section 3 illustrates the
French COVID-19 data and provides the data imputations to infer the missing
data from the raw data. Then, Section 4 provides the estimation and validation
of model for the French COVID-19 case. Finally, in Section 5, we propose
two testing policies BEST and COST, and evaluate them by comparing the
predicted number of active ICU cases and the predicted cumulative number of
deaths with the actual data.
2. SIDUR model with testing policy
We devise a five-compartment model with the purpose of evaluating and
devising testing policies. We assume that testing allows for diagnosing and isolating the infected people from the population to prevent the transmission of the
disease to the susceptible population. The proposed model is named SIDUR,
which corresponds to the five compartments: susceptible (S), undiagnosed infected (I), diagnosed infected (D), unidentified recovered (U), and identified
removed (R). The model is characterized by four parameters and one input,
which is the testing rate corresponding to RT-PCR tests.
2.1. Model design
SIDUR (Susceptible-Infected-Diagnosed-Unidentified recovered-Removed) is
a compartmental model depicted in Figure 1. Consider the timescale of days,
then, at time t, each compartment is characterized by a single state:
• xS (t): Number of susceptible people who are prone to the disease.
• xI (t): Number of infected people who are undetected by the public health
authority.
• xD (t): Number of diagnosed people who are infected and detected positive
with the disease by a public health authority through an PCR test.

6

Susceptible

Infection
transmission

Undiagnosed
Infected

Recovery

Unidentified
recovered

Detection

Diagnosed
Infected

Removal

Identified
Removed

Measured compartments
Figure 1: Block diagram of SIDUR model.

• xU (t): Number of unidentified recovered people who recover without getting diagnosed.
• xR (t): Number of removed people who either recover or die after being
diagnosed.
The development of the model is based on the following three assumptions:
Assumption 1. The population remains constant during the evolution of the
epidemics:
xS (t) + xI (t) + xD (t) + xU (t) + xR (t) = N
where N stands for the total population.
Assumption 2. Only the undiagnosed infected population xI (t) is responsible
for the disease transmission to the susceptible population xS (t).
Assumption 3. All the deaths from COVID-19 are identified and reported;
they are included in the removed population xR (t) along with the people who
recover after being diagnosed.
Assumption 4. The efficiency of the acquired immunity is sustainable enough.
That is, the unidentified recovered population xU (t) and the removed population
xR (t) cannot get infected again.

7

Based on the above assumptions, the model is given as
xI (t)
N
xI (t)
xI (t)
β xS (t)
− u(t)
− γxI (t)
N
xT (t)
xI (t)
u(t)
− ρxD (t)
xT (t)

(1b)

=

γxI (t)

(1d)

=

ρxD (t)

(1e)

ẋS (t)

=

ẋI (t)

=

ẋD (t)

=

ẋU (t)
ẋR (t)

−β xS (t)

(1a)

(1c)

where β, γ, and ρ are the infection, recovery, and removal rates, respectively,
u(t) is the testing rate,
xT (t)

= xI (t) + (1 − θ) (xS (t) + xU (t))
= θxI (t) + (1 − θ) (N − xD (t) − xR (t))

(2)

is the testable population, and θ is the testing specificity parameter which takes
values in the interval [0, 1].
The recovery rate γ is the inverse of the average recovery time 1/γ after which
an undiagnosed infected person recovers, and the removal rate ρ is the inverse of
the average removal time 1/ρ after which a diagnosed infected person recovers
or dies. The average recovery time is expected to be shorter than the average
removal time, i.e., γ ≥ ρ, because the undiagnosed infected population that
comprises the undetected asymptomatic cases and cases with mild symptoms
recover faster than the diagnosed population that comprises mostly the cases
with severe symptoms.
The infection rate β is the product of the frequency of contacts among the
susceptible and infected populations and the probability of disease transmission
after a contact has been made. Thus, the parameters β, γ, and ρ are related to
the disease biology. However, the value of β can also be partially impacted by
a country’s government through non-pharmaceutical interventions (NPI) such
as social distancing, lockdown, confinement, travel restrictions, and preventive
policies (i.e., to maintain a certain distance from other people, to wear a face
mask in public spheres, to wash/sanitize hands more often, etc.). The value of β
is expected to be smaller when NPI’s are implemented than the value of β when
no NPI is implemented. Depending on the time periods during which different
NPI policies are implemented, we assume the infection rate β to be piecewise
constant.
The testing specificity parameter θ, on the other hand, is solely dependent
on the testing policy implemented by the public health authority. Given that
the testing rate is constant, the value of θ will be larger when the tests are
allocated efficiently through contact tracing than the value of θ when the tests
are performed randomly. However, there are other factors that can also influence
θ, for example, if only the people with severe symptoms are tested, then the
8

probability xI /xT of detecting an infected person from the testable population is
equal to one, i.e., the testing specificity parameter θ = 1. This is to indicate that
the larger value of θ doesn’t necessarily imply the efficiency of testing policy,
rather it only signifies the specificity of tests. Depending on the time periods
during which different testing policies are implemented, we assume the testing
specificity parameter θ to be piecewise constant.
2.2. Control input and testable population
We consider the testing rate u(t) to be the model input which depends on
three factors: the daily testing capacity c(t), the remaining stockpile of tests
r(t), and the testable population xT (t). We consider c(t) to be time-varying in
order to take into account the fact that the capacity of testing can change on
a daily basis. Moreover, on a given day t, one cannot do more tests than the
daily testing capacity c(t), the remaining stockpile of tests r(t), or the testable
population xT (t). Therefore, we have
u(t) := min (c(t), r(t), xT (t)) .

(3)

In case the total stockpile of tests rmax is limited, the remaining stockpile of
tests at time t is given by
Z t
r(t) := rmax −
u(η)dη.
0

In case new tests can be produced and supplied easily, (3) is simply given by
u(t) := min (c(t), xT (t)) .
Usually, the testable population xT (t) is much larger than the daily testing
capacity, thus

c(t),
if rmax is unlimited
u(t) =
(4)
min(c(t), r(t)), if rmax if limited.
In order to diagnose the infected people at time t, the tests are allocated to
a proportion of the testable population xT (t), which is a sample from the total
population N . From (2), it is obvious that the infected population xI (t) ≤ xT (t)
at any given time t. Thus, given the testing specificity parameter θ ∈ [0, 1], the
probability of detecting an infected person per test in a homogeneous population
structure is given by xI (t)/xT (t).
The testing specificity parameter θ allows for the adjustment of the testable
population to accommodate for the detection rate of tests. In most countries, at
the beginning of an epidemic outbreak, the number of available tests are limited.
Thus, the available tests are usually utilized to confirm the symptomatic infected
cases or to diagnose certain people such as medical care agents, politicians,
athletes, etc. In such a case, the testable population is close to the infected
population and the value of θ increases to approximately one. Once the capacity
of testing is increased, the size of the testable population is also increased that
can include, for example, contacts of diagnosed people, the whole population of
a city where a cluster is identified, travellers, etc. As a consequence, the value
of θ decreases.
9

2.3. Outflows from the model compartments
The SIDUR model is described by the one-way transfer of population between compartments, where an outflow from one compartment is the inflow to
the other compartments. Thus, it suffices to describe only the outflows from
the compartments to describe the dynamics of the model.
Infection transmission. In the beginning of the epidemic, most of the population is in the susceptible compartment (S) with the exclusion of those who are
initially infected and/or diagnosed. Some of the susceptible people in S may
get infected and leave this compartment when they come in contact with an
infected person. The rate of the outflow from this compartment is according to
the infection transmission rate, which depends on the product of the number of
susceptible and infected populations, and is given as
βxS (t)

xI (t)
N

where β is the infection rate. The term xI (t)/N is the proportion of undetected
infected population at any time t in a homogeneous population structure. Note
that in light of Assumption 2, diagnosed population xD (t) does not participate
in the infection transmission because they are either quarantined and/or hospitalized, i.e., they are temporarily removed from the population. Finally, by
Assumption 4, there is no inflow to the susceptible compartment.
Detection. The outflow from the infected compartment (I) is either due to detection (i.e., transfer to the diagnosed compartment (D)) or recovery without
detection (i.e., transfer to the unidentified recovered compartment (U)). The
first outflow is due to the testing rate u(t), i.e., the number of tests performed
per day. Since the probability of detecting an infected person from a testable
population by a single test is xI (t)/xT (t), therefore we have
u(t)

xI (t)
xT (t)

the rate of diagnosing the infected population in I compartment.
Recovery. The second outflow from the I compartment consists of those people
who are not diagnosed and recover naturally with an average recovery period
of 1/γ. The unidentified recovered compartment (U) accumulates the infected
people who recover naturally without being detected with a recovery rate γ.
Removal. The diagnosed compartment (D) admits u(t)xI (t)/xT (t) as an inflow,
whereas the outflow is ρxD (t) with ρ being the removal rate. That is, 1/ρ is the
average time period after which a typical diagnosed person either recovers or
dies. The removed compartment (R) accumulates the diagnosed people who die
or recover with a removal rate ρ.

10

2.4. Output signals from the model
The outputs signals yi (t), t ∈ R≥0 , i = 1, 2, . . . , m, from the model (or model
outputs) correspond to the sampled output measurements y i (k), k ∈ Z≥0 , from
the data (or data outputs), which can be approximated by a continuous signals
y i (t), respectively. The data outputs and model outputs are related as follows:
y i (t) = yi (t) + wi (t)
where wi (t) is the measurement noise/error.
The model outputs are functions of the states of SIDUR model, which are
of two types: (i) outputs whose functions are known and (ii) outputs whose
functions are not known. First, we define three model outputs whose function
is known.
• Cumulative number of diagnosed people
y1 (t) = xD (t) + xR (t).

(5)

• Cumulative number of removed people
y2 (t) = xR (t).

(6)

• Number of positively tested people (or positive test results) per day
y3 (t) = u(t)

xI (t)
.
xT (t)

(7)

These model outputs are fitted with the data outputs in order to estimate the
model parameters β, θ, γ, ρ in Section 4. Note that these model outputs are
related to each other. Since the number of diagnosed infected people at any time
t can be obtained as xD (t) = y1 (t) − y2 (t), which is also known as the number of
active diagnosed cases, we obtain the following relation between y1 (t) and y2 (t)
from (1e)
ẏ2 (t) = ρ(y1 (t) − y2 (t)).
(8)
On the other hand, the number of positive test results per day y3 (t) is related
to the cumulative number of diagnosed cases y1 (t) by the following relation
y3 (t) = ẋD (t) + ẋR (t) = ẏ1 (t).

(9)

The cumulative number of diagnosed people y1 (t) can be obtained by integrating
the daily number of positive test results as
Z t
y1 (t) − y1 (0) =
y3 (η)dη.
(10)
0

These output relations (8), (9), (10) are used to infer the missing data from the
available data in Section 3.
11

Second, on can note that the number of active ICU patients, denoted B(t),
(or ICU beds occupied) and the cumulative number of deaths, denoted E(t), (or
extinct cases) are positively correlated with the total number of active infected
cases A(t) = xI (t) + xD (t) and the cumulative number of infected cases I(t) =
N − xS (t), respectively. Therefore, we define two additional model outputs:
• Number of active Intensive Care Unit (ICU) cases (or the number of ICU
beds currently occupied by COVID-19 patients):
y4 (t) := B(t) = g(A(t − ψ −1 ))

(11)

where A(t) = xI (t) + xD (t) is the number of active infected cases, ψ −1 is
the average time period a typical COVID-19 ICU case takes from getting
infected to being admitted to ICU, and the function g is to be defined.
• Cumulative number of deaths due to COVID-19 (or extinct cases):
y5 (t) := E(t) = h(I(t − φ−1 ))

(12)

where I = N − xS (t) is the cumulative number of infected cases, φ−1 is the
average time period a typical COVID-19 extinct case takes from getting
infected to death, and the function h is to be defined.
The functions g and h will be estimated from available data on the number of
active ICU cases and the cumulative number of deaths, respectively, in Section 4.
Then, the model outputs B(t) and E(t) will be used as performance outputs to
evaluate the testing strategies proposed in Section 5.
2.5. Basic and effective reproduction numbers
An important quantity to assess the epidemic potential of a disease is the
basic reproduction number R0 , which is defined as the expected number of secondary infected cases produced by a single infected person in a completely susceptible population [10]. If R0 > 1, then each generation of infected cases
produces more secondary cases in the next generation and the disease has a
potential of becoming an epidemic. If R0 < 1, then each generation of infected
cases produces less secondary cases in the next generation and the disease will
eventually die out. It is worth noticing, however, that the definition of R0 assumes that the people around a primary infected case are all susceptible. This
suggests that determining R0 is important only at the onset of an epidemic.
However, in the later stages, more people get infected and not all people around
an infected person are necessarily susceptible. As more people get infected, the
conditions favoring the disease to propagate change and the number of susceptible people that an infected person infects is actually less than that what R0
predicts. Thus, a more suitable quantity during the later stages of the epidemic
is the effective reproduction number Rt , which takes into account the proportion
of susceptible people in the total population [47].
For the SIDUR model, we define the effective reproduction number Rt to be
the ratio of the inflow and the outflow of the undiagnosed infected compartment
12

(I). That is, Rt is the ratio of the number of newly infected people and the
number of newly diagnosed and recovered people at time t. If Rt < 1, this
means that more people are being diagnosed and recovered than the people
being infected at time t, which implies that xI (t) will decrease. If Rt > 1, this
means that more people are being infected than the people being diagnosed
and recovered at time t, which implies that xI (t) will increase. Notice that the
definition of the basic reproduction number R0 is same as Rt for t = 0.
To derive the expression of Rt , we consider the model equation (1b), where
the undiagnosed infected population xI (t) satisfies
ẋI (t) = βxS (t)

xI (t)
xI (t)
− u(t)
− γxI (t).
N
xT (t)

The positive rate (inflow) βxS (t)xI (t)/N tells how many new infections will be
generated in the next moment, and the negative rates (outflows) u(t)xI (t)/xT (t)
and γxI (t) tell how many infected people will be diagnosed or recovered in the
next moment, respectively. Therefore, the effective reproduction number is the
following ratio
Rt =

βxS (t) xIN(t)
u(t) xxIT (t)
(t)

=

+ γxI (t)

β
u(t)
xT (t)

xS (t)
.
+γ N

(13)

To derive the expression of R0 , we consider the expression of Rt at t = 0,
which corresponds to the onset of the epidemic. For t = 0, we can assume few
infected cases, which implies that xS (0) ≈ N and xT (0) ≈ (1−θ)N . Under these
approximations, we have
β
R0 = u(0)
.
(14)
(1−θ)N + γ
This expression can also be obtained by following the methodology of [48].
Notice that the reproduction number R0 depends on the initial testing policy
u(0). This indicates that it is possible to suppress the epidemic in the beginning
by having an intensive testing policy, which can be seen, for example, in the
case of South Korea [49]. In general, however, we have u(0) ≈ 0, which gives
R0 ≈ β/γ.
3. Data acquisition and imputation
The data related to COVID-19 in France is collected from the French government’s platform for publicly available data3 for the time period of January 24 to
July 01, 2020. In particular, we use datasets provided by the French Ministry of
Social Affairs and Health (Ministère des Solidarités et de la Santé (MSS)) and
the French Public Health Agency (Santé Publique France (SPF)). From MSS,
3 Website:

Open platform for French public data. (Accessed 17/10/2020)

13

we obtain the data about different categories of people affected by COVID-19,
i.e., diagnosed, hospitalized, recovered from hospitals, and dead. From SPF, we
obtain the data for the number of PCR tests performed and positive test results
obtained per day.
The data obtained from both sources is incomplete in several aspects. For
instance, the data for the number of recovered people does not record those
who recover from their homes after being diagnosed. These people do not show
severe symptoms of the disease and, therefore, are not hospitalized, but are
quarantined in their homes for some days. Only those who are hospitalized
after being diagnosed are recorded as recovered when they are discharged from
the hospital. On the other hand, the data for COVID-19 PCR tests is also
incomplete. To illustrate this, we consider three intervals of time: (1) January
24 to March 09, 2020, (2) March 10 to May 12, 2020, and (3) May 13 to July
01, 2020. There is no data available for the tests during the first interval.
During the second interval, the testing data is collected only from the medical
laboratories and not from the hospitals. However, we have reliable data only
during the third interval which is collected both from the medical laboratories
and the hospitals. Therefore, the data obtained from the above sources can be
considered as a raw data which needs to be imputed.
3.1. Raw data
This subsection illustrates the data obtained from MSS and SPF without
any modification.
Cumulative number of diagnosed cases. We denote the data for the cumulative
number of diagnosed cases by y 1 , which is illustrated in Figure 2 and corresponds
to the model output y1 (t) in (5). It is also known as the total “confirmed” cases.
This is a cumulative data for all the cases diagnosed with the disease through
RT-PCR tests4 . Thus, it includes both the active cases (those who are either
admitted to the hospitals and/or quarantined) and the inactive cases (those who
either recovered or died after being diagnosed). That is, y 1 (k) corresponds to
the sum of people in the diagnosed (D) and removed (R) compartments of the
SIDUR model (Figure 1) on a given day k, as given in (5).
There is also an additional data for the diagnosed cases from French retirement homes (EHPAD). However, the French government database5 and several
other international databases6 7 do not add the diagnosed cases from EHPAD
to the cumulative number of diagnosed (confirmed) cases. That is, the data for
the cumulative number of diagnosed cases is considered to be inclusive of the
diagnosed cases from EHPAD. However, in all the above databases, the data
on cumulative number of deaths is collected separately from both the hospitals
and EHPAD.
4 Website:

Definition of a COVID-19 confirmed case by SPF. (Accessed 14/07/2020)
COVID-19 - France. (Accessed 01/10/2020)
6 Website: European Centre for Disease Prevention and Control. (Accessed 01/10/2020)
7 Website: Worldometers/coronavirus/France. (Accessed 01/10/2020)
5 Website:

14

2

105

1.5

1

0.5

0

Feb

Mar

Apr

May

Jun

Jul

Figure 2: Cumulative number of diagnosed cases y 1 (k) from January 24 to July 01, 2020.
Source: MSS.

Number of active hospitalized and ICU cases. The data on the number of active
hospitalized cases is denoted as H and is illustrated in Figure 3 along with the
number of active ICU cases B. This data corresponds to the number of people
who are admitted to the hospitals and/or ICU on a given day. That is, it is
not a cumulative data. Moreover, it doesn’t include those who were diagnosed
but not hospitalized. That is, this data corresponds to a certain proportion of
people in the diagnosed compartment (D) of the SIDUR model. This data is
available from March 17, 2020, onward.
10

104

8
6
4
2
0

Feb

Mar

Apr

May

Jun

Jul

Figure 3: Total number of recovered cases who returned home after hospitalization from
January 24 to July 01, 2020. The number of active COVID-19 hospitalized cases H(k) and
ICU cases B(k) from March 17 to July 01, 2020. Source: MSS.

Cumulative number of recovered cases from hospitals. This data is illustrated
in Figure 3. It corresponds to people who, after recovering from the disease,
15

3.5

104

3
2.5
2
1.5
1
0.5
0

Feb

Mar

Apr

May

Jun

Jul

Figure 4: Total number of deaths from COVID-19 reported (a) by hospitals from January
24 to July 01, 2020, and (b) by retirement homes (EHPAD) from April 01 to July 01, 2020.
Source: MSS.

were discharged from the hospitals. Obviously, prior to recovering, they were
diagnosed with the disease and hospitalized due to their severe symptoms.
Cumulative number of deaths. The data on the cumulative number of diagnosed
cases is considered to be inclusive of the diagnosed cases from the French retirement homes (EHPAD). However, the case for data on the cumulative number of
deaths is different. Those who died at the hospitals and those who died in the
retirement homes (EHPAD) are considered to be distinct. Thus, the cumulative
number of deaths is the sum of both data, which are illustrated in Figure 4.
Number of tests and positive tests per day. We have two types of data related to
COVID-19 PCR tests. The first type of data is collected by SPF on the number
of tests performed and positive test results per day from March 10 to May 26,
2020. However, this data is collected only from the central sampling laboratories:
Eurofins Biomnis and Cerba. Figure 5(a) (blue) illustrates the number of tests
performed per day and Figure 5(b) (blue) illustrates the number of positive test
results per day.
The second type of data was made available after the deployment of a new
information screening system (SI-DEP) by the SPF. This data is available from
May 13, 2020, onward. It is collected from both the laboratories and the hospitals. However, the data reported by SI-DEP is the number of ‘tested people’
per day instead of the number of ‘tests performed’ per day. SI-DEP guarantees
that only one test is counted per person. In the case of, for instance, multiple
negative test results for a certain person, SI-DEP considers only the first date
on which the PCR test was performed. Later, if that person gets a positive test
result, then only this new result is reported in the data and the previous data
is erased. Figure 5(a) (red) illustrates the number of tested people per day and
Figure 5(b) (red) illustrates the number of positively tested people per day.

16

6

104

5
4
3
2
1
0
Mar

Apr

May

Jun

Jul

(a)
2500
2000
1500
1000
500
0

Mar

Apr

May

Jun

Jul

(b)
Figure 5: Data on the PCR tests: (a) The number of tests performed per day from March 10
to May 26 and the number of tested people per day from May 13 to July 01; (b) The number
of positive test results per day from March 10 to May 26 and the number of positively tested
people per day from May 13 to July 01. Source: SPF.

3.2. Imputed data
In the raw data, we only have the data for those who recover or die in
the hospitals after being diagnosed with the disease. However, the removed
compartment of the SIDUR model also comprises the diagnosed cases who were
not hospitalized but were quarantined in their homes. There is no data that
records the recovery of these people. Moreover, the data on PCR tests is also
incomplete; there is no data on PCR tests from January 24 to March 09, 2020,
and the data from March 10 to May 12, 2020, doesn’t include the tests performed
in the hospitals. Therefore, in order to infer the missing data, we impute the
raw data by making reasonable assumptions.

17

3.2.1. Cumulative number of removed cases
From the data on the total number of recovered people from hospitals shown
in Figure 3, we see that 76,540 people have recovered from the hospitals as of
July 01, 2020. If we subtract this number and the total number of deaths
(Figure 4), i.e., 29,860, from the total number of diagnosed cases (Figure 2),
i.e., 165,700, we obtain 165, 700 − 76, 540 − 29, 860 = 59, 300 people. Further
subtracting the currently hospitalized cases (Figure 3), i.e., 8336 as of July
01, we obtain 59, 300 − 8336 = 50, 964 people, who might still be infected or
have recovered. These people were diagnosed but were not hospitalized; they
were quarantined in their homes. However, there is no data that provides a
correct answer for how many people have recovered and how many of them are
still infected. Therefore, using the relevant raw data, we infer the cumulative
number of removed cases y 2 by estimating the number of diagnosed cases who
recovered from home.
We use the following notations for simplicity and brevity:
y 01
y 001
y 02
y 002

Total
Total
Total
Total

diagnosed and hospitalized
diagnosed but not hospitalized
recovered/died in a hospital
recovered from home after diagnosis

By definition, we have
y 1 (k)
y 2 (k)

= y 01 (k) + y 001 (k)
= y 02 (k) + y 002 (k)

(15)

where k is from January 24 to July 01, 2020. Note that y 1 (k) is illustrated in
Figure 2 and
y 01 (k) = y 02 (k) + H(k),
where y 02 (k) is the sum of the total number of recovered cases from hospitals
(Figure 3) and the total number of deaths (Figure 4), and H is the number of
active hospitalized cases (Figure 3). Thus, we can compute the total diagnosed
cases who were not hospitalized as
y 001 (k) = y 1 (k) − y 01 (k).
Since there is no data for the diagnosed people who recovered from home,
therefore y 002 (k) is unknown. Thus, we assume the following:
y 002 (k)
y 02 (k)
=
.
y 001 (k)
y 01 (k)

(16)

That is, the ratio of the diagnosed cases who recovered in homes to the total
diagnosed cases who were quarantined at homes is equal to the ratio of the
diagnosed cases who recovered or died in hospitals to the total diagnosed cases
who were hospitalized. In other words, we assume that the removal rate of

18

people who were not hospitalized is equal to the removal rate of people who
were hospitalized. Thus, from (15) and (16), we obtain


y 001 (k)
y (k)
0
y 2 (k) = y 2 (k) 1 + 0
= y 02 (k) 10
.
y 1 (k)
y 1 (k)
which corresponds to the model output y2 (t) in (6).
3.2.2. Combining two types of testing data
From Figure 5, we see that the first type of data, which is available from
March 10 to May 26, 2020, considers the number of tests performed and positive
test results per day. On the other hand, the second type of data, which is
available from May 13, 2020, onward, considers the number of tested people
and positively tested people per day. However, no person is usually tested more
than once per day. Therefore, we assume that the number of tested people per
day is same as the number of tests performed per day. Similarly, the number of
positively tested people per day is same as the number of positive test results
per day. Note that if a person is tested more than once but on different days,
then this assumption is not violated.
We consider three time intervals: (i) January 24–March 09, when there is
no data on PCR tests; (ii) March 10–May 12, when there is incomplete data;
(iii) May 13–July 01, when there is complete data. Let u and y 3 denote the
number of tests performed and the number of positive test results per day,
respectively, for the entire interval January 24 to July 01, 2020. Let u0 , u00 , u000
and y 03 , y 003 , y 000
3 be the number of tests performed and the number of positive
test results obtained for the first, second, and third time intervals, respectively.
Since the data in the third interval is reliable, we do not make any imputations
for u000 and y 000
3 . For the other two intervals, we make reasonable assumptions
to complete the data.
(i) January 24–March 09: This interval corresponds to the beginning of the
epidemic in France and the data for tests performed and positive test
results per day for this interval is u0 and y 03 , respectively. During this
interval, only those people were tested who showed symptoms. Moreover,
recall the output relation (9). Then, we compute the data as follows:
u0 (k) ≈ y 03 (k) and y 03 (k) = y 1 (k + 1) − y 1 (k), where k is from January 24
to March 09. In other words, during the first interval, the number of tests
performed per day is assumed to be approximately equal to the number of
positive test results obtained per day. Moreover, the number of positive
test results obtained per day is equal to the number of diagnosed cases
that day.
(ii) March 10–May 12: In the second interval, we have the data on PCR tests
that is reported only by the laboratories and not by the hospitals. During
this interval, we compute the data as follows: u00 is same as the data
(Figure 5) and y 003 (k) = y 1 (k + 1) − y 1 (k), where k is from March 10 to
May 12.
19

Based on theabove data imputations,
we obtain the number of tests performed

per day u = u0 u00 u000 , which corresponds to the control input u(t),
and

,
which
the number of positive tests obtained per day y 3 = y 03 y 003 y 000
3
corresponds to the model output y3 (t) in (7), for the complete time interval
January 24 to July 01, 2020.
7

104

6
5
4
3
2
1
0

Feb

Mar

Apr

May

Jun

Jul

Figure 6: Input signal from the data.

2

105

2

1.5

1.5

1

1

0.5

0.5

0

Feb

Mar

Apr

May

Jun

0

Jul

105

Feb

Mar

Apr

May

Jun

Jul

7000
6000
5000
4000
3000
2000
1000
0

Feb

Mar

Apr

May

Jun

Jul

Figure 7: Output signals from the data.

3.3. Input and output signals from the data
The input u(t) to the model corresponds to the number of tests performed
per day u. Let {1, 2, . . . , τ } be the index set of the 160 days from January 24
to July 01, 2020, where τ = 160. Then, for k = 1, 2, . . . , τ , we define the input
signal as
u(t) = u(k), for btc ≤ k < dte

20

which is illustrated in Figure 6.
We denote by y i (t), for i = 1, 2, 3, the outputs obtained from the data. That
is, the output signals from the data and the model are related as follows
y 1 (t)
y 2 (t)
y 3 (t)

= y1 (t) + w1 (t)
= y2 (t) + w2 (t)
= y3 (t) + w3 (t)

where wi (k), for i = 1, 2, 3, represents the measurement noise. The outputs
y 1 (t), y 2 (t), and y 3 (t) correspond to the cumulative number of diagnosed cases,
the cumulative number of removed cases, and the number of positive test results
per day, respectively. Similar to the input u(t), we define the output signals from
the data as

for btc ≤ k < dte
 y 1 (t) = y 1 (k),
y 2 (t) = y 2 (k),
for btc ≤ k < dte

y 3 (t) = y 3 (k),
for btc ≤ k < dte
which are illustrated in Figure 7.
4. Estimation of model parameters
In this section, we validate the SIDUR model by estimating the model parameters ρ, β, θ, and γ for the case of COVID-19 in France.
4.1. Estimation of ρ
The removal rate ρ can be directly estimated from the data outputs y 1 and
y 2 . Consider a daily sampling of the model equation (1e), which leads to
∆xR (k) ≈ ρxD (k)
where ∆ stands for the forward difference operator, i.e., ∆xR (k) = xR (k + 1) −
xR (k) for some nonnegative integer k. Therefore, from the relation between y1
and y2 in (8), we obtain
∆y 2 (k) = ρ y 12 (k) + e(k)

(17)

where y 12 (k) = y 1 (k) − y 2 (k) and e(k) is the error term due to measurement
noise. Then, the problem of estimating ρ can be formulated as follows: Find ρ∗
such that
τ
X
ρ∗ = arg min
k∆y 2 (k) − ρ y 12 (k)k2 .
ρ∈[0,1]

k=1

Notice that the solution of this problem can be obtained through least-square
estimation [50, Chapter 7].

21

4.2. Estimation of β, θ, γ
We formulate a problem of fitting the model outputs y1 (t), y2 (t), y3 (t) to the
data outputs y 1 (k), y 2 (k), y 3 (k), where k = 1, 2, . . . , τ with τ being the final
time. The model fitting is done by optimizing the parameters β, θ, γ for the
time interval [0, τ ] under the assumption that γ is constant whereas β and θ are
piecewise constants.
To limit the rate of spread of COVID-19, the French government announced
to place a lockdown all over France from March 17 to May 10, 2020, which
included restricted human mobility, strict social distancing measures, and closure of schools, offices, and marketplaces. However, the essential services and
public establishments were authorized to remain open under strict preventive
measures. People were allowed to leave their homes with face masks only for
necessary groceries, brief exercise within a certain radius of their homes, or for
urgent medical reasons. Such an intervention from the public authority is necessary to mitigate the rate of spread of the disease and to reduce the value of
infection rate β. Therefore, in relation to the case of France, we divide the time
into three intervals: (i) Before lockdown (January 24 to March 16), (ii) During lockdown (March 17 to May 10), and (iii) After lockdown (May 11 to July
01). We consider a different value of the infection rate β during each of these
intervals, i.e.,

 β1 , for k = January 24 to March 16
β2 , for k = March 17 to May 10
β(k) =

β3 , for k = May 11 to July 01
where β1 , β2 , β3 are positive real numbers. For the testing specificity parameter
θ, we divide the time into two intervals: (i) Before May 11 and (ii) After May
11, where May 11 corresponds to the change in testing policy in France [5] (also
see the website of Our-World-in-Data8 ). Thus, we have

θ1 , for k = January 24 to May 10
θ(k) =
θ2 , for k = May 11 to July 01
where θ1 and θ2 are real numbers in the interval [0, 1].
Let p = [ β1 β2 β3 θ1 θ2 γ ]T be the parameter vector. Then, the
goal is to find p∗ such that
p∗ = arg min J (p)

(18)

p

where the cost function is given by
J (p) =

τ h
X

2

2

2

(y1 (k, p) − y 1 (k)) + (y2 (k, p) − y 2 (k)) + (y3 (k, p) − y 3 (k))

i

k=1

(19)
8 Website:

Our World in Data: COVID-19 Testing Policies. (Accessed 30/09/2020)

22

with the model outputs yi , i = 1, 2, 3, depending on the parameter vector p.
Note that we consider the data from January 24 to July 01, 2020, therefore we
have τ = 160 days.
To solve this problem, one can also pose it as a least-square estimation, as
we did for the removal rate ρ, by defining relations between the data outputs
y 1 , y 2 , y 3 . However, such relations include the difference operator ∆ applied
twice to the data outputs, which is usually not recommended when the data is
noisy because it amplifies the measurement noise. Moreover, the gradient-based
estimation algorithms [51, Chapter 4] are also not suitable due to the difficulty
of computing the gradient of the cost function J online with respect to the
parameter vector p. This is because the model outputs y1 , y2 , y3 do not depend
directly on the parameters but through the solution trajectories of the SIDUR
model. For simplicity, therefore, we choose the particle swarm optimization
(PSO) [52] described in Appendix A, which is a ‘derivative-free’ algorithm, to
estimate the parameter vector p.
Infection rate
Testing specificity
Recovery rate
Removal rate

β1 = 0.3708 β2 = 0.0707
θ1 = 0.9948 θ2 = 0.9967
γ = 0.1589
ρ = 0.0499

β3 = 0.3717

Table 1: Estimated parameter values.

The estimated parameter values are provided in Table 1. The estimated
recovery rate γ and removal rate ρ show that an undiagnosed person recovers in
an average period of about 6.3 days and a diagnosed person recovers or dies in
an average period of about 20 days. The testing specificity parameter changes
slightly from θ1 = 0.9948 to θ2 = 0.9967, which can have significant impact on
the positive test results because it multiplies with the sum of the susceptible
and unidentified recovered population in (2) that is in the order of 107 in the
case of France.
The infection rate β changes its value twice. First, it drops from β1 = 0.3708
to β2 = 0.0707 when the lockdown is implemented in France on March 17,
which significantly decreased the rate of the epidemic spread. Then, it rises
from β2 = 0.0707 to β3 = 0.3717 when the lockdown is lifted on May 10. Many
restrictions like social distancing and wearing of face masks were still in place
after May 10 in order to prevent the spread of COVID-19 in France. However,
the increase in the value of β can be explained by the summer vacations when
people were allowed to travel everywhere across France and Europe9 . This
made the places with tourist attractions very crowded and resulted in a higher
infection rate.
9 Website:

Sortir à Paris: Summer holidays in France and Europe. (Accessed 30/09/2020)

23

4.3. Model validation
Using the estimated values of the model parameters in Table 1, we run the
model from January 24 to July 01, 2020. The model fits the output signals data
as shown in Figure 8.
The basic reproduction number R0 at the outbreak of the COVID-19 epidemic in France is computed using (14) and the average value of effective reproduction number Rt during three phases (before, during, and after lockdown) are
computed using (13). For the ‘after lockdown’ phase, we chose July 01, 2020,
to compute Rt because it is the date up to which our data is considered. These
computed values are shown in Table 2 with a comparison to the ones reported
by the government10 11 .
Epidemic phases
Outbreak
Before lockdown
During lockdown
After lockdown

Computed from model
R0 = 2.33
Rt = 2.3
Rt = 0.33
Rt = 1

Reported by French government
R0 = 2.7
Rt = 2.7
Rt = 0.7
Rt = 1

Table 2: The basic reproduction number R0 at the outbreak and the values of the effective
reproduction number Rt at the end of each phase of the COVID-19 epidemic in France. The
values computed by our model are quite close to the ones reported by the French government.

The change in the value of Rt also influences the evolution of diagnosed
population xD (t). This is because larger value of Rt results in a larger infected
population xI (t) and smaller value of Rt results in a smaller infected population
xI (t), which respectively increases and decreases the probability of detecting
an infected person xI (t)/xT (t) by a single test. Keeping the number of tests
performed per day same, the larger probability of detection xI (t)/xT (t) results
in a larger diagnosed population xD (t).
In Table 2, we see that the placement and lifting of lockdown on March 17
and May 11, respectively, had a significant impact on the value of Rt . Such
an effect on Rt impacted the evolution of the diagnosed population xD (t) =
y1 (t) − y2 (t), which can be interpreted as the number of active confirmed cases
and is illustrated in Figure 9. The placement of lockdown reduced the value
of Rt and resulted in less number of active confirmed cases as compared to the
scenario in Figure 9 where the lockdown was not placed on March 17. In this
scenario, as shown in Figure 9, the number of active confirmed cases would have
increased to a point that could have challenged the available medical facilities
such as hospital beds, ventilators, and ICUs. On the other hand, the lifting
of lockdown increased the value of Rt and resulted in more number of active
confirmed cases as compared to the scenario where the lockdown was not lifted
on May 11.
10 Website:
11 Website:

COVID-19 France: Epidemiological update. (Accessed 30/09/2020)
COVID-19 France: Monitoring of the epidemic. (Accessed 30/09/2020)

24

2

105

1.5

1

0.5

0

2

Feb

Mar

Apr

May

Jun

Jul

Feb

Mar

Apr

May

Jun

Jul

Feb

Mar

Apr

May

Jun

Jul

105

1.5

1

0.5

0

7000
6000
5000
4000
3000
2000
1000
0

Figure 8: Model validation.

25

7

104

6
5
4

Lockdown placed
on March 17

Lockdown lifted
on May 11

3
2
1
0

Feb

Mar

Apr

May

Jun

Jul

Figure 9: The comparison between the number of active diagnosed cases in the actual scenario
vs. two scenarios: if the lockdown was not placed on March 17 and if the lockdown was not
lifted on May 11.

4.4. Number of active ICU patients and deaths
The number of active ICU patients B(t) is a function of the number of
active infected people A(t). Since an infected person starts to show symptoms
after the average incubation period of approximately 5 days, [53], and a person
takes on average 12 days from being diagnosed to being addmitted to ICU,
[54], we assume ψ −1 = 5 + 12 = 17 days to be the average time delay from
getting infected to being admitted to ICU for a typical COVID-19, critically ill
case. Thus, we model the number of active ICU patients B(t) as a function of
A(t − ψ −1 ), which is approximated by:
p
B(t) = b1 A(t − ψ −1 ) + b2 A(t − ψ −1 )
(20)
where b1 and b2 are the parameters (Appendix B, Table B.4) that are determined via the least-square solution to fit (20) to the data on the number of ICU
patients. This is illustrated in Figure 10.
Similar to the case of the number of active ICU patients, a typical nonsurviving case has an average incubation period of 5 days and, in addition to
that, an average removal period of ρ−1 ≈ 20 days, where ρ is the removal
rate, Table 1. Thus, assuming φ−1 = 5 + ρ−1 = 25 days to be the average
time delay from getting infected to death of a typical non-surviving COVID-19
case, we model the number of deaths E(t) as a function of I(t − φ−1 ), which is
approximated by the following polynomial:
E(t) =

10
X

ei I i (t − φ−1 )

(21)

i=1

where ei , for i = 1, . . . , 10, are the parameters (Appendix B, Table B.4) that are
determined via the least-square solution to fit (21) to the data on the number
of deaths. This is illustrated in Figure 12.
26

8000

6000

4000

2000

0
0

1

2

3

4

5
106

Figure 10: Number of active ICU patients B(t) with respect to the number of active infected
cases A(t).

10000
8000
6000
4000
2000
0

Feb

Mar

Apr

May

Jun

Jul

Figure 11: Model fit of the data on the number of active COVID-19 ICU cases B(t) in France
using the relation (20).

Using the relations (20) and (21), we illustrate the model fit of the number
of active ICU cases and the cumulative number of deaths with the data in
Figure 11 and 13.
5. Study and design of testing policies
In this section, we use the model validated with the COVID-19 data of
France to design two types of testing policies. The first one assumes that the
total stockpile of tests is unlimited, but the testing capacity per day is limited.
This results in the so called Best Effort Strategy for Testing (BEST), which
gives the minimum number of tests needed to be performed per day in order to

27

3.5

104

3
2.5
2
1.5
1
0.5
0
0

5

10

15
106

Figure 12: Cumulative number of deaths E(t) with respect to the cumulative number of
infected cases I(t).

3.5

104

3
2.5
2
1.5
1
0.5
0

Feb

Mar

Apr

May

Jun

Jul

Figure 13: Model fit of the data on the number of COVID-19 deaths E(t) in France using the
relation (21).

stop the epidemic from growing. In other words, if the BEST is applied, then
the number of new infections stop to grow with respect to time.
The second strategy, named COST (Constant Optimal Strategy for Testing)
assumes that the total stockpile of tests in a country is limited. In such a case,
we investigate the optimal testing policy per day that results in a minimum
epidemic peak. In contrast with BEST, there is an optimal value of tests to be
performed per day which is smaller than the maximum testing capacity per day.
5.1. Best effort strategy for testing
Assume that the total stockpile of tests is unlimited during the whole epidemic period. This assumption is valid for a country that can manufacture
or buy tests continuously during the time of the epidemic. Based on this, we
28

provide a testing policy recommendation on the daily testing capacity starting
from a certain time t∗ in order to change the course of the epidemic in a sense
that is defined below. For simplicity, we further assume that the number of tests
performed per day is considered to be the daily testing capacity. In other words,
the daily testing capacity is utilized completely each day, i.e., u(t) = c(t).
We say that, at any time t, an epidemic is spreading if the number of undiagnosed infected population xI (t) is increasing, i.e., the effective reproduction
number Rt > 1. On the other hand, an epidemic is non-spreading if xI (t) is not
increasing, i.e., the effective reproduction number Rt ≤ 1.
Definition 1 (BEST). The best effort strategy for testing (BEST) at a given
time t∗ is the minimum number of tests to be performed per day from time t∗
onward such that the epidemic switches from spreading to non-spreading at t∗ .
In other words, BEST provides the smallest lower bound on the number of
tests performed per day, sufficient to change at given time t∗ the course of the
epidemic from spreading to non-spreading. In order to compute the BEST at a
given time t∗ , we first define the following function:
c∗ (t) = xT (t)

β(t)
xS (t) − γ
N

(22)
+

where, by definition, for any scalar z, |z|+ = z if z > 0 and |z|+ = 0 otherwise.
Proposition 1. Assume that the infection rate β is non-increasing while the
testing specificity parameter θ is non-decreasing on a time interval [t∗ , t1 ), for
some t∗ < t1 . Then, the best effort strategy for testing (BEST) at time t∗ is
given by
u(t) = c∗ (t∗ ) = xT (t∗ )

β(t∗ )
xS (t∗ ) − γ
N

,

∀t ∈ [t∗ , t1 ).

+

Proof. In order to prove that c∗ (t∗ ) for t ∈ [t∗ , t1 ) is the BEST at t∗ , we show
the following:
(i) If u(t) > c∗ (t) (resp., u(t) ≥ c∗ (t)) for any t ∈ [t∗ , t1 ), then xI is decreasing
(resp., non-increasing) on [t∗ , t1 ).
(ii) If u(t) > c∗ (t∗ ) (resp., u(t) ≥ c∗ (t∗ )) for any t ∈ [t∗ , t1 ), then xI is decreasing (resp., non-increasing) on [t∗ , t1 ).
Assume that u(t) > c∗ (t) on [t∗ , t1 ). Then, Φ(t) := β(t) xSN(t) − xu(t)
−γ <0
T (t)
which implies that xI is decreasing since ẋI (t) = Φ(t)xI (t) almost everywhere.
If only the weaker assumption u(t) ≥ c∗ (t) on [t∗ , t1 ) is fulfilled, then, by using
the continuity of the solutions of ODE with respect to perturbations of the
right-hand side, one gets that xI is non-increasing.
Assume now that u(t) > c∗ (t∗ ) on [t∗ , t1 ), where c∗ (t∗ ) is constant. Then, by
continuity, u(t) > c∗ (t) on a certain interval [t∗ , t2 ), for some t2 ∈ (t∗ , t1 ]. As a
29

consequence of the result (i) shown previously, xI decreases on [t∗ , t2 ). Moreover,
assume that t2 is the maximal point in (t∗ , t1 ] having this property. In order
to show that t2 = t1 , it is sufficient to show that u(t2 ) > c∗ (t2 ), otherwise one
may consider a larger value for t2 which will lead to a contradiction with the
fact that it is maximal. Since xI decreases on [t∗ , t2 ) and θ is non decreasing,
from Lemma 6 (see Appendix C), we can conclude that xT also decreases
on this interval. On the other hand, since xS is always decreasing and β is
non increasing, one can conclude that c∗ (t) also decreases on [t∗ , t2 ). This is
obtained by upper bounding c∗ (t). Thus, one has c∗ (t∗ ) > c∗ (t), which implies
that that u(t2 ) > c∗ (t2 ). Therefore, as t2 = t1 , we have established that xI
decreases on the whole interval [t∗ , t1 ). For the case where u(t) ≥ c∗ (t∗ ), we can
use the same argument of continuity of the trajectories.
From the previous results, one deduces that the BEST is given by c∗ (t∗ ) and
the testing rate u(t) ≥ c∗ (t∗ ) for t ∈ [t∗ , t1 ). If u(t) < c∗ (t∗ ), for t ∈ [t∗ , t1 ),
then one can show easily that the epidemic goes on spreading in the interval
[t∗ , t1 ). Hence, u(t) = c∗ (t∗ ) is the BEST policy at t∗ .
Algorithm 1: Computation of the BEST policy at time t∗ .
1. Inputs: N , β, γ, θ, t∗ , xS (t∗ ) and xT (t∗ ).
2. Compute the BEST policy c∗ (t∗ ) using (22).
3. Set u(t) = c∗ (t∗ ), for all t ≥ t∗ .
4. Return to step 2 if β increases or θ decreases.

Proposition 1 states that the peak of xI (t) is uniquely determined by the
BEST policy c∗ (t∗ ), where the peak is achieved at time t∗ . Therefore, Algorithm 1 can be used to set the peak time t∗ once parameters β, γ, and θ are
learned from the data.
Remark 1. Requiring that β must not increase and θ must not decrease in the
interval (t∗ , t1 ) for some t1 > t∗ is necessary for the BEST policy. It is thus
important to keep the external conditions that determine the values of β and
θ either constant or such that β decreases (e.g., through the implementation of
lockdown) and/or θ increases (e.g., through efficient contact tracing).
Remark 2. The case where β decreases and/or θ increases at some time t1 > t∗
has the effect of speeding up the suppression of the epidemic under BEST policy.
Remark 3. From (1b), we can note that if xS (t)/N < γ/β, the the epidemic
naturally decreases. In this case, doing no testing u(t) = 0 is the BEST policy,
which, by definition, gives a minimum number of tests to be performed in order
to stop the growth of the infected population xI . However, if testing is resumed
in this case, i.e., u(t) > 0, it will further speed up the decrease of the infected
population.
30

5.1.1. Evaluation of the BEST policy
Giving data from France, we first compute c∗ (t∗ ) for different values of t∗
from January 24 to March 13. Figure 14 shows the number of tests per day
required by the BEST policy if it is implemented on day k and the corresponding
value of peak of infected cases xI (k ∗ ). One can note that the later BEST is
applied the higher is the required number of tests. An exponential increase
can even be observed from February 28 which corresponds to an acceleration
of the infection. Now, we consider a scenario where BEST is implemented on
10

105
106

8
6

104
4
2

Jan 24

102
Feb 01

Feb 16

Mar 01

Mar 15

Figure 14: Number of tests per day required by the BEST policy (left y-axis, green) vs. peak
of infection (right y-axis, red, in logscale) for an implementation day t∗ .

March 01. Figure 15 depict the number of active cases when u(t) is the actual
testing scenario (see Figure 6) and when u(t) is given by BEST. To evaluate
BEST, we use u(t) as given by recorded data before March 01 then use u(t)
given by BEST from March 01. In the first case, the peak of the infected
population xI (t), which are the active undiagnosed cases, is about 6 million. In
the second case, the peak of infected population in this case is 363, 169. The
required number of tests per day to be performed for the implementation of
BEST on March 01 is c∗ ≈ 147, 000.
The impact in terms of ICU occupation and number of deaths is now evaluated using the equations (20) and (21) respectively. The results are illustrated
in Figure 16 and 17.
We observe that the peak of the number of active ICU patients could have
been reduced by 34.71% and the number of deaths could have been reduced by
74.45% if the BEST policy was applied from March 01, 2020.
5.2. Constant optimal strategy for testing
Consider now that the total stockpile of tests is limited and given by rmax .
In this case, the testing rate should be chosen carefully so as to not finish the
stockpile of tests too early by performing too many tests per day, or to be
unable to control the epidemic spread by performing too few tests per day. In
31

10

105

8
6
4
2
0
Feb 16

Feb 23

Mar 01

Mar 08

Mar 15

Figure 15: Predicted number of infected cases xI (t): actual testing scenario vs. BEST

10000
8000
6000
4000
2000
0

Feb

Mar

Apr

May

Jun

Jul

Figure 16: The prediction of the number of active ICU cases B(t): actual scenario vs. BEST
policy.

the former case, when the stockpile of tests finishes too early due to intensive
testing, the infections, even if significantly reduced in the beginning, will start to
spread again and result in a second wave of the epidemic with an infection peak
much higher than before. On the other hand, if the number of tests performed
per day is too little, this would result in the infected population reaching a
very high peak during the first wave of the epidemic, which could challenge the
available medical facilities of a country. Thus, in this section, we determine a
constant optimal allocation of a limited stockpile of tests rmax such that both
peaks of the infected population are minimized.
Given the total stockpile of tests rmax , we assume that the number of tests
performed per day is given by

C, if 0 ≤ t ≤ T
u(t) =
(23)
0, if t > T
32

3.5

104

3
2.5
2
1.5
1
0.5
0

Feb

Mar

Apr

May

Jun

Jul

Figure 17: The prediction of the cumulative number of deaths E(t): actual scenario vs. BEST
policy.

where the time period T := rmax /C represent the duration of the testing policy
once C is determined.
Definition 2 (COST). The constant optimal strategy for testing (COST) with
the total stockpile of tests rmax is the policy of class (23) that minimizes the
peak of the infected population xI (t).
In other words, the COST policy allocates the limited stockpile of tests rmax
as C tests per day for the time interval [0, T ], where T is measured in days, such
that the maximum value of the infected population xI (t) is minimized.
In the following, we first study the SIDUR model in a new coordinate of
‘infection’ time ξ with the aim of finding analytic solutions. Then, we use those
solutions to compute the two peak values of xI (t), where the first peak arrives at
t ≤ T and the second at t > T . Finally, we compute the optimal value of C that
minimizes those peak values by equating them, which is depicted in Figure 18.
5.2.1. Partial solution to the SIDUR model
The SIDUR model has an interesting property: most of the terms on the
right-hand side of the model (1) depend linearly on xI (t). This gives an intuition
that the epidemic process goes faster when the number of infected people xI is
high. Indeed, this idea was used very early to analyze the basic SIR model, see
[9]. It is possible to define a new time variable ξ, which we call infection time,
as an integral of undetected infected people up to time t, i.e.,
dξ = xI (t)dt.
This means exactly that the speed of the processes in the new infection time
is proportional to xI . The ‘real’ time can be reconstructed from the infection

33

10

106

8
6
4
2
0
Feb

Mar

Apr

May

Jun

Jul

Aug

Sep

Figure 18: Under the limited stockpile of tests rmax , the number of infected cases xI (t) will
have two peaks. The first peak happens before the stockpile of tests is finished and the second
peak happens after the stockpile finishes. The second peak is the result of the second wave of
the epidemic during which no testing is done. If the testing policy is chosen such that the first
(respectively, second) peak is reduced, then the second (respectively, first) peak will increase.
The minimum of both peaks is achieved when the peak values of both waves of the epidemic
are equal. This is ensured by COST policy C.

time by:
Zξ
t(ξ) =

dξ 0
.
xI (ξ 0 )

(24)

0

Note that the infection timescale preserves the peak value of epidemic, which is
of interest to us. That is,
dxI dξ
dxI
dxI
=
=
xI
dt
dξ dt
dξ
and dxI /dt = 0 implies dxI /dξ = 0 and vice versa (as long as xI 6= 0). Therefore,
one can perform a model analysis based on the infection timescale ξ. Moreover,
by writing the equations in ξ, the partial solution of SIDUR model can be
obtained analytically.
Proposition 2. Evolution of the unidentified recovered population xU is affine
with respect to the infection time ξ, whereas the susceptible population xS is
exponential with respect to ξ. That is,
xU (ξ)
xS (ξ)

= xU (0) + γξ = γξ
= xS (0)e

β
−N

ξ

.

(25)
(26)

Proof. It is straightforward to see that the solution of (1d) is given by (25). On
the other hand, (1a) yields
dxS (t)
β
= − xS (t)
dξ
N
34

whose solution is given by (26).
It is not so trivial to find analytic solutions for xI , xD , and xR . However, under
certain hypothesis on the testable population, it is possible to get a reasonable
approximation of the solutions.
Assumption 5. The testable population xT is approximated as
xT (t) ≈ (1 − θ)N.

(27)

This makes it possible to find an analytic solution for the infected population
xI (t).
Proposition 3. Evolution of the infected population xI under Assumption 5 is
given by


xI (ξ) = xI (0) + xS (0) 1 − e

β
ξ
−N



1
−
(1 − θ)N

Zξ
u(s)ds − γξ.

(28)

0

Proof. Equation (28) can be directly obtained by integrating (1b), if one first
transforms it using the infection time and then substitutes the definition for xT
from Assumption 5 and the solution for xS from (26).
Using (23), we can now write a complete evolution of the infected population:



β
Cξ

xI (0) + xS (0) 1 − e− N ξ −
− γξ, ξ < ξ ∗

(1 − θ)N
xI (ξ) =
(29)


β
Cξ ∗

∗

xI (0) + xS (0) 1 − e− N ξ −
− γξ, ξ ≥ ξ
(1 − θ)N
where ξ ∗ denotes the moment of stopping the testing in the infection time coordinates, which by definition of the infection time is given by an implicit formula
Zξ

∗

dξ


0

xI (0) + xS (0) 1 −

β
e− N ξ

derived from the relation
Zξ



−

Cξ
(1−θ)N

=T =
− γξ

rmax
C

(30)

∗

dξ
=T
xI (ξ)

0

where we substitute the solution for xI (ξ) given by (28), and the fact that
u(t) = C during the testing interval [0, T ].

35

5.2.2. Analysis of the evolution of infection peaks
From the definition of the effective reproductive number (13), for convenience, we can introduce two reproduction numbers at the origin: RC with the
COST policy C and RW without testing:
RC =

xS (0)β
C
1−θ + γN

,

RW =

xS (0)β
,
γN

RW > RC .

(31)

In general the evolution of the infected population given by (29) can have at
most two peaks, one during testing and one after stopping. To have guarantees
that the peaks exist, we further state the following assumption:
Assumption 6. The COST policy C does not suppress the epidemic at the
origin, i.e., RC > 1.
To explain this assumption, suppose in contrary that the COST policy C
suppresses the epidemic at the origin. However, such a policy will not develop
the herd immunity, and, in the case of the limited stockpile of tests rmax , the
second peak will arrive once the testing is stopped. Therefore, it is reasonable
to develop at least a partial herd immunity using the controlled number of tests
C in the first wave of epidemic.
When the two peaks of the infected population exist, their values can be
obtained by setting the derivatives of (29) with respect to ξ to zero:
β
β
C
dxI,peak1
= xS (0) e− N ξpeak1 −
−γ =0
dξ
N
(1 − θ)N
β
dxI,peak2
β
= xS (0) e− N ξpeak2 − γ = 0
dξ
N

(32)

where the peaks positions in the infection time ξ are given as:
ξpeak1 =

N
ln
β

xS (0)β
C
1−θ + γN

,

ξpeak2 =

xS (0)β
N
ln
.
β
γN

(33)

Writing them in terms of reproduction numbers RC and RW , we obtain
ξpeak1 =

N
ln RC ,
β

ξpeak2 =

N
ln RW .
β

(34)

Since RW > RC > 1, by Assumption 6, we get ξpeak2 > ξpeak1 > 0. Further
one should notice that the peak ξpeak1 occurs only if ξpeak1 < ξ ∗ , otherwise it
is ill-defined. Similarly, ξpeak2 > ξ ∗ .
The peaks values themselves are given by


1
− xS (0)RC ln RC ,
xI,peak1 = xI (0) + xS (0) 1 −
RC


(35)
1
Cξ ∗
xI,peak2 = xI (0) + xS (0) 1 −
− xS (0)RW ln RW −
,
RW
(1 − θ)N
36

It is obvious that xI,peak1 decreases as C increases, because xI,peak1 represents a peak under still performed testing.
Further, it is possible to prove that Cξ ∗ decreases as C increases for all
sufficiently large C. Indeed, (30) can be rewritten as
Zξ
C

∗

dξ
= rmax .
xI (ξ)

0

Taking the derivative with respect to ξ ∗ and substituting again (30) in place of
the integral, we see that
1
dC rmax
+C
= 0,
dξ ∗ C
xI (ξ ∗ )
which is the same as

dξ ∗
rmax xI (ξ ∗ )
=−
.
dC
C2

Therefore,
rmax xI (ξ ∗ )
d(Cξ ∗ )
= ξ∗ −
=
dC
C

ZT
[xI (τ ) − xI (T )] dτ,
0

where ξ ∗ is rewritten by the definition of the infection time (24), while rmax /C
is represented by the integral of 1 over the time T = rmax /C. The result is
negative unless xI (T ) is smaller than an average number of infected people all
the time before, which means that T is long after the peak has come. Thus
for all reasonable sufficiently large C such that T is not too large C, xI,peak1
decreases, while xI,peak2 increases.
This property can be used to optimize a maximum between two peaks. Indeed, a maximum between a decreasing and an increasing function is minimized
when they are equal each other. Thus, we equate two peak values in (35) and
solve it with respect to ξ ∗ , obtaining an optimality condition as


N
RC
RW
∗
ξ =
1 + ln RC −
ln
.
(36)
β
RW − RC
RC
Equation (36) provides an optimality condition which, being combined with
the connection between ξ ∗ and C given by (30), constitutes a complete system
determining the COST C.
It is possible to show that the optimal strategy provides switching in between
of two peaks ξpeak1 and ξpeak2 , thus both peaks exist. Indeed, first we prove a
simple lemma:
Lemma 4. For any x ≥ 1
x − 1 ≥ ln x ≥ 1 −
and the equality is possible only if x = 1.
37

1
,
x

Proof. First of all, it is obvious that for x = 1 all three parts of the inequality
are equal to zero. Further, let us take the derivative of this inequality:
1≥

1
1
≥ 2,
x
x

which is always true for all x ≥ 1, and it holds strictly for all x > 1. This
concludes the proof.
Now, consider the difference ξ ∗ − ξpeak1 :
β ∗
RW
RC
(ξ − ξpeak1 ) = 1 −
ln
N
RW − RC
RC
1
ln x
=1−
x−1
1
=
(x − 1 − ln x) ≥ 0,
x−1
where we denote x = RW /RC , and the last inequality comes from Lemma 4.
Thus the first peak is well-defined. Further, writing the difference ξpeak2 − ξ ∗
in the same manner and using the same definition for x, we see that


β
RC
RW
∗
(ξpeak2 − ξ ) =
+ 1 ln
−1
N
RW − RC
RC
x
ln x − 1
=
x−1


1
x
ln x − 1 +
≥ 0.
=
x−1
x
Thus we have proven that 0 < ξpeak1 ≤ ξ ∗ ≤ ξpeak2 , which means the stopping
of testing happens in between of the two peaks.
5.2.3. Computation of the COST policy
Finally, the COST policy can be obtained by solving (30) with respect to
C, where (36) are used as an upper limit of the integral. This can be formally
stated as follows:
Proposition 5. Consider the testing rate defined by (23). Then, under Assumptions 5 and 6, the COST policy C is given by solving (30)–(36), i.e.,

0

=

rmax
−
C

ξ∗

=

N
β

Zξ

∗

dξ



β
Cξ
−N
ξ −
x
(0)
+
x
(0)
1
−
e
I
S
(1−θ)N − γξ
0
!
C
+ γN
xS (0)β
(1 − θ)γN 2
1 + ln C
−
ln 1−θ
.
Cβ
γN
1−θ + γN

38

(37)

(38)

The time duration for positive testing rate (23) is given by T = rmax /C.
Note that, by construction, a solution to the system of equations (37) and (38)
exists and is unique as long as Assumption 6 holds. This system of equations
can be solved numerically for C by using the Newton’s method (if the initial
estimate C0 is chosen sufficiently close to the real optimal value C). The process
is sketched in Algorithm 2.
Algorithm 2: Computation of the COST policy.
1. Take the initial estimate for COST C0 .
2. On n-th iteration step, given Cn , find ξn∗ by (38).
3. Find the value of the right-hand side of (37). This can be done by
computing the integral numerically. Denote the result as f (Cn ).
4. Find the derivative f 0 (Cn ) of the right-hand side of (37). This can be
done analytically:
f 0 (Cn ) = −

1
dξn∗
rmax
−
2
∗
Cn
xI (ξn ) dCn

where xI (ξn∗ ) is computed from (29) and, from (38),
N
(1 − θ)γN 2
dξn∗
ln
=−
+
dCn
βCn
Cn2 β

Cn
1−θ

+ γN

γN

.

5. Once f (Cn ) and f 0 (Cn ) are computed, update the COST by the
Newton’s method:
Cn+1 = Cn − f (Cn )/f 0 (Cn ).
6. Repeat, from step 2, until the desired accuracy is achieved.

Infection rate
Testing specificity
Recovery rate
Removal rate

β1 = 0.2643 β2 = 0.0006
θ1 = 0.9415 θ2 = 0.7993
γ = 0.0542
ρ = 0.0499

β3 = 0.0642

Table 3: Estimated parameter values under Assumption 5.

5.2.4. Evaluation of COST policy
We first validate Assumption 5. This assumption leads to a new set of model
parameters given by Table 3. With these parameters, the model validation is
illustrated in Figure 19.
39

106
105
104
103
102

Feb

Mar

Apr

May

Jun

Jul

Figure 19: Model validation under Assumption 5 and parameter values of Table 3.

Similar to BEST, we evaluate the COST through the prediction of the number of active ICU cases B(t) and the cumulative number of deaths E(t) using
equations (20) and (21), respectively. However, we fit these equations to the
data B(k) and E(k) by using the model parameters of Table 3 that are estimated
under the Assumption 5.
6

104

5
4
3
2
1
0

Feb

Mar

Apr

May

Jun

Jul

Figure 20: The comparison between the actual control input u(t) versus the proposed control
input u(t) required by COST.

Assuming the total stockpile of tests rmax = 2, 038, 037, which is the total
number of tests performed from January 24 to July 01, 2020, in France, we
obtain the optimal number of tests to be performed per day as C = 17, 144
from Algorithm 2, where the terminal time T = 118 (i.e., May 20). This is
illustrated in Figure 20 along with the actual number of tests per day from the
data.
Using the actual number of tests per day, we fit the model outputs (20) and

40

10000
8000
6000
4000
2000
0

Feb

Mar

Apr

May

Jun

Jul

Figure 21: The comparison between the predicted number of active ICU cases B(t) in the
actual testing scenario and with COST policy.

4

104

3

2

1

0

Feb

Mar

Apr

May

Jun

Jul

Figure 22: The comparison between the predicted cumulative number of deaths E(t) in the
actual testing scenario and with COST policy.

(21) with the data of the number of active ICU cases B(k) and the cumulative
number of deaths E(k), where the parameter values are given in Appendix
B, Table B.5. Then, we predict the number of active ICU cases B(t) and
the cumulative number of deaths when the COST is applied instead of actual
number of tests, as illustrated in Figure 21 and Figure 22, respectively. We
observe that COST reduces the peak of B(t) by 11.12% and the total number
of cumulative deaths E(t) by 37.52%.
Notice that the total stockpile of tests in the actual testing and COST is
the same. However, most of the tests in the actual testing are consumed after
May 13, whereas all the tests in COST are allocated equally in the time interval
January 24 to May 20. The number of tests performed per day in the actual
testing exceeds 50, 000 per day after May 13, which is about three times more

41

than what is required by COST, i.e., 17, 144. Thus, COST is optimal in a sense
that it is practical, it decreases the burden on medical facilities, and it reduces
the number of deaths significantly.
6. Concluding remarks
We proposed a SIDUR model for the control of the COVID-19 epidemic
through the number of RT-PCT tests performed per day. Such tests enable the
government to diagnose and isolate the infected people from the susceptible population. We estimated and validated the model on the French COVID-19 data,
and proposed two testing policies to control the epidemic: 1) best effort strategy for testing (BEST) and 2) constant optimal strategy for testing (COST).
BEST provides the minimum number of tests to be performed from a certain
day onward in order to make the increasing infected population non-increasing
immediately. That is, it changes the course of epidemic from spreading to nonspreading. On the other hand, COST considers a limited stockpile of tests that
are optimally allocated in a time interval starting from the beginning of the
epidemic in order to minimize the peak of infected population.
The control input in SIDUR model corresponds to the number of RT-PCR
tests performed per day. However, another type of test, a serology test, which
is not considered in the current model because of the unavailability of its data,
is also very important. A serology test determines the relevant antibodies in
a subject’s serum in order to detect whether he/she was infected in the past.
By performing serology tests on the testable population, one can detect the
unidentified recovered population and transfer them in the identified removed
compartment of the model. This reduces the size of the testable population,
which in turn increases the testing specificity of RT-PCR tests. In other words,
the serology tests complement the RT-PCR tests [34, 35]. Therefore, as a future
prospect, it will be interesting to consider two control inputs corresponding to
both types of test in the SIDUR model.
The model is estimated and validated by fitting the model outputs with the
available data of France. This allows us to predict the unmeasured states of the
model. However, there is no certainty whether the predicted states correspond
to the reality. Another prospect is to design an observer for the SIDUR model
in order to estimate the true states of the model.
Both BEST and COST policies are easy to compute and implement, however they are static. Thus, their influence on the control of epidemic is limited.
In future, it will be interesting to solve a finite/infinite-horizon optimal control problem to minimize the peak and/or cumulative number of the infected
population by a dynamic control input.
Acknowledgment
This work is partially supported by European Research Council (ERC) under
the European Union’s Horizon 2020 research and innovation programme (ERCAdG no. 694209, Scale-FreeBack, website: http://scale-freeback.eu/)
42

and by Inria, France, in the framework of the COVID-19 fast-track research
program.
Data and code availability
The raw data used in this paper is available at https://www.data.gouv.fr/
fr/datasets/ with the following pointers: Chiffres-clès concernant l’épidémie
de COVID-19 en France, Données relatives aux tests de dépistage de COVID19 réalisés en laboratoire de ville, and Données relatives aux résultats des tests
virologiques COVID-19 (SI-DEP). The imputed data and codes are available at
http://scale-freeback.eu/.
Appendix A. Particle swarm optimization
In this appendix, we briefly describe the particle swarm optimization (PSO)
algorithm, [52], which is considered to be one of the most powerful algorithms. It
considers a foraging swarm of n particles who collectively search for an optimal
solution of (18) in the parameter space. At time step h = 0, 1, 2, . . . , each
particle i visits a position p̂ih by moving with velocity vhi . Initially, when h = 0,
the positions p̂i0 , for all i ∈ {1, . . . , n}, are chosen randomly in the parameter
space and the velocities v0i = 0. Each particle i stores its personal best pair
i∗
∗
s∗
i∗
i∗
(p̂i∗
h , Jh ) and the social best pair (sh , Jh ) in memory, where Jh = J (p̂h ) and
s∗
∗
i∗
Jh = J (sh ) are the costs (19) of personal best position p̂h and social best
s∗
i∗
position s∗h = arg minp̂i∗
J (p̂i∗
h ), respectively. Notice that Jh ≤ Jh
h ,i∈{1,...,n}
for all i ∈ {1, . . . , n}. The personal best pair of a particle corresponds to the
best position in the parameter space it has visited so far. The social best pair,
on the other hand, corresponds to the best position in the parameter space that
anyone in the swarm has visited so far.
At every time step, each particle updates its velocity, position, its personal
best pair, and the social best pair. The velocity and position are updated as
follows:
i
vh+1

i
∗
i
= wvhi + c1 rh,1 (p̂i∗
h − p̂h ) + c2 rh,2 (sh − p̂h )

p̂ih+1

i
= p̂ih + vh+1

(A.1)

where w is the inertia weight, c1 , c2 are the acceleration coefficients, and rh,1 , rh,2
are uniformly distributed random numbers in [0, 1] generated at each time step
h. There are many ways of choosing these parameters [55, 56, 57].
i
Each particle i computes the cost Jh+1
= J (p̂ih+1 ) at its current position
and updates its personal best pair as
( i
i
i
(p̂h+1 , Jh+1
), if Jh+1
≤ Jhi∗
i∗
i∗
(p̂h+1 , Jh+1 ) =
(A.2)
i∗
otherwise.
(p̂i∗
h , Jh ),
Each particle i then communicates its personal best pair with all the other
particles and each of them finds the social best pair for time h + 1 as
s
b
(sh+1 , Jh+1
) = (p̂bh+1 , Jh+1
)

43

j
where b = arg minj∈{1,...,n} Jh+1
. Finally, the social best pair is updated as
(
s
s
(sh+1 , Jh+1
), if Jh+1
≤ Jhs∗
∗
s∗
(A.3)
(sh+1 , Jh+1 ) =
(s∗h , Jhs∗ ),
otherwise.

Appendix B. Parameter values for curve fitting of the number of
ICU cases and deaths
Parameters of B(t)

Parameters of E(t)

b1 = −0.54 × 104
e1 = 4.14 × 104
e3 = −1.27 × 107
e5 = −3.63 × 108
e7 = −1.32 × 109
e9 = −5.93 × 108

b2 = 1.25 × 104
e2 = 7.92 × 105
e4 = 9.04 × 107
e6 = 8.81 × 108
e8 = 1.19 × 109
e10 = 1.25 × 108

Table B.4: Estimated parameters b1 and b2 in (20) and ei , for i = 1, . . . , 10, in (21) when the
testable population xT is given by (2).

Parameters of B(t)

Parameters of E(t)

b1 = 8.87 × 10−4
e1 = 4.03 × 104
e3 = 2.76 × 107
e5 = 9.27 × 108
e7 = 3.59 × 109
e9 = 1.63 × 109

b2 = 1.62
e2 = −1.62 × 106
e4 = −2.16 × 108
e6 = −2.34 × 109
e8 = −3.28 × 109
e10 = −3.44 × 108

Table B.5: Estimated parameters b1 and b2 in (20) and ei , for i = 1, . . . , 10, in (21) when the
testable population xT is given by (27).

Appendix C. Decreasing property of the testable population
Lemma 6. The testable population xT decreases on any interval on which xI is
decreasing and θ is non-decreasing.
Proof. Let us consider an interval (t, t0 ), t < t0 on which xI is decreasing while
θ is non-decreasing. First, one can note that
xT (t)

=

θ(t)(xI (t) + xD (t) + xR (t) − N ) + (N − xD (t) − xR (t))

≥

θ(t0 )(xI (t) + xD (t) + xR (t) − N ) + (N − xD (t) − xR (t))

=

θ(t0 )xI (t) + (1 − θ(t0 ))(N − xD (t) − xR (t)),

(C.1)

because xI (t) + xD (t) + xR (t) − N < 0 and θ is non-negative and non-decreasing
by assumption. Since xI is supposed to be decreasing, then
θ(t0 )xI (t) ≥ θ(t0 )xI (t0 ).
44

On the other hand
Ṅ − ẋD − ẋR = −u

xI
< 0,
xT

meaning that N − xD − xR is a decreasing function. As 1 − θ(t0 ) ≥ 0, one gets
(1 − θ(t0 ))(N − xD (t) − xR (t)) ≥ (1 − θ(t0 ))(N − xD (t0 ) − xR (t0 )).
Adding the two inequalities, one deduces from (C.1) that xT (t) ≥ xT (t0 ) whenever xI is decreasing on (t, t0 ). A tighter examination shows that, as both expressions θ(t0 ) and 1−θ(t0 ) cannot be zero together, at least one of the two terms
of the sum indeed decreases between t and t0 . Therefore, xT (t) > xT (t0 ).
References
[1] X. Cao, COVID-19: Immunopathology and its implications for therapy,
Nature reviews immunology 20 (5) (2020) 269–270.
[2] L. R. Baden, E. J. Rubin, COVID-19 — The search for effective therapy,
New England Journal of Medicine 382 (19) (2020) 1851–1852.
[3] N. V. Loayza, S. Pennings, Macroeconomic policy in the time of COVID19: A primer for developing countries, World Bank Research & Policy
Briefs (28) (2020).
[4] T. Hale, N. Angrist, B. Kira, A. Petherick, T. Phillips, S. Webster, Variation in government responses to COVID-19, Blavatnik School of Government Working Paper BSG-WP-2020/032 (2020).
[5] T. Hale, S. Webster, A. Petherick, T. Phillips, B. Kira, Oxford COVID-19
government response tracker, Blavatnik School of Government (2020).
URL
https://www.bsg.ox.ac.uk/research/research-projects/
coronavirus-government-response-tracker
[6] A. Glover, J. Heathcote, D. Krueger, J.-V. Rı́os-Rull, Health versus wealth:
On the distributional effects of controlling a pandemic, NBER Working
Paper No. 27046 (2020).
[7] N. Ferguson, D. Laydon, G. Nedjati Gilani, N. Imai, K. Ainslie,
M. Baguelin, S. Bhatia, A. Boonyasiri, Z. Cucunuba Perez, G. CuomoDannenburg, et al., Report 9: Impact of non-pharmaceutical interventions
(NPIs) to reduce covid19 mortality and healthcare demand, Imperial College London (16-03-2020) (2020). doi:10.25561/77482.
[8] P. Walker, C. Whittaker, O. Watson, M. Baguelin, K. Ainslie, S. Bhatia,
S. Bhatt, A. Boonyasiri, O. Boyd, L. Cattarino, et al., Report 12: The
global impact of COVID-19 and strategies for mitigation and suppression,
Imperial College London (26-03-2020) (2020). doi:10.25561/77735.

45

[9] W. O. Kermack, A. G. McKendrick, A contribution to the mathematical
theory of epidemics, Proceedings of the Royal Society of London Series A
115 (772) (1927) 700–721.
[10] H. Hethcote, The mathematics of infectious diseases, SIAM Review 42 (1)
(2000) 599–653.
[11] G. Massonis, J. R. Banga, A. F. Villaverde, Structural identifiability
and observability of compartmental models of the COVID-19 pandemic,
arXiv:2006.14295 (2020).
[12] A. Khanafer, T. Başar, B. Gharesifard, Stability of epidemic models over
directed graphs: A positive systems approach, Automatica 74 (2016) 126–
134.
[13] P. E. Paré, C. L. Beck, A. Nedić, Epidemic processes over time-varying
networks, IEEE Transactions on Control of Network Systems 5 (3) (2018)
1322–1334.
[14] P. E. Paré, J. Liu, C. L. Beck, B. E. Kirwan, T. Başar, Analysis, estimation,
and validation of discrete-time epidemic processes, IEEE Transactions on
Control Systems Technology 28 (1) (2018) 79–93.
[15] V. Colizza, A. Vespignani, Epidemic modeling in metapopulation systems
with heterogeneous coupling pattern: Theory and simulations, Journal of
theoretical biology 251 (3) (2008) 450–467.
[16] R. Pastor-Satorras, C. Castellano, P. Van Mieghem, A. Vespignani, Epidemic processes in complex networks, Reviews of modern physics 87 (3)
(2015) 925.
[17] F. Della Rossa, D. Salzano, A. Di Meglio, F. De Lellis, M. Coraggio, C. Calabrese, A. Guarino, R. Cardona-Rivera, P. De Lellis, D. Liuzza, et al., A
network model of italy shows that intermittent regional strategies can alleviate the COVID-19 epidemic, Nature Communications 11 (1) (2020) 1–9.
[18] Q. Lin, S. Zhao, D. Gao, Y. Lou, S. Yang, S. Musa, M. Wang, Y. Cai,
W. Wang, L. Yang, D. He, A conceptual model for the coronavirus disease
2019 (COVID-19) outbreak in wuhan, china with individual reaction and
governmental action, International Journal of Infectious Diseases 93 (2020)
211–216.
[19] C. Anastassopoulou, L. Russo, A. Tsakris, C. Siettos, Data-based analysis, modelling and forecasting of the COVID-19 outbreak, PLoS One
15 (e0230405) (2020).
[20] G. Giordano, F. Blanchini, R. Bruno, P. Colaneri, A. Di Filippo, A. Di
Matteo, M. Colaneri, Modelling the COVID-19 epidemic and implementation of population-wide interventions in Italy, Nature medicine 26 (2020)
855–860.
46

[21] Z. Liu, P. Magal, O. Seydi, G. Webb, Understanding unreported cases in
the COVID-19 epidemic outbreak in Wuhan, China, and the importance
of major public health interventions, Biology 9 (3) (2020) 50.
[22] A. Ducrot, P. Magal, T. Nguyen, G. Webb, Identifying the number of unreported cases in SIR epidemic models, Mathematical medicine and biology:
A journal of the IMA 37 (2) (2020) 243–261.
[23] J. Köhler, L. Schwenkel, A. Koch, J. Berberich, P. Pauli, F. Allgöwer,
Robust and optimal predictive control of the COVID-19 outbreak,
arXiv:2005.03580 (2020).
[24] M. M. Morato, I. M. Pataro, M. V. da Costa, J. E. Normey-Rico, A
parametrized nonlinear predictive control strategy for relaxing COVID-19
social distancing measures in Brazil, arXiv:2007.09686 (2020).
[25] A. Perkins, G. Espana, Optimal control of the COVID-19 pandemic with
non-pharmaceutical interventions, medRxiv 2020.04.22.20076018 (2020).
[26] F. Casella, Can the COVID-19 epidemic be controlled on the basis of daily
test reports?, IEEE Control Systems Letters 5 (3) (2020) 1079–1084.
[27] L. E. Olivier, S. Botha, I. K. Craig, Optimized lockdown strategies for curbing the spread of COVID-19: A South African case study, arXiv:2006.16379
(2020).
[28] F. E. Alvarez, D. Argente, F. Lippi, A simple planning problem for COVID19 lockdown, NBER Working Paper No. 26981 (2020).
[29] D. Acemoglu, V. Chernozhukov, I. Werning, M. D. Whinston, Optimal
targeted lockdowns in a multi-group SIR model, NBER Working Paper
No. 27102 (2020).
[30] L. Brotherhood, P. Kircher, C. Santos, M. Tertilt, An economic model
of the COVID-19 epidemic: The importance of testing and age-specific
policies, CESifo Working Paper No. 8316 (2020).
[31] P. Romagnani, G. Gnone, F. Guzzi, S. Negrini, A. Guastalla, F. Annunziato, S. Romagnani, R. De Palma, The COVID-19 infection: Lessons from
the Italian experience, Journal of Public Health Policy (2020) 1–7.
[32] M. Day, COVID-19: Identifying and isolating asymptomatic people helped
eliminate virus in Italian village, BMJ: British Medical Journal (Online)
368 (2020).
[33] Emergency use authorization (EUA) summary: COVID-19 RT-PCR test,
Tech. rep., US Food and Drug Administration.
URL https://www.fda.gov/media/136151/download

47

[34] D. de Walque, J. Friedman, R. Gatti, A. Mattoo, How two tests can help
contain COVID-19 and revive the economy, World Bank Research & Policy
Briefs (29) (2020).
[35] A. K. Winter, S. T. Hegde, The important role of serology for COVID-19
control, The Lancet Infectious Diseases 20 (7) (2020) 758–759.
[36] Advice on the use of point-of-care immunodiagnostic tests for COVID-19:
Scientific brief, 8 april 2020, Technical documents, World Health Organization (2020).
[37] M. S. Eichenbaum, S. Rebelo, M. Trabandt, The macroeconomics of testing
and quarantining, NBER Working Paper No. 27104 (2020).
[38] M. Salathé, C. L. Althaus, R. Neher, S. Stringhini, E. Hodcroft, J. Fellay,
M. Zwahlen, G. Senti, M. Battegay, A. Wilder-Smith, et al., COVID-19
epidemic in Switzerland: On the importance of testing, contact tracing
and isolation, Swiss medical weekly 150:w20225 (2020).
[39] G. Chowell, P. Fenimore, M. Castillo-Garsow, C. Castillo-Chavez, SARS
outbreaks in Ontario, Hong Kong and Singapore: The role of diagnosis and
isolation as a control mechanism, Journal of Theoretical Biology 224 (1)
(2003) 1–8.
[40] C. Nowzari, V. M. Preciado, G. J. Pappas, Analysis and control of epidemics: A survey of spreading processes on complex networks, IEEE Control Systems Magazine 36 (1) (2016) 26–46.
[41] C. Nowzari, V. M. Preciado, G. J. Pappas, Optimal resource allocation for
control of networked epidemic models, IEEE Transactions on Control of
Network Systems 4 (2) (2017) 159–169.
[42] M. Pezzutto, N. B. Rossello, L. Schenato, E. Garone, Smart testing and
selective quarantine for the control of epidemics, arXiv:2007.15412 (2020).
[43] J. Ely, A. Galeotti, J. Steiner, Optimal test allocation, Tech. rep., Mimeo
(2020).
[44] F. Piguillem, L. Shi, Optimal COVID-19 quarantine and testing policies,
CEPR Discussion Paper No. DP14613 (2020).
[45] D. Berger, K. Herkenhoff, S. Mongey, An SEIR infectious disease model
with testing and conditional quarantine, NBER Working Paper No. 26901
(2020).
[46] A. Charpentier, R. Elie, M. Lauriére, V. Tran, COVID-19 pandemic control: Balancing detection policy and lockdown intervention under ICU sustainability, arXiv:2005.06526v3 (2020).
[47] K. J. Rothman, S. Greenland, T. L. Lash, Modern epidemiology, 3rd Edition, Lippincott Williams & Wilkins, 2008.
48

[48] P. Van den Driessche, J. Watmough, Further notes on the basic reproduction number, in: Mathematical epidemiology, Springer, 2008, pp. 159–178.
[49] J. Oh, J.-K. Lee, D. Schwarz, H. L. Ratcliffe, J. F. Markuns, L. R.
Hirschhorn, National response to COVID-19 in the republic of korea and
lessons learned for other countries, Health Systems & Reform 6 (1) (2020)
e1753464.
[50] L. Ljung, System Identification: Theory for the user, 2nd Edition, Prentice
Hall PTR, Upper Saddle River, NJ-USA, 1999.
[51] O. Nelles, Nonlinear system identification: From classical approaches to
neural networks and fuzzy models, Springer-Verlag, Berlin Heidelberg,
2001.
[52] J. Kennedy, R. Eberhart, Particle swarm optimization, in: Proceedings of
the International Conference on Neural Networks (ICNN), Vol. 4, IEEE,
1995, pp. 1942–1948.
[53] S. A. Lauer, K. H. Grantz, Q. Bi, F. K. Jones, Q. Zheng, H. R. Meredith,
A. S. Azman, N. G. Reich, J. Lessler, The incubation period of coronavirus
disease 2019 (covid-19) from publicly reported confirmed cases: estimation
and application, Annals of internal medicine 172 (9) (2020) 577–582.
[54] F. Zhou, T. Yu, R. Du, G. Fan, Y. Liu, Z. Liu, J. Xiang, Y. Wang, B. Song,
X. Gu, et al., Clinical course and risk factors for mortality of adult inpatients with COVID-19 in wuhan, china: a retrospective cohort study, The
Lancet (2020).
[55] M. Clerc, J. Kennedy, The particle swarm-explosion, stability, and convergence in a multidimensional complex space, IEEE transactions on Evolutionary Computation 6 (1) (2002) 58–73.
[56] R. Poli, J. Kennedy, T. Blackwell, Particle swarm optimization: An
overview, Swarm intelligence 1 (1) (2007) 33–57.
[57] Z.-H. Zhan, J. Zhang, Y. Li, H. S.-H. Chung, Adaptive particle swarm
optimization, IEEE Transactions on Systems, Man, and Cybernetics, Part
B (Cybernetics) 39 (6) (2009) 1362–1381.

49

