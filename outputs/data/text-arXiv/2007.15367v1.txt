Impact of urban structure on COVID-19 spread
Javier Aguilar,1 Aleix Bassolas,2 Gourab Ghoshal,3, 4, ∗ Surendra Hazarie,3 Alec Kirkley,5 Mattia
Mazzoli,1 Sandro Meloni,1 Sayat Mimar,3 Vincenzo Nicosia,2 José J. Ramasco,1, † and Adam Sadilek6, ‡

arXiv:2007.15367v1 [physics.soc-ph] 30 Jul 2020

1

Instituto de Fı́sica Interdisciplinar y Sistemas Complejos IFISC (CSIC-UIB), 07122 Palma de Mallorca, Spain.
2
School of Mathematical Sciences, Queen Mary University of London,
Mile End Road, E1 4NS, London, United Kingdom.
3
Department of Physics & Astronomy, University of Rochester, Rochester, NY, 14627, USA.
4
Department of Computer Science, University of Rochester, Rochester, NY, 14627, USA.
5
Department of Physics, University of Michigan, Ann Arbor, MI, 48109, USA.
6
Google, 1600 Amphitheatre Parkway, Mountain View, CA, 94043, USA.
(Dated: July 31, 2020)
The ongoing COVID-19 pandemic has created a global crisis of massive scale. Prior research
indicates that human mobility is one of the key factors involved in viral spreading [1–10].
Indeed, in a connected planet, rapid world-wide spread is enabled by long-distance air-, landand sea-transportation among countries and continents, and subsequently fostered by commuting
trips within densely populated cities [4, 6, 11–15]. While early travel restrictions contribute to
delayed disease spread, their utility is much reduced if the disease has a long incubation period or if
there is asymptomatic transmission [16–27]. Given the lack of vaccines, public health officials have
mainly relied on non-pharmaceutical interventions, including social distancing measures, curfews,
and stay-at-home orders [13, 22–26, 28–32]. Here we study the impact of city organization on its
susceptibility to disease spread, and amenability to interventions. Cities can be classified according
to their mobility in a spectrum between compact-hierarchical and decentralized-sprawled [33–35].
Our results show that even though hierarchical cities are more susceptible to the rapid spread of
epidemics, their organization makes mobility restrictions quite effective. Conversely, sprawled cities
are characterized by a much slower initial spread, but are less responsive to mobility restrictions.
These findings hold globally across cities in diverse geographical locations and a broad range of
sizes. Our empirical measurements are confirmed by a simulation of COVID-19 spread in urban
areas through a compartmental model. These results suggest that investing resources on early
monitoring and prompt ad-hoc interventions in more vulnerable cities may prove most helpful in
containing and reducing the impact of present and future pandemics.

The SARS-CoV-2 virus, believed to have originated
in the Hubei province of China around the end of
2019 [36, 37], has since spread to 213 countries and
territories (https://covid19.who.int/). Given the
novelty of the virus, the immunological susceptibility of
the population, and the lack of a proven therapeutic
or vaccine, the response toolbox of public health
authorities has been limited to non-pharmaceutical
interventions, such as recommending hand-washing and
more stringent hygienic measures, or imposing social
distancing measures, travel restrictions, and population
confinement via stay-at-home orders [13, 22–26, 28–32].
Different countries, and often even different regions
within each country, have adopted varying degrees of
mobility restriction measures in an attempt to contain
or at least slow down the spread.
However, the
effect of these measures on the temporal evolution of
the epidemics varies significantly across geographical
regions.
The main reason behind such variability
is likely to be that mobility itself is a multi-faceted
phenomenon showing diverse characteristics at different

∗ Electronic

address: gghoshal@pas.rochester.edu
address: jramasco@ifisc.uib-csic.es
‡ Electronic address: sadilekadam@google.com
† Electronic

spatiotemporal scales. Indeed, long-range mobility is
mainly driven by air transportation, but restrictions
to international flights have shown limited utility in
mitigating the propagation of infectious diseases unless
they are applied very early and in a comprehensive
manner [19, 21, 24]. At a more granular level—within
countries, between provinces or states—transportation
modes include train and road traffic, in addition
to air travel, while at an even finer scale —within
cities— vehicular traffic, pedestrian, bike, and public
transportation modes are predominant [10, 38]. In
particular, the unique mixture of different transportation
modes at an urban level and spatial organization of
activities and residential areas creates specific mobility
fingerprints.
We start with an overview of how lockdowns affect
mobility and epidemic spreading at a global scale. Fig. 1a
explores the connection between mobility reduction and
the maximum incidence Imax (the maximum number of
new daily cases per-capita). The color-code used in
the map reflects the division of the two-variable space
displayed in the inset. Darker colors correspond to larger
incidence peaks, and are therefore indicative of more
severe impacts. Although the pandemic is still evolving
as of this writing, some interesting trends are apparent.
In some countries like Japan, South Korea, Sweden or
parts of the US, the mobility reductions are in the

2

FIG. 1: Impact of mobility restrictions on disease propagation at multiple scales a Choropleth map of the
highest mobility reduction versus the maximum incidence (Imax ). The colors represent the division of the
distribution of Imax and the maximum travel reduction across countries (see inset). The data corresponds to the
period January-June 2020. b-g Scatter plot of Reff versus the corresponding mobility reduction one week before in
terms of total flow for b countries (the baseline mobility is taken 5 weeks before the onset of 100 cases), c Italian
provinces (baseline mobility: 2nd week of February), d Spanish provinces (baseline mobility: 2nd week of February),
e South Korean provinces (baseline mobility: 2nd week of February), f Indian states (baseline mobility: 2nd week of
March), and g US cities (baseline mobility: 3rd week of February). Due to the early lockdown in India, we also show
data for 2 weeks before 100 cases. The dashed white line represent LOESS non-parametric fits, and the pale blue
area corresponds to the 95% CI. Details on the mobility dataset are in Methods, Supplementary Table 1 for the
epidemiological data sources and Supplementary Table 2 for the list of countries considered.

range 30-50% (detailed results by country are reported in
Supplementary Fig. 1). However, the policies regarding
testing and other protection measures are quite diverse
and so is the epidemic impact. On the flip-side, countries
like India, Italy and Spain, enforced mobility reductions
by 80% in terms of total trip flows after the onset of
the epidemics. The enforcement of lockdown policies
produced both quantitative and qualitative differences in
small- and medium-scale mobility patterns. At country
scale, the trips suffering the most pronounced relative
reduction are those in the medium-long distance range
(see Supplementary Figs. 2-4). This means that the

different areas and cities of the countries are significantly
less connected. In parallel, the weekly incidence of the
disease is quite heterogeneous, and its association with
the decrease of mobility is complex (see Supplementary
Fig. 5).
The temporal evolution of the disease as a function
of mobility reductions is shown in Fig. 1b-g. The key
variable here is the effective reproduction number Reff ,
computed as in [39, 40], capturing the transmissibility
of the disease in the early stages of the local outbreak
in each country. Each square of Fig. 1b represents a
country and the colors correspond to different weeks

3
from the outbreak onset. Mobility restrictions cause a
decrease of Reff , and in about 2-3 weeks the effective
reproduction number approaches 1 (the threshold of
sustained spread) and the incidence reaches its peak. As
the figure indicates, a decrease of internal country-level
mobility between 25% − 50% is often associated with
significantly reduced propagation. A similar behavior
is observed at a finer resolution in Fig. 1c-f, where we
show Italian, Spanish and South Korean provinces, as
well as Indian states (see Supplementary Tables 3-6 for
the list of provinces and states). There is still a noticeable
reduction in Reff when mobility restrictions are enforced,
but its functional dependence on mobility changes. For
instance, in Italy we observe the presence of a phased
lockdown, with a relatively smooth decrease in mobility
and Reff . In this specific case, a nearly total lockdown
corresponding to 80% reduction in flow was required to
noticeably slow propagation down. For Indian states
and Spanish provinces instead, we see an abrupt shift
with a sudden transition from baseline mobility to 80%
reduction, as an effect of a comprehensive and sudden
lockdown. The case of South Korea is unique, mainly
due to the government’s choice of concentrating resources
on contact-tracing and large-scale testing, rather than
on mobility restrictions. The connection between flow
reduction and Reff is therefore quite weak, as expected.
Moving to even finer resolution, in Fig. 1g we plot the
50 largest metropolitan areas in the United States (See
Supplementary Section 1 for a description of the OECD
urban areas and Supplementary Table 7 for the list of
US cities). The plot shows the same qualitative trends
seen in Italy and Spain, although the comparatively lower
mobility reductions implemented in the US caused the
spread of the disease to continue for longer in many cities
(Reff > 1 even two weeks after the first 100 cases).
The progression of the epidemic nationally is driven
to a large extent by face-to-face contacts at the level
of individual metropolitan areas. Hence, understanding
how the spreading of a disease depends on the structural
organization of a city and of its mobility patterns
is of fundamental importance to adopt adequate and
tailored containment strategies. At urban scale, a prior
analysis revealed that the different areas of a city can be
classified according to the level of mobility (trip outflows)
in different levels of mobility hotspots as defined
in [35]. When it comes to the internal organization of
whole urban mobility patterns, cities can actually be
classified in a spectrum between centralized-hierarchical
and decentralized-sprawled [35]. In hierarchical cities,
most flows (urban trips) occur between top mobility
hotspots [33], whereas in sprawled cities flows are
distributed more uniformly across the urban area.
The level of centralization can be encapsulated in a
metric Φ, called the flow-hierarchy, that takes values
between 0 and 1, so that higher values of Φ correspond
to more centralized cities (see Methods for details).
Hierarchical cities are characterized by advanced levels of
public transportation systems, higher population density,

and better indicators in terms of pollutant emissions
per capita and health indices, whereas decentralized
cities show higher level of private vehicle usage, lower
population densities and sparser use of public transport.
Given these differences in mobility profiles across cities,
we next investigate the connection between the hierarchy
and the COVID-19 propagation patterns.
The primary response to the early onset of the
epidemic were mobility restrictions corresponding to
stay-at-home measures, modifying the spatial patterns
of urban mobility and disrupting most of the routes used
by the virus to propagate, including daily commuting. In
Fig. 2a-c, we show the spatial mobility layout for three
cities arranged in increasing levels of centralization in
their mobility structure: Atlanta (Φ = 0.784), Chicago
(Φ = 0.868) and New York City NYC (Φ = 0.909).
In each case, shown as red dots are the top mobility
hotspots prior to lockdown. In the case of Atlanta, being
a sprawled city, we see that the mobility hotspots are
spread across the urban area, whereas Chicago and NYC
being more hierarchical have their hotspots clustered
in a centralized fashion. The new mobility hotspots
that emerge after mitigation measures are shown as
orange dots, whereas in blue, we show those areas that
cease to be top hotspots. For hierarchical cities such
as NYC or Chicago, while the original top hotspots
remain in the reduced mobility phase, new areas of
mobility activity emerge in a sprawled fashion, effectively
distributing the mobility over larger parts of the city,
thus reducing agglomeration. This effect is seen across
the majority of American cities, whereby flows between
pre-restriction hotspots are reduced (Supplementary
Figure 6a). Instead, flows are sharply increased between
the new sprawled hotspots (Supplementary Figure 6b).
Indeed, in the case of Chicago, we see the emergence
of suburban areas as hotspots, indicating that mobility
is localized within smaller areas, and there is limited
flow between locations. For the case of Atlanta, which
is sprawled to begin with, a few mobility hotspots
disappear, and others emerge, but there is little-to-no
change in the spatial distribution. This can be seen in
Supplementary Fig. 7, where we plot in decreasing order
the fractional change in distance between hotspots due
to the mobility restrictions finding that centralized cities
tend to get more spread out, whereas in sprawled cities,
mobility hotspots remain spatially separated, suggesting
that mitigation measures have limited impact on the
overall mobility structure.
In addition to the mobility-flows, we also have
incidence curves for each administrative unit associated
with the city (e.g., counties, supplementary tables 9-30
detail the list of counties considered per OCDE urban
area). This allows us to run a granular analysis of
the impact of lockdowns by investigating the extent
to which specific areas of the city drive the epidemic
spreading to other parts. To do so, we calculate the
average Transfer Entropy, hTEi, between the incidence
curves for each subsets of the city (see Methods), and

4

FIG. 2: Types of cities and COVID-19 spreading. Maps with the changes in mobility hotspots before and
after the lockdown in three cities with different mobility hierarchy (higher Φ indicates more centralized cities): a-c
Atlanta, Chicago and New York City, respectively, in the week of February 2 for prelockdown mobility and the week
April 5 for the postlockdown. d-e The average Transfer Entropy hST i, capturing the influence of an administrative
division (county) to drive infection-spread as a function of time. Vertical red lines mark the date of the official
lockdown. After lockdown, the ability of a single region to drive infection spread dissipates, and the transmission
evolves independently in each area. g-i The temporal evolution of the effective reproduction number before and
after lockdown versus the mobility change one week before. Each symbol represents a county of the city. While
sprawled cities like Atlanta have regions responding independently, in centralized New York City, we see a clear
synchronized and monotonically decreasing reduction in Reff as a function of mobility reduction.

in Fig. 2d-f plot the results as a matrix whose rows
correspond to the administrative sub-unit, and columns
correspond to weeks, starting from the onset of 100
cases, to the first week of June. The elements in
the matrix are color-coded by the value of hTEi. For
all three cities, a few regions drive the spreading of
the infection before lockdown, although the strength
of the driving is stronger on average in NYC and
Chicago compared to Atlanta (results for four other
cities are reported in Supplementary Fig. 8). Once
lockdown is initiated (marked as vertical red lines), the

driving becomes diffused, indicating the predominance
of localized spreading in sub-regions with little influence
on one another. The localization in spreading appears in
parallel to the equivalent phenomenon in mobility, with a
relative increase in self-flows and a decrease of inter-area
flows in the administrative units (Supplementary Fig.
9). While the influence of each administrative unit on
infection-spreading dissipates in a similar fashion, there
is a key difference in how they are synchronized in terms
of their response to mobility-mitigation. In Fig. 2g-i, we
plot Reff as a function of mobility reduction in each city

5
with points corresponding to sub-units and colored by
time-period. While in Atlanta we see that each region
more or less responds independently in terms of reducing
transmission, for the case of Chicago we begin to see a
pattern emerging, that becomes clear when looking at
NYC where the various regions are clustered temporally
and reduce transmission in a monotonically decreasing
fashion with mobility-reduction.
These patterns generalize beyond the three cities.
In Fig. 3a we plot Reff in the early stages of the
pandemic (three weeks after onset of 100 cases) as a
function of the baseline Φ for the top 22 metropolitan
areas in the United States by number of counties
with populations greater than two million inhabitants
(full list of cities and their corresponding Φ listed in
Supplementary Table 8). There is a clear connection
between transmissibility and mobility hierarchy, with
hierarchical cities having an increased spread of the
disease at the onset. Indeed NYC being the most
hierarchical city in the United States, had a 50% higher
value of Reff than sprawled ones such as Cincinnati,
Charlotte and Atlanta. This increased transmissibility
is also reflected in the extent of the spread of the disease
as measured by plotting Imax against Φ in Fig. 3b.
Cities can be separated into those that have already
experienced a peak in the incidence curve (Northeastern
and Midwestern cities, colored in yellow), and those
which are still at the early phases of the pandemic
(Southern and Western cities, in red). Restricting to
cities where the pandemic is already well-established,
we see a clear trend whereby hierarchical cities have
a much wider outbreak as compared to sprawled ones.
Stronger mitigation strategies manifest in those places
where the outbreak is wide-spread [41], and a relation
between mobility reduction and Φ emerges as can be
seen in Fig. 3c where we find that NYC, San Francisco
and Boston reduce mobility by around 60%, whereas on
the other end of the spectrum, Cincinnati, Minneapolis,
Atlanta or Charlotte decrease mobility by around 40%.
The connection between mobility reduction and reduced
transmission is also far more pronounced: plotting the
Pearson correlation between the reduction in Reff and the
corresponding change in total flow, the week before, as
a function of Φ, indicates that hierarchical cities seem
significantly more responsive to mitigation measures
(Fig. 3d). In order to check the robustness of our
results with respect to the uncertainties in the epidemic
data, we further confirm them using other data source in
Supplementary Fig. 11.
The empirical results (Figs. 2 and 3) suggest that
centralized cities experience faster and more widespread
outbreaks as compared to sprawled ones. However,
mobility restrictions and lockdowns in those cities are
comparatively more effective. To confirm these findings,
while removing potential confounding factors (population
sizes, densities and spatial distribution, variation in type
and timing of lockdowns, or noise in the data), we
implement a metapopulation SEIR model of COVID-19

driven by empirical mobility flows before and after
mitigation measures. The model uses a metapopulation
framework, with S2 cells as geographical units connected
by the network of mobility flows before the initiation of
mitigation measures. We assign populations to S2 cells
in proportion to the sum of their out- and self-flows.
Furthermore, we assume that flows represent primarily
commuting trips, and displacements outside the resident
cells are followed by returns after a period of 8 hours.
Previous research indicates that a substantial fraction of
residents in areas as counties and municipality are not
represented in commuting flows, and therefore we enforce
that only 40% of residents in each cell travel (inside or
out) [42]. Cities in this idealized configuration maintain
their empirical Φ, this design has the effect of scaling
flows by a constant factor, without altering the network
structure or the relative ranking of cell outflows.
To produce instances of a single city with different
values of Φ , we reshuffle a portion of randomly
selected links by picking a new destination at random
while maintaining the link-weights. This procedure
creates multiple realizations of the city, preserving the
population distribution and densities, as well as the total
number of trips along with the number of destinations
per origin. To simulate the effect of lockdowns, we
replace the pre-lockdown empirical mobility network with
the post-lockdown version once the fraction of infected
individuals in the population reaches a threshold Pth .
The mobility is reduced according to the empirical trip
decrease in every cell, and a fraction XS of susceptible
individuals are considered as non-interacting [43–45].
The parameter Pth controls the time of the lockdown,
while XS determines its severity. (See Methods for
a detailed description of the model and the values of
relevant epidemic parameters.)
We begin by checking whether the model can
reproduce the trend in Fig. 3a. The equivalent plot
for three representative cities is shown in Fig. 4a,
where we extract Reff from the incidence curves of the
simulations. The onset is set at 104 accumulated cases
and hRearly i is averaged over three weeks after onset, as
done for the empirical data. The R2 for each individual
city ranges from 0.95 − 0.97 indicating a clear signal
for the transmissibility increasing with centralization.
When measuring the correlation for the three cities
collectively, confounding factors such as differences in
population density and mobility distributions emerge,
and R2 decreases to 0.63 in order of magnitude agreement
with that seen for Fig. 3a obtained aggregating 22
different cities. Similar to that seen for Fig. 3b, we also
reproduce the observation of the peak incidence Imax
being monotonic in Φ as shown in Fig. 4b. This is
reflected in the final size of the outbreak (Fig. 4c) and the
time taken to reach the peak incidence (Supplementary
Figure 12), with more centralized cities experiencing
stronger transmission, faster spread and wider prevalence
in the population. These attributes in combination
can rapidly overwhelm hospital capacity as well as the

6

FIG. 3: Connecting hierarchy with epidemic features and mitigation efforts. Shown are the top 22 US
cities by number of counties with more than two million inhabitants until June 14, 2020. a Average Reff over three
weeks after the onset of 100 cases as a function of Φ. Initial transmission increases with centralization. b
Accumulated number of new cases per capita two weeks before the maximum incidence Imax . Cities in pale yellow
have already peaked, while infections continue to grow in those marked in red. The figure suggests the extent of
spread is strongly correlated with centralization. In c, Φ versus relative decrease in total flow. Mobility reductions
are much more drastic in centralized cities. d Synchronization of mobility reduction and contagion spread among
city counties measured through the Pearson coefficient of plots as those shown in Fig. 2 g-i for Atlanta, Chicago and
NYC. Response to mitigation is more sensitive in cities with higher Φ. (The equivalent figures for all 22 cities are
shown in Supplementary Fig. 10). These results were obtained with data from the New York Times (Supplementary
Table 1). We show the equivalent plots using an alternative data source, USAFacts, in Supplementary Fig. 11.

healthcare system at large, and is indeed what was seen
in hierarchical cities such as NYC, London and Milan.
On the other hand, Fig. 3d suggests that cities
with higher Φ largely achieved a better reduction in
transmission with lockdown measures. To simulate this,
in Fig. 4d we plot the final size of the pandemic by
instituting an 80% reduction in interactions (Xs = 0.8)
with the lockdown coming into effect at Pth = 5 × 10−3 .
Remarkably we see an inversion of the curve as compared
to Fig. 4c with the trends now reversed; the final size
of the pandemic is lower in cities with higher Φ and
is decreased by an order of magnitude as compared to

the scenario with no mitigation. The inversion of the
curve resulted from a rather strong lockdown, so in
Fig. 4e we show the case for a softer lockdown with
Xs = 0.4; here we see the same trend with Φ as in
the case with no lockdown, however, the size of the
outbreak is reduced by a factor of five. In addition the
time taken to institute mobility restriction measures is
a crucial parameter, and in Fig. 4f, we show the case
for an earlier (but still soft) lockdown with Xs = 0.4 and
Pth = 10−3 , finding a further decrease by a factor of three
in the pandemic size. In terms of assessing the effect of
different flavors of lockdowns, the connection between the

7

FIG. 4: Modeling disease spread by type of city. Results of a metapopulation model using the S2 cells as basic
geographical units. Simulations are run in each city with different values of Φ, obtained by the randomization
procedure described in the text. Each box reflects 100 runs and displays the median, quartiles, the 5% and 95%
confidence intervals. In a, Reff in the early stages, averaged over three weeks after the onset of 104 cases as a
function of Φ, as in Fig. 3a. The peak incidence Imax is shown in b, and the final epidemic size in c both as a
function of Φ. All three panels correspond to the baseline mobility before lockdown. In d-f we show the pandemic
size for three different lockdown scenarios: a strong lockdown, Xs = 0.8, for Pth = 5 × 10−3 ; a soft lockdown,
Xs = 0.4, at the same prevalence, and finally a soft but earlier lockdown XS = 0.4 and Pth = 10−3 .

size of the outbreak and its dependence on Φ, is in general
a complex function of the epidemiological parameters,
the extent of mobility reduction and the distribution of
flows. In Supplementary Figs. 13-15, we explore aspects
of this interdependence for different values of R0 and XS ,
confirming that when lockdown measures are enforced in
time and in strength, centralized cities while being more
susceptible, outperform or do at least as well as sprawled
cities in mitigating the outbreak.
In summary, we studied how mobility restrictions

in urban areas affect the propagation of an infectious
disease. We leveraged a massive global dataset that
captures aggregate flows of populations around the
globe in a consistent way since pre-pandemic times
all the way to the most recent week. In a previous
work, we had shown that hierarchical cities have better
indicators in terms of the use of public transportation,
walking, emissions per-capita and health indicators.
However, their mobility structure favors spreading of
infectious diseases in terms of speed and extent of the

8
contagions. At the same time, lockdown and travel
restriction measures can lead to better outcomes in more
hierarchical cities. From a policy-making point of view,
it seems prudent to deploy robust early warning systems
within hierarchical cities in particular. Furthermore, it is
effective to enforce mitigation measures as early and as
thoroughly as possible, given that the time-to-response
is particularly crucial in hierarchical cities within or
near an epidemic outbreak. Sprawled cities, with their
distributed mobility and less connected outbreaks, have
a larger window of time within which to enforce policy
measures, yet even so, the intensity of response is
important to reduce the final number of cases. These
findings, while presented in the context of COVID-19,
are also applicable to other potential infectious diseases.
These results shed new light on the ongoing debate on the
best design for cities, balancing between the multiplier
effects that lead to socio-economic development against
their susceptibility to threats such as pandemics.

Methods

Mobility data sets.
The mobility flows are
sourced from the Google COVID-19 Aggregated
Mobility Research Dataset, containing anonymized trips
aggregated over users who have turned on the Location
History setting, which is off by default. This is similar
to the data used to show how busy certain types of
places are in Google Maps, helping identify when a local
business tends to be the most crowded. The dataset
aggregates flows of populations between S2 cells (https:
//github.com/google/s2geometry) of approximately 5
km2 . To produce this dataset, machine learning is
applied to logs data to automatically segment it into
semantic trips [35]. To provide strong privacy guarantees,
all trips were anonymized and aggregated using a
differentially private mechanism [46] to aggregate flows
over time. This research is done on the resulting heavily
aggregated and differentially private data. No individual
user data was ever manually inspected, only heavily
aggregated flows of large populations were handled.
Limitations. The results should be interpreted in
light of several limitations. First, the Google mobility
data is limited to smartphone users who have opted
in to Googles Location History feature. These data
may not be representative of the population as whole,
and furthermore their representativeness may vary by
location. Importantly, these limited data are only
viewed through the lens of differential privacy algorithms,
specifically designed to protect user anonymity and
obscure fine detail. Moreover, comparisons across rather
than within locations are only descriptive since these
regions can differ in substantial ways.
Epidemic data sets. The epidemic data has been
downloaded from sources listed in the Data Availability
statement and in Supplementary Table 1.
Mobility flows in urban areas. The flows are

incorporated in an Origin-Destination matrix T(t),
whose elements Tij (t) encode the trip flow at week t
between the two spatial units i and j. The diagonal
terms Tii correspond to movements within the area. The
geographical unit corresponds to S2 cells of 5 km2 . The
total flow of a territory is the sum P
of the trips over all
the S2 cells present in the city, T = i,j Tij . In general,
the relative trip-flow change between two timestamps t1
and t2 is calculated as (T (t1 ) − T (t2 )) /T (t2 ). Note that
when we estimate the reduction after lockdown, t2 refers
to the mobility prior to the restrictions and t1 after the
lockdown.
Hierarchical structure of urban mobility. To
calculate Φ, a hotspot level is assigned to each
geographical unit (S2 cells), using a recurrent Lorenz
curve as explained in Ref. [35]. Once every cell i is
assigned a level Li , trip flows between cells are aggregated
as:
P
i<j Tij δ(Li , `) δ(Lj , m)
P
(1)
S`m =
i<j Tij

where ` and m are the levels and δ(x, y) is the Kronecker
delta. The flows S`m are normalized by the total flow
in the city. Self-flows within cells are not considered
when calculating S`m . With these definitions, the flow
hierarchy Φ is calculated according to
X
Φ=
S`m {δ(`, m) + δ(`, m − 1) + δ(` − 1, m)} . (2)
`,m

Calculation of driving between incidence curves.
In order to quantify the driving in the spreading
between different areas of a city, we calculated the
transfer entropy[47] between the time series of the
disease incidence at the county (borough) level for time
windows of increasing sizes. Starting from the first
reported case to the latest available data (in most cases,
the first week of June 2020, see the Supplementary
Information for details on the epidemiological data).
For each time window, the driving each administrative
unit i had over the others is calculated
as the average
P
transfer entropy hTEii = 1/N j TEij between the
incidence time series of unit i and all the other units
j, with N the number of administrative units in the
city. The transfer entropy was evaluated using the
RTransferEntropy library (https://cran.r-project.
org/web/packages/RTransferEntropy/vignettes/
transfer-entropy.html) in R, that also provides an
estimation of the statistical significance of the results.
SEIR metapopulation model.
The model is
structured in a meta-population framework with
Susceptible S, Exposed E, Infected I and Recovered
R compartments and taking as basic spatial units the
S2 cells provided by the mobility data. The whole
population of the city P
P is distributed among the cells i,
according to pi = P ( j Tij )/T where the index j runs
over all cells including i and T corresponds to the total
trips of the city. In the model without travel restrictions,

9
40% of the population of every cell i moves and selects
their destination proportional to outflow Tij from i to the
other cells j (including Tii ). The choice of a 40% mobility
has been made in accordance with previous research,
where it has been shown that for commuting flows, only
a fraction of the population actively moves[11, 42]. Also
note that non-moving individuals are not excluded from
the epidemic dynamics but interactions occur inside their
cell of residence. To incorporate commuting flows inside
the epidemic dynamics, we followed a classical approach
for metapopulation models with recurrent mobility[11,
42, 48]: introducing an effective force of infection for
individuals residing at cell j, defined as λj . λj accounts
for both the force of infection seen by an individual inside
their residence cell λjj and while commuting to other cells
λji and can be calculated as
λj =

X λji σji /τ
λjj
+
1 + σj /τ
1 + σj /τ

household; not participating in the global spreading
process directly.
This effect has been modeled in
the literature [43–45] by including a fraction XS of
susceptible individuals who do not participate in the
infection process. In the main text, XS is fixed at
0.8 with further values explored in Fig. 4e and f and
in Supplementary Figs. 14-16. Finally, in order to
model the fact that restrictive measures are enforced
when outbreaks are discovered in the city, we assume
that both travel restrictions and stay-at-home orders are
imposed once the prevalence of the disease reached a
certain threshold Pth , equal for all the cities considered.
Unless otherwise specified, the particular parameters
selected for the model are: the infectivity per contact
β = 0.4 days−1 , the average time spent as infectious
tI = µ−1 = 3.8 days and average time as exposed
tE = 3.7 days.

(3)

i∈v(j)

where σj represents the travel rate of individuals in j,
σji the travel rate between cells j and i while τ accounts
for the time usually spent outside the home cell during a
working day (τ −1 ∼ 1/3 day) and the sum runs over all
the neighbors i of cell j, v(j). Finally, λjj and λji are
calculated as:


X
Sji
β 
Ilj 
λji = ∗ Iji +
(4)
Nj
Si
l∈v(j)

where β is the per contact infection rate, Nj∗ is the
effective population of j having into account commuting
and the subscripts in Iij (resp Sij ) refer to the infected
(susceptible) visitors from i in j (for a detailed derivation
of λj and λji see section 4.3 of [42]).
Effect of mobility restrictions and stay-at-home
orders. To model the effect of lockdowns on mobility,
we need to consider that mobility flows change in both
magnitude and destination in response to the restrictions.
With reductions that can reach up to 80% reduction of
flows compared to baseline levels. In the metapopulation
model and for sake of simplicity, for each city only two
mobility networks have been extracted from the Google
COVID-19 Aggregated Mobility Research Dataset: one
considering a typical day prior to restrictions Tij and
another after restrictions have been imposed,
Lij . The
P
total trips per cell i are then Ti =
Tij and Li =
j
P
j Lij . As for the normal mobility regime, where we
impose that the 40% of population of each cell will
move with destinations proportional to Tij , during travel
restrictions we assume that flows and destinations are
chosen according to the new mobility matrix Lij . Since
travel flows in matrix L are usually smaller than flows
in T, the total reduction in mobility is Li /Ti , with the
fraction of individuals traveling in the system 0.4 (Li /Ti ).
In addition, it is important to note that during
stay-at-home orders part of the population remained
isolated or only interacted with individuals in their

Acknowledgments

We thank Aaron Schneider, Aaron Stein, Ahmed
Aktay, Alvin Raj, Amy Chung-Yu Chou, Andrew
Oplinger, Ashley Zlatinov , Blaise Aguera y Arcas,
Bryant Gipson, Charina Chou, Christopher Pluntke,
Damien Desfontaines, Eric Tholome, Ewa Dominowska,
Gregor Rothfuss, Iz Conroy, Janel Thamkul, Janet
Whiteman, Jason Freidenfelds, Jeff Dean, Karen Lee
Smith, Katherine Chou, Leeron Morad, Lizzie Dorfman,
Marlo McGriff, Mia Vu, Michael Howell, Paul Eastham,
Rif Saurous, Rishi Bal, Royce Wilson, Ruth Alcantara,
Shawn O’Banion, Stephanie Cason, Thomas Roessler,
Vivien Hoang, Yanning Zhang, Xue Ben and Brian
Dickinson for their support and guidance.
M.M. is funded by the Conselleria d’Innovació,
Recerca i Turisme of the Government of the Balearic
Islands and the European Social Fund with grant code
FPI/2090/2018. J.A., M.M., S.M. and J.J.R. also
acknowledge funding from the project Distancia-COVID
(CSIC-COVID-19) of the CSIC funded by a contribution
of AENA, from the Spanish Ministry of Science and
Innovation, the AEI and FEDER (EU) under the
grant PACSS (RTI2018-093732-B-C22) and the Maria
de Maeztu program for Units of Excellence in R&D
(MDM-2017-0711). A.B. and V.N. acknowledge support
from the UK EPSRC New Investigator Award Grant
No. EP/S027920/1. GG, SH and SM acknowledge
support from from NSF Grant IIS-2029095 and the
US Army Research Office under Agreement Number
W911NF-18-1-0421. A.K. is supported by the National
Defense Science and Engineering Graduate Fellowship
through the Department of Defense.

Author contributions

G.G., S. Meloni, V.N., J.J.R. and A.S. developed the
concepts and designed the study. A.B., S.H., A.K., M.M.

10
and S. Mimar analyzed the data. A.S. computed and
provided the mobility map data. J.A., S. Meloni and
J.J.R. developed the model. J.A. performed the model
simulations. G.G., M.M., S. Meloni, J.J.R. and A.S.
contributed to the work methodology. G.G., M.M., S.
Meloni, V.N. and J.J.R wrote the paper. G.G., S. Meloni,
J.J.R. and A.S. coordinated the study. All authors read,
edited, and approved the final version of the paper. The
authors are listed in alphabetical order.

The Google COVID-19 Aggregated Mobility Research
Dataset used for this study is available with permission
from Google LLC.
Covid data sources:
World:
https://www.ecdc.europa.eu/en/

publications-data/download-todays-data-geographic
-distribution-covid-19-cases-worldwide
Italy: https://github.com/pcm-dpc/COVID-19
USA:
New
York
Times
https://github.
com/nytimes/covid-19-data
and
USAFacts
https://usafacts.org/visualizations/
coronavirus-covid-19-spread-map/
Spain:
https://github.com/montera34/
escovid19data
South
Korea:
https://
www.kaggle.com/marcuswingen/
analysis-of-covid-19-data-from-south-korea
India: https://www.kaggle.com/sudalairajkumar/
covid19-in-india/data#
The code to calculate the flow hierarchy in cities
is available in the following link: https://mygit.
katolaz.net/aleix/flow-hierarchy.

[1] A. Flahault and A.-J. Valleron, Mathematical Population
Studies 3, 161 (1992).
[2] R. F. Grais, J. H. Ellis, and G. E. Glass, European
Journal of Epidemiology 18, 1065 (2003).
[3] L. Hufnagel, D. Brockmann, and T. Geisel, Procs. Nat.
Acad. Sci. U.S.A. 101, 15124 (2004).
[4] J. S. Brownstein, C. J. Wolfe, and K. D. Mandl, PLoS
Medicine 3, e401 (2006).
[5] V. Colizza, A. Barrat, M. Barthélemy, and A. Vespignani,
Procs. Nat. Acad. Sci. U.S.A. 103, 2015 (2006).
[6] V. Colizza, A. Barrat, M. Barthelemy, A.-J. Valleron,
and A. Vespignani, PLoS Medicine 4 (2007).
[7] A. Tatem, Z. Huang, A. Das, Q. Qi, J. Roth, and Y. Qiu,
Parasitology 139, 1816 (2012).
[8] F. Finger, T. Genolet, L. Mari, G. C. de Magny, N. M.
Manga, A. Rinaldo, and E. Bertuzzo, Procs. Nat. Acad.
Sci. U.S.A. 113, 6421 (2016).
[9] Q. Zhang, K. Sun, M. Chinazzi, A. P. y Piontti, N. E.
Dean, D. P. Rojas, S. Merler, D. Mistry, P. Poletti,
L. Rossi, et al., Procs. Nat. Acad. Sci. U.S.A. 114, E4334
(2017).
[10] H. Barbosa, M. Barthelemy, G. Ghoshal, C. R. James,
M. Lenormand, T. Louail, R. Menezes, J. J. Ramasco,
F. Simini, and M. Tomasini, Physics Reports 734, 1
(2018).
[11] D. Balcan, V. Colizza, B. Gonçalves, H. Hu, J. J.
Ramasco, and A. Vespignani, Procs. Natl. Acad. Sci.
U.S.A. 106, 21484 (2009).
[12] M. Gilbert, G. Pullano, F. Pinotti, E. Valdano,
C. Poletto, P.-Y. Boëlle, E. d’Ortenzio, Y. Yazdanpanah,
S. P. Eholie, M. Altmann, et al., The Lancet 395, 871
(2020).
[13] M. U. Kraemer, C.-H. Yang, B. Gutierrez, C.-H. Wu,
B. Klein, D. M. Pigott, L. Du Plessis, N. R. Faria, R. Li,
W. P. Hanage, et al., Science 368, 493 (2020).
[14] M. Mazzoli, D. Mateo, A. Hernando, S. Meloni, and J. J.
Ramasco, medRxiv p. 2020.05.09.20096339 (2020).
[15] B. Rader, S. Scarpino, A. Nande, A. Hill, R. Reiner,
D. Pigott, B. Gutierrez, M. Shrestha, J. Brownstein,
M. Castro, et al., medRxiv p. 2020.04.15.20064980

(2020).
[16] N. M. Ferguson, D. A. Cummings, S. Cauchemez,
C. Fraser, S. Riley, A. Meeyai, S. Iamsirithaworn, and
D. S. Burke, Nature 437, 209 (2005).
[17] T. D. Hollingsworth, N. M. Ferguson, and R. M.
Anderson, Nature Medicine 12, 497 (2006).
[18] J. M. Epstein, D. M. Goedecke, F. Yu, R. J. Morris, D. K.
Wagener, and G. V. Bobashev, PloS ONE 2, e401 (2007).
[19] P. Bajardi, C. Poletto, J. J. Ramasco, M. Tizzoni,
V. Colizza, and A. Vespignani, PLOS ONE 6, e16591
(2011).
[20] S. Meloni, N. Perra, A. Arenas, S. Gómez, Y. Moreno,
and A. Vespignani, Scientific Reports 1, 62 (2011).
[21] C. Poletto, M. F. Gomes, A. P. y Piontti, L. Rossi,
L. Bioglio, D. L. Chao, I. M. Longini, M. E. Halloran,
V. Colizza, and A. Vespignani, Eurosurveillance 19,
20936 (2014).
[22] H. Fang, L. Wang, and Y. Yang, Tech. Rep., National
Bureau of Economic Research (2020).
[23] E. Pepe, P. Bajardi, L. Gauvin, F. Privitera,
B. Lake, C. Cattuto, and M. Tizzoni, medRxiv p.
2020.03.22.20039933 (2020).
[24] M. Chinazzi, J. T. Davis, M. Ajelli, C. Gioannini,
M. Litvinova, S. Merler, A. P. y Piontti, K. Mu, L. Rossi,
K. Sun, et al., Science 368, 395 (2020).
[25] A. Pan, L. Liu, C. Wang, H. Guo, X. Hao, Q. Wang,
J. Huang, N. He, H. Yu, X. Lin, et al., Jama (2020).
[26] M. Gatto, E. Bertuzzo, L. Mari, S. Miccoli, L. Carraro,
R. Casagrandi, and A. Rinaldo, Procs. Nat. Acad. Sci.
U.S.A. 117, 10484 (2020).
[27] S. Pei, S. Kandula, and J. Shaman, medRxiv p.
2020.05.15.20103655 (2020).
[28] N. Haug, L. Geyrhofer, A. Londei, E. Dervic,
A. Desvars-Larrive, V. Loreto, B. Pinior, S. Thurner, and
P. Klimek, medRxiv (2020).
[29] J. Dehning, J. Zierenberg, F. P. Spitzner, M. Wibral, J. P.
Neto, M. Wilczek, and V. Priesemann, Science 369, 160
(2020).
[30] B. F. Maier and D. Brockmann, Science 368, 742 (2020).
[31] H. P. Melo, J. Henriques, R. Carvalho, T. Verma, J. P.

Data and code availability statement

11

[32]
[33]

[34]
[35]

[36]

[37]
[38]
[39]
[40]

da Cruz, and N. Araujo, arXiv preprint arXiv:2006.15724
(2020).
F. Schlosser, B. F. Maier, D. Hinrichs, A. Zachariae, and
D. Brockmann, arXiv preprint arXiv:2007.01583 (2020).
T. Louail, M. Lenormand, O. G. C. Ros, M. Picornell,
R. Herranz, E. Frias-Martinez, J. J. Ramasco, and
M. Barthelemy, Scientific Reports 4, 5276 (2014).
R. Ewing and S. Hamidi, Journal of Planning Literature
30, 413 (2015).
A. Bassolas, H. Barbosa-Filho, B. Dickinson,
X. Dotiwalla, P. Eastham, R. Gallotti, G. Ghoshal,
B. Gipson, S. A. Hazarie, H. Kautz, et al., Nature
Communications 10, 4817 (2019).
P. Zhou, X.-L. Yang, X.-G. Wang, B. Hu, L. Zhang,
W. Zhang, H.-R. Si, Y. Zhu, B. Li, C.-L. Huang, et al.,
Nature 579, 270 (2020).
F. Wu, S. Zhao, B. Yu, Y.-M. Chen, W. Wang, Z.-G.
Song, Y. Hu, Z.-W. Tao, J.-H. Tian, Y.-Y. Pei, et al.,
Nature 579, 265 (2020).
L. Varga, A. Kovács, G. Tóth, I. Papp, and Z. Néda,
PLOS ONE 11, e0148913 (2016).
M. Tizzoni, Estimating covid-19’s rt in real-time (2020),
URL https://github.com/micheletizzoni/covid-19.
L. M. Bettencourt and R. M. Ribeiro, PLoS ONE 3

(2008).
[41] G. Pullano, E. Valdano, N. Scarpa, S. Rubrichi, and
V. Colizza, medRxiv p. 2020.05.29.20097097 (2020).
[42] D. Balcan, B. Gonçalves, H. Hu, J. J. Ramasco,
V. Colizza, and A. Vespignani, Journal of Computational
Science 1, 132 (2010).
[43] L. Di Domenico, G. Pullano, C. E. Sabbatini, P.-Y.
Boëlle, and V. Colizza, medRxiv p. 2020.04.13.20063933
(2020).
[44] A. Aleta, D. Martin-Corral, A. Pastore y Piontti,
M. Ajelli, M. Litvinova, M. Chinazzi, N. E. Dean, M. E.
Halloran, I. M. Longini, S. Merler, et al., medRxiv p.
2020.05.06.20092841 (2020).
[45] A. Arenas, W. Cota, J. Gomez-Gardenes, S. Gómez,
C. Granell, J. T. Matamalas, D. Soriano-Panos, and
B. Steinegger, medRxiv p. 2020.03.21.20040022 (2020).
[46] R. Wilson, C. Y. Zhang, W. Lam, D. Desfontaines,
D. Simmons-Marengo, and B. Gipson (2020).
[47] T. Bossomaier, L. Barnett, M. Harré, and J. T. Lizier,
Cham: Springer International Publishing pp. 65–95
(2016).
[48] L. Sattenspiel and K. Dietz, Mathematical Biosciences
128, 71 (1995).

Supplementary Information
Impact of urban structure on COVID-19 spread

arXiv:2007.15367v1 [physics.soc-ph] 30 Jul 2020

J. Aguilar, A. Bassolas, G. Ghoshal, S. Hazarie, A. Kirkley, M. Mazzoli, S. Meloni,
S. Mimar, V. Nicosia, J.J. Ramasco & A. Sadilek

Table of Contents
1 Geographical data

2

2 Epidemic data

2

3 Multiscale mobility reduction across countries

6

4 Mobility restrictions & its effect on spreading

9

5 Flow hierarchy

15

6 The metapopulation model

19

1

J. Aguilar et al.

1

2

Geographical data

The city boundaries used throughout the study are the functional urban areas provided by the OECD
https://ec.europa.eu/eurostat/statistics-explained/index.php/Glossary:Functional_
urban_area.

2

Epidemic data

Country

URL

Description

World

ecdc.europa.eu/en/publications-data/

Italy

github.com/pcm-dpc/COVID-19

USA

github.com/nytimes/covid-19-data

USA-2

usafacts.org/visualizations/
coronavirus-covid-19-spread-map/
github.com/montera34/escovid19data

European Centre for
Disease Prevention and Control
Protezione Civile
official monitoring of Covid cases
New York Times coverage of
covid cases by counties
USAFacts alternative coverage of
covid cases by counties
Independent coverage
of covid cases
Official coverage from Korea Centers for
Disease Control & Prevention
Official coverage from Indian Ministry of
Health & Family Welfare

Spain
South Korea
India

kaggle.com/marcuswingen/
analysis-of-covid-19-data-from-south-korea
kaggle.com/sudalairajkumar/
covid19-in-india/data20

Supplementary Table 1: Covid data sources.

Impact of urban structure on COVID-19 spread

J. Aguilar et al.

3

Countries

Countries

Countries

Countries

Afghanistan
Angola
Argentina
Australia
Austria
Bahrain
Bangladesh
Belarus
Belgium
Bolivia
Bosnia and Herzegovina
Brazil
Bulgaria
Burkina Faso
Cambodia
Cameroon
Canada
Chile
Colombia
Costa Rica
Croatia
Czechia
Denmark
Dominican Republic
Ecuador
Egypt
El Salvador
Estonia

Finland
France
Gabon
Georgia
Germany
Ghana
Greece
Guatemala
Haiti
Honduras
Hungary
India
Indonesia
Iraq
Ireland
Israel
Italy
Jamaica
Japan
Jordan
Kazakhstan
Kenya
Kuwait
Kyrgyzstan
Latvia
Lebanon
Libya
Lithuania

Luxembourg
Malaysia
Mali
Malta
Mauritius
Mexico
Moldova
Mongolia
Morocco
Myanmar
Netherlands
New Zealand
Nicaragua
Niger
Nigeria
Norway
Oman
Pakistan
Panama
Paraguay
Peru
Philippines
Poland
Portugal
Qatar
Romania
Russia
Rwanda

Saudi Arabia
Senegal
Singapore
Slovakia
Slovenia
South Africa
South Korea
Spain
Sri Lanka
Sweden
Switzerland
Taiwan
Tajikistan
Thailand
Togo
Trinidad and Tobago
Turkey
Uganda
Ukraine
United Arab Emirates
United Kingdom
United Republic of Tanzania
United States of America
Uruguay
Venezuela
Vietnam
Yemen
Zambia

Supplementary Table 2: Table of world countries considered in Figure 1.

Impact of urban structure on COVID-19 spread

J. Aguilar et al.

4

Province

Province

Province

Province

Province

Agrigento
Alessandria
Ancona
Aosta
Arezzo
Ascoli Piceno
Asti
Avellino
Bari
Barletta-Andria-Trani
Belluno
Benevento
Bergamo
Biella
Bologna
Bolzano/Bozen
Brescia
Brindisi
Cagliari
Caltanissetta
Campobasso
Caserta

Catania
Catanzaro
Chieti
Como
Cosenza
Cremona
Crotone
Cuneo
Enna
Fermo
Ferrara
Firenze
Foggia
ForlâĂĲ-Cesena
ForlÃň-Cesena
Frosinone
Genova
Gorizia
Grosseto
Imperia
Isernia
LâĂŹAquila

La Spezia
Latina
Lecce
Lecco
Livorno
Lodi
Lucca
Macerata
Mantova
Massa-Carrara
Matera
Messina
Milano
Modena
Monza e della Brianza
Napoli
Novara
Nuoro
Oristano
Padova
Palermo
Parma

Pavia
Perugia
Pesaro e Urbino
Pescara
Piacenza
Pisa
Pistoia
Pordenone
Potenza
Prato
Ragusa
Ravenna
Reggio di Calabria
Reggio nellâĂŹEmilia
Rieti
Rimini
Roma
Rovigo
Salerno
Sassari
Savona
Siena

Siracusa
Sondrio
Sud Sardegna
Taranto
Teramo
Terni
Torino
Trapani
Trento
Treviso
Trieste
Udine
Varese
Venezia
Verbano-Cusio-Ossola
Vercelli
Verona
Vibo Valentia
Vicenza
Viterbo

Supplementary Table 3: Table of Italian provinces considered in Figure 1.
Provinces

Provinces

Provinces

Provinces

A CoruÃśa
ÃĄlava
Albacete
Alicante
AlmerÃŋa
Asturias
ÃĄvila
Badajoz
Baleares
Barcelona
Burgos
CÃąceres
CÃądiz

Cantabria
CastellÃşn
Ceuta
Ciudad Real
CÃşrdoba
Cuenca
Girona
Granada
Guadalajara
GuipÃžzcoa
Huelva
Huesca
JaÃľn

La Rioja
Las Palmas
LeÃşn
Lleida
Lugo
Madrid
MÃąlaga
Melilla
Murcia
Navarra
Ourense
Palencia
Pontevedra

Salamanca
Santa Cruz de Tenerife
Segovia
Sevilla
Soria
Tarragona
Teruel
Toledo
Valencia
Valladolid
Vizcaya
Zamora
Zaragoza

Supplementary Table 4: Table of Spanish provinces considered in Figure 1.
Provinces

Provinces

Provinces

Busan
Chungcheongbuk-do
Chungcheongnam-do
Daegu
Daejeon
Gangwon-do

Gwangju
Gyeonggi-do
Gyeongsangbuk-do
Gyeongsangnam-do
Incheon
Jeju-do

Jeollabuk-do
Jeollanam-do
Sejong
Seoul
Ulsan

Supplementary Table 5: Table of South Korean first-tier administrative divisions considered
in Figure 1.
Impact of urban structure on COVID-19 spread

J. Aguilar et al.

5

States

States

States

States

Andhra Pradesh
Assam
Bihar
Chandigarh
Chhattisgarh
Delhi
Gujarat

Haryana
Jammu and Kashmir
Jharkhand
Karnataka
Kerala
Madhya Pradesh
Maharashtra

Odisha
Punjab
Rajasthan
Tamil Nadu
Telengana
Tripura
Uttar Pradesh

Uttarakhand
West Bengal

Supplementary Table 6: Table of Indian States considered in Figure 1.

Cities

Cities

Cities

Cities

Atlanta
Austin
Boston
Charlotte
Chicago
Cincinnati
Columbus
Cuyahoga
Dallas
Davidson
Denver
Detroit
Fresno

Hartford
Houston
Indianapolis
Jackson
Jacksonville
Jefferson
Las Vegas
Los Angeles
Memphis
Miami
Milwaukee
Minneapolis
New Haven

New Orleans
New York
Oklahoma
Orange
Philadelphia
Phoenix
Pima
Pittsburgh
Portland
Richmond
Sacramento
Salt Lake
San Antonio

San Diego
San Francisco
Seattle
St. Louis
Tulsa
Virginia Beach
Wake
Washington

Supplementary Table 7: Table of US cities considered in Figure 1.

Impact of urban structure on COVID-19 spread

J. Aguilar et al.

Multiscale mobility reduction across countries
New York
Los Angeles
Chicago
Dallas
Miami

1.0

San Francisco
Houston
Atlanta
Phoenix
Philadelphia

0.8

T

USA

T

0.0

1.2

1.0

T

0.8
Seoul
Busan
Taegu
Taejon
Gwangju

0.6

(d)

Ulsan
Chonju
Pohang
Cheju
Iksan

2020-02-02
2020-02-09
2020-02-16
2020-02-23
2020-03-01
2020-03-08
2020-03-15
2020-03-22
2020-03-29
2020-04-05
2020-04-12
2020-04-19
2020-04-26
2020-05-03
2020-05-10
2020-05-17
2020-05-24
2020-05-31
2020-06-07

0.4

0.6

Malaga
Murcia
Granada
Vigo
Palma

Spain

1.2

T

0.4
0.2

(e)

Goteborg
Malmo
Stockholm

Uppsala
Vasteras

Salerno
Palermo
Catania
Genoa
Bari

Italy

1.0
0.8

T

0.8

0.4

0.8

Milan
Rome
Naples
Torino
Florence

0.6

1.0

0.6

(c)

1.0

0.2

South
Korea

1.2

Madrid
Barcelona
Seville
Bilbao
Zaragoza

0.8
0.4

2020-02-02
2020-02-09
2020-02-16
2020-02-23
2020-03-01
2020-03-08
2020-03-15
2020-03-22
2020-03-29
2020-04-05
2020-04-12
2020-04-19
2020-04-26
2020-05-03
2020-05-10
2020-05-17
2020-05-24
2020-05-31
2020-06-07

0.4

(b)

1.0

2020-02-02
2020-02-09
2020-02-16
2020-02-23
2020-03-01
2020-03-08
2020-03-15
2020-03-22
2020-03-29
2020-04-05
2020-04-12
2020-04-19
2020-04-26
2020-05-03
2020-05-10
2020-05-17
2020-05-24
2020-05-31
2020-06-07

0.6

1.2

India

Mumbai
Kolkata
Delhi
Madras
Bangalore

Hyderabad
Ahmedabad
Pune
Surat
Kanpur

0.6
0.4

Sweden

0.2

(f)
2020-02-02
2020-02-09
2020-02-16
2020-02-23
2020-03-01
2020-03-08
2020-03-15
2020-03-22
2020-03-29
2020-04-05
2020-04-12
2020-04-19
2020-04-26
2020-05-03
2020-05-10
2020-05-17
2020-05-24
2020-05-31
2020-06-07

T

(a)

2020-02-02
2020-02-09
2020-02-16
2020-02-23
2020-03-01
2020-03-08
2020-03-15
2020-03-22
2020-03-29
2020-04-05
2020-04-12
2020-04-19
2020-04-26
2020-05-03
2020-05-10
2020-05-17
2020-05-24
2020-05-31
2020-06-07

1.2

2020-02-02
2020-02-09
2020-02-16
2020-02-23
2020-03-01
2020-03-08
2020-03-15
2020-03-22
2020-03-29
2020-04-05
2020-04-12
2020-04-19
2020-04-26
2020-05-03
2020-05-10
2020-05-17
2020-05-24
2020-05-31
2020-06-07

3

6

Supplementary Figure 1: Changes in mobility in 10 major cities of 6 countries that applied
different mitigation strategies . Curves in panels a-f represent temporal change in mobility compared
to the baseline average mobility in February.
The reduction of mobility has an uneven impact across the different scales in a city. As we show in
Supplementary Figure 2 for the United Kingdom, the longest trips beyond the city scale incur a more
drastic decrease in mobility, which can be observed in both the CCDF and the associated bar plot.
Similar plots where the same trend can be observed are shown in Supplementary Figures 3 and 4 for the
United States and Spain, respectively.

a

b

Supplementary Figure 2: Reduction of mobility at different scales in the United Kingdom. a
Complementary cumulative distribution of trip distances in 09-02-2020 and in 29-03-2020. b Percentage
of change in total flow as a function of the distance of the trips.

Impact of urban structure on COVID-19 spread

J. Aguilar et al.

a

7

b

Supplementary Figure 3: Reduction of mobility at different scales in the United States of
America. a Complementary cumulative distribution of trip distances in a 09-02-2020 and in 29-032020. b Percentage of change in total flow as a function of the distance of the trips.

a

b

Supplementary Figure 4: Reduction of mobility at different scales in Spain. a Complementary
cumulative distribution of trip distances in a 09-02-2020 and in 29-03-2020. b Percentage of change in
total flow as a function of the distance of the trips.

Impact of urban structure on COVID-19 spread

J. Aguilar et al.

8

100

10

Spain

3
Italy

80

Sweden

% Decrease in Mobility

4

60
US

# new cases per week per capita

10

10

5

10

6

10

7

South Korea

40
ia
Ind

0

2

20
4
6
weeks after 100th case

8

10

0

Supplementary Figure 5: Number of new cases per capita and mobility change in 6 countries
starting from the week after 100th case. Curves are colored according to the percentage mobility
change in each country relative to the week after reaching 100 cases.

Impact of urban structure on COVID-19 spread

J. Aguilar et al.

4

9

Mobility restrictions & its effect on spreading
a

0.45

Normalized Flow

Original Hotspots

0.50

Mean

0.40

0.35

0.30

b

0.25

Weekly Hotspots

0.50

Normalized Flow

0.45

0.40

0.35

0.30

0.25
2020-01-05 to 2020-01-11

2020-03-15 to 2020-03-21
2020-02-09 to 2020-02-15

2020-05-24 to 2020-05-30
2020-04-19 to 2020-04-25

Week

Supplementary Figure 6: Flows to hotspots. a The normalized flow to inflow hotspots calculated
at the week of January 5 2020, over time, for the top 50 CBSAs in the US (only curves between .25
and .5 shown, with the mean in gray.) We see that the epidemic conditions cause the flows to the
original hotspots to decrease, indicating a shift in travel destinations. b The normalized flow to hotspots
calculated at each week. We see that the flows increase, contrary to a, suggesting that people concentrate
their flows in different areas in response to the epidemic.

Impact of urban structure on COVID-19 spread

Low
Chicago-Naperville-Elgin, IL-IN-WI
Boston-Cambridge-Newton, MA-NH
Philadelphia-Camden-Wilmington, PA-NJ-DE-MD
New Orleans-Metairie, LA
Washington-Arlington-Alexandria, DC-VA-MD-WV
New York-Newark-Jersey City, NY-NJ-PA
Columbus, OH
Las Vegas-Henderson-Paradise, NV
Portland-Vancouver-Hillsboro, OR-WA
San Francisco-Oakland-Berkeley, CA
Pittsburgh, PA
Austin-Round Rock-Georgetown, TX
Minneapolis-St. Paul-Bloomington, MN-WI
Seattle-Tacoma-Bellevue, WA
San Jose-Sunnyvale-Santa Clara, CA
Buffalo-Cheektowaga, NY
Atlanta-Sandy Springs-Alpharetta, GA
Cleveland-Elyria, OH
Raleigh-Cary, NC
Salt Lake City, UT
San Antonio-New Braunfels, TX
Denver-Aurora-Lakewood, CO
Houston-The Woodlands-Sugar Land, TX
Charlotte-Concord-Gastonia, NC-SC
St. Louis, MO-IL
Detroit-Warren-Dearborn, MI
Los Angeles-Long Beach-Anaheim, CA
Birmingham-Hoover, AL
Nashville-Davidson--Murfreesboro--Franklin, TN
Memphis, TN-MS-AR
Providence-Warwick, RI-MA
Orlando-Kissimmee-Sanford, FL
Jacksonville, FL
Louisville/Jefferson County, KY-IN
San Diego-Chula Vista-Carlsbad, CA
Dallas-Fort Worth-Arlington, TX
Miami-Fort Lauderdale-Pompano Beach, FL
Hartford-East Hartford-Middletown, CT
Cincinnati, OH-KY-IN
Tampa-St. Petersburg-Clearwater, FL
Baltimore-Columbia-Towson, MD
Sacramento-Roseville-Folsom, CA
Kansas City, MO-KS
Virginia Beach-Norfolk-Newport News, VA-NC
Phoenix-Mesa-Chandler, AZ
Oklahoma City, OK
Richmond, VA
Indianapolis-Carmel-Anderson, IN
Riverside-San Bernardino-Ontario, CA
Milwaukee-Waukesha, WI

Impact of urban structure on COVID-19 spread
0.8

0.6

0.4

0.2

0.0

Fractional Change

High
Change in Average Hotspot Distance
1.0

10
J. Aguilar et al.

Supplementary Figure 7: Distances between hotspots. Fractional change in average hotspot distance
from the week of January 5 to the week of June 7 for the top 50 CBSAs in the US, colored by the hierarchy
as of January 5.

J. Aguilar et al.

11

Supplementary Figure 8: Average Transfer Entropy hTEi for each administrative division
(county or borough) with respect to the others as a function of time. Shown are six different cities: Detroit, London, Madrid and Mexico city. Vertical red lines mark the date of the official
lockdown. For London the orange line marks an advisory from the Prime Minister’s office to suspend all
non essential activities, which occurred one week before the lockdown (red line).

Impact of urban structure on COVID-19 spread

J. Aguilar et al.

12

Supplementary Figure 9: Localization of flow in three cities with different mobility hierarchy.
Flow distributions in the month of April in Atlanta, Chicago and New York are compared to the baseline
mobility level in February. Cells with no flow change are colored grey and have mobility ratio 1. Mobility
increase and decrease are illustrated by red and blue colors for cells with mobility ratio greater than and
less than 1, respectively. Panels a, b, c represent self-flows, d, e, f represent in-flows, and g, h, i
represent out-flows.

Impact of urban structure on COVID-19 spread

J. Aguilar et al.

13

Supplementary Figure 10: Reduction of Reff versus relative reduction of total flow at the county
level in USA Metro Areas. Reff versus total flow reduction in counties within the same city, measured
from one week before the onset to three weeks after the onset. Reff is taken with one week of delay with
respect to mobility data. This data is used to measure the correlations shown in Figure 3 of the main
paper. Only counties with more than 100 accumulated cases in the full observation period are shown.

Impact of urban structure on COVID-19 spread

J. Aguilar et al.

14

Supplementary Figure 11: Reproduction of Fig. 3 with alternative data. The same panels of the
Fig.3 of the main paper with data from USAFacts. a Average Reff over three weeks after the onset of 100
cases as a function of Φ. Initial transmission increases with centralization. b Maximum incidence Imax
(infections per capita). Cities in pale yellow have already peaked, while infections continue to grow in
those marked in red. The figure suggests the extent of spread is strongly correlated with centralization.
In d, synchronization of mobility reduction and contagion spread among city counties measured through
the Pearson coefficient of plots as those in panels e-g, which reproduce those of shown in Fig. 2 g-i of
the main manuscript for Atlanta, Chicago and NYC. The panel Fig.3c is not reproduced because it is
only based on mobility data and it does not change with the source of the COVID-19 case information.

Impact of urban structure on COVID-19 spread

J. Aguilar et al.

5

15

Flow hierarchy

Supplementary Table 8: Table of US metro areas (and their short names) considered in Figure
3 as function of Φ.
Metro Area

Shortening

Φ

Metro Area

Shortening

Φ

New York (Greater)
Miami (Greater)
Los Angeles (Greater)
San Antonio
Boston
Chicago
San Francisco (Greater)
Denver
Detroit (Greater)
Philadelphia (Greater)
Sacramento

NYC
MIA
LA
SAT
BO
CHI
SF
DEN
DET
PHI
SAC

0.908
0.876
0.874
0.873
0.872
0.864
0.860
0.850
0.849
0.848
0.845

Dallas
Houston
Portland
Washington (Greater)
St. Louis
Pittsburgh
Minneapolis
Seattle
Cincinnati
Charlotte
Atlanta

DAL
HOU
POR
WAS
SLS
PTB
MPL
STL
CIN
CHA
ATL

0.834
0.828
0.826
0.824
0.809
0.803
0.796
0.792
0.790
0.790
0.788

Supplementary Table 9: Table of counties per OCDE metropolitan area for New York City.
County

County

County

County

Bergen County
Hunterdon County
Monroe County
Ocean County
Putnam County
Somerset County
Warren County

Bronx County
Kings County
Morris County
Orange County
Queens County
Suffolk County
Westchester County

Essex County
Middlesex County
Nassau County
Passaic County
Richmond County
Sussex County

Hudson County
Monmouth County
New York County
Pike County
Rockland County
Union County

Supplementary Table 10: Table of counties per OCDE metropolitan area for Miami.
County

County

County

County

Broward County

Martin County

Miami-Dade County

Palm Beach County

Supplementary Table 11: Table of counties per OCDE metropolitan area for Los Angeles.
County

County

County

County

Los Angeles County

Orange County

Riverside County

San Bernardino County

Supplementary Table 12: Table of counties per OCDE metropolitan area for San Antonio.
County

County

County

County

Atascosa County
Frio County
Wilson County

Bandera County
Guadalupe County

Bexar County
Kendall County

Comal County
Medina County

Impact of urban structure on COVID-19 spread

J. Aguilar et al.

16

Supplementary Table 13: Table of counties per OCDE metropolitan area for Boston.
County

County

County

County

Essex County
Suffolk County

Middlesex County

Norfolk County

Plymouth County

Supplementary Table 14: Table of counties per OCDE metropolitan area for Chicago.
County

County

County

County

Cook County
Jasper County
Lake County
Will County

DeKalb County
Kane County
McHenry County

DuPage County
Kendall County
Newton County

Grundy County
Kenosha County
Porter County

Supplementary Table 15: Table of counties per OCDE metropolitan area for San Francisco.
County

County

County

County

Alameda County
San Francisco County

Contra Costa County
San Mateo County

Marin County
Santa Clara County

San Benito County

Supplementary Table 16: Table of counties per OCDE metropolitan area for Denver.
County

County

County

County

Adams County
Denver County
Jefferson County

Arapahoe County
Douglas County
Park County

Broomfield County
Elbert County

Clear Creek County
Gilpin County

Supplementary Table 17: Table of counties per OCDE metropolitan area for Detroit.
County

County

County

County

Livingston County
St. Clair County

Macomb County
Wayne County

Monroe County

Oakland County

Supplementary Table 18: Table of counties per OCDE metropolitan area for Philadelphia.
County

County

County

County

Bucks County
Chester County
Montgomery County

Burlington County
Delaware County
New Castle County

Camden County
Gloucester County
Philadelphia County

Cecil County
Mercer County
Salem County

Supplementary Table 19: Table of counties per OCDE metropolitan area for Sacramento.
County

County

County

County

El Dorado County

Placer County

Sacramento County

Yolo County

Impact of urban structure on COVID-19 spread

J. Aguilar et al.

17

Supplementary Table 20: Table of counties per OCDE metropolitan area for Dallas.
County

County

County

County

Collin County
Ellis County
Johnson County
Rains County
Van Zandt County

Cooke County
Fannin County
Kaufman County
Rockwall County
Wise County

Dallas County
Hood County
Palo Pinto County
Somervell County

Denton County
Hunt County
Parker County
Tarrant County

Supplementary Table 21: Table of counties per OCDE metropolitan area for Houston.
County

County

County

County

Austin County
Fort Bend County
Montgomery County

Brazoria County
Galveston County
Polk County

Chambers County
Harris County
San Jacinto County

Colorado County
Liberty County
Waller County

Supplementary Table 22: Table of counties per OCDE metropolitan area for Portland.
County

County

County

County

Clackamas County
Multnomah County

Clark County
Skamania County

Columbia County
Washington County

Cowlitz County

Supplementary Table 23: Table of counties per OCDE metropolitan area for Washington.
County

County

County

County

Alexandria city
Baltimore city
Clarke County
Falls Church city
Harford County
Montgomery County
Spotsylvania County

Anne Arundel County
Calvert County
Culpeper County
Fauquier County
Howard County
Prince George’s County
St. Mary’s County

Arlington County
Carroll County
District of Columbia
Frederick County
Jefferson County
Prince William County
Stafford County

Baltimore County
Charles County
Fairfax County
Fredericksburg city
Loudoun County
Rappahannock County
Warren County

Supplementary Table 24: Table of counties per OCDE metropolitan area for St. Louis.
County

County

County

County

Jefferson County
Monroe County
St. Louis city

Jersey County
St. Charles County
Warren County

Lincoln County
St. Clair County

Madison County
St. Louis County

Supplementary Table 25: Table of counties per OCDE metropolitan area for Pittsburgh.
County

County

County

Allegheny County

Washington County

Westmoreland County

Impact of urban structure on COVID-19 spread

County

J. Aguilar et al.

18

Supplementary Table 26: Table of counties per OCDE metropolitan area for Minneapolis.
County

County

County

County

Anoka County
Hennepin County
Ramsey County
Washington County

Carver County
Isanti County
Scott County
Wright County

Chisago County
Kanabec County
Sherburne County

Dakota County
Pierce County
St. Croix County

Supplementary Table 27: Table of counties per OCDE metropolitan area for Seattle.
County

County

County

County

King County

Pierce County

Snohomish County

Thurston County

Supplementary Table 28: Table of counties per OCDE metropolitan area for Cincinnati.
County

County

County

County

Boone County
Clermont County
Hamilton County
Warren County

Bracken County
Dearborn County
Kenton County

Butler County
Gallatin County
Ohio County

Campbell County
Grant County
Pendleton County

Supplementary Table 29: Table of counties per OCDE metropolitan area for Charlotte.
County

County

County

County

Cabarrus County
York County

Gaston County

Mecklenburg County

Union County

Supplementary Table 30: Table of counties per OCDE metropolitan area for Atlanta.
County

County

County

County

Barrow County
Clayton County
DeKalb County
Fulton County
Paulding County

Bartow County
Cobb County
Douglas County
Gwinnett County
Rockdale County

Butts County
Coweta County
Fayette County
Henry County
Walton County

Cherokee County
Dawson County
Forsyth County
Newton County

Impact of urban structure on COVID-19 spread

J. Aguilar et al.

6

19

The metapopulation model
Atlanta
Boston
Washington

t(Imax)

240
220
200
180
160

0.4 0.5 0.6 0.7 0.8 0.9
Supplementary Figure 12: Relation between the time of the incidence peak and Φ. Simulations
without lockdown and with the same parameters as in Fig. 4 of the main manuscript. The more
hierarchical cities are, higher Φ, the quicker the peak arrives.

b

no lockdown

a

no lockdown

c

no lockdown

with lockdown

d

Supplementary Figure 13: Model with R0 ≈ 1.2. Simulations run with the same parameters as Fig.
4 of the main manuscript but decreasing the infectivity parameter β to obtain a reproduction number
R0 ≈ 1.2. The panels without lockdown are: a the height of the peak of incidence, b the time of the
peak and c the epidemic size, all as a function of Φ. In d, the epidemic size versus Φ for a simulation
with lockdown XS = 0.8 and triggering the lockdown at a prevalence Pth = 5 × 10−3 .

Impact of urban structure on COVID-19 spread

J. Aguilar et al.

20

0.30

Final Size

0.25
0.20
0.15
0.10

80%
60%
40%
20%
10%
0%

0.05
0.4

0.5

0.6

0.7

0.8

Supplementary Figure 14: Model with R0 ≈ 1.2. Simulations run with the same parameters as Fig.
4 but with β = 0.31 days−1 inducing a reproduction number R0 ≈ 1.2 for a city generated with the
mobility network and total population of the Atlanta metropolitan area. The value of the epidemic size
is explored as a function of Φ for different values of XS that are shown in the legend. In this way,
it is possible to observe the inversion of the size versus Φ curves for strong lockdowns. Given the low
infectivity in this figure Pth = 10−3 .

0.6

Final Size

0.5
0.4
0.3
0.2

80%
60%
40%
20%
10%
0%

0.1
0.4

0.5

0.6

0.7

0.8

Supplementary Figure 15: Model with R0 ≈ 1.6. Simulations run with the same parameters as Fig.
4 (β = 0.42 days−1 ) producing a reproduction number R0 ≈ 1.6 for a city generated with the mobility
network and total population of the Atlanta metropolitan area. The value of the epidemic size is explored
as a function of Φ for different values of XS that are shown in the legend. In this way, it is possible to
observe the inversion of the size versus Φ curves for strong lockdowns. As most of the panels of Figure
4, Pth = 5 × 10−3 .

Impact of urban structure on COVID-19 spread

J. Aguilar et al.

21

Final Size

0.8
0.6
0.4

80%
60%
40%
20%
10%
0%

0.2
0.0

0.4

0.5

0.6

0.7

0.8

Supplementary Figure 16: Model with R0 ≈ 2.3. Simulations run with the same parameters as Fig.
4 but with β = 0.6 days−1 inducing a reproduction number R0 ≈ 2.3 for a city generated with the
mobility network and total population of the Atlanta metropolitan area. The value of the epidemic size
is explored as a function of Φ for different values of XS that are shown in the legend. In this way, it is
possible to observe the inversion of the size versus Φ curves for strong lockdowns. As most of the panels
of Figure 4, Pth = 5 × 10−3 .

Impact of urban structure on COVID-19 spread

