A Poisson Kalman filter for disease surveillance
Donald Ebeigbe∗1 , Tyrus Berry∗2 , Steven J. Schiff1,3 , Timothy Sauer2

arXiv:2003.11194v5 [stat.ME] 14 Sep 2020

An optimal filter for Poisson observations is developed as a variant of the traditional Kalman filter.
Poisson distributions are characteristic of infectious diseases, which model the number of patients
recorded as presenting each day to a health care system. We develop both a linear and nonlinear
(extended) filter. The methods are applied to a case study of neonatal sepsis and postinfectious
hydrocephalus in Africa, using parameters estimated from publicly available data. Our approach is
applicable to a broad range of disease dynamics, including both noncommunicable and the inherent
nonlinearities of communicable infectious diseases and epidemics such as from COVID-19.
∗

Contributed equally.
Center for Neural Engineering, Department of Engineering Science and Mechanics, The Pennsylvania State University, University Park, PA, USA
2
Department of Mathematical Sciences, George Mason University, Fairfax, VA, USA
3
Center for Infectious Disease Dynamics, and Departments of Neurosurgery and Physics, The Pennsylvania State
University, University Park, PA, USA
1

I.

INTRODUCTION

There has been significant recent interest in the model-based control of disease, specifically using prevention and
treatment as methods of control [1–5]. Such model-based frameworks have been instrumental in our understanding
of the dynamics and control of infectious diseases [6], and strategies for global public health policies [7]. Successful
applications of mathematical modeling and control depend on accurate determination of system states, where data
assimilation methods such as Kalman filters [8] play a crucial role in constraining the model with available data.
Although Kalman filters typically assume Gaussian distributed observations that have direct functional relationships
to the state variables, this is unlikely to be suitable for diseases with low rates of occurrence, as is the case in the
early or late stages of the spread of most infectious diseases. While a Poisson distribution with a large rate constant
can be well approximated by a Gaussian of the same mean and variance, the approximation breaks down when the
rates of occurrences are much smaller [9]. Even more importantly, the variance of a Poisson observation changes along
with its mean, whereas the mean and variance of a Gaussian are decoupled, and often the variance is assumed to be
constant (or at least unrelated to the mean) in the Kalman filtering context.
In this article, we argue that the standard application of Kalman filtering methods is poorly matched to data
available during disease surveillance. In particular, the assumption of Gaussian noise-perturbed observations is a
clear source of inaccuracy when used to model the arrival of patients at medical facilities. We develop a variant of
the Kalman filter that assumes Poisson observations, and show how to modify the traditional Kalman equations to
produce an optimal filter.
For one-dimensional systems, an optimal filter has been previously designed for Poisson observations [10], but has
not been generalized to multivariate systems. Moreover, in order to summarize the true distribution of the state
~xk at time step k given the Poisson observations in [10], a very large number of variables needed to be stored and
recalculated at each step. In fact, the number of variables needed also grows very quickly with k (compared to the
Kalman filter where the number of variables tracked is constant in k). Another alternative would be to use a fully
Bayesian approach such as a particle filter designed with the Poisson likelihood function. Such an approach would
be guaranteed to estimate the true posterior given a sufficiently large ensemble, but such large ensembles often result
in high computational complexity. Instead, we propose a filter which is very similar to the Kalman filter, but is
adapted to the unique statistics of the Poisson observations. The proposed approach maintains the simplicity and
computational efficiency of a Kalman filter by only tracking the mean and covariance of the estimated state. A related
linear filter called the Generalized Kalman Filter (GKF) was introduced in [11], which employed a fixed observation
noise covariance matrix that is optimal among all linear filters that are fixed in time. In contrast, we will derive
the optimal time-varying linear filter, and we will use the state estimate to update the observation noise covariance
matrix dynamically. In fact, we will show that the optimal linear filter for Poisson observations is almost identical to
the standard Kalman filter except that the observation noise covariance matrix depends on the state estimate.
In Section II, we first show that by choosing an appropriate observation map, the standard Kalman filter gives
an unbiased estimator for Poisson observations. This justifies using a Kalman filter in the disease modeling context,
as long as the observation map is well chosen. We then show how to modify the Kalman equations to produce an
optimal linear filter in the sense of minimizing the expected squared errors. We prove the optimality of this choice

2
in Appendix A. While the optimal filter nominally requires knowledge of the true state, we show empirically that
using the filter estimate of the state gives near-optimal performance. We call this approach the Poisson Kalman Filter
(PKF).
Recently, Li et al. [12] assimilate Poisson observations to carry out modeling of the coronavirus (COVID-19)
epidemic. Their modifications to the traditional Kalman filter are in the same spirit to those proposed here, in that
the observation noise covariance matrix V is designed to vary with the data. In this article, we derive the Kalman
equations that lead to the optimal linear filter, and prove that the optimal choice for linear dynamics is to set Vk
to vary proportionally to the number of predicted cases. Nonlinear extensions of the Kalman filter follow standard
strategies of generalizing the linear formulas (e.g. the Extended and Ensemble Kalman filters [13]). We develop a
nonlinear Extended PKF (EPKF) in Section V suitable for contagious infectious disease.
We should note that an extended Kalman filter has previously been developed in [14] for point processes where the
observation increments are conditionally Poisson given a stochastic hidden variable. Related approaches were applied
to crime statistics in [15] and neuronal signals in [16]. In [15, 16] they assume that the Poisson rates are functions of
a hidden state variable, ~xk that evolves according to a Markov model, ~xk+1 = ~xk + noise. In our approach we allow
a larger class of stochastic models ~xk+1 = f (~xk ) + noise with non-trivial dynamics. Moreover, the filters in [15, 16]
are derived as a Gaussian approximation to a Bayesian posterior, which leads to a nonlinear filter in [15]. Instead, we
take a novel approach by deriving an optimal linear filter for Poisson observations.
Our case studies start from compartmental models which are built on the standard SIR model and its variants [6].
The SIR model tracks three variables which represent three populations, susceptible (S), infected (I), and recovered
(R). A key feature for communicable disease is that the rate of increase of the infected is proportional to the product
of the susceptible and infected populations, SI, a nonlinear interaction term that is motivated by the contagious
nature of the diseases being modeled.
In Section III below, we introduce an SIR model for noncommunicable diseases and show how to apply the Poisson
Kalman filter to track the model from example data from two endemic diseases affecting childhood health in Africa
– neonatal sepsis (NS) and postinfectious hydrocephalus (PIH) – in Sections III and IV. Although many of these
infections are noncommunicable, acquired during birth or from the environment afterwards, there is new evidence
supporting a role for communicable viruses [17]. To our knowledge, there is no existing computational framework
that embodies the interdependent dynamics of NS and PIH. We show how the use of the PKF and EPKF can fill this
need.
We discuss future directions both for more detailed study of NS and PIH, and for further extensions of the filtering
for infectious disease epidemics, in Section VI.
II.

DATA ASSIMILATION FROM POISSON OBSERVATIONS

Estimating the current state of a dynamical system is a critical challenge when applying compartmental modeling
to disease forecasting and control. Data assimilation is a method of estimating the state from a time series of noisy
observations. In particular, for a linear system ~xk+1 = f (~xk ), the Kalman filter [18] gives the optimal state estimate
(minimal variance) and also quantifies the uncertainty in the estimate. However, the Kalman filter was designed
for engineering applications where the observations are assumed to have a direct functional relationship to the state
variables, except perturbed by Gaussian noise.
There are at least three reasons why this assumption fails for typical disease surveillance. First, counts of individuals
with a disease are by definition nonnegative, contradicting the Gaussian model for uncertainty. Second, the size of
the Gaussian noise is decoupled from the population count, being the same magnitude for low populations as for large
populations. Finally, in order for the population to be the observed variable, one would have to make a survey, at
each time step k, of the entire population to directly observe Ik , the number of infected at time k. Since this is an
unrealistic proposal, the filtering method needs to be adapted to the type of observations that are practical for disease
surveillance. We will refer to this modification of the Kalman filter by the name Poisson Kalman Filter (PKF), which
we show to be unbiased and optimal among all linear filters.
We operate under that assumption that the disease population cannot be measured directly. In fact, a reasonable
model for observations of disease cases, for example those presenting at a hospital, is a Poisson process, whose rate is
proportional to the infected population. Assume that at time step k, the number of new infected patients Ik will be
approximated by a Poisson random variable with rate λk,I = cI Ik , where cI is a proportionality constant.
In a typical filtering problem we would assume that we are given direct observations, ~yk , of the form B~xk + ~νk
where ~νk are random variables representing observation noise. However, in the Poisson observation context, we instead
observe a pair of independent Poisson random variables with rates given by the components of B~xk . We will denote
this type of observation by
~yk ∼ Poisson(B~xk )

3
meaning that (~yk )i is Poisson with rate (B~xk )i . To be more precise we assume that, conditional to B~xk , the components (~yk )i are independent Poisson random variables with density function,
P ((~yk )i = z | (B~xk )i = λ) =

λz −λ
((B~xk )i )(~yk )i −(B~xk )i
.
e =
e
z!
((~yk )i )!

The above conditional density makes it clear that ~yk and ~xk are not independent.
In the case of direct observations, one typically assumes that ~yk splits into a sum of two terms, the first of which
has deterministic dependence on ~xk and the second of which is independent of ~xk . However, for Poisson observations
this splitting is not possible. Despite this irreconcilable dependence between ~y and ~x the following Lemma shows that
if we appropriately center ~y , namely ~y − E[~y | ~x], the result is not correlated with ~x.
Lemma II.1. Let λ be an arbitrary random
variable and let z be a Poisson random variable with rate λ so that the
z
conditional density of z is P (z | λ) = λz! e−λ . Then E[(λ − E[λ])(z − E[z | λ])] = 0.
Proof. We first apply the law of total expectation to compute E[z] = E[E[z | λ]] = E[λ] since λ is the expected value
of a Poisson random variable with known rate λ. We then apply the law of total expectation,
E[(λ − E[λ])(z − E[z | λ]])] = E[E[(λ − E[λ])(z − E[z | λ]]) | λ]]
= E[(λ − E[λ])E[(z − E[z | λ]]) | λ]]
= E[(λ − E[λ])(E[z | λ] − E[z | λ]])] = 0
where the second equality follows from the inner expectation being conditioned on λ and the third follows from the
linearity of the expectation.
Lemma II.1 turns out to be the key to deriving an optimal linear filter for Poisson observations. While Poisson
observations are a more realistic model for the type of data available in disease modeling, we now must design a filter
which can assimilate this data and produce estimates of the state variable ~xk .
A.

The Poisson Kalman Filter (PKF)

A linear filter produces an estimate x̂k of the true state ~xk of the form,
x̂k = A1 x̂k−1 + A2 ~yk
where A1 , A2 are matrices. This is a more restricted class of filters, but we will be able to show that our filter is
unbiased, meaning E[x̂k ] = ~xk , and is the optimal linear filter in the sense of giving the minimal squared error.
The PKF assumes a model of the form,
~xk = F ~xk−1 + ~bk + ~ωk−1
~yk ∼ Poisson(B~xk )

(1)
(2)

where ~bk is a known deterministic forcing term, and ~ωk is dynamical noise with mean zero (E[~ωk ] = 0) and known
covariance matrix, E[~
ωk ~
ωk⊤ ] = W . We also assume that the ~ωk are independent of ~xk , ~yk , and all other ~ωℓ for ℓ 6= k.
The PKF also assumes that model, F , and observation matrices, B, are known. We note that the dynamics F and
observation matrix B can also be allowed to change at each step (nonautonomous), but to simplify the notation we
assume they are constant.
Like the standard Kalman filter, the PKF is a two-step filter, meaning that it breaks down the estimation of x̂+
k
from x̂+
k−1 into a forecast step and an assimilation step. In the forecast step we apply the model to our current
estimate x̂+
k−1 to produce the forecast,
+
x̂−
k = F x̂k−1

(3)

and in the assimilation step we assimilate the new observation by,
−
−
x̂+
k = x̂k + Kk (yk − B x̂k ).

(4)

It is easy to see that this is a linear filter with A1 = (I − Kk B)F and A2 = Kk . The filter is defined by the choice of
the matrix Kk which is called the gain matrix. Our first result is that any filter of the form (4) is unbiased.

4
Theorem II.2. Assume that E[x̂+
x0 , then for any choice of gain matrices Kk the two step filter defined by (3)
0] = ~
and (4) is unbiased, meaning E[x̂+
]
=
~
x
k.
k
The proof of Theorem II.2 is straightforward and can be found in Appendix A.1. The gain matrix is determined by
a secondary set of computations which track the covariance matrix, Pk+ for the estimate x̂+
k . The covariance matrix
is also evolved according to a two step evolution starting with a forecast step,
+
Pk− = F Pk−1
F⊤ + W

which allows us to calculate the optimal gain matrix,
Kk = Pk− B ⊤ (BPk− B ⊤ + Vk )−1

(5)

and then we can complete the assimilation step
Pk+ = (I − Kk B)Pk− (I − Kk B)⊤ + Kk Vk Kk⊤ .
While it may seem that Pk is only really necessary in order to compute the gain matrix Kk , the matrix Pk also gives
an error estimate for the state estimate.
The final component that is required is the Vk matrix in the formula for the optimal gain. In the standard Kalman
filter, Vk is the covariance matrix for the observation noise. However, in the PKF the variance of the observations
is equal to B~xk (meaning var((~yk )i ) = (B~xk )i ). So intuitively, we would expect to use Vk = diag(B~xk ). The next
theorem states that this yields the optimal linear filter.
Theorem II.3. Among all linear filters, the filter given by (3) and (4) with gain matrix Kk given by (5) where
Vk = diag(Bxk ) is optimal in the sense of minimal sum of squared errors. In other words,
∂Jk
=0
∂Kk
where
Jk = trace(Pk ) = E[||x̂k − ~xk ||22 ] =

X
i

E[(x̂k − ~xk )2i ]

The proof of Theorem II.3 is closely related to Lemma II.1 and can be found in A.2. Unfortunately, the optimal
filter is not accessible since it requires access to the true state ~xk in order to define the optimal gain matrix. Instead,
since x̂k is an unbiased estimator (for any gain matrix) we approximate the optimal filter by using Vk = diag(B x̂−
k ).
We call this approximation the Poisson Kalman Filter (PKF).
B.

PKF Equations

The discrete-time Poisson Kalman filter (PKF) algorithm is given below. In order to connect with the potential
optimal control applications we include the control term Gk−1 ~uk−1 . If there is no control this term can be dropped.
We also allow all the matrices to vary with time.
1 Dynamical system
~xk = max(0, Fk−1 ~xk−1 + Gk−1 ~uk−1 + ~bk + w
~ k−1 ),
~yk ∼ Poisson(Bk ~xk )

w
~ k ∼ N (0, Wk )

E[w
~kw
~ j⊤ ] = Wk δk−j

E[~yk ~
yj⊤ ] = diag(Bk ~xk )δk−j
E[wk yjT ] = 0

(6)

where δk−j is the Kronecker delta function, such that δk−j = 1 if k = j, and δk−j = 0 if k 6= j. When the
state is close to zero the Gaussian noise may move the system into negative values, so at each step we take
the maximum of each component and zero. In all the comparisons below, we also apply this maximum to the
Kalman filter and extended Kalman filter simulations. Note that diag(Bk ~xk ) is the true variance of the Poisson
observation ~yk . However, in the filter below we set Vk = diag(Bk x̂−
k ) since this is the best available estimate.
We now summarize the steps required to obtain the PKF estimates.

5
2 Initialization
x̂+
x0 ]
0 = E[~


+
⊤
P0 = E (~x0 − x̂+
x0 − x̂+
0 )(~
0)

(7)

+
x̂−
uk−1 + ~bk
k = Fk−1 x̂k−1 + Gk−1 ~

(8)

3 Prior estimation (forecast step)

Pk−

=

Vk =

+
⊤
Fk−1 Pk−1
Fk−1

+ Wk−1

(9)

diag(max(δ, Bk x̂−
k ))

(10)

4 Posterior estimation (assimilation step)
Kk = Pk− Bk⊤ Bk Pk− Bk⊤ + Vk
x̂+
k
Pk+

= max
= (I −

−1

(11)

+ Kk ~yk − Bk x̂−
k
−
⊤
Kk Bk )Pk (I − Kk Bk ) +
0, x̂−
k



(12)
Kk Vk Kk⊤

(13)

Notice that before the diagonal matrix Vk is formed, we first take the maximum of the diagonal entries and a constant
δ. This is necessary because when the diagonal entries of Vk are too close to zero the filter can become numerically
unstable. The constant δ should be chosen to be small relative to the average value of the Bk ~xk , and in all our
+
numerical experiments we set δ = 0.1. Finally, we note that in practice the initial estimates ~x+
0 and P0 are often
not available. However, the effect of these initial estimates on the accuracy of the state estimates decays to zero
exponentially as k → ∞, and often P0+ is simply chosen to be a multiple of the identity matrix.
III.

AN SIR MODEL FOR NONCONTAGIOUS DISEASE IN A RESTRICTED POPULATION

Severe systemic bacterial infection in the neonatal period, neonatal sepsis (NS), accounts for an estimated 680,000
- 750,000 neonatal deaths per year worldwide [19] - more than childhood deaths from malaria and HIV combined [20].
The most common brain disorder in childhood is hydrocephalus, and the largest single cause of hydrocephalus in the
world is as a sequelae of NS [21], accounting for an estimated 160,000 yearly cases of postinfectious hydrocephalus
(PIH) in infancy [22]. The microbial agents responsible for this enormous loss of human life have been poorly
characterized [23], although next-generation molecular methods show promise to improve the identification of causal
agents [17]. Both NS and PIH occur disproportionately in the developing world, and most of the PIH cases will
die in childhood without adequate treatment, substantially compounding the effective mortality due to NS and its
tremendous burdens on societies [24, 25].
We expect a natural application of the PKF will be to SIR modeling. Consider a discrete-time SIR model for
neonatal sepsis with three classes: Sk is the susceptible population at time k, Ik the infected population, and Rk the
recovered population. (Later, in Section IV, the model will be expanded to include a postinfectious hydrocephalic
class.) Since there are many unmodeled factors which affect the adult population, and the feedback of neonatal
infection into the birth rate takes place on a relatively long time scale, we do not include the adult population in the
model. Thus, Sk , Ik , Rk represent neonatal and infant populations. Since we are modeling neonatal infections, the
susceptible and infected classes are neonatal and, Sk + Ik represents the neonatal population. The recovered class, Rk ,
will track those that recover from sepsis for a period of time that can be chosen by the modeler as will be described
below. The model is summarized in the diagram in Fig. 1.
Modeling only the neonatal/infant populations requires several deviations from the standard SIR model. First, the
birth rate is not proportional to any of the model populations, and is instead a forcing, bk , which introduces new
population into the susceptible class at each time step. Moreover, there are now three ways to leave the susceptible
class: (1) a neonatal mortality rate d, due to factors other than infection (this will affect the two neonatal classes,
Sk and Ik ), (2) an infection rate a, which feeds into the infected class, and (3) a ‘grow-up’ rate gS , which signifies no
longer being susceptible to neonatal infection. The model is:
Sk+1 = (1 − d − a − gS )Sk + bk
Ik+1 = (1 − d − dI − c)Ik + aSk
Rk+1 = (1 − dR − gR )Rk + cIk .

(14)
(15)
(16)

6
Births, bk

Recovery, cIk

New cases, aSk

Population

S

I

R

dR Rk

Death

gS S k
(d + dI )Ik
gR R k

dSk

FIG. 1. Diagram of the Susceptible-Infected-Recovered (SIR) model for neonatal sepsis.

Notice that the gS rate removes neonates from the model entirely, so effectively the grow-up rate gS will control the
length of time that we consider to be ‘neonatal’. Given a time period TS for susceptibility, we set gS = 1/TS , which
makes the simplifying assumption that the susceptible population is always equally distributed across different ages.
The grow-up rate gR controls the length of time that infants in the recovered class are tracked, so that gR = 1/TR
where TR is the amount of time we track the recovered class. The two parameters gS , gR control the two time scales for
susceptibility and recovery (which will become more significant later when we consider the longer time-scale possibility
of developing hydrocephalus), and c is the rate of recovery from infection.
With the state variable ~xk = (Sk , Ik , Rk )⊤ , the matrix form of the evolution is
~xk+1 = F ~xk + ~bk
where

1 − d − a − gS
0
0

a
1 − d − dI − c
0
F =
0
c
1 − dR − gR





bk
~bk =  0 
0

If the birth rate is assumed to be constant bk ≡ b, the steady state populations can be explicitly solved. Setting
b
S∞ ≡ Sk+1 = Sk in susceptible population in (14) we can solve for S∞ = d+a+g
. Substituting this for S∞ = Sk in
S
(15) and setting I∞ ≡ Ik+1 = Ik in (15) we can solve for I∞ and similarly we can solve for R∞ giving steady state
solutions,
S∞ =

b
d + a + gS

ab
(d + dI + c)(d + a + gS )
abc
=
(dR + gR )(d + dI + c)(d + a + gS )

I∞ =
R∞

(17)
(18)
(19)

These steady state solutions have important public health implications on the time scale where the birth rate is
approximately constant. First, S∞ determines the scale of public health improvement if susceptibility can be reduced
(prevention). Second, I∞ determines the resources needed to meet the average infection burden.
A.

Case Study: Neonatal sepsis in Uganda

Publicly available statistics can be used to approximate parameters for NS in Uganda during the time frame 20142015. We consider a discrete time step (the time between steps k and k + 1) of one day and a neonatal period of
TS = 28 days. From [26] we find a 2015 birth rate of 1665000 per year for Uganda, which for a daily model yields
b ≈ 4562. Using 2014 statistics for neonatal sepsis in sub-Saharan Africa, we find a neonatal mortality rate of 29 per
1000 with 17%-29% attributable to sepsis [25]. For simplicity we assume that the neonatal mortality rate of 29 per
1000 can be divided into 7 attributable to sepsis (≈ 23% of neonatal mortality, the midpoint of the 17%-29% range)
and 22 attributable to other causes.
Since we assume the neonatal period is TS days, we convert the neonatal mortality rate due to factors other than
sepsis into a daily rate by setting d = 22/1000/TS . The daily neonatal mortality rate due to sepsis is then 7/1000/TS ,
however this is not dI because the dI variable applies only to the infected class (whereas d applies to both the

7

• The infant time period, Ti (365 days)
• Daily birth rate, b (4562) [26]
• Neonatal mortality rate, m1 (0.0029) [25]
• Percentage of neonatal mortality due to sepsis, s (0.23) [25]
• Infection rate, a (0.0030) [25]

120

Population (thousands)

• The neonatal time period, TS (28 days)

100
80
60
40
20

• Infant mortality rate, m2 (0.0077) [25]
0

(a)

0

500

1000

1500

Time (days)
(b)

FIG. 2. (a) Summary of the inputs to the model for infant sepsis, with values used in parentheses, the remaining parameters
are computed using equations (20). (b) Simulation of the model for infant sepsis in Uganda assuming constant birth rate and
starting from the zero initial condition, (S0 , I0 , R0 ) = (0, 0, 0).

susceptible and infected classes, and thus is a rate for the entire neonatal population). That is, dI represents the
daily rate of mortality due to sepsis as a percentage of the population that has sepsis (rather than 7/1000/TS which
is the daily rate as a percentage of the entire population). So before we can determine dI , we first must determine the
infection rate a. Infection rate estimates can vary widely based on methodology ([25] quotes a range of 5.5 - 170 per
1000 live births). Based on the estimate of one of the authors (SJS) who is a physician conducting medical research
on these infants in Uganda, there is a range of 30 - 60 per 1000 live births in that nation. Conservatively assuming
30 per 1000, we take a = 30/1000/TS as a daily rate of infection. Now the constant dI can be determined. We stated
above that 7 of the 1000 will die from sepsis, meaning that 7 of the 30 who get sepsis will die from it. Thus, we find
that dI = 7/30/TS is the daily rate of death due to sepsis among those that already have sepsis. This immediately
gives us the recovery rate: 7 of the 30 who get sepsis will die from sepsis, and 30(22/1000) will die from non-sepsis
causes. The remaining 30 − 7 − 30(22/1000) = 22.34 will recover, establishing the recovery rate c = 22.34/30/TS .
Note that
c=

1
7
22/1000
30 − 7 − 30(22/1000)
=
−
−
= gS − dI − d
30TS
TS
30TS
TS

so in fact c is chosen to insure that all of the infected classes leave within the neonatal day period.
The infant mortality rate m2 , which covers mortality of the first year after birth, infancy or Ti , can also be
derived from data. Consider a tracking time for the recovered population of this first year minus the neonatal period,
TR = Ti − TS (we assume that the recovered population is entirely outside the 28 day neonatal period). For the death
rate in the recovered class we start with the infant mortality rate of 77 per 1000 (in the first year [25]) and subtract
the 29 per 1000 neonatal mortality rate to find dR = 48/1000/TR.
We summarize the inputs to the model in Fig. 2 then compute the parameters d, dI , dR , c, TR , gS , gR by
1
TS
(1 − s)m1
d=
TS

gS =

c = gS − d − dI

1
TR
sm1
dI =
aTS
m2 − m1
dR =
TR
gR =

(20)

where s is the fraction of neonatal mortality due to sepsis. The steady state values for the model with these parameters
are S∞ = 121422, I∞ = 3643, and R∞ = 31152. We note that the steady state number of infected shows consistency
with reported values [26]. The recovered class is now susceptible to developing PIH.

8
Births, bk

New cases, aSk + βSk Ik

Population

S

Recovery, cIk

I

Hydrocephalus, hRk

R

H

gS S k
(d + dI )Ik
gR R k

(dR + dH )Rk

Death

dR Rk

dSk

FIG. 3. Diagram of the Susceptible-Infected-Recovered-Hydrocephalic (SIRH) model for neonatal sepsis and hydrocephalus.
Note that in Section IV we consider the linear model with β = 0.

IV.

SIRH: MODELING THE HYDROCEPHALIC POPULATION

We now turn to a model that specifically links neonatal infection and postinfectious hydrocephalus (PIH). The
essential idea is that those that have recovered from sepsis are now susceptible to developing hydrocephalus. The
constant h represents the rate at which recovered infants move from the recovered class Rk to a new hydrocephalic
class Hk , leading to the equations
Sk+1
Ik+1
Rk+1
Hk+1

= (1 − d − a − gS )Sk + bk
= (1 − d − dI − c)Ik + aSk
= (1 − dR − gR − h)Rk + cIk
= (1 − dR − dH )Hk + hRk .

(21)

The SIRH system is summarized in the diagram in Fig. 3.
The hydrocephalic class is subject to an additional mortality rate due to hydrocephalus, dH , which requires
recalibrating the recovered rate, dR , so that it does not include deaths due to hydrocephalus. We set dR =
(m2 − m1 − pdH TR )/TR where m2 is the infant mortality rate, m1 is the neonatal mortality rate, p is the rate
of PIH in the total population under consideration (discussed in Section IV A below), and dH TR is the rate of death
of those who develop PIH during infancy (dH is the daily rate and TR is the remainder of the infancy period). Finally,
we note that the steady state value of the recovered class changes from the SIR model due to the rate h, and the new
steady state along with the hydrocephalic steady state are given by
abc
(dR + gR + h)(d + dI + c)(d + a + gS )
hR∞
abch
=
=
dR + dH
(dR + gR + h)(d + dI + c)(d + a + gS )(dR + dH )

R∞ =

(22)

H∞

(23)

We now return to our case study of modeling PIH in Uganda.

A.

Case Study: Infant hydrocephalus in Uganda

The first parameter to consider is h, the rate of developing postinfectious hydrocephalus (PIH). In [25] it is reported
that the incidence of PIH is 3-5 per 1000 live births. We will take the low estimate of 3 per 1000 setting p = 3/1000,
since it will be shown to be more consistent with other statistics below. Recall that above we estimated that for 1000
live births there are 30 cases of sepsis, and 22.34 of those recover. Since only recovered sepsis cases can develop PIH,
this implies a rate of developing hydrocephalus of
h = 3/22.34/TR.
The death rate due to hydrocephalus is highly dependent upon treatment. The untreated death rate is estimated at
50%, while treatment can reduce this to 25%. We assume an overall death rate of 33% [27] and we set
dH = 1/3/TR.

Cumulative Deaths (thousands)

9

Population (thousands)

120
100
80
60
40
20
0

0

500

1000

1500

2000

2500

3000

80

60

54924

40

43875

20

16339
13094

0

0

500

Time (days)

1000

1500

2000

2500

3000

Time (days)

(a)

(b)

FIG. 4. (a) Simulation of the SIRH model for Uganda starting from the zero initial condition. (b) Plot of the cumulative deaths
from sepsis and hydrocephalus in the simulation. The horizontal lines are spaced so that their intersections with the curves are
365 days apart and indicated the cumulative deaths at times one year apart. The model predicts approximately 11000 annual
deaths due to sepsis and approximately 3300 annual deaths due to PIH.

Finally, we recalibrate the death rate for those recovering from sepsis by removing the deaths due to hydrocephalus
(since those are accounted for in the Hk variable). So we set
dR =

.0077 − .0029 − .0003 31
.0047
m2 − m1 − p dH TR
=
=
TR
TR
TR

The results shown in Fig. 4 predict a steady state of approximately 10000 ongoing cases of PIH with an annual
PIH incidence of approximately 4000 per year (365 ∗ h ∗ R∞ ), and annual deaths due to PIH of approximately 3300,
consistent with existing estimates [24].
B.

PKF Simulations

Using the SIRH model described in Section IV, we evaluate the performance of the PKF when the observations
follow a random Poisson distribution with known rates λk,I = cI Ik and λk,H = cH Hk , which represent the number
of infants with sepsis and the number of infants with hydrocephalus that show up at the hospital. Our observations
can be written as



 Sk






yk,1
λk,I
λk,I
0 cI 0 0
 Ik 
yk =
= Poisson
, where
= Bxk =
.
yk,2
0 0 0 cH  Rk 
λk,H
λk,H
Hk
and we start the system at the equilibrium values.
The simulation in Fig. 5 was run with system noise W = diag(144, 1, 1, 10) × 107 and the constant daily birth rate
b = 4562, while setting the sepsis and hydrocephalus proportionality constants as cI = 0.2/TS and cH = 0.6/TR
respectively. The idea behind these values is that if 20% of total sepsis cases seek care over the entire TS period of
sepsis susceptibility, then the daily rate of arrivals would be 0.2/TS multiplied by the number of true sepsis case (20%
was chosen purely for purposes of simulation). In Fig. 5 we see that the PKF (red, dashed curves) gave good estimates
of the observed variables, namely the, infected and hydrocephalic populations. The PKF also obtains information
about the unobserved variables, namely, the susceptible and recovered populations at least on a slow time scale,
however the fast time scale information about the unobserved variables seems limited.
Fig. 5 also compares the PKF to a Kalman filter (blue, dotted curves) which was given the optimal fixed observation
noise covariance matrix, Vconst = diag(Bx) where x is the time average of the state variables. The disadvantage of
the fixed gain is that when the number of infected or hydrocephalic is large the variance of the observations will be
larger than the average value. This means that the Kalman filter will underestimate the observation variance and use
an oversized gain. This is shown in Fig. 5 where the Kalman filter estimates closely follows the observations when
the number of infected or hydrocephalic are large. The PKF dynamically adjusts the observation covariance matrix

10
10 5

5

10

Truth, Sk

4

Truth, R

k

PKF
KF

4

10

9

PKF
KF

Recovered

Susceptible

8

3

2

7
6
5

1
4

0
500

600

700

800

900

3
500

1000

600

700

Time, k (days)

(a)
4
Truth, Ik

3.5

PKF
KF

2.5
2
1.5

0.5
900

0
500

1000

600

700

Time, k (days)

(d)

4

4

Truth, H k
Rescaled Cases, y /c

10 5
Truth, H k
Rescaled Cases, y2 /c H

H

PKF
KF

3.5

Hydrocephalic

Hydrocephalic

2

10

800

Time, k (days)

(c)
10

1000

2

0.5

15

900

PKF
KF

1.5
1

800

Rescaled Cases, y2 /c H

2.5

1

700

Truth, H k

3

Hydrocephalic

Infected

3

600

1000

10 5

3.5

Rescaled Cases, y1 /c I

0
500

900

(b)

10 4

4

800

Time, k (days)

5

PKF
KF

3

2.5

0
500

550

600

650

2
800

700

850

Time, k (days)

900

(e)

(f)
Measurement, (yk )1

Measurement, (yk )2
600

Poisson Rate, c I Ik

250

Hydrocephalic

200

Infected

1000

700

300

150
100

Poisson Rate, c H Hk

500
400
300
200

50
0
500

950

Time, k (days)

100

600

700

800

Time, k (days)

(g)

900

1000

0
500

600

700

800

900

1000

Time, k (days)

(h)

FIG. 5. Comparison of the PKF (optimal variable gain) and the Kalman filter (optimal fixed gain) for the SIRH model with
Poisson observations of the infected and hydrocephalic populations. (a)-(d) compare the true S, I, R and H values (black)
to the PKF (red, dashed) and Kalman filter (blue, dotted) estimates. Infected and hydrocephalic also show the observations
(green, circles) rescaled by dividing by the constants cI , cH respectively. (e)-(f) are expanded versions of (d), enlarged to show
detail. When the number of cases is large, the KF estimate of H is very close to the observations, whereas the PKF adjusts
to the larger observation variance and produces better estimates. (g)-(h) show the Poisson rates (black) of I and H and the
observed case numbers (red, circles) from the Poisson distribution.

11
1200

10000
Oracle PKF
PKF
Kalman filter

1000
900
800
700
600
500

Oracle PKF
PKF
Kalman filter

9000

Hydrocephalus RMSE

Infected RMSE

1100

8000
7000
6000
5000
4000
3000

0

0.2

0.4

0.6

0.8

System Noise (Multiplier)
(a)

1

2000

0

0.2

0.4

0.6

0.8

1

System Noise (Multiplier)
(b)

FIG. 6. Comparison of the RMSE for the infected (a) and hydrocephalic (b) populations of the PKF (red, optimal variable
gain) and the Kalman filter (blue, optimal fixed gain) as function of the system noise. We also compare to an oracle PKF
(black, dashed) which is given the optimal choice of Vk = diag(B~xk ). System noise is quantified as a multiple of the base noise
level W . The RMSE is averaged over 106 filter steps.

based on the state estimate in order to prevent this. This is further shown in Fig. 6 which compares the root mean
squared error (RMSE) for the PKF and the Kalman filter for various levels of system noise. Fig. 6 also compares the
PKF, which uses the filter estimate to determine Vk , to an oracle PKF which uses the true state for Vk and we see
that their performance is almost identical even at high noise levels. In this case (with a linear model), the Kalman
filter and PKF have similar performance for the unobserved variables, which seems to indicate that they are relying
more on the stability of the model rather than correlations with the observed variables. Of course this is reliant on
using the optimal Vconst matrix in the EKF. Moreover, in the context of disease surveillance filtering the observed
variables is critical to account for over/under reporting in producing a clean data set, and for these variables the PKF
has a significant advantage.
Finally, we note that the PKF has the largest advantage at high noise levels. This is because the SIRH system
is a stable linear system, so that noise is the only unstable component of the dynamics. In the absence of noise,
no filter would be necessary since all trajectories would converge to the equilibrium regardless of observations. This
suggests that a generalized PKF (such as the Extended PKF considered below) would have an advantage for nonlinear
dynamics with unstable directions even in the absence of system noise.
V.

AN EXTENDED POISSON KALMAN FILTER FOR CONTAGIOUS DISEASE

So far we have considered a linear model for NS, which is sufficient for noncontagious infections. However, contagious disease models typically contain an nonlinearity that models the contagious spread. In order to broaden the
applicability of the PKF we now show that it also offers improvements for these nonlinear models by using a standard
approach to extend the Kalman equations to nonlinear dynamics. Moreover, because there are potential mechanisms
for contagious infections contributing to NS [17], modeling these infections requires a nonlinear system. As in the
classical SIR model we assume that the contagious spread will be simultaneously proportional to the both the number
of susceptibles and the number of infected and so we model the number of contagious cases at time k as βSk Ik , where
β is infectivity. Introducing this term to the SIRH model we have
Sk+1
Ik+1
Rk+1
Hk+1

= (1 − d − a − gS )Sk − βSk Ik + bk
= (1 − d − dI − c)Ik + aSk + βSk Ik
= (1 − dR − gR − h)Rk + cIk
= (1 − dR − dH )Hk + hRk .

(24)

The state of the nonlinear model is ~xk+1 = fk (~xk ) where ~xk = (Sk , Ik , Rk , Hk ). When the birth rate is constant bk = b
we can write fk = f and the system can be considered autonomous, but we also allow nonautonomous dynamics as

12
long as each fk is known. This model is of significant interest since estimating the a and β parameters from data
would help determine the role of contagious spread in NS.
A standard method for lifting the Kalman filter to the nonlinear setting is the Extended Kalman Filter (EKF)
+
[28]. The EKF uses the nonlinear dynamics to produce the forecast x−
k+1 = fk (xk ), and a linear approximation to
−
+ ⊤
the dynamics is used for forecasting the covariance matrix Pk+1 = Fk Pk Fk + W . To define Fk the EKF linearizes
the dynamics around the current state estimate, setting Fk = Dfk (x̂+
k ). This approximates the nonlinear dynamics
as a nonautonomous linear system for the purposes of forecasting the covariance estimates. In the example below we
apply the EKF using


1 − d − a − gS − βIk+
−βSk+
0
0


a + βIk+
1 − d − dI − c + βSk+
0
0
.

Fk = Dfk (x̂+
k) =

0
c
1 − dR − gR − h
0
0
0
h
1 − dR − dH
Since the PKF is also based on the Kalman equations, we can use this same idea to extend the PKF to nonlinear
systems which we call the Extended PKF (EPFK).
In Fig. 7 we simulate the system (24) with β = 10−6 initialized at the noncontagious equilibrium found in Section IV
(all other parameters are the same as in Section IV). This simulates the introduction of a contagious source of disease
to a system that had stabilized at the noncontagious equilibrium. To demonstrate the advantage of the EPKF over
the non-Poisson version, we assume that the EKF is given the optimal fixed gain for the noncontagious equilibrium.
Fig. 7 shows that as the number of infected and hydrocephalic cases increase the EKF estimate becomes very noisy,
since it is underestimating the observation variance and as a result follows the observations too closely. This shows
how the EPKF is able to automatically adapt to the new equilibrium. The top tow rows of Fig. 7 show the simulation
with the standard observation rate, cI = 0.2/TS , cH = 0.6/TR . To demonstrate the ability of the EPKF to assimilate
at very low observation rates, we repeated the experiment after reducing the observation rates by a factor of 1000,
and these results are shown in the bottom two rows of Fig. 7. In this case, due to the low observation rates, of the
1000 days shown in Fig. 7, 624 days had zero infected reported and 908 days had zero hydrocephalic reported. Despite
these large numbers of zeros, the EPKF effectively assimilates the available information.
Another critical aspect of filter performance is the accuracy of the uncertainty quantification provided by the
covariance matrix. In the bottom row of Fig. 8 we compare the true signal (black) to the two standard deviation
region around the EPKF and EKF estimates. These regions are generated by adding and subtracting twice the square
root of the diagonal entry of the covariance matrix estimate at each time step. An accurate uncertainty quantification
would imply that the truth only leaves the region for around 10 of the 200 time steps shown. Notice that the EKF
significantly underestimates the variance, meaning that it is overconfident in its estimator, because the true signal
leaves the region much more than expected. The EPKF gives a more accurate uncertainty quantification, perhaps
slightly overestimating the uncertainty in the low observation rate case since the true signal never leaves the region.
We also compare the EPKF to the standard EKF using the optimal fixed gain for the contagious equilibrium,
starting from the contagious equilibrium. Fig. 8 shows that the EPKF has the largest advantage at high system
noise levels (as in Fig. 6) due to the absence of unstable directions in the deterministic dynamics near equilibrium.
This suggests that the EPKF would have an even more significant advantage for chaotic systems. Also, as in Fig. 6,
we compare the empirical EPKF, which uses the state estimate to determine the observation variance, to an oracle
version of the EPKF that uses the true state to determine the observation variance, and again the performance is
very similar.
Finally, we note that two closely related alternative approaches to applying the Kalman filter to nonlinear dynamics
are the Ensemble Kalman Filter (EnKF) [28] and Ensemble Adjustment Kalman Filter [29]. Both of these methods use
−
an ensemble forecast instead of linearizing the dynamics to estimate Pk+1
. Since the EnKF and EAKF are also based
on the Kalman formulas the PKF method can be applied just as easily to these methods. A potentially significant
issue for most ensemble methods is that ensemble members are typically not guaranteed to be positive, leading to
negative populations in the ensemble members. One possible method to address this would be to log-transform the
model, however this has the downside of introducing stronger nonlinearities
p into the model. A related idea would be
to replace the
observations
with
the
variance-stabilizing
transformation
yk + 1/4 which is approximately Gaussian
√
with mean Bxk and constant variance 1/4. Both these approaches simplify the statistics at the cost introducing
additional nonlinearity into the model or observation function, and exploring these tradeoffs is an interesting subject
for future investigations.
This approach is closely related to the recent work of [12] applied to COVID-19 with Poisson observations. There,
an EAKF was used with a heuristically chosen observation covariance Vk which was proportional to the square of the
observations. In fact, [12] also suggested an alternative of using Vk proportional to the observations. Our analysis of
the PKF shows that in fact the optimal choice for linear dynamics is to set Vk equal to the predicted observations, as

13
10

14

4

Truth, S

k

12

7

EPKF
EKF

6

Recovered

10

Susceptible

10 5

8

8
6
4

5
4
3
2

2

1

0

0
0

200

400

600

800

1000

Truth, Rk
EPKF
EKF
0

200

400

(a)
10

14

4

10

16

1000

4

14
12

Hydrocephalic

10

Infected

800

(b)

12

8
6
Truth, I

4

10
8
6
Truth, H

k

Rescaled Cases, y /c
1

2
0

600

Time, k (days)

Time, k (days)

4

2

EPKF
EKF
0

200

400

600

0

1000

0

200

Time, k (days)

400

10

600

800

1000

Time, k (days)

(c)
14

H

EPKF
EKF

2
800

k

Rescaled Cases, y /c

I

(d)

4

10

6

5

Truth, Sk

10

Recovered

Susceptible

5

EPKF
EKF

12

8

4
3

6

2

4

1

2

0
0

200

400

600

800

1000

Truth, Rk
EPKF
EKF
0

200

400

(e)
10

5

10

12

Rescaled Cases, y1 /c I

4

EPKF
EKF

1000

5

Truth, H

10

k

Rescaled Cases, y /c
2

Hydrocephalic

Infected

800

(f)

5

Truth, Ik

3

2

1

0

600

Time, k (days)

Time, k (days)

8

H

EPKF
EKF

6
4
2

0

200

400

600

Time, k (days)

(g)

800

1000

0

0

200

400

600

800

1000

Time, k (days)

(h)

FIG. 7. Comparison of the Extended PKF (optimal variable gain) and the Extended Kalman filter (optimal fixed gain for
the noncontagious equilibrium) for the contagious SIRH model with Poisson observations of the infected and hydrocephalic
populations. We compare the true S, I, R and H values (black) to the PKF (red, dashed) and Kalman filter (blue, dotted)
estimates. (a)-(d) show a standard observation rate, cI = 0.2/TS , cH = 0.6/TR , and (e)-(h) show a low observation rate,
cI = 0.0002/TS , cH = 0.0006/TR . Infected and hydrocephalic also show the observations (green, circles) rescaled by dividing
by the constants cI , cH respectively. The system is initialized at the noncontagious equilibrium and run forward with β = 10−6
simulating the introduction of a contagious source of infection which moves the system to a new equilibrium.

14

Oracle EPKF
EPKF
EKF

5000

Infected RMSE

Oracle EPKF
EPKF
EKF

1.4

Hydrocephalus RMSE

5500

4500
4000
3500
3000

1.2
1
0.8
0.6

2500
2000

10 4

1.6

6000

0

0.2

0.4

0.6

0.8

0.4

1

0

0.2

System Noise (Multiplier)
(a)
1.3

0.4

0.6

0.8

1

System Noise (Multiplier)
(b)

10 5

12

1.2

10 4

10

Infected

Infected

1.1
1

8

6

0.9
Truth, I

0.7

Truth, Ik

4

k

0.8

EPKF, 2 region
EKF, 2 region

EPKF, 2 region
EKF, 2 region

2
820

840

860

880

900

920

940

960

980

1000

820

840

860

880

900

920

940

960

980

1000

Time, k (days)

Time, k (days)

(c)

(d)

FIG. 8. (a)-(b) Comparison of the RMSE of the EPKF (red, optimal variable gain) and the EKF (blue, optimal fixed gain)
as function of the system noise. We also compare to an oracle EPKF (black, dashed) which is given the optimal choice of
Vk = diag(B~xk ). System noise is quantified as a multiple of the base noise level W . The RMSE is averaged over 106 filter
steps. (c)-(d) The two standard deviation region around the EPKF and EKF estimates are shown using the variance estimated
by the respective filters for the standard observation rate (c) and the low rate (d) from Fig. 7.

we propose in the EPKF. In fact, our analysis of a nonlinear contagious model in this section suggests that [12] were
very close to the optimal approach.

VI.

CONCLUSION

The mathematical methods of filtering and control originated with linear models, direct observations, and Gaussian
noise. However, these assumption may not be appropriate in the context of disease modeling, where the observation of
cases of communicable and noncommunicable disease often present as Poisson processes. Unfortunately, the customary
Kalman filter is not well suited to assimilate such Poisson occurrences and estimate the true number of underlying
cases. The Poisson Kalman Filter (PKF) is an optimal filter for such surveillance.
The linear PKF is a very general filter suitable for a broad range of noncommunicable disease observations where
the nonlinear interaction of susceptible and diseased individuals is not an inherent component of disease initiation
(including noninfectious disease such as diabetes or stroke). We extended our findings to encompass the nonlinear
interactions of susceptible and infected individuals typical of contagious disease through an extended PKF or EPKF.
We also created, to our knowledge, the first SIRH compartmental model that can be used in the surveillance of
neonatal sepsis and postinfectious hydrocephalus, endemic disease that causes tremendous numbers of yearly global
deaths in the developing world. In particular, we incorporated both the noncommunicable and communicable dynamics

15
that have been observed in these infant infections.
Additionally, our case study of sepsis and hydrocephalus suggests many promising directions for future development.
If a more careful tracking of cases is desired, the neonatal and infancy periods can be segmented in to multiple stages.
For example, it is well known that the infections that are acquired perinatally from the mother, so called early onset
sepsis, are manifest within the days of the first week of life. Infections during the subsequent weeks of the neonatal
period (first 4 weeks) are environmentally acquired and are typically a very different spectrum of organisms. Therefore
S(0i) could represent susceptible at (0 − i)-days after birth, and S(ij) could represent susceptibles from (i − j)-days
after birth, with varying rates and risks from sepsis at different stages of development. Another critical factor in sepsis
and hydrocephalus cases is environmental variables such as rainfall [30], which suggests that a full spatiotemporal
model will be necessary to more fully represent these dynamics. Recent findings [17] demonstrate that more than one
infection (co-infection) can be found in some of these infants – perhaps even a mixture of noncommunicable bacteria
and communicable viruses – demonstrating that a mixed linear and nonlinear model would be required to represent
such co-infections. A spatiotemporal model would allow the optimal control to consider multiple methods of control
and determine ideal locations and times to apply each.
The recent coronavirus (COVID-19) epidemic is one where Poisson dynamics are required in the modeling and
data assimilation [12]. In this article, we derive the Kalman equations that lead to the optimal linear filter, and
propose that the optimal choice is to set the observed covariance equal to the predicted observations as proposed in
the nonlinear EPKF.

VII.

ACKNOWLEDGEMENTS

We are grateful to D. Simon, M. Ferrari and M. Norton for their helpful discussions. Funded by an NIH Director’s
Transformative Award 1R01AI145057.

[1]
[2]
[3]
[4]
[5]
[6]
[7]
[8]
[9]
[10]
[11]
[12]
[13]
[14]
[15]
[16]
[17]

[18]
[19]
[20]

G. Zaman, Y. H. Kang, and I. H. Jung, Proc. KSIAM 3, 31 (2007).
T. T. Yusuf and F. Benyah, World journal of modelling and simulation 8, 194 (2012).
G. Zaman, Y. H. Kang, and I. H. Jung, BioSystems 93, 240 (2008).
O. Sharomi and T. Malik, Annals of Operations Research 251, 55 (2017).
P. Di Giamberardino and D. Iacoviello, in 2019 23rd International Conference on System Theory, Control and Computing
(ICSTCC) (IEEE, 2019) pp. 733–738.
M. J. Keeling and P. Rohani, Modeling Infectious Diseases in Humans and Animals (Princeton, Princeton, 2008).
P. Diggle, Model-based geostatistics for global public health : methods and applications (Taylor & Francis, Boca Raton,
2019) pp. xxvi, 247 pages.
W. Yang, A. Karspeck, and J. Shaman, PLoS computational biology 10 (2014).
L. J. Curtis, American Journal of Physics 43, 1101 (1975).
J. H. Manton, V. Krishnamurthy, and R. J. Elliott, Int. J. Adapt. Control Signal Process. 13, 393416 (1999).
B. Zehnwirth, Journal of the American Statistical Association 83, 164 (1988).
R. Li, S. Pei, B. Chen, Y. Song, T. Zhang, W. Yang, and J. Shaman, Science (2020).
S. J. Schiff, Neural Control Engineering: The Emerging Intersection Between Control Theory and Neuroscience , Computational neuroscience (MIT Press, 2012).
D. Snyder, IEEE Transactions on Information Theory 18, 91 (1972).
N. Santitissadeekorn, D. J. Lloyd, M. B. Short, and S. Delahaies, Computational Statistics & Data Analysis 144, 106850
(2020).
Y. Salimpour, H. Soltanian-Zadeh, and M. D. Abolhassani, in 2010 Annual International Conference of the IEEE Engineering in Medicine and Biology (IEEE, 2010) pp. 6670–6673.
J. N. Paulson, B. L. Williams, C. Hehnly, N. Mishra, S. A. Sinnar, L. Zhang, P. Ssentongo, . Mbabazi-Kabachelor, E,
D. S. S. Wijetunge, B. von Bredow, R. Mulondo, J. Kiwanuka, F. Bajunirwe, J. Bazira, L. M. Bebell, K. Burgoine,
M. Couto-Rodriguez, J. E. Ericson, T. Erickson, M. Ferrari, M. Gladstone, C. Guo, M. Haran, M. Hornig, A. M. Isaacs,
B. N. Kaaya, S. M. Kangere, A. V. Kulkarni, E. Kumbakumba, L. X., D. D. Limbrick Jr, J. Magombe, S. U. Morton,
J. Mugamba, J. Ng, P. Olupot-Olupot, J. Onen, M. R. Peterson, F. Roy, K. Sheldon, R. Townsend, A. D. Weeks, A. J.
Whalen, J. Quackenbush, P. Ssenyonga, M. Y. Galperin, M. Almeida, H. Atkins, B. C. Warf, W. I. Lipkin, J. R. Broach,
and S. J. Schiff, Science Translational Medicine XX, XX (2020).
R. E. Kalman, Journal of Basic Engineering 82, 35 (1960).
A. C. Seale, H. Blencowe, A. A. Manu, H. Nair, R. Bahl, S. A. Qazi, A. K. Zaidi, J. A. Berkley, S. N. Cousens, and J. E.
Lawn, The Lancet Infectious Diseases 14, 731 (2014).
A. C. Seale, H. Blencowe, A. Zaidi, H. Ganatra, S. Syed, C. Engmann, C. R. Newton, S. Vergnano, B. J. Stoll, S. N.
Cousens, and J. E. Lawn, Pediatric research 74, 73 (2013).

16
[21] A. V. Kulkarni, S. J. Schiff, E. Mbabazi-Kabachelor, J. Mugamba, P. Ssenyonga, R. Donnelly, J. Levenbach, V. Monga,
M. Peterson, M. MacDonald, V. Cherukuri, and B. C. Warf, N Engl J Med 377, 2456 (2017).
[22] M. C. Dewan, A. Rattani, R. Mekary, L. J. Glancz, I. Yunusa, R. E. Baticulon, G. Fieggen, r. Wellons, J. C., K. B. Park,
and B. C. Warf, J Neurosurg , 1 (2018).
[23] S. K. Saha, S. J. Schrag, S. El Arifeen, L. C. Mullany, M. Shahidul Islam, N. Shang, S. A. Qazi, A. K. M. Zaidi,
Z. A. Bhutta, A. Bose, P. Panigrahi, S. B. Soofi, N. E. Connor, D. K. Mitra, R. Isaac, J. M. Winchell, M. L. Arvay,
M. Islam, Y. Shafiq, I. Nisar, B. Baloch, F. Kabir, M. Ali, M. H. Diaz, R. Satpathy, P. Nanda, B. K. Padhi, S. Parida,
A. Hotwani, M. Hasanuzzaman, S. Ahmed, M. Belal Hossain, S. Ariff, I. Ahmed, S. M. Ibne Moin, A. Mahmud, J. L.
Waller, I. Rafiqullah, M. A. Quaiyum, N. Begum, V. Balaji, J. Halen, A. S. M. Nawshad Uddin Ahmed, M. W. Weber,
D. H. Hamer, P. L. Hibberd, Q. Sadeq-ur Rahman, V. R. Mogan, T. Hossain, L. McGee, S. Anandan, A. Liu, K. Panigrahi,
A. M. Abraham, and A. H. Baqui, The Lancet 392, 145 (2018).
[24] B. C. Warf, B. C. Alkire, S. Bhai, C. Hughes, S. J. Schiff, J. R. Vincent, and J. G. Meara, Journal of Neurosurgery:
Pediatrics 8, 509 (2011).
[25] S. L. Ranjeva, B. C. Warf, and S. J. Schiff, BMJ global health 3, e000347 (2018).
[26] UNICEF, data.unicef.org (2016).
[27] B. C. Warf, A. R. Dagi, B. N. Kaaya, and S. J. Schiff, Journal of Neurosurgery: Pediatrics PED 8, 502 (2011).
[28] D. Simon, Optimal state estimation: Kalman, H infinity, and nonlinear approaches (John Wiley & Sons, 2006).
[29] J. L. Anderson, Monthly weather review 129, 2884 (2001).
[30] S. J. Schiff, S. L. Ranjeva, T. D. Sauer, and B. C. Warf, Journal of neurosurgery Pediatrics 10, 161 (2012).

Appendix A: Optimal Linear Filter Derivation

We develop a recursive weighted least square (WLS) estimator by determining how to estimate a constant on the
basis of several measurements that follow a Poisson distribution. We then use it as a basis for developing a discretetime Kalman filter that uses Poisson distributed measurements, which we accomplish by adapting the techniques used
in developing a discrete-time Kalman filter [28]. We will remove the arrow symbols from vectors in this section to
reduce the number of symbols in formulas.

1.

Recursive weighted least squares estimator with Poisson observations

The measurement equation of a linear stochastic discrete-time dynamic system with indirect measurements of the
state is given as
xk = xk−1
yk = zk ,

zk ∼ Poisson(λk = Bxk )

(A1)

where xk ∈ Rn , yk ∈ Rm are the state vector and measurement vector respectively, and B ∈ Rm×n is a known
deterministic matrix. The measurement variable zk ∈ Rm follows a random Poisson distribution
p(zk |xk ) =

(Bxk )zk −(Bxk )
e
,
zk !

z = 0, 1, 2, . . .

(A2)

where the rate λk = Bxk ≥ 0. We note that the positive real rate λk equals the expected value E[zk ] and variance
Var(zk ) such that
E[zk ] = Var(zk ) = λk
In our case, we assume that the state x is non-negative. We also assume that each Poisson random variable (zk )i
has a rate that is only dependent on the corresponding state (xk )i , such that E[(zk )i ] = ci (xk )i where ci ∈ R+ are
known deterministic parameters. A linear recursive estimator can be written as
yk = zk
x̂k = x̂k−1 + Kk (yk − B x̂k−1 )
where Kk is the optimal gain matrix to be determined.
Theorem A.1. The estimator of (A4) is an unbiased estimator of xk ; that is, E[xk − x̂k ] = 0

(A3)
(A4)

17
Proof. Calculating the estimation error mean, we write
E[ǫx,k ] = E[xk − x̂k ]
= E [xk − x̂k−1 − Kk (yk − B x̂k−1 )]
= E [ǫx,k−1 − Kk (zk − B x̂k−1 )]
= E [ǫx,k−1 − Kk (zk − Bxk−1 + Bxk−1 − B x̂k−1 )]
= E [ǫx,k−1 − Kk Bǫx,k−1 − Kk (zk − Bxk−1 )]
= E [(I − Kk B)ǫx,k−1 − Kk (zk − Bxk−1 )]
= (I − Kk B) E [ǫx,k−1 ] − Kk (E[zk ] − Bxk−1 )

(A5)

So since E[zk ] = Bxk = Bxk−1 and inductively we assume E [ǫx,k−1 ] = 0, we have E[ǫx,k ] = 0. Therefore (A4) is an
unbiased estimator.
Note that the unbiased estimator property holds regardless of the value of the gain matrix Kk . This implies that,
on average, the state estimate x̂k will be equal to the true state xk , when measurements – that follow a Poisson
distribution whose rate is dependent on the state – are taken. Moreover, we note that Theorem A.1 holds whenever
E[zk ] = Bxk , so as long as the expected value of the observations is linear in the state one could choose an appropriate
B to have an unbiased estimator. We now turn to the construction of the optimal linear filter.
Theorem A.2. Among all linear filters, the filter given by the linear estimator of A4 with gain matrix Kk given by
Kk = Pk−1 B T BPk−1 B T + Vk

−1

is optimal in the sense of minimal sum of squared errors when Vk = diag(Bxk ). In other words,
∂Jk
=0
∂Kk
where
Jk = trace(Pk ) = E[||x̂k − xk ||22 ] =

X
i

E[(x̂k − xk )2i ]

Proof. Using (A5), we solve for the estimation error covariance Pk as


Pk =E ǫx,k ǫTx,k
n
T o

=E [(I − Kk B)ǫx,k−1 − Kk (zk − Bxk−1 )] ǫTx,k−1 (I − Kk B)T − (zk − Bxk−1 )T KkT
=(I − Kk B)E[ǫx,k−1 ǫTx,k−1 ](I − Kk B)T − (I − Kk B)E[ǫx,k−1 (zk − Bxk−1 )T ]KkT

− Kk E[(zk − Bxk−1 )ǫTx,k−1 ](I − Kk B)T + Kk E[(zk − Bxk−1 )(zk − Bxk−1 )T ]KkT

(A6)

Since the estimation error at time k − 1 given by ǫx,k−1 = x − x̂k−1 is independent of the measurement zk at time k,
we have
E[ǫx,k−1 (zk − Bxk−1 )T ] = E[ǫx,k−1 ]E[(zk − Bxk−1 )T ]
=0
since the expected value E[ǫx,k−1 ] and E[zk − Bxk−1 ] are both zero. More generally, when xk−1 = xk is a random
variable, ǫx,k−1 may not be independent of the measurement zk , however, the above expectation is still zero since,
E[ǫx,k−1 (zk − Bx)T ] = E[(xk−1 − x̂k−1 )(zk − Bxk−1 )T ]

= E[E[(x − x̂k−1 )(zk − Bxk−1 )T | xk−1 , z1 , ..., zk−1 ]]
= E[(xk−1 − x̂k−1 )E[(zk − Bxk−1 )T | xk−1 , z1 , ..., zk−1 ]]
= E[(xk−1 − x̂k−1 )(E[zk | xk−1 , z1 , ..., zk−1 ] − Bxk−1 )T ]
= E[(xk−1 − x̂k−1 )(E[zk | xk−1 ] − Bxk−1 )T ]
= E[(xk−1 − x̂k−1 )(Bxk−1 − Bxk−1 )T ]
=0

18
where the second equality follows from the law of total expectation and E[zk | xk−1 , z1 , ..., zk−1 ] = E[zk | xk−1 ] = Bxk−1
since the random variables z1 , ..., zk are conditionally independent given xk−1 = xk . Therefore, (A6) reduces to
Pk =(I − Kk B)E[ǫx,k−1 ǫTx,k−1 ](I − Kk B)T + Kk E[(zk − Bxk−1 )(zk − Bxk−1 )T ]KkT

(A7)

Using the fact that Bx = E[zk ], we rewrite (A7) as
Pk =(I − Kk B)E[ǫx,k−1 ǫTx,k−1 ](I − Kk B)T + Kk E[(zk − E[zk ])(zk − E[zk ])T ]KkT

(A8)

Recall that for a random variable Y with mean E[Y ], the ith central moment of Y , which is written as
ith central moment of Y = E[(Y − E[Y ])i ]
equals its variance when i = 2 (see Chapter 2 of [28]). Therefore,
E[(zk − E[zk ])(zk − E[zk ])T ] = Vk

(A9)

where Vk ∈ Rm×m , which is written as Vk = diag(Bxk ), is the covariance of zk . Substituting (A9) into (A8) gives
Pk =(I − Kk B)Pk−1 (I − Kk B)T + Kk Vk KkT

(A10)

which is the recursive formula for determining the covariance of the least squares estimation error. We then minimize
the sum of the estimation error variances at time k. From the cost function
Jk = trace(Pk )

(A11)

∂Jk
= 2(I − Kk B)Pk−1 (−B)T + 2Kk Vk
∂Kk

(A12)

we write

Setting (A12) equal to zero to find the value of Kk that minimizes Jk ,
Kk

Kk Vk = (I − Kk B)Pk−1 B T

Vk + BPk−1 B T = Pk−1 B T

Kk = Pk−1 B T BPk−1 B T + Vk

−1

(A13)

This implies that the optimal gain matrix Kk given by (A13) minimizes the sum of squared errors when Vk =
diag(Bxk ).
We note that if all the states x are used to generate the output y, such that each state xi is used to generate its
Poisson random measurement zi , then Vk = diag([c1 x1k , c2 x2k , · · · , cm xmk ]) where m = n. Since the true state xk
is unavailable to the estimator, we replace xk with x̂k−1 . Therefore we have
Vk = diag([c1 x̂1k−1 , c2 x̂2k−1 , · · · , cm x̂mk−1 ]) = diag(B x̂k−1 )
which results in a suboptimal filter.
Recursive weighted least square estimator algorithm

1 Initialization
x̂0 = E[x]


P0 = E (x − x̂0 )(x − x̂0 )T
2 Estimation
−1
Kk = Pk−1 B T BPk−1 B T + Vk
x̂k = x̂k−1 + Kk (yk − B x̂k−1 )
Pk = (I − Kk B)Pk−1 (I − Kk B)T + Kk Vk KkT

(A14)
(A15)
(A16)

19
2.

Kalman filter based on WLS with Poisson observations

Consider the linear stochastic discrete-time dynamic system with indirect measurements of the state given by
xk = Fk−1 xk−1 + Gk−1 uk−1 + wk−1 ,
yk = zk ,

wk ∼ N (0, σ 2 )
zk ∼ Poisson(λk = Bxk )

(A17)
(A18)

The expected value of both sides of (A17) is given as
x̄k = E[xk ] = Fk−1 x̄k−1 + Gk−1 uk−1

(A19)

Using
T
T
(xk − x̄k )(xk − x̄k )T =Fk−1 (xk−1 − x̄k−1 )(xk−1 − x̄k−1 )T Fk−1
+ wk−1 wk−1

T
T
+ Fk−1 (xk−1 − x̄k−1 )wk−1
+ wk−1 (xk−1 − x̄k−1 )T Fk−1

(A20)

the covariance of xk is given as


Pk− =E (xk − x̄k )(xk − x̄k )T
+
T
=Fk−1 Pk−1
Fk−1
+ Wk−1

(A21)

T
because E[(xk−1 − x̄k−1 )wk−1
] = 0, since (xk−1 − x̄k−1 ) is uncorrelated with wk−1 . Therefore from (A21), (A14),
−
+
(A15), and (A16), we replace x̂k−1 with x̂−
k , we replace Pk−1 with Pk , we replace x̂k with x̂k , and we replace Pk
+
with Pk . We then get the Poisson Kalman filter equations for each time step k = 1, 2, · · · :

−
−
x̂+
(A22)
k = x̂k + Kk yk − B x̂k
+
T
Pk− = Fk−1 Pk−1
Fk−1
+ Wk−1
−1
Kk = Pk− B T BPk− B T + Vk

x̂−
k
Pk+

=

Fk−1 x̂+
k−1

= (I −

(A23)

(A24)

+ Gk−1 uk−1

Kk B)Pk− (I

T

− Kk B) +

(A25)
Kk Vk KkT

(A26)

