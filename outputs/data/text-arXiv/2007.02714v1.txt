A review of spatial causal inference methods for environmental and
epidemiological applications
Brian J Reich1 , Shu Yang1 , Yawen Guan2 , Andrew B Giffin1 , Matthew J Miller1
and Ana G Rappold3
July 7, 2020

arXiv:2007.02714v1 [stat.ME] 6 Jul 2020

Abstract
The scientific rigor and computational methods of causal inference have had great impacts on
many disciplines, but have only recently begun to take hold in spatial applications. Spatial casual inference poses analytic challenges due to complex correlation structures and interference
between the treatment at one location and the outcomes at others. In this paper, we review the
current literature on spatial causal inference and identify areas of future work. We first discuss
methods that exploit spatial structure to account for unmeasured confounding variables. We
then discuss causal analysis in the presence of spatial interference including several common
assumptions used to reduce the complexity of the interference patterns under consideration.
These methods are extended to the spatiotemporal case where we compare and contrast the
potential outcomes framework with Granger causality, and to geostatistical analyses involving
spatial random fields of treatments and responses. The methods are introduced in the context of
observational environmental and epidemiological studies, and are compared using both a simulation study and analysis of the effect of ambient air pollution on COVID-19 mortality rate.
Code to implement many of the methods using the popular Bayesian software OpenBUGS is
provided.
Key words: Interference; potential outcomes; propensity scores; spatial confounding; spillover.

1

North Carolina State University
University of Nebraska - Lincoln
3
US Environmental Protection Agency
2

1

Introduction

Large-scale environmental and epidemiological studies often use spatially-referenced data to examine the effect of treatments or exposures on a health endpoint. Examples include studying the
effect of interventions on the spread of an infectious disease, pesticide application on cancer rates,
and lead exposure on childhood development. While standard analyses of spatial data simply estimate correlations, the ultimate goal of this research is to establish causal relationships (e.g., Bind,
2019) to inform decision making. Therefore, developing statistical methods to establish causal
relationships when data show spatial and temporal variation is invaluable to environmental science
and epidemiology.
A rich literature on the theory and methods for causal inference for independent data has
emerged (Bind, 2019; Hernn and Robins, 2020), but progress for spatial applications has been
slow due to several analytic challenges. First, randomization is often infeasible due to logistical or ethical concerns and so studies rely on observational data. Second, exposure and response
variables exhibit spatial correlation complicating statistical modeling and computation. Third, the
treatment at one location may influence the outcomes at nearby locations, a phenomenon known as
spillover or interference. These features of spatial applications violate the assumptions of standard
causal inference methods and require new theory and computational tools.
Despite these challenges, major advances in spatial causal inference have been made in recent
years. In this paper, we review the recent progress on spatial causal inference, evaluate and compare current methods, and suggest areas of future work. We first review methods to adjust for
missing spatial confounding variables (Hodges and Reich, 2010). Most causal inference methods
for observational data rely on an assumption of no missing confounding variables (i.e., unmeasured variables correlated with both the treatment and response). However, if the missing confounding variables have prominent spatial patterns, methods have been developed to mitigate the
bias caused by their omission. These methods include case-control matching (e.g., Jarner et al.,
2002), neighborhood adjustments by spatial smoothing (e.g., Schnell and Papadogeorgou, 2019)
and propensity-score methods (e.g. Davis et al., 2019). We review these methods and conduct a
simulation study to compare their precision for estimating a causal treatment effect in the presence
1

of a missing spatial confounding variable. A subset of the methods are applied to a study of the
effect of ambient air pollution on the COVID-19 mortality rate.
A second major challenge in spatial causal inference is interference, where the treatment applied at one location affects the outcomes at other locations. For example, an intervention to reduce
the emissions from a power plant would affect the air quality at the power plant, but also locations
downwind. Capturing these spillover effects requires new definitions of the estimands of interest
and new spatial models for the causal effects. In full generality, allowing the treatment at a site
to affect the outcomes at all other sites results in an intractable estimation problem. Therefore,
assumptions are required to limit the form and spatial extent of interference. We review several
models for spatial interference including partial (e.g. Zigler et al., 2012) and network (e.g. Tchetgen et al., 2017) interference. We also discuss recent methods that combine mechanistic and
spatial statistical models to anchor the causal analysis to scientific theory.
We begin reviewing these methods using cross-sectional data at a single time point, and then
extend these methods to the spatiotemporal data. We discuss adapting spatial methods to the spatiotemporal setting, and methods specific to the temporal case such as difference-in-difference
methods (e.g. Delgado and Florax, 2015) that exploit changes over time to estimate causal effects.
We also compare and contrast causal methods based on the potential outcomes framework (Rubin, 1974) with Granger causality (Granger, 1969), which is defined specifically for processes that
evolve over time. We also discuss extensions of spatial methods for areal data defined at a finite
number of regions (e.g., geopolitical units) to point-referenced (geostatistical) data in which case
the treatment and response variables can be modeled as continuous random fields over an uncountable number of spatial locations. This requires new definitions of causal effects, new methods for
matching observations for case-control studies, and new models for missing spatial confounding
variables and spillover effects. The paper concludes with a summary of the current literature and
discussion of open problems in this rapidly-advancing field.

2

2

Adjusting for spatial confounders

To ensure privacy, public health data are often made available only after aggregation to administrative or geopolitical regions. For areal data of this nature, we adapt the notation that Yij , Aij
and Xij = (Xij1 , ..., Xijp ) are the response, treatment and potential confounding variables (with
Xij1 = 1 for the intercept) for observation j ∈ {1, ..., ni } in region i ∈ {1, ..., N } for a total of
P
n= N
i=1 ni observations. The confounding variable in Xij can include both covariates specific
to observation j within region i or summaries of the region i common to all ni observations in the
region. In addition to these observed variables, we allow for an unobserved confounding variable
Ui in region i, which is assumed to be a purely spatial term and thus the same for all observations
in a region.
Example 1: As a concrete example, consider an environmental epidemiology study where Yij
is the birth weight of the j th baby born in zip code i and Aij = 1 if the average ambient air pollution concentration in the mother’s zip code exceeds a high threshold and Aij = 0 otherwise.
We may adjust for known confounding variables by including the mother’s age and family income
in Xij , and describe the mother’s environment by including the median income and measurable
environmental factors such the average concentration of other known pollutants in region i in Xij .
In this scenario, the missing spatial confounder variable Ui might be a second pollutant unknown
to the researchers. The second pollutant qualifies as a missing spatial confounder if it has a strong
spatial pattern, is associated with low birth weight, and is correlated with the pollutant of interest,
perhaps via a common source. Failing to account for this missing spatial confounder, either because its importance is unknown or data are unavailable, may inadvertently attribute the effects of
the unknown pollutant to the pollutant of interest, biasing the estimator.
In this section we review spatial models for unknown processes such as U = (U1 , ..., UN )T
(Section 2.1) and causal inference methods that would apply if U were observed (Section 2.2). The
remainder of the section is dedicated to methods that attempt to control for the missing confounder
variable by exploiting its spatial structure.

3

2.1

Review of spatial confounding

Consider the spatial regression model
Yij = Aij β + Xij γ + Ui + εij ,

(1)

where β is the treatment effect of interest, γ determines the effects of the confounding variables,
iid

Ui is the spatial random effect for region i and εij ∼ Normal(0, τ 2 ). A common approach (Banerjee et al., 2014) for areal data is to model the unobserved spatial effects using a conditionally
autoregressive (CAR) model (also known as a Gaussian Markov random field model). The CAR
model specifies spatial dependence in terms of the adjacencies between the regions. The full
conditional distribution of the random effect for one region given all other random effects is
Ui |Uk , k 6= i ∼ Normal(ρŪi , σ 2 /mi ), where Ūi is the mean of U at the mi regions adjacent to
region i, and ρ ∈ (0, 1) and σ > 0 are spatial covariance parameters. These full conditional
distributions define a multivariate normal distribution (Appendix A.2) for U, which we denote as
U ∼ CAR(ρ, σ).
The spatial regression model in (1) where U is modelled as a spatial process often gives very
different estimates of covariate effects than the non-spatial model that excludes U, especially when
the treatment variable exhibits a strong spatial pattern (Reich et al., 2006; Paciorek, 2010; Hodges
and Reich, 2010). However, simply accounting for spatial correlation does not resolve spatial
confounding. For example, Appendix A.1 describes a scenario where the bias of the posteriormean estimator for β depends on the strength of dependence between the treatment variable and
the unmeasured confounding variable, but is the same whether the residuals are assumed to be
independent or spatially correlated. The bias of this approach is confirmed in our simulation study
(Section 2.8) when data are generated with correlation between U and the treatment and response
variables. This calls for methods that explicitly adjust for missing spatial confounders by blocking
the dependence of U on either the treatment or response variable.

4

2.2

Potential outcomes framework

In this section we temporarily assume that Ui is observed (and thus treated the same way as Xij ) to
facilitate a review of standard non-spatial causal inference methods. We begin with the potential
outcomes framework (Rubin, 1974). Assume that the treatment Aij is binary and that each unit
has two potential outcomes, Yij (0) and Yij (1), which represent the outcomes if the unit j in region
i is given treatment Aij = 0 or Aij = 1, respectively. Our goal is to estimate the average treatment
effect (ATE),
"

#
ni
N
1 XX
δ=E
{Yij (1) − Yij (0)} ,
n i=1 j=1

(2)

where the expectation is taken with respect to both Xij and {Yij (0), Yij (1)}. The fundamental
problem is that only one of the two potential outcomes can be observed (Holland, 1986) rendering the other as counterfactual. Therefore, assumptions are required to ensure the ATE can be
identified.
This notion of potential outcomes implicitly encodes the Stable Unit Treatment Values Assumption (SUTVA; Rubin, 1978).
Assumption 1 (SUTVA). There is no interference and a single version of treatment.
SUTVA is violated under interference where Yij depends not only on Aij , but also on the treatment
of other units. For instance, the birth weight of a baby in Example 1 could be influenced by the
air pollution concentration both in the mother’s zip code (Aij ) but also in other zip codes that
the mother frequents. In this case, the potential outcomes are not determined by Aij alone, and
we would need to introduce a different potential outcome for each combination of the treatment
variables in the mother’s vicinity (see Section 3).
An example of multiple versions of treatment might be if birth weight actually depends not only
on whether the air pollution exceeds a high threshold, but also a second extremely high threshold.
In this case, Aij actually has three levels (low, high and extremely high) and there should be three
potential outcomes. An analysis that collapses the two high categories into a single group with
Aij = 1 would violate SUTVA by having multiple versions of the treatment. Violation of this
assumption could be rectified by assuming Aij has three categories and thus each unit has three
5

potential outcomes.
While SUTVA links treatments to potential outcomes, the consistency assumption is needed to
further link the potential outcomes to the observations.
Assumption 2 (Consistency). The observed response is the potential outcome determined by the
observed treatment variable, Yij = Yij (Aij ).
In addition to these assumptions about the treatment and response variables, a standard assumption that permits unbiased estimation of the ATE is the no missing confounder variables other
than the observed covariates Xij and the latent spatial confounder Ui . We term this assumption as
the latent ignorability assumption:
Assumption 3 (Latent ignorability). The potential outcomes {Yij (0), Yij (1)} and treatments Aij
are independent given Xij and Ui .
Since U is generally a latent (i.e., unknown) variable in the spatial setting, this assumption presumes that there exists some variable U that blocks dependence between the treatment variable
and potential outcomes; if U is observed then this is the usual assumption that there are no unmeasured confounding variables. This assumption implies that the confounding variables {Xij , Ui }
are sufficient to adjust for correlation between the observed treatment and response that is due to
non-randomized treatment allocation and not an actual causal effect. This requirement highlights
the importance of careful evaluation of the system under study to ensure that all relevant variables
are considered in Xij .
The final assumption deals with the distribution of observed treatment variables, i.e., the propensity score. The propensity score is the probability of the treatment assignments, Prob{Aij = 1 |
Xij , Ui , Yij (0), Yij (1)}. Under Assumption 3, the propensity score becomes
e(Xij , Ui ) = Prob(Aij = 1 | Xij , Ui ).
Assumption 4 is the standard positivity assumption on the propensity score:
Assumption 4 (Positivity). Both e(Xij , Ui ) and 1 − e(Xij , Ui ) are positive for all Xij and Ui .
6

(3)

This assumption implies that both Aij = 0 and Aij = 1 are possible under the treatment allocation mechanism, which is necessary to estimate the ATE in (2) which averages over the expected
potential outcome under both treatments.
Under Assumption 3 the propensity score is a function of known variables Xij and Ui and can
thus be estimated without knowledge of unobservable counterfactual responses. However, Assumptions 1-3 are difficult or impossible to verify empirically, and thus a causal inference requires
scrutinizing the study design and the processes of interest to justify that these assumptions hold.
One of the main contributions of causal inference is to state explicitly the assumptions needed for
an estimator to have a casual interpretation, and thus guide a discussion of a study’s results.
Assumptions 1–4 underlie many non-spatial causal estimation procedures such as (augmented)
inverse probability weighting (e.g., Rosenbaum and Rubin, 1983a; Robins and Greenland, 1994;
Bang and Robins, 2005; Cao et al., 2009), and matching (e.g., Rosenbaum, 1989; Heckman et al.,
1997; Hirano et al., 2003; Hansen, 2004; Rubin, 2006; Abadie and Imbens, 2006; Stuart, 2010;
Abadie and Imbens, 2016). To fix ideas, we focus on the simplest approach of the linear model in
(1) where Ui is observed and thus not given a spatial model. Spatial analyses often rely on parametric models because the lack independent replications in a region complicates non-parametric
methods. The parametric model in (1) makes the additional assumptions of linearity and normality,
but gives valid causal inference under the assumed model and Assumptions 1-4. In other words,
the regression coefficient β can be interpreted as the ATE, δ. Therefore, if Ui is observed and
these assumptions hold, then the estimate of β from a standard least squares analysis has a causal
interpretation. In the remainder of this section we discuss methods to deal with unknown U.

2.3

Case-control matching methods

While most of the methods we discuss control for confounding at the analysis stage, a case-control
study controls for confounding at the design stage. In a case-control analysis of a binary response
variable (i.e., Yij ∈ {0, 1}), each case (Yij = 1) is matched with one or more controls (Yij = 0)
that are drawn from the same underlying population at risk. When applying this study design,
investigators sample controls to resemble cases with respect to all factors that may determine the

7

disease status except for the exposure of interest. As discussed below, this design removes the
need to adjust for the matching factors at the analysis stage. Matching variables can be specific
to the individual, such as age or education level. Partial control for spatial variation of risk can
be achieved by matching on confounding factors that vary spatially such as the region’s median
income. To adjust for unmeasured spatial confounders, controls can be matched based on their
proximity to the cases (Jarner et al., 2002). Assuming there is replication within region (ni > 1)
and treatment varies within region (Aij 6= Ail for some j and l) then matching individuals in the
same region is an effective means of adjusting for spatial confounding.
Matched case-control data are most often analyzed using conditional logistic regression. Assume each case Yij = 1 is paired with a single control Ykl = 0. Under the spatial logistic regression
model logit{Prob(Yij = 1)} = Aij β + Xij γ + Ui , the log odds that Yij = 1 given either Yij = 1 or
Ykl = 1 (but not both) is
ηij = (Aij − Akl )β + (Xij − Xkl )γ + Ui − Uk .
To account for variability within each pair (strata), a random intercept zij is added so the likelihood
contribution of the pair is
Prob(Yij = 1|Yij = 1 + Ykl = 1) = exp(ηij + zij )/{1 + exp(ηij + zij )}.
Since the covariates appear in the likelihood only through the difference Xij − Xkl , the effect of
covariates used for matching cannot be estimated and these covariates can be removed from the
model. Similarly, if cases are paired with observations from the same region (i.e., i = k), then
the spatial random effects U do not appear in the likelihood and a non-spatial analysis is sufficient.
Thus, while the matched case-control analysis is an excellent means of controlling for confounders,
its drawbacks include discarding data and not being able to estimate all covariate effects and spatial
variation in risk.
Pairing observations in the same region can also be applied for continuous responses. For a
continuous response there is no natural definition of a case or control, but regressing the difference

8

between the responses in the same region removes spatial confounding. For example, under the
linear model in (1) the model for the difference between responses in the same region is
Yij − Yil = (Aij − Ail )β + (Xij − Xil )γ + ˜i ,

(4)

where ˜i is independent error. Again, differencing eliminates the latent variable Ui , and thus the
differences can be analyzed with non-spatial methods. This approach relies on a parametric linear
model, but the concept of reducing bias by pairing observations in the same location can also be
applied using weighting based on the propensity score model (He, 2018).

2.4

Neighborhood adjustments

In (4), modelling the difference between observations in the same region eliminated the unmeasured confounders. In cases without replication and a missing confounder that varies smoothly
across space, its effect can be reduced by removing large-scale spatial trends from the response,
the treatment, or both. Removing large-scale trends isolates local variation in the response, which
is arguably less prone to spatial confounding than large-scale variation. In this section we review
several methods that have been proposed for removing large-trends in spatial regression.
2.4.1

Simultaneous Autoregressive models

For simplicity, assume there are no replications within each region and temporarily drop the replication subscript by defining Yi1 = Yi , Xi1 = Xi and Ai1 = Ai . Rather than specifying the
regression on the response, the Simultaneous Autoregressive (SAR) model first subtracts regional
means
Yi − φȲi = (Ai − φĀi )β + (Xi − φX̄i )γ + εi ,

(5)

where Ȳi , Āi and X̄i are the means of the response, treatment and covariates at the mi regions
iid

adjacent to region i, φ is an unknown parameter and εi ∼ Normal(0, σ 2 ). Taking differences
reduces the effect of missing confounding variables that are constant across neighboring regions.
In vector form, (5) can be expressed as Y = Aβ + Xγ + ε where the spatial covariance of ε
9

is given in Appendix A.2. Wall (2004) compares differences in covariance implied by the SAR
and CAR models. Wall (2004) finds the models produce similar regression coefficient estimates
despite sometimes large differences in covariances between regions.
2.4.2

Neighborhood adjustment via spatial smoothing

Rather than simply subtracting the mean of neighboring sites, spatial trends can be removed by
joint spatial modeling of the treatment and the missing spatial confounder. Consider the spatial
regression model in (1) without replicates. The bias is a result of attributing the effect of the confounder on Y to the treatment variable when A and U are correlated (Appendix 1). Schnell and
Papadogeorgou (2019) provide a set of assumptions (given in the Appendix) to identify the unmeasured confounding bias E(Ui |A) = Bi (A). They model Bi (A) by specifying a joint distribution
for U and A that allows each process to have a different range of spatial correlation and permits
correlation between U and A. The confounding bias is mitigated by fitting a joint model
Yi = Ai β − Bi (A) + Xi γ + ei1

(6)

Ai = Xi α + ei2 ,
where the form of Bi (A) and the spatial covariance of ei1 and ei2 are given in Appendix A.3. As
noted by Schnell and Papadogeorgou (2019) and was also suggested by Paciorek (2010), if the spatial scale of treatment is larger or about the same as the unmeasured confounder, the confounding
bias cannot be mitigated.

2.5

Propensity score methods

Propensity scores are used in a wide range of causal inference methods. Assuming a binary treatment variable, the propensity score for observation j in region i is Prob(Aij = 1) = eij . In a
standard analysis the propensity scores are modeled as a function of the known covariates Xij and
the estimated propensity scores are used to alleviate the imbalance of the covariates between treatment groups. Here we face the additional challenge that the propensity scores may depend on the

10

unobserved spatial process, Ui .
For example, consider the simple hierarchical model that includes the unobserved spatial process in the propensity score,
Yij = Aij β + Xij γ + Ui + εij
Aij ∼ Bernoulli(eij )

(7)
logit(eij ) = Xij α + φUi + Vi ,

with

(8)

where Vi accounts for spatial patterns in treatment allocation not accounted for by the covariates or
the missing confounder Ui . To emphasize the effect of the propensity score on the response model,
(7)-(8) can be reparameterized (Ui = ui + γvi and Vi = vi − ψui + φψvi ) as
Yij = Aij β + Xij γ + ui + ψvi + εij
Aij ∼ Bernoulli(eij )

with

logit(eij ) = Xij α + vi .

(9)
(10)

The shared spatial random effect vi adjusts for the missing confounder by absorbing signal in the
response that can be explain by spatial trends in the treatment allocation. The spatial random effects
can be assigned priors u = (u1 , ..., uN )T ∼ CAR(ρu , σu ) independent of v = (v1 , ..., vN )T ∼
CAR(ρv , σv ). Fitting this joint model for the treatment and response processes is straightforward
using hierarchical Bayesian methods.
A concern with this model is that some of its many parametric assumptions could be violated,
invalidating inference. Another issue is that of so-called “feedback”, which in this context refers
to information in the response influencing the posterior of the propensity scores (e.g., Zigler et al.,
2013; Zigler, 2016; Saarela et al., 2016). Eliminating this feedback can be done by fitting the
model in two stages, i.e., first fitting the model for the treatment indicators in (10) to obtain an
estimate of v and then fitting (9) with v fixed at its first-stage estimate. Other possible remedies
include “cutting feedback” in the steps of the MCMC algorithm (Lunn et al., 2009; McCandless
et al., 2010) or post-hoc reweighting of the posterior distribution (Saarela et al., 2015; Davis et al.,
2019). These methods are discussed below.
Referring to the joint model in (9)-(10), if the propensity score eij were known and logit(eij )
11

were included as a known confounder in Xij , then latent ignorability (Assumption 3) would hold
and the resulting estimate of β would have a causal interpretation. Of course, the exact propensity
is unknown and must be estimated. Let êij be a first-stage propensity-score estimator, e.g., as estimated by fitting the spatial logistic regression model in (10). The estimated propensity scores can
be included in the mean of the response model to account for spatial confounding. The propensity
score can be added to the response model as,
Yij = Aij β + Xij γ̃ + Ui + f (êij ) + εij

(11)

where f is the logit function or more generally a non-linear function estimated by, say, smoothing
splines. Given the inclusion of the propensity score, it can now be assumed that Ui and Aij are conditionally independent. Assuming the model assumptions hold and the propensity score estimate
is accurate, then β has a causal interpretation.
Alternatively, the propensity score estimates can be used to define strata, i.e.,
Yij |êij ∈ [Tl , Tl+1 ) = Sl + Aij β + Xij γ + Ui + εij

(12)

where 0 = T1 < T2 < .... < TL+1 = 1 define the propensity-score strata, Sl encodes the unmeasured confounder effect for strata l and Ui and Aij are conditionally independent. Although
the strata are defined irrespective of spatial information, the spatial random effect Ui accounts for
spatial dependence.
This joint modeling framework can be extended to continuous treatment variables by replacing
the the Bernoulli/logistic model for Aij in (10) with a normal model with E(Aij | Xij , vi ) = eij =
Xij α + vi and Var(Aij | Xij , vi ) = σA2 . This method could be fit as a joint model or in two stages
where first a Gaussian spatial model for Aij is fit and estimates of eij are used as generalized
propensity scores (Hirano and Imbens, 2004) in the response model as in (11) or (12). Generally,
this model-based framework can be adapted to more complex settings as long as a model with
reasonable fidelity to the data generating process can be determined and justified.
As an alternative to model-based causal adjustment, Davis et al. (2019) use imputation of

12

potential outcomes and propensity-score weighting. They first estimate propensity scores êij using
a spatial regression such as (10). Then in a second stage, they fit the response model in (1),
which excludes the propensity score. Rather than use the estimate of β from this analysis, they
post-process the model output to remove confounding bias. They estimate the causal effect using
concepts from augmented inverse probability weighting (Rosenbaum and Rubin, 1983; Robins
et al., 1994; Bang and Robins, 2005; Cao et al., 2009)
ni
N
1 XX
δij
N i=1 j=1
o
o
1 n
1 n
Aij Yij − (Aij − êij )Ỹij1 −
(1 − Aij )Yij − (êij − Aij )Ỹij0
=
êij
1 − êij

δ =
δij

(13)

where Ỹija = aβ̂ + Xij γ̂ + Ûi is the estimated mean response setting Aij = a for a ∈ {0, 1}.
Davis et al. (2019) suggest using bootstrap sampling (which account for uncertainty at all stages)
or a closed form large-sample variance estimator to quantify uncertainty in δ. Alternatively, in a
Bayesian analysis, samples from the posterior distribution of δ can be made by computing δ for
each posterior sample of {β, γ, U}.

2.6

Instrumental variables

An instrumental variable (IV) Zi is widely used to deal with unmeasured confounding. An valid
IV must (a) be associated with the treatment Ai , (b) not be related to the unmeasured confounder
Ui , and (c) not be directly affect the outcome. Figure 1 illustrates the dependence structure of the
random variables. As an example, suppose Ai is a region’s air pollution level and Yi is the region’s
asthma rate. A potential instrumental variable is the region’s traffic density, Zi . As traffic is a
major source of air pollution, it is clear that Ai and Zi are correlated, and it can be argued that
traffic density is unrelated to asthma rate other than via air quality.
The classic causal analysis with IVs is a two-stage least squares regression, The treatment is
first regressed onto the IV, and then the fitted values from this first-stage regression as used as
the treatment variable in the response model. That is, if the first-stage regression gives Âi =
α̂0 + Zi α̂1 + Xi α̂2 , then the second stage model replaces Ai with Zi α̂1 , i.e., Yi = α̂1 Zi β + Xi γ + εi .
13

Figure 1: A directed acyclic graph (DAG) represents the dependence of the random variables.
Z is the instrumental variable, A is the treatment, Y is the outcome, X is the observed confounder,
and U is the unobserved confounder.

This confines the treatment variable to the span of the instrumental variable, and thus to a space
orthogonal to the missing confounding variable. If a valid IV can be identified then this provides a
simpler means of estimating average treatment effect instead of adjusting for missing confounders
than propensity scores.
Some caution has to be exercised when interpreting causal estimates based on IVs. In the observational setting, as in traffic instrument example, the investigators do not have the ability to
enforce treatment (PM) based on treatment assignment (traffic). Although traffic is a major source
of variation in PM, other sources can play a role which leads to differences between intended and
observed treatments among units and potentially to the heterogeneity of responses (power plants,
wildfires, etc). In randomized treatment-control examples, this equates to the lack of full compliance between treatment assignment and the intake of drug. The implication is that the ATE is
estimated only among those whose PM variation is explained by variation in the instrumental variable, referred to as the local average treatment effect (LATE) or complier average treatment effect
(CATE). Imbens and Angrist (1994) provide the criteria under which the LATE/CATE represents
the ATE.
Spatial consideration can be made in both stages of the model. Consider a continuous treatment
variable and the joint model
Yij = α1 Zij β + Xij γ + Ui + 1ij

(14)

Aij = α0 + Zij α1 + Xij α + φUi + Vi + 2ij ,

(15)

14

iid

iid

where U ∼ CAR(ρU , σU ), V ∼ CAR(ρV , σV ), 1ij ∼ Normal(0, τ12 ) and 2ij ∼ Normal(0, τ22 ). In
(14), Aij in the response model in (1) is replaced by Zij α1 in the instrumental variable regression.
Spatial random effects are included in both stages of the model to provide more efficient estimators
of the regression coefficients and valid uncertainty quantification. This model closely resembles
the joint propensity score model in (7)-(8) except that only the signal in Aij than can be explained
by the IV enters the response model.
The two models in (14)-(15) can be fit simultaneously, although feedback effects must be considered as in the propensity score methods of Section 2.5. Alternatively, the method can be fit in
two stages. The first stage is a spatial regression of Ai onto Zi in (15) and Xi gives an estimate of
α1 . In the second stage spatial regression of the response, Zi α̂1 is used as the treatment variable.
An important difference between the classical and this spatial IV approach is that in the spatial
version the fitted values will not be strictly orthogonal to the errors Ui . A potential remedy is the
use of restricted spatial regression (Reich et al., 2006; Hodges and Reich, 2010; Hughes and Haran,
2013; Hanks et al., 2015).

2.7

Structural equation modeling

Thaden and Kneib (2018) propose to adjust for spatial confounding using structural equation modelling (SEM). They introduce binary indicator variables for each spatial location in both the models
for the treatment and response variables. Therefore, although motivated using SEMs, they arrive
at a similar model to the joint model in (9)-(10). They argue that independent priors for the random effects (ui and vi in (9)-(10)) more effectively resolve spatial confounding than spatial priors.
Treating the random effects as independent requires replication within region, which is not always available. However, when there is sufficient replication within regions, independent priors
are preferable to spatial models because they are less constrained and thus more completely block
spatial confounding.

15

2.8

Simulation study

In this section we conduct a simulation study to compare methods for adjusting for an unmeasured confounding variable. We examine how the methods compare with different levels of spatial
correlation in the treatment and confounding variable, and robustness to model misspecification.
Data generation: We generate data from the model
indep

Yi |Ai ∼ Normal(Ai β + Ui , 1)

and

indep

Ai ∼ Bernoulli [expit {g(Vi , φUi )}]

(16)

where the spatial terms are drawn from the model U ∼ CAR(ρU , 2), V ∼ CAR(ρV , 2) and the
transformation function g is given below. The correlation structure is determined by three parameters: ρU and ρV control the range of spatial dependence and φ controls the strength of spatial
confounding. For simplicity we exclude known confounders Xi to isolate the effects of spatial
confounding. The first four scenarios have g(Vi , φUi ) = Vi + φUi and vary ρU , ρV ∈ {0.90, 0.99}
to study the performance of the joint model when it is correctly specified. Setting the CAR dependence parameter to 0.99 gives strong spatial dependence with correlation 0.54 between adjacent
regions in the center of the grid, while the value 0.90 gives moderate correlation of 0.35 between
adjacent regions in the center of the grid. The final two scenarios have ρU = ρV = 0.99 but
nonlinear function g(Vi , φUi ) = Vi + φ{Ui I(Ui > 0) − 0.63} (“Nonlinear”) or the nonstationary
function g(Vi , φUi ) = Vi + φUi ci where ci increases linearly from zero to one across the columns
of the grid (“Nonstationary”). These scenarios are included to investigate the performance of the
joint model when it is misspecified.
We generated 100 datasets on a 30 × 30 square grid of regions with rook neighbors and β =
φ = 0.5. For each dataset we fit the following models.
indep

• NS: Non-spatial least squares, Yi ∼ Normal(γ + Ai β, τ 2 )
• NS+P: Non-spatial least squares with a spline function of the propensity score,
indep

Yi ∼ Normal {γ + Ai β + f (êi ), τ 2 }
indep

• S: Spatial CAR regression without confounder adjustment, Yi ∼ Normal(γ +Ai β +Ui , τ 2 )

16

• S+P: Spatial CAR regression with a spline function of the spatial propensity score,
indep

Yi ∼ Normal(γ + Ai β + Ui + f (êi ), τ 2 )
• S+AIPW: Spatial CAR regression with post-hoc IDW debiasing step, i.e., model S with
post-processing as in (13)
• Joint: Joint model in (9)-(10)
• Cut: Joint model with feedback cut as in McCandless et al. (2010)
In these models êi is computed using the spatial logistic regression in (10) and f is a B-spline
basis expansion with five degrees of freedom. The priors for all models are U ∼ CAR(ρU , σU ),
V ∼ CAR(ρv , σv ), ρU , ρV ∼ Uniform(0, 1), all mean parameters have Normal(0, 10) priors and
all variances have InvGamma(0.5, 0.005) priors. All of these method are fit in OpenBUGS and the
code is available at https://github.com/reich-group/SpatialCausalReview/.
Figure 2 plots the causal effect estimates across datasets for each scenario and statistical
method. As expected, the non-spatial method (NS) without causal adjustment is biased and has
low coverage in all cases. The spatial model without causal adjustment (S) provides only a small
improvement. The non-spatial model with spatial propensity score (NS+P) substantially reduces
bias although its coverage remains below the nominal level. The spatial model with causal postprocessing (AIPW) and the joint model that cuts feedback (Cut) have large bias and low coverage
in the cases we considered.
In this simulation the most effective methods are the spatial model with propensity score adjustment (S+P) and the full joint model (Joint). This is not surprising in the first four scenarios because
the joint model was used to generate the data. In these cases the joint model appears to have less
bias than the two-stage spatial propensity score model, but both methods are similar. These models are misspecified in the final two scenarios, but still outperform the other methods. Surely more
extreme scenarios where these methods fail to deliver reliable inference can be devised, but these
results suggest some robustness to model assumptions.
The strength of the spatial correlation in the treatment allocation process appears to be more
predictive of reliable performance than model misspecification. In scenarios (b) and (d) with ρU =
17

Figure 2: Simulation study results. The boxplots summarize the sampling distribution of the
causal estimates across datasets and the solid line at 0.5 is the true value. The scenarios vary by
the spatial dependence parameter of the confounder (ρu ) and treatment (ρv ) variables, and whether
the joint model is misspecified. The competing methods are defined in Section 2.8. The empirical
coverage of 95% credible intervals for the causal effect are given above the model labels.

1.0

2

91

15
Cut

89

Joint

9

1.0

(f) ρU = 0.99, ρV = 0.99, Nonstationary

S+AIPW

Joint

Cut

NS

NS+P

S

95

69

27

84

50

96

22

90

74
Cut

S+P

23

Joint

S

96

S+AIPW

48

S+P

82

S

29

NS+P

22

NS

69

Cut

0

Joint

64

S+AIPW

11

S+P

57
NS+P

0.0

0.5

1.0
0.5

7
NS

0.0

0.5
0.0

83

S+AIPW

1

S+P

27

S

Cut

81

NS+P

Joint

1

NS

S+AIPW

77

Cut

S+P

8

Joint

S

65

(e) ρU = 0.99, ρV = 0.99, Nonlinear

1.0

(d) ρU = 0.90, ρV = 0.90

8

S+AIPW

18

S+P

98

S

3

NS+P

97

NS

5

0.0

0.5

1.0
0.5

91
NS+P

NS

1

Sampling distribution

(c) ρU = 0.99, ρV = 0.90

0.0

0.5

1.0

(b) ρU = 0.90, ρV = 0.99

0.0

Sampling distribution

(a) ρU = 0.99, ρV = 0.99

18

0.9 all of the methods are biased and have low coverage. In these cases the spatial model of the
treatment allocation process has low predictive power and thus all subsequent causal adjustments
are ineffective. In these cases the unmeasured confounder cannot be explained by known covariates
or spatial patterns, and there is simply no structure that can be exploited to remove its effect.

2.9

Effect of PM2.5 exposure on COVID-19 mortality

To illustrate the spatial confounder adjustment methods, we reanalyze the data provided by Wu
et al. (2020). The response Yi for county i is the number of COVID-19 related deaths through May
12, 2020. The treatment variable Ai is the long-term (2000-2016) average fine particulate matter
(PM2.5 ) concentration. These variables are plotted in Figure 3 and both show strong spatial trends.
The known confounder variables in Xi include p = 15 measures of the county’s demographic,
socio-economic and climate conditions (see Table 2 of Wu et al. (2020) for a complete list). Some
covariates (number of hospital beds, BMI and smoking rate) have a high proportion of missing
values. Rather than removing the counties with missing value, which would complicate the spatial
adjacency structure, we remove the covariates with missing value. Removing these covariates does
not greatly affect the effect estimates (as discussed below).
Because the dataset is large and the treatment is continuous we consider only the non-spatial
(“NS”) and spatial (“S”) models and these models with a two-stage propensity score adjustment
(“NS+P” and “S+P”). The response model is Yi ∼ Poisson(Ni λi ) where Ni is the county’s population and λi is the mortality rate. Wu et al. (2020) use a quasi-Poisson model with state-level
random effects; we use county-level random effects and allow these random effects to account for
over-dispersion. Specifically, the mortality rate is modeled as
log λi = Ai β + Xi γ + Ui + f (êi )

(17)

where U ∼ CAR(ρu , σu ), êi is the estimated generalized propensity score (Hirano and Imbens,
2004), and f is a B-spline basis with 5 degrees of freedom. The generalized propensity score
is the fitted negative log-likelihood (ignoring constants) êi = (Ai − Xi α̂ − V̂i )2 , where α̂ and

19

Figure 3: Plots of the COVID-19/PM2.5 data. Panel (a) plots the sample log COVID-19 mortality
rate, log(Yi /Ni ), through May 12, 2020 with gray denoting no observed deaths (Yi = 0); Panel (b)
maps the long-term (2000-2016) average fine particulate matter (PM2.5 ) concentration. Alaska and
Hawaii are excluded from the study.
(a) Log mortality rate

−8
−10
−12
−14

(b) Average PM2.5 concentration (µg/m^3)

12
8
4

20

5

10

NS
NS+P
S
S+P

0

Posterior density

15

Figure 4: Causal effect estimate for the COVID-19/PM2.5 analysis. Posterior distribution of the
log relative risk of an increase of 1 µg/m3 in long-term average PM2.5 (β) on a county’s COVID19 mortality rate. The four models are defined by whether they are non-spatial (“NS”) or spatial
(“S”) and whether they include a spatial propensity score (“+ P”).

−0.1

0.0

0.1

0.2

β

V̂i are the posterior means from the model Ai = Xi α + Vi + εi and V ∼ CAR(ρv , σv ) and
iid

εi ∼ Normal(0, σe2 ). The priors are the same as in Section 2.8. The non-spatial models set ρu = 0
(the county-level random effect remain in the model to account for overdispersion) and the methods
without a propensity score set f (êi ) = 0.
The posterior distributions of β under these four models are plotted in Figure 4. The spatial
models give smaller posterior mean and larger posterior variance than the non-spatial models.
Including the generalized propensity score leads to a slightly higher effect estimate for both the
spatial and non-spatial analyses. The results are generally similar to those in Wu et al. (2020)
who found an 8% increase in COVID-19 related mortality for a unit increase in long-term average
PM2.5 . Therefore, this analysis does not detect a missing spatial confounder that dramatically
affects the causal effect estimate.

21

3

Methods for spatial interference/spillover

Interference (also called spillover) occurs when the treatment received by one unit can affect
the outcomes of other units. The ubiquitous no interference assumption in Section 2.2 was first
discussed in Cox (1958), where it was referred to as “no interaction between units” (Hernn and
Robins, 2020). In the subsequent literature, it is often simply referenced as part of SUTVA. Despite a variety of data and treatments exhibiting interference, methods that account for interference
have only recently begun to proliferate in the statistics literature, in part because interference significantly complicates the potential outcomes approach and requires additional assumptions about
the form of the interference.
In this section we review the challenges associated with accounting for interference, and the
current literature on this topic. In Section 3.1 we give a general formulation of potential outcomes
in the presence of interference, and define several quantities of interest under this framework.
The remainder of the section discusses different assumptions about the nature of interference and
subsequent estimation methods.

3.1

Potential outcomes framework

In the potential outcomes framework in Section 2.2 with binary treatment and no interference,
there are two potential outcomes defined for each unit: Yij (0) and Yij (1). Allowing for general
treatment interference entails considering 2n potential outcomes, each corresponding to a different combination of treatments received by all units. As a result, the estimands under interference are more complicated because they require considering treatment that could be applied to
multiple units. Therefore, defining the potential outcomes and estimands requires additional notation. We distinguish between the treatment applied to unit (i, j) in the observed dataset, Aij ,
and a hypothetical treatment that could be applied to unit (i, j), denoted aij . To describe potential outcomes under interference we denote the treatments that could be applied to all n units as
a = {aij ; i = 1, ..., N ; j = 1, ..., ni }, and the collection of the n − 1 treatments excluding aij as
a−ij . The potential outcome for each unit is then written as Yij (aij , a−ij ), where the first term is
the treatment received by unit (i, j) and the second term are the treatments received by other units.
22

The average treatment effect in (2) is insufficient in the presence of interference as it depends
only on the treatment assigned to unit (i, j). Rather, several treatment effects are needed to provide a comprehensive summary. Halloran and Struchiner (1991, 1995) and Hudgens and Halloran
(2008) describe four key estimands assuming binary treatments. The direct effect (DE) is
DEij (a−ij ) = E {Yij (1, a−ij ) − Yij (0, a−ij )} .

(18)

The direct effect compares the difference potential outcomes for unit (i, j) with treatments Aij = 1
versus Aij = 0 and holding all other treatments fixed at a−ij . Unlike (2), there is not a single direct
effect, as (18) may be different for each unit and for all 2n−1 combinations of a−ij . While the direct
effect isolates the local treatment effect, the indirect effect (IE) measures the contribution of other
treatments,

IEij (a−ij , a0−ij ) = E Yij (0, a−ij ) − Yij (0, a0−ij ) .

(19)

The indirect effect is also called the spillover effect because it compares the difference between
potential outcomes for two combinations of treatments for the other units, a−ij and a0−ij , to an
untreated unit with aij = 0 to quantify how much of the other treatment effects spill over to
observation (i, j). The direct and indirect effects can be combined using either the total (TE) or
overall effects(OE):

T Eij (a−ij , a0−ij ) = DEij (a−ij ) + IEij (a−ij , a0−ij ) = E Yij (1, a−ij ) − Yij (0, a0−ij )

OEij (a, a0 ) = E Yij (aij , a−ij ) − Yij (a0ij , a0−ij ) .
These effects are similar, except that the total effect always compares aij = 1 versus aij = 0
whereas the overall effect allows the local treatment to be the same for a and a0 .
If these effects can be estimated, then the user can interrogate the fitted model by selecting any
scenarios defined by a and a0 . For example, in the context of Example 1, the direct effect might be
computed by fixing the air pollution status of all other units a−ij at their current value to determine
the effect of a local action that changes the air pollution concentration in the mother’s zip code but
does not affect other zip codes. For the indirect effect we might fix all the treatment variables at
23

their observed values except set the air pollution variable for the zip codes neighboring a mother’s
zip code to one in a−ij versus zero in a0−ij to determine the impact of changing the air pollution in
zip codes where the mother spends some time outdoors. The sum of these two effects is the total
effect of changing the air pollution status of all zip codes in the mother’s home range (her zip code
and those the mother frequents). This total effect equals the overall effect of setting a = 1 for the
mother’s home range, a0 = 0 for the mother’s home range, and both a and a0 equal to the current
value for all other zip codes.
While measures such as DEij (a−ij ) are useful for understanding the implications of individual
actions on local outcomes, assessing the overall impact of the treatment requires averaging over
units and potential actions. Rather than weight all potential actions equally, they can be assigned
probabilities, Prob(a = ã) = ψ(ã). The probability mass function ψ is called the treatment policy.
For example, the policy-averaged expected counterfactual outcome under treatment aij = a for
unit (i, j) is
Ȳij (a, ψ) =

X

E{Yij (a, ã−ij )}Prob(a−ij = ã−ij |aij = a)

(20)

ã−ij
where the sum is over all 2n−1 possible values of a−ij and Prob(a−ij |aij = a) is determined by
the policy, ψ. The policy-averaged direct effect for unit (i, j) is then Ȳij (1, ψ) − Ȳij (0, ψ), and the
spatial average direct effect is
N

DE(ψ) =

n

i
1 XX
Ȳij (1, ψ) − Ȳij (0, ψ).
n i=1 j=1

(21)

Policy-averaged indirect, total and overall effects have similar forms.
In the context of the environmental epidemiology study described in Example 1, a simple policy
is to assume that the aij are independent over units with Prob(aij = 1) = p and compute (21) for
several values of p to understand the direct effect. A policy more tailored to anticipating short-term
effects of interventions in a given region is to assume that the aij are independent over units with
Prob(aij = 1) = pa if the current value of the treatment in unit (i, j) is Aij = a. Under this policy,
a zip code currently below the threshold is converted to exceed the threshold with probability p0 ,
and a zip code currently above the threshold is converted to below the threshold with probability
24

1 − p1 . The policy-averaged direct, indirect and total effects can be approximated via Monte Carlo
simulation for a range of p0 and p1 to evaluate the overall effects of a campaign to reduce air
pollution.
While these summaries are well defined for any potential outcome model, estimation is virtually impossible without simplifying assumptions. In the remainder of this section we discuss
several methods that exploit the spatial structure of the units to simplify the interference pattern.
These methods are summarized in Figure 5.

3.2

Partial interference

Partial interference, a term coined in Sobel (2006), or clustered interference, assumes that the units
can be partitioned into groups so that interference can occur only between observations in the same
group. In Example 1, partial interference might be evoked if it is reasonable to partition the zip
codes into cities, and that birth weight is dependent only on the air pollution concentration in the
mother’s city, and not air pollution in other cities. A further parametric assumption might be that
the potential outcome is a function only of the air pollution concentration in the mother’s zip code
and the proportion of her city’s zip codes that exceed the threshold excluding zipcode i, denoted
by ãi . A linear model with these assumptions is
Yij (aij , a−ij ) = aij β1 + ãij β2 + Xij γ + εij ,

(22)

where β1 and β2 entail the direct and indirect effects, respectively. This parametric model and
assumptions analogous to Assumptions 1, 3 and 4 that A is independent of all potential outcomes
given the n vectors Xij and that φ(a) > 0 for all a endows the parametric model
Yij = Aij β1 + Ãij β2 + Xij γ + εij

(23)

with a causal interpretation. Of course, this model relies on strong assumptions that are difficult to
verify, and thus a more flexible approach may be desirable.
There is an extensive literature that explores and expands on non-spatial partial interference
25

(Halloran and Struchiner, 1991, 1995; Halloran, 2012; Tchetgen and VanderWeele, 2012; VanderWeele et al., 2014; Liu et al., 2016; Barkley et al., 2017; Baird et al., 2018; Papadogeorgou et al.,
2019). Zigler et al. (2012) assume partial interference in a spatial analysis of the health effects of
environmental regulations, with clusters of sites defined by their attainment status. Perez-Heydrich
et al. (2014) and Zigler and Papadogeorgou (2018) assume partial interference for groups defined
by spatial proximity. Zigler and Papadogeorgou (2018) deal with additional complications that
arise when the spatial resolutions of the treatment and response differ.

3.3

Spatial network interference

With the rise of social network data, there is a fast-growing literature on network-based interference, where observations can interfere with each other along connected edges. These methods can
be applied to areal spatial data by viewing the regions as the network’s nodes and defining spatial
adjacency by the network’s edges (e.g., Verbitsky-Savitz and Raudenbush, 2012). For example, as
in the CAR model defined in Section 2.1, regions i and k can be defined as sharing an edge if they
share a common border. A simple example of a model to study spatial network interference for
Example 1 is (23) with Ãij redefined as the mean treatment variable across the mi neighbors of
region i.
More generally, Forastiere et al. (2016) propose a model that allows for interference between
an observation and its immediate neighbors, creating a local interference neighborhood around
each observation. Treatment effects are estimated by conditioning on propensity scores for the
direct and indirect treatment effects. Aronow et al. (2017) considers network data in a similar vein,
but loosens the restrictions on interference by defining an exposure mapping function. Tchetgen
et al. (2017) examine arbitrary network interference subject only to a local Markov property that
observations are conditionally independent after taking into account the nodes between them. This
gives both a reasonable constraint for estimation and also allows for treatment effects to propagate
through the network. In a further generalization of the spatial network interference assumption,
Giffin et al. (2020) use the distance between units themselves, rather than a network approximation,
to develop a generalized propensity score method to balance the spillover effect, Āi .

26

Figure 5: Variable dependencies under different forms of interference. Spatial location is
indicated horizontally. Indirect effects are shown as dashed lines, and confounding relationships
are shown as solid lines at a location and dotted lines across locations. A is the treatment, Y is the
outcome, and X is the observed confounder.
Y

Y

Y

Y

Y

Y

Y

Y

A

A

A

A

A

A

A

A

X

X

X

X

X

X

X

X

(a) No interference

(b) General interference

Y

Y

Y

Y

Y

Y

Y

Y

A

A

A

A

A

A

A

A

X

X

X

X

X

X

X

X

(c) Partial interference

(d) Spatial network interference

1

27

3.4

Process-based spillover models

Partial and network interference make assumptions that are conducive to a statistical analysis, such
as the simple spillover effect in (23), but are likely crude representations of reality. Mechanistic
methods that encode scientific understanding of the physical processes of interest offer increased
fidelity to the true interference structure. Mechanistic models are indispensable in environmental
attribution studies. For example, climate models play a central role in the Intergovernmental Panel
on Climate Change’s conclusion that human activities likely caused the majority of the observed
increase in global mean surface temperature from 1951 to 2010 (Bindoff et al., 2013). As reviewed
by Hegerl and Zwiers (2011), unlike purely statistical models that are limited to scenarios observed
in the data, mechanistic models can be run under counterfactual scenarios that have not, or could
not, be observed. This provides a key link to the potential outcomes framework in Section 3.1.
While mechanistic models can be used to estimate direct effects, they are more critical in
the presence of interference because they can rule out many of the massive number of potential
spillover paths, greatly reducing the complexity of the problem. Despite these strengths, mechanistic models are only approximations, and thus need to be calibrated and validated using observed
data. Most relevant for our purposes is the recent work that combines mechanistic modelling
with spatial statistical methods to estimate causal effects. For example, Larsen et al. (2020) fit
a Bayesian geostatistical model to observed air pollution concentrations and mechanistic model
output under scenarios with and without wildland fires to map the total causal effect of wildland
fires on fine particulate matter concentration and the resulting health burden. Rather than postprocessing model runs, Forastiere et al. (2020+) build a statistical model based on a dispersion
model to track air pollution from power plants in a causal analysis of health effects, and Cross
et al. (2019) embed an epidemiological model for disease spread in a hierarchical Bayesian model
to estimate spillover effects. These examples that highlight the important roles of mechanistic models not only likely provide more accurate estimates of causal effects, but also ensure the results are
tethered to scientific theory.

28

4

Spatiotemporal methods

Data collected over space and time are more informative about causal relationships than crosssectional data, because they afford the opportunity to observe variables coevolve. This reduces
the potential for spurious associations. For example, if a treatment is applied in the course of the
study, comparing a site’s responses before and after the treatment can control for missing spatial
confounding variables assuming they and their effects are time-invariant. This narrows the search
for potential confounding variables to those with a similar pattern as the treatments over both space
and time.
To describe spatiotemporal methods, we adopt new notation to accommodate the temporal
dimension. For simplicity, we assume areal spatial units, discrete time steps, and that each region
i ∈ {1, ..., N } has a single observation at each time step t ∈ {1, ..., T }. We denote the response,
treatment, known and unknown confounding variables as Yit , Ait , Xit and Uit , respectively. The
potential outcomes framework and assumptions in Section 2.2 apply with the time step t replacing
the replication number j. Similarly, many of the spatial methods in Section 2 such as matching
(Section 2.3), neighborhood adjustments (Section 2.4), propensity score methods (Section 2.5) and
the instrumental variable approach (Section 2.6) apply for spatiotemporal data by viewing time as
a third spatial dimension, with a different degree of correlation in this third dimension.

4.1

Testing for missing spatial confounders

Janes et al. (2007) propose a method to test for unmeasured spatial confounders using spatiotemporal data. Letting Āt denote the average of Ait at time t, their approach can be adapted to our
setting via the model
Yit = η1 Āt + η2 (Ait − Āt ) + Xit γ + εit

(24)

where Xit includes smooth functions of t to account for missing temporally-varying confounders.
In this model, η1 and η2 measure global and local effects of treatment, respectively, and they argue
that if the estimated values of η1 and η2 are equal and non-zero then this represents an average
causal effect of Ait on Yit , and that a large difference between the estimated η1 and η2 suggests

29

there may be a missing spatial confounder.

4.2

Difference in difference methods

Difference-in-difference (DID) estimators (Ashenfelter and Card, 1985) aim to quantify the treatment effect on the increase in the mean response over time. For simplicity we assume a binary treatment variable and two time steps (T = 2). If the treatment at the both time steps is ai1 = ai2 = a,
the increase in counterfactuals at site i is δi (a) = Yi2 (a) − Yi1 (a). Therefore, δi (0) is the increase
over time in the absence of treatment, and δi (1) − δi (0) is the increase that can be attributed to
treatment. The DID average treatment effect is then
"

δ DID

#
N
1 X
=E
{δi (1) − δi (0)} ,
N i=1

(25)

which is analogous to (2) except that the outcomes are changes over time. Assume the potential
outcomes follow the model Yit (a) = β1 a + β2 t + β3 ta + Xit γ + Uit + εit . Under Assumptions 1–4,
the observed outcome model follows the induced linear model
Yit = β1 Ait + β2 t + β3 tAit + Xit γ + Uit + εit .

(26)

Moreover, β3 = δ DID has a causal interpretation.
To render Assumptions 1–3 plausible, it is important to include information on a rich enough
set of time-varying confounders in Xit that affect both Ait and Yit . In the spatiotemporal settings,
the time-varying confounders Xit include the observed information on the past treatments and
outcomes.
Delgado and Florax (2015) extend the spatial DIDs by assuming Markov interference where
treatment effects only impact neighbors. This gives the model
Yit = β1 Ait + β2 t + β3 tAit + β4 Āit + β5 tĀit + Xit γ + Uit + εit

(27)

where Āit is the mean of Ait over the mi neighbors of region i at time step t. The neighborhood
30

coefficients β4 and β5 can be viewed either as indirect spillover effects or added terms to adjust for
local confounders to give more precise estimates of the direct causal effect, β3 .
Matched wake analysis combines the DID approach with a spatiotemporal analogue to coarsened exact matching (Schutte and Donnay, 2014). It was developed in the political science literature for studying responses to whether insurgent violence in Iraq causes civilians to help the US
military. In this scenario, insurgent violence leading to civilian casualties is the “treatment“ and
violence not resulting in casualties is the “control”. The response is the act of turning in salvaged
unexploded ordinance to the US military, so that it will not be used in an improvised explosive device. The data are divided into sliding spatiotemporal windows called “wakes” and matched. Then
a difference-in-differences approach is applied to the matched sample by counting the number of
explosives turned in before and after events. A drawback to this method is that in some cases the
sliding windows may overlap, which will violate SUTVA.

4.3

Granger causality

Granger causality is a fundamentally different concept than the potential outcomes framework. It
is defined by temporal relationships and not potential outcomes. In a time series analysis with
response Yt , treatment At , and all other relevant variables at time t, Xt , the treatment is said to
Granger cause the response if Var(Yt |Ht ) > Var(Yt |Ht , A1 , ..., At−1 ), where the history up to time
t is Ht = {Y1 , ..., Yt−1 , X1 , ..., Xt−1 }. In other words, Granger causality implies that given the
history of all other variables, knowledge of past treatments reduces predictive uncertainty. If a
P
linear lag L time series model is assumed, Yt = Ll=l (At−l βl + Xt−l γ l + Yt−l ρl ) + εt , then the
treatment is said to Granger cause the response if βl 6= 0 for any l ∈ {1, ..., L}.
Because this notion of causality is inherently defined for temporal data, extending these methods to the spatiotemporal case is straightforward. The simplest model is the linear no-interference
model
Yit =

L
X

{Ait−l βl + Xit−l γ l + Yit−l ρl } + Uit + εit ,

(28)

l=l

where Uit is correlated over space (e.g., following a CAR or SAR distribution) but independent

31

over time. It is also straightforward to include spillover effects by including spatial averages as
covariates, i.e., under a Markov interference assumption the mean of Ait−1 over region i’s mi
neighbors could be added as a covariate.
Granger causality and Rubin causality based on potential outcomes are fundamentally different.
Granger causality is defined in terms of predictive uncertainty, as might be useful to a passive observer of the system trying to maximize predictive power. In contrast, Rubin causality is defined in
terms of the effects of an active intervention, as might be performed by a scientist conducting a controlled experiment. Despite their different definitions and objectives, these two approaches share
similarities. White and Lu (2010) show that Granger causality is equivalent to Rubin causality for
times series data with no missing confounders and valid parametric assumptions. For example, the
model in (28) could be motivated by Granger causality or Rubin causality with Assumptions 1-4
and further assumptions (normality, linearity, etc) on the form of the potential outcomes model.
For further discussion of the similarities and differences between types of causality, see Holland
(1986) or Eichler (2012).

5

Methods for point-referenced data

Point-referenced, or geostatistical, data are not measurements of a region, but rather taken at a
specific point (latitude/longitude). Let si ∈ R2 be the spatial location corresponding to observation
i ∈ {1, ..., n}. The spatial regression model becomes
Yi = Ai β + Xi γ + U (si ) + εi

(29)
iid

where the unknown confounder U (s) is a spatial processes and εi ∼ Normal(0, τ 2 ). This notation
allows for replications at sites if, say si = sj , in which case observations i and j share the spatial
term U (si ) = U (sj ). The covariate vector Xi can include spatial covariates such as the elevation at
si and non-spatial covariates such as the time of day the measurement was taken.
Unlike an areal data analysis as in Section 2 where the number of potential sampling locations is
finite, a geostatistial analysis must consider an uncountable number of potential sampling locations
32

s ∈ D ⊂ R2 . We use the bold to denote a process over the entire spatial domain; e.g., U = {U (s) :
s ∈ D}. An unknown spatial process such as U is typically assumed to be a continuous function
of s over D and modeled as a Gaussian process with mean zero and isotropic covariance function
(i.e., a covariance that depends only on the distance between locations). Although other covariance
functions are available (Banerjee et al., 2014), the simplest choice is the exponential covariance
function Cov{U (si ), U (sj )} = σ 2 exp(−dij /ρ) where dij is the distance between si and sj . We
denote this Gaussian process model as U ∼ GP(ρ, σ).

5.1

Potential outcomes framework

In the most general form, the potential outcomes for observation i depend on the entire spatial
field of potential treatments, a = {a(s) : s ∈ D}. Therefore, we define the potential outcome for
observation i as Yi (a). In the context of Example 1, a(s) might be the air pollution concentration
at spatial location s, as opposed to the average concentration in a zip code. In this geostatistical
setting, a mother’s exposure to air pollution would integrate the concentration a(s) along the path
the mother travels. This could be estimated by a backpack the mother wears that continuously
measures her local air pollution concentration. Therefore, changing a(s) for any s in the spatial
domain could affect her potential outcome.
The potential outcomes framework simplifies dramatically under the no interference assumption. With a binary treatment, the two potential outcomes for unit i are Yi (0) if a(si ) = 0 and Yi (1)
if a(si ) = 1. In this simple case, the potential outcomes concepts, definitions and assumptions introduced in Section 2.2 directly apply to the geostatistical setting. Many of the methods developed
to adjust for missing spatial confounders described for areal data can also be applied. For example,
all of the propensity score methods in Section 2.5 and instrumental variables methods in Section
2.6 can be adapted for geostatistical data by replacing the CAR model for the missing spatial confounder with a Gaussian process model. Many of the other methods introduced for areal data can
also be modified for geostatistical applications, as described in the remainder of this section.

33

5.2

Matching methods

The matching methods described in Section 2.3 that pair observations from the same region can be
applied for geostatistical data with replications at spatial locations. Distance adjusted propensity
score matching (DAPSm) (Papadogeorgou et al., 2018) can be used when there are not replications. This method alters propensity score matching (Rosenbaum and Rubin, 1983a) by using a
standardized distance that combines the propensity score difference and geographic distance. The
logic is that if unmeasured spatial confounders exist, then observations that are close together will
have confounders that are the most alike. Similar to the neighborhood adjustment methods, this
method balances treatment and control by including geographic distances as a proxy for the unmeasured confounders in the matching process. The difference for a pair with Ai = 1 and Aj = 0
is defined as
Dij = w|êi − êj | + (1 − w)dij /m

(30)

where êi and êj are estimated propensity scores, m is the maximum distance between pairs of
locations in the study domain and w ∈ [0, 1] is a weight. The authors propose an algorithm to
select pairs with small Dij .

5.3

Regression discontinuity

Regression discontinuity designs are generally used when treatment assignment is determined by
whether the covariate value for a unit exceeds a threshold (Imbens and Lemieux, 2008; Bor et al.,
2014; Keele and Titiunik, 2015), e.g., students are admitted to a college if and only if their SAT
score exceeds a threshold. These cases provide a natural experiment if it can be assumed that
units slightly above and slightly below the threshold are similar in every way except the treatment
assignment, and thus the difference between these groups can be attributed to the causal effect of
the treatment. Natural experiments of this form often arise in environmental and epidemiological
studies where the variable being thresholded to determine treatment is the spatial location. In
the context of Example 1, the treatment might be whether a state is subject to an air pollution
regulation, and the objective is to determine if this affects health outcomes. Figure 6 shows a

34

Figure 6: Illustration of regression discontinuity. The treatment region A is the region above the
curve, the points are the sample locations si with samples with Ai = 1 filled and the background
color is the mean function A(s)β + U (s) were A(s) indicates that s = (s1 , s2 ) ∈ A.
●

●

●
● ●
●
●

●

●

●●

●
●

●●
●

●

●

●
●
●●

●

●

s2

●
●
● ●●
●
●
●

●
●

●
●

●

●
●● ●

● ●
●
● ●
●
●
●

●
●

●

●

0
●
●

●
●

●

●
●

●

● ●
●

●

●
●

●
●
●●

●●

●

2

●

●

●●

●

●●

4

●

●

● ●

●

●

●

●

●

●●

−4

●
●
● ●●
●

●

−2

●

s1

hypothetical example where treatment is applied to locations in the region s ∈ A ⊂ D. If it can
be assumed that all other factors are balanced across the border of A, then comparing observations
on either side of the border provides information about the causal effect of treatment. Under this
assumption, the causal effect can be estimated by simply fitting the geostatistical model in (29)
with Ai = 1 if si ∈ A and Ai = 0 otherwise.

5.4
5.4.1

Neighborhood adjustments
Stochastic partial differential equation modeling

Section 2.4 introduces the SAR model that defines the regression of the response onto the treatment
after subtracting the means across neighboring regions. The motivation for building a model on
the differences is to remove the effects of spatially-smooth confounding variables. The stochastic
partial differential equation (SPDE) models of Lindgren et al. (2011) can be viewed as an extension
of this idea to the continuous (geostatistical) spatial domain. In the SPDE framework, models are
specified on the partial derivatives of the response surface, which is a generalization of the SAR
35

model that can be applied to differentiable functions such as U. Lindgren et al. (2011) show that
this approach can be used to approximate Gaussian processes with the Matérn covariance function,
and develop approximations that resemble the SAR covariance model.

5.5

Spillover/interference methods

Defining interference for geostatistical applications requires returning to the general potential outcomes formulation in Section 5.1, where the potential outcome for observation i depends on the
entire field of treatments, a, and is denoted as Yi (a). Relating the spatial field a with the scalar
potential outcome requires assumptions about the form of interference. A general form of the
interference is
Yi (a) = a(si )β1 + āi β2 + Xi γ + Ui + εi
Z
w(si , s)a(s)ds,
āi =

(31)
(32)

D

where w is a weighting function that determines the spillover effect āi and β1 and β2 control the
direct and indirect effects, respectively. Given this potential outcome model, the four causal effects
(direct, indirect, total and overall) can be defined and interpreted as in Section 3.1 with a−i defined
as the surface a excluding a(si ), or perhaps excluding a for all sites within a small radius of si .
The form of spillover in (32) encompasses many common interference assumptions. For example, partial/cluster interference can be implemented by fixing w(si , s) = 0 if sites si and s are
in different groups. A structure resembling Markov/network interference assumes that w(si , s) =
1/(πr2 ) if s is within radius r of si and w(si , s) = 0 otherwise. This reduces the spillover measure
āi to the average treatment within radius r of si . If strict bounds on the range of interference cannot
be assumed, then the weight function could be a decreasing function of the distance from si , such
p
as the Gaussian kernel function with w(si , s) = exp {−0.5(||s − si ||/φ)2 } / 2πφ2 .
Even after reducing the complexity of the model by selecting a simple form for the weighting
function, computing the spatial integral in (32) is often impossible because the treatments are only
observed at a finite number of locations. One remedy is to use spatial interpolation (Kriging) to im-

36

pute the treatments onto a fine grid of locations covering the spatial domain and then approximate
the integrals as sums over the grid points. In this case, uncertainty about the estimated spillover
variables should be accounted for using Bayesian or multiple imputation methods.
Given a form of interference and the assumption of no missing confounders, estimation of
the direct and indirect effects can proceed with the usual spatial linear model. One approach to
accounting for missing spatial confounders is to include spatial propensity score models for both
the direct treatment Ai and the spillover effect Āi . The propensity score for Ai can be estimated as
in the areal case with say a spatial logistic regression to give ê(si ).

6

Summary and future work

The field of spatial causal inference has seen impressive advances in recent years. There are now
methods to address the fundamental problems including accounting for missing spatial confounding variables and modeling spatial interference. However, there are many opportunities for future
work that we discuss below, including combining data types, relaxing model assumptions, going
beyond mean estimation, and using causal estimates for decision making.
We have discussed methods for areal data (Section 2) and point-referenced/geostatistical data
(Section 5) separately, but many analyses require utilizing both types of data. For example, treatments may be defined at point locations (e.g., air pollution concentration) while the response variable is defined regionally (e.g., hospital admission rate by zip code). In spatial statistics this is
referred to as the change of support problem (Gotway and Young, 2002; Gelfand et al., 2010). One
approach to combining data with different supports is to conceptualize the areal data as an aggregation of a continuous latent process and then specify geostatistical models such as those presented
in Section 5 on the latent process. Extending these methods to the causal inference would require carefully specifying the causal estimand and devising computationally-efficient methods for
estimation. Zigler and Papadogeorgou (2018) may provide a template for this work.
Change of support issues also arise when the treatment is a point source, such as an oil spill,
power plant or wildland fire. The effect of point source treatment variables can be direct, but
their most prominent causal effects will likely be the spillover effects (Section 3) felt by nearby
37

locations. The spillover effects can be modelled as a function of the distance from the response
location to the point source or mechanistically using a mathematical dispersion model (Section
3.4). These methods can also be extended to the spatiotemporal setting using spillover effects that
decay in space and time (e.g., Kim et al., 2018, 2019). Inferential methods that rely on modeling the
treatment variables (e.g., propensity scores) could apply a spatial point pattern analysis (Baddeley
et al., 2015), such as an inhomogeneous Poisson process model, to estimate the treatment intensity.
It may also be possible to leverage work on informative sampling (Diggle et al., 2010; Pati et al.,
2011) that uses a joint model for the sampling locations and the responses to reduce the effects of
systematic bias in the sampling design.
Most of the methods discussed in this review rely on strong parametric assumptions such as
linearity and normality. Parametric methods dominate spatial statistics because in the canonical
problem with one observation at each spatial location there is insufficient data to relax these assumptions. In contrast, most causal inference methods aim to be robust to model misspecification.
There is a body of work on nonparametric spatial methods (Gelfand et al., 2010; Reich and Fuentes,
2015) that might be used to relax the parametric assumptions in spatial causal inference, but these
ideas have yet to be applied in this context.
We focused only on the average treatment effect, and future work is to extend spatial causal
inference to other types of treatment effects. For example, extreme events are often the most
impactful in environmental studies, and thus it would be of great interest to extend causal inference
ideas to spatial quantile regression (e.g., Reich et al., 2011; Reich, 2012; Lum et al., 2012) or
extreme value analysis (e.g., Davison and Huser, 2019). Another simplification made throughout
the review is that the confounder and treatment effects are the same throughout the spatial domain.
A more general approach is a locally-adaptive model with spatially-varying coefficients (Gelfand
et al., 2003), which would be a spatial application of conditional treatment effects.
Ultimately, causal effect estimates can be used to influence decision making. An area of future
work is to use these estimates to derive individualized/localized treatment rules. This is complicated in the spatial case by interference between regions that require considering simultaneously
assigning the treatments to all regions to achieve optimality. Laber et al. (2018) and Guan et al.

38

(2020) propose a policy-search method for optimal treatment allocation for spatiotemporal problems, but a general theory awaits development.

Acknowledgements
This work was partially supported by the National Institutes of Health (R01ES031651-01,R01ES02789201) and King Abdullah University of Science and Technology (3800.2). The research described
in this article has been reviewed by the Center for Public Health and Environmental Assessment,
U.S. Environmental Protection Agency and approved for publication. Approval does not signify
that the contents necessarily reflect the views and the policies of the Agency, nor does mention
of trade names of commercial products constitute endorsement or recommendation for use. The
authors declare that they have no conflict of interest.

References
Abadie, A. and Imbens, G. W. (2006) Large sample properties of matching estimators for average
treatment effects. Econometrica, 74, 235–267.
— (2016) Matching on the estimated propensity score. Econometrica, 84, 781–807.
Aronow, P. M., Samii, C. et al. (2017) Estimating average causal effects under general interference,
with application to a social network experiment. The Annals of Applied Statistics, 11, 1912–
1947.
Ashenfelter, O. and Card, D. (1985) Using the longitudinal structure of earnings to estimate the
effect of training programs. The Review of Economics and Statistics, 67, 648–660.
Baddeley, A., Rubak, E. and Turner, R. (2015) Spatial point patterns: methodology and applications with R. Chapman and Hall/CRC.
Baird, S., Bohren, J. A., McIntosh, C. and Özler, B. (2018) Optimal design of experiments in the
presence of interference. Review of Economics and Statistics, 100, 844–860.
Banerjee, S., Carlin, B. P. and Gelfand, A. E. (2014) Hierarchical modeling and analysis for spatial
data. Chapman and Hall/CRC.
Bang, H. and Robins, J. M. (2005) Doubly robust estimation in missing data and causal inference
models. Biometrics, 61, 962–973.
39

Barkley, B. G., Hudgens, M. G., Clemens, J. D., Ali, M. and Emch, M. E. (2017) Causal inference
from observational studies with clustered interference. arXiv preprint arXiv:1711.04834.
Bind, M.-A. (2019) Causal modeling in environmental health. Annual Review of Public Health,
40, 23–43.
Bindoff, N. L., Stott, P. A., AchutaRao, K. M., Allen, M. R., Gillett, N., Gutzler, D., Hansingo,
K., Hegerl, G., Hu, Y., Jain, S. et al. (2013) Detection and attribution of climate change: From
global to regional. Cambridge University Press.
Bor, J., Moscoe, E., Mutevedzi, P., Newell, M.-L. and Bärnighausen, T. (2014) Regression discontinuity designs in epidemiology: causal inference without randomized trials. Epidemiology
(Cambridge, Mass.), 25, 729.
Cao, W., Tsiatis, A. A. and Davidian, M. (2009) Improving efficiency and robustness of the doubly
robust estimator for a population mean with incomplete data. Biometrika, 96, 723–734.
Cox, D. R. (1958) Planning of Experiments. Wiley.
Cross, P. C., Prosser, D. J., Ramey, A. M., Hanks, E. M. and Pepin, K. M. (2019) Confronting
models with data: The challenges of estimating disease spillover. Philosophical Transactions of
the Royal Society B, 374, 20180435.
Davis, M. L., Neelon, B., Nietert, P. J., Hunt, K. J., Burgette, L. F., Lawson, A. B. and Egede, L. E.
(2019) Addressing geographic confounding through spatial propensity scores: A study of racial
disparities in diabetes. Statistical Methods in Medical Research, 28, 734–748.
Davison, A. C. and Huser, R. (2019) Spatial extremes. CRC Press.
Delgado, M. S. and Florax, R. J. (2015) Difference-in-differences techniques for spatial data: Local
autocorrelation and spatial interaction. Economics Letters, 137, 123–126.
Diggle, P. J., Menezes, R. and Su, T.-l. (2010) Geostatistical inference under preferential sampling.
Journal of the Royal Statistical Society: Series C (Applied Statistics), 59, 191–232.
Eichler, M. (2012) Causal inference in time series analysis. In Causality: Statistical Perspectives
and Applications (ed. L. B. Carlo Berzuini, Philip Dawid), chap. 22, 326–354. Wiley Online
Library, 1 edn.
Forastiere, L., Airoldi, E. M. and Mealli, F. (2016) Identification and estimation of treatment and
interference effects in observational studies on networks. arXiv preprint arXiv:1609.06245.
Forastiere, L., Mealli, F. and Zigler, C. (2020+) Bipartite interference and air pollution transport:
Estimating health effects of power plant interventions. Submitted.
Gelfand, A. E., Diggle, P., Guttorp, P. and Fuentes, M. (2010) Handbook of Spatial Statistics. CRC
Press.
40

Gelfand, A. E., Kim, H.-J., Sirmans, C. and Banerjee, S. (2003) Spatial modeling with spatially
varying coefficient processes. Journal of the American Statistical Association, 98, 387–396.
Giffin, A., Reich, B. J., Yang, S. and Rappold, A. G. (2020) Generalized propensity score approach
to causal inference with spatial interference. arXiv preprint arXiv:2007.00106.
Gotway, C. A. and Young, L. J. (2002) Combining incompatible spatial data. Journal of the
American Statistical Association, 97, 632–648.
Granger, C. W. (1969) Investigating causal relations by econometric models and cross-spectral
methods. Econometrica: Journal of the Econometric Society, 424–438.
Guan, Q., Reich, B. J. and Laber, E. B. (2020) A spatiotemporal recommendation engine for
malaria control. arXiv preprint arXiv:2003.05084.
Halloran, M. E. (2012) The minicommunity design to assess indirect effects of vaccination. Epidemiologic methods, 1, 83–105.
Halloran, M. E. and Struchiner, C. J. (1991) Study designs for dependent happenings. Epidemiology, 2, 331–338.
— (1995) Causal inference in infectious diseases. Epidemiology, 6, 142–151.
Hanks, E. M., Schliep, E. M., Hooten, M. B. and Hoeting, J. A. (2015) Restricted spatial regression
in practice: geostatistical models, confounding, and robustness under model misspecification.
Environmetrics, 26, 243–254.
Hansen, B. B. (2004) Full matching in an observational study of coaching for the sat. Journal of
the American Statistical Association, 99, 609–618.
He, Z. (2018) Inverse conditional probability weighting with clustered data in causal inference.
arXiv preprint arXiv:1808.01647.
Heckman, J. J., Ichimura, H. and Todd, P. E. (1997) Matching as an econometric evaluation estimator: Evidence from evaluating a job training programme. Rev. Econ. Stud., 64, 605–654.
Hegerl, G. and Zwiers, F. (2011) Use of models in detection and attribution of climate change.
Wiley interdisciplinary reviews: climate change, 2, 570–591.
Hernn, M. A. and Robins, J. M. (2020) Causal inference: What if. Boca Raton: Chapman &
Hall/CRC.
Hirano, K. and Imbens, G. W. (2004) The propensity score with continuous treatments. Applied
Bayesian modeling and causal inference from incomplete-data perspectives, 22, 73–84.
Hirano, K., Imbens, G. W. and Ridder, G. (2003) Efficient estimation of average treatment effects
using the estimated propensity score. Econometrica, 71, 1161–1189.
41

Hodges, J. S. and Reich, B. J. (2010) Adding spatially-correlated errors can mess up the fixed
effect you love. The American Statistician, 64, 325–334.
Holland, P. W. (1986) Statistics and causal inference. Journal of the American Statistical Association, 81, 945–960.
Hudgens, M. G. and Halloran, M. E. (2008) Toward causal inference with interference. Journal of
the American Statistical Association, 103, 832–842.
Hughes, J. and Haran, M. (2013) Dimension reduction and alleviation of confounding for spatial
generalized linear mixed models. Journal of the Royal Statistical Society: Series B (Statistical
Methodology), 75, 139–159.
Imbens, G. W. and Angrist, J. D. (1994) Identification and estimation of local average treatment
effects. Econometrica, 62, 467–475.
Imbens, G. W. and Lemieux, T. (2008) Regression discontinuity designs: A guide to practice.
Journal of Econometrics, 142, 615–635.
Janes, H., Dominici, F. and Zeger, S. L. (2007) Trends in air pollution and mortality: an approach
to the assessment of unmeasured confounding. Epidemiology, 416–423.
Jarner, M. F., Diggle, P. and Chetwynd, A. G. (2002) Estimation of spatial variation in risk using
matched case-control data. Biometrical Journal: Journal of Mathematical Methods in Biosciences, 44, 936–945.
Keele, L. J. and Titiunik, R. (2015) Geographic boundaries as regression discontinuities. Political
Analysis, 23, 127–155.
Kim, M., Paini, D. and Jurdak, R. (2018) Causal inference in disease spread across a heterogeneous
social system. arXiv preprint arXiv:1801.08133.
— (2019) Modeling stochastic processes in disease spread across a heterogeneous social system.
Proceedings of the National Academy of Sciences, 116, 401–406.
Laber, E. B., Meyer, N. J., Reich, B. J., Pacifici, K., Collazo, J. A. and Drake, J. M. (2018) Optimal
treatment allocations in space and time for on-line control of an emerging infectious disease.
Journal of the Royal Statistical Society: Series C (Applied Statistics), 67, 743–789.
Larsen, A., Yang, S., Reich, B. J. and Rappold, A. G. (2020) A spatial causal analysis of wildland
fire-contributed PM2.5 using numerical model output. arXiv preprint arXiv:2003.06037.
Lindgren, F., Rue, H. and Lindström, J. (2011) An explicit link between Gaussian fields and Gaussian Markov random fields: The stochastic partial differential equation approach. Journal of the
Royal Statistical Society: Series B (Statistical Methodology), 73, 423–498.
Liu, L., Hudgens, M. G. and Becker-Dreps, S. (2016) On inverse probability-weighted estimators
in the presence of interference. Biometrika, 103, 829–842.
42

Lum, K., Gelfand, A. E. et al. (2012) Spatial quantile multiple regression using the asymmetric
laplace process. Bayesian Analysis, 7, 235–258.
Lunn, D., Best, N., Spiegelhalter, D., Graham, G. and Neuenschwander, B. (2009) Combining
MCMC with sequentialPKPD modelling. Journal of Pharmacokinetics and Pharmacodynamics,
36, 19.
McCandless, L. C., Douglas, I. J., Evans, S. J. and Smeeth, L. (2010) Cutting feedback in Bayesian
regression adjustment for the propensity score. The International Journal of Biostatistics, 6.
Paciorek, C. J. (2010) The importance of scale for spatial-confounding bias and precision of spatial
regression estimators. Statistical Science, 25, 107–125.
Papadogeorgou, G., Choirat, C. and Zigler, C. M. (2018) Adjusting for unmeasured spatial confounding with distance adjusted propensity score matching. Biostatistics, 20, 256–272.
Papadogeorgou, G., Mealli, F. and Zigler, C. M. (2019) Causal inference with interfering units for
cluster and population level treatment allocation programs. Biometrics, 75, 778–787.
Pati, D., Reich, B. J. and Dunson, D. B. (2011) Bayesian geostatistical modelling with informative
sampling locations. Biometrika, 98, 35–48.
Perez-Heydrich, C., Hudgens, M. G., Halloran, M. E., Clemens, J. D., Ali, M. and Emch, M. E.
(2014) Assessing effects of cholera vaccination in the presence of interference. Biometrics, 70,
731–741.
Reich, B. J. (2012) Spatiotemporal quantile regression for detecting distributional changes in environmental processes. Journal of the Royal Statistical Society: Series C (Applied Statistics), 61,
535–553.
Reich, B. J. and Fuentes, M. (2015) Spatial Bayesian nonparametric methods. In Nonparametric
Bayesian Inference in Biostatistics, 347–357. Springer.
Reich, B. J., Fuentes, M. and Dunson, D. B. (2011) Bayesian spatial quantile regression. Journal
of the American Statistical Association, 106, 6–20.
Reich, B. J., Hodges, J. S. and Carlin, B. P. (2007) Spatial analyses of periodontal data using
conditionally autoregressive priors having two classes of neighbor relations. Journal of the
American Statistical Association, 102, 44–55.
Reich, B. J., Hodges, J. S. and Zadnik, V. (2006) Effects of residual smoothing on the posterior of
the fixed effects in disease-mapping models. Biometrics, 62, 1197–1206.
Robins, J. M. and Greenland, S. (1994) Adjusting for differential rates of prophylaxis therapy for
PCP in high-versus low-dose AZT treatment arms in an AIDS randomized trial. Journal of the
American Statistical Association, 89, 737–749.

43

Robins, J. M., Rotnitzky, A. and Zhao, L. P. (1994) Estimation of regression coefficients when
some regressors are not always observed. Journal of the American Statistical Association, 89,
846–866.
Rosenbaum, P. R. (1989) Optimal matching for observational studies. Journal of the American
Statistical Association, 84, 1024–1032.
Rosenbaum, P. R. and Rubin, D. B. (1983) Assessing sensitivity to an unobserved binary covariate
in an observational study with binary outcome. J. R. Stat. Soc. Ser. B., 45, 212–218.
— (1983a) The central role of the propensity score in observational studies for causal effects.
Biometrika, 70, 41–55.
Rubin, D. B. (1974) Estimating causal effects of treatments in randomized and nonrandomized
studies. J Educational Psychology, 66, 688–701.
— (1978) Bayesian inference for causal effects: The role of randomization. Ann. Statist., 6, 34–58.
— (2006) Matched Sampling for Causal Effects. Cambridge, England: Cambridge University
Press.
Saarela, O., Belzile, L. R. and Stephens, D. A. (2016) A Bayesian view of doubly robust causal
inference. Biometrika, 103, 667–681.
Saarela, O., Stephens, D. A., Moodie, E. E. and Klein, M. B. (2015) On Bayesian estimation of
marginal structural models. Biometrics, 71, 279–288.
Schnell, P. and Papadogeorgou, G. (2019) Mitigating unobserved spatial confounding bias with
mixed models. arXiv preprint arXiv:1907.12150.
Schutte, S. and Donnay, K. (2014) Matched wake analysis: finding causal relationships in spatiotemporal event data. Political Geography, 41, 1–10.
Sobel, M. E. (2006) What do randomized studies of housing mobility demonstrate? causal inference in the face of interference. Journal of the American Statistical Association, 101, 1398–
1407.
Stuart, E. A. (2010) Matching methods for causal inference: A review and a look forward. Statistical Science, 25, 1–21.
Tchetgen, E. J. T., Fulcher, I. and Shpitser, I. (2017) Auto-g-computation of causal effects on a
network. arXiv preprint arXiv:1709.01577.
Tchetgen, E. J. T. and VanderWeele, T. J. (2012) On causal inference in the presence of interference. Statistical Methods in Medical Research, 21, 55–75.
Thaden, H. and Kneib, T. (2018) Structural equation models for dealing with spatial confounding.
The American Statistician, 72, 239–252.
44

VanderWeele, T. J., Tchetgen, E. J. T. and Halloran, M. E. (2014) Interference and sensitivity
analysis. Statistical science: A Review Journal of the Institute of Mathematical Statistics, 29,
687.
Verbitsky-Savitz, N. and Raudenbush, S. W. (2012) Causal inference under interference in spatial settings: A case study evaluating community policing program in Chicago. Epidemiologic
Methods, 1, 107–130.
Wall, M. M. (2004) A close look at the spatial structure implied by the CAR and SAR models.
Journal of Statistical Planning and Inference, 121, 311–324.
White, H. and Lu, X. (2010) Granger causality and dynamic structural systems. Journal of Financial Econometrics, 8, 193–243.
Wu, X., Nethery, R. C., Sabath, B. M., Braun, D. and Dominici, F. (2020) Exposure to air pollution
and COVID-19 mortality in the United States. medRxiv.
Zigler, C. M. (2016) The central role of Bayes Theorem for joint estimation of causal effects and
propensity scores. The American Statistician, 70, 47–54.
Zigler, C. M., Dominici, F. and Wang, Y. (2012) Estimating causal effects of air quality regulations using principal stratification for spatially correlated multivariate intermediate outcomes.
Biostatistics, 13, 289–302.
Zigler, C. M. and Papadogeorgou, G. (2018) Bipartite causal inference with interference. arXiv
preprint arXiv:1807.08660.
Zigler, C. M., Watts, K., Yeh, R. W., Wang, Y., Coull, B. A. and Dominici, F. (2013) Model
feedback in Bayesian propensity score estimation. Biometrics, 69, 263–273.

Appendix A.1
Consider the true data-generating model Y|A, U ∼ Normal(βA+U, τ 2 In ), U|A ∼ Normal(φA, Σ1 )
and A ∼ Normal(0, Σ2 ). In this model the treatment variable and spatial process are correlated
unless φ = 0. If the assumed model is Y|A, U ∼ Normal(βA+U, τ 2 In ) and U|A ∼ Normal(0, Ω),
or equivalently Y|A ∼ Normal(βA, Σ) where Σ = τ 2 In + Ω, then the generalized least squares
(and posterior mean under flat prior) estimator is β̂(A, Y) = (AT Σ−1 A)−1 AT Σ−1 Y. The expected
value of this estimator under the true data-generating model is β + φ for any assumed covariance
model Σ, including the model that excludes U by setting Ω = 0.
45

Appendix A.2: CAR and SAR covariance models
In Section 2, we define the CAR and SAR models for individual observations, and in this section we
provide the induced joint distribution of the spatial process at all N locations. If U ∼ CAR(ρ, σ)
then the joint distribution of U defined by the full conditional distributions given in Section 2.1 is
multivariate normal with mean zero and covariance ΣCAR (ρ, σ) = σ 2 (M − ρW)−1 , where M is
diagonal with the ith diagonal element mi (the number of regions neighboring region i) and W has
(i, k) element equal one if regions i and k are adjacent and zero otherwise.
Similarly, the SAR model in (5) can be solved for Y = (Y1 , ..., YN )T to show that the induced
joint distribution is
Y = Aβ + Xγ + ε

where


ε ∼ Normal 0, σ 2 (IN − ψC)−1 (IN − ψC)−1

(33)

with the (i, k) element of C is 1/mi if regions i and k are adjacent and 0 otherwise, so that, e.g.,
CY = (Ȳ1 , ..., ȲN )T is the vector of neighborhood means.

Appendix A.3: Details of Schnell and Papadogeorgou (2019)
Schnell and Papadogeorgou (2019) provided a set of assumptions to identify the unmeasured confounding bias E(Ui |A). They assume a joint distribution for (U, A) that is multivariate normal with
mean zero and covariance

  
−1
U
QU QU A
 ,
Cov   = 
A
QTU A QA

where Qj = σj−2 (M−ρj W) for j ∈ {U, A} and QU A = −ρσU σA M. Two assumptions are encoded
in QU A : (1) a cross-Markov relationship such that conditional on all other locations treatments A−i ,
the local treatment Ai is only correlated with the local confounder Ui (e.g., Reich et al., 2007),
and (2) the conditional correlation between Ai and Ui is constant in space. The confounding
bias B(A) = E(U|A) = −Q−1
U QU A A is mitigated by fitting a spatial model with confounder

46

adjustment,

2
Y = Aβ − B(A) + Xγ + e where e ∼ Normal 0, Q−1
U + τ IN
h
i

−1
2
2 T
−1
A ∼ Normal 0, σA (M − ρA W) − ρ M (M − ρU W) M
.

47

