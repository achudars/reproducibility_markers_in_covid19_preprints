Epidemiological Forecasting with Model Reduction of
Compartmental Models.
Application to the COVID-19 pandemic.
Athmane Bakhta, Thomas Boiveau, Yvon Maday, Olga Mula

arXiv:2009.09200v3 [stat.ME] 10 Dec 2020

Abstract
We propose a forecasting method for predicting epidemiological health series on a twoweek horizon at the regional and interregional resolution. The approach is based on model
order reduction of parametric compartmental models, and is designed to accommodate small
amount of sanitary data. The efficiency of the method is shown in the case of the prediction
of the number of infected and removed people during the two pandemic waves of COVID-19
in France, which have taken place approximately between February and November 2020.
Numerical results illustrate the promising potential of the approach.

1

Introduction

Providing reliable epidemiological forecasts during an ongoing pandemic is crucial to mitigate
the potentially disastrous consequences on global public health and economy. As the ongoing
pandemic on COVID-19 sadly illustrates, this is a daunting task in the case of new diseases
due to the incomplete knowledge of the behavior of the disease, and the heterogeneities and
uncertainties in the health data count. Despite these difficulties, many forecasting strategies exist
and we could cast them into two main categories. The first one is purely data-based, and involves
statistical and learning methods such as time series analysis, multivariate linear regression, grey
forecasting or neural networks [7, 1, 11, 28, 19]. The second approach uses epidemiological
models which are appealing since they provide an interpretable insight of the mechanisms of the
outbreak. They also provide high flexibility in the level of detail to describe the evolution of
the pandemic, ranging from simple compartmental models that divide the population into a few
exclusive categories, to highly detailed descriptions involving numerous compartments or even
agent-based models (see, e.g., [16, 23, 6] for general references on mathematical epidemiological
models and [22, 10, 13] for some models focused on Covid-19). One salient drawback of using
epidemiological models for forecasting purposes lies in the very high uncertainty in the estimation
of the involved parameters. This is due to the fact that most of the time the parameters cannot
be inferred from real observations and the available data are insufficient or too noisy to provide
any reliable estimation. The situation is aggravated by the fact that the number of parameters
can quickly become large even in moderately simple compartmental models [10]. As a result,
forecasting with these models involves making numerous a priori hypothesis which can sometimes
be hardly justified by data observations.
In this paper, our goal is to forecast the time-series of infected, removed and dead patients
with compartmental models that involve as few parameters as possible in order to infer them
solely from the data. The available data are only given for hospitalized people, one can nevertheless estimate the total number of infected people through an adjustment factor hinted from
the literature. Such a factor takes into account the proportion of asymptomatic people and
1

infected people who do not go to hospital. The model involving the least number of parameters
is probably the SIR model [17] which is based on a partition of the population into:
• Uninfected people, called susceptible (S),
• Infected and contagious people (I), with more or less marked symptoms,
• People removed (R) from the infectious process, either because they are cured or unfortunately died after being infected.
If N denotes the total population size that we assume to be constant over a certain time interval
[0, T ], we have
N = S(t) + I(t) + R(t), ∀t ∈ [0, T ],
and the evolution from S to I and from I to R is given for all t ∈ [0, T ] by
dS
βI(t)S(t)
(t) = −
dt
N
dI
βI(t)S(t)
(t) =
− γI(t)
dt
N
dR
(t) = γI(t).
dt
The SIR model has only two parameters:
• γ > 0 represents the recovery rate. In other words, its inverse γ −1 can be interpreted as
the length (in days) of the contagious period.
• β > 0 is the transmission rate of the disease. It essentially depends on two factors: the
contagiousness of the disease and the contact rate within the population. The larger this
second parameter is, the faster the transition from susceptible to infectious will be. As
a consequence, the number of hospitalized patients may increase very fast, and may lead
to a collapse of the health system [2]. Strong distancing measures like confinement can
effectively act on this parameter [29, 12], helping to keep it low.
Our forecasting strategy is motivated by the following observation: by allowing the parameters
β and γ to be time-dependent, we can find optimal coefficients β ∗ (t) and γ ∗ (t) that exactly fit
any series of infected and removed patients. In other words, we can perfectly fit any observed
health series with a SIR model having time-dependent coefficients.
As we explain later on in the paper, the high fitting power stems from the fact that the
parameters β and γ are searched in L∞ ([0, T ], R+ ), the space of essentially bounded measurable
functions. For our forecasting purposes, this space is however too large to give any predictive
power and we need to find a smaller manifold that has simultaneously good fitting and forecasting
properties. To this aim, we develop a method based on model order reduction. The idea is to find
a space of reduced dimension that can host the dynamics of the current epidemic. This reduced
space is learnt from a series of detailed compartmental models based on precise underlying
mechanisms of the disease. One major difficulty in these models is to fit the correct parameters.
In our approach, we do not seek to estimate them. Instead, we consider a large range of possible
parameter configurations with a uniform sampling that allows us to simulate virtual epidemic
scenarios on a longer range than the fitting window [0, T ]. We next cast each virtual epidemics
from the family of detailed compartmental models into the family of SIR models with timedependent coefficients in a sense that we explain later on. This procedure yields time-dependent
parameters β and γ for each detailed virtual epidemics. The set of all such β (resp. γ) is then
2

condensed into a reduced basis of small dimension. We finally use the available health data on
the time window [0, T ] to find the functions β and γ from the reduced space that fit at best the
current epidemics over [0, T ]. Since the reduced basis functions are defined over a longer time
range [0, T + τ ] with τ > 0 (say, e.g., two weeks), the strategy automatically provides forecasts
from T to T + τ . Its accuracy will be related to the pertinence of the mechanistic mathematical
models that have been used in the learning process.
We note that an important feature of our approach is that all virtual simulations are considered equally important on a first stage and the procedure automatically learns what are the
best scenarios (or linear combinations of scenarios) to describe the available data. Moreover, the
approach even mixes different compartmental models to accommodate these available data. This
is in contrast to other existing approaches which introduce a strong a priori belief on the quality
of a certain particular model. Note also that we can add models related to other illness, and use
the large manifold to fit a possible new epidemic. It is also possible to mix the current approach
with other purely statistical or learning strategies by means of expert aggregration. One salient
difference with these approaches which is important to emphasize is that our method hinges
on highly detailed compartmental models which have clear epidemiological interpretations. Our
collapsing methodology into the time-dependent SIR is a way of “summarizing” the dynamics
into a few terms. One may expect that reducing the number of parameters comes at the cost
of losing interpretability of parameters, and this is in general true. Nevertheless, the numerical
results of the present work show that a reasonable tradeoff between "reduction of the number
of parameters" and "interpretability of these few parameters" can be achieved.
The paper is organized as follows. In Section 2, we present the forecasting method in the case
of one single region with constant population. For this, we briefly introduce in Section 2.1 the
epidemiological models involved in the procedure, namely the SIR model with time-dependent
coefficients and more detailed compartmental models used for the training step. In Section 2.2,
after proving that SIR models with time-dependent coefficients in L∞ ([0, T ]) is able to fit any
admissible epidemiological evolution (in a sense that will be made rigorous), we present the main
steps of the forecasting method. The method involves a collapsing step from detailed models to
SIR models with time-dependent coefficients, and model reduction techniques. We detail these
points in Sections 2.3 and 2.4. In Section 3 we explain how the method can easily be extended
to a multi-regional context involving population mobility, and regional health data observations
(provided, of course, that mobility data is available). We start in Section 3.1 by clarifying that
the nature of the mobility data will dictate the kind of multi-regional SIR model to use in this
context. In Section 3.2 we outline how to adapt the main steps of the method to the multiregional case. Finally, in Section 4, we present numerical results for the the two pandemic waves
of COVID-19 in France in year 2020, which have taken place approximately between February
and November 2020. Concluding comments are given in Section 5 followed by two appendices
A and B that present details about the processing of the data noise, and the forecasting error.

2

Methodology for one single region

For the sake of clarity, we first consider the case of one single region with constant population
and no population fluxes with other regions. Here, the term region is generic and may be applied
to very different geographical scales, ranging from a full country, to a department within the
country, or even smaller partitions of a territory.
3

2.1

Compartmental models

The final output of our method is a mono-regional SIR model with time dependent coefficients as
exposed below. This SIR model with time-dependent coefficients will be evaluated with reduced
modeling techniques involving a large family of models with finer compartments proposed in the
literature. Before presenting the method in the next section, we introduce here all the models
that we use in this paper along with useful notations for the rest of the paper.

SIR models with time-dependent parameters: We will fit and forecast the series of
infected and removed patients (dead and recovered) with SIR models where the coefficients β
and γ are time-dependent:

dS
β(t)I(t)S(t)
(t) = −
dt
N
dI
β(t)I(t)S(t)
(t) =
− γ(t)I(t)
dt
N
dR
(t) = γ(t)I(t).
dt

In the following, we use bold-faced letters for past-time quantities. For example, f := {f (t) : 0 ≤
t ≤ T } for any function f ∈ L∞ ([0, T ]). Using this notation, for any given β and γ ∈ L∞ ([0, T ])
we denote by
(S, I, R) = SIR(β, γ, [0, T ])

the solution of the associated SIR dynamics in [0, T ].

Detailed compartmental models: Models involving many compartments offer a detailed
description of epidemiological mechanisms at the expense of involving many parameters. In
our approach, we use them to generate virtual scenarios. One of the initial motivations behind
the present work is to provide forecasts for the COVID-19 pandemic, thus we have selected the
two following models which are specific for this disease, but note that any other compartmental
model [18, 10, 22] or agent-based simulation could also be used .

• First model, SEI5CHRD: This model is inspired from the one proposed in [10]. It involves
11 different compartments and a set of 19 parameters. The dynamics of the model is
4

Ia

Ips
S

E

Ip

R
Ims
H
Iss

C

D

Figure 1: SEI5CHRD model
illustrated in Figure 1 and the system of equations reads
dS
1
(t) = − S(t) (βp Ip (t) + βa Ia (t) + βps Ips (t) + βms Ims (t) + βss Iss (t) + βH H(t) + βC C(t))
dt
N
dE
1
(t) = S(t) (βp Ip (t) + βa Ia (t) + βps Ips (t) + βms Ims (t) + βss Iss (t) + βH H(t) + βC C(t)) − εE(t)
dt
N
dIp
(t) = εE(t) − µp Ip (t)
dt
dIa
(t) = pa µp Ip (t) − µIa (t)
dt
dIps
(t) = pps (1 − pa )µp Ip (t) − µIps (t)
dt
dIms
(t) = pms (1 − pa )µp Ip (t) − µIms (t)
dt
dIss
(t) = pss (1 − pa )µp Ip (t) − µIss (t)
dt
dC
(t) = pc µIss (t) − (λC,R + λC,D )C(t)
dt
dH
(t) = (1 − pc )µIss (t) − (λH,R + λH,D )H(t)
dt
dR
(t) = λC,R C(t) + λH,R H(t)
dt
dD
(t) = λC,D C(t) + λH,D H(t)
dt
The different parameters involved in the model are described in Table 2 and detailed in
the appendix of [10].
We denote by
u = SEI5CHRD(u0 , βp ,βa , βps , βms , βss , βH , βC ,
ε, µp , pa , µ, pps , pms , pss , pC ,
λCR , λCD , λHR , λHD , [0, T ])
the parameter-to-solution map where u = (S, E, Ip , Ia , Ips , Ims , Iss , C, H, R, D).
5

Compartment
S
E
Ip
Ia
Ips
Ims
Iss
H
C
R
D

Description
Susceptible
Exposed (non infectious)
Infected and pre-symptomatic (already infectious)
Infected and a-symptomatic (but infectious)
Infected and paucisymptomatic
Infected with mild symptoms
Infected with severe symptoms
Hospitalized
Intensive Care Unit
Removed
Dead

Table 1: Description of the compartments in Model SEI5CHRD

Parameter
βp
βa
βps
βms
βss
βH
βC
ε−1
µ−1
p
pa
µ−1
pps
pms
pss
pC
λCR
λCD
λHR
λHD

Description
Relative infectiousness of Ip
Relative infectiousness of Ia
Relative infectiousness of Ips
Relative infectiousness of Ims
Relative infectiousness of Iss
Relative infectiousness of IH
Relative infectiousness of IC
Latency period
Duration of prodromal phase
Probability of being asymptomatic
Infectious period of Ia , Ips , Ims , Iss
If symptomatic, probability of being paucisymptomatic
If symptomatic, probability of developing mild symptoms
If symptomatic, probability of developing severe symptoms (note that pps + pms + pss = 1)
If severe symptoms, probability of going in C
If in C, daily rate entering in R
If in C, daily rate entering in D
If hospitalized, daily rate entering in R
If hospitalized, daily rate entering in D
Table 2: Description of the parameters involved in Model SEI5CHRD

6

I
S

E1

E2

R
U

Figure 2: SE2IUR model
Compartment
S
E1
E2
I
U
R

Description
Susceptible
Exposed (non infectious)
Infected and pre-symptomatic (already infectious)
Infected and symptomatic
Un-noticed
dead and removed

Table 3: Description of the compartments in Model SE2IUR
• Second model, SE2IUR: This model is a variant of the one proposed in [22]. It involves 5
different compartments and a set of 6 parameters. The dynamics of the model is illustrated
in Figure 2 and the set of equations is

dS
1
(t) = − βS(t)(E2 (t) + U (t) + I(t))
dt
N
dE1
1
(t) = βS(t)(E2 (t) + U (t) + I(t)) − δE1 (t)
dt
N
dE2
(t) = δE1 (t) − σE2 (t)
dt
dI
(t) = νσE2 (t) − γ1 I(t)
dt
dU
(t) = (1 − ν)σE2 (t) − γ2 U (t)
dt
dR
(t) = γ1 I(t) + γ2 U (t)
dt

We denote by
u = SE2IUR(u0 , β, δ, σ, ν, γ1 , γ2 , [0, T ])
the parameter-to-solution map where u = (S, E1, E2, I, U, R). The different parameters
involved in the model are described in Table 4.
• Generalization: In the following, we abstract the procedure as follows. For a any
Detailed_Model with d compartments involving a vector µ ∈ Rp of p parameters, we
denote by
u(µ) = Detailed_Model(µ, [0, Te]), u(µ) ∈ L∞ ([0, Te], Rd )
7

Parameter
β
δ −1
σ −1
ν
γ1
γ2

Description
Relative infectiousness of I, U , E2
Latency period
Duration of prodromal phase
Proportion of I among I + U
If I, daily rate entering in R
If U , daily rate entering in R

Table 4: Description of the parameters involved in Model SE2IUR
the parameter-to-solution map, where Te is some given time simulation that can be as large
as wished because this is a virtual scenario. Note that, because the initial condition of the
illness at time 0 is not known, we include in the parameter set the initial condition u0 .

2.2

Forecasting based on model reduction of detailed models

We assume that we are given health data in a time window [0, T ], where T > 0 is assumed
to be the present time. The observed data is the series of infected people, denoted Iobs , and
removed people denoted Robs . They are usually given at a national or a regional scale and on
a daily basis. For our discussion, it will be useful to work with time-continuous functions and
t → Iobs (t) will denote the piecewise constant approximation in [0, T ] from the given data (and
similarly for Robs (t)). Our goal is to give short-term forecasts of the series in a time window
τ > 0 whose size will be about two weeks. We denote by I(t) and R(t) the approximations to
the series Iobs (t) and Robs (t) at any time t ∈ [0, T ].
As already brought up, we propose to fit the data and provide forecasts with SIR models
with time-dependent parameters β and γ. The main motivation for using such a simple family
is because it possesses optimal fitting and forecasting properties for our purposes in the sense
that we explain next. Defining the cost function
J (β, γ | Iobs (t), Robs (t), [0, T ]) :=

Z
0

T


|I(t) − Iobs (t)|2 + |R(t) − Robs (t)|2 dt

(1)

such that
(S, I, R) = SIR(β, γ, [0, T ]),
the fitting problem can be expressed at the continuous level as the optimal control problem of
finding
J∗ =
inf
J (β, γ | Iobs , Robs , [0, T ]).
(2)
(β,γ)∈L∞ ([0,T ])×L∞ ([0,T ])

The following result ensures the existence of a unique minimizer under very mild constraints.
Proposition 2.1. Let N ∈ N∗ and T > 0. For any real-valued functions Sobs , Iobs , Robs of class
C 1 , defined on [0, T ] satisfying
(i) Sobs (t) + Iobs (t) + Robs (t) = N for every t ∈ [0, T ],
(ii) Sobs in nonincreasing on [0, T ],
(iii) Robs is nondeacreasing on [0, T ],
∗ , γ ∗ ) to problem (2.2).
there exists a unique minimizer (βobs
obs

8

Proof. One can set
dSobs
N
(t)
Iobs (t)Sobs (t) dt
1 dRobs
:=
(t)
Iobs (t) dt


∗ (t) := −

βobs

∗ (t)
γobs
so that

(3)

(Sobs , Iobs , Robs ) = SIR(β ∗ , γ ∗ , [0, T ])

and

∗
∗
J (βobs
, γobs
, [0, T ]) = 0

which obviously implies that J ∗ = 0.

Note that one can equivalently set

dSobs
N

∗ (t) := −

(t)
βobs
Iobs (t)S
 obs (t) dt ∗

βobs (t)Iobs (t)Sobs (t)
dIobs
1

∗

(t) −
γobs (t) :=
Iobs (t)
dt
N
or again


∗ (t)

γobs

1 dRobs
(t)
Iobs (t) dt 

N
dIobs

∗ (t) :=
∗ (t)I

β
(t)
−
γ
(t)
 obs
obs
obs
Iobs (t)Sobs (t)
dt
:=

This simple observation means that there exists a time-dependent SIR model which can
perfectly fit the data of any (epidemiological) evolution that satisfies properties (i), (ii) and
(iii). In particular, we can perfectly fit the series of sick people with a time-dependent SIR
model (modulo a smoothing of the local oscillations due to noise). Since the health data are
∗ , γ ∗ by approximating the derivatives
usually given on a daily basis, we can approximate βobs
obs
by classical finite differences in equation (2.2).
∗
∗
∗ , γ ∗ ) = J ∗ = 0 implies that
The fact that we can build βobs
and γobs
such that J (βobs
obs
the family of time-dependent SIR models is rich enough not only to fit the evolution of any
epidemiological series, but also to deliver perfect predictions of the health data. However, this
great approximation power comes at the cost of defining the parameters β and γ in L∞ ([0, T ])
which is a space that is too large in order to be able to define any feasible prediction strategy.
In order to pin down a smaller manifold where these parameters may vary without sacrificing
much on the fitting and forecasting power, our strategy is the following:
1. Learning phase: The fundamental hypothesis of our approach is the confidence that the
specialists of epidemiology have well understood the mechanisms of infection transmission.
The second hypothesis is that these accurate models suffer from the proper determination
of the parameters they contain. We thus propose to generate a large number of virtual
epidemics, following these mechanistic models with parameters that can be chosen in a
vicinity of the suggested parameters values, including the different initial conditions.
(a) Generate virtual scenarios using detailed models with constant coefficients:
• Define the notion of Detailed_Model which is most appropriate for the epidemiological study. Several models could be considered. For our numerical application,
the detailed models were defined in Section 2.1.
9

• Define an interval range P ⊂ Rp where the parameters µ of Detailed_Model will
vary. We call the solution manifold U the set of virtual dynamics over [0, T + τ ],
namely
U := {u(µ) = Detailed_Model(µ, [0, T + τ ]) : µ ∈ P}.
• Draw a finite training set

Ptr = {µ1 , . . . , µK } ⊆ P

of K  1 parameter instances and we compute u(µ) = Detailed_Model(µ, [0, T +
τ ]) for µ ∈ Ptr . Each u(µ) is a virtual epidemiological scenario. An important
detail for our prediction purposes is that the simulations are done in [0, T + τ ],
that is, we simulate not only in the fitting time interval but also in the prediction
time interval. We call
Utr = {u(µ) : µ ∈ Ptr }

the training set of all virtual scenarios.
(b) Collapse: Collapse every detailed model u(µ) ∈ Utr into a SIR model following the
ideas which we explain in Section 2.3. For every u(µ), the procedure gives timedependent parameters β(µ) and γ(µ) and associated SIR solutions (S, I, R)(µ) in
[0, T + τ ]. This yields the sets
Btr := {β(µ) : µ ∈ Ptr } and Gtr := {γ(µ) : µ ∈ Ptr }.

(4)

(c) Compute reduced models:
We apply model reduction techniques using Btr and Gtr as training sets in order to
build two basis
Gn = span{g1 , . . . , gn } ⊂ L∞ ([0, T + τ ], R),

Bn = span{b1 , . . . , bn },

which are defined over [0, T + τ ]. The space Bn is such that it approximates well all
functions β(µ) ∈ Btr (resp. all γ(µ) ∈ Gtr can be well approximated by elements of
Gn ). We outline in Section 2.4 the methods we have explored in our numerical tests.
2. Fitting on the reduced spaces: We next solve the fitting problem (2.2) in the interval
[0, T ] by searching β (resp. γ) in Bn (resp. in Gn ) instead of in L∞ ([0, T ]), that is,
∗
J(B
=
n ,Gn )

min

(β,γ)∈Bn ×Gn

J (β, γ | Iobs , Robs , [0, T ]).

(5)

Note that the respective dimensions of Bn and Gn can be different, for simplicity we take
them equal in the following. Obviously, since Bn and Gn ⊂ L∞ ([0, T ]), we have that
∗
J ∗ ≤ J(B
,
n ,Gn )

∗
but we numerically observe that the function n 7→ J(B
decreases very rapidly as n
n ,Gn )
increases, which indirectly confirms the fact that the manifold generated by the two above
models accommodates well the COVID-19 epidemics.

The solution of problem (2) gives us coefficients (c∗i )ni=1 and (c̃∗i )ni=1 ∈ Rn such that the
time-dependent parameters
βn∗ (t) =
γn∗ (t) =

n
X
i=1
n
X

c∗i bi (t),
c̃∗i gi (t).

i=1

achieve the minimum (2).
10

∀t ∈ [0, T + τ ],

3. Forecast: For a given dimension n of the reduced spaces, propagate in [0, T + τ ] the
associated SIR model
(S∗n , I∗n , R∗n ) = SIR(βn∗ , γn∗ , [0, T + τ ])
The values In∗ (t) and Rn∗ (t) for t ∈ [0, T [ are by construction close to the observed data
Iobs , Robs (up to some numerical optimization error). The values In∗ (t) and Rn∗ (t) for
t ∈ [T, T + τ ] are then used for prediction.
4. Forecast Combination/Aggregation of Experts (optional step): By varying the
dimension n and using different model reduction approaches, we can easily produce a
collection of different forecasts and the question of how to select the best predictive model
arises. Alternatively, we can also resort to Forecast Combination techniques [26]: denoting
(I1 , R1 ), . . . , (IP , RP ) the different forecasts, the idea is to search for an appropriate linear
combination
P
X
FC
I (t) =
wp Ip (t)
p=1

and similarly for R. Note that these combinations do not need to involve forecasts from
our methodology only. Other approaches like time series forecasts could also be included.
One simple forecast combination is the average, in which all alternative forecasts are given
the same weight wp = 1/P, p = 1, . . . P . More elaborate approaches consist in estimating
the weights that minimize a loss function involving the forecast error.
Before going into the details of some of the steps, three remarks are in order:
1. To bring out the essential mechanisms, we have idealized some elements in the above
discussion by omitting certain unavoidable discretization aspects. To start with, the ODE
solutions cannot be computed exactly but only up to some accuracy given by a numerical
integration scheme. In addition, the optimal control problems (2.2) and (2) are non-convex.
As a result, in practice we can only find a local minima. Note however that modern solvers
find solutions which are very satisfactory for all practical purposes. In addition, note that
solving the control problem in a reduced space as in (2) could be interpreted as introducing
a regularizing effect with respect to the control problem (2.2) in the full L∞ ([0, T ]) space.
It is to be expected that the search of global minimizers is facilitated in the reduced
landscape.
2. routine-IR and routine-βγ: A variant for the fitting problem (2) which we have studied
in our numerical experiments is to replace the cost function J (β, γ | Iobs , Robs , [0, T ]) by
the cost function
∗
∗
Je(β, γ | βobs
, γobs
, [0, T ]) :=

Z
0

T


∗ 2
∗
|β − βobs
| + |γ − γobs
)|2 dt.

(6)

∗
∗
In other words, we use the variables βobs
and γobs
from (2.2) as observed data instead
of working with the observed health series Iobs , Robs . In Section 4, we will refer to the
standard fitting method as routine-IR and to this variant as routine-βγ.

3. The fitting procedure works both on the components of the reduced basis and the initial
time of the epidemics to minimize the loss function but, for simplicity, this last optimization
is not reported in the notation.
11

2.3
Let

Details on Step 1-(b): Collapsing the detailed models into SIR dynamics
u(µ) = Detailed_Model(µ, [0, T + τ ]) ∈ L∞ ([0, T + τ ], Rd )

be the solution in [0, T +τ ] to a detailed model for a given vector of parameters µ ∈ Rd . Here d is
possibly large (d = 11 in the case of SEI5CHRD model and d = 5 in the case of SE2IUR’s one). The
goal of this section is to explain how to collapse the detailed dynamics u(µ) into a SIR dynamics
with time-dependent parameters. The procedure can be understood as a projection of a detailed
dynamics into the family of dynamics given by SIR models with time-dependent parameters.
For the SEI5CHRD model, we collapse the variables by setting
Scol = S + E
Icol = Ip + Ia + Ips + Ims + Iss + C + H
Rcol = R + D
Similarly, for the SE2IUR model, we set
Scol = S + E1i
Icol = E2i + Ii + Ui
Rcol = R
Note that Scol , Icol and Rcol depend on µ but we have omitted the dependence to lighten the
notation.
Once the collapsed variables are obtained, we identify the time-dependent parameters β and
γ of the SIR model by solving the fitting problem
(β, γ) ∈

arg inf
(β,γ)∈L∞ ([0,T +τ ],R)×L∞ ([0,T +τ ],R)

J (β, γ | Icol , Rcol , [0, T + τ ])

(7)

where
(S, I, R) = SIR(β, γ, [0, T + τ ]).
Note that problem (2.3) has the same structure as problem (2.2), the difference coming from the
fact that the collapsed variables Icol , Rcol in (2.3) play the role of the health data Iobs , Robs in
(2.2). Therefore, it follows from Proposition 2.1 that problem (2.3) has a very simple solution
since it suffices to apply formula (2.2) for solving it. Note here that the exact derivatives of Scol ,
Icol and Rcol can be obtained from the Detailed_Model.
Since the solution (β, γ) to (2.3) depends on the parameter µ of the detailed model, repeating
the above procedure for every detailed scenario u(µ) for any µ ∈ Ptr yields the two families of
time-dependent functions Btr = {β(µ) : µ ∈ Ptr } and Gtr = {γ(µ) : µ ∈ Ptr } defined on the
interval [0, T + τ ] which were introduced in section (1b).

2.4

Details on Model Order Reduction

Model Order Reduction is a family of methods aiming at approximating a set of solutions of
parametrized PDEs or ODEs (or related quantities) with linear spaces, which are called reduced
models or reduced spaces. In our case, the sets to approximate are
B = {β(µ) : µ ∈ P} and G = {γ(µ) : µ ∈ P},
where each µ is the vector of parameters of the detailed model which take values over P, and
β(µ) and γ(µ) are the associated time-dependent coefficients of the collapsed SIR evolution. In
12

the following, we view B and G as subsets of L2 ([0, T ]), and we denote by k · k and h·, ·i its norm
and inner product. Indeed, in view of Proposition 2.1, B and G ⊂ L∞ ([0, T ]) ⊂ L2 ([0, T ]).
Let us carry the discussion for B (the same will hold for G). If we measure performance
in terms of the worst error in the set B, the best possible performance that reduced models of
dimension n can achieve is given by the Kolmogorov n-width
dn (B)L2 ([0,T ]) :=

inf

max ||u − PY uk

Y ∈L2 ([0,T ]) u∈B
dim(Y )≤n

where PY is the orthogonal projection onto the subspace Y . In the case of measuring errors in
an average sense, the benchmark is given by
Z
||u(y) − PY u(y)k2 dν(y)
δn2 (B, ν)L2 ([0,T ]) :=
inf
Y ∈L2 ([0,T ]) P
dim(Y )=n

where ν is some given measure on P.
In practice, building spaces that meet these benchmarks is generally not possible. However,
it is possible to build sequences
of spaces for

 which their error decay is comparable to the one
given by dn (B)L2 ([0,T ]) n or δn (B)L2 ([0,T ]) n . As a result, when the Kolmogorov width decays
fast, the constructed reduced spaces will deliver a very good approximation of the set B with
few modes (see [5, 9, 8, 20]).
We next present the reduced models that we have used in our numerical experiments. Other
methods could of course be considered and we refer to [27, 4, 15, 21] for general references on
model reduction. We carry the discussion in a fully discrete setting in order to simplify the
presentation and keep it as close to the practical implementation as possible. All the claims
below could be written in a fully continuous sense at the expense of introducing additional
mathematical objects such as certain Hilbert-Schmidt operators to define the continuous version
of the Singular Value Decomposition (SVD).
We build the reduced models using the two discrete training sets of functions Btr = {βi }K
i=1
and Gtr = {γi }K
from
B
and
G
where
K
denotes
the
number
of
virtual
scenarios
considered.
i=1
The sets have been generated in step 1-(b) of our general pipeline (see Section 2.2).
We consider a discretization of the time interval [0, T + τ ] into a set of Q ∈ N∗ points as
follows {t1 = 0, · · · , tP = T, · · · , tQ = T + τ } where P < Q. Thus, we can represent each
function βi as a vector of Q values
βi = (βi (t1 ), · · · , βi (tQ ))T ∈ RQ
+.
Q×K
and hence assemble all the functions of the family {βi }K
. The same
i=1 into a matrix MB ∈ R+
Q×K
K
remark applies for the family {γi }i=1 that gives a matrix MG ∈ R+ .

1. SVD: The eigenvalue decomposition of the correlation matrix MBT MB ∈ RK×K writes
MBT MB = V ΛV T ,
where V = (vi,j ) ∈ RK×K is an orthogonal matrix and Λ ∈ RK×K is a diagonal matrix
with non-negative entries which we denote λi and order them in decreasing order. The
`2 (RQ )-orthogonal basis functions {b1 , . . . , bK } are then given by the linear combinations
bi =

K
X

vj,i βj ,

j=1

13

1 ≤ i ≤ K.

For n ≤ K, the space

Bn = span{b1 , . . . bn }

is the best n-dimensional space to approximate the set {βi }K
i=1 in the average sense. We
have
δn ({βi }K
i=1 )`2 (RQ+1 ) =

K
1 X
||βi − PBn βi k2`2 (RQ+1 )
K

!1/2
=

i=1

K
X

!1/2
λi

i>n

and the average approximation error is given by the sum of the tail of the eigenvalues.
Therefore the SVD method is particularly efficient if there is a fast decay of the eigenvalues,
meaning that the set Btr = {βi }K
i=1 can be approximated by only few modes. However,
note that by construction, this method does not ensure positivity in the sense that PBn βi (t)
may become negative for some t ∈ [0, T ] although the original function βi (t) ≥ 0 for all
t ∈ [0, T ]. This is due to the fact that the vectors bi are not necessarily nonnegative.
As we will see later, in our study, ensuring positivity especially for extrapolation (i.e.,
forecasting) is particularly important, and motivates the next methods.
2. Nonnegative Matrix Factorization (NMF, see [25, 14]): NMF is a variant of SVD involving nonnegative modes and expansion coefficients. In this approach, we build a family
of non-negative functions {bi }ni=1 and we approximate each βi with a linear combination
βiNMF =

n
X

ai,j bj ,

j=1

1 ≤ i ≤ K,

(8)

where for every 1 ≤ i ≤ K and 1 ≤ j ≤ n, the coefficients ai,j ≥ 0 and the basis function
bj ≥ 0. In other words, we solve the following constrained optimization problem
(W ∗ , B ∗ ) ∈

arg min
n×Q
(W,B)∈RK×n
×R+
+

kMB − W Bk2F .

We refer to [14] for further details on the NMF and its numerical aspects.
3. Enlarged Nonnegative Greedy (ENG): greedy algorithm with projection on
an extended cone of positive functions: We now present our novel model reduction
method, which is of interest in itself since it allows to build reduced models that preserve
positivity and even other types of bounds. The method stems from the observation that
NMF approximates functions in the cone of positive functions of span{bi ≥ 0}ni=1 since
it imposes that ai,j ≥ 0 in the linear combination (2). However, note that the positivity
of the linear combination is not equivalent to the positivity of the coefficients ai,j since
there are obviously linear combinations involving very
P small ai,j < 0 for some j which
may still deliver a nonnegative linear combination nj=1 ai,j bj . We can thus widen the
cone of linear combinations yielding positive values by carefully including these negative
coefficients ai,j . One possible strategy for this is proposed in Algorithm 1, which describes
a routine that we call Enlarge_Cone. The routine
{ψ1 , . . . , ψn } = Enlarge_Cone[{b1 , . . . , bn }, ε]
takes a set of nonnegative functions {b1 , . . . , bn } as input, and modifies each function
bi by iteratively adding negative linear combinations of the other basis functions bj for
j 6= i (see line 11 of the routine). The coefficients are chosen in an optimal way so as
14

to maintain the positivity of the final linear combination while minimizing the L∞ -norm.
The algorithm returns a set of functions
X
ψi = bi −
σji bj , ∀i ∈ {1, . . . , n}
j6=i

with σji ≥ 0. Note that the algorithm requires to set a tolerance parameter ε > 0 for the
computation of the σji .
Once we have run Enlarge_Cone, the approximation of any function β is then sought as
β (EC) = arg min kβ −
c1 ,...,cn ≥0

n
X
j=1

cj ψj k2L2 ([0,T +τ ])

We emphasize that the routine is valid for any set of nonnegative input functions. We
can thus apply Enlarge_Cone to the functions {bi ≥ 0}ni=1 from NMF, but also to the
functions selected by a greedy algorithm such as the following:
• For n = 1, find

b1 = arg max kβk2L2 ([0,T +τ ])
β∈{βi }K
i=1

• At step n > 1, we have selected the set of functions {b1 , . . . , bn−1 }. We next find
bn = arg max
β∈{βi }K
i=1

min

c1 ,...,cn ≥0

kβ −

n−1
X
j=1

cj bj k2L2 ([0,T +τ ])

In our numerical tests, we call Enlarged Nonnegative Greedy (ENG) the routine involving
the above greedy algorithm combined with our routine Enlarge_Cone.
Algorithm 1 Enlarge_Cone[{b1 , . . . , bn }, ε] → {ψ1 , . . . , ψn }
Input: Set of nonnegative functions {b1 , . . . , bn }. Tolerance ε > 0.
for i ∈ {1, . . . , n} do
Set σji = 0, ∀j 6= i.
for ` ∈ {1, . . . , n} do


P
α`i,∗ = arg max{α ≥ 0 : bi − j6=i σji bj − αb` (t) > 0, ∀t ∈ [0, T + τ ]}
αi,∗

σ`i = σ`i + 2`
while α`i,∗ ≥ ε do


P
α`i,∗ = arg max{α ≥ 0 : bi − j6=i σji bj − αb` (t) > 0, ∀t ∈ [0, T + τ ]}
αi,∗

σ`i = σ`i + 2`
end while
end for P
ψi = bi − j6=i σji bj
end for
Output: {ψ1 , . . . , ψn }

We remark that if we work with positive functions that are upper bounded by a constant
L > 0, we can ensure that the approximations, denoted as Ψ, and written as a linear
combination of basis functions, will also be between these bounds 0 and L by defining, on
15

the one hand and as we have just done, a cone of positive functions generated by the above
family {ψi }i , and, on the other hand, by considering the base of the functions L − ϕ, ϕ
being as above the set all greedy elements of the reduced basis to which we also apply an
enlargement of these positive functions. We then impose that the approximation is written
as a positive combination of the first (positive) functions and that L − Ψ is also written
as a combination with positive components in the second basis.
In this frame, the approximation appears under the form of a least square approximation
with 2n linear constraints on the n coefficients expressing the fact that in the two above
transformed basis the coefficients are nonnegative.
In addition to the previous basis functions, it is possible to include more general/generic
basis functions such as polynomial, radial, or wavelet functions in order to guarantee simple
forecasting trends. For instance, one can add affine functions in order to include the possibility
of predicting with simple linear extrapolation to the range of possible forecasts offered by the
reduced model. Given the overall exponential behavior of the health data, we have added
an exponential function of the form b0 (t) = ξ exp(−ξ 0 t) (respectively g0 (t) = ψ exp(−ψ 0 t)) to
the reduced basis functions {b1 , . . . , bn } and (respectively {g1 , . . . , gn }) where the real-valued
nonnegative parameters ξ, ξ 0 , ψ, ψ 0 are obtained through a standard exponential regression from
∗ (respectively γ ∗ ) associated to the targeted profiles of infectious people, that is the profiles
βobs
obs
defined on the time interval [0, T ] that one wants to extrapolate to ]T, τ ]. In other words, the
final reduced models that we use for forecasting are:
Bn+1 = span{b0 , b1 , . . . , bn },

Gn+1 = span{g0 , g1 , . . . , gn } ⊂ L∞ ([0, T + τ ], R),

Indeed, including the exponential functions in the reduced models gives access cheaply to the
overall behavior of the parameters β and γ, the rest of basis functions generated from the training
sets catch the high order approximations and allow then to improve the extrapolation.
Remark 2.2. Reduced models on I = {I(µ) : µ ∈ P} and R = {R(µ) : µ ∈ P} Instead of
applying model reduction to the sets B and G as we do in our approach, we could apply the same
above techniques directly to the sets of solutions I and R of the SIR models with time-dependent
coefficients in B and G. In this case, the resulting approximation would however not follow a
SIR dynamics.

3

Methodology for multiple regions including population mobility data

The forecasting method of Section 2.2 for one single region can be extended to the treatment of
multiple regions involving population mobility. The prediction scheme will now be based on a
multiregional SIR with time-dependent coefficients. Compared to other more detailed models,
its main advantage is that it reduces drastically the number of parameters to be estimated.
Indeed, detailed multiregional models such as multiregional extensions of the above SEI5CHRD
and SE2IUR models from Section 2.3 require a number of parameters which quickly grows with
the number P of regions involved. Their calibration thus requires large amounts of data which,
in addition, may be unknown, very uncertain, or not available. In a forthcoming paper, we will
apply the fully multi-regional setting for the post-lockdown period.
The structure of this section is the same as the previous one for the case of a single region. We
start by introducing in Section 3.1 the multi-regional SIR model with time-dependent coefficients
and associated detailed models. As any multiregional model, mobility data are required as an
16

input information, and the nature and level of detail of the available data motivates certain
choices on the modelling of the multiregional SIR (as well as the other detailed models). We
next present in Section 3.2 the general pipeline, in which we emphasize the high modularity of
the approach.

3.1

Multi-regional compartmental models

In the spirit of fluid flow modeling, there are essentially two ways of describing mobility between
regions:
• In a Eulerian description, we take the regions as fixed references for which we record
incoming and outgoing travels.
• In a Lagrangian description, we follow the motion of people domiciled in a certain region
and record their travels in the territory. We can expect this modeling to be more informative on the geographical spread of the disease but it comes at the cost of additional details
on the people’s domicile region.
Note that both descriptions hold at any coarse or fine geographical level in the sense that what
we call the regions could be taken to be full countries, departments within a country, or very
small geographical partitions of a territory. We next describe the multi-regional SIR models
with the Eulerian and Lagrangian description of population fluxes which will be the output of
our methodology.
3.1.1

Multi-regional SIR models with time-dependent parameters

Eulerian description of population flux: Assume that we have P regions and the number
of people in region i is Ni for i = 1, . . . , P . Due to mobility, the population in each region varies,
so Ni depends on t. However, the total population is assumed to be constant and equal to N ,
that is
P
X
N=
Ni (t), ∀t ≥ 0.
i=1

For any t ≥ 0, let λi→j (t) ∈ [0, 1] be the probability that people from i travel to j at time t. In
other words, λi→j (t)Ni (t)δt is the number of people from region i that have travelled to region
j between time t and t + δt. Note that we have
P
X

λi→j (t) = 1,

j=1

∀t ≥ 0.

Since, for any δt ≥ 0,
Ni (t + δt) = Ni (t) −

X

λi→j (t)Ni (t)δt +

j6=i

X

λj→i (t)Nj (t)δt

j6=i

dividing by δt and taking the limit δt → 0 yields
X
X
dNi
(t) = −
λi→j (t)Ni (t) +
λj→i (t)Nj (t).
dt
j6=i

Note that we have

j6=i

P
X
dNi
i=1

dt

(t) = 0,
17

∀t ≥ 0.

P
P
Thus i Ni (t) = i Ni (0) = N , which is consistent with our assumption that the total population is constant.
The time evolution of the Ni is known in this case if we are given the λi→j (t) from Eulerian
mobility data. In addition to this mobility data, we also have the data of the evolution of infected
and removed people and our goal is to fit a multi-regional SIR model that is in accordance with
this data. We propose the following model.
Denoting Si , Ii an Ri the number of Susceptible, Infectious and Removed people in region i
at time t, we first have the relation
Ni (t) = Si (t) + Ii (t) + Ri (t)

⇔

1=

Si (t)
Ii (t)
Ri (t)
+
+
.
Ni (t) Ni (t) Ni (t)

Note that from the second relation, it follows that
0=

d Si
d Ii
d Ri
+
+
.
dt Ni dt Ni dt Ni

(9)

To model the evolution between compartments, one possibility is the following SIR model


X
I
I
Si
d Si
j
i
= − βi λi→i
+
βj λj→i 
(10)
dt Ni
Ni
Nj Ni
j6=i

d Ii
d Si
Ii
=−
− γi
dt Ni
dt Ni
Ni
d Ri
Ii
= γi ,
dt Ni
Ni
The parameters βi , γi , Ni depend on t but we have omitted the dependence to ease the reading.
Introducing the compartmental densities
si =

Si
,
Ni

ii =

Ii
,
Ni

ri =

Ri
,
Ni

the system equivalently reads


d
si = − βi λi→i ii +
dt


X

βj λj→i ij  si

(11)

j6=i

d
d
ii = − si − γi ii
dt
dt
d
ri = γi ii ,
dt
Before going further, some comments are in order:
• The model is consistent in the sense that it satisfies (3.1.1) and when P = 1 we recover
the traditional SIR model.
• Under lockdown measures, λi→j ≈ δi,j and the population Ni (t) remains practically constant. As a result, the evolution of each region is decoupled from the others and each
region can be addressed with the mono-regional approach.
• The use of βj in equation (3.1.1) is debatable. When the people from region j arrive to
region i, it may be reasonable to assume that the contact rate is βi .
18

• The use of λj→i in equation (3.1.1) is also very debatable. The probability λj→i was
originally defined to account for the mobility of people from region j to region i without
specifying the compartment. However, in equation (3.1.1), we need the probability of
mobility of infectious people from region j to region i, which we denote by µj→i in the
following. It seems reasonable to think that µj→i may be smaller than λj→i because as
soon as people become symptomatic and suspect their illness, they will probably not move.
Two possible options would be:
– We could try to make a guess on µj→i . If the symptoms arise, say, 2 days after
infection and if we recover in 15 days in average, then we could say that µj→i =
2/15λj→i .
– Since, the above seems however pretty empirical, another option is to use λj→i and
absorb the uncertainty in the values of the βj that one fits.
• We choose not to add mobility in the R compartment as this does not modify the dynamics
of the epidemic spread and only adjustments in the population sizes are needed.
Lagrangian description of population flux: We call the above description Eulerian because
we have fixed the regions as a fixed reference. Another point of view is to follow the trajectories
of inhabitants of each region, in the same spirit as when we follow the trajectories of fluid
particles.
Let now Si , Ii , Ri the number of susceptible, infectious and Removed people who are domiciled in region i, i = 1, . . . P . It is reasonable to assume that Si (t) + Ii (t) + Ri (t) is constant in
(i)
time. However, all the dwellers of region i may not all be in that region at time t. Let λj→k (t)
be the probability that susceptible people domiciled at i travel from region j to region k at time
(i)
t. With this notation, λi→i (t) is the probability that susceptible people domiciled at i remain in
(i)
region i at time t. Similarly, let µj→k (t) be the probability that infectious people domiciled at i
travel from region j to k at time t. Hence the total number of susceptible and infectious people
that are in region i at time t is
Si (t) =
Ii (t) =

P X
P 
X
k=1 j=1
P X
P 
X
k=1 j=1


(k)
(k)
λj→i (t) − λi→j (t) Sk (t)

(k)
(k)
µj→i (t) − µi→j (t) Sk (t)

We can thus write the evolution over Si , Ii , Ri as
P

P

XX
dSi
(i)
=−
βk (t)λj→k (t)Si (t)Ik (t)
dt

(12)

j=1 k=1

dIi
dSi
=−
− γi (t)Ii (t)
dt
dt
dRi
= γi (t)Ii (t)
dt
Note that Si (t) + Ii (t) + Ri (t) is constant, which is consistent with the fact that in our model
d
(Si + Ii + Ri ) = 0.
dt
19

(i)

We emphasize that, to implement this model, one needs the Lagrangian mobility data λj→k for
all (i, j, k) ∈ {1, . . . , P }3 .
Notation: In the following, we gather the compartmental variables in vectors
~S := (S)P ,
i=1

~I := (I)P ,
i=1

~ := (R)P
R
i=1

as well as the time-dependent coefficients
~ = (β)P ,
β
i=1

~ = (γ)Pi=1 .
γ

~ and ~
For any β
γ ∈ (L∞ ([0, T ]))P , we denote by
~ γ
~ = Multiregional_SIR(~S(0), ~I(0), R(0),
~
~ , [0, T ])
(~S, ~I, R)
β,
the output of any of the above multiregional SIR models. For simplicity in what follows, we will
omit the initial condition in the notation.
3.1.2

Detailed multi-regional models with constant coefficients

In the spirit of the multi-regional SIR, one can formulate detailed multi-regional versions of more
detailed models such as the ones introduced in Section 2.1. We omit the details for the sake of
brevity.

3.2

Forecasting for multiple regions with population mobility

Similarly as in the mono-regional case, we assume that we are given health data in [0, T ] in
all regions. The observed data in region i is the series of infected people, denoted Iiobs , and
recovered people denoted Riobs . They are usually given at a national or a regional scale and on
a daily basis.
We propose to fit the data and provide forecasts with SIR models with time-dependent
parameters βi and γi for each region i. Like in the mono-regional case, we can prove that such
a simple family possesses optimal fitting properties for our purposes. In the current case, the
cost function reads
P Z T
X

~ ~
~ obs , [0, T ]) :=
J (β,
γ | ~Iobs , R
|Ii (t) − Iiobs (t)|2 + |Ri (t) − Riobs (t)|2 dt
i=1

0





~ ~γ , [0, T ] ,
~ = Multiregional_SIR β,
such that ~S, ~I, R
and the fitting problem is the optimal control problem of finding
J∗ =

inf

~ γ ∈(L∞ ([0,T ]))P ×(L∞ ([0,T ]))P
β,~

~ γ
~ obs , [0, T ]).
~ | ~Iobs , R
J (β,

(13)

The following proposition ensures the existence of a unique minimizer under certain conditions.
To prove it, it will be useful to remark that any of the above multi-regional SIR models (see
(3.1.1), (3.1.1)) can be written in the general form
d~S
~
= M(Λ(t), ~S(t), ~I(t))β
dt
d~I
d~S
~
=−
− diag(I(t)) γ
dt
dt
~
dR
= diag(I(t))~γ ,
dt
20

~ are densities of population in the
where, by a slight abuse of notation, the vectors ~S, ~I and R
case of the Eulerian approach (see equation (3.1.1)). They are classical population numbers in
the case of the Lagrangian approach (see equation (3.1.1)). diag(I(t)) is the P × P diagonal
matrix with diagonal entries given by the vector I(t). M(Λ(t), ~S(t), ~I(t)) is a matrix of size P ×P
which depends on the vectors of susceptible and infectious people ~S(t), ~I(t) and on the mobility
matrix Λ. In the case of the Eulerian description, Λ(t) = (λi,j (t))1≤i,j≤P and in the case of the
(i)
Lagrangian approach Λ(t) is the P × P × P tensor Λ(t) = (λj,k (t))1≤i,j,k≤P . For example, in the
case of the Eulerian model (3.1.1), the matrix M reads
M(Λ(t), ~S(t), ~I(t)) = − diag(~S(t))ΛT diag(~I(t)) = −(Si λi→j Ij )1≤i,j≤P

(14)

Proposition 3.1. If M(Λ(t), ~S(t), ~I(t)) is invertible for all t ∈ [0, T ], then there exists a unique
~ ∗, γ
~ ∗ ) to problem (3.2).
minimizer (β
Proof. Since we assume that M(Λ(t), ~S(t), ~I(t)) is invertible for every t ∈ [0, T ], we can set
(
~ ∗ (t) := M −1 (t) d~S
β
dt
~ ∗ (t)
γ

~

:= diag−1 (I(t)) ddtR

or equivalently

β
~ ∗ (t) := M −1 (t) d~S
dt


~
~∗
~
γ ∗ (t) := − diag−1 (I(t)) ddtI + M(Λ(t), ~S(t), ~I(t))β
so that



~ ∗, γ
~ obs ) = Multiregional_SIR β
~ ∗ , [0, T ]
(~Sobs , ~Iobs , R

and

~ ∗, γ
~ obs , [0, T ]) = 0
~ ∗ | ~Iobs , R
J (β

which implies that J ∗ = 0.
Before going further, let us comment on the invertibility of M(Λ(t), ~S(t), ~I(t)) which is necessary in Proposition 3.1. A sufficient condition to ensure it is if the matrix is diagonally dominant
row-wise or column-wise. This yields certain conditions on the mobility matrix Λ(t) with respect to the values of ~S(t), ~I(t). For example, if M is defined as in equation (3.2), the matrix is
diagonally dominant per rows if for every 1 ≤ i ≤ P ,
λi→i >

X

λi→j

Ij
.
Ii

λi→j

Si
,
Sj

j6=i

Similarly, if for every 1 ≤ j ≤ P ,
λj→j >

X
i6=j

then the matrix is diagonally dominant per columns, and guarantees invertibility. Note that any
of the above conditions is satisfied in situations with little or no mobility where λi→i ≈ δi,j .
Now that we have exactly defined the set up for the multi-regional case, we can follow the
same steps of Section 2.2 to derive forecasts involving model reduction for the time-dependent
~ and γ
~.
variables β
21

4

Numerical results

In this section we apply our forecasting method to the ongoing COVID-19 pandemic spread
in year 2020 in France which started approximately from February 2020. Particular emphasis
is put on the first pandemic wave for which we consider the period going from March 19 to
May 20, 2020. Due to the lockdown imposed between March 17 and May 11, inter-regional
population mobility was drastically reduced in that period. Studies using anonymised Facebook
data have estimated the reduction in 80% (see [3]). As a result, it is reasonable to treat each
region independently from the rest, and we apply the mono-regional setting of Section 2. Here,
we focus on the case of the Paris region, and we report different forecasting errors obtained using
the methods described in Section 2. Some forecasts are also shown for the second wave for the
Paris region between September 24 and November 25.
The numerical results are presented as follows. Section 4.1 explains the sources of health
data. Sections 4.2.1 and 4.2.2 go straight to the core of the results and present a study of the
forecasting power of the methods in a two week horizon. Section 4.2.3 displays forecasts on the
second wave. Section 4.2.4 aims to illustrate the robustness of the forecasting over longer periods
of time. A discussion on the fitting errors of the methods is given in Appendix A. Additional
results highlighting the accuracy of the forecasts are shown in Appendix B.

4.1

Data

We use public data from Santé Publique France1 to get the number Iobs (t) of infected, and
Robs (t) of removed people. As shown in Figure 3, the raw data present some oscillations at the
scale of the week, which are due to administrative delays for the cases to be officially reported
by hospitals. For our methodology, we have smoothed the data by applying a 7 days moving
average filter. In order to account for the total number of infected people, we also multiply the
data by an adjustment factor fadj = 15 as hinted from the literature2 . Obviously, this factor is
uncertain and could be improved in the light of further retrospective studies of the outbreak.
However, note that when S ' N which is the case in the start of the epidemic, the impact of
this factor is negligible in the dynamics as can be understood from (2.2). In addition, since we
use the same factor down to provide a forecast on the hospitalized, the influence on the choice
is minor.

4.2

Results

Using the observations Iobs (t) and Robs (t), we apply a finite difference scheme in formula (2.2)
∗ (t) and γ ∗ (t) for t ∈ [0, T ]. Figure 4 shows the values of these parameters as well
to derive βobs
obs
∗
∗ /γ ∗ for the first pandemic wave in Paris.
as the basic reproduction number R0,obs
= βobs
obs
We next follow the steps of Section 2.2 to obtain the forecasts. In the learning phase (step
1), we use two parametric detailed models of type SE2IUR and SEI5CHRD to generate training
sets Btr and Gtr composed of K = 2618 training functions β(µ) and γ(µ) where µ are uniformly
sampled in the set of parameters Ptr in the vicinity of the parameter values suggested in the
literature [10, 22]. Based on these training sets, we finish step 1 by building three types of
reduced models: SVD, NMF and ENG (see Section 2.4).
1

https://www.data.gouv.fr/en/datasets/donnees-hospitalieres-relatives-a-lepidemie-de-covid-19/
Indeed, it is said in [24] that "of the 634 confirmed cases, a total of 306 and 328 were reported to be
symptomatic and asymptomatic" and in [10] claims that the probability of developing severe symptoms for a
symptomatic patient is 0 for children, 0.1 for adults and 0.2 for seniors. Thus if one takes p = 0.13 as an
approximate value of these probabilities, one may estimate the adjustment factor as fadj = 634
× p1 ≈ 15.
328
2

22

5.0e+04

1.0e+05

4.0e+04

8.0e+04

3.0e+04

6.0e+04
4.0e+04

2.0e+04
Iobs raw data
Iobs moving average

1.0e+04

Robs raw data
Robs moving average

2.0e+04
0.0e+00

18 25 01 08 15 22 29 06 13 20
03- 0-03- 0-04- 0-04- 0-04- 0-04- 0-04- 0-05- 0-05- 0-050
202 202 202 202 202 202 202 202 202 202

18 25 01 08 15 22 29 06 13 20
03- 0-03- 0-04- 0-04- 0-04- 0-04- 0-04- 0-05- 0-05- 0-050
202 202 202 202 202 202 202 202 202 202

(a) Infected

(b) Removed

Figure 3: Data from t0 = 19/03/2020 to T = 20/05/2020
0.12
0.4

3

0.10
0.3
0.08

2

0.2
0.06

1

0.1
0.04
0.0

8
5
1
8
5
2
9
6
3
0
3-1 3-2 4-0 4-0 4-1 4-2 4-2 5-0 5-1 5-2
0-0 0-0 0-0 0-0 0-0 0-0 0-0 0-0 0-0 0-0
202 202 202 202 202 202 202 202 202 202

∗
(a) βobs

8
5
1
8
5
2
9
6
3
0
3-1 3-2 4-0 4-0 4-1 4-2 4-2 5-0 5-1 5-2
0-0 0-0 0-0 0-0 0-0 0-0 0-0 0-0 0-0 0-0
202 202 202 202 202 202 202 202 202 202

0
-18 3-25 4-01 4-08 4-15 4-22 4-29 5-06 5-13 5-20
3
0
0- 0-0 0-0 0-0 0-0 0-0 0-0 0-0 0-0 0-0
202 202 202 202 202 202 202 202 202 202

∗
(b) γobs

∗
(c) R0,obs

∗ , γ ∗ , R∗
∗
∗
Figure 4: βobs
obs
0,obs = βobs /γobs deduced from the data from t0 = 19/03/2020 to
T = 20/05/2020

Given the reduced bases Bn and Gn , we next search for the optimal βn∗ ∈ Bn and γn∗ ∈ Gn
that fit at best the observations (step 2 of our procedure). For this fitting step we consider two
loss functions:
1. routine-IR: loss function J (β, γ | Iobs , Robs , [0, T ]) from (2.2),
∗ , γ ∗ , [0, T ]) from (2)
2. routine-βγ: loss function Je(β, γ | βobs
obs

We study the performance of each of the three reduced models and the impact of the dimension n of the reduced model in terms of fitting error. The presentation of these results is deferred
to Appendix A in order not to overload the main discussion. The main conclusion is that the
fitting strategy using SVD reduced bases provide smaller errors than NMF and ENG especially
when we increase the number of modes n. This is illustrated in Figure 5 where we show the
fittings obtained with routine-βγ and n = 10 for the first wave (from t0 = 19/03/2020 to
∗ and γ ∗ while ENG produces
T = 20/05/2020). We observe that SVD is the best at fitting βobs
obs
a smoother fitting of the data. Although the smoother fitting with ENG yields larger fitting
errors than SVD, we will see in the next section that it yields better forecasts.
4.2.1

Forecasting for the first pandemic wave on a 14 day horizon

In this section we illustrate the short-term forecasting behavior of our method. We consider
a forecasting window of τ = 14 days and we examine several different starting days in the
course of the first pandemic wave. The results are shown in figures 6 to 14. Recall that that
the forecasting uses the coefficients of the reduced basis obtained by the fitting procedure, but
23

0.12

∗
βobs

0.4

∗
β10,EN
G
∗
β10,SV
D
∗
β10,N
MF

0.3
0.2

∗
γobs

0.10

∗
γ10,EN
G

0.08

∗
γ10,SV
D
∗
γ10,N
MF

0.06
0.1

0.04
0.0

8
5
1
8
5
2
9
6
3
0
3-1 3-2 4-0 4-0 4-1 4-2 4-2 5-0 5-1 5-2
0-0 0-0 0-0 0-0 0-0 0-0 0-0 0-0 0-0 0-0
202 202 202 202 202 202 202 202 202 202

8
5
1
8
5
2
9
6
3
0
3-1 3-2 4-0 4-0 4-1 4-2 4-2 5-0 5-1 5-2
0-0 0-0 0-0 0-0 0-0 0-0 0-0 0-0 0-0 0-0
202 202 202 202 202 202 202 202 202 202

(a) β

(b) γ

Figure 5: Fitting from t0 = 19/03/2020 to T = 20/05/2020
also the optimal initial condition of the forecast that minimizes the error on the three days
prior to the start of the forecast. For each given fitting strategy (routine-IR, routine-βγ),
and each given type of reduced model (SVD, NMF, ENG), we have chosen to plot an average
forecast computed with predictions using reduced dimensions n ∈ {5, 6, 7, 8, 9, 10}. This choice
is a simple type of forecast combination but of course other more elaborate aggregation options
could be considered. The labels of the plots correspond to the following:
• ISV D , IN M F , IEN G , RSV D , RN M F , REN G are the average forecasts obtained using routine-βγ.
∗
∗
∗
∗
∗
∗
• ISV
D , IN M F , IEN G , RSV D , RN M F , REN G are the average forecasts obtained using routine-IR.

The main observation from Figures 6 to 14 is that the ENG reduced model is the most robust
and accurate forecasting method. Fitting ENG with routine-IR or routine-βγ does not seem
to lead to large differences in the quality of the forecasts but routine-βγ seems to provide
slightly better results. This claim is further confirmed by the study of the numerical forecasting
errors of the different methods that the reader finds in Appendix B.
Figures 6 to 14 also show that the SVD reduced model is very unstable and provides forecasts
that blow up. This behavior illustrates the dangers of overfitting, namely that a method with
high fitting power may present poor forecasting power due to instabilities. In the case of SVD,
the instabilities stem from the fact that approximations are allowed to take negative values.
This is the reason why NMF, which incorporates the nonnegative constraint, performs better
than SVD. One of the reasons why ENG outperforms NMF relies in the enlargement of the
cone of nonnegative functions (see Section 2.4). It is important to note that, with ENG the
reduced bases are directly related to well chosen virtual scenarios, whereas SVD and NMF rely
on matrix factorization techniques that provide purely artificial bases. This makes forecasts
from ENG more realistic and therefore more reliable.
6.0e+04
4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

RENG
RSVD
RNMF
∗
RENG
∗
RSVD
∗
RNMF

IENG
ISVD
INMF
∗
IENG
∗
ISVD
∗
INMF

1.0e+05

Iobs

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

5.0e+04

(b) Removed

(a) Infected

Figure 6: 14 day forecasts starting from T = 01/04.
24

Robs
data limit

6.0e+04
4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

IENG
ISVD
INMF
∗
IENG
∗
ISVD
∗
INMF

1.0e+05

Iobs

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
202
2
2
2
2
2
2
2
2
2

data limit

RENG
RSVD
RNMF
∗
RENG
∗
RSVD
∗
RNMF

5.0e+04

Robs
data limit

(b) Removed

(a) Infected

Figure 7: 14 day forecasts starting from T = 03/04.
6.0e+04
4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

RENG
RSVD
RNMF
∗
RENG
∗
RSVD
∗
RNMF

IENG
ISVD
INMF
∗
IENG
∗
ISVD
∗
INMF

1.0e+05

Iobs

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

5.0e+04

Robs
data limit

(b) Removed

(a) Infected

Figure 8: 14 day forecasts starting from T = 05/04.
6.0e+04
4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

RENG
RSVD
RNMF
∗
RENG
∗
RSVD
∗
RNMF

IENG
ISVD
INMF
∗
IENG
∗
ISVD
∗
INMF

1.0e+05

Iobs

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

5.0e+04

Robs
data limit

(b) Removed

(a) Infected

Figure 9: 14 day forecasts starting from T = 07/04.
6.0e+04
4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

RENG
RSVD
RNMF
∗
RENG
∗
RSVD
∗
RNMF

IENG
ISVD
INMF
∗
IENG
∗
ISVD
∗
INMF

1.0e+05

Iobs

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

5.0e+04

Robs
data limit

(b) Removed

(a) Infected

Figure 10: 14 day forecasts starting from T = 09/04.
6.0e+04
4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

IENG
ISVD
INMF
∗
IENG
∗
ISVD
∗
INMF

1.0e+05

Iobs

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
202
2
2
2
2
2
2
2
2
2

data limit

RENG
RSVD
RNMF
∗
RENG
∗
RSVD
∗
RNMF

5.0e+04

(b) Removed

(a) Infected

Figure 11: 14 day forecasts starting from T = 11/04.
25

Robs
data limit

6.0e+04
4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

IENG
ISVD
INMF
∗
IENG
∗
ISVD
∗
INMF

1.0e+05

Iobs

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
202
2
2
2
2
2
2
2
2
2

data limit

RENG
RSVD
RNMF
∗
RENG
∗
RSVD
∗
RNMF

5.0e+04

Robs
data limit

(b) Removed

(a) Infected

Figure 12: 14 day forecasts starting from T = 15/04.

6.0e+04
4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

RENG
RSVD
RNMF
∗
RENG
∗
RSVD
∗
RNMF

IENG
ISVD
INMF
∗
IENG
∗
ISVD
∗
INMF

1.0e+05

Iobs

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

5.0e+04

Robs
data limit

(b) Removed

(a) Infected

Figure 13: 14 day forecasts starting from T = 21/04.

6.0e+04
4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

IENG
ISVD
INMF
∗
IENG
∗
ISVD
∗
INMF

1.0e+05

Iobs

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
202
2
2
2
2
2
2
2
2
2

data limit

RENG
RSVD
RNMF
∗
RENG
∗
RSVD
∗
RNMF

5.0e+04

Robs
data limit

(b) Removed

(a) Infected

Figure 14: 14 day forecasts starting from T = 05/05.

4.2.2

Focus on the forecasting with ENG

For our best forecasting method (routine-βγ using ENG), we plot in Figures 15 to 23 the
forecasts for each dimension n = 5 to 10. The plots give the forecasts on a 14 day ahead
window for β, γ and the resulting evolution of the infected I and removed R. We see that the
method performs reasonably well for all values of n, and proves that the results of the previous
section with the averaged forecast are not compensating spurious effects which could occur for
certain values of n. We intentionally chose to display the inaccurate forecasts from 03/04, 07/04
and 11/04 as they are among of the worst predictions obtained using this method, however, it
is important to mention that despite the lack of accuracy for these cases it remains plausible
epidemic behaviors with different but realistic evolutions for β and γ compared to the actual
evolution. Note that the method was able to predict the peak of the epidemic several days in
advance (see Figure 15). We also observe that the prediction on γ is difficult at all times due to
∗ presents an oscillatory behavior. Despite this difficulty, the resulting forecasts
the fact that γobs
for I and R are very satisfactory in general.
26

∗
βobs
β5∗
β6∗
β7∗
β8∗
β9∗
∗
β10

4.0e-01

2.0e-01

0.0e+00

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

7.5e-02
5.0e-02

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

data limit

202

4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

202

(a) β
6.0e+04

∗
γobs
γ5∗
γ6∗
γ7∗
γ8∗
γ9∗
∗
γ10

1.0e-01

(b) γ
Iobs
I5
I6
I7
I8
I9
I10
IEN G

1.0e+05

5.0e+04

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

Robs
R5
R6
R7
R8
R9
R10
REN G
data limit

(d) Removed

(c) Infected

Figure 15: ENG forecast from T = 01/04

∗
βobs
β5∗
β6∗
β7∗
β8∗
β9∗
∗
β10

4.0e-01

2.0e-01

0.0e+00

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

7.5e-02
5.0e-02

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

data limit

202

4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

202

(a) β
6.0e+04

∗
γobs
γ5∗
γ6∗
γ7∗
γ8∗
γ9∗
∗
γ10

1.0e-01

(b) γ
Iobs
I5
I6
I7
I8
I9
I10
IEN G

1.0e+05

5.0e+04

data limit

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

(d) Removed

(c) Infected

Figure 16: ENG forecast from T = 03/04
27

Robs
R5
R6
R7
R8
R9
R10
REN G
data limit

∗
βobs
β5∗
β6∗
β7∗
β8∗
β9∗
∗
β10

4.0e-01

2.0e-01

0.0e+00

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

7.5e-02
5.0e-02

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

data limit

202

4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

202

(a) β
6.0e+04

∗
γobs
γ5∗
γ6∗
γ7∗
γ8∗
γ9∗
∗
γ10

1.0e-01

(b) γ
Iobs
I5
I6
I7
I8
I9
I10
IEN G

1.0e+05

5.0e+04

data limit

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

Robs
R5
R6
R7
R8
R9
R10
REN G
data limit

(d) Removed

(c) Infected

Figure 17: ENG forecast from T = 05/04

∗
βobs
β5∗
β6∗
β7∗
β8∗
β9∗
∗
β10

4.0e-01

2.0e-01

0.0e+00

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

1.0e-01

5.0e-02

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

data limit

202

4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

202

(a) β
6.0e+04

∗
γobs
γ5∗
γ6∗
γ7∗
γ8∗
γ9∗
∗
γ10

(b) γ
Iobs
I5
I6
I7
I8
I9
I10
IEN G

1.0e+05

5.0e+04

data limit

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

(d) Removed

(c) Infected

Figure 18: ENG forecast from T = 07/04
28

Robs
R5
R6
R7
R8
R9
R10
REN G
data limit

∗
βobs
β5∗
β6∗
β7∗
β8∗
β9∗
∗
β10

4.0e-01

2.0e-01

0.0e+00

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

7.5e-02
5.0e-02

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

data limit

202

4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

202

(a) β
6.0e+04

∗
γobs
γ5∗
γ6∗
γ7∗
γ8∗
γ9∗
∗
γ10

1.0e-01

(b) γ
Iobs
I5
I6
I7
I8
I9
I10
IEN G

1.0e+05

5.0e+04

data limit

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

Robs
R5
R6
R7
R8
R9
R10
REN G
data limit

(d) Removed

(c) Infected

Figure 19: ENG forecast from T = 09/04

∗
βobs
β5∗
β6∗
β7∗
β8∗
β9∗
∗
β10

4.0e-01

2.0e-01

0.0e+00

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

7.5e-02
5.0e-02

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

data limit

202

4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

202

(a) β
6.0e+04

∗
γobs
γ5∗
γ6∗
γ7∗
γ8∗
γ9∗
∗
γ10

1.0e-01

(b) γ
Iobs
I5
I6
I7
I8
I9
I10
IEN G

1.0e+05

5.0e+04

data limit

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

(d) Removed

(c) Infected

Figure 20: ENG forecast from T = 11/04
29

Robs
R5
R6
R7
R8
R9
R10
REN G
data limit

∗
βobs
β5∗
β6∗
β7∗
β8∗
β9∗
∗
β10

4.0e-01

2.0e-01

0.0e+00

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

7.5e-02
5.0e-02

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

data limit

202

4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

202

(a) β
6.0e+04

∗
γobs
γ5∗
γ6∗
γ7∗
γ8∗
γ9∗
∗
γ10

1.0e-01

(b) γ
Iobs
I5
I6
I7
I8
I9
I10
IEN G

1.0e+05

5.0e+04

data limit

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

Robs
R5
R6
R7
R8
R9
R10
REN G
data limit

(d) Removed

(c) Infected

Figure 21: ENG forecast from T = 15/04

∗
βobs
β5∗
β6∗
β7∗
β8∗
β9∗
∗
β10

4.0e-01

2.0e-01

0.0e+00

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

7.5e-02
5.0e-02

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

data limit

202

4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

202

(a) β
6.0e+04

∗
γobs
γ5∗
γ6∗
γ7∗
γ8∗
γ9∗
∗
γ10

1.0e-01

(b) γ
Iobs
I5
I6
I7
I8
I9
I10
IEN G

1.0e+05

5.0e+04

data limit

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

(d) Removed

(c) Infected

Figure 22: ENG forecast from T = 21/04
30

Robs
R5
R6
R7
R8
R9
R10
REN G
data limit

∗
βobs
β5∗
β6∗
β7∗
β8∗
β9∗
∗
β10

4.0e-01

2.0e-01

0.0e+00

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

7.5e-02
5.0e-02

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

data limit

202

4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

202

(a) β
6.0e+04

∗
γobs
γ5∗
γ6∗
γ7∗
γ8∗
γ9∗
∗
γ10

1.0e-01

(b) γ
Iobs
I5
I6
I7
I8
I9
I10
IEN G

1.0e+05

5.0e+04

data limit

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

Robs
R5
R6
R7
R8
R9
R10
REN G
data limit

(d) Removed

(c) Infected

Figure 23: ENG forecast from T = 05/05

4.2.3

Forecasting of the second wave with ENG

The review of the present paper took place during the month of November 2020 while the
second COVID-19 pandemic wave hit France. We have taken the chance to enlarge the body of
numerical results and we provide some example forecasts with ENG on this wave in figures 24 to
26. As the figures illustrate, the method provides very satisfactory forecasts on a 14 day ahead
window. We again observe a satisfactory prediction of the second peak (figures 24, 25 and 26)
and the same difficulty in forecasting γ due to the oscillations in γobs but this has not greatly
impacted on the quality of the forecasts for I and R.

∗
βobs
β5∗
β6∗
β7∗
β8∗
β9∗
∗
β10

1.0e-01

5.0e-02

1
8
5
2
9
6
2
9
6
3
9-2 9-2 0-0 0-1 0-1 0-2 1-0 1-0 1-1 1-2
0-0 0-0 0-1 0-1 0-1 0-1 0-1 0-1 0-1 0-1
202 202 202 202 202 202 202 202 202 202

data limit

6.0e-02

4.0e-02
1
8
5
2
9
6
2
9
6
3
9-2 9-2 0-0 0-1 0-1 0-2 1-0 1-0 1-1 1-2
0-0 0-0 0-1 0-1 0-1 0-1 0-1 0-1 0-1 0-1
202 202 202 202 202 202 202 202 202 202

(a) β
2.0e+04

1.0e+04

0.0e+00
1
8
5
2
9
6
2
9
6
3
9-2 9-2 0-0 0-1 0-1 0-2 1-0 1-0 1-1 1-2
0-0 0-0 0-1 0-1 0-1 0-1 0-1 0-1 0-1 0-1
202 202 202 202 202 202 202 202 202 202

∗
γobs
γ5∗
γ6∗
γ7∗
γ8∗
γ9∗
∗
γ10

data limit

(b) γ
Iobs
I5
I6
I7
I8
I9
I10
IEN G
data limit

1.8e+05
1.6e+05
1.4e+05

1
8
5
2
9
6
2
9
6
3
9-2 9-2 0-0 0-1 0-1 0-2 1-0 1-0 1-1 1-2
0-0 020-0 020-1 020-1 020-1 020-1 020-1 020-1 020-1 020-1
2
2
2
2
2
2
2
2
2

202

(c) Infected

(d) Removed

Figure 24: ENG forecast from T = 28/10
31

Robs
R5
R6
R7
R8
R9
R10
REN G
data limit

8.0e-02

∗
βobs
β5∗
β6∗
β7∗
β8∗
β9∗
∗
β10

1.0e-01

5.0e-02

1
8
5
2
9
6
2
9
6
3
9-2 9-2 0-0 0-1 0-1 0-2 1-0 1-0 1-1 1-2
0-0 020-0 020-1 020-1 020-1 020-1 020-1 020-1 020-1 020-1
2
2
2
2
2
2
2
2
2

6.0e-02
5.0e-02

1
8
5
2
9
6
2
9
6
3
9-2 9-2 0-0 0-1 0-1 0-2 1-0 1-0 1-1 1-2
0-0 020-0 020-1 020-1 020-1 020-1 020-1 020-1 020-1 020-1
2
2
2
2
2
2
2
2
2

data limit

(b) γ

(a) β

1.0e+04

0.0e+00
1
8
5
2
9
6
2
9
6
3
9-2 9-2 0-0 0-1 0-1 0-2 1-0 1-0 1-1 1-2
0-0 0-0 0-1 0-1 0-1 0-1 0-1 0-1 0-1 0-1
202 202 202 202 202 202 202 202 202 202

data limit

202

202

2.0e+04

∗
γobs
γ5∗
γ6∗
γ7∗
γ8∗
γ9∗
∗
γ10

7.0e-02

Iobs
I5
I6
I7
I8
I9
I10
IEN G
data limit

1.8e+05
1.6e+05
1.4e+05

1
8
5
2
9
6
2
9
6
3
9-2 9-2 0-0 0-1 0-1 0-2 1-0 1-0 1-1 1-2
0-0 020-0 020-1 020-1 020-1 020-1 020-1 020-1 020-1 020-1
2
2
2
2
2
2
2
2
2

202

(c) Infected

Robs
R5
R6
R7
R8
R9
R10
REN G
data limit

(d) Removed

Figure 25: ENG forecast from T = 03/11

∗
βobs
β5∗
β6∗
β7∗
β8∗
β9∗
∗
β10

1.0e-01

5.0e-02

1
8
5
2
9
6
2
9
6
3
9-2 9-2 0-0 0-1 0-1 0-2 1-0 1-0 1-1 1-2
0-0 020-0 020-1 020-1 020-1 020-1 020-1 020-1 020-1 020-1
2
2
2
2
2
2
2
2
2

6.0e-02
5.0e-02

1
8
5
2
9
6
2
9
6
3
9-2 9-2 0-0 0-1 0-1 0-2 1-0 1-0 1-1 1-2
0-0 020-0 020-1 020-1 020-1 020-1 020-1 020-1 020-1 020-1
2
2
2
2
2
2
2
2
2

data limit

202

1.0e+04

0.0e+00
1
8
5
2
9
6
2
9
6
3
9-2 9-2 0-0 0-1 0-1 0-2 1-0 1-0 1-1 1-2
0-0 0-0 0-1 0-1 0-1 0-1 0-1 0-1 0-1 0-1
202 202 202 202 202 202 202 202 202 202

data limit

202

(a) β
2.0e+04

∗
γobs
γ5∗
γ6∗
γ7∗
γ8∗
γ9∗
∗
γ10

7.0e-02

(b) γ
Iobs
I5
I6
I7
I8
I9
I10
IEN G
data limit

1.8e+05
1.6e+05
1.4e+05

1
8
5
2
9
6
2
9
6
3
9-2 9-2 0-0 0-1 0-1 0-2 1-0 1-0 1-1 1-2
0-0 020-0 020-1 020-1 020-1 020-1 020-1 020-1 020-1 020-1
2
2
2
2
2
2
2
2
2

202

(c) Infected

Robs
R5
R6
R7
R8
R9
R10
REN G
data limit

(d) Removed

Figure 26: ENG forecast from T = 09/11

4.2.4

Forecasts with ENG on a 28-day-ahead window

To conclude this results section, we extend the forecasting window to 28 days instead of 14 and
study whether the introduced ENG method still provides satisfactory forecasts. As shown in
figures 27 to 32), the results of the methods are quite stable for large windows. This shows
that in contrast to standard extrapolation methods using classical linear or affine regressions,
the reduced basis catches the dynamics of β and γ not only locally but also at extended time
intervals.
32

∗
βobs
β5∗
β6∗
β7∗
β8∗
β9∗
∗
β10

4.0e-01

2.0e-01

0.0e+00

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

7.5e-02
5.0e-02

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

data limit

202

4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

202

(a) β
6.0e+04

∗
γobs
γ5∗
γ6∗
γ7∗
γ8∗
γ9∗
∗
γ10

1.0e-01

(b) γ
1.0e+05

Iobs
I5
I6
I7
I8
I9
I10
IEN G

5.0e+04

data limit

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

Robs
R5
R6
R7
R8
R9
R10
REN G
data limit

(d) Removed

(c) Infected

Figure 27: ENG forecast from T = 01/04

∗
βobs
β5∗
β6∗
β7∗
β8∗
β9∗
∗
β10

4.0e-01

2.0e-01

0.0e+00

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

7.5e-02
5.0e-02

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

data limit

202

4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

202

(a) β
6.0e+04

∗
γobs
γ5∗
γ6∗
γ7∗
γ8∗
γ9∗
∗
γ10

1.0e-01

(b) γ
1.0e+05

Iobs
I5
I6
I7
I8
I9
I10
IEN G

5.0e+04

data limit

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

(d) Removed

(c) Infected

Figure 28: ENG forecast from T = 05/04
33

Robs
R5
R6
R7
R8
R9
R10
REN G
data limit

∗
βobs
β5∗
β6∗
β7∗
β8∗
β9∗
∗
β10

4.0e-01

2.0e-01

0.0e+00

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

7.5e-02
5.0e-02

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

data limit

202

4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

202

(a) β
6.0e+04

∗
γobs
γ5∗
γ6∗
γ7∗
γ8∗
γ9∗
∗
γ10

1.0e-01

(b) γ
Iobs
I5
I6
I7
I8
I9
I10
IEN G

1.0e+05

5.0e+04

data limit

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

Robs
R5
R6
R7
R8
R9
R10
REN G
data limit

(d) Removed

(c) Infected

Figure 29: ENG forecast from T = 05/04

1.2e-01

∗
βobs
β5∗
β6∗
β7∗
β8∗
β9∗
∗
β10

4.0e-01

2.0e-01

0.0e+00

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

7.5e-02
5.0e-02

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

data limit

(a) β

4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

202

202

6.0e+04

∗
γobs
γ5∗
γ6∗
γ7∗
γ8∗
γ9∗
∗
γ10

1.0e-01

(b) γ
Iobs
I5
I6
I7
I8
I9
I10
IEN G

1.0e+05

5.0e+04

data limit

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

(d) Removed

(c) Infected

Figure 30: ENG forecast from T = 15/04
34

Robs
R5
R6
R7
R8
R9
R10
REN G
data limit

∗
βobs
β5∗
β6∗
β7∗
β8∗
β9∗
∗
β10

4.0e-01

2.0e-01

0.0e+00

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

5.0e-02

8
5
1
8
5
2
9
6
3
0
3-1
3-2
4-0
4-0
4-1
4-2
4-2
5-0
5-1
5-2
0-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0 020-0
2
2
2
2
2
2
2
2
2

data limit

202

4.0e+04
2.0e+04
0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

data limit

202

(a) β
6.0e+04

∗
γobs
γ5∗
γ6∗
γ7∗
γ8∗
γ9∗
∗
γ10

1.0e-01

(b) γ
1.0e+05

Iobs
I5
I6
I7
I8
I9
I10
IEN G

5.0e+04

data limit

0.0e+00
8
5
1
8
5
2
9
6
3
0
3-1 -03-2 -04-0 -04-0 -04-1 -04-2 -04-2 -05-0 -05-1 -05-2
0-0
0
0
0
0
0
0
0
0
0
202 202 202 202 202 202 202 202 202 202

Robs
R5
R6
R7
R8
R9
R10
REN G
data limit

(d) Removed

(c) Infected

Figure 31: ENG forecast from T = 21/04

∗
βobs
β5∗
β6∗
β7∗
β8∗
β9∗
∗
β10

1.0e-01

5.0e-02

1
8
5
2
9
6
2
9
6
3
9-2 9-2 0-0 0-1 0-1 0-2 1-0 1-0 1-1 1-2
0-0 0-0 0-1 0-1 0-1 0-1 0-1 0-1 0-1 0-1
202 202 202 202 202 202 202 202 202 202

6.0e-02

4.0e-02

1
8
5
2
9
6
2
9
6
3
9-2 9-2 0-0 0-1 0-1 0-2 1-0 1-0 1-1 1-2
0-0 020-0 020-1 020-1 020-1 020-1 020-1 020-1 020-1 020-1
2
2
2
2
2
2
2
2
2

data limit

1.0e+04

0.0e+00
1
8
5
2
9
6
2
9
6
3
9-2 9-2 0-0 0-1 0-1 0-2 1-0 1-0 1-1 1-2
0-0 0-0 0-1 0-1 0-1 0-1 0-1 0-1 0-1 0-1
202 202 202 202 202 202 202 202 202 202

data limit

202

(a) β
2.0e+04

∗
γobs
γ5∗
γ6∗
γ7∗
γ8∗
γ9∗
∗
γ10

(b) γ
Iobs
I5
I6
I7
I8
I9
I10
IEN G
data limit

1.8e+05
1.6e+05
1.4e+05

1
8
5
2
9
6
2
9
6
3
9-2 9-2 0-0 0-1 0-1 0-2 1-0 1-0 1-1 1-2
0-0 020-0 020-1 020-1 020-1 020-1 020-1 020-1 020-1 020-1
2
2
2
2
2
2
2
2
2

202

(c) Infected

Robs
R5
R6
R7
R8
R9
R10
REN G
data limit

(d) Removed

Figure 32: ENG forecast from T = 28/10

5

Conclusion

We have developed an epidemiological forecasting method based on reduced modeling techniques.
Among the different strategies that have been explored, the one that outperforms the rest
in terms of robustness and forecasting power involves reduced models that are built with an
Enlarged Nonnegative Greedy (ENG) strategy. This method is novel and of interest in itself
since it allows to build reduced models that preserve positivity and even other types of bounds.
Despite that ENG does not have optimal fitting properties (i.e. interpolation properties), it
is well suited for forecasting since, due to the preservation of the natural constraints of the
coefficients, it generates realistic dynamics with few modes. The results have been presented for
a mono-regional test case, and we plan to extend the present methodology to a multi-regional
setting using mobility data.
Last but not least, we would like to emphasize that the developed strategy is very general,
and could be applied to the forecasting of other types of dynamics. The specificity of each
35

problem may however require adjustments in the reduced models. This is exemplified in the
present problem through the construction of reduced models that preserve positivity.

Acknowledgments and disclosure of funding
We would like to thank our colleagues from the “Face au virus” initiative in PSL University: Jamal Atif, Laurent Massoulié, Olivier Cappé, and Akin Kazakcy. We also thank Gabriel Turinici
for his feedback on the multiregional models. Part of this research has been supported by the
Emergences project grant “Models and Measures” of the Paris city council, by the generous donation made available by Alkan together with the complementary funding given by the Sorbonne
University Foundation. This research is done in the frame of the project Pandemia/Covidia and
also the GIS Obepine, both projects aiming at a better understanding of the Covid-19 pandemic.

A

Analysis of model error and observation noise

In this section we study the impact of observation noise and model error in the quality and
behavior of the fitting step. The elements that impact the accuracy of our procedure are the
following:
1. Observation noise: The observed health data Iobs and Robs presents several sources of
noise: there may be some inaccuracies in the reporting of cases, and the data are then
post-processed. This eventually yields to noisy time series Iobs and Robs for which it is
difficult to estimate the uncertainty. These noisy data are then used to produce (through
∗ and γ ∗ which are in turn also noisy.
finite differences) βobs
obs
2. Model errors: Two types of model errors are identified
(a) Intrinsic model error on B and G: The families of detailed models that we use are
rich but they may not cover all possible evolutions of Iobs and Robs . In other words,
our manifolds B and G may not perfectly cover the real epidemiological evolution.
Such error motivated the introduction of the exponential functions b0 and g0 described
in Section 2.4.
(b) Sampling error of B and G: The size of the training sets Btr and Gtr and the dimension n of the reduced models Bn and Gn also limit the approximation capabilities
of the continuous target sets B and G
In this section, we aim at disentangling these effects in order to give a better insight of the fitting
error behavior on the real data.

A.1

Study of the impact of the sampling error: Fitting a virtual scenario

Our set of virtual epidemiological dynamics is U. After the collapsing step, the manifolds for β
and γ are B and G. These sets are potentially infinite and we have used finite training subsets
Btr ⊆ B and Gtr ⊆ G to build the reduced models Bn and Gn .
First we look at the eigenvalues for β and γ when performing an SVD decomposition for the
virtual scenarios. Figure 33 shows a rapid decay of the eigenvalues obtained by SVD decomposition, it shows that we can obtain a very good approximation of elements of Btr ⊆ B and Gtr ⊆ G
with only a few modes.
36

10−1

10−1

10−3

10−3

10−5

10−5

10−7

10−7
0

10

20

30

40

50

0

(a) Normalised eigenvalues for β vs n

10

20

30

40

50

(b) Normalised eigenvalues for γ vs n

Figure 33: Training step: Decay of SVD eigenvalues

Among the sources of noise and model error given at the beginning of Appendix A, we can
study the impact of the sampling error (point 2-b) as follows. For this, we start by examining
the fitting error on an interval of 45 days for two functions β and γ which belong to the manifold
B and G and are in the training sets Btr and Gtr . This error will serve as a benchmark that we
will use to compare fitting errors of functions that are not in the training sets.

∗
∗
∗
∗ k
∗
Figure 34 shows relative fitting errors kβn∗ −βobs
L2 ([t0 ,T ]) /kβ̄obs kL2 ([t0 ,T ]) and kγn −γobs kL2 ([t0 ,T ]) /kγ̄obs kL2 ([t0 ,T
using SVD, NMF and ENG reduced bases with n = 2, . . . , 20, where the notation x̄ denotes the
mean of the quantity x over [0, T ]. We observe that for SVD the fitting errors behave similarly
as the error decay of the training step (Figure 33).

100
10−2
10

−3

10−5
10−6
10

kβSVD −βkL2
kβ̄kL2

−9

2

4

6

8

kγNMF −γkL2
kγ̄kL2

10−11

kβENG −βkL2
kβ̄kL2

10−12

kγSVD −γkL2
kγ̄kL2

10−8

kβNMF −βkL2
kβ̄kL2

10

12

14

16

18

20

kγENG −γkL2
kγ̄kL2

2

4

6

8

10

12

14

16

18

20

(b) L2 relative error of γ vs n

(a) L2 relative error of β vs n

Figure 34: Study of sampling errors: Fitting errors of functions β and γ from B and G that
belong to the training sets Btr and Gtr .

Figure 35 shows the L1 and L∞ errors obtained after the propagation of the fittings of β and
γ. In both metrics, the error for I and R obtained using SVD is decreasing below 10−12 . When
the NMF and the ENG are used, the error decreases and stagnates at 10−2 for both I and R.
37

100

100

10−3

10−3

10−6

10−6

kISVD −IkL1
¯ 1
kIk
L

10−9

kRSVD −RkL∞
kR̄kL∞

10−9

kINMF −IkL1
¯ 1
kIk

kRNMF −RkL∞
kR̄kL∞

L

10

−12

kIENG −IkL1
¯ 1
kIk

10

−12

kRENG −RkL∞
kR̄kL∞

L

2

4

6

8

10

12

14

16

18

20

2

4

6

8

10

12

14

16

18

20

(b) L∞ relative error of R vs n

(a) L1 relative error of I vs n

Figure 35: Study of sampling errors: Errors on I and R obtained by a SIR model using the
fitted β and γ.

Now we consider the fitting error for two functions β and γ which belong to the manifold B
and G but which are not in the training sets Btr and Gtr . Figure 36 shows the fitting error on
the virtual scenario considered using SVD, NMF and ENG reduced bases for n = 2, . . . , 20. We
note that the quality of the fittings by each method is very similar to that of Figure 35 where the
functions were taken in the training sets. This illustrates that the sampling error is not playing
a major role in our experiments.

10−2

10−2

10−4
10−5

10−6

10−8
10

−11

2

4

kβSVD −βkL2
kβ̄kL2

10−8

kβNMF −βkL2
kβ̄kL2

kγSVD −γkL2
kγ̄kL2

10−10

kβENG −βkL2
kβ̄kL2

kγNMF −γkL2
kγ̄kL2

10−12

kγENG −γkL2
kγ̄kL2

6

8

10

12

14

16

18

20

(a) L2 relative error of β vs n

2

4

6

8

10

12

14

16

18

20

(b) L2 relative error of γ vs n

Figure 36: Study of sampling errors: Fitting errors of functions β and γ from B and G but
which do not belong to the training sets Btr and Gtr .

Figure 37 shows the L1 and L∞ errors obtained after the propagation of the fittings of β
and γ. In both metrics, the error for I and R obtained using SVD is decreasing to each 10−14 .
When the NMF and the ENG are used, the error decreases and stagnates respectively at 10−3
and 10−4 for both I and R.
38

10−3

10−4

10−6

10−7
kISVD −IkL1
¯ 1
kIk

10−9

kRSVD −RkL∞
kR̄kL∞

10−10

L

kINMF −IkL1
¯ 1
kIk

kRNMF −RkL∞
kR̄kL∞

L

10−12

10

kIENG −IkL1
¯ 1
kIk

−13

kRENG −RkL∞
kR̄kL∞

L

2

4

6

8

10

12

14

16

18

20

2

4

6

8

10

12

14

16

18

20

(b) L∞ relative error of R vs n

(a) L1 relative error of I vs n

Figure 37: Study of sampling errors: Errors on I and R obtained by a SIR model using the
fitted β and γ.

A.2

Study of the impact of noisy data and intrinsic model error

To investigate the impact of noise in the observed data, we now add noise to the two previously
chosen functions β ∈ B and γ ∈ G, and we study the fitting error on this noisy data. The level
of the noise has been chosen to be of the same level as the one estimated for the real dynamics.
In order to estimate the noise we performed a fitting of the real data using SVD reduced bases,
the level of noise is defined as the difference between this fitting and the real data. This level of
noise is then added to the virtual scenario considered here. Figure 38 shows the fitting error on
β and γ using SVD, NMF and ENG reduced bases for n = 2, . . . , 20.

kβSVD −βkL2
kβ̄kL2
kβNMF −βkL2
kβ̄kL2

10−1

kγSVD −γkL2
kγ̄kL2

10−1

kγNMF −γkL2
kγ̄kL2
kγENG −γkL2
kγ̄kL2

kβENG −βkL2
kβ̄kL2

10−2

10−2

2

4

6

8

10

12

14

16

18

20

(a) L2 relative error of β vs n

2

4

6

8

10

12

14

16

18

20

(b) L2 relative error of γ vs n

Figure 38: Fitting errors of β and γ on noisy virtual scenario

We observe that the noise strongly deteriorates the fitting error obtained using NMF, and the
error becomes oscillatory and very unstable. For ENG, the error remains low and consistently
around 10−2 for β. We observe the same behaviour for γ with instabilities arising for n > 10.
For SVD the error is lower than in the ENG case and slowly decreases as n increases. Figure
39 shows the L1 and L∞ errors obtained after the propagation of the fittings of β and γ. In
line with the observations from Figure 38 the error obtained using NMF is very unstable. Using
ENG, we observe a decay from n = 2 to n = 7 and oscillations that remain around 10−2 for I
and 10−3 for R. The decay observed for SVD is slow and steady, the error nearly reaches 10−4
for I and 10−5 for R when n = 20.
39

10−1

kISVD −IkL1
¯ 1
kIk
L

10−1

kINMF −IkL1
¯ 1
kIk
L

kRNMF −RkL∞
kR̄kL∞

10−2

kIENG −IkL1
¯ 1
kIk
L

10−2

kRSVD −RkL∞
kR̄kL∞

kRENG −RkL∞
kR̄kL∞

10−3
10−4

10−3

2

4

6

8

10

12

14

16

18

20

2

4

6

8

10

12

14

16

18

20

(b) L∞ relative error of R vs n

(a) L1 relative error of I vs n

Figure 39: Fitting errors of I and R on noisy data
Finally, it remains to add intrinsic model error on top of the previous sampling error and
observation noise. If we do so, the main change is that the previous fitting error plots from
Figure 38 have essentially the same behavior but the error values are increased depending on
the degree of model inaccuracy. We have therefore disentangled all the effects of model error
and noisy data, and all the observations from this section give thus a better insight of the fitting
on the real data.
Figure 40 summarizes the fitting results for an example fitting period taken from t0 = 19/03
to T = 03/05. Figures 40a and 40b show the fitting error on β and γ using SVD, NMF and
ENG reduced bases for n = 2, . . . , 20. Figures 40c and 40d show the L1 and L∞ relative errors
on In and Rn after the propagation of the fittings of βn∗ and γn∗ .
kγSVD −γkL2
kγ̄kL2

101

kγNMF −γkL2
kγ̄kL2

kβSVD −βkL2
kβ̄kL2

10−1

kβENG −βkL2
kβ̄kL2

2

4

6

8

10

12

14

16

18

kγENG −γkL2
kγ̄kL2

100

kβNMF −βkL2
kβ̄kL2

10−1

20

2

(a) L2 relative error of β vs n

4

6

8

10

12

14

16

18

20

18

20

(b) L2 relative error of γ vs n

100

100
kISVD −IkL1
¯ 1
kIk

10−1

L

10−1

kINMF −IkL1
¯ 1
kIk
L

10−2

kRSVD −RkL∞
kR̄kL∞

kIENG −IkL1
¯ 1
kIk
L

kRNMF −RkL∞
kR̄kL∞

10−2

kRENG −RkL∞
kR̄kL∞

10−3
2

4

6

8

10

12

14

16

18

20

10−3

2

4

6

8

10

12

14

16

(d) L∞ relative error of R vs n

(c) L1 relative error of I vs n

Figure 40: Fitting errors from t0 = 19/03/2020 to T = 03/05/2020
From figures 40a and 40b, we observe that the fitting error with SVD decreases at a moderate
40

rate as the dimension n of the reduced basis is increased. The error with NMF and ENG does
not decrease and oscillates around certain constant error value of order 10−1 . Note that this
value is small and yields to small errors in the approximation of I and R as figures 40c and 40d
illustrate.

B

Study of forecasting errors

In this section we give a detailed study of the forecasting errors for each different fitting strategy (routine-IR, routine-βγ), reduced model (SVD, NMF, ENG) and starting date T . We
anticipate the main conclusion which we already announced in Section 4.2.1: ENG fitted with
routine-βγ outperforms the other reduced models and is the most robust and accurate reduced
model to use in a forecasting strategy. Figure 41 shows the relative errors of a 14 days forecast
from T = 01/04 for each forecasting method and each reduced basis. Similarly figures 42 to 49
show forecasts relative errors respectively from different times.

101

kISVD −Iobs kL1
kI¯obs k 1

100

kIENG −Iobs kL1
kI¯obs kL1

kRSVD −Robs kL∞
kR̄obs kL∞

101

L

kINMF −Iobs kL1
kI¯obs kL1

kRNMF −Robs kL∞
kR̄obs kL∞

100

kRENG −Robs kL∞
kR̄obs kL∞

10−1

∗
kRNMF
−Robs kL∞
kR̄obs kL∞

∗
kRSVD
−Robs kL∞
kR̄obs kL∞

∗
kISVD
−Iobs kL1
kI¯obs k 1
L

∗
kINMF
−Iobs kL1

kI¯obs kL1

10−1

∗
kRENG
−Robs kL∞
kR̄obs kL∞

∗
kIENG
−Iobs kL1
kI¯obs kL1

5

6

7

8

9

5

10

6

7

8

9

10

(b) L∞ relative error of R vs n

(a) L1 relative error of I vs n

Figure 41: Forecasting errors of I and R (from T = 01/04)

101

101

kISVD −Iobs kL1
kI¯obs kL1
kINMF −Iobs kL1
kI¯obs kL1

100

kIENG −Iobs kL1
kI¯obs kL1
∗
kISVD
−Iobs kL1
kI¯obs k 1

kRSVD −Robs kL∞
kR̄obs kL∞

kRNMF −Robs kL∞
kR̄obs kL∞

100

kRENG −Robs kL∞
kR̄obs kL∞

10−1

∗
kRSVD
−Robs kL∞
kR̄obs kL∞

L

10

−1

10−2

∗
kINMF
−Iobs kL1

kI¯obs kL1

∗
kIENG
−Iobs kL1
kI¯obs kL1

5

6

7

8

9

10

∗
kRNMF
−Robs kL∞
kR̄obs kL∞

10−2
10−3

∗
kRENG
−Robs kL∞
kR̄obs kL∞

5

6

7

8

9

10

(b) L∞ relative error of R vs n

(a) L1 relative error of I vs n

Figure 42: Forecasting errors of I and R (from T = 03/04)
41

100

100

kISVD −Iobs kL1
kI¯obs kL1

kRSVD −Robs kL∞
kR̄obs kL∞

kINMF −Iobs kL1
kI¯obs kL1
kIENG −Iobs kL1
kI¯obs kL1

10−1

∗
kISVD
−Iobs kL1
kI¯obs kL1

kRNMF −Robs kL∞
kR̄obs kL∞

10

kRENG −Robs kL∞
kR̄obs kL∞

−1

∗
kRSVD
−Robs kL∞
kR̄obs kL∞

∗
kRNMF
−Robs kL∞
kR̄obs kL∞

∗
kINMF
−Iobs kL1
kI¯obs kL1
∗
kIENG
−Iobs kL1
kI¯obs kL1

10−2
5

6

7

8

9

10

∗
kRENG
−Robs kL∞
kR̄obs kL∞

10−2

5

6

7

8

9

10

(b) L∞ relative error of R vs n

(a) L1 relative error of I vs n

Figure 43: Forecasting errors of I and R (from T = 05/04)

100

100

kISVD −Iobs kL1
kI¯obs kL1

kRSVD −Robs kL∞
kR̄obs kL∞

kINMF −Iobs kL1
kI¯obs kL1

10

kIENG −Iobs kL1
kI¯obs k 1

kRNMF −Robs kL∞
kR̄obs kL∞

L

−1

∗
kISVD
−Iobs kL1

10

kI¯obs kL1

kRENG −Robs kL∞
kR̄obs kL∞

−1

∗
kRSVD
−Robs kL∞
kR̄obs kL∞

∗
kRNMF
−Robs kL∞
kR̄obs kL∞

∗
kINMF
−Iobs kL1
kI¯obs kL1
∗
kIENG
−Iobs kL1
kI¯obs k 1

∗
kRENG
−Robs kL∞
kR̄obs kL∞

L

10−2

5

6

7

8

9

10

10−2

5

6

7

8

9

10

(b) L∞ relative error of R vs n

(a) L1 relative error of I vs n

Figure 44: Forecasting errors of I and R (from T = 07/04)

102

102

kISVD −Iobs kL1
kI¯obs kL1
kINMF −Iobs kL1
kI¯obs kL1

101

kRNMF −Robs kL∞
kR̄obs kL∞

101

kIENG −Iobs kL1
kI¯obs kL1

100

kRSVD −Robs kL∞
kR̄obs kL∞

kRENG −Robs kL∞
kR̄obs kL∞

100

∗
kISVD
−Iobs kL1

∗
kRSVD
−Robs kL∞
kR̄obs kL∞

kI¯obs kL1

∗
kINMF
−Iobs kL1
kI¯obs kL1

10−1
10−2

∗
kIENG
−Iobs kL1
kI¯obs kL1

5

6

7

8

9

10

∗
kRNMF
−Robs kL∞
kR̄obs kL∞

10−1
10−2

∗
kRENG
−Robs kL∞
kR̄obs kL∞

5

6

7

8

9

10

(b) L∞ relative error of R vs n

(a) L1 relative error of I vs n

Figure 45: Forecasting errors of I and R (from T = 09/04)

101
10

101

kISVD −Iobs kL1
kI¯obs kL1
kINMF −Iobs kL1
kI¯obs kL1

0

kIENG −Iobs kL1
kI¯obs kL1

10−1

∗
kISVD
−Iobs kL1
kI¯obs k 1

kRSVD −Robs kL∞
kR̄obs kL∞

kRNMF −Robs kL∞
kR̄obs kL∞

100

kRENG −Robs kL∞
kR̄obs kL∞

10−1

∗
kRSVD
−Robs kL∞
kR̄obs kL∞

L

∗
kINMF
−Iobs kL1

kI¯obs kL1

10−2
10−3

∗
kIENG
−Iobs kL1
kI¯obs kL1

5

6

7

8

9

10

∗
kRNMF
−Robs kL∞
kR̄obs kL∞

10−2
10−3

∗
kRENG
−Robs kL∞
kR̄obs kL∞

5

6

7

8

9

10

(b) L∞ relative error of R vs n

(a) L1 relative error of I vs n

Figure 46: Forecasting errors of I and R (from T = 11/04)
42

101

kINMF −Iobs kL1
kI¯obs kL1

100

kIENG −Iobs kL1
kI¯obs kL1
∗
kISVD
−Iobs kL1
kI¯obs kL1

10−1

10−2

100

kISVD −Iobs kL1
kI¯obs kL1

∗
kINMF
−Iobs kL1
kI¯obs kL1
∗
kIENG
−Iobs kL1
kI¯obs kL1

5

6

7

8

9

10

kRSVD −Robs kL∞
kR̄obs kL∞

kRNMF −Robs kL∞
kR̄obs kL∞

10−1

kRENG −Robs kL∞
kR̄obs kL∞
∗
kRSVD
−Robs kL∞
kR̄obs kL∞

∗
kRNMF
−Robs kL∞
kR̄obs kL∞

10−2

∗
kRENG
−Robs kL∞
kR̄obs kL∞

10−3

5

6

7

8

9

10

(b) L∞ relative error of R vs n

(a) L1 relative error of I vs n

Figure 47: Forecasting errors of I and R (from T = 15/04)

kISVD −Iobs kL1
kI¯obs k 1

kRSVD −Robs kL∞
kR̄obs kL∞

L

100

kINMF −Iobs kL1
kI¯obs kL1

100

kRNMF −Robs kL∞
kR̄obs kL∞
kRENG −Robs kL∞
kR̄obs kL∞

kIENG −Iobs kL1
kI¯obs kL1
∗
kISVD
−Iobs kL1

kI¯obs kL1

10−1

∗
kRSVD
−Robs kL∞
kR̄obs kL∞

10−1

∗
kRNMF
−Robs kL∞
kR̄obs kL∞

∗
kINMF
−Iobs kL1
kI¯obs kL1
∗
kIENG
−Iobs kL1
kI¯obs kL1

10−2
5

6

7

8

9

10

∗
kRENG
−Robs kL∞
kR̄obs kL∞

−2

5

10

6

7

8

9

10

(b) L∞ relative error of R vs n

(a) L1 relative error of I vs n

Figure 48: Forecasting errors of I and R (from T = 21/04)

kISVD −Iobs kL1
kI¯obs kL1

kRSVD −Robs kL∞
kR̄obs kL∞

10−1

kINMF −Iobs kL1
kI¯obs k 1

10−1

kRNMF −Robs kL∞
kR̄obs kL∞

L

kRENG −Robs kL∞
kR̄obs kL∞

kIENG −Iobs kL1
kI¯obs kL1

∗
kRSVD
−Robs kL∞
kR̄obs kL∞

∗
kISVD
−Iobs kL1
kI¯obs kL1

∗
kINMF
−Iobs kL1
kI¯obs kL1

∗
kRNMF
−Robs kL∞
kR̄obs kL∞

10−2

∗
kRENG
−Robs kL∞
kR̄obs kL∞

∗
kIENG
−Iobs kL1

kI¯obs kL1

5

6

7

8

9

5

10

6

7

∞

(b) L

(a) L1 relative error of I vs n

8

9

10

relative error of R vs n

Figure 49: Forecasting errors of I and R (from T = 05/05)
We observe that the quality of the forecast depends on the reduced basis but also strongly on
the starting day T from which the forecast is done. The forecasts using routine-βγ with SVD
and NMF are not accurate and most of the time exploding. When routine-IR is used with SVD
and NMF, the forecasts are more robust as there is no explosion of the error observed. Reduced
bases from ENG consistently lead to the the best forecast obtained using either routine-βγ and
routine-IR; by inspecting the error on figures 41 to 49 and the averaged forecasts obtained in
Section 4.2.1 we conclude that routine-βγ with ENG reduced bases provide slightly better
forecasts.

References
[1] Anastassopoulou, C., Russo, L., Tsakris, A. and Siettos, C. Data-based analysis, modelling
and forecasting of the COVID-19 outbreak. PloS one, 15(3), p. e0230405, 2020.
43

[2] Armocida, B., Formenti, B., Ussai, S., Palestra, F. and Missoni, E. The Italian health
system and the COVID-19 challenge. The Lancet Public Health, 5(5), p. e253, 2020.
[3] Atif, J., Cappé, O., Kazakçi, A., Léo, Y., Massoulié, L. and Mula, O. Initiative face au
virus Observations sur la mobilité pendant l’épidémie de Covid-19. Technical report, PSL
University, May 2020. URL https://hal.archives-ouvertes.fr/hal-02921194.
[4] Benner, P., Cohen, A., Ohlberger, M. and Willcox, K. Model Reduction and Approximation:
Theory and Algorithms, volume 15. SIAM, 2017.
[5] Binev, P., Cohen, A., Dahmen, W., DeVore, R., Petrova, G. and Wojtaszczyk, P. Convergence Rates for Greedy Algorithms in Reduced Basis Methods. SIAM Journal on Mathematical Analysis, 43(3), pp. 1457–1472, 2011. URL http://dx.doi.org/10.1137/100795772.
[6] Brauer, F. Mathematical epidemiology: Past, present, and future. Infectious Disease
Modelling, 2(2), pp. 113–127, 2017.
[7] Ceylan, Z. Estimation of COVID-19 prevalence in Italy, Spain, and France. Science of The
Total Environment, p. 138817, 2020.
[8] Cohen, A. and DeVore, R. Kolmogorov widths under holomorphic mappings. IMA Journal
of Numerical Analysis, 36(1), pp. 1–12, 2016. URL http://dx.doi.org/10.1093/imanum/
dru066.
[9] DeVore, R., Petrova, G. and Wojtaszczyk, P. Greedy algorithms for reduced bases in Banach
spaces. Constructive Approximation, 37(3), pp. 455–466, 2013.
[10] Di Domenico, L., Pullano, G., Sabbatini, C. E., Boëlle, P.-Y. and Colizza, V. Expected
impact of lockdown in Île-de-France and possible exit strategies. medRxiv, 2020.
[11] Fang, X., Liu, W., Ai, J., He, M., Wu, Y., Shi, Y., Shen, W. and Bao, C. Forecasting
incidence of infectious diarrhea using random forest in Jiangsu Province, China. BMC
Infectious Diseases, 20(1), pp. 1–8, 2020.
[12] Ferguson, N., Laydon, D., Nedjati Gilani, G., Imai, N., Ainslie, K., Baguelin, M., Bhatia, S., Boonyasiri, A., Cucunuba Perez, Z., Cuomo-Dannenburg, G. et al. Report 9:
Impact of non-pharmaceutical interventions (NPIs) to reduce COVID19 mortality and
healthcare demand. 2020. URL https://www.if.ufrgs.br/if/wp-content/uploads/
Imperial-College-COVID19-NPI-modelling-16-03-2020.pdf.
[13] Flaxman, S., Mishra, S., Gandy, A., Unwin, H. J. T., Mellan, T. A., Coupland, H.,
Whittaker, C., Zhu, H., Berah, T., Eaton, J. W. et al. Estimating the effects of nonpharmaceutical interventions on COVID-19 in Europe. Nature, 584(7820), pp. 257–261,
2020.
[14] Gillis, N. The why and how of nonnegative matrix factorization. Regularization, optimization, kernels, and support vector machines, 12(257), pp. 257–291, 2014.
[15] Hesthaven, J. S., Rozza, G. and Stamm, B. Certified reduced basis methods for parametrized
partial differential equations, volume 590. Springer, 2016.
[16] Keeling, M. J. and Rohani, P. Modeling infectious diseases in humans and animals. Princeton University Press, 2011.
44

[17] Kermack, W. O., McKendrick, A. G. and Walker, G. T. A contribution to the mathematical
theory of epidemics. Proceedings of the Royal Society of London. Series A, Containing
Papers of a Mathematical and Physical Character, 115(772), pp. 700–721, 1927. URL
http://dx.doi.org/10.1098/rspa.1927.0118.
[18] Liu, Z., Magal, P., Seydi, O. and Webb, G. A COVID-19 epidemic model with latency
period. Infectious Disease Modelling, 5, pp. 323–337, 2020.
[19] Liu, Z., Magal, P., Seydi, O. and Webb, G. Predicting the cumulative number of cases for
the COVID-19 epidemic in China from early data. arXiv preprint arXiv:2002.12298, 2020.
[20] Maday, Y., Mula, O. and Turinici, G. Convergence analysis of the Generalized Empirical
Interpolation Method. SIAM Journal on Numerical Analysis, 54(3), pp. 1713–1731, 2016.
URL http://dx.doi.org/10.1137/140978843.
[21] Maday, Y. and Patera, A. Reduced basis methods. In P. Benner, S. Grivet-Talocia, A. Quarteroni, G. Rozza, W. Schilders and L. Silveira (editors), Model Order Reduction, chapter 4,
pp. 139–179. De Gruyter, Oxford, 16 Dec. 2020.
[22] Magal, P. and Webb, G. Predicting the number of reported and unreported cases for the
COVID-19 epidemic in South Korea, Italy, France and Germany. Medrxiv, 2020. URL
https://doi.org/10.1101/2020.03.21.20040154.
[23] Martcheva, M. An introduction to mathematical epidemiology, volume 61. Springer, 2015.
[24] Mizumoto, K., Kagaya, K., Zarebski, A. and Chowell, G. Estimating the asymptomatic
proportion of coronavirus disease 2019 (COVID-19) cases on board the Diamond Princess
cruise ship, Yokohama, Japan, 2020. Eurosurveillance, 25(10), p. 2000180, 2020.
[25] Paatero, P. and Tapper, U. Positive matrix factorization: A non-negative factor model
with optimal utilization of error estimates of data values. Environmetrics, 5(2), pp. 111–
126, 1994. URL https://doi.org/10.1002/env.3170050203.
[26] Poncela, P., Rodríguez, J., Sánchez-Mangas, R. and Senra, E. Forecast combination through
dimension reduction techniques. International Journal of Forecasting, 27(2), pp. 224–237,
April 2011. URL https://ideas.repec.org/a/eee/intfor/v27yi2p224-237.html.
[27] Quarteroni, A., Manzoni, A. and Negri, F. Reduced basis methods for partial differential
equations: an introduction, volume 92. Springer, 2015.
[28] Roda, W. C., Varughese, M. B., Han, D. and Li, M. Y. Why is it difficult to accurately
predict the COVID-19 epidemic? Infectious Disease Modelling, 2020.
[29] Roques, L., Klein, E. K., Papaïx, J., Sar, A. and Soubeyrand, S. Impact of Lockdown on
the Epidemic Dynamics of COVID-19 in France. Frontiers in Medicine, 7, p. 274, 2020.

45

