arXiv:2006.06373v1 [stat.ME] 11 Jun 2020

The Limits to Learning an SIR Process: Granular
Forecasting for Covid-19

Jackie Baek
MIT
baek@mit.edu
Tianyi Peng
MIT
tianyi@mit.edu

Vivek F. Farias
MIT
vivekf@mit.edu

Andreea Georgescu
MIT
andreeag@mit.edu

Deeksha Sinha
MIT
deeksha.sinha7@gmail.com

Retsef Levi
MIT
retsef@mit.edu

Joshua Wilde
MIT
jtwilde@mit.edu

Andrew Zheng
MIT
atz@mit.edu

Abstract
A multitude of forecasting efforts have arisen to support management of the
ongoing COVID-19 epidemic. These efforts typically rely on a variant of the SIR
process [1] and have illustrated that building effective forecasts for an epidemic in
its early stages is challenging. This is perhaps surprising since these models rely
on a small number of parameters and typically provide an excellent retrospective
fit to the evolution of a disease. So motivated, we provide an analysis of the
limits to estimating an SIR process. We show that no unbiased estimator can
hope to learn this process until observing enough of the epidemic so that one
is approximately two-thirds of the way to reaching the peak for new infections.
Our analysis provides insight into a regularization strategy that permits effective
learning across simultaneously and asynchronously evolving epidemics. This
strategy has been used to produce accurate, granular predictions for the COVID-19
epidemic that has found large-scale practical application in a large US state.

1

Introduction

The so-called Susceptible-Infected-Recovered (SIR) model, proposed nearly a century ago [2],
remains a cornerstone for the forecasting of epidemics. In numerous retrospective studies the model
has been found to fit the trajectory of epidemics well, while simultaneously providing a meaningful
level of interpretability. As such, the plurality of models used for forecasting efforts related to the
COVID-19 epidemic are either SIR models or close cousins thereof. Surprisingly, the experience
with these forecasts has illustrated that predicting the cumulative number of cases (or peak number of
cases) in an epidemic, early in its course, is a challenging task.
Ultimately, this paper is motivated by producing high quality forecasts for the progression of epidemics such as COVID-19. However, we begin with a fundamental question that, despite the SIR
model’s prevalence, has apparently not been asked: What are the limits of learning in epidemic
models such as the SIR model? Surprisingly, we find that it is fundamentally difficult to predict
the cumulative number of infections (or the ‘peak’ of an infection) until quite late in an epidemic.
In particular, we show that no estimator can hope to learn these quantities until observing enough
of the epidemic so that one is approximately two-thirds of the way to reaching the peak for new
infections. As far as we can tell, this result is the first of its kind for epidemic modeling. We find
that this hardness is driven by uncertainty in the initial prevalence of the infection in the population,
which is not observable with incomplete testing and/ or asymptomatic patients. On the other hand, we
show that certain other important parameters in the SIR model – including the so-called reproduction
number and infectious period – are actually easy to learn.
Preprint. Under review.

Our analysis on the limits of learning above suggests a specific regularization approach that dramatically impacts forecast performance when learning across regions. In greater detail, we consider
a differentiable model, where the true infection curve is latent and follows SIR dynamics. The
observations are the results of limited testing, which censors the true infection curve, and deaths. Our
learning rate analysis suggests that by suitably ‘matching’ regions early in the epidemic to regions
that are further along, we can build useful estimators of initial disease prevalence in the former
regions. This matching is effectively enabled through a regularization strategy in our approach where
certain region specific random effect terms are regularized to zero.
We demonstrate that our approach allows us to learn granular epidemic models (essentially at the
level of individual counties) that are substantially more accurate than a highly referenced benchmark
[3]. As such, our model has found practical application in a large US state. Among other uses, the
forecasts inform decisions related to providing surge capacities in hospitals across the state; such
decisions necessitate a granular forecast.
Related Literature: Extant epidemiological models are typically compartmental models, of which
the SIR model [2] is perhaps the best known. The plurality of COVID-19 modeling efforts are
founded on SIR-type models, eg. [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]. Some of these efforts consider
generalizations to the SIR model that add additional states or ‘compartments’. For instance the
(retrospectively fit) model studied in [6] considers an eight state model (as opposed to three for the
vanilla SIR). Not surprisingly, learning gets harder with as the number of states increases [15].
Whereas the identifiability of the SIR model (in a deterministic sense) is well understood [16], this is
not the case for the natural stochastic variant of this model. Specifically, calibrating a vanilla SIR
model to data requires learning the so-called infectious period and basic reproduction rate. Both
these parameters are relatively easy to calibrate with limited data; this is supported both by the
present paper, but also commonly observed empirically; see for instance [15]. In addition to these
parameters, however, one needs to measure both the initial number of infected individuals and the
size of the susceptible population. Estimating the number of infected individuals poses a challenge
in the presence of limited testing and asymptomatic carriers. Indeed, epidemiological models for
COVID-19 typically assume that measured infections are some fraction of true infections; eg. [4, 6].
This challenge is closely related to that of measuring the true fraction of cases that lead to fatalities
(or the so-called Infection Fatality Rate) [17].
Our main theorem shows that having to learn the true initial prevalence of the infection presents
a fundamental difficulty to learning SIR models with limited data. Our theoretical results are
complemented by empirical findings in the literature, see [18, 19]. Our result is the first to characterize
the limits to learning an SIR process [1] and relies on a non-trivial application of the Cramer-Rao
bound.
Finally, on the empirical front, we compare the quality of our predictions to publicly available
predictions for the IHME model [3]: this highly publicized benchmark model has a large number
of forecast vintages concurrently available which makes possible an analysis of relative prediction
accuracy as a function of available data.

2

The Deterministic SIR Model and a Stochastic SIR Process

We begin by describing the deterministic SIR model. Let s(t), i(t) and r(t) be the size of the
susceptible, infected and recovered populations respectively, as observed at time t. The SIR model is
defined by the following system of ODEs, specified by the tuple of parameters (α, β, γ):
ds
s
di
s
dr
= −β
i,
=β
i − γi,
= γi.
(1)
dt
αN
dt
αN
dt
The rate of recovery is specified by γ > 0; 1/γ is frequently referred to as the infectious period.
β > 0 quantifies the rate of transmission; β/γ , R0 is also referred to as the basic reproduction
number. N is the total population (assumed known). The typical exposition of this model sets α = 1
corresponding to the setting where the infection is entirely observed. On the other hand, the quantity
α ∈ (0, 1] corresponds to the fraction of true infections we actually observe. The role of α is made
clear by the following Proposition:
Proposition 2.1. Let {(s0 (t), i0 (t), r0 (t)) : t ≥ 0} be a solution to (1) for parameters α =
1, β = β 0 , γ = γ 0 and initial conditions i(0) = i0 (0), s(0) = s0 (0). Then, for any α0 > 0,
2

{(α0 s0 (t), α0 i0 (t), α0 r0 (t)) : t ≥ 0} is a solution to (1) for parameters α = α0 , β = β 0 , γ = γ 0 and
i(0) = α0 i0 (0), s(0) = α0 s0 (0).
The SIR model described above is identifiable if i(t) is observable, and N is known. Specifically:
Proposition 2.2. Fix N , and let i(t) be observed over some open set in R+ . Then the parameters
(α, β, γ) are identifiable.
A self-contained proof follows immediately from the identity theorem; a more involved argument
based on identification results for non-linear systems can be found in [16].
Stochastic SIR Process: Of course, any real world model must incorporate noise, and we describe
next a natural continuous-time Markov chain variant of the deterministic model described above,
proposed by [1]. Specifically, the stochastic SIR process, {(S(t), I(t), R(t)) : t ≥ 0}, is a multivariate counting process, with RCLL paths, determined by the parameters (α, β, γ). The jumps in this
process occur at rate λ(t) (to be defined) and correspond either to a new observed infection (where
I(t) increments by one, and S(t) decrements by one) or to a new observed recovery (where I(t)
decrements by one, and R(t) increments by one). Let C(t) = I(t) + R(t) denote the cumulative
number of infections observed up to time t. Denote by tk the time of the kth jump, and let Tk be the
time between the k − 1st and kth jumps. Finally, let Ik , I(tk ), and similarly define Rk , Sk and Ck .
The SIR process is then completely specified by:


βSk−1
Ck − Ck−1 ∼ Bern
(2)
βSk−1 + αN γ



βSk−1
+ γ Ik−1 .
Tk ∼ Exp
(3)
αN
It is well known that solutions to the deterministic SIR model (1) provide a good approximation to
sample paths of the SIR process (described by (2), (3)) in the so-called fluid regime; see [20].
The next section analyzes the rate at which one may hope to learn the unknown parameters (α, β, γ)
as a function of k; our key result will illustrate that in large systems, α is substantially harder to learn
than β or γ. In fact, an approximation suggests that the time taken to learn this parameter accurately
will be approximately two-thirds of the time required to hit the peak for infections. In Section 4
we will consider a differentiable model inspired by the SIR process and show that a regularization
strategy motivated by our learning analysis yields material performance gains.

3

Limits to Learning

This section characterizes the rate at which one may hope to learn the parameters of a stochastic SIR
process, simply from observing the process.
Observations: Define the stopping time τ = inf{k : Ik = 0}; clearly τ is bounded. For clarity,
when k > τ , we define Ck = Ck−1 , Ik = 0, and Tk = ∞. We define the k-th information set
Ok = (I0 , R0 , T1 , C1 , . . . , Tk , Ck ) for all k ≥ 1. Note that Ik and Rk are deterministic given Ck , I0 ,
and R0 .
We next characterize a sequence of systems of increasing size. Specifically, consider a sequence
of SIR processes, indexed by n, such that αn Nn → ∞ while βn = β, γn = γ. Moreover, let
mn = o(αn Nn ) and β > γ. Finally, assume that In,0 , Rn,0 ≤ mn . Our main theorem characterizes
the Fisher information of Omn relative to αn as n grows large.
Theorem 3.1. Assume β > γ are known and In,0 ≥ D, where D is a constant that depends only on
β and γ. Then, the Fisher information of Omn relative to αn is


m3n
JOmn (αn ) = Θ
.
(4)
αn4 Nn2
Components of the proof of this result are provided in Section 3.1. Now since αn ∈ (0, 1] and
since all points in this interval are regular in the terminology of [21], we have by the constrained
Cramer-Rao bound (Lemma 4 in [21]):
3

Corollary 3.2 (Constrained Cramer-Rao Bound). Assume β > γ are known and In,0 ≥ D, where D
depends only on β and γ. Let α̂n be any unbiased estimator of αn based on the observations Omn .
Then,
 4 2
αn Nn
var(α̂n ) = Ω
.
(5)
m3n
Interpretation of Corollary 3.2: Now since we know (from the fluid model (1)) that cumulative
and peak infections scale with αn Nn , it is reasonable to require that var(α̂n ) scale like o(αn2 ). For
this, Corollary 3.2 shows that we require mn = ω((αn Nn )2/3 ) observations. How long might
this take relative to the point at which, say, the epidemic itself is past its peak? One way of
characterizing such a benchmark is comparing the time it takes to get to (αn Nn )2/3 observations
(call this time T1,n ) with the time taken for the instantaneous reproductive number for the epidemic
Rt , βγ Sn (t)/(αn Nn ) to fall below 1 (the expected increment in the infection process is negative

at times when Rt < 1); call this time T2,n . More precisely, T1,n = inf t : Cn (t) ≥ (αn Nn )2/3
and T2,n = inf {t : βSn (t)/(αn Nn ) < γ}. Unfortunately, characterizing either of these (random)
times exactly in the stochastic SIR process appears to be a difficult taskand so we consider analyzing
d
these times in the deterministic model, where we denote T1,n
= inf t : cn (t) ≥ (αn Nn )2/3 for
d
the process defined by (1) and similarly T2,n = inf {t : βsn (t)/(αn Nn ) < γ}. We have:
Proposition 3.3. If cn (0) = O(log(αn Nn )),
d
T1,n
2
≥ .
d
n→∞ T
3
2,n

lim

In summary, this suggests that the sampling requirements made precise by Corollary 3.2 can only be
met at such time where we are close to reaching the peak infection rate.
We next turn our attention to learning β and γ:
Theorem
q3.4. Assume β ∈ [0, βmax ], γ ∈ [0, γmax ]. Let Cn,0 , mn , αn , Nn satisfy mn (mn +Cn,0 ) ≤
α N −m −Cn,0

mn
β
n n
n
≤ 14 and β+γ
αn Nn , 5 log
mn
αn Nn
and γ̂mn , both functions of Omn , such that

β
> 12 ( β+γ
+ 12 ). Then, there exist estimators β̂mn

log mn
2
+ B1 βmax
e−B2 In,0 ,
mn
log mn
2
2
+ B1 γmax
e−B2 In,0 ,
E[(γ̂mn − γ)2 ] ≤ M2 βmax
mn
where B1 , B2 > 0 depend only on β and γ and M1 , M2 > 0 are absolute constants.
2
E[(β̂mn − β)2 ] ≤ M1 βmax

(6)
(7)

In stark contrast with Corollary 3.2, Theorem 3.4 shows that the variance in estimating β and γ grows
small as mn and In,0 grow, but is independent of αn and Nn . Consequently, to achieve any desired
level of accuracy, we simply need the number of events mn and the initial number of infections In,0
to exceed a constant that is independent of the size of the system Nn .
3.1

Proof of Theorem 3.1

β
Define p , 12 ( β+γ
+ 12 ) > 12 , and let Pn = αn Nn . We fix n large enough so that mn + C0 ≤
n −mn −C0 )
and β(Pβ(P
> p (this is possible since
n −mn −C0 )+Pn γ
subscript n henceforth.

β
β+γ

Pn
2

> p and mn = o(Pn )). We remove the

Define the indicator variable Ek = 1{τ > k} on the event which the SIR process has not terminated
after k jumps. The following lemma states that both Ek and Ik can be determined from Ck , I0 , and
R0 , which will allow us to decouple variables in Om in the analysis of the Fisher information. The
result follows from the definitions of τ , Ek , and Ck ; the details can be found in the Appendix.
0
Lemma 3.5. Define rk , I0 +k+2R
for all k ≥ 0. For all k, Ek = 1{Ck > rk }. Moreover, when
2
Ek = 1, Ik = 2Ck − k − I0 − 2R0 > 0.

The next lemma writes an exact expression for JOm (α).
4

Lemma 3.6. The Fisher information of the observations Om with respect to the parameter α is
#
"
m
2
X
N 2 Ck−1
Ek−1 = 1 .
JOm (α) =
(8)
Pr(Ek−1 = 1)E
P 2 (P − Ck−1 )((P − Ck−1 ) + βγ P )
k=1

Proof. We first define conditional Fisher information and state some known properties.
Definition 3.7. Suppose X, Y are random variables defined on the same probability space whose
∂
distributions depend on a parameter θ. Let gX|Y (x, y, θ) = ∂θ
log fX|Y ;θ (x|y)2 be the square of the
score of the conditional distribution of X given Y = y with parameter
θ evaluated
at x. Then, the


conditional Fisher information is defined as JX|Y (θ) = EX,Y gX|Y (X, Y, θ) .
Pn
Property 3.8. JX1 ,...,Xn (θ) = JX1 (θ) + i=2 JXi |X1 ,...,Xi−1 (θ).
Property 3.9. If X is independent of Z conditioned on Y , JX|Y,Z (θ) = JX|Y (θ).
Property 3.10. If X is deterministic given Y = y, gX|Y (X, y, θ) = 0.
dθ 2
) .
Property 3.11. If θ(η) is a continuously differentiable function of η, JX (η) = JX (θ(η))( dη

Since I0 and R0 are known and not random, the Fisher information of Om is equal to the Fisher
information of (T1 , C1 , T2 , C2 , . . . , Tm , Cm ). Then, Property 3.8 implies
JOm (α) = JT1 (α) + JC1 |T1 (α) + JT2 |T1 ,C1 (α) + JC2 |T1 ,C1 ,T2 (α) + · · · + JCM |T1 ,C1 ,...,Tm (α).
Note that for any k, Ck and Tk only depend on Ck−1 . Indeed, since Ck−1 determines Ek−1 , if
Ek−1 = 0 (the stopping time has passed), then Ck = Ck−1 and Tk = ∞. When Ek−1 = 1, the
distributions of Ck and Tk are given in (2)-(3). Since β, γ, I0 , R0 are known, Sk−1 = P − Ck−1 ,
and Ik−1 can be determined from Ck−1 (Lemma 3.5), the distributions of Ck and Tk are determined
by Ck−1 . Therefore, we use Property 3.9 to simplify the above equation to
JOm (α) =

m
X

(JCk |Ck−1 (α) + JTk |Ck−1 (α)),

k=1

where we used JT1 (α) = JT1 |C0 (α), JC1 (α) = JC1 |C0 (α). Moreover, when Ek−1 = 0, Ck and
Tk are deterministic conditioned on Ck−1 , which implies the score in this case is 0 (Property 3.10).
Therefore, we can condition on Ek−1 = 1 to write
JOm (α) =

m
X

E[gCk |Ck−1 (Ck , Ck−1 , α) + gTk |Ck−1 (Tk , Ck−1 , α)|Ek−1 = 1] Pr(Ek−1 = 1).

k=1

The last step is to evaluate gCk |Ck−1 (Ck , Ck−1 , α) and gTk |Ck−1 (Tk , Ck−1 , α). When Ek−1 = 1, the
distributions of Ck and Tk conditioned on Ck−1 have a simple form provided in (2)-(3). Property 3.11
allows for straight-forward calculations, resulting in (8). See Appendix for details of this last step.
Proof of Theorem 3.1. We show both upper and lower bounds for JOm (α) starting from Equation
(8). For the upper bound, we have that Ck ≤ k + I0 + R0 by definition. Since I0 , R0 ≤ m by
assumption, Ck ≤ 3m. Moreover, by assumption, Ck ≤ m + C0 ≤ P2 . Plugging these into (8)
results in
m−1
X
N 2 (3m)2
m3
JOm (α) ≤
Pr(Ek−1 = 1) 2
≤ H1 4 2 ,
γ
1
1
α N
P (P − 2 P )((P − 2 P ) + β P )
k=0

for a constant H1 . For the lower bound, we first prove a lower bound for Pr(Em = 1).
Lemma 3.12. There exists a constant D that only depends on β and γ such that if
p and I0 ≥ D, then Pr(Em = 1) ≥ 12 .

β(P −m−C0 )
β(P −m−C0 )+P γ

>

This result relies on an interesting stochastic dominance argument and can be found in the Appendix.
3
1
Then, similarly to the upper bound, JOm (α) ≥ H2 αm
4 N 2 follows from using Pr(Em = 1) ≥ 2 and
the fact that Ck ≥ k+I02+2R0 when Ek = 1 (Lemma 3.5). Combining the upper and lower bounds
finish the proof.
5

4

Forecasting in the real world

This section describes a practical SIR model that can incorporate a number of real-world features and
datasets. We then consider an approximation to the MLE estimate for this model. Finally we propose
an approach to overcome the difficulty in learning α. We present comprehensive experimental results
at a ‘regional’ granularity (essentially close to county level) that illustrate strong relative merits.
Discrete-time SIR Recall the stochastic SIR process, {(S(t), I(t), R(t)) : t ≥ 0}, a multi-variate
counting process determined by parameters (α, β, γ). We now allow β to be time-varying, yielding
a counting process with jumps Ck − Ck−1 ∼ Bern {βSk−1 /(βk Sk−1 + αN γ)} and rate λ(t) =
(β(t)S(t)/αN + γ) I(t). We obtain discrete-time SIR processes, {(Si [t], Ii [t], Ri [t]) : t ∈ N} for
regions i ∈ I by considering the Euler-approximation to this counting process (e.g. [22]). Specifically,
let ∆I[t] = I[t]−I[t−1], and define ∆S[t] and ∆R[t] analogously. The discrete-time approximation
to the SIR process is then given by:
S
∆Si [t + 1] = −βi [t](Si [t]/αi Ni )Ii [t] + νi,t
I
∆Ii [t + 1] = βi [t](Si [t]/αi Ni )Ii [t] − γIi [t] + νi,t
R
∆Ri [t + 1] = γIi [t] + νi,t
S
I
R
where {νi,t
}, {νi,t
}, {νi,t
} are appropriately defined martingale difference sequences.

Model Parameters and Covariates For each region i, the observability parameter αi and reproduction factor {βi [t] : t ∈ N} must be learned from data, but we assume the total population Ni
and recovery rate γ are known (a typical assumption; for COVID-19, γ ∼ 1/4). Demographic and
mobility factors influence the reproduction rate of the disease. To model these effects, we estimate
βi [t] as a mixed effects model incorporating these covariates: βi [t] = exp(Xi [t]> θ) + i , where
Xi [t] = (Zi , Mi [t]) ∈ Rd1 +d2 is a set of observed covariates for region i partitioned into static
Zi ∈ Rd1 and time-varying Mi (t) ∈ Rd2 . We estimate the parameters i , representing stationary
per-region random effects, and θ ∈ Rd1 +d2 , a vector of fixed effects shared across regions.
4.1

Learning and a Differentiable Model

In the real world, the SIR model is a latent process – we never directly observe any of the state
variables Si [t], Ii [t], Ri [t]. Instead, we observe Ci [t] = Ii [t] + Ri [t] = αi Ni − Si [t]. Note that other
processes (deaths, hospitalizations, etc.) that depend on the latent state may also be observable, and
can easily be incorporated
into this learning scheme. The MLE problem for parameters (θ, α, ) is
P
simply max(θ,α,) i,t log P (Ci [t]|θ, α, ).
This is a difficult non-linear filtering problem (and an interesting direction for research). We therefore
consider an approximation: Denote by {(si [t], ii [t], ri [t]) : t ∈ N} the deterministic process obtained
by ignoring the martingale difference terms in the definition of the discrete time SIR process. We
consider the approximation
Ci [t] = αi Ni − Si [t] ∼ (αi Ni − si [t])ωi [t]
where ωi [t] is log-normally distributed with mean 1 and variance exp(σ 2 ) − 1. Under this approximation, the MLE problem is now transformed to
X
2
min
(log Ci [t] − log (αi Ni − si [t]))
(9)
(θ,α,)

i,t

which constitutes a differentiable model. We solve (9), (or a weighted version) using Adam [23].1
Working around the limits to learning Theorem 3.4 asserts that β is easy to learn via MLE,
suggesting that the parameters θ, {i } underlying our model of β can be estimated as well. However,
Corollary 3.2 illustrates that we cannot estimate {αi } in reasonable time or accuracy from infections
alone. This necessitates augmenting the estimation problem (9) with auxiliary information. We
1

Adam was run for 20k iterations, with learning rate tuned over a coarse grid. A weighted version of the loss
function in (9) with weights for (i, t)th observation set to Ci [t] worked well.

6

propose to take advantage of heterogeneity across regions: infection curves start at different times
in each region, and we typically have access to some set P [t] ⊆ I of regions that have already
experienced enough infections to reliably estimate αi for i ∈ P [t] via MLE. At a high level, our
strategy will be to identify the set P [t], estimate αi for i ∈ P [t], then extrapolate these estimates to
obtain αi for i ∈
/ P [t]. We define the set
P [t] = {i ∈ I : Ci [t] − Ci [t − 1] ≤ −γ1 max (Ci [τ ] − Ci [τ − 1])}
τ ≤t

(10)

where γ1 is a hyperparameter. In the fluid model this identifies the first time t where d2 s(t)/dt2 < 0.
We expect αi to vary across regions due to different demographics (that impact asymptomatic rates)
and testing policies. Given a set of parameters {α̃i : i ∈ P [t]} estimated via MLE, a natural approach
to estimate αi for regions i ∈
/ P [t] is by matching to regions in P [t] with similar covariates. It is also
worth noting that since in large systems in the fluid regime, we may show that Ci (t)/Ni → αi as
t → ∞, we also enforce αi ≥ Ci [t]/Ni .
Overall Learning Algorithm (‘Two-Stage’) So motivated, given data up to time T , we now define
our overall learning algorithm ‘Two-Stage’, as follows:

exp(φ> Zi + δi ),
if i ∈ P [T ]

αi =
max exp(φ> Zi ), γ2 Ci [T ]/Ni , otherwise
where γ2 is a hyper-parameter and δi are region specific random effect terms. We then estimate the
model parameters (θ, φ, δ, ) by minimizing the following specialization of (9):
X
2
min
(log Ci [t] − log (αi (φ, δi ) Ni − si [t]))
(11)
(θ,φ,δ,)

i,t

The hyper-parameters γ1 , γ2 and the learning rates are tuned via cross-validation.
4.2

Experimental results

We use our estimates to forecast cumulative infections in the US at the level of sub-state ‘regions’,
corresponding broadly to public health service areas. The median state has seven regions. The static
covariates Zi for each region i comprise of 60 demographic features from multiple data providers,
ranging from socio-economic to health indicators. The time varying covariates Mi (t) correspond to
mobility data inferred from aggregated cell phone data. All datasets are widely available and are in
active use in other models. The Appendix provides a detailed description of these covariates.
This section focuses on two goals: First, we perform an ablation study focused on the impact of
assumed structure on the parameter αi . This allows us to understand whether and why optimizing
(11) provides improved performance. Second, and perhaps more importantly, our overall goal was
simply to produce accurate forecasts; here we compare the performance of our approach to published
forecast performance for the most broadly cited forecaster for COVID-19, [3].
The impact of learning α: We compare four approaches to learning α: Default: Ignoring the
modeling of α altogether by setting αi = 1 ∀i ∈ I (the ‘default’ SIR choice); MLE: Learn αi for
each region via the MLE approximation (9); Two-Stage: The two-stage approach specified by (11);
and Idealized: Using a value of α computed in-sample (i.e. by looking into the future) via (9).
Figure 1 shows weighted mean absolute percentage error (WMAPE) over regions, with weights
proportional to infections on May 21, 2020, for two metrics relevant to decision making: cumulative
infections by May 21, 2020 and maximum daily infections, for regions that have peaked by May 21,
2020. Model vintages vary along the x-axis so that moving from left to right models are trained on
data approaching the target date of May 21.
Default fails, with a WMAPE over 70% even on May 21 (an in-sample fit).2 At the other extreme,
Idealized exhibits consistently low error even for early model vintages. This bears out the prediction
of Theorem 3.4: given α, β is easy to learn even early in the infection with few samples. MLE
performs poorly until close to the target date of May 21 at which point sufficient data is available to
learn α. This empirically illustrates the difficult of learning α, as described in Corollary 3.2.
2

We do not show this model in Figure 1 as the WMAPEs are substantially larger than the scale shown.

7

Cum. Cases

Peak Cases
250%

40.0%

200%

WMAPE

30.0%
150%
20.0%
100%
10.0%

50%

Apr 27

May 04

May 11

0%

May 18

Apr 27

May 04

May 11

May 18

Model Vintage
Ideal alpha

MLE

Two-Stage

Figure 1: Prediction errors by model vintage, for regions that have peaked by May 21, 2020. Colors
denote different approaches to learning αi .

Not Yet Peaked

Peaked

1e-01

1e-02

+0
0
1e

-0
1
1e

-0
2
1e

-0
3
1e

+0
1e 0
-0
4

1e

-0
1
1e

-0
2
1e

1e

1e

-0
3

1e-03

-0
4

α for May 21, 2020 vintage

1e+00

α for April 21, 2020 vintage
MLE

Two-Stage

Figure 2: α estimated on May 21 vs. April 21. Size indicates cumulative cases on May 21. MLE
underestimates α in non-peaked regions (i.e. with limited data). Two-Stage does not.

Turning to our proposed approach, we see that Two-Stage significantly outperforms MLE far away
from the test date. Close to the test date the two approaches are comparable. For maximum daily
infections – perhaps the most critical metric for capacity planning – MLE drastically underperforms
Two-Stage far from the test date. Our approach to learning from peaked regions significantly mitigates
the difficulty of learning α. As further evidence, Figure 2 shows how well α from the April 21 vintage
predicts α in the final May 21 vintage, for regions that have peaked by May 21. As Proposition 3.3
predicts, the April 21 α are close to the May 21 α values for peaked regions, in both MLE and
Two-Stage models. For non-peaked regions, the April 21 MLE α estimates vary much more than the
Two-Stage estimates, and tend to underestimate the true α value.

Overall model performance Finally, we compare our analyzed models to the widely used IHME
model [3]. Figure 3 compares state-level3 WMAPE for MLE, Two-Stage and IHME models, for
vintages stretching back 28 days. The IHME model is, in effect, an SI model with carefully tuned
parameters. We report published IHME forecasts; 10 vintages of that model were reported between
April 21 and May 21. Two Stage dominates IHME across all model vintages.

3

Due to IHME only providing state-level predictions. Additionally IHME only offers deaths predictions for
these vintages; we show WMAPE on deaths for IHME and WMAPE on infections for MLE and Two-Stage.

8

40.0%

WMAPE

30.0%

20.0%

10.0%

Apr 20

Apr 27

May 04

May 11

May 18

Model Vintage
IHME

MLE

Two-Stage

Figure 3: WMAPE for predicting state-level cumulative cases on May 21, 2020, comparing MLE
and the Two-Stage approach against IHME.

Broader Impact
In contrast with the plurality of available forecast models (which make predictions at the level
of a state), the models we construct here are at a much finer level of granularity (essentially, the
county) and provide accurate predictions early in an epidemic. As a result our models can guide
the deployment of resources in states with heterogeneity in resource availability and prevalence.
The model was deployed in such an operational fashion in a large US state, where it was used to
proactively place hospital resources (mobile surge capacity) in areas where we anticipated large peaks
in infections. Many of these predictions were proven accurate and timely in hindsight. This would
not be possible with a state-level forecast (let alone a forecast with limited predictive power). While
not every state was able to make such data driven decisions in resource deployment, we believe that
in the event of a second outbreak, the approach we develop here can serve this need broadly.

Acknowledgements
The authors express their gratitude to Danial Mirza, Suzana Iacob, El Ghali Zerhouni, Neil Sanjay
Pendse, Shen Chen, Celia Escribe and Jonathan Amar for their excellent support in data collection
and organization.

References
[1] MS Bartlett. Some evolutionary stochastic processes. Journal of the Royal Statistical Society.
Series B (Methodological), 11(2):211–229, 1949.
[2] William Ogilvy Kermack and Anderson G McKendrick. A contribution to the mathematical
theory of epidemics. Proceedings of the royal society of london. Series A, Containing papers of
a mathematical and physical character, 115(772):700–721, 1927.
[3] IHME, 2020. http://www.healthdata.org/sites/default/files/files/Projects/
COVID/RA_COVID-forecasting-USA-EEA_042120.pdf.
[4] Giuseppe C Calafiore, Carlo Novara, and Corrado Possieri. A modified sir model for the
covid-19 contagion in italy. arXiv preprint arXiv:2003.14391, 2020.
[5] Giuseppe Gaeta. A simple sir model with a large set of asymptomatic infectives. arXiv preprint
arXiv:2003.08720, 2020.
[6] Giulia Giordano, Franco Blanchini, Raffaele Bruno, Patrizio Colaneri, Alessandro Di Filippo,
Angela Di Matteo, and Marta Colaneri. Modelling the covid-19 epidemic and implementation
of population-wide interventions in italy. Nature Medicine, pages 1–6, 2020.
[7] FA Binti Hamzah, C Lau, H Nazri, DV Ligot, G Lee, CL Tan, et al. Coronatracker: world-wide
covid-19 outbreak data analysis and prediction. Bull World Health Organ. E-pub, 19, 2020.
[8] Adam J Kucharski, Timothy W Russell, Charlie Diamond, Yang Liu, John Edmunds, Sebastian
Funk, Rosalind M Eggo, Fiona Sun, Mark Jit, James D Munday, et al. Early dynamics of
9

transmission and control of covid-19: a mathematical modelling study. The lancet infectious
diseases, 2020.
[9] Joseph T Wu, Kathy Leung, and Gabriel M Leung. Nowcasting and forecasting the potential
domestic and international spread of the 2019-ncov outbreak originating in wuhan, china: a
modelling study. The Lancet, 395(10225):689–697, 2020.
[10] Cleo Anastassopoulou, Lucia Russo, Athanasios Tsakris, and Constantinos Siettos. Data-based
analysis, modelling and forecasting of the covid-19 outbreak. PloS one, 15(3):e0230405, 2020.
[11] Kathakali Biswas, Abdul Khaleque, and Parongama Sen. Covid-19 spread: Reproduction of
data and prediction using a sir model on euclidean network. arXiv preprint arXiv:2003.07063,
2020.
[12] Maria Chikina and Wesley Pegden. Modeling strict age-targeted mitigation strategies for
covid-19. arXiv preprint arXiv:2004.04144, 2020.
[13] Clément Massonnaud, Jonathan Roux, and Pascal Crépey. Covid-19: Forecasting short term
hospital needs in france. medRxiv, 2020.
[14] Rahul Goel and Rajesh Sharma. Mobility based sir model for pandemics–with case study of
covid-19. arXiv preprint arXiv:2004.13015, 2020.
[15] Kimberlyn Roosa and Gerardo Chowell. Assessing parameter identifiability in compartmental
dynamic models using a computational approach: application to infectious disease transmission
models. Theoretical Biology and Medical Modelling, 16(1):1, 2019.
[16] Neil D Evans, Lisa J White, Michael J Chapman, Keith R Godfrey, and Michael J Chappell.
The structural identifiability of the susceptible infected recovered model with seasonal forcing.
Mathematical biosciences, 194(2):175–197, 2005.
[17] Anirban Basu. Estimating the infection fatality rate among symptomatic covid-19 cases in the
united states: Study estimates the covid-19 infection fatality rate at the us county level. Health
Affairs, pages 10–1377, 2020.
[18] Gerardo Chowell. Fitting dynamic models to epidemic outbreaks with quantified uncertainty: a
primer for parameter uncertainty, identifiability, and forecasts. Infectious Disease Modelling,
2(3):379–398, 2017.
[19] Alex Capaldi, Samuel Behrend, Benjamin Berman, Jason Smith, Justin Wright, and Alun L
Lloyd. Parameter estimation and uncertainty quantication for an epidemic model. Mathematical
biosciences and engineering, page 553, 2012.
[20] RWR Darling, James R Norris, et al. Differential equation approximations for markov chains.
Probability surveys, 5:37–79, 2008.
[21] John D Gorman and Alfred O Hero. Lower bounds for parametric estimation with constraints.
IEEE Transactions on Information Theory, 36(6):1285–1301, 1990.
[22] Jean Jacod, Thomas G Kurtz, Sylvie Méléard, and Philip Protter. The approximate euler method
for lévy driven stochastic differential equations. In Annales de l’IHP Probabilités et statistiques,
volume 41, pages 523–558, 2005.
[23] Adam: A method for stochastic optimization. arXiv preprint arXiv:1412.6980, 2014.
[24] Svante Janson. Tail bounds for sums of geometric and exponential variables. Statistics &
Probability Letters, 135:1–6, 2018.
[25] Joel C Miller. Mathematical models of sir disease spread with combined non-sexual and sexual
transmission routes. Infectious Disease Modelling, 2(1):35–55, 2017.
[26] Joel C Miller. A note on the derivation of epidemic final sizes. Bulletin of mathematical biology,
74(9):2125–2141, 2012.
[27] Ensheng Dong, Hongru Du, and Lauren Gardner. An interactive web-based dashboard to track
covid-19 in real time. The Lancet infectious diseases, 20(5):533–534, 2020.
[28] Safegraph Social Distancing Metrics, 2020.
social-distancing-metrics.

https://docs.safegraph.com/docs/

[29] University of Michigan Health and Retirement Study, 2020. https://hrs.isr.umich.edu/
data-products.
10

[30] Claritas, 2020. https://www.claritas.com/.
[31] CDC Interactive Atlas of Heart Disease and Stroke, 2020. https://www.cdc.gov/dhdsp/
maps/atlas/index.htm.
[32] CDC Social Vulnerability Index, 2020. https://svi.cdc.gov/.

11

Appendices
Appendices A and B contain the proofs of Theorems 3.1 and 3.4 respectively. Appendix C contains
the proofs of Propositions 2.1, 2.2, and 3.3, each in their own subsections. Appendix D contains a
result justfying the use of (10) as a sufficient condition in reliably estimating α. Appendix E contains
a description of the covariates used in the practical SIR model.

A

Proof of Theorem 3.1

We finish the sections of the proof that were not included in the main paper. This includes the proof
of Lemma 3.5, Lemma 3.12, and calcuations for Lemma 3.6.


−Ck−1 )
β(αN −Ck−1 )
We define λ(α, k − 1, Ck−1 ) = β(αNαN
+ γ Ik−1 and η(α, Ck−1 ) = β(αN
−Ck−1 )+αN γ .
Thus, for k ≤ τ , λ(N, k − 1, Ck−1 ) is the mean of the k-th inter-arrival time and η(α, Ck−1 ) is the
probability that the arrival in the k-th instance is a new infection rather than a recovery.
A.1

Proof of Lemma 3.5

Proof. Suppose k < τ i.e Ek = 1. Then, k is equal to total number of jumps that have occurred so
far (the number of movements from S to I and from I to R). The number of individuals that have
moved from S to I is Ck − I0 − R0 , and the number of movements from I to R is Ck − Ik − R0 .
Therefore, k = 2Ck − I0 − Ik − 2R0 . Since Ik > 0, Ck > rk .
Suppose k ≥ τ i.e Ek = 0. Then, k is greater than or equal to the total number of jumps, which is
still equal to 2Ck − I0 − Ik − 2R0 . Hence Ck ≤ rk in this case.

A.2

Proof of Lemma 3.12
iid

Proof. Let Xk ∼ Bern(p) for k = 1, 2, . . . . Let {Ak : k ≥ 0} be a stochastic process defined by:

C 0
Ak = C0 + X1 + · · · + Xk

Ak−1

if k = 0
if Ai > ri ∀i < k
otherwise.

(12)

Let τA = min{k : Ak ≤ rk } be the “stopping time” of this process.

Claim A.1. Pr(τ ≤ m) ≤ Pr(τA ≤ m).

The proof of this claim involves showing the process {Ak } is stochastically less than {Ck }; the proof
can be found in Section A.2.1. We now upper bound Pr(τA ≤ m). τA ≤ m if and only if Ak ≤ rk
for some k ≤ m. Before this happens, Ak = C0 + X1 + · · · + Xk . Therefore, if τA ≤ m, it must be
that C0 + X1 + · · · + Xk ≤ k+I02+2R0 for some k ≤ m.
m
X



k + I0 + 2R0
Pr(τA ≤ m) ≤
Pr C0 + X1 + · · · + Xk ≤
2
k=1



m
X
2pk − k + I0
=
Pr X1 + · · · + Xk < pk 1 −
.
2pk
k=1

12

(13)
(14)

Pk
Since E[X1 + · · · + Xk ] = pk, using the Chernoff bound (multiplicative form: Pr( i=1 Xi ≤
(1 − δ)µ) ≤ exp(−δ 2 µ/2)) gives


2 !
m
X
pk
1
I0
Pr(τA ≤ m) ≤
exp −
1−
+
(15)
2
2p
2pk
k=1
!

2


m
X
1
I0
1
I02
pk
(16)
=
1−
−
1−
−
exp −
2
2p
2
2p
8pk
k=1

2

!
m
X
pk
1
I0
1
≤
exp −
1−
−
1−
(17)
2
2p
2
2p
k=1
 
 X

2 !
m
1
1
1
pk
≤ exp −
−
I0
1−
exp −
(18)
2 4p
2
2p
k=1

≤ B1 exp(−B2 I0 ),


2 
P∞
pk
1
for constants B1 = k=1 exp − 2 1 − 2p
, B2 =

(19)
1
2

−

1
4p

> 0. (B1 is a constant since

it is a geometric series with a ratio smaller than 1, since p > 1/2.) Let D be the solution to
B1 exp(−B2 D) = 12 . Then, if I0 ≥ D, Pr(Em ) = 1 − Pr(τ ≤ m) ≥ 1 − Pr(τA ≤ m) ≥ 21 .

A.2.1

Proof of Claim B.5.

Definition A.2. For scalar random variables X, Y , we say that X is stochastically less than Y
(written X ≤st Y ) if for all t ∈ R,
Pr(X > t) ≤ Pr(Y > t).

(20)

For random vectors X, Y ∈ Rn we say that X ≤st Y if for all increasing functions φ : Rn → R,
φ(X1 , . . . , Xn ) ≤st φ(Y1 , . . . , Yn ).

(21)

We make use of the following known result for establishing stochastic order for stochastic processes.
Theorem A.3 (Veinott 1965). Suppose X1 , . . . , Xn , Y1 , . . . , Yn are random variables such that
X1 ≤st Y1 and for any x ≤ y,
(Xk |X1 = x1 , . . . , Xk−1 = xk−1 ) ≤st (Yk |Y1 = y1 , . . . , Yk−1 = yk−1 )

(22)

for every 2 ≤ k ≤ n. Then, (X1 , . . . , Xn ) ≤st (Y1 , . . . , Yn ).
−m−C0 )
Proof of Claim B.5. Because of the condition β(Pβ(P
−m−C0 )+P γ > p, for k ≤ m and k ≤ τ ,
Ck − Ck−1 ∼ Bern(q) for q > p. First, we show (A0 , A1 , . . . , Am ) ≤st (C0 , C1 , . . . , Cm ) using Theorem A.3. C0 ≤st A0 since C0 = A0 = I0 . We condition on Ak−1 = x and Ck−1 = y for
x ≤ y, and we must show Ak ≤st Ck . (We do not need to condition on all past variables since the
both processes are Markov.) If x ≤ rk−1 , then Ak = Ak−1 = x ≤ y = Ck−1 ≤ Ck . Otherwise,
the process Ak has not stopped, and neither has Ck since y ≥ x. Then, Ak ∼ x + Bern(p) and
Ck ∼ y + Bern(q) for some q ≥ p. Clearly, Ak ≤st Ck in this case. We apply Theorem A.3, which
implies Am ≤st Cm .

Define the function u : Rm+1 → {0, 1}, u(x0 , x1 , . . . , xm ) = 1{∪m
k=1 {xk ≤ rk }}. Then,
u(A0 , A1 , . . . , Am ) = 1 if and only if τA ≤ m, and u(C0 , C1 , . . . , Cm ) = 1 if and only if
τ ≤ m. u is a decreasing function. Therefore, u(A0 , A1 , . . . , Am ) ≥st u(C0 , C1 , . . . , Cm ). Then,
Pr(τ ≤ m) = Pr(u(C0 , C1 , . . . , Cm ) ≥ 1) ≤ Pr(u(A0 , A1 , . . . , Am ) ≥ 1) = Pr(τA ≤ m) as
desired.
13

A.3

Calculations for Lemma 3.6

Derivation of ECk [gCk |Ck−1 (Ck , Ck−1 , α)|Ek−1 = 1]. When Ek−1 = 1, we have Ck ∼ Ck−1 +
Bern(η(α, Ck−1 )). Therefore, ECk [gCk |Ck−1 (Ck , Ck−1 , α)|Ek−1 = 1] = JCk ∼Bern(η(α,Ck−1 )) (α).
We reparameterize to write the Fisher information as:

2
∂
(23)
ECk [gCk |Ck−1 (Ck , Ck−1 , α)|Ek−1 = 1] = JCk ∼Bern(η) (η)
η(α, Ck−1 )
∂α

2
1
∂
=
(24)
η(α, Ck−1 ) .
η(1 − η) ∂α
Use η(α, Ck−1 ) =

β(αN −Ck−1 )
β(αN −Ck−1 )+αN γ

to derive

∂
βN (β(αN − Ck−1 ) + γαN ) − βN (αN − Ck−1 )(β + γ)
η(α, Ck−1 ) =
∂α
(βN (αN − Ck−1 ) + γαN )2
βN γCk−1
=
.
(β(αN − Ck−1 ) + γαN )2
Also,

1
η(1−η)

=

(25)
(26)

(β(αN −Ck−1 )+αN γ)2
(αN −Ck−1 )βαN γ .

Substituting,
ECk [gCk |Ck−1 (Ck , Ck−1 , α)|Ek−1

(β(αN − Ck−1 ) + αN γ)2
= 1] =
β(αN − Ck−1 )αN γ



βN γCk−1
(β(αN − Ck−1 ) + γαN )2
(27)

2
βN γCk−1
α(αN − Ck−1 )(β(αN − Ck−1 ) + αN γ)2
2
βN 2 γCk−1
.
=
P (P − Ck−1 )(β(P − Ck−1 ) + P γ)2

=

(28)
(29)

Derivation of ETk [gTk |Ck−1 (Tk , Ck−1 , α)|Ek−1 = 1]. Similarly, conditioned on Ek−1 = 1, Tk ∼
Exp(λ(α, k−1, Ck−1 )). Therefore, ETk [gTk |Ck−1 (Tk , Ck−1 , α)] = JTk ∼Exp(λ(α,k−1,Ck−1 )) (α). We
reparameterize to write
2

∂
ETk [gTk |Ck−1 (Tk , Ck−1 , α)] = JTk ∼Exp(λ) (λ)
λ(α, k − 1, Ck−1 )
(30)
∂α

2
1
∂
= 2
λ(α, k − 1, Ck−1 ) .
(31)
λ
∂α
−Ck−1 )
+ γ)(2Ck−1 − (k − 1) − I0 − 2R0 ) to derive
Use λ(α, k − 1, Ck−1 ) = ( β(αNαN

∂
N βCk−1 (2Ck−1 − (k − 1) − I0 − 2R0 )
λ(α, k − 1, Ck−1 ) =
∂α
α2 N 2
αN
1
=
.
λ(α, k − 1, Ck−1 )
(β(αN − Ck−1 ) + γαN )(2Ck−1 − (k − 1) − I0 − 2R0 )

(32)
(33)

Substituting,


βN Ck−1
ETk [gTk |Ck−1 (Tk , Ck−1 , α)] =
αN (β(αN − Ck−1 ) + γαN )

2
βN Ck−1
=
P (β(P − Ck−1 ) + γP )
Derivation
of
JOm (α).
Using
ECk [gCk |Ck−1 (Ck , Ck−1 , α)|Ek−1 = 1] and

the

14

expressions

2

derived

(34)
(35)
above

for

2

ETk [gTk |Ck−1 (Tk , Ck−1 , α)], we get
ECk [gCk |Ck−1 (Ck , Ck−1 , α)|Ek−1 = 1] + ETk [gTk |Ck−1 (Tk , Ck−1 , α)]

2
2
βN 2 γCk−1
βN Ck−1
+
=
P (P − Ck−1 )(β(P − Ck−1 ) + P γ)2
P (β(P − Ck−1 ) + γP )
2
N 2 Ck−1
= 2
P (P − Ck−1 )((P − Ck−1 ) + βγ P )
Thus,
JOm (α) =
=

m
X
k=1
m
X
k=1

B

E[gCk |Ck−1 (Ck , Ck−1 , α) + gTk |Ck−1 (Tk , Ck−1 , α)|Ek−1 = 1] Pr(Ek−1 = 1)
#
2
N 2 Ck−1
Ek−1 = 1 Pr(Ek−1 = 1).
E
P 2 (P − Ck−1 )((P − Ck−1 ) + βγ P )
"

Proof of Theorem 3.4

Fix an instance in which the assumptions of the theorem statement hold. We remove the subscript n,
β
β
−C0
and let P = αN . Let p , 12 ( β+γ
be an estimator for β+γ
, B̂ = S̃mm be
+ 12 ) > 12 . Let Â = Cmm
P
min(m,τ )
1
an estimator for β+γ
for S̃m = k=1
Ik−1 Tk . Let β̂ = Â/B̂ and γ̂ = 1/B̂ − β̂.
This first lemma follows from (19) of the proof of Lemma 3.12.
β P −m−C0
Lemma B.1. If β+γ
> p, Pr(τ < m) ≤ B1 e−B2 I0 , where B1 , B2 > 0 are constant that
P
depend only on β and γ.

The next two lemmas give a high probability confidence bound for estimators Â and B̂.
β P −m−C0
Lemma B.2. For any m, I0 where β+γ
> 12 , for any δ > 0,
P




Cm − C0
β
P − m − C0
β
Pr
∈
/
(1 − δ)
,
(1 + δ) , τ ≥ m ≤ 2 exp(−mδ 2 /(4 + 2δ)).
m
β+γ
P
β+γ
(36)
Pmin(m,τ )
Lemma B.3. Let S̃m = k=1
Ik−1 Tk . Then
!
P −m−C0
(1 − δ) (1 + δ)
P
S̃m
∈
/[
,
(37)
], τ ≥ m ≤ 2e−m P (δ−ln(1+δ)) .
Pr
m
β + γ β + γ P − m − C0

The next proposition combines the two estimators from the above lemmas and into estimators β̂ and
γ̂.
β P −m−C0
> p. Let
β+γ
P
−m(δ−ln(1+δ))
−mδ 2 /(4+2δ)

Proposition B.4. Assume β > γ > 0. Let I0 ≤ m < P such that

0
z = P −m−C
. Then, for any 0 < δ < 1, with probability 1 − 4e
− 4e
P
−B2 I0
2B1 e
,


(1 − δ)z 2 1 + δ
β̂ ∈ β
,β
1+δ
1−δ


z
(1 − δ)z − (1 + δ)2
1
1 + δ − (1 − δ)2 z 2
γ̂ ∈ γ
+β
,γ
+β
,
1+δ
(1 + δ)(1 − δ)
1−δ
(1 − δ)(1 + δ)

−

(38)
(39)

where B1 , B2 > 0 are constants that depend on β and γ.
We first show Theorem 3.4 using these results. We then prove Lemma B.2, Lemma B.3, and
Proposition B.4 in Appendix B.2.
15

B.1

Proof of Theorem 3.4
q
5 log m
Proof. Let δ =
m . First, we claim that the probability in Proposition B.4 is greater than
2

8
1− m
− 2B1 e−B2 I0 . Note that ln(1 + δ) ≤ δ − δ2 + δ 3 , implying δ − ln(1 + δ) ≥ δ 2 ( 21 − δ). Since
1
δ ≤ 4,

4e−m(δ−ln(1+δ) ≤ 4e−m
Using δ ≤

1
4

δ2
4

≤

4
.
m

(40)

=

4
.
m

(41)

again,
4e−mδ

2

≤ 4e−m

/(4+2δ)

δ2
5

Hence, the bound in B.4 holds with probability greater than 1 −
Since we assume m(m + C0 ) ≤ P and z = 1 −

8
m

− 2B1 e−B2 I0 .

m+C0
,
P

1−z ≤

1
.
m

(42)

Let R be the event that the confidence bounds (38)-(39) hold. Note that
1−δ
1
1+δ ≥ 1 − 3δ for δ < 4 .
2
E[(β̂ − β)2 |R] ≤ β 2 1 + 3δ − (1 − 3δ)z 2

1+δ
1−δ

≤ 1 + 3δ and

(43)

2

2

≤ β ((1 − z) + 3δ(1 + z))
!2
r
1
5 log m
2
≤β
+6
m
m

(44)
(45)

log m
m
for an absolute constant M3 > 0. The second last step uses (42) and 1 + z ≤ 2.
≤ β 2 M3

(46)

Similarly,
 


2
1
z
1 + δ − (1 − δ)2 z 2
(1 − δ)z − (1 + δ)2
E[(γ̂ − γ) |R] ≤ γ
−
+β
−
.
1−δ
1+δ
(1 − δ)(1 + δ)
(1 + δ)(1 − δ)
(47)
2

Using the fact that (1 − δ)(1 + δ) ≥ 12 ,
1
z
−
≤ 2((1 − z) + δ(1 + z)) ≤ 2
1−δ
1+δ

1
+2
m

r

5 log m
m

!
.

(48)

(1 − δ)z − (1 + δ)2
(1 + δ) − (1 − δ)z + (1 + δ)2 − (1 − δ)2 z 2
1 + δ − (1 − δ)2 z 2
−
=
(1 − δ)(1 + δ)
(1 + δ)(1 − δ)
1 − δ2
(49)
1−δ 2
1+δ
−
z
1−δ
1+δ
≤ 2(1 − z) + 8δ + (1 + 3δ) − (1 − 3δ)z 2
≤ 2(1 − z) + 4δ(1 + z) +

2

2

≤ 2(1 − z) + 8δ + (1 − z ) + 6δ(1 + z )
2

≤ (1 − z)(3 + z) + δ(8 + 6(1 + z ))
r
4
5 log m
≤
+ 20
.
m
m
16

(50)
(51)
(52)
(53)
(54)

Substituting back into (47) results in
2

E[(γ̂ − γ) |R] ≤

γ

2
+4
m

r

5 log m
m

!
+β

4
+ 20
m

r

5 log m
m

!!2

log m
,
m
for an absolute constant M2 , since β > γ.
≤ M4 β 2

(55)
(56)

Therefore,
2
E[(β̂ − β)2 ] ≤ E[(β̂ − β)2 |R] + βmax
Pr(R̄)


8
2 log m
2
−B2 I0
+ βmax
+ 2B1 e
≤ M3 β
m
m
log m
2
2
≤ M1 βmax
+ 2B1 βmax
e−B2 I0 ,
m
for an absolute constant M1 > 0. Similarly,


log m
8
2
2
E[(γ̂ − γ)2 ] ≤ M4 βmax
+ γmax
+ 2B1 e−B2 I0
m
m
log m
2
2
≤ M2 βmax
+ 2B1 γmax
e−B2 I0 .
m

B.2
B.2.1

(57)
(58)
(59)

(60)
(61)

Proofs of Intermediate Results
Proof of Lemma B.2.

Proof. Fix m, let z :=

P −m−C0
,p
P

=

β
β+γ z.

Then p >

1
2.

Define three stochastic processes

{Ak : k ≥ 0}, {Bk : k ≥ 0}, {C̃k : k ≥ 0}:

C0
if k = 0
Ak =
Ak−1 + Bern(p) otherwise.

C0
if k = 0
Bk =
Bk−1 + Bern(p/z) otherwise.
(
C0
n
o if k = 0
C̃k =
β(P −C̃k−1 )
C̃k−1 + Bern β(P −C̃ )+P γ
otherwise.

(62)
(63)
(64)

k−1

Note that C̃k is a modified version of Ck where C̃k still evolves after the stopping time.
Claim B.5. Am is stochastically less than C̃m (Am ≤st C̃m ); C̃m is stochastically less than Bm
(C̃m ≤st Bm ); that is, for any ` ∈ R,
Pr(Bm ≤ `) ≤ Pr(C̃m ≤ `) ≤ Pr(Am ≤ `).

(65)

This claim follows from Theorem A.3, using a similar argument to Claim B.5.
Let Ak = C0 + X1 + X2 + . . . Xk where Xi ∼ Bern(p) are independent. We provide the left tail
d

bound for Cm . Note that when τ ≥ m, Cm = C̃m . Hence,
Pr(Cm ≤ mp(1 − δ) + C0 , τ ≥ m) = Pr(C̃m ≤ mp(1 − δ) + C0 , τ ≥ m)
≤ Pr(C̃m ≤ mp(1 − δ) + C0 )
≤ Pr(Am ≤ mp(1 − δ) + C0 ).
Using the Chernoff bound gives,
Pr(Am ≤ mp(1 − δ) + C0 ) = Pr(C0 + X1 + · · · + Xm ≤ pm(1 − δ) + C0 )
= Pr (X1 + · · · + Xm ≤ mp (1 − δ))
 mp 
≤ exp −
δ2 .
2
17

(66)
(67)
(68)
(69)
(70)
(71)

Therefore,

Pr


p
Cm − C0
≤ (1 − δ)z, τ ≥ m = Pr (Cm ≤ mp(1 − δ) + C0 , τ ≥ m)
m
z
 mp 
≤ exp −
δ 2 ≤ exp(−mδ 2 /4).
2

(72)
(73)

Let Bk = C0 + Y1 + . . . + Yk where Yi ∼ Bern(p/z) are independent. Similarly, for the upper tail
bound, we have


Cm − C0
p
Pr
≥ (1 + δ), τ ≥ m = Pr(Cm ≥ mp/z(1 + δ) + C0 , τ ≥ m)
(74)
m
z
≤ Pr(Bm ≥ mp/z(1 + δ) + C0 )
(75)
≤ Pr(C0 + Y1 + · · · + Ym ≥ mp/z(1 + δ) + C0 ) (76)
mp/z 2
≤ exp(−
δ ) ≤ exp(−mδ 2 /(4 + 2δ))
(77)
2+δ
Z

2

due to the multiplicative Chernoff bound Pr(Z ≥ E[Z](1 + δ)) ≤ e− 2+δ δ where Z is the sum of
i.i.d Bernoulli random variables.
β
Combine upper and lower tail bounds and note that p/z = β+γ
. Then, we can conclude, for any
δ > 0,


Cm − C0
β
β
Pr
∈
/[
(1 − δ)z,
(1 + δ)], τ ≥ m ≤ 2 exp(−mδ 2 /(4 + 2δ)). (78)
m
β+γ
β+γ

B.2.2

Proof of Lemma B.3.

Proof. Conditioned on (I0 , C0 , I1 , C1 , . . . , Im−1 , Cm−1 ) with τ ≥ m, we have


P − Ck−1
Ik−1 Tk ∼ Exp β
+γ
P
are independent exponential random variables.
TheoremP
5.1 in [24] gives us a tail bound for the sum of independent exponential random variables:
n
let X = i=1 Xi with Xi ∼ Exp(ai ) independent, then for δ > 0,
1 −a∗ µ(δ−ln(1+δ))
Pr(X ≥ (1 + δ)µ) ≤
e
≤ e−a∗ µ(δ−ln(1+δ))
(79)
1+δ
Pr(X ≤ (1 − δ)µ) ≤ e−a∗ µ(δ−ln(1+δ))
(80)
where µ = E[X], a∗ = min1≤i≤n ai .
Let S̃m|C,
~ I~ be S̃m conditioned on (I0 , C0 , I1 , C1 , . . . , Im−1 , Cm−1 ) with τ ≥ m. Let µ =
Pm
1
E[S̃m|C,
~ I~] =
k=1 β(P −Ck−1 )/P +γ , a∗ = min1≤k≤m β(P − Ck−1 )/P + γ. It is easy to verify the following facts
m
X
a∗
P − m − C0
µa∗ ≥
≥m
(81)
(β + γ)
P
k=1

1
µ
1
P
≤
≤
.
β+γ
m
β + γ P − m − C0
Combining these with Eqs. (79) and (80), we have

!
S̃m|C,
~ I~
(1 − δ) (1 + δ)
P
Pr
∈
/
,
≤ Pr
m
β + γ β + γ P − m − C0

S̃m|C,
~ I~
m

(82)



µ(1 − δ) µ(1 + δ)
∈
/
,
m
m

!
(83)

P −m−C0
−m
P

≤ 2e
18

(δ−ln(1+δ))

.

(84)

Therefore,
! Z
S̃m
∈
/ I, τ ≥ m =
Pr
m
~ I|τ
~ ≥m
C,

Pr

P −m−C0
P

(δ−ln(1+δ))

Pr(τ ≥ m)

(86)

P −m−C0
−m
P

(δ−ln(1+δ))

.

(87)

≤ 2e−m
≤ 2e

B.2.3

!
S̃m
~ I,
~ τ ≥ m f (C,
~ I|τ
~ ≥ m) Pr(τ ≥ m)
∈
/ I | C,
m
(85)

Proof of Proposition B.4.

Proof. Let β̂ =
δ)1/z]. Then,

Cm −C0
,z
S̃m

=

P −C0 −m
.
P

Suppose x ∈

β
β+γ [(1

− δ)z, 1 + δ], y ∈

1
β+γ [1

− δ, (1 +



x
(1 − δ)z 2 1 + δ
∈ β
,β
y
1+δ
1−δ

(88)
2

z
1
1+δ
− β̂. Suppose a ∈ (β + γ)[ 1+δ
, 1−δ
], b ∈ β[ (1−δ)z
1+δ , 1−δ ]. Then


(1 − δ)z − (1 + δ)2
1
1 + δ − (1 − δ)2 z 2
z
+β
,γ
+β
a−b∈ γ
.
1+δ
(1 + δ)(1 − δ)
1−δ
(1 − δ)(1 + δ)

Similarly, let γ̂ =

m
S̃m

(89)

Then, for any sets U1 , U2 ,
Pr(β̂ ∈ U1 , γ̂ ∈ U2 ) ≥ 1 − Pr(β̂ ∈
/ U1 ) − Pr(γ̂ ∈
/ U2 )

(90)

≥ 1 − Pr(β̂ ∈
/ U1 , τ > m) − Pr(β̂ ∈
/ U2 , τ > m) − 2 Pr(τ < m)
≥ 1 − 4e−m(δ−ln(1+δ)) − 4e−mδ

2

/(4+2δ)

− 2B1 e−B2 I0 ,

(91)
(92)

where the last step uses Lemma B.1, Lemma B.2 and Lemma B.3, using the intervals (88) and (89)
for U1 and U2 respectively.

C
C.1

Proofs of Propositions
Proof of Proposition 2.1

Proof. As in [25, 26], the solution {(s0 (t), i0 (t), r0 (t)) : t ≥ 0} with α = 1 can be written:
0

s0 (t) = s0 (0)e−ξ (t)
0

0

(93)
0

i (t) = N − s (t) − r (t)
γ0N
r0 (t) = r(0) + 0 ξ 0 (t)
β
0 Z t
β
ξ 0 (t) =
i0 (t∗ ) dt∗
N 0

(94)
(95)
(96)

Making the appropriate substitutions yields the following equivalent system:


β0
γ0N
i0 (t) = N − s0 (0) exp − ξ(t) − r(0) − 0 ξ 0 (t)
N
β
0 Z t
β
ξ 0 (t) =
i0 (t∗ ) dt∗ .
N 0
19

(97)
(98)

Therefore, it remains to show that for α0 > 0, {(s(t), i(t), r(t)) : t
{(α0 s0 (t), α0 i0 (t), α0 r0 (t)) : t ≥ 0} is a solution for (97) and (98). Starting with (97),

≥

γ0N
i0 (t) = N − s0 (0) exp (−ξ 0 (t)) − r0 (0) − 0 ξ 0 (t)
β


γ0N
α0 i0 (t) = α0 N − s0 (0) exp (−ξ 0 (t)) − r0 (0) − 0 ξ 0 (t)
β
γ 0 α0 N
ξ(t)
= α0 N − αs0 (0) exp (−ξ(t)) − α0 r(0) −
β0

0}

,

(99)
(100)
(101)

0 Rt
where ξ(t) = ξ 0 (t) = Nβα0 0 α0 i0 (t∗ ) dt∗ . Noting that ξ 0 (t) = ξ(t) and substituting i(t) = α0 i0 (t)
yields the equations below, clearly showing that {(s(t), i(t), r(t)) : t ≥ 0} satisfy (97) and (98):

i(t) = α0 N − s(0) exp (−ξ(t)) − r(0) −
Z t
β0
ξ(t) =
i (t∗ ) dt∗ .
N α0 0

C.2

γ 0 α0 N
ξ(t)
β0

(102)
(103)

Proof of Proposition 2.2

Proof. Consider initial conditions (s(0), i(0), 0), as in [25, 26], the analytical solution is given by
s(t) = s(0)e−ξ(t) ,
i(t) = αN − s(t) − r(t),
γ αN
ξ(t),
r(t) =
β
Z t
β
ξ(t) =
i(t0 )dt0 .
αN 0
Consider two SIR models with parameters (α, β, γ) and (α0 , β 0 , γ 0 ), and initial conditions (s0 , i0 , 0)
and (s00 , i00 , 0) respectively. We claim that infection trajectories i(t) and i0 (t) being identical on an
open set [0, T ) implies the parameters and initial conditions are identical as well.
Assume i(t) = i0 (t) for all t ∈ [0, T ); then, given the exact solution above it follows that
h Z T
i
0
β
− αN
x
0
0 − αβ0 N x
0
αN − s0 e
− γx = α N − s0 e
− γ x,
for all x ∈ 0,
i(t)dt

(104)

0

As functions of x, both the RHS and LHS in the equality above are holomorphic, and hence, using the
0
β
identity theorem, we conclude that αN = α0 N , s0 = s00 , − αN
= − αβ0 N , γ = γ 0 , which completes
the proof.
C.3

Proof of Proposition 3.3

d
d
Proof. The crux of the problem is summarised in two smaller results, bounding T1,n
and T2,n
respectively. To ease our exposition, we will let Pn = αn Nn and drop the index n in these helper
results.

Proposition C.1. There exists a constant ν1 that only depends on γ, β such that
!
2/3 

1
2
ν
P
ν
c(0)
1
T1d ≥
log
+ log 1
1 − 2/3
.
β−γ 3
c(0)
c(0)3/2
P
20

Proposition C.2. Let ρ1 = 1 −
constant C = O(1), such that

1
log log P

T2d ≤

, there exists a constant ν2 that only depends on γ, β and a

1
ν2 P
C
log
+
.
βρ1 − γ
i(0)
1 − ρ1

The argument follows directly by taking the limit of the bounds we provide in Propositions C.1-C.2.
Specifically, using that the constants ν1,n , ν2,n do not change with n, we arrive at
d
T2,n
≤ lim
n→∞
n→∞ T d
1,n

1
βρ1 −γ

lim

= lim

n→∞

1
β−γ



2
3

log

β−γ
·
βρ1 − γ

log

ν1 Pn
cn (0)3/2

ν2 Pn
in (0)

+

Cn
(1−ρ1 )
2/3

+ log

ν1
cn (0)



1−

cn (0)
2/3
Pn



log Pn + log ν2 − log in (0)
2
3

log Pn +

4
3


log ν1 − 2 log cn (0) + log 1 −

cn (0)
2/3
Pn



(β − γ)Cn log log Pn

+ lim

n→∞ 2
3

log Pn +

4
3


log ν1 − 2 log cn (0) + log 1 −

cn (0)
2/3
Pn



Since cn (0) = O(log(Pn )) by assumption (and in (0) ≤ cn (0)), and Cn = O(1) by Proposition C.2,
the limits of the two summands above are 3/2 and 0 respectively, which concludes the proof.
C.3.1

Proof of Proposition C.1.

Proof of Proposition C.1. Define ĩ(t) such that ĩ(0) = i(0) and

dĩ
dt

= (β − γ)ĩ, implying

ĩ(t) = i(0) exp{(β − γ)t}.
Since

dĩ
dt

≥

di
dt

(105)

for all t, ĩ(t) ≥ i(t) for all t. Then, for all t,
ds
s
= −β i ≥ −βi ≥ −β ĩ.
dt
P

(106)

Hence we can write
Z

t

−β ĩ(t0 )dt0
Z t
= s(0) − βi(0)
exp{(β − γ)t0 }dt0

s(t) ≥ s(0) +

(107)

0

(108)

0

= s(0) −

βi(0)
(exp{(β − γ)t} − 1)
β−γ

(109)
(110)

Since s(0) − s(T1d ) = P 2/3 − c(0), setting t = T1d and solving for T1d in the inequality above results
in


1
β − γ 2/3
T1d ≥
log
(P
− c(0))
(111)
β−γ
βi(0)


1
β − γ 2/3
log
(P
− c(0))
(112)
≥
β−γ
βc(0)


1
β − γ 2/3
β −γ
c(0) 
=
log
(P ) + log
1 − 2/3
(113)
β−γ
βc(0)
βc(0)
P
!
2/3
1
2
ν1 P
ν1 
c(0) 
=
log
+ log
1 − 2/3
(114)
β−γ 3
c(0)
c(0)3/2
P
for ν1 =



β−γ
β

3/2

as desired.
21

C.3.2

Proof of Proposition C.2.

For ρ ∈ [0, βγ ], let tρ be the time t when s(t)
P = ρ. ρ will represent the fraction of the total population
γ
that is susceptible. Since ρ ≤ β , i is increasing for the time period of interest.
Let β > γ, P be fixed. Let ρ1 = 1 −
ρ1 > ρ2 , hence tρ1 < tρ2 . T2d = tρ2 .

1
log log P

and ρ2 =

Lemma C.3. For any ρ ∈ [0, βγ ], i(tρ ) ≥ P (1 − ρ) βρ−γ
βρ −

γ
β.

We assume P is large enough that

c(0)
2 .

Proof of Lemma C.3. Fix ρ. At time tρ , the total number of people infected is c(tρ ) = i(tρ )+r(tρ ) =
β

s(t)

−γ

P (1 − ρ), by definition. At any time t ≤ tρ , the rate of increase in i is Ps(t) ≥ βρ−γ
βρ of the rate
β P



βρ−γ
βρ−γ
of increase in c. Therefore, i(tρ ) − i(0) ≥ βρ
c(tρ ) − c(0) and i(tρ ) ≥ βρ P (1 − ρ) −
βρ−γ
βρ c(0)

c(0)
2

+ i(0). Using the fact that i(0) ≥

and rearranging terms gives the desired result.

Lemma C.4. For t ∈ [tρ1 , tρ2 ], where ρ2 > ρ1 for ρ1 , ρ2 ∈ [0, βγ ], tρ2 − tρ1 ≤

P (ρ1 −ρ2 )
βρ2 i(tρ1 ) .

Proof of Lemma C.4. The difference in s between tρ1 and tρ2 is s(tρ1 ) − s(tρ2 ) = P (ρ1 − ρ2 ). As
s(t )−s(t )
a consequence of the mean value theorem, ρtρ2 −tρ ρ1 ≤ maxt∈[tρ1 ,tρ2 ] { ds
dt }. Using these two
2
1
expressions,




P (ρ1 − ρ2 )
ds
s(t)
≥ min −
i(t) : t ∈ [tρ1 , tρ2 ] ≥ βρ2 i(tρ1 )
(115)
= min β
tρ2 − tρ1
dt
P
The desired expression follows from rearranging terms.
Lemma C.5. For any ρ ≤ min{ βγ , 1/2}, tρ ≤

1
βρ−γ

log

ν2
i(0) P ,

for ν2 =

2(β−γ)
.
β

The proof of this lemma follows the exact same procedure as the proof of Proposition C.1.
Proof of Lemma C.5. We proceed in the same way as the proof of Proposition C.1 except in this case
we will lower bound s(0) − s(t). We achieve this by letting ĩ be defined to grow slower than i, so it
dĩ
is used as a lower bound. Define ĩ(t) such that ĩ(0) = i(0) and dt
= (βρ − γ)ĩ, implying
ĩ(t) = i(0) exp{(βρ − γ)t}.
dĩ
Since dt
≤
t < tρ2 ,

di
dt

when , ĩ(t) ≤ i(t) for all t < tρ2 . In addition, when t < tρ2 ,
ds
s
= −β i ≤ −βρĩ.
dt
P

(116)
s
P

≥

γ
β

≥ ρ. Then, for

(117)

Hence we can write
Z

t

−βρĩ(t0 )dt0
Z t
= s(0) − βρi(0)
exp{(βρ − γ)t0 }dt0

s(t) ≤ s(0) +

(118)

0

(119)

0

= s(0) −

βρi(0)
(exp{(βρ − γ)t} − 1)
βρ − γ

(120)
(121)

Since s(tρ ) = ρP ,
ρP ≤ s(0) −

βρi(0)
(exp{(βρ − γ)tρ } − 1).
βρ − γ
22

Solving for tρ results in
log
tρ ≤
where ν2 =

2(β−γ)
,
β



βρ−γ
βρi(0) (s(0)

− ρP ) + 1


≤

βρ − γ

 ν

1
2
log
P
βρ − γ
i(0)

(122)

using the fact that ρ ≤ 1/2.

Proof of Proposition C.2. Using the results from Lemmas C.3-C.5,
tρ2 = tρ1 + (tρ2 − tρ1 )
 ν
 P (ρ − ρ )
1
2
1
2
≤
log
P +
βρ1 − γ
i(0)
βρ2 i(tρ1 )
 ν

P (ρ1 − ρ2 )
1
2
log
P + ρ2
≤
βρ2
βρ1 − γ
i(0)
ρ1 P (1 − ρ1 )(βρ1 − γ) − 2 c(0)
 ν

1
C
2
=
log
P +
,
βρ1 − γ
i(0)
1 − ρ1
ρ1 −ρ2
where C = ρ2
. Note that, as required in the statement, C = O(1). Indeed,
βρ2
c(0)
ρ1

(βρ1 −γ)−

C=

2

P (1−ρ1 )

(ρ1 − ρ2 )
ρ2
ρ1 (βρ1

− γ) −

c(0)
βρ2
2 P (1−ρ1 )

=

1
log log P
log P
− βρ2 2 c(0) log
P

1 − ρ2 −
βρ2 −

γρ2
1
1− log log
P

,

(123)

and so, as P grows large, C tends to (1 − ρ2 )/ρ2 (β − γ) (recall that c(0) = O(log log P )).

D

Sufficient Condition for P [t]

In the practical model, P [t] represents the regions that have enough observations to reliably estimate
d
α at time t. In this section, we justify why the definition (10) is a sufficient condition. Let T3,n
=
2

inf{t : ddt2s > 0} be the time at which the rate of new infections is highest in the deterministic SIR
model.
d
d
Proposition D.1. As n → ∞, T1,n
≤ T3,n
.
Proof.


d2 s
−β
di
ds
=
i
+
s
dt2
αn Nn dt
dt


 
−β
−βs 2
βs
=
i +
− γ is
αn Nn αn Nn
αn Nn
= −βis (−βi + βs − γαn Nn )


γ
= β 2 is i − s + αn Nn
β
From (127), we see that

d2 s
dt2

> 0 if and only if
γ
s < αn Nn + i.
β

(124)
(125)
(126)
(127)

(128)

d
At t ≤ T1,n
, c(t) ≤ (αn Nn )2/3 which implies i(t) ≤ (αn Nn )2/3 and s(t) ≥ αn Nn − (αn Nn )2/3 .
We assume n is large enough so that 2(αn Nn )−1/3 < 1 − βγ . Then, (128) cannot hold:
γ
2(αn Nn )−1/3 < 1 −
(129)
β
γ
+ (αn Nn )−1/3 < 1 − (αn Nn )−1/3
(130)
β
γ
γ
αn Nn + i(t) ≤ αn Nn + (αn Nn )2/3 < αn Nn − (αn Nn )2/3 ≤ s(t).
(131)
β
β

23

d
d
Therefore, T1,n
≤ T3,n
.

E

Covariate Details for Practical SIR Model

For observed COVID-19 cases, we use publicly available case data from the ongoing COVID-19
epidemic provided by [27]. Xi [t] consists of static demographic covariates and time-varying mobility
features that affect the disease transmission rate.
The dynamic covariates proxy mobility by estimating the daily fraction of people staying at home
relative to a region-specific benchmark of activity in early March before social distancing measures
were put in place. We also include a regional binary indicator of the days when the fraction of
people staying home exceeds the benchmark by 0.2 or more. These data are provided by Safegraph,
a data company that aggregates anonymized location data from numerous applications in order to
provide insights about physical places. To enhance privacy, SafeGraph excludes census block group
information if fewer than five devices visited an establishment in a month from a given census block
group. Documentation can be found at [28].
The static covariates capture standard demographic features of a region that influence variation in
infection rates. These features fall into several categories:
• Fraction of individuals that live in close proximity or provide personal care to relatives in
other generations. These covariates are reported by age group by state from survey responses
conducted by [29].
• Family size from U.S. Census data, aggregated and cleaned by [30].
• Fraction of the population living in group quarters, including colleges, group homes, military
quarters, and nursing homes (U.S. Census via [30]).
• Population-weighted urban status (US Census via [30])
• Prevalence of comorbidities, such as cardiovascular disease and hypertension ([31])
• Measures of social vulnerability and poverty (U.S. Census via [30]; [32])
• Age, race and occupation distributions (U.S. Census via [30])

24

