arXiv:2006.01873v2 [q-bio.PE] 5 Jun 2020

Forecasting hospital demand during COVID-19
pandemic outbreaks
Marcos A. Capistrán,1∗ Antonio Capella,2 J. Andrés Christen1
1

Centro de Investigación en Matemáticas, CIMAT-CONACYT,
Jalisco S/N, Valenciana, Guanajuato, GTO, Mexico.

2

∗

Instituto de Matemáticas, UNAM, Circuito Exterior, CU, CDMX, Mexico

To whom correspondence should be addressed; E-mail: marcos@cimat.mx .

June 2, 2020

We present a compartmental SEIRD model aimed at forecasting hospital occupancy in metropolitan areas during the current COVID-19 outbreak. The
model features asymptomatic and symptomatic infections with detailed hospital dynamics. We model explicitly branching probabilities and non exponential
residence times in each latent and infected compartments. Using both hospital admittance confirmed cases and deaths we infer the contact rate and the
initial conditions of the dynamical system, considering break points to model
lockdown interventions. Our Bayesian approach allows us to produce timely
probabilistic forecasts of hospital demand. The model has been used by the
federal government of Mexico to assist public policy, and has been applied for
the analysis of more than 70 metropolitan areas and the 32 states in the country.

1

Introduction
The ongoing COVID-19 pandemic has posed a major challenge to public health systems of all
countries with the imminent risk of saturated hospitals and patients not receiving proper medical
care. Although the scientific community and public health authorities had insight regarding the
risks and preparedness measures required in the onset of a zoonotic pandemic, our knowledge of
the fatality and spread rates of COVID-19 remains limited (1–4). In terms of disease handling,
two leading issues determining the current situation are the lack of a pharmaceutical treatment
and our inability to diagnose the asymptomatic infection of COVID-19 (5–7).
Under the current circumstances, control measures reduce new infections by limiting the
number of contacts through mitigation and suppression (1). Mitigation includes social distancing, testing, tracing and isolating of infected individuals, while suppression imposes temporary
cancellation of non-essential activities. Most certainly, mitigation and suppression pose a burden on the economy, affecting more those individuals living in low income conditions, thus
affecting the capacity of the population as a whole to comply with control measures.
Undoubtedly, one key task during the early pandemic response efforts is using epidemiological records and mathematical and statistical modeling to forecast excess hospital care demand,
with formal quantified uncertainty. In this paper we pose a compartmental SEIRD model that
takes into account both asymptomatic and symptomatic infection, including hospital dynamics.
We model explicitly the residence time in each latent and infected compartments (8, 9) and we
use records of daily confirmed cases and deaths to pose a statistical model that accounts for
data overdispersion (10, 11). Furthermore, we use Bayesian inference to estimate both the initial state of the governing equations and the contact rate in order to make probabilistic forecasts
of the required hospital beds, including the number of intensive care units. We have applied this
model to forecast hospital demand in metropolitan areas of Mexico. We remark that this model

2

has been used by Mexican federal public health authorities to assist decision making during the
COVID-19 pandemic.

Contributions and limitations
Broadly speaking, data-driven epidemiological models are built out of necessity of making
forecasts. There are many lessons learnt on emergency preparedness and epidemic surveillance
from previous pandemic events: AH1N1 influenza (12), MERS (13), SARS (14), Zika (15),
Ebola (16), etcetera. However, surveillance data during a pandemic event often suffers from
serious deficiencies such as incompleteness and backlogs. Another important issue is the design
of data acquisition taking into account geographical granularity (17). Epidemic surveillance of
COVID-19 is no different since there is an unknown percentage of asymptomatic infections,
and susceptibility is related to economic vulnerability.
In this paper we demonstrate that it is possible to produce accurate mid–term (several weeks)
probabilistic forecasting of COVID-19 hospital pressure, namely hospital beds and respiratory
support or mechanical ventilation demands, using confirmed records of cases at hospital admittance and deaths.
Our analysis uses the Bayesian approach to inverse problems (Bayesian Uncertainty Quantification) as a natural mathematical tool to investigate the pandemic evolution and provide
actionable forecasts to public health controls during the pandemic.
On the other hand, since asymptomatic infection is not fully described so far (18), it is impossible to forecast the population fraction that will be in contact with the virus by the end of the
current outbreak. Likewise, although it is possible to make model based analysis of scenarios of
lockdown exit strategies, reliability is limited due to the lack of information regarding population viral seroprevalence. Therefore, without serological studies in the open population after an
outbreak, it is not possible to assess the original susceptible population. This is a key piece of

3

information to model and assess the possible next pandemic outbreaks, which our model does
not address at this point.
The model introduced here assumes the contact rate remains relatively constant for several
weeks. Nevertheless, the model accounts for break points due to change of policies in the
control measures, such as school closures (19).
Finally, the model does not account for biases due to behavioral changes (20,21). In particular, our model may underestimate the decay of outbreaks due to possible granularity of contacts,
superspreading events (22) and other factors.

Related work
There are many modeling efforts aimed at forecasting hospital occupancy during the ongoing
COVID-19 pandemic (23–28). Broadly speaking, models are informed with evolving information about COVID-19 cases, clinical description of the patient residence time in each compartment, fraction of cases per age group, number of deaths, hospital bed occupancy, etc.
Columbia University metapopulation SEIR model (23) forecasts are based on assumptions
relating an effective contact rate with population density at a metropolitan area and social distancing policies. The Covid Act Now model (24) forecasts the replacement number Rt and
the fraction of infections requiring hospitalization using the Bayesian paradigm to fit a SEIR
model to case, hospitalization, death, and recovery counts. The Imperial College response team
mathematical model (25) uses an unweigthed ensamble of four models to produce forecasts of
the number of deaths in the week ahead for each country with active transmission. The IHME
model (26) combines a mechanistic model of transmission with curve fitting to forecast the
number of infections and deaths. Moghadas et al. (27) pose a mechanistic model parametrized
with demographic data to project hospital utilization in the United States during the COVID-19
pandemic. The main goal of Moghadas et al. is to estimate hospital pressure throughout.

4

Other COVID-19 models have been used to explore exit strategies (29, 30), the role of recovered individuals as human shields (31), digital contact tracing (32) and break points in the
contact rate to account for changes in suppression and mitigation policies (19).

Methods
“Models should not be presented as scientific truth” (33). They are tools that intend to serve
a specific purpose, evaluate or forecast some particular aspects of a phenomena under certain
conditions and ideally should be developed following the processes of predictive science (34).
Namely, identify the quantities of interest (QoI), verify the computational and mathematical
approximation error, including their implication in the estimation of QoI, and calibrate the parameters to adjust the model in light of data to bring it closer to experimental observation. When
considering uncertainty, Bayesian inference may be used to calibrate some key features of the
model given measured data. Finally, a validation process must be used to build confidence on
the accuracy of the QoI predictions of the model.
Dynamical model
As a proxy of hospital pressure the QoI in our model are: the evolution demand of no-ICU
hospital beds and number of ICU/respiratory support beds. To estimate the QoI we developed a
full compartmental SEIRD model featuring several compartments to describe hospital dynamics (see Figure 1 and supporting materials, SM) and sub-compartments to describe explicitly
residence rates as Erlang distributions (8, 9). The model has two variants, one with age structure and one that assumes age independent dynamics. Here we describe the only latter (see
supporting material for some additional comments on the age dependent mode).
Succinctly our model goes as follows (see Figure 1 and SM). Once the susceptible individuals (S) become infected they remain in the incubation compartment (E) for mean time of 1/σ1
5

days (i.e. residence rate σ1 ). After the incubation period, exposed individuals become infectious and a proportion f become sufficiently sever symptomatic cases (I S ) to approach a hospital, while the remaining cases become mild to asymptomatic (I A ). The asymptomatic/mild–
symptomatic cases remain infectious a mean time of 1/γ1 days and eventually recover.
For the symptomatic cases (I S ) we assume that after an average time of 1/σ2 days a proportion g of infected individuals will need hospitalization (H 1 ), while the rest (I C ) will receive ambulatory care, recovering after an average convalescent time of 1/γ2 days in quarantine. The hospitalized patients (H 1 ) remain an average time of 1/σ3 days until a fraction
h will need assisted respiratory measures or ICU care such as mechanical ventilation (U 1 ).
The remaining fraction 1 − h of hospitalized patients (H 2 ) will recover after an average of
1/γ3 days. Respiratory-assisted/ICU patients (U 1 ) remain in that state an average of 1/σ4
days until a critical day is reached when a proportion i of them will die (D) and the remaining proportion 1 − i will recover (H 3 ) after an average period of 1/γ 4 days. Similar models
have been proposed by (2, 31, 32, 35). For the infection force (λ) we assume that only mild–
symptomatic/asymptomatic (I A ) and symptomatic (I S ) individuals spread the infection, that
is
λ=

βA I A + βS I S
Nef f

where βA and βS are the contact rates of asymptomatic/mild–symptomatic and symptomatic
individuals, respectively.
The model has two kind of parameters that have to be calibrated or inferred, those related
to COVID-19 disease and hospitalization dynamics (such as residence times and proportions
of individuals that split at each bifurcation of the model) and those related to the public response to mitigation measures such as the contact rates β’s and the effective number of susceptible individuals Nef f at the beginning of an outbreak. Some of these parameters may be
estimated from hospital records, be found in recent literature or inferred from reported cases
6

(1 − f )σ1

S

λ

γ1

IA

R
γ2
γ3

IC

E
f σ1

γ4

(1 − g)σ2

H2

IS
gσ2

H3

(1 − h)σ3

H1

(1 − i)µ

hσ3

U1

σ4

U2

iµ

D

Figure 1: Schematic diagram of model compartments without Erlang sub-compartments. For
a precise definition of parameters see supplementary material.

and deaths, but some of remain largely unknown. In the latter category we have the effective
number of susceptible individuals Nef f at the beginning of an outbreak and the fraction 1 − f of
asymptomatic/mild–symptomatic infections. The number Nef f is lower than the full population
for a metropolitan area and depends on different aspects, but at least in the case of COVID-19
it is likely to be a consequence of unequal follow–up of social distancing public policies among
the population. Reported values of the proportion of asymptomatic/mild–symptomatic infections cases 1 − f range from 10% to 75%, and even 95% in children population (6, 7, 36).
Notice that in our model the total number of patients that will visit a hospital is given roughly
(bounded) by the product Nef f × f and the total number of patients admitted to the hospital is
given by Nef f × f × g, where g is the portion of infected persons that need hospitalization.
We have evidence (see SM) that given our choice of observation model (see below), the
inference of our QoI only depends on the product Nef f × f × g, and not on the value of
their individual factors. Since the fraction g is far easier to estimate (from hospital records of
admissions and ambulatory patients) and reported in the literature, we only require to postulate
7

a value for the product Nef f × f .
Since our QoI are concerned with hospital pressure, we choose from the available data two
sources of information for the observational model: (A) the registered confirmed COVID-19
patients at hospitals, with or without hospitalization, and (B) deceased patients. Even under
an outbreak, these data are reasonable consistent and systematic information on the inflow (A,
registered patients at hospitals) and outflow (B, number of hospital deaths), that “hedge” the
hospital dynamics. The model assumes constant, and more or less reliable, reported fractions
(g, h, i) of patients that transit on each hospital dynamics bifurcation. Intuitively, this provides
an explanation for why using only A and B the hospital dynamics (our QoI) may be estimated,
while only the product Nef f × f is important and not to a great extent the nominal values of
Nef f and f .
Regarding data availability for our observational model. Due to administrative reporting
delays we discard the last 7 days of reporting. First visit to the hospital date and the registered
deceased date are used as time stamps for A and B, respectively. We do not use patient reported
symptoms onset as a time stamp.
Bayesian Inference
Undoubtedly, the impact of local testing practices on the number of confirmed cases would need
to be analyzed based on the region of interest. In Mexico testing has been relatively low but
consistent. Patients are tested when arriving to hospitals with probable COVID-19 symptoms
and limited testing is done elsewhere; therefore most confirmed COVID-19 cases are limited
to A as described above. Therefore, make our inferences we use both confirm cases (A) and
deceased counts (B), in the sense explained in the previous section.
For inference, we therefore consider daily confirmed cases ci of patients arriving at H 1 and
daily reported deaths di , for the metropolitan area or region being analyzed.

8

To account for over dispersion, we use a negative binomial (NB) distribution N B(µ, ω, θ),
following (10), with mean µ and over dispersion parameters θ and ω (see SM for details). The
use of an over disperse NB has proved its value and adequacy in analyzing data from regions in
Mexico (and other regions). For data yi we let yi ∼ N B(pµ(ti ), ω, θ), with fixed values for the
overdispersion parameters ω, θ and an additional reporting probability p. For both confirmed
cases and deaths we found good performance fixing ω = 2. To model daily deaths we fixed
θ = 0.5 and for daily cases θ = 1 implying higher variability for the later. The reporting
probabilities are 0.95 for deaths and 0.85 for cases, with the assumption, as explained above,
that the ci ’s are confirmed sufficiently severe cases arriving at hospitals.
For daily deaths counts di the mean is simply the daily counts µD (ti ) = D(ti ) − D(ti−1 ).
For cases ci , the mean µc (ti ) we consider is the daily flux entering the H 1 compartment, which
may be calculated as (11)
Z

ti
S
gσ2 Im
(t)dt,

µc (ti ) =
ti−1

S
(t) is the last state variable in the I S Erlang series (see SM). We calculate the above
where Im

integral using a simple trapezoidal rule with 10 points (1/10 day).
We assume conditional independence in the data and therefore from the NB model we obtain
a likelihood. Our parameters are the contact rate parameter β and crucially we also infer the
initial conditions E(0), I A (0), I S (0). Letting S(0) = N − (E(0) + I A (0) + I S (0)) and setting
the rest of the parameters to zero, we have all initial conditions defined and the model may be
solved numerically to obtain µD and µc to evaluate our likelihood. We use the lsoda solver
available in the scipy.integrate.odeint Python function.
To model interventions, a break point is established at which β = β1 before and β =
β2 after the intervention day. This creates a non-linear time dependent β(t) (19, 37). This
additional parameters are then included in the inference. Normally only the initial β1 and an
after lockdown (22 March 2020) β2 parameters are considered (in Mexico city a third β3 was
9

considered for modeling a further local intervention in early April).
We use Gamma(1, 10) priors for each E(0), I A (0), I S (0), modeling the low, near to 10,
and close to zero counts for the number of infectious initial conditions. The prior for the β’s are
the same, and a priori independent, long tails, log Normal with σ 2 = 1 and scale parameter 1;
that is log(β) ∼ N (0, 1). To sample from the posterior we resort to MCMC using the “t-walk”
generic sampler (38). The MCMC runs semi automatic, with fairly consistent performances in
most data sets. For any state variable V , the MCMC allows us to sample from the posterior
predictive distribution for V (ti ), and by plotting sequentially some of its quantiles we may
produce predictions with quantified probabilistic uncertainty, as seen in Figure 2.
As in the case of climate forecasting, due to the stochastic nature of an pandemic outbreak
point-wise estimates such as the maximum a posteriori estimate (MAP) do not give good descriptions of the outbreak evolution. No single trajectory of the SEIRD model provide a good
description of the outbreak evolution, nor give accurate forecasts.

Results
Local transmission started in a different date in each Mexican metropolitan area provided each
one of them has different communicability with Mexico City and with the rest of the world.
On the other hand, all metropolitan areas in the country are in lock-down since May 22, with a
change of policy due to start at the beginning of the month of June.
Figure 2 (a) shows the model forecast, with quantified uncertainty, of the daily records of
COVID-19 confirmed cases in Mexico City with data trimming to April 17 and April 24 for
comparison. Figures shows both, the absolute number of cases and the number of cases per
100,000 inhabitants. Of note, the update in the median, shown with a continuous black line, is
almost negligible while the update in quantiles 10% and 90%, shown with dotted lines, exhibits
a contraction around the median as more data is included. Figure 2 (b) depicts records and
10

forecasts for the aggregated number of deaths. In Figure 2 (c) and (d) we compare the model
forecasts with hospital bed and ICU occupancy obtained from a secondary official source of
epidemiological surveillance. We remark that the total number of hospital beds and ICU units is
consistently overestimated and shifted to latter times. Our modeling strategy was based on daily
demand of hospital beds and intensive care units records from Instituto Mexicano del Seguro
Social or Mexican Social Security Institute (IMSS) to calibrate the residence time within the
hospital. We assumed that it was necessary to forecast a higher demand in both types of hospital
occupancy given the emerging nature of the virus and evidence of excess of hospital pressure in
places like Spain, Italy and New York.
In the supplementary material we show the outbreak analysis for the cities of Cancún, Tijuana and La Paz. The rationale for choosing these Mexican cities is as follows. Mexico City is
among the top ten most populated metropolitan areas in the world and comprises roughly one
sixth of the Mexican population. Cancún and Tijuana are medium size cities with considerable
international communicability where the first ones with an outbreak among cities in Mexico. La
Paz is the capital of the Mexican state of Baja California Sur in the Baja California peninsula
where the outbreak was relatively small. Despite the varying features among these cities we
forecast the acme of the developing outbreak with up to three weeks for small and medium size
cities.

Mexico city, metropolitan area

Discussion
We presented a Bayesian approach to inform a compartmental SEIRD model to produce probabilistic forecasts of hospital pressure during COVID-19 outbreaks.
Besides the examples presented in this paper, our model has been applied to other 70
metropolitan areas and the 32 states in Mexico (“ama” model; https://coronavirus.
11

(a)

(b)

(c)

(d)

Figure 2: Outbreak analysis for Mexico city metropolitan area, using data from April 17 and
April 24. (a) Confirmed cases (b) Deaths (c) No ICU (d) ICU occupied hospital beds. Total
population 21, 942, 666 inhabitants
conacyt.mx/proyectos/ama.html, in Spanish). From simple model forecast comparisons it was apparent from early April that pandemic outbreaks ran at different speeds throughout metropolitan areas in the country, suggesting more regionalized policies than a single nationwide strategy. Consequently, future re-opening strategies may need to be thought on a
regional basis also.

12

The age independent model has proven to be adequate to produce accurate forecast for the
hospitalization dynamics during current outbreaks. Therefore the added complexity of the agestructure model may not justify its used at this point. However we continue to work in our age
structure model.
Regarding interventions, we model lock-down and social distancing policies by setting
break points in the contact rates at specific dates and inferring their values. This method does
not serve to detect change points but it does measure the effectiveness of these policies and its
consequences on our forecast. Moreover, it makes our model more flexible adapting inference
for changing circumstances.
Our observational model is designed to integrate data after the non-linear term in the dynamic model and the epidemic curves we inferred and forecast are for the hospitalization dynamics. Assuming (as the model does) that the rest of the dynamics is proportional to these
curves, the dynamics of the rest of the model will follow –bounded by residence times– the
same paths of the hospitalization dynamics. Thereby, our estimates and forecasts on hospitalization pressure can be used as a proxy of the full outbreak. In turn we are also able to produce
probabilistic forecasts for the date when an outbreak will reach its peak.
As already mentioned, as yet the asymptomatic infection has not been fully described (18).
The confounding effect of the effective population that participates in the outbreak and the
fraction of asymptomatic/mild–symptomatic infections 1 − f makes it impossible to reliably
forecast the population fraction that will be in contact with the virus (i.e. the final population viral seroprevalence) at the end of an outbreak. Likewise, although it is possible to make
model based analyses of scenarios of lock-down exit strategies, scenario reliability estimation
is limited due to the lack of information regarding population viral seroprevalence. Therefore,
without serological studies in the open population after an outbreak it is not possible to asses
the final outbreak size. This is a key piece of information to model and assess possible next pan13

demic outbreaks, from the possibility of reopening and relaxation of social distancing measures.
Our model as it stands cannot predict multiple outbreaks, but once epidemic data is available,
estimation of the previous and new effective population may provide a toll to predict second
outbreaks (for a fixed proxy f probability; work in progress).
There has been substantial discussion regarding testing strategies for prevalence of COVID19 cases in different countries. These strategies may serve dissimilar purposes and it should
be clear the intended use of each strategy. Due to the lack of description of the asymptomatic
infection most of the strategies for large amount of testing that includes the asymptomatic infections will produce biased data and these biases are hard to identify. Mexico is one of the
countries with the smallest ratio of COVID-19 testing (). However, our results show that it is
possible to produce reliable forecast for hospital pressure during an outbreak with this relative
low amount of testing exclusively at hospital admissions (and deceased). The advantage of this
testing strategy is that it is systematic, biases are well identified and it is possible to develop a
model well adapted to this observational method.

Acknowledgments
The authors wish to thank Elena Álvarez-Buylla, Paola Villarreal (CONACYT) and Hugo
López-Gatell (Secretarı́a de Salud) for their support and comments for improving this forecast
model and also Instituto Mexicano de Seguridad Social (IMSS) for sharing data to adjust the
hospitalization dynamics. Very special thanks to CIMAT technicians Judith Esquivel-Vázquez
and Oscar González-Vázquez (CIMAT-CONACYT), help in retrieving data and running our
programs at a CIMAT cluster. We also thank the CONACYT COVID-19 response group, for additional comments in the developing of our model. The authors are partially founded by CONACYT CB-2016-01-284451 grant. AC was partially supported by UNAM PAPPITIN106118
grant.
14

References
1. N. M. Ferguson, et al., London: Imperial College COVID-19 Response Team, March 16
(2020).
2. R. Verity, et al., medRxiv (2020).
3. C. P. E. R. E. Novel, et al., Zhonghua liu xing bing xue za zhi= Zhonghua liuxingbingxue
zazhi 41, 145 (2020).
4. X. Zhou, Y. Li, T. Li, W. Zhang, Clinical Microbiology and Infection (2020).
5. M. Gandhi, D. S. Yokoe, D. V. Havlir, The New England Journal of Medicine .
6. K. Mizumoto, K. Kagaya, A. Zarebski, G. Chowell, Eurosurveillance 25 (2020).
7. M. Day, BMJ 368 (2020).
8. D. Champredon, J. Dushoff, D. J. Earn, SIAM Journal on Applied Mathematics 78, 3258
(2018).
9. H. J. Wearing, P. Rohani, M. J. Keeling, PLOS Medicine 2 (2005).
10. A. Lindén, S. Mäntyniemi, Ecology 92, 1414 (2011).
11. A. E. Zarebski, P. Dawson, J. M. McCaw, R. Moss, Infectious Disease Modelling 2, 56
(2017).
12. J. A. Cordova-Villalobos, et al., Gac Med Mex 153, 102 (2017).
13. K.-M. Ha, Journal of Hospital Infection 92, 232 (2016).
14. E. J. Emanuel, Annals of Internal Medicine 139, 589 (2003).
15

15. S. J. Hoffman, S. L. Silverberg, American journal of public health 108, 329 (2018).
16. B. Gates, New England Journal of Medicine 372, 1381 (2015).
17. N. Perra, B. Gonçalves, Social phenomena (Springer, 2015), pp. 59–83.
18. S. W. Park, et al., medRxiv (2020).
19. J. Dehning, et al., Science (2020).
20. C. Eksin, K. Paarporn, J. S. Weitz, Epidemics 27, 96 (2019).
21. J. S. Weitz, S. W. Park, C. Eksin, J. Dushoff, medRxiv (2020).
22. Y. Liu, R. M. Eggo, A. J. Kucharski, The Lancet 395, e47 (2020).
23. T. Yamana, S. Pei, J. Shaman, medRxiv (2020).
24. M. Henderson, et al., Covid act now.
25. S. Bhatia, et al., Short-term forecasts of covid-19 deaths in multiple countries.
26. I. COVID, C. J. Murray, et al., medRxiv (2020).
27. S. M. Moghadas, et al., Proceedings of the National Academy of Sciences 117, 9122 (2020).
28. H. Salje, et al., Science (2020).
29. O. Karin, et al., medRxiv (2020).
30. L. Di Domenico, G. Pullano, C. E. Sabbatini, P.-Y. Boëlle, V. Colizza, medRxiv (2020).
31. J. S. Weitz, et al., Nature Medicine pp. 1–6 (2020).
32. L. Ferretti, et al., Science (2020).
16

33. N. P. Jewell, J. A. Lewnard, B. L. Jewell, JAMA (2020).
34. J. T. Oden, R. Moser, O. Ghattas, SIAM News 43, 1 (2010).
35. A. J. Kucharski, et al., The Lancet Infectious Diseases (2020).
36. S. Silal, et al., Estimating cases for covid-19 in south africa update: 19 may 2020 (2020).
37. W. Wang, Epidemic models with nonlinear infection forces.
38. J. A. Christen, C. Fox, Bayesian Anal. 5, 263 (2010).
39. A. Cori, N. M. Ferguson, C. Fraser, S. Cauchemez, American Journal of Epidemiology 178,
1505 (2013).
40. P. Van den Driessche, J. Watmough, Mathematical biosciences 180, 29 (2002).
41. E. E. Team, et al., Eurosurveillance 25 (2020).
42. J. Zhang, et al., The Lancet Infectious Diseases (2020).
43. U. Buchholz, et al. (2020).
44. L. Zou, et al., New England Journal of Medicine 382, 1177 (2020).
45. X. He, et al., Nature medicine pp. 1–4 (2020).
46. Preliminary estimate of excess mortality during the covid-19 outbreak new york city, march
11may 2, 2020.
47. S. M. Moghadas, et al., Proceedings of the National Academy of Sciences 117, 9122 (2020).
48. K. Prem, A. Cook, M. Jit, PLOS Computational Biology 13, e1005697 (2017).

17

Supplementary materials
Other examples
Tijuana, Mex

(a)

(b)

(c)

(d)

Figure 3: Outbreak analysis for Tijuana metropolitan area, using data from 17 April and 24
April. (a) Confirmed cases (b) Deaths (c) No ICU (d) ICU occupied hospital beds. Total
population 2, 011, 247 inhabitants

18

Cancun, Mex

(a)

(b)

(c)

(d)

Figure 4: Outbreak analysis for Cancun metropolitan area, using data from 17 April and 24
April. (a) Confirmed cases (b) Deaths (c) No ICU (d) ICU occupied hospital beds. Total
population 867, 768 inhabitants.

19

La Paz
In cases where there are small counts of confirmed cases and deaths we included a fictitious
intervention point after the first 10 confirmed cases (39). In terms of the outbreak evolution
this serves the purpose of distinguish the imported cases from the community spread where the
model should be applied.

(a)

(b)

(c)

(d)

Figure 5: Outbreak analysis for La Paz metropolitan area, using data from 17 April and 24
April. (a) Confirmed cases (b) Deaths (c) No ICU (d) ICU occupied hospital beds. Total
population 301, 961 inhabitants.

20

Data sources
Delimitation of the metropolitan areas and population was taken from https://www.gob.

mx/conapo/documentos/delimitacion-de-las-zonas-metropolitanas-de-mexico-201

html and https://datos.gob.mx/busca/dataset/proyecciones-de-la-poblacion-de-m
respectively. The official records of COVID-19 confirmed cases and dead where taken from
https://www.gob.mx/salud/documentos/datos-abiertos-152127

Model
We developed a dynamic transmission compartmental model to simulate the spread of the novel
coronavirus SARS-CoV-2. A description of the state variables is found in Table 1. Additionally
and “Erlang series” is included for most of these state variables to account for non-exponential
residente times; see below. The model may be described conceptually with the graph in Figure 1. Without showing the Erlang series for the sub-compartments the system of equations in
the model is as follows:
dS
dt
dI A
dt
dI C
dt
dH 2
dt
dU 2
dt
dH 3
dt
dR
dt


βA I A + βS I S
=−
S
Nef f

dE
dt
dI S
dt
dH 1
dt
dU 1
dt
dD
dt

= (1 − f )σ1 E − γ1 I A
= (1 − g)σ2 I S − γ2 I C
= (1 − h)σ3 H 1 − γ3 H 2
= σ4 U 1 − µU 2


βA I A + βS I S
=
S − σ1 E
Nef f
= f σ1 E − σ2 I S
= gσ2 I S − σ3 H 1
= hσ3 H 1 − σ4 U 1
= iµU 2

= (1 − i)µU 2 − γ4 H 3
= γ1 I A + γ2 I C + γ3 H 2 + γ4 H 3 .

A brief description of all the parameters in our model may be found in Table 2.
21

Table 1: Description of the state variables for our dynamic transmission model
Variable
S
E
IA
IS
IC
H1
H2
U1
U2
H3
R
D

Description
Susceptibles
Latent individuals
Asymptomatic/mild–symptomatic individuals
Symptomatic individuals
Out-patients
Hospitalized patients, initial stage
Hospitalized patients (no ICU)
Hospitalized patients (ICU or respiratory support)
Hospitalized patients (ICU or respiratory support) critical day
Hospitalized patients recovering after ICU or respiratory support
Recovered
Deceased

(1 − f )σ1

S

λ

γ1

IA

R
γ2
γ3

IC

E
f σ1

γ4

(1 − g)σ2

H2

IS
gσ2

H3

(1 − h)σ3

H1

(1 − i)µ

hσ3

U1

σ4

U2

iµ

D

Figure 6: Schematic diagram of model compartments without Erlang sub-compartments.

22

Table 2: Description of the parameters included in our model.
Parameter
Nef f
βA
βS
κ
f
g
h
i
1/σ1
1/σ2
1/σ3
1/σ4
1/µ
1/γ1
1/γ2
1/γ3
1/γ4

Description
Number of initially susceptible individuals in the population
Transmission rate of asymptomatic/mild–symptomatic individuals (asx/mild–sym)
Transmission rate of symptomatic individuals
Relative strength between the transmission the rate of asx/mild–sym and symptomatic
Portion of infected persons with strong enough symptoms to visit a hospital
Portion of infected persons that need hospitalization
Portion of hospitalized patients requiring respiratory support or ICU care
Portion of Respiratory-assisted or ICU patients deceased
Average incubation time
Average time from symptomatic onset to hospital visit
Average time from hospital admission to respiratory support or ICU care
Average time with respiratory support or ICU care
Average length of critical stage of respiratory–support/ICU between death and recovery
Average time that asymptomatic/mild–symptomatic individuals remain infectious
Average time of symptomatic individuals that recover without visiting a hospital
Average time from hospital admission to hospital discharge
Average time from respiratory–support/ICU care release to hospital discharge

Infection force and basic reproductive number R0
For the infection force (λ) we assume that the only individuals that spread the infection correspond to the mild–symptomatic/asymptomatic (I A ) and symptomatic individuals (I S ) before
their contact with the health care system or doctor, e.g.
βA I A + βS I S
λ=
Nef f
We compute the basic reproductive number R0 of the epidemic by the next generation matrix
method (40) and obtain
R0 = (1 − f )

23

βA
βS
+f .
γ1
σ2

Units
–
per day
per day

day
day
day
day
day
day
day
day
day

Values of model parameters
Since our QoI are related with the hospital pressure we choose all parameters conservatively.
For each metropolitan area we assume that Nef f corresponds to its full population as defined by
Instituto Nacional de Estadistica y Geografia (INEGI). The values of the transition probabilities
are summarized in Table 3.
Table 3: Transition probabilities at bifurcations in the model
Parameter
f
g
h
i

Value
0.05
0.04375
0.25
0.5

Reference
postulated
(1), IMSS
(1), IMSS
(1), IMSS

Erlang series and sub-compartments
In order to make the intrinsic generation-interval of the renewal equation in each compartment
more realistic we divide each compartment of the model into m equal sub–compartments to
generate an Erlang–distributed waiting time (8). The Erlang distributions of each compartment
is calibrated by two parameters: the rate λE and the shape m, a positive integer that corresponds
to the number of sub–compartments on the model. In terms of these parameters the mean of the
Erlang distribution is m/λE , this mean correspond to the average times in the dynamic model.
We use recent publications and information generously shared by the Instituto Mexicano de
Seguridad Social (IMSS) to estimate the average time and the shape parameter of the Erlang
series in each compartment. Details of Erlang series lengths, residence times and the imputed
values may be found in Table 4.

24

Table 4: Average times and Erlang shape parameters for sub-compartments
Variable
S
E
IA
IS
IC
H1
H2
U1
U2
H3
R
D

Rates
βS
1/σ1
1/γ1
1/σ2
1/γ1
1/σ3
1/γ3
1/σ4
1/µ
1/γ4
None
None

Average time
Inferred
5 days
7 days
4 days
7 days
2 days
10 days
10 days
1 day
4 days
–
–

Erlang shape m Reference
1
–
4
(2)
3
(41)
3
(42)
3
(43)
10
(3)
3
(3)
3
IMSS
1
(43)
5
(3)
–
–
–
–

Relative strength between the transmission the rate of asymptomatic/mild–symptomatic
and symptomatic
In our methodology we aim to infer the force of the infection λ. This parameter is defined
in terms of contact rate of asymptomatic/mildsymptomatic individuals βA and contact rate of
symptomatic individuals βS . Due to the functional dependence of λ in these parameters there
is a lack of identifiability between βA and βS that can not be resolved without further assumptions. We assume that the relative strength between the transmission rate of asymptomatic/mild–
symptomatic and symptomatic is modelled as a fixed ratio κ. We model the value of κ directly as
the ratio of the viral load of symptomatic and asymptomatic/mild–symptomatic patients (44,45)
and is fixed to κ = 2. Hence, the force of infection becomes λ = β S (I S + κI A )/Nef f .

Data and observational model
To make our inferences we use both confirm cases and deceased counts. In some regions sub
reporting of COVID-19 related deaths may become relevant, specially in places hit by a severe

25

outbreak (46). Nonetheless, deaths are a more reliable data source to estimate a COVID-19
outbreak, specially for the purposes of hospital demand. Certainly, daily confirm cases are
also needed for more accurate predictions as a proxy for outbreak dynamics. The problem
here is that the number of confirmed cases depends heavily on local practices, in particular in
relation to the intensity of testing, adding a level of complication if testing intensity has varied
due to ambiguous policies. Undoubtedly, the impact of local testing practices on the number
of confirmed cases would need to be analyzed based on the region of interest. In Mexico
testing has been relatively low but consistent. Patients are tested when arriving to hospitals
with probable COVID-19 symptoms and limited testing is done elsewhere. For inference, we
therefore consider daily counts of patients arriving at H 1 , as we explain next.
Accordingly, as explained in the main text, we use daily reported deaths di and daily confirmed cases ci , for the metropolitan area or region being analyzed, to perform our inferences.
The first default model for count data is a Poisson distribution, however, epidemiological data
tends to be over disperse and an over disperse generalized Poisson distribution may be needed to
correctly, and safely, model these type of data, as it is the case in other ecological studies. (10)
suggest the use of and over disperse negative binomial (NB) model. We have followed their
suggestion, and the use of an over disperse NB has proved its value and adequacy in analyzing
data from regions in Mexico, and elsewhere, as we have already illustrated.
Following (10) the NB distribution is re parametrized in terms of its mean µ and “overdispersion” parameters θ and ω, with r =

µ
ω−1+θµ

and p =

1
,
ω+θµ

the number of failures before

stopping and the success probability, respectively, in the usual NB parametrization. For data yi
we let yi ∼ N B(pµ(ti ), ω, θ), with fixed values for the overdispersion parameters ω, θ and an
additional reporting probability p. The index of dispersion is σ 2 /µ = ω + θµ. Over dispersion
with respect to the Poisson distribution is achieved when ω > 1 and the index of dispersion
increases with size if θ 6= 0; both desirable characteristics in outbreak data, adding variability
26

as counts increase. In both cases we found good performance fixing ω = 2. To model daily
deaths we fixed θ = 0.5 and for daily cases θ = 1 implying higher variability for the later. The
reporting probabilities are 0.95 for deaths and 0.85 for cases, with the assumption, as explained
above, that the ci ’s are confirmed sufficiently severe cases arriving at hospitals.
For daily deaths counts di the mean is simply the daily counts µD (ti ) = D(ti ) − D(ti−1 ).
For cases ci , the mean µc (ti ) we consider the daily flux entering the H 1 compartment, which
may be calculated as (11)
Z

ti
S
gσ2 Im
(t)dt,

µc (ti ) =
ti−1

S
(t) is the last state variable in the I S Erlang series. We calculate the above integral
where Im

using a simple trapezoidal rule with 10 points (1/10 day).

Modeling interventions and Bayesian Inference
We assume conditional independence in the data and therefore from the NB model we obtain
a likelihood. Our parameters are the contact rate parameter β and crucially we also infer the
initial conditions E(0), I A (0), I S (0). Letting S(0) = N − (E(0) + I A (0) + I S (0)) and setting
the rest of the parameters to zero, we have all initial conditions defined and the model may be
solved numerically to obtain µD and µc to evaluate our likelihood. We use the lsoda solver
available in the scipy.integrate.odeint Python function.
To model interventions, a break point is established at which β = β1 before and β =
β2 after the intervention day. This creates a non-linear time dependent β(t) (19, 37). This
additional parameters are then included in the inference. Normally only the initial β1 and an
after lockdown (22 March 2020) β2 parameters are considered (in Mexico city a third β3 was
considered for modeling a further local intervention in early April).
We use Gamma(1, 10) priors for each E(0), I A (0), I S (0), modeling the low, near to 10,
and close to zero counts for the number of infectious initial conditions. The prior for the β’s
27

are the same and a priori independent (a possible generalization is to consider dependent β’s
modeling a decrease in contact rates after lockdowns etc.). These are rather diffuse and long
tails LogNormal with σ 2 = 1 and scale parameter 1; that is log(β) ∼ N (0, 1).
To sample from the posterior we resort to MCMC using the “t-walk” generic sampler (38).
The MCMC runs semi automatic, with a fairly consistent burn in of 1,000 iterations (sampling
initial values from the prior). We perform subsampling using the Intergrated Autocorrelation
Time, with psuedo-independent sample sizes of 1,000 to 1,500 with 200,000 iterations of the
MCMC. This roughly takes 30 min in a 2.2 GHz processor.
To illustrate the whole posterior distribution, for any state variable V (or µc (ti )), for each
sampled initial conditions and β’s the model is solved at time t1 , t2 , . . . , tk , including possibly
future dates, obtaining a sample of V (ti ) values for each ti . The median, and other desired
quantiles are plotted vertically for each date considered, obtaining the plots as in Figure 2.
Note that the traced median or other plotted quantiles do not necessary correspond to any given
model trajectory, providing a far richer Uncertainty Quantification approach than the classical
parameter estimates plug-in approach. Indeed, the sampled values for V (ti ) do correspond to
Monte Carlo samples of the posterior predictive distribution for V (ti ).

Adding age structure
Adding group ages is straightforward in these type of models. The number a of ages groups
is decided and our model is repeated a times. Different residence times may be included (47)
but we preferred to concentrate on the different transition probabilities g, h that vary nearly two
orders of magnitude using age groups [0, 25], (25, 50], (50, 65], (65, 100] (1). The age structure
is used to divide the initial infectious and susceptible population proportional to the size of each
age group. The same number of parameters are inferred, using a single β, with an optional
weighting contact matrix (48) to model different contact rates among age groups in specific

28

regions. Using a sufficiently flexible software design, progressing to an age structure model is
not complex, nonetheless the MCMC may run substantially slower. Although we have experimented with our age structured model, using census data from Mexico and both uniform and
non uniform contact matrices, we do not report any of these results here, given that our non-age
structure model has sufficiently enough predictive power, as already discussed.

Confounding effect of Nef f × f
To explain the confounding effect of Nef f ×f we have two observations. First, if we let f = f˜/α
for some α ∈ (0, f˜) then differential equations for the variables I c , H 1 , H 2 , H 3 , U 1 , U 2 and D
remain invariant and the equations for I s becomes
dI S
f˜
= σ1 E − σ2 I S .
dt
α
By letting Ẽ = E/α the equation for I s is also invariant with the substitution of E by Ẽ. Now,
the equation for Ẽ is given by

βA I A + βS I S
dẼ
=
S − σ1 Ẽ.
dt
αNef f
By letting Ñef f = αNef f the latter equations becomes also invariant under the substitution of
E by Ẽ. Therefore for the lower branch in the model (see Figure 6) the system of equations
is invariant under the change of f and Nef f by f˜ and Ñef f provided Ñef f × f˜ = Nef f × f
holds. Clearly, to have a consistent system of equations, the equations for S, I A and R have to
be adapted in each case to obtain a consistent set of equations.
Second, int the inference of parameter β we inform the system with the data at the H 1 and
D compartments. If Ñef f × f˜ = Nef f × f holds, in view of our first observation, to fit these
data the fluxes f σ1 E and f˜σ1 Ẽ in either case have to be the same. Clearly, the solutions in the
compartment I S and after do not change in this case, but the individuals in the I A compartment
do change depending on which combination of Nef f and f or Ñef f and f˜ is considered. There
29

is a range of validity for α where the inference of β does not change but do not explore this
property further.
Numerical simulations where also preformed to confirm this confounding effect, but until
the asymptomatic infection is fully described it is not possible to resolve this issue.

30

