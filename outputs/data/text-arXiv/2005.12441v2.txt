Identifying the measurements required to estimate rates of COVID-19
transmission, infection, and detection, using variational data assimilation
Eve Armstrong∗1,2 , Manuela Runge3 , and Jaline Gerardin3
1 Department

of Physics, New York Institute of Technology, New York, NY 10023, USA
of Astrophysics, American Museum of Natural History, New York, NY 10024, USA
3 Department of Preventive Medicine, Northwestern University, Chicago IL, 60611

2 Department

arXiv:2005.12441v2 [q-bio.PE] 31 Jul 2020

August 4, 2020

Abstract
We demonstrate the ability of statistical data assimilation to identify the measurements required for accurate
state and parameter estimation in an epidemiological model for the novel coronavirus disease COVID-19. Our
context is an effort to inform policy regarding social behavior, to mitigate strain on hospital capacity. The
model unknowns are taken to be: the time-varying transmission rate, the fraction of exposed cases that require
hospitalization, and the time-varying detection probabilities of new asymptomatic and symptomatic cases. In
simulations, we obtain accurate estimates of undetected (that is, unmeasured) infectious populations, by measuring
the detected cases together with the recovered and dead - and without assumed knowledge of the detection rates.
Given a noiseless measurement of the recovered population, excellent estimates of all quantities are obtained using
a temporal baseline of 101 days, with the exception of the time-varying transmission rate at times prior to the
implementation of social distancing. With low noise added to the recovered population, accurate state estimates
require a lengthening of the temporal baseline of measurements. Estimates of all parameters are sensitive to the
contamination, highlighting the need for accurate and uniform methods of reporting. The aim of this paper is
to exemplify the power of SDA to determine what properties of measurements will yield estimates of unknown
parameters to a desired precision, in a model with the complexity required to capture important features of the
COVID-19 pandemic.

I.

INTRODUCTION

data must be recorded in order to estimate specific unknown quantities in an epidemiological model of COVID19 transmission. These unknown quantities are: i) the
transmission rate, ii) the fraction of the exposed population that acquires symptoms sufficiently severe to require
hospitalization, and iii) time-varying detection probabilities of asymptomatic and symptomatic cases. In this
paper, we demonstrate the ability of statistical data assimilation (SDA) to quantify the accuracy to which these
parameters can be estimated, given certain properties of
the data including noise level.

The coronavirus disease 2019 (COVID-19) is burdening
health care systems worldwide, threatening physical and
psychological health, and devastating the global economy.
Individual countries and states are tasked with balancing
population-level mitigation measures with maintaining
economic activity. Mathematical modeling has been used
to aid policymakers’ plans for hospital capacity needs,
and to understand the minimum criteria for effective
contact tracing [1]. Both state-level decision-making and
accurate modeling benefit from quality surveillance data.
Insufficient insufficient testing capacity, however, especially at the beginning of the epidemic in the United
States, and other data reporting issues have meant that
surveillance data on COVID-19 is biased and incomplete [2–4]. Models intended to guide intervention policy
must be able to handle imperfect data.

SDA is an inverse formulation [5]: a machine learning
approach designed to optimally combine a model with
data. Invented for numerical weather prediction [6–11],
and more recently applied to biological neuron models [12–18], SDA offers a systematic means to identify
the measurements required to estimate unknown model
parameters to a desired precision.

Within this context, we seek a means to quantify what

Data assimilation has been presented as a means

∗ evearmstrong.physics@gmail.com

1

for general epidemiological forecasting [19], and one
work has examined variational data assimilation specifically - the method we employ in this paper - for estimating parameters in epidemiological models [20]. Related Bayesian frameworks for estimating unknown properties of epidemiological models have also been explored [21,22]. To date, there have been two employments
of SDA for COVID-19 specifically. Ref [23] used a simple
SIR (susceptible/infected/recovered) model, and Ref [24]
expanded the SIR model to include a compartment of
patients in treatment.

Third, the state evolution - and importantly the populations requiring inpatient care - tolerates low (∼ five
percent) noise, given a doubling of the temporal baseline
of measurements; the parameter estimates do not tolerate
this contamination.
Finally, we discuss necessary modifications prior to
testing with real data, including lowering the sensitivity
of parameter estimates to noise in data.

Two features of our work distinguish this paper as
novel. First, we expand the model in terms of the number of compartments. The aim here is to capture key
features of COVID-19 such that the model structure is relevant for questions from policymakers on containing the
pandemic. These features are: i) asymptomatic, presymptomatic, and symptomatic populations, ii) undetected
and detected cases, and iii) two hospitalized populations:
those who do and do not require critical care. For our
motivations for these choices, see Model. Second, we
employ SDA for the specific purpose of examining the
sensitivity of estimates of time-varying parameters to
various properties of the measurements, including the
degree of noise (or error) added. Moreover, we aim to
demonstrate the power and versatility of the SDA technique to explore what is required of measurements to
complete a model with a dimension sufficiently high to
capture the policy-relevant complexities of COVID-19
transmission and containment - an examination that has
not previously been done.

The model is written in 22 state variables, each representing a subpopulation of people; the total population
is conserved. Figure 1 shows a schematic of the model
structure. Each member of a Population S that becomes
Exposed (E) ultimately reaches either the Recovered (R)
or Dead (D) state. Absent additive noise, the model is deterministic. Five variables correspond to measured quantities
in the inference experiments.
As noted, the model is written with the aim to inform policy on social behavior and contact tracing so as
to avoid exceeding hospital capacity. To this end, the
model resolves asymptomatic-versus-symptomatic cases,
undetected-versus-detected cases, and the two tiers of
hospital needs: the general (inpatient, non-intensive care
unit (ICU)) H versus the critical care (ICU) C populations.

II.

MODEL

To this end, we sought to estimate the parameters noted above, using simulated data representing a
metropolitan-area population loosely based on New York
City. We examined the sensitivity of estimations to: i)
the subpopulations that were sampled, ii) the temporal
baseline of sampling, and iii) uncertainty in the sampling.
Results using simulated data are threefold. First, reasonable estimations of time-varying detection probabilities require the reporting of new detected cases (asymptomatic and symptomatic), dead, and recovered. Second,
given noiseless measurements, a temporal baseline of
101 days is sufficient for the SDA procedure to capture
the general trends in the evolution of the model populations, the detection probabilities, and the time-varying
transmission rate following the implementation of social
distancing. Importantly, the information contained in the
measured detected populations propagates successfully to
the estimation of the numbers of severe undetected cases.

Figure 1: Schematic of the model. Each rectangle represents
a population. Note the distinction of asymptomatic cases, undetected cases, and the two tiers of hospitalized care: H and
C. The aim of including this degree of resolution is to inform
policy on social behavior so as to minimize strain on hospital
capacity. The red ovals indicate the variables that correspond
to measured quantities in the inference experiments.

2

The resolution of asymptomatic versus symptomatic
cases was motivated by an interest in what interventions are necessary to control the epidemic. For example,
is it sufficient to focus only on symptomatic individuals, or must we also target and address asymptomatic
individuals who may not even realize they are infected?
The detected and undetected populations exist for
two reasons. First, we seek to account for underreporting
of cases and deaths. Second, we desire a model structure
that can simulate the impact of increasing detection rates
on disease transmission, including the impact of contact
tracing. Thus the model was structured from the beginning so that we might examine the effects of interventions
that were imposed later on. The ultimate aim here is to
inform policy on the requirements for containing the
epidemic.
We included both H and C populations because hospital inpatient and ICU bed capacities are the key health
system metrics that we aim to avoid straining. Any policy
that we consider must include predictions on inpatient
and ICU bed needs. Preparing for those needs is a key
response if or when the epidemic grows uncontrolled.
For details of the model, including the reaction equations and descriptions of all state variables and parameters, see Appendix A.

consistency check, simulated experiments offer the opportunity to ascertain which and how few experimental
measurements, in principle, are necessary and sufficient
to complete a model.
B. Optimization framework
SDA can be formulated as an optimization, wherein a cost
function is extremized. We take this approach, and write
the cost function in two terms: 1) one term representing
the difference between state estimate and measurement
(measurement error), and 2) a term representing model
error. It will be shown below in this Section that treating the model error as finite offers a means to identify
whether a solution has been found within a particular
region of parameter space. This is a non-trivial problem,
as any nonlinear model will render the cost function nonconvex. We search the surface of the cost function via the
variational method, and we employ a method of annealing to identify a lowest minumum - a procedure that has
been referred to loosely in the literature as variational
annealing (VA).
The cost function A0 used in this paper is written as:
J

A0 (x( n ), p) =

L

∑∑

j =1 l =1

III.

METHOD

N −1 D

+
A.

General inference formulation

SDA is an inference procedure, or a type of machine
learning, in which a model dynamical system is assumed
to underlie any measured quantities. This model F can
be written as a set of D ordinary differential equations
that evolve in some parameterization t as:
dx a (t)
= Fa (x(t), p(t));
dt

a = 1, 2, . . . , D,

where the components x a of the vector x are the model
state variables, and unknown parameters to be estimated
are contained in p(t). A subset L of the D state variables is associated with measured quantities. One seeks
to estimate the p unknown parameters and the evolution of all state variables that is consistent with the L
measurements.
A prerequisite for estimation using real data is the
design of simulated experiments, wherein the true values
of parameters are known. In addition to providing a

Rlm
(y (n) − xl (n))2
2 l

∑ ∑

n =1 a =1

R af
2

( x a (n + 1) − f a (x(n), p(n)))2 .
(1)

One seeks the path X 0 = x(0), ..., x( N ), p(0), ...p( N ) in
state space on which A0 attains a minimum value1 . Note
that Equation 1 is shorthand; for the full form, see Appendix A of Ref [18]. For a derivation - beginning with the
physical Action of a particle in state space - see Ref [25].
The first squared term of Equation 1 governs the
transfer of information from measurements yl to model
states xl . The summation on j runs over all discretized
timepoints J at which measurements are made, which
may be a subset of all integrated model timepoints. The
summation on l is taken over all L measured quantities.
The second squared term of Equation 1 incorporates the model evolution of all D state variables x a .
The term f a (x(n)) is defined, for discretization, as:
1
2 [ Fa (x( n )) + Fa (x( n + 1))]. The outer sum on n is taken
over all discretized timepoints of the model equations of
motion. The sum on a is taken over all D state variables.

1 It

may interest the reader that one can derive this cost function by considering the classical physical Action on a path in a state space,
where the path of lowest Action corresponds to the correct solution [25]

3

Rm and R f are inverse covariance matrices for the
measurement and model errors, respectively. We take
each matrix to be diagonal and treat them as relative
weighting terms, whose utility will be described below
in this Section.
The procedure searches a ( D ( N + 1) + p ( N + 1))dimensional state space, where D is the number of state
variables, N is the number of discretized steps, and p is
the number of unknown parameters. To perform simulated experiments, the equations of motion are integrated
forward to yield simulated data, and the VA procedure
is challenged to infer the parameters and the evolution
of all state variables - measured and unmeasured - that
generated the simulated data.
This specific formulation has been tested with chaotic
models [26–29], and used to estimate parameters in models of biological neurons [13, 14, 16, 18, 30, 31], as well as
astrophysical scenarios [32].
C.

Annealing to identify a solution on a non-convex
cost function surface

Our model is nonlinear, and thus the cost function surface is non-convex. For this reason, we iterate - or anneal
- in terms of the ratio of model and measurement error,
with the aim to gradually freeze out a lowest minimum.
This procedure was introduced in Ref [33], and has since
been used in combination with variational optimization
on nonlinear models in Refs [11, 18, 30, 32] above. The
annealing works as follows.
We first define the coefficient of measurement error
Rm to be 1.0, and write the coefficient of model error
R f as: R f = R f ,0 α β , where R f ,0 is a small number near
zero, α is a small number greater than 1.0, and β is initialized at zero. Parameter β is our annealing parameter.
For the case in which β = 0, relatively free from model
constraints the cost function surface is smooth and there

exists one minimum of the variational problem that is
consistent with the measurements. We obtain an estimate
of that minimum. Then we increase the weight of the
model term slightly, via an integer increment in β, and
recalculate the cost. We do this recursively, toward the
deterministic limit of R f  Rm . The aim is to remain
sufficiently near to the lowest minimum to not become
trapped in a local minimum as the surface becomes resolved. We will show in Results that a plot of the cost as a
function of β reveals whether a solution has been found
that is consistent with both measurements and model.

IV.

THE EXPERIMENTS

A.

Simulated experiments

We based our simulated locality loosely on New York
City, with a population of 9 million. For simplicity, we
assume a closed population. Simulations ran from an
initial time t0 of four days prior to 2020 March 1, the date
of the first reported COVID-19 case in New York City [34].
At time t0 , there existed one detected symptomatic case
within the population of 9 million. In addition to that
one initial detected case, we took as our initial conditions
on the populations to be: 50 undetected asymptomatics,
10 undetected mild symptomatics, and one undetected
severe symptomatic.
We chose five quantities as unknown parameters to be
estimated (Table 1): 1) the time-varying transmission rate
Ki (t); 2) the detection probability of mild symptomatic
cases dSym (t), 3) the detection probability of severe symptomatic cases dSys (t), 4) the fraction of cases that become
symptomatic f sympt , and 5) the fraction of symptomatic
cases that become severe enough to require hospitalization f severe . Here we summarize the key features that we
sought to capture in modeling these parameters; for their
mathematical formulatons, see Appendix B.

Table 1: Unknown parameters to be estimated. Ki , dSym , and dSys are taken to be time-varying. Parameters f sympt and
f severe are constant numbers, as they are assumed to reflect an intrinsic property of the disease. The detection probability of
asymptomatic cases is taken to be known and zero.
Parameter

Description

Ki ( t )
dSym (t)
dSys (t)
f sympt
f severe

Time-varying transmission rate
Time-varying detection probability of mild symptomatics
Time-varying detection probability of symptomatics requiring hospitalization
Fraction of positive cases that produce symptoms
Fraction of symptomatics that are severe

4

The transmission rate Ki (often referred to as the effective contact rate) in a given population for a given
infectious disease is measured in effective contacts per
unit time. This may be expressed as the total contact rate
multiplied by the risk of infection, given contact between
an infectious and a susceptible individual. The contact
rate, in turn, can be impacted by amendments to social
behavior2 .
As a first step in applying SDA to a high-dimensional
epidemiological model, we chose to condense the significance of Ki into a relatively simple mathematical form.
We assumed that Ki was constant prior to the implementation of a social-distancing mandate, which then
effected a rapid transition of Ki to a lower constant value.
Specifically, we modeled Ki as a smooth approximation
to a Heaviside function that begins its decline on March
22, the date that the stay-at-home order took effect in
New York City [38]: 25 days after time t0 . For further
simplicity, we took Ki to reflect a single implementation
of a social distancing protocol, and adherence to that
protocol throughout the remaining temporal baseline of
estimation.
Detection rates impact the sizes of the subpopulations
entering hospitals, and their values are highly uncertain [3, 4]. Thus we took these quantities to be unknown,
and - as detection methods will evolve - time-varying.
We also optimistically assumed that the methods will
improve, and thus we described them as increasing functions of time. We used smoothly-varying forms, the first
linear and the second quadratic, to preclude symmetries
in the model equations. Meanwhile, we took the detection probability for asymptomatic cases (d As ) to be known
and zero, a reasonable reflection of the current state of
testing.

Figure 2: Schematic of the four simulated experiments.

The simulated experiments are summarized in the
schematic of Figure 2. They were designed to probe the
effects upon estimations of three considerations: a) the
number of measured subpopulations, b) the temporal
baseline of measurements, and c) contamination of measurements by noise. To this end, we designed a “base”
experiment sufficient to yield an excellent solution, and
then four variations on this experiment.
The base experiment (i in Figure 2) possesses the following features: a) five measured populations: detected
asymptomatic Asdet , detected mild symptomatic Symdet ,
detected severe symptomatic Sysdet , Recovered R, and
Dead D; b) a temporal baseline of 101 days, beginning
on 2020 February 26; c) no noise in measurements.
The three variations on this basic experiment (ii
through iv in Figure 2), incorporate the following independent changes. In Experiment ii, the R population is
not measured - an example designed to reflect the current
situation in some localities (e.g. Refs [3, 4]).
Experiment iii includes a ∼ five percent noise level
(for the form of additive noise, see Appendix C) in the
simulated R data, and Experiment iv includes that noise
level in addition to a doubled temporal baseline.
For each experiment, twenty independent calculations
were initiated in parallel searches, each with a randomlygenerated set of initial conditions on state variable and
parameter values. For technical details of all experimental
designs and implementation, see Appendix C.

Finally, we assigned as unknowns the fraction of cases
that become symptomatic ( f sympt ) and fraction of symptomatic cases that become sufficiently severe to require
hospitalization ( f severe ), as these fractions possess high
uncertainties (Refs [39] and [40], respectively). As they reflect an intrinsic property of the disease, we took them to
be constants. All other model parameters were taken to
be known and constant (Appendix A); however, the values
V. RESULT
of many other model parameters also possess significant
uncertainties given the reported data, including, for exA. General findings
ample, the fraction of those hospitalized that require ICU
care. Future VA experiments can treat these quantities as The salient results for the simulated experiments i
unknowns as well.
through iv are as follows:
2 The

reproduction number R0 , in the simplest SIR form, can be written as the effective contact rate divided by the recovery rate. In
practice, R0 is a challenge to infer [22, 35–37].

5

i (base experiment): Excellent estimate of all - measured and unmeasured - state variables, and all parameters except for Ki (t) at times prior to the onset of
social distancing;
ii (absent a measurement of Population R): Poor estimate of all quantities;
iii (∼ 5% additive noise in R): Poor estimates of all
quantities;
Figure 3: Cost function plotted at each annealing step β for
the base experiment i, for twenty paths in state space, where
iv (∼ 5% additive noise in R, with a doubled baseline β scales the rigidity of the imposed model constraint. At low
of 201 days): Estimates of state evolution are robust β the procedure endeavours to fit the measured variables to
to noise, while parameter estimates are sensitive to the simulated measurements. As β increases, the cost increases
until it approaches a plateau (around β = 30), indicating that a
noise.
solution has been found that is consistent with both measurements and model.

Figures of the estimated time evolution of state variables and time-varying parameters are shown in their
Figure 3 shows the evolution of the cost throughout
respective subsections, and the estimates of the static
annealing, for the ten distinct independent paths that
parameters are listed in Table 2.
were initiated; the x-axis shows the value of Annealing
Parameter β, or: the increasing rigidity of the model
constraint. At the start of iterations, the cost function is
B. Base Experiment i
mainly fitting the measurements to data, and its value beThe base experiment that employed five noiseless mea- gins to climb as the model penalty is gradually imposed.
sured populations over 101 days yielded an excellent If the procedure finds a solution that is consistent not
solution in terms of model evolution and parameter es- only with the measurements, but also with the model,
timates. Prior to examining the solution, we shall first then the cost will plateau. In Figure 4, we see this hapshow the cost function versus the annealing parameter β, pen, around β = 30, with some scatter across paths. The
as this distribution can serve as a tool for assessing the reported estimates in this Subsection are taken at a value
of β of 32: on the plateau. The significance of this plateau
significance of a solution.
will become clearer upon examining the contrasting case
of Experiment ii.
Table 2: Estimates of static parameters fsympt and fsevere over
We now examine the state and parameter estimates
all simulated experiments. For Experiments i and iv, the reported numbers are taken from the annealing iteration with for the base experiment i. For all experiments, each
a value of parameter β of 32 and 40, respectively: once the solution shown is representative of the solution for all
deterministic limit has been reached (see text). For Experiment twenty paths. Figure 4 shows an excellent estimate of
ii, an attempt was made to retrieve parameter estimates at all state variables during the temporal window in which
β = 2; that is: before the solution grows unstable exponen- the measured variables were sampled. For consistency in
tially (see Figure 5). See specific subsections for details of each
illustrating the time evolution of all state variables, we
experiment.
use the state estimates for the Recovered (R) and Dead
(D) populations, which are cumulative, rather than follow
Experiment f sympt (true: 0.6) f severe (true: 0.07)
standard epidemiological practice of showing incident
Mean Variance
Mean Variance
R or D. The time-varying parameters are also estimated
i
0.59
2 × 10−4
0.07
4 × 10−6
well, excepting Ki (t) at times prior to its steep decline.
ii
–
We noted no improvement in this estimate for Ki (t), foliii
–
lowing a tenfold increase in the temporal resolution of
iv
0.39
0.8
0.19
0.2
measurements (not shown). The procedure does appear
6

Figure 4: Estimates of the state - measured and unmeasured - variables, and the time-varying parameters Ki , dSym , and
dSys , for the base experiment i. Excellent estimates are obtained of all states and parameters, except early values of Ki prior to
the implementation of social distancing; see text. Results are taken at a value for annealing parameter β of 32.

to recognize that a fast transition in the value of Ki occurred at early times, and that that value was previously
higher. It will be important to investigate the reason for
this failure in the estimation of Ki at early times, to rule
out numerical issues involved with the quickly-changing
derivative3 .
C.

in Asdet , Symdet , Sysdet , and D alone to corral the procedure into a region of state-and-parameter space in which
a model solution is possible. We repeated this experiment with a doubled baseline of 201 days, and noted no
improvement (not shown).

Experiment ii: no measurement of R

Figure 5 shows the cost as a function of annealing for
the case with no measurement of Recovered Population
R. Without examining the estimates, we know from the
Cost(β) plot that no solution has been found that is consistent with both measurements and model: no plateau
is reached. Rather, as the model constraint strengthens,
the cost increases exponentially.
Indeed, Figure 6 shows the estimation, taken at β = 2,
prior to the runaway behavior. Note the excellent fit to
the measured states and simultaneous poor fit to the unmeasured states. As no stable solution is found at high
β, we conclude that there exists insufficient information

Figure 5: Cost versus β for Experiment ii: R is not measured.
As β increases, the cost increases indefinitely, indicating that
no solution has been found that is consistent with both measurements and model dynamics.

3 As

noted in Experiments, we chose Ki to reflect a rapid adherence to social distancing at Day 25 following time t0 , which then remained in
place through to Day 101. For the form of Ki , see Appendix B.)

7

Figure 6: Estimates for Experiment ii: without a measurement of Population R. This result is taken at β = 2, prior to the
exponential runaway in the cost. Estimates of unmeasured states and time-varying parameters are poor.

Figure 7: Estimates for Experiment iv: low noise added to Population R and with a doubled temporal baseline of 201 days.
The noise added to R propagates to some unmeasured States (S, E, As, and Asdet ), but the overall evolution is captured well.
The noise precludes an estimate of the time-varying parameters (not shown). Results are reported using a value for β of 40.

8

D. Experiments iii and iv: low noise added
In Experiment iii, the low noise added to R yielded a
poor state and parameter estimate (not shown). With
a doubled temporal baseline of measurements (Experiment iv), however, the state estimate became robust to the
contamination. Figure 7 shows this estimate. While the
∼ five percent noise added to Population R propagates
to the unmeasured States S, E, and P, the general state
evolution is still captured well. Importantly, the populations entering the hospital are well estimated. Note that
some low state estimates (e.g. As) are not perfectly offset
by high estimates (e.g. Sym). The addition of noise in
these numbers - by definition - breaks the conservation
of the population. Finally, the parameter estimates for
Experiment iv do not survive the added contamination
(not shown).

VI.

CONCLUSION

model estimation using real data, via prediction. In advance of that step, we are performing a detailed study of
the model’s sensitivity to contamination in the measurable populations Asdet , Symdet , Sysdet , R, and D. Concurrently we are examining means to render the parameter
estimation less sensitive to noise, via various additional
equality constraints in the cost function, and loosening
the assumption of Gaussian-distributed noise. In particular, we shall require that the time-varying parameters
be smoothly-varying. It will be important to examine the
stability of the SDA procedure over a range of choices
for parameter values and initial numbers for the infected
populations.
This procedure can be expanded in many directions.
Examples include: 1) defining additional model parameters as unknowns to be estimated, including the fraction
of patients hospitalized, the fraction who enter critical
care, and the various timescales governing the reaction
equations; 2) imposing various constraints regarding the
unknown time-varying quantities, particularly transmission rate Ki (t), and identifying which forms permit a
solution consistent with measurements; 3) examining
model sensitivity to the initial numbers within each population; 4) examining model sensitivity to the temporal
frequency of data sampling. Moreover, it is our hope
that the exercises described in this paper can guide the
application of SDA to a host of complicated questions
surrounding COVID-19.

We have endeavoured to illustrate the potential of SDA
to systematically identify the specific measurements, temporal baseline of measurements, and degree of measurement accuracy, required to estimate unknown model
parameters in a high-dimensional model designed to examine the complex problems that COVID-19 presents to
hospitals. In light of our assumed knowledge of some
model parameters, we restrict our conclusions to general comments. We emphasize that estimation of the full
model state requires measurements of the detected cases
but not the undetected, provided that the recovered and
VII. ACKNOWLEDGEMENTS
dead are also measured. The state evolution is tolerant
to low noise in these measurements, while the parameter Thank you to Patrick Clay from the University of Michiestimates are not.
gan for discussions on inferring exposure rates given
The ultimate aim of SDA is to test the validity of social distancing protocols.

9

Appendix A: Details of the model
Table 3: State variables of the COVID-19 transmission model. The “detected” qualifier signifies that the population has been
tested and is positive for COVID-19.
Variable

Description

S
E
Asdet
As
Symdet
Sym
Sysdet
Sys
H1,det
H2,det
H3,det
H1
H2
H3
C2,det
C3,det
C2
C3
R
D

Susceptible
Exposed
Asymptomatic, detected
Asymptomatic, undetected
Symptomatic mild, detected
Symptomatic mild, undetected
Symptomatic severe, detected
Symptomatic severe, undetected
Hospitalized and will recover, detected
Hospitalized and will go to critical care and recover, detected
Hospitalized and will go to critical care and die, detected
Hospitalized and will recover, undetected
Hospitalized and will go to critical care and recover, undetected
Hospitalized and will go to critical care and die, undetected
In critical care and will recover, detected
In critical care and will die, detected
In critical care and will recover, undetected
In critical care and will die, undetected
Recovered
Dead

Reaction equations
The blue notation specified by overbrackets denotes the correspondence of specific terms to the reactions between
the populations depicted in Figure 1.
→E

z
}|
{
dS
Ki · S · [in f ectious + (in f ectiousdet × reduced)]
=−
dt
N
• in f ectious = As + P + Sym + Sys + H1 + H2 + H3 + C2 + C3

• in f ectiousdet = Asdet + Symdet + Sysdet
S→

z
}|
{
dE
= Ki · S · [in f ectious + (in f ectiousdet × reduced)]/N
dt
→ Asdet

→ As

→P

z
}|
{ z
}|
{ z
}|
{
1 − f sympt
1 − f sympt
f sympt
−
· E · d As −
· E · (1.0 − d As ) −
·E
tin f ection
tin f ection
tin f ection
E→

dAsdet
dt

R
z
}|
{ z →
}| {
1 − f sympt
1
=
· E · d As −
· Asdet
tin f ection
t R,a
E→

R
z
}|
{ z →
}| {
1 − f sympt
dAs
1
=
· E · (1.0 − d As ) −
· As
dt
tin f ection
t R,a

10

→Symdet

E→

z

}|

→Sysdet

→Sys

z
}|
{ z
}|
{ z
}|
{ z
}|
{
1 − f severe
1 − f severe
f severe
f severe
·E−
· P · dSym −
· P · (1.0 − dSym ) −
· P · dSys −
· P · (1.0 − dSys )
tsympt
tsympt
tsympt
tsympt

f sympt
dP
=
dt
tin f ection

P→

dSymdet
dt

→Sym

{

→R

z
}|
{ z
}|
{
1 − f severe
1
=
· P · dSym −
· Symdet
tsympt
t R,m
P→

→R

}|
{ z }| {
z
dSym
1 − f severe
1
=
· P · (1.0 − dSym ) −
· Sym
dt
tsympt
t R,m
→ H1,det

P→

dSysdet
dt

→ H2,det

→ H3,det

z
}|
{ z }| { z }| { z }| {
f severe
f
f
f
=
· P · dSys − H · Sysdet − C · Sysdet − D · Sysdet
tsympt
tH
tH
tH
→ H1

P→

→ H2

→ H3

}|
{ z }| { z }| { z }| {
z
dSys
f severe
f
f
f
· P · (1.0 − dSys ) − H · Sys − C · Sys − D · Sys
=
dt
tsympt
tH
tH
tH
Sysdet →

→R

dH1,det
dt

z }| { z }| {
f
1
· H1,det
= H · Sysdet −
tH
t R,h

dH2,det
dt

z }| { z }| {
f
1
= C · Sysdet − · H2,det
tH
tC

dH3,det
dt

z }| { z }| {
f
1
= D · Sysdet − · H3,det
tH
tC

Sysdet →

→C2,det

Sysdet →

Sys→

→C3,det

→R

z }| { z }| {
dH1
f
1
= H · Sys −
· H1
dt
tH
t R,h
Sys→

→C

Sys→

→C

z }| { z }|2 {
dH2
1
f
= C · Sys − · H2
dt
tH
tC
z }| { z }|3 {
dH3
f
1
= D · Sys − · H3
dt
tH
tC
H2,det →

→R

dC2,det
dt

z }| { z }| {
1
1
=
· H2,det −
· C2det
tC
t R,c

dC3,det
dt

z }| { z }| {
1
1
=
· H3,det −
· C3,det
tC
tD

H3,det →

H2 →

→D

→R

z }| { z }| {
dC2
1
1
=
· H2 −
· C2
dt
tC
t R,c
H3 →

→D

z }| { z }| {
dC3
1
1
=
· H3 −
· C3
dt
tC
tD

11

Asdet →

As→

Symdet →

Sym→

H1,det →

H1 →

C2,det →

C2 →

z }| { z
}|
{ z }| { z }| { z }| { z }| { z }| {
dR
1
1
1
1
1
1
1
1
· H1,det +
· H1 +
=
· Asdet +
· As +
· Symdet +
· Sym +
· C2,det +
· C2
dt
t R,a
t R,a
t R,m
t R,m
t R,h
t R,h
t R,c
t R,c
z

}|

C3,det →

{

C3 →

z }| { z }| {
1
1
dD
=
· C3,det +
· C3
dt
tD
tD
Table 4: The model parameters, with the unknown parameters to be estimated denoted in boldface. The unknown parameters Ki , Sym , and dSys are taken to be time-varying. The unknown parameters f sympt and f severe are taken to be intrinsic
properties of the disease and therefore constant numbers. The detection probability of asymptomatic cases is taken to be known
and zero. Units of time are days.
Parameter

Description

Value

N
reduced

Total population
The property that a detected case is likely to transmit less, via successful
quarantine)
Transmission rate
Detection probability of asymptomatic cases
Fraction of positive cases that produce symptoms
Time from exposure to infection
Time to recovery for asymptomatics

9,000,000
0.2

Ki ( t )
d As (t)
fsympt
tin f ection
t R,a
dSym (t)
dSys (t)
fsevere
tsympt
t R,m
fH
fC
fD
tH
t R,h
tC
t R,c
tD

Detection probability of mild symptomatics
Detection probability of severe symptomatics
Fraction of symptomatics that are severe
Time to symptoms, for symptomatics
Time from symptoms to recovery, for mild symptomatics
Fraction of severe cases that are hospitalized and then recover: f H =
1.0 − f C − f D
Fraction of severe cases that require critical care and then recover
Fraction of severe cases that die
Time from symptoms to hospital, for severe symptomatics
Time from entering hospital to recovery, for severe symptomatics that
do not require critical care
Time from entering hospital to critical care, for severe symptomatics
Time from entering critical care to recovery for severe symptomatics
Time from entering critical care to death, for severe symptomatics

See Appendix B
0.0
0.6 [39]
4.0 [41]
8.0 Assumed to be
same as t R,m
See Appendix B
See Appendix B
0.07 [40]
4.0 [41, 42]
8.0 [43]a
0.66
0.3 [44]
0.04 [45]
5.0 [46]
10.0 [44, 45]
5.0 [46]
10.0 [47]
5.0 [48]

a As

described in [43], viral load can be high and detectable for up to 20 days. We choose a shorter duration of infectiousness to capture
the time during which transmissibility is highest.

Appendix B: Unknown time-varying parameters to be estimated
The unknown parameters assumed to be time-varying are the transmission rate Ki , and the detection probabilities
dSym and dSys for mild and severe symptomatic cases, respectively.
The transmission rate in a given population for a given infectious disease is measured in effective contacts per
unit time. This may be expressed as the total contact rate (the total number of contacts, effective or not, per unit
time), multiplied by the risk of infection, given contact between an infectious and a susceptible individual. The total
contact rate can be impacted by social behavior.
In this first employment of SDA upon a pandemic model of such high dimensionality, we chose to represent Ki as
a relatively constant value that undergoes one rapid transition corresponding to a single social distancing mandate.
As noted in Experiments, social distancing rules were imposed in New York City roughly 25 days following the first
12

reported case. We thus chose Ki to transition between two relatively constant levels, roughly 25 days following time
t0 . Specifically, we wrote Ki (t) as:
Ki (t) = − f ·

1
e(T −t)/s

+1

+ ξ.

The parameter T was set to 25, beginning four days prior to the first report of a detection in NYC [34] to the imposition
of a stay-home order in NYC on March 22 [38]. The parameter s governs the steepness of the transformation, and
was set to 10. Parameters f and ξ were then adjusted to 1.2 and 1.5, to achieve a transition from about 1.4 to 0.3.
For detection probabilities dSym and dSys , a linear and quadratic form, respectively, were chosen to preclude
symmetries, and both were optimistically taken to increase with time:
dSym(t) = 0.2 · t
dSys(t) = 0.1 · t2
Finally, each time series was normalized to the range: [0:1], via division by their respective maximum values.

Appendix C: Technical details of the inference experiments
The simulated data were generated by integrating the reaction equations (Appendix A) via a fourth-order adaptive
Runge-Kutta method encoded in the Python package odeINT. A step size of one (day) was used to record the
output. Except for the one instance noted in Results regarding Experiment i, we did not examine the sensitivity of
estimations to the temporal sparsity of measurements. The initial conditions on the populations were: S0 = N − 1
(where N is the total population), As0 = 1, and zero for all others.
For the noise experiments, the noise added to the simulated Symdet , Sysdet , and R data were generated by Python’s
numpy.random.normal package, which defines a normal distribution of noise. For the “low-noise” experiments, we
set the standard deviation to be the respective mean of each distribution, divided by 100. For the experiments using
higher noise, we multiplied that original level by a factor of ten. For each noisy data set, the absolute value of the
minimum was then added to each data point, so that the population did not drop below zero.
The optimization was performed via the open-source Interior-point Optimizer (Ipopt) [49]. Ipopt uses a
SimpsonâĂŹs rule method of finite differences to discretize the state space, a NewtonâĂŹs method to search, and
a barrier method to impose user-defined bounds that are placed upon the searches. We note that Ipopt’s search
algorithm treats state variables as independent quantities, which is not the case for a model involving a closed
population. This feature did not affect the results of this paper. Those interested in expanding the use of this tool,
however, might keep in mind this feature. One might negate undesired effects by, for example, imposing equality
constraints into the cost function that enforce the conservation of N.
Within the annealing procedure described in Methods, the parameter α was set to 2.0, and β ran from 0 to 38 in
increments of 1. The inverse covariance matrix for measurement error (Rm ) was set to 1.0, and the initial value of the
inverse covariance matrix for model error (R f ,0 ) was set to 10−7 .
For each of the four simulated experiments, twenty paths were searched, beginning at randomly-generated initial
conditions for parameters and state variables. All simulations were run on a 720-core, 1440-GB, 64-bit CPU cluster.

References
[1] IHME COVID-19 health service utilization forecasting Team and Christopher JL Murray. Forecasting COVID-19
impact on hospital bed-days, ICU-days, ventilator-days and deaths by US state in the next 4 months. medRxiv,
page 2020.03.27.20043752, March 2020. Publisher: Cold Spring Harbor Laboratory Press.
[2] Misty Heggeness. The need for data innovation in the time of covid-19. https://www.minneapolisfed.org/
article/2020/the-need-for-data-innovation-in-the-time-of-covid-19. Accessed: 2020-05-17.

13

[3] Daniel Weinberger, Ted Cohen, Forrest Crawford, Farzad Mostashari, Don Olson, Virginia E Pitzer, Nicholas G
Reich, Marcus Russi, Lone Simonsen, Annie Watkins, et al. Estimating the early death toll of covid-19 in the
united states. Medrxiv, 2020.
[4] Ruiyun Li, Sen Pei, Bin Chen, Yimeng Song, Tao Zhang, Wan Yang, and Jeffrey Shaman. Substantial undocumented infection facilitates the rapid dissemination of novel coronavirus (sars-cov-2). Science, 368(6490):489–493,
2020.
[5] Albert Tarantola. Inverse problem theory and methods for model parameter estimation. SIAM, 2005.
[6] Ryuji Kimura. Numerical weather prediction. Journal of Wind Engineering and Industrial Aerodynamics, 90(1215):1403–1414, 2002.
[7] Eugenia Kalnay. Atmospheric modeling, data assimilation and predictability. Cambridge university press, 2003.
[8] Geir Evensen. Data assimilation: the ensemble Kalman filter. Springer Science & Business Media, 2009.
[9] John T Betts. Practical methods for optimal control and estimation using nonlinear programming, volume 19. Siam,
2010.
[10] William G Whartenby, John C Quinn, and Henry DI Abarbanel. The number of required observations in data
assimilation for a shallow-water flow. Monthly Weather Review, 141(7):2502–2518, 2013.
[11] Zhe An, Daniel Rey, Jingxin Ye, and Henry DI Abarbanel. Estimating the state of a geophysical system with
sparse observations: time delay methods to achieve accurate initial states for prediction. Nonlinear Processes in
Geophysics (Online), 24(1), 2017.
[12] Steven J Schiff. Kalman meets neuron: the emerging intersection of control theory with neuroscience. In 2009
Annual International Conference of the IEEE Engineering in Medicine and Biology Society, pages 3318–3321. IEEE,
2009.
[13] Bryan A Toth, Mark Kostuk, C Daniel Meliza, Daniel Margoliash, and Henry DI Abarbanel. Dynamical
estimation of neuron and network properties i: variational methods. Biological cybernetics, 105(3-4):217–237,
2011.
[14] Mark Kostuk, Bryan A Toth, C Daniel Meliza, Daniel Margoliash, and Henry DI Abarbanel. Dynamical
estimation of neuron and network properties ii: path integral monte carlo methods. Biological cybernetics,
106(3):155–167, 2012.
[15] Franz Hamilton, Tyrus Berry, Nathalia Peixoto, and Timothy Sauer. Real-time tracking of neuronal network
structure using data assimilation. Physical Review E, 88(5):052715, 2013.
[16] C Daniel Meliza, Mark Kostuk, Hao Huang, Alain Nogaret, Daniel Margoliash, and Henry DI Abarbanel.
Estimating parameters and predicting membrane voltages with conductance-based neuron models. Biological
cybernetics, 108(4):495–516, 2014.
[17] Alain Nogaret, C Daniel Meliza, Daniel Margoliash, and Henry DI Abarbanel. Automatic construction of
predictive neuron models through large scale assimilation of electrophysiological data. Scientific reports,
6(1):1–14, 2016.
[18] Eve Armstrong. Statistical data assimilation for estimating electrophysiology simultaneously with connectivity
within a biological neuronal network. Physical Review E, 101(1):012415, 2020.
[19] Luís MA Bettencourt, Ruy M Ribeiro, Gerardo Chowell, Timothy Lant, and Carlos Castillo-Chavez. Towards
real time epidemiology: data assimilation, modeling and anomaly detection of health surveillance data streams.
In NSF Workshop on Intelligence and Security Informatics, pages 79–90. Springer, 2007.
14

[20] CJ Rhodes and T Déirdre Hollingsworth. Variational data assimilation with epidemic models. Journal of
theoretical biology, 258(4):591–602, 2009.
[21] Loren Cobb, Ashok Krishnamurthy, Jan Mandel, and Jonathan D Beezley. Bayesian tracking of emerging
epidemics using ensemble optimal statistical interpolation. Spatial and spatio-temporal epidemiology, 10:39–48,
2014.
[22] Luis MA Bettencourt and Ruy M Ribeiro. Real time bayesian estimation of the epidemic potential of emerging
infectious diseases. PLoS One, 3(5), 2008.
[23] Jörn Lothar Sesterhenn. Adjoint-based data assimilation of an epidemiology model for the covid-19 pandemic
in 2020. arXiv preprint arXiv:2003.13071, 2020.
[24] Philip Nadler, Shuo Wang, Rossella Arcucci, Xian Yang, and Yike Guo. An epidemiological modelling approach
for covid19 via data assimilation. arXiv preprint arXiv:2004.12130, 2020.
[25] Henry Abarbanel. Predicting the future: completing models of observed complex systems. Springer, 2013.
[26] Henry DI Abarbanel, P Bryant, Philip E Gill, Mark Kostuk, Justin Rofeh, Zakary Singer, Bryan Toth, Elizabeth
Wong, and M Ding. Dynamical parameter and state estimation in neuron models. The dynamic brain: an
exploration of neuronal variability and its functional significance, 2011.
[27] Jingxin Ye, Paul J Rozdeba, Uriel I Morone, Arij Daou, and Henry DI Abarbanel. Estimating the biophysical
properties of neurons with intracellular calcium dynamics. Physical Review E, 89(6):062714, 2014.
[28] Daniel Rey, Michael Eldridge, Mark Kostuk, Henry DI Abarbanel, Jan Schumann-Bischoff, and Ulrich Parlitz.
Accurate state and parameter estimation in nonlinear systems with sparse observations. Physics Letters A,
378(11-12):869–873, 2014.
[29] J Ye, N Kadakia, PJ Rozdeba, HDI Abarbanel, and JC Quinn. Improved variational methods in statistical data
assimilation. Nonlinear Processes in Geophysics, 22(2):205–213, 2015.
[30] Nirag Kadakia, Eve Armstrong, Daniel Breen, Uriel Morone, Arij Daou, Daniel Margoliash, and Henry DI
Abarbanel. Nonlinear statistical data assimilation for HVCRA neurons in the avian song system. Biological
Cybernetics, 110(6):417–434, 2016.
[31] Jun Wang, Daniel Breen, Abraham Akinin, Henry DI Abarbanel, and Gert Cauwenberghs. Data assimilation of
membrane dynamics and channel kinetics with a neuromorphic integrated circuit. In Biomedical Circuits and
Systems Conference (BioCAS), 2016 IEEE, pages 584–587. IEEE, 2016.
[32] Eve Armstrong, Amol V Patwardhan, Lucas Johns, Chad T Kishimoto, Henry DI Abarbanel, and George M
Fuller. An optimization-based approach to calculating neutrino flavor evolution. Physical Review D, 96(8):083008,
2017.
[33] Jingxin Ye, Daniel Rey, Nirag Kadakia, Michael Eldridge, Uriel I Morone, Paul Rozdeba, Henry DI Abarbanel,
and John C Quinn. Systematic variational method for statistical nonlinear state and parameter estimation.
Physical Review E, 92(5):052901, 2015.
[34] First reported confirmation of coronavirus in New York City. https://www.nytimes.com/2020/03/01/
nyregion/new-york-coronvirus-confirmed.html. Accessed: 2020-05-19.
[35] RN Thompson, JE Stockwin, RD van Gaalen, JA Polonsky, ZN Kamvar, PA Demarsh, E Dahlqwist, S Li, Eve
Miguel, T Jombart, et al. Improved inference of time-varying reproduction numbers during infectious disease
outbreaks. Epidemics, 29:100356, 2019.

15

[36] Anne Cori, Neil M Ferguson, Christophe Fraser, and Simon Cauchemez. A new framework and software to
estimate time-varying reproduction numbers during epidemics. American journal of epidemiology, 178(9):1505–
1512, 2013.
[37] Jacco Wallinga and Peter Teunis. Different epidemic curves for severe acute respiratory syndrome reveal similar
impacts of control measures. American Journal of epidemiology, 160(6):509–516, 2004.
[38] PAUSE order in New York City takes effect 2020 March 22. https://www.governor.ny.gov/news/
governor-cuomo-signs-new-york-state-pause-executive-order. Accessed: 2020-05-19.
[39] Daniel P. Oran and Eric J. Topol. Getting a handle on asymptomatic SARS-CoV-2 infection. https://www.
scripps.edu/science-and-medicine/translational-institute/about/news/sarc-cov-2-infection/. Accessed: 2020-05-24.
[40] Henrik Salje, Cécile Tran Kiem, Noémie Lefrancq, Noémie Courtejoie, Paolo Bosetti, Juliette Paireau, Alessio
Andronico, Nathanaël Hoze, Jehanne Richet, Claire-Lise Dubost, et al. Estimating the burden of sars-cov-2 in
france. Science, 2020.
[41] Ruiyun Li, Sen Pei, Bin Chen, Yimeng Song, Tao Zhang, Wan Yang, and Jeffrey Shaman. Substantial undocumented infection facilitates the rapid dissemination of novel coronavirus (SARS-CoV-2). Science, 368(6490):489–
493, May 2020.
[42] Qin Jing, Chong You, Qiushi Lin, Taojun Hu, Shicheng Yu, and Xiao-Hua Zhou. Estimation of incubation period
distribution of COVID-19 using disease onset forward time: a novel cross-sectional and forward follow-up
study. medRxiv, page 2020.03.06.20032417, March 2020. Publisher: Cold Spring Harbor Laboratory Press.
[43] Roman WÃűlfel, Victor M. Corman, Wolfgang Guggemos, Michael Seilmaier, Sabine Zange, Marcel A. MÃijller,
Daniela Niemeyer, Terry C. Jones, Patrick Vollmar, Camilla Rothe, Michael Hoelscher, Tobias Bleicker, Sebastian
BrÃijnink, Julia Schneider, Rosina Ehmann, Katrin Zwirglmaier, Christian Drosten, and Clemens Wendtner.
Virological assessment of hospitalized patients with COVID-2019. Nature, 581(7809):465–469, May 2020.
[44] Joseph A Lewnard, Vincent X Liu, Michael L Jackson, Mark A Schmidt, Britta L Jewell, Jean P Flores, Chris Jentz,
Graham R Northrup, Ayesha Mahmud, Arthur L Reingold, et al. Incidence, clinical outcomes, and transmission
dynamics of hospitalized 2019 coronavirus disease among 9,596,321 individuals residing in california and
washington, united states: a prospective cohort study. medRxiv, 2020.
[45] Dawei Wang, Bo Hu, Chang Hu, Fangfang Zhu, Xing Liu, Jing Zhang, Binbin Wang, Hui Xiang, Zhenshun
Cheng, Yong Xiong, Yan Zhao, Yirong Li, Xinghuan Wang, and Zhiyong Peng. Clinical Characteristics of
138 Hospitalized Patients With 2019 Novel CoronavirusâĂŞInfected Pneumonia in Wuhan, China. JAMA,
323(11):1061–1069, March 2020. Publisher: American Medical Association.
[46] Chaolin Huang, Yeming Wang, Xingwang Li, Lili Ren, Jianping Zhao, Yi Hu, Li Zhang, Guohui Fan, Jiuyang
Xu, Xiaoying Gu, et al. Clinical features of patients infected with 2019 novel coronavirus in wuhan, china. The
lancet, 395(10223):497–506, 2020.
[47] Qifang Bi, Yongsheng Wu, Shujiang Mei, Chenfei Ye, Xuan Zou, Zhen Zhang, Xiaojian Liu, Lan Wei, Shaun A
Truelove, Tong Zhang, et al. Epidemiology and transmission of covid-19 in shenzhen china: Analysis of 391
cases and 1,286 of their close contacts. MedRxiv, 2020.
[48] Xiaobo Yang, Yuan Yu, Jiqian Xu, Huaqing Shu, Hong Liu, Yongran Wu, Lu Zhang, Zhui Yu, Minghao Fang,
Ting Yu, et al. Clinical course and outcomes of critically ill patients with sars-cov-2 pneumonia in wuhan, china:
a single-centered, retrospective, observational study. The Lancet Respiratory Medicine, 2020.
[49] Andreas Wächter. Short tutorial: getting started with ipopt in 90 minutes. In Dagstuhl Seminar Proceedings.
Schloss Dagstuhl-Leibniz-Zentrum für Informatik, 2009.

16

