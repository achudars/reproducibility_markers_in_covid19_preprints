Mobile smartphone tracing can detect almost all SARS-CoV-2
infections

arXiv:2006.14285v2 [cs.SI] 21 Sep 2020

Bastian Prasse∗ and Piet Van Mieghem∗
Delft University of Technology
September 21, 2020

Abstract
Currently, many countries are considering the introduction of tracing software on mobile smartphones with the main purpose to inform and alarm the mobile app user. Here, we demonstrate that,
in addition to alarming and informing, mobile tracing can detect nearly all users that are infected
by SARS-CoV-2. Our algorithm BETIS (Bayesian Estimation for Tracing Infection States) makes
use of self-reports of the user’s health status. Then, BETIS guarantees that almost all SARSCoV-2 infections of the group of users can be detected. Furthermore, BETIS estimates the virus
prevalence in the whole population, consisting of users and non-users. BETIS is based on a hidden
Markov epidemic model and recursive Bayesian filtering. The potential that mobile tracing apps,
in addition to medical testing and quarantining, can eradicate COVID-19 may persuade citizens to
trade-off privacy against public health.

1

Introduction

The COVID-19 pandemic triggered firm lockdowns of societies and economies around the world.
Lockdown measures must be released gently and, if necessary, retightened to avoid a dramatic second
wave of COVID-19. To trace the pandemic, smartphone apps have recently received a lot of attention
[1, 2, 3]. A particular challenge to estimating the prevalence of COVID-19 are the asymptomatic
infections. Recent contact apps aim to alarm the user of a potential infection, if the user has been
close to another user with a confirmed SARS-CoV-2 infection. Alarming individuals by contact apps is
a particular method of social alertness [4, 5, 6, 7, 8]. If alerted, individuals are more cautious and less
likely to become infected. For a comparison of the effect of social alertness and social distancing, we
refer the reader to [9].The awareness of potential infections may lead to suppression of the virus [10].
The intended use of some smartphone app goes beyond alarming individuals. For instance, in the
COVID Symptom Study [3], smartphone users provide their health status as a self-report via an app
on a daily basis. The self reports include user information, such as age and location, and potential
COVID-19 symptoms, such as fever or loss of smell and taste. The self-reports aid at identifying
emerging geographical hotspots of SARS-CoV-2 infections.
Faculty of Electrical Engineering, Mathematics and Computer Science, P.O Box 5031, 2600 GA Delft, The Netherlands; email : b.prasse@tudelft.nl, p.f.a.vanmieghem@tudelft.nl
∗

1

Previous studies [11, 12, 13, 2] consider aggregated location information, in the form of mobility
flow or population density. Here, we explore the full potential of location information for tracing
the spread of COVID-19. More precisely, given the locations of the app users, our algorithm called
BETIS, Bayesian Estimation for Tracing Infection States, finds nearly all infected users. Furthermore,
BETIS traces the total number of infections in the whole population, consisting of users and non-users.
Hence, complementing BETIS with boarder control, medical testing and quarantine enforcement is a
second potential pillar, besides vaccine development, to eradicate the coronavirus. Since society seems
convinced that the only hope to abandon the destructive impact of COVID-19 is a vaccine, we believe
that BETIS is a worthy second horse in the race.

2

Epidemic model

We consider the spread of SARS-CoV-2 among N individuals. The individuals i = 1, ..., Nu , with
Nu ≤ N , are users of the smartphone app. Thus, the fraction of smartphone users equals c0 = Nu /N ,
while the remaining individuals Nu + 1, ..., N do not use the app. Every user i = 1, ..., Nu reports
COVID-19 related symptoms through the app, e.g., via a questionnaire [3]. At any discrete time k ∈ N,
every individual i has a viral state Xi [k] ∈ C. The set of compartments equals C = {S, Sfa , E, I, Ia , R}.
The state Xi [k] = S denotes that individual i is susceptible (healthy). There are other diseases with
similar symptoms as COVID-19, for instance influenza. Thus, the self-reports via the app might
produce false alarms, which point erroneously to a SARS-CoV-2 infection while the individual suffers
from another disease. The viral state Xi [k] = Sfa indicates that individual i is infected by a disease
other than COVID-19 with similar symptoms. The exposed state Xi [k] = E denotes that individual i
is infected by SARS-CoV-2 but not contagious yet. After the exposed state E, an individual becomes
either infectious symptomatic I or infectious asymptomatic Ia . Individuals in either infectious state
I and Ia are contagious to susceptible individuals in their vicinity. After some time, symptomatic
infected individuals in I transition to the symptomatic removed state R, due to recovery, quarantine,
hospitalisation or death. Removed individuals in R cannot infect susceptible individuals any longer.
We assume that a recovered individual is immune. Hence, multiple infections do not occur.
The BETIS algorithm estimates the viral states Xi [k] of an app user i. Additionally to the health
self-reports, BETIS uses the neighbourhood Nu,i [k] ⊂ {1, ..., Nu } for each user i = 1, ..., Nu . The
neighbourhood Nu,i [k] consists of the contacts of user i to other users at time k. Two users are
“in contact” with each other, if the users are physically close for a sufficiently long time period. For
instance, the NHS Test and Trace service define a contact when users are within 2 meters of each other
for more than 15 minutes [14]. The neighbourhood Nu,i [k] can be obtained in two ways: The mobile
app can perform direct measurements of the neighbourhood Nu,i [k], e.g., by Bluetooth. Alternatively,
the app can use a 2 × 1 location vector zi [k] ∈ R2 , which specifies the latitude and longitude of user
i at time k and can be obtained, for instance, by GPS. The neighbourhood of user i is obtained from
the location vector zi [k] by

Nu,i [k] = j = 1, ..., Nu , j 6= i kzi [k] − zj [k]k2 ≤ dinf
for some distance dinf . The sole location information in the BETIS estimation algorithm are the
neighbourhoods Nu,i [k]. We do not distinguish between neighbourhoods Nu,i [k] that were measured
2

directly, by Bluetooth, or indirectly, by GPS coordinates. For the individuals i = Nu + 1, ..., N ,
who do not use the app, neither location information nor health self-reports are available. Since
location information for non-users i = Nu + 1, ..., N is not available, non-users are not registered in
the neighbourhood Nu,j [k] of a user j = 1, ..., Nu . The complete neighbourhood of an individual i,
consisting of both users and non-users, is denoted by

Ni [k] = j = 1, ..., N, j 6= i kzi [k] − zj [k]k2 ≤ dinf .

(1)

In contrast to the neighbourhood Nu,i [k] of users, the neighbourhood Ni [k] is not measured. The
number of contacts with non-users is denoted by
Nnonuser,i [k] = |Ni [k]| − |Nu,i [k]| .
We assume that the distribution of the number of neighbours Nnonuser,i [k],
f (m) = Ei,k [Pr [Nnonuser,i [k] = m]] ,
is known, where the expectation computed with respect to every user i and all times k. The average
distribution f (m) of contacts with non-users can be obtained from a representative subgroup of the
population.
We model the spread of COVID-19 by a hidden Markov model, which consists of two parts. First,
the dynamics of the viral state Xi [k]. Second, the user behaviour of reporting their viral state Xi [k].

2.1

Dynamics of the viral state Xi [k]

Consider the infection of a susceptible individual i, with Xi [k] = S or Xi [k] = Sfa . Then, individual i
traverses the viral states E → I → R for a symptomatic infection. Analogously, the course of an
asymptomatic infection is E → Ia → R. The dynamics of the hidden Markov model are determined
by the transition probabilities between the viral states. A susceptible individual i without symptoms,
Xi [k] = S, contracts a disease with similar symptoms to COVID-19 with the probability ϑ,


Pr Xi [k + 1] = Sfa Xi [k] = S = ϑ,
and cures with the curing probability δ,


Pr Xi [k + 1] = S Xi [k] = Sfa = δ.
An infectious individual j, with Xj [k] = I or Xj [k] = Ia , infects a susceptible individual i with the
infection probability β, if individual j is in the neighbourhood Ni [k] of individual i. The infection
probability β depends on the contagiousness of SARS-CoV-2 and on the prevalence of facemasks and
other spread reduction measures. The set

Ninf,i [k] = j ∈ Ni [k] Xj [k] = I or Xj [k] = Ia
consists of all infectious individuals j, users and non-users, that are close to individual i at time k.
The number of infectious neighbours of individual i at time k is denoted by |Ninf,i [k]|. The probability

3

of an infection of individual i follows from potential infections by any individual j in the set Ninf,i [k]
as


Pr Xi [k + 1] = E Xi [k] ∈ {S, Sfa }, Ninf,i [k] = 1 − (1 − β)|Ninf,i [k]| .
(2)

Individuals leave the exposed state E with the incubation probability



if
γα

 
Pr Xi [k + 1] = c Xi [k] = E = γ (1 − α) if



(1 − γ)
if

γ to an infectious state,
c = Ia ,
c = I,
c = E.

Here, α denotes the probability of an asymptomatic infection. Any symptomatic infected individual
is removed with the removal probability δ. In other words,


Pr Xi [k + 1] = R Xi [k] = I = δ.
(3)

Denote the first time that individual i is infected by kI,i , Xi [kI,i ] = I and Xi [kI,i − 1] = E. Similarly,
denote the first time that individual i is removed by kR,i . Since the viral state compartments are in
the order E → I → R, it holds that kR,i > kI,i . The sojourn time kR,i − kI,i of state I is the number
of discrete times k that individual i has been infected. By (3), we implicitly assume that the sojourn
time follows a geometric distribution with mean 1/δ.

2.2

Reporting the viral state Xi [k]

If a user experiences COVID-19 related symptoms at time k, then the users submits a health report.
We denote the reported viral state of user i as Xrep,i [k]. Since the users themselves report their
health status, the reported viral state Xrep,i [k] might be inaccurate. At every time k, the reported
state Xrep,i [k] equals either: healthy S; contracted a disease other than COVID-19, Sfa ; or infected
by COVID-19, I. A user i without symptoms, Xi [k] ∈ {S, E, Ia , R}, reports a healthy viral state
Xrep,i [k] = S. Thus, BETIS considers that asymptomatic infections in Ia cannot be detected by
self-reports. If user i experiences symptoms that are related to COVID-19, Xi [k] = Sfa or Xi [k] = I,
then user i specifies the symptoms via a health report in the app. Based on the health report, a
user i with symptoms is classified either as suffering from COVID-19, Xrep,i [k] = I, or from another
disease, Xrep,i [k] = Sfa . Since the symptoms of COVID-19 overlap with symptoms of other diseases,
the reported viral states Xrep,i [k] = I and Xrep,i [k] = Sfa can be erroneous. The errors in the reported
viral state Xrep,i [k] are described by the test statistics

 pfa

if c = I,
Pr Xrep,i [k] = c Xi [k] = Sfa =
1 − p
if c = S ,
fa

fa

and





Pr Xrep,i [k] = c Xi [k] = I =


p

tp

1 − p

tp

if

c = I,

if

c = Sfa .

Hence, the accuracy of the health report is given by1 the false alarm probability pfa and the true
positive rate ptp .
1

In the terminology of medical testing [15], the probabilities ptp and (1 − pfa ) are known as sensitivity and specificity,
respectively.

4

3

Who is infected?

At time k, we would like to know who is infected by COVID-19. In other words, for every user i,
BETIS computes the symptomatic infection risk
Pr [Xi [k] = I |M[k] ]

(4)

and the asymptomatic infection risk
Pr [Xi [k] = Ia |M[k] ] .
Here, we formally define all observations, or measurements, up until time k as M[k]. More specifically,
the set M[k] specifies the reported viral state Xrep,i [l] and the measured neighbourhood Nu,i [l] of every
user i = 1, ..., Nu at every time l ≤ k. In Appendix A, we propose a recursive Bayesian filtering method
to (approximately) compute the infection risks Pr [Xi [k] = I |M[k] ] and Pr [Xi [k] = Ia |M[k] ]. As a
side product, we obtain the probabilities Pr [Xi [k] = c |M[k] ] for the other viral states c = S, Sfa , E, R.
The computation time is polynomial in the number of individuals N and the number of observations k.
We perform simulations of the epidemic model (Section 2) with N = 10, 000 moving individuals
and vary the fraction of app users c0 . The false alarm probability is set to pfa = 0.1 and the positive
rate to ptp = 0.9. We assume that none of the initial viral states X1 [1], ..., XN [1] is known to the
BETIS estimation method. Instead, we solely assume that the prior distribution of the viral state
Xi [1] is known. For further details on the parameter settings, we refer to Appendix B.

3.1

Tracing the number of infections

Can BETIS estimate the evolution of the total number of infections in the population? First, we
define Iall [k] as the true number of individuals, users and non-users, whose viral state Xi [k] = I.
BETIS computes the infection risks Pr [Xi [k] = I |M[k] ] of the users i = 1, ..., Nu . Thus, we obtain
an estimate of the number of infected individuals, users and non-users, as
Îall [k] =

Nu
N X
Pr [Xi [k] = I |M[k] ] .
Nu
i=1

For the asymptomatic infections, the quantities Ia,all [k] and Îa,all [k] are defined analogously.
Figure 1 demonstrates the accuracy of the estimated number of symptomatic infections Îall [k] and
asymptomatic infections Îa,all [k], for different fractions c0 of individuals that use the app. Unsurprisingly, the symptomatic infections Iall [k] are traced more accurately than the asymptomatic infections
Ia,all [k]. For all fractions c0 , the simulations indicate that the BETIS estimates Îall [k] and Îa,all [k]
are greater than2 the true number of infections Iall [k], Ia, all [k]. From a societal point of view, overestimations give safe-side warnings, resulting in a positive property of BETIS. Overall, even if only
c0 = 20% individuals are users, the epidemic outbreak is traced reasonably well.
2

It is an open challenge to rigorously show that the BETIS overestimates the true number of infections, Îall [k] >
Iall [k] and Îa,all [k] > Ia,all [k], respectively. In [16, 17] for the N -intertwined mean-field approximation (NIMFA) of
the susceptible-infected-susceptible (SIS) epidemic process, it is shown that infection states are positively correlated,
implying that an infection somewhere in the network cannot lower the probability of infection somewhere else. BETIS
assumes in (6) stochastic independence of infection states of different users, and ignoring correlations may explain the
overestimations of BETIS.

5

Number of cases

400

Iall [k]

Îall [k], c0 = 1

Îall [k], c0 = 0.8

Îall [k], c0 = 0.2

200

0
0

20

40

60

80

100

120

140

160

180

200

Time k

Number of cases

(a) Symptomatic infections Iall [k].

Ia,

100

all [k]

Îa,all [k], c0 = 1

Îa,all [k], c0 = 0.8

Îa,all [k], c0 = 0.2

50

0
0

20

40

60

80

100

120

140

160

180

200

Time k
(b) Asymptomatic infections Ia,all [k].

Figure 1: Tracing the number of infections.The total number of symptomatic infections Iall [k] and
asymptomatic infections Ia,all [k] of all individuals versus time k, following the SIR epidemic model.
The fraction c0 of individuals, who are contact app users and report COVID-19 related symptoms,
is varied. Based on the self-reports, our BETIS algorithm produces estimates Îall [k], Îa,all [k] for the
total number of infections.

3.2

Identifying infected individuals

Beyond tracing the total number of SARS-CoV-2 infections, a tremendous challenge is to identify
which users are infected. BETIS approximates the posterior probability Pr [Xi [k] = c |M[k] ] for every
compartment c ∈ C. Thus, we obtain the Bayesian estimate of the viral state Xi [k] at any time k as
X̂i [k] = argmax Pr [Xi [k] = c |M[k] ] .

(5)

c∈C

At any time k, the number of true positive estimates of symptomatic infections equals the number
of users i for which both Xi [k] = I and X̂i [k] = I. Similarly, the false positive estimates equals the
number of users i for which Xi [k] 6= I but X̂i [k] = I. The number of true and false positive estimates
for asymptomatic infections is defined analogously.
In the following, we assume that a fraction of c0 = 0.6 individuals use the app. Figure 2 demonstrates the accuracy of identifying infectious individuals by the BETIS estimation algorithm. BETIS
performs well for identifying symptomatic infections: Almost every symptomatic infection is correctly
identified (true positives), with relatively few false positives. On the other hand, Figure 2 shows that
6

Number of cases

200
Infected users (symptomatic)
True positive
False positive

150
100
50
0
0

20

40

60

80

100

120

140

160

180

200

Time k

Number of cases

(a) Symptomatic infections.

Infected users (asymptomatic)
True positive
False positive

30
20
10
0
0

20

40

60

80

100

120

140

160

180

200

Time k
(b) Asymptomatic infections.

Figure 2: Identifying infected users. The solid line in the subplots depicts the number of users
with symptomatic and asymptomatic infections, respectively. The marks correspond to the number
of users that BETIS correctly (true positive) and incorrectly (false positive) identifies as infectious.
asymptomatic infections cannot be directly identified by (5): There is no user i whose most likely
state is asymptomatic infectious X̂i [k] = Ia , which contrasts the accuracy of BETIS in tracing the
total number of asymptomatic infections Ia, all [k], see Figure 1.
Nonetheless, we show in Figure 3 that BETIS is valuable for identifying asymptomatic infections.
Health agencies rely on reverse transcription polymerase chain reaction (RT-PCR) test methods to
accurately determine whether an individual is infected by SARS-CoV-2. In an ideal, utopian scenario,
there would be sufficient RT-PCR testing capacities to check every individual regularly, such that every asymptomatic infection would be detected timely. However, the testing capacities are insufficient,
and only a limited number of people can be tested by RT-PCR methods. Specifically, suppose that
only Ntest << N individuals can be tested for the identifying asymptomatic infections. Which Ntest
individuals are the most likely to suffer from an asymptomatic infection and return a positive test result? Our approach is to select those Ntest users who have the greatest probability of an asymptomatic
infection, Pr [Xi [k] = Ia |M[k] ], which is computed by BETIS.
Figure 3 shows that the contact app indeed helps in identifying users with asymptomatic infections.
We emphasise that Ntest = 100 tests corresponds to testing less than 2% of the users. Furthermore,

7

Number of cases

Infected users (asymptomatic)
True positive, Ntest = 100
True positive, Ntest = 500

30
20
10
0
0

20

40

60

80

100

120

140

160

180

200

Time k
Figure 3: Testing users without symptoms to identify asymptomatic infections. The solid
line depicts the number of users with an asymptomatic infection, where the total number of users equals
Nu = 6, 000. To detect asymptomatic infections, a limited number of Ntest users without symptoms
are tested for COVID-19. These Ntest tested users have the highest risk of an asymptomatic infection,
as computed by BETIS. The marks correspond to the number of positive test results.
group testing methods [18] are able to identify all infections within a group of Ntest individuals, by
using significantly less than Ntest tests. In particular, the combination of the group testing method
for SARS-CoV-2 by Shental et al. [19] with BETIS is a promising approach to detect the majority of
asymptomatic users.

3.3

Performance limits

The value of BETIS lies in jointly processing the location information and health reports of the users.
Thus, the accuracy of BETIS depends on the testing statistic of the self-reports. We deteriorate the
test statistics by increasing the false alarm probability to pfa = 0.2 and decreasing the true positive
rate to ptp = 0.75.
Figures 4–6, in comparison with Figures 1–3, shows that inaccurate health reports directly affect
the accuracy of tracing the number of infections and identifying infectious users. Hence, the development of accurate methods for assessing the user’s health status are important. Nonetheless, even for
inaccurate health reports, BETIS yields a valuable upper bound of the number of infections and helps
in identifying both symptomatic and asymptomatic infections.

4

Conclusions

This work considers the application of contact apps beyond alarming users of potential infections: the
detection of SARS-CoV-2 infections. The app tracks the location of the users, and inquires self-reports
of the user’s health status. No information is required on individuals that do not use the app.
We propose the BETIS algorithm for detecting infections, based on the measurements of the contact
app. BETIS detects the SARS-CoV-2 infections of every user within a reasonable accuracy, even if only
a fraction of the population use the contact app. Furthermore, in spite of many uncertainties, BETIS
operates on the safe-side of detection by surprisingly accurately overestimating infected individuals.
8

Number of cases

1,000

Iall [k]

Îall [k], c0 = 1

Îall [k], c0 = 0.8

Îall [k], c0 = 0.2

500

0
0

20

40

60

80

100

120

140

160

180

200

Time k
(a) Symptomatic infections Iall [k].

Number of cases

300
Ia,
200

all [k]

Îa,all [k], c0 = 1

Îa,all [k], c0 = 0.8

Îa,all [k], c0 = 0.2

100
0
0

20

40

60

80

100

120

140

160

180

200

Time k
(b) Asymptomatic infections Ia,all [k].

Number of cases

Figure 4: Tracing the number of infections (inaccurate health reports). The total number of
symptomatic infections Iall [k], asymptomatic infections Ia,all [k] and the respective BETIS estimates
Îall [k], Îa,all [k]. In comparison to Figure 1, the health report by the users is less reliable.

Infected users (symptomatic)
True positive
False positive

400

200

0
0

20

40

60

80

100

120

140

160

180

200

Time k
Figure 5: Identifying infected users (inaccurate health reports). The solid line depicts the
number of users with a symptomatic infection. The marks correspond to the number of users that
BETIS correctly (true positive) and incorrectly (false positive) identifies as infectious. In comparison
to Figure 2, the health report by the users is less reliable.

9

Number of cases

Infected users (asymptomatic)
True positive, Ntest = 100
True positive, Ntest = 500

30
20
10
0
0

20

40

60

80

100

120

140

160

180

200

Time k
Figure 6: Testing users without symptoms to identify asymptomatic infections (inaccurate
health reports). The solid line depicts the number of users with an asymptomatic infection, where
the total number of users equals Nu = 6, 000. The marks correspond to the number of positively
tested users, when Ntest users are tested. In comparison to Figure 3, the health report by the users is
less reliable.
BETIS thus constitutes a major tool for detecting infections in any pandemic.
We emphasise that there is a twofold benefit for every person who installs the app. First, every
single user actively contributes to tracing and eradicating SARS-CoV-2, which is advantageous to the
whole society. Second, there is an immediate personal benefit for every app user: am I infected or
not? The combination of contributing to society and gaining information on the personal health is a
great incentive to install the app.
The algorithmic framework of BETIS can be used as basis for further improvements. Of particular
interest are human mobility patterns, to obtain a more accurate estimate of the interactions between
users and non-users. Another direction is the use of measurements additional to the health self reports,
such as randomised COVID-19 tests of the whole population.

Acknowledgements
This work has been supported by the Universiteitsfonds Delft in the program TU Delft COVID-19
Response Fund.

References
[1] L. Ferretti, C. Wymant, M. Kendall, L. Zhao, A. Nurtay, L. Abeler-Dörner, M. Parker, D. Bonsall,
and C. Fraser, “Quantifying SARS-CoV-2 transmission suggests epidemic control with digital
contact tracing,” Science, vol. 368, no. 6491, 2020.
[2] N. Oliver, B. Lepri, H. Sterly, R. Lambiotte, S. Deletaille, M. De Nadai, E. Letouzé, A. A. Salah,
R. Benjamins, C. Cattuto,V. Colizza, N. de Cordes, S. P. Fraiberger, T. Koebe, S. Lehmann,
J. Murillo, A. Pentland, P. N Pham, F. Pivetta, J. Saramki, S. V. Scarpino, M. Tizzoni, S. Ver-

10

hulst, and P. Vinc, “Mobile phone data for informing public health actions across the COVID-19
pandemic life cycle,” Science Advances, 2020.
[3] D. A. Drew, L. H. Nguyen, C. J. Steves, C. Menni, M. Freydin, T. Varsavsky, C. H. Sudre,
M. J. Cardoso, S. Ourselin, J. Wolf, T. D. Spector, A. T. Chan, and COPE Consortium, “Rapid
implementation of mobile technology for real-time epidemiology of COVID-19,” Science, 2020.
[4] S. Funk, M. Salathé, and V. A. Jansen, “Modelling the influence of human behaviour on the
spread of infectious diseases: a review,” Journal of the Royal Society Interface, vol. 7, no. 50, pp.
1247–1256, 2010.
[5] I. Z. Kiss, J. Cassell, M. Recker, and P. L. Simon, “The impact of information transmission on
epidemic outbreaks,” Mathematical Biosciences, vol. 225, no. 1, pp. 1–10, 2010.
[6] F. D. Sahneh and C. Scoglio, “Epidemic spread in human networks,” Proc. IEEE Conf. Decision
Control, pp. 3008–3013, 2011.
[7] F. D. Sahneh, F. N. Chowdhury, and C. M. Scoglio, “On the existence of a threshold for preventive
behavioral responses to suppress epidemic spreading,” Scientific Reports, vol. 2, p. 632, 2012.
[8] G. Theodorakopoulos, J.-Y. Le Boudec, and J. S. Baras, “Selfish response to epidemic propagation,” IEEE Transactions on Automatic Control, vol. 58, no. 2, pp. 363–376, 2012.
[9] P. Schumm, W. Schumm, and C. Scoglio, “Impact of preventive behavioral responses to epidemics
in rural regions,” Procedia Computer Science, vol. 18, pp. 631–640, 2013.
[10] S. Funk, E. Gilad, C. Watkins, and V. A. Jansen, “The spread of awareness and its impact
on epidemic outbreaks,” Proceedings of the National Academy of Sciences, vol. 106, no. 16, pp.
6872–6877, 2009.
[11] M. Tizzoni, P. Bajardi, A. Decuyper, G. K. K. King, C. M. Schneider, V. Blondel, Z. Smoreda,
M. C. González, and V. Colizza, “On the use of human mobility proxies for modeling epidemics,”
PLoS Computational Biology, vol. 10, no. 7, p. e1003716, 2014.
[12] L. Bengtsson, J. Gaudart, X. Lu, S. Moore, E. Wetter, K. Sallah, S. Rebaudet, and R. Piarroux,
“Using mobile phone data to predict the spatial spread of cholera,” Scientific reports, vol. 5, p.
8923, 2015.
[13] F. Finger, T. Genolet, L. Mari, G. C. de Magny, N. M. Manga, A. Rinaldo, and E. Bertuzzo,
“Mobile phone data highlights the role of mass gatherings in the spreading of cholera outbreaks,”
Proceedings of the National Academy of Sciences, vol. 113, no. 23, pp. 6421–6426, 2016.

[14] “Guidance
for
contacts
of
people
with
confirmed
coronavirus
(COVID-19)
infection
who
do
not
live
with
the
person,”
https://www.gov.uk/government/publications/guidance-for-contacts-of-people-with-possible-or-c
accessed: 2020-08-25.

11

[15] R. Trevethan, “Sensitivity, specificity, and predictive values: foundations, pliabilities, and pitfalls
in research and practice,” Frontiers in Public Health, vol. 5, p. 307, 2017.
[16] P. Donnelly, “The correlation structure of epidemic models,” Mathematical Biosciences, vol. 117,
pp. 49–75, 1993.
[17] E. Cator and P. Van Mieghem, “Nodal infection in Markovian susceptible-infected-susceptible
and susceptible-infected-removed epidemics on networks are non-negatively correlated,” Physical
Review E, vol. 89, p. 052802, 2014.
[18] D. Du, and F. Hwang, Combinatorial group testing and its applications. World Scientific, 2020.
[19] N. Shental, S. Levy, V. Wuvshet, S. Skorniakov, B. Shalem, A. Ottolenghi, Y. Greenshpan,
R. Steinberg, A. Edri, R. Gillis, M. Goldhirsh, K. Moscovici, S. Sachren, L. M. Friedman,
L. Nesher, Y. Shemer-Avni, A. Porgador, and T. Hertz, “Efficient high-throughput SARS-CoV-2
testing to detect asymptomatic carriers,” Science Advances, p. eabc5961, 2020.
[20] P. Van Mieghem, Performance Analysis of Complex Networks and Systems. Cambridge University Press, 2014.
[21] Y. Hong, “On computing the distribution function for the Poisson binomial distribution,” Computational Statistics & Data Analysis, vol. 59, pp. 41–51, 2013.

A
A.1

The BETIS algorithm
Assumptions in the computations

We define the Nu × 1 viral state vector as X[k] = (X1 [k], ..., XNu [k])T . The reported viral state vector
Xrep [k] is defined analogously. We rely on three assumptions to compute the infection risk (4). First,
we assume the conditional stochastic independence
Nu


 Y
Pr Xi [k] Xrep,i [k], M[k − 1] .
Pr X[k] Xrep [k], M[k − 1] ≈



(6)

i=1

There are 6Nu possible combinations of the entries of the viral state vector X[k]. Thus, it is practically
impossible to state the full distribution of the vector X[k]. The assumption (6) instead implies that
the distribution of the vector X[k] can be decomposed into the marginal distribution of the entries
X1 [k], X2 [k], ..., XNu [k], which can be computed separately. Furthermore, assumption (6) might be of


relevance to privacy: The full distribution Pr X[k] Xrep [k], M[k − 1] is sensitive data. In contrast,


the single factors Pr Xi [k] Xrep,i [k], M[k − 1] might in parts be made accessible to some individuals.
Furthermore, we make the assumption that the viral state Xi [k] does not depend on the measured
neighbourhoods Nu,1 [k], ..., Nu,Nu [k] at time k. More precisely,




Pr Xi [k] Xrep,i [k], Nu,1 [k], ..., Nu,Nu [k], M[k − 1] = Pr Xi [k] Xrep,i [k], M[k − 1] .

(7)

The viral state Xi [k] does depend on the neighbourhoods Nu,i [k − 1] at the previous time step k − 1,
due to the infection probability (2). Thus, the impact of the location on the infection dynamics is
12

delayed by one time step, and we consider assumption (7) rather technical. Third, we assume the
analogue to (7) for the joint distribution of the random variables X1 [k], ..., XNu [k],




Pr X[k] Xrep [k], Nu,1 [k], ..., Nu,Nu [k], M[k − 1] = Pr X[k] Xrep [k], M[k − 1] .

A.2

(8)

Approximation of the infection probability

BETIS computes the infection risk (4) based on the hidden Markov epidemic model in Section 2.
However, the location of non-users is unknown. Hence, the set Ninf,i [k] of infectious neighbours is
not known, and the infection probability (2) cannot be computed directly. Instead, we resort to
approximating the infection probability (2), based on the neighbourhood of infected users as

Ninf,u,i [k] = j ∈ Nu,i [k] Xj [k] = I or Xj [k] = Ia .
In contrast to the complete infectious neighbourhood Ninf,i [k], the subset Ninf,u,i [k] can be inferred
from the measured neighbourhood Nu,i [k], as detailed in Subsection A.3.
With the set Ninf,u,i [k], we approximate the infection probability (2) in two steps. First, at any
time k, we approximate the probability that a randomly chosen non-user is infected (symptomatically
or asymptomatically) by averaging over the infection probability of the users as
pinf [k] =

Nu
1 X
(Pr [Xi [k] = I |M[k] ] + Pr [Xi [k] = Ia |M[k] ]) .
Nu
i=1

Then, the probability that, out of m randomly chosen non-users, l individuals are infected follows as
 
m l
pinf,l [k] =
pinf [k] (1 − pinf [k])m−l .
l
Thus, given that a user has m contacts with non-users, the probability of an infection by a non-user
equals
ǫ[k, m] =

m
X
l=0



pinf,l [k] 1 − (1 − β)l .

The distribution f (m) of the number of contacts with non-users is known. Hence, the probability that
a user is infected by a non-user is approximated by
ǫ[k] =

∞
X

f (m)ǫ[k, m].

(9)

m=0

Second, we use (9) to approximate the infection probability (2). More precisely, BETIS replaces the
exact probability (2) by


Pr Xi [k + 1] = E Xi [k] ∈ {S, Sfa }, |Ninf,u,i [k]| ≈ 1 − (1 − β)|Ninf,u,i [k]| (1 − ǫ[k]) .

A.3

Recursive Bayesian filtering

The infection risk (4) can be computed by iterating over time:

13

(10)

Initialisation At time k = 1, we assume that the probability distribution
Pr [Xi [1]]
is given for every user i = 1, ..., Nu . Formally, we can write


Pr [Xi [1]] = Pr Xi [1] M[0] ,

(11)

since there are no observations at time k = 0. (Or, the set of observation M[0] at time k = 0 is
empty, because we start measuring at k = 1.)


Measurement update We are given the distribution Pr Xi [k] M[k − 1] for every user i. (Starting
with (11) at time k = 1.) For every user i, the measurement update incorporates the reported
viral state Xrep,i [k] to obtain a more accurate distribution of the viral state Xi [k]. More precisely,


we compute the probability Pr Xi [k] Xrep,i [k], M[k − 1] with Bayes’ Theorem [20] as

 


 Pr Xrep,i [k] Xi [k], M[k − 1] Pr Xi [k] M[k − 1]


.
Pr Xi [k] Xrep,i [k], M[k − 1] =
Pr Xrep,i [k] M[k − 1]
Given the viral state Xi [k], the reported viral state Xrep,i [k] does not depend on past measurements M[k − 1], and hence

 


 Pr Xrep,i [k] Xi [k] Pr Xi [k] M[k − 1]


.
(12)
Pr Xi [k] Xrep,i [k], M[k − 1] =
Pr Xrep,i [k] M[k − 1]


The distribution Pr Xrep,i [k] Xi [k] is specified by the observation model in Subsection 2.2. In
particular, for Xrep,i [k] = R, it holds that


 1
if c = R,
Pr Xrep,i [k] = R Xi [k] = c, M[k − 1] =
0
if c 6= R.
If user i reports to be healthy, Xrep,i [k] = S, then we obtain that



if
1

 
Pr Xrep,i [k] = S Xi [k] = c, M[k − 1] = 1 − pfa if



0
if

Similarly, if user i reports to be infected, Xrep,i [k] = I, then



1

 
Pr Xrep,i [k] = I Xi [k] = c, M[k − 1] = pfa



0

c ∈ {E, Ia , Ra },
c = S,
c ∈ {I, R}.

it holds that

if

c = I,

if

c = S,

if

c ∈ {E, R, Ia , Ra }.

The denominator in (12) follows from the law of total probability [20] as

 X 
 

Pr Xrep,i [k] Xi [k] = c Pr Xi [k] = c M[k − 1] .
Pr Xrep,i [k] M[k − 1] =
c∈C

14



Time update The measurement update computes the distribution Pr Xi [k] Xrep,i [k], M[k − 1] ,


from which the time update obtains the distribution Pr Xi [k + 1] M[k] . The law of total
probability yields that

 X 

Pr Xi [k + 1] M[k] =
Pr Xi [k + 1], Xi [k] = c M[k]
c∈C

=

X
c∈C


 

Pr Xi [k + 1] Xi [k] = c, M[k] Pr Xi [k] = c M[k] ,

(13)

where the last equation follows from the definition of the conditional probability. First, we


consider the term Pr Xi [k] = c M[k] in (13). With the definition of the set of all observations
M[k], it holds that




Pr Xi [k] = c M[k] = Pr Xi [k] = c Xrep [k], Nu,1 [k], ..., Nu,Nu [k], M[k − 1] .
Assumption (6) implies that




Pr Xi [k] = c M[k] = Pr Xi [k] = c Xrep,i [k], Nu,1 [k], ..., Nu,Nu [k], M[k − 1] .
Then, with assumption (7), we obtain that




Pr Xi [k] = c M[k] = Pr Xi [k] = c Xrep,i [k], M[k − 1] ,

(14)

which has been calculated by the previous measurement update. Second, we consider the term


Pr Xi [k + 1] Xi [k] = c, M[k] in (13). The exact transition probabilities of the viral state Xi [k]
from time k to k + 1 depends on the infectious neighbourhood Ninf,i [k], as specified by the
Markov epidemic model. The complete neighbourhood Ninf,i [k] of infectious individuals is not
measured. Thus, BETIS makes use of the transition probability approximation (10), which is
based on the neighbourhood Ninf,u,i [k] of infectious users. However, we do not directly observe
the set Ninf,u,i [k] but instead the set Nu,i [k] of all users, infectious and non-infectious, that were
close to user i at time k. Since Ninf,u,i [k] ⊂ Nu,i [k], it holds that
0 ≤ |Ninf,u,i [k]| ≤ |Nu,i [k]| .
Thus, we can apply the law of total probability to obtain that
|Nu,i [k]|
X



Pr Xi [k + 1] Xi [k] = c, M[k], |Ninf,u,i [k]| = m
Pr Xi [k + 1] Xi [k] = c, M[k] =



m=0



· Pr |Ninf,u,i [k]| = m Xi [k] = c, M[k] ,
which simplifies to
|Nu,i [k]|
X




Pr Xi [k + 1] Xi [k] = c, |Ninf,u,i [k]| = m
Pr Xi [k + 1] Xi [k] = c, M[k] =
m=0



· Pr |Ninf,u,i [k]| = m M[k] .
15

(15)



The probabilities Pr Xi [k + 1] Xi [k] = c, |Ninf,i [k]| = m are fully specified by the hidden Markov
model in Subsection 2.1 and the approximation (10). Particularly, for the susceptible compartment Xi [k] = S, we obtain with (10) that

N̄inf
m


if c = S,
(1 − β) (1 − β)

 
Pr Xi [k + 1] = c Xi [k] = S, |Ninf,u,i [k]| = m = 1 − (1 − β)m (1 − β)N̄inf if c = E,



0
otherwise.



To compute (15), it remains to determine the probabilities Pr |Ninf,u,i [k]| = m M[k] for all cardinalities m = 0, 1, ..., |Nu,i [k]|. Without loss of generality3 , we assume that the neighbourhood
of users i at time k equals
Nu,i [k] = {1, 2, ..., M },
where M = |Nu,i [k]|. The law of total probability yields that

X

 X


Pr |Ninf,u,i [k]| = m M[k] =
...
Pr |Ninf,u,i [k]| = m X1 [k] = c1 , ..., XM [k] = cM , M[k]
c1 ∈C

cM ∈C



· Pr X1 [k] = c1 , ..., XM [k] = cM M[k] .
With the definition of the set of all observations M[k], we obtain that
X


 X

Pr |Ninf,u,i [k]| = m M[k] =
Pr |Ninf,u,i [k]| = m X1 [k] = c1 , ..., XM [k] = cM , M[k]
...
c1 ∈C

cM ∈C




· Pr X1 [k] = c1 , ..., XM [k] = cM Xrep [k], Nu,1 [k], ..., Nu,N [k], M[k − 1] .
The neighbourhood Ninf,u,i [k] of infectious users is completely determined by the viral states
Xi [k] of every user i. Thus, it holds that
X


 X

Pr |Ninf,u,i [k]| = m M[k] =
...
Pr |Ninf,u,i [k]| = m X1 [k] = c1 , ..., XM [k] = cM
c1 ∈C

cM ∈C




· Pr X1 [k] = c1 , ..., XM [k] = cM Xrep [k], Nu,1 [k], ..., Nu,N [k], M[k − 1] .
From assumption (8), it follows that
X


 X

Pr |Ninf,u,i [k]| = m M[k] =
...
Pr |Ninf,u,i [k]| = m X1 [k] = c1 , ..., XM [k] = cM
c1 ∈C

cM ∈C



· Pr X1 [k] = c1 , ..., XM [k] = cM Xrep [k], M[k − 1] .
With assumption (6), we obtain that
X


 X

Pr |Ninf,u,i [k]| = m M[k] =
...
Pr |Ninf,u,i [k]| = m X1 [k] = c1 , ..., XM [k] = cM
c1 ∈C

cM ∈C

M
Y

j=1
3

Otherwise, consider a relabelling of the nodes j in the set Nu,i [k].

16



Pr Xj [k] = cj Xrep,j [k], M[k − 1] . (16)

The set Ninf,u,i [k] only consists of users
define the Bernoulli random variable ψj

1
ψj =
0

j with Xj [k] = I or Xj [k] = Ia . For j = 1, ..., M , we
as
with probability

pj ,

with probability

1 − pj ,

with the success probability





pj = Pr Xj [k] = I Xrep,j [k], M[k − 1] + Pr Xj [k] = Ia Xrep,j [k], M[k − 1] .
From (16) it follows that the cardinality |Ninf,u,i [k]| is the sum of M Bernoulli random variables
ψj ∈ {0, 1} with different success probabilities pj . Hence, the cardinality |Ninf,u,i [k]| follows
a Poisson binomial distribution [21]. We obtain the distribution of |Ninf,u,i [k]| by convolution
of the distributions of the random variables ψ1 , ..., ψM . If the number M is large, then the
convolution might take long. For large M , there are more efficient algorithms [21] for computing
the distribution of the cardinality |Ninf,u,i [k]| (based on the discrete Fourier transform).
After the initialisation, the measurement update and the time update are alternated for every time k.
Finally, the risk factor (4) is obtained from (14) at the last time step k.

B

Simulation parameters

Here we give the details of the parameter values used in the simulations. To generate the locations
zi [k] at every time k, we employ a simple movement model: For every individual i, both entries of
the initial 2 × 1 location vector zi [1] are set to a uniform random number in [0, 1]. Given the location
vector zi [k] at any time k, we obtain the location vector at the next time k + 1 as follows. With a
probability of pmove = 0.1, both entries of the location vector zi [k + 1] are set to a uniform random
number in [0, 1]. Otherwise, with a probability of 1 − pmove = 0.9, the location does not change,
and hence zi [k + 1] = zi [k]. To obtain the neighbourhoods Ni [k] from (1), we set the distance to
dinf = 0.007. A crucial metric for the qualitative epidemic behaviour is the epidemic threshold. If
the effective infection rate τ = β/δ is below the epidemic threshold, then the virus dies out rapidly
and no individual is infectious any longer. Otherwise, above the epidemic threshold, a significant
fraction of individuals is infected in the long run. For our simulations, we set the curing and infection
probabilities to δ = 0.25 and β = 0.5, respectively, which causes the effective infection rate τ to
be above the epidemic threshold. Furthermore, we set the incubation probability to γ = 0.5 and
the fraction of asymptomatic infections to α = 0.1. The probability to contract a disease other
than COVID-19 is set to ϑ = 0.05. For any individual i, the initial viral state is set to Xi [1] = I
or Xi [1] = Ia with a probability of 0.01 and 0.01α, respectively. Otherwise, with a probability of
(0.99 − 0.01α), the initial viral state is set to Xi [1] = S. Then, the prior distribution of the viral state
Xi [1] is given by Pr [Xi [1] = S] = 0.99 − 0.01α, Pr [Xi [1] = I] = 0.01 and Pr [Xi [1] = Ia ] = 0.01α.

17

