Noname manuscript No.
(will be inserted by the editor)

Control with uncertain data of socially structured
compartmental epidemic models

arXiv:2004.13067v2 [q-bio.PE] 14 May 2021

Giacomo Albi · Lorenzo Pareschi ·
Mattia Zanella

Received: date / Accepted: date

Abstract The adoption of containment measures to reduce the amplitude of
the epidemic peak is a key aspect in tackling the rapid spread of an epidemic.
Classical compartmental models must be modified and studied to correctly
describe the effects of forced external actions to reduce the impact of the
disease. The importance of social structure, such as the age dependence that
proved essential in the recent COVID-19 pandemic, must be considered, and in
addition, the available data are often incomplete and heterogeneous, so a high
degree of uncertainty must be incorporated into the model from the beginning.
In this work we address these aspects, through an optimal control formulation
of a socially structured epidemic model in presence of uncertain data. After the
introduction of the optimal control problem, we formulate an instantaneous
approximation of the control that allows us to derive new feedback controlled
compartmental models capable of describing the epidemic peak reduction. The
need for long-term interventions shows that alternative actions based on the
social structure of the system can be as effective as the more expensive global
strategy. The timing and intensity of interventions, however, is particularly
relevant in the case of uncertain parameters on the actual number of infected
people. Simulations related to data from the first wave of the recent COVID-19
outbreak in Italy are presented and discussed.
G. Albi
Department of Computer Science
University of Verona, Italy
E-mail: giacomo.albi@univr.it
L. Pareschi
Department of Mathematics and Computer Science
University of Ferrara, Italy
E-mail: lorenzo.pareschi@unife.it
M. Zanella
Department of Mathematics ”F. Casorati”
University of Pavia, Italy
E-mail: mattia.zanella@unipv.it

2

Giacomo Albi et al.

Keywords Epidemic modelling · Uncertainty quantification · Social
structure · Optimal control · Non-pharmaceutical interventions · COVID-19

1 Introduction
From the digital tracking systems of the Koreans to UK’s initial choice of not
wanting to do anything to counter the spread of the virus, passing through the
militarized quarantines of the Chinese and those less authoritarian and more
involved of the Italians, the reaction of different countries to the COVID19 outbreak has shown a series of very different approaches that can also
be explained considering the different cultural and political attitudes of the
countries concerned.
In all cases, after an initial phase, even those governments that were less
restrictive in the face of the pandemic’s inexorable progress had to take strong
containment measures. There’s a graph that has become the symbol of the
COVID-19 pandemic most of all. It shows in a simple and intuitive way the
importance of slowing down the spread of an epidemic as much as possible
(”flattening the curve”), so that the healthcare system can take care of all
the sick without collapsing. Its success has helped to save many lives, raising
awareness of good practices to slow down an epidemic: stay as much as possible
at home, reduce social interactions and wash your hands often and well.
These ”non-pharmaceutical” intervention measures, however, entail significant social and economic costs and thus policy makers may not be able to
maintain them for more than a short period of time. Therefore, a modeling
approach based on a limited time horizon that takes into account the social structure of the population is necessary in order to optimize containment
strategies. Most current research, however, has focused on control procedures
aimed at optimizing the use of vaccinations and medical treatments [5, 7, 35,
15] and only recently the problem has been tackled from the perspective of
non-pharmaceutical interventions [37, 41]. In addition, data collected by governments are often incomplete and heterogeneous, so a high degree of uncertainty needs to be incorporated into predictive models [10, 12, 17, 31, 40, 48].
This is the case of the spreading of COVID-19 worldwide, which have been
often mistakenly underestimated due to a combination of factors, including
deficiencies in surveillance and diagnostic capacity, and the large number of
infectious but asymptomatic individuals [31, 40, 54].
For almost a hundred years, mathematical models have been used to describe the spread of epidemics [33]. The models currently used largely originate from the model proposed by Kermack and McKendrick at the beginning
of last century. Even if the model contains strong simplification assumptions,
the concepts introduced through this model are essential to provide a first
intuition on the dynamics of epidemics, an intuition that remains confirmed
in more complex models, albeit with numerous modifications (see for example
[28, 11]). The model provides for the division of the population into compartments, the susceptible, healthy individuals who may be infected, the infectious,

Control with uncertain data of epidemic models

3

who have already contracted the disease and can transmit it, and the removed,
compartment that includes those who are healed and immune.
The hypothesis made by Kermack and McKendrick is that of the homogeneous ”mixing”; that is, it is assumed that each individual has the same
probability of contacting any other individual in the population. One understands how this hypothesis is unrealistic: we are often in contact with people
from our family, our workplace, school class, group of friends and very rarely
with those who live in a different place, have different ages and professions.
In recent years, therefore, computational models have been developed that try
to take into account additional social characteristics of individuals in order
to arrive at more accurate predictions by keeping, however, the simplicity of
compartmental models [14, 26, 36, 27, 30, 23].
In this paper starting from a general compartmental model with social
structure, typically the age dependence, we consider the external action of
a policy maker that aims at reducing the spread of the epidemics by applying non pharmaceutical intervention measures, such as social distancing and
quarantine. The mathematical problem is formulated as an optimal control
problem characterized by a functional cost whose objective is to minimize the
number of infectious people in a given time horizon. Through an instantaneous
control strategy we compute an explicit feedback control that allows us to derive new SIR-type compartmental models capable of describing the epidemic
peak reduction. Previously, this type of approach has been used successfully
in the case of social models of consensus [1, 2, 3, 4, 8, 13, 20].
The feedback controlled models are subsequently extended to take into
account the presence of uncertain infection parameters and data. In fact, to
have reliable forecasts it is of paramount importance to consider the presence
of uncertain quantities as a structural feature of the epidemic dynamics. This
aspect is of paramount importance in the case of pandemic COVID-19, in
which undetected infectious individuals play a key role in the spread of the
disease. In this regard, it is worth noting that our methodology can be easily
extended to the case of more complex compartmental models. The decision to
limit ourselves to a simple SIR-type compartmentalization was related on the
one hand to the increased complexity given by the dependence on the social
structure, which proved to be crucial in the case of the COVID-19 pandemic,
and on the other hand to the introduction of a systematic uncertainty in the
number of infected to avoid a complex sub-compartmentalization of the infectious population and the consequent difficulties due to parameter identification
and the inability to follow a data-driven approach [25, 22]. From a mathematical point of view, we can rely on the methods of uncertainty quantification
(UQ) to obtain efficient and accurate solutions based on stochastic orthogonal
polynomials for the differential model with random inputs [53].
Few results are actually available regarding methods of UQ in epidemic systems, we mention in this direction [12, 17, 10, 48]. The main idea is to increase
the dimensionality of the problem adding the possible sources of uncertainty
from the very beginning of the modeling. Hence, we extrapolate statistics by
looking at the so-called quantities of interest, i.e. statistical quantities that

4

Giacomo Albi et al.

can be obtained from the solution and that give some global information with
respect to the input parameter like expected solution of the problem or higher
order moments. Several techniques can be adopted for the approximation of
the quantities of interest, in this paper we adopt stochastic Galerkin methods
that allow to reduce the problem to a set of deterministic equations for the
numerical evaluation of the solution in presence of uncertainties. Compared
to conventional Monte Carlo methods, based on stochastic sampling, these
methods guarantee an exponential convergence in the case of smooth uncertainty distributions and allow a much more accurate and efficient estimation
of random parameters. We refer the interested reader to recent surveys and
monographs on the topic [18, 32, 44, 53].
In particular, we consider the case in which the policy maker applies his
control based on several possible estimators on the actual number of infected
people. The need for long-term interventions shows that alternative actions
based on the social structure of the system can be as effective as the more
expensive optimal strategy. The importance of the timing and intensity of
interventions is particularly relevant in the case of uncertain parameters on
the actual number of infected people.
The rest of the manuscript is organized as follows. In Section 2 we introduce the structured social SIR model and formulate the mathematical approach for containment measures to reduce the spread of the disease. Next, a
feedback controlled model used in the subsequent analysis is derived within
a short time horizon approximation. In Section 3 we generalize the feedback
controlled model to take into account the presence of uncertainties. Section
4 is dedicated to the presentation of some numerical examples including applications to the first wave of the COVID-19 epidemic in Italy. In separate
Appendices we provide details on the generalizations of the present approach
to more realistic epidemic models for COVID-19 including additional compartmentalizations, on the stochastic Galerkin method employed to efficiently
address the uncertainties, and on the social interaction matrices characterizing
the contact rates.

2 Control of epidemic dynamics
The starting model in our discussion is a SIR-type compartmental model with
a social structure. The presence of a social structure is in fact essential in
deriving appropriate sustainable control techniques from the population for a
protracted period, as in the case of the recent COVID-19 epidemic. We will
discuss in Section 3 how to modify the model through the introduction of
a stochastic parameter that takes into account the dependence on uncertain
data, and thus implicitly introduce the role of undetected infectious in the
dynamics.

Control with uncertain data of epidemic models

5

2.1 Compartmental models with social structure
The heterogeneity of the social structure, which impacts the diffusion of the
infective disease, is characterized by the vector a ∈ Λ ⊆ Rda characterizing
its social state and whose components summarize, for example, the age of
the individual, its number of social connections or its economic status [27,
28]. We denote by s(a, t), i(a, t) and r(a, t), the distributions at time t > 0
of susceptible, infectious and recovered individuals, respectively in relation to
specific social characteristics. We assume that the rapid spread of the disease
and the low mortality rate allows to ignore changes in the social structure,
such as the aging process, births and deaths.
Consequently, for a given population of total number N , we have that
Z
s(a, t) + i(a, t) + r(a, t) = f (a),
f (a)da = N,
Λ

where f (a) is the total distribution of the social features defined by the vector
a. Hence, we recover the total fraction of the population which belong to the
susceptible, infected and recovered as follows
Z
Z
Z
S(t) =
s(a, t) da, I(t) =
i(a, t) da, R(t) =
r(a, t) da.
(1)
Λ

Λ

Λ

In a situation where changes in the social features act on a slower scale with
respect to the spread of the disease, the socially structured compartmental
model follows the dynamics
Z
1
d
s(a, t) = −s(a, t)
β(a, a∗ )i(a∗ , t) da∗
dt
N Λ
Z
1
d
(2)
i(a, t) = s(a, t)
β(a, a∗ )i(a∗ , t) da∗ − γ(a)i(a, t)
dt
N Λ
d
r(a, t) = γ(a)i(a, t),
dt
where the function β(a, a∗ ) ≥ 0 represents the uncertain interaction rate
among individuals with different social features and γ(a) ≥ 0 the recovery
rate which may depend on the social feature.
Often, in socially structured models the interaction rate between people is
assumed to be separable, and proportionate to the activity level of the social
feature [27, 28], as follows
b(a)b(a∗ )
β(a, a∗ ) = R +∞
b(a)f (a) da
0

(3)

with b(a) the average number of people contacted by a person with social
feature a per unit time. Alternative approaches are based on preferential mixing [26, 14]. Specific examples of age-dependent social interaction matrices are
reported in Appendix C.

6

Giacomo Albi et al.

We introduce the usual normalization scaling
s(a, t)
→ s(a, t),
N

i(a, t)
→ i(a, t),
N

r(a, t)
→ r(a, t),
N

Z
f (a)da = 1,
Λ

and observe that the quantities S(t), I(t) and R(t) satisfy the conventional
SIR dynamics
Z
Z
d
S(t) = − s(a, t) β(a, a∗ )i(a∗ , t) da∗ da
dt
Z Λ
Z Λ
Z
(4)
d
I(t) =
s(a, t) β(a, a∗ )i(a∗ , t) da∗ da −
γ(a)i(a, t) da,
dt
Λ
Λ
Λ
where the fraction of recovered is obtained from R(t) = 1 − S(t) − I(t). We
refer to [27, 28] for analytical results concerning model (2) and (4). In the
following we will adopt the simple compartmental model (2) to derive our
feedback controlled formulation in presence of uncertainty. The extension to
more realistic compartmental models in epidemiology, designed specifically for
the COVID-19 pandemic, can be carried out in a similar way [24].
In order to simplify the description, we will consider the one-dimensional
case da = 1 and set the social dependence as the age a of the individual
because of its importance in epidemic dynamics. It is clear, however, that similar containment procedures can impact also on other social features, like the
wealth of the individuals [19]. We will first formulate the feedback controlled
SIR model in the deterministic case and subsequently extend our approach to
the presence of uncertain parameters.
2.2 Optimal control of structured compartmental model
In order to define the action of a policy maker introducing a control over the
system based on social distancing and other containment measures linked to
the social structure we consider an optimal control framework. The choice of
an appropriate functional is problem dependent [35].
In our setting, we account the minimization of the total number of the infected population I(t) through the an age dependent control action depending
both on time and pairwise interactions among individuals with different ages.
Thus, we introduce the optimal control problem
Z Z
Z T
1 T
ν(a, a∗ , t)|u(a, a∗ , t)|2 dada∗ dt, (5)
min J(u) :=
ψ(I(t))dt +
u∈U
2 0 Λ×Λ
0
subject to
Z
d
s(a, t) = −s(a, t) (β(a, a∗ ) − u(a, a∗ , t))i(a∗ , t) da∗
dt
Z Λ
d
i(a, t) = s(a, t) (β(a, a∗ ) − u(a, a∗ , t))i(a∗ , t) da∗ − γ(a)i(a, t)
dt
Λ
d
r(a, t) = γ(a)i(a, t)
dt

(6)

Control with uncertain data of epidemic models

7

with initial condition i(a, 0) = i0 (a), s(a, 0) = s0 (a) and r(a, 0) = r0 (a).
The number of infected individual is measured by a monotone increasing
function ψ(·) such that ψ : [0, 1] → R+ . This function models the policy
maker’s perception of the impact of the epidemic by the number of people
currently infected and in the sequel will be referred to as perception function.
For example ψ(I) = I q /q, for q > 1 implies an underestimation of the actual
number of infected corresponding to q = 1. The control aims to minimize this
measure of the total infected population by reducing the rate of interaction
between individuals. We consider a quadratic cost for its actuation.
Such control is restricted to the space of admissible controls

U ≡ u | 0 ≤ u(a, a∗ , t) ≤ min{M, β(a, a∗ )}, ∀ (a, a∗ , t) ∈ Λ2 × [0, T ], M > 0 ,
which ensure the admissibility of the solution for (6). The above restriction
on admissible controls can be relaxed if we consider controls that violate the
previous condition locally but preserve the inequality in integral form after
integration against i(a∗ , t).
The solution to problem (5)-(6) is computed through the optimality conditions obtained from the Euler-Lagrangian as follows
L(s, i, r, ps , pi , pr , u) = J(u)+


Z
Z TZ
d
s + s(a, t) (β(a, a∗ ) − u(a, a∗ , t)) i(a∗ , t)da∗ da dt
ps ·
dt
Λ
0
Λ


Z
Z TZ
d
i − s(a, t) (β(a, a∗ ) − u(a, a∗ , t)) i(a∗ , t)da∗ + γ(a)i(a, t) da dt
+
pi ·
dt
Λ
0
Λ


Z TZ
d
+
r − γ(a)i(a, t) da dt
pr ·
dt
0
Λ
where ps (a, t), pi (a, t), pr (a, t) are the associated Lagrangian multipliers. By
computing the variations with respect to (s, i, r) we retrieve the adjoint system
Z
d
ps = (ps − pi ) (β(a, a∗ ) − u(a, a∗ , t))i(a∗ , t)da∗
dt
Λ
Z
d
0
pi = ψ (I(t)) + (ps (a∗ , t) − pi (a∗ , t))(β(a∗ , a) − u(a∗ , a, t))s(a∗ , t)da∗ + γ(a)pi
dt
Λ
(7)
with terminal conditions ps (a, T ) = 0, pi (a, T ) = 0 and pr (a, T ) = 0. Note
that the contribution of pr (a, t) vanishes since the control does not act directly on population R, and the removed population is not considered in the
minimization of the functional. The optimality condition reads
ν(a, a∗ , t)u(a, a∗ , t) = (ps − pi ) s(a, t)i(a∗ , t).

(8)

The optimality conditions (7)-(8) are first order necessary conditions for
the optimal control u(a, a∗ , t). In order to be admissible then the control reads



ps − pi
u(a, a∗ , t) = max 0, min
s(a, t)i(a∗ , t), φM,β (a, a∗ )
,
ν(a, a∗ , t)

8

Giacomo Albi et al.

where φM,β (a, a∗ ) = min{β(a, a∗ ), M }.
The approach just described, however, is generally quite complicated when
there are uncertainties as it involves solving simultaneously the forward problem (5)- (6) and the backward problem (7)- (8). Moreover, the assumption
that the policy maker follows an optimal strategy over a long time horizon
seems rather unrealistic in the case of a rapidly spreading disease such as
the COVID-19 epidemic. Let us emphasize that extending the above optimal
control formulation to more complex compartmental models designed specifically for COVID-19, like SEPIAR or SIDHARTE [24, 25], can be done by
generalizing the control functional (5) to include, for example, the hospitalized compartment, or other specific indicators that can be measured from the
data. For all of these models, the feedback control strategy described in the
next section does not change substantially. We refer the reader to Appendix
A for more details.
2.3 Feedback controlled compartmental models
In this section we consider short time horizon strategies which permits to
derive suitable feedback controlled models. These strategies are suboptimal
with respect the original problem (5)-(6) but they have proved to be very
successful in several social modeling problems [1, 2, 3, 4,20]. To this aim, we
consider a short time horizon of length h > 0 and formulate a time discretize
optimal control problem through the functional Jh (u) restricted to the interval
[t, t + h], as follows
Z
1
ν(a, a∗ , t)|u(a, a∗ , t)|2 dada∗
(9)
min Jh (u) := ψ(I(t + h)) +
u∈U
2 Λ×Λ
subject to
Z
s(a, t + h) = s(a, t) − hs(a, t)

(β(a, a∗ ) − u(a, a∗ , t)) i(a∗ , t)da∗

(10)

ZΛ
(β(a, a∗ ) − u(a, a∗ , t)) i(a∗ , t)da∗ − hγ(a)i(a, t).

i(a, t + h) = i(a, t) + hs(a, t)
Λ

(11)
By recalling that the macroscopic information on the infected is

Z 
Z
I(t+h) = I(t)+h
s(a, t) (β(a, a∗ ) − u(a, a∗ , t)) i(a∗ , t)da∗ − γ(a)i(a, t) da,
Λ

Λ

we can derive the minimizer of Jh computing Du Jh (u) ≡ 0. We retrieve the
following nonlinear equation
ν(a, a∗ , t)u(a, t) = hs(a, t)i(a∗ , t)ψ 0 (I(t + h)).

(12)

In order to pass to the limit h → 0 we must rescale the penalization term
as ν(a, a∗ , t) = hκ(a, a∗ , t) so that we can introduce the above instantaneous
strategy directly in the discrete system (10)-(11).

Control with uncertain data of epidemic models

9

The resulting controlled dynamic, corresponding to the feedback controlled
continuous system (6), reads as follows
Z 
d
s(a, t)i(a∗ , t)ψ 0 (I(t)) 
i(a∗ , t)da∗
(13a)
s(a, t) = −s(a, t)
β(a, a∗ ) −
dt
κ(a, a∗ , t)
Λ
Z 
d
s(a, t)i(a∗ , t)ψ 0 (I(t)) 
i(a∗ , t)da∗ − γ(a)i(a, t)
i(a, t) = s(a, t)
β(a, a∗ ) −
dt
κ(a, a∗ , t)
Λ
(13b)
d
r(a, t) = γ(a)i(a, t).
(13c)
dt
In what follows we provide a sufficient conditions for the admissibility of the
instantaneous control in terms of the penalization term κ(a, a∗ , t). Indeed we
want to assure that the dynamics preserve the monotonicity of the number of
susceptible population s(a, t).
Proposition 1 Let β(a, a∗ ) ≥ δ > 0, and ψ 0 (·) a monotonically non decreasing function, then for all (a, a∗ ) ∈ Λ × Λ and t > 0, solutions to (13) are
admissible if the penalization κ satisfies the following inequality
¯
δκ(a, a∗ , t) ≥ s0 (a)ī(a∗ )ψ 0 (I),

∀(a, a∗ ) ∈ Λ × Λ

(14)

where ī(a) and I¯ are respectively the peak reached by the infected of age a and
by the total population of infected.
Proof By imposing the non-negativity of the controlled reproduction rate inside the integral we have
β(a, a∗ )κ(a, a∗ , t) ≥ s(a, t)i(a∗ , t)ψ 0 (I(t)).
This inequality has to be satisfied for every time t ≥ 0. Next we observe that
the number of susceptible s(a, t) is decreasing in time, therefore s0 (a) ≥ s(a, t)
for all t. Moreover i(a, t) reaches a peak before decreasing to 0 (note that this
peak can also be in t = 0), say I¯ for the macroscopic variable and ī(a). Thus,
thanks to the monotonicity of ψ 0 (·), we can restrict the previous inequality
as follows
¯
δκ(a, a∗ , t) ≥ s0 (a)ī(a∗ )ψ 0 (I).
In Figure 1 we report the phase diagram of susceptible-infected trajectories
for the controlled model with homogeneous mixing


1
d
0
S(t) = − β − S(t)I(t)ψ (I(t)) S(t)I(t)
dt
κ


(15)
1
d
0
I(t) = β − S(t)I(t)ψ (I(t)) S(t)I(t) − γI(t),
dt
κ
with ψ(I) = I q /q. The dynamics are similar to the classical SIR model but
with a nonlinear contact rate. In particular, the trajectories are flattened when

10

Giacomo Albi et al.

Fig. 1 Phase diagram of susceptible-infected trajectories for the controlled SIR-type model
with homogenous mixing and ψ(I) = I q /q. Different choices of the penalization term κ are
reported. Left plot the case q = 1, right plot q = 2. The line markers point out the peaks of
the infected population for each choice of κ.

the value of the control is such that κβ ≈ S(t)I(t)ψ 0 (I(t)). Note, however that
this status is not an equilibrium point of the system.
To understand this, let us observe that an equilibrium state (S ∗ , I ∗ ) for
(15) satisfies the equations
(κβ − S ∗ I ∗ ψ 0 (I ∗ )) S ∗ I ∗ = 0
((κβ − S ∗ I ∗ ψ 0 (I ∗ ))S ∗ − κγ) I ∗ = 0.
An equilibrium point corresponds to the classical state in which we have the
extinction of the disease I ∗ = 0 and S ∗ arbitrary and defined by the asymptotic
state of the dynamics [28]. Now, let’s suppose that I ∗ 6= 0, S ∗ 6= 0, we can
look for solutions where control is able to perfectly balance the spread of the
disease
κβ = S ∗ I ∗ ψ 0 (I ∗ )
κβS ∗ = (S ∗ )2 I ∗ ψ 0 (I ∗ ) + κγ,
consequently
κβ
+ κγ = 0,
S∗
which is satisfied only for γ = 0 when κ 6= 0. The stability analysis of this
unique equilibrium point can be performed by standard arguments and we
omit the details.
κβS ∗ = (S ∗ )2

3 Control of epidemic dynamics with uncertainties
Since the beginning of the outbreak of new infectious diseases, the actual number of infected and recovered people is typically underestimated, causing fatal

Control with uncertain data of epidemic models

11

delays in the implementation of public health policies facing the propagation
of epidemic fronts. This is the case of the spreading of COVID-19 worldwide,
often mistakenly underestimated due to deficiencies in surveillance and diagnostic capacity [31, 47]. Health systems are struggling to adopt systematic
testing to monitor actual cases. Moreover, another important epidemiological
factor affecting data reliability is the large proportion of asymptomatic [31,
40, 54].
Among the common sources of uncertainties for dynamical systems modeling epidemic outbreaks we may consider the following
– noisy and incomplete available data;
– structural uncertainty due to the possible inadequacy of the mathematical
model used to describe the phenomena under consideration.
In the following we consider the effects on the dynamics of uncertain data,
such as the initial conditions on the number of infected people or the interaction and recovery rates. On the numerical level we consider techniques based
on stochastic Galerkin methods, for which spectral convergence on random
variables is obtained under appropriate regularity assumptions [53]. For simplicity, the details of the numerical method that allows to reduce the uncertain
dynamic system to a set of deterministic equations are reported in Appendix
B.

3.1 Socially structured models with uncertain inputs
We introduce the random vector z = (z1 , . . . , zdz ) whose components are assumed to be independent real valued random variables
zk : (Ω, F ) → (R, BR ),

k = 1, . . . , dz

with BR the Borel set. We assume to know the probability density p(z) :
Rdz → Rd+z characterizing the distribution of z. Here, z ∈ Rdz is a random
vector taking into account various possible sources of uncertainty in the model.
In presence of uncertainties we generalize the initial modeling by introducing the quantities s(z, a, t), i(z, a, t) and r(z, a, t) representing the distributions
at time t ≥ 0 of susceptible, infectious and recovered individuals. The total
size of the population is a deterministic conserved quantity in time, i.e.
Z
s(z, a, t) + i(z, a, t) + r(z, a, t) = f (a),
f (a)da = N.
Λ

Hence, the quantities
Z
S(z, t) =
s(z, a, t) da,
Λ

Z
I(z, t) =

Z
i(z, a, t) da,

Λ

R(z, t) =

r(z, a, t) da,
Λ

(16)
denote the uncertain fractions of the population that are susceptible, infectious
and recovered respectively.

12

Giacomo Albi et al.

The social structured model with uncertainties reads
Z
d
i(z, a∗ , t)
s(z, a, t) = −s(z, a, t) β(z, a, a∗ )
da∗
dt
N
Λ
Z
d
i(z, a∗ , t)
i(z, a, t) = s(z, a, t) β(z, a, a∗ )
da∗ − γ(z, a)i(z, a, t)
dt
N
Λ
d
r(z, a, t) = γ(z, a)i(z, a, t)
dt

(17)

To illustrate the impact of uncertainties let us consider the simple following example. In the case of homogeneous mixing with uncertain contact rate
β(z) = β + αz, α > 0, z ∈ R distributed as p(z) the model reads
d
S(z, t) = − (β + αz) S(z, t)I(z, t)
dt
d
I(z, t) = (β + αz) S(z, t)I(z, t) − γI(z, t),
dt

(18)

with deterministic initial values I(z, 0) = I0 and S(z, 0) = S0 . The solution
for the proportion of infectious during the initial exponential phase is [48]
I(z, t) = I0 e(β+αz)S0 t−γt ,
and its expectation
Z

e(β+αz)S0 t−γt p(z) dz = I0 eβS0 t−γt W (t),

E[I(·, t)] = I0

(19)

R

where the function

Z
W (t) =

eαzS0 t p(z) dz

R

represents the statistical correction factor to the standard deterministic exponential phase of the disease I0 eβS0 t−γt . If z is uniformly distributed in [−1, 1]
we can explicitly compute
W (t) =

sinh (αS0 t)
> 1,
αS0 t

t > 0.

More in general, if z has zero mean then by Jensen’s inequality we have
W (t) > 1 for t > 0, so that the expected exponential phase is amplified by the
uncertainty (see [48]).
In a similar way, keeping β constant, but introducing a source of uncertainty in the initial data I(z, 0) = I0 + µz, µ > 0 and z ∈ R distributed as
p(z) the solution in the exponential phase reads
I(z, t) = (I0 + µz)eβS0 t−γt ,
and then its expectation
Z
E[I(·, t)] = (I0 + µz)eβS0 t−γt p(z) dz = (I0 + µz̄)eβS0 t−γt ,
R

(20)

Control with uncertain data of epidemic models

13

where z̄ is the mean of the variable z. Therefore, the expected initial exponential growth behaves as the one with deterministic initial data I0 + µz̄. Of
course, if both sources of uncertainty are present the two effects just described
sum up in the dynamics.
Remark 1 The presence of a large number of undetected infected is at the basis
of the construction of numerous epidemiological models with an increasingly
complex compartmental structure in which the original compartment of the
infected is subdivided into further compartments with different roles in the
propagation of the disease [25, 24, 22]. To clarify the relationships to other
deterministic compartmental models, let us consider, for simplicity, model (17)
in absence of a social structure
d
S(z, t) = −β(z)S(z, t)I(z, t)
dt
d
I(z, t) = β(z)S(z, t)I(z, t) − γ(z)I(z, t),
dt
d
R(z, t) = γ(z)I(z, t),
dt

(21)

and with a one-dimensional random input z ∈ R distributed as p(z). Furthermore, for a function F (z, t) we will denote its expected value as F̄ (t) =
E[F (·, t)]. Now, starting from a discrete probability density function

pk = P {Z = zk } ,

n
X

pk = 1,

k=1

we have F̄ (t) =
we can write

Pn

k=1

pk Fk , with Fk = F (zk ). Taking the expectation in (21),

n

X
d
S̄(t) = −S̄(t)
β̃k pk Ik (t)
dt
k=1

d ¯
I(t) = S̄(t)
dt

n
X

β̃k pk Ik (t) −

k=1

n
X

γk pk Ik (t),

(22)

k=1

n

X
d
R̄(t) =
γk pk Ik (t),
dt
k=1

with β̃k = Sk βk /S̄, k = 1, . . . , n. For example, in the case n=2, by identifying
Id = p1 I1 and Iu = p2 I2 with the compartments of detected and undetected
infectious individuals, respectively, we can formulate the equivalent partition-

14

Giacomo Albi et al.

ing


d
S̄(t) = −S̄(t) β̃1 Id (t) + β̃2 Iu (t)
dt
d
Id (t) = S̄(t)β̃1 Id (t) − γ1 Id (t),
dt
d
Iu (t) = S̄(t)β̃2 Iu (t) − γ2 Iu (t),
dt
d
R̄(t) = γ1 Id (t) + γ2 Iu (t),
dt

(23)

which has the same structure of a SIAR compartmental model including the
undetected (or the asymptomatic) class. In the following, we will not rely
on discrete probability distributions, but on continuous representations that
can be associated with the overall probability of having a certain number of
infectious individuals (detected or undetected). The additional dependence of
the epidemiological parameters from the random variable allows us to take
into account changes in the corresponding dynamics of disease transmission
and recovery.

3.2 The feedback controlled model with random inputs
In presence of uncertainties the optimal control problem (5)-(6) is modified as
follows
Z Z
Z T
1 T
ν(a, a∗ , t)|u(a, a∗ , t)|2 dada∗ dt,
min J(u) :=
R[ψ(I(·, t))]dt+
u∈U
2 0 Λ×Λ
0
(24)
being R[ψ(I(·, t))] a suitable operator taking into account the presence of the
uncertainties z. Examples of such operator that are of interest in epidemic
modeling are the expectation with respect to uncertainties
Z
R[ψ(I(·, t))] =E[ψ(I(·, t))] =
ψ(I(z, t)) p(z)dz
(25)
Rdz

or relying on data which underestimate the number of infected
R[ψ(I(·, t))] = ψ(I(z0 , t)),

(26)

where z0 is a given value such that ψ(I(z0 , t)) ≤ ψ(I(z, t)), ∀ z ∈ Rdz and
t > 0.
In (24) U the space of admissible controls is defined as
n
o
U = u | 0 ≤ u(a, a∗ , t) ≤ min{M, min β(z, a, a∗ )}, ∀ (a, a∗ , t) ∈ Λ2 × [0, T ], M > 0 ,
z

or in a more relaxed form if we consider the above inequality after integration
against i(a∗ , t).

Control with uncertain data of epidemic models

15

The minimization problem (24) is subject to the following dynamics
Z
d
s(z, a, t) = −s(z, a, t) (β(z, a, a∗ ) − u(a, a∗ , t))i(z, a∗ , t) da∗
dt
Z Λ
d
i(z, a, t) = s(z, a, t) (β(z, a, a∗ ) − u(a, a∗ , t))i(z, a∗ , t) da∗ − γ(z, a)i(z, a, t)
dt
Λ
d
r(z, a, t) = γ(z, a)i(z, a, t)
dt
(27)
with initial condition i(z, a, 0) = i0 (z, a), s(z, a, 0) = s0 (z, a) and r(z, a, 0) =
r0 (z, a).
The implementation of instantaneous control for dynamics in presence of
uncertainties follows from the derivation presented in Section 2.3. We can
derive the minimizer of Jh computing Du Jh (u) ≡ 0 from the restriction of the
minimization problem (24) in the interval [t, t + h] or equivalently


∂ψ(I(·, t + h))
= ν(a, t)u(a, a∗ , t),
R
∂u
where we assumed ∂R [ψ(I(·, t + h))]/∂u = R [∂ψ(I(·, t + h))/∂u], to obtain
the following nonlinear identity
ν(a, t)u(a, a∗ , t) = hR[s(·, a, t)i(·, a∗ , t)ψ 0 (I(·, t))].

(28)

The above assumption on R[·] is clearly satisfied by (25) and (26), where in
the case of (26) we used the notation
R[s(·, a, t)i(·, a∗ , t)ψ 0 (I(·, t))] = s(z0 , a, t)i(z0 , a∗ , t)ψ 0 (I(·, t)).
By introducing the scaling ν(a, t) = hκ(a, a∗ , t) we can pass to the limit for
h → 0 to get
u(a, a∗ , t) =

1
R [s(·, a, t)i(·, a∗ , t)ψ 0 (I(·, t))] ,
κ(a, a∗ )

(29)

which defines the feedback controlled model in presence of uncertainties.

4 Examples from the COVID-19 outbreak in Italy
In this section we present several numerical tests on the constrained compartmental model with uncertain data. Details of the numerical method used are
given in Appendix B. In an attempt to analyze sufficiently realistic scenarios,
in the following examples we will refer to values taken from Italian data on
the COVID-19 epidemic [46]. More precisely, in the first test case we illustrate
the behavior of the model in a simplified setting in absence of uncertainty and
social structure and without trying to reproduce scenarios closely related to
current data. In the second test case, following a progressively more realistic

16

Giacomo Albi et al.

approach, we consider the impact of the presence of uncertain data in the
controlled model with homogeneous social mixing and calibrated on Italian
data. The same setting is then considered in Test 3 taking into account the
additional effects given by the social structure of the system, characterized
by suitable social interaction functions and an age-dependent recovery rate.
The final scenario, explored in Test 4, examines the influence on the spread
of infectious disease induced by relaxed confinement measures related to the
social structure of the system.

4.1 Test 1. Containment in homogeneous social mixing dynamics
To illustrate the effects of controls introduced that mimic containment procedures, let us first consider the case where the social structure is not present.
Furthermore, to simplify further the modeling, in this first example we neglect
any dependence on uncertain data.
We consider as initial small number of infected and recovered i(0) = 3.68 ×
10−6 , r(0) = 8.33 × 10−8 . These normalized fractions refer specifically to the
first reported values in the case of the Italian outbreak of COVID-19, even if in
this simple test case we will not try to match the data in a quantitative setting
but simply to illustrate the behavior of the feedback controlled model. Based
on recent studies [31, 54, 38], the initial infection rate of COVID-19 R0 = β/γ
has been estimated between 2 and 6.5. Here, to exemplify the possible evolution
of the pandemic we consider a value close to the lower bound, taking β = 0.25
and γ = 0.10, namely a recovery rate of 10 days, so that R0 = 2.5.
In Figures 2 and 3 we report the infected and recovered dynamics based
on the activation of the control in two different time frames. In Figure 2 the
activation for t ∈ [50, 100], which means that after 100 days we suppose that
all containment restrictions are cancelled. In Figure 3 we consider a larger
activation time frame t ∈ [50, 200].
With the choice of the perception function ψ(I) = I q /q, q ≥ 1, we can
observe how the control term is able to flatten the curve even if, as expected,
the case q = 2 gives rise to a weaker control action. To make the two controls,
q = 1 and q = 2, comparable for the same penalization factor κ we also
consider the normalized case, where ψ(I) = Cq I q /q, and the constant Cq > 0
is a normalization constant such that
Z Imax
Z Imax
I2
dI,
C1 I dI =
C2
2
0
0
with Imax an estimate of the maximum number of infected in absence of con1
trol. In particular, in our test case, from Imax ≈ , assuming C1 = 1 we obtain
4
C2 = 12.
Note that, if the activation time is too short the control is not able to
significantly change the total number of infected (and therefore recovered).
On the other hand, by enlarging the activation time in combination with a

Control with uncertain data of epidemic models

17

Fig. 2 Test 1. Evolution of the fraction of infected (left) and recovered (right) based on
the feedback constrained model (15) for t ∈ [50, 100], a perception function ψ(I) = I q /q,
q = 1, 2 and several penalizations κ = 10−2 , 10−3 , 10−4 . The choice κ = +∞ corresponds
to the unconstrained case. In last row the normalized case ψ(I) = C2 I 2 /2, with C2 = 12.

sufficiently small penalty constant, the peak infection is not only reduced,
but the total number of infected people is decreased. To achieve this, the
control should be kept activated for a sufficiently long time and with the right
intensity in a kind of plateau regime where there is a perfect balance between
the containment effect and the spread of the disease. On the contrary, if the
control is too strong, the majority of the population remains susceptible and
consequently the disease will start spreading again forming a second wave
after the containment policy is removed. Similar conclusions (that may appear
counterintuitive) have been shown also by other authors (see for example [9,
39]).
The cost functional depends on the value of q and can be evaluated summing up contributions in (9) with explicit form of the control given by (12).

18

Giacomo Albi et al.

Fig. 3 Test 1. Evolution of the fraction of infected (left) and recovered (right) based on
the feedback constrained model (15) for t ∈ [50, 200], a perception function ψ(I) = I q /q,
q = 1, 2 and several penalizations κ = 10−2 , 10−3 , 10−4 . The choice κ = +∞ corresponds
to the unconstrained case. In last row the normalized case ψ(I) = C2 I 2 /2, with C2 = 12.
10

9

10

7

10

5

10

3

10

1

10 -1
10 -3
50

100

150

200

10

9

10

10

7

10 7

10

5

10 5

10

3

10 3

10

1

10 1

10 -1

10 -1

10 -3
50

100

150

200

9

10 -3
50

100

150

Fig. 4 Test 1. Evaluation of the cost functional J(u) for the dynamics in Figure 3.

200

Control with uncertain data of epidemic models

19

(a) Infected

(b) Recovered

(c) Infected

(d) Recovered

Fig. 5 Test 1. Evolution of the of the fraction of infected (left) and recovered (right)
based on the feedback constrained model (15) for a perception function ψ(I) = I q /q, q = 1
and q = 2 normalized, for different control actions in [50, td ] with a deactivation time
td ∈ [100, 300] and a fixed penalization κ = 10−3 .

In Figure 4 the cost of the two interventions is compared. We can see how
a higher cost is associated with q = 1 that can be obtained with the control q = 2 only for smaller penalizations. As expected, the normalized case
q = 2 essentially realigns the cost of interventions. Then, in Figure 5 we compare the performance of the two controls in [50, td ] with a deactivation time
td ∈ [100, 300]. We consider κ = 10−3 for both q = 1 and q = 2 normalized. It
can be observed that there is a minimum control horizon for both strategies, in
order to avoid the onset of a second infection peak. A sufficiently long control
horizon is therefore necessary to reduce the impact of the infection.

4.2 Test 2: Impact of uncertain data on the epidemic outbreak
Next we focus on the influence of uncertain quantities on the controlled system
with homogeneous mixing focusing on available data for COVID-19 outbreak
in Italy, see [46]. The estimation of epidemiological parameters is a very difficult problem that can be addressed with different approaches [10, 17, 48]. It
is worth to mention that, in the case of COVID-19, the number of infected

20

Giacomo Albi et al.

and recovered has been largely underestimated, especially in the early phases
of the epidemic, see [31, 40]. Here, we restrict ourselves to identifying the deterministic parameters of the model through a suitable data fitting procedure,
considering possible deviations due to such underestimates as part of the subsequent uncertainty quantification process.
The data fitting process
In details, we have adopted a two-level approach in estimating the parameters
in absence of uncertainties. In the phase preceding the lockdown we estimated
the epidemic parameters in an unconstrained regime, where we assumed no
social containment procedure was activated. This estimate was then kept int
the subsequent lockdown phase where we estimated as a function of time the
value of the control penalty parameter. Both these two calibration steps were
analyzed under the assumption of homogeneous mixing, therefore model (15)
has been used in lockdown phase.
First, we estimated the parameters β, γ > 0 in the time interval t ∈ [t0 , tu ]
solving a lest square problem based on the minimization of the relative L2 norm
ˆ and recovered
of the difference between the reported number of infected I(t)
R̂(t), and the theoretical evolution of the unconstrained model whose solution
at time t ≥ 0 is indicated with I(t) and R(t). More precisely, we considered
the following minimization problem
min

β,γ∈R+

h
i
ˆ
2
2
(1 − θ)kI(t) − I(t)k
+
θkR(t)
−
R̂(t)k
L ([t0 ,tu ])
L ([t0 ,tu ]) ,

(30)

where θ ∈ [0, 1] and k · kL2 ([t,s]) denotes the relative L2 norm over a time
horizon [t, s].
(30) has been solved with the constraints β ∈ [0, 1] and γ ∈

 Problem
1 1
,
. Indeed, according to several studies the time to viral clearance dur24 10
ing the early phase of the epidemic, corresponding to the time from the first
positive test to the first negative test, can approximately span in average from
10 to 24 days, see [16, 24, 34].
At the end of the above optimization process we obtained the values βe ≈
0.31, γe ≈ 0.049 computed by averaging the optimization results with θ = 10−2
and θ = 10−6 . The choice of a small value for θ is due to the low reliability on
the recovered data at this early stage.
Next, we estimate the penalization κ = κ(t) in time by solving (15), in
the lockdown time interval t ∈ (tu , tc ] and for a sequence of time steps ti , the
corresponding least square problems in [ti − kl , ti + kr ] where k` , kr ≥ 1 are
integers, and where we fix the values βe , γe estimated in the first optimization
step. In details, we solve the following minimization problem
h
i
ˆ
min (1 − θ)kI(t) − I(t)k
L2 ([(ti −k` ,ti +kr ]) + θkR(t) − R̂(t)kL2 ([ti −k` ,ti +kr ]) ,
κ(ti )∈R+

(31)

Control with uncertain data of epidemic models

21

Fig. 6 Test 2. Estimated control penalization terms over time from reported data on
number of infected and recovered in the case of COVID-19 outbreak in Italy.

over a window of seven days corresponding to k` = 3 and kr = 4 for regularization along one week of available data. Both minimization problems (30)(31) have been solved testing various numerical methods in combination with
adaptive solves for the systems of ODEs. The results have been obtained using Matlab functions fmincon in combination with ode45. The available data
start on February 24 2020, when moderate social restrictions were enforced by
the Italian government, and since the lockdown started on March 9 2020, thus
we considered tu − t0 = 14 (days).
The corresponding time dependent values for the expected penalization for
a perception function ψ(I) = I q /q are reported in Figure 6. After an initial
adjustment phase the penalty terms converge towards a constant value that
we can assume as fixed in predictive terms for future times in a lockdown
scenario. This is consistent with a situation in which society needs a certain
period of time to adapt to the lockdown policy.
Remark 2 Finally, we remark that the data fitting procedure is easily generalizable to epidemic models with additional compartments [24, 25]. Let us
denote with Ci (t) the compartments that are related to the reported data
Ĉj (t), j = 1, . . . , h, as the number of actual cases, hospitalized, deaths, etc. In
the first step one minimizes a weighted L2 norm in the form
min
p∈P

h
X

wj kCj (t) − Ĉj (t)kL2 [t0 ,tu ] ,

(32)

j=1

Ph
where wj ∈ [0, 1] are suitable weights such that j=1 wj = 1 and p is the
vector of the model parameters that need to be estimated. Since the problem
may admit multiple minima leading to unrealistic solutions one usually perform the above optimization process under constraints on the range of values
P of some parameters such as recovery rate, incubation period, etc.

22

Giacomo Albi et al.

An important difference, compared to a simple SIR compartmentalization, is the presence of compartments that are not data-driven as exposed,
pre-symptomatic, asymptomatic, etc. that prevent the realization of the data
fitting since their values are unknown. A way to overcome this difficulty is
to solve the differential model starting from an unknown time t∗ < t0 using
as initial data the presence of a single individual in the first compartment
promoting the infection (for example the exposed) and zero individuals in all
other compartments. The idea is to simulate the early phase of the epidemic,
by optimizing also the initial time t∗ in problem (32).
After this, in the second step one considers the corresponding feedback
controlled model (see Appendix A) and solves the minimization problem
min
κ(ti )

h
X

wj kCj (t) − Ĉj (t)kL2 ([ti −k` ,ti +kr ]) ,

(33)

j=1

where κ(ti ) is the vector of penalization terms that need to be estimated. Even
in this case, assumptions on the range of values of the penalization terms may
be necessary to avoid unrealistic solutions. Finally, we underline that most
epidemic models are not data-driven, but one can always assume that the
total number of reported cases underestimates the actual number of cases and
perform the above data fitting to obtain a lower bound on the evolution of the
epidemic. Then including a suitable data uncertainty, as in the present work,
allows the recovery of realistic scenarios for the pandemic progression.
Introducing data uncertainty
To account for the impact of uncertainties in the data and parameters we then
consider a two-dimensional random variable z = (z1 , z2 ) with independent
components such that
i(z, 0) = i0 (1 + µz1 ),

r(z, 0) = r0 (1 + µz1 ),

µ > 0,

(34)

αγ , αβ > 0,

(35)

and
γ(z) = γe + αγ z2 ,

β(z) = βe − αβ z2 ,

where z1 , z2 are chosen distributed as symmetric Beta functions in [0, 1], i0 and
r0 are the initial number of reported cases and recovered taken from [46] on
February 24, 2020. The choice of a Beta distribution for p(z) = p1 (z1 )p2 (z2 ) is
coherent with other authors [48, 53]. However, different probability distribution
functions may be considered if additional information on the nature of the
uncertainties are available.
It should be noted that the estimated reproduction number, computed in
the first optimization step, corresponds to R0e = βe /γe ≈ 6.3, which is at the
upper limit of the values reported in the literature for COVID-19 [31, 54, 38].
Being aware of the limitations of the data fitting on reported data, to consider
a more realistic range of values we assumed a stochastic dependence in β and
γ taking into account the faster recovery of asymptomatic individuals [24] and

Control with uncertain data of epidemic models

23

Fig. 7 Test 2. Estimated reproduction number R0 from the feedback controlled model
with uncertain data (35) for a perception function ψ(I) = I q , q = 1 (left) and q = 2 (right)
together with the confidence bands. We mark with dash-dotted green lines the days in which
the lower 95% band and the expected R0 fell below one, and with x-markers the estimated
reproduction number relative to data fitting.

the fact that asymptomatic individuals might be slightly less infectious than
symptomatic cases [29]. In the simulations we take αβ = 0.03, αγ = 0.04 and
z2 ∼ B(2, 2) in (35). Under this assumptions the reproduction number covers
a range of values approximatively in [3.13, 6.27] with an expected value around
4.25.
The reproduction number in the feedback controlled model is estimated
from
β(z2 ) − u(t)χ(t > t̄)
.
(36)
R0 (z2 , t) =
γ(z2 )
In (36) the time t̄ is the lockdown time, in the case under study March 9th,
and χ(·) the indicator function. The feedback control u(t) is defined from (29)
in the case of homogeneous mixing and assuming R[S(·, t)I(·, t)ψ 0 (I(·, t))] =
S(z0 , t)I(z0 , t)q as in (26), where I(z0 , t) is the total number of infected reported at time t. This leads to
u(t) =

1
S(z0 , t)I(z0 , t)q ,
κ(t)

(37)

in agreement with the fact that the confinement restrictions have been implemented accordingly to the reported data. Note that, otherwise the action of
the uncertainty translates into the control and leads to the unrealistic effect
that the largest is the number of unreported infected the largest is the action
of the control in the system.
In Figure 7 we report the expected value of R0 together with the 95%
and 50% confidence levels with respect to the variable z2 . The estimated reproduction number relative to data fitting is reported with x-marked symbols
and represents an upper bound for R0 (z2 , t). The results show that the R0
reproduction number, thanks to the containment actions, has been drastically
reduced and its expected value fell below one between March 23rd and March
29th for both q = 1 and q = 2. After March 29th the observed R0 is stably

24

Giacomo Albi et al.

Fig. 8 Test 2. Evolution of expected current cases (left) and of the expected total cases
(right) and their 95% confidence bands with respect to z1 (shaded color) and z2 (shaded
gray) for the feedback controlled model with perception function ψ(I) = I, and uncertain
initial data (34)-(35).

below unity. Note that, in both controls the results are very similar, without
any need of renormalization for q = 2 due to the data fitting process.
Next we considered the evolution of the uncertain number of infected. In
the following we assumed a strongly underestimated initial number of infected
(including asymptomatic), taking µ = 50 so that the reported infected along
the time horizon of the simulation represent approximately a 20% portion of
the total infected persons computed by the feedback controlled model. This is
in accordance with the WHO findings that around 80% of infected are asymptomatic1 and with the results of preliminary serological campaigns promoted
in Italy2 .
In Figure 8 we represent the evolution of the expected value of the number
of infected obtained by the controlled model with perception function ψ(I) = I
in presence of uncertain contact and recovery rates (35) and initial uncertain
data (34) assuming z1 ∼ B(40, 40) and z2 ∼ B(2, 2). We represent the expected
values of the current cases (left) and of the total cases (right) along with the
95% confidence level with respect to the variables z1 and z2 . The shaded color
band is relative to the variability in z1 whereas the shaded gray band is relative
to the variability in z2 . The bars below the graph are the reported values of
the number of infected on which the model has been calibrated. The results
with q = 2 do not highlight significant differences with respect to the case
q = 1 and therefore have been omitted.

4.3 Test 3: The effect of social contacts in the population
Subsequently, we analyze the effects of the inclusion of age dependence and
social interactions in the above scenario. More precisely we consider the social
1 Q&A: Similarities and differences COVID-19 and influenza.
https://www.who.int/news-room/q-a-detail/q-a-similarities-and-differences-covid-19-and-influenza
2 Preliminary results on the seroprevalence of SARS-CoV-2 in Italy:
https://www.istat.it/it/files//2020/08/ReportPrimiRisultatiIndagineSiero.pdf

Control with uncertain data of epidemic models
10

25

6

Data
Age distribution

6
5

Data
i(a,0)

50
40

4

30

3
20

2

10

1
0

0

20

40

60

80

90+

0

0

20

40

60

80

90+

Fig. 9 Test 3. Distribution of age in Italy (left) and distribution of infected (right) together
with the corresponding continuous approximations2 .

Fig. 10 Test 3. Expected number of infected in time for the perception function ψ(I) = I q ,
q = 1 (left) and q = 2 (right) and a constant recovery rate together with the confidence
bands for homogeneous mixing (ξ = 0), mild social mixing (ξ = 0.75) and full social mixing
(ξ = 1).

interaction rate β = β(a, a∗ ), recovery rate γ = γ(a) and uncertain initial
number of infected. These functions were normalized using the estimated parameters βe and γe in accordance with
Z
Z
βe =
β(a, a∗ )f (a)f (a∗ ) da da∗ ,
γe =
γ(a)f (a) da,
(38)
Λ×Λ

Λ

where f (a) is the age distribution with Λ = [0, amax ], amax = 100.
The age dependent social interaction rate β(a, a∗ ) is defined as follows,
β(a, a∗ ) = (1 − ξ)βe + ξβsocial (a, a∗ ),

(39)

where 0 ≤ ξ ≤ 1, thus for ξ = 0 we recover the homogeneuos mixing, whereas
for ξ = 1 we have a full social mixing behavior. The social interaction
function, βsocial (a, a∗ ), accounts for the interactions due to specific activities
A = {Family, Education, Profession} and is defined by (55) in Appendix C.
However, since after the discovery of the first case (February 21), schools, and
many places of aggregation were closed in most regions of Northern Italy, we

26

Giacomo Albi et al.

Fig. 11 Test 3. Expected number of infected and total cases of infected and recovered
in time for a perception function ψ(I) = I q , q = 1 (left) and q = 2 (right) together with
the confidence bands for the social mixing scenario with age-independent or age-dependent
recovery rate.

assume that βE is 0 from February 24 onwards, while βP is reduced by a factor
one-half from March 9 onwards.
The choice of age dependent recovery rate γ(a) involves a certain degree
of arbitrariness, nevertheless it is reasonable to account such heterogeneity as
observed in different studies [21, 51, 50]. In order to account fast recovery rate
of young people, and slow recovery of the eldest we chose γ(a) to be constant
up to a specific age a0 and then a decreasing function of the age. We express
mathematically the recovery rate as


γ(a) = Cγ χ(a ≤ a0 ) + (1 − χ(a ≤ ao ))e−r(a−ao ) ,
(40)
with r = 4.5, ao = 20 and Cγ ∈ R+ such that (38) holds.
We divided the computation time frame into two zones and used different
models in each zone, in accordance with the policy adopted by the Italian
Government. The first time interval defines the period without any form of
containment from 24 February to 9 March, the second the lockdown period
from 9 March. In the first zone we adopt the uncontrolled model with homogeneous mixing. Hence, in the second zone we compute the evolution of the
feedback controlled age dependent model (27)-(29) with matching (on average) interaction and recovery rates accordingly to (38) and with the estimated
value of the control penalization κ(t) as reported in Figure 6 until April 30.

Control with uncertain data of epidemic models

27

After April 30 the computation advances in time using as penalization term
the constant asymptotic value κ̄ reached by κ(t). The initial values for the age
distributions of susceptible and infectious individuals are shown in Figure 9 in
agreement with reported data3 .
In Figure 10 we report the results of the expected number of infected with
the related confidence bands in case of homogeneous mixing and different
levels of social mixing (ξ = 0.75, ξ = 1) for the constant recovery rate γe . The
homogeneous mixing hypothesis leads to a lower estimate of the maximum
number of infected and shows a slower decay over time in the case q = 1,
whereas for q = 2 the decay is comparable. In Figure 11 we compare the case
of constant and age-dependent recovery rates for the social mixing scenario.
The expected number of infected are shown in the top row, bottom row depicts
the total number of recovered and infected people. The heterogeneity of the
recovery rate makes the epidemic more persistent and causes an increase in the
total number of cases with respect to the homogeneous recovery rate. Finally,
in Figure 12 we report the expected age distribution of infectious individuals
in time for q = 1. It is evident the effect of the age dependent recovery rate
in the increase of cases among the oldest part of the population. Note that,
this effect is partially compensated by the strength of the social mixing which
reduces interaction among the elderly.

4.4 Test 4: Reducing the epidemic through relaxed social containment
One of the major problems in the application of very strong containment
strategies, such as the lockdown applied in Italy, is the difficulty in maintaining
them over a long period, both for the economic impact and for the impact on
the population from a social point of view. In order to analyze sustainable
control strategies, therefore, it is necessary to resort to models with a social
structure and control methods based on specific forms of social distancing that
allow the economy to restart and the population to dedicate itself, albeit in a
limited way, to its pre-pandemic activities.
In accordance with the interaction function introduced in the Appendix C,
we considered the following age dependent relaxation function

ps a, a∗ ∈ ΛP
Ψ (a, a∗ , t) =
(41)
pw elsewhere
where the interval ΛP defines the age group related to a stronger relaxation
of the restrictions (in the sequel we assume ΛP = [25, 65]), and the parameters 0 ≤ pw < ps ≤ 1 characterize the intensity of the heterogeneity of the
relaxation process over the different age classes. Hence we relax the control
parameter defined in (29) according to
urelax (a, a∗ , t) = (1 − Ψ (a, a∗ , t))u(a, a∗ , t).
3 Source
ISTAT (https://www.istat.it)
(https://www.epicentro.iss.it)

and

Istituto

Superiore

(42)
di

Sanità

28

Giacomo Albi et al.
10 4

10 4
6

2.5
5
2
4
1.5

3

1

2

0.5

1

10 4

10 4
5

2.5

4

2
1.5

3

1

2

0.5

1

Fig. 12 Test 3. Expected age distribution of infectious individuals for a perception function
ψ(I) = I with mild (left) and full (right) social mixing. In the top row γ = γe and in the
bottom row γ = γ(a) defined in (40).

ps × 100%
pw × 100%

until March 9
–
–

March 9 - May 3
0%
0%

May 4 - June 2
15%
5%

from June 3
20%
10%

Table 1 Reduction of the feedback control (42) over different time periods due to the
relaxation of the lockdown processes by the choice of the parameter ps and pw of the age
dependent function Ψ defined in (41).

The evolution of the infection is considered within two different relaxation
times, at May 4 and at June 3, as actuated by the Italian Government during
the first wave of the pandemic. We report in Table 1 the specific choice of the
parameter ps and pw associated to different periods. Note that, these values
are directly related with an increase of the disease transmission rather than
to a relaxation of restrictions. In fact, it is clear that under suitable safety
precautions a relaxation of restrictions may not contribute to the progress of
the epidemic.
In Figure 13 (top row) we report the evolution of the age-controlled model
with perception function ψ(I) = I, with mild social mixing and with full social mixing and homogeneous recovery rate. Each plot compare the evolution
with relaxation of the containment measure and without, respectively indicated with E[Irelax ] and E[I]. It is easily observed how the relaxation process
increases the number of infected persons. Although the expected value remains

Control with uncertain data of epidemic models

10 4

100

29

10 4

100

2.5

80

5

80
2

60

1.5

40

1

20
0

0.5

Mar 9

May 4

Jun 3

4

60

3

40

2

20
0

1

Mar 9

May 4

Jun 3

Fig. 13 Test 4. Expected number of infected with relaxed control (42) characterized by
Table 1, perception function ψ(I) = I, and homogeneous recovery rate, using mild social
mixing (left) and with full social mixing (right). In the bottom row the corresponding expected age distribution of infectious individuals is reported.

under control, the wider confidence bands highlight the risk of a resumption of
the epidemic. Of course, a further relaxation of the values in Table 1 will lead
to a higher risk of restarting the epidemic wave. In Figure 13 (bottom row)
we report also the evolution of the age-dependent expected number of infected
individuals, both for mild social mixing and full social mixing. We remark
that, as expected, the relaxation process focuses the increase of infections in
the interval characterized by ΛP .
As can be seen, a gradual strategy can keep the average number of infections under control and have an outcome comparable to the fully controlled
model at a potentially lower social cost. The timing and intensity of interventions, however, are crucial to prevent the restart of the epidemic wave.

5 Conclusions
Quantifying the impact of uncertain data in the context of an epidemic emergency is essential in order to design appropriate containment measures. Such
containment measures, implemented by several countries in the course of the
COVID-19 epidemic, have proved effective in reducing the R0 reproduction
number to below or very close to one. These large-scale non-pharmaceutical

30

Giacomo Albi et al.

interventions vary from country to country but include social distancing (banning large mass events, closing public places and advising people not to socialize outside their families), closing borders, closing schools, measures to isolate
symptomatic individuals and their contacts, and the large-scale lock-down of
populations with all but essential prohibited travel.
One of the main problems is the sustainability of these interventions, which
until the introduction of a vaccine will have to be maintained in the field for
long periods. However, estimating the reproductive numbers of SARS-CoV-2
is a major challenge due to the high proportion of infections not detected by
health care systems and differences in test application, resulting in diverse proportions of infections detected over time and between countries. Most countries
initially had only the capacity to test a small proportion of suspected cases and
tests were reserved for severely ill patients or high risk groups. The available
data therefore offer a systematic partial overview of trends.
In this article, starting from a SIR-type compartmental model with social
structure, we developed new stochastic mathematical models describing the
actions of a government agency to contain infections among the population in
presence of an uncertain number of infectious individuals. More precisely, in
the present model, the state of the infected is defined by a multi-dimensional
time-dependent function characterized by the age, which proved essential in
the description of the COVID-19 pandemic, and by a systematic uncertainty
which permits to avoid additional sub-compartmentalization of the infectious
population.
These assumptions allows to derive a socially structured model that contains the control action in feedback form based on the perception of the policy
maker of the spread of the disease. Subsequently, the uncertainty in the model
has been approximated by expanding the state variables into orthogonal polynomials in the random space, reducing the problem to a set of deterministic
equations for the distribution of the solution through the course of the epidemic. The resulting controlled stochastic dynamical system is then solved
using this deterministic formulation, which in the case of sufficiently regular uncertainty distributions allows efficient and accurate estimations of the
random parameters.
The numerical simulations, performed using data from the recent COVID19 outbreak in Italy, show, on the one hand, the model’s ability to characterize
the presence of the asymptomatic population trough the introduction of an
uncertainty in the number of infected and in their epidemic role, and, on the
other hand, in presence of control to well describe the effects of non pharmaceutical interventions aimed at flattening the infection curve. In particular,
identifying some scenarios in agreement with government actions, containment
measures by the population based on the resumption of certain occupational
activities characterized by specific age groups and social interaction matrices
were studied.
Further studies in this direction will aim to consider more comprehensive epidemic models, including the effects of other clinical compartments of
interest, along with generalization of the control term to different objective

Control with uncertain data of epidemic models

31

functions or to the case of multiple control terms for each social activity, in
order to design optimal strategies to mitigate the overall epidemic impact.

A Feedback controlled models with additional
compartmentalizations
In this Appendix, we will detail how to extend the instantaneous control approach introduced
in Section 2.3 in the case of a a socially-structured SEPIAR-type compartmentalization [24]
where the control functional is given by
T

Z
min J(u) :=

u∈U

ψ(IT (t))dt
0

+

1
2

T

Z

X
j∈{P,I,A}

(43)

Z

0

νj (a, a∗ , t)|uj (a, a∗ , t)|2 dada∗ dt,

Λ×Λ

with u = (uP , uI , uA ) and subject to
d
s(a, t) = −s(a, t)
dt
d
e(a, t) = s(a, t)
dt

Z

X

(βj (a, a∗ ) − uj (a, a∗ , t))ij (a∗ , t) da∗
Λ

j∈{P,I,A}

X
j∈{P,I,A}

Z
(βj (a, a∗ ) − uj (a, a∗ , t))ij (a∗ , t) da∗ − δE (a)e(a, t)
Λ

d
iP (a, t) = δE (a)e(a, t) − δP (a)iP (a, t)
dt
d
iI (a, t) = σ(a)δP (a)iP (a, t) − γI (a)iI (a, t)
dt
d
iA (a, t) = (1 − σ(a))δP (a)iP (a, t) − γA (a)iA (a, t)
dt
d
r(a, t) = γI (a)i(a, t) + γA (a)iA (a, t).
dt

(44)

In the above compartmentalization e, iP , iI , and iA represent the number of exposed, preasymptomatic, infected with heavy symptoms and asymptomatic/mildly symptomatic individuals, respectively [24]. The parameters βj , j ∈ {P, I, A} are the specific transmission
rates of the three infectious classes. Exposed individuals, still not contagious, enter the
presymptom stage at rate δE and only then become infectious. Pre-symptomatic individuals
progress at rate δP to become symptomatic who develop severe symptoms with probability
σ or asymptomatic individuals with probability 1−σ. Symptomatic individuals recover from
infection at rate γI whereas asymptomatic individuals leave their compartment after having
recovered from infection at rate γA .
In (43) we assume that the policy maker aims at minimizing the total number of infected
Z
IT (t) =

(iP (a, t) + iI (a, t) + iA (a, t)) da.
Λ

We highlight that other control strategies may be considered as well leading to different
feedback control formulations.
For the socially-structured SEPIAR model the feedback controlled formulation is then
obtained from the discrete approximation
min Jh (u) := ψ(IT (t + h)) +

u∈U

1
2

X
j∈{P,I,A}

Z
Λ×Λ

νj (a, a∗ , t)|uj (a, a∗ , t)|2 dada∗ ,

(45)

32

Giacomo Albi et al.

subject to
s(a, t + h) = s(a, t) − hs(a, t)

X

Z
(βj (a, a∗ ) − uj (a, a∗ , t))ij (a∗ , t) da∗

j∈{P,I,A} Λ

e(a, t + h) = e(a, t) + hs(a, t)

X

Z
(βj (a, a∗ ) − uj (a, a∗ , t))ij (a∗ , t) da∗ − hδE (a)e(a, t)

j∈{P,I,A} Λ

iP (a, t + h) = iP (a, t) + hδE (a)e(a, t + h) − hδP (a)iP (a, t)

(46)

iI (a, t + h) = iI (a, t) + hσ(a)δP (a)iP (a, t + h) − hγI (a)iI (a, t)
iA (a, t + h) = iA (a, t) + h(1 − σ(a))δP (a)iP (a, t + h) − hγA (a)iA (a, t)
where the discrete equation for r(a, t) can be omitted since the control does not play any
direct role in its evolution. The total number of infected evolved accordingly to
Z
IT (t + h) = IT (t) + h
(δE (a)e(a, t + h) − γI (a)iI (a, t) − γ(a)iA (a, t)) da.
(47)
Λ

We can derive the minimizer of Jh computing ∇u Jh (u) ≡ 0 or equivalently
∂Jh (ui )
= 0,
∂uj

i, j ∈ {P, I, A}.

Using (45) we can compute
ψ 0 (IT (t + h))

∂IT (a, t + h)
= −νj (a, a∗ , t)uj (a, a∗ , t),
∂uj

j ∈ {P, I, A},

which by virtue of (47) leads to the discrete feedback controls
uj (a, a∗ , t) =

h2 δE (a)
s(a, t)ij (a∗ , t)ψ 0 (IT (t + h)),
νj (a, a∗ , t)

j ∈ {P, I, A}.

(48)

In order to pass to the limit h → 0 in (46) and obtain the feedback controlled model, we
must rescale the penalization parameters with respect to the short time-horizon h. With
the aim of preserving the compartment of exposed, the penalization terms should rescale
as νj (a, a∗ , t) = h2 κj (a, a∗ , t) to get the feedback controlled model (44) where the control
terms are given by
uj (a, a∗ , t) =

δE (a)
s(a, t)ij (a∗ , t)ψ 0 (IT (t)),
κj (a, a∗ , t)

j ∈ {P, I, A}.

(49)

It is interesting to observe that the control action in (49) is inversely proportional to the
incubation time, namely shorter incubation periods requires a stronger control. On the
contrary, if one assumes the same rescaling adopted for the SIR model in (12), namely
νj (a, a∗ , t) = hκj (a, a∗ , t), and select a short time horizon equal to the incubation time
h = 1/δE , the exposed compartment in (46) reduces to
X Z
e(a, t + h) = hs(a, t)
(βj (a, a∗ ) − uj (a, a∗ , t))ij (a∗ , t) da∗
j∈{P,I,A} Λ

which substituted into the equation for iP (a, t + h) in the limit h → 0 leads to a feedback
controlled model in the form (44) without the compartment of exposed and where the presymptomatic satisfy
Z
X
d
iP (a, t) = s(a, t)
(βj (a, a∗ ) − uj (a, a∗ , t))ij (a∗ , t) da∗ − δP (a)iP (a, t).
dt
Λ
j∈{P,I,A}

Finally, we emphasize that the generalization to the case with uncertainty contains no difficulty and follows the same methodology introduced in Section 3. In terms of data-fitting,
similar to the SIR model, one considers the feedback controlled model in absence of agedependence and proceeds along the lines indicated in Remark 2. We will omit the details
for brevity.

Control with uncertain data of epidemic models

33

Probability law

Expansion polynomials

Gaussian
Uniform
Beta
Gamma
Poisson

Hermite
Legendre
Jacobi
Laguerre
Charlier

Support
(−∞, +∞)
[a, b]
[a, b]
[0, +∞)
N

Table 2 The different polynomial expansions connected to the probability distribution of
the random component zk , k = 1, . . . , dz .

B Stochastic Galerkin approximation
In this Appendix we give the details of the stochastic Galerkin (sG) method used to solve the
feedback controlled system (27)-(29) with uncertainties. To this aim, we consider a random
vector z = (z1 , . . . , zd ) with independent components and whose distribution is p(z) : Rdz →
Rd+z . The stochastic Galerkin approximation of the differential model (27)-(29) is based on
stochastic orthogonal polynomials and provides a spectrally accurate solution under suitable
regularity assumptions, see [53]. We consider the linear space PM of polynomials of degree
up to M generated by a family of polynomials {Φh (z)}M
that are orthonormal in the
|h|=0
space L2 (Ω) such that
E[Φh (·)Φk (·)] = δkh ,

0 ≤ |k|, |h| ≤ M

being k = (k1 , . . . , kd ) a multi-index, |k| = k1 + · · · + kdz with δkh the Kronecker delta
function, and E[·] the expectation with respect to p(z). The construction of the polynomial
basis {Φh (z)}M
depends on the distribution of the uncertainties and must be chosen in
|h|=0
agreement with the Askey scheme [53]. We summarize in Table 2 several polynomials bases
in connection with the law of a random component of z.
By assuming s(z, a, t), i(z, a, t) and r(z, a, t) in L2 (Ω) we may approximate these terms
through a generalized polynomial chaos expansion in the random space as follows
s(z, a, t) ≈ sM (z, a, t) =

M
X

ŝk (a, t)Φk (z)

|k|=0

i(z, a, t) ≈ iM (z, a, t) =

M
X

îk (a, t)Φk (z)

(50)

|k|=0

r(z, a, t) ≈ rM (z, a, t) =

M
X

r̂k (a, t)Φk (z),

|k|=0

where the quantities ŝk , îk , r̂k are projections in the polynomial space
ŝk = E [s(·, a, t)Φk (·)] ,

îk = E [i(·, a, t)Φk (·)] ,

r̂k = E [r(·, a, t)Φk (·)] .

The sG formulation of system (27) is obtained first by replacing the solutions with their
stochastic polynomial expansions
Z 

d M
s (z, a, t) = −sM (z, a, t)
β(z, a, a∗ ) − uM (a, a∗ ) iM (z, a∗ , t)da∗
dt
Λ
Z 

d M
M
i (z, a, t) = s (z, a, t)
β(z, a, a∗ ) − uM (a, a∗ ) iM (z, a∗ , t)da∗ − γ(z, a)iM (z, a, t)
dt
Λ
d M
r (z, a, t) = γ(z, a)iM (z, a, t),
dt
(51)

34

Giacomo Albi et al.

with

h
i
1
R sM (z, a, t)iM (z, a∗ , t)ψ 0 (I M (z, t)) ,
κ(a, a∗ )
Z
M
X
I M (z, t) =
Iˆk (t)Φk (z),
Iˆk (t) =
iM (z, a, t)da,

uM (a, a∗ ) =

(52)

Λ

|k|=0

and where sM , iM , rM are defined by (50). Then, thanks to the orthonormality of the
polynomial basis of PM , multiplying by Φm , for all |m| ≤ M , and taking the expectation
with respect to p(z) we obtain the following coupled system of M +1 deterministic equations
for the evolution of each projection

M
X

d


 ŝk (a, t) = −
Bkm (a, t)ŝm (a, t)


dt


|m|=0





M
M
d
X
X
îk (a, t) =
Bkm (a, t)ŝm (a, t) −
Gkm îm (a, t)
(53)
dt


|m|=0
|m|=0





M

X

d


r̂k (a, t) =
Gkm îm (a, t)


 dt
|m|=0

where
Bkm =

M Z
X
|l|=0

Rdz

Z 


β(z, a, a∗ ) − uM (a, a∗ ) îl (a∗ , t)da∗ Φk (z)Φm (z)Φl (z)p(z)dz
Λ

Z
Gkm =

Rdz

γ(z, a)Φk (z)Φm (z)p(z)dz.
(54)

The above system is then integrated in time directly in the space of projections. We remark
that statistical quantities of interest, such as expectation and variance of infected, can be
recovered as
E[iM (·, a, t)] =

Z

iM (z, a, t)p(z) dz =
Rdz

M
X

îk (a, t)E[Φk (·)] = î0 (a, t),

|k|=0

whereas for the variance we get
Var(iM (·, a, t)) = E[iM (·, a, t)2 ] − E[iM (·, a, t)]2
=

M
M
X
X

îk îh E[Φk (·)Φh (·)] − î20 (a, t) =

|k|=0 |h|=0

M
X

î2k (a, t) − î20 (a, t).

|k|=0

In all the simulations reported we used M = 10 and a fourth order Runge-Kutta method
for the time integration.

C Social mixing functions
This last appendix is devoted to report the details of the social interaction functions that
characterize the dynamics of social mixing. These characteristics are in fact crucial for a
correct prediction of outcomes, especially in diseases transmitted by close contacts. Several
large-scale studies have been designed in the last decade to determine relevant age-based
models in social mixing. Without attempting to review the vast literature on this topic, we
mention [6, 42, 45] and the references therein.

Control with uncertain data of epidemic models
1

1

35

1

1

0.9

0.8

0.8

0.8

0.8

0.7

0.6

0.6

0.4

0.6

0.6

0.2

0.4

0.4

0.2

0.2

0.2

0.4

0.6

0.8

1

0.7

0.6

0.6
0.5

0.4

0.4
0.3

0.2

0.2

0.1

0
0

0.8

0.3

0.1

0

0.9

0.8

0.5

0.3

0.2

1

0.7

0.5

0.4

1

0.9

0.1

0
0

0.2

0.4

0.6

0.8

1

0

0.2

0.4

0.6

0.8

1

Fig. 14 From left to right, contour plot of the social interaction functions βF , βE and βP
taking into account the different contact rates of people with ages a and a∗ in relation to
specific social activities. The function βF characterizes the family contacts, βE the education
and school contacts, and βP the professional contacts.

The number of contacts per person generally shows considerable variability according
to age, occupation, country and even day of the week, in relation to the social habits of
the population. Nevertheless, some universal behaviors can be extracted which emerge as a
function of specific social activities. Social mixing is highly age-related, which means that
people usually tend to interact with other people of a similar age. Young people have a high
rate of contact with adults aged around 30-39 and older people over 65, i.e. their parents and
grandparents respectively. Contact rates are indeed very high at home and at school. On
the other hand, professional mixing is weakly assortative by age and tends to be determined
by uniform interactions, approximately between people from 25 and 65 years old.
For these reasons we consider an interaction function determined by three main subfunctions that characterize the family, the school and the professional mixing. Therefore, a
stylized function approximating a realistic contact matrix can be written as follows
X
βsocial (a, a∗ ) = Cβ
ωj βj (a, a∗ ),
(55)
j∈A

where the functions βj (a, a∗ ) take into account the different contact rates of people with
ages a and a∗ in relation to specific social activities of the type A = {F, E, P }, where
we identify family contacts with F , education and school contacts with E and professional
contacts with P , and the associated weights ωF , ωE and ωP . The particular structure of
these social interaction matrices was determined empirically in [6, 45]. Here, according to
these observations, we propose suitable mathematical functions that can be calibrated to
reproduce empirical observations, in what follow we normalize βe = 1 and amax = 1. In
details, familiar contacts tend to concentrate on a three-band matrix with a peak around
younger ages. This can be reproduced considering the function
(
)
q
λF,1
1
a2 + a2∗
2 + a2 ) exp −
β̃F (a, a∗ ) =
(a
.
+
∗
2
σF
(1 + (a − a∗ )2 )λF,2
(1 + (a − a∗ )2 )λF,2
Hence, we define the family interactions as
i
X
C` h
βF (a, a∗ ) = β0 +
β̃F (a + µ, a∗ ) + β̃F (a, a∗ + µ) ,
2
`={−µ,0,µ}

being µ > 0 the age shift at which family contacts occur and C±µ = 1/2 and C0 = 1.
are reported in Table 3 On the other hand, school and professional interactions are more
age-specific and the corresponding matrices can be reproduced as follows
(
)

1
βE (a, a∗ ) = β0 + exp − 2 (a − λE )2 + (a∗ − λE )2
σE
(
)

1
βP (a, a∗ ) = β0 + exp − 2 (a − λP )4 + (a∗ − λP )4
,
σP

36

Giacomo Albi et al.

Fig. 15 Social interaction functions βsocial = βF + βE + βP .
Contact function
βF (a, a∗ )
βE (a, a∗ )
βP (a, a∗ )

β0
0.04
β0
0.04
β0
0.04

2
σF
0.125
2
σE
0
2
σP
0.00125

Parameters
λF,1
λF,2
0.02
100
λE
0.105
λP
0.4

µ
0.3

C±µ
0.5

C0
1

ωF
1
ωE
0
ωP
0.5

Table 3 The parameters defining the details of the interaction functions used in the simulations.

being λE > 0 the average contact age at school, and λP > 0 the average professional contact
age. The coefficient CF , CE , CP > 0 measure the impact of the different contact function in
the dynamics. In Figures 14 and 15 we represent the three social interaction functions and
the resulting global social interaction function βsocial (a, a∗ ) assuming ωF = ωE = ωP = 1.
In Table 3 we report the choice of the parameters used in the simulations.
Acknowledgements This work has been written within the activities of GNFM and GNCS
groups of INdAM (National Institute of High Mathematics). G. Albi and L. Pareschi acknowledge the support of MIUR-PRIN Project 2017, No. 2017KKJP4X Innovative numerical methods for evolutionary partial differential equations and applications. M. Zanella was
partially supported by the MIUR Program (2018-2022), Dipartimenti di Eccellenza, Department of Mathematics, University of Pavia.

Conflict of interest
The authors declare that they have no conflict of interest.

References
1. G. Albi, L. Pareschi. Selective model-predictive control for flocking systems. Commun.
Appl. Ind. Math., 9(2): 4–21, 2018.

Control with uncertain data of epidemic models

37

2. G. Albi, L. Pareschi, M. Zanella. Uncertainty quantification in control problems for flocking models. Math. Probl. Eng., 2015: Art. ID 850124, 2015.
3. G. Albi, M. Herty, L. Pareschi. Kinetic description of optimal control problems and
applications to opinion consensus. Commun. Math. Sci., 13(6): 1407–1429, 2015.
4. G. Albi, L. Pareschi, M. Zanella. Boltzmann-type control of opinion consensus through
leaders. Philos. Trans. R. Soc. Lond. Ser. A: Math. Phys. Eng. Sci., 372(2028): 20140138,
2014.
5. M. Barro, A. Guiro, D. Ouedraogo. Optimal control of a SIR epidemic model with general
incidence function and a time delays. Cubo, 20(2): 53–66, 2018.
6. G. Béraud, S. Kazmercziak, P. Beutels, D. Levy-Bruhl, X. Lenne, N. Mielcarek, Y. Yazdanpanah, P.Y. Boëlle, N. Hens, B. Dervaux. The French connection: The first large
population-based contact survey in France relevant for the spread of infectious diseases.
PLoS ONE, 10(7): e0133203, 2015.
7. L. Bolzoni, E. Bonacini, C. Soresina, M. Groppi, Time-optimal control strategies in SIR
epidemic models, Math. Biosci., 292: 86–96, 2017.
8. M. Bongini, M. Fornasier, D. Kalise. (Un)conditional consensus emergence under perturbed and decentralized feedback controls. Discrete Contin. Dyn. Syst., 35(9): 4071-4094,
2015.
9. T. Britton, F. Ball, P. Trapman. The disease-induced herd immunity level for Covid-19
is substantially lower than the classical herd immunity level. preprint arXiv:2005.03085,
2020.
10. A. Capaldi, S. Behrend, B. Berman, J. Smith, J. Wright, A. L. Lloyd. Parameter estimation and uncertainty quantification for an epidemic model. Math. Biosci. Eng., 9(3):
553–576, 2012.
11. V. Capasso, G. Serio. A generalization of the Kermack-McKendrick deterministic epidemic model. Math. Biosci., 42(1): 43–61, 1978.
12. M. A. Capistrán, J. A. Christen, J. X. Velasco-Hernández. Towards uncertainty quantification and inference in the stochastic SIR epidemic model, Math. Biosci., 240(2): 250–259,
2012.
13. M. Caponigro, M. Fornasier, B. Piccoli, E. Trélat. Sparse stabilization and optimal
control of the Cucker-Smale model. Math. Control Relat. Fields, 3(4): 447-466, 2013.
14. C. Castillo-Chavez, H. W. Hethcote, V. Andreasen, S. A. Levin, W. M. Liu. Epidemiological models with age structure, proportionate mixing, and cross-immunity. J. Math.
Biol., 27(3): 233–258, 1989.
15. R. M. Colombo, M. Garavello. Optimizing vaccination strategies in an age structured
SIR model. Math. Bios. Eng., 17(2): 1074–1089, 2019.
16. J. Chen et al. COVID-19 infection: the China and Italy perspectives. Cell Death and
Disease, 11: 438, 2020.
17. G. Chowell. Fitting dynamic models to epidemic outbreaks with quantified uncertainty:
A primer for parameter uncertainty, identifiability, and forecasts. Infect. Dis. Model., 2(3):
379–398, 2017.
18. G. Dimarco, L. Pareschi, M. Zanella. Uncertainty quantification for kinetic models in
socio-economic and life sciences. In Uncertainty Quantification for Hyperbolic and Kinetic
Equations, Editors S. Jin, and L. Pareschi, SEMA SIMAI Springer Series, 14, pp 151–191,
2017.
19. G. Dimarco, L. Pareschi, G. Toscani, M. Zanella. Wealth distribution under the spread
of infectious diseases. Phys. Rev. E 102, 022303, 2020
20. B. Düring, L. Pareschi, G. Toscani. Kinetic models for optimal control of wealth inequalities. Eur. Phys. J. B, 91, 265, 2018.
21. C. Faes, S. Abrams, D. Van Beckhoven, G. Meyfroidt, E. Vlieghe, N. Hens, and Belgian
Collaborative Group on COVID-19 Hospital Surveillance, Time between Symptom Onset,
Hospitalisation and Recovery or Death: Statistical Analysis of Belgian COVID-19 Patients.
International Journal of Environmental Research and Public Health, 17(20): 7560, 2020.
22. S. Flaxman et al. Estimating the number of infections and the impact of nonpharmaceutical interventions on COVID-19 in 11 European countries, Report 13. Imperial
College COVID-19 Response Team, 30 March 2020.
23. A. Franceschetti, A. Pugliese. Threshold behaviour of a SIR epidemic model with age
structure and immigration. J. Math. Biol., 57(1): 1–27, 2008.

38

Giacomo Albi et al.

24. M. Gatto, E. Bertuzzo, L. Mari, S. Miccoli, L. Carraro, R. Casagrandi, A. Rinaldo.
Spread and dynamics of the COVID-19 epidemic in Italy: Effect of emergency containment
measures. PNAS, 117(19): 10484–10491, 2020.
25. G. Giordano, F. Blanchini, R. Bruno, P. Colaneri, A. Di Filippo, A. Di Matteo,
M. Colaneri. Modelling the COVID-19 epidemic and implementation of population-wide
interventions in Italy. Nat Med, 26, 855–860, 2020.
26. J. Glasser, Z. Feng, A. Moylan, S. Del Valle, C. Castillo-Chavez. Mixing in agestructured population models of infectious diseases. Math. Bios., 235(1): 1–7, 2012.
27. H. W. Hethcote, Modeling heterogeneous mixing in infectious disease dynamics, in
Models for Infectious Human Diseases. V. Isham and G. F. H. Medley, eds., Cambridge
University Press, Cambridge, UK, 215–238, 1996.
28. H. W. Hethcote, The mathematics of infectious diseases. SIAM Rev., 42(4): 599–653,
2000.
29. A. A. Sayampanathan, C. S. Heng, P. H. Pin, J. Pang, T. Y. Leong, V. J. Lee, Infectivity
of asymptomatic versus symptomatic COVID-19, The Lancet, 397, 93–94, 2021.
30. M. Iannelli, F. A. Milner, A. Pugliese. Analytical and numerical results for the agestructured S-I-S epidemic model with mixed inter-intracohort transmission. SIAM J.
Math. Anal., 23(3) 662–688, 1992.
31. K. Jagodnik, F. Ray, F. M. Giorgi, A. Lachmann. Correcting under-reported
COVID-19 case numbers: estimating the true scale of the pandemic. Preprint
medRvix:2020.03.14.20036178.
32. S. Jin, L. Pareschi. Uncertainty Quantification for Hyperbolic and Kinetic Equations,
SEMA-SIMAI Springer Series, 14, 2017.
33. W.O. Kermack, A.G. McKendrick. A Contribution to the Mathematical Theory of Epidemics. Proc. Roy. Soc. Lond. A, 115: 700–721, 1927.
34. E. Lavezzo et al. Suppression of a SARS-CoV-2 outbreak in the Italian municipality of
Vo’. Nature, 584: 425–429, 2020.
35. S. Lee, G. Chowell, C. Castillo-ChÃ¡vez. Optimal control for pandemic influenza: the
role of limited antiviral treatment and isolation. J. Theor. Biol., 265(2): 136–150, 2010.
36. S. Lee, M. Golinski, G. Chowell. Modeling optimal age-specific vaccination strategies
against pandemic influenza. Bull. Math. Biol., 74(4): 958-980, 2012.
37. F. Lin, K. Muthuraman, M. Lawley. An optimal control theory approach to nonpharmaceutical interventions. BMC Infect. Dis., 10(1), 32, 2010.
38. Y. Liu, A. A. Gayle, A. Wilder-Smith, J. Rocklöv. The reproductive number of COVID19 is higher compared to SARS coronavirus. J. Travel Med., 27(2): 1–4, 2020.
39. A. Lunelli, A. Pugliese, C. Rizzo. Epidemic patch models applied to pandemic influenza:
Contact matrix, stochasticity, robustness of predictions. Mathematical Biosciences, 220:
24–33, (2009).
40. K. Mizumoto, K. Kagaya, A. Zarebski, G. Chowell. Estimating the asymptomatic proportion of coronavirus disease 2019 (COVID-19) cases on board the Diamond Princess
cruise ship, Yokohama, Japan, 2020. Euro. Surveill., 25(10): 2000180, 2020.
41. D. H. Morris, F. W. Rossine, J. B. Plotkin, S. A. Levin. Optimal, near-optimal, and
robust epidemic control. Preprint arXiv:2004.02209, 2020.
42. J. Mossong, N. Hens, M. Jit, P. Beutels, K. Auranen, R. Mikolajczyk, M. Massati,
S. Salmaso, G. Scalia Tomba, J. Wallinga, J. Heijne, M. Sadkowska-Todys, M. Rosinska,
W. J. Edmunds. Social contacts and mixing patterns relevant to the spread of infectious
diseases. PLoS Med., 5(3): e75, 2008.
43. M. Paradisi, G. Rinaldi. An Empirical Estimate of the Infection Fatality Rate
of COVID-19 from the First Italian Outbreak (4/18/2020). Available at SSRN:
https://ssrn.com/abstract=3582811 or http://dx.doi.org/10.2139/ssrn.3582811
44. L. Pareschi. An introduction to uncertainty quantification for kinetic equations and related problems. In Trails in Kinetic Theory: Foundational Aspects and Numerical Methods, SEMA-SIMAI Springer Series, 25, Eds. G. Albi, S. Merino-Aceituno, A. Nota, M.
Zanella, 2021.
45. K. Prem, A. R. Cook, M. Jit. Projecting social contact matrices in 152 countries using
contact surveys and demographic data. PLoS ONE, 13(9): e1005697, 2017.
46. Presidenza del Consiglio dei Ministri, Dipartimento della Protezione Civile. GitHub:
COVID-19 Italia - Monitoraggio situazione, https://github.com/pcm-dpc/COVID-19,
2020.

Control with uncertain data of epidemic models

39

47. A. Remuzzi, G. Remuzzi. COVID-19 and Italy: what next? Lancet, 395:1225–1228,
2020.
48. M. G. Roberts. Epidemic models with uncertainty in the reproduction. J. Math. Biol.,
66: 1463–1474, 2013.
49. T.W Russell, J. Hellewell, C. I. Jarvis, K. van Zandvoort, S. Abbott, R. Ratnayake,
S. Flasche, R.M. Eggo, W.J. Edmunds, A.J. Kucharski. Estimating the infection and
case fatality ratio for coronavirus disease (COVID-19) using age-adjusted data from the
outbreak on the Diamond Princess cruise ship, Euro Surveill, 25(12):pii=2000256, 2020.
50. R. Verity et al., Estimates of the severity of coronavirus disease 2019: a model-based
analysis, The Lancet Infectious Diseases, 20(6):669–677, 2020.
51. I. Voinsky, G. Baristaite, D. Gurwitz, Effects of age and sex on recovery from COVID-19:
Analysis of 5769 Israeli patients, Journal of Infection, 81(2):102–103, 2020.
52. S. Wang , F. Zhong , W. Bao , Y. Li , L. Liu , H. Wang , Y. He. Age-dependent risks
of Incidence and Mortality of COVID- 19 in Hubei Province and Other Parts of China
Hongdou. Frontiers in Medicine, 7, 190, 2020.
53. D. Xiu. Numerical Methods for Stochastic Computations: A Spectral Methods Approach,
Princeton University Press, 2010.
54. S. Zhang, M. Diao, W. Yu, L. Pei, Z. Lin, D. Chen. Estimation of the reproductive
number of novel coronavirus (COVID-19) and the probable outbreak size on the Diamond
Princess cruise ship: A data-driven analysis. International Journal of Infectious Diseases,
93: 201–204, 2020.

