Using mobility data in the design of optimal lockdown strategies for
the COVID-19 pandemic
Ritabrata Dutta1∗, Susana Gomes2 , Dante Kalise3 , Lorenzo Pacchiardi4
1
2

arXiv:2006.16059v2 [stat.AP] 18 Oct 2020

3

Department of Statistics, Warwick University, UK

Department of Mathematics, Warwick University, UK

School of Mathematical Sciences, University of Nottingham, UK
4

Department of Statistics, University of Oxford, UK

October 20, 2020

Abstract
A mathematical model for the COVID-19 pandemic spread, which integrates age-structured SusceptibleExposed-Infected-Recovered-Deceased dynamics with real mobile phone data accounting for the population mobility, is presented. The dynamical model adjustment is performed via Approximate Bayesian
Computation. Optimal lockdown and exit strategies are determined based on nonlinear model predictive
control, constrained to public-health and socio-economic factors. Through an extensive computational
validation of the methodology, it is shown that it is possible to compute robust exit strategies with realistic reduced mobility values to inform public policy making, and we exemplify the applicability of the
methodology using datasets from England and France. Code implementing the described experiments is
available at https://github.com/OptimalLockdown.
Keywords: COVID-19, Lockdown strategy, epidemic model, SEIRD, Google mobility, Approximate Bayesian
computation, Model predictive control.

Author summary
In many countries, the COVID-19 pandemic has revealed a gap between public policy making and the use
of advanced technological tools to inform such a process. In the big data era, decisions concerning the
implementation of quarantines and travel restrictions are still being taken based on incomplete public health
data, despite the myriad of information our society provides in real time, such as mobility data, commuting
network structures, and financial patterns, to name a few. To advance towards an effective data-driven,
quantitative policy making, we propose a computational framework where a predictive epidemiological model
is fitted by feeding both public health and Google mobility data. The resulting model is then used as a basis
for designing mobility reduction strategies which are optimised taking into account both the healthcare system
capacity, and the economic impact of an extended lockdown. For the COVID-19 pandemic in England and
France, we show that it is possible to design lockdown policies allowing a partial return to workplaces and
schools, while maintaining the epidemic under control.

1

Introduction

The COVID-19 pandemic has put quantitative decision-making methods (and the lack thereof) in the spotlight. Designing informed non-pharmaceutical intervention strategies (NPIS) to mitigate the pandemic effects
has been a controversial issue worldwide. In particular, the planning of effective lockdown policies and their
posterior lifting based on real-time data still remains a largely open problem. A vast amount of research
∗ Corresponding author: Ritabrata.Dutta@warwick.ac.uk. (Research planned by RD, LP, SG, DK; research done by LP, RD
and paper written by LP, RD, SG, DK.)

1

efforts has been dedicated to model the COVID-19 pandemic focusing on the various aspects of the system
dynamics, such as estimating the value of the basic reproductive number [17, 21], evaluating the effect of
containment measures and travel restrictions [32, 15, 21, 26, 12], assessing the effect of age on the transmission
and severity of the disease [13, 17] and estimating the impact on Health Services [18]. It is remarkably hard,
if not impossible, to capture every aspect of this complex phenomenon in an integrated and computationally
tractable mathematical model. With this in mind, our goal in the present work is to study the dynamics
of COVID-19 spread by integrating a dynamical epidemiological model with mobile phone data from the
population. Such an adjusted model yields an accurate account of the real displacement of the population
between different locations (e.g. workplaces, schools, etc.) during the pandemic, and serves as the basis for
determining lockdown and exit strategies which are optimised according to public health and socio-economic
constraints.
Related Literature. Previous works have modelled the impact of NPIS using extensions of the classical
Susceptible-Infected-Removed (SIR) model [19] with the inclusion of compartments corresponding to asymptomatic population which are either exposed to infections but not yet infectious or infected and infectious
[28]. Given the current knowledge of the COVID-19 disease, this constitutes a complete description of the
possible states.
Among the works based on the aforementioned state space representation, [26], one of the main inspirations
behind our work, uses an age-structured model to quantify the effect of control measures imposed in Wuhan,
China and concludes that there exists a large potential on the use of NPIS for mitigating the COVID-19
pandemic. Furthermore, the authors recommend a gradual relaxation strategy in comparison to an early
lifting of the imposed lockdown measures to avoid possible second and third waves of the pandemic. Using a
stochastic modification of a compartmental model without age structure, [21] reaches similar conclusions and
quantifies the effectiveness of lockdown measures by estimating the reproduction number, which decreased
from a median value of 2.35 before travel restrictions were imposed, to 1.05 one week after the implementation
of travel restrictions.
In the context of resorting to optimal control methods to determine a lockdown policy, [27] compares a
switching on-off strategy with a two-stage release from quarantine (with part of the population released first,
and the others later). The authors consider a threshold-based sanitary cost functional aiming at releasing
the largest possible population without exceeding the availability of hospital beds, and their conclusion is to
favour the second strategy. [11] consider multiple control levers, such as the number of tests (both virologic
and anti-body tests) and the increase of ICU beds in addition to the reduction of social contacts, and uses a
cost functional involving both economic and sanitary costs. The authors suggest an optimal lockdown policy
which involves a quick and strong isolation, followed by a large increase in the number of tests.
Our contribution. While the qualitative modelling and control concepts of the aforementioned works are
aligned with the epidemiological literature, we remark that most of these papers use parameter values collected
from previous works or estimated using either different models or from clinical knowledge. Hence, they cannot
be directly applied to populations with different spatio-temporal patterns. In contrast, the main goal of this
paper is to propose a framework which calibrates the model using epidemiological and real-time mobility
data from a specific population, measured by Google Mobility through Android devices, and computes an
optimal lockdown strategy for that population at any point of the pandemic. To achieve this, we combine
parameter estimation for an epidemiological model with a subsequent optimal control step. Secondly, our
framework includes the computation of the optimal lockdown policy in a nonlinear model predictive control
framework, leading to a robust feedback protocol which allows not only real-time adaptation of the release
strategy but also a partial lockdown, as opposed to a switching on/off strategy which can be too restrictive.
Methodological summary. Our epidemiological model simulates the transmission dynamics of COVID19 spread in the English and French populations using anonymised data on the reduction of the population
mobility collected through smartphones and released by Google. Further, exploiting Approximate Bayesian
Computation (ABC), we calibrate this model using data on daily deaths and the number of people in hospitals
with COVID-19 released from public health authorities (Public Health England (PHE) and the National
Health Service (NHS) in England, and Santé publique France (SpF) in France) [23, 24, 34, 35]. In ABC,
we assume a prior distribution for each parameter value and, given a dataset with an inherent observation
2

noise, we obtain a non-parametric estimate of the joint probability distribution of the parameter values. This
allows us to estimate parameters of our model for the specific cases of England and France, as opposed to
inheriting parameters from epidemiological models from other countries. Some key attributes of our model
are the inclusion of age-dependent transition probabilities between the different compartments which are
also estimated from data, as well as age-dependent social distancing, and the use of Google mobility data
to quantify the effect of social distancing measures in reality. Having calibrated our model, we design a
lockdown strategy which is differentiated according to social contact categories including schools, work, and
others. This allows us to assign a different economic penalty for each one of them. Borrowing a leaf from
optimal control theory, we synthesize an optimised lockdown and exit strategy which minimizes the number
of COVID-19-related casualties in the population, but also takes into account economic constraints. In order
to perform this task, we quantify the relation between the decrease in social contacts with the reduction in
the population mobility and optimise with respect to the latter, which is an effectively measurable quantity
compared to an abstract decrease in social contacts. A methodological summary is depicted in Figure 1,
illustrating the interaction among the different building blocks of our approach. It is important to note that
the proposed methodology transcends the design of lockdown strategies for the COVID-19 pandemic, and
can be applied for more general epidemiological models, different datasets, and a variety of control objectives.
What is fundamental in our approach is the existence of a dynamical model, the assimilation of data for the
optimal estimation of model parameters and uncertainties, and the optimization of an external input action
to control the system towards a desired state.

2

Epidemiological model using Google mobility

Our epidemiological model is developed in order to exploit data on change of mobility (in our case, provided
by Google) and information on the social contacts patterns at different types of locations, such as schools or
workplaces (eg. estimated by the BBC Pandemic project [20] for the UK and the POLYMOD study [25] for
152 countries in the world). In this manuscript, we will focus on explaining our model and the methodology
will be illustrated for both England and France; however, we stress that the methodology can be extended
to consider any other country, and, in fact, other epidemiological models, where suitable data is available. In
this Section, we first explain the fundamental dynamic properties considered in our model and then explain
how these two data sources are used in our compartmental model.
Model dynamics Assuming a well-mixed population (namely, each person has the same probability of
interacting with any other person in the population), we consider a compartmental model [8], splitting
the population in different compartments representing different states of the infection. Although this is
extremely simplifying, compartmental models under this assumption are widely used to describe the dynamics
of epidemics over large populations. Our model considers the following compartments:
• Susceptible (S), meaning people who did not have any contact with the infection,
• Exposed (E) to the infection, but not yet infectious,
• Infected SubClinical (I SC , split in I SC1 and I SC2 ), not needing medical attention,
• Infected Clinical (I C , split in I C1 and I C2 ), needing medical attention,
• Recovered (R), which we assume are resistant to a new infection,
• Deceased (D).
As strong evidence towards the age-dependent severity of COVID-19 has been observed in previous research
works [17, 13], we consider age-stratification of all of the states along 5 age groups: 0-19, 20-39, 40-59, 60-79,
80+, hence we will use the notation Ei to denote the Exposed population in the i-th age group, and similarly
for the other states. The model will assume that all the age groups are susceptible to the infection in the same
way, but that the severity is strongly dependent on the age of the patient through age-dependent probabilities
of necessity of hospitalization (ρi ) and death if hospitalized (ρ0i ) for the i-the age group.

3

Figure 1: Flow diagram of the data-driven approach for the synthesis of optimal lockdown
policies. The initial step consists of a policy maker defining a performance measure based on sanitary
and economic objectives, and a modeller selecting a consistent generic epidemiological model. Then, public healthcare/mobility data is used in conjunction with Approximate Bayesian Computation to calibrate
the dynamical model and determine the degree of uncertainty in the model parameters. This assists the
formulation of an optimal control problem where the original sanitary + economic performance measure is
optimized constrained to the calibrated epidemiological model. An optimal lockdown policy is then computed via global optimization techniques, and the final output is an optimal lockdown policy. The optimised
lockdown is then applied and its real-time effects can be sensed through public data, which fed back into the
learning+optimization framework for re-computation and update.

4

Another key assumption of our model is that when a patient is hospitalized and diagnosed, they are
isolated and therefore not able to spread the infection. To reflect this scenario, we assume that from the
exposed state and after some incubation period, all patients will become sub-clinical I SC , in which state they
are infectious. Afterwards, some of them will recover (R) and others will need clinical help (I C ); we model
this by splitting I SC into two categories: the ones recovering straightaway (I SC2 ) and the ones in need of
clinical care (I SC1 ). The split happens with an age-dependent probability ρi . After some time, people in
I SC1 will go to hospital, therefore moving to the I C state; similarly as before, the latter state is split in two
categories according to the final outcome: the ones in I C1 will decease (D) after some time, while the ones
in I SC2 will recover (R). This split is again described by an age-dependent probability, which we denote as
ρ0i . A visualization of the dynamics is given in Fig 2.
Figure 2: Graphical representation of the model, for each age group. The green color represents a
compartment that is observed independently for each age group, while blue represents a compartment whose
sum across age groups is observed.

IC
ISC
κρ
S

β

γCρ'

IC1

γC(1-ρ')

IC2

ν

D

ISC1

E

γR,C

κ(1-ρ)
ISC2

γR

R

Mathematically, this can be described using the following system of ODEs:
X
IjSC
dSi
= −βSi
Cij
dt
Nj
j

(1)

X
IjSC
dEi
= βSi
Cij
− κEi
dt
Nj
j

(2)

dIiSC1
dt
dIiSC2
dt
dIiC1
dt
dIiC2
dt
dRi
dt
dDi
dt

= ρi κEi − γC IiSC1

(3)

= (1 − ρi )κEi − γR IiSC2

(4)

= ρ0i γC IiSC1 − νIiC1

(5)

= (1 − ρ0i )γC IiSC1 − γR,C IiC2

(6)

= γR,C IiC2 + γR IiSC2

(7)

= νIiC1 ,

(8)

where IjSC = IjSC1 + IjSC2 and C is the contact matrix representing the frequency of contacts between
different age groups [20], where each element Cij represents the average daily number of contacts a person in
age group i has with people in age group j. To simulate from the model, the ODEs (Equations (1)-(8)) are
integrated using a 4th-order Runge Kutta integrator, with a timestep dt = 0.1 days; the dynamics is started
on the 1st of March.
5

2.1

Influence of mobility on the dynamics

The contact matrices are a crucial component defining our model dynamics, and were estimated in the
POLYMOD study [25] for a large set of countries (among which England and France). Specifically for the
contact matrices for England, the findings of the more recent BBC Pandemic project [20] were integrated
using the procedure described in [20]. Note that [20] provided contact matrices for the whole UK, but we
assume the ones for England are well represented by those. Finally, the age groups considered in these studies
(namely, 5 year bands) are finer than the ones we consider in the present work; we therefore aggregate the data
to make contact matrices suit our needs. The (i, j)−th entry of this contact matrices at different locations
(eg. home, workplace, school and other locations) represent the amount of daily contacts an individual in
age group i has with individuals from age group j in different settings (see Fig 3). Before the lockdown, the
total contact matrix is simply the sum of the contributions of these different locations:
C = C home + C work + C school + C other .
Figure 3: Contact matrices at different locations in the UK for the age groups used in the present
study (0-19, 20-39, 40-59, 60-79, 80+); these are obtained by aggregating and combining the contact matrices
for 5-year bands provided by [20] and [25].

However, the introduction of lockdown measures lead to considerable change to people’s social activity
and mobility; we model this by introducing a set of multipliers (for each age group and for each of the
locations) which will represent the change in the number of social contacts:
home
work
school
other
Ci,j = αihome Ci,j
+ αiwork Ci,j
+ αischool Ci,j
+ αiother Ci,j
,

(9)

where αi? , for ? ∈ {school, other, work}, represents the change of social contacts for age group i in category
?. These multipliers are a function of time and not easily accessible. Instead, it is rather easy to measure the
reduction of people’s mobility towards the different locations; we choose then to express the α’s as a function
of the mobility values provided by Google, as explained in the next paragraph.
Mobility data is collected by Google to reflect the reduction of the population mobility during lockdown for each country, by following the movements of Android phones; anonymised data is publicly available [3]. Similar datasets can be retrieved directly from other sources, such as mobile phone companies
[7]. This dataset captures mobility towards the following locations: “residential”, “workplaces”, “parks”,
“retail and recreations”, “transit stations” and “grocery and pharmacy”, which we denote respectively as
mresidential , mwork , mparks , mretail , mtransit , mgrocery ; the changes in mobility are reported with respect to
the baseline values prior to introduction of lockdown measures. As can be seen in the left panel of Fig 4, a
strong weekly periodicity is present in this data; we therefore use a Savitzky–Golay filter [29] to remove it.
We moreover combined the mobility values mparks , mretail , mtransit , mgrocery in order to obtain an aggregated value for the reduction of mobility towards “other locations”: mother = 0.1 · mparks + 0.3 · mretail +
6

0.3 · mtransit + 0.3 · mgrocery . Even though the numerical values of the weights are arbitrary, this choice is
motivated by our observation that the value of the different contributions of the mobility data is quite similar;
we also attribute a smaller value to “parks” as people get less in strict contact with each other there with
respect to “retail”, “transit” or “grocery” locations.
As no data with regards to schools were provided, we fixed the value of mschool to be 0.1 from the day
schools and universities were closed except for children of essential workers (23rd of March [38] for England,
16th March for France [37]). The mobility data obtained after the aggregation and smoothing operations
described above is presented in the right panel of Fig 4.
Figure 4: Raw and elaborated mobility data in the UK. In the raw mobility data, which is scaled
with respect to a baseline value representing average mobility in the months prior to the pandemics, a strong
weekly seasonality is present, which we mostly removed using a Savitzky–Golay filter. Moreover, we note that
the mobility towards “residential” (which is not used in our analysis) locations is larger during the lockdown
months than before, as people spend more time in their homes. Finally, note the very large increase in
people’s mobility towards parks around the end of the winter season. That contribution is however only one
of the components in our aggregated mother mobility value, so the latter does not increase that abruptly.

Raw mobility reduction
2.0
Mobility value

Aggregated and smoothed mobility reduction
1.0

Residential
Work
Parks
Retail & recreation
Transit stations
Grocery & pharmacy

1.5

0.8
0.6

1.0

0.4

0.5
0.0

School
Workplaces
Other

0.2
01-03

16-03

31-03

15-04
Date

30-04

15-05 29-05

01-03

16-03

31-03

15-04
Date

30-04

15-05 29-05

In order to connect the reduction in mobility to the reduction in the number of contacts, we proceed in
the following way: first we assume that the number of residential contacts stays constant; in fact, we expect
the behavior of people at home not to differ too much with respect to what it was prior to the introduction of
lockdown measures; for our model, this amounts to fixing αihome (t) = 1, ∀t, ∀i. With regards to the remaining
contributions to the total number of contacts, we expect data on mobility reduction to be representative of
the subset of the population which mostly uses smartphones, which is likely to be younger than 60 years
old. Moreover, a large part of the population older than 60 years old does not take part in work or school
activities. Motivated by these arguments, we define the values of αischool , αiother and αiwork separately for
population below and above 60. Specifically, we assume the following for age groups below 60 years old (age
group index 1,2,3):

school

(t) = α123 · mschool (t),
αi
for i ∈ {1, 2, 3}
(10)
αiother (t) = α123 · mother (t),

 work
αi
(t) = α123 · mwork (t),
where we made the dependence on time explicit in order to highlight that α123 ∈ [0, 1] is a time-independent
scalar, which is an additional parameter in our model; this amounts to assuming that the reduction in the
number of contacts is due to a combination of reduced mobility and increased awareness of people, for instance
by maintaining social distancing. For people above 60 years old (age group index 4 and 5) we assume instead
that the reduction in contacts stays constant since the introduction of lockdown measures and that such
reduction is equally distributed across the different categories (as the contacts for work and school will be
relatively few):
α4school (t) = α4other (t) = α4work (t) = α4 ,

α5school (t) = α5other (t) = α5work (t) = α5 ,
7

(11)

where α4 , α5 ∈ [0, 1] are time-independent scalars, which are parameters in our model as well. This latter
assumption is motivated by the fact that such part of the population is more susceptible to the disease, so
that the official advice will be for them to be as isolated as possible throughout the epidemics.
We initialise our implementation of the model dynamics on the 1st of March and we fix the contact matrix
to be the standard one relative to the country until the introduction of lockdown measures (which we assume
to be on the 18th March, i.e. two days after the UK government advised people to self-isolate [2] and one
day after the French government banned all except essential journeys [36]); from that day onward, we use
the contact matrix obtained from Eq. (9), by fixing αhome = 1 and obtaining the values for the other α’s by
Eqs. (10) and (11).

2.2

Intitialization and model parameters

At the beginning of the dynamics, most of the population is in the S state, except for a small number of
individuals which seed the infection. We therefore assume that some people were already infected on the 1st
of March and we denote that number as N in ; this number is split across the different categories and age
groups in the following way:
• First, the total number of infected population is spread across the age groups with the following rates
(from youngest to oldest): 0.1, 0.4, 0.35, 0.1, 0.05; these values come from the assumption that the
disease was brought to the country from abroad, and we took that as an estimate of the age distribution
of international travellers (for UK, a dataset describing age distribution of flight passengers is available
and approximately equal to the provided values [1]).
• Then the number of infected individuals in each age group is split in the E, I SC1 and I SC2 compartments
in the following way:
Eiin = Niin /3,

IiSC1,in = ρi Niin · 2/3,

IiSC2,in = (1 − ρi )Niin · 2/3.

(12)

The other compartments are initialized to 0, except for S, which is initialized to the total population in
the corresponding age group obtained by the most recent country-specific census, from which the number of
people seeding the infection at the start of the dynamics is subtracted.
Parameters

which define the dynamics of our model and need to be calibrated are the following:

• β: probability of a contact between an S and I SC individual resulting in the S individual catching the
infection.
• κ = 1/dL : transition rate of an Exposed individual becoming Infected SubClinical, with dL the average
number of days in the E state.
• γC = 1/dC transition rate of going from I SC1 to I C , with dC the average number of days it takes to
undergo this transition.
• γR = 1/dR recovery rate from I SC2 , with dR the average number of days it takes to recover.
• γR,C = 1/dR,C recovery rate from I C2 , with dR,C the average number of days it takes to recover.
• ν = 1/dD death rate from I C1 , with dD the average number of days before death occurs after entering
the I C1 state.
• ρi ’s: age dependent probabilities of going to I C instead of directly recovering from the I SC state.
• ρ0i ’s: age dependent probabilities of death after being hospitalized.
• N in : total number of individuals who carried the infection at the start of the training period (1st of
March).
• α4 : constant value of reduction in social contacts for people in age group 4, after the beginning of the
lockdown period.
8

• α5 : constant value of reduction in social contacts for people in age group 5, after the beginning of the
lockdown period.
• α123 : coefficient of proportionality between reduction of social contacts and reduction of mobility for
age groups 1,2,3.
These parameters will be estimated using Approximate Bayesian Computation (ABC), which provides a
posterior distribution for them - the details of the ABC methodology and associated results can be found in
Appendix A and Appendix B correspondingly. The results below are integrated over this posterior distribution, which allows us to design robust controls and quantify the underlying uncertainty in our results.

3

Optimised mobility values based on uncertainty

We now adopt the viewpoint of a policy maker whose task is to determine mobility restrictions on a population
in order to slow down the spread of the COVID-19 epidemics, while still keeping the economic costs of
lockdown as low as possible. We therefore formulate the problem in an optimal control setting. In this
context, we will minimise a cost functional which includes penalties on the number of COVID-19 related
deaths, hospital beds occupancy, and the economic cost of different types of lockdown.
The control variables in our problem are the reductions of the mobility values mschool , mwork , mother
(“Mobility data”). These are related to the coefficients in the contact matrices αschool , αwork , αother via the
inferred values α123 , α4 and α5 in (10) and (11), relating our control policy to measurable quantities. We
recall here that the mobility values m? , for ? ∈ {school, other, work} only control the change of contacts
for age groups 1,2,3 (below 60 years old), while the change of contacts for age groups 4 and 5 (above 60)
is instead represented by the parameters α4 , α5 , which we inferred from data. Our optimisation framework
therefore assumes that the reduction in social contacts for age groups 4 and 5 stays fixed to the inferred value
throughout the optimisation horizon, and we optimise only on the change of mobility referred to younger
age groups. This is reasonable as the older age groups constitute a minor part of the workforce and are the
extremely vulnerable to the disease. Therefore, we expect that the official advice for them will be to remain
with stricter isolation rules than the rest of the (working) population.
We will take advantage of the ABC inferential framework both to quantify the uncertainty of the parameters of our model and to develop a lockdown strategy that is robust to uncertainties. To this end, we proceed
as follows, where the details of each step will be given throughout this section.
1. Uncertainty quantification: Perform inference on the model parameters using data from the public
health authorities and Google mobility to obtain a posterior distribution of the parameter values given
the dataset.
2. Posterior loss based cost functional: Define a cost functional that takes into account the economic cost
of closing venues / reducing mobility to different locations and the sanitary cost of increased infection.
3. Nonlinear model predictive control: Optimize, over a fixed time frame, a lockdown strategy by minimizing the sanitary/economic cost functional, constrained to the inferred epidemiological dynamics. The
optimisation is based on the integrated posterior distribution: this involves solving the epidemiological
model forward using various sets of parameters values, sampled from the posterior distribution, and
computing the expectation of the cost functional with respect to this distribution. This optimization
step determines an optimal policy that is applied for a reduced amount of time, after which the model
is updated and the optimal policy recomputed.
A diagram synthesizing this data-driven optimal control approach is presented in Figure 5. The applicability
of this methodology goes beyond the design of control strategies for the COVID-19 pandemic, and can be
applied to different dynamics and cost functionals.
We remark again that even though this procedure is computationally costly, it pays off by offering a
control strategy that is robust to a number of possible (and highly likely) scenarios, by taking into account
the uncertainty on parameter estimates [6].

9

Figure 5: Flow diagram of the data-driven optimal control approach. Starting from a generic-type
SEIRD model, we learn optimal model parameters based on mobility/healthcare datasets and Approximate
Bayesian Computation. The output is a posterior distribution of model parameters, which is used to generate
calibrated SEIRD dynamics and a cost functional accounting both for sanitary and economic costs of a
lockdkown. These two ingredients determine the formulation of an optimal control problem, which is solved
by means of a global optimization algorithm. The final output of our approach is an optimal lockdown policy
which can be recalibrated as new data is fed into the system.

10

3.1

Uncertainty quantification

We use approximate Bayesian computation (ABC) [22] to calibrate the parameters of our model, by using
the datasets reporting on the number of hospitalized and deceased patients released by the public health
authorities:
• The daily number of deaths in hospitals attributed to COVID-19 (per age group)
• The daily number of hospitalized people with COVID-19 related diseases
We calibrate our model on data from the 1st of March up to different ending times tobs (eg. 31st of
August). ABC is suitable for the considered task as it relies only on simulations from the model, and works
by looking for values of parameters such that the integrated dynamics is close to the observed one. In this
way, it provides the user with samples from an approximate posterior distribution of the parameters given
observed data (πABC (θ|xobs )). The better the match between the simulation and the observation, the better
is the approximation of the true posterior π(θ|xobs ). However, this comes at higher computational cost,
so that the level of approximation needs to be balanced with computational considerations. We discuss
additional details regarding the use of ABC to calibrate our model in Section A.2 of Appendix A. Moreover,
ABC allows us to fix a prior uncertainty on the values of the parameters (defined by a prior distribution
π(θ)), and to quantify prediction uncertainty through the approximate posterior πABC (θ|xobs ), which we will
use in designing the optimal control task next.
We remark that the ABC algorithm which we employ (discussed in Section A.2 of Appendix A) provides
us with a set of samples from the posterior distribution associated with importance weights. We can obtain
independent and identically distributed (i.i.d.) samples from it by using bootstrap; namely, we choose (with
replacement) from the set of ABC samples with probability proportional to the importance weight itself. The
new set of samples generated in this way can be considered as i.i.d. from the posterior distribution of the
parameters given data.

3.2

Posterior loss based cost functional

In this step we identify the cost functional we will optimize to determine an optimal lockdown strategy. We
consider a cost functional which combines the economic cost of lockdown with the sanitary cost of lifting
restrictions. We focus on the representation of these terms and on the inclusion of the posterior distribution
of the model parameters in its modelling. Determining the relevance of sanitary versus economic costs is a
task left to the policy maker. However, when a quantitative choice has been made, our methodology allows
to test the effect of such a choice and to evaluate the stability of the optimal strategy.
We denote by t0 the start of the optimisation interval, corresponding to the day we wish to start the new
lockdown policy (in our first example, the 24th of May), and by Th the length of the interval in days, for
which we want to apply the lockdown strategy, also known as optimisation horizon. To study the cost of
lifting restrictions, we penalise the predicted number of deaths during the optimisation horizon [t0 , t0 + Th ].
This is given by
t0X
+Th X
X
(Di (t0 + Th ) − Di (t0 )) =
∆Di (t) ,
t=t0 +1

i

i

where ∆Di (t) is the daily increase in the number of deceased in the age group i. Furthermore,
we need to
P
guarantee that the number of infected individuals who need hospitalisation, I C = i IiC1 + IiC2 , remains
below the overall hospitals capacity Hmax . This could be included as a hard state constraint, here instead
we penalise the event in which I C surpasses the total capacity by including a term of the form
Φ(I C ) := max(I C − Hmax , 0) .
We point out that this term will not be activated if the levels of infected people who need hospitalisation
remain well below Hmax , which here we take to be Hmax = 10000. For example, the number of people in
hospital in England with COVID-19 related symptoms at the end of our first training window (23rd of May)
was 7106, while at the height of the peak of the epidemic in England (on the 12th of April) this number
was 17933. For France, numbers reach higher values; however, we keep the same value of Hmax = 10000,
11

in order to penalize a large number of infected people in the same way across the two countries, and to
have comparable values in the optimization strategy. As a final measure of the sanitary cost, we introduce a
final time cost, where we penalise the basic reproduction number (R) at the end of the optimisation horizon
R(t0 +Th ) (details about R number for our model can be found in Section A.1 of Appendix A). This terminal
penalty ensures that the control strategy does not simply output an optimal solution which switches off the
reduction on mobility towards the end of the optimisation horizon. While such a solution is consistent with
the optimal control design and is an interesting instance of the turnpike phenomenon [30], it is not suitable
in our context. Finally, to account for the economic cost of lockdown, we penalise the mobility reduction by
2
introducing a quadratic cost of the form k1 − m? (t)k , for ? ∈ {school, other, work}.
As mentioned before, the forward model is run for different sets of parameters drawn from the posterior
distribution obtained via ABC inference. For this reason, the ∆Di (t) and IiC (t) variables appearing in the
cost functional depend on the chosen value of the parameters of the model. We hide the explicit dependence
for notational convenience. The cost is computed by taking an expectation over the posterior distribution for
the parameters, since each parameter value will lead to a different realisation of the dynamics. Due to the
nonlinearity of the system, this is clearly not the same as minimizing the objective using the posterior mean
of the parameters only. In practice, we use 50 i.i.d. samples from the posterior distribution and approximate
the expectation with an average over the trajectories obtained with those parameter values. Minimizing an
expected cost in this way is much more computationally expensive than a cost computed on a point estimate
of the parameters (for instance the posterior mean). However, it provides a way to take into account the
uncertainty in the parameters while producing more robust results.
Collecting the different terms in our cost, we optimise
"
#
"
t0X
+Th
X
1
C
E
∆Di (t) + φ(I (t))
min J (m) : =
2
m(·)∈M
t=t0 +1
i
#
(13)
X
?
2
?
+
k1 − m (t)k + R(t0 + Th ),
2
?∈{s, o, w}

through the control signal
m(t) = (mschool (t), mwork (t), mother (t)) ∈ M := {m : [t0 , t0 + Th ] → [0, 1]3 } ,
where ? , for ? ∈ {school, other, work}, represents the relative cost of limiting the mobility to schools,
workplaces and other locations with respect to the sanitary cost, and where the expectation is taken over
the posterior distribution of the parameters of the model. The choice of the values for ? affects the optimal
policy by attributing a larger economic or social cost of closing one of the categories with respect to the
others. Determining adequate weights for these costs is the ultimate task of the policy maker.

3.3

Nonlinear Model Predictive Control

To close our optimal control formulation we add specifications to the controls we expect to obtain, restricting
the space of admissible signals. As the values of α are between 0 and 1, a reasonable assumption is to expect
the m? to be in the interval [0, 1] as well, for ? ∈ {school, work, others}. However, due to the fact that we
cannot impose a 100% closure of all settings, we set a lower bound for m? to be the lowest value of each m?
observed during the lockdown period. This results in the constraints mwork ∈ [0.31, 1], mschool ∈ [0.1, 1], and
mothers ∈ [0.41, 1].
As can be seen from equation (13), the controls m? are time-dependent, and they are computed by
minimising the cost functional (13) subject to the state constraints (1)-(8). Ideally, the numerical realization
of the optimal control strategy would be driven by the calculation of first-order optimality conditions and a
reduced gradient approach to minimise J (m). However, the nonlinearities in the dynamics and in the terminal
penalty, where the reproduction rate is expressed as an eigenvalue of a parameter-dependent matrix, make
our problem highly non-convex. Moreover, the penalty Φ(I C ) is non-differentiable. For the purposes of this
paper we will compute the optimal control by using generalized simulated annealing (or dual annealing) [33]
as implemented in the scipy [31] Python library. The use of meta-heuristics for the solution of large-scale
nonlinear optimal control problems has been assessed in [5, 9]. We embed the solution of the optimal control
12

problem (13) in a nonlinear model predictive control (NMPC) framework [16]. To this end, we select a
prediction horizon Topt , and optimise the control variables m? (t), t ∈ [t0 , t0 + Topt ] using the current state
at t0 as our initial condition. From the optimal control sequence we recover the optimal action for a single
day, that is m? (t), t ∈ [t0 , t0 + 1] and evolve the dynamics for the same amount of time, and repeat the
optimisation procedure in the updated time frame [t0 + 1, t0 + 1 + Topt ]. This process is then repeated until
the complete optimisation interval [t0 , t0 + Th ] is covered. The NMPC methodology recovers a robust optimal
control law in feedback form that can be adjusted to account for disturbances in the control loop. Therefore,
instead of using the current state predicted by the model as initial condition, we can update this to be the
current state of the population in England estimated from data, every time new data becomes available.
This ensures that the control methodology accounts for noisy observations, or for unexpected variations in
the data.

4

Results and Discussion

In this section, we apply our methodology to each of the datasets specified in the previous sections. In the
first half of the section, as a proof of concept, we show the importance of the various terms included in the cost
functional and their influence on the results, and this is done for the England dataset with parameter values
calibrated with data between the 1st of March and the 23rd of May, with lockdown strategies applied for 90
or 120 days starting on the 24th of May. In the second half, we apply our methodology to two populations:
England and France, with the models calibrated up to the 31st of August and lockdown strategies applied
from the 1st of September. The posterior distributions of the parameters are available in Appendix B. This
section is organised as follows:
1. Choice of an appropriate prediction horizon, Topt .
2. Influence of the relative weight of the economic and sanitary costs (i.e., how large to choose ? ).
3. Influence of the relative costs between reducing mobility to different locations (i.e., the relative weights
of school , work and other ).
4. Dynamic update of the control strategy as we recalibrate the model.
5. Application of our methodology to England and France.
Steps 1-3 can inform a policy maker on their decision of how to weight each term in the cost functional,
but we remark that this is ultimately their decision. In steps 4 and 5 we fix the parameters explored in 1-3
and test the methodology in specific cases.
Before presenting the optimal lockdown results, we exemplify our inference results for England with plots
of the variables that are relevant for the control methodology - for the complete inference results, we refer
the reader to Appendix B. In Fig. 6, we plot the predicted number of people in the I C category - the red line
is the median prediction and the shaded area denotes a confidence interval with 99% credibility - compared
to the true data in green in the left panel. The middle panel reports on the same results for the number of
deceased people, and the right panel reports the predicted basic reproduction number, R(t).

4.1

Proof of concept of the methodology

We now proceed to present the results of our methodology as described above on data for England observed
until 23rd May. Each of the figures below is either of two types: 1) Lockdown strategy and its effect on the
number of hospitalized individuals, and 2) Influence of the lockdown strategies on the reproduction number
R(t). In the first case, we plot the number of hospitalised people (full red line) for each control strategy
– these results are associated with the red axis, on the left of the figure – and the value of the optimized
mobility values m? in the three blue lines, associated with the blue values on the right axis. The full, dashed,
and dash-dotted lines correspond to work, school and other settings, respectively.

13

Figure 6: Comparison of predictions of our model with the real number of hospitalized people
with COVID-19 and total daily deaths (green) on 23rd May for England. The solid red line
denotes the median prediction, filled spaces denote the 99% credible interval and the vertical dashed line
denotes the observation horizon. The different columns represent number of people in hospital, I C (left),
daily deceased (middle) and value of R(t) (right).

IC

20000

(t)

Daily Deceased

17500

2.50

800

2.25

15000
600

12500
10000

2.00
1.75

400

7500
5000

1.50

200

1.25

2500
0

1.00

0
03-03

17-03

True data

31-03

14-04

Date

28-04

12-05

Median prediction

26-05

03-03

Tobs

17-03

31-03

True data

14-04

28-04

Date of death

12-05

Median prediction

26-05

03-03

17-03

Tobs

31-03

14-04

Date

Median prediction

28-04

12-05

26-05

Tobs

Dependence on Topt : A crucial issue in the NMPC framework is the selection of the prediction horizon
Topt . For small prediction horizons, the optimal action tends to be instantaneous and loses its capability
to foresee long-term consequences of the policy. On the other hand, a sufficiently long prediction horizon
will enforce a stabilizing control law, but its numerical realization becomes increasingly complex. Therefore,
at the core of the selection of a suitable prediction horizon there is a trade-off between short-sightedness,
stabilization capabilities of the policy, and computability. This is exemplified in Fig. 7, where we illustrate
the role that is played by the prediction horizon in the performance of the control loop for a fixed value of
? . It can be observed that a short-sighted policy, with a prediction horizon of 20 days (left panel), is less
stringent in the mobility reduction, causing a larger number of hospitalized people in the long term and a
large uncertainty in the end result.
Figure 7: Dependence on the prediction horizon Topt for determining and optimal control strategy for England.. Here, (s , w , o ) = (100, 100, 100) and the lockdown strategies were applied for Th = 90
days starting on the 24th of May.

10000

2000
01/06

01/07
Date

(a) Topt =20

01/08

8000

0.0

0

0.8

10000

0.4

4000
2000

12000

0.6

6000

0.2

1.0

Mobility

0.4

4000

work
school
other

01/06

01/07
Date

(b) Topt =30

01/08

work
school
other

8000

0.4

4000
2000

0.0

0

0.8
0.6

6000

0.2

1.0

Mobility

0.8
0.6

6000

0

12000

Hospitalized

8000

1.0

Mobility

Hospitalized

10000

work
school
other

Hospitalized

12000

0.2
01/06

01/07
Date

01/08

0.0

(c) Topt =40

However, it is clear that the lockdown strategies are similar for both prediction horizons of Topt = 30
(middle panel) and Topt = 40 (right panel): here, we observe a smaller overall number of hospitalized people
over time, while the uncertainty on the results remains bounded, with slightly smaller credibility intervals
in the second case. For this reason, we will from now on use the prediction horizon of Topt = 30, which is
long enough to avoid a short-sighted strategy, while being short enough to be computationally cheaper. We
point out that this is correctly aligned with the COVID-19 time scale for transmission, and a reasonable time
frame for a policy maker.
Influence of the relative weights of the control penalties (s , w , o ): The choice of suitable control
penalties ? , ? ∈ {school, work, other} is a sensitive issue in any optimal control problem, and we now
proceed to study its effect on the resulting lockdown strategies. In this context, there are two important
properties to explore: the relative weight between the sanitary and economic costs of our lockdown strategy,
14

which is represented by how large the values of each of s , w , o are, and the relative importance between
each of the s , w , o . We observe that the predicted number of daily deceased at the end of the training
interval is between 200 and 400 (see Fig. 6). Having in mind that the control variables are constrained to
[0, 1], we conclude that each ? should be in the order of 100, so that the control strategies are sensitive to
both the sanitary and economic costs.
In our next example, we assume that the economic cost of opening each type of location is the same (i.e.
s = w = o ) and analyse the effect of varying their relative weight to that of the sanitary cost. This is
shown in Fig. 8, where we present the lockdown strategies and corresponding values of hospitalized people for
? = 100 (left) and ? = 200 (right). We observe that higher values of ? result in the strategies which open
workplaces earlier, as keeping them closed is more expensive, but also result in higher uncertainty. Interestingly, however, we observe that both control strategies keep mother constant at a value of approximately
0.41, which is the minimum value allowed for this parameter. This behaviour is consistently reproduced for
any of the values ? that we explored as we will see below; the only situation in which we did not observe
this behaviour was by attributing an unreasonably high weight to the economic cost, in which case all the
lockdown measures are lifted, leading to a large increase of the number of infected people and to a second
wave of the epidemics. To better understand this phenomenon, we inspect the contact matrix relative to the
“other locations” category (Fig 3). There, it can be observed that the setting in which there are more contacts
between the part of the population in which our optimisation strategy acts, (under 60 year-olds),and the older
population is the “other locations”. As the latter are the most vulnerable to the disease, the optimisation is
limiting the number of contacts they have by reducing mother .
Figure 8: Different relative weights between the sanitary cost and economic cost of the lockdown
measures with the lockdown strategies starting on the 24th of May and applied for Th = 120 days, for
England.

work
school
other

8000

0.8

10000

0.6

6000

0.4

4000
2000
0

12000

Mobility
Hospitalized

Hospitalized

10000

1.0

01/06

01/07

01/08
Date

01/09

8000

0.0

0

0.8

0.4

4000
2000

1.0

0.6

6000

0.2

(a) (s , w , o ) = (100, 100, 100).

work
school
other

Mobility

12000

0.2
01/06

01/07

01/08
Date

01/09

0.0

(b) (s , w , o ) = (200, 200, 200).

The last property we investigate is the effect of varying the values of ? for each category, which can
produce a more economically viable solution. In the cases we will explore, we observe that opening workplaces
is clearly an important part of the economy, and this might not be achievable without opening schools as
well. For this reason, we will attribute the highest economic costs to closing workplaces, followed by schools
and then others. We point out that this is ultimately a choice of the policy maker, and in principle any
combination of values for each ? could be considered. We tested a variety of combinations of these cost
weights, each providing us with a lockdown strategy. In this case, we compare the efficiency of each strategy
in Figures 9 and 10. As can be seen in Fig. 9, all of the strategies propose to open workplaces and schools
earlier or later (or not at all, in the case of schools) depending on the relative weights between sanitary and
economic costs, and, as before, keep other locations at its minimum value. We show an additional comparison
in Fig. 10, where we plot the reproduction number R(t) resulting from each strategy, compared with what it
would be if the mobility values remained unchanged from their estimated values on the 29th of May. We note
that the optimal strategies always keep the value of R smaller than 1 for most of the optimization horizon,
but the confidence intervals allow for values larger than 1 at the end of the optimization window.
15

Figure 9: Different economic cost weights produce different opening strategies and predicted
hospitalized people, with lockdown strategies starting on the 24th of May and applied for Th = 120 days,
for England.

0

23/05

02/06

12/06

Date

22/06

02/07

11/07

2000

0.0

0

8000

1.0

12000

0.8

10000

0.6

6000

0.4

4000
2000
0

23/05

02/06

12/06

Date

22/06

02/07

11/07

23/05

02/06

12/06

Date

22/06

02/07

11/07

work
school
other

8000

0.2

2000

0.0

0

0.0

0

(d) (s , w , o ) = (10, 100, 1)

12/06

Date

22/06

02/07

11/07

0.4
0.2
23/05

02/06

12/06

Date

22/06

02/07

11/07

0.0

(c) (s , w , o ) = (150, 300, 3)
1.0

12000

0.8

10000

0.4

02/06

0.8
0.6

4000
2000

0.6

23/05

1.0

6000

0.2

6000
4000

work
school
other

8000

(b) (s , w , o ) = (100, 200, 2)

Mobility

Hospitalized

10000

0.4

4000

0.2

Hospitalized

work
school
other

0.6

6000

(a) (s , w , o ) = (50, 100, 1)
12000

0.8

10000

Mobility

2000

12000

Mobility

0.4

4000

8000

1.0

Mobility

0.6

6000

work
school
other

work
school
other

8000

1.0
0.8
0.6

Mobility

0.8

10000

Hospitalized

12000

Mobility

Hospitalized

8000

1.0

Hospitalized

work
school
other

10000

Hospitalized

12000

6000

0.4

4000

0.2

2000

0.0

0

0.2
23/05

(e) (s , w , o ) = (20, 200, 2)

02/06

12/06

Date

22/06

02/07

11/07

0.0

(f) (s , w , o ) = (30, 300, 3)

Figure 10: Evolution of R(t) corresponding to different opening strategies starting on the 24th
of May, learned using different economic cost weights for different  values, with 99% credibility intervals;
these plots are referred to England.

(t)

1.00
0.95
0.90
0.85

1.10

23/05 02/06

1.00

0.95
0.90
02/07 11/07

23/05 02/06

(b) (s , w , o ) = (100, 200, 2)

1.00

1.00

0.95

0.95

0.90

0.90

0.90

23/05 02/06

12/06 22/06
Date

02/07 11/07

(d) (s , w , o ) = (10, 100, 1)

0.85

23/05 02/06

12/06 22/06
Date

02/07 11/07

(e) (s , w , o ) = (20, 200, 2)

02/07 11/07

Measured mobility
= [30, 300, 3]

1.05

0.95

0.85

12/06 22/06
Date

(c) (s , w , o ) = (150, 300, 3)

1.10

Measured mobility
= [20, 200, 2]

1.05
(t)

1.00

12/06 22/06
Date

1.10

Measured mobility
= [10, 100, 1]

1.00

0.90
23/05 02/06

Measured mobility
= [150, 300, 3]

1.05

0.95

02/07 11/07

(a) (s , w , o ) = (50, 100, 1)

1.05
(t)

12/06 22/06
Date

Measured mobility
= [100, 200, 2]

1.05

(t)

1.05
(t)

1.10

Measured mobility
= [50, 100, 1]

(t)

1.10

0.85

23/05 02/06

12/06 22/06
Date

02/07 11/07

(f) (s , w , o ) = (30, 300, 3)

Dynamic update of the model and optimal control strategy As new data becomes available, we can
re-perform the model fit, and obtain a new posterior distribution on the parameters to use in order to find
the optimal mobility values. An instance of this dynamic update can be seen in Fig 11, where we show the
optimal mobility values and the corresponding basic reproduction number after the model parameters and
16

the optimal solution are updated at four instances: the 11th of April, 26th of April, 11th of May and 23rd
of May. Here we used (s , w , o ) = (150, 300, 3) as from the results in Figs 9 and 10 it can be seen that such
a choice leads to a lockdown strategy that increases the mobility towards both workplaces and schools while
keeping the value of R(t) < 1.
Figure 11: Dynamically updated control strategy: we fit the model on data for England up to tobs =
11th of April and determine the optimal mobility strategy up to the next observation point tobs = 26th
April. Data until the latter is used to repeat the procedure, in order to update the optimal control strategy
exploiting newly available information. Here (s , w , o ) = (150, 300, 3). In panel (a), we show the resulting
optimal mobility values, with the corresponding values of R(t) and their credibility intervals shown in panel
(b).
1.0

work11th Apr
school11th Apr
other11th Apr

work11th May
school11th May
other11th May

work23rd May
school23rd May
other23rd May

11th May

23rd May

1.4

11/04

20/04

30/04

11/05

20/05
Date

23rd May

11th May

23rd May

11th May

26th Apr

1.1

26th Apr

1.2

11th Apr

(t)
0.0

26th Apr

1.3

0.4
0.2

11th Apr

1.5

0.6

11th Apr

Mobility

0.8

work26th Apr
school26th Apr
other26th Apr

1.0
0.9
30/05

10/06

20/06

(a) Dynamically updated control strategy.

30/06

11/04

20/04

30/04

11/05

20/05
Date

30/05

10/06

20/06

30/06

(b) R(t) corresponding to the updated control strategies.

We observe that the lockdown strategy determined with parameter values fitted on data up to the 11th
of April is extremely restrictive, as the predicted dynamics on that date badly overestimates the number of
deceased and hospitalized people (see Appendix B). However, we see that recalibrating the parameters and
updating the lockdown strategy using newly available data is beneficial: using data until the 26th of April
results in a better prediction of hospitalized and deceased numbers, and we see an increase of the mobility
towards schools already at the end of April. We repeat the procedure on the 11th and 23rd of May, resulting
on a proposed strategy allowing schools to be open even further at the first instance, and then remaining
almost unchanged, with an increased mobility towards workplaces around mid-June. We also note that,
with the exception of the time interval between the 11th and the 26th of April - where the high value of
R(t) is due to the fact that for the current values of the parameters the epidemic is predicted to increase
rapidly, independently of the lockdown measures - the predicted R(t) value always stays below 1. This
dynamic update of the model allows us to rely less on long-term predictions from the model, which are more
computationally expensive and become more biased the farther in the future the prediction is. Together with
the knowledge on model-specific biases coming from fitting the model to different horizons in the past, this
approach enables a policy maker to assess the validity of the proposed optimal mobility strategy and update
it on a periodic basis as new data becomes available.

4.2

Optimal strategy for England and France on 1st of September

After exploring all the different properties of our optimal control strategy, we proceed to test it in two
populations, England and France, in a more recent setting, which is closer to a second wave of the epidemics.
We fit the model again with data from the PHE and the NHS for England, and from SpF for France, and
using the Google mobility data in both cases. The inference was performed on both cases for data up to the
31st of August and the results are presented in Fig 12 below.
Optimal lockdown strategy for England starting in September 2020: We apply our optimal control
strategy again for the population of England, for a more recent time interval. As mentioned above, the
parameters were fitted up to the 31st of August, and we apply a lockdown strategy for Th = 120 days,
starting on the 1st of September. The prediction horizon was kept at Topt = 30 days and we used two

17

Figure 12: Comparison of predictions of our model with the real number of hospitalized people
with COVID-19 and total daily deaths (green) on 31st August in England and France. The
solid red line denotes the median prediction, filled spaces denote the 99% credible interval and the vertical
dashed line denotes the observation horizon. The different rows represent different observation horizons,
while the columns represent number of people in hospital (I C compartment, left column), daily deceased
(middle column) and value of R(t) (right column).

IC

Daily Deceased

17500
15000
12500

(t)

1.15

800

1.10

600

1.05
1.00

10000
400

7500
5000

0.95
0.90

200

2500

0.85
0

0

01-04

01-05

True data

01-06

01-07

Date

01-08

Median prediction

01-09

01-04

Tobs

01-05

True data

01-06

01-07

01-08

Date of death

Median prediction

01-09

0.80

01-04

01-05

Tobs

01-06

(a) England

IC

Daily Deceased

01-08

01-09

Tobs

(t)

1.050
1.025

800

60000

01-07

Date

Median prediction

1.000

50000

600

0.975

40000

0.950

400

30000
20000

200

10000

0
01-04

01-05

True data

01-06

01-07

Date

01-08

Median prediction

01-09

0.925
0.900
0.875
0.850
01-04

Tobs

01-05

True data

01-06

01-07

Date of death

01-08

Median prediction

01-09

01-04

01-05

Tobs

01-06

01-07

Date

Median prediction

01-08

01-09

Tobs

(b) France

possible sets of values for ? . The corresponding results are shown in Fig 13, where the first two panels
show the number of hospitalized people and corresponding credibility intervals (full red line and dashed area)
and the mobility values (blue lines), while the corresponding values of R(t) (and credibility intervals) are
presented in the right panel.

1.0

12000

1.0

1.15

10000

0.8

10000

0.8

1.10

0.6

1.05

Mobility

0.6

6000

0.4

4000
work
school
other

2000
0

01/09

01/10

01/11
Date

01/12

(a) (s , w , o ) = (150, 300, 3)

8000

Mobility

8000

6000
4000

0.2

2000

0.0

0

work
school
other
01/09

01/10

01/11
Date

01/12

(b) (s , w , o ) = (150, 150, 150)

(t)

12000

Hospitalized

Hospitalized

Figure 13: Optimal strategy for England with parameters fitted with data up to the 31st August. The
lockdown strategy is applied for 120 days starting on the 1st of September and uses a prediction horizon of
Topt =30 days

0.4

1.00

0.2

0.95

0.0

= [150, 300, 3]
= [150, 150, 150]

31/08 09/09

19/09 29/09
Date

09/10

19/10

(c) Comparison of evolving Rt

Optimal lockdown strategy for France starting in September 2020: Our methodology is valid in
general, and in particular it can be applied to different datasets. Our last example applies the strategy to the
French population, where the epidemics has exhibited a different evolution than in the UK. As in the previous
paragraph, we fitted the parameters with data up to the 31st of August, and apply the lockdown strategy for
18

Th = 120 days, starting on the 1st of September. The prediction horizon was kept at Topt = 30 days and we
used two possible sets of values for ? . The corresponding results are shown in Fig 14, and are organised in a
similar manner to Fig 13. We observe that in this case the relative values of ? have a much stronger influence,
with the lockdown strategy shown in the left panel having extremely better results than that on the middle
panel. This is visible both on the number of hospitalized people and the resulting reproduction number, and
illustrates the importance of the choice of these parameters and associated discussion with policy makers.
We reiterate that our methodology for both England and France recommends to keep mobility of “others”
as low as possible if not at the lowest possible label of full lockdown. Remembering that the others category
refers to “retail”, “transit” or “grocery” locations, our methodology is recommending that the we should keep
a stringent lockdown until December, while opening up the work and school places in a socially-distanced
manner. Deviations from that will likely result in a second-wave of infection spreading.
Figure 14: Optimal strategy for France with parameters fitted with data up to the 31st August. The
lockdown strategy is applied for 120 days starting on the 1st of September and uses a prediction horizon of
Topt =30 days

10000

0.8

0.4

4000
2000
01/09

01/10

01/11
Date

01/12

(a) (s , w , o ) = (150, 300, 3)

5

0.8
0.6

6000

0

1.0

8000

0.6

6000

0.4

4000

0.2

2000

0.0

0

work
school
other
01/09

0.2
01/10

01/11
Date

01/12

(b) (s , w , o ) = (150, 150, 150)

0.0

1.06

= [150, 300, 3]
= [150, 150, 150]

1.04
1.02
(t)

8000

12000

Mobility

Hospitalized

10000

1.0

Mobility

work
school
other

Hospitalized

12000

1.00
0.98
0.96
0.94

31/08 09/09

19/09 29/09
Date

09/10

19/10

(c) Comparison of evolving Rt

Concluding Remarks and Future Work

We have proposed a general estimation/control methodology for the determination of optimal lockdown
strategies in the context of the COVID-19 pandemic. Our approach is composed of the following elements:
system dynamics described through an age-structured SEIRD model, the use of public data such as Google
Mobility for estimating model parameters, and the design of adaptive lockdown strategies in the framework
of nonlinear optimal control. The current work focused on a study of the COVID-19 pandemic in England
and France, however the underlying methodology can be extended to other spatio-temporal locations. It can
be applied to epidemiological models in general, assuming the availability of healthcare and mobility data
for a suitable calibration of the dynamics. Our systematic approach provides a computational tool to assist
the design of lockdown strategies which can be periodically rectified as the model is fed with incoming public
data. Moreover, the proposed strategies are parsimonious in the sense that they encode both healthcare and
socio-economic factors, and realistic as they are expressed as mobility reduction parameters which can be
effectively measured, as opposed to switching on-off strategies.
Arguably, our model does not capture the increase in the testing capacity. It is reasonable to assume that
a larger proportion of people in the subclinical compartment get tested; ideally, these people will adhere to
stringent social isolation regimes with the expectation to slow down the spread of the disease. However, how
the latter affects the evolution of the epidemics when reduced mobility measures for all citizens are already
in place remains unclear. As we continue to work on our approach, a natural way to improve the accuracy
of our model is through a further downscaling of our dynamics, for instance by considering 418 principal
local authorities (LA) in the UK, along with a commuting network of UK citizens between them constructed
from the 2011 census data. Such a refined model, whose numerical treatment will necessarily require the
use of high-performance computing resources, would allow the design of space-time adaptive lockdowns. Our
progress along these lines will be documented on the companion website [4].

19

A
A.1

Appendix: Additional mathematical details
Computation of R(t)

We explain here how to compute the reproduction rate (R) for our model, which is considered as one of the
main measures to quantify the spread of an epidemic and the efficiency of our lockdown strategies proposed
in the Results and Discussion Section in the main body of the paper, and measures the average number of
secondary infections an infected individual is capable of generating in a fully susceptible population. Our
computation strategy follows [15]; first, we define the next generation matrix, which relates the numbers of
newly infected individuals in the various categories in consecutive moments, before and after a contact (in
our case, a time step) in the case where one single person interacts with a fully susceptible population. To
do this,
o the Jacobian matrix of the infection subsystem – which is composed by
n fix Si = Ni and consider
C2
C1
SC2
SC1
states Ei , Ii , Ii , Ii , Ii , i = 1, . . . , 5 (we note that the states Ri and Di were removed, as they are
“final” states: once an individual is in one of these states, they remain there). Using the same notation as in
[15], this Jacobian has the following form



J0 = 



−κI
ρκI
(1 − ρ)κI
0
0

β SC
N
−γC I
0
0
ρ γC I
0
(1 − ρ )γC I

β SC
N
0
−γR I
0
0

0
0
0
−νI
0

0
0
0
0




,



−γR,C I

where we note that I is the 5 × 5 identity matrix, and each zero corresponds to a 5 × 5 zero matrix. We also
slightly abused the notation in the other entries. For example, the matrices SC
N , ρκI, etc., are 5 × 5 matrices
whose entries are given by


Si Cij
SC
=
,
(ρκI)ij = κρi δij ,
N ij
Nj
where δij is the Kronecker delta, and similarly for the other matrices.
The matrix J0 is decomposed into the transmission matrix, T , and the transition matrix, Σ, defined as
follows:




−κI
0
0
0
0
0 β SC
β SC
0 0
N
N


 0
ρκI
−γC I
0
0
0
0
0
0 0 





 = J0 − T.


(1
−
ρ)κI
0
−γ
I
0
0
Σ=
T = 0
0
0
0 0 ,
R

0



 0
0
ρ
γ
I
0
−νI
0
0
0
0 0
C
0
0
0
0
0 0
0
(1 − ρ )γC
0
0
−γR,C I
The next generation matrix is then defined as KL = −T Σ−1 . The reproduction number R is the spectral
radius of this matrix, namely the absolute value of its largest eigenvalue, which represents the secondary
number of infections a single infected individual is capable of generating in a fully susceptible population.
As T depends on the contact matrix C, the reproduction number will be a function of the Google mobility
for different locations (mschool (t), mwork (t) and mother (t)). Hence, we will focus on studying the evolution
of R(t) over time.

A.2

Details on Approximate Bayesian Computation

Approximate Bayesian computation (ABC) gives an approximation of the posterior distribution of the parameters, starting from a prior π(θ) and a (possible stochastic) simulator model M (θ), for which the likelihood
p(x|θ) cannot be computed. Specifically, the true posterior is obtained via Bayes’ theorem as
π(θ|xobs ) =

π(θ)p(xobs |θ)
.
p(xobs )

In ABC, we approximate this expression by looking for the values of the parameters which best approximate
the observations. The fundamental ABC rejection sampling scheme iterates the following steps:
20

• Draw θ from the prior π(θ).
• Simulate a synthetic dataset xsim from the simulator-based model M (θ).
• Accept the parameter value θ if d(xsim , xobs ) < γ. Otherwise, reject θ.
Here, the metric on the dataspace d(xsim , xobs ) measures the closeness between xsim and xobs . The
accepted values of θ are thus sampled from a distribution πABC (θ|xobs ) ∝ π(θ)pd,γ (xobs |θ), where pd,γ (xobs |θ)
is an approximation to the intractable likelihood function p(xobs |θ):
Z
pd,γ (xobs |θ) = p(xsim |θ)Kγ (d(xsim , xobs ))dxsim .
Here, Kγ (d(xsim , xobs )) is a probability density function proportional to 1{d(xsim , xobs ) ≤ γ}, 1{·} being
an indicator function which equals 1 when the condition in the brackets is true and 0 otherwise.
This guarantees that, in principle, the above approximate likelihood converges to the true one when γ → 0.
In this paper, we used the PMCABC algorithm [10] as implemented in the Python library ABCpy [14] allowing
efficient parallelization using MPI, to perform parameter inference. This is an iterative algorithm considering
a set of points {θi } which are given a certain weight representing how much the sample xi generated by
each of them is close to the observation. The algorithm proceeds by iteratively perturbing the parameters
and performing simulations from the model, and reducing the threshold γ so that the approximation to the
posterior distribution improves. At the end of the algorithm, a weighted set of parameter points which are
samples from the approximate posterior πABC (θ|xobs ) is returned.
For the sake of calibrating the model, we want to match the number of people in I C (summed over
all age groups) and the daily deaths, by date of reporting, for each of the 5 considered age groups; the
model is structured so that it returns those values as outputs. Therefore, we consider the set of variables
C
(t))Tt=18 ) where we denote by t the day since the
x = ((∆D1 (t), ∆D2 (t), ∆D3 (t), ∆D4 (t), ∆D5 (t))Tt=1 , (Itot
start of the dynamics, by ∆Di (t) = Di (t) − Di (t − 1) the deaths occurring on day t in age group i, and we
P5
C
(t) = i=1 IiC . The corresponding observation is denoted as:
consider Itot
C,obs
xobs = ((∆D1obs (t), ∆D2obs (t), ∆D3obs (t), ∆D4obs (t), ∆D5obs (t))Tt=1 , (Itot
(t))Tt=18 ).

As discussed in the Model Calibration Section in the main body of the paper, data on I C is available only
from the 18th of March, and therefore we discarded the first 17 days for the corresponding observations.
We now define a distance for ABC that enables us to make use of the above data, by relying on a weighted
sum of the pointwise Euclidean distances between the different elements of the trajectories. Specifically, let
us denote the pointwise Euclidean distances between the different elements of simulated and observed data
by:
T
T
X
X
C,obs
C
dD,i =
(∆Di (t) − ∆Diobs (t))2 , dI =
(Itot
(t) − Itot
(t))2 .
t=1

t=18

Using this, the final distance we consider is:
d(x, xobs ) =

5
X

dD,i wD,i + wI dI ,

i=1

where wD,i and wI are weights which we can fix according to considerations on the speed of convergence. It
is clear that the above, being a combination of Euclidean distances, is a valid distance for x for each choice of
the weight; the latter however are important for the ABC algorithm in practice, as they force the algorithm
to constrain more or less on some of the distances. The weights we have found to work best for the problem
at hand (as they gave faster convergence) are: wD = (1, 1, 1, 2, 2) and wI = 0.1.

21

B
B.1
B.1.1

Appendix: Additional experimental results
Proof of concept: England data until 23rd May
Inferred parameters

We calibrate our model on data up to four different days representing different stages of the epidemic (11th
of April on the peak of the epidemic and further towards the tail, up to the 23rd of May, as shown in Fig 15).
The amount of available data over those four days affects how well our model was able to fit the data and

11th May

17500

800
600

Daily deceased

12500
10000

400

5000
2500
0

03-03

17-03

31-03

26th April

7500
11th April

Hospitalized people

15000

23rd May

Figure 15: Evolution of the epidemics in England, together with ending dates of the observation
period tobs used in this study. The red line represents the number of hospitalized people (scale on y axis
on the left), while the blue line represents the daily number of deaths (scale on the right).

14-04
Date

28-04

200
0
12-05

26-05

predict the future. We report the posterior mean and the corresponding standard deviation for each model
parameter and for each observation horizon tobs in Table. 1. We notice that the estimated values differ slightly
over the days, but they are quite similar on 11th and 23rd of May as in those days we do not observe any
significant changes in the dynamics of the epidemics.
As point estimates are not able to capture the correlations present between parameters, we report the
inferred joint posterior distributions using data until 23rd May between pairs of parameters in Figures 16,
17 and 18. The posterior distribution is obtained by Kernel Density Estimate (KDE) on the set of posterior
samples.

22

dL

dC

dR

dRC

dD

N in

10

dL

0
3

0.1

Post. mean = 0.13

3

2

2

1
4

dC

0.2

1
4

Post. mean = 1.57

2

2

3

3

2

2

1
12.5
10.0
7.5
10

dD

dRC

dR

Post. mean = 2.12

1
12.5
10.0
7.5
10

Post. mean = 1.54

Post. mean = 12.08

5

5

N in

Post. mean = 5.54

400

0.002

200

0.001
0.1

0.2 1

2

dL

3

2

dC

4 1

2

dR

3 7.5 10.012.5

dRC

5

dD

10

Post. mean = 276.22

0.000
250 500

N in

Figure 16: Single and bivariate marginals (represented using contour plots) for the parameters
describing the transition between states for England, obtained using data until 23rd May; note
for instance the negative correlation between β and dR ; this is expected from the dynamics of the model (the
longer a person stay in the infectious state, the more people can infect; therefore, a similar dynamics can be
obtained by a lower value of β).

23

Table 1: Estimated posterior mean and standard deviation of model parameters for England,
using the different horizons for fitting the model. We note the large standard deviation for the ρ and ρ0
parameters related to younger age groups, with respect to the older age groups. This is due to the fact that
less information is available with regards to the severity of infection for those age groups, thus rendering
the estimate harder. This also proves the ability of our technique to assign meaningful uncertainty ranges.
We also point out that the estimated standard deviation is larger than the posterior mean for some of the
parameters; this is due to the fact that the posterior distribution is not centered on the posterior mean but
skewed.

0

1

1

2

3
1e 1

0

1

2

2
1e 1

0

2

3

4
1e 1

1e 1

5

6
5
4
3
2
1

dR,C
9.94 ± 2.67
11.42 ± 1.83
11.95 ± 1.60
12.08 ± 1.51
12.65 ± 1.25
α5
0.68 ± 0.23
0.74 ± 0.19
0.75 ± 0.20
0.71 ± 0.23
0.74 ± 0.19
ρ4
0.52 ± 0.25
0.51 ± 0.21
0.59 ± 0.23
0.54 ± 0.22
0.53 ± 0.21
ρ04
0.42 ± 0.22
0.35 ± 0.16
0.29 ± 0.14
0.26 ± 0.11
0.35 ± 0.18

0

3
0

8
6
4
2
0

1.0
0.8
0.6
0.4
0.2
0.0

dR
2.90 ± 1.92
1.67 ± 0.50
1.81 ± 0.68
1.54 ± 0.40
1.74 ± 0.49
α4
0.39 ± 0.26
0.50 ± 0.25
0.54 ± 0.27
0.57 ± 0.23
0.43 ± 0.28
ρ3
0.16 ± 0.16
0.10 ± 0.08
0.09 ± 0.08
0.08 ± 0.08
0.12 ± 0.14
ρ03
0.26 ± 0.26
0.33 ± 0.26
0.31 ± 0.24
0.33 ± 0.27
0.33 ± 0.27

4

dC
4.12 ± 2.16
2.46 ± 1.12
2.24 ± 0.87
2.12 ± 0.80
2.84 ± 1.08
α123
0.48 ± 0.15
0.64 ± 0.18
0.59 ± 0.19
0.63 ± 0.21
0.36 ± 0.06
ρ2
0.11 ± 0.12
0.10 ± 0.12
0.04 ± 0.04
0.05 ± 0.05
0.05 ± 0.05
ρ02
0.21 ± 0.23
0.22 ± 0.23
0.35 ± 0.32
0.28 ± 0.25
0.30 ± 0.27

0

dL
3.09 ± 1.78
1.61 ± 0.51
1.50 ± 0.43
1.57 ± 0.42
1.81 ± 0.50
β
0.13 ± 0.06
0.13 ± 0.03
0.12 ± 0.03
0.13 ± 0.03
0.13 ± 0.03
ρ1
0.08 ± 0.07
0.08 ± 0.07
0.07 ± 0.07
0.06 ± 0.06
0.07 ± 0.07
ρ01
0.28 ± 0.26
0.28 ± 0.23
0.29 ± 0.26
0.26 ± 0.23
0.33 ± 0.27

1e 1

2

1.0
0.8
0.6
0.4
0.2
0.0

0

0

1

Observation period
1st March-11th Apr
1st March-26th Apr
1st March-11th May
1st March-23rd May
1st March-31st Aug
Observation period
1st March-11th Apr
1st March-26th Apr
1st March-11th May
1st March-23rd May
1st March-31st Aug
Observation period
1st March-11th Apr
1st March-26th Apr
1st March-11th May
1st March-23rd May
1st March-31st Aug
Observation period
1st March-11th Apr
1st March-26th Apr
1st March-11th May
1st March-23rd May
1st March-31st Aug

0.25 0.50 0.75 1.00
4

dD
4.98 ± 2.35
5.19 ± 2.33
5.83 ± 2.14
5.54 ± 2.19
7.44 ± 1.80
N in
303 ± 132
249 ± 140
264 ± 131
276 ± 133
340 ± 111
ρ5
0.81 ± 0.14
0.82 ± 0.13
0.83 ± 0.13
0.79 ± 0.14
0.81 ± 0.14
ρ05
0.82 ± 0.12
0.80 ± 0.13
0.78 ± 0.14
0.80 ± 0.13
0.81 ± 0.14

1.0
0.9
0.8
0.7
0.6
0.5

0.6

0.8

5

1.0

Figure 17: Contour plots representing bivariate posterior plots for ρi and ρ0i , for all age groups
(i = 1, . . . , 5) for England, obtained using data until 23rd May. For all of them, some negative
correlation is present; this is very evident in the case of age group 4.

24

1.50
1.25
1.00
0.75
0.50
0.25
0.00
1.0

4

123

123

4

1.0
0.8
0.6
0.4

Post. mean = 0.63

1.0

0.8

0.8

0.6

0.6

0.4

0.4

0.2

5

5

0.2

Post. mean = 0.57

1.0

2.0

0.8

1.5

0.6

1.0

0.4

0.5

Post. mean = 0.71

0.2
0.4

0.6

123

0.8

1.0

0.5

4

1.0

0.0
0.25 0.50 0.75 1.00
5

Figure 18: Single and bivariate marginals (represented using contour plots) for the parameters
connecting the reduction in mobility to the change of social contacts for England, obtained
using data until 23rd May.
B.1.2

Evolution of the epidemics predicted by our model

As devising a successful lockdown strategy depends on the accuracy of the prediction of our model, we compare
the predicted number (median prediction and 99 percentile credibility interval) of hospitalized people and
daily deaths of our calibrated model with real data on the four observation horizons considered here. To do
this, we integrate the dynamical model using i.i.d. posterior samples from the ABC posterior distribution
on each of these days and we show our results in Fig 19. In this way we are able to highlight how providing
additional information to the model changes its predictions for the future.
Additionally, we provide the estimated basic reproduction number R (Section 2 of Supporting Information
S1) from the dynamics obtained from the posterior sample points, and plot that with the relative credibility
bands. We note that, with the exception of the model calibrated on data until the 11th of April, the
estimated reproduction number has a value larger than 2 before the introduction of containment measures
by the government, which then decreases below 1 a few days afterwards, and remaining below one until
the end of the training period. We also note that towards the end of the training period, the credibility
interval includes some values above 1, due to the fact that the values of people’s mobility have increased in
later weeks. Finally, plots comparing the daily number of deaths with real data stratified by age groups are
reported in Sections B.1.3.
The results presented in Fig 19 highlight that it is hard to forecast precisely the evolution of the epidemic
with a simple compartmental model as the one we consider. This can be seen from the fact that using
different observation horizons to determine the parameters of the model leads to very different predictions of
the evolution; this phenomenon is extremely evident in the first line of Fig 19 (i.e. using data until the 11th
of April), where the predicted number of deaths and hospitalized people is much larger than what eventually
turned out to be the case (we remark that the prediction is taking into account the measured mobility even
throughout the prediction horizon). We also remark that our model systematically overestimates the number
of deceased in the tail of the epidemics; this could probably be explained by the fact that it does not take
into account the increased capacity of the health system to fight the disease.

25

Figure 19: Comparison of predictions of our model with the real number of hospitalized people
with COVID-19 and total daily deaths (green), for England. The solid red line denotes the median
prediction, filled spaces denote the 99% credible interval and the vertical dashed line denotes the observation
horizon. The different rows represent different observation horizons, while the columns represent number of
people in hospital (I C compartment, left column), daily deceased (middle column) and value of R(t) (right
column).

IC

(t)

Daily Deceased

500000

25000

400000

20000

300000

15000

200000

10000

100000

5000

0

5
4
3
2

0
03-03

17-03

31-03

True data

14-04

Date

28-04

12-05

Median prediction

26-05

1
03-03

Tobs

31-03

True data

14-04

28-04

Date of death

12-05

Median prediction

26-05

03-03

Tobs

2.75

1000

2.50

15000

600

1.75

10000

400

1.50

5000

200

1.25

0

0

True data

14-04

Date

28-04

12-05

Median prediction

26-05

12-05

26-05

Tobs

1.00
03-03

17-03

31-03

True data

14-04

28-04

Date of death

12-05

Median prediction

26-05

03-03

Tobs

17-03

31-03

14-04

Date

28-04

12-05

26-05

Tobs

Median prediction

(b) 26th of April

IC

(t)

Daily Deceased

2.50

800

15000

28-04

2.00

Tobs

17500

Date

2.25

800

31-03

14-04

(t)

1200

20000

17-03

31-03

Median prediction

Daily Deceased

25000

03-03

17-03

(a) 11th of April

IC

30000

17-03

2.25
600

12500
10000

2.00
1.75

400

7500
5000

1.50

200

2500
0

1.25
1.00

0
03-03

17-03

31-03

True data

14-04

Date

28-04

12-05

Median prediction

26-05

03-03

Tobs

31-03

True data

14-04

28-04

Date of death

12-05

Median prediction

26-05

03-03

Tobs

17-03

31-03

Date

28-04

12-05

26-05

Tobs

(t)

Daily Deceased

17500

14-04

Median prediction

(c) 11th of May

IC

20000

17-03

2.50

800

2.25

15000
600

12500
10000

2.00
1.75

400

7500
5000

1.50

200

1.25

2500
0

1.00

0
03-03

17-03

True data

31-03

14-04

Date

28-04

12-05

Median prediction

26-05

Tobs

03-03

17-03

True data

31-03

14-04

28-04

Date of death

12-05

Median prediction

(d) 23rd of May

26

26-05

Tobs

03-03

17-03

31-03

14-04

Date

Median prediction

28-04

12-05

26-05

Tobs

B.1.3

Deaths for each age group

In Figure 20 we report the median and 99 percentile credibility interval of the daily deceased in each of the
5 age groups, and we compare it to the actual data (green). Note that the credibility interval is larger for
age groups 1 and 2; this is expected, as the number of deaths in that age groups is relatively small, so that
achieving a good fit is harder. Moreover, we also report the cumulative deaths over the different age groups
in Figure 21.
See https://github.com/OptimalLockdown/MobilitySEIRD-England for additional plots with regards to
the unobserved compartments.

Age group 1 daily deaths

Age group 2 daily deaths

70

Age group 3 daily deaths
140

80

60

120
60

50
40

100
80

40

30
20

60
40

20

10

20

0

0
03-03

17-03

True data

31-03

14-04

28-04

Date of death

12-05

Median prediction

26-05

0
03-03

Tobs

17-03

31-03

True data

Age group 4 daily deaths

14-04

28-04

Date of death

12-05

Median prediction

350

26-05

03-03

Tobs

17-03

True data

31-03

14-04

28-04

Date of death

12-05

Median prediction

Age group 5 daily deaths

26-05

Tobs

400

300
250

300

200
200

150
100

100

50
0

0
03-03

17-03

True data

31-03

14-04

28-04

Date of death

12-05

Median prediction

26-05

03-03

Tobs

17-03

True data

31-03

14-04

28-04

Date of death

12-05

Median prediction

26-05

Tobs

Figure 20: Comparison of number of daily deceased predicted by our model and actual one
(green line), for each age group for England, obtained using data until 23rd May.

27

Age group 1 cumulative deaths

Age group 2 cumulative deaths

3500

3000

Age group 3 cumulative deaths
6000

3000

2500

5000

2500

2000

4000

2000

1500

1500

3000

1000

1000

2000

500

500

1000

0

0
03-03

17-03

True data

31-03

14-04

28-04

Date of death

12-05

Median prediction

26-05

0
03-03

Tobs

17-03

31-03

True data

Age group 4 cumulative deaths

14-04

28-04

Date of death

12-05

26-05

Tobs

Median prediction
20000

15000

17500

12500

15000

10000

12500

03-03

17-03

True data

31-03

14-04

28-04

Date of death

Age group 5 cumulative deaths

12-05

Median prediction

26-05

Tobs

10000

7500

7500

5000

5000

2500

2500

0

0
03-03

17-03

True data

31-03

14-04

28-04

Date of death

12-05

Median prediction

26-05

03-03

Tobs

17-03

True data

31-03

14-04

28-04

Date of death

12-05

Median prediction

26-05

Tobs

Figure 21: Comparison of cumulative deaths predicted by our model and actual one (green line),
for each age group for England, obtained using data until 23rd May. Note that the number of
deaths in Age Group 1 is very much overestimated by our model. This is due to the relatively small number
of deaths in that age group, which make it hard to obtain a good fit.

28

B.2

Study on England data until 31st August

B.2.1

Inferred parameters

We now present results on the case study using data for England until 31st August. The posterior mean and
standard deviation of model parameters is reported in Table 1. In Figures 22, 23 and 24 we instead provide
posterior plots as above.

dL

dC

dR

dRC

dD

N in

10

0.2

5

dL

0
3

3

2

2

dC

1
6

dR

0.1

Post. mean = 0.13

1
6

Post. mean = 1.81

4

4

2
2

2

1

dRC

2

Post. mean = 2.84

1

Post. mean = 1.74

12.5

12.5

10.0

10.0
Post. mean = 12.65

dD

10

10

5

5

N in

Post. mean = 7.44

400

0.002

200
0.1

0.2 1

2

dL

3

2.5

dC

5.0 1

2

dR

10.0 12.5

dRC

5

dD

10

Post. mean = 340.02

0.000
250 500

N in

Figure 22: Single and bivariate marginals (represented using contour plots) for the parameters
describing the transition between states for England, obtained using data until 31st August;
note for instance the negative correlation between β and dR ; this is expected from the dynamics of the model
(the longer a person stay in the infectious state, the more people can infect; therefore, a similar dynamics
can be obtained by a lower value of β).

29

0

1

1

2

3
1e 1

0

1

2

2
1e 1

1e 1
8
5

6

0

4

1.0
0.8
0.6
0.4
0.2
0.0

0

3

1.0
0.8
0.6
0.4
0.2
0.0

0

2
0

1
0

1.0
0.8
0.6
0.4
0.2
0.0

4
2

0

2

3

4

0.25 0.50 0.75 1.00

1e 1

4

1.0
0.9
0.8
0.7
0.6
0.5

0.6

0.8

5

1.0

Figure 23: Contour plots representing bivariate posterior plots for ρi and ρ0i , for all age groups
(i = 1, . . . , 5) for England, obtained using data until 31st August. For all of them, some negative
correlation is present; this is very evident in the case of age group 4.

123

10

4

5

0.55

123

8

0.50

6

0.45

4

0.40

2
0
1.0

4

0.35

Post. mean = 0.36

0.30
1.0

0.8

0.8

0.6

0.6

0.4

0.4

0.2

0.2

Post. mean = 0.43

0.0
1.0

0.0
2.5
2.0

5

0.8

1.5

0.6

1.0

0.4
0.2

Post. mean = 0.74
0.3

0.4

123

0.5

0.0

0.5
4

1.0 0.25

0.50

5

0.75

0.5
0.0
1.00

Figure 24: Single and bivariate marginals (represented using contour plots) for the parameters
connecting the reduction in mobility to the change of social contacts for England, obtained
using data until 31st August.

30

B.2.2

Deaths for each age group

The main body of the paper reports the predicted evolution of number of hospitalized people and daily
deceased, as well as the estimated evolution of R(t), using data for England until 31st of August, and
compares that with the observation. Here, in Figure 25, we report the median and 99 percentile credibility
interval of the daily deceased in each of the 5 age groups for the same time interval, and we compare it to
the actual data (green). Note that the credibility interval is larger for age groups 1 and 2; this is expected,
as the number of deaths in that age groups is relatively small, so that achieving a good fit is harder.
See https://github.com/OptimalLockdown/MobilitySEIRD-England for additional plots with regards to
the unobserved compartments.

Age group 1 daily deaths

Age group 2 daily deaths

Age group 3 daily deaths

100

100

80

80

60

60

80

40

40

60

20

20

0

0
31-0314-0428-0412-0526-0509-0623-0607-0721-0704-0818-0801-09

True data

Date of death

Median prediction
350

140
120
100

40
20
0
31-0314-0428-0412-0526-0509-0623-0607-0721-0704-0818-0801-09

Tobs

True data

Age group 4 daily deaths

Date of death

Median prediction

31-0314-0428-0412-0526-0509-0623-0607-0721-0704-0818-0801-09

Tobs

True data

Date of death

Median prediction

Age group 5 daily deaths

Tobs

400

300
250

300

200

200

150
100

100

50
0

0
31-0314-0428-0412-0526-0509-0623-0607-0721-0704-0818-0801-09

True data

Date of death

Median prediction

31-0314-0428-0412-0526-0509-0623-0607-0721-0704-0818-0801-09

Tobs

True data

Date of death

Median prediction

Tobs

Figure 25: Comparison of number of daily deceased predicted by our model and actual one
(green line), for each age group for England, obtained using data until 31st August.

B.3
B.3.1

Study on France data until 31st August
Inferred parameters

We now present results on the case study using data for England until 31st August. The posterior mean and
standard deviation of model parameters is reported in Table 2. In Figures 26, 27 and 28 we instead provide
posterior plots as above.
B.3.2

Deaths for each age group

The main body of the paper reports the predicted evolution of number of hospitalized people and daily
deceased, as well as the estimated evolution of R(t), using data for England until 31st of August, and
compares that with the observation. Here, in Figure 29, we report the median and 99 percentile credibility
interval of the daily deceased in each of the 5 age groups for the same time interval, and we compare it to
the actual data (green). Note that the credibility interval is larger for age groups 1 and 2; this is expected,
as the number of deaths in that age groups is relatively small, so that achieving a good fit is harder.
See https://github.com/OptimalLockdown/MobilitySEIRD-France for additional plots with regards to
the unobserved compartments.

31

dL

dC

dR

dRC

dD

N in

20

0.12
0.10
0.08

10

dL

0

Post. mean = 0.11

1.5

dC

1.0
5

1.5
1.0
5

Post. mean = 1.26

4

4

dR

3

3

Post. mean = 4.01

1.5

1.5

dRC

1.0
14

1.0
14

Post. mean = 1.34

13

13

N in

dD

12
10

12
10

Post. mean = 13.57

5

5
Post. mean = 5.78

500
400
300

0.005
0.1000.125 1.0

1.5

dL

3

4

dC

5 1.0

1.5

dR

12

dRC

14

5

dD

Post. mean = 421.48

0.000
10 300 400 500

N in

Figure 26: Single and bivariate marginals (represented using contour plots) for the parameters
describing the transition between states for France, obtained using data until 31st August; note
for instance the negative correlation between β and dR ; this is expected from the dynamics of the model (the
longer a person stay in the infectious state, the more people can infect; therefore, a similar dynamics can be
obtained by a lower value of β).

32

Table 2: Estimated posterior mean and standard deviation of model parameters for France. We
point out that the estimated standard deviation is larger than the posterior mean for some of the parameters;
this is due to the fact that the posterior distribution is not centered on the posterior mean but skewed.

0.0

0.5

1.0

1

1.5
1e 1

0.0 0.5 1.0 1.5
1e 1
2

4

dR,C
13.57 ± 0.37
α5
0.19 ± 0.16
ρ4
0.91 ± 0.08
ρ04
0.01 ± 0.01

1e 1
9
8
0

5

2
1

0.0

0.5

3

1.0
1e 1

0

dD
5.78 ± 2.54
N in
421 ± 61
ρ5
0.58 ± 0.08
ρ05
0.58 ± 0.07

1e 2

3
4

1.0
0.8
0.6
0.4
0.2
0.0

dR
1.34 ± 0.23
α4
0.88 ± 0.10
ρ3
0.03 ± 0.03
ρ03
0.39 ± 0.29

0

1.0
0.8
0.6
0.4
0.2
0.0

dC
4.01 ± 0.54
α123
0.31 ± 0.01
ρ2
0.03 ± 0.03
ρ02
0.39 ± 0.29

3

dL
1.26 ± 0.22
β
0.11 ± 0.01
ρ1
0.04 ± 0.04
ρ01
0.38 ± 0.28

0

2

1.0
0.8
0.6
0.4
0.2
0.0

0

0

1

Observation period
1st March-31st Aug
Observation period
1st March-31st Aug
Observation period
1st March-31st Aug
Observation period
1st March-31st Aug

7
6

0.7

0.8

4

0.9

1.0

5

6

5

8

1e 1

Figure 27: Contour plots representing bivariate posterior plots for ρi and ρ0i , for all age groups
(i = 1, . . . , 5) for France, obtained using data until 31st August.

123

4

5

50

0.34

123

40

0.33

30

0.32

20

4

10
0
1.0
0.9
0.8
0.7
0.6
0.5

0.31

Post. mean = 0.31

0.30
1.0
0.9
0.8
0.7
0.6
0.5

Post. mean = 0.88

0.8

5

0.6
0.4
0.2
0.0
0.30

Post. mean = 0.19
0.32

123

0.34

0.6

4

0.8

1.0 0.00

0.25

0.50

5

0.75

3.0
2.5
2.0
1.5
1.0
0.5
0.0

Figure 28: Single and bivariate marginals (represented using contour plots) for the parameters
connecting the reduction in mobility to the change of social contacts for France, obtained using
data until 31st August.

33

Age group 1 daily deaths

Age group 2 daily deaths

160

200

140

150

100

120

120

100
80

80

100

60

60

40

40

50

20

20

0

0

0
31-0314-0428-0412-0526-0509-0623-0607-0721-0704-0818-0801-09

True data

Date of death

Median prediction

Age group 3 daily deaths

140

31-0314-0428-0412-0526-0509-0623-0607-0721-0704-0818-0801-09

Tobs

True data

Age group 4 daily deaths

Date of death

Median prediction
500

140
120

31-0314-0428-0412-0526-0509-0623-0607-0721-0704-0818-0801-09

Tobs

True data

Date of death

Median prediction

Age group 5 daily deaths

Tobs

400

100

300

80
60

200

40

100

20
0

0
31-0314-0428-0412-0526-0509-0623-0607-0721-0704-0818-0801-09

True data

Date of death

Median prediction

31-0314-0428-0412-0526-0509-0623-0607-0721-0704-0818-0801-09

Tobs

True data

Date of death

Median prediction

Tobs

Figure 29: Comparison of number of daily deceased predicted by our model and actual one
(green line), for each age group for France, obtained using data until 31st August.

References
[1] Age distribution of international flight passengers to the uk. https://www.statista.com/statistics/
304641/age-distribution-of-air-passengers-by-airport-uk/, 2020.
[2] Lockdown measures by uk governmnet during 2020 covid-19 pandemic. https://bfpg.co.uk/2020/
04/covid-19-timeline/, 2020.
[3] Google mobility. https://www.google.com/covid19/mobility/, 2020.
[4] Website reporting on optimal lockdown project. https://optimallockdown.github.io/Covid19inEngland/,
2020.
[5] G. Albi, M. Bongini, E. Cristiani, and D. Kalise. Invisible control of self-organizing agents leaving
unknown environments. SIAM Journal on Applied Mathematics, 76(4):1683–1710, 2016. doi: 10.1137/
15M1017016.
[6] G. Albi, L. Pareschi, and M. Zanella. Control with uncertain data of socially structured compartmental
epidemic models. arXiv preprint arXiv:2004.13067, 2020.
[7] A. Alla, C. Balzotti, M. Briani, and E. Cristiani. Understanding mass transfer directions via data-driven
models with application to mobile phone data. SIAM Journal on Applied Dynamical Systems, 19(2):
1372–1391, 2020. doi: 10.1137/19M1248479. URL https://doi.org/10.1137/19M1248479.
[8] R. M. Anderson and R. M. May. Infectious diseases of humans: dynamics and control. Oxford university
press, 1992.
[9] R. Bailo, M. Bongini, J. A. Carrillo, and D. Kalise. Optimal consensus control of the cucker-smale
model. IFAC-PapersOnLine, 51(13):1 – 6, 2018.
[10] M. A. Beaumont. Approximate bayesian computation in evolution and ecology. Annual review of ecology,
evolution, and systematics, 41:379–406, 2010.

34

[11] A. Charpentier, R. Elie, M. Laurière, and V. C. Tran. Covid-19 pandemic control: balancing detection
policy and lockdown intervention under icu sustainability. arXiv preprint arXiv:2005.06526, 2020.
[12] M. Chinazzi, J. T. Davis, M. Ajelli, C. Gioannini, M. Litvinova, S. Merler, A. P. y Piontti, K. Mu,
L. Rossi, K. Sun, et al. The effect of travel restrictions on the spread of the 2019 novel coronavirus
(covid-19) outbreak. Science, 368(6489):395–400, 2020.
[13] N. G. Davies, P. Klepac, Y. Liu, K. Prem, M. Jit, R. M. Eggo, C. C.-. working group, et al. Agedependent effects in the transmission and control of covid-19 epidemics. MedRxiv, 2020.
[14] R. Dutta, M. Schoengens, J.-P. Onnela, and A. Mira. Abcpy: A user-friendly, extensible, and parallel
library for approximate bayesian computation. In Proceedings of the Platform for Advanced Scientific
Computing Conference, pages 1–9, 2017.
[15] M. Gatto, E. Bertuzzo, L. Mari, S. Miccoli, L. Carraro, R. Casagrandi, and A. Rinaldo. Spread and
dynamics of the covid-19 epidemic in italy: Effects of emergency containment measures. Proceedings of
the National Academy of Sciences, 117(19):10484–10491, 2020.
[16] L. Grüne and J. Pannek. Nonlinear model predictive control. In Nonlinear Model Predictive Control,
pages 45–69. Springer, 2017.
[17] J. Hilton and M. J. Keeling. Estimation of country-level basic reproductive ratios for novel coronavirus
(covid-19) using synthetic contact matrices. medRxiv, 2020.
[18] IHME and C. J. Murray. Forecasting covid-19 impact on hospital bed-days, icu-days, ventilator-days
and deaths by us state in the next 4 months. MedRxiv, 2020.
[19] W. O. Kermack and A. G. McKendrick. A contribution to the mathematical theory of epidemics.
Proceedings of the royal society of london. Series A, Containing papers of a mathematical and physical
character, 115(772):700–721, 1927.
[20] P. Klepac, A. J. Kucharski, A. J. Conlan, S. Kissler, M. Tang, H. Fry, and J. R. Gog. Contacts in
context: large-scale setting-specific social mixing matrices from the bbc pandemic project. medRxiv,
2020.
[21] A. J. Kucharski, T. W. Russell, C. Diamond, Y. Liu, J. Edmunds, S. Funk, R. M. Eggo, F. Sun, M. Jit,
J. D. Munday, et al. Early dynamics of transmission and control of covid-19: a mathematical modelling
study. The lancet infectious diseases, 2020.
[22] J. Lintusaari, M. U. Gutmann, R. Dutta, S. Kaski, and J. Corander. Fundamentals and recent developments in approximate bayesian computation. Systematic biology, 66(1):e66–e82, 2017.
[23] NHS(England). Daily death due to covid-19 in england. https://www.england.nhs.uk/statistics/
statistical-work-areas/covid-19-daily-deaths/, 2020.
[24] PHE. Daily hospitalized due to covid-19 in england. https://www.gov.uk/government/publications/
slides-and-datasets-to-accompany-coronavirus-press-conference-25-may-2020, 2020.
[25] K. Prem, A. R. Cook, and M. Jit. Projecting social contact matrices in 152 countries using contact
surveys and demographic data. PLoS computational biology, 13(9):e1005697, 2017.
[26] K. Prem, Y. Liu, T. W. Russell, A. J. Kucharski, R. M. Eggo, N. Davies, S. Flasche, S. Clifford, C. A.
Pearson, J. D. Munday, et al. The effect of control strategies to reduce social mixing on outcomes of the
covid-19 epidemic in wuhan, china: a modelling study. The Lancet Public Health, 2020.
[27] T. Rawson, T. Brewer, D. Veltcheva, C. Huntingford, and M. Bonsall. How and when to end the covid-19
lockdown: an optimisation approach. Frontiers in Public Health, 2020.
[28] C. Rothe, M. Schunk, P. Sothmann, G. Bretzel, G. Froeschl, C. Wallrauch, T. Zimmer, V. Thiel,
C. Janke, W. Guggemos, et al. Transmission of 2019-ncov infection from an asymptomatic contact in
germany. New England Journal of Medicine, 382(10):970–971, 2020.
35

[29] A. Savitzky and M. J. Golay. Smoothing and differentiation of data by simplified least squares procedures.
Analytical chemistry, 36(8):1627–1639, 1964.
[30] E. Trélat and E. Zuazua. The turnpike property in finite-dimensional nonlinear optimal control. Journal
of Differential Equations, 258(1):81 – 114, 2015. ISSN 0022-0396. doi: https://doi.org/10.1016/j.jde.
2014.09.005. URL http://www.sciencedirect.com/science/article/pii/S0022039614003568.
[31] P. Virtanen, R. Gommers, T. E. Oliphant, M. Haberland, T. Reddy, D. Cournapeau, E. Burovski,
P. Peterson, W. Weckesser, J. Bright, et al. Scipy 1.0: fundamental algorithms for scientific computing
in python. Nature methods, 17(3):261–272, 2020.
[32] D. J. Warne, A. Ebert, C. Drovandi, A. Mira, and K. Mengersen. Hindsight is 2020 vision: Characterisation of the global response to the covid-19 pandemic. medRxiv, 2020.
[33] Y. Xiang and X. Gong. Efficiency of generalized simulated annealing. Physical Review E, 62(3):4473,
2000.
[34] NHS(England). Daily death due to COVID-19 in France; 2020. https://www.santepubliquefrance.
fr/dossiers/coronavirus-covid-19.
[35] PHE. Daily hospitalized due to COVID-19 in France; 2020. https://www.data.gouv.fr/fr/datasets/
donnees-hospitalieres-relatives-a-lepidemie-de-covid-19/.
[36] Lockdown measures by French governmnet during 2020 COVID-19 pandemic; 2020. https://www.
legifrance.gouv.fr/jorf/id/JORFTEXT000041737584/.
[37] School closure in France due to COVID-19 pandemic, 2020. https://www.legifrance.gouv.fr/jorf/
id/JORFTEXT000041722917/
[38] R.
Adams
and
H.
Stewart.
Uk
schools
to
be
closed
indefinitely
and
exams
cancelled.
https://www.theguardian.com/world/2020/mar/18/
coronavirus-uk-schools-to-be-closed-indefinitely-and-exams-cancelled, (March 18, 2020
[cited July 1,2020]).

36

