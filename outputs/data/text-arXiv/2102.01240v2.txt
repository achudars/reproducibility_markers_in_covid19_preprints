Fair Dynamic Rationing
Vahideh Manshadi
Yale School of Management, New Haven, CT, vahideh.manshadi@yale.edu

Rad Niazadeh
University of Chicago Booth School of Business, Chicago, IL, rad.niazadeh@chicagobooth.edu

arXiv:2102.01240v2 [cs.GT] 17 Feb 2021

Scott Rodilitz
Yale School of Management, New Haven, CT, scott.rodilitz@yale.edu

We study the allocative challenges that governmental and nonprofit organizations face when tasked with
equitable and efficient rationing of a social good among agents whose needs (demands) realize sequentially
and are possibly correlated. As one example, early in the COVID-19 pandemic, the Federal Emergency
Management Agency faced overwhelming, temporally scattered, a priori uncertain, and correlated demands
for medical supplies from different states. To better achieve their dual aims of equity and efficiency in such
contexts, social planners intend to maximize the minimum fill rate across agents, where each agent’s fill rate
must be irrevocably decided upon its arrival. For an arbitrarily correlated sequence of demands, we establish
upper bounds on both the expected minimum fill rate (ex-post fairness) and the minimum expected fill rate
(ex-ante fairness) achievable by any policy. Our bounds are parameterized by the number of agents and the
expected demand-to-supply ratio, and they shed light on the limits of attaining equity in dynamic rationing.
Further, we show that for any set of parameters, a simple adaptive policy of projected proportional allocation
achieves the best possible fairness guarantee, ex post as well as ex ante. Our policy is transparent and
easy to implement, as it does not rely on distributional information beyond the first conditional moments.
Despite its simplicity, we demonstrate that this policy provides significant improvement over the class of
non-adaptive target-fill-rate policies by characterizing the performance of the optimal such policy, which
relies on full distributional knowledge. We obtain the performance guarantees of (i) our proposed adaptive
policy by inductively designing lower-bound functions on its corresponding value-to-go, and (ii) the optimal
target-fill-rate policy by establishing an intriguing connection to a monopoly-pricing optimization problem.
Further, we extend our results to considering alternative objective functions and to rationing multiple types
of resources. We complement our theoretical developments with a numerical study motivated by the rationing
of COVID-19 medical supplies based on a projected-demand model used by the White House. In such a
setting, our simple adaptive policy significantly outperforms its theoretical guarantee as well as the optimal
target-fill-rate policy.
Key words : rationing, fair allocation, social goods, correlated demands, online resource allocation

1

2

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

1.

Introduction

In Spring 2020, with the COVID-19 pandemic surging across the US, states were relying on the
Federal Emergency Management Agency (FEMA) to provide urgently needed medical equipment
from the Strategic National Stockpile. Unequipped for such a widespread emergency, FEMA aimed
to ration its limited supplies in order to address states’ current needs while also retaining some of
the stockpile in anticipation of future needs. However, the allocation decisions made by FEMA were
inconsistent and lacked transparency, which frustrated state officials (Washington Post 2020a).1
Because having access to medical equipment can be a matter of life or death for a COVID-19
patient, making allocation decisions which are efficient and equitable is of paramount importance
(Emanuel et al. 2020). Achieving efficiency alone is easy: a first-come, first-serve policy allocates
all of the supply to meet early-arriving needs. However, such a policy can be unfair to patients in
states where needs materialize later.
The above is just one example of a fundamental sequential allocation problem that social planners
face when aiming to allocate divisible goods as efficiently and equitably as possible to demanding
agents that arrive over time.
1.1.

Overview of Contributions

In this paper, we take the first step toward theoretically studying the aforementioned class of problems. We develop a framework for fair dynamic rationing where agents’ one-time needs (demands)
for a divisible good realize sequentially and can be arbitrarily correlated. In particular, upon arrival
of each agent’s demand, the planner makes an irrevocable decision about their fill rate (FR). Toward
jointly achieving efficiency and equity, the planner aims to maximize the minimum FR, either ex
post or ex ante. To assess the performance of sequential allocation policies, we introduce measures
of ex-post and ex-ante fairness guarantees. For this general setting:
(i) We establish upper bounds on the ex-post and ex-ante fairness guarantees achievable by any
policy. These bounds are parameterized by the supply scarcity (i.e., the expected demand-tosupply ratio) and the number of agents.
(ii) Remarkably, we show that a simple, adaptive, and transparent policy called projected proportional allocation (PPA) simultaneously achieves our upper bounds on the ex-post and ex-ante
fairness guarantees for any set of parameters.
(iii) We illustrate the power of adaptivity by characterizing the ex-post guarantee of the optimal
target-fill-rate policy and showing that such a non-adaptive policy cannot achieve our upper
bounds.
1

“We don’t know how the federal government is making those decisions,” said Casey Katims, the federal liaison for
Washington state.

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

3

(iv) Finally, we demonstrate the effectiveness of our policy through an illustrative case study
motivated by the allocation of COVID-19 medical supplies based on a model of demand which
was used by the White House.
Introducing a framework for fair dynamic rationing: We study the allocation of a divisible
good to agents arriving over time with varying levels of demand. We assume the demand sequence is
drawn from an arbitrary but known joint distribution across all agents. To account for heterogeneity
in the demand level of different agents, we set each agent’s utility to be its FR. In our base model,
we focus on the objective of maximizing the minimum FR across all agents. Such an objective—
which is in the spirit of Rawlsian justice—maximizes the utility of the worst-off agent. As such,
it takes fairness into consideration along with efficiency.2 Due to the stochasticity of the demand
sequence, we consider two versions of this objective function: the excepted minimum FR and the
minimum expected FR (see eq. (ex-post) and eq. (ex-ante), respectively, as well as the subsequent
discussion).
Like other online stochastic optimization problems, our sequential allocation problem can be
formulated as a dynamic program (DP), and it similarly suffers from the curse of dimensionality as
well as other practical limitations such as a lack of interpretability. Consequently, we aim to design
sequential allocation policies that perform well while being practically appealing and computable
in polynomial time. We assess the performance of a policy by computing its ex-post and ex-ante
fairness guarantees for any given supply scarcity and number of agents. In defining our notions of
such guarantees, we use the minimum FR achievable under deterministic demand as a benchmark
(see eq. (1) and Definition 1 and their related discussion in Section 2) to separate the impact
of demand stochasticity from the impact of supply scarcity. The ex-post (resp. ex-ante) fairness
guarantee of a policy serves as a lower bound on the expected minimum (resp. minimum expected)
FR that the policy achieves relative to our benchmark under all possible joint demand distributions.
Establishing upper bounds: In order to gain insight into the difficulty of achieving equity and
efficiency in sequential allocation, we develop upper bounds on the achievable fairness guarantees
of any online policy, even policies which cannot be computed in polynomial time. For intuition,
consider the following example with two agents. The first agent has demand of B1 , where B1 is a
Bernoulli random variable with success probability 2/3. The second agent has demand B1 × B2 ,
where B2 is an independent Bernoulli random variable with success probability 1/2. In other words,
the demand sequence is equally likely to be (0, 0), (1, 0), or (1, 1). For such an instance, no sequential
allocation policy can distinguish between the latter two scenarios after observing the first demand,
which leads to a sub-optimal decision. Building on the above intuition, in Sections 3.1 and 3.5, we
2

In Section 5, we generalize our objective function.

4

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

establish upper bounds on the ex-post and ex-ante guarantees of any policy (see Theorems 1 and
4).
As we later show, these bounds are indeed tight. Thus, conducting comparative statics with
respect to the supply scarcity and the number of agents reveals several insights (see Figure 1):
when demand is small relative to supply, the bounds on both fairness guarantees deteriorate with
increased demand. However, in the over-demanded regime, the bounds are independent of the
supply scarcity. Further, in both the under-demanded and over-demanded regimes, the ex-post
fairness guarantee worsens with more agents. On the other hand, the ex-ante fairness guarantee is
independent of the number of agents. This highlights the fundamental difference in our notions of
fairness: the objective corresponding to ex-post fairness (the expected minimum FR) is concerned
with fairness along all samples paths, whereas the objective corresponding to ex-ante fairness (the
minimum expected FR) is only concerned with marginal fairness (see the related discussion in
Section 2).
Achieving upper bounds: Since our upper bounds apply to all sequential policies including the
optimal online policy (namely, the exponential-sized DP), it would be reasonable if no policy could
achieve these upper bounds in polynomial-time. However, we show that not only are these upper
bounds achievable, but they can be achieved by our PPA policy. To motivate our policy, let us
consider a hypothetical situation where the demand sequence is known a priori. In that case, the
optimal allocation under both objectives is to equalize the FRs and then maximize that FR (see
eq. (1) and its related discussion). Alternatively, this can be written as a deterministic DP with
a simple solution: at each time period, proportionally allocate the remaining supply based on the
current demand and the total future demand (see Section 3.2 and Appendix A.3). When demand
is stochastic, our PPA policy simply replaces all the future random demands by their projected
values, namely, their conditional expectations (see eq. (4)).
In Sections 3.3 and 3.5, we analyze the ex-post and ex-ante fairness guarantees of the PPA policy
and show that it achieves the best of both worlds: our lower bounds on the PPA policy’s guarantees
match the corresponding upper bounds for any supply scarcity and any number of agents. These
two analyses rely on delicate inductive arguments. For ex-post fairness, we establish a lower bound
on the value-to-go function of our PPA policy by analyzing the evolution of the minimum FR and
progressively constructing a worst-case joint distribution for demand (see Lemma 1 and Figure 3).
For ex-ante fairness, we demonstrate that the expected demand-to-supply ratio before the arrival
of each agent is non-increasing when following the PPA policy, which enables us to bound the
marginal expected FR for each agent (see Appendix A.6).
We highlight that beyond enjoying the best possible guarantees, our PPA policy is practically
appealing: it is computationally efficient, interpretable, and transparent. In addition, it does not

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

5

require full distributional knowledge, as it only relies on the first conditional moments of the joint
distribution for demand. This last property is significant because knowing the full distribution may
not be feasible in many practical situations (we discuss one such example in Section 4). Further,
policies which rely on detailed distributional knowledge can be prone to errors or perturbations
(see Footnote 15 and Appendix A.2).
Establishing sub-optimality of target-fill-rate policies: In addition to showing that our
PPA policy achieves the best possible guarantees, we extend our work to studying the subclass of
target-fill-rate (TFR) policies. A TFR policy commits upfront to a fill rate τ , and upon arrival
of each agent, it allocates a fraction τ of that agent’s demand until it exhausts the supply. Our
study of TFR policies is motivated by two reasons: (i) since such policies are transparent and easyto-communicate, they are frequently used in practice, including at the outset of the COVID-19
pandemic when an initial formula allocated a fixed percentage of states’ estimated needs (Washington Post 2020a), and (ii) TFR policies are a natural yet powerful class of non-adaptive policies (see
Section 3.4). Consequently, comparing the performance of TFR policies with that of our adaptive
PPA policy sheds light on the limitations of making non-adaptive decisions.
Intuitively, a TFR policy can perform poorly because it does not take advantage of information that reduces future uncertainty. For instance, consider a setting with two agents where the
second agent’s demand is perfectly correlated with the first agent’s demand. A simple adaptive
policy—such as our PPA policy—will perform optimally in such a setting because demand is deterministic upon the first agent’s arrival. The PPA policy achieves such performance by crucially
leveraging information about the second agent’s demand when determining the first agent’s fill
rate. In contrast, a TFR policy targets the same fill rate regardless of the first agent’s demand,
and consequently cannot ensure that sufficient supply remains for the second agent. Based on this
intuition, in Section 3.4, we provide a tight bound on the ex-post fairness guarantee of the optimal
TFR policy (see Theorem 3), which can be considerably lower than the corresponding guarantee
of our adaptive PPA policy (see Figure 4).
To characterize the ex-post fairness guarantee of the optimal TFR policy, we construct the worstcase total demand distribution against such a policy. In the proof, we establish a rather surprising
connection to the literature on monopoly pricing and Bayesian mechanism design (see Hartline
(2013) for more details on this literature). In particular, upon mapping the problem of finding
the worst-case instance into the quantile space, our problem reduces to a constrained version of
the (single-item) monopoly pricing problem (see Remark 2). We identify two key properties of
the worst-case distribution in this constrained monopoly pricing problem, and by exploiting the
connection to our original problem, we end up with the desired characterization of the worstcase total demand distribution against the optimal TFR policy. Due to this connection, our proof

6

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

technique and corresponding results can be of independent interest (e.g., see Alaei et al. (2019) for
proof techniques and results in the same spirit).
Illustrative case study: To demonstrate the effectiveness of our policy, in Section 4 we conduct
a numerical case study motivated by the allocative challenges that FEMA faced at the beginning
of the COVID-19 pandemic (as discussed at the beginning of this section). Drawing upon a model
cited by the White house at that time, we first highlight the sequential and heterogeneous nature of
states’ demands for medical supplies. Then, we augment that model by considering a multivariate
Normal distribution for demand with various levels of correlation. Our simulation results illustrate
the superior performance of our PPA policy compared to both its ex-post fairness guarantee and
the optimal TFR policy. Further, the results suggest that our PPA policy performs nearly as well
as a DP solution (which, as we discuss, suffers from many practical limitations).
Allocating medical supplies in a pandemic is just one motivating example of the challenges that
arise when a governmental or nonprofit organization aims to ration supply among agents whose (a
priori uncertain and correlated) needs realize sequentially. Other examples include the allocation
of emergency aid when a natural disaster such as a hurricane or wildfire impacts multiple locations
over time (Wang et al. 2019), as well as the distribution of food donations by mobile pantries that
sequentially visit agencies (Lien et al. 2014).3 Our proposed policy can effectively guide transparent
allocation decisions in such contexts while also providing a guarantee on the fairness level of the
process. Finally, as discussed in Section 5, our framework can be enriched to account for other
practical considerations, such as (i) generalized objective functions that enable the social planner
to balance equity and efficiency to varying degrees, and (ii) rationing multiple types of resources
(see Corollaries 1, 2, and 3 in Section 5.2).
1.2.

Related Work

We conclude this section by discussing how our work relates to and contributes to several streams
of literature.
Fairness in static resource allocation: Considerations of fairness and its trade-off with efficiency have frequently arisen in the resource allocation literature in operations research and computer science.4 We begin by discussing papers which study fairness in static (one-shot) allocation
settings. The seminal work of Bertsimas et al. (2011) considers a general setting where a central
3

As explained in detail in Lien et al. (2014), even though the daily demand for food donations from different agencies
are not temporally scattered, they will only be observed by the operators upon their arrival at the sites.
4

Other recent papers have focused on fairness in the contexts of pricing (Cohen et al. 2019), information acquisition
(Cai et al. 2020), targeted interventions (Levi et al. 2019), service levels (Jiang et al. 2019), and online learning
(Gupta and Kamble 2019). See also the work of Cayci et al. (2020) that considers fair resource allocation with online
learning.

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

7

decision-maker allocates m divisible resources to n agents, each with a different utility function.
Focusing on two commonly used notions of fairness in allocation, max-min and proportional fairness, the authors characterize the efficiency loss due to maximizing fairness (see also Bertsimas
et al. 2012 and Bertsimas et al. 2013). If demand was deterministic in our setting, the optimal
allocation would coincide with that of the max-min objective in Bertsimas et al. (2011). Namely,
for both objectives, the optimal allocation consists of maximized equal FRs.
Focusing on indivisible goods, Donahue and Kleinberg (2020) considers the trade-off between
fairness and utilization when demand is distributed across different agents. A priori, only demand
distributions are known. However, after a one-shot allocation decision, all demand values realize.
The fairness notion considered in this line of work is in the same spirit of our notion of ex-ante
fairness: they require that an individual’s chance of receiving the resource should not significantly
depend on the group to which the individual belongs. Similarly, by maximizing the minimum
expected FR, we aim to reduce the impact of an agent’s place in the sequence of arrivals. Sharing
similar motivation to our paper, Grigoryan (2020) and Pathak et al. (2020) consider equitable
COVID-19 vaccine allocation. However, the settings (e.g., offline and deterministic), models, and
techniques in both papers differ drastically from those in this work.
Also falling within the category of static allocation of indivisible goods, a stream of papers
in computer science considers allocation problems when agents’ valuations are deterministically
known. For deterministic algorithms, recent research has centered on the existence of allocations
which satisfy certain fairness properties, such as envy-freeness up to any good (see, e.g., Chaudhury
et al. (2020) and references therein). For randomized algorithms, the closest to our work is the
recent work of Freeman et al. (2020), which uses notions of ex-post and ex-ante fairness and
explores whether both can be achieved simultaneously. They develop a randomized algorithm that
is approximately fair ex post and precisely fair ex ante. We ask a similar question, albeit in a
dynamic divisible-good setting with random and correlated demand, and we affirmatively answer
it: our PPA policy exactly achieves the best possible fairness guarantee ex post as well as ex ante
(see Theorems 2 and 4).
Fairness in dynamic resource allocation: We now turn our attention to papers that consider
fairness in dynamic (online) allocation settings. In terms of modeling, closest to our work are Lien
et al. (2014) and Sinclair et al. (2020). Motivated by the distribution of food donations by mobile
pantries,5 Lien et al. (2014) introduced the problem of sequential resource allocation which coincides
with our base model and the ex-post fairness objective function, in that it aims to maximize the
5

For other examples of work in this application area, see Solak et al. (2014), Orgut et al. (2018), and Eisenhandler
and Tzur (2019).

8

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

expected minimum FR (although it only studies the special case of independent demands). The
recent work of Sinclair et al. (2020) considers a similar model; however, it focuses on a multi-criteria
objective which is based on an allocation’s distance from the optimal offline Nash Social Welfare
solution. We note that their notion of fairness is also different in nature from ours.6
The algorithmic aspects of both Lien et al. (2014) and Sinclair et al. (2020) consist of designing
novel heuristics and numerically evaluating them against a relevant benchmark (the intractable
DP solution and the Nash Social Welfare solution, respectively). On the other hand, we take a
theoretical approach and analyze fairness guarantees for the policies we design. Further, we provide
upper bounds on the performance of any policy (including the DP solution), which serves a dual
purpose: (i) it establishes that our policy is the best possible one if we aim to achieve both ex-ante
and ex-post fairness guarantees, and (ii) it highlights the fundamental limits of achieving equity in
a dynamic setting.
In settings with multiple types of resources, Azar et al. (2010) and Bateni et al. (2016) study
online versions of Fisher markets and develop policies with fairness guarantees under two different
arrival models. The former assumes an adversarial model whereas the latter considers demand that
belongs to a general class of stochastic processes.7 There are fundamental differences between our
work and the aforementioned papers. Just to name one, the settings of Azar et al. (2010) and
Bateni et al. (2016) are motivated by online advertising, where demanding agents (advertisers) are
offline and items (impressions) arrive in an online fashion. Demanding agents have a large budget
compared to the price of each arriving item, and they derive item-specific utilities. Consequently,
the fairness notion is concerned with the total utility of each agent, which is a function of all items
allocated to it during the horizon. In contrast from such a setting, demanding agents in our work
arrive in an online fashion while the supply side is offline, and each demanding agent receives a
single allocation. The recent works of Ma and Xu (2020) and Nanda et al. (2020) are closer to
our setting in that the demanding agents arrive online; however, they differ in several aspects: (i)
the underlying arrival process is known i.i.d. where arriving demand belongs to various groups,
(ii) they focus on group-level fairness, and (iii) they consider a matching setting, i.e., allocating
indivisible goods.
The objectives of ex-post and ex-ante fairness which we study in our problem bear some resemblance to the objective in the online contention resolution scheme (OCRS) problem, although the
6

In Sinclair et al. (2020), their notion of fairness is with respect to the absolute allocation, i.e., if possible, agents’
allocation should be equalized regardless of differences in their needs. In contrast, we aim for an allocation which is
proportional to need.
7

We remark that papers considering general convex objective functions, such as Agrawal and Devanur (2014) and
Balseiro et al. (2020), admit many common fairness objective functions as special cases. See also Mehta (2012) for
more details.

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

9

two problems are not directly comparable. The OCRS is basically a rounding algorithm that aims
to uniformly preserve the marginals induced by a fractional solution while obtaining feasibility of
the final allocation. This technique has found application in many settings such as Bayesian online
selection, oblivious posted pricing mechanisms, and stochastic probing models (see, e.g., Alaei 2014,
Feldman et al. 2016, and Lee and Singla 2018). The OCRS problem diverges from ours because
that setting focuses on designing randomized policies for allocating indivisible goods, while our
focus is on divisible goods (consequently, restricting to deterministic policies is without loss).
Dynamic allocation of social goods: On a broader level, our paper is related to the literature
on dynamic allocation of social goods and services, such as public housing, donated organs, and
emergency care. Examples of centralized allocation policies include Kaplan (1984), Ashlagi et al.
(2013), Agarwal et al. (2019), and Ashlagi et al. (2019); examples of decentralized mechanisms
are Leshno (2017), Anunrojwong et al. (2020), and Arnosti and Shi (2020). For the most part, the
aforementioned papers focus on the analysis of social welfare in steady-state models where both
demand and supply dynamically arrive. We complement this literature by focusing on equitable
allocation in a non-stationary framework where a fixed amount of supply must be rationed across
demand that arrives over time.
Online resource allocation: From a technical point of view, our work is related to the rich
literature on online resource allocation and prophet inequalities, which started from the seminal
work of Krengel and Sucheston (1978) and Samuel-Cahn et al. (1984). For an informative survey,
we refer the interested reader to Lucier (2017). We highlight that in terms of modeling demand,
our work departs from the prevailing approaches in this literature, namely adversarial, i.i.d., or
random permutation arrival models. In our work, we assume that the sequence of demands can be
arbitrarily correlated and the joint distribution is known in advance. In terms of modeling demand,
our work is closest to a few papers that consider prophet inequalities with correlated demand
(Rinott and Samuel-Cahn 1992, Truong and Wang 2019, Immorlica et al. 2020). However, the
nature of the online decisions is different; in our model, a fraction of a divisible good is allocated
to each arriving demand, whereas in prophet inequality settings, an indivisible good is allocated
to a single agent.
Finally, our PPA policy relies on re-optimizing the FR by replacing all future random demands
by their expected values. As such, it is related to the stream of papers in revenue management
and dynamic programming that theoretically analyze the performance of such heuristics. Great
examples of work in this direction include Ciocan and Farias (2012), Jasin and Kumar (2012),
Balseiro and Brown (2019), and Calmon et al. (2020).

10

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

2.

Preliminaries

Problem setup: Consider a planner that is using a sequential allocation policy—also referred to
as an online policy—to allocate a divisible resource of supply s among n agents. Without loss of
generality, we normalize the total supply so that s = 1. Agents arrive sequentially over time periods
1, 2, . . . , n, and we index agents according to the period in which they arrive. Once agent i arrives,
their demand di ∈ R≥0 is realized and observed by the planner. Based on the observed demand
di and the history up to time period i, the sequential policy makes an irrevocable decision by
allocating an amount xi of the resource to this agent. The allocated amount xi cannot exceed the
agent’s realized demand di nor can it exceed the remaining supply before agent i’s arrival, which
we denote by si . Thus, xi is a feasible allocation if xi ∈ [0, min{si , di }]. Given the feasible allocation
xi and the demand di , agent i’s fill rate (FR) is defined as

xi 8
.
di

After allocating xi to agent i, the

remaining supply before the arrival of agent i + 1 is si+1 = si − xi .
To model the uncertainty about future demands, we consider a Bayesian setting where the di ’s are
stochastic and arbitrarily correlated such that d~ = (d1 , d2 , . . . , dn ) is drawn from a joint distribution

~ ∈ ∆ Rn≥0 known by the planner. We further denote the supply scarcity (i.e., the expected
F
hP
i
demand-to-supply ratio) by µ , Ed∼
d
,9 which is equivalent to the total expected demand
~ F
~
i
i∈[n]
since we normalize the total supply to be 1. For simplicity of presenting our results, we consider

joint distributions that assign non-zero probability to at least one sample path of demands with
dn 6= 0. Equivalently, we assume dn is not deterministically equal to zero.10
As detailed earlier, our setup is motivated by the distributional operations of a governmental
or nonprofit organization. Consequently, we focus on an egalitarian planer that intends to balance
the equity and efficiency of the allocation. To this end, the planner’s objective is to maximize the
minimum achieved FR among the agents, i.e., mini∈[n] xdii , given the uncertainty in the demands.
Maximizing such an objective has its roots in the classic literature on welfare economics (e.g., Arrow
1963) and has been studied more recently in similar contexts in operations research (e.g., Lien
et al. 2014). It provides equity through its focus on the worst FR across all agents—in contrast to
the sum of FRs—and provides efficiency by aiming to maximize this FR—in contrast to allocating
an equally minimal amount of the resource to all agents.11
Objectives & fairness guarantees: Since demands are a priori uncertain in the setup described
above, the planner should consider appropriate metrics to aggregate over uncertain outcomes.
8

If xi = di = 0, we set the FR to 1 as a convention.

9

For any a ∈ N, we use [a] to refer to the set {1, 2, . . . , a}.

10

This assumption is without loss of generality, as one can alternatively re-define n to be the smallest index such
that dn0 is deterministically equal to zero for n0 > n.
11

We consider a broader class of objectives that subsumes the minimum FR in Section 5.2.1.

11

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

We now formally define the planner’s objectives by considering two different metrics: the ex-post
minimum FR and the ex-ante minimum FR. For any sequential allocation policy π, the ex-post
minimum FR of policy π is its expected minimum FR, i.e.,

 
xi
~
WpF (π) , E~d∼F~ min
,
i∈[n]
di

(ex-post)

where ~x = (x1 , x2 , . . . , xn ) is the sequence of allocations generated by π. On the other hand, the
ex-ante minimum FR of policy π is its minimum expected FR, i.e.,

 
xi
~
F
Wa (π) , min E~d∼F~
.
i∈[n]
di
~

(ex-ante)
~

For a randomized policy π, we abuse notation and again use WpF (π) and WaF (π) to denote the
expectation of the above two quantities over the policy π’s internal randomness.12
These two objectives represent two different notions of fairness: eq. (ex-post) aims for equity
in outcomes, whereas eq. (ex-ante) aims for equity in expected outcomes. We largely focus on the
ex-post minimum FR for two main reasons. First, when allocating supplies in response to a rare
event like a pandemic or natural disaster, agents only observe one realized outcome. Because the
ex-ante minimum FR is only concerned with marginal fairness, it can have unfair outcomes for
every sample path, i.e., every realized demand sequence. In contrast, the ex-post minimum FR
considers each full sample path; every sample path with positive probability which results in an
~

unfair outcome reduces WpF (π). Second, by Jensen’s inequality, the ex-post minimum FR serves as
a lower bound on the ex-ante minimum FR, i.e., for any policy π,
~

~

WaF (π) ≥ WpF (π).
However, for a fixed ex-post minimum FR, achieving a higher ex-ante minimum FR is desirable
because it reduces systematic biases against a particular agent, e.g., the last-arriving agent. In the
~

~

extreme case where WaF (π) = WpF (π), one particular agent receives the smallest FR, regardless of
~

~

the sample path. On the other hand, WaF (π) > WpF (π) implies that the worst-off agent varies across
different sample paths.
Having defined our notions of fairness, we first observe that if the sequence of demand is deterministic, then the policy that maximizes both the ex-post and the ex-ante minimum FR is simply
equalizing all FRs. Namely,
n
o
n
o x
n 1o
x2
xn
~
~
1
W , max WaF (π) = max WpF (π) =
=
= ··· =
= min 1,
.
π
π
d1 d2
dn
µ
12

(1)

In principle, we allow randomization of our policies in this paper; however, as will be clear later, all of our proposed
policies are deterministic and no randomization is needed to obtain our targeted performance guarantees.

12

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

The above observation highlights that when total demand exceeds supply, even without stochasticity, we cannot guarantee a minimum FR better than 1/µ, simply due to the scarcity of supply.
However, if the sequence of demands is stochastic and correlated, a minimum FR of 1/µ may not
be achievable. Consequently, we evaluate policies based on how they perform relative to W . For a
~ , we say that the policy achieves ex-post fairness (resp.
policy π and a joint demand distribution F
~

~

ex-ante fairness) of WpF (π)/W (resp. WaF (π)/W ). We aim to design a policy with guarantees on
~ with
both ex-post and ex-ante fairness that hold universally for all joint demand distributions F
n agents and supply scarcity µ. We refer to the universal lower bounds of a policy π as its fairness
guarantees, which we formally define below.
Definition 1 (Ex-post/Ex-ante Fairness Guarantee). A sequential allocation policy π
achieves an ex-post fairness guarantee (resp. ex-ante fairness guarantee) of κp (µ, n) (resp. κa (µ, n)),
if for all n ∈ N and µ ∈ R≥0 ,
~

~

W F (π)
≥ κp (µ, n)
inf  p

~ ∈∆ Rn ;µ
W
F
≥0

resp.

W F (π)
inf  a
≥ κa (µ, n)

~ ∈∆ Rn ;µ
W
F
≥0

!

,


where ∆ Rn≥0 ; µ denotes the domain of joint demand distributions with n agents and supply
scarcity µ.

Our goals are (i) to understand the limits of achieving fairness in sequential allocation by computing upper bounds on the achievable guarantees, and (ii) to obtain tight lower bounds by designing
policies with strong ex-post guarantees as well as ex-ante guarantees. We show in Section 3 that
no gap exists between the achievable upper and lower bounds under both ex-post and ex-ante
notions. More specifically, we show how to obtain exactly matching upper and lower bounds for
both notions of fairness using a single adaptive policy.

3.

Optimal Bounds on Fairness Guarantees

In this section, we present our main results for the setting introduced in Section 2. First, we
focus on ex-post fairness in Section 3.1 and establish parameterized upper bounds on the expost fairness guarantee achievable by any sequential allocation policy—whether adaptive or nonadaptive, computationally efficient (i.e., with polynomial running time) or not. Then, somewhat
surprisingly, we show that such upper bounds can be achieved by our policy, which is introduced
and analyzed in Sections 3.2 and 3.3. Next, to illustrate the power of our simple adaptive algorithm,
in Section 3.4 we characterize the ex-post fairness guarantee of the best policy which non-adaptively
aims for a particular target fill rate, and we show that our policy performs favorably compared to
such a policy. Finally, in Section 3.5 we turn our attention to the notion of ex-ante fairness, and
we show that our policy also achieves the best possible ex-ante fairness guarantee.

13

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

1.0
0.8
0.6
0.4
0.2
0.0

Figure 1

0.0 0.5 1.0
Supply 1.5
Scarcit2.0
y

2.5

3.0

2 ts
4 gen
6 of A
8 ber
10 Num

The upper bound on the ex-post fairness guarantee of any policy, as a function of the supply scarcity
and the number of agents.

3.1.

Upper Bound on Ex-post Fairness Guarantee

We begin this section by establishing a fundamental limit on ex-post fairness for any allocation
policy when faced with stochastic and sequential demands. The main result of this subsection is
the following theorem:
Theorem 1 (Upper Bound on Ex-post Fairness Guarantee). Given a fixed number of
agents n ∈ N and supply scarcity µ ∈ R≥0 , no sequential allocation policy obtains an ex-post fairness
guarantee (see Definition 1) greater than κp (µ, n), defined as

n

µ ∈ [0, 1)
1 − ( 2(n+1) )µ,
n
2
.
κp (µ, n) , µ − ( 2(n+1) )µ , µ ∈ [1, n+1
)
n

 n+1
n+1
,
µ ∈ [ n , +∞)
2n

(2)

See Figure 1 for an illustration of this upper bound as a function of the supply scarcity µ and the

number of agents n. Per Definition 1, the ex-post fairness guarantee is relative to the achievable
minimum FR when demands are deterministic, namely W = min{1, 1/µ}. Consequently, this upper
bound provides insight into the unavoidable loss in efficiency and equity when demands are a priori
uncertain and realize sequentially. In particular, we remark that the achievable fairness guarantee
crucially depends on the supply scarcity. In the regime where µ < 1 + n1 , which we refer to as

14

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

the under-demanded regime, κp (µ, n) initially worsens as µ increases before hitting its minimum
(for any fixed n) when expected demand equals supply, i.e., at µ = 1. This suggests that the
stochastic nature of demand is most harmful when expected demand exactly equals supply. On
the other hand, in the over-demanded regime where µ ≥ 1 + n1 , the achievable fairness guarantee
is independent of µ. Given that we are usually in the over-demanded regime in our motivating
applications, Theorem 1 ensures that supply scarcity does not contribute to the loss in fairness
due to uncertain, correlated, and sequential demand. Fixing µ, the upper bound always decreases
with n, implying that achieving fairness can be more challenging for a larger population of agents
with stochastic demands, even if the total expected demand of the population remains the same.
Finally, we highlight that the bound is always at least 1/2 regardless of the supply scarcity and
the number of agents, and it attains its minimum when µ = 1 and n → +∞.
The proof of Theorem 1 relies on establishing two hard instances with similar structures, one
for µ < 1 + 1/n and one for µ ≥ 1 + 1/n. The details of the proof are presented in Appendix A.1.
Here, we present the instance for the over-demanded regime along with a sketch of our analysis. In
this instance, there are n possible equally-likely scenarios, i.e., scenario σ happens with probability
1/n for σ ∈ [n]. In scenario σ, the first σ agents have equal demand of

2µ
n+1

and the rest have no

demand. We illustrate this instance in Figure 2(a).13

First, note that the total supply scarcity for the above hard instance is µ (as shown in Appendix
A.1). Next, consider any sequential policy that faces a non-zero demand from agent i. The policy
cannot distinguish among possible scenarios i, i + 1, . . . , n. Consequently, its allocation decision for
agent i will be independent of the scenario. In light of this observation, any policy can be sufficiently
described by a set of (possibly random) allocations with expected values ~y = (y1 , y2 , . . . , yn ), such
that if agent i has non-zero demand, then they receive an expected allocation yi . Given ~y , the
minimum FR for scenario σ is
rσ ,

(n + 1)
(n + 1)
(n + 1)
Eπ [min{x1 , x2 , . . . , xσ }] ≤
min{y1 , y2 , . . . , yσ } ≤
yσ ,
2µ
2µ
2µ

(3)

where the first inequality is due to the expectation of a minimum being less than the minimum
over expectations (Jensen’s inequality).
In order to establish our upper bound, we set up a factor-revealing linear program as presented
in Figure 2(b). The LP maximizes the expected minimum FR subject to three sets of natural
constraints that must hold for any sequential policy:
• The minimum FR in scenario σ cannot exceed the FR for agent σ, as shown in eq. (3).
13

We remark that similar settings can occur in practice. As one example, consider the challenge of allocating limited
disaster-relief supplies to towns damaged by a hurricane which may continue on its destructive path or may veer back
out to sea.

15

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

(LP) uses variables ~r (fill rate)
and ~y (allocation).
max
~y , ~r ∈ Rn≥0

1 X
rσ
n
rσ ≤

s.t.

(LP)

σ∈[n]

(n + 1)yσ
2µ

rσ ≤ rσ−1 , r0 = 1
X

i∈[n]

(a)
Figure 2

σ ∈ [n]
σ ∈ [n]

yi ≤ 1

(b)

(a) The instance and (b) the factor-revealing LP which establish an upper bound of κp (µ, n) for the
over-demanded regime (i.e., when µ ≥ 1 +

1
).
n

• The minimum FR in scenario σ is at most the minimum FR in scenario σ − 1.

• The total amount of expected allocations cannot exceed the available supply of 1.

In Appendix A.1, we provide an upper bound on the optimal value of this LP by presenting a
feasible solution to its dual. To complete the proof of Theorem 1, we must scale by W = min{1, 1/µ}

to translate this upper bound on the expected minimum FR into an upper bound on ex-post
fairness (see Definition 1).
Having provided the proof sketch of Theorem 1, we finish this section by noting that it is not
clear whether the bound in eq. (2) can be achieved, even by the optimal online policy which
can be found via a DP. Furthermore, there are significant limitations and drawbacks to a DP
approach for maximizing the expected minimum FR in this setting. First, (i) the state space of
such a DP is exponentially large for correlated demands, which makes the DP intractable.14 In
addition, (ii) solving the DP requires full distributional knowledge, and (iii) the DP decisions may
lack transparency and interpretability, which are highly desirable properties in our motivating
applications.15

1

Remarkably, in the following subsection, we design a simple adaptive policy that not only achieves
the best possible ex-post fairness guarantee of κp (µ, n), but also offers several corresponding advantages over a DP solution: (i) it can be computed efficiently, (ii) it only requires knowledge of
14

While the exponential-sized state space does not formally prove the computational hardness of finding the optimal
online policy, it suggests that the naive DP approach will be computationally intractable; additional evidence suggesting computational hardness is due to Papadimitriou and Tsitsiklis (1987), which shows that the closely related
general problem of finding the optimal policy in partially observable MDPs is PSPACE-hard.
15

Of course, the DP solution for ex-post fairness can lead to significantly sub-optimal ex-ante fairness, and it can
also be sensitive to small perturbations in the demand distributions. We provide a simple example to illustrate both
of those drawbacks in Appendix A.2.

16

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

the conditional first moments of agents’ demands, and (iii) its decisions can be clearly explained.
Additionally, as shown in Section 3.5, it simultaneously attains the best-possible ex-ante fairness
guarantee.
3.2.

Projected Proportional Allocation Policy

We introduce our policy, referred to as the projected proportional allocation (PPA) policy, through
the following simple intuition. Consider a planner that (magically) has access to all the demand
~ As already discussed in Section 2, to maximize the minimum FR when the demand
realizations d.
realizations are known a priori, the planner should equalize the FR of all agents by allocating


P
x∗i = min di , P di dj to each agent i. If j∈[n] dj is at most the initial supply (which we normalize
j∈[n]

to 1), then each agent i obtains a full allocation of xi = di in such a solution. This results in the
P
maximum equal FR of 1. Otherwise, all the agents will have an equal FR of 1/ j∈[n] dj , which is

1/µ when each demand is equal to its expected value.

This solution can alternatively be obtained by solving a DP that returns allocations
x∗n , x∗n−1 , . . . , x∗1 maximizing the minimum FR. By a simple induction argument, given the remaining supply si at period i, this DP maintains the following invariant at each period i (refer to
Appendix A.3 for details):
(
x∗i

= min di , si

di +

P

di

j∈[i+1:n] dj

)


= min di , si

di
di + [total future demand]



.16

(4)

Notably, the above invariant suggests a sequential implementation of the optimal solution at each
P
period i that only uses the knowledge of di (i.e., the current demand at period i) and j∈[i+1:n] dj

(i.e., the total future demand from period i + 1 to n). Now consider a setting with incomplete

information, namely, with only knowledge of the current sample path of the observed demands up
to period i, which we denote by d~[1:i] , (d1 , d2 , . . . , di ). Our PPA policy implements a version of the
above policy by replacing the exact realization of total future demand with the conditional first
moment of this random variable given the current sample path. More precisely:
• Given the remaining supply si , the PPA policy allocates an amount


di
xi = min di , si
(PPA’s update rule)
di + µi+1

of the (divisible) resource to agent i upon their arrival, where


X

µi+1 , Ed∼
dj d~[1:i] 
~ F
~
j∈[i+1:n]

16

For any a, b ∈ N we use [a : b] to refer to the set {a, a + 1, . . . , b} if a ≤ b (and the empty set otherwise).

17

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

Note that the conditional expected future demand µi+1 given all previously-realized demands
d~[1:i] is a function of d~[1:i] ; however, for ease of notation, we use µi+1 without any input arguments.
We remark that the PPA policy is simple, computationally efficient, and solely uses first-moment
knowledge about the future demands. Further, because the allocation decisions of the PPA policy
depend smoothly on the first moment of future demand, these decisions are robust to small changes
in the scale of any marginal distribution. Yet, as we show in Sections 3.3 and 3.5, this simple policy
remarkably achieves the best possible guarantee for both notions of fairness (ex-post and ex-ante),
even though these two notions are quantitatively different whenever n > 1.
We conclude this subsection by highlighting an important technical property of the PPA policy.
Remark 1. The PPA policy can only run out of supply at the end of period i if µi+1 = 0, or
equivalently, only if all future demands d~[i+1:n] are deterministically equal to zero, conditional on
the current realized sample path of demands d~[1:i] . This property holds simply because
si+1 = si − xi ≥ si
3.3.

µi+1
.
di + µi+1

Ex-post Fairness of PPA Policy

In this section, we analyze the ex-post fairness guarantee of our PPA policy. In the following theorem, we show that this simple policy indeed achieves the best possible ex-post fairness guarantee.
Theorem 2 (Ex-post Fairness Guarantee of PPA Policy). Given a fixed number of
agents n ∈ N and supply scarcity µ ∈ R≥0 , the PPA policy achieves an ex-post fairness guarantee
(see Definition 1) of at least κp (µ, n) (defined in eq. (2)).
3.3.1.

Proof of Theorem 2 In order to prove the above theorem, we would have liked to

analyze the evolution of the minimum FR, which we denote with fi at the end of period i − 1, i.e.,
x

i−1
f1 = 1, fi = min{fi−1 , di−1
} for i ∈ [2 : n + 1]. Instead, we consider the evolution of a closely related

stochastic process, which makes the analysis simpler. We define this surrogate stochastic process
as follows:


n+1
β1 , min 1,
nµ



xi−1
βi , min βi−1 ,
, i ∈ [2 : n + 1].
di−1

(5)

First, we note that βi = min{fi , n+1
}, i ∈ [n + 1]. Next, recall that si denotes the remaining supply
nµ

after agent i − 1 arrives and receives an allocation. We observe that under the PPA policy, si evolves
according to

s1 = 1


si = si−1 − min di−1 ,


di−1
si−1 , i ∈ [2 : n].
di−1 + µi

(6)

With the above observations, the main step of the proof is carefully analyzing the evolution of
(βk , sk ) under the PPA policy, which enables us to lower bound the final expected minimum FR in
the following lemma.

18

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

Lemma 1 (Lower Bound on Expected Minimum FR). Under the PPA policy, for all i ∈
[n + 1] and any subsequence of demand realizations d~[1:i−1] ,


h
i
µ
n
+
1
−
i
i
~
βi
(7)
Ed∼
~ F
~ fn+1 | d[1:i−1] ≥ βi 1 −
2(n + 2 − i) si

where βi is defined in eq. (5).17

Since the objective of our dynamic decision-making problem has no per-stage rewards and consists only of a terminal reward (i.e., the minimum FR), Lemma 1 can be thought of as establishing
a lower bound on the value-to-go function of the PPA policy. Before providing the proof for this
key lemma, we lay out the two remaining steps that finish the proof of Theorem 2: (i) plugging
i = 1 into inequality (7) to obtain a lower bound on Ed∼
~ F
~ [fn+1 ], and (ii) scaling the obtained
lower bound result by our benchmark for deterministic demand, namely W = min{1, 1/µ}, which
provides an ex-post fairness guarantee (see Definition 1).

Proof of Lemma 1: We will show that inequality (7) holds via backwards induction. The
base case of i = n + 1 is trivial as it follows from the observation we made earlier: βi = min{fi , n+1
}.
nµ
Now let us consider i = k < n + 1. Instead of proving inequality (7), we prove a stronger result:


h
i
n
+
1
−
k
d
+
µ
k
k+1
~
Ed∼
βk .
(8)
~ F
~ fn+1 | d[1:k] ≥ βk 1 −
2(n + 2 − k)
sk

Establishing inequality (8) means that the inequality in (7) holds for any realization of agent
k’s demand. Consequently, it will hold when we take an expectation over agent k’s demand. In
order to prove inequality (8), we consider two different cases that can arise depending on the
remaining supply sk , agent k’s demand dk , and the future expected demand µk+1 . In the following,
we introduce and analyze these cases separately.
(i) Sufficient supply (sk ≥ βk (dk + µk+1 )): Recall that according to the PPA policy, xk =
min{dk , d

dk
k +µk+1

sk }. Therefore, in this case, either xk = dk , i.e., the PPA policy meets the

entire demand, or xk =

dk
s
dk +µk+1 k

≥ βk dk , i.e., the PPA policy attains an FR of at least βk .

According to the dynamics specified in (5) and (6), this implies
βk+1 = βk

and

µk+1
µk+1
=
sk+1 sk − min{dk , d

dk
sk }
k +µk+1

≤

µk+1
sk −

dk
s
dk +µk+1 k

=

dk + µk+1
.
sk

Using our inductive hypothesis when i = k + 1,


h
i
n−k
dk + µk+1
~
Ed∼
βk , RHS(1) .
~ F
~ fn+1 | d[1:k] ≥ βk 1 −
2(n + 1 − k)
sk

(9)

The lower bound given by RHS(1) is a linear function of dk + µk+1 , as illustrated by the dotted
red lines in all panels of Figure 3 (in the regime where dk + µk+1 ∈ [0, sk /βk ]). This linear
17

If si = 0, then by Remark 1, we must also have µi = 0. In such cases, we take the convention that

µi
si

= 0.

19

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

function has a non-positive slope and an intercept of βk . We can further lower bound this
function for any dk + µk+1 ∈ [0, sk /βk ] by another linear function with the same intercept of

n−k
βk and a smaller (more negative) slope. In particular, since n+1−k
≤ n+1−k
, we have:
n+2−k


n + 1 − k dk + µk+1
(1)
βk ,
RHS ≥ βk 1 −
2(n + 2 − k)
sk

(10)

which proves inequality (8) in the sufficient supply case (see the blue lines in all panels of
Figure 3).
(ii) Insufficient supply (sk < βk (dk + µk+1 )): In this case, the allocation of the PPA policy is
xk =

dk
s ,
dk +µk+1 k

which results in an FR less than βk , i.e.,

xk
dk

=

sk
dk +µk+1

< βk . According to the

dynamics specified in (5) and (6), this implies
βk+1 =

sk
dk + µk+1

and

µk+1
µk+1
=
dk
sk+1 sk − d +µ
k

k+1

sk

=

dk + µk+1
.
sk



, RHS(2) .

Using our inductive hypothesis when i = k + 1,
h

Ed∼
~ F
~ fn+1

i
| d~[1:k] ≥

sk
dk + µk+1



n−k
1−
2(n + 1 − k)

(11)

The lower bound given by RHS(2) is a convex homographic function of dk + µk+1 , as illustrated by
the dashed red lines in all panels of Figure 3 (in the regime where dk + µk+1 ∈ [sk /βk , +∞)). To
further lower bound this function by a linear function, note that for any variable z the following
inequality holds:





2
n+2−k
sk
n + 1 − k βk
(n + 2 − k)sk
(n + 1 − k)βk2
− βk 1 −
z =
−z ≥0 .
2(n + 1 − k) z
2(n + 2 − k) sk
2(n + 2 − k)sk z (n + 1 − k)βk
The proof of the above inequality is purely algebraic and we omit it for brevity. Substituting
z = dk + µk+1 in this inequality, we have:


n + 1 − k dk + µk+1
(2)
βk ,
RHS ≥ βk 1 −
2(n + 2 − k)
sk

(12)

which proves inequality (8) in the insufficient supply case (again, see the blue lines in all panels of
Figure 3).
Combining the above cases proves inequality (8) everywhere, which immediately implies the
inductive hypothesis, i.e., inequality (7), for i = k, thus finishing the proof of the lemma.
3.4.



Simple Non-adaptive Policies and Ex-post Fairness

As discussed in the previous sections, our PPA policy is adaptive, that is, the FR for agent i (and
its corresponding allocation decision) can depend not only on the observed demand di but also on
the exact sample path up to time i as well as the remaining supply si . In contrast to an adaptive

20

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

β1

β2

1
β
2 1

1
β
2 2

s1 5s1
β1 4β1

s2
β2

d1 + µ2

d2 + µ3

β3

β4

1
β
2 3

1
β
2 4

s3
β3

3s3
2β3

d3 + µ4
Figure 3

4s2
3β2

s4
β4

2s4
β4

d4

Lower bounds on the expected minimum FR given by eq. (8) (blue solid lines), eq. (9) (red dotted
lines), and eq. (11) (red dashed lines) when n = 4 for k ∈ [4].

policy, a non-adaptive policy commits to a sequence of feasible allocation maps {xi (di )}i∈[n] upfront,

where xi (di ) ∈ [0, di ] is the allocation decision for agent i when agent i has demand di .18 If the nonadaptive policy’s allocation decision xi (di ) exceeds the remaining supply si , then agent i instead
receives the entire remaining supply.
For settings that we consider, adaptivity can indeed help with improving the expected minimum
FR of a policy. As an example, compare running our PPA policy versus the best non-adaptive
policy on an instance with three agents. In this instance, the demands d~ = (d1 , d2 , d3 ) follow one
of the two possible sample paths (1 , 1, 1) or (2 , 1, 0) with equal probabilities 1/2, where 1 , 2 ≥ 0
and 1 6= 2 . After agent 1’s demand is realized, the PPA policy knows exactly which sample path
is happening. By calculating the exact total demand of agents 2 and 3, it obtains the optimal
expected minimum FR of 21 × 1 + 21 × 12 1= 3/4 for small 1 , 2 . However, a non-adaptive policy cannot
distinguish between the two possible sample paths after agent 1’s demand is realized. Therefore,
18

For ease of presentation, we focus on deterministic non-adaptive policies. This is without loss of generality, as the
ex-post fairness of any randomized non-adaptive policy must be weakly dominated by the ex-post fairness of one of
the deterministic policies that it randomizes over.

21

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

without loss of generality, it targets a FR of τ for agent 2 and obtains an expected minimum FR
of 12 τ + 12 min{τ, 1 − τ } for small 1 , 2 , which attains its maximum equal to

1
2

at any τ ∈ [ 21 , 1].

In applications that allow for adaptivity, our PPA policy obtains the optimal ex-post fairness
guarantee while also having the desirable properties of transparency and interpretability. However, adaptivity is not admissible in some practical scenarios—e.g., when the social planner should
commit to an allocation plan in advance for even more transparency or due to legal restrictions.19
Motivated by such scenarios, we study two simple and natural canonical classes of non-adaptive
policies: those that fix the sequence of allocation decisions a priori, namely they specify one allocation vector ~x, and “smarter” policies which fix the sequence of fill rates ~τ , (τ1 , τ2 , . . . , τn ) a priori.
In Appendix A.4, we show that the ex-post fairness guarantee for the former subclass is vanishing
as n gets large. Therefore, we focus on the latter subclass, which is formally defined as follows.
Definition 2 (Target-fill-rate Policies). A target-fill-rate (TFR) policy is any policy π
which pre-determines a target fill rate τ ∈ [0, 1]. Then, for every arriving agent i, the policy π must
either allocate sufficient supply to meet the target or allocate all remaining supply, i.e.,
∀i ∈ [n] :

xi (si , di ) = min{τ di , si }.

In the following theorem, we provide a tight bound on the ex-post fairness guarantee (Definition 1) achievable by the optimal TFR policy—defined as the one that maximizes ex-post fairness
for the given joint demand distribution. We remark that setting one threshold is without loss
of generality because the ex-post fairness guarantee of a policy which pre-determines a sequence
of target fill rates {τi }i∈[n] is upper bounded by that of a TFR policy with the same target fill
rate τ = mini∈[n] {τi } for all agents. We also highlight that in addition to achieving a lower expost fairness guarantee compared to our adaptive policy, finding the best TFR policy requires full
knowledge of the total demand distribution—in contrast to our PPA policy which only requires
knowing the first conditional moments of the future total demand at each time.
Theorem 3 (Ex-post Fairness Guarantee of Optimal TFR Policy). Given any number
of agents n ∈ N \ {1} and supply scarcity µ ∈ R≥0 , the optimal TFR policy achieves an ex-post
fairness guarantee (see Definition 1) of

max{1,µ}

√

µ+

µ2 +1

.

In Figure 4, we compare the guarantee of the optimal TFR policy against our PPA policy for
different model primitives, µ and n. First, we note that when n is not too large, our PPA policy
achieves a considerably higher guarantee. Next, we highlight that the ex-post fairness guarantee
19

As discussed in the introduction, the initial strategy for allocating medical supplies at the beginning of COVID-19
pandemic had the form of a target-fill-rate policy, which is a canonical non-adaptive strategy as we will discuss soon.

22

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

Ex-post Fairness Guarantee

1.0

0.8

0.6

0.4

PPA Policy, n = 1
PPA Policy, n = 4
PPA Policy, n → ∞
Optimal TFR Policy, n ≥ 1

0.2

0
0

0.5

1.0

1.5

2.0

2.5

3.0

3.5

4.0

Supply Scarcity
Figure 4

Ex-post fairness guarantees of our PPA policy and the optimal TFR policy.

for the optimal TFR policy does not depend on the number of agents n.20 This is in contrast to the
ex-post guarantee for the PPA policy κp (µ, n), which worsens as the number of agents increases.
Furthermore, the guarantee in Theorem 3 has a unique minimum of

1√
1+ 2

≈ 0.41 when µ = 1. This

once again suggests that the stochastic nature of demand is most harmful when expected demand
exactly equals supply.
3.4.1.

Proof of Theorem 3 We begin by placing a lower bound on the performance of the

optimal TFR policy, and we then demonstrate the existence of a matching upper bound.
Proof of lower bound: For any target fill rate τ , a TFR policy will achieve that fill rate if
P

τ
d
i∈[n] i ≤ 1. Let us define G as the cumulative distribution function (CDF) of the random
 
variable v , P 1 di , where Ev∼G v1 = µ. For ease of notation, we use ∆ (R≥0 ; µ) to denote the
i∈[n]

domain of all such CDFs. Given a CDF G, a TFR policy with target fill rate τ achieves an expected
minimum fill rate of at least τ (1 − G(τ )), which implies that the optimal TFR policy attains an

expected minimum fill rate of at least maxτ ∈[0,1] τ (1 − G(τ )). In the following lemma, we establish
a lower bound on maxτ ∈[0,1] τ (1 − G(τ )), which enables us to lower-bound the ex-post fairness
guarantee that the optimal TFR policy achieves.

Lemma 2 (Tight Lower Bound for Optimal TFR Policy). Given a fixed number of
agents n ∈ N and supply scarcity µ ∈ R≥0 , the following holds:


1
√ 2
inf
max
.
1 τ (1 − G(τ )) =
τ ∈[0,1]
µ+ µ +1
G∈∆(R≥0 ;µ)
20

(13)

We elaborate on the intuition behind this behavior when we present the hard instance for establishing the upper
bound of Theorem 3.

23

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

This infimum is attained by the following CDF

0


1 − q̂/v
Ĝ(v) =
1

 − q̂
1
where q̂ =

√1

µ+

µ2 +1

if
if
if
if

v ∈ [0, q̂)
v ∈ [q̂, 1)
v ∈ [1, +∞)
v = +∞

(14)

.

Before presenting the proof of the above lemma in Section 3.4.2, which is the key step of the proof
of Theorem 3, we establish a matching upper bound and complete the proof of the theorem.
Proof of upper bound: We show a matching upper bound by considering a two-agent
instance. In this instance, only the first agent has stochastic demand. In particular, d1 =

1−
v

for

v ∼ Ĝ (defined in eq. (14)) and d2 = µ deterministically. Note that E[d1 + d2 ] = µ. For any target
fill rate τ 0 = (1 − )τ where τ ∈ [0, 1], supply will be exhausted before the arrival of agent 2 with

probability Ĝ(τ ), in which case the minimum FR will be 0. Therefore, the expected minimum fill
rate of the optimal TFR policy in this instance is at most


max (1 − )−1 τ 1 − Ĝ(τ ) = (1 − )−1
τ ∈[0,1]

1
√
,
µ + µ2 + 1

where the equality follows from Lemma 2.

By allowing  → 0, we conclude that there exists an instance where the expected minimum fill

rate of the optimal TFR policy is

√1

µ+

µ2 +1

, which matches the lower bound from above. We remark

that the construction of the above two-agent example clarifies why our upper bound does not
depend on the number of agents: we can modify the example to an n-agent one where the total
demand of the first n − 1 agents have correlated demand equal to

has a deterministic demand of µ.

1−
v

for v ∼ Ĝ and the last agent

With the above (matching) bounds, we complete the proof of Theorem 3 by scaling this tight
bound by our benchmark for deterministic demand, namely W = min{1, 1/µ}, to arrive at the
guarantee stated in Theorem 3.
3.4.2.



Proof of Lemma 2 and Connections to Monopoly Pricing Having laid out the

proof steps of Theorem 3, we now provide a constructive proof of the key lemma, i.e., Lemma 2.
We do so by identifying properties of the worst-case distribution against the optimal TFR policy,
which enables us to exactly characterize that distribution.
To aid in this proof, we introduce a one-to-one mapping of each target fill rate τ into the
quantile space, such that quantile q corresponds to TFR τ if and only if there is sufficient supply
to meet a fraction τ of demand with probability exactly q. We start by describing notation for
this transformation, along with some basic properties, in the following definition. For simplicity of
exposition, we assume all the distributions playing the role of G are non-atomic.21
21

This assumption is without loss of generality, as one can always add an infinitesimal continuous perturbation to
each distribution, which does not change any of the arguments in this proof.

24

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

(a)
Figure 5

(b)

(a) The expected achievable fill rate (EAFR) curve, fill rates, and support in quantile space. (b) The
EAFR curve of the worst-case distribution, as defined in eq. (14), in quantile space.

Definition 3 (TFR in Quantile Space). Given a (non-atomic) CDF G : R≥0 → [0, 1] and

inverse total demand v ∼ G, we define the following mappings.

• TFR-to-quantile map QG : The quantile corresponding to TFR τ ∈ [0, 1] is QG (τ ) , 1 − G(τ ).

In words, the probability of being able to meet a fraction τ of total demand is QG (τ ). This
map is monotone non-increasing.

• Quantile-to-TFR map T G : The TFR corresponding to quantile q ∈ [0, 1] is T G (q) , G−1 (1 − q).

In words, T G (q) is the TFR for which the probability of being able to meet a fraction T G (q)

of total demand is q. This map is monotone non-increasing and is the inverse of the TFR-to−1

quantile map, i.e., T G = (QG ) .
• The expected achievable fill rate (EAFR) curve RG : For q ∈ [0, 1], RG (q) , q · G−1 (1 − q) is the

EAFR when the probability of meeting demand (given the TFR) is exactly equal to q ∈ [0, 1],

i.e., the EAFR obtained by targeting a fill rate T G (q).

Remark 2. In light of the above transformation, we remark that there is a reduction from our
setup to a single-parameter Bayesian mechanism design problem in which a monopolistic seller
has an item to sell to a single buyer with private valuation v ∼ G, where G is the common prior
valuation distribution. See Alaei et al. (2019) for an example of such a setting; also refer to Hartline
(2013) for more details on monopoly pricing. In this reduction, target fill rates correspond to prices
and the EAFR corresponds to the expected revenue in monopoly pricing (accordingly, the EAFR
curve also corresponds to the revenue curve). The problem in this parallel monopoly pricing setting
is identifying the worst-case distribution G satisfying Ev∼G [1/v] = µ, so that we minimize the
maximum revenue obtained from selling the item at prices constrained to be in the interval [0, 1].

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

25

According to Definition 3, τ (1 − G(τ )) is equivalent to RG (QG (τ )) for any TFR τ ∈ [0, 1]. Based
on this insight, to prove Lemma 2, it is sufficient to show that


1
G
√ 2
inf
max
R (q) =
.
G
q∈[0,1]:T (q)∈[0,1]
µ+ µ +1
G∈∆(R≥0 ;µ)

(15)

Consider all cumulative distribution functions G ∈ ∆ (R≥0 ; µ). We first identify two additional
constraints on G that do not change the infimum in eq. (15). These constraints enable us to find
the worst-case distribution that achieves the infimum value which establishes the desired result.
Before proceeding, we develop intuition using an illustrative example of the EAFR curve shown
in Figure 5(a). In general, if one draws RG (q) as a function of q ∈ [0, 1] (i.e., in the quantile space),
then the slope of the line connecting the point (0, 0) to (q, RG (q)) is equal to T G (q) = RG (q)/q. This
slope is monotone non-increasing in q for any CDF G according to Definition 3. Hence, given the
G
EAFR curve
of the feasible fill rates is equal to [L, H], where L , RG (1) and
 R (q), the support

H , min 1, lim inf RG (q)/q . The two constraints that we will add below, as stated in Claims 1
q→0

and 2, imply that the outer optimization problem in eq. (15) will remain unchanged if we require

the EAFR curve to be (i) flat over quantiles corresponding to target fill rates in [L, 1], i.e., quantiles
in the interval [QG (1), 1], and (ii) a straight line with slope 1 for quantiles in the interval [0, QG (1)].
With these two additional constraints, in Claim 3 we find the worst-case CDF, which has an EAFR
curve as shown in Figure 5(b).
Claim 1 (Equal EAFR). Adding the constraint RG (q) = RG (q 0 ), ∀q, q 0 ∈ [QG (1), 1] to the outer
optimization in eq. (15) does not change its infimum value.
We prove Claim 1 by contradiction: we show that for any CDF G ∈ ∆ (R≥0 ; µ), if the above condition

does not hold, we can slightly modify G to design a new distribution G̃ ∈ ∆ (R≥0 ; µ) which has

an EAFR curve with a lower maximum value. The details are presented in Appendix A.5.1. The
above claim readily implies that we can focus on distributions for which the EAFR curve is flat in
the interval [QG (1), 1].
Next, we claim that we can restrict our attention to distributions where there is no probability
mass for v ∈ (1, +∞). Said differently, the support of inverse demand is (0, 1] ∪ {+∞}.
Claim 2 (Restricted Support for Inverse Demand). Adding the constraint G(v) = G(1)
for all v ∈ [1, +∞) and limv→+∞ G(v) = 1 to the outer optimization in eq. (15) does not change its
infimum value.
We also prove Claim 2 by contradiction: we show that for any CDF G ∈ ∆ (R≥0 ; µ), if there is

probability mass on v ∈ (1, +∞), we can construct a CDF G̃ ∈ ∆ (R≥0 ; µ) which has an EAFR

curve with a lower maximum value by shifting that mass to +∞. The details are presented in

26

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

Appendix A.5.2. Again, note that this claim implies that we can focus on distributions for which
the EAFR curve starts with a straight line up to quantile QG (1).
Given the two claims above, the distribution that attains the infimum in eq. (15) must satisfy the
two constraints introduced. Figure 5(b) summarizes the effect of these two restrictions on RG (q).
Claim 3 (Worst-case CDF). For any µ ∈ R≥0 , the distribution Ĝ given in eq. (14) is the
unique distribution in ∆ (R≥0 ; µ) satisfying the constraints introduced in Claims 1 and 2. Therefore,
this distribution attains the infimum in eq. (15).
We prove Claim 3 in Appendix A.5.3. Since the EAFR curve RĜ (q) has a maximum value of
q̂ =

√1

µ+

µ2 +1

, we have shown that the optimal TFR policy always achieves an EAFR of at least q̂.

This completes the proof of Lemma 2.
3.5.



Ex-ante Fairness

In this section, we study our second notion of fairness, namely, ex-ante fairness. As we did for
ex-post fairness, we first establish an upper bound on the ex-ante fairness guarantee achievable by
any policy. More importantly, we then show that our PPA policy achieves this worst-case ex-ante
fairness bound. The following theorem establishes our matching upper and lower bounds on the
ex-ante fairness guarantee.
Theorem 4 (Ex-ante Fairness Guarantee of PPA Achieves Upper Bound). Given

a

fixed number of agents n ∈ N and supply scarcity µ ∈ R≥0 , no sequential allocation policy obtains
an ex-ante fairness guarantee (see Definition 1) greater than κa (µ, n), defined as

µ

1 − 4 ,  µ ∈ [0, 1)
.
κa (µ, n) = µ 1 − µ4 , µ ∈ [1, 2)

1,
µ ∈ [2, +∞)

(16)

Further, the PPA policy achieves an ex-ante fairness guarantee of at least κa (µ, n).
Like its counterpart for ex-post fairness, κa (µ, n) depends on the supply scarcity, µ, and is at its
lowest when expected demand equals supply, which highlights the loss due to stochasticity when
trying to achieve efficiency and equity ex ante. However, unlike the bound for ex-post fairness, the
ex-ante fairness bound is independent of the number of agents. In fact, this bound is identical to
the ex-post fairness bound in the single-agent case, i.e. κa (µ, n) = κp (µ, 1) (which is shown by the
dotted line in Figure 4).
For intuition about this relationship, note that one feasible policy is to allocate supply to each
agent proportional to their expected demand. Since the ex-ante problem only depends on marginal
FRs, this reduces ex-ante fairness to the minimum ex-ante fairness across n single-agent instances
(where in each instance, the supply scarcity is µ). In a single-agent instance, ex-ante fairness is

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

27

equal to ex-post fairness, which implies that any lower bound on single-agent ex-post fairness also
serves as a lower bound on ex-ante fairness with n agents. Furthermore, since demands can be
perfectly correlated, any single-agent instance can be expressed as an instance with n agents for
any n ∈ N. This implies that any upper bound on single-agent ex-post fairness also serves as a
upper bound on ex-ante fairness with n agents.
To prove the upper bound in Theorem 4, we build on the hard instances from the proof of
Theorem 1. To prove the lower bound, we use ideas similar to the proof of Theorem 2. We show
that when following the PPA policy, the expected FR for each agent is a decreasing and convex
function of the ratio of expected remaining demand to remaining supply upon their arrival. We
inductively place an upper bound on the ex-ante expected value of that ratio for each agent, which
enables us to provide a lower bound on ex-ante fairness. See Appendix A.6 for a detailed proof.

4.

Numerical Results

We complement our theoretical developments with an illustrative case study motivated by the
allocative challenges that FEMA faced when rationing COVID-19 medical supplies in the early
days of the pandemic in the US. First, we provide background on the sequential and heterogeneous
nature of the demand from different states. Then, we study this dynamic rationing problem within
our framework and illustrate the effectiveness of our PPA policy by comparing it to its theoretical
guarantee, to the optimal TFR policy, and to a DP approach.
4.1.

Background and Model Primitives

The U.S. federal government is equipped with a stockpile of medical resources which can be used to
alleviate excessive demands on states’ local resources. However, the stockpile is intended to address
isolated emergencies in a small number of states, not a nationwide epidemic. Thus, due to COVID19, the total demand for certain resources was expected to far exceed the federal government’s
stockpile. Given the uneven spread of COVID-19 toward the outset of the pandemic, different
states’ needs were expected to realize at different times. Furthermore, the size of the demands were
likely to be correlated across states. When states with early outbreaks began requesting supplies,
FEMA had to determine how much of the federal stockpile they should allocate and how much
they should save to meet the projected future needs of other states.22
To capture the setting faced by FEMA, we draw upon the projections made by the Institute for
Health Metrics and Evaluation (IHME) at the University of Washington as of April 1, 2020.23 These
projections were cited by Dr. Deborah Birx (the White House Coronavirus Response Coordinator)
22

In mid-March, FEMA took control of the stockpile and was tasked with distributing medical supplies.

23

The data can be found at http://www.healthdata.org/covid/data-downloads.

28

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

as influencing decision-making at that time (Washington Post 2020b). We use each state’s projected
peak excess demand for ICU beds as a proxy for their demand for medical supplies. The scale and
timing of the projected peak demand varied significantly from state to state. To succinctly present
the temporal aspect of states’ demands, we partition them into four groups based on when their
peak demand was projected to occur: April 1st -7th , April 8th -14th , April 15th -21st , and after April
21st . We visualize this partitioning in the map in the left panel of Figure 6(a).
Next, we describe how we construct the demand distributions for the aforementioned groups. We
remark that the IHME’s projections only consist of the estimated mean as well as estimated 5th
and 95th percentiles for each individual state. Said differently, the model does not specify a joint
(or even marginal) distribution for the demand. Consequently, we augment the model by assuming
that the aggregate demand in each group i ∈ [4] is Normally distributed with mean equal to the
IHME’s total estimated mean for the states belonging to group i. The standard deviation for group
i’s demand distribution is set such that the 5th percentile of demand is equal to the 5th percentile
of projected peak excess demands for ICU beds from all states in group i. Summary statistics
about the demand distributions are presented in the right panel of Figure 6(b).24 We highlight the
significant heterogeneity in both the mean and the standard deviation across these four groups.
Finally, we construct the joint distribution for these four groups by letting all of the pairwise
correlation coefficients equal ρ, where ρ ∈ {0, 0.25, 0.5, 0.75}.25 The limited number of groups and
simple model of correlated demand allow us to compare the PPA policy against a DP solution with
manageable computing time, as we discuss in the following subsection.
4.2.

Policy Evaluation

For the setup described above, we numerically evaluate the performance of various policies. In the
simulations, we consider three values for supply scarcity (1, 2, and 4) by setting the initial supply
relative to the sum of expected demand across the four groups according to the IHME model.
Then, fixing the correlation coefficient ρ ∈ {0, 0.25, 0.5, 0.75}, we generate 10,000 sample paths for
the purpose of Monte-Carlo simulation.
For each sample path, we compute the minimum FR of the following policies: (i) our PPA policy, (ii) the optimal TFR policy (defined in Section 3.4), and (iii) the solution to a DP computed
by discretizing the state space, which consists of the remaining supply, the current demand, the
minimum FR, and the distribution of future (i.e., remaining) demand given the observed demand
thus far. We choose the discretization level such that each DP can be solved in under three hours
24

In rare cases, the demand drawn from the described Normal distributions can be negative. In such cases, we assume
the demand is 0.
25

In this context, we focus on different levels of positive correlation to capture network effects during the pandemic,
e.g., virus transmission across state borders.

29

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

Group Mean Demand Std. Dev.
1
2
3
4

(a)
Figure 6

15,366
2193
9719
3831

3287
710
3600
1763

(b)

(a) The allocation group for each state, which is based on the projected timing of excess demand for
ICU beds. (b) Summary of the demand distribution for each group of states.

on Google’s Compute Engine. In Table 1, we present the average ex-post fairness for the aforementioned policies along with the PPA policy’s theoretical guarantee for ex-post fairness (as given in
Theorem 2).26 We make three key observations:
• PPA vs. Guarantee: In all cases, our policy performs more than 33% better than its the-

oretical guarantee. In addition, in over-demanded settings our policy performs better when
the correlation is higher because it leverages the information provided by realized demands.
However, when supply is equal to expected demand, the extra information can be outweighed
by the strain that correlated demands place on the available supply.
• PPA vs. Optimal TFR: Our PPA policy outperforms the optimal TFR policy by between

7% and 28%. As we would expect, the gap is largest when there is correlation between demands
since TFR policies do not take advantage of the information that can be extracted from
realized demands. Correlation between demands is likely strong during a nationwide epidemic,
implying that our PPA policy is better suited than the optimal TFR policy in such situations.
• PPA vs. DP: The solution to the DP, despite being challenging to compute even in this

simple setting, exhibits nearly identical performance to the PPA policy.
Moving beyond the performance comparison, we highlight that the PPA policy can be implemented simply by knowing the expected remaining demand, which was frequently updated by the
26

We remark that ex-post fairness is well-concentrated around its average value for all of the considered policies.

1

30

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

IHME. In contrast, determining the optimal TFR policy or solving the DP requires full distributional information, which was not provided by the IHME. Further, regarding the DP solution, we
remark that our distributional assumptions (four agents and a simple correlation structure across
demands) make it possible to solve such a DP with a granular state space in a reasonable amount
of time. However, we emphasize that in other settings, particularly those with a more complicated
correlation structure, such an approach may not be practical. The solution to the DP also suffers
from two additional shortcomings: it achieves consistently worse ex-ante fairness than the PPA
policy (by an average of 6%), and its allocation is not transparent. Transparency is particularly
important in this setting, as numerous states questioned the allocation procedures implemented by
the federal government (see Footnote 1 for one such example). Similar to TFR policies, the PPA
policy follows a strategy that can be easily explained to stakeholders.
Supply Scarcity (µ)
2

4

Demand Correlation (ρ) 0.00 0.25 0.50 0.75

0.00 0.25 0.50 0.75

0.00 0.25 0.50 0.75

PPA Policy
PPA Guarantee
Opt. TFR Policy
DP Solution

0.84 0.85 0.87 0.92
0.625
0.79 0.76 0.74 0.72
0.85 0.87 0.89 0.92

0.84 0.85 0.87 0.91
0.625
0.79 0.76 0.74 0.72
0.86 0.86 0.89 0.92

1

Table 1

0.85 0.85 0.85 0.86
0.600
0.79 0.76 0.74 0.72
0.85 0.85 0.85 0.86

Ex-post fairness of three policies across 10,000 simulations of the setting described in Figure 6(b), as
well as the ex-post fairness guarantee of the PPA policy.

5.

Concluding Remarks, Extensions, and Future Directions

We conclude the paper by first summarizing our main findings, and then elaborating on a few
extensions of our base framework. We finish by listing a few future directions.
5.1.

Summary

In this paper, we initiate the theoretical study of fair dynamic rationing by introducing a simple
yet fundamental and well-motivated framework. In a nutshell, we design sequential policies for
allocating limited supply to a sequence of arbitrarily correlated demands given an objective which
encompasses the dual goals of efficiency and equity. Based on our formalized notions of ex-post and
ex-ante fairness, we establish upper bounds on the fairness guarantees achievable by any sequential
allocation policy which depend on the supply’s scarcity level and the number of demanding agents.
More importantly, we show that our simple PPA policy achieves the “best of both worlds” by
attaining the upper bound on both the ex-post and ex-ante fairness guarantees. In addition to
enjoying optimal fairness guarantees, our PPA policy is practically appealing: it is interpretable

31

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

as well as computationally efficient since it does not rely on distributional knowledge beyond the
conditional first moments.
Our framework lends itself to extensions such as considering generalized objectives and rationing
multiple types of resources. More broadly, it serves as a base model for theoretically studying
sequential allocation problems with an objective beyond utility maximization, which in turn opens
several new research directions. In the rest of this section, we first discuss the aforementioned
extensions of our base model and then finish the paper by discussing future directions.
5.2.

Extensions

5.2.1.

Generalized Social Welfare Objective Functions Throughout the paper, we have

focused on the minimum FR as a social welfare objective that combines elements of equity and
efficiency (i.e., U (~x) = mini∈[n] { xdii }). However, this social welfare function—which is also known
as the Rawlsian social welfare function thanks to the philosophical work of John Rawls (1973)—is
only a special case of a more general class of social welfare functions that we call the weighted
power mean (WPM) social welfare family of functions. More precisely, this family is parameterized
by α ∈ [0, +∞) and defined as

Uα (~x) ,


 1−α 1/(1−α)

P

xi
1

P
,

i∈[n] di di

i∈[n] di




Q

i∈[n]

 di / Pi∈[n] di
xi
di

,

α 6= 1

(17)

α=1

Note that the above is a weighted version of the celebrated power mean functions, introduced
in Atkinson et al. (1970), that provides a broad class of social welfare functions which balance
equity and efficiency to varying degrees. Having weights proportional to the demands in eq. (17)
ensures that equity is measured relative to demand and not simply based on the absolute allocation.27 By varying the parameter α from 0 to +∞, the focus of the planner is shifted from extreme
efficiency towards more equitable allocations. When α = 0, a utilitarian allocation (i.e., any allocation without waste) maximizes social welfare. In the limit as α → 1, proportional fairness (i.e.,
a generalization of the Nash bargaining solution) maximizes social welfare. Finally, in the limit as
α → +∞, maximizing the minimum FR maximizes social welfare. In fact, we highlight that the
value of this social welfare function exactly approaches our objective in the base model (i.e., the
minimum FR, or equivalently, the Rawlsian social welfare function).
For any parameter α (including when α → +∞, which corresponds to our base model), the
optimal policy when demands are deterministic is to allocate the supply proportionally. Such a
27

Further, this family of functions has a one-to-one relationship with the α-fairness social welfare functions introduced
in Mo and Walrand (2000). In fact, the two families of functions are the same up to a transformation via a one-to-one,
increasing function, which means that the maximizing vectors are identical for a given α.

32

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

policy achieves the optimal social welfare of W (defined in eq. (1)).28 However, the value of the
parameter α impacts the optimal policy when demands are stochastic. To study this impact, we
naturally generalize our notion of ex-post fairness to WPM social welfare functions, i.e., ex-post
fairness is given by Ed∼
~ F
~ [Uα ] /W . We remark that in the limit as α → +∞, this is equivalent to
the notion of ex-post fairness introduced in Section 2. In the following corollary of Theorem 2, we
establish that our PPA policy achieves an ex-post fairness guarantee of at least κp (µ, n) for any
α ∈ [0, +∞).
Corollary 1 (PPA’s Guarantee for WPM Objectives). Given a fixed number of agents
n ∈ N, supply scarcity µ ∈ R≥0 , and any α ∈ [0, +∞), the PPA policy achieves an ex-post fairness
guarantee of at least κp (µ, n) (defined in eq. (2)) when social welfare is measured by a WPM function
(defined in eq. (17)) with parameter α.
We prove Corollary 1 in Appendix B.1.
5.2.2.

Rationing Multiple Types of Resources In our base model, we assume that agents

have demand for only a single type of resource. However, in many of the motivating applications
that we consider, agents may have concurrent demand for multiple types of resources. For example,
states may need many different types of medical supplies during the peak of a pandemic.
Our setup readily extends to the sequential allocation of m different resource types where an
arriving agent simultaneously demands m types of supply. We allow the demands to be correlated
across agents as well as resource types. For the sake of brevity, we refrain from repeating the setup
and we simply augment our notation for various quantities (e.g., supply, demand, and allocation)
by adding a superscript j ∈ [m]. In this generalized model, we define agent i’s utility to be their
weighted FR, defined as:
X

λj

j∈[m]

where we normalize the weights λj to satisfy

P

xji
,
dji

j∈[m] λ

(18)
j

= 1. A simple corollary of Theorem 2, as

stated below, ensures that independently following our PPA policy for each resource achieves a
lower bound on the expected minimum weighted FR which is a weighted sum of the expected
minimum FR guaranteed by the PPA for one resource, i.e. κp (µj , n) max{1, µj } for resource j.
28

Note that in a deterministic setting, maximizing any social welfare objective function as in eq. (17) is a concave
maximization. By writing KKT conditions it n
is not hard to
o see that any such function attains its maximum at a
feasible proportional allocation, i.e., xi = min di , P di dj , under deterministic demands. The maximum is then
j∈[n]

equal to W = min{1, 1/µ}.

33

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

Corollary 2 (PPA’s Guarantee on Expected Minimum Weighted FR). Consider
any instance with n ∈ N agents and m ∈ N resources, where the initial supply for resource j
~ ∈ ∆(Rn×m ),
is sj ∈ R≥0 . For any joint demand distribution over all agents and resources F
≥0

independently following the PPA policy for each resource achieves an expected minimum weighted
n jo
 j 
P
µ
j
,
n
max
1, µsj , where µj ∈ R≥0 is the
FR (as defined in eq. (18)) of at least
λ
κ
p sj
j∈[m]
expected total demand for resource j.

In addition, since demand can be correlated across agents, we can re-use the hard instances of
Theorem 1 to construct a joint distribution which establishes an upper-bound on the performance
of any policy matching the lower bound given in Corollary 2. We state this upper bound as a
corollary of Theorem 1 below.
Corollary 3 (Upper Bound on Expected Minimum Weighted FR). For any n ∈ N

agents, m ∈ N resources, and any initial supply for resource j of sj ∈ R≥0 , there exists a joint
~ ∈ ∆(Rn×m ) for which no policy can achieve
demand distribution over all agents and resources F
≥0
 j 
n jo
P
j
an expected minimum weighted FR greater than j∈[m] λ κp µsj , n max 1, µsj , where µj ∈ R≥0
is the expected total demand for resource j.

Together, these two corollaries (which we prove in Appendix B) establish that independently
following the PPA policy for each resource j provides the best possible guarantee on the expected
minimum weighted FR. Consequently, we can use our PPA policy to shed light on how the social
planner can prepare for demand across multiple types of resources. If the initial endowment of
different resource types is not exogenously set, then the social planner can solve an outer endowment
optimization problem to maximize the guarantee on the expected minimum weighted FR subject
to a budget constraint.
We remark that such an endowment optimization problem is a max-max-min problem where
the social planner first optimizes the initial endowment across resource types subject to a budget
constraint (the outer problem). Then, given the initial endowment, the social planner maximizes
over policies the minimum over demand distributions of our objective, i.e., the expected minimum
weighted FR among agents. We solve the outer maximization of the multiple resource-type problem by determining the optimal initial endowment across resource types when the social planner
independently follows the PPA policy for each resource. To be concrete, suppose the social planner
has a fixed budget B that can be used to procure an initial endowment ~s = (s1 , s2 , . . . , sm ). Further, suppose the per unit cost of resource j ∈ [m] is cj . Then, the outer endowment optimization
problem can be formulated as follows:


 j 
X
µ
µj
j
max
λ κp
, n max 1, j
sj
s
~s ∈ Rm
≥0
j∈[m]
X
B ≥
cj sj
j∈[m]

s.t.
(Endowment Optimization)

34

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

We highlight that to formulate this optimization problem, we crucially use the parameterized
characterization of the ex-post fairness guarantee in Theorem 2, as opposed to the worst-case
guarantee for any set of parameters. Further, we remark that the above maximization problem is
linearly separable and concave in the decision variables ~s, meaning that it can be solved efficiently.29
Based on Corollaries 2 and 3, the optimal solution ~s∗ , combined with independently implementing
the PPA policy for each resource, is indeed the optimal solution of the max-max-min multiple
resource-type problem.
5.3.

Future Directions

Our paper can be viewed as an analog of the classic prophet inequality problem (Krengel and
Sucheston 1978, Samuel-Cahn et al. 1984) for equitably allocating divisible goods. As such, similar
to prophet inequalities, many interesting variants of our setting arise. We discussed two such variants above, and for both, we established an achievable lower bound by employing our PPA policy.
However, in the former variant, we do not establish a matching upper bound. Establishing tight
bounds on the achievable performance in such a setting—which may require the use of a different policy—is an interesting direction for future research. Further, understanding the inefficiency
(unused supply) which may occur in sequential allocation due to our focus on an egalitarian objective is a fruitful research direction that we plan to pursue. Finally, here we made no assumption
about the correlation structure underlying the demand sequence. It would be compelling to investigate whether including a (well-motivated) correlation structure can result in improved fairness
guarantees.

Acknowledgment
The authors would like to thank Itai Ashlaghi, Amin Saberi, and Ed Kaplan for helpful comments
and insights at early stages of this work.

References
Nikhil Agarwal, Itai Ashlagi, Michael A Rees, Paulo J Somaini, and Daniel C Waldinger. An empirical
framework for sequential assignment: The allocation of deceased donor kidneys. Technical report,
National Bureau of Economic Research, 2019.
Shipra Agrawal and Nikhil R Devanur. Fast algorithms for online stochastic convex programming. In
Proceedings of the twenty-sixth annual ACM-SIAM symposium on Discrete algorithms, pages 1405–
1424. SIAM, 2014.
Saeed Alaei. Bayesian combinatorial auctions: Expanding single buyer mechanisms to many buyers. SIAM
Journal on Computing, 43(2):930–972, 2014.
 j 
n
o
j
It is not difficult to check that the function κp µsj , n max 1, µsj is concave in sj for any choice of µj and n;
check eq. (2) for a definition of κp (·, ·). We omit this purely algebraic proof for brevity.
29

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

35

Saeed Alaei, Jason Hartline, Rad Niazadeh, Emmanouil Pountourakis, and Yang Yuan. Optimal auctions
vs. anonymous pricing. Games and Economic Behavior, 118:494–510, 2019.
Jerry Anunrojwong, Krishnamurthy Iyer, and Vahideh Manshadi. Information design for congested social
services: Optimal need-based persuasion. arXiv preprint arXiv:2005.07253, 2020.
Nick Arnosti and Peng Shi. Design of lotteries and wait-lists for affordable housing allocation. Management
Science, 66(6):2291–2307, 2020. doi: 10.1287/mnsc.2019.3311.
Kenneth Joseph Arrow. Social Choice and Individual Values. Yale University Press, 1963.
Itai Ashlagi, Patrick Jaillet, and Vahideh H Manshadi. Kidney exchange in dynamic sparse heterogenous
pools. arXiv preprint arXiv:1301.3509, 2013.
Itai Ashlagi, Maximilien Burq, Patrick Jaillet, and Vahideh Manshadi. On matching and thickness in heterogeneous dynamic markets. Operations Research, 67(4):927–949, 2019.
Anthony B Atkinson et al. On the measurement of inequality. Journal of economic theory, 2(3):244–263,
1970.
Yossi Azar, Niv Buchbinder, and Kamal Jain. How to allocate goods in an online market? In European
Symposium on Algorithms, pages 51–62. Springer, 2010.
Santiago Balseiro, Haihao Lu, and Vahab Mirrokni. The best of many worlds: Dual mirror descent for online
allocation problems. arXiv preprint arXiv:2011.10124, 2020.
Santiago R Balseiro and David B Brown. Approximations to stochastic dynamic programs via information
relaxation duality. Operations Research, 67(2):577–597, 2019.
Mohammad Hossein Bateni, Yiwei Chen, Dragos Florin Ciocan, and Vahab Mirrokni. Fair resource allocation
in a volatile marketplace. In Proceedings of the 2016 ACM Conference on Economics and Computation,
pages 819–819, 2016.
Dimitris Bertsimas, Vivek F Farias, and Nikolaos Trichakis. The price of fairness. Operations research, 59
(1):17–31, 2011.
Dimitris Bertsimas, Vivek F Farias, and Nikolaos Trichakis. On the efficiency-fairness trade-off. Management
Science, 58(12):2234–2250, 2012.
Dimitris Bertsimas, Vivek F Farias, and Nikolaos Trichakis. Fairness, efficiency, and flexibility in organ
allocation for kidney transplantation. Operations Research, 61(1):73–87, 2013.
William Cai, Johann Gaebler, Nikhil Garg, and Sharad Goel. Fair allocation through selective information
acquisition. In Proceedings of the AAAI/ACM Conference on AI, Ethics, and Society, pages 22–28,
2020.
Andre P Calmon, Florin D Ciocan, and Gonzalo Romero. Revenue management with repeated customer
interactions. Management Science, 2020.
Semih Cayci, Swati Gupta, and Atilla Eryilmaz. Group-fair online allocation in continuous time. Advances
in Neural Information Processing Systems, 33, 2020.
Bhaskar Ray Chaudhury, Jugal Garg, and Kurt Mehlhorn. Efx exists for three agents. In Proceedings of the
21st ACM Conference on Economics and Computation, pages 1–19, 2020.
Dragos Florin Ciocan and Vivek Farias. Model predictive control for dynamic resource allocation. Mathematics of Operations Research, 37(3):501–525, 2012.

36

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

Maxime Cohen, Adam N Elmachtoub, and Xiao Lei. Price discrimination with fairness constraints. Available
at SSRN 3459289, 2019.
Kate Donahue and Jon Kleinberg. Fairness and utilization in allocating resources with uncertain demand.
In Proceedings of the 2020 Conference on Fairness, Accountability, and Transparency, pages 658–668,
2020.
Ohad Eisenhandler and Michal Tzur. The humanitarian pickup and distribution problem. Operations
Research, 67(1):10–32, 2019.
Ezekiel J. Emanuel, Govind Persad, Ross Upshur, Beatriz Thome, Michael Parker, Aaron Glickman, Cathy
Zhang, Connor Boyle, Maxwell Smith, and James P. Phillips. Fair allocation of scarce medical resources
in the time of covid-19. New England Journal of Medicine, 382(21):2049–2055, 2020. doi: 10.1056/
NEJMsb2005114. URL https://doi.org/10.1056/NEJMsb2005114.
Moran Feldman, Ola Svensson, and Rico Zenklusen. Online contention resolution schemes. In Proceedings
of the twenty-seventh annual ACM-SIAM symposium on Discrete algorithms, pages 1014–1033. SIAM,
2016.
Rupert Freeman, Nisarg Shah, and Rohit Vaish. Best of both worlds: Ex-ante and ex-post fairness in resource
allocation. arXiv preprint arXiv:2005.14122, 2020.
Aram Grigoryan. Effective, fair and equitable pandemic rationing. Available at SSRN 3646539, 2020.
Swati Gupta and Vijay Kamble. Individual fairness in hindsight. In Proceedings of the 2019 ACM Conference
on Economics and Computation, pages 805–806, 2019.
Jason D Hartline. Mechanism design and approximation. Book draft. October, 122, 2013.
Nicole Immorlica, Sahil Singla, and Bo Waggoner. Prophet inequalities with linear correlations and augmentations. In Proceedings of the 21st ACM Conference on Economics and Computation, pages 159–185,
2020.
Stefanus Jasin and Sunil Kumar. A re-solving heuristic with bounded revenue loss for network revenue
management with customer choice. Mathematics of Operations Research, 37(2):313–345, 2012.
Jiashuo Jiang, Shixin Wang, and Jiawei Zhang. Achieving high individual service-levels without safety stock?
optimal rationing policy of pooled resources. Optimal Rationing Policy of Pooled Resources (May 2,
2019). NYU Stern School of Business, 2019.
Edward H Kaplan. Managing the Demand for Public Housing. PhD thesis, Massachusetts Institute of
Technology, 1984.
Ulrich Krengel and Louis Sucheston. On semiamarts, amarts, and processes with finite value. Probability on
Banach spaces, 4:197–266, 1978.
Euiwoong Lee and Sahil Singla. Optimal online contention resolution schemes via ex-ante prophet inequalities. In 26th Annual European Symposium on Algorithms (ESA 2018). Schloss Dagstuhl-LeibnizZentrum fuer Informatik, 2018.
Jacob D. Leshno. Dynamic matching in overloaded waiting lists. Technical report, SSRN:2967011, 2017.
URL https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2967011.
Retsef Levi, Elisabeth Paulson, and Georgia Perakis. Optimal interventions for increasing healthy food
consumption among low income households. Available at SSRN 3486292, 2019.

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

37

Robert W Lien, Seyed MR Iravani, and Karen R Smilowitz. Sequential resource allocation for nonprofit
operations. Operations Research, 62(2):301–317, 2014.
Brendan Lucier. An economic view of prophet inequalities. ACM SIGecom Exchanges, 16(1):24–47, 2017.
Will Ma and Pan Xu. Group-level fairness maximization in online bipartite matching. arXiv preprint
arXiv:2011.13908, 2020.
Aranyak Mehta. Online matching and ad allocation. Theoretical Computer Science, 8(4):265–368, 2012.
Jeonghoon Mo and Jean Walrand. Fair end-to-end window-based congestion control. IEEE/ACM Transactions on networking, 8(5):556–567, 2000.
Vedant Nanda, Pan Xu, Karthik Abhinav Sankararaman, John Dickerson, and Aravind Srinivasan. Balancing
the tradeoff between profit and fairness in rideshare platforms during high-demand hours. In Proceedings
of the AAAI Conference on Artificial Intelligence, volume 34, pages 2210–2217, 2020.
Irem Sengul Orgut, Julie S Ivy, Reha Uzsoy, and Charlie Hale. Robust optimization approaches for the
equitable and effective distribution of donated food. European Journal of Operational Research, 269
(2):516–531, 2018.
Christos H Papadimitriou and John N Tsitsiklis. The complexity of markov decision processes. Mathematics
of operations research, 12(3):441–450, 1987.
Parag A Pathak, Tayfun Sönmez, M Utku Ünver, and M Bumin Yenmez. Fair allocation of vaccines,
ventilators and antiviral treatments: leaving no ethical value behind in health care rationing. arXiv
preprint arXiv:2008.00374, 2020.
John Rawls. A theory of justice, 1973.
Yosef Rinott and Ester Samuel-Cahn. Optimal stopping values and prophet inequalities for some dependent
random variables. Lecture Notes-Monograph Series, 22:343–358, 1992. ISSN 07492170. URL http:
//www.jstor.org/stable/4355751.
Ester Samuel-Cahn et al. Comparison of threshold stop rules and maximum for independent nonnegative
random variables. the Annals of Probability, 12(4):1213–1216, 1984.
Sean R Sinclair, Gauri Jain, Siddhartha Banerjee, and Christina Lee Yu. Sequential fair allocation of limited
resources under stochastic demands. arXiv preprint arXiv:2011.14382, 2020.
Senay Solak, Christina Scherrer, and Ahmed Ghoniem. The stop-and-drop problem in nonprofit food distribution networks. Annals of Operations Research, 221(1):407–426, 2014.
Van-Anh Truong and Xinshang Wang. Prophet inequality with correlated arrival probabilities, with application to two sided matchings. arXiv preprint arXiv:1901.02552, 2019.
Yanyan Wang, Vicki M Bier, and Baiqing Sun. Measuring and achieving equity in multiperiod emergency
material allocation. Risk Analysis, 39(11):2408–2426, 2019.
Washington Post.
stockpile,

Desperate for medical equipment, states encounter a beleaguered national

2020a.

URL

https://www.washingtonpost.com/national/health-science/

desperate-for-medical-equipment-states-encounter-a-beleaguered-national-stockpile/
2020/03/28/1f4f9a0a-6f82-11ea-aa80-c2470c6b2034_story.html.

38

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

Washington
national

Post.

Desperate

stockpile,

2020b.

for

medical
URL

equipment,

states

encounter

a

beleaguered

https://www.washingtonpost.com/politics/

trump-white-house-projects-up-to-240000-coronavirus-deaths-in-us-even-with-mitigation-efforts/
2020/03/31/62df5344-7367-11ea-87da-77a8136c1a6d_story.html.

39

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

Appendix
A.

Missing Proofs and Discussions of Section 3

A.1.

Proof of Theorem 1 (Section 3.1)

We prove the theorem by considering two separate cases corresponding to the over-demanded regime (µ ≥

1 + n1 ) and the under-demanded regime (µ < 1 + n1 ). For each regime, we provide an instance of the problem
under which no sequential allocation policy obtains ex-post fairness larger than κp (µ, n) restricted to that
regime.
Over-demanded regime (µ ≥ 1 + n1 ): Consider an instance with n equally likely scenarios, where in
scenario σ all agents i ∈ [σ] have demand di =

2µ
n+1

. This instance is depicted in Figure 2(a). We remark that

the total expected demand is equal to µ, simply because
X 1 2µ
·
· σ = µ.
n n+1
σ∈[n]

In such a setting, whenever agent i has non-zero demand, every agent j where j < i must also have had nonzero demand. Since the policy cannot distinguish among scenarios i, i+1, . . . , n, its allocation decision must be
independent of the scenario. Therefore, any policy can be described by a set of allocations ~y = (y1 , y2 , . . . , yn ),
such that if agent i has non-zero demand, then they receive an expected allocation yi . Furthermore, when
making the allocation decision for agent n, there is only one possible history: every other agent also had
P
non-zero demand. Thus, any feasible sequential allocation policy must respect the constraint i∈[n] yi ≤ 1.
Let us define rσ as the expected minimum FR of the given policy in scenario σ (i.e., if only the first σ

agents have non-zero demand). By convention, we set r0 = 1 and we must have rσ ≤ rσ−1 by definition. In

yσ . Given ~r, the expected minimum
addition, rσ must be less than the expected FR of agent σ, so rσ ≤ (n2+1)
µ
P
1
FR in this instance is equal to n σ∈[n] rσ . Based on these constraints and the objective, we can formulate

a linear program whose optimal solution is an upper bound on the expected minimum FR achievable by
any feasible sequential allocation policy. This linear program was originally presented in Section 3.1, but we
replicate it here (Primal-LP1) along with its dual program (Dual-LP1).
(Primal-LP1)
max
~y , ~r ∈ Rn≥0

(Dual-LP1)
1 X
rσ
n

s.t.

min
~γ , ~δ ∈ Rn≥0
ω ∈ R≥0

σ∈[n]

rσ ≤

(n + 1)yσ
2µ

rσ ≤ rσ−1 , r0 = 1
X

i∈[n]

ω + γ1

s.t.

σ ∈ [n]

ω ≥

(n + 1)
δi
2µ

i ∈ [n]

σ ∈ [n]

δi ≥

1
+ γi+1 − γi
n

i ∈ [n − 1]

δn ≥

1
− γn
n

yi ≤ 1

To upper-bound the value of the program Primal-LP1, we find a feasible assignment for the dual program
Dual-LP1. Consider the assignment where δi =

1
n

and γi = 0 for all i ∈ [n], and where ω =

n+1
2nµ

. Under this

40

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

Figure 7

The instance which establishes an upper bound of κp (µ, n) when µ < 1 +

1
n

(which we refer to as

the under-demanded regime).

assignment, all dual variables are non-negative and all constraints are satisfied (in fact, all are tight). Thus,
this assignment is feasible in Dual-LP1. It also attains an objective value of

n+1
2nµ

. By weak duality, this

represents an upper bound on the optimal value of Primal-LP1, and hence an upper bound on the expected
minimum FR of any policy in the over-demanded regime.
Under-demanded regime (µ < 1 + n1 ): Consider an instance with n + 1 scenarios, where the first n
scenarios each occur with equal probability of

µ
n+1

and scenario n + 1 occurs with probability 1 −

nµ
n+1

. In

scenario n + 1, there is no demand. In scenario σ for σ ∈ [n], all agents i ∈ [σ] have demand di = n2 . This
instance is depicted in Figure 7. We remark the total expected demand is equal to µ, simply because
X

σ∈[n]

µ
2
· · σ = µ.
n+1 n

As was the case in the over-demanded regime, any sequential allocation policy can be described by a set of
allocation decisions such that if agent i has non-zero demand, then they receive an expected allocation yi . We
again define rσ as the expected minimum FR in scenario σ, and we note that rn+1 = 1. Thus, the expected
P
µ
minimum FR in this instance is equal to n+1
r + 1 − nnµ
. By imposing the constraints described for
σ∈[n] σ
+1

Primal-LP1, we can formulate a slightly different linear program whose optimal solution is an upper bound

on the expected minimum FR of any feasible sequential allocation policy in the under-demanded regime.
This linear program (Primal-LP2), along with its dual program (Dual-LP2), is presented below.

41

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

(Primal-LP2)
max
~y , ~r ∈ Rn≥0

(Dual-LP2)
nµ
µ X
rσ + 1 −
n+1
n+1

s.t.

σ∈[n]

rσ ≤

nyσ
2

σ ∈ [n]

rσ ≤ rσ−1 , r0 = 1
X

i∈[n]

min
~γ , ~δ ∈ Rn≥0
ω ∈ R≥0

σ ∈ [n]

yi ≤ 1

ω + γ1 + 1 −

nµ
n+1

s.t.

n
δi
2
µ
δi ≥
+ γi+1 − γi
n+1
µ
δn ≥
− γn
n+1
ω ≥

i ∈ [n]
i ∈ [n − 1]

To upper-bound the value of the program Primal-LP2, we find a feasible assignment for its dual. Consider
δi =

µ
n+1

and γi = 0 for all σ ∈ [n], and ω =

nµ

2(n+1)

. Under this dual assignment, all dual variables are non-

negative and all constraints are satisfied (and again tight). Thus, this assignment is feasible in Dual-LP2.
It also attains an objective value of

nµ

2(n+1)

1−

nµ
n+1

=1−

nµ

2(n+1)

. By weak duality, this represents an upper

bound on the optimal value of Primal-LP2, and hence an upper bound on the expected minimum FR
attainable by any sequential allocation policy when µ < 1 + n1 .
We conclude the proof by scaling the obtained upper bounds on the expected minimum FR by our
benchmark for deterministic demand, namely W = min{1, 1/µ}. This establishes an upper bound of κp (µ, n)
on the ex-post fairness guarantee (see Definition 1) achievable by any sequential allocation policy.
A.2.



Example Illustrating Limitations of Dynamic Programming (Section 3.1)

To highlight some of the shortcomings of a DP approach, we will use the following example, which is in fact
a perturbed version of a particular instance of the class of hard examples illustrated in Figure 2(a).
Example 1. Consider an instance with two agents (n = 2) where expected demand is almost twice the
amount of supply (µ = 2 +  for small  > 0). The demand sequence is either ( 34 + , 34 ) or ( 43 + , 0) with equal
probabilities, that is, the first agent has deterministic demand d1 = 43 +  and the second agent either has no
demand or has demand d2 = 34 .
Given the objective of maximizing the expected minimum FR in such a setting, it is not hard to see that
the optimal online policy—which is the solution of the ex-post DP—simply allocates

4+3
8+3

of the supply to

the first agent and the remaining supply to the second agent, assuming that agent’s demand is realized.
This achieves an expected minimum FR of

3
.
8+3

Note that the minimum expected FR is no higher than the

expected minimum FR, as the FR of first agent is always the minimum FR when following this DP solution.
We now make the following two observations:
(i) The DP solution achieves a sub-optimal minimum expected FR. As mentioned earlier, the minimum
expected FR of the DP solution is
fairness of

6+3
.
8+3

3
.
8+3

Since µ = 2 + , this corresponds to ex-ante (and ex-post)

We highlight that the ex-ante fairness of the DP solution is less than the ex-ante

fairness (and the ex-ante fairness guarantee) of our PPA policy on this instance (for small enough ) by
a constant multiplicative factor of ≈ 34 . Note that the PPA policy targets an FR of ≈

the first agent, resulting in the second agent having a higher expected FR of ≈

1/3
4/3

×

1
= 12
4/3+2/3
1
+ 1 × 12 = 58 .
2

for
So,

42

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

the PPA policy achieves a minimum expected FR of ≈

1
2

and an ex-ante fairness of ≈ 1, which for small

 matches the ex-ante fairness guarantee of the PPA policy established in Theorem 4 when µ = 2 + .
(ii) The DP solution is sensitive to small perturbations in agents’ demand distributions. To see this, we
show that the above DP solution can vary significantly if the demand distribution is slightly different.
Suppose that we perturb this instance by decreasing the first agent’s demand by 2. In this case, the
DP solution is to allocate all of the supply to the first agent. The expected minimum FR is essentially
unchanged, but the first agent receives almost twice as much supply as before. Not only does this
demonstrate that the DP solution is highly sensitive, but it also highlights that the DP solution can
suffer from a lack of interpretability: the first agent receives more supply in this case, even though the
only change was a deterministic and negligible decrease in that agent’s demand.
A.3.

Simple Backward Dynamic Programming for Optimum Offline (Section 3.2)

~ and let fi be the minimum FR of the policy
Suppose the planner has access to all the demand realizations d,
x

i−1
} for i ∈ [2 : n + 1]. We will show via backward
at the end of period i − 1, i.e., f1 = 1, fi = min{fi−1 , di−1

induction that for any remaining supply si and minimum FR fi , the maximum-achievable minimum FR is
n
o
min{fi , P si dj }, which is achieved by a policy x∗i = min di , si P di dj .
j∈[i:n]

j∈[i:n]

Clearly, this is true when i = n, as the optimal policy is to allocate as much supply as possible, i.e.

x∗n = min{dn , sn }. This policy achieves a minimum FR of






xn
min{dn , sn }
sn
fn+1 = min fn ,
= min fn ,
= min fn ,
.
dn
dn
dn
We now assume this is true for i > k. In that case, given an allocation to agent k of xk , the minimum FR
n
o
at the end of period k is given by fk+1 = min fk , xk
and the remaining supply is sk+1 = sk − xk . Based on
dk
our inductive hypothesis, the maximum-achievable minimum FR is thus
(
)
(
)
sk+1
sk − xk
xk
min fk+1 , P
,P
= min fk ,
.
dk
d
d
j∈[k+1:n] j
j∈[k+1:n] j

This is maximized when the second and third terms are equal, which occurs when xk = sk P dk dj . If
j∈[k:n]


this allocation is infeasible i.e., if sk P dk dj ≥ dk , then an allocation of xk = dk is optimal because this
j∈[k:n]

allocation ensures that fk must be the minimum of the three terms. This completes the proof by backward
n
o
induction that the maximum-achievable minimum FR is min fi , P si dj , which is achieved by a policy
j∈[i:n]
n
o
di
∗
P
xi = min di , si
.
dj
j∈[i:n]

A.4.

Analysis of Non-adaptive Fixed-allocation Policies (Section 3.4)

In this appendix section, we consider another class of non-adaptive policies which we call fixed-allocation
policies. A fixed-allocation policy is one which pre-determines an allocation xi for each agent i ∈ [n].30 The

~ pre-determines a
optimal fixed-allocation policy is the policy which, given a joint demand distribution F,
h
n oi
xi
vector of allocations ~x = (x1 , x2 , . . . , xn ) which maximizes Ed∼
.
~ F
~ mini∈[n]
di
30

As explained in Footnote 18, we focus on deterministic policies without loss of generality.

43

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

Proposition 1 (Ex-post Fairness Guarantee of the Optimal Fixed-allocation Policy). Given
a fixed number of agents n ∈ N and supply scarcity µ ∈ R≥0 , the optimal fixed-allocation policy achieves an
ex-post fairness guarantee of

(
1 − nµ ,
κfa (µ, n) = max{1, µ} 1 4
,
nµ

µn ∈ [0, 2)
.
µn ∈ [2, +∞)

(19)

We remark that the ex-post fairness guarantee κfa (µ, n) tends to 0 as the number of agents n gets large.
This is in stark contrast to the guarantees provided by the PPA policy and the optimal TFR policy, which
are lower-bounded by a constant regardless of the number of agents.
A.4.1.

Proof of Proposition 1

We prove this proposition by first showing that there exists a distri-

bution where no fixed-allocation policy achieves ex-post fairness greater than κfa (µ, n), which thus serves
as an upper bound on the ex-post fairness guarantee of the optimal fixed-allocation policy. We then show
that there exists a fixed-allocation policy that achieves ex-post fairness of at least κfa (µ, n) for any demand
distribution, which means the bound κfa (µ, n) is tight.
Upper bound: We prove the hardness result by considering two separate cases corresponding to nµ < 2
and nµ ≥ 2. For each case, we provide an instance of the problem under which any fixed-allocation policy
obtains ex-post fairness no larger than κfa (µ, n).

(i) If nµ < 2, consider a joint demand distribution such that with probability 1− nµ
there is no demand, and
2
with probability
1−

nµ

2

nµ

2

one agent chosen uniformly at random has demand n2 . In this case, with probability

, the minimum FR is 1, and with probability

nµ

2

, the minimum FR is equal to the allocation

of a randomly selected agent (which is at most 1/n) divided by the total demand 2/n. Therefore, the
minimum expected FR for this instance is upper-bounded by 1 − nµ
.
4
(ii) If nµ ≥ 2, consider a joint demand distribution where one agent chosen uniformly at random has demand

equal to the expected total demand µ. In this instance, the minimum expected FR is upper-bounded

by the allocation of a randomly selected agent (which is at most 1/n) divided by the total demand µ.
Taken together, these instances provide an upper bound on the expected minimum FR one can hope
to achieve with a fixed-allocation policy. We then scale each instance by our benchmark for deterministic
demand, namely W = min{1, 1/µ}, which provides an upper bound of κfa (µ, n) on the ex-post fairness
guarantee (see Definition 1) of any fixed-allocation policy.
Lower bound: Consider a policy which allocates an equal amount of supply to each agent, i.e., xi = n1
n
o
for all i ∈ [n]. In that case, the minimum FR is lower-bounded by min 1, n P 1 di . Further,
i∈[n]
P
(
) (
P
n i∈[n] di
1−
, n i∈[n] di ∈ [0, 2)
1
4
P
min 1, P
≥
1
P
,
n i∈[n] di ∈ [2, +∞)
n i∈[n] di
n i∈[n] di
P
We note that the right hand side of the above inequality is convex in i∈[n] di . Therefore, using Jensen’s
inequality, the expected minimum FR must be at least
(
1 − nµ
, nµ ∈ [0, 2)
4
1
,
nµ ∈ [2, +∞)
nµ

We then scale each this lower bound on the expected minimum FR by our benchmark for deterministic
demand, namely W = min{1, 1/µ}. This provides a lower bound on the ex-post fairness guarantee (see
Definition 1) that is equal to κfa (µ, n). Thus, we have shown that κfa (µ, n) is a tight bound on the ex-post
fairness guarantee of the optimal fixed-allocation policy.



44
A.5.

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

Proof of Claims in Lemma 2 (Section 3.4)

In this section, we present the proofs of the three claims which appear in the proof of Lemma 2.
A.5.1.

Proof of Claim 1 Suppose we have a distribution G such that RG (q) is not flat in (QG (1), 1],

that is, ∃ q1 , q2 ∈ (QG (1), 1] such that RG (q1 ) 6= RG (q2 ). Let RG (q) attain its maximum in [QG (1), 1] at the
quantile q̄. Now consider a quantile q 0 ∈ (QG (1), 1] so that RG (q 0 ) < RG (q̄). Let δ , q 0 − QG (T G (q 0 ) + ) be
the total probability mass in the TFR interval (T G (q 0 ), T G (q 0 ) + ]. Then pick a small enough  > 0 such that:
(i)  + δ +  · δ < RG (q̄) − RG (q 0 ),
(ii)  ≤ 1 − T G (q 0 ),
(iii) q̄ ∈
/ [QG (T G (q 0 ) + ) , q 0 ].
Now consider a distribution Ḡ that is generated from G by moving all the δ probability mass in
(T G (q 0 ), T G (q 0 ) + ] to the point T G (q 0 ) + . With this modification in the distribution, the EAFR of every
TFR τ ∈ [0, T G (q 0 )] ∪ (T G (q 0 ) + , 1] remains the same. Moreover, the maximum EAFR in the interval
(T G (q 0 ), T G (q 0 ) + ] is also achieved at T G (q 0 ) + . Given this target fill rate, the EAFR of the distribution Ḡ
is equal to


RḠ (T G (q 0 ) + ) = (T G (q 0 ) + ) QG T G (q 0 ) +  + δ

< T G (q 0 ) · QG T G (q 0 ) +  +  + δ +  · δ
< RG (q 0 ) + (RG (q̄) − RG (q 0 )) = RG (q̄) .

Therefore, the maximum EAFR over all possible TFRs in [0, 1] is the same for G and Ḡ, i.e.,
max

q∈[0,1]:T G (q )∈[0,1]

However, µ̄ = Ev∼Ḡ
v ∼ Ḡ. We have:

1
v

< Ev∼G

v

max

q∈[0,1]:T Ḡ (q )∈[0,1]

RḠ (q)

=

RG (q̄).

= µ. Now let G̃ be the distribution of the random variable (µ̄/µ) · v where



max τ (1 − G̃(τ )) = max τ 1 − Ḡ(τ · µ/µ̄) ≤ max τ 1 − Ḡ(τ ) = max τ (1 − G(τ )) .

τ ∈[0,1]

Also, Ev∼G̃

1

RG (q) =

1
v

= Ev∼G

τ ∈[0,1]

1
v

τ ∈[0,1]

τ ∈[0,1]

= µ. Therefore, dropping such a distribution G from the feasible set in the outer

optimization of eq. (15) does not change the infimum value, which proves Claim 1.
A.5.2.

Proof of Claim 2



Suppose we have a distribution G that has non-zero total mass in the interval

(1, +∞). Now shift all the probability mass in (1, +∞) to +∞. Let Ḡ be the resulting distribution. Note
that the maximum EAFR among targets in [0, 1] is the same for G and Ḡ, as the EAFR for any target in
 
 
[0, 1] remains the same. However, µ̄ = Ev∼Ḡ 1v < Ev∼G 1v = µ, as we have moved the probability mass of

v towards larger values (equivalently, the probability mass of demand to lower values). By using the same

trick as above in Section A.5.1, we conclude that dropping such a distribution G from the feasible set in the
outer optimization of eq. (15) does not change the infimum value, which proves Claim 2.



45

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

Proof of Claim 3 Consider an inverse demand distribution Ḡ that satisfies the two constraints

A.5.3.

given by Claim 1 and Claim 2, namely (i) RG (q) = RG (q 0 ), ∀q, q 0 ∈ [QG (1), 1], and (ii) G(v) = G(1) for all
v ∈ [1, +∞). Let us define q̄ such that QḠ (1) = q̄, or equivalently, T Ḡ (q̄) = 1.

The EAFR curve for Ḡ by definition attains a value of RḠ (q̄) = q̄. Since Ḡ has a constant EAFR curve in

the interval [q̄, 1], its EAFR curve must be constantly equal to q̄ over that interval. Futher, since the EAFR
curve can also be expressed as q · Ḡ−1 (1 − q), we must have Ḡ(q̄/q) = 1 − q for all q ∈ [q̄, 1]. Equivalently,
using a change of variable v = q̄/q, we must have Ḡ(v) = 1 − q̄/v for all v ∈ [q̄, 1] (which implies Ḡ(q̄) = 0).

Further, since the CDF Ḡ pushes all the probability mass in the interval (1, +∞) to +∞, Ḡ must be

constant in the interval [1, +∞). Thus, we have uniquely described Ḡ, up to a constant q̄:

0


1 − q̄/v
Ḡ(v) =

 1 − q̄
1

if
if
if
if

v ∈ [0, q̄)
v ∈ [q̄, 1)
v ∈ [1, +∞)
v = +∞

For this distribution to have an expected demand of µ, consider the corresponding CDF for demand
F̄ : R≥0 → [0, 1] for the random variable x ,

1

where v ∼ Ḡ. We have:

0
if x = 0


 q̄
if x ∈ (0, 1]
F̄ (x) = 1 − Ḡ(1/x) = q̄x
if x ∈ (1, 1q̄ ]


1
if x ∈ ( 1q̄ , +∞)

As a result,

v



  Z ∞
Z 1
q̄

1 1
1
(1 − q̄x)dx =
− q̄ .
Ev∼G
=
1 − F̄ (x) dx = 1 − q̄ +
v
2 q̄
1
0


The unique solution to 12 1q̄ − q̄ = µ satisfying q̄ ≥ 0 is q̄ = √1 2 .
µ+

We highlight that Ḡ with q̄ =

√1

µ+

µ2 +1

µ +1

is identical to the distribution Ĝ defined in eq. (14). This shows

that Ĝ is the unique worst-case distribution.
A.6.



Proof of Theorem 4 (Section 3.5)

We prove this theorem by first providing two instances which together show that no policy achieves ex-ante
fairness greater than κa (µ, n). We then show that our PPA policy achieves ex-ante fairness of at least κa (µ, n)
for any demand distribution, which means the bound is tight.
Upper bound: We prove the hardness result by considering two separate cases corresponding to µ < 2
and µ ≥ 2. For each case, we provide an instance of the problem under which no policy can obtain ex-ante
fairness larger than κa (µ, n).

(i) If µ < 2, consider a joint demand distribution for an arbitrary number of agents such that with probability 1 − µ2 there is no demand, and with probability

µ

2

the total demand is 2 (arbitrarily and deter-

ministically split among agents). In this case, with probability 1 − µ2 , each agent achieves an FR of 1,

and with probability

µ

2

, the expected FR cannot exceed

1
2

for at least one agent. Therefore, in this

instance the minimum expected FR is upper-bounded by 1 − µ4 .
(ii) If µ ≥ 2, consider a deterministic demand distribution where total demand is equal to its expectation

µ (arbitrarily split among n agents). In this case, the minimum expected FR is clearly upper-bounded
by

1
µ

.

46

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

Taken together, these instances provide an upper bound on the minimum expected FR one can hope to
achieve with any policy. We then scale each instance by our benchmark for deterministic demand, namely W =
min{1, 1/µ}, which provides an upper bound of κa (µ, n) on the ex-ante fairness guarantee (see Definition 1)
of any policy.



Lower bound: We now show that the PPA policy achieves an ex-ante fairness guarantee of κa (µ, n).
First, we show via induction that after the arrival of any agent i ∈ [n], the ratio

di +µi+1
si

, i.e., expected total

remaining demand to remaining supply, is in expectation at most µ. We then place a lower bound on the
expected FR of agent i when following the PPA policy which is a decreasing and convex function of the ratio
di +µi+1
si

. We conclude by applying Jensen’s inequality to lower bound the expected FR of agent i. Since this

lower bound is the same for each agent, it constitutes a lower bound on the minimum expected FR.
Claim 4 (Upper Bound on Demand-to-Supply Ratio). When following the PPA policy, for all i ∈
h
i
di +µi+1
[n], Ed∼
≤ µ.
~ F
~
si
h
i
h i
d1 +µ2
µ1
Proof: We proceed by induction. Clearly, when i = 1, Ed∼
=
E
= µ. We now assume
~ F
~
~
~
d∼
F
s1
s1
that this holds for i = k and attempt to prove the claim for i = k + 1. According to the PPA policy, xk ≤
µ

. Consequently,
sk dk +dµkk+1 . Thus, sk+1 is at least sk dk +k+1
µk+1
"
#






dk+1 + µk+2
µk+1
dk + µk+1
µk+1
Ed∼
=
E
≥
E
=
E
≥ µ.
~ F
~ F
~ F
~ F
~
~
~
~
µ
d∼
d∼
d∼
sk+1
sk+1
sk dk +k+1
sk
µk+1

The final inequality comes from our inductive hypothesis, which completes the proof by induction.

n
o
si
Given a current demand di and expected future demand µi+1 , the FR of agent i is min 1, di +µi+1 . It is
straightforward to show that this FR is lower-bounded by the following function of the ratio

 (
d +µ
di +µi+1
1 − 41 i sii+1 ,
<2
di + µi+1
si
h
=
di +µi+1
si
,
≥2
si
di +µi+1
si

di +µi+1
si

:

We remark that h is a decreasing and convex function of its argument. Hence, by Jensen’s inequality and
Claim 4,

 




di + µi+1
di + µi+1
Ed∼
≥ h Ed∼
≥ h(µ).
~ F
~ F
~ h
~
si
si
Since this lower bound on the expected FR holds for each agent i, we have shown a lower bound on the

minimum expected FR when following the PPA policy. When scaled by our benchmark for deterministic
demand, namely W = min{1, 1/µ}, this lower bound exactly matches the upper bound of κa (µ, n) established
above, and thus completes the proof of Theorem 4.

B.
B.1.



Missing Proofs of Section 5.2
Proof of Corollary 1

Suppose the allocation given by the PPA policy is ~x. By Theorem 2, the PPA policy achieves ex-post fairness
of κp (µ, n) when the social welfare function is the minimum FR, which implies U+∞ (~x) = mini∈[n] { xdii } ≥

κp (µ, n)W .

Now consider a new allocation vector ~x0 such that for all i ∈ [n],

x0i
di

x

= minj∈[n] { djj }. We remark that

xi ≥ x0i for all i ∈ [n]. Further, it is easy to verify that Uα (~x0 ) = U+∞ (~x) for any α ∈ [0, +∞). Since Uα (~x) is
non-decreasing in each xi , Uα (~x) ≥ U+∞ (~x).

Manshadi, Niazadeh, Rodilitz: Fair Dynamic Rationing

47

Therefore, the expected WPM social welfare when following the PPA policy is weakly greater than the
minimum FR (regardless of the fairness parameter α). Scaling by the achievable social welfare when demand
is deterministic, we have shown that ex-post fairness, i.e., Ed∼
x)] /W , must be at least κp (µ, n).
~ F
~ [Uα (~
B.2.



Proof of Corollary 2

Theorem 2 establishes that the PPA policy guarantees an expected minimum FR for resource j of at least
n jo
 j 
κp µsj , n max 1, µsj . Consequently, we can place a lower bound on the expected minimum weighted FR:





 X
 j 
X xji
X
µj
xji
µ

Ed∼
,
n
max
1,
.

λj j  ≥
λj Ed∼
≥
λj κp
~ F
~ F
~ mini∈[n]
~ mini∈[n] j
sj
sj
di
di
j∈[m]
j∈[m]
j∈[m]

B.3.

Proof of Corollary 3

Consider a correlated distribution for demands—correlated across agents and resource types—where the
marginal distribution of demands for each resource type matches the worst-case joint distribution of the
single-type problem described in the proof of Theorem 1. These marginal distributions are then coupled
such that the last-arriving agent with non-zero demand for resource j is the same as the last-arriving agent
with non-zero demand for resource j 0 , for any resources j, j 0 ∈ [m] for which at least one agent has non-zero
demand. Given the marginal distributions, each agent is equally likely to be this last-arriving agent. For any
sample path drawn from this distribution, it is without loss of generality to only consider policies where the
allocation is decreasing (i.e., where this last-arriving agent has the worst FR) for every resource.31
 j 
n jo
If supply of resource j is sj , Theorem 1 establishes an upper-bound of κp µsj , n max 1, µsj on the

expected minimum FR of any policy in the single-type problem corresponding to resource j. Since for
every sample path the agent with the worst FR (i.e., the last-arriving agent) is the same across resources,
n jo
 j 
P
aggregating these bounds establishes an upper-bound of j∈[m] λj κp µsj , n max 1, µsj on the expected
minimum weighted FR.

31



For intuition as to why this is without loss of generality, note (i) each agent with non-zero demand for resource
j ∈ [m] has identical demand for that resource, (ii) each agent linearly aggregates their FRs by the same weights
{λj }j∈[m] , and (iii) each agent is equally likely to be the last-arriving agent. Consequently, if agent i has a strictly
larger allocation than agent i0 (where i0 < i) for any resource j, a policy which switches their allocations for that
resource will have a weakly greater expected minimum weighted FR.

