arXiv:2003.09403v1 [q-bio.PE] 18 Mar 2020

1

Neural Network aided quarantine control
model estimation of COVID spread in
Wuhan, China
Raj Dandekar1 and George Barbastathis2,3 †
1

Department of Civil and Environmental Engineering, Massachusetts Institute of Technology,
Cambridge, MA 02139, USA,
2
Department of Mechanical Engineering, Massachusetts Institute of Technology, Cambridge,
MA 02139, USA,
3
Singapore-MIT Alliance for Research and Technology (SMART) Centre, Singapore 138602

In a move described as unprecedented in public health history, starting 24 January
2020, China imposed quarantine and isolation restrictions in Wuhan, a city of more than
10 million people. This raised the question: is mass quarantine and isolation effective as
a social tool in addition to its scientific use as a medical tool? In an effort to address
this question, using a epidemiological model driven approach augmented by machine
learning, we show that the quarantine and isolation measures implemented in Wuhan
brought down the effective reproduction number R(t) of the CoVID-19 spread from
R(t) > 1 to R(t) < 1 within a month after the imposition of quarantine control measures
in Wuhan, China. This ultimately resulted in a stagnation phase in the infected case
count in Wuhan. Our results indicate that the strict public health policies implemented
in Wuhan may have played a crucial role in halting down the spread of infection and
such measures should potentially be implemented in other highly affected countries such
as South Korea, Italy and Iran to curtail spread of the disease. Finally, our forecasting
results predict a stagnation in the quarantine control measures implemented in Wuhan
towards the end of March 2020; this would lead to a subsequent stagnation in the effective
reproduction number at R(t) < 1. We warn that immediate relaxation of the quarantine
measures in Wuhan may lead to a relapse in the infection spread and a subsequent
increase in the effective reproduction number to R(t) > 1. Thus, it may be wise to relax
quarantine measures after sufficient time has elapsed, during which maximum of the
quarantined/isolated individuals are recovered.
(*It should be noted when we mention quarantine subsequently in the paper, we mean
the infected people who are quarantined and isolated and cannot lead to an infection in a
susceptible person.)

1. Introduction
The Coronavirus respiratory disease 2019 originating from the virus “SARS-CoV-2”
(Chan et al. 2020; CDC 2020) has led to a global pandemic, leading to 1, 05, 586 confirmed
global cases in 72 countries as of March 8, 2020 (WHO 2020). Of these cases, 80, 859
have been reported in Mainland China, followed by 7134 cases in the Republic of Korea
(Western Pacific Region), 5883 cases in Italy (European Region) and 5823 cases in Iran
(Eastern Mediterranean Region) (WHO 2020).
† Email address for correspondence: gbarb@mit.edu

2

1.5×10

1.0×10

5.0×10

5

2.0×10
Data: Infected
SIR Prediction: Without Quarantine
Data: Recovered
SIR Prediction: Without Quarantine

5

Wuhan: Number of cases

Wuhan: Number of cases

2.0×10

5

4

0

0

10

20

30

Days since 24 Jan 2020

40

1.5×10

1.0×10

5.0×10

5

Data: Infected
SEIR Prediction: Without Quarantine
Data: Recovered
SEIR Prediction: Without Quarantine

5

5

4

0

0

10

20

30

40

Days since 24 Jan 2020

(a)
(b)
Figure 1: Without quarantine control: Estimation of the infected and recovered case count
compared to the data acquired from the Chinese National Health Commission post 24 January
2020 in Wuhan, China based on (a) SIR epidemiological model and (b) SEIR epidemiological
model.

A quantitative measure to estimate the efficacy of a virus is its basic reproduction number,
R0 (van den Driessche 2017). R0 represents the average number of infections generated by
a single infected individual in a population of susceptible individuals. A number of studies
focused on estimating R0 for the COVID spread in China using initial data collected till
20 - 30 Jan 2020 (Imai et al. 2020; Read et al. 2020; Tang et al. 2020; Li et al. 2020;
Wu et al. 2020). Several estimates of R0 made with different modelling approaches and
assumptions were reported ranging from 2.6 (Imai et al. 2020), 3.8 (Read et al. 2020), 6.47
(Tang et al. 2020), 2.2 (Li et al. 2020) and 2.68 (Wu et al. 2020), all of which predicted the
number of infected cases in China to rise exponentially until preventive measures were
rapidly undertaken. However, most of the prior studies have analyzed the situation till
20−30 January 2020, during which there was limited availability of temporal and spatially
resolved data. As a result, many of these models parametrizations used information about
prior outbreaks such as SARS to predict the temporal evolution of the disease spread and
thus estimate the reproduction number. With detailed time and spatially resolved data
available from the Chinese National Health Commission starting 20 January 2020, there
is an urgent need to use data driven approaches to estimate several factors governing the
disease spread.
In a move described as unprecedented in public health history, starting at the end of
January, China quarantined the entire Wuhan province housing over 10 million people
by shutting down its public transport system, train and airport stations. In addition to
this, several strict public healthcare measures related to quarantine and isolation were
imposed in Wuhan. In this study, in contrast to previous studies, we focus on the time
just at the onset of quarantine control in Wuhan: 24 January 2020 to 40 days after that:
till 3 March 2020; to quantify the effect of the imposed quarantine control in limiting
the spread of CoVID-19. We define a neural network aided epidemiology model based on
an effective reproduction number R(t) which captures the quarantine control strength
function Q(t). Based on the time resolved data for the infected and recovered cases, the
neural network is able to learn the increase of quarantine strength Q(t) and the associated
decrease of R(t) with time; indicating the effect of quarantine control in preventing the
infectious count from exponentially exploding in Wuhan.

3

6×10

4×10

2×10

4

1×10
Data: Infected
Prediction
Data: Recovered
Prediction

4

Wuhan: Number of cases

Wuhan: Number of cases

8×10

4

4

0

0

10

20

30

6

Prediction: Quarantined
8×10

6×10

4×10

2×10

40

5

5

5

5

0

Days since 24 Jan 2020

0

10

20

30

40

Days since 24 Jan 2020

(a)

(b)

0.8

2.0
Quarantine Strength

Effective reproduction number
R=1

0.7

R(t)

Q(t)

1.5
0.6

1.0
0.5

0.4

0

10

20

30

0.5

40

0

Days since 24 Jan 2020

10

20

30

40

Days since 24 Jan 2020

(c)
(d)
Figure 2: Neural network aided SIR quarantine control model: (a) Estimation of the
infected and recovered case count compared to the data acquired from the Chinese National
Health Commission post 24 January 2020 in Wuhan, China. (b) Number of quarantined people
T (t) with time. (c) Quarantine strength function Q(t) learnt by the neural network. (d) Effective
reproduction number R(t) as function of time.

0.8

2.0
Effective reproduction number
R=1

0.7

R(t)

Q(t)

1.5
0.6

1.0
0.5
Quarantine Strength
0.4
24 Jan' 20

18 Feb' 20

14 March' 20

8 April' 20

0.5
24 Jan' 20

18 Feb' 20

14 March' 20

8 April' 20

(a)
(b)
Figure 3: 1 month Forecasting of (a) Quarantine strength, Q and (b) Effective reproduction
number, R(t) in Wuhan, China based on the neural network augmented SIR model.

Results
Without quarantine control in Wuhan, China
If quarantine control is not considered, figure 1 shows that using both the classical
SEIR and the SIR models with optimized model parameters, the number of infected
cases continue to rise exponentially. Neither of these models can recover the stagnation

4
seen in the infected number, about 30 days post 24 January 2020 when the quarantine
measures were implemented in Wuhan. Detailed calculations are shown in the Materials
and Methods section.
With quarantine control in Wuhan, China
Figure 2a shows that a neural network augmented SIR model with quarantine control
included, captures well the time evolution of the infected and recovered case count,
including the plateau value seen at about 30 days post 24 January 2020. Inclusion of
quarantine control in the SIR model thus prevents the exponential growth in the infected
case count seen in Figure 1. Figure 2b shows the model estimate of the number of quarantined/isolated people, which peaks at a value of 0.6 million people. These individuals were
effectively prevented from spreading infection through imposition of quarantine/isolation
restrictions. Figure 2c shows the optimal quarantine strength function Q(t) learned
by the neural network, representing the fraction of the infected people subjected to
quarantine/isolation restrictions. Starting from about 0.5 on 24 January 2020, as the
strength of the strict quarantine and isolation effects employed in Wuhan increased,
this fraction increased to 0.7 within a month, implying that a large fraction of the
infected population were effectively prevented from transmitting the disease to the noninfected susceptible population. The quarantine strength function thus lies at the core of
Wuhan’s success in containing the infectious case count from exponentially increasing.
The quarantine strength function is inversely related to the effective reproduction number
of the virus. The effective reproduction number R(t) based on the quarantine strength
is plotted in Figure 2d, which shows a monotonic decrease with time. At the onset of
quarantine control in Wuhan, i.e on 24 January 2020; R(t) ≈ 1.5 > 1 which is close to the
value reported in prior studies (Imai et al. 2020; Read et al. 2020; Tang et al. 2020; Li
et al. 2020; Wu et al. 2020). Within a month after quarantine restrictions were imposed
in Wuhan i.e around 23 February 2020 , we see that R(t) < 1, indicating the abatement
in infection spread.
1 month forecasting based on the neural network augmented SIR model is shown in figure
3. Our optimized model predicts a stagnation of the quarantine strength at Q(t) ≈ 0.75 as
China eases quarantine measures in Wuhan, accompanied by a stagnation in the effective
reproduction number at R(t) < 1; indicating control of the epidemic. Detailed calculations
are shown in the Materials and Methods section.

Discussion
Since 24 January 2020, all public transportation in and out of Wuhan was restricted,
effectively locking down a city of about 11 million people. Starting 9 February 2020,
every building in urban areas and every village in rural area was quarantined in Wuhan
to contain the spread of CoVID. In addition to this, unprecedented efforts were employed
by the Chinese government to prevent human to human contact between susceptible and
infected individuals. At the same time, the data for the infected case count in Wuhan was
seen to enter a stagnation phase about 30 days post 24 January 2020, when quarantine
measures were deployed in Wuhan. In this study, we show that the classical SIER and
the SIR models in which the model parameters, i.e. the transmission rate β, the infection
rate σ and the recovery rate γ are assumed to be constant are not able to recover the
stagnation observed in the infected case count in Wuhan. This suggests that the classical
epidemiological models need to be revisited by including a time varying term which
encapsulates the strict public health quarantine and isolation measures implemented in
Wuhan, China post 24 January 2020.

5
By approximating this time varying quarantine strength with a neural network, we train
the governing system of augmented SIR differential equations based on a loss function
term obtained from the infected and recovered case count data generated by the Chinese
National Health Commission. By training this governing system, we are able to not only
approximate the maximum plateau value seen in the infected case count 30 days post
the implementation of quarantine control, but also recover a monotonically increasing
quarantine strength function; indicating the increasing severity of quarantine measures
with time. At the peak of its quarantine measures, we predict that about 70% of the
infected population was effectively isolated and prevented from spreading infection to the
non-infected population. From the model, we can also recover the effective reproduction
number, R(t) from the model which is seen to decrease from R(t) ≈ 1.5 to R(t) < 1 a
month post 24 January 2020, indicating the efficacy of quarantine and isolation measures
in curtailing the spread of CoVID in Wuhan.
We then used an optimized neural network-augmented SIR model to forecast the quarantine control strength and effective reproduction number in Wuhan. Our model predicts
a stagnation of the quarantine strength function, Q(t) as China eases the strength of
quarantine and isolation measures in Wuhan. Due to a stagnation of the quarantine
strength function, a stagnation in the effective reproduction number at R(t) < 1 is
estimated from end of March 2020. However, our results also include a warning that,
although the infected case count in Wuhan is stagnating, this does not imply that
quarantine measures in Wuhan should be relaxed immediately. Since quarantined and
isolated individuals may not have completely recovered, relaxing the quarantine measures
may lead to a relapse in the infection spread and a subsequent increase in the effective
reproduction number to R(t) > 1. Thus, it may be wise to not relax quarantine measures
after sufficient time has elapsed, during which maximum of the quarantined/isolated
people are recovered. Finally, it should be noted that our model has a number of
limitations. We do not consider the cases when the quarantined/isolated population
come into contact with the non-infected population and lead to the transmission of
disease. Although it has become evident that CoVID transmission also occurs through
asymptomatic individuals, we do not make a distinction between symptomatic and
asymptomatic individuals in our model. Irrespective of these assumptions, we believe
this to be a first study to quantify the effective of quarantine measures implemented
in Wuhan, with an interpretable physical model aided by machine learning techniques,
involving very few free parameters.

Materials and Methods
Model 1: Without quarantine control
For modelling the number of CoVID cases without quarantine control in Wuhan, China,
we use the classic SEIR epidemiological model, which has been employed in a number
of prior studies, such as for modelling the SARS outbreak Fang et al. (2006); Saito
et al. (2013); Smirnova et al. (2019) as well as the CoVID outbreak Read et al. (2020);
Tang et al. (2020); Wu et al. (2020). In this compartment model, the entire population is
divided into four compartments: the susceptible S; the exposed E; the infected I; and the
recovered population, R. As the disease spreads, population redistribution occurs within
these four compartments so that the total population N = S + E + I + R remains constant
at any given time t. In this model, we assume that there is (a) homogeneous mixing (b)
identical disease process for every individual (c) equal susceptibility for each individual
(d) timescale of the epidemic is much faster than the birth and death rate and (e) no

6
spreading occurs through animals. Irrespective of these assumptions, the basic SEIR
model serves as an interpretable model, often shedding light on the processes involved in
shaping the disease transmission; making it a useful quantitative tool. The SEIR model is
governed by the following system of nonlinear ordinary differential equations (Smirnova
et al. 2019; Wang et al. 2020)
dS
= −βSI/N
dt
dE
= βSI/N − σE
dt
dI
= σE − γI
dt
dR
= γI
dt
In addition to the SEIR model, the SIR model is also implemented to estimate the
number of CoVID cases that would have resulted without quarantine control in Wuhan,
China. In the SIR model, the population is instead divided into three compartments:
susceptible S; infected I; and recovered R. Making similar assumptions as the SEIR
model, the SIR model is governed by a lower-order system of ordinary differential
equations according to
dS
= −βSI/N
dt
dI
= βSI/N − γI
dt
dR
= γI
dt
In both the above models, β is the transmission rate, γ is the recovery rate. in the
SEIR model, σ is the infection rate. All these paraameters are constant in time.
The reproduction number R(t) in the SEIR and SIR models is defined as
R(t) =

β
γ

1.1. Initial conditions - 24 Jan 2020
The number of susceptible individuals was assumed to be equal to the population of
Wuhan, S0 = 11 million. Wuhan’s own infected population was obtained from the data
released by the Chinese National Health Commission and was found to be I0 = 500. The
exposed population was assumed to be 20 × I0 in accordance with (Read et al. 2020;
Wang et al. 2020) and the number of recovered individuals was set very close to 0 as
R0 ≈ 10.

1.2. Parameter estimation
In both the above models, the time resolved data for the infected, Idata and recovered,
Rdata case count for CoVID-19 was obtained from Chinese National Health Commission.

7
The optimal values of the parameters β, σ, γ were obtained by performing a local sensitivity analysis (Cao et al. 2003; Rackauckas et al. 2019) of the ODE problems in the
SEIR and the SIR models described above, by minimizing the mean square error loss
function (L(β, σ, γ)) defined as
L(β, σ, γ) = ∣∣log(I(t)) − log(Idata(t) ∣∣2 + ∣∣log(R(t)) − log(Rdata(t) ∣∣2

(1.1)

The plots in figure 1 are obtained with the optimal parameters β, σ, γ for the SEIR
model and β, γ for the SIR, obtained by minimizing the loss function described in (1.1).
Model 2: With quarantine control
To study the effect of quarantine control in Wuhan, we consider the SIR epidemiological
model for analysis. We chose this model to have as few free modelling parameters in
the system, so that the physics of the infected and recovered case count evolution is not
obscured through the use of a large number of parameters. To include quarantine control
in the modelling, we augment the SIR model with a time varying term which depends
on the number of infected cases (Q(t)I) where Q(t) is the quarantine strength function
and I(t) is the infected case count. Recently, it has showed that neural networks can
be used as function approximators to recover unknown entities of a system of equations
Rackauckas et al. (2020). Thus, in general, Q(t) can be represented by a n layer deep
neural network with weights W1 , W2 . . . Wn , activation function denoted by σ and the
input vector U = (S(t), I(t), R(t), T (t)) as
Q(t) = σ (Wn σ (Wn−1 . . . σ (W1 U ))) = N N (W, U )

(1.2)

In this study, we choose a two layer densely connected neural network with 10 weights
in each layer and the relu activation function. Thus, the governing differential equation
for the augmented SIR model is
dS
= −βSI/N
dt
dI
= βSI/N − γI − Q(t)I = βSI/N − γI − NN(W, U)I
dt
dR
= γI
dt
dT
= Q(t)I = NN(W, U)I
dt
where T (t) is the number of quarantined individuals in the population, assumed to be
very small at the start of the model, i.e. T0 = 10 and N N (W, U ) is the neural network
used for approximating the quarantine strength Q(t). The reproduction number R(t) in
the augmented SIR model is defined as
R(t) =

β
γ + Q(t)

The augmented SIR ODE system is trained by minimizing the mean square error loss
function (L(W, β, σ, γ)) defined as
L(W, β, σ, γ) = ∣∣log(I(t)) − log(Idata(t) ∣∣2 + ∣∣log(R(t)) − log(Rdata(t) ∣∣2

(1.3)

where Idata(t) is the infected case count and Rdata(t) is the recovered case count.
The plots in figure 2 are obtained with the optimal weights W of the neural network

8
and the optimal parameters β, γ for the SIR model, obtained by minimizing the loss
function described in (1.3).
Conflicts of Interest The authors declare no conflicts of interest.
Acknowledgment We are grateful to Haluk Akay, Hyungseok Kim and Wujie Wang
for helpful discussions and suggestions.

REFERENCES
Cao, Yang, Li, Shengtai, Petzold, Linda & Serban, Radu 2003 Adjoint sensitivity analysis
for differential-algebraic equations: The adjoint dae system and its numerical solution.
SIAM journal on scientific computing 24 (3), 1076–1089.
CDC 2020 Coronavirus Disease 2019 (COVID-19) Situation Summary, 3 March 2020 .
Chan, Jasper Fuk-Woo, Yuan, Shuofeng, Kok, Kin-Hang, To, Kelvin Kai-Wang, Chu,
Hin, Yang, Jin, Xing, Fanfan, Liu, Jieling, Yip, Cyril Chik-Yan, Poon, Rosana
Wing-Shan & others 2020 A familial cluster of pneumonia associated with the 2019
novel coronavirus indicating person-to-person transmission: a study of a family cluster.
The Lancet 395 (10223), 514–523.
van den Driessche, Pauline 2017 Reproduction numbers of infectious disease models.
Infectious Disease Modelling 2 (3), 288–303.
Fang, Haiping, Chen, Jixiu & Hu, Jun 2006 Modelling the sars epidemic by a lattice-based
monte-carlo simulation. In 2005 IEEE Engineering in Medicine and Biology 27th Annual
Conference, pp. 7470–7473. IEEE.
Imai, Natsuko, Cori, Anne, Dorigatti, Ilaria, Baguelin, Marc, Donnelly, Christl A,
Riley, Steven & Ferguson, Neil M 2020 Report 3: transmissibility of 2019-ncov.
Reference Source .
Li, Qun, Guan, Xuhua, Wu, Peng, Wang, Xiaoye, Zhou, Lei, Tong, Yeqing, Ren,
Ruiqi, Leung, Kathy SM, Lau, Eric HY, Wong, Jessica Y & others 2020 Early
transmission dynamics in wuhan, china, of novel coronavirus–infected pneumonia. New
England Journal of Medicine .
Rackauckas, Christopher, Innes, Mike, Ma, Yingbo, Bettencourt, Jesse, White,
Lyndon & Dixit, Vaibhav 2019 Diffeqflux.jl - A julia library for neural differential
equations. CoRR abs/1902.02376, arXiv: 1902.02376.
Rackauckas, C., Ma, Y., Martensen, J., Warner, C., Zubov, K., Supekar, R. &
Ramadhan, A. 2020 Universal differential equations for scientific machine learning.
arXiv:2001.04385. .
Read, Jonathan M, Bridgen, Jessica RE, Cummings, Derek AT, Ho, Antonia &
Jewell, Chris P 2020 Novel coronavirus 2019-ncov: early estimation of epidemiological
parameters and epidemic predictions. medRxiv .
Saito, Masaya M, Imoto, Seiya, Yamaguchi, Rui, Sato, Hiroki, Nakada, Haruka, Kami,
Masahiro, Miyano, Satoru & Higuchi, Tomoyuki 2013 Extension and verification of
the seir model on the 2009 influenza a (h1n1) pandemic in japan. Mathematical biosciences
246 (1), 47–54.
Smirnova, Alexandra, deCamp, Linda & Chowell, Gerardo 2019 Forecasting epidemics
through nonparametric estimation of time-dependent transmission rates using the seir
model. Bulletin of mathematical biology 81 (11), 4343–4365.
Tang, Biao, Wang, Xia, Li, Qian, Bragazzi, Nicola Luigi, Tang, Sanyi, Xiao, Yanni
& Wu, Jianhong 2020 Estimation of the transmission risk of the 2019-ncov and its
implication for public health interventions. Journal of Clinical Medicine 9 (2), 462.
Wang, Huwen, Wang, Zezhou, Dong, Yinqiao, Chang, Ruijie, Xu, Chen, Yu, Xiaoyue,
Zhang, Shuxian, Tsamlag, Lhakpa, Shang, Meili, Huang, Jinyan & others 2020
Phase-adjusted estimation of the number of coronavirus disease 2019 cases in wuhan,
china. Cell Discovery 6 (1), 1–8.
WHO 2020 Coronavirus disease 2019 (COVID-19) Situation Report - 43, 8 March 2020 .
Wu, Joseph T, Leung, Kathy & Leung, Gabriel M 2020 Nowcasting and forecasting

9
the potential domestic and international spread of the 2019-ncov outbreak originating
in wuhan, china: a modelling study. The Lancet 395 (10225), 689–697.

