Graphical Abstract
Classification of COVID-19 via Homology of CT-SCAN

arXiv:2102.10593v1 [eess.IV] 21 Feb 2021

Sohail Iqbal, Hafiz Fareed Ahmed, Talha Qaiser, Muhammad Imran Qureshi, Nasir Rajpoot

Figure 1: Graphical Abstract

Classification of COVID-19 via Homology of CT-SCAN
Sohail Iqbala,1,∗, Hafiz Fareed Ahmeda,1 , Talha Qaiserb,1 , Muhammad Imran Qureshic ,
Nasir Rajpootd
a

Department of Mathematics, COMSATS University Islamabad, Park Road, Islamabad, Pakistan
b
Department of Computing, Imperial College London, SW72AZ, United Kingdom
c
Department of Mathematics, King Fahd University of Petroleum and Minerals (KFUPM), Dhahran, Saudi
Arabia
d
Deparment of Computer Science, The University of Warwick, Coventry, CV47AL, United Kingdom

Abstract
In this worldwide spread of SARS-CoV-2 (COVID-19) infection, it is of utmost importance
to detect the disease at an early stage especially in the hot spots of this epidemic. There are
more than 110 Million infected cases on the globe, sofar. Due to its promptness and effective results computed tomography (CT)-scan image is preferred to the reverse-transcription
polymerase chain reaction (RT-PCR). Early detection and isolation of the patient is the only
possible way of controlling the spread of the disease. Automated analysis of CT-Scans can
provide enormous support in this process. In this article, We propose a novel approach to
detect SARS-CoV-2 using CT-scan images. Our method is based on a very intuitive and
natural idea of analyzing shapes, an attempt to mimic a professional medic. We mainly
trace SARS-CoV-2 features by quantifying their topological properties. We primarily use a
tool called persistent homology, from Topological Data Analysis (TDA), to compute these
topological properties.
We train and test our model on the “SARS-CoV-2 CT-scan dataset” (Soares et al. ,
2020), an open-source dataset, containing 2,481 CT-scans of normal and COVID-19 patients.
Our model yielded an overall benchmark F1 score of 99.42%, accuracy 99.416%, precision
99.41%, and recall 99.42%. The TDA techniques have great potential that can be utilized
for efficient and prompt detection of COVID-19. The immense potential of TDA may be
exploited in clinics for rapid and safe detection of COVID-19 globally, in particular in the
low and middle-income countries where RT-PCR labs and/or kits are in a serious crisis.

Corresponding author
Email addresses: soh.iqbal@gmail.com (Sohail Iqbal ), fa.usmani@gmail.com (Hafiz Fareed Ahmed
), t.qaiser@imperial.ac.uk (Talha Qaiser ), Imran.qureshi@kfupm.edu.sa (Muhammad Imran
Qureshi), N.M.Rajpoot@warwick.ac.uk (Nasir Rajpoot)
1
These authors contributed the same during this project
∗

Preprint submitted to Elsevier

February 23, 2021

1. Introduction
On March 11 2020 WHO declared a pandemic caused by the novel corona virus (nCoV).
The disease is well known as SARS-CoV-2, or COVID-19, and originated from Wuhan, China
in December 2019. After more than a year the virus is still spreading exponentially and has
reached 212 countries. At the time of writing this paper there are more than 110 million
infected cases, whereas the death toll has crossed 2.4 million.
The main reason for the spread of the virus is its asymptomatic nature, where an affected
person spreads the virus without any signs of illness. The only precaution that is required
worldwide is immediate isolation of the affected person. For this purpose, effective and
timely testing is the core factor for treatment and prevention.
COVID-19 is a member of the family of viruses SARS (Severe Acute Respiratory Syndrome). It causes severe respiratory illness and primarily damages the lungs (Huang et al. ,
2020). We use “Reverse Transcription Polymerise Chain Reaction (RT-PCR)” and chest
computed tomography (CT) scan for the detection of COVID-19. In RT-PCR we reverse
transcription of RNA into DNA, and then detect the presence of virus DNA. This method
is a laboratory technique that requires a trained personnel that carries out the whole process. The test might take hours, if not days, to give the results. This situation worsens, for
extremely affected areas with limited test kits and trained personnel. The RT-PCR testing
also gives us the false-negative results, in some cases (Tahamtan & Ardebili, 2020), while
in the chest CT-scan, the image analysis has been done by radiologists (Kong & Agarwal,
2020). The latter is much more sensitive method than the RT-PCR. The study of 1014 cases
shows the significance of chest CT-scans over RT-PCR (Ai et al. , 2020). One study finds
that 40 out of 41 (98%) patients had pneumonia with abnormal findings on chest CT-scans
(Huang et al. , 2020).
The image analysis by radiologists suggest that in COVID-19-positive patients, the
ground-glass opacities (GGOs) together with consolidations, crazy pavings appear at the
peripheral portions of bilateral lungs. The increased attenuation in chest CT scan is the
main feature in detection of COVID-19. Detection of these features is relatively time efficient due to higher sensitivity of this method (Li et al. , 2020).
Over the past decade, one of the promising directions in health care innovation is the
applicability of artificial intelligence (AI) in medical imaging. In recent years, AI in general
has revolutionized the field of computer vision (Voulodimos et al. , 2018), and natural language processing (Ruder et al. , 2019; Ruder, 2019) by pushing state-of-the-art performance
in various pattern recognition tasks. More recently, there is an upward trend in exploring the
usability of machine learning algorithms for medical imaging data (Currie et al. , 2019). In
the current scenario with the worldwide outbreak of SARS-CoV2, it is imperative to develop
screening tools to analyze the COVID-19 chest CT-scans. One of the main challenges in deep
learning is data hungriness. In order to converge a deep learning model one may require thousands, and in some cases millions of images (Deng et al. , 2009) for training. On the other
hand techniques of Topological Data Analysis (TDA) use geometrical features, making them
efficient in terms of amount of data required, speed, predictability and interpretability.
TDA is one of the rapidly growing techniques in data analysis. It provides tools to
3

analyze data by bridging techniques from machine learning, statistics, algebraic topology,
topology, and algebra. One of the main tools in TDA is persistent homology (PH). It is a
very effective technique that record the intrinsic topological properties of data. The essential
idea is to produce topological features across a scale. On this scale, some features “die” early
and some “live” longer. The persisting times of these features are the key point of PH. The
ideas of PH has been successfully applied to many areas of science and technology vis-àvis network structures (de Silva & Ghrist, 2007; Lee et al. , 2012), computational biology
(Kasson et al. , 2007; Yao et al. , 2009; Wang & Wei, 2016), data analysis (Carlsson, 2009;
Liu et al. , 2012; Rieck et al. , 2012), image analysis (Carlsson et al. , 2009; Frosini & Landi,
2013; Bendich et al. , 2010), amorphous material structures (Hiraoka et al. , 2016), etc.
In the recent years these techniques has been successful in medical image analysis. For
example, in (Qaiser et al. , 2019, 2016, 2017) the authors developed models, based on PH,
for efficient tumor segmentation in whole-slide images of histology slides; in (Garside et al. ,
2019) the topological features are used to differentiate healthy patients and those with diabetic retinopathy; in (Chung et al. , 2018) segmentation of skin cancer using a given image
was achieved using these techniques, etc.
In this work we develop a state-of-the-art model to detect traces of COVID-19 infection in CT-scans. To train and test our model we use “SARS-CoV-2 CT-scan dataset”
(Soares et al. , 2020).

Figure 2: A sample of CT-Scan images from “SARS-CoV-2 CT-scan dataset” for COVID-19 patients (first
row) and normal cases (second row).

There are mainly three stages to develop our model. In the first stage, we devise a way
to construct a simplicial complex from a give image and then calculate PD’s associated to
it. We map our PDs on a Hilbert sphere, following Anirudh et al (Anirudh et al. , 2016), in
the second stage. This step enable us to perform different statistical operations on the space
of PDs. In the last stage, we use SVM to develop our classification model.
The rest of the paper is structured as follows. We review basics of PH in Section 2. In
Section 3 we describe our methodology to extract features from CT-scans. Our restults are
reported in 4. Finally, in Section 5, we draw our conclusions.

4

2. Mathematical Preliminaries
In this section we recall basic notions and definitions leading to persistent homology and
persistent diagrams (PD’s).
2.1. Persistent homology (PH)
The persistent homology is one of the main tools used in topological data analysis (TDA).
It provides a way to analyze the shape of a point cloud data without actually calculating
the precise geometry. It illuminates some qualitative features of data which persist across
multiple scales. These persistent features provide an effective quantification for the shape of
data. The method is based on techniques from algebraic topology, a branch of mathematics that deals with different “bridges” between algebra and topology known as “functors”.
These functors take topologically equivalent (homotopic) spaces to algebraically equivalent
(isomorphic) spaces . The functorial nature of persistent homology makes it robust to perturbations of an input point cloud; a rarely found feature in some of the existing data analysis
techniques.
A number of functors exist to deal with different classes of topological spaces (simplicial,
cellular, singular, etc). The development of PH is based on the functor known as simplicial
homology. On the topological side we consider a simplicial complex ∆, and on the algebraic
side we get vector spaces Hi (∆) for i = {0, 1, 2, . . . }. The dimension of H0 (∆) gives the
number of connected components, H1 (∆) gives the number of holes, H2 (∆) gives the number
of voids, and so on. In PH we construct simplicial complexes ∆ǫ from a point cloud depending
on a scale parameter ǫ. The homological features that remain persistent across scales, provide
an effective analysis of the shape of data. The summary of these features is either shown on
a “bar diagram” (BD) or a “persistent diagram” (PD).
In what follows we provide a formal overview of the aforementioned terminologies. For
more details see (Rotman, 2013; Carlsson, 2009; Otter et al. , 2017; Edelsbrunner et al. ,
2000).
2.1.1. Simplicial Homology
Definition 2.1.1 (Simplex). Let {p0 , p1 , . . . , pn } be an affine independent set in Rn . The
n-simplex generated by this set, denoted by [p0 , p1 , . . . , pn ], is the convex hull of points p0 , p1 , . . . , pn .
Every point x of this simplex can be written uniquely in the following form
x=

n
X
i=0

ti pi , where

n
X

ti = 1 and each ti ≥ 0.

(1)

i=0

A k-face of [p0 , p1 , . . . , pn ] is a simplex generated by a collection of k + 1 points from
{p0 , p1 , . . . , pn }. A k-face is in fact a k-dimensional geometric object. A simplicial complex
is obtained by “gluing” together different simplices along their common faces.
Definition 2.1.2 (Simplicial Complex). A finite simplicial complex ∆ is a collection of
simplices in Rn such that (1) if α ∈ ∆ then every face of α belong to ∆, (2) for any two
simplices α1 , α2 ∈ ∆, the intersection α1 ∩ α2 is either empty or a common face of α1 and
α2 .
5

Figure 3: Orientation of a simplicial complex

These conditions guarantee that ∆ records changes in each dimension. In order to calculate simplicial homology we need an orientation on the simplicial complex. An orientation
of a simplicial complex is a partial order of its vertices which when restricted to a particular
simplex gives a total order.

Figure 4: A simplicial complex with a partial order
p1 < p2 < p3 < p4 < p5 < p6 , p2 < p7 < p8

2.1.2. Homology of a Simplicial Complex
For an oriented simplicial complex ∆, and integer m ≥ −1 the mth chain group Cm (∆)
consists of formal sums of the form
a1 σ1 + a2 σ2 + · · · + an σn , where a1 , . . . , an ∈ Z
and σ1 , . . . , σn are oriented m-simplices of ∆. For convenience, we define Cm (∆) = {0}
for m > dim ∆ and m < 0. An oriented simplicial complex is an element of the chain
group Cm (K) of the form ± < p0 , p1 , . . . , pm > where p0 , . . . , pm are distinct. The boundary
operator ∂m : Cm (∆) → Cm−1 (∆) is defined by setting
∂m (< p0 , p1 , . . . , pm >) =

m
X

(−1)i < p0 , . . . , p̂i , . . . , pm >,

i=0

6

where p̂i means deleting pi , and extends by linearity. Combining all information, we get the
following chain complex
∂m+1

∂

∂m−1

∂

∂

∂

m
2
1
0
· · · −−−→ Cm (∆) −→
Cm−1 (∆) −−−→ · · · −
→
C1 (∆) −
→
C0 (∆) −
→
0,

such that the composition of any two consecutive maps is a zero map. We define the m-th
simplicial homology as
Hm (∆) = Kernel ∂m / Image(∂m+1 ), where 0 ≤ m ≤ dim ∆.
Its dimension
βm (∆) = dim Hm (∆)
is called the mth Betti number of the simplicial complex ∆.
2.1.3. Persistence Diagram (PD)
For a data set X, we can calculate its Betti numbers after imposing a simplicial complex ∆(X) on it. This information is not useful since it only gives number of connected
components, 1-dimensional holes, etc. To extract further information, we construct a filtered complex, which consists of nested subcomplexes ∆(X, ǫ) of ∆, that depend on a scale
parameter ǫ, such that
∆(X, ǫ1 ) ⊆ ∆(X, ǫ2 ) whenever ǫ1 ≤ ǫ2 .
We can apply the simplicial homology functor on each subcomplex. The inclusion map on the
complexes ∆(X, ǫ1 ) ⊂ ∆(X, ǫ2 ) induces a linear map on the homology groups Hm (∆(X, ǫ1 )) →
Hm (∆(X, ǫ2 )), for 0 ≤ m ≤ dim ∆. Hence the homology of this filtration complex consistently provide information about ∆ at different values of ǫ. One can represent these features,
over various scales, using persistent diagrams (PDs). To exemplify, consider a point cloud
in R2 , say S, given in Fig 5. To extract qualitative information from this data we compute
topological features for different values of a scale parameter ǫ. At each scale level of ǫ, we
consider open discs, say D(p, ǫ), of radius ǫ around each point p. Then we build a simplicial
complex ∆(S, ǫ) using the following rule; a set of points A = {p0 , . . . , pn } forms an n-simplex
if ∩p∈A D(p, ǫ) 6= Φ. At each level the simplicial complex is made up of simplices shown in
the Fig 5.
As the values of ǫ increase from 0, we get a filtration of simplicial complexes ∆(S, ǫ)

Figure 5: A filtration of simplicial complexes build from a given point cloud ∆(S, 0)

7

We can represent the birth and death of these topological features using the persistent
diagram. A persistent diagram (PD) is a collection of ordered pairs in the extended plane.
A point (a, b) represent the birth at scale parameter value ǫ = a and death at ǫ = b. The
points that touches the infinity line are the persistent features that do not die till the last
value of our filtration parameter. In Fig 6 we see a point at line of infinity. This depicts that
there is one-dimensional hole (or loop) that appears at ǫ = 2 (see Fig 5) and never dies. It
is very consisting with the observation that the overall shape of data in Fig 5 is circular.

Figure 6: PDs representing topological features of the point cloud from Fig 5

Apart from its stability, another important feature of the PH is that it can be computed using different algorithms. There are many libraries available that implement algorithms for the computation of PH. These libraries include, Perseus, javaPlex, Dionysus,
ripser, Gudhi, etc. We use ripser(Tralie et al. , 2018) due to its computational efficiency
(Otter et al. , 2017).
There are many ways to impose a simplicial complex on a given point cloud. The choice
depends on the nature of data, computational cost, and restrictions of software/package
used. Some typical simplicial complexes are, Vietoris–Rips complex, Čech complex, Delaunay
complex, clique complex, alpha complex, strong witness complex, weak witness complex, etc.
3. Methods and Algorithm
Thoracic radiology evaluations found high rates of ground-glass opacities and consolidations in COVID-19 patients. One can observe the ground-glass opacities (GGOs) together
with consolidations in the CT-Scan of COVID-19 images. These regions are isolated with
difference in shapes (left image in Fig. 7), which is captured by PDs associated to H0 and
H1 . Moreover, these regions have unique shape in the intensity plot, see appearance of alps,
saddle points in Fig. 7 (right image). These are recorded by PDs of Lower-star-filtration
and H2 .

8

Figure 7: Shape features and intensity plot in a COVID-19 infected CT-scan

All These shape features are captured by PDs associated to two different filtered complexes, namely, filtered Vietoris-Rips (VR) complex, and lower-star-filtration. The whole
process is summarized as two pipelines in Fig 8. In the following subsections, we describe
each step of these two pipelines.

Figure 8: Extraction of topological features from a CT-Scan of a COVID-19 patient. (A) Quantization of
the Input Image which is used to construct feature point cloud (FPC). (B) Construction of two filtered
complexes: filtered VR complex constructed from FPC, and lower-star filtration directly from image. (C)
Calculation of PDs (D) Use of Riemannian framework to map PDs on a Hilbert sphere. Later, by using
PGA, we construct a unique feature vector of the Input Image.

There are four PDs associated to an image; three from filtered VR complex corresponding
to H0 , H1 and H2 , and one from lower-star-filtration. To simplify statistical operations
we map each PD onto a Hilbert sphere, this is explained in Subsection 3.2. On Hilbert
9

sphere, we reduce dimension by using principal geodesic analysis (PGA)(Fletcher et al. ,
2004). Eventually each PD is mapped onto a vector of length 2400, a juxtaposition of these
vectors gives a combined feature vector for each image. In the final step, in Subsection 3.3,
we build a model from these feature vectors.
3.1. PDs Associated to a CT-Scan Image
3.1.1. Filtered VR Complex
Before calculating PH we first build feature point cloud (FPC) from a given point cloud.
The FPC is an optimal way to record changes for all values of some chosen feature while
keeping the computational time in a feasible limit.
Let X be the point cloud with a metric dX , and F be a compact feature space endowed
with a metric dF . We define the projection map π : X → F such that π(p) is the feature
of the point p. Let U = {Ui }i∈I be a covering of F , where I is a finite indexing set, the
finiteness is guaranteed by the compactness of F . Using the projection map π, we get a
covering C(X) of X, where C(X) = {π −1 (Ui )}i∈I . Let Γ(X, U) be the connected components
of C(X), that is,
X̄(U) = {V : ∃k ∈ I such that V is connected component of π −1 (Uk )}.
We build a feature point cloud (FPC) by taking vertices to be points of X̄(U). The distance
between two connected components is taken as the distance between their centroids.
For a gray image M, let XM be the point cloud in R3 defined as
XM = {(i, j, p) : p is the intensity value at (i, j)}
For feature space FM = [0, 255], such that π : XM → [0, 255] is defined as π(i, j, p) = p. For
some finite cover W = {Wi }i∈J of FM we get an FPC, denoted as, X̄M (W ). The cover is
chosen in such a way that the resulting FPC provides a good approximation of the PH of
XM . To calculate PH we use filtered Vietoris–Rips complex
V R0 (X̄M (W )) ⊂ V R0.5 (X̄M (W )) ⊂ · · · ⊂ V R500 (X̄M (W )).
where

V Rǫ (X̄M (W )) = A ⊂ X̄M (W ) : dX (a1 , a2 ) < 2ǫ, ∀a1 , a1 ∈ A .

3.1.2. PDs: Capturing the Visible
This filtered complex, defined in the previous section, is able to capture the key features
of a CT-scan, like, peaks, variations in intensity, etc. Connected components and appearance
of loops at different intensity levels are captured in the PD’s of H0 , and H1 respectively (see
Fig. 9). The PDs of H0 and H1 for the images in Fig. 9 are given in Fig. 11. It is evident
that the difference in their visual appearance is captured by these PDs.

10

Figure 9: Comparison of COVID and Non-COVID CT-scans. Difference in the variation of connected
components (H0 ) and (randomly shaped) loops (H1 ) at different intensity levels can be seen.

A peak, which is topologically equivalent to tetrahedron, appear as points at (or near to)
infinity-line in the PD of H2 , that is, a persistent 2-dimensional void (see Fig. 10, 11).

Figure 10: Peaks are captured by VR complex and saddle points are captured by lower-star-filtration

Lower Star Filtration (LSF) captures key features about variation in intensities in an
image. Local minimum and saddle points, in the intensity plot, are vital shape features (see
Fig 10). These features are recorded using LSF. The birth time of a point in this PD is local
minimum and death time is saddle point.
To record these changes, we construct a simplicial complex, say ∆, in the following way.
Each pixel is taken as a vertex, and there is an edge from one vertex to its neighbouring
8 (or less in case its an edge vertex) vertices. This allow us to construct the filtration
∆0 ⊂ ∆1 ⊂ · · · ⊂ ∆255 , where ∆ǫ = {A ⊂ ∆ : maxa∈A p(a) ≤ ǫ}, here p(a) is the pixel value
11

of the vertex a. Only the zero-dimensional PD is essential for our model development. The
Fig.11 shows a major difference between the PDs associated to LSF of a COVID-19 and a
non-COVID-19 CT-scan image.

Figure 11: PDs of H0 , H1 , H2 , and lower-star-filtration of a COVID-19 infected, and a Non-COVID-19
CT-scan

3.2. Statistics on Space of Persistent Diagrams
There are many approaches to infer results from a collection of PD’s, for example, bottleneck distance (Cohen-Steiner et al. , 2007) (and its generalizations), Lp -Wasserstein metric
(Cohen-Steiner et al. , 2010), persistent landscape (Bubenik, 2015), and Riemannian framework (Anirudh et al. , 2016), etc. Due to its efficiency and computational cost, we use
Riemannian framework to perform our statistical analysis, which includes principal geodesic
analysis, and SVM on the space of PD’s. In this approach (see figure 12) we first approximate
a given PD with a 2D probability distribution function (pdf) that are further mapped, using
square-root transformation, onto a Hilbert sphere. On Hilbert sphere we have closed-form
expressions to compare two PD’s. Using this we first apply principal geodesic analysis to
reduce our dimensions., and then we build our model using SVM.

Figure 12: Riemannian framework approach estimates a PD with a pdf, and then maps onto a Hilbert sphere

For each point (a, b) of a PD, we use multivariate normal distribution with parameters
12



0.2 0
and µ = (a, b). We calculate the values of this 2D pdf on the meshgrid
Σ =
0 0.2
[0, 530]2 with a uniform difference of 0.5. Further, we compute square-root representation
of this pdf which maps them on a Hilbert sphere (c.f. (Anirudh et al. , 2016, Section 3.3)).
Hence each PD is converted into a vector of length 10612. To reduce this dimension we apply
Principal Geodesic Analysis (PGA) (Fletcher et al. , 2004) on our Hilbert sphere. This whole
procedure is applied on each collection of PD’s for H0 , H1 , H2 , and on the PD coming from
lower-star-filtration. Hence for a fixed image, each of the four PDs is represented as a vector
of length 2400.
3.3. Model Development
We build the classification model using SVM which tends to perform relatively well on
limited training data sets with high dimensional features. Each of the 2, 480 CT-Scans is
represented by a homology feature vector. We use Principal Component Analysis to reduce
the dimension of each feature vector to 4800. Before training of the SVM, we randomly split
the data in to k-folds (where k = 5); we used (k − 1)-folds for training of the SVM and the
remaining 1-fold for testing stage to validate the performance of the model on a completely
unseen data set. The proposed model, using topological features of H0 , H1 , H2 and LSF,
achieves the classification accuracy of 99.4164% on the test data set.
We use the Radial Basis Function (RBF) kernel for the SVM model and we further select
the optimal hyperparameters using the Bayesian optimization. In particular, we perform
the optimization search to minimize the cross-validation loss (error) by varying the kernel
scale and box constraint. The kernel scaling parameter applies on the input features before
computing the Gram matrix and the box constraint acts as a regularizer to mitigate the
impact of overfitting by penalizing the margin-violating observations. For both parameters,
the model searches for log-scaled positives ranging between 1e−3 and 1e3 .
4. Results and Discussion
We use a publicly available data set “SARS-CoV-2 CT-scan dataset”, which contains
1252 CT scans that are positive, and 1230 CT scans for patients non-infected for COVID-19
infection. These data is collected from patients in hospitals from Sao Paulo, Brazil and made
public in (Angelov & Almeida Soares, 2020; Soares et al. , 2020).
We propose a model based on topological features, these provides a binary classification
for COVID and Non-COVID CT-Scans. Our model is an attempt to capture the features as
observed by a professional medic. These features are picked up by the topological summaries
provided by PDs. Hence making it biologically more interpretable as compared to deep neural
networks. Moreover topological techniques do not need plenty of data to train a model. Table
1 compare the average values of the evaluation metrics achieved by different deep networks
and our topological model.

13

❳❳❳
❳❳
❳❳❳Metric
❳❳
Method
❳❳

Topological Approach
ResNet101 (Alshazly et al. , 2020)
SqueezeNet (Alshazly et al. , 2020)
ResNeXt101 (Alshazly et al. , 2020)
ShuffleNet (Alshazly et al. , 2020)
InceptionV3 (Alshazly et al. , 2020)
ResNeXt50 (Alshazly et al. , 2020)
DenseNet169 (Alshazly et al. , 2020)
DenseNet201 (Alshazly et al. , 2020)
xDNN (Soares et al. , 2020)
Contrastive Learning (Wang et al. , 2020)
Modified VGG19 (Panwar et al. , 2020)
COVID CT-Net (Yazdani et al. , 2020)
DenseNet201 (Jaiswal et al. , 2020)

Accuracy

Precision

Recall

Specificity

F1 Score

99.416 ± 0.27
99.4 ± 0.4
95.1 ± 1.3
99.2 ± 0.3
97.5 ± 0.8
99.1 ± 0.5
99.1 ± 0.5
99.3 ± 0.5
99.2 ± 0.2
97.38
90.8 ± 0.9
95.0
96.2

99.41 ± 0.24
99.6 ± 0.3
94.2 ± 2.0
99.2 ± 0.4
96.1 ± 1.4
98.5 ± 0.8
99.0 ± 0.5
99.4 ± 0.6
99.4 ± 0.4
99.16
95.7 ± 0.4
95.3
96.2

99.416 ± 0.62
99.1 ± 0.6
96.2 ± 1.4
99.3 ± 0.5
99.0 ± 0.2
99.8 ± 0.3
99.3 ± 0.5
99.3 ± 0.5
99.4 ± 0.2
95.53
85.8 ± 1.1
94.0
85.0 ± 0.2
96.2

99.424 ± 0.22
99.6 ± 0.3
94.0 ± 2.2
99.2 ± 0.4
95.9 ± 1.5
98.5 ± 0.8
98.9 ± 0.6
99.3 ± 0.7
98.9 ± 0.4
94.7
96.2 ± 0.1
96.2

99.42 ± 0.26
99.4 ± 0.4
95.2 ± 1.2
99.2 ± 0.3
97.5 ± 0.8
99.1 ± 0.5
99.1 ± 0.5
99.3 ± 0.4
99.2 ± 0.2
97.31
90.8 ± 1.3
94.3
90.0 ± 0.1
96.2

Table 1: The topological model performs better in terms of all metrics than the other state-of-the-art
approaches including the latest deep learning models. See (Alshazly et al. , 2020) for the definitions of
evaluation metrics.

Figure 13: Some samples of COVID-19 and Non-COVID-19 CT-Scans with the predictions of our topological
model.

Some of the topological features are more important than the others, depending on the
input image. The following table present performance of our model by using individual
topological features.
Although LSF feature performs exceptionally well as compared to other features but in
some situations lack of saddle points can make it less reliable. So combining all the features
makes our model more reliable in all situations.

14

❵❵❵
❵❵❵
Metric
❵❵❵
❵
❵
❵❵❵
Top. Feature
❵

H0
H1
H2
LSF

Accuracy

Precision

Recall

Specificity

F1 Score

71.6 ± 2.1
68.5 ± 0.5
64.8 ± 2.1
97.5 ± 0.6

70.3 ± 3.3
67.1 ± 2.6
63.5 ± 1.8
97 ± 1

74 ± 1.1
72.6 ± 7.7
67.7 ± 4.7
98 ± 0.6

69.2 ± 3.7
64.4 ± 8.1
61.9 ± 2.2
97 ± 1

72 ± 1.93
69.5 ± 32.3
65.5 ± 2.5
97.5 ± 0.6

Table 2: Performance metrics for different combinations of topological features

Figure 14: A model using only LSF feature was not able to predict the traces of COVID-19 due to scarcity
of saddle points in the infected region. But all models using all/one of the features H0 , H1 , and H2 detected
it correctly.

4.1. t-Distributed Stochastic Neighbor Embedding Visualization
To visualize the relative position of topological feature vectors coming from the CT-scans
of SARS-CoV-2 we apply t-SNE. In this process we take vectors of length 4800 and map
them to 2D. In Fig 15 we can clearly see two segregated clusters of the COVID-19 and
Non-COVID-19 images.

15

Figure 15: Visualization of the t-SNE embedding of the entire SARS-CoV-2 CT-Scan dataset. We clearly see
two different clusters representing COVID-19 (red) and Non-COVID-19 (blue). It is clear that the embedding
has some of the geometric properties of Hilbert sphere.

4.2. Robustness Analysis
Machine learning algorithms have achieved persuasive performance in several medical
imaging problem but the interpretability of these ML models is very limited and it remains a
significant hurdle in adoption of these models in clinical practice. We perform an experiment
to check the robustness of our model we perform the following procedures.
In the first stage, we removed critical regions (GGOs and consolidations) of interest
from COVID-19 positive cases and then predict its outcome. Secondly, we investigated the
performance of our model on images by randomly removing non-COVID-19 regions. We have
illustrated some COVID-19 cases in Fig. 16, where we covered the GGOs and consolidations
and the model predicted it to be non-COVID-19.
Hence the infected COVID-19 regions are very accurately captured by our chosen topological features and deductively by our model.

16

17
Figure 16: (A) Original images. (B) We covered COVID-19 regions. (C)&(D) We covered random nonCOVID-19 regions.

5. Conclusion
This paper presents a new approach to detect COVID-19 from CT-scan images, using
persistent homology, and achieved state-of-the-art results. The work shows that the techniques of topological data analysis are effective and perform better that most of the deep
neural networks.
This work provides a highly interpretable model based on topological features of CTscans. The model is based on the slogan “mimic a professional medic”. This outperforms
most of cutting edge deep neural network approaches. However it will be interesting to
combine topological features of this work with deep convolutional neural networks, this
is left as an open direction. Chest CT-scan imaging has high sensitivity for diagnosis of
COVID-19 so this is step forward in detecting and hence eliminating COVID-19.
Acknowledgments
The first author is thankful to David Epstein and Saqlain Raza for many fruitful discussions.
References
Ai, Tao, Yang, Zhenlu, Hou, Hongyan, Zhan, Chenao, Chen, Chong, Lv, Wenzhi, Tao, Qian,
Sun, Ziyong, & Xia, Liming. 2020. Correlation of Chest CT and RT-PCR Testing in
Coronavirus Disease 2019 (COVID-19) in China: A Report of 1014 Cases. Radiology.
https://doi.org/10.1148/radiol.2020200642.
Alshazly, Hammam, Linse, Christoph, Barth, Erhardt, & Martinetz, Thomas. 2020. Explainable COVID-19 Detection Using Chest CT Scans and Deep Learning. arXiv preprint
arXiv:2011.05317.
Angelov, Plamen, & Almeida Soares, Eduardo. 2020. EXPLAINABLE-BY-DESIGN APPROACH FOR COVID-19 CLASSIFICATION VIA CT-SCAN. medRxiv.
Anirudh, Rushil, Venkataraman, Vinay, Natesan Ramamurthy, Karthikeyan, & Turaga, Pavan. 2016. A Riemannian framework for statistical analysis of topological persistence
diagrams. 68–76.
Bendich, Paul, Edelsbrunner, Herbert, & Kerber, Michael. 2010. Computing robustness and
persistence for images. IEEE transactions on visualization and computer graphics, 16(6),
1251–1260.
Bubenik, Peter. 2015. Statistical topological data analysis using persistence landscapes. The
Journal of Machine Learning Research, 16(1), 77–102.
Carlsson, Gunnar. 2009. Topology and data. Bulletin of the American Mathematical Society,
46(2), 255–308.
18

Carlsson, Gunnar, Singh, Gurjeet, & Zomorodian, Afra. 2009. Computing multidimensional
persistence. Pages 730–739 of: International Symposium on Algorithms and Computation.
Springer.
Chung, Yu-Min, Hu, Chuan-Shen, Lawson, Austin, & Smyth, Clifford. 2018. Topological
approaches to skin disease image analysis. Pages 100–105 of: 2018 IEEE International
Conference on Big Data (Big Data). IEEE.
Cohen-Steiner, David, Edelsbrunner, Herbert, & Harer, John. 2007. Stability of persistence
diagrams. Discrete & computational geometry, 37(1), 103–120.
Cohen-Steiner, David, Edelsbrunner, Herbert, Harer, John, & Mileyko, Yuriy. 2010. Lipschitz
functions have L p-stable persistence. Foundations of computational mathematics, 10(2),
127–139.
Currie, Geoff, Hawk, K Elizabeth, Rohren, Eric, Vial, Alanna, & Klein, Ran. 2019. Machine
learning and deep learning in medical imaging: intelligent imaging. Journal of Medical
Imaging and Radiation Sciences, 50(4), 477–487.
de Silva, Vin, & Ghrist, Robert. 2007. Coverage in sensor networks via persistent homology.
Algebr. Geom. Topol., 7(1), 339–358.
Deng, Jia, Dong, Wei, Socher, Richard, Li, Li-Jia, Li, Kai, & Fei-Fei, Li. 2009. Imagenet:
A large-scale hierarchical image database. Pages 248–255 of: 2009 IEEE conference on
computer vision and pattern recognition. Ieee.
Edelsbrunner, Herbert, Letscher, David, & Zomorodian, Afra. 2000. Topological persistence
and simplification. Pages 454–463 of: Proceedings 41st annual symposium on foundations
of computer science. IEEE.
Fletcher, P Thomas, Lu, Conglin, Pizer, Stephen M, & Joshi, Sarang. 2004. Principal
geodesic analysis for the study of nonlinear statistics of shape. IEEE transactions on
medical imaging, 23(8), 995–1005.
Frosini, Patrizio, & Landi, Claudia. 2013. Persistent Betti numbers for a noise tolerant
shape-based approach to image retrieval. Pattern Recognition Letters, 34(8), 863–872.
Garside, Kathryn, Henderson, Robin, Makarenko, Irina, & Masoller, Cristina. 2019. Topological data analysis of high resolution diabetic retinopathy images. PloS one, 14(5),
e0217413.
Hiraoka, Yasuaki, Nakamura, Takenobu, Hirata, Akihiko, Escolar, Emerson G, Matsue,
Kaname, & Nishiura, Yasumasa. 2016. Hierarchical structures of amorphous solids characterized by persistent homology. Proceedings of the National Academy of Sciences, 113(26),
7035–7040.

19

Huang, Chaolin, Wang, Yeming, Li, Xingwang, Ren, Lili, Zhao, Jianping, Hu, Yi, Zhang,
Li, Fan, Guohui, Xu, Jiuyang, Gu, Xiaoying, Cheng, Zhenshun, Yu, Ting, Xia, Jiaan,
Wei, Yuan, Wu, Wenjuan, Xie, Xuelei, Yin, Wen, Li, Hui, Liu, Min, Xiao, Yan, Gao,
Hong, Guo, Li, Xie, Jungang, Wang, Guangfa, Jiang, Rongmeng, Gao, Zhancheng, Jin,
Qi, Wang, Jianwei, & Cao, Bin. 2020. Clinical features of patients infected with 2019 novel
coronavirus in Wuhan, China. The Lancet, 395(10223), 497–506.
Jaiswal, Aayush, Gianchandani, Neha, Singh, Dilbag, Kumar, Vijay, & Kaur, Manjit. 2020.
Classification of the COVID-19 infected patients using DenseNet201 based deep transfer
learning. Journal of Biomolecular Structure and Dynamics, 1–8.
Kasson, Peter M., Zomorodian, Afra, Park, Sanghyun, Singhal, Nina, Guibas, Leonidas J.,
& Pande, Vijay S. 2007. Persistent voids: a new structural metric for membrane fusion.
Bioinformatics, 23(14), 1753–1759.
Kong, Weifang, & Agarwal, Prachi P. 2020. Chest Imaging Appearance of COVID-19 Infection. Radiology: Cardiothoracic Imaging, 2(1). https://doi.org/10.1148/ryct.2020200028.
Lee, H., Kang, H., Chung, M. K., Kim, B., & Lee, D. S. 2012. Persistent Brain Network
Homology From the Perspective of Dendrogram. IEEE Transactions on Medical Imaging,
31(12), 2267–2277.
Li, Xiaoming, Zeng, Wenbing, Li, Xiang, Chen, Haonan, Shi, Linping, Li, Xinghui, Xiang,
Hongnian, Cao, Yang, Chen, Hui, Liu, Chen, & Wang, Jian. 2020. CT imaging changes of
corona virus disease 2019 (COVID-19): a multi-center study in Southwest China. Journal
of Translational Medicine, 18. https://doi.org/10.1186/s12967-020-02324-w.
Liu, Xu, Xie, Zheng, Yi, Dongyun, et al. . 2012. A fast algorithm for constructing topological
structure in large data. Homology, Homotopy and Applications, 14(1), 221–238.
Otter, Nina, Porter, Mason A, Tillmann, Ulrike, Grindrod, Peter, & Harrington, Heather A.
2017. A roadmap for the computation of persistent homology. EPJ Data Science, 6(1),
17.
Panwar, Harsh, Gupta, PK, Siddiqui, Mohammad Khubeb, Morales-Menendez, Ruben,
Bhardwaj, Prakhar, & Singh, Vaishnavi. 2020. A deep learning and grad-CAM based
color visualization approach for fast detection of COVID-19 cases using chest X-ray and
CT-Scan images. Chaos, Solitons & Fractals, 140, 110190.
Qaiser, Talha, Sirinukunwattana, Korsuk, Nakane, Kazuaki, Tsang, Yee-Wah, Epstein,
David, & Rajpoot, Nasir M. 2016. Persistent homology for fast tumor segmentation in
whole slide histology images. Procedia Computer Science, 90, 119–124.
Qaiser, Talha, Tsang, Yee-Wah, Epstein, David, & Rajpoot, Nasir. 2017. Tumor segmentation in whole slide images using persistent homology and deep convolutional features.
Pages 320–329 of: Annual Conference on Medical Image Understanding and Analysis.
Springer.
20

Qaiser, Talha, Tsang, Yee-Wah, Taniyama, Daiki, Sakamoto, Naoya, Nakane, Kazuaki, Epstein, David, & Rajpoot, Nasir. 2019. Fast and accurate tumor segmentation of histology
images using persistent homology and deep convolutional features. Medical Image Analysis, 55, 1 – 14.
Rieck, Bastian, Mara, Hubert, & Leitte, Heike. 2012. Multivariate data analysis using
persistence-based filtering and topological signatures. IEEE Transactions on Visualization
and Computer Graphics, 18(12), 2382–2391.
Rotman, Joseph J. 2013. An introduction to algebraic topology. Vol. 119. Springer Science
& Business Media.
Ruder, Sebastian. 2019. Neural transfer learning for natural language processing. Ph.D.
thesis, NUI Galway.
Ruder, Sebastian, Peters, Matthew E, Swayamdipta, Swabha, & Wolf, Thomas. 2019. Transfer learning in natural language processing. Pages 15–18 of: Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics:
Tutorials.
Soares, Eduardo, Angelov, Plamen, Biaso, Sarah, Froes, Michele Higa, & Abe, Daniel Kanda.
2020. SARS-CoV-2 CT-scan dataset: A large dataset of real patients CT scans for SARSCoV-2 identification. medRxiv.
Tahamtan, Alireza, & Ardebili, Abdollah. 2020. Real-time RT-PCR in COVID-19 detection: issues affecting the results. Expert review of molecular diagnostics, 20, 453–454.
doi:10.1080/14737159.2020.1757437.
Tralie, Christopher, Saul, Nathaniel, & Bar-On, Rann. 2018. Ripser.py: A Lean Persistent
Homology Library for Python. The Journal of Open Source Software, 3(29), 925.
Voulodimos, Athanasios, Doulamis, Nikolaos, Doulamis, Anastasios, & Protopapadakis,
Eftychios. 2018. Deep learning for computer vision: A brief review. Computational intelligence and neuroscience, 2018.
Wang, Bao, & Wei, Guo-Wei. 2016. Object-oriented persistent homology. Journal of computational physics, 305, 276–299.
Wang, Zhao, Liu, Quande, & Dou, Qi. 2020. Contrastive Cross-Site Learning With Redesigned Net for COVID-19 CT Classification. IEEE Journal of Biomedical and Health
Informatics, 24(10), 2806–2813.
Yao, Yuan, Sun, Jian, Huang, Xuhui, Bowman, Gregory R, Singh, Gurjeet, Lesnick, Michael,
Guibas, Leonidas J, Pande, Vijay S, & Carlsson, Gunnar. 2009. Topological methods for
exploring low-density states in biomolecular folding pathways. The Journal of chemical
physics, 130(14), 04B614.
21

Yazdani, Shakib, Minaee, Shervin, Kafieh, Rahele, Saeedizadeh, Narges, & Sonka, Milan.
2020. Covid ct-net: Predicting covid-19 from chest ct images using attentional convolutional network. arXiv preprint arXiv:2009.05096.

22

