A Basket Half Full: Sparse Portfolios ∗
Ekaterina Seregina†

arXiv:2011.04278v1 [econ.EM] 5 Nov 2020

October 18, 2020

Abstract
The existing approaches to sparse wealth allocations (1) are suboptimal due to
the bias induced by `1 -penalty; (2) require the number of assets to be less than the
sample size; (3) do not model factor structure of stock returns in high dimensions. We
address these shortcomings and develop a novel strategy which produces unbiased
and consistent sparse allocations. We demonstrate that: (1) failing to correct for the
bias leads to low out-of-sample portfolio return; (2) only sparse portfolios achieved
positive cumulative return during several economic downturns, including the dot-com
bubble of 2000, the financial crisis of 2007-09, and COVID-19 outbreak.
Keywords: High-dimensionality, Portfolio Optimization, Factor Investing, De-biasing,
Post-Lasso, Approximate Factor Model
JEL Classifications: C13, C55, C58, G11, G17

∗

I greatly appreciate thoughtful comments and immense support from Tae-Hwy Lee, Jean Helwege,
Jang-Ting Guo, Aman Ullah, Matthew Lyle, Varlam Kutateladze and UC Riverside Finance faculty.
†
Correspondence to: Department of Economics, University of California, Riverside, CA 92521, USA.
E-mail: ekaterina.seregina@email.ucr.edu.
This research did not receive any specific grant from funding agencies in the public, commercial, or not-for-profit sectors. Declarations
of interest: none.

1

Introduction

The research on portfolio allocation dates back to Markowitz (1952) – a successful strategy should demonstrate good out-of-sample (OOS) performance in terms of the portfolio
risk and return, and the constructed portfolio should be cheap and easy to maintain and
monitor. Any portfolio allocation problem requires the inverse covariance matrix, or precision matrix, of excess stock returns as an input. In the era of big data, a search for the
optimal portfolio becomes a high-dimensional problem: the number of assets, p, is comparable to or greater than the sample size, T . This creates two major challenges to the standard optimization strategies. First, monitoring and transaction costs of a high-dimensional
portfolio might be prohibitively large. Second, using a sample covariance matrix as an input to the portfolio allocation problem is either infeasible, or produces unstable solutions
for weights. In this paper we propose a novel approach to a high-dimensional “investor’s
problem” which addresses the aforementioned issues.
All investors, ranging from beginner traders to billion-dollar corporations, encounter
the same fundamental problem: which stocks to buy and how much to invest in them.
One of the common strategies mentioned by Lyle and Yohn (2020) is to pick a few topperforming stocks. However, natural questions are when do you stop and is there any guarantee that the best-performers of the last month or year will still demonstrate superior performance
today? These questions relate to the stream of literature that studies short-term reversals
and momentum. For instance, the papers by Jegadeesh (1990) and Lehmann (1990) show
that contrarian strategies that select stocks based on their returns in the previous week or
month generate significant abnormal returns. However, as pointed out by Jegadeesh and
Titman (1993), the evidence favoring contrarian strategies focuses on trading strategies
based on either very short-term return reversals (1 week or 1 month), or very long-term
reversals (3 to 5 years). At the same time, the rules used by practitioners are based on
the selections on price movements over the past 6 to 12 months.1 Jegadeesh and Titman
(1993) find out that the past winners realize consistently higher return around their earn1

See Value Line rankings which assign a timeliness rank for each stock based on the stock’s past 6-to
12-month returns.

1

ings announcements in the 7 month following the portfolio formation date than do past
losers. Using an example of the recent COVID-19 outbreak, we illustrate that all strategies
that select past winners over the last 5 months produced negative return in the first wave
of the pandemic, rendering the findings of Jegadeesh and Titman (1993) not robust to the
change in the stock market structure brought by economic downturns.
To illustrate, Figure 1 depicts the partial correlation networks of the S&P500 components in 2019 (252 trading days, preceding COVID-19 pandemic), and in 2020 (185 trading
days from January 2 to September 24, during COVID-19 outbreak) using daily log returns
of 495 stocks. The analysis of these two periods helps understand the structure and dynamic of financial networks affected by the pandemic. Based on the GICS codes from the
Compustat and CRSP, we identified 11 major sectors: Communication Services, Consumer
Discretionary, Consumer Staples, Energy, Financials, Health Care, Industrials, Information Technology, Materials, Real Estate and Utilities. The presence of an edge between
two nodes (sectors) in Figure 1 indicates non-negligible partial correlation between them;
the size of a node shows its “degree”, i.e. the number of edges within the sector and the
number of edges between this sector and other sectors. For instance, the node that corresponds to Financials has only one edge, however, its degree is relatively large due to
many edges within the Financials sector. As evidenced by Figure 1, following the pandemic in 2020, the Health Care sector has become a hub connecting at least 4 sectors, and
its degree has increased compared to 2019. Table 1 demonstrates that relying on the top
past performers does not adequately address the change in the financial network structure
brought by COVID-19: using daily returns of 495 components of the S&P500 from May 25,
2018 – September 24, 2020 (588 obs.), Table 1 reports the performance of portfolios that
use the stocks that exhibited the best performance in terms of the average return over the
last 5 months (121 days). Portfolios that include 10, 30, 50, 100 and 200 best performing
stocks are denoted Best10, Best30, Best50, Best100, and Best200, respectively. We use May
25, 2018 – October 23, 2018 (105 obs.) as a training period and October 24, 2018 – September 24, 2020 (483 obs.) as the out-of-sample test period. We roll the estimation window
over the test sample to rebalance the portfolios monthly. The left panel of Table 1 shows
return, risk and Sharpe Ratio of portfolios over the training period, and the right panel
2

Figure 1: Partial correlation networks of S&P 500 sectors in 2019 (preceding COVID-19 pandemic, left)
and in 2020 (during COVID-19 outbreak, right).

reports cumulative excess return (CER) and risk over two sub-periods of interest: before
the pandemic (January 2, 2019 – December 31, 2019) and during COVID-19 outbreak in
the US (January 2, 2020 – June 30, 2020). As evidenced by Table 1, none of the portfolios
was robust to the downturn brought by pandemic and yielded negative CER. Therefore,
we need more theoretical guarantees related to the stock picking exercise, other than good
past performance.
One popular method to create a sparse portfolio, that is, a portfolio with many zero entries in the weight vector, is by introducing an `1 -penalty (Lasso) on the portfolio weights
which shrinks some of them to zero (see Fan et al. (2019), Ao et al. (2019), Li (2015), Brodie
et al. (2009) among others). This approach handles the problem of stock picking, however
it has several drawbacks: (1) it is established that the Lasso-based estimator is biased (see
Belloni et al. (2015); Javanmard and Montanari (2014a,b); Javanmard et al. (2018); van de
Geer et al. (2014); Zhang and Zhang (2014) among others). This issue becomes one of
the examples when, if not adequately addressed, a well-recognized statistical problem
3

Total OOS Performance
10/24/19–09/24/20
Best10
Best30
Best50
Best100
Best200

Before the Pandemic During the Pandemic
01/02/19–12/31/19
01/02/20–06/30/20

Return

Risk

Sharpe Ratio

CER

Risk

CER

Risk

-0.0293
-0.0132
0.0181
-0.0861
0.0063

1.5478
1.4744
1.6157
3.8126
1.5541

-0.0189
-0.0090
0.0111
-0.0226
0.0041

-3.3748
19.9202
28.8664
-2.0883
7.7683

1.0448
0.8204
0.9305
3.0643
0.7941

-5.9645
-11.6194
-7.4551
-43.0285
-6.8099

2.1522
2.2708
2.5603
4.9452
2.6036

Table 1: Performance of portfolios that use the stocks that exhibited the best performance in terms of the
average return over the last 5 months: return (×100), risk (×100) and Sharpe Ratio over the training
period (left), CER (×100) and risk (×100) over two sub-periods (right). Weights are estimated using the
standard Global Minimum Variance formula. In-sample: May 25, 2018 – October 23, 2018 (105 obs.),
Out-of-sample (OOS): October 24, 2018 – September 24, 2020 (483 obs.)

has a detrimental effect on asset allocation: downward-biased weight estimates can cause
very low or negative portfolio return, eliminating all benefits from even the most elaborate Lasso-based stock picking exercise. To the best of our knowledge, none of the existing
papers that study sparse portfolio allocations correct for the bias in the estimated weights
to address this problem. (2) All existing papers that study sparse portfolio consider the
i.i.d. case and when p/T → (0, 1). However, in the era of big data the investors often deal
with the case when p ≥ T . Therefore, it is important to study the properties of portfolio
weights for large portfolios even when p > T . (3) It has long been documented in many
empirical studies that stock returns follow factor structure. However, in high-dimensions
the estimators of eigenvalues and eigenvectors are not consistent, rendering inconsistent
estimates of factors and factor loadings. None of the existing papers that study sparse
portfolio allocations addresses this issue. The main theoretical contribution of this paper
is that we develop a novel estimator for sparse asset allocations based on the de-biased
Lasso and post-Lasso that addresses all of the aforementioned limitations. Relatedly, unbiasedness and consistency of the proposed estimator are established. Furthermore, in
contrast to the existing literature, our approach is suitable for several different optimal
portfolio formulations depending on the investors’ preferences.
Our empirical application to the components of S&P500 for monthly and daily data
supports the claim that without correcting for the bias, sparse allocations are too conser4

Total OOS Performance
10/24/19–09/24/20
EW
Index
MB
NC Lasso
Our post-Lasso

Before the Pandemic During the Pandemic
01/02/19–12/31/19
01/02/20–06/30/20

Return

Risk

Sharpe Ratio

CER

Risk

CER

Risk

0.0108
0.0351
0.0322
-0.0003
0.1247

1.8781
1.7064
1.6384
0.0107
1.7254

0.0058
0.0206
0.0196
-0.0250
0.0723

28.5420
27.8629
29.6292
-0.1274
45.2686

0.8010
0.7868
0.6856
0.0148
1.0386

-19.7207
-9.0802
-11.7431
-0.0021
12.4196

3.3169
2.9272
2.8939
0.0002
2.8554

Table 2: Performance of non-sparse and sparse portfolios: return (×100), risk (×100) and Sharpe Ratio
over the training period (left), CER (×100) and risk (×100) over two sub-periods (right). Weights are
estimated using the standard Global Minimum Variance formula. In-sample: May 25, 2018 – October 23,
2018 (105 obs.), Out-of-sample (OOS): October 24, 2018 – September 24, 2020 (483 obs.)

vative and lead to low OOS portfolio return. To illustrate, consider one of the sub-periods
from an extensive empirical exercise from Section 7: in Table 2 we use the same daily returns data as for Table 1 to compare the performance of Lasso-based portfolios without
bias correction (NC Lasso) studied in Ao et al. (2019) with several strategies: equal-weight
portfolio (EW), composite S&P500 index (Index), a recently developed high-dimensional
strategy that uses nodewise regression (MB, Callot et al. (2019)), and our technique proposed in this paper (Our post-Lasso). It is worth emphasizing that EW, Index and MB are
not sparse strategies: all stocks even with very small weights are included in these portfolios. In contrast, NC Lasso and post-Lasso form a sparse allocation: they choose a subset
out of all available stocks. Table 2 illustrates three key points: (1) as expected, downward
bias of NC Lasso leads to almost negligible portfolio return; (2) none of portfolios that
use all stocks achieved positive CER following COVID-19 outbreak in the US, despite an
impressive performance in the preceding year, in contrast, our post-Lasso sparse strategy
achieved high positive CER even during the pandemic at the level of risk lower than other
techniques; (3) using the information from Table 1 and Table 2, our post-Lasso sparse
strategy outperforms portfolios that hold past best-performing stocks. Figure 2 shows the
stocks selected by post-Lasso in August, 2019 and in May, 2020: the colors serve as a visual guide to identify groups of closely-related stocks (stocks of the same color do not
necessarily correspond to the same sector).
As has been mentioned above, to get optimal weights for any portfolio optimization
5

problem one needs an estimator of the precision matrix. Another theoretical contribution
of our paper is that we develop a novel estimator of a high-dimensional precision matrix
that combines the benefits of graphical models and factor structure. Instead of taking the
standard approach of estimating and inverting the covariance matrix, we estimate a precision matrix directly. It is a two-step procedure: first, we decompose precision matrix into
low-rank and sparse components, then we apply a nodewise regression technique (Meinshausen and Bühlmann (2006)) to the factor-adjusted stock returns. We call the proposed
algorithm Factor Nodewise Regression (FMB). It allows us to estimate a high-dimensional
precision matrix when the returns are driven by the common factors even when the sample covariance matrix is not invertible. Furthermore, in contrast to the existing precision
matrix estimators, our approach does not require any assumptions on the sparsity of the
covariance or precision matrix of stock returns.
In addition to the aforementioned theoretical contributions, our paper provides several practical insights. We use daily and monthly data for the constituents of the S&P500
and reveal that (1) non-sparse high-dimensional portfolios almost always violate the risk
constraint out-of-sample; (2) sparse allocations without bias correction lead to low OOS
return, whereas correcting for bias leads to uniformly higher OOS return and Sharpe Ratio; (3) sparse portfolios are characterized by lower risk, lower turnover, and higher Sharpe
Ratio compared to non-sparse portfolios; (4) only sparse portfolios achieved positive cumulative excess return during several economic downturns, including (but not limited
to) the dot-com bubble of 2000, the financial crisis of 2007-09 and the recent COVID-19
outbreak; (5) accounting for the factor structure in the portfolio allocation problem leads
to improved performance in terms of the OOS portfolio return and Sharpe Ratio.
Motivated by the superior performance of the factor-based portfolios compared to nonfactor-based counterparts, we examine whether using factors as investment vehicles in addition to individual assets improves portfolio performance in terms of the out-of-sample
Sharpe Ratio. This framework is known as factor investing and it was shown to increase
portfolio return (Ao et al. (2019)). The goal of factor investing is to decide how much
weight is allocated to factors, and how much weight is allocated to individual stocks.
However, to the best of our knowledge, there are no established guidelines regarding the
6

criteria for this allocation. Another methodological contribution of this paper is that we
propose a novel simple approach which provides clear guidelines how to determine the
weight of factors and stocks in the portfolio under factor investing. Our framework also
allows to test whether using factors as investment vehicles significantly contributes to the
return of the portfolio.
This paper is organized as follows: Section 2 introduces sparse de-biased portfolio and
sparse portfolio using post-Lasso. Section 3 develops a new high-dimensional precision
estimator called Factor Nodewise regression. Section 4 develops a framework for factor
investing. Section 5 contains theoretical results and and Section 6 validates these results
using simulations. Section 7 provides empirical application. Section 8 concludes.

Notation
For the convenience of the reader, we summarize the notation to be used throughout
the paper. Let Sp denote the set of all p × p symmetric matrices, Sp+ denotes the set of all
p × p positive semi-definite matrices, and Sp++ denotes the set of all p × p positive definite
matrices. Given a vector u ∈ Rd and parameter a ∈ [1, ∞), let kuka denote la -norm. Given a
matrix U ∈ Sp , let Λmax (U) := Λ1 (U) ≥ Λ2 (U) ≥ . . . Λmin (U) := Λp (U) be the eigenvalues
of U, and eigK (U) ∈ RK×p denote the first K ≤ p normalized eigenvectors corresponding
to Λ1 (U), . . . ΛK (U). Given parameters a, b ∈ [1, ∞), let |||U|||a,b denote the induced matrixP
operator norm maxkyka =1 kUykb . The special cases are |||U|||1 := max1≤j≤p pi=1 |Ui,j | for the
l1 /l1 -operator norm; the operator norm (l2 -matrix norm) |||U|||22 := Λmax (UU0 ) is equal to
P
the maximal singular value of U; |||U|||∞ := max1≤j≤p pi=1 |Uj,i | for the l∞ /l∞ -operator
norm. Finally, kUkmax denotes the element-wise maximum maxi,j |Ui,j |, and |||U|||2F =
P
2
i,j ui,j denotes the Frobenius matrix norm. We use a .P b to denote a = OP (b), a ∨ b =
max{a, b}, and a ∧ b = min{a, b}. For an event A, we say that A wp → 1 when A occurs
with probability approaching 1 as T increases.

2

Sparse Portfolios

There exist several widely used portfolio weight formulations depending on the type
of optimization problem solved by an investor. Suppose we observe p assets (indexed by
7

i) over T period of time (indexed by t). Let rt = (r1t , r2t , . . . , rpt )0 ∼ D(m, Σ) be a p × 1
vector of excess returns drawn from a distribution D. In this section we do not require any
assumptions on D but depending on the setup, we will introduce necessary restrictions in
the next sections. The goal of the Markowitz theory is to choose assets weights in a portfolio optimally. We will study two criteria of optimality: the first is a well-known Markowitz
weight-constrained optimization problem, and the second formulation relaxes constraints
on portfolio weights.
The first optimization problem, which will be referred to as Markowitz weight-constrained
problem (MWC), searches for assets weights such that the portfolio achieves a desired expected rate of return with minimum risk, under the restriction that all weights sum up to
one. The aforementioned goal can be formulated as the following quadratic optimization
problem:
1
min w0 Σw, s.t. w0 ι = 1 and m0 w ≥ µ,
w 2

(2.1)

where w is a p × 1 vector of assets weights in the portfolio, ι is a p × 1 vector of ones,
and µ is a desired expected rate of portfolio return. Let Θ := Σ−1 be the precision matrix.
The constraint in (2.1) requires portfolio weights to sum up to one - this assumption can
be easily relaxed and we will demonstrate the implications of this constraint on portfolio
weights.
If m0 w > µ, then the solution to (2.1) yields the global minimum-variance (GMV) portfolio weights wGM V :
wGM V = (ι0 Θι)−1 Θι.

(2.2)

If m0 w = µ, the solution to (2.1) is
wM W C = (1 − a1 )wGM V + a1 wM ,

(2.3)

wM = (ι0 Θm)−1 Θm,
µ(m0 Θι)(ι0 Θι) − (m0 Θι)2
,
a1 =
(m0 Θm)(ι0 Θι) − (m0 Θι)2

(2.4)
(2.5)

where wM W C denotes the portfolio allocation with the constraint that the weights need to
sum up to one and wM captures all mean-related market information.

8

The second optimization problem, which will be referred to as Markowitz risk-constrained
(MRC) problem, has the same objective as in (2.1), but portfolio weights are not required
to sum up to one:
1
min w0 Σw
w 2

s.t. m0 w ≥ µ.

(2.6)

It can be easily shown that the solution to (2.6) is:
w1∗ =

µΘm
.
m0 Θm

(2.7)

Alternatively, instead of searching for a portfolio with a specified desired expected rate of
return and minimum risk, one can maximize expected portfolio return given a maximum
risk-tolerance level:
max w0 m
w

s.t. w0 Σw ≤ σ 2 .

(2.8)

In this case, the solution to (2.8) yields:
w2∗ =

σ2
σ2
Θm
=
Θm.
w0 m
µ

(2.9)

To get the second equality in (2.9) I used the definition of µ from (2.1) and (2.6). It follows
√
that if µ = σ θ, where θ := m0 Θm is the squared Sharpe Ratio, then the solution to (2.6)
and (2.8) admits the following expression:
σ
σ
wM RC = √
Θm = √ α,
0
m Θm
θ

(2.10)

where α := Θm. Equation (2.10) tells us that once an investor specifies the desired return,
µ, and maximum risk-tolerance level, σ, this pins down the Sharpe Ratio of the portfolio
which makes the optimization problems of minimizing risk and maximizing expected return of the portfolio in (2.6) and (2.8) identical.
This brings us to three alternative portfolio allocations commonly used in the existing literature: Global Minimum-Variance Portfolio in (2.2), weight-constrained Markowitz
Mean-Variance in (2.3) and maximum-risk-constrained Markowitz Mean-Variance in (2.10).

9

Below I summarize the aforementioned portfolio weight expressions:
GMV:

wGM V = (ι0 Θι)−1 Θι,

(2.11)

MWC

wM W C = (1 − a1 )wGM V + a1 wM ,

(2.12)

where

wM = (ι0 Θm)−1 Θm,
µ(m0 Θι)(ι0 Θι) − (m0 Θι)2
a1 =
,
(m0 Θm)(ι0 Θι) − (m0 Θι)2
σ
wM RC = √ α,
θ
α = Θm,

MRC:
where

(2.13)

θ := m0 Θm.
So far we have considered allocation strategies that put non-zero weights to all assets
in the financial portfolio. As an implication, an investor needs to buy a certain amount of
each security even if there are a lot of small weights. However, oftentimes investors are
interested in managing a few assets which significantly reduces monitoring and transaction costs and was shown to outperform equal weighted and index portfolios in terms of
the Sharpe Ratio and cumulative return (see Fan et al. (2019), Ao et al. (2019), Li (2015),
Brodie et al. (2009) among others). This strategy is based on holding a sparse portfolio, that
is, a portfolio with many zero entries in the weight vector. In this paper we combine the
ideas from the literature on de-biasing in high-dimensional models with sparse financial
portfolio. We apply the Factor Nodewise regression described in Algorithm 3 within this
framework to account for the factor structure in stock returns.

2.1

Sparse De-Biased Portfolio

Let us first introduce some notations. The sample mean and sample covariance matrix
1 PT
1 PT
0
b
b t − m)
b . Our empirical
b =
have standard formulas: m
t=1 rt and Σ =
t=1 (rt − m)(r
T
T
application shows that risk-constrained Markowitz allocation in (2.13) outperforms GMV
and MWC portfolios in (2.11)-(2.12). Therefore, we first study sparse MRC portfolios.
Our goal is to construct a sparse vector of portfolio weights given by (2.13). To achieve
this we use the following equivalent and unconstrained regression representation of the

10

mean-variance optimization in (2.6) and (2.8):
wM RC = argmin E[rc − w0 rt ] ,

where rc :=

w

1+θ
1+θ
µ≡σ √ .
θ
θ

(2.14)

The sample counterpart of (2.14) is written as:
wM RC = argmin
w

T
1X
(rc − w0 rt )2 .
T t=1

(2.15)

Ao et al. (2019) prove that the weight allocation from (2.14) is equivalent to (2.13). The
sparsity is introduced through Lasso which yields the following constrained optimization
problem:
wMRC, SPARSE

T
1X
= argmin
(rc − w0 rt )2 + 2λkwk1 .
w T
t=1

(2.16)

Now we propose two extensions to the setup (2.16). First, the estimator wMRC, SPARSE
is infeasible since θ used for constructing rc is unknown. Ao et al. (2019) construct an
estimator of θ under normally distributed excess returns, assuming p/T → ρ ∈ (0, 1) and
the sample size T is required to be larger than the number of assets p. Their paper uses
b −1 m
b 0Σ
b −
an unbiased estimator proposed in Kan and Zhou (2007): θ̂ = ((T − p − 2)m
b −1 are sample mean and inverse of the sample covariance matrix
b and Σ
p)/T , where m
respectively. One of the limitations of the model studied by Ao et al. (2019) is that it cannot
handle high dimensions. In both simulations and empirical application the maximum
number of stocks used by the authors is limited to 100. Another limitation of Ao et al.
(2019) approach is that they do not correct the bias introduced by imposing l1 -constraint
in (2.16). However, it is well-known that the estimator in (2.16) is biased and the existing
literature proposes several de-biasing techniques (see Belloni et al. (2015); Javanmard and
Montanari (2014a,b); Javanmard et al. (2018); van de Geer et al. (2014); Zhang and Zhang
(2014) among others).
To approach the first aforementioned limitation, we propose to use an estimator of a
high-dimensional precision matrix discussed in the next section. The suggested estimator is appropriate for high-dimensional settings, it can handle cases when the sample size
is less than the number of assets, and it is always non-negative by construction2 . Conseb −1 m
b 0Σ
b − p)/T is oftentimes
Our empirical results suggest that the unbiased estimator θ̂ = ((T − p − 2)m
negative even after using the adjusted estimator defined in Kan and Zhou (2007) (p. 2906).
2

11

quently, the estimator of rc is
1 + θ̂

1 + θ̂
(2.17)
µ≡σ p .
θ̂
θ̂
To approach the second limitation, motivated by van de Geer et al. (2014), we propose
rbc :=

the de-biasing technique that uses the nodewise regression estimator of the precision matrix. First, let R be a T × p matrix of excess returns stacked over time and b
rc be a T × 1
constant vector. Consider a high-dimensional linear model
b
rc = Rw + e,

where e ∼ D(0, σe2 I).

(2.18)

We study high-dimensional framework p ≥ T and in the asymptotic results we require
log(p)/T = o(1). Let us rewrite (2.16):
wMRC, SPARSE = arg minp
w∈R

1
kb
rc − Rwk22 + 2λkwk1 .
T

(2.19)

The estimator in (2.16) satisfies the following KKT conditions:
b
− R0 (b
rc − Rw)/T
+ λb
g = 0,
kb
gk∞ ≤ 1 and gˆi = sign(ŵi ) if

(2.20)
ŵi 6= 0.

(2.21)

b = R0 R/T , then we
b is a p × 1 vector arising from the subgradient of kwk1 . Let Σ
where g
can rewrite the KKT conditions:
b w
b − w) + λb
Σ(
g = R0 e/T.

(2.22)

b which is obtained from Algorithm 3 and rearrange the
Multiply both sides of (2.22) by Θ
terms:
b g = ΘR
b 0 e/T −
b − w + Θλb
w

√
√
bΣ
b − Ip )(w
b − w) / T .
T (Θ
|
{z
}

(2.23)

∆

In the section with the theoretical results we show that ∆ is asymptotically negligible under certain sparsity assumptions3 . Combining (2.20) and (2.23) brings us to the de-biased
estimator of portfolio weights:
b g=w
b 0 (b
b MRC, DEBIASED = w
b + Θλb
b + ΘR
b
w
rc − Rw)/T.

(2.24)

The properties of the proposed de-biased estimator are examined in Section 5.
3

Note that we cannot directly apply Theorem 2.2 of van de Geer et al. (2014) since rc needs to be estimated
and we first need to show consistency of the respective estimator.

12

2.2

Sparse Portfolio Using Post-Lasso
One of the drawbacks of the de-biased portfolio weights in (2.24) is that the weight

formula is tailored to a specific portfolio choice that maximizes an unconstrained Sharpe
Ratio (i.e. MRC in (2.13)). However, it is desirable to accommodate preferences of different types of investors who might be interested in weight allocations corresponding to
GMV ((2.11)) or MWC ((2.12)) portfolios. At the same time, we are willing to stay within
the framework of sparse allocations. One of the difficulties that precludes us from pursuing a similar technique as in (2.16) is the fact that once the weight constraint is added, the
optimization problem in (2.16) has two solutions depending on whether ι0 Θm is positive
or negative. As shown in Maller and Turkington (2003), when ι0 Θm < 0, the minimum
value cannot be achieved exactly for a specified portfolio allocation that satisfies the full
investment constraint. Hence, one can design an approximate solution to approach the
supremum as closely as desired.
To overcome this difficulty, we propose to use Lasso regression in (2.19) for selecting
a subset of stocks, and then constructing a financial portfolio using any of the weight formulations in (2.11)-(2.13). The procedure to estimate sparse portfolio using post-Lasso is
described in Algorithm 1.
Algorithm 1 Sparse Portfolio Using Post-Lasso
1:

b := support(w)
b
Use Lasso regression in (2.19) to select the model Ξ
• Apply additional thresholding to remove stocks with small estimated weights:
b
w(t)
= (w
bj 1 [|w
bj | > t] , j = 1, . . . , p),
where t ≥ 0 is the thresholding level.
b
:= support(w(t)).
b
• The corresponding selected model is denoted as Ξ(t)
When
b = Ξ.
b
t = 0, Ξ(t)

2:

Choose a desired portfolio formulation in (2.11)-(2.13) and apply it to the selected
b
subset of stocks Ξ(t).
b
• When card(Ξ(t))
<e
t, use the inverse of the sample covariance matrix as an estimator of Θ. Otherwise, apply the estimator of precision matrix described in
Section 3.

13

3

Factor Nodewise Regression

In this section we first review a nodewise regression (Meinshausen and Bühlmann
(2006)), a popular approach to estimate a precision matrix. After that we propose a novel
estimator which accounts for the common factors in the excess returns.
Define rt to be a p × 1 vector at time t = 1, . . . , T . Let rt ∼ D(m, Σ), where D belongs
to either sub-Gaussian or elliptical families. When D = N , the precision matrix Σ−1 := Θ
contains information about conditional dependence between the variables. For instance,
if Θij , which is the ij-th element of the precision matrix, is zero, then the variables i and j
are conditionally independent, given the other variables. In the high-dimensional settings
it is necessary to regularize the precision matrix, which means that some of the entries Θij
will be zero. In other words, to achieve consistent estimation of the inverse covariance, the
estimated precision matrix should be sparse.

3.1

Nodewise Regression
One of the approaches to induce sparsity in the estimation of precision matrix is to

b one column at a time via linear regressions, replacing population moments by
solve for Θ
their sample counterparts. When we repeat this procedure for each variable j = 1, . . . , p,
b column by column using {rt }T via p linear regreswe will estimate the elements of Θ
t=1
sions. Meinshausen and Bühlmann (2006) use this approach to incorporate sparsity into
the estimation of the precision matrix. They fit p separate Lasso regressions using each
b This method
variable (node) as the response and the others as predictors to estimate Θ.
is known as the “nodewise” regression and it is reviewed below based on van de Geer
et al. (2014) and Callot et al. (2019).
Let rj be a T × 1 vector of observations for the j-th regressor, the remaining covariates
are collected in a T × (p − 1) matrix R−j . For each j = 1, . . . , p we run the following Lasso
regressions:


bj = arg min krj − R−j γk22 /T + 2λj kγk1 ,
γ
p−1
γ∈R

(3.1)

bj = {b
where γ
γj,k ; j = 1, . . . , p, k 6= j} is a (p − 1) × 1 vector of the estimated regression

14

b Define
coefficients that will be used to construct the estimate of the precision matrix, Θ.


1
−b
γ1,2 · · · −b
γ1,p
−b
γ2,1
1
· · · −b
γ2,p 

b =
C
(3.2)
 ..
..
..  .
...
 .
.
. 
−b
γp,1 −b
γp,2 · · ·
1
For j = 1, . . . , p, define
bj k22 /T + λj kb
τ̂j2 = krj − R−j γ
γj k1

(3.3)

b 2 = diag(τ̂ 2 , . . . , τ̂ 2 ).
T
1
p

(3.4)

and write

The approximate inverse is defined as
b =T
b −2 C.
b
Θ

(3.5)

The procedure to estimate the precision matrix using nodewise regression is summarized
in Algorithm 2.
Algorithm 2 Nodewise Regression by Meinshausen and Bühlmann (2006) (MB)
1: Repeat for j = 1, . . . , p :
bj using (3.1) for a given λj .
• Estimate γ
• Select λj using a suitable information criterion.
2:
3:

b and T
b2 .
Calculate C
b =T
b −2 C.
b
Return Θ
One of the caveats to keep in mind when using the nodewise regression method is

that the estimator in (3.5) is not self-adjoint. Callot et al. (2019) show (see their Lemma
b in (3.5) is positive definite with high probability, however, it could still occur
A.1) that Θ
b is not positive definite in finite samples. To resolve this issue we use the matrix
that Θ
symmetrization procedure as in Fan et al. (2018) and then use eigenvalue cleaning as in
Callot et al. (2017) and Hautsch et al. (2012). First, the symmetric matrix is constructed
as
h
i
h
i
bs = Θ
b ij 1 Θ
b ij ≤ Θ
b ji + Θ
b ji 1 Θ
b ij > Θ
b ji ,
Θ
ij
15

(3.6)

b ij is the (i, j)-th element of the estimated precision matrix from (3.5). Second, we
where Θ
b s positive definite: write the spectral decomposition
use eigenvalue cleaning to make Θ
bs = V
b 0Λ
b V,
b where V
b is a matrix of eigenvectors and Λ
b is a diagonal matrix with p eigenΘ
b i on its diagonal. Let Λm := min{Λ
b i |Λ
b i > 0}. We replace all Λ
b i < Λm with Λm
values Λ
eV
b which
e We use Θ
e =V
b 0Λ
and define the diagonal matrix with cleaned eigenvalues as Λ.
is symmetric and positive definite.

3.2

Factor Nodewise Regression
The arbitrage pricing theory (APT), developed by Ross (1976), postulates that ex-

pected returns on securities should be related to their covariance with the common components or factors only. The goal of the APT is to model the tendency of asset returns to
move together via factor decomposition. Let rt = (r1t , r2t , . . . , rpt )0 ∼D(m, Σ) be a p × 1
vector of excess returns drawn from a distribution D, where m is the unconditional mean
of the returns. Assume that the return generating process (rt ) follows a K-factor model:
rt = B ft + εt ,
|{z}
|{z}
p×1

t = 1, . . . , T

(3.7)

K×1

where ft = (f1t , . . . , fKt )0 are the factors, B is a p × K matrix of factor loadings, and εt is the
idiosyncratic component that cannot be explained by the common factors. Factors in (3.7)
can be either observable, such as in Fama and French (1993, 2015), or can be estimated
using statistical factor models.
In this subsection we examine how to approach the portfolio allocation problems in
(2.11)-(2.13) using a factor structure in the returns. Our approach, called Factor Nodewise
Regression, uses the estimated common factors to obtain sparse precision matrix of the
idiosyncratic component. The resulting estimator is used to obtain the precision of the
asset returns necessary to form portfolio weights.
As in Fan et al. (2013), we consider a spiked covariance model when the first K principal eigenvalues of Σ are growing with p, while the remaining p − K eigenvalues are
bounded and grow slower than p.

16

Rewrite equation (3.7) in matrix form:
R = |{z}
B F + E.
|{z}
p×T

(3.8)

p×K

b F)
b = argminB,F kR − BFk2
The factors and loadings in (3.8) are estimated by solving (B,
F
= IK , B0 B is diagonal. The constraints are needed to identify the factors (Fan
√
b = T eig (R0 R) and B
b =
et al. (2018)). It was shown (Stock and Watson (2002)) that F
K

s.t.

1
FF0
T

b 0 . Given F,
b B,
b define E
b =R−B
b F.
b
T −1 RF
Since our interest is in constructing portfolio weights, our goal is to estimate a precision
matrix of the excess returns. However, as pointed out by Koike (2020), when common factors are present across the excess returns, the precision matrix cannot be sparse because
all pairs of the returns are partially correlated given other excess returns through the common factors. Therefore, we impose a sparsity assumption on the precision matrix of the
idiosyncratic errors, Θε , which is obtained using the estimated residuals after removing
the co-movements induced by the factors (see Barigozzi et al. (2018); Brownlees et al.
(2018); Koike (2020)).
We use the nodewise regression as a shrinkage technique to estimate the precision
matrix of residuals. Once the precision Θf of the low-rank component is also obtained,
similarly to Fan et al. (2011), we use the Sherman-Morrison-Woodbury formula to estimate
the precision of excess returns:
Θ = Θε − Θε B[Θf + B0 Θε B]−1 B0 Θε .

(3.9)

bf = Σ
b −1 , we use the inverse of the sample covariance of the estimated factors
To obtain Θ
f
b f = T −1 F
bF
b 0 . To get Θ
b ε , we first apply Algorithm 2 to the estimated idiosyncratic errors,
Σ
b f and Θ
b ε , we can get Θ
b using a sample analogue of (3.9). The
εbt . Once we have estimated Θ
proposed procedure is called Factor Nodewise Regression and is summarized it in Algorithm
3.
Algorithm 3 Factor Nodewise Regression by Meinshausen and Bühlmann (2006) (FMB)
b fbt using PCA.
bt = rt − B
1: Estimate the residuals: ε
P
0
b ε = 1 T (b
Get Σ
εt − ε̄) .
t=1 εt − ε̄)(b
T
2: Estimate a sparse Θε using nodewise regression: apply Algorithm 2 to ε
b.
3: Estimate Θ using the Sherman-Morrison-Woodbury formula in (3.9).
17

b obtained from (3.9) using Algorithm 3 to estimate portfolio weights
Now we can use Θ
in (2.11)-(2.13).

4

Factor Investing is Allowed

In this section we allow an investor to hold a portfolio of assets and factors, in other
words, factors are assumed to be tradable. Note that in contrast with Ao et al. (2019), the
distinction between tradable and non-tradable factors is not pinned down by the fact that
the excess returns are driven by the common factors. That is, factor structure of returns
is allowed independently of whether factors are tradable or not. We assume that only
observable factors can be tradable. Denote a K1 × 1 vector of observable factors as e
ft , and
K2 × 1 vector of unobservable factors as ftP CA , where K1 + K2 = K. The goal of factor
investing is to decide how much weight is allocated to factors e
ft and stocks rt . Let rt,all be
the return of portfolio at time t:
0
rt,all = wall,t
xt .
| {z }

(4.1)

1×(p+K1 )

where xt = (e
ft0 , r0t )0 is a (p + K1 ) × 1 vector of excess returns of observable factors and
ft and wt invested
stocks and wall,t = (wf0 t , wt0 )0 is a vector of weights with wf t invested in e
in stocks. We treat e
ft as additional K1 investments vehicles which will contribute to the
return of the total portfolio. Now consider K2 -factor model for xt :
xt = B ftP CA + et ,
| {z }

(4.2)

t = 1, . . . , T

K2 ×1

Rewrite equation (4.2) in matrix form:
X
|{z}

(p+K1 )×T

= B |FP{zCA} + E,

(4.3)

K2 ×T

b P CA =
which can be estimated using the standard PCA techniques as in (3.8): F

√

T eigK2 (X0 X)

b = T −1 XF
b 0 P CA . Given F
b P CA , B,
b define E
b =X−B
bF
b P CA .
and B
Similarly to Algorithm 3, we use (3.9) to estimate the precision of the augmented excess
b f P CA = Σ
b −1P CA , we use the inverse of the sample covariance of the
returns, Θx . To get Θ
f
18

b f P CA = T −1 F
b P CA F
b 0 P CA . To get Θ
b e , we first apply Algorithm 2 to the
estimated factors Σ
b f P CA and Θ
b e , we can
estimated idiosyncratic errors, b
et in (4.2). Once we have estimated Θ
b x using a sample analogue of (3.9). This procedure is summarized in Algorithm 4.
get Θ
Algorithm 4 Factor Investing Using FMB
1:
2:
3:

P CA
b f[
Estimate the residuals from equation (4.2): b
et = xt − B
using PCA.
t
Estimate a sparse Θe using nodewise regression: apply Algorithm 2 to ebt .
Estimate Θx using the Sherman-Morrison-Woodbury formula in (3.9).

b x obtained from Algorithm 4 to estimate portfolio weights wall,t
Now we can use Θ
using either a de-biased technique from section 2.1 ((2.24)), or post-Lasso (Algorithm
b all,t = (w
b f0 t , w
b t0 )0 , we can test whether factor investing significantly
1). Once we obtain w
contributes to the portfolio return by testing whether wf t = 0.

5

Asymptotic Properties

In this section we study asymptotic properties of the de-biased estimator of weights
for sparse portfolio in (2.24) and post-Lasso estimator from Algorithm 1.
Denote S0 := {j; wj 6= 0} to be the active set of variables, where w is a vector of true
portfolio weights in equation (2.18). Also, let s0 := |S0 |. Further, let Sj := {k; γj,k 6= 0}
be the active set for row γj for the nodewise regression in (3.1), and let sj := |Sj |. Define
s̄ := max1≤j≤p sj .
Consider a factor model from equation (3.7):
rt = B ft + εt ,
|{z}
|{z}
p×1

t = 1, . . . , T

(5.1)

K×1

We study the case when the factors are not known, i.e. the only observable variable in
equation (5.1) is the excess returns rt . In this paper our main interest lies in establishing
asymptotic properties of sparse de-biased portfolio weights and the out-of-sample Sharpe
Ratio for the high-dimensional case. We assume that the number of common factors, K,
is fixed.

5.1

Assumptions
We now list the assumptions on the model (5.1):
19

(A.1) (Spiked covariance model) As p → ∞, Λ1 > Λ2 + . . . > ΛK  ΛK+1 ≥ . . . ≥ Λp ≥ 0,
where Λj = O(p) for j ≤ K, while the non-spiked eigenvalues are bounded, Λj =
o(p) for j > K.
(A.2) (Pervasive factors) There exists a positive definite K × K matrix B̆ such that
p−1 B0 B − B̆
2

→ 0 and Λmin (B̆)−1 = O(1) as p → ∞.

Similarly to Chang et al. (2018) and Callot et al. (2019), we also impose beta mixing condition.
∞
t
denote the σ-algebras that are generated by {εu :
and Ft+k
(A.3) (Beta mixing) Let F−∞

u ≤ t} and {εu : u ≥ t + k} respectively. Then {ε}u is β-mixing in the sense that
βk → 0 as k → ∞, where the mixing coefficient is defined as
"
#


 
t
βk = sup E sup Pr B|F−∞
− Pr B
.
t

∞
B∈Ft+k

(5.2)

Some comments regarding the aforementioned assumptions are in order. Assumptions (A.1)-(A.2) are the same as in Fan et al. (2018), and assumption (A.3) is required
to consistently estimate precision matrix for de-biasing portfolio weights. Assumption
(A.1) divides the eigenvalues into the diverging and bounded ones. Without loss of generality, we assume that K largest eigenvalues have multiplicity of 1. The assumption of a
spiked covariance model is common in the literature on approximate factor models, however, we note that the model studied in this paper can be characterized as a “very spiked
model”. In other words, the gap between the first K eigenvalues and the rest is increasing with p. As pointed out by Fan et al. (2018), (A.1) is typically satisfied by the factor
model with pervasive factors, which brings us to the assumption (A.2): the factors impact
a non-vanishing proportion of individual time-series. Assumption (A.3) allows for weak
dependence in the residuals of the factor model in 5.1: causal ARMA processes, certain
stationary Markov chains and stationary GARCH models with finite second moments satisfy this assumption. We note that our Assumption (A.3) is much weaker than in Callot
et al. (2019), the latter requires weak dependence of the returns series, whereas we only
restrict dependence of the idiosyncratic components.
20

0

Let Σ = Γp Λp Γp , where Σ is the covariance matrix of returns that follow factor strucb Λ
b K, Γ
b K to be the estimators of Σ, Λp , Γp . We
ture described in equation (5.1). Define Σ,
b K = diag(λ̂1 , . . . , λ̂K ) and Γ
b K = (v̂1 , . . . , v̂K ) to be constructed by the first
further let Λ
b and B
bB
b0 =
K leading empirical eigenvalues and the corresponding eigenvectors of Σ
bK Λ
b KΓ
b 0 . Similarly to Fan et al. (2018), we require the following bounds on the compoΓ
K
nentwise maximums of the estimators:
p
b −Σ
.P log p/T ,
(B.1) Σ
max

(B.2)

b K − Λp )Λ−1
(Λ
p

(B.3)

b K − Γp
Γ

max

max

.P

.P

p

log p/T ,

p
log p/(T p).

b SG be the sample covariance matrix, with Λ
b SG and Γ
b SG constructed with the first
Let Σ
K
K
b SG respectively. Also, let Σ
b EL1 =
K leading empirical eigenvalues and eigenvectors of Σ
bR
b 1 D,
b where R
b 1 is obtained using the Kendall’s tau correlation coefficients and D
b is a
D
b EL2 =
robust estimator of variances constructed using the Huber loss. Furthermore, let Σ
bR
b 2 D,
b where R
b 2 is obtained using the spatial Kendall’s tau estimator. Define Λ
b EL to be
D
K
b EL1 , and Γ
b EL is the matrix of
the matrix of the first K leading empirical eigenvalues of Σ
K
b EL2 . For more details regarding constructing
the first K leading empirical eigenvectors of Σ
b SG , Σ
b EL1 and Σ
b EL2 see Fan et al. (2018), Sections 3 and 4.
Σ
Theorem 1. (Fan et al. (2018))
b SG , Λ
b SG and Γ
b SG satisfy (B.1)-(B.3).
For sub-Gaussian distributions, Σ
K
K
b EL1 , Λ
b EL and Γ
b EL satisfy (B.1)-(B.3).
For elliptical distributions, Σ
K
K
Theorem 1 is essentially a rephrasing of the results obtained in Fan et al. (2018), Sections 3 and 4. Since there is no separate statement of these results in their paper (it is
rather a summary of several theorems), we separated it as a Theorem for the convenience
b EL2 is only used for estimating
of the reader. As evidenced from the above Theorem, Σ
b EL2 , the theoretthe eigenvectors. This is necessary due to the fact that, in contrast with Σ
b EL are mathematically involved because of the sin
ical properties of the eigenvectors of Σ
function.
In addition, the following structural assumption on the model is imposed:
21

(C.1) kΣkmax = O(1) and kBkmax = O(1),
which is a natural structural assumption on the population quantities.
Note that in contrast to Fan et al. (2018) we do not impose sparsity on the covariance
matrix of the idiosyncratic component, instead, it is more realistic to impose conditional
sparsity on the precision matrix after the common factors are accounted for.

5.2

Asymptotic Properties of De-Biased Portfolio Weights
Recall that we used equation (3.9) to estimate Θ. Therefore, in order to establish con-

b ε.
sistency of the estimator in (3.9), we first show consistency of Θ
Theorem 2. Suppose that Assumptions (A.1)-(A.3), (B.1)-(B.3) and (C.1) hold. Let ωT :=
p
P
√
log p/T + 1/ p. Then maxi≤p (1/T ) Tt=1 |ε̂it − εit | .P ωT2 and maxi,t |ε̂it − εit | .P ωT =
op (1). Under the sparsity assumption s̄2 ωT = o(1), with λj  ωT , we have
b ε,j − Θε,j
max Θ

1≤j≤p

b ε,j − Θε,j
max Θ

1≤j≤p

1
2
2

.P s̄ωT ,
.P s̄ωT2

Some comments are in order. First, the sparsity assumption s̄2 = o(ωT ) is stronger
b ε : this is necessary to ensure consistency for Θ
b
than that required for convergence of Θ
established in Theorem 3, so we impose a stronger assumption at the beginning. We also
note that at the first glance, our sparsity assumption in Theorem 3 is stronger than that
required by van de Geer et al. (2014) and Callot et al. (2019), however, recall that we
impose sparsity on Θε , not Θ as opposed to the two aforementioned papers. Hence, this
assumption can be easily satisfied once the common factors have been accounted for and
the precision of the idiosyncratic components is expected to be sparse. The bounds derived
in Theorem 2 help us establish the convergence properties of the precision matrix of stock
returns in equation (3.9).
Theorem 3. Under the assumptions of Theorem 2 and, in addition, assuming kΘε,j k2 = O(1),

22

we have
b j − Θj
max Θ

1≤j≤p

b j − Θj
max Θ

1≤j≤p

1
2
2

.P s̄2 ωT ,
.P s̄ωT2 .

Having established the properties of the estimated precision matrix of stock returns,
we are ready to state the following main result:
Theorem 4. Under the assumptions of Theorem 3, consider the linear model 2.18 with e ∼
D(0, σe I), where σe2 = O(1). Consider a suitable choice of the regularization parameters λ  ωT
for the Lasso regression in 2.19 and λj  ωT uniformly in j for the Lasso for nodewise regression
√
in 3.1. Assume s0 log(p)/ T = o(1). Then
√
b DEBIASED −w) = W + ∆,
T (w
√
b 0 e/ T ,
W = ΘR
k∆k∞ = op (1).
Some comments are in order. Our Theorem 4 is an extension of Theorem 2.4 of van de
Geer et al. (2014) for non-iid case, where the latter is achieved with a help of Chang et al.
(2018). Furthermore, there are several fundamental differences between Theorem 4 and
Theorem 2.4 of van de Geer et al. (2014): first, we apply nodewise regression to estimate
sparse precision matrix of factor-adjusted returns, which explains the difference in conp
vergence rates. Concretely, van de Geer et al. (2014) have ωT = log(p)/T , whereas we
p
√
√
have ωT = log(p)/T + 1/ p, where 1/ p arises due to the fact that factors need to be
estimated. However, we note that since we deal with high-dimensional regime p ≥ T , this
additional term is asymptotically negligible, we only keep it for identification purposes.
Second, in contrast with van de Geer et al. (2014), the dependent variable in the Lasso
regression in (2.19) is unknown and needs to be estimated. Lemma 2 shows that r̂c constructed using the precision matrix estimator from Theorem 3 is consistent and shares the
same rate as the l1 -bound in Theorem 3. Third, interestingly, the sparsity assumption on
the Lasso regression in (2.19) is the same as in van de Geer et al. (2014): as shown in the
Appendix, this condition is still sufficient to ensure that the bias term is asymptotically
23

negligible even when the stock returns follow factor structure with unknown factors. Finally, we can use the central limit theorem argument to obtain approximate Gaussianity of
components of W |R of fixed dimension, or moderately growing dimensions (see van de
Geer et al. (2014) for more details), however, in order not to divert the focus of this paper,
we leave it for future research.

5.3

Asymptotic Properties of Post-Lasso Portfolio Weights
To establish the properties of the post-Lasso estimator in Algorithm 1, we focus on MRC

weight formulation, since it satisfies the standard post-Lasso assumptions. For GMV and
MWC formulations, the procedure described in Algorithm 1 is not “post-Lasso” in the
usual sense. Concretely, the latter assumes that both steps in Algorithm 1 have the same
objective function, which is violated for GMV and MWC. Consequently, we leave rigorous
theoretical derivations of these two portfolio formulation for future research. For MRC,
we use the post-model selection results established in Belloni and Chernozhukov (2013).
Specifically, we have the following theorem:
Theorem 5. Suppose the restricted eigenvalue condition and the restricted sparse eigenvalue condition on the empirical Gram matrix hold (see Condition RE(c̄) and Condition RSE(m) of Belloni
b be the post-Lasso weight estimator from Algorithm 1,
and Chernozhukov (2013), p. 529). Let w
we have
 

σe (s0 ωT ) ∨ (s̄2 ωT ) , in general,
q

b − wk1 .P
kw
1
σ e s 0
√1 ,
+
if s0 ≥ s̄2 and Ξ = Ξ̂ wp → 1.
T
p
The proof of Theorem 5 easily follows from the proof of Corollary 2 of Belloni and
Chernozhukov (2013) and is omitted here. Let us comment on the upper bounds for
post-Lasso estimator: first, the term (s0 ωT ) ∨ (s̄2 ωT ) appears since one needs to estimate
the dependent variable in equation (2.18), which creates the difference between the bound
in Belloni and Chernozhukov (2013) and our Theorem 5. Second, similarly to Belloni and
Chernozhukov (2013), the upper bound undergoes a transition from the oracle rate enjoyed by the standard Lasso to the faster rate that improves on the latter when (1) the precision matrix of the idiosyncratic components is sparse enough and (2) the oracle model
24

has well-separated coefficients. Noticeably, the upper bounds in Theorem 5 hold despite
the fact that the first-stage Lasso regression in Algorithm 1 may fail to correctly select the
oracle model Ξ as a subset, that is, Ξ ∈
/ Ξ̂.

6

Monte Carlo

We study the consistency for estimating portfolio weights in (2.10) of (i) sparse portfolios that use the standard Lasso without de-biasing in (2.19), (ii) Lasso with de-biasing in
(2.24), (iii) post-Lasso in Algorithm 1, and (iv) non-sparse portfolios that use FMB from
Algorithm 3. Our simulation results are divided into two parts: the first part examines the
performance of models (i)-(iv) under the Gaussian setting, and the second part examines
the robustness of performance under the elliptical distributions (to be described later).
Each part is further subdivided into two cases: low-dimensional with p < T (Case 1) and
high-dimensional p > T (Case 2), in both cases we allow the number of stocks to increase
with the sample size, i.e. p = pT → ∞ as T → ∞. In the low-dimensional case we let
p = T δ , δ = 0.85 and T = [2h ], for h = 7, 7.5, 8, . . . , 9.5, in the high-dimensional case we let
p = 3 · T δ , δ = 0.85, all else equal.
First, consider the following data generating process for stock returns:
rt = m + B ft + εt ,
|{z}
|{z}
p×1

t = 1, . . . , T

(6.1)

K×1

where mi ∼ N (1, 1) independently for each i = 1, . . . , p, εt is a p × 1 random vector of
idiosyncratic errors following N (0, Σε ), with a Toeplitz matrix Σε parameterized by ρ:
that is, Σε = (Σε )ij , where (Σε )ij = ρ|i−j| , i, j ∈ 1, . . . , p which leads to sparse Θε , ft is a
K ×1 vector of factors drawn from N (0, Σf = IK /10), B is a p×K matrix of factor loadings
drawn from N (0, IK /100). We set ρ = 0.5 and fix the number of factors K = 3.
Let Σ = BΣf B0 + Σε . To create sparse MRC portfolio weights we use the following
procedure: first, we threshold the vector Σ−1 m to keep the top p/2 entries with largest
absolute values. This yields sparse vector α = Σ−1 m defined in (2.13). We use Σα and
Σ as the values for the mean and covariance matrix parameters to generate multivariate
Gaussian returns in (6.1). Note that the low rank plus sparse structure of the covariance
matrix is preserved under this transformation.
25

Figure 3 shows the averaged (over Monte Carlo simulations) errors of the estimators
of the weight wMRC versus the sample size T in the logarithmic scale (base 2). As evidenced by Figure 3, (1) sparse estimators outperform non-sparse counterparts; (2) using
de-biasing or post-Lasso improves the performance compared to the standard Lasso estimator. As expected from Theorems 4-5, the Lasso, de-biased Lasso and post-Lasso exhibit similar rates, but the two latter estimators enjoy lower estimation error. The ranking
remains similar in the high-dimensional setting, however, as illustrated in Figure 3, the
performance of all estimators slightly deteriorates.
Gaussian-tail assumption is too restrictive for modeling the behavior of financial returns. Hence, as a second exercise we check the robustness of our sparse portfolio allocation estimators under the elliptical distributions, which we briefly review based on Fan
et al. (2018). Elliptical distribution family generalizes the multivariate normal distribution and multivariate t-distribution. Let m ∈ Rp and Σ ∈ Rp×p . A p-dimensional random
vector r has an elliptical distribution, denoted by r ∼ EDp (m, Σ, ζ), if it has a stochastic
representation
d

r = m + ζAU,

(6.2)

where U is a random vector uniformly distributed on the unit sphere S q−1 in Rq , ζ ≥ 0 is
a scalar random variable independent of U, A ∈ Rp×q is a deterministic matrix satisfying
AA0 = Σ. As pointed out in Fan et al. (2018), the representation in (6.2) is not identifiable,
hence, we require E[ζ 2 ] = q, such that Cov(r) = Σ. We only consider continuous elliptical distributions with Pr[ζ = 0] = 0. The advantage of the elliptical distribution for the
financial returns is its ability to model heavy-tailed data and the tail dependence between
variables.
Having reviewed the elliptical distribution, we proceed to the second part of simulation
results. The data generating process is similar to Fan et al. (2018): let (ft , εt ) from (6.1)
jointly follow the multivariate t-distribution with the degrees of freedom ν. When ν = ∞,
this corresponds to the multivariate normal distribution, smaller values of ν are associated
with thicker tails. We draw T independent samples of (ft , εt ) from the multivariate tdistribution with zero mean and covariance matrix Σ = diag(Σf , Σε ), where Σf = IK .

26

To construct Σε we use a Toeplitz structure parameterized by ρ = 0.5, which leads to
the sparse Θε = Σ−1
ε . The rows of B are drawn from N (0, IK /100). Figure 2 reports
the results for ν = 4.24 : the performance of the standard Lasso estimator significantly
deteriorates, which is further amplified in the high-dimensional case where it exhibits
the worst performance. Noticeably, post-Lasso still achieves the lowest estimation error,
followed by de-biased estimator.

7

Empirical Application

This section is divided into three main parts. First, we examine the performance of nonsparse portfolios that use FMB from Algorithm 3 and compare their performance with
equal-weighted portfolio, Index portfolio (reported as the composite S&P500 index listed
as ∧ GSPC) and MB from Algorithm 2 which does not use the information about a factor
structure in the stock returns. Second, we study the performance of sparse portfolios that
are based on de-biasing and post-Lasso. Third, we consider several interesting periods
that include different economic downturns: we examine the merit of sparse vs non-sparse
portfolios during economic downturns.

7.1

Data
We use monthly and daily returns of the components of the S&P500 index. The data

on historical S&P500 constituents and stock returns is fetched from CRSP and Compustat
using SAS interface. The full sample for the monthly data has 480 observations on 355
stocks from January 1, 1980 - December 1, 2019. We use January 1, 1980 - December 1,
1994 (180 obs) as a training period and January 1, 1995 - December 1, 2019 (300 obs) as
the out-of-sample test period. For the daily data the full sample size has 5040 observations
on 420 stocks from January 12, 2000 - January 31, 2020. We use January 20, 2000 - January
24, 2002 (504 obs) as a training period and January 25, 2002 - January 31, 2020 (4536 obs)
as the out-of-sample test period.
We roll the estimation window over the test sample to rebalance the portfolios monthly.
4

The results for larger degrees of freedom do not provide any additional insight, hence we do not report
them here. However, they are available upon request.

27

At the end of each month, prior to portfolio construction, we remove stocks with less than
15 or 2 years of historical stock return data for monthly and daily returns respectively.
For sparse portfolio we employ the following strategy to choose the tuning parameter λ in
(2.16): we use the first two thirds of the training data (which we call the training window)
to estimate weights and tune the shrinkage intensity λ in the remaining one third of the
training sample to yield the highest Sharpe Ratio which serves as a validation window.
We estimate factors and factor loadings in the training window and validation window
combined. The risk-free and rate and Fama/French factors are taken from Kenneth R.
French’s data library.

7.2

Performance Measures
Similarly to Callot et al. (2019), we consider four metrics commonly reported in finance

literature: the Sharpe Ratio, the portfolio turnover, the average return and variance of a
portfolio. We consider two scenarios: with and without transaction costs. Let T denote the
total number of observations, the training sample consists of m observations, and the test
sample is n = T − m. When transaction costs are not taken into account, the out-of-sample
average portfolio return, variance and Sharpe Ratio are
T −1

µ̂test

1X 0
b rt+1 ,
=
w
n t=m t

(7.1)

2
σ̂test

T −1
1 X 0
b rt+1 − µ̂test )2 ,
(w
=
n − 1 t=m t

(7.2)

SR = µ̂test /σ̂test .

(7.3)

We follow Ban et al. (2018); Callot et al. (2019); DeMiguel et al. (2009); Li (2015) to account
for transaction costs (tc). In line with the aforementioned papers, we set c = 50bps. Define
the excess portfolio at time t + 1 with transaction costs as
b t0 rt+1
rt+1,portfolio =w

− c(1 +

b t0 rt+1 )
w

p
X

+
ŵt+1,j − ŵt,j
,

(7.4)

j=1

where

+
ŵt,j

= ŵt,j

f
1 + rt+1,j + rt+1
f
1 + rt+1,portfolio + rt+1

28

,

(7.5)

f
where rt+1,j + rt+1
is sum of the excess return of the j-th asset and risk-free rate, and
f
is the sum of the excess return of the portfolio and risk-free rate. The
rt+1,portfolio + rt+1

out-of-sample average portfolio return, variance, Sharpe Ratio and turnover are defined
accordingly:
T −1

µ̂test,tc =

1X
rt,portfolio ,
n t=m

(7.6)

2
σ̂test,tc
=

T −1
1 X
(rt,portfolio − µ̂test,tc )2 ,
n − 1 t=m

(7.7)

SRtc = µ̂test,tc /σ̂test,tc ,
Turnover =

7.3

p
T −1 X
X

1
+
ŵt+1,j − ŵt,j
.
n t=m j=1

(7.8)
(7.9)

Results
The first set of results explores the performance of FMB from Algorithm 3 for non-

sparse portfolio using monthly and daily data. We consider two scenarios, when the factors are unknown and estimated using the standard PCA (statistical factors), and when
the factors are known. For the statistical factors we consider up to three PCs. For the scenario with known factors we include up to 5 Fama-French factors: FF1 includes the excess
return on the market, FF3 includes FF1 plus size factor (Small Minus Big, SMB) and value
factor (High Minus Low, HML), and FF5 includes FF3 plus profitability factor (Robust
Minus Weak, RMW) and risk factor (Conservative Minus Agressive, CMA). In Tables 34, we report the monthly and daily portfolio performance for three alternative portfolio
allocations in (2.11), (2.12) and (2.11). We set a return target µ ∈ {0.7974%, 0.0378%}
for monthly and daily data respectively (both are equivalents of 10% yearly return when
compounded). The target level of risk for the weight-constrained and risk-constrained
Markowitz portfolio (MWC and MRC) is set at σ ∈ {0.05, 0.013} which is the standard
deviation of the monthly and daily excess returns of the S&P500 index in the first training
set.
Some comments for Tables 3-4 are in order:
1. The Tables show that the MRC produces portfolio return and Sharpe Ratio that are
29

uniformly higher than those for the weight-constrained allocations MWC and GMV.
This means that relaxing the constraint that portfolio weights sum up to one leads to
a large increase in the out-of-sample Sharpe Ratio and portfolio return. This increase,
however, comes at the cost of higher risk and higher portfolio turnover: for MRC
portfolios the risk constraint is often violated.
2. Factor-based portfolios outperform non-factor-based counterparts for monthly data:
factor models significantly reduce portfolio risk which increases Sharpe Ratio. However, the effect of common factors deteriorates for daily data: only MRC portfolios
with observable factors outperform MB. One possible explanation is a larger signalto-noise ratio for daily stock returns, as compared to the monthly data.
3. For monthly data, FMB-based models outperform EW and index in terms of return
and the out-of-sample Sharpe Ratio. This is accompanied with higher risk of the
factor-based models. Again, the impact of factors deteriorates for daily data: Table 4
shows that only MRC portfolios with observable factors outperform EW and Index.
4. There is no clear ranking between statistical vs observable factors: overall, the performance is comparable in terms of the out-of-sample Sharpe Ratio.
As evidenced by the empirical results from Tables 3-4, the risk produced by non-sparse
portfolios is relatively high compared to the risk of EW and index portfolios. Furthermore,
having examined empirical performance of FMB we notice that some of the estimated
portfolio weights are very close to zero. This means that an investor needs to buy a certain
amount of each security even if there are a lot of small weights. However, oftentimes
investors are interested in managing a few assets which significantly reduces monitoring
and transaction costs and was shown to outperform equal weighted and index portfolios
in terms of the Sharpe Ratio and cumulative return (see Fan et al. (2019), Ao et al. (2019),
Li (2015), Brodie et al. (2009) among others). This brings us to examining performance of
sparse portfolios, which is reported in Table 5 for monthly data, and Table 6 for daily data.
As mentioned in Section 2, shrinking portfolio weights introduces bias, here we study two
ways to correct for it: the first approach applies de-biasing technique and it was described
30

in Section 2 (see equation (2.24)). By construction, the first approach can only be applied
to MRC weight formula. The second approach uses post-Lasso described in Algorithm
1: we first use Lasso-based weight estimator in (2.19) for selecting stocks with absolute
value of weights above a small threshold  (we use  = 0.000001), then we form portfolio
with the selected stocks using three alternative portfolio allocations in (2.11)-(2.13). Table
5 reports both of the aforementioned approaches for the monthly data. Some comments
are in order:
1. Similarly to the results from Table 3, the MRC produces portfolio return and Sharpe
Ratio that are uniformly higher than those for the weight-constrained allocations
MWC and GMVP. Again, this suggests that requiring the weights to sum up to one
leads to inefficiency caused by weight misallocation which deteriorates portfolio performance.
2. Column one demonstrates that de-biasing leads to significant performance improvement in terms of the return and out-of-sample Sharpe Ratio. Note that even though
the risk of de-biased portfolio is also higher, it still satisfies the risk-constraint. This
result emphasizes the importance of correcting for the bias introduced by the l1 regularization.
3. Comparing two bias-correction methods, de-biasing and post-Lasso, we find that
the latter is characterized by higher return and higher risk. However, increase in
portfolio return brought by post-Lasso is, overall, not sufficient to outperform debiasing approach in terms of the out-of-sample Sharpe Ratio.
4. De-biased sparse portfolio has significantly lower risk and turnover compared to
non-sparse counterparts in Table 3: we used FMB for de-biasing, hence, the direct
counterparts of de-biased portfolios from Table 4 are FMB portfolios from Table 3.
Sparse de-biased portfolios have lower return compared to Table 3, however, the
out-of-sample Sharpe Ratio is comparable, i.e. we do not see uniform superiority of
either method. Therefore, incorporating sparsity allows investors to reduce portfolio
risk at the cost of lower return while maintaining the Sharpe Ratio comparable to
31

holding a non-sparse portfolio. Similarly to the result from Table 3, de-biased sparse
portfolio and post-Lasso with statistical factors outperform EW and index.
5. Finally, the advantage of using observable Fama-French factors versus statistical factors becomes less pronounced for sparse portfolio compared to Table 3: both return
and risk of the latter are slightly smaller which leads to the out-of-sample Sharpe
Ratio being marginally higher for observable factors.
Table 4 and Table 6 have similar conclusions, therefore, we only highlight one additional
finding from Table 6:
1. In contrast to non-sparse portfolio in Table 4, sparse portfolios using daily data outperform EW and index in terms of risk and out-of-sample Sharpe Ratio.
Tables 7-8 compare the performance of non-sparse and sparse portfolios for monthly
data for different time periods in terms of the cumulative excess return (CER) over the
period of interest and risk. We note that the references to the specific crises do not intend
to limit these economic downturns to only these periods. They merely provide the context
for the time intervals of interest. Tables 7-8 reveal some interesting findings:
1. The conclusions from Tables 3-6 are supported: MRC portfolios yield higher CER
and they are characterized by higher risk, factor-based models using FMB are characterized by higher CER and much higher risk compared to sparse portfolios, EW
and index.
2. Sparse de-biased portfolios with statistical factors, post-Lasso MRC portfolios that
use one statistical or observable factor, and post-Lasso GMV (FF3) are the only models that produced positive CER during the financial crisis 2007-09. Noticeably, the
performance of sparse portfolios with observable factors showed small negative CER
during this period. Note that almost all models that used MWC and GMV during
that time experienced negative CER.
3. Post-Lasso based portfolios have higher CER and higher risk compared to de-biased
sparse portfolios, however, post-Lasso portfolios have higher CER than non-sparse
32

counterparts. Therefore, we recommend using sparse de-biased portfolios for the
investors with higher degree of risk-aversion, whereas post-Lasso is a good choice
for large investors that are less risk-averse.

8

Conclusion and Discussion

This paper develops a novel approach to portfolio composition that addresses the shortcomings of the existing sparse portfolio allocation techniques. First, we use de-biasing and
post-Lasso to account for the bias induced by an `1 -penalty, the resulting weight estimators
are shown to be unbiased and consistent. Second, we develop an algorithm for estimating
a high-dimensional precision matrix that combines the benefits of graphical models and
factor structure of stock returns. The proposed precision matrix estimator is consistent
in high-dimensional settings when the number of assets is greater than or equal to the
sample size. Our algorithm consistently recovers the low rank and idiosyncratic components when stock returns are driven by the common factors. Third, we develop a simple
framework that provides clear guidelines how to implement factor investing using the
methodology developed in this paper.
Our empirical application studies daily and monthly data for the constituents of the
S&P500 and reveals several practical insights. We find that non-sparse high-dimensional
portfolios almost always violate the risk constraint out-of-sample. In contrast, sparse portfolios are characterized by lower risk, lower turnover, and their Sharpe Ratio is comparable to risky non-sparse portfolios. Furthermore, the empirical application demonstrates
superior performance of de-biased portfolios compared to not de-biased counterparts in
terms of the return and the out-of-sample Sharpe Ratio. In addition, we find that sparse
de-biased portfolios with statistical factors, Post-Lasso MRC portfolios that use one statistical or observable factor, and post-Lasso GMV (FF3) were the only models that produced
positive cumulative excess return during several economic downturns, including the dotcom bubble of 2000, the financial crisis of 2007-09 and the recent COVID-19 outbreak. This
finding suggests that, in addition to being consistent, our de-biased estimator of weights
exhibits minimax properties. The formal theoretical justifications of the latter are left for
the future research.
33

There are several venues for potential extensions. First, it would be interesting to examine the criteria for the “optimal” number of stocks in the sparse portfolio. One possible
approach would be to compare the investors’ objective functions of the sparse and nonsparse portfolios, and determine the threshold after which a sparse portfolio begins to
perform better. Second, on a related note, diversification issue is linked to the research
on sparse portfolio. By determining the optimal number of stocks in the portfolio, we can
also address the question as to which extent increasing one’s exposure to many industries
improves portfolio performance, and whether there is an optimal degree of diversification. Third, our model can be extended to incorporate the information on the company’s
fundamentals when selecting stocks. Our conjecture is that using more stock-related information will mainly improve the selection step of both de-biased Lasso and post-Lasso.

34

References
Ao, M., Yingying, L., and Zheng, X. (2019). Approaching mean-variance efficiency for
large portfolios. The Review of Financial Studies, 32(7):2890–2919.
Ban, G.-Y., El Karoui, N., and Lim, A. E. (2018). Machine learning and portfolio optimization. Management Science, 64(3):1136–1154.
Barigozzi, M., Brownlees, C., and Lugosi, G. (2018). Power-law partial correlation network
models. Electronic Journal of Statistics, 12(2):2905–2929.
Belloni, A. and Chernozhukov, V. (2013). Least squares after model selection in highdimensional sparse models. Bernoulli, 19(2):521–547.
Belloni, A., Chernozhukov, V., and Kato, K. (2015). Uniform post-selection inference
for least absolute deviation regression and other z-estimation problems. Biometrika,
102(1):77–94.
Brodie, J., Daubechies, I., De Mol, C., Giannone, D., and Loris, I. (2009). Sparse and stable markowitz portfolios. Proceedings of the National Academy of Sciences, 106(30):12267–
12272.
Brownlees, C., Nualart, E., and Sun, Y. (2018). Realized networks. Journal of Applied Econometrics, 33(7):986–1006.
Callot, L., Caner, M., Önder, A. O., and Ulaşan, E. (2019). A nodewise regression approach
to estimating large portfolios. Journal of Business & Economic Statistics, 0(0):1–12.
Callot, L. A. F., Kock, A. B., and Medeiros, M. C. (2017). Modeling and forecasting
large realized covariance matrices and portfolio choice. Journal of Applied Econometrics,
32(1):140–158.
Caner, M. and Kock, A. B. (2018). Asymptotically honest confidence regions for high
dimensional parameters by the desparsified conservative lasso. Journal of Econometrics,
203(1):143 – 168.
Chang, J., Qiu, Y., Yao, Q., and Zou, T. (2018). Confidence regions for entries of a large
precision matrix. Journal of Econometrics, 206(1):57–82.
DeMiguel, V., Garlappi, L., and Uppal, R. (2009). Optimal versus naive diversification:
How inefficient is the 1/n portfolio strategy? The Review of Financial studies, 22(5):1915–
1953.
Fama, E. F. and French, K. R. (1993). Common risk factors in the returns on stocks and
bonds. Journal of Financial Economics, 33(1):3–56.
Fama, E. F. and French, K. R. (2015). A five-factor asset pricing model. Journal of Financial
Economics, 116(1):1 – 22.
Fan, J., Liao, Y., and Mincheva, M. (2011). High-dimensional covariance matrix estimation
in approximate factor models. The Annals of Statistics, 39(6):3320–3356.
35

Fan, J., Liao, Y., and Mincheva, M. (2013). Large covariance estimation by thresholding
principal orthogonal complements. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 75(4):603–680.
Fan, J., Liu, H., and Wang, W. (2018). Large covariance estimation through elliptical factor
models. The Annals of Statistics, 46(4):1383–1414.
Fan, J., Weng, H., and Zhou, Y. (2019). Optimal estimation of functionals of highdimensional mean and covariance matrix. arXiv:1908.07460.
Hautsch, N., Kyj, L. M., and Oomen, R. C. A. (2012). A blocking and regularization approach to high-dimensional realized covariance estimation. Journal of Applied Econometrics, 27(4):625–645.
Javanmard, A. and Montanari, A. (2014a). Confidence intervals and hypothesis testing for
high-dimensional regression. The Journal of Machine Learning Research, 15(1):2869–2909.
Javanmard, A. and Montanari, A. (2014b). Hypothesis testing in high-dimensional regression under the gaussian random design model: Asymptotic theory. IEEE Transactions
on Information Theory, 60(10):6522–6554.
Javanmard, A., Montanari, A., et al. (2018). Debiasing the lasso: Optimal sample size for
gaussian designs. The Annals of Statistics, 46(6A):2593–2622.
Jegadeesh, N. (1990). Evidence of predictable behavior of security returns. The Journal of
Finance, 45(3):881–898.
Jegadeesh, N. and Titman, S. (1993). Returns to buying winners and selling losers: Implications for stock market efficiency. The Journal of Finance, 48(1):65–91.
Kan, R. and Zhou, G. (2007). Optimal portfolio choice with parameter uncertainty. Journal
of Financial and Quantitative Analysis, 42(3):621–656.
Koike, Y. (2020). De-biased graphical lasso for high-frequency data. Entropy, 22(4):456.
Lehmann, B. N. (1990). Fads, martingales, and market efficiency. The Quarterly Journal of
Economics, 105(1):1–28.
Li, J. (2015). Sparse and stable portfolio selection with parameter uncertainty. Journal of
Business & Economic Statistics, 33(3):381–392.
Lyle, M. R. and Yohn, T. L. (2020). Fundamental analysis and mean-variance optimal
portfolios. Kelley School of Business Research Paper.
Maller, R. A. and Turkington, D. A. (2003). New light on the portfolio allocation problem.
Mathematical Methods of Operations Research, 56(3):501–511.
Markowitz, H. (1952). Portfolio selection. The Journal of Finance, 7(1):77–91.
Meinshausen, N. and Bühlmann, P. (2006). High-dimensional graphs and variable selection with the lasso. The Annals of Statistics, 34(3):1436–1462.
36

Ross, S. A. (1976). The arbitrage theory of capital asset pricing. Journal of Economic Theory,
13(3):341 – 360.
Stock, J. H. and Watson, M. W. (2002). Forecasting using principal components from a
large number of predictors. Journal of the American Statistical Association, 97(460):1167–
1179.
van de Geer, S., Buhlmann, P., Ritov, Y., and Dezeure, R. (2014). On asymptotically optimal confidence regions and tests for high-dimensional models. The Annals of Statistics,
42(3):1166–1202.
Zhang, C.-H. and Zhang, S. S. (2014). Confidence intervals for low dimensional parameters in high dimensional linear models. Journal of the Royal Statistical Society: Series B
(Statistical Methodology), 76(1):217–242.

37

38
(b) Stocks selected by Post-Lasso in May, 2020

Figure 2: Stocks selected by Post-Lasso strategy from Table 2.

(a) Stocks selected by Post-Lasso in August, 2019

Figure 3: Averaged errors of the estimators of wMRC for Case 1 on logarithmic scale (left): p = T 0.85 ,
K = 3 and for Case 2 on logarithmic scale (right): p = 3 · T 0.85 , K = 3.

Figure 4: Elliptical Distribution (ν = 4.2): Averaged errors of the estimators of wMRC for Case 1 on
logarithmic scale (left): p = T 0.85 , K = 3 and for Case 2 on logarithmic scale (right): p = 3 · T 0.85 ,
K = 3.

39

40
0.0080
0.0512
0.0287
0.0248
0.0186
0.0470
0.0356
0.0345

With TC
EW
MB
FMB (PC1)
FMB (PC2)
FMB (PC3)
FMB (FF1)
FMB (FF3)
FMB (FF5)
0.0520
0.0637
0.1865
0.1049
0.0911
0.2202
0.1319
0.1277

0.0520
0.0458
0.2522
0.1865
0.1049
0.0911
0.2200
0.1319
0.1277

Risk

0.1538
0.2027
0.1541
0.2368
0.2044
0.2136
0.2694
0.2699

0.1553
0.1389
0.2138
0.1737
0.2743
0.2498
0.2258
0.2908
0.2921

SR

0.0630
2.9458
3.6900
3.7190
3.8783
2.7245
2.4670
2.4853

-

Turnover

0.0080
0.0067
0.0064
0.0059
0.0047
0.0067
0.0062
0.0063

0.0081
0.0063
0.0070
0.0072
0.0069
0.0059
0.0071
0.0067
0.0068

Return

0.0027
0.0021
0.0447
0.0346
0.0332
0.0447
0.0387
0.0387

0.0520
0.0458
0.0021
0.0447
0.0346
0.0332
0.0447
0.0387
0.0374

Risk

0.1538
0.1461
0.1449
0.1687
0.1457
0.1498
0.1622
0.1653

0.1553
0.1389
0.1539
0.1616
0.1968
0.1817
0.1582
0.1754
0.1788

SR

0.0630
0.3223
0.7111
0.9872
1.1607
0.3489
0.4728
0.4847

-

Turnover

Markowitz (weight-constrained)

0.0080
0.0080
0.0073
0.0067
0.0047
0.0080
0.0076
0.0076

0.0081
0.0063
0.0082
0.0080
0.0076
0.0058
0.0083
0.0080
0.0081

Return

0.0027
0.0020
0.0436
0.0346
0.0332
0.0436
0.0361
0.0361

0.0520
0.0458
0.0020
0.0436
0.0346
0.0332
0.0436
0.0361
0.0361

Risk

0.1538
0.1804
0.1655
0.1929
0.1412
0.1857
0.2106
0.2129

0.1553
0.1389
0.1860
0.1818
0.2211
0.1766
0.1921
0.2223
0.2250

SR

0.0630
0.2152
0.6783
0.9686
1.1448
0.2486
0.3920
0.4057

-

Turnover

Global Minimum-Variance

Table 3: Monthly portfolio returns, risk, Sharpe Ratio and turnover. Transaction costs are set to 50 basis points, targeted risk is set at σ = 0.05
(which is the standard deviation of the monthly excess returns on S&P 500 index from 1980 to 1995, the first training period), monthly targeted return
is 0.7974% which is equivalent to 10% yearly return when compounded. In-sample: January 1, 1980 - December 31, 1995 (180 obs), Out-of-sample:
January 1, 1995 - December 31, 2019 (300 obs).

0.0081
0.0063
0.0539
0.0324
0.0287
0.0228
0.0497
0.0384
0.0373

Without TC
EW
Index
MB
FMB (PC1)
FMB (PC2)
FMB (PC3)
FMB (FF1)
FMB (FF3)
FMB (FF5)

Return

Markowitz (risk-constrained)

41

2.01E-04
3.52E-04
3.27E-04
3.26E-04
4.97E-04
3.42E-04
2.21E-04

With TC
EW
MB
FMB (PC1)
FMB (PC2)
FMB (FF1)
FMB (FF3)
FMB (FF5)
1.90E-02
4.81E-02
4.88E-02
4.81E-02
3.81E-02
3.63E-02
3.58E-02

1.90E-02
1.17E-02
4.80E-02
4.88E-02
4.81E-02
3.81E-02
3.62E-02
3.57E-02

Risk

0.0106
0.0073
0.0067
0.0068
0.0130
0.0094
0.0062

0.0123
0.0159
0.0149
0.0143
0.0145
0.0287
0.0260
0.0232

SR

0.0292
0.3749
0.3812
0.3813
0.6001
0.6083
0.6188

Turnover

2.01E-04
8.03E-05
7.69E-05
6.15E-05
3.58E-06
-6.43E-06
-5.25E-06

2.33E-04
1.86E-04
1.20E-04
1.18E-04
1.06E-04
1.03E-04
1.02E-04
1.09E-04

Return
0.0123
0.0159
0.0094
0.0093
0.0083
0.0061
0.0065
0.0067

SR

1.90E-02 0.0106
1.28E-02 0.0063
1.27E-02 0.0060
1.28E-02 0.0048
1.70E-02 0.0002
1.58E-02 -0.0004
1.63E-02 -0.0003

1.90E-02
1.17E-02
1.28E-02
1.27E-02
1.28E-02
1.70E-02
1.58E-02
1.63E-02

Risk

0.0292
0.0419
0.0430
0.0446
0.1502
0.1148
0.1284

Turnover

Markowitz (weight-constrained)

2.01E-04
1.39E-04
1.33E-04
1.19E-04
-1.63E-05
-2.78E-06
-1.04E-05

2.33E-04
1.86E-04
1.71E-04
1.67E-04
1.56E-04
8.13E-05
1.03E-04
1.01E-04

Return

1.90E-02
1.23E-02
1.21E-02
1.22E-02
1.68E-02
1.54E-02
1.61E-02

1.90E-02
1.17E-02
1.23E-02
1.21E-02
1.22E-02
1.68E-02
1.54E-02
1.61E-02

Risk

0.0106
0.0113
0.0110
0.0098
-0.0010
-0.0002
-0.0006

0.0123
0.0159
0.0139
0.0138
0.0128
0.0048
0.0067
0.0063

SR

0.0292
0.0344
0.0359
0.0376
1.3933
0.1106
0.1232

Turnover

Global Minimum-Variance

Table 4: Daily portfolio returns, variance, Sharpe Ratio and turnover. Transaction costs are set to 50 basis points, targeted risk is set at σ = 0.013
(which is the standard deviation of the daily excess returns on S&P 500 index from 2000 to 2002, the first training period), daily targeted return is
0.0378% which is equivalent to 10% yearly return when compounded. In-sample: January 20, 2000 - January 24, 2002 (504 obs), Out-of-sample:
January 25, 2002 - January 31, 2020 (4536 obs).

2.33E-04
1.86E-04
7.17E-04
6.98E-04
6.97E-04
1.09E-03
9.43E-04
8.31E-04

Without TC
EW
Index
MB
FMB (PC1)
FMB (PC2)
FMB (FF1)
FMB (FF3)
FMB (FF5)

Return

Markowitz (risk-constrained)

42

0.0006
0.0020
0.0007
0.0079
0.0004
0.0055
0.0005
0.0051
0.0006
0.0100
0.0003
0.0062
0.0001
0.0062

With TC
Lasso (PC0)
De-biased Lasso (PC0)
Lasso (PC1)
De-biased Lasso (PC1)
Lasso (PC2)
De-biased Lasso (PC2)
Lasso (PC3)
De-biased Lasso (PC3)
Lasso (FF1)
De-biased Lasso (FF1)
Lasso (FF3)
De-biased Lasso (FF3)
Lasso (FF5)
De-biased Lasso (FF5)
0.0049
0.0100
0.0059
0.0300
0.0052
0.0265
0.0065
0.0245
0.0038
0.0346
0.0040
0.0265
0.0042
0.0300

0.0048
0.0100
0.0059
0.0300
0.0052
0.0265
0.0064
0.0245
0.0039
0.0346
0.0040
0.0265
0.0042
0.0300
0.1189
0.1953
0.1141
0.2725
0.0845
0.2061
0.0792
0.2079
0.1654
0.2949
0.0852
0.2352
0.0310
0.2124

0.1406
0.2266
0.1350
0.3117
0.1122
0.2542
0.1051
0.2603
0.1902
0.3213
0.1113
0.2721
0.0577
0.2467

SR

0.0719
0.7952
0.0984
1.0562
0.1136
1.2113
0.1353
1.2337
0.0789
0.8298
0.0785
0.9142
0.0861
0.9507

-

Turnover

0.1005 0.2668
0.1118 0.2571
0.1192 0.1559
0.1245 0.1077
0.1122 0.1639

0.0288
0.0186
0.0134
0.0184

0.1127 0.1879

0.0212

0.0268

0.1245 0.1263

0.0157

0.1187 0.1826

0.1192 0.1738

0.0207

0.0217

0.1118 0.2784

0.0312

0.1212 0.2155

0.1005 0.2882

0.0290

0.0262

0.1187 0.2034

0.0242

SR

0.1217 0.2362

Risk

Markowitz (RC)

0.0287

Return

2.2542

2.2245

2.1589

2.2449

2.1756

2.2720

2.1249

-

-

-

-

-

-

-

Turnover

Risk

0.0693

0.1153

0.2468

0.0775

0.0624

0.0656

0.0076

0.0120

0.0013

0.0059

0.0059

0.0084

0.0693

0.1149

0.2458

0.0775

0.0624

0.0656

-0.0191 0.4990

0.0093

0.0136

0.0031

0.0076

0.0075

0.0100

-0.0174 0.4987

Return

0.1098

0.1046

0.0052

0.0762

0.0940

0.1279

-0.0383

0.1342

0.1182

0.0124

0.0985

0.1205

0.1529

-0.0350

SR

Markowitz (WC)

Risk

Markowitz (RC)

1.6033

1.6208

1.7374

1.7031

1.5777

1.5709

1.5373

-

-

-

-

-

-

-

Turnover

0.0083

-0.0236

-0.0234

0.0083

0.0076

0.0073

-0.0199

0.0094

-0.0226

-0.0222

0.0094

0.0087

0.0085

-0.0187

Return

SR

GMV

0.2014

0.1901

0.1734

0.0959

0.1784

0.1652

0.1497

0.0980

0.0844

0.6058 -0.0390

0.6056 -0.0386

0.0469

0.0458

0.0490

0.4945 -0.0402

0.0980

0.6054 -0.0373

0.6047 -0.0367

0.0469

0.0458

0.0490

0.4941 -0.0379

Risk

1.0944

1.0482

1.1113

1.0671

1.1026

1.0919

1.0737

-

-

-

-

-

-

-

Turnover

Table 5: Sparse portfolio (FMB is used for de-biasing): monthly portfolio returns, risk, Sharpe Ratio and turnover. Transaction costs are set to 50
basis points, targeted risk is set at σ = 0.05 (which is the standard deviation of the monthly excess returns on S&P 500 index from 1980 to 1995, the
first training period), monthly targeted return is 0.7974% which is equivalent to 10% yearly return when compounded. Factor Nodewise-regression
estimator of precision matrix is used for de-biasing. Selection threshold for Post-Lasso is  = 0.000001. In-sample: January 1, 1980 - December 31,
1995 (180 obs), Out-of-sample: January 1, 1995 - December 31, 2019 (300 obs).

0.0007
0.0023
0.0008
0.0091
0.0006
0.0067
0.0007
0.0064
0.0007
0.0109
0.0004
0.0072
0.0002
0.0073

Without TC
Lasso (PC0)
De-biased Lasso (PC0)
Lasso (PC1)
De-biased Lasso (PC1)
Lasso (PC2)
De-biased Lasso (PC2)
Lasso (PC3)
De-biased Lasso (PC3)
Lasso (FF1)
De-biased Lasso (FF1)
Lasso (FF3)
De-biased Lasso (FF3)
Lasso (FF5)
De-biased Lasso (FF5)

Return

Post-Lasso

De-Biasing

Markowitz (risk-constrained)
Return

Risk

SR

Without TC
Lasso (PC1)
-9.47E-07 2.12E-04 -0.0045
Debiased Lasso (PC1)
6.88E-05 2.15E-03 0.0320
Lasso (PC2)
3.86E-07 2.40E-04 0.0016
Debiased Lasso (PC2)
7.50E-05 2.42E-03 0.0310
Lasso (FF1)
6.13E-08 5.49E-05 0.0011
Debiased Lasso (FF1)
5.82E-05 2.28E-03 0.0256
Lasso (FF3)
2.45E-07 1.05E-04 0.0023
Debiased Lasso (FF3)
6.12E-05 2.31E-03 0.0265
Lasso (FF5)
9.87E-09 6.34E-05 0.0002
Debiased Lasso (FF5)
4.67E-05 2.23E-03 0.0209
With TC
Lasso (PC1)
-1.06E-06 2.12E-04 -0.0050
Debiased Lasso (PC1)
3.92E-05 2.15E-03 0.0182
Lasso (PC2)
2.59E-07 2.40E-04 0.0011
Debiased Lasso (PC2)
4.37E-05 2.42E-03 0.0180
Lasso (FF1)
-6.13E-09 5.49E-05 -0.0001
Factor Debiased Lasso (FF1) 3.12E-05 2.28E-03 0.0137
Lasso (FF3)
1.53E-07 1.05E-04 0.0015
Debiased Lasso (FF3)
3.25E-05 2.31E-03 0.0141
Lasso (FF5)
-6.47E-08 6.34E-05 -0.0010
Debiased Lasso (FF5)
1.97E-05 2.23E-03 0.0088

Turnover

0.0001
0.0293
0.0001
0.0311
0.0001
0.0266
0.0001
0.0286
0.0001
0.0268

Table 6: Sparse Portfolio (FMB is used for de-biasing): daily portfolio returns, risk, Sharpe Ratio and
turnover. Transaction costs are set to 50 basis points, targeted risk is set at σ = 0.013 (which is the standard
deviation of the daily excess returns on S&P 500 index from 2000 to 2002, the first training period), daily
targeted return is 0.0378% which is equivalent to 10% yearly return when compounded. In-sample: January
20, 2000 - January 24, 2002 (504 obs), Out-of-sample: January 25, 2002 - January 31, 2020 (4536 obs).

43

44

2.1662
1.3285
1.3153
2.0379
0.2791
0.3960
0.4117
0.2784
0.1890
0.3424
0.3626
0.1906

MB
FMB (PC1)
FMB (PC2)
FMB (FF1)

MB
FMB (PC1)
FMB (PC2)
FMB (FF1)

MB
FMB (PC1)
FMB (PC2)
FMB (FF1)

0.0496
0.0385
0.0373
0.0488

0.0496
0.0374
0.0364
0.0487

0.3381
0.0892
0.0883
0.3029

0.0547
0.0508

Risk
-0.4987
-0.4924

CER
0.1203
0.0929

Risk

0.2916
0.1297
0.1286
0.2660

-3.0688
-3.0470
0.1312
-2.7247

0.5101
0.4735
0.1219
0.4301

Markowitz Risk-Constrained (MRC)

0.0519
0.0539

Risk

Financial Crisis
(2007-2009)

-0.1235
-0.1534
-0.1550
-0.1207

-0.0470
-0.1224
-0.1227
-0.0396

-0.4637
-0.4588
-0.3444
-0.4570

0.1015
0.0987
0.0393
0.0986

0.0524
0.0520
0.0513
0.0517

-0.5195
-0.5147
-0.4044
-0.5106

0.1018
0.0992
0.0440
0.0996

Markowitz Weight-Constrained (MWC)

0.0476
0.0510
0.0505
0.0468

Global Minimum-Variance Portfolio (GMV)

-0.1140
0.4241
0.5016
0.0861

-0.0322
-0.1698

CER

Argentine Great Depression
and Dot-com Bubble
(1999-2002)

0.2591
0.2638
0.3061
0.2613

0.1601
0.2656
0.3100
0.2640

0.9755
1.2022
1.0534
1.5366

0.2343
0.2155

CER

0.0339
0.0336
0.0322
0.0333

0.0340
0.0337
0.0321
0.0332

0.0847
0.1658
0.1359
0.1751

0.0344
0.0364

Risk

Ukrainian Crisis
and Chinese Stock Market Crash
(2013-2015)

Table 7: Cumulative excess return (CER) and risk of non-sparse portfolios using monthly data.

0.2712
0.3222

EW
Index

CER

Asian and Russian
Financial Crisis
(1997-1998)

45
0.4467
0.4403
0.3385
0.0711

0.4954
0.1549
0.3903
-0.4170

Post-Lasso (PC1)
Post-Lasso (PC2)
Post-Lasso (FF1)
Post-Lasso (FF3)

Post-Lasso (PC1)
Post-Lasso (PC2)
Post-Lasso (FF1)
Post-Lasso (FF3)

0.0892
0.0849
0.0600
0.0954

0.0693
0.0593
0.0616
0.0713

0.2211
0.1401
0.1568
0.1887

0.0052
0.0300
0.0053
0.0261
0.0039
0.0277
0.0041
0.0142

0.0547
0.0508

Risk

0.9488
1.3192
-0.0724
-0.2648

0.1031
0.8150
0.8151
0.1458

1.8399
4.5196
-0.9059
7.8165

0.0186
0.0674
0.0356
0.0540
0.0152
-0.0852
0.0079
-0.0640

-0.0322
-0.1698

CER
-0.4987
-0.4924

CER

-0.0007
0.0440
-0.0777
0.1129
0.0564
-0.0258
-0.0328
-0.0406

6.6131
-0.8538
2.8639
-0.9998

-0.0206
-0.3694
-0.5545
0.0295

0.0946
0.1249
0.2349
0.1068

-0.1704
-0.4729
-0.1925
-0.0189

Post-Lasso MWC

0.0649
0.0955
0.0877
0.1061

Post-Lasso GMV

0.1445
0.2173
0.1121
0.2595

Post-Lasso MRC

0.0055
0.0251
0.0053
0.0304
0.0039
0.0275
0.0044
0.0300

0.1031
0.1339
0.1308
0.0703

0.1108
0.1243
0.1213
0.0694

0.2962
0.1884
0.2404
0.1410

0.0185
0.0341
0.0130
0.0408
0.0100
0.0230
0.0098
0.0202

0.1203
0.0929

Risk

Financial Crisis
(2007-2009)

Debiased MRC

0.0519
0.0539

Risk

Argentine Great Depression
and Dot-com Bubble
(1999-2002)

-0.0804
0.0596
0.1251
0.0893

-0.0934
0.0698
0.1754
0.1634

-0.2484
1.7153
1.4470
-0.1561

-0.0014
0.2066
0.0052
0.1567
0.0179
0.1681
0.0167
0.1782

0.2343
0.2155

CER

0.0598
0.0465
0.0457
0.0399

0.0371
0.0492
0.0452
0.0463

0.1281
0.1253
0.1828
0.1799

0.0027
0.0153
0.0038
0.0217
0.0035
0.0240
0.0035
0.0186

0.0344
0.0364

Risk

Ukrainian Crisis
and Chinese Stock Market Crash
(2013-2015)

Table 8: Cumulative excess return (CER) and risk of sparse portfolios using monthly data.

3.0881
2.3196
2.3433
0.6691

0.0380
0.3553
0.0378
0.2962
0.0297
0.4149
0.0335
0.2123

Lasso (PC1)
Debiased Lasso (PC1)
Lasso (PC2)
Debiased Lasso (PC2)
Lasso (FF1)
Debiased Lasso (FF1)
Lasso (FF3)
Debiased Lasso (FF3)

Post-Lasso (PC1)
Post-Lasso (PC2)
Post-Lasso (FF1)
Post-Lasso (FF3)

0.2712
0.3222

EW
Index

CER

Asian and Russian
Financial Crisis
(1997-1998)

Appendices
A.1

Proof of Theorem 2

The first part of Theorem 2 was proved in Fan et al. (2018) (see their proof of Theorem 2.1) under the assumptions (A.1)-(A.3), (B.1)-(B.3) and log(p) = o(T ). To prove
the convergence rates for the precision matrix of the factor-adjusted returns, we follow
Chang et al. (2018), Caner and Kock (2018) and Callot et al. (2019). Using the facts that
P
maxi≤p (1/T ) Tt=1 |ε̂it − εit | = Op (ωT2 ) and maxi,t |ε̂it − εit | = Op (ωT ) = op (1), we get
max kb
γj − γj k1 = Op (s̄ωT ),

(A.1)

1≤j≤p

bj was defined in (3.1). The
where γ
pproof of A.1 is similar to the proof of the equation (23)
of Chang et al. (2018), with ωT = log(p)/T for their case. Similarly to Callot et al. (2019),
consider the following linear model:
b −j γj + ηj , for j = 1, . . . , p,
εbj = E
h
i
b −j = 0.
E ηj0 E

(A.2)

van de Geer et al. (2014) and Chang et al. (2018) showed that
b −j
max ηj0 E

1≤j≤p

∞

/T = Op (ωT ).

(A.3)



Let τj2 := E ηj0 ηj , then we have
max ηj0 ηj /T − τj2 = Op (ωT ).

(A.4)

1≤j≤p

Note
p that the rate in (A.4) is the same as in Lemma 1 of Chang et al. (2018) with
ωT = log(p)/T for their case. However, the rate in (A.4) is different from the one derived in van de Geer et al. (2014) since we allow time-dependence between factor-adjusted
returns.
b −j γ
bj
Recall that τ̂j2 = εbj − E

2
2

/T + λj kb
γj k1 . Using triangle inequality, we have:

b −j (b
max τ̂j2 − τj2 ≤ max ηj0 ηj /T − τj2 + max ηj0 E
γj − γj )/T
1≤j≤p
1≤j≤p
|
{z
} |
{z
}

1≤j≤p

I

II

b −j γj /T + max γ 0 E
b 0 b γj − γj )/T .
+ max ηj0 E
j −j E−j (b
1≤j≤p
1≤j≤p
|
{z
} |
{z
}
III

IV

The first term was bounded in A.4, we now bound the remaining terms:
b −j /T
II ≤ max ηj0 E
1≤j≤p

max kb
γj − γj k1 = Op (s̄ωT2 ),

∞ 1≤j≤p

46

where we used A.1 and A.3. For III we have
b −j /T
III ≤ max ηj0 E
1≤j≤p

√
max kγj k1 = Op ( s̄ωT ),

∞ 1≤j≤p

√
√
where we used A.3 and the fact that kγj k1 ≤ sj kγj k2 = O( sj ). To bound the last term,
we use KKT conditions in node-wise regression:
b γj − γj )/T
b0 E
max E
−j −j (b

1≤j≤p

∞

b 0 ηj /T
≤ max E
−j
1≤j≤p

∞

+ max λj = Op (ωT ),
1≤j≤p

where we used A.3 and λj  ωT . It follows that
√
IV = Op (ωT ) max kγj k1 = Op ( s̄ωT ).
1≤j≤p

Therefore, we now have shown that
√
max τ̂j2 − τj2 = Op ( s̄ωT ).

1≤j≤p

(A.5)

Using the fact that 1/τj2 = O(1), we also have
√
1/τ̂j2 − 1/τj2 = Op ( s̄ωT ).

(A.6)

Finally, using the analysis in (B.51)-(B.53) of Caner and Kock (2018), we get
b ε,j − Θε,j
max Θ

1≤j≤p

1

= Op (sT ωT ).

(A.7)

To prove the second rate for the precision of the factor-adjusted returns, we note that
√
max kb
γj − γj k2 = Op ( s̄ωT ),
(A.8)
1≤j≤p

which was obtained in Chang et al. (2018) (see their Lemma 2). We can write
b ε,j − Θε,j
max Θ

1≤j≤p

A.2

2

√
≤ max [kb
γj − γj k2 /τ̂j2 + kγj k2 1/τ̂j2 − 1/τj2 ] = Op ( s̄ωT ).
1≤j≤p

(A.9)

Proof of Theorem 3

b=Λ
b 1/2 Γ
b 0Θ
b εΓ
bΛ
b 1/2 and J
e=Λ
e 1/2 Γ
e 0 Θε Γ
eΛ
e 1/2 . Also, define
Let J
b εΓ
bΛ
b 1/2 (IK + J)
b −1 Λ
b 1/2 Γ
b 0Θ
b ε − Θε Γ
eΛ
e 1/2 (IK + J)
e −1 Λ
e 1/2 Γ
e 0 Θε .
∆inv = Θ
Using Sherman-Morrison-Woodbury formulas in 3.9, we have
b −Θ
Θ

≤
1

b ε − Θε
Θ

47

1

+ |||∆inv |||1 .

(A.10)

As pointed out by Fan et al. (2018), |||∆inv |||1 can be bounded by the following three terms:
1 √
· s̄),
p
1
√
√
e 0 Θε = Op ( s̄ · pωT · 1 · s̄),
e 1/2 Γ
bΛ
b 1/2 − Γ
eΛ
e 1/2 )(IK + J)
e −1 Λ
Θε ( Γ
p
1
√
√
e 0 ((IK + J)
b −1 − (IK + J)
e −1 )Γ
e 0 Θε = Op ( s̄ · 1 · ps̄ωT s̄).
e 1/2 Γ
Θε Λ
p
1
e 0 Θε
e 1/2 Γ
b ε − Θε )Γ
eΛ
e 1/2 (IK + J)
e −1 Λ
(Θ

= Op (s̄ωT · p ·

bΛ
bΓ
b 0 − BB0
To derive the above rates we used (B.1)-(B.3), Theorem 2 and the fact that Γ

=
F

Op (pωT ). The second rate in Theorem 3 can be easily obtained using the technique described above for the l2 -norm.

A.3

Lemmas for Theorem 4

Lemma 1. Under the assumptions of Theorem 3,
p
b − mkmax = Op ( log(p)/T ), where m is the unconditional mean of stock returns defined
(a) km
b is the sample mean.
in Subsection 3.2, and m
(b) |||Θ|||1 = O(s̄).
Proof.
(a) The proof of Part (a) is provided in Chang et al. (2018) (Lemma 1).
(b) To prove Part (b) we use Sherman-Morrison-Woodbury formula in 3.9:
|||Θ|||1 ≤ |||Θε |||1 + Θε B[IK + B0 Θε B]−1 B0 Θε
√
√
1 √
= O( s̄) + O( s̄ · p · · s̄) = O(s̄).
p

1

(A.11)

The last equality in A.11 is obtained under the assumptions of Theorem 4. This result
is important in several aspects: it shows that the sparsity of the precision matrix
of stock returns is controlled by the sparsity in the precision of the idiosyncratic
returns. Hence, one does not need to impose an unrealistic sparsity assumption on
the precision of returns a priori when the latter follow a factor structure - sparsity
of the precision once the common movements have been taken into account would
suffice.

b m/p.
b 0Θ
b
Lemma 2. Define θ = m0 Θm/p and θb = m
Under the assumptions of Theorem 3:
(a) θ = O(1).
(b) θb − θ = Op (s̄2 ωT ) = op (1).
(c) |r̂c − rc | = Op (s̄2 ωT ) = op (1), where rc was defined in (2.17).
48

Proof.
(a) Part (a) is trivial and follows directly from |||Θ|||2 = O(1).
(b) First, rewrite the expression of interest:
b − Θ)(m
b − m)0 (Θ
b − m)]/p + [(m
b − m)0 Θ(m
b − m)]/p
θb − θ = [(m
b − Θ)(m
b − m)0 Θm]/p + [2m0 (Θ
b − m)]/p
+ [2(m
b − Θ)m]/p.
+ [m0 (Θ

(A.12)

We now bound each of the terms in A.12 using the expressions derived in Callot et al.
(2019) (see their Proof of Lemma A.3), Lemma 1 and the fact that log(p)/T = o(1).
b − Θ)(m
b −Θ
b − m)0 (Θ
b − m) /p ≤ km
b − mk2max Θ
(m

 log(p)
· s̄2 ωT
= Op
T
b − m)0 Θ(m
b − m)|/p ≤ km
b − mk2max |||Θ|||1 = Op
|(m

0

b − m) Θm|/p ≤ km
b − mkmax |||Θ|||1 = Op
|(m



r

 log(p)
T

b − Θ)m /p ≤
m0 (Θ

b −Θ
Θ

1



= Op s̄2 ωT .

(c) Part (c) trivially follows from Part (b).

A.4

Proof of Theorem 4

The KKT conditions for the nodewise Lasso in (3.1) imply that
b −j γ
bj )0 εbj /T,
τ̂j2 = (b
εj − E
hence,
b 0 /T = 1.
bΘ
εb0j E
ε,j
49


· s̄ .

log(p) 
· s̄ .
T

b − Θ)(m
b −Θ
b − m) /p ≤ km
b − mkmax Θ
m0 (Θ
r

 log(p)
· s̄2 ωT .
= Op
T

1

(A.13)

(A.14)

(A.15)

1

(A.16)

(A.17)

As shown in van de Geer et al. (2014), these KKT conditions also imply that
b0 E
bb
E
−j Θε,j

∞

/T ≤ λj /τ̂j2 .

(A.18)

Therefore, the estimator of precision matrix needs to satisfy the following “extended KKT”
condition:
b εΘ
b 0 − ej
Σ
ε,j

∞

≤ λj /τ̂j2 ,

(A.19)

where ej is the j-th unit column vector. Combining the rate in l1 norm in Theorem 3 and
(A.19), we have:
bΘ
b 0 − ej
Σ
j

∞

≤ λj /τ̂j2 ,

(A.20)

Using the definition of ∆ in (2.23), it is straightforward to see that
√
bΣ
b − Ip )(w
b − w)
k∆k∞ / T = (Θ

∞

bΣ
b − Ip
≤ Θ

∞

b − wk1 .
kw

(A.21)

Therefore, combining (A.20) and (A.21), we have
k∆k∞


√
√ 
2
2
b − wk1 max λj /τ̂j = Op ( T · s0 ∨ s̄ ωT · ωT )
≤ T kw
j


√
2
= Op ( s0 ∨ s̄ log(p)/ T ) = op (1).

50

(A.22)
(A.23)

