ML4H Extended Abstract Arxiv Index:1–10, 2020

Machine Learning for Health (ML4H) 2020

Estimating County-Level COVID-19 Exponential Growth
Rates Using Generalized Random Forests
Zhaowei She∗

zshe3@gatech.edu

Georgia Institute of Technology

Zilong Wang∗

zwang937@gatech.edu

arXiv:2011.01219v4 [cs.LG] 14 Nov 2020

Georgia Institute of Technology

Turgay Ayer

ayer@isye.gatech.edu

Georgia Institute of Technology

Asmae Toumi

atoumi@mgh.harvard.edu

Massachusetts General Hospital

Jagpreet Chhatwal

jagchhatwal@mgh.harvard.edu

Massachusetts General Hospital, Harvard Medical School

Abstract
Rapid and accurate detection of community outbreaks is critical to address the threat of resurgent waves of
COVID-19. A practical challenge in
outbreak detection is balancing accuracy vs. speed. In particular, while estimation accuracy improves with longer
fitting windows, speed degrades. This
paper presents a machine learning
framework to balance this tradeoff using
generalized random forests (GRF), and
applies it to detect county level COVID19 outbreaks. This algorithm chooses
an adaptive fitting window size for each
county based on relevant features affecting the disease spread, such as changes
in social distancing policies. Experiment results show that our method outperforms any non-adaptive window size
choices in 7-day ahead COVID-19 outbreak case number predictions.

1. Introduction
Early and accurate detection of community
outbreaks is critical to address the threat of
resurgent waves of COVID-19. Specifically,
an epidemic outbreak is confirmed when its

incident cases are estimated to grow exponentially. Furthermore, the potential impact
of an outbreak is also measured by its exponential growth rate, as higher rates indicate more rapid disease spread. Last but not
least, for a fixed epidemiology model (e.g.
SIR, SEIR), there is an one-to-one correspondence between the exponential growth rate of
an epidemic outbreak and its basic reproduction number R0 , a common measure of intensity of epidemic outbreaks (Lipsitch et al.,
2003). Therefore, the exponential growth
rate of an epidemic outbreak’s incident cases
is the most important ”model-free” parameter to estimate for detecting the outbreak
(Chowell et al., 2003).
It remains an epidemiological challenge to
obtain accurate exponential growth rate estimates for disease outbreaks (Ma et al., 2014).
Specifically, it is difficult to choose the fitting
window size for the exponential growth rate
estimation to balance the speed and accuracy of outbreak detection. On one hand, a
longer fitting window is preferable as larger
sample size would reduce variance of the exponential growth rate estimates of outbreaks.

© 2020 Z. She, Z. Wang, T. Ayer, A. Toumi & J. Chhatwal.

Estimating County-Level COVID-19 Exponential Growth Rates

On the other hand, shorter fitting windows
are better at detecting early-stage outbreaks,
especially if these outbreaks were driven by
recent policy changes such as school reopening. In the current practice, this fitting window size is treated as a hyperparameter that
is either directly specified by the user (c.f.
The University of Melbourne (2020)) or determined by some cross validation methods
(c.f. Chowell et al. (2007)).
This paper develops a machine learning
framework that balances the speed-accuracy
tradeoff of outbreak detection via dedicated
feature engineering and GRF (c.f. Athey
et al. (2019)), and apply it to detect countylevel COVID-19 outbreaks. Specifically, the
algorithm chooses an adaptive fitting window
size for each county based on a rich set of features that affect the disease spread, such as
face mask mandates, social distancing policies, the CDC’s Social Vulnerability Index,
changes in tests performed and rate of positive tests. Furthermore, for counties with
insufficient data to capture the recent policy changes, the algorithm pools together all
relevant incident case growth trends across
U.S. counties and throughout the COVID-19
pandemic history to adjust for these policy
changes.

for all counties c ∈ C, while I0,c captures the
initial incident case numbers at the beginning of the exponential case growth at county
c. To obtain the most recent exponential
growth rate of county-level COVID-19 incident case number, we estimate the instantaneous counterpart of (1),

1. See Appendix B for the epidemiological definition
of incident case number and how we compute It .

The exponential growth rate of COVID19 incident cases can be affected by many

ln(It,c ) = αt,c + rt,c t + εt,c ,

(2)

where the dependent variable is the loglinearized incident case number ln(It,c ); independent variable is day t. The parameter
of interest is the COVID-19 incident case exponential growth rate of county c at day t,
rt,c . The intercept term, αt,c , is a parameter
capturing the log-linearized initial incident
case number of county c at the beginning of
the outbreak. εt,c is the error term.
Notably, the exponential growth rate rt,c
in (2) varies in both day t and county c.
In other words, we are interested in estimating the instantaneous county-level exponential growth rate of COVID-19 incident cases.
Specifically, since COVID-19 related regulations are changing every day in the U.S.
(c.f. Raifman et al. (2020)), the county-level
exponential growth rates, affected by these
policies, also change from day to day. Therefore, in order to detect recent outbreaks, we
need to estimate the most recent incident
2. Background
cases exponential growth rate. This instantaneous exponential growth rate rt,c , simi2.1. Exponential Growth Model and
lar to the instantaneous reproduction numExponential Growth Rate
ber commonly used in the epidemiology literDuring an epidemic outbreak, incident case
ature (c.f. Fraser (2007); Cori et al. (2013)),
number at county c ∈ C ⊂ N on day t ∈ T ⊂
captures the projected exponential growth
N, i,e. It,c , is governed by an exponential
rate of incident cases in county c should
growth model,
the future COVID-19 regulations remain the
It,c = I0,c exp {rt}
same as those in day t.
⇐⇒ ln(It,c ) = ln(I0,c ) + rt.
(1)
(Ma et al., 2014).1 Here r is the incident 2.2. Relevant Features Affecting
COVID-19 Disease Spread
cases exponential growth rate of outbreaks

2

Estimating County-Level COVID-19 Exponential Growth Rates

factors ranging from day-to-day changes in
COVID-19 regulations to difference in population density and healthcare resources between counties. Hence, in order to estimate
the instantaneous county-level exponential
growth rate rt,c defined in (2), we need to
control for these day-level and county-level
heterogeneity. Provided that we have relevant features Xt,c ∈ Rm that captures these
aforementioned factors affecting the instantaneous county-level exponential growth rate
rt,c ,2 we can identify the conditional average partial treatment effect rt,c (Xt,c ) :=
E[rt,c |Xt,c ] as defined by Wooldridge (2010).
When data of these relevant features affecting COVID-19 disease spread is available, we
can rewrite (2) as

That is, day t is independent of all unobservable heterogeneity conditional on the feature
vector Xt,c . Under Assumption 2, we can derive the following moment equations for (3):
∀Xt,c ∈ Rm ,
E[Γ(t)(ln(It,c ) − αt,c (Xt,c ) − rt,c (Xt,c )t)|Xt,c ]
= 0,

(4)

through the instrumental variable Γ(t) :=
[10 (t); 11 (t); 12 (t); . . . ], where 1s (t) is a
Boolean function equal 1 if t = s.
However, we note that the moment equations (4) cannot identify the exponential
growth rate rt,c (Xt,c ). Specifically, the moment equation system (4) is underidentified as the number of unknown parameters
{αt,c (Xt,c ), rt,c (Xt,c )}t∈T,c∈C is exactly two
ln(It,c ) = αt,c (Xt,c ) + rt,c (Xt,c )t + εt,c (3) times the number of moment equations. To
address this problem, we assume that the exfollowing the common “redundant” assump- ponential growth rate of day t∗ equal the
tion (c.f. Wooldridge (2010)), i.e.
local average causal response (c.f. Abadie
(2003); Angrist and Imbens (1995)) from day
Assumption 1 ∀t ∈ T, ∀c ∈ C, ∀Xt,c ∈ Rm t∗ − 1 to day t∗ , i.e.
E[ln(It,c )|t, αt,c , rt,c , Xt,c ] = E[ln(It,c )|t, αt,c , rt,cAssumption
]
3
∗
∀t ∈ T \{0}, ∀c ∈ C, ∀Xt∗ ,c ∈ Rm

3. Model Estimation
rt∗ ,c (Xt∗ ,c )

This section discusses how we estimate the
exponential growth rate of COVID-19 incident cases rt,c (Xt,c ) defined in (3). Specifically, we first formulate the estimation problem in §3.1 and then present our estimation
algorithm in §3.2.

E[ln(It,c )|1t∗ (t) = 1, Xt∗ ,c ]
E[t|1t∗ (t) = 1, Xt∗ ,c ] − E[t|1t∗ −1 (t) = 1, Xt∗ ,c ]
E[ln(It,c )|1t∗ −1 (t) = 1, Xt∗ ,c ]
−
E[t|1t∗ (t) = 1, Xt∗ ,c ] − E[t|1t∗ −1 (t) = 1, Xt∗ ,c ]
=

Parameters {αt,c (Xt,c ), rt,c (Xt,c )}t∈T,c∈C are
exactly identified by the moment equations
(4) under Assumption 3.

3.1. Problem Formulation

First, we need the following “unconfoudness” assumption (c.f. Rosenbaum and Ru- 3.2. Estimation Algorithms
bin (1983)):
Given the above assumptions, the exm
ponential growth function of COVID-19
Assumption 2 ∀t ∈ T, ∀Xt,c ∈ R
incident cases (3) can be estimated using
E[ln(It,c ) − αt,c (Xt,c ) − rt,c (Xt,c )t|t, Xt,c ] = 0. the GRF algorithm by Athey et al. (2019).
2. Refer to Appendix C for the list of relevant fea- Specifically, Assumption 3 implies that the
tures used in this study.
exponential growth rate of a county c on day
3

Estimating County-Level COVID-19 Exponential Growth Rates

t∗ is identified by a targeted data “block”
{(It∗ ,c , Xt∗ ,c ), (It∗ −1,c , Xt∗ −1,c )}.
Hence,
when estimating rt∗ ,c (Xt∗ ,c ), we can partition the panel
 t∗  dataset {(It,c , Xt,c )}t∈T,c∈C
into |C| × 2 data blocks, and pool those
data blocks “similar” to the targeted block
to construct an adaptive window size for
this estimation. Particularly, the similarity
measure is provided by the GRF algorithm.
In Appendix A, Algorithm 1 provides the
pseudocode to construct these data blocks.
Algorithm 2 explains how we feed these data
blocks into the GRF algorithm to obtain the
estimates of interest.

in general lead to lower median MAPEs (c.f.
Table 1), it was still frequently outperformed
by longer fitting window size choices (c.f.
Figure 1).

4. Performance Evaluation
To benchmark our method against nonadaptive window size choices, we compare the Mean Absolute Percentage Error
(MAPE) of these methods’ 7-day ahead predictions. Specifically, we use the NYTimes
COVID-19 Dataset (c.f. The New York
Times (2020)) as the source of daily reported cases per county. Additional results
for performance evaluation are available at
Appendix D.
As shown in Figure 1 and Table 1, our
method outperforms methods with fixed 2, 4-, 8- or 16-day fitting window sizes.
Specifically, Figure 1 shows that our method
provides a uniformly better performance
roughly 100 days after the first recorded
COVID-19 case in the NYTimes COVID19 Dataset, when there were enough historical data for the GRF algorithm to conduct meaningful partition. Furthermore, Table 1 demonstrates that even if the earlyday MAPEs are included in the comparison,
our method still has the best median MAPE
among the 4 methods. Last but not least, we
note that when only comparing the performance of non-adaptive window size choices,
there are no obvious best choice. While
choosing shorter fitting window sizes could

Figure 1: MAPE Plot (4-day Moving Average)

Table 1: Median RMSE and MAPE (4-day
Moving Average)

Method

MAPE

OLS.wsize=16
OLS.wsize=8
OLS.wsize=4
OLS.wsize=2
GRF

0.0585
0.0529
0.0483
0.0455
0.0423

5. Conclusion and Future Work
In this work, we developed a novel framework that allows GRF to adequately balance
the the speed-accuracy tradeoff in COVID-19
outbreak detection. This estimation framework can be readily extended to other epidemiology problems where fitting window
size impacts model performance.
4

Estimating County-Level COVID-19 Exponential Growth Rates

References

Christophe Fraser. Estimating individual
and household reproduction numbers in an
Alberto Abadie. Semiparametric instrumenemerging epidemic. PloS one, 2(8):e758,
tal variable estimation of treatment re2007.
sponse models. Journal of econometrics,
113(2):231–263, 2003.
Marc Lipsitch, Ted Cohen, Ben Cooper,
James M Robins, Stefan Ma, Lyn James,
Gowri Gopalakrishna, Suok Kai Chew,
Chorh Chuan Tan, Matthew H Samore,
et al. Transmission dynamics and control
of severe acute respiratory syndrome. Science, 300(5627):1966–1970, 2003.

Joshua D Angrist and Guido W Imbens.
Two-stage least squares estimation of average causal effects in models with variable treatment intensity. Journal of the
American statistical Association, 90(430):
431–442, 1995.

Susan Athey, Julie Tibshirani, Stefan Wager, Junling Ma, Jonathan Dushoff, Benjamin M
Bolker, and David JD Earn. Estimatet al. Generalized random forests. The Aning initial epidemic growth rates. Bulnals of Statistics, 47(2):1148–1178, 2019.
letin of mathematical biology, 76(1):245–
260, 2014.
Centers for Disease Control and Prevention.
Centers for Disease Control and Prevention Social Vulnerability Index 2018 J Raifman, K Nocka, D Jones, J Bor,
S Lipson, J Jay, and P Chan. CovidDatabase. Available at https://www.
19 us state policy database.
Availatsdr.cdc.gov/placeandhealth/svi/
able at www.tinyurl.com/statepolicies
data_documentation_download.html,
(Accessed September, 18, 2020), Septem2018.
ber 2020.
Gerardo Chowell, Paul W Fenimore,
Melissa A Castillo-Garsow, and Carlos Paul R Rosenbaum and Donald B Rubin.
The central role of the propensity score
Castillo-Chavez. Sars outbreaks in onin observational studies for causal effects.
tario, hong kong and singapore: the role
Biometrika, 70(1):41–55, 1983.
of diagnosis and isolation as a control
mechanism. Journal of theoretical biology,
The Atlantic. The COVID Tracking Project.
224(1):1–8, 2003.
Available at https://covidtracking.
com/, 2018.
Gerardo Chowell, Hiroshi Nishiura, and
Luis MA Bettencourt. Comparative estimation of the reproduction number for The New York Times. Coronavirus (Covid19) Data in the United States. Availpandemic influenza from daily case notifiable at https://github.com/nytimes/
cation data. Journal of the Royal Society
covid-19-data (Accessed 2020-09-07),
Interface, 4(12):155–166, 2007.
2020.
Anne Cori, Neil M Ferguson, Christophe
CoroFraser, and Simon Cauchemez. A new The University of Melbourne.
navirus 10-day forecast.
Available
framework and software to estimate timeat https://covid19forecast.science.
varying reproduction numbers during epiunimelb.edu.au/ (Accessed September,
demics. American journal of epidemiology,
18, 2020), September 2020.
178(9):1505–1512, 2013.
5

Estimating County-Level COVID-19 Exponential Growth Rates

United States Census Bureau. 2019 US Cen- Appendix A. Pseudocode for
sus Gazetteer Files. Available at https:
Estimation
//www.census.gov/geographies/
Algorithms
reference-files/time-series/geo/
gazetteer-files.html, 2019.
Algorithm 1: Block Transformation
Jeffrey M Wooldridge. Econometric analysis Input: {(It,c , Xt,c )}t∈T,c∈C
of cross section and panel data. MIT press, Output: {F eature[t, c]}t∈T,c∈C ,
{Y [t, c, 1], Y [t, c, 0]}t∈T,c∈C
2010.
for c ← 0 to |C| do
for t ← 1 to |T | do

1. Normalize the incident case numbers for
each block
Y [t, c, 1] ← ln(It,c ) − ln(It−1,c )
Y [t, c, 0] ← 0
2. Generate the initial rough OLS estimates for
each block
Dep ← {Y [t, c, 0], Y [t, c, 1]}
Ind ← {0, 1}
rols , αols ← OLS(Dep ∼ Ind)
3. Append the feature data for each block
F eature[t, c] ← {Xt,c , rols , αols , It−1,c }
end
end

6

Estimating County-Level COVID-19 Exponential Growth Rates

Algorithm 2: GRF Training for Day t∗
Input: {F eature[t, c]}t∈[0,1,...,t∗ ],c∈C ,
{Y [t, c, 1], Y [t, c, 0]}t∈[0,1,...,t∗ ],c∈C
Output: {rt∗ ,c (Xt∗ ,c )}c∈C

Appendix B. Epidemiological
Definitions
For this work, where we wish to provide useful estimates of case trajectories for epidemiologists and decision makers in the government, we ideally wish to measure the growth
rate of active case numbers

1. Compute the congruence classes
for day t∗
[t∗ ] ← {z ≤ t∗ |t∗ ≡ z (mod 2)}

At := Yt − Dt − Rt , t ≥ 0 days ,

[t∗ − 1] ← {z ≤ t∗ |t∗ − 1 ≡ z (mod 2)}

(8)

where Y is the cumulative number of cases
so far, D is the cumulative number of deaths,
and R is the cumulative number of recovered
cases. This intuitively captures the number
X ← {xt }t∈[0,1,...,t∗ ]
of still ”infectious” cases, as we can assume
for COVID-19 that those who have recovwhere
(
ered or died are no longer capable of infectF eature[t, c]
if t ∈ [t∗ ]
ing others. Unfortunately, as the number of
xt =
F eature[t + 1, c] if t ∈ [t∗ − 1] recovered cases Rt are no longer reported,
(5) we are unable to directly calculate the number of active cases. While other works (c.f.
3. Assign the outcome variable
The University of Melbourne (2020)) approxfor day t∗
imate the number of recovered cases with
(
Y ← {yt }t∈[0,1,...,t∗ ]
Yt−22 − Dt−22 , if t ≥ 22
Rt ≈
(9)
Yt − D t
, if 0 ≤ t < 22.
where
(
Y [t, c, 1] if t ∈ [t∗ ]
yt =
(6) Here the underlying assumption is that those
Y [t, c, 0] if t ∈ [t∗ − 1]
who were infected but not dead after 22 days
have recovered. However, upon testing this
assumption at the county-level, we find that
4. Assign the treatment variable
∗
this assumption does not hold as there will
for day t
be some days where this newly approximated
W ← {wt }t∈[0,1,...,t∗ ]
active case number becomes negative.
We hence rely upon a commonly used
where
proxy: the incident case count, It , defined
(
as
1 if t ∈ [t∗ ]
wt =
(7)
(
0 if t ∈ [t∗ − 1]
Yt − Yt−22 , if t ≥ 22
It :=
(10)
Yt
, if 0 ≤ t < 22,
5. Feed (X,Y,W) into the GRF algorithm
2. Assign the feature variable
for day t∗

which is the number of new cases within a
22 day time period and is a useful proxy for
infectious cases.

{rt∗ ,c (Xt∗ ,c )}c∈C ← GRF (X, Y, W )

7

Estimating County-Level COVID-19 Exponential Growth Rates

Appendix C. Feature Data

numbers of PCR, Antibody and Antigen
tests performed and their positivity rates at
All feature data we used, i.e. {Xt,c }t∈T,c∈C ,
each state. These are used as features in our
are publicly available online. In this section,
framework as well.
we briefly describe what these datasets are
and how we incorporated them in our work.

Appendix D. Additional Results
for Performance
Evaluation
The 2019 United States Census Gazetteer
C.1. 2019 US Census Gazetteer Files

Files (c.f.
United States Census Bu- D.1. MAPE Plots
reau (2019)) were used to obtain the geographic locations (latitude-longitude centroids) of each county officially registered by
the United States Census Bureau. This provides a spatial feature space for the GRF to
further split upon.
C.2. Centers for Disease Control and
Prevention Social Vulnerability
Index 2018 Database
The Social Vulnerability Index (SVI)
database (c.f. Centers for Disease Control
and Prevention (2018)) is a compilation
of socio-economic factors such as unemployment rate, poverty rate, education Figure 2: MAPE Plot (3-day Moving Average)
attainment level etc. at the county level.
These features are also included in our
methodology.
C.3. COVID-19 US state policy
database (CUSP)
The CUSP database (c.f. Raifman et al.
(2020)) tracks when each state implemented
and ended policies such as mask mandates,
lockdowns, economic policies in response to
the COVID-19 pandemic. As such, it is
a vector of features capturing daily policy
changes in each state. As these policies is
state-wide, we naturally extend them to the
respective county level.
Figure 3: MAPE Plot (4-day Moving Average)

C.4. The COVID Tracking Project
From the COVID Tracking Project (c.f. The
Atlantic (2018)), we obtained the he daily
8

Estimating County-Level COVID-19 Exponential Growth Rates

Figure 4: MAPE Plot (5-day Moving Aver- Figure 6: MAPE Plot (7-day Moving Average)
age)

D.2. Median RMSEs and MAPEs

Table 2: Median RMSE and MAPE (3-day
Moving Average)

Figure 5: MAPE Plot (6-day Moving Average)

9

Method

RMSE

MAPE

OLS.wsize=16
OLS.wsize=8
OLS.wsize=4
OLS.wsize=2
GRF

0.3579
0.3403
0.3391
0.3447
0.2913

0.0584
0.0532
0.0510
0.0511
0.0468

Estimating County-Level COVID-19 Exponential Growth Rates

Table 3: Median RMSE and MAPE (4-day Table 6: Median RMSE and MAPE (7-day
Moving Average)
Moving Average)

Method

RMSE

MAPE

Method

RMSE

MAPE

OLS.wsize=16
OLS.wsize=8
OLS.wsize=4
OLS.wsize=2
GRF

0.3574
0.3374
0.3120
0.3011
0.2600

0.0585
0.0529
0.0483
0.0455
0.0423

OLS.wsize=16
OLS.wsize=8
OLS.wsize=4
OLS.wsize=2
GRF

0.3342
0.2956
0.2480
0.2231
0.2083

0.0559
0.0467
0.0392
0.0346
0.0336

Table 4: Median RMSE and MAPE (5-day D.3. RMSE Plots
Moving Average)

Method

RMSE

MAPE

OLS.wsize=16
OLS.wsize=8
OLS.wsize=4
OLS.wsize=2
GRF

0.3499
0.3256
0.2867
0.2689
0.2429

0.0576
0.0509
0.0450
0.0410
0.0395

Table 5: Median RMSE and MAPE (6-day
Moving Average)
Figure 7: RMSE Plot (3-day Moving Average)
Method

RMSE

MAPE

OLS.wsize=16
OLS.wsize=8
OLS.wsize=4
OLS.wsize=2
GRF

0.3426
0.3120
0.2672
0.2460
0.2241

0.0570
0.0490
0.0420
0.0378
0.0361

10

Estimating County-Level COVID-19 Exponential Growth Rates

Figure 8: RMSE Plot (4-day Moving Aver- Figure 10: RMSE Plot (6-day Moving Average)
age)

Figure 9: RMSE Plot (5-day Moving Aver- Figure 11: RMSE Plot (7-day Moving Average)
age)

11

