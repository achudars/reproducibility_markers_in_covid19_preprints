Estimating intervention effects on infectious disease
control: the effect of community mobility reduction on

arXiv:2103.04417v2 [stat.ME] 9 Mar 2021

Coronavirus spread
Andrew Giffin1 , Wenlong Gong1 , Suman Majumder2 , Ana G. Rappold3 ,
Brian J. Reich1 and Shu Yang1
March 10, 2021

Abstract
Understanding the effects of interventions, such as restrictions on community and
large group gatherings, is critical to controlling the spread of COVID-19. SusceptibleInfectious-Recovered (SIR) models are traditionally used to forecast the infection rates
but do not provide insights into the causal effects of interventions. We propose a spatiotemporal model that estimates the causal effect of changes in community mobility
(intervention) on infection rates. Using an approximation to the SIR model and incorporating spatiotemporal dependence, the proposed model estimates a direct and indirect (spillover) effect of intervention. Under an interference and treatment ignorability
assumption, this model is able to estimate causal intervention effects, and additionally
allows for spatial interference between locations. Reductions in community mobility
were measured by cell phone movement data. The results suggest that the reductions
in mobility decrease Coronavirus cases 4 to 7 weeks after the intervention.
Key words: Spatiotemporal modeling; COVID-19; SIR model; Causal inference.

1

Introduction

Since the Coronavirus exploded into a global pandemic, much research has been done to understand its epidemiological characteristics (e.g., Li et al., 2020; Livingston and Bucher, 2020)
1

North Carolina State University
Harvard T.H. Chan School of Public Health
3
Environmental Protection Agency
2

1

and quantify the effectiveness of various interventions to mitigate disease spread (e.g. Dandekar and Barbastathis, 2020; Dehning et al., 2020; Cowling et al., 2020; Prem et al., 2020).
The traditional model for the progression of an infectious disease uses a set of differential
equations to decompose the population at risk into the number of susceptible (S), infected (I),
or recovered (R) individuals and provide time-dependent trajectories of these compartments.
Potential effects of interventions such as school closure, work from home, social distancing,
etc. can be incorporated in the SIR model for the transitions between compartments. For
example, Dandekar and Barbastathis (2020); Punn et al. (2020); Magdon-Ismail (2020); Lyu
et al. (2020); Kounchev et al. (2020) combine machine learning and/or deep learning with
SIR model to make predictions of the spreading trend; while others, like Dehning et al.
(2020); Mbuvha and Marwala (2020); Bradley (2020), adopt Bayesian approaches to provide
uncertainty quantification of the prediction.
The SIR model (Kermack and McKendrick, 1927) and the above variants do not account
for the spatial distribution of the number of susceptible, infected, or recovered people. A
number of attempts have been made to modify the SIR model to incorporate this spatial
distribution. Reluga (2004) and Burger et al. (2009) consider diffusion of the infected population by modeling the individual agents, while a number of works (e.g., Chinviriyasit and
Chinviriyasit, 2010; Hilker et al., 2007; Robinson et al., 2012; Wang et al., 2010) consider
Brownian motion-like movement for subgroups of people belonging to each compartment.
Several works (Berres and Ruiz-Baier, 2011; Milner and Zhao, 2008; Capasso and Di Liddo,
1994) use cross-diffusion, an assumption where the susceptible move away from an increasing
gradient of the infected to bring in a spatial distribution to the SIR model. Models that
assume that patches of population have different infection parameters and are connected by
travel or migration have also been proposed (Arino and Van den Driessche, 2003; Hyman
and LaForce, 2003; Sattenspiel et al., 1995; Sattenspiel and Herring, 2003; Lee et al., 2012;
Lee and Castillo-Chavez, 2015; Lee and Jung, 2015).
Our method is based on the spatial SIR model of Paeng and Lee (2017). Among the
several generalizations of the SIR model they propose is a model discrete in time and with
space partitioned into distinct areas (e.g., counties). The number of individuals in each
compartment and area evolves over time using the same mechanics as the standard SIR
model. A distance metric is defined between counties, allowing the number of infected in
county j to account for dependence across nearby areas.
Our statistical contribution is using the SIR model as a stepping stone towards a spatiotemporal statistical model that permits causal inference without including differentialequation solvers. The result is a model with a very different flavor than the standard SIR
model. In particular, while the goal of an SIR model is often to forecast the severity of a
disease over time, the model presented here is designed to tease out causal effects of inter2

ventions.
Integrating causal inference into this spatial framework presents some challenges. Existing SIR models are generally used for prediction and forecasting, but not for ascertaining
causal effects of interventions. Causal methods generally require adjusting for confounders
that are related to both intervention and response, which allows for identification of the
causal intervention effect as opposed to the observed association between intervention and
response. However, if interventions at one location affect the response at other locations – a
phenomenon known as interference – then the standard causal framework which adjusts only
for local confounding is rendered ineffective. With a virus that spreads across space, clearly
some degree of interference is involved, and a causal analysis must take this into account.
This is typically done by placing assumptions on the form of interference. Commonly used
assumptions on interference (for a recent review, see Reich et al., 2020) include “partial interference” in which the population is divided into isolated clusters (Halloran and Struchiner,
1991; Sobel, 2006), as well as “network interference” in which interference is allowed along
a pre-specified network, and “spatial interference” in which interference is tempered by the
distance between locations (Giffin et al., 2020). This paper uses a parsimonious assumption
on interference, which allows for interference from neighboring counties only. This can be
thought of as a simple version of both the spatial and network interference assumptions. Intervention effects are then divided between direct (within county) interventions and indirect
(between county) interventions.
The framework that we propose approximates the standard SIR model, in a way that
allows for estimation of the causal effects of interventions. In particular, we use the fact
that infection rates are likely smooth across space, to obtain an approximation to the rate
of infection at across space and time. This approximation is a function of the intervention
variables, covariates, and a spatiotemporal model, and allows us to fit the observed data and
obtain intervention effect estimates.
The remainder of the paper proceeds as follows. The motivating data are described
in Section 2. Section 3 introduces the statistical method and corresponding theoretical
properties. The method is evaluated using a simulation study in Section 4 where we show
that the approximate model can recover causal effects of data generated from the SIR model.
Section 5 applies the proposed model to estimate the effect of decreases in mobility on
Coronavirus cases, finding that decreases in mobility cause a decrease in local Coronavirus
cases 4-7 week later. Section 6 concludes.

3

2

Data description

We estimate the effect of mobility on the number of observed Coronavirus cases. There
are three primary types of data for analysis: intervention (mobility reduction), response
(Coronavirus cases) and covariates. All variables are defined temporally by the week (t) and
spatially by the county (j). Data from March 6, 2020 through October 8, 2020 for 3,137
counties or county equivalents are used in this study.
The response data Yj (t) are new, recorded cases of Coronavirus in a given county/week.
These data are taken from the publicly available Johns Hopkins University Coronavirus
Resource Center (Dong et al., 2020), which aggregates Coronavirus case counts and provides
a daily, cumulative count of cases in each county.
The intervention data are publicly available measures of mobility – as measured by Google
devices and provided by Google LLC (2020) – which have been shown to have strong associations with Coronavirus case data (Chang et al., 2021; Yilmazkuday, 2020). We use an
aggregate mobility measure that includes the categories: “retail and recreation”, “grocery
and pharmacy”, “transit station”, “workplace”, and “residential” mobility. These measure
both the number of visits to such locations as well as the length of stay in comparison to
baseline. These data are given as percentage change from a baseline level which was taken
over January 3, 2020-February 6, 2020. Intuitively, in the months since the pandemic began,
“retail and recreation”, “grocery and pharmacy”, “transit station” and “workplace” mobility have decreased substantially from the baseline and “residential” mobility (i.e., amount of
time spent at home) has increased. The specific metric that we will use as intervention Aj (t)
for a given county/week is the mean of percentage change from baseline of “retail and recreation”, “grocery and pharmacy”, “transit station”, “workplace”, and negative “residential”
mobility.
Because of privacy concerns, county/days with too few users are not provided by Google.
When a subset of the categories are provided for a given county/day, the mean of the available
categories is taken. When none of the categories are provided for a given count/day, we
impute the missing value from any available first and second degree neighbors (with values
weighted by 1/distance, where weights are summed to one).
In addition to intervention and response we include a number of important covariates.
From the 2016 American Community Survey we have poverty rate, population density, median household income, and total population, and from the U.S. Census we have median age
and the number of foreign born residents (U.S. Census Bureau, 2016). The Bureau of Labor
Statistics provides the number of people employed in healthcare and social services, classified as North American Industry Classification System, Sector 62) (U.S. Bureau of Labor
Statistics, 2019). The Environmental Systems Research Institute (ESRI) provides publicly

4

available data on the number of hospital beds and the number of ICU beds (ESRI, 2020).
Lastly, because Wu et al. (2020) shows that PM2.5 (particulate matter smaller than 2.5
micrometers) may interact significantly with COVID-19, we include county level PM2.5 estimates from 2016 (Alexeeff et al., 2015; Chudnovsky et al., 2012). We also include non-static
county-level daily meteorological data, as this could inform levels of mobility and spread of
disease. We use daily mean, maximum and minimum temperature (degrees Celsius), relative
humidity and mean dew point (degrees Celsius) from NOAA’s Global Surface Summary of
the Day using the “GSODR” R package (Sparks et al., 2017). Then we obtain county-level
data by predicting at the mean county latitude and longitude coordinates from the 2010
Census using thin plate spline regression from the “fields” R package (Nychka et al., 2014).

3
3.1

Main methodology
Notation

Let Yj (t) be the number of new cases of Coronavirus reported during week t ∈ {1, ..., T }
and county j ∈ {1, ..., J}, where T = 31 and J = 3,137. For county j, denote Nj as
the population size and Xj (t) as a vector of covariates for week t. The direct intervention
variable, Aj (t), is the mobility percentage change from baseline for county j and week t. In
addition to the direct intervention, we allow for an indirect (spillover) intervention Ãj (t).
This variable captures the interventions received by neighboring counties. Including this
terms allows for interference between neighbors, since the response at county j can now
be impacted by the interventions in surrounding counties. The spatial configuration of the
counties is summarized by their adjacency, with cjj = 0, cjk = 1 if counties j and k are
adjacent and cjk = 0 otherwise. Ãj (t) is defined as the mean direct intervention over the
PJ
PJ
mj =
k=1 cjk Aj (t)/mj . Similarly, the mean of the
k=1 cjk adjacent regions: Ãj (t) =
PJ
adjacent covariate values is X̃j (t) = k=1 cjk Xj (t)/mj .

3.2

Conceptual SIR model

To motivate the proposed statistical framework, we begin by describing the discrete-time,
spatial SIR model proposed in Paeng and Lee (2017). Let Sj (t), Ij (t) and Rj (t) be the
number of susceptible, infected and recovered individuals in county j at time t. These three
states evolve over time but always satisfy the constraint that Nj = Sj (t) + Ij (t) + Rj (t).
For each county j the state evolution is similar to the classical SIR model (Kermack and

5

McKendrick, 1927):
Sj (t + 1) − Sj (t) = −λj (t),
Ij (t + 1) − Ij (t) = λj (t) − γIj (t),

(1)

Rj (t + 1) − Rj (t) = γIj (t),
n
o
S (t) PJ
where γj > 0 is the recovery rate and λj (t) = β Nj j
W
I
(t)
is the rate new
jk
k
k=1
infections in county j and week t. Here Wjk is proportional to the contact rate between
individuals in region j with individuals in region k.
We expand on this by allowing the infection rate βj (t) > 0 to vary with region and time:
Sj (t)
λj (t) = βj (t)
Nj

( J
X

)
Wjk Ik (t) .

(2)

k=1

This allows us to model spatiotemporal variation in βj (t) as a function of the covariates
Xj (t) and direct and indirect intervention variables Aj (t) and Ãj (t). In the absence of other
information on connectivity, we simply set Wjj = (1 − φ) and Wjk = φ · cjk /mj for φ ∈ [0, 1]
so that large φ leads to strong spatial dependence and vice versa.
A major difficulty in using model (1) is that we do not observe the latent states Sj (t),
Ij (t) or Rj (t). We learn about these latent processes via the reported number of new cases
Yj (t). Further complicating the statistical model is that there may be under-reporting and
a lag time between an increase in the true and reported infection rate due to the latency
of the disease. Because of these issues, we link Yj (t) and λj (t) in the SIR model by the
over-dispersed Poisson distribution
indep

Yj (t)|λj (t), gj (t) ∼ Poisson [p exp{gj (t)}λj (t − l)] ,

(3)

iid

where p ∈ (0, 1) accounts for under-reporting, gj (t) ∼ Normal(0, τ 2 ) captures over-dispersion,
and l ∈ {0, 1, 2, ...} is the reporting lag.

3.3

Gaussian approximation

The SIR model in Section 3.2 is an elegant way to model and forecast the spread of a
disease through a population. However, the solution to the difference equations is complex,
which hinders the ability to estimate model parameters in a statistical manner. Previously
methods have been proposed to mimic the mechanistic model to provide realistic forecasts,
e.g., Buckingham-Jeffery et al. (2018). Here, we propose an approximation to the SIR model
to allow for estimation of intervention effects on local infection rates.
6

The key insight is that the rate of new infections in (2) can be re-expressed as
λj (t) = βj (t) exp{θj (t)} + vj (t),
exp{θj (t)} = Sj (t)Ij (t)/Nj ,
J
Sj (t) X cjk
vj (t) = βj (t)φ
{Ik (t) − Ij (t)}.
Nj k=1 mj

(4)
(5)
(6)

Both θj (t) and vj (t) in (4) are latent spatial and temporal processes due to the unobserved
Sj (t) and Ij (t), which we approximate by spatiotemporal models.
We model θj (t) as a separable spatiotemporal continuous autoregressive model (Stein,
2005). Denote θ(t) = {θ1 (t), ..., θJ (t)} and θ = {θ(1)> , ..., θ(T )> }> . Then the spatiotemporal conditional autoregressive model (STCAR) for θ is multivariate normal with mean zero
and covariance σ 2 Σ(ρt ) ⊗ Ω(ρs ). Spatial dependence is governed by Σ(ρs ) = (M − ρs C)−1 ,
where M is diagonal with diagonal elements mj and the (j, k) element of C is 1 if sites j and
k are adjacent and zero otherwise. If θ(t) ∼ Normal{0, σ 2 Σ(ρs )}, then θj (t)|θk (t) for all k 6=
P
j ∼ Normal(ρs k∼j θk (t)/mj , σ 2 /mj ), so that ρs determines the strength of spatial dependence and σ is the scale parameter. We denote this model as θ(t) ∼ CAR(σ, ρs ). Similarly,
temporal dependence is governed by Ω(ρt ), which has the same form as Σ(ρs ) except for
temporal adjacency structure with time t having t − 1 and t + 1 considered neighbors. We
refer to this as the STCAR(σ, ρs , ρt ) model.
The second term in (4), vt (t), sums over the mj regions adjacent to region j, and is a
function of the local differences, Ik (t) − Ij (t). Assuming the number of infected individuals
varies smoothly across space, these local differences should be small. Therefore, one approximation we consider is simply setting vj (t) = 0 for all j and t. For cases where these terms
cannot be removed, we note that because they are functions of local differences they should
be less spatially correlated than the spatial process itself, and thus a second approximation
iid
is log{vj (t)} ∼ Normal(µv , σv2 ).
A crucial point is that neither our model for θt (s) nor vt (s) attempt to retain the mechanistic properties of Ij (t) and Sj (t). Therefore, this model would not provide reliable forecasts
about future disease spread. However, forecasting is not our objective. Our aim to is provide
a computationally feasible method to use observed data to estimate effects of intervention
variables on local infection rates. The following section verifies that the approximation indeed has a causal interpretation under standard assumptions from causal inference, and
proposes an estimation procedure for these effects.
For the final component, modeling the spatiotemporal infection rate βj (t), we regress

7

log{βj (t)} on covariates Xj (t) and X̃j (t) as well as mobility variables Aj (t) and Ãj (t) as
ηj (t) = log{βj (t)} = α0 + Xj (t)> α1 + X̃j (t)> α2 + Aj (t)δ1 + Ãj (t)δ2
where δ1 and δ2 quantify the direct and indirect (spillover) causal effects of mobility on
infection rate. The covariate vectors Xj (t) and X̃j (t) can include both the original covariates
or covariates derived as propensity scores (Section 3.4).
Since it is impossible to identify the reporting rate p in (3) and intercept terms α0 and
µv we fit the final model
Yj (t)|gj (t), θ, vj (t)
ηj (t)
gj (t)
θ
ṽj (t)

indep

∼

Poisson [exp{gj (t) + ηj (t − l) + θj (t − l)} + exp{ṽj (t)}]

(7)

=

α0 + Xj (t)> α1 + X̃j (t)> α2 + Aj (t)δ1 + Ãj (t)δ2

(8)

iid

∼

Normal(0, τ 2 )

∼

STCAR(σ 2 , ρs , ρt )

iid

Normal(µv , σṽ2 ).

∼

The final term in (7) combines the overdispersion term gj (t) and the nugget term vj (t). When
the dimensions of the covariates are large, we propose dimension reduction for log{βj (t)}
using the generalized propensity score (Imbens, 2000) in Section 3.4. To complete the
Bayesian model, we specify noninformative independent Normal(0, 102 ) priors for α0 , δ1 ,
δ2 , µv and the elements of α1 and α2 , and noninformative priors for covariance parameters
σ 2 , τ 2 , σṽ2 ∼ InvGamma(0.1, 0.1) and ρs , ρt ∼ Uniform(0, 1).

3.4

The potential outcomes framework

In this section, we provide a causal interpretation of δ1 and δ2 under the potential outcomes
framework (Rubin, 1974). To ease discussion, let Yj (t) be the total number of cases, rather
than reported number (i.e., p = 1). We use the potential outcomes framework to define
the causal effect of mobility on infection rate. We use overbar to denote all history. Let
āj (t) = (aj (1), . . . , aj (t))> be the trajectory of mobility level at region j through time t. Let
ā(t) = (ā1 (t), . . . , āJ (t)) be the trajectory of mobility level for all regions through time t.
ā(t)
Define Yj (t) to be the (possibly counterfactual) number of new cases in region j at time
t had all the regions controlled the mobility level at ā(t) through time t.
Assume the potential outcome model for the SIR model with θj (t) = log{Sj (t)Ij (t)/Nj }

8

and vj (t) = βj (t)

Sj (t)
Nj

cjk
k=1 mj {Ik (t)

PJ

ā(t)

Yj

ā(t)

∼ Poisson{λj },

ā(t)

ā(t)

λj (t) = βj
ā(t)

log{βj

− Ij (t)} as in (5) and (6), and

(t) exp{θj (t)} + vj (t),

(9)

(t)} = aj (t)δ1 + ãj (t)δ2 + h{X̄(t), S̄(t − 1), Ī(t − 1)}.

Consider two regimes ā(t) and ā0 (t), where all components are the same except for aj (t) =
a0j (t) + 1, and vj (t) = 0. Then under model (9),
ā(t)

E{Yj

(t) | X̄(t), S̄(t − 1), Ī(t − 1)}

ā0 (t)
E{Yj (t)

| X̄(t), S̄(t − 1), Ī(t − 1)}

= exp(δ1 ),

where X̄(t) is the full history of covariates and intervention through time t, and S̄(t − 1)
and Ī(t − 1) are the full history of susceptible and infected, excluding time t. (Because
Sj (t − 1) + Ij (t − 1) + Rj (t − 1) = Nj , observing S̄(t − 1) and Ī(t − 1) implies R̄(t − 1).)
Then exp(δ1 ) entails the risk ratio of new cases by increasing mobility level by 1 unit locally
ā(t)
(direct effect). If vj (t) is nonzero but small in comparison to βj (t) exp{θj (t)}, this should
hold as a good approximation.
Similarly, if we consider two regimes ā(t) and ã0 (t) where all components are the same
except for āj (t) = ā0j (t) + 1, and vj (t) = 0, then
ā(t)

E{Yj

(t) | X̄(t), S̄(t − 1), Ī(t − 1)}

ā0 (t)

E{Yj

(t) | X̄(t), S̄(t − 1), Ī(t − 1)}

= exp(δ2 )

encodes the risk ratio of new cases by increasing mobility level by 1 unit non-locally (indirect
effect).
For the effect from neighbor k, consider two regimes ā(t) and ā0 (t), where all components
are the same, except for ak (t) and a0k (t) + 1, and vj (t) = 0. Then
ā(t)

E{Yj

(t) | X̄(t), S̄(t − 1), Ī(t − 1)}

ā0 (t)

E{Yj

(t) | X̄(t), S̄(t − 1), Ī(t − 1)}

= exp(δ2 cjk /mj ),

which encodes the indirect effect of area k on area j.
To link the potential variables and the observed variables and identify the direct and
indirect effects, we invoke the following assumptions.
Assumption 1 (Interference) Given the past information through t, the intervention A(t)
affects the potential infection rate at time t and region j only through Aj (t) and Ãj (t).
9

Ā(t)

Assumption 2 (Causal Consistency) Yj (t) = Yj

(t), ∀t, j.

Assumption 3 (Ignorability of intervention process variables)
Aj (t), Ãj (t) ⊥
⊥ Yjā(t) (t) | {X̄(t), S̄(t − 1), Ī(t − 1)}, ∀t, j.
To facilitate recovery of causal estimates, we define a generalized propensity score for the
direct/indirect effects
ējt {κ1 , κ2 ; X̄(t), S̄(t − 1), Ī(t − 1)} = f {Aj (t) = κ1 , Ãj (t) = κ2 , | X̄(t), S̄(t − 1), Ī(t − 1)}.
In practice, we often assume that the direct and indirect interventions are independent, and
can write this score as the two separate components
ejt {κ; X̄(t), S̄(t − 1), Ī(t − 1)} = f {Aj (t) = κ | X̄(t), S̄(t − 1), Ī(t − 1)},
ẽjt {κ; X̄(t), S̄(t − 1), Ī(t − 1)} = f˜{Ãj (t) = κ | X̄(t), S̄(t − 1), Ī(t − 1)},
denoted by ejt {κ; X̄(t), S̄(t − 1), Ī(t − 1)} and ẽjt {κ; X̄(t), S̄(t − 1), Ī(t − 1)}, respectively.
Lastly we require a positivity assumption that ensures all regions can take any plausible
mobility level. This is formulated based on the propensity score:
Assumption 4 (Positivity) For all X̄(t), S̄(t−1), Ī(t−1) with f {X̄(t), S̄(t−1), Ī(t−1)} >
0, ējt {κ1 , κ2 ; X̄(t), S̄(t − 1), Ī(t − 1)} > 0, ∀t, κ1 , κ2 where f (·) denotes the generic probability
function; i.e., it is a probability density function for a continuous variable and a probability
mass function for a discrete variable.
Under Assumptions 2 and 3, the induced model from (9) for Yj (t) is Yj (t) ∼
Poisson{λj (t)}. One can fit the induced model with the observed data to estimate the causal
parameters. Because X̄, Ī, and S̄ are high-dimensional, fitting the above model directly
may become a daunting task. We consider the generalized propensity score approach for
dimension reduction. Under Assumption 3, and following Rosenbaum and Rubin (1983) or
Imbens’ generalized propensity score approach, we can show that

⊥ {X̄(t), S̄(t − 1), Ī(t − 1)} | ējt {κ1 , κ2 ; X̄(t), S̄(t − 1), Ī(t − 1)}, ∀κ1 , κ2 .
Aj (t), Ãj (t) ⊥
(Balancing)
In practice, following Giffin et al. (2020) we model the two generalized propensity scores
using linear regressions of Aj (t) and Ãj (t) onto covariates and past interventions and responses. Then, their distributions for a given j and t (i.e., their generalized propensity
scores values) can be completely summarized with a single sufficient statistic: the estimated
conditional mean (i.e., the fitted value from the regression). For this reason, henceforth ej (t)
10

and ẽj (t) (without the index for κ) will refer to these sufficient conditional means, for which
the result (Balancing) applies. This shows that the generalized propensity score serves as a
balancing score; i.e., at the same level of the propensity score, the distribution of the history
of confounding variables are the same across different intervention levels.
Allowing X and X̃ to include propensity score components, the induced model for Yj (t)
given the intervention and generalized propensity score is
E{Yj (t) |Ā(t), ē(t), Ȳ(t − 1)} = exp{Aj (t)δ1 + Ãj (t)δ2 + α1 + Xj (t)> α2 + X̃j (t)> α3 }
· exp{θj (t)} + vj (t).
The derivation is provided in the Appendix. Therefore, we can fit the model Yj (t) ∼
Poisson{λej (t)}, where
λej (t) = βje (t) exp{θj (t)} + vj (t),

(10)

βje (t) = exp{Aj (t)δ1 + Ãj (t)δ2 + α1 + Xj (t)> α2 + X̃j (t)> α3 },
To model the propensity of At given the past history, we require some structural assumption to reduce the dimension of the historical variables. We posit a model for Aj (t) adjusting
for its direct causes Aj (t − 1), Aj (t − 2), Xj (t), Xj (t − 1) and Yj (t − 1) to get ej (t). Ãj (t)
can be modeled similarly with the neighbor-averaged variables Ãj (t − 2), X̃j (t), X̃j (t − 1)
and Ỹj (t − 1). In practice, simply taking the average over neighbors of ej (t) gives similar
estimates for ẽj (t).

4

Simulation study

In this section we conduct a simulation study to evaluate the statistical properties of the
causal effects that stem from the approximate SIR models. Data are generated from the full
SIR model in Section 3.2 and analyzed using the approximated spatial model in Section 3.3.
The objectives are to determine when the approximations give unbiased point estimation
and valid interval estimation, and to compare different approximations using these criteria.

4.1

Methods

We generate data on a 15 × 15 square grid of J = 225 regions for T = 30 time steps.
Rook neighbors are considered adjacent. Each region has population Nj = 100, 000 and
initial states are generated as Ij (1) = 100 exp{Uj }, Rj (1) = 0 and Sj (1) = Nj − Ij (1),
where (U1 , ..., UJ ) ∼ CAR(1, ρs ). A confounding variable Xj (t) is generated from the

11

STCAR(1, ρs , ρt ) distribution and the intervention variable is generated as Aj (t) = ρx Xj (t)+
p
1 − ρ2x Ej (t) where Ej (t) is also generated from the STCAR(1, ρs , ρt ) distribution. The latent states for times t ∈ {2, ..., T } are generated from the full mechanistic model given by
(1) and (2) with recovery rate γ = 0.1 and infection rate
log{βj (t)} = α0 + Xj (t)α1 + X̃j (t)α2 + Aj (t)δ1 + Ãj (t)δ2
for α0 = −3, α1 = 0.5, α2 = 0.3, δ1 = 0.5 and δ2 = 0.2. The data are then generated as
Yj (t) ∼ Poisson{pλj (t − l)} where the reporting rate is p = 0.5 and the lag is l = 2.
We compare six simulation scenarios defined by the spatial (ρs ) and temporal (ρt ) dependence of the intervention variable Aj (t), the strength of confounding (ρx ) and the strength
of spatial dependence (φ) in the SIR model:
1. Base model: ρs = 0.9, ρt = 0.5, ρx = 0.5 and φ = 0.4
2. Strong spatial dependence in Aj (t): ρs = 0.99, ρt = 0.5, ρx = 0.5 and φ = 0.4
3. Strong temporal dependence in Aj (t): ρs = 0.3, ρt = 0.9, ρx = 0.5 and φ = 0.4
4. Strong spatiotemporal dependence Aj (t): ρs = 0.9, ρt = 0.9, ρx = 0.5 and φ = 0.4
5. Strong confounding: ρs = 0.9, ρt = 0.5, ρx = 0.9 and φ = 0.4
6. Weak SIR spatial dependence: ρs = 0.9, ρt = 0.5, ρx = 0.5 and φ = 0.2
For each scenario we generate 100 datasets.
The propensity score ej (t) is the fitted value from a least squares regression of Aj (t)
onto Aj (t − 1), Aj (t − 2), Xj (t), Xj (t − 1) and Yj (t − 1). We then model log{βj (t)} as a
linear combination of Aj (t), Ãj (t), Xj (t), X̃j (t), ej (t), ẽj (t), ej (t)2 , ẽj (t)2 and ej (t)ẽj (t).
For each simulated dataset we fit the full model in (7) with the propensity scores included
as covariates (“Full”), and compare this model to the full model but with vj (t) = 0 (“No
nugget”), the full model but without the propensity scores ej (t) = ẽj (t) = 0 (“No PS”) and
the full model but without spatial dependence ρs = 0 (“Non-spatial”). For the non-spatial
model we also set vj (t) = 0 because the MCMC algorithm did not converge with these terms
included. The models are fit using responses from time points t ∈ {5, ..., nt } to accommodate
lagged predictors. We fit the model using MCMC with 10,000 iterations and the first 2,000
samples are discarded as burn-in to approximate the posterior median and 95% interval of
the direct (δ1 ) and indirect (δ2 ) effects.

12

Table 1. Spatiotemporal model simulation study results. The six data-generating scenarios are given in Section 4.1. The two recommended models, the full model (“Full”) and the
model without a nugget term (“No nugget”), are given in bold; and are compared to the model
without the generalized propensity score (“No PS”) and the model without spatial dependence
(“Non-spatial”) in terms of bias and empirical coverage of 90% prediction intervals, separately for
the direct (δ1 ) and indirect (δ2 ) effects. Bias is multiplied by 100 and standard errors are given in
subscripts.

Scenario
1. Base Model

2. Strong spatial
dependence in Aj (t)

3. Strong temporal
dependence in Aj (t)

4. Strong spatiotemporal
dependence in Aj (t)

5. Strong confounding

6. Weak SIR spatial
dependence

4.2

Method
Full
No nugget
No PS
Non-spatial
Full
No nugget
No PS
Non-spatial
Full
No nugget
No PS
Non-spatial
Full
No nugget
No PS
Non-spatial
Full
No nugget
No PS
Non-spatial
Full
No nugget
No PS
Non-spatial

Direct effect
Bias
90% Cov.
0.250.25
903
0.120.24
942
2.180.25
744
0.520.25
962
0.790.24
923
0.600.23
913
2.870.23
655
1.590.26
991
1.160.47
952
1.060.47
942
12.710.45
21
1.780.53
972
2.150.53
864
2.180.53
883
13.590.51
42
4.440.62
942
0.970.46
923
0.770.46
942
2.990.50
784
1.330.49
952
0.280.25
923
0.220.25
933
2.530.26
744
0.640.27
972

Indirect effect
Bias
90% Cov.
0.360.45
933
0.360.46
942
2.190.53
794
-0.410.64
804
0.250.44
913
0.090.43
923
1.640.54
784
-1.020.71
734
0.620.96
933
0.730.94
933
14.281.01
204
-0.061.29
834
3.631.04
863
3.431.02
863
17.371.26
224
2.151.63
725
-0.861.01
913
-0.900.98
923
1.441.09
824
-0.311.37
784
0.670.48
962
0.550.48
962
1.910.56
824
-0.300.67
804

Results

The results are given in Table 1. Broadly speaking the Full model and the No Nugget model
perform well. Giving similar precision and coverage results under all scenarios, they generally outperform the other models in terms of coverage and bias. Moreover, their coverage
rates remain reasonably close to their 90% target, although they appear to have a small,
positive bias. The Non-spatial model performs worse than the Full and No Nugget models
in both precision and coverage, but it remains competitive. The No PS model performs the
worst, with extremely poor performance for the strong temporal/spatiotemporal dependence
scenarios. The four models seem to have the most difficulty estimating effects when there
is strong temporal/spatiotemporal dependence in Aj (t) or strong confounding. All models
13

appear to estimate the direct effects better than the indirect effects.

5

Estimating the causal effect of community mobility
reduction on Coronavirus spread

We implement similar models that were used in the simulation study on the real data: A
Full model, a No Nugget model, a No PS model, and a Non-spatial model. The models
are fit using responses from time points t ∈ {8, ..., 31} (April 24, 2020 through October
8, 2020) to accommodate lagged predictors. The direct propensity score is estimated with
least squares regressions of Aj (t) onto the previous intervention Aj (t−1), the local covariates
Xj (t) and Xj (t − 1), the number of weeks since the first case in county j (enters both linearly
and quadratically), time t (enters both linearly and quadratically), a time and intervention
interaction t · Aj (t − 1), the baseline level of mobility Aj (1), and log{Yj (t − 1)} − log(Nj ).
The propensity score ej (t) is set to the fitted values of the resulting model. The propensity
of the spillover intervention is estimated as the local average of its neighboring direct scores:
P
ẽj (t) =
k∼j ek (t)/mj . The direct and indirect propensity scores are added to X and
X̃, respectively, as in (8), along with l-lagged interventions and covariates. Each model is
implemented with lags of l = 0, . . . , 7. The No Nugget, No PS, and Non-spatial models were
run for 100,000 MCMC iterations, with a burn-in tuning period of 20,000 iterations. The
Full model required more iterations to converge, so these values were increased to 200,000
and 40,000, respectively.

5.1

Effect estimation

Table 2 gives the estimated posteriors for the direct and spillover effects for the four different
models across lags l = 0, . . . , 7, and Figure 1 shows these results graphically for the Full
model. Rather than present the estimated values for δ1 and δ2 , the estimates shown are
100 · {exp(50 · δi ) − 1}, i = 1, 2, and correspond to the expected percentage increase in cases
from an increase in mobility 50% above baseline. Because it is not clear that the observed
data can identify the correct lag, we provide model results for all lags, and speculate that
lags of 3-5 weeks are most appropriate to see effects of changes in mobility. The Centers
for Disease Control and Prevention guidelines suggest that COVID symptoms appear 2-14
days after virus exposure (Centers for Disease Control and Prevention, 2020). Given this,
3-5 weeks would allow the virus to spread through roughly several generations of people –
which would be enough to see changes in county-level case counts.
The key trend evident in these results is that the direct effect appears to be positive and
significantly different from zero for higher lags. The Full model gives positive significant
14

Table 2. Posterior estimates for direct and indirect treatment effects for lags 0-7
weeks for all models. Estimates correspond to the expected percentage increase in cases from
an increase in mobility 50% above baseline (100 · (exp(50 · δ) − 1)). 95% confidence intervals are
shown in parentheses, and estimates significant at the 95% level are denoted with ∗.

Model

Full

No Nugget

No PS

Non-spatial

Lag (weeks)
0
1
2
3
4
5
6
7
0
1
2
3
4
5
6
7
0
1
2
3
4
5
6
7
0
1
2
3
4
5
6
7

2.0
1.0
4.9
3.5
15.7
24.8
25.7
24.3
-0.8
-1.5
3.6
0.3
12.3
22.7
22.2
22.8
-2.7
2.1
6.6
11.9
15.6
15.3
12.4
10.8
-2.6
-5.9
-0.9
-4.3
9.8
25.1
19.3
24.2

Direct effect
(-9.0, 14.1)
(-9.5, 12.6)
(-5.8, 16.8)
(-7.8, 16.4)
(2.8, 29.9) *
(11.0, 40.2) *
(12.3, 40.7) *
(11.0, 39.1) *
(-11.6, 11.7)
(-11.8, 9.8)
(-7.2, 15.6)
(-10.4, 12.3)
(-0.3, 28.0)
(9.1, 37.8) *
(8.7, 37.2) *
(9.2, 37.7) *
(-8.0, 2.8)
(-3.1, 7.7)
(0.9, 12.9) *
(5.6, 18.7) *
(9.2, 22.3) *
(9.6, 21.6) *
(6.7, 18.4) *
(5.2, 16.7) *
(-17.0, 13.8)
(-19.8, 10.1)
(-14.9, 15.5)
(-17.7, 11.5)
(-6.1, 28.8)
(7.3, 45.5) *
(3.0, 38.0) *
(6.8, 44.5) *

Indirect effect
-12.9 (-35.1, 17.0)
-28.0 (-45.7, -4.6)*
-9.4 (-31.8, 22.1)
-9.6 (-32.5, 20.0)
-7.6 (-33.1, 28.3)
0.3
(-25.3, 34.6)
-9.9 (-33.2, 21.0)
24.2
(-7.5, 66.5)
-21.7 (-41.1, 4.1)
-28.5 (-46.4, -4.6)*
-15.4 (-35.7, 12.1)
-19.3 (-38.5, 6.2)
-13.7 (-35.5, 15.4)
3.1
(-22.8, 37.7)
-18.0 (-38.8, 11.4)
2.3
(-22.9, 35.7)
2.9
(-9.4, 17.1)
8.7
(-5.0, 24.1)
20.1
(5.1, 39.2)*
32.5 (12.3, 57.3)*
32.7 (15.1, 59.5)*
27.6 (10.4, 48.4)*
20.3
(5.6, 37.4)*
21.0
(6.3, 37.2)*
7.7
(-12.5, 32.0)
-46.4 (-57.1, -34.5)*
-25.7 (-39.3, -9.4)*
-37.2 (-48.3, -23.5)*
-21.6 (-35.2, -4.2)*
35.8 (13.3, 62.4)*
-10.5 (-24.3, 6.2)
6.1
(-11.1, 26.5)

estimates on δ1 for lags 4-7 weeks; the No Nugget for lags 5-7 weeks; the No PS model
for lags 2-7 weeks; and the Non-spatial model for lags 5-7. The size of this effect differs
between models/lags, but the Full model for lags 5-7 predicts that a mobility level 50 percent
15

above baseline will increase Coronavirus cases by between 11 and 41 percent. This trend
is demonstrated in the grouping of posteriors above zero in the top sub-figure of Figure 1.
This provides evidence that a decrease in local mobility should decrease local Coronavirus
cases roughly 4-7 weeks after the change in mobility.
The indirect effect estimates are more variable with wider credible intervals, as illustrated
in Figure 1. For the Full model, a lag of 7 gives a positive but non-significant estimate for
the indirect effect, although the indirect effect posteriors for other lags seem centered at zero,
with the exception of lag 1 which is significant and negative. For lag 1 the No Nugget model
also shows this counter-intuitive result. The No PS model shows a number of positive and
significant indirect effects, and the Non-spatial model paradoxically shows several significant
indirect effects – some positive and some negative. It is not entirely clear why there is
more variability in the indirect effects or why we see these counter-intuitive results. Some
of these could simply be spurious significance resulting from estimating many lags. Another
possibility is that our measure of connectivity does not precisely measure the levels of contact
between different counties. This could explain the wide intervals, as the connectivity is overestimated between some counties and under-estimated between others. In any event, the
indirect effect story appears less clear cut than that of the direct effect.
Table 3 gives parameter estimates from the No Nugget/Lag 5 model. In addition to
the intervention effects and accounting for the propensity scores, the covariate coefficients
tell an interesting story about their association with Coronavirus case counts. For example,
expected Coronavirus case counts are decreasing in median age of population, population
density, county population, and relative humidity. Alternatively, Coronavirus case counts
tend to increase with the poverty rate, PM2.5 , number of hospital beds, number of ICU beds,
and percentage healthcare-employed residents.

6

Discussion

This analysis uses a spatiotemporal model to provide insights into how mobility affects the
spread of Coronavirus. The analysis uses a propensity score framework to obtain causal
estimates of this effect, while allowing for potential interference between nearby counties.
We show via simulation study that the causal estimates from our computationally-efficient
approximate model have good statistical properties for data generated from a mechanistic process. In particular, the data suggest that decreases in mobility appear to cause a
statistically significant decrease on the number of local Coronavirus cases after roughly 5
weeks. This is significant, as such a long lag might be overlooked in a naive analysis of the
relationship between mobility and Coronavirus.
There are several noteworthy limitations of this analysis. The intervention data are
16

Figure 1. Posterior distributions for direct indirect intervention effects for Full
model across lags 0-7 weeks. Estimates correspond to the expected percentage increase in
cases from an increase in mobility 50% above baseline: 100 · {exp(50 · δi ) − 1}, i = 1, 2. The direct
effect estimates for lags 3-5 are 3.5, 15.7, and 24.8, with the latter two significant at the α = 0.05
level. The indirect estimates for lags 3-5 are -9.6, -7.6, and 0.3, though none are significant.

17

Table 3. Posterior estimates for coefficients in No Nugget, lag 5 model. 95% confidence intervals are shown in parentheses, and estimates significant at the 95% level are denoted
with ∗. Coefficients are not transformed as in Table 2.

Variable
Intercept
Aj (t)
Ãj (t)
ej (t)
ẽj (t)
Mean temperature
Relative Humidity
Dewpoint
PM2.5
Poverty rate
Population density
Median household income (thousands)
Population (millions)
# hospital beds
# ICU beds
Median age
Proportion of foreign-born residents
Proportion of health-employed
ρs
ρt

Estimate (95% interval)
-7.43 (-7.68, -7.18) *
0.004 (0.002, 0.006) *
0.0003 (-0.0055, 0.006)
-0.0011 (0.0007, 0.0054) *
0.006 (0.001, 0.013) *
-0.008 (-0.016, 0.000) *
-0.009 (-0.011, -0.006) *
0.045 (0.033, 0.057) *
0.082 (0.066, 0.097) *
1.07 (0.88, 1.26) *
-0.035 (-0.043, -0.026) *
-0.002 (-0.003, -0.001) *
-0.048 (-0.066, -0.030) *
5.95 (3.64, 8.29) *
24.01 (6.99, 40.94) *
-0.021 (-0.023, -0.018) *
4.16 (3.97, 4.35) *
0.82 (0.59, 1.04) *
0.9949 (0.9945, 0.9950) *
0.452 (0.441, 0.463) *

somewhat crude measures of mobility. Taken from a small minority of smartphone users,
they provide a limited view into the distribution of mobility among residents for a given
county and week. Moreover, the five relevant measures of mobility provided by Google
(which we average over) may have different intervention effects. We also do not have data
on other interventions to reduce the spread of Coronavirus, such as wearing masks, statemandated closures of different types of businesses, social distancing, washing hands, etc.
These are all plausibly correlated with mobility, so it is possible that the intervention effect
of mobility incorporates the causal effect of these measures too.
The measure of connectivity that we use – that of adjacency between counties – is also
somewhat crude. For example, while the first viral hotspot in the United States is thought to
have been Seattle, it quickly travelled to New York by air. A more comprehensive measure
of connectivity and travel between regions may be helpful to incorporate to the model.
The response data also has limitations. Because the availability of Coronavirus tests in
the United States has varied over time and space, the number of new positive tests results
18

in a particular county/week might reflect both the prevalence of Coronavirus, but also the
availability of tests. One solution to this would be to use COVID-19-related hospitalizations
or deaths as a response. However, these are necessarily less common – providing fewer
response data – and they would add to the already substantial lag between the moment of
infection and positive test.
Finally, as we make the “no unmeasured confounders” assumption, it is possible that there
are key confounders that have not been included. Because of this, we include a number of
possible confounders, but more can always be done in this regard.
As the pandemic continues, many of these data issues are being addressed: surveys
are now being done to ascertain levels of mask-usage and other social distancing practices.
Publicly available data on the availability of Coronavirus tests by location are emerging.
Further, as the number of cases continues to grow, using hospitalizations or deaths as a
response becomes more feasible.

Acknowledgements
The authors thank Sukanya Bhattacharyya, Can Cui, Matt Miller, Parker Trostle, Laura
Wendelberger, Stephen Xu and Zun Yin (North Carolina State University), Yawen Guan
(University of Nebraska) and Pulong Ma (Duke University) for help compiling the data.
This work was partially supported by NIH grant R01ES031651-01.

References
Alexeeff, S. E., Schwartz, J., Kloog, I., Chudnovsky, A., Koutrakis, P., and Coull, B. A.
(2015). Consequences of kriging and land use regression for PM2.5 predictions in epidemiologic analyses: insights into spatial variability using high-resolution satellite data.
Journal of Exposure Science & Environmental Epidemiology, 25(2):138–144.
Arino, J. and Van den Driessche, P. (2003). A multi-city epidemic model. Mathematical
Population Studies, 10(3):175–193.
Berres, S. and Ruiz-Baier, R. (2011). A fully adaptive numerical approximation for a twodimensional epidemic model with nonlinear cross-diffusion. Nonlinear Analysis: Real
World Applications, 12(5):2888–2903.
Bradley, J. R. (2020). Joint spatio-temporal analysis of multiple response types using the
hierarchical generalized transformation model with application to coronavirus disease 2019
and social distancing. arXiv preprint (stat.ME:2002.09983).
19

Buckingham-Jeffery, E., Isham, V., and House, T. (2018). Gaussian process approximations
for fast inference from infectious disease data. Mathematical Biosciences, 301:111–120.
Burger, R., Chowell, G., Mulet, P., and Villada, L. (2009). Modelling the spatial-temporal
evolution of the 2009 A/H1N1 influenza pandemic in Chile. Mathematical Biosciences and
Engineering, 13:1–17.
Capasso, V. and Di Liddo, A. (1994). Asymptotic behaviour of reaction-diffusion systems in
population and epidemic models. Journal of Mathematical Biology, 32(5):453–463.
Centers for Disease Control and Prevention (2020). Symptoms of Coronavirus. https:
//www.cdc.gov/coronavirus/2019-ncov/symptoms-testing/symptoms.html.
Chang, S., Pierson, E., Koh, P. W., Gerardin, J., Redbird, B., Grusky, D., and Leskovec,
J. (2021). Mobility network models of covid-19 explain inequities and inform reopening.
Nature, (589):82–87.
Chinviriyasit, S. and Chinviriyasit, W. (2010). Numerical modelling of an SIR epidemic
model with diffusion. Applied Mathematics and Computation, 216(2):395–409.
Chudnovsky, A. A., Lee, H. J., Kostinski, A., Kotlov, T., and Koutrakis, P. (2012). Prediction
of daily fine particulate matter concentrations using aerosol optical depth retrievals from
the Geostationary Operational Environmental Satellite (GOES). Journal of the Air &
Waste Management Association, 62(9):1022–1031.
Cowling, B. J., Ali, S. T., Ng, T. W., Tsang, T. K., Li, J. C., Fong, M. W., Liao, Q., Kwan,
M. Y., Lee, S. L., Chiu, S. S., et al. (2020). Impact assessment of non-pharmaceutical
interventions against coronavirus disease 2019 and influenza in hong kong: an observational
study. The Lancet Public Health, 5(5):279–288.
Dandekar, R. and Barbastathis, G. (2020).
Quantifying the effect of quarantine control in Covid-19 infectious spread using machine learning.
medRxiv:
10.1101/2020.04.03.20052084.
Dehning, J., Zierenberg, J., Spitzner, F., Wibral, M., Pinheiro Neto, J., Wilczek, M., and
Priesemann, V. (2020). Inferring COVID-19 spreading rates and potential change points
for case number forecasts. medRxiv: 10.1101/2020.04.02.20050922.
Dong, E., Du, H., and Gardner, L. (2020). An interactive web-based dashboard to track
covid-19 in real time. The Lancet Infectious Diseases, 20(5):533–534.

20

ESRI (2020).
Definitive Healthcare:
USA Hospital Beds.
//coronavirus-resources.esri.com/datasets/definitivehc::
definitive-healthcare-usa-hospital-beds.

https:

Giffin, A., Reich, B., Yang, S., and Rappold, A. (2020). Generalized propensity score approach to causal inference with spatial interference. arXiv preprint: 2007.00106.
Google LLC (2020). Google COVID-19 Community Mobility Reports.
google.com/covid19/mobility/. Accessed October 2020.

https://www.

Halloran, M. E. and Struchiner, C. J. (1991). Study designs for dependent happenings.
Epidemiology, 2(5):331–338.
Hilker, F. M., Langlais, M., Petrovskii, S. V., and Malchow, H. (2007). A diffusive SI model
with Allee effect and application to FIV. Mathematical Biosciences, 206(1):61–80.
Hyman, J. M. and LaForce, T. (2003). Modeling the spread of influenza among cities. In
Bioterrorism: Mathematical modeling applications in homeland security, pages 211–236.
SIAM.
Imbens, G. W. (2000). The role of the propensity score in estimating dose-response functions.
Biometrika, 87(3):706–710.
Kermack, W. O. and McKendrick, A. G. (1927). A contribution to the mathematical theory
of epidemics. Proceedings of the Royal Society of London. Series A, Containing Papers of
a Mathematical and Physical Character, 115(772):700–721.
Kounchev, O., Simeonov, G., and Kuncheva, Z. (2020). The TVBG-SEIR spline model
for analysis of COVID-19 spread, and a Tool for prediction scenarios. arXiv preprint
arXiv:2004.11338.
Lee, J. and Jung, E. (2015). A spatial-temporal transmission model and early intervention
policies of 2009 A/H1N1 influenza in South Korea. Journal of Theoretical Biology, 380:60–
73.
Lee, J. M., Choi, D., Cho, G., and Kim, Y. (2012). The effect of public health interventions
on the spread of influenza among cities. Journal of Theoretical Biology, 293:131–142.
Lee, S. and Castillo-Chavez, C. (2015). The role of residence times in two-patch dengue
transmission dynamics and optimal strategies. Journal of Theoretical Biology, 374:152–
164.

21

Li, Q., Guan, X., Wu, P., Wang, X., Zhou, L., Tong, Y., Ren, R., Leung, K. S., Lau, E. H.,
Wong, J. Y., Xing, X., Xiang, N., Wu, Y., Li, C., Chen, Q., Li, D., Liu, T., Zhao, J., Liu,
M., Tu, W., Chen, C., Jin, L., Yang, R., Wang, Q., Zhou, S., Wang, R., Liu, H., Luo, Y.,
Liu, Y., Shao, G., Li, H., Tao, Z., Yang, Y., Deng, Z., Liu, B., Ma, Z., Zhang, Y., Shi, G.,
Lam, T. T., Wu, J. T., Gao, G. F., Cowling, B. J., Yang, B., Leung, G. M., and Feng,
Z. (2020). Early transmission dynamics in wuhan, china, of novel coronavirus – infected
pneumonia. New England Journal of Medicine, 382(13):1199–1207. PMID: 31995857.
Livingston, E. and Bucher, K. (2020). Coronavirus Disease 2019 (COVID-19) in Italy.
Journal of the American Medical Association, 323(14):1335–1335.
Lyu, H., Strohmeier, C., Menz, G., and Needell, D. (2020). COVID-19 Time-series Prediction
by Joint Dictionary Learning and Online NMF. arXiv preprint arXiv:2004.09112.
Magdon-Ismail, M. (2020). Machine Learning the Phenomenology of COVID-19 From Early
Infection Dynamics. medRxiv: 10.1101/2020.03.17.20037309.
Mbuvha, R. and Marwala, T. (2020). Bayesian Inference of COVID-19 Spreading Rates in
South Africa. medRxiv: 10.1101/2020.04.28.20083873.
Milner, F. A. and Zhao, R. (2008). Sir model with directed spatial diffusion. Mathematical
Population Studies, 15(3):160–181.
Nychka, D., Furrer, R., and Sain, S. (2014). fields: Tools for spatial data. R package version
7.1. Accessed online, 10.
Paeng, S.-H. and Lee, J. (2017). Continuous and discrete sir-models with spatial distributions. Journal of Mathematical Biology, 74(7):1709–1727.
Prem, K., Liu, Y., Russell, T. W., Kucharski, A. J., Eggo, R. M., Davies, N., Flasche, S.,
Clifford, S., Pearson, C. A., Munday, J. D., et al. (2020). The effect of control strategies to
reduce social mixing on outcomes of the covid-19 epidemic in wuhan, china: a modelling
study. The Lancet Public Health, 5(5):261–270.
Punn, N. S., Sonbhadra, S. K., and Agarwal, S. (2020). Covid-19 epidemic analysis using
machine learning and deep learning algorithms. medRxiv: 10.1101/2020.04.08.20057679.
Reich, B. J., Yang, S., Guan, Y., Giffin, A. B., Miller, M. J., and Rappold, A. G. (2020). A
review of spatial causal inference methods for environmental and epidemiological applications. arXiv preprint: 2007.02714.

22

Reluga, T. (2004). A two-phase epidemic driven by diffusion. Journal of Theoretical Biology,
229(2):249–261.
Robinson, M., Stilianakis, N. I., and Drossinos, Y. (2012). Spatial dynamics of airborne
infectious diseases. Journal of Theoretical Biology, 297:116–126.
Rosenbaum, P. R. and Rubin, D. B. (1983). The central role of the propensity score in
observational studies for causal effects. Biometrika, 70(1):41–55.
Rubin, D. B. (1974). Estimating causal effects of treatments in randomized and nonrandomized studies. Journal of Educational Psychology, 66(5):688.
Sattenspiel, L., Dietz, K., et al. (1995). A structured epidemic model incorporating geographic mobility among regions. Mathematical Biosciences, 128(1):71–92.
Sattenspiel, L. and Herring, D. A. (2003). Simulating the effect of quarantine on the spread
of the 1918–19 flu in central Canada. Bulletin of Mathematical Biology, 65(1):1–26.
Sobel, M. E. (2006). What do randomized studies of housing mobility demonstrate? causal
inference in the face of interference. Journal of the American Statistical Association,
101(476):1398–1407.
Sparks, A., Hengl, T., and Nelson, A. (2017). GSODR: Global Summary Daily Weather
Data in R. Journal of Open Source Software, 2(10):177.
Stein, M. L. (2005). Space–time covariance functions. Journal of the American Statistical
Association, 100(469):310–321.
U.S. Bureau of Labor Statistics (2019). Health Care and Social Assistance: NAICS 62.
https://www.bls.gov/iag/tgs/iag62.htm.
U.S. Census Bureau (2016). American Community Survey Public Use Microdata Samples.
https://www.census.gov/newsroom/press-releases/2016/cb16-tps144.html.
Wang, Y., Wang, J., and Zhang, L. (2010). Cross diffusion-induced pattern in an SI model.
Applied Mathematics and Computation, 217(5):1965–1970.
Wu, X., Nethery, R. C., Sabath, B. M., Braun, D., and Dominici, F. (2020). Exposure to
air pollution and COVID-19 mortality in the United States: A nationwide cross-sectional
study. medRxiv: 10.1101/2020.04.05.20054502.

23

Yilmazkuday, H. (2020). Stay-at-home works to fight against covid-19: international evidence from google mobility data. Journal of Human Behavior in the Social Environment:
10.1080/10911359.2020.1845903.

Disclaimer: The views expressed in this manuscript are
those of the individual authors and do not necessarily
reflect the views and policies of the U.S. Environmental
Protection Agency. Mention of trade names or commercial products does not constitute endorsement or
recommendation for use.

24

Appendix: Derivation of conditional expectation of Y
E{Yj (t) |Ā(t), ē(t), Ȳ(t − 1), X̄(t)}
= E{Yj (t) | Ā(t), ē(t), S̄(t − 1), Ī(t − 1), X̄(t)}


= E E{Yj (t) | Ā(t), X̄(t), S̄(t − 1), Ī(t − 1)} | Ā(t), ē(t), S̄(t − 1), Ī(t − 1), X̄(t)
h
i
Ā(t)
= E E{Yj (t) | Ā(t), X̄(t), S̄(t − 1), Ī(t − 1)} | Ā(t), ē(t), S̄(t − 1), Ī(t − 1), X̄(t)
Ā(t)

(t) | Ā(t), ē(t), S̄(t − 1), Ī(t − 1), X̄(t)}


>
>
= exp{Aj (t)δ1 + Ãj (t)δ2 } · E exp{α1 + Xj (t) α2 + X̃j (t) α3 } ē(t), S̄(t − 1), Ī(t − 1), X̄(t)

= E{λj

· exp{θj (t)} + vj (t)
= exp{Aj (t)δ1 + Ãj (t)δ2 + α1 + Xj (t)> α2 + X̃j (t)> α3 } · exp{θj (t)} + vj (t),
Note that the conditional expectation on the last line is a function of ē(t). The second
equality follows from the causal consistency assumption, the third from the ignorability
assumption on the intervention process, the fourth from the form of model (9), and the
fifth from the balancing property (Balancing) of the generalized propensity score. The final
equality assumes that the generalized propensity scores components have been included in
X and X̃.

25

