arXiv:2008.00374v2 [econ.TH] 19 Jan 2021

Fair Allocation of Vaccines, Ventilators and Antiviral
Treatments: Leaving No Ethical Value Behind in
Health Care Rationing∗
Parag A. Pathak
M. Utku Ünver

Tayfun Sönmez
M. Bumin Yenmez†

January 2021

Abstract
COVID-19 has revealed limitations of existing mechanisms for rationing medical
resources under emergency scenarios. Many argue that these mechanisms abandon
various ethical values such as equity by discriminating against disadvantaged communities. Illustrating that these limitations are aggravated by a restrictive choice
of mechanism, we formulate pandemic rationing of medical resources as a new application of market design and propose a reserve system as a resolution. We develop
a general theory of reserve design, introduce new concepts such as cutoff equilibria
and smart reserves, extend analysis of previously-known ones such as sequential reserve matching, relate these concepts to current debates, and present preliminary
policy impact.

JEL codes: D45, D47, I14
Keywords: ethical rationing, reserve system, COVID-19, vaccines, ventilators

∗

This version supercedes: “Leaving No Ethical Value Behind: Triage Protocol Design for Pandemic
Rationing,” NBER Working Paper 26951, April 2020. We are grateful for input from several experts in
bioethics, emergency healthcare, and webinar participants at Johns Hopkins University, London Business
School, Stony Brook International Conference on Game Theory, Australasian Microeconomic Theory
Seminars, the HELP! (HEaLth and Pandemics) Econ Working Group Seminar Series, Penntheon Webinar Series, Stockholm School of Economics Corona Economic Research Network Webinar Series, UK
Virtual Seminars in Economic Theory, NBER Workshop on Market Design, and Harvard-MIT Theory
Workshop, University of Tokyo Theory Seminar. Nikhil Agarwal, Alex Rees-Jones, Robert Truog, Iván
Werning, and Doug White provided helpful comments. Feedback from Eric Budish, David Delacrétaz,
Fuhito Kojima, Govind Persad, and Alex Teytelboym was particularly valuable.
†
Pathak: Department of Economics, Massachusetts Institute of Technology, and NBER,
email: ppathak@mit.edu, Sönmez: Department of Economics, Boston College, email: sonmezt@bc.edu,
Ünver: Department of Economics, Boston College, email: unver@bc.edu, Yenmez: Department of Economics, Boston College, email: bumin.yenmez@bc.edu.

1

1

Introduction

Agencies responsible for public health and emergency preparedness design guidelines
for allocating scarce medical resources in crisis situations. These situations range from
wartime triage medicine to public health emergencies, such as influenza pandemics and
COVID-19. Items in short supply include vaccines, ventilators, and anti-viral treatments.
How to implement a rationing system for medical resources during a crisis presents
a complicated question rife with ethical concerns. Rationing guidelines typically start
by articulating several different ethical principles. These principles include equity, which
is fair distribution of benefits and burdens; utilitarianism, which is maximizing welfare;
reciprocity, which is respecting contributions others have made in the past; instrumental
valuation, which is respecting contributions others could make in the future; solidarity,
which is fellowship with other members of society; non-discrimination, which is requiring that certain individual characteristics such as gender, race, and age play no role
allocation. Guidelines also emphasize procedural values, such as accountability, reasonableness, and transparency (see, e.g., Emanuel et al. (2020), Prehn and Vawter (2008),
Truog, Mitchell, and Daley (2020), and WHO (2007)).
After articulating these ethical principles, guidelines describe how to operationalize
them with an allocation mechanism. The most common approach is a priority system, in
which patients are placed into a single priority order, and allocation is in order of priority.
For example, 2018 US Centers for Disease Control Vaccine Allocation guideline place
patients into one of four tiers based on their role in (1) providing homeland and national
security, (2) providing health care and community support services, (3) maintaining
critical infrastructure, and (4) being a member of the general population (CDC, 2018). In
some cases priority orders come from an objective scoring method, resulting in a priority
point system. This is common for rationing of ICU beds and ventilators. Piscitello et al.
(2020) reports that 19 states have priority point systems based on the Sequential Organ
Failure Assessments (SOFA) score, which measures the severity of organ dysfunction.1
The COVID-19 pandemic has spurred renewed interest in medical rationing guidelines and has revealed several important limitations of the existing allocation mechanisms.
Whether it is about rationing of ventilators, antiviral drugs or vaccines, a common theme
in many debates is that existing guidelines and allocation mechanisms have given up on
1

The European Society of Intensive Care Medicine devised the SOFA score at a consensus meeting
in October 1994 in Paris, France (Vincent et al., 1996). Each of six organ systems – lungs, liver, brain,
kidneys, blood clotting, and blood pressure – is independently assigned a score of 1 to 4. The SOFA
score sums these six scores, and sicker patients are assigned higher scores. While not initially designed as
a prognostic score, subsequent research supports ts use for that end (Jones, Trzeciak, and Kline, 2009).

2

certain values. For example, advocates for disadvantaged groups criticize priority point
systems which use the SOFA score. They argue that these criteria are discriminatory for
they fail to acknowledge pre-existing discrimination in access to health care (Schmidt,
2020). Similarly, disabilities’ advocates argue that rationing plans based solely on survival
probabilities because they are inherently discriminatory for certain types of disabled patients. Some even reject a detailed triage protocol in favor of random selection (Ne’eman,
2020).
In this paper, we argue that several shortcomings of the existing guidelines are a
direct consequence of restricting allocation mechanisms to priority systems. A priority
system’s single priority order for all units impedes its ability to represent a variety of
ethical considerations. We propose an alternative way to accommodate multiple ethical
principles through a reserve system. In a reserve system, units are divided into multiple
categories, with each representing an ethical value or a balance of different ethical values. Rather than relying on a single priority order for allocation of all units, a distinct
priority order for each category prioritizes individuals for units in that category. This
heterogeneity allows a rationing system to accommodate desired ethical values without
needing to aggregate them into a single metric or into a strict lexicographic hierarchy.
The flexibility of a reserve system over a priority system can help reach compromises in several debates. For example, many argue that disadvantaged groups or underrepresented minorities should be given priority access for a COVID-19 vaccine. This is
a significant departure from the recommended priority tiers in the 2018 CDC Vaccine
allocation guideline. Others question whether prioritizing these groups would erode public trust in vaccination. For more on this debate, see Ducharme (2020), McCaughey
(2020), and Twohey (2020). While there is no middle ground for compromise under a
priority system, a compromise can be reached through a reserve system by giving disadvantaged communities preferential treatment for a fraction of vaccines. Indeed, after the
dissemination of the first draft of this paper, our proposed approach has been embraced
by several groups in bioethics, and it is already adopted in several jurisdictions, as we
further describe in Section 5.
After proposing the use of a reserve system for medical rationing, our paper develops
a general theory of reserve systems. Since reserve systems exist in other settings such
as affirmative action and immigration visa allocation, our formal results are relevant
beyond our main application of medical rationing. To focus on our main application,
we formulate the model in terms of medical rationing and establish connections to these
other applications after developing the model.

3

In the model, there are a number of identical medical units to be allocated to a set of
patients. These units can be ICU beds, ventilators, anti-virals, vaccines, or other scarce
vital items. There is a set of reserve categories and units are attached to a given category.
An allocation is a matching of patients either to a reserve category if the patient receives
a unit or the empty set if she does not. Under our formulation, units are placed into one
of a set of reserve categories, each with a distinct priority order of patients.
Our formal results explore the foundations of reserve systems. We specify three basic
principles any system has to satisfy. First, patients should only receive units for which
they are qualified. Second, no unit from any reserve category should stay idle as long as
there is an eligible patient for that category. Finally, for each category, units should be
allocated based on the priority order of individuals in the category. We see these principles
as minimal requirements, which can be justified on both normative and positive grounds.
In many real-life applications of reserve systems, outcomes are described though a
specification of the cutoff individual at each category, i.e., the lowest priority individual
who has gained admission through each category.2 The vector of cutoff individuals identify the budget set for each individual in the sense that each individual can see through
which (if any) category she can receive a unit. Motivated by this observation, we next
formalize the notion of a cutoff equilibrium, a notion akin to a competitive equilibrium.
A cutoff equilibrium is a vector of cutoff individuals together with a matching, where
each patient is matched with a category in her budget set, and any category that has not
filled its quota has a cutoff of ∅ (the counterpart of a price of zero in our model). Our
first result rationalizes the prevalence of the use of cutoffs in real-life applications and
the plausibility of our three axioms: A matching satisfies these three properties if and
only if it is supported at a cutoff equilibrium.
Although this result provides a full characterization of matchings that satisfy our
three properties, it leaves open the question of how to find matchings supported at
cutoff equilibria. Just like computing all competitive equilibria often presents challenges
except in special cases, so does the computation of all cutoff equilibria. Our second
main result is that matchings that are supported at cutoff equilibria can be computed
by constructing a hypothetical two-sided matching market where each patient has strict
preferences between categories. This construction is hypothetical because in the original
problem the patient only cares about obtaining a resource and is therefore indifferent
between all units. We show that a matching satisfies our three properties if and only
if it can be computed as the outcome of the deferred acceptance algorithm (Gale and
2

See Figure A1 in Section E of the Supplementary Material for examples.

4

Shapley, 1962) for this hypothetical market.
Our link to a hypothetical two-sided matching market provides a great deal of flexibility to compute outcomes by changing the way patients rank categories under these
artificial preferences. This flexibility has an important drawback: unless there is a systematic way to construct preferences, practitioners may not value the ability to construct
artificial preferences at this level of generality. For instance, it may be difficult to explain if a patient i is considered first for an unreserved category and then for an essential
personnel category, whereas another patient j with similar characteristics is considered
for these categories in the reverse order. We therefore focus on an subclass of matchings,
known as sequential reserve matchings, in which reserve categories are processed in sequence in a particular order. The set of sequential reserve matchings is a refinement of
the set of cutoff matchings. Within this class, we then demonstrate that the earlier a
category is processed, the higher is the maximum cutoff. Intuitively this means that the
earlier a category is processed the more competitive it becomes.
We next turn to a special environment where there is a baseline priority order. This
special environment, which is the focus of much of the earlier literature on reserve systems,
is widespread in real-life applications where the baseline order may depend on scores on
standardized exams, results of random lotteries, or time of application. For medical
rationing, the baseline order may depend on an objective measure of expected health
outcome such as the SOFA score.
There is an unreserved category in which all patients are beneficiaries and the priority
order is the same as the baseline. Any other category is a preferential treatment category,
with a set of beneficiaries, and all beneficiaries of a category are prioritized over patients
who are not, but otherwise their relative priority order is the same as the baseline. If each
patient is a beneficiary of at most one preferential treatment category, and there are not
more than five categories, every beneficiary of the preferential treatment category who
is matched when a category c is processed earlier is also matched when it is processed
later. This result substantially generalizes earlier results on reserve processing to several
categories, while also showing the limit of obtaining sharp formal results for more than
five categories.
Finally, we turn to a possible shortcoming of sequential reserve systems in environments where reserves are “hard” in the sense that they are exclusive to the beneficiaries
of the reserve category: In these environments, some of the sequential reserve matchings
can be Pareto dominated by others. This shortcoming is a direct consequence of the mechanical allocation of patients into reserve categories under sequential reserve matching
5

when they clear the cutoffs for multiple categories. We therefore introduce an additional
principle requiring a “smart” allocation of reserves in these situations, maximizing the
accommodation of intended beneficiaries of reserves. This property together with nonwastefulness imply Pareto efficiency. We conclude our theoretical analysis by introducing
a class of algorithms that produce “smart” reserve matchings with the desired properties. This class has two extremal members implementing the “minimum guarantee” and
“over-and-above” policies on reserve systems, the two primary types of reserve systems
in practice.
The rest of paper organized as follows. Section 2 presents some additional background
on widespread use of priority systems for emergency rationing of medical resources and
identifies several shortcomings of these systems. Section 3 presents our formal model of
reserve systems, states our main two characterization results, and introduces sequential
reserve matchings. Our model in this section is more general than any other paper on
reserve systems in the literature, and our technical contributions here are conceptual.
Section 4 specializes the model to one with a baseline priority order, develops comparative static results, and formulates and studies smart reserve matchings. It also relates
our findings to earlier literature on reserve systems. In contrast to Section 3 where our
analysis is general and results are conceptual, Section 4 is where we make deeper technical contributions to the earlier literature on reserve systems. Section 5 reviews the
preliminary impact of the first version of our paper on policy and practice of pandemic
medical resource allocation as well as its interdisciplinary academic impact. The paper
concludes in Section 6. All proofs are relegated to the Appendix except the long and
brute-force proof of Proposition 3 which is relegated to the Supplementary Material.

2
2.1

Priority Systems for Pandemic Rationing
Background on Priority Systems

The most common allocation mechanism for medical rationing is a priority system
in which units are allocated to patients based on a single priority order. This priority
order captures the ethical values guiding the allocation of the scarce medical resource. In
some applications, most notably for allocation of ventilators and ICU beds, the underlying
priority order is obtained through a monotonic scoring function. Such a refinement of a
priority system is called a priority point system. Under this system, each ethical value
is represented with a monotonic function. Values are then integrated with an additive
formula, which produces an aggregate point score for each patient. The claims of patients
over medical resources are determined based on their point scores, where a lower score
6

may be associated with a higher claim or a lower claim depending on the application.
Often a priority score is coarsened into tiers, and all patients in the same tier have the
same claim. Tie-breaking within a tier is typically based on clinical criteria or lotteries.
A single-principle point system is a priority point system based on only one ethical
value. The 2015 New York State Ventilator Guideline is a prominent example. In the
system, as a first step certain patients are deemed ineligible. The remaining patients are
ordered based on estimated mortality risk, which is re-evaluated every 48 hours (Zucker
et al., 2015). Mortality risk is measured by the SOFA score which places patients into
priority tiers. In cases of excess demand among members of a given priority tier, New
York and other proposals recommend random allocation – a lottery – among equalpriority patients (Emanuel et al., 2020; Zucker et al., 2015).
Several bioethicists and clinicians criticize single-principle priority point systems solely
based on SOFA for ignoring multiple ethical values. These critics emphasize the need
to integrate a variety of ethical values and advocate for a multi-principle approach, see,
e.g., White, Katz, Luce, and Lo (2009) and Daugherty-Biddison et al. (2017). White,
Katz, Luce, and Lo (2009) describe a multi-principle priority point system where several
ethical values are placed on a numerical scale and summed up across ethical values to
arrive at a single number. Variants of the system shown in Table 1 are widespread the
leading multi-principle priority point system for ventilators.3

3

Pu Kamp, Devine, and Griffin (2020) reports that several hundred hospitals around the country
have adopted this system.

7

Table 1 shows how the ethical values of saving the most lives, saving the most years
of life, and the life-cycle principle are integrated through an additive formula. As an
example, consider a hypothetical patient with a SOFA score of seven. She obtains two
points based on the ethical value of saving the most lives. If the patient has no chronic
diseases or comorbidities and is between 61-74 years old, she obtains four more points
based on the other two ethical values yielding a total of six. A patient with a lower total
point score has a higher priority for the resource than a patient with a higher total point
score.4 More than half of US states use either a single- or multiple-principle priority
point system (Whyte, 2020).

2.2

Challenges with Priority Systems

While practical, priority systems have a number of important limitations. A priority
system may fail to integrate different ethical values because of incommensurability.5 For
example, the ethical values of saving the most lives and the life-cycle principle in Table
1 are incommensurable values, making it hard to interpret the role of these values under
the priority point system in Table 1. In addition, various ethical values have implications
on group composition, and a priority system lacks the flexibility to accommodate these
considerations. In many cases, these challenges have led to the exclusion of some of ethical
values all together. We elaborate on several of these points next, focusing on several
debates on rationing of ventilators and ICU beds. Since virtually all states with guidelines
recommend priority point systems, we present the shortcomings of these mechanisms.
Many of these shortcomings are shared by priority systems in general.
2.2.1

Failure to Represent the Desired Ethical Values

A priority point system requires that ethical values be mapped to a single linear
order. However, there are some ethical principles where the claims of patients cannot
be represented with a monotonic function. One example is group-based policies, such
as those related to regions or gender. For example, the European Union has proposed
balanced participation of women and men in political and public decision making by
requiring that at least 40% of public offices are held by women and at least 40% are held
by men (Dittmar, 2018; Rankin, 2020). For medical rationing, it is possible that a future
pandemic is so devastating that it threatens a significant portion of the human race.
In such a hypothetical crisis, a principle based on survival of the species may suggest a
4

Most protocols specifies a tie-breaker between patients with identical total points, although the
South Carolina protocol fails to provide one.
5
In ethics, two values are incommensurable when they do not share a common standard of measurement.

8

similar constraint. A guideline may recommend to allocate at least 40% of vital resources
to female patients and at least 40% to male patients. Clearly, considerations based on
group composition cannot be represented with a function that relies only on individual
attributes. Similarly, a priority point system cannot accommodate a guideline that wishes
to allocate resources to disabled citizens in proportion to their representation in society.
When constructing priority points and incorporating multiple ethical values, a priority
point system norms or scales different and potentially incommensurable ethical principles
into one dimension. These challenges are like the usual ones associated with aggregating
social alternatives into a single ordering based on multiple inputs – a situation which
involves “comparing apples to oranges.” The debate on how rationing guidelines should
compare claims of children versus adults illustrates this issue. Massachusetts guidelines
state that indicators that feed into scores for adults are not reliable for children (Bateman et al., 2020). They explain that “scoring systems that are meaningful for adult
critical care patients do not apply to pediatric patients or newborns.” As a result, the
Massachusetts guidelines use a different scoring system for children. However, their point
system then uses a single priority point system to evaluate all patients together. This
decision ends up comparing the point scores of children with those of adults.
Third, the fact that all resources are ordered using a single uniform priority order can
result in the exclusion of certain ethical values. An example of this phenomenon appears
in the debate about prioritizing essential personnel. Many groups argue that essential
personnel, and especially frontline healthcare workers, should receive priority allocation
of scarce resources under triage scenarios. This view is also strongly endorsed by medical
ethicists based on the backward-looking principle of reciprocity and the forward-looking
principle of instrumental value (Emanuel et al., 2020). Nevertheless, states such as
Minnesota and New York had to give up on this consideration, largely due to concerns
about the extreme scenarios where no units may remain for the rest of the society. The
Minnesota Pandemic Working group reasons that (Vawter et al., 2010):
... it is possible that they [key workers] would use most, if not all, of the short
supply of ventilators; other groups systematically would be deprived access.
The New York State Task Force recognized the need to provide “insurance” for frontline
health workers, but ultimately decided against such a priority (Zucker et al., 2015):
Expanding the category of privilege to include all the workers listed above may
mean that only health care workers obtain access to ventilators in certain communities. This approach may leave no ventilators for community members, including
9

children; this alternative was unacceptable to the Task Force.
For both states, the committees abandoned the ethical values of reciprocity and instrumental value because of the limitation of priority systems. In a priority system, providing
preferential access to any group for any portion of the resources means giving preferential
treatment for all of them.
Fourth, a single priority order struggles to integrate the principle of non-exclusion.
This principle is the idea that every patient, no matter his or her circumstances, should
have some hope of obtaining a life-saving resource. In the March 2020 Alabama rationing
plan, individuals with severe or profound mental disabilities were considered “unlikely
candidates for ventilator support.”6 Washington state guidelines recommend that hospital patients with “loss of reserves in energy, physical ability, cognition and general health”
be switched to outpatient or palliative care (Fink, 2020). In a priority system coupled
with excess demand for available resources by the higher-priority groups – even without
any explicit exclusion of certain types of individuals – there will be some patients in a
lower-priority group who would never be treated during a shortage.
2.2.2

Implementation Issues in Existing Guidelines

These conceptual challenges with a priority point system are reflected in actual design
challenges in several guidelines. We describe three examples.
Massachusetts Crisis Standards of Care guidance for the COVID-19 pandemic was
developed in April 2020 by a committee consisting of medical experts and ethicists (DPH,
2020). The guidelines provided an adaption of the system described in Table 1 without
the life-cycle consideration. However, after precisely spelling out the priority order with
a table of numbers for each dimension, the document states:
Individuals who perform tasks that are vital to the public health response, including all those whose work directly to support the provision of care to others, should
be given heightened priority.
This clause provides no further description on how heightened priority is to be implemented. This lack of transparency contrasts with the level of precision regarding other
ethical principles, and may reflect their inability to arrive at consensus given the underlying priority point system.
Crisis standards of care guidelines initially developed in Pittsburgh use a similar
adaptation of the system described in Table 1. They offer a vague description of tiebreakers:
6

After widespread backlash, this plan was withdrawn on April 9, 2020.

10

In the event that there are ties in priority scores between patients, life-cycle
considerations will be used as a tiebreaker, with priority going to younger patients,
who have had less opportunity to live through life’s stages. In addition, individuals
who perform tasks that are vital to the public health response – specifically, those
whose work directly supports the provision of acute care to others – will also be
given heightened priority (e.g., as a tiebreaker between identical priority scores)
In their adaptation of Table 1, the designers saw saving the most lives as more justified
than either the life-cycle principle or the instrumental value principle. However, the
guidelines did not choose between these two latter ethical values in the event of tiebreaking.
The third example is from Arizona’s June 6, 2020 update to their allocation framework
(DHS, 2020). This document also offers a table prioritizing patients based on SOFA scores
and whether a patient is expected to live or die within one or five years despite successful
treatment of illness. It then warns that “a situation could arise where limited resources
are needed by two or more patients with the same triage priority scores” in which case
“additional factors may be considered as priorities.” Among the list of additional factors
are whether patients are pediatric patients, first responders or health care workers, single
caretakers for minors or dependent adults, pregnant, or have not had an opportunity to
experience life stages. There is no further detail on how multiple tie-breakers would be
implemented.
Beyond these specific updates to guidelines during the COVID-19 pandemic, there
are also concerns that incomplete descriptions have rendered such guidelines ineffective
in other settings. During the 2004 shortage of the influenza vaccine, Schoch-Spana,
Fitzgerald, Kramer, and Force (2005) state that CDC guidelines were too general and
broad. Specifically,
Local providers thus faced gaps in the local supply of inactivated vaccine as well
as the absence of a priori prioritization standards relevant to initial and evolving
local conditions. Practitioners and local and state health authorities throughout
the U.S. faced a similar predicament.
Despite these vagaries, some state departments of health penalized clinicians if protocols
are not followed. For example, Lee (2004) describes that the Massachusetts threatened
a fine or prison time for whoever violates the CDC order on distribution during the 2004
flu-shot shortage. The requirement to follow an incompletely specified system places
clinicians in a difficult position.
11

2.3

Reserve Systems

Many of the challenges presented in Section 2.2 stem from one simple but limiting
feature of a priority point system: it relies on a single priority ranking of patients that is
identical for all units. A reserve system eliminates this feature of the mechanism because
it allows for heterogeneity of patient claims over different units.
A reserve system has three main parameters. They are:
1. a division of all units into multiple segments referred to as reserve categories,7
2. number of units in each of these categories, and
3. specification of a priority order of the patients in each of these categories.
If reserve categories are processed sequentially, as in the case in several real-life applications of reserve systems, processing order of reserve categories can also be an additional
parameter. For some (or all) of the reserve categories, there can also be exclusion criteria,
based on the nature of the medical resource that is being rationed along with the patient’s
clinical assessment. The priority order of patients for each category also incorporates this
information. Reserve categories can differ either based on the groups to receive higher
priority or the combination of ethical principles to be invoked. The main idea is to use
the associated priority order – which embeds ethical principles – when allocating units
in each reserve category. Importantly, the priority order need not be the same between
reserve categories.

3

A General Theory of Reserve Systems

Reserve systems are common in applications where competing interest groups fail to
agree on allocation criteria. If each individual is eligible to receive units only from one
of these categories, then the theory of priority systems directly extend to this most basic
form of reserve systems. However, in most applications at least some of the individuals
are eligible to receive units from multiple categories, thereby resulting in multiplicities in
implementation of these “categorized” priority systems in conjunction.8 In this section,
we develop a general theory of reserve systems, with particular emphasis on the analytical
structure and the distributional implications of this multiplicity.
Our theory is general compared to existing papers on reserve systems because earlier
work makes important assumptions on the structure of priority orders used at various
7

This division is for accounting purposes only, and it does not attach a specific unit to a category.
This multiplicity and its distributional implications are often under-appreciated or misunderstood in
real-life applications (Dur, Kominers, Pathak, and Sönmez (2018) and Pathak, Rees-Jones, and Sönmez
(2020)).
8

12

categories.9 Most notably, it is almost always assumed that priority order at each category
is derived from an underlying baseline priority order, such as those obtained through
standardized exams. In these applications each reserve category c is identified by a
subset of individuals who are simply moved to the top of the baseline priority order for
the category-c priority order.
In contrast, in this section we develop a theory of reserve systems where we impose
no structure on priority orders. Our model allows priority orders at various categories
to be completely independent from each other, although they do not need to be. Since
it may not be possible to capture priorities for all ethical considerations though adjustments of a single baseline priority order, this level of generality is necessary for our main
application.10 To the best of our knowledge reserve systems have not been studied in
this generality before.

3.1

The Primitives

Despite the generality of our model, the terminology is tailored to the main application
of pandemic medical resource rationing. There is a set of patients I and q identical
medical units to allocate. There is a set of reserve categories C. For every category
P
c ∈ C, rc units are reserved so that c∈C rc = q. It is important to emphasize that
individual units are not associated with the categories in our model. The phrase “rc
units are reserved” does not mean specific units are set aside for category c. Rather, it
means that for the purposes of accounting, a total of unspecified rc units are attached to
category c.
For every category c ∈ C, there is a linear priority order πc over the set of patients
I and ∅. This priority order represents the relative claims of the patients on units in
category c as well as their eligibility for those units. For every category c ∈ C and patient
i ∈ I, we say that patient i is eligible for category c if
i πc ∅.
9

This literature starts with Hafalir, Yenmez, and Yildirim (2013), and includes studies of affirmative
action in school choice (Correa et al., 2019; Dur, Kominers, Pathak, and Sönmez, 2018; Dur, Pathak,
and Sönmez, 2020), college admissions (Aygün and Bo, 2020; Baswana et al., 2019), assignment of
government positions (Sönmez and Yenmez, 2019) and skill diversity in immigration visa allocation
(Pathak, Rees-Jones, and Sönmez, 2020).
10
This more general structure is not only needed for our main application of medical resource allocation, but also in other applications as well. For example in Germany, priority for college seats depend on
applicant waiting time for (up to) 20% of the seats, on their performance in high school leaving exams
for (up to) 20% of the seats, and to college-specific criteria for the rest of the seats (Westkamp (2013)).

13

Given priority order πc , we represent its weak order by π c . That is, for any x, y ∈ I ∪ {∅},
x πc y

⇐⇒

x = y or x πc y.

For our main application of pandemic rationing, πc orders patients based on the balance
of ethical principles guiding the allocation of units in category c.

3.2

The Outcome: A Matching

A matching µ : I → C ∪{∅} is a function that maps each patient either to a category
or to ∅ such that |µ−1 (c)| ≤ rc for every category c ∈ C. For any patient i ∈ I, µ(i) = ∅
means that the patient does not receive a unit and µ(i) = c ∈ C means that the patient
receives a unit reserved for category c. Let M denote the set of matchings.
Our formulation of the outcome of a reserve system involves a subtle but important
modeling choice. In models where there is a single type of good and each individual has
unit demand, the traditional way to describe the outcome of a reserve system is through
a choice rule, which indicates the set of individuals who are awarded a unit for any set
of applicants. Since each individual is indifferent between all units of the good, this
formulation is often seen sufficient for analysis. However, for our purposes it is not.
One of the primary appeals of the reserve system is its ability to facilitate compromises between various interest groups by allocating scarce resources through multiple
categories. While individuals are indifferent between all units of the scarce good, they
have potentially different claims on units from different categories. And consequently
merely specifying who receives a unit may not always be sufficient. For various analytical exercises, it is also important to specify through which category individuals receive
their units.11 Hence, we deviate from the prior formulation and let an outcome embed
information about the category.
For any matching µ ∈ M and any subset of patients I 0 ⊆ I, let µ(I 0 ) denote the set
of patients in I 0 who are matched with a category under matching µ. More formally,

µ(I 0 ) = i ∈ I 0 : µ(i) ∈ C .
11

As an illustration, consider affirmative action in India where a percentage of government jobs are
reserved for historically discriminated against groups such as Scheduled Castes (SC). By the Supreme
Court Case Indra Sawhney 1992 , units reserved for SC cannot be awarded to candidates from other
groups even if there are not sufficiently many applicants from SC. Moreover any member of SC who is
awarded one of these SC-reserve units needs to have lower merit score than any one who receives any
unreserved unit. These legal requirements cannot be verified by simply specifying who receives a unit.
It is also necessary to specify through which category the unit is received.

14

These are the patients in I 0 who are matched (or equivalently who are assigned units)
under matching µ.

3.3

Axioms

In real-life applications of our model, it is important to allocate the units to qualified
individuals without wasting any and abiding by the priorities governing the allocation of
these units. We next formulate this idea through three axioms:
Definition 1. A matching µ ∈ M complies with eligibility requirements if, for
any i ∈ I and c ∈ C,
µ(i) = c
=⇒
i πc ∅.
Our first axiom formulates the idea that units in any category should be awarded
only to eligible individuals. For most applications of rationing of vital medical resources,
any patient who is eligible for one category can also be eligible for any category. In
those applications, if a patient is ineligible for all categories, then this patient can as
well be dropped from the set of individuals. Hence, compliance with eligibility requirement vacuously holds in applications when all individuals are eligible for all categories.
This includes most applications in pandemic resource allocation, although there can be
examples where certain individuals may be eligible for only some of the categories.
Definition 2. A matching µ ∈ M is non-wasteful if, for any i ∈ I and c ∈ C,
i πc ∅

and

µ(i) = ∅

=⇒

µ−1 (c) = rc .

Our second axiom formulates the idea that no unit should go idle for as long as there is
an eligible individual to award it. That is, if a unit remains idle, then there should not be
any unmatched individual who is eligible for the unit. In those applications of rationing
vital resources where each patient is eligible for all units, non-wastefulness corresponds
to either matching all the units or all the patients.
Definition 3. A matching µ ∈ M respects priorities if, for any i, i0 ∈ I and c ∈ C,
µ(i) = c and µ(i0 ) = ∅

=⇒

i πc i0 .

Our last axiom formulates the idea that for each category, the units should be allocated based on the priority order of individuals in this category.
As far as we know, in every real-life application of a reserve system each of these
three axioms is either explicitly or implicitly required. Hence, we see these three axioms
15

as a minimal requirement for a reserve system. In the next two sections we present
two characterizations of matchings that satisfy these axioms, one through a notion akin
to competitive equilibria and the second based on the celebrated deferred acceptance
algorithm of Gale and Shapley (1962).

3.4

Cutoff Equilibria

In many real-life applications of reserve systems, the outcome is often publicized
through a system that identifies the lowest priority individual that qualifies for admission for each category. This representation makes it straightforward to verify that an
allocation was computed following the announced policy because an individual can compare her priority to the announced cutoffs. Often a cardinal representation of the priority
order, such as a merit score or a lottery number, is used to identify these “cutoff” individuals. (See, for example Figure A1 in Section E in Supplemental Materal.) This
observation motivates the following equilibrium notion.
For any category c ∈ C, a cutoff fc is an element of I ∪ {∅} such that fc π c ∅. Cutoffs
in our model play the role of prices for exchange or production economies, where the last
condition corresponds to prices being non-negative in those economies. We refer to a list
of cutoffs f = (fc )c∈C as a cutoff vector. Let F be the set of cutoff vectors.
Given a cutoff vector f ∈ F, for any patient i ∈ I, define the budget set of patient
i at cutoff vector f as
Bi (f ) = {c ∈ C : i π c fc } .
A cutoff equilibrium is a pair consisting of a cutoff vector and a matching (f, µ) ∈
F × M such that
1. For every patient i ∈ I,
(a) µ(i) ∈ Bi (f ) ∪ {∅}, and
(b) Bi (f ) 6= ∅
=⇒
µ(i) ∈ Bi (f ).
2. For every category c ∈ C,
|µ−1 (c)| < rc

=⇒

fc = ∅.

A cutoff equilibrium is an analogue of a competitive equilibrium for a reserve system. A
cutoff vector-matching pair is a cutoff equilibrium if
1. each patient who has a non-empty budget set is matched with a category in her
budget set, and each patient who has an empty budget set remains unmatched, and
2. each category which has not filled its quota under this matching has cutoff ∅.
16

The first condition corresponds to “preference maximization within budget set” and the
second condition corresponds to the “market clearing condition.”
Our first characterization result gives an equivalence between cutoff equilibrium matchings and matchings that satisfy our basic axioms.
Theorem 1. For any matching µ ∈ M that complies with eligibility requirements, is
non-wasteful, and respects priorities, there exists a cutoff vector f ∈ F that supports the
pair (f, µ) as a cutoff equilibrium. Conversely, for any cutoff equilibrium (f, µ) ∈ F ×M,
matching µ complies with eligibility requirements, is non-wasteful, and respects priorities.
There can be multiple equilibrium cutoff vectors that supports a matching at cutoff
equilibria. Next, we explore the structure of equilibrium cutoff vectors.
For any matching µ ∈ M and category c ∈ C, define
(
µ
fc

(
f µc =

=

minπc µ−1 (c) if |µ−1 (c)| = rc
∅
otherwise

and,

(1)

o
n


if maxπc I \ µ(I) ∪ {∅} 6= ∅
minπc i ∈ µ(I) : i πc maxπc I \ µ(I) ∪ {∅}
∅

.

otherwise
(2)

Here,
µ

• f c identifies
– the lowest πc -priority patient who is matched with category c if all category-c
units are exhausted under µ, and
– ∅ if there are some idle category-c units under µ,
whereas
• f µc identifies
– the lowest πc -priority patient with the property that every weakly higher πc priority patient than her is matched under µ if some category-c eligible patient
is unmatched under µ, and
– ∅ if all category-c eligible patients are matched under µ.
Let µ be any matching that respect priorities. By construction,
µ

f c π c f µc

for any c ∈ C.

17

Our next result characterizes the set of cutoff vectors.
Lemma 1. Let µ ∈ M be a matching that complies with eligibility requirements, is nonwasteful, and respects priorities. Then the pair (g, µ) is a cutoff equilibrium if, and only
if,
µ
for any c ∈ C.
f c π c gc π c f µc
An immediate corollary to Lemma 1 is that for each cutoff equilibrium matching
µ
µ
µ, f = (f c )c∈C is a maximum equilibrium cutoff vector and f µ = (f µc )c∈C is a
minimum equilibrium cutoff vector.
Of these equilibrium cutoff vectors, the first one has a clear economic interpretation.
The maximum equilibrium cutoff of a category indicates the selectivity of this particular
category. The higher the maximum cutoff is the more competitive it becomes to receive a
unit through this category. This is also the cutoff that is typically announced in real-life
applications of reserve systems due to its clear interpretation. The interpretation of the
minimum equilibrium cutoff of a category is more about the entire matching than the
category itself, and in some sense it is artificially lower than the maximum equilibrium
cutoff due to individuals who are matched with other categories. All other equilibrium
cutoffs between the two are also artificial in a similar sense. Therefore, for much of our
analysis we focus on the maximum equilibrium cutoff vector.

3.5

Characterization via Deferred Acceptance Algorithm

Although Theorem 1 gives a full characterization of matchings that satisfy our three
axioms, it leaves the question of how to find such a matching open. In this section, we
present a procedure to construct all such matchings utilizing the celebrated deferredacceptance algorithm by Gale and Shapley (1962).
Consider the following hypothetical many-to-one matching market. The two sides of
the market are the set of patients I and the set of categories C. Each patient i ∈ I can be
matched with at most one category, whereas each category c ∈ C can be matched with
as many as rc patients. Category c is endowed with the linear order πc that is specified
in the primitives of the original rationing problem.
Observe that in our hypothetical market, all the primitives introduced so far naturally
follows from the primitives of the original problem. The only primitive of the hypothetical
market that is somewhat “artificial” is the next one:
Each patient i ∈ I has a strict preference relation i over the set C ∪ {∅}, such that,

18

for each patient i ∈ I,
c i ∅

⇐⇒

patient i is eligible for category c.

While in the original problem a patient is indifferent between all units (and therefore
all categories as well), in the hypothetical market she has strict preferences between the
categories. This “flexibility” in the construction of the hypothetical market is the basis
of our main characterization.
For each patient i ∈ I, let Pi be the set of all preferences constructed in this way, and
let P = ×i∈I Pi .
Given a preference profile  = (i )i∈I , the individual-proposing deferred-acceptance
algorithm (DA) produces a matching as follows.
Individual Proposing Deferred Acceptance Algorithm (DA)
Step 1: Each patient in I applies to her most preferred category among
categories for which she is eligible. Suppose that Ic1 is the set of patients
who apply to category c. Category c tentatively assigns applicants with the
highest priority according to πc until all patients in Ic1 are chosen or all rc
units are allocated, whichever comes first, and permanently rejects the rest.
If there are no rejections, then stop.
Step k: Each patient who was rejected in Step k-1 applies to her next preferred category among categories for which she is eligible, if such a category
exists. Suppose that Ick is the union of the set of patients who were tentatively
assigned to category c in Step k-1 and the set of patients who just proposed
to category c. Category c tentatively assigns patients in Ick with the highest
priority according to πc until all patients in Ick are chosen or all rc units are
allocated, whichever comes first, and permanently rejects the rest. If there
are no rejections, then stop.
The algorithm terminates when there are no rejections, at which point all
tentative assignments are finalized.
A matching µ ∈ M is called DA-induced if it is the outcome of DA for some
preference profile  ∈ P.
We are ready to present our next result:

19

Theorem 2. A matching complies with eligibility requirements, is non-wasteful, and it
respects priorities if, and only if, it is DA-induced.
Not only is this result a second characterization of matchings that satisfy our three
basic axioms, it also provides a concrete procedure to calculate all such matchings. Equivalently, Theorem 2 provides us with a procedure to derive all cutoff equilibria. This
latter interpretation of our characterization leads us to a refinement of cutoff equilibrium
matchings explored in our next section.

3.6

Sequential Reserve Matching

An interpretation of the DA-induced matchings is helpful to motivate in focusing a
subset of these matchings. Recall that the hypothetical two-sided matching market constructed above relies on an artificial preference profile (i )i∈I of patients over categories.
What this corresponds to under the DA algorithm is that any patient i is considered for
categories that deem her eligible in sequence, following the ranking of these categories
under her artificial preferences i . Unless there is a systematic way to construct these
preferences, it may be difficult to motivate adopting this methodology for real-life applications. For example, if a patient i is considered first for an unreserved category and then
for an essential personnel category, whereas another patient j with similar characteristics
is considered for them in the reverse order, it may be difficult to justify this practice.
That is, while there is a potentially large set of matchings that satisfy our three axioms,
not all are necessarily obtained through an intuitive procedure. This may be a challenge
especially in the context of medical rationing, since procedural fairness is also an important ethical consideration in this context. Procedural fairness is the main motivation for
our focus in a subset of these matchings.
In many real-life applications of reserve systems, institutions process reserve categories
sequentially and allocate units associated with each category one at a time using its
category-specific priority order. We next formulate matchings obtained in this way and
relate them to our characterization in Theorem 2.
An order of precedence . is a linear order over the set of categories C. For any two
categories c, c0 ∈ C,
c . c0
means that category-c units are to be allocated before category-c0 units. In this case, we
say category c has higher precedence than category c0 . Let ∆ be the set of all orders
of precedence.

20

For a given order of precedence . ∈ ∆, the induced sequential reserve matching
ϕ. , is a matching that is constructed as follows:
Suppose categories are ordered under . as
c1 . c2 . . . . . c|C| .
Matching ϕ. is found sequentially in |C| steps:
Step 1: Following their priority order under πc1 , the highest priority rc1
category-c1 -eligible patients in I are matched with category c1 . If there are
less than rc1 eligible patients in I than all of these eligible patients are matched
with category c1 . Let I 1 be the set of patients matched in Step 1.
Step k: Following their priority order under πck , the highest priority rck
k0
category-ck -eligible patients in I \ ∪k−1
are matched with category ck . If
k0 =1 I
k0
there are less than rck eligible patients in I \ ∪k−1
then all of these eligible
k0 =1 I
k
patients are matched with category ck . Let I be the set of patients matched
in Step k.
Given an order of precedence . ∈ ∆, the induced sequential reserve matching complies
with eligibility requirements, is non-wasteful, and it respect priorities. Thus, it is DAinduced by Theorem 2. Indeed it corresponds to a very specific DA-induced matching.
Proposition 1. Fix an order of precedence . ∈ ∆. Let the preference profile . ∈ P be
such that, for each patient i ∈ I and pair of categories c, c0 ∈ C,
c .i c0

⇐⇒

c . c0 .

Then the sequential reserve matching ϕ. is DA-induced from the preference profile . .
We conclude this section with a comparative static result regarding the maximum
equilibrium cutoff vectors supporting sequential reserve matchings:
Proposition 2. Fix two distinct categories c, c0 ∈ C and a pair of orders of precedence
., .0 ∈ ∆ such that:
• c0 . c,
• c .0 c0 , and
• for any ĉ ∈ C and c∗ ∈ C \ {c, c0 }
ĉ . c∗

⇐⇒
21

ĉ .0 c∗ .

That is, .0 is obtained from . by only changing the order of c with its immediate predecessor c0 . Then,
ϕ 0
ϕ.
f c . πc f c .
Recall that the maximum equilibrium cutoff for a category is indicative of how selective the category is. Therefore, the earlier a category is processed under a sequential
reserve matching the more selective it becomes by Proposition 2. This result is intuitive
because the earlier a category is processed, the larger is the set of patients who compete
for these units in a setwise inclusion sense.

4

Reserve Systems under a Baseline Priority Order

In many real-life applications of reserve systems, there is a baseline priority order π
of individuals. Starting with Hafalir, Yenmez, and Yildirim (2013), the earlier market
design literature on reserve systems exclusively considered this environment. This priority order may depend on scores in a standardized exam, a random lottery, or arrival
time of application. In our main application of pandemic resource allocation, it may
depend on SOFA scores described in Section 2.1. This baseline priority order is used to
construct the priority order for each of the reserve categories, although each category
except one gives preferential treatment to a specific subset of individuals. For example,
in our main application these could be essential personnel or persons from disadvantaged
communities. In this section, we focus on this subclass of reserve systems and present
an analysis of reserve matching on this class. In contrast to Section 3 where our analysis
is more general than earlier literature and contributions are more conceptual than technical, analysis in this section represents our deeper technical contributions in relation to
earlier literature.
To formulate this subclass of reserve systems, we designate a beneficiary group
Ic ⊆ I for each category c ∈ C. It is assumed that all patients in its beneficiary group
are eligible for a category. That is, for any c ∈ C and i ∈ Ic ,
i πc ∅.
There is an all-inclusive category u ∈ C, called the unreserved category, which has
all patients as its set of beneficiaries and endowed with the baseline priority order. That
is,
Iu = I and πu = π.
Any other category c ∈ C \ {u}, referred to as a preferential treatment category,
22

has a more exclusive set Ic ⊂ I of beneficiaries and it is endowed with a priority order
πc with the following structure: for any pair of patients i, i0 ∈ I,
i ∈ Ic

and

i0 ∈ I \ Ic

=⇒

i πc i0 ,

i, i0 ∈ Ic

and

i π i0

=⇒

i πc i0 , and

i, i0 ∈ I \ Ic

and

i π i0

=⇒

i πc i0 .

Under πc , beneficiaries of category c are prioritized over patients who are not, but otherwise their relative priority order is induced by the baseline priority order π.
Let Ig , referred to as the set of general-community patients, be the set of patients
who are each a beneficiary of the unreserved category only:
Ig = I \ ∪c∈C\{u} Ic .
In particular two types of such problems have widespread applications.
We say that a priority profile (πc )c∈C has soft reserves if, for any category c ∈ C and
any patient i ∈ I,
i πc ∅.
Under a soft reserve system all individuals are eligible for all categories. This is the case,
for example, in our main application of pandemic resource allocation.
We say that a priority profile (πc )c∈C has hard reserves if, for any preferential
treatment category c ∈ C \ {u},
1. i πc ∅ for any of its beneficiaries i ∈ Ic , whereas
2. ∅ πc i for any patient i ∈ I \ Ic who is not a beneficiary.
Under a hard reserve system, only the beneficiaries of a preferred treatment category are
eligible for units in this category. This is the case, for example, in H-1B visa allocation
in the US.

4.1

Comparative Statics

Allocation rules based on sequential reserve matching are used in a wide range of
practical applications. While an aspect that is often ignored in practical applications, it
is important to pay attention to the choice of the order of precedence in these problems,
for it has potentially significant distributional implications. In this subsection we focus
on sequential reserve matching under soft reserves, as this case likely is the relevant case

23

for our main application of pandemic rationing.12
We already know from Proposition 2 that the later a category is processed, the less
competitive it becomes. A natural follow up question is whether this also means that the
beneficiaries of this category necessarily benefits from this comparative static exercise.
The answer would be of course straightforward, if each patient was a beneficiary of a
single category. But this is not the case in our model, because even if each patient
is a beneficiary of at most one preferential treatment category, they are also each a
beneficiary of the unreserved category. Indeed, even if that was not the case, unless
the reserves are hard non-beneficiaries may still be matched with units from preferential
treatment categories. So the answer to this question is not an immediate implication
of Proposition 2. Under some assumptions such as when there is only one preferential
treatment category (Dur, Kominers, Pathak, and Sönmez, 2018), this question is already
answered in the affirmative. However, as we present in the next example, this is not
always the case.
Example 1. Suppose there are q = 6 medical units to be allocated in total. There are six
categories: the unreserved category u and five preferential treatment categories c, c0 , c∗ , ĉ, c̃
and each category has a single unit capacity.
Suppose there are seven patients. All patients are beneficiaries of the unreserved
category u:
Iu = {i1 , i2 , i3 , i4 , i5 , i6 , i7 }.
The beneficiaries of preferential treatment categories c, c∗ , and c̃ are given as
Ic = {i1 , i3 , i6 },

Ic∗ = {i2 , i5 },

Ic̃ = {i4 , i7 },

while there are no beneficiaries of preferential treatment categories c0 and ĉ: Ic0 = ∅ and
Iĉ = ∅. There are also no general-community patients: Ig = ∅. Suppose π, the baseline
priority order of patients, is given as
i1 π i2 π i3 π i4 π i5 π i6 π i7 .
Also assume that all patients are eligible for all preferential treatment categories besides
the unreserved category u.
We consider two sequential reserve matchings based on the following two orders of
12

The case of hard reserves is much simpler to analyze, and it offers more general results. See Theorem
2 in an earlier version of this paper Pathak, Sönmez, Ünver, and Yenmez (2020).

24

precedence:
.:

c0 . c . c∗ . ĉ . c̃ . u,

and
.0 :

c .0 c0 .0 c∗ .0 ĉ .0 c̃ .0 u.

In the following table, we demonstrate the construction of the two induced sequential
reserve matchings by processing their mechanics in parallel:
Order of Precedence . Order of Precedence .0
Step

Category

Patient

Category

Patient

1
2
3
4
5
6

c0
c
c∗
ĉ
c̃
u

i1
i3
i2
i4
i7
i5

c
c0
c∗
ĉ
c̃
u

i1
i2
i5
i3
i4
i6

Thus the two sequential reserve matchings match the patients
ϕ. = {i1 , i2 , i3 , i4 , i5 , i7 }

and

ϕ.0 = {i1 , i2 , i3 , i4 , i5 , i6 }.

In this problem category-c0 and ĉ units are treated as if they are of unreserved category u,
as these two categories do not have any beneficiaries in the problem. We use the baseline
priority order π to match them.
Under the first order of precedence ., the highest π-priority patient i1 , who is also
a category-c beneficiary, receives the first unit, which is reserved for category c0 . As a
result, i3 , who is the next category-c beneficiary, receives the only category-c unit. In the
end, units associated with categories c∗ and c̃ are matched with their highest and lowest
priority beneficiaries i2 and i7 , respectively. The highest priority beneficiary of c̃, patient
i4 , receives the category-ĉ unit, which is processed like the unreserved category and before
c̃. Hence, the lowest priority beneficiary of category c, i6 remains unmatched as the last
unit, which is reserved for the unreserved category, goes to i5 . Thus,
ϕ. (Ic ) = {i1 , i3 }
is the set of matched category-c beneficiaries.
Under the second order of precedence .0 that switches the order of c and c0 , the selectivity of category c increases as it is processed earlier: the highest priority category-c
25

patient i1 receives its unit instead of i3 . This leads to the units associated with categories c∗ and c̃ being matched with their lowest and highest priority beneficiaries i5 and
i4 , respectively – this is a switch of roles for these categories with respect to .. This is
because the highest-priority beneficiary of c∗ , patient i2 , is now matched with category c0 ,
which is processed like the unreserved category before c∗ . This enables the lowest priority
beneficiary of category c, patient i6 , to be matched with the unreserved category as she is
prioritized higher than i7 under the baseline priority order. Hence,
ϕ.0 (Ic ) = {i1 , i3 , i6 }
is the set of matched category-c beneficiaries.
Thus,
ϕ. (Ic ) ( ϕ.0 (Ic )
although category c is processed earlier under .0 than under ..
Example 1 shows that earlier positive comparative static results in the literature fail
to extend in our more general model. Also observe that our negative example holds
even though each patient is a beneficiary of at most one preferential treatment category.
Nevertheless, a positive result holds for our main application of soft reserves provided
that there are at most five categories and each patient is a beneficiary of at most one
preferential treatment category. 13
Proposition 3. Assuming (i) there are at most five categories, and (ii) each patient is a
beneficiary of at most one preferential treatment category, consider a soft reserve system
induced by a baseline priority order. Fix a preferential treatment category c ∈ C \ {u},
another category c0 ∈ C \ {c}, and a pair of orders of precedence ., .0 ∈ ∆ such that:
• c0 . c,
• c .0 c0 , and
• for any ĉ ∈ C and c∗ ∈ C \ {c, c0 },
ĉ . c∗

⇐⇒

13

ĉ .0 c∗ .

Since the result fails to hold when there are six or more categories, a proof that relies on general
arguments does not exist for this result. Hence the proof of this result relies on a brute-force case
analysis. We present this (long) proof in Section B of the Supplementary Material. A much shorter
proof is available for at most four categories in an earlier version of this paper Pathak, Sönmez, Ünver,
and Yenmez (2020). A proof is presented for at most five categories for the sake of completeness.

26

That is, .0 is obtained from . by only changing the order of c with its immediate predecessor c0 . Then,
ϕ.0 (Ic ) ⊆ ϕ. (Ic ).

4.2

Smart Reserve Matching

Although virtually all practical applications of reserve systems are implemented through
sequential reserve matching, this class of mechanisms may suffer from an important shortcoming: they may lead to Pareto inefficient outcomes, due to myopic processing of reserves. The following example illustrates both how this may happen, and also motivates
a possible refinement based on smart processing of reserves.
Example 2. Consider a hard reserve system induced by baseline priority order π. There
are two patients I = {i1 , i2 } who are priority ordered as
i1 π i2
under the baseline priority order π. There are two categories; an unreserved category u
with an all-inclusive beneficiary set of I = {i1 , i2 }, and a preferential treatment category c
with a beneficiary set Ic = {i1 } of a single preferential treatment patient. Both categories
have a capacity of one unit each (i.e., rc = ru = 1). Since the reserves are hard, the
resulting category-specific priority orders are given as follows:
i1 πu i2 πu ∅

and

i1 πc ∅ πc i2 .

Consider the sequential reserve matching ϕ. induced by the order of precedence ., where
u . c.
Under matching ϕ. , first patient i1 is matched with the unreserved category u and subsequently the category-c unit is left idle since no remaining patient is eligible for this
preferential treatment category. Therefore,
ϕ. =

i1 i2
u ∅

!
,

resulting in the set of matched patients ϕ. (I) = {i1 }.
Next consider the sequential reserve matching ϕ.0 induced by the order of precedence
27

.0 , where
c .0 u.
Under matching ϕ.0 , first patient i1 is matched with the preferential treatment category c
and subsequently patient i2 is matched with the unreserved category u. Therefore,
ϕ.0 =

i1 i2
c u

!
,

resulting in the set of matched patients ϕ.0 (I) = {i1 , i2 }. Since ϕ. (I) ( ϕ.0 (I), matching
ϕ. is Pareto dominated by matching ϕ.0 .
Observe that Example 2 also illustrates that the cause of Pareto inefficiency is the
myopic allocation of categories under sequential reserve matchings. Under matching ϕ. ,
the more flexible unreserved unit is allocated to patient i1 who is the only beneficiary of
category-c. This results in a suboptimal utilizations of reserves, which can be avoided
with the concept of “smart reserve matching” we introduce below.
To this end, we first introduce a new axiom, which together with non-wastefulness
imply Pareto efficiency.
Definition 4. A matching µ ∈ M is maximal in beneficiary assignment if

µ ∈ arg max
ν∈M

[

ν −1 (c) ∩ Ic



.

c∈C\{u}

This axiom simply requires that the reserves should be maximally assigned to target
beneficiaries to the extent it is feasible. It precludes the myopic assignment of categories
to patients since the desirability of a matching depends on the structure of the matching
as a whole rather than the individual assignments it prescribes for each category.
It is worth noting that the inefficiency observed in Example 2 is specific to the case of
hard reserves and cannot happen for soft reserves, as in our main application of pandemic
rationing. Nonetheless, maximality in beneficiary assignment is a desirable axiom in
general including for soft reserves because sub-optimal utilization of reserves may receive
heightened scrutiny. For example, consider a scenario with two preferential treatment
categories, essential personnel and disadvantaged, each with one unit of reserve. Suppose
patient A is both essential personnel and disadvantaged, patient B is disadvantaged,
and there are several other patients who are neither. One possible way to use these
reserves is to assign patient A to the disadvantaged reserve, leaving no other preferential
28

treatment patients available for the essential personnel reserve. In this case, the essential
personnel reserve would be opened up to patients who are neither essential personnel
nor disadvantaged. This could in turn mean only one of the reserves is assigned to
members of the target beneficiary groups. This outcome could be seen problematic since
an alternative, which assigns patient A to the essential personnel reserve (instead of the
disadvantaged reserve) and patient B to the disadvantaged reserve, accommodates both
reserves. By imposing maximality in beneficiary assignment, we avoid this shortcoming
through a “smart” utilization of reserves.
Building on this insight, we next present an algorithm that generates smart cutoff
matchings:
Smart Reserve Matching Algorithm
Fix a parameter n ∈ {0, 1, . . . , ru } that represents the number of unreserved
units to be processed in the beginning of the algorithm.14 The remaining
unreserved units are to be processed at the end of the algorithm.
Fix a baseline priority order π, and for the ease of description relabel patients
so that
i1 π i2 π . . . π i|I| .
Proceed in two steps.
Step 1: Iteratively construct two sequences of patient sets J0u ⊆ J1u ⊆ . . . ⊆
u
J|I|
, which determine patients to be matched with the unreserved category
u in this step, and J0 ⊆ J1 ⊆ . . . ⊆ J|I| , which determine the patients to
be matched with preferential treatment categories in C \ {u} that they are
beneficiaries of, and a sequence of sets of matchings M0 ⊇ M1 ⊇ . . . ⊇ M|I|
in |I| substeps.
Define Step 1.(k) for any k ∈ {1, 2, . . . , |I|} as follows:
If k = 1, let
J0u = ∅,

J0 = ∅,

and M0 be the set of all matchings that are maximal in beneficiary assignment; that is
M0 = arg max ∪c∈C\{u} (ν −1 (c) ∩ Ic ) .
ν∈M
14

For n = 0, this algorithm is equivalent to the horizontal envelope algorithm in Sönmez and Yenmez
(2020).

29

u
If k > 1, then sets of patients Jk−1
and Jk−1 and set of matchings Mk−1 are
constructed in the previous substep, Step 1.(k − 1).

Step 1.(k): Process patient ik . Three cases are possible:
u
• If |Jk−1
| < n and there exists a matching in Mk−1 that
matches patient ik with the unreserved category u, then define
u
∪{ik },
Jku = Jk−1

Jk = Jk−1 ,


and Mk = µ ∈ Mk−1 : µ(ik ) = u .

• Otherwise, if there exists a matching in Mk−1 that matches
patient ik with a preferential treatment category c ∈ C \ {u}
that she is a beneficiary of, that is ik ∈ Ic , then define
u
Jku = Jk−1
,

Jk = Jk−1 ∪ {ik },

and


Mk = µ ∈ Mk−1 : µ(ik ) 6∈ {∅, u} and ik ∈ Iµ(ik ) .
• Otherwise, define
u
Jku = Jk−1
,

Jk = Jk−1 ,

and Mk = Mk−1 .

Step 2: For any matching µ ∈ M|I| , construct a matching σ ∈ M as follows:
u
• Assign µ(i) to every patient i ∈ J|I| ∪ J|I|
.
• One at a time iteratively assign the remaining units to the remaining
u
∪ J|I| ) who is eligible for the category
highest priority patient in I \ (J|I|
of the assigned unit in the following order:

1. the remaining units of the preferential treatment categories in an
arbitrary order, and
2. the remaining units of the unreserved category u.
Every matching σ constructed in this manner is referred to as a smart reserve
matching induced by assigning n unreserved units subsequently at the beginning of the
algorithm. Let MnS be the set of all reserve matchings for a given n.
We have the following result about the sets of patients matched under smart reserve
matchings:

30

Lemma 2. Consider either a soft reserve system or a hard reserve system induced by a
baseline priority order π. For any n ∈ {0, 1, . . . , ru } and any two smart reserve matchings
σ, ν ∈ MnS ,
σ −1 (u) = ν −1 (u), and ∪c∈C\{u} (σ −1 (c) ∩ Ic ) = ∪c∈C\{u} (ν −1 (c) ∩ Ic ),
and moreover,
σ(I) = ν(I).
Lemma 2 states that every smart reserve matching for a given n matches the same
set of patients with the unreserved category u, the same set of patients with preferential
treatment categories in C \ {u} that they are beneficiaries of, and the same set of patients
overall.
In a soft reserve system or a hard reserve system, for a given n, we denote the set
patients matched in every smart reserve matching with n unreserved units processed first
as ISn .15 By Lemma 2, for any σ ∈ MnS ,
ISn = σ(I).
Our second result on smart reserve matchings is as follows:
Proposition 4. Consider either a soft reserve system or a hard reserve system induced
by a baseline priority order π. For any n ∈ {0, 1, . . . , ru }, any smart reserve matching
in MnS complies with eligibility requirements, is non-wasteful, respects priorities, and is
maximal in beneficiary assignment.
The choice of parameter n is not without a consequence. In particular, matchings
produced by the algorithm with the lowest parameter n = 0 and the highest parameter
n = ru both have distinctive distributional consequences.
Theorem 3. Consider either a soft reserve system or a hard reserve system induced by a
baseline priority order π. Let σru ∈ MrSu be a smart reserve matching when all unreserved
units are assigned first (i.e., n = ru ) and σ0 ∈ M0S be a smart reserve matching when
all unreserved units are assigned last (i.e., n = 0). Then, for any cutoff equilibrium
matching µ ∈ M that is maximal in beneficiary assignment,
σr

µ

σ0

fu u π fu π fu .
15

We describe a polynomial-time algorithm to construct ISn and a smart reserve matching in Section
C of the Supplemental Material.

31

Theorem 3 states that among all maximum equilibrium cutoff vectors that support
maximal matchings in beneficiary assignment, the selectivity of the unreserved category
is
• the most competitive for smart reserve matchings with n = ru , that is, when all
unreserved category units are assigned in the beginning of the algorithm, and
• the least competitive for smart reserve matchings with n = 0, that is, when all
unreserved category units are assigned at the end of the algorithm.
Theorem 3 is silent about the qualifications of maximum equilibrium cutoffs of preferential treatment categories supporting smart reserve matchings. While keeping the maximality in beneficiary assignment, the patients who are matched with preferential treatment categories are uniquely determined under the two extreme smart reserve matchings
(and for any given n), respectively. However, there can be multiple ways of assigning
these patients to different preferential treatment categories. Thus, the maximum equilibrium cutoffs of preferential treatment categories are not uniquely determined for these
matchings.

4.3

Related Theoretical Literature

Our study of reserve systems contributes to literature in matching market design
focused on distributional issues. Our main results of Theorems 1-3 as well as Propositions
1 and 2 have no antecedents in the literature. In contrast, Propositions 3 and 4 extend
previously known ideas to our model.
While Theorem 1 is novel and our paper is the first one to formally introduce the
notion of cutoff equilibrium for reserve systems, the use of this notion is widespread in
real-life applications of reserve systems. In particular, the outcomes of reserve systems
are often announced together with the cutoffs that support them. Examples include
admission to exam high schools in Chicago (Dur, Pathak, and Sönmez, 2020), assignment of government positions in India (Sönmez and Yenmez, 2019) college admissions
in Brazil (Aygün and Bo, 2020), and H-1B visa allocation in the US for years 2006-2008
(Pathak, Rees-Jones, and Sönmez, 2020). For the first three of these applications the
cutoffs are given in terms of exam or merit scores, whereas for the last application the
cutoffs are given in terms of the date of visa application receipt. While the concept of
cutoff equilibrium for reserve systems is novel to our paper, cutoffs are used in simpler
matching environments in the absence of distributional considerations (see, e.g., Balinski
and Sönmez (1999) and Azevedo and Leshno (2016)).
In addition to presenting a characterization of outcomes that satisfy three basic ax32

ioms, Theorem 2 also provides a procedure to calculate all cutoff matchings. While our
characterization itself is novel, the use of the deferred acceptance algorithm to derive a
specific cutoff matching is not. This technique to obtain cutoff levels for reserve systems
has been employed in various real-life applications, including in school choice algorithms
of Boston Public Schools (Dur, Kominers, Pathak, and Sönmez, 2018) and Chile (Correa
et al., 2019), and college admissions algorithm for Engineering Colleges in India (Baswana
et al., 2019).
Our characterizations in Theorems 1 and 2 use three simple axioms. As such, the
resulting matchings can fail to be Pareto efficient in some applications. This failure has to
do with rather mechanical and inflexible assignment of agents to categories as presented
by Example 2. This can be mitigated by filling reserves in a “smart” way. The class of
smart reserve matching algorithms in Section 4.2 does precisely this and through maximal
utilization of reserves always generates a Pareto efficient matching. The smart reserve
matching algorithm is a generalization of the horizontal envelope algorithm introduced
by Sönmez and Yenmez (2020) under exclusively “minimum guarantee” type reserves.
Moreover, for n = 0 the smart reserve matching algorithm becomes equivalent to the
horizontal envelope algorithm.
Of the two analytical results that extend previously known ideas in the literature,
Proposition 3 extends the comparative static results of Dur, Kominers, Pathak, and
Sönmez (2018), Dur, Pathak, and Sönmez (2020), and Pathak, Rees-Jones, and Sönmez
(2020). What is perhaps more novel is Example 1, which shows that the comparative
static exercise in Proposition 3 fails to hold once there are more than five categories.
Another implication of this situation is that the proof of Proposition 3 is considerably
more involved than its predecessors. Proposition 4, on the other hand, extends the
analysis on horizontal envelope algorithm in Sönmez and Yenmez (2020) to the more
general smart reserve matching algorithm.
In addition to above described papers which directly relate to our analysis, there are
also several others that have examined allocation in the presence of various distributional
constraints such as minimum-guarantee reserves (or lower quotas), upper quotas, and
regional quotas. Some of the most related ones include Abdulkadiroğlu (2005), Biro,
Fleiner, Irving, and Manlove (2010), Kojima (2012), Budish, Che, Kojima, and Milgrom
(2013), Hafalir, Yenmez, and Yildirim (2013), Westkamp (2013), Ehlers, Hafalir, Yenmez,
and Yildirim (2014), Echenique and Yenmez (2015), Kamada and Kojima (2015, 2017,
2018), Bo (2016), Doğan (2016), Kominers and Sönmez (2016), Fragiadakis and Troyan
(2017), Combe (2018), Ehlers and Morrill (2019), and Aygün and Turhan (2020).

33

Our paper also introduces the medical rationing into the market design literature.
By considering a real-world resource allocation problem, we contribute to the study of
formal properties of specific allocation processes in the field and the study of alternative mechanisms. Studies in this vein include those on entry-level labor markets (Roth
and Peranson, 1999), school choice (Abdulkadiroğlu and Sönmez, 2003; Balinski and
Sönmez, 1999), spectrum auctions (Milgrom, 2000), kidney exchange (Roth, Sönmez,
and Ünver, 2004), internet auctions (Edelman, Ostrovsky, and Schwarz, 2007; Varian,
2007), assignment of airport arrival slots (Schummer and Abizada, 2017; Schummer and
Vohra, 2013), refugee resettlement (Andersson, 2019; Delacrétaz, Kominers, and Teytelboym, 2019; Jones and Teytelboym, 2017), and teacher assignment (Combe, Tercieux,
and Terrier, 2020).

5

Epilogue: Preliminary Policy & Practice Impact

As far as we know, reserve systems have not been part of pandemic rationing of
medical resources prior to the COVID-19 pandemic. Following the circulation of our
earlier working paper, Pathak, Sönmez, Ünver, and Yenmez (2020), and our subsequent
interaction with various interdisciplinary groups and public health officials, a reserve
system has now been recommended or adopted in a number of settings. We briefly report
on some of these examples. Since these systems are evolving, we provide additional details
at http://www.covid19reservesystem.org.16

5.1

NASEM Framework for Equitable Vaccine Allocation

In July 2020, the U.S. CDC and NIH commissioned the National Academies of Sciences, Engineering, and Medicine (NASEM) to formulate recommendations on the equitable allocation of COVID-19 vaccines. NASEM’s committee of distinguished experts
solicited public comments on a discussion draft of their Framework for Equitable Allocation of COVID-19 Vaccine in September 2020 (NASEM, 2020a). In written and oral
comments, Professor Harald Schmidt inquired about the mechanism to prioritize members of hard-hit communities and described his work explaining how the reserve system
is a promising method (Schmidt, 2020). Around the same time, Persad, Peek, and Emmanuel (2020) advocated for a reserve system in JAMA. They described a reserve system
as a “categorized priority system,” writing:
16

Basic design considerations depending on rationed resource are explained in Section D of the Supplemental Material.

34

“Dividing the initial vaccine allotment into priority access categories and using medical criteria to prioritize within each category is a promising approach. For instance,
half of the initial allotment might be prioritized for frontline health workers, a quarter for people working or living in high-risk settings, and the remainder for others.
Within each category, preference could be given to people with high-risk medical
conditions. Such a categorized approach would be preferable to the tiered ordering previously used for influenza vaccines, because it ensures that multiple priority
groups will have initial access to vaccines.”
In October 2020, NASEM published their final Framework and recommended a 10
percent reserve for hard-hit areas, where hard-hit is measured by the CDC’s Social Vulnerability Index (SVI). Their stated justification emphasized the flexibility of a reserve
system (NASEM, 2020b):
“The committee does not propose an approach in which, within each phase, all
vaccine is first given to people in high SVI areas. Rather the committee proposes
that the SVI be used in two ways. First as previously noted, a reserved 10 percent
portion of the total federal allocation of COVID-19 vaccine may be reserved to target
areas with a high SVI (defined as the top 25 percent of the SVI distribution within
the state).”
NASEM’s recommendations together with those from the CDC’s Advisory Committee on Immunization Practices were provided to states, who are in charge of vaccine
distribution within state. As of December 2020, Operation Warp Speed has allocated
initial doses of Pfizer and Moderna vaccine to state, tribal, local and territorial public health agencies in proportion to their population. At least three states, Tennessee,
Massachusetts, and New Hampshire followed NASEM’s recommendation and announced
their decision to adopt a reserve system for COVID-19 vaccine allocation. In all three
states a fraction of vaccines are reserved for people in high SVI areas, and in Tennessee
an additional fraction is reserved to be allocated equally between all counties. Schmidt et
al. (2020) report that California, Indiana, Louisiana, Michigan, North Dakota, and Ohio
will also integrate the use of SVI or a similar index of disadvantage in their COVID-19
vaccine allocation plans, although these states have not specified whether they will do so
through a reserve system or in an alternative way.

5.2

State Vaccine Allocation Plans Using a Reserve System

In October 2020, Tennessee became the first state that has announced its plan to use
a reserve system for COVID-19 vaccine allocation (Tennessee DH, 2020a). The interim
35

plan by the Tennessee Department of Health included the following reserve categories:
• 5% of the State’s allocation of COVID-19 vaccines will be distributed equitably
among all 95 counties.
• 10% of the State’s allocation of COVID-19 vaccines will be reserved by the State
for use in targeted areas with high vulnerability to morbidity and mortality from
the virus.
• 85% of the State’s allocation of COVID-19 vaccines will be distributed among all
95 counties based upon their populations.
Subsequently, the reserve sizes were revised for each specific COVID-19 vaccine in response to the differences in various features of these vaccines (Tennessee DH, 2020b).
In December 2020, Massachusetts released their vaccine allocation plan (Massachusetts
DPH, 2020a). The plan describes that 20% of vaccines will be reserved for communities
that have experienced disproportionate COVID-19 burden and high social vulnerability.
The state will use an over-and-above implementation, allocating additional units to hardhit areas (Biddinger, 2020). Within community, the allocation is to be based on Phase
prioritization.
In January 2021, New Hampshire also released the state’s vaccine allocation plan
(New Hampshire DHHS, 2021). Under the plan, 10% of vaccines will be reserved for
communities that have experienced disproportionate COVID-19 burden and high social
vulnerability.

5.3

Reserve System for Allocation of Therapeutic Agents

On November 21, 2020, the FDA granted an emergency use authorization (EUA) for
monoclonal antibody treatments (including bamlanivimab, casirivimab and imdevimab).
The Massachusetts Department of Public Health assembled a committee of infectious
disease specialists, emergency physicians, community health center representatives, and
ethicists to advise on equitable public health strategies to allocate the doses delivered
to Massachusetts. A committee member inquired about whether our proposed reserve
system can be used for equitable allocation and if so how it can be operationalized
in practice.17 Their December guideline recommended the use of a reserve system for
within-hospital allocation (Massachusetts DPH, 2020b).
In the system, units are infusion spots to be allocated by hospitals. Since the EUA
requires a short window between a positive COVID-19 test result and administration of
17
In addition to providing the committee with conceptual and technical support in their design, our
group also provided the committee with a software. Details can be seen in the following website:
http://www.covid19reservesystem.org.

36

therapy, the interval of allocation is set at either once or twice a day. Patients are in
placed into two tiers: (1) patients who are age ≥ 65 and patients aged 18 and older with
BMI ≥ 35, and (2) all other patients eligible under the EUA.
At each interval, there are two serial allocations for infusion spots. The first allocation
of 80% of available doses will be open to all identified patients entered into the allocation
system, known as the “open allocation” (Massachusetts DPH, 2020b). The second allocation of 20% of available doses are available to patients who live in a census tract with
SVI > 50% or in a city or town with a 7-day average COVID-19 incidence rate in the top
quartile as reported in the most recent MA DPH weekly COVID report (“hardest-hit”)
For the open 80%, allocation takes place in order of tier, with lottery tie-breaking within
tier. For the 20% reserve, allocation is first for patients from hardest-hit areas. For these
patients, allocation takes place in order of tier, with lottery tie-breaking within tier. If
units remain in the 20% reserve, then they are allocated to patients who are eligible for
open units in order of tier, with lottery tie-breaking.

6

Conclusion

Because of the anticipated and ongoing shortage of key medical resources during
public health emergencies, several leaders in the medical ethics community have made
important recommendations regarding medical rationing. These recommendations reflect
compromises between several ethical principles – maximizing lives, maximizing life-years,
life-cycle considerations, instrumental values, reciprocity, protecting to the sickest, and
non-exclusion. We have argued that a reserve system offers additional flexibility to
balance competing objectives.
Prior to our paper the theory of reserve systems was limited to the case where all
priorities are derived from a baseline priority order favoring various groups at different
reserve categories. As our conceptual and technical contributions, we
• presented a general theory of reserve systems characterizing a new solution concept,
the cutoff equilibria, via three basic axioms widespread in real-life applications,
• provided a procedure to find all cutoff equilibria,
• analyzed sequential reserve matching procedures, the dominant form of reserve
systems in real-life applications, and
• proposed “smart reserve matching” procedures to overcome some potential shortcomings of these procedures.
Aside from our main motivation of pandemic rationing, our results can be directly
applied to several other resource allocation problems given the broad generality of our
37

model. These include immigration visa allocation in the United States (Pathak, ReesJones, and Sönmez, 2020), affirmative action in school choice systems in Boston, Chicago,
New York City and Chile (Correa et al., 2019; Dur, Kominers, Pathak, and Sönmez, 2018;
Dur, Pathak, and Sönmez, 2020), affirmative action for public school and government
positions in India (Aygün and Turhan, 2020; Baswana et al., 2019; Sönmez and Yenmez,
2019) and diversity plans for college admissions in Brazil (Aygün and Bo, 2020). We
leave explorations of these connections to future research.
Within a short period after the circulation of the first version of our paper in April
2020, our proposed reserve system started receiving strong support from various groups in
bioethics, public health, and clinical care medicine. We reported the preliminary policy
impact of our paper in Section 5. We hope that our proposed reserve system we will rarely
be deployed in its pandemic resource allocation applications. However, even if rationing
guidelines are rarely applied, their mere existence reflects a statement of values. Several
aspects of the design, including those related to essential personnel, disadvantaged and
disabled communities, adults and children run the risk of upsetting social harmony. For
example, Fink (2020) describes a risk with poorly designed systems excluding certain
principles: “at the end you have got a society at war with itself. Some people are going
to be told they don’t matter enough.” We have shown that a reserve system provides
policy makers with an additional tool to navigate these complex challenges.

References
Abdulkadiroğlu, A. (2005). “College Admissions with Affirmative Action.” International
Journal of Game Theory, 33 (4), 535–549.
Abdulkadiroğlu, A. and T. Sönmez (2003). “School Choice: A Mechanism Design Approach.” American Economic Review, 93, 729–747.
Andersson, T. (2019). “Refugee Matching as a Market Design Application.” Future of
Economic Design. Ed. by J.-F. Laslier, H. Moulin, M. Sanver, and W. Zwicker.
Springer, pp. 445–450.
Aygün, O. and I. Bo (2020). “College Admission with Multidimensional Reserves: The
Brazilian Affirmative Action Case.” AEJ: Microeconomics, forthcoming.
Aygün, O. and B. Turhan (2020). “Dynamic Reserves in Matching Markets.” Journal of
Economic Theory, 188, 1050–1069.
Azevedo, E. and J. Leshno (2016). “A Supply and Demand Framework for Two-Sided
Matching Markets.” Journal of Political Economy, 124(5), 1235–1268.

38

Balinski, M. and T. Sönmez (1999). “A Tale of Two Mechanisms: Student Placement.”
Journal of Economic Theory, 84, 73–94.
Baswana, S., P. P. Chakrabarti, S. Chandran, Y. Kanoria, and U. Patange (2019). “Centralized admissions for engineering colleges in India.” 49, 307–396, C3.
Bateman, S., M. Bharel, P. Biddinger, et al. (2020). “Crisis Standards of Care Planning
Guidance for the COVID-19 Pandemic.” April 7.
Biddinger, P. (2020). “Interview.” Conducted on December 18.
Biro, P., T. Fleiner, R. Irving, and D. Manlove (2010). “The College Admissions Problem
with Lower and Common Quotas.” Theoretical Computer Science, 411 (34-26), 3136–
3153.
Bo, I. (2016). “Fair Implementation of Diversity in School Choice.” Games and Economic
Behavior, 97, 54–63.
Budish, E., Y.-K. Che, F. Kojima, and P. R. Milgrom (2013). “Designing Random Allocation Mechanisms: Theory and Applications.” American Economic Review, 103 (2),
585–623.
CDC (2018). “Interim Planning Guidance on Allocating and Targeting Pandemic Influenza Vaccine During an Influenza Pandemic.” Centers for Disease Control, Available at: https://www.cdc.gov/flu/pandemic-resources/pdf/2018-InfluenzaGuidance.pdf, Last accessed: July 1, 2020.
Combe, J. (2018). “Are Affirmative Action Policies so Impossible?” Revue d’Economie
Politique, 128 (6), 1123–1173.
Combe, J., O. Tercieux, and C. Terrier (2020). The Design of Teacher Assignment: Theory
and Evidence. Working Paper.
Correa, J., R. Epstein, J. Escobar, et al. (2019). “School Choice in Chile.” Proceedings
of the 2019 ACM Conference on Economics and Computation. EC ’19. Phoenix, AZ,
USA: ACM, pp. 325–343.
Daugherty-Biddison, L., H. Gwon, A. Regenberg, M. Schoch-Spana, and E. Toner (2017).
“Maryland Framework for the Allocation of Scarce Life-Sustaining Medical Resources
in a Catastrophic Public Health Emergency.” https://www.law.umaryland.edu/
media/SOL/pdfs/Programs/Health-Law/MHECN/ASR%20Framework_Final.pdf.
Delacrétaz, D., S. D. Kominers, and A. Teytelboym (2019). “Matching Mechanisms for
Refugee Resettlement.” Working paper.
DHS, A. (2020). “Covid-19 Addendum: Allocation of Scarce Resources in Acute Care
Facilities.” Arizona Department of Health Services, June 6, Available: http://azpha.
wildapricot.org/resources/covid-19-addendum.pdf. Last accessed: July 4, 2020.
39

Dittmar, P. (2018). “Gender Quotas - Balancing Act Between Efficient Policies and Gap
Fillers.” EU-Logos Athena.
Doğan, B. (2016). “Responsive Affirmative Action in School Choice.” Journal of Economic Theory, 165, 69–105.
DPH (2020). “Crisis Standards of Care Planning Guidance for the Covid-19 Pandemic.”
April 7, Available at: https://d279m997dpfwgl.cloudfront.net/wp/2020/04/CSC April7 2020.pdf.
Ducharme, J. (2020). “Melinda Gates Lays out her Biggest Concern for the Next Phase
of the Covid-19 Pandemic.” Time Magazine, June 4.
Dur, U., S. Kominers, P. A. Pathak, and T. Sönmez (2018). “Reserve Design: Unintended Consequences and The Demise of Boston’s Walk Zones.” Journal of Political
Economy, 126, 2457–2479.
Dur, U., P. A. Pathak, and T. Sönmez (2020). “Explicit vs. Statistical Preferential Treatment in Affirmative Action: Theory and Evidence from Chicago’s Exam Schools.”
Journal of Economic Theory, 187, 104996.
Echenique, F. and M. B. Yenmez (2015). “How to Control Controlled School Choice.”
American Economic Review, 105 (8), 2679–2694.
Edelman, B., M. Ostrovsky, and M. Schwarz (2007). “Internet Advertising and the Generalized Second-Price Auction: Selling Billions of Dollars Worth of Keywords.” American Economic Review, 97(1), 242–259.
Ehlers, L., I. E. Hafalir, M. B. Yenmez, and M. A. Yildirim (2014). “School Choice
with Controlled Choice Constraints: Hard Bounds versus Soft Bounds.” Journal of
Economic Theory, 153, 648–683.
Ehlers, L. and T. Morrill (2019). “(Il)legal Assignments in School Choice.” The Review
of Economic Studies, 87 (4), 1837–1875.
Emanuel, E. J., G. Persad, R. Upshur, et al. (2020). “Fair Allocation of Scarce Medical
Resources in the Time of Covid-19.” New England Journal of Medicine, March 23.
Fink, S. (2020). “U.S. Civil Rights Office Rejects Rationing Medical Care Based on
Disability, Age.” New York Times, March 29.
Fragiadakis, D. and P. Troyan (2017). “Improving Matching under Hard Distributional
Constraints.” Theoretical Economics, 12 (2), 863–908.
Gale, D. and L. S. Shapley (1962). “College Admissions and the Stability of Marriage.”
69, 9–15.
Hafalir, I. E., M. B. Yenmez, and M. A. Yildirim (2013). “Effective Affirmative Action
in School Choice.” Theoretical Economics, 8 (2), 325–363.
40

Hopcroft, J. E. and R. M. Karp (1973). “An n5/2 algorithm for maximum matchings in
bipartite graphs.” SIAM Journal on Computing, 2, 225–231.
Jones, A. E., S. Trzeciak, and J. A. Kline (2009). “The Sequential Organ Failure Assessment score for predicting outcome in patients with severe sepsis and evidence
of hypoperfusion at the time of emergency department presentation.” Critical Care
Medicine, 37 (5), 1649–1654.
Jones, W. and A. Teytelboym (2017). “The Local Refugee Match: Aligning Refugees’
Preferences with the Capacities and Priorities of Localities.” Journal of Refugee Studies, 31(2), 152–178.
Kamada, Y. and F. Kojima (2015). “Efficient Matching under Distributional Constraints:
Theory and Applications.” American Economic Review, 105 (1), 67–99.
Kamada, Y. and F. Kojima (2017). “Stability Concepts in Matching with Distributional
Constraints.” Journal of Economic Theory, 168, 107–142.
Kamada, Y. and F. Kojima (2018). “Stability and Strategy-proofness for Matching with
Constraints: A Necessary and Sufficient Condition.” Theoretical Economics, 13 (2),
761–794.
Karzanov, A. V. (1973). “An exact estimate of an algorithm for finding a maximum flow,
applied to the problem on representatives.” Problems in Cybernetics, 5, 66–70.
Kinlaw, K and R Levine (2007). “Ethical Guidelines in Pandemic Influenza: Recommendations of the Ethics Subcommittee of the Advisory Committee to the Director.”
Centers for Disease Control and Prevention.
Kojima, F. (2012). “School Choice: Impossibilities for Affirmative Action.” Games and
Economic Behavior, 75 (2), 685–693.
Kominers, S. D. and T. Sönmez (2016). “Matching with Slot-specific Priorities: Theory.”
Theoretical Economics, 11 (2), 683–710.
Kuhn, H. W. (1955). “The Hungarian Method for the assignment problem.” Naval Research Logistics Quarterly, 2, 83–97.
Lee, T. (2004). “Rationing Influenza Vaccine.” New England Journal of Medicine, 351(23).
Massachusetts DPH (2020a). “MA Covid-19 Vaccine Presentation.” December 9, https:
//www.mass.gov/doc/ma-covid-19-vaccine-presentation-1292020/download.
Massachusetts DPH (2020b). “Massachusetts Department of Public Health Guidance for
Allocation of Covid-19 Monoclonal Antibody Therapeutics.” November 27, https:
//www.mass.gov/doc/guidance- for- allocation- of- covid- 19- monoclonalantibody-therapeutics/download.

41

McCaughey, B. (2020). “The lunatic drive for racial quotas for COVID-19 vaccines.” New
York Post, July 16.
Mendelsohn, N. S. and A. L. Dulmage (1958). “Some generalizations of the problem of
distinct representatives.” Canadian Journal of Mathematics, 10, 230–241.
Milgrom, P. R. (2000). “Putting Auction Theory to Work: The Simultaneous Ascending
Auction.” Journal of Political Economy, 108, 245–272.
NASEM (2020a). “A Framework for Equitable Allocation of Vaccine for the Novel Coronavirus.” https://www.nap.edu/resource/25917/25914.pdf.
NASEM (2020b). “A Framework for Equitable Allocation of Vaccine for the Novel Coronavirus.” https://www.nationalacademies.org/our- work/a- framework- forequitable-allocation-of-vaccine-for-the-novel-coronavirus.
Ne’eman, A. (2020). “I Will Not Apologize for My Needs.” New York Times, March 23.
New Hampshire DHHS (2021). “COVID-19 Vaccine Training for Community Leaders.”
January, https : / / www . dhhs . nh . gov / dphs / cdcs / covid19 / documents / covid vaccine-comm-leader-training.pdf.
Pathak, P. A., A. Rees-Jones, and T. Sönmez (2020). “Immigration Lottery Design:
Engineered and Coincidental Consequences of H-1B Reforms.” NBER Working Paper
26767.
Pathak, P. A., T. Sönmez, M. U. Ünver, and B. Yenmez (2020). “Leaving No Ethical
Value Behind: Triage Protocol Design for Pandemic Rationing.” NBER Working Paper 26951.
Persad, G., M. E. Peek, and E. Emmanuel (2020). “Fairly Prioritizing Groups for Access
to Covid-19 Vaccines.” JAMA, 324(16), 1601–1602.
Piscitello, G. M., W. D. Miller, E. M. Kapania, et al. (2020). “Systematic Review of
the Variation in U.S. State Ventilator Allocation Guidelines during a Public Health
Crisis.” JAMA-Network Open.
Prehn, A. W. and D. Vawter (2008). “Ethical Guidance for Rationing Scarce HealthRelated Resources in a Severe Influenza Pandemic: Literature and Plan Review.”
Minnesota Pandemic Ethics Project.
Pu Kamp, M. de, C. Devine, and D. Griffin (2020). “As coronavirus cases grow, hospitals
adopt a system to rank patients for treatment.” CNN, April 3, https://www.cnn.
com/2020/04/03/health/coronavirus- hospital- ethics- ventilators- invs/
index.html.
Rankin, J. (2020). “EU revises plans for mandatory quotas of women on company
boards.” The Guardian, March 5.
42

Roth, A. E. and E. Peranson (1999). “The Redesign of the Matching Market for American
Physicians: Some Engineering Aspects of Economic Design.” American Economic
Review, 89, 748–780.
Roth, A. E., T. Sönmez, and M. U. Ünver (2004). “Kidney Exchange.” Quarterly Journal
of Economics, 119, 457–488.
Schmidt, H. (2020). “Vaccine Rationing and the Urgency of Social Justice in the Covid-19
Response.” Hastings Center Report, 50: 1-4.
Schmidt, H., R. Weintraub, M. A. Williams, et al. (2020). “Equitable Allocation of
COVID-19 Vaccines: An Analysis of the Initial Allocation Plans of CDC’s Jurisdictions with Implications for Disparate Impact Monitoring.” December 3, SSRN.
Schoch-Spana, M., J. Fitzgerald, B. R. Kramer, and U. T. Force (2005). “Implications
for Biosecurity and Public Health Preparedness.” Biosecurity and Bioterrorism, 3(3).
Schrijver, A. (2003). Combinatorial Optimization: Polyhendra and Efficiency. Vol. A.
Springer.
Schummer, J. and A. Abizada (2017). “Incentives in Landing Slot Problems.” Journal of
Economic Theory, 170, 29–55.
Schummer, J. and R. V. Vohra (2013). “Assignment of Arrival Slots.” American Economic
Journal: Microeconomics, 5(2), 164–185.
Sönmez, T. and M. B. Yenmez (2019). “Affirmative Action in India via Vertical and
Horizontal Reservations.” Boston College Working Paper 977.
Sönmez, T. and M. B. Yenmez (2020). “Affirmative Action with Overlapping Reserves.”
Boston College Working Paper 990.
Tennessee DH (2020a). “Covid-19 Vaccination Plan.” Version 1.0, October 16, https:
/ / www . cdc . gov / vaccines / covid - 19 / downloads / tennessee - jurisdiction executive-summary.pdf.
Tennessee DH (2020b). “Covid-19 Vaccination Plan.” Version 3.0, December 30, https:
//www.tn.gov/content/dam/tn/health/documents/cedep/novel-coronavirus/
COVID-19_Vaccination_Plan.pdf.
Truog, R. D., C. Mitchell, and G. Q. Daley (2020). “The Toughest Triage – Allocating
Ventilators in a Pandemic.” New England Journal of Medicine, March 23.
Twohey, M. (2020). “Who should get coronavirus vaccine first? U.S. considers race in a
Coronavirus Plans.” New York Times, July 9.
Varian, H. R. (2007). “Position Auctions.” International Journal of Industrial Organization, 25(6), 1163–1178.

43

Vawter, D. E., J. E. Garrett, K. G. Gervais, et al. (2010). “For the Good of Us All:
Ethically Rationing Health Resources in Minnesota in a Severe Influenza Pandemic.”
Minnesota Pandemic Ethics Project, Minnesota Department of Health.
Vincent, J. L., R. Moreno, J. Takala, et al. (1996). “The SOFA (Sepsis-related Organ
Failure Assessment) score to describe organ dysfunction/failure. On behalf of the
Working Group on Sepsis-Related Problems of the European Society of Intensive
Care Medicine.” Intensive Care Medicine, 22 (7), 707–710.
Westkamp, A. (2013). “An Analysis of the German University Admissions System.” Economic Theory, 53 (3), 561–589.
White, D., M. Schmidhofer, E. McCreary, et al. (2020). “Model Hospital Policy for Fair
Allocation of Medications to Treat Covid-19.” University of Pittsburgh, Department
of Critical Care Medicine, Available at: https://www.ccm.pitt.edu/?q=content/
model-hospital-policy-fair-allocation-medications-treat-covid-19. Last
accessed: July 4, 2020.
White, D. B., M. H. Katz, J. M. Luce, and B. Lo (2009). “Who Should Receive Life
Support During a Public Health Emergency? Using Ethical Principles to Improve
Allocation Decisions.” Annals of Internal Medicine, 150(2), 132–138.
WHO (2007). “Ethical considerations in developing a public health response to pandemic
influenza.” Available at: http://www.who.int/csr/resources/publications/WHO_
CDS_EPR_GIP_2007_2/en/index.html.
Whyte, L. E. (2020). “State Policies May Send People with Disabilities to the Back
of the Line for Ventilators.” April 8, https : / / publicintegrity . org / health /
coronavirus - and - inequality / state - policies - may - send - people - with disabilities-to-the-back-of-the-line-for-ventilators/.
Zucker, H. A., K. P. Adler, D. P. Berens, et al. (2015). “Ventilator Allocation Guidelines.”
New York State Task Force on Life and the Law, New York Department of Health.

44

Appendices for Online Publication
A
A.1

Proofs
Proofs of Results in Section 3

Proof of Theorem 1.
Part 1. Suppose matching µ ∈ M complies with eligibility requirements, is non-wasteful,
and respects priorities. We construct a cutoff vector f ∈ F as follows: For each category
c ∈ C, define
(
minπc µ−1 (c)
if |µ−1 (c)| = rc ,
fc =
∅
otherwise.
Fix a category c ∈ C. If |µ−1 (c)| = rc then fc ∈ µ−1 (c) by construction. Since µ complies
with eligibility requirements, then fc πc ∅. On the other hand, if |µ−1 (c)| < rc , then
fc = ∅. Therefore, in either case fc π c ∅. We showed that f ∈ F, i.e., it is a well-defined
cutoff vector.
Next, we show that (f, µ) is a cutoff equilibrium. Condition 2 in cutoff equilibrium
definition is immediately satisfied because if for any c ∈ C, |µ−1 (c)| < rc , then fc = ∅ by
construction.
We next show that Condition 1 in cutoff equilibrium definition is also satisfied in two
parts. Let i ∈ I.
(a) We show that µ(i) ∈ Bi (f ) ∪ {∅}. If µ(i) = ∅ then we are done. Therefore, suppose
µ(i) = c for some c ∈ C. Two cases are possible:
– If |µ−1 (c)| = rc , then fc = minπc µ−1 (c), and hence i π c fc . Thus, c ∈ Bi (f ).
– If |µ−1 (c)| < rc , then fc = ∅ by construction. Since µ complies with eligibility
requirements, i πc fc = ∅. Thus, µ(i) ∈ Bi (f ).
(b) We show that Bi (f ) 6= ∅ =⇒ µ(i) ∈ Bi (f ). Suppose Bi (f ) 6= ∅; but to the contrary
of the claim, suppose that µ(i) 6∈ Bi (f ). By Condition 1(a) in the definition of a
cutoff equilibrium, µ(i) = ∅. Let c ∈ Bi (f ). Since µ respects priorities, then for
every j ∈ µ−1 (c) we have j πc i. If |µ−1 (c)| = rc , then by construction, fc ∈ µ−1 (c),
and hence, fc πc i, contradicting c ∈ Bi (f ). We conclude that |µ−1 (c)| < rc . Then
by construction, fc = ∅. Since c ∈ Bi (f ), i πc fc = ∅. These two statements
together with µ(i) = ∅ contradict non-wastefulness of µ. Thus, µ(i) ∈ Bi (f ).
Hence, we showed that (f, µ) is a cutoff equilibrium.

45

Part 2. Conversely, suppose pair (f, µ) ∈ F × M is a cutoff equilibrium. We will show
that matching µ complies with eligibility requirements, is non-wastefulness, and respects
priorities.
Compliance with eligibility requirements: Consider a patient i ∈ I. Since by Condition
1(a) of cutoff equilibrium definition µ(i) 6= ∅ implies µ(i) ∈ Bi (f ), we have i π c fc . Since
the cutoff satisfies fc π c ∅, by transitivity of πc , i πc ∅. Therefore, µ complies with
eligibility requirements.
Non-wastefulness: Let i ∈ I be such that µ(i) = ∅ and i πc ∅ for some c ∈ C. We show
that |µ−1 (c)| = rc . Then by Condition 1(a) of the definition of a cutoff equilibrium for
(f, µ), we have Bi (f ) = ∅. In particular c ∈
/ Bi (f ). Then fc πc i, implying that fc πc ∅
−1
and hence |µ (c)| = rc . Thus, µ is non-wasteful.
Respect of Priorities: Let patient i ∈ I be such that for some category c ∈ C, µ(i) = c
while for some patient j ∈ I, µ(j) = ∅. We show that i πc j, which will conclude
that matching µ respects priorities. By Condition 1(b) of cutoff equilibrium definition,
Bj (f ) = ∅. In particular, fc πc j. Since µ(i) = c, by Condition 1(a) of cutoff equilibrium
definition, c ∈ Bi (f ), implying that i π c fc . By transitivity of πc , i πc j.
Proof of Lemma 1. We prove the lemma in three claims. Let matching µ ∈ M
comply with eligibility requirement, be non-wasteful, and respect priorities.
µ

µ

Claim 1. f is the maximum equilibrium cutoff vector supporting µ, i.e., (f , µ) is a
µ
cutoff equilibrium and for every cutoff equilibrium (f, µ), f c π c fc for every c ∈ C.
Proof. We prove the claim in two parts.
µ
Part 1.We show that (f , µ) is a cutoff equilibrium:
µ
We restate the definition of f given in Equation (1) in the main text: For every
c ∈ C,
(
µ
fc

=

minπc µ−1 (c) if |µ−1 (c)| = rc
.
∅
otherwise

µ

By this definition f ∈ F. Moreover, Condition 2 in the definition of a cutoff equilibrium
is trivially satisfied.
We show that Condition 1(a) holds next. Let i ∈ I. If µ(i) = ∅ then Condition 1(a)
is satisfied for i. Suppose µ(i) = c for some c ∈ C. We have i π c minπc µ−1 (c). Moreover
µ
i πc ∅, as µ complies with eligibility requirements. Thus, i π c f c ∈ {∅, minπc µ−1 (c)}, and
µ
hence, µ(i) ∈ Bi (f ), showing Condition 1(a) is satisfied.
46

Finally, we show that Condition 1(b) is satisfied. We prove its contrapositive. Let
µ
i ∈ I be such that µ(i) 6∈ Bi (f ). Thus, µ(i) = ∅ by Condition 1(a). Let c ∈ C. If
µ
|µ−1 (c)| < rc , then f c = ∅ πc i by non-wastefulness of µ. If |µ−1 (c)| = rc , then j πc i for
µ
every j ∈ µ−1 (c) as µ respects priorities; thus, f c = minπc µ−1 (c) πc i. In either case, we
µ
µ
have c 6∈ Bi (f ). Thus, we get Bi (f ) = ∅, showing that Condition 1(b) also holds for
µ
µ
(f , µ), and hence, completing the proof that (f , µ) is a cutoff equilibrium.
µ

Part 2. Let (f, µ) be a cutoff equilibrium. We prove that f c π c fc for every c ∈ C:
µ
Suppose, for contradiction, that there exists some category c ∈ C such that fc πc f c .
Then |µ−1 (c)| = rc as (f, µ) is a cutoff equilibrium and fc πc ∅, which follows from the
µ
µ
fact that f c π c ∅. Thus, f c = minπc µ−1 (c) πc ∅ by definition and µ complying with
µ
eligibility requirements. Then for the patient i = f c , µ(i) = c 6∈ Bi (f ) contradicting that
µ
(f, µ) is a cutoff equilibrium. Thus, such a category c does not exist, and hence, f is
the maximum cutoff equilibrium vector supporting matching µ. 
Claim 2. f µ is the minimum equilibrium cutoff vector supporting µ, i.e., (f µ , µ) is a
cutoff equilibrium and for every cutoff equilibrium (f, µ), fc π c f µc for every c ∈ C.
Proof. We prove the claim in two parts.
Part 1. We show that (f µ , µ) is a cutoff equilibrium:
We restate f µ using its definition in Equation (2): for every c ∈ C,
(
f µc =

o
n
if xc 6= ∅
minπc i ∈ µ(I) : i πc xc
∅

otherwise

where xc is defined as

xc = max I \ µ(I) ∪ {∅}.
πc


For every c ∈ C, since xc π c ∅, we have minπc i ∈ µ(I) : i πc xc π c ∅, if xc 6= ∅. Hence,
f µc π c ∅ showing that f µ ∈ F.
We show that the conditions in the definition of a cutoff equilibrium are satisfied by
(f , µ).
µ

Condition 2. Suppose |µ−1 (c)| < rc for some c ∈ C. For any i ∈ I \ µ(I) we have ∅ πc i
by non-wastefulness of µ. Thus, xc = ∅. This implies f µc = ∅ by its definition. Hence,
Condition 2 is satisfied.
Condition 1(a). Let i ∈ I. If µ(i) = ∅ then Condition 1(a) is satisfied for i. Suppose
µ
µ
µ(i) = c for some c ∈ C. We have i π c f c , since we showed in Claim 1 that (f , µ) is a
47

cutoff equilibrium. Two cases are possible about µ−1 (c):
µ

• If |µ−1 (c)| < rc : we showed in proving Condition 2 that xc = ∅, thus, f c = f µc = ∅.
Since i πc ∅, c = µ(i) ∈ Bi (f µ ) showing that Condition 1(a) holds for i.
µ
• If |µ−1 (c)| = rc : Then f c = minπc µ−1 (c) πc xc : as otherwise
µ

– if xc ∈ I, then µ(xc ) = ∅ (by definition of xc ) and yet c ∈ Bxc (f ), a contraµ
diction to (f , µ) being a cutoff equilibrium;
µ
µ
– if xc = ∅, then (i) xc πc f c ∈ I contradicts f being a cutoff vector, and (ii)
µ
µ
xc = f c contradicts |µ−1 (c)| = rc . Thus we cannot have xc π c f c in this case
either.
Thus,
µ

f c π c min{i ∈ I : i πc xc } = f µc .
πc

Then
µ

i π c f c π c f µc ,
implying c = µ(i) ∈ Bi (f µ ) and showing that Condition 1(a) holds for i.
Condition 1(b). Let i ∈ I be such that Bi (f µ ) 6= ∅. Let c ∈ Bi (f µ ).
• if xc = ∅: Then i πc ∅ = f µc . By definition of xc , i ∈ µ(I), i.e., µ(i) 6= ∅.
6 ∅ by definition of
• if xc 6= ∅: Then i π c f µc πc xc , which in turn implies that µ(i) =
f µc and xc .
In either case, by Condition 1(a), µ(i) ∈ Bi (f µ ). Thus, Condition 1(b) is satisfied for i.
These conclude proving that (f µ , µ) is a cutoff equilibrium.
Part 2. Let (f, µ) be a cutoff equilibrium. We prove that fc π c f µc for every c ∈ C:
Suppose to the contrary of the claim f µc πc fc for some c ∈ C. Now, f µc is a patient,
because fc π c ∅ by the definition of a cutoff vector. By definition of f µc , xc 6= ∅ and f µc πc
xc . We cannot have xc π c fc , as otherwise, we have c ∈ Bxc (f ); however, by definition
of xc , µ(xc ) = ∅, contradicting (f, µ) is a cutoff equilibrium. Thus fc πc xc . Since xc
is eligible for c, fc ∈ I. Furthermore, fc ∈ µ(I), since c ∈ Bfc (f ) and (f, µ) is a cutoff
equilibrium. Therefore, fc ∈ {j ∈ µ(I) : j πc xc }. Since f µc = minπc {j ∈ µ(I) : j πc xc },
we have fc π c f µc , contradicting f µc πc fc . Therefore, such a category c cannot exist, and
hence, f µ is the minimum equilibrium cutoff vector supporting µ. 
Claim 3. For any given two cutoff equilibria (f, µ) and (g, µ) such that fc π c gc for every
c ∈ C, the pair (h, µ) is also a cutoff equilibrium where h ∈ F satisfies for every c ∈ C,
fc π c hc π c gc .
Proof. We can obtain cutoff vector h from g after a sequence of repeated applications
48

of the following operation: Change the cutoffs of one of the categories c ∈ C of an input
vector f 0 ∈ F so that its cutoff increases by one patient and gets closer to hc than fc0 . We
start with f 0 = g to the sequence. We show that each iteration of this operation results
with a new equilibrium cutoff vector g 0 supporting µ and we use this g 0 as the input of
the next iteration of the operation. Since the outcome vector gets closer to h at each
step, the last cutoff vector of the sequence is h by finiteness of the patient set, and thus,
(h, µ) is a cutoff equilibrium:
Suppose c0 ∈ C is such that hc0 πc0 gc0 . We prove that for cutoff vector g 0 ∈ F such
that gc0 = gc for every c ∈ C \ {c0 } and gc0 0 = minπc0 {i ∈ I : i πc0 gc0 }, (g 0 , µ) is a cutoff
equilibrium. It is straightforward to show that g 0 ∈ F. Observe also that Bi (g 0 ) = Bi (g)
for every i ∈ I \ {j} where j = gc0 . Three cases are possible regarding j:
• If j 6∈ I: j = ∅.
• If j ∈ I and µ(j) = c0 : Category c0 ∈ Bj (f ) as (f, µ) is a cutoff equilibrium.
However, fc0 π c0 hc0 πc0 j = gc0 , contradicting that c0 ∈ Bj (f ). Therefore, this case
cannot happen.
• If j ∈ I and µ(j) 6= c0 : Observe that µ(j) 6= ∅, as c0 ∈ Bj (g) and (g, µ) is a cutoff
equilibrium. Moreover, we have µ(j) ∈ Bj (g), in turn together with µ(j) 6= c0
0
= gµ(j) .
implying that µ(j) ∈ Bj (g 0 ) as gµ(j)
These and the fact that (g, µ) is a cutoff equilibrium (specifically its Condition 1(b))
show that µ(i) ∈ Bi (g 0 ) for every i ∈ I such that Bi (g 0 ) 6= ∅, proving Condition 1(b)
holds in the definition of cutoff equilibrium for (g 0 , µ).
Since (g, µ) is a cutoff equilibrium (specifically Conditions 1(a) and 1(b) of the definition) imply that for every i ∈ I, µ(i) = ∅ ⇐⇒ Bi (g) = ∅. Therefore, we have µ(i) = ∅
for every i ∈ I such that Bi (g 0 ) = ∅, because Bi (g 0 ) ⊆ Bi (g) = ∅, where the set inclusion
follows from the fact that the cutoffs have weakly increased for each category under g 0 .
This and Condition 1(b) that we showed above imply that for all i ∈ I, µ(i) ∈ Bi (g 0 )∪{∅}.
Thus, Condition 1(a) in the definition of a cutoff equilibrium is also satisfied by (g 0 , µ).
We show Condition 2 is also satisfied proving that for every c ∈ C, gc0 = ∅ if |µ−1 (c)| <
rc to conclude that (g 0 , µ) is a cutoff equilibrium. Suppose |µ−1 (c)| < rc for some c ∈ C.
If c 6= c0 , then gc0 = gc = ∅, where the latter equality follows from (g, µ) being a cutoff
equilibrium (specifically its Condition 2). If c = c0 , fc0 = ∅ πc0 gc0 , where the first
equality follows from (f, µ) being a cutoff equilibrium (specifically its Condition 2). This
contradicts. g ∈ F. So c 6= c0 , completing the proof. 

49

Proof of Theorem 2.
Sufficiency : We first prove that any DA-induced matching complies with eligibility
requirements, is non-wasteful, and respects priorities. Let ∈ P be a preference profile
of patients over categories and ∅. Suppose µ ∈ M is DA-induced from this preference
profile.
Compliance with eligibility requirements: Suppose that µ(i) = c for some c ∈ C. Then i
must apply to c in a step of the DA algorithm, and hence, c i ∅. By construction of i ,
this means i πc ∅. Therefore, matching µ complies with eligibility requirements.
Non-wastefulness: Suppose that i πc ∅ and µ(i) = ∅ for some category c ∈ C and patient
i ∈ I. By construction of i , c i ∅ because i is eligible for c. As patient i is unmatched
in µ, she applies to c in some step of the DA algorithm. However, c rejects i at this or a
later step. This means, c should have been holding at least rc offers from eligible patients
at this step. From this step on, c always holds rc offers and eventually all of its units are
assigned: |µ−1 (c)| = rc . Hence, matching µ is non-wasteful.
Respecting priorities: Suppose that µ(i) = c and µ(i0 ) = ∅ for two patients i, i0 ∈ I and a
category c ∈ C. For every category c0 ∈ C, πc0 is used to choose eligible patients at every
step of the DA algorithm. Therefore, µ(i) = c implies i πc ∅. Since µ(i0 ) = ∅, then it
must be either because ∅ πc i0 or because i πc i0 . In the first case, we get i πc i0 as well
because πc is transitive. Therefore, matching µ respects priorities.
Necessity: We now prove that any matching µ ∈ M with the three stated properties
is DA-induced from some preference profile. We construct a candidate preference profile
∈ P as follows:
• Consider a patient i ∈ µ−1 (c) where c ∈ C. Since µ complies with eligibility
requirements, i must be eligible for category c. Let i rank category c first in i .
The rest of the ranking in i is arbitrary as long as all eligible categories are ranked
above the empty set.
• Consider an unmatched patient i ∈ µ−1 (∅). Let i rank categories in any order in
i such that only eligible categories are ranked above the empty set.
We now show that µ is DA-induced from preference profile . In the induced DA
algorithm under , for every category c0 ∈ C, patients in µ−1 (c0 ) apply to category c0
first. Every unmatched patient j ∈ µ−1 (∅) applies to her first-ranked eligible category
according to j , if there is any. Suppose c ∈ C is this category. Since µ respects
priorities, j has a lower priority than any patient in µ−1 (c), who also applied to c in Step
1. Furthermore, since µ is non-wasteful, |µ−1 (c)| = rc (as there are unmatched eligible
50

patients for this category, for example j). Therefore, all unmatched patients in µ are
rejected at the first step of the DA algorithm. Moreover, for every category c0 ∈ C, all
patients in µ−1 (c0 ) are tentatively accepted by category c0 at the end of Step 1.
Each unmatched patient in j ∈ µ−1 (∅) continues to apply according to j to the
other categories at which she is eligible. Since µ respects priorities and is non-wasteful,
she is rejected from all categories for which she is eligible one at a time, because each of
these categories c ∈ C continues to tentatively hold patients µ−1 (c) from Step 1 who all
have higher priority than j according to πc , as µ respects priorities. Moreover, by nonwastefulness of µ, |µ−1 (c)| = rc , as there are unmatched eligible patients (for example j)
under µ.
As a result, when the algorithm stops, the outcome is such that, for every category
0
c ∈ C, all patients in µ−1 (c0 ) are matched with c0 . Moreover, every patient in µ−1 (∅)
remains unmatched at the end. Therefore, µ is DA-induced from the constructed patient
preferences .
Proof of Proposition 1. Let . ∈ ∆ be a precedence order and ϕ. be the associated
sequential reserve matching. We show that ϕ. is DA-induced from preference profile
. = (.i )i∈I .
For every patient i ∈ I, consider another strict preference relation 0i such that all
categories are ranked above the empty set and, furthermore, for any c, c0 ∈ C,
c 0i c0 ⇐⇒ c . c0 .
Note that the relative ranking of two categories for which i is eligible is the same
between .i and 0i .
We use an equivalent version of the DA algorithm as the one given in the text.
Consider a Step k: Each patient i who is not tentatively accepted currently by a category
applies to the best category that has not rejected her yet according to 0i . Suppose that
Ick is the union of the set of patients who were tentatively assigned to category c in Step
k − 1 and the set of patients who just proposed to category c. Category c tentatively
assigns eligible patients in Ick with the highest priority according to πc until all patients
in Ick are chosen or all rc units are allocated, whichever comes first, and permanently
rejects the rest.
Since for any category c ∈ C and any patient i ∈ I who is ineligible for category c,
∅ πc c, the outcome of the DA algorithm when the preference profile is . and 0 = (0i )i∈I
are the same.
51

Furthermore, when the preference profile is 0 , the DA algorithm works exactly like
the sequential reserve procedure that is used to construct ϕ. . We show this by induction.
Suppose . orders categories as c1 . c2 . . . . . c|C| . As the inductive assumption, for k > 0,
suppose for categories c1 , . . . , ck−1 , the tentative matches at the end of Step k − 1 and
final matches at the end under the DA algorithm from 0 are identical to their matches
in sequential reserve matching ϕ. .
We next consider Step k of the DA algorithm from 0 . Only patients who are rejected
from category ck−1 apply in Step k of the DA algorithm and they all apply to category ck .
Then ck uses its priority order πck to tentatively accept the rck highest-priority eligible
applicants (and if there are less than rck eligible applicants, all eligible applicants), and
rejects the rest. Observe that since every patient who is not tentatively accepted by
a category c1 , . . . , ck−1 applied to this category in Step k, none of these patients will
ever apply to it again; and by the inductive assumption no patient who is tentatively
accepted in categories c1 , . . . , ck−1 will ever be rejected, and thus, they will never apply
to ck , either. Thus, the tentative acceptances by ck will become permanent at the end
of the DA algorithm. Moreover, this step is identical to Step k of the sequential reserve
procedure under precedence order . and the same patients are matched with category ck
in ϕ. . This ends the induction.
Therefore, we conclude that ϕ. is DA-induced from patient preference profile . .
0

Proof of Proposition 2. Let J . , J . ⊆ I be the sets of patients remaining just before
category c is processed under the sequential reserve matching procedure induced by . and
.0 , respectively. Since c is processed earlier under .0 and every other category preceding
0
c and c0 under . and .0 are ordered in the same manner order, J . ⊆ J . . Two cases are
possible:
0

.
.
1. If |ϕ−1
implies |ϕ−1
. (c)| < rc . Therefore, by Equation (1),
.0 (c)| < rc : Then J ⊆ J
ϕ.0
ϕ.
fc = ∅ = fc .
.
.0
2. If |ϕ−1
implies,
.0 (c)| = rc : Then J ⊆ J
ϕ

0

−1
f c . = min ϕ−1
.0 (c) π c min ϕ. (c),
πc

πc

ϕ.

where the first equality follows by Equation (1). By the same equation, f c
ϕ.0
{∅, minπc ϕ−1
π c ∅. Thus,
. (c)} and by the definition of a cutoff vector, f c
ϕ

0

ϕ.

f c . πc f c .

52

∈

A.2

Proofs of Lemma 2, Proposition 4, and Theorem 3

Proof of Lemma 2. By the definition of the smart reserve matching algorithm induced
by assigning n unreserved units subsequently at the beginning, in Step 1.(k) for every
k ∈ {0, 1, . . . , |I|}, and for every every matching µ ∈ Mk ,
• µ(i) = u for every i ∈ Jku , and
• µ(i) ∈
6 {u, ∅} and i ∈ Iµ(i) for every i ∈ Jk .
u
∪ J|I| ) there is no matching µ ∈ M|I| such that µ(i) 6∈
We show that for any i ∈ I \ (J|I|
{u, ∅} and i ∈ Iµ(i) . Suppose contrary to the claim that such a patient i and matching µ
u
exist. Patient i is processed in some Step 1.(k). We have i ∈
/ Jku ∪ Jk ⊆ J|I|
∪ J|I| . We
u
have µ ∈ Mk−1 as Mk−1 ⊇ M|I| . Then |Jk−1 | = n, as otherwise we can always match
i with u even if we cannot match her with a preferential treatment category that she is
a beneficiary of when she is processed under a matching that is maximal in beneficiary
u
∪ J|I| . But then as µ(i) 6∈ {u, ∅} and i ∈ Iµ(i) , we have
assignment, contradicting i ∈
/ J|I|
u
∪ J|I| .
µ ∈ Mk and i ∈ Jk , contradicting again i ∈
/ J|I|
Thus, in Step 2 no patient is matched with a preferential treatment categories that
she is a beneficiary of. These prove ∪c∈C\{u} (σ −1 (c) ∩ Ic ) is the same set regardless of the
matching σ ∈ MnS we choose.
To prove that σ −1 (u) is the same for every σ ∈ MnS , we consider two cases (for Step
2):

• If we have a soft reserve system: Then all patients are eligible for the remaining
u
u
∪ J|I| ) based
∪ J|I| |} units. Since we assign the patients in I \ (J|I|
max{0, q − |J|I|
on priority according to π to the remaining units, we have σ(I) is the same patient
set regardless of the matching σ ∈ MnS we choose. Since the remaining ru − n
unreserved units are assigned to the lowest priority patients that are matched in
any σ ∈ MnS , if any, and µ−1 (u) is a fixed set regardless of which matching µ ∈ M|I|
we choose (as we proved above), then σ −1 (u) is the same set regardless of which
σ ∈ MnS we choose.
• If we have a hard reserve system: Then in Step 2 no patient is matched with a unit
of a category that she is not a beneficiary of. Thus, the ru −n remaining unmatched
u
units are assigned to the highest π-priority patients in I \(J|I|
∪J|I| ). This concludes
proving that each of σ(I) and σ −1 (u) is the same patient set regardless of which
σ ∈ MnS we choose.

53

Proof of Proposition 4.
For any n ∈ {0, 1, . . . , ru }, we prove that every smart
n
reserve matching in MS complies with eligibility requirements, is non-wasteful, respects
priorities, and is maximal in beneficiary assignment.
Compliance with eligibility requirements: By construction, no patient is ever matched
with a category for which she is not eligible during the procedure.
Non-wastefulness: Suppose to the contrary of the claim that there exists some σ ∈ MnS
that is wasteful. Thus, there exists some category c ∈ C and a patient i ∈ I such that
σ(i) = ∅, i πc ∅, and |µ−1 (c)| < rc . Then in Step 2 patient i or another patient should
have been matched with c as we assign all remaining units to eligible patients, which is
a contradiction.
Respect for Priorities: Let σ ∈ MnS be a smart reserve matching. Suppose patients
i, j ∈ I are such that i π j and σ(i) = ∅. We need to show either (i) σ(j) = ∅ or (ii)
i 6∈ Iσ(j) and j ∈ Iσ(j) , which is equivalent to j πσ(j) i. Suppose σ(j) 6= ∅. Suppose to
the contrary that i ∈ Iσ(j) and j ∈ Iσ(j) . Consider the smart reserve matching procedure
u
∪ J|I| or not. We show that either case leads to
with n. Two cases are possible: j ∈ J|I|
a contradiction, showing that σ respects priorities.
u
• If j ∈ J|I|
∪ J|I| : Consider the matching σ̂ obtained from σ as follows: σ̂(i) = σ(j),
σ̂(j) = ∅, and σ̂(i0 ) = σ(i0 ) for every i0 ∈ I \ {i, j}. Since i, j ∈ Iσ(j) , and we match
i instead of j with σ(j), σ̂ is a matching that is maximal in beneficiary assignment
as well. Since i π j, i is processed before j in Step 1. Let i be processed in some
Step 1.(k). Since σ(i) = ∅, i 6∈ Jk ∪ Jku . Then σ̂ ∈ Mk−1 as σ ∈ Mk−1 . Two cases
are possible:

– if σ(j) = u: As j is matched with an unreserved unit in Step 1, then an unreserved unit is still to be allocated in the procedure when i is to be processed
in Step 1.(k) before j. We try to match i with an unreserved unit first. Since
σ̂ ∈ Mk−1 and σ̂(i) = u this implies i ∈ Jku . This contradicts i 6∈ Jku ∪ Jk .
– if σ(j) 6= u: Then when i is to be processed in Step 1.(k), we are trying to
match her (i) if it is possible, with unreserved category u first and if not, with
a preferential treatment category that she is a beneficiary of, or (ii) directly
with a preferential treatment category that she is a beneficiary of without
sacrificing the maximality in beneficiary assignment. However, as σ(i) = ∅
we failed in doing either. Since i ∈ Iσ̂(i) and σ̂(i) 6= u, at least there exists a
matching in Mk−1 that would match i with a preferential treatment category
that she is a beneficiary of. Hence, this contradicts i 6∈ Jku ∪ Jk .
54

u
• If j 6∈ J|I|
∪ J|I| : Therefore, j is matched in Step 2 of the smart reserve matching
algorithm with n unreserved units processed first. Since we match patients in Step
2 either with the preferential treatment categories that they are eligible but not
beneficiary of or with the unreserved category u, and we assumed j ∈ Iσ(j) then
σ(j) = u. Since i is also available when j is matched, and i π j, patient i or another
patient who has higher π-priority than j should have been matched instead of j,
which is a contradiction.

Maximality in Beneficiary Assignment: By construction MnS ⊆ M0 , which is the set
of matchings that are maximal in beneficiary assignment in the smart reserve matching
procedure with n.
The following lemma and concepts from graph theory will be useful in our next proof.
We state the lemma as follows:
Lemma 3 (Mendelsohn and Dulmage Theorem, 1958). Let Mb be the set of matchings
that match patients with only preferential treatment categories that they are beneficiaries
of and otherwise leave them unmatched. If there is a matching in Mb that matches
patients in some J ⊆ I and there is another matching ν ∈ Mb then there exists a
matching in Mb that matches all patients in J and at least |ν −1 (c)| units of each category
c ∈ C \ {u}.
See for example page 266 of Schrijver (2003) for a proof of this result.
Let us define I∅ = ∅ for notational convenience.
We define a beneficiary alternating path from µ to ν for two matchings in
µ, ν ∈ M as a non-empty list A = (i1 , . . . , im ) of patients such that




i1 ∈ Iν(i1 ) and ν(i1 ) 6= u ,



and µ(im ) = ν(im−1 ) & im ∈ Iν(im ) and ν(im ) 6= u for every m ∈ {2, 3, . . . , m − 1},



and µ(im ) = ν(im−1 ) & im 6∈ Iν(im ) or ν(im ) = u .

i1 6∈ Iµ(i1 ) or µ(i1 ) = u



im ∈ Iµ(im )



im ∈ Iµ(im )



&

A beneficiary alternating path begins with a patient i1 who is not matched with a preferential treatment category that she is a beneficiary of under µ and ends with a patient
im who is not matched with a preferential treatment category that she is a beneficiary of
under ν. Everybody else in the path is matched under both matchings with a preferential
treatment category that she is a beneficiary of. We state the following observation, which
directly follows from the finiteness of categories and patients.
55

Observation 1. If µ and ν ∈ M are two matchings such that for every c ∈ C \ {u},

|µ−1 (c) ∩ Ic | = |ν −1 (c) ∩ Ic | and there exists some i ∈ ∪c∈C\{u} ν −1 (c) ∩ Ic \ ∪c∈C\{u}

µ−1 (c) ∩ Ic , then there exists a beneficiary alternating path from µ to ν beginning with
patient i.
We are ready to prove our last theorem:
Proof of Theorem 3. By Proposition 4 and Theorem 1, any σ0 ∈ M0S and σru ∈ MrSu
are cutoff equilibrium matchings. Let µ ∈ M be any other cutoff equilibrium matching
that is maximal in beneficiary assignment.
We extend the definitions of our concepts to smaller economies: given any I ∗ ⊆ I and
r∗ = (rc∗ )c∈C such that rc∗ ≤ rc for every c ∈ C, all properties and algorithms are redefined
for this smaller economy (I ∗ , r∗ ) by taking the restriction of the baseline priority order π
on I ∗ , and denoted using the argument (I ∗ , r∗ ) at the end of the notation. For example
M(I ∗ , r∗ ) denotes the set of matchings for (I ∗ , r∗ ).
σr

µ

Proof of f u u π f u :
We prove the following claim first.
Claim 1. For any set of patients I ∗ ⊆ I and any capacity vector r∗ ≤ r, suppose
matching ν ∈ M(I ∗ , r∗ ) is maximal in beneficiary assignment for (I ∗ , r∗ ). Let σ ∈
r∗
MSu (I ∗ , r∗ ) be a smart reserve matching with all unreserved units processed first. Then
|σ −1 (u)| ≥ |ν −1 (u)|.
n
Moreover, according to the baseline priority order π, for any k ∈ 1, . . . , ν −1 (u) \
o
σ −1 (u) , let jk be the k th highest priority patient in σ −1 (u) \ ν −1 (u) and jk0 be the
k th highest priority patient in ν −1 (u) \ σ −1 (u), then
jk π jk0 .
Proof. Suppose to the contrary of the first statement |σ −1 (u)| < |ν −1 (u)|. Since both
σ and ν are maximal in beneficiary assignment for (I ∗ , r∗ ), then the exists some patient
i ∈ (∪c∈C ν −1 (c) ∩ Ic ) \ (∪c∈C σ −1 (c) ∩ Ic ). This patient is not committed to be matched
in Step 1 of the smart reserve matching algorithm with all unreserved units first, despite
the fact that there exists at least one available unreserved unit when she was processed,
which is a contradiction. Thus, |σ −1 (u)| ≥ |ν −1 (u)|.

56

For the rest of the proof, we use induction on the cardinality of I ∗ and on the magnitude of vector of category capacity vector r∗ :
• For the base case when I ∗ = ∅ and rc∗ = 0 for every c ∈ C, the claim holds trivially.
• As the inductive assumption, suppose that for all capacity vectors of categories
bounded above by vector r∗ and all subsets of I bounded above by cardinality k ∗ ,
the claim holds.
• Consider a set of patients I ∗ ⊆ I such that |I ∗ | = k ∗ and capacity vector of
r∗
categories r∗ = (rc∗ )c∈C . Let σ ∈ MSu (I ∗ , r∗ ) be a smart reserve matching for
(I ∗ , r∗ ) with all unreserved units processed first and ν ∈ M(I ∗ , r∗ ) be maximal in
beneficiary assignment for (I ∗ , r∗ ). If σ −1 (u) ⊇ ν −1 (u) then the claim for (I ∗ , r∗ ) is
trivially true. Thus, suppose not. Then, there exists j ∈ ν −1 (u)\σ −1 (u). Moreover,
let j be the highest π-priority patient in ν −1 (u) \ σ −1 (u). We have two cases that
we consider separately:
Case 1. There is no patient i ∈ I ∗ such that i π j and i ∈ σ −1 (u) \ ν −1 (u):
We show that this case leads to a contradiction, and hence, it cannot hold.
When j is processed in Step 1 of the smart reserve matching algorithm with
all unreserved units processed first, since σ(j) 6= u, either
(i) all units of the unreserved category are assigned under σ to patients with
higher π-priority than j, or
(ii) some unreserved category units are still available when j is processed.
Observe that (i) cannot hold, because it contradicts Case 1. Thus, (ii) holds.
Since j is the highest π-priority patient in ν −1 (u) \ σ −1 (u) and since we are
in Case 1, for every i ∈ I ∗ such that i π j, we have
ν(i) = u ⇐⇒ σ(i) = u.

(3)

We construct a new matching ν̂ ∈ M(I ∗ , r∗ ) from ν and fix a patient i ∈ I ∗
as follows. We check whether there exists a patient i ∈ I ∗ such that
i π j,

σ(i) 6= u,

and i 6∈ Iν(i) ,

(4)

(a) If such a patient i does not exist, then let ν̂ = ν and i = j.
(b) If such a patient i exists, then let her be the highest π-priority patient
with the property in Equation 4.
We show that i ∈ Iσ(i) . Consider the smart reserve matching algorithm.
Since ν(j) = u and i π j, just before i is processed in Step 1, there is
57

still at least one unreserved unit available by Equation 3. Since we are
processing all unreserved units first and since σ(i) 6= u, it should be the
case that we had to match i with a preferential treatment category that
she is a beneficiary of. Thus, i ∈ Iσ(i) .
We create a new matching for (I ∗ , r∗ ) from ν, which we refer to as ν̂,
such that ν̂ matches every patient in I ∗ exactly as under ν except that
ν̂ leaves patient j unmatched and matches i with category u instead.
Since ν is maximal in beneficiary assignment for (I ∗ , r∗ ), so is ν̂.
So far, we have for every i0 ∈ I ∗ such that i0 π i,
1. σ(i0 ) = u ⇐⇒ ν(i0 ) = u (by Equation 3 and i π j),
2. σ(i0 ) ∈ Iσ(i0 ) (an unreserved unit is available before i is processed in Step
1 of the smart reserve matching algorithm with all unreserved units processed first; thus, every patient processed before i is matched if possible,
with u, and if not possible, with a preferential treatment category that
she is a beneficiary of under the restriction of maximality in beneficiary
assignment), and
3. ν̂(i0 ) ∈ Iν̂(i0 ) (by definition of i as the highest π-priority patient satisfying
Equation 4).
We also have ν̂(i) = u and σ(i) 6= u.
Patient i is processed in some Step 1.(k) in the smart reserve matching algorithm with all unreserved units processed first. As σ(i) 6= u we have
i ∈
/ Jku (I ∗ , r∗ ). On the other hand, since σ ∈ Mk−1 (I ∗ , r∗ ), by Statements
1, 2, and 3 above, we have ν̂ ∈ Mk−1 (I ∗ , r∗ ) as well and it matches i with u,
contradicting i ∈
/ Jku (I ∗ , r∗ ). Therefore, Case 1 (ii) cannot hold either.
Case 2. There is some i ∈ σ −1 (u) \ ν −1 (u) such that i π j:
Construct a matching σ̂ from σ that it leaves every patient who is matched
in Step 2 of the smart reserve matching algorithm with all unreserved units
processed first: for every i∗ ∈ I ∗ , σ̂(i∗ ) = σ(i∗ ) if i∗ ∈ Iσ(i∗ ) and σ̂(i∗ ) = ∅
otherwise. Clearly σ̂ ∈ M(I ∗ , r∗ ) and is maximal in beneficiary assignment
for (I ∗ , r∗ ), since σ is. By Lemma 3, there exists a matching ν̃ ∈ Mb (I ∗ , r∗ )18
such that under ν̃ all patients in ∪c∈C\{u} ν̃ −1 (c) ∩ Ic are matched with the
preferential treatment categories in C \ {u} that they are beneficiaries of, and
for every c ∈ C \ {u}, |ν̃ −1 (c) ∩ Ic | = |σ̂ −1 (c) ∩ Ic | (equality follows rather than
As defined in the hypothesis of the lemma, ν̃ ∈ Mb (I ∗ , r∗ ) means that for every i∗ ∈ I ∗ and c ∈ C,
i ∈ ν̃ −1 (c) implies c 6= u and i∗ ∈ Ic .
18

∗

58

≥ as dictated by the lemma, because σ̂ is maximal in beneficiary assignment
for (I ∗ , r∗ )). For every i∗ ∈ I ∗ , we have ν(i∗ ) = u =⇒ ν̃(i∗ ) = ∅ as
ν̂ ∈ Mb (I ∗ , r∗ ). We modify ν̃ to obtain ν̂: For every i∗ ∈ ν −1 (u), we set
ν̂(i∗ ) = u and for every i∗ ∈ I ∗ \ ν −1 (u), we set ν̂(i∗ ) = ν̃(i∗ ). Clearly,
ν̂ ∈ M(I ∗ , r∗ ) and is maximal in beneficiary assignment for (I ∗ , r∗ ), since ν
is. We will work with σ̂ and ν̂ instead of σ and ν from now on.
Recall that σ̂(i) = u and ν̂(i) 6= u. Two cases are possible: i ∈ Iν̂(i) or
ν̂(i) = ∅.
1. If i ∈ Iν̂(i) : Then by Observation 1, there exists a beneficiary alternating
path A from σ̂ to ν̂ beginning with i and ending with some i0 ∈ I ∗ such
that (i) σ̂(i0 ) ∈ Iσ̂(i0 ) and σ̂(i0 ) 6= u, and (ii) ν̂(i0 ) = u or ν̂(i0 ) = ∅.
By the existence of the beneficiary alternating path, it is possible to
match either i or i0 with a preferential treatment category that she is
a beneficiary of and match the other one with u without changing the
type of match of any other patient i∗ ∈ I ∗ \ {i, i0 } has, i.e., either i∗ is
matched with a preferential treatment category under both matchings
or not. Yet, when i is processed in Step 1 of the smart reserve matching
algorithm with all unreserved units processed first, we chose i to be
matched with u and i0 with a preferential treatment category. This
means
i π i0 .
Let ĉ 6= u be the category that i is matched with under ν̂.
If σ̂(i0 ) 6= u, then modify ν̂ by assigning an unreserved unit to i0 instead
of j: ν̂(j) = ∅ and ν̂(i0 ) = u. Otherwise, do not modify ν̂ any further.
Consider the smaller economy (I 0 , r0 ) such that I 0 = I ∗ \ {i, i0 } and for
every c ∈ C, rc0 = rc∗ − 1 if c ∈ {ĉ, u} and rc0 = rc∗ , otherwise.
r0
We show that a smart reserve matching σ 0 ∈ MSu (I 0 , r0 ) can be obr∗
tained from the original smart reserve matching σ ∈ MSu (I ∗ , r∗ ) and
ν̂. Consider the beneficiary alternating path A we discovered above
starting with patient i and ending with patient i0 from σ̂ to ν̂: Suppose
A = (i, i2 , . . . , im−1 , i0 ). Define
σ 0 (i∗ ) = σ(i∗ ) for every i∗ ∈ I 0 \ {i2 , . . . , im−1 } and
σ 0 (i∗ ) = ν̂(i∗ ) for every i∗ ∈ {i2 , . . . , im−1 }.
59

Observe that σ 0 ∈ M(I 0 , r0 ). The existence of σ 0 shows that it is feasible
to match every patient in J|Iu ∗ | (I ∗ , r∗ ) \ {i} with u and it is feasible to
match every patient in J|I ∗ | (I ∗ , r∗ ) \ {i0 } with a preferential treatment
category that she is a beneficiary of in (I 0 , r0 ). Thus, the smart reserve
matching algorithm with all unreserved units processed first proceeds
exactly in the same manner as it does for (I ∗ , r∗ ) with the exception
that it skips patients i and i0 in the smaller economy (I 0 , r0 ). Hence,
r0
σ 0 ∈ MSu (I 0 , r0 ).
Let the restriction of matching ν̂ to (I 0 , r0 ) be ν 0 . Observe that ν 0 is a
matching for (I 0 , r0 ). Moreover, it is maximal in beneficiary assignment
for (I 0 , r0 ), since ν̂ is maximal in beneficiary assignment for (I ∗ , r∗ ).
Now one of the two following cases holds for ν:
(a) If ν(i0 ) 6= u: Recall that while ν(j) = u, we updated ν̂ so that
ν̂(i0 ) = u and ν̂(j) = ∅. Thus, ν 0 (j) = ∅ as well. Since i π j, this
together with the inductive assumption that the claim holds for
(I 0 , r0 ) imply that the claim also holds for (I ∗ , r∗ ), completing the
induction.
(b) If ν(i0 ) = u: Since i π i0 , this together with the inductive assumption that the claim holds for (I 0 , r0 ) imply that the claim also holds
for (I ∗ , r∗ ), completing the induction.
2. If ν̂(i) = ∅: Recall that ν̂(j) = u. We modify ν̂ further that ν̂(i) = u
and ν̂(j) = ∅. Consider the smaller economy (I 0 , r0 ) where I 0 = I ∗ \ {i},
ru0 = ru∗ − 1, and rc0 = rc∗ for every c ∈ C \ {u}.
Let σ 0 and ν 0 be the restrictions of σ and ν̂ to (I 0 , r0 ), respectively.
Since, σ(i) = ν̂(i) = u both σ 0 and ν 0 are matchings for (I 0 , r0 ). Since the
capacity of category u is decreased by one, σ 0 is a smart reserve matching
with all unreserved units processed first for (I 0 , r0 ). To see this observe
that the algorithm proceeds as it does for (I ∗ , r∗ ) with the exception
that it skips i. Matching ν 0 is maximal in beneficiary assignment for
(I 0 , r0 ). Therefore, by the inductive assumption, the claim holds for
(I 0 , r0 ). This together with the fact that i π j imply the claim holds for
(I ∗ , r∗ ), completing the induction. 
σr

µ

If |µ−1 (u)| < ru then f u u π f u = ∅. On the other hand, if |µ−1 (u)| = ru , Claim 1
σr
µ
implies that f u u = minπ σr−1
(u) π f u = minπ µ−1 (u).
u

60

µ

σ0

Proof of f u π f u :
We prove the following claim first.
Claim 2. For any set of patients I ∗ ⊆ I and any capacity vector r∗ ≤ r, suppose
ν ∈ M(I ∗ , r∗ ) is a matching that is maximal in beneficiary assignment for (I ∗ , r∗ ). Let
σ ∈ M0S (I ∗ , r∗ ) be a smart reserve matching with all unreserved units processed last,
J = ∪c∈C\{u} (σ −1 (c) ∩ Ic ),

and J 0 = ∪c∈C\{u} (ν −1 (c) ∩ Ic ).

According to the baseline priority order π, for any k ∈ {1, . . . , |J 0 \ J|}, let jk be the k th
highest priority patient in J \ J 0 and jk0 be the k th highest priority patient in J 0 \ J, then
jk π jk0 .

Proof.19 We use induction on the cardinality of I ∗ and on the magnitude of vector of
capacities of categories r∗ :
• For the base case when I ∗ = ∅ and rc∗ = 0 for every c ∈ C, the claim holds trivially.
• In the inductive step, suppose for every capacity of categories bounded above by
vector r∗ and subsets of patients in I bounded above by cardinality k ∗ the claim
holds.
• Consider set of patients I ∗ ⊆ I such that |I ∗ | = k ∗ and capacity vector for categories
r∗ = (rc∗ )c∈C . If J \ J 0 = ∅ then the claim holds trivially. Suppose J \ J 0 6= ∅. Let
i ∈ J \ J 0 be the highest priority patient in J \ J 0 according to π.
We have |J| = |J 0 | by maximality of σ and ν in beneficiary assignment for I ∗ . Thus,
|J \ J 0 | = |J 0 \ J|, which implies J 0 \ J 6= ∅.
By Lemma, 3 there exists a matching ν̂ ∈ Mb (I ∗ , r∗ ) that matches patients only
with preferential treatment categories that they are beneficiaries of such that ν̂
matches patients in J 0 and |σ −1 (c) ∩ Ic | units reserved for every preferential treatment category c ∈ C \ {u}.20 Since both ν and σ are maximal in beneficiary
assignment for (I ∗ , r∗ ), then only patients in J 0 should be matched under ν̂ and no
other patients (as otherwise ν would not be maximal in beneficiary assignment for
(I ∗ , r∗ )).
19

This claim’s proof is similar to the proof of Proposition 1 Part 2 in Sönmez and Yenmez (2020).
Although both σ and ν may be matching some patients with categories that they are not beneficiaries
of or with the unreserved category, we can simply leave those patients unmatched in σ and ν and apply
Lemma 3 to see such a matching ν̂ exists.
20

61

Since ν̂(i) = ∅, i ∈ Iσ(i) , and σ(i) 6= u, by Observation 1, there exists a beneficiary
alternating path A starting with i from ν̂ to σ and ending with a patient i0 ∈ Iν̂(i0 )
(and ν̂(i0 ) 6= u by its construction), and yet i0 ∈
/ Iσ(i) or σ(i0 ) = u.
Existence of the beneficiary alternating path shows that it is possible to match i or
i0 (but not both) with preferential treatment categories that they are beneficiaries
of without affecting anybody else’s status as committed or uncommitted in Step 1
of the smart reserve matching algorithm with all unreserved units processed last.
Since σ matches i with a preferential treatment category that she is a beneficiary
of at the cost of patient i0 , we have
i π i0 .
Next consider the smaller economy (I 0 , r0 ) in which we remove (i) i and i0 and set
I 0 = I ∗ \ {i, i0 }, (ii) one of the units associated with preferential treatment category
ĉ = ν̂(i0 ) and set rĉ0 = rĉ∗ − 1, and (iii) keep the capacity of every other category
c ∈ C \ {ĉ} the same and set rc0 = rc∗ .
Let ν 0 be the restriction of ν̂ to (I 0 , r0 ). As ν̂(i) = ∅, ν̂(i0 ) = ĉ 6= u such that i ∈ Iĉ
and the capacity of ĉ is reduced by 1 in the smaller economy, ν 0 ∈ M(I 0 , r0 ), and
furthermore, it is maximal in beneficiary assignment for (I 0 , r0 ).
We form a matching σ 0 ∈ M(I 0 , r0 ) by modifying σ and ν̂ using the beneficiary
alternating path A we found before. Recall that A is the beneficiary alternating path
from ν̂ to σ beginning with i and ending with i0 . Suppose A = (i, i2 , . . . , im−1 , i0 ).
Define
σ 0 (i∗ ) = σ(i∗ ) for every i∗ ∈ I 0 \ {i2 , . . . , im−1 } and
σ 0 (i∗ ) = ν̂(i∗ ) for every i∗ ∈ {i2 , . . . , im−1 }.
Observe that σ 0 ∈ M(I 0 , r0 ). The existence of σ 0 shows that it is possible to match
every patient in J|I ∗ | (I ∗ , r∗ ) \ {i} with a preferential treatment category that she
is a beneficiary of in (I 0 , r0 ). Thus, the smart reserve matching algorithm with all
unreserved units processed last proceeds as it does for (I ∗ , r∗ ) with the exception
that it skips patients i and i0 . Therefore, σ 0 ∈ M0S (I 0 , r0 ).
By the inductive assumption, the claim holds for σ 0 and ν 0 for (I 0 , r0 ). This completes the induction, as we already showed i π i0 . 
Thus, we showed that at the end of Step 1 of the smart matching algorithm with all
unreserved units processed last, weakly lower priority patients have remained uncommit62

ted in J ∗ = I \ J|I| = I \ ∪c∈C\{u} (σ0−1 (c) ∩ Ic ) than in Jˆ = I \ ∪c∈C\{u} (µ−1 (c) ∩ Ic ).
Two cases are possible:
• If we have a soft reserves system: As both σ0 and µ are maximal in beneficiary
assignment, an equal number of units are assigned to the highest π-priority patients
in Jˆ (by Step 2 of the smart reserve matching algorithm) and J ∗ (as by Theorem 1, µ
respects priorities and is non-wasteful). Under σ0 , the unreserved units are assigned
last in order in Step 2 of the algorithm. On the other hand, the remainder of µ, i.e.,
the units assigned to the non-beneficiaries of preferential treatment categories and
beneficiaries of u, can be constructed by assigning the rest of the units sequentially
to the highest priority patients in J ∗ one by one when unreserved units are not
necessarily processed last.
µ
σ0
Therefore, if |µ−1 (u)| < ru then |σ0−1 (u)| < ru , in turn implying f u = f u = ∅. If
µ
σ0
|µ−1 (u)| = ru then |σ0−1 (u)| ≤ ru and f u = minπ µ−1 (u) π f u ∈ {∅, minπ σ0−1 (u)}.
• If we have a hard reserves system: The proof is identical as the above case with
the exception that now only unreserved units are assigned as both σ0 and µ comply
with eligibility requirements.

63

Supplemental Material
B

Proof of Proposition 3 in Section 4

In this subsection, we first show some lemmas that we will use in the proof of Proposition 3.
Fix a soft reserve system induced by the baseline priority order π. Suppose each
patient is a beneficiary of at most one preferential treatment category.
First, we introduce some concepts.
We introduce function τ : I → (C \ {u}) ∪ {∅} to denote the preferential treatment
category that a patient is beneficiary of, if there is such a category. That is, for any
patient i ∈ I, if i ∈ Ic for some c ∈ C \ {u}, then τ (i) = c, and if i ∈ Ig , i.e., i is a
general-community patient, then τ (i) = ∅.
˜ let rank(i; I,
˜ π c∗ )
For a category c∗ ∈ C, a set of patients I˜ ⊆ I, and a patient i ∈ I,
denote the rank of i among patients in I˜ according to πc∗ .
We consider incomplete orders of precedence. For a given subset of categories C ∗ ⊆ C,
we define an order of precedence on C ∗ as a linear order on C ∗ . Let ∆(C ∗ ) be the set
of orders of precedence on C ∗ .
We extend the definition of sequential reserve matchings to cover incomplete precedence orders and match a subset of patients I˜ ⊆ I as follows: A sequential reserve
matching induced by . ∈ ∆(C ∗ ) over I˜ is the outcome of the sequential reserve procedure which processes only the categories in C ∗ in the order of . to match only the patients
in I˜ and leaves all categories in C \ C ∗ unmatched and patients in I \ I˜ unmatched. Let
˜
ϕI. denote this matching.
Lemma S.4. Suppose that I˜ ⊆ I, c ∈ C \ {u}, and ., .0 ∈ ∆({u, c}) are such that
•
•
•
•
•

. is given as u . c,
.0 is given as c .0 u,
˜ where µ = ϕI.˜,
I(2) = I˜ \ µ(I)
˜ where µ0 = ϕI˜0 , and
I 0 (2) = I˜ \ µ0 (I)
.
µ(I˜c ) ( I˜c .

Then the following results hold:
1. |I(2) \ I 0 (2)| = |I 0 (2) \ I(2)|,
2. I 0 (2) \ I(2) ⊆ I˜c ,
3. I(2) \ I 0 (2) ⊆ I˜ \ I˜c ,
S.1

4. if i ∈ I(2) \ I 0 (2) and i0 ∈ I 0 (2), then i π i0 , and
5. if i0 ∈ I 0 (2) \ I(2) and i ∈ I(2) ∩ Ic , then i0 π i.
Proof of Lemma S.4. The first statement in Lemma S.4 holds because under soft
˜ = |µ0 (I)|.
˜
reserves every patient is eligible for every category, which implies that |µ(I)|
˜ 0 (I)|
˜ = |µ0 (I)\µ(
˜
˜ which is equivalent to |I 0 (2)\I(2)| = |I(2)\I 0 (2)|
As a result, |µ(I)\µ
I)|,
˜ \ µ0 (I)
˜ = I 0 (2) \ I(2) and µ0 (I)
˜ \ µ(I)
˜ = I(2) \ I 0 (2).
since µ(I)
˜ π) ≤
The second statement in Lemma S.4 holds because if i ∈ µ−1 (u), then rank(i; I,
˜ Furthermore, every i ∈ µ−1 (c) is a category-c patient since there
ru . Therefore, i ∈ µ0 (I).
˜ As a result, we get
exists j ∈ I˜c such that j ∈
/ µ(I).
˜ \ µ0 (I)
˜ = I 0 (2) \ I(2).
I˜c ⊇ µ−1 (c) ⊇ µ(I)
To prove the third statement in Lemma S.4, suppose for contradiction that there
˜ \ µ(I)
˜ = I(2) \ I 0 (2). By the
exists i ∈ I(2) \ I 0 (2) such that i ∈ I˜c . Therefore, i ∈ µ0 (I)
first statement in Lemma S.4, |I 0 (2) \ I(2)| = |I(2) \ I 0 (2)| ≥ 1 because I(2) \ I 0 (2) has at
least one patient. By the second statement in Lemma S.4, I 0 (2) \ I(2) ⊆ I˜c . Therefore,
˜ \ µ0 (I)
˜ such that i0 ∈ I˜c . Since i ∈ µ0 (I),
˜ i0 ∈
˜
there exists i0 ∈ I 0 (2) \ I(2) = µ(I)
/ µ0 (I),
and τ (i) = τ (i0 ), we get
i π i0 .
˜ i∈
˜ and τ (i) = τ (i0 ) imply
Likewise, i0 ∈ µ(I),
/ µ(I),
i0 π i.
The two displayed relations above contradict each other.
The fourth statement in Lemma S.4 is true because for every i ∈ I(2) \ I 0 (2) =
˜ \ µ(I)
˜ we know that i ∈
µ0 (I)
/ I˜c by the third statement in Lemma S.4. Since µ(I˜c ) ( I˜c ,
there are at least rc patients in I˜c . Therefore, µ0−1 (c) ⊆ I˜c , which implies that i ∈ µ0−1 (u).
˜ we get i π i0 .
Since i0 ∈ I 0 (2) is equivalent to i0 ∈
/ µ0 (I),
˜ and i ∈
˜
The fifth statement in Lemma S.4 follows from i, i0 ∈ I˜c , i0 ∈ µ(I),
/ µ(I).
Lemma S.5. Suppose that c, c0 ∈ C \ {u} are different categories. Let I˜ ⊆ I and ., .0 ∈
∆({c, c0 }) be such that
•
•
•
•

. is given as c0 . c,
.0 is given as c .0 c0 ,
˜ where µ = ϕI.˜,
I(2) = I˜ \ µ(I)
˜ where µ0 = ϕI˜0 , and
I 0 (2) = I˜ \ µ0 (I)
.
S.2

• µ(I˜c ) ( I˜c .
Then the following results hold:
1.
2.
3.
4.
5.

|I(2) \ I 0 (2)| = |I 0 (2) \ I(2)|,
I 0 (2) \ I(2) ⊆ I˜c ,
I(2) \ I 0 (2) ⊆ I˜ \ I˜c ,
if i ∈ I(2) \ I 0 (2) and i0 ∈ I 0 (2), then i π i0 , and
if i0 ∈ I 0 (2) \ I(2) and i ∈ I(2) ∩ I˜c , then i0 π i.

˜ = µ0 (I)
˜ and, therefore, I(2) = I 0 (2).
Proof of Lemma S.5. If |I˜c0 | ≥ rc0 , then µ(I)
Then all the statements in Lemma S.5 hold trivially. Suppose that |I˜c0 | < rc0 for the rest
of the proof.
The first statement in Lemma S.5 follows as in the proof of the first statement in
Lemma S.4.
The second statement in Lemma S.5 holds because if i ∈ µ−1 (c0 ) and i ∈ I˜c0 , then
˜ since |I˜c0 | < rc0 . If i ∈ µ−1 (c0 ) and i ∈
i ∈ µ0 (I)
/ I˜c0 , then rank(i; I˜ \ I˜c0 , π) ≤ rc0 − |I˜c0 |. As
˜ These two statements imply that µ−1 (c0 ) ⊆ µ0 (I).
˜ Furthermore, every
a result i ∈ µ0 (I).
˜ As a result,
i ∈ µ−1 (c) is a category-c patient since there exists i ∈ I˜c such that i ∈
/ µ(I).
we get that
˜ \ µ0 (I)
˜ = µ−1 (c) \ µ0 (I)
˜ ⊆ µ−1 (c) ⊆ I˜c .
I 0 (2) \ I(2) = µ(I)
The proof of the third statement in Lemma S.5 is the same as the proof of the third
statement in Lemma S.4.
The fourth statement in Lemma S.5 is true because for every i ∈ I(2) \ I 0 (2) =
˜ \ µ(I)
˜ we know that i ∈
µ0 (I)
/ I˜c by the third statement in Lemma S.5. Moreover,
˜ which implies that there are
µ0−1 (c) ⊆ I˜c , as there exists j ∈ I˜c such that j 6∈ µ(I),
at least rc category-c patients. This implies i ∈ µ0−1 (c0 ). Furthermore, i ∈
/ I˜c0 because
˜ which follows from |I˜c0 | < rc0 . Consider i0 ∈ I 0 (2). Then i0 ∈
˜ which
I˜c0 ⊆ µ(I),
/ µ0 (I),
implies that i π i0 because µ0 (i) = c0 , τ (i) 6= c0 , and µ0 (i0 ) = ∅.
The proof of the fifth statement in Lemma S.5 is the same as the proof of the fifth
statement in Lemma S.4.
Lemma S.6. Suppose that c ∈ C \ {u} and c0 , c∗ ∈ C \ {c} are different categories. Let
I˜ ⊆ I and ., .0 ∈ ∆({c, c0 , c∗ }) be such that
• . is given as c0 . c . c∗ ,
• .0 is given as c .0 c0 .0 c∗ ,
S.3

˜ where µ = ϕI˜,
• I(3) = I˜ \ µ(I)
.
˜
0
0 ˜
0
˜
• I (3) = I \ µ (I) where µ = ϕI.0 , and
• µ(I˜c ) ( I˜c .
Then the following results hold:
1.
2.
3.
4.

|I(3) \ I 0 (3)| = |I 0 (3) \ I(3)|,
I 0 (3) \ I(3) ⊆ I˜c ,
I(3) \ I 0 (3) ⊆ I˜ \ I˜c , and
If i0 ∈ I 0 (3) \ I(3) and i ∈ I(3) ∩ I˜c , then i0 π i.

Proof of Lemma S.6. The first statement in Lemma S.6 follows as in the proof of
the first statement in Lemma S.4. Likewise, the fourth statement in Lemma S.6 follows
as in the proof of the fifth statement in Lemma S.4.
To show the other two statements, we use Lemma S.4 and Lemma S.5. Let .̂, .̂0 ∈
∆({c, c0 }) be such that
.̂ :

c0 .̂ c

and

.̂0 :

c .̂0 c0 .

˜ ˜
˜ ˜
and I 0 (2) = I˜ \ ϕI.̂0 (I).
Then I(3) = I(2) \ µ−1 (c∗ ) and I 0 (3) =
Let I(2) = I˜ \ ϕI.̂ (I)
I 0 (2) \ µ0−1 (c∗ ).
For both precedence orders . and .0 under the sequential reserve matching procedure,
consider the beginning of the third step, at which category c∗ is processed. For ., the set
of available patients is I(2). For .0 , the set of available patients is I 0 (2). If I(2) = I 0 (2),
then all the statements hold trivially because in this case we get I(3) = I 0 (3). Therefore,
assume that I(2) 6= I 0 (2). For every precedence order, rc∗ patients with the highest
priority with respect to πc∗ are chosen.
We consider each patient chosen under . and .0 for category c∗ one at a time in
sequence with respect to the priority order πc∗ . For both precedence orders there are rc∗
patients matched with c∗ because µ(I˜c ) ( I˜c . Let ik be the k th patient chosen under .
for c∗ and i0k be the k th patient chosen under .0 for c∗ where k = 1, . . . , rc∗ . Let Jk be
the set of patients available when we process . for the k th patient and Jk0 be the set of
patients available when we process .0 for the k th patient where k = 1, . . . , rc∗ . For k = 1,
0
Jk = I(2) and Jk0 = I 0 (2). By definition, Jk+1 = Jk \ {ik } and Jk+1
= Jk0 \ {i0k }. We show
that
(a) Jk0 \ Jk ⊆ I˜c ,
(b) Jk \ Jk0 ⊆ I˜ \ I˜c , and
(c) if i ∈ Jk \ J 0 and i0 ∈ (Jk ∩ J 0 ) \ I˜c∗ , then i πc∗ i0 .
k

k

S.4

by mathematical induction on k. These three claims trivially hold for k = 1 by Statements
2, 3, and 4 in Claims 1 and 2.
Fix k. In the inductive step, assume that Statements (a), (b), and (c) hold for
0
, then the statements trivially hold. Assume that
k. Consider k + 1. If Jk+1 = Jk+1
0
Jk+1 6= Jk+1 which implies that J` 6= J`0 for ` = 1, . . . , k. There are four cases depending
on which sets ik and i0k belong to. We consider each case separately.
Case 1: ik ∈ Jk \ Jk0 and i0k ∈ Jk0 ∩ Jk . Then
0
Jk+1
\ Jk+1 = (Jk0 \ {i0k }) \ (Jk \ {ik }) = Jk0 \ Jk

and

0
Jk+1 \ Jk+1
= (Jk \ {ik }) \ (Jk0 \ {i0k }) = (Jk \ Jk0 ) \ {ik } ∪ {i0k }.
0
By Statement (a) of the inductive assumption for k, Jk+1
\ Jk+1 = Jk0 \ Jk ⊆ I˜c .
Therefore, Statement (a) holds for k + 1.
As Jk0 6= Jk and |Jk | = |Jk0 | because of the soft-reserves condition, Jk0 \ Jk has at least
one category-c patient. Moreover, this patient has higher priority with respect to πc∗
than any other category-c patient in Jk0 ∩ Jk because the former is chosen under . while
the later is not chosen under .. Therefore, i0k cannot be a category-c patient. As a result,
0
Jk+1 \ Jk+1
⊆ I˜ \ I˜c , so Statement (b) holds for k + 1.
0
To show Statement (c) for k + 1, observe that Jk+1 \ Jk+1
= ((Jk \ Jk0 ) \ {ik }) ∪ {i0k }
0
and Jk+1 ∩ Jk+1
= (Jk ∩ Jk0 ) \ {i0k }). Therefore, Statement (c) for k + 1 follows from
0
.
Statement (c) for k and the fact that i0k πc∗ i for any i ∈ Jk+1 ∩ Jk+1

Case 2: ik ∈ Jk \ Jk0 and i0k ∈ Jk0 \ Jk . Then,
0
Jk+1
\ Jk+1 = (Jk0 \ {i0k }) \ (Jk \ {ik }) = (Jk0 \ Jk ) \ {i0k }

and
0
Jk+1 \ Jk+1
= (Jk \ {ik }) \ (Jk0 \ {i0k }) = (Jk \ Jk0 ) \ {ik }.
0
0
Therefore, Jk+1
\ Jk+1 ⊆ I˜c and Jk+1 \ Jk+1
⊆ I˜ \ I˜c by Statements (a) and (b) for k,
respectively, implying Statements (a) and (b) for k + 1.
0
To show Statement (c) for k + 1, observe that Jk+1 \ Jk+1
= (Jk \ Jk0 ) \ {ik } and
0
Jk+1 ∩ Jk+1
= Jk ∩ Jk0 . Therefore, Statement (c) for k + 1 follows from Statement (c) for
k trivially.

S.5

Case 3: ik ∈ Jk ∩ Jk0 and i0k ∈ Jk0 ∩ Jk . In this case, ik = i0k , then
0
\ Jk+1 = (Jk0 \ {i0k }) \ (Jk \ {ik }) = Jk0 \ Jk
Jk+1

and
0
= (Jk \ {ik }) \ (Jk0 \ {i0k }) = Jk \ Jk0 .
Jk+1 \ Jk+1

Therefore, Statements (a) and (b) for k + 1 follows from the respective statements for k.
0
0
=
= Jk \ Jk0 and Jk+1 ∩ Jk+1
To show Statement (c) for k + 1, observe that Jk+1 \ Jk+1
0
(Jk ∩ Jk ) \ {ik }. Therefore, Statement (c) for k + 1 follows from Statement (c) for k
trivially.
Case 4: ik ∈ Jk ∩ Jk0 and i0k ∈ Jk0 \ Jk . We argue that this case is not possible. Since
i0k ∈ Jk0 \ Jk , i0k must be a category-c patient by Statement (a) for k. If c∗ = u, then every
patient in Jk \ Jk0 has a higher priority with respect to π than every patient in Jk ∩ Jk0 ,
which cannot happen since ik ∈ Jk ∩ Jk0 . Therefore, c∗ 6= u. Since i0k is a category-c
patient, there must not be a category-c∗ patient in Jk0 . By Statement (c) for k, we know
that every patient in Jk \ Jk0 has a higher priority with respect to πc∗ than every patient
in (Jk ∩ Jk0 ) \ Ic∗ = Jk ∩ Jk0 . This is a contradiction to ik ∈ Jk ∩ Jk0 . Therefore, Case 4 is
not possible.
Since I(3) = Jrc∗ and I 0 (3) = Jr0 c∗ , Statements 2 and 3 in Lemma S.6 follow from
Statements (a) and (b) above, respectively.
Lemma S.7. Suppose that c ∈ C \ {u} and c0 , c∗ , c̃ ∈ C \ {c} are different categories. Let
I˜ ⊆ I and ., .0 ∈ ∆({c, c0 , c∗ , c̃}) be such that
•
•
•
•
•

. is given as c0 . c . c∗ . c̃,
.0 is given as c .0 c0 .0 c∗ .0 c̃,
˜ where µ = ϕI˜,
I(4) = I˜ \ µ(I)
.
˜
0
0 ˜
0
˜
I (4) = I \ µ (I) where µ = ϕI.0 , and
µ(I˜c ) ( I˜c .

Then the following results hold:
1.
2.
3.
4.

|I(4) \ I 0 (4)| = |I 0 (4) \ I(4)|,
I(4) \ I 0 (4) ⊆ I˜ \ I˜c ,
if i0 ∈ I 0 (4) \ I(4), i0 ∈
/ I˜c , and i ∈ I(4), then i0 π i, and
if i0 ∈ I 0 (4) \ I(4), i0 ∈ I˜c , and i ∈ I(4) ∩ I˜c , then i0 π i.

Proof of Lemma S.7. The first statement in Lemma S.7 follows as in the proof of
the first statement in Lemma S.4. Likewise, the fourth statement in Lemma S.7 follows
S.6

as in the proof of the fifth statement in Lemma S.4.
To prove the other two statements, we use Lemma S.6. Let .̂, .̂0 ∈ ∆({c, c0 , c∗ }) be
such that
and
.̂0 : c .̂0 c0 .̂0 c∗ .
.̂ : c0 .̂ c .̂ c∗
˜ ˜
˜ ˜
and I 0 (3) = I˜ \ ϕI.̂0 (I).
Let I(3) = I˜ \ ϕI.̂ (I)
Then I(4) = I(3) \ µ−1 (c̃) and I 0 (4) =
I 0 (3) \ µ0−1 (c̃).
For both precedence orders . and .0 under the sequential reserve matching procedure,
consider the beginning of the fourth step, at which category c̃ is processed. For ., the set
of available patients is I(3). For .0 , the set of available patients is I 0 (3). If I(3) = I 0 (3),
then I(4) = I 0 (4) which implies all the statements in Lemma S.7. Therefore, assume
that I(3) 6= I 0 (3). For every precedence order, rc̃ patients with the highest priority with
respect to πc̃ are chosen.
We consider each patient chosen under . and .0 for category c̃ one at a time in sequence
with respect to the priority order πc̃ . Since µ(I˜c ) ( I˜c , rc̃ patients are matched with c̃
under both precedence orders. Let ik be the k th patient chosen under . for c̃ and i0k be
the k th patient chosen under .0 for c̃ where k = 1, . . . , rc̃ . Let Jk be the set of patients
available when we process . for the k th patient and Jk0 be the set of patients available
when we process .0 for the k th patient where k = 1, . . . , rc̃ . For k = 1, Jk = I(3) and
0
Jk0 = I 0 (3). By definition, Jk+1 = Jk \ {ik } and Jk+1
= Jk0 \ {i0k }.
We show that
(a) Jk \ J 0 ⊆ I˜ \ I˜c ,
k

(b) if c̃ = u, i0 ∈ Jk0 \ Jk , τ (i0 ) 6= c, and i ∈ Jk , then i0 π i,
(c) if c̃ 6= u, i0 ∈ Jk0 \ Jk , τ (i0 ) 6= c, and i ∈ Jk , then (Jk ∪ Jk0 ) ∩ Ic̃ = ∅ and i0 π i
(d) if c̃ =
6 u, then (Jk0 \ Jk ) ∩ Ic̃ = ∅.
by mathematical induction on k. These three claims trivially hold for k = 1 by Statements
2 and 3 in Lemma S.6.
Fix k. In the inductive step, assume that Statements (a), (b), (c), and (d) hold for
0
k. Consider k + 1. If Jk+1 = Jk+1
, then the statements trivially hold. Assume that
0
Jk+1 6= Jk+1 which implies that J` 6= J`0 for ` = 1, . . . , k. There are four cases depending
on which sets ik and i0k belong to. We consider each case separately.
Case 1: ik ∈ Jk \ Jk0 and i0k ∈ Jk0 ∩ Jk . When |{i0 ∈ Jk0 \ Jk : τ (i0 ) 6= c}| ≥ 1, i0k ∈ Jk0 \ Jk
by Statements (b) and (c) for k. Therefore, |{i0 ∈ Jk0 \ Jk : τ (i0 ) 6= c}| = 0. Furthermore,
0
Jk+1
\ Jk+1 = (Jk0 \ {i0k }) \ (Jk \ {ik }) = Jk0 \ Jk

S.7

and
0
Jk+1 \ Jk+1
= (Jk \ {ik }) \ (Jk0 \ {i0k }) = ((Jk \ Jk0 ) \ {ik }) ∪ {i0k }.

Since |Jk0 | = |Jk | and Jk0 6= Jk , we get |Jk0 \ Jk | ≥ 1. Therefore, Jk0 \ Jk has at least
one category-c patient because |{i0 ∈ Jk0 \ Jk : τ (i0 ) 6= c}| = 0. Moreover, this patient has
higher priority with respect to πc̃ than any other category-c patient in Jk0 ∩ Jk because
the former patient is chosen under . and the latter is not, so i0k cannot be category c.
Therefore, Statement (a) for k + 1 follows from Statement (a) for k. Statements (b) and
(c) trivially hold for k + 1 as well because
0
{i0 ∈ Jk+1
\ Jk+1 : τ (i0 ) 6= c} = {i0 ∈ Jk0 \ Jk : τ (i0 ) 6= c} = ∅.

Statement (d) for k + 1 follows from Statement (d) for k.
Case 2: ik ∈ Jk \ Jk0 and i0k ∈ Jk0 \ Jk . Then
0
Jk+1
\ Jk+1 = (Jk0 \ {i0k }) \ (Jk \ {ik }) = (Jk0 \ Jk ) \ {i0k }

and
0
Jk+1 \ Jk+1
= (Jk \ {ik }) \ (Jk0 \ {i0k }) = (Jk \ Jk0 ) \ {ik }.
0
Since Jk+1 \ Jk+1
⊆ Jk \ Jk0 , Statement (a) for k + 1 follows from Statement (a) for k.
Likewise, Statements (b), (c), and (d) for k + 1 follow from the corresponding statements
0
0
for k because Jk+1
\ Jk+1 ⊆ Jk0 \ Jk , Jk+1
∪ Jk+1 ⊆ Jk0 ∪ Jk , and Jk+1 ⊆ Jk .

Case 3: ik ∈ Jk ∩ Jk0 and i0k ∈ Jk0 ∩ Jk . In this case, ik = i0k , then
0
Jk+1
\ Jk+1 = (Jk0 \ {i0k }) \ (Jk \ {ik }) = Jk0 \ Jk

and
0
Jk+1 \ Jk+1
= (Jk \ {ik }) \ (Jk0 \ {i0k }) = Jk \ Jk0 .

In this case, Statements (a), (b), (c), and (d) for k + 1 follow from their respective
statements for k.
Case 4: ik ∈ Jk ∩ Jk0 and i0k ∈ Jk0 \ Jk . In this case,
0
Jk+1
\ Jk+1 = (Jk0 \ {i0k }) \ (Jk \ {ik }) = ((Jk0 \ Jk ) \ {i0k }) ∪ {ik }

and
0
Jk+1 \ Jk+1
= (Jk \ {ik }) \ (Jk0 \ {i0k }) = Jk \ Jk0 .

S.8

Statement (a) for k + 1 follows from Statement (a) for k trivially.
Statement (b) for k + 1 follows from ik π i for any i ∈ Jk+1 and also from Statement
(b) for k.
To show Statement (d) for k + 1, suppose that c̃ 6= u. Then by Statement (d) for k,
Jk0 \ Jk does not have a category-c̃ patient. Since i0k ∈ Jk0 \ Jk , this implies that there are
no category-c̃ patients in Jk0 . Therefore, ik does not have category c̃. We conclude that
0
\ Jk+1 = ((Jk0 \ Jk ) \ {i0k }) ∪ {ik } does not have a category c̃ patient, which is the
Jk+1
Statement (d) for k + 1.
0
To show Statement (c) for k + 1, suppose that c̃ 6= u, i0 ∈ Jk+1
\ Jk+1 , τ (i0 ) 6= c,
0
\ Jk+1 = ((Jk0 \ Jk ) \ {i0k }) ∪ {ik }
and i ∈ Jk+1 . If i0 6= ik , then i0 ∈ Jk0 \ Jk since Jk+1
and Statement (c) for k + 1 follows from Statement (c) for k because i ∈ Jk+1 ⊆ Jk .
Otherwise, suppose that i0 = ik . By Statement (d) for k + 1, i0 does not have category c̃,
which implies that there are no category-c̃ patients in Jk ; this in turn implies there are
no category-c̃ patients in Jk+1 since Jk+1 ⊆ Jk . Furthermore, by Statement (d) for k + 1,
0
there are no category-c̃ patients in Jk+1
\ Jk+1 . We conclude that there are no category-c̃
0
patients in Jk+1
∪ Jk+1 . Finally, i0 πc̃ i for any i ∈ Jk+1 = Jk \ {i0 } and since there are no
0
category-c̃ patients in Jk+1
∪ Jk+1 we get i0 π i.
Since I(4) = Jrc̃ and I 0 (4) = Jr0 c̃ , Statement 2 in Lemma S.7 follows from Statement
(a) and Statement 3 in Lemma S.7 follows from Statements (b) and (c).
Lemma S.8. Suppose that c ∈ C \ {u} and c0 , c∗ , c̃, ĉ ∈ C \ {c} are different categories.
Let I˜ ⊆ I and ., .0 ∈ ∆({c, c0 , c∗ , c̃, ĉ}) be such that
•
•
•
•
•

. be such that c0 . c . c∗ . c̃ . ĉ,
.0 be such that c .0 c0 .0 c∗ .0 c̃ .0 ĉ,
˜ where µ = ϕI˜,
I(5) = I˜ \ µ(I)
.
˜
0
0 ˜
0
˜
I (5) = I \ µ (I) where µ = ϕI.0 , and
µ(I˜c ) ( I˜c .

Then the following results hold:
1. |I(5) \ I 0 (5)| = |I 0 (5) \ I(5)| and
2. I(5) \ I 0 (5) ⊆ I˜ \ I˜c .
Proof. The first statement in Lemma S.8 follows as in the proof of the first statement
in Lemma S.4.
To prove the second statement, we use Lemma S.7. Let .̂, .̂0 ∈ ∆({c, c0 , c∗ , c̃}) be such
that
.̂ : c0 .̂ c .̂ c∗ .̂ c̃
and
.̂0 : c .̂0 c0 .̂0 c∗ .̂ c̃.
S.9

˜ ˜
˜ ˜
Let I(4) = I˜ \ ϕI.̂ (I)
and I 0 (4) = I˜ \ ϕI.̂0 (I).
Then I(5) = I(4) \ µ−1 (c̃) and I 0 (5) =
I 0 (4) \ µ0−1 (c̃).
For both precedence orders . and .0 under the sequential reserve matching procedure,
consider the beginning of the fifth step, at which category ĉ is processed. For ., the set
of available patients is I(4). For .0 , the set of available patients is I 0 (4). If I(4) = I 0 (4),
then we get I(5) = I 0 (5), which implies all the statements. Therefore, assume that
I(4) 6= I 0 (4). For every precedence order, rĉ patients with the highest priority with
respect to πĉ are chosen.
We consider each patient chosen under . and .0 for category ĉ one at a time in sequence
with respect to the priority order πĉ . Since µ(I˜c ) ( I˜c , rĉ patients are matched with ĉ
under both precedence orders. Let ik be the k th patient chosen under . for ĉ and i0k be
the k th patient chosen under .0 for ĉ where k = 1, . . . , rĉ . Let Jk be the set of patients
available when we process . for the k th patient and Jk0 be the set of patients available
when we process .0 for the k th patient where k = 1, . . . , rĉ . For k = 1, Jk = I(4) and
0
Jk0 = I 0 (4). By definition, Jk+1 = Jk \ {ik } and Jk+1
= Jk0 \ {i0k }.

We show that
(a) Jk \ Jk0 ⊆ I˜ \ I˜c and
(b) if i0 ∈ Jk0 \ Jk and i ∈ Jk ∩ I˜c , then i0 πĉ i
by mathematical induction on k. These results trivially hold for k = 1 by Statements 2,
3, and 4 in Lemma S.7.
Fix k. In the inductive step, assume that Statements (a) and (b) hold for k. Consider
0
0
k + 1. If Jk+1 = Jk+1
, then the statements trivially hold. Assume that Jk+1 6= Jk+1
which
0
implies that J` 6= J` for ` = 1, . . . , k. There are four cases depending on which sets ik
and i0k belong to. We consider each case separately.
Case 1: ik ∈ Jk \ Jk0 and i0k ∈ Jk0 ∩ Jk . Then
0
Jk+1
\ Jk+1 = (Jk0 \ {i0k }) \ (Jk \ {ik }) = Jk0 \ Jk

and

0
Jk+1 \ Jk+1
= (Jk \ {ik }) \ (Jk0 \ {i0k }) = (Jk \ Jk0 ) \ {ik } ∪ {i0k }.
If i0k ∈ I˜c , then we get a contradiction to Statement (b) for k. Therefore, i0k ∈
/ I˜c , which
implies that Statement (a) holds for k +1 by Statement (a) for k and the second displayed
equation. Statement (b) for k + 1 follows trivially from Statement (b) for k, the first
displayed equation, and Jk ⊇ Jk+1 .
S.10

Case 2: ik ∈ Jk \ Jk0 and i0k ∈ Jk0 \ Jk . Then
0
\ Jk+1 = (Jk0 \ {i0k }) \ (Jk \ {ik }) = (Jk0 \ Jk ) \ {i0k }
Jk+1

and
0
= (Jk \ {ik }) \ (Jk0 \ {i0k }) = (Jk \ Jk0 ) \ {ik }.
Jk+1 \ Jk+1

In this case, Statements (a) and (b) for k + 1 follow trivially from the corresponding
statements for k.
Case 3: ik ∈ Jk ∩ Jk0 and i0k ∈ Jk0 ∩ Jk . In this case, ik = i0k , then
0
Jk+1
\ Jk+1 = (Jk0 \ {i0k }) \ (Jk \ {ik }) = Jk0 \ Jk

and
0
Jk+1 \ Jk+1
= (Jk \ {ik }) \ (Jk0 \ {i0k }) = Jk \ Jk0 .

In this case, Statements (a) and (b) for k + 1 follow trivially from the corresponding
statement for k.
Case 4: ik ∈ Jk ∩ Jk0 and i0k ∈ Jk0 \ Jk . In this case,
0
Jk+1
\ Jk+1 = (Jk0 \ {i0k }) \ (Jk \ {ik }) = ((Jk0 \ Jk ) \ {i0k }) ∪ {ik }

and
0
Jk+1 \ Jk+1
= (Jk \ {ik }) \ (Jk0 \ {i0k }) = Jk \ Jk0 .

Then Statement (a) for k + 1 follows from Statement (a) for k. Furthermore, ik πĉ i for
any i ∈ Jk+1 , which together with Statement (b) for k imply Statement (b) for k + 1.
Since I(5) = Jrĉ and I 0 (5) = Jr0 ĉ , Statement 2 in Lemma S.8 follows from Statement
(a).
Proof of Proposition 3. Let |C| ≤ 5. Let C ∗ = {c∗ ∈ C : c∗ . c0 } be the set of
categories processed before c0 under . and before c under .0 . The orders of categories
in C ∗ are the same with respect to . and .0 . Thus, just before category c0 is processed
under . and c is processed under .0 , the same patients are matched in both sequential
reserve matching procedures. Let I˜ be the set of patients that are available at this point
in either procedure.
Let .̂ be the incomplete precedence order on C \ C ∗ that processes categories in the
same order as in .. Likewise, let .̂0 be the incomplete precedence order on C \ C ∗ that
S.11

processes categories in the same order as in .0 .
˜
˜
If ϕI.̂ (I˜c ) = I˜c then the result is proven. Therefore, assume that ϕI.̂ (I˜c ) ( I˜c in the
rest of the proof. Let k = |C \ C ∗ | be the number of remaining categories.
˜
˜
• If k = 2, then by Lemmas S.4 and S.5, we obtain ϕI.̂0 (I˜c ) ⊆ ϕI.̂ (I˜c ).
˜
˜
• If k = 3, then by Lemma S.6, we obtain ϕI.̂0 (I˜c ) ⊆ ϕI.̂ (I˜c ).
˜
˜
• If k = 4, then by Lemma S.7, we obtain ϕI.̂0 (I˜c ) ⊆ ϕI.̂ (I˜c ).
˜
˜
• If k = 5, then by Lemma S.8, we obtain ϕI 0 (I˜c ) ⊆ ϕI (I˜c ).
.̂

.̂

These imply that
ϕ.0 (Ic ) ⊆ ϕ. (Ic )
completing the proof.

C

A Polynomial Time Method for Smart Reserve
Matching Procedure
Consider the following algorithm for any n:

Step 0. Find a matching that is maximal and complies with eligibility requirements by
temporarily deeming that a patient i ∈ I is eligible for a category c ∈ C \ {u}
if and only if i ∈ Ic , and no patient is eligible for unreserved category u. This
is known as a bipartite maximum cardinality matching problem in graph theory
and many augmenting alternating path algorithms (such as those by Hopcroft and
Karp, 1973; Karzanov, 1973) can solve it in polynomial time. The solution finds the
maximum number of patients who can be matched with a preferential treatment
category that they are a beneficiaries of. Denote the number of patients matched
by this matching as nb .
Step 1. Let J0u = ∅, J0 = ∅. Fix parameters κ   > 0 such that  < 1 and κ > |I|. For
u
k = 1, . . . , |I| we repeat the following substep given Jk−1
, Jk−1 :
Step 1.(k). Suppose ik is the patient who is prioritized k th in I according to π.
u
i. if |Jk−1
| < n continue with (i.A) and otherwise continue with (ii).
u
A. Temporarily deem all patients in Jk−1
∪ {ik } eligible only for category u and all other patients eligible only for the categories in
C \ {u} that they are beneficiaries of.
B. for every pair (i, x) ∈ I × C ∪ {∅} define a weight Wi,x ∈ R as
follows:

S.12

• If x ∈ C and i is temporarily eligible for x as explained in
(i.A),
u
– if i ∈ Jk−1
∪ Jk−1 , then define Wi,x := κ,
– otherwise, define Wi,x := .

• If x ∈ C and i is not temporarily eligible for x as explained
in (i.A), define Wi,x := −.
• If x = ∅, define Wi,x := 0.
C. Solve the following assignment problem to find a matching
σ ∈ arg max
µ∈M

X

Wi,µ(i)

i∈I

using a polynomial algorithm such as the Hungarian algorithm
(Kuhn, 1955).
u
D. If |σ(I)| = nb + |Jk−1
| + 1 then define
u
Jku := Jk−1
∪ {ik } and Jk := Jk−1 ,

and go to Step 1.(k + 1) if k < |I| and Step 2 if k = |I|.
E. Otherwise, go to (ii).
ii. Repeat (i) with the exception that ik is temporarily deemed eligible only
for the categories in C\{u} that she is a beneficiary of in Part (ii.A). Parts
(ii.B) and (ii.C) are the same as Parts (i.B) and (i.C), respectively, with
the exception that weights are constructed with respect to the eligibility
construction in (ii.A). Parts (ii.D) and (ii.E) are as follows:
u
D. If |σ(I)| = nb + |Jk−1
| and σ(i) =
6 ∅ for all i ∈ Jk−1 ∪ {ik }, then
define
u
and Jk := Jk−1 ∪ {ik },
Jku := Jk−1

and go to Step 1.(k + 1) if k < |I| and Step 2 if k = |I|.
E. Otherwise,
u
Jku := Jk−1
and Jk := Jk−1 ,
and go to Step 1.(k + 1) if k < |I| and Step 2 if k = |I|.
Step 2.

(a) Find a matching σ as follows:
u
i. Temporarily deem all patients in J|I|
eligible only for category u, all
patients in J|I| eligible only for the categories in C \ {u} that they are

S.13

beneficiaries of, and all other patients ineligible for all categories.
ii. Find a maximal matching σ among all matchings that comply with
the temporary eligibility requirements defined in (i) using a polynomial
augmenting alternating paths algorithm (for example see Hopcroft and
Karp, 1973; Karzanov, 1973).
(b) Modify σ as follows:
One at a time assign the remaining units unmatched in σ to the remaining
u
highest priority patient in I \ (J|I|
∪ J|I| ) who is eligible for the category of the
assigned unit in the real problem in the following order:
i. the remaining units of the preferential treatment categories in C \ {u}
in an arbitrary order, and
ii. the remaining units of the unreserved category u.
Step 3. Define
ISn := σ(I).
Matching σ is a smart reserve matching with n unreserved category units processed
first.
The difference between this algorithm and the procedure we gave in the text is that
we do not have to construct the matching sets Mk in every Step 1(k), as this is an NPcomplete problem to solve. Instead, we solve appropriately constructed polynomial-time
optimization problems in |I| in each step to see whether desired matching exists in each
step. As there are polynomial number of steps in |I|, the resulting algorithm becomes
polynomial.

D

Resource-Dependent Design Considerations

In this section, we offer some thoughts about how to implement a reserve system
might depend on the resource that is rationed. In Sections 3 and 4, we model pandemic
rationing as a one-shot static reserve system. Several vital resources, however, must
be rationed during a pandemic as patients in need present. Hence, it is important to
formulate how our static model can be operationalized in an application where patient
arrival and allocation are both dynamic. The adequate formulation depends on the
specific characteristics of the rationed resource. Most notably, answers to the following
two questions factor in the implementation details:
1. Is the resource fully consumed upon allocation or is it durable, utilized over a period,
and can it be re-allocated?
S.14

2. Is there immediate urgency for allocation?
Since most guidelines are on rationing of vaccines, ventilators, ICU beds, and anti-viral
drugs or treatments, we focus our discussion on these four cases.

D.1

Vaccine Allocation

A unit of a vaccine is consumed upon allocation and reallocation of the unit is not
possible. Moreover, there is no immediate urgency to allocate a vaccine. Hence, a large
number of units can be allocated simultaneously. Therefore, vaccine allocation is an
application of our model where our proposed reserve system can be implemented on a
static basis as vaccines become available.
This is, however, not the only reasonable way a reserve system can be operationalized
for vaccine allocation. In the United States, there is a tradition of distributing influenza
vaccines at local pharmacies or healthcare providers on a first-come-first-serve basis. This
practice can be interpreted as a single-category special case of a reserve system where
the priorities are based on the time of arrival. This practice can easily be extended
to any sequential reserve matching system with multiple categories where the baseline
priorities are determined by the time of arrival. Under this dynamic implementation of
a reserve system, as a patient arrives to a healthcare provider she is allocated a vaccine
as long as there is availability in a category for which she is a beneficiary. If there are
multiple such categories, the patient is assigned a unit from the category that has the
highest precedence under the sequential reserve matching. While many have criticized
first-come-first-serve allocation because of biases it induces based on access to health care
(e.g., Kinlaw and Levine (2007)), reserve categories can be designed to mitigate these
biases, even if priority is first-come-first-serve within each category. For example, there
can be a reserve category for patients from rural areas. There is an important precedent
for using a reserve system in this dynamic form. Between 2005-2008, H-1B immigration
visas in the US were allocated through a reserve system with general and advanced-degree
reserve categories where priority for each category was based on the application arrival
time (Pathak, Rees-Jones, and Sönmez, 2020).

D.2

Ventilator/ICU Bed Allocation

Since the relevant characteristics of ventilators and ICU beds are identical in relation
to our model, the implementation of reserve systems for these resources will be similar.
Therefore, we present the details of their implementation together. For simplicity in this
subsection, we refer the resource in short supply as a ventilator.

S.15

A ventilator is durable and can be reassigned once its use by its former occupant
is completed. Moreover, there is always urgency in allocation of this vital resource.
These two features make direct static implementation of a reserve system impractical;
implementation always has to be dynamic. One important observation on ventilator
allocation is key to formulate the implementation: since a ventilator is durable and
assigned to a patient for a period, it can be interpreted as a good which is allocated at
each instant. During the course of using a ventilator, a patient’s clinical situation and
her priority for one or more categories may change. Therefore, with the arrival of each
new patient, the allocation of all units has to be reevaluated. As such, the following
additional ethical and legal consideration has an important bearing on the design of a
reserve system:
3. Can a patient be removed from a ventilator once she is assigned?
There is widespread debate on this issue in the United States. Piscitello et al. (2020)
describes 25 states with protocols that discuss the ethical basis of re-assigning ventilators.
As of June 2020, the majority of guidelines support ventilator withdrawal. If a ventilator
can be withdrawn, the design is simpler (and effectively identical to static implementation
with each new arrival). While patient data needs to be updated through the duration of
ventilator use, no fundamental adjustment is needed for the design of the main parameters
of the reserve system. Of course in this scenario, it is possible that the category of the
unit occupied by the patient may change over time. For example, a patient may initially
be assigned a unit from the general category even though she has sufficiently high priority
for multiple categories such as the general category and essential personnel category. At
a later time, she may only have high enough priority for the latter category. In this case,
the patient will continue using the ventilator although for accounting purposes she will
start consuming a unit from a different category.
If a ventilator cannot be withdrawn, a reserve system can still be applied with a
grandfathering structure to reflect the property rights of patients who are already assigned. In this case, the priority system has to give highest priority to occupants of the
units from any category for as long as they can hold these units despite a change in their
clinical situation or arrival of patients who otherwise would have higher priority for these
units.

D.3

Anti-viral Drugs or Treatments

For anti-virals drugs and treatments, the vital resource is consumed upon allocation
(as in vaccine allocation) but there is typically urgency and allocation decisions will
S.16

need to be made as patients arrive (as in ventilator allocation). One possible dynamic
implementation is based on first-come-first-serve arrival within reserve categories. This
would be akin to the dynamic allocation scenario for ventilators with a baseline priority
structure that depends on patient arrival time as described in Section D.1. Alternatively,
drug assignment can be batched within pre-specified time-windows. Drugs can then be
assigned based on expectations of the number of patients in each category over this time
window. Since drugs would be administered by a clinician, the relationship between a
reserve system and cutoffs can be particularly valuable. A clinician can simply assign
the treatment to a patient if she clears the cutoff for any reserve for which she is eligible.
In fact, after the first version of our paper was circulated, some of the authors assisted
with the design of the system used at the University of Pittsburgh Medical Center to
allocate the anti-viral drug remdesivir in May 2020 with this implementation. The system had special provisions for hardest hit and essential personnel and used lotteries for
prioritization (see White et al. (2020) for more details on this system.)

S.17

E

Cutoffs in Real-life Applications

Figure A1. Examples of Cutoffs in Reserve Systems from Chicago’s Affirmative Action System in 2020
and Indian Civil Service Assignment in 2012

S.18

