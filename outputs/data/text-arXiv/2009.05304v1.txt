Probabilistic and mean-field model of COVID-19
epidemics with user mobility and contact tracing
M. Akian∗ , L. Ganassali† , S. Gaubert‡ , L. Massoulié§

arXiv:2009.05304v1 [stat.AP] 11 Sep 2020

September 14, 2020

Abstract
We propose a detailed discrete-time model of COVID-19 epidemics coming in two flavours,
mean-field and probabilistic. The main contribution lies in several extensions of the basic model
that capture i) user mobility – distinguishing routing, i.e. change of residence, from commuting,
i.e. daily mobility – and ii) contact tracing procedures. We confront this model to public data on
daily hospitalizations, and discuss its application as well as underlying estimation procedures.

Contents
1

Single Population Model
1.1 Deterministic version: mean-field model . . . . . . . . . . . . . . . . . . . . . . . . .
1.2 Probabilistic version: multi-type branching process . . . . . . . . . . . . . . . . . .
1.3 Extension with contact tracing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3
5
6
7

2

Inference methods
2.1 Perron’s theory for fitting and inference in the mean-field setting . . . . . . . . . .
2.2 Kalman filtering for the branching process . . . . . . . . . . . . . . . . . . . . . . .

9
9
10

3

Numerical illustration on Paris hospitalization data
3.1 Simulation settings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.2 Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

12
12
13

4

Variable contact rates

14

5

Model with Routing Mobility
5.1 Model parameters for subpopulations . . . . . . . . . . . . . . . . . . . . . . . . . .
5.2 Routing step in the mean field version . . . . . . . . . . . . . . . . . . . . . . . . . .
5.3 Estimation of routing fractions and numbers of contacts . . . . . . . . . . . . . . . .

18
18
19
20

Introduction
A profusion of mathematical models of the COVID-19 epidemic propagation has been developed
in a very short time lapse. Specific models were designed to address particular objectives, such as
∗ INRIA

and CMAP, École polytechnique, IP Paris, CNRS. Email: marianne.akian@inria.fr.
DI/ENS, PSL Research University, Paris, France. Email: luca.ganassali@inria.fr.
‡ INRIA and CMAP, École polytechnique, IP Paris, CNRS. Email: stephane.gaubert@inria.fr.
§ MSR-Inria
Joint Centre,
INRIA, DI/ENS, PSL Research University,
Paris,
France.
laurent.massoulie@inria.fr.
† INRIA,

1

Email:

forecasting the epidemics, understanding the impact of various interventions such as restraining
mobility and contacts between users, or deploying contact tracing and case isolation.
The goal of this study is to propose a single model of COVID-19 epidemics based on a well
understood family of probabilistic models – that of multi-type branching processes – and to detail
simple extensions of this model that capture the impact of contact tracing procedures as well as
user mobility.
Our model can serve several purposes: It can be used to assess from available time series
so-called contact rates, and in turn the impact of user mobility on epidemic propagation. It can
also be used in surveillance platforms to infer the status of specific sub-populations (in particular
fraction of infectious or immunized persons), a prerequisite for the implementation of targeted
testing campaigns.
Paper organization We introduce in Section 1 a discrete time epidemiological model of COVID19 for a homogeneous population. We detail a probabilistic version of the model, that is a multitype branching process. It represents in a precise manner the durations of the principal phases
of a patient’s condition and the transition rates between such phases. A deterministic version of
this model is then described. We then introduce a simple extension of the model to represent the
impact of contact tracing and case isolation.
In Section 2, we describe two methods that both use model structure for inference of parameters and prediction. For the deterministic, or mean-field version of the model, we propose an
approach to perform inference that relies on Perron’s theory. For the probabilistic version of the
model, by exploiting the fact that we are dealing with a hidden Markov model, we propose a
Kalman filtering approach to perform inference.
Next, we present a numerical illustration in Section 3, where the model is fitted to daily counts
of hospitalizations in the Paris area. There we estimate piecewise constant contact rates corresponding to distinct time periods, namely pre-confinement, intermediate, and confinement periods. We discuss the application of this fitting procedure to forecasting the future number of
hospitalizations.
We then describe in Section 4 an extension for the contact rates to take daily mobility – or other
covariates – into account, making these parameters depend on time.
We finally discuss in Section 5 the extension of the model to multiple sub-populations, corresponding e.g. to geographical regions and age ranges. Key parameters in this extension are
contact matrices, describing the frequency of contacts between sub-populations. The routing dimension of this extension is detailed. we revisit the question of estimating model parameters,
specifically contact matrices in this multi sub-populations model. We assume potentially timevarying contact matrices and consider estimation of such contact matrices based on user mobility
traces.
Related work SIR or SEIR-type models of COVID-19 featuring asymptomatic or undocumented
infectious individuals have been considered in [11], [14] and [2]. Studies [14, 2] consider same
contact rates for symptomatic and asymptomatic cases. Some works [13] also consider a split of
the infectious phase to explicit the occurrence of aggravated symptoms.
General distributions of times spent in a given state have been studied. Prodromic phase, during which individuals are infectious, yet have not displayed symptoms, is considered in [3]. The
model of [3] comprises a detailed breakdown in various phases, yet relies on geometric/exponential
durations for time spent in each phase, while the model of [15] describes general discrete time distributions for the time spent in states.
A broad range of studies have addressed the issue of estimating the time spent in a given state.
In [12], the incubation period is modeled with a log-normal distribution with mean 5.8 days. In
[9], the median incubation period was estimated to be 5.1 days, and 97.5% of those who develop
symptoms will do so within 11.5 days of infection.

2

[1] reviews studies of the infectious period’s duration, reporting several estimates with substantial variations, giving for asymptomatic cases an estimate of 6.5-9.5 days. Pre-symptomatic
infectious period is estimated to 0-4 days across studies. [16] also investigates the time between
infection and remission/death.
The model of Figure 1 is a simplified version of the model considered in [3], which features additional states, including a breakdown between hospitalized cases entering Intensive Care Units
or not, and a distinction between several severity levels of the infection. It is similar to the model
considered in [13], with a key difference in our model that is that we take the discrete time t into
account.

1

Single Population Model
TH ∼ 4 days

αi
TE ∼ 3 − 5 days

TP ∼ 1 − 2 days

E

P
αa

αi

pi

H

ph

I1

1 − ph

TI1 ∼ 4 − 8 days

I2

R

TI2 ∼ 4 days

1 − pi
αa

A
TA ∼ 11 days

Figure 1: State diagram for individual’s condition in model 1. Dotted arrows show the contamination of new cases: the mean number of new E cases per day per A/P (resp. per I1 /I2 ) individual
is αa (resp. αi ).
We consider the discrete time SEIR-type model depicted in Figure 1. We classify the states of an
individual as E for exposed; P for prodromic; A for infectious asymptomatic; I1 for phase 1 infectious
symptomatic; H for hospitalized; I2 for (non-hospitalized) phase 2 infectious symptomatic; and R for
removed from the contamination chain. After having moved to prodromic phase P , an individual
becomes either asymptomatic (state A) or symptomatic, entering state I1 . After some time in the
I1 state, two situations arise: either the individual is hospitalized, entering state H, either there is
no aggravation, leading to state I2 . Then, the last state is always R, where the individual is either
dead or recovered.
We shall in fact adopt a more detailed representation for the state of an individual: its detailed
state will be represented by a couple (a, t) where a ∈ {E, A, I1 , H, I2 , R} is the stage of the disease, and t the number of days spent in this stage. For instance, an individual in state (E, 3) just
completes their third day in the exposed phase.
Remark 1.1. (i) In epidemiological models one often tracks individuals in so-called susceptible
state S: these are those individuals who may get exposed to infection. In the case of a
negligible fraction of infected individuals, in particular in the early stages of the epidemics,
on which we focus, it is not necessary to track them, hence our choice not to include state S
in the diagram of Figure 1.

3

1

(ii) We distinguish between asymptomatic and symptomatic individuals, as new symptomatic
cases can be observed when the corresponding individuals consult their physician or enter
hospital after experiencing serious symptoms.
(iii) We distinguish between hospitalized and non-hospitalized cases. The number of new hospital admissions can be measured, for instance, from medical emergency services records.
(iv) We distinguish according to the number of days an individual has spent in its current state
for the following reason. Traditional SEIR-type models implicitly assume that the time that
an individual spends in a particular state admits an exponential distribution (for continuous
time ODE-based models) or a geometric distribution (for discrete time models). However
the durations spent in the states of interest for COVID-19 appear to be very far from exponentially distributed. Thus, for an accurate short-term prediction of the epidemics evolution, one needs to take this number of days into account.
State variables We represent the dynamics by means of the following state variables. On each
day t, we represent the population by a vector x(t) with entries:
xE,d (t) : number of individuals in phase E, having spent d days in this phase;
xP,d (t) : number of individuals in phase P , having spent d days in this phase;
xI1 ,d (t) : phase 1 infectious individuals, having spent d days in this phase;
xI2 ,d (t) : phase 2 infectious individuals having spent d days in this phase;
xA,d (t) : asymptomatic individuals having spent d days in this phase;
xH (t) : number of individuals newly hospitalized on day t.
By considering the state variable xH (t), instead of xH,d (t), we ignore the number of days an individual spends at hospital. This stems from the assumption that such cases are efficiently isolated
and do not contribute to propagating the epidemics, an assumption that could be revised.
Distribution of phase durations For each τ ∈ {E, P, I1 , I2 , A}, define rτ (d) the probability that
corresponding phase will end on the following day, given that it has lasted d days. Denoting by
pτ (d) the probability that phase τ lasts d days, rτ (d) is the associated failure rate, defined by
(
Pd
P pτ (d)
if δ=1 pτ (δ) > 0,
p
(δ)
τ
δ≥d
(1)
rτ (d) =
0
otherwise.
Available statistics suggest that typical durations lie in the ranges given on Figure 1. A reasonable
baseline assumption could consist in taking
• pE (d) = 1/3 for d ∈ {3, 4, 5} and pE (d) = 0 otherwise,
• pP (1) = pP (2) = 1/2 and pP (d) = 0 otherwise,
• pI1 (d) = 1/3 for d ∈ {5, 6, 7} and pI1 (d) = 0 otherwise,
• pI2 (d) = 1 for d = 4 and pI2 (d) = 0 otherwise,
• pA (d) = 1 for d = 11 and pA (d) = 0 otherwise.
Note however that far longer durations have been observed, e.g. incubation lasting 10 days or
more; I1 phase between first symptoms and aggravation lasting as long as 20 days. This baseline is
therefore by no means an accepted characterization of the dynamics of an individual’s condition.

4

Transition probabilities
• pi : probability that previously exposed individual becomes symptomatic at end of incubation. A baseline assumption consists in taking pi = 0.7. Again, no consensus has emerged
yet on the fraction of asymptomatic infected users and competing assumptions have been
proposed (for baselines, data from APHP https://www.aphp.fr can be used, as done e.g. in
[3]).
• ph : probability that previously phase 1 infectious individual develops aggravated form at
end of phase 1. A baseline assumption consists in taking ph = 0.05, again with the same
cautionary note.
Contact rates
• αi : average number of new exposed individuals generated by single infectious individual
(I1 , I2 ) in a single day. Here we do not distinguish between phases 1 and 2, an assumption
which could be revisited.
• αa : average number of new exposed individuals generated by single asymptomatic or prodromic individual in a single day.
In the sequel we assume that αa = αi . This assumption is often made, for instance in [14, 2]. In
contrast, [11] makes an explicit distinction in contact rates α for documented cases and µα for
undocumented ones. Especially, an estimate for µ in China between January 10th and January
23th is given: µ ∼ 0.55 (95% confidence interval: (0.46, 0.62)).
Remark 1.2. This model can be complemented by equations giving the number of deaths and
immunizations per day. This, together with a tracking of the volume of compartment S, could
be useful if one wishes to estimate the proportion of immunized individuals in the population.
Denoting by pd the probability of death conditional on having been hospitalized, and assuming
that only hospitalized individuals die, this leads to two other state variables:
xdeath (t + 1) = pd xH (t),
ximmun (t + 1) = (1 − pd )xH (t) +

X

xA,δ (t)rA (δ) + xI2 ,δ (t)rI2 (δ).

δ>0

The number of deaths as written neglects time between hospitalization and death.
Observables We assume that coordinates xH (t) are observed by the end of day t. This would
correspond to the number of new hospitalized patients with COVID-19 pathology. In contrast,
the states variables xE (t), xA (t), xP (t) are never observed. They will later be referred to as hidden
trajectories. It would be straightforward to adjust the model to incorporate other observables, such
as the number of patients consulting their physician on each day.

1.1

Deterministic version: mean-field model

This is a deterministic, linear model, based on the assumption that the fraction of susceptible
individuals in the total population is close to 1. In other words it is meant to represent stages of
the epidemics where collective immunization is yet negligible. Simple adjustments can be made
to transform this model to account for a non-negligible, time-evolving, fraction of immunized
population.
Assume there is a maximal number of days, h, that each of the phases E, P , I1 , I2 , A can last.
Let xE = (xE,1 , . . . , xE,h )> , xP = (xP,1 , . . . , xP,h )> , and similarly for h-dimensional vectors xA ,
xI1 , xI2 . The state space on day t, x(t), is given by

5


xE (t)
 xP (t) 


xI1 (t)


x(t) := 

 xA (t) 
xI2 (t)
xH (t)

(2)

x(t + 1) = M x(t),

(3)



The dynamics are then given by
where matrix M is specified by the detailed equations, for d ∈ [h − 1]:
∀τ ∈ {E, P, I1 , I2 , A} , xτ,d+1 (t + 1) = xτ,d (t)(1 − rτ (d)),
X
xE,1 (t + 1) =
[αi (xI1 ,δ + xI2 ,δ )(t) + αa (xA,δ + xP,δ )(t)] ,
δ>0

xP,1 (t + 1) =

X

xE,δ (t)rE (δ),

δ>0

xI1 ,1 (t + 1) = pi

X

xP,δ (t)rP (δ),

δ>0

xA,1 (t + 1) = (1 − pi )

X

xP,δ (t)rP (δ),

δ>0

xI2 ,1 (t + 1) = (1 − ph )

X

xI1 ,δ (t)rI1 (δ),

δ>0

xH (t + 1) = ph

X

xI1 ,δ (t)rI1 (δ).

δ>0

1.2

Probabilistic version: multi-type branching process

We now transform the previous mean field model into a probabilistic counterpart: a multi-type (or
multi-dimensional) branching process. Consideration of probabilistic behaviour is particularly
relevant when we deal with not-so-large infected populations, or in sub-critical cases where the
largest eigenvalue λ1 (M ) of matrix M defined in (3) verifies λ1 (M ) ≤ 1. Indeed, when λ1 (M ) > 1,
by results of Kesten and Stigum [7], there is a random variable Z such that for large t, the state
X(t) renormalized by λ1 (M )−t converges to Zu, where u is the eigenvector of M associated with
eigenvalue λ1 (M ). This provides a theoretical justification of the mean field model in the case of
large infected populations. Figure 2 gives a numerical illustration of this result.
The number of newly exposed individuals now follows a Poisson distribution with mean as
specified in the mean field model. Determination of durations in each state, and choice of next
state at branches in the state diagram of Figure 1, are made with independent random coins with
the prescribed probabilities.
For clarity, to distinguish between the two versions, random variables will be denoted in capital letters through the rest of this article. Binomial (resp. Poisson) distributions are denoted by B
(resp. P).

6

Thus, conditioning to state vector X(t) at time t, the state X(t + 1) at time t + 1 verifies:
∀τ ∈ {E, P, I1 , I2 , A} , Xτ,d+1 (t + 1) ∼ B (Xτ,d (t), 1 − rτ (d)) ,
!
XE,1 (t + 1) ∼ P

X

[αi (XI1 ,δ + XI2 ,δ )(t) + αa (XA,δ + XP,δ )(t)] ,

δ>0

XP,1 (t + 1) =

X

[XE,δ (t) − XE,δ+1 (t + 1)] ,

δ>0

!
XI1 ,1 (t + 1) ∼ B

X

[XP,δ (t) − XP,δ+1 (t + 1)] , pi

,

δ>0

XA,1 (t + 1) =

X

[XP,δ (t) − XP,δ+1 (t + 1)] − XI1 ,1 (t + 1),

δ>0

!
XI2 ,1 (t + 1) ∼ B

X

[XI1 ,δ (t) − XI1 ,δ+1 (t + 1)], 1 − ph

,

δ>0

XH (t + 1) =

X

[XI1 ,δ (t) − XI1 ,δ+1 (t + 1)] − XI2 ,1 (t + 1).

δ>0

Probabilistic trajectory
Deterministic trajectory

Number of hospitalized individuals

103

102

101

100

0

10

20

30

Time

40

50

60

Figure 2: Trajectories of newly hospitalized individuals of length 60 days from the probabilistic
and deterministic versions, with pa = 0.3, ph = 0.05, αi = 0.4, αa = 0.3, initialized with 200
individuals entering in E.

1.3

Extension with contact tracing

One motivation of the present study is the control of the epidemics via case isolation, that is quarantining of identified cases so that they do not contribute to further virus propagation. The main
approach to deploy case isolation relies on identification of infectious cases via tests. Thus, when
testing capacity is limited, efficient case isolation crucially depends on targeted test campaigns.
Contact tracing is of paramount importance for targeting tests: it allows to determine who has
been in contact with infectious cases, and hence focus tests on such contacts.
We now describe an extension of our previously introduced model to include contact tracing and case isolation. In a nutshell, the model assumes that those individuals subsequently infected by a specific person (its children in the branching tree associated to the branching process)
7

get tested with some probability once that specific person is positively tested (and subsequently
isolated). This formalization of contact tracing has already been considered in [8] for a simple
branching process, analyzing the efficiency of contact tracing plus case isolation to control epidemics. We give here a more general version, providing a generic method to expand the state
space of a multi-type branching process in order to capture the introduction of contact tracing
plus case isolation.
Consider then a multi-type branching process where user types are indexed by j ∈ [J]. For
the sake of generality, we shall assume that types j encode the succession of future phases φ that
an individual will visit over the coming days. Thus an individual with type j = {E, E, P, I1 , H}
is in state E for the present day and the next, and will then spend a single day in the states P ,
then I1 , and then H subsequently. Also, an individual with type j = {φ1 , . . . , φ` } on a given day
will become an individual with type j 0 = {φ2 , . . . , φ` } on the next day.
Note that the previous branching process gives rise to an equivalent branching process with
this set of types, as can be seen by sampling, upon birth of an individual, the sequence of states φ
it will visit after its birth.
We now assume that there is a set Φ0 of distinguished states φ ∈ Φ0 such that an individual
entering a state φ in Φ0 automatically incurs a positive test. Concretely, the state φ = H, namely
hospitalization of the individual, would automatically trigger a positive test, and we may think
of Φ0 as the singleton {H}.
We then assume that, for some fixed tracing probability pt > 0, the contact between an infectious individual and another individual that became infected is being recorded. The original
branching process dynamics are then modified as follows: once an individual is tested positive,
it is isolated (removed) and its traced contacts are subsequently tested positive on the following
day, and subsequently isolated, and so on.
The key observation is that this modification preserves the branching structure, provided we
perform the following extension of the original type space [J]. The new type space becomes
J = {(j, d) : j ∈ [J], d ∈ [Dmax ] ∪ {+∞}},
where the second coordinate d represents the number of days until the corresponding individual
will be positively tested.
Upon birth of an individual whose parent has type (j, d), the newly born individual will have
type (j 0 , d0 ). We now specify the distribution of the pair (j 0 , d0 ). First sample a sequence j 00 =
{φ001 , . . . , φ00`00 } ∈ [J] conditionally on j with the same conditional distribution as in the original
branching process. Let d1 = inf{k ≥ 1 : φ0k ∈ Φ0 } be the number of days before the newly born
individual enters some state in Φ0 .
We then let

d1
with probability 1 − pt ,
0
d =
(4)
min(d1 , d + 1) with probability pt .
this reflects the fact that if traced, the new individual will become tested either when it enters
some state in Φ0 , or on the day after its parent gets tested, whichever happens first. If untraced,
it only becomes tested on the day it enters some state in Φ0 . Finally, we let j 0 = {φ001 , . . . , φ00d0 }, i.e.
we truncate the sequence j 00 to length d0 , thereby encoding the impact of case isolation, by which
a positively tested individual can no longer infect anyone else.
Note that further extensions can be considered that preserve the branching process structure.
Here is an example of such an extension. Assume that on each day, each infected individual
may be submitted to a randomly administered test, and trigger a positive test reply, this happening independently with probability ε on any given day. To reflect such random tests, the abovedescribed dynamics would then need to be amended in the following manner. For an individual
newly born from a (j, d)-parent, sample a random variable X distributed as
X = G · 1G≤Dmax + ∞ · 1G>Dmax ,
8

(5)

where G follows a geometric distribution of parameter ε.
With j 00 and d1 as above, let then

min(d1 , X)
d0 =
min(d1 , X, d + 1)

with probability 1 − pt ,
with probability pt .

(6)

The construction then goes through unchanged, letting j 0 = {φ01 , . . . , φ00d0 } and the newly born
individual’s type being (j 0 , d0 ).
The above extensions to the original branching process can be used to assess how the tracing
probability pt , or the fraction  of random tests, affects the potency of the epidemics. In particular,
one may consider the mean progeny matrix M , indexed by extended types j ∈ [J 0 ] and associated
with the branching process that captures contact tracing.
A crude criterion for success of contact tracing consists in requiring that the spectral radius
ρ(M ) be strictly less than 1. Under such conditions, given a vector x(0) capturing the initial number of individuals of each type, then the expectation of Xinfected , the total number individuals
ultimately infected, reads
X
hx(0), M t ei = hx(0), (I − M )−1 ei.
E(Xinfected ) =
(7)
t≥0

In the above, e denotes the all-ones vector and the second equality is valid whenever ρ(M ) < 1.
This expression for E(Xinfected ) can be further processed to obtain simple upper bounds. Particularly simple upper bounds have been obtained in [4] in the case where M is symmetric. However symmetry does not hold for the matrices M considered here, so that we cannot rely on the
bounds of [4].

2

Inference methods

In this section, we propose inference methods for our model. We consider a general deterministic
(respectively, probabilistic) setting where the state vector at time t is denoted by x(t) (resp. X(t)).
Individual types are now denoted by j ∈ [J], and Mi,j is the mean number of type i−children
from a type j−parent. M > is known as the mean-progeny matrix in branching process theory. It
depends on a parameter of interest θ ∈ Θ, that encapsulates for instance pi , ph , αa , αi and time
distributions in Section 1, as well as pt and cmax if we consider contact tracing as in Section 1.3.
We assume that the observed trajectories are the first h coordinates of x(t) (resp. X(t)), denoted
by xH (t) (resp. XH (t)), all other coordinates being hidden trajectories.

2.1

Perron’s theory for fitting and inference in the mean-field setting

For simplicity, assume that the remaining unknown parameters of the model are the contact rates
αa and αi , all other parameters having correctly been estimated, e.g. from patient statistics compiled at hospitals.
Constant contact rates In the case where contact rates are constant at θ0 = (αi,0 , αa,0 ), the state
at time t is given by x(t) = M (θ0 )t x(0). Its behavior is determined at first order by the largest
eigenvalue of matrix M = M (θ0 ), λ1 (M ), x(t) being close to cλ1 (M )t u, where u is the eigenvector
of M associated with eigenvalue λ1 (M ) and c some constant. The exponential rate of growth
λ1 (M ) of observable xH (t) can be estimated, e.g. by fitting a regression line to the semilog plot
up to time t of the corresponding time series, thus producing the estimate λ̂(t).

9

For a single population, in the mean field model, estimation of the exponent λ1 (M ) gives one
relation constraining the unknown parameters, namely:
λ̂(t) = λ1 (M (θ0 )) =: F (θ0 ).

(8)

Remark 2.1. Let p be a polynomial such that p(M ) = 0 (p could be the characteristic polynomial of
Pd
M for instance). Writing p(z) = z d − i=1 ad−i z i , from the expression xH (t) = PH M t x(0) valid
in the mean-field model, it readily follows that
xH (t) =

d
X

ai xH (t − i).

(9)

i=1

In other words, the observables xH (t) follow an auto-regressive dynamics. Instead of estimating unknown coefficients of matrix M , one could therefore estimate directly the auto-regressive
coefficients ai . The latter approach is potentially simpler, and suffices if one is only interested
in forecasting xH (t). The coefficients ai however do not have a direct physical interpretation, in
contrast to the coefficients of M . Estimation of M is therefore better suited to assess the impact of
specific measures.
Reaction to shocks If on given day t0 (start of confinement say), the parameters αi and αa
abruptly change, the dynamics from t0 onwards would again be linear, with a modified matrix
M (θ1 ) with θ1 = (αi,1 , αa,1 ) corresponding to the new contact rates. This suggests the following
approach for inferring these parameters.
Estimate the state vector x(t0 ) as Cu, for some constant C = C(θ0 ) such that CuH = xH (t0 ),
where uH is the projection of u = u(θ0 ) on the first h vectors of the canonical basis.
Leverage then the transient behaviour of the post-shock dynamics as follows. Making the
dependency of the post-shock matrix M (θ1 ) on the unknown θ1 explicit, estimate the unknown
(θ0 , θ1 ) as the minimizers of the optimization problem:
min

2
X 

t−t0
M (θ1 )
C(θ0 )u(θ0 ) H − xH (t) .

θ0 ,θ1
t>T0
F (θ0 )=λ̂(t0 )

(10)

Remark 2.2. The above optimization criterion is essentially motivated by the assumption of constant contact parameters before and after the shock. This is a strong assumption, verified at best
in an approximate sense. See [10] which considers multiple phases in an SIR dynamics, to be fitted to observations. In Section 3 we will consider two shocks. Time-varying contact rates will be
discussed below in Section 4.
We just saw how to leverage Perron’s theory to perform inference in the mean-field version
of the model. Let us now describe an inference method in the probabilistic model which – as
already explained – is more relevant when dealing with small populations, e.g. when studying
sub-critical evolutions in a decay phase, or spread relaunch phases.

2.2

Kalman filtering for the branching process

In the following paragraph we describe an inference method in the probabilistic setting that enables to estimate the state X(t) (including hidden trajectories) by updating the estimation at every
new time step. The vector of average numbers per type at generation t, conditionally on the initial
state to be X(0) ∈ RJ , is M t X(0).
Measurement errors
follows:

∗
First, we describe a model for measures, that is the observed data XH
, as
∗
XH
(t) = PH X(t) + v(t),

10

(11)

where PH is the h × J matrix of the projection on the h last components of the canonical basis,
and v(t) is a centered noise, with covariance matrix R(t), representing the confidence in measurements.
∗
∗
Model errors Now, we introduce the filtration Ft := σ (XH
(0), . . . , XH
(t)), that is the σ−algebra
generated by all measurements up to time t. We provide estimates of states X(t), as well as the
estimated errors. We will use the following notations:

• X̂(t): an estimate of state X(t) given Ft , and P (t) its covariance matrix,
• X̂(t|t − 1): an estimate of X(t), given Ft−1 , and P (t|t − 1) its covariance matrix.
At time t, we write
X(t) = M X(t − 1) + u(t),
with u(t) = X(t) − M X(t − 1) a centered vector. For j ∈ [J], let Si denote the covariance matrix
of vector of children from type i-parent. The covariance matrix Q(t) of u(t) can be computed as
follows:
Q(t) := Var (u(t))




= E Var X(t) − M X(t − 1) X(t − 1) + Var E X(t) − M X(t − 1) X(t − 1)


X
= E
X(t − 1)j Sj  + 0
j∈[J]

=

X

(M t−1 X(0))j Sj .

j∈[J]

The fact that closed-form expressions for second moments are available is a consequence of the
Markovian structure of our model. The same Markovian structure also implies that u(t) is decorrelated from any Ft−1 −measurable variable.
Kalman filtering The strategy is then to compute X̂(t|t − 1) at each step, and to adjust the pre∗
diction with the measurement XH
(t) to build X̂(t), assuming that X̂(t) is of the form


∗
X̂(t) := X̂(t|t − 1) + K(t) XH
(t) − PH X̂(t|t − 1) .
Optimizing K(t) in the quadratic error sense leads to Kalman filtering (see e.g. [6]), which is the
best linear recursive estimator in our setting, namely a hidden Markov model. With this method,
at each time t, we perform the following predictions:
X̂(t|t − 1) = M X̂(t − 1),
P (t|t − 1) = M · P (t − 1) · M > + Q(t),

(12)

∗
then we adjust our estimates, updating with the new measure XH
(t):

−1
>
>
K(t) := P (t|t − 1) · PH
· PH · P (t|t − 1) · PH
+ R(t)
,
∗
X̂(t) = X̂(t|t − 1) + K(t) · (XH
(t) − PH X̂(t|t − 1)),

(13)

P (t) = (IdJ − K(t) · PH ) P (t|t − 1).
The intermediate matrix K(t) of size J × h is usually called the Kalman gain. A possible initial
condition consists for instance in setting X(0) = ei , that is one initial individual in a given state
i ∈ [J], with P (0) = 0J , the J × J null matrix.

11

The above discussion shows how to leverage the model structure to provide an alternative
approach to maximum likelihood estimation approaches.
Such techniques can be used in a single population scenario, as we illustrate in the next section. They could however become prohibitive for the multi-population scenarios we shall consider
later, and for which the Kalman filtering approach may be an appealing alternative.

3

Numerical illustration on Paris hospitalization data

In this section, we illustrate the probabilistic version of our model by fitting it to daily hospitalization data, and show how to use it to forecast future numbers of hospitalizations.
The population we will consider is that of department 75 (Paris, France). We still assume that
∗
the only observed trajectory is XH
(t), the number of new hospitalizations, all other trajectories
being hidden. A noisy version of this data, namely the number of new COVID-19 hospitalizations
every day in Paris, can be found in public data provided by SurSaUD syndromic surveillance
system.
Though Kalman filtering approach – as described in Section 2 – would be natural here, we
take a more direct, brute-force method, using Monte-Carlo simulation to infer the parameters.

3.1

Simulation settings

For simulations of our probabilistic model, we take pi = 0.7, ph = 0.05 (see Transition probabilities
in Section 1). We initialize the time range on February 8th, which is 18 days before the first local
SARS-CoV2 death case in France. We focus on the pre-confinement and confinement phases, so
the fitting is made up to May 5th, on a total of 72 days for the train set. The period from May 6th
to May 12th is kept as the test set for prediction (see below).
Recall that for contact parameters, we assume αi = αa = α. Furthermore we assume that it is
piecewise constant on the time range, as follows:
• between day 0 (February 8th) and day t2 , α = α1 .
• between day t2 and day t3 , α = α2 .
• between day t3 and day T (May 5th), α = α3 .
The three phases can be identified to the pre-confinement phase, the confinement phase I and confinement phase II, each phase being the result of several changes: mainly political decisions, but
also work habits, observance of the rules, etc. In order to get a fitting as realistic as possible, the
boundaries of these three phases are also inferred.
Inferred parameters, loss function In total, six parameters (XE (0), α1 , t2 , α2 , t3 , α3 ) are tuned.
XE (0) is the initial condition, that is the initial number of exposed individuals. This quantity is
then divided and allocated to all variables XE,d (0) according to distribution pE described in Section 1.
Given (XE (0), α1 , t2 , α2 , t3 , α3 ), we sample several independent trajectories of X(t). Now we
consider two choices for the loss function.
We first define the L1 loss function as follows:
#
"
T
1X
∗
|XH (t) − XH (t)| ,
(14)
L (XE (0), α1 , t2 , α2 , t3 , α3 ) := EXE (0)
T t=0
∗
where XH is the random trajectory under model 1, and XH
is the observed data.

12

Second, since we expect exponential growth for the variables of interest (see e.g. 1.2 or 2.1),
we shall also consider the L1 -log loss function:
"
#
T
1X
∗
e
L (XE (0), α1 , t2 , α2 , t3 , α3 ) := EXE (0)
|log XH (t) − log XH (t)| .
(15)
T t=0
For both choices, we aim to minimize the loss function on our train set. To do so, we perform a
naive grid search in six dimensions, computing at each step an empirical expectation of the loss
for the chosen parameters over sampled trajectories, in order to compute approximate solutions
(X̂E (0), α̂1 , t̂2 , α̂2 , t̂3 , α̂3 ) of
arg min

Loss (XE (0), α1 , t2 , α2 , t3 , α3 ) ,

(16)

XE (0),α1 ,α2 ,α3 ∈R+
t2 ,t3 ∈[T ]

n
o
for Loss ∈ L, Le .
Prediction After having estimated all the parameters, we use our model to predict the evolution of trajectories in a future time range. In our example, this time range runs from T + 1 (May
6th) to Tpred (May 12th), that is a period of one week.
The performance of our predicition (over our test set) is evaluated in terms of the mean L1
norm


Tpred
X
1
∗
|XH (t) − XH
(t)| ,
(17)
Lpred := Efit 
Tpred − T
t=T +1

where the probability Pfit is defined for previously inferred parameters (X̂E (0), α̂1 , t̂2 , α̂2 , t̂3 , α̂3 )
in equation (16).
We chose as our test criterion in (17) absolute deviation rather than deviation between logarithms because this corresponds to an error in the absolute numbers of hospital entrances, which
has arguably a clearer operational meaning.

3.2

Results

The inferred parameters with SurSaUD data, together with the training and test errors, are summed
up in Table 1. Corresponding curves of inferred parameters, predicted hidden variables and hospital entrances are given in Figure 3 and Figure 4.
Loss function
L1 (L)
1
e
L -log (L)

X̂E (0)
59
18

α̂1
0.360
0.455

t̂2
03-15
03-15

α̂2
0.215
0.265

t̂3
03-20
03-20

α̂3
0.042
0.040

Fitting error
11.1195 ± 0.0232
0.29904 ± 0.00062

Prediction error Lpred
4.0093 ± 0.0185
3.7201 ± 0.0125

Table 1: Approximate values of inferred parameters, for department 75, approximated with the
probabilistic model, with SurSaUD data. All errors are given with their 95% confidence interval
obtained by Monte Carlo simulations.
Several remarks can be made from these results:
• The Lpred prediction error is of order 4, which is to be compared to the typical diameter of
a 95% confidence interval in the prediction time range in Figure 3 and Figure 4, which is
about 10. We measure a prediction error which is less than half a typical uncertainty on a
sampled stochastic trajectory XH (t) with fitted parameters. This supports the claim that a
prediction error of order 4 is the best possible with our model.
13

• For both loss functions, the optimal transition points t1 and t2 are identified on March 15th
and March 20th. Some other strategies could have been used to identify phases, e.g. by
∗
fitting a piecewise linear regression model on the observations log XH
(t), and reporting
them earlier on the contact rates, according to the distributions of phase durations, as done
in recent work by Gaubert et al. [5]. For the Paris population, the major political decisions
and events occurred on March 12th (closure of all schools and universities), March 14th
(closure of all non essential public places), March 15th (municipal elections) and March 17th
(lockdown). These phases do not necessarily exactly coincide with the transition points, this
can be caused e.g. by assumptions made for time parameters (see Section 1), and delays due
to observance of the rules. In addition, we fixed three phases, but this number is arbitrary
and could be discussed (see e.g. [10]).
• From the figures, the L1 -log Loss function Le seems to give better results for the fitting part
(which is not surprising since we are in log scale), but this is also true for prediction, as
presented in Table 1. This can justify the use of the L1 -log Loss function Le in future work.
• These results, though based on noisy data and perfectible with other datasets or broader
inference, validate our model: with few parameters, the evolution of epidemics can be described in a satisfactory way: with the L1 -log Loss function for instance, the mean relative
error is ∼ 12.1% (in logarithmic scale) for the trajectory of XH (t).
As shown in this section, the model of Figure 1 can be useful to describe the evolution of crucial
variables such as the number of daily hospitalized individuals, but also show hidden trajectories,
and predict hospital load on future days.
We considered piecewise constant contact rates in Section 2 for inference purposes, and performed corresponding numerical illustration in the present Section. We shall now consider the
case of contact rates that are no longer piecewise constant, being potentially dependent not just
on “shocks” such as the start of confinement, but also on other covariates. For instance, regular
day-to-day mobility or commuting flows of population could also impact contact rates, as we now
investigate.

4

Variable contact rates

Contact rates are now assumed to depend on piece-wise constant rates depending on specific
temporal phases, as described before, and daily variables that are responsible for additional variability. Among these daily variables, some are related to user mobility, and in particular on the
daily outflow, that is the number of day-return trips outside the region of interest.
The model we advocate is then exactly as in Section 1, except that contact rates αi , αa are now
time-dependent.
Mobility-dependent contact rates Assuming that the daily outflows f (t) (assumed to be normalized so as to have zero mean and standard deviation 1) are known, the contact rates αa , αi are
now mobility-dependent in the following way:
αi (t) = Fi (φ(t), f (t)) ,
αa (t) = Fa (φ(t), f (t)) .

(18)

In the above, φ(t) is a discrete phase (e.g. φ(t) ∈ {1, 2, 3} as in Section 3), and Fi , Fa are fixed
functions. These could be taken as logistic functions in the variable f (t); alternatively, one might
take
αi (t) = αi,φ(t) (1 + γi f (t)) ,
αa (t) = αa,φ(t) (1 + γa f (t)) .
14

(19)

101

05-12

05-06

04-29

04-22

04-15

Time

04-08

04-01

03-11

03-04

02-26

100

03-25

Mean simulated number of newly hospitalized individuals
Mean predicted number of newly hospitalized individuals
Observed number of newly hospitalized individuals (SURSAUD data)
95% confidence interval
95% confidence interval
03-18

Number of hospitalized individuals

102

104

102

04-29

04-22

04-15

Time

04-08

04-01

03-11

03-04

02-26

100

03-25

Mean simulated number of newly hospitalized individuals
Observed number of newly hospitalized individuals (SURSAUD data)
Mean simulated number of newly exposed individuals
Mean simulated number of newly asymptomatic individuals
95% confidence interval
95% confidence interval
95% confidence interval

101

03-18

Number of individuals

103

0.35
0.30
0.25
0.20
0.15
0.10

04-29

04-22

04-15

Time

04-08

04-01

03-25

03-18

03-11

03-04

02-26

0.05

Figure 3: Best fitting of our probabilistic model with SurSaUD data for Paris with L1 cost function,
with prediction, some hidden trajectories, and variation of contact rates αa = αi .
15

101

05-12

05-06

04-29

04-22

04-15

Time

04-08

04-01

03-11

03-04

02-26

100

03-25

Mean simulated number of newly hospitalized individuals
Mean predicted number of newly hospitalized individuals
Observed number of newly hospitalized individuals (SURSAUD data)
95% confidence interval
95% confidence interval
03-18

Number of hospitalized individuals

102

104

102

04-29

04-22

Time

04-15

04-08

04-01

03-11

03-04

02-26

100

03-25

Mean simulated number of newly hospitalized individuals
Observed number of newly hospitalized individuals (SURSAUD data)
Mean simulated number of newly exposed individuals
Mean simulated number of newly asymptomatic individuals
95% confidence interval
95% confidence interval
95% confidence interval

101

03-18

Number of individuals

103

0.4

0.3

0.2

04-29

04-22

04-15

Time

04-08

04-01

03-25

03-18

03-11

03-04

02-26

0.1

Figure 4: Best fitting of our probabilistic model with SurSaUD data for Paris with log-L1 cost
function, with prediction, some hidden trajectories, and variation of contact rates αa = αi .
16

With this formulation, variables αi,φ(t) (resp. αa,φ(t) ) is the value of αi (resp. αa ) when the commuting flow is at its equilibrium, and γi , γa are non-negative parameters.
Figure 5 below gives illustrates the evolution of the contact rates for Paris based on Equation
(19), where the observables f (t) are obtained from SFR mobile operator data.

0.5
0.4
0.3
0.2

04-13

04-06

03-30

03-23

Time

03-16

03-09

03-02

02-24

02-17

02-10

02-03

0.1

Figure 5: Example of mobility-dependent contact rates with equation (19) for Paris, based on SFR
data. Parameters: αi,1 = αa,1 = 0.45, αi,2 = αa,2 = 0.3, αi,3 = αa,3 = 0.05, γi = γa = 0.15.
The shape of the resulting contact rates reflects the discrete phases as before, together with
weekly periodicity patterns. Contact rates are lower on Saturdays and Sundays, when daily commuting trips are less numerous, as expected.
Remark 4.1. In its mean-field version, the model with variable contact rates is
"
#
K
X
x(t + 1) = M0 +
αk (t)Mk x(t),
k=1

for fixed matrices M0 , . . . , MK and scalars αk (t) that depend on mobility covariates relative to
time t. Assume for tractability that the covariates αk (t) are small, so that heuristically we have
the first order approximation, for τ ∈ [d],
x(t) ≈ M0τ x(t − τ ) +

τ X
K
X

αk (t − i)M0i−1 Mk x(t − i).

i=1 k=1

Pd
Following on Remark 2.1, let p(z) = z d − i=1 ai z d−1 be a degree-d polynomial such that p(M0 ) =
0. We then have the first-order expansion in the α(t):

x(t) ≈

d
X

ai M0d−i x(t − d) +

i=1

≈

d
X
i=1

d X
K
X

αk (t − i)M0i−1 Mk x(t − i)

i=1 k=1


ai x(t − i) −

d−i X
K
X


αk (t − i − j)M0j−1 Mk x(t − i − j) +

j=1 k=1

d X
K
X
i=1 k=1

17

αk (t − i)M0i−1 Mk x(t − i).

Provided that for all i = 0, . . . , d − 1 and all k ∈ [K], there exist matrices Nk,i and polynomials
Pd(k,i)
pk,i (z) = r=0 br (k, i)z r of degree d(k, i) ≤ i such that PH M0i Mk = Nk,i PH pk,i (M0 ), then up to
terms of first order one has
d(k,i)

PH M0i Mk x(s) = Nk,i

X

d(k,i)

br (k, i)PH M0r x(s) ≈ Nk,i

r=0

X

br (k, i)xH (s + r).

r=0

Plugged into the previous display, this entails that the observations xH (t) satisfy an auto-regressive
relation with coefficients involving the covariates α, of general form:
xH (t) =

d
X

α(t − i)Pi,j xH (t − j),

(20)

i,j=1

where Pi,j are constant matrices. A possible approach could then consist, for prediction purposes,
in fitting such an auto-regressive relation while learning suitable functions α(t) of available covariates.
Besides commuting outflows mentioned above, another aspect of mobility that plays an important role is that of routing, that is change of residence location: this happens during holiday
periods, but has also happened at the start of lockdown, where a significant exodus from dense
urban areas towards countryside has been observed.
We now describe an extension of our model that captures such routing.

5

Model with Routing Mobility

To introduce routing, we must first consider an extension of our basic model to cover multiple
cohorts, or sub-populations. For the sake of readability we only describe the generalized model
in its mean-field version. However a probabilistic version could easily be described along the
same lines as in the single population case.
We thus introduce a subdivision of the global population into cohorts c ∈ C. These could for
instance be given by a couple (r, a) characterizing geographical regions r and age ranges a.
A potential alternative to the above definition of cohort c is to define sub-population according
to a given age range a, the region r in which the corresponding persons usually live, and the region
r0 in which they slept the previous night. In that case, we have c = (r, r0 , a). This notion of cohort is
particularly important to describe our routing model, and account for viral dissemination through
regions.
We denote by Nc (t) the size of cohort c at time t.

5.1

Model parameters for subpopulations

The model is as follows. Each cohort c ∈ C has its own biological parameters θc (encapsulating
e.g. contact rates, distributions of phase durations, etc.). A natural assumption is to take these to
depend only on age range. Per age parameters could be obtained from hospital-collected statistics.
Routing dynamics of Nc (t) For a given cohort c ∈ C, the time evolution of Nc (t) is the result of
population flows. We represent such flows in the following manner: we have
X
Nc (t + 1) =
Rc0 ,c (t)Nc0 (t) + Ec (t + 1),
(21)
c0 ∈C

where Rc0 ,c (t) is the fraction of individuals counted in Nc0 (t) on day t, that have migrated to be
counted in Nc (t + 1) on day t + 1. The case c0 = c of sedentary individuals (no migration) is also

18

taken into account. New external arrivals in c (say, from a foreign country) are accounted for by
Ec (t + 1). We also assume that for all cohort c0 ,
X
Rc0 ,c (t) ≤ 1,
(22)
c∈C

allowing for departures outside the considered population (say, abroad) when the sum is strictly
less than 1.
Daily activity, contact between sub-populations On day t, a contact intensity factor nc,c0 (t)
gives the average number of individuals from cohort c0 that a typical individual from cohort c
will encounter. It is natural to assume that
Nc (t)nc,c0 (t) = Nc0 (t)nc0 ,c (t)

(23)

Parameter qc,c0 represents the probability that upon a contact between individuals from population c and population c0 , infection gets propagated from that in c to that in c0 . It is natural to
assume that qc,c0 only depends on the age ranges of c and c0 . We then let
αc,c0 (t) := qc,c0 nc,c0 (t),

(24)

the infection rate from c to c0 on day t. For simplicity we do not distinguish between asymptomatic/prodromic (previously αa ) and symptomatic individuals (previously αi ) here.
Note that the above dynamics, and in particular Equations (23), (24) generalize the mobilitydependent contact rates of Section 4 to the multi-subpopulation case.

5.2

Routing step in the mean field version

Each sub-population c on day t is characterized by state vector xc (t), given by concatenation of
vectors xcE , xcP , xcI1 , xcA , xcI2 , xcH . As before this is a vector of size 5h + 1, h being the maximal
number of days each phase lasts.
To specify the transition between day t and day t + 1 we consider the following two-stage
mechanism: a first stage consists in an operation similar to the previously considered dynamics,
extended to account for multiple cohorts c, giving vector y(t) as a linear transform of vector x(t).
A second stage representing the routing of individuals between cohorts gives x(t + 1) as a linear
transform of y(t). Specifically we have
X
0
αc0 ,c (t)Mc,c0 xc (t),
(25)
y c (t) = Nc,c (t)xc (t) +
c0

where matrices N = (Nc,c )c,c0 ∈C and M = (Mc,c )c,c0 ∈C are characterized by the equations
c
∀τ ∈ {E, P, I1 , I2 , A} , yτ,d+1
(t) = xcτ,d (t)(1 − rτ (d)),
i
X
Xh 0
0
0
0
c
yE,1
(t) =
αc0 ,c (t)
(xcI1 ,δ + xcI2 ,δ )(t) + (xcA,δ + xcP,δ )(t) ,
c0 ∈C
c
yP,1
(t)

=

X

δ>0

xcE,δ (t)rE (δ),

δ>0

yIc1 ,1 (t)

= pi

X

xcP,δ (t)rP (δ),

δ>0
c
yA,1
(t)

= (1 − pi )

X

xcP,δ (t)rP (δ),

δ>0

yIc2 ,1 (t)

= (1 − ph )

X

xcI1 ,δ (t)rI1 (δ),

δ>0
c
yH
(t)

= ph

X

xcI1 ,δ (t)rI1 (δ).

δ>0

19

The routing stage is then provided by:
 c
 c
yE
xE
 yPc 
 xc 
X
P
 c 
 c 

x  (t + 1) =
Rc0 ,c (t) 
yIc1  (t).
 Ic1 

 xA 
0
yA 
c
c
yIc2
x I2

5.3

Estimation of routing fractions and numbers of contacts

Observation/estimation of routing fractions An ideal scenario is when routing fractions Rc,c0 (t)
are directly available. However, this is typically not the case. We therefore describe a more plausible situation, for which we also propose a potential approach for estimating these fractions.
Assume that c = (r, r0 , a), r representing the usual address of individuals and r0 the place
where they spent the previous night. Assume that we observe the quantities Nc (t), as well as, for
all pair of regions (r1 , r2 ), the quantities:
X
N(r,r1 ,a) (t)R(r,r1 ,a),(r0 ,r2 ,a) (t),
(26)
∆r1 ,r2 ,a (t) :=
r,r 0

that is the flow of people of age range a who slept on night before t in r1 and slept on the following
night in r2 . The usual address of these individuals is however assumed unknown.
In such a situation, we propose the following approach, popular in the literature on traffic matrices for management of communication networks. Estimate the unobserved quantities Rc,c0 (t)
bc,c0 (t) of
as the solution R


X
1
max
Rc,c0 ln
(27a)
Rc,c0 ≥0
Rc,c0
c,c0
X
subject to
∀c0 ,
Rc0 ,c ≤ 1
(27b)
c

∀(r1 , r2 ),

X

Nr,r1 ,a (t)R(r,r1 ,a),(r0 ,r2 ,a) = ∆r1 ,r2 ,a (t).

(27c)

r,r 0

This is a maximum entropy criterion. As a concave maximization program, it can be solved with
efficient numerical methods.
Estimation of mean numbers of contacts nc,c0 (t) Contacts counted in the contact intensity factor
nc,c0 (t) may occur in many circumstances. Among these we distinguish contacts at home, at work,
at school, in transit (public transportation) as parameters on which preventive measures can be
brought to bear. We may split such contacts accordingly, writing
W
S
T
nc,c0 (t) = nH
c,c0 (t) + nc,c0 (t) + nc,c0 (t) + nc,c0 (t).

(28)

Let us consider estimation of nTc,c0 (t). Assume we have access to additional observations about
the mobility of individuals of all sub-populations. For instance, we may have statistics showing
that on day t, approximately nc,z (t) individuals of population c have visited a location z. We may
represent by z a time-space location, e.g. being in site s during a given hour h of the day.
Remark 5.1. The variables nc,z (t) could be unprocessed counts observed on day t. It may however
be more appropriate to apply preliminary filtering on such unprocessed counts (e.g. applying
a weighted averaging of raw counts over a past time window) to improve estimation quality of
contact rates.

20

We may then let
Nc (t)nTc,c0 (t) =

X

βz nc,z (t)nc0 ,z (t),

(29)

z

where the parameters βz are to be inferred, and capture the density of contacts to be expected
in (time-space) location z. In this formulation, the parameters to be inferred are: parameters βz ,
and infection probabilities qc,c0 . This model is over-parameterized, since multiplying the βz by η
and dividing the qc,c0 by η leaves the model unchanged for all η 6= 0. This can be easily solved,
forcing for instance the parameters βz to have mean 1. While this over-parameterization is easily
circumvented, it remains a challenge to effectively fit all the free parameters of the above model, as
well as to define the proper spatio-temporal granularity associated with the time-space locations
z.

Conclusion
In this study we laid the foundations of a general model of COVID-19 epidemics which captures
user mobility and contact tracing. We described it as a multi-type branching process, proposed inference methods to perform short-term prediction, that we illustrated on the Paris hospitalization
data. We also introduced extensions to capture contract tracing and case isolation, and finally
proposed extensions to capture user mobility, distinguishing between commuting and routing
mobility.
Future work will further exploit this model together with hospital incidence and mobility data
to forecast epidemic progress and assess impact of mobility on infectious contacts.
Acknowledgements: The authors are grateful to SFR for making available to them time series
of human mobility across departments in France. This data, partially illustrated by Figure 5, has
inspired the design of the models described in the last two sections.

21

References
[1] Andrew W. Byrne, David McEvoy, Aine Collins, Kevin Hunt, Miriam Casey, Ann Barber,
Francis Butler, John Griffin, Elizabeth Lane, Conor McAloon, Kirsty O’Brien, Patrick Wall,
Kieran Walsh, and Simon More. Inferred duration of infectious period of sars-cov-2: rapid
scoping review and analysis of available evidence for asymptomatic and symptomatic covid19 cases. medRxiv, 2020.
[2] Yi-Cheng Chen, Ping-En Lu, Cheng-Shang Chang, and Tzu-Hsuan Liu.
A timedependent sir model for covid-19 with undetectable infected persons.
2020.
http://gibbs1.ee.nthu.edu.tw/A_TIME_DEPENDENT_SIR_MODEL_FOR_COVID_19.PDF.
[3] L. Di Domenico, G. Pullano, C. Sabbatini, P.-Y. Boëlle, and V. Colizza.
Expected impact of lockdown in Île-de-france and possible exit strategies.
https://www.medrxiv.org/content/10.1101/2020.04.13.20063933v1, 2020.
[4] Moez Draief, Ayalvadi Ganesh, and Laurent Massoulié. Thresholds for virus spread on networks. Ann. Appl. Probab., 18(2):359–378, 04 2008.
[5] Stéphane Gaubert, Marianne Akian, Xavier Allamigeon, Marin BOYET, Baptiste Colin, Théotime Grohens, Laurent Massoulié, David P. Parsons, Frederic Adnet, Érick Chanzy, Laurent
Goix, Frédéric Lapostolle, Éric Lecarpentier, Christophe Leroy, Thomas Loeb, Jean-Sébastien
Marx, Caroline Télion, Laurent Treluyer, and Pierre Carli. Understanding and monitoring
the evolution of the Covid-19 epidemic from medical emergency calls: the example of the
Paris area. arXiv:2005.14186, June 2020.
[6] Mohinder Grewal and Angus Andrews. Kalman filtering: theory and practice using matlab.
New York: John Wiley and Sons, 14, 01 2001.
[7] H. Kesten and B. P. Stigum. A limit theorem for multidimensional Galton-Watson processes.
Ann. Math. Statist., 37:1211–1223, 1966.
[8] Amaury Lambert. A mathematical assessment of the efficiency of quarantining and contact
tracing in curbing the COVID-19 epidemic. medRxiv, 2020.
[9] Stephen A. Lauer, Kyra H. Grantz, Qifang Bi, Forrest K. Jones, Qulu Zheng, Hannah R.
Meredith, Andrew S. Azman, Nicholas G. Reich, and Justin Lessler. The incubation period
of coronavirus disease 2019 (covid-19) from publicly reported confirmed cases: Estimation
and application. Annals of Internal Medicine, 172(9):577–582, 2020. PMID: 32150748.
[10] Marc Lavielle. Modelling some covid-19 data. http://webpopix.org/covidix19.html.
[11] Ruiyun Li, Sen Pei, Bin Chen, Yimeng Song, Tao Zhang, Wan Yang, and Jeffrey Shaman.
Substantial undocumented infection facilitates the rapid dissemination of novel coronavirus
(sars-cov2). Science, 2020.
[12] Conor G McAloon, Aine Collins, Kevin Hunt, Ann Barber, Andrew Byrne, Francis Butler,
Miriam Casey, John M Griffin, Elizabeth Lane, David McEvoy, Patrick Wall, Martin J Green,
Luke O’Grady, and Simon J More. The incubation period of covid-19: A rapid systematic
review and meta-analysis of observational research. medRxiv, 2020.
[13] Jonathan Roux, Clément Massonnaud, and Pascal Crépey. Covid-19: One-month impact of
the french lockdown on the epidemic burden. medRxiv, 2020.
[14] Rajesh Singh and R. Adhikari. Age-structured impact of social distancing on the covid-19
epidemic in india. https://arxiv.org/pdf/2003.12055.pdf, 2020.

22

[15] Mircea T. Sofonea, Bastien Reyné, Baptiste Elie, Ramsès Djidjou-Demasse, Christian Selinger,
Yannis Michalakis, and Samuel Alizon. Epidemiological monitoring and control perspectives: application of a parsimonious modelling framework to the covid-19 dynamics in
france. medRxiv, 2020.
[16] Robert Verity, Lucy C Okell, Ilaria Dorigatti, Peter Winskill, Charles Whittaker, Natsuko Imai,
Gina Cuomo-Dannenburg, Hayley Thompson, Patrick Walker, Han Fu, Amy Dighe, Jamie
Griffin, Anne Cori, Marc Baguelin, Sangeeta Bhatia, Adhiratha Boonyasiri, Zulma M Cucunuba, Rich Fitzjohn, Katy A M Gaythorpe, Will Green, Arran Hamlet, Wes Hinsley, Daniel
Laydon, Gemma Nedjati-Gilani, Steven Riley, Sabine van Elsand, Erik Volz, Haowei Wang,
Yuanrong Wang, Xiayoue Xi, Christl Donnelly, Azra Ghani, and Neil Ferguson. Estimates of
the severity of covid-19 disease. medRxiv, 2020.

23

