Noname manuscript No.
(will be inserted by the editor)

Group Testing Enables Asymptomatic Screening for
COVID-19 Mitigation
Feasibility and Optimal Pool Size Selection with Dilution Effects

arXiv:2008.06642v2 [q-bio.PE] 16 Nov 2020

Yifan Lin · Yuxuan Ren · Jingyuan Wan · Massey Cashore · Jiayue
Wan · Yujia Zhang · Peter Frazier · Enlu Zhou

the date of receipt and acceptance should be inserted later

Abstract Repeated asymptomatic screening for SARSCoV-2 promises to control spread of the virus but would
require too many resources to implement at scale. Group
testing is promising for screening more people with fewer
test resources: multiple samples tested together in one
pool can be excluded with one negative test result. Existing approaches to group testing design for SARS-CoV-2
asymptomatic screening, however, do not consider dilution effects: that false negatives become more common
with larger pools. As a consequence, they may recommend pool sizes that are too large or misestimate the
benefits of screening. Modeling dilution effects, we derive closed-form expressions for the expected number of
tests and false negative/positives per person screened
under two popular group testing methods: the linear and
square array methods. We find that test error correlation
induced by a common viral load across an individual’s
Yifan Lin
Georgia Institute of Technology, Atlanta, GA 30332, USA
Yuxuan Ren
Georgia Institute of Technology, Atlanta, GA 30332, USA
Jingyuan Wan
Georgia Institute of Technology, Atlanta, GA 30332, USA
Massey Cashore
Cornell University, Ithaca, NY 14853, USA
Jiayue Wan
Cornell University, Ithaca, NY 14853, USA
Yujia Zhang
Cornell University, Ithaca, NY 14853, USA
Peter Frazier
Cornell University, Ithaca, NY 14853, USA
E-mail: pf98@cornell.edu
Enlu Zhou
Georgia Institute of Technology, Atlanta, GA 30332, USA
E-mail: enlu.zhou@isye.gatech.edu

samples results in many fewer false negatives than would
be expected from less realistic but more widely assumed
independent errors. This insight also suggests that false
positives can be controlled through repeated tests without significantly increasing false negatives. Using these
closed-form expressions to trace a Pareto frontier over
error rates and tests, we design testing protocols for
repeated asymptomatic screening of a large population.
We minimize disease prevalence by optimizing a timevarying pool sizes and screening frequency constrained
by daily test capacity and a false positive limit. This
provides a testing protocol practitioners can use for mitigating COVID-19. In a case study, we demonstrate the
effectiveness of this methodology in controlling spread.
Keywords COVID-19 · Group testing · Dilution
effect · Asymptomatic screening · Prevalence control

Highlights
• We demonstrate the feasibility of group testing for
enabling population-level asymptomatic screening
for SARS-CoV-2, including practically significant
dilution effects in our analysis.
• In a case study with a nominal set of parameters,
we demonstrate that screening a population of 100K
people twice per week with square array group testing and a pool size near 25 can keep prevalence from
growing with approximately 20K tests / week. At
the same time, not screening allows prevalence to
double every 4 days.
• Our analysis shows that, compared to the linear array
method, the square array method is more feasible
when the testing capacity is limited, and generally
has slightly higher (but comparable) false negative
rates and much lower false positive rates. Therefore,

2

Yifan Lin et al.

we recommend using the square array group testing
method.
• We provide practitioners with an implementable protocol, including how to determine the optimal cycle
length in repeated asymptotic screening and the optimal pool size within each testing cycle, and the
procedure of group testing.
• A common concern with group testing is that multiple tests with independent errors prevent achieving
the high sensitivity. We show that false negatives
driven by low viral load are positively correlated
across pools resulting in much higher sensitivity than
obtained from a naive analysis. At the same time,
false positive pools driven independently by lab contamination result in a low overall false positive rate
(high specificity).

1 Introduction
Repeated asymptomatic screening of an entire population promises to effectively combat COVID-19 [22,
40, 12, 13, 11]. Asymptomatic screening identifies infectious but asymptomatic individuals who can then be
isolated. These individuals can also initiate contact tracing to isolate more infectious individuals. Asymptomatic
screening is particularly attractive as an intervention for
COVID-19 because so transmission by asymptomatic
and presymptomatic individuals plays such a large role
in its spread. Screening repeatedly allows false negatives missed in one round of screening to be identified
in a subsequent round. It also protects against new infections imported to a population through travel. By
screening more frequently, we can reduce the time period over which an infectious individual can transmit
virus. If done often enough to a large-enough fraction
of a self-contained population, then both mathematical
modeling [22, 40, 12, 13, 11] and real-world experience
[16] suggest that repeated asymptomatic screening and
taking appropriate measures (such as quarantine) can
drive the prevalence of COVID-19 to almost 0, even if
the level of social distancing and mask-wearing are not
enough to prevent spread by themselves.
For example, [40] found that frequent asymptomatic
screening along with behavioral interventions can keep
infections on a college campus under control and permit safe reopening; [12] used a similar approach as [40]
to evaluate different screening frequencies, while accounting for temporal variations in infectivity and test
detectability of positive cases; [13] used an SIR model
subject to testing capacity constraints to evaluate the
effect of testing capacity and mitigation policies on curbing the spread of the epidemic in a general population;

[16] reports on the success of a repeated asymptomatic
screening program at Cornell University.
However, the resources necessary to screen a large
population as frequently as twice per week would seem
to be prohibitive. Group testing [18] is a promising
approach for overcoming this challenge. In the simplest
version of this approach as it is applied to SARS-CoV2, Dorfman’s procedure or the so-called linear array
method, samples are first collected from all individuals
we wish to screen. Then, a portion from each of multiple
individuals’ samples are taken, combined together in a
single "pool", and the pool is tested in a single chemical
reaction (typically PCR, or polymerase chain reaction)
for the presence of the virus. If the pool tests negative,
then (in the absence of errors) all of the individuals
participating in the pool can be determined to be virusfree. If the pool tests positive, then additional tests are
performed on each individual sample to determine which
ones contain virus. In low-prevalence populations, this
approach can significantly reduce the number of PCR
reactions that need to be done, saving chemical reagents,
machine time, and the time of the trained laboratory
personnel needed to supervise these reactions. (Notably,
group testing does not save on the effort and resources
required to collect the samples themselves.)
Building on earlier success in using group testing
to conserve resources when screening for malaria, HIV,
and H1N1 [25, 42, 29, 50, 48], and demonstrations that
it could provide similar resource savings when testing
for SARS-CoV-2 [35, 9, 2, 32, 38, 19, 6], there has been
substantial interest in the use of group testing with
population-level asymptomatic screening to control the
spread of the virus.
Indeed, several recent mathematical analyses have
advocated for this. For example, [22] found the optimal
pool size that released as many individuals to the workforce as possible without considering error in group testing. The expanded test capacity further enables frequent
asymptomatic screening for a large community within
a short period of time. [11] simulated using group testing to monitor and control the prevalence on Cornell’s
campus, and [36] devised a hypercube-array pooling
algorithm that enabled resource-efficient screening in
Rwanda.
All of the aforementioned literature studying group
testing and asymptomatic screening for control of COVID19 assumes either that testing is error-free, or the false
negative rate is a fixed constant, regardless of pool size.
In reality, the viral load in virus-containing samples
(referred to as positive samples in the rest of this paper)
is diluted when lower volume is used in the reaction to
support pooling with negative samples. This lowers their
probability of being detected and is called the dilution

Group Testing Enables Asymptomatic Screening for COVID-19 Mitigation

effect. As a consequence of not modeling errors or modeling them as a small constant appropriate for small pool
sizes, the previous literature risks overstating the benefits of group testing and risks recommending protocols
with unrealistically large pool sizes. At the same time,
if one uses a constant error probability appropriate for
a large pool size, one can underestimate the benefits
and fail to take advantage of the ability to reduce errors
by using smaller pools. Indeed, this inattention to the
dilution effect is reflective of the larger group testing literature, in which only a handful of papers [49, 53, 43, 15]
consider this effect in any group testing design context
and none that we are aware of in the context of designing group testing protocols for prevalence control with
repeated asymptomatic screening. ([43] designs test protocols to maximally expand the screening capacity under
different prevalence levels at some sacrifice of sensitivity,
and the concurrent-to-our work [15] designs group testing protocols to maximize the number of true positives
found, both without quantitatively studying its ability
to control prevalence through repeated application.)
In this paper, we consider dilution effects and the
choice of pool sizes in group testing protocols for specific use in asymptomatic screening for controlling the
prevalence of COVID-19. We first quantify the trade-off
between the number of pooled tests performed, the number of false negatives and the number of false positives.
In particular, under dilution effects we derive closedform expressions of these quantities as a function of
pool size in the context of two established and practical
group testing protocols, Dorfman’s linear array and the
square array method.
A notable outcome of our model of dilution effects
is that false positives can be kept small while false negatives can be prevented from becoming too large. A naive
analysis of group testing with either the linear or square
array method is that false negatives and false positives
in pooled tests occur independently across tests. While
one might wish to reduce false positives (which is very
important in asymptomatic screening) by testing a sample one additional time, a belief in independence of false
negatives would suggest that this would also increase the
false negative rate. This could be a significant enough
issue to make group-testing-based asymptomatic screening infeasible. We argue, however, that correlation in
false negatives induced by similar viral loads in portions
of the same sample used in multiple pooled tests allows the use of repeated tests to control false positives
without significantly increasing the false negative rate.
Using our model of dilution effects, we then compute
the optimal pool size that minimizes the expected number of false negatives per person while constraining test
capacity and false positives per person.

3

This formulation is particularly appropriate for asymptomatic screening when the number of pooled tests that
can be performed in a day is a key limiting factor. This is
imposed when the number of machines that can perform
these tests is limited or when the number of trained personnel available to operate them is limited. The limit on
false positives per person tested is additionally imposed
by a need to avoid quarantining uninfected people and
the fact that frequent asymptomatic screening would
test large numbers of people every day. By varying these
constraints one can trace out a Pareto frontier between
expected pooled tests, false negatives, and false positives
per person screened.
Using this more realistic model with dilution effects
and the results of our optimization approach, we further
consider repeated asymptomatic screening for a large
population to control the prevalence of COVID-19 with
constraints on pooled test capacity and false positives.
To model the dynamics of virus spread, we propose a
testing-quarantine-infection model that builds on SIR
models from the epidemiology literature, divides the
population into a chosen number of subsets (according
to the cycle length) and then tests one subset on each
day, testing that subset again in the next testing cycle.
We fix the pool size for practicality during each cycle,
but allow it to change as each cycle passes because
prevalence may change significantly.
Assuming that the false positive rate is already constrained to be small enough to be negligible (enabled
by our insight that it can be driven to 0 through an
additional test on those that would otherwise be positive), an asymptomatic screening policy should use a
group testing policy that operates on the Pareto frontier
between false negatives and tests per person screened:
achieving a lower false negative rate results in fewer
infections; using a lower number of tests per person
screened allows screening more people per day which
allows more frequent screening which results in fewer
infections.
Leveraging the ability to constrain our search over
pool sizes using the Pareto frontier significantly improves performance. We compute by optimization via
simulation the optimal testing cycle length that yields
the minimal final prevalence rate after a given period
of time subject to constraints on test capacity and false
positives per person tested. Our framework can also be
extended to incorporate constraints on the total number
of people tested, as would arise from limited sampling
supplies such as swabs, tubes, viral transport media, or
personnel needed to collect samples.
Leveraging this methodology, we study the feasibility
of group testing for enabling population-level asymptomatic screening that prevents the growth of COVID-19

4

outbreaks. We consider three scenarios varying initial
population prevalence, transmission rates, and other parameters seeking to control prevalence in a population
of 100K people using 40K pooled tests in total over 2
weeks. In a pessimistic scenario we find, unfortunately,
that the rate of transmission is too high to be contained
with this many tests. In nominal and optimistic scenarios, however, we find that asymptomatic screening
enabled by group testing is able to control and even reduce prevalence effectively in spite of the dilution effect.
Our approach is able to respond to the dilution effect
to recommend smaller pool sizes than those often be
recommended by models that do not consider it [11]:
optimal pool sizes chosen range from 10 to 35.
In contrast with other work on asymptomatic screening with group testing that does not consider sampling
errors, such as [22], the inclusion of sampling errors
necessitates a different optimization framework. While
[22] minimizes the expected number of pooled tests performed, the inclusion of errors necessitates simultaneous
consideration of the trade-off between pooled tests performed, false negatives and false positives.
Our study of dilution effects is most closely related
to [49], which considered dilution effects in group testing for HIV screening (using an ELISA assay rather
our focus on PCR) and derived pool sizes and protocols
that minimize a linear combination of the number of
pooled tests, false negatives, and false positives. We differ, however, in several important ways. First, we differ
in our focus on a PCR assay for COVID-19. Second,
we differ in our focus on simpler and more easily implemented linear and square array group testing protocols,
rather than more complex multi-stage adaptive designs.
This derives in part from the need in asymptomatic
screening for COVID-19 to report results quickly so
that infectious individuals can be identified before they
spread virus to more people. In contrast, multi-stage
adaptive group testing, in which the next pool to test
depends on the result of previous one, incurs delays
with each additional stage. The non-adaptive group
testing methods we use are comparable in performance
to adaptive methods such as generalized binary search
(GBS) (e.g. [47]. Third and finally, we differ in the fact
that we focus on the use of group testing specifically
within asymptomatic screening for outbreak prevention.
This necessitates differences such as the difference in
the optimization problem formulation. Rather than optimizing a linear combination of metrics we optimize
false negatives subject to constraints on pooled tests
and false positives. This enables tracing a full Pareto
frontier rather than just the convex envelope that could
be traced by varying weights of a linear objective.
In summary, our contributions are three-fold:

Yifan Lin et al.

1. We develop models at the molecular level, testing
level, and population level. The molecular-level model
considers the viral load and false negative rate in
pooled samples. The testing-level model details the
linear array and square array group testing methods.
The population-level model captures the epidemic
dynamics of testing, quarantine, and infection over
time.
2. We derive closed-form expressions for the expected
number of tests, the expected number of false negatives and the expected number of false positives for
the two group testing methods. We compute the optimal pool size that minimizes the expected number of
false negatives under test capacity and false positive
constraints in a stochastic optimization formulation.
3. We design a testing protocol to test the whole population in a testing cycle under a limited daily testing
capacity. We further conduct a case study to demonstrate the testing protocol in different scenarios.
While we view our analysis as significantly expanding
our understanding of whether group testing can reduce
resource requirements significantly enough to enable
repeated asymptomatic screening at scale for control of
COVID-19, our work has several limitations. First, our
model of disease progression in the general population
uses simple stylized dynamics that do not include social
network structure, dispersion in transmission, or timevarying infectivity that may significantly impact virus
spread. Second, while our model of test error includes
viral load and its variability across individuals, it does
not model how viral load varies systematically over
the course of a person’s infection as in [43] and how
this variation could interact with screening. Temporal
variation in the ability to detect infections has been
shown to impact screening’s ability to control prevalence
in [12]. Third and finally, it does not model uncertainty
about prevalence and transmission and how this may
impact the choice of group size (as in [43]) and screening
frequency (as in [11]). These limitations should be kept
in mind when interpreting our results.
The remainder of the paper is organized as follows.
Section 2 reviews the literature on group testing. Section
3 describes our molecular-level model of the dilution
effect, consisting of viral load in positive samples, the
mechanism of a RT-qPCR test, and false negatives in
pooled samples. Section 4 details the linear array and
square array methods, derives their expected number of
tests and expected number of false negatives/positives
per person, explains why correlation from viral load
controls error rates, and computes the optimal pool size.
Section 5 considers prevalence control at the population level, proposes a testing-quarantine-infection model,
finds the optimal testing cycle length and the optimal

Group Testing Enables Asymptomatic Screening for COVID-19 Mitigation

pool size within each cycle. We end with a case study
of monitoring and controlling the prevalence in a large
population under different scenarios in Section 6.
An early version of this paper circulated as a working
paper [21]. The current version is refined and expanded.

2 Literature Review
This section reviews the literature on group testing,
screening for disease control, false negatives in group
testing and in particular, errors from dilution effects.

2.1 Group Testing: Methods and Applications
Group testing refers to the idea of pooling multiple
samples together for testing to identify positives more
efficiently. It was first studied by Dorfman in 1943 in the
context of screening soldiers for syphilis during WWII
[18]. Building on Dorfman’s procedure, [41] proposed the
square array method in 1994, which was closely analyzed
later in [50] in 2008. Under this approach, samples are
placed onto a square array where each row and column
forms a pool. Samples whose row and column pools
both test positive are either deemed positive or tested
in follow-up individual tests. [46] further generalized
[18] to allow choosing pool sizes adaptively based on
information from previous test results. These protocols
have been generalized and analyzed using connections to
active learning, coding theory and compressed sensing
[35, 3, 33, 27, 34, 1].
The need for detecting infectious diseases such as
HIV, H1N1, and malaria has motivated the development
of practically feasible group testing methods. [42] devised a multistage pooling method for the detection of
HIV. Samples are put into intermediate pools of size
ten which themselves form master pools. An individual
sample is retested only if their parent-level pool tests
positive. [29] studied the efficiency and error rates of
square-array method for detecting HIV infections and
[50] extended this analysis to multi-stage linear arrays.
The feasibility of group testing has also been confirmed
by experimental studies. [25] examined the hierarchical
linear array pooling method for the detection of malaria
subject to experiment-level constraints. [48] studied the
practicality of pooling throat swab specimens for detecting H1N1, discovering that forming pools of size
ten does not reduce sensitivity. The general conclusion
we can draw from the literature is that, compared to
individual testing, group testing can reduce the overall
number of tests needed and increase testing throughput.

5

2.2 Asymptomatic Screening Using Group
Testing
In combating infectious diseases, group testing is particularly useful since it alleviates the resource challenges
on conducting large-scale asymptomatic screening of the
population. For many past infectious diseases, screening
has been shown to be crucial for identifying infected
individuals and preventing further spread [17, 31, 10].
Large-scale screening is especially useful when carriers
are often asymptomatic, as with COVID-19 [4]. Modeling studies have indicated the efficacy of screening for
controlling COVID-19. Both [40] and [12] found that
frequent asymptomatic screening is essential for keeping
infections on a college campus under control; [13] found
that expanding testing capacity for large-scale screening,
along with other mitigation policies, can effectively help
curb the spread in a general population.
The possibility of using group testing to conduct
screening for COVID-19 has been studied both methodologically and empirically. Methodology-wise, [35] proposed both non-adaptive and adaptive group testing
strategies based on generalized binary splitting. [9] proposed a double pooling strategy and derived the optimal
group size that minimizes the expected number of tests
per person. [2], [38], and [19] examined mathematical
properties of multi-stage pooling methods that generalize Dorfman’s procedure. Empirically, [45] designed a
combinatorial pooling strategy based on Reed-Solomon
error correcting codes improving test efficiency by a factor of 8 in a screening pilot. [7] implemented Dorfman’s
procedure for screening more than 26,000 individuals
and achieved a 7.3-fold increase in throughput. Our
work builds on this promise but goes beyond past work:
except for a few examples discussed in detail below, existing work in group testing for asymptomatic screening
either ignores important real-world aspects of test errors
or does not fully model the interaction of group testing
properties with the needs and dynamics of repeated
asymptomatic screening for prevalence control.
2.3 False Negatives and Dilution in Group
Testing
While expanding the test capacity makes large-scale
screening possible, ensuring test accuracy is also crucial
for correctly identifying the positive cases and containing
the spread. Accounting for the false negatives that arise
in group testing is thus an essential part of the modeling.
Group testing where the false negative rate is assumed to be a fixed constant has been studied theoretically. [23] and [24] extended Dorfman’s procedure [18]
and Sobel and Groll’s procedure [46] to the case where

6

test error is present. [30] provided a unified framework
that accounts for errors due to variable detectability
of the samples, pooling errors, and screening errors,
and showed how these factors affect the design of nonadaptive group testing protocols. In the associated area
of error-correcting codes, samples are assigned to multiple pools combinatorially such that results can be
robustly decoded under fixed false negative and false
positive rates. [14] discussed two decoding procedures
for controlling the number of pooled tests used to detect
all infected individuals under false positive probability.
[5] also focused on the decoding procedure and developed connections between group testing schemes and
several error-correcting codes, such as Reed-Solomon
code and algebraic-geometric code.
In practice, the false negative rate is not constant.
Rather, it depends on the pool size due to the dilution
effect, i.e., when multiple samples are pooled into one
sample, a virus-containing sample is effectively diluted
among other negative samples, leading to false negatives
if the combined viral load in the pooled sample is too
low [49, 50]. [26] first proposed a conceptual model for
dilution effects in pooled tests. [51] proposed a probit
model for the sensitivity of pooled test for HIV assuming
that the pool contains no more than one positive sample.
[39] expanded this probit model to account for temporal
variation in test detectability of positive samples and
allowed multiple positive samples in a pool. [37] used a
probabilistic model to evaluate the dilution effect in the
detection of bovine viral diarrhea virus. With regard to
the recent COVID-19 pandemic, [15] used simulations
to study the dilution effect in pooled tests while considering heterogeneity in viral progression across a large
population. [43] developed a similar temporal viral progression model and evaluated different pooling strategies
(2-stage and 3-stage linear arrays) under different prevalence levels with dilution effect directly proportional
to pool size. [47] applied the model developed by [39]
to COVID group testing. Based on the mechanism of
RT-qPCR tests and the clinical data for SARS-CoV-2,
[8] proposed a statistical model for determining the false
negative rate induced by pooling. Recently, experimental studies on pooled SARS-CoV-2 tests have shown
that pooling up to 30 samples is feasible with reasonable
detection accuracy [32] and [52].
Among the aforementioned literature, [8] is the closest to our molecular-level model of false negatives in
PCR tests. However, we capture the physical properties
of PCR tests in a more realistic way by modeling the
probability of a positive test result as varying smoothly
in the viral load and vanishing in the limit as the viral
load goes to 0.

Yifan Lin et al.

3 Modeling Dilution Effects in Group Testing
In this section, we present a molecular-level model of the
false negative rate for a single pooled test as a function
of sample viral load. This molecular-level model takes
into account the dilution effect in the pooled test.

3.1 PCR Preliminaries
Real-time reverse transcription polymerase chain reaction (RT-qPCR) testing is the standard technique used
to measure the amount of a specific RNA sequence in
a sample. RNA copies in the sample are first reverse
transcribed into complementary DNA sequences (cDNAs), which then get amplified through a polymerase
chain reaction (PCR) in a PCR machine. In each cycle,
the number of cDNA copies is approximately doubled.
At the end of the test, the cycle threshold value (Ct ) is
returned, which indicates the number of cycles required
for the cDNA concentration in the sample to reach a
fluorescence-detectable threshold. Hence, the Ct value
is approximately equal to − log2 V up to an additive
constant, where V is the viral RNA concentration (i.e.
viral load) in the sample. The limit of detection (LoD)
of the PCR test is the lowest viral load in the sample
that can be detected in a PCR test with a specified
probability (typically 95%).
Possible sources of false negatives in individual RNAbased tests include the following:
• Sample collection. Samples collected from infected
individuals using swab (nasopharyngeal or oropharyngeal) or saliva may fail to contain enough amount
of viral material due to improper sample collection
and handling.
• Low viral load. The viral load in the individual body
may be low, hence the viral load in the collected
sample may be below the LoD of the PCR test.
In pooled RNA-based tests, the dilution effect is a
major source of error. The dilution effect can be intuitively understood as dilution of viral load in the pooled
sample that reduces test sensitivity. Modeling the dilution effect accurately relies on sampling from a realistic
distribution of individual viral loads, which we discuss
below in Section 3.2.

3.2 Viral Load Distribution Among Infected
Individuals
Based on data on 3,303 positive cases from large-scale
screening in Germany [28], [8] established a Gaussian

Group Testing Enables Asymptomatic Screening for COVID-19 Mitigation

mixture model for the distribution of Ct value of a single
positive sample collected from an infected individual:
f (c) =

3
X

πk N (c; µk , σk ),

(1)

k=1

7

Given that we have two parameters to fit in the
logistic curve, all three conditions cannot be satisfied
at the same time. We use conditions (i) and (ii) to fit
the curve and obtain k̂ = 12.5, ĉ0 = 35.8 in equation (2).
The fitted curve is shown in Figure 1.

where the parameters are estimated to be:
π = [0.32, 0.54, 0.14], µ = [20.14, 29.35, 34.78], σ = [3.60, 2.96, 1.32].

Note that this effectively fits a log Gaussian mixture
model on the viral load among infected individuals.
3.3 Fitting the False Negative Rate Model
[8] estimated the Ct value corresponding to the LoD of
the RT-qPCR test used in their data to be dcens = 35.6.
They suppose that a test returning a Ct value less than
dcens will deem the sample to be positive; otherwise,
they suppose that the sample is deemed positive with
probability β = 0.2.
This model is simple, yet it fails to capture an essential feature of PCR tests. In fact, the false negative rate
is expected to strictly decrease with the sample viral
load. Once the viral load falls below a certain threshold,
the false negative rate is expected to quickly approach
zero. This pattern can be well represented by a logistic
function (e.g. [20]). In light of this, we fit a logistic curve
to the relationship between the Ct value (i.e., negative
log viral load) and the false negative rate (FNR)
F N R(c) =

1
1 + e−k(c−c0 )

,

(2)

so that it is roughly consistent with the model proposed
in [8]. Ideally, we would pick parameters k and c0 such
that the curve F N R(c) satisfies the following three
conditions:
(i) It finds that dcens is the LoD. Since the LoD is
conventionally defined as the lowest viral load that
can be detected in a PCR test 95% of the time, we
would like
F N R(dcens ) = 0.05.
(ii) The expected false negative rate for samples beyond
the LoD would match that of the model proposed
in [8]. Mathematically, we would like
R +∞
F N R(c)f (c)dc
E[F N R(c) | c > dcens ] = dcensR +∞
f (c)dc
dcens
= 1 − β.
(iii) The expected overall FNR in the two error models
match. Mathematically, we would like
Z +∞
Z +∞
F N R(c)f (c)dc =
(1 − β)f (c)dc.
(3)
−∞

dcens

Fig. 1: Fitted logistic curve for modeling the false negative rate as a function of the Ct value.
Plugging the fitted values of k and x0 into condition
(iii), we find that the absolute difference between the
LHS and RHS of equation (3) is only 4.6 × 10−4 . Hence,
we consider condition (iii) to be approximately satisfied.

3.4 False Negative Rate of Pooled Samples
In Section 3.3, we discussed the FNR model of a single
positive sample. When group testing is implemented,
however, in general we might expect a pooled sample to
contain n sub-samples collected from distinct individuals,
with d (d ≤ n) positive samples among them. Let γ(n, d)
denote the expected false negative rate of a pooled
sample of size n that contains d ≥ 1 positive sub-samples,
where the expectation is taken over the randomness in
individual viral loads. Let Vi , i = 1, 2, · · · , d be the viral
load in the d positive sub-samples. Assuming we take
an equal portion of each sub-sample,
Pd the average viral
load in the pooled sample is n1 i=1 Vi , which results
in a Ct value of the pooled sample of
!
!
d
d
1X i
1 X −Ct,i
Ct = − log2
V
= − log2
2
, (4)
n i=1
n i=1
where Ct,i is the Ct value of the ith sub-sample if it
were tested in an individual (i.e., non-diluted) PCR test.
We estimate γ(n, d) using Monte Carlo simulation. In
each replication, we
• generate d i.i.d random variables Ct,i , i = 1, 2, · · · , d
from the distribution specified in (1);

8

Yifan Lin et al.

• compute the Ct value of the pooled sample using
equation (4);
• compute the false negative rate of the pooled sample
using equation (2).
The resulting simulated false negative rate is shown in
Figure 2.

of individuals that cannot fit into a linear/square array
in the population approaches is negligible compared to
N.
In the linear array testing, we form N
n linear array
groups and perform pooled testing on each group. Figure
3 shows a linear array of size n = 5. If a pool tests
positive, we will test each person in the pool individually
to identify the positive sample(s) within the group. Note
that in the linear array testing, we split one sample into
two subsamples, of which one is used for pooled testing
and the other for possible follow-up individual test.

Fig. 2: Simulated expected false negative rate γ(n, d) vs.
pool size n under the presence of different numbers of
positives d in the pool.

4 Feasibility and Optimal Pool Selection for
Linear and Square Array Group Testing
We focus on two group testing protocols: linear array
testing and square array testing. These are non-adaptive
methods with only two stages of testing (including a
follow-up individual test) that are easy to understand
and implement in practice. Because they only have two
stages, the bulk of the testing can proceed in parallel,
reducing the amount of time from sample collection to
test result. This is important when using group testing
for prevalence control, since reducing this delay reduces
the number of people that an infectious person infects.
We first introduce these two methods and then compare their performances. Specifically, we compare the
number of tests needed, the number of false negatives,
and the number of false positives under different parameter regimes of testing capacity and prevalence rate.

4.1 Group Testing Protocols and Notation
Suppose the total number of people to test is N and the
desired pool size is n. The linear array testing method
has group size n, and the square array testing method
has group size n × n. We assume N is a multiple of n2
so that all samples can be arranged into linear/square
arrays with pool size n. This assumption is valid when
we consider a large population size N , since the fraction

Fig. 3: Placement of samples in a linear array of pool
size 5. Samples 1 and 3 are positive, causing pool 1 to
test positive. Follow-up individual tests on samples in
pool 1 can help identify positives 1 and 3. Samples in
pools that test negative, such as those in pool 5, are
deemed negative and not tested individually.

In the square array testing, we form nN2 square array
groups of size n × n. A sample is deemed as suspicious
if both its row and its column pools test positive. See
Figure 4 for a simple illustration. We split one sample
into three subsamples, of which one is used for row
testing, one is used for column testing, and the remaining
one is reserved for possible follow-up individual test if
the sample is deemed as suspicious.
Here we formally define the following notations:
• Population size: N .
• Prevalence rate: p. Each individual is infected independently with probability p.
• Pool size in group testing: n. It is the number of
samples that are pooled together in one PCR test.
• Maximum pool size: n̄. Pooling more than n̄ samples
together is difficult in practice (e.g. [25]). We set
n̄ = 100.
• Testing capacity per person: C. This is the number
of PCR tests available per person.

Group Testing Enables Asymptomatic Screening for COVID-19 Mitigation

Fig. 4: Placement of samples in a 5 × 5 square array.
Samples 1 and 13 are positive. With reasonable test
accuracy, it is likely that the first and the third row
pools and the first and the third column pools will test
positive. With follow-up individual tests on samples at
the intersection of positive pools, we can declare samples
1 and 13 positive and samples 3 and 11 negative.

• Number of infected people in a pool of size n: d.
Note that d follows a binomial distribution with
parameters n and p.
• False positive rate of a PCR test: q. False positives
in a PCR test are generally caused by false liquid
handling and sample contamination. Here we assume
that q is a universal constant regardless of the pool
size of the pooled test.
e The population will not
• False positive tolerance: C.
accept the number of false positive per person higher
than this because quarantine without a good reason
is very hard to bear in reality.
• Square array of pool size n: An×n . Ai,j denotes the
sample/individual that belongs to the ith row pool
and the j th column pool. Ai,: denotes the ith row
pool. A:,j denotes the j th column pool.

4.2 Joint Distribution of Pool Results
The linear and square array methods both involve multiple tests of the same sample: either one or two pooled
tests and then a potential individual followup test.
Randomness in a sample’s viral load and the fact
that a sample participates in multiple tests creates complex correlations across tests. Thus, to calculate the
properties of these group testing protocols, we must understand certain joint distributions over multiple events.

9

We define these quantities here, following a similar procedure used to define γ(n, d) (the probability that a
pooled test of size n with d positives has a negative
result) in Section 3.4.
We define the quantities η(n, d) for linear array tests,
and θ(n, d1 , d2 ) and ψ(n, d1 , d2 ) for square array tests.
Specifically, given that a positive sample belongs to a
pool of size n with d positives we let η(n, d) denote
the probability that it tests positive in the pooled test
but tests negative in the individual test. Given that
a positive sample in a square array belongs to a row
pool of size n with d1 positives and a column pool of
size n with d2 positives, we let θ(n, d1 , d2 ) denote the
probability that it tests positive in both row and column
pooled tests, and ψ(n, d1 , d2 ) the probability that it
tests positive in both row and column pooled tests but
tests negative in the individual test. We assume 1 ≤
d, d1 , d2 ≤ n. These quantities can be estimated using
Monte Carlo simulation analogous to the procedure
described at the end of Section 3.4.
4.3 Implications of Test Correlation
Here we call out an important consequence of our more
realistic model of errors in pooled testing. Recall that
we model a single sample as being obtained from an
individual and being split into multiple subsamples for
pooled and follow-up individual testing. The viral loads
for each of these sub-samples are modeled as having
identical viral loads, and would indeed have extremely
similar viral loads in reality. Moreover, recall that the
probability that a positive sample tests negative in a
pool or in an individual test is affected largely by the
viral load of the (sub-)sample in addition to idiosyncratic
randomness from a given test.
As a result, positive samples with high viral loads
are likely to test positive in all of the pools and individual tests they participate in. Indeed, if there were no
idiosyncratic component to the probability of a pooled
test testing positive and instead the test result were
entirely determined by whether the viral load in the
sample was above a threshold, and then we would see
that a positive sample would either test positive in all
pools or in no pools. (We ignore the possibility that another positive sample participated in one of these pools,
which is unlikely when prevalence is small.) Thus, under
our model, there is significant positive correlation in
test results across pooled tests. Moreover, because the
absence of dilution effect makes individual tests more
sensitive, a positive sample that tests positive in its
pools is quite likely to test positive in its followup test
(when prevalence is low and thus the positive pooled
result is unlikely to be due to another positive sample).

10

Yifan Lin et al.

As a result, the probability that a positive sample
tests in all pools and its individual followup test is not
that much smaller than the probability it tests positive
in a single pooled test. This stands in sharp contrast
to what one would expect from assuming errors are
independent across tests: under this assumption, the
probability that a sample would test positive in all tests
declines exponentially in the number of tests performed.

The expected number of false negatives per person
for linear array testing is

Theorem 1 Consider a model identical to ours but in
which the results from pooled tests and followup individual tests are all conditionally independent given which
samples contain virus. The probability that a true positive tests negative is lower under our model than in this
alternative model, for both linear and square array protocols. The probability that a true negative tests positive
is unchanged.

FeL (n) = q(1 − p)

We show this in detail in Appendix D.
This has important consequences for adding additional tests to reduce false positives in a testing protocol.
False positives are typically due to laboratory contamination from other samples in the lab. Contamination that
occurs after sub-samples are taken is likely to be much
less correlated across multiple pooled tests. As a result,
requiring a sample to test positive in two confirmatory
individual tests rather than one would significantly reduce the false positive rate. Because of the correlation
due to viral load, this can be done without significantly
increasing the false negative rate.
To combat contamination affecting the original sample, one could consider taking two separate samples from
an individual and storing them separately. This may
somewhat reduce the correlation in viral loads across
pools that an individual participates in but is likely to
allow even more robust control of false positives without
a significant degradation in false negatives.
4.4 Expected Number of Tests, False Negatives,
and False Positives
We derive closed-form expressions for the expected number of tests per person, false negatives per person, and
false positives per person for both linear array and
square array methods. The derivations can be found in
Appendices A and B.
With a slight abuse of notation, here we let γ(n, 0)
denote the probability that a pool of size n containing no
positive samples tests negative. By definition, γ(n, 0) =
1 − q. Then, the expected number of tests per person
for linear array testing is

n 

1 X
M L (n) = +
1 − γ(n, d) nd (1 − p)n−d pd . (5)
n
d=0

F L (n) =

n
X

(η(n, d) + γ(n, d))

n−1
d−1



(1 − p)n−d pd . (6)

d=1

The expected number of false positives per person
for linear array testing is
n−1
X

(1 − γ(n, d))

n−1
d



pd (1 − p)n−1−d .

d=0

(7)
The expected number of tests per person for the
square array testing is

M S (n) =

n X
n
X
2
+p
θ(n, d1 , d2 )
n

n−1
d1 −1



n−1
d2 −1



d1 =1 d2 =1

pd1 +d2 −2 (1 − p)2n−d1 −d2 + (1 − p)
n−1
d



(1 − γ(n, d))

 n−1
X

pd (1 − p)n−1−d

(8)

d=0
2

.

The expected number of false negatives per person
for square array testing is

n X
n
X
S
F (n) = p 1 −
(θ(n, d1 , d2 ) − ψ(n, d1 , d2 ))
d1 =1 d2 =1
n−1
d1 −1



n−1
d2 −1



p

d1 +d2 −2

(1 − p)

2n−d1 −d2


.
(9)

The expected number of false positives per person
for square array testing is
 n−1
X
S
e
(1 − γ(n, d))
F (n) = q(1 − p)

n−1
d



d

p (1 − p)

n−1−d

2
.

d=0

(10)
Figure 5 (a)-(c) shows the number of tests per person,
the number of false negatives per person, and the number
of false positives per person with pool size n ranging from
1 up to a maximum size n̄ = 100 for the two methods,
respectively. It holds fixed p = 10−3 and q = 10−3 .
Figure 5 (d)-(e) show the same data, but varying the
pool size implicitly and plotting each two error rate
against the expected number of tests per person.
Foreshadowing the next section, Figure 5d-e show
that there is a trade-off between the number of tests
and the error rates for both methods. In this example,
the square array is able to achieve a smaller number of
expected tests per person than the linear array method.
It also has lower false positive rates, due to the fact

Group Testing Enables Asymptomatic Screening for COVID-19 Mitigation

(a)

11

(b)

(d)

(c)

(e)

Fig. 5: Comparison between the two methods when p = 10−3 and q = 10−3 . In the top 3 plots (a,b,c) we show the
expected number per person of tests, false negatives, and false positives as a function of the pool size for the linear
and square array. In the bottom two plots (d) and (e), we plot the same data where each point corresponds to a pool
size and a testing method (linear array or square array), and show its expected number of false negatives/positives
per person versus its expected number of tests per person.
that a sample needs to test positive 3 times (twice in
pools, once individually) to be declared positive under
the square array method but only needs to test positive
twice under the linear array. If, however, the linear array
method is able to achieve a given test capacity, then it
has fewer false negatives.

4.5 Feasibility and Optimal Pool Size
Here we consider the selection of pool size as an optimization problem. Varying the pool size n, we seek to
minimize the expected number of false negatives per
person tested F (·) (n), subject to the expected number
of tests per person M (·) (n) not exceeding a given level
of testing capacity per person C and the expected number of false positives per person Fe(·) (n) not exceeding a
e
given level of false positive tolerance C.
Formally, we write this as,
minimize

F (·) (n)

n∈{1,2,··· ,n̄}

subject to

(11)
M (·) (n) ≤ C,

e
Fe(·) (n) ≤ C.

where we use superscripts ’L’ for linear array testing
and ’S’ for square array testing.
These constraints reflect the fact that we face the
shortage of testing kits in practice, and that we would
not want to quarantine a large fraction of the population
for no good reason. In addition, by varying constraints
in this optimization problem we trace a Pareto frontier
over test capacity used and the two types of errors: false
positives and false negatives. In the next section, we
use this Pareto frontier within the design of a larger
asymptomatic screening strategy.
We say that a group test method is "feasible" if
there exists a pool size n such that the corresponding
expected number of tests per person is no more than C
and the expected number of false positives per person
e and "infeasible" otherwise.
is no more than C,
We solve (11) by first pre-eliminating infeasible pool
sizes using the fact that (5) and (8) are lower-bounded
by n1 and n2 , respectively. Then we exploit that (6) and
(9) are upper-bounded by q(1 − p) to see if we can
e Finally, we complete
drop the constraint Fe(·) (n) ≤ C.
enumeration over the remaining pool sizes n up to max-

12

imum pool size n̄ = 100, evaluating the objective and
constraints using the expressions (5)-(10).
Figure 5 shows the performance of optimal pool sizes
in terms of the expected number of false negatives per
person while varying the testing capacity per person C
and prevalence p, holding the false positives per pooled
e = 10−4 fixed. The infeatest q = 10−3 and constraint C
sible region for each of the two group testing methods
is left blank. It compares the linear array, square array,
and a benchmark: individual testing.
In the individual testing benchmark, we randomly select a fraction C of the population for which to conduct
individual testing and ignore the rest of the population.
The option to not test some individuals causes all parameters to be feasible for the test capacity constraint.
This benchmark, however, violates the false positive
constraint since q > 10−4 .
Both group testing methods perform much better
than the individual-testing-only benchmark individual.
The square array has a larger feasible region than the
linear array, confirming our earlier argument. Within the
feasible region, the linear array testing achieves fewer
false negatives than the square array.
e and
We do not focus on analysis of the impact of C
q on the feasible region. As argued in Section 4.3 and
illustrated by Figure 5, the expected number of false
positives per person is extremely low when q = 10−3
and p = 10−3 in all cases except the linear array with a
large pool size.

5 Repeated Asymptomatic Screening for
Population-level Prevalence Control
In this section, we consider testing a large population
in a community such as college. Due to limited daily
testing capacity, we can only test the whole population in a testing cycle of multiple days. We propose a
testing-quarantine-infection model, where group testing
is conducted at the beginning of each day and people
who test positive will be quarantined, while the infection
keeps spreading among the non-quarantined population.
Due to the cost of dynamically adjusting pool size, we fix
the pool size in each testing cycle, and only recompute
the optimal pool size at the beginning of each cycle. The
pool size is chosen to minimize the expected number
of false negatives according to the prevalence rate at
the beginning of the testing cycle. An important aspect
of this model is that the number of false negatives will
directly affect the number of people quarantined, which
further impacts the prevalence rate over time.
First, let us describe the primary assumptions:

Yifan Lin et al.

• On each day in a testing cycle, the group testing protocol is applied to a subset of the population which
is selected uniformly at random from the untested
individuals.
• We use a simplified model for the infection process,
where prevalence increases deterministically and exponentially without intervention.
• We assume the tests are conducted at the beginning
of the day, and results can be revealed immediately.
Following test results, people who test positive are
assumed to be quarantined, either by self-quarantine
or hospitalization. Thus, those who test positive
will be removed from the whole population at the
beginning of the day after the testing.
Let us now introduce notations for the model. The
meaning of these parameters and how they relate to the
model dynamics will be clarified shortly. We begin with
the high-level model primitives:
• Ntotal is the total number of individuals in the community.
• T is the number of time periods (days) in our time
horizon.
• l is the number of days in any one testing cycle. Note
that we only consider testing cycle lengths which are
shorter than the time horizon, i.e. l ≤ T .
• α is the daily growth rate of infection.
• p0 is the initial prevalence rate of the disease at the
beginning of the time horizon.
• αout is the proportion of the susceptible population
that gets infected each day from interaction with the
outside community.
• C + is our upper bound on the expected total number
of PCR tests performed in a day. Note this is in
contrast to the notation C used in earlier sections,
which refers to a bound on tests per person. We use
a bound on the total number of tests in this section
because the population size changes over time due
to individuals being quarantined.
The dynamics of each day proceed in two stages: a
testing stage and an infection stage. In the testing stage,
a subset of the population is tested and those who test
positive will be quarantined accordingly. In the infection
stage, people who are free and infectious will continue to
infect the free and susceptible people in the population.
Recall that multiple testing cycles of length l occur
over the time horizon of length T . For each day t =
1, . . . , T in the time horizon, let Nttest denote the number
of individuals who are tested on that day, which is
defined as follows:
( N
t ≡ 1, 2, · · · , l − 1 mod l
d lt0 e,
test
Nt =
Nt0
Nt0 − d l e(l − 1), t ≡ l mod l,

Group Testing Enables Asymptomatic Screening for COVID-19 Mitigation

(a)

13

(b)

(c)

Fig. 6: Comparison of the expected number of false negatives between (a) linear array group testing, (b) square
e = 10−4
array group testing, and (c) benchmark individual testing, for varying values of p and C. Here, we use C
and q = 10−3 . The infeasible region (the region in which the required test capacity cannot be achieved while testing
the full population) is left blank for the two group testing methods. The individual testing benchmark satisfies the
test capacity constraint but violates the false positive constraint.
where t0 is the first day of the testing cycle containing
day t, and Nt0 is the total free population on that day.
We use the following variables to track the state of
the system in each time period. Note that a variable
with a bar on top refers to the not-yet-tested population,
while a variable without the bar refers to the alreadytested population.
• Nt is the total free population at the beginning of
time t, i.e. the number of individuals who have not
been quarantined, at time t.
• On day t, at the beginning of the testing stage: Z̄t
is the total free population that have not yet been
tested within the current testing cycle; Zt is the
total free population that has been tested within the
current testing cycle.
• On day t, at the beginning of the testing stage: Xt
is the total number of infected individuals in the
already-tested free population; X̄t is the number of
infected individuals in the not-tested free population.
• On day t, at the beginning of the infection stage:
Yt is the total number of infected individuals in the
already-tested free population; Ȳt is the number of
infected individuals in the not-tested free population.
We consider testing Ntotal people in l days, and each
day we test Nttest people. At the beginning of day t, we
randomly choose Nttest people from those who have not
been tested yet, and conduct group testing (linear array
or square array methods with follow-up individual tests)
under a limited testing capacity. After group testing,
we mark those who already get tested, and quarantine
those who test positive, and return the rest of the people
back to the population. People who have been tested
will not be tested again in this testing cycle.

Let us now describe the dynamics of the testingquarantine-infection model in more detail. The initial
conditions are summarized as follows:
• At the beginning of the time period, the number of
positive individuals in the non-testing free population are sampled according to the specified prevalence:
X̄1 ∼ Binomial(Ntotal , p0 ).

(12)

• On the first day t = 1, the free non-tested population
is equal to the entire population, and the tested
population is equal to zero:
Z̄1 = Ntotal ,

Z1 = 0.

(13)

The dynamics on each day t proceed as follows. Nttest
individuals are selected uniformly at random from the
non-tested population of size Z̄t . Let I ≤ X̄t be the total
number of infected individuals in the sampled subpopulation. Let QI ≤ I be the number of infected individuals
that the protocol quarantines (i.e. true positives) and
let QS be the number of susceptible individuals that the
protocol quarantines (i.e. false positives). The number
of positive individuals at the beginning of the infection stage for the already-tested subpopulation and the
not-tested free population are updated as:
Yt = Xt + I − QI ,

Ȳt = X̄t − I.

(14)

Note that the dynamics of the testing stage fundamentally depend on the quarantine decisions made
by the testing protocol (as referenced via QI and QS
in equation (14). Our detailed testing protocol model
discussion is contained in Section 4.
The infection stage occurs after the testing stage and
it models the spread of the disease among the unquarantined population. We assume that daily growth rate of

14

Yifan Lin et al.

infection α is the within-community daily transmission
rate, meaning that each unquarantined infected individual transmits the disease to α new individuals each day.
Specifically, the number of new infections within the
community is a binomial random variable:
A ∼ Binomial(Yt + Ȳt , α),

(15)

where Yt + Ȳt is the total number of free and infected
individuals.
In addition, the free and susceptible population can
carry the disease from contact with the outside population. At the beginning of the infection stage, the number
of free and susceptible individuals F S is given by the
difference between the original free population Nt and
the total quarantined population on this day as well as
the total free and infected population on this day:
F S = Nt − QS − QI − Yt − Ȳt .

(16)

The number of new outside infections O is also a
binomial random variable:
O ∼ Binomial(F S, αout ).

(17)

We assume that the total number of new infections
A + O is spread uniformly at random across the free
and susceptible population. Let Jt be the resulting number of new infections which occur in the already-tested
population, and let J¯t be the number of new infections
which occur in the not-yet-tested population.
If t + 1 is in the same testing cycle as day t, then
the infection counts Xt+1 and X̄t+1 at the start of the
testing stage for the next day are then calculated as:
Xt+1 = Yt+1 + Jt+1 ,

X̄t+1 = Ȳt+1 + J¯t+1 ,

(18)

and the total population counts for each group are
updated as:
Zt+1 = Zt + Nttest − QI − QS ,

Z̄t+1 = Z̄t − Nttest .
(19)

On the other hand, if day t + 1 is the beginning of
a new testing cycle, then the state variables reset since
there are no individuals in the already-tested group. We
then have:
Zt+1 = Xt+1 = 0,

Z̄t+1 = Zt + Z̄t − QS − QI ,

(20)

and
X̄t+1 = Ȳt + Yt + Jt + J¯t .

(21)

We also run simulations to determine the optimal
cycle length l∗ from the outset of the dynamics. This optimization also proceeds by simulating the dynamics for
each feasible cycle length l and choosing the cycle length

Algorithm 1: Optimizing cycle length in the
testing-quarantine-infection model.
input : Ntotal , p0 , α, C + , T
output : optimal testing cycle length l∗
for l ← 1 to T do
for replication ← 1 to 100 do
Simulate the population-level infection
dynamics described in Section 5 through a
sequence of equations (12) to (21) using a cycle
length l and parameters Ntotal , p0 , α, C + ;
Record final prevalence at the end of the time
horizon;
end
Compute the average final prevalence rate at the
end of the given time period;
end
Return the optimal testing cycle length l∗ that yields
the smallest average final prevalence rate;

with the minimum final prevalence rate. The algorithm
for choosing the optimal cycle length is summarized in
Algorithm 1.
Finally, let us elaborate on details of the testing protocol we use in our testing-quarantine-infection model.
In our simulations, we use the same pool size in
our group testing protocol for each day in the same
testing cycle, but we re-optimize for a new pool size at
the beginning of each testing cycle. That is, we re-solve
the optimal pool size optimization problem (11) at the
beginning of each testing cycle using information about
the current prevalence rate and the cycle length.
Further, we use a slight modification of the model
described in Section 4, where the model allows us to
gracefully handle test population sizes which do not perfectly fit into a square array of the desired size. Suppose
we have a total of Nttest samples to test on each day.
Since Nttest is large, we choose the pool size using the
optimization (11) for the square array method.
In doing so, we consider using a mixed method of
linear array and square array. More specifically, we fill
X samples in Y complete square arrays, and fill the
remaining Z samples row by row in a square of the same
size. The square arrays are tested using the square array
method, and each row of the incomplete square is tested
using the linear array method. This lets us improve our
testing efficiency and make the tests more convenient to
implement without making changes to the lab setting for
the square array tests. Moreover, since we consider large
population, the outcomes are insensitive to our choice
for the method for testing the leftover. The details are
shown in Appendix C. As expected, because N is large,
we found that the results were almost identical.
Note that the optimization formulation (11) we use
to recompute the optimal pool size at the beginning of
each testing cycle is formulated with respect to a stan-

Group Testing Enables Asymptomatic Screening for COVID-19 Mitigation

dard square array protocol, rather than the mixed square
array and linear array protocol that is implemented in
our simulations. In the appendix we consider an exact
optimization formulation for the mixed array protocol
(22). In practice, we observe that both formulations
produce nearly identical pool size selections.
Details of the mixed array testing protocol within one
testing cycle are summarized in Algorithm 2. Assume
that this cycle begins at day t + 1.
Algorithm 2: Testing protocol within one testing cycle.
Input: Number of people to be tested Nt , estimate of
initial prevalence rate pt , testing capacity C + , cycle
length l;
Output: decisions for each people get tested in this
testing cycle ;
Solve optimization problem (11) based on Nt , pt , C +
and obtain the optimal pool size n∗ for the entire
testing cycle;
Set i = t + 1;
while i ≤ t + l do
In day i, take swab from each individual;
N test

Form b (ni∗ )2 c square array of size n∗ × n∗ . Pools of
size n∗ are created from each row and each column;
Conduct RT-qPCR test for each pool;
Conduct individual test for samples at the
intersection of positive row and positive column;
Conduct linear array test for the remaining
N test

Nitest − b (ni∗ )2 c(n∗ )2 people. All except the last
linear array are using size n∗ , the size of the last
array is depend on the number of remaining people;
Make decisions on each individuals according to the
test results. Set i = i + 1.
end

6 Case Study and Sensitivity Analysis
In this section, we use the testing protocol we present
in Section 5 to contain the spread of the disease in a
community.
This case study aims to provide guidance to decision
makers about how to use group testing protocols to
perform population-level screening with limited testing
capacity.
The formal details of our population-level infection
dynamics model are specified in Section 5. Our model
has inputs which make assumptions about the size of the
community, the initial prevalence rate in the community,
and the rate at which the epidemic grows. Table 1 states
the value we assign to these input variables, separated
into optimistic, nominal, and pessimistic scenarios.
The testing cycle length l varies from 1 to 7, and
we consider a 14-day time horizon, which guarantees

15

multiple (at least 2) complete cycles can be observed.
We record the prevalence rate after each day and we
use 100 replications for simulating each feasible testing
cycle length in each scenario.
6.1 Simulation Results and Analysis
In each scenario, we keep track of the prevalence rate
each day within the 14-day time horizon. Figure 7 shows
the prevalence rate under different cycle lengths l and
also the prevalence rate under individual testing. For
the optimistic scenario, the cycle length l = 1 is not
feasible due to the daily testing capacity, so it is not
included in Figure 7(a). For the nominal scenario, neither
l = 1 nor l = 2 is feasible at the beginning, so they are
not shown in Figure 7(b). For the pessimistic scenario,
l = 1, 2, 3 are not feasible at the beginning, and l = i is
not feasible at day i, i = 4, 5, 6, 7. Therefore, Figure 7(c)
has a truncated pattern. The estimated final prevalence
rates, total number of quarantined individuals and total
number of testing are listed in Table 2. The optimal
pool size and the number of tests each day are shown
in Figure 8.
Figure 7 shows that for all three scenarios, the mixed
array method leads to a much lower final prevalence rate
than the individual testing. However, in the pessimistic
setting, the virus spreading is out of control. Hence
we focus on the first two scenarios in the following.
The final prevalence rate turns out to be monotonically
decreasing as testing cycle decreases. As a result, the
optimal testing cycle length is l = 2 for the optimistic
scenario, and the optimal testing cycle length is l = 3
for the nominal case. In contrast, for both optimistic
and nominal scenarios the prevalence rate gets out of
control when individual test is used.
Figure 8 suggests that the optimal pool size is around
10 to 30, which is not too large. However, considering
the pool size limit 100 we set, this is relatively small.
This is because we are minimizing false negative rate in
(11), and false negative rate becomes low as the pool size
decreases. Compared with the individual testing, group
testing uses much less number of tests each day. Table 2
shows that the number of tests is minimized when l = 4
under the optimistic scenario. Also, from Figure 9, the
number of true positives detected of individual testing
is much lower than group testing in all scenarios, and
correspondingly, the false positive rate of individual is
higher.
In addition, it is worth-noting that the prevalence
rate exhibits a periodic trend. As shown in Figure 11, if
we have a detailed look of two prevalence rate curves of
l = 3, 4 under nominal scenario, we can see the periodic
pattern clearly. To explain this special pattern, before

16

Yifan Lin et al.

Table 1: Parameter settings for three scenarios: optimistic case, nominal case, and pessimistic case.
Scenario Name
Ntotal : Population size
T : Time Horizon
p0 : Initial prevalence rate
C + : The total number of testing capacity
q: The false positive rate of each PCR test
α: Daily transmissions per free infected
αout : Daily outside infection rate

Optimistic case
100000
14
0.001
3000
0.01
0.1
0.00002

(a)

Nominal case
100000
14
0.005
3000
0.01
0.2
0.0005

Pessimistic case
100000
14
0.01
3000
0.01
0.3
0.003

(b)

(c)

Fig. 7: Prevalence rates of the mixed array method with different testing cycle length l under (a) optimistic scenario;
(b) nominal scenario; (c) pessimistic scenario.
Table 2: The estimated final prevalence rate, total number of quarantined, and total number of tests for the mixed
array group testing with different cycle length l and the benchmark individual testing. For pessimistic scenario, the
results are based on only one testing cycle.

Optimistic

Nominal

Pessimistic

Testing cycle length

1

2

3

4

5

6

7

individual

Final
Total
Total
Final
Total
Total
Final
Total
Total

NAN
NAN
NAN
NAN
NAN
NAN
NAN
NAN
NAN

5.62E-05
143.24
41076.9
NAN
NAN
NAN
NAN
NAN
NAN

1.10E-04
152.01
40358.1
3.46E-03
1693.53
41844.36
NAN
NAN
NAN

1.87E-04
159.52
39034.41
6.05E-03
1820.97
43075.21
2.23E-02
1467.93
17303.84

2.92E-04
164.37
40057.26
8.90E-03
1955.04
42668.99
2.99E-02
1786.47
19869.96

4.14E-04
164.59
38954.06
1.25E-02
1974.68
42551
3.98E-02
2211.33
23208.97

4.88E-04
172.97
40074.96
1.51E-02
2099.43
42119.53
5.29E-02
2694.66
26145.92

2.79E-03
499.45
42000
6.44E-02
1444.52
42000
5.40E-01
6129.11
42000

prevalence rate
quarantined
test times
prevalence rate
quarantined
test times
prevalence rate
quarantined
test times

the testing stage of each day t, we consider the prevalence rate among two subsets of all non-quarantined
individuals: those who has been tested and those who
are going to be tested, and we plot these two prevalence
rates in Figure 12. Within one testing cycle, Figure 12
shows that the the prevalence rate in the about-to-test
individuals becomes much higher than that in the individuals that have been tested. This will result in the
increase of daily number of tests in a testing cycle, as
Figure 8(e) shows, and more tests will lead to more
quarantined, as shown in Figure 9, thus low prevalence
rate in return. Therefore, with this chain reaction, we
observe the prevalence rate go through a process of
first increasing and then decreasing. It turns out that
with every feasible testing cycle length and under every
scenario, this pattern exists.

Furthermore, it is interesting to observe that for
all three scenarios, the smaller cycle length initially
has the largest false negative rate because of the large
pool size, but the false negative rate drops quickly over
time and becomes comparable with other cycle lengths,
as shown in Figure 13. Under the current parameter
setting, it turns out that when l is small, the larger
tested population offsets the disadvantage brought by
higher false negative rate, leading to the result that
more infected individuals get quarantined and hence
less virus carrier in the population.

6.2 Sensitivity Analysis
In this section we vary the testing capacity parameter
C + and the false positive rate parameter q, which are

Group Testing Enables Asymptomatic Screening for COVID-19 Mitigation

17

(a)

(b)

(c)

(d)

(e)

(f)

Fig. 8: Optimal pool size of the mixed array method with different testing cycle length under (a) optimistic scenario;
(b) nominal scenario; (c) pessimistic scenario; Daily number of tests of the mixed array method with different
testing cycle length under (d) optimistic scenario; (e) nominal scenario; (f) pessimistic scenario;

(a)

(b)

(c)

Fig. 9: The number of quarantined people of mixed array method with different testing cycle length under (a)
optimistic scenario; (b) nominal scenario; (c) pessimistic scenario
two key parameters for the performance of virus control
other than p0 and α, which have already been considered
in the three scenarios.
6.2.1 Sensitivity Analysis of Testing Capacity
We do sensitivity analysis on the testing capacity C + for
both the nominal and pessimistic scenario. Specifically,
for the nominal scenario we run simulations changing
the testing capacity value to each of the following values:
C + = 5000, 10000, 20000. For the pessimistic scenario,
we simulate the difference between C + = 10000 and
C + = 20000.
Figure 14 shows how the prevalence rate varies over
time in the nominal scenario for each of the testing
capacity values C + , and for multiple values of the testing
cycle length l. Figure 16 similarly shows how prevalence

rate varies over time for different testing capacities C +
and different testing cycle lengths l.
From Figure 14, we observe that changes in C + have
a large effect throughout the whole time horizon. For
example, in the nominal scenario simulations for a short
testing cycle length l = 3 the final prevalence rate under
C + = 3000 is 0.0035, whereas the final prevalence under
C + = 10000 is 0.0025. This is a reduction in prevalence
by almost 30%. A similar trend can be observed for all
the testing cycle length values l we include.
We observe a similar effect for the pessimistic scenario, although the magnitude of the effect is less pronounced. From Figure 16 we see that with a short testing
cycle l = 2 that final prevalence under C + = 10000 is
0.01, while final prevalence under C + = 20000 is 0.0085;
a 15% reduction in prevalence.

18

Yifan Lin et al.

(a)

(b)

(c)

(d)

(e)

(f)

Fig. 10: Number of true positives of mixed array method with different testing cycle length under (a) optimistic
scenario; (b) nominal scenario; (c) pessimistic scenario; Number of false positives of mixed array method with
different testing cycle length under (d) optimistic scenario; (e) nominal scenario; (f) pessimistic scenario.

Fig. 11: Detailed look for the prevalence rate curve of
l = 3, 4, 5, 6, 7 under nominal scenario.

From this simulation analysis we can draw the conclusion that increased testing capacity is a valuable
resource for controlling prevalence in the population.

6.2.2 Sensitivity Analysis of False Positive
Rate

Fig. 12: Comparison of prevalence rate among two subsets of all non-quarantined individuals.

Our sensitivity analysis for the false positive rate q
focuses on the nominal scenario, and runs simulations
setting over the range of values: q = 0.01, 0.02, 0.03. Our
metric of interest for this study is both the prevalence
rate and the daily number of uninfected individuals who
enter quarantine. Results for the prevalence rate are
plotted in Figure 17 and results for the number of false
positives are plotted in Figure 18.

From Figure 18, we can observe that the number of
false positives will increase as q increases, which is to
be expected. Moreover, in Figure 17 we observe that
the prevalence rate is in fact increasing for each of the
testing cycle lengths l = 4, 5, 6. From this we conclude
that a rapid testing cycle length can have a strong effect
on containing the virus spread in a close community, and

Group Testing Enables Asymptomatic Screening for COVID-19 Mitigation

(a)

19

(b)

(c)

Fig. 13: Number of false negatives of mixed array method with different testing cycle length under (a) optimistic
scenario; (b) nominal scenario; (c) pessimistic scenario.

(a)

(b)

(c)

(d)

Fig. 14: Prevalence rate of different values of C + with (a) l = 3, (b) l = 4, (c) l = 5, (d) l = 6 under nominal
scenario.
that this effect dominates the effect of the false positive
rate q over the range of parameters we consider.

Availability of data and material
Not Applicable.

Declarations

Code availability

Funding

All codes that are used in this study can be found in
https://github.com/Wanogon/COVID-19-Project.

The research was supported by the National Science
Foundation under Grant CAREER CMMI-1453934 and
the Air Force Office of Scientific Research under Grant
FA9550-19-1-0283.

Appendices
A Effect of Correlation between Tests on False
Negatives

Conflicts of interest
The authors declare that they have no conflict of interest.

Above we argued that a consequence of our model is that test
results for infected people are correlated across the pools it participates in (including pools of size 1). We then argued that this

20

Yifan Lin et al.

(a)

(b)

(c)

(d)

Fig. 15: (a) Optimal pool size, (b) number of true positives, (c) number of false positives and (d) number of false
negatives for different values of C + under nominal scenario, l = 3.

(a)

(b)

(c)

(d)

Fig. 16: Prevalence rate for different values of C + with (a) l = 2, (b) l = 3, (c) l = 4, (d) l = 5 under pessimistic
scenario

reduces false negatives compared with a model that assumes test
results for such samples are independent. Here in this section, we
demonstrate this formally.
Theorem 1 Consider a model identical to ours but in which
the results from pooled tests and followup individual tests are
all conditionally independent given which samples contain virus.
The probability that a true positive tests negative is lower under
our model than in this alternative model, for both linear and

square array protocols. The probability that a true negative tests
positive is unchanged.
Proof We first focus on false negatives. Consider a true positive
sample. Let V be its viral load. Given a pool of size n in which
this (true) positive sample of interest participates, and that the
positive sample has a viral load of V , let r(n, V ) be the conditional probability that this pool tests positive. Calculating this
quantity requires marginalizing across the all other n − 1 samples

Group Testing Enables Asymptomatic Screening for COVID-19 Mitigation

21

(a)

(b)

(c)

(d)

Fig. 17: Prevalence rate for different values of q with (a) l = 3, (b) l = 4, (c) l = 5, (d) l = 6 under nominal scenario.

in the pool, whether they are positive, their viral loads if they
are, and the probability q that the pool tests positive even if the
viral load is not sufficient to make it do so alone. In our model,
r(n, V ) is increasing in V .
Let Yj be the event that the jth pool our sample of interest
participates in tests positive. Let Z be the event that its follow-up
individual test tests positive (if this test is not actually conducted,
Z is the event that it would have tested positive, if it were conducted). Thus, Yj has probability r(n, V ) and Z has probability
r(1, V ).
Consider the linear array method. Under this method, the
sample tests positive if both Y1 and Z occur. This occurs with
probability
P (Y1 , Z ) = E [P (Y1 , Z|V )] = E [P (Y1 |V )P (Z|V )]
since Y1 and Z are conditionally independent given V . [44] shows
that the expectation of a product of increasing functions of a random variable is larger than the product of the expectations. Since
P (Y1 |V ) = r(n, V ) and P (Z|V ) = r(1, V ) are both increasing in
V , we have
P (Y1 , Z ) ≥ E [P (Y1 |V )]E [P (Z|V )] = P (Y1 )P (Z )
which is the probability that the sample would test positive if
test errors were independent across tests.
The proof for the square array method is similar, except it
must also leverage the fact that results from a positive sample’s
two pools are conditionally independent given its viral load because no other samples that participate are in both row and column pools.
The square array identifies the sample as positive if events
Y1 , Y2 and Z occur.
P (Y1 , Y2 , Z ) = E [P (Y1 , Y2 , Z|V )] = E [P (Y1 |V )P (Y2 |V )P (Z|V )]
≥ E [P (Y1 |V )]E [P (Y2 |V )]E [P (Z|V )]

= P (Y1 )P (Y2 )P (Z )

where we have used the above-described conditional independence
of Y1 and Y2 given V , [44] and the fact that P (Y1 |V ) = P (Y2 |V ) =
r(n, V ) and P (Z|V ) = r(1, V ) are both increasing in V .
We now turn to false positives. As before consider a fixed
sample but now suppose it is a true negative and so has V = 0
viral load.
The probability that it tests positive under the linear array is
P (Y1 , Z|V = 0) = P (Y1 |V = 0)P (Z|V = 0) because the pooled
test result and the individual followup result are conditionally
independent given the viral load. This is the same probability
that would be provided under the alternate model assuming independent errors. The key difference between this analysis of a
true negative and the above analysis of a true positive is that the
viral load is deterministic given that the sample is a true negative
but is random given that it is a true positive.
The square array case is similar, and we again must use
that the other samples participating in the sample of interest’s
pools do not overlap between rows and columns. Thus, the probability that the sample tests positive under the square array is
P (Y1 , Y2 , Z|V = 0) = P (Y1 |V = 0)P (Y2 |V = 0)P (Z|V = 0)
which is the same as in the alternate model with independent
errors. u
t

B Derivation for the Linear Array Group
Testing
In the linear array testing, suppose the total number of people
to test is N and the desired group size is n. Note that the corresponding pool size is also n. We will form d N
e linear array groups
n
and perform group testing on each group. Note that if N is not
divisible by n, b N
c of the groups are of size n and the last group
n
is of size N − b N
cn.
n

22

Yifan Lin et al.

(a)

(b)

(c)

(d)

Fig. 18: Number of false positives (i.e. uninfected individuals who are quarantined) for different values of q with (a)
l = 3, (b) l = 4, (c) l = 5, (d) l = 6 under nominal scenario.
B.1 Expected Number of Tests

The expected number of false negatives for a single pool of
size n is

The expected number of follow-up individual tests for a single
pool of size n is

L
fPL (n) = fIL (n) + fG
(n)


n 
X
mL
(
n
)
=
n
1
−
γ
(
n,
d
)
P

n
d

=


(1 − p)n−d (p)d .

N
N
N
L
= d e + b cmL
cn).
P (n) + mP (N − b
n
n
n
bN
n

mL
P



Notice that
N−
cn is finite. The expected number
of tests per person for the linear array testing of pool size n for
large N is

1

N →∞

=

1
n

+

n
d


(1 − p)n−d (p)d .

The total expected number of false negatives for pool of size

The total expected number of tests for the linear array testing
of pool size n is

M L (n) = lim

(η (n, d) + γ (n, d)) d

d=1

d=0

MPL (N, n)

n
X

N

FPL (N, n) = b

N L
N
cf (n) + fPL (N − b cn).
n P
n

Notice that fPL N − b N
cn is finite. The expected number
n
of false negatives per person for a single pool of size n for large
N is



1

F L (n) = lim

MPL (N, n)


n 
X
1 − γ (n, d)

n is

n
d


(1 − p)n−d (p)d .

=

N →∞
n
X

N

FPL (N, n)

(η (n, d) + γ (n, d))

n−1
d−1


(1 − p)n−d (p)d .

d=1

d=0

B.2 Expected Number of False Negatives

B.3 Expected Number of False Positives

The expected number of false negatives resulted from the group
for a single linear array pool of size n is

The expected number of false positives for a single pool of size n
is

L
fG
(n) =

n
X

dγ (n, d)

n
d


(1 − p)n−d (p)d .

The expected number of false negatives for the follow-up individual tests for a single pool of size n is
n
X
d=1

n−
X1

(1 − γ (n, d))(n − d)

n
d


(1 − p)n−d (p)d .

d=0

d=1

fIL (n) =

fePL (n) = q

η (n, d)d

n
d


(1 − p)n−d (p)d .

The expected total number of false positives, in b N
c arrays
n
cn
)
,
is
of size n and one array of size (N − b N
n
FePL (N, n) = b

N eL
cf (n) + fePL
n P


N −b



N
cn .
n

Group Testing Enables Asymptomatic Screening for COVID-19 Mitigation
Notice that fePL N − b N
cn is finite. The expected number
n
of false positives per person for the linear array testing of pool
size n for large N is



n−
X1

n
n
X
X

ψ (n, d1 , d2 )

n−1
d1 −1



n−1
d2 −1

pd1 +d2 −1 (1 − p)2n−d1 −d2 .



d1 =1 d2 =1

N

= q (1 − p)

The expected number of false negatives for the follow-up individual tests for a single square array group of size n × n is
fIS (n) = n2

1 eL
FP (N, n)
FeL (n) = lim
N →∞

23

n−1
d

(1 − γ (n, d))

The expected number of false negatives for a single square
array group of size n × n is


(1 − p)n−d−1 (p)d .

d=0

S
fPS (n) = fIS (n) + fG
(n)


n
n
X
X
(θ(n, d1 , d2 ) − ψ (n, d1 , d2 ))
= n2 p 1 −

C Derivation for the Square Array Group
Testing

d1 =1 d2 =1
n−1
d1 −1

n−1
d2 −1



In square array testing, suppose the total number of people to test
is N and we consider the square array of size n × n. Pools of size
n are created from each row and each column. We will form b nN2 c
square arrays of size n × n. Note that if N is not divisible by n2 ,
for the remaining N − b nN2 cn2 people, we will fit the remaining
N − b nN2 cn2 people into an incomplete matrix with row pool size
n and column pool size less than n.



pd1 +d2 −2 (1 − p)2n−d1 −d2 .



Denoted by fR (N, n) the expected number of false negatives
for the remaining group, 0 ≤ fR (N, n) ≤ n2 . The total expected
number of false negatives for square array test is
FPS (N, n) = b

N S
cf (n) + fR (N, n).
n2 P

The expected number of false negatives per person for a single
group test of size n × n for large N is

C.1 Expected Number of Follow-up Individual
Tests
The expected number of follow-up individual tests for a single
group of size n × n is
mS
P (n)

2

=n

n
X

p

n
X

θ(n, d1 , d2 )

n−1
d1 −1



n−1
d2 −1



p

d1 +d2 −2

F S (n) = lim

N →∞

1

FPS (N, n)

N


n
n
X
X
=p 1−
(θ(n, d1 , d2 ) − ψ (n, d1 , d2 ))
d1 =1 d2 =1
n−1
d1 −1

n−1
d2 −1



2n−d1 −d2

(1 − p)



pd1 +d2 −2 (1 − p)2n−d1 −d2 .



d1 =1 d2 =1

!2 !

n−
X1

(1 − γ (n, d))

+ (1 − p)

n−1
d

 d
(p) (1 − p)n−1−d

.

C.3 Expected Number of False Positives

d=0

b nN2 c

For the total N subjects, we need
square array tests,
and an incomplete square array test. Denoted by mR (N, n) the
expected number of tests for the remaining group, including the
number of pooled tests and the number of follow-up individual
tests, 0 ≤ mR (N, n) ≤ 2n + n2 . Therefore, the expected total
number of tests for the square array of group size n × n is
MPS (N, n) = b





N
c mS
P (n) + 2n
n2

+ mR (N, n).

The expected number of tests per person for the square array
testing of group size n × n for large N is

The expected number of false positives for a single group of size
n × n is

 n−
X1
(1 − γ (n, d))

fePS (n) = n2 q (1 − p)

N →∞

=

2
n

+p

1
N

MPS (N, n)

n
n
X
X

θ(n, d1 , d2 )

n−1
d1 −1



n−1
d2 −1



p

d1 +d2 −2

2n−d1 −d2

(1 − p)

d1 =1 d2 =1

+ (1 − p)

n−
X1

(1 − γ (n, d))

 d
(p) (1 − p)n−1−d

.

.

N eS
cf (n) + feR (N, n).
n2

The expected number of false positives per person for the
square array testing of group size n × n for large N is

N →∞

1 eS
FP (N, n)

N

 n−
X1
= q (1 − p)
(1 − γ (n, d))

d=0

2

Denoted by feR (N, n) the expected number of false negatives
for the remaining group, 0 ≤ feR (N, n) ≤ n2 . The expected total
number of false positives, in b nN2 c square arrays of size n × n and
remaining incomplete square array, is

FeS (n) = lim

!2
n−1
d

pd (1 − p)n−1−d



d=0

FeS (N, n) = b
M S (n) = lim

n−1
d

n−1
d

pd (1 − p)n−1−d



2
.

d=0

C.2 Expected Number of False Negatives
The expected number of false negatives resulted from the group
for a single square array of group size n × n is

S
fG
(n) = n2 p 1 −

n
X

n
X

d1 =1 d2 =1


θ(n, d1 , d2 )

n−1
d1 −1



n−1
d2 −1

pd1 +d2 −2 (1 − p)2n−d1 −d2  .



D Mixed Array Group Testing
Suppose we have a total of N samples to test on each day. However, for a given pool size n, we can not always fill the N samples
into matrices of n × n. We could fill the remaining samples into
smaller matrices but it costs a lot to change pool size dynamically

24

Yifan Lin et al.

during experiment in classical lab setting. Instead, we consider
using a mixed method of linear array and square array.
In this method, we conduct b nN2 c square array tests and for
the remaining N − n2 b nN2 c samples, we will do



N −n2 b N2 c
n
n



linear array tests of pool size n and a linear array test of pool
size N − nb N
c if N − nb N
c=
6 0. Therefore, the expected total
n
n
number of tests for the mixed array of pool size n is:



$
+

N−

n2 b nN2 c

&



N
MP (N, n) = b 2 c mS
P (n) + 2n
n

+

N − n2 b nN2 c
n

%

n

'

L
mL
P (n) + mP (N − b

N
cn).
n

The total expected number of false negatives for the mixed
array test is:
N
FP (N, n) = b 2 cfPS (n) +
n

$

N − n2 b nN2 c

%
fPL (n)

n

+fPL (N − b

N
cn).
n

The total expected number of false positives for the mixed
array test is:
N
FeP (N, n) = b 2 cfePS (n) +

$

N − n2 b nN2 c

n

%

n

+fePL (N − b

fePL (n)
N
cn).
n

We actively monitor and update the prevalence rate in each
testing cycle. Given the total number of samples to test N , the
prevalence rate p in the beginning of each testing cycle, a given
level of testing capacity per person C, and a given level of false
e we optimize the pool size as follows:
positive tolerance C,
minimize
n∈{1,2,··· ,n̄}

subject to

FP (N, n)
(22)
MP (N, n) ≤ CN,

e
FeP (N, n) ≤ CN.

References
1. Aldridge M, Johnson O, Scarlett J (2019) Group testing: An
information theory perspective. Foundations and Trends in
Communications and Information Theory 15(3-4):196–392
2. Armendáriz I, Ferrari PA, Fraiman D, Dawson SP (2020)
Group testing with nested pools. arXiv:200513650 [mathST]
https://arxiv.org/abs/2005.13650
3. Atia GK, Saligrama V (2012) Boolean compressed sensing
and noisy group testing. IEEE Transactions on Information
Theory 58(3):1880–1901
4. Bai Y, Yao L, Wei T, Tian F, Jin DY, Chen L, Wang M
(2020) Presumed asymptomatic carrier transmission of covid19. Jama 323(14):1406–1407
5. Barg A, Mazumdar A (2017) Group testing schemes from
codes and designs. IEEE Transactions on Information Theory
63(11):7131–7141
6. Bateman AC, Mueller S, Guenther K, Shult P (2020) Assessing the dilution effect of specimen pooling on the sensitivity
of sars-cov-2 pcr tests. Journal of Medical Virology
7. Ben-Ami R, Klochendler A, Seidel M, et al (2020) Large-scale
implementation of pooled RNA extraction and RT-PCR for
SARS-CoV-2 detection. Clinical Microbiology and Infection
26(9):1248–1253

8. Brault V, Mallein B, Rupprecht JF (2020) Group testing as
a strategy for the epidemiologic monitoring of COVID-19.
arXiv:200506776 [q-bioQM] https://arxiv.org/abs/2005.
06776
9. Broder AZ, Kumar R (2020) A note on double pooling tests. arXiv:200401684 [csDM] https://arxiv.org/abs/
2004.01684
10. Brown J, Shesser R, Simon G, Bahn M, Czarnogorski M,
Kuo I, Magnus M, Sikka N (2007) Routine hiv screening in
the emergency department using the new us centers for disease control and prevention guidelines: results from a highprevalence area. JAIDS Journal of Acquired Immune Deficiency Syndromes 46(4):395–401
11. Cashore JM, Duan N, Janmohamed A, Wan J, Zhang
Y, Henderson S, Shmoys D, Frazier P (2020) COVID19 mathematical modeling for cornell’s fall semester.
https://people.orie.cornell.edu/pfrazier/COVID_19_
Modeling_Jun15.pdf
12. Chang JT, Crawford FW, Kaplan EH (2020) Repeat
SARS-CoV-2 testing models for residential college populations. medRxiv https://www.medrxiv.org/content/early/
2020/07/16/2020.07.09.20149351
13. Chen N, Hu M, Zhang C (2020) Capacitated sir model with
an application to covid-19. https://ssrn.com/abstract=
3692751
14. Cheraghchi M, Hormati A, Karbasi A, Vetterli M (2009)
Compressed sensing with probabilistic measurements: A
group testing solution. In: 2009 47th Annual Allerton Conference on Communication, Control, and Computing (Allerton),
IEEE, pp 30–35
15. Cleary B, Hay JA, Blumenstiel B, Harden M, Cipicchio M,
Bezney J, Simonton B, Hong D, Senghore M, Sesay AK, et al.
(2020) Using viral load and epidemic dynamics to optimize
pooled testing in resource constrained settings. medRxiv
https://doi.org/10.1101/2020.05.01.20086801
16. Court E (2020) Cornell chalks up rare covid19
containment
victory.
Bloomberg
URL
https:
//www.bloomberg.com/news/articles/2020-10-28/
cornell-chalks-up-rare-covid-19-containment-victory?
sref=9f0rXTjL
17. Cowling BJ, Lau LL, Wu P, Wong HW, Fang VJ, Riley S,
Nishiura H (2010) Entry screening to delay local transmission
of 2009 pandemic influenza a (h1n1). BMC infectious diseases
10(1):82
18. Dorfman R (1943) The detection of defective members
of large populations. Annals of Mathematical Statistics
14(4):436–440
19. Eberhardt JN, Breuckmann NP, Eberhardt CS (2020) Multistage group testing improves efficiency of large-scale covid-19
screening. Journal of Clinical Virology p 104382
20. Forootan A, Sjöback R, Björkman J, Sjögreen B, Linz L, Kubista M (2017) Methods to determine limit of detection and
limit of quantification in quantitative real-time PCR (qPCR).
Biomolecular detection and quantification 12:1–6
21. Frazier P, Cashore M, Zhang Y (2020) Feasibility
of COVID-19 screening for the U.S. population with
group testing. URL https://docs.google.com/document/d/
1joxMjHdWWo9XLFqfTdNXPQRAfeMjHYEyvVljqNCaKyE/, Cornell
University working paper, April 24 2020
22. Gollier C, Gossner O (2020) Group testing against covid-19.
Covid Economics pp 32–42
23. Graff LE, Roeloffs R (1972) Group testing in the presence
of test error; an extension of the dorfman procedure. Technometrics 14:113–122
24. Graff LE, Roeloffs R (1974) A group-testing procedure in the
presence of test error. Journal of the American Statistical

Group Testing Enables Asymptomatic Screening for COVID-19 Mitigation
Association 69(345):159–163
25. Hsiang MS, Lin M, Dokomajilar C, Kemere J, Pilcher CD,
Dorsey G, Greenhouse B (2010) PCR-based pooling of dried
blood spots for detection of malaria parasites: optimization
and application to a cohort of ugandan children. Journal of
clinical microbiology 48(10):3539–3543
26. Hwang FK (1976) Group testing with a dilution effect.
Biometrika 63(3):671–680
27. Indyk P, Ngo HQ, Rudra A (2010) Efficiently decodable nonadaptive group testing. In: Proceedings of the twenty-first annual ACM-SIAM symposium on Discrete Algorithms, SIAM,
pp 1126–1142
28. Jones TC, Mühlemann B, Veith T, Biele G, Zuchowski M,
Hoffmann J, Stein A, Edelmann A, Corman VM, Drosten C
(2020) An analysis of SARS-CoV-2 viral load by patient age.
medRxiv https://doi.org/10.1101/2020.06.08.20125484
29. Kim HY, Hudgens MG, Dreyfuss JM, Westreich DJ, Pilcher
CD (2007) Comparison of group testing algorithms for
case identification in the presence of test error. Biometrics
63(4):1152–1163
30. Knill E, Bruno W, Torney D (1998) Non-adaptive group testing in the presence of errors. Discrete Applied Mathematics
88(1):261 – 290, https://doi.org/10.1016/S0166-218X(98)
00075-4
31. Kuehnert MJ (2016) Screening of blood donations for zika
virus infection—puerto rico, april 3–june 11, 2016. Morbidity
and mortality weekly report 65
32. Lohse S, Pfuhl T, Berkó-Göttel B, Rissland J, Geißler T,
Gärtner B, Becker SL, Schneitler S, Smola S (2020) Pooling of samples for testing for SARS-CoV-2 in asymptomatic
people. The Lancet Infectious Diseases https://doi.org/10.
1016/S1473-3099(20)30362-5
33. Malioutov D, Malyutov M (2012) Boolean compressed sensing: LP relaxation for group testing. In: 2012 IEEE International Conference on Acoustics, Speech and Signal Processing, pp 3305–3308
34. Malyutov M (2013) Search for sparse active inputs: A review.
In: Aydinian H, Cicalese F, Deppe C (eds) Information Theory, Combinatorics, and Search Theory: In Memory of Rudolf
Ahlswede, Springer Berlin Heidelberg, Berlin, Heidelberg, pp
609–647
35. Mentus C, Romeo M, DiPaola C (2020) Analysis and applications of adaptive group testing methods for COVID-19.
medRxiv https://doi.org/10.1101/2020.04.05.20050245
36. Mutesa L, Ndishimye P, Butera ea (2020) A strategy for finding people infected with sars-cov-2: optimizing pooled testing at low prevalence. medRxiv https://www.medrxiv.org/
content/early/2020/08/03/2020.05.02.20087924
37. Muñoz-Zanzi C, Thurmond M, Hietala S, Johnson W (2006)
Factors affecting sensitivity and specificity of pooled-sample
testing for diagnosis of low prevalence infections. Preventive
veterinary medicine 74:309–22, DOI 10.1016/j.prevetmed.
2005.12.006
38. Narayanan KR, Heidarzadeh A, Laxminarayan R (2020)
On accelerated testing for COVID-19 using group testing.
arXiv:200404785 [csIT] https://arxiv.org/abs/2004.04785
39. Nguyen NT, Aprahamian H, Bish EK, Bish DR (2019) A
methodology for deriving the sensitivity of pooled testing,
based on viral load progression and pooling dilution. Journal
of Translational Medicine
40. Paltiel AD, Zheng A, Walensky RP (2020) Assessment of
SARS-CoV-2 Screening Strategies to Permit the Safe Reopening of College Campuses in the United States. JAMA
Network Open 3(7)
41. Phatarfod R, Sudbury A (1994) The use of a square array
scheme in blood testing. Statistics in Medicine 13(22):2337–

25

2343
42. Pilcher CD, McPherson JT, Leone PA, Smurzynski M, OwenO’Dowd J, Peace-Brewer AL, Harris J, Hicks CB, Eron Jr JJ,
Fiscus SA (2002) Real-time, universal screening for acute hiv
infection in a routine hiv counseling and testing population.
Jama 288(2):216–221
43. Pilcher CD, Westreich D, Hudgens MG (2020) Group testing
for sars-cov-2 to enable rapid scale-up of testing and real-time
surveillance of incidence. The Journal of Infectious Diseases
44. Schmidt KD (2014) On inequalities for moments and the
covariance of monotone functions. Insurance: Mathematics
and Economics 55:91–95
45. Shental N, Levy S, Wuvshet V, et al (2020) Efficient highthroughput sars-cov-2 testing to detect asymptomatic carriers. Science advances 6(37):eabc5961
46. Sobel M, Groll PA (1959) Group testing to eliminate efficiently all defectives in a binomial sample. Bell System
Technical Journal 38(5):1179–1252, https://onlinelibrary.
wiley.com/doi/abs/10.1002/j.1538-7305.1959.tb03914.x
47. Theagarajan LN (2020) Group testing for COVID-19: How
to stop worrying and test more. arXiv:200406306 [statME]
https://arxiv.org/abs/2004.06306
48. Van TT, Miller J, Warshauer DM, Reisdorf E, Jernigan D,
Humes R, Shult PA (2012) Pooling nasopharyngeal/throat
swab specimens to increase testing capacity for influenza
viruses by PCR. Journal of clinical microbiology 50(3):891–
896
49. Wein LM, Zenios SA (1996) Pooled testing for hiv screening:
capturing the dilution effect. Operations Research 44(4):543–
569
50. Westreich DJ, Hudgens MG, Fiscus SA, Pilcher CD (2008)
Optimizing screening for acute human immunodeficiency
virus infection with pooled nucleic acid amplification tests.
Journal of Clinical Microbiology 46(5):1785–1792
51. Weusten J, Vermeulen M, van drimmelen H, Lelie N (2011)
Refinement of a viral transmission risk model for blood donations screened by nat in different pool sizes and repeat test
algorithms. Transfusion 51:203–15
52. Yelin I, Aharony N, Shaer-Tamar E, Argoetti A, Messer E,
Berenbaum D, Shafran E, Kuzli A, Gandali N, Hashimshony
T, et al. (2020) Evaluation of COVID-19 RT-qPCR test in
multi-sample pools. MedRxiv
53. Zenios SA, Wein LM (1998) Pooled testing for hiv prevalence estimation: exploiting the dilution effect. Statistics in
Medicine 17(13):1447–1467

