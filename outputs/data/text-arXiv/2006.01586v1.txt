arXiv:2006.01586v1 [q-bio.PE] 2 Jun 2020

Stochastic Modeling of an Infectious Disease
Part I: Understand the Negative Binomial Distribution
and Predict an Epidemic More Reliably
Hisashi Kobayashi∗
Dept. of Electrical Engineering
Princeton University
Princeton, NJ 08544, U.S.A.
May 28, 2020

Summery
Why are the epidemic patterns of COVID-19 so different among different cities or countries
which are similar in their populations, medical infrastructures, and people’s behavior? Why are
forecasts or predictions made by so-called experts often grossly wrong, concerning the numbers of
people who get infected or die?
The purpose of this study is to better understand the stochastic nature of an epidemic disease
such as COVID-19, and answer the above questions. The author hopes that this article will provoke
discussions among the “modeling communities” and stimulate mathematically inclined people to
study this interesting and important field, i.e., mathematical epidemiology.
Much of the work on infectious diseases has been based on “SIR deterministic models,” pioneered
by Kermack and McKendrick in 1927. In our study we will explore several stochastic models
that can capture the essence of the seemingly erratic behavior of an infectious disease, which the
deterministic model cannot explain. A stochastic model, in its formulation, takes into account the
random nature of an infectious disease. Thus, such a model, if properly constructed, should be able
to provide a more reliable and informative forecast of an epidemic pattern.
The stochastic model we study in this article is based on the birth-and-death process with
immigration(BDI for short), which was originally proposed in the study of population growth
or extinction of some biological species. To the best of this author’s knowledge, the BDI process
model has not been investigated by the epidemiology community, perhaps for the reason we briefly
discuss in Section 2.
The general birth-and-death (BD) process usually defies an attempt to obtain a closed solution
for the time-dependent (i.e., transient) probability distribution of the population size, etc. The BDI
process, however, is among a small number of BD processes, which we can solve analytically. An
important feature of the BDI process is that its probability distribution function is a generalized
∗
The Sherman Fairchild University Professor of Electrical Engineering and Computer Science, Emeritus. Email:
hisashi@princeton.edu, Blog: http://hp.hisashikobayashi.com, Wikipedia: https://en.wikipedia.org/wiki/
Hisashi_Kobayashi

1

negative binomial distribution (NBD), with its parameter r being less than one. We show that
the “coefficient of variation” (the standard deviation normalized by the mean) of the BDI process
is larger than r−1 > 1. Furthermore, a NBD with small r has a long tail in its distribution form,
like the zeta distribution (aka Zipf’s law). These properties of the infection process explain why
actual infection patterns exhibit enormously large variations. Furthermore, the mean value of the
number infected provided by a deterministic model is far from the median of the distribution. This
explains why any forecast or prediction based on a deterministic model will fail more often than
not.
In Part II of this report [1], we will present results of our extensive simulation study and further
analysis of the stochastic model based on the BDI process.
Keywords: Infectious disease, COVID-19, Forecast and prediction, Stochastic model, Deterministic model, Kermack-McKendrick’s SIR model, Basic and effective reproduction numbers, Birthand-death process with immigration (BDI), Probability generating function (PGF), Partial differential equation (PDE), Negative binomial distribution (NBD), Coefficient of variation (CV),
Compound Poisson process, Fisher’s logarithmic distribution.

Contents
1 Introduction

3

2 A Brief Review of SIR Deterministic Model

4

3 A Stochastic Model for an Infectious Disease
6
3.1 Formulation for the time-dependent solution for the stochastic model . . . . . . . . . 6
3.2 Stochastic means of the infected process I(t) and related processes . . . . . . . . . . 8
3.3 Steady-state distribution of the I(t) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
4 Time-Dependent Probability Distribution of the Infected Process I(t)
12
4.1 When the system is initially empty, i.e., I(0) = 0 . . . . . . . . . . . . . . . . . . . . 13
4.2 The process I(t) with an arbitrary initial condition . . . . . . . . . . . . . . . . . . . 14
5 Important Properties of the Negative Binomial Distribution (NBD)
5.1 Coefficient-of-variation of an NBD with small r . . . . . . . . . . . . . . . . . . . .
5.2 Relation between the NBD and “generalized” binomial distributions . . . . . . . .
5.3 The NBD as a Compound Poisson Distribution . . . . . . . . . . . . . . . . . . . .
5.3.1 Birth-and-immigration (BI) process . . . . . . . . . . . . . . . . . . . . . .
5.3.2 Birth-and-death with immigration (BDI) process as a compound Poisson process . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

.
.
.
.

14
14
17
18
18

. 20

6 Concluding Remarks

21

A Derivation of PGF (46)

22

Acknowledgments

24

Copyright c Hisashi Kobayashi 2020

2

1

Introduction

Most of the mathematical models of infectious diseases seem to be based on the Kermack-McKendrick
model published in 1927 [2], which was proposed to explain the rapid rise and fall in the number
of infected population observed in epidemics such as the great plague in London where more than
15% of the population died (1665-66); and the cholera outbreak in London caused by contamination
in the Thames River (1865), and the plague epidemic in Bombay (1906) [3]. The model consists
of a system of three coupled nonlinear ordinary differential equations for the infected population
I(t), the susceptible population S(t), and the recovered population R(t). Kermack-McKendrick’s
SIR model is a deterministic model, which provides the expected values of these processes,
which we denote as S(t)(= E[S(t)], I(t)(= E[I(t)] and R(t)(= E[R(t)]). A majority of biological
and epidemiological models [4, 5, 6] fall in this class of deterministic models.
Actual observed data of the infected population, for instance, is merely an instance or a sample
path of this stochastic process I(t). The process naturally deviates from the expected value
I(t) obtained by a deterministic model. Thus, a deterministic model alone fails to provide any
quantitative explanation when observed data differ significantly from the expected value.
In a stochastic (or probabilistic) model, on the other hand, the intrinsic stochastic nature
of a process is explicitly taken into account in its model formulation. The importance of stochastic
processes in relation to problems of population growth was pointed out by W. Feller in 1939 [7]. He
considered the birth-and-death process in which the expected birth and death rates (per person
per unit time) were constants, say, λ and µ. D. G. Kendall [8] extended Feller’s birth-and-death
(BD) process by considering the birth and death rates as any specified functions of the time t,
λ(t) and µ(t). The BD process is a special class of time-continuous discrete-state Markov process,
and has found applications in many scientific and engineering fields, including population biology
[9], teletraffic and queueing theory [10], [11], [12], system modeling [13][14], pp. 63-94, [15], pp.
407-410.
I have done some investigation, with help from Prof. Hideaki Takagi, whose unpublished lecture
note at the University of Tsukuba [16] provided me with several references, as to who coined
the term “birth-and-death process with immigration,” and have found the English statistician
M.S. Bartlett (1910-2002) in his famous book “An Introduction to Stochastic Processes” [17] (1st
edition in 1955) in his discussion of the birth-and-death process in “Section 3.4 Multiplicative chain:
subsection 3.4.1 “The effect of immigration,”that he uses the phrase ”a birth-death-and-immigration
process.” But Bartlett’s doctoral student, David G. Kendall (1918-2007) gives a detailed analysis
of the BDI process in his 1949 article [18], which Bartlett refers to in his 1949 article [19]. So my
tentative conclusion was that Kendall was the first that worked on the BDI although he did not
use the term “birth-death-immigration” or something to that effect.
Another English statistician, Norman T. J. Bailey published in 1964 “The Elements of Stochastic Process with Applications to the Natural Sciences,” [20], and in “Section 8.7: The effect of
immigration” (pp. 97-101), he gives a thorough treatment of the BDI process. Linda J. S. Allen,
“An Introduction to Stochastic Processes with Applications to Biology,” (2nd Edition, 2011) [21]
discusses the BDI process in Section 6.4.4: Simple Birth and Death with Immigration (pp. 254258), but her focus seems to be more on the stable case. Frank P. Kelly [12] gives a brief treatment,
providing the steady-state distribution. All other numerous textbooks on random processes make
no mention of the BDI process, and even the above handful of authors who might have had epidemiologists in mind among their readership seem to treat the BDI process for its possible application
to population biology, and none allude to its use in epidemiology.
Copyright c Hisashi Kobayashi 2020

3

2

A Brief Review of SIR Deterministic Model

As stated earlier, a majority of mathematical models reported in the literature on infectious diseases
have been deterministic models, following the pioneering work of almost a century ago by W.G.
Kermack and A.G. McKendrick [2] 1 . They assumed
1. At any time t, an individual is either susceptible (S ), infected and infectious (I ) or recovered
and immune (R).
2. Only susceptible individuals can get infected, remain infectious for some time, and recover
and become completely immune.
3. There are no births, deaths, immigration or emigration during the study period. In other
words, the community is closed.
Consequently, individuals can only make two types of transitions: (i) from S to I, and (ii) from I
to R. Thus, the Kermack-Mckendrick model is often referred to as an SIR epidemic model. A model
which assumes no immunity (i.e., a recovered person becomes immediately susceptible) is called an
SIS model. If we explicitly consider an exposed state, during which an infected individual is not yet
infectious, the model is called an SEIR model. A model in which immunity wanes after some period
is called an SIRS model, and so forth. In the remainder of this section we give a brief account of
the SIR model in a closed community so that the reader can compare this deterministic model to
our stochastic model to be presented in the next section. For details of the Kermack-McKedrick
type deterministic models, the readers are referred to abundant books and articles; Anderson and
May, [5], Martcheva [6] to name just a few.
Let S(t), I(t) and R(t), respectively2 , denote the number of the susceptible, infected and recovered at time t. Since we assume no births, deaths, immigration nor emigration, we have
S(t) + I(t) + R(t) = N, for all t ≥ 0,

(1)

where N is a constant number, representing the population of the community.
From the set of assumptions stated above, the deterministic processes can be defined by the
following set of three differential equations:
dS(t)
= −βS(t)I(t),
dt
dI(t)
= βS(t)I(t) − µI(t),
dt
dR(t)
= µI(t).
dt

(2)
(3)
(4)

These differential equations, together with (1) and the initial condition
I(0) = I0 , and R(0) = 0,

(5)

1

William Ogilvy Kermack (1898-1970) was a Scottish biochemist and Anderson Gray McKendrick (1876-1943)
was a Scottish military physician and epidemiologist.
2
We adopt this notation to distinguish them from S(t), I(t) and R(t) which are stochastic processes, as used in
other parts of this article. The time functions used in deterministic models usually correspond to the expectation or
stochastic mean of the corresponding stochastic processes.

Copyright c Hisashi Kobayashi 2020

4

define the deterministic model. It is easy to see that S(t) is monotone decreasing, and R(t) is
monotone increasing. The function I(t) increases or decreases at time t, depending on whether the
ratio Rt defined by the following expression is greater or smaller than unity.
Rt =

βS(t)
βS(0)
≤
= R0
µ
µ

(6)

Its initial value R0 is referred to as the basic reproduction number , a term having its origin
in demography. The ratio Rt is called the effective reproduction number. or the real-time
reproduction number and is more meaningful than R0 , which is a static number, in estimating
the current epidemic situation and making a decision to control the epidemic.
The term βS(t)I(t) in (2) and (3) comes from the argument that the susceptible must have
contact with the infected in order to get infected, and if we assume some sort of uniform mixing, the
infections should occur at a rate proportional to S(t)I(t). Consequently, the unit of the parameter β
is [person/unit-time/person·person], whereas the other parameter 3 µ has the unit of [person/unittime/person].
When the total population N of (1) is sufficiently large, S(t) ≈ N is much larger than I(t) and
can be treated as unchanged, at least in the initial phase of an epidemic. Then by setting
λ ≈ βS(t) ≈ βS(0) [person/unit-time · person],

(7)

and by substituting this into (3), we have the following ordinary differential equation (ODE):
dI(t)
= (λ − µ)I(t),
dt

(8)

from which and the initial condition (5), we readily find the solution for I(t):
I(t) = I0 eat , t ≥ 0, where a = λ − µ.

(9)

which is an exponentially growing or decaying function, depending on whether a > 0 or a < 0.
When a = 0, it is a constant I0 for all t ≥ 0.
When the infected I(t) grows to the extent that the approximation (7) no longer holds, i.e., the
“infinite population” assumption fails, we have to deal with the nonlinear differential equations of
(2) and (3). A major advantage of the SIR model is that because of the product term S(t)I(t),
the differential equations take into account explicitly the fact that occurrences of infections will
gradually decreases towards to zero as the susceptible population becomes extinct towards the
end of the infection processes. The main drawback of the SIR model, on the other hand, is its
inability to capture any probabilistic fluctuation of the infection process. The SIR model may
be an appropriate model in describing the interactions between the susceptible group and infected
group in a closed environment, such as a hospital, retirement home, cruise ship, night club, etc. But
it is a poor model in describing a major outbreak of an epidemic in a larger environment such as a
city or a country, where most infections take place independently and randomly, and the product
term βS(t)I(t) does not have any significant meaning. Furthermore, the product term makes the
entire SIR model a nonlinear system, and makes the system mathematically intractable, except for
a few simple cases, which may not be useful in reality.
3

Another Greek letter γ is often used for the recovery rate, but we use µ to be consistent with our notation in the
next section.

Copyright c Hisashi Kobayashi 2020

5

As we will show in this article and Part II [1], the deterministic model, in addition to being
unable to describe the stochastic fluctuation of an epidemic pattern, is more likely to grossly
overestimate the number of casualties. Thus, the deterministic model is not only limited in its
applicability, but can be damaging and harmful in some cases.

3

A Stochastic Model for an Infectious Disease

In this and following sections we will discuss our stochastic model based on the birth-and-beath
with immigration (BDI) process. It is a special case of general birth-and-death (BD) process4 .
Before we present a detailed mathematical analysis of this model, we will show an example of our
simulation model based on the BDI process. Figure 1 shows the first 6 out of a total of 12 simulation
runs consecutively done in one execution of our simulation program in a MATLAB script. Our
simulator is based on the event scheduling approach 5 , where events are arrivals of infected persons
from the outside (at rate ν persons/day), occurrences of secondary infections within the community
(at rate λ infections/day/infectious person), and recovery/deaths of the infected persons (at rate
µ recovery/death/day/infected person). The parameter values of λ = 0.3, µ = 0.1 and ν = 0.2 are
assumed. Figure 2 plots the same set of curves in a semilog scale. The exponential growth curves
are shown as straight-lines; the initial part of the simulation is more clearly shown in the semilog
scale. Figures 3 and 4 are the plots of the remaining six runs.
There are at least two questions concerning these simulation runs.
1. Why are the variations among different simulation runs so large?
2. There are more runs whose plots are below the deterministic model curve. Does the deterministic model tend to overestimate the size of the infected population? If so, why?
The analysis of the BDI process in the following sections should be able to answer these questions.

3.1

Formulation for the time-dependent solution for the stochastic model

Let I(t) represent the number of infected persons at time t, and Pn (t) be the time-dependent (or
transient) probability mass function (PMF)6 of the process I(t), i.e.,
Pn (t) = Pr[I(t) = n], n = 0, 1, 2, · · · , and t ≥ 0.

(10)

We assume that each infected person is infectious, and infects susceptible persons at rate λ
[persons/unit-time/person], where the time unit can be arbitrary, e.g., a second, an hour, a day,
etc. Let us assume that an infected person recovers, gets removed or dies at rate µ/[unit-time].
Thus, µ−1 [unit-time] is the mean infectious period. The ratio λ/µ is equal to the basic reproduction
4
William (Willy) Feller introduced what is now known as the “birth-and-death” process in his 1939 article [7]
published in German regarding the problem of population growth. He used the term “Vermehrung” (reproduction)
and “Tod” (death). David. G. Kendall in his 1948 paper [8] referred to Feller’s model as a “birth-and-death” process.
Feller used this term in his Volume I [9], whose first edition was in 1950.
5
The time-asynchronous event scheduling approach is a more time efficient and accurate simulation method than
a time-synchronous approach. See e.g., [13] pp. 230-234, or [14], pp. 626-630.
6
We could use perhaps a more common term the probability distribution function but PMF is more explicit that
we are dealing with a discrete distribution, not a continuous distribution.

Copyright c Hisashi Kobayashi 2020

6

number, i.e., the mean number of infections caused by an infected person during the infectious
period.
We can formulate an infectious disease as a birth-and-death (BD) process, by defining the birth
and death rates both of which are simple linear functions of the state n of the process I(t):
λn = nλ + ν,
µn = nµ,

(11)

A few remarks are in order. This particular state-dependent BD process is also known as the “birthdeath-immigration (BDI)” process (see e.g.,[12], p. 14 for the steady state distribution), in which
the parameters λ, µ and ν represent the birth (i.e., secondary infection), death (i.e., recovery or
death) and immigration (i.e., arrival of an infected individual from outside) rates, respectively.
A few remarks are in order.
1. In actuality, “recovery,” “removal” and “death” are distinctly different matters. In analyzing
the infection process, however, these three sources of loss from the susceptible or infected
population, are mathematically equivalent in the sense they will not contribute to the infection
process in the future. We assume here that those who have recovered from the disease have
acquired immunity and will not be susceptible nor infectious.
The assumption that each infected individual recovers (or is removed or dies) at rate µ
is equivalent to assuming that the duration S that each sick person remains infectious is
exponentially distributed with mean 1/µ, that is:
Pr[S ≤ s] = 1 − e−µs , s ≥ 0.

(12)

2. It can be shown mathematically that many of our results to be obtained in terms of the
probability mass function (PMF) of I(t), and other related quantities are insensitive to the
−1
actual distribution of S . All that matters is that we set µ = S , where S = E[S].
3. In the present paper, we assume that the population is homogeneous, and the susceptible
population size remains sufficiently large, thus mathematically treated as “infinite.” Furthermore, the parameters λ, µ and ν are assumed to be constant. Many of our results can be
extended to the case of multiple types of populations (e.g., clustering of infections): a model
with the susceptible population decreases as some of them get infected; and the case where the
model parameters’ values change (e.g., the situation where the infectious rate λ may change
as people’s behavior changes), and these generalized models will be discussed in subsequent
reports.
We can show (see e.g.,[15], pp.407-408) that the PMF (10) of this BD process should satisfy
the following set of linear differential-difference equations, a.k.a. Kolmogorov’s forward equation:
dP0 (t)
= −νP0 (t) + µP1 (t)
dt
dPn (t)
= ((n − 1)λ + ν) Pn−1 (t) − (n(λ + µ) + ν) Pn (t) + (n + 1)µPn+1 (t), n = 1, 2, 3 · · ·
dt

(13)

with the initial condition
I(0) = I0 , i.e., Pn (0) = δn,I0 , n = 0, 1, 2, · · · ,
Copyright c Hisashi Kobayashi 2020

(14)
7

where δm,n is Kronecker’s delta.
We transform the above set of infinitely many equations (13) into a single equation by using
the probability generating function (PGF) (see e.g.,[15], p. 402) defined by
G(z, t) = E[z

I(t)

]=

∞
X

z n Pn (t).

(15)

n=0

Multiply the set of equations (13) by z n and sum them from n = 0 to ∞, obtaining the following
partial differential equation:


∂G(z, t)
∂G(z, t)
= (z − 1) (λz − µ)
+ νG(z, t) ,
∂t
∂z

(16)

with the boundary condition
G(z, 0) = z I0 .

3.2

(17)

Stochastic means of the infected process I(t) and related processes

Although the process I(t) is the main focus of our analysis, it will be worthwhile to introduce
related processes and our assumptions.
Definition 1.
1. The process A(t) is the cumulative count of external arrivals of infectious individuals from
the outside. We assume that A(t) is a Poisson process with rate ν [persons/unit time],
2. The process B(t) is the cumulative count of internally infected individuals. We assume that
the birth of such persons occurs at the rate of λ [persons/unit time/infectious person].
3. The process R(t) is the cumulative count of recovered/removed or dead individuals. We assume
that the departure of such persons occurs at the rate of µ [persons/unit time/infected person].
Note that all infected persons are infectious persons until their recovery/removal/death.
4. The process I(t) is the present number of infected persons, i.e.,
I(t) = I(0) + A(t) + B(t) − R(t).

(18)


The expectation and variance of the above processes will be of our interest, which we denote by
A(t) = E[A(t)], B(t) = E[B(t)], R(t) = E[R(t)], and I(t) = E[I(t)],
2
σA
(t)

2

= E[(A(t) − A(t)) ], etc.

(19)
(20)

Before we discuss how to find the PGF G(z, t) from the PDE (16), let us derive first an ordinary
differential equation for I(t). By dividing both sides of (16) by (z − 1)G(z, t), we will have
(z − 1)−1

∂ ln G(z, t)
∂ ln G(z, t)
= (λz − µ)
+ ν.
∂t
∂z

Copyright c Hisashi Kobayashi 2020

(21)

8

By setting z = 1, we find7
dI(t)
= (λ − µ)I(t) + ν.
dt

(22)

where, on the LHS8 , we first set z = 1 (which corresponds to differentiation at z = 1), and use
L’Hôpital’s rule, obtaining 9 E[I(t)] = I(t). The ordinary differential equation (22) can be solved,
yielding
I(t) = I0 eat +


ν at
e − 1 , t ≥ 0, where I0 = I(0) and a = λ − µ.
a

(23)

If the model parameters are set to new values, say, to λ0 , µ0 and ν 0 at some point t = t1 ≥ 0, then
the solution I(t) for t ≥ t1 is given by
a0 (t−t1 )

I(t) = I1 e


ν 0  a0 (t−t1 )
+ 0 e
−1 ,
a

t ≥ t1 ,

where I1 = I(t1 ), a0 = λ0 − µ0 .

(24)

It should be clear that I(t) diverges to infinity, if a > 0 in (23) and converges to ν/|a| in the limit
t → ∞ if a < 0. Similarly, in (24), the process converges to ν 0 /|a0 |, if a0 < 0.
If a = 0, then10
I(t) = I0 + νt = I0 + A(t) t ≥ 0, when a = 0.

(25)

In Figure 5 we show the case where λ = 0.3, µ = 0.1 and ν = 0.2 and at t1 = 30, a new
parameter λ0 = 0.06 is set, whereas the original values of µ and ν are retained.
The mean values of other processes can be easily found. A(t) is a Poisson process with rate ν,
which implies
A(t) = νt, for all t ≥ 0.

(26)

Since each person in the infected population I(t) infects others at the rate of λ persons/unit time,
the differential of B(t) is given by
dB(t)
= λI(t).
dt
From this and (23) we obtain
Z t
λI0 (eat − 1) λν(eat − 1) λνt
B(t) = λ
I(u) du =
+
−
a
a2
a
0
λ
= (I(t) − I0 − A(t)), 0 ≤ t ≤ t1 .
a

(27)

(28)

7

Alternatively, we can obtain this differential equation directly, by multiplying each equation in (13) by n and
summing them up from n = 0 to infinity.
8
The abbreviations LHS and RHS mean the left-hand side and right-hand side, respectively.
9
Here we use an important property of PGF, i.e, ∂G(z,t)
= E[I(t)z I(t)−1 ], and by setting z = 1, the RHS becomes
∂t
E[I(t)]. We changed the order of differentiation w.r.r. to z and t, which can be justified because the function G(z, t)
is an analytic function, i.e., it is continuous and differentiable everywhere.
10
The second term becomes 0/0, so we apply L’Hôpital’s rule.

Copyright c Hisashi Kobayashi 2020

9

For t ≥ t1 , we find
0

λ0 I1 (ea (t−t1 ) − 1) λ0 ν 0 (t − t1 ) λ0 ν 0 (ea(t−t1 ) − 1)
−
B(t) = B(t1 ) +
+
a0
a
a2


0
0
ν
λ
0
0
= 0 I1 ea (t−t1 ) + 0 (ea (t−t1 ) − 1) − I0 − ν 0 t
a
a
λ0
0
0
= 0 (I(t) − I0 − A (t)), where A (t) = ν 0 t,
a

(29)

which takes the same form as that for t ≤ t1 . It should be worthwhile to note that both (28) and
(29) could be derived from the mean value of the identity equation (18) together with the relation
R(t) = µλ B(t), which is evident as shown below.
The recovery process R(t) should satisfy the following differential equation, similar to (27):
dR(t)
= µI(t).
dt

(30)

Thus, it readily follows:

R(t) =

µ(I(t) − I0 − A(t))/a,
0
µ0 (I(t) − I0 − A (t))/a0 ,

0 ≤ t ≤ t1
t ≥ t1 .

(31)

The above expressions for I(t) and other processes can be viewed as our deterministic (or
non-probabilistic) model for the dynamics of the BDI process. From these simple expressions,
we can extract a few important characteristics concerning the mean values of I(t) and others.
1. a = λ − µ determines the exponential growth or decay rate of B(t), R(t) as well as I(t).
2. ν is merely a linear scaling factor for I(t) and other processes, and so is I0 , the initial number
of the infected.11
3. If a > 0, then I(t) grows exponentially without bound; if a < 0, it decays exponentially
towards ν/|a|. If a = 0, I(t) = I0 + νt, i.e., I(t) grows linearly.
4. The ratio of the infection rate (or reproduction rate) λ to the recovery or removal rate µ
R0 =

λ
µ

(32)

is called the basic reproduction number in epidemiology (see e.g., [6], p. 21). The term was
originally defined in the context of a deterministic model called the SIS(Susceptible-InfectedSusceptible) epidemic model. It is the average number of persons whom an infectious person
infects before his/her recovery, removal, or death. The reproduction number determines
whether the infection will grow exponentially, die out, or remain constant, depending on
whether R0 > 1, R0 < 1, or R0 = 1, respectively. The exponential parameter a can be
expressed in terms of R0 and µ:
a = λ − µ = (R0 − 1)µ.
11

Eq.(23) can be rewritten as I(t) = I0 +
term eat .

ν
a



at

e

−

ν
.
a

So

ν
a

(33)

+ I0 is the multiplying coefficient of the exponential

Copyright c Hisashi Kobayashi 2020

10

5. The amount of time T that takes for I(t) or other related quantities to double, and thes
exponential growth parameter a are related by
eaT = 2, or equivalently aT ≈ 0.693.

(34)

Note that both the integral and derivatives of the exponential function eat are also ∝ eat .
Thus, the above formula for T equally applies, when cumulative numbers or incremental
numbers are to be counted for a given a via an observed T .
6. Unless we can expect to increase the value of µ by improving the medical service or producing
an effective vaccine to immunize the susceptible population, the only options we have for
controlling an infectious disease is to increase µ by removing as many infectious individuals
away from susceptible population as possible, and/or to decrease λ by increasing the socalled social distances between the susceptible and the infectious. We will provide an
illustrative example in Part II [1].
Example 1 Consider the following community: The external arrival rate of infected individuals ν = 0.2
[persons/day], i.e. one such such incidence every 5 days on average. The average number of days required
for an infected person to recover, be removed or die, is µ−1 = 10 [days], i.e., the recovery rate µ = 0.1
[per day] for each infected person. Suppose that the average number of secondary infections caused by an
infected individual is estimated as R0 = λ/µ = 3 for each infectious person. Then this value and µ provide
an estimate of the infectious rate λ = 0.3 [persons/day/infected person]. Thus, the exponential growth
parameter is estimated as a = λ − µ = 0.2 > 0. One can check the validity of the model and/or consistency
among the three estimated parameters, by computing a second estimate of the a from the formula (34). In
Part II, we will discuss various ways of estimating the model parameters.
Once we have obtained reliable model parameters, we can predict the expected value of the infected
process I(t), assuming that there was no infected person at t = 0, i.e., I(0) = I0 = 0:
I(t) =


ν  at
e − 1 = e0.2t − 1.
a

(35)

Thus, this curve predicts the expected number of the infected population, excluding those who have recovered,
been removed or have died.
I(0) = 0, I(5) = 1.7, I(10) = 15.0, I(15) = 19.1, I(20) = 53.6, I(25) = 147.4,
I(30) = 402.5, I(35) = 1, 095.5, I(40) = 2, 980.0, I(45) = 8, 102.1, I(50) = 22, 025.5.


3.3

Steady-state distribution of the I(t)

So far we have discussed only the mean values of the random process I(t) and other processes. Before we
find the probability mass functions Pn (t), n = 0, 1, 2, · · · for any t, we obtain in this section the steady-state
distribution limt→∞ Pn (t) = πn , if it exists. We know already that when a > 0, such distribution does not
exist.
Thus, the steady state distribution can possibly exist, only when a ≤ 0. In order to find it, we set the LHS
of the PDE (16) equal to zero, obtaining the following ordinary differential equation for the PGF G(z, ∞):
(λz − µ)

dG(z, ∞)
+ νG(z, ∞) = 0,
dz

Copyright c Hisashi Kobayashi 2020

(36)

11

which readily leads to
d ln G(z, ∞)
ν
=−
.
dz
λz − µ
Integrating the above and using the boundary condition G(1, t) = 1 for any t, we find
!r
1 − µλ
ν
G(z, ∞) =
, where r = .
λ
1 − µλ z

(37)

(38)

This PGF reminds us of the negative binomial distribution (NBD). This distribution was originally
introduced to express the probability of the number of failures n needed to achieve r successes in a sequnce
of Bernoulli trials, when the probability of failure is q.
Definition 2 (Negative binomial distribution (NBD)). Negative binomial distribution NB(r, q) is defined by


n+r−1
Γ(n + r)
PnN B =
(1 − q)r q n =
(1 − q)r q n , n = 0, 1, 2, · · · ,
(39)
n
n!Γ(r)
where the parameter r is a positive real number. 
When r is a positive integer, and 0 < q < 1 the above reduces to the classical definition of the (shifted)12
negative binomial distribution, sometimes called the Pascal distribution, associated with Bernoulli trials.
The Gamma function Γ(x) is defined for a positive real number x by13
Z ∞
Γ(x) =
y x−1 e−y dy, x > 0.
(40)
0

The probability generating function of NB(r, q) of (39) is given by

∞ 
X
n+r−1
1−q
G(z) =
(1 − q)r q n z n =
, |z| < q −1 .
n
1
−
qz
n=0

(41)

The mean and variance of a RV (random variable) X possessing this distribution can be readily found:
qr
qr
E[X] =
, and Var[X] =
.
(42)
1−q
(1 − q)2
From (38) and the above formula, we readily find the steady state distribution of I(t) for a < 0 is given as
follows [12],p.14.

πn = lim Pn (t) =
t→∞

4

r
  n 
λ
n+r−1
λ
1−
.
µ
µ
n

(43)

Time-Dependent Probability Distribution of the Infected Process I(t)

The partial difference equation (PDE) (16) for the PGF G(z, t) is a linear PDE and is sometimes referred
to as planar differential equation (see [22], [14], pp. 600-605). This type of PDE can be solved by using
Lagrange’s method with its auxiliary differential equations, which is discussed in Appendix A. 14
12

Some authors define the negative binomial distribution as the distribution of the number of trials, instead of the
number of failures, needed to achieve r successes. Under this definition, n = r, r + 1, r + 2, · · · . The probability
distribution (39) is then referred to as the shifted negative binomial distribution (see e.g.,[15], pp. 59-62).
13
This definition can be extended for a complex number z, with <(z) > 0.
14
It will be worth noting that Ren and Kobayashi [23], [24] discuss this type of PDE in the analysis of multiple
on-off sources in traffic characterization of a data network.

Copyright c Hisashi Kobayashi 2020

12

4.1

When the system is initially empty, i.e., I(0) = 0

When the system is initially empty, i.e., I(0) = 0, its PGF can be found by solving the PDE given by (see
(A.20) of Appendix A)
r

ν
a
, where a = λ − µ, and r = .
(44)
G(z, t) =
λeat − µ − λ(eat − µ)z
λ
If we define a function β(t)
β(t) =

λ(eat − 1)
,
λeat − µ

(45)

we can write (44) compactly as

G(z, t) =

1 − β(t)
1 − β(t)z

r
(46)

,

which is the PGF of the generalized negative binomial distribution NB(r, β(t)), defined in Definition 2. Thus,
we find that the PMF of the BDI process I(t) is given by


n+r−1
Pn (t) = Pr[I(t) = n] =
(1 − β(t))r β(t)n , n = 0, 1, 2, · · · .
(47)
n
When a = 0, the above expression can be simplified. Noting
eat − 1
= t,
a→0
a

(48)

lim

we find
β(t) =

µt
1
, and 1 − β(t) =
,
µt + 1
µt + 1

(49)

which lead to

G(z, t) =

1
1 + µt − µtz

r
,

(50)

and
Pn (t) =



r 
n
n+r−1
1
µt
.
n
µt + 1
µt + 1

(51)

The mean and variance can be computed from the distribution function obtained above. But we already
know the expression for the mean I BDI (t) from (23), which can be also found from the formula of the NB(r, q,
i.e.,
E[IBDI (t)] =

rβ(t)
ν
= (eat − 1),
1 − β(t)
α

(52)

which certainly agrees with (23). Similarly, the variance can be found from the formula of NB(r, q) as
2
σBDI
(t) =

rβ(t)
ν(λeat − µ)(eat − 1)
=
.
(1 − β(t))2
a2

(53)

The reason why this simple innocent-looking equation is put in a box is because this expression for the
variance is perhaps the most important feature behind the erratic behavior we observe in the COVID19, or an infectious disease in general, as we analyze below and demonstrate by presenting simulation results
in Part II.

Copyright c Hisashi Kobayashi 2020

13

4.2

The process I(t) with an arbitrary initial condition

Up to now, we have focused on the case when the system is initially empty. In this section, we wish to study
a general case where I(0) = I0 is an arbitrary non-negative integer. The PGF solution for this general case
is, in fact, given in (A.19) of Appendix A. In this section we will add to the PGF and PMF of this general
case a subscript or superscript BDI:I0 wherever we need to distinguish similar functions of other processes.
So we can write
GBDI:I0 (z, t) = GBDI:I0 =0 (z, t) GBD:I0 (z, t),

(54)

where
r
a
λeat − µ − λ(eat − 1)z
 at
I
µe − µ + (λ − µeat )z 0
GBD:I0 (z, t) =
,
λeat − µ − λ(eat − 1)z


GBDI:I0 =0 (z, t) =

(55)
(56)

where the first given by (55) is the same as (44) discussed in a preceding section, whereas the second one
(56) is the PGF of the birth-and-death process, obtained by setting ν = 0 in the PGF (A.19). Thus, we
see that the BDI:I0 process can be expressed as a sum of two statistically independent processes:
IBDI:I0 (t) = IBDI:I0 =0 (t) + IBD:I0 (z, t).

(57)

It can be further shown that the the birth-and-death process can be decomposed into two processes: the
the pure-birth process and a generalized binomial distributed process, denoted IGB:p(t) (t), where p(t) is
given by (87). Thus,
IBD:I0 (t) = IN B(I0 ,β(t)) (t) + IGB:I0 (t),

(58)

and the PGFs of these processes can be expressed as
GBD:I0 (z, t) = GN B(I0 ,β(t)) (z, t) GGB:I0 (z, t)

(59)

where

GN B(I0 ,β(t)) (z, t) =

1 − b(t)
1 − b(t)z

I0
(60)
I0

GGB:p(t) (z, t) = (1 − p(t) + p(z)z)

5
5.1

(61)

Important Properties of the Negative Binomial Distribution
(NBD)
Coefficient-of-variation of an NBD with small r

Let us further examine properties of a random variable X of NB(r, q) defined by its PMF (39) and PGF
(41). Its mean and variance are given in (42). The mode of the this distribution is given by
(
if r > 1
b q(r−1)
1−q c,
modeXN B =
(62)
0,
if r ≤ 1.
Recall that the parameter r in our problem is the ratio of ν [person/unit-time] (the rate with which an
infected person arrives in the community in question) to λ [person/unit-time/person] (the rate with which an

Copyright c Hisashi Kobayashi 2020

14

infectious person infects susceptible people. As long as tight security measures are enforced at the boundaries
of the community, ν is kept small. Thus, in our problem of practical interest, r < 1, or even r  1.
Figure 6 shows the (shifted) negative binomial distribution (NBD) for p = 1 − q = 0.5 and for various
values of r = 0.5, 1, 2, 4, 8, 16, 32.
As we can see in Figure 6, the PMF with r = 0.5 falls off rapidly by around n ≈ 5. For q = 0.5 and
r = 0.5, we compute the first several values of Pn :
P0 = 0.7071, P1 = 0.5303, P2 = 0.3315, P3 = 0.1934, P4 = 0.1088, P5 = 0.0598, · · · , P10 = 0.00256.
(63)
In order to see more clearly how the PMF Pn looks for small r, let us rewrite (39) as follows:
Pn = k(r)

(2 + r) (1 + r) q n
(n − 1 + r) (n − 2 + r)
···
, where k(r) = rpr .
(n − 1)
(n − 2)
2
1
n

(64)

The leading term k(r) does not depend on n. So we can write
Pn ∝

(n − 1 + r) (n − 2 + r)
(2 + r) (1 + r) q n
···
.
(n − 1)
(n − 2)
2
1
n

(65)

In the limit r → 0, the shape of Pn will become
Pn ∝

qn
.
n

(66)

q2
q3
+
+ ··· ,
2
3

(67)

Recall the following Maclaurin series expansion
− ln(1 − q) = q +
from which we obtain
∞
X

−1
qn
= 1.
ln(1 − q) n
n=1

(68)

Thus, we find (66) can be written as
Pn =

qn
1
, n = 1, 2, 3, · · · .
− ln(1 − q) n

(69)

This distribution is called the logarithmic distribution (a.k.a. logarithmic series distribution), which
was introduced by R. A. Fisher in 1943 [25]. The PGF of (69) is given, using (67) once again, by
Glog (z) =

ln(1 − qz)
.
ln(1 − q)

(70)

In our case the probability q is given by β(t) of (45):
q = β(t) =

λ(eat − 1)
, where a = λ − µ.
λeat − µ

(71)

Thus, for sufficiently large t, the parameter q is very close to one, thus the term q n is a slowly decreasing
geometric series. For small r, the coefficient is also slowly decaying. Thus, for small r and q close to 1,
the NBD is a very slowly decaying distribution. having a long tail, similar to Zipf ’s law or the zeta
distribution with small power exponent α (see e.g., [15], pp. 62-64).

Copyright c Hisashi Kobayashi 2020

15

Example 2: Consider the same set of model parameters used in Example 1, i.e., λ = 0.3, µ = 0.1 and
ν = 0.2. Then r = λν = 23 , and a = λ − µ = 0.2. In Figure 7 through Figure 12, we show the PMF Pn (t)
(47) of the infected population I(t) at t = 1, 5, 10, 20, 30 and 50. In all these cases, I0 = 0, i.e., there are no
infected individuals at t = 0.
One useful method to see clearly the tail end of the distribution function is to plot the
Pnlog-survival
function, log10 (1−Fn ), where Fn is the cumulative distribution function (CDF), i.e., Fn = i=0 Pn (t), and
its complement 1 − Fn is called the survival (or survivor) function.15 In Figure 13 and Figure 14, we show
the log-survivor functions of the distribution of I(t) at t = 10 and t = 30. We confirm our earlier observation
that the NBD behaves similar to a geometric distribution, which is a straight line in the log-survivor plot.
As we observed in Example 5.1, the PMF Pn (t) looks similar to a slowly decaying geometric distribution
for modest values of t, with a long tail, which gives a large variance. An often used measure of dispersion is
the coefficient of variation (CV). From (53) we can derive the following expression:
2

λeat − µ
I (t)
=
,
σBDI (t) = I (t)
ν(eat − 1)
rβ(t)
2

2

(72)

from which we find the CV at time t of the BDI process is given by
cBDI (t) =

σBDI (t)
1
=p
.
I(t)
rβ(t)

(73)

It is evident that β(t) quickly approaches unity from below, as t increases16
β(t) ≈ 1, for t  1, and

lim β(t) = 1.

(74)

t→∞

Thus, we have arrive at the following proposition regarding the CV of the BDI process:
Proposition 1. The coefficient of variation of the BDI process rapidly converges to a constant
for all t such that (λ − µ)t ≥ 7:
√
lim cBDI (t) =

t→∞

r−1 , where r =

√

ν
.
λ

r−1

(75)

Example 3:
Consider the environment considered in Example 3.2, i.e., ν = 0.2/day, λ = 0.3/day/infectious person,
µ = 0.1/day/infectious person. Thus, R0 = λ/mu = 3, a = λ − µ = 0.2., and r = λν = 2/3. Hence,
√
r−1 = 1.225.
The mean, variance and the standard deviation of I(t) on the days t = 30 and 50 are:
I(0) = 0,
I(30) = 402.5,
I(50) = 22, 025.5,

Var[I(0)] = 0,
Var[N (30)] = 243, 411.9,
Var[N (50)] = 727, 706, 000.9,

σI (0) = 0,
σN (30) = 493.4,
σN (50) = 26, 976.0,

So, we have confirmed that the coefficient of variation is bounded from below by

cI (0) = undefined,
cN (30) = 1.226,
cN (50) = 1.225.
√

r−1 =1.225. 

15
The term “survival (or survivor) function” is often used in reliability theory. If a continuous variable X represent
the “life” of a human, or a product (e.g., electricR bulb), with its probability density function (PDF) fX (x) and
t
cumulative distribution function (CDF) FX (x) = 0 fX (s) ds , the survival function is defined by 1 − FX (x). By
plotting log(1 − FX (x) vs. x, we find more clearly, how the remaining life will behave than a regular plot of fX (x) or
FX (x). See e.g., [15] pp. 144-146.
16
When t is such at = 7, for instance, will make β(t) within around 2% off from the unity. In our example of
a = 0.2[/day], t = 23[days] will make β(t) practically equal to unity.

Copyright c Hisashi Kobayashi 2020

16

5.2

Relation between the NBD and “generalized” binomial distributions

In the previous section we gave a formal definition of the generalized negative binomial distribution, by
allowing the parameter r to be a positive real number. We now want to generalize the binomial distribution
B(N, p), by allowing N to be a real number (positive or negative), and p be any real number, positive or
negative. Thus, we cannot assign any probabilistic interpretation.
Definition 3. Consider a generating function of z, which takes the form for real numbers, p and α.
G(z) = (1 − p + p z)α .

(76)

 
α n
fn =
p (1 − p)α−n , n = 0, 1, 2, . . .
n

(77)

Then its inverse transform

is called a generalized binomial distribution, denoted GB(n, p).
There is no guarantee that each fn non-negative, let alone 0 ≤ fn ≤ 1, However, they add up to unity,
because G(1) = 1. The main reason why we wish to generalize the binomial distribution is for the convenience
of computing Pn (t) for the BDI process and other birth-and-death processes (without immigration) discussed.
Proposition 2 (A generalized binomial distribution associated with a (generalized) negative binomial distribution). For a given (generalized) negative binomial distribution, whose PGF is given by
r

1−q
,
(78)
GN B (z) =
1 − qz
with the PMF

NB

Pn

=


r+n−1
(1 − q)r q n , n = 0, 1, 2, · · · ,
n

its associated generalized binomial distribution is given by
 
−r n
fn =
p (1 − p)−r−n
n

(79)

(80)

where p and q satisfy the relation
(1 − p)(1 − q) = 1, or p = −

q
.
1−q

Proof. First we compare the generalized binomial coefficients
 
−r
(−r)(−r − 1) · · · (−r − n + 2)(−r − n + 1)
=
n
n!


(r + n − 1)(r + n − 2) · · · (r + 1)r(−1)n
r+n−1
=
= (−1)n
n!
n

(81)

(82)

We also find
n

−r−n

p (1 − p)


=

−q
1−q

n

(1 − q)r+n = (−1)n q n (1 − q)r

(83)

Thus, we have shown the equivalence between (79) and (80).

Copyright c Hisashi Kobayashi 2020

17

An alternative way to prove this equivalence is to write the PGF (78) using p. defined by (81):

r
1−q
= (1 − p + p z)−r .
1 − qz
Recall Newton’s generalized binomial formula:
 
 
∞  
X
a
a 2
a j
(1 + t)a = 1 +
t+
t + ··· =
t .
1
2
j
j=0
Apply this formula to the RHS of (84), by setting a = −r and t =
given by fn of (77) 

pz
1−p .

(84)

(85)

The coefficient of the z n term is

Now let us revisit the PGF (44), which we can write as
G(z, t) = (1 − p(t) + p(t) z)−r ,

(86)

where
p(t) = −

λeat − µ
.
a

(87)

By referring to Proposition 2 we find that p(t) and β(t) are related by
p(t) = −

β(t)
.
1 − β(t)

Thus, by applying Newton’s formula, we can obtain the following expression for Pn (t):
 
−r
Pn (t) =
(1 − p(t))n p(t)−r−n , n = 0, 1, 2, · · · .
n

(88)

(89)

Using the binomial coefficient formula and the equivalence (83), i.e.,
pn (1 − p)−r−n = (−1)n β n (1 − β)r ,

(90)

we see that Pn (t) given by (89) is equivalent to (47).

5.3

The NBD as a Compound Poisson Distribution

In this section we will investigate how to represent the BDI process IBDI (t) as a compound Poisson process.
The negative binomial distribution is infinitely divisible (see e.g., Feller [9]), and hence can be represented
as a compound Poisson process. First we show this representation by considering a special case of the BDI
process where no death occurs.

5.3.1

Birth-and-immigration (BI) process

Let us consider a process which has not been discussed, to the best of our knowledge, in the literature. That
is, the pure birth process, accompanied by immigration. Let us call this process a birth-and-immigration
process, a BI process for short.
The PGF of this process can be readily found by setting µ = 0 in (A.19), and after some manipulation,
we obtain
r 
I0

r+I0

z
1 − β0 (t)
1
I0
=z
,
(91)
GBI (z, t) =
eλt − (eλt − 1)z
eλt − (eλt − 1)z
1 − β0 (t)z

Copyright c Hisashi Kobayashi 2020

18

where
β0 (t) = 1 − e−λt .

(92)

Not surprisingly, this β0 (t) can be obtained by setting µ = 0 in β(t) of (45). Thus, the BI process IBI (t) is
distributed according to the negative binomial distribution NB(r + I0 , β0 (t)) shifted by I0 . Hence, we find
the PMF at time t as given below:


n−I0
n − I0 + r − 1
PnBI (t) = e−(r+I0 )λt
1 − e−λt
, n = I0 , I0 + 1, I0 + 2, · · · .
(93)
n − I0
If, I0 = 0, the PMF reduces to NB(r, β0 (t)). By noting rλ = ν, we find the first few PMF values as follows:
P0BI:0 (t) = e−νt ,

P1BI:0 (t) = e−νt r 1 − e−λt ,
2
(r + 1)
1 − e−λt ,
2!
3
BI:0
−νt (r + 2)(r + 1)
P3 (t) = e r
1 − e−λt ,
3!
P2BI:0 (t) = e−νt r

where P0BI:0 (t) represents the idle period of the system which ends upon the Poisson arrival. This initial
idle period is the only time when the system is empty. Since there is no death or departure of any kind, the
population monotonically increases as the time elapses.
As we defined in Definition 1 of Section 3.2, A(t) is the cumulative count of infected and infectious
persons, arriving from the outside up to time t. Let us count them as c = 1, 2, · · · , A(t). Consider a
“countable attribute” associated with each arrival and denote it Nc . Assume that the Nc ’s are independent
identically distributed (i.i.d.) RVs. Kobayashi and Konheim [26] discuss use of acompound process in the
context of data communication system, where each arrival of a data packet carries Nc [data units], e.g.,
[bytes]. Then, the sum
A(t)

S(t) =

X

Nc

(94)

c=1

should be a quantity of interest in determining, e.g., the buffer size of a statistical multiplexer needed to
keep the probability of buffer overflow below some prescribed level.
In our problem at hand, each infected arrival from the outside becomes an “ancestor” who produces
many “descendants” over multiple generations, who are all “infected” persons and constitute the members
of the “c clan.” Such a process is called a branching process. In our model, each infected individual,
whether an ancestor or a descendant, produces a new descendant at rate λ [person/unit-time].
Let Aj (t) be the number of arrivals in (0, t] and having j descendants at time t. The case j = 0 does
not exist, since there is no death, hence each clan includes at least its ancestor, such that
∞
X

Aj (t) = A(t), t ≥ 0.

(95)

j=1

Branson [27], who ascribes the original idea to Karin and McGregor [28], shows that the RVs Aj (t)’s are
independent Poisson variables with mean mj (t) where
mj (t) = E[Aj (t)] =

ν ξj
,
λ j

(96)

where ξ is a function of λ and t.

Copyright c Hisashi Kobayashi 2020

19

The above formula (96) leads to the idea that the probability distribution that each ancestor should
produce j descendants (i.e., secondary, tertiary infectees, etc.) whose probability distribution takes the form
Pr[Nc (t) = j] = PjNc (t) ∝

β0 (t)j
, j ≥ 1.
j

(97)

This distribution is the logarithmic distribution of (69). The PGF of Nc (t) is therefore given by
GNc (z) =

ln(1 − β0 (t) z)
ln(1 − (1 − e−λt )z)
=
ln(1 − β0 (t))
−λt

(98)

Note that Nc (t) is the number of the family members at time t of the cth clan, with the ancestor itself
included. Since we are assuming no death, the sum of these numbers over all A(t) ancestors should be the
total population I(t) at time t:
A(t)

I(t) =

X

Nc (t).

(99)

c=1

Then, the PGF of I(t) can be expressed as
h
i
h PA(t)
i
h
h
i
A(t) i
A(t)
G(z, t) = E z I(t) = E z c=1 Nc (t) = E E[z Nc ]
= E (GNc (z, t))
= GA (GNc (z))

(100)

The PGF of the Poisson arrival process of rate ν is given by
GA (z, t) = exp(νt(z − 1)).
Thus, we find the PGF of the BI process, a compound Poisson process, is

 
ln(1 − β0 (t))
−1
G(z, t) = GA (GNc (z)) = exp νt
ln(1 − β0 (t) z)

r
1 − β0 (t)
ν
=
, where r = ,
1 − β0 (t) z
λ

(101)

(102)

which is the PGF (91), where I0 = 0. Thus, we have shown that the Poisson process with rate ν ends up
with the negative binomial distributed process NB(r, β0 (t)). It is interesting that the infection process which
forms a branching process where an infectious person infects a susceptible person at rate λ [persons/time
unit] will result in the negative binomial distribution. The positive feedback loop of creating its descendants
exhibits the negative binomial distributed process.

5.3.2

Birth-and-death with immigration (BDI) process as a compound Poisson process

Now we extend our argument of the previous section to the BDI process with the initial condition I0 = 0,
whose PGF is given by (44).

r
1 − β(t)
G(z, t) =
,
(103)
1 − β(t)z
where β(t) is defined by (45):
β(t) =

λ(eat − 1)
.
λeat − µ

Copyright c Hisashi Kobayashi 2020

(104)

20

The first few PMF values can be found from (47) as
P0BDI:0 (t) = B(t), where B(t) = (1 − β(t))r =



a
at
λe − µ

r
,

P1BDI:0 (t) = B(t)rβ(t),
(r + 1)
β(t)2 ,
2!
(r + 2)(r + 1)
P3BDI:0 (t) = B(t)r
β(t)3 .
3!
P2BDI:0 (t) = B(t)r

(105)

The function β(t) is between 0 and 1, and approaches 1 as t → ∞. If ν → 0, then r → 0 as well and
B(t) → 1. Since B(t)r does not depend on n, we see again the Fisher series:
Pr[Nc (t) = j] = PjNc (t) ∝

β(t)j
, j ≥ 1.
j

(106)

at

−1)
Then by replacing β0 (t) = 1 − e−λt by β(t) = λ(e
λeat −µ the entire mathematical steps of the BI process case
carry over to the case of the BDI process, except for the last step (102), where the parameter r needs to be
defined as

−νt

r=
ln



λ−µ
λeat −µ

.

(107)

If a = λ − µ > 0, then for t  1, the following approximation holds
r≈

ν λ
−νt
=
.
−at
λλ−µ

(108)

Therefore, it seems clear that we need to to choose a Poisson process other than the one with mean νt. Let
ν(t) be the mean of the Poisson process which is to be compounded with Nc (t) whose PGF is

r
1 − β(t)
GBDI:0 (t) =
.
(109)
1 − β(t) z
Then it should be clear from the above discussion that ν(t) must be given by
r

r
 at
λ − µe−at
λe − µ
= exp(art)
exp(ν(t)) =
λ−µ
λ−µ


−at r
λ − µe
= exp(νt)
.
λ−µ

(110)

Thus,

ν(t) = νt + r ln

λ − µe−at
λ−µ


.

(111)

Thus, we have shown that the BDI process as a compound Poisson process with rate ν(t).

6

Concluding Remarks

At the beginning of Section 3 we showed the results of twelve simulation runs of the BDI process to provoke
the reader’s interest. Hopefully you have found an answer to the first question. How about the second
question? If you are an avid reader, you should have figured out the answer by now. In Part II of this report

Copyright c Hisashi Kobayashi 2020

21

under preparation [1], we will present more simulation results, which should help the reader find a definitive
answer to the second question.
In this report, we focused on the analysis of I(t), the infected population. Although we presented
the stochastic means of B(t) (the population of the secondary infections) and R(t) (the recovered/dead
population), we defer a full analysis of these processes to Part II.
We will also show, both by analysis and simulation, how the infection process can be controlled by
changing the values of λ, µ and ν at certain points in time. Increasing the so-called social distance would
decrease the value of λ. The value of µ can be increased by improving medical treatments to speed up the
recovery process. Another possible option is to reduce the size of the susceptible population significantly by
exposing the young and healthy susceptible to the disease so that they become immune to the disease. The
quantitative model such as ours should help policy makers and health officials to make judicious choices of
these options by assessing the effects and costs of various options available to them. In Part II (or III), we
will also discuss how we should estimate the model parameters from empirical data so that the forecast can
be made as reliable as possible.

A

Derivation of PGF (46)

The partial differential equation (PDE) (15) can be solved for PGF G(z, t) by Lagrange’s method with
auxiliary differential equations. We write (15) in the following form of a planar differential equation (see
e.g., [22], [24], [23], [14], pp. 600-603):
p

∂G
∂G
+q
= r,
∂t
∂z

(A.1)

where G denotes G(z, t) defined above, and p, q and r are, in general, functions of t, z, and G.
The solution G = f (t, z) represents a surface in the t − z − G space. The normal vector to the surface at
any point (t0 , z0 , G0 ) is perpendicular to the line through this point, whose direction numbers are the values
of p, q and r evaluated at this point, which we denote by p0 , q0 and G0 . This line has the equations
t − t0
z − z0
G − G0
=
=
.
p0
q0
r0

(A.2)

Hence, at each point (p, q, G) of the surface, there is a normal vector whose direction numbers, dt, dz and
dG, satisfy the following equation:
dz
dG
dt
=
=
.
p
q
r

(A.3)

In our problem at hand, we set
p = 1,

(A.4)

q = −(λz − µ)(z − 1),

(A.5)

r = ν(z − 1)G,

(A.6)

Then (A.3) becomes
dt
dz
dG(z, t)
=−
=
.
1
(λz − µ)(z − 1)
ν(z − 1)G(z, t)
which leads to the following two independent solutions:


z−1
eat = C1 , where a = λ − µ,
µ − λz

Copyright c Hisashi Kobayashi 2020

(A.7)

(A.8)

22

and
ν
(A.9)
λ
where C1 and C2 are integration constants. We write the functional relations between C1 and C2 as
G(z, t)(µ − λz)r = C2 , where r =

C2 = f (C1 ), ,

(A.10)

which, together with (A.7), implies the following general solution:

 
z−1
G(z, t) = (µ − λz)−r f
eλt .
µ − λz

(A.11)

From the initial condition (17), we find
−r

G(z, 0) = (µ − λz)


f

z−1
µ − λz



= z I0 .

(A.12)

from which we find

f

z−1
µ − λz



= z I0 (µ − λz)r .

(A.13)

We introduce a new variable y by
z−1
1 + µy
= y, i.e., z =
.
µ − λz
1 + λy
From the last two equations, we can determine the functional form of f :

I 
r
1 + µy 0 µ − λ
f (y) =
.
1 + λy
1 + λy
By substituting the last equation into (A.11), we obtain

 
z−1
G(z, t) = (µ − λz)−r f
eat
µ − λz

(A.14)

(A.15)

(A.16)

By noting
µ − λz + µ(z − 1)eat
1 + µy
=
1+λ
µ − λz + λ(z − 1)eat

(A.17)

µ−λ
(µ − λ)(µ − λz)
=
1 + λy
µ − λz + λ(z − 1)eat

(A.18)

and

we finally obtain the PGF of I(t)
r 
I
(µ − λ)(µ − λz)
µ − λz + µ(z − 1)eat 0
µ − λz + λ(z − 1)eat
µ − λz + λ(z − 1)eat

r 
I
µ−λ
µ − λz + µ(z − 1)eat 0
=
µ − λz + λ(z − 1)eat
µ − λz + λ(z − 1)eat

G(z, t) = (µ − λz)−r



(A.19)
Note that the PGF is given as a product of two PGFs, the second being the PGF of the birth-and-death
process without immigration.
If I0 = 0, i.e., if the system is initially empty, the above PGF reduces to
r

a
, when I(0) = I0 = 0.
(A.20)
G(z, t) =
λeat − µ − λ(eat − 1) z

Copyright c Hisashi Kobayashi 2020

23

Acknowledgments
I thank Prof. Brian L. Mark of George Mason University for his valuable suggestions and help during
the course of this study. He has read this manuscript carefully and made numerous editorial suggestions.
Were it not for his patient help, I would have taken a lot more time in debugging my MATLAB simulation
programs. Prof. Hideaki Takagi of the University of Tsukuba kindly shared with me his unpublished lecture
note on the birth-and-death processes [16]. My excitement of having obtained a closed form solution of the
time-dependent PMF of the BDI process was short lived, when he showed me his lecture note and informed
me of the existence of the book by Bailey [20]. Dr. Linda Zeger read the first draft of this report and gave
me valuable suggestions to improve the presentation.

References
[1] H. Kobayashi, “Stochastic Modeling of an Infectious Disease: Part II: Validation by Simulation Experiments (under preparation).” http://hp.hisashikobayashi.com, 2020.
[2] W. O. Kermack and A. G. McKendrick, “A Contribution to the Mathematical Theory of Epidemics,”
Proc. Royal Soc. London, vol. A 115, pp. 700–721, 1927.
[3] N. Bacaër, “The model of Kermack and McKendrick for the plague epidemic in Bombay and the type
reproduction number with seasonality,” Journals of Mathematical Biology, vol. 64, pp. 403–422, March
2012.
[4] R. M. Anderson and R. M. May, “Population Biology of Infectious Diseases: Part I,” Nature, vol. 280,
pp. 361–367, August 1979.
[5] R. M. Anderson and R. M. May, Infectious Diseases of Humans: Dynamics and Control. Oxford
University Press, 1991.
[6] M. Martcheva, An Introduction to Mathematical Epidemiology. Springer, 2010.
[7] W. Feller, “Die Grundlagen der Volterraschen Theorie des Kampfes ums Dasein in wahrscheinlichkeitstheoritischer Behandlung,” Acta Biotheoretica, vol. 5, pp. 11–40, 1939.
[8] D. G. Kendall, “The generalized “birth-and-death” process,” Ann. Math. Statist., vol. 19, pp. 1–15,
1948.
[9] W. Feller, Introduction to Probability and Its Applications: Vol. I. John Wiley & Sons, 1968.
[10] R. Syski, Introduction to Congestion Theory in Telephone Systems. North Holland, 1986.
[11] L. Kleinrock, Queueing Systems, Vol. I: Theory. John Wiley & Sons, Inc., 1975.
[12] F. P. Kelly, Reversibility and Stochastic Networks. John Wiley & Sons, Inc., 1979.
[13] H. Kobayashi, Modeling and Analysis: An Introduction to System Performance Evaluation Methodology.
Addison Wesley, 1978.
[14] H. Kobayashi and B. L. Mark, System Modeling and Analysis: Foundations for System Performance
Evaluation. Prentice Hall, 2008.
[15] H. Kobayashi, B. L. Mark, and W. Turin, Probability, Random Processes, and Statistical Analysis.
Cambridge University Press, 2012.
[16] H. Takagi, “Lecture Note: Bith-and-Death Process and Its Application (in Japanese),” March 2007.
[17] M. Bartlett, An Introduction to Stohasctic Processes with Special Reference to Methods and Applications.
Cambridge University Press, 3 ed., 1978.

Copyright c Hisashi Kobayashi 2020

24

[18] D. G. Kendall, “On some modes of population growth leading to R. A. Feller’s logarithmic series
distribution,” Biometrika, vol. 19, pp. 6–15, 1948.
[19] M. Bartlett, “Some Evolutionary Stochstic Processes,” Journal of the Royal Statistical Society. Series
B (Methodological), vol. 11, no. 2, pp. 211–229, 1949.
[20] N. T. Bailey, The Elements of Stochastic Processes With Applications to the Natural Sciences. John
Wiley & Sons, Inc., 1964.
[21] L. J. D. Allen, An Introduction to Stochastic Processes with Application to Biology. Chapman &
Hall/CRC, 2 ed., 2011.
[22] D. Gross and C. Harris, Fundamentals of Queueing Theory. John Wiley & Sons, 2 ed., 1985.
[23] Q. Ren and H. Kobayashi, “Transient solutions for the buffer behavior in statistical multiplexing,”
Performance Evaluation, vol. 23, pp. 65–87, 1995.
[24] H. Kobayashi and Q. Ren, “A mathematical theory for transient analysis of computer communication
networks (invited paper),” IEICE Trans. Commun., vol. E-75B, pp. 1266–1276, 1992.
[25] R. A. Fisher, A. S. Corbet and C. B. Williams, “The relation between the number of species and the
number of individuals in a random sample of an animal population,” Journal of Animal Ecology, vol. 12,
no. 1, pp. 42–58, 1943.
[26] H. Kobayashi and A. G. Konheim, “Queuing Models for Computer Communications Systems Analysis
(Invited Paper),” IEEE Trans. on Communications, vol. 25, pp. 148–157, January 1977.
[27] D. Branson, “In homegeneous birth-death and birth-death-immigration processes and the logarithmic
series distribution,” Stochastic Processes and their Applications, vol. 39, pp. 131–137, 1991.
[28] S. Karlin and J. McGregor, “The number of mutant forms maintained in a population,” in Proc. 5th
Berkeley Symp. Math Statist. Probab. (L.M. Le Cam and J. Neyman, ed.), vol. 4, (Berkeley, CA),
pp. 415–438, Univ. California Presss, 1967.

Copyright c Hisashi Kobayashi 2020

25

log10 I(t): Current Number of the Infected

I(t): Current Number of the Infected

600

run 1
run 2
run 3
run 4
run 5
run 6
Deterministic model

500

400

10

run 1
run 2
run 3
run 4
run 5
run 6
Deterministic model

4

I(t)

I(t)

103
300

102
200

101

100

100

0
0

5

10

15

20

25

5

30

10

Figure 1: The first 6 simulation runs of BDI
process and a deterministic model curve.

30

run 7
run 8
run 9
run 10
run 11
run 12
Deterministic model

104

103

I(t)

I(t)

400

25

log10 I(t): Current Number of the Infected

run 7
run 8
run 9
run 10
run 11
run 12
Deterministic model

500

20

Figure 2: Semi-log plots of the same runs.
The baseline of y axis is 100 = 1.

I(t): Current Number of the Infected

600

15

t

t

300

102
200

101
100

100

0
0

5

10

15

20

25

30

5

10

15

20

25

30

t

t

Figure 3: The next 6 simulation runs of BDI
process and a deterministic model curve.

Figure 4: Semi-log plots of the same runs.
The baseline of y axis is 100 = 1.

Copyright c Hisashi Kobayashi 2020

26

Deterministic model

400
350
300

E[I(t)]

250
200
150
100
50
0
0

10

20

30

40

50

60

70

80

90

100

t[day]

Figure 5: I(t) when λ = 0.3, µ = 0.1, ν = 0.2 for 0 ≤ t ≤ t1 = 30 at which point λ is changed to
λ0 = 0.06.

0.8
r=0.5
r=1
r=2
r=4
r=8
r=16
r=32

0.7

P (Xr = k)

0.6
0.5
0.4
0.3
0.2
0.1
0

0

5

10

15

20

25

30

35

k

Figure 6: The (shifted) negative binomial distribution (39), i.e., the probability distribution of the number of
failures needed to achieve r successes in Bernoulli trials with q(= 1 − p) = 0.5 and for r = 0.5, 1, 2, 4, 8, 16, 32.:

Copyright c Hisashi Kobayashi 2020

27

Probability Distrribution, t=5, q=0.720469, r=0.666667

0.9

0.45

0.8

0.4

0.7

0.35

0.6

0.3

0.5

Pn

Pn

Probability Distrribution, t=1, q=0.249308, r=0.666667

0.25

0.4

0.2

0.3

0.15

0.2

0.1

0.1

0.05

0

0

0

1

2

3

4

5

6

7

8

9

10

0

2

4

6

8

n

12

14

16

18

20

n

Figure 7: Pn (t) at t = 1.

Figure 8: Pn (t) at t = 5.

Probability Distrribution, t=10, q=0.905514, r=0.666667

0.25

10

Probability Distrribution, t=20, q=0.987715, r=0.666667

0.06

0.05

0.2

0.04

Pn

Pn

0.15
0.03

0.1
0.02
0.05

0.01

0
0

5

10

15

20

25

30

35

40

45

50

0

50

100

n

Figure 9: Pn (t) at t = 10.

Figure 10: Pn (t) at t = 20.

Probability Distrribution, t=30, q=0.998346, r=0.666667

0.015

150

n

10-4Probability Distrribution, t=50, q=0.999970, r=0.666667

6

5

0.01

Pn

Pn

4

0.005

3

2

1

0
0

100

200

300

400

500

600

700

800

n

900

1000

0

1000

2000

3000

4000

5000

6000

7000

8000

9000

n

Figure 11: Pn (t) at t = 30.

Figure 12: Pn (t) at t = 50.

Copyright c Hisashi Kobayashi 2020

28

Log-survivor function,t=10, q=0.905514, r=0.666667

0

Log-survivor function,t=30, q=0.998346, r=0.666667

0
-0.1

-0.5
-0.2
-0.3

log(1-Fn)

log(1-Fn)

-1

-1.5

-0.4
-0.5
-0.6

-2
-0.7
-0.8

-2.5

-0.9

-3

-1

0

5

10

15

20

25

30

35

40

45

50

0

100

200

300

n

400

500

600

700

800

900

1000

n

Figure 13: The log-survivor function plot of
the distribution of I(t) at t = 10.

Figure 14: The log-survivor function plot of
the distribution of I(t) at t = 30.

Copyright c Hisashi Kobayashi 2020

29

