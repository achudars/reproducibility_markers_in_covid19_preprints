Submitted to the Annals of Applied Statistics

BAYESIAN ADJUSTMENT FOR PREFERENTIAL TESTING IN ESTIMATING
INFECTION FATALITY RATES, AS MOTIVATED BY THE COVID-19
PANDEMIC
B Y H ARLAN C AMPBELL1, * P ERRY DE VALPINE2 , L AUREN M AXWELL3 ,

arXiv:2005.08459v4 [stat.ME] 10 Mar 2021

VALENTIJN M.T. DE J ONG4 , T HOMAS P.A. D EBRAY4,5 ,
T HOMAS JAENISCH3,6 , PAUL G USTAFSON1
A key challenge in estimating the infection fatality rate (IFR) -and its
relation with various factors of interest- is determining the total number of
cases. The total number of cases is not known because not everyone is tested,
but also, more importantly, because tested individuals are not representative
of the population at large. We refer to the phenomenon whereby infected individuals are more likely to be tested than non-infected individuals, as “preferential testing.” An open question is whether or not it is possible to reliably
estimate the IFR without any specific knowledge about the degree to which
the data are biased by preferential testing. In this paper we take a partial identifiability approach, formulating clearly where deliberate prior assumptions
can be made and presenting a Bayesian model which pools information from
different samples. When the model is fit to European data obtained from seroprevalence studies and national official COVID-19 statistics, we estimate the
overall COVID-19 IFR for Europe to be 0.53%, 95% C.I. = [0.39%, 0.69%].

* 1. Department of Statistics, University of British Columbia, BC, Canada; 2. Department of Environmental

Science, Policy, and Management, University of California, Berkeley, CA, USA; 3. Heidelberg Institute for Global
Health, Heidelberg University Hospital, Heidelberg, Germany; 4. Julius Center for Health Sciences and Primary
Care, University Medical Center Utrecht, Utrecht University, Utrecht, the Netherlands; 5. Cochrane Netherlands,
Julius Center for Health Sciences and Primary Care, University Medical Center Utrecht, Utrecht University,
Utrecht the Netherlands; 6. Department of Epidemiology, Colorado School of Public Health, CO, USA; This
work was supported by the European Union’s Horizon 2020 research and innovation programme under ReCoDID
grant agreement No 825746 and by the Canadian Institutes of Health Research, Institute of Genetics (CIHR-IG)
under Grant Agreement No 01886-000. We also wish to thank Joe Watson for his input early on and expertise on
preferential sampling,
Keywords and phrases: selection bias, partial identification, evidence synthesis.

1

2

1. Introduction.

If someone is infected with severe acute respiratory syndrome coronavirus 2 (SARS-CoV2), the pathogen that causes COVID-19, how likely is that person to die of COVID-19? This
simple question is surprisingly difficult to answer.
The “case fatality rate” (CFR) is a common measure that quantifies the mortality risk in a
certain population, and is given by the ratio of deaths (D ) over confirmed cases (CC ) during
a specific time period. However, because many COVID-19 cases are never diagnosed, the
CFR almost certainly overestimates the true lethality of the virus. Instead, the better answer
is captured by the infection fatality rate (IFR) (Kobayashi et al., 2020; Wong et al., 2013). The
IFR, also a simple ratio, differentiates itself from the CFR by considering all cases, including
the asymptomatic, undetected and misdiagnosed infections, in the denominator. For instance,
if 20 individuals die of the disease in a population with 1,000 infections, then the IFR is 20 /
1000 = 0.02 = 2%.
Evidently, a key challenge in calculating the IFR is determining the true total number of
cases. The total number of cases (C ) is not known because not everyone is tested in the population (P ). A naïve estimate of the IFR might take this into account by simply considering the
number of tests (T ) and estimating the number of cases as: C ≈ (CC/T ) × P . However, diagnostic tests are often selectively initiated, such that tested individuals are not representative
of the population at large.
In most countries/jurisdictions, those with classic COVID-19 symptoms (e.g. fever, dry
cough, loss of smell or taste) are much more likely to be tested than those without symptoms.
Due to this “severity bias,” the reported number of cases likely includes mostly people whose
symptoms were severe enough to be tested and excludes the vast majority of those who are
mildly- or asymptomatic. Even when testing is made equally available to all individuals, there
is potential for bias if people who have reason to believe they are infected are more likely to
volunteer to be tested (e.g., Bendavid et al. (2020)). We refer to the phenomenon whereby
infected individuals are more likely to be tested than non-infected individuals, as “preferential
testing” (Hauser et al. (2020) and others use the term “preferential ascertainment.”)
If the degree of preferential testing in a particular sample is of known magnitude, bias
adjustment can be achieved by appropriately altering the estimated rate of infection and its
uncertainty interval. However, the degree of preferential testing is typically unknown and
likely highly variable across different jurisdictions. An open question is whether or not it

BAYESIAN ADJUSTMENT FOR PREFERENTIAL TESTING IN ESTIMATING THE COVID-19 IFR 3

is possible to reliably estimate the IFR without any specific information about the degree
to which the data are biased by preferential testing (Q1). And, if we have some samples
for which testing is representative and others which are subject to some unknown bias from
preferential testing, is it better to use only the representative data or to combine both kinds
of data in a joint analysis (Q2)? In this paper, we address these two important questions by
considering a Bayesian hierarchical model for estimation of the IFR. We demonstrate with an
application of the model to European data from seroprevalence studies and national official
COVID-19 statistics.
Bayesian models have been previously used in similar situations. For example, Presanis et al. (2009) conduct Bayesian inference to estimate the severity of pandemic H1N1 influenza. More recently, Rinaldi and Paradisi (2020), and Hauser et al. (2020) use Bayesian
models for disease dynamics in order to estimate the severity of COVID-19. To address the
issue of preferential testing bias, Hauser et al. (2020) apply susceptible-exposed-infectedremoved (SEIR) compartmental models to age-stratified data and, in order to establish parameter identifiability, assume that all cases of infected patients aged 80 years and older are
confirmed cases. The Bayesian model we propose is more general and allows one to obtain
appropriate point and interval estimates for the IFR with varying degrees of prior knowledge
about the magnitude of preferential testing and the distribution of other explanatory factors
(e.g. age, healthcare capacity).
This paper is structured as follows. In Section 2, we introduce required notation, discuss
distributional assumptions and review key issues of identifiability. In Section 3, we formulate
our Bayesian model and in Section 4, we describe how the model can be scaled for larger
populations and can incorporate covariates. In Section 5, we present a simulation study and
in Section 6, we present an analysis of COVID-19 data from Europe. We conclude in Section
7 with a return to the primary questions of interest (Q1 and Q2).
2. Notation, distributions, and issues of (un)identifiability.
2.1. Notation and distributions. Suppose we have data from K independent groups (i.e.,
countries or jurisdictions) from a certain fixed period of time. For group k = 1, . . . , K , let:
• Pk be the population size (i.e., the total number of individuals at risk of infection);
• Tk be the total number of people tested;
• CCk be the total number of confirmed cases resulting from the tests; and
• Dk be the total number of observed deaths attributed to infection.

4

We do not observe the following latent variables. For the k -th group, let:
• Ck be the total number of infected people (cases) in the population;
• IRk be the true infection rate (proportion of the population which is infected), which is
the expected value of Ck /Pk ; and
• IF Rk be the true underlying infection fatality rate (IFR), which is the expected value of
Dk /Ck .

Therefore, we assume that:
Ck ∼ Binom(Pk , IRk ),

(1)

and:

Dk |Ck ∼ Binom(Ck , IF Rk ),

(2)

where, in the k -th group, the unknown number of infections, Ck , and the known number of
deaths, Dk , each follow a binomial distribution. Note that there are latent variables on both
the left hand side and the right hand side of (1).
For each group, CCk is recorded, instead of Ck . Even in the absence of preferential testing,
CCk will be smaller than Ck because not everyone is tested. The goal is to draw inference on

the relationship between the number of deaths, D , and the number of cases, C , having only
data on D , CC , P , and T . This is particularly challenging since the number of confirmed
cases in each group may be subject to an unknown degree of preferential testing.
In the absence of any preferential testing, if one assumes that the population sizes are finite,
then the number of confirmed cases will follow a hyper-geometric distribution (Prochaska
and Theodore, 2018). The hyper-geometric distribution describes the probability of CCk
confirmed cases amongst Tk tests (without any individuals being tested more than once),
from a finite population of size Pk that contains exactly Ck cases. Wallenius’ non-central
hyper-geometric is a generalization of the hyper-geometric distribution whereby testing is
potentially biased with either cases or non-cases more likely to be tested (Fog, 2008). We
therefore consider the distribution of CCk |Ck as following a non-central hyper-geometric
(NCHG) distribution:
(3)

CCk |Ck ∼ N CHyperGeo(Ck , Pk − Ck , Tk , φk ),

where the degree of preferential testing corresponds to the φk non-centrality parameter (see
Appendix (Section 8.1) for details about the NCHG distribution). When φk > 1, cases (i.e.,
infected individuals) are more likely to be tested than non-cases (i.e., non-infected individuals); when φk < 1, cases are less likely to be tested than non-cases. When φk = 1, we have

BAYESIAN ADJUSTMENT FOR PREFERENTIAL TESTING IN ESTIMATING THE COVID-19 IFR 5

that the probability of being tested is equal for both cases and non-cases, and the NCHG distribution reduces to the standard hyper-geometric distribution. In this parameterization, the
φk parameter can be interpreted as an odds ratio: the odds of a case being tested vs. the odds

of a non-case being tested.
The distribution of the confirmed cases depends on the actual infection rate (C/P ) and
the testing rate (T /P ), but does not depend on the infection fatality rate (D/C ). In other
words, we assume that the conditional distribution of (CC|C, T, P, D) is identical to the
conditional distribution of (CC|C, T, P ). This assumption is similar to the assumption of
“non-differential” exposure misclassification in measurement error models and may or may
not be realistic; see De Smedt et al. (2018). If across the K different groups, those groups
with higher φk values also tend to have higher IF Rk values, then one will inevitably obtain
biased estimates because the IF Rk and φk are considered a priori independent. The same
logic applies to the IRk and IF Rk which are also a priori independent.
Also note that the members of set Dk are not a subset of the members of set CCk . While
Dk is a subset of Ck , and CCk is a subset of Ck ∩ Tk , Dk is not necessarily a subset of
CCk . For example, in the seroprevalence study data for Luxembourg which we consider in

Section 6 (see Table 2, row 3), we have CCk = 23 confirmed cases out of Tk = 1, 214 tests.
There are Dk = 93 deaths out of a population of Pk = 615, 729. Evidently, Dk is not a subset
of CCk . Furthermore, the assumption that φk = 1 for this Luxembourg data implies that the
1,214 tested individuals were not any more or less likely to be infected than those in the
general population. However, note that there is no requirement that the tested individuals
have the same risk of death as those in the general population. To be clear, no distributional
assumptions will be violated if, within the k -th group, individuals with a higher probability
of death (e.g., the elderly) are more likely to be tested than those with a lower probability of
death (e.g., young, healthy individuals).
2.2. Partial identifiability. Given the assumptions detailed above, for each of the K
groups, there are three unknown parameters (latent states), IRk , IF Rk and φk , that must
be estimated for every two observed quantities (Dk /Pk and CCk /Tk ). This indicates that a
unique solution will not be attainable without additional external data or prior information.
The problem at hand is sufficiently rich and complex that forming intuition about the
information-content of the data is challenging. In the Appendix (Section 8.2), we consider,
in depth, an asymptotic argument for partial identifiability. We determine that, depending
on the range and heterogeneity in the degree of preferential testing across groups, the data

6

can contribute substantial information about the infection fatality rate. Data from any single
group may only be weakly informative about the IFR, in the sense that only lower and upper
bounds for the IFR are estimable. However, we show that in some circumstances there is
very considerable sharpening of information when these bounds are combined across groups,
provided it is a priori plausible that the IFR heterogeneity across groups is modest.
3. A Bayesian model for small-P data.

We describe a Bayesian model which assumes standard Gaussian random-effects allowing
both the infection rate (IR) and infection fatality rate (IFR) to vary between groups. Bayesian
models are known to work well for dealing with partially identifiable models; see Gustafson
(2010). Consider the following random-effects model:
(4)

g(IF Rk ) ∼ N (θ, τ 2 ),

(5)

g(IRk ) ∼ N (β, σ 2 ),

and

for k = 1, . . . , K , where θ is the parameter of primary interest, τ 2 represents between group
IFR heterogeneity, β represents the mean g(infection rate), σ 2 describes the variability in
infection rates across the K groups, and g() is a given link function. Note that, alternatively,
a simpler fixed-effects version of the model arises by setting τ = 0 such that g(IF Rk ) = θ,
for k = 1, . . . , K .
We will adopt the complimentary log-log link function (cloglog) for g(), though there are
other sensible choices including the logit and probit functions. Our choice of the cloglog
function facilitated the creation of parameter-transformed samplers for efficient sampling
(see Appendix 8.3).
Putting together the assumptions for p(Dk |IF Rk , Ck ), p(CCk |Tk , Pk , Ck , φk ) and p(Ck |Pk , IRk )
defined in Section 2.1 along with prior distributions, Bayes’ Law takes the form:
(6)
p((θ, τ 2 , β, σ 2 , C, IFR, IR, φ)|data) ∝ p(data|θ, τ 2 , β, σ 2 , C, IFR, IR, φ)
× p(θ, τ 2 , β, σ 2 , C, IFR, IR, φ)
=

K
Y

p(Dk |IF Rk , Ck )p(CCk |Tk , Pk , Ck , φk )p(Ck |Pk , IRk )p(IF Rk |θ, τ 2 )p(IRk |β, σ 2 )

k=1

× p(θ)p(τ 2 )p(β)p(σ 2 )p(φ).



BAYESIAN ADJUSTMENT FOR PREFERENTIAL TESTING IN ESTIMATING THE COVID-19 IFR 7

We are left to define prior distributions for the unknown parameters: θ , τ 2 , β , σ 2 , and
φ. Our strategy for priors on IR and IFR is to assume uninformative priors for the mean of

IFR and of IR and for the variance of IR, but a strongly informative prior favouring small
values for the variance of IFR. This strategy reflects the assumption that the infection fatality rate varies across jurisdictions much less than the infection rate itself (especially after
accounting for population level sources of heterogeneity; see Section 4.2). Uniform and halfNormal priors are set accordingly: g−1 (θ) ∼ U nif orm(0, 1); g−1 (β) ∼ U nif orm(0, 1);
σ ∼ half-N (0, 1) and τ ∼ half-N (0, η 2 ) , where η = 0.1.

The only remaining component is p(φ). Our strategy for a prior on the degree of preferential testing is to assume that cases are more likely to be tested than non-cases (i.e., φk > 1),
that all values of φk are equally likely across jurisdictions, and that there is an upper bound,
1 + γ , on the degree of preferentiality. For the upper bound parameter, γ , we assume an

exponential prior, such that:
φk |γ ∼ U nif orm(1, 1 + γ),

for k = 1, . . . , K ;

and

γ ∼ Exp(λ).

We therefore assume that the uniform range of possible values for φk is itself unknown.
This hierarchy allows one to specify a very “weakly informative” prior for the degree of
preferential testing. For instance, setting λ = 0.05 implies that, a priori, a reasonable value
for the φk odds ratio is about 6 (infected individuals are about 6 times more likely to be tested
than those uninfected) and could range anywhere from about 3 to 14. (When λ = 0.05, the
median of the unconditional distribution for φk is 6.4, with a wide interquartile range of 2.7
to 14.3.)
In some scenarios, we might have some groups for which φk is known and equal to 1
(i.e., have data from some samples where testing is known to be truly random). Without loss
0

0

of generality, suppose this subset is the first k studies, such that for k = 1, . . . , k , we have
φk = 1. We will use this approach in the European data analysis (Section 6), in which we

assume φk is known and equal to 1 for data from representative seroprevalence studies.
We must emphasize that the performance of any Bayesian estimator will depend on the
choice of priors and that this choice can substantially influence the posterior when few data
are available (Berger, 2013; Lambert et al., 2005). The priors described here represent a
scenario where there is little to no a priori knowledge about the θ , β , and φ model parameters.
Inference would no doubt be improved should more informative priors be specified based on
probable values for each of these parameters. We will consider the impact of priors in the
simulation study in Section 5, where we look to different values for λ and η .

8

We must also emphasize that, due to the partial identifiability issues (Section 2.2), a delicate trade-off may exist between the priors for the τ and φ parameters. For instance, if large
values of τ are made a priori plausible (i.e., if η is large), then the posterior estimates of the φ
parameters may be driven downwards towards 1 (due to the γ ∼ Exp(λ) prior). A relatively
homogeneous across-group IFR can be central to identifiability and, as such, the aforementioned “fixed-effects” version of the model (essentially equivalent to fixing τ = 0) may be
0

more feasible in situations when identification is particularly challenging (e.g., when k = 0,
and/or when there is very little prior knowledge about the θ , β , and φ model parameters). On
0

the other hand, in situations when identification is less of a concern (e.g., when k is relatively
large relative to K and/or when there is substantial and reliable prior information), setting a
priori limitations on τ may be detrimental if the true heterogeneity in infection fatality rates
across groups is high and meaningful.
4. A Bayesian model for large-P data.
4.1. Distributional approximations. When populations are sufficiently large, two simplifications to the model are desirable. First, we will replace the NCHG distribution with a
binomial distribution as follows:
(7)

CCk ∼ Binom(Tk , 1 − (1 − Ck /Pk )φk )

for k = 1, . . . , K . This simplification1 alleviates the need for writing custom samplers for
the NCHG distribution for certain MCMC software (e.g., Stan, nimble) and also provides
additional familiarity to researchers who may not be accustomed to working with the NCHG
distribution. Secondly, we can dispense with the need to sample the Ck latent variables by
replacing the above distribution for CCk with:
(8)

CCk ∼ Binom(Tk , 1 − (1 − IRk )φk ).

For any sufficiently large Pk , this simplification will make little to no difference. Then, since
the distributions of Ck and Dk |Ck are both binomials (see (1) and (2)), we have that uncon1

Recall that a hyper-geometric distribution is asymptotically equivalent to a binomial distribution and while

this particular binomial parameterization does not emerge from the limit of the NCHG distribution, it is a reasonable approximation. We could have alternatively substituted the NCHG distribution with the known Gaussian
asymptotic approximation to the NCHG (Stevens, 1951). However, the Gaussian approximation requires solving
quadratic equations and therefore might not actually make things simpler; see Sahai and Khurshid (1995).

BAYESIAN ADJUSTMENT FOR PREFERENTIAL TESTING IN ESTIMATING THE COVID-19 IFR 9

ditionally:
Dk ∼ Binom(Pk , IF Rk × IRk ).

(9)

Note that in (7) and (8) above, the φk parameter no longer corresponds to an odds ratio, yet
the interpretation is similar. Starting from (8), the odds ratio (OR) describing the association
between testing status and infection status is
log(OR) = log(1 − (1 − IR)φ ) − φ × log(1 − IR) − log(IR) + log(1 − IR).

For fixed IR, approximating this with a Taylor series in log(φ), about zero, gives: log(OR) ≈
cIR log(φ), where cIR = − log(1 − IR)/IR. Note that cIR → 1 as IR → 0. Therefore, in

the rare-infection realm, φ is indeed approximately the odds ratio for testing and infection
status.
4.2. Including group-level covariates. The proposed model can be expanded to include
factors of interest specified as covariates at the group level, resembling what is commonly
done in a meta-regression analysis (Thompson and Higgins, 2002). Covariates included for
analysis might be metrics that are correlated with the probability of infection, with the probability of being tested, with the accuracy of the test, and/or with the probability of dying from
infection.
For instance, suppose that X[1]k , . . . , X[h]k are h different group-level covariates that explain the k -th group’s infection rate, and that Z[1]k , . . . , Z[q]k are q different covariates that
explain the k -th group’s IFR. Then these can be incorporated as follows:
(10)
(11)

g(IRk ) ∼ N (β + β1 X[1]k + . . . + βh X[h]k , σ 2 ),
g(IF Rk ) ∼ N (θ + θ1 Z[1]k + . . . + θq Z[q]k , τ 2 ).

Age is a key factor for explaining the probability of COVID-19-related death (O’Driscoll
et al., 2020). One might therefore consider median age of each group as a predictor for the
IFR, or perform analyses that are stratified by different age groups (Onder et al., 2020). The
latter strategy has, for instance, been recommended to make accurate predictions for respiratory infections (Pellis et al., 2020). With regards to the infection rate, time since first reported
infection, or time between first reported infection and the imposition of social distancing
measures might be predictive (Anderson et al., 2020).
4.3. MCMC. For the large-P model, Markov chain Monte Carlo (MCMC) mixing can
be slow because different combinations of φk , cloglog(IRk ) and cloglog(IFRk ) can yield

10

similar model probabilities. This is related to the identifiability issues discussed in the Appendix (Section 8.2). Standard Gibbs sampling (e.g., as implemented with JAGS (Kruschke,
2014)) will be inefficient in many situations. To improve mixing and reduce computational
time, we wrote the model in the nimble package (de Valpine et al., 2017), which supports an
extension of the modeling language used in JAGS and makes it easy to configure samplers
and provide new samplers. Details of the MCMC implementation for nimble are presented
in the Appendix (Section 8.3). We also implemented the large-P model in the popular Stan
package which employs Hamiltonian MCMC algorithms (Carpenter et al., 2017).
5. Simulation study.
5.1. Design. We conducted a simulation study in order to better understand the operating
characteristics of the proposed model. Specifically, we wished to evaluate the frequentist
coverage of the credible interval for θ and investigate the impact of choosing different priors.
As emphasized in Gustafson et al. (2009), the average frequentist coverage of a Bayesian
credible interval, taken with respect to the prior distribution over the parameter space, will
equal the nominal coverage. This mathematical property is unaffected by the lack of identification. However, the variability of coverage across the parameter space is difficult to anticipate and could be highly affected by the choice of prior. For example, we might expect
that, in the absence of preferential testing (i.e., when γ = 0), coverage will be lower than the
nominal rate. However, if this is the case, coverage will need to be higher than the nominal
rate when γ > 0, so that the “average” coverage (taken with respect to the prior distribution
over the parameter space) is nominal overall.
0

We simulated datasets with K = 20 and k = 8. For k = 1, . . . , 8, population sizes were
obtained from a N egBin(20000, 1) distribution with a mean of 20,000 and for k = 9, . . . , 20,
population sizes were obtained from a N egBin(200000, 1) distribution. Parameter values
were as follows: θ = cloglog(0.02) = −3.90, β = cloglog(0.20) = −1.50, τ 2 = 0.005 and
σ 2 = 0.25. The testing rate for each population was obtained from a U nif orm(0.01, 0.10)

distribution so that the proportion of tested individuals in each population ranged from 1% to
10%. We considered eight values of interest for γ : 0, 0.5, 1, 2, 4, 12, 32, 64 (for simulation);
and three different values of interest for both λ and η : 0.05, 0.1, and 0.5 (for estimation). The
number of confirmed cases (CCk ) were simulated from Wallenius’ NCHG distribution as
detailed in Section 2.1. The 12 “unknown” φk values, for k = 9, . . . , 20, were simulated from

BAYESIAN ADJUSTMENT FOR PREFERENTIAL TESTING IN ESTIMATING THE COVID-19 IFR 11

a U nif orm(1, γ + 1) distribution. Note that with high γ levels, the vast majority of tests will
be positive (when γ = 32, positivity is about 72%; when γ = 64, positivity is about 81%).
We fit three models to each unique dataset: M 1, M 2, and M 3. All three models follow
the same large-P framework detailed in Section 4.1, but each considers a different subset of
the data:
• The M 1 model uses only data from the groups for which φk is unknown, i.e., {Pk , Tk ,
0

CCk , and Dk } for k = 9, . . . , 20 (k = 0, and K = 12);

• The M 2 model considers the data from all 20 groups, i.e., {Pk , Tk , CCk , and Dk } for k =
0

1, . . . , 20 (k = 8, and K = 20); and

• The M 3 model uses only data from the groups for which φk is known and equal to 1, i.e.,
0

{Pk , Tk , CCk , and Dk } for k = 1, . . . , 8 (k = 8, and K = 8).

To be clear, the M 2 and M 3 models make the assumption of (correctly) known φk = 1 for
k = 1, . . . , 8.

We simulated 1,100 unique datasets (i.e., 1,100 unique sets of values for {Pk , Tk , Dk , CCk,γ },
for k = 1, . . . , K , and γ = {0, 0.5, 1, 2, 4, 12, 32, 64}) and, for each dataset, fit the three different models. (See Table 1 in the Appendix for an example of a “single” unique dataset.)
We specifically chose to conduct 1,100 simulation runs so as to keep computing time within
a reasonable limit while also reducing the amount of Monte Carlo standard error (MCSE)
to a reasonably small amount. For looking at coverage with 1 − α = 0.90, MCSE will be
approximately

p

0.90(1 − 0.90)/1100 ≈ 0.009; see Morris et al. (2019).

For each unique dataset, the M 1 and M 2 models were fit 72 times (= 3 × 3 × 8): with λ
assuming one of the 3 values of interest, with η assuming one of the 3 values of interest, and
with one of the 8 different sets of CCk numbers (for k = 9, . . . , 20) corresponding to the nine
γ values of interest. The M 3 model was fit 3 times for each unique dataset: with η assuming

one of the three values of interest. For each model fit, we recorded the the posterior median
estimate of icloglog(θ), the width of the 90% highest posterior density (HPD) CI for θ , and
whether or not the 90% HPD CI contained the target value of cloglog(0.02) = −3.90.
For each simulation scenario, we used Stan to obtain a minimum of NM C = 18, 000
MCMC draws from the posterior (a total from 3 independent chains, with 20% burn-in,
and thinning of 5). We recorded the Gelman-Rubin test statistic, R̂ (Gelman et al., 1992;
Brooks and Gelman, 1998) and if this statistic was R̂ > 1.05, the MCMC sampling was discarded and was restarted anew with twice the number of MCMC draws, up to a maximum of

12

NM C = 288, 000. If, even after 4 re-starts, with NM C = 288, 000, we obtained R̂ > 1.05, a

convergence/mixing failure was recorded and the result was simply discarded.
5.2. Results. Figure 1 plots the simulation study results. The M 3 model, which only
considers data from those groups where testing is known to be representative/random, appears to obtain a average point estimate for icloglog(θ) of approximately 0.02 as desired
for all three values of η . In contrast, the M 1 model, which only considers data from those
groups where the degree of preferential testing is unknown, obtains average point estimates
for icloglog(θ) far above and far below the target value of 0.02 depending on η , λ, and γ .
(Note that many results for M 1 are so large/small that they are outside the limits of the plot).
The M 2 model, which makes use of all the data, obtains point estimates of approximately
0.02 for all positive values of γ , when λ is sufficiently small (i.e., λ ≤ 0.1) for all three values
of η . When λ = 0.5, the M 2 model tends to underestimate icloglog(θ) when η and/or γ are
large.
Coverage for models M 2 and M 3 appears to be highly dependent on η . With η = 0.1, the
M 2 and M 3 models obtain coverage of approximately 90% as desired for all γ > 0 values

considered. With η = 0.05, coverage is ever so slightly less than the desired 90% level and
when η = 0.5, coverage is higher than the desired 90% level. The results from the M 1 model
show that, for small values of λ and η (i.e., for λ ≤ 0.5 and η < 0.5) , coverage is at or
above 90% for the entire range of γ values. This suggests that appropriate coverage may be
0

achievable even when k = 0 and when in the presence of a substantial and unknown amount
of preferential testing.
The credible interval width results from the M 2 and M 3 models indicates that, for a wide
range of γ values, the M 2 model (which makes use of all the data) is preferable to the M 3
model (which uses data only from those groups where testing is known to be representative/random). However, there is a limit to the “added value” that the “non-representative”
data provide. For example, for γ > 12 and η = 0.1, M 3 intervals are narrower compared to
M 2 intervals (for all values of λ).

Overall, the interval width is much much narrower for M 2 relative to M 1. This confirms
0

that the k = 8 representative samples are very valuable for reducing the uncertainty around
θ . (Note that most credible interval width results for M 1 are so large that they are outside the

limits of the plot). With regards to the COVID-19 pandemic, this emphasizes the importance
of conducting some amount of “unbiased testing” even if the sample sizes are relatively small;
see Cochran (2020).

BAYESIAN ADJUSTMENT FOR PREFERENTIAL TESTING IN ESTIMATING THE COVID-19 IFR 13

0.00

0.017

0.022

point estimate of g−1(θ)

0

0.5 1

2

12

η = 0.05

4

λ

32

0.05

64

0

0.5 1

0.1

2

12

Model

γ

η = 0.10

4

0.5

32

M1

64

0

0.5 1

M2

2

M3

12

η = 0.50

4

32

64

F IG 1. Results from the simulation study. The top row plots average point estimate obtained for icloglog(θ), the middle row plots the coverage of the 90% HPD CI; and the bottom
row plots the average width of the 90% HPD CI. Each column of panels corresponds to a different level of η. To be clear, each different value for γ corresponds to a different upper
bound on the degree of preferential testing in the simulated data. Different values for λ and η correspond to different prior specifications.

0.0

0.1

0.2

0.3

0.25

0.50

0.75

1.00
0.90

0.018

0.019

0.020

0.021

coverage of 90% CI for θ
width of 90% CI for θ

14
0

Finally, note that, if k = 0, mixing can be problematic if λ is small. Indeed, for the M 1
model, convergence/mixing failures occurred in about 1% of simulation runs when λ = 0.05,
and occurred in less than 0.004% of simulation runs when λ > 0.05. With very small λ values
(e.g., λ < 0.001), we suspect that convergence may simply be impossible. This is no doubt
due to the identifiability issues discussed in Section 2.2 and in the Appendix (Section 8.2).
0

If k = 0, the model benefits greatly (in terms of mixing and identifiability) from specifying
more informative priors.
6. Application- IFR of COVID-19 in Europe.

Reducing uncertainty around the severity of COVID-19 was of great importance to policy
makers and the public during the early stages of the pandemic and continues to be a top priority (Ioannidis, 2020b; Lipsitch, 2020). Comparisons between the COVID-19 and seasonal
influenza IFRs impacted the timing and degree of social distancing measures and highlighted
the need for more accurate estimates for the severity of both viruses (Faust, 2020). A lack
of clarity means that policy makers are unsure if cross-population differences are related to
clinically relevant heterogeneity (i.e., due to large τ ) or to spurious heterogeneity driven by
testing and reporting biases (i.e., due to large γ ).
We demonstrate how the proposed model could be used to estimate the IFR of COVID19 in Europe during the spring of 2020. Note that the main purpose of this analysis is to
demonstrate the feasibility of the proposed model. As such, we keep things relatively simple.
For instance, we only consider countries belonging to the EU/EEA (European Economic
Area), the United Kingdom, and Switzerland, as these could be considered a reasonably
homogeneous group. However, we exclude Belgium since, uniquely, the country counts all
suspect deaths in nursing homes as COVID-19 deaths (Lee, 2020).
0

We selected k = 5 studies for which we assume there is no preferential testing. To do so,
we considered all European seroprevalence studies reporting an IR estimate (along with a
95% confidence/credible interval) listed in the systematic review by Ioannidis (2020a). From
these, we selected only those studies that claimed to achieve a representative or random
sample from their study population.
It is important to note that the seroprevalence studies were conducted amongst populations which were particularly hard hit by infection. The result is that these populations are
not necessarily representative of the overall European population. It is unclear how this might
impact our model estimates. Also, while some of the seroprevalence studies report the exact

BAYESIAN ADJUSTMENT FOR PREFERENTIAL TESTING IN ESTIMATING THE COVID-19 IFR 15

number of tests conducted (T ) and the number of confirmed cases recorded (CC ), to obtain
estimates for the infection rate, there are numerous adjustments (e.g., adjusting for testing
sensitivity and specificity). Rather than work with the raw Tk , and CCk numbers published
in the seroprevalence studies, we calculate effective data values for CCk and Tk based on a
binomial distribution that corresponds to the reported 95% CI for the IR. By “inverting binomial confidence intervals” in this way, we are able to properly use the adjusted numbers for
each of the five seroprevalence studies. This is a similar approach to the strategy employed by
Kümmerer et al. (2020) who assume that the IR follows a Beta distribution with parameters
chosen to match the 95% CI published in Streeck et al. (2020). In the Appendix (Section 8.4),
we go over the seroprevalence study data in detail.
We obtained national official COVID-19 statistics as reported by Our World in Data
(OWID, 2020). Complete data was available for 26 countries which brings the total number of groups to K = 31. The CCk and Tk numbers were selected as reported on May 1,
2020 (or the earliest date during the following week for which data was available). Numbers
for Dk for k = 6, . . . , K , were obtained from 14 days afterwards, to allow for the known delay between the onset of symptoms and death. (Some early literature (e.g., Wu et al. (2020);
Linton et al. (2020)) suggests that the median time from symptom onset to death may be
longer than 14 days.)
Note that our Tk numbers are not ideal since some countries report the number of people
tested, while others report the total number of tests (which will be higher if a single person is
tested several times). Also note that, as stated in Section 2.1, the K different groups should,
in principle, be entirely independent samples. This is clearly not the case with the European
data (case in point: there are three different groups from within Switzerland; k = 2, k = 5,
and k = 30).
We included several covariates about each country’s population to explain variation in IR
and IFR. Specifically, for the IR, we consider: (1) the number of days since the country reported 10 or more confirmed infections (“Days since outbreak”) (as reported by Hale et al.
(2020)); (2) the number of days between a country’s first reported infection and the imposition of social distancing measures (“Days until lockdown”) (calculated based on when the
Government Response Stringency Index (GRSI) reached 20 or higher as reported in OWID
(2020)); and (3) the population density (“Pop. density”) (as reported by OWID (2020) and

16

other publicly available sources2 ). For the IFR, we consider: (1) the share of the population
that is 70 years and older (“Prop. above 70 y.o.”) (as reported in Ioannidis (2020a) or OWID
(2020)); and (2) the number of hospital beds per 1,000 people (“Hosp. beds per 1,000”)3 .
Tables 2 and 3 in the Appendix list all the data used in the analysis.
6.1. Using only seroprevalence studies. Using only the seroprevalence studies (i.e., only
0

the first k = 5 studies listed in Table 2 in the Appendix), we fit the model as described in
Section 4.1 (with η = 0.1) without any adjustment for covariates. (With only K = 5 groups
there are few degrees of freedom available for including group-level covariates). The model
was fit using Stan (Carpenter et al., 2017), with 4 independent chains, each with 10,000
draws (10% burn-in, thinning of 50). Figure 2 plots the posterior medians obtained for the
IRk and IF Rk parameters (for k = 1, . . . , 5) with 95% HPD CIs. We also plot, in black,

the posterior median of g−1 (β) and g−1 (θ) (“Overall”). Our estimate for the overall IFR is
g−1 (θ) = 0.54%, 95% C.I. = [0.41%, 0.68%]. We note that the five IF Rk estimates obtained

are very homogeneous. This is no doubt partly due to the punitive nature of our prior on τ
(i.e., due to setting η = 0.1). Indeed, when the model is fit with η = 1, the IF Rk estimates
are more heterogeneous (the posterior median estimates obtained with η = 1 are: IF Rk =
0.50, 0.48, 0.65, 0.53, 0.60, for k = 1, . . . , 5, respectively, and g−1 (θ) = 0.54%, 95% C.I. =

[0.37%, 0.80%]).
6.2. Using all the data. We fit the model as described in Section 4.1 to all the data
0

(listed in Tables 2 and 3 in the Appendix) with k = 5, K = 31, h = 3, and q = 2. Covariates were defined as the centered and scaled logarithm of each metric as follows: X[1] =
center-scale(log(“Days since outbreak”)); X[2] = center-scale(log(“Days until lockdown” + 1));
X[3] = center-scale(log(“Population density”)); Z[1] = center-scale(log(“Prop. above 70 y.o.”));

and Z[2] = center-scale(log(“Hosp. beds per 1,000”)). Standard normal priors (N (0, 1))
were used for each of β1 , β2 , β3 , θ1 , and θ2 . All other priors were defined as in Section
2

For

Geneva

(https://www.bfs.admin.ch/bfs/en/home/statistics/

regional-statistics/regional-portraits-key-figures/cantons/geneva.html);
for Gangelt (https://en.wikipedia.org/wiki/Gangelt); for Split-Dalmatia (https://en.
wikipedia.org/wiki/Split-Dalmatia_County); for Zurich (https://www.bfs.admin.ch/
bfs/en/home/statistics/regional-statistics/regional-portraits-key-figures/
cantons/zurich.html).
3

obtained from OWID (2020) or from www.bfs.admin.ch for Geneva and Zurich cantons.

BAYESIAN ADJUSTMENT FOR PREFERENTIAL TESTING IN ESTIMATING THE COVID-19 IFR 17

15.3 [10.6,20.2]

1- Gangelt

0.54 [0.38,0.68]

9.5 [7.4,11.9]

2- Geneva

0.52 [0.4,0.65]

2.4 [1.7,3.1]

3- Luxembourg

0.57 [0.42,0.76]

1.2 [0.8,1.7]

4- Split-Dalmatia

0.54 [0.4,0.71]

1.5 [1,1.8]

5- Zurich

0.56 [0.42,0.74]

3.6 [0.5,8.2]

Overall
0

10

0.54 [0.41,0.68]

20

IR (%)

30

0.00

0.25

0.50

0.75

1.00

IFR (%)

F IG 2. Posterior median estimates for the IRk and IF Rk variables (for k = 1, . . . , 5) with 95% HPD CIs. Also
plotted, under the label “Overall”, is the posterior median estimate and 95% HDP CI of g−1 (β) and g−1 (θ).
These results correspond to the large-P model with η = 0.1 which pools information from five seroprevalence
0
studies (K = 5 and k = 5).

3 with η = 0.1 and λ = 0.05. The model was fit using Stan (Carpenter et al., 2017), with 4
independent chains, each with 10,000 draws (10% burn-in, thinning of 50).
Figure 3 plots the estimates (posterior medians) obtained for the IRk and IF Rk variables
(for k = 1, . . . , 31) with 95% HPD CIs. We also plot the posterior medians of g−1 (β) and
g−1 (θ) (“Overall”). Our estimate for the overall IFR is g−1 (θ) = 0.53%, 95% C.I. = [0.39%,

0.69%].
In the Appendix, Table 4 lists posterior medians with HPD 95% CIs for the main parameters of interest. The positive values for β1 (0.21, 95% CI = [-0.09, 0.54]) and β2 (0.45, 95%
CI = [0.11, 0.77]) suggest that the IR increases with increasing time since the initial disease
outbreak, and with increasing time between the first reported infection and the imposition of
social distancing measures. The positive value for β3 (0.77, 95% CI = [0.50, 1.03]) suggests
that a higher population density is associated with a higher IR. The negative value for θ2
(-0.43, 95% CI = [-0.63, -0.25]) suggests that countries with fewer hospital beds have higher
IFRs.
We were quite surprised to see that our estimate of θ1 (0.00, 95% CI = [-0.16, 0.17]) was
not decidedly larger and positive given that age is known to be an important predictor of
COVID-19 complications and death (O’Driscoll et al., 2020). There are several reasons why
we might have obtained this result. First, statistical power may have been compromised by
insufficient heterogeneity in the age-structure across different countries, as captured by the

18

proportion aged over 70 metric. Furthermore, as with a standard multivariable regression of
observational data, the estimate of θ1 may suffer from bias due to unobserved confounding
and/or multicollinearity.
Note that the overall IFR estimate and its uncertainty are very similar whether or not
the data from nationally reported statistics are included in the analysis (only sero-studies:
g−1 (θ) = 0.54%, 95% C.I. = [0.41%, 0.68%] vs. all data: g−1 (θ) = 0.53%, 95% C.I. =

[0.39%, 0.69%]). One might therefore question what added value the expanded analysis provides. We have two comments on this point.
First, since we did not incorporate any substantial prior information about the magnitude of
preferential testing into the model (i.e., we selected very “weakly informative” priors for the
φ parameters), we should not expect the point estimate of θ to differ substantially between the

two analyses. In fact, if the difference between the two point estimates was substantial, we
might reasonably question whether the priors were appropriately specified. Since our only
unbiased information about the magnitude of the IFR comes from the five seroprevalence
studies, a large discrepancy between the two estimates might indicate that our supposedly
“weakly informative” priors are not as weak as intended.
Second, even if the estimate for the overall IFR is left unchanged, incorporating the additional data into an expanded analysis is still worthwhile. Simulation study results (see Section
5.2) show that a considerable sharpening of information is possible in many scenarios. Without actually implementing the expanded analysis, it would be impossible to know whether
or not such a sharpening would occur in the present context. Moreover, unlike the analysis
which uses only seroprevalence study data, the expanded analysis allows one to obtain valuable country-specific IFR and IR estimates, as well as obtain estimates for the association
between the IFR/IR and a number of different explanatory factors.
The model can no doubt be improved by using appropriately specified informed priors
for the φ parameters based on what is known about COVID-19 testing in different countries.
For example, in related work, Grewelle and De Leo (2020) assume that testing capacity is
directly proportional to the case load in each country (where testing capacity is estimated by
tests performed per positive case4 ). As another example, the “H2 index” (Hale et al., 2020),
which purportedly reflects official government policy on who has access to testing within a
4

Grewelle and De Leo (2020) are thereby able to infer the “global IFR” using simple weighted linear regres-

sion (i.e., regressing log(Dk /CCk ) ∼ log(IF Rk ) + β1 (CCk /Tk ), for k = 1, . . . , K, where β1 is an unknown
nuisance parameter).

BAYESIAN ADJUSTMENT FOR PREFERENTIAL TESTING IN ESTIMATING THE COVID-19 IFR 19
16.6 [11.4,22.2]

1- Gangelt

0.29 [0.17,0.46]

10 [7.7,12.7]

2- Geneva

0.48 [0.37,0.63]

2.2 [1.5,2.9]

3- Luxembourg

0.65 [0.45,0.91]

1.4 [0.9,2]

4- Split-Dalmatia

0.44 [0.31,0.65]

1.3 [0.8,1.7]

5- Zurich

0.64 [0.45,0.88]

2.2 [1.2,3.3]

6- Austria
7- Bulgaria

0.5 [0.3,0.7]

8- Croatia

0.7 [0.4,1.2]

9- Czech Republic

0.8 [0.4,1.3]

10- Denmark

0.8 [0.4,1.4]

11- Estonia

0.8 [0.4,1.3]

12- Finland

0.7 [0.4,1.2]

0.31 [0.19,0.52]
0.31 [0.17,0.47]
0.37 [0.18,0.53]
0.34 [0.18,0.54]
1.15 [0.51,1.83]
0.55 [0.3,0.85]
0.78 [0.38,1.14]

3.6 [2.1,5.7]

13- Germany

0.26 [0.16,0.43]

0.4 [0.2,0.6]

14- Greece

0.43 [0.23,0.67]

1.3 [0.8,2.2]

15- Hungary

0.35 [0.19,0.55]

0.4 [0.2,0.8]

16- Iceland

0.88 [0.4,1.41]

2.9 [1.6,4.8]

17- Ireland

1.06 [0.55,1.69]

5.7 [2.7,8.7]

18- Italy
19- Latvia

0.3 [0.1,0.4]

20- Lithuania

0.6 [0.3,0.9]

0.91 [0.55,1.55]
0.41 [0.24,0.64]

21- Luxembourg

2.6 [1.5,4.4]

22- Netherlands

4 [2.2,6.4]

23- Norway

0.6 [0.4,1.1]

24- Poland

0.7 [0.4,1.1]

25- Portugal

1.4 [0.7,2.2]

26- Romania

1.6 [0.8,2.6]

0.35 [0.21,0.55]
0.61 [0.35,0.98]
0.83 [0.47,1.34]
0.7 [0.36,1.03]
0.35 [0.16,0.52]
0.83 [0.42,1.41]
0.35 [0.18,0.55]

0.2 [0.1,0.3]

27- Slovakia

0.34 [0.15,0.55]

0.9 [0.5,1.3]

28- Slovenia

0.57 [0.28,0.86]

6 [2.9,9.7]

29- Spain

1 [0.55,1.73]

3.1 [1.7,4.7]

30- Switzerland

0.6 [0.34,0.95]

4.4 [2.2,7.5]

31- U.K.

1.13 [0.53,1.82]

1.5 [1,2.1]

Overall
0

0.53 [0.39,0.69]

10

20

IR (%)

30

0.0

0.5

1.0

1.5

IFR (%)

F IG 3. Posterior median estimates for the IRk and IF Rk variables (for k = 1, . . . , 31) with 95% HPD CIs. Also
plotted, under the label “Overall”, is the posterior median estimate and 95% HDP CI of g−1 (β) and g−1 (θ).
These results correspond to the large-P model with η = 0.1 which pools information from five seroprevalence
0
studies and data from nationally reported statistics for 26 European countries (K = 31 and k = 5).

given country, could also be used to define informed priors for the φ parameters in a more
sophisticated version of our model.
We were curious as to whether the model estimates (posterior medians) we obtained for
φk (for k = 6, . . . , 31) might be predictive of the H2 index. Using the data made available

by Hale et al. (2020), we calculated the average H2 index for each country in our analysis,

20

for the period between February 1st, 2020 and April 1st, 2020. Roughly speaking, a high H2
value indicates broad access to testing (i.e., available to the general public) whereas a low H2
value reflects a testing policy that restricts testing to only those who have symptoms or meet
specific criteria. Thus, countries with high H2 values should, in theory, have small values
of φk and vice-versa. That prediction is generally supported by the results seen in Figure 4,
although Iceland, Slovakia and Croatia appear to be exceptions.

Italy

1.5

Austria

Portugal

H2 index

Lithuania

1.0

Germany

Spain

United Kingdom
Slovenia

Iceland

Ireland

Latvia

Slovakia

Netherlands

Croatia

Switzerland
Luxembourg

Finland

Hungary

Norway

Czech Republic

0.5

Denmark

Population

Poland

40m
15m
5m

Bulgaria

Estonia

Romania

0.0

Greece

2.5

5.0

φk

7.5

F IG 4. Scatter-plot shows of the average H2 index for each country (for the period between February 1st, 2020
and April 1st, 2020) vs. the posterior median φk value. Circle size corresponds to population (Pk ). These results
correspond to the large-P model with η = 0.1 which pools information from five seroprevalence studies and data
from nationally reported statistics for 26 European countries.

7. Discussion.
7.1. Model limitations. Estimation of the IFR is very challenging due to the fact that it
is a ratio of numbers where both the numerator and denominator are subject to a wide range
of biases. Our proposed model seeks to address only one particular type of bias pertaining

BAYESIAN ADJUSTMENT FOR PREFERENTIAL TESTING IN ESTIMATING THE COVID-19 IFR 21

to the denominator: the bias in the number of cases due to preferential testing. With this in
mind, we wish to call attention to several other important sources of bias.
Cause of death information may be very inaccurate. To overcome this issue, many suggest
looking to “excess deaths,” by comparing aggregate data for all-cause deaths from the time
during the pandemic to the years prior (Leon et al., 2020). Using this approach and a simple Bayesian binomial model, Rinaldi and Paradisi (2020) are able to obtain IFR estimates
without relying on official (possibly inaccurate) data for the number of COVID-19 deaths.
Some people who are currently sick will eventually die of the disease, but have not died
yet. Due to the delay between disease onset and death, the number of confirmed and reported
COVID-19 deaths at a certain point in time will not reflect the total number of deaths that
will occur among those already infected (right-censoring). This will result in the number of
recorded deaths underestimating the true risk of death. The denominator of the IFR must be
the number of cases with known outcomes.
The model assumes that no individuals are tested more than once. This is an important
practical limitation. In addition, the model, as currently proposed, fails to account for the
(unknown) number of false positive and false negative tests. When both the test specificity
and the infection rate is low, false positives can substantially inflate the estimated infection
rate and as a consequence, the IFR could be biased downwards. In principle, the model could
accommodate for this by specifying priors for test sensitivity and specificity; see Kümmerer
et al. (2020); Gelman and Carpenter (2020) and Neil et al. (2020).
Finally, because the model uses data that are aggregated at the group level, estimates are
potentially subject to ecological bias (Pearce, 2000). While including group-level covariates
may help reduce variability in the estimates, adjustment using group-level covariates can also
lead to misleading results (Li and Hua, 2020).
7.2. Concluding remarks. Obtaining representative data remains challenging and costly.
Efforts to better understand the distribution of SARS-CoV-2 infection (and its lethality) at the
population level have unfortunately been met by recruiting challenges (Gudbjartsson et al.,
2020; Bendavid et al., 2020), leading to an over-representation of people who are concerned
about their exposure and/or an under-representation of individuals who are self-quarantining,
isolating, or hospitalized because of the virus. In the absence of large-scale unbiased data,
researchers must work with whatever data is available. Our model suggests a coherent and
feasible way to do just this.

22

We demonstrated our proposed model with an application to European COVID-19 data,
in which we relied on data from seroprevalence studies that self-reported as representative.
When combined with data from nationally reported statistics, this data enabled us to obtain
appropriate estimates for not only the overall IFR but also for country-specific IFRs and IRs,
as well as for the association between these and various explanatory factors.
We note that our estimate for the overall IFR in Europe (0.53%, 95% C.I. = [0.39%,
0.69%]) is somewhat lower than an estimate obtained by the meta-analysis of MeyerowitzKatz and Merone (2020) from European seroprevalence studies (IFR = 0.77%, 95% C.I.
= [0.55%, 0.99%]) and reiterate that the primary intention of our analysis was to demonstrate the feasibility of the proposed model. That being said, we selected the five seroprevalence studies based on the review of Ioannidis (2020a) and suspect that the differing inclusion/exclusion criteria between Ioannidis (2020a) and Meyerowitz-Katz and Merone (2020)
are the main reason why our estimates are not more similar. A recent large-scale analysis
for Spain, based on a nationwide population-based seroprevalence study (Pollán et al., 2020)
concludes that, for the Spanish population, “overall infection fatality risk was 0.8% [...] for
confirmed COVID-19 deaths and 1.1% [...] for excess deaths [...]” (Pastor-Barriuso et al.,
2020). This is in reasonable agreement with our estimate for Spain of 1.00% (95% credible
interval of [0.55%, 1.73%]).
In a similar study, O’Driscoll et al. (2020) conduct a Bayesian analysis using data from
22 national-level seroprevalence surveys and sex and age-specific COVID-19-associated
death data from 45 countries. Their data is much more granular and their model specifies
many more detailed assumptions. For example, O’Driscoll et al. (2020) assume “a gammadistributed delay between onset [of infection] and death” and assume different risks of infection for “individuals aged 65 years and older, relative to those under 65” since “older
individuals have fewer social contacts and are more likely to be isolated through shielding
programmes”. O’Driscoll et al. (2020) conclude that “population-weighted IFR estimates
by the ensemble model are highest for countries with older populations such as [...] Italy
(0.94%; 95% credible interval, 0.80–1.08%).” While our model did not identify a significant
association between IFR and countries with older populations (much to our surprise), many
of our country-specific IFR estimates are quite similar to those reported in O’Driscoll et al.
(2020). For example, we obtained a IFR for Italy of 0.91% (95% credible interval of [0.55%,
1.55%]).

BAYESIAN ADJUSTMENT FOR PREFERENTIAL TESTING IN ESTIMATING THE COVID-19 IFR 23

In the Introduction, we identified two important questions. First (Q1), is it possible to
reliably estimate the IFR without any information about the degree to which the data are
biased by preferential testing? And second (Q2), when representative samples are available,
can samples with an unknown degree of preferential testing contribute valuable information?
The proposed Bayesian model suggests that reliable estimation of the IFR at the group level
is indeed possible, to a certain extent, when existing data do not arise from a random sample
from the target population. Importantly, the key to (partial) identifiability is sufficient heterogeneity in the degree of preferential testing across groups and sufficient homogeneity in
the group-specific IFR. We also saw that combining both types of data (biased and unbiased
data) can be superior to ignoring data that may be skewed by preferential testing. When fit
with an appropriate model, biased data can supplement available representative data in order
to refine one’s inference and/or shed light on the impact of explanatory factors.
In a typical situation of drawing inference from a single biased sample, obtaining appropriate estimates is challenging, if not impossible, without some sort of external validation
data. Intuition suggests that one might only be able to do a sensitivity analysis with respect to
the impact of bias. Indeed, applying prior distributions for the degree of preferential testing
and proceeding with Bayesian inference could be regarded as a probabilistic form of sensitivity analysis (Greenland, 2005). What is perhaps less intuitive, and what we demonstrated
with the proposed model, is that, if one has multiple samples of biased data, each subject to a
different degree of bias, the “heterogeneity of bias” can help inform what overall adjustment
is required for appropriate inference.
The aggregation of data from both biased and unbiased samples is a problem that applies to
many types of evidence synthesis (and is often overlooked) (De Angelis et al., 2015; Birrell
et al., 2018). In that sense, the solutions we put forward may be more broadly applicable.
Future work should investigate whether the “heterogeneity of bias” principle (see Section
8.2) can be used to derive appropriate estimates in a meta-analysis where individual studies
are subject to varying degrees of bias due to unobserved confounding or measurement error
(e.g., Campbell et al. (2020)).
REFERENCES
Anderson, R. M., Heesterbeek, H., Klinkenberg, D., and Hollingsworth, T. D. (2020). How will country-based
mitigation measures influence the course of the COVID-19 epidemic? The Lancet, 395(10228):931–934.
Bendavid, E., Mulaney, B., Sood, N., Shah, S., Ling, E., Bromley-Dulfano, R., Lai, C., Weissberg, Z., Saavedra,
R., Tedrow, J., et al. (2020). COVID-19 antibody seroprevalence in Santa Clara County, California. medRxiv.

24
Berger, J. O. (2013). Statistical decision theory and Bayesian analysis. Springer Science & Business Media.
Birrell, P. J., De Angelis, D., and Presanis, A. M. (2018). Evidence synthesis for stochastic epidemic models.
Statistical Science: a review journal of the Institute of Mathematical Statistics, 33(1):34.
Brooks, S. P. and Gelman, A. (1998). General methods for monitoring convergence of iterative simulations.
Journal of Computational and Graphical Statistics, 7(4):434–455.
Campbell, H., de Jong, V. M., Maxwell, L., Debray, T., Jaenisch, T., and Gustafson, P. (2020). Measurement error in meta-analysis (MEMA)–a Bayesian framework for continuous outcome data. arXiv preprint
arXiv:2011.07186.
Carpenter, B., Gelman, A., Hoffman, M. D., Lee, D., Goodrich, B., Betancourt, M., Brubaker, M., Guo, J., Li, P.,
and Riddell, A. (2017). Stan: A probabilistic programming language. Journal of Statistical Software, 76(1).
Cochran, J. J. (2020). Why we need more coronavirus tests than we think. Significance.
De Angelis, D., Presanis, A. M., Birrell, P. J., Tomba, G. S., and House, T. (2015). Four key challenges in
infectious disease modelling using data from multiple sources. Epidemics, 10:83–87.
De Smedt, T., Merrall, E., Macina, D., Perez-Vilar, S., Andrews, N., and Bollaerts, K. (2018). Bias due to
differential and non-differential disease-and exposure misclassification in studies of vaccine effectiveness. PloS
One, 13(6).
de Valpine, P., Turek, D., Paciorek, C. J., Anderson-Bergman, C., Lang, D. T., and Bodik, R. (2017). Programming
with models: writing statistical algorithms for general model structures with nimble. Journal of Computational
and Graphical Statistics, 26(2):403–413.
Emmenegger, M., De Cecco, E., Lamparter, D., Jacquat, R. P., Ebner, D., Schneider, M. M., Morales, I. C.,
Schneider, D., Dogancay, B., Guo, J., et al. (2020). Early plateau of sars-cov-2 seroprevalence identified by
tripartite immunoassay in a large population. medRxiv.
Faust, J. S. (2020). Comparing COVID-19 deaths to flu deaths is like comparing apples to oranges. Scientific
American, https://tinyurl.com/ydxx8el8.
Fog, A. (2008). Sampling methods for Wallenius’ and Fisher’s noncentral hypergeometric distributions. Communications in Statistics - Simulation and Computation, 37(2):241–257.
Gelman, A. and Carpenter, B. (2020). Bayesian analysis of tests with unknown specificity and sensitivity. Journal
of the Royal Statistical Society: Series C (Applied Statistics), 69(5):1269–1283.
Gelman, A., Rubin, D. B., et al. (1992). Inference from iterative simulation using multiple sequences. Statistical
Science, 7(4):457–472.
Greenland, S. (2005). Multiple-bias modelling for analysis of observational data. Journal of the Royal Statistical
Society: Series A (Statistics in Society), 168(2):267–306.
Grewelle, R. and De Leo, G. (2020). Estimating the global infection fatality rate of COVID-19. medRxiv.
Gudbjartsson, D. F., Helgason, A., Jonsson, H., Magnusson, O. T., Melsted, P., Norddahl, G. L., Saemundsdottir,
J., Sigurdsson, A., Sulem, P., Agustsdottir, A. B., et al. (2020). Spread of sars-cov-2 in the icelandic population.
New England Journal of Medicine.
Gustafson, P. (2010). Bayesian inference for partially identified models. The International Journal of Biostatistics,
6(2).
Gustafson, P., Greenland, S., et al. (2009). Interval estimation for messy observational data. Statistical Science,
24(3):328–342.

BAYESIAN ADJUSTMENT FOR PREFERENTIAL TESTING IN ESTIMATING THE COVID-19 IFR 25
Hale, T., Webster, S., Petherick, A., Phillips, T., and Kira, B. (2020).
ernment response tracker.

Oxford COVID-19 gov-

https://www.bsg.ox.ac.uk/research/research-projects/

coronavirus-government-response-tracker#data.
Hauser, A., Counotte, M. J., Margossian, C. C., Konstantinoudis, G., Low, N., Althaus, C. L., and Riou, J. (2020).
Estimation of sars-cov-2 mortality during the early stages of an epidemic: a modelling study in Hubei, China
and northern Italy. medRxiv.
Ioannidis, J. (2020a). The infection fatality rate of COVID-19 inferred from seroprevalence data (version 2 (June
8, 2020 - 14:00)). medRxiv.
Ioannidis, J. P. (2020b). First Opinion: A fiasco in the making? as the coronavirus pandemic takes hold, we are
making decisions without reliable data. STAT, March, 2020, https://tinyurl.com/uj539o4.
Jerkovic, I., Ljubic, T., Basic, Z., Kruzic, I., Kunac, N., Bezic, J., Vuko, A., Markotic, A., and Andjelinovic, S.
(2020). Sars-cov-2 antibody seroprevalence in industry workers in split-dalmatia and sibenik-knin county,
croatia. medRxiv.
Kobayashi, T., Jung, S.-m., Linton, N. M., Kinoshita, R., Hayashi, K., Miyama, T., Anzai, A., Yang, Y., Yuan,
B., Akhmetzhanov, A. R., et al. (2020). Communicating the risk of death from novel coronavirus disease
(COVID-19).
Kruschke, J. (2014). Doing Bayesian data analysis: A tutorial with R, JAGS, and Stan. Academic Press.
Kümmerer, M., Berens, P., and Macke, J. (2020). A simple bayesian analysis of the infection fatality rate in
gangelt, and an uncertainty aware extrapolation to infection-counts in Germany. https://matthias-k.
github.io/BayesianHeinsberg.html.
Lambert, P. C., Sutton, A. J., Burton, P. R., Abrams, K. R., and Jones, D. R. (2005). How vague is vague? A
simulation study of the impact of the use of vague prior distributions in mcmc using winbugs. Statistics in
Medicine, 24(15):2401–2428.
Lee, G. (2020). Coronavirus: Why so many people are dying in Belgium. BBC.com, https://www.bbc.
com/news/world-europe-52491210.
Leon, D. A., Shkolnikov, V. M., Smeeth, L., Magnus, P., Pechholdová, M., and Jarvis, C. I. (2020). COVID-19:
a need for real-time monitoring of weekly excess deaths. The Lancet, 395(10234):e81.
Li, S. and Hua, X. (2020). The closer to the Europe Union headquarters, the higher risk of COVID-19? Cautions
regarding ecological studies of COVID-19. medRxiv.
Linton, N. M., Kobayashi, T., Yang, Y., Hayashi, K., Akhmetzhanov, A. R., Jung, S.-m., Yuan, B., Kinoshita, R.,
and Nishiura, H. (2020). Incubation period and other epidemiological characteristics of 2019 novel coronavirus infections with right truncation: a statistical analysis of publicly available case data. Journal of Clinical
Medicine, 9(2):538.
Lipsitch, M. (2020). First Opinion: We know enough now to act decisively against COVID-19. social distancing
is a good place to start. STAT, https://tinyurl.com/yx4gf9mr.
Lyons, N. (1980). M29. closed expressions for noncentral hypergeometric probabilities. Communications in
Statistics - Simulation and Computation, 9(3):313–314.
Manski, C. F. (2003). Partial identification of probability distributions. Springer Science & Business Media.
Meyerowitz-Katz, G. and Merone, L. (2020). A systematic review and meta-analysis of published research data
on COVID-19 infection-fatality rates (version 4). medRxiv.

26
Morris, T. P., White, I. R., and Crowther, M. J. (2019). Using simulation studies to evaluate statistical methods.
Statistics in Medicine, 38(11):2074–2102.
Neil, M., Fenton, N., Osman, M., and McLachlan, S. (2020). Bayesian network analysis of COVID-19 data
reveals higher infection prevalence rates and lower fatality rates than widely reported. medRxiv.
O’Driscoll, M., Dos Santos, G. R., Wang, L., Cummings, D. A., Azman, A. S., Paireau, J., Fontanet, A.,
Cauchemez, S., and Salje, H. (2020). Age-specific mortality and immunity patterns of sars-cov-2. Nature,
pages 1–6.
Onder, G., Rezza, G., and Brusaferro, S. (2020). Case-fatality rate and characteristics of patients dying in relation
to COVID-19 in Italy. JAMA.
OWID, O. W. I. D. (2020).
dataset.

Codebook for the complete our world in data COVID-19

https://github.com/owid/covid-19-data/blob/master/public/data/

owid-covid-data-codebook.md.
Pastor-Barriuso, R., Pérez-Gómez, B., Hernán, M. A., Pérez-Olmeda, M., Yotti, R., Oteo-Iglesias, J., Sanmartín,
J. L., León-Gómez, I., Fernández-García, A., Fernández-Navarro, P., et al. (2020). Infection fatality risk for
sars-cov-2 in community dwelling population of spain: nationwide seroepidemiological study. The BMJ, 371.
Pearce, N. (2000). The ecological fallacy strikes back. Journal of Epidemiology & Community Health, 54(5):326–
327.
Pellis, L., Cauchemez, S., Ferguson, N. M., and Fraser, C. (2020). Systematic selection between age and household structure for models aimed at emerging epidemic predictions. Nature Communications, 11(1):1–11.
Perez-Saez, J., Lauer, S. A., Kaiser, L., Regard, S., Delaporte, E., Guessous, I., Stringhini, S., Azman, A. S.,
Group, S.-P. S., et al. (2020). Serology-informed estimates of sars-cov-2 infection fatality risk in Geneva,
Switzerland. medRxiv.
Pollán, M., Pérez-Gómez, B., Pastor-Barriuso, R., Oteo, J., Hernán, M. A., Pérez-Olmeda, M., Sanmartín, J. L.,
Fernández-García, A., Cruz, I., de Larrea, N. F., et al. (2020). Prevalence of sars-cov-2 in spain (ENE-COVID):
a nationwide, population-based seroepidemiological study. The Lancet.
Presanis, A. M., De Angelis, D., Flu, T. N. Y. C. S., Team, I., Hagy, A., Reed, C., Riley, S., Cooper, B. S., Finelli,
L., Biedrzycki, P., et al. (2009). The severity of pandemic H1N1 influenza in the united states, from April to
July 2009: a Bayesian analysis. PLoS Medicine, 6(12).
Prochaska, C. and Theodore, L. (2018). Discrete probability distributions. Introduction to Mathematical Methods
for Environmental Engineers and Scientists, page 287.
Rinaldi, G. and Paradisi, M. (2020). An empirical estimate of the infection fatality rate of COVID-19 from the
first Italian outbreak. medRxiv.
Sahai, H. and Khurshid, A. (1995). Statistics in epidemiology: methods, techniques and applications. CRC press.
Snoeck, C. J., Vaillant, M., Abdelrahman, T., Satagopam, V. P., Turner, J. D., Beaumont, K., Gomes, C. P., Fritz,
J. V., Schröder, V. E., Kaysen, A., et al. (2020). Prevalence of sars-cov-2 infection in the luxembourgish
population: the CON-VINCE study. medRxiv.
Stevens, W. (1951). Mean and variance of an entry in a contingency table. Biometrika, 38(3/4):468–470.
Streeck, H., Schulte, B., Kuemmerer, B., Richter, E., Höller, T., Fuhrmann, C., Bartok, E., Dolscheid, R., Berger,
M., Wessendorf, L., et al. (2020). Infection fatality rate of sars-cov-2 infection in a german community with a
super-spreading event. medRxiv.

BAYESIAN ADJUSTMENT FOR PREFERENTIAL TESTING IN ESTIMATING THE COVID-19 IFR 27
Stringhini, S., Wisniak, A., Piumatti, G., Azman, A. S., Lauer, S. A., Baysson, H., De Ridder, D., Petrovic,
D., Schrempft, S., Marcus, K., et al. (2020). Seroprevalence of anti-sars-cov-2 igg antibodies in Geneva,
Switzerland (serocov-pop): a population-based study. The Lancet.
Thompson, S. G. and Higgins, J. P. (2002). How should meta-regression analyses be undertaken and interpreted?
Statistics in Medicine, 21(11):1559–1573.
Wong, J. Y., Heath Kelly, D. K., Wu, J. T., Leung, G. M., and Cowling, B. J. (2013). Case fatality risk of influenza
A (H1N1pdm09): a systematic review. Epidemiology (Cambridge, Mass.), 24(6).
Wu, J. T., Leung, K., Bushman, M., Kishore, N., Niehus, R., de Salazar, P. M., Cowling, B. J., Lipsitch, M., and
Leung, G. M. (2020). Estimating clinical severity of COVID-19 from the transmission dynamics in Wuhan,
China. Nature Medicine, 26(4):506–510.

28

8. Appendix.
8.1. Details for the non-central hyper-geometric distribution. In Section 2.1, we consider the distribution of CC|C as following Wallenius’ non-central hyper-geometric (NCHG)
distribution such that:
CC|C ∼ N CHyperGeo(C, P − C, T, φ),

(12)

where the degree of preferential testing corresponds to the φ non-centrality parameter. The
probability mass function of this distribution (Lyons, 1980; Fog, 2008) can be written out as:
(13)

C
f (x) =
x

!

P −C
T −x

!Z

1

(1 − tφk /B )x (1 − t1/B )T −x d t

0

where B = ω(C − x) + (P − C − (T − x)). Note that when the non-centrality parameter, φ,
equals 1, the distribution is equivalent to the standard central hypergeometric distribution.
Wallenius’ noncentral hypergeometric is often confused with Fisher’s noncentral hypergeometric distribution. Wallenius’ noncentral hypergeometric distribution describes the situation where a predetermined number of items are seleted one by one, whereas Fisher’s
noncentral hypergeometric distribution describes a situation where the total number of items
drawn is only known after the experiment.
8.2. Issues of (un)identifiability. Table 1 provides a small artificial dataset to help illustrate the type of data being described and the impact of different degrees of preferential
testing. In this dataset, we have K = 12 groups and the (unknown) infection rate varies substantially from 13% to 53%. The unknown infection fatality rate only varies slightly, from
0.017% to 0.022%. Values for φk in this dataset are evenly distributed between 1 and γ + 1,
for four different values of γ = 0, 4, 11, and 22. When γ = 0, the number of true cases (i.e.
actual infections) is approximately 14 times higher than the number of confirmed cases. In
contrast, when γ = 22, the number of true cases is only about 5 times higher than the number
of confirmed cases.
Here we present an asymptotic argument which lays bare the flow of information. Consider
a situation in which an infinite amount data are available. In so-called “asymptotia,” we have
that populations are approaching infinite size (i.e., for k = 1,. . . , K , we have Pk → ∞),
and that the number of tests also approaches infinity (i.e., for k = 1,. . . , K , we have Tk →
∞). Recall that a hyper-geometric distribution is asymptotically equivalent to a binomial

distribution. As such, we consider the following approximation (as in Section 4.1):
Dk ∼ Binom(Pk , ak )

;

and

CCk ∼ Binom(Tk , bk ),

BAYESIAN ADJUSTMENT FOR PREFERENTIAL TESTING IN ESTIMATING THE COVID-19 IFR 29
11
22 Unobserved
γ = 4 11 22
CCk CCk
Ck
IRk IF Rk
φk φk φk
32
27 430 0.140
0.018
1
1
1
12
24
99 0.206
0.020
1.36
2
3
55
74 570 0.303
0.022
1.73
3
5
33
38 193 0.190
0.017
2.09
4
7
54
67 201 0.159
0.021
2.45
5
9
140
162 484 0.132
0.021
2.82
6
11
70
94 329 0.137
0.019
3.18
7
13
68
77 565 0.526
0.019
3.55
8
15
205
247 821 0.212
0.019
3.91
9
17
11
8
24 0.160
0.019
4.27
10
19
16
18
70 0.164
0.019
4.64
11
21
31
33 105 0.245
0.019
5
12
23
TABLE 1
Illustrative Example Data, with varying degrees of preferential sampling, γ = 0, γ = 4, γ = 11, and γ = 22.
k
1
2
3
4
5
6
7
8
9
10
11
12

Observed
Pk
Tk
3061 190
482
43
1882 101
1016
67
1269 109
3670 276
2409 139
1074
81
3868 289
151
13
430
25
429
40

Dk
11
2
20
2
4
9
7
13
16
2
1
2

γ=0
CCk
24
15
32
14
13
53
17
42
60
1
6
11

4
CCk
21
11
40
24
34
70
34
65
142
5
9
23

where ak = IF Rk × IRk and bk = 1 − (1 − IRk )φk .
Presume that the a priori defensible information about the preferential sampling in the
k -th group is expressed in the form

(14)

φk ∈ [φk , φ̄k ],

i.e., φk and φ̄k are investigator-specified bounds on the degree of preferential sampling for
that jurisdiction. If one is certain that cases are as likely, or at least as likely, to be tested as
non-cases, φk = 1 is appropriate. If testing is known to be entirely random for the k -th group,
one would set φk = φ̄k = 1.
Note that for fixed (ak , bk ), IF Rk is a function of φk with the form
(15)

IF Rk (φk ) =

ak
.
1 − (1 − bk )(1/φk )

Examining (15), knowledge of (ak , bk ), in tandem with (14) restricts the set of possible values
for IF Rk . In fact it is easy to verify that (15) is monotone in φk , hence the restricted set is
an interval. We write this interval as Ik (ak , bk , φk , φ̄k ), or simply as Ik for brevity. This is the
jurisdiction-specific identification interval for IF Rk . As we approach asymptotia for the k th group, all values inside the interval remain plausible, while all values outside are ruled out;
see Manski (2003). This is the essence of the partial identification inherent to this problem.
Thinking now about the meta-analytic task of combining information, we envision that
both φk and IRk could exhibit considerable variation across jurisdictions. However, the variation in IF R could be small, particularly if sufficient jurisdiction-specific covariates are included (see Section 4.2). That is, after adjustment for a jurisdiction’s age-distribution, healthcare capacity, and so on, residual variation in IF R could be very modest. When modeling,
we would invoke such an assumption via a prior distribution. For understanding in asympto-

30

tia, however, we simply consider the impact of an a priori bound on the variability in IF R.
Let τ be the standard deviation of IF R across jurisdictions. Then we presume τ does not
exceed an investigator-specified upper bound of τ̄ , i.e., τ ≤ τ̄ .
The jurisdiction-specific prior bounds on the extent of preferential sampling, and the prior
bound on IF R variation across jurisdictions, along with the limiting signal from the data in
the form of (a, b), gives rise to an identification region for the average infection fatality rate,
IF R = K −1

PK

k=1 IF Rk .

Formally, this interval is defined as

n

o

(16) I(a, b, φ, φ̄, τ̄ ) = IF R : τ ≤ τ̄ , IF Rk ∈ Ik (ak , bk , φk , φ̄k ), ∀k ∈ {1, . . . , K} .
Again, the interpretation is direct: in the asymptotic limit, all values of IF R inside this
interval are compatible with the observed data, and all values outside are not. The primary
question of interest is whether this interval is narrow or wide under realistic scenarios, since
this governs the extent to which we can learn about IF R from the data.
In general, evaluating (16) for given inputs is an exercise in quadratic programming nested
within a grid search, hence can be handled with standard numerical optimisation. However,
the special case of τ̄ = 0 is noteworthy in terms of developing both scientific and mathematical intuition. Consequently, we explore this case in some depth in what follows.
Scientifically, τ̄ = 0 represents the extreme limit of an a priori assumption that, possibly
after covariate adjustment, IF R is a ‘biological constant’ which does not vary across jurisdictions. If the prospects for inference are not good when this assumption holds, they will be
even less good under the less strict assumption that the IF R heterogeneity is small, but not
necessarily zero. Mathematically, the case is much simpler, with (16) reducing to
(17)

I(a, b, φ, φ̄, 0) = ∩k Ik (ak , bk , φk , φ̄k ).

As intuition must have it, without heterogeneity, a putative value for the ‘global’ IFR is
compatible with the observed data if and only if it is compatible with the data from every
jurisdiction individually.
To illustrate, consider a scenario with K = 12 jurisdictions, with a constant infection fatality rate of 2%, i.e., IF Rk = 0.02, for k = 1, . . . , 12. Say that the infection rates for these
jurisdictions lie between 0.132 and 0.526, as per Table 1. Furthermore, say that the unknown
φk values range between 1 and 23, as per the rightmost column (γ = 22) of Table 1.

Now say the investigator pre-specifies (φk , φ̄k ) = (1, 40) for all k . As such, the a priori bounds are correct, for all jurisdictions. The resulting jurisdiction-specific identification
intervals, Ik , are depicted in the bottom left-hand panel of Figure 5. (The top and middle left-

BAYESIAN ADJUSTMENT FOR PREFERENTIAL TESTING IN ESTIMATING THE COVID-19 IFR 31
γ = 4, τ = 0.002

0.25

0.25

0.20

0.20

0.15

0.15

IFR

IFR

γ = 4, τ = 0

0.10
0.05

0.05

0.00

0.00
2

3

4

5

6

7

8

9

10 11 12

1

2

3

4

5

6

7

8

k

k

γ = 11, τ = 0

γ = 11, τ = 0.002

0.25

0.25

0.20

0.20

0.15

0.15

IFR

IFR

1

0.10
0.05

9

10 11 12

9

10 11 12

9

10 11 12

0.10
0.05

0.00

0.00
1

2

3

4

5

6

7

8

9

10 11 12

1

2

3

4

5

6

7

8

k

k

γ = 22, τ = 0

γ = 22, τ = 0.002

0.25

0.25

0.20

0.20

0.15

0.15

IFR

IFR

0.10

0.10
0.05

0.10
0.05

0.00

0.00
1

2

3

4

5

6

7

8

9

10 11 12

k

1

2

3

4

5

6

7

8

k

F IG 5. Consider the meta-analytic task of combining information in a scenario with K = 12 jurisdictions. Here
the black lines correspond to jurisdiction-specific identification intervals for the IFR and the grey rectangles
corresponds to the global identification interval for IFR. Left-hand panels correspond to assumption of τ̄ = 0
such the global identification interval is simply the intersection of the individual intervals. Right-hand panels
correspond to τ̄ = 0.002.

hand panels correspond to the identical situation but with φk values listed in the γ = 4 and
γ = 11 columns of Table 1 respectively.) Also depicted by the grey rectangle is the global

identification interval, i.e., the intersection of the individual intervals. In the present scenario
(γ = 22), this is indeed narrow, ranging from 0.0200 to 0.0328. (For the γ = 4, γ = 11 and
γ = 22 scenarios, the global identification intervals are [0.0200, 0.1419], [0.0200, 0.0606],

and [0.0200, 0.0328], respectively.) Thus, depending on the range in φk values, i.e., depending on the “heterogeneity of bias”, it appears that data can contribute substantial information
about the (constant) infection fatality rate.
As can be seen immediately from Figure 5 (left-hand panels), in the present example
the binding constraints arise from the first and twelfth jurisdictions, which happen to have

32

the least and most amounts of preferential testing. However, this pattern does not hold in
general. One can easily construct pairs of infection rates for which the jurisdiction with more
preferential testing has a smaller upper endpoint for Ik and/or a larger lower endpoint. Thus
the values of φk alone do not determine which two jurisdictions will provide the binding
information about IF R.
Figure 5 (right-hand panels) shows how the global identification interval is wider when
τ = 0.002. For reference, for the IFR values listed in Table 1, τ = SD(IF R1:12 ) = 0.00124.

For the γ = 4, γ = 11, and γ = 22 scenarios, the global identification intervals outlined by
the grey rectangles are [0.0139, 0.1483], [0.0137, 0.0670] and [0.0137, 0.0386], respectively.
Now consider the evaluation of (16) for τ > 0, i.e., where a limited heterogeneity in IF R
is permitted. Recall that quadratic programming constitutes the minimization of a quadratic
function subject to linear constraints, and these may be a mix of equality and inequality
constraints. Let x be a candidate value, which we will test for membership in the identification
interval. To perform this test, we use a standard quadratic programming package (quadprog)
to minimize the quadratic function V ar(IF R), subject to the equality constraint IF R = x
and the 2K inequality constraints which restrict IF Rk to the interval Ik for each k . By the
definition of (6) then, x belongs in the identification interval if and only if the minimized
variance does not exceed τ 2 .
Thus a simple grid search over values of x numerically determines the identification interval. Note that so long as a and b arise from values of φ within the prescribed bounds,
the underlying value of IF R must belong to the identification interval. Thus two numerical
searches can be undertaken. One starts at the underlying value and tests successively larger
x until a failing value is obtained. The other starts at the underlying value and does the same,

but moving downwards.
8.3. nimble MCMC details. Using nimble, we applied two sampling strategies for the
trio (φk , cloglog(IRk ), cloglog(IFRk )) for each k = 1,. . . , K . In all cases the univariate sampling method was adaptive random-walk Metropolis-Hastings. For notation, we drop the subscript k and define κ1 = cloglog(IRk ) and κ2 = cloglog(IFRk ).
First, we included a block sampler on (φ, κ1 , κ2 ) for each k , along with the usual univariate samplers on each element of the trio. Second, we included samplers in two transformed
coordinate spaces. Define transformed coordinates (z1 , z2 ) = (h1 (κ1 , κ2 ), h2 (κ1 , κ2 )) =
(exp(κ1 ) + exp(κ2 ), exp(κ1 ) − exp(κ2 )). (Based on the cloglog link, the quantities exp(κ1 )

and exp(κ2 ) may be interpreted as continuous time rates.)

BAYESIAN ADJUSTMENT FOR PREFERENTIAL TESTING IN ESTIMATING THE COVID-19 IFR 33

Now z1 represents the more strongly identified quantity, so mixing in z2 can be slow.
Hence we wish to improve mixing in the z2 direction. To do so, a sampler can operate in
the (z1 , z2 ) coordinates while transforming the prior such that it is equivalent in (z1 , z2 )
to what was specified in the original coordinates, (κ1 , κ2 ). Using P (·) for priors, we have
log(P (z1 , z2 )) = log(P (κ1 , κ2 )) − log(|J|), where |J| is the determinant of the Jacobian of
(z1 , z2 ) with respect to (κ1 , κ2 ). In this case, |J| = 2 exp(κ1 + κ2 ).

The other transformed coordinates used were (z1 , z2 ) = (log(φ) + κ1 , log(φ) − κ1 ). Note
that log(φ) + κ1 = log(− log((1 − IR)φ )). Hence z1 represents the more strongly identified
quantity, so we wish to improve mixing by sampling in the z2 direction. We have the same
formulation as above, with |J| = 2/φ.
8.4. Seroprevalence study data. Consider the data for k = 1, . . . , 5:
• k = 1: Gangelt, Germany- Streeck et al. (2020) estimated the infection prevalence from
a “random population sample” obtained between March 31st, 2020 and April 6th, and
provide a 95% CI for the IR of [12.31%, 24.40%].5 This uncertainty interval is equivalent
to a binomial distribution with 27 confirmed cases from 153 tests. The relevant number of
deaths is 8 ( “until April 20th”), as listed by Streeck et al. (2020). With a total population
of 12,597, this corresponds to a 95% HPD credible interval for the IFR of [0.15%, 0.74%]
(see R code below in Section 8.5 for this calculation).
• k = 2: Geneva, Switzerland- Based on the data collected by Stringhini et al. (2020),
Perez-Saez et al. (2020) estimate a 95% CI for the IR of [8.15%, 13.95%] for a “representative sample of the general population” of the canton of Geneva (enrollment between
April 6th and May 9th).6 This uncertainty interval is equivalent to a binomial distribution
with 48 confirmed cases amongst 442 tests. The relevant number of deaths is 243 (recorded
on April 30th, 2020), as listed by Ioannidis (2020a).7 With a total population of 506,765,
this corresponds toa 95% HPD credible interval for the IFR of [0.32%, 0.59%].
5

Streeck et al. (2020) reports two different 95% CIs, obtained with and without applying a “correction factor”:

[15.84%; 24.40%] and [12.31%; 18.96%], respectively.
6

Population number for the canton of Geneva obtained from Perez-Saez et al. (2020).

7

Ioannidis (2020a): “For the number of COVID-19 deaths, the number of deaths recorded at the time chosen

by the authors of each study was selected, whenever the authors used such a death count up to a specific date
to make inferences themselves. If the choice of date had not been done by the authors, the number of deaths
accumulated until after 1 week of the mid-point of the study period was chosen.”

34

• k = 3: Luxembourg: Snoeck et al. (2020) “recruited a representative sample of the Luxembourgish population” between April 16th and May 5th, and obtained a 95% CI of
[1.23%, 2.77%].8 This uncertainty interval corresponds to about 23 confirmed cases from
1,214 tests. The relevant number of deaths is 92 (recorded on May 2nd, 2020), as listed
by Ioannidis (2020a). With a total population of 615,729, this corresponds to a 95% HPD
credible interval for the IFR of [0.48%, 1.24%].
• k = 4: Split-Dalmatia County, Croatia: Jerkovic et al. (2020) conducted serological testing for antibodies from April 23rd to April 28th, and obtained a 95% CI for the IR of
[0.64%, 2.05%] (from “a representative sample size for the Split-Dalmatia County population, which could reflect a relatively realistic antibody seroprevalence in the county”). This
uncertainty interval corresponds to about 12 confirmed cases from 938 tests. The relevant
number of deaths is 29 (recorded on May 3rd, 2020), as listed by the Croatian Institute of
Public Health (www.koronavirus.hr). With a total population of 447,723, this corresponds
to a 95% HPD credible interval for the IFR of [0.24%, 0.99%].
• k = 5: Zurich, Switzerland (May, 2020): Emmenegger et al. (2020) estimate a 95% CI
for the IR of [0.6%, 1.8%] for “the first half of April 2020” and note that “the prevalence
reported here is truly representative of the population under study.” This uncertainty interval corresponds to about 13 confirmed cases from 1,167 tests. The relevant number of
deaths is 127 (recorded on May 15th, 2020), as listed by Ioannidis (2020a). With a total
population of 1,520,968, this corresponds to a 95% HPD credible interval for the IFR of
[0.40%, 1.32%].
8

Snoeck et al. (2020) report two different 95% CIs, obtained with and without adjustment for age, gender and

canton: [1.23%; 2.67%] and [1.34%; 2.77%].

BAYESIAN ADJUSTMENT FOR PREFERENTIAL TESTING IN ESTIMATING THE COVID-19 IFR 35

8.5. Example R-code for the Gangelt, Germany seroprevalence study data.
###########
library(rriskDistributions); library(rjags); library("hBayesDM")
# k = 1: Gangelt, Germany
Dk <- 8;

Pk <- 12597; IR_CI <- c(0.1231, 0.2440)

ab_param <- round(get.beta.par(p = c(0.025,0.975), q = IR_CI, plot = FALSE))

modelIFR <- "model {
cc ~ dbin(ir, tests);
deaths ~ dbin(ifr*ir, pop);
ifr ~ dunif(0,1);
ir ~ dunif(0,1)}"

jags.model <- jags.model(textConnection(modelIFR),
data = list(
cc = ab_param[1],
tests = ab_param[1] + ab_param[2] + 1,
pop = Pk,
deaths = Dk))
sm <- coda.samples(jags.model, "ifr", n.iter = 10000000,
100*round(HDIofMCMC(unlist(sm[,"ifr"])), 4)
#

0.15 0.74

###########

8.6. Tables.

thin = 100)

36

k

Date
Tk
CCk
Pk
Dk
(MM-DD)
1 Gangelt (Germany)
04-02
153*
27*
12597
8
2 Geneva (Switzerland)
04-23
442*
48*
506765
243
3 Luxembourg
04-26
1214*
23*
615729
92
4 Split-Dalmatia (Croatia)
04-25
938*
12*
447723
29
5 Zurich (Switzerland)
04-07
1167*
13*
1520968
127
6 Luxembourg
05-01
44895
3784
625976
103
7 Austria
05-01
264079
15424
9006400
626
8 Bulgaria
05-01
46510
1506
6948450
99
9 Croatia
05-02
37557
2085
4105268
95
10 Czech Republic
05-01
258368
7682 10708978
293
11 Denmark
05-01
266124
9158
5792203
538
12 Estonia
05-01
54439
1689
1326539
62
13 Finland
05-01
106438
4995
5540716
287
14 Germany
05-03 2773432 162496 83783930
7914
15 Greece
05-01
77251
2591 10423036
156
16 Hungary
05-01
76331
2863
9660352
442
17 Iceland
05-01
49961
1797
341250
10
18 Ireland
05-01
177097
20612
4937796
1506
19 Italy
05-01 2053425 205463 60461823 31368
20 Latvia
05-01
61120
858
1886203
19
21 Lithuania
05-01
132768
1385
2722289
54
22 Netherlands
05-03
238672
40236 17134870
5670
23 Norway
05-01
156444
7710
5421243
232
24 Poland
05-01
354628
12877 37846592
883
25 Portugal
05-01
439890
24987 10196707
1184
26 Romania
05-01
183688
12240 19237691
1046
27 Slovakia
05-01
91072
1396
5459651
27
28 Slovenia
05-01
55020
1429
2078933
103
29 Spain
05-07 1625211 222045 46754781 27940
30 Switzerland
05-01
280735
29503
8654617
1588
31 United Kingdom
05-01
996826 171253 67886017 33614
TABLE 2
*CCk and Tk numbers for k = 1, . . . , 5 were obtained by inverting binomial confidence intervals so as to match
the reported 95% CI for the estimated IRs published in the seroprevalence studies. We assume that φk = 1, for
k = 1, . . . , 5, (seroprevalence studies); and that φk is unknown for k = 5, . . . , 31 (national official statistics).
The date listed for each group corresponds to the date (or midpoint during the study time period) corresponding
to the CCk and Tk numbers.
Location

BAYESIAN ADJUSTMENT FOR PREFERENTIAL TESTING IN ESTIMATING THE COVID-19 IFR 37
k

Location

Prop. above
70 y.o. (%)
14
12
10
14
12
14
13
13
12
12
13
13
16
15
12
9
9
16
14
14
10
12
11
10
15
12
9
13
14
13
13

Hosp. beds Days since Days until Pop. density
per 1,000
outbreak
lockdown
(per km2 )
1 Gangelt (Germany)
8.00
58
32
260
2 Geneva (Switzerland)
4.80
54
6
2032
3 Luxembourg
4.51
44
8
231
4 Split-Dalmatia (Croatia)
5.54
50
14
100
5 Zurich (Switzerland)
4.10
38
6
916
6 Austria
7.37
61
14
107
7 Bulgaria
7.45
49
0
65
8 Croatia
5.54
57
14
74
9 Czech Republic
6.63
56
8
137
10 Denmark
2.50
57
5
137
11 Estonia
4.69
55
13
31
12 Finland
3.28
56
42
18
13 Germany
8.00
89
32
237
14 Greece
4.21
57
7
83
15 Hungary
7.02
51
6
108
16 Iceland
2.91
58
15
3
17 Ireland
2.96
56
11
70
18 Italy
3.18
69
21
206
19 Latvia
5.57
50
10
31
20 Lithuania
6.56
46
13
45
21 Luxembourg
4.51
49
8
231
22 Netherlands
3.32
62
13
509
23 Norway
3.60
61
13
14
24 Poland
6.62
53
6
124
25 Portugal
3.39
55
7
112
26 Romania
6.89
54
10
85
27 Slovakia
5.82
50
2
113
28 Slovenia
4.50
54
6
103
29 Spain
2.97
70
37
93
30 Switzerland
4.53
62
6
214
31 United Kingdom
2.54
67
46
273
TABLE 3
Covariate data for the European dataset includes: the share of the population that is 70 years and older (“Prop.
above 70 y.o.”), the number of hospital beds per 1,000 people (“Hosp. beds per 1,000”), the number days since
the country reported 10 or more confirmed infections (“Days since outbreak”), the number of days between a
country’s first reported infection and the imposition of social distancing measures (“Days until lockdown”), and
the population density (“Pop. density”).

g−1 (θ)
g−1 (β)
θ
β
θ1 (“Prop. above 70 y.o.”)
θ2 (“Hosp. beds per 1,000”)
β1 (“Days since outbreak”)
β2 (“Days until lockdown”)
β3 (“Pop. density”)
τ
σ
γ

Seroprevalence data
Estimate 95% CI
0.005
[0.004, 0.007]
0.036
[0.005, 0.082]
-5.211
[-5.438, -4.937]
-3.305
[-4.335, -2.096]

0.081
1.156

[0.002, 0.200]
[0.649, 2.057]

Estimate
0.005
0.015
-5.235
-4.218
-0.003
-0.428
0.211
0.451
0.766
0.195
0.683
9.183

All data
95% CI
[0.004, 0.007]
[0.010, 0.021]
[-5.527 , -4.950]
[-4.572 , -3.841]
[-0.158 , 0.165]
[-0.630 , -0.244]
[-0.090 , 0.540]
[0.113 , 0.773]
[0.496 , 1.031]
[0.039 , 0.350]
[0.502 , 0.923]
[4.759 , 14.204]

TABLE 4
Posterior parameter estimates (posterior medians and 95% HPD CIs) from large-P model fit to data from only
the seroprevalence studies (left) and from the full dataset (right). The large-P model is fit with priors specified
by λ = 0.05 and η = 0.1.

