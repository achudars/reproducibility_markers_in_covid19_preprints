PaccMannRL on SARS-CoV-2: Designing antiviral candidates with conditional
generative models

arXiv:2005.13285v3 [q-bio.QM] 6 Jul 2020

Jannis Born 1 2 * Matteo Manica 1 * Joris Cadow 1 * Greta Markert 1 2 Nil Adell Mill 1 2 Modestas Filipavicius 1 2
María Rodríguez Martínez 1

Abstract
With the fast development of COVID-19 into a
global pandemic, scientists around the globe are
desperately searching for effective antiviral therapeutic agents. Bridging systems biology and drug
discovery, we propose a deep learning framework
for conditional de novo design of antiviral candidate drugs tailored against given protein targets.
First, we train a multimodal ligand–protein binding affinity model on predicting affinities of antiviral compounds to target proteins and couple this
model with pharmacological toxicity predictors.
Exploiting this multi-objective as a reward function of a conditional molecular generator (consisting of two VAEs), we showcase a framework
that navigates the chemical space toward regions
with more antiviral molecules. Specifically, we explore a challenging setting of generating ligands
against unseen protein targets by performing a
leave-one-out-cross-validation on 41 SARS-CoV2-related target proteins. Using deep RL, it is
demonstrated that in 35 out of 41 cases, the generation is biased towards sampling more binding
ligands, with an average increase of 83% comparing to an unbiased VAE. We present a case-study
on a potential Envelope-protein inhibitor and perform a synthetic accessibility assessment of the
best generated molecules is performed that resembles a viable roadmap towards a rapid in-vitro
evaluation of potential SARS-CoV-2 inhibitors.

1

Introduction

The Severe Acute Respiratory Syndrome (SARS) Coronavirus disease (COVID 2019) is an acute respiratory disease
caused by novel coronavirus SARS-CoV-2 that, to date, has
*
1
Equal contribution
IBM Research Europe, Switzer2
land.
ETH Zurich, Switzerland.
Correspondence to:
J.B. <jab@zurich.ibm.com>, M.M <tte@zurich.ibm.com>, J.C
<dow@zurich.ibm.com>.

infected millions and killed hundreds of thousands. Despite
longstanding efforts into understanding the pathogenicity
of coronaviruses (CoVs) (Drosten et al., 2003), there are
no approved drugs against CoV, and new systematic approaches to identify effective antiviral agents are urgently
needed. Current efforts are predominantly focused on drug
repurposing strategies, with a handful of promising candidates, including remdesivir and hydroxychloroquine. Initial
hopes are currently balked, remdesivir does not significantly
reduce time to clinical improvement (Wang et al., 2020)
and hydroxychloroquine was not found effective in a metastudy of human clinical trials (Shamshirian et al., 2020).
Gordon et al. (2020) recently identified 69 promising compounds by measuring binding affinities of 26 out of the 29
SARS-CoV-2 proteins against human proteins.
With high uncertainty in the outcome of drug repurposing
strategies, it is worth exploiting de novo drug discovery
approaches against SARS-CoV-2. Drug discovery is challenging, with costs of up to 3 billion US$ per new FDAapproved drug, an attrition rate of 99.99%, more than 10
years until market release and a search space of 1060 compounds (Scannell et al., 2012). However, the availability
of high-throughput screenings of compound–protein interactions (CPI) has enabled deep learning to set new benchmarks for large-scale QSAR prediction models for predicting protein–drug binding affinity (Karimi et al., 2019). Deep
learning has further been proven feasible of in silico design
of molecules with desired chemical properties and shown
potential to accelerate discovery of DDR1 inhibitors (Zhavoronkov et al., 2019). A few studies used deep generative
models to release libraries of (unsynthesized) candidates to
target 3C-like protease, a main therapeutic target of SARSCoV-2 (Zhavoronkov et al., 2020; Tang et al., 2020) but both
studies manually curated datasets to target 3C-like protease
inhibitors. Here, we aim to bridge systems biology and drug
discovery, using deep learning to explore target-driven drug
design with conditional generative models. Our framework
(see Figure 1) for conditional molecular design is conceptually inspired by our previous work, PaccMannRL (Born
et al., 2020), however note that here we focus on proteindriven instead of omics-profile-driven drug generation. Our
framework can be trained to design compounds against any

Designing antiviral candidates for SARS-CoV-2 with conditional generative models

stack-augmented GRUs (Joulin & Mikolov, 2015) in both
encoder and decoder. The latent space has a dimensionality
of 256, molecules are represented as SELFIES (Krenn et al.,
2019), a robust adaption of the molecular in-line notation
SMILES (Simplified Molecular Input Line Entry Specification) devised for generative models, and one-hot encodings
are used. During training, KL annealing, teacher forcing and
token dropout are employed. During testing, the stochastic
decoder is sampling from the softmax distribution over the
output tokens.

Figure 1. A drug discovery framework for antiviral small
molecules against SARS-CoV-2. The conditional compound generator, called agent (see A), can produce novel structures specifically designed to target a protein of interest. The generative process
starts with the encoding of the primary structure of the target protein into a latent space of protein sequences. The representation is
fed into a molecular decoder of a separately pretrained molecule
VAE to produce a candidate compound. Next, the proposed compound is evaluated by a critic (see B) composed by: a multimodal
deep learning model that predicts protein-drug binding affinity using protein and compound sequences as input, and a QSAR-based
score to punish toxicity. By means of the reward given by the
critic, a closed-loop system is created and is trained with deep
reinforcement learning to maximize a multi-objective reward.

primary protein structure(s). Deep learning for target-driven
drug design was first formulated by Aumentado-Armstrong
(2018) and similarly to Chenthamarakshan et al. (2020), our
approach implements a conditional generator that can be
applied to unseen protein targets. However, instead of using
conditional sampling, we perform an RL-biased conditional
generation (fusing the latent spaces of protein targets and
small molecules) that is demonstrated to generalize to unseen targets. We further couple our model with IBM RXN1 ,
an AI-governed platform for automated chemical synthesis
to promptly synthesize the best compounds (Schwaller et al.,
2020).

2

Methods

SELFIES VAE. The molecular generator is a variational
auto-encoder (VAE)) that is pretrained on 1,576,904 bioactive compounds from ChEMBL (10% are held out as
validation set). The VAE implementation mostly follows Born et al. (2020), i.e., it consists of two layers of
1

https://rxn.res.ibm.com/

Protein VAE. The protein VAE consists of 3 dense layers
of sizes [768, 512, 256] in both encoder and decoder. The
model is trained on ∼400,000 proteins from UniProt (SwissProt). The proteins considered were selected by filtering
out sequences longer than 8,190 amino acids. The maximum
length of the sequences has been selected to accommodate
the statistics for the SARS-CoV-2 relevant proteins compiled by UniProt2 . Note that the VAE is not trained on the
raw sequences but on 768 dimensional latent representations
obtained from TAPE (Rao et al., 2019). During trainining,
KL annealing and dropout are employed.
Protein-ligand affinity prediction. To predict CPI, we
utilize a bimodal neural network based on the multiscale
convolutional attention model (Manica et al., 2019; Cadow
et al., 2020) (MCA, for model architecture see appendix Figure 4). Drug–protein binding affinity data is obtained from
BindingDB, a public database of 1,813,527 measured binding affinities between 7,044 proteins and 802,551 small
drug-like compounds as of March 2020. As for the protein
VAE data, the database was filtered from entries with target
sequences longer than 8,190 amino acids. The remaining
1,361,076 entries with an average of 187 reported compounds per target protein were taken as binding examples.
From compounds not reported as entry for a given target
187 compounds were randomly sampled as non–binding to
the respective protein target to match the binding examples.
Finally, the combined examples were filtered for invalid
SMILES to a total of 2,723,726 binding/non–binding pairs
of 771,839 compounds and split into random, stratified train
(72%), validation (18%) and test (10%) folds.
Toxicity prediction. Using the Tox21 database available
through DeepChem (Wu et al., 2018), we trained a MCA
model on the augmented SMILES sequences (Bjerrum,
2017) to predict the 12 toxicity classes.
Conditional generation. The conditional generative model
is obtained by encoding a protein target with the protein
VAE and decoding it with the pretrained molecular decoder.
2

covid-19.uniprot.org/as on 22 May 2020.

Designing antiviral candidates for SARS-CoV-2 with conditional generative models

The objective function of this hybrid VAE GΘ is:
X
Π(Θ|r) =
PΘ (sT |r)R(sT , r)

(1)

sT ∈S ∗

where r is the protein target of interest, sT is a SELFIES
string at time T (terminated with the <END> token), S ∗
resembles the molecular space and PΘ (sT |r) is the probability
to sample sT given r. In detail, PΘ (sT |r) :=
Q
t=0:T p(at |st−1 ) where s0 = r and at is the action at
time t sampled from the dictionary of SELFIES tokens.
R(sT , r) is the output of the critic C, in our case a multi
objective:
R(sT , r) = A(sT , r) + 0.5 T (sT )

(2)

where A(·) is the affinity predictor and T (·) is the toxicity
predictor that returns 1 iff sT is inactive in all 12 assays.
Since Equation 1 is intractable to compute, it is approximated using policy gradient and subject to maximization
using REINFORCE (Williams, 1992).
Protein targets. We fetched the 41 protein targets that are
labelled as relevant to SARS-CoV-2 by UniProt (as on 22
May 2020). A full list of targets is given in Table 2 and includes e.g. the 3C-like protease (Mpro ) which was identified
as most promising candidate for antiviral compound development (Wu et al., 2020) and was already investigated with
generative models (Zhavoronkov et al., 2020) and molecular
docking studies (Khaerunnisa et al., 2020). Other proteins
are the nucleocapsid (N-) protein or the spike glycoprotein
which is the most important surface protein, the target of
chloroquine and mediates entrance to human respiratory
epithelial cells by interacting with the ACE2 receptor.

a multi-objective optimization (see Equation 2) based on
toxicity and binding affinity. Across 10 runs, this model
achieved a ROC-AUC of 0.877 ± 0.04, surpassing prior
results on this benchmarked dataset. Both the affinity and
toxicity predictor are not investigated further herein, but
employed as reward function for the conditional generation.
Conditional generative model
In this study, we are not primarily interested in proposing the best possible compounds. We rather want to validate whether our framework can go beyond current approaches for target-driven compound design (Chenthamarakshan et al., 2020; Zhavoronkov et al., 2019; 2020) in
the sense that it does not require fine-tuning for specific
targets. We therefore investigated the generalization capabilities of our framework by performing a leave-one-out-crossvalidation (LooCV) on the 41 targets. The RL optimizaton
was performed for 5 epochs and 500 molecules were sampled in each step. The results are depicted in Table 2 and
demonstrate that in 35 out of 41 cases the model proposed
more binding compounds against an unseen target, compared to the baseline SELFIES VAE.
From the baseline SELFIES VAE, a total of 3,000 molecules
was sampled. The average ratio of compounds predicted
to bind increased from 18% to 26% with the best epoch
averaging 33%. For example density plots see the appendix
(Figure 5). We additionally optimized the generator to propose less toxic compounds. This succeeded to a lesser extent, probably at least partially caused by the lower weight
in the reward function. For a qualitative evaluation, Figure 2

NH
N
NH

NH

N

Cl

3

Cl

O

S

O

Results

NH

N

N

F

N
N

O

O

NH

NH
O

Protein-ligand affinity prediction. Because the conditional generation focuses on antiviral drug design, it is important that the affinity predictor generalizes well for viral
proteins. The results of the MCA model on validation and
test data from BindingDB are displayed in Table 1 next to
the performance on 10k viral proteins. The results shows

R1AB_SARS2 (a=1.0, QED=0.9)

IMA1_HUMAN (a=0.93, QED=0.77)

OH

O

R1A_SARS2 (a=0.98, QED=0.74)

ITAL_HUMAN (a=0.88, QED=0.88)

O

O

NH

O
O

N

O

NH

O

O

O

N
O

O

O

S

O

Br
NH

R1AB_CVHSA (a=1.0, QED=0.77)

ACE2_HUMAN (a=0.99, QED=0.77)

Y14_SARS2 (a=0.79, QED=0.78)

R1A_CVHSA (a=0.93, QED=0.91)

NH 2
O

OH

OH

N

Table 1. Result of bimodal affinity predictor on BindingDB data.

NH

NH

O
NH

O

O

O

S

O

NH

NH

O
NH

N

N

NH

OH
OH

ROC-AUC
Average precision

Validation

Test

Viral

0.968
0.963

0.969
0.965

0.96
0.92

that the model learned reasonably well to classify CPI as
binding or non-binding.
Toxicity predictor. Because toxicity is a major cause of the
high attrition rate in drug discovery, we decided to perform

MAD3_HUMAN (a=0.72, QED=0.81)

NS7B_CVHSA (a=0.95, QED=0.69)

Cl

VEMP_SARS2 (a=0.61, QED=0.64)

SPIKE_SARS2 (a=0.91, QED=0.15)

Figure 2. Molecules sampled against specific protein targets.
For a selection of 12 targets, the generated compound with the
highest reward is depicted. a stands for binding affinity. The
encircled molecule is discussed further in the case study.

shows a selection of the sampled molecules alongside their
QED score (Bickerton et al., 2012)).

Designing antiviral candidates for SARS-CoV-2 with conditional generative models
Table 2. Generating antiviral compounds against unseen
SARS-CoV-2 targets. For each of the 41 targets, Affinity0 shows
the fraction of binding molecules sampled before training. Affbest
shows the fraction at the best epoch of RL training, while Affmedian
shows the median across all 5 training epochs. The same applies
to Toxbest and Toxmed , where Tox0 was 8.7%.
Target protein

Affinity0

Affmed ±SEM

Affb

Toxmed ±SED

Toxb

VME1-CVHSA
IMA1-HUMAN
VEMP-SARS2
NS7B-SARS2
ITAL-HUMAN
NCAP-CVHSA
R1AB-CVHSA
NS8B-CVHSA
A0A663DJA2-SARS2
NS8A-CVHSA
NS7A-SARS2
Y14-SARS2
NS6-SARS2
SMAD3-HUMAN
SPIKE-CVHSA
DDX1-HUMAN
AP3A-SARS2
R1A-CVHSA
NS8-SARS2
PHB2-HUMAN
SGTA-HUMAN
NS7A-CVHSA
ORF9B-CVHSA
R1A-SARS2
Y14-CVHSA
ORF9B-SARS2
TMPS2-HUMAN
BST2-HUMAN
NS3B-CVHSA
SPIKE-SARS2
FURIN-HUMAN
AP3A-CVHSA
VME1-SARS2
NS7B-CVHSA
MPP5-HUMAN
ACE2-HUMAN
VEMP-CVHSA
NS6-CVHSA
PHB-HUMAN
R1AB-SARS2
NCAP-SARS2
Average

20%
88%
29%
25%
24%
17%
58%
9%
26%
21%
4%
17%
20%
50%
3%
9%
4%
14%
7%
4%
11%
18%
9%
62%
14%
18%
6%
10%
25%
7%
28%
9%
15%
21%
5%
51%
21%
10%
3%
83%
25%
18%

18% ± 3%
97% ± 1%
16% ± 2%
30% ± 5%
16% ± 6%
11% ± 1%
90% ± 2%
12% ± 2%
35% ± 3%
47% ± 4%
3% ± 1%
29% ± 4%
12% ± 3%
74% ± 3%
0% ± 1%
14% ± 2%
0% ± 1%
45% ± 3%
10% ± 3%
3% ± 0%
12% ± 1%
35% ± 5%
11% ± 2%
82% ± 3%
15% ± 2%
12% ± 1%
5% ± 1%
5% ± 3%
23% ± 2%
6% ± 2%
27% ± 4%
0% ± 1%
16% ± 3%
26% ± 1%
9% ± 2%
77% ± 4%
25% ± 3%
13% ± 1%
0% ± 1%
100% ± 0%
5% ± 2%
26% ± 4%

29%
100%
20%
33%
43%
15%
91%
20%
41%
55%
7%
43%
22%
86%
5%
20%
3%
50%
18%
4%
13%
59%
17%
89%
23%
15%
6%
16%
29%
12%
36%
6%
27%
27%
11%
85%
30%
15%
3%
100%
9%
33%

6% ± 3%
5% ± 3%
9% ± 2%
7% ± 5%
9% ± 1%
12% ± 2%
9% ± 1%
7% ± 4%
14% ± 3%
10% ± 1%
10% ± 3%
8% ± 2%
4% ± 3%
6% ± 1%
7% ± 1%
9% ± 1%
9% ± 3%
9% ± 1%
10% ± 1%
11% ± 3%
8% ± 1%
11% ± 2%
6% ± 1%
8% ± 2%
11% ± 2%
12% ± 2%
6% ± 1%
10% ± 2%
12% ± 1%
10% ± 1%
9% ± 3%
8% ± 1%
6% ± 2%
7% ± 1%
15% ± 2%
5% ± 2%
12% ± 2%
3% ± 3%
6% ± 1%
5% ± 1%
9% ± 4%
9% ± 0.5%

19%
18%
12%
25%
12%
14%
11%
25%
18%
10%
19%
14%
14%
10%
11%
10%
19%
11%
15%
23%
12%
15%
11%
14%
15%
16%
10%
14%
15%
12%
20%
12%
14%
11%
16%
12%
20%
14%
7%
7%
24%
15%

To investigate the learned chemical space, we assembled
a dataset of 10,000 random ChEMBL compounds, 3,000
molecules sampled from the unbiased VAE, 3,000 molecules
sampled from the biased generator and 82 SARS-CoV2 candidate drugs from the literature (top 15 matches
on PubChem and 69 compounds identified via proteininteraction-maps (Gordon et al., 2020), excluding 2 duplicates). For all these molecules, binding affinities were computed alongside other pharmacological properties. Next, a
UMAP (McInnes et al., 2018) was performed on the ECFP4
fingerprint (Rogers & Hahn, 2010) and visualized with
Faerun/Tmap (Probst & Reymond, 2018; 2020)3 . The interactive visualisation shows that the RL optimisation lead to
over-sampling a manifold of the chemical space that is more
densely populated with binding compounds. The 3D UMAP
shows that the currently investigated candidate molecules
(red) are structurally fairly dissimilar (i.e. scattered across
3

The Faerun visualization with ECFP is available at:

https://paccmann.github.io/assets/umap_fingerprints.html

the chemical space). But it gives evidence that our model
successfully navigates the chemical space towards regions
of high reward. While this shows that the generator succeeded in its objective, ultimately, the quality of the reward
function remains the bottleneck of the framework.
Case study. For a more detailed assessment of the quality
of the molecules, we ranked all ∼ 3,000 conditionally generated molecules by their tanimoto similarity τ to the closest
neighbour of the 81 literature candidates. Among the top
5 molecules, we found the molecule encircled in Figure 2,
generated against VEMPSARS2 (UniProt ID: P0DTC4), the
envelope small membrane protein (E-Protein), a key player
for virion assembly and morphogenesis. Our candidate
exhibits the highest tanimoto similarity to the compounds
MZ1 and dBET6 (τ = 0.64 based on RDKit fingerprint).
These two pre-clinical SARS-CoV-2 drug candidates were
identified by Gordon et al. (2020) to target the E-protein by
degrading the human BRD2 and BRD4 proteins and thus
preventing the virus from inducing changes in the host’s
protein expression.

Figure 3. Results of retrosynthesis attempts. A retrosynthetic
pathway is considered feasible if it leads to commercially available
precursors within six reaction steps. Orange indicates feasiblity
while blue indicates non feasibility. On the left (A), overall feasibility of the predicted sequences. On the right (B), feasibility over
the number of reaction steps.

The Top-5 candidate compounds for each protein target
were further analyzed for synthetic feasibility using IBM
RXN’s retrosynthesis engine (Schwaller et al., 2020). We
performed the predictions using the Python package
rxn4chemistry 4 . Figure 3 shows the predictions over
the retrosynthetic sequences estimated for all molecules.
Although the generated molecules are not optimized for synthetic accessibility, more than half of the synthesis routes
predicted are feasible. It’s interesting to observe how more
than 300 sequences requires only a single or two steps reactions, indicating, assuming a reasonable yield, an extremely
efficient synthesis for part of the molecules generated.

4

Discussion

The dramatic effect of the COVID-19 pandemic is compounded by the lack of vaccines and therapeutic agents
4

https://github.com/rxn4chemistry/rxn4chemistry

Designing antiviral candidates for SARS-CoV-2 with conditional generative models

against SARS-CoV-2. Worse, traditional approaches to drug
discovery are slow, inefficient, error-prone and costly.
Here, we proposed a novel framework for compound design
that can be targeted towards any viral target protein with
no retraining requirements. We showcased the potential
of the framework by successfully tackling the problem of
generating novel compounds with high binding affinity to
unseen targets, while controlling toxicity of the generated
molecules. Furthermore, for each target, we estimated retrosynthetic pathways of the most promising molecules, to
assess the feasibility of the generated compounds. Largescale screening data for 1,670 compounds tested against
SARS-CoV-2 proteins that just became available (Heiser
et al., 2020), will be used in the future to improve the affinity
predictor, one of the bottlenecks of our approach.

References
Aumentado-Armstrong, T. Latent molecular optimization for targeted therapeutic design. arXiv preprint arXiv:1809.02032,
2018.
Bickerton, G. R., Paolini, G. V., Besnard, J., Muresan, S., and
Hopkins, A. L. Quantifying the chemical beauty of drugs.
Nature chemistry, 4(2):90, 2012.
Bjerrum, E. J. Smiles enumeration as data augmentation
for neural network modeling of molecules. arXiv preprint
arXiv:1703.07076, 2017.
Born, J., Manica, M., Oskooei, A., Cadow, J., and Martínez, M. R.
Paccmann rl: Designing anticancer drugs from transcriptomic
data via reinforcement learning. In International Conference
on Research in Computational Molecular Biology, pp. 231–233.
Springer, 2020.
Cadow, J., Born, J., Manica, M., Oskooei, A., and Rodríguez Martínez, M. Paccmann: a web service for interpretable
anticancer compound sensitivity prediction. Nucleic Acids Research, 2020.
Chenthamarakshan, V., Das, P., Padhi, I., Strobelt, H., Lim, K. W.,
Hoover, B., Hoffman, S. C., and Mojsilovic, A. Target-specific
and selective drug design for covid-19 using deep generative
models. arXiv preprint arXiv:2004.01215, 2020.
Drosten, C. et al. Identification of a novel coronavirus in patients
with severe acute respiratory syndrome. New England journal
of medicine, 348(20):1967–1976, 2003.
Gordon, D. E., Jang, G. M., Bouhaddou, M., Xu, J., Obernier, K.,
White, K. M., O’Meara, M. J., Rezelj, V. V., Guo, J. Z., Swaney,
D. L., et al. A sars-cov-2 protein interaction map reveals targets
for drug repurposing. Nature, pp. 1–13, 2020.
Heiser, K. et al. Identification of potential treatments for covid19 through artificial intelligence-enabled phenomic analysis of
human cells infected with sars-cov-2. bioRxiv, 2020.
Joulin, A. and Mikolov, T. Inferring algorithmic patterns with
stack-augmented recurrent nets. In Advances in neural information processing systems, pp. 190–198, 2015.
Karimi, M., Wu, D., Wang, Z., and Shen, Y. Deepaffinity: interpretable deep learning of compound–protein affinity through
unified recurrent and convolutional neural networks. Bioinformatics, 35(18):3329–3338, 2019.
Khaerunnisa, S., Kurniawan, H., Awaluddin, R., Suhartati, S.,
and Soetjipto, S. Potential inhibitor of covid-19 main protease
(mpro) from several medicinal plant compounds by molecular
docking study. Prepr. doi10. 20944/preprints202003. 0226. v1,
pp. 1–14, 2020.
Krenn, M., Häse, F., Nigam, A., Friederich, P., and Aspuru-Guzik,
A. Selfies: a robust representation of semantically constrained
graphs with an example application in chemistry. arXiv preprint
arXiv:1905.13741, 2019.
Manica, M., Oskooei, A., Born, J., Subramanian, V., SáezRodríguez, J., and Rodríguez Martínez, M. Toward explainable anticancer compound sensitivity prediction via multimodal
attention-based convolutional encoders. Molecular Pharmaceutics, 2019.

Designing antiviral candidates for SARS-CoV-2 with conditional generative models
McInnes, L., Healy, J., and Melville, J. Umap: Uniform manifold
approximation and projection for dimension reduction. arXiv
preprint arXiv:1802.03426, 2018.
Probst, D. and Reymond, J.-L. Fun: a framework for interactive
visualizations of large, high-dimensional datasets on the web.
Bioinformatics, 34(8):1433–1435, 2018.
Probst, D. and Reymond, J.-L. Visualization of very large highdimensional data sets as minimum spanning trees. Journal of
Cheminformatics, 12(1):1–13, 2020.
Rao, R., Bhattacharya, N., Thomas, N., Duan, Y., Chen, X., Canny,
J., Abbeel, P., and Song, Y. S. Evaluating protein transfer learning with tape. In Advances in Neural Information Processing
Systems, pp. 9686–9698, 2019.
Rogers, D. and Hahn, M. Extended-connectivity fingerprints.
Journal of chemical information and modeling, 50(5):742–754,
2010.
Scannell, J. W., Blanckley, A., Boldon, H., and Warrington, B.
Diagnosing the decline in pharmaceutical r&d efficiency. Nature
reviews Drug discovery, 11(3):191, 2012.
Schwaller, P., Petraglia, R., Zullo, V., Nair, V. H., Haeuselmann,
R. A., Pisoni, R., Bekas, C., Laino, T., et al. Predicting retrosynthetic pathways using transformer-based models and a
hyper-graph exploration strategy. Chemical Science, 2020.
Shamshirian, A., Hessami, A., Heydari, K., and Alizadeh-Navaei,
R. e. a. Hydroxychloroquine versus covid-19: A periodic
systematic review and meta-analysis. medRxiv, 2020. doi:
10.1101/2020.04.14.20065276.
Tang, B., He, F., Liu, D., Fang, M., Wu, Z., and Xu, D. Ai-aided
design of novel targeted covalent inhibitors against sars-cov-2.
bioRxiv, 2020.
Wang, Y., Zhang, D., Du, G., Du, R., Zhao, J., Jin, Y., Fu, S.,
Gao, L., Cheng, Z., Lu, Q., et al. Remdesivir in adults with severe covid-19: a randomised, double-blind, placebo-controlled,
multicentre trial. The Lancet, 2020.
Williams, R. J. Simple statistical gradient-following algorithms
for connectionist reinforcement learning. Machine learning, 8
(3-4):229–256, 1992.
Wu, C., Liu, Y., Yang, Y., Zhang, P., Zhong, W., Wang, Y., Wang,
Q., Xu, Y., Li, M., Li, X., et al. Analysis of therapeutic targets
for sars-cov-2 and discovery of potential drugs by computational
methods. Acta Pharmaceutica Sinica B, 2020.
Wu, Z., Ramsundar, B., Feinberg, E. N., Gomes, J., Geniesse,
C., Pappu, A. S., Leswing, K., and Pande, V. Moleculenet: a
benchmark for molecular machine learning. Chemical science,
9(2):513–530, 2018.
Zhavoronkov, A. et al. Deep learning enables rapid identification
of potent ddr1 kinase inhibitors. Nature biotechnology, 37(9):
1038–1040, 2019.
Zhavoronkov, A. et al. Potential non-covalent sars-cov-2 3c-like
protease inhibitors designed using generative deep learning
approaches and reviewed by human medicinal chemist in virtual
reality. ChemRxiv, 2020.

Designing antiviral candidates for SARS-CoV-2 with conditional generative models

Appendix
Channels

Protein sequence

Contextual attention
K = 11
K=5
K=3

CNN protein
embeddings

CNN SMILES
embedding

SMILES

CA
Multihead attention

MC1 MC2 MC3

CA

Dense
Layers

Affinity prediction

Figure 4. Multimodal protein-ligand affinity predictor for antiviral compounds. Inspired by the MCA architecture in Manica
et al. (2019), this is a multimodal classification model that performs multiscale convolutions on SMILES embeddings (ligand)
and amino acid embeddngs (protein). The output is fed into multiple heads of contextual attention mechanism prior to a set of
stacked dense layers.

Figure 6. UMAP dimensionality reduction of the chemical
space visualized with Faerun/TMap (Probst & Reymond,
2018; 2020). Snapshot of the Faerun visualization of a UMAP
of 10,000 molecules randomly selected from ChEMBL (grey),
alongside 3,000. molecules sampled from the unbiased generator (dark green), 3,500 molecules sampled against SARS-CoV-2
related target proteins and 82 drug candidates according to the
literature.
Figure 5. Exemplary density functions of conditional generation. Gray distributions show predicted binding affinities of
n=3,000 molecules sampled from an unbiased SELFIES VAE.
Depicted in red are the densities obtained by sampling from the
RL optimized conditional generative model. It can be seen that
the optimization biased the sampling process toward regions of the
chemical space that are more densely populated with ligands that
are predicted to bind.

