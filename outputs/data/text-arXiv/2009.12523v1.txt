Efficient Calibration for Imperfect Epidemic Models
with Applications to the Analysis of COVID-19
Chih-Li Sunga 1 , Ying Hungb
a

arXiv:2009.12523v1 [stat.ME] 26 Sep 2020

b

Department of Statistics and Probability, Michigan State University

Department of Statistics, Rutgers, the State University of New Jersey

Abstract
The estimation of unknown parameters in simulations, also known as calibration,
is crucial for practical management of epidemics and prediction of pandemic risk.
A simple yet widely used approach is to estimate the parameters by minimizing
the sum of the squared distances between actual observations and simulation outputs. It is shown in this paper that this method is inefficient, particularly when
the epidemic models are developed based on certain simplifications of reality, also
known as imperfect models which are commonly used in practice. To address this
issue, a new estimator is introduced that is asymptotically consistent, has a smaller
estimation variance than the least squares estimator, and achieves the semiparametric
efficiency. Numerical studies are performed to examine the finite sample performance.
The proposed method is applied to the analysis of the COVID-19 pandemic for 20
countries based on the SEIR (Susceptible-Exposed-Infectious-Recovered) model with
both deterministic and stochastic simulations. The estimation of the parameters,
including the basic reproduction number and the average incubation period, reveal
the risk of disease outbreaks in each country and provide insights to the design of
public health interventions.

Keywords: Compartmental models; Basic reproduction number; Stochastic simulations;
Kernel Poisson regression; Semiparametric efficiency
1

Corresponding author.

1

1

Introduction

The coronavirus disease (COVID-19) pandemic has shown profound impacts on public
health and the economy worldwide. The development of efficient and effective public health
interventions to prevent major outbreaks and contain the pandemic relies heavily on a
quantitative understanding regarding the spread of the virus, such as the transmission
rate and the average incubation period. A commonly used approach in epidemiology is
to estimate these quantities of interest using epidemic mathematical models, such as the
susceptible-infected recovered (SIR) model, with agent-based simulations which capture
complex social networks and global scale into the models (Funk et al., 2009; Heesterbeek
et al., 2015; Epstein, 2009).
To estimate the parameters of interest, a widely used frequentist approach is to minimize
the sum of the squared distances between the observed data and the simulation outputs,
which is often referred to as the least squares approach. See, for example, Chowell et al.
(2003, 2004); Capaldi et al. (2012); Chowell (2017); Anastassopoulou et al. (2020); Bentout
et al. (2020); Chen and Qiu (2020); Giordano et al. (2020). This estimation approach
is intuitive and easy to compute; however, it is shown in this paper that this method is
inefficient, particularly when the mathematical models associated with the simulators are
built under certain assumptions or simplifications, which may not hold in reality. These
simulators are called imperfect simulators in the computer experiment literature (Kennedy
and O’Hagan, 2001; Tuo and Wu, 2015; Plumlee, 2017). Imperfect simulators are common
in epidemiology (Heesterbeek et al., 2015), and therefore the parameter estimates based on
the least squares approach are not efficient.
To improve the estimation efficiency, in this paper we propose a new estimation method
for the parameters of interest in the epidemic models. In the computer experiment literature,

2

these unknown parameters associated with the mathematical models are often called
calibration parameters, and the process of estimating the parameters such that the model
simulations agree with the observed data is called calibration (Kennedy and O’Hagan, 2001;
Santner et al., 2018). Although there are numerous developments on calibration, most of
the work focus on continuous outputs while the discussions on non-Gaussian outputs, such
as count data which are often observed in epidemiology, are scarce (Sung et al., 2020a;
Grosskopf et al., 2020). In this paper, we propose a new estimation method for non-Gaussian
outputs, particularly for count data for our applications in epidemiology, which minimizes
the L2 projection of the discrepancy between the true mean process and the simulation
outputs. It can be shown that the proposed estimator is asymptotically consistent, and
provides a smaller asymptotic variance than the least squares estimator. Furthermore, it can
be shown that the proposed estimator achieves the semiparametric efficiency, even when the
model simulations cannot match the reality due to certain assumptions or simplifications.
It is worth noting that there are extensive studies and applications of calibration by
Bayesian procedures (Diekmann et al., 2013; Farah et al., 2014; Wang et al., 2020; Wu et al.,
2020). However, without taking the model imperfection into account in the conventional
Bayesian framework, the theoretical justification for the parameter estimation with imperfect
simulators are not fully developed. On the other hand, Bayesian calibration of Kennedy
and O’Hagan (2001) takes into account the model imperfection through Gaussian process
modeling, but it suffers from the unidentifiability issue when the parameter estimation
is of interest (Bayarri et al., 2007; Han et al., 2009; Hodges and Riech, 2010; Paciorek,
2010; Gramacy et al., 2015). Furthermore, most of the existing developments are based on
continuous outputs with a Gaussian assumption, which is not valid for the count data in
the epidemic models in our applications. Recent studies on addressing the unidentifiability
issue can be found in Plumlee (2017) and Tuo (2019).
3

The remainder of the paper is organized as follows. In Section 2, the new estimation
method based on L2 projection is introduced. Theoretical properties of the proposed
estimator are developed in Section 3. In Section 4, numerical studies are conducted to
demonstrate the finite sample performance of the proposed estimator and the empirical
comparison with the least squares estimator. In section 5, the estimation method is applied
to the study of COVID-19 based on an SEIR (Susceptible-Exposed-Infectious-Recovered)
compartmental model with both deterministic and stochastic simulations. Discussions and
concluding remarks are given in Section 6. Computational details for the estimation are
given in Appendix, and the mathematical proofs and the R (R Core Team, 2018) code for
implementation are provided in Supplementary Material.

2

Estimation for Compartmental Models in Epidemiology

2.1

Least squares estimator

Compartmental models are widely used mathematical models for the study of infectious
diseases, in which the population is assigned to compartments with labels such as S
(Susceptible), I (Infectious), and R (Recovered and immune) (Diekmann et al., 2013). For
example, the most basic compartment model in epidemiology is the SIR model, in which
each living individual is assumed to be in one of the above three compartments at any
given time. The model specifies the rates at which individuals change their compartment,
which include the progresses from S to I when infected, and from I to R upon recovery.
Various extensions to SIR have been extensively developed in the literature of epidemiology
(Heesterbeek et al., 2015).
4

Let f (x, θ) denote the number of people in the infectious compartment at time x ∈
Ω ⊆ R+ , where θ ∈ Θ ⊆ Rq is a set of unknown calibration parameters associated with the
compartmental model. For instance, an SIR model contains two parameters, θ = (β, γ),
where β is the infection rate controlling the transition from S to I, and γ is the recovery
rate controlling the transition from I and R. Suppose that yi is the reported number of
infected cases at time xi . Then, given the reported number of infected cases in n days,
{(xi , yi )}ni=1 , the commonly used approach to estimate the parameters is to minimize the
sum of squared differences between actual numbers of infected cases and simulation outputs
from compartmental models. The estimated parameters are denoted by θ̂nLS , where LS
stands for least squares, and they are obtained by
θ̂nLS

2.2

= arg min
θ∈Θ

n
X

(yi − f (xi , θ))2 .

(1)

i=1

Estimate Calibration Parameters by L2 Projection

Despite the wide applications of the least squares approach, it can be shown that the least
squares estimator does not achieve the semiparametric efficiency when the simulator f (x, θ)
is imperfect, meaning that the simulation output cannot perfectly fit the response, even
with the best fit of θ. The asymptotic variance can be reduced by the proposed estimator
introduced in this subsection. Theoretical justifications are provided in Section 3.
Assume that the number of cases yi follows a Poisson distribution: yi ∼ Poi(λ(xi )) for
i = 1, . . . , n, and yi and yj are mutually independent for any i 6= j. λ(xi ) is the true mean
function of yi . The function λ(x) is often called the true process in the computer experiment
literature (Kennedy and O’Hagan, 2001; Tuo and Wu, 2015, 2016). Ideally, if the underlying
mean function λ(x) is known, the true parameter can be defined as the minimizer of the

5

expected squared discrepancy between the true process and the simulation output, that is,
θ∗ = arg min E [λ(x) − f (x, θ)]2 .
θ∈Θ

If we assume that x is uniformly distributed, then it leads to the minimization of the L2
projection of the discrepancy. That is,
θ∗ = arg min kλ(·) − f (·, θ)kL2 (Ω) ,
θ∈Θ

where kgkL2 (Ω) =

R

g2
Ω

1/2

(2)

.

In reality, the underlying true process λ(·) is unknown that needs to be estimated by
observed data. Therefore, given the data {(xi , yi )}ni=1 , we propose to estimate the true
process by the kernel Poisson regression (van de Geer, 2000; Shim and Hwang, 2011). That
is, λ̂n (·) = exp{ξˆn (·)} and
n

1X
ξˆn = arg min
(exp{ξ(xi )} − yi ξ(xi )) + κn kξk2NΦ (Ω) ,
ξ∈NΦ (Ω) n
i=1

(3)

where k · k2NΦ (Ω) is the norm of the reproducing kernel Hilbert space generated by a given
positive definite reproducing kernel Φ, and κn is a tuning parameter, which can be chosen
by cross-validation methods. Thus, the proposed estimator of θ, which we call L2 -estimator
throughout this paper, is the minimizer of the L2 projection as follows:
θ̂n = arg min kλ̂n (·) − f (·, θ)kL2 (Ω) .
θ∈Θ

The optimal solution of (3) has the form of ξˆn (x) = b̂ +

Pn

i=1

(4)

âi Φ(xi , x), where b̂ and {âi }ni=1

can be obtained by the iterative re-weighted least squares algorithm (Green and Yandell,
6

1985; Hastie and Tibshirani, 1990; Wahba et al., 1995). The detail of the algorithm is given
in Appendix A. In practice, the calculation of the L2 norm in (4) can be approximated by
numerical integration methods, such as Monte Carlo integration (Caflisch, 1998).
For some stochastic agent-based simulations in epidemiology that can be computationally intensive, it is infeasible to obtain f (x, θ) by conducting simulations for all possible
combinations of the input parameters. In such cases, the simulator is often approximated by
a computationally cheaper, statistical emulator, which is denoted by fˆ(x, θ), and there are
extensive studies on the development of statistical emulators in the computer experiment
literature (Santner et al., 2018). For these simulators, the proposed L2 -estimator can be
similarly obtained by replacing f (x, θ) in (4) with its emulator fˆ(x, θ). The applications of
the proposed method with various existing emulators are demonstrated in Sections 4 and 5.

3

Theoretical Property

Theoretical properties of the L2 -estimator are discussed in this section, including the
asymptotic consistency and the semiparametric efficiency. Theoretical comparisons with the
least squares estimators are also provided by examining their asymptotic variances. The
proofs are given in Supplementary Material.
The following theorem shows that the L2 -estimator θ̂n in (4) is asymptotically consistent
and normally distributed.
Theorem 3.1. Under the regularity conditions C1-C10 in Supplementary Material S2, we
have
√
d
n(θ̂n − θ∗ ) →
− N (0, 4V −1 W0 V −1 ),

7

as n → ∞, where


∂f
∗ ∂f
∗
W0 = E λ(X) (X, θ ) T (X, θ )
∂θ
∂θ


∂2
∗ 2
and V = E
(λ(X) − f (X, θ )) .
∂θ∂θT


(5)

By the Delta’s method, the following corollary extends the result of Theorem 3.1 to a
function of the L2 -estimator, which we denote as g(θ̂n ).
Corollary 3.2. For a function g satisfying the property that ∇g(θ∗ ) exists and is non-zero
valued, we have
√

d

n(g(θ̂n ) − g(θ∗ )) →
− N (0, 4∇g(θ∗ )T V −1 W0 V −1 ∇g(θ∗ )),

as n → ∞.
Corollary 3.2 provides a theoretical support for the estimation and inference of some
commonly used quantities of interest in epidemiology, such as the basic reproduction rate,
which measures the transmission potential of a disease. For instance, in an SIR model the
basic reproduction rate is a ratio of two calibration parameters, that is, g(θ1 , θ2 ) = θ1 /θ2 ,
where θ1 = β and θ2 = γ. The result of Corollary 3.2 can then be applied to construct the
confidence intervals for the basic reproduction rate.
When estimating the unknown parameters in compartmental models, the parameters of
interest θ are q-dimensional, while the parameter space of model (4) contains an infinite
dimensional function space which covers λ. Therefore, the calibration problem is regarded
as a semiparametric problem. For these problems, the estimation method that can reach
the highest estimation efficiency is called semiparametric efficient (Bickel et al., 1993;
Kosorok, 2008). It can be shown in the following theorem that the proposed L2 -estimator
is semiparametric efficient.
8

Theorem 3.3. Under the regularity conditions in Theorem 3.1, θ̂n is semiparametric
efficient.
Remark 3.4. Theorems 3.1 and 3.3 remain valid even if the simulator f is replaced by
its emulator fˆ, provided that the emulator fˆ satisfies the conditions C11-C12 given in
Supplemental Material S2.
In the next theorem, the asymptotic properties of the least squares estimator are
developed and compared with those of the L2 -estimator.
Theorem 3.5. Under the regularity conditions C1-C4 and C13-C14 in Supplementary
Material S2, we have
√ LS
d
n(θ̂n − θ∗ ) →
− N (0, 4V −1 W1 V −1 ),
as n → ∞, where


∗ ∂f
∗
∗ 2 ∂f
(X, θ ) T (X, θ ) .
W1 = W0 + E (λ(X) − f (X, θ ))
∂θ
∂θ
Similar to the L2 -estimator, it is shown that the least squares estimator is asymptotically
consistent and normally distributed. It can also be shown that W1 ≥ W0 , which leads to
4V −1 W1 V −1 ≥ 4V −1 W0 V −1 . This implies that the asymptotic variance of the least squares
estimator θ̂nLS is greater or equal to that of θ̂n . The equation holds if and only if



∂f
∗
E (λ(X) − f (X, θ ))
(X, θ ) T (X, θ ) = 0.
∂θ
∂θ
This result indicates that, if

∗

∂f
(x, θ∗ )
∂θ

2 ∂f

∗

(6)

6= 0 for all x ∈ Ω, then (6) holds only if λ(x) = f (x, θ∗ )

for all x ∈ Ω, which implies that the least squares estimator θ̂nLS is less efficient than θ̂n if f
is an imperfect simulator, i.e., λ(x) 6= f (x, θ∗ ) for some x ∈ Ω.
9

4

Numerical Study

In this section, two artificial examples are conducted to examine the finite sample performance of the proposed method and compare the estimation performance with the least
squares approach. These numerical studies are conducted on a desktop with 3.5 GHz CPU
and 8GB of RAM, and 4 CPUs are available for parallel computing.

4.1

Imperfect simulator with one calibration parameter

We consider an imperfect simulator adapted from Tuo and Wu (2015) with one calibration
parameter. The true process is assumed to be λ(x) = exp(x/2) sin(x/2) + 3, where
x ∈ Ω = [0, 2π], and it is illustrated in the left panel of Figure 1 as the solid line. The data
are generated from equal-spaced inputs in [0, 2π] with n = 50 and the outputs are generated
from a Poisson distribution with the mean process λ(xi ) for i = 1, . . . , 50, which are shown
as the solid dots in the left panel of Figure 1.

√
We assume that the simulation output is f (x, θ) = λ(x)− θ2 − θ + 1(sin(θx)+cos(θx)),
√
where θ ∈ Θ = [−0.8, 0.8]. This simulator is imperfect because θ2 − θ + 1 is always positive
for any θ ∈ Θ. The true parameter can be analytically solved by minimizing (2), which gives
that θ∗ = −0.1789. Plugging in the true calibration parameter, the simulator f (x, θ∗ ) is
demonstrated as the dashed line, which is imperfect because, even with the true minimizer,
the discrepancy between the simulation output and the true process is nonzero.
The performance of the L2 -estimator is compared with the least squares estimator based
P
∗ 2
on the mean squared errors (MSE) obtained from 100 replicates, that is, 100
i=1 (θ̂i − θ ) /100,
where θ̂i is the estimate at the i-th replicate. Their MSEs are shown in the first two bars
in the right panel of Figure 1, which are decomposed into squared biases (dark red) and
variances (light blue). It shows that the L2 -estimator (“L2”) provides about 51% smaller
10

λ(x )

f (x, θ* )

Var

BiasSquare

0.292
0.3

MSE

y

12

8

0.2

0.176
0.14

0.1

0.085
0.05

4

0.0

0.002
L2

0

2

4

6

0.012

0.005

LSE

L2+
emulator

LSE+
emulator

x

Figure 1: (Left) The true process λ(x) as the solid line and the simulation output f (x, θ∗ ) as
the dashed line. The real outputs are illustrated as the solid dots. (Right) Mean squared error,
decomposed by bias squares (dark red) and variance (light blue), of the estimates.

MSE than the least squares estimator (“LSE”). Such a reduction is mainly due to the
reduction in the estimation variance of the L2 -estimator. On the other hand, the squared
biases are relatively small for both estimators, which is consistent with the asymptotic result
of estimation consistency in Section 3.
We further compare the estimation performance for the cases when the simulations are
computationally demanding and therefore statistical emulators are built as surrogates. Before
comparing the estimation performance, we first examine the emulation performance of two
existing emulation methods that are applicable to count data, which are the multiresolution
functional ANOVA emulation (Sung et al., 2020b) and the heteroscedastic Gaussian process
emulation (Binois et al., 2018). Both methods have available packages in R (R Core Team,
2018), which are MRFA (Sung, 2020) and hetGP (Binois and Gramacy, 2019), respectively.
11

These emulators are trained by conducting a computer experiment, which simulates the
model outputs of f (x, θ) of size m, where the inputs are sampled from (x, θ) ∈ (Ω, Θ) ∈ R2
using a Latin hypercube design (LHD) (McKay et al., 1979). For each input setting,
simulations are conducted with a replicates. The emulation performance is examined by
performing predictions on 10, 000 random untried input settings from (Ω, Θ). With four
different combinations of m and a, the root mean squared prediction errors (RMSPEs)
of the two emulators along with their computational time are reported in Table 1. In
this example, it appears that hetGP outperforms MRFA in terms of computational time
and RMSPE. Thus, we select the emulator built by hetGP as the surrogate to the actual
simulator in the following analysis.
Emulator

MRFA

hetGP

m

a

100
100
200
300
100
100
200
300

50
100
50
50
50
100
50
50

Fitting
time (sec.)
83
117
97
129
1
1
3
5

Prediction
time (sec.)
2
2
2
3
1
1
1
1

RMSPE
0.34
0.32
0.26
0.22
0.27
0.20
0.19
0.16

Table 1: Emulation performance for the example with one calibration parameter, where m is the
sample size of unique locations and a is the number of replicates. RMSPEs are reported for the
two emulators based on 10, 000 random predictive locations.

Next, we compare the estimation performance with the hetGP emulator built by m =
100, a = 100 samples. For both estimators, the actual simulator f (x, θ) is replaced by the
hetGP emulator. The MSEs of the L2 -estimator (“L2+emulator”) and the least squares
estimator (“LSE+emulator”) are shown in the last two bars in the right panel of Figure
1. Similar to the previous result without emulators, the L2 -estimator provides a smaller
12

MSE, squared bias, and variance compared to the least squares estimator. By comparing
the first two and last two bars, it is not surprising to see that the MSEs of “L2+emulator”
and “LSE+emulator” are larger than “L2” and “LSE” due to the prediction error from
emulation. It is also worth noting that the second bar is higher than the first and the third,
which indicates that, by choosing the proposed estimator, the MSE can be smaller than the
least squares estimator even if the simulations are approximated by an emulator.

4.2

Imperfect simulator with three calibration parameters

We consider a more complex problem with three calibration parameters adapted from
Plumlee (2017). Assume that the true mean process is λ(x) = 3x + 3x sin(5x) + 3 and the
simulator is f (x, θ) = θ1 + θ2 x + θ3 x2 , where x ∈ [0, 2] and θ ∈ [0, 5]3 . Similar to the previous
example, the three calibration parameters also have analytical solution θ∗ ≈ (3.56, 0.56, 1.76)
by minimizing (2).
50
The data {yi }50
i=1 are generated from the Poisson distribution with the mean {λ(xi )}i=1 ,

where the 50 inputs are uniformly sampled from [0, 2]. The estimation performance is
examined based on the MSEs obtained from 100 replicates, and the proposed estimator
and the least squares estimator are compared for each calibration parameter. The results
are shown in the first two bars in each plot of Figure 2, in which the y-axis represents the
MSEs. Similar to the previous example, the MSEs are decomposed into squared biases
(dark red) and the estimation variance (light blue). From these results, it appears that
the L2 -estimator outperforms the least squares estimator for all of the three parameters by
providing a smaller squared bias, variance, which result in a smaller MSE.
In this example, we also examine the prediction performance of the two existing emulators,
MRFA and hetGP. A computer experiment is conducted to train the two emulators by running
the simulation outputs of f (x, θ) at m unique sample locations with a replicates, in which
13

Var

BiasSquare

Var

0.352

BiasSquare

Var

1.686

BiasSquare

0.505

0.8

0.522

1.821
0.308

0.4

0.245

0.227

0.2

0.6

1.136
1

MSE

MSE

0.3

MSE

2

1.216

0.299

0.917

0.12
0.525

0.091

0.1

0.022
0.0

0.048

0
L2

LSE

L2+
LSE+
emulator emulator

θ1

L2

0.22

0.2

0.075

0.165

0.019

0.399

0.37
0.4

LSE

L2+
LSE+
emulator emulator

0.049

0.0
L2

θ2

LSE

L2+
LSE+
emulator emulator

θ3

Figure 2: Mean squared errors, decomposed by bias squares (dark red) and variances (light blue),
of the estimates of (left) θ1 , (middle) θ2 , and (right) θ3 .

the unique input locations are sampled from (x, θ) ∈ (χ, Θ) ⊆ R4 using an LHD. After the
emulators are built, the RMSEs are computed based on the predictions of 10, 000 untried
input locations, and the prediction results are summarized in Table 2 with different settings
of m and a. Similar to the previous example, the hetGP method outperforms MRFA in terms
of prediction accuracy and computational time. With a larger a, i.e., more replicates, the
prediction accuracy of hetGP appears to increase without much increase in computational
time. Thus, we select hetGP as the emulator in the following analysis.
We now compare the estimation performance for the cases where emulators are constructed as surrogates to the actual simulations. The emulator is built by hetGP with
m = 300, a = 100 and based on the emulator, the estimation performance is summarized by
the last two bars in each of the three plots in Figure 2. The results indicate that, either
when the actual simulator is conducted or emulated, the L2 -estimator provides smaller
squared biases, estimation variances, and MSEs compared to the least squares estimator.
14

Emulator

MRFA

hetGP

m

a

300
300
500
500
300
300
500
500

50
100
5
50
50
100
5
50

Fitting
time (sec.)
258
545
27
448
7
8
29
29

Prediction
time (sec.)
3
3
2
3
1
1
2
2

RMSPE
0.66
0.63
0.82
0.52
0.20
0.16
0.46
0.15

Table 2: Emulation performance for the example with three calibration parameters, where m is
the sample size of unique locations and a is the number of replicates. RMSPEs are reported for the
two emulators based on 10, 000 random predictive locations.

5

Applications to the Analysis of COVID-19

The proposed method is applied to estimate unknown parameters in compartmental models
for the analysis of COVID-19 pandemic. According to the epidemiology literature, the SEIR
model, which consists of four compartments, S usceptible-E xposed-I nfectious-Recovered,
is widely recommended for COVID-19 simulations because it accounts for the incubation
period through the exposed compartment (Wu et al., 2020; Carcione et al., 2020; Mwalili
et al., 2020; He et al., 2020; Annas et al., 2020). We focus on two types of SEIR simulators:
a deterministic simulator and a stochastic simulator, which are discussed in Sections 5.1 and
5.2, respectively. To estimate the unknown parameters in these two SEIR simulators, we
collect the actual numbers of infected cases from Johns Hopkins University CCSE repository
(Dong et al., 2020) through an R package covid19.analytics (Ponce, 2020). For each
country, there are 107 observations collected from March 1st, 2020, to June 15th, 2020,
denoted by yi , where i = 1, · · · , 107. The studies are conducted for the top 20 countries
which have the highest cumulative confirmed cases reported on June 15th, 2020.

15

5.1

Deterministic SEIR model

The SEIR model extends the idea of SIR to further consider an E compartment before
entering the I compartment, which indicates a significant incubation period during which
individuals have been infected but are not yet infectious themselves. Mathematically, a
deterministic SEIR model can be written as:
dS
βIS
=−
,
dx
N

dE
βIS
=
− κE,
dx
N

dI
= κE − γI,
dx

dR
= γI,
dx

where S, E, I and R represent the numbers of cases in the corresponding compartment,
N = S + E + I + R is the total population, x is time, β is the contact rate that represents
the average number of contacts per person per time in the susceptible compartment, γ
is the recovery rate from the infectious compartment, and κ is the incubation rate which
represents the rate of latent individuals becoming infectious, or equivalently, the average
incubation period is 1/κ. These ordinary differential equations have no analytical solution
but can be solved by numerical solvers, such as the ODEPACK (Hindmarsh, 1983). The
basic reproduction number, R0 = β/γ, is the expected number of new infected cases from
an infectious individual in a population where all subjects are susceptible. It is of great
interest in epidemiology because it provides the insight of the virus transmission, which is
essential to the development of effective strategies to contain the pandemic. An accurate
and efficient estimation of R0 is not only important for the public safety, but it also has
significant impacts on global economy.
This model includes five unknown parameters: β, κ, γ and the initial numbers of infectious
and exposed cases (denoted by I0 and E0 , respectively), so we have θ = (β, κ, γ, I0 , E0 ). For
each country, the L2 -estimator of θ is obtained by minimizing (4), and the corresponding
estimated reproduction number R0 can be calculated by R0 = β/γ. The point estimates of
16

4

R0

3
2

Bangladesh

Russia

Mexico

India

Pakistan

Saudi Arabia

Canada

Peru

France

Brazil

Turkey

Qatar

Iran

Spain

Chile

US

United Kingdom

Italy

Germany

China

1

Figure 3: The estimated reproduction numbers for top-20 infectious countries based on the
deterministic SEIR model.

R0 and their 95% confidence intervals, which are obtained by the result of Corollary 3.2,
are summarized in Figure 3 for the 20 countries. It shows that, from March to June, only
two countries have their basic reproduction number controlled below 1 and the COVID-19
outbreak still post threats to most of the countries.
Plugging in the L2 -estimators, the simulation results for the top 12 countries with the
highest R0 are demonstrated as the red curves in Figure 4. In general, it appears that
the simulation results can reasonably capture the overall trend observed from the actual
numbers of infected cases, which are shown as the gray dots. For Canada, France, and
Turkey, the discrepancy between the simulation results and actual observations is relatively
larger than the other countries. This is partly because SEIR is an imperfect simulator which
is built based on some assumptions or simplifications, and these assumptions may have
larger deviations from the reality for certain countries. Another reason is that the intrinsic

17

18
June

Turkey

May

15000 30000

June

May

April

March

June

0e+00

6e+04

active cases

20000

Canada

April

0

active cases

May

April

March

0

40000

active cases

20000

June

May

April

March

June

May

April

March

June

May

April

March

June

May

April

March

0

0

0

0

50000

250000

20000

150000

active cases

10000

active cases

100000

active cases

30000 60000

Mexico

March

June

80000

0

80000

active cases

40000

Saudi Arabia

May

40000

June

May

April

March

June

May

April

March

0

Russia

April

0

active cases

Brazil

March

June

2e+05

France

May

0e+00

active cases

6e+04

Pakistan

April

March

June

May

April

March

0e+00

Bangladesh
India

Peru

Qatar

Figure 4: The gray dots are the actual numbers of infected cases. The red solid lines are the
results from deterministic SEIR simulators by plugging in the L2 estimates of the calibration
parameters.

dynamics are neglected in the deterministic simulations. To take into account the dynamics,
a stochastic simulator is considered in the next subsection.

5.2

Stochastic SEIR model

A stochastic SEIR simulation provides a more sophisticated and realistic framework to
integrate infection dynamics in different compartments as continuous-time Markov chains
(Allen, 2008; Andersson and Britton, 2012; Allen, 2017). To conduct these simulations, we
implement an R package, SimInf (Widgren et al., 2019), in which the simulation results
are obtained by the Gillespie stochastic algorithm (Gillespie, 1977). Stochastic SEIR
simulations are computationally more demanding. For example, it takes more than 10
minutes to produce one simulation result for one country under a given parameter setting.
It is computationally infeasible to perform simulations for all the possible combinations
of the parameters; therefore, an emulator is constructed as an efficient surrogate to the
actual simulation. In this study, we consider the hetGP emulator, which is built based on
the simulations generated using a 60-run LHD for parameter settings with 19 equal-spaced
time steps in x, which leads to the total sample size of m = 1140. For each parameter-input
setting, 100 replicates are simulated, i.e., a = 100. Based on this emulator, it takes less than
two seconds to emulate the result for an untried parameter setting, which is significantly
faster than the actual stochastic simulation.
By replacing the actual simulator with the hetGP emulator, the L2 -estimators are
obtained by minimizing (4). The corresponding estimates of R0 and their 95% confidence
intervals are summarized in Figure 5, where the variance is calculated by using V[θ̂n ] =
V[E[θ̂n |f ]] + E[V[θ̂n |f ]] and the result of Corollary 3.2. The confidence intervals obtained
from the stochastic simulations are wider than the deterministic ones because additional
uncertainty from infection dynamics is incorporated. The estimated mean values of R0 for
19

China and Germany remain the smallest which agrees with the findings in the deterministic
simulations, but Germany appears to have higher R0 than the one obtained from the
deterministic simulations. We further report the estimated incubation period, 1/κ, for each
country and the corresponding 95% confidence intervals in Figure 6. The overall average
incubation period is 6.31 as indicated by the red dashed line.
In Figure 7, the actual numbers of infected cases are illustrated as the gray dots. By
plugging in the L2 -estimators, the simulation results for the top-12 countries with the
highest R0 are illustrated as the red curves, along with the 95% predictive intervals as the
red-shaded regions. Overall, the simulation results show a much better agreement with
the actual observations compared to the deterministic ones in Section 5.1. In particular,
by taking into account the intrinsic dynamics, the simulation discrepancy for Canada is
significantly reduced from the deterministic one shown in Figure 4.

6

Discussions and Concluding Remarks

A new calibration method is proposed to estimate the unknown parameters in epidemic
models. The proposed estimator outperforms the least squares estimator by providing a
smaller estimation variance and achieving the semiparametric efficiency. The proposed
method is applied to the SEIR model for the analysis of COVID-19 pandemic. The estimates
of the quantities of interest, such as the basic reproduction number and the average incubation
period, and their confidence intervals are obtained based on the asymptotic results.
Apart from the frequentist approach studied in this paper, we are currently developing
a Bayesian framework that extends the recent developments of Bayesian calibration to
count data. For example, the orthogonal Gaussian process models (Plumlee et al., 2016) or
the projected Gaussian process (Tuo, 2019) can be used to model the model discrepancy,

20

21
Peru

Iran

Germany

Brazil

Turkey

Chile

India

Italy

Mexico

Russia

Bangladesh

Pakistan

United Kingdom

France

Qatar

Spain

China

Saudi Arabia

Canada

US

1 κ

Bangladesh

United Kingdom

US

Peru

India

Russia

Chile

Canada

Brazil

Pakistan

Mexico

Turkey

Qatar

Saudi Arabia

France

Spain

Italy

Iran

Germany

China

R0
8

6

4

2

0

Figure 5: The reproduction numbers of top-20 infectious countries based on the stochastic SEIR
model.
20

15

10

5

0

Figure 6: The estimated average incubation period based on the stochastic SEIR model.

22
June

80000

June

May

April

March

0

80000

20000

active cases

40000

250000

Chile

May

40000

June

May

April

March

0

active cases

100000

June

May

April

March

June

May

April

March

June

May

April

March

June

May

April

March

0e+00

0

0

0

1400000

6e+04

active cases

600000

active cases

100000

active cases

30000 60000

US

April

0

active cases

Mexico

March

June

20000

Pakistan

May

10000

June

May

April

March

0

150000

active cases

50000

Russia

April

0

active cases

80000

June

May

April

March

0

United Kingdom

March

June

May

40000

Brazil

April

0

active cases

2e+05

India

March

June

May

April

March

0e+00

Bangladesh
Peru

Canada

Turkey

Figure 7: Number of infectious (gray dots) and the best fit of the stochastic SEIR models (red
solid lines) of top-12 most infectious countries, where the red-shaded regions are their corresponding
95% confidence intervals.

which addresses the unidentifiability issue for continuous outputs, and it is conceivable to
further extend the modeling to count data by incorporating the idea of the generalized
calibration in Grosskopf et al. (2020). Another interesting direction that deserves further
studies is to relax the constant parameter assumption. Instead, the calibration parameters
can be assumed to be functions of some factors, such as time or temperature, which not
only increases the model flexibility but also can provide further insights to the time-course
dynamics of the COVID-19 infection.
Acknowledgements: This work was supported by NSF DMS 1660477 and NSF HDR
TRIPODS award CCF 1934924.

Appendices
A

Algorithm to Estimate ξˆn in (3)

Since the optimal solution has the form of ξn (x) = b +

Pn

i=1

ai Φ(xi , x), one can show that

the penalized likelihood in (3) can be rewritten as
n



1 X
exp b + aT φ(xi ) − yi b + aT φ(xi ) + κn aT Φa,
n i=1
where a = (a1 , . . . , an ), φ(x) = (Φ(x, x1 ), . . . , Φ(x, xn )), and Φ = (Φ(xi , xj ))1≤i,j≤n . The
optimal solution of a and b can then be obtained by taking the first-order partial derivatives
of the objective function with respect to a and b and setting them equal to zero, which can

23

be solved by the iterative re-weighted least squares algorithm as follows. Denote

Φ0 = 

0

0Tn

0n

Φ


,

Φ1 =



1n Φ



,

where 1n = [1, . . . , 1]T and 0n = [0, . . . , 0]T , and denote W as an n × n diagonal matrix
with diagonal elements Wii = exp(b + aT φ(xi )). Then, in each step, one first solve for
β := (b, aT )T in
ΦT1 WΦ1 + 2nκn Φ0

−1

β = ΦT1 Wη,

with an initial guess of η, which is a vector of size n, and then update each element of η by
η i = (b + aT φ(xi )) +

yi − exp(b + aT φ(xi ))
.
exp(b + aT φ(xi ))

The estimate β̂ can then be obtained by continuing solving for β and η iteratively until
some convergence criterion is met.

References
Allen, L. J. S. (2008). An introduction to stochastic epidemic models. In Mathematical
Epidemiology, pages 81–130. Springer.
Allen, L. J. S. (2017). A primer on stochastic epidemic models: Formulation, numerical
simulation, and analysis. Infectious Disease Modelling, 2(2):128–142.
Anastassopoulou, C., Russo, L., Tsakris, A., and Siettos, C. (2020). Data-based analysis,
modelling and forecasting of the COVID-19 outbreak. PLoS One, 15(3):e0230405.

24

Andersson, H. and Britton, T. (2012). Stochastic Epidemic Models and Their Statistical
Analysis. Springer Science & Business Media.
Annas, S., Pratama, M. I., Rifandi, M., Sanusi, W., and Side, S. (2020). Stability analysis
and numerical simulation of SEIR model for pandemic COVID-19 spread in Indonesia.
Chaos, Solitons & Fractals, to appear.
Bayarri, M. J., Berger, J. O., Paulo, R., Sacks, J., Cafeo, J. A., Cavendish, J., Lin, C.-H.,
and Tu, J. (2007). A framework for validation of computer models. Technometrics,
49(2):138–154.
Bentout, S., Chekroun, A., and Kuniya, T. (2020). Parameter estimation and prediction
for coronavirus disease outbreak 2019 (COVID-19) in algeria. AIMS Public Health,
7(2):306–318.
Bickel, P. J., Klaassen, C. A. J., Ritov, Y., and Wellner, J. A. (1993). Efficient and Adaptive
Estimation for Semiparametric Models. Johns Hopkins Univ. Press, Baltimore, MD.
Binois, M. and Gramacy, R. B. (2019). hetGP: Heteroskedastic Gaussian Process Modeling
and Design under Replication. R package version 1.1.1.
Binois, M., Gramacy, R. B., and Ludkovski, M. (2018). Practical heteroscedastic Gaussian process modeling for large simulation experiments. Journal of Computational and
Graphical Statistics, 27(4):808–821.
Caflisch, R. E. (1998). Monte Carlo and quasi-Monte Carlo methods. Acta Numerica,
7(1):1–49.
Capaldi, A., Behrend, S., Berman, B., Simth, J., Wright, J., and Lloyd, A. L. (2012).

25

Parameter estimation and uncertainty quantification for an epidemic model. Mathematical
Biosciences and Engineering, 9(3):553–576.
Carcione, J. M., Santos, J. E., Bagaini, C., and Ba, J. (2020). A simulation of a COVID-19
epidemic based on a deterministic SEIR model. Frontiers in Public Health, to appear.
Chen, X. and Qiu, Z. (2020). Scenario analysis of non-pharmaceutical interventions on
global COVID-19 transmissions. Covid Economics: Vetted and Real-Time Papers, Centre
for Economic Policy Research, (7):46–67.
Chowell, G. (2017). Fitting dynamic models to epidemic outbreaks with quantified uncertainty: A primer for parameter uncertainty, identifiability, and forecasts. Infectious
Disease Modelling, 2(3):379–398.
Chowell, G., Castillo-Chavez, C., Fenimore, P. W., Kribs-Zaleta, C. M., Arriola, L., and
Hyman, J. M. (2004). Model parameters and outbreak control for sars. Emerging
Infectious Diseases, 10(7):1258.
Chowell, G., Fenimore, P. W., Castillo-Garsow, M. A., and Castillo-Chavez, C. (2003).
SARS outbreaks in Ontario, Hong Kong and Singapore: the role of diagnosis and isolation
as a control mechanism. Journal of Theoretical Biology, 224(1):1–8.
Diekmann, O., Heesterbeek, J. A. P., and Britton, T. (2013). Mathematical Tools for
Understanding Infectious Disease Dynamics. Princeton Univ. Press, Princeton.
Dong, E., Du, H., and Gardner, L. (2020). An interactive web-based dashboard to track
COVID-19 in real time. The Lancet Infectious Diseases, 20(5):533–534.
Epstein, J. M. (2009). Modelling to contain pandemics. Nature, 460(7256):687.

26

Farah, M., Birrell, P., Conti, S., and Angelis, D. D. (2014). Bayesian emulation and
calibration of a dynamic epidemic model for A/H1N1 influenza. Journal of the American
Statistical Association, 109(508):1398–1411.
Funk, S., Gilad, E., Watkins, C., and Jansen, V. A. A. (2009). The spread of awareness
and its impact on epidemic outbreaks. Proceedings of the National Academy of Sciences,
106(16):6872–6877.
Gillespie, D. T. (1977). Exact stochastic simulation of coupled chemical reactions. The
Journal of Physical Chemistry, 81(25):2340–2361.
Giordano, G., Blanchini, F., Bruno, R., Colaneri, P., D. F. A., Di Matteo, A., and Colaneri,
M. (2020). Modelling the COVID-19 epidemic and implementation of population-wide
interventions in Italy. Nature Medicine, 26(6):855–860.
Gramacy, R. B., Bingham, D., Holloway, J. P., Grosskopf, M. J., Kuranz, C. C., Rutter,
E., Trantham, M., Drake, R. P., et al. (2015). Calibrating a large computer experiment
simulating radiative shock hydrodynamics. The Annals of Applied Statistics, 9(3):1141–
1168.
Green, P. J. and Yandell, B. S. (1985). Semi-parametric generalized linear models. In
Proceedings 2nd International GLIM Conference, Lancaster, Lecture Notes in Statistics
No. 32, pages 44–55. New York: Springer.
Grosskopf, M., Bingham, D., Adams, M. L., Hawkins, W. D., and Perez-Nunez, D. (2020).
Generalized computer model calibration for radiation transport simulation. Technometrics,
in press.

27

Han, G., Santner, T. J., and Rawlinson, J. J. (2009). Simultaneous determination of tuning
and calibration parameters for computer experiments. Technometrics, 51(4):464–474.
Hastie, T. and Tibshirani, R. (1990). Generalized Additive Models. New York: Chapman
and Hall.
He, S., Peng, Y., and Sun, K. (2020). SEIR modeling of the COVID-19 and its dynamics.
Nonlinear Dynamics, to appear.
Heesterbeek, H., Anderson, R. M., Andreasen, V., Bansal, S., De Angelis, D., Dye, C.,
Eames, K. T., Edmunds, W. J., Frost, S. D., Funk, S., Hollingsworth, T. D., House11,
T., Isham, V., Klepac, P., Lessler, J., Lloyd-Smith, J. O., Metcalf, C. J. E., Mollison, D.,
Pellis, L., Pulliam, J. R. C., Roberts, M. G., Viboud, C., and Isaac Newton Institute IDD
Collaboration (2015). Modeling infectious disease dynamics in the complex landscape of
global health. Science, 347(6227):aaa4339.
Hindmarsh, A. C. (1983). ODEPACK, a systematized collection of ode solvers. Scientific
Computing, pages 55–64.
Hodges, J. S. and Riech, B. J. (2010). Adding spatially-correlated errors can mess up the
fixed effect you love. The American Statistician, 64(4):325–334.
Kennedy, M. C. and O’Hagan, A. (2001). Bayesian calibration of computer models. Journal
of the Royal Statistical Society: Series B, 63(3):425–464.
Kosorok, M. R. (2008). Introduction to Empirical Processes and Semiparametric Inference.
Springer, New York.
McKay, M. D., Beckman, R. J., and Conover, W. J. (1979). Comparison of three methods

28

for selecting values of input variables in the analysis of output from a computer code.
Technometrics, 21(2):239–245.
Mwalili, S., Kimanthi, M., Ojiambo, V., Gathungu, D., and Mbogo, R. W. (2020). SEIR
model for COVID-19 dynamics incorporating the environment and social distancing.
BMC Research Notes, to appear.
Paciorek, C. J. (2010). The importance of scale for spatial-confounding bias and precision
of spatial regression estimators. Statistical Science, 25:107–125.
Plumlee, M. (2017). Bayesian calibration of inexact computer models. Journal of the
American Statistical Association, 112(519):1274–1285.
Plumlee, M., Joseph, V. R., and Yang, H. (2016). Calibrating functional parameters in
the ion channel models of cardiac cells. Journal of the American Statistical Association,
111(514):500–509.
Ponce, M. (2020). covid19.analytics: Load and Analyze Live Data from the CoViD-19
Pandemic. R package version 1.1.
R Core Team (2018). R: A Language and Environment for Statistical Computing. R
Foundation for Statistical Computing, Vienna, Austria.
Santner, T. J., Williams, B. J., and Notz, W. I. (2018). The Design and Analysis of
Computer Experiments. Springer New York, second edition.
Shim, J. and Hwang, C. (2011). Kernel poisson regression machine for stochastic claims
reserving. Journal of the Korean Statistical Society, 40(1):1–9.

29

Sung, C.-L. (2020). MRFA: Fitting and Predicting Large-Scale Nonlinear Regression
Problems using Multi-Resolution Functional ANOVA (MRFA) Approach. R package
version 0.5.
Sung, C.-L., Hung, Y., Rittase, W., Zhu, C., and Wu, C. F. J. (2020a). A generalized
Gaussian process model for computer experiments with binary time series. Journal of the
American Statistical Association, 115(530):945–956.
Sung, C.-L., Wang, W., Plumlee, M., and Haaland, B. (2020b). Multiresolution functional
ANOVA for large-scale, many-input computer experiments. Journal of the American
Statistical Association, 115(530):908–919.
Tuo, R. (2019).

Adjustments to computer models via projected kernel calibration.

SIAM/ASA Journal on Uncertainty Quantification, 7(2):553–578.
Tuo, R. and Wu, C. F. J. (2015). Efficient calibration for imperfect computer models. The
Annals of Statistics, 43(6):2331–2352.
Tuo, R. and Wu, C. F. J. (2016). A theoretical framework for calibration in computer
models: parametrization, estimation and convergence properties. SIAM/ASA Journal on
Uncertainty Quantification, 4(1):767–795.
van de Geer, S. (2000). Empirical Processes in M-estimation. Cambridge University Press.
Wahba, G., Gu, C., Wang, Y., and Campbell, R. (1995). Soft classification, a.k.a. risk
estimation, via penalized log likelihood and smoothing spline analysis of variance. In
The Mathematics of Generalization, ed. D. H. Wolpert, Santa Fe Institute Studies in the
Sciences of Complexity, Reading, MA: Addison-Wesley, pages 329–360.

30

Wang, L., Zhou, Y., He, J., Wang, F., Tang, L., E. M., and Song, P. (2020). An epidemiological forecast model and software assessing interventions on COVID-19 epidemic in
china. MedRxiv preprint.
White, H. (1982). Maximum likelihood estimation of misspecified models. Econometrica,
50(1):1–25.
Widgren, S., Bauer, P., Eriksson, R., and Engblom, S. (2019). SimInf: An R package
for data-driven stochastic disease spread simulations. Journal of Statistical Software,
91(12):1–42.
Wu, J. T., Leung, K., and Leung, G. M. (2020). Nowcasting and forecasting the potential
domestic and international spread of the 2019-nCoV outbreak originating in wuhan, china:
A modelling study. The Lancet, 395(10225):689–697.

31

Supplementary Materials for “Efficient Calibration for
Imperfect Epidemic Models with Applications to the
Analysis of COVID-19”

S1

Asymptotic Results of ξˆn of (3)

We start with a result developed by van de Geer (2000) for general nonparametric regression
(Lemma 11.4 and 11.5 in van de Geer (2000)). Denote
λ0 (x) = exp{ξ0 (x)}.

(S1.1)

Suppose F is the class of all regression functions equipped with the Sobolev norm k · kH m (Ω) ,
which is defined by
kξk2H m (Ω) = kξk2L2 (Ω) +
Let

m
X
∂ iξ
∂xi
i=1

2

.
L2 (Ω)

n

1X
ξˆn0 := arg min
(exp{ξ(xi )} − yi ξ(xi )) + κn kξk2H m (Ω) ,
ξ∈F n
i=1
for some κn > 0. Then the convergence rate of ξˆn0 is given in the following lemma.
Lemma S1.1. Let ξ0 ∈ F. Assume that there exists some nonnegative k0 and k1 so that
k02 ≤ exp{ξ0 (x)} ≤ 1 − k02

and

| exp{z}| ≥ k1 > 0 for all

|z − z0 | ≤ k1 ,

2m/(2m+1)
), we have
where z0 = ξ0 (x) and x ∈ Ω. For κ−1
n = O(n

kξˆn0 k = Op (1), k exp{ξˆn0 } − exp{ξ0 }kL2 (Ω) = Op (κn1/2 ),

1

and
kξˆn0 − ξ0 kL2 (Ω) = Op (κn1/2 ).
In fact, the norms of some reproducing kernel Hilbert spaces (RKHS) are equivalent to
Sobolev norms. For instance, the RKHS generated by the Matérn kernel function, given by
1
Φ(x, x ) =
Γ(ν)2ν−1
0



√ kx − x0 k
2 ν
ρ

ν



√ kx − x0 k
Kν 2 ν
,
ρ

(S1.2)

where ν ≥ 1 and ρ ∈ R+ are tuning parameters and Kν is a Bessel function with parameter ν,
is equal to the (fractional) Sobolev space H ν+d/2 (Ω), and the corresponding norms k · kNΦ (Ω)
and k · kH ν+d/2 (Ω) are equivalent (Wendland, 2004; Tuo and Wu, 2016). Therefore, as a
consequence of Lemma S1.1, we have the following proposition for ξˆn obtained by (3).
Proposition S1.2. Suppose that ξ0 ∈ F = NΦ (Ω), and NΦ (Ω) can be embedded into
2m/(2m+d)
H m (Ω). Then, for κ−1
), the estimator ξˆn in (3) and λ̂n = exp{ξˆn } satisfy
n = O(n
kξˆn kNΦ (Ω) = Op (1),

kλ̂n − λ0 kL2 (Ω) = Op (κn1/2 ),

and
kξˆn − ξ0 kL2 (Ω) = Op (κn1/2 ).
Proposition S1.2 suggests that one may choose κn  n−2m/(2m+d) to obtain the best
convergence rate kλ̂n − λ0 kL2 (Ω) = Op (n−m/(2m+d) ), where an  bn denotes that the two
positive sequences an and bn have the same order of magnitude.

S2

Regularity conditions for Theorems 3.1, 3.3, 3.5,
and Remark 3.4

The regularity conditions for Theorem 3.1 are given below. For any θ ∈ Θ ⊂ Rq , write
θ = (θ1 , . . . , θq ). Denote ei = yi − λ(xi ) and ξ(·) = log λ(·).
2

C1: The sequences {xi } and {ei } are independent; xi ’s are i.i.d. from a uniform distribution
over Ω; and {ei } is a sequence of i.i.d. random variables with zero mean and finite
variance.
C2: θ∗ is the unique solution to (2) and is an interior point of Θ.
C3: supθ∈Θ kf (·, θ)kL2 (Ω) < +∞.
h 2
i
∂
∗ 2
C4: V := E ∂θ∂θ
(λ(X)
−
f
(X,
θ
))
is invertible.
T
C5: There exists a neighborhood U ⊂ Θ of θ∗ such that
sup
θ∈U

∂f
(·, θ)
∂θi

< +∞,
NΦ (Ω)

∂ 2f
(·, ·) ∈ C(Ω × U ),
∂θi ∂θj

for all θ ∈ U and all i, j = 1, . . . , q.


∗ ∂f
∗
C6: W0 = E λ(X) ∂f
(X,
θ
)
(X,
θ
)
is positive definite.
T
∂θ
∂θ
C7: ξ ∈ NΦ (Ω) and NΦ (Ω, ρ) is Donsker for all ρ > 0.
C8: kλ̂n − λkL2 (Ω) = op (1).
C9: kξˆn kNΦ (Ω) = Op (1).
C10: κn = op (n−1/2 ).
The Donsker property is an important concept in the theoretical studies of empirical
processes. The definition and detailed discussion are referred to van der Vaart and Wellner
(1996) and Kosorok (2008). Tuo and Wu (2015) showed that if the conditions of Proposition
S1.2 hold and m > d/2, then NΦ (Ω, ρ) is a Donsker. The authors also mentioned that
under the condition C1 and E[exp{C|yi − λ(xi )|}] < +∞ for some C > 0, the conditions
of Proposition S1.2 are satisfied. Therefore, by choosing a suitable sequence of κn , say

3

κn  n−2m/(2m+d) , one can show that condition C10 holds and C8 and C9 are ensured by
Proposition S1.2.
Additional regularity conditions for Theorem 3.4 are given below, where we assume that
there are more than n samples in the computer experiments for building the emulator fˆ.
C11: kfˆ − f kL∞ (Ω×Θ) = op (n−1/2 ).
ˆ

∂f
C12: k ∂θ
−
i

∂f
k
∂θi L∞ (Ω×Θ)

= op (n−1/2 ) for i = 1, . . . , q.

Additional regularity conditions for Theorem 3.5 are given below.
C13: Suppose that there exists a neighborhood U of θ∗ such that f (x, ·) ∈ C 2,1 (U ) for
all x ∈ Ω, where C 2,1 denotes the space of functions whose second derivatives are
Lipschitz.


∂f
∗
C14: W1 = W0 + E (λ(X) − f (X, θ∗ ))2 ∂f
(X, θ∗ ) ∂θ
T (X, θ ) is positive definite.
∂θ

S3

Proof of Theorem 3.1

In this section, we replace the simulator f in (4) with the emulator fˆ satisfying the conditions
C11-C12, and treat the simulator f as a special case. That is, let
θ̂n = arg min kλ̂n (·) − fˆ(·, θ)kL2 (Ω) .
θ∈Θ

(S3.3)

This covers the result of Remark 3.4.
We first show that under the regularity conditions C1-C12 in Supplementary Material
S2,
θ̂n − θ∗ = 2V −1
where

!
n
X
1
∂f
(yi − λ(xi )) (xi , θ∗ ) + op (n−1/2 ),
n i=1
∂θ


∂2
∗ 2
V =E
(λ(X) − f (X, θ )) .
∂θ∂θT


4

The proof is developed along the lines described in Theorem 1 of Tuo and Wu (2015) and
p

− θ∗ . It suffices to
Theorem 3.1 of Sung et al. (2020). We first prove the consistency, θ̂n →
prove that kλ̂n (·) − fˆ(·, θ)kL2 (Ω) converges to kλ(·) − f (·, θ)kL2 (Ω) uniformly with respect to
θ ∈ Θ in probability, which is ensured by
kλ̂n (·) − fˆ(·, θ)k2L2 (Ω) − kλ(·) − f (·, θ)k2L2 (Ω)
(S3.4)
Z 


=
λ̂n (z) − λ(z) − fˆ(z, θ) + f (z, θ) λ̂n (z) + λ(z) − fˆ(z, θ) − f (z, θ) dz
Ω



ˆ
ˆ
≤ kλ̂n − λkL2 (Ω) + kf (·, θ) − f (·, θ)kL2 (Ω) kλ̂n kL2 (Ω) + kλkL2 (Ω) + kf (·, θ)kL2 (Ω) + kf (·, θ)kL2 (Ω) ,
where the inequality follow from the Schwarz inequality and the triangle inequality.
p
Since it can be shown that kf kL2 (Ω) ≤ Vol(Ω)kf kL∞ (Ω) , for any f ∈ L∞ (Ω), where
Vol(Ω) is the volume of Ω, we have
p
kλ̂n kL2 (Ω) = k exp{ξˆn }kL2 (Ω) ≤ Vol(Ω)k exp{ξˆn }kL∞ (Ω)
n
o
p
≤ Vol(Ω) exp kξˆn kL∞ (Ω)


p
= Vol(Ω) exp sup < ξˆn , Φ(·, x) >NΦ (Ω)
x∈Ω


p
≤ Vol(Ω) exp kξˆn kNΦ (Ω) sup kΦ(·, x)kNΦ (Ω)
x∈Ω
n
o
p
= Vol(Ω) exp kξˆn kNΦ (Ω) ,

(S3.5)

and
kfˆ(·, θ) − f (·, θ)kL2 (Ω) ≤

p
Vol(Ω)kfˆ(·, θ) − f (·, θ)kL∞ (Ω)
p
≤ Vol(Ω)kfˆ − f kL∞ (Ω,Θ) .

(S3.6)

By combining (S3.5) and (S3.6) and the conditions C8, C9, and C11, we have that (S3.4)
converges to 0 uniformly with respect to θ ∈ Θ, which proves the consistency of θ̂n .
5

Since θ̂n minimizes (S3.3), by invoking conditions C1, C2 and C5, we have
∂
kλ̂n (·) − fˆ(·, θ̂n )k2L2 (Ω)
∂θ
Z 
 ∂ fˆ
λ̂n (z) − fˆ(z, θ̂n )
=2
(z, θ̂n )dz,
∂θ
Ω

0=

and by the conditions C8, C11 and C12, it implies
Z 
 ∂f
λ̂n (z) − f (z, θ̂n )
(z, θ̂n )dz = op (n−1/2 ).
∂θ
Ω
Let l(ξ) =

1
n

Pn

i=1

(S3.7)

(exp{ξ(xi )} − yi ξ(xi )) + κn kξk2NΦ (Ω) . From (3), we know that ξˆn
p

minimizes l over NΦ (Ω). Since θ̂n →
− θ∗ and by condition C5,

∂f
(·, θ̂n )
∂θj

∈ NΦ (Ω) for

j = 1, . . . , q with sufficiently large n. Then we have
∂ ˆ
∂f
(·, θ̂n ))|t=0
l(ξn (·) + t
∂t
∂θj
n
 ∂f
1 X
∂f
=
yi − exp{ξˆn (xi )}
(xi , θ̂n ) + 2κn < ξˆn ,
(·, θ̂n ) >NΦ (Ω)
n i=1
∂θj
∂θj
n
n
 ∂f
1X
1 X
∂f
ˆ
exp{ξn (xi )} − exp{ξ(xi )}
(xi , θ̂n ) +
(xi , θ̂n )
=−
(yi − exp{ξ(xi )})
n i=1
∂θj
n i=1
∂θj

0=

∂f
+ 2κn < ξˆn ,
(·, θ̂n ) >NΦ (Ω)
∂θj
:= Cn + Dn + En .

(S3.8)

∂f
We first consider Cn . Let Ai (g, θ) = [exp{g(xi )} − exp{ξ(xi )}] ∂θ
(xi , θ) for (g, θ) ∈
j

NΦ (Ω, ρ) × Θ for some ρ > 0. Define the empirical process
n

1 X
E1n (g, θ) = √
{Ai (g, θ) − E[Ai (g, θ)]} ,
n i=1

6

where E[Ai (g, θ)] =

R
Ω

∂f
[exp{g(z)} − exp{ξ(z)}] ∂θ
(z, θ)dz. By condition C7, NΦ (Ω, ρ) is
j

Donsker. Thus, by Theorem 2.10.6 in van der Vaart and Wellner (1996), F1 = {exp{g} −
exp{ξ} : g ∈ NΦ (Ω, ρ)} is also Donsker because the exponential function is a Lipschitz
∂f
function. By condition C5, the class F2 = { ∂θ
(·, θ̂n ), θ ∈ U } is Donsker. Since both F1 and
j

F2 are uniformly bounded, by Example 2.10.8 in van der Vaart and Wellner (1996) the
product class F1 × F2 is also Donsker. Thus, the asymptotic equicontinuity property holds,
which implies that for any  > 0 there exists a δ > 0 such that
lim sup Pr
n→∞

sup
ζ∈F1 ×F2 ,kζk≤δ

!
n
1 X
√
(ζ(xi ) − E(ζ(xi ))) >  < ,
n i=1

where kζk2 := E[ζ(xi )2 ]. See Theorem 2.4 of Mammen and van de Geer (1997). This implies
that for any  > 0 there exists a δ > 0 such that
!
lim sup Pr
n→∞

|E1n (g, θ)| > 

sup

< .

(S3.9)

g∈NΦ (Ω,ρ),θ∈U,k exp{g}−exp{ξ}kL2 (Ω) ≤δ

Suppose ε > 0 is a fixed value. Condition C9 implies that there exists ρ0 > 0 such that
ˆ N > ρ0 ) ≤ ε/3. In addition, choose δ0 to be a possible value of δ which satisfies (S3.9)
P r(kξk
Φ

with  = ε/3 and ρ = ρ0 . Condition C8 implies that Pr(k exp{ξˆn }−exp{ξ}kL2 (Ω) > δ0 ) < ε/3.
Define


ξˆn , if kξˆn kN (Ω) ≤ ρ0 and k exp{ξˆn } − exp{ξ}kL (Ω) ≤ δ0 ,
2
Φ
ξˆn◦ =
ξ, otherwise.

7

Then, for sufficiently large n, we have
Pr(|E1n (ξˆn , θ̂n )| > ε) ≤ Pr(|E1n (ξˆn◦ , θ̂n )| > ε) + Pr(kξˆn kNΦ (Ω) > ρ0 )
+ Pr(k exp{ξˆn } − exp{ξ}kL2 (Ω) > δ0 )
≤ Pr(|E1n (ξˆn◦ , θ̂n )| > ε/3) + ε/3 + ε/3
!
≤ Pr

|E1n (g, θ)| > ε/3

sup

+ ε/3 + ε/3

g∈NΦ (Ω,ρ),θ∈U,k exp{g}−exp{ξ}kL2 (Ω) ≤δ

≤ ε.
The first and third inequalities follow from the definition of ξˆn◦ , and the last inequality
follows from (S3.9). Thus, this implies that E1n (ξˆn , θ) tends to zero in probability, which
gives
op (1) = E1n (ξˆn , θ̂n )

n 
1 X
∂f
=√
[exp{ξˆn (xi )} − exp{ξ(xi )}]
(xi , θ̂n )
∂θj
n i=1
Z
√
∂f
− n [exp{ξˆn (z)} − exp{ξ(z)}]
(z, θ̂n )dz
∂θj
Ω
Z
√
√
∂f
= − nCn − n [exp{ξˆn (z)} − exp{ξ(z)}]
(z, θ̂n )dz,
∂θj
Ω
which implies
Z
Cn = −
=−

[exp{ξˆn (z)} − exp{ξ(z)}]

ZΩ 
Ω

∂f
(z, θ̂n )dz + op (n−1/2 )
∂θj

 ∂f
λ̂n (z) − λ(z)
(z, θ̂n )dz + op (n−1/2 ).
∂θj

(S3.10)

Then, by substituting (S3.7) to (S3.10) and using condition C2, Taylor expansion can be

8

applied to (S3.10) at θ∗ , which leads to
Z

∂f
(z, θ̂n )dz + op (n−1/2 )
[f (z, θ̂n ) − λ(z)]
∂θj
Ω Z

2
1
∂
2
=−
[f (z, θ̃n ) − λ(z)] dz (θ̂n − θ∗ ) + op (n−1/2 ),
2 Ω ∂θi ∂θj

Cn = −

p

− θ∗ , which
where θ̃n lies between θ̂n and θ∗ . By the consistency of θ̂n , we then have θ̃n →
implies that
Z
Ω

∂2
p
[f (z, θ̃n ) − λ(z)]2 dz →
−
T
∂θ∂θ

Z
Ω

∂2
[f (z, θ∗ ) − λ(z)]2 dz = V.
T
∂θ∂θ

Thus, we have
1
Cn = − V (θ̂n − θ∗ ) + op (n−1/2 ).
2

(S3.11)

Next, we consider Dn . Define the empirical process


n 
∂f
1 X
∂f
∂f
∂f
∗
∗
ei
(xi , θ) − ei
(xi , θ ) − E ei
(xi , θ) − ei
(xi , θ )
E2n (θ) = √
∂θj
∂θj
∂θj
∂θj
n i=1

n 
1 X
∂f
∂f
∗
=√
(xi , θ) − ei
(xi , θ ) ,
ei
∂θj
∂θj
n i=1
where ei = yi − λ(xi ) θ ∈ U . Condition C1 implies that the set {ζθ ∈ C(R × Ω) : ζθ (e, x) =
∂f
∂f
e ∂θ
(x, θ) − e ∂θ
(x, θ∗ ), θ ∈ U } is a Donsker class, which ensures that E2n (·) converges
j
j

weakly in L∞ (U ) to a tight Gaussian process, denoted by G(·). Without loss of generality,
we assume G(·) has continuous sample paths. Then, by the continuous mapping theorem
p

(van der Vaart, 1998) and the consistency of θ̂n , we have E2n (θ̂n ) →
− G(θ∗ ). Because
p

E2n (θ∗ ) = 0 for all n, we have G(θ∗ ) = 0. Then, we have E2n (θ) →
− 0, which gives
n

1X
∂f
Dn =
(yi − λ(xi ))
(xi , θ∗ ) + op (n−1/2 ).
n i=1
∂θj
9

(S3.12)

Lastly, we consider En . Applying conditions C5, C9, C10, we have
∂f
(·, θ̂n )
En ≤ 2κn kξˆn kNΦ (Ω)
∂θj

= op (n−1/2 ).

(S3.13)

NΦ (Ω)

By combining (S3.8), (S3.11), (S3.12) and (S3.13), we have
(
θ̂n − θ∗ = 2V −1

)
n
X
1
∂f
(yi − λ(xi )) (xi , θ∗ ) + op (n−1/2 ).
n i=1
∂θ

(S3.14)

Thus, given condition C6 and




∂f
∂f
∗
∗ ∂f
∗
V (yi − λ(xi )) (xi , θ ) = E λ(X) (X, θ ) T (X, θ ) = W0 ,
∂θ
∂θ
∂θ
(S3.14) implies the asymptotic result of Theorem 3.1 by the central limit theorem, that is,
√
d
n(θ̂n − θ∗ ) →
− N (0, 4V −1 W0 V −1 ).

S4

Proof of Theorem 3.3

If suffices to show that θ̂n given in (4) has the same asymptotic variance as the estimator
obtained by using maximum likelihood (ML) method. Consider the following q-dimensional
parametric model indexed by γ,
ξγ (·) = ξ(·) + γ T

∂f
(·, θ∗ ),
∂θ

(S4.15)

with γ ∈ Rq . By the fact that ξ(·) = log λ(·) and (S4.15), it becomes a Poisson regression
model with the coefficient γ. The log-likelihood of γ is


n 
1X
T ∂f
∗
T ∂f
∗
l(γ) =
yi ξ(xi ) + yi γ
(xi , θ ) − exp ξ(·) + γ
(·, θ )
,
n i=1
∂θ
∂θ
10

and its first and second derivatives are



n 
∂f
∂f
∂l(γ)
1X
∗
T ∂f
∗
∗
yi (xi , θ ) − exp ξ(·) + γ
(·, θ )
(·, θ )
=
∂γ T
n i=1
∂θ
∂θ
∂θ
and




n 
∂f
∂ 2 l(γ)
1X
T ∂f
∗
∗ ∂f
∗
exp ξ(·) + γ
(·, θ )
(·, θ ) T (·, θ ) .
=−
∂γ∂γ T
n i=1
∂θ
∂θ
∂θ

Since the true model is yi ∼ Poi(λ(xi )), the true value of γ is 0. Hence, under the regularity
conditions of Theorem 3.1, the ML estimator of γ has the asymptotic expression
n

γ̂n =

1 −1 X
∂f
W0
(yi − λ(xi )) (xi , θ∗ ) + op (n−1/2 ),
n
∂θ
i=1

(S4.16)

where W0 is defined in (5). Then, a natural estimator for θ∗ in (2) is
θ̂nML = arg min k exp{ξγ̂n (·)} − f (·, θ∗ )kL2 (Ω) .
θ∈Θ

The asymptotic variance of θ̂nML can be obtained by the delta method. First, define
θ(t) = arg min E [exp{ξt (xi )} − f (xi , θ)]2
θ∈Θ

for all t near zero, and let
∂
E [exp{ξt (xi )} − f (xi , θ)]2
∂θ



2
∂
∂f
∗
=
E exp ξ(xi ) + t (xi , θ ) − f (xi , θ) .
∂θ
∂θ

φ(θ, t) =

11

(S4.17)

(S4.17) implies that φ(θ(t), t) = 0 for all t near zero. Then, by the implicit function theorem,
we have
∂θ(t)
∂tT


=−
t=0

−1
∂φ ∗
∂φ ∗
(θ , 0)
(θ , 0)
T
∂θ
∂tT

−1 



∂f
∂f
∂2
2
−2E λ(xi ) (xi , θ) T (xi , θ)
=− E
[exp{ξ(xi )} − f (xi , θ)]
∂θ∂θT
∂θ
∂θ
= 2V −1 W0 .

(S4.18)

By the delta method, we have
θ̂n − θ∗ = θ(γ̂n ) − θ(0) =

∂θ(t)
∂tT

γ̂n + op (n−1/2 ),
t=0

and together with (S4.16) and (S4.18), it yields
θ̂n − θ∗ = 2V −1

!
n
∂f
1X
(yi − λ(xi )) (xi , θ∗ ) + op (n−1/2 ).
n i=1
∂θ

Thus, the asymptotic variance of the ML estimator is 4V −1 W0 V −1 , which is the same as
that of θ̂n (see Theorem 3.1). Therefore, the L2 estimator θ̂n in (4) is semiparametric
efficient.

S5

Proof of Theorem 3.5
ind.

Consider a parametric model, yi ∼ N (f (xi , θ), 1), which is misspecified because the true
ind.

model is yi ∼ Poi(λ(xi )). It is easy to see that θ̂nLS is the maximum likelihood estimator
(MLE) of θ under this misspecified model. Thus, under the regularity conditions C1-C4 and
C11, the MLE converges to θ0 in probability which uniquely minimizes Kullback-Liebler

12

divergence (Huber, 1967; White, 1982). That is,
Qn


h0 (yi )
0
i=1
,
θ = arg min E0 log Qn
θ∈Θ
i=1 h1 (yi |θ)
where h0 and h1 are the density functions of yi under the misspecified model and the true
model, respectively, and E0 denotes the expectation with respect to yi ∼ h0 . Since the true
model follows a Poisson distribution, we have
Qn
P
P




h0 (yi )
exp ( ni=1 yi log λ(xi ) − ni=1 λ(xi ))
i=1
P
E0 log Qn
= E0 log
(2π)−n/2 exp (− ni=1 (yi − f (xi , θ))2 /2)
i=1 h1 (yi |θ)
n
X

n
= log(2π) +
E0 [yi ] log λ(xi ) − λ(xi ) + E0 [yi − f (xi , θ)]2 /2
2
i=1
n
X

n
λ(xi ) log λ(xi ) − λ(xi ) + ([λ(xi ) − f (xi , θ)]2 + λ(xi ))/2
= log(2π) +
2
i=1

=

n
X

(λ(xi ) − f (xi , θ))2 + Constant.

i=1

By the law of large numbers, we have
n
X

p

(λ(xi ) − f (xi , θ))2 −→ E[λ(X) − f (X, θ)]2 .

i=1
p

Therefore, θ̂nLS → θ0 = arg minθ∈Θ E[λ(X) − f (X, θ)]2 , which shows that θ̂nLS is consistent
because θ0 = θ∗ .
In addition, by White (1982), the asymptotic normality of θ̂nLS can be shown as follows,
√

d

n(θ̂nLS − θ∗ ) →
− N (0, A−1 BA−1 ),

13

(S5.19)

where



1
∂2
∂ 2 h1 (Y |θ∗ )
∗ 2
= − E0
A = E0
(Y − f (X, θ ))
∂θ∂θT
2
∂θ∂θT


2
∗
∂f (X, θ∗ ) ∂f (X, θ∗ )
1
∗ ∂ f (X, θ )
− 2(λ(X) − f (X, θ ))
=− E 2
2
∂θ
∂θT
∂θ∂θT


2
∂
1
1
=− E
(λ(X) − f (X, θ∗ ))2 = − V,
T
2
∂θ∂θ
2


(S5.20)

and



∂h1 (Y |θ∗ ) ∂h1 (Y |θ∗ )
1
∂
∗ 2 ∂
∗ 2
B = E0
= E0
(Y − f (X, θ ))
(Y − f (X, θ ))
∂θ
∂θT
4
∂θ
∂θT


∗ ∂f
∗
∗ 2 ∂f
(X, θ ) T (X, θ )
= E0 (Y − f (X, θ ))
∂θ
∂θ




∂f
∗ ∂f
∗
∗ 2 ∂f
∗ ∂f
∗
(X, θ ) T (X, θ )
= E λ(X) (X, θ ) T (X, θ ) + E (λ(X) − f (X, θ ))
∂θ
∂θ
∂θ
∂θ


= W1 .

(S5.21)

Combining (S5.19), (S5.20), (S5.21) and condition C12, we have
√ LS
d
n(θ̂n − θ∗ ) →
− N (0, 4V −1 W1 V −1 ).

References
Huber, P. J. (1967). The behavior of maximum likelihood estimates under nonstandard
conditions. In Proceedings of the fifth Berkeley symposium on mathematical statistics and
probability, volume 1, pages 221–233. University of California Press.
Kosorok, M. R. (2008). Introduction to Empirical Processes and Semiparametric Inference.
Springer, New York.

14

Mammen, E. and van de Geer, S. (1997). Penalized quasi-likelihood estimation in partial
linear models. The Annals of Statistics, 25(3):1014–1035.
Sung, C.-L., Hung, Y., Rittase, W., Zhu, C., and Wu, C. F. J. (2020). Calibration for
computer experiments with binary responses and application to cell adhesion study.
Journal of the American Statistical Association, to appear.
Tuo, R. and Wu, C. F. J. (2015). Efficient calibration for imperfect computer models. The
Annals of Statistics, 43(6):2331–2352.
Tuo, R. and Wu, C. F. J. (2016). A theoretical framework for calibration in computer
models: parametrization, estimation and convergence properties. SIAM/ASA Journal on
Uncertainty Quantification, 4(1):767–795.
van de Geer, S. (2000). Empirical Processes in M-estimation. Cambridge University Press.
van der Vaart, A. W. (1998). Asymptotic Statistics (Cambridge Series in Statistical and
Probabilistic Mathematics). Cambridge University Press.
van der Vaart, A. W. and Wellner, J. A. (1996). Weak Convergence and Empirical Processes:
With Applications to Statistics. Springer, New York.
Wendland, H. (2004). Scattered Data Approximation. Cambridge University Press.
White, H. (1982). Maximum likelihood estimation of misspecified models. Econometrica,
50(1):1–25.

15

