arXiv:2004.01481v2 [physics.soc-ph] 6 Apr 2020

Generating Similarity Map for COVID-19 Transmission Dynamics
with Topological Autoencoder
Pitoyo Hartono ∗
April 7, 2020

1 Introduction

pontentially be useful for further analysis and prediction.

At the end of 2019 China reported some cases of pneumonia of unknown causes that rapidly became an outbreak
[1]. On January 30 2020, The World Health Organization
(WHO) declared the outbreak as a Public Health Emergency of International Concern, and on February 11 2020
the name for the coronavirus disease was announced as
COVID-19. On March 11, COVID-19, the human respiratory disease caused by the SARS-CoV2 virus, has
been declared as a pandemic by the WHO with more than
100000 cases, in 114 countries as of that day.
Artificial Intelligence communities have been starting
to work to tackle many aspects of COVID-19 crisis as
nicely reviewed in [2]. Data from this outbreak have
already been compiled and made available for research
communities [3].
In this short note, the author proposes the utilization of
a topological neural network to map the global dynamics
of COVID-19 spread. With so many countries affected by
this crisis, and each country has different geographical,
demographic and strategic aspects, hence, it is very difficult to obtain clear global view on how those differences
are correlated with the failure or success of mitigating this
crisis.
The objective of this study is to offer a visualization
method based on the time series data for COVID-19 patients numbers in many countries. While this visualization
method does not directly offer insights for the means of
crisis mitigation, it will offer an intuitive information on
the similarities and differences between many countries
in the transmission dynamics of this pandemic that will
∗ School

2

Topological Autoencoder

The outline of Topological Autoencoder (TA) is shown
in Fig. 1. TA is a hierarchical neural network having a
low dimensional topological hidden layer that is a simplified version of Soft-supervised Topological Autoencoder
(STA) proposed in [4]. Originally, STA can be trained in
supervised manner, unsupervised manner or the mix of
both, and produces a two-dimensional topological map
that allows human user to visualize the concept of the
data. TA is a simplified version of STA in that it is only
trained as an autoencoder in a unsupervised manner and
produces a visible map that captures the inherent characteristics of the training data.
In this preliminary study, TA is trained with time series of the numbers of COVID-19 patients in more than
240 countries or regions in the world that have been daily
compiled by Center for Systems Science and Engineering
(CSSE) at Johns Hopkins University [5] and the data are
made available in a GitHub repository [6].
The hidden layer of TA is a topological map similar to
Kohonen’s Self Organizing Maps (SOM) [7], [8], where
hidden neurons are arranged in two-dimensional grid, and
each neuron is associated with a reference vector that has
the same dimensionality with the input.
The dynamics of TA is briefly explained as follows.
For a time series containing the daily numbers of
COVID-19 cases in a certain country, X P Rd , TA selects the best matching unit, win among all the reference
vectors associated with the hidden units of STA as in Eq.
1, where Wj P Rd is the reference vector associated with

of Engineering, Chukyo University, Nagoya, Japan

1

the j-th hidden unit. Here, d is the number of the days 3 Topological Maps for COVID-19
from the beginning of data collection on January 22 2020.
Transmission
The output of the j-th hidden neuron, Hj is shown in
Eq. 2, where σpj, win, tq is the neighborhood function
defined in Eq.3. Here, σ0 ą σ8 ą 0 are the initial and The following figures show a series of topological maps
final values of the annealing term, t is the current epoch, that reflect the dynamics of patients spread for around 240
countries or areas based on patients’ numbers collected
while t8 is the termination epoch.
from January 22 2020 up to the date specified in the respective map. Each country is represented with a number
win “ arg min }X ´ Wj }
(1) according to the data numbering in John Hopkins Unij
versity Repository. For visual clarity, the names of some
}X´Wj }2
countries or areas are shown on the map.
Hj “ σpj, win, tqe´ σ2
(2)
Figure 2 shows the topological maps for patients spread
up to February 20 2020, the early stage when COVID-19
patients were detected outside China. From this map, it
σpj, win, tq “ expp´distpwin, iq{Sptqq
(3) can be observed that many countries occupy the upper
left area on the map. The overlapping are due to the
1
πt
Sptq “ σ8 ` pσ0 ´ σ8 qp1 ` cos q
similar dynamics in the COVID-19 cases among many
2
t8
countries, in that most of them have identified very few
The values of the k-th output neuron, Ok , is defined in patients at this time. At this time, Hubei, the epicenter
for outbreak, was already an outlier on the map, as the
Eq. 4 where f pxq “ 1`e1´x
number of patients in Hubei was in different magnitude
t
compared to other areas. It can be also observed here
Ok “ f ppVk q Hq
that USA, France, South Korea, and Asian countries as
Here, Vk denotes the weight vector leading from Malaysia, South Korea, Singapore, Thailand, Taiwan and
the hidden layer to the k-th output neuron, H “ Hong Kong were positioned adjacently, due to their simipH1 , H2 , ¨ ¨ ¨ , HNhid qt is the hidden layer output vector lar dynamics, while many China’s provinces as Zhejiang,
in which Nhid is the number of hidden neurons.
Shanghai, Liaoning and naturally Hubei were outliers due
The loss function is defined in Eq. 4.
to their early outbreaks.
Figure 3 shows the map up to March 6. The upper
1ÿ
L“
pOk ´ Xk q2
(4) left of the map was still crowded, but many countries can
2 k
be seen to breakout from this overlapping area. This is
TA is then trained by minimizing the loss function with due to many countries were beginning to develop differthe standard stochastic gradient descent. The detail for the ent strategies resulting in different patients transmission
dynamics. It is notable that Italy and Iran moved considloss function derivations are explained in [4], [9].
The modifications of the reference vectors in the hid- erably from the crowded cluster due to the beginning of
den layer of TA cause the formation of two-dimensional outbreaks in these two countries, while USA still shared
topological map, in which countries with similar trans- the space, and thus has similar dynamics with Macau and
mission dynamics are assigned adjacently, while countries Taiwan.
with dissimilar dynamics are separated by large space on
Figure 4 shows the map up to March 25, two weeks afthe map.
ter World Health Organization (WHO) declared COVIDUtilizing this similarity map, we can gain intuitive un- 19 as a pandemic. The left corner became less crowded as
derstanding on global trend in COVID-19 transmission. more and more countries developed their unique spread
The insights gained from visually analyzing this map are dynamics. Noticeably, South Korea moved away, due to
potentially helpful in designing strategy for controlling rapid surge of virus transmissions in this period. Outand thus mitigating the spread of this disease.
breaks occurred in USA, Spain and Italy as reflected by
2

topographical encoder
decoder

patients time series

patients time series
Figure 1: Topological Autoencoder

their positions on the map. Hubei, the original epicenter
for this disease, many of Chinese’s provinces and South
Korea kept their unique positions on the map because of
their unique dynamics that saw early outbreak but than
stabilized.

namics as shown in Fig. 6b. From the right side of the
map, Hubei, USA and Italy as shown in Fig. 6c. It is obvious that Hubei had stabilized while patients numbers were
growing steeply in USA and Italy. Figure 7 shows the internal representations, each one is the reference vector for
the winning neuron associated with each country. Figure
7a shows the representation for Beijing’s, Zhejiang’s and
Vatican’s dynamics, Fig. 7b shows the representation for
Japan’s, Netherlands’ and Switzerland’s dynamics, while
Fig. 6c shows those of Hubei, USA and Italy. Here, it is
important to notice that TA represents different dynamics
with different internal representations that are important
to recreate the original dynamics in the output layer of TA.
Here, it is important to notice that some similar, although
different dynamics may be represented by a single representation. The representation captures important features
of those dynamics, and thus becomes a building block for
them.

Figure 5 shows the map up to March 30, that did not
significantly change from the previous map. This is because no noticeable new outbreaks, and hence many countries have stabilized their policies that results in the stabilization of their spread dynamics. The noticeable change
is the split of Germany and Spain that previously shared a
same dynamics.
Detailed analysis for this final map was executed to
give better understandings on the topological characteristics of these maps.
Figure 6 shows the actual time series up to March 30 for
some countries divided based on the region they occupied
on the map in Fig. 5. From the left area, as shown in Fig.
6a, Beijing, Zhejiang and Vatican had dissimilar dynamics that were reflected by their large distances on the map.
Beijing and Zhejiang have both contained the outbreaks
but had different dynamics and cumulative patient numbers, while Vatican had very few patients up to March 30.
In the middle of the map Japan, Netherlands and Switzerland can be observed each with considerably different dy-

To further explain the internal representation characteristics, the dynamics of South Korea and UK are shown in
Fig. 8b. These two countries are deliberately chosen because of their contrasting transmission dynamics that are
reflected by their largest distance on the map. South Korea are known for their success in containing the spread of
this disease after an early outbreak, while UK, on March
3

Figure 2: Map Feb. 20 2020

4

Figure 3: Map March 6 2020

5

Figure 4: Map March 25 2020

6

Figure 5: Map March 30 2020

7

(a) Map Left: Patients

(b) Map Mid: Patients

(c) Map Right: Patients

Figure 6: Patients Spread

(a) Map Left

(b) Map Mid

Figure 7: Internal Representations

8

(c) Map Right

(a) Patients: S.Korea-UK

(b) Representation: S.Korea-UK

Figure 8: S. Korea vs UK

(a) Patients: Belgium-Netherlands

(b) Representation: Belgium-Netherlands

Figure 9: Belgium vs Netherlands

9

30, was still struggling. Their internal representations are
shown in Fig. 8b, which clearly show the difference between these two countries. Here a clear example for the
reflection of the differences in dynamics into the internal
representations is shown.
Oppositely, Fig. 9a shows the similar dynamics for Belgium and Netherlands that naturally are placed closely on
the map in Fig. 5. The similarity in the disease spread
dynamics is reflected in the similar representations in Fig.
9b and their positions on the map as well.
Through these preliminary examples, it can be empirically shown that the hidden representation of TA is able
to capture the topological relations in different countries
dynamics and thus can be utilized as an analytical tool,
for intuitively comparing the dynamics of many countries
and potentially analyzing the correlation between those
dynamics and strategies to mitigate this crisis.

ease in china,” Nature, vol. 579, pp. 265–269, 2020.
[2] J. Bullock, Alexandra, Luccioni, K. H. Pham,
C. S. N. Lam, and M. Luengo-Oroz, “Mapping
the landscape of artificial intelligence applications
against covid-19,” 2020, 2003.11336.
[3] B. Xu, B. Gutierrez, S. Mekaru, et al., “Epidemiological data from the covid-19 outbreak, real-time
case information,” Scientific Data, vol. 7, no. 106,
2020.
[4] P. Hartono, “Mixing autoencoder with classifier:
conceptual data visualization,” ArXiv e-prints, 2019,
1912.0113.
[5] E. Dong, H. Du, and L. Gardner, “An interactive
web-based dashboard to track covid-19 in real time,”
The Lancet Infectious Diseases, 2020.
[6] “2019 novel coronavirus covid-19 (2019ncov) data repository by johns hopkins csse.”
https://github.com/CSSEGISandData/COVID-19,
2020.

4 Conclusion

In this unrefereed note, the author proposes the utilization
of topological neural network for visualizing the global
trend for the COVID-19 transmission. The initial ex- [7] T. Kohonen, “Self-organized formation of topologically correct feature maps,” Biological Cybernetics,
periments indicate that we can gain intuitive insights on
vol. 43, pp. 59–69, 1982.
the similarities and differences in the disease transmission among many countries. By visualizing the maps in
[8] T. Kohonen, “Essential of self-organizing map,”
time, we can also learn the shifts in each countries sitNeural Networks, vol. 37, pp. 52–65, 2013.
uations, which mirror their strategies. At this moment,
this topological map is not directly useful for evaluating [9] P. Hartono, P. Hollensen, and T. Trappenberg,
the efficiency of strategies executed by many countries to
“Learning-regulated context relevant topographical
mitigate the crisis. However, the author believes that the
map,” IEEE Trans. on Neural Networks and Learnintuitive visual understanding gained from these topologing Systems, vol. 26, no. 10, pp. 2323–2335, 2015.
ical maps will be useful in comparing strategies among
many countries, and thus for designing optimal strategies [10] S. Hochreiter and J. Schmidhuber, “Long shortterm memory,” Neural Computation, vol. 9, no. 8,
for mitigating this crisis. The direct usage of this map, is
pp. 1735–1780, 1997.
to cluster countries having similar dynamics, and train a
time series predictor, for example Long Short-term Memory (LSTM) [10], for further predicting the future numbers of patients in those countries.

References
[1] J.-H. Tian, Y.-Y. Pei, M.-L. Yuan, et al., “A new
coronavirus associated with human respiratory dis10

