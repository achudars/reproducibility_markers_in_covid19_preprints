medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

2

Optimal piecewise constant vaccination and lockdown policies for
COVID-19

3

Gabriel A. Salcedo-Varelaa , F. Peñuñurib , D. González-Sánchezc , Saúl Dı́az-Infantec,∗

1

4
5
6
7
8

9

a

Departamento de Matemáticas, Universidad de Sonora, Blvd. Luis Encinas y Rosales S/N, Hermosillo, Sonora, México,
C.P. 83000.
b Facultad de Ingenierı́a, Universidad Autónoma de Yucatán, A.P. 150, Cordemex, Mérida, Yucatán, México.
c CONACYT-Universidad de Sonora, Departamento de Matemáticas, Blvd. Luis Encinas y Rosales S/N, Hermosillo,
Sonora, México, C.P. 83000.

Abstract
We formulate a controlled system of ordinary differential equations, with vaccination and lockdown interventions as controls, to simulate the mitigation of COVID-19. The performance of the controls is measured
through a cost functional involving vaccination and lockdown costs as well as the burden of COVID19 quantified in DALYs. We calibrate parameters with data from Mexico City and Valle de Mexico. By using
differential evolution, we minimize the cost functional subject to the controlled system and find optimal
policies that are constant in time intervals of a given size. The main advantage of these policies relies on its
practical implementation since the health authority has to make only a finite number of different decisions.
Our methodology to find optimal policies is relatively general, allowing changes in the dynamics, the cost
functional, or the frequency the policymaker changes actions.

10

Keywords: COVID-19, Optimal Control, COVAX, Vaccination, WHO-SAGE, DALYs.

11

1. Introduction

12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28

At the date of writing this manuscript, the USA is running its COVID-19 Vaccination with PfizerBioNTech vaccine. This vaccine development, along with Astra-Zeneca, Cansino, Sputnik V, and Novavax,
promises to deliver enough doses for Latin America. In Mexico, particularly, the first stock with around
40 000 shots has arrived past Christmas. In past October, WHO established a recommended protocol
for prioritizing access to this pharmaceutical hope, giving clear lines about who has to be vaccinated first
and why. However, each developed vaccine implies different issues around its application. For example,
the Pfizer-BioNTech vaccine requires two doses and particular logistics requirements that demand special
services. In Mexico, despite Pfizer-BioNTech, has been taking the responsibility to capacitate personnel
that manages the Vaccination, there is an explicit demand for logistics resources that limit the institutions’
response. On the other hand, nonpharmaceutical interventions (NPIs), like Lockdown, mobility reduction,
social distancing, and other restrictions, also involve economic costs. Our research in this manuscript explores
the effect of two interventions, Vaccination and Lockdown, to mitigate the propagation of COVID-19.
Among the related literature about the two interventions we deal with in this paper, we can mention the
following. The problem of who is vaccinated first, when the number of available shots is limited, has been
transformed into an optimal allocation problem of vaccine doses in [1–3]. These articles face the critical
question: how much doses allocate to each different group according to risk and age to minimize the burden
of COVID-19. Our study takes the allocation for granted and modulates vaccination and lockdown-release
∗ Corresponding

author
Email addresses: a211203745@unison.mx (Gabriel A. Salcedo-Varela ), francisco.pa@correo.uady.mx (F. Peñuñuri),
dgonzalezsa@conacyt.mx (D. González-Sánchez), saul.diazinfante@unison.mx (Saúl Dı́az-Infante)
Preprint submitted to Annual Reviews in Control

January 13, 2021

NOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice.

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

49

rates as a combined strategy. Further, papers modeling NPIs consider the diminish of contact rates by
reducing mobility or modulating parameters regarding the generation of new infections by linear controls
[4, 5], lockdown–quarantine [6], and shield immunity [7]. Also, Libotte et al. report in [8] optimal vaccination
strategies for COVID-19.
Since health services’ response will be limited by the vaccine stock and logistics costs, implementing in
parallel NPIs is imminent. We focus on formulating and studying via simulation a lockdown-vaccination
system by consider the vaccine recently approved by Mexico Health Council. We aim to design a dose
application schedule subject to a given vaccine stock applied in a given period. For this purpose, we
formulate an optimal control problem that minimizes the burden of COVID-19 in DALYs [9], the cost
generated by running the vaccination campaign, and economic damages due to lockdown.
One of the main features of our model is that we consider piecewise constant control policies instead of
general measurable control policies—also called permanent controls—to minimize a cost functional. General
control policies are difficult to implement since the authority has to make different choices every permanently.
The optimal policies we find are constant in each interval of time and hence these policies are easier to
implement. To the best of our knowledge, our manuscript is the first optimal control model with both
lockdown and vaccination strategies.
In Section 2, we formulate the basic spread model for COVID19 and calibrate its parameters. Then,
Section 3 establishes the lockdown–vaccination model and discusses the regarding reproductive number in
Section 4. In Section 5 we describe the optimal control problem which consists in minimizing a cost functional
subject to controlled lockdown–vaccination system. The optimal policies we find, by solving numerically the
optimal control problem, are presented in Section 6. We conclude with some final comments in Section 7.

50

2. Covid-19 spread dynamics

29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48

51
52
53

We split a given population of size N in the basic SEIR structure with segregated classes according
to the manifestation of symptoms. Let L, S, E, IS , IA , H, R, D respectively denote the class of individuals
according to their current state, namely

55

Lockdown (L) All individuals that have low or null mobility and remain under isolation. Thus individuals
in this class reduce their contagion probability.

56

Suceptible (S) Individuals under risk

57

Exposed (E) Population fraction that hosts SARS-CoV-2 but cannot infect

58

Infected-Symptomatic (IS ) Population infected fraction with symptoms and reported as confirmed cases

59

Infected-Asymptomatic (IA ) Infected individuals with transitory or null symptoms and unreported

60

Hospitalized (H) Infected population that requires hospitalization or intensive care.

61

Recover or removed (R) Population that recovers from infection and develops partial immunity

62

Death (D) Population fraction that died due to COVID-19

54

64

To fit data of cumulative reported symptomatic cases, we postulate the counter state YIS and make the
following assumptions.

65

Assumptions 1. According to above compartment description, we made the following hypotheses.

63

66
67

68
69
70

(A-1) We suppose that at least 30 % of the population is locked down and a fraction of this class eventually
moves to the susceptible compartment at rate δL .
(A-2) Force infection is defined as the probability of acquiring COVID-19 given the contact with a symptomatic or asymptomatic individual. Thus we normalize with respect to alive population population
N ?.
2

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

71
72
73

(A-3) Susceptible individuals become exposed—but not infectious—when they are in contact with asymptomatic or symptomatic individuals. Thus βS and βA denote the probabilities of being infectious
given the contact with a symptomatic or asymptomatic infectious individuals, respectively.

76

(A-4) After a period of latency 1/κ = 5.1 days, an exposed individual becomes infected. Being p the probability of developing symptoms and (1 − p) the probability of becoming infectious but asymptomatic.
Thus pκE denotes the exposed individuals that become infectious and develop symptoms.

77

(A-5) Asymptomatic individuals do not die or stay in the hospital.

78

(A-6) A fraction µH of symptomatic individuals dies due to COVID-19 without hospitalization.

74
75

Figure 1: Compartmental diagram of COVID-19 transmission dynamics. Consider the class: Susceptible (S), exposed (E),
symptomatic infected (IS ), asymptomatic infected (IA ), recovered (R), death (D) and vaccinated (V ) individuals. It is
important to mention that IS represents the proportion of symptomatic individuals who will later report to some health
medical center.
79

Thus we formulate the following Ordinary Differential Equation (ODE), see Figure 1, to complete the

3

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Suceptible

Exposed

0.8

0.015

0.010

0.7

0.005

0.000
0

120

240

360

0

Symptomatics

50

100

Asymptomatics

150

200

250

300

350

200

250

300

350

200

250

300

350

Hospitalized

0.0014

0.0020

0.0012

0.015
0.0015

0.0010

0.0008

0.010
0.0010

0.0006

0.0004

0.005
0.0005

0.0002

0.000

0.0000
0

50

100

150

200

250

300

350

0.0000
0

50

100

150

200

250

300

350

0

50

100

150

Recovered

Deaths
0.008

0.35

0.30
0.006
0.25

0.20
0.004
0.15

0.10

0.002

0.05

0.00

0.000
0

50

100

150

200

250

300

350

0

50

100

150

Figure 2: Spreed dynamics of COVID-19 according to model in Equation (1).

80

underlying description.
S0
E0
IS0
0
IA
H0
R0
D0
dYIS
dt

= µN ? + δR R − (λ + µ)S,
= λ(L + S) − (κ + µ)E,
= pκE − (γS + δH + µIS + µ)IS ,
= (1 − p)κE − (γA + µ)IA ,
= δH IS − (γH + µH + µ)H,
= γS IS + γA IA + γH H − (δR + µ)R,
= µIS IS + µH H,

(1)

= pκE,

βA IA + βS IS
,
N?
?
N (t) = L + S + E + IS + IA + H + R.
λ :=

81
82
83

84
85
86
87

We display in Figure 2 a typical evolution of this COVID-19 spreed dynamics. Table 1 encloses notation
and reference values.
2.1. Parameter calibration
We calibrate parameters of our base dynamics (1) via Multichain Montecarlo (MCMC). To this end, we
assume that the cumulative incidence of new infected symptomatic cases CIS follows a Poisson distribution
with mean λt = ICs (t). Further, following ideas from [11] we postulate priors for p and κ and count the

4

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Parameter
µ
βS
βA
λV
δV−1
ε
κ−1
p
θ
γS−1
−1
γA
−1
γH
−1
δR
δH

Description
Death rate
Infection rate between susceptible and
symptomatic infected
Infection rate between susceptible and
asymptomatic infected
Vaccination rate
Vaccine-induced immunity
Vaccine efficacy
Average incubation time
New asymptomatic generation proportion
Proportion of suceptible individuals under
lockdown
Average time of symptomatic recovery
Recovery average time of asymptomatic individuals
Recovery average time by hospitalization
Natural immunity
Infected symptomatic hospitalization rate

Table 1: Parameters definition of model in Equation (1).

88

cumulative reported-confirmed cases in the CDMX-Valle de Mexico database [10]
Yt ∼ P oisson(λt ),
Z t
λt =
pδE E,
0

(2)

p ∼ Uniform(0.3, 0.8),
κ ∼ Gamma(10, 50).
Using Van den Driessche’s [12] definition of reproductive number we obtain


κ
pβS
(1 − p)βA
R0 :=
(µR1 + δL )
+
,
(κ + µ)(δL + µ)
R2
γA + µ
where
R1 = 1 − θ(1 − ),
R2 = µ + δH + γS + µIS .
89
90

Figure 3 displays data of cumulative confirmed cases of COVID-19 in Mexico city, and Figure 4 displays
the fitted curve of our model in Equations (1) and (2). Table 2 encloses estimated parameters to this setting.

5

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Parameter

Median

Reference

qr , 
βS
βA
κ
p
θ
δL
δH
δV

0.4, 0.3, 0.1
qr × 8.690 483 × 10−1
qr × 7.738 431 × 10−1
0.196 078 43
0.1213
0.2,
0.04
0.2
0.002 739 726 027 397 260 3

δR
µ
µIS
µH
γS
γA
γH
λV
ε

0.005 555 56
3.913 894 × 10−5
0.0004
0.016 32
0.092 506 94
0.167 504 19
5.079 869 × 10−1
0.000 611 35
0.7, 0.9, 0.95

N
L0
S0
E0
IS0
IA0
H0
R0
D0
0
Xvac
V0
YI0S

26 446 435
0.266 260 097 021 127 96
0.463 606 046 009 872
0.000 670 33
9.283 × 10−5
0.001 209 86
1.341 579 69 × 10−4
2.661 259 39 × 10−1
0.001 900 74
0.0
0.0
0.122 581 64

B
aIS
aH
aD

0.000 359 216 658 124 242 5
0.002 012 775 543 825 648 6
0.001 411 888 738 103 725,
7.25

***
***
***
∗
∗
this study
postulated
∗
Assumed (δV−1 = 2 years)
−1
Assumed(δR
≈ 180 days)
∗
*
[13]
∗
∗
∗
Assumed
[14–16]

[17]
**
**
**
**
**
**
**
**
***
***
**
9500 beds/N
?
?
?

Table 2: Model parameters. (*) Values based mainly in [13, 18]. (**) Estimated. (***) This study. (?) From [19].

6

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

CDMX data
cumulative incidence

●
●
●

750

●
●
●
●

500

●

250

●

●

●

●

●

●
●

●

●

●

●

●

●

2020−03−30

2020−03−29

2020−03−28

2020−03−27

2020−03−26

2020−03−25

2020−03−24

2020−03−23

2020−03−22

2020−03−21

2020−03−20

2020−03−19

2020−03−18

2020−03−17

2020−03−16

2020−03−15

2020−03−14

2020−03−13

2020−03−12

2020−03−11

2020−03−10

0

symptom onset date

Cumulative Infected Cases

Figure 3: Cumulative new symptomatic and confirmed COVID19 reported cases from Ciudad de Mexico and Valle de Mexico
[10] between March, 10, to March 30 of 2020. https://plotly.com/ AdrianSalcedo/48/

1000
950
900
850
800
750
700
650
600
550
500
450
400
350
300
250
200
150
100
50
0
Mar 09

●
●
●
●
●
●
●

●

●
●

●

●

●

●

●

●

●

●

●

●

●

Median

●

Mar 16

Mar 23

Mar 30

Time (days)

Figure 4: Fit of daily new cases of Mexico city during exponential growth.

7

Data

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

91

3. Imperfect-preventive COVID-19 vaccination

93

Assumptions 2. According to COVID-19 dynamics Equation (1), we made the following modeling hypotheses about the regarding vaccine.

94

(VH-1) Vaccine is preventive and only reduce susceptibility.

92

97

(VH-2) The vaccination camping omits testing to detect seroprevalence. Thus Exposed, Infected Asymptomatic and Recovered Asymptomatic individuals are undetected but would obtain a vaccine dose
—which in this model represents a waste of resources

98

(VH-3) Individuals under lockdown are also vaccinated

99

(VH-4) The vaccine is leaky and with efficacy  ∈ [0.7, .975]

95
96

100

(VH-5) Vaccine induced immunity last 2 years

101

(VH-6) Natural immunity last a period of 180 days

Figure 5: Compartmental diagram of COVID-19 transmission dynamics which including vaccination dynamics. Here, we
consider the Lockdown class (L).

8

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

L0 =θµN ? − (λ + δL + λV + µ)L
S 0 =(1 − θ)µN ? + δL L + δV V + δR R
− (λ + λV + µ) S
E 0 =λ(L + (1 − ε)V + S) − (κ + µ)E
IS0 =pκE − (δH + γS + µIS + µ)IS
0
IA
=(1 − p)κE − (γA + µ)IA
0
H =δH IS − (γH + µH + µ)H
R0 =γS IS + γA IA + γH H − (δR + µ)R
D0 =µIS IS + µH H
V 0 =λV (S + L) − [(1 − ε)λ + δV + µ] V
dXvac
= (uV (t) + λV ) [L + S + E + IA + R]
dt
dYIS
= pκE
dt
βA IA + βS IS
λ :=
N?

(3)

L(0) = L0 , S(0) = S0 , E(0) = E0 ,
IS (0) = IS0 , IA (0) = IA0 , H(0) = H0 ,
R(0) = R0 , D(0) = D0 ,
V (0) = 0, Xvac (0) = 0,
Xvac (T ) = xcoverage ,
N ? (t) = L + S + E + IS + IA + H + R + V.
102

4. Lockdown-Vaccination reproductive number
The basic reproductive number, which is generally denoted by R0 , is a threshold quantity we can control
with particular strategies. The epidemiological interpretation of R0 is the average number of secondary
cases produced by an infected individual introduced into a population of susceptible individuals. Using van
den Driessche’s [20] definition of reproductive number we obtain


pβS
(1 − p)βA
κ
(µR1 + δL )
+
,
R0 :=
(κ + µ)(δL + µ)
R2
γA + µ
where
R1 = 1 − θ(1 − ),
R2 = µ + δH + γS + µIS .
The factor

pβS
R2

measures the proportion of new infections generated by a symptomatic infectious individual

in the time that it lasts infected. In a similar way, the factor

(1−p)βA
γA +µ

measures the new infections generated

1 +δL
by an asymptomatic infectious individual in the time that it lasts infected. The factor µR
δL +µ measures the
number of individuals in lockdown that leave the lockdown, which can be infected. And finally, the factor
κ
κ+µ measures the time of the disease’s incubation. If we consider that there is no lockdown, then R0 is
reduced to


κ
pβS
(1 − p)βA
R̃0 :=
+
.
(κ + µ) R2
γA + µ

9

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

103
104
105
106
107

108
109
110

Note that we have the relation R0 ≤ R̃0 . These indicate that there is greater transmission of the disease if
there is no lockdown.
Considering Assumptions 2, we can establish a vaccine reproductive number, in which individuals who
have already been vaccinated can become infected individuals by being in contact with the symptomatic
infected. Using van den Driessche’s [20] definition of reproductive number and [21], we obtain


θµ(1 − )
ελV
V
−
(µR1 + δL )R0 .
R0 := 1 −
µ + λ V + δV
µ + δL + λ V
The threshold quantity R0V is the reproductive number of infection which can be interpreted as the number
of infected people produced by one infected individual introduced into the population in the presence of
vaccination.

Figure 6: Contour plot of R0V as a function of vaccine efficacy (ε) and vaccination rate (λV ) and vaccine-induced immunity
average time of half year. Orange line represents the value of λV base = 0.000 611, corresponding to a coverage xcoverage = 0.2
and a horizon time T = 365 days. Intersection of black line and blue line show a scenario in which it is possible to have the
R0V = 0.65, considering a vaccine efficacy of 0.8 and a vaccination rate of 0.7.
111
112
113
114
115
116
117
118
119

Figure 6 shows R0V as a function of vaccine efficacy and vaccination rate. The blue line, ε = 0.8, tells us
what value of λV we take to have the level curve where R0V < 1.
Figure 7 shows the region of vaccine efficacy and vaccination rate, for which R0V < 1. In this scenario,
there is no lockdown effect. Note that when vaccine efficacy is less than 0.2, there is no vaccination rate for
which R0V < 1. In the absence of lockdown individuals, there is a region not feasible for vaccine efficacy and
vaccination rate.
Figure 8 shows the region for which R0V < 1 when there are lockdown individuals. In this scenario, we
observe that there are values for the vaccine efficacy and vaccination rate where R0V < 1, which are smaller
than the ones we choose in Figure 7.

10

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Figure 7: Vaccine efficacy versus vaccination rate feasibility. In the purple shaded region R0V < 1 and in the white region
R0V > 1. Note that, for this scenario, we consider no lockdown individuals. https://plotly.com/ AdrianSalcedo/85/

Figure 8: Vaccine efficacy versus vaccination rate feasibility. In the purple shaded region R0V < 1 and in the white region
R0V > 1. Note that, for this scenario, we consider lockdown individuals. https://plotly.com/ AdrianSalcedo/76/

11

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

120

121
122
123
124

5. Optimal controlled version
Now we model vaccination, treatment, and lockdown as an optimal control problem. According to
dynamics in Equation (1), we modulate the vaccination rate with a time-dependent control signal uV (t). We
add compartment Xvac to count all the vaccine applications of lockdown susceptible, exposed, asymptomatic,
and recovered individuals. This process is modeled by
X 0 (t) = (λV + uV (t))(L + S + E + IA + R)

(4)

and describes the number of applied vaccines at time t. Consider
x(t) := (L, S, E, IS , IA , H, R, D, V, Xvac )> (t)
125
126

127
128
129
130
131

and control signal uv (·). We quantify the cost and reward of a vaccine strategy policy via the penalization
functional
Z T

1
cL u2L (r) + cV u2v (r) dr.
(5)
J(uL , uV ) :=
aS pκE(r) + aH δH Is (r) + aD [µIS IS (r) + µH H(r)] +
2
0
In other words, we assume in functional J that pandemic cost is proportional to the symptomatic hospitalized
and death reported cases and that a vaccination and lockdown policies implies quadratic consumption of
resources.
Further, since we aim to simulate vaccination policies at different coverage scenarios, we impose the
vaccination counter state’s final time condition Xvac (T )
x(T ) = (·, ·, ·, ·, ·, Xvac (T ))> ∈ Ω
Xvac (T ) = xcoverage ,
xcoverage ∈ {Low(0.2), Mid(0.5), High(0.8)} ,

(6)

where Ω is the positive invariant set
Ω := { (L, S, E, IS , IA , H, R, D, V, Xvac )> ∈ [0, 1]10 : L + S + E + IS + IA + H + R + D + V = 1,
∀t ∈ [0, T ]} .
132
133

Thus, given the time horizon T , we impose that the last fraction of vaccinated populations corresponds to
20%, 50% or 80%, and the rest of final states as free. We also impose the path constraint
Φ(x, t) := H(t) ≤ B,

134
135
136
137

138
139
140
141
142
143

∀t ∈ [0, T ],

(7)

to ensure that healthcare services will not be overloaded. Here κ denotes hospitalization rate, and B is the
load capacity of a health system.
Given a fixed time horizon and vaccine efficiency, we estimate the constant vaccination rate as the solution
of
xcoverage = 1 − exp(−λV T ).
(8)
That is, λV denotes the constant rate to cover a fraction xcoverage in time horizon T . Thus, according to this
vaccination rate, we postulate a policy uv that modulates vaccination rate according to λV as a baseline.
max
That is, optimal vaccination amplifies or attenuates the estimated baseline λV in a interval [λmin
] to
V , λV
optimize functional J(·)—minimizing symptomatic, death reported cases and optimizing resources.
Our objective is minimize the cost functional (5)—over an appropriated functional space—subject to the
dynamics in equations (1) and (4), boundary conditions, and the path constraint in (7). That is, we look

12

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Figure 9: Compartmental diagram of COVID-19 transmission dynamics that includes optimal vaccination dynamics, penalization and a path constraint

144

for vaccination policies uV (·), which solve the following optimal control problem (OCP)
Z T
min J(uL , uV ) :=
aS pκE(r) + aH δH Is (r) + aD [µIS IS (r) + µH H(r)] dr+
u∈U

0

Z
0

T


1
cL u2L (r) + cV u2v (r) dr.
2

s. t.
L0 = θµN ? − λL − (uL (t) + δL )L − µL
S 0 = (1 − θ)µN ? + (uL (t) + δL )L + δV V + δR R
− [λ + (λV + uV (t)) + µ] S
0
E = λ(L + (1 − ε)V + S) − (κ + µ)E
IS0 = pκE − (γS + µIS + δH + µ)IS
0
IA
= (1 − p)κE − (γA + µ)IA
0
H = δH IS − (γH + µH + µ)H
R0 = γS IS + γA IA + γH H − (δR + µ)R
D0 = µIS IS + µH H
V 0 = (λV + uV (t))S − [(1 − ε)λ + δV + µ] V
dXvac
= (uV (t) + λV ) [L + S + E + IA + R]
dt
dYIS
= pκE
dt
βA IA + βS IS
λ :=
N?
L(0) = L0 , S(0) = S0 , E(0) = E0 , IS (0) = IS0 ,
IA (0) = IA0 , H(0) = H0 , R(0) = R0 , D(0) = D0 ,
13
V (0) = 0, Xvac (0) = 0, uV (.) ∈ [umin , umax ],
Xvac (T ) = xcoverage , κIS (t) ≤ B,
∀t ∈ [0, T ],
?
N (t) = L + S + E + IS + IA + H + R + V

(9)

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

145

146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162

6. Numerical Experiments
6.1. Methodology
We simulate a scenario corresponding to a hypothetical but plausible initial conditions and parameters.
We integrate model in Equation (9) by classic Runge Kutta scheme and solve the optimization stage with
the so-called Differntial Evolution method. Differential Evolution (DE) [22] is an evolutionary algorithm
successfully employed for global optimization [23]. The method is designed to optimize functions f : Rn → R.
Nevertheless, DE can be applied to optimize a functional as stated in [24]. The method can be coded following
Algorithm 1, where an initial random population on the search space V of size Np is subjected to mutation,
crossover and selection. After this process a new population is created which, again would be subjected
to the evolutionary process. This process is repeated until some stopping criteria is fulfilled. Finally the
best individual (according to some objective function fob to optimize) is extracted. These operations are
conducted by the operators X0 , M, C, S, xbest ; whose explicit form are coded in [25].
In the optimization of this study, the mutation scale factor F and the crossover probability Cr were taken
as 1 and 0.3 respectively, additional Np has been taken as 4 times the number of parameters (the dimension
of the vector used to describe the two controls—see [24]), which in our case was of 180. As stopping criteria
we have used a maximum number of generations which is taken as 5000.
We provide in [26] a GitHub repository with all regarding R and Fortran sources for the sake of reproductivity. This repository also encloses data sources and a Wolfrang Mathematica notebook to reproduce
all reported figures.
Algorithm 1 Differential Evolution Algorithm
X ← X0 (N p, V)
while (the stopping criterion has not been met) do
M ← M(X, F, V)
C ← C(X, M, Cr )
X ← S(X, C, fob )
end while
xbest ← Best(X, fob )

163

164
165
166
167
168
169
170
171
172
173
174

6.2. Simulation
According to official Governmental communication in December, Mexico treated 36 000 000 doses PfizerBiotech, 76 000 000 doses with Aztra Seneca 18 000 000 quantities of Cansino-BIO. Other developments
also are running the third Phase, and with high probability, in the third quarter of 2021, some of these
developments will incorporate into Mexico’s vaccine portfolio. Despite official agreements, each vaccine’s
delivery schedule is under uncertainty and-or subject to the approval of COFEPRIS.
The first accepted vaccine—Pfizer-BioNTech’s BNT162b2—has an efficacy above 90 % and requires two
doses to achieve immunity. The other mentioned developments have a very similar profile but require
different logistic management and stock allocation. Thus, we face designing a dose application schedule
subject to a given vaccine stock applied in a given period. To this end, we solve the optimal control problem
(9). We understand as solution of this problem a pair (x(·), u(·)) where
x(t) = (L(t), S(t), E(t), IS (t), IA (t), H(t), R(t), D(t), V (t))>
u(t) = (uL (t), uV (t))> ,

175
176

(10)

minimizes the burden of COVID-19 in DALYs [9] and the quadratic application cost of the lockdownvaccination policy formulated in the functional (5).

14

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Figure 10: Initial condition scheme. We assume a positive prevalence. For reference, at the date of write this manuscript,
prevalence in CDMX is around 16 000 cases, see https://plotly.com/ sauld/36/ to display an electronic viewer.

177
178
179
180
181
182
183

Simulation Scenario
Initial Conditions. We assume and a hypothetical scenario where the whole population faces a second wave
of COVID-19. Thus whole epidemiological classes have positive prevalence. We also assume that Lockdown
and Susceptible compartments initially enclose more than 70 % of the total population, and the initial
prevalence of symptomatic cases is below critical levels. Further, under our assumptions, the outbreaks’
second wave implies a growth accordingly with an Effective Reproductive Number (ERN) above one—Fig
10 displays a qualitative schematic representation.

15

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Lockdown Output Modulation Rate

Lockdown Output (Pop. Fraction)

0.011

0.010

0.009

0.008

0.007
0

50

100

150

200

250

300

350

Time (days)
Figure 11: Lockdown modulation signal. https://plotly.com/ AdrianSalcedo/56/ to display a electronic viewer.

Vaccination Modulation Rate

Vaccination Rate (Pop. Fraction)

0.005

0.004

0.003

0.002

0.001

0.000
0

50

100

150

200

250

300

350

Time (days)
Figure 12: Vaccination rate modulation. https://plotly.com/ AdrianSalcedo/58/

16

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Lockdown Output Modulation Rate
Lockdown Release per 100 000 inhabitants

200

150

100

50

0
0

50

100

150

200

250

300

350

Time (days)
0.30

Lockdown Pop. Fraction

0.25

0.20

0.15

0.10

0.05

0.00

0

50

100

150

200

250

300

250

300

350

Time (days)

0.80

Suceptible Pop. Fraction

0.75
0.70
0.65
0.60
0.55
0.50
0.45
0

50

100

150

200

350

Time (days)

Figure 13: Modulation lock down release. https://plotly.com/ AdrianSalcedo/60/

17

Doses per 100 000 inhabitants)

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

1500

1000

500

0
0

50

100

150

200

250

300

350

250

300

350

250

300

350

Time (days)
0.0014

Symptomatic Pop. Fraction

0.0012
0.0010
0.0008
0.0006
0.0004
0.0002
0.0000
0

50

100

150

200

Time (days)

Hospitalized Pop. Fraction

0.0020

0.0015

0.0010

0.0005

0.0000
0

50

100

150

200

Time (days)

Figure 14: Symptomatic Prevalence and Hozpitalization. https://plotly.com/ AdrianSalcedo/61/

18

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

184

7. Conclusion

193

Despite that NPIs have been implemented in most countries to mitigate COVID-19, these strategies
cannot develop immunity. Thus, vaccination becomes the primary pharmaceutical measure. However, this
vaccine has to be effective and well implemented in global vaccination programs, and each development
implies particular issues. Thus new challenges in distribution, stocks, politics, vaccination efforts, among
others, emerge. In this work, we have studied the effect of the combined strategy lockdown-vaccination and
our result suggest that the NPIs would be essential to face the new emergent problems with the accepted
vaccines.
We consider that it is very important to implement stratification by risk and age. Thus our efforts in
future research would be directed in combination with the results presented in this manuscript.

194

Data availability

185
186
187
188
189
190
191
192

195

196

https://github.com/SaulDiazInfante/NovelCovid19-OptimalPiecewiseControlModelling.git
Authors’ contributions

206

Gabriel A. Salcedo-Varela Conceptualization, Methodology, Software, Validation, Formal analysis,
Investigation, Resources, Visualization, Project Administration, Writing–original draft, Writing–review &
editing.
F. Peńuńuri Methodology, Software, Validation, Formal analysis, Investigation, Data curation, Visualization, Supervision, Writing–original draft, Writing–review & editing.
David González-Sánchez: Conceptualization, Methodology, Formal analysis, Writing–original draft,
Writing–review & editing.
Saúl Dı́az-Infnte: Conceptualization, Methodology, Formal analysis, Writing–original draft, Writing–review & editing. Methodology, Software, Validation, Formal analysis, Investigation, Data curation,
Visualization, Supervision

207

Conflicts of interest

197
198
199
200
201
202
203
204
205

208

209

210
211

The authors have no competing interests.
Appendix A. Existence of optimal policies
In this appendix, we show the existence of optimal policies in the class of piecewise constant policies.
Consider the following cost functional that we want to minimize
Z T
C(X(t), u(t))dt
(A.1)
0

212

subject to the dynamics
Ẋ(t) = f (X(t), u(t)),

213
214
215

0 ≤ t ≤ T,

(A.2)

and the initial state X(0) = x0 . The functions u : [0, T ] → U are called control polices, where U is a subset
of some Euclidean space. Let t0 < t1 < . . . < tn , with t0 = 0 and tn = T , be a partition of the interval
[0, T ]. We consider piecewise constant policies ũ of the form
ũ(t) = aj

tj ≤ t < tj+1

216

for j = 0, . . . , n − 1.

217

Assumptions 3. We made the following assumptions.
19

(A.3)

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

218

(A-1) The function f in the dynamics (A.2) is of class C 1 .

219

(A-2) The cost function C in (A.1) is continuous and the set U is compact.

220

By Assumption (A-1), the system
Ẋ(t) = f (X(t), a0 ),

221
222

0 ≤ t ≤ t1 ,

X(0) = x0 ,

has a unique solution X̃0 (t; x0 , a0 ) which is continuous in (x0 , a0 ); see, for instance [27]. Next, put x1 :=
X̃0 (t1 ; x0 , a0 ) and consider the system
Ẋ(t) = f (X(t), a1 ),

t1 ≤ t ≤ t2 ,

X(t1 ) = x1 ,

Again, by Assumption (A-1), the latter system has a unique solution X̃1 (t; x1 , a1 ) which is continuous in
(x1 , a1 ). By following this procedure, we end up having a recursive solution
tn−1 ≤ t ≤ T,

X̃n−1 (t; xn−1 , an−1 ),

xn−1 := X̃n−2 (tn−1 ; xn−2 , an−1 ),
223
224

where X̃n−1 is continuous in (xn−1 , an−1 ).
For a control ũ of the form (A.3) and the corresponding solution path X̃, we have
Z

T

C(X̃(t), ũ(t))dt =
0

225
226

n−1
X Z tj+1
j=0

C(X̃j (t), aj )dt.

tj

Notice that each X̃j is a continuous function of (a0 , . . . , aj ) and x0 .
By Assumption (A-2), the mapping
(a0 , . . . , an−1 ) 7→

n−1
X Z tj+1
j=0

C(X̃j (t), aj )dt

tj

231

is continuous. Since each piecewise constant policy ũ of the form (A.3) can be identified with the vector
(a0 , . . . , an−1 ) in the compact set U × · · · × U , the functional (A.1) attains its minimum in the class of
piecewise constant policies.
The cost functional (5) and the dynamics (1) are particular cases of (A.1) and (A.2), respectively, and
satisfy Assumptions (A-1) and (A-2). Then there exists an optimal vaccination policy of the form (A.3).

232

References

227
228
229
230

233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248

[1] K. M. Bubar, S. M. Kissler, M. Lipsitch, S. Cobey, Y. Grad, D. B. Larremore, Model-informed COVID-19 vaccine
prioritization strategies by age and serostatus, medRxiv (2020) 2020.09.08.20190629.
URL https://www.medrxiv.org/content/10.1101/2020.09.08.20190629v1
[2] L. Matrajt, J. Eaton, T. Leung, E. R. Brown, Vaccine optimization for COVID-19, who to vaccinate first?, medRxiv : the
preprint server for health sciences (2020). doi:10.1101/2020.08.14.20175257.
URL http://www.ncbi.nlm.nih.gov/pubmed/32817963{%}0Ahttp://www.pubmedcentral.nih.gov/articlerender.fcgi?
artid=PMC7430607
[3] J. H. Buckner, G. Chowell, M. R. Springborn, Optimal dynamic prioritization of scarce covid-19 vaccines, medRxiv : the
preprint server for health sciences (September 2020). doi:10.1101/2020.09.22.20199174.
URL https://europepmc.org/articles/PMC7523157
[4] L. Ó. Náraigh, Á. Byrne, Piecewise-constant optimal control strategies for controlling the outbreak of COVID-19 in the
Irish population, Mathematical Biosciences 330 (2020) 108496. doi:10.1016/j.mbs.2020.108496.
URL https://linkinghub.elsevier.com/retrieve/pii/S0025556420301450
[5] S. Ullah, M. A. Khan, Modeling the impact of non-pharmaceutical interventions on the dynamics of novel coronavirus
with optimal control analysis with a case study, Chaos, Solitons and Fractals 139 (2020) 110075(1–15). doi:10.1016/j.
chaos.2020.110075.

20

medRxiv preprint doi: https://doi.org/10.1101/2021.01.13.21249773; this version posted January 15, 2021. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313

[6] M. Mandal, S. Jana, S. K. Nandi, A. Khatua, S. Adak, T. Kar, A model based study on the dynamics of COVID-19:
Prediction and control, Chaos, Solitons & Fractals 136 (2020) 109889. doi:10.1016/j.chaos.2020.109889.
URL
https://doi.org/10.1016/j.chaos.2020.109889https://linkinghub.elsevier.com/retrieve/pii/
S0960077920302897
[7] J. S. Weitz, S. J. Beckett, A. R. Coenen, D. Demory, M. Dominguez-Mirazo, J. Dushoff, C. Y. Leung, G. Li, A. Măgălie,
S. W. Park, R. Rodriguez-Gonzalez, S. Shivam, C. Y. Zhao, Modeling shield immunity to reduce COVID-19 epidemic
spread, Nature Medicine 26 (6) (2020) 849–854. doi:10.1038/s41591-020-0895-3.
URL https://doi.org/10.1038/s41591-020-0895-3
[8] G. B. Libotte, F. S. Lobato, G. M. Platt, A. J. d. S. Neto, Determination of an Optimal Control Strategy for Vaccine
Administration in COVID-19 Pandemic Treatment (November 2019) (apr 2020). arXiv:2004.07397.
URL http://arxiv.org/abs/2004.07397
[9] World of Health Organization, WHO methods and data sources for global burden of disease estimates 2000-2011 (Accessed
2020).
URL https://www.who.int/healthinfo/statistics/GlobalDALYmethods_2000_2011.pdf
[10] World Health Organization, Datos abiertos sobre salud pública, acciones sociales y gasto público en la Ciudad de México.
(Octber 2020).
URL https://datos.cdmx.gob.mx/pages/covid19/
[11] M. A. Acuña-Zegarra, M. Santana-Cibrian, J. X. Velasco-Hernandez, Modeling behavioral change and COVID-19 containment in Mexico: A trade-off between lockdown and compliance, Mathematical Biosciences 325 (2020) 108370.
doi:10.1016/j.mbs.2020.108370.
[12] P. Van den Driessche, J. Watmough, Reproduction numbers and sub-threshold endemic equilibria for compartmental
models of disease transmission, Mathematical Biosciences 180 (1-2) (2002) 29–48. doi:10.1016/S0025-5564(02)00108-6.
[13] H. Zhao, Z. Feng, Staggered release policies for COVID-19 control: Costs and benefits of relaxing restrictions by age and
risk, Mathematical Biosciences 326 (2020) 108405. doi:10.1016/j.mbs.2020.108405.
[14] N. Kounang, Pfizer says early analysis shows its Covid-19 vaccine is more than 90% effective, prees release (2020).
URL https://edition.cnn.com/2020/11/09/health/pfizer-covid-19-vaccine-effective/index.html
[15] P. Ivanova, Russia says its sputnik v covid-19 vaccine is 92% effective, prees release, November 11, 2020 (2020).
URL https://www.reuters.com/article/health-coronavirus-russia-vaccine/russia-says-its-sputnik-v-covid-19-vaccine-is-92[16] E. Cohen, Moderna’s coronavirus vaccine is 94.5% effective, according to company data, prees release updated November
16, 2020 (2020).
URL https://edition.cnn.com/2020/11/16/health/moderna-vaccine-results-coronavirus/index.html%
[17] Comisión Nacional de Vivienda, Proyecciones de población (Accesed November 2020).
URL https://sniiv.conavi.gob.mx/demanda/poblacion_proyecciones.aspx
[18] N. M. Ferguson, D. Laydon, G. Nedjati-gilani, N. Imai, K. Ainslie, M. Baguelin, S. Bhatia, A. Boonyasiri, Z. Cucunubá,
G. Cuomo-dannenburg, A. Dighe, H. Fu, K. Gaythorpe, W. Green, A. Hamlet, W. Hinsley, L. C. Okell, S. Van, H. Thompson, R. Verity, E. Volz, H. Wang, Y. Wang, P. G. T. Walker, C. Walters, P. Winskill, C. Whittaker, C. A. Donnelly, S. Riley,
A. C. Ghani, Impact of non-pharmaceutical interventions ( NPIs ) to reduce COVID- 19 mortality and healthcare demand (March) (2020). doi:https://doi.org/10.25561/77482.
[19] M.-W. Jo, D.-S. Go, R. Kim, S. W. Lee, M. Ock, Y.-E. Kim, I.-H. Oh, S.-J. Yoon, H. Park, The Burden of Disease due to
COVID-19 in Korea Using Disability-Adjusted Life Years, Journal of Korean Medical Science 35 (21) (2020) e199 (1–10).
doi:10.3346/jkms.2020.35.e199.
[20] P. van den Driessche, Reproduction numbers of infectious disease models, Infectious Disease Modelling 2 (3) (2017)
288–303. doi:10.1016/j.idm.2017.06.002.
URL
http://dx.doi.org/10.1016/j.idm.2017.06.002https://linkinghub.elsevier.com/retrieve/pii/
S2468042717300209
[21] M. E. Alexander, C. Bowman, S. M. Moghadas, R. Summers, A. B. Gumel, B. M. Sahai, A vaccination model for
transmission dynamics of influenza, SIAM Journal on Applied Dynamical Systems 3 (4) (2004) 503–524. doi:10.1137/
030600370.
[22] R. Storn, K. Price, Differential evolution – a simple and efficient heuristic for global optimization over continuous spaces,
Journal of Global Optimization 11 (4) (1997) 341–352. doi:https://doi.org/10.1023/A:1008202821328.
[23] Bilal, M. Pant, H. Zaheer, L. Garcia-Hernandez, A. Abraham, Differential evolution: A review of more than two decades of
research, Engineering Applications of Artificial Intelligence 90 (2020) 103479. doi:https://doi.org/10.1016/j.engappai.
2020.103479.
[24] K. Cantún-Avila, D. González-Sánchez, S. Dı́az-Infante, F. Peñuñuri, Optimizing functionals using differential evolution,
Engineering Applications of Artificial Intelligence 97 (2021) 104086. doi:https://doi.org/10.1016/j.engappai.2020.
104086.
[25] F. Peñuñuri, C. Cab, O. Carvente, M. Zambrano-Arjona, J. Tapia, A study of the classical differential evolution control
parameters, Swarm and Evolutionary Computation 26 (2016) 86 – 96. doi:https://doi.org/10.1016/j.swevo.2015.08.
003.
[26] D. Varela-Salcedo, Gabriel Gónzalez-Sánchez, S. Dı́az-Infante, F. Peñuñuri, Source code for the manuscript Optimal
Vaccine Policies for COVID-19 (2020).
URL https://github.com/SaulDiazInfante/NovelCovid19-OptimalPiecewiseControlModelling.git
[27] Q. Kong, A short course in ordinary differential equations, Universitext, Springer, Cham, 2014. doi:10.1007/
978-3-319-11239-8.
URL https://doi.org/10.1007/978-3-319-11239-8

21

