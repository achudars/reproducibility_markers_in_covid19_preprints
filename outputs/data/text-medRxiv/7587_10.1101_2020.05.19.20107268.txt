medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

A simple criterion to design optimal non-pharmaceutical
interventions for epidemic outbreaks
Marco Tulio Anguloa; , Fernando Castañosb , Rodrigo Moreno-Mortonc , Jorge X. Velasco-Hernándezd ,
and Jaime A. Morenoe

a

CONACyT - Institute of Mathematics, Universidad Nacional Autónoma de México, Juriquilla, 76230, México
b
Department of Automatic Control, CINVESTAV-IPN, Ciudad de México, 07360, México
c
Faculty of Sciences, Universidad Nacional Autónoma de México, Ciudad de México, 04510, México
d
Institute of Mathematics, Universidad Nacional Autónoma de México, Juriquilla, 76230, México
e
Institute of Engineering, Universidad Nacional Autónoma de México, Ciudad de México, 04510, México

To whom correspondence should be addressed:  mangulo@im.unam.mx

October 5, 2020

NOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice.

1

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

1

Abstract

2

For mitigating the COVID-19 pandemic, much emphasis is made on implementing non-pharmaceutical inter-

3

ventions to keep the reproduction number below one. However, using that objective ignores that some of these

4

interventions, like bans of public events or lockdowns, must be transitory and as short as possible because of

5

their significative economic and societal costs. Here we derive a simple and mathematically rigorous criterion

6

for designing optimal transitory non-pharmaceutical interventions for mitigating epidemic outbreaks. We find

7

that reducing the reproduction number below one is suﬃcient but not necessary. Instead, our criterion prescribes

8

the required reduction in the reproduction number according to the desired maximum of disease prevalence and

9

the maximum decrease of disease transmission that the interventions can achieve. We study the implications

10

of our theoretical results for designing non-pharmaceutical interventions in 16 cities and regions during the

11

COVID-19 pandemic. In particular, we estimate the minimal reduction of each region’s contact rate necessary

12

to control the epidemic optimally. Our results contribute to establishing a rigorous methodology to guide the

13

design of optimal non-pharmaceutical intervention policies.

2

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

14

Introduction

15

Since the seminal work of May and Anderson [1], the design of interventions to eradicate infectious diseases

16

has the objective of achieving a basic (R0 ) or eﬀective reproduction number below one [2, 3]. The underlying

17

assumption here is that it is possible to maintain interventions for long periods, such as long-term vaccination

18

programs. During the COVID-19 pandemic, this same objective is guiding the design of non-pharmaceutical

19

interventions (NPIs) [4]. However, maintaining NPIs like bans of public events or lockdowns for long periods of

20

time is infeasible because of their substantial economic and societal costs [5, 6]. Actually, instead of aiming for

21

eradication, NPIs aim to mitigate the economic and social costs of the epidemic outbreak [7]. Nevertheless, we

22

still lack simple guidelines to design NPIs for mitigating epidemic outbreaks, analogous to the R0 < 1 condition

23

for eradication.

24

Here we use the classical Susceptible-Infected-Removed epidemiological model to fully characterize the

25

design of NPIs for mitigating epidemic outbreaks. With this aim, we consider that NPIs should achieve an op-

26

timal tradeoﬀ between two objectives [8]. First, optimal NPIs must minimize the period in which they need

27

to be applied, consequently minimizing their associated economic and societal costs. Second, optimal NPIs

28

must guarantee that the disease prevalence does not exceed a specified maximum level, which for example can

29

represent the health services’ capacity for that particular disease [9]. We obtain a full analytical characterization

30

of such optimal NPIs, specifying the optimal intervention at each state that the epidemic can be. This character-

31

ization yields the necessary and suﬃcient criterion for the existence of optimal NPIs for mitigation, analogous

32

to the R0 < 1 condition for eradication. We find that reducing the reproduction number below one is suﬃcient

33

but not necessary for their existence. Instead, we show that the desired maximum disease prevalence determines

34

the necessary reduction in the reproduction number. The consequence of not reducing the reproduction number

35

below one is that interventions must start before the disease prevalence reaches the specified maximum level.

36

We also demonstrate numerically that the derived optimal NPIs are robust to uncertainties in the model parame-

37

ters and unmodeled epidemic dynamics (e.g., undetected infections). Finally, we explore the implications of our

38

theoretical result by analyzing the response of 16 cities and regions across the globe to the COVID-19 pandemic,

39

finding that most regions achieved a larger-than-necessary reduction in transmission. Our results contribute to

40

designing non-pharmaceutical interventions to respond optimally and robustly against epidemic outbreaks.

41

Characterizing optimal non-pharmaceutical interventions

42

Optimal epidemic mitigation using NPIs

43

Our objective is to characterize the reduction in the disease transmission that is optimal for each state in which

44

the epidemic outbreak can be. For this, we leverage on the mathematical tractability of the Susceptible-Infected3

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

45

Removed (SIR) model [10], where the state can be characterized by the pair .S; I / 2 Œ0; 12 . Here, S is the

46

proportion of the population that is susceptible to the disease, and I is the disease prevalence (i.e., proportion

47

of the population that is infected), see Fig. 1a. We discuss later other more detailed epidemic models. The

48

epidemic state changes with time t as the disease is transmitted, producing the trajectory .S.t /; I.t// for t  0.

49

For epidemic mitigation, we consider that the goal is keeping the disease prevalence below a specified level

50

Imax 2 .0; 1. This constant may characterize, for example, the health services’ capacity in the sense that a

51

prevalence above Imax causes higher mortality due to hospital saturation [11]. In general, Imax should consider

52

all social and economic conditions of the specific population where the outbreak occurs. To keep I.t/  Imax ,

53

we assume we can apply one or several NPIs that reduce disease transmission by the factor .1

54

u 2 Œ0; 1, see Fig. 1a. The NPIs achieve no reduction when u D 0, and they completely stop transmission

55

when u D 1. Since it is unfeasible to stop transmission fully, we upper-bound the reduction by umax 2 .0; 1/.

56

We say that u is admissible if u 2 Œ0; umax .

u/, for some

57

Diﬀerent admissible NPIs can keep the disease prevalence below Imax . For instance, “intervention 1” in

58

the example of Fig. 1b-c keeps this restriction and has an “eﬀective duration” of 120 days. Here, the eﬀective

59

duration of an intervention is the interval between the start of the outbreak and the last time that a non-zero

60

intervention is applied (Fig. 1d). “Intervention 2” of Fig. 1b-c also keeps the restriction I.t/  Imax , but its

61

eﬀective duration is only 69 days. To design the optimal NPI, we ask for the intervention with minimal eﬀective

62

duration. Specifically, we ask for the admissible reduction u .S.t /; I.t// required now (i.e., at the current state)

63

such that: (1) it minimizes the eﬀective duration of the intervention; and (2) it ensures that the prevalence can

64

be maintained below Imax for all future time by using some admissible intervention. If the optimal NPI problem

65

has a solution u , then u .S; I / characterizes the optimal reduction in the disease transmission that the NPIs

66

should achieve if the epidemic state is .S; I /. In particular, u gives the optimal way to start and stop the NPIs.

67

Optimal NPIs exist without reducing the reproduction number below one

68

Our first main result is a complete analytical characterization of the optimal NPIs in the SIR model (see Box 1

69

for a summary and Supplementary Note S1 for details). To understand how the optimal NPIs work, note that the

70

SIR model predicts a safe zone of states .S; I / where, without any further interventions, the disease prevalence

71

will not exceed Imax (blue zone in Fig. 2a-c). The safe zone is characterized by the inequality I  ˚R0 .S/,

72

where R0 is the basic reproduction number of the outbreak in the population, and the function ˚R is defined

73

in Eq. (2) of Box 1. The goal of an optimal NPI is thus to reach this safe zone as fast as possible without

74

violating the restriction I.t/  Imax . The ability to achieve this goal depends on the epidemic state. That is,

75

we can partition the plane .S; I / in two regions: those states from which it is possible to reach the safe zone

76

without exceeding Imax (feasible states), and those where it is impossible (unfeasible states). We find these two

4

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

77

regions are characterized by the separating curve ˚Rc .S/, where we call Rc WD .1

78

reproduction number (Fig. 2a-c). Note that Rc describes the maximum reduction in the basic reproduction

79

number that (constant) admissible interventions can achieve. Therefore, Rc < 1 is the necessary and suﬃcient

80

condition that a constant and permanent admissible intervention (i.e., u.t/  const. for all t  0) needs to satisfy

81

to eradicate a disease outbreak in the SIR model. However, for outbreak mitigation, our analysis shows that

82

feasible states exists without achieving disease eradication (white regions in Fig. 2b-c). This result is important

83

because it proves that optimal NPIs for epidemic mitigation do not require reducing the basic reproduction

84

number below one.

85

A design criterion for optimal NPIs

86

We demonstrated above that optimal NPIs exist even when Rc > 1. However, how large can Rc be before NPIs

87

keeping I.t/  Imax do not exist? When S.0/ ! 1, our characterization shows that an NPIs exists if and only

88

if
Rc  1;

or

1
Imax C
ln Rc
Rc


1

1
Rc



 0:

umax /R0 the controlled

(1)

89

The above inequality is our second main result, connecting the specified maximum disease prevalence Imax with

90

the outbreak’s controlled reproduction number Rc D .1

91

(1) governs the existence of NPIs for mitigating epidemic outbreaks, in analogy to how the condition Rc < 1

92

works for disease eradication. Note that Rc < 1 is a suﬃcient condition for the existence for NPIs, but the

93

inequality (1) shows that this condition is far from necessary. If Imax > 0, there exists Rc > 1 for which NPIs

94

exist (Fig. 2d). Note also that the maximum feasible Rc increases with Imax .

umax /R0 (Supplementary Note S2). The inequality

95

We can use (1) to design NPIs as follows. Consider an infectious disease outbreak with a given R0 and

96

that the specified maximum prevalence is Imax . Then, the inequality (1) gives the criterion to design NPIs

97

by providing the range of disease transmission reduction umax that the NPIs should attain. In particular, it

98

provides the minimal reduction umax in the contact rate required for the existence of NPIs. For example, if

99

Imax D 0:1 then Rc D 1:71 is the maximum admissible controlled reproduction number (orange point in Fig.

100

2d). Therefore, if an outbreak in the population has R0 D 3, then the minimal reduction is umax D 0:43 because

101

.1

102

Optimal NPIs are simple

103

For any epidemic state, the optimal transmission reduction takes a simple form which can be described by

104

coloring the .S; I / plane, see top row of Fig. 3. Here, for all states in the white region the optimal intervention

105

is no intervention; for all states in the yellow region the optimal intervention is u .S; I / D umax . There are

106

regions (specifically lines) where the optimal intervention switches frequently between u D 0 and u D umax

umax /R0 D Rc .

5

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

107

producing a so-called “singular arc” that slides along the two regions, leading to an “average” intervention

108

u 2 Œ0; umax . We find that, in general, the optimal NPIs have four phases: a first one where no intervention

109

is needed, a second phase where interventions start with maximum strength, a third phase of gradual decrease

110

of interventions, and a “final push” where the maximum interventions are re-applied for a short period to reach

111

the safe zone faster.

112

We illustrate the above behavior in three qualitatively diﬀerent cases. The first case is when the optimal

113

intervention starts just when the disease prevalence reaches Imax (Fig. 3a). This case occurs when the interven-

114

tions are strong enough to stop the rise in prevalence at Imax regardless of the fraction of susceptible population.

115

Our analysis shows that this occurs if and only if umax is large enough to render Rc D .1

116

the initial susceptible population is close to 1 (pink trajectory in Fig. 3a), the optimal intervention first waits

117

until the disease prevalence reaches Imax . At that time, the optimal NPI stops the disease prevalence exactly at

118

Imax , and then it gradually decreases its magnitude to ensure that the disease prevalence slides along Imax as

119

the susceptible population decreases. When the susceptible population reaches the threshold S  , the optimal

120

intervention is again the maximum one (Fig. 3a). This “final push” allows reaching the safe zone faster, releas-

121

ing the interventions sooner. The middle and bottom panels of Fig. 3a show the resulting disease prevalence

122

and optimal interventions as a function of time. Note that a smaller initial susceptible population yields other

123

trajectories (green and purple in Fig. 3a).

umax /R0  1. When

124

The second case is when an “early” intervention is necessary before the disease prevalence reaches Imax

125

(Fig. 3b). This case happens when the admissible reduction in the contact rate cannot immediately stop the

126

disease prevalence at Imax if the susceptible population is large at that time. We find this case occurs if and only

127

if umax is small in the sense that Rc D .1

128

reaching Imax (pink trajectory in Fig. 3b). When that happens, the optimal intervention starts with the maximum

129

reduction u D umax . Then it maintains this maximum reduction to “slide” the trajectory between the yellow

130

and white regions. Once the trajectory reaches Imax , the magnitude of the optimal intervention decreases to

131

slide the trajectory along Imax . Again, the final push occurs when the susceptible population reaches S  .

umax /R0 > 1. Here, a trajectory may hit the yellow region before

132

The third case is when the initial state .S0 ; I0 / lies in the unfeasible region (Fig. 3c). This case occurs

133

when umax is so small that, even if the maximum admissible intervention u D umax is applied from the start

134

of the outbreak, the disease prevalence will exceed Imax (pink trajectory in Fig. 3c). In this case the optimal

135

intervention problem is unfeasible because it is impossible to achieve I.t/  Imax . However, note that the using

136

u D umax yields the smallest prevalence peak.

6

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

137

Optimal NPIs are robust

138

To evaluate the optimal NPIs in more realistic scenarios, we numerically analyzed their performance in three

139

epidemic models with uncertain epidemic parameters and more detailed epidemic dynamics (see details in

140

Supplementary Note S3). In all cases, we consider that the basic reproduction number has been estimated

141

as RO 0 using an SIR model, and that the optimal NPIs are designed using this estimate. Then, these optimal

142

NPIs are applied to an outbreak with possibly diﬀerent epidemic dynamics and possibly diﬀerent R0 . Note that

143

estimation errors in R0 will aﬀect the correct start and “final push” for reaching the safe zone.

144

In the first scenario, we consider an outbreak with SIR dynamics where the strength of the NPIs is uncertain.

145

We model this uncertainty replacing u by ku in the model equations, where k 2 .0; 1/. Then, for example,

146

k D 0:9 (resp. k D 1:1) represents a 10% underestimation (resp. overestimation) of the NPIs strength. Across

147

outbreaks with diﬀerent R0 ’s and an uncertainty of 10% in the intervention’s strength, we find that the disease

148

prevalence is maintained below Imax as long as R0 is not underestimated (Fig. 4a). In the second scenario, we

149

consider an SEIR outbreak with an incubation period for the disease. For an incubation period of 7 days as in a

150

typical COVID-19 infection, the optimal NPIs maintain the disease prevalence below Imax if R0 < 2:5 and its

151

value is estimated with an error of below 30% (solid yellow and orange in Fig. 4b). For larger R0 or a larger

152

incubation period, the disease prevalence may exceed Imax (red in Fig. 4b).

153

For the final scenario, we consider an SEIIR model with an incubation period of 7 days and with a fraction

154

p 2 Œ0; 1 of infected individuals that are asymptomatic and thus remain hidden to the epidemic surveillance

155

system. The goal is to maintain the prevalence of symptomatic individuals below Imax , without knowing the

156

fraction of asymptomatic individuals. This situation occurs during the COVID-19 pandemic, where between

157

p D 0:55 and p D 0:8 of infections are asymptomatic [12]. For p < 0:7 and R0 < 3:64, the optimal

158

NPIs maintain the disease prevalence of symptomatic individuals below or very close to Imax if the estimation

159

error for R0 is below 30% (dotted and solid lines in Fig. 4c). An outbreak with low R0 produces a maximum

160

disease prevalence of symptomatic individuals below Imax , which may result in a larger eﬀective duration of

161

the interventions. Overall, these numerical results shows that the optimal NPIs are robust against a wide range

162

of parameter uncertainty and unmodeled dynamics, provided that the estimation error in the outbreak’s basic

163

reproduction number does not exceed 30%.

164

Designing optimal NPIs for the COVID-19 pandemic

165

To explore the implications of our simple criterion for designing NPIs, we analyzed how 16 cities and regions

166

implemented NPIs during the COVID-19 pandemic. For each region or city, we constructed Imax using the

167

number of available intensive care beds, considering that a fraction of the infected individuals will require them

7

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

3

for Lima (Peru) to 109:78  10

3

168

(Supplementary Note S4). The Imax we obtain ranges from 2:87  10

169

for Boston (US), reflecting the large heterogeneity of the available health services across the globe (Fig. 5a).

170

With this information, we calculated the maximum feasible Rc for each region using our design criterion of

171

inequality (1). Since Rc is a monotone function of Imax , we find that Rc follows the same trend as Imax (Fig.

172

5b). The smallest Rc D 1:08 occurs for Lima and the largest Rc D 1:75 for Boston. Note that in both cases

173

Rc > 1. This result implies that, for the R0 of a region’s disease outbreak, NPIs policies must be implemented

174

to guarantee that at least a reduction umax can be achieved such that .1

umax /R0  Rc .

175

Next, we investigated the minimal reduction umax in transmission required to achieve those upper bounds

176

for the COVID-19 pandemic. For this, we first collected information for the R0 in each region calculated at the

177

start of the pandemic and when the NPIs were inactive (Supplementary Note S3). We find a median nominal

178

R0 of 2.2, with Tokyo having the smallest one (R0 D 1:3) and Madrid having the largest one (R0 D 3:11),

179

see Fig. 5c. From these values of R0 , we calculated the minimal required reduction umax per region or city

180

(blue in Fig. 5d). For the nominal R0 ’s per region or city, we find that a median reduction of umax of 0.42 is

181

necessary. However, this minimal necessary reduction is heterogeneous across regions. For example, Tokyo

182

just requires umax D 0:15 while Madrid requires umax D 0:61. These two cities have the smallest and largest

183

R0 , respectively. If two cities have a comparable R0 , then the city with large Imax ends requiring a smaller umax

184

(e.g., Boston with umax D 0:26 and Lima with umax D 0:50).

185

To evaluate the feasibility of achieving the minimal reduction predicted by our analysis, we collected data for

186

the average mobility reduction in each region during the NPIs in each region (grey in Fig. 5d and Supplementary

187

Note S4). Considering this average mobility reduction as a proxy for the reduction in disease transmission, we

188

find that all regions achieved a greater than necessary reduction. For example, Delhi attained a mobility reduction

189

of 0.84, while the minimal necessary reduction in transmission according to our analysis is umax D 0:42. Other

190

regions are in the boundary. For example, New South Wales attained a mobility reduction of 0.48, while the

191

minimal necessary reduction in transmission was umax D 0:44. Overall, across regions, we find a median excess

192

of 0.22 in the reduction of mobility compared to the minimal reduction in transmission umax predicted by our

193

analysis.

194

Discussion and concluding remarks

195

Our choice of a simple SIR model was motivated by its epidemiological adequacy for the COVID-19 pandemic

196

and its low dimensionality. The mathematical tractability of the SIR model gives us a complete understanding of

197

the optimal NPIs to apply at any epidemic state. The feedback form u .S; I / of the optimal intervention reflects

198

such understanding, prescribing the optimal action to perform if the epidemic is at state .S; I /. This feedback

199

strategy should be contrasted to most other studies applying optimal control to epidemic outbreaks, where the
8

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

200

optimal intervention is written as an open-loop function of time u .t/ [13–16] (see Supplementary Note S4 for

201

details about how our work is related to existing optimal control studies). The open-loop intervention gives the

202

optimal action at any time for a particular initial state. However, it does not tell us what the optimal action is

203

if the epidemic is not in the exact state predicted by the model. Understanding the optimal action to perform

204

at any state has the crucial advantage of allowing us to apply this knowledge to any model, and therefore to

205

reality. Indeed, feedback gives control strategies the required robustness to work on real processes [17, 18],

206

and we numerically confirm that the optimal NPIs we derived have such robustness. Future work could analyze

207

the robustness of the optimal intervention when the state of the epidemic is not entirely known. For example,

208

this case may happen when significative delays exist in reporting new infections, or when tests for identifying

209

infected individuals are limited.

210

The optimal intervention resulting from our analysis can take a continuum of values that may be infeasible

211

to implement in practice. We can use an averaging approach to circumvent this problem. Namely, consider a

212

time window of T days (e.g., a week). Suppose that the average reduction prescribed by the optimal intervention

213

over a certain window is uN  . We can realize this reduction on average by combining d D T uN  =umax days of

214

maximum reduction with .T

215

Karin et al. [19], with the diﬀerence that the periods of intervention and activity are optimally balanced.

d / days without intervention. This approach yields an intervention similar to

216

Our criterion to design optimal NPIs for mitigating epidemic outbreaks is obtained by characterizing the

217

necessary and suﬃcient conditions for the existence of solutions to an optimal control problem. Specifically,

218

the low-dimensionality of the SIR model allowed us to apply Green’s Theorem to compare the cost of any two

219

interventions analytically (Supplementary Note S1.4). In this sense, the method we use to derive the optimal

220

NPIs is closer to our previous work on optimal control for bioreactors [20]. In general, deriving such complete

221

characterization of optimal control problems is challenging because it involves solving an infinite-dimensional

222

optimization [21]. Indeed, computational methods cannot produce such a characterization [22], and established

223

analytical methods like Pontryagin’s Maximum Principle only yields necessary conditions for optimality [21].

224

We note that there are several studies applying these and other similar methods to the SIR model [23, 24], in

225

particular during the COVID-19 pandemic [11, 25–28]. Our results could guide a complete characterization of

226

optimal NPIs for more detailed epidemic models or more detailed optimization objectives, but this is likely very

227

challenging.

228

We will inevitably face new epidemics where non-pharmaceutical interventions are the only option to control

229

infections. Rather counter-intuitively, we find that for “ending” an epidemic outbreak as fast as possible using

230

NPIs it is not always optimal to apply the maximum intervention. This observation illustrates the need for devel-

231

oping a better scientific understanding that can inform the design of optimal non-pharmaceutical interventions

232

and plan the required health services capacity.

9

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

BOX 1. Optimal NPIs for the Susceptible-Infected-Removed (SIR) model.

The SIR model with interventions u.t/ 2 Œ0; umax  reducing disease transmission takes the form
dS
D
dt

.1

u/ˇ SI;

dI
D .1
dt

u/ˇ SI

I:

Here, S.t / and I.t/ are the proportion of the population that is susceptible or infected at time t  0,
respectively. We denote by .S0 ; I0 / the initial state at t D 0. The parameters of the SIR model are the
(eﬀective) contact rate ˇ  0, and the mean residence time of infected individuals  0 (in units of
day 1 ). By assuming S0  1, these two parameters yield the basic reproduction number R0 D ˇ= .
We are interested in reaching the safe zone
˚
S D .S; I / j I  ˚R0 .S/ ;
where

(
Imax
˚R .S/ D
Imax C R


1

log.RS/ C 1

RS



if S  R 1 ,
otherwise.

(2)

The safe zone is the largest set with the following property: If, for any given time t1 , the state .S1 ; I1 /
belongs to S, we can set u D 0 henceforth and still have I.t/  Imax for all t  t1 . That is, when S
is reached, we can terminate the intervention with the assurance that a possible rebound in the disease
prevalence will not exceed Imax .
Our goal is to steer an arbitrary initial state .S0 ; I0 / to the safe zone S in minimal time without violating
the constraint I.t/  Imax . We say that an intervention achieving this goal is an optimal intervention.
In Supplementary Note S1, we prove that the existence of an optimal intervention is characterized by the
separating curve ˚Rc as follows:
(1) An optimal intervention exists if and only if the initial state .S0 ; I0 / lies below this separating
curve (i.e., I0  ˚Rc .S0 /).
Above, Rc WD .1

umax /R0 is the controlled reproduction number. Moreover:

(2) If it exists, the optimal intervention u at the state .S; I / is
8
ˆ
if .S; I / 2 S [ W
<0

u .S; I / D 1 1=.Rc S/ if I D ˚Rc .S/ and S  < S < Rc 1
:̂
umax
otherwise

(3)

with
W D f.S; I / j I < ˚Rc .S/; S >

233

.I /g :

Above, the curve S D .I / is defined in Supplementary Note S1, while S  denotes the intersection of S D .I / and I D ˚Rc .S/.

10

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Figures
a

b
disease prevalence

susceptible

S
disease
transmission

NPI
policy

intervention

I

0.2

intervention 2
0.1

flow
information

D
deaths

R

d

recovered

0

20

40

60

80

100

120

140

1.

intervention 2

intervention 1

0.6
0.4
0.2
0.

individuals

intervention 1

0.05

0.8

infected

no intervention

0.15

0.

c

intervention

234

0

20

40

60

80

100

120

140

time (days since onset)
effective
duration

intervention 1
intervention 2

Figure 1: Optimal non-pharmaceutical interventions. a. Susceptible-Infected-Removed (SIR) model with
non-pharmaceutical interventions (NPIs) reducing disease transmission. For the optimal NPI design problem,
the objective is to design the intervention u .t/ with minimal eﬀective duration such that u .t/ 2 Œ0; umax  and
I.t/  Imax for all t  0. b and c. Panels show the response of the SIR model for two interventions (parameters
are ˇ D 0:52, D 1=7, I0 D 8:855  10 7 and S0 D 1 I0 ). Both intervention 1 and 2 satisfy u.t/  umax
and guarantee that I.t/  Imax Actually, intervention 2 is the optimal one derived using our analysis: it is
intervention with minimal eﬀective duration satisfying I.t/  Imax . d. The eﬀective duration of an intervention
measures the interval between the start of the outbreak and the last time that a non-zero intervention is applied.
In this example, the eﬀective duration of intervention 1 is 120 days, while the eﬀective duration of intervention
2 is 69 days.

11

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

a

b
0.2

0.2

prevalence

prevalence

0.15

unfeasible

0.15

0.1

safe
zone

0.05

0.

0.

0.2

0.6

0.8

0.1

safe
zone

0.05

feasible

0.4

unfeasible

0.

1.

0.

feasible

0.2

0.4

0.6

0.8

1.

suceptible

suceptible

supression

c

d

mitigation
0.5

prevalence

0.15

desired maximum prevalence

0.2

unfeasible

0.1

safe
zone

0.05

0.

0.

0.2

feasible
0.4

0.6

0.8

0.4

0.3

0.2

unfeasible
0.1

0.

1.

suceptible

feasible

0

1

2

3

4

5

controlled reproduction number

Figure 2: Existence of non-pharmaceutical interventions in the Susceptible-Infected-Removed model.
Parameters are D 1=7, ˇ D 0:52, (i.e., R0 D 3:64/ and Imax D 0:1. The safe zone (in blue) consists of all
states that dot not exceed Imax without interventions. This zone is characterized by the inequality I  ˚R0 .S/.
The plane is further divided into feasible states that can reach the safe zone without exceeding Imax (white),
and unfeasible states that cannot (gray). Feasible and unfeasible states are separated by the separating curve
˚Rc .S/ (black line). a. For “strong” interventions with umax D 0:8, the controlled reproduction number is
Rc D .1 umax /R0 D 0:728 < 1. Here, the separating curve is the straight line Imax , implying that all states
below Imax are feasible. Note this case corresponds to eradication. b. For “intermediate” interventions with
umax D 0:6, the controlled reproduction number is Rc D .1 umax /R0 D 1:456 > 1. Here, the separating curve
˚Rc .S/ is nonlinear, and some states below Imax are unfeasible. c. For “weak” interventions with umax D 0:4
we obtain Rc D 2:184 > 1. In this case, states with S.0/  1 are unfeasible. d. For S.0/ ! 1, our design
criterion for NPIs prescribe the values of Rc ’s that a given Imax can manage.

12

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

a

b

interventions are strong enough
to start at

maximum interevention

no
intervention

no
intervention

maximum interevention

no
intervention

no
intervention

0.2

0.2

0.15

0.15

0.15

0.1

0.

prevalence

0.2

0.05

0.1

0.05

0

20

40

60

80

100

0.

120

0.1

0.05

0

20

time (days since onset)

40

60

80

100

0.

120

1.

1.

1.

0.8

0.8

0.6

0.6

0.6

0.4

0.2
60

80

100

120

0.8
0.6
0.4
0.2
0.

0

20

40

60

80

100

120

0.
1.

20

40

60

80

100

120

0.8
0.6
0.4
0.2
0.

0

20

40

60

80

100

120

0.
1.

0.
1.
0.8

0.6

0.6

0.6

0.4

0.4

0.4

0.2

0.2

0.

0.

80

time (days since onset)

100

120

0

20

40

60

80

100

120

0

20

40

60

80

100

120

0

20

40

60

80

100

120

0.2

1.

60

120

0.4

0.8

40

100

0.6

1.

20

80

0.8

0.8

0

60

0.2
0

optimal intervention

40

optimal intervention

1.

20

40

0.4

0.2
0

20

time (days since onset)

0.8

0.

0

time (days since onset)

0.4

optimal intervention

interventions are too weak
to stop prevalence at

maximum interevention

prevalence

prevalence

no
intervention

c

interventions need to start
before reaching

0.2
0

20

40

60

80

time (days since onset)

100

120

0.

time (days since onset)

Figure 3: Optimal non-pharmaceutical interventions in the Susceptible-Infected-Removed model. For all
panels, the parameters of the SIR model are D 1=7, ˇ D 0:52, (i.e., R0 D 3:64/ and Imax D 0:1. We consider
a population of N D 8:855  106 individual (like in Mexico City) and I0 D 1=N . Panels shows trajectories for
three initial proportions of the susceptible population: large S0 D 1 I0  1 (pink), medium S0 D 0:8 (green),
and small S0 D 0:65 (purple). a. For umax D 0:8 we have Rc D .1 umax /R0 D 0:728  1. In this case, the
optimal intervention starts when the disease prevalence reaches Imax . Afterwards, the intervention decreases in
an hyperbolic arc until reaching the point S D S  . At that time, the intervention becomes maximum in the “final
push” to reach the safe zone. b. For umax D 0:58 the controlled reproduction number is Rc D .1 umax /R0 D
1:52 > 1. Here ˚Rc .1/ > 0, implying that the epidemic still can be mitigated for initial states with S0  1
and I0  0 (pink trajectory). In this case, the optimal intervention starts when the initial condition hits the
separating curve below Imax at t D 35. At that instant the intervention starts with the maximum value umax , and
continues in that form until the trajectory reaches Imax . c. Choosing umax D 0:4 yields Rc D 2:184 > 1. In this
case, the optimal intervention problem does not have a solution for all initial states S0 > 0:85. This is illustrated
by pink trajectory: even when applying the maximum intervention from the start, I.t/ will grow beyond Imax .

13

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

a

b

uncertain strength of interventions

-

0.8
0.6
0.4
0.2
0.
0.2
0.4
0.6
0.8

-

0.8
0.6
0.4
0.2
0.
0.2
0.4
0.6
0.8

-

0.8
0.6
0.4
0.2
0.
0.2
0.4
0.6
0.8

0.7

0.7

0.7

0.8

0.8

0.8

0.9

0.9

0.9

undersestimated

1.

1.

1.

1.1

1.1

1.1

1.2

1.2

1.2

overestimated

1.3

1.3

1.3

c

incubation period

-

0.8
0.6
0.4
0.2
0.
0.2
0.4
0.6
0.8

-

0.8
0.6
0.4
0.2
0.
0.2
0.4
0.6
0.8

-

0.8
0.6
0.4
0.2
0.
0.2
0.4
0.6
0.8

0.7

0.7

0.7

0.8

0.8

0.8

0.9

0.9

1.

1.

0.9

1.

undersestimated

1.1

1.1

1.1

1.2

1.2

1.2

overestimated

1.3

1.3

1.3

hidden infections

-

0.8
0.6
0.4
0.2
0.
0.2
0.4
0.6
0.8

-

0.8
0.6
0.4
0.2
0.
0.2
0.4
0.6
0.8

-

0.8
0.6
0.4
0.2
0.
0.2
0.4
0.6
0.8

0.7

0.7

0.7

0.8

0.9

1.

1.1

1.2

1.3

0.8

0.9

1.

1.1

1.2

1.3

0.8

0.9

1.

1.1

1.2

1.3

undersestimated

overestimated

Figure 4: Optimal non-pharmaceutical interventions are robust. For all panels, the estimated parameters
used for constructing the optimal NPIs are O D 1=7, ˇO D 0:52, Imax D 0:1, umax D 0:6. We consider a
population of N D 8:855  106 as in Mexico City, and the initial conditions I.0/ D 1=N and S.0/ D 1 1=N .
If the models contain other state variables, they were initialized at zero. The optimal NPIs are constructed
O O , while the actual epidemic dynamics has a possibly diﬀerent R0 D ˇ= . Panels shows
assuming RO 0 D ˇ=
results for outbreaks with three values of R0 : low (yellow), medium (orange), and large (red). a. A SIR model
where the reduction in the disease transmission by the NPIs is uncertain. We model this case replacing u by
ku in the model equations. Panel shows the results for k D 1:1 (dotted), k D 1 (solid), and k D 0:9 (dashed).
b. SEIR model where exposed individuals do not transmit the infection, with  > 0 the incubation period.
Panel shows the results for  D 1=5 (dotted),  D 1=7 (solid), and  D 1=11 (dashed). c. A SEIIR model
with  D 1=7 and two classes of infected individuals (symptomatic and asymptomatic). Here, p 2 Œ0; 1 is the
proportion of exposed individuals that become asymptomatic. The vertical axis denotes the disease prevalence
for symptomatic individuals. The panel shows the results for p D 0:55 (dotted), p D 0:7 (solid), and p D 0:8
(dashed).

14

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

a

estimated
0.00 0.05 0.10 0.15

b

c

maximum
feasible
1.

1.5

2.

1. 1.5 2. 2.5 3. 3.5

d

minimum necessary
reduction in transmission
0. 0.2 0.4 0.6 0.8 1.

Lima
Dehli (India)
Tokyo
New South Wales (Australia)
Dublin
Lombardy (Italy)

reported
average
mobility
reduction

Bogota
Madrid
Mexico City
New York
British Columbia (Canada)
Vienna
Berlin
Buenos Aires
Athens
Boston

Figure 5: Minimum necessary reduction in disease transmission for NPIs in the COVID-19 pandemic.
a. Calculated Imax according to the proportion of available intensive care beds in each region or city and the
estimated fraction of infected individuals requiring intensive care. b. Maximum controlled reproduction number
Rc that each region or city can handle according to its Imax . Larger Imax allows a larger Rc . c. Basic reproduction
number R0 per region or city before interventions started. Median (blue big dot), and 95% confidence interval
(smaller dots) are shown. d. Minimum umax necessary for feasibility for each region or city (blue) according to
the R0 of panel c. Grey bars denote the reported average mobility reduction in each region between March 19
and April 30.

15

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

235

236

References
1.

329 (1985).

237

238

2.

3.

Fraser, C., Riley, S., Anderson, R. M. & Ferguson, N. M. Factors that make an infectious disease outbreak
controllable. Proceedings of the National Academy of Sciences 101, 6146–6151 (2004).

241

242

Anderson, R. M. & May, R. M. Infectious diseases of humans: dynamics and control (Oxford university
press, 1992).

239

240

Anderson, R. M. & May, R. M. Vaccination and herd immunity to infectious diseases. Nature 318, 323–

4.

Kupferschmidt, K. Ending coronavirus lockdowns will be a dangerous process of trial and error. Science|
AAAS (2020).

243

244

5.

Ferguson, N. M. et al. Strategies for mitigating an influenza pandemic. Nature 442, 448–452 (2006).

245

6.

Hollingsworth, T. D., Klinkenberg, D., Heesterbeek, H. & Anderson, R. M. Mitigation strategies for pandemic influenza A: balancing conflicting policy objectives. PLoS computational biology 7 (2011).

246

247

7.

healthcare demand. Imperial College COVID-19 Response Team 2020.

248

249

8.

252

Anderson, R. M., Heesterbeek, H., Klinkenberg, D. & Hollingsworth, T. D. How will country-based mitigation measures influence the course of the COVID-19 epidemic? The Lancet 395, 931–934 (2020).

250

251

Ferguson, N. et al. Impact of non-pharmaceutical interventions (NPIs) to reduce COVID-19 mortality and

9.

Elston, J., Cartwright, C., Ndumbi, P. & Wright, J. The health impact of the 2014–15 Ebola outbreak.
Public Health 143, 60–70 (2017).

253

10. Kermack, W. O. & McKendrick, A. G. A contribution to the mathematical theory of epidemics. Proceed-

254

ings of the royal society of london. Series A, Containing papers of a mathematical and physical character

255

115, 700–721 (1927).

256

257

258

259

260

261

262

263

11. Djidjou-Demasse, R., Michalakis, Y., Choisy, M., Sofonea, M. T. & Alizon, S. Optimal COVID-19 epidemic control until vaccine deployment. medRxiv (2020).
12. For Evidence-Based Medicine, O. C. COVID-19: What proportion are asymptomatic? <https://www.
cebm.net/covid-19/covid-19-what-proportion-are-asymptomatic/>.
13. Behncke, H. Optimal control of deterministic epidemics. Optimal control applications and methods 21,
269–285 (2000).
14. Yan, X. & Zou, Y. Optimal and sub-optimal quarantine and isolation control in SARS epidemics. Mathematical and Computer Modelling 47, 235–245 (2008).

16

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

264

265

266

267

268

269

270

271

272

273

274

275

15. Rowthorn, R. E., Laxminarayan, R. & Gilligan, C. A. Optimal control of epidemics in metapopulations.
Journal of the Royal Society Interface 6, 1135–1144 (2009).
16. Caetano, M. A. L. & Yoneyama, T. Optimal and sub-optimal control in Dengue epidemics. Optimal control
applications and methods 22, 63–73 (2001).
17. Åström, K. J. & Murray, R. M. Feedback systems: an introduction for scientists and engineers (Princeton
university press, 2010).
18. Angulo, M. T. & Velasco-Hernandez, J. X. Robust qualitative estimation of time-varying contact rates in
uncertain epidemics. Epidemics 24, 98–104 (2018).
19. Karin, O. et al. Adaptive cyclic exit strategies from lockdown to suppress COVID-19 and allow economic
activity. medRxiv (2020).
20. Moreno, J. Optimal time control of bioreactors for the wastewater treatment. Optimal Control Applications
and Methods 20, 145–164 (1999).

276

21. Lenhart, S. & Workman, J. T. Optimal control applied to biological models (CRC press, 2007).

277

22. Bonnans, F., Martinon, P. & Grélard, V. Bocop-A collection of examples (2012).

278

23. Hansen, E. & Day, T. Optimal control of epidemics with limited resources. Journal of mathematical biol-

279

280

281

282

283

ogy 62, 423–451 (2011).
24. Di Giamberardino, P. & Iacoviello, D. Optimal control of SIR epidemic model with state dependent switching cost index. Biomedical signal processing and control 31, 377–380 (2017).
25. Alvarez, F. E., Argente, D. & Lippi, F. A simple planning problem for covid-19 lockdown tech. rep. (National Bureau of Economic Research, 2020).

284

26. Piguillem, F. & Shi, L. Optimal covid-19 quarantine and testing policies (2020).

285

27. Tsay, C., Lejarza, F., Stadtherr, M. A. & Baldea, M. Modeling, state estimation, and optimal control for

286

287

288

the US COVID-19 outbreak. arXiv preprint arXiv:2004.06291 (2020).
28. Morris, D. H., Rossine, F. W., Plotkin, J. B. & Levin, S. A. Optimal, near-optimal, and robust epidemic
control. arXiv preprint arXiv:2004.02209 (2020).

17

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Supplementary Notes
A simple criterion to design optimal non-pharmaceutical interventions for epidemic outbreaks
Marco Tulio Angulo1* , Fernando Castaños2 , Rodrigo Moreno-Morton3 , Jorge X.
Velasco4 , and Jaime A. Moreno5
1 CONACyT

- Institute of Mathematics, Universidad Nacional Autónoma de México, Juriquilla, México.

2 Department
3 Faculty

of Automatic Control, CINVESTAV-IPN, Ciudad de México, México.

of Sciences, Universidad Nacional Autónoma de México, Ciudad de México, México.

4 Institute

of Mathematics, Universidad Nacional Autónoma de México, Juriquilla, México.

5 Institute

of Engineering, Universidad Nacional Autónoma de México, Ciudad de México, México.

∗ mangulo@im.unam.mx

5 October 2020

Contents
S1 Characterization of the optimal intervention in the Susceptible-Infected-Removed model
1
S1.1 Calculation of the orbits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2
S1.2 The number of infected people . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3
S1.3 Reachable set from (S0, I0 ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3
S1.4 Comparing the cost of two diﬀerent trajectories . . . . . . . . . . . . . . . . . . . . . . 4
S1.5 Optimal orbits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
S1.5.1 Unfeasible trajectories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
S1.5.2 Trivial trajectories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
S1.5.3 Bang-bang trajectories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
S1.5.4 Trajectories containing a singular arc . . . . . . . . . . . . . . . . . . . . . . . 9
S1.6 A feedback control strategy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
S2 Necessary and suﬃcient conditions for the existence of optimal NPIs

14

S3 Robustness of the optimal intervention
15
S3.1 Robustness to the presence of demography and an incubation period. . . . . . . . . . . . 15
S3.2 Robustness to the presence of hidden infected individuals. . . . . . . . . . . . . . . . . . 15
S4 Application to the COVID-19 pandemic
16
S4.1 Estimate for the fraction of infected individuals requiring intensive care. . . . . . . . . . 16
S4.2 Data used in our analysis. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
S5 Related work

18

0

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

S1.

Characterization of the optimal intervention in the SusceptibleInfected-Removed model

The model is given by
SÛ = − (1 − u) βSI
IÛ = (1 − u) βSI − γI ,

RÛ = γI

where the parameters β > 0, γ > 0 are assumed constant. Since the total population N = S + I + R
remains constant all the time, the model can be reduced to that of a second order system using only the
states (S, I). The maximal (acceptable) value of I is Imax and the maximal achievable value of the control
is umax . So the state has to belong to the following feasible sets
{
}
XF = (S, I) ∈ R2 | 0 ≤ S ≤ 1, 0 ≤ I ≤ Imax
UF = {u ∈ R | 0 ≤ u ≤ umax < 1} .
Sometimes it will be useful to write the diﬀerential equation in a compact form as
xÛ = f (x) + g (x) w, w = 1 − u
[ ] [
]
[ ]
SÛ
0
−1
ÛI = −γI + βSI 1 w .
The trajectory starting at the initial point x0 = (S0, I0 ) and subject to the control u : R → UF is denoted
by ϕ (t, x0, u (·)).
Let us define the function
{
Imax
if S < Rα−1
Φ Rα (S) =
Imax + Rα−1 (ln(RS) + 1 − Rα S) otherwise
with Rα ∈ {Rc, R0 }. The optimal control problem consists in finding the control strategy u such that,
starting from the initial point (S0, I0 ), the target set
{
}
T = (S, I) ∈ R2≥0 | I ≤ Φ R0 (S)
is reached in the minimal time with the state restriction I (t) ≤ Imax satisfied for all time. Note that this
set is positively invariant without control (u = 0), and that every trajectory that starts in this set satisfies
the restriction I(t) ≤ Imax for all t ≥ 0 (see Fig. S1).
Now let us define the reachable set for an initial state x0 as the set of points that can be reached from
the initial point x0 with feasible control, i.e.,
{
}
R (x0 ) = x ∈ R2≥0 | x = ϕ (t, x0, u (·)) for some finite t ≥ 0 and admissible u .
Also, we define the controllable set of the target set T as the set of points from which some point in the
target T can be reached with a feasible control, i.e.,
{
}
C (T) = x ∈ R2≥0 | ∃ x f ∈ T, x f = ϕ (t, x, u (·)) for some finite t ≥ 0 and admissible u .
The set C (T) can be equivalently described as R (T) for the system
xÛ = − f (x) − g (x) (1 − u) ,
1

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Supplementary Figure S1 | The set T is the largest positive invariant set satisfying I ≤ Imax . The figure was generated with R0 = 2,
R c = 1.18 and Imax = 0.02.

i.e., the set of points that can be reached from the set T for the dynamics with backward time. Now, the
optimal control problem has a solution if and only if
R (x0 ) ∩ C (T) ∩ XF , ∅ .
Since the points of the form (S, I) = (S, 0) are equilibria for every control value, R ((S, 0)) = (S, 0),
we exclude them from the initial conditions for which there is a solution (except if the equilibrium is
already in the target set). Now, since SÛ < 0 for S > 0, I > 0,
R (x0 ) ∩ C (T) , ∅
for every initial condition (except for initial conditions of the form (S, 0)). It is obvious that, for the
problem to be feasible, the initial state has to be in the feasible set XF , i.e.,
R (x0 ) ∩ XF , ∅ .

S1.1

Calculation of the orbits

Although it does not seem to be possible to find the trajectories of the system explicitly, it is easy to find
its orbits. For this we write (we exclude the points for which I = 0 since they are equilibria)
dI
IÛ (1 − u) βSI − γI (1 − u) βS − γ
= =
=
dS SÛ
− (1 − u) βSI
− (1 − u) βS
1
−1
=
(1 − u) R0 S
which is a separable diﬀerential equation (DE). Assuming that u is constant and integrating, we obtain
( )
1
S
I − I0 =
ln
− (S − S0 ) .
(S1)
S0
(1 − u) R0
2

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

An interesting rewriting of (S1) is
I (t) + S (t) −

1
1
ln (S (t)) =I0 + S0 −
ln (S0 ) .
(1 − u) R0
(1 − u) R0

1
This means that the quantity I (t) + S (t) − (1−u)R
ln (S (t)) remains constant along the trajectory. Note that
0
this constant depends on the control value used. The above equation is well-known for the SIR model
(see, e.g., [1]).
Given an initial condition (S0, I0 ) this expression gives, for any 0 < S < S0 the (unique) value of I
that is reached in future time1 . Thus there exists a function I (S; (S0, I0 )) that gives the value of I as a
function of S and the initial condition. Moreover, from the first equation in the DE we obtain

dS
= −dt
(1 − u) βSI
and, if we take the expression I (S; (S0, I0 )), we obtain a separable DE that can be integrated,
∫
T(S; S0, I0 ) = −

S

S0

dS
1
=−
(1 − u) βSI (S; (S0, I0 ))
(1 − u) β

∫

S

S0

(

S I0 +

1
(1−u)R0

dS
( )
),
ln SS0 − (S − S0 )

and that gives the time to reach the point (S, I (S)) from the initial point (S0, I0 ) with the (constant)
control u. Although it does not seem possible to give an explicit expression for this integral, it is clear
that S parametrizes uniquely the solutions (since it is monotone).

S1.2

The number of infected people

If we apply a constant control 0 ≤ u ≤ umax the infection will eventually die out, i.e., the value I (∞) = 0
will be reached asymptotically (otherwise R (t) would continue growing, which is impossible). We can
therefore compute S (∞) implicitly from (S1) as
(
)
1
S (∞)
I (∞) − I0 =
ln
− (S (∞) − S0 )
S0
(1 − u) R0
or, equivalently, as
1
1
ln (S (∞)) − S (∞) =
ln (S0 ) − S0 − I0 .
(1 − u) R0
(1 − u) R0
Note that the final value of S depends on the initial values, but also on the control used.
If we assume that the model is normalized, and the initial value is S0 = 1 and I0 ≈ 0, then
S (∞) −

1
ln (S (∞)) = 1 .
(1 − u) R0

Note that, if u → 1− , then S (∞) → 1− . So, the larger the value of u, the larger the value of S (∞).

S1.3

Reachable set from (S0, I0 )

At each point in the state space, the directions in which the vector field points for diﬀerent values of the
control are given by Fu (x) = f (x) + g (x) (1 − u). The extreme values are given by F0 (x) = f (x) + g (x)
1 If

we select S > S0 the obtained value of I is reached in a past time (t < 0).

3

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Supplementary Figure S2 | Phase Plane with maximal and minimal orbits bounding the reachable set R (x0 ). Max corresponds to
the trajectory ϕ (t, x0, u = 0) while Min to ϕ (t, x0, u = umax ). The figure was generated with R0 = 2, R c = 1.18 and Imax = 0.02.

and Fumax (x) = f (x) + g (x) (1 − umax ),
[

]
0
F0 (x) =
+ βSI
−γI
[
]
0
Fumax (x) =
+ βSI
−γI

[
[

−1
1

]

]
−1
(1 − umax ) .
1

In the phase plane (S, I) both point to the “left”, since the first component (in the direction of S) is always
negative (recall that SI > 0). Since for the second components of the vector fields we have
−γI + βSI > −γI + βSI (1 − umax ) ,
it follows that F0 is “above” Fumax . Therefore,the reachable set R (x0 ) is bounded by the two trajectories
ϕ (t, x0, u = 0) and ϕ (t, x0, umax ), see Fig. S2. These two bounding orbits can be easily calculated using
Eq. (S1).

S1.4

Comparing the cost of two diﬀerent trajectories

In order to be able to find the orbit (trajectory) solving the optimal control problem, it is necessary to be
able to compare the cost of two diﬀerent
trajectories
that start at the same initial point and end at the same
(
)
final point. Consider two orbits ωi x0, x f , ui , i = 1, 2, joining the (same) points x0 and x f using two
diﬀerent control actions, u1 and u2 , respectively. The cost (i.e. time) going through ωi is
∫
J (ui ) =

Ti

dt
0

along the trajectory. Given two such orbits, we want to compare both costs. This can be done, for example,
by subtracting them, i.e., if
J (u1 ) − J (u2 ) < 0
then the cost of ω1 is lower than that of ω2 .
The cost J (ui ) can be calculated as a line integral along the trajectory. We can see this in the following
4

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

manner. Calculate
∆ ( f (x) , g (x)) = − det [ f (x) , g (x)]
= − ( f1 (x) g2 (x) − f2 (x) g1 (x)) .
Now, by properties of the determinant this is also the same as
Û g (x)]
∆ ( f (x) + g (x) ui, g (x)) = − det [ x,
= xÛ2 g1 (x) − xÛ1 g2 (x) .
Therefore,
∫

∫

Ti
xÛ2 g1 (x) − xÛ1 g2 (x)
dt =
dt
∆ (x)
0
0
)
∫ xf (
g1 (x)
g2 (x)
=
dx2 −
dx1 ,
∆ (x)
∆ (x)
x0

J (ui ) =

Ti

which is a line integral along the orbit ωi . Since the two paths have the same initial and final points, they
form a closed curve, and calculating the line integral along the closed curve followed in the counterclockwise direction we obtain the diﬀerence of the costs, i.e.
)
∳ (
g2 (x)
g1 (x)
J (u1 ) − J (u2 ) =
dx2 −
dx1
∆ (x)
Γ ∆ (x)
where Γ is the closed path of the two orbits followed in the counterclockwise direction. For this we have
to assume that: (1) the two paths (orbits) do not intersect at any points except the initial and final ones,
and (ii) that ∆ , 0.
Using Green’s theorem, the line integral can be calculated using a surface integral:
)
∳
∫ ∫ (
∫ ∫
∂u
∂v
(x, y) −
(x, y) dxdy =
w (x, y) dxdy ,
(u(x, y)dy + v(x, y)dx) =
∂y
R ∂x
R
Γ
where R is the region enclosed by the closed curve Γ. For our problem this becomes
∫ ∫
J (u1 ) − J (u2 ) =
w (x1, x2 ) dx1 dx2
R
)
)
(
(
∂ g1 (x)
∂ g2 (x)
w (x1, x2 ) =
+
.
∂ x1 ∆ (x)
∂ x2 ∆ (x)
In our case,
∆ (x) = − ( f1 (x) g2 (x) − f2 (x) g1 (x))
= γ βSI 2
(
)
(
)
∂
βSI
∂ −βSI
w (x1, x2 ) =
+
∂S γ βSI 2
∂I γ βSI 2
( )
∂ 1
1
=
= − 2 < 0.
∂I γI
γI
We see that w < 0 everywhere, and therefore the integral is always negative, implying that the “upper” orbit has a lower cost than the “lower” orbit (in the closed path traversed in the counterclockwise direction).
This observation allows us to find the optimal orbit by comparing it with others.
5

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

S1.5

Optimal orbits

From the previous results, the “upper” trajectory is the one with no control (u = 0) and, in terms of the
cost alone, this trajectory is better than any other one joining the same two points. However, such control
may be inadmissible, since the corresponding I can go over Imax at some periods of time.
The computation of the optimal control can be approached in two ways:
• Fix the initial condition x0 , find its optimal orbit and then its associated optimal control.
• Study the optimal control problem for all possible initial conditions.
Although the second approach is obviously better, it is more diﬃcult, so we will start with the first approach. In fact, both approaches should lead to the same conclusions.
Now we can divide the study of the optimal orbit in several cases.
S1.5.1

Unfeasible trajectories

This is the case if I0 > Imax .
S1.5.2

Trivial trajectories

This is the case in which I0 ≤ Φ R0 (S0 ). That is, the case in which we start in the target set.
S1.5.3

Bang-bang trajectories

If x0 < T, it is necessary to apply some control to maintain I below the maximal value Imax . Moreover,
admissible trajectories necessarily cross the boundary of T at S ≥ 1/R0 , that is, they enter T at
{
}
∂T1 = (S, I) | I = Φ R0 (S) , S ≥ 1/R0 .
In order to find the optimal control that steers an initial state x0 to x f ∈ ∂T1 , consider the change of
coordinates
1
ln(S) + S
R0
1
ν(S, I) = I −
ln(S) + S
Rc

µ(S, I) = I −

with inverse

)
1 − umax
S(µ, ν) = exp
R0 (µ − ν)
umax
(
)
1 − umax
1 − umax
1
I(µ, ν) =
µ−
ν − exp
R0 (µ − ν) .
umax
umax
umax
(

(S2a)
(S2b)

Note that, given I = 0, we can uniquely map µ to S ≥ 1/R0 , which we will denote by S = Ŝµ (µ). Likewise,
we can uniquely map ν to S ≥ 1/Rc , and we will denote it by S = Ŝν (ν).
In the new coordinates, the dynamic equations are
µÛ = −uI(µ, ν)
umax − u
νÛ =
I(µ, ν)
1 − umax
Note that µ = const is an orbit when u = 0 and ν = const is an orbit when u = umax .
6

(S3a)
(S3b)

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Supplementary Figure S3 | An optimal bang-bang trajectory that initiates at x0 with u = 0 (red). When the state touches the curve S
(green), the control is set to u = umax until the state reaches x f ∈ ∂T1 . The region containing all bang and bang-bang trajectories is
depicted in yellow. The figure was generated with R0 = 2, R c = 1.18 and Imax = 0.02.

In (µ, ν)-coordinates, the entry point at T is the segment
{ }
∂T1 = µ f × [νmin, νmax ]
with
νmin

)
1 (
= − ln Ŝµ (µ f ) + Ŝµ (µ f ) ,
Rc

and
µ f = Imax +

νmax = Imax +

ln(R0 )
1
+
Rc
R0

ln(R0 ) + 1
R0

(see Fig. S3).
It follows from Sec. S1.4 that the fastest orbit joining an initial state (µ0, ν0 ) ∈ C(∂T1 ) and a final
state (µ f , ν f ) ∈ ∂T1 is the concatenation of a first piece connecting (ν0, µ0 ) and (ν f , µ0 ) with u = 0 and a
second piece connecting (ν f , µ0 ) and (ν f , µ f ) with u = umax . That is, the control is bang-bang. It is easy
to verify that this control yields the fastest trajectory, as any other trajectory joining (µ0, ν0 ) and (µ f , ν f )
is below this one. The transition times can be computed using (S3) as
∫ νf
dν
(
)
T0 (ν f , µ0 ; ν0, µ0 ) =
1−umax
umax
1
ν0
µ
−
ν
−
exp
R
(µ
−
ν)
0 0
1−umax 0
1−umax
umax
∫

and
Tc (ν f , µ f ; ν f , µ0 ) =

µf

µ0

dµ
−µ + (1 − umax )ν f + umax exp

(

1−umax
umax R0 (µ −

νf )

),

so that the total time is T(ν f , µ f ; ν0, µ0 ) = T0 (ν f , µ0 ; ν0, µ0 ) + Tc (ν f , µ f ; ν f , µ0 ).
Note that µ f is fixed, but ν f ∈ [νmin, νmax ] is free. We will now find the closest entry point by
minimizing T over ν f . Set
)
1 (
µmax = − ln Ŝν (νmin ) + Ŝν (νmin ) ,
R0
7

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Supplementary Figure S4 | The minimal time φµ (ν f ) it takes an initial state (νmin, µ0 ) to reach the target point (ν f , µ f ). The curves
were generated with R0 = 2 and R c = 1.18. Note that the global minimum is well defined (it is unique).

fix µ0 ∈ [µ f , µmax ] and define the map
φ µ0 : [νmin, νmax ] → R
ν f 7→ T(ν f , µ f ; νmin, µ0 ) .
Assumption 1. Global minima of φ µ0 are unique.
By Weierstrass Theorem, global minima of φ µ0 always exist. The assumption excludes the highly
degenerate case in which the global minimum could occur for more than one value of ν f . Figure S4
shows plots of φ µ0 for various values of µ0 using the parameters R0 = 2 and Rc = 1.18. Note that the
global minimum is unique (indeed, for large values of µ0 , φ µ0 is convex). We now define the function
ν ∗ : [µ f , µmax ] → [νmin, νmax ]
µ0 7→ arg min φ µ0 (ν f ) .
νf

This function defines a switching curve parameterized by µ0 . In the original coordinates (S2), the switching curve takes the form
{
}
S = (S, I) | S = S(ν ∗ (µ0 ), µ0 ), I = I(ν ∗ (µ0 ), µ0 ), µ0 ∈ [µ f , µmax ] .
¯ → [0, 1], defined implicitly by
Let I¯ = max(S,I)∈S . To simplify the exposition, we introduce Ψ : [0, I]
(Ψ(I), I) ∈ S .
We will parameterize S using I,
{
}
¯ .
S = (S, I) | S = Ψ(I), I ∈ [0, I]
The trajectories that reach S above Imax are of course unfeasible, so the class of optimal bang-bang
trajectories are only those that pass through S∩XF (see the yellow region in Fig. S3). For future reference,
we will denote by S ∗ the S coordinate at which S intersects the line I = Imax and by x1 the point (S ∗, Imax ).
Summarizing, there are two possible situations:
8

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

1. Bang. If x0 belongs to the region delimited by ∂T1 , I = Imax and S, then the optimal control
strategy is simply
{
umax from t = 0 until x ∈ ∂T1
u=
.
0
when x ∈ T
2. Bang-Bang . When x0 belongs to the region delimited by S, I = Imax and the orbit ϕ(−t, x1, umax ),
then the optimal control strategy is




0
u = umax


0

S1.5.4

from t = 0 until x ∈ S
.
until x ∈ ∂T1
when x ∈ T

Trajectories containing a singular arc

Let us define an initial point x0 = (S0, I0 ) and the point x1 = (S ∗, Imax ). We are interested in four
trajectories (or orbits):
1. ϕ (t, x0, u = 0), the trajectory without control starting at x0 . It will be useful to calculate the value
S = S̄ at which the orbit (first) touches Imax . For this we solve (use (S1))
( )
S
1
ln
− (S − S0 )
Imax = I0 +
R0
S0
for S and obtain two solutions: S1, S2 . Define S̄ = max {S1, S2 } as the largest.
Now we calculate the values of S ≤ Sc for which it is possible to achieve IÛ ≤ 0 (that is, that it is
possible to stop the growth of I). This value can be calculated from
IÛ = (1 − umax ) βSI − γI ≤ 0
and gives

}
1
,1 .
Sc = min
(1 − umax ) R0
{

We “saturate” the value of Sc because Sc > 1 is not empidemiologically relevant. The control
required to achieve the condition I = Imax is the “singular” control
using = 1 −

1
.
R0 S

Note that, if S > Sc at I = Imax , it is no longer possible to keep I at Imax because IÛ > 0.
If S̄ ≥ Sc , then the optimal control is bang-singular arc-bang,


0




 using
u=

umax



0


from t = 0 until I = Imax
until S = S ∗
.
until x ∈ ∂T1
when x ∈ T

(S4)

This case is depicted in Fig. S5 for the parameters R0 = 2, Rc = 1.18 and Imax = 0.02.
If Sc = 1, then Sc ≥ S̄ holds trivially and the optimal strategy is again (S4).
2. ϕ (t, x0, umax ), the trajectory with maximal control starting at x0 .
9

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Supplementary Figure S5 | An optimal trajectory that initiates at x0 with u = 0 (red) and such that S̄ ≤ Sc . When the state touches
the curve I = Imax , the control is set to u = using until the state reaches x1 . The control is finally switched to u = umax until the state
reaches the target set. The region containing all bang-singular arc-bang trajectories is depicted in yellow. The figure was generated
with R0 = 2, R c = 1.18 and Imax = 0.02 .

3. ϕ (−t, x1, u = 0), the trajectory without control that passes through x1 . If x0 is at the left of this
trajectory, the optimal orbit is bang-bang, as shown in the previous section. Optimal trajectories
starting at the right have singular arcs.

4. ϕ (−t, x1, u∗ ), the trajectory with control
{
}
u∗ = min using, umax
that passes through x1 .
The control u∗ is such that this trajectory does not violate the restriction I ≤ Imax . For values of
S ≥ Sc , it is equal to umax , and for S ≤ Sc it is the control for the singular arc, i.e., it maintains
I = Imax until x f is reached.
When S̄ > Sc then it is necessary to start with the control strategy before reaching the maximal
value of I = Imax . Otherwise, this limit will be surpassed. However, this is only feasible if, moving
backwards from the point (Sc, Imax ) with the maximal control umax it is possible to reach a point
(S0, Ic ) such that Ic ≥ I0 . The value of Ic can be calculated from (S1),
( )
1
Sc
Ic = (Sc − S0 ) + Imax −
ln
.
S0
(1 − umax ) R0
If Ic = I0 , the optimal control is

u=

10



umax




 using

umax



0


from t = 0 until I = Imax
until S = S ∗
.
until x ∈ ∂T1
when x ∈ T

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

When Ic > I0 , the control is bang-bang-singular arc-bang,

0



u



 max
u = using


 umax



0


from t = 0 until S = Ss
from S = Ss until I = Imax
,
until S = S ∗
until x ∈ ∂T1
when x ∈ T

where (Ss, Is ) is a switching point. It is characterized as follows: the trajectory ϕ (t, x0, u = 0)
intersects the trajectory ϕ (−t, x1, umax ) at (Ss .Is ). Such point can be calculated from (S1) as
( )
1
Ss
ln
− (Ss − S0 )
Is − I0 =
R0
S0
( )
1
Sc
ln
Imax − Is =
− (Sc − Ss ) .
Ss
(1 − umax ) R0
By substituting the first into the second we get
( )
1
Ss
Is = I0 +
ln
− (Ss − S0 )
R0
S0
( )
( )
1
1
Ss
Sc
ln
− (Ss − S0 ) +
ln
− (Sc − Ss ) .
Imax = I0 +
R0
S0
Ss
(1 − umax ) R0
Solving for Ss in the second we arrive at
( )
1
Ss
ln
Is = I0 +
− (Ss − S0 )
R0
S0
{
(
)}
1
1
(1 − umax ) 1
−Imax + I0 + S0 − Sc −
ln (S0 ) −
ln (Sc ) .
ln (Ss ) =
umax R0
R0
(1 − umax )
This case is depicted in Fig. S6 again for the parameters R0 = 2, Rc = 1.18 and Imax = 0.02.
If Ic < I0 , then it is not possible to solve the optimal problem, since any strategy will surpass the
maximal value Imax . This is the case if, e.g., umax is reduced and Rc increases to 1.27 (see Fig. S7).

S1.6

A feedback control strategy

The previous “open loop” strategy can be implemented as a state feedback control. This strategy is rather
simple, since there are basically only two switching curves: ϕ (−t, x1, u∗ ) and S. Another switch takes
place when the target region has been attained and the control is switched oﬀ, but this happens in a
“natural” manner.
The switching curve ϕ (−t, x1, u∗ ) can be written as
I = Φ Rc (S) ,

S ≥ S∗ .

We can further define the “waiting” set
{
}
W = (S, I) | I < Φ Rc (S), S > Ψ(I) .
11

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Supplementary Figure S6 | An optimal trajectory that initiates at x0 with u = 0 (red) and such that S̄ > Sc . When the state arrives at
(Ss , Is ), the control is set to u = umax . When the state touches the curve I = Imax , the control is set to u = using until the state reaches x1 .
The control is finally switched to u = umax until the state reaches the target set. The region containing all bang-bang-singular arc-bang
trajectories is depicted in yellow. The figure was generated with R0 = 2, R c = 1.18 and Imax = 0.02.

Supplementary Figure S7 | For the initial condition x0 the problem is unfeasible, Imax will be surpassed, no matter which strategy is
used. The figure was generated with R0 = 2, R c = 1.27 and Imax = 0.02.

12

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Supplementary Figure S8 | The optimal feedback strategy (S5). The target and waiting sets, T and W, are illustrated for R0 = 2,
R c = 1.18 and Imax = 0.02.

The optimal control feedback is thus given by


0



∗
u (S, I) = using = 1 −


 umax


1
R0 S

(S, I) ∈ T ∪ W
if I = Φ Rc (S) and S ∗ < S < Rc−1 .
otherwise

(S5)

Such strategy is summarized in Fig. S8.
Alternatively, we can implement a pure switching control since the “equivalent control”[2] will realize
the singular control on the singular arc,
{
0
(S, I) ∈ T ∪ W
u∗ (S, I) =
.
umax otherwise
Note that this control strategy extends the control action beyond the region where the optimal control is
feasible.

13

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

S2.

Necessary and suﬃcient conditions for the existence of optimal
NPIs

Let (S0, I0 ) denote the initial state of the SI model. As shown in Supplementary Note S1, the necessary
and suﬃcient condition for the existence of NPIs is that I0 ≤ Φ Rc (S0 ) where Φ Rc (S) is the separating
curve. To characterize a condition that is independent of the initial state, we consider the limit case of
S0 = 1 and I0 = 0. Under this assumption, the necessary and suﬃcient condition of existence is that
Φ Rc (1) ≥ 0. In other words, the boundary of existence of NPIs is when the separating curve exactly
crosses I = 0 at S = 1. Substituting S = 1 in the separating curve we obtain the condition
(
)
1
1
ln Rc − 1 −
≥ 0,
Rc ≤ 1, or Imax +
Rc
Rc
which is precisely the inequality (1) of the Main Text..

14

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

S3.

Robustness of the optimal intervention

Here we describe the models used to evaluate the robustness of the optimal intervention.

S3.1

Robustness to the presence of demography and an incubation period.

To evaluate the robustness of the optimal intervention to the presence of an incubation period of the
disease, we considered the SEIR dynamics
SÛ = −(1 − u)β SI + µ − µS,
EÛ = (1 − u)β SI − λE,
IÛ = λE − γI,

(S6)

RÛ = γI.

Above, E(t) denotes the fraction of individuals in the population exposed to the disease, but which are not
yet infectious, at time t. The parameter 1/λ ≥ 0 denotes the incubation period of the disease in units of
days. The parameter µ ≥ 0 denotes the recruitment rate in units of days−1 . For the result of our paper, we
choose µ = 1/(365 · 75) corresponding to a life expectancy of 75 years. For this model, the intervention
we apply is u(t) = u∗ (S(t), I(t)) with u∗ (S, I) as in Eq. (S5).

S3.2

Robustness to the presence of hidden infected individuals.

To evaluate the robustness of the optimal intervention to hidden infected individuals, consider that that
infections can be symptomatic or asymptomatic. We assume that all asymptomatic infections do not
require hospital care, and hence remain undetected by the epidemic surveillance system. To model this
scenario, we consider the dynamics
SÛ = −(1 − u)β S(Ia + Is ) + µ − µS,
EÛ = (1 − u)β SI − λE,
IÛs = p λE − γIs,

(S7)

IÛa = (1 − p) λE − γIa,
RÛ = γ(Is + Ia ).

Above, Is denotes the fraction of symptomatic infections and Ia the fraction of asymptomatic ones. The
model assumes that a fraction p ∈ [0, 1] of exposed individuals result in symptomatic infections, and the
rest (1− p) in asymptomatic ones. We assume that infectious period 1/γ is the same for both symptomatic
and asymptomatic individuals. For the results of our paper, we choose λ = 1/7. Since we assume that
only symptomatic individuals end up requiring hospital care, we consider that the objective is to keep
Is (t) ≤ Imax only. The control applied is u(t) = u∗ (S(t), Is (t)) where u∗ (S, I) is given by Eq. (S5).

15

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

S4.

Application to the COVID-19 pandemic

S4.1

Estimate for the fraction of infected individuals requiring intensive care.

For COVID-19 pandemic by the SARS-CoV-2 virus, we estimated the fraction f of infected individuals
requiring intensive-care under the following assumptions:
1. Current estimates for the fraction p ∈ [0, 1] of infected individuals that are symptomatic show a
large variability [3], ranging from a 20/100 in a report of the World Health Organization, to 96/100
in a study of 328 adults in Shanghai[4]. We take the nominal value of p0 = 60/100.
2. Following Kremer et al.[5], we assume that from the individuals that are symptomatic, a fraction
15/100 develop severe symptoms.
3. Finally, following Li et al. [6], from the individuals that develops severe symptoms, we assume that
the fraction 28/100 will require intensive care.
Under the above assumptions, the fraction of infected individuals requiring intensive care has a nominal
value
63
60 15 28
=
= 0.0252.
f =
100 100 100 2500

S4.2

Data used in our analysis.

Supplementary Fig. S9 shows the data used for our analysis. Data was collected using the following
methodology:
1. Number of intensive care beds in each city. This was obtained from oﬃcial statements when
possible (e.g., the Massachusetts Department of Public Health for Boston). In other cases, this
number was obtained from public statements of authorities of each city. A complete list of the
references appears in the Supplementary Fig. S9.
2. Population in each city. Data was obtained from Wikipedia.
3. Reduction of mobility in each city. This was obtained from Google Community Mobility Reports https://www.google.com/covid19/mobility/. For our analysis, we considered three
categories of mobility: retail & recreation, transit stations, and workplaces. To estimate an overall
mobility reduction, we averaged the mobility reduction in these three categories from March 19 to
April 30. Data was accessed on May 7, 2020.
4. Basic reproduction number. We estimated this quantity from the value of the eﬀective timevarying reproduction number Rt at the start of the pandemic around March 8, 2020. These estimates
were obtained from the website https://epiforecasts.io/covid/.

16

2350

3673

1600

1973

1330

2267

848

1750

517

2398

556

2200

1101

874

153

1555

New York

Boston

Dehli (India)

Lombardy (Italy)

Berlin

Tokyo

Madrid

Lima

British Columbia
(Canada)

Athens

Buenos Aires

Vienna

New South Wales
(Australia)

Dublin

Bogota

Number of
UCI beds

Mexico City

City

7.413

1.3

7.544

1.89

2.89

0.664

5.071

8.575

6.642

9.273

3.769

10.06

21.75

0.694

8.399

8.855

1.6

1.7

1.7

1.8

1.6

1.4

1.8

1.7

2.86

1.1

1.8

1.8

1.4

2

2

1.7

2.6

2.7

2.5

2.6

2.8

2.3

2.7

2.8

3.37

2.2

2.5

2.4

2.5

3

3

2.4

16/03/2020

12/03/2020

22/03/2020

16/03/2020

16/03/2020

05/03/2020

16/03/2020

12/03/2020

09/03/2020

02/03/2020

26/02/2020

23/02/2020

04/03/2020

05/03/2020

05/03/2020

23/03/2020

24/02/2020

12/03/2020

24/03/2020

12/03/2020

19/03/2020

12/03/2020

18/03/2020

16/03/2020

09/03/2020

25/02/2020

22/02/2020

22/02/2020

16/03/2020

19/03/2020

19/03/2020

26/03/2020

07/03/2020

01/03/2020

25/01/2020

26/02/2020

04/03/2020

27/02/2020

26/01/2020

07/03/2020

01/02/2020

15/01/2020

28/01/2020

31/01/2020

30/01/2020

21/01/2020

21/01/2020

29/02/2020

Date of first
confirmed case

COVID-19 (by City)
Date of start
workplace
closing

0.75

0.8

0.43

0.7

0.82

0.65

0.43

0.75

0.86

0.54

0.7

0.71

0.89

0.64

0.58

0.61

Average mobility
reduction (rA)

0.73

0.76

0.62

0.7

0.7

0.7

0.56

0.8

0.79

0.57

0.5

0.71

0.82

0.81

0.69

0.62

Average mobility
reduction (transit
stations)

1

References

0.7 April 14, https://www.eltiempo.com/colombia/otras-ciudades/
camas-en-colombia-para-atender-a-paciente-concoronavirus-484048

0.73 May 3, https://www.rte.ie/news/2020/0503/1136299coronavirus-ireland/

0.4 March 19, https://theconversation.com/how-well-avoidaustralias-hospitals-being-crippled-by-coronavirus-133920
https://www.health.nsw.gov.au/Infectious/covid-19/
communities-of-practice/documents/covid-19-adult-intensivecare-pandemic-response-planning.pdf

0.7 May 7, Austrian Ministry of Health https://
info.gesundheitsministerium.at/dashboard_Hosp.html?l=en

0.66 March 26 https://www.lanacion.com.ar/sociedad/coronavirusestan-preparadas-terapias-intensivas-del-pais-nid2347722

0.5 April 8, https://publichealth.uga.edu/athens-covid-19hospitalizations-new-report/ Mobility data of Decentralized
Administration of Thessaly and Central Greece

0.52 March 20 https://www.cbc.ca/news/canada/british-columbia/
bc-hospital-beds-covid-19-1.5505356

0.54 April 29 https://www.gob.pe/institucion/minsa/noticias/142142peru-implemento-822-camas-uci-para-la-atencion-depacientes-covid-19

0.73 April 3 https://as.com/diarioas/2020/04/03/actualidad/
1585905064_448015.html

0.5 April 26 https://www.japantimes.co.jp/news/2020/04/26/
national/science-health/japan-icu-bed-shortage-mostprefectures-coronavirus-peak/#.XrMwYC2ZOCM

0.5 April 2, https://berlinspectator.com/2020/04/02/corona-crisisin-germany-intensive-care-capacities-increased-substantially/
https://www.tagesspiegel.de/berlin/mueller-zu-besuch- in-dercharite-wie-sich-berlins-groesstes-krankenhaus- auf-dencorona-ernstfall-vorbereitet/25714372.html

0.57 March 13, Critical Care Utilization for the COVID-19 Outbreak in
Lombardy, Italy. https://jamanetwork.com/journals/jama/
fullarticle/2763188 https://ec.europa.eu/jrc/en/news/
forecasting-covid-19-impact-icu-bed-demand-lombardy

0.81 April 20. Princeton Center For Disease Dynamics, Economics &
Policy https://cddep.org/wp-content/uploads/2020/04/Statewise-estimates-of-current-beds-and-ventilators_20Apr2020.pdf

0.6 Massachusetts Department of Public Health COVID-19
Dashboard - Tuesday, May 05, 2020
https://www.mass.gov/doc/covid-19-dashboard-may-5-2020/
download Mobility reduction in Suﬀolk County

0.58 As in April 27 https://projects.thecity.nyc/2020_03_covid-19tracker/

0.49 Declaration of City Mayor to El Universal (April 25) https://
www.eluniversal.com.mx/metropoli/cdmx/anuncia-cdmx-500camas-mas-para-cuidados-intensivos

Average mobility
reduction
(workplaces)

Supplementary Figure S9 | Table with the response of 16 cities during the COVID-19 pandemic.

2

2.3

2

2.2

2.1

1.75

2.2

2.2

3.11

1.3

2.2

2.2

1.9

2.4

2.4

1.9

Total population
R0
R0min
R0max
Date of start
(in millions)
(unmitigated) (unmitigated) (unmitigated) school closing

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

17

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

S5.

Related work

For the control of infectious diseases, there is a large body of work using optimal control methods to design
interventions, including vaccination and quarantines[7, 8], drug treatments[9], or dispersal of insecticides
and education campaigns[10]. The standard tool to solve these optimal control problem is the celebrated
Pontryagin’s Maximum Principle[11]. However, note that the Maximum Principle only gives necessary
conditions for optimality. The gap between the necessary and suﬃcient conditions for optimality needs to
be closed using additional arguments, often relying on assuming that the control appears multiplying an
aﬃne function of the state variables. This assumption is not satisfied in our formulation of optimal NPIs.
We emphasize that the optimal interventions obtained from this approach result in open loop strategies
which only depend on time. By contrast, our analysis gives a feedback optimal strategy that characterizes
the optimal action to make according to the actual state of the epidemic. Indeed, our characterization of
optimal NPIs does not rely on the Maximum Principle. Instead, the low dimensional of our model allows
us to apply Green’s Theorem to compare the cost of two diﬀerent interventions. The consequence of our
approach is that we obtain a feedback or closed loop strategy that corrects itself based on the actual state
of the epidemic.
The COVID-19 pandemic has stirred much interest on designing non-pharmaceutical interventions.
This has led to strategies like interspacing mitigation with brief periods of activity[12]. Optimal control
methods have been also applied, for example to minimize the peak of infection[13], minimize the number
of infections[14], minimize the economic costs[15], or maximize welfare[16]. Compared to these studies,
our analytical characterization of optimal NPIs provides gives us a complete understanding of the optimal
decisions that need to be made. For example, no intervention is needed before reaching the separating
curve.

18

medRxiv preprint doi: https://doi.org/10.1101/2020.05.19.20107268; this version posted October 5, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in
perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

References
[1] H. R. Thieme. Mathematics in population biology, vol. 12 (Princeton University Press, 2018).
[2] L. Fridman, J. Moreno and R. Iriarte. Sliding modes after the first decade of the 21st century.
Lecture notes in control and information sciences 412, pp. 113–149 (2011).
[3] O. C. for Evidence-Based Medicine. Covid-19: What proportion are asymptomatic? URL
https://www.cebm.net/covid-19/covid-19-what-proportion-are-asymptomatic/.
[4] X. Zhou et al. Follow-up of the asymptomatic patients with sars-cov-2 infection. Clinical Microbiology and Infection .
[5] M. U. Kraemer et al. The eﬀect of human mobility and control measures on the covid-19 epidemic
in china. Science 368 no. 6490, pp. 493–497 (2020).
[6] R. Li et al. Substantial undocumented infection facilitates the rapid dissemination of novel coronavirus (sars-cov2). Science .
[7] H. Behncke. Optimal control of deterministic epidemics. Optimal control applications and methods
21 no. 6, pp. 269–285 (2000).
[8] X. Yan and Y. Zou. Optimal and sub-optimal quarantine and isolation control in sars epidemics.
Mathematical and Computer Modelling 47 no. 1-2, pp. 235–245 (2008).
[9] R. E. Rowthorn, R. Laxminarayan and C. A. Gilligan. Optimal control of epidemics in
metapopulations. Journal of the Royal Society Interface 6 no. 41, pp. 1135–1144 (2009).
[10] M. A. L. Caetano and T. Yoneyama. Optimal and sub-optimal control in dengue epidemics.
Optimal control applications and methods 22 no. 2, pp. 63–73 (2001).
[11] D. Liberzon. Calculus of variations and optimal control theory: a concise introduction (Princeton
University Press, 2011).
[12] O. Karin et al. Adaptive cyclic exit strategies from lockdown to suppress covid-19 and allow
economic activity. medRxiv .
[13] D. H. Morris et al. Optimal, near-optimal, and robust epidemic control. arXiv preprint
arXiv:2004.02209 .
[14] C. Tsay et al. Modeling, state estimation, and optimal control for the us covid-19 outbreak. arXiv
preprint arXiv:2004.06291 .
[15] F. E. Alvarez, D. Argente and F. Lippi. A simple planning problem for covid-19 lockdown. Tech.
rep., National Bureau of Economic Research (2020).
[16] F. Piguillem and L. Shi. Optimal covid-19 quarantine and testing policies .

19

