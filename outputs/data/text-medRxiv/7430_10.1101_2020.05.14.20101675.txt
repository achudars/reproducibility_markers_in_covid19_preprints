medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Simulating SARS-CoV-2 epidemics by
region-specific variables and modeling contact
tracing app containment
Alberto Ferrari1,* , Enrico Santus2 , Davide Cirillo3,4 , Miguel
Ponce-de-Leon3 , Nicola Marino4,5 , Maria Teresa Ferretti4 ,
Antonella Santuccione Chadha4 , Nikolaos Mavridis4,6 , and Alfonso
Valencia3,7
1

FROM Research Foundation, Papa Giovanni XXIII Hospital, Bergamo, Italy.
Bayer, Decision Science & Advanced Analytics for MA, PV & RA Division.
3
Barcelona Supercomputing Center (BSC), C/ Jordi Girona 29, 08034, Barcelona,
Spain.
4
Women’s Brain Project (WBP), Gunterhausen, Switzerland.
5
Università di Foggia, Dipartimento di Scienze Madiche e Chirurgiche.
6
Interactive Robots and Media Laboratory (IRLM), United Arab Emirates.
7
ICREA, Pg. Lluı́s Companys 23, 08010, Barcelona, Spain.
*
corresponding author: aferrari34@yahoo.com
2

14th September 2020
Abstract
Targeted contact-tracing through mobile phone apps has been proposed as an instrument to help contain the spread of COVID-19 and
manage the lifting of nation-wide lockdowns currently in place in USA
and Europe. However, there is an ongoing debate on its potential efficacy,
especially in the light of region-specific demographics.
We built an expanded SIR model of COVID-19 epidemics that accounts for region-specific population densities, and we used it to test the
impact of a contact-tracing app in a number of scenarios. Using demographic and mobility data from Italy and Spain, we used the model to
simulate scenarios that vary in baseline contact rates, population densities and fraction of app users in the population.
Our results show that, in support of efficient isolation of symptomatic
cases, app-mediated contact-tracing can successfully mitigate the epidemic even with a relatively small fraction of users, and even suppress
altogether with a larger fraction of users. However, when regional differences in population density are taken into consideration, the epidemic
can be significantly harder to contain in higher density areas, highlighting
potential limitations of this intervention in specific contexts.

1

NOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice.

medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

This work corroborates previous results in favor of app-mediated contacttracing as mitigation measure for COVID-19, and draws attention on the
importance of region-specific demographic and mobility factors to achieve
maximum efficacy in containment policies.

1

Introduction

Severe Acute Respiratory Syndrome coronavirus 2, or SARS-CoV-2, is a novel
coronavirus strain, discovered in 2019, responsible of a severe respiratory illness
named COVID-19 (Coronavirus Disease 2019) that has been declared a public
health emergency since January 2020. As of August 18th 2020 more than 13
millions people worldwide have developed COVID-19 and more than 773,000
have died from it.
The spread of COVID-19 has raised new challenges for healthcare systems all
over the world, hitting with particular strength Europe and USA, after China.
According to the available data, Italy had among the highest number of contagions and dead toll from COVID-19, with over 200,000 confirmed cases and
more that 30,000 deceased as of May 14th 2020. However, the spread of COVID19 has been quite heterogeneous in speed, reach, and lethality, not only from
country to country, but also in different regions of the same country. The main
possible explanation is given by the delay between the onset of the epidemic,
the first diagnosis and the kick-off of containment measures. Other reasons may
be due to region-specific variables, such as population density and mean age,
societal structure and behaviors. A third factor depends also on the adopted
policies for containment and testing, in particular for what concerns the fraction
of infectious individuals that never display symptoms (asymptomatic).
In fact, it is now known that the course of infection includes an incubation
pre-symptomatic period, during which the patients shows no sign of disease
but are still potentially infectious (likely to a lesser degree), after which some
individuals progress to a symptomatic state, while others remain asymptomatic,
but still potentially infectious[8]. This behavior has important consequence on
how we model COVID-19’s epidemiology and plan countermeasures.
Most countries dealing with the epidemics have resorted to nation-wide lockdowns and social distancing to slow down the outbreak; the strategy has been
effective in slowing down the epidemic, but lock-downs are temporary measures
by nature and simply releasing them without any other parallel containment
strategy could very well lead to a new increase of cases. Dedicated works in
the scientific literature show that this scenario is avoidable as long as extensive
policies of testing and contact tracing are adopted[4, 19].
However, the effectiveness of such measures in controlling the epidemic
strictly depends on efficiency in isolating positive and symptomatic cases, as
well as their contacts. Earlier work on the topic showed that efficient outbreak
control may require tracing and isolation of up to 80% of the contacts, and
with very short delay from onset to isolation[6]. This is hardly feasible on a
large scale using only traditional methods for contact tracing, and managing

2

medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

the epidemics in the long term will likely require the use of information technology to help implement measures of containment and mitigation. In particular,
precise identification of cases and contact tracing and isolation can hardly be
performed with traditional methods, and the use of targeted phone apps could
highly improve the efficiency of these processes, as shown by the experience of
multiple Asian countries - such as South Korea.
Different infrastructures and working interfaces for such an instrument have
already been proposed[1], and its potential impact on the virus’s reproductive
rate has also been studied[3, 15, 14]. Tracing apps could play a key role in
ensuring that the epidemic remains sustainable on the healthcare systems, not
exceeding their capabilities, which would otherwise lead to excess mortality.

Figure 1: Density and mobility influence contact tracing app effectiveness. Compared to low density regions (left), epidemics may be significantly harder to contain through contact tracing apps in areas with very high population density
(right).
South Korea pioneered in this approach, both by suggesting to the public
the use of applications able to notify contacts with infected subjects, and by
mandatory installation, for travellers, of an app implemented by the Ministry of
Health and Welfare to monitor COVID-19 symptoms and quarantine for 14 days.
Another app, by the Ministry of Interior and Safety, was aimed at monitoring
trajectories and contacts of infected subjects and to apply self-surveillance and
self-quarantine[11].
Despite concerns over potential privacy violations, the south korean approach managed to achieve efficient control of the epidemics in its earliest phases,
and represents a good example of how such an approach could work.
Notable efforts have been done by epidemiologist to model epidemic trends
for COVID-19 and the effect of containment measures.
3

medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

In this proof-of-concept study we built a comprehensive framework to model
the COVID-19 epidemic, taking into account population density, the different
contributions of symptomatic, pre-symptomatic and asymptomatic contagions,
and using it to test the efficacy of targeted interventions such as the aforementioned contact tracing app. In contrast to previous work [15, 14] aimed at
modeling the two-way dynamic between individual behaviors and containment
policies, we chose to build a global compartmental modeling framework that
can account for region-specific factors, such as the effect of population density
on contact rate or the role of expected compliance to containment procedures.
Our research builds a model that allows testing the effect of both case isolation and app-mediated interventions in a region-specific fashion.

2

Materials and Methods

We built an improved Susceptible-Infectious-Recovered (SIR) model[7] with the
aims of a) faithfully reproducing the dynamics of the SARS-CoV-2 epidemics,
including the respective roles of asymptomatic infection and population density;
b) testing the effects of distinct interventions, and specifically the use of phone
apps for contact tracing. As Italy was the first western country affected by the
SARS-CoV-2 and for which region-specific and intervention-related data was
readily available, our analysis is focused on the Italian case. This has allowed
us to study how the virus spreads at a very different pace in different Italian
districts.
The typical SIR model assumes that some degree of immunity, at least
temporary, is acquired after SARS-CoV-2 infection; therefore, it is assumed that
subjects move from the S (Susceptible) compartment to the I (Infectious)
compartment, and from there, with a daily rate equal to the invers of recovery
time, to the R (Recovered) compartment, until the relative densities of S and
I become too low for the epidemic to continue. In order to simulate the behavior
of asymptomatic and pre-symptomatic individuals, an A (Asymptomatic) and
P (Pre-symptomatic) compartment were added to the model.
To simulate the effect of targeted quarantine measures, we introduced a series
of Q∗ compartments indicating the number of subjects that are quarantined and
their status regarding the disease. To model the reversible transition from the
different compartment into the state specific quarantine compartments, there
are four different Q compartments: QS, QI, QA and QP . Whenever they are
infected, individuals are supposed to move from the S compartment to the A
or P compartments, with respective probabilities pa and pi = 1 − pa . Subjects
in the P compartments then transfer to the I compartment with a daily rate
of 1/τi , where τi is the incubation period. We also assume that asymptomatic
and pre-symptomatic patients are less infectious than symptomatic individuals
by a factor f .
However, there is evidence that pre-sympromatic individuals are highly infectious already about τd = 2 days before symptom onset [5], and the focus
of our model is transmission dynamics, rather than symptoms manifestations.

4

medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Figure 2: Model outline. Graphical representation of the interactions among the
different compartments of the extended SIR model. S, susceptible; I, infected; R,
recovered; A, asymptomatic; P, pre-symptomatic; QS, quarantined susceptible;
QI, quarantined infected; QA, quarantined asymptomatic; QP, quarantined presymptomatic. Rates of transfer between compartments are a function of the
parameters annotated on the arrows. A detailed description of such parameters
is provided in ”Materials and Methods” and Table 1.
Under this profile, a P subject is already akin to a I subject τd days before
symptom onset. Therefore, we let P subjects move into I compartment after an
incubation period that is τd = 2 days shorter, while at the same time increasing
the recovery period by the same amount.
Our model assumes the use of a phone app that keeps track of contacts and,
once a symptomatic case is identified, notifies the event to everyone who had
contacts with them in the pre-symptomatic period, so that they can enter a
voluntary quarantine (Figure 1). Such an application is heavily reliant, on one
hand, on effectiveness of case isolation on the part of the authorities, and on the
other hand on compliance and widespread use of the system by the population.
Thus, we assume, for our model, that a J fraction of symptomatic cases is
identified and undergoes perfect quarantine with zero contacts. We call j the
fraction of the population using the app and we assume that once in quarantine,
they reduce the contact rate by a factor q. Therefore, j 2 is the fraction of
contacts that happen between individuals using the app. Quarantined subjects
that develop the infection undergo the entire course of the disease, whereas
those that were not infected in the contact eventually exit quarantine after the

5

medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Parameter Description
Probability of transmission in a
µ
single contact
Probability of infection being
pa
asymptomatic
Relative infectiousness of a- and
f
pre-symptomatic compared to
symptomatic
q
Contact reduction in quarantine
Time from symptom onset to reτh
covery (days)
τi
Incubation period (days)
τq

Quarantine duration (days)

C

Daily contact rate

R

Maximum distance to qualify a
“contact” (meters)

Value

Source

0.10

[2]

0.40

[3, 10]

0.10

[3]

0.10

[18]

10

[12]

5.1

[9]

15

[17]

14.8

[22]

1

[23]

Table 1: Model parameter values and sources
quarantine period τq (15 days) and become Susceptible again. In the classic
SIR model, the rate of transfer between the S and I compartments depends on
transmission rate β, that is, the product of number of contacts per subject, C,
and probability of transmission during a single contact µ [13].
To estimate contact rate as a function of population density we built on previous results by Rhodes and Anderson [21] who derived a formula for estimation
of daily contact rate of a subject in a population with density ρ moving with
velocity v̄ as
C=

8Rv̄ρ
π

(1)

Where R is the minimum distance within which two individuals can be said to
have a “contact”; for COVID-19, and other air-borne diseases transmitted by
droplets expelled from nose or mouth, it is commonly estimated as 1m [24].
In our model we assume that Susceptible subjects move to the P compartment with a rate proportional to the probability of meeting an A, I or P
subject, assuming that at least one of the two does not use the tracing app
and/or the case is not successfully identified. This is modeled by making the
rate dependent on 1 − Jj 2 . The remaining Jj 2 fraction of the contacts between
S and I individuals leads to a transfer from S to one of the three QP , QA and
QS compartments, each with probability equal to pi , pa or 1 − pi − pa , i.e. the
probability of the contact leading to symptomatic infection, asymptomatic infection or no infection. Individuals in the QP compartment eventually transfer
to the QI compartment after incubation, whereas QA and QS transfer to R
and to S respectively, with rates equal to 1/τi and 1/τq .
6

medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

The structure of the model is shown in Figure 2 and it is described by the
following set of differential equations. By defining α = Jj 2 as the proportion of
contacts that are successfully contained, we have:
dS
(1 − α) (f P + I) + f q (QP + QA)
fA
= −µCS
µ − CS
dt
N
N
I
QS
1
− αCS +
τd
N
τq
dI
P
I
JI
=
−
−
dt
τi
τh
τd
dP
(1 − α) (f P + I) + f A + f q (QP + QA)
1
I
P
= pi µCS
− αCP
−
dt
N
τd
N
τi
dA
(1 − α) (f P + I) + f A + f q (QP + QA)
1
A
I
= pa µCS
− αCA −
dt
N
τd
N
τh
I
A
QI
QA
dR
=
+
+
+
dt
τh
τh
τh
τh

dQS
1
QS
I
= αC (1 − pi − pa ) S −
dt
τd
N
τq
dQP
1
I
QP
= αC (pi S + P )
−
dt
τd
N
τi
dQA
1
QA
I
=
−
αC (pa S + A)
dt
τd
N
τh
JI
QP
QI
dQI
=
+
−
dt
τd
τi
τq

(2)

(3)
(4)
(5)
(6)

(7)
(8)
(9)
(10)

The model is governed by a set of ordinary differential equations (2-10) that
depend on different parameters. Model parameters are based on values found
in different bibliographic references (see Table 1).
For COVID-19 attack rate µ we adopted data from the epidemic in Shenzen,
where secondary attack rate was estimated between 0.10 and 0.15 [2]. According to Ferretti et al. the most likely estimates for f and pa are 0.1 and 0.4.
The 0.4 estimate for the asymptomatic fraction is corroborated by a recent
epidemiological study on COVID-19 prevalence in Veneto [10].
In the simulations, we included some basic vital dynamics by adding a D
(Deceased) compartment (not shown), for which we assumed an overall mortality of 1% in symptomatics. Mortality estimates for COVID-19 are actually
still quite uncertain, but Infectious removal by mortality is not expected to
significantly affect epidemic trends.
The parameter estimates have a degree of uncertainty and, most importantly,
the body of evidence supporting them is continuously growing. Incubation
time τi , for example has been recently suggested to be higher than our 5.1
7

medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

days estimate, at 7.76 [20]. Relative infectiousness of A and P versus I, f , is
another parameter that has strong uncertainty. For this reason, we performed a
sensitivity analyses on the two most uncertain parameters (see Supplementary
Information).
The simulations were run using R package SimInf , a system for stochastic
simulation of compartmental models of epidemics [25].

3

Experiments

For our experiments we assumed that J = 75% of symptomatic cases are identified and perfectly quarantined at symptom onset, i.e., two days after their
infectiousness increases. On the other hand, contacts undergoing voluntary
self-quarantine are supposed to reduce their contact rate ten-fold (q = 0.1).
We simulated 12 scenarios with varying contact rate C and, most importantly, assuming a different proportion j of app users in the population (0, 0.25,
0.5 and 0.75). Each simulation was run on 110 nodes representing Italian districts (with data on area and resident population updated to 2016), and was
repeated 50 times, with globally 5,500 simulations per scenario.
For a first set of simulations we assumed a constant population density for
all the nodes; this equals the assumption of a unique transmission rate and,
therefore, a unique R0 for the entire set, so that the only region-specific factor affecting the outcome was relative population. Transmissibility has been
previously estimated, based on data from the Diamond Princess outbreak, at
1.48 [22]; accordingly, assuming 0.10 attack rate, in this scenario we set a contact rate equal to 14.8. However, this was calculated in a particular scenario
where contact rate was supposedly higher than in normal conditions, thus we
simulated two more scenarios with lower contact rates, 10 and 7.5.
A second set of simulations accounted for different population densities
across the 110 districts. Here, contact rate was allowed to vary following population density under an assumed average daily distance traveled by the subjects,
according to Eq.1. Mobility data from two sample european cities (Berga and
Barcelona) show an average daily distance traveled per person varying between
1.2 and 5.2 km (personal communication); starting from these figures we simulated scenarios in which subjects travel, on average, 1.5, 2.5 and 5 km per
day.
An interactive R Shiny web application, enabling the exploration of simulation scenarios, is available at https://flowmaps.life.bsc.es/shiny/ct_
app/.

4

Data

Our simulations were based on population and surface area data from 110 italian
districts updated to 2016. This kind of data is subject to frequent administrative
rearrangements, but actual demographics have remained substantially stable for

8

medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

the aims of this work, and since some districts have since be grouped together,
older data has actually higher spatial resolution.

District
Napoli
Monza and Brianza
Milano
Trieste
Roma
...
Grosseto
Olbia-Tempio
Nuoro
Aosta
Ogliastra

Districts’s data summary
Region
Density Surface (km2 )
Campania
2.65
1171
Lombardia
2.15
405
Lombardia
2.04
1579
Friuli-Venezia Giulia
1.11
212
Lazio
0.81
5352
...
...
...
Toscana
0.05
4504
Sardegna
0.05
3399
Sardegna
0.04
3934
Valle d’Aosta
0.04
3263
Sardegna
0.03
1854

Residents
3107006
868859
3218201
234682
4353738
...
223045
160672
156096
126883
57185

Table 2: Summary statistic of the five most and least densely populated districts.
Table 2 summarizes population data about the five most and least densely
populated districts. Over the entire national territory, density was 2.01/km2 ,
and in districts it ranged from 0.03 to 2.65. Corresponding surface area ranged
from 212 to 7400km2 . Globally, population was 60,589,085. Ogliastra was both
the least populated and least densely populated district, with 57,185 inhabitants
and a density of 0.03/km2 ; the district with most residents was Rome (4,353,738
residents), but the most densely populated was Neaples.

5

Results

Results of the simulations are summarized in Figures 3 and 4, showing the
time curves of the sum of the I and QI compartments and expected mortality.
Clearly the epidemic peak is expected to vary with increasing contact rate, assuming that transmissibility and recovery rate are constant. As expected, in all
simulated scenarios, app-aided contact tracing significantly decreased the effective reproductive number Rt and height of the epidemic peak. In our sensitivity
analyses, using the slightly longer incubation time had no significant impact
in our simulations, whereas the increased infectiousness causes an expected delay in the complete suppression of infections, in particular under conditions of
normal mobility.

9

3e+05

0e+00

Subjects

Subjects

0

0

c

0

b

50

50

50

200

200

200

v = 5.2

v = 2.5

Time (days)

100

100

100

v = 1.5

300

300

300

0

f

0

e

0

d

50

50

50

200

200

200

Time (days)

100

100

100

v = 5.2

300

300

300

0

i

0

h

0

g

50

50

50

C = 10

300

300

200

300

C = 14.8

200

200

Time (days)

100

100

100

C = 7.5

0

l

0

k

0

j

50

50

50

200

200

200

Time (days)

100

100

100

300

300

300

C = 14.8

Figure 3: Total symptomatic population (I + QI compartments) in red and simulated mortality (black) in the 48 scenarios.
Density-dependent contact rate simulations on the left (plots a-f); fixed contact rate simulations on the right (plots g-l). Each
curve results from the sum over 110 districts averaged over 50 replicates per district. Solid lines represent no app users; dashed,
dotted and dashed-dotted lines show increasing fractions of the population using the app (25, 50, 75%). All simulations can be
interactively explored at https://flowmaps.life.bsc.es/shiny/ct_app/.

Subjects

600000

0

1000000

0

40000
20000
0
50000
20000
0
6e+04
0e+00

1500000
0

250000
100000
0
4e+05
2e+05
0e+00
3e+05

4e+06
0e+00
8.0e+06
0.0e+00

10

0e+00

a

medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

5.1

Constant contact rate

In scenarios with constant contact rate equal to 7.5, symptomatic cases isolation
was per se very effective in slowing the epidemic, so much so that app-mediated
contact tracing managed to achieve suppression even with only 75% (Fig 4 b)
of the population using the app and complying to self-quarantine, whereas with
50% peak height was reduced more than 2-fold (Fig 3 b). This shows that,
in scenarios with lower baseline contact rate and efficient isolation of cases,
app-mediated contact tracing can achieve epidemic suppression.

15000

15000

b

v = 1.5
5000
0

5000

C = 7.5

0

Subjects

a

0

10

20

30

40

50

0

20

30

40

50

15000

15000

v = 2.5
5000
0

5000

C = 10

0

10

20

30

40

50

0

10

20

30

40

50

15000

f

15000

e

v = 5.2
5000
0

5000

C = 14.8

0

Subjects

10

d

0

Subjects

c

0

10

20

30

40

50

0

Time (days)

10

20

30

40

50

Time (days)

Figure 4: Detail of Figure 3 showing successful/unsuccessful suppression in the
first 50 days. Suppression is achieved in the most optimistic scenario (contact
rate 7.5, app users 75%) in the scenarios with fixed contact rate (right panels,
upper), whereas its success varies from district to district in scenarios with
density-dependent contact rate (left panels).
On the other hand, nation-wide suppression was not achieved in the less
optimistic scenarios with 10 and 14.8 contact rate; however, the app induced a
very effective mitigation, with peak number of infectious reduced roughly 4-fold
11

medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

4
3
2

Monza
Neaples

Milan

0

1

Subjects (log 10)

5

6

in the worst-case scenario and with 75% of the population using the app (Fig.
3 d and f).

0

100

200

300

400

Time (days)

Figure 5: Epidemic curve for individual nodes (districts) in the scenario with
average velocity v̄ = 1.5 and fraction of app users j = 25%. The epidemic
outbreak is entirely sustained by the three highest-density districts, whereas in
the others the effective reproductive number is below 1.

5.2

Density-dependent contact rate

In scenarios where contact rate was allowed to vary with population density the
epidemic trend was, as expected, significantly different from region to region. In
Figure 3, left panels, the curves of symptomatic infections over time are shown;
compared to simulations with constant contact rate, it is evident the presence
of two more or less distinct epidemic peaks; this may reflect the presence of
groups of districts with different population densities. However, the distinction
tends to disappear with increasing proportions of app users. The simulations
show that suppression can be achieved in most regions even with only 25% of
the population using the app (dashed lines), but the epidemics does not die
out, being almost entirely sustained by the districts with the highest population
density (Milan, Monza, Neaples; Fig. 5). This result is, clearly, achieved by
12

medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

using the app to augment an efficient tracking and isolation of new symptomatic
cases, and indicates that, as for all interventions, effectiveness of app-mediated
contact-tracing and voluntary quarantine should be evaluated in the light of
region-specific differences.

5.3

Quarantine measures impact

The model allows to also keep track of the number of I subjects successfully
quarantined (“true positives”) and of the subjects that underwent quarantine
without actually being infected (“false positives”), by tracing the population
in the QI (Quarantined-Infectious, subjects that were rightfully quarantined)
and QS (Quarantined-Susceptible, subjects that were quarantined but did not
contract infection) compartments. The maximum number of subjects in each
compartment at the same time is summarized in Table 3.
Both false positives and true positives are naturally dependent on the success
or failure of epidemics suppression, and will be very low when suppression is
achieved. In density-dependent scenarios with 75% of app users the maximum
number of Susceptible subjects quarantined at the same time ranged from
200,000 to 2,000,000, whereas in scenarios with fixed density the variation was
much higher, mainly due to the fact that with contact rate C = 7.5 and 75%
app users suppression is achieved.
As expected, True Positives decrease as app coverage increases and epidemic
spread is impaired, but at the same time the number of subjects that are subjected to voluntary quarantine without reason increases. The two quantities
cross over between j = 0.25 and j = 0.5, where subjects that are wrongly
quarantined surpass those that are actually infectious.

6
6.1

Discussion
Modeling framework

The use of targeted app for contact tracing has been proposed as a means to
control the COVID-19 epidemics when lockdown measures are lifted. It has
been shown that, given certain combinations of efficacy in case identifications
and compliant use of such an instrument, the approach can contribute to the
effective reproductive number Rt of the disease below 1 [3]. Here we aimed to
model the effect of app-mediated contact tracing taking into account population
density and transportation, at the same time making it possible to monitor
the number of patients that are quarantined and their status concerning the
infection.
This is a much needed approach if we wish to implement precise and timely
specific intervention making the infections and contagion sustainable for health
care systems.
The model uses a series of Q∗ compartments to model the behavior and
status of subjects that are quarantined for symptomatic infection or based on

13

medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

j

QI

QS

v̄
v̄
v̄
v̄
v̄
v̄
v̄
v̄
v̄
v̄
v̄
v̄

= 1.5
= 1.5
= 1.5
= 1.5
= 2.5
= 2.5
= 2.5
= 2.5
= 5.2
= 5.2
= 5.2
= 5.2

0
0.25
0.5
0.75
0
0.25
0.5
0.75
0
0.25
0.5
0.75

411850.46
345302.96
195800.12
58791.4
1082325.62
937295.72
617449.32
282200.52
1774628.08
1641431.7
1202505.64
702748.88

0
126772.1
304706.56
227277.26
0
344843.98
958998.18
1096092.2
0
589880.54
1801323.82
2656114.82

C
C
C
C
C
C
C
C
C
C
C
C

= 7.5
= 7.5
= 7.5
= 7.5
= 10
= 10
= 10
= 10
= 14.8
= 14.8
= 14.8
= 14.8

0
0.25
0.5
0.75
0
0.25
0.5
0.75
0
0.25
0.5
0.75

2482094.86
2029409.8
866790.1
13639.94
5993749.92
5110050.2
3023884.64
960177.86
10492705.48
9162768.02
6105113.84
2977727.44

0
747889.48
1346998.68
51768.96
0
1879426.1
4691037.66
3703523.2
0
3395616.34
9497105.26
11519918.38

Table 3: Average maximum True Positives (QI) and False Positives (QS) in
each scenario.
contact tracing. To our knowledge, this is the first model that allows simulation
and prediction of the outcomes of the epidemic both accounting for differential
population density and quarantine measures. This is particularly important
since it allows to visualize the effect of contact-tracing apps along the entire duration of the epidemics, and also because the management of the infection has
to take into account the specific characteristics of a given region and implement
measures accordingly. In fact, the application of containment policies disregarding region-specific conditions can result in measures which are not needed
or too drastic. As a consequence, rather than providing support, such policies
might result in a burden for the psychological well-being of people as well as
detrimental for the economy[16].
Compartmentalization of Quarantined subjects has a remarkable potential
usefulness in studying the socio-economic impact of voluntary self-quarantine

14

medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

suggested by app tracing. Clearly, a larger proportion of app users entails better
epidemic control. However, it is expected that the number of false positives in
the QS compartment increases accordingly, with increased losses in terms of
well-being and resources.
Despite the many parameters considered in our model, our work still falls
into a classic compartmental epidemiologic framework; this is a net advantage
in terms of interpretability of results and generalizability. To our knowledge,
this is also the first model that allows keeping track of subjects that undergo
voluntary quarantine.

6.2

Contact tracing effectiveness

According to our model, case isolation is per se a very effective containment
measure that, as long as cases are identified and isolated with a very high success
rate, can achieve suppression of the epidemics in a series of theoretical scenarios.
However, coupling case isolation with immediate app-mediated contact tracing
produces a remarkable improvement in success of the strategy, achieving in all
scenarios a very effective mitigation of contagion and, in some scenarios, full
suppression. These results highlight the benefit of introducing contact-tracing
as a measure of pandemic prevention and control as well as the positive impact
that this would have especially upon critical circumstances.
Feasibility of epidemic control by app-mediated contact tracing has been
suggested already by Ferretti et al.; by decomposing contributions to R0 from
symptomatic, pre-symptomatic, asymptomatic and environmental sources, they
show that Rt < 1 can be attained for certain combinations of efficiency in
case isolation and compliance in contact tracing. Our model allows to directly
simulate such scenarios while at the same time keeping track of the trends in
isolated and quarantined cases. This is particularly relevant as it allows to
quantify the effect of interventions on specific compartments, e.g. it is possible
to trace the number of individuals that are quarantined at a specific time-point,
a piece of data that is potentially very helpful in designing cost-effectiveness
analyses of containment measures.

6.3

Density and traveling

Another important result comes from our simulations with a density-dependent
contact rate. In our simulation different Italian districts behaved very differently, and in all scenarios suppression was easily attained in the less densely
populated regions, whereas it failed in the others (Fig. 5). This is consistent
with the different epidemic trends that have been observed to date in Italian
districts; however, it must be pointed out that differences between districts
may as well be justified by different approaches in dealing with the epidemics,
time to first diagnosed case versus numbers of people already infected in the
population and not yet recognized and, most importantly, is influenced by the
nation-wide/region-wide lockdown put in place by the central government.

15

medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

It is also of note that by making contact rate dependent on both density and
daily distance traveled, our model takes into account the potential effectiveness
of policies aimed at optimizing and regulating transportation, especially in high
density regions. According to the model, effective suppression of the epidemics
in such areas is strongly dependent on such measures.

6.4

Limitations and future research

The main limitation of our work is that there is some uncertainty in the parameters that have to be plugged-in the simulations; anyway, we were able to derive
reasonable estimates for all of them, and performed a sensitivity analysis to
check that our results are robust to changes in the most uncertain parameters.
We adopted some credible figures for the asymptomatic/symptomatic infections
ratio and for relative decrease in infectiousness in asymptomatic subjects, as well
as for probability of infection per contact; however the greatest uncertainty is
precisely in estimation of contact rate, as this is a variable that is influenced by
specific environmental and cultural factors, e.g. individual mobility, social interactions, transportation systems, as well as general social distancing measures
that have been implemented wherever the epidemics took place. Our first choice
estimate for contact rate came from the experience of the Diamond Princess,
based on which we estimated it at a very impressive figure of 14.8, a condition
that would hardly allow for suppression in a nation-wide context. However, it
is evident that the situation in a closed environment favors a higher contact
rate, thus this number is likely to be significantly overestimated. This makes
the scenario a worst-case one, suggesting that, in real world experience, case
isolation and contact tracing may be more effective than predicted.
In scenarios where we modeled contact rate as a function of population
density, the most relevant scaling factor is v̄, i.e. the theoretical average daily
distance traveled by individuals. This is a measure that is not readily estimable,
which is why in the present work we showed results for a series of credible
scenarios; however, using mobility data from European cities we managed to
obtain credible figures to plug-in the model. Our model does take into account
interpersonal distance in the form of R parameter; a potential expansion of this
framework is to account for time spent within the 1m interpersonal distance,
as well as distinguishing between high-risk (e.g. taxis, buses) and low-risk (e.g.
walking, personal car) means of transportation.
However, this work proves the feasibility of including population density
and transportation in an expanded SIR model, and suggests that, even if travel
between districts is forbidden, the epidemics may still be significantly harder to
contain in areas with very high population density (for example, in Italy, the
districts of Milano, Monza and Napoli). The model can be further improved
and expanded by adding age-specific compartments, sex and gender factors, and
risk classes, by refining the implementation of vital dynamics, and by modeling
different methods for contact tracing with varying degree of compliance.

16

medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

6.5

Conclusions

We approached the model with a simulation based approach; this is computationally intensive but still manageable by most software and hardware and
less demanding than stochastic models based on individual data, and allows
for a high degree of customizability by fine-tuning its parameters on specific
interventions.
The model constitutes a viable framework to monitor epidemic trends and
assess the effect of interventions. Our results show that (1) voluntary selfquarantine based on contact-tracing apps, together with efficient case isolation,
can give a relevant, and in some scenarios decisive, contribution to epidemics
mitigation/suppression; (2) at the same time, the success of this strategy can
depend heavily on population density and transportation.

7

Acknowledgments

This material is based upon work supported by the European Commission’s
Horizon 2020 Program, H2020-ICT-12-2018-2020, “INFORE - Interactive ExtremeScale Analytics and Forecasting” (ref. 825070).

8

Conflict of interest

E.S. works for Bayer, is collaborating to COVID Safe Paths app, by MIT, and
advising LEMONADE tracing app, by Nuland. A.S.C. works for Roche Pharma.
M.T.F is consultant for Ely Lilly. The other authors declare no conflict of
interest.

9

Author contributions

A.F., E.S. and N.M. conceived the experiments; A.F. designed the model and
ran simulations; A.F. and E.S. wrote the paper; D.C. and M.P-d-L. revised the
model and code; D.C. wrote the web app; M.T.S., A.S.C. N.M. and A.V. revised
the paper and helped with interpretation and discussion; A.V. supervised model
design and provided mobility data. All of the authors approved the final version
of the paper.

References
[1] N. Ahmed et al. “A Survey of COVID-19 Contact Tracing Apps”. In:
IEEE Access 8 (2020), pp. 134577–134601.
[2] Qifang Bi et al. “Epidemiology and Transmission of COVID-19 in Shenzhen China: Analysis of 391 cases and 1,286 of their close contacts”. In:
MedRxiv (2020).

17

medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

[3] Luca Ferretti et al. “Quantifying SARS-CoV-2 transmission suggests epidemic control with digital contact tracing”. In: Science (2020). issn: 00368075.
[4] Giulia Giordano et al. “Modelling the COVID-19 epidemic and implementation of population-wide interventions in Italy”. In: Nature Medicine
(2020), pp. 1–6.
[5] Xi He et al. “Temporal dynamics in viral shedding and transmissibility of
COVID-19”. In: Nature medicine (2020), pp. 1–4.
[6] Joel Hellewell et al. “Feasibility of controlling COVID-19 outbreaks by
isolation of cases and contacts”. In: The Lancet Global Health 8.4 (2020),
e488–e496. issn: 2214-109X. doi: https://doi.org/10.1016/S2214109X(20)30074- 7. url: http://www.sciencedirect.com/science/
article/pii/S2214109X20300747.
[7] William Ogilvy Kermack and Anderson G McKendrick. “A contribution
to the mathematical theory of epidemics”. In: Proceedings of the royal
society of london. Series A, Containing papers of a mathematical and
physical character 115.772 (1927), pp. 700–721.
[8] Wee Chian Koh et al. “What do we know about SARS-CoV-2 transmission? A systematic review and meta-analysis of the secondary attack rate,
serial interval, and asymptomatic infection”. In: medRxiv (2020). doi:
10.1101/2020.05.21.20108746. eprint: https://www.medrxiv.org/
content/early/2020/05/23/2020.05.21.20108746.full.pdf. url:
https://www.medrxiv.org/content/early/2020/05/23/2020.05.21.
20108746.
[9] Stephen A Lauer et al. “The Incubation Period of Coronavirus Disease
2019 (COVID-19) From Publicly Reported Confirmed Cases: Estimation
and Application”. In: Annals of Internal Medicine (Mar. 2020). issn: 00034819. doi: 10.7326/M20-0504. url: https://doi.org/10.7326/M200504.
[10] Enrico Lavezzo et al. “Suppression of COVID-19 outbreak in the municipality of Vo, Italy”. In: medRxiv (Jan. 2020), p. 2020.04.17.20053157. doi:
10.1101/2020.04.17.20053157. url: http://medrxiv.org/content/
early/2020/04/18/2020.04.17.20053157.abstract.
[11] David Lee and Jaehong Lee. “Testing on the move: South Korea’s rapid
response to the COVID-19 pandemic”. In: Transportation Research Interdisciplinary Perspectives 5 (2020), p. 100111. issn: 2590-1982. doi:
https : / / doi . org / 10 . 1016 / j . trip . 2020 . 100111. url: http : / /
www.sciencedirect.com/science/article/pii/S2590198220300221.
[12] Yun Ling et al. “Persistence and clearance of viral RNA in 2019 novel coronavirus disease rehabilitation patients”. In: Chinese Medical Journal Publish Ah (9000). issn: 0366-6999. url: https://journals.lww.com/cmj/
Fulltext/9000/Persistence%7B%5C_%7Dand%7B%5C_%7Dclearance%

18

medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

7B%5C_%7Dof%7B%5C_%7Dviral%7B%5C_%7DRNA%7B%5C_%7Din%7B%5C_
%7D2019.99362.aspx.
[13] Marc Lipsitch et al. “Transmission dynamics and control of severe acute
respiratory syndrome”. eng. In: Science (New York, N.Y.) 300.5627 (June
2003), pp. 1966–1970. issn: 1095-9203. doi: 10.1126/science.1086616.
url: https://pubmed.ncbi.nlm.nih.gov/12766207%20https://www.
ncbi.nlm.nih.gov/pmc/articles/PMC2760158/.
[14] Lars Lorch et al. A Spatiotemporal Epidemic Model to Quantify the Effects
of Contact Tracing, Testing, and Containment. 2020. arXiv: 2004.07641
[cs.LG].
[15] Marcos Matabuena et al. COVID-19: Estimating spread in Spain solving
an inverse problem with a probabilistic model. 2020. arXiv: 2004.13695
[q-bio.PE].
[16] Jessica Morley et al. Ethical guidelines for COVID-19 tracing apps. 2020.
[17] World Health Organization et al. “Considerations for quarantine of individuals in the context of containment for coronavirus disease (COVID19)”. In: Website https://www. who. int/publications-detail/considerationsforquarantine-of-individuals-in-the-context-of-containment-forcoronavirusdisease-(covid-19)[accessed 12 April 2020] (2020).
[18] Corey M Peak et al. “Comparing nonpharmaceutical interventions for
containing emerging epidemics”. In: Proceedings of the National Academy
of Sciences 114.15 (2017), pp. 4023–4028.
[19] Julian Peto. “Covid-19 mass testing facilities could end the epidemic
rapidly”. In: Bmj 368 (2020).
[20] Jing Qin et al. “Estimation of incubation period distribution of COVID19 using disease onset forward time: A novel cross-sectional and forward follow-up study”. In: Science Advances 6.33 (2020). doi: 10.1126/
sciadv.abc1202.
[21] C J Rhodes and R M Anderson. “Contact rate calculation for a basic
epidemic model”. In: Mathematical Biosciences 216.1 (2008), pp. 56–62.
issn: 0025-5564. doi: https : / / doi . org / 10 . 1016 / j . mbs . 2008 . 08 .
007. url: http ://www .sciencedirect.com / science/article/ pii/
S0025556408001260.
[22] J Rocklöv, H Sjödin, and A Wilder-Smith. “COVID-19 outbreak on the
Diamond Princess cruise ship: estimating the epidemic potential and effectiveness of public health countermeasures”. In: Journal of Travel Medicine
(Feb. 2020). issn: 1195-1982. doi: 10.1093/jtm/taaa030. url: https:
//doi.org/10.1093/jtm/taaa030.
[23] W F Wells. “On air-borne infetction: Study II. Droplets and droplet nuclei.” In: American Journal of Epidemiology 20.3 (Nov. 1934), pp. 611–
618. issn: 0002-9262. doi: 10.1093/oxfordjournals.aje.a118097. url:
https://doi.org/10.1093/oxfordjournals.aje.a118097.
19

medRxiv preprint doi: https://doi.org/10.1101/2020.05.14.20101675; this version posted September 18, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

[24] WHO. Report of the who-china joint mission on coronavirus disease 2019
(covid-19). 2020.
[25] Stefan Widgren et al. “SimInf: An R Package for Data-Driven Stochastic Disease Spread Simulations”. In: Journal of Statistical Software 91.12
(2019), pp. 1–42. doi: 10.18637/jss.v091.i12.

20

