medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Optimal Allocation of Limited Test Resources for the
Quantification of COVID-19 Infections
Michail Chatzimanolakisa,∗, Pascal Webera,∗, George Arampatzisa ,
Daniel Wälchlia , Ivica Kičića , Petr Karnakova , Costas Papadimitrioub ,
Petros Koumoutsakosa,c,∗∗
a Computational

Science and Engineering Laboratory, ETH Zurich, Clausiusstrasse 33,
CH-8092, Switzerland
b Department of Mechanical Engineering, University of Thessaly, Pedion Areos, GR-38334
Volos, Greece
c School of Engineering and Applied Sciences, Harvard University, Cambridge, MA 02138,
USA

Abstract
The systematic identiﬁcation of infected individuals is critical for the containment of the COVID-19 pandemic. Presently, the spread of the disease is
mostly quantiﬁed by the reported numbers of infections, hospitalizations, recoveries and deaths; these quantities inform epidemiology models that provide
forecasts for the spread of the epidemic and guide policy making. The veracity
of these forecasts depends on the discrepancy between the numbers of reported
and unreported, yet infectious, individuals.
We combine Bayesian experimental design with an epidemiology model and
propose a methodology for the optimal allocation of limited testing resources
in space and time, which maximizes the information gain for such unreported
infections. The proposed approach is applicable at the onset and spreading
of the epidemic and can forewarn for a possible recurrence of the disease after
relaxation of interventions. We examine its application in Switzerland; the open
source software is, however, readily adaptable to countries around the world.
We ﬁnd that following the proposed methodology can lead to vastly less
uncertain predictions for the spread of the disease. Estimates of the eﬀective
∗ These

authors contributed equally to this work.
author (petros@seas.harvard.edu)

∗∗ Corresponding

Preprint submitted to Medrxiv

November 9, 2020

NOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice.

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

reproduction number and of the future number of unreported infections are
improved, which in turn can provide timely and systematic guidance for the
eﬀective identiﬁcation of infectious individuals and for decision-making.
Keywords: Bayesian Optimal Experimental Design, Epidemiology, COVID-19

1. Introduction
The identiﬁcation of unreported individuals infected by the SARS-CoV-2
virus is critical for the quantiﬁcation, forecasting and planning of interventions
during the COVID-19 pandemic [1]. Presently the spread of the disease is mostly
5

quantiﬁed by the reported numbers of infections, hospitalizations, recoveries and
deaths [2]. These quantities inform epidemiology models that provide short term
forecasts for the spread of the epidemic, help quantify the role of possible interventions and guide policy making. The veracity of these forecasts depends on
the discrepancy between the numbers of reported and unreported, yet infectious,

10

individuals.
In recent months the estimation of unreported infections has been the subject of several testing campaigns [3, 4]. While there is valuable information being gathered, their estimates rely on testing individuals that are either already
symptomatic or have been selected based on certain criteria (hospital visits, air-

15

port arrivals, geographic vicinity to researchers, etc.). Generic, randomized tests
of the population are broadly applied but they have been hampered either by
delays [5] or by insuﬃcient numbers of test kits [6]. There is broad recognition
that eﬃcient testing strategies are critical for the timely identiﬁcation of infectious individuals and the optimal allocation of resources [7]. However, targeted

20

testing entails bias while randomized tests require access to a high percentage
of the population with commensurate high costs. The quality of the data as
well as the ways they are incorporated in the epidemiology models is critical for
their predictions and for estimating their uncertainties [8]. Having the capability to minimize these uncertainties by suitably distributing in space and time a

25

given number of test kits is the subject of this work. This optimal allocation of

2

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

testing resources and the respective increase of the ﬁdelity of forecasting models
are essential to eﬀective policy making throughout the pandemic.
Here, we present a methodology for the OPtimal Allocation of LImited Testing resourceS (OPALITS) that maximizes the information gain over any prior
30

knowledge regarding infections. The method relies on forecasts by epidemiological models with parameters adjusted through Bayesian inference as data
become available through suitable surveys [9]. The forecasts are combined with
Bayesian experimental design [10, 11, 12] to determine the optimal test allocation in space and time for various objectives (minimize prediction uncertainty,

35

maximize information gain of unreported infections). We emphasize that the
proposed OPALITS is applicable in all stages of the pandemic, regardless of the
availability of data.
We employ the SEI r I u R model [13] that quantiﬁes the spread of a disease
in a country’s population distributed in a number of communities that are in-

40

teracting through mobility networks. The SEI r I u R model predicts the number
of susceptible (S), exposed (E), infectious reported (I r ), unreported (I u ), and
removed (R) individuals from the population. Here we focus on Switzerland
and consider its cantons as the respective communities. The model parameters
are: the relative transmission rate between reported and unreported infectious

45

individuals (µ), the virus latency period (Z), the infectious period (D) and the
reporting rate (α). The transmission rate (β) and the mobility factor (θ) are
considered to be time dependent in order to account for government interventions. For all stages of the epidemic, the respective uncertainties of the model
parameters are quantiﬁed and propagated using Bayesian inference. At the

50

onset of the epidemic, the uncertainty is quantiﬁed through prior probability
distributions. As data of daily infections become available, the uncertainty in
model parameters is updated through Bayesian inference. The parameter probability distributions are used to propagate uncertainties in the model forecasts
and can assist decision makers in quantifying risks associated with the progres-

55

sion of the disease. The proper quantiﬁcation of uncertainty bounds in the
model parameters has a profound eﬀect on predictions of the disease dynam3

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

ics [8]. Large uncertainty bounds around the most probable parameter values
hinder the decision process for identifying eﬀective interventions.
The OPALITS aims to assign limited test-kit resources to acquire data that
60

would reduce the model prediction uncertainties. Minimizing the uncertainty of
the model parameters leads to more reliable predictions for quantities such as
the reproduction number [14]. Moreover, the reduced model uncertainties help
minimize risks associated with the decision making process including timing,
extent of interventions and probability of exceeding hospital capacity.

65

We quantify the information gain from these tests using a utility function
[15, 12] based on the Kullback-Leibler divergence between the inferred posterior
distribution and the current prior distribution of the model parameters. The
prior can be formulated using the posterior distribution estimated from daily
data of the infectious reported individuals up to the current date (see Materials

70

and Methods). Hence, at any stage of the epidemic, the OPALITS provides
guidance for the time and location/community where testing needs to be carried out to maximize the expected information gain regarding infections in a
population.
We demonstrate the simplicity and applicability of the present method in

75

estimating the spread of the coronavirus disease in the cantons of Switzerland.
We ﬁnd that the OPALITS methodology outperforms non-speciﬁc, randomized
testing of sub-populations throughout the COVID-19 pandemic. The proposed
strategy is readily applicable to other countries and the employed open source
software can readily accommodate diﬀerent epidemiological models.

80

2. Results
Optimal Allocation of Limited Testing Resources (OPALITS) during
the COVID-19 pandemic
We present the optimal test-kit allocation strategy for three stages of the
epidemic: (i) starting phase (blue), (ii) containment after enforcement of inter-

85

ventions (red) and (iii) relaxing of interventions and monitoring for a possible
4

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

2. Optimize Test Allocation (Locations/Dates)
0. Initialization of Epidemiology Model

a. Model predictions are used to compute a utility function
U (Eq. 13). U quantifies the gain of information in
different locations/dates for unreported infections.
b. Identify locations/dates maximizing U (Eqs. 14,15).

a. Select epidemiology model (SEI2R).
b. Initialize probability density functions
(PDF) for model parameter uncertainties.

1. Infection Predictions with Epidemiology Model
a. Sample parameter PDFs and use model (Eq. 9) to
get infection predictions for all locations/dates.
b. Test-kits available ?
i. YES: proceed to Step 2
ii. NO: STOP

Figure 1:

3. Test and Update Model Parameters
a. Deploy test-kits in optimal locations/dates from Step 2b.
b. Process results and use data for a Bayesian update of
the model parameter PDFs (Eq. 6). Return to Step 1.

Schematic for the deployment of the Optimal Allocation of Limited Testing Re-

sources (OPALITS) methodology

second outbreak (green) (Fig.2). The strategy relies on Bayesian experimental
design and can operate when no data are available (as in the start of the epidemic) as well as when data have been accumulated, as in the last two stages
of the epidemic. Testing campaigns rely on acquiring randomized samples from
90

a population. The collected data, together with epidemiological models, help
determine quantities of interest, such as the basic reproduction number of the
disease [14]. By suitably adapting the testing campaign, the data can help
reduce the model uncertainty, thus enabling improved estimates regarding the
severity of the epidemic.

95

A testing campaign consists of a set s of surveys si = (ki , ti ) which are labeled by i = 1, . . . My and performed in locations ki ∈ C and on days ti ∈ T ,
where C and T are the set of all available locations and days, respectively.
In this paper a survey aims to determine the number of unreported infectious
individuals in a particular location on a particular day. In the following we

100

assume limited testing resources, where N test-kits are available and each testkit corresponds to testing one person. The goal is to allocate these test-kits in
diﬀerent times and locations so that we maximize the information gain regarding forecasts of the epidemiology model. The locations are the diﬀerent Swiss
cantons, and C := {ZH, BE, LU, . . .} is the set of the strings with canton name

105

abbreviations.
The results of the survey in a canton enable the estimation of a desired quan-

5

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

tity of interest, such as the size of the unreported infected population (I u ). The
number of samples needed to estimate population proportions within a given
conﬁdence interval, error tolerance, and probability of proportion is given by
110

Cochran’s formula [9] corrected for a ﬁnite population size. Using Cochran’s
formula with conﬁdence level 99%, error tolerance 1% and probability of infection 0.1 we ﬁnd that the samples that would be required to survey the largest
Swiss canton (of Zurich) are approximately 5950. All the other cantons need up
to 14% less samples with the exception of the smallest canton that needs 27%

115

less samples (ﬁgure S7 of the Supplementary Information). Hence we assume the
minimum sample size is the same for all cantons. Assuming random sampling of
a population with higher probability (up to 0.9) of infection or requiring tighter
error bounds, would have implied even more samples according to Cochran’s
formula. We note that as of October 2020, 1500 tests per one million people are

120

performed on a daily basis in Switzerland [16]. This amounts to approximately
460 individual tests per canton, which is about an order of magnitude less than
what would be required from Cochrans’s formula for an informative random
sampling. In turn, by using the proposed OPALITS we can compensate for this
lack of test kits with an optimal and systematic process.

125

We outline the application of the proposed approach to a country with distinct administrative units (cantons in the case of Switzerland) (see ﬁgure 1).
First, we determine how many cantons will be surveyed, given the number of
available test-kits N . Then, the sequential optimization of the expected utility
function is performed (see Materials and Methods) to identify optimal survey

130

locations (cantons). We then distribute the test-kits to the identiﬁed cantons
and test a random subset of their population on the suggested day. After collecting the results from all the surveys we update the prior distributions of the
model parameters. The collected data leads the maximal information gain in
the model parameters. This in turn translates into minimal uncertainty in pre-

135

dictions made with the model for quantities such as the number of unreported
infections.
The expected information gain of a particular strategy for selecting the sur6

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

vey locations/times s is quantiﬁed by a utility function Û (s) [15]. The maximum
of this function corresponds to an optimal strategy that yields the most infor140

mation about the quantities of interest. The expected utility function can be
understood as a measure of the diﬀerence between prior knowledge of the model
parameters and the posterior knowledge, after surveys have been conducted in
a set of locations and dates. Given such a set, the utility function estimates the
expected diﬀerence, equivalently the information gain, by taking the expectation

145

over all possible survey results.
The OPALITS relies on forecasts by suitable epidemiological models. In
turn, these forecasts rely on prior information and their predictions are further adjusted as data become available in a Bayesian inference framework [17].
The set of Ordinary Diﬀerential Equations (ODEs) describing the SEI r I u R

150

model [13] are integrated to produce the model output. The uncertainty of the
model output and its discrepancy from the available data is quantiﬁed through
a parametrized error model. The resulting stochastic model and its quantiﬁed
uncertainties are then used to identify the optimal spatio-temporal allocation
of limited test resources.

155

Case 1: Beginning of the epidemic - Optimal testing without data. At the start
of an epidemic, there are no data and we assume no other prior information
regarding the spread of the pathogen in a country. The initial conditions for the
number of unreported infections (I uIC ) were selected with non-zero values for
the cantons of Aargau, Bern, Basel-Landschaft, Basel-Stadt, Fribourg, Geneva,

160

Grisons, St.Gallen, Ticino, Vaud, Valais and Zurich based on their population
and their large number of interconnections. Due to the lack of any prior information and relevant data, all the parameters are assumed to follow uniform
prior distributions (see table S5, for details).
The ﬁrst infectious person in Switzerland was reported on February 25th in

165

r
= 1) with no initial reported infections in all other
the canton of Ticino (ITI

cantons. The initial number of exposed individuals is set proportional to the
number of unreported infections Ek = 3Iku in accordance with the value of

7

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

R0 ≈ 3 reported in [18] in the initial stage of the disease. The rest of the
population is assumed to be susceptible. The methodology involves parameters
170

e = (I u , τ ))
of interest (ϑ = (β, µ, α, Z, D, θ, c)) and nuisance parameters (ϑ
IC
that the testing strategy does not aim to determine (see Materials and Methods
section for deﬁnitions).
The estimated expected utility functions Û (s) for up to four surveys in the
cantons of Switzerland for a time horizon of 8 days is shown in Figure 3, T =

175

{Feb 25, . . . , Mar 3}. Higher values for expected utility are estimated in cantons
with larger population reﬂecting the larger relative uncertainty for cantons with
only few reported cases. This implies that smaller cantons, with lower mobility
rates, are less preferred for performing tests since their contribution to the
information gain is not signiﬁcant. This is reﬂecting the fact that the assumed

180

covariance matrix is shared among cantons (see Materials and Methods). This
implies a smaller relative error, when surveying larger cantons with consequently
higher number of infections. The Bayesian analysis enables the inference of the
particular cantons and days for which a survey should be performed in order
to maximize the information gain. Accordingly, the most informative survey

185

should have been made in Zurich on March 2nd . The optimal location and
time for the second survey is determined to be canton of Vaud on the 27th of
February. As expected, the information gained from tests in the canton of Vaud
is less than the information gained from the canton of Zurich. The information
that would have been gained by surveying the next two selected cantons of Vaud

190

and Basel-Landschaft on March the 3rd and February the 28th respectively, is
progressively reduced to a small level that, given the testing costs, does not
justify carrying out surveys in more than 4 cantons. The values of the optimal
times are listed in table S1 in the Supplementary Information.
The results indicate that the proposed OPALITS methodology selects certain

195

populous and well interconnected cantons at speciﬁc times to acquire the most
information for estimating the model parameters.

8

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.

Daily Reported infectious

It is made available under a CC-BY-NC-ND 4.0 International license .

1250
1000
750
500
250
0
5 3 0 7 4 1 7 4 1 8 5 2 9 6 2 9 6 3 0
b2 r0 r1 r1 r2 r3 r0 r1 r2 r2 y0 y1 y1 y2 n0 n0 n1 n2 n3
Fe Ma Ma Ma Ma Ma Ap Ap Ap Ap Ma Ma Ma Ma Ju Ju Ju Ju Ju
Days (t)

Figure 2: Testing scenarios for the COVID19 outbreak in Switzerland. Daily reported
Coronavirus cases in Switzerland are plotted as gray bars. The period before (blue), during
(red) and after (green) imposing non-pharmaceutical interventions are marked with color.

Case 2: Exponential spreading and optimal testing strategy during non - pharmaceutical interventions. When the spreading of the coronavirus entered an
exponential growth stage, several governments (including the Swiss) decided
200

to take non-pharmaceutical interventions such as requesting social distancing,
closing schools and restaurants, or ordering a complete lockdown in order to
contain the epidemic. Here, the goal of the OPALITS is to propose surveys that
would help to better assess the eﬀectiveness of these interventions.
In this case, probability distributions of model parameters are informed using

205

data from the existing spread of the COVID-19. The daily reported infections in
Switzerland [19] from the 25th of February up to the 17th of March 2020 are used
to update the distributions, speciﬁed in the previous phase, by using Bayesian
inference. The marginal posteriors are plotted in ﬁgure S1 of the Supplementary
Information. The SEI r I u R models the non-pharmaceutical interventions with a

210

time-dependent transmission rate β and mobility factor θ. These parameters are
calibrated by the data and provide an estimate on the timing and eﬀectiveness
of the interventions[8].
Figure 4 shows the maximum values of the information gain for each survey
for T = {Mar 17, . . . , Mar 30}. For cantons with a small population and low

9

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Canton VD
4

4

4

2

2

Û (t, BL)

4

2

Û (t, BE)

4

Û (t, BL)

6

2

2

0

0

0

0

0

25 2 6 2 7 28 2 9 r 01 r 02 r 03
Feb Feb Feb Feb Feb Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

Canton FR

Canton GE

Canton GL

Canton GR

6

6

4

4

4

4

4

2

2

2

Û (t, GR)

6

Û (t, GL)

6

Û (t, GE)

6

Û (t, FR)

2

2

0

0

0

0

0

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

Canton LU

Canton NE

Canton NW

Canton OW
6

4

4

4

4

4

2

2

2

Û (t, OW)

6

Û (t, NW)

6

Û (t, NE)

6

Û (t, LU)

6

2

2

0

0

0

0

0

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

Canton SG

Canton SH

Canton SO

Canton SZ

Canton TG
6

4

4

4

4

4

2

2

2

Û (t, TG)

6

Û (t, SZ)

6

Û (t, SO)

6

Û (t, SH)

6

2

2

0

0

0

0

0

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

Canton TI

Canton UR

Canton VS

Canton AI

Canton ZG

6

6

4

4

4

4

4

2

2

2

2

Û (t, ZG)

6

Û (t, VS)

6

Û (t, UR)

6

Û (t, AI)

Û (t, BS)
Û (t, JU)

Canton BL

6

Canton JU

Û (t, SG)

Canton BE

6

Canton BS

Û (t, TI)

Canton BL

6

Û (t, VD)

Û (t, ZH)

Canton ZH
6

2

0

0

0

0

0

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

Canton AG

Û (t, AG)

6

4

2

0

5 6 7 8 9 1 2 3
b2 b2 b2 b2 b2 r0 r0 r0
Fe Fe Fe Fe Fe Ma Ma Ma
Days (t)

Figure 3: Expected information gain during start of epidemic. The blue curve corresponds to the utility of making one survey. The green curve is the utility when a second
survey is added, provided the location and time of the first survey correspond to the maximum
of the blue curve (found in the canton of Zurich, on March 2nd ). Similarly, the yellow and red
curves show the utilities for a third and fourth surveys, when the locations and time of the
previous surveys are fixed to their optimal values. The fixed dates and location of each survey
are plotted with black dashed lines. The shaded areas indicate the difference to the expected
information gain of the previous survey, which becomes thinner as additional surveys do not
yield a further significant information gain.

10

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

215

connectivity to other cantons a low information gain is found. The opposite can
be observed for cantons with large population and strong connections to other
cantons. The values for the maximum utility in time for the measurements are
listed in Table S2. If only a single canton were to be selected(due to limited
availability of test-kits in the country), then a survey in the canton of Vaud

220

carried out on the 30th of March were to be preferred over surveys in either of
the cantons of Zurich, Bern or Geneva (blue in ﬁgure 4). If two surveys could
be aﬀorded, the OPALITS methodology proposes to carry them out in the same
canton (Vaud) on the 17th and on the 30th March (blue and green in ﬁgure 4).
Note that the canton of Zurich, ranked as the next preferred canton for a single

225

survey (blue in ﬁgure 4), is not selected by the methodology since part of the
information that would be gained from testing is already contained in surveys
performed in Vaud. In case more test kits were available, in addition to the two
tests in Vaud, the optimal location and time for a third survey would have been
the canton of Grisons on the 30th of March (yellow in ﬁgure 4). The canton of

230

Zurich is proposed as the fourth location to be surveyed on the 30th of March
as well. However, the information gain from the fourth survey in the canton of
Zurich is approximately 10% of the total information gained from the surveys
carried optimally in the ﬁrst three cantons.
The results suggest that surveys in two locations/times provide signiﬁcant

235

information regarding assessing the eﬀectiveness of interventions. Further tests
on more locations/times did not add substantial information. It is evident that
a trade-oﬀ between the required information gain and cost of testing are decisive
for the number of necessary surveys and respective test kits.
Case 3: Optimal monitoring for a second outbreak. After the relaxation of mea-

240

sures that assisted in mitigating the initial spread of the disease, it is critical to
monitor the population for a possible second outbreak. The OPALITS methodology supports such monitoring with surveys of the population based on data
up to and after the release of the measures.
First, Bayesian inference is performed with data available from February

11

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

BS
JU

0.5

03-17
03-17
03-17
03-17
03-17
03-17
03-17
03-17
03-17
03-17
03-17
03-17
03-17
03-17
03-17
03-17
03-17
03-17
03-17
03-17
03-17
03-17
03-17
03-17
03-17
03-17

1.0

Additional Expected Information Gain for Survey 2

VD
GE
BE
ZH
TI
GR
VS
AG
FR
SG
LU
BL
SO
NE
TG
BS
SZ
ZG
JU
SH
AR
GL
NW
OW
UR
AI

1.5

GR

TI

VS

GE

Additional Expected Information Gain for Survey 1

SG ARAI

ZG
SZ
GL
NW
OW UR

BE
FR

VD

TG

ZH

LU

NE
GR

SO

AG

03-30
03-30
03-30
03-30
03-30
03-30
03-30
03-29
03-30
03-30
03-30
03-30
03-30
03-30
03-30
03-30
03-30
03-30
03-30
03-30
03-29
03-30
03-30
03-30
03-30
03-30

2.0

JU

SG ARAI

SH
BL

VD
ZH
BE
GE
TI
VS
AG
FR
SG
LU
GR
BL
SO
NE
TG
BS
SZ
ZG
JU
SH
AR
NW
GL
OW
UR
AI

Expected Information Gain

2.5

BS

TI

VS

GE

3.0

TG

ZH

ZG
SZ
GL
NW
OW UR

BE
FR

VD

AG
LU

NE

3.5

SO

SH
BL

Canton (k)

Canton (k)

0.0

BS
JU

GE

3.5

BL

AG

TG

ZH

BE
FR

BS
JU

SG ARAI

ZG
SZ
GL
NW
OW UR

LU

NE
VD

SO

SH

VD

TI

VS

GE

Additional Expected Information Gain for Survey 3

AG

TG

ZH

SG ARAI

ZG
SZ
GL
NW
OW UR

LU

NE
GR

SO

SH
BL

BE
FR

GR

TI

VS

Additional Expected Information Gain for Survey 4

2.5
2.0

03-30
03-26
03-29
03-17
03-17
03-17
03-17
03-21
03-29
03-21
03-30
03-30
03-17
03-29
03-29
03-17
03-30
03-30
03-30
03-30
03-17
03-29
03-23
03-17
03-30
03-17

0.5

ZH
BE
TI
GE
VD
VS
AG
SG
GR
LU
FR
TG
BL
SO
NE
BS
SZ
ZG
JU
SH
AR
NW
OW
UR
GL
AI

1.0

03-30
03-21
03-29
03-17
03-17
03-17
03-17
03-21
03-28
03-17
03-30
03-30
03-17
03-30
03-30
03-17
03-29
03-30
03-30
03-30
03-17
03-29
03-22
03-17
03-30
03-17

1.5

GR
ZH
BE
TI
GE
SG
VD
AG
VS
LU
FR
TG
BL
SO
NE
BS
SZ
ZG
JU
SH
AR
NW
GL
OW
UR
AI

Expected Information Gain

3.0

Canton (k)

Canton (k)

0.0

Figure 4: Optimal testing strategy for effect of non-pharmaceutical interventions.
The maximum gain of information is plotted on the map of Switzerland using an exponential
colormap. Here blue corresponds to taking one survey, green to adding a second, yellow to a
third and red to a fourth. Below the map we plot the magnitude of the expected information
gain of each survey, along with the optimal measurement dates per canton.

12

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

245

the 25th up to June the 6th , to update the uniform priorsthe resulting marginal
posteriors are shown in ﬁgure S2 of the Supplementary Information. This date
is in accordance to the ﬁrst stage of major release of measures in Switzerland [20]. The eﬀects of interventions are modeled by a parametrized timedependent transmission rate and mobility factor (see Materials and Methods).

250

The inferred probability distributions of these additional parameters are taken
into account as the OPALITS maximizes the information gain.

Note that

T = {Jun 7, . . . , Jun 14} in this case.
Subsequently, data from February the 25th up to July the 9th are included,
repeating the Bayesian inference and estimating the marginal distributions and
255

predictions shown in Figures S3 and S4, T = {Jul 10, . . . , Jul 17}. The results
indicate that the relaxation of measures correlates with an increase in the number of reported infections (Figure 5). The information gain for each canton
indicates the most informative surveys should be performed a week after performing the inference. The provided information could then assist in estimating

260

the severity of a second outbreak as indicated by the maximum of the utility in
time (Tables S3 and S4). Given that tests should be carried out in four locations
and times, the methodology promotes optimal surveys for two diﬀerent times,
within a week, in the cantons of Zurich and Vaud. First, surveys should be
performed in Zurich, providing high information gain for both considered cases.

265

The next two surveys are to be performed in Zurich and Vaud, with a rank that
depends on the considered case, while the fourth test should be performed in
Vaud. We ﬁnd that the information gain from the last test is approximately 10%
of the cumulative information gain from the ﬁrst three surveys. The number of
surveys can be then selected according to the available test-kits N .

270

Case 4: Effectiveness of Optimal Testing. We demonstrate the importance of
following the OPALITS by comparing it with a non-speciﬁc testing campaign
that is based on heuristics. We ﬁrst re-examine the situation at the start of an
epidemic and assume that the available resources allow for two surveys. Surveys
are simulated by evaluating the epidemiological model with the maximum a-

13

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.

ZH

2.0

1000

1.5
VD
ZH

500

1.0
0.5

VD

0

0.0
2.5

1500

ZH

1000

2.0
1.5

500

ZH
VD
VD

0
b
Fe

25

1.0
0.5
0.0

Expected Information Gain

2.5

1500

Expected Information Gain

Daily Reported Infectious

Daily Reported Infectious

It is made available under a CC-BY-NC-ND 4.0 International license .

9
5
0
2
8
6
4
0
4
1
7
r1
r 2 pr 0 pr 2 ay 0 ay 1 un 0 un 1 un 3 Jul 1 Jul 2
J
J
J
A
A
Ma Ma
M
M
Days (t)

Figure 5: Optimal testing strategy to monitor a second outbreak. Bayesian inference
determines the parameters of the first infection wave using the data (black dots) of the daily
new reported infections up to the 6th of June (upper plot) and to the 9th of July (lower
plot). The 99% confidence intervals are plotted in gray. The proposed testing strategy is
plotted with vertical bars at the found optimal days. Here blue indicated the utilities for the
first survey. The green bars correspond to the gain in utility when adding a second survey
assuming the first was chosen in the optimal location, where the yellow and red correspond
to adding a third and fourth survey.

14

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

275

posteriori estimate (MPE) of the parameters obtained from the inference in
phase II (exponential growth) of the epidemic. We used data of the ﬁrst 21
days of the infection spread in Switzerland [19] (February 25th to March 17th ).
After evaluating the model, artiﬁcial surveys are obtained by adding a stochastic
error term.

280

For the optimal strategy, data are collected by consulting ﬁgure 3. Thus,
the two surveys are performed in the cantons of Zurich and Vaud, on the 2nd
of March and the 27th of February respectively. For a non-speciﬁc strategy, the
cantons of Ticino and Bern were selected, on the 28th of February. We remark
that this is the canton where the ﬁrst infection was reported and the capital of

285

the country. These artiﬁcial data, obtained for the two strategies, are added to
the real data of the daily reported cases from the ﬁrst 8 days after the outbreak
e MPE , D)
in Ticino. For the expanded data-set D the posterior distributions p(ϑ|ϑ
are found by sampling the model parameters using nested sampling [14].
The resulting one- and two-dimensional marginalized posterior distributions

290

for both strategies are shown in ﬁgure 6. We note that the dispersion coeﬃcient
r (deﬁned in the Materials and Methods) in the error model for the real data
(the reported infections) and the correlation parameter are almost the same
for both strategies. However the model parameters show signiﬁcant diﬀerences
even when only two new data-points are added to a set of 208 data-points. The

295

posterior distributions of the parameters of interest are propagated through the
epidemiology model to provide the uncertainties in the number of unreported
infectious individuals. In ﬁgure 7 the model output for the total number of
unreported infections is plotted together with a 99% conﬁdence interval along
with the true value of the unreported cases obtained by using the selected pa-

300

rameters. The predictions from the OPALITS have a much higher certainty
with a conﬁdence interval that is up to four times narrower than the one from
a non-speciﬁc strategy. The same ﬁgure also shows the relative histogram plots
for the eﬀective reproduction number, which for the employed model is given
from Rt = βDα + βDµ(1 − α) [13]. Not only is the histogram more peaked,

305

when data is optimally collected, but also the mean value of the two histograms
15

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

6

6

4

4

1.5

0.2

2

1.0

c

Z

0.1

r

0.2

0.5

D

1.0
1

1

0.5
1.0

1.5

1.0

b

1.5

1.0

b

1.5

1.0

b

1.0

1.5

1.0

1.5

b

0.2

0.1

2

2
0

0.0
1.0

b

6

6

4

4

1.5

1.0

b

1.5

1.0

b

1.5

1.5
b

0.2

2

1.5

1

0.5
0.5

1.0

0.5

1.0

0.1

2

2
0
1.0

c

1.0

r

0.1

1

D

Z

2
0.5

0.5

1.0

0.5

0.0

1.0

0.5

1.0

0.5

1.0

0.5

1.0

b
0.2

0.2

0.1

0.1

6

6

4

4

1.5

0.2

2

0.5

0
1.5

0.5

1.0

1

0.1

0.2

0.1

2

2

1.0

c

1.0

10

r

D

Z

20

0.1

0.2

0.1

0.0

0.2

0.1

0.2

0.1

0.2

0.1

0.2

0.2

4

1.0

0.5

1.0

0.1

0.2

2.5

2.5

Z
6

6

4

4

4

4

2

2

D

6

D

6

D

D

b

5.0

2

2.5

Z

0.5

1.0

0.2

0.1

0.2

2.5

b

5.0

Z
1.5

1.5

1.0

1.0

1.0

1.0

1.0

0.5

0.5

0.5

0.5

0.5

1.0

0.1

0.2

2.5

b

1

0.0

5.0

2.5

5.0

2.5

D

5.0

2.5

D

1

1

0.5

2

1

1.5

0.5

1.0

0.1

0.2

2.5

b

1.0

1.5

0.5

2

1

5.0

2.5

Z

0.2

0.2

0.2

0.1

0.0

0
5.0

5.0

D
0.2

1.0

1.5

0.5

1.0

1.5

0.2

1.0

1

0.5

5.0

0.5

1.0

1.5

1

D

0.2

0.1

0.0

0.0
1.0

0.1

D

r

1

1

2

2.5

2

r

1

2

r

2

r

r

5.0

Z

2

5.0

Z
0.2

0.5

D

1.5

0.5

2.5

Z
2

1.0

2.5

1.5

1.5

5.0

2

1.5

1.0

2.5

Z

r

1.5

5.0

1.5

0.0
1.0

0.1

0.0

5.0

c

0.5

c

1.5

1

2
0.0

1.0

c

0.4

2

c

4

2

r

4

2

0.2

2

r

4

1.5

6

r

6

D

6

Z

6

Z

Z

b

2

1

r

0.2

0.2

2

r

0.2

0.0

0.0
1.0

1.5

0.0
0.5

1.0

b

0.0
0.1

0.2

0.1

0.0
2.5

5.0

0.1

0.0
2.5

Z

c

0.1

c

0.1

c

0.1

c

c

c

c

5.0
0.1

D

5.0

0.1

2.5

0.0
0.5

1.0

1.5

0.0
1
r

2

0.0

0.2
c

Figure 6: Marginal posterior distributions for two strategies. The diagonal shows the
histogram for the marginal distribution for every parameter. Purple indicates posterior for
the survey following the optimal testing strategy, gray the one for the non-specific strategy.
The lower half and upper half show the samples of the joint distribution of two parameters
for the optimal and the non-specific strategy respectively. Here black indicates low density
and yellow high density.

16

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

is diﬀerent. When data is optimally collected, the found mean value for the
eﬀective reproduction number is 2.1, whereas when the non-speciﬁc strategy is
followed the average value is 3.2. A mean value of 3.2 could lead to more strict
non-pharmaceutical interventions, which might prove unnecessary and harmful
310

for the economy.
Further comparisons, demonstrating the value of the OPALITS, include
model predictions with higher certainty, as indicated by conﬁdence intervals
that are narrower than the ones obtained from from a non-speciﬁc strategy (ﬁgures S5 and S6, see Supplementary Information). Narrower uncertainty bounds

315

provide higher conﬁdence for decisions related to possible interventions to contain the epidemic.

3. Discussion
We introduce a systematic approach to identify optimal times and locations
for epidemiological surveys to quantify infectious individuals in a country’s pop320

ulation during the COVID-19 epidemic. The proposed OPALITS methodology
exploits prior information and available data to maximize the expected information gain in quantities of interest and to minimize uncertainties in the forecasts
of epidemiological models.
The present study addresses the need for an accurate assessment of COVID-

325

19 infections [21] and it is shown to be far more accurate than the currently
applied random testing. The proposed methodology is, to the best of our knowledge, the ﬁrst method to propose an optimal spatio-temporal allocation of limited test-kit resources . A ﬁrst study for the estimate of unobserved COVID-19
infections [5] in the USA indicated that early testing would have decreased the

330

surveillance gap during a critical phase of the epidemic. More recently a number of studies have emerged that address the optimal allocation of resources.
The “Test and Contain” process suggested in [7] addresses an idealized population of 10’000 and solves an allocation problem using predictions of the SIR
model. They assume an isolation of the positively identiﬁed individuals and

17

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.

Unreported Infectious

It is made available under a CC-BY-NC-ND 4.0 International license .

20000

15000

10000

5000

0

e

F

b

2

5
b

e

F

6
2

b

e

F

7
2
e

F

b

8
2

b

e

F

9
2

2

1

r

a

M

0

r

3

0

a

M

r

a

M

4

0

r
a

M

5

0

r

0

a

M

r
a

M

6
0

7

r

a

M

8

0

r

a

M

9

0

r

0

a

M

Days (t)

0.6

Relative frequency

0.5
0.4
0.3
0.2
0.1
0.0

1

2

3
4
5
Effective Reproduction number

6

7

Figure 7: Prediction uncertainty for different testing strategies. Up: The black
dots show the actual unreported infectious for an artificial spread in Switzerland. The error
bounds show the 99% confidence intervals of the model output for samples of the parameters
with data obtained by optimal (purple) and non-specific testing (gray). Down: Relative
frequency histograms for effective reproduction number, predicted with data obtained by
optimal (purple) and non-specific testing (gray).

18

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

335

showed that just one test a day can reduce the peak of infected individuals
by 27%. This study is similar to ours in casting the test allocation problem
in an optimization framework using linear programming in contrast to information maximization that we propose. However, their approach is not data
informed and does not address a realistic country scenario. Another study [22]

340

focused on test-kit allocation in the Philippines. They use a statistical approach
and non-linear programming to determine the optimal percentage allocation of
COVID-19 test-kits among accredited testing centers in the Philippines aiming
for an equitable chance to all infected individuals to be tested. Their goal of
optimal percentage allocation diﬀers from ours that is optimal space and time

345

allocation of test-kits.
The proposed method is demonstrated by focusing on the outbreak of the
epidemic in Switzerland.

We compare OPALITS with random testing and

demonstrate its advantages in producing forecasts with far reduced uncertainties. We note that the existing testing capacity of 1500 tests per million people
350

in Switzerland can be better allocated than the ongoing random testing. Moreover we show that the present methodology will be of particular importance to
countries with testing capacity that is far lower than that of Switzerland [16].
The methodology relies on Bayesian experimental design using prior information and available data of reported infections along with forecasts from the

355

SEI r I u R model. We compute the optimal testing strategy for three phases of
the epidemic. At the onset of the epidemic the method identiﬁes the most crucial dates and locations for randomized tests in the country’s population. The
deployment of OPALITS at this phase would have allowed authorities to perform randomized testing in a period of high uncertainty, well in advance of the

360

disease outbreak. Moreover, the presented approach is applicable to any newly
arising epidemic and can be used to identify important surveying locations and
a general protocol of action, whenever an unknown disease starts to spread. In
the case of COVID-19, such course of action would limit early inaccurate estimates of metrics such as the virus mortality rate, estimated around 3% in early

365

March 2020 by the World Health Organization [23] and currently believed to be
19

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

lower than 1%, [24].
During the period of non-pharmaceutical interventions the proposed strategy would help quantify their eﬀectiveness assisting decision making for further
interventions or retraction of measures that may be harmful to the economy.
370

In this study, available data for the daily reported infections prior to any interventions, combined with the proposed methodology, indicated that conducting
two surveys after measures are imposed is suﬃcient. This can help to identify
the new virus dynamics quickly and adjust interventions accordingly. Similarly,
the OPALITS can assist monitoring for a recurrence of the disease after preven-

375

tive measures have been relaxed and help guide further planing of interventions.
Since massive testing for a new disease might not be a possibility during its ﬁrst
outbreak and cheap individual tests might become available only later, applying
the proposed methodology at this point provides a useful guideline on how to
use the individual tests to conduct large-scale surveys. For instance, in Switzer-

380

land it was not before mid-April 2020 that rapid COVID-19 tests were released
on the market [25]. Collecting data for the reported cases before that and using
it to inform the proposed approach to ﬁnd an OPALITS (after cheap individual
tests become available) that will be applied during a possible lock-down would
be the suggested course of action in this case.

385

There are a number of issues that the model should be able to accommodate
in the future. These include accounting for virological test sensitivity, delays
in the reporting of the test results and bias on the estimate of the unreported
infected individuals (Cochran’s formula). Further developments may include
models that account for diﬀerent transmission dynamics in cantons while the

390

classical Bayesian inference methods may be replaced with Hierarchical Bayesian
Method to account for heterogeneous data.
We remark that the proposed OPALITS does not depend on a particular
type of data/model or to the country of Switzerland. The open source code is
modular, scalable and readily adaptable to diﬀerent scenarios for the epidemic

395

and countries around the world. We believe that the present work can be a
valuable tool for decision makers to allocate resources eﬃciently for testing the
20

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

population, providing a reliable quantiﬁcation of the spread of the disease and
designing eﬀective interventions.

Acknowledgments
400

We acknowledge discussions with Fabian Wermelinger, Lucas Amoudruz,
Martin Boden (ETHZ). Sergio Martin (ETHZ) provided technical assistance
with the software.

Authors contributions
Conceptualization: C.P., P.Ko.; Data curation: M.C., P.W.; Formal Analy405

sis: M.C., P.W., G.A., D.W., C.P.; Funding acquisition: P.Ko.; Investigation:
M.C., P.W., C.P., G.A., P.Ko. Methodology: P.W., M.C., C.P., G.A., P.Ko.;
Project administration: P.Ko.; Resources: P.Ko.; Software: P.W., M.C., D.W.,
I.K., P.Ka.; Supervision: C.P., P.Ko., G.A.; Validation: M.C., P.W.; Visualization: P.W., M.C., P.Ka; Writing – original draft: P.W., M.C., C.P., P.Ko.;

410

Writing – review & editing: P.W., M.C., C.P., P.Ko., G.A., D.W., I.K., P.Ka.

Competing interests
The authors have no competing interests.

Data and materials availability
All data is available in the manuscript or the Supplementary Materials. The
415

code is available under https://github.com/cselab/optimal-testing.

References
[1] Du Toit A. Outbreak of a novel coronavirus. Nature Reviews Microbiology
2020;18(3):123–.

21

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

[2] Verity Rea. Estimates of the severity of coronavirus disease 2019: a model420

based analysis. The Lancet Infectious Diseases 2020;20.
[3] Department of Health and Social Care, UK .
ment of Community Transmission ﬁndings.

Real-time Assess-

https://www.imperial.

ac.uk/medicine/research-and-impact/groups/react-study/
real-time-assessment-of-community-transmission-findings/;
425

2020. Online, accessed 2020-10-18.
[4] Lohse S, Pfuhl T, Berkó-Göttel B, Rissland J, Geißler T, Gärtner B, et al.
Pooling of samples for testing for sars-cov-2 in asymptomatic people. The
Lancet Infectious Diseases 2020;20(11):1231 –2. doi:https://doi.org/10.
1016/S1473-3099(20)30362-5.

430

[5] Perkins TA, Cavany SM, Moore SM, Oidtman RJ, Lerch A, Poterek M.
Estimating unobserved sars-cov-2 infections in the united states. Proceedings of the National Academy of Sciences 2020;117(36):22597–602.
doi:10.1073/pnas.2005476117.
[6] Abdalhamid B, Bilder CR, McCutchen EL, Hinrichs SH, Koepsell SA,

435

Iwen PC. Assessment of Specimen Pooling to Conserve SARS CoV-2 Testing Resources. American Journal of Clinical Pathology 2020;153(6):715–8.
doi:10.1093/ajcp/aqaa064.
[7] Jonnerby J, Lazos P, Lock E, Marmolejo-Cossío F, Ramsey CB, Sridhar
D. Test and contain: A resource-optimal testing strategy for covid-19. In:

440

AI for Social Good Workshop. 2020,.
[8] Karnakov P, Arampatzis G, Kičić I, Wermelinger F, Wälchli D, Papadimitriou C, et al. Data-driven inference of the reproduction number for covid19 before and after interventions for 51 european countries. Swiss Medical
Weekly 2020;150. doi:https://doi.org/10.4414/smw.2020.20313.

445

[9] Cochran W. Sampling Techniques. Wiley, New York; 1963.

22

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

[10] Chaloner K, Verdinelli I. Bayesian Experimental Design: A Review. Statistical Science 1995;10(2):273–304.
[11] Huan X, Marzouk YM. Simulation-based optimal bayesian experimental design for nonlinear systems.
450

Journal of Computational Physics

2013;232(1):288 – 317. doi:https://doi.org/10.1016/j.jcp.2012.08.
013.
[12] Ryan EG, Drovandi CC, McGree JM, Pettitt AN. A review of modern computational algorithms for bayesian optimal design. International Statistical
Review 2016;84(1):128–54. doi:10.1111/insr.12107.

455

[13] Li R, Pei S, Chen B, Song Y, Zhang T, Yang W, et al. Substantial undocumented infection facilitates the rapid dissemination of novel coronavirus (sars-cov-2). Science 2020;368(6490):489–93. doi:10.1126/science.
abb3221.
[14] Speagle JS. Dynesty: a dynamic nested sampling package for estimating

460

bayesian posteriors and evidences. Monthly Notices of the Royal Astronomical Society 2020;493(3):3132–3158. doi:10.1093/mnras/staa278.
[15] Lindley D. On a measure of the information provided by an experiment. Annals of Mathematical Statistics 1956;27(4):986–1005. doi:{10.1214/aoms/
1177728069}.

465

[16] Hasell J, Mathieu E, Beltekian D, Macdonald B, Giattino C, Ortiz-Ospina
E, et al. A cross-country database of covid-19 testing. Sci Data 2020;7(345).
doi:https://doi.org/10.1038/s41597-020-00688-8.
[17] Dehning J, Zierenberg J, Spitzner FP, Wibral M, Neto JP, Wilczek M, et al.
Inferring change points in the spread of covid-19 reveals the eﬀectiveness

470

of interventions. Science 2020;369(6500). doi:10.1126/science.abb9789.
[18] Liu Y, Gayle AA, Wilder-Smith A, Rocklöv J. The reproductive number
of COVID-19 is higher compared to SARS coronavirus. Journal of Travel
Medicine 2020;27(2). doi:https://doi.org/10.1093/jtm/taaa021.
23

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

[19] Kanton Zürich, Statistisches Amt . SARS-CoV-2 Cases communicated by
475

Swiss Cantons and Principality of Liechtenstein (FL). https://github.
com/openZH/covid_19; 2020. Online.
[20] Bundesamtes

für

Gesundheit

.

vom Bundesamtes für Gesundheit.

Coronavirus:

Informationen

https://www.bag.admin.ch/

bag/de/home/krankheiten/ausbrueche-epidemien-pandemien/
480

aktuelle-ausbrueche-epidemien/novel-cov.html; 2020. Online.
[21] Angulo FJ, Finelli L, Swerdlow DL. Reopening Society and the Need
for Real-Time Assessment of COVID-19 at the Community Level. JAMA
2020;323(22):2247–8. doi:10.1001/jama.2020.7872.
[22] Buhat CAH, Duero JCC, Felix EFO, Rabajante JF, Mamplata JB. Opti-

485

mal allocation of covid-19 test kits among accredited testing centers in the
philippines. medRxiv 2020;0. doi:10.1101/2020.04.14.20065201.
[23] World Health Organization .

Q&A: Inﬂuenza and COVID-19 - simi-

larities and diﬀerences. https://www.who.int/emergencies/diseases/
novel-coronavirus-2019/question-and-answers-hub; 2020. Online.
490

[24] Stringhini S, Wisniak A, Piumatti G, Azman AS, Lauer SA, Baysson H,
et al. Seroprevalence of anti-sars-cov-2 igg antibodies in geneva, switzerland
(serocov-pop): a population-based study. The Lancet 2020;396(10247):313
–9. doi:https://doi.org/10.1016/S0140-6736(20)31304-0.
[25] Launch of the ﬁrst rapid test for COVID-19 on the Swiss mar-

495

ket.

https://www.startupticker.ch/en/news/april-2020/

launch-of-the-first-rapid-test-for-covid-19-on-the-swiss-market;
2020. Online.

24

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Supplementary Information
Optimal Allocation of Limited Test Resources for
the Quantification of COVID-19 Infections
Michail Chatzimanolakisa,∗, Pascal Webera,∗, George Arampatzisa ,
Daniel Wälchlia , Ivica Kičića , Petr Karnakova , Costas Papadimitrioub ,
Petros Koumoutsakosa,c,∗∗
a Computational

Science and Engineering Laboratory, ETH Zurich, Clausiusstrasse 33,
CH-8092, Switzerland
b Department of Mechanical Engineering, University of Thessaly, Pedion Areos, GR-38334
Volos, Greece
c School of Engineering and Applied Sciences, Harvard University, Cambridge, MA 02138,
USA

1. Materials and Methods
The optimal time (day) and location (canton) for surveying a population
to detect infectious individuals is determined via Bayesian optimal experimental design [1]. This optimal testing allocation (OPALITS) relies on combining
Bayesian inference and utility theory with forecasting models of the epidemic.
We remark that the OPALITS does not depend on a particular epidemiological model or type of data. The methodology is applicable at all stages of the
epidemic (inception to re-occurrence). It can operate without data at the early
stages of the pandemic and takes advantage of data available at later stages of
the pandemic. The methodology is rendered computationally efficient using a
sequential optimization algorithm [2].
Bayesian Inference from randomized testing. We consider a testing campaign
including a set (s) of surveys si = (ki , ti ), i = 1, . . . My performed in location
ki ∈ C and on day ti ∈ T . These surveys measure a quantity of interest (QoI),
that is denoted by y(s) = (y1 , . . . , yMy ). Here, yi is the number of unreported
∗ These

authors contributed equally to this work.
author (petros@seas.harvard.edu)

∗∗ Corresponding

Preprint submitted to Medrxiv

November 9, 2020

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

infectious individuals, measured through survey si . The QoI can be predicted
e (here the SEI r I u R epidemiological model) that depends
by a model g(s, ϑ, ϑ)

e ∈ RÑ . The
on parameters of interest ϑ ∈ RN and nuisance parameters ϑ
distinction between model and nuisance parameters is discussed in later sections.
We note that both sets of parameters are uncertain and the proposed method
aims to reduce the uncertainty only in the parameters of interest.
A stochastic error term ε(s) links the model prediction with the QoI
e + ε(s) .
y(s) = g(s, ϑ, ϑ)

(1)

The error ε(s) is assumed to follow a zero-mean multivariate normal distribution
N (0, Σ) with covariance matrix Σ ∈ RMy ×My . The elements of the covariance
matrix (Σs,s′ ) correspond to surveys taken at s = (k, t) and s′ = (k ′ , t′ ) and are
given by
Σs,s′ = σt σt′



|t − t′ |
exp −
τ



δkk′ ,

(2)

where δkk′ is the Kronecker delta, which is 1 for k = k ′ and 0 otherwise. The
correlation time τ ∈ [0.5, 3.5] is considered a nuisance parameter. These assumptions about the covariance imply that surveys in different locations are
not correlated, while those in the same location have an exponentially decaying
temporal correlation. The latter avoids clustering of surveys in small time intervals [3]. The factor σt ∈ R is assumed proportional to the expectation of the
QoI, taken over all possible survey locations and over the range of model and
nuisance parameters
σt = c

K


1 X
e ,
E e g(si , ϑ, ϑ)
K i=1 ϑ,ϑ

(3)

where si = (i, t). The parameter c ∈ [0, 0.25] is considered a model parameter.
e
The expectation Eϑ,ϑ
e [ · ] is taken with respect to all parameters ϑ and ϑ that

e = p(ϑ)p(ϑ).
e
follow the prior probability distribution with density p(ϑ, ϑ)

e and s is
Under these assumptions, the conditional probability of y on ϑ, ϑ

given by

e s) = p
p(y|ϑ, ϑ,



1
−1
exp − z⊤ Σ(s) z ,
2
(2π)My |Σ(s)|
1

2

(4)

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

where |Σ(s)| is the determinant of the covariance matrix and z = y(s) −
e
g(s, ϑ, ϑ).

In the present study, the QoI measured by a survey is the number of unre-

ported infectious individuals in a particular canton on a particular date. This
implicitly assumes that there no restrictions on when the survey can be conducted and that there are no observational delays, which means the the QoI is
instantaneously obtained. Both assumptions are not restrictive however. Restrictions on the possible survey dates can be accounted for by simply excluding
those dates from the dates on which the utility function is evaluated. Also,
a delay of one day (meaning that two days are needed to survey a canton k,
starting from day t) would mean that y = (Iku (t) + Iku (t + 1))/2 is measured. In
other words, when there is a delay the measured quantity can still be mapped
to a model quantity, which allows us to perform Bayesian inference.

There

are several types of measurements (Rapid testing [4], PCR [5], Schwabs [6])
being proposed for testing asymptomatic individuals. We emphasize that our
methodology is compatible with any of these types. Data related issues such as
uncertainties, test sensitivities and delays in processing can be accommodated
in the Bayesian inference framework and in the input to the SEIR model.
Expected Information Gain. The most informative surveys y provide the least
uncertainty in the estimates of the model parameters ϑ. Starting with a userpostulated prior distribution p(ϑ), Bayesian learning is used to update the une s),
certainties in the model parameters leading to a posterior distribution p(ϑ|y, ϑ,

based on the information contained in the test data y. The Kullback–Leibler

e s) and the prior distributions
(KL) divergence between the posterior p(ϑ|y, ϑ,
p(ϑ) of the model parameters measures the distance between the two distri-

butions. Informative data produce posterior distributions that differ from the
prior; greater differences lead to higher information gain. Therefore, the most
informative data y correspond to the testing strategy (measurement locations
and times) with the highest information gain [7, 8].
The OPALITS is identified by maximizing a utility function [1]. One choice

3

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .


e s) = DKL p(ϑ|y, ϑ,
e s)kp(ϑ) quantifying the inis the KL divergence u(y, ϑ,
formation gain from the data [1]. However, since data are not available in the

experimental design phase, the utility function is selected here to be the ex

e s) over all data generated by the model
u(y, ϑ,
pected KL divergence Ey|ϑ,s
e

prediction error equation 1. Also, to account for the uncertainty in nuisance

e encoded in the prior distribution p(ϑ),
e the expectation is also
parameters ϑ,

e which results in the utility function [1]
taken with respect to ϑ,
h

i
e s) =
u(y, ϑ,
U (s) = Eϑ
e Ey|ϑ,s
e
!
ZZZ
e s)
p(ϑ|y, ϑ,
e s) dϑ p(y|ϑ,
e s) dy p(ϑ)d
e ϑ
e.
log
p(ϑ|y, ϑ,
p(ϑ)

(5)

By using Bayes’ theorem

e s) =
p(ϑ|y, ϑ,

e s) p(ϑ)
p(y|ϑ, ϑ,
,
e s)
p(y|ϑ,

(6)

the utility function can be simplified to
!
ZZZ
e s)
p(y|ϑ, ϑ,
e s) p(ϑ) p(ϑ)
e dy dϑ dϑ
e.
p(y|ϑ, ϑ,
U (s) =
log
e s)
p(y|ϑ,

(7)

e s) is the model evidence given by
measurements via s. The term p(y|ϑ,
Z
e
e s) p(ϑ) dϑ .
p(y|ϑ, s) = p(y|ϑ, ϑ,

(8)

Note that the expected utility only depends on the locations and times of the

The choice of the prior distribution p(ϑ) for the parameters allows to incorporate
prior knowledge from epidemiology. If no information is available from data, a
case encountered in the beginning of the infection, a uniform prior distribution
can be assumed. Table S5 summarizes our choice of prior distributions for all
the involved uncertain quantities. If data d of the daily number of reported
infectious individuals is available, Bayesian inference can be used to inform the
prior distribution, as described later on. In this case, the prior p(ϑ) in equation
7 is replaced by the distribution p(ϑ|d) informed from the data d.
In the present work, the assumed nuisance parameters are the correlation
time τ and the initial condition of the unreported infections in the cantons
4

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

of Aargau, Bern, Basel-Landschaft, Basel-Stadt, Fribourg, Geneva, Grisons,
St.Gallen, Ticino, Vaud, Valais and Zurich
u
u
u
u
u
u
u
u
u
u
u
u
, IBE
, IBL
, IBS
, IFR
, IGE
, IGR
, ISG
, ITI
, IVD
, IVS
, IZH
)
I uIC = (IAR

with prior distributions I uIC ∼ U([0, 50]12 ) and τ ∼ U([0.5, 3.5]).
Epidemiological Model. Here we employ the SEI r I u R epidemiological model
[9] to forecast the dynamics of the coronavirus outbreak in Switzerland
K

K

l=1

l=1

X Mkl Sl
X Mlk Sk
dSk
βSk Ikr
µβSk Iku
=−
−
+θ
−θ
r
dt
Nk
Nk
Nl − I l
Nk − Ikr
dEk
=
dt

βSk Ikr
Nk

+

µβSk Iku

Ek
Ir
dIkr
=α
− k
dt
Z
D

Nk

K
K
X
X
Ek
Mkl El
Mlk Ek
−
−
θ
+θ
Z
Nl − Ilr
Nk − Ikr
l=1

l=1

(9)
K

K

l=1

l=1

X Mkl I u
X Mlk I u
dIku
Ek
Iu
l
k
−
θ
= (1 − α)
− k +θ
dt
Z
D
Nl − Ilr
Nk − Ikr
dNk
=θ
dt

K
X

(Mkl − Mlk ) ,

l=1

where Sk , Ek , Ikr and Iku denote the number of individuals in canton k =
{1, . . . , K} that are susceptible, exposed, reported infectious and unreported
infectious, respectively. We denote by K the number of cantons (26 in Switzerland), by Nk the total population of the canton k, while the population mobility
between cantons k and l is denoted by Mkl with values obtained from the Swiss
Federal Statistical Office [10]. The model parameters are the transmission rate
(β), the relative transmission rate between reported and unreported infectious
individuals (µ), the virus latency period (Z), the infectious period (D), the
reporting rate (α) and the mobility factor (θ).
We employ different time-dependent expressions for the transmission rate
and the mobility factor for each stage of the epidemic. Constants are chosen for
the start of an epidemic while in the cases of monitoring of interventions, the

5

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

following expressions are used:


 b0 , 0 ≤ t ≤ δ 1
,
β(t) =

 b1 , δ 1 < t

θ(t) =



 θ0 ,

 θ1 ,

0 ≤ t ≤ δ1

,

(10)

δ1 < t

where b0 , b1 , θ0 and θ1 are the transmission rates and mobility factors before
and after the intervention. Time t = 0 corresponds to the 25th of February 2020,
and δ1 = 21 to the 17th of March 2020, when the lockdown was announced in
Switzerland [11]. Finally, for the third case (monitoring of a second outbreak)
we assume that

β(t) =




b0 ,






 b1 ,

0 ≤ t ≤ δ1
δ1 < t ≤ δ2




b2 ,





b (t),
3

, θ(t) =

δ2 < t ≤ δ3
δ3 < t




θ0 ,






 θ1 ,



θ2 ,





θ ,
0

0 ≤ t ≤ δ1
δ1 < t ≤ δ2

.

(11)

δ2 < t ≤ δ3
δ3 < t

As in equation 10, b0 is the transmission rate before the intervention while
b1 = c1 b0 and b2 = c2 b0 with c1 , c2 ∈ [0, 1] are the transmission rates after the
two interventions. Similarly, θ0 is the mobility factor before any interventions
took place, while θ1 = c3 θ0 and θ2 = c4 θ0 with c3 , c4 ∈ [0, 1] are the mobility
factors after the two interventions. Moreover, δ1 and δ2 correspond to the days
of the interventions. The day when the measures are loosened is denoted by δ3 .
After that day, the transmission rate is gradually increasing
b3 (t) = min(b2 + λ(t − δ3 ), b0 ) ,

(12)

with λ ∈ [0, 0.03], while the mobility factor regains its initial value of θ0 .
Estimation of the Expected Information Gain. The calculation of the expected
utility from equation 7 is performed with Monte-Carlo integration. Samples
e (i) ∼ p(ϑ),
e while
from the prior distribution are denoted by ϑ(i) ∼ p(ϑ) and by ϑ
e (i) , s),
samples on the measurement space are denoted by y (i,j) ∼ p(y|ϑ(i) , ϑ

where i ∈ {1, . . . , Nϑ } and j ∈ {1, . . . , Ny }. With these samples, an estimate of

6

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

the expected utility is computed as
"
Ny
Nϑ X
1 X
log
Û (s) =
Nϑ Ny i=1 j=1
p(y

(i,j)

e (i) , s
p y (i,j) |ϑ(i) , ϑ
e (i) , s)
p(y (i,j) |ϑ

 !#

,

Nϑ

1 X
e (i) , s .
|ϑ , s) :=
p y (i,j) |ϑ(n) , ϑ
Nϑ n=1

e (i)

(13)

e (i) , (i = 1, . . . , Nθ ), remain the
In our implementation the samples ϑ(i) and ϑ

e (i) ) are
same for different values of s. Thus, the model evaluations g(s, ϑ(i) , ϑ
only carried out once and are stored and used in the iteration process involved in
the optimization. This allows to separate the computational cost of the model
evaluation from the cost of computing the utility, which scales as O(Nϑ2 Ny ).
Optimal Location and Time of Testing. We define the optimal survey times and
locations as
s∗ = arg max Û (s) ,

(14)

s1 ,...,sMy

where s∗ = (s∗1 , . . . , s∗My ) with s∗i = (ki∗ , t∗i ) denote the locations ki∗ and times
t∗i for the optimal surveys with i ∈ {1, . . . , My }. For a grid search, the associated computational cost is O((KT )My ) and thus grows exponentially with the
number of surveys. This curse of dimensionality is avoided by using a sequential optimization method [2] to approximate the global optimum by iteratively
solving
s∗n = arg max Ûn (s) , ∀n = 1, . . . , My ,

(15)

s

where s = (k, t) is the location and time to be estimated sequentially starting
with n = 1 and

Ûn (s) = Û s ,

s = (s∗1 , . . . , s∗n−1 , s) .

Following this, we define the expected information gain for survey n as


Û1 (s),
n=1
∆Ûn (s) =

Ûn (s) − Ûn−1 (s∗ ), n > 1.
n−1
7

(16)

(17)

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Quantification of Uncertainty. A data informed prior p(ϑ|d) of the model pa
rameters ϑ can be computed from available data d = d1 , . . . , dMd , collected

at Md locations and days. Here, available data d refer to the daily number of
reported infectious individuals and they are contrasted from the data y of the
number of unreported infectious individuals. The latter are obtained from testing strategies at selected populations using optimal experimental design. The
e through the following
data is mapped via a distinct model output f (s, ϑ, ϑ)
error model



e ν) = N B di | f (si , ϑ, ϑ),
e ν ,
p(di |ϑ, ϑ,

i = 1, . . . , Md .

(18)

where N B is the negative binomial distribution with mean f and dispersion ν.
Also, si = (ki , ti ) is the location and time the data di was collected. The choice
of a different error model, compared to equation 1, is based on the assumption
that the data are independent and identically distributed. Such an assumption
would not be acceptable in the measurement model in equation 1, as it may
result in uncorrelated measurements that can become clustered in small time
intervals [3].

The data d = d1 , . . . , dMd are the daily number of reported infections per

canton in Switzerland [12] which corresponds to the following model quantity
Z ti +0.5
α
α
e
Eki (τ )dτ ≈ Eki (ti ) .
f (si , ϑ, ϑ) :=
(19)
Z
Z
ti −0.5

The posterior distribution that will be used subsequently as a data informed
prior is obtained using Bayes’ theorem
e
p(ϑ, ϑ|d)
=

e p(ϑ, ϑ)
e
p(d|ϑ, ϑ)
,
p(d)

(20)

and is sampled with a nested sampling algorithm [13]. Note the difference
to equation 6 and the optimal testing methodology, where we are interested
e s), which excludes the nuisance paramto reduce the uncertainty in p(ϑ|y, ϑ,
e
eters ϑ.

For the dispersion parameter in equation 18, it is assumed that

e The coefficient r is unknown and included in the parameν = r f (si , ϑ, ϑ).

ter set, where r ∼ U([0, 2]).

8

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

b

Z

D

16

0.30

2
0.30

1.0

0.5

0.0

8

1

0.8

1.2

1.6

0

0.15

0.15

0.3

0.6

0.9

u
IAG

0

0.08

u
IBE

0.16

0.24

0.00

2

u
IBL

4

6

0.00

2

4

6

u
IBS

0.030
0.050
1.2

0.04

0.04

0.02

0.02

0.015
0.025

0.6

0.0

0.8

u
IFR

0.000

1.2

0

20

40

u
IGE

0.04

0.00

20

u
IVD

40

0.00

0.000

20

u
IVS

40

0

20

40

0.00

40

0.00

0

20

u
ISG

40

0.00

0

20

ITIu

40

0.050

0.025

0.000

0

20

u
IZH

40

15

30

0.000

0

20

40

0.00

20

40

10

0.025

0

0.000

0.03

r

0.050

0.04

0.03

u
IGR

0.015

0.08

0.06

20

0.06

0.025

0

0

0.030

0.050

0.02

0.000

5

0

20

40

0

0.1

0.2

0.3

Figure 1: Marginal posterior distributions with data up to 17th of March 2020. The
used data correspond to the daily reported infectious persons in the cantons of Switzerland.
u (t = 0) for the
The marginals with a canton label XY correspond to the initial condition IXY

unreported cases in that canton.

The three inferences performed are summarized in table S5, which shows the
involved model parameters in each case. The histograms for the found samples
are shown in figures S1, S2, and S3.
We remark that, using the present methodology, the inferred date for the
beginning of the intervention is δ1 = 22.5, which is the 18th of March 2020,
corresponding well with the 17th of March 2020 on which the lockdown was
introduced in Switzerland [11]. Moreover, we infer a significant reduction in the
mobility factor, which indicates that traffic between cantons was also minimized.
For the inference III we plot the fit using the inferred parameters in figure S4.
The daily reported cases per canton are shown, together with the data used for
the inference.

9

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

b

Z

D

30
2

1.0

3.0
0.4

15
1

0

1.5

0.8

1.2

1.6

0.5

0.2

0.0

0.6

0.8

1.0

0

0.08

b

0.0

0.12

3.0

4.5

6.0

0.0

4

5

6

b

0.8

6

12

6

3

6

3

0

0.60

0.75

0.90

0

1.0

0.2

0.3

0.4

0

0.4

0.5

0.08

0.16

0.24

u
IAG

0.0

22.4

u
IBE

0.0

23.2

36.0

u
IBL

37.5

16
5.0

0.10

0.50

0.06

2.5

0.05

0.25

0.03

8

0
0.00

0.15

0.30

u
IBS

0.0

0.25

0.50

0.75

u
IFR

0.00

0

15

30

u
IGE

0.00

0.0

2.5

u
IGR

0.00

5.0

0

15

30

u
ISG

0.30
0.050

0.025

0.000

0.12

0.8

15

30

ITIu

0.0

0.15

0.06

0.4

0

0.2

0.0

2.5

u
IVD

0.00

5.0

0.1

30

40

50

u
IVS

0.00

4

8

12

u
IZH

0.0

0

5

10

r

30
0.2

0.02

0.06

0.00

0.06

0.04

0.12

16

24

0.00

15

30

45

0.0

15

0.03

0.1

5

10

0.00

15

30

0

0.24

0.28

Figure 2: Marginal posterior distributions with data up to 6th of June 2020. The
used data correspond to the daily reported infectious persons in the cantons of Switzerland.
u (t = 0) for the
The marginals with a canton label XY correspond to the initial condition IXY

unreported cases in that canton.

10

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

b

Z

3.0

40

D

0.6
6

1.2

1.5

20

0.6

0.0

0.8

1.2

1.6

0.0

0.50

0.3

0

0.75

0.06

0.0

0.09

b

3

2

0

4

5.0
8

0.4

4

0.60

0.75

6.0

0.6

2.5

0

5.6

0.8

6

3

5.2

b

0.0

0.30

0
0.08

0.45

0.16

0.24

0.3

0.0

22.4

23.2

u
IAG

24.0

0.0

36.0

37.5

u
IBE

5.0

16

80

0.50
0.12

2.5

8

0
0.00

0.15

0.30

u
IBL

0.06

0.0

0.25

0.50

u
IBS

0.75

0

0.000

15

u
ISG

0

0.016

u
IFR

0.024

0.5

0.025

0

15

30

ITIu

0.0

0.25

0.06

1.0

0.050

0.03

0.00

40

0.0

1.5

u
IVD

3.0

0.00

0

15

30

u
IGE

0.16

0.30

0.08

0.15

0.00

32

40

48

u
IVS

0.30

0.04

4

8

0.00

6

8

u
IGR

u
IZH

9

0.04

0.08

0

0.00

4

0.2

0.02

0.00

0

0.08

0.16

0.15

0.00

12

18

24

0.00

0.1

0

20

40

0.0

5

10

0.00

0

15

30

r

30

15

0

0.24

0.28

Figure 3: Marginal posterior distributions with data up to 9th of July 2020. The
used data correspond to the daily reported infectious persons in the cantons of Switzerland.
u (t = 0) for the
The marginals with a canton label XY correspond to the initial condition IXY

unreported cases in that canton.

11

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

AI

14

b2

Fe

5

Ma

4

r2

Ap

1

r2

100

60

80

40

60

Infections

50
30
20

Ma
FR

9

y1

Jun

16

Jul

14

b
Fe

40

0

4

1

r2

Ap

25

Ma
JU

9

y1

Jun

16

Jul

14

b2

Fe

5

Ma

4

r2

1

r2

Ap

9

y1
Ma
LU

6

1
Jun

Jul

14

10

30
20

0

0

0

Fe

Ma

Ap

9
y1

Ma
SG

6
n1

Ju

5
b2

14
Jul

Fe

Ma

4
r2

1
r2

Ap

9
y1

Ma
SH

16
Jun

Ju

r

Ma

24

r

Ap

21

300

Ma
TI

y

19

Jun

16

Jul

14

b

Fe

200

Infections

Infections

250

150
100

9

y1

Ma
NE

Jun

16

Jul

14

Ma

1
r2
Ap

9
y1

Ma
SO

Ju

6
n1

Ju

30
20
0

25

Ma

r

24

r

Ap

21

y
Ma
UR

19

Jun

16

Jul

14

b
Fe

6

1
Jun

Jul

14

r
Ma

24

r
Ap

21

9

y1
Ma
NW

Jun

16

Jul

14

r
Ap

9

21

y1
Ma
GR

21

y1
Ma
OW

21

y1
Ma
TG

21

y1
Ma
ZG

Jun

16

Jul

14

20

Ma

1
r2

Ap

9
y1
Ma

Ju

6
n1

4
l1

b2
Fe

Ju

10

r

Ma

24

r
Ap

21

y
Ma
VD

19

Jun

16

Jul

14

b
Fe

Jun

16

Jul

14

b
Fe

25

r
Ma

24

r
Ap

21

y
Ma

19

Jun

16

Jul

14

r
Ap

21

y
Ma
VS

19

Jun

16

Jul

5

14

60
40

b
Fe

16

Jul

14

0
r
Ma

24

b2
Fe

20

19

Jun

10

25

25

100

9

20

30

150

r
Ap

30

80

y
Ma

14

40

20

0
25

4

50

100

21

Jul

0.0
4
r2

120

r
Ap

16

5.0

200

24

Jun

7.5

250

r
Ma

r2
Ma

9

10.0

300

25

5

r
Ap

12.5

10.0
5.0

r2
Ma

15.0

12.5
7.5

4

5

17.5

15.0

b
Fe

4

r2

Ma

40

b2
Fe

30

40

0

19

b2
Fe

SZ

0

y
Ma

5

14

0
25

Fe

0.0
21

Jul

60

5
b2

4
l1

0
r
Ap

16

2.5
4
r2

20

24

Jun

5

50

r
Ma

9

y1
Ma
GL

10

2.5
25

21

5

50

b
Fe

r
Ap

10

b
Fe

10

Infections

b

10

0
25

21

50

15

5

0

r
Ap

60

Infections

Infections

Infections

20

24

0

Fe

20

40

r
Ma

15

5
b2

4
l1

25
60

24

20
10

1
r2

r
Ma

30

10
4
r2

25

40

5

5
b2

0
25

0

50
Infections

40

Infections

50

15

b
Fe

15

b
Fe

60

20

14

Jul

100

0
r2

16

Jun

150

0
Ma

9

y1

Ma
GE

200

50

5

1

r2
Ap

250

20

b2

4

r2
Ma

300

10

Fe

25

Infections

Jul

Infections

6

1
Jun

20

0

Infections

9

y1
Ma
BS

40

Infections

1

r2

Ap

60

20

Infections

4

r2

Ma

40

0

Infections

5

60

Infections

0

80

5

Infections

0

10

Infections

2

80

100
Infections

4

20

b2
Fe

Infections

6

BL
100

120

15

8

Infections

Infections

Infections

40

Fe

BE
140

20

10

60

Infections

AR

12

80

Infections

AG
100

4

r2

Ma

r
Ap

9

Jun

16

Jul

14

15
10
5
0

25

r
Ma

24

r
Ap

21

9

y1
Ma

Jun

16

Jul

14

5

b2
Fe

4

r2

Ma

r
Ap

21

9

y1

Ma

Jun

16

Jul

14

ZH

Infections

200
150
100
50
0
5

b2

Fe

Ma

4

r2

1

r2

Ap

9

y1

Ma

Jun

16

4

1
Jul

Figure 4: Maximum a-posteriori prediction with data up to 9th of July 2020. The
red points correspond to the daily reported cases per cantons and the blue curve shows the
maximum a-posteriori prediction. The 99% confidence interval is plotted in green and based
on the sample shown in figure S3.

12

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

AI

JU

9
r0

Ma

u

6
b2

Fe

1
r0

Ma

SG

1

r0

Ma

5

r0

Ma

r0

Ma

1

5

r0

Ma

5

r0
Ma

5

r0
Ma

r0

Ma

9

u

6

b2

Fe

r0

Ma

1

1
r0

Ma

Ma

u
u

6
b2

5

r0

Ma

9
r0

Ma

5

r0

Ma

r
Ma

0

09

b
Fe

1
r0

Ma

5
r0

Ma

Ma

6

b2
Fe

1
r0

Ma

1

r0

Ma

b
Fe

26

1

r0

Ma

5
r0

9
r0

Ma

9
r0

Ma

b
Fe

0
b
Fe

5

r0

Ma

9
r0

Ma

TG
500

26

1

r0

Ma

5

r0

Ma

r
Ma

0

09

b
Fe

26

1

r0

Ma

VS

Ma

5

r0

Ma

25
0

9
r0

5

r0

Ma

9
r0

Ma

ZG
200

1000

2000
0

26

OW

200
0

9
r0

9
r0

Ma

50

Fe

Ma

5

r0

Ma

1000

SZ

5
r0

Ma

1

r0

Ma

I

1

r0

Ma

VD

20
0

I

u

I
u

Ma

I

u

1

r0

Ma

6

b2
Fe

UR
I

6

Ma

26

GR

50
0

9
r0

u

0

9
r0

Ma

40

b2

5
r0

u

6

b2

Fe

TI
500

Fe

1
r0

500

0

9

r0
Ma

26

SO

100

1000
0

I

6
b2
Fe

Ma

b
Fe

NW

I

u

I

I

6

b2

Fe

Ma

0

9
r0

b
Fe

200

SH

1000
0

5
r0

9
r0

Ma

0

09

50

NE

400
I

0

9
r0
Ma

5
r0

Ma

r
Ma

GL

0

I

Ma

5
r0

1
r0

Ma

5

r0

Ma

u

1
r0

6

b2
Fe

Ma

500

u

6
b2

Fe

u

5

r0

Ma

1

r0

Ma

100

1000
0

I

u

I

50
0

u

2000

LU

100

GE

26

u

1

b
Fe

u

r0

Ma

0

9
r0

Ma

I

6

b2

Fe

5
r0

Ma

u

9

r0
Ma

1
r0

Ma

I

FR

0

6

b2
Fe

500

I

5

r0

Ma

0

9
r0

Ma

I

1

r0

Ma

5

r0

Ma

BL

1000

1000

u

u

6

1

500

I

u

I

250
b2

r0

Ma

1000

500

Fe

6

b2

Fe

BS

0

u

0

9

r0
Ma

BE
2000

100

I

5

r0

Ma

u

1

r0

Ma

I

6

b2

Fe

20

I

u

0

I

AR

40
I

I

u

AG
1000

26

1

r0

Ma

5

r0

Ma

r
Ma

09

100
0
b
Fe

26

1

r0

Ma

5

r0

Ma

9
r0

Ma

I

u

ZH
2000
0

6

b2

Fe

1

r0

Ma

r0

Ma

9

Figure 5: Comparison of prediction uncertainty per canton. The predictions are based
on optimal strategies and non-specific testing for collection of data. They are also based on
the SEI r I u R model output. The error bounds show the 99% confidence intervals of the
unreported infectious model output for samples of the parameters with data obtained by
optimal (purple) and standard testing (gray). The black dots show the actual unreported
infectious for an artificial spread in Switzerland.

13

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

JU

Ma

5
r0

Ma

u

0

9
r0
Ma

6
b2

Fe

1
r0

Ma

SG

5
r0

Ma

6

b2

Fe

1

r0

Ma

5

r0

Ma

9

r0
Ma

6

b2

Fe

r0

Ma

1

1

r0

Ma

5

r0
Ma

5

r0
Ma

r0

Ma

9

0

6

b2

Fe

r0

Ma

1

u

u

I

Ma

1

r0

Ma

6
b2

1
r0

Ma

5

r0

9
r0

Ma

r
Ma

0

09

b
Fe

5
r0

9
r0

5
r0

Ma

Ma

6

1
r0

Ma

b
Fe

b
Fe

26

1

r0

Ma

5
r0

9
r0

Ma

9
r0

Ma

0
b
Fe

5

r0

Ma

9
r0

Ma

TG
500

26

1

r0

Ma

5

r0

Ma

r
Ma

0

09

b
Fe

26

1

r0

Ma

VS

Ma

5

r0

Ma

100
0

9
r0

26

1

r0

Ma

5

r0

Ma

9
r0

Ma

ZG

1000

b2
Fe

1

r0

Ma

OW

200
0

Ma

2000
0

26

SZ

VD

Ma

5

r0

Ma

200

400

Ma

9
r0

Ma

1000

u

26

Fe

u

1
r0

Ma

5

r0

Ma

I

u

I

Ma

I

I

u

100

6

6

b2
Fe

UR
200

b2

9
r0

Ma

u

TI

5

r0

Ma

0

1

r0

Ma

GR

100
0

9
r0

u

0

500

Fe

Ma

5
r0

500

100

1000
0

1
r0

26

NW

I

u

I

I

0

b
Fe

SO

200

b
Fe

200

SH

1000

9
r0

Ma

200
6
b2
Fe

Ma

5
r0

Ma

NE

0

9
r0

0

09

100
0

I

Fe

1
r0

1
r0

Ma

400

500

I

u

6
b2

6

b2
Fe

I

u

I

100
0

u

9
r0

r
Ma

200

0

Ma

5

r0

Ma

GL

1000

LU

200

u

5

r0

Ma

1

r0

Ma

u

1

26

I

r0

Ma

b
Fe

u

6

b2

Fe

0

9
r0

Ma

GE

2000

500

5
r0

Ma

u

9

r0
Ma

1
r0

Ma

I

FR

0

6

b2
Fe

500

I

5

r0

Ma

0

9
r0

Ma

BL

1000

u

1

r0

Ma

5

r0

Ma

1000

I

6

1

2000

100

u

u

I

u

I

250
b2

r0

Ma

1000

500

Fe

6

b2

Fe

BS

0

u

0

9

r0
Ma

BE

200

I

5

r0

Ma

u

1

r0

Ma

I

6

b2

Fe

I

u

0

I

AR

100

I

AI
200
I

I

u

AG
1000

5

r0

Ma

r
Ma

09

200
0
b
Fe

26

1

r0

Ma

5

r0

Ma

9
r0

Ma

I

u

ZH
2000
0

6

b2

Fe

1

r0

Ma

r0

Ma

9

Figure 6: Comparison of propagated uncertainty per canton. The predictions are
based on optimal strategies and non-specific testing. The SEI r I u R model output with added
model error for the unreported infectious is shown. The error bounds show the 99% confidence
intervals of the model output with added model error for samples of the parameters with data
obtained by optimal (purple) and standard testing (gray). The black dots show the actual
unreported infectious for an artificial spread in Switzerland.

14

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Maximum of Expected Information Gain
Canton 1st

measure-

2nd

measure-

3rd

measure-

4th

measure-

ment

ment

ment

ment

AG

2.297 (01-03)

1.080 (27-02)

0.530 (28-02)

0.436 (27-02)

AI

0.240 (03-03)

0.167 (28-02)

0.152 (27-02)

0.123 (28-02)

AR

0.538 (03-03)

0.189 (28-02)

0.157 (03-03)

0.127 (26-02)

BE

2.547 (02-03)

1.130 (27-02)

0.558 (03-03)

0.432 (28-02)

BL

2.224 (29-02)

1.099 (27-02)

0.567 (28-02)

0.458 (28-02)

BS

1.930 (29-02)

0.969 (27-02)

0.545 (27-02)

0.445 (27-02)

FR

2.046 (01-03)

0.983 (27-02)

0.533 (28-02)

0.424 (27-02)

GE

2.338 (02-03)

1.074 (27-02)

0.512 (03-03)

0.410 (28-02)

GL

0.344 (03-03)

0.171 (28-02)

0.152 (27-02)

0.124 (01-03)

GR

2.174 (01-03)

1.039 (27-02)

0.517 (29-02)

0.416 (28-02)

JU

0.408 (03-03)

0.176 (29-02)

0.154 (01-03)

0.125 (03-03)

LU

1.220 (03-03)

0.340 (29-02)

0.225 (01-03)

0.173 (01-03)

NE

0.828 (03-03)

0.234 (29-02)

0.176 (01-03)

0.137 (01-03)

NW

0.246 (03-03)

0.168 (01-03)

0.152 (02-03)

0.123 (03-03)

OW

0.225 (03-03)

0.168 (03-03)

0.152 (02-03)

0.124 (03-03)

SG

2.067 (01-03)

0.981 (27-02)

0.519 (28-02)

0.425 (27-02)

SH

0.456 (03-03)

0.182 (29-02)

0.156 (01-03)

0.126 (01-03)

SO

1.515 (03-03)

0.455 (28-02)

0.256 (27-02)

0.199 (27-02)

SZ

0.785 (03-03)

0.221 (29-02)

0.167 (29-02)

0.134 (28-02)

TG

1.214 (03-03)

0.334 (28-02)

0.209 (28-02)

0.163 (28-02)

TI

2.362 (02-03)

1.077 (27-02)

0.516 (03-03)

0.409 (28-02)

UR

0.210 (03-03)

0.167 (03-03)

0.152 (02-03)

0.124 (28-02)

VD

2.666 (02-03)

1.233 (27-02)

0.594 (03-03)

0.314 (29-02)

VS

2.254 (01-03)

1.061 (27-02)

0.514 (28-02)

0.417 (28-02)

ZG

0.701 (03-03)

0.206 (28-02)

0.161 (29-02)

0.130 (28-02)

ZH

2.721 (02-03)

1.187 (27-02)

0.556 (28-02)

0.449 (27-02)

Table 1: Maximum expected information gain for outbreak of a new disease. The
corresponding optimal dates are shown in parenthesis.

15

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Maximum of Expected Information Gain
Canton 1st

measure-

2nd

measure-

3rd

measure-

4th

measure-

ment

ment

ment

ment

AG

2.307 (30-03)

1.128 (17-03)

0.399 (30-03)

0.264 (30-03)

AI

0.211 (30-03)

0.169 (17-03)

0.146 (21-03)

0.112 (26-03)

AR

0.474 (30-03)

0.205 (17-03)

0.154 (29-03)

0.115 (29-03)

BE

2.927 (30-03)

1.738 (17-03)

0.691 (17-03)

0.459 (17-03)

BL

1.663 (30-03)

0.710 (17-03)

0.241 (17-03)

0.167 (17-03)

BS

1.359 (30-03)

0.518 (17-03)

0.196 (17-03)

0.140 (17-03)

FR

2.149 (30-03)

1.093 (17-03)

0.256 (17-03)

0.176 (17-03)

GE

2.825 (29-03)

1.760 (17-03)

0.483 (21-03)

0.327 (21-03)

GL

0.364 (30-03)

0.183 (17-03)

0.149 (28-03)

0.114 (29-03)

GR

1.783 (30-03)

1.256 (17-03)

0.754 (17-03)

0.222 (21-03)

JU

0.736 (30-03)

0.251 (17-03)

0.163 (30-03)

0.121 (30-03)

LU

1.830 (30-03)

0.738 (17-03)

0.316 (30-03)

0.210 (30-03)

NE

1.573 (30-03)

0.626 (17-03)

0.205 (17-03)

0.145 (17-03)

NW

0.369 (30-03)

0.181 (17-03)

0.149 (30-03)

0.114 (29-03)

OW

0.332 (30-03)

0.176 (17-03)

0.148 (30-03)

0.114 (29-03)

SG

2.056 (30-03)

1.003 (17-03)

0.471 (17-03)

0.247 (17-03)

SH

0.625 (30-03)

0.215 (17-03)

0.158 (29-03)

0.119 (30-03)

SO

1.642 (30-03)

0.663 (17-03)

0.224 (30-03)

0.155 (30-03)

SZ

1.066 (30-03)

0.330 (17-03)

0.186 (30-03)

0.135 (30-03)

TG

1.495 (30-03)

0.548 (17-03)

0.250 (30-03)

0.168 (30-03)

TI

2.640 (29-03)

1.639 (17-03)

0.668 (17-03)

0.436 (17-03)

UR

0.315 (30-03)

0.175 (17-03)

0.148 (29-03)

0.114 (29-03)

VD

3.139 (30-03)

1.961 (17-03)

0.415 (22-03)

0.311 (23-03)

VS

2.313 (30-03)

1.251 (17-03)

0.397 (17-03)

0.264 (17-03)

ZG

0.920 (30-03)

0.285 (17-03)

0.172 (30-03)

0.127 (30-03)

ZH

2.980 (30-03)

1.695 (17-03)

0.735 (17-03)

0.494 (17-03)

Table 2:

Maximum expected information gain of non-pharmaceutical interven-

tions. The corresponding optimal dates are shown in parenthesis.

16

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Maximum of Expected Information Gain
Canton 1st

measure-

2nd

measure-

3rd

measure-

4th

measure-

ment

ment

ment

ment

AG

1.356 (13-06)

0.434 (06-06)

0.292 (06-06)

0.210 (13-06)

AI

0.171 (13-06)

0.167 (09-06)

0.159 (09-06)

0.142 (08-06)

AR

0.207 (13-06)

0.169 (08-06)

0.159 (08-06)

0.142 (11-06)

BE

1.877 (13-06)

0.746 (06-06)

0.435 (06-06)

0.339 (13-06)

BL

0.712 (13-06)

0.236 (07-06)

0.186 (06-06)

0.156 (13-06)

BS

0.512 (13-06)

0.202 (06-06)

0.172 (06-06)

0.148 (13-06)

FR

0.973 (13-06)

0.330 (06-06)

0.208 (13-06)

0.184 (13-06)

GE

1.490 (13-06)

0.644 (06-06)

0.381 (13-06)

0.328 (13-06)

GL

0.189 (13-06)

0.168 (08-06)

0.159 (12-06)

0.142 (08-06)

GR

0.567 (13-06)

0.219 (06-06)

0.173 (06-06)

0.152 (13-06)

JU

0.255 (13-06)

0.173 (07-06)

0.161 (06-06)

0.143 (13-06)

LU

0.936 (13-06)

0.286 (07-06)

0.213 (06-06)

0.168 (13-06)

NE

0.576 (13-06)

0.222 (06-06)

0.172 (13-06)

0.153 (13-06)

NW

0.193 (13-06)

0.168 (07-06)

0.159 (06-06)

0.142 (08-06)

OW

0.187 (13-06)

0.167 (06-06)

0.159 (07-06)

0.142 (11-06)

SG

1.084 (13-06)

0.330 (06-06)

0.238 (06-06)

0.179 (13-06)

SH

0.247 (13-06)

0.172 (07-06)

0.161 (06-06)

0.142 (07-06)

SO

0.701 (13-06)

0.235 (06-06)

0.184 (06-06)

0.154 (13-06)

SZ

0.403 (13-06)

0.187 (07-06)

0.167 (06-06)

0.145 (13-06)

TG

0.651 (13-06)

0.223 (06-06)

0.183 (06-06)

0.153 (13-06)

TI

1.241 (13-06)

0.539 (06-06)

0.367 (13-06)

0.322 (13-06)

UR

0.186 (13-06)

0.167 (09-06)

0.158 (09-06)

0.142 (08-06)

VD

1.881 (13-06)

0.873 (06-06)

0.505 (13-06)

0.443 (13-06)

VS

1.138 (13-06)

0.420 (06-06)

0.256 (13-06)

0.223 (13-06)

ZG

0.337 (13-06)

0.180 (07-06)

0.163 (07-06)

0.144 (13-06)

ZH

2.092 (13-06)

0.862 (06-06)

0.592 (06-06)

0.276 (09-06)

Table 3: Maximum expected information gain for monitoring of a second outbreak
with uninformed b3 . The corresponding optimal dates are shown in parenthesis.

17

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Assume we want to estimate the proportion of a population with some margin of error d and a small risk α, i.e., we want Pr(|P − p| ≥ d) = α. Here, the
proportion corresponds to the proportion of unreported infected population.
The minimum number of samples to achieve this is given by Cochran’s formula
[14],
n0 =

zα2
p(1 − p) ,
d2

where zα is the inverse of the standard normal cumulative distribution function
evaluated at 1 − α/2. In this formula, we have assumed that the population is
of infinite size. In order to correct for a finite size population N , we compute
n=

n0
.
1 + n0 /N

In the next figure we present the minimum number of samples needed to sample
the cantons of Switzerland for d = 0.01 and α = 0.01. Notice that α = 0.01
corresponds to a 99% confidence interval.
If the available test-kits are more than 26×5950 = 154700 then the maximum
information gain will be achieved by deploying all tests uniformly in all cantons.
However, when it is not realistic to conduct over 154700 tests, we consider
testing with limited resources. For example assuming 30000 available tests, will
be enough to test 5 cantons 5 × 5950. The question we answer then is which
5 cantons (from the 26) should we test given that we must test a minimum
population of 5950 per canton?.
Distributing less than a particular number of tests (5950) in a canton will not
provide a statistically reliable estimate for the number of unreported infections
there. Thus, in such a case, the measured unreported infections should not be
used to estimate the expected information gain.
Finally, we note that in this work we ignore the bias in the estimate of
I u . This means that the estimates of unreported infected enter the Bayesian
framework without explicitly accounting for this known error.

18

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Maximum of Expected Information Gain
Canton 1st

measure-

2nd

measure-

3rd

measure-

4th

measure-

ment

ment

ment

ment

AG

1.233 (17-07)

0.328 (10-07)

0.220 (17-07)

0.194 (10-07)

AI

0.170 (17-07)

0.167 (17-07)

0.154 (13-07)

0.136 (17-07)

AR

0.198 (17-07)

0.169 (10-07)

0.154 (14-07)

0.136 (16-07)

BE

1.596 (17-07)

0.460 (10-07)

0.347 (17-07)

0.267 (10-07)

BL

0.616 (17-07)

0.202 (10-07)

0.166 (17-07)

0.147 (10-07)

BS

0.441 (17-07)

0.184 (10-07)

0.159 (17-07)

0.141 (10-07)

FR

0.636 (17-07)

0.209 (10-07)

0.193 (17-07)

0.156 (17-07)

GE

0.896 (17-07)

0.326 (17-07)

0.308 (17-07)

0.225 (17-07)

GL

0.184 (17-07)

0.168 (13-07)

0.154 (17-07)

0.136 (10-07)

GR

0.418 (17-07)

0.182 (10-07)

0.162 (17-07)

0.141 (10-07)

JU

0.219 (17-07)

0.169 (10-07)

0.155 (17-07)

0.136 (17-07)

LU

0.834 (17-07)

0.234 (10-07)

0.178 (17-07)

0.157 (10-07)

NE

0.378 (17-07)

0.180 (10-07)

0.165 (17-07)

0.142 (17-07)

NW

0.187 (17-07)

0.168 (10-07)

0.154 (15-07)

0.135 (10-07)

OW

0.183 (17-07)

0.168 (10-07)

0.154 (10-07)

0.136 (12-07)

SG

0.994 (17-07)

0.267 (10-07)

0.191 (17-07)

0.169 (10-07)

SH

0.232 (17-07)

0.170 (10-07)

0.154 (15-07)

0.136 (11-07)

SO

0.581 (17-07)

0.197 (10-07)

0.166 (17-07)

0.145 (10-07)

SZ

0.362 (17-07)

0.178 (10-07)

0.157 (10-07)

0.139 (10-07)

TG

0.591 (17-07)

0.200 (10-07)

0.164 (17-07)

0.145 (10-07)

TI

0.556 (17-07)

0.318 (17-07)

0.296 (17-07)

0.224 (17-07)

UR

0.181 (17-07)

0.168 (11-07)

0.154 (16-07)

0.135 (16-07)

VD

1.297 (17-07)

0.452 (17-07)

0.433 (17-07)

0.281 (10-07)

VS

0.655 (17-07)

0.245 (17-07)

0.228 (17-07)

0.176 (17-07)

ZG

0.303 (17-07)

0.174 (10-07)

0.155 (15-07)

0.137 (11-07)

ZH

1.976 (17-07)

0.675 (10-07)

0.276 (14-07)

0.250 (13-07)

Table 4: Maximum expected information gain to monitor a second outbreak with
informed b3 . The corresponding optimal dates are shown in parenthesis.

19

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Parameter Prior distribution / fixed

Inference I

Inference II

value

Inference
III

b0

U ([0.8, 1.8])

yes

yes

yes

α

U ([0.01, 1])

yes

yes

yes

µ

U ([0.2, 1])

yes

yes

yes

Z

U ([1, 6])

yes

yes

yes

D

U ([1, 6])

yes

yes

yes

θ0

U ([0.5, 1.5])

yes

yes

yes

c1

U ([0, 1])

no

yes

yes

c2

U ([0, 1])

no

yes

yes

c3

U ([0, 1])

no

yes

yes

c4

U ([0, 1])

no

yes

yes

δ1

U ([20, 30])

no

yes

yes

δ2

U ([30, 40])

no

yes

yes

δ3

102

no

yes

yes

λ

U ([0, 0.03])

no

no

yes

r

U ([0, 2])

yes

yes

yes

yes

yes

yes

I uIC
Table 5:

12

U ([0, 50] )

Parameters and prior distributions used in Bayesian inference. Here the

data corresponds to the daily reported infections. In all cases, data are used from the 25th of
February 2020, when the first reported case was found in the canton of Ticino. Inference I uses
data up to the day non-pharmaceutical interventions were announced (17th of March 2020).
Inference II uses data up to the day measures were relaxed (6th of June 2020). Inference III
uses data up to the 9th of July 2020. The choice of prior distributions is consistent with the
choice found in [9]; the ranges used in our study are slightly extended.

20

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

6000
5800

estimated sample size

5600
5400
5200
5000
4800
4600
4400
4200
4000
ZH

BE

VD

AG

SG

GE

LU

TI

VS

FR

BL

TG

SO

BS

GR

NE

SZ

ZG

SH

JU

AR NW GL OW UR

AI

cantons

Figure 7: Estimated sample size using Cochran’s [14] formula for every canton for confidence
level 99%, margin of error 1% and probability of infection 0.1. The cantons are sorted in
descending order of their population. The maximum sample size is estimated for Zurich and
is equal to 5950. All the other cantons need up to 14% less samples with the exception of the
smallest canton that needs 27% less samples.

21

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

References
[1] Ryan EG, Drovandi CC, McGree JM, Pettitt AN. A review of modern computational algorithms for bayesian optimal design. International Statistical
Review 2016;84(1):128–54. doi:10.1111/insr.12107.
[2] Papadimitriou C. Optimal sensor placement methodology for parametric identification of structural systems.
tion 2004;278(4):923 –47.

Journal of Sound and Vibra-

doi:https://doi.org/10.1016/j.jsv.2003.

10.063.
[3] Papadimitriou C, Lombaert G. The effect of prediction error correlation
on optimal sensor placement in structural dynamics. Mechanical Systems
and Signal Processing 2012;28:105 –27. doi:https://doi.org/10.1016/
j.ymssp.2011.05.019; interdisciplinary and Integration Aspects in Structural Health Monitoring.
[4] Chau CH, Strope JD, Figg WD. COVID-19 Clinical Diagnostics and Testing Technology. Pharmacotherapy: The Journal of Human Pharmacology
and Drug Therapy 2020;40(8):857–68. doi:10.1002/phar.2439.
[5] Long C, Xu H, Shen Q, Zhang X, Fan B, Wang C, et al. Diagnosis of
the Coronavirus disease (COVID-19): rRT-PCR or CT? European Journal
of Radiology 2020;126:108961. doi:https://doi.org/10.1016/j.ejrad.
2020.108961.
[6] Heller L, Mota CR, Greco DB.

COVID-19 faecal-oral transmission:

Are we asking the right questions?

Science of The Total Envi-

ronment 2020;729:138919. doi:https://doi.org/10.1016/j.scitotenv.
2020.138919.
[7] Lindley D. On a measure of the information provided by an experiment. Annals of Mathematical Statistics 1956;27(4):986–1005. doi:{10.1214/aoms/
1177728069}.

22

medRxiv preprint doi: https://doi.org/10.1101/2020.11.09.20228320; this version posted November 10, 2020. The copyright holder for this
preprint (which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

[8] Karni E, Schmeidler D. Utility theory with uncertainty. In: Handbook of
Mathematical Economics; vol. 4. Elsevier; 1991, p. 1763–831.
[9] Li R, Pei S, Chen B, Song Y, Zhang T, Yang W, et al. Substantial undocumented infection facilitates the rapid dissemination of novel coronavirus (sars-cov-2). Science 2020;368(6490):489–93. doi:10.1126/science.
abb3221.
[10] Bundesamtes für Statistik . Commuters for work purposes. https://www.
bfs.admin.ch/bfsstatic/dam/assets/8507281/master; 2020. Online.
[11] Bundesamtes

für

Gesundheit

.

vom Bundesamtes für Gesundheit.

Coronavirus:

Informationen

https://www.bag.admin.ch/

bag/de/home/krankheiten/ausbrueche-epidemien-pandemien/
aktuelle-ausbrueche-epidemien/novel-cov.html; 2020. Online.
[12] Kanton Zürich, Statistisches Amt . SARS-CoV-2 Cases communicated by
Swiss Cantons and Principality of Liechtenstein (FL). https://github.
com/openZH/covid_19; 2020. Online.
[13] Speagle JS. Dynesty: a dynamic nested sampling package for estimating
bayesian posteriors and evidences. Monthly Notices of the Royal Astronomical Society 2020;493(3):3132–3158. doi:10.1093/mnras/staa278.
[14] Cochran W. Sampling Techniques. Wiley, New York; 1963.

23

