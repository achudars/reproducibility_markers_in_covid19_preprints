medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

System inference via field inversion for the spatio-temporal
progression of infectious diseases: Studies of COVID-19 in Michigan
and Mexico
Z. Wang, M. Carrasco-Teja, X. Zhang, G.H. Teichert & K. Garikipati∗
Mechanical Engineering, Mathematics and the Michigan Institute for Computational
Discovery & Engineering, University of Michigan
April 29, 2021

Abstract
We present an approach to studying and predicting the spatio-temporal progression of infectious diseases. We treat the problem by adopting a partial differential equation (PDE) version
of the Susceptible, Infected, Recovered, Deceased (SIRD) compartmental model of epidemiology, which is achieved by replacing compartmental populations by their densities. Building
on our recent work (Computational Mechanics, 66, 1177, 2020), we replace our earlier use of
global polynomial basis functions with those having local support, as epitomized in the finite
element method, for the spatial representation of the SIRD parameters. The time dependence
is treated by inferring constant parameters over time intervals that coincide with the time step
in semi-discrete numerical implementations. In combination, this amounts to a scheme of field
inversion of the SIRD parameters over each time step. Applied to data over ten months of 2020
for the pandemic in the US state of Michigan and to all of Mexico, our system inference via field
inversion infers spatio-temporally varying PDE SIRD parameters that replicate the progression
of the pandemic with high accuracy. It also produces accurate predictions, when compared
against data, for a three week period into 2021. Of note is the insight that is suggested on
the spatio-temporal variation of infection, recovery and death rates, as well as patterns of the
population’s mobility revealed by diffusivities of the compartments.

1

Introduction

Classical epidemiological models, such as the Susceptible-Infected-Recovered (SIRD) model [1], are
ordinary differential equations (ODEs) defined by specifying the compartmental sub-population
numbers over some geographical region. Spatial effects have typically been introduced by resolving
∗

Corresponding author, krishna@umich.edu

1
NOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice.

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

smaller regions and treating them individually[2–6]. During the long-lasting and widespread epidemics, such as the COVID-19 Pandemic, the effects on the infection rate of imposing–and then
lifting–mobility restrictions and social distancing mandates revolve on the question of the time and
spatially varying mobility of the population. At the finest resolution, this must be approached
via agent-based models[7], using individuals’ mobility data. However, this data is not available
for the entire population, and contact tracing campaigns face challenges of recruiting workers,
access, technology, as well as socio-political resistance. Against these difficulties, an intriguing
question to explore is whether simple reaction-diffusion models can detect the evidence of mobility
in these data. Such an approach must start with a partial differential equation (PDE) version of
the epidemiological models, which is easily defined by converting compartmental sub-populations
to densities over sub regions by normalizing with the corresponding areas. To address the mobility
of the population, diffusion terms are introduced to the SIRD model, which is transformed to a set
of reaction-diffusion PDEs in two spatial dimensions [8–11].
The widespread availability of data in the public domain [12–19] has spurred a widespread
interest among computational and data scientists, who have sought to test and refine their methods
against these repositories. This has opened up the possibility that advances in computational and
data science may contribute to the existing and rapidly expanding body of work in epidemiology,
in inferring the dynamics of COVID-19 and making projections. We have similarly sought to build
off our recent work in data-driven and machine learning approaches [20–29] and presented a class of
system identification techniques for inference of ODE and PDE forms of the SIRD model, as well as
Bayesian neural networks for representation and uncertainty quantification-guided prediction [11].
That work focused on the US state of Michigan. In this communication, we revise our approach for
inference of the PDE SIRD model with temporal and spatial evolving parameters and diffusivities.
Importantly, instead of global polynomial representations of PDE SIRD parameters over the spatial
and temporal domains, we adopt field inversion over time intervals that coincide with the time steps
of our underlying numerical implementation. This affords much greater accuracy over the global
polynomial ansatz. Adjoint-based gradient optimization for field inversion of parameters at each
time step replaces the use of stepwise regression-based system identification in our previous work.
We find that the improved accuracy with respect to the data over the time interval of inference, as
well as of the predictions, is worth the increased expense. We have brought abundant high-quality,
public domain, data [12–19] on the evolution of COVID-19 in both, the State of Michigan, with a
population of 9.98 million, distributed in 83 counties, over 250,493 km2 , and the country of Mexico,
with a population of 126 million, distributed in 32 geographical entities (31 states, plus Mexico
City), on 1,972,550 km2 . The temporal resolution by days and spatial resolution by counties/states
have allowed us to study the mobility in these data using our methods of system inference.
In Section 2 we review our previous work of system inference for the spatio-temporal SIRD
model first, and then extend it by incorporating temporal and spatial parameters and diffusivities

2

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

using a finite element representation. The PDE SIRD model-constrained inference are presented in
Section 3. Section 4 is on data preparation. The results for inference of classical SIRD parameters
as well as the diffusivities, and forward prediction are presented in Section 5. Our conclusions
appear in Section 6.

2

Compartmental differential equations models of infectious disease dynamics

We begin with the conventional SIRD compartmental epidemiology model. The population, taken
to remain constant at N , is divided into four disjoint compartments with time-dependent subpopulations: S(t) for susceptible, I(t) for infected, R(t) for recovered and D(t) for deceased individuals. The governing system of ordinary differential equations (ODEs) is:
β
dS
= − SI + γR
dt
N

(1)

dI
β
= SI − µI − αI
dt
N

(2)

dR
= µI − γR
dt

(3)

dD
= αI
dt

(4)

N = S(t) + I(t) + R(t) + D(t).

(5)

This is the canonical form of the model where the sub-populations are assumed to be well-mixed
so that spatial variations can be ignored over the domain of interest. Here β is the infection rate,
µ is the recovery rate, γ is the rate of immunity loss, and α is the death rate.
We have extended the SIRD model to a system of partial differential equations (PDEs) in
two spatial dimensions using the same compartments [11]. However, the population variables are
b t), I(x,
b t), R(x,
b
b
now replaced with spatio-temporally varying densities, S(x,
t), D(x,
t) defined as
numbers per unit area.

3

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

β
∂ Sb
b
= DS ∇2 Sb − SbIb + γ R
b
∂t
N

(6)

∂ Ib
β
= DI ∇2 Ib + SbIb − µIb − αIb
b
∂t
N

(7)

b
∂R
b + µIb − γ R
b
= DR ∇2 R
∂t

(8)

b
∂D
= αIb
∂t

(9)

where DS , DI , DR are diffusivities of the corresponding compartments, and represent the mobility of
c = (•)/ R dA where Ω is the domain of study:
the sub-population via random walks. We define (•)
Ω
either the lower peninsula of the State of Michigan, or the territory of the country of Mexico.
R
R
R
R
b dA =
b
b
b
Furthermore the population constraint holds: Ω N
S(t)dA
+ Ω I(t)dA
+ Ω R(t)dA
+
Ω
R
b
Ω D(t)dA. In what follows of this communication, we only consider the PDEs SIRD model, and,
for the sake of readability, we dispense with the hats on the compartments.
We adopt the weak form, and specifically, the finite element framework for the above system
of PDEs. For a generic, finite-dimensional field uh , the problem is stated as follows: find uh ∈
S h ⊂ S , where S h = {uh ∈ H 1 (Ω) | uh = ū on Γu }, such that ∀ wh ∈ V h ⊂ V , where
V h = {wh ∈ H 1 (Ω) | wh = 0 on Γu }, the finite-dimensional (Galerkin) weak form of the problem
is satisfied. The variations wh and trial solutions uh are defined component-wise using a finite
number of basis functions,
wh =

nb
X

ca N a ,

uh =

a=1

nb
X

da N a ,

(10)

a=1

where nb is the dimensionality of the function spaces S h and V h , and N a represents the basis
functions. To obtain the Galerkin weak forms, we multiply each equation in strong form in (6-9) by
h , w h , respectively, integrate by parts, apply boundary conditions
a weighting function wSh , wIh , wR
D
appropriately, and use the Backward Euler method for time-discretization with (•)n denoting a

4

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

(a) Michigan State

(b) Mexico

Figure 1: Reconstructed maps of Michigan State and Mexico with finite element mesh.
discretized quantity at time tn and ∆t being the time step. See Ref. [11] for details. This leads to:
Sh
wSh n

Z

h
− Sn−1
ds = −
∆t

Z

h
− In−1
ds = −
∆t

Z

h
Rnh − Rn−1
ds = −
∆t

Z

Ω

Ih
wIh n

Z
Ω

Z

h
wR

Ω

Z
Ω

h
wD

Dn − Dn−1
ds =
∆t

DS ∇wSh

·

∇Snh ds

Z
−

Ω



Ω

DI ∇wIh

·

∇Inh ds

Z

wIh

+

Ω

Z

wSh

Ω

h
DR ∇wR
· ∇Rnh ds +

Ω

Z




β h h
h
S I + γRn ds
N n n


β h h
h
h
S I − µIn − αIn ds
N n n



h
wR
µInh − γRnh ds

(11)

(12)

(13)

Ω

h
wD
αInh ds

(14)

Ω

where the boundary terms vanish because we assume that the sub-populations do not leave the
region–zero flux boundary conditions.
In our previous work [11], we have characterized the coefficients to vary via a global-in-time
polynomial basis. While the inferred model reproduced the trends, there was a notable error over
time of the statewide sub-populations estimates S(t, x), I(t, x), R(t, x), D(t, x) obtained by forward
simulation with inferred quantities (See Figure 14 and 15 in [11]).
Additionally, the highly complex geometry of the State of Michigan, and of Mexico (See maps
in Figure 1), and potentially highly nonuniform distributions of the coefficients in space makes it
5

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

challenging to characterize the coefficients with simple basis functions. Global polynomials in space
could not sufficiently resolve the emergence and disappearance of “hot spots” and “cold spots” [11].
In this communication, we allow the coefficients β, γ, µ, α, DS , . . . , DR of the PDE SIRD model to
vary over space via finite-dimensional, locally supported representations as we do for the primary
variables S(t, x), I(t, x), R(t, x), D(t, x). Further more, we allow the coefficients to vary daily,
leading to:
βnh

=

np
X

βna N a ,

γnh

=

a=1

DShn =

np
X

γna N a ,

µhn

=

a=1

np
X

DSan N a ,

np
X

µan N a

αnh

a=1

DIhn =

a=1

np
X

=

np
X

αna N a

(15)

a=1

DIan N a ,

h
DR
=
n

a=1

np
X

a
DR
Na
n

(16)

a=1

where, as for the primary variables, the subscripts (•)n denote the coefficients on day n. With this,
the PDE SIRD equations become:
h
− Sn−1
ds = −
∆t

Z

h
− In−1
ds = −
∆t

Z

h
− Rn−1
ds = −
∆t

Z

Sh
wSh n

Z
Ω

Ih
wIh n

Z
Ω

Z

h
h Rn
wR

Ω

Z
Ω

h Dn
wD

− Dn−1
ds =
∆t

Ω

Ω

Z

Ω

DShn ∇wSh

DIhn ∇wIh

·

∇Snh ds

Z

wSh

−



Ω

·

h
h
DR
∇wR
n

∇Inh ds

Z

wIh

+
Ω

·

∇Rnh ds

Z
+




βnh h h
h h
S I + γn Rn ds
N n n


βnh h h
h h
h h
S I − µn In − αn In ds
N n n



h
wR
µhn Inh − γnh Rnh ds

(17)

(18)

(19)

Ω

h h h
wD
αn In ds

(20)

Ω

where the PDE SIRD parameters are interpolated from nodal variables as defined in Equations
(15) and (16).

3

System inference by field inversion using adjoint-based gradient
optimization

a . Since
The system inference problem is to invert for the quantities βna , γna , µan , αna , DSan , . . . , DR
n
these quantities are interpolated via Equations (15) and (16) to be expressed as the corresponding
h in (17-18), the system inference problems is one of field inversion.
fields βnh , γnh , µhn , αnh , DShn , . . . , DR
n
It is stated in Equations (21-22) as:

6

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Given (15-16), at each tn :

a
βna , . . . , DR
n

n p
a=1

= arg

min

a ,...,D a )a=1np
(βn
Rn

`i ,

such that (17-20) hold
(21)

and `i is the loss function defined:
Z

2

2

2

2
`i = WS Snh − Snd + WI Inh − Iid + WR Rnh − Rnd + WD Dnh − Dnd dv

(22)

Ω

where (•)d denotes data for the corresponding quantity. Due to the large differences in the magnitudes of different sub-populations, we choose the weights WS , · · · , WD to be:
WS =

Ind
,
mean (Snd )

WI =

Ind
,
mean (Ind )

WR =

Ind
Ind
,
W
=
.
D
mean (Rnd )
mean (Dnd )

(23)

The weights normalize the sub-populations and prioritize regions with higher infected populations.
These regions are of greater interest for studying the progression of the disease as they tend to have
a higher population density and, therefore, infected populations.
This PDE-constrained optimization problem is solved iteratively, and requires the gradient of
the PDE constraint, Equations (17-20), with respect to parameters. We adopt classical adjointbased gradient optimization. This approach involves a single linear solution of the adjoint equation
of the original PDE constraint at each iteration, followed by solution of the fields to be inverted:
h ) and the updated forward solution S h , I h , Rh , D h . In this work we use
(βnh , γnh , µhn , αnh , DShn , . . . , DR
n n
n
n
n
the L-BFGS-B optimization algorithm from SciPy[30] and the dolfin-adjoint software library
[31] to compute the gradient.

4

Data preparation on maps of Michigan and Mexico

First, we constructed two-dimensional meshes for Michigan and Mexico that fully resolve the counties/states as shown in Figure 1. The data are available as cumulative sub-population numbers
Ind , Rnd , Dnd at the county/state level. We used a uniform density of each sub-population to compute
Ind , Rnd , Dnd within the county/state, and applied Gaussian filtering to smooth the discontinuities
at the county/state boundaries. Note that the discrete Gaussian filter can not be applied in a
straightforward manner to unstructured meshes. Starting with a field u that represents any of
||x||2
−
1
2σ 2
as the two dimensional Gaussian
the four sub-population densities, and G(x0 , x) = 2πσ
2e
distribution function centered at 0 with standard deviation σ, which is related to the kernel size in
the discrete Gaussian filter, we scale the filtered solution denoted by u(x0 ) at each finite element
node:
Z
1
G(x0 , x)uraw (x)dv
(24)
u(x0 ) = R
Ω G(x0 , x)dv Ω
The spatio-temporal evolution of these fields was used in the system inference problem as described
in Section 3.
7

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

5

Results

Figure 2 shows the sub-populations S(x, t), I(x, t), R(x, t), D(x, t) in both Michigan and Mexico
obtained by forward simulation with inferred quantities compared with data on December 29, 2020
(t = 281 days), where t = 0 is March 23, 2020, the start of the lockdown in Michigan. The inferred
model for Michigan accurately replicates the initial burst of disease and the following multiple
waves around Detroit (please see the SI movie: michigan prediction.mp4). It also captures the
second burst in the southwest of Michigan around the city of Grand Rapids. The high burden of
the disease in these, the largest and second largest cities, respectively, in Michigan, reflects wellknown socio-economic challenges related to Detroit in particular, and more generally reflected in
other urban centers. Similarly, Mexico City, with highest population density in Mexico (6, 200/km2
[18]), was the worst affected area in that country and dominated the evolution of the disease (See
SI movie: mexico prediction.mp4).
The low error between the simulation and data leads to greater confidence in the inferred parameters. Figure 3 shows the inferred infection rate, death rate and the recovery rate in Michigan
every 70 days starting from t = 0 (the time-resolved dynamics are shown in SI movie: michigan parameter.mp4). The evolution of these inferred parameters reveals that the population’s
infection rate, β(t), declined from the initially higher values in highly infected areas (such as Detroit), and spread to the western parts of Michigan. The death rate was mostly stable after May
2020 (t > 69), and remained low in the more highly infected areas. This can be attributed to the
ramp up of the public health campaign, hospitalizations and emergency response of the medical
system, and prioritization to the more highly infected areas. The recovery rate around Detroit
city evolved in multiple stages: increasing→ decreasing → increasing, which was consistent with
the multiple waves reflected in the data on the recovered population in this region (SI movie:
michigan prediction.mp4).
At the finest resolution, the mobility of the population during disease evolution may be approached via agent-based models refined to resolve individuals. However, given the difficulties
encountered in effective contact tracing, and its acceptance by the population [9, 32, 33], an intriguing question to explore is whether simple reaction-diffusion models can detect the evidence of
mobility in these data. Figure 4 shows the inferred diffusivities of the susceptible, infected, and
recovered sub-populations. Note that for field inversion, the population density data for each compartment was taken to be uniform within each county/state, since no finer grained information was
available, and then subject to Gaussian smoothing before inference. Thus the density gradients,
which drive the inference of diffusivities, arise at the counties/states scale more than they do at the
intra-county/intra-state. Accordingly, the inferred diffusivities are meaningful on this scale. The
lower Peninsula of Michigan is about 446 km long from north to south and 314 km wide from east
to west–scales that can help place the diffusivities in Figure 4 in perspective. The mobility of the
infected population was always high around the highly infected areas. In Michigan, this infected
8

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

(a) Michigan

(b) Mexico

Figure 2: Comparison of the data on distributions of the susceptible (S), infected (I), recovered
(R) and deceased (D) sub-populations against forward PDE SIRD simulations with inferred quantities respectively. Data and simulation results are shown for Day 281 starting from March 23,
2020. The inset adjacent to the map of Mexico is a magnified view of the region surrounding
Mexico City. The time-resolved dynamics may be
9 seen as movies in Supplementary Information:
michigan prediction.mp4 and mexico prediction.mp4.

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Figure 3: Inferred infection rate (β), death rate(α) and recovery rate (µ) over the lower peninsula
of Michigan starting from the lockdown on March 23, 2020. The time-resolved dynamics may be
seen as movies in Supplementary Information: michigan parameter.mp4.

10

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

population gradually shifted to the southwestern part of the state from the initial burst around
Detroit. This finding is consistent with the second burst around Grands during the evolution of
the pandemic. The recovered population demonstrated a similar pattern of mobility, and was more
active in the southern part of Michigan around the more highly infected regions. On the other
hand, susceptible population closely tracks the total population. Since the population at large has
low mobility, the susceptible population’s mobility is low in high population density areas. See SI
movie michigan prediction.mp4 for these dynamics.
Figure 5 show the inferred infection rate, death rate and the recovery rate of the inferred model
for Mexico. We can clearly see the spreading of the disease from Mexico City. Similar to the case of
Michigan, infection rates, and to a lesser extent, death rates, were relatively lower in Mexico City,
which is the most densely populated region of the country, than that in the surrounding cities. The
recovery rate was high in Mexico city due to the relatively greater resources of the medical system
there. The infection and death rates tended to be stable for five months following March 23, 2020,
and the recovery rate gradually increased in more areas. Notably, far from the Mexico city, Baja
California also displayed a high inferred rate of infection. We suspect this to be because it borders
California, USA, and the international border restrictions did not contain the spread of the virus
between the two regions. Unlike Mexico City, the death rate remained high, and the recovery rate
did not increase to levels comparable to the capital, perhaps because of the looser restrictions in
this popular tourist destination.
The diffusivities of the corresponding sub-populations of the inferred model for Mexico are
shown in Figure 6. Similar to Michigan, the mobility of infected and recovered sub-populations
are higher around the highly infected Mexico City. Mexico is about 3000 km long from north to
south and 1900 km wide from east to west–scales that can help place the diffusivities in Figure 6
in perspective. Unlike the case in Michigan where there were multiple bursts in different cities, the
mobilities of all sub-populations became stable after about 5 months from March 23, 2020. This may
reflect differences in the proclivity toward domestic/local mobility of the populations of Michigan
and Mexico–two regions with strongly contrasting social, economic and cultural characteristics.
Finally, taking the inferred parameters on the last day used for inference (Day 281), we predicted
the evolution of sub-populations for three weeks (Days 282 to 303) using the inferred model. Figures
7 and 8 show the predicted spatio-temporal evolution of the infected population against the raw data
for both Michigan and Mexico. The inferred models captured closely the evolution of the infectedsub-populations, indicating that the dynamics of the disease tended to be steady in January 2021.
The prediction of recovered and deceased sub-populations are shown in Figures 9 and 10 under
Appendix.

11

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Figure 4: Inferred diffusivities of the susceptible, infected, and recovered sub-populations in Michigan starting from lockdown, March 23, 2020. The lower Peninsula of Michigan is about 446 km
long from north to south and 314 km wide from east to west–scales that can help place the diffusivities in perspective. Time-resolved dynamics maybe seen as movies in Supplementary Information:
mexico parameter.mp4.

12

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Figure 5: Inferred infection rate (β), death rate(α), recovery rate (µ) in Mexico starting from
lockdown, March 23, 2020. Time-resolved dynamics may be seen as movies in Supplementary
Information: michigan parameter.mp4.

13

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Figure 6: Inferred diffusivities of the susceptible, infected, and recovered sub-populations at day
281 at Mexico starting from lockdown, March 23, 2020. Mexico is about 3000 km long from
north to south and 1900 km wide from east to west–scales that can help place the diffusivities in
perspective. The time-resolved dynamics may be seen as movies in Supplementary Information:
mexico parameter.mp4.

14

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Figure 7: Prediction of infected population for 3 weeks against the data for Michigan.

Figure 8: Prediction of infected population for 3 weeks against the data for Mexico. The inset
adjacent to the map of Mexico is a magnified view of the region around Mexico City.

15

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

6

Conclusion

This communication builds upon our previous work [11] on system inference and machine learning
from data to study the progression of COVID-19 across the state of Michigan. We extended the
PDE SIRD model by allowing the infection rate, death rate and the recovery rate, as well as the
diffusivities of the susceptible, infected, and recovered sub-populations to vary over space and time.
Using field inversion to infer the parameters as finite-dimensional fields on time scales of a single
day, we obtained models to predict the evolution of disease with high accuracy. This provides us
with the ability to analyze the dynamics of the disease through the inferred parameters, and make
accurate predictions within a reasonable time frame. Particularly, we can detect the evidence of
time and spatially varying mobility of the population through the simple diffusion-reaction models
instead of the relying on the agent-based models which require individual’s mobility data. The
latter can prove challenging, technically as well as politically, to obtain.
As discussed in Section 5, our inferred models capture the geographical spread of infection,
the number of deaths and the size of the recovered population starting from one highly infected
area to its surrounding cities and eventually spreading to further areas. Particularly, the higher
infection and death rates in areas with low infection at later times suggests that more attention is
needed in such locations. This may be due to a lack of medical services, or a lack of compliance
with mitigation strategies. Our inferred models also reveals higher mobility surrounding the highly
infected areas suggesting the importance of quarantine and social distancing.
Finite-dimensional representation allows the parameters to accurately capture the spatial dependence, however the non-parametric representation makes the projection of these parameters
beyond the data range extremely challenging. A prediction cannot be made with confidence if
the dynamics of the disease reflected by these parameters are not stable. Of course, extrapolation
is challenging in almost all data-driven methods. One possible alternate is to develope surrogate
models of these parameters via time dependent neural networks under the constraints of the SIRD
model to learn the spatial variation in time, and thus to make reasonable prediction of the dynamics
in the evolution the disease, such as we have demonstrated previously [11]. Nevertheless, without
including factors such as mobility restrictions or other mandates, only short time predictions may
be accurate.

Acknowledgements
We acknowledge the support of Defense Advanced Research Projects Agency (DARPA) under
Agreement No. HR0011199002, “Artificial Intelligence guided multi-scale multi-physics framework
for discovering complex emergent materials phenomena”

16

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

A

Appendix: Additional results

Figure 9: Prediction of the recovered and deceased sub-populations for 3 weeks against with the
data at Michigan.

Figure 10: Prediction of the recovered and deceased sub-populations for 3 weeks against with the
data at Mexico. The inset in the Mexico plot is a magnified view of Mexico City area.

References
[1] W.O. Kermack and A.G. McKendrick. A contribution to the mathematical theory of epidemics.
Proceedings of the Royal Society of London, Series A, 115:700–721, 1927.
[2] M.C. Eisenberg, J.N.S. Eisenberg, J.P. D’Silva, E.V. Wells, S. Cherng, Yu-H. Kao, and
R. Meza. Forecasting and uncertainty in modeling the 2014-2015 ebola epidemic in west
africa. 2015.
[3] Marisa Eisenberg, Gregory Kujbida, Ashleigh R. Tuite, David N. Fisman, and Joseph H.
Tien. Examining rainfall and cholera dynamics in haiti using statistical anddynamic modeling
approaches. Epidemics, 5:197–207, 2013. doi: 10.1016/j.epidem.2013.09.004.

17

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

[4] Amy Wesolowski, Nathan Eagle, Andrew J. Tatem, David L. Smith, Abdisalan M. Noor,
Robert W. Snow, and Caroline O. Buckee. Quantifying the impact of human mobility on
malaria. Science, 338:267–270, 2012. doi: 10.1126/science.1223467.
[5] Vittoria Colizza, Alain Barrat, Marc Barthelemy, Alain-Jacques Valleron, and Alessandro
Vespignani. Modeling the worldwide spread of pandemic influenza: Baseline case and containment interventions. PLoS Medicine, 4:e13, 2007. doi: 10.1371/journal.pmed.0040013.
[6] Herbert W Hethcote. The mathematics of infectious diseases. SIAM review, 42(4):599–653,
2000.
[7] Elizabeth Hunter, Brian Mac Namee, and John Kelleher. A taxonomy for agent-based models
in human infectious disease epidemiology. Journal of Artificial Societies and Social Simulation,
20(3):2, 2017. doi: 10.18564/jasss.3414. URL http://jasss.soc.surrey.ac.uk/20/3/2.
html.
[8] Viguerie, Alex, Veneziani, Alessandro, Lorenzo, Guillermo, Baroli, Davide, Aretz-Nellesen,
Nicole, Patton, Alessia, Yankeelov, Thomas E., Reali, Alessandro, Hughes, Thomas J. R.,
Auricchio, and Ferdinando. Diffusion–reaction compartmental models formulated in a continuum mechanics framework: application to covid-19, mathematical analysis, and numerical
study. Computational Mechanics, 66:1131–1152, 2020. doi: 10.1007/s00466-020-01888-0. URL
https://doi.org/10.1007/s00466-020-01888-0.
[9] T. I. Zohdi. An agent-based computational framework for simulation of global pandemic and
social response on planet x. Computational Mechanics, 66:1195–1209, 2020. doi: 10.1007/
s00466-020-01886-2. URL https://doi.org/10.1007/s00466-020-01886-2.
[10] Lili Chang, Moran Duan, Guiquan Sun, and Zhen Jin. Cross-diffusion-induced patterns in an
sir epidemic model on complex networks. Chaos: An Interdisciplinary Journal of Nonlinear
Science, 30(1):013147, 2020. doi: 10.1063/1.5135069. URL https://doi.org/10.1063/1.
5135069.
[11] Zhenlin Wang, Xiaoxuan Zhang, GH Teichert, Mariana Carrasco-Teja, and Krishna Garikipati.
System inference for the spatio-temporal evolution of infectious diseases: Michigan in the time
of COVID-19. Computational Mechanics, 66(5):1153–1176, 2020.
[12] 1Point3Acres.com. URL https://coronavirus.1point3acres.com/en.
[13] Tong Yang, Kai Shen, Sixuan He, Enyu Li, Peter Sun, Pingying Chen, Lin Zuo, Jiayue Hu,
Yiwen Mo, Weiwei Zhang, Haonan Zhang, Jingxue Chen, and Yu Guo. Covidnet: To bring
data transparency in the era of covid-19, 2020.

18

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

[14] Johns Hopkins University of Medicine. COVID-19 dashboard by the Center for Systems Science
and Engineering (CSSE) at Johns Hopkins University (JHU). URL https://coronavirus.
jhu.edu/map.html.
[15] Michigan State Coronavirus Data. URL https://www.michigan.gov/coronavirus/.
[16] The New York Times. Coronavirus in the U.S.: Latest Map and Case Count - The New York
Times. URL https://www.nytimes.com/interactive/2020/us/coronavirus-us-cases.
html.
[17] The Institute for Health Metrics and Evaluation. COVID-19 Projections. URL https://
covid19.healthdata.org/united-states-of-america.
[18] Inegi: Censo de población y vivienda. URL https://www.inegi.org.mx/programas/ccpv/
2020/#Tabulados.
[19] Conacyt: Covid-19 méxico. URL https://datos.covid-19.conacyt.mx/#DownZCSV.
[20] Z. Wang, X. Huan, and K. Garikipati. Variational system identification of the partial differential equations governing the physics of pattern-formation: Inference under varying fidelity
and noise. Computer Methods in Applied Mechanics and Engineering, 356:44 – 74, 2019. ISSN
0045-7825. doi: https://doi.org/10.1016/j.cma.2019.07.007.
[21] Zhenlin Wang, Bowei Wu, Krishna Garikipati, and Xun Huan. A perspective on regression
and bayesian approaches for system identification of pattern formation dynamics. Theoretical
and Applied Mechanics Letters, 10(3):188–194, 2020.
[22] Z. Wang, X. Huan, and K. Garikipati. Variational system identification of the partial differential equations governing microstructure evolution in materials: Inference over sparse
and spatially unrelated data. Computer Methods in Applied Mechanics and Engineering,
377:113706, 2021. ISSN 0045-7825. doi: https://doi.org/10.1016/j.cma.2021.113706. URL
https://www.sciencedirect.com/science/article/pii/S0045782521000426.
[23] Z. Wang, B. Martin, J. Weickenmeier, and K. Garikipati. An inverse modelling study on the
local volume changes during early morphoelastic growth of the fetal human brain. Brain Multiphysics, 2:100023, 2021. ISSN 2666-5220. doi: https://doi.org/10.1016/j.brain.2021.100023.
URL https://www.sciencedirect.com/science/article/pii/S2666522021000034.
[24] Z. Wang, J.B. Estrada, E.M. Arruda, and K. Garikipati. Discovery of deformation mechanisms and constitutive response of soft material surrogates of biological tissue by full-field
characterization and data-driven variational system identification. to appear in Journal of the
Mechanics and Physics of Solids, 2020. doi: 10.1101/2020.10.13.337964. bioRxiv.

19

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

[25] Gregory H Teichert and Krishna Garikipati. Machine learning materials physics: Surrogate
optimization and multi-fidelity algorithms predict precipitate morphology in an alternative to
phase field dynamics. Computer Methods in Applied Mechanics and Engineering, 344:666–693,
2019.
[26] Gregory H Teichert, AR Natarajan, A Van der Ven, and Krishna Garikipati. Machine
learning materials physics: Integrable deep neural networks enable scale bridging by learning free energy functions. Computer Methods in Applied Mechanics and Engineering, 353:
201 – 216, 2019. ISSN 0045-7825. doi: https://doi.org/10.1016/j.cma.2019.05.019. URL
http://www.sciencedirect.com/science/article/pii/S0045782519302889.
[27] GH Teichert, AR Natarajan, Anton Van der Ven, and Krishna Garikipati. Scale bridging materials physics: Active learning workflows and integrable deep neural networks for free energy
function representations in alloys. Computer Methods in Applied Mechanics and Engineering,
371:113281, 2020.
[28] Xiaoxuan Zhang and Krishna Garikipati. Machine learning materials physics: Multi-resolution
neural networks learn the free energy and nonlinear elastic response of evolving microstructures.
Computer Methods in Applied Mechanics and Engineering, 372:113362, 2020. doi: https:
//doi.org/10.1016/j.cma.2020.113362.
[29] Xiaoxuan Zhang and Krishna Garikipati. Bayesian neural networks for weak solution of pdes
with uncertainty quantification. 2021.
[30] Pauli Virtanen, Ralf Gommers, Travis E. Oliphant, Matt Haberland, Tyler Reddy, David
Cournapeau, Evgeni Burovski, Pearu Peterson, Warren Weckesser, Jonathan Bright, Stéfan J.
van der Walt, Matthew Brett, Joshua Wilson, K. Jarrod Millman, Nikolay Mayorov, Andrew
R. J. Nelson, Eric Jones, Robert Kern, Eric Larson, CJ Carey, İlhan Polat, Yu Feng, Eric W.
Moore, Jake Vand erPlas, Denis Laxalde, Josef Perktold, Robert Cimrman, Ian Henriksen,
E. A. Quintero, Charles R Harris, Anne M. Archibald, Antônio H. Ribeiro, Fabian Pedregosa,
Paul van Mulbregt, and SciPy 1. 0 Contributors. SciPy 1.0: Fundamental Algorithms for
Scientific Computing in Python. Nature Methods, 17:261–272, 2020. doi: https://doi.org/10.
1038/s41592-019-0686-2.
[31] Sebastian K. Mitusch, Simon W. Funke, and Jørgen S. Dokken. dolfin-adjoint 2018.1: automated adjoints for fenics and firedrake. Journal of Open Source Software, 4(38):1292, 2019.
doi: 10.21105/joss.01292. URL https://doi.org/10.21105/joss.01292.
[32] Eugene Y. Chan and Najam U. Saqib. Privacy concerns can explain unwillingness to download
and use contact tracing apps when covid-19 concerns are high. Computers in Human Behavior,

20

medRxiv preprint doi: https://doi.org/10.1101/2021.04.29.21256332; this version posted May 2, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

119:106718, 2021. ISSN 0747-5632. doi: https://doi.org/10.1016/j.chb.2021.106718. URL
https://www.sciencedirect.com/science/article/pii/S0747563221000406.
[33] Mirjam E Kretzschmar, Ganna Rozhnova, Martin C J Bootsma, Michiel van Boven, Janneke
H H M van de Wijgert, and Marc J M Bonten. Impact of delays on effectiveness of contact
tracing strategies for covid-19: a modelling study. The Lancet Public Health, 5(8):e452–e459,
2020. ISSN 2468-2667. doi: https://doi.org/10.1016/S2468-2667(20)30157-2. URL https:
//www.sciencedirect.com/science/article/pii/S2468266720301572.

21

