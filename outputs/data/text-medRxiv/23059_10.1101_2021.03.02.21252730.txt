medRxiv preprint doi: https://doi.org/10.1101/2021.03.02.21252730; this version posted March 3, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

COMMUN. BIOMATH. SCI., VOL. 1, NO. 1, PP. (HALAMAN PERTAMA-HALAMAN TERAKHIR)

1

A Nonlinear Observer to Estimate the Effective Reproduction Number of
Infectious Diseases
Agus Hasan
Department of ICT and Natural Sciences
Norwegian University of Science and Technology
6009 Alesund, Norway
Email: agus.hasan@ntnu.no

Abstract
In this paper, we design a Nonlinear Observer (NLO) to estimate the effective reproduction number
(Rt ) of infectious diseases. The NLO is designed from a discrete-time augmented Susceptible-InfectiousRemoved (SIR) model. The observer gain is obtained by solving a Linear Matrix Inequality (LMI). The
method is used to estimate Rt in Jakarta using epidemiological data during COVID-19 pandemic. If the
observer gain is tuned properly, this approach produces similar result compared to existing approach
such as Extended Kalman filter (EKF).
Keywords: Nonlinear observer, Linear Matrix Inequality, reproduction number, infectious diseases.

I. I NTRODUCTION
Governments around the world are using the reproduction numbers as criteria when deciding public
health policies during COVID-19 pandemic. In principal, there are two types of reproduction numbers: basic
reproduction number and effective reproduction number. The basic reproduction number (denoted by R0 )
shows the average expected number of cases generated by one case in a population where all individuals are
susceptible. The effective reproduction number (denoted by Rt ) shows the average expected number of cases
generated in the current state of a population. In practice, R0 is used to determine how many population that
needs to be immune to reach herd immunity. In this case, the herd-immunity threshold is 1 âˆ’ R10 . On the
other hand, Rt is used to monitor transmissions of the disease in a population during the outbreak. Hence,
this number is usually used as one of the main criteria to evaluate the public health policies. Theoretically,
Rt needs to be below 1 to ensure the transmission is under control.
Many researchers have provided calculations to estimate Rt using different approaches, e.g., Bayesian
estimation [1], serial interval [2], Extended Kalman filter [3], and parameter fitting [4]. If the estimation
parameters are tuned properly, all of these approaches will provide similar pattern with small variation. Once
the estimated Rt is obtained, we can create short-term forecasts to determine different reopening scenarios
[5]â€“[7].
The aim of this paper is to provide a novel approach to estimate the effective reproduction number Rt
of infectious diseases. To this end, we design a Nonlinear Observer (NLO) from a discrete-time augmented
Susceptible-Infectious-Removed (SIR) model. The method is efficient in the sense that the epidemiological
data is injected directly into the model once we found a constant observer gain. The observer gain is obtained
by solving a Linear Matrix Inequality (LMI). While the majority of estimation methods are based on stochastic
process, this new approach is deterministic. The Confidence Interval (CI) provided in our estimation is
inherited from the uncertainty in the infectious time and not from the method itself.
The paper is organized as follow. In Section II, we derive a discrete-time augmented SIR model. In this
section, we consider the time-varying Rt as an augmented state. Furthermore, we assume its value is a piecewise constant function. In Section III, we derive a sufficient condition for the observer gain in terms of LMI.
Simulation results using epidemiological data from Jakarta is presented in Section IV. Finally, conclusions
are given in Section V.
Received (date), Revised (date), Accepted for publication (date). Copyright Â©2018 Published by Bio Mathematical Society, e-ISSN:
2549-2896, DOI:10.5614/cbms.2017.1.1.(Nomor Paper)

NOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice.

medRxiv preprint doi: https://doi.org/10.1101/2021.03.02.21252730; this version posted March 3, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

2

AGUS HASAN

II. M ODEL
We use a simple SIR model in this paper for several reasons. First, it can be used to described transmissions
of many infectious diseases. Furthermore and most importantly, the actual data of the three compartments are
available in most outbreak events. The removed compartment consists of individuals who are either recovered
or died. Assuming constancy of population N , the SIR model can be written as follow [8]:
Î²I(t)S(t)
,
N
Î²I(t)S(t)
Ë™
I(t)
=
âˆ’ Î³I(t),
N
RÌ‡(t) = Î³I(t),
SÌ‡(t) = âˆ’

(1)
(2)
(3)

where S denotes the number of susceptible individuals, I denotes the number of infected individuals or active
cases, and R denotes the number removed individuals. The model has two parameters: the transmission rate
Î² and the removal rate Î³. By definition, Î² is the average number of contacts per person per time, multiplied
by the probability of disease transmission in a contact between a susceptible and an infectious individual.
Thus, in principal Î² is time-varying due to interventions. For this reason, in the remaining of this paper we
consider Î² as a parameter that depends on time t and is unknown. On the other hand, the removal rate Î³ is
an inverse of the average infectious time, i.e., Î³ = T1i . The infectious time can be obtained through medical
data and is usually known together with its Confidence Interval (CI). Taking into account reduction in the
number of susceptible individuals, the effective reproduction number can be estimated as follow [9]:


S(t) Î²(t)
Î²(t)
Rt (t) =
â‰ˆ
.
(4)
N
Î³
Î³
Discretizing (1)-(3) using the Euler discretization method, substituting Î²(t) = Î³Rt (t) into the model, and
augmenting Rt (t) as a new state variable, we obtain the following discrete-time augmented SIR model:
Î³âˆ†t
Rt (k)I(k)S(k),
N
Î³âˆ†t
I(k + 1) = (1 âˆ’ Î³âˆ†t)I(k) +
Rt (k)I(k)S(k),
N
R(k + 1) = R(k) + Î³âˆ†tI(k),
Rt (k + 1) = Rt (k).
S(k + 1) = S(k) âˆ’

(5)
(6)
(7)
(8)

Remark that, in the last equation we assume Rt as a piece-wise constant function with jumps every time
new data come in. To simplify the model, let us define:
|
x(k) = S(k) I(k) R(k) Rt (k) .
(9)
The discrete-time augmented SIR model (5)-(8), can be written as the following nonlinear state-space
representation:
x(k + 1) = Ax(k) + f (x(k)),

(10)

where

A

ï£«
1
0
ï£¬0 1 âˆ’ Î³âˆ†t
ï£¬
= ï£­
0
Î³âˆ†t
0
0

0
0
1
0

ï£¶
ï£« Î³âˆ†t
ï£¶
0
âˆ’ N Rt (k)I(k)S(k)
ï£¬ Î³âˆ†t
ï£·
0ï£·
ï£· and f (x(k)) = ï£¬ N Rt (k)I(k)S(k) ï£· .
ï£¸
ï£¸
ï£­
0
0
1
0

(11)

Since data for S(k), I(k), and R(k) are available, the measurement vector y(k) âˆˆ R3 is given by:
y(k) = Cx(k),

(12)

medRxiv preprint doi: https://doi.org/10.1101/2021.03.02.21252730; this version posted March 3, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

A NONLINEAR OBSERVER TO ESTIMATE THE TIME-VARIYING REPRODUCTION NUMBER

3

where
ï£«

ï£¶
1 0 0 0
C = ï£­0 1 0 0ï£¸ .
0 0 1 0

(13)

III. M ETHOD
We design the NLO as follow:
xÌ„(k + 1) = AxÌ„(k) + f (xÌ„(k)) + K (y(k) âˆ’ yÌ„(k)) ,

(14)

where xÌ„(k) âˆˆ R4 is the estimated state from the NLO and K âˆˆ R4Ã—3 is the observer gain to be determined
later. Let xÌƒ(k) = x(k) âˆ’ xÌ„(k), yÌƒ(k) = y(k) âˆ’ yÌ„(k), and âˆ†f (k) = f (x(k)) âˆ’ f (xÌ„(k)). Subtracting (10)
with (14), we obtain:
xÌƒ(k + 1) = (A âˆ’ KC) xÌƒ(k) + âˆ†f (k).

(15)

The problem is to find K such that the error xÌƒ(k) is asymptotically converges toward zero, which guarantees
the estimated states converge to the actual states. Designing a NLO for a nonlinear system is not trivial and
sometime impossible. Thus, we can simplify the problem using some assumptions, for example by assuming
the non-linearity is locally Lipschitz and bounded. These assumptions are common when designing NLO for
nonlinear systems, e.g., see [10], [11]. Therefore, the following assumptions are used in this paper:
Assumption 1. The nonlinear function f is a one-sided Lipschitz, i.e., it satisfies


| 

xÌƒ(k)
xÌƒ(k)
âˆ’I4 âˆ’ 21 I4
â‰¥ 0,
1
âˆ†f (k)
âˆ†f (k)
0n
âˆ’ 12 I4

(16)

for 1 > 0, where I4 denotes a 4 Ã— 4 identity matrix.
Assumption 2. The nonlinear function f satisfies the quadratic inner-boundedness condition, i.e.,

| 


xÌƒ(k)
I4 Î½2 I4
xÌƒ(k)
2
â‰¥ 0.
âˆ†f (k)
0 âˆ’I4
âˆ†f (k)

(17)

for 2 > 0 and Î½ âˆˆ R.
Utilizing the above assumptions, we can derive a sufficient condition for the observer gain in terms of
LMI.
Theorem III.1. Under Assumption 1 and Assumption 2, the error dynamics (15) is asymptotically stable if
there exist matrices G = G| > 0 and R âˆˆ R3Ã—4 such that the following LMI holds
ï£¶
ï£«
âˆ’G + (2 âˆ’ 1 )I4
A| G âˆ’ C | R + Î½22âˆ’1 I4 A| G âˆ’ C | R
ï£¸ < 0.
ï£­GA âˆ’ R| C + Î½2 âˆ’1 I4
G âˆ’ 2 I4
0
(18)
2
|
GA âˆ’ R C
0
âˆ’G
Furthermore, the observer gain is given by:
K = Gâˆ’1 R| .

(19)

V (k) = xÌƒ(k)| GxÌƒ(k).

(20)

Proof. Let us define a Lyapunov function:

Thus, if âˆ†V (k + 1) = V (k + 1) âˆ’ V (k), then we have:
âˆ†V (k + 1) =

|

|

xÌƒ(k)| ((A âˆ’ KC) G (A âˆ’ KC) âˆ’ G) xÌƒ(k) + 2xÌƒ(k)| (A âˆ’ KC) Gâˆ†f (k)
+âˆ†f (k)| Gâˆ†f (k).
(21)

medRxiv preprint doi: https://doi.org/10.1101/2021.03.02.21252730; this version posted March 3, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

4

AGUS HASAN

Expressing the right hand side of (21) as a matrix multiplication, we have:

| 


|
|
xÌƒ(k)
(A âˆ’ KC) G (A âˆ’ KC) âˆ’ G (A âˆ’ KC) G
xÌƒ(k)
âˆ†V (k + 1) =
. (22)
âˆ†f (k)
G (A âˆ’ KC)
G
âˆ†f (k)
Adding the left hand side of (16) and (17) into (22), we have:

| 

xÌƒ(k)
xÌƒ(k)
âˆ†V (k + 1) â‰¤
Î¦
,
âˆ†f (k)
âˆ†f (k)

(23)

where

Î¦=

|

(A âˆ’ KC) G (A âˆ’ KC) âˆ’ G + (2 âˆ’ 1 )I4
G (A âˆ’ KC) + Î½22âˆ’1 I4


|
(A âˆ’ KC) G + Î½22âˆ’1 I4
.
G âˆ’ 2 I4

(24)

Substituting (19) and applying Schur complement to (24), then Î¦ < 0 is equivalent to (18). This completes
the proof.
IV. E STIMATION OF Rt

IN JAKARTA

Daily epidemiological data of COVID-19, such as the number of active case and the number of removed
case between April 2020 until August 2020, are used in our estimation. Code and data are available in:
https://github.com/agusisma/COVIDNLO. In this simulation, we use the following parameters: 1 = 10,
2 = 1, and Î½ = 9. Furthermore, the symmetric matrix G is chosen as G = 0.1I4 , while the matrix R is
chosen as:
ï£«
ï£¶
0.0363 âˆ’0.0032
0
âˆ’0.0013
0
0.0057 ï£¸ .
R = ï£­âˆ’0.0320 0.0745
(25)
0
0
0.0916
0
We assume the average infectious time Î³1 = 12 days with standard deviation of 3 days. Using these
parameters, the LMI (18) is negative definite with the largest and smallest Eigenvalues are -0.0989 and
-9.1294, respectively. The observer gain is then given by:
ï£¶
ï£«
0.3630 âˆ’0.3200
0
ï£¬âˆ’0.0320 0.7453
0 ï£·
ï£·.
(26)
K=ï£¬
ï£­
0
0
0.9160ï£¸
âˆ’0.0134 0.0573
0
Figure 1 shows estimation results from the NLO for the daily number of active and removed case. It can
be observed from the estimation errors that the NLO estimates these numbers reasonably accurate. The NLO
is compared with the EKF method presented in [3] and the results can be seen from Figure 2. It can be
observed that the estimation results are virtually almost identical. We should note, however, that these results
are obtained after a lengthy process of trial and error when determining the matrix R. Unfortunately, there
is no method that can be used to determine matrix R automatically. Having said that, the main advantage
of using NLO is its stability and efficiency compare to EKF, since the NLO doesnâ€™t require calculation of
inverse matrices.
V. C ONCLUSION
In this paper, we have presented a new approach to estimate the effective reproduction number Rt of
infectious diseases. The idea is to inject the discrete-time augmented SIR model with epidemiological data,
such as active and removed case. The main challenge is to find a suitable observer gain, since there are no
methods to solve the LMI automatically. However, once the observer gain is found, the method is comparable
with EKF. The main advantage of using NLO is its stability compared to EKF. Furthermore, it doesnâ€™t require
computation of inverse covariance matrices, which makes NLO more efficient.

medRxiv preprint doi: https://doi.org/10.1101/2021.03.02.21252730; this version posted March 3, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

0
Apr

10000

Reported
Estimated

May

Jun

Jul
Aug
2020

Reported
Estimated

5000
0
Apr

May

Jun

Jul
Aug
2020

Error (Active)

5000

5

5
0
-5
Apr

Error (Removed)

Removed Case

Active Case

A NONLINEAR OBSERVER TO ESTIMATE THE TIME-VARIYING REPRODUCTION NUMBER

May

Jun

Jul
Aug
2020

May

Jun

Jul
Aug
2020

6
4
2
0
Apr

Fig. 1: Real-time data fitting from the NLO for active and removed case with their estimation errors.

Fig. 2: Comparison of the effective reproduction numbers Rt from NLO and EKF. The Confidence Interval
(CI), indicated by the band, is a result from uncertainty in the infectious time Î³1 .

R EFERENCES
[1] L. Bettencourt, R. Ribeiro, Real time Bayesian estimation of the epidemic potential of emerging infectious diseases, PLoS ONE
3 (2008) 1â€“9.
[2] A. Cori, N. Ferguson, C. Fraser, S. Cauchemez, A new framework and software to estimate time-varying reproduction numbers
during epidemics, American Journal of Epidemiology 178 (2013) 1505â€“1512.

medRxiv preprint doi: https://doi.org/10.1101/2021.03.02.21252730; this version posted March 3, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

6

AGUS HASAN

[3] A. Hasan, H. Susanto, V. Tjahjono, R. Kusdiantara, E. Putri, P. Hadisoemarto, N. Nuraini, A new estimation method for COVID-19
time-varying reproduction number using active cases, MedRxiv (preprint)doi:10.1101/2020.06.28.20142158.
[4] H. Susanto, V. Tjahjono, A. Hasan, M. Kasim, N. Nuraini, E. Putri, R. Kusdiantara, H. Kurniawan, How many can you infect?
Simple (and naive) methods of estimating the reproduction number, Communication in Biomathematical Sciences 3 (2020) 1â€“9.
[5] A. Hasan, E. Putri, H. Susanto, N. Nuraini, Data-driven modeling and forecasting of COVID-19 outbreak for public policy making,
ISA Transactions. In Press.
[6] A. Hasan, Y. Nasution, A compartmental epidemic model incorporating probable cases to model COVID-19 outbreak in regions
with limited testing capacity, ISA Transactions. In Press.
[7] A. Singhal, P. Singh, B. Lall, S. Joshi, Modeling and prediction of COVID-19 pandemic using gaussian mixture model, Chaos,
Solitons & Fractals 138 (2020) 1â€“8.
[8] P. van den Driessche, J. Watmough, Reproduction numbers and sub-threshold endemic equilibria for compartmental models of
disease transmission, Mathematical Biosciences 180 (2002) 29â€“48.
[9] F. Brauer, C. Castillo-Chavez, Z. Feng, Mathematical Models in Epidemiology, 1st Edition, Springer-Verlag, 2019.
[10] M. Benallouch, M. Boutayeb, M. Zasadzinski, Observer design for one-sided Lipschitz discrete-time systems, Systems & Control
Letters 61 (2012) 879â€“886.
[11] S. Ahmad, R. Majeed, K.-S. Hong, M. Rehan, Observer design for one-sided Lipschitz nonlinear systems subject to measurement
delays, Mathematical Problems in Engineering 2015 (2015) 1â€“14.

