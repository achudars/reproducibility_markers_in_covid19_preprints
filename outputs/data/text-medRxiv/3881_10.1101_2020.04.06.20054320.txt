medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Derivation of the effective reproduction number R for
COVID-19 in relation to mobility restrictions and confinement
Alex Arenas1∗ , Wesley Cota2,3,4 , Jesús Gómez-Gardeñes2,3∗ , Sergio Gómez1 , Clara Granell2,3 ,
Joan T. Matamalas5 , David Soriano-Paños2,3 , Benjamin Steinegger1

1

Departament d’Enginyeria Informàtica i Matemàtiques, Universitat Rovira i Virgili, E-43007

Tarragona, Spain
2

Department of Condensed Matter Physics, University of Zaragoza, E-50009 Zaragoza, Spain

3

GOTHAM Lab – Institute for Biocomputation and Physics of Complex Systems (BIFI), Uni-

versity of Zaragoza, E-50018 Zaragoza, Spain
4

Departamento de Fisica, Universidade Federal de Viçosa, 36570-900 Viçosa (MG), Brazil

5

Harvard Medical School & Brigham and Women’s Hospital, Boston MA 02115, USA

∗ Corresponding authors: alexandre.arenas@urv.cat, gardenes@unizar.es

The spread of COVID-19 is posing an unprecedented threat to health systems worldwide1 .
The fast propagation of the disease combined with the existence of covert contagions by
asymptomatic individuals make the controlling of this disease particularly challenging.
The key parameter to track the progression of the epidemics is the effective reproduction number R, defined as the number of secondary infections generated by an infected
individual2 . The suppression of the epidemics is directly related to this value, and is attained when R < 1. Here, we find an analytical expression for R as a function of mobility
restrictions and confinement measures, using an epidemic model tailored for COVID-19.

1

NOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice.

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

This expression for R is an extremely useful tool to design containment policies that are
able to suppress the epidemics. We applied our epidemic model for the case of Spain, successfully forecasting both the observed incidence in each region and the overload of the
health system. The expression for R allowed us to determine the precise reduction of mobility κ0 needed to bend the curve of epidemic incidence, which turned out to be κ0 ∼ 0.7.
This value, for the case of Spain, translates to a total lockdown with the exception of the
mobility associated to essential services, a policy that was finally enforced on March 28.

1 Introduction

The past 31 December of 2019 an outbreak of a novel coronavirus, named SARS-CoV-2 and
responsible for causing the COVID-19 disease, was reported in Hubei, China. As of 30 March
of 2020, more than 178 countries/regions have reported cases, and community transmission of
the virus inside those regions is growing unceasingly. The current pandemic is most likely one
of the most serious challenges that our interconnected modern society will face, and requires for
pre-emptive and coordinated actions to decelerate transmission globally. Such measures should
give nations a precious time to prepare their health-care systems to be capable of withstanding
the impact of COVID-19.

The confinement of populations, from regions to entire countries, remains the best nonpharmacological intervention once traceability of individual cases —only feasible under massive testing— is lost. However, the success of such measures is highly dependent on the precise
time they are implemented, the extent of the mobility restrictions, and the total duration of the
confinement. Normally, the decisions regarding such measures are made taking the number of
reported cases as a proxy of the current disease spread status. However in many epidemics, and
especially in the case of COVID-19, this information is an underestimation of the real preva2

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

lence in the population, due to the lack of widespread testing and the number of asymptomatic
infections that hamper traceability of secondary cases.

Recently, we have observed how some countries, such as Spain or Italy, have failed in
implementing the appropriate measures to stop the advance of the disease on time. Our model
suggests this is due to the fact that the mobility reduction imposed was insufficient to bend the
curve of incidence of COVID-19. According to the best estimates, the confinement measures
enforced in Spain on March 14 achieved only a mobility reduction of 60 ± 5%3, 4 during the first
week, a quantity that, according to our model, falls short to drive the system below the targeted
R < 1.

This example illustrates the difficult task of making accurate early evaluations of containment measures. It is observed that the reduction of mobility due to the confinement of the
population has a highly nonlinear effect on the reduction of the epidemic. This makes the task
of policy makers notoriously difficult, as they need to design realistic, implementable, confinement measures that reduce the impact of the epidemic sufficiently within the shortest time frame
possible. If the interventions planned are too weak, the epidemic will not cease and the surge
capacity of healthcare systems will be surpassed, leaving many individuals requiring hospitalization out of the attention they need. Furthermore, once policy makers realize the insufficiency
of the interventions put in place, the epidemic may have spread up to a point such that only the
most severe interventions will be of real use. On the other side, implementing very strict confinement measures from an early stage would give governments a much needed time to prepare
against the attack of the disease, but would most likely take a huge toll in the economy, and
consequently, in the population.

Finding the right balance in the intervention measures is a daunting, but essential task
3

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

for successfully weathering the storm caused by this and any other epidemic in the future. To
succeed in this endeavor, predicting the impact of any envisaged actions is crucial. We need to
know the exact relationship between the reduction of mobility and confinement measures and
its impact on the reproductive ratio R of the epidemics, as this would allow policy makers to
implement just the right amount of mobility restrictions needed to minimize the impact of the
epidemic.

In this paper we aim to solve this problem. We analytically relate the R of the evolution of
COVID-19, in a demographically heterogeneous structured population, to the mobility patterns
and the permeability of households under confinement. We derive a mathematical expression
that allows us to anticipate the result of mobility restrictions and confinement on the effective reproduction number of the spreading of COVID-19 in any specific region. The dependence of R
on the average mobility is nonlinear, and presents a sudden transition at R = 1. This transition
separates a regime in which the mobility restrictions smoothly slow down the number of cases
—the effect known as flattening the curve—, to a regime in which these restrictions sharply decelerate the number of cases —which we refer to as bending the curve—. The difference in the
outcome of these two scenarios is very pronounced. First, the curve bending strategy provokes a
drastic reduction in the infection speed, attaining a lower attack rate than the flattening strategy.
Secondly, under the bending strategy, the mobility restriction and confinement measures have
to be enforced for a shorter amount of time. This makes the bending strategy the most appropriate way of handling the confinement measures. Nevertheless, the question remains, given an
interconnected, structured population, what is the amount of mobility reduction needed to drive
the epidemic into the bending regime. The aforementioned analytical relationship between R
and the mobility restrictions precisely allows us to answer this question for any region under
the attack of COVID-19 for which demographic and mobility data is available.

4

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

2 Results

In order to explicitly relate the reduction of mobility and confinement measures with the reproductive ratio R of the epidemics, we first develop a mathematical model, in the line of previous
approaches5–11 , to predict the epidemic prevalence of COVID-19 throughout a territory. We
develop an age-stratified metapopulation compartmental model that encapsulates the particularities of the spreading of COVID-19 regarding (i) its transmission among individuals, (ii) the
specificities of certain demographic groups with respect to the impact of COVID-19, and (iii)
the human mobility patterns inside and among regions. The full dynamics of the epidemics
is formalized in terms of a Microscopic Markov Chain Approach (MMCA)12–14 . We refer the
reader to the Methods section for a full description of the model and to the Supplementary
Note 1 for the complete analysis of the Markovian equations. This model has been used to
assess the necessity for total lockdown in Spain, finally enforced on March 30th15 , for it allows
a direct assessment of mobility restrictions and confinement policies.

The effective reproduction number R(t) is defined as the number of secondary cases that
an individual, becoming infectious at time t, will produce over time. To achieve the computation
of this quantity, and understand its dependencies, we present an incremental rationale from the
most rough approximation to the most accurate formula.

Let us consider, first, an scenario (in physics know as mean-field) in which an infected
subject i makes hki contacts each time step. Assuming an infection probability β, the expected
number of individuals infected by i at each time step is βhkiρS , where ρS is the fraction of
susceptible individuals on the population. We can estimate how many individuals have been
infected by subject i over time as:
R = τ β hki ρS .
5

(1)

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

This mean-field approach, reveals the main dependencies of R on the variables of the epidemic
propagation. However, this approximation obviates the mobility of individuals and the age
strata, as well as the temporal evolution of the variables. This can be largely improved by
leveraging the information of the current epidemic model.
Let us define Rgi , (the reproduction number of patch i and age group g) as the number
of secondary cases produced by an infected individual belonging to patch i and age group g 16 .
Mathematically, Rgi is expressed as:
Rgi

g

g

= τ hβ i

NP X
NG
X

kijgh ρ̃S,h
j .

(2)

j=1 h=1

In the above expression the following quantities interplay: the duration of the infectious period,
τ ; the average infection probability during the infectious period, hβ g i per age group g; the
average number of daily contacts an individual belonging to patch i and age group g makes with
individuals in patch j belonging to age group h, kijgh ; and the fraction of susceptible individuals
g
present in patch j belonging to age group h, ρ̃S,h
j . In summary, the structure of Ri resembles

the mean field expression presented in Eq. 1 but takes explicitly into account the mobility of
individuals (kijgh and ρ̃S,h
j ). See Methods and Supplementary Note 5 for further details.
The last step to develop a formula for the evolution of R consists in including the temporal dependence on the variables. Both, the average number of contacts kijgh as well as the
pool of susceptible individuals ρ̃S,h
vary in time. Furthermore, we need to take into account
j
the transitions between, and out of, the infectious compartments of the epidemic model in the
evolution of an infected individual. Incorporating these elements we obtain:
Rgi (t)

=

∞
X

ζ

A,g

(s − t)βA + ζ

I,g

(s − t)ν βI

s=t

NP X
NG
X
j=1 h=1

6

kijgh (s) ρ̃S,h
j (s) .

(3)

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Functions ζ A,g and ζ I,g account for the probability for an individual, which becomes asymptomatically infectious at time t, to be in the asymptomatic and infected state, respectively, at
each posterior time step (see Methods for details). We suppose different values of the infection
probability for the asymptomatic (βA ) and symptomatic (βI ) individuals, and we add a factor ν
to account for the possible isolation of symptomatic individuals by themselves.

Once the effective reproduction number is computed for each patch, the value of R(t)
is the weighted average over all values Rgi (t) taking into account the distribution of the total
population N across patches and age groups, ngi , the final analytical expression for the evolution
of the effective reproduction number R(t) is:
R(t) =

NP X
NG
1 X
ngi Rgi (t) .
N i=1 g=1

(4)

This expression corresponds to the main result of our study. It allows for evaluating the evolution of the effective reproductive number throughout an epidemic, taking into account the
epidemiological characteristics of the disease along with the social, demographic and mobility
patterns that characterize the affected population.

It is precisely the inclusion of social, demographic and mobility data in the expression
of R(t) what makes this expression a fundamental tool to evaluate and anticipate the effects
of confinement and the reduction of mobility. Containment measures are implemented in the
model in the spirit of Maier et al.17 . In this line, the containment measures confine a fraction κ0
of the population at a given time t. The confinement leads to a reduction in the number of daily
contacts to the household size and mobility. Furthermore, the confined population is subtracted
from the pool of susceptible individuals but corrected accordingly to the permeability of the
households φ (understood as the probability of members of a household to skip confinement for
purchase of essential goods). Including these containment measures in the dynamical equations
7

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

of the proposed epidemic model is straightforward, see Supplementary Note 2.

We first show that our model is able to capture the effects of implementing confinement
measures by using demographic and mobility data for Spain (see Methods section). Once initialized the equations with the initial infectious seeds with the first reported cases up to March
3, we let the model evolve in the free-mobility regime until March 14, when the first mobility
restrictions enter into play in Spain and, consequently, confinement is imposed in the model.
Figure 1 compares the predictions of the model for the daily incidence and the number of
cases requiring Intensive Care Unit (ICU) assistance with the official data reported by Spain
Health Ministry. There it becomes clear that the model, not only qualitatively but also quantitatively, reproduces the impact of restraining human mobility and promoting social distancing
on hampering the spread of COVID-19. In the Supplementary Figure 2 we also show the same
comparison for daily reported cases at the level of autonomous regions in Spain.

Once validated the model, we study how enforcing mobility restriction and social distancing can drastically change the course of the epidemics. In the left panel of Figure 2, we show
the number of new cases per day for different levels of confinement, κ0 . The real value of κ0 has
been assessed from official data on the use of public transportation, cars entrance and exits in
cities, and pedestrians flows tracked through cellphones. The confinement is applied at time tc
corresponding to March 14. It is observed that, as confinement is applied to a small fraction
of the population (κ0 > 0), the curve for the number of new cases per day starts to broaden
and the maximum shifts forward in time. Such a mitigation strategy is known as –flattening
the curve–, in which containment delays and lowers the incidence peak. The consequence of
the flattening scenario is that the impact over health systems is ameliorated at the expense of a
larger epidemic period. However, as confinement is increased (higher κ0 ), there is a dramatic

8

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

change for κ0 between 0.6 − 0.8 in the behavior of the epidemic curve. In particular, for large
enough values of κ0 the epidemic curve reaches its maximum soon after containment is put in
place, achieving a completely new scenario, referred to as –bending the curve–, in which prevalence decrease steadily and the epidemic wave is shortened. The two regimes are separated by
the condition R(tc ) translating into a critical value of confinement, κc0 .
The two regimes are separated by the condition R(tc ) = 1. The transition between the
two regimes is indicated by a white solid line in the right panel of Figure 2, which shows the
effective reproduction number as function of the confinement, κ0 , and the permeability of the
households, φ. The bigger the permeability of the households, i.e. the softer the confinement,
the higher the fraction of the population that needs to be confined in order to bend the curve.

To illustrate the sudden change in R(t) caused by the implementation of a confinement
triggering a subcritical regime κ0 > κc0 , in Figure 3 we show the evolution of R(t) in the
case of Spain when confinement is applied on March 14, 2020. Furthermore, we present the
evolution of the effective reproduction number of adults (g = M ) for each municipality in
Spain, showing that they reach RM
i (t) = 1 in different stages. This reveals that the decision to
relax containment measures must take into account the entire set of municipalities and not be
based exclusively on the effective reproduction number of the country. In particular, relaxing the
confinement before every single age group g within each patch i fulfills the condition Rgi < 1
can lead to secondary outbreaks driven by those most vulnerable areas. To further illustrate this
phenomenon, we show in Figure 3 the spatial distribution of the effective reproduction number
of the adult population RiM over the country before and after confinement is implemented. See
also Supplementary Figure 3 for the distribution of Rig among different patches for two different
temporal snapshots, before and after confinement.

9

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

3 Conclusions

As the COVID-19 pandemic affects more and more countries and threatens to overload the
critical capacity of health systems, the absence of a SARS-CoV-2 vaccine requires forceful nonpharmacological containment measures by governments. Among these measures, the restriction
of mobility and social distancing have been implemented by many countries in an attempt to
reduce the impact on health systems and save the time necessary to try more efficient treatments
against this emerging pathogen. However, these measures have come up short in Spain to cut
the progression of COVID-19, due to covert infections that characterize its silent and rapid
transmission beyond areas with a high number of cases detected.

To mount the strategy against SARS-CoV-2 and anticipate its trajectory, it is necessary,
in addition to correctly modeling its epidemiological characteristics, to take into account as
closely as possible the influence of the fluidity of social contacts that it uses to spread. Here we
have shown that it is possible to construct the expression of the effective reproduction number R(t) capturing both the epidemiological characteristics of COVID-19 and those social
patterns that facilitate its expansion. This expression enables an accurate evaluation of the
spreading potential of SARS-CoV-2 on a given population and, moreover, the assessment of
non-pharmacological interventions.

Focusing to the current outbreak in Spain, we have analyzed the effects of different degrees of mobility restrictions κ0 , using the expression for R(t) evaluated at the time tc when
containment is applied. This way, we can accurately determine the effects on the slowdown and
suppression of the epidemic caused by different degrees of confinement. Calculating the value
R(tc ) we observe a transition as the set of confined inhabitants and the consequent social distancing increase. This transition defines a critical confinement, κc0 , that separates a supercritical
10

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

scenario, in which R(tc ) > 1 giving rise to a flattening of the curve, to another subcritical one,
R(tc ) < 1, in which the change in the social structure is so profound that bends the epidemic
curve making it impossible for the virus to spread.

The exact critical confinement separating the supercritical and subcritical regimes is highly
dependent on the underlying social structure and the intrinsic mobility patterns of each population. Furthermore, it depends on the time it is applied, since it depends on the available pool of
susceptible agents that can be culled out from the system. The generality of the expression R(t)
provided here makes it possible to apply it to any population, paving the way for implementing
timely and well-founded epidemiological and socially based non-pharmacological responses.

11

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

References
1. Legido-Quigley, H. et al. Are high-performing health systems resilient against the covid-19
epidemic? The Lancet 395, 848–850 (2020).
2. Rothman, K., Greenland, S. & Lash, T.

Modern Epidemiology (Wolters Kluwer

Health/Lippincott Williams & Wilkins, 2015).
3. Ministerio

de

transportes,

movilidad,

y

agenda

urbana.

URL

https://www.mitma.gob.es/transporte-terrestre/informacionestadistica/estadisticas-estudio/datos-del-registro-general.
4. Google data mobility reduction.

URL https://www.gstatic.com/covid19/

mobility/2020-03-29 ES Mobility Report en.pdf.
5. Chinazzi, M. et al. The effect of travel restrictions on the spread of the 2019 novel coronavirus (covid-19) outbreak. Science eaba9757 (2020).
6. Danon, L., Brooks-Pollock, E., Bailey, M. & Keeling, M. J.

A spatial model of

CoVID-19 transmission in England and Wales: early spread and peak timing. medRxiv
2020.02.12.20022566 (2020).
7. Wu, J. T., Leung, K. & Leung, G. M. Nowcasting and forecasting the potential domestic and
international spread of the 2019-nCoV outbreak originating in Wuhan, China: a modelling
study. The Lancet 395, 689–697 (2020).
8. Ferguson,
(NPIs)

N.
to

M.

reduce

et

al.

COVID-19

Impact
mortality

https://doi.org/10.25561/77482.

12

of

non-pharmaceutical
and

healthcare

interventions

demand

URL

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

9. Gilbert, M. et al. Preparedness and vulnerability of African countries against importations
of COVID-19: a modelling study. The Lancet (2020).
10. Pullano, G. et al. Novel coronavirus (2019-nCoV) early-stage importation risk to Europe,
January 2020. Euro surveillance : bulletin Europeen sur les maladies transmissibles =
European communicable disease bulletin 25 (2020).
11. Zhang, J. et al. Evolving epidemiology of novel coronavirus diseases 2019 and possible
interruption of local transmission outside Hubei Province in China: a descriptive and modeling study. medRxiv 2020.02.21.20026328 (2020).
12. Gómez, S., Arenas, A., Borge-Holthoefer, J., Meloni, S. & Moreno, Y. Discrete-time
Markov chain approach to contact-based disease spreading in complex networks. EPL
(Europhysics Letters) 89, 38009 (2010).
13. Matamalas, J. T., Arenas, A. & Gómez, S. Effective approach to epidemic containment
using link equations in complex networks. Science Advances 4, eaau4212 (2018).
14. Gómez-Gardeñes, J., Soriano-Paños, D. & Arenas, A. Critical regimes driven by recurrent
mobility patterns of reaction-diffusion processes in networks. Nature Physics 14, 391–395
(2018).
15. Mitjà,
spain

O.

et

towards

al.

Experts

complete

request

lockdown.

to

the

spanish

The

Lancet

government:
(2020).

move
URL

https://doi.org/10.1016/S0140-6736(20)30753-4.
16. Ng, T. C. & Wen, T. H. Spatially Adjusted Time-varying Reproductive Numbers: Understanding the Geographical Expansion of Urban Dengue Outbreaks. Scientific Reports 9,
1–12 (2019).
13

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

17. Maier, B. F. & Brockmann, D.

Effective containment explains sub-exponential

growth in confirmed cases of recent covid-19 outbreak in mainland china.

medRxiv

2020.02.18.20024414 (2020).
18. Instituto Nacional de Estadistica. spain. https://www.ine.es. Accessed: 2020-0226.
19. Prem, K., Cook, A. R. & Jit, M. Projecting social contact matrices in 152 countries using
contact surveys and demographic data. PLOS Computational Biology 13, 1–21 (2017).
URL https://doi.org/10.1371/journal.pcbi.1005697.
20. Cori, A., Ferguson, N. M., Fraser, C. & Cauchemez, S. A New Framework and Software
to Estimate Time-Varying Reproduction Numbers During Epidemics. American Journal of
Epidemiology 178, 1505–1512 (2013).

14

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Methods

Markovian epidemic model

The disease dynamics is described making use of variables ρm,g
i (t)

which represent the probabilities that individuals of age group g in region i are in state m at
time t, where m take the values S, E, A, I, H, D and R, and the age group g is either Y , M
or O. The equations of the model read as:
S,g
g
ρS,g
i (t + 1) = ρi (t) (1 − Πi (t)) ,

(5)

S,g
g
E,g
g
ρE,g
i (t + 1) = ρi (t) Πi (t) + (1 − η ) ρi (t) ,

(6)

A,g
g E,g
g
ρA,g
i (t + 1) = η ρi (t) + (1 − α ) ρi (t) ,

(7)

I,g
g A,g
g
ρI,g
i (t + 1) = α ρi (t) + (1 − µ ) ρi (t) ,

(8)

H,g
H,g
g g I,g
g
g
g
g
ρH,g
i (t + 1) = µ γ ρi (t) + ω (1 − ψ ) ρi (t) + (1 − ω ) (1 − χ ) ρi (t) ,

(9)

D,g
g g H,g
ρD,g
i (t + 1) = ω ψ ρi (t) + ρi (t) ,

(10)

I,g
R,g
g
g
g
g H,g
ρR,g
i (t + 1) = µ (1 − γ ) ρi (t) + (1 − ω ) χ ρi (t) + ρi (t) .

(11)

These equations correspond to a discrete-time dynamics, where each time-step represents a day.

The rationale of the model is the following. Susceptible individuals become exposed by
contacts with asymptomatic and infected subjects, with a probability Πgi . Exposed individuals
turn into asymptomatic at a certain rate η g , which in turn become infected at a rate αg . Once
infected, two paths emerge, which are reached at an escape rate µg . The first option is requiring
hospitalization in an ICU, with a certain probability γ g ; otherwise, the individuals become
recovered. While being at ICU, individuals have a death probability ω g , which is reached at
a rate ψ g . Finally, ICUs discharge at a rate χg , leading to the recovered compartment. See
Supplementary Table 1 for a summary of the parameters of the model, and their values to
simulate the spreading of COVID-19 in Spain.
15

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

The value of Πgi (t) encodes the probability that a susceptible individual belonging to age
group g and region i contracts the disease. Under the model assumptions, this probability is
given by:
Πgi (t)

= (1 − p

g

) Pig (t)

+p

g

NP
X

g
Rij
Pjg (t) ,

(12)

j=1

where pg denotes the degree of mobility of individuals within age group g, and Pig (t) denotes
the probability that those individuals get infected by the pathogen inside region i. This way, the
first term in the r.h.s. of Eq. (12) denotes the probability of contracting the disease inside the
residence patch, whereas the second term contains those contagions taking place in any of the
neighboring areas. The expression for Pig (t) is quite involved, since it takes into account the
infection probabilities, the average number of contacts of the individuals, the population density
in each region, the probabilities of contacts between the different age strata, and the isolation of
infected individuals; see Supplementary Note 1 for the full description of the model.

Dynamical approximation of the effective reproduction number

In the expression of the

effective reproduction number Rgi for region i and age group g, Eq. (2), we have separated the
contributions corresponding to the average number of contacts made at patch j with people of
age strata h, kijgh , and the probability of finding a susceptible individual in patch j, ρ̃S,h
j . We
need to relate them with all the parameters and variables of the model.

In our model, the number of contacts takes into account the following factors: the average
number of contacts of people of age group g, hk g i; a nonlinear increasing function of the density
of the population in the patch, z g f (ñj /sj ), where sj is the area of the patch, ñj is the population
at the patch while commuting takes place, and z g is a normalization factor for the density across
patches; the probabilities of contact according to age, C gh ; and the probability of moving from

16

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

patch i to patch j, Mij . With these ingredients, the expression for the number of contacts is:
 
ñj
gh
g
g
C gh Mij
(13)
kij = z hk i f
sj

The probability of finding a susceptible individual of age h in patch j is simply given by the
fraction of susceptible people coming from the rest of the patches:
ρ̃S,h
j (t) =

NP
1 X
nh ρS,h (t) Mkj .
ñhj k=1 k k

(14)

Finally, the expected infectious period is given by
τg =

1
1
+ g,
g
α
µ

(15)

and the average infection probability by
1
hβi = g
τ



βA ν βI
+ g
αg
µ


.

(16)

See Supplementary Note 5 for full details.

Dependence on time of the effective reproduction number

In Eq. (2), we assume that the

fraction of susceptible individuals as well as the average number of contacts is constant during
the infectious period. However, the fraction of susceptible individuals obviously changes during
that time. More importantly, as containment measures are put in place, the number of contacts
varies as well. To account for the temporal variability of these quantities, we calculate the
contributions to Rgi (t) of the infections produced since the individual became asymptomatically
infected at time t. Since the infectious period is divided in two phases, one asymptomatic with
infectious rate αg , and another symptomatic with infectious rate µg , what we have is a coupled
17

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Poisson process. The evolution of the probabilities to be asymptomatic, ζ A,g , or symptomatic,
ζ I,g , are given by:
ζ A,g (t + 1) = (1 − αg ) ζ A,g (t) ,

(17)

ζ I,g (t + 1) = αg ζ A,g (t) + (1 − µg ) ζ I,g (t) .

(18)

Since the seed is initially placed as asymptomatic, the initial conditions are given by ζ A,g (0) = 1
and ζ I,g (0) = 0. Accordingly, solving explicitly the recurrent equations, we find:
ζ A,g (t) = (1 − αg )t ,
ζ I,g (t) =

(19)


αg 
(1 − αg )t − (1 − µg )t .
g
g
µ −α

(20)

Incorporating these probabilities into Eq. (2) we obtain Eq. (3).

Data from Spain Regarding the population structure in Spain, we have obtained the population distribution, population pyramid, daily population flows and average household size at
the municipality level from Instituto Nacional de Estadı́stica 18 whereas the age-specific contact
matrices have been extracted from

19

. The first imported cases in Spain from January 31 to

March 3 were used as the initial conditions of the dynamics. See Supplementary Note 6 and
Supplementary Table 1 for the description and selection of the parameters of the model, and
Supplementary Note 7 for more details on the calibration and validation of the model for the
prediction of the evolution of the spreading of COVID-19 in Spain.

18

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Acknowledgments

We thank Gourab Ghoshal and Silvio Ferreira for useful discussions. We also thank Matteo
Rini for his suggestions. A.A., B.S. and S.G. acknowledge financial support from Spanish
MINECO (grant PGC2018-094754-B-C21), Generalitat de Catalunya (grant No. 2017SGR896), and Universitat Rovira i Virgili (grant No. 2018PFR-URV-B2-41). A.A. also acknowledge
support from Generalitat de Catalunya ICREA Academia, and the James S. McDonnell Foundation grant #220020325. J.G.G. and D.S.P. acknowledges financial support from MINECO
(projects FIS2015-71582-C2 and FIS2017-87519-P) and from the Departamento de Industria
e Innovación del Gobierno de Aragón y Fondo Social Europeo (FENOL group E-19). C.G.
acknowledges financial support from Juan de la Cierva-Formación (Ministerio de Ciencia, Innovación y Universidades). B.S. acknowledges financial support from the European Union’s
Horizon 2020 research and innovation program under the Marie Sklodowska-Curie grant agreement No. 713679 and from the Universitat Rovira i Virgili (URV). W.C. acknowledges financial support from the Coordenação de Aperfeiçoamento de Pessoal de Nı́vel Superior, Brasil
(CAPES), Finance Code 001.

Contributions

All of the authors wrote the paper and contributed equally to the production of the manuscript.

Competing financial interests

The authors declare no competing financial interests.

19

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Additional information

Supplementary Information is available for this paper.
Correspondence and requests for materials should be addressed to Alex Arenas (alexandre.arenas@urv.cat)
and Jesús Gómez-Gardeñes (gardenes@unizar.es).

20

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

104

104

103

103

ICU occupation

102

3 Apr

31 Mar

28 Mar

25 Mar

22 Mar

19 Mar

16 Mar

13 Mar

10 Mar

7 Mar

1 Mar

3 Apr

31 Mar

28 Mar

22 Mar

25 Mar

19 Mar

13 Mar

16 Mar

7 Mar

10 Mar

1 Mar

4 Mar

10

27 Feb

24 Feb

10

102

4 Mar

Daily new cases

Figure 1

Prediction of the number of cases and the number of patients requiring ICU assistance
compared to reported cases for Spain. Left: The solid line is the result of the epidemic
model, aggregated by ages, for the number of individuals inside compartments (H+R+D) that
corresponds to the expected number of daily reported cases, and dots correspond to real cases
reported (mean absolute error: 1974.14). Right: Inpatients in intensive care units (ICU) in
Spain. The solid dark line represents the number of patients predicted in compartment H by
the model and dots correspond to real ICU occupation (mean absolute error: 181.83). The
containment strategy has been applied on March 14 on both figures averaging results from κ0
in the [0.6, 0.8] interval and φ in on a range of [0.2, 0.4]. The red area covers an interval of ±2
standard deviations.

21

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Figure 2

106

4

0.8

Confinement (κ0)

104
103
102

Confinement (κ0)

10

0.0

0.6

0.4

1.0

0.2

0.8

30 May

20 May

10 May

30 Apr

20 Apr

10 Apr

31 Mar

11 Mar

1 Mar

)=1
R(t c

0.6

Flattening regime
3

0.4

2

0.2

1

0
21 Mar

Daily new cases

105

1

5

Bending regime

0

0.2

0.4

0.6

0.8

1

0

Permeability (φ)

Relationship between R and the mobility restrictions and confinement. Left: Temporal
evolution of the number of daily new reported cases in Spain (see text for further details) as a
function of the confinement κ0 (color code). The permeability has been set to φ = 0.2. Right:
Effective reproduction number when mobility restrictions are imposed R(tc ) (color code) as a
function of the confinement κ0 and the household permeability φ. The white line denotes the
condition R(tc ) = 1 separating the different regimes for which enforcing the confinement leads
to the flattening or bending of the epidemic curve respectively. See Supplementary Note 8 and
Supplementary Figure 4 for an analysis of the sensitivity of the results.

22

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Figure 3

Prediction of the evolution of R.

Top: Temporal evolution of the effective reproduction

number associated to each age group g within each municipality i. The solid dark line depicts
the global effective reproductive number computed according to Eq. (4). The values of R in
the plot are shifted in time to account for the lag between the definition of R and the one
usually estimated from data, see EpiEstim20 , plus the lag in the reporting detected cases, a
total of 20 days. Bottom: Spatial distribution of the effective reproduction number of adult
population, RM
i , before and after confinement policy is promoted. For both panels, confinement
23

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

is implemented on 14 March by setting (κ0 , φ) = (0.70, 0.20). These values correspond to the
mobility officially reported by authorities in Spain.

24

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Derivation of the effective reproduction number R for
COVID-19 in relation to mobility restrictions and confinement
Supplementary Information

Alex Arenas1 , Wesley Cota2,3,4 , Jesús Gómez-Gardeñes2,3 , Sergio Gómez1 , Clara Granell2,3 ,
Joan T. Matamalas5 , David Soriano-Paños2,3 , Benjamin Steinegger1
1

Departament d’Enginyeria Informàtica i Matemàtiques,
Universitat Rovira i Virgili, 43007 Tarragona, Spain
2

Department of Condensed Matter Physics,
University of Zaragoza, 50009 Zaragoza, Spain
3

GOTHAM Lab – Institute for Biocomputation and Physics of Complex Systems (BIFI),
University of Zaragoza, 50018 Zaragoza, Spain
4

5

Departamento de Fisica, Universidade Federal de Viçosa,
36570-900 Viçosa, Minas Gerais, Brazil

Harvard Medical School & Brigham and Women’s Hospital,
Boston MA 02115, USA

1

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Contents

Supplementary Figure 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Supplementary Figure 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Supplementary Figure 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Supplementary Figure 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Supplementary Table 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1 Epidemic spreading model. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2 Modeling containment measures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3 Calculation of R0 using the next generation matrix . . . . . . . . . . . . . . . . . . . . . . . . . .
4 Effective reproduction number and critical containment. . . . . . . . . . . . . . . . . . . . . . .
5 Dynamical approximation of the effective reproduction number . . . . . . . . . . . . . . . .
6 Parameters for the modelization of the spreading of COVID-19 . . . . . . . . . . . . . . . .
7 Calibration and validation of the model for the evolution of COVID-19 in Spain. .
8 Sensitivity Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Supplementary References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2

3
4
5
6
7
8
11
13
16
18
20
21
22
23

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Asymptomatic

Susceptible

Healthy, can get infected

Infected and infectious
but displaying no
or mild symptoms

Exposed

Sg

A, I

Eg

g

Ag

Deceased

Hg

Dg

Infected

Infected and infectious,
displaying symptoms

Infected but not
yet infectious

Hospitalized

Requires ICU hospitalization

μgg

(1-g)g

Ig

g

gg

μg(1-g)

Rg

Cgh{Ah, Ih}
A Susceptible individual becomes
Exposed upon contact with Asymptomatic
or Infected agents, according to the
contact matrix C.

Recovered

No longer infectious,
develops immunity

Supplementary Figure 1: Compartmental epidemic model proposed in this study.
The acronyms are susceptible (S g ), exposed (E g ), asymptomatic infectious (Ag ), infected (I g ),
hospitalized to ICU (H g ), dead (Dg ), and recovered (Rg ), where g denotes the age stratum for
all cases.

3

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
Andalucía (23.1)

Aragón (14.6)

300

Canarias (11.2)

750
200

500

100

250
0

0
Castilla y León (13.5)

200

0

0

Number of cases

Comunidad de Madrid (362.5)

75

100

50

50

25
0
Ceuta (0.5)

1500

3

1000

2

500

1

0
Comunidad Foral de Navarra (17.4)

0
Comunidad Valenciana (28.7)

800

6000

300

4000

200

400

2000

100

200

0

Cantabria (9.0)

Cataluña (50.3)

400

200

150

0

600

400

100

Castilla-La Mancha (35.8)

800

600

200

Extremadura (12.6)
150

600
100

0

50

0

Galicia (15.9)

0

Islas Baleares (5.3)

La Rioja (66.3)

Melilla (1.1)

400

400

10

30

200

5

0

0

Principado de Asturias (9.4)

Región de Murcia (6.4)
15000

200
100

500

10000

50

5000

0

0
18 Mar

15 Mar

12 Mar

09 Mar

06 Mar

29 Feb

03 Mar

26 Feb

18 Mar

15 Mar

12 Mar

09 Mar

06 Mar

29 Feb

03 Mar

26 Feb

23 Feb

18 Mar

15 Mar

12 Mar

09 Mar

06 Mar

29 Feb

03 Mar

26 Feb

0
23 Feb

0

23 Feb

50

18 Mar

100

15 Mar

150

1000

12 Mar

1500

TOTAL SPAIN (572.8)

150

09 Mar

250

06 Mar

0
País Vasco (147.8)

29 Feb

0

60

15

03 Mar

100

600

26 Feb

200

90

23 Feb

300

Supplementary Figure 2: Prediction of new cases for Spain by autonomous region.
Comparison of the results of the model Eqs. (S2)–(S8) for each autonomous region in Spain. The
solid line is the result of the epidemic model, aggregated by ages, for the number of individuals
inside compartments (H+R+D) that corresponds to the expected number of cases, and dots
correspond to real cases reported. The number appearing next to the region name corresponds
to the Mean Absolute Error (MAE) between the model prediction and the total number of
cases.

4

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
Young people

Adults

Elderly

8 Apr

25 days into
confinement

2 Apr

19 days into
confinement

14 Mar

No containment

0

2

4

6

8

0

2

4

6

0

2

4

6

Basic reproduction number

Supplementary Figure 3: Effective reproductive number for age strata. Distribution
of Rgi at three different stages of the epidemic spreading in Spain, according to our model: free
spreading without containment (March 14, 2020); 10 days after the implementation of partial
confinement, showing the initial effects of containment (March 24, 2020); and 21 days after the
implementation of partial confinement (April 4, 2020).

5

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

3.5

R(tc) = 0.944 ± 0.002

3.0

p(R(tc ))

2.5
2.0
1.5
1.0
0.5
0.0
0.7

0.8

0.9

1.0

1.1

1.2

R(tc)

Supplementary Figure 4: Sensitivity analysis. Distribution of effective reproduction number R values while exploring the parameters space by tuning (σ, α, ν) as described in the text.

6

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Description

COVID-19 estimates for g ∈ {Y, M, O} in Spain

βA

Infectivity of asymptomatic

0.06

βI

Infectivity of infected

0.06

Average number of contacts

(11.8, 13.3, 6.6)

Symbol

hk g i
ηg

Latent rate

αg

Asymptomatic infectious rate

ν

Isolation factor

1
2.34


1
1
1
,
,
8.86 2.86 2.86
0.6


1 1 1
,
,
1.0 7.0 7.0



µg

Escape rate

γg

Fraction of cases requiring ICU

(0.002, 0.05, 0.36)

ωg

Fatality rate of ICU patients

0.42

ψg

Death rate

1
7.0

χg

ICU discharge rate

1
20.0

ngi

Regional population

Data provided by INE

g
Rij

Mobility matrix

Data provided by INE


Contacts-by-age matrix

ξ

Density factor

0.01 km−2

pg

Mobility factor

(0.0, 1.0, 0.0)

σ

Average household size

2.5

κ0

Confinement factor

Adjustable for containment

φ

Permeability factor

Adjustable for containment

C gh

0.3849
0.7210
0.5705


0.0171
0.0350 
0.2376

0.5980
 0.2440
0.1919

Supplementary Table 1: Parameters of the model and their estimations for COVID-19. See
Supplementary Note 6 for a detailed explanation.

7

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Supplementary Note 1. Epidemic spreading model

We propose a tailored model for the epidemic spread of COVID-19. We use a previous framework
for the study of epidemics in structured metapopulations, with heterogeneous agents, subjected
to recurrent mobility patterns [7, 17, 10, 18].To understand the geographical diffusion of the
disease, as a result of human-human interactions in small geographical patches, one has to
combine the contagion process with the long-range disease propagation due to human mobility
across different spatial scales. For the case of epidemic modeling, the metapopulation scenario is
as follows. A population is distributed in a set of patches, being the size (number of individuals)
of each patch in principle different. The individuals within each patch are well-mixed, i.e.,
pathogens can be transmitted from an infected host to any of the healthy agents placed in the
same patch with the same probability. The second aspect of our metapopulation model concerns
the mobility of agents. Each host is allowed to change its current location and occupy another
patch, thus fostering the spread of pathogens at the system level. Mobility of agents between
different patches is usually represented in terms of a network where nodes are locations while a
link between two patches represents the possibility of moving between them.
We introduce a set of modifications to the standard metapopulation model to account for the
different states relevant for the description of COVID-19, and also to substitute the well-mixing
with a more realistic set of contacts. Another key point is the introduction of a differentiation
of the course of the epidemics that depends on the demographic ages of the population. This
differentiation is very relevant in light of the observation of a scarcely set of infected individuals
at ages (< 25), and also because of the severe situations reported for people at older ages
(> 65). Our model is composed of the following epidemiological compartments: susceptible
(S), exposed (E), asymptomatic infectious (A), infected (I), hospitalized to ICU (H), dead (D),
and recovered (R). Additionally, we divide the individuals in NG age strata, and suppose the
geographical area is divided in N regions or patches. Although we present the model in general
form, its application to COVID-19 only makes use of the three age groups mentioned above
(NG = 3): young people (Y), with age up to 25; adults (M), with age between 26 and 65; and
elderly people (O), with age larger than 65.
Let us suppose we have a population of N individuals distributed in NP regions, with
ni individuals residing in region i. We also consider that individuals belong to one of NG
different age strata, in such a way that ngi individuals of age group g live in region i. Thus,
N=

NP
NG X
X

ngi =

g=1 j=1

NP
X
j=1

ni =

NG
X

ng ,

(S1)

g=1

where ng is the total population of group age g.
Our system is completely characterized with the fraction of individuals in state m, where
m ∈ {S, E, A, I, H, D, R}, for each age stratum g, and associated with each patch i, that we
denote in the following as ρm,g
i (t). The temporal evolution of these quantities is given by:
S,g
g
ρS,g
i (t + 1) = ρi (t) (1 − Πi (t)) ,

(S2)

ρE,g
i (t
ρA,g
i (t
ρI,g
i (t
H,g
ρi (t
ρD,g
i (t
ρR,g
i (t

(S3)

+ 1) =
+ 1) =
+ 1) =
+ 1) =
+ 1) =
+ 1) =

g
E,g
g
ρS,g
i (t) Πi (t) + (1 − η ) ρi (t) ,
A,g
g
η g ρE,g
i (t) + (1 − α ) ρi (t) ,
I,g
g
αg ρA,g
i (t) + (1 − µ ) ρi (t) ,
H,g
H,g
g
g
g
g
µg γ g ρI,g
i (t) + ω (1 − ψ ) ρi (t) + (1 − ω ) (1 − χ ) ρi (t) ,
D,g
ω g ψ g ρH,g
i (t) + ρi (t) ,
R,g
g
g H,g
µg (1 − γ g ) ρI,g
i (t) + (1 − ω ) χ ρi (t) + ρi (t) .

8

(S4)
(S5)
(S6)
(S7)
(S8)

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

These equations correspond to a discrete-time dynamics, in which each time-step represents
a day. They are built upon previous work on Microscopic Markov-Chain Approach (MMCA)
modelization of epidemic spreading dynamics [6], but which has also been applied to other types
of processes, e.g., information spreading and traffic congestion [8, 9, 16].
The rationale of the model is the following. Susceptible individuals get infected by contacts
with asymptomatic and infected agents, with a probability Πgi , becoming exposed. Exposed
individuals turn into asymptomatic at a certain rate η g , which in turn become infected at a
rate αg . Once infected, two paths emerge, which are reached at an escape rate µg . The first
option is requiring hospitalization in an ICU, with a certain probability γ g ; otherwise, the
individuals become recovered. While being at ICU, individuals have a death probability ω g ,
which is reached at a rate ψ g . Finally, ICUs discharge at a rate χg , leading to the recovered
compartment. See in Supplementary Figure 1 a sketch of the compartmental epidemic model
with all the transitions, and Supplementary Table 1 for a list of the parameters and their values
to simulate the spreading of COVID-19 in Spain, which will be discussed in Supplementary
Note 6.
The value of Πgi (t) encodes the probability that a susceptible agent belonging to age group g
and patch i contracts the disease. Under the model assumptions, this probability is given by:
Πgi (t)

= (1 − p

g

) Pig (t)

+p

g

NP
X

g
Rij
Pjg (t) ,

(S9)

j=1
g
where pg denotes the degree of mobility of individuals within age group g, Rij
is the mobility
matrix (fraction of individuals of group age g that choose destination j while living in region i),
and Pig (t) denotes the probability that those agents get infected by the pathogen inside patch i.
This way, the first term in the r.h.s. of Eq. (S9) denotes the probability of contracting the disease
inside the residence patch, whereas the second term contains those contagions taking place in
any of the neighboring areas. Furthermore, we assume that the number of contacts increases
with the density of each area according to a monotonously increasing function f . Finally, we
introduce an age-specific contact matrix, C, whose elements C gh define the fraction of contacts
that individuals of age group g perform with individuals belonging to age group h. With the
above definitions, Pig reads

Pig (t)

=1−

NG Y
NP
Y

(1 − βA

 
nA,h (t)
ñ
z g hkg i f s i C gh jih
i
ñi
)
(1

− βI

 
ν nI,h
(t)
ñ
ji
z g hkg i f s i C gh
h
i
ñ
i
)

.

(S10)

h=1 j=1

Parameters βA and βI correspond to the infection probabilities for contacts of a susceptible individual with asymptomatic and symptomatic infected individuals, respectively. The exponents
represent the number of contacts made by an agent of age group g in patch i with infectious
individuals —compartments A and I, respectively — of age group h residing at patch j. Accordingly, the double product expresses the probability for an individual belonging to age group g
not being infected while staying in patch i. Finally, parameter ν is introduced to account for the
self-isolation of symptomatic infected individuals, either because of awareness or health state,
which effectively reduces their appearance in the patches.
The term z g hk g if (ñi /si ) in Eq. (S10) represents the overall number of contacts (infectious
or non infectious), which increases with the density of patch i following function f , where si is
the area of patch i measured in km2 , and also accounts for the normalization factor z g , which
is calculated as:
ng
zg = N
(S11)

 ,
P
X
ñi
f
ñgi
si
i=1

9

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

where the effective population at patch i, i.e., the number of people present at patch i when
commuting takes place, is given by
NG
X
ñi =
ñgi ,
(S12)
g=1

which is distributed in age groups of size
ñgi

=

NP
X

g g
Mji
nj .

(S13)

j=1
g
For convenience, we have defined the effective mobility matrices Mji
,
g
g
Mji
= (1 − pg ) δij + pg Rji
,

(S14)

that take into account both the degree of mobility of the population, and the transition probabilities to the neighboring patches.
From now on, we will use the tilde to indicate variables measured while the commuting is
active, to distinguish them from variables when all the population is in its residence patch.
The function f (x) governing the influence of population density has been selected, following
[11], as:
f (x) = 1 + (1 − e−ξx ) .
(S15)
The last term of the exponents in Eq. (S10) contains the probability that these contacts are
contagious, which is proportional to nm,h
ji , the expected number of individuals of age group h
in the given infectious state m (either A or I) which have moved from region k to region i:
h m,h
h
nm,h
ji (t) = nj ρj (t) Mji .

(S16)

The discrete time nature of this model allows for an easy computation of the time evolution of
all the relevant variables, providing information at the regional level. See Supplementary Note 7
for the details of its application to the COVID-19 outbreak in Spain. Additionally, the model
is amenable for analytical inspection, which has allowed us to find the epidemic threshold, see
Supplementary Note 3.

10

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Supplementary Note 2. Modeling containment measures

Here we assess the performance of different containment measures to reduce the impact of
COVID-19 using the mathematical model. To incorporate containment policies in our formalism, we consider that a given fraction of the adult population κ0 is isolated at home whereas
both young and elderly people are assume to stay at home . In this sense, let us remark that
parameter κ0 allows us to tune the strength of those containment mesaures proposed to contain
COVID-19. In this sense, κ0 = 1 reflects a total lockdown of the population which isolates
the households from each other, thus constraining the transmission dynamics at the level of
household rather than municipality. From the former assumptions, we compute the average
number of contacts of agents belonging to each group g ∈ {Y, M, O} as
hkcY i = hkcO i = σ − 1 ,
hkcM i

(S17)
M

= κ0 (σ − 1) + (1 − κ0 )hk i ,

(S18)

where σ encodes the average household size.
In this scenario, a relevant indicator to quantify the efficiency of the policy is the probability
of one individual living in a household, inside a given municipality i, without any infected
individual. Assuming that containment is implemented at time tc , this quantity, denoted in the
following as CH i (tc ), is given by

σ
NG 

X
1
R,g
g
CH i (tc ) = 
ρS,g
.
(S19)
i (tc ) + ρi (tc ) ni
ni
g=1

This way, Eqs. (S17) and (S18) become time-dependent:
hk g i(t) = (1 − Θ(t − tc )) hk g i + Θ(t − tc ) hkcg i

(S20)

where Θ(x) is the Heaviside function, that is 1 if x > 0 and 0 otherwise. Accordingly, the
mobility parameters pg change as
pg (t) = (1 − κ0 Θ(t − tc )) pg ,

(S21)

which make ñgi and z g also dependent on time, see Eqs. (S11)–(S13). Unfortunately, complete
isolation of households is impossible, thus we introduce a permeability factor φ that reduces the
effective isolation.
This containment strategy is introduced in the dynamical Eqs. (S2)–(S7) by modifying
Eqs. (S2) and (S3) for the time after tc :
S,g
g
ρS,g
i (t + 1) = ρi (t) (1 − δt,tc (1 − φ) κ0 CH i (tc )) (1 − Πi (t)) ,

ρE,g
i (t + 1)
,g
ρCH
(t)
i

=
=

g
ρS,g
i (t) (1 − δt,tc (1 − φ) κ0 CH i (tc )) Πi (t)
ρS,g
i (tc ) (1 − φ) κ0 CH i (tc ) Θ(t − tc ) ,

(S22)

+ (1 − η

g

) ρE,g
i (t) ,

(S23)
(S24)

where we have added a new compartment CH to hold the individuals under household isolation
after applying containment κ0 , and δa,b is the Kronecker function, which is 1 if a = b and 0
otherwise. Containment also affects the average number of contacts, thus we must also update
Eq. (S10):
Pig (t)

=1−

NG Y
NP
Y

(1 − βA )

z g (t) hkg i(t) f



ñi (t)
si



C gh

nA,h
(t)
ji
ñh
i (t)

(1 − βI )

z g (t) hkg i(t) f



ñi (t)
si



C gh

ν nI,h
(t)
ji
ñh
i (t)

.

h=1 j=1

(S25)
11

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

In summary, we have introduced a containment strategy characterized by the isolation of
a certain fraction of the population, which in turn reduces the average number of contacts,
the mobility and, as a result, the probability of becoming infected, thus reducing the overall
prevalence of the disease. The containment is parameterized with the containment factor κ0 ,
and the permeability factor φ.

12

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
Supplementary Note 3. Calculation of R0 using the next generation matrix

The model is amenable for analytical calculations. We calculate the basic reproduction number R0 using the next generation matrix (NGM) approach [4]. Accordingly, we need to analyze
the stability of the disease free equilibrium. We do so by making a first order expansion of the
model equations for small values () of the non-susceptible states m:  ∼ ρm,g
 ρS,h
∀i, j, g, h
i
j
m
and ρi  1 ∀i, where m ∈ {E, A, I, H, D, R}. The expansion allows us to transform our discrete time Markov Chain into a system of continuous time differential equations. We start by
expanding the infection probabilities Pig :
h
i
h 
NG X
NP

nhj (1 − ph ) δij + ph Rji
X
A A,h
I I,h
Pig =
z g hk g i fi C gh
b
ρ
+
ν
b
ρ
+ O(2 ) ,
(S26)
j
j
h
ñ
i
h=1 j=1
where we have defined

h
i
bm = ln (1 − βm )−1 , m ∈ {A, I}

and


fi = f

ñi
si

(S27)


.

(S28)

We then insert the above expression into Πgi , leading to:
Πgi =

NG X
NP
X



I I,h
Jijgh bA ρA,h
+
ν
b
ρ
+ O(2 ) ,
j
j

(S29)

h=1 j=1

where it is convenient to separate tensor J if four terms:
J=

4
X

J` ,

(S30)

`=1

with
g
g
g
gh
(J1 )gh
ij = δij (1 − p ) z hk i fi C

(J2 )gh
ij

g

g

g

= (1 − p ) z hk i fi C

gh

g g g
g
gh
(J3 )gh
ij = p Rij z hk i fj C

(J4 )gh
ij =

NP
X

(1 − ph ) nhj
ñhi

h p h nh
Rji
j

ñhi

,

(1 − ph ) nhj

g g
pg Rik
z hk g i fk C gh

k=1

ñhj
ñhk

(S31)
(S32)

,

h p h nh
Rjk
j

,

(S33)

.

(S34)

These tensors encode the four different ways in which the epidemic interactions may take place:
individuals belonging to the same patch i = j and not moving (J1 ); interaction in the patch
of i with individuals coming from patch j (J2 ); interaction in the patch of j with individuals
coming from patch i (J3 ); and individuals from i and j interacting at any other patch k (J4 ).
In the next generation matrix framework, we only need to consider the epidemic compartments. Additionally, the framework requires to work in absolute numbers of infected individuals.
Accordingly, we define the absolute number of individuals in the respective compartments as
Nim,g = ngi ρm,g
.
i
13

(S35)

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Making use of the above definitions, the corresponding differential equations take the form:
ṄiE,g

= −η

g

NiE,g

+

NG X
NP
X

Jijgh

h=1 j=1


ngi  A A,h
I I,h
b
N
+
ν
b
N
,
j
j
nhj

(S36)

ṄiA,g = η g N E,g − αg N A,g ,

(S37)

ṄiI,g = αg NiA,g − µg N I,g .

(S38)

Defining the vector N g = N E,g , N A,g , N I,g
be rewritten as:
g

Ṅ =

T

NG 
X

, the above system of differential equations can


F gh − V gh N h ,

(S39)

h=1

where we have defined
V gh = V g δ gh ⊗ 1NP ×NP ,

(S40)


ηg
0
0
0
V g = −η g αg
g
0
−α µg

(S41)

with,


and
F gh


0NP ×NP

= 0NP ×NP
0NP ×NP

bA K gh
0NP ×NP
0NP ×NP


ν bI K gh
0NP ×NP  .
0NP ×NP

(S42)

In the above tensor we have defined
gh
Kij
=

ngi gh
J .
nhj ij

(S43)

With the above differential equation, the basic reproduction number is given by:
R0 = Λmax (F V −1 ) .

(S44)

We can calculate the inverse of the tensor V as
(V −1 )gh = (V g )−1 δ gh ⊗ 1NP ×NP .

(S45)

The inverse of the matrix V g is given by:
1
ηg
1
 αg
1
µg


(V g )−1 =

0
1
αg
1
µg


0
0
.
1
µg

(S46)

Accordingly, we have:


(F V −1 )gh = 

bA
αh

+

ν bI
µh



K gh

0NP ×NP
0NP ×NP



bA
αh

+

ν bI
µh



0NP ×NP
0NP ×NP

K gh



ν bI
K gh
µh


0NP ×NP  .
0NP ×NP

(S47)

As we are looking for the eigenvectors of the tensor F V −1 , we note that their components
associated to the compartments A and I —rows 2 and 3— must be zero, since the associated
14

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
rows in the above matrix are zero. To be more precise, we have (F V −1 u)ga = 0 for a =

2NP + 1, . . . 3NP , which are the elements associated to the compartments A and I. Accordingly,
we can restrict the above matrix only to the vector space associated to the compartment E and
the eigenvalues will be equivalent, which gives us the basic reproduction number R0 :
R0 = Λmax (Z) ,

(S48)

bA
ν bI
+
αh
µh

(S49)

where
Z

gh


=



and Λmax (Z) denotes the spectral radius of tensor Z.

15

K gh ,

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Supplementary Note 4. Effective reproduction number and critical containment
The effective reproduction number R is given by
R(t) = ρS (t) R0 ,

(S50)

ρS (t)

where
is the fraction of reachable susceptible individuals at time t and R0 is the basic
reproduction number [3]. In our case, the containment has an effect on both terms. First, κ0
reduces the pool of individuals susceptible of contracting the disease, i.e. it reduces the term ρS .
And, second, κ0 reduces the average degree of the individuals and thus it reduces R0 . Eq. (S50)
allows us to accurately determine the effective reproduction number and capture the impact of
human mobility and containment measures on the spread of the disease.
Computing Eq. (S50) by means of the NGM approach involves the calculation of the spectral
radius of tensor Z, which hinders an understanding of the roots behind the transition from
flattening to bending the epidemic curve triggered by an efficient confinement, as illustrated
in the main text. In order to have an analytical estimation of the critical value of the needed
confinement to observe this transition, κc0 , let us consider a single well mixed population. In
this case, we have
 A

g
b
ν bI
gh
g
gh n
Z =
+
hk
i
C
(S51)
αh
µh
nh
and
R0 = Λmax (Z) .
(S52)
If we remove the age strata, the basic reproduction number is reduced to
 A



b
ν bI
βA ν βI
R0 = hki
+
≈ hki
+
,
α
µ
α
µ

(S53)

where we have approximated
h
i
bm = ln (1 − βm )−1 ≈ βm , m ∈ {A, I} ,

(S54)

which is valid for low values of the infection probabilities βm . The same result for R0 , Eq. (S53),
is obtained if all age groups share the values of population ng , average number of contacts hk g i,
asymptomatic infectious rate hαg i, and escape rate hµg i, since Λmax (C) = 1 due to the contactby-age matrix C being a stochastic matrix.
Accordingly, after introducing containment, we get for the effective reproduction number:
 A



b
ν bI
S
S
R
σ
R = ρ 1 − (1 − φ) κ0 (ρ (t) + ρ (t)) [hki − κ0 (hki − (σ − 1))]
+
,
(S55)
α
µ
where the temporal dependence has been omitted. The parameter φ encodes the permeability
(household isolation level), ranging from φ = 0 for which households are perfectly isolated, to
φ = 1 which recovers the well-mixed scenario before the intervention, but now with a lower
average number of contacts.
In order to bend the epidemic curve and not to flatten it we impose the condition R 6 1.
Accordingly, the critical containment value κc0 must fulfill the equation:

(κc0 )2 (1 − φ) (ρS + ρR )σ (hki + 1 − σ) − κc0 (1 − φ) (ρS + ρR )σ hki + hki + 1 − σ
1

 = 0 . (S56)
+ hki −
A
I
ρS bα + νµb
16

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Defining the following coefficients:

A = (1 − φ) (ρS + ρR )σ (hki + 1 − σ) ,
S

R σ

B = (1 − φ) (ρ + ρ ) hki + hki + 1 − σ ,
1
,

C = hki −
I
A
ρS bα + νµb

(S57)
(S58)
(S59)

we can write Eq. (S56) as
A (κc0 )2 − B κc0 + C = 0 ,

(S60)

whose solution is given by:
√

B2 − 4 A C
.
2A
Note that only the physically meaningful solution, κc0 ∈ [0, 1], must be retained.
κc0

=

B±

17

(S61)

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Supplementary Note 5. Dynamical approximation of the effective reproduction number

A naive approach to computing the effective reproduction number R is considering the mean
field scenario, in which an infected subject i contacts hki individuals each time step. Assuming
an infection probability β, the expected number of individuals infected by i at each time step
is ρS hkiβ, where ρS is the fraction of susceptible individuals on the population. Taking into
account the duration of the infectious period τ , we can estimate how many individuals have
been infected by subject i over time as: R = ρS hkiβτ .
We can extend this approach to include both the temporal dependence and the heterogeneity
of contacts induced by daily commuting patterns, making use of all the probabilities provided
by our model equations. Moreover, here we aim at studying the temporal evolution of the
effective reproduction number beyond the early stage of the disease. In this sense, we define the
reproduction number of patch i and age group g as the number of infections observed if we seed
an infected individual in the aforementioned patch and age group [14]. This involves considering
that this infected individual, with residence in patch i, may commute to patch j, where it will
be able to contact and infect susceptible individuals coming from any other patch k.
First, we calculate the expected number of susceptible individuals of age group h which have
moved from region k to region j as:
h
h S,h
nS,h
kj (t) = nk ρk (t) Mkj .

(S62)

The fraction of susceptible individuals of each age group g in patch j at time t is expressed by:
ρ̃S,h
j (t) =

NP
1 X
nS,h (t) .
ñhj k=1 kj

(S63)

Next, we compute the number of susceptible contacts made by an individual of age group g and
patch i, which can be expressed as:
Qgi (t)

=

NP X
NG
X

g

g

z hk i f

j=1 h=1



ñj
sj



g
C gh ρ̃S,h
j Mij ,

(S64)

Using this expression, and assuming that we have an individual from patch i and age group g
that has become infectious, we can compute the effective reproduction number for each patch
and age group as:


βA ν βI
g
+ g Qgi (t) .
(S65)
Ri (t) =
αg
µ
For estimating the global effective reproduction number, we then make use of a weighted average
taking into account the distribution of the population across patches and age groups:
NP X
NG
1 X
R(t) =
ngi Rgi (t)
N

(S66)

i=1 g=1

In Eq. (S65), we assume that the fraction of susceptible individuals as well as the average
number of contacts is constant during the infectious period. However, the fraction of susceptible
individuals obviously changes during that time. More importantly, as containment measures
are put in place, the number of contacts varies as well. To account for the temporal variability
of these quantities, we calculate the contributions to Rgi (t) of the infections produced since the
individual became asymptomatically infected at time t. Since the infectious period is divided in
18

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
two phases, one asymptomatic with infectious rate αg , and another symptomatic with infectious

rate µg , what we have is a coupled Poisson process. The evolution of the probabilities to be
asymptomatic, ζ A,g , or symptomatic, ζ I,g , are given by:
ζ A,g (t + 1) = (1 − αg ) ζ A,g (t) ,

(S67)

ζ I,g (t + 1) = αg ζ A,g (t) + (1 − µg ) ζ I,g (t) .

(S68)

Since the seed is initially placed as asymptomatic, the initial conditions are given by ζ A,g (0) = 1
and ζ I,g (0) = 0. Accordingly, solving explicitly the recurrent equations, we find:
ζ A,g (t) = (1 − αg )t ,

αg 
(1 − αg )t − (1 − µg )t .
ζ I,g (t) = g
g
µ −α

(S69)
(S70)

Incorporating these probabilities into Eq. (S65) we obtain
Rgi (t) =

∞
X

ζ A,g (s − t) βA + ζ I,g (s − t) ν βI

s=t

NP X
NG
X
j=1 h=1

19

gh
kij
(s) ρ̃S,h
j (s) .

(S71)

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Supplementary Note 6. Parameters for the modelization of the spreading of
COVID-19

In this subsection, we detail our parameters choice to study the current epidemic outbreak in
Spain. Regarding epidemiological parameters, the incubation period has been reported to be
η −1 + α−1 = 5.2 days [12] in average which, in our formalism, must be distributed into the
exposed and asymptomatic compartments. In principle, if one does not expect asymptomatic
transmissions, most of this time should be spent inside the exposed compartment, thus being the
asymptomatic infectious compartment totally irrelevant for disease spreading. However, along
the line of several recent works [13, 15, 5] we have found that the unfolding of COVID-19 cannot
be explained without accounting for infections from individuals not developing any symptoms
previously. In particular, our best fit to reproduce the evolution of the real cases reported so
far in Spain yields α−1 = 2.86 days as asymptomatic infectious period. In turn, the infectious
period while being symptomatic is established as µ−1 = 7 days [1, 20], except for the young
strata, for which we have reduced it to 1 day, assigning the remaining 6 days as asymptomatic;
this is due to the reported mild symptoms in young individuals, which may become inadvertent
[2]. Furthermore, we have included an isolation factor ν = 0.6 which reduces the infectiousness
of symptomatic agents as a result of their self-isolation. We fix the fatality rate ω = 42% of
ICU patients by studying historical records of dead individuals as a function of those requiring
intensive care. In turn, we estimate the period from ICU admission to death as ψ −1 = 7 days
[19] and the stay in ICU for those overcoming the disease as χ−1 = 20 days [1].

20

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Supplementary Note 7. Calibration and validation of the model for the evolution of COVID-19 in Spain

Equations (S2)–(S8) enable to monitor the spatio-temporal propagation of COVID-19 across
Spain. To check the validity of our formalism, we aggregate the number of cases predicted
for each municipality at the level of autonomous regions (comunidades autónomas), which is
a first-level political and administrative division, and compare them with the number of cases
daily reported by the Spanish Health Ministry. In this sense, we compute the number of cases
predicted for each municipality i at each time step t as:
Casesi (t) =

NG 
X


H,g
D,g
ρR,g
(t)
+
ρ
(t)
+
ρ
(t)
ngi .
i
i
i

(S72)

g=1

As our model is designed to predict the emergence of autochthonous cases triggered by local
contagions and commuting patterns, those imported infected individuals corresponding to the
first reported cases in Spain are initially plugged into our model as asymptomatic infectious
agents. In addition, small infectious seeds should be also placed in those areas where anomalous outbreaks have occurred due to singular events such as one funeral in Vitoria leading to
more than 60 contagions. Overall, the total number of infectious seeds is 47 individuals which
represents 0.2 % of the number of cases reported by March 20, 2020.
Supplementary Figure 2 shows that our model is able to accurately predict not only the
overall evolution of the total number of cases at the national scale but also their spatial distribution across the different autonomous regions. Moreover, the most typical trend observed so
far is an exponential growth of the number of cases, thus clearly suggesting that the disease was
spreading freely in most of the territories when the model was calibrated. Note, however, that
there are some exceptions such as La Rioja or Paı́s Vasco in which some strong policies targeting
the most affected areas were previously promoted to slow down COVID-19 propagation.
We also show in Supplementary Figure 3 the distribution of Rgi at three different stages of
the epidemic spreading in Spain, according to our model: free spreading without containment
(March 14, 2020); 10 days after the implementation of partial confinement, showing the initial effects of containment (March 24, 2020); and 21 days after the implementation of partial
confinement (April 4, 2020).

21

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Supplementary Note 8. Sensitivity Analysis

We have performed a sensitivity analysis to check the robustness of the critical value of the
effective reproduction number R = 1, identifying the transition from supercritical (flattening)
regime to the subcritical (bending) one when applying confinement. For this purpose, we
report here the results obtained by tuning some of the parameters of the model under the same
assumptions and show that the obtained results are consistent with the results reported in the
main text of the manuscript and do not alter the conclusions of our study.
In particular, we fix the permeability parameter to φ = 0.20 and the confinement to κ0 =
0.66, and sample a region of the parameters space by varying the average household size,
σ ∈ [2, 3], the asymptomatic infectious rate of each strata g, αg ∈ [0.25, 0.5], and the selfisolation parameter of symptomatic infected individuals, ν ∈ [0.5, 0.7].
Results of this sensitivity analysis are depicted in Figure 4, where we show that the effective reproduction number remains almost unaltered while exploring different points of the
parameters space.

22

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Supplementary References

[1] Pavan K. Bhatraju, Bijan J. Ghassemieh, Michelle Nichols, Richard Kim, Keith R. Jerome,
Arun K. Nalla, Alexander L. Greninger, Sudhakar Pipavath, Mark M. Wurfel, Laura Evans,
Patricia A. Kritek, T. Eoin West, Andrew Luks, Anthony Gerbino, Chris R. Dale, Jason D.
Goldman, Shane O’Mahony, and Carmen Mikacenic. Covid-19 in critically ill patients in
the seattle region — case series. New England Journal of Medicine, mar 2020.
[2] Qifang Bi, Yongsheng Wu, Shujiang Mei, Chenfei Ye, Xuan Zou, Zhen Zhang, Xiaojian Liu,
Lan Wei, Shaun A Truelove, Tong Zhang, Wei Gao, Cong Cheng, Xiujuan Tang, Xiaoliang
Wu, Yu Wu, Binbin Sun, Suli Huang, Yu Sun, Juncen Zhang, Ting Ma, Justin Lessler, and
Teijian Feng. Epidemiology and transmission of covid-19 in shenzhen china: Analysis of
391 cases and 1,286 of their close contacts. medRxiv, 2020.
[3] Ariel Cintrón-Arias, Carlos Castillo-Chávez, Luis Betencourt, Alun L Lloyd, and Harvey Thomas Banks. The estimation of the effective reproductive number from disease
outbreak data. Mathematical Biosciences and Engineering, 6(2):261–282, 2008.
[4] O. Diekmann, J. A.P. Heesterbeek, and M. G. Roberts. The construction of next-generation
matrices for compartmental epidemic models. Journal of the Royal Society Interface,
7(47):873–885, 2010.
[5] Tapiwa Ganyani, Cecile Kremer, Dongxuan Chen, Andrea Torneri, Christel Faes, Jacco
Wallinga, and Niel Hens. Estimating the generation interval for covid-19 based on symptom
onset data. medRxiv, 2020.
[6] Sergio Gómez, Alex Arenas, Javier Borge-Holthoefer, Sandro Meloni, and Yamir Moreno.
Discrete-time Markov chain approach to contact-based disease spreading in complex networks. EPL (Europhysics Letters), 89(3):38009, feb 2010.
[7] Jesús Gómez-Gardeñes, David Soriano-Paños, and Alex Arenas. Critical regimes driven
by recurrent mobility patterns of reaction-diffusion processes in networks. Nature Physics,
14(4):391–395, apr 2018.
[8] Clara Granell, Sergio Gómez, and Alex Arenas. Dynamical interplay between awareness
and epidemic spreading in multiplex networks. Physical Review Letters, 111(12), 2013.
[9] Clara Granell, Sergio Gómez, and Alex Arenas. Competing spreading processes on multiplex networks: Awareness and epidemics. Physical Review E - Statistical, Nonlinear, and
Soft Matter Physics, 90(1), 2014.
[10] Clara Granell and Peter J. Mucha. Epidemic spreading in localized environments with
recurrent mobility patterns. Physical Review E, 97(5), 2018.
[11] Hao Hu, Karima Nigmatulina, and Philip Eckhoff. The scaling of contact rates with
population density for the infectious disease models. Mathematical Biosciences, 244(2):125
– 134, 2013.
[12] Qun Li, Xuhua Guan, Peng Wu, Xiaoye Wang, Lei Zhou, Yeqing Tong, Ruiqi Ren,
Kathy S.M. Leung, Eric H.Y. Lau, Jessica Y. Wong, Xuesen Xing, Nijuan Xiang, Yang Wu,
Chao Li, Qi Chen, Dan Li, Tian Liu, Jing Zhao, Man Liu, Wenxiao Tu, Chuding Chen,
Lianmei Jin, Rui Yang, Qi Wang, Suhua Zhou, Rui Wang, Hui Liu, Yinbo Luo, Yuan Liu,
Ge Shao, Huan Li, Zhongfa Tao, Yang Yang, Zhiqiang Deng, Boxi Liu, Zhitao Ma, Yanping
23

medRxiv preprint doi: https://doi.org/10.1101/2020.04.06.20054320; this version posted April 8, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Zhang, Guoqing Shi, Tommy T.Y. Lam, Joseph T. Wu, George F. Gao, Benjamin J. Cowling, Bo Yang, Gabriel M. Leung, and Zijian Feng. Early Transmission Dynamics in Wuhan,
China, of Novel Coronavirus–Infected Pneumonia. New England Journal of Medicine, jan
2020.

[13] Ruiyun Li, Sen Pei, Bin Chen, Yimeng Song, Tao Zhang, Wan Yang, and Jeffrey Shaman.
Substantial undocumented infection facilitates the rapid dissemination of novel coronavirus
(sars-cov2). Science, 2020.
[14] Ta Chou Ng and Tzai Hung Wen. Spatially Adjusted Time-varying Reproductive Numbers: Understanding the Geographical Expansion of Urban Dengue Outbreaks. Scientific
Reports, 9(1):1–12, dec 2019.
[15] Hiroshi Nishiura, Natalie M. Linton, and Andrei R. Akhmetzhanov. Serial interval of novel
coronavirus (covid-19) infections. International Journal of Infectious Diseases, 2020.
[16] Albert Solé-Ribalta, Sergio Gómez, and Alex Arenas. A model to identify urban traffic
congestion hotspots in complex networks. Royal Society Open Science, 3(10), 2016.
[17] D. Soriano-Paños, L. Lotero, A. Arenas, and J. Gómez-Gardeñes. Spreading Processes in
Multiplex Metapopulations Containing Different Mobility Networks. Physical Review X,
8(3):031039, aug 2018.
[18] David Soriano-Paños, Gourab Ghoshal, Alex Arenas, and Jesús Gómez-Gardeñes. Impact
of temporal scales and recurrent mobility patterns on the unfolding of epidemics. Journal
of Statistical Mechanics: Theory and Experiment, 2020(2):024006, feb 2020.
[19] Nick Wilson, Amanda Kvalsvig, Lucy Telfar Barnard, and Michael G. Baker. Case-fatality
risk estimates for covid-19 calculated by using a lag time for fatality. 26(6), 2020.
[20] Xiaobo Yang, Yuan Yu, Jiqian Xu, Huaqing Shu, Jia’an Xia, Hong Liu, Yongran Wu,
Lu Zhang, Zhui Yu, Minghao Fang, Ting Yu, Yaxin Wang, Shangwen Pan, Xiaojing
Zou, Shiying Yuan, and You Shang. Clinical course and outcomes of critically ill patients
with sars-cov-2 pneumonia in wuhan, china: a single-centered, retrospective, observational
study. The Lancet Respiratory Medicine, Apr 2020.

24

