medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

SEIR Filter: A Stochastic Model of Epidemics
Martin Šmíd,12 Luděk Berec,3 Aleš Antonín Kuběna,1 René Levínský,4
Jan Trnka,5 Vít Tuček,6 Milan Zajíček1

Abstract
There are many epidemiological models at hand to cope with the present
pandemic; it is, however, difficult to calibrate these models when data are
noisy, partial or observed only indirectly. It is also difficult to distinguish
relevant data from noise, and to distinguish the impact of individual determinants
of the epidemic.
In mathematical statistics, the tools to handle all of these phenomena
exist; however, they are seldom used for epidemiological models. The goal
of this paper is to start filling this gap by proposing a general stochastic
epidemiological model, which we call SEIR Filter.
Technically our model is a heterogeneous partially observable vector autoregression model, in which we are able to express closed form formulas for the
distribution of compartments and observations, so both maximum likelihood
and least square estimators are analytically tractable. We give conditions
for vanishing, explosion and stationary behaviour of the epidemic and we are
able to express a closed form formula for reproduction number.
Finally, we present several examples of the model’s application. We
construct an estimate age-cohort model of the COVID-19 pandemic in the
Czech Republic. To demonstrate the strengths of the model, we employ it
to analyse and compare three vaccination scenarios.
1

Czech Academy of Sciences, Institute of Information Theory and Automation, Pod
Vodárenskou věží 4, 18200 Praha 8, Czech Republic
2
Corresponding author, email: smid@utia.cas.cz
3
Centre for Mathematical Biology, Institute of Mathematics, Faculty of Science,
University of South Bohemia, Branišovská 1760, 37005 České Budějovice, Czech Republic
4
CERGE-EI, Politických vězňů 7, 11121 Praha 1, Czech Republic
5
Department of Biochemistry, Cell and Molecular Biology, Third Faculty of Medicine,
Charles University, Ruská 87, 100 00 Praha 10, Czech Republic
6
Department of Mathematics, University of Zagreb, Bijenička 30, 10000 Zagreb, Croatia

Preprint submitted to Elsevier

February 15, 2021

NOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice.

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Keywords: SEIR Models, Stochastic Models, COVID-19 pandemic
1. Introduction
Whereas fundamental rationale behind mainstream epidemic models, dating back to the works of Ross [25] and Kermack and McKendrick [14]
about a century ago, is relatively easy to comprehend, problems arise when
we aim to parameterize such models to data for specific epidemics. The
source of troubles is not only absence of clear and consistent protocols for
data collection, but also factors that can never be fully intercepted, such as
degrees of compliance in many adopted interventions. This is also the case
for COVID-19, despite the somewhat paradoxical observation, that we now
arguably have the best data on any epidemic in the history of mankind.
In regards to COVID-19, many issues arise requiring careful modelling,
such as quantifying the effects of various non-pharmaceutical interventions
[10, 4, 16]. Two questions are particularly interesting in this context: how
effective testing and tracing has to be to counteract an intervention relaxation
[19] and how stringent the interventions should be in order to compensate
for partial non-compliance of the population [1]. To answer these questions,
models for correctly predicting uncertainty are of vital importance.
Upon construction of realistic models, various data issues have to be
coped with, starting from noise (caused both by the epidemic process itself
and the data collection), insignificance (difficulty to distinguish impacts of
factors from random fluctuations) or co-linearity (difficulty to distinguish two
parameters with sufficient certainty). The most severe difficulty however, is
that relevant data (e.g. the numbers of infectious individuals) are hidden
and observed only indirectly (through the numbers of confirmed cases, for
instance). Obviously, once any of these phenomena are handled insufficiently,
models can provide incorrect policy recommendations.
Mathematical statistics has developed tools to handle these issues. However, to our best knowledge, there is no work systematically doing so for
compartmental epidemic models. The goal of this paper is to make some
progress in this area by proposing a general stochastic epidemic modelling
framework.
Stochastic epidemic models do obviously exist [3]. Apart from agentbased models [2], they are commonly formulated as Markov chains [9] or
stochastic differential equations [7]. However, many of these studies are
2

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

theoretical, examining behavior models they construct without providing any
link to real data and hence an estimation procedure. On the other hand,
many other studies use elaborate filtering methods to estimate parameters
of their epidemic models, but these models are largely deterministic. Their
statistical models serve just as tool on the way to understand specific epidemics
[24, 27]. Here, we bridge these two approaches, precisely formulating and
analyzing a general stochastic epidemic model, discussing its highly practical
implications, as well as providing an estimation procedure exemplified on
the COVID-19 epidemic in the Czech Republic. Due to practical reasons,
we develop our model as discrete in both time and state space. Although
applicable to a wide class of compartment settings, we call our framework
the SEIR Filter.
Models close to our model were developed by [15, 23]. To estimate their
parameters, the authors used Monte Carlo simulations to evaluate likelihood
functions. On contrary to these (and many other) studies, our framework
enables model parameters to be estimated in a straightforward way, since
the exact likelihood (or other estimating) function can be derived. This
approach makes faster and more reliable parameter estimation possible. In
addition to the tractability of the estimating function, our model allows
for closed form formulas for expected future compartment sizes and the
reproduction number. In addition, we provide simple criteria for vanishing
and explosion of the epidemic, as well as for bounds that limit expected
epidemic sizes given stationary imports. As we demonstrate by stylized
examples, many applications of the model are possible, including derivation of
implicit formulas regarding compensation measures to intervention relaxation
or non-compliance, and of optimal control strategies; in this way, we touch,
yet not solve, the questions mentioned above.
From the mathematical statistics perspective, we model the epidemic
by a partially observed inhomogeneous heteroskedastic vector autoregression
process. In line with the usual practice [8], we assume over-dispersed probability distributions both for the infections and the between-compartmental
transitions; thanks to this, we are able to handle realistically not only point
estimators, but also the uncertainty associated with them. Moreover, having
a standard statistical output of the parameters estimation, we are able to
answer questions concerning significance (via P-values7 ), possible co-linearity
7

It should be, however, noted that we do not prove asymptotic properties of the

3

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

(via the estimator’s correlations) and the hidden compartments states (via
the estimate of state-space distribution).
To demonstrate usefulness of our framework, we apply it to the actual
COVID-19 epidemic in the Czech Republic. In particular, we consider four
age cohorts, for each of which we model incidence, admission to– and release
from hospitals and deaths. To estimate the model’s parameters, we use
several partially overlapping datasets; the ability to create statistically correct
estimates based on such heterogeneous datasets is, in our opinion, one of
the greatest contributions of our approach. We demonstrate both in-sample
and out-of-sample prediction ability of our model and, as an example of
its possible use, we compare three strategies of vaccination: no vaccination,
vaccination without preferences and the old-first strategy.
The paper is organized as follows. After a rigorous probabilistic formulation of the model (Section 2), we discuss its basic probabilistic properties
(Section 3), its autonomous sub-models and the reproduction number (Section
4), and its asymptotic properties (Section 5). Next we introduce an agestructured version of the model (Section 6) and suggest a way to optimally
control the epidemic (Section 7). Further, we discuss estimation of model
parameters (Section 8). Finally, we apply our model to the COVID-19
epidemic in the Czech Republic (Section 9) and demonstrate possible model
applications by comparing three possible vaccination scenarios (Section 10).
Section 11 then concludes the paper.
2. Model Definition
Assume a population of size s ∈ N, where s is large. Each individual of the
population is either susceptible, or finds himself in one of the compartments
S1 , . . . , Sk . Let It ∈ Nk0 , t ∈ N+
0 , be a possibly hidden external inflow (import)
of individuals into the compartments and let Zt ∈ Rp , t ∈ N0 , be an observed
exogenous process.
For any t ∈ N0 , let Xt = (Xt1 , . . . , Xtk ) ∈ Nk0 , t ∈ N0 , be a possibly hidden
stochastic process of the compartment sizes which we define later. Let
Y t ∈ Rn ,

Yt = F Xt + t ,

t ∈ N0 ,

be a process of observations where F is a deterministic n × k matrix with
rank n, and t is a random errors vector.
estimators.

4

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Denote (Ft )t≥0 and (Gt )t≥0 the filtrations induced by (X, Y, I, Z) and
(Y, Z), respectively. These filtrations may be seen as information flows,
(Ft )t≥0 representing time evolution of all the information and (Gt )t≥0 representing
the evolution of the observable observable. Recall that a random variable ξ
is measurable with respect to σ-algebra σ(Ξ) generated by a random element
Ξ if and only if there exists a measurable function Φ such that ξ = Φ(Ξ).
Thus, saying that ξ is Gt -measurable (abbreviated as ξ ∈ Gt ) means, that ξ
may be devised from the values of (Y, Z) up to t.
We assume that
E(t+1 |Ft ) = 0,

var(t+1 |Ft ) = diag(Γt (Xt , Xt2 )),

t ∈ N0 ,

where Γt is a Gt -measurable affine linear function (i.e. Γt (x, y) = γt,0 +γt,1 x+
γt,2 y for some γt,0 ∈ Rk and γt,1 , γt,2 ∈ Rk×k where all γt,0 , γt,1 and γt,2 are
Gt -measurable).
We define X recursively: We let X0 to be a possibly random vector and,
for any t ∈ N, we put
Xt+1 = It + Nt+1 + M1,t+1 + · · · + Mk,t+1 .
Here, Nt+1 ∈ Nk0 is the inflow of domestically infected individuals such that
Nt+1 |Ft ∼ CPo(At Xt , L) where At = (αtij )1≤i,j≤k ∈ Gt is a random matrix and,
for any vector x, CPo(x, L) stands for a vector of independent Compound
Poisson variables with the intensities given by x and the embedded distribution
L. Observe that, by basic properties of Compound Poisson distribution,
i
2
|Ft )
var(Nt+1
def EL
=
v
=
i
E(Nt+1
EL
|Ft )
def

2

(with 00 = EL
), t ≥ 0, 1 ≤ i ≤ k. Further, for any i, Mi,t+1 ∈ Nk0 such
EL
j
that Mi,t+1 (the j-th component of Mi,t+1 ) is the number of individuals
who transited from the compartment j to the compartment i between t to
t + 1. Further we assume Mi,t+1 , for any i, tofollow Dirichlet Multinomial

(DM) conditional distribution with parameters Xti ,

p1,i
pk,i
t
t
,
.
.
.
,
ci
ci

where Pt =

(pij
t )1≤i,j≤k

∈ Gt is a “mean” transition matrix and (c1 , . . . , ck ) are deterministic
dispersion parameters.
Remark 1. If we assumed the individuals to change their state according to
Pt with the transitions being conditionally independent given Ft , then we
5

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

(i)

would get Mi,t+1 |Ft as Multinomial with parameters Xti and Pt where, for
any matrix Σ, Σ(i) is its i-th column. In practice, however, the assumption of
the conditional independence is unrealistic, as the course of infection differs
between individuals and tends to cluster. The standard way of coping with
this situation is using DM distribution.
The flow of individuals between states is illustrated by the following chart.

Finally, we assume Nt+1 , M1,t+1 , . . . , Mk,t+1 , t+1 to be mutually conditionally
independent given Ft (which, in words, means that all dependence between
the inflows, the transitions and the observations can be explained by the
state of the system at t). Consequently,


i 1 (i)
◦ CPo(At Xt , L) ◦ δ(It ),
Xt+1 | Ft ∼ 1≤i≤k DM Xt , Pt
ci
where
and ◦ stand for the summation of (mutually) independent random
vectors.
Remark 2. The variability of the individual infectiousness may be naturally
reflected by the choice of L. To demonstrate it, assume that only a single
compartment (labeled I) is infectious, that all new infections fall to a single
compartment (labeled E), and that the number of risk contacts of each
infectious individual is Poisson. Let t ≥ 0 and denote Nt+1,i the number
of the infections, caused by the i-th individual at t.
If the intensity of the contact distribution and the contagion probability
were the same for all individuals, and equal to c and p, respectively, then it
6

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

E
would be Nt+1,i ∼ Po(cq), i ∈ N; consequently, Nt+1
∼ Po(λXtI ), λ = cq, so
EA
E
E
we may put αt = λ and L = δ1 , having E(Nt+1 |Ft ) = var(Nt+1
|Ft ) = λXt .
Now consider a more realistic situation in which the infectiousness randomly
varies between individuals. A standard way of modeling this situation is
assuming, for each i, that the intensity λi of Nt+1,i is chosen from Gamma
distribution, implying that Nt+1,i is negative binomial (see [28]). In particular,
once λi ∼ Γ(k, θ), and Nt+1,i |λi = Po(λi ), we are getting that Nt+1,i ∼
θ
, with
NB(k, p), p = 1+θ
def

ENt+1,i = κ = θk,

var(Nt+1,i ) = κv,

κ
v =1+ .
k

(1)

As the Negative Binomial distribution can be represented by a Compound
Poisson one and as the sum of independent Compound Poisson distributions
E
is Compound Poisson8 and it follows
is Compound Poisson, we have that Nt+1
from (1) that
E
E(Nt+1
|Ft ) = κXt ,

E
var(Nt+1
|Ft ) = κXt v

Remark 3. The authors of [6] claim that the total number T of individuals
infected by a single COVID-infectious individual is T ∼ NB(K, P ) where
.
K = 0.1 and P is such that ET = R0 where R0 is the basic reproduction
number. As R0 of COVID-19 is generally assumed to be around 2.5 and
.
P
ET = K 1−P
, it follows that P = 25
. Consequently, the variance-to-mean
26
def
.
1
ratio is ṽ = 1−P
= 26. Assuming that an individual is infectious for f days
and that his contacts are restricted by a factor β, we may, in light of the
Compound Poisson reformulation of T , conclude that the number Nt+1,i of
daily infected individuals is Compound Poisson with EN = βf ET, var(N ) =
β
E
var(T ), i.e. Nt+1,i and consequently Nt+1
has the same variance-to-mean
f
.
ratio as T , i.e. v = ṽ = 26.
P
Remark 4. For any x ∈ N0 , c ≥ 0 and p ∈ [0, 1]k such that ki=1 pi = 1, we
have

p 
E DM(x, ) = px = E (Multinomial(x, p))
c
8

In particular, Nt+1,i = CPo(k ln(1 + θ), Log(p)), where Log is the Logarithmic
E
∼ CPo(XtI k ln(1 + θ), Log(p)) so we may put αtEA =
distribution ([28]). Thus, Nt+1
k ln(1 + θ), L = Log(p).

7

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

and

p 
x+c
x+c
var DM(x, ) = [diag(p) − ppT ]
x = var(Multinomial(x, p))
,
c
1+c
1+c
from which it is clear that DM(x, pc ) → Multinomial(x, p) as c → ∞ and that
the deviation of the Multinomial variance matrix grows with decreasing c.
3. Model Properties
By probability calculus, we get that
k
X

E(Xt+1 |Ft ) = E(Tt Xt + It |Ft ) = E

!
Mt+1,i + Nt+1 + It Ft

i=1
k
X

(i)

Pt Xti + (EL)At Xt + It = Tt Xt + It ,

i=1

where, for any matrix Σ, Σ(i) denotes its i-th column, and
def

Tt = Pt + Bt ,

def

Bt = (βti,j )1≤i,j≤k = (EL)At ,

t ≥ 0.

(2)

Consequently, for any t, s ∈ N0 , t > s,
E(Xt |Fs ) = E(Ts,t−1 Xs +

t−1
X

Tθ+1,t−1 Iθ |Fs )

θ=s

= E(Ts,t−1 |Fs )Xs +

t−1
X

E(Tθ+1,t−1 Iθ |Fs ),

θ=s
def

def

where, for any matrix process Σ, Σs,t = Σt × · · · × Σs with Σs,s−1 = E
where E is the identity matrix.
In the special case that
Bτ ≡ Bs ,

Pτ ≡ Ps ,

we have
E(Xt |Fs ) = Tst−s Xs +

t−1
X
τ =s

8

s ≤ τ ≤ t,

Tst−τ −1 E(Iτ |Fs ),

(3)

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

and
E(Xt |Gs ) =

Tst−s E(Xs |Gs )

+

t−1
X

Tst−τ −1 E(Iθ |Gs )

τ =s

If, in addition, E(Iθ |Gs ) ≡ µ for some µ ∈ Gs and (E − Ts ) is invertible, the
latter formula simplifies to
E(Xt |Gs ) = Tst−s E(Xs |Gs ) + (E − Ts )−1 (E − Tst−s )µ.
As for variance, we have
k
X

var(Xt+1 |Ft ) =

var(Mt+1,i |Ft ) + var(Nt+1 |Ft ) + var(It |Ft )

i=1




i 1 (i)
=
var DM Xt , Pt
+ var(CPo(At Xt , L)) + 0
c
i
1≤i≤m
X

=

X X i + ci
(i)
(i)
(i)
t
Xti [diag(Pt ) − Pt (Pt )T ] + diag(vBt X)
1 + ci
i≤t≤m
= Λt (Xt , Xt2 )

where
def

Λt (x, y) =

k
X
y i + x i ci
i=1

1 + ci

(i)

(i)

(i)

[diag(Pt ) − Pt (Pt )T ] + diag(vBt x)

(note that Λt is linear in x, y). Consequently,

  
Xt+1
E
E
Ft =
(Tt Xt + It ),
Yt+1
F

var

Xt+1
Ft
Yt+1



 T


 
E
0k
E
2
Λt (Xt , Xt )
+ diag
,
=
F
F
Γt (Xt , Xt2 )

(4)

t ≥ 0.

4. Sub-epidemics and Reproduction Number
We say that the subset of compartments D = {s1 , . . . , sm } is subepidemic
if, for any t and any i ∈ D and j ∈
/ D, βtij ≡ β ji ≡ 0 and pij
t ≡ 0. In words
this means that, for any i ∈ D, the i-th compartment does not increase
9

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

through direct infection, the infection does not depend on the compartment,
and it is impossible to get to the state i once being outside D.
Let, after a possible re-ordering, m ∈ N be such that {1, . . . , m} is
subepidemic (such m always exists because it can be always put to k). For
any vector x ∈ Rk , denote x its restriction to (1, . . . , m) and, for any matrix
A ∈ Rk×k , denote A its restriction to (1, . . . , m) × (1, . . . , m).
Observe that X follows a slightly modified version of our model, namely
i 1 (i)
X t+1 Ft ∼ 1≤i≤m DM− (X t , P t , c) ◦ CPo(B t X t , L) ◦ δ(I t ).
c
−
m
where, for any x ∈ N0 , α ∈ R+ and c > 0,
 DM
h (x, α, c)
i is the marginal

distribution of the first m components of DM x, c−Pαm αi (by the aggregation
i=1
property of DM).
For any t, we define the reproduction number rt (of a subepidemic {1, . . . , m})
as
∞
X


def
1T E(Bτ P t,τ −1 |Ft−1 )πt ,
πt = E ν N t + I t−1 Ft−1 .
rt =
τ =t

where ν is unit normalization of a vector (recall that P t,s = P t × · · · × P s ).
Observe that rt complies with the usual definition of reproduction number
as it equals to the conditional expectation (w.r.t. Ft−1 ) of the infections
caused by an individual having arrived at t. To see it, note that πt is the
conditional distribution of the state in which a randomly chosen newcomer
(the one brought by the import or by the infection) finds himself at t, and
observe that, for each newcomer at t, the expected number of those infected
by him at t + 1 is given by the sum of the components of B t πt , the expected
number infected at t + 1 is given by the sum of components of B t+1 P t πt etc.
If Ft 6= Gt (i.e. X is not fully observed), then the reproduction number has
to be estimated, most naturally by its conditional expectation with respect
to the known information:
∞
X
def
r̃t = E(rt |Gt ) =
1T E(B τ P t,τ −1 πt |Gt−1 ).
τ =t

In the special case of B τ ≡ B t−1 , P τ ≡ P t−1 , τ ≥ t, with ρ(P t−1 ) < 1 where
ρ is the spectral radius, the formula simplifies to
!
∞
X
i
r̃t = 1T B t−1
P t−1 E(πt |Gt−1 ) = 1T B t−1 (E − P t−1 )−1 E(πt |Gt−1 ).
i=0

10

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Note that, once N and/or I are possibly not observed, there could be difficulties
.
computing E(πt |Gt−1 ). Although the estimate E(πt |Gt−1 ) = ν(B t−1 E(X t−1 |Gt−1 )+
E(I t−1 |Gt−1 )) seems a straightforward choice, it is generally not unbiased due
to the normalization. This problem, however, vanishes if the imports and
new infections all fall into a single state (typically called exposed and labeled
E), in which case πt ≡ (1, 0, . . . , 0)T .
5. Asymptotic Behavior
Keep assuming that {1, . . . , m} is subepidemic. The next Proposition
states conditions for vanishing, explosion and “stationary” behavior of the
subepidemic.
Proposition 5. (i) If T t ≤ S component-wise, where S is deterministic with
def
σ = ρ(S) < 1, and if EI t = o(t−α ) for some α > 0, then X t → 0 almost
surely. Here, ρ denotes the spectral radius of a matrix.
def
(ii) If T t ≥ R where R is deterministic irreducible with % = ρ(R) > 1 and
either EX 0 6= 0 or EI τ 6= 0 for some τ , then kEX t k → ∞.
def
(iii) If EI t ≡ µ for some µ and R ≤ T t ≤ S such that σ = ρ(S) < 1, then
lim inf EX t ≥ (E − R)−1 µ,

lim sup EX t ≤ (E − S)−1 µ

t

t

Proof. (i) We have
EX t = E(E(X t |G0 )) = E(T 0,τ −1 X0 +

t−1
X

T θ+1,t−1 E(I θ |G0 ))

θ=0

≤ E(S t X0 +

t−1
X

S t−θ−1 E(I θ |G0 )) ≤ at +bt,

at = S t EX 0 ,

bt =

θ=0

t−1
X

S t−θ−1 EI θ

θ=0

Thanks to the sub-unit spectral radius of S, we have at → 0. Further, by the
non-negativity of H and the properties of convergence, there exists c ∈ Rm
+
such that EI t ≤ c(t + 1)−1 . Thus, for any ς fulfilling σ < ς < 1, we get, after
re-indexing the sum,
 τ /α α
t−1
t−1
t−1
X
X
X
1
1
ς
τ
τ
−1
τ
bt =
S EI t−τ −1 ≤
S c
= α ×
(ς S) c
→ 0;
α
(t − τ )
t
t−τ
|{z}
τ =0
τ =0
τ =0
|
{z
} | {z }
→0

11

→(E−ς −1 S)−1 c

≤d

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

the second convergence holding because ρ(ς −1 S) =
d existing as f (τ )

def tς τ /α
= t−τ

σ
ςt

< 1, the upper bound

increases in τ = t − 1 and its derivative has only
t−1

def

a single root, so we have f (τ ) ≤ max(f (0), f (t − 1)) = max(1, ς α t) ≤ d =
max(1, eς 1/α |α1−1 ln ς| ) on [0, t − 1]. Finally, thanks to the non-negativity of X,
convergence of EX t suffices for a.s. convergence of X t .
(ii) Let EX 0 6= 0 and % > 1. As R is irreducible non-negative % is its
eigenvalue and the corresponding eigenvector x is positive by the PerronFrobenius Theorem. Further, by the irreducibility of T , there exists n such
def
that y = Rn EX 0 > 0 component-wise, so there exist e > 0 such that y ≥ ex.
Thus
EX t ≥ Rt EX 0 ≥ Rt−n y ≥ eRt−n x
norm of which converges to infinity. The proof for EI τ 6= 0 is analogous.
(iii)

EX t =

t−1
X

T τ,t−2 µ+T 0,t−1 EX 0 ≤

τ =0

t−1
X
τ =0

τ

S µ+S

t−1

EX 0 → (

∞
X

S τ )µ = (E−S)−1 µ

τ =0

and similarly for R.
Example 6. Say there are five states E – exposed, Ia – infectious asymptomatic, who will never show symptoms, Ip – infectious pre-symptomatic, who will
later show symptoms, Is – infectious symptomatic, and R – removed, which
includes the recovered, the dead, and the infectious isolated. We index the
states by e, a, p, s, r. For simplicity we assume v = 1 which means that the
new infections follow a Poisson distribution rather than a Compound Poisson
one. All the infectious states are equally infectious, i.e. βtex = βt , x ∈
{a, p, s}, where β is a Gt -adapted process. The probability that the exposed
transits to {a, p} is σ, the probability of completely asymptomatic course is
α, the probability of transition from Ip to Is is ς. Further, the probability of
ending Ia or Is , by natural causes (recovery, end of infectiousness, death in
case of Is ) is %a , %s , respectively. Finally, the probability that a symptomatic
individual isolates himself is η and the probability that the individual finding
herself in state E, Ia , Ip or Is is isolated is θt for some Gt -adapted process θi .
The situation is illustrated on the following Figure:
12

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

If we neglect (small) joint probabilities of natural exits from the infectious
states and the isolations, we get


1 − σ − θt
0
0
0
0

ασ
1 − %a − θt
0
0
0 


,
(1
−
α)σ
0
1
−
ς
−
θ
0
0
Pt = 
t



0
0
ς
1 − %s − η − θt 0 
θt
θt + %a
θt
θt + η + %s
1


0 βt βt βt 0
 0 0 0 0 0 



Bt = 
 0 0 0 0 0 
 0 0 0 0 0 
0 0 0 0 0
Clearly, we can put m = 4 (the first four states form a sub-epidemic), getting
T t = Q + βt C − diag(θt , θt , θt , θt ),


1−σ
0
0
0
0 1



ασ
1
−
%
0
0
0 0
a
,
Q=
C=
 (1 − α)σ


0
1−ς
0
0 0
0
0
ς
1 − %s − η
0 0


1
0
0
0


1
0 
.
0 
0

By the well known rule, ρ(T t ) = ρ(Q + βt C) − θt . We consider two ways of
decreasing the spectral radius: decreasing the infection rate βt (typically by
wide counter-epidemic measures) and increasing the isolation rate θt (e.g. by
strengthening the testing and tracing capacity).
13

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Once there is a “target” spectral radius ρ0 , all the combinations of β and
θ yielding ρ(T t ) = ρ0 fulfill ρ0 + θ − ρ(Q + βC) = 0, which gives a “marginal
∂
ρ(Q + βC) of the infectiousness by the
rate of substitiution” θ(β)0 = − ∂β
isolation, i.e. how much we have to increase the isolation speed when we
release the restrictions.
Example 7. Assume that a fraction ν of the population is non-compliant,
which means that, once a restriction on social contacts is imposed, they obey
it only partially. Assume that, without restrictions, the population is mixed
which means that each individual, compliant or not, has, up to a constant,
(1 − ν) contacts with the compliant individuals and ν contacts with the noncompliant ones. Once there is a measure imposed, the compliant individuals
restrict their opportunities to contacts by φ, while the non-compliant ones
do so only to f (φ) > φ . As a result, the compliant ones will have, up to a
constant, φ2 (1 − ν) contacts with the compliant ones, φf (φ)ν contacts with
the non-compliant ones, while the non-compliant will have φf (φ)(1 − ν) and
f (φ)2 ν contacts with the compliant, non-compliant, respectively.
Assuming a simple epidemic model with compartments Ic - infected compliant, In - infected non-compliant, and R - removed, with the course of
infection being the same for both the compartments such that βt1i = βci ,
i ∈ {1, 2}, where β is a constant and ci is the number of contacts of the i-th
sub-population, this gives




1−%
0
0
βφ2 (1 − ν)
βφf (φ)ν 0
1 − % 0 ,
Bt =  βφf (φ)(1 − ν) βf (φ)2 ν 0 
Pt =  0
%
%
1
0
0
1
where % is a removal rate (perhaps consisting of an artificial and a natural
part). This gives


φ2 (1 − ν)
φf (φ)ν
T t = βC + (1 − %)E,
C=
φf (φ)(1 − ν) f (φ)2 ν
with
%(T t ) = βρ(C) + (1 − %).
As the characteristic polynomial of C is
λ2 − λg,

g = g(φ, ν) = φ2 (1 − ν) + f (φ)2 ν

we clearly have ρ(C) = g.
14

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Now say that our goal is to decrease ρ(T t ) to a predetermined value r by
finding appropriate φ = φ(ν). In order to do so, we have to solve
βg(φ(ν), ν) + (1 − %) = r.
q
def
r−1+%
. For ν > 0 we get, by the Implicit function
Clearly, φ(0) = φ0 =
β
theorem,
∂
f (φ(ν))2 − φ(ν)2
φ=
.
∂ν
2φ(ν)(1 − ν) + 2f (φ(ν))f 0 (φ(ν))ν
Note that the derivative depends neither on r nor on %. Thus we can
easily compute how the non-compliance influences strictness of the necessary
restrictions. For instance, by the first-order Taylor expansion at ν = 0, we
get

f (φ0 )2 − φ20
ν
f (φ0 )2
.
φ(ν) = φ0 + ν
= φ0 1 −
+ν
,
2φ0
2
2φ0
roughly holding for ν close to zero.
6. Cohort Model
In the present Section, we assume the population is split into r (age)
cohorts of sizes s1 , . . . , sr , s1 + · · · + sr = s. The members of each cohort
may be either susceptible or belong to one of κ analogous compartments.
Naturally assuming that individuals do not migrate between cohorts, we get
the overall transition matrix as


Pt1 0 · · · 0
 0 P2 ··· 0 
t


Pt =  ..

.. . .
 .
. 0 
.
0
0 · · · Ptr
where Pti are κ × κ cohort transition matrices, 1 ≤ i ≤ κ, t ≥ 0. Note
that once there are dispersion parameters ci1 , . . . , ciκ associated with each
matrix Pti (meaning that, once the j-th compartment of the i-th cohort
is of size x, the transfers from the cohort to the cohort’s compartments
i (j)
follow DM(x, (P cj) )), the dispersion parameters of the overall model are
i

(c11 , . . . , c1κ , c21 , . . . c2κ , c31 , . . . . . . , crκ ).

15

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

We assume that the contagions can happen across cohorts and that the
probability of contagion, i.e. the transfer of a susceptible individual to the ith compartment of the p-th cohort, upon a risk contact with a member of the
j-th compartment of the q-th cohort does not depend on p or q, being equal to
$tij . Further we assume that, on average, a member of the p-th cohort has ν pq
risk contacts with the q-th cohort, assuming that the number of contacts with
the infectious compartments (those with non-zero $ti• ) is equal. Under these
assumptions, the probability of a transfer of a susceptible individual from
i
Pr Pk
def
pq ij Xtq
cohort p into the i-th compartment is roughly epi
t = bp
q=1
j=1 ν $t sq ,
where Xtqi is the size of the i-th compartment of cohort q and b is a constant.
Consequently, the total number of the infections in the i-th compartment of
the p-th cohort will be sp epi
t , which gives
Bt = Q ⊗ Ct
where



Q=


b1 ν 11 b1 ν 12 ss21 · · · b1 ν 1r ssr1
b2 ν 21 ss21 b2 ν 22 · · · b2 ν 2r ssr2
..
..
..
...
.
.
.
br ν r1 ssr1 br ν r2 ssr2 · · · br ν rr




,





Ct = 


$t11 $t12
$t21 $t22
..
..
.
.
$tk1 $tk2

· · · $t1k
· · · $t2k
..
...
.
· · · $tkk




.


It may be convenient to re-parametrize the model by multiplying C by a
constant and adjusting constants b; in this case, however, the components of
C cease to be interpretable as probabilities.
7. Optimal Control of the Epidemic
Assume the settings of Example 6 and assume that X0 is known. Our
aim is to minimize the size of the epidemic at time t given that we are ready
to pay a given price c0 . We assume that, to achieve infection rate β, a cost
γ(β) has to be paid where γ is a strictly decreasing convex positive function
defined on (0, β0 ] with γ(β0 ) = 0 and γ(0−) = ∞. Further, to achieve the
def
isolation rate θti in the i-th compartment, the price δ(θti , Xti ) = dθti Xti has to
be paid where d is a constant. This reflects the real-life situation in which
the cost of global restrictions does not depend on the infection size while the
cost of isolation does, for instance through the number of call-center workers
involved in tracing.
16

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Our problem is to find
def

V0 (X0 , c0 ) =

inf

Pt−1

k
k
k
k
τ =0 [γ(βτ )+δ(θt ,Xt )+···+δ(θt ,Xt )]≤c0 ,β,0≤θ≤q,θτ ∈Fτ ,βτ ∈Fτ ,1≤τ <t

E(10 Xt )

where q is the diagonal of Q. The problem may be rewritten by means of
Bellman equations
Vτ (x, c) =

inf

γ(β)+dθk xk +···+dθk xk +y≤c,β≥0,θ≥0,y≥0

E(Vτ +1 (J, y)),

0 ≤ τ < t,

Vt (x, c) = 10 x,
def

J ∼ L(x, β, θ) =

− i
(i)
1≤i≤m Multinomial (x , Q

− ∆i θi ) ◦ Po(βCx)

where ∆i is the vector with the unit component on the i-th place and zeros
otherwise.
Though the final problem is convex,
Vt−1 (x, c) =

γ(β)+dθ1 x1 +···+dθ

inf
m m

x +y≤c,0≤θ≤q,β,y≥0

10 (Qx−diag(θ)x+∆e β

X

xi ),

i6=e

its objective function is not jointly convex in (u, v, x, c), so the convexity
of Vt−1 is not guaranteed. Moreover, as neither the optimal solution nor
the expectation of the objective functions of all but the last problem are
analytically tractable, it is necessary to resort to approximations. To this
end, we can use the sample mean approximation
.
Vτ (x, c) = V˜τ (x, c)
where Ṽt = Vt and, recursively,
.
def
Vτ (x, c) = V˜τ (x, c) =

r

1X
inf
Ṽτ +1 (Ji , y)
γ(β)+dθk xk +···+dθk xk +y≤c,β,θ,y≥0 r
i=1

where J1 , . . . , Jr is an i.i.d. sample from L(x, β, θ).

17

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

8. Estimation
For any stochastic process A and integers s ≥ t, denote Âs|t = E(As |Gt ).
Let s > t. When Tτ ∈ Gt , t < τ ≤ s − 1 (which is trivially true if s = t + 1),
we get that
"

X̂s|t

#

Ŷs|t

  
   

Xs
E
ˆ
=E E
Fs−1 Gt =
Ts−1 X̂s−1|t + Is−1|t
Ys
F
!
 
s−1
X
E
=
Tt,s−1 Xt +
Tθ+1,s−1 Iˆθ|t ,
F
θ=t

def

Ws|t = var ( Xs | Gt ) = var (E ( Xs | Fs−1 )| Gt ) + E (var ( Xs | Fs−1 )| Gt )

2
= var (Ts−1 Xs−1 + Is−1 |Gt ) + E Λs−1 (Xs−1 , Xs−1
) Gt
T
= Ts−1 Ws−1|t Ts−1
+ 2Ts−1 cov(Xs−1 , Is−1 |Gt ) + var (Is−1 |Gt )
2
+ Λs−1 (X̂s−1|t , diag(Ws−1|t ) + X̂s−1|t
)
2
)|Gt ) =
(we have used linearity of Λs−1 , thanks to which E(Λs−1 (X̂s−1|t , Xs−1
2
Λs−1 (E(Xs−1 |Gt ), E(Xs−1 |Gt )), and the well known formula var(X) = EX 2 −
(EX)2 ). Consequently,




Xs
Xs
def
Gt = var
Gt
Vs|t = var
Ys
F Xs + s
!
 
 T
0k
E
E
.
=
Ws|t
+ diag
2
F
F
Γs−1 (X̂s−1|t , diag(Ws−1|t ) + X̂s−1|t
)

Unfortunately, due to the non-Gaussianity, we have analytical formulas for
none of Xt|t , It|t and Wt|t , so we can formulate neither the likelihood function
nor a least square estimate. From the computational point of view, two
equivalent ways to cope with this are using estimates of the conditional
expectation and variance, or normally approximating
the residuals. We
h
i
Xt+1
choose the latter way here and assume that Yt+1 Ft is normal, with mean
given by (4) and

 T

  

Xt+1
E
0k
E
2
var
Ft =
Λt (Xt ∨ 0, Xt )
+ diag
.
Yt+1
F
F
Γt (Xt ∨ 0, X2t )
18

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Moreover, we assume that It ∈ Gt , t ≥ 0 (i.e. the import is observable).
Given these assumptions, we have, by the well-known formula (see e.g. [5]),


def
XY
Y Y −1
X̂t|t = It−1 + X̂t|t−1 + Kt Yt − Ŷt|t−1 ,
Kt = Ṽt|t−1
(Ṽt|−1
)
Y Y −1 Y X
XY
XX
) Ṽt|t−1
(Ṽt|t−1
− Ṽt|t−1
var(Xt |Gt ) = Ṽt|t−1

h i
where Ṽs|t = var( XYss |Gt ) given the normal approximation. Note that Kt
may be seen as a conditional version of the Kalman gain matrix.
If P[X̂t < 0] is negligible (which is typically true when modeling large
epidemics), then we can neglect truncation in the formula for the variance
.
approximate Ṽt|s = Vt|s . This further gives
def

.
Kt = Wt|t−1 F T Dt−1 ,
Dt = F Wt|t−1 F T + diag(Γt X̂t|t−1 ),
.
Wt|t = Wt|t−1 − Wt|t−1 F T Dt−1 F Wt|t−1 .
Assume that F = F (Θ0 ), Pt = Pt (Θ0 ), Bt = Bt (Θ0 ), Γt = Γt (Θ0 ),
It = It (Θ0 ), and c = c(Θ0 ), where Θ0 ∈ Rr is an unknown parameter. For
its estimation, it is possible to use either nonlinear least squares, i.e.
X
(Yt − Ŷt|t (Θ))T Ut (Yt − Ŷt|t (Θ))
Θ̂ = arg min
t

where Ut ∈ Gt−1 is a suitable weighting matrix, or
Θ̃ = arg min

X

ϕ(Yt −Ŷt|t (Θ), Dt (Θ)),

t

ϕ(x, v) = −

k ln 2π + ln det(v) + xT v −1 x
.
2

Both these estimators are consistent and asymptotically normal under some
conditions, see [12] and [13], respectively. Verifying these conditions for our
model is, however, beyond the scope of this introductory study and remains
the topic of a future research.
It should be noted that our proof of Proposition 5 is not valid for the
approximate model, as X is not necessarily positive given the Normal approximation.
9. Application to The COVID Pandemics in the Czech Republic
We applied our model to the data from the Czech Republic epidemic
between February 2020 and January 2021. We considered a widely generalized
19

C65

C80

Ca

Cs

5000
0

0

5000

10000

C20

10000

C0

15000

15000

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Jan

Ry

Ro

600
400
200
0

0

200

400

600

800

Ho

800

Hy

Nov

1000

Jan

1000

Nov

Jan

Do

∆y

∆o

0

0

10

50

20

100

30

150

40

Dy

Nov

50

Jan

200

Nov

Jan

D20

D65

D80

Jan

I0

I20

I65

I80

0

0

20

50

40

60

100

80

D0

Nov

100

150

Nov

Nov

Jan

Nov

Figure 1: Inputs of the Czech COVID-19 model

20

Jan

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Figure 2: Structure of the Czech COVID-19 model.

21

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

version of the model from Example 6, compartments of which are shown in
Figure 2.
To reflect the fact that many cases are (intentionally) undetected, we
added the compartment Iu . Members of Iu can be detected only if they
are hospitalized or die, otherwise they never undergo testing. Further, to
all the compartments from Example 6, we added their “detected” versions,
distinguishing detection when being asymptomatic (subscript δ) or symptomatic (subscript d). We distinguish three “removed” states: recovered
(R), hospitalized (H) and dead (D). Assuming that each individual who
gets to the hospital is detected upon entry, we have two versions of H
states: detected when symptomatic (Hd ) and detected when asymptomatic
(Hδ ). Similarly, we assume that each dead is detected and we distinguish
whether the individual dies in- or outside of hospital; consequently, we have
four “dead” states: Dhd , Dd ,Dhδ and Dδ . The case of R is analogous with
the exception that recovery can happen without detection, so we have five
versions: R, Rdh , Rd ,Rδh , and Rδ .
We distinguish four age cohorts: 0 to 19 years, 20 to 64 years, 65 to 79
years and more than 80 years; consequently, having four compartments for
each state, we have 4 × 21 = 84 compartments in total.
Some transition parameters (components of Pt ) are common for all compartments (black symbols in Figure 2), the others are specific for each compartment (blue symbols). Some parameters are constant in time, some (these
with index t) are time varying. The values of some parameters were externally
determined, some were estimated. The detailed description of parameters,
way of their determination, computation or estimation, and their estimated
values can be found in Appendix, Table 2 and below. Here we only mention
that we take
θt = ϑ0 + ϑ1 qt ,
(5)
where qt is the observed probability that an infectious individual is accepted
to hospital without being previously detected, which, by the Bayes rule, is,
up to a constant, equal to the overall detection probability. The rate πt is
set so that the detection probability holds in the model (see the Appendix).
The value of qt is publicly available as it is, as of February 2021, one of the
input of the national counter-epidemic system PES.
The normalized “mixing matrix” Q has been computed from the estimate
of the Czech overall contact matrix by [22], and is listed in Appendix, Table
3.
22

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

In line with [21], reporting 3 − 25 times lower secondary attack rate of
asymptomatic individuals, we assume that the probability of infection by Ia
is four-times less in comparison with Ip , Is and Iu . Further, we assume
the dependence of infectiousness on the contact restriction and personal
protection, and we reflect the natural immunization. Namely, we have
$tEIs = $tEIú = $tEIs = $t ,

1
$tEIa = $t ,
4

$t• = 0 otherwise,

where
$t = gt ht υt−7 pt−7 .

(6)

Here, υt is the average number of weekly risk contacts of an individual,
P
def

k

X̂ i

pt is the reduction caused by personal protection, ht = 1 − i=1s t|t is
the adjustment for immunization (we assume that once infected individuals
cannot be infected again), and gt is the adjustment for new mutations, see
Appendix for details.
The values of υt and pt were taken from [20] which is a longitudinal study,
inquiring a panel of 3000 respondents about their (weekly) risk contacts,
observance of several personal protection measures (see Appendix), and some
other variables. While the value of υt is being directly questioned by the
survey, we compute the level pt of personal protection as
pt = ω0 exp{−ωe et−7 − ωf ft−7 }

(7)

where et is a certain linear combination of observation rates of various personal
protective measures, ft is the reported level of fear caused by the pandemic
and ω0 , ωe and ωf are constants (see Appendix for further explanation).
For better comparison with other models, we use normalized version of
def
the personal contacts level wt = υυ0t where υ0 is the pre-pandemic value of
υ, so we have, up to constant multiplication,
$t = gt ht wt−7 exp{−ωe et−7 − ωf ft−7 };

(8)

with the corresponding constant becoming part of estimated parameters
b0 , b20 , b65 and b80 .
As for the dispersion parameters, we assume v = 26 (see Remark 3)
and, for each cohort i, we put cix ≡ ch , x ∈ {Hdi , Hδi } (all “hospital” states)
and cix ≡ ca otherwise. This restriction of the parameter space was done in
order to avoid over-parametrization, but to reflect the larger variability of
23

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

incidences and hospitalizations in comparison with the mortality data (note
that dead mostly come from hospitals). Note also that, for terminal states,
the dispersion parameters have no effect, as their “target” distribution is
Dirac.
We used the following daily data series as inputs (see Figure 1):
I˜0 , I˜20 , I˜65 , I˜80 - numbers of positively tested with infection abroad of individual
cohorts,
serving as imports (see below) and the following series which we consider as
observations (variables Y ) in our model:
C A , C S - incidences of asymptomatic and symptomatic
C 0 , C 20 , C 65 , C 80 - incidences in individual cohorts
D0 , D20 , D65 , D80 - deaths in individual cohorts
H y , H o - admissions to hospitals of individuals from the first two cohorts
and second two cohorts
Ry , Ro - numbers of released from hospitals of the first and second two
cohorts
Dy , Do - dead in hospitals of the first and second two cohorts
∆y , ∆o - dead outside hospitals of the first and second two cohorts
The data come from the public repository of the Ministry of Health of
the Czech Republic and from the The Institute of Health Information and
Statistics of the Czech Republic, where the former is publicly available while
the latter is available only to research institutions. See Figure 1 for overview.
The data had to be pre-processed. First of all, series C, H and R, showing
strong weekly pattern, have been de-seasoned. Second, as the total reported
incidence exceeds (by about 2 percent) the personal level data (probably
because details are not always known), we took the former as decisive. Next,
as the reports of symptomatic an asymptomatic results of tests give slightly
less totals then the incidence, we took only ratios from the former multiplied
by the total incidences as C a and C s . Finally, as the total reported number
of actually hospitalized, which we denote by L, exceeds (by units of percents) the value H − R coming from the anonymized hospitalization data, we
24

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

.
adjusted series H and R so that L = H − R (doing it exactly is impossible,
as plain multiplication could cause unrealistic values of H and R).
Only three series take part as exogenous variables (values Z) in our model:
w - normalized contact restriction
e - personal protection index
f - level of reported fear
q - probability of detection in hospital
(see explanations above).
The matrix F , transferring compartment sizes X to observations Y , is
zero-one. Which components are equal to one can be partially devised from
Figure 2, the exact definition of F is given in Appendix, Figure 6. The lack
of a row of F corresponding to C a is intentional as C a is redundant (equal
to C 0 + C 20 + C 65 + C 80 − C S ) and would cause linear dependence in F if
included.
Assuming the imports only to the state E, we take,
i
i
ItE = I˜t+8

for each cohort i (the time-shift reflects the delay in reporting).
Reflecting the notorious unreliability of incidence data, we put
Γt (x, y) = diag(‫ג‬s , ‫ג‬c , ‫ג‬c , ‫ג‬c , ‫ג‬c , 0, . . . , 0)F x
where ‫ג‬s and ‫ג‬c are estimated parameters (note that the non-zero rows of Γt
correspond to C S , C 0 , C 20 , C 65 , C 80 respectively).
For estimation, we used Weighted Least Squares applied to the seven day
forecasts with weekly average increments as weights:
!n !
i
Yti − Y(t−7)∨0
∨5
,
t > 0.
Ut = diag
7∧t
i=1

Due to the possibly different nature of the first wave (until May) and irregular
behavior of the pandemic in summer (caused by small incidence with local
outbursts), we used only data from October onward for the (final) estimation.
To get “reasonable” initial state for our estimate, we roughly estimated the
25

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

model for the whole period of the pandemic and took its state from the end of
August as the initial state for the final estimation; to minimize the influence
of the initial value, however, the WLS criterion was computed only for the
period from October 1, 2020 till January 21, 2121 .
Unfortunately, the estimation did not directly lead to quality results.
The reason was that minimization with free cu , cd , γs and γc (dispersion)
parameters tends to underestimate forecast variances, which leads to unrealistically narrow confidence bounds. In order to get more realistic variances,
we adjusted the risk parameters of the estimate so that the variance of
standardized (one day forecast) residuals were close to one; we use grid
search here. Then we re-estimated the model by WLS with the adjusted
risk parameters fixed. Yet the value of the new WLS minimum is about
25 percent higher than the original one, the variances in the new model are
realistic. Finding a fully automatic estimation procedure getting realistic
variances, perhaps by regularization with respect to variance of residuals,
is a challenging topic of future research. The C++ code for the WLS
estimation, employing NLopt library for minimization, is available on https:
//github.com/cyberklezmer/seir/tree/ejor.
The standardized residuals (i.e. the residuals divided by the standard
error of the estimate) of the seven-day predictions for the individual observables, may be seen in Figure 3. Figure 4, on the other hand, shows the
def
predictions fit of the total incidence Ct = Ct0 + Ct20 + Ct65 + Ct80 , the total
def
number of deaths Dt = Dt0 + Dt20 + Dt65 + Dt80 and the actual occupancy of
def
hospitals Lt = Hty + Hto − Rty − Rto . For each variable, the left-hand graph
shows the fit of the (in-sample) seven day predictions, the right-hand graph
depicts the (out of sample) predictions for 14 days following Jan 21.
10. Vaccination Experiment
Finally, as a demonstration of applicability of our model, we evaluated
outcomes of three vaccination scenarios
novac The infectiousness $t increases by 50% on January 22 (by emergence
of a new mutation and/or release of the counter-epidemic measures)
and keeps being constant until the end of May
elderly The infectiousness rises as above, but 30000 shots of vaccine a day
will start to be applied on February 1st. Vaccines are distributed to the
26

C65

15

C20

C80

D0

D20

D65

D80

5
0
−5

−5

0

5

10

C0

10

15

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Jan

Jan

Hy

Ho

5
0
−5

−5

0

5

10

Do

10

Dy

Nov

15

15

Nov

Jan

Jan

Cs

5
0
−5

−5

0

5

10

Ro

10

Ry

Nov

15

15

Nov

Nov

Nov

Jan

Figure 3: Residuals of the Czech COVID-19 model.

27

Jan

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

60000
20000
0

0

20000

60000

100000

C out of sample

100000

C − 7 day increment (in sample)

Nov

Jan

Jan 22

Jan 24

Jan 28

Jan 30

Feb 01

Feb 03

Feb 01

Feb 03

Feb 01

Feb 03

2500
2000
1500
1000
500
0

0

500

1000

1500

2000

2500

3000

D out of sample

3000

D − 7 day increment (in sample)

Jan 26

Nov

Jan

Jan 22

Jan 24

C − L day increment (in sample)

Jan 26

Jan 28

Jan 30

8000
6000
4000
2000
0

0

2000

4000

6000

8000

L out of sample

Nov

Jan

Jan 22

Jan 24

Jan 26

Jan 28

Jan 30

Figure 4: Predictions of the Czech COVID-19 model. Red – actual, Blue – predicted,
dotted – 95 % confidential bound.

28

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Total incidence
Total deaths
Average hospitalization

novac

middle

elderly

872050
15712
7067

814270
12413
5906

843350
11710
5753

novac
-middle
57780
3298
1160

novac
-elderly
28700
4001
1314

middle
-elderly
-29080
703
154

Table 1: Outcomes of Vaccination Scenarios

cohort 80+ first and, as late as the whole cohort is vaccinated, vaccines
start to be given to the cohort 65-79. After 35 days, each vaccinated
individual gets a second shot (these shots do not count to the daily
number 30000).
middle The situation is the same as in “elderly” scenario with the difference
that only 15000 vaccines a day are given to the oldest, the rest are
given to cohort 20-64 (perhaps infrastructural workers).
As for the vaccine effect, we (conservatively) assume that vaccinated individuals can be infected the same way as if they were not vaccinated; however,
the probability of the asymptomatic course rises: 14 days after the first shot
to 0.9 for the first two cohorts (0-64), or to 0.7 for those who are older than
65. After 14 days from the second shot, the probability further rises to 0.95
and 0.8, respectively. We insert these effects into the model by adjusting the
overall probability α of asymptomatic course in individual cohorts according
to the number of vaccinated therein.
The results of simulation are shown in Figure 5 and Table 1. Not surprisingly, vaccination saves all the infections, deaths and hospital beds. Prioritizing
the older saves lives and beds, however, adds infections (which partially due
to greater efficiency of the vaccine for the younger cohorts, maybe also due
to greater number of contacts of the young). The most important message,
however, is that vaccination is not a “silver bullet” solving everything – there
are still large numbers of dead even with vaccination, which could be saved
if the infectiousness was reduced, too, perhaps by some unpopular measures.
11. Conclusion
We presented a stochastic epidemic model, formulated its basic properties
and suggested way of its estimation, all demonstrated by a real-life examples.
We demonstrated that our model has good predictive power. They are,
29

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Weekly incidence
middle

elderly

0

20000

40000

60000

80000

no vac.

Mar 01

Apr 01

May 01

middle

elderly

0

500

1000

1500

Weekly deaths
no vac.

Mar 01

Apr 01

May 01

no vac.

middle

elderly

0

2000

4000

6000

8000

10000

Actual hospitalizations

Mar 01

Apr 01

May 01

Figure 5: Outcomes of Vaccination Scenarios

30

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

however, many things to be done. Most importantly, a reliable automatic
estimation procedure should be suggested, guaranteeing good fit of both
means and variances. Second, regularity conditions which would ensure
asymptotic properties should be formulated, yet it can be a difficult task.
However, even as it is, it can be immediately used for statistically correct
modeling of the present and perhaps also another epidemics.

31

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

References
[1] M. A. Acuna-Zegarra, M. Santana-Cibrian, and J. X. VelascoHernandez. Modeling behavioral change and covid-19 containment in
mexico: A trade-off between lockdown and compliance. Mathematical
Biosciences, 325:108370, 2020.
[2] M. Ajelli, B. Goncalves, D. Balcan, V. Colizza, H. Hu, J. J. Ramasco,
S. Merler, and A. Vespignani. Comparing large-scale computational
approaches to epidemic modeling: Agent-based versus structured
metapopulation models. BMC Infectious Diseases, 10:190, 2010.
[3] L. J. S. Allen. A primer on stochastic epidemic models: Formulation,
numerical simulation, and analysis. Infectious Disease Modelling, 2:128–
142, 2017.
[4] S. Chang, E. Pierson, P. Wei Koh, J. Gerardin, B. Redbird, D. Grusky,
and J. Leskovec. Mobility network models of covid-19 explain inequities
and inform reopening. Nature, 589:7 January 2021, 2021.
[5] Morris L. Eaton. Multivariate Statistics - a Vector Space Approach,
volume 53. Institute of Mathematical Statistics, Ohio, USA, 2007.
[6] Akira Endo et al. Estimating the overdispersion in covid-19 transmission
using outbreak sizes outside china. Wellcome Open Research, 5, 2020.
[7] Rahman Farnoosh and Mahmood Parsamanesh. Stochastic differential
equation systems for an sis epidemic model with vaccination and
immigration.
Communications in Statistics-Theory and Methods,
46(17):8723–8736, 2017.
[8] Wayne M Getz, James O Lloyd-Smith, Paul C Cross, Shirli Bar-David,
Philip L Johnson, Travis C Porco, and Marís S Sánchez. Modeling the
invasion and spread of contagious diseases in heterogeneous populations.
Disease evolution: models, concepts, and data analyses, 71:113–144,
2006.
[9] Gavin J Gibson and Eric Renshaw. Estimating parameters in stochastic
compartmental models using markov chain methods. Mathematical
Medicine and Biology: A Journal of the IMA, 15(1):19–40, 1998.

32

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

[10] N. Haug, L. Geyrhofer, A. Londei, E. Dervic, A. Desvars-Larrive,
V. Loreto, B. Pinior, S Thurner, and P. Klimek. Ranking the
effectiveness of worldwide covid-19 government interventions. Nature
Human Behaviour, 4:1303–1312, 2020.
[11] Wenqing He, Grace Y Yi, and Yayuan Zhu. Estimation of the basic
reproduction number, average incubation time, asymptomatic infection
rate, and case fatality rate for covid-19: Meta-analysis and sensitivity
analysis. Journal of Medical Virology, 2020.
[12] C. Jacob. Conditional least squares estimation in nonstationary
nonlinear stochastic regression models. The Annals of Statistics,
38(1):566–597, 2010.
[13] Christine Jacob.
A generalized quasi-likelihood estimator for
nonstationary stochastic processes- asymptotic properties and examples.
Pliska Studia Mathematica Bulgarica, 22(1):71p–88p, 2013.
[14] W. O. Kermack and A. G. McKendrick. A contribution to the
mathematical theory of epidemics. Proc. R. Soc. Lond. A, 115:700–721,
1927.
[15] Adam J Kucharski, Timothy W Russell, Charlie Diamond, Yang Liu,
John Edmunds, Sebastian Funk, Rosalind M Eggo, Fiona Sun, Mark
Jit, James D Munday, et al. Early dynamics of transmission and control
of covid-19: a mathematical modelling study. The lancet infectious
diseases, 2020.
[16] Y. Liu, C. Morgenstern, J. Kelly abd R. Lowe, "CMMID COVID19 Working Group", and M. Jit. The impact of non-pharmaceutical
interventions on sars-cov-2 transmission across 130 countries and
territories. BMC Medicine, 19:40, 2021.
[17] Kenji Mizumoto, Katsushi Kagaya, Alexander Zarebski, and Gerardo
Chowell. Estimating the asymptomatic proportion of coronavirus disease
2019 (covid-19) cases on board the diamond princess cruise ship,
yokohama, japan, 2020. Eurosurveillance, 25(10):2000180, 2020.
[18] Xiuquan Nie, Lieyang Fan, Ge Mu, Qiyou Tan, Mengyi Wang, Yujia
Xie, Limin Cao, Min Zhou, Zhuang Zhang, and Weihong Chen.
33

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Epidemiological characteristics and incubation period of 7015 confirmed
cases with coronavirus disease 2019 outside hubei province in china. The
Journal of Infectious Diseases, 2020.
[19] J. Panovska-Griffiths, C. C. Kerr, R. M. Stuart, D. Mistry, D. J. Klein,
R. M. Viner, and C. Bonell. Determining the optimal strategy for
reopening schools, the impact of test and trace interventions, and the
risk of occurrence of a second covid-19 epidemic wave in the uk: a
modelling study. Lancet Child Adolesc Health, 4:817–827, 2020.
[20] PaQ. Life during pandemics., 2020. sociologic survey.
[21] Allyson M Pollock and James Lancaster. Asymptomatic transmission
of covid-19, 2020.
[22] Kiesha Prem, Alex R Cook, and Mark Jit. Projecting social contact
matrices in 152 countries using contact surveys and demographic data.
PLoS computational biology, 13(9):e1005697, 2017.
[23] Kiesha Prem, Yang Liu, Timothy W Russell, Adam J Kucharski,
Rosalind M Eggo, Nicholas Davies, Stefan Flasche, Samuel Clifford,
Carl AB Pearson, James D Munday, et al. The effect of control strategies
to reduce social mixing on outcomes of the covid-19 epidemic in wuhan,
china: a modelling study. The Lancet Public Health, 2020.
[24] J. Shaman and A. Karspeck. Forecasting seasonal outbreaks of influenza.
PNAS, 109:20425–20430, 2012.
[25] D. L. Smith, K. E. Battle, S. I. Hay, C. M. Barker, T. W. Scott, and F. E.
McKenzie. Ross, macdonald, and a theory for the dynamics and control
of mosquito-transmitted pathogens. PLoS Pathogens, 9:e1002588, 2012.
[26] Roman Wölfel, Victor M Corman, Wolfgang Guggemos, Michael
Seilmaier, Sabine Zange, Marcel A Müller, Daniela Niemeyer, Terry C
Jones, Patrick Vollmar, Camilla Rothe, et al. Virological assessment of
hospitalized patients with covid-2019. Nature, 581(7809):465–469, 2020.
[27] W. Yang, A. Karspeck, and J. Shaman. Comparison of filtering methods
for the modeling and retrospective forecasting of influenza epidemics.
PLoS Computational Biology, 10:e1003583, 2014.

34

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

[28] Mingyuan Zhou and Lawrence Carin. Negative binomial process count
and mixture modeling. IEEE Transactions on Pattern Analysis and
Machine Intelligence, 37(2):307–320, 2013.

Appendix: Parameters of the Czech COVID Model
Table 2 lists the majority of parameters, some of them being estimated,
the rest being determined. The following Table lists values, which we surveyed
from literature in order to compute selected parameters.

mE = 5.08
α = 0.179
ma = 4
mi = 8

Description
Source
mean of incubation period
[11]
probability of asymptomatic course
[17]
expected duration of presymptomatic period [18]
expected duration of infectiousness
[26]

The parameters, not included in Table 2 are θt , which is defined by 5,
πt , which we define later, and $t which is defined by (8) but with owing
explanation how pt is computed.
The quantity πt is set so that the overall detection probability, which
we estimate by δqt where qt is discussed in the main text and δ is an
estimated parameter. If we assume that, over time, the states of an individual
follows a continuous-time Markov chain with transition matrix given by the
parameters listed in Figure 2, then the probability of detection (excluding
the cases when an undetected arrives to hospital or dies) is
def

dt = P[E → Eδ ∨ E → Ia → Iaδ ∨ E → Ip → Ipδ ∨ E → Ip → Is → Isd ]


ασ
θt
(1 − α)σ
θt
πt ς
η
θt
+
+
+
·
;
=
θt + σ θt + σ θt + γa
θt + σ
θt + ς + ιs θt + ς + ιs η + γs + µs + ιs
by putting dt = δqt , we get πt (trimming when π1 falls outside [0, 1]).
To evaluate the level of personal protection pt is difficult task, as the
study [20] monitors observance of several protective measures. However, if
we assume that the i-th measure reduces the probability of infection by λi ,
we get that, denoting πti the average observance of the i-th measure among

35

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

v
ca
ch
‫ג‬c
‫ג‬s
ν
ωe
ωf
δ
ϑ1
η
ϑ0
σ
ς
u
γs
γa
b0
ι0s
µ0s
γh0
µ0h
b20
ι20
s
µ20
s
γh20
µ20
h
b65
ι65
s
µ65
s
γh65
µ65
h
b80
ι80
s
µ80
s
γh80
µ80
h

Value
26 (0.6023)
400 (10.2154)
1000 (53.4429)
1 (0.0244)
6 (0.1732)
1.37717 (0.0008)
1.0134 (0.0135)
5.10832 (0.0092)
1.29932 (0.0041)
0.02668 (0.0001)
0.10584 (0.0003)
0.01298 (0)
0.1787 (0.0004)
0.2212 (0.0009)
0.35298 (0.0062)
0.079 (0.0002)
0.12 (0.0028)
3.26536 (0.0303)
0.00135 (0.0001)
0 (0.0003)
0.99974 (0.0597)
0 (0.0298)
3.71562 (0.0356)
0.00092 (0)
0.00003 (0)
0.07866 (0.0015)
0.00724 (0.0007)
4.6724 (0.0456)
0.0026 (0)
0.00165 (0.0001)
0.00521 (0.0002)
0.01421 (0.0002)
5.2102 (0.0616)
0.56583 (0.0061)
0.0358 (0.0015)
0.1237 (0.0008)
0.03104 (0.0002)

Estimated
N
Y
Y
Y
Y
Y
Y
Y
Y
Y
Y
Y
N
N
Y
N
N
Y
Y
Y
Y
Y
Y
Y
Y
Y
Y
Y
Y
Y
Y
Y
Y
Y
Y
Y
Y

Remark
see Remark 3

see (??)

see (??)
see (5)
see (5)
σ = 1 − exp{−1/mE }
ς = 1 − exp{− m1a }
γs = 1 − exp{− m1s }
1
γa = 1 − exp{− mi +m
}
a

Table 2: Parameters of the Czech COVID Model

36

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

the respondents at t, that the average reduction brought by the the measure
will be (1 − πti ) × 1 + πti (1 − λi ) = 1 − πti λi . This gives total reduction
q
Y
pt =
(1 − πti λi ).
def

i=1

where q is the number of measures. Unfortunately, λi are unknown and their
estimation would bring a serious danger of over-fitting and/or co-linearity
(series πt1 , . . . , πtq are almost perfectly corelated). To overcome this difficulty,
we applied factor analysis to (υt , πt1 , . . . , πtq ) on the respondent level, treating
the responses in different times as separate observations. As a result, we
extracted two following main factors:
f
0.563
0.315
0.269
0.394
0.539
0.526
0.081
0.417
0.640
0.565
0.661
0.670
0.084

g
0.352
0.669
0.454
0.610
0.095
0.295
0.734
0.100
0.201
0.261
0.121
−0.244
−0.517

Value
Avoiding caughing people (yes or no)
Avoiding crowded places
Wearing a mask or a respirator
Restricting physical contact with people
Using desinfection
Avoiding people being in contact with an infected
Avoiding public transport
Taking vitamines
Avoiding touching nose and eyes
Extra hygiene
Washing hands after coughing
Washing hands after using public transport.
wt

It can be seen that, while the first factor speaks more about contacts, the
second one concerns personal protection, lacking connection with υ. Being
interested in the protection, we approximate
.
πti = π it + νt et
where π it is the average of πti over time and respondents, νt is a constant and
et is average of the second factor over respondents at t. Having that. we

37

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Cohort
Population
Q
0
0
65
80

0
20
2188232
6374077
0
20
0
0
b × 0.54 b × 0.11
b0 × 0.6 b0 × 0.92
b65 × 0.09 b65 × 0.1
b80 × 0.02 b80 × 0.02

65
1690530
65
0
b × 0.02
b0 × 0.12
b65 × 0.14
b80 × 0.02

80
441100
80
0
b × 0.02
b0 × 0.12
b65 × 0.14
b80 × 0.06

Table 3: Popluation of Cohorts and Mixing Matrix Q

could approximate
( q
)
q
Y
X
.
pt =
(1 − λi (π it + νt et )) = exp
ln(1 − λi (π it + νt et ))
i=1

(

i=1
q

.
= exp −

X

)
λi (π it + νt et )

= ω0 exp {−ωe et }

i=1

where ω0 , ωe ≥ 0. Similarly we can evaluate (assumed) reduction caused by
the average reported fear ft of infection, giving (7).
As for the adjustment gt for the new virus variants, we assume gt = 1 up
to November 20, 2020, gt = ν, where ν is an (estimated) parameter, since
January 1, 2021, and that gt is linearly interpolated between the dates. Yet
the dates do not correspond to the common knowledge about mixing of the
British variant, they come from a regression estimate of the reproduction
number by υ.
Finally, we list the population of individual cohorts together with the
"mixing matrix" Q (Table 3) and the definition of transformation matrix F
(Figure 6).

38

medRxiv preprint doi: https://doi.org/10.1101/2021.02.16.21251834; this version posted February 19, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Figure 6: Definition of Transformation Matrix F

39

