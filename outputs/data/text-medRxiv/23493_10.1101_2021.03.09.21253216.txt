medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

COVID-19: Optimal Allocation of Ventilator Supply under
Uncertainty and Risk
Xuecheng Yin1 , İ. Esra Büyüktahtakın 1 , and Bhumi P. Patel1
1

Department of Mechanical and Industrial Engineering, New Jersey Institute of Technology
March 9, 2021

Abstract
This study presents a new risk-averse multi-stage stochastic epidemics-ventilator-logistics
compartmental model to address the resource allocation challenges of mitigating COVID-19.
This epidemiological logistics model involves the uncertainty of untested asymptomatic infections and incorporates short-term human migration. Disease transmission is also forecasted
through a new formulation of transmission rates that evolve over space and time with respect to
various non-pharmaceutical interventions, such as wearing masks, social distancing, and lockdown. The proposed multi-stage stochastic model overviews different scenarios on the number
of asymptomatic individuals while optimizing the distribution of resources, such as ventilators,
to minimize the total expected number of newly infected and deceased people. The Conditional
Value at Risk (CVaR) is also incorporated into the multi-stage mean-risk model to allow for
a trade-off between the weighted expected loss due to the outbreak and the expected risks associated with experiencing disastrous pandemic scenarios. We apply our multi-stage mean-risk
epidemics-ventilator-logistics model to the case of controlling the COVID-19 in highly-impacted
counties of New York and New Jersey. We calibrate, validate, and test our model using actual infection, population, and migration data. The results indicate that short-term migration
influences the transmission of the disease significantly. The optimal number of ventilators allocated to each region depends on various factors, including the number of initial infections,
disease transmission rates, initial ICU capacity, the population of a geographical location, and
the availability of ventilator supply. Our data-driven modeling framework can be adapted to
study the disease transmission dynamics and logistics of other similar epidemics and pandemics.


Corresponding author email: esratoy@njit.edu

1

NOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice.

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Keywords. OR in Health Services, Epidemic control, pandemics, logistics, resource allocation, Conditional Value-at-Risk (CVaR), mean-risk, multi-stage, stochastic mixed-integer
programming model, risk-averse optimization, ventilator supply chain, ICU capacity, COVID19, spatio-temporal transmission rate, human migration, data analytics, the New York City
region, and New Jersey.

1

Introduction

The world is undergoing a major health crisis, which has now eventually turned into a pandemic.
The Coronavirus Disease 2019 (COVID-19), first detected in Wuhan city of China at the end of
2019, has been creating havoc on human life and economies in all parts of the world. Countries
worldwide enforce lockdown and quarantine rules to slow down the spread of the virus. The
lockdown, imposing travel restrictions, and social distancing have severely affected the economy,
from small-scale industries to stock prices and international trading. The virus has such a high
transmission rate, causing more than 104.7 million cases globally, out of which 2.3 million people
have succumbed to death by mid-February 2021 (JHU, 2020). The continuous increase seen in
coronavirus cases has made a worldwide scarcity of essential resources, such as ventilators, Intensive
Care Unit (ICU) beds, Personal Protective Equipment (PPE), and masks. Effective, sufficient, and
timely delivery of those critical resources to serve the COVID-19 patients has been a major challenge
faced by the world countries during the pandemic.
COVID-19 is primarily an acute respiratory disease. Ventilator incubation delivers high oxygen
concentrations while removing carbon dioxide and reduces the risk of hypoxia for COVID-19 patients (Meng et al., 2020). The standard Acute Respiratory Distress Syndrome protocol mandates
that the most severe COVID-19 patients, who constitute 5% of all COVID-19 patients, should
receive ventilator support (Bein et al., 2016). As a result, the life of many COVID-19 patients
depends on the use of ventilators. The shortage of supplies and uncertainty in disease transmission
has affected the proper allocation of ventilators, causing immense distress on the healthcare system.
Due to ventilator shortages worldwide during the pandemic’s peak times, hospital officials have had
to make life-altering resource allocation decisions and prioritized the care of COVID-19 patients
(Ranney et al., 2020). To tackle ventilator shortages and reduce the number of COVID-related
deaths, studies have come up with new approaches for ventilator distribution. For example, Ranney et al. (2020) suggest that the demand for ventilators can be fulfilled by the government by
allowing other industries to come together and help medical industries to cater to the needs of the
ventilators. Another study by Castro et al. (2020) suggests that the government in Brazil should
start thinking about expanding the resource capacity rather than only focusing on the allocation
of the available resources for controlling COVID-19. White and Lo (2020) develop a framework for
the distribution of ICU beds and ventilators depending on the priority scores using a scale of 1 to
8 based on patients’ likelihood of survival and ethical considerations.
Operations Research (OR) methods have been widely used to determine optimal resource allo-

2

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

cation strategies to control an epidemic or pandemic. Several studies have used multi-period OR
models to optimize the allocation and redistribution of ventilators (see, e.g., Mehrotra et al. (2020),
Bertsimas et al. (2020), and Blanco et al. (2020)). Other OR research models that study the epidemic diseases and resource allocation mainly focus on the logistics and operation management to
control the disease in optimal ways (Büyüktahtakın et al., 2018; Coşgun and Büyüktahtakın, 2018;
Kaplan et al., 2003; Tanner et al., 2008; Yin and Büyüktahtakın, 2020; Zaric and Brandeau, 2001).
We refer the reader to excellent reviews of Dasaklis et al. (2012) and Queiroz et al. (2020) for a
discussion of OR models for epidemic resource allocation.
While OR has been an extremely useful tool for effective and timely allocation of resources as
a response to epidemics, none of the former work has considered the ventilator allocation problem
using a risk-averse spatio-temporal stochastic programming model under uncertainty of asymptomatic infections. People move between regions, states, and countries, which aggravates the disease transmission to the other areas. Evaluating undetected or asymptomatic individuals is critical
for determining disease dynamics because asymptomatic individuals move around and unknowingly
infect other individuals (McCrimmon, 2021). Thus, the short-term migration of people is a critical
factor that needs to be considered to forecast the transmission of the COVID-19 realistically. However, the short-term migration rate is hard to predict and is affected by interventions and human
behaviors. Furthermore, disease transmission rates are not constant and rather evolve over time
with government interventions, such as the lockdown or social distancing measures. This change
in the transmission rates also should be considered in a realistic model. To our knowledge, none
of the former OR ventilator allocation models have integrated the epidemiological aspects of the
disease and resource allocation challenges in one optimization model.
In this paper, we address the limitation of realistically forecasting the transmission of COVID19 and build a risk-averse multi-stage stochastic epidemics-ventilator-logistics programming model
to study the ventilator allocation for the treatment of severe COVID-19 patients. Our model considers the uncertainty of untested asymptomatic individuals during the transmission of COVID19
and involves various pandemic scenarios for the proportion of untested infections during each time
stage of the planning horizon. Our model also incorporates the short-term migration between the
highly-impacted regions while using changing transmission rates under various non-pharmaceutical
intervention measures. The model optimizes the distribution of ventilators while minimizing the
total expected number of infected and deceased people. We calibrate, validate, and test our epidemiological ventilator allocation model using COVID-19 data collected during the pandemic’s
early stages.

2

Literature Review

This section presents a review of the articles that study mathematical models to estimate the transmission rate of COVID-19, evaluate various interventions used to control the disease, and optimize
resource allocation during the pandemic. The literature covers various methods, including compartmental models, such as the Susceptible (S)-Exposed (E)-Infectious (I)-Recovered (R) [SEIR]

3

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

formulations, simulations, optimization models, stochastic, statistical, or probabilistic approaches,
and network or graph-theory models.
Compartmental, Simulation and Network Models. Several studies on COVID-19 modeling use SEIR-type models with simulations, such as the Monte Carlo Simulation, to predict the
disease transmission rate and analyze the effectiveness of proposed non-pharmaceutical interventions and resource allocation strategies (see, e.g., Chatterjee et al. (2020), Weissman et al. (2020),
Wang et al. (2020), and Li et al. (2020)). For example, Li et al. (2020) develop a novel epidemiological model called DELPHI based on an SEIR model to estimate the effectiveness of government
interventions and the effects of under-detection of confirmed cases. They find that the world-widely
implemented travel restriction policies, social distancing, and mass gathering restrictions play a crucial role in reducing the infection rate. Ku et al. (2020) develop an empirical approach based on a
Bass Susceptible-Infected-Recovered model to predict specific transmission parameters, exogenous
forces of infection, and effective population sizes to determine the reproductive number (R0 ) for
the COVID-19 transmission in Chinese provinces.
Stochastic compartmental models have also been used to analyze the uncertain transmission
dynamics of the COVID-19. For example, Kucharski et al. (2020) develop the stochastic dynamic
Susceptible, Isolated, Infected, Recovered, and Exposed model to derive the transmission rate
using the COVID-19 cases in Wuhan as well as the associated international infections. The initial
reproductive number of 2.35 was reduced to 1.05 after imposing travel restrictions in Wuhan.
Kretzschmar et al. (2020) develop a stochastic mathematical model to understand the impact of
time delays in testing and isolation on the reproductive number of the COVID-19 transmission.
Differential equations have been mainly used to solve compartmental disease models (see, e.g.,
Ambikapathy and Krishnamurthy (2020), Wei et al. (2020), Zeb et al. (2020), Tuan et al. (2020),
and Wang et al. (2020)). For example, Roberts et al. (2020) come up with a series of differential
equations that are designed to compare the two scenarios based on delaying of ICU bed shortage effects of hospitalizing fewer COVID-19 patients versus increasing the ICU bed capacity.
The literature also constitutes many studies that present statistical approaches, such as logistic regression, generalized additive, and time-series models to predict the growth of the disease
over time and implement resource allocation strategies accordingly during the pandemic (see, e.g.,
Murray (2020), Manca et al. (2020), and Katris (2020)). Graph-theoretical methods have also
been quite useful in studying the COVID-19 transmission pattern and finding out the practices
to reduce the transmission rate (see, e.g., Hu et al. (2020), Loeffler-Wirth et al. (2020), and Badr
et al. (2020)). For example, Badr et al. (2020) model the transmission rate of COVID-19 based on
mobile phone mobility. The study supports the role of social distancing in reducing the COVID-19
growth ratio, confirming that social distancing plays a major role in combating the COVID-19
unless vaccinations are made available worldwide.
Optimization Models. Optimization models have also been widely studied for resource allocation in the fight against COVID-19. Queiroz et al. (2020) provide a systematic review of various
supply chain and logistics approaches for optimizing the distribution of critical resources amid
the COVID-19. To tackle the shortage of ventilators, Mehrotra et al. (2020) develop a two-stage
stochastic programming model, optimizing ventilator allocation during the pandemic under various
4

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

demand scenarios. The authors find that when 60% of the ventilator inventory is allocated to
non-COVID-19 patients, there is no shortfall. In comparison, when 75% of the stock is allocated to
the non-COVID-19 patients, a shortfall in the supply of the ventilators to the COVID-19 patients
occurs. Also, they find that it is essential to ramp up the production of the ventilators to meet
the additional requirements of the ventilators that might come up during the peak times of the
pandemic. Lacasa et al. (2020) come up with an algorithm for optimizing the allocation of the
ventilators and ICU beds and validate their algorithm during the peak and declining times of the
pandemic based on the data from the United Kingdom and Spain cases.
Bertsimas et al. (2020) develop a four-step approach, combining descriptive, predictive, and
prescriptive analytics and propose an optimization model for the re-allocation of the ventilators
throughout the U.S. during the COVID-19 pandemic. Blanco et al. (2020) present a two-stage
stochastic mixed-integer programming model, which minimizes the expected non-covered demand,
using robust objective functions of type minmax and minmax regret. Billingham et al. (2020)
present a network optimization model to tackle the problem of scarce ventilator distribution. Parker
et al. (2020) develop mixed-integer programming and robust optimization models to redistribute
patients instead of resources, such as ventilators among different hospitals under demand uncertainty. Govindan et al. (2020) develop a practical decision support system hinge on the knowledge
of the physicians and the fuzzy interference system (FIS) to help manage the demands of essential
hospital services in a healthcare supply chain, to break down the pandemic propagation chain, and
reduce the stress among the health care workers.
The literature on the optimal allocation of ventilators is not limited to COVID-19. For example,
Zaza et al. (2016) present a conceptual framework that identifies the steps in planning the distribution of stockpiled mechanical ventilators during an emergency. Meltzer et al. (2015) develop a
spreadsheet model, which estimates mechanical ventilator demand in the United States during an
influenza pandemic. They estimate a need of 35,000-60,500 additional ventilators to avert 178,000308,000 deaths in a highly severe pandemic scenario. Huang et al. (2017) introduce a two-stage
method for optimizing stockpiles of mechanical ventilators, which are critical for treating hospitalized influenza patients in respiratory failure under a pandemic situation. They also incorporate
their model into a web-based decision-support tool for pandemic preparedness and response.

2.1

Key Contributions

In summary, former stochastic programming approaches on ventilator allocation in a pandemic
situation have involved a time domain of only two stages, and have not integrated an epidemic
model within the stochastic program. Furthermore, the mathematical models on the forecast of
the COVID-19 do not include the uncertainty of untested asymptomatic infections. They do not
incorporate the impact of short-term migrations on COVID-19 transmission in an epidemiological
model. Also, former studies on the COVID-19 modeling and logistics have omitted the time consistency of the risk for making decisions over multiple stages of a stochastic program under extreme
pandemic scenarios.

5

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Our modeling and applied contributions to the epidemiology and OR literature are summarized
below.
Modeling contributions: First, to our knowledge, this is the first study that addresses the optimal distribution of ventilators to control a pandemic in a multi-stage stochastic mean-Conditional
Value at Risk (CVaR) model. Considering multiple stages is essential to capture uncertain disease dynamic over multiple time periods. This model includes many realistic effects critical in
the COVID-19 pandemic, including untested asymptomatic infections, human movement among
multiple regions, and evolving transmission rates under non-pharmaceutical intervention measures.
Second, we consider the uncertainty of the proportion of untested asymptomatic infections at each
stage and integrate this unknown dimension of the pandemic by generating a multi-stage scenario
tree. Third, we present a new susceptible (S)- tested infected (I)- untested asymptomatic (X)hospitalized (H)- ICU (C)- recovered (R)- death (D) compartmental disease model specialized for
the COVID-19, and also incorporate the short-term human migration among multiple regions into
this epidemiological model. Fourth, we derive a new time- and space-varying disease transmission
formulation, which takes into account the impact of government interventions on transmission rates.
Fifth, we formulate a budget-constrained ventilator allocation logistics model. Sixth, we incorporate a time-consistent CVaR risk-measure and the expectation criterion in the objective function
to alleviate the impacts of extreme pandemic scenarios. Lastly, we integrate all those elements
into one epidemics-ventilator-logistics mathematical formulation, which minimizes the number of
infections and deceased individuals under different intervention strategies while determining the
optimal timing and location of resources (ventilators) allocated. Our model combines the forecast
of the transmission of COVID-19 and the determination of optimal ventilator allocation strategies
in one formulation. Accordingly, the decision-maker can evaluate possible outcomes of wait-and-see
decisions while foreseeing how the disease could progress in each time period.
Applied Contributions: We apply our general multi-stage mean-risk epidemics-ventilator-logistics
model to the case of controlling the COVID-19 in highly-impacted counties of New York and New
Jersey. We collect real data from various resources and provide researchers with compact epidemiological, population and logistics-capacity data for COVID-19. Using this data, we calibrate,
validate, and test our model, which could be used as a decision support tool for fighting against the
COVID-19. Our model can also be adapted to study other similar diseases’ transmission dynamics
and logistics.
Key Recommendations to Decision Makers. This study provides optimal risk-averse ventilator allocation policies under different risk levels that the decision-maker can take to control
the COVID-19. Based on our results, we offer the following recommendations to inform resource
allocation policies under a pandemic:
(i ) The short-term movement of people influences the number of new infections even if the disease
transmission rate stays the same.

6

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

(ii ) The number of treated people in the ICU may stay at the capacity limit under different
intervention strategies because this value depends on the minimum number of patients who
require a ventilator for treatment and the scarce ventilator supply. There is also a lag time
to observe the impacts of government non-pharmaceutical interventions on the number of
hospitalized, ICU and deceased individuals.
(iii ) “Lockdown” is the best strategy to control the COVID-19. However, the “Mask and Social
Distance” intervention following a certain period of “Lockdown” is the second-best choice,
considering the need for opening facilities and businesses.
(iv ) The region with a high initial transmission rate and low initial ICU capacity will have more
ventilators allocated under a limited budget and low or high transmission scenarios. Independent from the budget level, the region with a low initial transmission rate and low initial
ICU capacity gets more ventilators allocated under a medium transmission scenario.
(v ) Under a medium and ample budget level, the model allocates more capacity to the regions
with a higher population and a larger initial number of infections but with a lower transmission
rate. A large-enough budget also provides some flexibility in delaying ventilator allocation to
some regions. In contrast, all of the ventilators are allocated at the first two stages under a
limited budget.
(vi ) Considering risk in decision-making improves the confidence level for reducing the loss of lives
under risky pandemic scenarios. However, a risk-averse decision-maker should also expect a
possible increase in the number of infections and deaths while mitigating disastrous outbreak
scenarios.

3

Problem Formulation

This section presents the description of the notations, compartmental disease model, the formulation for transmission rates, uncertainty and scenario tree generation scheme, specific features and
assumptions made in the mathematical model, a brief description of the CVaR, and the formulation
for our epidemics-ventilator-logistics model.

3.1

Model Notation and Formulation

Below we provide notations used for the rest of the paper.
Sets and Indices:

N : Set of nodes in the scenario tree, where
n ∈ N.

J: Set of time periods, J = {0, ..., J}.
R: Set of regions, R = {1, ..., R}.

j: Index for time period, where j ∈ J.

Ω: Set of scenarios, Ω = {1, ..., Ω}.

r: Index for region where r ∈ R.
7

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

ω : Number of cumulative ventilators
Uj,r
(ICU capacity) in region r at stage j under
scenario ω.

ω: Index for scenario, where ω ∈ Ω.
State Variables:

ω : Number of infections caused by shortI˘j,r
term migration in region r at stage j under
scenario ω.

ω : Susceptible individuals in region r at
Sj,r
stage j under scenario ω.
ω : Tested symptomatic infected individIj,r
uals in region r at stage j under scenario
ω.

Parameters:
λ1 : Recovery rate of tested symptomatic
infected individuals in region r.

ω :
Xj,r

Untested asymptomatic infected individuals in region r at stage j under scenario ω.

λ2 : The death rate of tested symptomatic
infected individuals in region r.

ω : Hospitalized individuals in region r
Hj,r
at stage j under scenario ω.

λ3 : Hospitalization requirement rate of
tested symptomatic infected individuals in
region r.

ω : Individuals treated in the intensive
Cj,r
care unit (ICU) in region r at stage j under scenario ω.

λ4 : Recovery rate of the hospitalized individuals in region r.

ω : Recovered individuals in region r at
Rj,r
stage j under scenario ω.

λ5 : Death rate of hospitalized individuals
in region r.

ω : Deceased individuals in region r at
Fj,r
stage j under scenario ω.

λ6 : Ventilator requirement rate of hospitalized individuals in region r.

ω : Number of tested symptomatic inOj,r
fected individuals admitted to the hospital
in region r at stage j under scenario ω.

λ7 : Recovery rate of ICU patients in region
r.
λ8 : Death rate of ICU patients in region r.

ω
I j,r :

Number of tested symptomatic infected individuals who cannot be admitted
to the hospital due to limited capacity in
region r at stage j under scenario ω.

λ9 : Recovery rate of untested asymptomatic individuals in region r.
σ1,j,r : Transmission rate of tested symptomatic infected individuals in region r at
stage j.

ω
C j,r :

Number of individuals admitted to
ICU in region r at stage j under scenario
ω.

ω :
σ2,j,r
Proportion of untested asymptomatic infections in region r at stage j
under scenario ω.

ω : Number of hospitalized individuals
Kj,r
not admitted to the ICU due to the limited availability of ventilators in region r
at stage j under scenario ω.

ω : Hospital capacity in region r at stage
Tj,r
j under scenario ω.

8

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

U0,r : Initial number of ventilators (ICU capacity) in region r.

nario ω.

e1 : Cost of each ventilator.

Non-anticipativity parameters:

∆: Total budget for ventilators.
Risk parameters:

n: The serial number of nodes in the scenario tree, where n ∈ N .

α: Confidence level of value-at-risk, where
α ∈ [0, 1).

t(n): The corresponding stage that node n
marked in the scenario tree.

λ: Non-negative risk preference parameter
or mean-risk trade-off coefficient.

β(n): The set of scenarios that pass
through node n.

Risk variables:

Decision variables:

ηjω :

Value at risk for each stage j under
scenario ω.

ω : Number of ventilators allocated to reyj,r
gion r at the end of stage j under scenario
ω.

zjω : Value exceeding the value-at-risk at
the confidence level α at stage j under sce-

3.2

Compartmental Disease Model Description

Figure 1: One-Step COVID-19 Compartmental Model
Figure 1 shows the transmission dynamics of COVID-19 in each region r at each time period j
for a particular scenario ω. In this figure, susceptible individuals (S) can be infected and become
9

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

infected (either symptomatic or asymptomatic). Asymptomatic infections (X) may have slight or no
symptoms throughout the infection period and will recover with a rate of λ9 . Tested symptomatic
infections (I) may recover or die with rates of λ1 and λ2 , respectively, if they are not treated in
ω with an incoming dashed arc to the I compartment represents the
the hospital (H). Note that I˘j,r
number of infected people coming into the region r at stage j under scenario ω from neighboring
regions. Tested infected individuals (I) move to the hospital (H) compartment, depending on the
number of tested infections (I) and available hospital capacity. Some of the treated infected people
in the hospital (H) will recover with a rate of λ4 . The situations of some patients in the hospital
(H) may get worsen, and thus they may be transferred into the intensive care unit (we use C to
represent ICU), and those individuals need ventilators for the treatment.
Similar to the case of admittance into the hospital, the number of hospitalized patients transferred into ICU at each time period is equal to the minimum of the number of patients who need to
be transferred into ICU and the number of available ventilators. The patients who are not able to
receive the treatment in the ICU due to the limitation on the number of available ventilators may
die at a rate of λ5 . After being treated in the ICU, some of the patients may recover with a rate
of λ7 , while others may die with a rate of λ8 . Different from a typical compartmental model, the
transfer rate from I to H and H to C is not a constant, and it depends on the available capacity in
the H and C compartments, respectively, as discussed above.

3.3

Time- and Space-Varying Transmission Rate

In this section, we formulate the transmission rate σ1,j,r as a time- and space-varying parameter,
which depends on the government interventions taken at time j and region r. Since the onset
of the COVID-19, many governments have imposed different intervention strategies to reduce the
transmission rate. At a certain stage, each intervention has a different impact on the transmission
rate for the next stage. In this paper, we incorporate three main non-pharmaceutical interventions
to formulate the time-varying transmission rate — none, mask and social distancing, and lockdown.
Let x1j,r , x2j,r , and x3j,r be binary decision variables that correspond to none (i = 1), mask and
social distancing (i = 2), and lockdown (i = 3) interventions, respectively, taken at stage j and
region r. If xij,r takes a value 1, then intervention i is employed; otherwise, it is not employed, at
stage j and region r. The transmission rate at stage j +1 in region r is a function of the transmission
rate and specific intervention employed at stage j in the same region, as given in the below equations:

σ1,j+1,r = σ1,j,r (m1j,t x1j,r + m2j,t x2j,r + m3j,t x3j,r ) ∀j ∈ J \ {J}, r ∈ R,
x1j,r + x2j,r + x3j,r = 1
x1j,r , x2j,r , x3j,r ∈ {0, 1}

(1)

∀j ∈ J, r ∈ R,

(2)

∀j ∈ J, r ∈ R,

(3)

where mij,t represents the percent change in the transmission rate with respect to the binary decision
variable xij,r for intervention i = 1, 2, 3 taken at stage j in region r. Equation (1) shows that the
transmission rate at stage j + 1 is a function of the transmission rate at stage j and the intervention

10

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

strategy i taken at stage j. Equation (2) indicates that only one intervention measure can be taken
at each stage j. Equation (3) describes the binary nature of intervention decisions.
The transmission rate in our model is not equal to the basic reproduction number, R0 . It shows
how many new tested infections will be caused by the symptomatic and asymptomatic infections
from the previous stage. Since the number of new asymptomatic infections is uncertain, the number
of new infections (both symptomatic and asymptomatic) changes under different scenarios even if
the transmission rates at each stage j stay the same.
There is a delay in the impact of the government’ interventions on the number of infections and
the reaction to the test results is also slow. Therefore, we calculate the transmission rate for the first
two stages directly using the real data from JHU (2020), independent from the intervention type.
Based on the first two-stage transmission rates, we calculate the transmission rates from stages three
to five using the formulation (1)–(3) for each intervention strategy. Also, the values of mij,t are
trained using the real data obtained from JHU (2020). As an example, the initial transmission rates
for the first two stages in New York and New Jersey and the impacts of government intervention
strategies mij,t are shown in Table 5 under Section 4.2.

3.4

Uncertainty and Multi-period Scenario Tree

Data regarding undetected or untested asymptomatic cases is lacking and uncertain. Therefore,
ω ) by
we model the uncertainty regarding the proportion of untested asymptomatic infections (σ2,r
generating a set of scenarios ω ∈ Ω, each representing a specific realization of the uncertain proportion of untested asymptomatic individuals over multiple time periods. Our scenario generation
approach is similar to Alonso-Ayuso et al. (2018)’s method developed to model the demand uncerP ω
tainty in forestry management. Each scenario has a probability of pω and
p = 1. Since data
ω∈Ω

ω ), we assume
is not available to describe the probability distribution of the uncertain variable (σ2,r
that the uncertain parameter follows a normal distribution. The lower and upper bounds for the
proportion of asymptomatic infections are obtained from the study of Meller (2020). The lower
bound value for the random variable is considered as the value of 0.001-quantile and the upper
bound is considered as the value of 0.999-quantile of the normal distribution.
As an example, Figure 2 shows a particular scenario tree for the proportion of untested asympω ) for a two-stage problem. We consider three realizations at each node of
tomatic infections (σ2,r
the scenario tree by dividing its normal distribution into three discrete parts [low (L), medium (M),
high (H)]. The low and high realizations have a probability of 0.3, and the medium realization has
a probability of 0.4. Each path from the root node to the leaf node of the scenario tree represents a
scenario ω. The probability of a scenario ω, pω , is calculated as the multiplication of probabilities
on the path for scenario ω. For two stages, 9 (32 ) scenarios will be generated in this instance. The
non-anticipativity constraints indicate that two scenarios are inseparable at a stage j if they share
the same scenario path up to that stage. This means that the corresponding decision made at this
stage for those two scenarios should also be the same.
The value of the proportion of asymptomatic infections has a mean µjr and standard deviation
j
σr at stage j. We use Qh to represent the value of h-quantile in the normal distribution. For

11

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

each node n in the scenario tree, the mean value of the low realization is the value of 0.15-quantile
(E(µnr,low |Q0.001 ≤ µnr,low ≤ Q0.30 ) = Q0.15 ), the mean value of medium realization is the value
of 0.50-quantile (E(µnr,medium |Q0.30 ≤ µnr,medium ≤ Q0.70 ) = Q0.50 ), and the mean value of high
realization is the value of 0.85-quantile (E(µnr,high |Q0.70 ≤ µnr,high ≤ Q0.999 ) = Q0.85 ). For node 0 in
our example, the proportion of untested asymptomatic infections at stage j = 0 has µ0r = 0.26 and
σr0 = 0.05. The low, medium, and high realizations at node 0 in stage j = 0 and nodes 1 and 3 in
stage j = 1 are given in Table 1 below. According to the distributions presented in Table 1, the
proportion of untested asymptomatic infections in stage 1 is realized as 0.21 (Low) at node 1, 0.26
(Medium) at node 2, and 0.31 (High) at node 3.
Table 1: The 0.15-, 0.50-, 0.85-quantiles of the normal distribution at nodes 0, 1, and 3 of the
scenario tree in Figure 2 and the associated node of the uncertain parameter realization.
Low (realized node)

Medium (realized node)

High (realized node)

Q0.15

Q0.50

Q0.85

Node 0 Distribution

0.21 (node 1)

0.26 (node 2)

0.31 (node 3)

Node 1 Distribution

0.17 (node 4)

0.21 (node 5)

0.25 (node 6)

Node 3 Distribution

0.12 (node 10)

0.31 (node 11)

0.50 (node 12)

3.5

Model Features and Assumptions

Since the transmission of COVID-19 is affected by many factors, data to calibrate some of the
model parameters, such as the impact of human mobility, is either lacking or inaccurate. Therefore, we incorporate some important features and make some assumptions in the model formulation.
Important features. First, we consider the impact of different intervention strategies on the
disease transmission rate and adjust the short-term migration population depending on the intervention strategy. For instance, under the lockdown strategy, we assume that the short-term
migration among each county is zero. Under mask and social distancing strategies, the short-term
migration population among each county is reduced to 60% of the original value, as estimated
from the study of Lee et al. (2020). Second, we incorporate the cost for purchasing ventilators to
provide a capacity limitation on the total number of ventilators that could be allocated for treating
COVID-19 patients. Since there are significant fluctuations in the ventilator prices (Glass, 2020),
we consider the minimum purchase price for each ventilator acquired. Third, we train the real
data to determine the impact rate of each intervention strategy on the disease transmission rate.
The trained value of the impact of interventions can only be used in the regions considered in our
case study since all the selected counties in New York and New Jersey are geographically close to
each other, and thus interventions have similar social effects. However, for example, the impact of
intervention strategies in a rural area may be different from those taken in a city. To estimate the
12

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Figure 2: Multi-stage scenario tree generation example for the uncertain proportion of untested
ω ).
asymptomatic infections (σ2,r

13

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

COVID-19 transmission in other regions of the United States, the model should be re-trained using
the associated data.
Assumptions. First, since studied counties in New Jersey and New York are geographically
close to each other, the proportions of untested asymptomatic infections at each stage j under
scenario ω are set to be the same for each region r. Second, the model considers allocating newly
purchased ventilators for the treatment of COVID-19 patients instead of re-allocating existing
ventilators from other counties or states since the demand for ventilators during the disease’s
peak periods is high for all the counties and states, and there is a lead time for transfer of the
ventilators between the states that are far from each other. Here, we also assume a central decision
maker entitled to allocate a given supply of ventilators to multiple regions. Third, the infected
individuals who cannot be treated in the hospital (both severe and less severe) due to the limited
capacity have the same death rate as the ICU patients because some of those infections may worsen
without professional treatment. Fourth, we assume that all symptomatic individuals are tested, and
asymptomatic infected individuals are untested. Fifth, we assume that people react to the pandemic
by anticipating the government’s interventions and may start social distancing and quarantining
days or weeks before an intervention is imposed (Fischer et al., 2020; Zhang et al., 2020). Thus,
the transmission rate with either doing nothing or mask and social distancing shows a decreasing
trend in later stages of the pandemic due to physical distancing among people. Lastly, we use
each county’s ICU capacity from JHU (2020) as the initial ventilator availability. We assume that
non-COVID-19 patients use 60% of this capacity (Mehrotra et al., 2020). Thus, only 40% of the
initial ICUs are available for treating the COVID-19 patients.

3.6

Multi-Stage Risk and Time Consistency

The α-quantile of the cumulative distribution of a random variable z, inf η {η ∈ R : Fz (η) ≥ α},
is defined as the value-at-risk (VaR) at the confidence level α ∈ {0, 1} and denoted by VaRα (z).
The conditional expected value that exceeds the VaR at the confidence level α is called conditional
value-at-risk (CVaR), defined as CVaRα (z) = E(z | z ≥ VaRα (z)). For a minimization problem,
VaRα is the α-quantile of the distribution of the cost, and it provides an upper bound on the cost
that is exceeded only with a small probability of 1 − α. CVaRα measures an expectation of the cost
that is more than VaRα , and can be calculated as an optimization problem as follows (Rockafellar
and Uryasev, 2002):
1
CVaRα (z) = inf {η +
E([z − η]+ )},
η∈R
1−α
where (a)+ := max(a, 0) for any a ∈ R.
We formulate our model as a mean-risk minimization problem:
min{E(f (x, ω)) + λCVaRα (f (x, ω))},
x∈X

(4)

where E(f (x, ω)) is the expected cost function over the scenarios ω ∈ Ω, CVaRα represents the
conditional value-at-risk at α, and λ ∈ [0, 1] is a non-negative weighted risk coefficient and it can
14

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

be adjusted for a trade-off between optimizing an expectation value and the level of risk taken.
Time Consistency. Time consistency is considered as a critical issue when modeling a risk-averse
multi-stage stochastic program. Time consistency means that if you solve a multi-stage stochastic
programming model today, you should get the same solution if you resolve the problem tomorrow
given the information that is observed and decided today. We consider a nested risk measure,
expected conditional value-at-risk (E-CVaR), as defined in Homem-de Mello and Pagnoncelli (2016)
since it is shown to satisfy the time consistency of multi-stage stochastic programs. The E-CVaR
can be linearized and formulated as a linear stochastic programming model. In the following section,
we will utilize the E-CVaR as a risk measure in our formulation.

3.7

Mathematical Model Formulation and Description

The mathematical formulation for our risk-averse multi-stage stochastic epidemics-ventilator-logistics
model is given below.
Epidemics-Ventilator-Logistics Model Formulation:

min

XX

p

ω

j∈J ω∈Ω

s.t.

X

ω
(Ij,r

ω
Fj,r
)

+

+

1
+
zω )
1−α j

λ(ηjω

r∈R

!

ω
ω
ω
ω
ω
ω
Sj+1,r
= Sj,r
− σ1,r (Ij,r
+ Xj,r
) − σ1,r (Ij,r
+ Xj,r
)

(5a)
ω
σ2,r
ω
1 − σ2,r

j ∈ J \ {J}, r ∈ R, ∀ω ∈ Ω,
ω
ω
ω
ω
ω
ω
ω
ω
I(j+1),r
= Ij,r
+ I˘1,j,r
+ σ1,r (Ij,r
+ Xj,r
) − λ1 Ij,r
− λ2 I j,r − Oj,r

(5b)

j ∈ J \ {J}, r ∈ R, ∀ω ∈ Ω,

(5c)

ω
X(j+1),r

ω
σ2,r
ω
ω
ω
ω
= Xj,r
+ σ1,r (Ij,r
+ Xj,r
)
ω − λ9 Xj,r
1 − σ2,r

j ∈ J \ {J}, r ∈ R, ∀ω ∈ Ω,
ω
H(j+1),r

=

ω
Hj,r

+

ω
Oj,r

−

ω
λ4 Hj,r

(5d)
−

ω
λ5 Kj,r

−

ω
C j,r

j ∈ J \ {J}, r ∈ R, ∀ω ∈ Ω,
ω
C(j+1),r
ω
R(j+1),r

=
=

(5e)

ω
ω
ω
ω
− λ8 Cj,r
Cj,r
+ C j,r − λ7 Cj,r
ω
ω
ω
ω
Rj,r
+ λ1 Ij,r
+ λ9 Xj,r
+ λ4 Hj,r

j ∈ J \ {J}, r ∈ R, ∀ω ∈ Ω,
ω
+ λ7 Cj,r

j ∈ J \ {J}, r ∈ R, ∀ω ∈ Ω,
ω
F(j+1),r

=

ω
Fj,r

+

ω
λ2 I j,r

+

ω
λ5 Kj,r

(5g)
+

ω
λ8 Cj,r

j ∈ J \ {J}, r ∈ R, ∀ω ∈ Ω,
ω
Oj,r
ω
C j,r

=
=

(5f)

(5h)

ω
ω
ω
min{λ3,r Ij,r
, Tj,r
− Hj,r
}
ω
ω
ω
min{λ6,r Hj,r , Uj,r − Cj,r }

15

j ∈ J, r ∈ R, ∀ω ∈ Ω,
j ∈ J, r ∈ R, ∀ω ∈ Ω,

(5i)
(5j)

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

ω
Uj,r

= U0,r +

j
X

ω
yl,r
,

j ∈ J, r ∈ R, ∀ω ∈ Ω,

(5k)

l=1
ω

ω
ω
ω
I j,r ≥ λ3 Ij,r
− (Tj,r
− Hj,r
)

j ∈ J, r ∈ R, ∀ω ∈ Ω,

ω
I j,r ≥ 0
j ∈ J, r ∈ R, ∀ω ∈ Ω,
ω
ω
ω
ω
Kj,r
≥ λ6 Hj,r
− (Uj,r
− Cj,r
)
j
ω
Kj,r ≥ 0
j ∈ J, r ∈ R, ∀ω ∈ Ω,

XX

ω
yj,r
e1 ≤ ∆

(5l)
(5m)

∈ J, r ∈ R, ∀ω ∈ Ω,

(5n)
(5o)

∀ω ∈ Ω,

(5p)

j∈J r∈R

X

zjω ≥

ω
ω
(Ij,r
+ Fj,r
) − ηjω

j ∈ J, ∀ω ∈ Ω,

(5q)

r∈R

zjω ≥ 0
ω
yt(n),r
ω
Sj,r
,

j ∈ J, r ∈ R, ∀ω ∈ Ω,

− yn,r = 0,
ω
Ij,r
,

ω
Tj,r
,

(5r)

ω
zt(n)
− zn = 0,
ω
ω
Hj,r
, Cj,r
,

j ∈ J, r ∈ R, ∀ω ∈ Ω,
∆
ω
yj,r
∈ {0, 1, 2, . . . , }
e1

ω
ηt(n)
ω
Rj,r
,

− ηn = 0,
ω
Fj,r
,

ω
Bj,r
,

∀ω ∈ β(n), ∀n ∈ N,
ω

C j,r ,

(5s)

ω
Oj,r
≥ 0,

(5t)
j ∈ J \ {J}, r ∈ R, ∀ω ∈ Ω.

(5u)

Objective Function (5a). The objective function (5a) minimizes the total expected number of
tested infected individuals and deaths and the conditional value-at-risk over all stages j and scenarios ω.
Population Infection Dynamics Constraints (5b) - (5h). Constraint (5b) represents that the
number of susceptible individuals in region r at stage j + 1 under scenario ω equals the number of
susceptible individuals at stage j minus the number of susceptible individuals who become either
tested infected or untested asymptomatic infected at stage j. In this equation, the number of
untested asymptomatic infections equals the number of tested infections multiplied by the proportion of the untested asymptomatic infections to the tested infections. Constraint (5c) shows that
the number of tested infected individuals in region r at stage j + 1 under scenario ω equals the
number of tested infected individuals at stage j plus the infected individuals caused by short-term
migration, plus the newly tested infections at time j, minus the recovered and deceased infections of
tested individuals at stage j, minus the hospitalized individuals at stage j. Constraint (5d) implies
that the number of untested asymptomatic infections in region r at stage j + 1 under scenario ω
equals the number of untested asymptomatic infections at stage j plus new, untested asymptomatic
infections, minus the recovered untested asymptomatic infections at stage j. Constraint (5e) shows
that the hospitalized individuals in region r at stage j + 1 under scenario ω equals the number
of hospitalized individuals at stage j plus the newly hospitalized individuals at stage j, minus the
recovered and deceased individuals at stage j, minus the individuals who move to the intensive
care unit (ICU) at stage j. Constraint (5f) indicates that the total number of individuals in ICU
in region r at stage j + 1 under scenario ω equals the total number of individuals in ICU at stage
j plus the individuals who moved to ICU at stage j, minus the individuals who are recovered or
16

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

died at the ICU at stage j. Constraint (5g) shows that the number of recovered individuals in
region r at stage j under scenario ω equals the number of recovered individuals at stage j plus
the recovered individuals from tested infected, untested asymptomatic infected and hospitalized
individuals, and ICU patients at stage j. Constraint (5h) indicates that the number of deceased
individuals in region r at stage j + 1 under scenario ω equals the number of deceased individuals
at stage j plus the deceased individuals from tested infected and hospitalized individuals and ICU
patients at stage j.
Ventilator Logistics and Capacity Constraints (5i) - (5p). Constraint (5i) ensures that the
number of individuals admitted to the hospital in region r at stage j under scenario ω equals the
minimum number of individuals who require hospitalization and the available hospital capacity at
stage j. Constraint (5j) implies that the number of individuals admitted to ICU in region r at stage
j under scenario ω equals the minimum number of individuals who require treatment in ICU and
the number of available ventilators at stage j. Constraint (5k) represents that the cumulative number of ICU beds (equivalent to ventilators) in region r at stage j under scenario ω equals the initial
number of ICU beds plus the cumulative number of ICU beds (new ventilators) allocated from stage
1 to stage j. Constraints (5l) - (5o) show that the number of individuals who can not be admitted
to the hospital or the ICU due to limited capacity should be greater than or equal to zero. Constraint (5p) represents that the cost of ventilators allocated over all regions and time stages under
scenario ω cannot exceed the total budget allocated for ventilators. The budget here also represents the maximum total ventilator supply that could be available throughout the planning horizon.
Risk Measure Constraints (5q) and (5r). Constraint (5q) indicates the difference between the
objective function value and the value-at-risk for each stage j under each scenario ω. Constraint
(5r) ensures that the loss value exceeding the value-at-risk is included in the CVaR calculation, and
thus zjω should be greater than or equal to zero.
Non-Anticipativity, Non-Negativity and Integrality Constraints (5s) - (5u). Constraint
(5s) is the non-anticipativity constraint, indicating that the scenarios that share the same path up to
stage j should also have the same corresponding decisions. Constraint (5t) indicates that the number of individuals in each compartment in region r at stage j under scenario ω should be greater or
equal to zero. Constraint (5u) implies that the number of allocated ventilators should be an integer.
Remark 1. Both (5i) and (5j) are non-linear, and thus we replace them with equivalent linear constraints with additional linearization variables, using the method presented in Yin and
Büyüktahtakın (2020). Hence, the non-linear multi-stage stochastic programming epidemics-ventilatorlogistics model (5a)–(5u) is converted into an equivalent mixed-integer linear programming (MIP)
formulation. We implement this MIP formulation for the rest of the paper.

17

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

3.8

Scenario Sub-Problem and Bounds

We implement the scenario sub-problems and lower and upper bounds proposed by Büyüktahtakın
(2020) to reduce the optimality gap of solving our risk-averse multi-stage stochastic programming
problem (5a)–(5u), while referring to Büyüktahtakın (2020) for the proofs of those bounds originally
driven for the general multi-stage stochastic programs. The scenario sub-problem and bounds are
described below.
Definition 3.1 The scenario-ω problem (P ω ) is formulated as follows:
ω

Z = min

X
j∈J

s.t.

p

ω

X

ω
(Ij,r

+

ω
)
Fj,r

+

r∈R

(5b) − (5u).

Constraints

λ(ηjω

1
+
zω )
1−α j

!
(6a)
(6b)

Specifically, in P ω we minimize the objective function value only under scenario ω while keeping
all the variables and the constraints from the original problem (5a)–(5u).
Proposition 1 (Lower Bound) Let Z ∗ represent the objective function of the original problem
(5a)–(5u), P . Then we have:
Z∗ ≥

X

Zω.

(7)

ω∈Ω

Proposition 2 (Upper Bound) Let ẋω be the optimal solution of scenario-ω problem, P ω , and
Z(ẋω ) be the objective value of original problem (5a)–(5u) where ẋω is substituted in the original
problem objective function (5a). Then we have:
Z ∗ ≤ min Z(ẋω ).
ω∈Ω

4

(8)

Case Study Data

This section provides the data used to calibrate model parameters and formulate the model, including population and short-term migration data, transmission parameters, as well as the cost of a
ventilator. As shown in Figure 3, we select eight counties that are most impacted by the pandemic
in the states of New York and New Jersey for our case study. They are New York County, Kings
County, Queens County, Bronx County, Richmond County, Hudson County, Bergen County, and
Essex County. In our multi-stage model, each stage represents a two-week period. Thus, all the
data regarding the transmission and migration are bi-weekly.

18

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Figure 3: Counties in New York and New Jersey (Source: ArcGIS (2021))

4.1

Population and Migration Data

Table 2 shows the population data for each considered county in New York and New Jersey. Population data is obtained from JHU (2020). The migration rates among the considered counties,
estimated from the data on CENSUS (2020), are presented in Table 3. The blank areas in Table 3
represent a zero short-term migration because the movement among those counties is too small to
make an impact on the model results.
Table 2: Counties and population sizes in New York and New Jersey
New York

Population

New Jersey Population

New York

1,632,480

Hudson

668,631

Kings

2,600,747

Bergen

929,999

Queens

2,298,513

Essex

793,555

Bronx

1,437,872

Richmond

474,101

Total

8,443,713

19

2,392,185

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Table 3: Migration rate among counties in New York and New Jersey
To

New York Kings Queens Bronx Richmond Hudson Bergen Essex

From
New York

4.2

0.015

Kings

0.192

Queens

0.218

0.044

Bronx

0.209

0.014

Richmond

0.105

0.105

Hudson

0.040

Bergen

0.126

Essex

0.079

0.012
0.038

0.009

0.006

0.004

0.004

0.009

0.002

0.007

0.028

0.007

0.003
0.001

0.003
0.040

0.039
0.001

0.057

0.007

0.040
0.039

0.057

Epidemiological Data

Table 4 presents the data values for transmission parameters for the studied counties in New York
and New Jersey. The data contains the proportion of untested asymptomatic infections, recovery
rate, and the death rate for tested infections, hospitalized infections, and ICU patients. Table 5
shows the transmission rate of each county at the first two stages and the impacts of applying
different intervention strategies, as discussed in Section 3.3.
Table 4: Transmission parameters and bi-weekly rates for the COVID-19
Parameter Description

Data
NY

Reference
NJ

σ2,r

Proportion of untested asymptomatic infections 0.15-0.4

λ1

Recovery rate without hospitalization

0.69-0.79 0.69-0.79 Hogan (2020)

λ2

Death rate without hospitalization

0.4

λ3

Hospitalization rate

0.21-0.31 0.21-0.31 Hogan (2020)

λ4

Recovery rate with hospitalization

0.88

0.88

Hogan (2020)

λ5

Death rate with hospitalization (No ventilators) 0.4

0.4

Trained using real data (JHU, 2020)

λ6

Ventilator requirement rate of hospitalized

0.12

0.12

Hogan (2020)

λ7

Recovery rate with ventilator

0.643

0.643

Bernstein (2020)

λ8

Death rate with ventilator

0.357

0.357

Bernstein (2020)

λ9

Recovery rate with asymptomatic infections

1

1

Bertsimas et al. (2020)

20

0.15-0.4
0.4

Meller (2020)
Trained using real data (JHU, 2020)

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Table 5: Transmission rate (σ1,r ) in New York and New Jersey and impact of interventions
County

Transmission Rate Transmission Rate Impact of

Impact of

at Stage 1

at Stage 2

None

4.5

0.9855

1

0.4

0.6

Kings

9

0.9855

1

0.4

0.6

Queens

10

1.095

1

0.4

0.6

New York

4.3

Impact of

Mask and Social Distancing Lockdown

Bronx

12

1.314

1

0.4

0.6

Richmond

12

1.314

1

0.4

0.6

Hudson

22

2.409

1

0.3

0.6

Bergen

11

1.408

1

0.3

0.6

Essex

22

2.409

1

0.3

0.6

Initial Infection, Capacity and Cost Data

Table 6 shows the initial number of infections, hospital capacity, and ICU capacity for each county.
The data is obtained from JHU (2020).
Table 6: Initial number of infections, hospital capacity, and ICU capacity for each county
County

Initial

Initial

Initial

Infections Hospital Capacity ICU Capacity
New York

1200

8650

944

Kings

1300

5838

282

Queens

1100

3210

146

Bronx

554

2816

274

Richmond

206

1177

72

Hudson

66

1764

89

Bergen

249

2874

122

Essex

73

3541

226

Ventilator Cost. The cost of each ventilator ranges from $5000 to $50000 (Glass, 2020). In our
case, we consider a cost of $5000 for each ventilator, and different budget levels are set to impose
different upper bounds on the ventilator supply.

5
5.1

Results
Model Validation

This section presents the validation results of the mathematical model in Eqs. (5a)–(5u) as presented in Section 3 for the 8-stage time period from April 3, 2020, to July 10, 2020. We consider

21

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

a medium realization of the uncertain asymptomatic proportions at each stage of the planning
horizon and compare the number of infections forecasted by our model to the real outbreak data.
The government applied a lockdown strategy from April 3, 2020, to July 10, 2020, at those
considered locations in New York and New Jersey. Thus, we use the lockdown strategy and the
corresponding transmission rate at each stage in our model for validation.

Figure 4: Comparison of predicted cases with real outbreak data for new infections in New York
and New Jersey
Figure 4 shows the comparison between the predicted infections and real outbreak data. The
model’s predictions provide a visually good fit for the actual number of new infections in each
region, implying that the model can capture the disease transmission dynamics under a lockdown
intervention strategy. We also perform a paired-t-test to analyze the difference between the pairs
of predicted new infections and the actual data in each period. As shown in Table 7, all p-values
are greater than 0.05, and thus our model provides statistically similar predictions with the real
outbreak data from April 3, 2020, to July 10, 2020, for each considered county.

22

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Table 7: Statistical analysis to compare the bi-weekly predicted new cases and real outbreak data.
County

5.2

Mean

Two-tailed paired-t-test

Outbreak

Predicted

t-stat

t-critical

p-value

New York

7300

7299

0.20

2.36

0.58

Kings

7413

7754

0.41

0.65

Queens

8138

8751

0.21

0.58

Bronx

5956

6214

0.46

0.67

Richmond

1762

2040

0.04

0.51

Hudson

2455

2806

0.16

0.56

Bergen

2444

2656

0.30

0.61

Essex

2366

2948

0.04

0.51

Case Study Implementation Details

We apply our model described in Section 3 to the selected counties in New York and New Jersey.
We first solve the risk-neutral model. We incorporate the uncertainty of the proportion of untested
asymptomatic infections as well as the short-term migration in the disease transmission and forecast
the number of new infections, deceased individuals, hospitalized individuals, and ICU patients under
different intervention strategies. Also, we solve the model to determine the optimal location and
number of ventilators allocated under different budget levels and scenarios to provide insights into
resource allocation over multiple jurisdictions under uncertainty. Due to the high complexity of
the mathematical formulation, we solve it for a 5-stage time period. Each stage corresponds to two
weeks, resulting in a planning horizon of ten weeks from March 20, 2020, to May 29, 2020. Because
each node of the scenario tree has three possible realizations of the random parameters, we solved
243 (35 ) scenarios simultaneously.
The mathematical model is solved using CPLEX 12.7.1 on a desktop computer running with
Intel i7 CPU and 64.0 GB of memory. We set the time limit at 7200 CPU seconds to solve each
test instance. We extend running time for specific budget levels ($30 Million) and interventions
(“Lockdown”) due to the large optimality gap. In the following subsections, we present results
from solving the multi-stage stochastic epidemics-ventilator-logistics model with an application to
the case of COVID-19 using the data presented in Section 4.

5.3

Transmission Forecast under Different Intervention Strategies

Here, we present results of our formulation for each time period under different intervention strategies: No intervention (“None”), mask and social distancing for all stages (“Mask and Social Distance”), lockdown for all stages (“Lockdown”), mask and social distancing for the first three stages
23

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

and lockdown for the following two stages (“Mask + Lockdown”), lockdown for the first three
stages and mask and social distancing for the following two stages (“Lockdown + Mask”). The
model is solved under the $30 million budget level. The model with the “Lockdown” strategy gives
a 4.54% optimality gap after a run time of 43,241 CPU seconds, while the model solved for all other
strategies has a zero optimality gap within 7,200 CPU seconds.
Figure 5 presents the number of infections and deceased individuals at each stage under different
intervention strategies. According to the results, short-term migration influences the number of
new infections even under constant transmission rates. As in the first stage, within the same
initial transmission rate, the number of infections under different intervention strategies is different
from each other. When the stage increases, the difference in the number of new infections among
each intervention strategy becomes more and more significant. The “None” strategy has the most
infections at each stage, followed by the “Mask and Social Distance” strategy. The “Lockdown”
strategy results in the lowest number of new infections compared to those under other strategies
at each stage. The “Lockdown” strategy provides a little higher number of infections compared
to the actual infection data since our model slightly (but statistically insignificantly) overestimates
the number of infections. Compared to the “Mask + Lockdown” strategy, the “Lockdown +
Mask” intervention leads to fewer infections. This implies that applying the “Lockdown” strategy
immediately at the onset of the pandemic followed by the “Mask and Social Distance” intervention
is a better strategy than enforcing “Mask and Social Distance” first and delaying the lockdown.
The intervention strategy does not influence the number of deceased individuals as quickly as
it does impact the number of infections, as shown in Figure 5. Here, the number of deceased
individuals at the first two stages is much lower than that of the last three stages. Starting from
stage three, the number of deceased individuals under different intervention strategies shows a
similar trend with the number of new infections. The influence of interventions is further delayed
for those confirmed infections to be treated in the hospital and ICU (Figure 6).
To reduce both the number of new infections and deaths, “Lockdown” is the best strategy. As
shown in Figure 5b, the “Lockdown” strategy with the optimal ventilator allocation further reduces
the actual number of deaths. Due to the negative impact of COVID-19 on employment and its
economic burden, governments are often forced to stop the lockdown and reopen businesses. In
such cases, applying “Mask and Social Distance” after a certain period of “Lockdown” will be the
best choice.
Figure 6 shows the number of hospitalized individuals and ICU patients at each stage under
different intervention strategies. Similar to the number of deceased individuals, there are delays in
the impact of government interventions on the number of hospitalized individuals and ICU patients.
An infected person may have mild symptoms for about one week, then worsen rapidly (SCHOOL
(2021)). Thus, it may take some time for patients to be admitted to the ICU, so the impact of
interventions on the number of ICU patients is delayed one more stage compared to the hospitalized
cases. As shown in Figure 6, more number of hospitalized individuals at stage j will lead to more
ICU patients at stage j + 1.
For all the stages, the “Lockdown” strategy has the least number of hospitalized individuals and
the ICU patients, followed by the “Lockdown + Mask” intervention. The ICU patients of “None,”
24

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Figure 5: Number of new infections and deaths under different intervention strategies and actual
numbers
“Mask and Social Distance,” and “Mask + Lockdown” are almost the same at stages three to five.
This is because under those, the need for ventilators is large, and the number of treated individuals
in ICUs depends on the minimum number of patients who require ventilators and the ventilator
supply in those ICUs. So the number of treated patients in ICUs is limited by the tight ventilator
availability.

5.4

Optimal Ventilator Allocation

Table 8 shows the number of ventilators allocated to each region at stages one and two and the
total number of ventilators allocated throughout the planning horizon under different budget levels
and three select scenarios. The “All Low,” “All Medium,” and “All High” scenarios represent low,
medium, and high realization of the proportion of untested asymptomatic infections at each stage
of a five-stage planning horizon, respectively. To analyze the impact of budget on the optimal
ventilator allocation decisions, we select $10M as the limited budget level, $20M as the medium
budget level, and $30M as the ample budget level. The model has zero optimality gap under the
$10M budget level, 4.54% optimality gap under the $20M budget level and 7.77% optimality gap
25

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Figure 6: Number of hospitalized individuals and ICU patients under different intervention strategies
under the $30M budget level within two hours of solution time.
The results in Table 8 demonstrate that the location and number of ventilators allocated depend
on several factors, including the initial and evolving disease transmission rates, the population and
the number of initial infections in a region, and the existing ventilator capacity. Thus, the optimal
ventilator allocation should be determined case-by-case.
According to the results, the total number of ventilators allocated increases in the budget level
due to the high need for ventilators. As shown in Table 8, under the limited budget level, some
regions with many initial infections, e.g., the New York County, do not receive ventilators. This
situation is because the initial ventilator capacity of those regions is higher than in other counties.
Also, results suggest that more ventilators should be distributed to other areas with a higher initial
transmission rate than the New York County, such as Kings, Hudson, and Essex, under a very
tight budget. Kings, Queens, and Hudson have higher initial transmission rates and lower initial
ICU capacity than New York. Thus, these regions get more ventilators allocated under a limited
budget level and “All Low” scenario. Also, regions with a relatively smaller population, such as
Hudson and Essex in New Jersey, get a large share of ventilators with a very tight budget under
26

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Table 8: Optimal ventilators allocated under different scenarios for budget levels
Scenario

County Stage Stage
Total
1
2
Ventilator
(Budget=$10M)
New York
0
0
0
Kings
119
0
119
Queens
107
1069
1176
Bronx
28
0
28
All Low Richmond 18
0
18
Hudson
0
250
250
Bergen
187
0
187
218
0
218
Essex
Total
677 1323
2000
New York
0
0
0
Kings
119
0
119
Queens
107
0
107
Bronx
28
809
837
All Medium Richmond 18
0
18
Hudson
0
250
250
Bergen
187
264
451
Essex
218
0
218
Total
677 1323
2000
New York
0
0
0
Kings
119
0
119
Queens
107
1055
1162
Bronx
28
4
32
All High Richmond 18
0
18
0
0
0
Hudson
Bergen
187
264
451
218
0
218
Essex
Total
677 1323
2000
∗

Stage Stage
Total
1
2
Ventilator
(Budget=$20M)
721
1
802∗
1734
0
1736∗
0
0
0
1016
1
1017
0
0
0
0
0
0
12
433
445
0
0
0
3483 435
4000∗
721
0
721
1734
76
1810
0
0
3∗
1016
0
1016
0
0
0
0
0
0
12
435
447
0
0
3∗
3483 511
4000∗
721
0
721
1734
0
1734
0
0
2∗
1016
0
1016
0
0
78∗
0
0
0
12
437
449
0
0
0
3483 437
4000∗

Stage Stage
Total
1
2
Ventilator
(Budget=$30M)
2100
0
2100
2222
0
2222
0
0
0
1016
1
1017
0
0
0
0
0
2∗
0
0
165∗
0
0
174∗
5338
1
5680∗
2100
0
2101∗
2222
1
2223
0
0
69∗
1016
0
1017∗
0
0
35∗
0
0
53∗
0
0
0
0
0
349∗
5338
1
5847∗
2100
1
2190∗
2222
0
2222
0
0
451∗
1016
0
1017∗
0
0
0
0
0
0
0
0
93∗
0
0
27∗
5338
1
6000∗

Some of the ventilators are allocated at stages three and four.

the “All Low” and “All Medium” scenarios due to their high transmission rates at the beginning
of the pandemic.
Independent from the budget level, some regions with low initial infections and low initial ICU
capacity (e.g., Bronx) will get more ventilators allocated under the “All Medium” scenario. Under
this scenario, the number of infections in regions with a high initial transmission rate (e.g., Kings
and Queens) will not significantly increase even if they receive a smaller number of ventilators.
These regions usually have much more initial ICU capacity for the treatment because of their large
population. On the contrary, the areas with a lower initial transmission rate but less initial ICU
27

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

capacity may benefit more if they receive more ventilators. As a comparison with the “All Medium”
scenario, the number of infections in the region with a low initial transmission rate will be much
smaller under the “All Low” scenario, and the number of infections in the regions with a high initial
transmission rate will be much larger under the “All High” scenario. The model gives priority to
allocate more ventilators to the regions with high initial transmission rates for both of the “All
Low” and “All High” scenarios because the benefit of giving resources to those regions is higher
than the regions with low initial disease transmission.
Moreover, the model is forced to make difficult decisions, and some of the regions may not have
any ventilator allocated under a limited ventilator supply. When the budget is too tight, the regions
with a high transmission rate gets the priority. As the budget increases to medium and ample, the
model allocates more capacity to the regions with a higher population and a larger initial number
of infections but with a lower transmission rate. Also, the stage-wise distribution of ventilators has
a high relationship with the available budget. If the budget is tight, all ventilators are distributed
within the first two stages. As we increase the budget, some of the ventilators are allocated in
stages three and four in addition to stages one and two. Thus, a higher budget level also provides
some flexibility in delaying the ventilator allocation to some regions.

5.5

Risk Analysis

In this section, we perform an analysis of the risk parameters λ and α in terms of their impact
on the expected number of infected and deceased people as well as the CVaR of the impact.
Specifically, under the $30M budget level, we compare four different problems with respect to
their risk-averseness level, adjusting λ and α values accordingly–risk-neutral (λ = 0, α = 0), weak
risk-aversion (λ = 1, α = 0.3), mild risk-aversion (λ = 10, α = 0.6), and strong risk-aversion
(λ = 10, α = 0.95). The model under the mild risk-aversion results in a high optimality gap (13%)
within 7200 CPU seconds running time. Therefore, we solve the scenario-ω problems described in
Section 3.8 and obtain the lower and upper bounds for the original problem. For our problem, we
select five representative scenarios, and add bounds based on the results of those select scenarios
in the risk-averse model. After implementing the scenario bounds, the optimality gaps over all of
the risk-averseness levels reduce to less than 9.13%.
We decompose the objective function (5a) into the Expected Impact [E(f (x, ω))] and the Expected
Risk [CVaRα (f (x, ω))], as demonstrated in Equation (4), to analyze the impact of risk trade-off
on the results. Table 9 presents the value of the objective function (5a), expected impact, and
expected risk (without λ) under different risk-averseness levels. Specifically, the expected impact
represents the expected total number of infections and deceased individuals, and the expected risk
corresponds to the expected CVaR term in Eq. (5a) without the λ value. According to Table
9, when both λ and α increase, the level of risk-averseness and the expected risk increase. The
optimal objective function value increases due to the additional risk term added into the objective
formulation. The expected impact also increases, implying the cost of being risk-averse, which is the
increased number of infections and deceased individuals while trying to mitigate specific disastrous
scenarios.
28

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Table 9: Comparison of objective value, expected impact, and expected risk under various riskaverseness levels
Risk
Weak
Mild
Strong
Neutral
Risk-aversion Risk-aversion
Risk-aversion
(λ = 0, α = 0) (λ = 1, α = 0.3) (λ = 10, α = 0.6) (λ = 10, α = 0.95)
Objective Value
347,395
721,710
3,997,129
4,011,964
Expected Impact
347,395
360,438
362,559
363,526
Expected Risk
361,272
363,457
364,844

The expected impact and expected risk (without λ) for various combinations of λ = {0, 1, 10}
and α = {0.3, 0.6, 0.95} under the $30M budget level are presented in Table 10. We observe
the change of the expected impact and expected risk when changing one of the risk parameters
and fixing all others’ original values. According to the results, fixing the α value, both expected
impact and expected risk show an increasing trend due to the increase of λ. When we move from
risk-neutral (λ = 0) to risk-averse (λ = {1, 10}), the expected impact always increases. Similarly,
λ = {1, 10} increases the expected impact compared to the risk-neutral model. Besides, when
fixing the λ value and increasing the α value, the expected risk increases because we increase the
confidence level for reducing the risk of having an extremely large number of infections and big
losses of lives.
Table 10: Expected impact and risk for different risk-averseness levels
λ\α

0
1
10

6

0.3
Expected Expected
Impact
Risk
347,395
0
360,438 361,272
360,880 361,341

0.6
Expected Expected
Impact
Risk
347,395
0
361,950 363,251
362,559 363,457

0.95
Expected Expected
Impact
Risk
347,395
0
363,882 365,236
363,526 364,844

Discussion and Future Directions

In this paper, we present a general multi-stage mean-risk epidemics-ventilator-logistics model and
apply this model to control the COVID-19 in select counties of New York and New Jersey. We first
explicitly formulate the uncertainty of the proportion of untested asymptomatic infections at each
stage, generating a multi-stage scenario tree. We then develop a compartmental disease model and
integrate the short-term human movement among multiple regions into this model. We also derive
a time- and space-varying disease transmission formulation and a logistics sub-model. We then
integrate all those components into one mathematical formulation, which minimizes the number of
infections and deceased individuals under different intervention strategies.
We solve the epidemics-ventilator-logistics model under different budget levels to determine
the ventilator-distribution optimal timing and location under various pandemic scenarios. Next,
29

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

we apply the CVaR in a nested form over a five-stage planning horizon to minimize the total
expected number of infections and deceased individuals, as well as the weighted risk of the loss.
Finally, we solve the scenario sub-problems under various scenarios to generate the lower and upper
bounds for the original problem, reducing the optimality gap. Our results provide key insights into
the resource-allocation decisions for controlling the COVID-19 and can be adapted to study the
transmission and logistics of other similar diseases.
According to the results, the number of infections, deceased individuals, hospitalized individuals,
and ICU patients indicates that short-term migration influences the number of infections, even if
the transmission rate is constant over time. The impacts of government interventions on the number
of deceased individuals, hospitalized individuals, and ICU patients are delayed because deaths and
hospitalization have a lag period compared to zero or a small lag phase in the growth of infections.
Furthermore, the number of ICU patients at each time period depends on the minimum number
of patients who require the ICU and the available ventilators. Thus, the number of ICU patients
might be at the capacity limit even under different intervention strategies at a particular stage.
The “Lockdown” strategy is the best way to control disease transmission. Nevertheless, “Mask
and Social Distance” applied after the several stages of “Lockdown” is the second-best strategy to
optimistically alleviate the pandemic’s economic impacts.
The ventilator allocation under different budget levels and scenarios indicates that the number
of ventilators allocated to each region depends on various factors, such as the number of initial infections, initial disease transmission rates, initial ICU capacity, and the population of a geographical
location. The region with a high initial transmission rate and low initial ICU capacity receives more
ventilators under a low disease transmission scenario and a limited budget level. This is because,
under a low disease transmission scenario, other regions with low initial transmission rates have
fewer infections, even if they have smaller initial ICU capacity. Independent from the budget level,
the area with a low initial transmission rate and low initial ICU capacity has more ventilators
allocated under the medium transmission scenario. This is because the number of infections in
the region with a high initial transmission rate and high initial ICU capacity does not significantly
increase even if they receive fewer ventilators under a mild disease transmission scenario. Under a
medium and ample budget level, the model allocates more capacity to the regions with a higher
population and a larger initial number of infections but with a lower transmission rate. Moreover,
when the budget is limited, all of the ventilators are allocated at the first two stages. When the
budget becomes ample, decision-makers would have some flexibility in delaying ventilator allocation
to later stages of the planning horizon.
The increase in the mean-risk trade-off coefficients in the risk-averse model improves the confidence level, reducing the loss in the right tail of the objective function values (the number of
infected and deceased individuals over highly-adverse scenarios). However, we should expect more
infections and deceased individuals on average considering all possible scenarios when we want to
decrease the impact of adverse scenarios by increasing the risk-averseness level.
This study leads to several future directions for research. For instance, vaccine allocation is also
essential as it can potentially protect people from being infected. The combination of vaccine allocation and other interventions will provide more flexible strategies to prevent and control the disease.
30

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

For example, for the region with a low transmission rate and high vaccine coverage, decision-makers
could consider lifting the “Lockdown” earlier to stimulate the economy. Furthermore, the mathematical model cannot allocate ventilators to some regions under a very tight budget, and so future
research could investigate ethical and fair resource allocation strategies during a pandemic. Also,
some of the assumptions and inferences made in our model could be updated in a future study as
more data are available.

Acknowledgments
We gratefully acknowledge the partial support of the National Science Foundation CAREER Award
co-funded by the CBET/ENG Environmental Sustainability program and the Division of Mathematical Sciences in MPS/NSF under Grant No. CBET-1554018.

References
Alonso-Ayuso, A., L. F. Escudero, M. Guignard, and A. Weintraub (2018). Risk management
for forestry planning under uncertainty in demand and prices. European Journal of Operational
Research 267 (3), 1051–1074.
Ambikapathy, B. and K. Krishnamurthy (2020). Mathematical modelling to assess the impact of
lockdown on COVID-19 transmission in India: Model development and validation. JMIR Public
Health and Surveillance 6 (2), e19368.
ArcGIS (2021). ArcGIS map. https://www.arcgis.com/index.html. Accessed January 20, 2021.
Badr, H. S., H. Du, M. Marshall, E. Dong, M. M. Squire, and L. M. Gardner (2020). Association
between mobility patterns and COVID-19 transmission in the USA: A mathematical modelling
study. The Lancet Infectious Diseases 20 (11), 1247–1254.
Bein, T., S. Grasso, O. Moerer, M. Quintel, C. Guerin, M. Deja, A. Brondani, and S. Mehta
(2016). The standard of care of patients with ARDS: Ventilatory settings and rescue therapies
for refractory hypoxemia. Intensive Care Medicine 42 (5), 699–711.
Bernstein,
L.
(2020).
More
COVID-19
patients
are
surviving
ventilators
in
the
ICU.
https://www.washingtonpost.com/health/
more-covid-19-patients-are-surviving-ventilators-in-the-icu/2020/07/03/
2e3c3534-bbca-11ea-8cf5-9c1b8d7f84c6_story.html. Accessed November 30, 2020.
Bertsimas, D., L. Boussioux, R. C. Wright, A. Delarue, V. Digalakis Jr, A. Jacquillat, D. L. Kitane,
G. Lukin, M. L. Li, L. Mingardi, et al. (2020). From predictions to prescriptions: A data-driven
response to COVID-19. arXiv preprint arXiv:2006.16509 .

31

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Billingham, S., R. Widrick, N. J. Edwards, and S. Klaus (2020). COVID-19 (SARS-CoV-2) ventilator resource management using a network optimization model and predictive system demand.
MedRxiv .
Blanco, V., R. Gázquez, and M. Leal (2020). Reallocating and sharing health equipments in sanitary
emergency situations: The COVID-19 case in Spain. arXiv preprint arXiv:2012.02062 .
Büyüktahtakın, İ. E. (2020). Scenario dominance for risk-averse multi-stage stochastic mixedinteger programs. Submitted for Publication, 1–36.
Büyüktahtakın, İ. E., E. des Bordes, and E. Y. Kıbış (2018). A new epidemics–logistics model:
Insights into controlling the Ebola Virus Disease in West Africa. European Journal of Operational
Research 265 (3), 1046–1063.
Castro, M. C., L. R. de Carvalho, T. Chin, R. Kahn, G. V. Franca, E. M. Macario, and W. K.
de Oliveira (2020). Demand for hospitalization services for COVID-19 patients in Brazil.
MedRxiv .
CENSUS (2020). Datasets. https://www.census.gov/data/datasets.html. Accessed November
30, 2020.
Chatterjee, K., K. Chatterjee, A. Kumar, and S. Shankar (2020). Healthcare impact of COVID-19
epidemic in India: A stochastic mathematical model. Medical Journal Armed Forces India.
Coşgun, Ö. and İ. E. Büyüktahtakın (2018). Stochastic dynamic resource allocation for HIV prevention and treatment: An approximate dynamic programming approach. Computers & Industrial
Engineering 118, 423–439.
Dasaklis, T. K., C. P. Pappis, and N. P. Rachaniotis (2012). Epidemics control and logistics
operations: A review. International Journal of Production Economics 139 (2), 393–410.
Fischer, I., S. Avrashi, T. Oz, R. Fadul, K. Gutman, D. Rubenstein, G. Kroliczak, S. Goerg, and
A. Glöckner (2020). The behavioural challenge of the COVID-19 pandemic: Indirect measurements and personalized attitude changing treatments (impact). Royal Society Open Science 7 (8),
201131.
Glass, H. (2020). High-acuity ventilator cost guide. https://hcpresources.medtronic.com/
blog/high-acuity-ventilator-cost-guide. Accessed November 30, 2020.
Govindan, K., H. Mina, and B. Alavi (2020). A decision support system for demand management in
healthcare supply chains considering the epidemic outbreaks: A case study of Coronavirus Disease
2019 (covid-19). Transportation Research Part E: Logistics and Transportation Review 138,
101967.
Hogan, A. (2020). Watch: Ventilators are in high demand for COVID-19 patients. How do they
work?
https://www.statnews.com/2020/03/30/covid-19-ventilators-how-they-work/.
Accessed November 30, 2020.
32

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Homem-de Mello, T. and B. K. Pagnoncelli (2016). Risk aversion in multistage stochastic programming: A modeling and algorithmic perspective. European Journal of Operational Research 249 (1), 188–199.
Hu, M., H. Lin, J. Wang, C. Xu, A. J. Tatem, B. Meng, X. Zhang, Y. Liu, P. Wang, G. Wu,
et al. (2020). The risk of COVID-19 transmission in train passengers: An epidemiological and
modelling study. Clinical Infectious Diseases.
Huang, H.-C., O. M. Araz, D. P. Morton, G. P. Johnson, P. Damien, B. Clements, and L. A. Meyers
(2017). Stockpiling ventilators for influenza pandemics. Emerging Infectious Diseases 23 (6), 914.
JHU (2020). COVID-19 United States Cases by County. https://coronavirus.jhu.edu/us-map.
Accessed November 30, 2020.
Kaplan, E. H., D. L. Craft, and L. M. Wein (2003). Analyzing bioterror response logistics: The
case of Smallpox. Mathematical Biosciences 185 (1), 33–72.
Katris, C. (2020). A time series-based statistical approach for outbreak spread forecasting: Application of COVID-19 in Greece. Expert Systems with Applications 166, 114077.
Kretzschmar, M. E., G. Rozhnova, M. C. Bootsma, M. van Boven, J. H. van de Wijgert, and M. J.
Bonten (2020). Impact of delays on effectiveness of contact tracing strategies for COVID-19: A
modelling study. The Lancet Public Health 5 (8), e452–e459.
Ku, C. C., T.-C. Ng, and H.-H. Lin (2020). Epidemiological benchmarks of the COVID-19 outbreak control in China after Wuhan’s lockdown: A modelling study with an empirical approach.
Available at SSRN 3544127 .
Kucharski, A. J., T. W. Russell, C. Diamond, Y. Liu, J. Edmunds, S. Funk, R. M. Eggo, F. Sun,
M. Jit, J. D. Munday, et al. (2020). Early dynamics of transmission and control of COVID-19:
A mathematical modelling study. The lancet Infectious Diseases.
Lacasa, L., R. Challen, E. Brooks-Pollock, and L. Danon (2020). A flexible method for optimising
sharing of healthcare resources and demand in the context of the COVID-19 pandemic. Plos
One 15 (10), e0241027.
Lee, M., J. Zhao, Q. Sun, Y. Pan, W. Zhou, C. Xiong, and L. Zhang (2020). Human mobility
trends during the early stage of the COVID-19 pandemic in the United States. PLoS One 15 (11),
e0241468.
Li, M. L., H. T. Bouardi, O. S. Lami, T. A. Trikalinos, N. K. Trichakis, and D. Bertsimas (2020).
Forecasting COVID-19 and analyzing the effect of government interventions. MedRxiv .
Loeffler-Wirth, H., M. Schmidt, and H. Binder (2020). COVID-19 transmission trajectories—monitoring the pandemic in the worldwide context. Viruses 12 (7), 777.

33

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Manca, D., D. Caldiroli, and E. Storti (2020). A simplified math approach to predict ICU beds
and mortality rate for hospital emergency planning under COVID-19 pandemic. Computers &
Chemical Engineering, 106945.
McCrimmon, K. K. (2021). The truth about COVID-19 and asymptomatic spread: It’s
common, so wear a mask and avoid large gatherings. https://www.uchealth.org/today/
the-truth-about-asymptomatic-spread-of-covid-19/. Accessed February 13, 2021.
Mehrotra, S., H. Rahimian, M. Barah, F. Luo, and K. Schantz (2020). A model of supply-chain
decisions for resource sharing with an application to ventilator allocation to combat COVID-19.
Naval Research Logistics (NRL).
Meller,
M.
(2020).
The
asymptomatic
and
pre-symptomatic
spread
of
COVID-19.
https://www.gundersenhealth.org/covid19/
the-asymptomatic-and-pre-symptomatic-spread-of-covid-19/#:~:text=We%20believe%
20that%20the%20number,allergies%20or%20a%20cold. Accessed November 30, 2020.
Meltzer, M. I., A. Patel, A. Ajao, S. V. Nystrom, and L. M. Koonin (2015). Estimates of the
demand for mechanical ventilation in the United States during an influenza pandemic. Clinical
Infectious Diseases 60 (suppl 1), S52–S57.
Meng, L., H. Qiu, L. Wan, Y. Ai, Z. Xue, Q. Guo, R. Deshpande, L. Zhang, J. Meng, C. Tong,
et al. (2020). Intubation and ventilation amid the COVID-19 outbreak: Wuhan’s experience.
Anesthesiology 132 (6), 1317–1332.
Murray, C. (2020). Forecasting COVID-19 impact on hospital bed-days. ICU-Days, Ventilator-Days
and Deaths by US State in the Next 4, 2020–032720043752.
Parker, F., H. Sawczuk, F. Ganjkhanloo, F. Ahmadi, and K. Ghobadi (2020). Optimal resource
and demand redistribution for healthcare systems under stress from COVID-19. arXiv preprint
arXiv:2011.03528 .
Queiroz, M. M., D. Ivanov, A. Dolgui, and S. F. Wamba (2020). Impacts of epidemic outbreaks on
supply chains: Mapping a research agenda amid the COVID-19 pandemic through a structured
literature review. Annals of Operations Research, 1–38.
Ranney, M. L., V. Griffeth, and A. K. Jha (2020). Critical supply shortages—the need for ventilators
and personal protective equipment during the COVID-19 pandemic. New England Journal of
Medicine 382 (18), e41.
Roberts, M. D., H. D. Seymour, and A. Dimitrov (2020). Selectively caring for the most severe
COVID-19 patients delays ICU bed shortages more than increasing hospital capacity. MedRxiv .
Rockafellar, R. T. and S. Uryasev (2002). Conditional value-at-risk for general loss distributions.
Journal of Banking & Finance 26 (7), 1443–1471.

34

medRxiv preprint doi: https://doi.org/10.1101/2021.03.09.21253216; this version posted March 12, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

SCHOOL, H. M. (2021). Symptoms, spread and other essential information about Coronavirus and COVID-19.
https://www.health.harvard.edu/diseases-and-conditions/
covid-19-basics#:~:text=and%20body%20ache.-,In%20some%20people%2C%20COVID%2D19%
20causes%20more%20severe%20symptoms%20like,a%20short%20period%20of%20time. Accessed February 12, 2021.
Tanner, M. W., L. Sattenspiel, and L. Ntaimo (2008). Finding optimal vaccination strategies
under parameter uncertainty using stochastic programming. Mathematical Biosciences 215 (2),
144–151.
Tuan, N. H., H. Mohammadi, and S. Rezapour (2020). A mathematical model for COVID-19
transmission by using the caputo fractional derivative. Chaos, Solitons & Fractals 140, 110107.
Wang, X., R. F. Pasco, Z. Du, M. Petty, S. J. Fox, A. P. Galvani, M. Pignone, S. C. Johnston, and
L. A. Meyers (2020). Impact of social distancing measures on COVID-19 healthcare demand in
Central Texas. MedRxiv .
Wei, J.-T., Y.-X. Liu, Y.-C. Zhu, J. Qian, R.-Z. Ye, C.-Y. Li, X.-K. Ji, H.-K. Li, C. Qi, Y. Wang,
et al. (2020). Impacts of transportation and meteorological factors on the transmission of COVID19. International Journal of Hygiene and Environmental Health 230, 113610.
Weissman, G. E., A. Crane-Droesch, C. Chivers, T. Luong, A. Hanish, M. Z. Levy, J. Lubken,
M. Becker, M. E. Draugelis, G. L. Anesi, et al. (2020). Locally informed simulation to predict
hospital capacity needs during the COVID-19 pandemic. Annals of Internal Medicine 173 (1),
21–28.
White, D. B. and B. Lo (2020). A framework for rationing ventilators and critical care beds during
the COVID-19 pandemic. Jama 323 (18), 1773–1774.
Yin, X. and İ. E. Büyüktahtakın (2020). A multi-stage stochastic programming approach to epidemic resource allocation with equity considerations. Accepted for publication in Health Care
Management Science.
Zaric, G. S. and M. L. Brandeau (2001). Resource allocation for epidemic control over short time
horizons. Mathematical Biosciences 171 (1), 33–58.
Zaza, S., L. M. Koonin, A. Ajao, S. V. Nystrom, R. Branson, A. Patel, B. Bray, and M. F. Iademarco
(2016). A conceptual framework for allocation of federally stockpiled ventilators during largescale public health emergencies. Health Security 14 (1), 1–6.
Zeb, A., E. Alzahrani, V. S. Erturk, and G. Zaman (2020). Mathematical model for Coronavirus
Disease 2019 (COVID-19) containing isolation class. BioMed Research International 2020.
Zhang, N., W. Jia, H. Lei, P. Wang, P. Zhao, Y. Guo, C.-H. Dung, Z. Bu, P. Xue, J. Xie, et al.
(2020). Effects of human behaviour changes during the COVID-19 pandemic on influenza spread
in Hong Kong. Clinical Infectious Diseases.
35

