medRxiv preprint doi: https://doi.org/10.1101/2020.05.31.20118695; this version posted June 1, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

1

2

ON THE UNCERTAINTY ABOUT HERD IMMUNITY
LEVELS REQUIRED TO STOP COVID-19 EPIDEMICS
Daniel Gianolaa;b;c

3

a

Department of Animal Sciences, University of Wisconsin-Madison, USA;
b

Department of Dairy Science, University of Wisconsin-Madison, USA;
c

1

Institut Pasteur de Montevideo, URUGUAY

Corresponding author. Email: gianola@ansci.wisc.edu

4

May 31, 2020

5

Abstract

COVID-19 evolved into a pandemic in 2020 a¤ecting more than 150 countries. Given
the absence of a vaccine, discussion has taken place on the strategy of allowing the
virus to spread in a population, to increase population "herd immunity". Knowledge
of the minimum proportion of a population required to have recovered from COVID19 infection in order to attain "herd" immunity, Pcrit , is important for formulating
epidemiological policy. A method for measuring uncertainty about Pcrit based on a
widely used package, EpiEstim, is derived. The procedure is illustrated using data
from twelve countries at two early times during the COVID-19 epidemic. It is shown
that simple plug-in measures of con…dence on estimates of Pcrit are misleading, but that
a full characterization of statistical uncertainty can be derived from EpiEstim, which
reports percentiles only . Because of the important levels of uncertainty, it is risky to
design epidemiological policy based on guidance provided by a single point estimate.

6
7
8
9
10
11
12
13
14
15
16
17

18

19
20
21

1

Introduction

COVID-19 evolved into a pandemic in 2020 a¤ecting more than 150 countries that vary in size,
population density, economic resources and public health systems. Given the absence of a vaccine,
considerable discussion (e.g., Dowdy and D’Souza, 2020) at various society levels has taken place on
1

NOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice.

medRxiv preprint doi: https://doi.org/10.1101/2020.05.31.20118695; this version posted June 1, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

36

a strategy of allowing the virus to spread in a population, to increase population "herd immunity".
Sweden’s adoption of the approach has been at the center of the debate.
Kwok et al. (2020) estimated the minimum proportion of a population required to have recovered from COVID-19 infection in order to attain "herd" immunity, Pcrit in various countries.
Knowing Pcrit is important for formulating epidemiological policies tailored to a speci…c country.
The parameter Pcrit is inferred from an estimate of Rt ; the viral reproductive; de…ned as the number of infections per infector at a given time of the epidemic at time t. The formula relating these
two quantities is Pcrit = 1 Rt 1 (Anderson and May, 1992). Since Pcrit is a fraction, it must take
values between 0 and 1; implying that Rt must be larger than 1 for the expression to be meaningful. As Rt increases beyond 1, so does the minimum fraction of the population that needs to be
infected. Since Rt must be estimated soon after the epidemic starts, often there is large statistical
uncertainty associated with the estimate, especially in countries where there are a few cases at the
onset. Because the uncertainty about Rt propagates into Pcrit it is important to consider it.
The objective here is to show how to measure uncertainty about Pcrit . The procedure is
illustrated using data from twelve countries at two early times during the COVID-19 epidemic.

37

2

22
23
24
25
26
27
28
29
30
31
32
33
34
35

38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56

Inference of Pcrit

Rt is estimated from a time series containing the number of infections I0 ; I1 ; :::; It (t denotes time)
and from information on the statistical distribution of the virus serial interval, de…ned as the
number of days mediating between the appearance of symptoms in pairs of infectors and infected
persons. Nishiura et al. (2020) used data on 28 pairs of patients in the context of SARS-CoV-2
infections and found that a log-normal distribution with mean and standard deviation of 4.7 and
2.9 days, respectively, provided the best …t.
Table 1 of Kwok et al. (2020) displays estimates of Rt and of Pcrit obtained at early stages of
the COVID-19 epidemic for various countries. It does not report statistical uncertainty associated
with the latter, although con…dence intervals are provided for Rt . The con…dence intervals can be
wide, especially for countries with smaller number of cases in the time series. For example, in the
table, the width of the 95% con…dence interval on Rt for the USA is 0.28 whereas for Slovenia it
is 3.47. A rough con…dence interval for Pcrit can be constructed by a plug-in method using values
of the bands for Rt ; but this way of proceeding may be misleading.
A suitable measure of the statistical uncertainty associated with inferring Pcrit is obtained using
a Bayesian approach such as the one employed in the R package EpiEstim described in Cori et
al. (2013), but with some minor external (to the program) modi…cations. Brie‡y, the package
employs a model that assumes that the number of infections observed at time t follows a Poisson
distribution with parameter Rt t . Here, t is a weighted average of past infections; weights are
calculated from knowledge (or estimation) of the serial interval distribution. If, Rt is assigned a
2

medRxiv preprint doi: https://doi.org/10.1101/2020.05.31.20118695; this version posted June 1, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

57
58
59
60
61

Gamma(a; b) prior distribution, the posterior is also a Gamma(at ; bt ) distribution where at and bt
depend on a and b; on the number of past infections and on the distribution of the serial interval
(Cori et al., 2013) .
Since Rt has a Gamma(at ; bt ) posterior distribution, then Rt 1 has an inverse Gamma distribution with parameters (at ; bt ) (Sorensen and Gianola, 2002; Gelman et al., 2014) with density
f Rt 1 jI0 ; I1 ; :::; It ;serial interval distribution / Rt

62

63

Since Rt 1 = 1

at 1

1

bt
Rt 1

exp

(1)

:

Pcrit is a linear relationship, the posterior distribution of Pcrit has density
f (Pcrit jI0 ; I1 ; :::; It ; serial interval distribution)
bt
(1 Pcrit ) at 1 exp
1 Pcrit
= 1
; 0 < Pcrit < 1:
Z
bt
(1 Pcrit ) at 1 exp
dPcrit
1 Pcrit

64

65

(2)

0

For instance, if at = 164 and bt = 65; the posterior density of Pcrit is

66

(1
f (Pcrit jI0 ; I1 ; :::; It ; serial interval distribution) =

67

Pcrit )

(164+1)

9: 642 6

65
1 Pcrit

exp
10

7

;

(3)

78

and takes the form depicted in Figure 1. The posterior expectation of Rt is 164
2: 52 so a plug-in
65
1
0:60 as an approximation to the posterior mean of Pcrit ; implying
estimate would give 1
2: 52
that a minimum 60% of the population needs to be infected in order to attain herd immunity. The
posterior mean and standard deviation of Pcrit are 0:60 and 0:03, respectively, and the coe¢ cient of
variation is 5:2%: The posterior probability that Pcrit is larger than 0:60 is 53:6%:; the probability
that it is smaller than 0:55 is 5:9%; and the probability that it takes values between 0:55 and
0:60 is about 40:5%: Assuming the case fatality rate is 1%, in a country with a population of
10 million persons (e.g., Azerbaijan or Sweden), the "road" to immunity would produce about
55,000 expected deaths if Pcrit = 0:55; versus 62,000 if it were Pcrit = 0:62; a di¤erence of 7,000
person dying. The larger the uncertainty about Pcrit , the larger the risk associated with choosing
a strategy for control of the epidemic.

79

3

68

69
70
71
72
73
74
75
76
77

80
81

Application to the COVID-19 pandemic

Data were downloaded from the European Centre for Disease Prevention and Control, an European
Union organization based in Sweden. Twelve countries were chosen and organized into two groups

3

medRxiv preprint doi: https://doi.org/10.1101/2020.05.31.20118695; this version posted June 1, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

111

as shown in Table 1. Estimates of Rt (posterior median and 2.5 and 97.5 percentiles of the posterior
distribution) were obtained using EpiEstim at times t = 8; 14 from the …rst case. Simple "plug-in"
estimates of Pcrit and of percentiles were derived from the relationship between the latter and Rt :
In some cases (Brasil, Uruguay, New Zealand and USA) some percentiles could not be calculated
because Rt was smaller than 1, producing "plug-in" estimates of Pcrit outside of its parameter
space. Inter-percentile ranges were wide in many instances. For example, at t = 8 (the earliest
time at which EpiEstim produced an estimate of Rt ; the range was 35% in Argentina, 31% in
Cuba, 37% in Denmark and 22% in Israel; at t = 14 the range was still wide for Israel, at 35%.
For Sweden, the ranges were 21% and 8% at times t = 8 and t = 14; respectively. The uncertainty
about Pcrit was large for many countries.
Instead of using the crude "plug-in"method, which can yield estimates outside of the 0 1
space for a proportion, EpiEstim can be "tricked" to produce the entire posterior distribution.
At any t; EpiEstim returns the mean and standard deviation (sd) of the posterior distribution.
mean
mean 2
and b =
from
If the parameterization is Gamma(shape = a; rate = b); then a =
sd
sd2
which (2) can be numerically evaluated. Alternatively, the posterior distribution of Pcrit can be
estimated by drawing random numbers from a computer as follows: 1) sample a large number of
1
Gamma(a; b) deviates. 2) For each draw, form 1
, and accept it as draw from
sampled value
the posterior distribution of Pcrit if it resides in the (0; 1) interval; discard it otherwise.
The posterior densities for Group A and B countries are in Figures 2 and 3, respectively. The
"plug-in" measures of uncertainty for Pcrit derived from the percentiles of the posterior distribution
of Rt were often misleading or useless. For example, for Argentina (Figure 2, curve in red) the
naive lower bounds for t = 8 does not inform that Pcrit should probably be at least 50% to attain
herd immunity. For Israel (Figure 3) the naive bounds exaggerate uncertainty as the posterior
densities are reasonably sharp, both at t = 8 and t = 14: In Uruguay (Figure 2), the low number
of cases observed translated into low values of Rt ; especially at t = 14 but suggested that herd
immunity could be reached with a low proportion of the population infected, which would perhaps
take a considerable amount of time but at a low cost in terms of number of dead people. However,
at t = 8 the analysis suggested that Pcrit would need to be around 50 60%: For Sweden (Figure
3), it appears that Pcrit would need to be at least 55%; for the USA (Figure 3), the uncertainty
was enormous, as suggested by the analyses conducted a t = 8 and t = 14..

112

4

82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110

113
114
115
116

Conclusion

Attaining herd immunity requires a minimum proportion of the population to infected. Such
proportion can be inferred from estimates of the virus reproducing number calculated at early
stage of the epidemic. Plug-in measures of con…dence on estimates were misleading, but a full
characterization of statistical uncertainty was derived from publicly available software. Because of
4

medRxiv preprint doi: https://doi.org/10.1101/2020.05.31.20118695; this version posted June 1, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

118

the important levels of uncertainty, it is extremely risky to design epidemiological policy based on
the guidance provided by a single point estimate, as in Kwok et al. (2020).

119

5

117

120
121
122
123
124
125
126
127
128
129
130
131
132
133

References

Cori A, Ferguson NM, Fraser C, Cauchemez S. A new framework and software to estimate timevarying reproduction numbers during epidemics. American Journal of Epidemiology 2013 178:
1505-1512.
Dowdy D, D’Souza G. Early Herd Immunity against COVID-19: a dangerous misconception. 2020. Department of Epidemiology, Johns Hopkins Bloomberg School of Public Health
https://coronavirus.jhu.edu/from-our-experts/early-herd-immunity-against-covid-19-a-dangerous-misconcepti
Gelman A, Carlin JB, Stern HS, Dunson DB, Vehtari A, Rubin DB. Bayesian Data Analysis
(3rd Ed) 2014. CRC Press, Boca Raton.
Kwok Ko, Lai F, Wei WI, Wong SYS, Tang JWT. Herd immunity- estimating the level required
to halt the COVI-19 epidemics in a¤ected countries. J Infect 2020 doi.org/10.1016/j.inf.2020.03.027
Nishiura H, Linton NM, Akhmetzhanov AR. Serial interval of novel coronavirus (COVID-19)
infections. International Journal of Infectious Diseases 2020 93 284-286.
Sorensen D, Gianola D. Likelihood, Bayesian and MCMC methods in quantitative genetics 2002.
Springer, New York.

5

medRxiv preprint doi: https://doi.org/10.1101/2020.05.31.20118695; this version posted June 1, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Table 1. Estimates of the median, 2.5 and 97.5 percentiles of the posterior distribution of R[t] (virus
reproducing number) at days t=8, 14 of the COVID-19 pandemic in twelve countries. The “plug-in” Pcrit
(minimum proportion of the population that needs to be infected in order to reach herd immunity)
estimates are directly obtained from the relationship Pcrit =1- R[t]-1.
Median R[8]

(2.5%[8], 97.5%[8])

PCrit[8]

(2.5%[8], 97.5%[8])

Median R[14]

(2.5%[14], 97.5%[14])

PCrit[14]

(2.5%[14], 97.5%[14])

GROUP A
Argentina
Brasil
Chile
Cuba
Peru
Uruguay

3.31 (2.31,4.56)
1.14 (0.16,3.79)
3.27 (2.11,4.81)
2.70 (1.74,3.96)
3.31 (2.41,4.40)
2.58 (2.16,3.05)

0.70 (0.43,0.78)
0.12 (ND1,0.74)
0.69 (0.53,0.79)
0.63 (0.43,0.74)
0.70 (0.58,0.77)
0.61 (0.54,0.67)

2.11 (1.72,2.56)
3.18 {2.06,4.63}
4.18 (3.61,4.82)
1.81 (1.39,2.31)
2.73 (2.39,3.10)
1.03 (0.86,1.22)

0.53 (0.42,0.61)
0.69 (0.54,0.78)
0.76 (0.72,0.79)
0.45 (0.28,0.57)
0.63 (0.58,0.68)
0.03 (ND1,0.18)

Denmark
3.07 (1.52,3.43)
Germany
3.13 (2.96,3.61)
Israel
3.69 (1.56,7.24)
N. Zealand
2.65 (0.92,5.81)
Sweden
3.30 (2.31,4.54)
USA
2.85 (0.99,6.24)
1
ND: not defined because R<1.

0.67 (0.34,0.71)
0.68 (0.66,0.72)
0.73 (0.36,0.86)
0.62 (ND1,0.83)
0.70 (0.57,0.78)
0.65 (ND1,0.84)

10.30 (9.09,11.61)
2.39 (2.25,2.55)
2.46 (1.59,3.62)
3.83 (2.86,5.00)
2.84 (2.53,3.17)
1.53 (0.65,3.00)

0.90 (0.89,0.91)
0.58 (0.56,0.61)
0.59 (0.37,0.72)
0.74 (0.65,0.80)
0.65 (0.60,0.68)
0.35 (ND1,0.67)

GROUP B

medRxiv preprint doi: https://doi.org/10.1101/2020.05.31.20118695; this version posted June 1, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Figure 1. Posterior density of P(crit) for a hypothetical example. E[P(crit)]=0.60 and the posterior
coefficient of variation is 5.2%.
Figure 2. Posterior densities of P(crit) at times=8 and 14 of the COVID19 pandemic for Argentina, Brasil,
Chile, Cuba, Peru and Uruguay
Figure 3. Posterior densities of Pcrit at times=8 and 14 of the COVID19 pandemic for Denmark, Germany,
Israel, New Zealand, Sweden and USA

medRxiv preprint doi: https://doi.org/10.1101/2020.05.31.20118695; this version posted June 1, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

medRxiv preprint doi: https://doi.org/10.1101/2020.05.31.20118695; this version posted June 1, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

