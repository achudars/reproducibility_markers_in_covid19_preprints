medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Estimating the strength of selection for new SARS-CoV-2 variants
Christiaan H. van Dorp1,* , Emma E. Goldberg1,* , Nick Hengartner1,2 , Ruian Ke1,2 , and
Ethan O. Romero-Severson1,2,†
1 Theoretical

Biology and Biophysics (T-6), Los Alamos National Laboratory,
Los Alamos NM, USA
2 New

Mexico Consortium, Los Alamos NM, USA

* These

authors contributed equally to this work

† Correspondence:

eoromero@lanl.gov

March 29, 2021

Abstract

A challenge to controlling the SARS-CoV-2 pandemic is the ability of the virus to adapt to its new human
hosts, with novel and more transmissible strains of the virus being continually identified. Yet there are no
generally accepted methods to consistently estimate the relative magnitude of the change in transmissiblity of newly emerging variants. In this paper we consider three methods for examining and quantifying
positive selection of new and emerging strains of SARS-CoV-2 over an existing wild-type strain. We
consider replication at the level of countries and allow for the action of other processes that can change
variants’ frequencies, specifically migration and drift. We apply these methods to the D614G spike mutation and the variant designated B.1.1.7, in every country where there is sufficient sequence data. For each
of D614G and B.1.1.7, we find evidence for strong selection (greater than 25% increased contagiousness)
in more than half of countries analyzed. Our results also shows that the selective advantages of these
strains are highly heterogeneous at the country level, suggesting the need for a truly global perspective on
the molecular epidemiology of SARS-CoV-2.

Introduction
Recently, several genetic variants of SARS-CoV-2 have been identified that are either suspected or confirmed to have
mutations that increase the contagiousness of the virus above the current circulating variants [1, 2, 3]. For a short
while after the emergence of SARS-CoV-2, it was believed that the adaptive evolution of SARS-CoV-2 was limited, as
evidence for purifying selection was found at most sites, with the clear exception of position 614 of the spike protein
[4]. However, the emergence and rise of more complex variants such as B.1.1.7 in the United Kingdom (UK) has
1

NOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice.

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

shifted this understanding. As SARS-CoV-2 continues to adapt to transmission among humans, we can expect to see
further mutations that alter the phenotype of the circulating virus [5]. Likewise, the gradual roll-out of vaccination
programs globally will slowly change the immunological landscape, possibly leading to the emergence of escape
strains that are partially or fully resistant to existing vaccinations [6, 7, 8].
Molecular epidemiology is a powerful framework comprised of a broad collection of methods and software
designed to facilitate the analysis of pathogen genetic sequence data [1, 2, 3, 9]. These methods allow us to peer beyond
what is provided by traditional epidemiological data such as case counts and death time-series, into the substructure of
an epidemic by tracking the emergence and transmission of new genetic variants. Given the high extent of population
mixing at both local and global levels, the time between the emergence of a new strain in one country and its global
dissemination is short. Given that rapid spread, the ongoing fight against COVID-19 needs new, global tools focused
on rapid modeling and assessment of the risk associated with new strains of SARS-CoV-2 to support global public
health action.
Several groups have investigated the selective advantage of particular SARS-CoV-2 variants, such as D614G
and B.1.1.7, either qualitatively or quantitatively. The global spread of the D614G variant was first described by Korber
et al. [10]. Specifically for the UK, the selection coefficient for the D614G variant has been estimated using various
phylogenetic and phylodynamic methods [3]. Estimates from these methods are highly variable, often producing
inconclusive answers. The increased infectiousness of the D614G variant has also been functionally explained in
terms of ACE2 receptor binding [11]. The selection coefficient of the B.1.1.7 variant has been estimated for England
using a highly detailed deterministic epidemic model [12]. Phylodynamic approaches have led to similar results [2].
More worryingly, the B.1.1.7 variant is associated with increased mortality [13]. These changes to the SARS-CoV-2
phenotype embodied in D614G and B.1.1.7 likely represent only a small fraction of the phenotypic variability in the
broader population.
In this paper we consider three different approaches for analyzing global sequence data to estimate the evidence
for increased contagiousness of existing strains in the context of potentially high levels of between-country movement
of people. Our goal is to test the robustness of results to different modeling assumptions, and to asses these different
approaches as molecular surveillance tools.

Methods
We use three distinct methods to study the change in frequency over time of a SARS-CoV-2 genetic variant: isotonic
regression, a population genetics model, and a stochastic epidemiological model. These models represent trade-offs
in mechanistic detail and computational efficiency. The first takes a descriptive approach to the rise and fall of variant
frequency based around rejecting a null hypothesis of limited or no change in frequency. The second incorporates the
processes of selection and migration in the context of a deterministic theoretical population. The third additionally
includes stochastic effects and more explicit epidemiological processes. By comparing results from these three models,
we assess the robustness of our findings to the assumptions of particular methods. In all models, we compare a new
variant with the circulating background variants. The new and background variants are labeled mt (for “mutant”) and

2

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

wt (for “wild type”) respectively. All data and scripts can be downloaded from https://github.com/eeg-lanl/
sarscov2-selection
Data
All epidemiological data was taken from the COVID-19 Data Repository curated by the Center for Systems Science
and Engineering (CSSE) at Johns Hopkins University [14], aggregated by week to reduce noise. The D614G and
B.1.1.7 variant data were taken from the Los Alamos COVID-19 Viral Genome Analysis Pipeline [10, 15] and GISAID
[16, 17], respectively.
Isotonic regression
The logic behind the isotonic regression method is that, if a variant is under selection strong enough to be worrying,
then we should see a continual increase in its relative frequency. That is, for a variant under selection in a given
country, we should be able to reject the hypothesis that it shows no increase with respect to its background.
Let us consider modeling the time series of pairs (Ftwt , Ftmt ) that count the number of samples identified as
the new variant (Ftmt ) and all other background sequences (Ftwt ) observed on a given day t. If we assume that the
individuals whose SARS-CoV-2 virus is sequenced are randomly selected from the pool of infected individuals, then
the number of observed variant sequences Ftmt , conditional on the total number of sequenced individuals Ft = Ftwt +
Ftmt , is binomial with probability pt and size Ft . If the mutations that define the new variant (i.e., the genotype)
are neutral, being neither beneficial nor deleterious, then the proportion pt performs a random walk with constant
expectation. However, if the variant has an evolutionary advantage, then the proportion pt will have a non-decreasing
expectation over time.
Here, we use that observation to devise a statistical test for the null hypothesis that a genotype is not advantageous. This approach does not, however, provide us with an estimate of how advantageous a genotype is because it
does not model the competition between variants.
Let (ti ,Vi ), i = 1, . . . , K denote the date and variant Vi ∈ {wt, mt} from each of the K tested individuals. Our test
is based on fitting isotonic logistic regressions to estimate a monotone non-decreasing probability pt to that data, and
use the logarithm of the likelihood ratio of the fitted isotonic model and model with constant pt as the test statistic.
Unlike in regular parametric cases, that statistic does not have an asymptotic chi-square distribution.
For that reason, we empirically evaluate the null distribution of the test statistic by refitting the isotonic regression to (ti ,Vi? ), where V1? , . . . ,VK? is a random permutation of the original data V1 , . . . ,VK . Fitting the isotonic logistic
regression to M random permutations allows us to calculate empirically the country level p-value for the null hypothesis of no evolutionary advantage that are reported in Results. These were calculated in R 3.6.3 using the package cgam
[18] to perform the isotonic logistic regression.
Population genetics model
The goal of this modeling approach is to provide a rapid means of estimating the selective advantage of a new genetic
variant while also allowing for some contribution from migration. We first describe the model within each country.
Then we explain how we fit it to data from all countries.
3

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

The model assumes that time is measured in discrete units of generations. Within each generation, we let
selection act first and then migration. Say that p and q are the frequencies of new and background variants, respectively,
at the beginning of the generation (p + q = 1). Then say that p∗ and q∗ are the variant frequencies after selection, and
p0 and q0 are the frequencies after migration and hence at the beginning of the next generation.
Selection
Define the absolute fitnesses of the two variants as Wwt = β and Wmt = β (1 + s). So β is the geometric growth rate
in number of infected people for the original genotype, and s is the selective advantage (if s > 0) or disadvantage (if
s < 0) of the new variant.
For the moment, let us be explicit about population size. Define Nmt = N p and Nwt = Nq as the numbers of
infected people with each variant at the beginning of this generation, where N is the total number of infected people
in the population. After the selective event, which is transmission of each of the variants to new hosts, the numbers of
infected people become
∗
Nmt
= Wmt Nmt = β (1 + s)N p

(1a)

∗
Nwt
= Wwt Nwt = β Nq .

(1b)

Even if transmission (and recovery) alters the number of infected people, this change in population size does not affect
the new variant frequencies, i.e.,
∗
β (1 + s)N p
(1 + s)p
Nmt
=
=
∗
∗
Nmt + Nwt
β (1 + s)N p + β N(1 − p)
1 + sp
1
−
p
q∗ =
1 + sp

p∗ =

(1c)
(1d)

is independent of N and of β . So even with arbitrary changes in the number of infected people over time, this simple
deterministic model can track only the variant frequencies. Of course, drift can have large effects when N is small,
and also when a population of any size is growing rapidly. But we leave stochastic effects to our subsequent, more
complex epidemic model.
Migration
Next, a fraction m of our population is replaced by immigrants. That is, some number of infected people leave our
population, and an equal number of infected people arrive from elsewhere. We say that immigration is balanced by
emigration because we are applying this same model to many populations (countries) simultaneously, and travel itself
does not change the total number of infected people.
The change in frequency of the new variant due to migration is
p0 = p∗ (1 − m) + p̄m,

4

(2a)

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

where p̄ is the frequency of the new variant among the immigrants. To be most generous to the alternative explanation
that immigration is the driving force behind increases in p, we set p̄ = 1 so
p0 = p∗ + (1 − p∗ )m .

(2b)

Note that if the number of infected people is increasing over time (β > 1 in the description of selection, above), our
formulation with constant migration fraction m means that the number of infected travelers is also increasing over
time.
Putting together the total effects of selection and migration for this generation, by substituting Eq. (1c) into
Eq. (2b),
(1 + s)p + (1 − p)m
.
1 + sp

(3)

[s(1 + s)t + m(1 − m)t ]p0 + m[(1 + s)t − (1 − m)t ]
s[(1 + s)t − (1 − m)t ]p0 + [m(1 − s)t + s(1 − m)t ]

(4)

p0 =
At any time t,
pt =

(see Eq. (A-6)). We define t = 0 as the time at which the new variant first appears in any country. Notice that without
migration (m = 0), Eq. (4) reduces to the logistic model derived in [19].
Fitting to data
For each country, the data we use are the numbers of observations of the background (Ftwt ) and the new variant (Ftmt )
each day (t). We fit these data with Bayesian binomial regression, using Eq. (4), with country as a random effect. This
yields separate estimates of s, m, and p0 for each country.
Because the time unit for our data is days, the estimates of s and m from the model fit must be multiplied by
the generation time in order to be interpreted as per-generation processes. The mean serial interval for SARS-CoV-2
is most likely between 4 and 7.8 days [20], so we use a normal distribution with mean 5.9 and standard deviation 1.15
for the mean generation time.
When selection truly favors a variant due to its genetic composition, it should have a similar advantage in
any country. There may be differences from country to country, though, due to chance effects. For example, if the
early-infected people happen to be from a demographic with higher transmission or a city with looser enforcement of
social distancing, selection may appear to be stronger. We therefore use a hierarchical model in which s is drawn for
each country from a normal distribution, whose mean and variance we estimate in order to infer the consistency of
selection.
The migration rate, m, is the proportion of the country’s population swapped out for the new variant each
generation. This is surely quite small, especially considering travel restrictions. We therefore set an exponential prior
on m with mean 0.001.
For numerical stability, we transform all frequencies to the logit scale (see Appendix A). Models were fit with
Stan [21], using 4 parallel chains of length 2000, with a warm-up phase of a 1000 iterations.

5

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Stochastic epidemic model
To take more detailed population dynamics into account, we use a stochastic compartmental Kermack-McKendricktype model. In addition to susceptible (S), exposed (E), infectious (I), and removed (R) individuals, we keep track of
individuals with severe disease (H), and stratify the exposed and infected populations into individuals infected with the
background (wt) or the new variant (mt). The compartment of severe infections is used to model the observed delay
between infection and death. The two strata are used to keep track of the new variant’s frequency in the population,
and model its selective advantage (s).
The compartmental model keeps track of the number of individuals S, E, I, H, R in the disease states S, E, I,
H, R, respectively. An individual starts out susceptible, and upon infection enters the exposed compartment and then
becomes infectious at rate α. An infectious individual can either become severely infected at rate ν, or recover at
rate γ. Severely infected individuals either recover or die at rate ω. The total population size is denoted by N, and
we write X = (S, Ewt , Emt , Iwt , Imt , H, R). The transition rates η j (X,t) between the compartments are indicated by the
following diagram, and the parameters are listed in Table 1.

N+

/
β Iwt

S
β (1

λ wt

Ewt

α

Iwt

γ
ν
ν

+ s)
Imt /

N+

Emt

λm

t

Imt

α

H

ω

R

(5)

γ

Here the indicated rates are per capita and should be multiplied by the size of the source compartment (e.g.,
ηH→R (X,t) = Hω). The selective advantage of the new variant is equal to s; when s > 0, the mutant has a higher
infection rate β (1 + s) than to the wild-type (β ). The other life-history traits of the virus are assumed to be identical
between wild-type and mutant. To model the effects of non-pharmaceutical interventions (NPI) such as lock-downs,
the infection rate β is a smoothed, piece-wise constant function of time [22]. To account for migration, we added
time-dependent terms λwt and λmt to the per-capita infection rate, representing the exposure of individuals in the
population to SARS-CoV-2 from other regions. The precise definitions of the time-dependent parameters β , λwt , and
λmt are given in Appendix B.
Observation model
The model is fit to two data streams. The first data stream consists of weekly incidence of COVID-19 deaths D.
For this reason, we keep track of an auxiliary accumulator variable ΘHR , which keeps track of all transitions from
H to R within a week. After each time the incidence is observed, the accumulator variable ΘHR is set to 0. Let δ
denote the probability that a severe infection leads to death and not recovery. To account for variability in δ between
demographic groups or reporting errors, we use an over-dispersed negative binomial instead of a binomial or Poisson

6

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

symbol

unit

value

description

D614G
UK

NL

B.1.1.7
UK

NL

s

-

0.28

0.27

0.55

0.28

β0
β1
β2

d−1
d−1
d−1

0.81
0.15
0.21

0.80
0.12
0.33

0.40
0.25
0.34

0.39
0.22
0.37

β3

d−1

-

-

0.18

0.20

t0
t1
t2
t3
p0
λ0

d
d
d
d
d−1

54
86.6
188
0.28
-

54
82.5
181
0.37
-

243
305
337
369
3.0 · 10−4
-

243
298
336
365
5.7 · 10−3

rD

-

105

115

90.2

93.0

rF

-

72.8

68.3

70.3

71.6

τ

d−1

0.011

0.018

0.021

0.013

ζ
ξ

-

8.2 · 10−6
-

1.7 · 10−5
-

3.3 · 10−4
0.06

3.1 · 10−4
0.05

N
1/α

d

66.5
3

17.4
.

66.5
.

17.4
.

γ

d−1

1/4

.

.

.

ν

d−1

γ/50

.

.

.

1/ω
δ

d
-

12.5
0.3

.
.

.
.

.
.

source

variant
region
selective advantage novel variant
infection rate before lockdown
infection rate during lockdown
infection rate after lockdown
relaxation
infection rate after second lockdown
initial time
time of lockdown
time of lockdown relaxation
time of second lockdown
initial mutant frequency
per capita infection rate due to
travel
overdispersion parameter death
incidence
overdispersion parameter sequence data
overdispersion of the process
noise
initital fraction infected
fraction of the population immune at time t0
population size (million)
mean duration of incubation
period
recovery rate from infectious
stage
rate of developing severe infection
duration of severe infection
probability of dying from severe infection

est.a
est.
est.
est.
est.
est.
est.
est.
est.b
est.b
est.
est.
est.
est.
[23, 24]c
[25, 26]
[27, 28]d
[29, 30]e
[25, 26]f
[29, 30, 31]e

Table 1: Parameters for the epidemic model for the United Kingdom (UK) and the Netherlands (NL) and the D614G
and B.1.1.7 variants. Notes: a Estimated. b For the Dutch B.1.1.7 model, the initial frequency is fixed to 0. Instead,
the variant is introduced due to travel from the UK. c More recent estimates for sero-prevalence in the Netherlands
are taken from https://www.rivm.nl/pienter-corona-studie/resultaten. d The generation interval in the
SEIHR model with exponentially distributed transition times is equal to 1/α + (γ + ν)−1 ≈ 1/α + 1/γ. Hence, with
an average incubation period of 3 days, we need an average infectious period of 4 days to get an average generation
time of 7 days. e By taking the probability of developing severe infection equal to 0.02 and the probability of dying
from severe infection equal to 0.3, we arrive at a case fatality rate of 0.6%. Our choice is also comparable to mortality
rates for ICU patients [31]. f The average time between symptom onset and death is 16.5 days. After subtracting the
duration of the infections period (γ + ν)−1 ≈ 1/γ, we get an average duration of severe infection of 12.5 days.
7

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

likelihood function for the observed death counts. At the time of the n-th observation tn , we then get
Dn ∼ NegBinom δ · ΘHR (tn ), rD



(6)

where the parameterization of the NegBinom(`, r) distribution is such that it has mean ` and variance ` + `2 /r.
The second data stream consists of the number viral samples F that were sequenced each week, and the number
sequences F mt identified as the new variant. We assume that these sequences are collected from individuals that
transition from the exposed to the infectious compartment, and hence we again define accumulator variables ΘEI
wt and
ΘEI
mt to keep track of such transitions (for wild-type and mutant infections, respectively) during the week between
EI
EI
subsequent observation times. We define fmt = ΘEI
mt /(Θwt + Θmt ) for the fraction of individuals that were infected

with the new variant. To allow for over-dispersion of sampling, we use a beta-binomial likelihood function:
Fnmt ∼ BetaBinom (Fn , fmt (tn )rF , (1 − fmt (tn ))rF )

(7)

where the parameter rF determines the level of over-dispersion of the sampling process.
We fit the model to the two data streams using sequential Monte-Carlo (SMC), where parameters are estimated
with iterated particle filtering as described in [32]. The details of the procedure are given in Appendix B.
Diffusion approximation of the epidemic model
Exact simulation of the Markov jump process (MJP) that defines our stochastic epidemic model is very computationally intensive. We therefore switch to a diffusion approximation of the MJP when population sizes become large in
order to do inference more efficiently. This formalism allows us to incorporate two sources of noise. The first being
the process noise inherent to the MJP, which becomes negligible when the sizes of the compartments are large. We
therefore introduce a second noise term that captures other origins of stochasticity that the MJP can not account for
and acts on predominantly large population sizes.
As above, we denote the state of the n-dimensional model (where n = 7) by X i (t) with i = 1, . . . , n. The discrete,
stochastic model is defined by k = 9 state transitions
η j (X,t)

X −−−−→ X + ε j ,

j = 1, . . . , k

(8)

where ε j ∈ Zn is the increment of the j-th transition. For instance, the transition H → R corresponds to the increment
(0, . . . , 0, −1, 1). Using the Kramers-Moyal expansion of the master equation, the MJP is mapped to a system of
stochastic differential equations (SDE) that can be derived from the transitions η j and increments ε j as follows [33]
k

dX i =

k

∑ ε ij η j (X,t)dt + ∑ ε ij

j=1

q
η j (X,t)dBtj ,

i = 1, . . . , n

(9)

j=1

where Bt is a 9-dimensional Brownian motion, corresponding to the 9 transitions of the MJP in Eq. (5). The SDE in
Eq. (9) is of the form dX = µ(X,t)dt + σ (X,t)dBt , where µ and σ describe the drift and volatility, respectively. The
8

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

volatility matrix σ (X,t) encodes the intrinsic noise of the MJP, which is negligible compared to X when X is large.
We therefore add a small second noise term to the system of SDEs that is proportional to X. After this adjustment, the
SDE becomes
dX i = µ i (X,t)dt + σ i (X,t)dBt + τX i dBeti ,

i = 1, . . . , n

(10)

where Bet is a n-dimensional Brownian motion, independent of Bt . The parameter τ  1 determines the magnitude of
the additional noise term.
In Appendix B, we further describe in detail the algorithm used to switch from a discrete (MJP) to a continuous
(SDE) model, and the way the initial condition of the system is determined.

Results
Isotonic regression results
Our first approach, isotonic regression, provides a simple statistical test for relative increase of a new variant. The null
hypothesis is that the daily proportion of SARS-CoV-2 cases that are the mutant variant does not increase over time.
The isotonic regression method rejected this null hypothesis in 33 of 38 countries with sufficient data for D614G and
all 24 of the countries with sufficient data for B.1.1.7 at the 5% significance level. The results are shown as a map
in Fig. 1CD. In general the isotonic regression method identifies the same set of countries as the population genetic
method (see below). However the computed p-value is not directly translated into an estimate for the strength of
selection that is estimated from the other methods.
Population genetic model results
Our hierarchical population genetics model estimates a normal distribution from which is drawn the selection coefficient for each country. The mean of that global distribution for s is 0.25 (90% credible interval (CrI): [0.14, 0.35])
for D614G and 0.26 (90% CrI: [0.14, 0.36]) for B.1.1.7, both confidently greater than zero (Fig. 2AD). After allowing
for variance around that mean, however (Fig. 2BE), the overall global distribution of s is substantially wider, both
for D614G (90% CrI: [−0.16, 0.68], Fig. 2C) and for B.1.1.7 (90% CrI: [−0.07, 0.60], Fig. 2F). Uncertainty in our
estimates of global s come from noise in the data, uncertainty in the mean generation time, and heterogeneity among
countries.
The overall selective advantages of these two variants are estimated to be very similar, but that does not mean
that they are equally transmissible. The strength of selection for a variant is measured relative to all the other genotypes
present over that time frame. Because B.1.1.7 emerged after D614G became globally common, the absolute fitness of
B.1.1.7 is likely greater.
Estimates of the selection strength for each variant in each country are shown in Fig. 3. Each variant shows
much heterogeneity among countries. Our model allows for a random component in country-to-country variation in s,
but the differences in estimated s among the countries likely overstates the differences in actual transmission advantage.
Each country surely experiences many processes that are not included in our simple model—such as superspreader
events, nonrandom sampling, or waves of travellers arriving from places with different variant frequencies—and all of

9

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

isotonic regression

B.1.1.7

D614G

population genetic model

Figure 1: Map of the results of the population genetic model and isotonic regression method. Panels A and B show
the estimated selection strength for D614G and B.1.1.7 respectively. Yellow, orange, and red indicated selection
coefficient less than 0.3, between 0.3 and 0.6, and above 0.6 respectively. Panels C and D show the p-values from the
isotonic regression method for D614G and B.1.1.7 respectively. Red and green show p-values below and above 0.05
respectively.

this heterogeneity is bundled by the model into differences in s (and m, which is constrained to be small). Furthermore,
strong selection for one variant in one country does not necessarily correspond to strong selection for the other variant
in that country (Fig. S2), suggesting that factors beyond country-level covariates underlie the overall heterogeneity.
In estimating the selective advantage of each variant, our model allows for a contribution of migration in
elevating the variant frequencies (see Methods). Because selection and migration to some extent provide alternative
explanations for change in variant frequency, we find some negative correlation between these two processes (Figs. S3
and S4). The estimates of migration are not particularly distinguishable among countries (Fig. S1), but estimates of
selection nevertheless show clear differences among countries (Fig. 3). We thus conclude that the selective effect of a
variant can be estimated even allowing for a reasonable amount migration.
Fits of the population genetic model to each country are shown in Figs. S5 and S6 for D614G and B.1.1.7,
respectively. The countries differ dramatically in sampling effort and data availability over time. The robustness of the
population genetic model is tested with a more detailed epidemic model below. For this analysis, we focused on two
countries—the United Kingdom and the Netherlands—for which a lot of data is available. Our focal countries show
different stages of the variant trajectories, but in both the model fits show relatively narrow credible intervals.

10

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

probability density

D614G
A6

B

C

4

1.0

4
2

0.5

2

0

0
0.0

0.1

0.2

0.3

0.4

0.5

0.0
0.0

0.1

s mean

0.2

0.3

0.4

0.5

−0.5

0.0

s std dev

B.1.1.7
D
probability density

1.5

6

E

6

0.5

1.0

0.5

1.0

s

F
2.0
7.5
1.5

4

5.0
1.0

2

2.5

0

0.5

0.0
0.0

0.1

0.2

0.3

0.4

0.5

0.0
0.0

0.1

s mean

0.2

0.3

s std dev

0.4

0.5

−0.5

0.0

s

Figure 2: Estimated global distribution of selection coefficients for the D614G and B.1.1.7 variants from the population
genetics model. The hierarchical model estimates the mean (left column) and standard deviation (middle column) of
a normal distribution from which the selection coefficient, s, of each country is drawn. To compose the overall
(posterior predictive) distribution of s (right column), we sampled many values of the mean and standard deviation
from the posterior distribution of the model, and for each drew many samples from the normal distribution it defines.
Thus, panels A and D provide the estimated mean selection coefficient across countries, while panels C and F provide
the overall distribution for each country’s selection coefficient. In each panel, dark vertical lines mark the median, and
the 90% CrIs are shaded.

Stochastic model results
The overall stochastic model fits to D614G and B.1.1.7 for the UK and Netherlands are shown in Fig. 4 and 5 respectively. The models provide very good fits to the data in both cases matching both the death time series and the
change in proportions of the mutant variant in both countries. D614G shows a very similar pattern in the UK and
Netherlands where the mutant was spreading in a way that is nearly indistinguishable from the wild-type strains for a
period of several weeks in the early epidemic period. However, in both countries the model predicts that the mutant
strain very quickly outpaces the wild-type strains and continues to become more relatively prevalent even when the
overall prevalence is declining by orders of magnitude.
The dynamics of B.1.1.7 in the UK and Netherlands are substantially different from both D614G and each
other. In both cases the mutant strain is much slower to rise, occurring over a period of months rather than weeks

11

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

D614G

B.1.1.7

selection

selection
Luxembourg
Italy
Jordan
Canada
Denmark
United Kingdom
Ireland
Austria
Hungary
Switzerland
Iceland
Romania
Nigeria
Turkey
Australia
United States
Sweden
Spain
Germany
Finland
United Arab Emirates
South Korea
Belgium
France
Czechia
Slovakia
Netherlands
New Zealand
Norway
Israel
Ghana
Singapore
Portugal
Thailand
Brazil
India
Ecuador
North Macedonia
Poland
Mexico
Hong Kong SAR China
Sri Lanka
Bosnia & Herzegovina
Latvia
Aruba

Japan
Canada
France
Spain
China
Brazil
Chile
South Korea
Hong Kong SAR China
Australia
Oman
United Kingdom
Mexico
Colombia
Vietnam
Turkey
Sweden
New Zealand
South Africa
Denmark
India
Israel
Thailand
United States
Taiwan
Netherlands
Bahrain
Germany
Portugal
Greece
Austria
Malaysia
Belgium
United Arab Emirates
Panama
Saudi Arabia
Singapore
Iceland
0.0

0.5

1.0

−1.0

s

−0.5

0.0

0.5

s

Figure 3: Selection coefficients for each country, from the population genetic model. Points mark the median, and
thick and thin lines are 90% and 95% CrIs, respectively. Corresponding estimates of migration are in Fig. S1.

as was the case with D614G. In both countries, the mutant strain rises exponentially despite the large changes in the
overall prevalence of COVID-19 due to changing policies and behaviors during this time. Specifically in the UK,
the rise in death incidence after December 14 2020 is preceded by the rapid increase of the B.1.1.7 strain, both in
frequency and absolute numbers (Fig 5). This suggests that the interventions ongoing in the UK were sufficient to
bring the background strains below threshold but not B.1.1.7.
To further substantiate this, we calculated the instantaneous effective reproduction number (Re ) using the inferred trajectories of the stochastic model (Fig S7). The effective reproduction number of the wild-type fluctuates
abound the threshold value 1 between November and December, following the increased NPI (non-pharmaceutical
intervention) initiated end October [34]. As the B.1.1.7 variant has a ∼ 50% higher reproduction number, these NPI
were not sufficient for controlling the growth of the variant, leading to a doubling of the death incidence in January
2021 and the necessity of further stringent restrictions. This suggests that new variants with an increased fitness are
particularly dangerous when in-place NPI are only resulting in a marginal control of the epidemic.
As the B.1.1.7 variant was most likely introduced to the Netherlands from the UK, we incorporated external
forces of infection in the Netherlands (λwt and λmt in Eq. (5)) to account for this fact (see Appendix B). This process
allows a source of infection in the Netherlands, governed by rate λ0 (Table 1), that is proportional to the prevalence of
B.1.1.7 in the UK. We forced the migration process to zero after December 21, 2020 to account for travel restrictions
from the UK to the Netherlands. Based on a sample of 100 reconstructed trajectories of the stochastic model (Fig. 5B,
green curves), we estimate that at that time of the travel restriction being in place, 6694–10287 individuals were
infected with the B.1.1.7 variant in the Netherlands. That is, the model suggests that the establishment of B.1.1.7 in

12

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

6.0 × 105

Iwt
Imt

B

United Kingdom

20000
10000

Ma
r
Ma 07
r
Ma 11
r1
5

0

D
data
model

6000
4000
2000
0

E

0

1000
500

F

1.0
0.5

0
1.0
0.5

data
model

0.0

0.0
Ma
r
Ma 02
r
Ma 16
r
Ap 30
r1
Ap 3
Ma r 27
y
Ma 11
y
Jun 25
Jun 08
2
Jul 2
0
Jul 6
Au 20
g
Au 03
g1
7

C

0

5.0 × 104

2.0 × 105

1000
500

1.0 × 105

0

4.0 × 105

Netherlands

1.5 × 105

Fe
b
Ma 26
r
Ma 01
r0
5

8.0 × 105

Ma
r
Ma 02
r
Ma 16
r
Ap 30
r1
Ap 3
Ma r 27
y
Ma 11
y
Jun 25
Jun 08
2
Jul 2
0
Jul 6
Au 20
g
Au 03
g1
7

mutant frequency

death incidence

population size

A

date

date

Figure 4: Mechanistic model fit to D614G data in the Netherlands and UK. Panels A and B show many realizations of
the prevalence of the background, Iwt , and D614G variant, Imt for the maximum likelihood model fit. Panels C and D
show the number of deaths accumulated up to the week scale (black dots) and the model fits to those data. The bars
around the points indicate the 95% predictive interval for the data according to the model. Panels E and F show the
proportion of sequenced genomes with a glycine on position 614 of the spike protein in a given week. The blue lines
are realizations of the model fit to the data. Vertical bars on the data indicate the 95% confidence intervals (CI) for the
proportion based on the number of sampled genomes.

13

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

8.0 × 105
6.0 × 105

Iwt
Imt

B

United Kingdom

Netherlands

8.0 × 104
6.0 × 104

4.0 × 105

4.0 × 104

2.0 × 105

2.0 × 104

0

0

C

D
data
model

750
500
250
0

5000
0
1.0

F
data
model

1.0

0.5

0.5

0.0

0.0
Se
p
Se 07
p
Oc 21
t
Oc 05
t
No 19
v0
No 2
v
No 16
v
De 30
c
De 14
c
Jan 28
Jan 11
Fe 25
b
Fe 08
b2
2

E

Se
p
Se 07
p
Oc 21
t
Oc 05
t
No 19
v0
No 2
v
No 16
v
De 30
c
De 14
c
Jan 28
Jan 11
Fe 25
b
Fe 08
b2
2

mutant frequency

death incidence

population size

A

date

date

Figure 5: Mechanistic model fit to B.1.1.7 data in the Netherlands and UK. Panels A and B show many realizations
of the prevalence of the background, Iwt , and B.1.1.7 variant, Imt for the maximum likelihood model fit. Panels C and
D show the number of deaths accumulated up to the week scale (black dots) and the model fits to those data. The
bars around the points indicated the 95% predictive internal for the data according to the model. Panels E and F show
the proportion of sequenced genomes classified as the B.1.1.7 variant in a given week. The blue lines are realizations
of the model fit to the data. Vertical bars on the data indicate the 95% CI for the proportion based on the number of
sampled genomes.

14

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

United Kingdom

Netherlands
172

log-likelihood

235

174

240

176
245
250

178
0.2

0.3
s

0.4

0.1

0.2

s

0.3

0.4

Figure 6: Profile likelihood for the selection effect of D614G in the UK and Netherlands. The maximum likelihood
estimate (MLE) is indicated by a dashed line and the 95%CI is indicated by a grey box. For the UK, we estimated
a selection coefficient s = 0.28 (95% CI: [0.23, 0.33]), and for the Netherlands we estimated s = 0.27 (95% CI:
[0.20, 0.35]). The red box plots show the estimates from the population genetics model (Fig. 3).

the Netherlands was facilitated by migration from the UK, however, the major factor in the spread of B.1.1.7 in the
Netherlands is its selective advantage s.
The profile likelihoods of s, the increase in contagiousness for the mutant variant, for the D614G and B.1.1.7
are shown in Fig. 6 and 7. The profile likelihoods show well constrained estimates of s. In general the confidence
intervals in the mechanistic model are comparable with or more narrow than the population genetic model, which
is consistent with the model being both more constrained and using more data. In addition, the population genetics
model takes the uncertainty in the average length of the generation interval into account. The point estimates of s
from both models are close to one another with the largest difference being about 0.12 for B.1.1.7 in the UK. Point
estimates of the other model parameters are listed in Table 1. The fact that the population genetics model results in
smaller estimates of s in some cases can be understand by looking at the population dynamics. The emergence of
the variant is in all cases followed by increased NPI, leading to a decrease in the number of infected individuals, and
also the relative growth rate of the variant. This is interpreted by the population genetics model as a smaller selection
coefficient.

Discussion
We have illustrated three different approaches to measuring selection effects from the global SARS-CoV-2 genetic
sequence data. Our analyses all point to very strong but heterogeneous selective advantages for the D614G and
B.1.1.7 variants at the country level, even allowing for both migration and drift. It is important to note that our
methods look for an advantage of a given variant over whatever variants are circulating at the time, rather than against
a fixed reference strain. This means that the estimates of a fitness advantage of B.1.1.7 in many countries is relative to
a background that consists mostly of D614G. Thus, the fitness of B.1.1.7 exceeds that of D614G, which itself exceeds
15

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

log-likelihood

United Kingdom
295
300
305
310

0.3

0.4

0.5
s

0.6

0.7

160
162
164
166
168
170
172

Netherlands

0.1

0.2

0.3
s

0.4

0.5

Figure 7: Profile likelihood for the selection effect of B.1.1.7 in the UK and Netherlands. The MLE is indicated by a
dashed line and the 95%CI is indicated by a grey box. For the UK, we estimated a selection coefficient s = 0.55 (95%
CI: [0.50, 0.60]), and for the Netherlands we estimated s = 0.28 (95% CI: [0.20, 0.38]). The red box plots show the
estimates from the population genetics model (Fig. 3).

the original genotype. Our stochastic epidemiologic model suggests that the level of transmissibility of currently
circulating variants is sufficient to reduce the qualitative effect of non-pharmaceutical interventions (NPIs) in Europe.
SARS-CoV-2 is rapidly adapting to its new human hosts, and strains with elevated contagiousness will likely
continue to emerge as the virus continues to adapt. This situation is challenging as elevated contagiousness narrows
the range under which vaccination programs can eliminate the virus, and it also opens up the possibility of escape
mutations allowing infection among vaccinated persons. Integrating molecular epidemiology surveillance into SARSCoV-2 pipelines is essential for not only monitoring the emergence of new strains, but for establishing an early warning
system to monitor for escape mutations in the era of vaccine roll-out. Each approach that we examined has its own
strengths and weaknesses for how it can fit into an expanded molecular epidemiology surveillance system.
The isotonic regression method is easy to compute and based on the very straightforward premise that a consistent selective advantage should produce a continually increasing frequency of the new variant in all countries where
it has been observed. However, because the method is based on a hypothesis-testing framework, there is no way to
determine the strength of selection relative to the background strains. Likewise, the method could be misleading in a
context where the genetic background is rapidly changing (e.g., other strains under positive selection are introduced
into the population during the study period). We believe that a regression-based approach is, nevertheless, very useful
for rapidly evaluating evidence of selection potentially in large-scale molecular surveillance pipelines.
The population genetic model is more mechanistically explicit than the regression approach and, therefore,
gives a direct estimate of the selection effect. The model also allowed us to integrate a simple migration process and
to jointly estimate the parameters of selection and migration. The population genetic model is also simple enough
that it was coded in a popular statistical language and fit to the global data in a matter of hours on a standard laptop

16

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

computer. Its framework to estimate country-level selection effects shaped by an overall global distribution makes it
potentially quite useful for general molecular surveillance purposes. However the primary weakness of the population
genetic model is that it does not account for random fluctuations in the underlying populations, which, given that the
point of estimating selection effects in near real-time is to give warning before the new variant becomes widespread,
is potentially a problem.
The stochastic mechanistic model solves this problem by explicitly modeling stochastic effects that could
produce changes in variant frequency by chance alone, in addition to selection and migration. Our approach takes this
idea one step further by allowing noise above what would be expected in a typical homogeneous stochastic model; our
logic behind this choice is that the epidemiological model assumes homogeneous mixing at the state level, which we
know to be unrealistic. In reality, transmission is occurring at much smaller local scales that can lead to sudden jumps
in both the number of cases and number of observed variants; allowing for extra noise in the stochastic model makes
the method less sensitive to mis-specifications such as an over-simplified population structure. Despite being more
complex and using additional data, we found that the mechanistic model was in agreement with the population genetic
model, suggesting that the population genetic model is a reasonable balance between computability and accuracy.
All of our models (and most of the other published models) make the assumption that genomes are selected
at random from the set of all possible cases. If, for example, samples were sequenced specifically because they were
in contact with someone that was known to be infected by the variant under study, the data may be biased toward
over-estimating the spread and hence selective advantage of the new variant. There is almost certainly some bias from
the non-random processes by which samples are obtained and sequenced; however, we believe that our results are still
overall valid for three reasons. First, it is unlikely that the same level of bias from non-random sampling would occur
in each country to produce a similar pattern in each country; that is, countries represent semi-independent systems.
Second, the evidence for selection effects includes parts of the time series before people were concerned about the
spread of new variants, and, therefore, were unlikely to preferentially sequence the new variants. Third, the UK has
put effort into developing a representative sample of SARS-CoV-2 genomes in their country and the estimates for the
selection effects in the UK for D614G and B.1.1.7 are very close and slightly above the population average for these
lineages.
Several studies using other methods have similarly found D614G and B.1.1.7 to each have a selective advantage
over other variants circulating contemporaneously [10, 19, 3, 12, 2]. In contrast, however, van Dorp et al. [35] found
no support for a selective advantage of any of the variants they tested, including D614G. We suspect this is because
their statistical test required the repeated emergence of a variant in order to draw any power. Although phylogenetic
replication is an appropriate requirement in many situations, it is too conservative for identifying variants of concern
on the timescale at which they emerge. Instead, to test for a selective advantage of variants that have arisen only once,
power can be obtained from fitting explicitly epidemiological models within one location (e.g., our stochastic model,
and others [19, 3, 12, 2]) or looking for consistent effects in multiple locations with largely-distinct conditions (e.g.,
our isotonic regression and population genetic models, and Korber et al. [10]).
A central question in any modelling endeavor is how much detail is required to accurately address the problem

17

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

in question. In the last year, a large number of models have been developed to study various aspects of the SARSCoV-2 pandemic, ranging from very simple [25] to extremely detailed [12]. For the purpose of estimating selective
advantages of variants, we argued that (relatively) simple models are sufficient. With our most complex model, we
took a pragmatic approach and incorporated an additional noise term that can account for some of the unavoidable
model misspecification. Such a noise term could potentially also be included in methods that allow for more efficient
Bayesian inference with stochastic models [36].
The emergence of new variants with increased contagiousness or resistance mutations has the potential for
significant implications for control of COVID-19 especially given that very few countries have been able to use NPIs
alone to bring the viral growth rate sub-critical for extended periods of time. Integrating modeling into surveillance
systems will help facilitate early-warning systems and improve our ability to design both pharmaceutical and nonpharmaceutical interventions that can stop the spread of COVID-19.

Acknowledgements
Portions of this work were done under the auspices of the U.S. Department of Energy under contract
89233218CNA000001 and supported by National Institutes of Health (www.nih.gov) grants P01-AI131365,
R01-OD011095, and R01-AI028433 (CHvD). RK, NH, and ERS were funded by the US National Science Foundation
RAPID grant PHY-2031756.

Literature Cited
[1] Tegally, H. et al. Emergence and rapid spread of a new severe acute respiratory syndrome-related coronavirus 2
(SARS-CoV-2) lineage with multiple spike mutations in South Africa. medRxiv (2020).
[2] Volz, E. et al. Transmission of SARS-CoV-2 lineage B.1.1.7 in England: Insights from linking epidemiological
and genetic data. medRxiv (2021).
[3] Volz, E. et al. Evaluating the Effects of SARS-CoV-2 Spike Mutation D614G on Transmissibility and Pathogenicity. Cell 184, 64–75 (2021).
[4] Dearlove, B. et al. A SARS-CoV-2 vaccine candidate would likely match all currently circulating variants.
Proceedings of the National Academy of Sciences 117, 23652–23662 (2020).
[5] Fontanet, A. et al. SARS-CoV-2 variants and ending the COVID-19 pandemic. Lancet (2021).
[6] McCarthy, K. R. et al. Recurrent deletions in the SARS-CoV-2 spike glycoprotein drive antibody escape. Science
(2021).
[7] Wibmer, C. K. et al. SARS-CoV-2 501Y.V2 escapes neutralization by South African COVID-19 donor plasma.
bioRxiv (2021).
[8] Weisblum, Y. et al. Escape from neutralizing antibodies by SARS-CoV-2 spike protein variants. eLife 9, e61312
(2020).
[9] Grubaugh, N. D. et al. Tracking virus outbreaks in the twenty-first century. Nat Microbiol 4, 10–19 (2019).
[10] Korber, B. et al. Tracking Changes in SARS-CoV-2 Spike: Evidence that D614G Increases Infectivity of the

18

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

COVID-19 Virus. Cell 182, 812–827 (2020).
[11] Yurkovetskiy, L. et al. Structural and Functional Analysis of the D614G SARS-CoV-2 Spike Protein Variant.
Cell 183, 739–751 (2020).
[12] Davies, N. G. et al. Estimated transmissibility and impact of SARS-CoV-2 lineage B.1.1.7 in England. Science
(2021).
[13] Davies, N. G. et al. Increased mortality in community-tested cases of SARS-CoV-2 lineage B.1.1.7. Nature
(2021).
[14] Dong, E., Du, H. & Gardner, L. An interactive web-based dashboard to track COVID-19 in real time. The Lancet
Infectious Diseases 20, 533–534 (2020).
[15] COVID-19 Viral Genome Analysis Pipeline. https://cov.lanl.gov (2020).
[16] Elbe, S. & Buckland-Merrett, G. Data, disease and diplomacy: GISAID’s innovative contribution to global
health. Glob Chall 1, 33–46 (2017).
[17] Global Initiative on Sharing All Influenza Data. http://www.gisaid.org/ (2008).
[18] Liao, X. & Meyer, M. C. cgam: An r package for the constrained generalized additive model. Journal of
Statistical Software, Articles 89, 1–24 (2019).
[19] Chen, C. et al. Quantification of the spread of SARS-CoV-2 variant B.1.1.7 in Switzerland. medRxiv (2021).
[20] Ali, S. T. et al. Serial interval of SARS-CoV-2 was shortened over time by nonpharmaceutical interventions.
Science 369, 1106–1109 (2020).
[21] Carpenter, B. et al. Stan: A probabilistic programming language. J. Stat. Softw. 76, 1–32 (2017).
[22] Rozhnova, G. et al. Model-based evaluation of school- and non-school-related measures to control the COVID-19
pandemic. Nature Communications 12, 1614 (2021).
[23] Ward, H. et al. Antibody prevalence for SARS-CoV-2 following the peak of the pandemic in england: REACT2
study in 100,000 adults. medRxiv (2020).
[24] Vos, E. R. A. et al. Nationwide seroprevalence of SARS-CoV-2 and identification of risk factors in the general
population of the Netherlands during the first epidemic wave. J Epidemiol Community Health (2020).
[25] Sanche, S. et al. High Contagiousness and Rapid Spread of Severe Acute Respiratory Syndrome Coronavirus 2.
Emerg Infect Dis 26, 1470–1477 (2020).
[26] Zhou, F. et al. Clinical course and risk factors for mortality of adult inpatients with COVID-19 in Wuhan, China:
a retrospective cohort study. Lancet 395, 1054–1062 (2020).
[27] Ali, S. T. et al. Serial interval of SARS-CoV-2 was shortened over time by nonpharmaceutical interventions.
Science 369, 1106–1109 (2020).
[28] Lavezzo, E. et al. Suppression of a SARS-CoV-2 outbreak in the Italian municipality of Vo’. Nature 584,
425–429 (2020).
[29] Wu, J. T. et al. Estimating clinical severity of COVID-19 from the transmission dynamics in Wuhan, China. Nat
Med 26, 506–510 (2020).

19

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

[30] Verity, R. et al. Estimates of the severity of coronavirus disease 2019: a model-based analysis. Lancet Infect Dis
20, 669–677 (2020).
[31] Grasselli, G. et al. Baseline Characteristics and Outcomes of 1591 Patients Infected With SARS-CoV-2 Admitted
to ICUs of the Lombardy Region, Italy. JAMA 323, 1574–1581 (2020).
[32] Ionides, E. L., Nguyen, D., Atchadé, Y., Stoev, S. & King, A. A. Inference for dynamic and latent variable
models via iterated, perturbed Bayes maps. Proceedings of the National Academy of Sciences 112, 719–724
(2015).
[33] van Kampen, N. G. Stochastic processes in physics and chemistry. Elsevier, Amsterdam, 3rd edition (2007).
[34] Hale, T., Webster, S., Petherick, A., Phillips, T. & Kira, B. Oxford COVID-19 Government Response Tracker
(2020).
[35] van Dorp, L. et al. No evidence for increased transmissibility from recurrent mutations in SARS-CoV-2. Nature
Communications 11, 5986 (2020).
[36] Fintzi, J. et al. Using multiple data streams to estimate and forecast SARS-CoV-2 transmission dynamics, with
application to the virus spread in Orange County, California (2020).
[37] Mumford, D., Series, C. & Wright, D. Indra’s Pearls: The Vision of Felix Klein. Cambridge University Press
(2002).
[38] Douc, R. & Cappe, O. Comparison of resampling schemes for particle filtering. In ISPA 2005. Proceedings of
the 4th International Symposium on Image and Signal Processing and Analysis, 2005., 64–69 (2005).

20

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Appendix A: Population genetics model
Variant frequencies over time
Here we derive the equation for the mutant frequency pn as a function of the generation n under the population genetics
model with both selection and migration (Eq 4). In the main text, we derived that the new variant’s frequency p0 in the
next generation is
(1 + s)p + (1 − p)m
.
1 + sp

p0 =

(A-1)

We can write this slightly differently as a Möbius transformation of p:


1
+
s
−
m
m
(1
+
s
−
m)p
+
m
 · p.
p0 =
≡
sp + 1
s
1

(A-2)

In general a Möbius transformation has the form



a
c

b



 · x ≡ ax + b ,
cx + d
d

(A-3)

and it has the nice property that A · (B · x) = (AB) · x for two matrices A and B (see e.g., [37]). Hence, in order to find
the variant frequency in the n-th generation, we need the n-th matrix power of

M=

1+s−m m
s

1


.

(A-4)

For this we have to diagonalize M. The eigenvalues of M are equal to 1 + s and 1 − m. Then eigenvectors are given by
(1, 1)T and (m, −s)T . Hence, we can write M = UΛU −1 where

U =

1

m

1 −s







and Λ = 

1+s

0

0

1−m


.

(A-5)

Then M n · p0 = UΛnU −1 · p0 , which is equal to
pn =

[s(1 + s)n + m(1 − m)n ]p0 + m[(1 + s)n − (1 − m)n ]
.
s[(1 + s)n − (1 − m)n ]p0 + [m(1 + s)n + s(1 − m)n ]

(A-6)

Transformation to the logit scale
To avoid numerical issues during inference, we transform the mutant frequency to the logit-scale, and re-parameterize

1 0 . Then
the model. Let R = −1
1
logit(x) = log(R · x).

21

(A-7)

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

Let r0 = R · p0 and rn = R · pn . Then
rn = (RUΛnU −1 R−1 ) · r0 ,
and we have RU =



1
m
0 −(m+s)

(A-8)


. Hence,


(1 + s)n
RUΛn (RU)−1 = 
0

and therefore

rn =

1+s
1−m

n

m
m+s

m
r0 +
m+s


[(1 + s)n − (1 − m)n ]

(1 − m)n



1+s
1−m

n


−1 .

(A-9)

(A-10)

This equation has a removable singularity at s = −m. To see this, we write
m
m+s
Now we define σ =

1+s
1−m



1+s
1−m

n


−1 =

m
1−m


1+s n
−1
1−m
1+s
1−m − 1

=



m n−1 1 + s k
∑ 1−m .
1 − m k=0

(A-11)

and µ = m/(1 − m). Then we get the following re-parameterized model:
rn = σ n r0 + µ

1−σn
.
1−σ

(A-12)

Appendix B: Stochastic epidemiological model
Time-dependent infection rate
To model the effects of government restrictions such as lock-downs, the infection rate β is a (smoothed) piece-wise
constant function of time. We allow for n ∈ {3, 4} epidemic stages to model e.g. unrestricted spread, lockdown, and
relaxation of the lockdown [22]. We let β vary smoothly between the epidemic stages, thereby allowing for an uptake
period for (release of) restrictions. More precisely, β = β (t) is defined as
β (t) = β0 (1 − Hυ (t − t1 ))
n−2

+ ∑ βi · Hυ (t − ti ) (1 − Hυ (t − ti+1 ))

(B-1)

i=1

+ βn−1 · Hυ (t − tn−1 )
where Hυ is a smoothed Heaviside function defined by Hυ (t) = (1 + exp(−t/υ))−1 , with parameter υ determining
the duration of the transition period between different epidemic stages. The time-varying infection rate β is illustrated
in Fig. S7A. To determine the parameter υ, we require that Hυ (∆t/2) = 95%, where ∆t is the length of the uptake
period. Solving for υ, we find υ = ∆t/(2 · logit(0.95)). We set ∆t = 7 days, hence the uptake period takes a week.
In the case of variant B.1.1.7 in the Netherlands, we added an external force of infection, λwt and λmt for wildtype and mutant respectively, to account for contacts with infectious individuals from the UK. Because the number of
infected individuals the UK varied over time, the external infection forces of infection λwt and λmt depend on time as
22

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

follows
λwt (t) = λ0 E[Iwt (t)/N(t)] ,

λmt (t) = λ0 E[Imt (t)/N(t)] .

(B-2)

Here, the trajectories Iwt (t)/N(t) and Imt (t)/N(t) correspond to the fraction of individuals in the UK that are infected
with wild-type and mutant respectively. The expectation is taken over the filtered trajectories that were reconstructed
with the SMC algorithm. Finally, the scaling parameter λ0 represents the product of the contact rate between individuals in the two countries, and the probability of infection per contact. When we fit the model to the Dutch data, the
parameter λ0 is estimated, but the fraction of infectious UK citizens is assumed known.
Initial condition
To complete the description of the dynamic model, we have to specify the initial conditions. Let ζ and ξ denote
the fractions of infected and removed individuals at time t0 , respectively. To determine the correct balance between
exposed, infectious, and severely infected individuals, we compute the eigenvalues of the Jacobian matrix of the infinite
population limit of the MJP model. The linearized system without the S and R compartments around the disease-free
steady state with S = (1 − ξ )N and R = ξ N equals


E





−α

 
d
 

 I = α
dt 
 
0
H

β (1 − ξ )
−γ − ν
ν

0



E









I 
0


H
−ω

(B-3)

We use the eigenvector X0 = (E0 , I0 , H0 )T with ∑3i=1 X0i = ζ N corresponding to the dominant eigenvalue of the Jacobian
matrix in Eq. (B-3) to define the initial condition of the model. The parameter p0 determines the initial fraction of
infections with the mutant virus, and hence we have Emt,0 = p0 E0 , Imt,0 = p0 I0 , Ewt,0 = (1 − p0 )E0 , and Iwt,0 =
(1 − p0 )I0 . We then set S0 = (1 − ξ − ζ )N and R0 = ξ N. Finally, the initial state of the stochastic model is randomized
by sampling from a Poisson distribution with mean equal to the deterministic initial value.
Hybrid model simulation
Because for small population sizes the diffusion approximation defined by the system of SDEs in Eq. (9) breaks down,
as it e.g., does not allow for fixation of the mutant, we model small population sizes discretely using an adaptive
tau-leap approximation of the Markov jump process (Eq. (5)). Hence, we implemented a hybrid algorithm in which
variables can switch between a discrete and continuous type.
At any particular time t, the system consists of continuous components X i for i ∈ C (t) and discrete elements
X i for i ∈ D(t) = {1, . . . , n} \ C (t). Since for i ∈ C (t), the continuous element X i (t) is generally non-constant, the
transition rates η j (X,t) will in general be time dependent. This means that we have to integrate the following system

23

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

of SDEs and ODEs
k

dX i =

k

∑ ε ij η j (X,t)dt + ∑ ε ij

j=1

q
η j (X,t)dBtj + τ X i dBeti ,

i ∈ C (t)

j=1

dH j
= η j (X,t) ,
dt

(B-4)

j ∈ E (t) ≡ { j ∈ {1, . . . , k} : ∃i ∈ D(t) :

ε ij

6= 0}

Hence, we have to keep track of those transition rates η j for which the increment ε ij is non-zero for a discrete comi and H (t ) = 0. We then
ponent X i . The initial conditions for the hybrid system Eq B-4 are given by X i (tm ) = xm
j m

integrate the system until time tm+1 = tm + hm . At this point, we sample the number of stochastic events Ym that
occurred in the time interval (tm ,tm+1 ], from the Poisson distribution

Ym ∼ Poisson ∑ j∈E (tm ) H j (tm+1 )

(B-5)

Thereafter, Ym events with index j are sampled from the categorical distribution, with probability proportional to the
cumulative transition rate H j (tm+1 ). The increments ε j are then added to the discrete part of the state X
X j (tm+1 ) 7→ X j (tm+1 ) + εij ,

i ∈ D(tm )

(B-6)

After applying these Ym discrete transitions, we have to re-evaluate which components of the state are discrete and
which are continuous. We choose a fixed threshold T = 50 below and above the populations are discrete and continuous, respectively. Hence, at time tm+1 we update the partition of {1, . . . , n} as follows
D(tm+1 ) = {i : X i < T } ,

C (tm+1 ) = {i : X i ≥ T }

(B-7)

Finally, we set the next initial condition xm+1 = X(tm+1 ) and H(tm+1 ) = 0 and repeat the process.
The tau-leap step size hm is chosen adaptively such that the expected number of events E[Ym ] within each τ-leap
interval (tm ,tm+1 ] is approximately equal to 1. To accomplish this, we choose
n
−1 o
hm = min hmax , ∑ j∈E (tm ) η j (X(tm ),tm )

(B-8)

where hmax = 1d. Between jumps, the hybrid system (Eq B-4) is integrated using the Euler-Mayurama method with a
step size of min{0.01, hm }.
Sequential Monte-Carlo
The method used for inference is described in full detail and generality elsewhere [32]. Here we give a brief description
highlighting some of the choices made for this particular model and data set.
In order to reconstruct the latent epidemic trajectories X, given the observed data O, consisting of death incidence data D and genetic data F mt and F, we use sequential Monte-Carlo (SMC). We simulate J = 104 replicates
of the model (particles) forward in time from one observation time (ti−1 ) to the next (ti ), each with different initial
24

medRxiv preprint doi: https://doi.org/10.1101/2021.03.29.21254233; this version posted April 1, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .

conditions X j (ti−1 ). Given each of the J predicted states X j (ti ) of the model at time ti , we calculate the likelihood
w j = L(Oi |X j (ti ), θ ). We then sample with replacement J particles with probability proportional to the weight w j
using a systematic resampling method [38]. The re-sampled particles are used as initial condition at time ti , and we
repeat the above steps until we reach the final observation.
The Monte-Carlo estimate of the conditional likelihood of observation Oi |Oi−1 , is given by the average of the
weights
L(Oi |Oi−1 , θ ) =

1
J

J

∑ L(Oi |X j (ti ), θ )

(B-9)

j=1

where we write L(O1 |O0 , θ ) ≡ L(O1 |θ ). The total likelihood of the time series given θ is equal to
N

L(O1 , . . . , ON |θ ) = ∏ L(Oi |Oi−1 , θ )

(B-10)

i=1

All likelihood computations are done on the log-scale to minimize floating-point errors.
To estimate parameters, we extended the state X with the parameter vector θ , allowing the parameters to be perturbed after each observation time. For the j-th particle, we now have a state (X j , θ j ), and weight w j = L(Oi |X j (ti ), θ j ).
The extended-SMC algorithm is then iterated M = 200 times, and after each iteration m the magnitude of the parameter
perturbations is reduced. The perturbations are Gaussian θ j 7→ θ j + am ε, with ε ∼ N (0, Σ). Here, Σ is a diagonal matrix with diagonal elements given in Table S1. For bounded parameters, the perturbations are reflected in the boundary
√
M
of the domain. The ratio a ∈ (0, 1) reduces the magnitude of the parameter perturbations. We choose a = 10−2 such
that after M iterations the magnitude of the perturbations is reduced by 99%. After each iteration of the extended-SMC
algorithm, for each particle we reset the state X j to the a randomly sampled initial state of the epidemic model, while
θ j is inherited from the previous extended-SMC iteration. To speed-up the computations, we implemented the model
and SMC algorithm in C++ and used multi-threading to update particles between observations in parallel.

25

