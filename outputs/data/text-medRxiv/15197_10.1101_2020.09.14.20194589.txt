medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
1

1

Improved estimation of time-varying reproduction numbers at
low case incidence and between epidemic waves

2

Kris V Parag†, 1

3

4
5

6

1

MRC Centre for Global Infectious Disease Analysis, Imperial College London, London, W2 1PG, UK
†

Email: k.parag@imperial.ac.uk

Abstract

7

We construct a recursive Bayesian smoother, termed EpiFilter, for estimating the effective reproduction number,

8

R, from the incidence of an infectious disease in real time and retrospectively. Our approach borrows from Kalman

9

filtering theory, is quick and easy to compute, generalisable, deterministic and unlike many current methods, requires

10

no change-point or window size assumptions. We model R as a flexible, hidden Markov state process and exactly

11

solve forward-backward algorithms, to derive R estimates that incorporate all available incidence information. This

12

unifies and extends two popular methods, EpiEstim, which considers past incidence, and the Wallinga-Teunis method,

13

which looks forward in time. We find that this combination of maximising information and minimising assumptions

14

significantly reduces the bias and variance of R estimates. Moreover, these properties make EpiFilter more statistically

15

robust in periods of low incidence, where existing methods can become destabilised. As a result, EpiFilter offers

16

improved inference of time-varying transmission patterns that are especially advantageous for assessing the risk of

17

second waves of infection in real time and at various spatial scales.

18

19

Key-words: Bayesian filters, reproduction numbers, epidemic models, COVID-19, infectious diseases.
I NTRODUCTION

20

During an unfolding epidemic, one of the most commonly available and useful types of surveillance data is the

21

daily (or weekly) number of newly reported cases. This time-series of case counts, also known as the incidence

22

curve, not only measures the epidemic size and burden, but also provides information about trends or changes in

23

its transmissibility [1], [2]. These trends are captured by the time-varying effective or instantaneous reproduction

24

number, denoted Rs at time s, which defines how the number of secondary cases generated per primary case varies

25

across the outbreak [3]. Broadly, when Rs > 1 we can expect and prepare for growing incidence, whereas sustained

26

Rs < 1 signifies that the epidemic is waning and likely to enter a more controlled phase [4].

27

Inferring changes in Rs given an observed incidence curve is therefore crucial, both to understanding trans-

28

missibility and to forecasting upcoming case loads, especially for an ongoing epidemic, where it can help inform
NOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice.

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
2

29

policymaking and intervention choices or predict healthcare demands [1], [5]. Real-time and retrospective Rs

30

estimates have been used to characterise rates and patterns of spread in various diseases such as malaria [6]

31

and Ebola virus disease [7]. Such estimates have proven valuable throughout the COVID-19 pandemic, providing

32

updating synopses of global transmission [8] and evidencing the impact of past control actions (e.g. lockdowns and

33

social distancing) [9] or the likelihood of a resurgence in infections when those controls are relaxed [10].

34

Most studies that infer Rs or related quantities either apply the Wallinga-Teunis (WT) method [2] or the Cori et

35

al method, known as EpiEstim [11]. Both methods take complementary viewpoints on how incidence data inform

36

on transmissibility and hence have diverse use-cases. The WT method reconstructs the average number of new cases

37

caused by infectious individuals at s and so requires incidence data beyond time s for its estimate. It computes

38

the case or cohort reproduction number, Rsc , which is a function of Rs+j for future times j ≥ 0, and is suited

39

for retrospective analyses [12]. Alternatively, EpiEstim infers how past infections propagate to form the incidence

40

observed at s, only requiring data prior to time s. EpiEstim directly computes instantaneous reproduction numbers,

41

Rs , and is preferred for real-time investigations [3].

42

While both methods provide useful and important estimators of transmission, they are not perfect. Two main

43

limitations exist. First, each suffers from data censoring or edge-effects [3]. Because the WT method is forward-

44

looking i.e., depends on data later than s, its estimates are right censored when s is close to the last observed time

45

point [12]. In contrast, EpiEstim looks backward in time and suffers edge-effects when s is near the first observed

46

time point [11]. Estimates in the vicinity of the start and end of the incidence time-series are therefore unreliable

47

under EpiEstim and the WT method, respectively. Techniques have been proposed to limit this unreliability [5],

48

[13], but the problem is intrinsic, and inevitable near the actual start and end times of an epidemic, where there is

49

necessarily no or sparse data.

50

This leads into the second key limitation: inference in periods of small incidence. This presents a fundamental

51

challenge for any Rs estimation approach and effectively creates additional edge-effects. When few or no case

52

counts are available to constrain inference, methods are largely driven by their inherent prior distributions and

53

assumptions. This can result in misleading or unreliable estimates and mask subcritical (i.e., Rs < 1) transmission

54

patterns [11], [15]. Small incidence may occur during sustained periods of interventions, when pathogens invade

55

new susceptible regions and also naturally arise by division when analyses are performed at smaller spatial scales

56

(e.g., regional or community levels). Understanding how to best mediate the trade-off between prior assumptions

57

and data when incidence is small is of both statistical and epidemiological significance.

58

Following a period of low incidence, two important outcomes are possible: either the epidemic continues to

59

exhibit small or zero case counts until it goes extinct, or a resurgence in infections, also termed a second wave,

60

occurs. Inferring, in real time, which of these conditions is likely presents a key challenge for infectious disease

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
3

Incidence (y-axes) - counts from I1 to It

Ways of inferring instantaneous reproduction numbers
Smoothing
Reverse- ltering
Filtering

s
ℙ(Rs | Is−k+1
)

0

Window size: k

State space model

Observation model

ℙ(Rs | Rs−1, I1s−1)

ℙ(Is | Rs, I1s−1)

ℙ(Rt | I1t )

Markov diffusion

Renewal process

Iab

Is

ℙ(R1 | I1)

Epidemic model (generalisable)

= {Ia, Ia+1, . . . Ib}

It

Set grid Rs ∈ ℛ and initialise p1

Data used

EpiFilter algorithm (MSE optimal)

EpiEstim

ps = ℙ(Rs | I1s)

rs = ℙ(Rs | Ist )

ℙ(Rt | It )

ℙ(R1 | I1t )

ℙ(Rs | Iss+k−1) q = p , q = r
t
t 1
1

qs = ℙ(Rs | I1t )

ℙ(Rt | I1t )

ℙ(R1 | I1t )
EpiFilter
1

s

Predict step: use state model and ps−1
Gives prediction: ps = ℙ(Rs | I1s−1)

WT
method

I1

Forward pass (compute ps):

Time (x-axes) - for 1 ≤ s ≤ t days

t

Correct step: use observation model
Updates to: ps ∝ ℙ(Is | Rs, I1s−1) ps
Backward pass (compute qs):

Use qt = pt and state model to form F

qs = F (qs+1, ps, ps+1, ℙ(Rs+1 | Rs, I1s))
⟹ qs ≈ ∝ ps rs ℙ(Rs)−1

Fig. 1: EpiFilter algorithm and relationship to other methods. In the left panels we consider three ways of
inferring the instantaneous or effective reproduction number at time s, Rs , from the incidence curve, I1t (blue dots).
The filtering solution produces the posterior distribution ps from all data prior to time s. EpiEstim approximates
this solution by using the subset of data in a window of size k into the past. Reverse-filtering considers the
complementary part of the incidence curve, leading to rs , which utilises data beyond s. The WT method, with
future window k , approximates this type of solution. Smoothing uses all information from I1t to generate qs , which
is precisely computed by EpiFilter. Blue windows show the portions of I1t that inform on Rs for each of ps , rs and
qs while red windows highlight the subsets used by EpiEstim and the WT method. Double arrows indicate data
used for constructing various posterior distributions, while square arrows pinpoint instances of those distributions
at the edges of I1t . In the right panels we summarise the construction of EpiFilter. We outline the main assumptions
(the model box) and computations (the algorithm box) necessary for realising EpiFilter, which allow us to obtain
the most informative (and minimum MSE) smoothing posterior distribution qs . See the main text for the specific
equations employed in our implementation [14].
fi

61

epidemiology given the information bottleneck at low incidence [16]. Better inference of transmission under these

62

conditions is currently considered central to designing data-informed COVID-19 intervention exit or relaxation

63

strategies [17]. With many countries facing multiple resurgent waves in this pandemic, estimating fluctuations in

64

transmission during suspected epidemic troughs could be essential to achieving sustained control [10].

65

Here we present and develop a novel method, termed EpiFilter, for reliably estimating Rs in real time, which

66

ameliorates the above limitations. We take an engineering inspired approach and construct an exact, recursive

67

and deterministic (i.e., EpiFilter produces the same output for fixed input data and requires no Monte Carlo

68

steps) inference algorithm that is quick and easy to compute both across an unfolding outbreak and in retrospect.

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
4

69

Our method solves what is called the smoothing problem in control engineering [14]. This means we compute

70

instantaneous reproduction number, Rs , estimates that formally integrate both forward and backward looking

71

information. This unifies the WT method and EpiEstim, and largely nullifies their edge-effect issues.

72

Further, EpiFilter only makes a minimal Markov assumption for Rs , which allows it to avoid the strong prior

73

window size and change-point assumptions that existing methods may apply to infer shifts in transmission [11], [9].

74

Using simulated and empirical data, we show that EpiFilter accurately tracks changes in Rs and provides reliable

75

one-step-ahead incidence predictions. Moreover, we find that EpiFilter is appreciably more robust and statistically

76

efficient than even optimised versions of EpiEstim [13]. Specifically, it does not easily destabilise when performing

77

real-time inference in periods of low incidence, such as in lulls between epidemic waves, and generally it minimises

78

the mean squared error of Rs estimates, while maintaining good coverage and predictive performance.

79

We illustrate the practical utility of EpiFilter on the COVID-19 incidence curve of New Zealand, which exhibits

80

a second wave that was seeded during a prolonged low incidence period, finding stark improvements in the

81

transmission patterns it uncovers. Our method, which is outlined in Fig. 1, provides a straightforward yet formally

82

optimal (in mean squared error sense [18]) solution to real-time and retrospective instantaneous reproduction number

83

estimation. Because it couples minimal prior assumptions with maximum information extraction, it more gracefully

84

handles periods with scarce data. Hopefully our approach will serve as a useful inference tool for investigating the

85

risk of resurgence in COVID-19 and other epidemics. Matlab and R implementations of EpiFilter are available at

86

https://github.com/kpzoo/EpiFilter and its mechanics are explored and validated in the Appendix.
M ETHODS

87

88

Renewal models and inference problems

89

We consider an infectious disease epidemic observed over some time period 1 ≤ s ≤ t in a homogeneous and

90

well-mixed population. While epidemics actually spread on dynamic networks involving stratified contact structures,

91

homogeneous models can provide useful real-time insight into key transmission patterns and are more easily fit and

92

verified with routine surveillance data such as incidence curves [19]. If the incidence or number of newly infected

93

cases at time s is Is then the set I1t = {I1 , I2 , . . . It } is the incidence curve of the epidemic. We assume that

94

incidence is available on a daily scale so that I1t is a vector of t daily counts but weeks or months could be used

95

instead. A common problem in infectious disease is the inference of the transmissibility of the epidemic given this

96

curve. The renewal model [1], [20] presents a general and popular framework for investigating this problem and

97

its estimates, in some instances, can even approximate those from detailed network models [21].
The renewal model posits that epidemic transmissibility, summarised by the effective or instantaneous reproduction
number, Rs , generates the observed incidence as in Eq. (1). We assume incidence counts are Poisson distributed

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
5
d

with Pois indicating Poisson noise. Here = signifies equality in distributions and | means ‘conditioned on’.
d

P(Is | Rs , I1s−1 ) = Pois(Λs Rs )
98

99

100

101

(1)

While Eq. (1) does not directly model how susceptible individuals become infected, these effects are encoded in
the reproduction number Rs , which measures the secondary cases generated per effective primary case at s [3].
P
The quantity Λs := s−1
u=1 Is−u wu , known as the total infectiousness, counts how many effective past cases are still
infectious at s i.e., it describes the number of circulating cases that can actively transmit.

102

The generation time distribution of the epidemic, w1s−1 = {w1 , w2 , . . . ws−1 }, controls how past incidence

103

influences Λs , with wu as the probability that a primary case takes between u−1 and u days to generate a secondary

104

case [1]. We make the standard assumption that w1∞ is well approximated by the serial interval distribution of the

105

epidemic of interest, which is known [11]. The serial interval is the time between symptom onset of a primary and its

106

secondary case. Onset times are more practically measurable than actual infection times. While this approximation

107

can limit inference (for example, serial intervals often have larger variances than generation times), methods are

108

being developed to improve its quality [22].

109

We focus on inferring the complete set of Rs values, denoted R1t = {R1 , R2 , . . . Rt }, given the incidence curve

110

I1t with t as the last recorded time. Estimating R1t is important because changes in the values of instantaneous

111

reproduction numbers often signify key transitions in epidemic transmissibility, which might be due to the imposition

112

or relaxation of interventions. Instantaneous reproduction numbers are also the basis of other transmissibility metrics,

113

such as cohort reproduction numbers or growth rates [3]. We define three main inference problems, based on how

114

information in I1t is recruited to construct every Rs estimate. We represent these problems in terms of the posterior

115

distribution their solutions induce over possible Rs values. Estimates are functions of these posteriors.

116

The first is called filtering, where we sequentially compute the filtering posterior ps = P(Rs | I1s ) for every s ≤ t

117

[23]. Filtering only uses incidence data up to time s, I1s , for inferring Rs . Solving this problem is fundamental to

118

real-time inference [24]. The second problem, which we call reverse-filtering, is the complement of the first. The

119

reverse-filtering posterior rs = P(Rs | Ist ), is important for retrospective or backward-looking estimates and infers

120

Rs from incidence beyond s i.e., Ist [25]. Filtering solutions are commonly employed for inferring instantaneous

121

122

123

reproduction numbers. Practical Rs calculations do not involve reverse-filtering. Instead, the information used by
P
rs is implicit to deriving cohort reproduction numbers, Rsc = t−s
j=0 Rs+j wj+1 [12]. Later we show that estimates
from EpiEstim and the WT method are related to the ps and rs distributions, respectively.

124

The last problem, which is termed smoothing, is our main interest. It asks the question: how can we construct

125

an Rs , at every s ≤ t, that integrates all available incidence information from I1t . To solve this problem we must

126

formulate the smoothing posterior distribution qs = P(Rs | I1t ) [14]. Functions of this posterior would then yield

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
6

127

maximally informed instantaneous reproduction number estimates (and cohort reproduction number estimates by

128

extension). Note that ps , rs and qs depend on the choices of state space model, which describes the dynamics of

129

Rs across time, and observation model, which explains how changes in Rs lead to trends in observed incidence data

130

[18]. These models encode our assumptions about the epidemic of interest and determine how estimates trade off

131

assumptions against data. We next explore how posterior distribution selection determines performance, especially

132

when data are scarce, and examine how EpiEstim and the WT methods fit within this framework.

133

Inference methods and low incidence

134

We mostly detail EpiEstim as instantaneous reproduction number, Rs , estimates are the main focus of this

135

work. EpiEstim assumes that the estimate of Rs at time s depends on a rolling past window of data, τ (s) =

136

s
{s, s − 1, . . . , s − k + 1}, of size k [11]. Consequently, at time s, only size k subsets of the incidence, Is−k+1
,

137

138

and total infectiousness, Λss−k+1 = {Λs , Λs−1 , . . . Λs−k+1 }, are considered informative about Rs . Their sums over
P
P
this window are iτ (s) = u∈τ (s) Iu and λτ (s) = u∈τ (s) Λu . When k = 1, EpiEstim only uses the most recent

139

case count, Is , (and Λs ) to estimate Rs . While this maximises flexibility, it usually results in over-fitting and so

140

larger windows are often employed to trade off estimate variance with bias [11], [26].
EpiEstim therefore effectively solves a filtering problem, as discussed in the previous section. The filtering
posterior distribution produced by EpiEstim is restricted to the informative window τ (s) and denoted pτ (s) =
s
P(Rs | Is−k+1
). This is parametrised by the shape-scale gamma posterior distribution in Eq. (2).
d

pτ (s) = Gam(a + iτ (s) , (c + λτ (s) )−1 )

(2)
d

141

The posterior pτ (s) results from combining a gamma prior distribution on Rs , P(Rs ) = Gam(a, c−1 ), with a

142

Poisson observation likelihood for the incidence (see Eq. (1)), as detailed in [11], [13]. We never explicitly include

143

s
Λs terms in our notation (e.g., we could write pτ (s) as P(Rs | Is−k+1
, Λss−k+1 )) since they appear naturally when

144

145

146

147

148

using Eq. (1) and the key difference among our inference problems relate to Is terms.
R
s
The posterior mean estimate from Eq. (2) is constructed as R̃τ (s) = pτ (s) Rs dRs = E[Rs | Is−k+1
] = (a +
iτ (s) )(c + λτ (s) )−1 . The variance around this estimate is (a + iτ (s) )(c + λτ (s) )−2 . The observation model is given by

Eq. (1) but the state space model of EpiEstim is not explicit. However, if Rτ (s) is the assumed average reproduction
P
number in τ (s) (which is used to estimate Rs ) then λτ (s) Rτ (s) = u∈τ (s) Λu Ru [13]. Thus, EpiEstim somewhat

149

incorporates a linear moving average state space model, and assumes that the filtering distribution ps ≈ pτ (s) by

150

deeming data outside τ (s), I1s−k , as effectively uninformative [12]. Since pτ (s) can be computed sequentially across

151

an ongoing epidemic, EpiEstim provides real-time inference.

152

The WT method takes a complementary approach to EpiEstim, computing transmissibility over a forward-looking

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
7

153

154

155

window γ(s) = {s, s + 1, . . . , s + k − 1} [2]. Often k = t − s + 1 i.e., the window extends to the last observed
incidence. The WT method uses the observation model of Eq. (1) and has an implicit moving average state
P
model Rγ(s) = u∈γ(s) Ru wu−s+1 , which leads to its cohort reproduction number estimates [3]. As this method

156

effectively uses future information [12], it implicitly involves approximating the reverse-filtering distribution (see

157

previous section) as rs ≈ rγ(s) = P(Rs | Iss+k−1 ). We illustrate the information windows employed by the WT

158

method and EpiEstim, as well as the complete filtering and reverse-filtering windows in Fig. 1. The goodness of

159

the windowed distributions pτ (s) and rγ(s) as approximations to the general posterior distributions ps and rs will

160

depend on k and the appropriateness of the state model underlying each method [13].

161

While EpiEstim and the WT methods are powerful tools for inferring transmissibility in real-time and in retrospect,

162

they have two main and related limitations, which necessarily reduce the reliability of their outputs [12]. First, their

163

performance degrades as s gets close to 1 for EpiEstim and t for the WT method [11]. These edge or censoring

164

effects correspond, at the extreme, to p1 = pτ (1) = P(R1 | I1 ) and rt = rγ(t) = P(Rt | It ), which are weakly

165

informed posterior distributions. As a result, at the beginning of the incidence curve EpiEstim can be unreliable

166

(and even unidentifiable). The WT method suffers similarly at the end of that curve [1] (see Fig. 1).

167

The second limitation occurs in phases of the epidemic where incidence is low for a prolonged period of time

168

[26], [17]. In these periods data are sparse and the quality of estimates depend on how well the method of choice

169

mediates between the little available information and its inherent assumptions [15]. We illustrate this with EpiEstim,

170

using the mean and variance of the posterior estimate from Eq. (2), R̃τ (s) , which are defined above. If incidence

171

is small over the window τ (s) then the sum of incidence, iτ (s) , and the total infectiousness λτ (s) shrink, meaning

172

that the prior hyperparameters, a and c, strongly influence the resulting estimate mean and variance. This contrasts

173

the data-rich scenario when an epidemic is large, where iτ (s) and λτ (s) overpower a and c.

174

Further, should a sequence of n ≥ k zero-incidence days occur, then iτ (s) = 0 and λτ (s) → 0 as n increases,

175

with a rate controlled by the serial interval of the epidemic. Here the shape parameter of pτ (s) is exactly that of

176

the prior distribution P(Rs ). As λτ (s) decays, pτ (s) → P(Rs ) (see Eq. (2)), Rs becomes statistically unidentifiable

177

from the window of data and inference is completely prior driven [27], [26]. While lack of data is a fundamental

178

limitation, the point at which we lose inferential power is not fixed, and depends on the window size, k . Studies that

179

formally optimised k for estimate reliability, found that small k is needed to infer sharp changes in transmissibility

180

(e.g. due to lockdowns) [13], indicating that these issues can be acute. Analogous effects occur in the WT method

181

if there are few incident cases across its forward-looking window γ(s) [12].

182

These prior-driven scenarios are realistic for epidemics in waning or tail phases, and can precede either elimination

183

(i.e., epidemic extinction) or resurgence [28]. While some estimate degradation is guaranteed for any Rs inference

184

method when faced with either edge-effects or low incidence, robustness can still be improved. Edge-effects can be

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
8

185

largely overcome by constructing the smoothed posterior distribution for estimating the instantaneous reproduction

186

number Rs , denoted qs . Solving the smoothing problem melds the advantages of the opposite looking windows

187

of EpiEstim and the WT method, removing the vulnerability near the ends of the incidence curve I1t . This follows

188

as q1 = r1 and qt = pt (see Fig. 1). Further, by maximising the information used for inferring every Rs and

189

by minimising our state model assumptions, we can ameliorate the impact of low incidence. We next develop a

190

method, termed EpiFilter, to realise these improvements.

191

Bayesian (forward) recursive filtering

192

We reformulate the inference problem of estimating instantaneous reproduction numbers Rs from past incidence

193

I1s as an optimal Markov state filtering problem. Filtering describes a general class of engineering problems aimed

194

at optimally, usually in a mean squared error (MSE) sense, inferring some hidden state in real time from noisy

195

observations [18], [14]. Given some functions fs and gs , which describe the state (Rs in our case) space dynamics

196

and the process of generating noisy observations (the Is here), the filtering problem tries to construct the posterior

197

distribution ps (see previous section) [23], which EpiEstim approximates. The conditional mean estimate R̃s =

198

E[Rs | I1s ] leads to the minimum MSE of E[(Rs − R̃s )2 ] [23], which depends on all the past information.
The famed Kalman filter [24] was the genesis of these methods. Here we focus on Bayesian recursive filters for
models with noisy count observations. These generalise the Kalman filter [23] and have been successfully applied
to similar problems in phylodynamics and computational biology [29], [30], [31]. We reconsider our renewal model
inference problem within this engineering state-observation framework, as described in Eq. (3) [14].
Rs = fs (Rs−1 , s−1 ),

Is = gs (Rs , νs )

(3)

199

Here Rs is the hidden Markov state that we wish to infer. It dynamically depends on the previous state Rs−1 and

200

a noise term s−1 via fs . Observation Is is then elicited due to Rs and a noise term νs , according to gs [32].
We develop our filter under two very mild assumptions. First, we define some closed space, R, over which
Rs is valid. For a given resolution m, extrema Rmin and Rmax , and grid size δ = m−1 (Rmax − Rmin ) then
R := {Rmin , Rmin + δ, . . . , Rmax }. This means the instantaneous reproduction number Rs must take a discrete

value in R, the ith element of which is denoted R[i]. We formalise this notion in Eq. (4a).
Pm

= R[i]) = 1, 1 ≤ s ≤ t
p
Rs = Rs−1 + (η Rs−1 ) s−1

i=1 P(Rs

(4a)
(4b)

201

This is not restrictive since we can compute our filter for large m if needed and usually we are only interested

202

in Rs on a coarse scale (e.g., policymakers may only want to know if Rs ≤ 1 or not). Other approaches, which

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
9

203

depend on MCMC or related sampling methods (e.g., [9] and some implementations of EpiEstim), all implicitly

204

assume some sort of discretisation [29]. In Fig. A1 we show that often convergence occurs at small m.

205

Second, we propose a linear model for fs , as defined in Eq. (4b). There s−1 is a standard white noise term i.e.,

206

P(s−1 ) = Norm(0, 1) with Norm signifying a normal distribution and η as a free parameter. We assume that a

207

noisy linear projection of states over consecutive time-points provides a good approximation of the state trajectory.

208

Not only is this assumption standard in engineering [23] and epidemiology [33] but it is also more flexible than the

209

state model inherent to EpiEstim and the WT method. We scale the noise of this projection by a fraction, η < 1

210

of the magnitude of Rs−1 . This parameter controls the correlation among successive instantaneous reproduction

211

numbers (and hence the state noise) but ensures Rs is a-priori non-negative.

d

212

Our observation model, gs , is implicit and leads to the probability law in Eq. (1). As a result, both our observations

213

and state models are discrete (see Fig. 1 for summaries). Because the state model governing Rs in Eq. (4b) is

214

stochastic, Eq. (1) actually describes an over-dispersed (doubly stochastic) Poisson incidence curve. Consequently,

215

η , allows us to better model some of the heterogeneity in transmissibility, and may increase robustness to violations

216

of the well-mixed assumption inherent to renewal models [21]. We can optimise our choice of η value by minimising

217

the incidence one-step-ahead predictions that result from our observation model [13].

218

We now define the Bayesian recursive filtering procedure, which is a main contribution of this work, and can be

219

solved exactly, in real-time and with minimal computational effort. We adapt general recursive filtering equations

220

from [32], [14], [25], [18], which are valid for various types of observation and state models, to our renewal model

221

inference problem. The proof of the equations we employ can be found in these works. While we solve discrete,

222

univariate problems (our state model is one dimensional), extensions to continuous-time, multivariate problems also

223

exist [30], [23]. These recursive equations can also be approximately solved using particle filters [32], [14].
Recursive filtering involves two steps: prediction and correction. The first, given in Eq. (5a), constructs a sequential
prior predictive distribution, ps = P(Rs | I1s−1 ). This is informed by past incidence data I1s−1 and the last state
Rs−1 . The second step then corrects or updates this prior prediction into a posterior filtering distribution, ps , which

constrains ps using the latest observation, Is , according to Eq. (5b).
Z
ps =

P(Rs | Rs−1 , I1s−1 ) ps−1 dRs−1

(5a)

ps ∝ P(Is | Rs , I1s−1 ) ps

(5b)

d

224

225

Here P(Rs | Rs−1 , I1s−1 ) = Norm(Rs−1 , η 2 Rs−1 ) is the state model from Eq. (4b), P(Is | Rs , I1s−1 ) is the observation model from Eq. (1) and the constant of proportionality for Eq. (5b) is simply a normalising factor.

226

Solving Eq. (5) iteratively and simultaneously over the grid of R leads to our novel real-time estimate of the time-

227

varying effective reproduction number. We initialise this process with a uniform prior distribution over R for p1 and

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
10

228

note that ps and ps are m element vectors that sum to 1, with ith term corresponding to when Rs = R[i]. Eq. (5)

229

forms the first half of EpiFilter, is flexible and can be adapted to many related problems [14]. A key difference

230

between EpiFilter and the EpiEstim-type methods [11], [13] is that the latter approximate the distributions P(Rs | I1s )

231

s
and P(Rs | I1s−1 ) with P(Rs | Is−k+1
) and P(Rs ), respectively. Estimators based on these approximations can be

232

suboptimal, especially when data (i.e., cases) are scarce.

233

Bayesian (backward) recursive smoothing

234

While Eq. (5) provides a complete real-time solution to the filtering problem, it is necessarily limited at the

235

starting edge of the incidence curve, where past data are limited or unavailable. Further, because it does not update

236

past estimates as new data accumulate, it cannot provide optimal retrospective estimates. Here we develop the second

237

half of EpiFilter, which involves solving the optimal smoothing problem i.e., computing the smoothing posterior

238

distribution qs = P(Rs | I1t ), which provides maximally informed estimates of the instantaneous reproduction

239

number Rs given the complete incidence curve I1t . To our knowledge, smoothing has not yet been explicitly

240

considered in infectious disease epidemiology (either exactly or approximately).
We specialise the general methodology from [14], [25] to obtain the recursive smoother of Eq. (6a). This equation
uses the filtering distribution, ps = P(Rs | I1s ) and the predictive distributions ps+1 = P(Rs+1 | I1s ), which we obtain
d

from Eq. (5). Our state model means that P(Rs+1 | Rs , I1s ) = Norm(Rs , η 2 Rs ).
Z
q s = ps

P(Rs+1 | Rs , I1s ) qs+1 p−1
s+1 dRs+1

t
qs ∝ rs ps P(Rs )−1 , if rs ≈ P(Rs | Is+1
)

(6a)
(6b)

241

We realise Eq. (6a) exactly by taking a forward-backward algorithmic approach (this is the backward pass whereas

242

Eq. (5) is the forward one). We solve this equation by noting that qt = pt and iterating backwards in time to obtain

243

the first smoothing distribution q1 . The integrals become sums over our grid R and distributions are m element

244

vectors. Eq. (6a) sequentially updates our earlier filtering solutions to include future data, forms the second half of

245

EpiFilter and can also be approximately solved using particle smoothers [14].

246

This approach neatly links the filtering and smoothing distributions ps and qs . If we assume that the reverse-

247

t ) then we can also apply the two-filter smoothing
filtering distribution rs is reasonably approximated by P(Rs | Is+1

248

t ) or past (I s−1 ) incidence is uninformative then either r or
solution of [25] to get Eq. (6b). If either future (Is+1
s
1

249

ps will reduce to the prior P(Rs ), leading to qs ∝ ps or qs ∝ rs , respectively. The end and beginning of the

250

epidemic provide important examples of each of these scenarios. Consequently, Eq. (6b) shows how smoothing

251

connects EpiEstim and the WT methods, and explains why EpiFilter, which can be used for both real-time and

252

retrospective inference, better overcomes edge-effects and periods of low data.

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
11

253

Further, the smoothed posterior qs yields the conditional mean estimate R̂s = E[Rs | I1t ], which is known to

254

significantly improve on the MSE of the filtered equivalent R̃s (see previous section) [23]. While filtering provides

255

the minimum MSE estimator of every instantaneous reproduction number Rs given past knowledge, smoothing

256

provides the minimum given all knowledge. This relationship is formal, with filtered and smoothed MSE values

257

mapping to the amount of mutual information that I1t provides about R1t [34]. Extracting the maximum information

258

from the incidence curve I1t should engender estimates that are more robust and statistically efficient in periods of

259

low incidence. We summarise the EpiFilter algorithm in Fig. 1.
While our main interest is on optimised and rigorous real-time and retrospective estimates of transmissibility,
which are completely defined by the smoothing distribution qs , we may also want to predict future incidence, for
informing epidemic preparedness plans and for validating past Rs estimates [35], [13]. We compute the filtered
one-step-ahead posterior predictive distribution as in Eq. (7) (integrals are over R [14].
P(Is+1 | I1s ) =

Z

P(Is+1 | Rs , I1s ) ps dRs

(7)

d

260

We assume, as in [36], that P(Is+1 | Rs , I1s ) = Pois(Λs+1 Rs ). Replacing ps with qs yields the smoothed equivalent

261

of Eq. (7). We will use Eq. (7) to compare EpiFilter against APEestim, which is the prediction-optimised version

262

of EpiEstim, developed in [13]. Since predictions depend strongly on ps or qs , optimising these distributions can

263

be crucial, for example, to forecasting second waves of infection.
R ESULTS

264

265

Improved estimation at low incidence

266

The reliable estimation of time-varying effective reproduction numbers, Rs , at low incidence, Is , is a key challenge

267

limiting our understanding of transmission [17]. Periods with small counts of new cases contain little information

268

and so present necessary statistical difficulties [26]. Here we compare EpiFilter, which allows exact inference over

269

a state grid R, with EpiEstim and APEestim at these data-poor settings. We use EpiEstim with weekly and monthly

270

windows. Weekly windows are the default recommendation in [11]. We include monthly ones as long windows can

271

improve robustness at low incidence [28]. APEestim, developed in [13], optimises the window choice of EpiEstim

272

to minimise one-step-ahead prediction errors. The assumptions and choices inherent in estimation methods become

273

important and visible when data are scarce, and can bias inference or support spurious predictions [15].

274

We generate epidemics using Eq. (1) under the serial interval distribution of Ebola virus disease described in [37].

275

We examine three diverse scenarios in Fig. 2. These describe (A) rapidly controlled epidemics (Rs step changes

276

from 2 to 0.5 at s = 100), (B) small outbreaks with exponentially rising and falling Rs (change-point at s = 30

277

and rates of 0.02 and -0.008 per time unit) and (C) medium outbreaks that are initially controlled (Rs changes

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
12

278

from 4 to 0.6 at s = 40) then resurge (Rs rebounds to 2 at s = 80) into large epidemics, before finally being

279

suppressed (Rs = 0.2 from s = 150). These scenarios are similar to ones investigated in [28], [12] and describe

280

various epidemic dynamics that culminate in elimination. We simulate 200 incidence curves for each scenario and

281

apply APEestim (optimal window k ∗ ), EpiEstim (k = 7 and 31) and EpiFilter (state noise η = 0.1) to estimate Rs

282

and sequentially predict Is (given data up to s − 1) for each curve.

283

For the first two methods we compute mean one-step-ahead incidence predictions (I˜τ (s) ) as in [13] and instanta-

284

neous reproduction number estimates (R̃τ (s) ) from Eq. (2) with τ (s) delimiting the window times used. We obtain

285

smoothed EpiFilter estimates (R̂s ) and filtered predictions (I˜s ) from Eq. (6) and Eq. (7). We could use smoothed

286

predictions (Iˆs ), which implicitly include data beyond s − 1, to assess fit but as we want to test model adequacy I˜s

287

is more appropriate [38]. Our main focus is on real-time performance so we do not investigate the WT method. See

288

[11], [12] for comparisons of the WT method and EpiEstim. Panels A-C of Fig. 2 provide representative single runs

289

(we only show k = 31 for EpiEstim as k = 7 is often similar to APEestim) while panel D presents reproduction

290

number MSE and one-step-ahead predicted incidence MSE (PMSE) distributions from the 200 runs. The left panels

291

of Fig. A3 in the Appendix provide distributions of the coverage statistics from these runs (i.e., the probability that

292

the true Rs or Is is contained within estimated or predicted 95% confidence intervals).

293

In the Methods we showed that since EpiEstim-type methods group data over some window into the past, they

294

revert to their prior distribution as the total cases in this window becomes small. During low incidence periods, e.g.,

295

when the epidemic is waning, using long windows makes sense [28]. However, this reduces predictive accuracy as

296

fluctuations in Rs are underfit. This is the use-case for APEestim, which optimises for prediction. The consequences

297

of these trade-offs are made clear in A-C of Fig. 2 where APEestim provides the best one-step-ahead Is predictions

298

but quickly reverts to its prior (seen as wide confidence intervals) when cases are few. Longer window EpiEstim

299

improves on this destabilisation but cannot track salient fluctuations in Rs . Panel D of Fig. 2 confirms these trends.

300

APEstim has the smallest PMSE but often worse MSE than the larger k EpiEstim choices. However, as seen in

301

Fig. A3, both EpiEstim approaches have smaller coverage than APEestim.

302

Interestingly, EpiFilter is able to jointly optimise both instantaneous reproduction number tracking and incidence

303

predictions (computed via Eq. (7)). In A-C of Fig. 2 we see that EpFilter maintains stable and accurate estimates of

304

Rs and only slowly reverts to its prior (which has the same support as that of EpiEstim and APEesim). However,

305

unlike long window methods it does not sacrifice prediction fidelity. The improvement in MSE shown in panel

306

D of Fig. 2 is stark (the numerical reduction in MSE when compared to the next best method is on average at

307

least 2-fold and often 10-fold). The PMSE, while larger than that of APEestim (which is optimised for predictions)

308

is still good. Moreover, the coverage of both the true Rs and Is of EpiFilter is superior to all other approaches

309

as shown in Fig. A3. EpiFilter therefore combines the advantages of APEestim and long-window EpiEstim and,

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
13

310

further, is able to detect transmission change-points automatically.

Fig. 2: Small or waning epidemics. We compare reproduction number estimates (R̃τ (s) or R̂s ) and one-stepahead incidence predictions (I˜τ (s) or I˜s ) from APEestim with optimal window k ∗ , EpiEstim with window k and
EpiFilter with state noise η . We simulate 200 epidemics with low daily case numbers or long tails (long sequences
of zero cases) using the standard renewal model (Eq. (1)) for three scenarios, representative examples of which
are given in A-C. The true Rs and Is are in black. All mean estimates or predictions are in red and blue with
95% confidence intervals. APEestim and EpiEstim use a Gam(1, 2) prior distribution and EpiFilter a grid with
m = 2000, Rmin = 0.01 and Rmax = 10. In D we provide statistics of the MSE of these estimates (relative to
Rs ) and the PMSE of these predictions (relative to Is ) for all 200 runs. We find that EpiFilter is more robust to
small incidence (better uncertainty), whereas the other approaches can quickly decay to their prior distribution. It
achieves significantly smaller MSE (2-10 fold reductions), comparable PMSE to APEestim (which is optimised for
prediction) and superior coverage of the true Rs and Is (see Fig. A3).

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
14

Fig. 3: Epidemics with multiple waves. We compare reproduction number estimates (R̃τ (s) or R̂s ) and one-stepahead incidence predictions (I˜τ (s) or I˜s ) from APEestim with optimal window k ∗ , EpiEstim with window k and
EpiFilter with state noise η . We simulate 200 epidemics with multiple waves of infection using the standard renewal
model (Eq. (1)) for three scenarios, representative examples of which are given in A-C. The true Rs and Is are in
black. All mean estimates or predictions are in red and blue with 95% confidence intervals. APEestim and EpiEstim
use a Gam(1, 2) prior distribution and EpiFilter a grid with m = 2000, Rmin = 0.01 and Rmax = 10. In D we
provide statistics of the MSE of these estimates (relative to Rs ) and the PMSE of these predictions (relative to
Is ) for all 200 runs. We find EpiFilter is best able to negotiate troughs between epidemic peaks and hence infer
resurging infectious dynamics, achieving significantly smaller MSE (2-10 fold reductions), comparable PMSE to
APEestim (which is optimised for prediction) and superior coverage of the true Rs and Is (see Fig. A3).

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
15

311

Improved estimation between epidemic waves

312

Maintaining robust instantaneous reproduction number, Rs , estimation when incidence, Is , becomes small is not

313

just statistically important. Two possible outcomes may follow periods of small Is : either the epidemic goes extinct

314

(elimination occurs, as in the previous section), or an additional wave of infection surfaces (resurgence) e.g., due

315

to imports or unmonitored local transmission. Predicting which outcome is likely, rapidly and in real-time, is of

316

major global concern as countries aim to relax interventions during the ongoing COVID-19 pandemic, while also

317

minimising the risks of further resurgence [17], [39]. As changes in instantaneous reproduction numbers predate and

318

signal corresponding variations in incidence, reliably identifying and inferring Rs trends in the trough preceding

319

potential new peaks is crucial for preparedness and both timely and effective epidemic control [10].

320

Reliable estimation of Rs between epidemic waves depends on the prior assumptions of the inference method

321

used and on how that method relies on those assumptions when data are scarce [40], [41]. Here we examine this

322

dependence and investigate cases where resurgence follows a low-incidence period. As in the above section, we

323

compare EpiFilter (η = 0.1) with APEestim (optimal window k ∗ ) and EpiEstim (weekly, k = 7, and monthly,

324

k = 31, windows) over 200 simulated epidemics under the serial interval of Ebola virus. We explore scenarios

325

depicting (A) epidemics that are initially controlled (Rs falls from 2.5 to 0.5 at s = 70) but which resurge just as

326

quickly (Rs returns to 2.5 from s = 230), (B) periodic or seasonal transmission (Rs is sinusoidal with magnitude

327

1.3 ±1.2 and period of 120 time units) and (C) outbreaks with exponentially rising and then falling transmissibility

328

(change-points at s = 40 and 190 and exponent rates 0.03, -0.015 and 0.02).

329

These examples are similar to some in [13] and describe diverse epidemics with multiple peaks and troughs.

330

We provide representative runs of each scenario in A-C and collect MSE (for Rs ) and PMSE (relative to Is )

331

distributions over the 200 runs of every scenario in D of Fig. 3. Coverage distributions are shown in right panels

332

of Fig. A3 of the Appendix. We observe a similar pattern in performance among the methods as in our previous

333

analysis of Fig. 2. APEestim is best able to predict upcoming incidence and achieves the best PMSE as expected.

334

While the monthly window EpiEstim is less useful in these cases (since prior reversion does not occur as often,

335

though could be an issue for more extended troughs), the weekly window version loses predictive fidelity for minor

336

MSE improvements. Its coverage is, however, generally worse than that of APEestim.

337

EpiFilter once again combines the advantages of the other approaches. For every scenario in Fig. 3 it provides
1
2

338

accurate tracking of changes in Rs with stable confidence intervals and a MSE that is at least

339

even

340

also achieves the best coverage of the true Rs and Is values. EpiFilter is therefore a powerful tool for detecting

341

resurgence. We also find that the η = 0.1 parameter value seems to be an all-purpose heuristic, meaning that

342

usage of EpiFilter can be somewhat simpler than EpiEstim and other window or change-point based methods. The

1
10

and sometimes

that of the next best method. Concurrently, its incidence PMSE rivals that of APEestim. Importantly, it

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
16

343

superior capability of EpiFilter in these scenarios likely results from its minimalistic assumptions (see Eq. (4)) and

344

its increased information extraction. We next test our method on empirical incidence data.

345

COVID-19 in New Zealand and H1N1 influenza in the USA

346

The previous sections confirmed EpiFilter as a powerful inference and prediction tool, especially in data-poor

347

conditions, using simulated epidemics. We now confront our method with empirical data from the 1918 H1N1

348

influenza pandemic in Baltimore (USA) [42] and the ongoing COVID-19 pandemic in New Zealand (up to 17

349

August 2020) [43]. The H1N1 dataset has been well-studied and so we first use this to benchmark EpiFilter. We

350

clean this dataset by applying a 5-day moving average filter as recommended in [42]. Previous work [11] analysed

351

this dataset with EpiEstim and found that sensible instantaneous reproduction number, Rs , estimates are obtained

352

when a weekly window (k = 7) is applied. However, more recent work, using APEestim [13], showed that while

353

k = 7 provides stable estimates for this epidemic, it is a poor predictor of the incidence data. Instead, an optimised

354

window of 2 days (k ∗ = 2) yields good predictions but the resulting Rs estimates are noisy.

355

We reproduce the instantaneous reproduction number estimates (R̃τ (s) ) and incidence predictions (I˜τ (s) ) from

356

both studies in Fig. 4 and compare them against EpiFilter with η = 0.1 (R̂s and I˜s ). Top and middle rows of Fig. 4

357

illustrate the aforementioned trade-off between estimate stability and prediction accuracy. The bottom row confirms

358

the power of EpiFilter. Our Rs estimates are of comparable stability to those of EpiEstim at k = 7, yet our prediction

359

fidelity matches that of APEestim. Our improved inference again benefits from using more information (i.e., the

360

backward pass in Fig. 1) and making less restrictive prior assumptions. We see the latter from the Rs confidence

361

intervals over 40 ≤ s ≤ 60. There EpiEstim seems overconfident, and this results in a rigid overestimation of

362

incidence. However, EpiFilter mediates its estimate uncertainty to a level similar to APEestim.

363

We explore COVID-19 transmission patterns in New Zealand using incidence data up to 17 August 2020 from

364

[43]. New Zealand presents an insightful case study because officials combined swift lockdowns with intensive

365

testing to achieve and sustain very low incidence levels that eventually led to local elimination of COVID-19 [44].

366

However, an upsurge in cases in early August inspired concerns about a second wave (which led to new interventions

367

and is why we do not consider data beyond 17 August). Here we investigate time-varying transmission in New

368

Zealand to see if this uptick suggests that the epidemic was resurfacing in mid-August. We believe smoothing can

369

confer important inferential advantages in exactly these types of low incidence scenarios.

370

We make the common assumptions that case under-reporting is constant [11], which seems reasonable given the

371

intensive surveillance employed by New Zealand [45]. We ignore reporting delays, which are known to be small

372

[46] and use the COVID-19 serial interval distribution from [47]. We do not explicitly distinguish imported from

373

local cases in our analysis. The latter could bias our study [28], [39] but our focus is on demonstrating differences

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
17

Fig. 4: H1N1 influenza transmission in Baltimore (1918). We compare APEestim (top), EpiEstim with
recommended weekly window (middle) (both with Gam(1, 2) prior distribution) and EpiFilter (with m = 2000,
η = 0.1, Rmin = 0.01 and Rmax = 10) on the H1N1 influenza dataset from [42]. We use a 5-day moving average
filter, as in [42], to remove known sampling biases. Estimates of reproduction numbers, Rs , and corresponding 95%
confidence intervals are in red. One-step-ahead predictions of incidence, Is , (with 95% confidence intervals) are in
blue with the actual incidence in black. We find that EpiFilter combines the benefits of APEestim and EpiEstim,
achieving both good estimates and predictions.

374

between filtering and smoothing on instantaneous reproduction number, Rs , trends and not on providing detailed

375

Rs estimates during this period. We plot the results of our exploration in Fig. 5. More involved analyses can be

376

performed by pre-processing the data if introductions and case ascertainment fractions are known [12], [6].

377

We apply EpiFilter and obtain filtered (R̃s ) and smoothed (R̂s ) conditional mean estimates together with their

378

95% confidence intervals. These are in the left panels of Fig. 5 and computed from Eq. (5) and Eq. (6) respectively.

379

The times of lockdown and release are included for reference. Interestingly, we see a notable difference in the quality

380

of inference between R̃s and R̂s . The former, as expected, is unreliable at the beginning of the incidence curve and

381

features wider uncertainty and noisier trends. The smoothed R̂s , by using both forward and backward-looking data

382

largely overcomes these issues and clarifies transmission dynamics. In the right panels we compare EpiFilter with

383

EpiEstim (weekly windows) and APEestim. The difference is striking. Neither APEestim nor EpiEstim recovers a

384

clear trend and both are appreciably worse than even the filtered estimate R̃s .

385

Our smoothed analysis suggests that Rs has resurged and supports the re-implementation of measures around

386

14 August. We recover suppression of the initial wave in April, likely associated with the implementation of key

387

interventions, including lockdown [46]. Following this, we infer a prolonged period of subcritical transmission,

388

where P(Rs ≤ 1) ≈ 1. Low and then zero incidence over this period strikingly destabilises both APEestim and

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
18

Fig. 5: COVID-19 transmission in New Zealand. We compute smoothed and filtered reproduction number
estimates, R̂s and R̃s respectively, from the COVID-19 incidence curve for New Zealand (available at [43]) in
the left panels. We use EpiFilter with m = 2000, η = 0.1, Rmin = 0.01 and Rmax = 10 with a uniform prior
distribution over the grid R. The top sub-figure shows conditional mean estimates and 95% confidence intervals for
R̂s (red) and R̃s (blue). Vertical lines indicate the start and end of lockdown, a major intervention that was employed
to halt transmission. The additional ‘future’ information used in smoothing has a notable effect. The bottom subfigure provides smoothed one-step-ahead predictions Iˆs (blue, with 95% confidence) of the actual reported cases Is
(black). The inset gives the estimated probability of Rs ≤ 1. We observe a clear trend of subcritical transmission
that eventually seeds a second wave by August. In the right panels we compare EpiFilter with EpiEstim (using
weekly windows) and APEestim (both with Gam(1, 2) priors) with all left subfigures presenting Rs estimates and
right ones providing filtered Is predictions. We observe that both APEestim and EpiEstim lead to largely unusable
estimates that mask transmission trends, in stark contrast to EpiFilter.

389

EpiEstim and conceals the rise in Rs that occurs after July. EpiFilter provides early-warning of this upsurge, which

390

continually grows until August, where a second wave becomes likely. We also provide one-step-ahead predictions

391

(which are from the smoothed R̂s hence the notation Iˆs ) and their 95% confidence intervals against the reported

392

incidence from [43]. These verify that R̂s reasonably describes the data (we also present I˜s when comparing

393

methods). We find that P(Rs ≤ 1) ≈ 0, further supporting this resurgence hypothesis.

394

D ISCUSSION

395

Estimating time-varying trends in the instantaneous or effective reproduction number, Rs , reliably and in real-

396

time is an important and popular problem in infectious disease epidemiology [5]. As the COVID-19 pandemic

397

has unfolded, the interest in solving this problem has only elevated with Rs playing a central role both in aiding

398

situational awareness [8] and informing policymaking [48]. Initially, interest was on understanding how changes

399

in Rs may correlate with interventions such as lockdowns and social distancing [10], [9]. However, as countries

400

have entered waning phases of the pandemic and vaccine deployment has begun, focus has shifted to charactering

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
19

401

how existing interventions can be relaxed with minimum risk [49]. The literature on intervention exit strategies is,

402

however, still in development, and several challenges remain to modelling transmission.

403

One key challenge lies in understanding and inferring transmissibility during periods when the incidence of new

404

cases is small [17]. Such periods may occur under sustained control measures and necessarily contain limited

405

data, which make inferences difficult. Moreover, it is in these lulls that information on transmission may be

406

crucial, helping to determine if the removal of interventions will lead to resurgence or if elimination is realistic by

407

maintaining controls [28], [39]. While reproduction numbers are not the only analytic for assessing these outcomes,

408

they do provide an important real-time diagnostic since upticks in Rs generally precede elevations in case loads.

409

Unfortunately, current approaches to estimating Rs become underpowered, unstable or prior-constrained in these

410

data-limited conditions [11], [26], [49]. These problems are only magnified when finer-scale analyses (where cases

411

are fewer by division) are of interest (e.g., regional versus national level estimation).

412

In this paper we re-examined existing methodology for inferring instantaneous reproduction numbers, Rs , from an

413

engineering perspective. We observed that two of the most useful and popular inference approaches, EpiEstim [11]

414

and the WT method (this computes cohort reproduction numbers, which are functions of Rs ) [2], only capitalise

415

on a portion of the data available, deeming either upcoming or past incidence to be informative (see Fig. 1) [12].

416

This informative portion is directly controlled by prior assumptions on the speed of possible Rs changes, which

417

are often characterised by a window of size k . Other methods also apply similarly strong change-point or state

418

assumptions on Rs , explicitly linking its variations with specific dates or events, for example [26], [9]. When data

419

are scarce these assumptions can unduly control or bias inference.

420

In control engineering a common problem, known as filtering, involves optimally (in a MSE sense) estimating

421

hidden Markov states, in real-time, from noisy and uncertain observations [18]. A related problem termed smoothing

422

provides accompanying and optimal retrospective inferences [14]. By reinterpreting Rs as a Markov state (Eq. (4))

423

observed through a noisy renewal process (Eq. (1)) and defining Rs on a predetermined grid R, we were able

424

to construct exact filtering (Eq. (5)) and smoothing (Eq. (6)) solutions. This led to EpiFilter, which is our central

425

contribution. Generally, filtering and smoothing can be involved and require sophisticated sequential Monte Carlo

426

techniques [32]. However, because we make only minimal assumptions about Rs , modelling it as a simple diffusion,

427

we were able to solve these problems exactly and without complex sampling algorithms [29].

428

Our solutions are computationally simple, often executing in a few minutes (see Fig. A1), and deterministic i.e.,

429

precisely reproducible given the same data and settings. Our method replaces strong change-point or window size

430

assumptions with one free parameter, η , which allows us to model some heterogeneity in transmission and sets

431

the correlation among successive Rs values. We find that η = 0.1 serves as a general heuristic, providing good

432

estimates and automatically detecting change-points and salient Rs dynamics over diverse scenarios (see Fig. 2,

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
20

433

Fig. 3 and Fig. A2). This heuristic is also statistically justified by its good one-step-ahead predictive performance

434

and its coverage of true simulated values (see Fig. A3) [13].

435

Importantly, EpiFilter is able to look both forward and backward through the incidence data, and so maximise the

436

information extracted at every time point [34]. This property means it combines advantages from both EpiEstim and

437

the WT method (see Fig. 1) and largely ameliorates their edge-effect issues [12]. These benefits, which also hold

438

at large incidence, make EpiFilter a useful and robust tool for both real-time and retrospective Rs inference. We

439

confirmed the advantages of EpiFilter by comparing it to EpiEstim and APEestim (a prediction optimised analogue

440

to EpiEstim) on many simulated examples with periods of low incidence and epidemic resurgences (Fig. 2 and

441

Fig. 3). Interestingly, we found EpiFilter was able to achieve significant 2-10 fold reductions in the MSE of Rs

442

estimates without compromising predictive power. Further, its estimate and prediction confidence intervals contained

443

the true Rs and Is values with the highest probabilities (see Fig. A3).

444

EpiFilter was especially better at negotiating periods of low incidence, offering a graceful degradation to its

445

prior distribution or assumptions without sacrificing predictive accuracy. When incidence is low, it can be beneficial

446

to use longer windows with EpiEstim [28]. This keeps Rs estimates reasonably stable but often leads to poor

447

predictions [13]. APEestim, which optimises window size for prediction fidelity, showed that in many of the

448

simulated scenarios short windows are necessary for describing transmission patterns. Consequently, we have a

449

trade-off between estimate robustness and prediction accuracy. We found that EpiFilter overcomes this trade-off,

450

concurrently achieving good estimates and predictions. In doing so, it revealed subcritical transmission trends and

451

unmasked important signals of resurgence from noisy data in those periods.

452

We verified the practical utility and performance of EpiFilter on empirical data from the H1N1 pandemic of 1918

453

(see Fig. 4) and COVID-19 in New Zealand (see Fig. 5). In the first, which is a standard dataset that has been used

454

to test previous Rs methods, we found that EpiFilter integrated the benefits of EpiEstim and APEestim to achieve

455

simultaneously good estimates and predictions. A key use-case for EpiFilter is in signalling resurgence during low

456

incidence. The COVID-19 epidemic in New Zealand featured precisely those dynamics [46]. While EpiEstim and

457

APEestim were destabilised and unable to extract clear transmission trends, EpiFilter inferred subcritical Rs values

458

and forewarned of resurgence by signalling an uptick in Rs just before a second wave become apparent. Recent,

459

more involved COVID-19 analyses [39], have confirmed EpiFilter as a useful early-warning method.

460

Balancing the assumptions inherent to a model against the data it is applied on, to produce reliable inference is a

461

non-trivial problem that is still under active investigation in several fields [15], [40], [41]. EpiFilter, by maximising

462

the information extracted from available incidence data and minimising its state space model assumptions, appears

463

to strike this balance as an estimator of instantaneous or effective reproduction numbers. Consequently, it performs

464

strongly on a wide range of problems, including those involving sparse data, where other methods might struggle.

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
21

465

Given its demonstrated advantages, straightforward formulation and theoretical underpinning, we hope that EpiFilter

466

will be useful as a diagnostic tool for reliably warning about second waves of infection over multiple scales and

467

more generally for assessing dynamical patterns in transmission both in real time and retrospectively. EpiFilter is

468

freely available at https://github.com/kpzoo/EpiFilter.
ACKNOWLEDGMENTS

469

470

Thanks to Christl A Donnelly for thoughtful comments.
F UNDING

471

472

This work is jointly funded under grant reference MR/R015600/1 by the UK Medical Research Council (MRC)

473

and the UK Department for International Development (DFID) under the MRC/DFID Concordat agreement and is

474

also part of the EDCTP2 programme supported by the European Union.

475

R EFERENCES

476

[1] C. Fraser, “Estimating individual and household reproduction numbers in an emerging epidemic,” PLOS One, vol. 8, p. e758, 2007.

477

[2] J. Wallinga and P. Teunis, “Different epidemic curves for severe acute respiratory syndrome reveal similar impacts of control measures,”

478
479

Am. J. Epidemiol, vol. 160, no. 6, pp. 509–16, 2004.
[3] H. Nishiura and G. Chowell, “The effective reproduction number as a prelude to statistical estimation of time-dependent epidemic

480

trends,” in Mathematical and statistical estimation approaches in epidemiology, pp. 103–21, Springer, 2009.

481

[4] R. Anderson and R. May, Infectious diseases of humans: dynamics and control. Oxford University Press, 1991.

482

[5] S. Cauchemez, P. Boelle, G. Thomas, et al., “Estimating in real time the efficacy of measures to control emerging communicable

483
484
485
486
487

diseases,” Am. J. Epidemiol, vol. 164, no. 6, pp. 591–7, 2006.
[6] T. Churcher, J. Cohen, N. Ntshalintshali, et al., “Measuring the path toward malaria elimination,” Science, vol. 344, no. 6189, pp. 1230–
32, 2014.
[7] WHO Ebola Response Team, “Ebola virus disease in West Africa – the first 9 months of the epidemic and forward projections,” N.
Engl. J. Med, vol. 371, no. 16, pp. 1481–95, 2014.

488

[8] S. Bhatia, A. Cori, K. Parag, et al., “Short-term forecasts of COVID-19 deaths in multiple countries..”

489

[9] S. Flaxman, S. Mishra, A. Gandy, et al., “Estimating the effects of non-pharmaceutical interventions on COVID-19 in Europe,” Nature,

490
491
492
493
494
495
496
497
498
499

vol. 584, pp. 257–261, 2020.
[10] X. Hao, S. Cheng, D. Wu, et al., “Reconstruction of the full transmission dynamics of COVID-19 in Wuhan,” Nature, vol. 584,
pp. 420–4, 2020.
[11] A. Cori, N. Ferguson, C. Fraser, et al., “A new framework and software to estimate time-varying reproduction numbers during epidemics,”
Am. J. Epidemiol, vol. 178, no. 9, pp. 1505–12, 2013.
[12] K. Gostic, L. McGough, E. Baskerville, et al., “Practical considerations for measuring the effective reproductive number, rt,” PLOS
Comput. Biol, vol. 16, no. 12, p. e1008409, 2020.
[13] K. Parag and C. Donnelly, “Using information theory to optimise epidemic models for real-time prediction and estimation,” PLOS
Comput. Biol, vol. 16, no. 7, p. e1007990, 2020.
[14] S. Sarrka, Bayesian Filtering and Smoothing. Cambridge, UK: Cambridge University Press, 2013.

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
22

500
501
502
503
504
505
506
507

[15] K. Parag, O. Pybus, and C. Wu, “Are skyline plot-based demographic estimates overly dependent on smoothing prior assumptions?,”
BioRxiv, vol. 920215, 2020.
[16] T. Britton, T. House, A. Lloyd, et al., “Five challenges for stochastic epidemic models involving global transmission,” Epidemics,
vol. 10, pp. 54–7, 2015.
[17] R. Thompson, D. Hollingsworth, V. Isham, et al., “Key questions for modelling COVID-19 exit strategies,” Proc. R. Soc. B, vol. 287,
no. 1932, p. 20201405, 2020.
[18] K. Astrom and R. Murray, Feedback Systems: An Introduction for Scientists and Engineers. New Jersey: Princeton University Press,
2008.

508

[19] S. Riley, K. Eames, V. Isham, et al., “Five challenges for spatial epidemic models,” Epidemics, vol. 10, no. 68-71, 2015.

509

[20] J. Wallinga and M. Lipsitch, “How generation intervals shape the relationship between growth rates and reproductive numbers,” Proc.

510
511
512
513
514

R. Soc. B, vol. 274, pp. 599–604, 2007.
[21] Q. Liu, M. Ajelli, A. Aleta, et al., “Measurability of the epidemic reproduction number in data-driven contact networks,” PNAS, vol. 115,
no. 50, pp. 12680–85, 2018.
[22] T. Britton and G. Tomba, “Estimation in emerging epidemics: biases and remedies,” J. R. Soc. Interface, vol. 16, no. 150, p. 20180670,
2019.

515

[23] D. Snyder and M. Miller, Random Point Processes in Time and Space. Springer-Verlag, 2 ed., 1991.

516

[24] R. Kalman, “A new approach to linear filtering and prediction problems,” Trans. ASME J. Basic Eng, vol. 82, pp. 35–45, 1960.

517

[25] B. Anderson and I. Rhodes, “Smoothing algorithms for nonlinear finite-dimensional systems,” Stochastics, vol. 9, pp. 139–65, 1983.

518

[26] K. Parag and C. Donnelly, “Adaptive estimation for epidemic renewal and phylogenetic skyline models,” Syst. Biol, vol. 69, no. 6,

519

pp. 1163–79, 2020.

520

[27] T. Rothenberg, “Identification in parametric models,” Econometrica, vol. 39, no. 3, pp. 577–91, 1971.

521

[28] K. Parag, C. Donnelly, R. Jha, et al., “An exact method for quantifying the reliability of end-of-epidemic declarations in real time,”

522
523
524
525
526
527
528

PLOS Comput. Biol, vol. 16, no. 11, p. e1008478, 2020.
[29] K. Parag and O. Pybus, “Exact bayesian inference for phylogenetic birth-death models,” Bioinformatics, vol. 34, no. 21, pp. 3638–45,
2018.
[30] K. Parag and G. Vinnicombe, “Point Process Analysis of Noise in Early Invertebrate Vision,” PLOS Comput. Biol, vol. 13, no. 10,
p. e1005687, 2017.
[31] C. Zechner and H. Koeppl, “Uncoupled analysis of stochastic reaction networks in fluctuating environments,” PLOS Comput. Biol,
vol. 10, no. 12, p. e1003942, 2014.

529

[32] Z. Chen, “Bayesian filtering: From Kalman filters to particle filters, and beyond,” Statistics, vol. 182, no. 1, pp. 1–69, 2003.

530

[33] L. Allen, “A primer on stochastic epidemic models: Formulation, numerical simulation, and analysis,” Infect. Dis. Model, vol. 2,

531
532
533
534
535
536
537
538
539

pp. 128–142, 2017.
[34] D. Guo, D. Shamai, and S. Verdu, “Mutual information and minimum mean-square error in Gaussian channels,” IEEE Trans. Info.
Theo, vol. 51, no. 4, pp. 1261–82, 2005.
[35] S. Funk, A. Camacho, A. Kucharski, et al., “Assessing the performance of real-time epidemic forecasts: A case study of Ebola in the
western area region of Sierra Leone, 2014-15,” PLOS Comput. Biol, vol. 15, no. 2, p. e1006785, 2019.
[36] P. Nouvellet, A. Cori, T. Garske, et al., “A simple approach to measure transmissibility and forecast incidence,” Epidemics, vol. 22,
pp. 29–35, 2018.
[37] M. Van Kerkhove, A. Bento, H. Mills, et al., “A review of epidemiological parameters from Ebola outbreaks to inform early public
health decision-making,” Sci. Data, vol. 2, p. 150019, 2015.

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
23

540
541
542
543
544
545
546
547
548
549

[38] E. Wagenmakers, P. Grunwald, and M. Steyvers, “Accumulative prediction error and the selection of time series models,” J. Math.
Psychol, vol. 50, pp. 149–166, 2006.
[39] K. Parag, B. Cowling, and C. Donnelly, “Deciphering early-warning signals of the elimination and resurgence potential of SARS-CoV-2
from limited data at multiple scales,” medRxiv, vol. 2020.11.23.20236968, 2021.
[40] E. Volz and X. Didelot, “Modeling the growth and decline of pathogen effective population size provides insight into epidemic dynamics
and drivers of antimicrobial resistance,” Syst. Biol, vol. 67, no. 4, pp. 719–28, 2018.
[41] J. Faulkner, A. Magee, B. Shapiro, et al., “Horseshoe-based Bayesian nonparametric estimation of effective population size trajectories,”
Biometrics, pp. 1–14, 2020.
[42] W. Frost and E. Sydenstricker, “Influenza in Maryland: preliminary statistics of certain localities,” Public Health Rep, vol. 34, pp. 491–
504, 1919.

550

[43] WHO, “WHO coronavirus disease (COVID-19) dashboard,” 2020.

551

[44] S. Cousins, “ New Zealand eliminates COVID-19,” Lancet, vol. 395, p. 1474, 2020.

552

[45] M. Roser, H. Ritchie, E. Ortiz-Ospina, et al., “Coronavirus pandemic (COVID-19),” 2020.

553

[46] S. Jefferies, N. French, C. Gilkison, et al., “COVID-19 in New Zealand and the impact of the national response: a descriptive

554
555
556

epidemiological study,” Lancet Public Health, vol. 5, no. 11, pp. e612–23, 2020.
[47] N. Ferguson, D. Laydon, G. Nedjati-Gilani, et al., “Impact of non-pharmaceutical interventions (NPIs) to reduce COVID- 19 mortality
and healthcare demand,” tech. rep., Imperial College London, 2020.

557

[48] P. Bruce, R. Anderson, C. Bangham, et al., “Reproduction number (R) and growth rate (r) of the COVID-19 epidemic in the UK:

558

methods of estimation, data sources, causes of heterogeneity, and use as a guide in policy formulation,” tech. rep., The Royal Society,

559

2020.

560

[49] Y. Li, H. Campbell, D. Kulkarni, et al., “The temporal association of introducing and lifting non-pharmaceutical interventions with the

561

time-varying reproduction number (R) of SARS-CoV-2: a modelling study across 131 countries,” Lancet Infect. Dis, vol. 21, no. 2,

562

pp. 193–202, 2020.

A PPENDIX

563

564

Validating the mechanics of EpiFilter

565

Having constructed EpiFilter (see Methods) we now investigate its mechanics and performance. First we show how

566

the choice of grid resolution m affects the accuracy and computational complexity of our smoothed instantaneous

567

reproduction number estimates, R̂s . Our recursive implementation is also known as a grid smoother, since its

568

estimates are optimal (in a MSE sense) but conditioned on the grid R [14], [29]. In the left panels of Fig. A1 we

569

reconsider the empirical H1N1 and COVID-19 examples, from the main text, at various m. We find that EpiFilter

570

has linear complexity in m but that R̂s (averaged over 50 replicate runs) converges quickly, both in mean and

571

variance (latter not shown). Execution times, which include both Rs estimation and incidence (Is ) prediction, are

572

only a few minutes, generally. While the Rs smoother is always fast, the Is prediction block may be slower for

573

very large epidemics (e.g., 1000s of cases per day), resulting in ∼ 10 minute run times.

574

As a rule-of-thumb setting m ≥ 103 safely guarantees convergence, and still executes in a few minutes. Note

575

that estimates at small m are still valid. They represent coarser assumptions on reproduction numbers and provide

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
24

Fig. A1: EpiFilter mechanics. We examine the computational complexity and accuracy of EpiFilter. Left panels
indicate how increasing grid resolution, m, leads to a linear increase in execution time (blue with 95% confidence
intervals) for the empirical case studies of the main text. These times are averaged over 50 replicate runs (using the
R implementation) and include the latency in computing both reproduction number, Rs , estimates and incidence, Is ,
predictions. The mean estimate of Rs , averaged over time and the replicates, is in grey, and converges quickly. The
variance of these estimates, while not shown, converges equally fast. Right panels provide an illustrative example
of how estimates R̂s (red with 95% confidence intervals) change with m and choices of process noise parameter,
η . Even at coarse grid sizes (small m) the estimates are sensible. Reducing η sharpens confidence intervals but
can potentially underfit. Increasing η adds state noise. We find that η = 0.1 serves as a good general heuristic. All
simulations are at Rmin = 0.01 and Rmax = 10 and the true Rs (a seasonal epidemic) is in black.

576

minimised MSE estimates under those assumptions. We illustrate a coarse estimate and how it converges for a

577

simulated example in the right panels of Fig. A1. There, we also test the behaviour under different choices of the

578

process or state noise parameter η . This parameter is vaguely similar to the window size parameter, k , in EpiEstim

579

approaches, but is easier to select. It controls the autocorrelation among successive Rs and allows some modelling

580

of heterogeneity (hence the term state noise). Fig. A1, shows how too small η might lead to underfitting, while

581

overly large η (where we would not consider η ≥ 1 given Eq. (4b)) could promote overfitting.

582

However, while the optimal window size in EpiEstim varies with the form of the true Rs (e.g., large k is needed

583

for stable Rs time-series and small k for strongly fluctuating ones [13]), we find that a fixed η = 0.1 works

584

well across diverse epidemic scenarios and enables automatic detection of transmission change-points. This is an

585

advantage over approaches requiring explicit change-point modelling [9]. We examine this further in Fig. A2. There

586

we compare Rs estimates from APEestim (with optimal window k ) [13] to EpiFilter (η = 0.1, m = 2000) for

587

simulated epidemic scenarios. We generate epidemics via the standard renewal model (Eq. (1)) using the Ebola

588

virus serial interval distribution from [37] and ensure the prior distributions of both methods have the same support.

589

The epidemics simulated span the range of possibilities (e.g., they may have large or small incidence).

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
25

590

We find EpiFilter outperforms APEestim, despite our using a single η value, with improvements especially stark

591

for the simulations with subcritical transmission (as detailed in main text). This single η contrasts the discordant

592

optimal k values and allows EpiFilter to recover the salient dynamics for epidemics with stable trajectories, seasonal

593

variations and rapidly or gradually fluctuating transmission. In none of these scenarios does the true Rs have either

594

the state model of Eq. (4b) or the sliding-window relationship in EpiEstim. Hence, these simulations also indicate

595

robustness of the different inherent state assumptions in both approaches to moderate model mismatch. We use

596

single runs to showcase how a practical epidemic would be processed in real-time. Neither method depends on

597

random algorithms (e.g., MCMC) so their estimates will remain constant under the same parameters.

Fig. A2: Validation against APEestim. We compare estimates from EpiFilter (right panels) with optimised ones
from APEestim (left panels [13]) over various general epidemic scenarios (which may have large or small incidence).
These are simulated using Eq. (1) and not restricted to epidemics that may face elimination or resurgence as in
Fig. 2 and Fig. 3. We use m = 2000, Rmin = 0.01 and Rmax = 10 for EpiFilter. To be fair we use a Gam(1, 2) prior
distribution with APEestim, which sums to 1 by Rmax . Here k is the optimal window choice in APEestim (under
predictive error) and η = 0.1 is fixed for EpiFilter inferences. True Rs is in black and conditional mean estimates
with 95% confidence intervals are in red. EpiFilter is more stable, smoother and minimises estimate uncertainty in
all scenarios. While the optimal k changes considerably among epidemics, η = 0.1 is able to automatically detect
salient changes in transmission for all examples considered.

598

Last, we complete our batch analysis of EpiFilter performance by examining coverage statistics. In Fig. 2 and

599

Fig. 3 a range of waning and resurging epidemic examples were explored. There we found that EpiFilter considerably

600

improves the MSE when inferring instantaneous reproduction numbers, Rs , relative to EpiEstim and APEestim.

601

APEestim, expectedly, had the best PMSE when predicting incidence, Is , but EpiFilter was only marginally worse.

602

In Fig. A3 we plot the distribution (over the 200 runs of each scenario from Fig. 2 and Fig. 3) of true coverage

603

i.e., the probability that the Rs estimate or Is prediction confidence intervals of a given method contain the true

604

Rs and Is values from the simulations. Interestingly, we find that EpiFilter generally has the best coverage (closest

medRxiv preprint doi: https://doi.org/10.1101/2020.09.14.20194589; this version posted March 7, 2021. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY-NC-ND 4.0 International license .
26

605

to 1) across all scenarios for both Rs and Is , confirming its superior performance.

Fig. A3: Coverage statistics. We provide the probability that the true values of instantaneous reproduction numbers,
Rs , and incidence, Is , from each scenario in Fig. 2 and Fig. 3 (over 200 runs) are contained within the 95% estimate
and prediction confidence intervals generated by EpiFilter (η = 0.1), APEestim (k = k ∗ ) and EpiEstim (weekly,
k = 7 and monthly, k = 31 windows). All simulation and method parameters follow from the main text and Fig. 2
and Fig. 3 (y axes indicate corresponding scenarios). We find that EpiFilter usually achieves the highest coverage
of all methods (1 indicates perfect coverage). APEestim consistently outperforms fixed-window EpiEstim methods,
showing the importance of adaptive window selection.

