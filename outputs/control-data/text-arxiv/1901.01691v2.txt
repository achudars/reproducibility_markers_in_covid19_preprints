arXiv:1901.01691v2 [math.DS] 2 Jun 2020

DIMENSION OF INVARIANT MEASURES FOR AFFINE
ITERATED FUNCTION SYSTEMS
DE-JUN FENG
Abstract. Let {Si }i∈Λ be a finite contracting affine iterated function system
(IFS) on Rd . Let (Σ, σ) denote the two-sided full shift over the alphabet Λ, and π :
Σ → Rd be the coding map associated with the IFS. We prove that the projection
of an ergodic σ-invariant measure on Σ under π is always exact dimensional, and its
Hausdorff dimension satisfies a Ledrappier-Young type formula. Furthermore, the
result extends to average contracting affine IFSs. This completes several previous
results and answers a folklore open question in the community of fractals. Some
applications are given to the dimension of self-affine sets and measures.

1. Introduction
1.1. Motivation and the main result. Let Matd (R) denote the set of real d × d
matrices. By an affine iterated function system (affine IFS) on Rd we mean a finite
family S = {Sj }j∈Λ of affine mappings from Rd to Rd , taking the form
(1.1)

Sj (x) = Mj x + aj ,

j ∈ Λ,

where Mj ∈ Matd (R) and aj ∈ Rd . Here, in contrast to the usual definition of
affine IFS, we do not assume that Mj are invertible or contracting (in the sense that
kMj k < 1 where k · k is the matrix operator norm). We say that S is contracting
if all Mj are contracting. It is well-known that if S is contracting, there exists a
unique non-empty compact set K ⊂ Rd such that
[
Sj (K).
K=
j∈Λ

We call K the self-affine set generated by S. In particular, if all the maps in S are
contracting similitudes, we call K a self-similar set. As usual, a contracting S is
said to satisfy the open set condition if there exists a non-empty open set U ⊂ Rd
such that Sj (U), j ∈ Λ, are disjoint subsets of U; moreover, S is said to satisfy the
strong separation condition if Sj (K), j ∈ Λ, are disjoint.
Let (Σ, σ) be the two-sided full shift over the alphabet Λ, i.e. Σ = ΛZ and σ :
Σ → Σ is the left shift map. Endow Σ with the product topology and let Mσ (Σ)
denote the space of σ-invariant Borel probability measures on Σ.
Key words and phrases. Iterated function systems, self-affine sets and measures, invariant measures, exact dimensionality, Hausdorff dimension, packing dimension.
2000 Mathematics Subject Classification: 28A80, 37C45.
1

2

DE-JUN FENG

Definition 1.1. Let m ∈ Mσ (Σ). An affine IFS S = {Mj x + aj }j∈Λ is said to
be average contracting with respect to m if, for m-a.e. x = (xn )∞
n=−∞ ∈ Σ, the top
Lyapunov exponent λ(x) defined by
1
λ(x) = lim log kMx0 · · · Mxn−1 k
n→∞ n
is strictly negative.
We remark that the above limit in defining λ(x) exists and takes values in [−∞, ∞)
for m-a.e. x. This follows from the Furstenberg-Kesten theorem [35] or Kingman’s
sub-additive ergodic theorem [45].
Now let m ∈ Mσ (Σ) and suppose that S is average contracting with respect to
m. The canonical coding map π : Σ → Rd , given by
π(x) = lim Sx0 ◦ Sx1 ◦ · · · ◦ Sxn (0)
(1.2)

n→∞


= lim ax0 + Mx0 ax1 + · · · + Mx0 · · · Mxn−1 axn ,
n→∞

is well-defined on Σ up to a set of zero m-measure ([16, 14]); see Section 3 for a
self-contained proof. The push-forward π∗ m of m by π, given by
(π∗ m)(F ) = m(π −1 (F ))

for any Borel set F ⊂ Rd ,

is called an invariant measure or stationary measure for S. When m is ergodic, π∗ m
is called an ergodic invariant measure for S. Moreover if m is a Bernoulli product
measure, π∗ m is called a self-affine measure generated by S; if in addition, S consists
of similarities, then π∗ m is called a self-similar measure.
The main purpose of this paper is to study the dimension of invariant measures
for affine IFSs. Recall that for a probability measure η on a metric space X, the
local upper and lower dimensions of η at x ∈ X are defined respectively by
dimloc (η, x) = lim sup
r→0

log η(B(x, r))
,
log r

dimloc (η, x) = lim inf
r→0

log η(B(x, r))
,
log r

where B(x, r) stands for the closed ball of radius r centered at x. If
dimloc (η, x) = dimloc (η, x),
the common value is denoted as dimloc (η, x) and is called the local dimension of η at
x. We say that η is exact dimensional if there exists a constant C such that the local
dimension dimloc (η, x) exists and equals C for η-a.e. x ∈ X. It is well-known that if
η is an exact dimensional measure in Rd , the Hausdorff and packing dimensions of
η coincide and are equal to the involved constant C, and so are some other notions
of dimension (e.g. entropy dimension); see [72, 22]. Recall that the Hausdorff and
packing dimensions of η are defined by
dimH η = inf{dimH F : η(F ) > 0 and F is a Borel set},
dimP η = inf{dimP F : η(Rd \ F ) = 0 and F is a Borel set},
where dimH F, dimP F stand for the Hausdorff and packing dimensions of F , respectively (cf. [23]).

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

3

A folklore open problem in fractal geometry asks whether every ergodic invariant
measure for an affine IFS is exact dimensional. As the main result of this paper, we
give the following affirmative answer.
Theorem 1.2. Let S = {Mj x + aj }j∈Λ be an affine IFS on Rd and m ∈ Mσ (Σ).
Suppose that S is average contracting with respect to m. Let µ = π∗ m. Then
(i) dimloc (µ, x) exists for µ-a.e. x ∈ Rd .
(ii) Assume furthermore that m is ergodic. Then µ is exact dimensional and
dimH µ satisfies a Ledrappier-Young type dimension formula.
The precise dimension formula of µ and some of its applications will be given in
Sections 1.2-1.3.
We remark that Theorem 1.2 also holds in its one-sided version. To be more
precise, let (Σ+ , σ) denote the one-sided full shift over the alphabet Λ, i.e.,
Σ+ = {(xn )∞
n=0 : xn ∈ Λ for all n ≥ 0},
and σ is the left shift map. Let τ : Σ → Σ+ be the natural projection defined by
+
∞
x = (xn )∞
n=−∞ 7→ x = (xn )n=0 .

It is well known that the push-forward map τ∗ : Mσ (Σ) → Mσ (Σ+ ), m 7→ τ∗ m, is
bijective, and moreover, τ∗ m is ergodic if and only if m is ergodic (see e.g. [15, pp. 2122]). Let m+ ∈ Mσ (Σ+ ) and assume that S is average contracting with respect to
m = (τ∗ )−1 (m+ ). Define π + : Σ+ → Rd by (xn )∞
n=0 7→ limn→∞ Sx0 ◦ · · · ◦ Sxn (0).
Then π(x) = π + (x+ ) and so π + is well defined m+ -a.e. Moreover, (π + )∗ (m+ ) = π∗ m.
Hence the conclusions of Theorem 1.2 hold for (π + )∗ (m+ ).
Below we first give some background information about the above study.
The problem of the existence of local dimensions has a long history in smooth
dynamical systems, as well as in the study of IFSs. It is of great importance in
dimension theory of dynamical systems and fractal geometry. In [72], Young proved
that an ergodic hyperbolic measure invariant under a C 2 surface diffeomorphism is
always exact dimensional. (Here by hyperbolic one means that the measure has no
zero Lyapunov exponent.) For a hyperbolic measure µ in higher-dimensional C 2
systems, Ledrappier and Young [46] proved the existence of δ u and δ s , the local
dimensions along stable and unstable local manifolds, respectively, and the upper
local dimension of µ is bounded by the sum of δ u and δ s ; moreover they obtained
a formula for δ u and δ s in terms of conditional entropies and Lyapunov exponents,
which nowadays is called “Ledrappier-Young formula”. Eckmann and Ruelle [19]
indicated that it is unknown whether the local dimension of µ is equal to the sum of
δ u and δ s if µ is a hyperbolic measure. Then the problem was referred as EckmannRuelle conjecture, and was finally answered affirmatively by Barreira, Pesin and
Schmeling in 1999 for C 1+α diffeomorphisms [10]. Later, the result of exact dimensionality was further extended by Qian and Xie [62] and Shu [69] to C 2 expanding
endomorphisms and C 2 non-degenerate endomorphisms, respectively.
For the study of IFSs, it is well-known that if S is a contractive IFS consisting of
similarity maps, or more generally, a contracting C 1 conformal IFS, then under an

4

DE-JUN FENG

additional assumption of the open set condition, the push-forward measure of any
ergodic invariant measure by the coding map is exact dimensional with dimension
given by the classical entropy divided by the Lyapunov exponent (cf. [12, 40, 58]).
The result essentially follows from the Shannon-McMillan-Breiman theorem in entropy theory. However, the problem becomes much more complicated without assuming the open set condition. In [29], by introducing a notion of projection entropy
and adopting some ideas from [46], Feng and Hu proved that for any contracting C 1
conformal IFS, the push-forward measure of every ergodic invariant measure under
the coding map is exact dimensional, with dimension given by the projection entropy divided by the Lyapunov exponent. Later this result was further extended to
some random self-similar measures [25, 68] and push-forward measures of ergodic
invariant measures for some random conformal IFSs [52]. It is worth pointing out
that the exact dimensionality of overlapping self-similar measures was first claimed
by Ledrappier; nevertheless no proof has been written out (cf. [59, p. 1619]). This
property was also conjectured later by Fan, Lau and Rao in [27].
The first result for affine IFSs is due to Bedford [11] and McMullen [51], who
independently calculated the Hausdorff and box-counting dimensions of a special
class of planar self-affine sets (which are now called Bedford-McMullen carpets) and
showed that they are usually different. McMullen [51] also implicitly proved the
exact dimensionality of self-affine measures on the Bedford-McMullen carpets, and
calculated the precise value of the dimension. Later, Gatzouras and Lalley [36] and
Barański [1] obtained similar results for a class of more general carpet-like self-affine
sets in the plane. In [44], Kenyon and Peres extended Bedford and McMullen’s
result to higher dimensional self-affine carpets, and moreover, they proved the exact
dimensionality and gave a Ledrappier-Young type dimension formula for arbitrary
ergodic invariant measure on these carpets. For more related results on carpet-like
self-affine sets, see the survey paper [24].
In [29], Feng and Hu proved that for each contracting invertible affine IFS in Rd ,
Theorem 1.2 holds under an additional assumption that the linear parts of the IFS
commute (i.e. Mi Mj = Mj Mi ). It remained open whether this additional assumption could be removed. Very recently, Bárány and Käenmäki [4] made a substantial
progress. They proved that for contracting invertible affine IFSs, every planar selfaffine measure (more generally, every self-affine measure in Rd having d distinct
Lyapunov exponents) is exact dimensional, and moreover, under certain domination
condition on the linear parts {Mj }, the push-down of every quasi-Bernoulli measure
on the self-affine set is exact dimensional, with dimension given by a LedrappierYoung type formula. Some other partial results were also obtained in [2, 64, 32].
Along another direction, it is proved that for a given ergodic m ∈ Mσ (Σ), π∗ m
is exact dimensional for “almost all” contracting invertible affine IFSs satisfying
kMj k < 1/2 ([42, 41, 66]); however, the result does not apply to any concrete case.
Theorem 1.2 finally gives a full affirmative answer to the problem of the existence
of local dimensions in the context of affine IFSs. It completes the aforementioned
previous works on the problem.

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

5

Exact dimensionality and Ledrappier-Young type dimension formula play a significant role in many of the recent advances in dimension theory of self-affine sets
and measures (see e.g. [2, 3, 4, 5, 6, 7, 8, 9, 18, 26, 39, 54, 61, 64]). In the remaining
part of this section, we will present some applications of Theorem 1.2 along the lines
of these developments.
The proof of Theorem 1.2 is based on some ideas from the work of Ledrappier
and Young [46]. It also adopts and extends some ideas used in [29, 4, 62] for the
construction of measurable partitions and the density estimates of associated conditional measures. Since our construction of measurable partitions is much different
from these works (see Remark 4.3), and the IFSs in consideration may be noninvertible and non-contractive, many estimates of conditional measures need to be
rebuilt or re-justified. A key part of our arguments is on the estimation of the
so-called “transverse dimension” of these conditional measures, where significant efforts are made to handle the situation when the linear parts of the IFS do not satisfy
any domination condition (in such case the angles of Oseledets subspaces may be
arbitrarily close to zero). Our strategy is to build an induced dynamics so that we
are able to focus on the trajectories where the angles of Oseledets subspaces are
larger than a positive constant.
1.2. Dimension formulas. Throughout this subsection, under the assumptions of
Theorem 1.2, we further assume that m is ergodic. We are going to present certain
dimension formulas for µ = π∗ m and related conditional measures.
First notice that in this ergodic case, the condition (3) in Definition 1.1 is equivalent to
Z
1
log kMx0 · · · Mxn−1 k dm(x) < 0.
(1.3)
λ := lim
n→∞ n
By Oseledets’ multiplicative ergodic theorem [55], there exist an integer
Ps1 ≤ s ≤ d,
numbers λ = λ1 > · · · > λs ≥ −∞, positive integers k1 , . . . , ks with i=1 ki = d,
and measurable linear subspaces
Rd = Vx0 ) Vx1 ) · · · ) Vxs = {0},

x ∈ Σ,

such that for m-a.e. x = (xn )∞
n=−∞ ,
(i) Mx−1 Vxi ⊂P
Vσi−1 x ;
i
(ii) dim Vx = sj=i+1 kj ;
(iii) limn→∞ n1 log kMx−n · · · Mx−1 vk = λi+1 for v ∈ Vxi \Vxi+1 .
When the matrices Mj (j ∈ Λ) are assumed to be invertible, then (i) becomes an
equality. It in general is a containment because Mj may be singular. The numbers
λ1 , . . . , λs are called the Lyapunov exponents of (Mj )j∈Λ with respect to m, and ki
the multiplicity of λi , i = 1, . . . , s. Recall that π(x) is well-defined for m-a.e. x.
Hence there exists a Borel set Σ′ ⊂ Σ with σ(Σ′ ) = Σ′ and m(Σ′ ) = 1 such that π
is well-defined on Σ′ and the above properties (i)-(iii) hold for x ∈ Σ′ .

6

DE-JUN FENG

We remark that these linear subspaces Vxi only depend on i and x− := (xj )−1
j=−∞
since by (i)-(iii), one has


1
i
d
Vx = v ∈ R : lim log kMx−n · · · Mx−1 vk ≤ λi+1 .
n→∞ n
Using this property, we construct a family of measurable partitions ξ0 , . . . , ξs of Σ′
as follows:
ξi (x) := {y ∈ Σ′ : y − = x− , πy − πx ∈ Vxi },
here ξi (x) is the ξi -atom that contains x (see Sections 2.2 and 4 for the details).
Moreover, let
(1.4)

P = {[j] ∩ Σ′ : j ∈ Λ}

be the canonical partition of Σ′ , where [j] := {x = (xn )∞
n=−∞ ∈ Σ : x0 = j}. Define
(1.5)

hi = Hm (P|ξbi ),

i = 0, . . . , s,

where Hm (·|·) stands for the conditional entropy and ξbi is the σ-algebra generated
by ξi (see Sections 2.1-2.2 for the definitions).

We remark that the spaces Vxi are strictly decreasing, Rd = Vx0 ) Vx1 ) · · · )
= {0}. Therefore, the partitions ξi become finer as i increases: the partition
ξ0 is the partition according to the “past” x− , then ξ1 is the partition according to
the past joined with the partition according to translations of Vxi , etc. Therefore hi
decrease with i, since hi+1 is conditioned on partition ξi+1 which is finer than the
partition ξi on which hi is conditioned.
Vxs

Now we are ready to present the dimension formula for π∗ m.
Theorem 1.3. Let S = {Mj x + aj }j∈Λ be an affine IFS on Rd and m be an ergodic
σ-invariant measure on Σ. Suppose that S is average contracting with respect to m.
Let µ = π∗ m. Then
(1.6)

dimH µ =

s−1
X
hi+1 − hi
i=0

λi+1

,

where hi are defined as in (1.5).
We remark that both the nominators and denominators in (1.6) are non-positive.
Next we give similar dimension formulas for certain conditional measures associated
with m. For i = 0, . . . , s, let {mξxi } be the system of conditional measures of m
associated with the partition ξi (cf. Section 2.2). For a linear subspace W of Rd , let
W ⊥ denote the orthogonal complement of W in Rd , and let PW : Rd → W denote
the orthogonal projection from Rd to W .
Theorem 1.4. Under the assumptions of Theorem 1.3, forany 0 ≤ i < j ≤ s and
m-a.e. x ∈ Σ′ , the push-forward measures π∗ (mξxi ), P(V j )⊥ π ∗ (mξxi ) of mξxi are exact
x

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

7

dimensional with
s−1
 X
hℓ+1 − hℓ
dimH π∗ (mξxi ) =
,
λ
ℓ+1
ℓ=i

(1.7)
(1.8)

dimH



P(V j )⊥ π
x



(mξxi )
∗



=

(1.9)

dimloc





P(V j )⊥ π ∗ m, P(V j )⊥ (πx) =
x

λℓ+1

ℓ=i

Moreover, for m-a.e. x ∈ Σ′ and any 1 ≤ j ≤ s,


j−1
X
hℓ+1 − hℓ

x

,

j−1
X
hℓ+1 − hℓ
ℓ=0

λℓ+1

.

From the above theorem,
 we can deduce certain dimension conservation property
for the measures π∗ mξx0 and µ. To state the result, let G(d, k) denote the Grassmannian manifold of k-dimensional linear subspaces of Rd . For a Borel probability
measure η on Rd and W ∈ G(d, k), let {ηW,z = ηzζW }z∈Rd denote the the system of
conditional measures of η associated with the measurable partition ζW given by
ζW = {W + a : a ∈ W ⊥ }.
These conditional measures are also called the slicing measures of η along the subspace W (cf. [50, §10.1]). Following Furstenberg [34], we give the following.
Definition 1.5. A measure η is said to be dimension conserving with respect to the
projection PW ⊥ , if
dimH η = dimH ηW,z + dimH ((PW ⊥ )∗ η)
for η-a.e. z ∈ Rd .
For i ∈ {0, . . . , s − 1}, define Πi : Σ′ → G(d,
(1.10)

Ps

j=i+1

kj ) by

Πi (x) = Vxi .

The push-forward measures (Πi )∗ m, i = 1, . . . , s − 1, are called the Furstenberg
measures or Furstenberg-Oseledets measures associated with (Mj )j∈Λ and m. An
ergodic measure ν ∈ Mσ (Σ) is said to be quasi-Bernoulli if there exists a positive
constant C such that
C −1 ν([I])ν([J]) ≤ ν([IJ]) ≤ Cν([I])ν([J])
for any finite words I, J over Λ, where
[I] := {x ∈ Σ : xj = ij for 0 ≤ j ≤ n − 1}
for I = i0 . . . in−1 . Similarly, we say that ν is sub-multiplicative if there exists a
positive constant C such that ν([IJ]) ≤ Cν([I])ν([J]) for any finite words I, J over
Λ.
Theorem 1.6. Under the assumptions of Theorem 1.3, we further assume that
s ≥ 2. Let i ∈ {1, . . . , s − 1}. Then the following statements hold.

8

DE-JUN FENG


(i) For m-a.e. x ∈ Σ′ , π∗ mξx0 is dimension conserving with respect to P(Vxi )⊥


and moreover, the projected measure P(Vxi )⊥ π ∗ mξx0 is exact dimensional,


and so are the slicing measures π∗ mξx0 V i ,y for π∗ mξx0 -a.e. y.
x
(ii) Assume that m is quasi-Bernoulli. Then for (Πi )∗ m-a.e. W , µ is dimension conserving with respect to PW ⊥ , and moreover, the associated projected
measure and almost all slicing measures are exact dimensional.
(iii) Assume that m is sub-multiplicative. Then for (Πi )∗ m-a.e. W , there exists
a subset AW of Rd with µ(AW ) > 0 such that for every z ∈ AW ,
dimloc (µW,z , z) =

s−1
X
hℓ+1 − hℓ
ℓ=i



PW ⊥ ∗ µ, PW ⊥ (z) =

λℓ+1

,

i−1
X

hℓ+1 − hℓ
,
λℓ+1
ℓ=0


and so, dimH µ = dimloc (µW,z , z) + dimloc PW ⊥ ∗ µ, PW ⊥ (z) . When m is
quasi-Bernoulli then one can take the set AW such that µ(AW ) = 1.
dimloc

We remark that part (ii) of Theorem 1.6 was previously proved in [4] under the assumptions that S is contracting, invertible and its linear parts satisfy certain domination condition. According to part (iii) of the theorem, when m is sub-multiplicative,
µ partially satisfies dimension conservation. It is unknown whether part (ii) always holds when m is only assumed to be ergodic. However, as is illustrated in the
following theorem, this is true in the special case that the linear parts of the IFS
commute.
Theorem 1.7. Let S = {Mj x + aj }j∈Λ be an affine IFS on Rd , average contracting
with respect to an ergodic m ∈ Mσ (Σ). Let µ = π∗ m. Assume s ≥ 2 and in
addition that Mj Mj ′ = Mj ′ Mj for j, j ′ ∈ Λ. Then for i ∈ {1, . . . , s − 1}, Vxi is
constant m-a.e., denoted by Wi , moreover, µ is dimension conserving with respect
to P(Wi )⊥ .
It is worth pointing out that if µ is a contracting self-similar measure in Rd with
a finite rotation group, then for each proper subspace W of Rd , µ is dimension conserving with respect to PW . The result is due to Falconer and Jin [25]. Under an
additional assumption of the strong separation condition, this result can be alternatively derived from a general result of Furstenberg (cf. [34, Theorem 3.1]). We
remark that this dimension conservation property also extends to ergodic invariant measures for rotation-free self-similar IFSs (see Remark 6.3). However, as was
proved by Rapaport [63], this dimension conservation actually can fail for some selfsimilar measures with infinite rotation groups. Finally we remark that Theorems
1.6-1.7 can be applied to analyze slices and projections of certain self-affine sets (see
Remark 7.5).
1.3. Semi-continuity of dimension and applications. Here we present a semicontinuity result on the dimension of ergodic invariant measures for affine IFSs and

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

9

give its application to the dimension of self-affine sets. Again let S = {Mi x + ai }i∈Λ
be an affine IFS on Rd , average contracting with respect to an ergodic invariant
measure m on Σ. Write a = (ai )i∈Λ . To emphasize the dependence on a, let πa
be the coding map associated to S and let hi,a (i = 1, . . . , s) be the conditional
entropies of m defined in (1.5). Then we have the following.
Theorem 1.8.
(1) The mapping a 7→ hi,a is upper semi-continuous for each
i ∈ {1, . . . , s}.
(2) Moreover, the mapping a 7→ dimH ((πa )∗ m) is lower semi-continuous.
Part (1) of the above result was first proved by Rapaport [64, Lemma 8] in the
case when m is a Bernoulli product measure and S is invertible and contracting.
Part (2) was shown by Hochman and Shmerkin [38] for a special class of self-similar
measures on R. In Remark 8.2 we give a further extension of Theorem 1.8.
Below we present an application of Theorem 1.8 to the dimension of self-affine
sets and associated stationary measures. For this purpose, in the remaining part
of this subsection we assume that kMj k < 1 for j ∈ Λ and write M = (Mj )j∈Λ .
Let K(M, a) be the self-affine set generated by the IFS S = {Mj x + aj }j∈Λ . In
1988, Falconer [21] introduced a quantity associated to M, nowadays usually called
the affinity dimension dimAFF (M), which is always an upper bound for the upper
box-counting dimension of K(M, a), and such that when kMj k < 1/2 for all j, then
for Ld|Λ| -a.e. a, dimH K(M, a) = min(d, dimAFF (M)). In fact, Falconer proved this
with 1/3 as the upper bound on the norms; it was subsequently shown by Solomyak
[70] that 1/2 suffices.
The analogue of affinity dimension for measures is the Lyapunov dimension, which
we denote dimLY (m, M); see Section 7 for its definition. In [42], Jordan, Pollicott
and Simon proved that the Lyapunov dimension dimLY (m, M) is always an upper
bound for the Hausdorff dimension of (πa )∗ m, and moreover when kMj k < 1/2 for
all j, then for Ld|Λ| -a.e. a, dimH ((πa )∗ m) = min(d, dimLY (m, M)).
Recall a set in a topological space is said to be of first category if it can be written
as the countable union of nowhere dense subsets. As an application of Theorem 1.8,
we get the following result.
Theorem 1.9. Suppose that kMj k < 1/2 for j ∈ Λ. Then the following hold.
(i) For every ergodic σ-invariant measure m on Σ, the exceptional set

a ∈ Rd|Λ| : dimH ((πa )∗ m) 6= min(d, dimLY (m, M))

is of first category in Rd|Λ| .
(ii) The exceptional set

a ∈ Rd|Λ| : dimH K(M, a) 6= min(d, dimAFF (M))
is of first category in Rd|Λ| .

The above result says that these exceptional sets are also small in a topological
sense. A fundamental and challenging question is to specify those translation vectors

10

DE-JUN FENG

not lying in the exception sets. Significant progresses have been made recently in
[2, 26, 4, 64], showing that under certain additional assumptions, the Hausdorff
and Lyapunov dimensions of a self-affine measure (or more generally, the pushforward of a quasi-Bernoulli measure) coincide if the involved Furstenberg measures
have enough large dimension. In next theorem we will drop off some redundant
assumptions used in these works and further extend the result to the push-forward
measures of ergodic sub-multiplicative measures.
Recall that for a Borel probability measure η on a metric space, its upper Hausdorff
dimension dim∗H η is the smallest Hausdorff dimension of a Borel set F of η measure
1. Set d0 = 0 and dℓ = k1 + · · · + kℓ for 1 ≤ ℓ ≤ s.
Theorem 1.10. Let S = {Mj x+ aj }j∈Λ be a contracting affine IFS on Rd satisfying
the strong separation condition and m ∈ Mσ (Σ) be ergodic and sub-multiplicative.
Let i be the unique element in {1, . . . , s} so that di−1 ≤ dimLY (m, M) < di . Then
(1.11)

dimH (π∗ m) = dimLY (m, M)

provided one of the following conditions holds:
(a) s = 1.
(b) i = s > 1, λs 6= −∞ and
(1.12)

dim∗H ((Πs−1 )∗ m) + dimLY (m, M) ≥ ds−1(d − ds−1 + 1).

(c) 1 ≤ i ≤ s − 1, and
(1.13)

dim∗H ((Πi )∗ m) − dimLY (m, M) ≥ di (d − di − 1),

(1.14)

dim∗H ((Πi−1 )∗ m) + dimH (π∗ m) ≥ di−1 (d − di−1 + 1).

The conditions (b), (c) in the above theorem were introduced in [64] and [4],
respectively, in slightly stronger forms. For a contracting invertible affine IFS, Rapaport [64] proved the implication (b)⇒ (1.11) in the case when m is Bernoulli
and (Mj )j∈Λ satisfies an irreducibility assumption; whilst Bárány and Käenmäki [4]
proved (1.11) under the assumptions that the conditions (1.13)-(1.14) hold for all
i ∈ {1, . . . , s − 1}, m is Bernoulli and d = 2, or m is quasi-Bernoulli and {Mj }j∈Λ
satisfies a domination condition.
We remark that (1.14) always holds whenever i = 1, since d0 = 0. It is worth
pointing out that for every affine IFS S = {Mj x + aj }j∈Λ on Rd , there exists at
least one ergodic m ∈ Mσ (Σ), called Käenmäki measure, so that dimLY (m, M) =
dimAFF (M). This was first proved by Käenmäki [43] in the case when S is invertible,
and it extends to the general case by the sub-additive thermodynamic formalism [17].
Very recently, Bochi and Morris [13] showed that whenever S is invertible, each
Käenmäki measure is sub-multiplicative. Hence for an invertible S satisfying the
strong separation condition, if one of the conditions (a)-(c) in Theorem 1.10 fulfills
for some Käenmäki measure m, then dimH K(M, a) = dimAFF (M) = dimH (π∗ m).
To check the conditions (b)-(c) in Theorem 1.10, one needs to estimate the (upper) Hausdorff dimension of Furstenberg measures (Πi )∗ m. So far there have been
only a few dimensional results on these measures. In the case d = 2, Hochman
and Solomyak [39] calculated the Hausdorff dimension of Furstenberg measures for

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

11

Bernoulli m under some mild assumptions. In [8, Sect. 2.4], Bárány, Rams and Simon determined the Hausdorff dimension of Furstenberg measures for some special
triangular affine IFSs in Rd , in which m could be any ergodic measure.
We remark that the conditions of Theorem 1.10 might not be sharp. Very recently, Bárány, Hochman and Rapaport [3] made a significant progress in dimension
theory of affine IFSs, showing that the Hausdorff and affinity dimensions of a planar
self-affine set coincide under the strong separation condition and certain irreducibility assumption; and similarly, the Hausdorff and Lyapunov dimensions of a planar
self-affine measure coincide under the same assumptions. In [37], Hochman and Rapaport further showed that the strong separation condition can be replaced by the
exponential separation condition, which is substantially weaker.
1.4. Organization of the paper. The paper is organized as follows. In Section 2,
we provide some density results about conditional measures, and present a version of
Oseledets’s multiplicative ergodic theorem due to Froyland et al. [33]. In Section 3,
we give some auxiliary results on the coding maps for average contracting affine IFSs.
In Section 4, we construct a finite family of measurable partitions of Σ for a given
average contracting affine IFS and give some necessary properties. In Section 5
we prove an inequality for the transverse dimensions of the conditional measures
associated with these measurable partitions. In Section 6, we prove Theorems 1.21.4, 1.6-1.7. In Section 7, we give some properties of Lyapunov dimension. In
Section 8, we prove Theorems 1.8-1.10.
2. Preliminaries
2.1. Conditional information and entropy. Let (X, B, m) be a probability space.
For a sub-σ-algebra A of B and f ∈ L1 (X, B, m), we denote by Em (f |A) the the
conditional expectation of f given A. For a countable B-measurable partition ξ of
X, we denote by Im (ξ|A) the conditional information of ξ given A, which is given
by the formula
X
(2.1)
Im (ξ|A) = −
χA log Em (χA |A),
A∈ξ

where χA is the characteristic function on A. The conditional entropy of ξ given A,
written as Hm (ξ|A), is defined by the formula
Z
Hm (ξ|A) = Im (ξ|A) dm.

(See e.g. [57, 71] for more details.) The above information and entropy are unconditional when A = N , the trivial σ-algebra consisting of sets of measure zero and
one, and in this case we write
Im (ξ|N ) =: Iν (ξ) and Hm (ξ|N ) =: Hm (ξ).

For a countable partition ξ, we use ξb to denote the σ-algebra generated by ξ. If ξ
is an uncountable measurable partition of X (which will be defined in Section 2.2),
ξb is defined as the sub-σ-algebra of B whose sets are ξ-saturated (i.e. unions of

12

DE-JUN FENG

W
elements in ξ). If ξ1 ,. . . , ξn are countable partitions, then ξ1 ∨ · · · ∨ ξn = ni=1 ξi
denotes the partition consists of the sets W
A1 ∩ · · · ∩ An with Ai ∈ ξi . Similarly for
σ-algebras A1 , A2 ,. . . , A1 ∨ A2 ∨ · · · or i Ai denotes the σ-algebra generated by
S
i Ai .

In the following lemma, we list some basic properties of the (conditional) expectation, information and entropy. The reader is referred to [57, pages 20-21 and 38]
for details.

Lemma 2.1. Let T be a measure-preserving transformation of a separable probability
space (X, B, m). Let ξ, η be two countable Borel partitions of X with Hm (ξ) < ∞,
Hm (η) < ∞, and A a sub-σ-algebra of B. Then we have
(i)
(ii)
(iii)
(iv)
(v)

Em (f |A) ◦ T = Em (f ◦ T |T −1A) for f ∈ L1 (X, B, m).
Im (ξ|A) ◦ T = Im (T −1 ξ|T −1A).
Im (ξ ∨ η|A) = Im (ξ|A) + Im (η|ξb ∨ A).
Hm (ξ ∨ η|A) = Hm (ξ|A) + Hm (η|ξb ∨ A).
If A1 ⊂ A2 ⊂ · · · is an increasing sequence of sub-σ-algebras with An ↑ A,
then supn Im (ξ|An) ∈ L1 , and Im (ξ|An ) converges almost everywhere and in
L1 to Im (ξ|A). In particular, limn→∞ Hm (ξ|An) = Hm (ξ|A).

For the convenience of the reader, below we state an almost trivial property of
the conditional expectation. For a proof, see e.g. [29, Lemma 3.10].
Lemma 2.2. Let (X, B, m) be a probability space and A a sub-σ-algebra of B. Let
A ∈ B with m(A) > 0. Then
Em (χA |A)(x) > 0
for m-a.e. x ∈ A.
The following lemma is a variant of Maker’s ergodic theorem ([49]).
Lemma 2.3 ([48], Corollary 1.6, p. 96). Let T be a measure-preserving transformation of a probability space (X, B, m). Let gk ∈ L1 (X, B, m) be a sequence that
converges almost everywhere and in L1 to g ∈ L1 (X, B, m). Then
k−1

1X
gk−j (T j x) = Em (g|I)(x)
lim
k→+∞ k
j=0

almost everywhere and in L1 , where I = {B ∈ B : T −1 (B) = B}.
2.2. Conditional measures. Here we give a brief introduction to Rohlin’s theory
of Lebesgue spaces, measurable partitions and conditional measures. The reader is
referred to [65, 56, 20] for more details.
A probability space (X, B, m) is called a Lebesgue space if it is isomorphic (mod 0)
to a probability space which is the union of [0, s] for some s ∈ [0, 1] with Lebesgue
measure and a finite or countable number of atoms. Now let (X, B, m) be a Lebesgue
space. A measurable partition η of X is a partition of X such that, up to a set
of measure zero, the quotient space X/η is separated by a countable number of

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

13

measurable sets {Bi }. The quotient space X/η with its inherited probability space
structure, written as (Xη , Bη , mη ), is again a Lebesgue space. Also, any measurable
partition η determines a sub-σ-algebra of B, denoted by ηb, whose elements are unions
of elements of η. Conversely, any sub-σ-algebra B′ of B is also countably generated,
say by {Bi′ }, and therefore all the sets of the form ∩Ai , where Ai = Bi′ or its
complement, form a measurable partition. In particular, B itself is corresponding
to a partition into single points. An important property of Lebesgue spaces and
measurable partitions is the following.
Theorem 2.4 (Rohlin [65]). Let η be a measurable partition of a Lebesgue space
(X, B, m). Then, for every x in a set of full m-measure, there is a probability measure
mηx defined on η(x), the element of η containing x. These measures are uniquely
characterized (up to sets of m-measure 0) by the following properties:
R if A ⊂ X is
a measurable set, then x 7→ mηx (A) is ηb-measurable and m(A) = mηx (A)dm(x).
1
η
These properties imply
η)(x) for mR that for any f ∈ L (X, B, m), mx (f ) = Em (f |b
a.e. x, and m(f ) = Em (f |b
η)dm.
The family of measures {mηx } in the above theorem is called the canonical system
of conditional measures associated with η.

Throughout the remaining part of this subsection, we assume that (X, B, m) is a
Lebesgue space. Suppose that Y is a complete separable metric space and π : X → Y
is a B-measurable map. Let B(Y ) denote the Borel-σ-algebra on Y .
According to Rohlin’s theory (cf. [65, Section 2.5], [56, Chapter IV]), the mapping
π induces a measurable partition
ξ = {π −1 (y) : y ∈ Y }

(2.2)

of X with ξb = π −1 B(Y ) (mod 0), and (Xξ , Bξ , mξ ) is isomorphic (mod 0) to (Y, B(Y ), π∗ m).
The system of conditional measures {mξx } is also called the disintegration of m with
respect to π.
For y ∈ Y , we use B(y, r) to denote the closed ball in Y of radius r centered at
y. Moreover we write for x ∈ X,
B π (x, r) = π −1 B(πx, r).

(2.3)

Furthermore, we say that Y is a Besicovitch space if Y is a complete separable
metric space and the Besicovich covering lemma (see e.g. [50]) holds in Y . Besicovich spaces include, for instance, Euclidean spaces, compact finite-dimensional
Riemannian manifolds and complete separable ultrametric spaces.
Lemma 2.5. Let π : X → Y be a measurable mapping from a Lebesgue space
(X, B, m) to a Besicovitch space Y . Let η be a measurable partition of X. Then the
following properties hold.
(1) Let A ∈ B. Then for m-a.e. x ∈ X,
mηx (B π (x, r) ∩ A)
= Em (χA |η̂ ∨ π −1 B(Y ))(x).
η
π
r→0
mx (B (x, r))
lim

14

DE-JUN FENG

(2) Let α be a finite or countable measurable partition of X. Then for m-a.e. x ∈
X,

mη (B π (x, r) ∩ α(x))
= −Im α|η̂ ∨ π −1 B(Y ) (x).
lim log x η π
r→0
mx (B (x, r))
Furthermore, set

mηx (B π (x, r) ∩ α(x))
g(x) = − inf log
r>0
mηx (B π (x, r))
and assume Hm (α) < ∞. Then g ≥ 0 and g ∈ L1 (X, B, m).
Proof. These properties have been proved in [29, Lemma 3.3, Proposition 3.5] in the
case when Y = Rd . The proofs there remain valid for the general case when Y is a
Besicovitch space.

ˆ
Remark 2.6. In the above lemma,
wehave Em (χA |η̂ ∨ π −1 B(Y )) = Em (χA |η̂ ∨ ξ)

and Im (α|η̂ ∨ π −1 B(Y )) = Im α|η̂ ∨ ξˆ m-a.e., where ξ is given by (2.2). This is
because ξb = π −1 B(Y ) (mod 0).
Definition 2.7. Two probability measures m1 and m2 on a measurable space (X, B)
are said to be strongly equivalent if there exists a positive constant C such that
C −1 m1 (A) ≤ m2 (A) ≤ Cm1 (A) for all A ∈ B.

Lemma 2.8. Let π : X → Y be a measurable mapping from a Lebesgue space
(X, B, m1 ) to a Besicovitch space Y . Let ξ be the measurable partition of X given
in (2.2). Suppose m2 is another probability measure on (X, B) strongly equivalent
to m1 . Then for m1 -a.e. x, (m1 )ξx and (m2 )ξx are strongly equivalent.
Proof. It is a direct consequence of the following standard result (see, e.g. [47,
Proposition 6.1]): Let α be a measurable partition of a Lebesgue space (X, B, m)
and ν another probability measure on B which is absolutely continuous with respect
to m. Then for ν-a.e.x, the conditional measure νxα is absolutely continuous with
respect to mαx on α(x) and
g|α(x)
dνxα
=R
,
α
dmx
g dmαx
α(x)

where g := dν/dm.



Lemma 2.9. Let π : X → Y be a measurable mapping from a Lebesgue space
(X, B, m) to a Besicovitch space Y . Let ξ be the measurable partition of X given in
(2.2). Suppose A ∈ B with m(A) > 0 and let mA be the probability measure given
by mA (E) = m(A ∩ E)/m(A) for E ∈ B. Then for m-a.e. x ∈ A, (mA )ξx = (mξx )A ,
that is,
mξx (A ∩ E)
ξ
for all E ∈ B.
(mA )x (E) =
mξx (A)
Proof. Again it is a direct consequence of [47, Proposition 6.1].



DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

15

2.3. Induced transformations. Let (X, B, m, T ) be an invertible measure-preserving
system. Fix N ∈ N and F ∈ B with m(F ) > 0. By the Poincaré recurrence theorem,
the first return map to F associated with T N , defined by
rF (x) = inf{n ≥ 1 : T N n (x) ∈ F },
exists almost everywhere. The map TF : F → F defined almost everywhere by
TF (x) = T N rF (x) (x)
is called the transformation induced by T N on the set F .
For n ≥ 1, set Fn = {x ∈ F : rF (x) = n}. Write
B|F := {B ∩ F : B ∈ B},

mF :=

1
m|F ,
m(F )

where m|F stands for the restriction of m on F , that is, m|F (B) = m(B ∩ F )
for B ∈ B. The following result is well-known (see e.g. [20, pp. 61-63] and [60,
pp. 257-258] for a proof).
Lemma 2.10.
(i) The induced transformation TF is a measure-preserving transformation on the space (F, B|F , mF ).
(ii) The family of sets {T N j Fn }n≥1, 0≤j≤n−1 are disjoint, and hence
∞
X

n m(Fn ) ≤ 1.1

n=1

(iii) −

∞
X

m(Fn ) log m(Fn ) < ∞.

n=1

Set I = {B ∈ B : T −1 (B) = B} and IF := {B ∈ B|F : (TF )−1 (B) = B}. Recall
that N is a fixed positive integer and rF is the first return map to F with respect
to T N . The following result will be needed in the proof of Theorem 1.2.
P rF (x)−1
Lemma 2.11. Let g ∈ L1 (X, B, m). Set G(x) = N
g(T j x) for x ∈ F . Then
j=0
G ∈ L1 (F, B|F , mF ). Moreover,
(2.4)

NEm (g|I)(x) =

EmF (G|IF )(x)
EmF (rF |IF )(x)

for m-a.e. x ∈ F .
1This

is actually an equality in the ergodic case, but since we consider also non-ergodic measures,
there is only an inequality.

16

DE-JUN FENG

Proof. First notice that
Z

F

∞

1 X
|G| dmF =
m(F ) n=1

Z

|G| dm
Fn

∞ N n−1 Z
1 X X
≤
|g ◦ T p | dm
m(F ) n=1 p=0 Fn

∞ N n−1 Z
1 X X
|g| dm (since T is invertible and preserves m)
=
m(F ) n=1 p=0 T p Fn
∞ N −1 n−1

1 XXX
=
m(F ) n=1 k=0 j=0

Z

|g| dm

T Nj+k Fn

N −1 ∞ n−1 Z
1 X XX
=
|g| dm
m(F ) k=0 n=1 j=0 T Nj+k Fn
Z
N
≤
|g| dm,
m(F ) X

where in the last inequality we have used the fact that for any k, the sets in the
collection {T N j+k Fn : n ∈ N, 0 ≤ j ≤ n − 1} are disjoint (see Lemma 2.10(ii)).
Hence G ∈ L1 (mF ). Below we prove (2.4).
Consider the sequence of integer-valued functions (nk (x))∞
k=0 , which are defined
on F almost everywhere by n0 (x) = 0, and
nk (x) =

k−1
X

rF (TFj x)

for k ≥ 1,

j=0

where TFj := (TF )j . Clearly, nk (x) ≥ k and TFk (x) = T N nk (x) (x). Hence,
k−1
X

j

G(TFj x) =

j=0

(TF x)−1
k−1 N rF X
X

g(T p(TFj x))

p=0

j=0

j

=

(TF x)−1
k−1 N rF X
X
p=0

j=0

=

(x)−1
k−1 N nj+1
X
X
j=0

g(T N nj (x)+p x)

g(T ℓ x)

ℓ=N nj (x)

N nk (x)−1

=

X
i=0

g(T i x).

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

17

By the Birkhoff ergodic theorem, we have
k−1

(2.5)

1
1 X
G(TFj x) = lim
lim
k→+∞ nk (x)
k→+∞ nk (x)
j=0

N nk (x)−1

= NEm (g|I)(x)

X

g(T i x)

i=0

for m-a.e. x ∈ F . Applying the Birkhoff ergodic theorem again, we have
k−1

1X
G(TFj x) = EmF (G|IF )(x)
lim
k→+∞ k
j=0

and

k−1

nk (x)
1X
rF (TFj x) = EmF (rF |IF )(x)
= lim
k→+∞
k→+∞ k
k
j=0
lim

for m-a.e. x ∈ F . Here we have used the fact that rF ∈ L1 (F, B|F , mF ), which
follows directly from Lemma 2.10(ii). Taking quotient we get
k−1

1 X
G(TFj x) = EmF (G|IF )(x)/EmF (rF |IF )(x)
k→+∞ nk (x)
j=0
lim

for m-a.e. x ∈ F . Combining this with (2.5) yields (2.4).



2.4. Oseledets’ multiplicative ergodic theorem. For x, y ∈ Rd \{0}, let ∡(x, y)
denote the angle between the lines ℓx and ℓy , where ℓx stands for the line in Rd
passing through the origin and x. In such definition, we always have ∡(x, y) ∈
[0, π/2] and
(kxk2 kyk2 − hx, yi2)1/2
,
sin ∡(x, y) =
kxkkyk
where h·, ·i is the standard inner product in Rd . Similarly the angle between linear
subspaces U, V of Rd with U ∩ V = {0} is defined by
sin ∡(U, V ) =

inf

x∈U \{0}, y∈V \{0}

sin ∡(x, y).

We will require the following version of Oseledets’ multiplicative ergodic theorem,
due to Froyland et al. [33, Theorem 4.1]:
Theorem 2.12. Let T be an invertible measure-preserving transformation of the
Lebesgue space (X, B, m). Let M : X → Matd (R) be a measurable function such
that
Z
log+ kM(x)k dm(x) < ∞.

Then there exists a measurable set X ′ ⊆ X with T (X ′ ) = X ′ and m(X ′ ) = 1,
such that for each x ∈ X ′ , there are positive integers s(x), k1 (x), . . . , ks(x)(x) with
k1 (x) + · · · + ks(x) (x) = d, numbers λ1 (x) > · · · > λs(x) (x) ≥ −∞ and a splitting
s(x)
Rd = Ex1 ⊕ · · · ⊕ Ex so that the following hold.
(i) dim Exi = ki (x).
(ii) M(x)Exi ⊆ ETi x (with equality if λi (x) > −∞).

18

DE-JUN FENG

(iii) For 1 ≤ i ≤ s(x) and v ∈ Exi \{0},
1
lim log kM(T n−1 x) · · · M(x)vk = λi (x),
n→∞ n
with uniform convergence on any compact subset of Exi \{0}.
(iv) For 1 ≤ i ≤ s(x),
1
max
log kM(T −1 x) · · · M(T −n x)vk
lim
n→∞ n v∈E i
, kv||=1
T −n x
1
min
log kM(T −1 x) · · · M(T −n x)vk = λi (x).
n→∞ n v∈E i
,
kv||=1
T −n x

= lim

1
log ∡(⊕i∈I ETi n x , ⊕j∈J ETj n x ) = 0 whenever I ∩ J = ∅,
n
(vi) The function s : X ′ → N is measurable and T -invariant.
(vii) The mappings x 7→ λi (x), Exi , ki (x) are measurable on {x : s(x) ≥ i}, and
λi (T x) = λi (x), ki (T x) = ki (x).
(v) lim

n→±∞

Remark 2.13.
(1) Theorem 2.12 is only stated in [33] for the case when m is ergodic. It extends directly to the general case by using ergodic decomposition.
When M(x) is invertible for all x this is the classic Oseledets’ multiplicative
ergodic theorem, but we emphasize that the above is valid even in the noninvertible case (in which case the usual statements of Oseledets’ theorem
only provide a flag and not a splitting).
(2) The uniform convergence in part (iii) of Theorem 2.12 is not stated in [33].
However it is well-known when A takes values in GL(R, d), and the argument
works also in the general case of Matd (R)-valued cocycles. See e.g. [31,
p. 1111] for a sketched proof. Part (iv) of Theorem 2.12 was only implicitly
included in the proof of [33, Theorem 4.1].
(3) The numbers λ1 (x), . . . , λs(x) (x) are called the Lyapunov exponents of M at
x with respect to m. The number ki (x) is called the multiplicity of λi (x).
Moreover, {(λi (x), ki (x))}1≤i≤s(x) is called the Lyapunov spectrum of (M, m)
over X ′ .
L
d
i
i
(4) The decomposition s(x)
i=1 Ex is called the Oseledets splitting of R , and Ex ,
1 ≤ i ≤ s(x), are called the Oseledets subspaces.
3. Canonical coding maps for average contracting affine IFSs
For z ≥ 0, write log+ z = max{0, log z} and log− z = max{0, − log z}, with the
convention log 0 = −∞. In this section, we prove the following proposition, which
will be used in the proof of our main result.
Proposition 3.1. Let S = {Sj (x) = Mj x + aj }j∈Λ be an affine IFS on Rd and m ∈
Mσ (Σ). Suppose that S is average contracting with respect to m. Let π : Σ → Rd be
given by (1.2). Then there exists a Borel set E ⊂ Σ with σ(E) = E and m(E) = 1
such that for any x = (xn )∞
n=−∞ ∈ E,

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

19

(i) π(x) is well-defined, i.e. the limit in defining π(x) in (1.2) exists and is finite.
(ii) Sx0 (πσx) = π(x).
(iii) limn→∞ n1 log+ kπ(σ n x)k = 0.
Part (i) of the above proposition was first proved by Brandt [16] in the special
case when m is a Bernoulli product measure, and it was then extended by Bougerol
and Picard [14] to the general case when m is ergodic. For the convenience of the
reader, we shall provide a self-contained proof of part (i).
Before proving Proposition 3.1, we shall first prove the following auxiliary result,
which is a variant of Proposition 2.1 in [30].
Proposition 3.2. Let T : X → X be an ergodic measure-preserving transformation on a probability space (X, B, m). Let {fn }∞
n=1 be a sequence of non-negative
+
measurable functions on X such that log f1 ∈ L1 (m) and
fn+k (x) ≤ fn (x)fk (T n x)
R
for all n, k ∈ N and x ∈ X. Set λ = limn→∞ (1/n) log fn dm. Then for any ǫ > 0,
the following properties hold:
(3.1)

(i) If λ 6= −∞, then for m-a.e. x ∈ X, there exists a positive integer n0 (x) such
that

(3.2)

| log fn (T k x) − nλ| ≤ (n + k)ǫ

for all n ≥ n0 (x) and k ≥ 0.
(ii) If λ = −∞, then for any N > 0 and m-a.e. x ∈ X, there exists a positive
integer n0 (x) such that
(3.3)

log fn (T k x) ≤ −Nn + (n + k)ǫ
for all n ≥ n0 (x) and k ≥ 0.

Proof.
the arguments of [30, Proposition 2.1]. By sub-additivity,
R Here we modify
R
+
λ ≤ log f1 dm ≤ log f1 dm < ∞. Below we first prove (i).

Assume that λ 6= −∞. We first prove that log fj ∈ L1 (m) for each j ∈ N. To see
this, observe that by (3.1),
+

log fj ≤

j−1
X

log+ (f1 ◦ T k ) ∈ L1 (m).

k=0

It remains to show that log− fj ∈ L1 (m). Suppose this is not true, then
Z
Z
log fj dm = log+ fj − log− fj dm = −∞,

so by the sub-additivity of {fn },

1
λ = inf
k k

Z

log fk dm = −∞,

leading to a contradiction. This proves that log fj ∈ L1 (m) for each j.

20

DE-JUN FENG

Next let ǫ > 0 and take 0 < δ < ǫ/6. By the Kingman’s sub-additive ergodic
theorem, for m-a.e. x ∈ X there exists n1 (x) such that
| log fn (x) − nλ| ≤ nδ

for all n ≥ n1 (x).

Setting n2 (x) := max1≤j≤n1 (x) | log fj (x) − jλ|/δ, we see that n2 (x) < ∞ a.e. and
| log fk (x) − kλ| ≤ (n2 (x) + k)δ

(3.4)

for all k ∈ N.

Hence by (3.1) and (3.4), for every n ≥ n2 (x) and k ≥ 0 we have
log fn (T k x) ≥ log fn+k (x) − log fk (x)



≥ (n + k)λ − (n2 (x) + n + k)δ − kλ + (n2 (x) + k)δ

(3.5)

= nλ − (2n2 (x) + n + 2k)δ
≥ nλ − (n + k)ǫ.

To see the opposite inequality, take ℓ large enough such that |β − λ| < δ, where
Z
1
log fℓ dm.
β :=
ℓ

Applying the Birkhoff ergodic theorem to the integrable functions log fj (j = 1, . . . , 2ℓ),
we obtain
1
(3.6)
lim log fj (T p x) = 0 for 1 ≤ j ≤ 2ℓ and m-a.e. x.
p→∞ p
Let n ≥ 2ℓ and x ∈ X. Write n = qℓ + s with ℓ ≤ s ≤ 2ℓ − 1. By submultiplicativity, we have
!
q−1
Y
fn (x) ≤ fj (x)
fℓ (T pℓ+j x) fs−j (T qℓ+j x), j = 0, 1, . . . , ℓ − 1,
p=0

where we take the convention that f0 ≡ 1. Taking product of these inequalities
yields
! qℓ−1
! ℓ−1
!
ℓ−1
Y
Y
Y
(fn (x))ℓ ≤
fj (x)
fℓ (T p x)
fs−j (T qℓ+j x) ,
p=0

j=0

j=0

so for k ≥ 0,

(fn (T k x))ℓ ≤

ℓ−1
Y
j=0

fj (T k x)

!

qℓ+k−1

Y

p=k

fℓ (T p x)

!

ℓ−1
Y
j=0

!

fs−j (T qℓ+k+j x) .

Taking logarithm and dividing both sides by ℓ we have
!
!
k−1
n+k−s−1
X
X 1
1
log fℓ (T i x) −
log fℓ (T i x) + Λ1 + Λ2 ,
(3.7) log(fn (T k x)) ≤
ℓ
ℓ
i=0
i=0
Pℓ−1 1
Pℓ−1 1
log fj (T k x), Λ2 := j=0
log fs−j (T qℓ+k+j x).
where Λ1 := j=0
ℓ
ℓ

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

21

Similar to (3.4), by using the Birkhoff ergodic theorem and (3.6), we see that
for m-a.e. x there exists n3 (x) such that for every n ≥ n3 (x) and every k ≥ 0 and
1 ≤ j ≤ 2ℓ,
n+k−s−1
X
i=0

k−1
X
i=0

1
log fℓ (T i x) − (n + k − s)β ≤ (n + k − s)δ,
ℓ

1
log fℓ (T i x) − kβ ≤ (n3 (x) + k)δ,
ℓ

| log fj (T k x)| ≤ (n3 (x) + k)δ,
where the third inequality implies that Λ1 ≤ (n3 (x) + k)δ and
Λ2 ≤ (n3 (x) + qℓ + k + ℓ − 1)δ ≤ (n3 (x) + n + k)δ.
Applying the above inequalities to (3.7), we see that for m-a.e. x ∈ X, for every
n ≥ n3 (x) and every k ≥ 0,
log fn (T k x) ≤ (n + k − s)(β + δ) − (kβ − (n3 (x) + k)δ) + (n3 (x) + k)δ
+ (n3 (x) + n + k)δ
= (n − s)β + (2n + 4k + 3n3 (x) − s)δ
≤ nλ + (n + k)ǫ.
From this and (3.5) we see that (3.2) holds for every n ≥ n0 (x) := max{n2 (x), n3 (x)}
and every k ≥ 0. This prove (i).
To see (ii), suppose λ = −∞. By the Kingman’s sub-additive ergodic theorem,
limn→∞ (1/n) log fn (x) = −∞ for m-a.e. x. Fix N and define
f˜n (x) = max{fn (x), e−nN } for n ∈ N, x ∈ X.
Then limn→∞ (1/n) log f˜n (x) = −N for m-a.e. x. Meanwhile it is direct to check
˜
that {f˜n }∞
n=1 is sub-multiplicative (i.e., (3.1) holds for {fn }), so by the Kingman’s
sub-additive ergodic theorem,
Z
lim (1/n) log f˜n dm = −N.
n→∞

Applying (i) to {f˜n }∞
n=1 yields that for m-a.e. x ∈ X, there exists a positive integer
n0 (x) such that
log fn (T k x) ≤ log f˜n (T k x) ≤ −Nn + (n + k)ǫ
for all n ≥ n0 (x) and k ≥ 0. This completes the proof of the proposition.



As a direct corollary of Proposition 3.2, we have the following.
Corollary 3.3. Under the assumptions of Proposition 3.2, for any ǫ, N > 0 and for
m-a.e. x ∈ X, there exists c(x) > 0 such that
|fn (T k x)| ≤ c(x) exp(n max{λ, −N}) exp((n + k)ǫ)
for all n ≥ 1 and k ≥ 0.

22

DE-JUN FENG

Proof of Proposition 3.1. Without loss of generality we may assume that m is ergodic, since the general case can be proved by considering the ergodic decomposition
of m.
Set fn (x) = kMx0 · · · Mxn−1 k for x ∈ Σ and n ≥ 1. Let f0 (x) ≡ 1 for convention.
Since S is average contracting with respect to m, we have
Z
1
log fn dm =: λ < 0.
lim
n→∞ n
Let 0 < ǫ < −λ/3. Applying Corollary 3.3 to {fn } and the shift map σ : Σ → Σ
(in which we take N = 2ǫ), we see that for m-a.e. x, there exists c(x) > 0 such that
fn (σ k x) ≤ c(x)e−2nǫ e(n+k)ǫ
for any n ≥ 1 and k ≥ 0. It follows that for m-a.e. x,
∞
∞
X
X
kMxk · · · Mxk+n−1 axk+n k ≤ (max kai k)
fn (σ k x)
i

n=0

n=0

≤ (max kai k)c(x)
i

∞
X

e−2nǫ e(n+k)ǫ

n=0

= (max kai k)c(x)(1 − e−ǫ )−1 ekǫ
i

for all k ≥ 0. It follows that for m-a.e. x, π(σ k x) is well-defined and kπ(σ k x)k ≤
(maxi kai k)c(x)(1 − e−ǫ )−1 ekǫ for all k ≥ 0. That is enough to conclude the proposition.

4. Measurable partitions associated with affine IFSs
Let S = {Mj x + aj }j∈Λ be an affine IFS on Rd and m ∈ Mσ (Σ). Suppose that
S is average contracting with respect to m. In this section, under an additional
assumption formulated later in (4.7), we construct a finite family of measurable
partitions of Σ and give some properties of these partitions and the corresponding
conditional measures of m.
Define M : Σ → Matd (R) by
M(x) = Mx−1 ,

x = (xn )∞
n=−∞ .

Applying Theorem 2.12 to the measure-preserving system (Σ, σ −1 , m) and the
matrix cocycle M, we get a measurable Σ′ ⊂ Σ with σ(Σ′ ) = Σ′ and m(Σ′ ) = 1, so
that the Lyapunov spectrum
{(λi (x), ki (x))}1≤i≤s(x)
and the Oseledets splitting
Rd = Ex1 ⊕ · · · ⊕ Exs(x)
are well-defined for x ∈ Σ′ (cf. Remark 2.13). In this case, for any x ∈ Σ′ and
1 ≤ i ≤ s(x),

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

23

1
log kMx−n · · · Mx−1 vk = λi (x) for v ∈ Exi \{0},
n
with uniform convergence on any compact subset of Exi \{0},
1
lim
max
log kMx0 · · · Mxn−1 vk
n→∞ n v∈E i n , kv||=1
σ x
(4.2)
1
= lim
min
log kMx0 · · · Mxn−1 vk = λi (x),
n→∞ n v∈E i n , kv||=1
σ x
(4.1)

lim

n→∞

and
(4.3)

lim sup
n→∞

1
max
log kMx0 · · · Mxn−1 vk ≤ λi (x).
s(x) j
n v∈⊕j=i
Eσ n x , kv||=1

In addition, by Proposition 3.1 we may assume that the coding map π is welldefined on Σ′ and that
1
(4.4)
lim log+ kπ(σ n x)k = 0 for x ∈ Σ′ .
n→∞ n
Define for x ∈ Σ′ ,
(4.5)

s(x)

Vxi := ⊕j=i+1 Exj

for i = 0, . . . , s(x) − 1,

and

Vxs(x) := {0}.

By (4.1), we have


1
i
d
(4.6)
Vx = v ∈ R : lim sup log kMx−n · · · Mx−1 vk ≤ λi+1 (x)
n→∞ n

for x ∈ Σ′ , i = 0, . . . , s(x) − 1.

−1
−
For x = (xj )∞
j=−∞ ∈ Σ, we write x = (xj )j=−∞ . The following simple fact is our
starting point in constructing measurable partitions of Σ′ .

Lemma 4.1. Let x, y ∈ Σ′ with x− = y − . Then s(x) = s(y) and λi (x) = λi (y) for
1 ≤ i ≤ s(x). Moreover, Vxi = Vyi for 0 ≤ i ≤ s(x).
Proof. For x ∈ Σ′ and v ∈ Rd \ {0}, define
1
λ(x, v) := lim log kMx−n · · · Mx−1 vk.
n→∞ n
By (4.1), the above limit always exists and takes values in {λi (x) : 1 ≤ i ≤ s(x)}.
Clearly λ(x, v) only depends on v and x− . Hence for x, y ∈ Σ′ with x− = y − , we
have s(x) = s(y) and λi (x) = λi (y) for 1 ≤ i ≤ s(x); by (4.6) we also have Vxi = Vyi
for 1 ≤ i ≤ s(x). This completes the proof of the lemma.

In the remaining part of this section, we always make the following assumption:
(4.7)

s(x), k1 (x), . . . , ks(x) (x) are constant for m-a.e. x ∈ Σ′ .

Here we don’t make the stronger assumption that m is ergodic. Let us write these
constants as s, k1 , . . . , ks .

24

DE-JUN FENG

Below we construct a finite family of measurable partitions ξ0 , . . . , ξs of Σ′ .
′
Let ξ0 be the partition of Σ′ so that the ξ0 -atom containing x = (xj )+∞
j=−∞ ∈ Σ is
given by
′
ξ0 (x) = {y = (yj )∞
j=−∞ ∈ Σ : yj = xj for j ≤ −1}.

By Lemma 4.1, Vyi = Vxi for any y ∈ ξ0 (x) and i ∈ {0, 1, . . . , s}.
Similarly, for i ∈ {1, . . . , s}, we define the partition ξi of Σ′ by
i
ξi (x) = {y = (yj )∞
j=−∞ ∈ ξ0 (x) : πy − πx ∈ Vx },

x ∈ Σ′ .

Lemma 4.2. ξ0 , . . . , ξs are measurable partitions of (Σ′ , B(Σ′ ), m).
Proof. By Rohlin theory (cf. [65, Section 2.5], [56, Chapter IV]), it is enough to
show that for every i ∈ {0, 1, . . . , s}, one can construct a measurable mapping πi
from Σ′ to a complete separable metric space Yi such that ξi is induced by πi , in the
sense that ξi = {πi−1 (y) : y ∈ Yi }. Below we construct such mappings πi .
Let Σ− := {(xn )−1
n=−∞ : xn ∈ Λ for all n ≤ −1} and endow it with a suitable
metric compatible to the product topology. For j ∈ {0, . . . , d}, the set of all jdimensional affine subspaces in Rd forms a closed smooth manifold, which is called
the (d, j)-affine Grassmannian and is denoted by Graff(d, j).
Set Yi = Σ− × Graff(d, ki+1 + · · · + ks ) for i ∈ {0, . . . , s − 1} and Ys = Σ− × Rd .
Define πi : Σ′ → Yi (i = 0, 1, . . . , s) by
x 7→ (x− , Vxi + πx).
It is readily checked that for each i, πi is measurable and ξi is induced by πi .



Remark 4.3. The above construction of the measurable partitions ξ0 , . . . , ξs is different from that built in the previous work of [29, 4]. In [29], the partitions were
made on the one-sided shift space due to the simple structure of Oseledets splitting
subspaces. In [4], the partitions were made on the product space of the self-affine set
and the flag manifolds.
Let P be the canonical partition of Σ′ given in (1.4). For n ∈ N, set
P0n−1

=

n−1
_

σ −j P,

j=0

where ∨ stands for the join of partitions (cf. [57]).
For convenience, write

(4.8)
Qn,ǫ := x ∈ Σ′ : kπσ j xk ≤ (1/2)ejǫ/2 for all j ≥ n

for n ∈ N and ǫ > 0. Below we give several lemmas to further illustrate the properties
of ξi and the associated conditional measures.

Lemma 4.4.

(1) For x ∈ Σ′ , i ∈ {0, . . . , s} and n ∈ N,
ξi (x) ∩ P0n−1 (x) = σ −n (ξi (σ n x)).

As a consequence, ξi ∨ P0n−1 = (σ −n ξi ) ∨ P0n−1 = σ −n ξi .

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

25

(2) Let x ∈ Σ′ and ǫ > 0. Then there exists n0 (x) such that for i ∈ {0, . . . , s−1},
 π
B (x, en(λi+1 (x)+2ǫ) ) if λi+1 (x) 6= −∞
n−1
(4.9)
Qn,ǫ ∩ ξi (x) ∩ P0 (x) ⊂
B π (x, e−n/ǫ )
if λi+1 (x) = −∞
when n ≥ n0 (x), here B π (x, r) is defined as in (2.3). Moreover,
 π
B (x, en(λ1 (x)+2ǫ) ) if λ1 (x) 6= −∞
n−1
(4.10)
Qn,ǫ ∩ P0 (x) ⊂
B π (x, e−n/ǫ )
if λ1 (x) = −∞
when n ≥ n0 (x).
′
Proof. We first prove (1). Let x = (xj )∞
j=−∞ ∈ Σ , i ∈ {0, . . . , s} and n ∈ N. We
n−1
only prove that ξi (x) ∩ P0 (x) ⊂ σ −n (ξi (σ n x)). The proof of the other direction is
similar.
n−1
Let y = (yj )∞
(x). Then πy −πx ∈ Vxi and yj = xj for j ≤ n−1.
j=−∞ ∈ ξi (x)∩P0
By Proposition 3.1(ii),

πy − πx = Sy0 ...yn−1 (πσ n y) − Sx0 ...xn−1 (πσ n x)
= Sx0 ...xn−1 (πσ n y) − Sx0 ...xn−1 (πσ n x)

(4.11)

= Mx0 ...xn−1 (πσ n y − πσ n x),
here and afterwards we write Mi1 ...in for Mi1 · · · Min . Since πy − πx ∈ Vxi , by (4.11)
and (4.6) we have
1
log kMx−k ...x−1 x0 ...xn−1 (πσ n y − πσ n x)k
n
+
k
k→∞
1
= lim sup
log kMx−k ...x−1 (πy − πx)k ≤ λi+1 (x) = λi+1 (σ n x).
n
+
k
k→∞

lim sup

Applying (4.6) to Vσin x gives πσ n y − πσ n x ∈ Vσin x . In the meantime, since yj = xj
for j ≤ n − 1, we have also σ n y ∈ ξ0 (σ n x). Therefore y ∈ σ −n (ξi (σ n x)). This proves
ξi (x) ∩ P0n−1 (x) ⊂ σ −n (ξi (σ n x)).
Next we prove (2). Let x ∈ Σ′ , i ∈ {0, . . . , s − 1} and ǫ > 0. By (4.3) and (4.4),
there exists n0 = n0 (x) such that for any n ≥ n0 ,
 n(λ (x)+ǫ)
e i+1
if λi+1 (x) 6= −∞
kMx0 ...xn−1 vk ≤
(4.12)
max
−2n/ǫ
e
if λi+1 (x) = −∞
v∈Vσin x , kvk=1
and
(4.13)

1
kπσ n xk ≤ enǫ/2 .
2

26

DE-JUN FENG

Now let n ≥ n0 and y ∈ Qn,ǫ ∩ ξi (x) ∩ P0n−1 (x). Then kπσ n yk ≤ (1/2)enǫ/2, y − = x− ,
πy − πx ∈ Vxi and furthermore by (1), πσ n y − πσ n x ∈ Vσin x . By (4.11)-(4.13),
kπy − πxk = kMx0 ...xn−1 (πσ n y − πσ n x)k


≤
max
kMx0 ...xn−1 vk kπσ n y − πσ n xk
v∈Vσin x , kvk=1

≤



en(λi+1 (x)+2ǫ)
e−n/ǫ

if λi+1 (x) 6= −∞
.
if λi+1 (x) = −∞

This proves (4.9). Moreover, since Vx0 = Rd , the above argument for the case i = 0
actually proves (4.10).

Recall that for a measurable partition η of Σ′ , {mηx } stands for the canonical
system of conditional measures associated with η (cf. Section 2.2).
Lemma 4.5. Let i ∈ {0, 1, . . . , s}. Then for m-a.e. x ∈ Σ′ , the following hold.
(1) mxσ

−n ξ
i

(A) = mξσin x (σ n A) for any n ∈ N and measurable A ⊂ Σ′ .

(2) mxσ

−n ξ
i

(A) =

(3)

mξxi (A ∩ P0n−1 (x))
mξxi (P0n−1 (x))

mξxi (σ −n A ∩ P0n−1 (x))
Σ′ .

mξσin x (A)

for any n ∈ N and measurable A ⊂ Σ′ .

= mξxi (P0n−1 (x)) for any n ∈ N and measurable A ⊂

Proof. All the results follow from the σ-invariance of m and the uniqueness of conditional measures. For the reader’s convenience, we include below the detailed arguments.
To see (1), fix n ∈ N and define a family of probability measures {µx }x∈Σ′ such
that µx is supported on (σ −n ξi )(x) = σ −n (ξi (σ n x)) and satisfies
µx (A) = mξσin x (σ n A)

for any measurable A ⊂ Σ′ .

Then by Theorem 2.4, for every measurable A ⊂ Σ′ and m-a.e. x,
µx (A) = Em (χσn A |ξbi )(σ n x)

= Em (χσn A ◦ σ n |σ −n ξbi )(x)
= Em (χA |σ −n ξbi )(x).

(by Lemma 2.1(i))

R
It follows that x 7→ µx (A) is σ −n ξbi -measurable and m(A) = µx (A)dm(x). Therefore, {µx } is a canonical system of conditional measures associated with σ −n ξi . By
−n
the uniqueness of conditional measures, we have µx = mσx ξi for m-a.e. x. This
proves (1).
To see (2), let n ∈ N and notice that σ −n ξi = ξi ∨ P0n−1 by Lemma 4.4(1). Similar
to the proof of (1), we define a family of probability measures {νx }x∈Σ′ such that νx

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

27

is supported on (σ −n ξi )(x) = ξi (x) ∩ P0n−1 (x) and satisfies
νx (A) =

mξxi (A ∩ P0n−1 (x))
mξxi (P0n−1 (x))

for any measurable A ⊂ Σ′ .

Then by Theorem 2.4, for every measurable A ⊂ Σ′ and m-a.e. x,
X
νx (A) =
(4.14)
χB (x) · hB (x),
B∈P0n−1

where hB := Em (χA∩B |ξbi )/Em(χB |ξbi ). Since hB is ξbi -measurable, the mapping x 7→
n−1
[
νx (A) is ξbi ∨ P
-measurable (i.e. σ −n ξbi -measurable). Moreover by (4.14),
0
Z
X Z
νx (A) dm(x) =
χB hB dm
B∈P0n−1

=

X Z

B∈P0n−1

=

X Z

B∈P0n−1

=

X Z

B∈P0n−1

=

X

Em (χB hB |ξbi ) dm

Em (χB |ξbi )hB dm
Em (χA∩B |ξbi ) dm

m(A ∩ B) = m(A).

B∈P0n−1

Hence the family {νx } is a canonical system of conditional measures associated with
σ −n ξi , and so (2) follows by the uniqueness of conditional measures.
Finally we prove (3). By (1), we have
mξσin x (A) = mξσin x (σ n (σ −n A)) = mσx

−n ξ
i

(σ −n A).

Applying (2) to σ −n A (instead of A) yields that
mξσin x (A) = mσx

−n ξ
i

(σ −n A) =

mξxi (σ −n A ∩ P0n−1 (x))
mξxi (P0n−1 (x))

which implies (3).

,


Now for i ∈ {0, 1, . . . , s}, define
(4.15)

hi (x) = Em (fi |I)(x),

x ∈ Σ′ ,

where fi := Im (P|ξbi ) and I = {A ∈ B(Σ′ ) : σ −1 A = A}. Clearly fi ≥ 0 a.e. By
Lemma 2.1(v), fi ∈ L1 . It follows that hi ≥ 0 a.e. and hi ∈ L1 .

28

DE-JUN FENG

Lemma 4.6. Let i ∈ {0, 1, . . . , s}. Then for m-a.e. x ∈ Σ′ ,
log mξxi (P0n−1 (x)) = −
(4.16)

n−1
X
j=0

Im (P|ξbi )(σ j x)

and

1
log mξxi (P0n−1 (x)) = hi (x).
n→∞ n

− lim
Furthermore,

1
log m(P0n−1 (x)) = h0 (x)
n→∞ n

− lim

(4.17)

for m-a.e. x ∈ Σ′ .

Proof. Let i ∈ {0, 1, . . . , s}. By Theorem 2.4,
X
X
log mξxi (P0n−1 (x)) =
χA (x) log mξxi (A) =
χA (x) log Em (χA |ξbi )(x)
A∈P0n−1

A∈P0n−1

and hence − log mξxi (P0n−1 (x)) = Im (P0n−1 |ξbi )(x) for m-a.e. x. By Lemma 2.1,
!
n−1
_
Im (P n−1 |ξbi ) = Im (P|ξbi ) + Im
σ −j P ξbi ∨ Pb
0

j=1

= Im (P|ξbi ) + Im

n−1
_
j=1

σ −j P σ −1 ξbi

= Im (P|ξbi ) + Im (P0n−2 |ξbi ) ◦ σ

!

(by Lemma 4.4(1))
(by Lemma 2.1(ii)).

Therefore by induction we have
(4.18)

Im (P0n−1 |ξbi )

=

n−1
X
j=0

Im (P|ξbi ) ◦ σ j .

Now (4.16) follows from (4.18) and the Birkhoff ergodic theorem.
To see (4.17), applying the Shannon-McMillian-Breiman theorem (see e.g. [57,
p. 39]) to the transformations σ and σ −1 respectively, we have the following convergences (pointwise and in L1 ):
1
log m(P0n−1 (x)) = Em (g1 |I)(x),
n→+∞ n
(4.19)
1
0
− lim
log m(P−(n−1)
(x)) = Em (g2 |I)(x),
n→+∞ n
W∞ j b
W∞ j b
W
−j b
b
where g1 := Im (P| ∞
j=1 σ P,
j=1 σ P), g2 := Im (P| j=1 σ P). Noticing that ξ0 =
we have g2 = Im (P|ξb0 ) = f0 and so Em (g2 |I) = h0 . To prove (4.17), by (4.19) it
suffices to show that
− lim

(4.20)

Em (g1 |I)(x) = Em (g2 |I)(x)

for m-a.e. x.

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

29

0
To see (4.20) first observe that for x ∈ Σ′ , P−(n−1)
(σ n x) = σ n (P0n−1 (x)) and hence
0
m(P−(n−1)
(σ n x)) = m(σ n (P0n−1 (x))) = m(P0n−1 (x)). For any B ∈ I, we have
Z
0
log m(P−(n−1)
(x)) dm(x)
B
Z
0
= χB (x) log m(P−(n−1)
(x)) dm(x)
Z
0
= χB (σ n x) log m(P−(n−1)
(σ n x)) dm(x)
(by the σ-invariance of m)
Z
= χB (σ n x) log m(P0n−1 (x)) dm(x)
Z
= χB (x) log m(P0n−1 (x)) dm(x)
(by χB = χB ◦ σ n as B ∈ I)
Z
=
log m(P0n−1 (x)) dm(x).
B

Dividing both sides by n, letting n → ∞ and applying (4.19), we have
Z
Z
Em (g1 |I) dm =
Em (g2 |I) dm for all B ∈ I.
B

B

Therefore Em (g1 |I) = Em (g2 |I) almost everywhere. This completes the proof of the
lemma.

Below we give an interesting corollary of Lemma 4.6, although we will not use it
in the rest part of the paper.
Corollary 4.7. Let i ∈ {0, 1, . . . , s}. Then hi = 0 a.e. if and only if mξxi = δx
(i.e. mξxi ({x}) = 1) for m-a.e. x ∈ Σ′ .
Proof. By Lemma 2.1(v), fi := Im (P|ξbi ) ≥ 0 a.e. and fi ∈ L1 . Hence by (4.15),
hi = 0 a.e. if and only if fi = 0 a.e. However according to the first equality in (4.16),
the condition fi = 0 a.e. implies that for m-a.e. x, mξxi (P0n−1 (x)) = 1 for every n ≥ 1
and hence
mξxi ({x}) = mξxi (ξ0 (x) ∩ P0∞ (x)) = mξxi (P0∞ (x)) = 1,
using the fact that mξxi is supported on ξi (x) ⊂ ξ0 (x). Conversely, by the first
equality in (4.16) (applied to n = 1), we obtain that fi (x) = − log mξxi (P(x)); hence
the condition
mξxi ({x}) = 1 a.e.
implies that fi = 0 a.e. This completes the proof of the corollary.

We end the section by the following.
Lemma 4.8. Let ǫ > 0 and define Qn,ǫ as in (4.8) for n ∈ N. Then for ma.e. x ∈ Σ′ ,
mξi (Qn,ǫ ∩ P n−1 (x))
=1
(i = 0, 1, . . . , s)
lim x ξi n−10
n→∞
mx (P0 (x))

30

DE-JUN FENG

and

m(Qn,ǫ ∩ P0n−1 (x))
= 1.
n→∞
m(P0n−1 (x))
lim

Proof. The equalities follow from the Lebesgue density lemma for Polish ultrametric
spaces (see, e.g. [53, Proposition 2.10]) and
Sthe facts that the sequence (Qn,ǫ ) of sets is
monotone increasing as n increases, and n Qn,ǫ is of full m-measure by Proposition
3.1(iii).

5. Transverse dimensions
In this section, we prove an inequality for the transverse dimensions of the conditional measures that we constructed in Section 4.
Recall that S is an affine IFS on Rd of the form (1.1), average contracting with
respect to some m ∈ Mσ (Σ). Let π be the associated coding map. Let M : Σ →
Matd (R) be the matrix cocycle given by M(x) = Mx−1 , and {(λi (x), ki (x))}1≤i≤s(x), x∈Σ′
the Lyapunov spectrum for M with respect to the transformation σ −1 . Suppose that
(4.7) holds, i.e. there exist s, k1 , . . . , ks so that s(x) = s, ki (x) = ki (i = 1, . . . , s) for
m-a.e. x ∈ Σ′ . Let ⊕si=1 Exi be the Oseledets splitting of Rd , and {0} = Vxs ⊂ · · · ⊂
Vx0 = Rd the associated filtration.
Let ξ0 , ξ1 , . . . , ξs be the measurable partitions of Σ′ that we constructed in Section 4. For x ∈ Σ′ and r > 0, set
(5.1)

Γi (x, r) = {y ∈ Σ′ : dist(πy + Vxi , πx + Vxi ) ≤ r},

and define

i = 1, . . . , s

ξ

log mxi−1 (Γi (x, r))
, i = 1, . . . , s.
r→0
log r
We call ϑ0 ,. . . , ϑs−1 the transverse dimensions of m. Intuitively we may view ϑi (x)
as the dimension of m along the direction Exi+1 .
ϑi−1 (x) = lim inf

The main result of this section is the following, which plays a key role in the proof
of Theorem 1.2.
Proposition 5.1. For m-a.e. x ∈ Σ′ ,
ϑi−1 (x) ≥

hi (x) − hi−1 (x)
,
λi (x)

i = 1, . . . , s,

where hi are defined as in (4.15).
This result can be viewed as an analogue of Proposition 11.2 in [46]. A stronger
version of the result, with the inequality being replaced by the equality, was proved
earlier in [29, Theorem 6.2], [2, Theorem 3.3], and [4, Propositions 5.3 and 7.3] under
various additional assumptions.
The proof of Proposition 5.1 is quite long and delicate. Besides extending some
ideas from the previous works [46, 29, 4], we need to employ certain new strategy
as well.

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

31

We first introduce some notation and give several lemmas.
For x ∈ Σ′ , i ∈ {1, . . . , s} and r > 0, set
Bxi (r) = {v ∈ Exi : kvk ≤ r}
and
Ti (x, r) = {y ∈ ξi−1 (x) : πy − πx ∈ Vxi ⊕ Bxi (r)}.
Lemma 5.2. Let x ∈ Σ′ , i ∈ {1, . . . , s}, n ∈ N and r > 0. For
0≤a≤

min

v∈Eσi n x , kvk=1

kMx0 ···xn−1 vk,

we have
Ti (x, ar) ∩ P0n−1 (x) ⊂ σ −n Ti (σ n x, r).

(5.2)

Proof. Let y ∈ Ti (x, ar) ∩ P0n−1 (x). By definition,
(5.3)

y ∈ ξi−1 (x) ∩ P0n−1 (x)

(5.4)

πy − πx ∈ Vxi ⊕ Bxi (ar).

and

By (5.3) and Lemma 4.4(1), y ∈ σ −n (ξi−1 (σ n x)). Moreover since y ∈ P0n−1 (x), by
(4.11),
πy − πx = Mx0 ...xn−1 (πσ n y − πσ n x).

(5.5)

Since y ∈ ξi−1 (x), by definition πy − πx ∈ Vxi−1 = Vxi ⊕ Exi . Applying (4.6) to Vxi−1
yields
1
lim sup log kMx−k ...x−1 (πy − πx)k ≤ λi (x) = λi (σ n x),
k→∞ k
where the last equality follows from Theorem 2.12(vii). Hence by (5.5),
lim sup
k→∞

1
log kMx−k ...x−1 x0 ...xn−1 (πσ n y − πσ n x)k ≤ λi (σ n x).
n+k

i−1
n
n
i
i
Applying (4.6) to Vσi−1
n x gives πσ y − πσ x ∈ Vσ n x = Vσ n x ⊕ Eσ n x . Write

πy − πx = v1 + w1
πσ n y − πσ n x = v2 + w2

with v1 ∈ Vxi and w1 ∈ Exi ,
with v2 ∈ Vσin x and w2 ∈ Eσi n x .

By (5.4), w1 ∈ Bxi (ar) and hence kw1 k ≤ ar. Since Mx0 ···xn−1 Vσin x ⊂ Vxi and
Mx0 ···xn−1 Eσi n x ⊂ Exi , by (5.5) we see that w1 = Mx0 ...xn−1 w2 and so
ar ≥ kw1 k = kMx0 ...xn−1 w2 k ≥ akw2 k.
It follows that kw2 k ≤ r. Hence πσ n y − πσ n x ∈ Vσin x ⊕ Bσi n x (r). This together with
y ∈ σ −n (ξi−1 (σ n x)) yields that y ∈ σ −n Ti (σ n x, r). Therefore
Ti (x, ar) ∩ P0n−1 (x) ⊂ σ −n Ti (σ n x, r)
and we are done.



32

DE-JUN FENG

Let θ(x) denote the smallest angle between the Oseledets subspaces, i.e.


θ(x) = min ∡ ⊕i∈I Exi , ⊕j∈J Exj .
I∩J=∅

We have the following.

Lemma 5.3. For x ∈ Σ′ , i ∈ {1, . . . , s} and r > 0,
Ti (x, r) ⊂ ξi−1 (x) ∩ Γi (x, r) ⊂ Ti (x, r/ sin θ(x)).
Proof. We first prove that Ti (x, r) ⊂ ξi−1 (x) ∩ Γi (x, r). Let y ∈ Ti (x, r). Then by
definition, y ∈ ξi−1 (x) and πy − πx = v + w for some v ∈ Vxi , w ∈ Exi with kwk ≤ r,
which implies that
dist(πy + Vxi , πx + Vxi ) ≤ kwk ≤ r.
Hence y ∈ ξi−1 (x) ∩ Γi (x, r). This proves the relation Ti (x, r) ⊂ ξi−1 (x) ∩ Γi (x, r).
Next we prove that ξi−1(x) ∩ Γi (x, r) ⊂ Ti (x, r/ sin(θ(x))). Let Uxi := Vxi−1 ⊖ Vxi
denote the orthogonal complement of Vxi in Vxi−1 . Let z ∈ ξi−1 (x) ∩ Γi (x, r). Then
πz − πx ∈ Vxi−1 and dist(πz + Vxi , πx + Vxi ) ≤ r. Hence πz − πx = v + u for some
v ∈ Vxi and u ∈ Uxi with kuk ≤ r. Since v + u ∈ Vxi−1 = Vxi ⊕ Exi , v + u = v1 + w1 for
some v1 ∈ Vxi and w1 ∈ Exi . Notice that w1 = (v − v1 ) + u with u ⊥ (v − v1 ). We
have
kuk
r
kuk
≤
≤
.
kw1 k =
sin ∡(w1 , v − v1 )
sin θ(x)
sin θ(x)
Thus πz − πx = v1 + w1 , where v1 ∈ Vxi and w1 ∈ Exi with kw1 k ≤ r/ sin θ(x).
Therefore, z ∈ Ti (x, r/ sin θ(x)) and we are done.

Now we turn back to the proof of Proposition 5.1. Clearly, to prove the proposition
it is sufficient to show that for any ǫ > 0, there exists F (ǫ) ⊂ Σ′ so that
(5.6)

ϑi−1 (x) ≥

hi−1 (x) − hi (x)
−λi (x) + ǫ

for m-a.e. x ∈ F (ǫ) and i ∈ {1, . . . , s}.

and limǫ→0 m(F (ǫ)) = 1.
Here and afterwards in this section, we may assume that λs 6= −∞ a.e., since
Proposition 5.1 holds automatically when i = s and λs (x) = −∞.
We first construct F (ǫ) for ǫ > 0. Set
(5.7)

F0 (ǫ) := {x ∈ Σ′ : sin θ(x) > ǫ}.

By (4.2), there exist a large integer N(ǫ) and a Borel set F (ǫ) ⊂ F0 (ǫ) with
m(F (ǫ)) > (1 − ǫ)m(F0 (ǫ)) so that for i ∈ {1, . . . , s},
(5.8)

kMx0 ···xn−1 vk ≥ ǫ−1 en(λi (x)−ǫ) kvk

for x ∈ F (ǫ), n ≥ N(ǫ) and v ∈ Eσi n x . Clearly, m(F (ǫ)) → 1 as ǫ → 0.
In the remaining part of this section we prove (5.6) for the constructed F (·). From
now on, we fix ǫ > 0 and write simply F = F (ǫ) and N = N(ǫ).

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

33

Let σF : F → F be the transformation induced by σ N on the set F (cf. Section 2.3). That is, σF (x) = σ N rF (x) (x), where
rF (x) := inf{n ≥ 1 : σ nN x ∈ F }.
The map σF is well-defined on F up to a set of zero m-measure. Let mF be the
Borel probability measure on F defined by
mF (D) =

m(F ∩ D)
m(F )

for any Borel set D ⊂ F.

Recall that mF is σF -invariant.
For x ∈ F , set
ℓ(x) = NrF (x)

(5.9)

and

ρ(i, x) = eℓ(x)(λi (x)−ǫ) ,

i = 1, . . . , s.

Then we have
Lemma 5.4. For x ∈ F , i ∈ {1, . . . , s} and r > 0,
(5.10)

ℓ(x)−1

ξi−1 (x) ∩ Γi (x, ρ(i, x)r) ∩ P0

(x) ⊂ σ −ℓ(x) (Γi (σF x, r) ∩ ξi−1 (σF x)) .

Proof. Fix x ∈ F , i ∈ {1, . . . , s} and r > 0. Set a = ǫ−1 ρ(i, x). Since ℓ(x) =
NrF (x) ≥ N, by (5.8),
a = ǫ−1 eℓ(x)(λi (x)−ǫ) ≤ inf{kM ℓ(x) (x)vk : v ∈ Eσi ℓ(x) x , kvk = 1},

(5.11)

where M n (x) := Mx0 ···xn−1 . Observe that
ξi−1 (x) ∩ Γi (x, ρ(i, x)r)
⊂ Ti (x, ρ(i, x)r/ sin θ(x))
(by Lemma 5.3)

−1
⊂ Ti x, ǫ ρ(i, x)r
(since sin θ(x) ≥ ǫ)
= Ti (x, ar) .

Hence
ℓ(x)−1

ξi−1(x) ∩ Γi (x, ρ(i, x)r) ∩ P0
⊂ Ti (x, ar) ∩

(x)

ℓ(x)−1
P0
(x)

⊂ σ −ℓ(x) Ti σ ℓ(x) x, r
= σ −ℓ(x) Ti (σF x, r)



(by (5.11) and Lemma 5.2)

⊂ σ −ℓ(x) (Γi (σF x, r) ∩ ξi−1 (σF x))

(by Lemma 5.3).

This completes the proof of the lemma.



Now write
(5.12)

Fn := {x ∈ F : rF (x) = n},

n = 1, 2, . . . .

Recall that {mξxi } is the canonical system of conditional measures associated with
ξi , i = 0, . . . , s. The following result is an induced version of Lemma 2.5.

34

DE-JUN FENG

Proposition 5.5. Let i ∈ {1, . . . , s}. Then for m-a.e. x ∈ F ,


ξi−1
ℓ(x)−1
∞
kN
−1
mx
Γi (x, r) ∩ P0
(x)
X
X
(5.13) lim log
=−
χFk (x)
Im (P|ξbi )(σ j x).
ξ
r→0
mxi−1 (Γi (x, r))
j=0
k=1
Furthermore, set

g(x) = − inf log

(5.14)

r>0



ξ
ℓ(x)−1
mxi−1 Γi (x, r) ∩ P0
(x)
ξ

mxi−1 (Γi (x, r))

.

Then g ≥ 0 and g ∈ L1 (F, B|F , mF ).
Proof. Fix i ∈ {1, . . . , s}. Write di =
by

Ps

j=i+1 kj .

Define φi : Σ′ → Yi := G(d, di )×Rd


φi (x) = Vxi , P(Vxi )⊥ (πx) .

Then φi is measurable. Moreover,

ξi (x) = {y ∈ ξ0 (x) : φi (y) = φi (x)},

(5.15)

x ∈ Σ′ .

Endow Yi with the following product metric ρi :
ρi ((V, a), (W, b)) = max{kPV − PW k, ka − bk}.
It is not hard to see that Yi is a Besicovitch space. For x ∈ Σ′ and r > 0, set
B φi (x, r) := {y ∈ Σ′ : ρi (φi y, φi x) ≤ r}.
Then by definition,
ξ0 (x) ∩ B φi (x, r) = ξ0 (x) ∩ Γi (x, r),

(5.16)

x ∈ Σ′ , r > 0.

Hence for x ∈ F and r > 0,
(5.17)
ξ
mxi−1

log



Γi (x, r) ∩
ξ

ℓ(x)−1
P0
(x)

mxi−1 (Γi (x, r))



ξ
mxi−1

= log

= log

= log
=

∞
X



ℓ(x)−1
ξ0 (x) ∩ Γi (x, r) ∩ P0
(x)
ξ

mxi−1 (ξ0 (x) ∩ Γi (x, r))


ξi−1
ℓ(x)−1
φi
mx
ξ0 (x) ∩ B (x, r) ∩ P0
(x)
ξ

mxi−1 (ξ0 (x) ∩ B φi (x, r))


ξi−1
ℓ(x)−1
φi
mx
B (x, r) ∩ P0
(x)
ξ

mxi−1 (B φi (x, r))

X

k=1 A∈P kN−1
0

χFk ∩A (x) log


ξ
mxi−1 B φi (x, r) ∩ A
ξ

mxi−1 (B φi (x, r))

.

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

35

By (5.17) and applying Lemma 2.5(1) to φi : Σ′ → Yi , we have for m-a.e. x ∈ F ,


ξ
ℓ(x)−1
mxi−1 Γi (x, r) ∩ P0
(x)
lim log
ξ
r→0
mxi−1 (Γi (x, r))
∞


X
X
−1
d
=
χA∩Fk (x) log Em χA |ξi−1 ∨ φi B(Yi ) (x)
k=1 A∈P kN−1
0

=

∞
X

X

χA∩Fk (x) log Em

k=1 A∈P kN−1
0

=

∞
X

χFk (x)

k=1

=−

∞
X
k=1

=−

∞
X
k=1

This proves (5.13).

X




b
χA |ξi (x)

χA (x) log Em

A∈P0kN−1

χFk (x)Im (P0kN −1 |ξbi )(x)
χFk (x)

kN
−1
X
j=0




b
χA |ξi (x)

Im (P|ξbi )(σ j x)

(by (4.18)).

Next we prove that g ∈ L1 (mF ). We mainly follow the arguments in [29, Lemma
3.3 and Proposition 3.5]. By Theorem 2.4, for any given C ∈ ξi−1 , the conditional
ξ
measures mxi−1 (x ∈ C) represent the same measure supported on C, which we
rewrite as mC . Fix C ∈ ξi−1 , k ∈ N and A ∈ P0kN −1 . We define measures µC and
−1
νC on Yi by µC (E) = mC (φ−1
i E ∩ A) and νC (E) = mC (φi E) for all E ∈ B(Yi ).
By the Hardy-Littlewood maximal inequality (see, e.g. Theorem 2.19 in [50]), there
exists a positive constant a (which depends on Yi ) such that


µC (B(z, r))
< u ≤ au
(u > 0).
µC z ∈ Yi : inf
r>0 νC (B(z, r))

Hence for any u > 0,
(
mC

)
!

φi
m
B
(x,
r)
∩
A
C
x ∈ Σ′ : inf
< u ∩ A ≤ au.
r>0
mC (B φi (x, r))

Integrating C over ξi−1 , we obtain
(
)
!

ξi−1
φi
m
B
(x,
r)
∩
A
x
m
x ∈ Σ′ : inf
< u ∩ A ≤ au.
ξ
r>0
mxi−1 (B φi (x, r))

ξ
mxi−1 B φi (x, r) ∩ A
A
. Then the above inequality can be rewritten
Write g (x) = inf
ξ
r>0
mxi−1 (B φi (x, r))
as
(5.18)

m(A ∩ {g A < u}) ≤ au.

36

DE-JUN FENG

Note that by (5.14) and (5.17), g(x) = −
g is non-negative,
Z
Z ∞
g dm =
m{g > t} dt

P∞ P
k=1

A∈P0kN−1

χFk ∩A (x) log g A (x). Since

0

=

Z

0

≤

∞
∞X

∞
X

X

k=1 A∈P kN−1
0

X

k=1 A∈P kN−1
0

≤

∞
X

m(Fk ∩ A ∩ {g A < e−t }) dt

X

Z

∞

min{m(Fk ∩ A), ae−t } dt

(by (5.18))

0

(−m(Fk ∩ A) log m(Fk ∩ A) + m(Fk ∩ A)(1 + log a))

k=1 A∈P kN−1
0

≤ 1 + log a +

∞
X

X

(−m(Fk ∩ A) log m(Fk ∩ A))

k=1 A∈P kN−1
0

∞
X



X



m(Fk ∩ A) 
m(Fk ∩ A)
log
m(Fk )
m(Fk )
k=1
A∈P0kN−1

1
+ log
m(Fk )


∞
X
1
≤ 1 + log a +
m(Fk ) kN log(#Λ) + log
m(Fk )
k=1
≤ 1 + log a +

< ∞

m(Fk ) 

−

(by Lemma 2.10(ii)-(iii)).

This finishes the proof of the proposition.



Finally we are ready to prove (5.6), the last step in the proof of Proposition 5.1.
Proof of (5.6). Fix ǫ > 0 and write F = F (ǫ). Let i ∈ {1, . . . , s}.
For x ∈ F and n ∈ N, define
ρn (i, x) =

n−1
Y

ρ(i, σFk x),

k=0

where σFk := (σF )k , and ρ(i, x) = eℓ(x)(λi (x)−ǫ) (as defined in (5.9)). Moreover, write
ξ

Hn (x) := log

Gn (x) := log

mxi−1 (Γi (x, ρn (i, x)))

,
ξ
mσi−1
F x (Γi (σF x, ρn−1 (i, σF x)))


ξ
ℓ(x)−1
mxi−1 Γi (x, ρn (i, x)) ∩ P0
(x)
ξ

mxi−1 (Γi (x, ρn (i, x)))

.

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

37

Then for m-a.e. x ∈ F ,
Hn (x) + Gn (x) = log

= log

≤ log

≤ log

= log



ξ
ℓ(x)−1
mxi−1 Γi (x, ρn (i, x)) ∩ P0
(x)
ξ

mσi−1
x (Γi (σF x, ρn−1 (i, σF x)))
F

ξ
ℓ(x)−1
mxi−1 ξi−1 (x) ∩ Γi (x, ρn (i, x)) ∩ P0
(x)
ξ

mσi−1
F x (Γi (σF x, ρn−1 (i, σF x)))



ξ
ℓ(x)−1
mxi−1 σ −ℓ(x) (Γi (σF x, ρn−1 (i, σF x)) ∩ ξi−1 (σF x)) ∩ P0
(x)
ξ

mσi−1
F x (Γi (σF x, ρn−1 (i, σF x)))



ξ
ℓ(x)−1
mxi−1 σ −ℓ(x) (Γi (σF x, ρn−1 (i, σF x))) ∩ P0
(x)
ξ

mσi−1
F x (Γi (σF x, ρn−1 (i, σF x)))



ξ
ℓ(x)−1
mxi−1 σ −ℓ(x) (Γi (σF x, ρn−1 (i, σF x))) ∩ P0
(x)
ξ

mσi−1
ℓ(x) x (Γi (σF x, ρn−1 (i, σF x)))

ℓ(x)−1

= log mξxi−1 (P0
=−

∞
X
k=1

χFk (x)

(x))

kN
−1
X
j=0

(by Lemma 4.5(3))

j
Im (P|ξd
i−1 )(σ x) =: Qi−1 (x)

(by (4.16)),

that is, Hn (x) + Gn (x) ≤ Qi−1 (x). Therefore for m-a.e. x ∈ F ,
!
n−1
X
ξ
− log mξxi−1 (Γi (x, ρn (i, x))) = −
Hn−j (σFj x) − log mσi−1
(Γi (σFn x, 1))
n
Fx
j=0

≥−

n−1
X

Hn−j (σFj x)

j=0

≥

n−1
X
j=0


Gn−j (σFj x) − Qi−1 (σFj x) ,

and thus
n−1


− log mxi−1 (Γi (x, ρn (i, x)))
1X
Gn−j (σFj x) − Qi−1 (σFj x) .
≥
n
n j=0
ξ

Notice that by Proposition 5.5, when n → +∞,
Gn → Qi := −

∞
X
k=1

χFk

kN
−1
X
j=0

Im (P|ξbi ) ◦ σ j

(by (5.10))

38

DE-JUN FENG

pointwise and in L1 . By Lemma 2.3, for m-a.e. x ∈ F ,
ξ

− log mxi−1 (Γi (x, ρn (i, x)))
≥ EmF ((Qi − Qi−1 )|IF )(x),
n→∞
n
where IF := {B ∈ B|F : σF−1 (B) = B}. In the meantime, by the Birkhoff ergodic
theorem,
−1
lim
log(ρn (i, x)) = EmF (N(−λi + ǫ)rF |IF )(x)
n→∞ n
= N(−λi (x) + ǫ)EmF (rF |IF )(x) mF -a.e.,
lim inf

where we use the fact that λi is σ-invariant and thus σF -invariant. Hence for ma.e. x ∈ F ,
ξ

ξ

log mxi−1 (Γi (x, ρn (i, x)))
log mxi−1 (Γi (x, r))
= lim inf
lim inf
n→∞
r→0
log r
log(ρn (i, x))
EmF ((Qi − Qi−1 )|IF )(x)
≥
N(−λi (x) + ǫ)EmF (rF |IF )(x)

 
b
Em Im (P|ξd
)
−
I
(P|
ξ
)
i−1
m
i |I (x)
=
−λi (x) + ǫ
hi−1 (x) − hi (x)
=
.
−λi (x) + ǫ

(by Lemma 2.11)

That is, (5.6) holds. This completes the proof of Proposition 5.1.



6. Local dimensions of invariant measures for affine IFSs
In this section, we prove Theorems 1.2-1.4 and 1.6-1.7.
Let M : Σ → Matd (R) be the matrix-valued function defined by
M(x) = Mx−1 ,

x = (xj )+∞
j=−∞ .

Let m ∈ Mσ (Σ). Let
s(x)

Rd = ⊕i=1 Exi
(x ∈ Σ′ )
be the Oseledets splittings of Rd associated with (Σ, σ −1 , m) and M (see Section 4),
and 0 > λ1 (x) > · · · > λs(x) (x) ≥ −∞ the corresponding Lyapunov exponents.
Below we prove parts (i) and (ii) of Theorem 1.2 separately.
Proof of Theorem 1.2(i). In the beginning we assume that the condition (4.7) holds,
that is, for all x ∈ Σ′ ,
s(x) = s,

and

dim Exi = ki for i = 1, . . . , s.

(Just keep in mind that we don’t assume that m is ergodic at this moment.)
Write Vxi = ⊕sj=i+1 Exj for i = 0, . . . , s − 1, and Vxs = {0}. Clearly
{0} = Vxs ⊂ Vxs−1 ⊂ · · · ⊂ Vx0 = Rd .

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

39

Let ξ0 , ξ1 , . . . , ξs be the measurable partitions of Σ′ constructed as in Section 4.
Furthermore, we set
(6.1)

ξ−1 = {Σ′ , ∅}

and λ0 (x) = λ1 (x) for x ∈ Σ′ .

Clearly ξ−1 (x) = Σ′ for any x ∈ Σ′ . By Lemma 4.4(2), we have
(6.2)

Qn,ǫ ∩ ξi (x) ∩ P0n−1 (x) ⊂ B π (x, en(λi+1 (x)+ǫ) ),

i = −1, 0, . . . , s − 1

when n is large enough. Here B π (x, r) is defined as in (2.3).
For i = −1, 0, . . . , s, let {mξxi } be the canonical system of conditional measures
associated with ξi . By the definition of ξ−1 , we see that mξx−1 = m for any x ∈ Σ′ .
For x ∈ Σ′ and i ∈ {0, 1, . . . , s}, let hi (x) be defined as in (4.15). Due to (4.17)
we write
h−1 (x) = h0 (x).
According to Lemmas 4.6 and 4.8,
(6.3)
− log mξxi (Qn,ǫ ∩ P0n−1 (x))
= hi (x) for m-a.e. x ∈ Σ′ ,
i = −1, 0, . . . , s.
lim
n→∞
n
For x ∈ Σ′ and r > 0, let Γi (x, r) be defined as in (5.1), that is,
Γi (x, r) = {y ∈ Σ′ : dist(πy + Vxi , πx + Vxi ) ≤ r},

i = 1, . . . , s.

Write for convention that
Γ0 (x, r) = Σ′ .
It is easy to see that for i = 0, 1, . . . , s,
Γi (x, r) = {y ∈ Σ′ : kP(Vxi )⊥ (πy − πx)k ≤ r},

(6.4)

where (Vxi )⊥ stands for the orthogonal complement of the space Vxi in Rd , and PW
is the orthogonal projection from Rd to W .
Moreover, define
(6.5)

ϑi (x) = lim inf
r→0

log mξxi (Γi+1 (x, r))
,
log r

i = −1, 0, . . . , s − 1.

Clearly ϑ−1 (x) = 0 for every x ∈ Σ′ since Γ0 (x, r) = Σ′ . Combining this with
Proposition 5.1 yields
(6.6)

ϑi (x) ≥

hi+1 (x) − hi (x)
λi+1 (x)

(i = −1, 0, . . . , s − 1)

for m-a.e. x ∈ Σ′ .
For i = −1, 0, . . . , s and x ∈ Σ′ , define
δ i (x) = lim sup
r→0

log mξxi (B π (x, r))
,
log r

We claim that for m-a.e. x ∈ Σ′ ,
(C1) δ s (x) = δ s (x) = 0.

δ i (x) = lim inf
r→0

log mξxi (B π (x, r))
.
log r

40

DE-JUN FENG

hi+1 (x) − hi (x)
≥ δ i (x) − δ i+1 (x) for i = −1, 0, . . . , s − 1.
λi+1 (x)
(C3) δ i+1 (x) + ϑi (x) ≤ δ i (x) for i = −1, 0, . . . , s − 1.

(C2)

It is easy to see that (C1)-(C3) together with (6.6) force inductively that for
m-a.e. x ∈ Σ′ ,
hi+1 (x) − hi (x)
(6.7)
for i = s − 1, . . . , 0, −1,
ϑi (x) =
λi+1 (x)
for i = s, s − 1, . . . , 0, −1

δ i (x) = δ i (x)

(we write the common value as δi (x)), and furthermore
(6.8)

δi (x) =

s−1
X

ϑj (x) =

j=i

for i = −1, 0, . . . , s. In particular,
(6.9)

s−1
X
hj+1 (x) − hj (x)

λj+1 (x)

j=i

dimloc (π∗ m, πx) = δ−1 (x) = δ0 (x) =

s−1
X

ϑi (x) =

i=0

s−1
X
hi+1 (x) − hi (x)
i=0

λi+1 (x)

for m-a.e. x, which proves Theorem 1.2(i) under the additional assumption (4.7). In
the following we prove (C1)-(C3) respectively.
Proof of (C1). Since ξs (x) = π −1 (πx) ∩ ξ0 (x) ⊂ B π (x, r) for any x ∈ Σ′ and r > 0,
we have
mξxs (B π (x, r)) ≥ mξxs (ξs (x)) = 1
and so mξxs (B π (x, r)) = 1 for all x ∈ Σ′ . Thus δ s (x) = δ s (x) = 0 for all x ∈ Σ′ . 
Proof of (C2). We give a proof by contradiction, which is modified from [46, §10.2]
and the proof of [29, Theorem 2.11]. Assume that (C2) is not true. Then there
exists i ∈ {−1, 0, . . . , s − 1} such that
hi+1 (x) − hi (x)
< δ i (x) − δ i+1 (x)
λi+1 (x)
on a set U = Ui ⊂ Σ′ with positive measure. Fix such i. Removing a suitable
subset from U if necessary, we may assume that one of the following holds: (a)
λi+1 (x) 6= −∞ for all x ∈ U; or (b) λi+1 (x) = −∞ and δ i (x) > δ i+1 (x) for all x ∈ U.
Notice that (b) can not occur unless i = s − 1, since λi+1 (x) 6= −∞ for i < s − 1.
Now we first assume that the scenario (a) occurs. Then there exist α > 0 and
real numbers hi , hi+1 , λi+1 , δ i , δi+1 with λi+1 < 0 such that
hi+1 − hi
< δ i − δ i+1 − α
(6.10)
λi+1
and for any ǫ > 0, there exists Bǫ ⊂ U with m(Bǫ ) > 0 so that for x ∈ Bǫ ,
|hi (x) − hi | < ǫ/2,

|hi+1 (x) − hi+1 | < ǫ/2,

λi+1 (x) < λi+1 + ǫ/2

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

41

and
δ i (x) ≥ δ i − ǫ/2, δ i+1 (x) < δ i+1 + ǫ/2.
Fix ǫ ∈ (0, −λi+1 /3). There exists n0 : Bǫ → N such that for m-a.e. x ∈ Bǫ and
n > n0 (x), we have

ξ
log mxi+1 B π (x, en(λi+1 +2ǫ) )
< δ i+1 + ǫ;
(1)
n(λi+1 + 2ǫ)
1
(2) − log mxξi+1 (P0n−1 (x)) > hi+1 − ǫ
(by (4.16));
n
(3) Qn,ǫ ∩ ξi (x) ∩ P0n−1 (x) ⊂ B π (x, en(λi+1 +2ǫ) )
(by (6.2));
1
(4) − log mξxi (Qn,ǫ ∩ P0n−1 (x)) < hi + ǫ
(by (6.3)).
n
Take N0 such that
∆ := {x ∈ Bǫ : n0 (x) ≤ N0 }
has the positive measure. By Lemma 2.5(1) and Lemma 2.2, there exist c > 0 and
∆′ ⊂ ∆ with m(∆′ ) > 0 such that for x ∈ ∆′ , there exists n = n(x) ≥ N0 such that
ξ

(5)

mxi+1 (L ∩ ∆)
ξ

mxi+1 (L)

> c, where

L := B π (x, en(λi+1 +2ǫ) );

log mξxi B π (x, 2en(λi+1 +2ǫ) )
> δ i − ǫ;
(6)
n(λi+1 + 2ǫ)
log(1/c)
(7)
< ǫ.
n
Take x ∈ ∆′ such that (1)–(7) are satisfied with n = n(x). Write C = ξi+1 (x) and
′
C = ξi (x). Then by (5) and (1),
mxξi+1 (L ∩ ∆) ≥ cmxξi+1 (L) ≥ cen(λi+1 +2ǫ)(δ i+1 +ǫ) .
ξ

But for each y ∈ L ∩ ∆, by (2), myi+1 (P0n−1 (y)) < e−n(hi+1 −ǫ) . It follows that the
number of distinct P0n−1 -atoms intersecting C ∩ L ∩ ∆ is larger than
mxξi+1 (L ∩ ∆)en(hi+1 −ǫ) .
However each such a P0n−1 -atom, say P0n−1 (y), intersects C ′ ∩L∩∆. This implies that
Qn,ǫ ∩ C ′ ∩ P0n−1 (y) is contained in C ′ ∩ B π (x, 2en(λi+1 +2ǫ) ). To see this implication,
let z ∈ P0n−1 (y) ∩ C ′ ∩ L ∩ ∆; since z ∈ L ∩ ∆, we have d(πz, πx) ≤ en(λi+1 +2ǫ) and
thus
Qn,ǫ ∩ C ′ ∩ P0n−1 (y) = Qn,ǫ ∩ ξi (z) ∩ P0n−1 (z)
⊂ B π (z, en(λi+1 +2ǫ) ) (by (3))
⊂ B π (x, 2en(λi+1 +2ǫ) ),
so Qn,ǫ ∩ C ′ ∩ P0n−1 (y) ⊂ C ′ ∩ B π (x, 2en(λi+1 +2ǫ) ), as desired. In the meantime, by
(4), mξxi (Qn,ǫ ∩P0n−1 (y)) ≥ e−n(hi +ǫ) . (To see it, picking w ∈ P0n−1 (y) ∩C ′ ∩L∩∆, we

42

DE-JUN FENG

have ξi (x) = ξi (w) and thus mξxi (Qn,ǫ ∩ P0n−1 (y)) = mξwi (Qn,ǫ ∩ P0n−1 (w)) ≥ e−n(hi +ǫ) .)
Hence
mxξi (B π (x, 2en(λi+1 +2ǫ) )) ≥ #{P0n−1 -atoms intersecting C ′ ∩ L ∩ ∆} · e−n(hi +ǫ)
≥ mxξi+1 (L ∩ ∆)en(hi+1 −ǫ) e−n(hi +ǫ)
≥ cen(λi+1 +2ǫ)(δi+1 +ǫ) en(hi+1 −ǫ) e−n(hi +ǫ) .
Combining the above inequality with (6) yields
(λi+1 + 2ǫ)(δ i − ǫ)
(6.11)

log c
+ hi+1 − hi − 2ǫ
n
≥ (λi+1 + 2ǫ)(δ i+1 + ǫ) + hi+1 − hi − 3ǫ.

≥ (λi+1 + 2ǫ)(δ i+1 + ǫ) +

Taking ǫ → 0 yields hi+1 − hi ≤ λi+1 (δ i − δ i+1 ), which leads to a contradiction with
(6.10) (keep in mind that λi+1 < 0).
Next we assume that the scenario (b) occurs, that is, λi+1 (x) = −∞ and δ i (x) >
δ i+1 (x) for all x ∈ U. In this case, i = s − 1, and thus by (C1), δ i+1 (x) = δ i+1 (x) = 0
for all x ∈ U. So δ i (x) > 0 for all x ∈ U. Hence there exist real numbers hi , hi+1 , δi
with δ i > 0, so that for any ǫ > 0, there exists Bǫ ⊂ U with m(Bǫ ) > 0 such that
for x ∈ Bǫ ,
|hi (x) − hi | < ǫ/2,

|hi+1 (x) − hi+1 | < ǫ/2,

δi (x) ≥ δ i − ǫ/2.

Set λi+1 = (−1/ǫ) − 2ǫ and δ i+1 = 0. Then an argument similar to that for the
scenario (a) shows that the previous estimates (1)-(7) hold, and moreover, the inequality (6.11) still holds. Taking ǫ → 0 gives δ i ≤ δ i+1 = 0, leads to a contradiction
with δ i > 0.

Proof of (C3). Here we give a proof by contradiction, following the lines of the
proof of [29, Theorem 2.11], in which the arguments were adapted from the original
proof of [46, Lemma 11.3.1]. Assume that (C3) is not true. Then there exists
i ∈ {−1, 0, . . . , s − 1} such that δi+1 (x) + ϑi (x) > δ i (x) on a subset of Σ′ with
positive measure. Hence there exist β > 0 and real numbers δ i , δ i+1 , ϑi such that
(6.12)

δ i+1 + ϑi > δ i + β,

and for any ǫ > 0, there exists Aǫ ⊂ Σ′ with m(Aǫ ) > 0 so that for x ∈ Aǫ ,
(6.13)

|δi (x) − δ i | < ǫ/2,

|δ i+1 (x) − δ i+1 | < ǫ/2,

|ϑi (x) − ϑi | < ǫ/2.

Let 0 < ǫ < β/4. Find N1 and a set A′ǫ ⊂ Aǫ with m(A′ǫ ) > 0 such that

(6.14)
mxξi+1 B π (x, 2e−n ) ≤ e−n(δi+1 −ǫ)
for x ∈ A′ǫ and n > N1 .

By Lemma 2.5(1) and Lemma 2.2, we can find c > 0 and A′′ǫ ⊂ A′ǫ with m(A′′ǫ ) > 0
and N2 > N1 such that for all x ∈ A′′ǫ and n ≥ N2 ,
mξxi (A′ǫ ∩ B π (x, e−n ))
mξxi (B π (x, e−n ))

> c.

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

43

For x ∈ A′′ǫ and n ≥ N2 , we have

(6.15)

mξxi (B π (x, e−n )) ≤ c−1 mξxi (A′ǫ ∩ B π (x, e−n ))
Z
−1
myξi+1 (A′ǫ ∩ B π (x, e−n )) dmξxi (y)
=c
Z
−1
myξi+1 (A′ǫ ∩ B π (x, e−n )) dmξxi (y),
=c
Γi+1 (x,e−n )

where in the last equality, we use the fact that y ∈ Γi+1 (x, e−n ), if y ∈ ξi (x) and
ξi+1 (y) ∩ A′ǫ ∩ B π (x, e−n ) 6= ∅. To see this fact, let y ∈ ξi (x) such that ξi+1 (y) ∩
A′ǫ ∩ B π (x, e−n ) 6= ∅. Take w ∈ ξi+1 (y) ∩ A′ǫ ∩ B π (x, e−n ). Then πw − πy ∈ Vyi+1 ,
kπw − πxk ≤ e−n and w − = y − = x− which implies Vwi+1 = Vyi+1 = Vxi+1 . Hence
dist(πy + Vxi+1 , πx + Vxi+1 ) = dist(πw + Vxi+1 , πx + Vxi+1 ) ≤ kπw − πxk ≤ e−n ,
and thus y ∈ Γi+1 (x, e−n ). This completes the proof of the fact. In the above
argument, since kπw − πxk ≤ e−n , we have A′ǫ ∩ B π (x, e−n ) ⊂ B π (w, 2e−n ) and thus
ξi+1
myξi+1 (A′ǫ ∩ B π (x, e−n )) = mw
(A′ǫ ∩ B π (x, e−n ))
ξi+1
≤ mw
(B π (w, 2e−n ))

≤ e−n(δi+1 −ǫ)

(by (6.14)).

Combining the above inequality with (6.15) yields
mξxi (B π (x, e−n )) ≤ c−1 e−n(δi+1 −ǫ) mξxi (Γi+1 (x, e−n ))

(x ∈ A′′ǫ , n ≥ N2 ).

Letting n → ∞, we obtain δ i (x) ≥ δ i+1 − ǫ + ϑi (x) for x ∈ A′′ǫ . Combining this with
(6.13) yields
δ i ≥ δ i+1 + ϑi − 4ǫ ≥ δi+1 + ϑi − β,
which contradicts (6.12).

So far we have proved Theorem 1.2(i) under the additional assumption (4.7). Now
we consider the general case that the integer functions s(x) and dim Vxi , 1 ≤ i ≤ s(x),
may not be constant over Σ′ . In such case, by Theorem 2.12 there exists a finite
Borel partition
k
G
′
Σ =
Σj
j=1

′

of Σ so that for each j, Σj is σ-invariant, and s(x) and dim Vxi are constant restricted
on Σj . Ignore those indices j with m(Σj ) = 0. We define probability measures mj
by
m|Σj
.
mj =
m(Σj )
Then mj ∈ Mσ (Σj ). Since now (4.7) holds for mj (in which Σ′ is replaced by Σj ),
we see that (6.9) holds when replacing m by mj . In particular, the local dimension
dimloc (π∗ (mj ), πx) exists for mj -a.e. x ∈ Σj . Equivalently,
(6.16)

log m(Σj ∩ B π (x, r))
r→0
log r
lim

exists for m-a.e. x ∈ Σj .

44

DE-JUN FENG

By Lemma 2.5(1) and Lemma 2.2, for m-a.e. x ∈ Σj , the following
m(Σj ∩ B π (x, r))
r→0
m(B π (x, r))
lim

exists and takes positive value. This together with (6.16) yields that the local
dimension dimloc (π∗ m, πx) exists for m-a.e. x ∈ Σj . Since j is arbitrarily taken,
dimloc (π∗ m, πx) exists for m-a.e. x ∈ Σ′ . This completes the proof of Theorem
1.2(i).

Proof of Theorems 1.2(ii) and 1.3. Since now m is assumed to be ergodic, the condition (4.7) holds and the functions λi (x), hi (x) (i = −1, . . . , s) considered in the
proof of Theorem 1.2(i) are all constant, which we denote by λi , hi respectively. The
formula (1.6) just follows from (6.9).

Proof of Theorem 1.4. It is based on the proof of Theorem 1.2. To see (1.7), let
i ∈ {0, . . . , s − 1}. By (6.8), for m-a.e. x ∈ Σ′ ,
π∗ mξxi

dimloc



s−1
X

hk+1 − hk
.
, πx = δi =
λk+1
k=i

Equivalently, for m-a.e. x ∈ Σ′ and mξxi -a.e. y ∈ ξi (x),

s−1
X


hk+1 − hk
.
dimloc π∗ mξxi , πy = δi =
λk+1
k=i



Hence for m-a.e. x ∈ Σ′ , π∗ mξxi is exact dimensional with dimension given by (1.7).
Next we prove (1.8) and (1.9). By (6.7), for m-a.e. x ∈ Σ′ ,
(6.17)

ϑi (x) = ϑi :=

hi+1 − hi
λi+1

for i = −1, 0, . . . , s − 1.

Let Γi (x, r) (x ∈ Σ′ ), 0 ≤ i ≤ s, be defined as in (6.4).
Fix j ∈ {1, . . . , s}. For i = −1, 0, . . . , j and x ∈ Σ′ , define
log mξxi (Γj (x, r))
γ i,j (x) = lim sup
,
log r
r→0

log mξxi (Γj (x, r))
γ i,j (x) = lim inf
.
r→0
log r

We claim that
(6.18)
where g :

ξi (x) ∩ Γj (x, r) = ξi (x) ∩ g −1(B(gx, r)),
ξi (x) → (Vxj )

⊥

is defined by y 7→ P(V j )⊥ (πy). To see this, let y ∈
x

ξi (x) ∩ Γj (x, r). Then dist(πy + Vxj , πx + Vxj ) ≤ r, equivalently, kgy − gxk ≤ r; hence
y ∈ g −1 (B(gx, r)). This proves the direction ξi (x) ∩ Γj (x, r) ⊂ ξi (x) ∩ g −1 (B(gx, r)).
The other direction can be proved similarly. This completes the proof of (6.18).

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

45

Now due to (6.18), we have mξxi (Γj (x, r)) = mξxi (g −1(B(gx, r))), and so




γ i,j (x) = dimloc P(V j )⊥ π ∗ mξxi , P(V j )⊥ (πx) ,
x
x


(6.19)


ξi
γ i,j (x) = dimloc P(V j )⊥ π ∗ mx , P(V j )⊥ (πx) .
x

x

We claim that for m-a.e. x ∈ Σ′ , the following properties hold:

(D1) γ j,j (x) = γ j,j (x) = 0.
(D2) hi − hi+1 ≥ −λi+1 (γ i,j (x) − γ i+1,j (x)) for i = −1, 0, . . . , j − 1.
(D3) γ i+1,j (x) + ϑi ≤ γ i,j (x) for i = −1, 0, . . . , j − 1.
Clearly (D1)-(D3) together with (6.17) force that for m-a.e. x ∈ Σ′ ,
for i = j, j − 1, . . . , 0, −1,

γ i,j (x) = γ i,j (x)

(we write the common value as γi,j (x)), and furthermore
(6.20)

γ−1,j (x) =

j−1
X

ϑk =

k=0
j−1

(6.21)

γi,j (x) =

j−1
X
hk+1 − hk
k=0

X hk+1 − hk
k=i

λk+1

λk+1

and

for i ∈ {0, 1, . . . , j − 1}.

Now (1.9) just follows from (6.20) and the fact (6.19). To see (1.8), let i ∈ {0, . . . , j−
1}. By (6.21) and (6.19), we have for m-a.e. x ∈ Σ′ and mξxi -a.e. y ∈ ξi (x),
dimloc



P(V j )⊥ π
x



mξxi
∗

j−1

X

hk+1 − hk
, P(V j )⊥ (πy) = γi,j (x) =
,
x
λk+1
k=i

where we use the fact that Vyi = Vxi for y ∈ ξi (x), due to y ∈ ξ0 (x) (see Lemma 4.1).


As a consequence, for m-a.e. x ∈ Σ′ , P(V j )⊥ π ∗ mξxi is exact dimensional and (1.8)
x
holds. To complete the proof of Theorem 1.4, in the following we prove (D1)-(D3)
respectively.
By the definition of ξj , for x ∈ Σ′ and y ∈ ξj (x), we have πy − πx ∈ Vxj and
thus πy + Vxj = πx + Vxj . It follows that y ∈ Γj (x, r). Hence ξj (x) ⊂ Γj (x, r) and
thus mjx (Γj (x, r)) = 1 for x ∈ Σ′ and any r > 0. Hence γ j,j (x) = γ j,j (x) = 0 for all
x ∈ Σ′ . This proves (D1).
The proofs of (D2) and (D3) are almost identical to that of (C2) and (C3), respectively. Indeed we only need to modify the proofs of (C2) and (C3) slightly. More
precisely, among other minor adjustments, we may simply replace the terms δi , δi+1 ,
B π (x, en(λi+1 +2ǫ) ), B π (x, 2en(λi+1 +2ǫ) ), B π (x, e−n ) therein by γi,j , γi+1,j , Γj (x, en(λi+1 +2ǫ) ),
Γj (x, 2en(λi+1 +2ǫ) ), and Γj (x, e−n ) respectively. This completes the proof of Theorem
1.4.

As a corollary of Theorem 1.4, we have

46

DE-JUN FENG

Corollary 6.1. Under the assumptions of Theorem 1.3, for i ∈ {0, . . . , s − 1} and
m-a.e. x ∈ Σ′ ,
(6.22)

hi+1 − hi
log mξxi (Γi+1 (x, r))
≤ ki+1 .
=
r→0
log r
λi+1

ϑi (x) = lim

Proof. Fix i ∈ {0, . . . , s − 1}. As is proved in Theorem 1.4, for m-a.e. x ∈ Σ′ ,
log mξxi (Γi+1 (x, r))
hi+1 − hi
.
= γi,i+1 (x) =
r→0
log r
λi+1
lim

−hi
≤ ki+1 . By Theorem 1.4, for
To see (6.22) it remains to prove that hi+1
λi+1


′
m-a.e. x ∈ Σ , the measure ηx := P(V i+1 )⊥ π ∗ mξxi is exact dimensional with
x

−hi
dimension hi+1
. However, ηx is supported on the affine subspace πx + (Vxi ⊖ Vxi+1 )
λi+1
of dimension ki+1 , where Vxi ⊖ Vxi+1 stands for the orthogonal complement of Vxi+1
−hi
in Vxi . Hence dimH ηx ≤ ki+1 , and so, hi+1
≤ ki+1 .

λi+1

Lemma 6.2.  (i) Let m ∈ Mσ (Σ) be quasi-Bernoulli. Then for m-a.e. x ∈ Σ,
π∗ mξx0 is strongly equivalent to π∗ m.

(ii) Let m ∈ Mσ (Σ) be sub-multiplicative. Then for m-a.e. x ∈ Σ, π∗ mξx0 is
absolutely continuous with respect to π∗ m.
Proof. We first prove (i). Since m is quasi-Bernoulli, by definition there exists a
positive constant C such that
C −1 m([I])m([J]) ≤ m([IJ]) ≤ Cm([I])m([J])
for all finite words I, J over Λ. Below we show that for m-a.e. x ∈ Σ,
(6.23)

C −1 m([I]) ≤ mξx0 ([I]) ≤ Cm([I])

for all finite words
 I over Λ. This is enough to conclude the strong equivalence
between π∗ mξx0 and π∗ m, since πx only depends on x+ := (xn )∞
n=0 .

To see (6.23), note that the measurable partition ξ0 is induced by the mapping
τ : Σ → Σ− , x 7→ x− = (xn )−1
−∞ . That is, ξ0 (x) = {y ∈ Σ : τ y = τ x} for every x.
Applying Lemma 2.5(1) to τ : Σ → Σ− yields that for m-a.e. x,
(6.24)

m([x−n . . . x−1 I])
n→∞ m([x−n . . . x−1 ])

mξx0 ([I]) = Em (χ[I] |τ −1 (B(Σ− )))(x) = lim

for all finite words I over Λ. (6.23) is then obtained from the quasi-Bernoulli property
of m.
Next we prove (ii). Here m is assumed to be sub-multiplicative and we only have
the one-sided inequality m([IJ]) ≤ Cm([I])m([J]). However this is enough to derive
from (6.24) that for m-a.e.
x, mξx0 ([I]) ≤ Cm([I]) for all finite words I over Λ. As a

consequence, π∗ mξx0 is absolutely continuous with respect to π∗ m, with a uniformly
bounded Radon-Nikodym derivative.


DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

47

Proof of Theorem 1.6. We
 first prove (i).
 Fixξ i ∈ {1, . . . , s − 1}. By Theorem 1.4,
′
ξi
for m-a.e. x ∈ Σ , π∗ mx and P(Vxi )⊥ π ∗ mx0 are exact dimensional with
dimH π∗ mξxi

and
dimH
hence,
(6.25)

dimH π∗ mξxi

P(Vxi )⊥ π






=

mξx0
∗

+ dimH

s−1
X
hk+1 − hk

λk+1

k=i



=

P(Vxi )⊥ π

i−1
X
hk+1 − hk

λk+1

k=0



∗

mξx0



,

= dimH π∗ mξx0



.

Next let x ∈ Σ′ and write W = Vxi , ν = mξx0 , η = π∗ ν. Notice that ν is supported
on ξ0 (x). Consider the measurable partition ζ of Rd given by
ζ := {W + a : a ∈ W ⊥ }.
Set π −1 ζ := {ξ0 (x) ∩ π −1 (W + a) : a ∈ W ⊥ }. Then π −1 ζ is a measurable partition
−1
of ξ0 (x). Let {νyπ ζ }y∈ξ0 (x) be the system of conditional measures of ν associated
with π −1 ζ, and {ηzζ }z∈Rd the system of conditional measures of η associated with ζ.
Write ηW,z := ηzζ . By the uniqueness of conditional measures, we have for ν-a.e. y,
−1 
(6.26)
π∗ νyπ ζ = ηW,πy .

Notice also that for y ∈ ξ0 (x), the atom (π −1 ζ)(y) is nothing but ξi (y). Hence we
−1
have νyπ ζ = mξyi for m-a.e. x and mξx0 -a.e. y. This combining with (6.26) gives


(6.27)
π∗ mξxi = π∗ mξx0 V i ,πx
x

for m-a.e. x. Plugging the above equality into (6.25), we see that π∗ mξx0 satisfies
dimension conservation along Vxi . This proves (i).

Now we turn to the proof of (ii). Suppose that m is quasi-Bernoulli. By Lemma
6.2(i), for m-a.e. x ∈ Σ′ , π∗ mξx0 is strongly equivalent to µ = π∗ m; as a consequence, P(Vxi )⊥ π ∗ mξx0 is strongly equivalent to P(Vxi )⊥ ∗ µ. It follows that

P
hk+1 −hk
for m-a.e. x ∈ Σ′ , P(Vxi )⊥ ∗ µ is exact dimensional with dimension i−1
k=0 λk+1 .


Equivalently, for Πi ∗ m-a.e. W , PW ⊥ ∗ µ is exact dimensional with dimension
Pi−1 hk+1 −hk
k=0 λk+1 .

Again since π∗ mξx0 is strongly equivalent to µ for m-a.e. x, applying Lemma
2.8 to the orthogonal projection
P(Vxi )⊥ : Rd → (Vxi )⊥ , we see that m-a.e. x, µVxi ,πx

is equivalent to π∗ mξx0 V i ,πx = π∗ mξxi , and so µVxi ,πx is exact dimensional with
x

Ps−1 hk+1 −hk
dimension k=i
.
Equivalently,
for
Π
m-a.e. W and µ-a.e. z, µW,z is exact
i
λk+1
∗
Ps−1 hk+1 −hk
. Recall that we have proved that for
dimensional with dimension
k=i
λk+1


P
hk+1 −hk
Πi ∗ m-a.e. W , PW ⊥ ∗ µ is exact dimensional with dimension i−1
k=0 λk+1 . This
is enough to conclude (ii).

48

DE-JUN FENG

Finally, we prove (iii). Suppose that m is sub-multiplicative. By Lemma 6.2(ii),
for m-a.e. x ∈ Σ′ , π∗ mξx0 is absolutely continuous with respect to µ. Hence there
exists H ⊂ Σ′ with full m-measure such that for any x ∈ H, there exists a Borel
set Fx ⊂ Rd with positive µ-measure such that (π∗ mξx0 )Fx is strongly equivalent to
µFx , where νA stands for the probability measure defined by νA (·) = ν(A ∩ ·)/ν(A).
As is proved in part (ii), when m is quasi-Bernoulli, we can take Fx = Σ′ .
Now fix x ∈ H and i ∈ {1, . . . , s − 1}. Set W = Vxi and write for convenience


η := π∗ mξx0 , η ′ := (π∗ mξx0 )Fx , µ′ := µFx .

Applying Lemma 2.9 to the projection PW ⊥ : Rd → Rd and using the Borel density
lemma, we see that for µ-a.e. z ∈ Fx (equivalently for η-a.e. z ∈ Fx ),
dimloc ((η ′ )W,z , z) = dimloc (ηW,z , z),
(6.28)

dimloc
dimloc

dimloc ((µ′ )W,z , z) = dimloc (µW,z , z),




PW ⊥ ∗ η ′ , PW ⊥ (z) = dimloc PW ⊥ ∗ η, PW ⊥ (z) ,




PW ⊥ ∗ µ′ , PW ⊥ (z) = dimloc PW ⊥ ∗ µ, PW ⊥ (z) .

Since η ′ and µ′ are strongly equivalent, by Lemma 2.8, for µ-a.e. z ∈ Fx ,
dimloc

dimloc ((η ′ )W,z , z) = dimloc ((µ′ )W,z , z),




PW ⊥ ∗ η ′ , PW ⊥ (z) = dimloc PW ⊥ ∗ µ′ , PW ⊥ (z) .

Combining the above equalities with (6.28) yields that for µ-a.e. z ∈ Fx ,
dimloc

dimloc (µW,z , z) = dimloc (ηW,z , z),




PW ⊥ ∗ µ, PW ⊥ (z) = dimloc PW ⊥ ∗ η, PW ⊥ (z) .

Now (iii) follows from (i). This completes the proof of the theorem.



Proof of Theorem 1.7. Here we only give a sketched proof. It is based on [29, Theorem 2.11] and its proof.
Since the linear parts Mj of S commute, Rd can be decomposed into the direct
sum T1 ⊕ · · · ⊕ Tℓ of some subspaces with dimensions q1 , . . . , qℓ , so that for each pair
(j, p) ∈ Λ × {1, . . . , ℓ}, Mj Tp ⊂ Tp and Mj is “weakly conformal” on Tp in the sense
that there exists aj,p ≥ 0 so that limn→∞ kMjn vk1/n = aj,p for v ∈ Tp \{0}. Hence
under a suitable coordinate change, S can be written as the direct product of some
“weakly conformal” affine IFSs S1 , . . . , Sℓ on Rq1 ,. . . , Rqℓ (cf. [29, Definition 2.10]).
P
Set λp = j∈Λ m([j]) log aj,p for p = 1, . . . , ℓ. Permutating Sj ’s if necessary, we
may assume that
λ1 ≥ · · · ≥ λℓ .
For p ∈ {1, . . . , ℓ} and let τp be the orthogonal projection from Rd to Yp :=
ζ
Rq1 × · · · × Rqp , and let mxp be the conditional measure of m associated with the
measurable partition {π −1 ◦ τp−1 (y) : y ∈ Yp } of Σ. It is implicitly proved in [29,
Theorem 2.11] that there exist hm (σ) = h0 ≥ h1 ≥ · · · ≥ hℓ ≥ 0 such that for
ζ 
m-a.e. x ∈ Σ and p ∈ {1, . . . , ℓ − 1}, the measure π∗ mxp is exact dimensional

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

49

Pℓ−1 hj+1 −hj
, and moreover, µ = π∗ m is exact dimensional with
with dimension j=p
λj+1
Pℓ−1 hj+1 −hj
. (We remark that this is only proved in [29] in the case
dimension j=0 λ
j+1
when S is invertible and contracting. But it can be extended to the general case
like Theorem 1.6.) Applying this result to the IFS S1 × · · · × Sp gives that (τp )∗ µ is
P
hj+1 −hj
exact dimensional with dimension p−1
.
j=0 λ
j+1

Set µ = π∗ m. Let {µYp⊥ ,z } denote the system of conditional measures of µ associated with the measurable partition {τp−1 (y) : y ∈ Yp } of Rd . Similar to the proof
ζ 
of (6.27), we can show that for m-a.e. x ∈ Σ, µYp⊥ ,πx = π∗ mxp . It follows that µ
is dimension conserving with respect to the projection τp . Moreover, µYp⊥ ,z is exact
dimensional for µ-a.e z.
Now let 1 ≤ p1 < · · · < ps′ = ℓ be those integers so that
λ1 = · · · = λp1 > λp1 +1 = · · · = λp2 > · · · > λps′ −1 +1 = · · · = λps′ .

It is readily checked that s = s′ , λi = λpi and Vxi = Wi := Yp⊥i for 1 ≤ i ≤ s and
m-a.e x. In particular, P(Wi )⊥ = τpi for i = 1, . . . , s − 1. Hence µ is dimension
conserving with respect to the projections P(Wi )⊥ , i = 1, . . . , s − 1.

Remark 6.3. The proof of Theorem 1.7 implies the following result: Let S =
{Sj (x) = rj x + aj }j∈Λ be a self-similar IFS on Rd with rj > 0, average contracting
with respect to an ergodic m ∈ Mσ (Σ). Then for any proper subspace W of Rd , π∗ m
is dimension conserving with respect to PW . This generalizes the result in [25, 34].
To see it, let p = dim W and let v1 , . . . , vd be an orthonormal basis of Rd such that
span(v1 , . . . , vp ) = W . Then one can check that S can be written as the product
S1 × · · · × Sd of some one-dimensional IFSs on X1 , . . . , Xd , where Xi = span(vi ), and
moreover λ1 = · · · = λd . Now the desired dimension conservation property follows
from the proof of Theorem 1.7.
7. Lyapunov dimension
Throughout this section, let m be an ergodic σ-invariant measure on Σ and M =
(Mj )j∈Λ be a tuple of d × d real matrices satisfying
Z
1
λ(M, m) := lim
log kMx0 · · · Mxn−1 k dm(x) < 0.
n→∞ n
Let S = {Sj (x) = Mj x + aj }j∈Λ be an affine IFS on Rd . Let {(λi , ki )}1≤i≤s be the
Lyapunov spectrum of M with respect to (Σ, σ −1 , m). Set
L0 = 0

and

Li = −

i
X

λℓ kℓ for i = 1, . . . , s.

ℓ=1

Clearly L0 < L1 < · · · < Ls . Following [42], we give the following.

50

DE-JUN FENG

Definition 7.1. The Lyapunov dimension of m with respect to M, denoted as
dimLY (m, M), is defined to be

!
j−1

X
hm (σ) − Lj−1



if Lj−1 ≤ hm (σ) < Lj for some j ∈ {1, . . . , s},
kℓ +


(−λ
j)
ℓ=0



d hm (σ)



Ls

if hm (σ) ≥ Ls .

Let π be the coding map associated with S. Recall that hi , 0 ≤ i ≤ s, are the
conditional entropies of m defined in (1.5), and h0 = hm (σ). The following result
says that the Lyapunov dimension of m is always an upper bound for the Hausdorff
dimension of π∗ m. This result was first proved in [42] under a stronger assumption
that kMj k < 1 for all j.
Proposition 7.2. dimH π∗ m ≤ min{d, dimLY (m, M)}. Moreover, the equality holds
if and only if one of the following holds:
(1) hm (σ) ≥ Ls , and hi = hm (σ) − Li for all i ∈ {1, . . . , s}.
(2) hm (σ) ∈ [Lj−1 , Lj ) for some j ∈ {1, . . . , s}, and

hm (σ) − Li if 1 ≤ i ≤ j − 1,
hi =
0
if j ≤ i ≤ s.
Proof. Since λ(M, m) < 0, the IFS S is average contracting with repect to m. By
Ps−1 hi+1 −hi
. Recall that
Theorem 1.3, dimH π∗ m = i=0
λi+1
0 > λ(M, m) = λ1 > · · · > λs ≥ −∞,

and
hm (σ) = h0 ≥ h1 ≥ · · · ≥ hs ≥ 0.
Moreover by Corollary 6.1, hi − hi+1 ≤ (−λi+1 )ki+1 for each i. Hence dimH π∗ m is
bounded above by
)
( s−1
X xi+1 − xi
xi+1 − xi
: hm (σ) = x0 ≥ · · · ≥ xs ≥ 0,
≤ ki+1 for all i .
∆ := max
λi+1
λi+1
i=0
Now it is readily checked that the following hold: (a) if hm (σ) ≥ Ls , then ∆ = d
and the maximum in defining ∆ is attained uniquely at (x0 , x1 , . . . , xs ) where xi =
hm (σ) − Li for 0 ≤ i ≤ s; (b) if hm (σ) ∈ [Lj−1 , Lj ) for some j ∈ {1, . . . , s}, then
!
j−1
X
hm (σ) − Lj−1
kℓ +
∆=
,
(−λj )
ℓ=0
and the maximum is attained uniquely at (x1 , . . . , xs ) where xi = hm (σ) − Li for
i ≤ j − 1 and 0 for i ≥ j. As a consequence, the results of the proposition hold. 

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

51

Remark 7.3. By Proposition 7.2, if dimH π∗ m = min{d, dimLY (m, M)}, then
j
X
hℓ − hℓ−1
ℓ=1

λℓ

= min{k1 + · · · + kj , dimH π∗ m}

for j = 1, . . . , s.

This result was partially proved in [4, Corollay 2.7].
Proposition 7.4. Suppose that S is contracting and satisfies the strong separation
condition. Then the following statements hold.
(i) hs = 0, hm (σ) < Ls and dimLY (m, M) < d.
(ii) Let j be the unique element in {1, . . . , s} so that Lj−1 ≤ hm (σ) < Lj . Then
dimH π∗ m = dimLY (m, M) if and only if
(7.1)

j−1
X
hℓ − hℓ−1
ℓ=1

λℓ

= dj−1,

s
X
hℓ − hℓ−1
= 0,
λ
ℓ
ℓ=j+1

where d0 := 0 and di := k1 + · · · + ki for 1 ≤ i ≤ s.

Proof. (i) We first claim that hs = 0. Since S satisfies the strong separation condition, ξs (x) = {x} for each x ∈ Σ′ . Thus ξbs = B(Σ′ ) and hence hs = Hm (P|ξbs ) = 0.

Next we prove that hm (σ) < Ls . Clearly this is true if Ls = ∞ (equivalently, if
λs = −∞). Below we assume that λs > −∞.
Let K denote the self-affine set generated by S. For δ > 0 let Kδ be the closed
δ-neighborhood of K, i.e. Kδ = {z : d(z, K) ≤ δ}. Since S satisfies the strong
separation condition, we can pick a small δ such P
that Si (Kδ ) (i ∈ Λ) are disjoint
d
d
subsets
P of the interior of Kδ and hence L (Kδ ) > i∈Λ L (Si (Kδ )). It follows that
ρ := i∈Λ | det(Mi )| < 1.
Since m is ergodic σ-invariant, by [31, Lemma 3.2] and the Shannon-McMillanBreiman theorem, for m-a.e. x ∈ Σ,
log | det(Mx0 ...xn−1 )|
log m([x0 . . . xn−1 ])
(7.2)
lim
= −Ls , lim
= −hm (σ).
n→∞
n→∞
n
n

For ǫ > 0 and n ∈ N, let Λn,ǫ denote the set of words I of length n over the
alphabet Λ such that
| det(MI )| ≥ e−nLs −nǫ , m([I]) ≤ e−nhm (σ)+nǫ .
P
By (7.2), limn→∞ I∈Λn,ǫ m([I]) = 1. Notice that
X
X
| det(MI )|
| det(MI )| ≥
ρn =
I∈Λn

≥

X

I∈Λn,ǫ

I∈Λn,ǫ

e−nLs −nǫ

m([I])

e−nhm (σ)+nǫ


= e−n(Ls −hm (σ)+2ǫ) · 

X

I∈Λn,ǫ



m([I]) .

52

DE-JUN FENG

Letting n → ∞ and ǫ → 0, we obtain the desired inequality hm (σ) ≤ Ls +log ρ < Ls .
Now the inequality dimLY (m, M) < d follows directly from Definition 7.1. This
proves (i).
Finally we prove (ii). Since hs = 0 and 0 ≤ hℓ−1 − hℓ ≤ (−λℓ )kℓ for each ℓ
by Corollary 6.1, we see that (7.1) holds if and only if hℓ−1 − hℓ = (−λℓ )kℓ for
1 ≤ ℓ ≤ j − 1 and hℓ = 0 for j ≤ ℓ ≤ s. By Proposition 7.2, this is equivalent to
that dimH π∗ m = dimLY (m, M).

Remark 7.5. Theorem 1.6 (resp. Theorem 1.7) can be applied to estimate the
dimension of slices and projections of certain self-affine sets. To see it, let K a selfaffine sets generated by a contracting affine IFS {Sj = Mj x + aj }j∈Λ on Rd . Suppose
that there exists an ergodic m ∈ Mσ (Σ) so that
(7.3)

dimH π∗ m = dimH K.

Follow the notation in Theorem 1.6 and assume s ≥ 2. Since the slicing measures
(π∗ (mξx0 ))Vxi ,y are supported on the slices K ∩ (Vxi + y), by using Theorem 1.6(i)
and a general inequality in Theorem 2.10.25 of Federer [28], we obtain that for
i ∈ {1, . . . , s − 1} and m-a.e. x,
dimH K ∩ (Vxi + y) =

s−1
X
hℓ+1 − hℓ
ℓ=i

and
(7.4)
dimH

(

λℓ+1

for P(Vxi )⊥ π

y ∈ P(Vxi )⊥ (K) : dimH K ∩ (Vxi + y) =



∗


mξx0 -a.e. y ∈ (Vxi )⊥

s−1
X
hℓ+1 − hℓ
ℓ=i

λℓ+1

)

If in addition to the assumption (7.3), we further assume that

=

i−1
X
hℓ+1 − hℓ
ℓ=0

λℓ+1

.

dimH π∗ m = dimLY (m, M),
then
(7.5)

dimH P(Vxi )⊥ (K) = min{dim(Vxi )⊥ , dimH K}

for m-a.e. x.

Indeed by Remark 7.3, the sum in the right-hand side of (7.4) is equal to
min{dim(Vxi )⊥ , dimH π∗ m},
and hence equal to min{dim(Vxi )⊥ , dimH K}. Now (7.5) follows from (7.4).
8. Semi-continuity of entropies and dimensions
In this section, we prove Theorems 1.8-1.10. Set
∞
X
(8.1)
f (x) =
kMx0 · · · Mxn−1 k for x ∈ Σ.
n=1

Lemma 8.1.
Let η be a Borel probability measure on Σ with η({f
 = ∞}) = 0.

Then πa ∗ η depends continuously on a, in the sense that πan ∗ η converges to

πa ∗ η weakly when an converges to a.

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

53

Proof. For x ∈ Σ with f (x) < ∞, πa (x) is well-defined for every a ∈ Rd|Λ| and
moreover,
(8.2)

kπa (x) − πb (x)k ≤ f (x)ka − bk.

For N ∈ N, set AN := {x : f (x) < N}. Since η({f = ∞}) = 0, it follows that
η(AN ) → 1 as N → ∞.

Let (an ) ⊂ Rd|Λ| so that limn→∞ an = a. For convenience, write νn = πan ∗ η and

ν = πa ∗ η. To show that νn converges weakly to ν, by the Portmanteau theorem,
it suffices to show that lim supn→∞ νn (F ) ≤ ν(F ) for any compact set F ⊂ Rd .

Now fix a compact set F ⊂ Rd . Let ǫ > 0. Take a small r > 0 so that ν(Vr (F )) ≤
ν(F ) + ǫ, where Vr (F ) stands for the r-neighborhood of F . Take a large N so that
η(Σ \ AN ) < ǫ. Pick n0 so that kan − ak < r/N when n ≥ n0 .

By (8.2), for x ∈ AN and n ≥ n0 we have kπan (x) − πa (x)k ≤ Nkan − ak < r.
Hence AN ∩ πa−1
(F ) ⊂ AN ∩ πa−1 (Vr (F )) for n ≥ n0 . It follows that for n ≥ n0 ,
n
(F ))
νn (F ) = η(πa−1
n
(F ))
≤ η(Σ \ AN ) + η(AN ∩ πa−1
n
≤ ǫ + η(AN ∩ πa−1 (Vr (F )))
≤ ǫ + ν(Vr (F ))
≤ ν(F ) + 2ǫ.
Hence lim supn→∞ νn (F ) ≤ ν(F ) + 2ǫ. Letting ǫ → 0 gives lim supn→∞ νn (F ) ≤
ν(F ), as desired.

Proof of Theorem 1.8. We first prove part (1) of the theorem. This is done by
extending an idea of Rapaport [64, Lemma 8].
It is implicitly proved in Proposition 3.1 that m({f = ∞}) = 0, where f is defined
as in (8.1). Let i ∈ {1, . . . , s} and write ξi,a for ξi so as to emphasize its dependence
on a. Since
Z
0 = m({f = ∞}) = mξxi,a ({f = ∞})dm(x),
n
o
ξ
the set ∆a := x ∈ Σ′ : mxi,a ({f = ∞}) = 0 has full m-measure.

Noticing that ξ0 is independent of a, and ξi,a is a refinement of ξ0 (i.e. any set in
ξi,a is a subset of an element in ξ0 ), we have
hi,a = Hm (P|ξi,a )
Z
= − log mξxi,a (P(x)) dm(x)
Z Z
=
− log mξyi,a (P(y)) dmξx0 (y) dm(x)
Z
= Hmξx0 (P|ξi,a ) dm(x).

54

DE-JUN FENG

Fix a0 ∈ Rd|Λ| . In what follows we show that
R hi,a is upper semi-continuous in a
at a0 . Since ∆a0 has full m-measure, hi,a = ∆a Hmξx0 (P|ξi,a ) dm(x). Hence it is
0
sufficient to show that a 7→ Hmξx0 (P|ξi,a ) is upper semi-continuous at a0 for every
x ∈ ∆a0 . For this purpose, fix x ∈ ∆a0 and write C = ξ0 (x), W = Vxi and mC = mξx0 .
Then by the definition of ξi,a ,
−1
⊥
Hmξx0 (P|ξi,a ) = HmC (P|πa−1 ◦ PW
⊥ (B(W ))).

Following the proof of [71, Lemma 8.5] or [64, Lemma 8] with minor changes, we
can construct a sequence (βn ) of finite Borel partitionsSof W ⊥ such that (i) σ(βn ) ↑
−1
⊥
B(W ⊥ ) and (ii) mC ◦ πa−1
(PW
⊥ (∂B)) = 0 for any B ∈
n βn . Since σ(βn ) ↑ B(W ),
0
−1
⊥
−1
−1
HmC (P|πa−1 ◦ PW
◦ PW
⊥ (B(W )) = lim HmC (P|πa
⊥ (σ(βn ))
n→∞
"
X X

−1
u (mC |A ) ◦ πa−1 (PW
= lim
⊥ (B))
n→∞

A∈P B∈βn

−

X

−1
u mC ◦ πa−1 (PW
⊥ (B))

B∈βn



#

,

where u(z) := −z log z and mC |A (E) = mC (A ∩ E). Since x ∈ ∆a0 , mC ({f =
∞}) = 0. By Lemma 8.1, the measures (πa)∗ (mC ) and (πa )∗ (mC |A ) (A ∈ P)
depend continuously on a; and so do PW ⊥ πa ∗ (mC ) and PW ⊥ πa ∗ (mC |A ). For
S
−1
A ∈ P and B ∈ n βn , since mC ◦ πa−1
(PW
⊥ (∂B)) = 0, we have also (mC |A ) ◦
0

−1
−1
−1
−1
(P
(B))
and
πa0 (PW ⊥ (∂B)) = 0; it follows
that,
as
functions
of
a,
u
m
◦
π
C
⊥
a
W

−1
−1
−1
u (mC |A ) ◦ πa (PW ⊥ (B)) (A ∈ P) are continuous at a0 , and so is HmC (P|πa ◦
−1
−1
⊥
−1
PW
◦ PW
⊥ (σ(βn )). Hence a 7→ HmC (P|πa
⊥ (B(W )) is upper semi-continuous at
a0 , as desired. This proves the upper semi-continuity of hi,a .
Next we prove the lower semi-continuity of the mapping a 7→ dimH ((πa )∗ m). By
Theorem 1.3, we have
(8.3)

dimH ((πa )∗ m) =

s
X

ti hi,a ,

i=0

1
for i = 1, . . . , s, with convention λs+1 := −∞.
where t0 = − λ11 and ti = λ1i − λi+1
Notice that t0 > 0, ti ≤ 0 for 1 ≤ i ≤ s and moreover, h0,a ≡ hσ (m). By part (1),
h1,a , . . . , hs,a are upper semi-continuous in a. Hence by (8.3), dimH ((πa )∗ m) is lower
semi-continuous in a.


Remark 8.2. Theorem 1.8 can be further extended. For given m and M = (Mj )j∈Λ ,
let Sr,a denote the IFS {rj Mj x + aj }j∈Λ where r = (rj )j∈Λ ∈ (R\{0})Λ so that Sr,a
is average contracting with respect to m. Notice that the Oseledets subspaces with
respect to m and (rj Mj )j∈Λ are independent of r. A slight modification of the
above proof establishes the upper semi-continuity of (r, a) 7→ hi,r,a and the lower
semi-continuity of (r, a) 7→ dimH ((πr,a )∗ m).

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

55

Similarly, for given m let Sr,O,a denote the IFS {rj Oj x + aj }j∈Λ of similitudes,
where r = (rj )j∈Λ ∈ (R\{0})Λ , O = (Oj )j∈Λ ∈ O(d)Λ , a = (aj )j∈Λ ∈ Rd|Λ| so that
Sr,O,a is average contracting with respect to m. Then the mapping (r, O, a) 7→
dimH ((πr,O,a )∗ m) is lower semi-continuous.
Proof of Theorem 1.9. We first prove (i). Let m be an ergodic σ-invariant measure
m on Σ. For n ∈ N, set


1
d|Λ|
.
Ωn := a ∈ R
: dimH ((πa )∗ m) ≤ min(d, dimLY (m, M)) −
n
Since dimH ((πa )∗ m) is lower semi-continuous in a by Theorem 1.8, Ωn is closed for
each n. Meanwhile, it was proved in [42] that dimH ((πa )∗ m) = min(d, dimLY (m, M))
for Ld|Λ| -a.e. a. Hence for each n, Ωn is a closed set of zero Lebesgue measure, so it
is nowhere dense. This is enough to conclude (i).
Next we prove (ii). It was shown by Käenmäki [43] that there exists an ergodic
σ-invariant measure η on Σ such that dimLY (η, M) = dimAFF (M). Fix such η. Note
that for each a,
dimH ((πa )∗ η) ≤ dimH K(M, a) ≤ min(d, dimAFF (M)).
It implies that

a ∈ Rd|Λ| : dimH K(M, a) 6= min(d, dimAFF (M))

⊂ a ∈ Rd|Λ| : dimH ((πa )∗ η) 6= min(d, dimLY (η, M)) .

Now (ii) follows from (i).



To prove Theorem 1.10 we need the following.
Lemma 8.3 ([64, Lemma 22]). Let µ be a probability Borel measure on Rd and
1 ≤ k < d. Then the following statements hold.
(i) If dimH µ ≤ k then for 0 < t ≤ dimH µ,
dimH {W ∈ G(d, k) : dimH ((PW )∗ µ) < t} ≤ k(d − k − 1) + t.
(ii) If dimH µ ≥ k then for dimH µ − k(d − k) < t ≤ k,
dimH {W ∈ G(d, k) : dimH ((PW )∗ µ) < t} ≤ k(d − k) + t − dimH µ.
Proof of Theorem 1.10. The proof is mainly adapted from [64]. For the convenience
of the reader, we include the details. Write µ = π∗ m. Since S satisfies
P the strong
separation condition, by Proposition 7.4 we have hs = 0, hm (σ) < sℓ=1 (−λℓ )kℓ
and dimLY (m, M) < d. Let i be the unique element in {1, . . . , s} so that di−1 ≤
dimLY (m, M) < di . (Recall that d0 = 0 and dj = k1 + · · · + kj for j ≥ 1.) By
P
Definition 7.1, we have hm (σ) ∈ [Li−1 , Li ) where L0 := 0 and Lj := − jℓ=1 λℓ kℓ for
j ≥ 1. Below we prove the equality dimH µ = dimLY (m, M) under the assumption
that one of the scenarios (a), (b), (c) occurs.

56

DE-JUN FENG

We first consider the scenario (a). In this case, s = 1 and by Theorem 1.3,
dimH µ =

hm (σ)
h1 − h0
=−
= dimLY (m, M).
λ1
λ1

Next we consider the scenario (b). In this case, i = s and so hm (σ) ∈ [Ls−1 , Ls ).
To show that dimH π∗ m = dimLY (m, M), it suffices to show that
hs−1 = hm (σ) + k1 λ1 + · · · + ks−1 λs−1 .
Ps−1
Indeed if (8.4) holds, then h0 − hs−1 = ℓ=1
(−λℓ )kℓ , which forces that hℓ−1 − hℓ =
(−λℓ )kℓ for 1 ≤ ℓ ≤ s − 1 (recalling that hℓ−1 − hℓ ≤ (−λℓ )kℓ for all 1 ≤ ℓ ≤ s by
Corollary 6.1); hence
s−1
X
hℓ − hℓ−1
= ds−1 ,
λℓ
ℓ=1

(8.4)

so (7.1) holds for j = s, then by Proposition 7.4, we obtain that dimH µ = dimLY (m, M).
To show (8.4) we first prove that
(8.5)

hs−1 ≥ hm (σ) + k1 λ1 + · · · + ks−1 λs−1 .

To see this, replacing S by one of its iterations if necessary, we may assume that
kMj k < 1/2 for all j ∈ Λ. By Theorem 1.9 in [42], for Ld|Λ| -a.e. a ∈ Rd|Λ| ,
dimH ((πa )∗ m) = dimLY (m, M).
Hence by Proposition 7.2, for Ld|Λ| -a.e. a ∈ Rd|Λ| ,
hs−1,a = hm (σ) + k1 λ1 + · · · + ks−1λs−1 ,
here and in the next sentence, we write hs−1,a = hs−1 to indicate its dependence
on a. Since hs−1,a is upper semi-continuous in a by Theorem 1.8, it follows that
hs−1,a ≥ hm (σ) + k1 λ1 + · · · + ks−1 λs−1 for all a ∈ Rd|Λ| . This proves (8.5).
Now suppose on the contrary that (8.4) does not hold. Then by (8.5), there exists
δ > 0 such that hs−1 = hm (σ) + k1 λ1 + · · · + ks−1 λs−1 + δ. By Theorem 1.6 (iii), for
(Πs−1 )∗ m-a.e. W ∈ G(d, d − ds−1 ),
dimH ((PW ⊥ )∗ µ) ≤

s−1
X
hℓ − hℓ−1
ℓ=1

λℓ

hs − hs−1
λs
hs−1
= dimH µ −
(−λs )
= dimH µ + ds−1 − dimLY (m, M) − δ/(−λs ),
= dimH µ −

where in the last equality, we use the fact that
dimLY (m, M) = ds−1 +

h0 − Ls−1
hs−1 − δ
= ds−1 +
.
(−λs )
(−λs )

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

57

Let Y denote the set of W ∈ G(d, d − ds−1) such that
dimH ((PW ⊥ )∗ µ) ≤ dimH µ + ds−1 − dimLY (m, M) − δ/(−λs ).
Then m ◦ (Πs−1 )−1 (Y) = 1, so by (1.12),
(8.6)

dimH Y ≥ dim∗H ((Πs−1 )∗ m)
≥ ds−1(d − ds−1) + ds−1 − dimLY (m, M).

On the other hand, we can get an upper bound estimate for dimH Y by using Lemma
8.3. Indeed, if dimH µ ≤ ds−1 , then by Lemma 8.3(i) applied to k = ds−1 and
t = dimH µ + ds−1 − dimLY (m, M) − δ/(−λs ), we see that
dimH Y ≤ ds−1 (d − ds−1 ) + dimH µ − dimLY (m, M) − δ/(−λs )
≤ ds−1 (d − ds−1 ) + ds−1 − dimLY (m, M) − δ/(−λs );
Conversely if dimH µ > ds−1 , then by Lemma 8.3(ii) applied to k = ds−1 and t =
dimH µ + ds−1 − dimLY (m, M) − δ/(−λs ), we get the same upper bound for dimH Y,
which contradicts with (8.6). This proves (8.4).
Finally we consider the scenario (c). In this case, hm (σ) ∈ [Li−1 , Li ). Clearly the
assumptions (1.13)-(1.14) imply that
di−1 ≤ dimH µ ≤ dimLY (m, M) ≤ di .
To prove dimH µ = dimLY (m, M), by Proposition 7.4 it suffices to prove that
P
Pi−1 hℓ −hℓ−1
ℓ−1
= di−1 and sℓ=i+1 hℓ −h
= 0. As d0 = 0, the first equality holds
ℓ=1
λℓ
λℓ
automatically when i = 1.
Pi−1 hℓ −hℓ−1
Now we first prove that
= di−1 . To avoid triviality, we assume
ℓ=1
λℓ
that i ≥ 2. For n ∈ N, let Xn denote the set of W ∈ G(d, d − di−1 ) so that
dimH ((PW ⊥ )∗ µ) < di−1 − 1/n. By Lemma 8.3(ii) applied to k = di−1 and t =
di−1 − 1/n,
dimH Xn ≤ di−1 (d − di−1 ) + di−1 − (1/n) − dimH µ
< dim∗H ((Πi−1 )∗ m)

(by (1.14)).

It follows that m ◦ (Πi−1 )−1 (Xn ) < 1 and hence dimH ((PW ⊥ )∗ µ) > di−1 − 1/n on a
set of positive (Πi−1 )∗ m-measure. However by Theorem 1.6(iii),
(8.7)

dimH ((PW ⊥ )∗ µ) ≤

i−1
X
hℓ − hℓ−1
ℓ=1

λℓ

for (Πi−1 )∗ m-a.e. W .

Pi−1 hℓ −hℓ−1
≥ di−1 − 1/n. As n is arbitrary, we obtain that
It follows that
ℓ=1
λℓ
Pi−1 hℓ −hℓ−1
≥ di−1 . Since hℓ−1 − hℓ ≤ (−λℓ )kℓ for each ℓ by Corollary 6.1, we
ℓ=1
λℓ
Pi−1
hℓ −hℓ−1
have ℓ=1 λℓ = di−1 , as desired.
P
h −h
Next we prove that sℓ=i+1 ℓ λℓℓ−1 = 0. For n ∈ N, let Zn denote the set of
W ∈ G(d, d − di ) so that dimH ((PW ⊥ )∗ µ) < dimH µ − 1/n. By Lemma 8.3(i) applied

58

DE-JUN FENG

to k = di and t = dimH µ − 1/n,
dimH Zn ≤ di (d − di ) − di + dimH µ − (1/n)
≤ di (d − di ) − di + dimLY (m, M) − (1/n)
< dim∗H ((Πi )∗ m)

(by (1.13)).

Hence m◦(Πi )−1 (Zn ) < 1 and so dimH ((PW ⊥ )∗ µ) > dimH µ−1/n on a set of positive
(Πi )∗ m-measure. This combining with (8.7) (in which we replace i − 1 by i) yields
P
Pi hℓ −hℓ−1
ℓ−1
that iℓ=1 hℓ −h
≥
dim
µ
−
1/n.
Letting
n
→
∞
gives
≥ dimH µ,
H
ℓ=1
λℓ
λℓ
Ps
hℓ −hℓ−1
which, together with (1.6), implies that ℓ=i+1 λℓ
= 0. This completes the
proof of the theorem.

Acknowledgements. The author is indebted to Julien Barral, Xiong Jin, François
Ledrappier and Ariel Rapaport for some helpful comments, and to Yufeng Wu for
catching many typos. He thanks the anonymous referees for many suggestions that
led to the improvement of the paper. This research was partially supported by a
HKRGC GRF grant and the Direct Grant for Research in CUHK.
References
[1] K. Barański. Hausdorff dimension of the limit sets of some planar geometric constructions.
Adv. Math., 210(1):215–245, 2007.
[2] B. Bárány. On the Ledrappier-Young formula for self-affine measures. Math. Proc. Cambridge
Philos. Soc., 159(3):405–432, 2015.
[3] B. Bárány, M. Hochman, and A. Rapaport. Hausdorff dimension of planar self-affine sets and
measures. Invent. Math., 216(3):601–659, 2019.
[4] B. Bárány and A. Käenmäki. Ledrappier-Young formula and exact dimensionality of self-affine
measures. Adv. Math., 318:88–129, 2017.
[5] B. Bárány, A. Käenmäki, and H. Koivusalo. Dimension of self-affine sets for fixed translation
vectors. J. Lond. Math. Soc. (2), 98(1):223–252, 2018.
[6] B. Bárány and M. Rams. Dimension maximizing measures for self-affine systems. Trans. Amer.
Math. Soc., 370(1):553–576, 2018.
[7] B. Bárány, M. Rams, and K. Simon. On the dimension of self-affine sets and measures with
overlaps. Proc. Amer. Math. Soc., 144(10):4427–4440, 2016.
[8] B. Bárány, M. Rams, and K. Simon. Dimension of the repeller for a piecewise expanding affine
map. preprint, arXiv:1803.03788, 2018.
[9] J. Barral and D.-J. Feng. Multifractal formalism for almost all self-affine measures. Comm.
Math. Phys., 318(2):473–504, 2013.
[10] L. Barreira, Y. Pesin, and J. Schmeling. Dimension and product structure of hyperbolic measures. Ann. of Math. (2), 149(3):755–783, 1999.
[11] T. Bedford. Crinkly curves, markov partitions and box dimensions in self-similar sets. PhD
Thesis, The University of Warwick, 1984.
[12] T. Bedford. Applications of dynamical systems theory to fractals—a study of cookie-cutter
Cantor sets. In Fractal geometry and analysis (Montreal, PQ, 1989), volume 346 of NATO
Adv. Sci. Inst. Ser. C Math. Phys. Sci., pages 1–44. Kluwer Acad. Publ., Dordrecht, 1991.
[13] J. Bochi and I. D. Morris. Equilibrium states of generalised singular value potentials and
applications to affine iterated function systems. Geom. Funct. Anal., 28(4):995–1028, 2018.
[14] P. Bougerol and N. Picard. Strict stationarity of generalized autoregressive processes. Ann.
Probab., 20(4):1714–1730, 1992.

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

59

[15] R. Bowen. Equilibrium states and the ergodic theory of Anosov diffeomorphisms. Lecture
Notes in Mathematics, Vol. 470. Springer-Verlag, Berlin-New York, 1975.
[16] A. Brandt. The stochastic equation Yn+1 = An Yn + Bn with stationary coefficients. Adv. in
Appl. Probab., 18(1):211–220, 1986.
[17] Y.-L. Cao, D.-J. Feng, and W. Huang. The thermodynamic formalism for sub-additive potentials. Discrete Contin. Dyn. Syst., 20(3):639–657, 2008.
[18] T. Das and D. Simmons. The Hausdorff and dynamical dimensions of self-affine sponges: a
dimension gap result. Invent. Math., 210(1):85–134, 2017.
[19] J.-P. Eckmann and D. Ruelle. Ergodic theory of chaos and strange attractors. Rev. Modern
Phys., 57(3, part 1):617–656, 1985.
[20] M. Einsiedler and T. Ward. Ergodic theory with a view towards number theory, volume 259 of
Graduate Texts in Mathematics. Springer-Verlag London, Ltd., London, 2011.
[21] K. J. Falconer. The Hausdorff dimension of self-affine fractals. Math. Proc. Cambridge Philos.
Soc., 103(2):339–350, 1988.
[22] K. J. Falconer. Techniques in fractal geometry. John Wiley & Sons, Ltd., Chichester, 1997.
[23] K. J. Falconer. Fractal geometry–Mathematical foundations and applications. John Wiley &
Sons, Inc., Hoboken, NJ, second edition, 2003.
[24] K. J. Falconer. Dimensions of self-affine sets: a survey. In Further developments in fractals
and related fields, Trends Math., pages 115–134. Birkhäuser/Springer, New York, 2013.
[25] K. J. Falconer and X. Jin. Exact dimensionality and projections of random self-similar measures and sets. J. Lond. Math. Soc. (2), 90(2):388–412, 2014.
[26] K. J. Falconer and T. Kempton. Planar self-affine sets with equal Hausdorff, box and affinity
dimensions. Ergodic Theory Dynam. Systems, 38(4):1369–1388, 2018.
[27] A.-H. Fan, K.-S. Lau, and H. Rao. Relationships between different dimensions of a measure.
Monatsh. Math., 135(3):191–201, 2002.
[28] H. Federer. Geometric measure theory. Springer-Verlag New York Inc., New York, 1969.
[29] D.-J. Feng and H. Hu. Dimension theory of iterated function systems. Comm. Pure Appl.
Math., 62(11):1435–1500, 2009.
[30] D.-J. Feng and A. Käenmäki. Equilibrium states of the pressure function for products of
matrices. Discrete Contin. Dyn. Syst., 30(3):699–708, 2011.
[31] D.-J. Feng and P. Shmerkin. Non-conformal repellers and the continuity of pressure for matrix
cocycles. Geom. Funct. Anal., 24(4):1101–1128, 2014.
[32] J. Fraser, T. Jordan, and N. Jurga. Dimensions of equilibrium measures on a class of planar
self-affine sets. J. Fractal Geom., 7(1):87-111, 2020.
[33] G. Froyland, S. Lloyd, and A. Quas. Coherent structures and isolated spectrum for PerronFrobenius cocycles. Ergodic Theory Dynam. Systems, 30(3):729–756, 2010.
[34] H. Furstenberg. Ergodic fractal measures and dimension conservation. Ergodic Theory Dynam.
Systems, 28(2):405–422, 2008.
[35] H. Furstenberg and H. Kesten. Products of random matrices. Ann. Math. Statist., 31:457–469,
1960.
[36] D. Gatzouras and S. P. Lalley. Hausdorff and box dimensions of certain self-affine fractals.
Indiana Univ. Math. J., 41(2):533–568, 1992.
[37] M. Hochman and A. Rapaport. Hausdorff dimension of planar self-affine sets and measures
with overlaps. preprint, arXiv:1904.09812, 2019.
[38] M. Hochman and P. Shmerkin. Local entropy averages and projections of fractal measures.
Ann. of Math. (2), 175(3):1001–1059, 2012.
[39] M. Hochman and B. Solomyak. On the dimension of Furstenberg measure for SL2 (R) random
matrix products. Invent. Math., 210(3):815–875, 2017.
[40] J. E. Hutchinson. Fractals and self-similarity. Indiana Univ. Math. J., 30(5):713–747, 1981.
[41] T. Jordan. Unpublished note. 2011.
[42] T. Jordan, M. Pollicott, and K. Simon. Hausdorff dimension for randomly perturbed self affine
attractors. Comm. Math. Phys., 270(2):519–544, 2007.

60

DE-JUN FENG

[43] A. Käenmäki. On natural invariant measures on generalised iterated function systems. Ann.
Acad. Sci. Fenn. Math., 29(2):419–458, 2004.
[44] R. Kenyon and Y. Peres. Measures of full dimension on affine-invariant sets. Ergodic Theory
Dynam. Systems, 16(2):307–323, 1996.
[45] J. F. C. Kingman. The ergodic theory of subadditive stochastic processes. J. Roy. Statist. Soc.
Ser. B, 30:499–510, 1968.
[46] F. Ledrappier and L.-S. Young. The metric entropy of diffeomorphisms. I. Characterization
of measures satisfying Pesin’s entropy formula. II. Relations between entropy, exponents and
dimension. Ann. of Math. (2), 122(3):509–539; 540–574, 1985.
[47] P.-D. Liu and Q. Min. Smooth ergodic theory of random dynamical systems. Lecture Notes in
Mathematics, 1606. Springer-Verlag, Berlin, 1995.
[48] R. Mañé. Ergodic theory and differentiable dynamics. Springer-Verlag, Berlin, 1987.
[49] P. T. Maker. The ergodic theorem for a sequence of functions. Duke Math. J., 6:27–30, 1940.
[50] P. Mattila. Geometry of sets and measures in Euclidean spaces. Cambridge University Press,
Cambridge, 1995.
[51] C. McMullen. The Hausdorff dimension of general Sierpiński carpets. Nagoya Math. J., 96:1–9,
1984.
[52] E. Mihailescu and M. Urbański. Random countable iterated function systems with overlaps
and applications. Adv. Math., 298:726–758, 2016.
[53] B. Miller. The existence of measures of a given cocycle. I. Atomless, ergodic σ-finite measures.
Ergodic Theory Dynam. Systems, 28(5):1599–1613, 2008.
[54] I. Morris and P. Shmerkin. On equality of Hausdorff and affinity dimensions, via self-affine
measures on positive subsystems. Trans. Amer. Math. Soc., 371:1547–1582, 2019.
[55] V. I. Oseledec. A multiplicative ergodic theorem. Liapunov characteristic numbers for dynamical systems. Trans. Moscow. Math. Soc., 19:197–231, 1968.
[56] W. Parry. Entropy and generators in ergodic theory. W. A. Benjamin, Inc., New YorkAmsterdam, 1969.
[57] W. Parry. Topics in ergodic theory. Cambridge University Press, Cambridge-New York, 1981.
[58] N. Patzschke. Self-conformal multifractal measures. Adv. in Appl. Math., 19(4):486–513, 1997.
[59] Y. Peres and B. Solomyak. Existence of Lq dimensions and entropy dimension for selfconformal measures. Indiana Univ. Math. J., 49(4):1603–1621, 2000.
[60] K. Petersen. Ergodic theory. Cambridge University Press, Cambridge, 1983.
[61] F. Przytycki and M. Urbański. On the Hausdorff dimension of some fractal sets. Studia Math.,
93(2):155–186, 1989.
[62] M. Qian and J.-S. Xie. Entropy formula for endomorphisms: relations between entropy, exponents and dimension. Discrete Contin. Dyn. Syst., 21(2):367–392, 2008.
[63] A. Rapaport. A self-similar measure with dense rotations, singular projections and discrete
slices. Adv. Math. 321:529–546, 2017.
[64] A. Rapaport. On self-affine measures with equal Hausdorff and Lyapunov dimensions. Trans.
Amer. Math. Soc., 370(7):4759–4783, 2018.
[65] V. A. Rohlin. On the fundamental ideas of measure theory. Amer. Math. Soc. Translation,
1952(71):55, 1952.
[66] E. Rossi. Local dimensions of measures on infinitely generated self-affine sets. J. Math. Anal.
Appl., 413(2):1030–1039, 2014.
[67] W. Rudin. Real and complex analysis. McGraw-Hill Book Co., New York, third edition, 1987.
[68] S. Saglietti, P. Shmerkin, and B. Solomyak. Absolute continuity of non-homogeneous selfsimilar measures. Adv. Math., 335:60–110, 2018.
[69] L. Shu. Dimension theory for invariant measures of endomorphisms. Comm. Math. Phys.,
298(1):65–99, 2010.
[70] B. Solomyak. Measure and dimension for some fractal families. Math. Proc. Cambridge Philos.
Soc., 124(3):531–546, 1998.
[71] P. Walters. An introduction to ergodic theory. Springer-Verlag, New York-Berlin, 1982.

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

61

[72] L. S. Young. Dimension, entropy and Lyapunov exponents. Ergodic Theory Dynam. Systems,
2(1):109–124, 1982.
Department of Mathematics, The Chinese University of Hong Kong, Shatin, Hong
Kong,
E-mail address: djfeng@math.cuhk.edu.hk

