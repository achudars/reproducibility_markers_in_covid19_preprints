Eur. Phys. J. C manuscript No.
(will be inserted by the editor)

Addendum to: A Theoretical Study of Top-Mass Measurements at the
LHC Using NLO+PS Generators of Increasing Accuracy
Silvia Ferrario Ravasioa,1 , Tomáš Ježob,2 , Paolo Nasonc,3 , Carlo Olearid,3
1 IPPP,

Department of Physics, Durham University, Durham, UK
Institute, Universität Zürich, Zürich, Switzerland
3 Università di Milano-Bicocca and INFN, Sezione di Milano-Bicocca, Piazza della Scienza 3, 20126 Milano, Italy

arXiv:1906.09166v1 [hep-ph] 21 Jun 2019

2 Physics

the date of receipt and acceptance should be inserted later

Abstract This paper is a follow-up of Ref. [1], where we
studied the impact of next-to-leading order calculations merged
with parton shower generators (NLO+PS) of increasing accuracy in the extraction of the top mass at hadron colliders.
Here we examined results obtained with the older (fortranbased) shower generators Pythia6.4 and Herwig6.5. Our
findings are in line with what we found in Ref. [1] with the
new, c++-based, generators Pythia8.2 and Herwig7.1.

1 Introduction
In Ref. [1] we considered three NLO+PS generators for t t¯
production, hvq [2], t t¯dec [3], and bb̄4` [4], implemented
in the POWHEG BOX [5–8], interfaced with either Pythia8.2
(Py8.2) [9] or Herwig7.1 (Hw7.1) [10, 11]. We focused
particularly on an observable that mimics those used in direct top mass measurements, but also included in our study
the proposed top mass measurements from the peak energy
of the b jet [12] and from the class of leptonic observables
suggested in Ref. [13]. We found large differences between
predictions obtained using the two parton shower programs.
In particular, while results obtained with the three NLO+PS
generators interfaced to Py8.2 are fairly consistent among
each other, large differences are found if they are interfaced
to Hw7.1.
In this addendum we discuss the results obtained with
the older, fortran-based versions of the Pythia and Herwig
codes. Our purpose is to see if the effects that we have seen
are specific to the new implementations, or were already
present in the old ones. We briefly recall the characteristics
of the older generators:
a e-mail:

silvia.ferrario-ravasio@durham.ac.uk
tomas.jezo@physik.uzh.ch
c e-mail: paolo.nason@mib.infn.it
d e-mail: carlo.oleari@mib.infn.it
b e-mail:

– Pythia6.4 (Py6.4) [14]: implements a pT -ordered shower,
making use of the same algorithm adopted in Py8.2.
The older and new codes have both an interleaved radiation scheme between the initial-state radiation and the
multi-parton interactions (MPI). In Py8.2, final-state radiation is also interleaved, and different models of colour
reconnection are also offered.
– Herwig6.5 [15] with Jimmy 4.31 [16] (Hw6.5): implements an angular-ordered shower. However, the showering variables are different from those adopted in the
Hw7.1 implementation [17]. The two versions of Herwig
implement the PS and the perturbative part of the MPI in
a similar manner. The non-perturbative part of the MPI,
instead, has been completely redesigned [18]. Similarly
to Pythia, colour-reconnection effects are properly included only in the recent versions of Herwig [19].
In our previous work, we have seen that the two generators
bb̄4` and t t¯dec yield fairly consistent results for the observables that we have considered. Thus, here we only compare
hvq and bb̄4`.

2 Interface to POWHEG BOX
In this section we briefly describe the matching of bb̄4` and
hvq to both Py6.4 and Hw6.5. The matching to Py8.2 and
Hw7.1 is detailed in Ref. [1].

2.1 Pythia6.4
Py6.4 implements both a pT and a virtuality-ordered PS.
Here, we employ the pT -ordered shower with the Perugia
tune (PYTUNE(320)) [20].
We setup Py6.4 in such a way that the pT of radiation
in the shower is limited by the scalup parameter of the

2

Les Houches Interface for User Processes [21], as is usually
done in POWHEG. This is at variance with the Perugia tune
settings,
√ that requires pT to be smaller than scalup divided
by 2.1
The matching of shower emissions in the production process relies on the default behaviour of POWHEG, i.e. the shower
evolution starts at scalup. In the decays, a different scale
must be adopted, and thus it requires a custom veto prescription in bb̄4`. We implement it using two methods, both
analogous to what we did in order to match Py8.2 to bb̄4`
in Ref. [1]:
1. Each time Pythia6.4 generates an emission off the top
(or anti-top), we compute its transverse momentum according to the POWHEG definition. If it is larger than the
transverse momentum of the emission generated by the
POWHEG BOX, we abandon the current shower, and restart
a shower from the same Les Houches event. This represents our default method. We label it as the “FSR” veto,
in full analogy with the notation adopted for Py8.2.
2. Since we employ a pT -ordered shower, we can also simply require the shower to start at a given transverse momentum, that we set equal to the transverse momentum
of the corresponding POWHEG emission. This veto procedure will be referred to as the “SR” method, as we did
with the analogous method that we adopted in Py8.2.

branching is discarded and the evolution continues from the
scale of this discarded emission.

3 Hadronic observables: NLO+PS results
In this section we compare predictions for hadronic observables at the NLO+PS level, i.e. without the inclusion of MPI
and of hadronization effects. Our aim is to assess differences
of perturbative origin and, in particular, due to the NLO+PS
matching.

3.1 Pythia6.4 versus Pythia8.2

We begin by comparing the predictions obtained with Py6.4
and Py8.2, which both implement a dipole-like algorithm
for final-state showers.
In Ref. [1] we made use of a smearing procedure to simulate experimental resolution effects. We begin by examining results obtained without applying any smearing.
The distributions of the reconstructed-top mass and of
the b-jet energy using hvq matched to the two versions of
Pythia are shown in the upper and lower panes of Fig. 1,
respectively. The two curves for the reconstructed-top mass
are almost indistinguishable. Also the peak positions of the
2.2 Herwig6.5
b-jet energy spectra agree remarkably well, despite some
small differences in shape, leading to a displacement of the
For Hw6+Jimmy we adopted the ATLAS AUET2 tune [22].
extracted top-mass for this observable of ≈ 200 MeV.
The Herwig shower is ordered in angle and not in pT . ThereIn Fig. 2 we plot the distributions obtained using the
fore all the emissions with transverse momentum larger than
bb̄4` generator. The results for the mW b j spectrum obtained
that of the POWHEG emission must be vetoed. Both Herwig
with Py6.4 show an enhancement in the low-mass region
versions already enforce this veto for the production part
with respect to the Py8.2 distribution, irrespective of the
of the process. Similarly to Py6.4, extra care is required
veto scheme used (upper pane). Nevertheless there is no apfor emissions from the top-decay products, when interfaced
preciable shift in the peak-position.
with bb̄4`.
The shape of the b-jet energy spectrum in the proximity
In our previous work, two procedures were devised to
of the peak region is instead different for Py8.2 compared to
veto extra Hw7.1 emissions. Both of them use the pT of the
the two results obtained by using Py6.4, with a shift in the
POWHEG emission as an upper bound, either on the pT of each
maximum of the b-jet energy of approximately +0.5 GeV of
branching at the end of the showering phase (FullShowerVeto),the former with respect to the latter two results. This shift
or on the shower evolution scale during the showering phase
induces a displacement in the extracted top-mass (mt ) of ≈
(ShowerVeto). Unfortunately, the Hw6.5 event record (as
1 GeV.2
for Py6.4) does not contain information regarding the branchIn Tabs. 1 and 2 we summarize the mW b j and Eb j peak
ing of the partons, i.e. it is not possible to reconstruct the
positions respectively, obtained for different values of the
emission’s history after the shower is completed, in conjet radius varied between 0.4 and 0.6. Table 1 also shows the
trast to the new version of the code. Therefore, we only immW b j distribution peak positions when the smearing is applemented the analogue of the Hw7.1 ShowerVeto method
plied. An excellent agreement is found between hvq+Py6.4
which proceeds as follows: when an emission off a top resmax , even after the smearing is applied,
and hvq+Py8.2 for mW
bj
onance is generated, if its pT (defined in terms of Herwig
max
and the Eb j differences are small, nearly consistent with
variables) is larger than that of the POWHEG emission, the
zero within their statistical errors for all values of R.
1 We

achieve this by setting the Py6.4 parameter PARP(71)=4 rather
than the default Perugia value PARP(71)=2.

2 See

eqs. (7.2) and (7.4) of Ref. [1].

3
R = 0.4

R = 0.5

R = 0.6

No smearing

15 GeV smearing

No smearing

15 GeV smearing

No smearing

15 GeV smearing

bb̄4`+Py8.2 (FSR) [GeV]

172.509 ± 0.002

170.569 ± 0.002

172.522 ± 0.002

171.403 ± 0.002

172.538 ± 0.002

172.117 ± 0.002

bb̄4`+Py6.4 (FSR) − bb̄4`+Py8.2 (FSR)

−22 ± 3 MeV

−296 ± 2 MeV

−11 ± 3 MeV

−286 ± 2 MeV

0 ± 3 MeV

−258 ± 2 MeV

bb̄4`+Py6.4 (SR) − bb̄4`+Py8.2 (FSR)

−36 ± 3 MeV

−360 ± 2 MeV

−23 ± 3 MeV

−342 ± 2 MeV

−8 ± 3 MeV

−307 ± 2 MeV

hvq+Py8.2 [GeV]

172.485 ± 0.001

170.518 ± 0.001

172.498 ± 0.001

171.315 ± 0.001

172.513 ± 0.001

171.996 ± 0.001

hvq+Py6.4 − hvq+Py8.2

−11 ± 2 MeV

+76 ± 2 MeV

+1 ± 2 MeV

+69 ± 2 MeV

+13 ± 2 MeV

+69 ± 2 MeV

max , computed with bb̄4` and hvq, without hadronizaTable 1: Comparisons between the Py8.2 and the Py6.4 results for mW
bj
tion or MPI effects, for different values of the jet radius R.

R = 0.4

R = 0.5

R = 0.6

bb̄4`+Py8.2 (FSR) [GeV]

67.145 ± 0.086

69.614 ± 0.082

71.747 ± 0.080

bb̄4`+Py6.4 (FSR) − bb̄4`+Py8.2 (FSR)

−422 ± 124 MeV

−499 ± 118 MeV

−512 ± 115 MeV

bb̄4`+Py6.4 (SR) − bb̄4`+Py8.2 (FSR)

−455 ± 123 MeV
66.791 ± 0.068

−588 ± 118 MeV

−543 ± 114 MeV

hvq+Py8.2 [GeV]
hvq+Py6.4 − hvq+Py8.2

−24 ± 95 MeV

−100 ± 91 MeV

−133 ± 87 MeV

69.357 ± 0.063

71.598 ± 0.061

Table 2: Comparisons between the Py8.2 and the Py6.4 results for Ebmax
, computed with bb̄4` and hvq, without hadronizaj
tion or MPI effects, for different values of the jet radius R.
The low-mass enhancement in the mW b j spectrum of the
bb̄4`+Py6.4 generator, with respect to the bb̄4`+Py8.2 generator, leads to quite large displacements of the peak position once smearing is applied. For our default FSR-veto
procedure, the differences between Py8.2 and Py6.4 are
roughly 250-300 MeV. The differences of Ebmax
for the two
j

3.2 Herwig6.5 versus Herwig7.1

We now compare the predictions obtained by showering the
NLO+PS results with Hw6.5 and Hw7.1.
In the upper panes of Figs. 3 and 4 we plot the results
for mW b j obtained with hvq and bb̄4`. The cross section unshowers used with bb̄4` are even larger, of the order of 0.5 GeV der the peak is mildly suppressed in Hw6.5 with respect
to Hw7.1. This is then compensated by enhancements in
for all values of the jet radius.
the low- and, to a smaller extent, high-tail regions. A small
max
max
bump is also present at roughly 1 GeV below the peak posiThe differences in mW b j and Eb j between the bb̄4` and
tion when using the bb̄4` generator with Hw7.1, also present
hvq generators for R = 0.5 are reported in Tab. 3. We noto a smaller extent when using Hw6.5 instead.3 These differences, present already at the shower level, could be ascribed
to the fact that the two versions of Herwig adopt slightly different ordering variables.4 Despite the presence of these difbb̄4`−hvq, R = 0.5
[MeV]
ferences, the peak position (at the unsmeared level) in Hw6.5
max
max (smear)
max
mW
m
E
or Hw7.1, in both hvq and bb̄4`, is not changed.
bj
Wbj
bj
Py8.2 (FSR)
24 ± 2
89 ± 2
257 ± 53
In the lower panes of Figs. 3 and 4 we show the results
for
the
b-jet energy spectrum. The peak position, when hvq
Py6.4 (FSR)
12 ± 2
−265 ± 2
−147 ± 106
is used, is 250 MeV bigger when showering with Hw6.5 than
with Hw7.1, while in the case of bb̄4` it has the same magTable 3: Differences between the bb̄4` and hvq predictions
max
max
nitude but opposite sign. This affects the extracted top mass
for mW b j (with and without smearing) and Eb j , showered
by 0.5 GeV.
by Py8.2 and Py6.4.
3 Further studies suggest that this bump is a symptom of a minor shower

max predictions obtained
tice that the level of agreement of mW
bj

using bb̄4` and hvq gets worse in Py6.4 as compared to
Py8.2, while the opposite is true for Ebmax
.
j

cut-off mismatch between Hw7.1 and bb̄4`.
4 In Hw6.5 the variable z is interpreted as the energy fraction of the
emitter after the emission, while in Hw7.1 it represents the light-cone
momentum fraction. In both, the ordering variable in the collinear limit
becomes ∼ Eθ , E being the energy of the emitting parton and θ the
angle between the two radiated partons. See [10] for further details.

4
1

1
Py8.2

0.1

0.1

Py8.2 (FSR) mmax
W bj = 172.522 ± 0.002 GeV

Py8.2 mmax
W bj = 172.498 ± 0.001 GeV

Py6.4 (FSR) mmax
W bj = 172.512 ± 0.002 GeV

Py6.4 mmax
W bj = 172.499 ± 0.001 GeV
0.01

166

168

170

172

174

176

Py6.4 (SR) mmax
W bj = 172.499 ± 0.002 GeV
0.01

178

mW bj [GeV]
0.018

Py8.2

0.018

Py6.4

0.016

dσ/d log(Ebj )/Ebj [pb/GeV]

dσ/d log(Ebj )/Ebj [pb/GeV]

0.016
0.014
0.012
0.01
0.008
0.006

0.002
0

3.5

Py8.2

Ebmax
j

= 69.357 ± 0.063 GeV

Py6.4

Ebmax
j

= 69.257 ± 0.065 GeV

4

4.5

166

168

170

172

174

176

178

mW bj [GeV]

hvq
NLO+PS (Pythia)

0.004

Py8.2 (FSR)
Py6.4 (FSR)
Py6.4 (SR)

No smearing
bb̄4`
NLO+PS (Pythia)

Py6.4

dσ/dmW bj [pb/GeV]

dσ/dmW bj [pb/GeV]

No smearing
hvq
NLO+PS (Pythia)

5

0.014
0.012
0.01
0.008
0.006

Py8.2 Ebmax
= 69.614 ± 0.082 GeV
j

0.004

Py6.4 (FSR) Ebmax
= 69.115 ± 0.084 GeV
j
Py6.4 (SR) Ebmax
= 69.026 ± 0.085 GeV
j

0.002
5.5

log(Ebj )

Fig. 1: Reconstructed-top mass (upper pane) and b-jet energy distribution (lower pane) obtained with the hvq generator interfaced to Py8.2 (red) and to Py6.4 (green).
Hadronization and MPI effects are not included.

3.3 Pythia versus Herwig

Py8.2 (FSR)
Py6.4 (FSR)
Py6.4 (SR)

bb̄4`
NLO+PS
(Pythia)

0

3.5

4

4.5

5

5.5

log(Ebj )

Fig. 2: Reconstructed-top mass (upper pane) and b-jet energy distributions (lower pane) obtained with the bb̄4` generator showered by Py8.2 with the FSR veto scheme (red),
and by Py6.4. The two curves for the Py6.4 results are obtained using the FSR veto scheme (green) and the SR veto
scheme (black). Hadronization and MPI effects are not included.

max and E max (relaIn Figs. 5 and 6 we plot the variation of mW
bj
bj

tive to our reference generator combination, i.e. bb̄4`+Py8.2)
obtained with bb̄4` and hvq, showered by Py8.2, Hw7.1
Py6.4 and Hw6.5.
max , without any smearing, are small and
The shifts for mW
bj
comparable when using Hw7.1 or Hw6.5. These are not reported in the figures, and can be obtained from the tables in
the appendix.
When the smearing is applied, Hw7.1 and Hw6.5 with
bb̄4` give comparable negative shifts, around 1 GeV. Instead, with hvq, the displacement of the peak position (with
respect to the reference values) are around −100÷−200 MeV

for Hw7.1, and 0 ÷ −150 MeV for Hw6.5, for the different jet radii R. Since no significant difference between the
two Herwig versions was observed in the bb̄4` case (where
POWHEG generates the hardest emission both in production
and decay), and since hvq does not handle radiation in decay,
this behaviour is likely to be due to a different treatment of
radiation in decay in the two Herwig versions with respect
to Pythia.
As for Ebmax
predictions in Fig. 6, we find minor differj
ences between Hw6.5 and Hw7.1 for R ≥ 0.5, that go in the
direction to amplify the difference with respect to our ref-

5
1

1
Hw7.1

0.1

0.01

166

Hw7.1 mmax
W bj = 172.498 ± 0.001 GeV

Hw7.1 mmax
W bj = 172.512 ± 0.002 GeV

Hw6.5 mmax
W bj = 172.497 ± 0.001 GeV

Hw6.5 mmax
W bj = 172.510 ± 0.002 GeV

168

170

172

174

176

0.01

178

166

168

170

Hw7.1

hvq
NLO+PS
(Herwig)

0.018

Hw6.5
0.016

0.014
0.012
0.01
0.008
0.006
0.004

Hw7.1 Ebmax
= 68.650 ± 0.063 GeV
j

0.002

Hw6.5 Ebmax
= 68.923 ± 0.060 GeV
j

0

3.5

4

4.5

5

5.5

log(Ebj )

Fig. 3: Reconstructed-top mass (upper pane) and b jet energy
distribution (lower pane) computed with the hvq generator
matched to Hw7.1 (blue) and to Hw6.5 (orange). Hadronization and MPI effects are not included.
max , also in this case the
erence generator. Similarly to mW
bj

discrepancies between bb̄4` and hvq interfaced to the same
shower generator are larger for Herwig than for Pythia,
both for the older and newer versions.
We interpret the relative consistency of the Hw7.1 and
Hw6.5 predictions with the bb̄4` generator as a validation of
our veto procedures and of the results presented in Ref. [1].

4 Hadronic observables: full results

172

174

176

178

mW bj [GeV]

dσ/d log(Ebj )/Ebj [pb/GeV]

dσ/d log(Ebj )/Ebj [pb/GeV]

0.016

Hw6.5

0.1

mW bj [GeV]
0.018

Hw7.1

No smearing
bb̄4`
NLO+PS (Herwig)

Hw6.5

dσ/dmW bj [pb/GeV]

dσ/dmW bj [pb/GeV]

No smearing
hvq
NLO+PS (Herwig)

Hw7.1

bb̄4`
NLO+PS
(Herwig)

Hw6.5

0.014
0.012
0.01
0.008
0.006
0.004

Hw7.1 Ebmax
= 67.948 ± 0.083 GeV
j

0.002

Hw6.5 Ebmax
= 67.703 ± 0.083 GeV
j

0

3.5

4

4.5

5

5.5

log(Ebj )

Fig. 4: Reconstructed-top mass (upper pane) and b jet energy
distribution (lower pane) computed with the bb̄4` generator
matched to Hw7.1 (blue) and to Hw6.5 (orange). Hadronization and MPI effects are not included.

results shown here and in the following sections are obtained
using the FSR veto.
For the hvq generator (see Fig. 7) we find that Py6.4
and Py8.2 yield very similar results. However, we find an
appreciable disagreement between Hw7.1 and Hw6.5. We
attribute it to different implementations of MPI in the two
versions of Herwig, since the predictions agreed rather well
at the NLO+PS level for R ≥ 0.5.5
If the bb̄4` generator is employed (see Fig. 8) the same
reasoning applies, but with one important difference: the discrepancy between Py8.2 and Py6.4 is not negligible and

We now summarize the results obtained by showering hvq
5 We stress that, among other improvements over Hw6.5, Hw7.1 impleand bb̄4` with the four PS programs at the full level, that is
with the MPI and hadronization switched on. The bb̄4`+Py6.4 ments a model for the treatment of colour reconnection.

mmax
W bj , 15 GeV smearing

6
bb̄4` + Py8.2

bb̄4` + Hw7.1
bb̄4` + Hw6.5

bb̄4` + Py6.4

hvq + Py8.2
hvq + Py6.4

hvq + Hw7.1
hvq + Hw6.5

Py8.2

No smearing
hvq

Py6.4

dσ/dmW bj [pb/GeV]

Hw7.1

R = 0.4

R = 0.5

Hw6.5

0.1

Py8.2 mmax
W bj = 172.803 ± 0.003 GeV
Py6.4 mmax
W bj = 172.788 ± 0.003 GeV

0.01

Hw7.1 mmax
W bj = 173.038 ± 0.004 GeV
Hw6.5 mmax
W bj = 172.861 ± 0.004 GeV

160

165

170

175

180

185

mW bj [GeV]
0.018

R = 0.6
−0.8
−0.6
−0.4 −0.2
max
mmax
W bj − mW bj bb̄4` + Py8.2 [GeV]

max , including a
Fig. 5: Results for the difference of the mW
bj
15 GeV smearing, with respect to our reference generator
(i.e. bb̄4`+Py8.2), at the NLO+PS level using hvq or bb̄4`,
showered by Pythia and Herwig, for different values of jet
radius R. Hadronization and MPI effects are not included.
The numerical values are reported in Tab. 5.

bb̄4` + Py8.2

bb̄4` + Hw7.1
bb̄4` + Hw6.5

bb̄4` + Py6.4

hvq + Py8.2
hvq + Py6.4

Py6.4

0.0

hvq + Hw7.1
hvq + Hw6.5

0.016

dσ/d log(Ebj )/Ebj [pb/GeV]

−1.0

Py8.2

hvq

Hw7.1
Hw6.5

0.014
0.012
0.01
0.008
0.006

Py8.2 Ebmax
= 70.744 ± 0.064 GeV
j

0.004

Py6.4 Ebmax
= 70.558 ± 0.062 GeV
j

0.002

Hw7.1 Ebmax
= 69.716 ± 0.062 GeV
j

0

Hw6.5 Ebmax
= 71.113 ± 0.058 GeV
j
3.5

4

4.5

5

5.5

log(Ebj )

Fig. 7: Reconstructed-top mass (upper pane) and b jet energy distribution (lower pane) obtained for the hvq generator matched to Py8.2 (red), to Py6.4 (green), Hw7.1 (blue)
and Hw6.5 (orange). The hadronization and the underlying
event are included.

R = 0.4

R = 0.5

R = 0.6
−2.0

−1.5
−1.0
−0.5

Ebmax
− Ebmax
bb̄4` + Py8.2 [GeV]
j
j

Fig. 6: Same as Fig. 5 but for Ebmax
.
j

0.0

max displacement when smearing is apleads to a large mW
bj
plied, similar to what we found at the NLO+PS level.
The mW b j and Eb j shifts in peak positions obtained considering several values of the jet radius R, with and without
smearing in the case of the mW b j distribution, are summarized in Figs. 9 and 10. We notice a non-negligible R dependence in the difference between Py6.4 and Py8.2, both
in the hvq and bb̄4` case. Something similar is observed in
the case of Herwig7. A large R dependence is also observed
in the case of Hw6.5, but with an opposite slope when hvq
is used. The largest difference with respect to our reference
result is given by the Hw7.1, that represent a major cause
of concern. We stress that these large differences arise in

mmax
W bj , 15 GeV smearing
No smearing
bb̄4`

Py8.2

bb̄4` + Py8.2

Py6.4

bb̄4` + Py6.4

bb̄4` + Hw7.1
bb̄4` + Hw6.5

hvq + Py8.2
hvq + Py6.4

7
hvq + Hw7.1
hvq + Hw6.5

dσ/dmW bj [pb/GeV]

Hw7.1
Hw6.5

0.1

R = 0.4

Py8.2 mmax
W bj = 172.793 ± 0.004 GeV
Py6.4 mmax
W bj = 172.722 ± 0.004 GeV

0.01

R = 0.5

Hw7.1 mmax
W bj = 172.727 ± 0.005 GeV
Hw6.5 mmax
W bj = 172.602 ± 0.006 GeV

160

165

170

175

180

185

mW bj [GeV]
0.018

Py8.2

bb̄4`

R = 0.6

Py6.4

dσ/d log(Ebj )/Ebj [pb/GeV]

0.016

−1.0
−0.5
0.0
max
mmax
W bj − mW bj bb̄4` + Py8.2 [GeV]

Hw7.1
Hw6.5

0.014

max , including a
Fig. 9: Results for the differences of mW
bj
15 GeV smearing, relative to our reference generator, at
the full level (i.e. with the inclusion of the MPI and of the
hadronization) for different values of jet radius R. The numerical values are reported in Tab. 6. The square/round dots
refer to bb̄4`/hvq results, while the colours correspond to
given shower generators.

0.012
0.01
0.008
0.006

Py8.2 Ebmax
= 71.200 ± 0.081 GeV
j

0.004

Py6.4 Ebmax
= 70.415 ± 0.084 GeV
j

0.002

Hw7.1 Ebmax
= 69.050 ± 0.081 GeV
j

0

bb̄4` + Py8.2

Hw6.5 Ebmax
= 70.436 ± 0.081 GeV
j
3.5

4

4.5

5

0.5

bb̄4` + Py6.4

bb̄4` + Hw7.1
bb̄4` + Hw6.5

hvq + Py8.2
hvq + Py6.4

hvq + Hw7.1
hvq + Hw6.5

5.5

log(Ebj )

Fig. 8: Reconstructed-top mass (upper pane) and b jet energy distribution (lower pane) obtained for the bb̄4` generator matched to Py8.2 (red), to Pythia6.4 (green),
Hw7.1 (blue) and Hw6.5 (orange). The hadronization and
the underlying event are included.

the smeared case from the mass distribution away from the
peak, i.e. cannot be consider as an irreducible uncertainty on
the extracted mass.
Overall, we find that bb̄4` and hvq showered with Pythia
exhibit more consistency than those showered with both versions of Herwig. This is perhaps not surprising. Matrixelement corrections (MEC), that have a large impact on hvq
predictions (since this generator implements only LO top
decay), as implemented in the context of angular ordered
parton showers (i.e. in Herwig), are technically quite different from the way in which the hardest top radiation is generated in bb̄4`, at variance with MEC in transverse-momentum
ordered showers (i.e. in Pythia). We find that it is difficult

R = 0.4

R = 0.5

R = 0.6
−2.5

−2.0
−1.5
−1.0
−0.5
0.0
Ebmax
− Ebmax
bb̄4` + Py8.2 [GeV]
j
j

Fig. 10: Same as Fig. 9 but for Ebmax
.
j

0.5

8

to use this difference to dismiss the Hw7.1 result, since the
MEC formalism in Herwig has formally the same accuracy
as the one in Pythia.

5 Leptonic observables
The last class of observables we consider are the leptonic
ones. In Ref. [1] we found that these observables are only
mildly affected by non-perturbative effects (i.e. the hadronization and the MPI), thus we present only the results obtained
at the full level and with jet radius R = 0.5. However, they
are likely to be strongly affected by the parton shower, since
the W boson, and thus the leptons arising from its decay,
must absorb the radiation recoil to ensure four-momentum
conservation.
We extract the top mass value from the following observables:
hpT (`+ )i,
+ −

hE(` ` )i,

hpT (`+ `− )i,
+

hm(`+ `− )i,

(1)

−

hpT (` ) + pT (` )i.

The results are presented in Tab. 4 and their graphical display is given in Fig. 11.
As before, our pseudodata sample was generated with
bb̄4`+Py8.2, and we used the other combinations of NLO+PS
generators to extract a corresponding top mass value. We
have included the standard theoretical uncertainties as described in Ref. [1], and averaged the results obtained for the
different leptonic observables also considering the statistical
correlation among them, as suggested in Ref. [13].
The Py6.4 predictions always give mt values roughly
1 GeV larger (1.2 GeV for bb̄4` and 0.8 GeV for hvq) than
the corresponding Py8.2 ones. This variation is of the same
order of the extracted total uncertainty on mt .
The average reconstructed top mass with Hw6.5 is nearly
2 GeV larger than Hw7.1 (1.8 GeV for bb̄4` and 2 GeV for
hvq).

6 Conclusions
In this work we have extended the study performed in Ref. [1]
by also considering the Py6.4 and Hw6.5 generators.
We find that, at the NLO+PS level, the Py6.4 and Py8.2
generators (both based upon a pT -ordered shower) are quite
consistent among each other, and the same holds for Hw6.5
and Hw7.1 (both based upon an angular-ordered shower).
When non-perturbative effects are included, we find larger
differences between the old and the new Herwig versions of
the PS programs, that yields a better agreement of the old
Herwig version with respect to both Pythia versions (see
Fig. 9).

If we compare predictions for the leptonic observables,
we see that the old Herwig version is further away from our
reference result then the new version.
Overall, inclusion of the older versions of the shower
generators supports what was found in Ref. [1], i.e. an indication of a large sensitivity to the shower generator in the
extraction of the top mass.
Since we have now compared four different shower and
hadronization models, it is worth asking what kind of estimate of irreducible non-perturbative effects, potentially due
to the different implementation of the shower cut-off and the
matching hadronization model. We thus consider the spread
max values obtained with all generators as a crude
of the mW
bj
estimate of non-perturbative effects. Looking at Tab. 6, the
unsmeared results from the bb̄4` generators, taking R = 0.5
to avoid too large hadronization effects (for small R) and too
large MPI contamination (for large R), we find a range from
172.601 to 172.793, i.e. roughly a 200 MeV range. This result tells us that, after all, non-perturbative effects may be
well contained within presently quoted errors for direct measurements from the experimental collaborations.

Acknowledgments
The authors would like to acknowledge Bryan Webber for
the substantial help with the Hw6.5+Jimmy4.31 interface
to POWHEG BOX and the useful discussions in the early stages
of this project. The work of T.J. is supported in part by the
University of Zürich under the contract K-72319-02-01 and
in part by the Swiss National Science Foundation under contract BSCGI0-157722. P.N. acknowledges the support from
Fondazione Cariplo and Regione Lombardia, grant 20172070. The work of S.F.R. received funding from the UK
Science and Technology Facilities Council (grant numbers
ST/P001246/1).

Appendix A: Numerical results
In this section we give the numerical results for the hadronic
max and E max for both the hvq and the bb̄4`
observables mW
bj
bj
generators, showered with Py8.2, Py6.4, Hw7.1 and Hw6.5.
In Tab. 5 the results obtained without the inclusion of the
hadronization and MPI effects are listed. The graphical representation of these data is given in Figs. 5 and 6.
The results obtained including the non-perturbative physics
effects are instead reported in Tab. 6 and displayed in Figs. 9
and 10.

9
mt extracted with bb̄4` [GeV]
observable
hpT
hpT

(`+ )i

(`+ `− )i

hm(`+ `− )i
hE(`+ `− )i

hpT

(`+ ) + p

T

(`− )i

average

mt extracted with hvq [GeV]

Py8.2

Py6.4

Hw7.1

Hw6.5

Py8.2

Py6.4

Hw7.1

Hw6.5

172.500+0.845
−0.825
172.500+1.601
−2.515
172.500+1.605
−1.419
172.500+2.061
−2.037
172.500+0.852
−0.827
172.500+0.794
−0.772

173.649+0.867
−0.837
174.013+1.466
−2.282
173.523+1.543
−1.404
173.826+2.066
−2.042
173.680+0.867
−0.835
173.673+0.810
−0.781

175.340+0.884
−0.841
176.328+1.353
−2.088
173.068+1.459
−1.363
174.771+2.038
−2.014
175.178+0.890
−0.843
175.354+0.821
−0.787

176.932+0.882
−0.836
176.326+1.386
−2.147
179.337+1.546
−1.397
178.204+2.040
−2.017
177.362+0.871
−0.829
177.031+0.816
−0.778

+0.822
172.060−0.811
+1.334
174.451−1.967
+1.450
170.945−1.420
+2.076
172.490−2.086
+0.821
172.233−0.802
+0.766
172.247−0.753

172.847+0.850
−0.816
175.305+1.236
−1.809
171.472+1.446
−1.423
173.185+2.074
−2.083
172.940+0.846
−0.811
173.069+0.781
−0.760

173.817+0.843
−0.803
176.675+1.141
−1.663
171.379+1.429
−1.412
173.720+2.045
−2.052
173.851+0.847
−0.805
174.129+0.766
−0.752

175.906+0.874
−0.822
176.888+1.110
−1.611
176.330+1.458
−1.386
176.454+2.034
−2.039
175.794+0.872
−0.820
175.979+0.778
−0.769

Table 4: Extracted mass for the bb̄4` (left) and hvq (right) generators matched with Py8.2, Py6.4, Hw7.1 and Hw6.5 using
the average value of the five leptonic observables. The average result is also shown.

Extracted mt [GeV]

184
182

Py8.2: mt = 172.500+0.794
−0.772 GeV
Py6.4: mt =
Hw7.1: mt =
Hw6.5: mt =

173.673+0.810
−0.781
175.354+0.821
−0.787
177.031+0.816
−0.778

186

bb̄4`

GeV

184

GeV
GeV

Extracted mt [GeV]

186

180
178
176
174

182

174

170

E(`+ `− ) pT (`+ )+pT (`− )

Hw6.5: mt = 175.979+0.778
−0.769 GeV

176

170

m(`+ `− )

Hw7.1: mt = 174.129+0.766
−0.752 GeV

178

172

pT (`+ `− )

hvq

Py6.4: mt = 173.069+0.781
−0.760 GeV

180

172

pT (`+ )

Py8.2: mt = 172.247+0.766
−0.753 GeV

pT (`+ )

pT (`+ `− )

m(`+ `− )

E(`+ `− ) pT (`+ )+pT (`− )

Fig. 11: Extracted mass for the bb̄4` (left) and hvq (right) generators matched with Py8.2 (red), Py6.4 (green), Hw7.1 (blue)
and Hw6.5 (orange) using the average value of the five leptonic observables. The horizontal band represents the weighted
average of the results, and the black horizontal line corresponds to mt = 172.5 GeV, which is the top mass value used in the
bb̄4`+Py8.2 reference sample.

10
Obs

gen

bb̄4`
max [GeV]
mW
bj

hvq

bb̄4`
max [GeV]
mW
bj

smearing
hvq

bb̄4`
Ebmax
j

[GeV]

hvq

R = 0.4

R = 0.5

R = 0.6

Py8.2

172.509 ± 0.002

172.522 ± 0.002

172.538 ± 0.002

Py6.4

172.487 ± 0.003

172.511 ± 0.003

172.538 ± 0.003

Hw7.1

172.509 ± 0.002

172.512 ± 0.002

172.517 ± 0.002

Hw6.5

shower

172.509 ± 0.003
172.485 ± 0.001

172.515 ± 0.003

172.518 ± 0.003

Py8.2
Py6.4

172.475 ± 0.001

172.499 ± 0.001

172.527 ± 0.001

Hw7.1

172.497 ± 0.001

172.498 ± 0.001

172.499 ± 0.001

Hw6.5

172.495 ± 0.001

172.500 ± 0.001

Py8.2

170.569 ± 0.002

172.497 ± 0.001

Py6.4

170.273 ± 0.002

171.117 ± 0.002

171.859 ± 0.002

Hw7.1

169.699 ± 0.002

170.419 ± 0.002

171.108 ± 0.002

Hw6.5

169.631 ± 0.002

171.223 ± 0.002

Py8.2

170.518 ± 0.001

170.451 ± 0.002

Py6.4

170.594 ± 0.001

171.384 ± 0.001

172.064 ± 0.001

Hw7.1

170.464 ± 0.001

171.202 ± 0.001

171.867 ± 0.001

Hw6.5

172.498 ± 0.001

171.403 ± 0.002

171.315 ± 0.001

172.513 ± 0.001

172.117 ± 0.002

171.996 ± 0.001

170.560 ± 0.001
67.145 ± 0.086

171.283 ± 0.001

171.953 ± 0.001

Py8.2
Py6.4

66.709 ± 0.123

69.042 ± 0.120

71.181 ± 0.117

Hw7.1

65.847 ± 0.084

67.948 ± 0.083

69.945 ± 0.082

Hw6.5

65.562 ± 0.121

69.809 ± 0.114

Py8.2

66.791 ± 0.068

67.631 ± 0.121

Py6.4

66.768 ± 0.067

69.257 ± 0.065

71.465 ± 0.062

Hw7.1

66.276 ± 0.065

68.650 ± 0.063

70.819 ± 0.061

Hw6.5

66.699 ± 0.061

68.923 ± 0.060

71.000 ± 0.057

69.614 ± 0.082

69.357 ± 0.063

71.747 ± 0.080

71.598 ± 0.061

max and E max at the NLO+PS level, showered by Pythia and Herwig, without hadronization or MPI
Table 5: Results for mW
bj
bj
effects, for different values of jet radius R.

11
Obs

gen

bb̄4`
max [GeV]
mW
bj

hvq

bb̄4`
max [GeV]
mW
bj

smearing
hvq

bb̄4`
Ebmax
j

[GeV]

hvq

R = 0.4

R = 0.5

R = 0.6

Py8.2

172.156 ± 0.004

172.793 ± 0.004

173.436 ± 0.005

Py6.4

172.191 ± 0.006

172.723 ± 0.006

173.252 ± 0.007

Hw7.1

172.253 ± 0.005

172.727 ± 0.005

173.183 ± 0.006

Hw6.5

shower

171.985 ± 0.008
172.203 ± 0.003

172.601 ± 0.008

173.175 ± 0.009

Py8.2
Py6.4

172.274 ± 0.003

172.788 ± 0.003

173.270 ± 0.004

Hw7.1

172.573 ± 0.004

173.038 ± 0.004

173.460 ± 0.004

Hw6.5

172.224 ± 0.004

173.419 ± 0.005

Py8.2

171.018 ± 0.002

172.861 ± 0.004

Py6.4

170.716 ± 0.002

172.267 ± 0.002

173.774 ± 0.002

Hw7.1

170.188 ± 0.002

171.626 ± 0.002

173.111 ± 0.002

Hw6.5

170.547 ± 0.002

174.288 ± 0.003

Py8.2

170.905 ± 0.001

172.407 ± 0.002

Py6.4

170.948 ± 0.001

172.459 ± 0.001

173.918 ± 0.001

Hw7.1

170.833 ± 0.001

172.319 ± 0.001

173.814 ± 0.001

Hw6.5

172.803 ± 0.003

172.717 ± 0.002

172.570 ± 0.001

173.429 ± 0.004

174.378 ± 0.002

174.203 ± 0.001

171.124 ± 0.001
67.792 ± 0.089

172.991 ± 0.001

174.851 ± 0.001

Py8.2
Py6.4

67.205 ± 0.123

70.343 ± 0.117

73.420 ± 0.113

Hw7.1

66.162 ± 0.083

69.050 ± 0.081

72.098 ± 0.083

Hw6.5

67.089 ± 0.117

73.930 ± 0.115

Py8.2

67.230 ± 0.066

70.364 ± 0.118

Py6.4

67.361 ± 0.066

70.558 ± 0.062

73.658 ± 0.061

Hw7.1

66.468 ± 0.065

69.716 ± 0.062

72.943 ± 0.062

Hw6.5

67.790 ± 0.060

71.113 ± 0.058

74.622 ± 0.057

71.200 ± 0.081

70.744 ± 0.064

74.454 ± 0.076

74.131 ± 0.060

max and E max results at the full level, i.e. with the inclusion of the MPI and of the hadronization.
Table 6: mW
bj
bj

12

References
1. S. Ferrario Ravasio, T. Ježo, P. Nason and C. Oleari, A
Theoretical Study of Top-Mass Measurements at the
LHC Using NLO+PS Generators of Increasing
Accuracy, Eur. Phys. J. C78 (2018) 458,
[1801.03944].
2. S. Frixione, P. Nason and G. Ridolfi, A Positive-weight
next-to-leading-order Monte Carlo for heavy flavour
hadroproduction, JHEP 09 (2007) 126, [0707.3088].
3. J. M. Campbell, R. K. Ellis, P. Nason and E. Re,
Top-pair production and decay at NLO matched with
parton showers, JHEP 04 (2015) 114, [1412.1828].
4. T. Ježo, J. M. Lindert, P. Nason, C. Oleari and
S. Pozzorini, An NLO+PS generator for t t¯ and Wt
production and decay including non-resonant and
interference effects, Eur. Phys. J. C76 (2016) 691,
[1607.04538].
5. P. Nason, A New method for combining NLO QCD with
shower Monte Carlo algorithms, JHEP 11 (2004) 040,

[hep-ph/0409146].
6. S. Frixione, P. Nason and C. Oleari, Matching NLO
QCD computations with Parton Shower simulations:
the POWHEG method, JHEP 11 (2007) 070,
[0709.2092].
7. S. Alioli, P. Nason, C. Oleari and E. Re, A general
framework for implementing NLO calculations in
shower Monte Carlo programs: the POWHEG BOX,
JHEP 06 (2010) 043, [1002.2581].
8. T. Ježo and P. Nason, On the Treatment of Resonances
in Next-to-Leading Order Calculations Matched to a
Parton Shower, JHEP 12 (2015) 065, [1509.09071].
9. T. Sjöstrand, S. Ask, J. R. Christiansen, R. Corke,
N. Desai, P. Ilten et al., An Introduction to PYTHIA 8.2,
Comput. Phys. Commun. 191 (2015) 159–177,
[1410.3012].
10. M. Bahr et al., Herwig++ Physics and Manual, Eur.
Phys. J. C58 (2008) 639–707, [0803.0883].
11. J. Bellm et al., Herwig 7.0/Herwig++ 3.0 release note,
Eur. Phys. J. C76 (2016) 196, [1512.01178].
12. K. Agashe, R. Franceschini, D. Kim and M. Schulze,
Top quark mass determination from the energy peaks of
b-jets and B-hadrons at NLO QCD, Eur. Phys. J. C76
(2016) 636, [1603.03445].
13. S. Frixione and A. Mitov, Determination of the top
quark mass from leptonic observables, JHEP 09
(2014) 012, [1407.2763].
14. T. Sjostrand, S. Mrenna and P. Z. Skands, PYTHIA 6.4
Physics and Manual, JHEP 05 (2006) 026,
[hep-ph/0603175].
15. G. Corcella, I. G. Knowles, G. Marchesini, S. Moretti,
K. Odagiri, P. Richardson et al., HERWIG 6: An Event
generator for hadron emission reactions with
interfering gluons (including supersymmetric
processes), JHEP 01 (2001) 010, [hep-ph/0011363].
16. J. M. Butterworth, J. R. Forshaw and M. H. Seymour,
Multiparton interactions in photoproduction at HERA,
Z. Phys. C72 (1996) 637–646, [hep-ph/9601371].
17. S. Gieseke, P. Stephens and B. Webber, New formalism
for QCD parton showers, JHEP 12 (2003) 045,
[hep-ph/0310083].
18. M. Bahr, S. Gieseke and M. H. Seymour, Simulation of
multiple partonic interactions in Herwig++, JHEP 07
(2008) 076, [0803.3633].
19. S. Gieseke, C. Rohr and A. Siodmok, Colour
reconnections in Herwig++, Eur. Phys. J. C72 (2012)
2225, [1206.0041].
20. P. Z. Skands, Tuning Monte Carlo Generators: The
Perugia Tunes, Phys. Rev. D82 (2010) 074018,
[1005.3457].
21. E. Boos et al., Generic user process interface for event
generators, in Physics at TeV colliders. Proceedings,
Euro Summer School, Les Houches, France, May

13

21-June 1, 2001, 2001. hep-ph/0109068.
22. ATLAS collaboration, New ATLAS event generator
tunes to 2010 data, .

