Topological invariants for interface modes
Guillaume Bal

∗

arXiv:1906.08345v3 [math-ph] 2 Jan 2021

January 5, 2021

Contents
1 Introduction

2

2 Spectral computation of interface invariants

4

3 Bulk-difference invariant

7

4 Bulk-Interface correspondence
10
4.1 Interface conductivity and pseudo-differential calculus . . . . . . . . . . . . . . 11
4.2 Fedosov-Hörmander formula and Bulk-Interface correspondence . . . . . . . . . 17
5 Conclusions

25

A Index of interface Hamiltonian

26

B Calculations of conductivities in systems (1) and (2)

27

C Equivalence of bulk-difference invariants

32

D Bulk-interface correspondences

34

E Semiclassical calculus and Helffer-Sjöstrand formula

36

Abstract
We consider topologically non-trivial interface Hamiltonians, which find several applications in materials science and geophysical fluid flows. The non-trivial topology manifests
itself in the existence of topologically protected, asymmetric edge states at the interface
between two two-dimensional half spaces in different topological phases. It is characterized
by a quantized interface conductivity. The objective of this paper is to compute such a
conductivity and show its stability under perturbations. We present two methods.
The first one computes the conductivity using the winding number of branches of absolutely continuous spectrum of the interface Hamiltonian. This calculation is independent
of any bulk properties but requires a sufficient understanding of the spectral decomposition
of the Hamiltonian. In the fluid flow setting, it also applies in cases where the so-called
bulk-interface correspondence fails.
The second method establishes a bulk-interface correspondence between the interface
conductivity and a so-called bulk-difference invariant. We introduce the bulk-difference
∗

University of Chicago; guillaumebal@uchicago.edu

1

invariants characterizing pairs of half spaces. We then relate the interface conductivity to
the bulk-difference invariant by means of a Fedosov-Hörmander formula, which computes
the index of a related Fredholm operator.
The two methods are used to compute invariants for representative 2 × 2 and 3 × 3
systems of equations that appear in the applications.

Keywords: Interface Hamiltonian, Fredholm operator, index theory, bulk-difference invariant, bulk-interface correspondence, semiclassical calculus, topological insulators, topological
waves.

1

Introduction

Topological invariants offer a useful description of phenomena that appear to be immune to
large classes of perturbations. The macroscopic transport properties of topological insulators
are for instance known to be dictated to a large extent by a topological invariant characterizing
their phase [6, 21, 36]. More recently, the behavior of equatorial waves and that of other wave
phenomena was also shown to afford a topological description [12, 38, 40, 42]. Its main practical
consequence is the stability of some macroscopic transport properties in the presence of defects.
This paper addresses the computation of these invariants and their relations to quantized
physical observables for continuous two-dimensional models that appear in the analysis of
topological insulators and topological waves.
We consider Hamiltonians generically denoted by H[µ] with µ an order parameter taking
values in R (or more general manifolds). A typical Hamiltonian that appears in the analysis
of topological insulators with µ = m a mass term is the 2 × 2 Dirac system
!
m
ξ − iζ
H[m(y)] = D · σ + m(y)σ3 ,
H[m] = k · σ + mσ3 =
,
(1)
ξ + iζ −m
in the physical and Fourier variables (when m is constant), respectively. Here, x = (x, y) are
the spatial variables, k = (ξ, ζ) the dual Fourier variables, D = (Dx , Dy ) with Dx = 1i ∂x and
Dy = 1i ∂y while σ = (σ1 , σ2 ) and σ1,2,3 are the standard Pauli matrices. The above system as
well as more general (and more physical) block-diagonal direct sums of such elementary blocks
appear naturally (and generically) in the analysis of topological insulators [3, 4, 14, 16, 20].
For equatorial waves, µ = f is the Coriolis force (with as a possible second order parameter
an odd viscosity term ǫ in which case f below is replaced by f + ε∆ [12, 40, 42]). The typical
3 × 3 system we consider is


0
ξ
ζ



H[f (y)] = Dx , Dy , −f (y) · Γ,
H[f ] = (ξ, ζ, −f ) · Γ = ξ
(2)
0
if  ,
ζ −if 0
where Γ = (γ1 , γ4 , γ7 ) involves some of the Gell-Mann matrices used in the representation of
the Lie algebra su(3); see [12, 40] for derivations of such a fluid model and its applications.1
The above system applies to a vector field (η, u, v) with η the (variation of the) thickness of
the two dimensional fluid and (u, v) its velocity components.
1

The physical system H[f (y)] is the same as in [12, 40, 42] while its Fourier domain representation H[f ] is
not. Our convention for plane wave representations is ei(k·x−Et) (rather than ei(Et−k·x) ) so that k = (ξ, ζ) is
the Fourier multiplier of D = 1i ∇, a non-negotiable convention in semiclassical analysis. This choice affects the
numerical values of our topological invariants. The dispersion relations E = E(k) and group velocities ∇k E(k)
are, however, the same in both representations.

2

The main objectives of the paper are to introduce an interface invariant describing the
asymmetric transport along the interface and to devise means to compute it.
Physically interesting phenomena appear when insulating domains with different bulk
topologies are brought next to each other. Consider a material modeled by a Hamiltonian
H[µ]. It is said to be insulating in the energy range [E1 , E2 ] when the latter interval and the
spectrum of H[µ] do not intersect. A bulk topology may then be assigned to H[µ] [6, 21, 36];
we do so in section 3 below. Consider two materials modeled by H[µ± ] in the half spaces
±y > 1 with bulk topologies characterized by integers I± = I(µ± ) (with a (possibly) smooth
transition between the two). The interface will be modeled more generally by a varying order
parameter µ = µ(y) and corresponding interface Hamiltonian H[µ(y)]. At the interface y ∼ 0,
the bulk invariant is not defined, the energy gap closes, and transport along the interface is
allowed. Quite surprisingly, transport is typically asymmetric, with more modes moving in
one direction than in the other one.
The domain walls µ(y) and the construction of spatial truncations and of density of states
within the bulk band gap [E1 , E2 ] are all conveniently represented as switch functions f ∈
S[f− , f+ , x− , x+ ] which we define as the family of bounded functions from R to R such that
f (x) = f−

∀x ≤ x−

and

f (x) = f+

∀x ≥ x+ .

(3)

We also denote by S[f− , f+ ] the union of the above switch functions over all x− ≤ x+ . A
smooth switch function is a switch function in C ∞ (R). A domain wall µ(y) is then typically
an element in S[µ− , µ+ ]. We also consider domain walls of the form µ(y) = λy for R ∋ λ 6= 0.
This topologically protected asymmetric transport is characterized by what we call an
interface conductivity, in analogy to the linear response to radiation in condensed matter
physics [6, 21, 36]. This conductivity is defined for a Hamiltonian H = H[µ(y)] as
σI = σI [H] := Tr i[H, P ]ϕ′ (H).

(4)

Here, P = P (x) is a smooth switch function from R to [0, 1] in S[0, 1, x0 − β, x0 + β] for some
β > 0. The conductivity σI is in fact independent of x0 and α. Above, ϕ(E) is constructed as
a smooth switch function in S[0, 1, E1 , E2 ] such that ϕ′ (E) ≥ 0 to afford an interpretation as
a density of states while ϕ′ (H) is then constructed by spectral calculus. The interval [E1 , E2 ]
is chosen to lie in a bulk band gaps of H[µ± ].
The interpretation of σI is as follows. ϕ′ (H) may be seen as a (nonnegative) density of
states (integrating to 1). The range of energies in the system is restricted to this interval to
avoid leakage into the bulk. Then P may be seen as an observable with hψ|P |ψi quantifying
d
he−itH ψ|P |e−itH ψi =
an amount of signals to the right of x0 . Its evolution hψ|Ṗ |ψi := dt
d
itH
−itH
Pe
|ψi in Hamiltonian dynamics results in the Heisenberg formalism as Ṗ =
dt hψ|e
i[H, P ] with [A, B] = AB − BA the usual commutator. The above (operator) trace then has
the clear physical interpretation (if defined) as a rate of signal moving from the left of x0 to the
right of x0 . This conductivity has appeared in different contexts in many works on topological
protection of edge states [3, 15, 17, 18, 36].
It turns out that σI is often quantized (2πσI ∈ Z) with an invariant that is immune to
perturbations in the definition of H. Moreover, the asymmetry is quantified by a general
principle, the bulk-interface correspondence, which states that the excess of modes going in
one direction versus the other is given by I(µ+ ) − I(µ− ).
While appealing, this correspondence does not (quite) always apply in the case of equatorial
waves [12]. In particular, the number of edge states depends on the structure of the Coriolis
force term f (y) with a number of asymmetric interface modes equal to 2 when f (y) = λy and
equal to only one when f (y) = f0 sign(y). The main heuristic reason for such difficulties comes
3

from the fact that the topological change occurs when f (y) changes signs. For such a value, the
gap closing of the Hamiltonian H[f ] coincides with a sheet of infinitely degenerate spectrum
(modes in geostrophic balance corresponding to an infinitely degenerate 0 ∈ Sp(H[f = 0])),
whose behavior is influenced by the profile of the variation f (y).
This paper introduces two methodologies to compute the interface conductivity σI . The
first one, presented in section 2, extends the work in [3] on the system (1) to more general
Hamiltonians including the one in (2). The method is based on mapping H[µ(y)] to an
appropriate Fredholm operators as in [3, 36]. The index of the operator is then related to
a sequence of winding numbers associated to the Hamiltonian’s continuous spectrum. Such
invariants are defined independently of any bulk invariant. Moreover, the method allows us to
compute σI for H defined in (2) both when f (y) = λy and when f (y) = f0 sign(y). The main
drawback of the method is that it requires explicit knowledge of the structure of the branches
of absolutely continuous spectrum. Once these invariants are computed, one shows as in [3]
that they are stable with respect to appropriate classes of perturbations HV := H[µ(y)] + V .
The second methodology is based on a new bulk-interface correspondence relating the
above interface conductivity to the symbol of an appropriate Fredholm operator whose index is
computed directly from its symbol in a Fedosov-Hörmander formula. This correspondence may
be interpreted as a topological charge conservation as described in [27, 43]. A reinterpretation
of the formula then relates the conductivity to several equivalent expressions of a quantity we
call a bulk-difference invariant, which generalizes the difference of bulk invariants we mentioned
above.
The bulk-difference invariant is introduced in section 3. We present in section 4 a semiclassical analysis of the interface conductivity and show how to relate it to the bulk-difference
invariant and to an index theory similar to that of Fedosov-Hörmander [30, Chapter 19]. The
correspondence shares some similarities with the bulk-interface correspondence based on spectral flows and spectral asymmetry in the physics literature [22, 27, 43]; see Appendix D. Our
constructions also show that the interface conductivity is stable with against perturbations V .
As an application to the system (2), we obtain that the bulk-interface correspondence applies provided that f (y) varies sufficiently slowly. This is consistent with the explicit computations obtained when f (y) = λy and tends to indicate that the bulk-interface correspondence
does not apply when f (y) = f0 sign(y) because the latter is too singular.

2

Spectral computation of interface invariants

This section computes the interface conductivity σI defined in (4) for Hamiltonians H =
H[µ(y)] in terms of the winding number of their branches of absolutely continuous spectrum.
This extends work in [3] on the system (1).
The order parameter µ = µ(y) ∈ S[µ− , µ+ ] generates a domain wall in the topologically
non-trivial case µ+ µ− < 0. The non-vanishing values of µ act as insulators while the interface
in the vicinity of y = 0 where µ changes signs becomes conducting. This is the physical origin
for the topologically protected asymmetric transport.
The results in [3] show that we can relate σI to the index of a Fredholm operator and
that both remain quantized when H is replaced by H + V for V in an appropriate class of
perturbations. The computation of σI based on branches of absolutely continuous spectrum
is independent of any definition of bulk invariants and hence of any bulk-interface correspondence. However, it is useful in practice when the branches can be analyzed in sufficient detail.
The analysis carried out in [3] for the system (1) applies to general mass terms m(y). However, the algebra for the 3 × 3 system in (2) is more complex and carried out only in specific
4

situations such as when f (y) = λy and f (y) = f0 sign(y). The details of these calculations are
presented in Appendix B.
We consider a Hamiltonian H = H[µ(y)] acting on vectors (ψk (x, y))1≤k≤N with coefficients
µ = µ(y) independent of x so that the following spectral decomposition holds:
Z ⊕
−1
H[ξ]dξFx→ξ .
(5)
H = Fξ→x
R

Here F is the one dimensional Fourier transform in the x-variable. We assume that H is an
unbounded self-adjoint operator from its domain of definition D(H) to L2 (R2 ) ⊗ CN . The
domain of definition is defined as (H ± i)−1 (L2 (R2 ) ⊗ CN ), which is a subspace of L2 (R2 ) ⊗ CN
independent of ± [11, Theorem 1.2.7]. We verify in Appendix B that this property holds (1)
and (2). Since H is self-adjoint, we have access to the corresponding spectral calculus; see [11]
and Appendix E.
Let (E1 , E2 ) be a fixed interval. We assume:
[H-AC]: (i) for each ξ ∈ R, H[ξ] restricted to the interval [E1 , E2 ] has finite rank and vanishes
for ξ outside of a compact set; and (ii) the existence of smooth (in ξ) corresponding eigenvalues
Ej (ξ) and rank-one projectors Πj (ξ) (with Schwartz kernel ψj (y, ξ)ψj∗ (y ′ , ξ) for normalized
R
eigenvectors R |ψ(y, ξ)|2 dy = 1) parametrizing a finite number J of branches of absolutely
continuous spectrum.
The above branches Ej (ξ) are so far defined on an implicit compact domain Ξj ∋ ξ. They are
extended by continuity to ξ ∈ R as the unique continuous branches still called Ej (ξ) such that
Ej (ξ) ∈ {E1 , E2 } for ξ 6∈ Ξj .
We now construct a unitary operator from the restriction of H to the interval [E1 , E2 ]. Let
ϕ(E) be a smooth switch function in S[0, 1, E1 , E2 ]. We then define the unitary operator
U (H) = ei2πϕ(H) ,

W (H) = U (H) − I

by spectral calculus [13]. Note that W (E) is compactly supported in (E1 , E2 ). By assumption,
we have the decomposition
W (H) = F

−1

Z

⊕

J
X

(E1 ,E2 ) j=1

W (Ej (ξ))Πj (ξ)dξ F = F

−1

Z

J
⊕X

R

j=1

W (Ej (ξ))Πj (ξ)dξ F.

Let finally P be either the function P defined in the introduction or a spatial projector
onto x ≥ x0 for x0 ∈ R, i.e., point-wise multiplication by H(x − x0 ), the Heaviside function.
Then, as an extension of the results [3], we have
Theorem 2.1 Let P and U (H) be defined as above for H satisfying the hypothesis [H-AC](i)(ii). Then P U (H)P is a Fredholm operator on the range of P . Moreover,
I[H] := Index(P U P ) = −Tr[P, U ]U ∗ =

J
X
j=1

W1 (ei2πϕ◦Ej )

(6)

with W1 (f ) the winding number of a unimodular complex function f with compactly supported
gradient, given explicitly by
Z
1
∂ξ f f ∗ (ξ)dξ.
(7)
W1 (f ) =
2πi R

5

The proof of this theorem is given in Appendix A. Applying the above theorem yields
I[H] = Tr[U, P ]U ∗ = N+ − N− ,
where N+ is the number of branches Ej such that Ej (ξ) ∈ S[E1 , E2 ] while N− is the number
of branches Ej such that Ej (ξ) ∈ S[E2 , E1 ]. Branches such that Ej (ξ) belongs to S[E1 , E1 ]
or S[E2 , E2 ] do not contribute to I[H].
Stability and interface conductivity. One of the main reasons to develop the above
apparatus borrowed from non-commutative geometry (see [3, 36] and their references) is that
it allows us to include spatial perturbations in the Hamiltonians. Let H be as above and
HV = H + V a perturbed Hamiltonian.
We recall results from [3] for completeness. Stability of the interface conductivity σI is
guaranteed when V is relatively compact with respect to H, which means that V (H + i)−1 is
a compact operator in the L2 sense. For the 2 × 2 problem (1), any V = V (x, y) an operator
of point-wise multiplication by a bounded function that decays to 0 at infinity satisfies such
hypotheses since the symbol of (H + i)−1 decays to 0 as (ξ, ζ) → ∞; this is essentially an
application of Rellich’s compactness criterion [39]. In other words, the topology is fixed by
our assumptions ‘at infinity’ but V can be arbitrarily large (bounded) so long as it decays at
infinity. For the 3 × 3 system (2), the symbol of (H + i)−1 does not converge to 0 as (ξ, ζ) → ∞
and it is more difficult to characterize operators V for which the above criterion holds.
Let us define U [HV ] = ei2πϕ(HV ) spectrally. Then we have [3]
Theorem 2.2 P U [HV ]P on the range of P is a Fredholm operator and
I[HV ] := Index(P U [HV ]P ) = I[H].

(8)

The interface index is thus independent of any relatively compact perturbation.
Still following [3], we now relate the above index to the interface conductivity in (4). The
latter is also stable with respect to perturbations V although it is less stable than the above
index I[HV ]. Let us now impose that V is of the form V = V1 V2 with
kVj k ≤ C and k(z − H)−1 Vj kHS ≤ C|ℑz|−1

j = 1, 2,

(9)

where HS is the Hilbert-Schmidt norm. It is then proved in [3] that [HV , P ]ϕ′ (HV ) is indeed
a trace-class operator and we have:
Theorem 2.3 Let H be as above and V a perturbation satisfying (9). Then the operator
i[HV , P ]ϕ′ (HV ) is trace-class and
σI := iTr[HV , P ]ϕ′ (HV ) =

1
I[HV ].
2π

This provides a means to compute the topologically protected conductivity σI by spectral
analysis of the unperturbed Hamiltonian H[µ(y)] using Theorem 2.1 above.
That the interface conductivity is quantized is consistent with the numerical simulations
presented in, e.g., [12, 40]. The calculations of interface conductivities for the systems (1) and
(2) are presented in Appendix B. A summary for system (1) is that 2πσI = − sign(m+ ) when
m(y) is a domain wall between m− and m+ when m+ m− < 0 (with σI = 0 when m+ m− > 0)
while 2πσI = − sign(λ) when m(y) = λy. For system (2), we find that 2πσI is given by
sign(f0 ) when f (y) = f0 sign(y) while it is given by 2 sign(λ) when f (y) = λy.
This discrepancy is reminiscent of correction terms in Levinson’s theorem caused by the
presence of resonances for the Hamiltonian at energy 0 [23, 31].
6

3

Bulk-difference invariant

Bulk invariants are defined when the coefficients µ such as m or f above are constant. They
are of interest in their own right and may be extended to operators with spatially varying
coefficients as in [3] and in a variety of other settings [36]. They are also instrumental in
bulk-boundary correspondences [8, 9, 14, 17, 24, 25, 28, 32, 33, 36], which relate them to the
interface conductivity σI .
With F = F(x,y)→k=(ξ,ζ) the two-dimensional Fourier transform, we may then write the
spectral decomposition
Z
H = F −1

⊕

H(k)dkF

R2

where H(k) is Mn (C)-valued (square matrices of dimension n) with n = 2 and n = 3 in (1)
and (2), respectively. We then have the spectral decomposition
H(k) =

n
X

hi (k)Πi (k)

(10)

i=1

with eigenvalues hi (k) ∈ R for k ∈ R2 ordered with increasing values and rank-one orthogonal
projectors Πi (k) = ψi (k)ψi∗ (k) for 1 ≤ i ≤ n. We assume that hi (k) and Πi (k) are sufficiently
smooth (e.g. C 2 ) in the variable k. This holds for H(k) smooth and in the presence of (local)
spectral gaps separating the energies i 7→ hi (k).
p
For the 2×2 problem in (1), we even have global spectral gaps since h1,2 (k) = ∓ |k|2 + m2
with
p one spectralpgap given by (−|m|, |m|) while for the 3 × 3 problem in (2), h1,2,3 (k) =
(− |k|2 + f 2 , 0, |k|2 + f 2 ) with two global spectral gaps given by (−|f |, 0) and (0, |f |). The
(smooth) rank-one projectors are also well known; see (34) below for the 3 × 3 system as well
as [12, 21, 40, 42]. In both cases, Π1 ≡ Π− corresponds to the projection of the Hamiltonian
onto its (strictly) negative spectrum.
P
Let Π(k) be any sum Π(k) = i∈I Πi (k) for I a subset of {1, . . . , n} independent of k. Then
k 7→ Π(k) defines a vector bundle over the base manifold R2 [21, 34]. When R2 is replaced by
a compact manifold M , then vector bundles over M admit topological classifications based on
their Chern classes. For the above projectors, living in spaces of matrices over M , such classes
integrated over the base manifold give rise to integer-valued objects called Chern numbers:
Z
Z
i
i
trΠdΠ ∧ dΠ =
trΠ[∂1 Π, ∂2 Π]d2 k ∈ Z.
c̃[Π] =
2π M
2π M
Here, [A, B] = AB − BA and tr refers to the standard matrix trace.
When M is not compact, for instance R2 , the domain of interest in this paper, the above
integrals can often still be evaluated but are no longer guaranteed to be integer-valued [3, 12,
21, 40, 42]. For instance, for the 2 × 2 problem, c̃[Π1 ] = 12 sign(m). A possible solution to
this issue is to regularize the Hamiltonian and its projectors in such a way that they take a
unique value as |k| → ∞. This allows one to compactify the plane around the unit sphere
mapping ∞ to the south pole, say, and still obtain a continuous family of projectors on the
sphere. The above integral, which is manifestly invariant by change of variables from its
P dP ∧ dP form, may then be computed for M = S2 and shown to be integral. A typical
regularization consists in replacing m by m − η|k|α for α > 1 and η 6= 0. We may then show
that c̃[Π1 ] = 12 ( sign(m) + sign(η)) ∈ Z [3].
A similar regularization, based on replacing f by f − η|k|2 in the 3 × 3 model (2), also
allows one to define a topological invariant on the sphere S2 . One then finds that c̃[Π3 ] =
−c̃[Π1 ] = ( sign(f ) + sign(η)) ∈ Z [40, 42].
7

The bulk invariants of such regularized operators therefore depend on the sign of the
regularization. The main advantage of this regularization is that it still applies in the setting
where H is no longer translationally invariant [3]. We now propose a different method to
bypass this somewhat artificial regularization term and define topological invariants in the
specific situation of interest here, namely the analysis of interface Hamiltonians, with one half
space essentially corresponding to a bulk invariant coming from m+ or f+ and the other half
space corresponding to a (possible) sign change of the mass terms m− or f− . More generally,
let us assume the existence of two Hamiltonians
n
X
±
±
h±
(11)
H (k) =
i (k)Πi (k)
i=1

Π±
i (k).

with smooth projectors k →
The structure of the energies h±
i (k) is irrelevant beyond
the existence of well-defined gaps and each hi (k) may be continuously modified (homotopically transformed) to a single value hi (flat band) that depends on neither k nor ±. In the
applications of interest here, the two Hamiltonians are identical except for the value of their
mass terms µ± .
P
±
Construction of the bulk-difference invariants. Let Π± (k) =
i∈I Πi (k) for I ⊂
{1, . . . , n} independent of k ∈ R2 be two smooth families of projectors. Defining k = |k|θ,
we assume the continuous matching (gluing condition) of the projectors in all directions at
infinity:
lim Π+ (|k|θ) = lim Π− (|k|θ)
for all θ ∈ S1 .
(12)
|k|→∞

|k|→∞

We assume that these limits exist and are continuous in θ. In our applications, the projectors
at ∞ do not depend on the mass terms m or f and thus satisfy the above hypothesis.
We then define a new projector Π(k) for k an element in the union of two planes P± ≃ R2
that are wrapped around the unit sphere S2 ≃ (P+ ⊔ P− )/ ∼ so that the circles at infinity are
glued (identified by ∼) along the sphere’s equator. For k ∈ P± , we define Π(k) = Π± (k). For
a point φ on the sphere, a form of stereographic projection π maps φ in the upper half sphere
to k ∈ P+ and φ in the lower half sphere to k ∈ P− . More precisely, with φ ∈ S2 parametrized
by (x, y, z), we have
(x, y) = p

k
1 + |k|2

,

z=p

±1

1 + |k|2

,

k ∈ P± ,

with π the inverse map, i.e., k = π(φ). We then define π ∗ Π(φ) = Π(π(φ)) the pull back by
π (still called Π(φ) ≡ π ∗ Π(φ) to simplify notation) a projector that is now continuous on S2
thanks to the continuity assumption (12). We may therefore define the Chern numbers as
integrals over the sphere, a compact cycle, which written on the sphere and then pushed by π
to the planar variables, are given by
Z
Z


i
i
trΠdΠ ∧ dΠ =
tr Π− [∂1 Π− , ∂2 Π− ] − Π+ [∂1 Π+ , ∂2 Π+ ] dk,
(13)
c[Π] =
2π S2
2π R2

where the − sign above is necessary to ensure that S2 has a given orientation, here inherited
from that of the lower plane P− and opposite that of the upper plane P+ . This ensures that S2
also inherits its orientation from the dx ∧ dy ∧ dz > 0 positive orientation of R3 it is embedded
in.
Definition
invariant) Let H ± (k) be decomposed as in (11) and let
P 3.1 (Bulk-difference
±
±
Π (k) = i∈I Πi (k) for I ⊂ {1, . . . , n} satisfying the gluing condition (12). Then the above
integrals c[Π] are well defined integers we call the bulk-difference invariants. We define ci =
c[Πi ] when I = {i}.
8

These invariants are by construction immune to any (continuous) perturbation of H(k) that
maintains the spectral gaps and the gluing assumptions as |k| → ∞ and satisfy the general
additivity property of Chern numbers [2] resulting from the additivity property of Chern
classes [34]:
c[Πi + Πi+1 ] = c[Πi ] + c[Πi+1 ].
When the two Hamiltonians satisfy H+ = H− , then the above integral vanishes. However, for
the system H± = k · σ + m± σ3 , which satisfies all the above assumptions, we find, following
calculations as in e.g. [3] that
c− := c[Π1 ] = −c+ := −c[Π2 ] =

1
1
sign(m− ) − sign(m+ ) ∈ Z
2
2

(14)

which is a bona fide invariant even in the absence of regularization (η = 0 above). For the
system (2), which also satisfies the above assumptions, we find that
c+ := c[Π3 ] = c0 + c+ := c[Π3 + Π2 ] = −c− := −c[Π1 ] = sign(f− ) − sign(f+ ) ∈ Z.

(15)

The calculations are given in some detail in Appendix C; see (34) and the following computations. For the above problem, only c+ needs to be computed since c− = −c+ by symmetry
and c+ + c0 + c− = 0.
Explicit calculations of Chern numbers may be obtained in several ways. The first one is
to compute the Berry curvature itr Πi dΠi ∧ dΠi directly (from ψi (k)) and integrate it over the
plane(s) R2 , as done for instance in [3, 12, 40]. The second method consists in directly looking
at the line bundle generated by ψi (k) and how charts covering the sphere need to be glued by
an appropriate transition of connections to respect the twists of the eigenvectors [6, 21, 42].
The third method, which is the most versatile when it applies, recasts the Chern number as
the degree of a map k → h(k) = (ξ, ζ, m) ∈ R3 \{0} [3, 21, 23]. In particular, it applies to
system (2) seen as a spin-1 representation and provides the computations in (15) [23].
Green’s function invariant. We now consider a different form of the bulk-difference invariant based on the notion of resolvent or Green’s function [27, 43] and similar to calculations
based on the Kubo formula [6]. It is given by
−1

G = Gα (ω, k) = (z − H(k))

=

n
X
i=1

(z − hi (k))−1 Πi (k)

for k in a domain K and z = α + iω with α a fixed real number in a global spectral gap, i.e.,
α 6= hi (k) for all 1 ≤ i ≤ n and k ∈ K. Therefore, G and G−1 are well-defined with obviously
G−1 (k) = z − H(k).
Here, we consider K = S2 ≃ (R2 ⊔ R2 )/ ∼, the sphere introduced earlier. We thus assume
that for each 1 ≤ i ≤ n, Π±
i (k) satisfy the gluing conditions (12). In addition, we assume
−1 also satisfy the gluing conditions (12). Thus, the resulting (z − h )−1 Π
that (z − h±
(k))
i
i
i
is continuous on S2 ≃ (R2 ⊔ R2 )/ ∼. We identify ω ∈ R with its one point compactification
R/ ∼≃ S1 where the points at infinity ω → ±∞ are identified. We observe that (z − hi )−1
and hence G is also continuous on R/ ∼≃ S1 . We have thus constructed a continuous function
from M = S1 × S2 ≃ (R/ ∼) × (R2 ⊔ R2 )/ ∼ to GLn (C) the space of n−dimensional invertible
matrices.
Associated to the Green’s function is the three dimensional (generalized) winding number
Z
Z
1
1
−1
∧3
tr(dG G) = 2
tr∂ω G−1 G[∂1 G−1 G, ∂2 G−1 G]dωd2 k,
(16)
Wα =
24π 2 M
8π M
9

where by a slight abuse of notation, the above right-hand side should be interpreted as an
integration over the two half planes P± as in (13). Since the groups [34] π3 (S1 × S2 ) =
π3 (S1 )⊕π3 (S2 ) = Z, the (generalized) three-dimensional winding number of G is a well-defined
integer.
The above winding number is related to the Chern numbers we previously defined [27, 36,
43] by:
Lemma 3.2 For α in a global spectral gap, let G = Gα be constructed from H ± (k) as described
above. Let Wα and ci = c[Πi ] be defined in (16) and (13), respectively. Then we have the
relation
X
X
Wα = −
ci =
ci .
(17)
hi <α

hi >α

The proof of the lemma is given in Appendix C.
Note that the Chern numbers c[Πi ] have been defined for sufficiently smooth projectors
without conditions on the energies hi (k) besides local gaps ensuring the regularity of k →
Πi (k). In contrast, Gα is defined only for α in a global spectral gap. The global spectral gap
condition is satisfied in the applications considered here, with a global gap α ∈ (−|m|, |m|) for
(1) and two global gaps α ∈ (−|f |, 0) ∪ (0, |f |) for (2).
The form of the invariant (16) appears naturally in the subsequent analysis of the bulkinterface correspondence. It also offers a convenient computational tool, in particular (33)
below that appears in the proof of the above lemma. The formula is used to compute the
bulk-difference invariant for the system (2) in Appendix C.

4

Bulk-Interface correspondence

We return to the computation of the interface invariant σI .
The bulk-interface correspondence stipulates that the amount of asymmetric current, or
equivalently the number of topologically protected edge states, is given by the bulk-difference
invariant. For the system (1), the difference therefore equals c− = 2πσI = − sign(m) in the
topologically nontrivial case, whereas for the system (2), it is given by c− = 2πσI = 2 sign(f ).
In both cases, µ(y) is a smooth switch function in S[−µ, + µ].
Many techniques have been developed to prove or at least build intuition on the correspondence between bulk invariants and the number of edge or interface modes. The edge
problem considers bulk Hamiltonians in the plane and their restriction to a half plane with
appropriate boundary conditions along the edge. The relation between the bulk invariant and
the number of topological edge states is then referred to as a bulk-boundary correspondence
[8, 9, 17, 24, 25, 28, 32, 33, 36].
This paper considers a similar problem, the domain wall problem, where the order parameter µ(y) transitions, smoothly or not, from one bulk topology to another. The relation between
the two bulk invariants, and more precisely the bulk-difference as established in the preceding section, and the number of protected interface modes is the bulk-interface correspondence
[22, 19, 43]. A brief discussion on these works on spectral flows and spectral asymmetries and
their relation to the results of this paper is presented in Appendix D.
The main advantage of deriving a bulk-interface correspondence is that it avoids the explicit
spectral decomposition and the search for topologically non-trivial branches of continuous
spectrum that we carried out in section 2. The computation of σI is directly obtained from
calculations of presumably simpler bulk invariants.
The main result of this section is to recast the interface conductivity as an appropriate
integral of the symbol of the Hamiltonian H that is familiar in index theory [1, 30, 35]. This
10

integral is in the form of a Fedosov-Hörmander formula and computes the index of a Fredholm
operator naturally related to H. By an application of the Stokes’ theorem, it is also related to
the bulk-difference invariant in (16). This correspondence essentially realizes the topological
charge conservation of [19, 43].
We recall the chain of relations obtained under different assumptions in section 2:
2πσI = 2πTr i[H, P ]ϕ′ (H) = −Tr[P, U (H)]U ∗ (H) = Index P U (H)PRanP =: I[H].

(18)

We recall that ϕ is a smooth function increasing from 0 to 1 with ϕ′ ≥ 0 supported in a
spectral gap while U (H) = ei2πϕ(H) . The main objective of the section 4.1 is to find sufficient
conditions on the symbol of H such that (18) holds.
Once 2πσI will be guaranteed to be integer-valued and constant over continuous deformations of H, we will evaluate the trace defining σI by applying semiclassical calculus tools
similar to those used to derive the index of elliptic pseudo-differential operators on R2 [30,
Chapter 19] in section 4.2.

4.1

Interface conductivity and pseudo-differential calculus

The terminology used in the rest of the paper on pseudo-differential operator (ΨDO) and
semiclassical pseudo-differential operators (hΨDO) is borrowed from [13]; see also [7] for the
extension of results to matrix-valued symbols. Appendix E summarizes the notation and
results on ΨDO and hΨDO we use in this paper. Throughout, we use the notation hXi =
√
1 + X 2 for X ∈ R and hXi−∞ as a quantity bounded by CN hXi−N for every N ∈ N.

We now find sufficient criteria ensuring that [H, P ]ϕ′ (H) and [P, U (H)]U ∗ (H) are traceclass. Let H = Opw (σ) be a self-adjoint ΨDO with symbol σ = σ(x, y, ξ, ζ) in S(mn ) with
mn (x, y, ξ, ζ) := (hxi + hyi + hξi + hζi)n for n ∈ N. Let α ∈ R be an energy level. We want to
show that (H − α)2 = Opw (τα ) with symbol τα = (σ − α)♯(σ − α) is well-approximated by a
positive-definite operator Gα = Opw (τ̃α ).
Proposition 4.1 Let α ∈ R and E0 > 0. Let H = Opw (σ) with σ ∈ S(mn ) and (H − α)2 =
Opw (τα ) as above.
We assume the existence of Gα = Opw (τ̃α ) a self-adjoint operator such that Gα has no spectrum
in (−∞, E02 ] and such that either:
(H1) τ̃α = τα for y 2 + ζ 2 + ξ 2 > R2 ; or:
(H2) τα − τ̃α in S(m) with m = hyi−∞ (hξi + hζi)2n and (I + (H − α)2 )−1 has Weyl symbol in
S(m) with m = (hζi + hξi)−s for s > 0.
Let φ be a smooth function with compact support in (−E0 , E0 ) and P a smooth switch function
in S[0, 1].
Then [P, φ(H − α)] and [P, H]φ(H − α) are trace-class operators with traces computed as the
integral of their Schwartz kernel along the diagonal.
Proof. By hypothesis, Gα has no spectrum in (−∞, E02 + δ) for some δ > 0 and we can
thus construct a smooth function compactly supported ψ : [0, ∞) → R such that ψ(Gα ) = 0
and ψ(E) = 1 for 0 ≤ E ≤ E0 . This implies that ψ(λ2 )φ(λ) = φ(λ) by assumption on φ.
By spectral calculus and following a similar construction in [29], we have
φ(H − α) = ψ(H1 )φ(H − α) = ψ(H1 ) − ψ(H2 ))φ(H − α),
11

with H1 = (H − α)2 and H2 = Gα . Therefore, [P, H]φ(H − α) is trace-class when [P, H]ψ(H1 )
is since φ(H − α) is bounded. Taking a commutator with P provides localization in x since
[P, A] = χ(x)A(1 − χ(x)) − (1 − χ(x))Aχ(x),
with χ(x) a multiplication operator with symbol bounded by hxi−∞ for x < 1 and 1 − χ(x) an
operator with symbol bounded by hxi−∞ for x > −1. For A a ΨDO with symbol in S(mA ),
then [P, A] has a symbol in S(mA hxi−∞ ) by composition of three ΨDO; see [13, Chapter 7]
and [15].
Let us first prove the results under hypothesis (H1). The Helffer-Sjöstrand formula (42)
(see also [11, 13] and [13, Eq. (9.11)]) gives the expression:
Z
1
∂¯ψ̃(z − H1 )−1 (H1 − H2 )(z − H2 )−1 d2 z,
ψ(H1 ) = ψ(H1 ) − ψ(H2 ) = −
π C
where d2 z = dλdω for z = λ + iω, and ψ̃ is an almost analytic extension of ψ as in (42);
see also Appendix E. The operators (z − Hk )−1 have symbols in S(1) bounded by C|Imz|−1
uniformly on the compact support of ∂¯ψ̃, itself satisfying |∂¯ψ̃| ≤ CN |Imz|N for any N ≥ 1,
while the symbol of (H1 − H2 ) is in S((hyi + hξi + hζi)−∞ ). By composition calculus, ψ(H1 )
is also a ΨDO with symbol in S((hyi + hξi + hζi)−∞ ). As a consequence, [P, H]ψ(H1 ) has a
symbol in S(hxi−∞ (hyi + hξi + hζi)−∞ ).
The operator φ(H − α) = φ(H − α)ψ(H1 ) also has a symbol in S((hyi + hξi + hζi)−∞ ).
Therefore, [P, φ(H − α)] has a symbol in S(hxi−∞ (hyi + hξi + hζi)−∞ ). Both operators are
thus trace-class by [13, Theorems 9.3&9.4] with traces computed by integrating the symbols
in (x, ξ) or equivalently the Schwartz kernels along the diagonal.
Let us now assume hypothesis (H2). Then, for p > 0,
φ(H − α) = φ(H − α)(I + H1 )p (I + H1 )−p (ψ(H1 ) − ψ(H2 ))
with φ(H − α)(I + H1 )p a bounded operator and by the Helffer-Sjöstrand formula
Z
1
−p
∂¯ψ̃(z − H1 )−1 (I + H1 )−p (H1 − H2 )(z − H2 )−1 dz.
(I + H1 ) (ψ(H1 ) − ψ(H2 )) = −
π C
On the compact support of ∂¯ψ̃, the symbols of (z − Hk )−1 and ∂¯ψ̃ are bounded as described
above and the symbol of (I + H1 )−p (H1 − H2 ) is in S(hyi−∞ (hξi + hζi)2n−sp ). The symbols
of both [P, φ(H − α)] and [P, H]φ(H − α) are therefore in S(hxi−∞ hyi−∞ (hξi + hζi)2n−sp ) for
any p > 0 and since s > 0, [13, Theorems 9.3 & 9.4] apply again.
For α ∈ R and E0 > 0, let ϕ be a smooth switch function in S[0, 1, α − E0 , α + E0 ] and
U (H) = ei2πϕ(H) . We prove the relations in (18) as follows.
Corollary 4.2 Let H as in the preceding proposition with either φ(H) = W (H) = U (H) − I
or φ(H) = ϕ′ (H). Let Gα as in the above proposition with no spectrum in (−∞, E02 ] and such
and either (H1) or (H2) holds.
Then all terms in (18) are defined and equal.
Proof. The above proposition implies that [P, U (H)] and [P, H]ϕ′ (H) are trace-class. The
first equality in (18) is a definition. The last equality (not counting the definition of I[H]) holds
as an application of a Fedosov formula provided that [P, U (H)] is compact; see [3]. The middle
inequality has been shown to hold using a variety of derivations [3, 15, 17, 36]. Following [3],
we recall that the above middle equality holds provided [H, P ]ϕ′ (H) and [P, U (H)]U ∗ (H) are
trace-class.
12

The previous result shows that (18) holds when (H − α)2 is well approximated by some
Gα such that kGα k > E02 . We will find sufficient criteria ensuring either (H1) or (H2) for the
systems (1) and (2). Before doing so, we prove several results showing that the conductivity
σI is stable against changes in P , ϕ′ , and H.
Proposition 4.3 Let Pj for j = 1, 2 be two smooth switch functions in S[0, 1] and ϕj for
j = 1, 2 be two smooth switch functions in S[0, 1, α − E0 , α + E0 ] for α ∈ R and E0 > 0.
Assume that H satisfies the hypotheses of Corollary 4.2. Then we have
σI = Tr i[P1 , H]ϕ′1 (H) = Tr i[P2 , H]ϕ′2 (H).
Proof. Both traces are defined and (18) applies thanks to Corollary 4.2. Since Pj for
j = 1, 2 have the same behavior at infinity, they belong to the same homotopy class of such
functions and we find a continuous family of smooth functions [1, 2] ∋ t 7→ Pt ∈ S[0, 1] with
continuity for instance in the uniform norm. Similarly, we construct [1, 2] ∋ t 7→ ϕt smooth
switch functions in S[0, 1, α − E0 , α + E0 ]. Using (18), we know that 2πσI (t) is the index of
Pt Ut (H)Pt and is therefore an integer for all t ∈ [1, 2]. By construction of Pt , t 7→ Pt Uτ (H)Pt
is continuous in operator norm for any fixed value of τ ∈ [1, 2].
Also, Ut (E) = ei2πϕt (E) is a smooth function of t. This translates, for instance by invoking
the Helffer-Sjöstrand formula (42), into a continuous map t → Ut (H) in operator norm.
As a consequence, t 7→ Pt Ut (H)Pt is continuous in operator norm and the index of these
Fredholm operators is therefore independent of t [30, Chapter 19]. Appealing to (18) concludes
the proof of the proposition.
We now extend the above results to families of operators H = H(t) for t ∈ [0, 1] such
that the invariants in (18) are independent of t. This allows us to include the presence of
perturbations V (x, y) in the Hamiltonian and to vary semiclassical parameters in the next
section. We first recall the following result:
Lemma 4.4 Let A be trace-class operator on L2 (Rn ) and Λ a linear invertible transform in
GL(n, R). Then Λ−1 AΛ is also trace-class and Tr A = Tr Λ−1 AΛ.
The proof is a direct consequence of the cyclicity of the trace. The only such linear transform
we use in this paper is the scaling Y 7→ y = hY for h > 0 so that hDy and µ(y) are pulled back
to DY and µ(hY ). Recall the notation I[H] := IndexP U (H)P . Let H = Opw (a(x, y, ξ, ζ)) and
H̃h = Opw (a(x, hy, ξ, h−1 ζ)). Then the lemma and identities such as U (Λ−1 HΛ) = Λ−1 U (H)Λ
imply that I[H] = I[H̃h ] when either one is defined. What we need is a different equality.
Let Hh = Opw (a(x, y, ξ, hζ)) the semiclassical rescaling (in the variable y). We want to show
that I[Hh ] = I[H]. The above lemma states that I[Hh ] = I[H̃] with H̃ = Opw (a(x, hy, ξ, ζ)).
It thus remains to show that transforming a coefficient µ(y) to µ(hy) does not modify the
invariants in (18). Similarly, let Ht = H + tV . We want to show that I[Ht ] is independent of
t. A sufficient condition is as follows.
Proposition 4.5 Let Ht be as in corollary 4.2 for all t in a connected interval I ⊂ R. Let us
assume that H(t) − H(s) = (t − s)B(s, t) for B(s, t) a bounded operator in uniform norm on
L2 (R2 ; Mn ) uniformly in (s, t) ∈ I 2 . Then I[Ht ] = Index P U (Ht )P is independent of t ∈ I.
Proof. Let Ht be as above and consider the unitary U (Ht ). By the Helffer-Sjöstrand
formula (42), we have
Z
1
∂¯Ũ (z − Ht )−1 (H(t) − H(s))(z − Hs )−1 d2 z.
U (Ht ) − U (Hs ) = W (Ht ) − W (Hs ) = −
π C2
13

By hypothesis, H(t)−H(s) = (t−s)B(t, s) with B(t, s) bounded. Since (z −Ht ) is bounded by
|Imz|−1 uniformly in t (at least locally) and ∂¯Ũ ≤ CN |Imz|N for a well-chosen almost analytic
extension Ũ , we find that U (Ht ) − U (Hs ) is bounded in the operator norm by a constant times
(t − s). This ensures that t 7→ U (Ht ) is continuous in the operator norm and hence so is the
Fredholm operator P U (Ht )P . By continuity of the index of Fredholm operators [30, Chapter
19], the index is independent of t.
The above result addresses the question of stability under perturbation HV = H + V .
Assuming that V is bounded and that the index I[H + tV ] is defined for 0 ≤ t ≤ 1, the above
proposition directly implies that I[H] = I[H + V ]. The above result also allows us to address
stability in the semiclassical regime. Let Hh = H0 + µ(hy) with µ multiplication by a bounded
(matrix-valued) function and h > 0. Let us assume that µ(y) takes constant values for y large
and −y large. Then µ(hy) − µ(ly) = (h − l)yµ′ (h̃y) for h̃ between h and l. By assumption on
µ, yµ′ (h̃y) is bounded and proposition 4.5 applies. We collect the above results as:
Corollary 4.6 Let Hh,t = H0 + µ(hy) + tV be an operator with H0 independent of y, V a
bounded multiplication operator, and µ(y) a smooth domain wall taking constant values outside
of a compact interval. Assume that Hh,t is as in corollary 4.2 for all h0 ≤ h ≤ h1 and 0 ≤ t ≤ 1.
Then the index I[Hh,t ] is an integer independent of h and t in these ranges.
The main difficulty in applying the corollary 4.2 is therefore to show the existence of a
positive definite operator Gα satisfying either (H1) or (H2). If one such operator Gα may
be found for each Hh,t in corollary 4.6, then I[Hh,t] is an integer independent of h and t. It
thus remains to construct such an operator Gα . The construction is reasonably explicit in the
favorable situation when (H2) is satisfied.
Proposition 4.7 Let α ∈ R be fixed and H a self-adjoint unbounded differential operator on
L2 (R2 ; Mn ) such that (I + (H − α)2 )−1 is a ΨDO with symbol in S 0 (m) with m = (hζi + hξi)−s
for s > 0 and such that H −α has constant coefficients when y ≥ R and when y ≤ −R for some
R ≥ 0. Let H± − α be the constant coefficient operators such that (H − α)f± = (H± − α)f±
for any test function f+ supported on y ≥ R and f− supported on y < −R. We assume that
H± − α have a spectral gap [−m, m] for some m > 0. Let now ϕ(H) be a smooth switch
function in S[0, 1, α − m, α + m].
Then there is a differential operator Gα with no spectrum in (−∞, m2 ] and such that
hypothesis (H2) in proposition 4.1 holds. As a consequence, (18) holds.
Proof. By assumption, (I + (H − α)2 )−1 has a (Weyl) symbol with the required decaying
assumption. It remains to construct Gα . Let (φ1 (y), φ2 (y)) be a partition of unity such that
φ21 (y) + φ22 (y) = 1 and such that φ1 (y) is compactly supported and equal to 1 on (−R, R). We
then construct
Gα = φ2 (H − α)2 φ2 + m2 φ21 .

The (Weyl) symbols of (H − α)2 and Gα agree for |y| sufficiently large (outside of the support
of φ1 ). The hypothesis on τα − τ̃α is therefore clear. Moreover, we find that for any function
f ∈ L2 (R2 ; Rn ) that
(f, Gα f ) = (f φ2 , (H − α)2 f φ2 ) + m2 (f φ1 , f φ1 ) ≥ m2 kf k2
since (H − α) is given by (H± − α) on the support of f φ2 and these operator have a spectral
gap in [−m, m]. Here, (·, ·) and k · k are the inner product and norm on L2 (R2 ) ⊗ Cn . This
shows the existence of Gα with the required properties. We deduce from Corollary 4.2 that
(18) holds.
14

It is straightforward to apply the above result to the 2 × 2 system (1) assuming that
m(y) = ±m0 away from a compact domain and −|m0 | < α < |m0 | so that E0 = |m0 | − |α|.
The result also clearly holds with Dy replaced by hDy for any h > 0. It continues to hold if
H is replace by H + V for any compactly supported function V (x, y). Indeed, for any of these
operators, we find that (I + (H − α)2 )−1 has symbol in S((hξi + hζi)−2 ).
The 3 × 3 system in (2) is more challenging. The reason is the presence of the flat band
E0 (ξ) = 0 observed when f is constant. There is therefore no reason for (I + (H − α)2 )−1 to
be a negative-order ΨDO. Only when the coefficients are sufficiently slowly varying can one
expect to leverage the presence of a spectral gap.
The construction of Gα under hypothesis (H1) is done microlocally and proceeds as follows.
Proposition 4.8 Let H = Opw (σ(x, y, ξ, ζ)) be a differential operator and assume that for
some α > 0, (H − α)2 = Opw (τα (x, y, ξ, ζ)) is such that as a symmetric matrix, τα (x, y, ξ, ζ) ≥
E02 > 0 uniformly in |(y, ξ, ζ)| ≥ R for some R > 0 and in x ∈ R.
Then for any δ > 0, there exists Gα = Opw (τ̃α (x, y, ξ, ζ)) with τ̃α (x, y, ξ, ζ) ≥ (E0 − δ)2
uniformly in (x, y, ξ, ζ) and τ̃α = τα when |(y, ξ, ζ)| ≥ R.
Let h > 0 and define Hh = Opw (σ(x, y, hξ, hζ)) as well as Gh,α = Opw (τ̃α (x, y, hξ, hζ)).
Then there is h0 > 0 (sufficiently small) and a constant C independent of 0 < h ≤ h0 such that
τ̃α (x, y, hξ, hζ) = τα (x, y, hξ, hζ) when |(y, ξ, ζ)| ≥ R/h and Gh,α ≥ F 2 := (E0 −δ −Ch0 )2 > 0.
Let ϕ ∈ S[0, 1, α − F, α + F ] and define H̃h = Opw (σ(hx, hy, ξ, ζ)) for 0 < h ≤ h0 . Then
hypothesis (H1) in Proposition (4.1) holds for Hh and Lemma 4.4 implies that (18) holds for
H replaced by H̃h .
This result thus states that (18) holds for Hamiltonians H̃h = Opw (σ(hx, hy, ξ, ζ)) with spatial
coefficients of the form c(hx, hy) for h sufficiently small.
Proof. By hypothesis, we can construct a matrix-valued symbol τ̃α = τα ≥ E02 when
|(y, ξ, ζ)| ≥ R. This symbol can then be extended to R4 smoothly such that τ̃α ≥ (E0 −δ)2 . The
positivity of the symbol is not sufficient to ensure that the operator Gα = Opw (τ̃α (x, y, ξ, ζ))
itself is positive. Replacing H by Hh , with (Hh − α)2 = Opw (τα (x, y, hξ, hζ)), we observe that
τ̃α (x, y, hξ, hζ) = τα (x, y, hξ, hζ) when |(y, hξ, hζ)| ≥ R and hence certainly when |(y, ξ, ζ)| ≥
R/h. Moreover, we still have that τ̃α (x, y, hξ, hζ) ≥ (E0 − δ)2 . The Gårding inequality (41)
allows us to conclude that Gh,α ≥ (E0 − δ − Ch)2 and hence is bounded below by a positive
constant when h is sufficiently small.
We therefore obtain that (H1) in Proposition 4.1 holds for Hh and hence that the index
I[Opw (σ(x, y, hξ, hζ))] is defined by corollary 4.2. We now invoke Lemma 4.4 to observe that
I[Opw (σ(x, y, hξ, hζ))] = I[Opw (σ(hx, hy, ξ, ζ))], which proves that (18) holds for H replaced
by H̃h .
In the remainder of this section, we apply the above result to the system (2)
H = Dx γ1 + Dy γ4 − f (y)γ7 + V (x, y)

(19)

with f (y) a smooth switching function in S[−f0 , f0 ] and h > 0. We assume that V (x, y) is
multiplication by a smooth compactly supported function (still called V (x, y)). Let τα be the
symbol of (H −α)2 for α ∈ (−f0 , 0|)∪(0, f0 ). Hα has a bulk gap given by E0 = min(|α|, f0 −|α|).
Our objective is to find constraints on f and V such that the matrix τα (x, y, ξ, ζ) is bounded
uniformly below by a positive constant when |(y, ξ, ζ)| ≥ R. The construction of the operator
Gα then proceeds as in the above proposition.
Let (y, ξ, ζ) = ρ(y0 , ξ0 , ζ0 ) with |(y0 , ξ0 , ζ0 )| = 1 and the scaling factor ρ ∈ R+ . Consider
2
|y0 | ≥ 21 first. Then for ρ sufficiently large, the symbol of (Hh,V − α)2 becomes constant with
eigenvalues bounded below by min(|α|, f0 − |α|) as expected.
15

The region |y0 |2 ≤ 21 is more challenging. We have (ξ, ζ) → ∞ as ρ → ∞ in that sector.
However, only two out of three eigenvalues of the symbol of (H − α)2 are bounded below now.
The third eigenvalue remains bounded and large fluctuations in V (x, y) or f (y) may force it
to vanish or become arbitrarily small. In such a case, we cannot construct a positive definite
approximation of (H − α)2 . Constraints on V and f thus need to be imposed. The Hermitian
operator (H − α)2 is given explicitly by


2 + δ δ∗ + δ δ∗ W δ + δ W + δ g∗ W δ + δ g + δ W
W11
11 x
x 22
y
11 y
x
y 33
y y
x x


2 + |g|2
δx∗ δy + W22 g + gW33  ,
∗
δx∗ δx + W22

2
∗
∗
δy∗ δy + |g|2 + W33

where we have defined W = V − α for V = (Vi,j )1≤i,j≤3 , δx = Dx + V12 , δy = Dy + V13 , and
g = ifh + V23 . The full Weyl symbol of (H − α)2 is obtained by using identities implying that
the symbol of Dy g(y) is ζg(y) − 2i ∂y g(y) and that of g(y)Dy is ζg(y) + 2i ∂y g(y). We wish to
show that the eigenvalues λ1,2,3 of the above symbol are positive independently of the scaling
factor ρ ≥ R for (y, ξ, ζ) = ρ(y0 , ξ0 , ζ0 ) and |(ξ0 , ζ0 )|2 ≥ 12 .
Let us assume that V12 and V13 are real-valued and V23 is purely imaginary. Assuming
constant coefficients (independent of (x, y)), the symbol of (H − α)2 is the square of


W1 ξ̃
ζ̃
 ˜

 ξ W2 g  ,
ζ̃ −g W3
where ξ̃ and ζ̃ are the symbols of δx and δy , respectively, and Wj stands for Wjj . Therefore,
|(ξ̃, ζ̃)| → ∞ as ρ → ∞. The invariants of the above matrix satisfy
X
λ1 λ2 λ3 = −W3 ξ̃ 2 − W2 ζ̃ 2 + O(1),
λi λj = −(ξ̃ 2 + ζ̃ 2 ) + O(1), λ1 + λ2 + λ3 = O(1),
i6=j

where O(1) means independent of ρ. This implies that two eigenvalues are asymptotically equal
2
2
2ζ
. When V22 = V33 = 0,
to ±ρ while the third eigenvalue is asymptotically given by W3 ξ ρ+W
2
the latter term equals −α 6= 0. In order for that term not to vanish, we need V22 and V33 to be
sufficiently small compared to α. Large variations in V22 and V33 prevent the approximation
of (H − α)2 by a positive definite operator. Note that we do not have any constraint on V11 .
Similar calculations show that the imaginary part of V12 and V13 and the real part of V23 also
need to be small for the above eigenvalues to remain bounded away from 0.
The full symbol of (H − α)2 is given by the square of the above matrix plus contributions
coming from differentiations of the coefficient such as ∂x,y g or ∂x,y Vi,j . For instance, the term
∂y g, which involves f ′ (y), modifies the determinant and the sum of squares of eigenvalues by
a quantity of order (ξ 2 + ζ 2 )ζ 2 , which is leading-order in ρ4 . Such terms have to be sufficiently
small for the symbol of (H − α)2 to have positive eigenvalues uniformly.
Let ε > 0 and assume the coefficients in (19) are of the form f := f (εy) scalar-valued and
V := V (εy) Hermitian-valued. Let σε be the Weyl symbol of H = Opw (σε ). We introduce the
following hypothesis:
(H3 × 3): The coefficients V22 , V33 , ImV12 , ImV13 and ReV23 are sufficient small in S(1) and ε
is sufficiently small.
Under (H3 × 3), the above calculations show that the symbol of (H + V − α)2 has eigenvalues
bounded away from 0 uniformly in |(y, ξ, ζ)| > R for R sufficiently large. Therefore, H =
Opw (σε ) satisfies the hypotheses of Proposition 4.8. Let F = E0 − δ for δ > 0 and consider
16

a density of states built on ϕ ∈ S[0, 1, α − F, α + F ]. Then Proposition 4.8 implies that
(18) holds provided that ε is further reduced to h0 ε. Relabeling ε the small term εh0 , we thus
deduce that (18) holds for any Hamiltonian Hε = Dx γ1 + Dy γ4 − f (εy)γ7 + V (εx, εy) satisfying
(H3 × 3).
This shows in particular that the interface conductivity in (18) is well defined provided
that f (y) is a sufficiently slowly varying domain wall. We saw in section 2 that (18) also held
for f (y) = f0 sign(y). However, this result came from a sufficiently explicit knowledge of the
spectral decomposition of H[µ(y)]. The result we just established applies to any smooth f (y)
that has sufficiently slow variations.
Numerical simulations in [37] show that the value of σI is indeed quite stable against
smooth perturbations in V11 , V12 , V13 and ImV23 while even small variations in the other
components of V rapidly destabilize it.

4.2

Fedosov-Hörmander formula and Bulk-Interface correspondence

This section presents a general bulk-interface correspondence for the family of differential
operators
Hh = Dx γ1 + γ2 (hDy , y)
(20)
for γ1 a Hermitian matrix in M(Cn ) and γ2 (Dy , y) a differential operator taking values in
M(Cn ). We also define HV = Hh + V a perturbed operator. We set H := H1 . In the
applications considered in this paper, γ2 (hDy , y) = hDy γ2 + µ(y)γ3 but the specific structure
is not important so long as (h2) below holds. This class of models finds applications outside of
the systems considered here, for instance for the n−replica models that appear in the analysis
of Floquet topological insulators [5]. Generalizations to a larger class of models mixing the x
and y derivatives and involving higher-order derivatives are worked out in [37].
We assume that (18) applies uniformly in 0 < h ≤ 1 and that all traces involved there
are computable as integrals along of the diagonal of the Schwartz kernel of the trace-class
operators. This holds thanks to Proposition 4.7 for the system (1) and thanks to Proposition
4.8 for the system (2) provided that µ(y) = f (εy) with ε sufficiently small. The preceding
section also indicated which perturbations V were allowed for the two systems (1) and (2).
Let α ∈ R fixed. Assuming α is in a bulk band-gap, we assigned two invariants so far.
One is the conductivity σI in (18). The other one is the bulk-difference invariant Wα and its
relation to Chern numbers in (17). We now introduce a third invariant as the index of the
operator Hh − α − iν(x) for well-chosen domain walls ν(x). The objective of the bulk-interface
correspondence is to show that these invariants are all equal and different calculations of the
same topological charge.
0
The operator Hh = Opw
h (σ) with S (m) ∋ σ = ξγ1 + γ2 (ζ, y) for the order m that makes
Hh self-adjoint as an unbounded operator on L2 (R2 ) ⊗ Cn . We define Hh [ξ] in (5) as the
Fourier transform x → ξ of Hh , which is invariant by translation along the x axis. We collect
our assumptions as follows:

(h1) 2πσI is an integer independent of 0 < h ≤ 1 and i[Hh , P ]ϕ′ (Hh ) is a trace-class operator
with trace given by the diagonal integral of its Schwartz kernel. Here, ϕ is a smooth switch
function in S[0, 1, α − E0 , α + E0 ] for α ∈ R and E0 > 0 and P is a multiplication operator by
a smooth function χ in S[0, 1, x0 − β, x0 + β] for β > 0. Then [Hh , P ] = −iχ′ (x)γ1 with χ′ (x)
compactly supported.
(h2) Let z = α + iω and σz (y, ζ; ξ) be the semiclassical symbol of z − Hh [ξ] = Oph (σz ) in
the variables (y, ζ) with (α, ω, ξ) seen as parameters. Let σα (ω, y, ξ, ζ) = σα+iω (y, ζ; ξ) be the

17

Weyl symbol at h = 1 of α + iω − H. We assume that σα is invertible and σα−1 dω,y,ξ,ζ σα is
uniformly bounded (one-form with bounded coefficients) for ω 2 + y 2 + ξ 2 + ζ 2 ≥ R2 sufficiently
large. Finally, we assume that σα−1 dω,y,ξ,ζ σα → 0 as |ζ| → ∞.
Remark 4.9 (i) Condition (h1) corresponds to what was proved in section 4.1. Condition
(h2) is very similar to what is necessary to construct bulk-difference invariants. Indeed by the
same diagonalization as in (10), we find
σα = α + ix −

n
X

hj (ξ, y, ζ)Πi (ξ, y, ζ),

σα−1

n
X
(α + ix − hj (ξ, y, ζ))−1 Πi (ξ, y, ζ)
=
j=1

j=1

where we see that σα is invertible if all α + ix − hj (ξ, y, ζ) 6= 0 for (x, ξ, y, ζ) outside of a
compact set. The case x = 0 implies that α lives within the bulk gap of the system.
(ii) In this paper, we considered two forms of mass terms µ(y): either bounded domain
walls or λy. The same applies to the confining term x above, which may be replaced by any
domain wall ν(x) ∈ S[−|α| − δ, |α| + δ] for δ > 0 or a term of the form ν(x) = |α| arctan x
with a gap sufficiently large to include the energy level α. The above invertibility condition
then takes the form α + iν(x) − hj (ξ, y, ζ) 6= 0 outside of a compact set.
(iii) Let ν(x)
p = x or ν(x) ∈ S[−|α| − δ, |α| + δ] for δ > 0. For system (1), condition (h1) is
α + iν(x) 6= ± ξ 2 + ζ 2 + m2 (y). For m(y) ∈ S[−|m0 |, |m0 |], this condition is satisfied when
|α| < |m0 | (but not for |α| > |m0 |). For the geophysical system (2), the same conditions hold
with m(y) replaced by f (y) with the additional constraint in (h1) that α + iν(x) 6= 0, i.e, α 6= 0
when ν(x) = 0. We verify that these conditions are satisfied for α in a bulk band gap, i.e.,
α ∈ (−|f0 |, 0) ∪ (0, |f0 |) for smooth f (y) ∈ S[−f0 , f0 ] and α 6= 0 for f (y) = λy, λ 6= 0.
While the main objective of the bulk interface correspondence in Theorem 4.11 below is to
relate the interface conductivity σI to the bulk-difference invariant Wα , it turns out that both
invariants are connected by a third one, a Fredholm operator naturally related to Hh whose
index captures the topological charge. The Fredholm operator is
Fh = Hh − α − iν(x)

(21)

as alluded to in the above remark with some choices for ν(x) given there. We set F := F1 .
We assume ν(x) bounded to simplify the presentation and define Fh as an unbounded
operator from D(H) to L2 (R2 ) ⊗ Cn where the domain of Hh (which makes it self-adjoint as
an unbounded operator on L2 (R2 ) ⊗ Cn ) is independent of h. There is in fact no reason for
any operator of the form (21) to be Fredholm, that is an operator that admits left and right
inverses modulo compact operators. In the preceding section, we introduced two hypotheses
(H1) and (H2) on the symbol of H. We state corresponding hypotheses on that of Fh when
ν(x) ∈ S[−δ − |α|, |α|+ δ] to simplify; similar results hold for ν(x) = x and unbounded domain
walls µ(y) after appropriate changes of the domain D(F ), which we do not consider here in
detail. Note that we can always choose ν ∈ S[−δ − |α|, |α| + δ] such that ν(x) = x for |x| ≤ R
so that the Weyl symbol of Fh is given by −σα (x, y, ξ, ζ) defined in (h2) when restricted to
the vicinity of the sphere x2 + y 2 + ξ 2 + ζ 2 = R2 . Only those values appear in the FedosovHörmander formula (22) below. The hypotheses are:
(H1’) Let Fh be as in (21) and assume that (h2) holds for 0 < h ≤ h0 .

(H2’) Let m = (1 + ξ 2 + ζ 2 )−s for s > 0. Assume (I + F ∗ F )−1 = Opw (a) with a ∈ S(m) and
(h2) holds.
Hypothesis (h2) may be seen as an ellipticity condition at infinity. In the favorable case (H2’)
18

of a regularizing operator, then (h2) is sufficient to obtain a Fredholm operator. For systems
such as (2), where regularization does not occur for all components, a smallness condition in
(H1’) is necessary to ensure the Fredholm structure, in parallel to (H1) in section 4.1.
Proposition 4.10 Let Fh be the differential operator defined in (21). Let us assume that:
either (H1’) holds with h0 sufficiently small; or (H2’) holds. Then Fh is a Fredholm operator
from D(H) to L2 (R2 ) ⊗ Cn .
Proof. Assume (H2’). By assumptions, the differential operator F ∗ F is a constantcoefficient operator outside of a compact domain Ω, which is invertible. Let G = F ∗ F +χ2 (x, y)
with χ2 ∈ C0∞ (R2 ) with χ2 = 1 on Ω. Then G is positive definite and hence invertible with
G−1 ∈ S(m) by assumption. We thus have G−1 F ∗ F = I + G−1 χ2 and we find that G−1 χ2
is compact since χ2 is compactly supported in space and G−1 is smoothing. We have thus
constructed a left inverse up to a compact operator. We can similarly construct a right inverse
and conclude that F is Fredholm [30, Corollary 19.1.9].
Let us now consider the case (H1’). We can no longer invoke a compactness argument alone
and thus need a smallness condition to obtain the Fredholm property. Let Fh = Opw
h (f ). Let
χ + ψ = 1 with ψ(x, y, ξ, ζ) ∈ C0∞ (R4 ) compactly supported and equal to 1 on a sufficiently
large domain that g = χf −1 ∈ S(m−1 ) is defined. Let G = Opw
h (g). By semiclassical calculus
w
w
[13, Chapters 7&8], we find that GF = Oph (χ) + hOph (rh ) with rh ∈ S 0 (1). Therefore, for
w
w
−1
0 ≤ h ≤ h0 , I + hOpw
h (rh ) is invertible and (I + hOph (rh )) GF = I − Oph (ψ). However,
w
Oph (ψ) is a compact operator so that F admits a left inverse up to a compact perturbation.
We construct a right-inverse similarly and conclude that Fh is Fredholm for 0 < h ≤ h0 .
It remains to show that (H1’) applies to (2) when the coefficients (including appropriate
perturbations V ) vary sufficiently slowly and that (H2’) applies to (1). This is done along the
lines of the derivation in the preceding section. We leave the details to the reader. That F
is a Fredholm operator extends to unbounded domain walls as in [30, Chapter 19] as well as
operators with coefficients whose derivatives vanish at infinity; see for instance [26].
After these preliminary results and hypotheses, we state the main result of this section:
Theorem 4.11 (Bulk-interface correspondence.) Let H be given by (20) with h = 1.
Assume (h1)-(h2) above for α ∈ R. Then
Z
1
tr(σα−1 dσα )∧3 = Index(F ),
(22)
2πσI = Wα =
24π 2 Σ

where Σ = {(ω, y, ξ, ζ) ∈ R4 ; ω 2 + y 2 + ξ 2 + ζ 2 = R2 } with the orientation on R4 given by
dω ∧ dξ ∧ dy ∧ dζ > 0.
We recall that σI is the interface invariant while Wα is the bulk-difference invariant. The last
index is the L2 −index of the unbounded Fredholm operator F = H − α − iν(x) on L2 (R2 )⊗ Cn
with (Weyl) symbol at h = 1 given by −σα (ν(x), y, ξ, ω). The invariance properties of the
integral in (28) show that it takes the same values for σα (ν(x), y, ξ, ω) and σα (x, y, ξ, ω) [30,
Chapter 19.3].
The rest of this section is devoted to a proof of this result and some corollaries. We will
first need properties of the symbol of (semiclassical) resolvents, which we summarize as follows.
Lemma 4.12 Let Hh = Oph (a) with a ∈ S 0 (m). Let z = λ + iω ∈ C with ω 6= 0. Then
(z − Hh )−1 is a bounded operator and there exists an analytic function z → rz = rz (y, ζ; h)
such that (z − Hh )−1 = Oph (rz ). The coefficient rz ∈ S 0 (1) satisfies
3

|rz | ≤ C|ω|−1 max(1, h 2 |ω|−3 )
for a constant C independent of z ∈ Z ⊂ C a compact set and 0 < h ≤ 1.
19

Proof. We follow [13, Chapters 7&8] and [7] for the extension to matrix-valued operators.
z − Hh = Oph (z − a) with ω 6= 0 so that z − a invertible. The Beals’ criterion applied in
[13, (8.10)] shows that (z − Hh )−1 = Oph (rz ) for rz ∈ S 0 (1). This bound is uniform on any
compact domain away from ω = 0. [13, Proposition 8.6] shows that |r| is bounded by the
2d+1
maximum of |ω|−1 and h 2 |ω|−(2d+2) where dimension d = 1 in our applications. Finally, rz
may be written as an appropriate transform of the Schwartz kernel of (z − Hh )−1 [13, Chapters
¯ − Hh )−1 = 0. This implies the analyticity of z → rz on Z.
7], which is analytic since ∂(z
The above lemma is applied to the operator Hh [ξ]. For C ∋ z = λ + iω with ω 6= 0, we
define rz such that
(z − Hh [ξ])−1 = Oph (rz )
(23)

with rz = rz (y, ζ; ξ; h) ∈ S 0 (1) (uniformly in ξ) a symbol in the variables (y, ζ) with (z, ξ) as
parameters.
The bulk of the proof of the above theorem is to relate 2πσI to the symbols σz and σα as
follows.
Proposition 4.13 Under hypotheses (h1)-(h2), we have
Z
i
2πσI = 2
εijk tr(σα−1 ∂i σα σz−1 ∂j σα σα−1 νk )dωdΣ,
lim
8π M1,2,3 →∞ R×∂R

(24)

where the variables labeled 1, 2, 3 are identified with ξ, ζ, y; νQ
k is the kth component of the
outward unit normal to the boundary of the rectangle R = 3l=1 (−Ml , Ml ); and dΣ is the
Euclidean measure on that boundary. Also, εijk is the totally antisymmetric tensor such that
ε111 = 1.
By hypothesis (h2), the matrix σα−1 is indeed defined when the coefficients Mα are sufficiently large. The above result shows that the conductivity, and hence all quantities appearing
in (18) may be written in terms of the symbol −σα of H − α − iω.
Proof. Recall that [Hh , P ] = −iχ′ (x)γ1 . By hypothesis (h1), traces may be computed as
(Lebesgue) integrals along diagonals. Integrating in x and denoting by Try the matrix trace
and integration of the Schwartz kernel along the diagonal in the variable y, we have (by Fubini)
Z
′
′
2πσI = 2πTrχ (x)γ1 ϕ (Hh ) = 2π Try χ′ (x)γ1 (ϕ′ (Hh ))(x, x)dx.
R

Since ϕ′ (Hh ) is invariant by translation, then ϕ′ (Hh )(x, x) = ϕ′ (Hh )(0, 0) and up to 2π equals
the integral over the dual variable ξ so that (dropping y in Tr ≡ Try moving forward),
Z
Z
′
Trγ1 ϕ′ (Hh [ξ])dξ.
2πσI = Tr γ1 ϕ (Hh [ξ])dξ =
R

R

Note that γ1 = ∂ξ Hh [ξ] and the above integrand is formally given by ∂ξ ϕ(Hh [ξ])dξ = dϕ(Hh [ξ])
so that 2πσI depends only on the behavior of Hh [ξ] for |ξ| large. However, ϕ, unlike ϕ′ , is not
compactly supported and the above expression is more suitable for the sequel.
We now use the Helffer-Sjöstrand formula and an almost analytic extension ϕe′ (z) of ϕ′ (λ)
to write ϕ′ (Hh [ξ]) as a superposition of resolvent operators of Hh [ξ]; see (42) and [11, 13]
Z
Z
−1
−1
−1 2
′
¯
e
∂¯ϕe′ (z)γ1 Oph (rz )d2 zdξ.
γ1 ∂ ϕ (z)(z − Hh [ξ]) d zdξ =
Tr
2πσI = Tr
π C×R
π
C×R

Here, d2 z = dλdω for z = λ + iω and ∂¯ = 12 ∂λ + 2i ∂ω . The resolvent has a semiclassical symbol
rz ∈ S 0 (1) defined in (23) with properties collected in Lemma 4.12. The above may also be
20


R
R
2
¯ e′
recast by Fubini, using hypothesis (h1), as −1
π R Tr Oph
C ∂ ϕ (z)γ1 rz d z dξ. We thus apply
[13, Theorem 9.4] to write the trace, which may be written as an integral of its Schwartz
kernel, or equivalently for a semi-classical operator in terms of its symbol as:
Z
−1
∂¯ϕe′ (z) tr γ1 rz (y, ζ; ξ; h)d2 zdR.
(25)
2πσI = 2
2π h C×R3

Here, tr is matrix trace and dR := dydζdξ.
By construction of the almost analytic extension ϕe′ (z), the above integration in z is performed over a bounded domain Z. Moreover, since |rz | is bounded by C|ω|−4 uniformly in h,
which is compensated by |∂¯ϕ̃′ (z)| ≤ C|ω|4 , then for each 0 < ε → 0, we find 0 ≤ δ = δ(ε) → 0
such that the above integral over |ω| ≤ δ is bounded by ε uniformly in 0 < h. Let us call
Zδ = Z ∩ {|ω| ≥ δ}. We wish to estimate
Z
−1
Iδ = 2
∂¯ϕe′ (z) trγ1 rz (y, ζ; ξ; h)d2 zdR.
2π h Zδ ×R3
The advantage of the above truncation is that rz ∈ S 0 (1) uniformly in z ∈ Zδ now since δ
is independent of h. The function z → rz is analytic away from ω = 0 so that ∂λ r + i∂ω r = 0.
Moreover rz → 0 as |ω| → ∞ since k(z − Hh [ξ])k−1 ≤ |ω|−1 . We can therefore write for ω > 0
Z ∞
Z ∞
∂λ rz+it dt.
∂ω rz+it dt = −i
r(z) = −
0

0

The domain ω < 0 is treated similarly by observing that r(z̄) = r̄(z). We now focus on
∂λ rz (y, ζ; ξ; h) for |ω| ≥ δ. Since rz+it ∈ S 0 (1) uniformly, this allows us to obtain asymptotic
expansions in h that hold uniformly in |ω| ≥ δ. We then perform an integration in (ξ, y, ζ) to
display the topological properties of the resolvent and obtain a function that no longer has any
singularity at ω = 0 thanks to the assumption that σα is invertible outside of a large sphere
in (ω, y, ξ, ζ).
By analyticity, ∂λ rz = ∂z rz . We wish to perform an expansion of the integral in (ξ, y, ζ)
of γ1 ∂λ rz . At the operator level, we find ∂z (z − Hh )−1 = −(z − Hh )−2 , which at the level
of symbols translates into ∂λ rz = −rz ♯h rz . We also deduce from γ1 = ∂ξ Hh [ξ] that ∂ξ (z −
Hh )−1 = (z − Hh )−1 ∂ξ Hh (z − Hh )−1 = (z − Hh )−1 γ1 (z − Hh )−1 that at the level of symbols,
∂ξ rz = rh ♯h γ1 rz .
We thus find
γ1 ∂λ rz = −γ1 rz ♯h rz + rz ♯h γ1 rz − ∂ξ rz .
Q
Let us introduce the rectangle R = 3l=1 (−Ml , Ml ) where we identify the variables (1, 2, 3)
with (ξ, ζ, y). Integrals such as Iδ above are seen as the limit as R → ∞ with the meaning
that Ml → ∞ for each l = 1, 2, 3. We are therefore interested in the quantity for ω > 0
Z
Z
1
1
trγ1 ∂λ rz dR =
tr[−γ1 rz ♯h rz + rz ♯h γ1 rz − ∂ξ rz ]dR.
ΦR (z) :=
h R
h R
We want to show that the above trace is asymptotically in divergence form and thus an integral
over ∂R. For two symbols a and b, we find [13, 44]
a♯h b = ab +

h
{a, b} + O(h2 )
2i

with {a, b} = ∂ζ a∂y b − ∂y a∂ζ b. By cyclicity of the trace, trab = trba and tr{a, b} = −tr{b, a}
so that tra♯h b − trb♯h a = −ihtr{a, b} + O(h2 ). Here and below, all terms O(hk ) are so in the
sense of S 0 (1) symbols [13]. This implies
−γ1 rz ♯h rz + rz ♯h γ1 rz = ihtr{γ1 rz , rz } + O(h2 ).
21

The integral Iδ involves a factor h−1 so that only itr{γ1 rz , rz } survives in the limit h → 0. It
thus remains to integrate tr[ih{γ1 rz , rz } − ∂ξ rz ] over R.
We now verify that 2{a, b} = ∂ζ (a∂y b − ∂y ab) − ∂y (a∂ζ b − ∂ζ ab) in divergence form in these
variables. We thus find that
tr{γ1 rz , rz } = ∂y ãy − ∂ζ ãζ ,

ãτ =

1
[γ1 rz , ∂τ rz ],
2

τ = y, ζ.

This means that the integral of tr[ih{γ1 rz , rz } − ∂ξ rz ] over R may be written as
Z
1
ΦR (z) = tr
[ih(ãy νy − ãζ νζ ) + rz νξ ]dΣ + O(h),
h
∂R
with ντ the τ th component of the normal unit vector to R at the boundary and dΣ the surface
measure there. Provided that Ml are large enough, σz−1 is then defined by assumption (h2) for
all λ sufficiently close to α by continuity. That only values of λ close to α are in Z is ensured
by possibly shrinking the support of ϕ′ and replacing it by ϕ′ρ (λ) = ρ1 ϕ′ ( ρ1 (λ − α) + α). We
know from Proposition 4.3 that σI is independent of 0 < ρ ≤ 1.
The inverse σz−1 now exists uniformly in ω, even |ω| ≤ δ, still by assumption. This allows
w
us to approximate rz using Opw
h (rz )Oph (σz ) = I so that I = rz ♯h σz . By semiclassical calculus
of Weyl operators this implies that
I = rz σz +

h
{rz , σz } + O(h2 ).
2i

From this, we deduce that in the S 0 (1) sense
rz = σz−1 +

ih
ih
{rz , σz }σz−1 + O(h2 ) = σz−1 + {σz−1 , σz }σz−1 + O(h2 ).
2
2

(26)

To leading order, we may therefore replace rz by σz−1 in the terms ãτ above, defining the
corresponding terms aτ and obtain
Z
i
1
[i(ay νy − aζ νζ ) + {σz−1 , σz }σz−1 νξ + σz−1 νξ ]dΣ + O(h).
ΦR (z) = tr
2
h
∂R
We now write, using that γ1 = −∂ξ σz is a constant matrix,
2tr{σz−1 , γ1 σz−1 } = tr[∂ζ ([∂y σz−1 , ∂ξ σz ]σz−1 ) − ∂y ([∂ζ σz−1 , ∂ξ σz ]σz−1 )].
The last term equals ∂y ([∂ξ σz−1 , ∂ζ σz ]σz−1 ). We also use the identity ∂i σz−1 = −σz−1 ∂i σz σz−1 to
find eventually that
Z
1
i
[εijk σz−1 ∂i σz σz−1 ∂j σz σz−1 νk + σz−1 νξ ]dΣ + O(h).
ΦR (z) = tr
2
h
∂R
We thus obtain that
ΨR (z) :=
=

Z ∞
Z
1
ΦR (z + it)dt
γ1 rz dR = −i
tr
hZ R
0
1
1 −1
−1
−1
−1
[εijk σz+it
∂i σz+it σz+it
∂j σz+it σz+it
νk + σz+it
νξ ]dΣdt.
2 ∂R×[0,∞)
h

We have Iδ = limR→∞ Iδ,R with
Iδ,R =

−1
2π 2

Z

Zδ

∂¯ϕe′ (z)ΨR (z)dz.

22

This integral is close to an integer as δ → 0 and R → ∞ since 2πσI is known to be an integer.
The term proportional to h−1 in ΨR (z) must therefore (exactly) vanish. We still call ΨR (z)
the term without his component. Since ΨR (z) is a smooth function in z close to α even when
ω is small, then up to an error of order ε,
Z
−1
∂¯ϕe′ (z)ΨR (z)dz + o(1).
Iδ,R = 2
2π Z
Since all terms involved (from the beginning) are analytic in z, then so is ΨR (z) away from
the real axis ω = 0. Let Z = Z+ ∪ Z− , where Z± = Z ∩ {±ω > 0}. Using ∂¯ϕe′ (z)ΨR (z) =
¯ ϕe′ (z)ΨR (z)), we have by the Stokes formula
∂(
Z
Z
−i
2
′
¯
e
∂ ϕ (z)ΨR (z)d z =
ϕe′ (z)ΨR (z)dz,
2
Z±
∂Z±

where dz = ±dλ on the part of ∂Z± on the real axis, ϕe′ (z) = ϕ′ (λ) while ΨR (z) is defined as
the limit from ω > 0 while ΨR (z̄) = Ψ̄R (z) for ω < 0. Overall, we therefore find
Z
i
o(1) + IR = 2
ϕ′ (λ)[ΨR (λ + i0) − Ψ̄R (λ − i0)]dλ.
4π R

Each of the ΨR terms is an integral over a half line in ω while the difference involves a line
integral in ω.
As mentioned earlier, this term is independent of ϕ′ρ (λ) = 1ρ ϕ′ ( ρ1 (λ−α)+α). As ρ to 0, and
R
using the smoothness of λ 7→ ΨR (λ + i0), we evaluate the above at λ = α with R ϕ′ρ (λ)dλ = 1
to deduce in the limit R → ∞ the equality of integers:
Z
i
tr[εijk σα−1 ∂i σα σα−1 ∂j σα σα−1 νk ]dΣdω.
2πσI = lim
R→∞ 8π 2 ∂R×R
This concludes the proof of the proposition.
We now deduce several corollaries from the preceding result. The most natural result is
the following relation between the interface conductivity and the Fedosov-Hörmander formula
for the index of the operator iω − H.
Corollary 4.14 (Spectral flow Index) Let Σ be a surface in the variables (ξ, ζ, y, ω) such
that σα−1 is defined on and outside of the surface. Then
Z
1
tr(σα−1 dσα )∧3 .
(27)
2πσI =
24π 2 Σ
Here and below, the orientation of R4 is dξ ∧ dζ ∧ dy ∧ dω = dω ∧ dξ ∧ dy ∧ dζ > 0.
Corollary 4.15 (Bulk Interface Correspondence) We find that
Z
X
i
−1
−1
−1 y
2πσI = lim
dξdζdω
=
−W
=
tr[σ
∂
σ
,
σ
∂
σ
]σ
ci .
α
α
α
ξ
ζ
α
α
α
−y
y→∞ 8π 2 R3

(28)

hi <α

This is the bulk-interface correspondence, stating that the interface conductivity equals the
bulk-difference invariant. We use the notation X|y−y = X(y) − X(−y). We also have the
relation to the spectral asymmetry:
Corollary 4.16 (Spectral Asymmetry) Let us assume that the 3−form tr(σα−1 dσα )∧3 integrated over bounded domain in (ω, ξ, ζ) at fixed values of y converges to 0 as |y| → ∞. Then
we find that:
Z
i
ξ
(29)
tr[σα−1 ∂ζ σα , σα−1 ∂y σα ]σα−1 −ξ dydζdω.
2πσI = lim
2
ξ→∞ 8π
R3
23

This is the three-dimensional winding number of the Green’s function used in [19, 43].
Proof. We first note that i = ∂ω σα with σα = σα (ω, y, ξ, ζ). The result of Proposition 4.13
states that σI is up to a constant the limit as R → ∞ of the integral of tr(σα−1 dσα )3 over the
cylinder R × R. A direct calculation (as in the proof of the index theorem in [30, Chapter
19.3]) shows that
tr(σα−1 dσα )4 = 0,
which implies that tr(σα−1 dσα )3 is a closed form.
Note that the latter form equals 3 times the form written using commutators as in the
proposition; this explains the factor 24 = 8 × 3 in the first corollary. For Mi sufficiently
large,
Q
let Ω be the volume with disconnected boundary terms Σ and ∂R4 , where R4 = 4l=1 (−Ml , Ml )
this time also including the fourth variable identified with ω. Then the Stokes theorem implies
that the integral of tr(σα−1 dσα )3 over Σ and that over ∂R4 (with the same orientation) are
equal.
To prove Corollary
Q3 4.15, we need to approximate the integral over the cylinder Rω ×
∂R3 where R3 Q
= l=1 (−Ml , Ml ) by an integral over the boundary of a four-dimensional
rectangle R4 = 4l=1 (−Ml , Ml ). This means that, as M4 = Mω → ∞, we want the integral of
(σα−1 dξ,ζ,y σα )∧3 over the rectangle R3 for a fixed value ω0 of ω to be small as ω0 → ∞. From
(h2), σα−1 dσα is bounded (uniformly as a matrix-valued one form) and ∂ξ σα = −γ1 bounded
while σα−1 goes to 0 (uniformly in (y, ξ, ζ) as a N × N matrix) as ω0 → ∞. Passing to the
limit in R → ∞ gives the spectral flow index in Corollary 4.15.
Note that the above derivation shows that the limit as R → ∞ is replaced by the integral
of the trace of the matrix-valued three-form over any closed (three-dimensional) surface Σ.
The other corollaries are obtained similarly by appropriately deforming Σ to two surfaces
since tr(σα−1 dσα )3 is a closed form. To prove Corollary 4.16, which aims to compute the
invariant by integrals at fixed values of ξ, we need to ensure that the integral of (σα−1 dζ,y,ω σα )∧3
over any (lateral) rectangle (involving an integration in ξ) goes to 0 as (ω, y, ζ) → ∞. To prove
Corollary 4.14, which aims to compute the invariant by integrals at fixed values of y, we need to
ensure that the integral of (σα−1 dξ,ζ,ω σα )∧3 over any (lateral) rectangle (involving an integration
in y) goes to 0 as (ω, ξ, ζ) → ∞.
We already know that the integrals over (lateral) rectangles with constant values of ω
converge to 0 as |ω| → ∞. The same argument shows the same result for integrals over
(lateral) rectangles at constant values of |ξ| → ∞. By hypothesis (h2) on the behavior of
σα in ζ, we also deduce the result for integrals over (lateral) rectangles at constant values of
|ζ| → ∞. This proves Corollary 4.15. To prove Corollary 4.16, it therefore remains to obtain
that the integral over a fixed rectangle in the variables (ω, ξ, ζ) goes to 0 as |y| → ∞. This is
in fact incorrect in general and this is why it was added as an assumption in the corollary.
The results (27) and (28) conclude the proof of Theorem 4.11 except for the last equality
involving the index of the Fredholm operator F . Under conditions (H1’) or (H2’), we proved
in proposition 4.10 that F was indeed Fredholm. That its index is given by the formula in
the theorem can be found or proved as in [30, Theorem 19.3.1]. This concludes the proof of
Theorem 4.11. 
Proposition 4.17 For the systems (1) and (2), the assumptions in Corollary 4.16 hold when
m(y) and f (y), respectively, converge to ∞ at ∞.
Proof. In both cases, at fixed values of y the integral of tr[σα−1 ∂ξ σα , σα−1 ∂ζ σα ]σα−1 over a
bounded domain at fixed values of y involves an integrand that goes to 0 when |µ(y)| converges
to ∞.
The above result states that while Corollaries 4.14 and 4.15 always hold, the regularized
spectral asymmetry (29) or (36) in [19, 27] holds only when the range of the domain wall
24

is the whole of R (in the topologically non-trivial case). A calculation for system (1) shows
that (29) does not hold when m(y) takes values between −m0 < 0 and m0 , say. Indeed, the
bulk-difference invariant c+ is given by [3]
Z
2
m
dξdζ = sign(m),
4π R2 (ξ 2 + ζ 2 + m2 ) 23
whereas the spectral asymmetry ‘invariant’ would be given by
Z
Z
sign(m0 )ξ
m′ (y)ξ
−2
−2
dζdy
=
dζdm.
3
4π R2 (ξ 2 + ζ 2 + m2 ) 2
4π R×[−m0 ,m0 ] (ξ 2 + ζ 2 + m2 ) 23
Calculated for ξ > 0 large enough, it is equals to c+ only in the limit m0 → +∞ and in fact
converges to 0 as ξ → ∞.
For (2), we thus find that for smooth and sufficiently slowly varying profiles of the Coriolis
force f (y), the bulk-interface correspondence (28) always holds. This was one of the main
motivations for the theory presented in this section.
The notion of index related to a spectral flow presented in Appendix D finds a mathematical
explanation in Corollary 4.14. The spectral flow, or equivalently the spectral asymmetry, is
indeed represented as the index of an extended operator taking the form ix − H, where ω and
the original variable x may be identified. Now, −ix + γ1 Dx may be written in the Fourier
domain as ∂ξ + γ1 ξ, which is the augmented operator introduced in Appendix D below.

5

Conclusions

This paper proposes two methods to compute the topologically quantized interface conductivity 2πσI of Hamiltonians of the form H[µ(y)] + V where µ(y) ∈ S[µ− , µ+ ] implements a
domain wall and V models a large class of (local) perturbations.
The first method presented in section 2 is a direct application of the heuristics of spectral
flows. It requires a diagonalization of the domain wall problem and shows that the conductivity
is given by the sum of the winding numbers of the branches of absolutely continuous spectrum
that cross a spectral region of interest. The mathematical backbone of the derivation borrows
from the machinery of non-commutative geometry to construct a Fredholm operator of the
form P U (H)P whose index is given by the Fedosov formula −Tr[P, U ]U ∗ and as a topological
object is immune to large classes of perturbations V . This immunity is the main reason for the
practical interest of such theories and gives a quantitative meaning to the perceived topological
protection of transport phenomena observed numerically or experimentally in several areas of
materials science and geophysical fluid flows.
The main drawback of the method is that it requires in practice a sufficiently explicit
expression of the spectral decomposition of H[µ(y)]. Its main advantage is that it applies even
when µ(y) displays discontinuities. It allows one to justify the surprising result for the system
(2) that the interface conductivity may take different quantized values for different profiles in
the same topological class of domain walls S[µ− , µ+ ].
The second method is based on computing a bulk invariant involving only the constantcoefficient Hamiltonians H[µ± ] and relating it to the interface conductivity 2πσI . We introduced a notion of bulk-difference invariant in section 3 that appropriately combines the
projectors associated to both bulk Hamiltonians H[µ± ] and is computed either by means of
Chern numbers on the sphere or three-dimensional winding numbers of associated Green’s
functions. These invariants are typically easier to compute than the ones introduced in section 2; see [5] for an application of Floquet topological insulators, where the computations of
25

these bulk invariants is possible while the spectral decomposition of the domain walls seems
intractable.
Once these bulk invariants are computed, they are related to the interface conductivity
by a general principle called here a bulk-interface correspondence. While the latter does not
always hold as we just mentioned, we showed in section 4 that it applied to a large class of
differential operators when their coefficients are sufficiently smooth, and for the system (2)
sufficiently slowly varying.
The correspondence is proved by relating both indices to a third one given as the index
of a Fredholm differential operator constructed from H[µ(y)] by adding a second domain wall
iν(x) (and hence enforcing localization) in the direction of propagation along the interface. We
first introduced some sufficient (pseudo-)differential conditions ensuring that the conductivity
was quantized. We then related the conductivity to an integral involving only the symbol of
the Hamiltonian H[µ(y)] and identified this integral with the Fedosov-Hörmander formula for
the index of the differential operator.
Our class of operators was restricted to the form (20) that includes generalizations of
models such as (1) and (2) or the Floquet model in [5]. The method extends to a larger class
of topologically nontrivial differential operators such as those appearing in superconductor
theory [43]; see [37].

Acknowledgment
This research was partially supported by the Office of Naval Research, Grant N00014-17-1-2096
and by the National Science Foundation, Grants DMS-1908736 and EFMA-1641100.

A

Index of interface Hamiltonian

The proof of Theorem 2.1 is similar to those derived in [3] to compute the index of interface
Hamiltonians. We highlight the main differences. It is shown in [3] that under the assumptions
on the spectral decomposition of U (H), then P U (H)P|RanP is a Fredholm operator and
−Index(P U P ) = Tr[P, U ]U ∗ = Tr[P, W ](I + W ∗ ) = Tr[P, W ]W ∗ + Tr[P, W ]
since [P, W ] is trace-class. Moreover, as in [3, 10], the above traces and given by the integrals
along the diagonals of their Schwartz kernels. The trace of [P, W ] is seen to vanish since
(p(x) − p(y))|y=x = 0. The Schwartz kernel of W is given by
′

′

w(x − x ; y, y ) =

Z X
R

′
ei(x−x )ξ
∗ ′
dξ.
W (Ej (ξ))ψj (y, ξ)ψj (y , ξ)

2π

j

∗ = w̄ . The kernel of [P, W ]W ∗ is thus
The kernel of W ∗ is given by w∗ (x′ − x; y ′ , y) with wij
ji
given by
Z
′
′
(χ(x) − χ(x”))w(x − x”; y, y”)w∗ (x′ − x”; y ′ , y”)dx”dy”,
t(x, x ; y, y ) =
Rd+1

∗
where
R χ(x) is the kernel of the projection P . Therefore, T := Tr[P, W ]W is computed by
T = Rd+1 t(x, x; y, y)dxdy. UsingR the change of variables (x, x”) → (z, x”) = (x − x”, x”) with
dxdx” = dzdx”, and computing R (χ(x” + z) − χ(x”))dx” = z, we obtain
Z
zw(z; y, y ′ )w∗ (z; y, y ′ )dzdydy ′ .
T = tr
R2d+1

26

Using the Fourier transform from z to ξ yields by Parseval
Z
−tr
∂ξ ŵ(ξ; y, y ′ )ŵ∗ (ξ; y, y ′ )dξdydy ′ ,
T =
2πi R2d+1
where ŵ(ξ; ·) is the component-wise Fourier transform of w(x; ·) given by
X
ŵ(ξ; y, y ′ ) =
W (Ej (ξ))ψj (y, ξ)ψj∗ (y ′ , ξ).
j

The derivative ∂ξ applies to W ◦ Ej and to ψj (y, ξ)ψj∗ (y ′ , ξ). At a fixed ξ, consider the latter
contribution, which is given by
Z X
tr∂ξ [ψj (y, ξ)ψj∗ (y ′ , ξ)]ψk (y ′ , ξ)ψk∗ (y, ξ)dydy ′ .
τ (ξ) :=
j,k

We show that τ (ξ) = 0. Indeed, we distribute ∂ξ over the product, exchange y and y ′ in the
second contribution to get (dropping the ξ-dependence to simplify notation)
Z X
tr
[∂ξ ψj (y)ψj∗ (y ′ )ψk (y ′ )ψk∗ (y) + ψj (y ′ )∂ξ ψj∗ (y).ψk (y)ψk∗ (y ′ )]dydy ′ .
j,k

Applying traces to these products of rank-one matrices yields (with ψ̄ as a column vector)
Z X
[∂ξ ψj (y) · ψ̄k (y)ψ̄j (y ′ ) · ψk (y ′ ) + ∂ξ ψ̄j (y) · ψk (y)ψj (y ′ ) · ψ̄k (y ′ )]dydy ′ .
τ (ξ) =
j,k

By orthogonality
of the eigenvectors,
only the terms j = k survive the integration and then
Z X
X Z
2
∂ξ |ψj (y)| dy =
∂ξ |ψj (y)|2 dy = 0. As a consequence,
τ (ξ) =
j

j

−tr X
T =
2πi
j,k

Z

∂ξ W ◦ Ej (ξ)ψj (y, ξ)ψj∗ (y ′ , ξ)W ∗ ◦ Ej (ξ)ψk (y ′ , ξ)ψk∗ (y, ξ)dydy ′ dξ.

Taking traces again and integrating in y and y ′ yields
Z
X
−1 X
∂ξ W ◦ Ej (ξ)W ∗ ◦ Ej (ξ)dξ = −
W1 (W ◦ Ej ).
T =
2πi
j

j

Here, W1 (f ) is the winding number of a (compactly supported) function f . Since the integral
of W ′ vanishes, the winding number of W ◦ Ej and that of U ◦ Ej are the same. This concludes
the proof of Theorem 2.1.

B

Calculations of conductivities in systems (1) and (2)

We show that the corresponding operators are unbounded self-adjoint operators on L2 (R2 )⊗Cn
and compute the interface conductivity in some tractable cases.
The 2 × 2 system (1). We briefly recall and slightly extend results computed in [3] for this
system so that they can be contrasted with the more challenging 3 × 3 system. The domain of
definition of H making it self-adjoint is given by D(H) := (H + ǫi)−1 H with H = L2 (R2 ) ⊗ C2 .
27

Here ǫ = ±1. Following [13, Chapters 4&8], we verify that the above domain is independent
of ǫ. Indeed the source problem, with ǫ = 1, may be recast as
(m + i)ψ1 + (Dx − iDy )ψ2 = s1 ,

(Dx + iDy )ψ1 + (i − m)ψ2 = s2

which after elimination of one variable yields, for instance,


1
−1
(Dx + iDy ) ψ1 = s1 − (Dx − iDy )
s2 .
(m + i) + (Dx − iDy )
i−m
i−m

This is an elliptic problem that implicitly defines a m(y)−dependent domain of definition. The
same domain of definition applies to ψ2 .
Now, for any bounded (multiplication or not) operator V , the problem (H + V + ǫi)ψ = 0
implies that ψ = 0 since ((H + V )ψ, ψ) is real and (ǫiψ, ψ) is purely imaginary. This shows
that for such perturbations, HV = H + V is self-adjoint and the spectral calculus applies.
Spectral decomposition of system (1). Let us first consider m(y) either of the form
m(y) = λy or m(y) a switch function in S[m− , m+ ] with m− m+ < 0. Detailed calculations
are in [4, 3]. We summarize the main relevant results.
Let us consider H[ξ], the partial Fourier transform from x to ξ, which we represent [4, 3]
as Dy σ1 + m(y)σ2 + ξσ3 after a global unitary transform permuting σ1,2,3 to σ3,1,2 . In case
(i), H[ξ] has compact resolvent, while in case (ii), its restriction to the interval (−m0 , m0 )
with m0 = min(|m+ |, |m− |), is also compact. As ξ varies, this provides branches of absolutely
continuous spectrum for the operator H[m(y)].
In either case, we observe that solving (H[ξ] − E)ψ = 0, i.e., finding the edge states,
amounts to solving
(ξ − E)ψ1 − iaψ2 = 0,

ia∗ ψ1 − (ξ + E)ψ2 = 0,

a = ∂y + m(y),

a∗ = −∂y + m(y),

which leads to trivial branches of spectrum corresponding to the shared (strictly) positive
eigenvalues of aa∗ and a∗ a, and one special branch of spectrum corresponding to the nontrivial
kernel of a when m− < 0 < m+ (the case we now consider). The branch is given by aψ2 = 0,
ψ1 = 0, and E(ξ) = −ξ, with group velocity E ′ (ξ) = −1 corresponding to a mode moving
towards negative values along the x axis. In other words, the operator
H[m(y)] admits the
!
0
branch of continuous spectrum (parametrized by E) e−M (y) e−iEx
at least for values |E| <
1
m0 in case (ii), where M is the antiderivative of m with M (0) = 0.
The above calculations imply that 2πσI = − sign(m+ ) when m(y) ∈ S[µ− , µ+ ] and
m+ m− < 0 (with σI = 0 when m+ m− > 0) while 2πσI = − sign(λ) when m(y) = λy
(and would vanish for m(y) = λ|y|).
The 3 × 3 system (2). We start by analyzing its Hermitian structure. We consider the 3 × 3
system with perturbation given by HV = H + V . We define the domain of such an operator as
D(H) = (H + ǫi)−1 H ⊂ H with H = L2 (R2 ) ⊗ C3 with ǫ = ±1 and then show that H + V + ǫi
is still surjective from D(H) to H, or equivalently that the kernel of H + V + ǫi on that domain
is trivial. The problem (H + i)ψ = S, with ǫ = 1 to simplify may be recast as
!
!
!
i + Dx σ1 B
w
Sw
=S=
Sv
B∗
i
v
where we have defined w = (η, u)t and B = (Dy , if (y))t . We find (i + Dx σ1 )−1 = −(1 +
Dx2 )−1 (i − Dx σ1 ) so that the above system is equivalent to
(B ∗ (1 + Dx2 )−1 (i − Dx σ1 )B + i)v = Sv + (1 + Dx2 )−1 (i − Dx σ1 )Sw ,
28

along with w = (1 +
Dx2 )−1 (Sw + (i − Dx σ1 )Bv). The equation for v is therefore B ∗ (i −

Dx σ1 )B + i(1 + Dx2 ) v = (1 + Dx2 )Sv + (i − Dx σ1 )Sw or equivalently

i(Dy2 + f 2 ) + f ′ (y)Dx + i(1 + Dx2 ) v = (1 + Dx2 )Sv + (i − Dx σ1 )Sw

This is an elliptic problem with a unique solution, which provides a domain of definition for
v given by (Dx2 + Dy2 + hf i2 )−1 (1 + Dx2 )L2 (R2 ). This propagates to a domain of definition
for (η, u) coming from w = (1 + Dx2 )−1 (Sw + (i − Dx σ1 )Bv). We observe that the spaces are
independent of ǫ = ±1.
For any bounded Hermitian perturbation V , the same spaces provide that (H +V +ǫi)ψ = 0
implies that ψ = 0. Indeed on that domain ((H + V )ψ, ψ) is real while (ψ, ǫiψ) is purely
imaginary. This shows that HV = H + V is a self-adjoint operator on D(H) and the spectral
calculus applies.
Spectral decomposition of system (2). Consider now the Hamiltonian H[f (y)], which is
invariant by translation along the x−axis. One difficulty not present in the 2 × 2 system is the
presence essential spectrum at energy 0. The bulk-interface correspondence predicts a number
of protected interface modes equal to 2, which is ‘often’ the case, as we demonstrate in section
4, but not always. We now compute the winding number of branches of continuous spectrum
for several profiles f (y). Similar calculations have been worked out in [12, 40, 42, 41] without
explicitly looking to identify spectral branches.
We are looking at continuous branches of spectrum of H[f (y)], i.e., discrete spectrum of
H[ξ] that is continuous in ξ. This requires solving for H[ξ]ψ = E(ξ)ψ for ψ = (η, u, v)t , which
is given by the following system:
ξu + Dv = Eη,

ξη + if v = Eu,

Dη − if u = Ev,

(30)

with D = 1i ∂y . We first make general remarks on such systems and then consider specific
examples that can be solved explicitly. For concreteness, we consider the setting where f ′ (y) ≥
0. We first look for solutions with v = 0. We find from the other equations that |E| = |ξ|
and u = ±η when E 6= 0 with ∂y η + f u = 0. This shows that η = u provides a solution
u = e−F (y) with F ′ (y) = f (y) and F (0) = 0, say, which is unique up to normalization.
Note that au = 0 with a = ∂y + f an operator with non-trivial kernel and trivial co-kernel
(and hence a Fredholm operator in appropriate topologies with index equal to 1). Note that
E = E(ξ) = ξ provides a branch of continuous spectrum. Moreover, E ′ (ξ) = 1 corresponds
to waves propagating toward positive values of x; these are the eastward propagating Kelvin
waves in the geophysical application.
Still with v = 0, it remains to look at the case E = ξ = 0 where we find that Dη = if u
as the only constraint. There is an infinite number of solutions and E = ξ = 0 corresponds to
essential spectrum that needs to be avoided. We thus assume E 6= 0.
Let us now look for solutions with v 6= 0. Eliminating η, assuming ξ 6= 0, yields
(ξD + if E)v = (E 2 − ξ 2 )u,

(ED − if ξ)u = (Eξ + iDf )v,

and further eliminating u provides the following equation for v:
(D 2 + f 2 +

ξ
ξ ′
f )v = (−∂y2 + f 2 + f ′ )v = (E 2 − ξ 2 )v.
E
E

We verify from (30) that the above equation still holds when ξ = 0.
Let us assume that E 2 = ξ 2 . Then ξ = −E implies that the above equation for v is
∗
a av = 0 whereas ξ = E implies that aa∗ v = 0. The latter admits v = 0 as a unique solution
29

while the former admits the solution v = e−F (y) . When E = −ξ, we then verify that
i
−a∗ η = (ξ 2 − f 2 )v.
ξ

i
(∂y − f )u = −a∗ u = (ξ 2 + f 2 − f ′ )v,
ξ

These equations admit solution if and only if the right hand sides are orthogonal to the
solutions
in the kernel of
the Fredholm alternative. As a consequence, we observe that
R 2
R a by
2 − f ′ )v 2 dy =
2 − f 2 )v 2 dy = 0. Only for specific f are such constraints satisfied
(ξ
+
f
(ξ
R
R
(they are for instance when f = f0 sign(y)). But in any case, they are satisfied for two values
of ξ at most and therefore only generate discrete spectrum in H[f (y)] at most. Such discrete
spectrum is irrelevant in our pursuit of branches of continuous spectrum and does not modify
the value of Fredholm indices.
Therefore, |E| =
6 |ξ| when v 6= 0. Once v is found, then u and η are given by
u=

E2

1
(ξD + if E)v,
− ξ2

η=

1
(ξu + Dv).
E

We are left with verifying that u and η thus defined are normalizable when v is normalizable,
which may depend on f (y) but holds in the cases considered below.
We thus look for non-trivial solutions of the equation (−∂y2 + f 2 + Eξ f ′ )v = (E 2 − ξ 2 )v. It
does not seem possible to solve such an equation in closed form for arbitrary functions f (y).
We consider cases that admit closed-form expressions.
We first consider the case f (y) = f0 sign(y). The solution v is even in y and given by e−µy
for y > 0 with µ > 0 such that −µ2 + f02 = E 2 − ξ 2 . The jump conditions at y = 0 read
v ′ (0−) − v ′ (0+) + Eξ 2f0 = 0 or equivalently µ = − Eξ f0 . Plugging this into the above equation
yields two solutions E 2 = f02 or E 2 = ξ 2 . We have already ruled out the latter. The former
gives E = −f0 sign(ξ) so that µ > 0. As a consequence, we observe that E = ∓f0 is infinitely
degenerate. The effect of the interaction of the bulk 0 sheet and the varying f is the presence
of stationary waves since E ′ (ξ) = 0. Moreover, we observe a spectral gap in (−f0 , f0 ) for the
part of the spectrum corresponding to v 6= 0. For energies |E| < f0 , we thus obtain only one
branch of continuous spectrum given by the Kelvin waves. The number of interface modes is
equal to 1, not 2 as (wrongly) predicted by the bulk interface correspondence. We refer the
reader to [42, 41] for other explicit calculations, obtained for instance in the presence of an
odd viscosity contribution ε so that f in the equations is replaced by f + ǫ∆.
Below, we analyze more general cases of f (y) constant for ±y > 0. We find the surprising
result that asymmetric edge states may appear when 0 < f− < f+ even though the bulkdifference invariant clearly vanishes in such a case.
First, we consider the practically relevant case f (y) = λy with λ > 0 for concreteness.
Now that f ′ = λ is constant, we can relate the spectrum of the problem of interest to that of
the quantum harmonic oscillator. We find that a∗ av = (E 2 − ξ 2 − λ(1 + Eξ ))v. The spectrum
of a∗ a is given by 2nλ so that
En2 − ξ 2 − λ

ξ
= (2n + 1)λ,
En

En3 = (λ(2n + 1) + ξ 2 )En + λξ.

We look for all solutions to the above equation, except for the case E 2 = ξ 2 , which we ruled out
and occurs only when n = 0. These are all cubic equations, which can be solved explicitly. The
case n = 0 provides two solutions, one with positive energy and the other one with negative
energy. These are called Yanai waves. We verify that E0′ (ξ) > 0 for such waves and they
therefore also propagate eastward.
The rest of the solutions are composed of Rossby waves and Poincaré waves coming in
continuous branches of spectrum crossing an energy level different from 0 a finite and even
30

number of times so that they are topologically trivial (with a vanishing winding number); see
[12, 42] as well.
As a summary of the above calculations, we therefore find that 2πσI is given by +1 when
f (y) = f0 sign(y) with f0 > 0 while it is given by +2 when f (y) = λy with λ > 0.
Coriolis force taking two values on half lines. We finally consider the case with f (y) = f+
for y > 0 and f (y) = f− < f+ for y < 0. Then v, assuming E 6= 0, solves the following system:
−∂y2 v + f 2 v = (E 2 − ξ 2 )v,

−(v ′ (0+ ) − v ′ (0− )) +

y 6= 0;

ξ
(f+ − f− )v(0) = 0.
E

The solutions are given by v(y) = e−µ+ y for y > 0 and v(y) = eµ− y for y < 0 with µ± > 0 as a
necessary condition for normalization. We thus obtain the system of equations for (E, µ+ , µ− )
knowing (ξ, f+ , f− ):
E 2 − ξ 2 = f+2 − µ2+ = f−2 − µ2− ,

µ+ + µ− +

ξ
(f+ − f− ) = 0.
E

We want solutions such that µ± > 0. f+ − f− > 0 implies that
1
fe = (f+ + f− ),
2

fo =

ξ
E

< 0. We introduce:

1
(f+ − f− ) > 0.
2

From µ2+ − µ2− = (µ+ + µ− )(µ+ − µ− ) = f+2 − f−2 we deduce that µ+ − µ− +
Let us define ν = Eξ . Then,
µ+ + ν −1 fo + νfe = 0

so that

E
ξ (f+

+ f− ) = 0.

µ2+ = ν −2 fo2 + fo fe + ν 2 fe2 = f+2 + ξ 2 (1 − ν 2 ).

This gives an equation for ν, or equivalently E, using f+2 − 2fo fe = fo2 + fe2 ,
(fe2 + ξ 2 )ν 4 − (fo2 + fe2 + ξ 2 )ν 2 + fo2 = 0 or (fe2 + ξ 2 )(ν 2 − 1)(ν 2 −

fo2
) = 0.
fe2 + ξ 2

We know the existence of a branch E(ξ) = ξ (Kelvin waves with v = 0) and ruled out
E(ξ) = −ξ. With |E| 6= |ξ|, we know that ξ/E < 0 so that, since fo > 0, the only admissible
solution is
−ξfo
.
(31)
E=p
fe2 + ξ 2

For such a branch, we verify that ∂ξ E < 0. The only valid solutions of interest satisfy that
µ± = −νfo ∓ ν −1 fe > 0, or equivalently,
fo > ν 2 |fe |

or

ξ 2 ≥ |fe |(fo − |fe |),

where we used the above expression for ν. An admissible branch of continuous spectrum inside
the bulk gaps implies |E| < M := min(|f− |, |f+ |) = |fo − |fe ||. We thus find the constraints
ξ 2 ≥ |fe |(fo − |fe |),

(2fo − |fe |)ξ 2 < |fe |(fo − |fe |)2 .

and

We then consider three cases. (i) |fe | ≥ 2fo in which case both constraints are satisfied; (ii)
2fo > |fe | ≥ fo in which case the first constraint is always satisfied and the second one provides
ξ 2 < |fe |

(|fe | − f0 |)2
.
2fo − |fe |
31

(iii) The third and last case is |fe | < fo in which case the two constraints combined impose
2fo − |fe | < fo − |fe |, which is not possible.
We verify that f− < 0 < f+ belongs to case (iii). Only the Kelvin waves E(ξ) = ξ, as
in the case f− = −f+ , cross the bulk band gap. Surprisingly, as soon as |fe | ≥ fo , which
corresponds to f− < f+ ≤ 0 or 0 ≤ f− < f+ , then a branch of absolutely continuous spectrum
crosses the intervals (−M, 0) and (0, M ) with M = |fe | − f0 . Since ∂ξ E < 0, these branches
have a winding number equal to −1.
We have thus considered the three different configurations: (i) when f (y) = |λ|y, then
I[H] = 2 as predicted by the bulk interface correspondence; in the piece-wise constant case
f = f− χy<0 + f+ χy>0 (ii) when |fe | < fo , then I[H] = 1; and (iii) when |fe | > fo , then
I[H] = 1 − 1 = 0 as predicted by the bulk-interface correspondence, since f+ and f− have the
same sign.

C

Equivalence of bulk-difference invariants

R
Proof. [Lemma 3.2] The objective is to recast Wα = 8πi 2 T d2 k in terms of the projectors Πj ,
where we use that ∂ω G−1 = i and
Z
T = T (k) := trG[∂1 G−1 G, ∂2 G−1 G]dω.
P
P
For H = i hi Πi so that G = i (z − hi )−1 Πi , we thus need to estimate
X Z Πi (∂1 HΠj ∂2 H − ∂2 HΠj ∂1 H)Πk
X Z Πi (∂1 HΠj ∂2 H − ∂2 HΠj ∂1 H)
tr
dω =
tr
dω
(z − hi )(z − hj )(z − hk )
(z − hi )2 (z − hj )
i,j

i,j,k

since Πi Πk = δik Πi and the trace is cyclic. We now evaluate the integrals over ω, which have
a different form depending on whether i = j or not. For the latter case, we have
1
(z − hi

)2 (z

− hj )

=

b1
b2
b3
+
+
2
α − hi + iω (α − hi + iω)
α − hj + iω

with Rb3 = −b1 = (hj − hi )−2 and b2 = (hi − hj )−1 . It remains to evaluate the integrals using
that (α + iω)−1 dω = π sign(α) to obtain
π

1
( sign(α − hj ) − sign(α − hi ))
(hi − hj )2

R
since (α + iω)−k dω = 0 for k ≥ 2 integer by residue calculation. When i = j, we similarly
obtain a vanishing contribution. Thus,
X
Πi (∂1 HΠj ∂2 H − ∂2 HΠj ∂1 H)
T =
π( sign(α − hj ) − sign(α − hi ))tr
.
(hi − hj )2
i6=j

By cyclicity of the trace, we obtain
X
Πi (∂1 HΠj ∂2 H − ∂2 HΠj ∂1 H)
.
T =
2π( sign(α − hj ) − sign(α − hi ))tr
(hi − hj )2

(32)

i<j

The above formula is convenient for explicit computations of the invariants. When the projectors Πi = ψi ⊗ ψi are rank one, using that hψi , γψj i = hψj , γψi i for any Hermitian matrix
γ, we observe that
X sign(α − hj ) − sign(α − hi )
T = 2π
2iℑ(hψi , ∂1 Hψj ihψj , ∂2 Hψi i).
(33)
(hi − hj )2
i<j

32

From the above expression for H, we deduce that ∂k H =
all terms involving ∂k hl cancel as Πi Πj Πk = 0 so that
X
i<j

2π( sign(α − hj ) − sign(α − hi ))

X
k,l

P

l

∂k hl Πl + hl ∂k Πl . For i 6= j,

hk hl
trΠi (∂1 Πk Πj ∂2 Πl − ∂2 Πk Πj ∂1 Πl ).
(hi − hj )2

Πm Πn = δmn Πn implies ∂m Πk Πl + Πk ∂m Πl = δkl ∂m Πk so that (k, l) in the above formula have
to equal i or j. The sum over (k, l) is thus
tr

h2i Πi ∂1 Πi Πj ∂2 Πi + hi hj (Πi ∂1 Πi Πj ∂2 Πj + Πi ∂1 Πj Πj ∂2 Πi ) + h2j Πi ∂1 Πj Πj ∂2 Πj
(hi − hj )2

minus the contribution exchanging the order of the derivatives. The above term is
trΠi ∂1 Πi Πj ∂2 Πi = −trΠi ∂1 Πi Πj ∂2 Πj = trΠi ∂1 Πj Πj ∂2 Πj = −trΠi ∂1 Πj Πj ∂2 Πi
since Π2j = Πj so that ∂k Πj = ∂k Πj Πj + Πj ∂k Πj and trΠi A = trAΠi . We thus have
T = 2π

X
i<j

( sign(α − hj ) − sign(α − hi ))trΠi (∂1 Πi Πj ∂2 Πi − ∂2 Πi Πj ∂1 Πi ).

Therefore,
T = −4π

X X

hi <α hj >α

trΠi (∂1 Πi Πj ∂2 Πi − ∂2 Πi Πj ∂1 Πi ),

or using trΠi ∂1 Πi Πj ∂2 Πi = trΠj ∂2 Πi Πi ∂1 Πi
X
X
T = 4π
tr(
Πj )(∂1 Πi Πi ∂2 Πi − ∂2 Πi Πi ∂1 Πi ).
hi <α

hj >α

This is also, for i0 the index so that hi0 < α < hi0 +1 ,
X
X
T = 4π
Πj )(∂1 Πi Πi ∂2 Πi − ∂2 Πi Πi ∂1 Πi ).
tr(I −
i≤io

j≤i0

Now from trΠj ∂1 Πi Πi ∂2 Πi = trΠi ∂2 Πj Πj ∂1 Πj for i 6= j and tr[Πi ∂1 Πi , Πi ∂2 Πi ] = 0, we deduce
that the double sum for (i, j) ≤ i0 vanishes and
X
X
trΠi [∂1 Πi , ∂2 Πi ].
tr(∂1 Πi Πi ∂2 Πi − ∂2 Πi Πi ∂1 Πi ) = −4π
T = 4π
i≤i0

i≤i0

This shows that for α in the i0 th gap, the winding number is given by the sum of the first i0
Chern numbers as expected.
Application to bulk invariant calculations for the 3 × 3 system (2). We now use (33)
to compute the bulk-difference Wα invariant. We recast the system (2) as H = ξγ1 +ζγ4 −f γ7 .
This is diagonalized as follows. We find I = Π− +Π0 +Π+ for H = κ(Π+ −Π− ) and Πj = ψj ψj∗
rank one projectors given by

 

if
if ξ ± κζ
1
1 

(34)
ψ0 =  ζ  , ψ± = ξζ ± if κ
κ
ρ
2
2
−ξ
ζ +f
33

and (ξ, ζ)−dependent eigenvalues given by
h0 = 0,

h± = ±κ,

for

κ=

p

ξ2 + ζ 2 + f 2

and

p
ρ = κ 2(f 2 + ζ 2 ).

We find ∂Rξ H = −∂ξ G−1 = γ1 and ∂ζ H = −∂ζ G−1 = γ4 . As a consequence, (33) gives
Wα = 8πi 2 R2 T dξdζ with
T = 2π

X

1≤i<j≤3

sign(α − hj ) − sign(α − hi )
2iℑ(hψi , γ1 ψj ihψj , γ4 ψi i).
(hi − hj )2

For α > 0, the only differences of signs contributing non trivial terms are (i, j) with i < j in
{(−, +), (0, +)} with then sign(α − hj ) − sign(α − hi ) = −2. We find
hψ+ , γ4 ψ− i = 0,

hψ+ , γ4 ψ0 i =

1
(if κ − ζξ),
ρ

hψ0 , γ1 ψ+ i =

1 2
(ζ + f 2 ).
ρ

Thus, 2iℑ(hψ0 , γ1 ψ+ ihψ+ , γ4 ψ0 i) = ifκ . Note that h+ − h0 = κ. The bulk difference is defined
for f± = ±f on the top and bottom planes, which yields
Z
Z
i|f | −4π
|f |dξdζ
sign(f )
i
dξdζ =
−Wα = 2 sign(f ) 2
3 = 2 sign(f ),
2
8π R2 κ κ
π
R2 (ζ 2 + ξ 2 + f 2 ) 2
as a standard integration for two-dimensional invariants. This was obtained for α > 0 and
f− = −f+ . All other expressions are obtained similarly. In particular, we observe that Wα
after some algebra takes the same value for α < 0 so that c+ = c+ + c0 = −c− = −2 sign(f ),
which yields (15). See [40, 42] and in particular [23, Appendix A] for alternative methods to
compute the above invariants.

D

Bulk-interface correspondences

This paper presents two methods to compute the interface conductivity for general classes of
operators HV . Both involve two steps. The first step is to assume that HV = H[µ(y)] + V
with V a perturbation in an appropriate sense so that we may prove σI [HV ] = σI [H]. The
second step is the computation of σI for an operator that is invariant by translations along
the x axis. In the Fourier domain x → ξ, we thus end up with the analysis of problems of the
form H(ξ)ψ(ξ) = E(ξ)ψ(ξ) for E(ξ) an energy inside the bulk band gap.
The two methods presented here in sections 2 and 4 are related to the notion of spectral
flow and the similar one of spectral asymmetry. The computation given in section 2 is based
on the assumption of finitely many spectral branches ξ → E(ξ). The computations in section
4 are more closely related to (a regularization of) a spectral asymmetry.
In this appendix, we briefly present some related results on the bulk-interface correspondences primarily developed in [22, 19, 43]. All revolve around the following observation.
Consider the graph ξ 7→ E(ξ) and assume that it crosses the value 0 a finite number of times.
If that number is even, then the graph can be continuously deformed (with fixed end points)
so that it no longer crosses the line 0. Such a deformation is not possible when that number is odd, where the minimal number of crossings is ±1 accounting for direction of crossing.
This number is topologically protected and equivalent to the winding number of the spectral branches we considered in section 2. This asymmetric edge transport is also the main
physically observable manifestation of the non-trivial topology of the system.
Spectral flow. The above asymmetry may be formalized by the notion of spectral flow.
Consider the 2 × 2 system and assume that m(y) is a continuous function equal to m− for
34

y < −|y0 | < 0 and equal to m+ for y > |y0 |. The bulk Hamiltonian has a spectral gap in
(−m0 , m0 ) for m0 the minimum of |m− | and |m+ |. For any energy E in the spectral gap
(−m0 , m0 ), we look at the graph ξ 7→ (H[ξ] − E) for eigenvalues of H[ξ] in the spectral gap as
well. The spectrum of H[ξ] restricted to the spectral gap is only composed of point spectrum
as already recalled in the preceding section. We then consider an energy −m0 < E < m0 and
define the number of protected edge states as [22]
I(E) = SF[H[ξ] − E],
the number of signed crossings of H[ξ] through E (counted as positive from bottom to top
and negative from top to bottom). The method devised in [22] to compute the spectral flow
is to relate it (semi-formally) to the index of the Fredholm operator :
!
aξ − E
−iay
,
ay = ∂y + m(y), aξ = v∂ξ + ξ
(35)
Hv = v∂ξ + H[ξ] − E =
ia∗y
−a∗ξ − E
for some v > 0 arbitrary. Using that the kernel of ay is non-trivial whereas that of a∗y is trivial
when m− < 0 < m+ and that the kernel of aξ − E is non-trivial whereas that of a∗ξ − E
is, it is straightforward to obtain that I[Hv ] = − 21 ( sign(m+ ) − sign(m− )), which is also the
bulk-difference invariant c+ = −c− in (14). This is the bulk-interface correspondence for the
2 × 2 system. The correspondence only depends on the asymptotic behavior of m(y) for large
|y|. This shows that aξ and ay can be continuously modified without changing the invariant
so long as m± remain of constant sign.
The above calculations extend to a large class of models as shown in [22]. However, the
calculations we obtained earlier show that the above correspondence cannot extend to arbitrary
3 × 3 models since the spectral flow depends on some details of the coefficient f (y). We will
revisit the above notion of spectral flow below.
Spectral asymmetry. An intuitive picture of the bulk-interface correspondence was developed in [43, Chapter 22] and further analyzed in [19, 27]. It is based on the spectral
asymmetry,
Z
Z
dω
dω
−1
G∂ω G = Tr
G
ν(ξ; α) = Tr
2πi
R 2π
R

defined for α ∈ R, where G = (α + iω − H[ξ])−1 is the Green’s (resolvent) operator, whose
kernel is the Green’s function, and where Tr is the operator trace. The above operator is in
fact not necessarily trace-class and the asymmetry will be appropriately regularized below.
Heuristically, we expect ν(ξ; α) to provide the difference of the numbers of eigenvalues of H
that are larger and smaller than α since, formally,
Z
dω
H[ξ] − α
1X
ν(ξ; α) = −Tr
sign(En (ξ) − α).
=
−
2π ω 2 + (H[ξ] − α)2
2 n
The sum in ν(ξ2 ; α) − ν(ξ1 , α) counts the number of eigenvalues En (ξ) that cross α as ξ runs
from ξ1 to ξ2 as does the spectral flow considered earlier.
The above sign function is defined only when α is not an eigenvalue of H[ξ]. Assuming
that this is the case when |ξ| is large, then, still heuristically, we expect that

− I(α) = lim ν(ξ; α) − ν(−ξ; α) .
(36)
ξ→∞

The works in [19, 43] then recast the right-hand side in (36) as an integral of the symbol
of H[µ(y)], or equivalently the symbol of the resolvent (Green’s) operator. Such a derivation,
35

called gradient expansion in these references, will be justified below by using semiclassical
calculus in a spirit similar to the derivation of the Fedosov-Hörmander index theorem [30,
Theorem 19.3.1]. We also refer to [15] for a recent application of semiclassical calculus for the
derivation of the bulk-interface correspondence for periodic magnetic Schrödinger operators.
In the rest of the section, we introduce this calculus, which only applies for Hamiltonians
with smooth coefficients, and recast the bulk-interface correspondence as a calculation of an
index for an appropriate Fredholm operator that is similar to (35). In doing so, we obtain that
(36) actually holds only in specific cases, which for the 2 × 2 and 3 × 3 systems correspond to
the cases where µ(y) converges to infinity at infinity.

E

Semiclassical calculus and Helffer-Sjöstrand formula

We collect here notation and results on pseudo-differential, semiclassical, and spectral calculus
used in this paper following [7, 11, 13, 44], to which we refer for details.
Let V = Rd and V ′ ≃ Rd its dual. A bounded matrix-valued operator A from S(V ) ⊗ Cn
the Schwartz space to its dual S ′ (V ) ⊗ Cn admits a (Schwartz) distribution kernel KA ∈
S ′ (V × V ) ⊗ Mn (C) and can be represented for 0 < h ≤ 1 as
Z
x−y
x+y
1
w
ei h ·ξ a(
, ξ)ψ(y)dydξ, (37)
A = Oph (a) := Oph (a), Oph (a)ψ(x) =
d
(2πh) V ′ ×V
2
where a(x, ξ) ∈ S ′ (V × V ′ ) ⊗ Mn is the Weyl symbol of A defined as
Z
y·ξ
y
y
e−i h KA (x + , x − )dy.
a(x, ξ) =
2
2
V
The notation aw (x, hD) := Oph (a) is also used to define the semiclassical operator (hΨDO)
for the Weyl quantization of a with D = 1i ∇. Finally, we use the notation Opw (a) = Op(a) :=
Op1 (a) for the Weyl quantization of pseudo-differential operators defined at the scale h = 1.
To define operators with smoother kernels that can be composed with each other, we define
the space of order functions m(x, ξ) from V × V ′ → [0, ∞) satisfying the growth condition:
m(x, ξ) ≤ C(1 + |x − y| + |ξ − ζ|)N m(y, ζ)

(38)

for some constants C = C(m) and N = N (m). Examples of interest are (1 + |x|2 + |ξ|2 )s
for s ∈ R as well as max(0, ±x1 ). We then denote by S(m) the Fréchet space of symbols
a(x, ξ) ∈ C ∞ (V × V ′ ) ⊗ Mn such that
k∂xα ∂ξβ a(x, ξ)kMn ≤ Cα,β m(x, ξ).

(39)

For h−dependent symbols a(·; h), we say that a ∈ S 0 (m) when a(·; h) ∈ S(m) uniformly in
0 < h ≤ 1.
For two operators aw and bw with symbols a ∈ S 0 (m1 ) and b ∈ S 0 (m2 ), we then define the
composition cw = aw ◦ bw with symbol c ∈ S 0 (m1 m2 ) given by the Moyal product
 h

c(x, ξ) = (a♯h b)(x, ξ) := ei 2 (∂x ·∂ζ −∂y ·∂ξ ) a(x, ξ)b(y, ζ)
.
(40)
|y=x;ζ=ξ

In other words, Oph (a)Oph (b) = Oph (a♯h b). We also define ♯ = ♯1 when h = 1.
For a ∈ S 0 (1), we obtain ([13, Th. 7.11],[7, Prop. 1.4]) that Oph (a) is bounded as an
operator in L(L2 (V ) ⊗ Cn ) with bound uniform in 0 < h ≤ 1 so that I − hOph (a) is invertible
on that space when h is sufficiently small.
36

An operator is said to be (semiclassically) elliptic when the symbol a = a(x, ξ; h) ∈ S 0 (m)
is invertible in Mn for all (x, ξ) ∈ V × V ′ with a−1 ∈ S 0 (m−1 ). For σ a Hermitian-valued
symbol and Hh = Oph (σ), we then obtain that z − Hh is elliptic for z = λ + iω with ω 6= 0.
Moreover, (z −Hh )−1 is a operator with symbol rz ∈ S 0 (1) uniformly in 0 < h ≤ h0 sufficiently
small, |λ| bounded and |ω| bounded away from 0; see [13, Prop. 8.6], which extends to the
matrix-valued case, and Lemma 4.12 for a more precise bound for ω small.
We next recall the sharp semiclassical Gårding inequality [13, Theorem 7.12] (which extends
to the vectorial case without modification) stating that for a a Hermitian-valued symbol in
S 0 (1) with eigenvalues greater than or equal to β ∈ R for all (x, ξ) ∈ V × V ′ , then
(Oph (a)ψ, ψ) ≥ (β − Ch)kψk2

(41)

for all ψ ∈ L2 (V ) ⊗ Cn and for C a constant independent of 0 < h ≤ h0 sufficiently small.
Thus, for β > 0 and h sufficiently small, the operator Oph (a) has spectrum bounded away
from 0.
Finally, we recall some results on spectral calculus and the Helffer-Sjöstrand formula following [11, 13]; see also [7] for the vectorial case. For any self-adjoint operator H from its
domain D(H) to L2 (V ) ⊗ Cn and any bounded continuous function ϕ on R, then ϕ(H) is
uniquely defined as a bounded operator on L2 (V ) ⊗ Cn [13, Chapter 4]. Moreover, for ϕ
compactly supported, we have the following spectral representation
Z
1
∂¯ϕ̃(z)(z − H)−1 d2 z,
(42)
ϕ(H) = −
π C
where, for z = λ + iω, d2 z := dλdω, ∂¯ = 21 ∂λ + 12 ∂ω , and where ϕ̃(z) is an almost analytic
extension of ϕ. The extension ϕ̃ is compactly supported in C. Moreover, ϕ̃(λ + i0) = ϕ(λ)
and ∂¯ϕ̃(λ + i0) = 0, whence the name of almost analytic extension. We can choose the almost
analytic extension such that |∂¯ϕ̃| ≤ Cn |ω|n for any n ∈ N in the vicinity of the real axis
uniformly in (α, ω) on compact sets. Several explicit expressions, which we do not need here,
for such extensions are available in [11, 13].

References
[1] M. F. Atiyah, V. K. Patodi, and I. M. Singer. Spectral asymmetry and Riemannian geometry. I. In Mathematical Proceedings of the Cambridge Philosophical Society, volume 77,
pages 43–69. Cambridge University Press, 1975.
[2] J. Avron, R. Seiler, and B. Simon. Homotopy and quantization in condensed matter
physics. Physical review letters, 51(1):51, 1983.
[3] G. Bal. Continuous bulk and interface description of topological insulators. Journal of
Mathematical Physics, 60(8):081506, 2019.
[4] G. Bal. Topological protection of perturbed edge states. Communications in Mathematical
Sciences, 17(1):193–225, 2019.
[5] G. Bal and D. Massatt. Multiscale Invariants of Floquet Topological Insulators. In
Preparation, 2021.
[6] B. A. Bernevig and T. L. Hughes. Topological insulators and topological superconductors.
Princeton university press, 2013.
37

[7] J. Bolte and R. Glaser. A semiclassical egorov theorem and quantum ergodicity for matrix
valued operators. Communications in mathematical physics, 247(2):391–419, 2004.
[8] C. Bourne, J. Kellendonk, and A. Rennie. The k-theoretic bulk–edge correspondence for
topological insulators. In Annales Henri Poincaré, volume 18, pages 1833–1866. Springer,
2017.
[9] C. Bourne and A. Rennie. Chern numbers, localisation and the bulk-edge correspondence for continuous models of topological phases. Mathematical Physics, Analysis and
Geometry, 21(3):16, 2018.
[10] C. Brislawn. Kernels of trace class operators. Proceedings of the American Mathematical
Society, 104(4):1181–1190, 1988.
[11] E. B. Davies. Spectral Theory and Differential Operators. Cambridge Studies in Advanced
Mathematics. Cambridge University Press, 1995.
[12] P. Delplace, J. Marston, and A. Venaille. Topological origin of equatorial waves. Science,
358(6366):1075–1077, 2017.
[13] M. Dimassi and J. Sjöstrand. Spectral asymptotics in the semi-classical limit. Number
268. Cambridge university press, 1999.
[14] A. Drouot. The bulk-edge correspondence for continuous honeycomb lattices. arXiv
preprint arXiv:1901.06281, 2019.
[15] A. Drouot. Microlocal analysis of the bulk-edge correspondence.
arXiv:1909.10474, 2019.

arXiv preprint

[16] A. Drouot, C. L. Fefferman, and M. I. Weinstein. Defect modes for dislocated periodic
media. arXiv preprint arXiv:1810.05875, 2018.
[17] P. Elbau and G. Graf. Equality of bulk and edge hall conductance revisited. Communications in mathematical physics, 229(3):415–432, 2002.
[18] A. Elgart, G. Graf, and J. Schenker. Equality of the bulk and edge hall conductances in
a mobility gap. Communications in mathematical physics, 259(1):185–221, 2005.
[19] A. M. Essin and V. Gurarie. Bulk-boundary correspondence of topological insulators from
their respective green’s functions. Physical Review B, 84(12):125132, 2011.
[20] C. L. Fefferman, J. P. Lee-Thorp, and M. I. Weinstein. Edge States in Honeycomb
Structures. Annals of PDE, 2(2):12, 2016.
[21] M. Fruchart and D. Carpentier. An introduction to topological insulators. Comptes
Rendus Physique, 14(9–10):779 – 815, 2013.
[22] T. Fukui, K. Shiozaki, T. Fujiwara, and S. Fujimoto. Bulk-edge correspondence for Chern
topological phases: A viewpoint from a generalized index theorem. Journal of the Physical
Society of Japan, 81(11):114602, 2012.
[23] G. M. Graf, H. Jud, and C. Tauber. Topology in shallow-water waves: a violation of
bulk-edge correspondence. arXiv preprint arXiv:2001.00439, 2020.
[24] G. M. Graf and M. Porta. Bulk-edge correspondence for two-dimensional topological
insulators. Communications in Mathematical Physics, 324(3):851–895, 2013.
38

[25] G. M. Graf and C. Tauber. Bulk-edge correspondence for two-dimensional Floquet topological insulators. In Annales Henri Poincaré, volume 19, pages 709–741. Springer, 2018.
[26] V. Grushin. Pseudodifferential operators on r n with bounded symbols. Functional Analysis and Its Applications, 4(3):202–212, 1970.
[27] V. Gurarie. Single-particle Green’s functions and interacting topological insulators. Physical Review B, 83(8):085426, 2011.
[28] Y. Hatsugai. Chern number and edge states in the integer quantum hall effect. Physical
review letters, 71(22):3697, 1993.
[29] B. Helffer and D. Robert. Calcul fonctionnel par la transformation de mellin et opérateurs
admissibles. Journal of functional analysis, 53(3):246–268, 1983.
[30] L. V. Hörmander. The Analysis of Linear Partial Differential Operators III: PseudoDifferential Operators. Springer Verlag, 1994.
[31] J. Kellendonk and S. Richard. On the wave operators and Levinson’s theorem for potential
scattering in R3. Asian-European Journal of Mathematics, 5(01):1250004, 2012.
[32] J. Kellendonk and H. Schulz-Baldes. Quantization of edge currents for continuous magnetic operators. Journal of Functional Analysis, 209(2):388–413, 2004.
[33] M. Ludewig and G. C. Thiang. Cobordism invariance of topological edge-following states.
arXiv preprint arXiv:2001.08339, 2020.
[34] M. Nakahara. Geometry, topology and physics. CRC Press, 2003.
[35] A. J. Niemi and G. W. Semenoff. Spectral asymmetry on an open space. Physical Review
D, 30(4):809, 1984.
[36] E. Prodan and H. Schulz-Baldes. Bulk and boundary invariants for complex topological
insulators: From K-Theory to Physics. Springer Verlag, Berlin, 2016.
[37] S. Quinn and G. Bal. Approximations of topological invariants for interface Hamiltonians.
In preparation, 2021.
[38] S. Shankar, M. J. Bowick, and M. C. Marchetti. Topological sound and flocking on curved
surfaces. Physical Review X, 7(3):031039, 2017.
[39] B. Simon. Operator Theory. A Comprehensive Course in Analysis, Part 4. American
Mathematical Society, 92, 2015.
[40] A. Souslov, K. Dasbiswas, M. Fruchart, S. Vaikuntanathan, and V. Vitelli. Topological
waves in fluids with odd viscosity. Physical Review Letters, 122(12):128001, 2019.
[41] C. Tauber, P. Delplace, and A. Venaille. Anomalous bulk-edge correspondence in continuous media. arXiv preprint arXiv:1902.10050, 2019.
[42] C. Tauber, P. Delplace, and A. Venaille. A bulk-interface correspondence for equatorial
waves. Journal of Fluid Mechanics, 868, 2019.
[43] G. Volovik. The Universe in a Helium Droplet. International Series of Monographs on
Physics. OUP Oxford, 2009.
[44] M. Zworski. Semiclassical analysis, volume 138. American Mathematical Soc., 2012.

39

