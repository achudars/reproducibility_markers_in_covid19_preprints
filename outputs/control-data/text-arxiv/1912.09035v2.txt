arXiv:1912.09035v2 [physics.acc-ph] 25 Feb 2020

Modeling and simulation of transverse wakefields in
PWFA
J B B Chen1,2 , D Schulte1 and E Adli2
1
2

CERN, CH-1211 Geneva 23, Switzerland
University of Oslo, Oslo, Norway

E-mail: ben.chen@cern.ch
E-mail: daniel.schulte@cern.ch
E-mail: erik.adli@fys.uio.no
Abstract. A simplified model describing the PWFA (plasma wakefield acceleration)
transverse instability in the form of a wake function parameterized only with an effective cavity
aperture radius a is benchmarked against PIC-simulations. This wake function implies a 1/a4
scaling of the transverse wakefields, which indicates transverse intra-beam wakefields typically
several orders of magnitude higher than in conventional acceleration structures. Furthermore,
the wakefield formalism is utilized to perform a parameter study for a 1.5 TeV plasma wakefield
accelerator, where the constraint on drive beam to main beam efficiency imposed by transverse
wakefields is taken into account. Eventually, a parameter set with promising properties in terms
of energy spread, stability and luminosity per power was found.

1. Introduction
PWFA is one of the most promising novel acceleration technologies able to generate accelerating
gradients in the multi-GV/m level [1]. There are however challenges that still need to be
addressed before this technology can be applied to a future linear collider. Transverse instabilities
caused by transverse wakefields, which are fields generated by a driving particle’s interaction
with the accelerating cavity due to misalignment, are considered one of the main challenges,
as this is known to constrain the drive beam to main beam efficiency in CLIC [2]. Transverse
wakefields in PWFA can be several orders of magnitude larger than in metallic cavities due to
the significantly smaller dimension of a plasma ion bubble, so a good understanding of possible
mitigation methods is therefore necessary for a global parameter optimization for a PWFA-LC
(plasma wakefield acceleration linear collider). One such mitigation method is BNS damping [3],
a well-known technique in RF accelerators, where a correlated energy spread is induced along
the beam to disrupt the coherence buildup of transverse oscillations.
Several conceptual parameter sets for a PWFA-LC have been proposed to identify the main
challenges and base parameters, one example being the Snowmass parameter set [4]. However,
in contrast to CLIC, the effect of transverse wakefields on efficiency has so far not been taken
into account in PWFA-LC parameter studies, even though Lebedev et al. have studied the
relationship between efficiency and instability, and derived an analytical expression [5]. In
this paper, we will conduct a parameter study of the efficiency of a 1.5 TeV plasma wakefield

accelerator using the Snowmass parameter set as a basis, but taking into account transverse
wakefield and the damping effect of energy spread using the approach of a parameter scan.
2. Transverse wake function
Plasma acceleration is very computationally expensive to simulate, hence it is very challenging
to consider the effect of transverse instabilities on efficiency using traditional PIC-codes. Several
studies have proposed simplified models for transverse beam motion in PWFA using coupled
differential equations for the beam and plasma channel centroid [6, 7, 8]. In this paper, we
assume that the transverse forces can be expressed using the wake function formalism [9, 10],
which is used for describing the well-known BBU-instability in RF accelerators, and will allow
for easier comparison with RF accelerators.
In CLIC [11], single beam transverse wakefield for small distances between a driving particle
located at ξ ′ and a witness particle located at ξ is modelled using
W⊥ (ξ ′ − ξ) =

2 ξ′ − ξ
Θ(ξ ′ − ξ),
πε0 a4

(1)

where ε0 is the permittivity in vacuum, a is the accelerating structure iris radius and Θ(ξ) is
the Heaviside step function. The structure iris is however not well-defined for a plasma, but an
effective structure iris [5, 12] can be defined by a = rb (ξ ′ ) + αkp−1 . Here rb (ξ ′ ) is the plasma
bubble radius at the location of the driving particle, α a numerical coefficient on the order of
one, and the plasma skin depth kp−1 accounts for the penetration depth of the electromagnetic
fields. Equation (1) along with the modification a = rb (ξ ′ ) + αkp−1 has been proposed for the
PWFA blowout regime in [12]. In this paper, we adopt this wake function, and use the value
α = 0.75, which is the same value used in [12].
For a beam slice with charge q located at ξ, the transverse wake force per unit charge is given
by a convolution integral
F⊥ (ξ, s)
= −e
q

Zξ

W⊥ (ξ ′ − ξ)λ(ξ ′ )X(ξ ′ , s) dξ ′ ,

(2)

ξH

where e is the elementary charge, ξH is the longitudinal position of the beam head, λ(ξ) is the
longitudinal number density of the main beam and X(ξ, s) is the mean transverse offset of the
beam slice located at ξ.
Equation (2) gives the transverse force along the main beam after a propagation length s, as
is illustrated in figure 1 for a main beam with constant transverse offset propagating along the
ξ-axis.
The evolution of the transverse force at three different beam slices is benchmarked against
QuickPIC [13] simulation results, where λ(ξ) and X(ξ) in equation (2) are extracted from
QuickPIC simulations, and the transverse force predicted by the convolution integral is then
compared against the corresponding fields extracted from QuickPIC results. Figure 2a-2c show
the evolution of the transverse wake on beam slices located 0-2 σz behind the main beam center.
Inside the ion bubble, the transverse fields acting on the main beam consist of the background
ion focusing and intra-beam wakefields, which are similar to dipole fields. To avoid noise, the
dipole fields extracted from QuickPIC are measured on axis. Except for the small disagreement
for negative amplitudes, the model shows a good agreement with simulations.
3. Simplified quasi-static model
A simplified quasi-static [13] model was developed in order to exploit the wake function formalism
to provide an efficient way of studying transverse instabilities in the main beam in the blowout regime of a TeV-scale plasma collider. Similarly to QuickPIC [13], the simplified model

10 8
2.5

10 7

0
-2

Figure 1. The initial transverse force
per unit witness charge F⊥ (ξ, s = 0) for
a main beam with constant transverse
offset calculated with equation (2) and
calculated directly from the output fields
of a QuickPIC simulation measured
on axis.
The longitudinal particle
distribution N (ξ) of the main beam is
also included in the figure. The beam
propagates towards higher values of ξ.

2

-4
1.5
-6
1
-8
0.5
-10
0

-12

-60

10

1.5

-50

-40

7

10 7

10 7

10

4
8

3

1

6

2

0.5

4

1

2

0

0

-0.5

-1
0

50

100

150

200

250

(a) Beam center.

300

0

-1

-2

-2

-4

-3

-6

-4

0

50

100

150

200

250

300

-8

0

50

100

150

200

250

300

(b) One σz behind the beam (c) 2σz behind the beam center.
center.

Figure 2. Evolution of the transverse wake force per unit charge at main beam slices at various
positions along the beam. The fields extracted from QuickPIC are measured on axis.
also utilizes the quasi-static approximation, where it is assumed that the ultra-relativistic beam
evolves over a much longer time scale compared to the plasma. Mathematically, this is described
by the coordinate transformation (x, y, z, t) → (x, y, ξ = z − ct, s = ct). The time derivative can
then be written as
∂ξ ∂
∂s ∂
∂
∂
∂
=
+
= −c
+c .
(3)
∂t
∂t ∂ξ
∂t ∂s
∂ξ
∂s
For an ultra-relativistic beam particle, ∂s ≫ ∂ξ so that ∂t ≈ c∂s .
The main beam is sliced longitudinally into slices with equal thicknesses. Assuming that the
main beam placed inside the plasma ion bubble does not penetrate the plasma bubble boundary
during propagation, we then make the ansatz that the the transverse oscillation of a beam slice
located at ξ can be described by
1
e2
∂2
X(ξ,
s)
+
X(ξ,
s)
=
W (ξ, s),
∂s2
β(ξ, s)2
E(ξ, s) ⊥

(4)

p
where β(ξ, s) = 2γ(ξ, s)/kp is the beta function, and E(ξ, s) = γ(ξ, s)me c2 is the electron
energy of an electron located at ξ, that has been accelerated by the longitudinal field Ez (ξ) for
a distance s. The second term of equation (4) represents the betatron oscillation caused by the
focusing forces of the ion background, while the driving term is attributed to the transverse
wakefields. All the preceding slices contribute to the driving term through the convolution

integral
W⊥ (ξ, s) =

Zξ

W⊥ (ξ ′ − ξ)λ(ξ ′ )X(ξ ′ , s) dξ ′ .

(5)

ξH

The interaction with the plasma and drive beam is represented by the 1/a4 -dependence of
the wake function, and the interaction with the total longitudinal wakefield Ek (ξ). rb (ξ) and
Ek (ξ) are however not described by this model, and was calculated numerically with QuickPIC
in this study. Assuming that rb (ξ) and Ek (ξ) do not change significantly during propagation,
these quantities only needed to be calculated once in QuickPIC.
These equations are then solved numerically with the quasi-static approximation where the
main beam is evolved in s, alternating between propagation with frozen transverse forces and
interaction with the plasma ion bubble through equation (5) and (1), where the transverse forces
are updated.
This model was benchmarked against QuickPIC by comparing the mean transverse offset of
beam slices located 0-2 σz behind the beam center. The results are shown in figure 3a-3c. The
simplified model agrees very well with the simulation results as long as the main assumptions
are valid. The initial offset X0 was chosen to be X0 = 3.65 µm, which is on the order of one σx .
5

3

1.5
4
2

3

1

2

1

0.5

1
0

0

0

-1

-0.5

-1

-1

-2

-1.5

-3

-2
-3
-4

0

50

100

150

200

250

(a) Beam center.

300

0

50

100

150

200

250

300

-5

0

50

100

150

200

250

300

(b) One σz behind the beam (c) 2σz behind the beam center.
center.

Figure 3. Comparison of the mean transverse position of main beam slices located at various
positions. X0 = 3.65 µm.

4. Evaluation of the Snowmass parameter set
Figure 4 compares a results from a QuickPIC simulation against the simplified model using
the Snowmass parameter set. The QuickPIC results show that the Snowmass parameter set
produced a highly unstable main beam, and eventually caused the tail of the main beam to
come into contact with the bubble boundary. It can be seen that the simplified model and
QuickPIC were in good agreement until the beam tail penetrated the plasma at s ≈ 140 cm, as
is depicted in figure 5, after which the transverse motion of the beam could not be described by
equation (4). Such unstable cases are however irrelevant for this study, as this paper aims to
find a set of parameters for a stable main beam, and not to model highly unstable oscillations.
Nonetheless, because of the unstable beam, the Snowmass parameter set has to be modified
in order to achieve stable propagation with high efficiency and low energy spread. This is done
in section 5, where we conduct a parameter study of a 1.5 TeV plasma wakefield accelerator
using the Snowmass parameter set as a basis.

10
5
0
-5
-10
-15
-20
-25
-30

0

100

200

300

Figure 4.
Comparison of the mean
transverse position of the main beam slice
located at the center of the beam. The
Snowmass parameters were used in this
simulation, and resulted in a highly unstable
main beam after the beam tail came into
contact with the bubble boundary, as seen in
figure 5. This transverse motion can thus not
be described with equation (4).

Figure 5. Electron number density ne per unit
initial plasma density n0 and the total longitudinal
electric field Ek (ξ) for s ≈ 140 cm obtained from
QuickPIC simulation with Snowmass parameters.
The plasma electron density has been increased
by a factor 10 in order to highlight the bubble
boundary.

5. Parameter study for a 1.5 TeV plasma wakefield acclerator
5.1. Energy spread, instability and efficiency
For an initially monochromatic beam with N electrons divided into n slices, the variance of
energy is given by
σ 2E =

n
n
2
1 X
1 X
Ni ( Ei − h Ei)2 =
Ni −eEki s + ehEk is ,
N
N
i=1

(6)

i=1

where Ni and Eki are the number of electrons and the total longitudinal field acting on beam
slice i respectively. The relative rms energy spread is then given by
v
u
n
u1 X
2
es
σE
t
Ni hEk i − Eki ,
(7)
=
h Ei
h E0 i − ehEk is N
i=1

where h E0 i is the mean initial energy. In the limit s → ∞, this reduces to
v
u
n
X
2
σE
1 u
t1
=−
Ni hEk i − Eki .
h Ei
hEk i N

(8)

i=1

Thus, by using equation (8), the final energy spread can be extrapolated from the initial
longitudinal field Ek (ξ), again assuming that Ek (ξ) and the longitudinal particle number
distribution do not change significantly during propagation. By extracting Ek (ξ) from QuickPIC
simulation results using various combinations of main beam particle number NMB , rms main
beam beam length σz and beam separation distance ∆ξ, we obtained a series of contour plots
for 2 · 109 ≤ NMB ≤ 1010 that provide an overview over the effect of NMB , σz and ∆ξ on the
energy spread. Three examples of such contour plots are shown in figure 6a-6c. Such an overview

reveals the region of minimum energy spread in the σz -∆ξ plane for various charges, which is
crucial for the study of accelerator parameters. Such contour plots are however limited by the
chosen resolution of the simulations, so that the distance between actual data points in the
σz -direction is 1 µm, and 10 µm in the ∆ξ-direction. This applies to all contour plots in this
paper. Furthermore, due to the simulation resolution, σz was chosen to be ≥ 2 µm.
210

210

18

9

210
15

16

200

8

200

14

200

13

14
7

190

190

12

12

190

11

6

10

180

180
5

9

8

170

170

10

180

8

170

4

7

6

6

160

5

6

7

8

9

10

160

5

(a) NMB = 8 · 109 .

10

160

15

(b) NMB = 9 · 109 .

9

10

11

12

13

14

(c) NMB = 1010 .

Figure 6. Relative rms energy spread vs. beam separation distance ∆ξ and the rms beam
length σz for main beams with various particle numbers NMB . The rest of the parameters are
from Snowmass parameters.
The normalized amplitude [14] defined as
"
 ′ 2 #

n
n
X
X
Xi (s) 2
Xi (s)
2
2
′
+
,
(XNi (s) + XNi (s) ) =
Λ(s) =
σx (s)
σx′ (s)
i=1

(9)

i=1

where
σx (s) =

s

β(s)εNx
,
γ(s)

σx′ (s) =

r

εNx
γ(s)β(s)

(10)

and εNx is the normalized emittance, remains constant in the absence of transverse wakefields.
The normalized amplification factor Λfinal /Λinitial can thus be used to quantify the amplification
of the transverse jitter of the incoming beam.
For a main beam with charge QMB accelerated in the the wake excited by a drive beam with
charge QDB , the drive beam to main beam efficiency is defined as
η=

∆ EMB QMB
,
EDB QDB

(11)

where ∆ EMB is the energy gain of the main beam, EDB is the initial drive beam energy. This
definition considers all the energy of the DB as spent regardless of how much energy has been
extracted. Assuming the drive beam’s energy is fully depleted in a plasma of length Ld , the
efficiency can also be written as
η=

EA Ld QMB
QMB
=T
,
ED Ld QDB
QDB

(12)

where ED is the peak decelerating field of the drive beam and EA is the mean accelerating field
of the main beam and T = EA /ED is the transformer ratio.

5.2. Results
Using the developed framework, the relation between energy spread, instability and efficiency
can now be studied. A main beam parameter scan over 2 · 109 ≤ NMB ≤ 1010 , σz and ∆ξ using
the Snowmass T = 1 parameter set as a basis has been performed to obtain values for σ E/h Ei,
Λ/Λ0 and η. σ E/h Ei and η were calculated from a single QuickPIC time step using equation (8)
and (12) respectively, whereas Λ/Λ0 for a 1.5 TeV accelerator was calculated using the simplified
quasi-static model. We initially assumed that all parameters used in the parameter scan were
able to generate main beams sufficiently stable to satisfy the basic assumptions for the simplified
quasi-static model. Large values of Λ/Λ0 should therefore be ignored in the end results.
The results for NMB = 5 · 109 are shown in figure 9-10, as this particle number resulted in the
most desirable results. Figure 7-9 can be used to identify regions in the σz -∆ξ plane containing
desirable values for σ E/h Ei, Λ/Λ0 and η. An optimal set of parameters for an accelerator would
however require low values for σ E/h Ei and Λ/Λ0 , while high values of η are desirable. These
requirements can be conflicting, so in order to arrive at a reasonable compromise, the data is
combined to obtain an overview shown in figure 10.
210

210
10
9

200

4

200

3.5

8
7

190

3

190
2.5

6
5

180

2

180

4
3

170

1.5

170

1

2

160

1

4

6

8

10

Figure 7. Contour plot of the relative
rms energy spread in the σz -∆ξ plane for
a main beam with 5 · 109 electrons .

160

0.5

4

6

8

10

Figure 8.
Contour plot of the
normalized amplification factor in the
σz -∆ξ plane for a main beam with 5 · 109
electrons.

Figure 10 shows several data points of interest, for instance the point σ E/h Ei = 1.1%,
log(Λ/Λ0 ) = 0.8, η = 37.5% marked with a red circle, which corresponds to σz = 5 µm,
∆ξ = 200 µm. A corresponding plot for the initial electron number density and the longitudinal
field obtained from QuickPIC simulation is shown in figure 11.
These main beam parameters provide improvements over the Snowmass parameter set both
in terms of energy spread and stability, but result in a lower efficiency. These parameters and
results are summarized in table 1, where the energy spread for the Snowmass parameter set has
been re-calculated using the definition (8).
A PWFA multi-TeV accelerator can be envisioned to be used as the main linac for a linear
collider. A core metric of performance for a linear collider is luminosity per power, which scales
√
as L/PAC ∝ η/ σz when beam strahlung has been taken into account, assuming that the
horizontal beam size can be made sufficiently small, and that the vertical beam size is kept
constant [2]. Assuming that this can be achieved for the new parameter set, the luminosity
per power is actually 1.5 times higher than the corresponding value provided by the Snowmass
parameters, even though the new parameter set offers a lower efficiency.

210

45
40

4

200

40

35

35

3

190
30

180

30

2
25

25

170

1
20

20

160

4

6

8

2

10

Figure 9. Contour plot of the efficiency
in the σz -∆ξ plane for a main beam with
5 · 109 electrons.

4

6

8

10

Figure 10. Relation between relative
rms energy spread, normalized amplification factor and efficiency for a main
beam with 5 · 109 electrons. A potential candidate for a new parameter set is
marked with a red circle.

Table 1. Comparison of the Snowmass T = 1 parameter set and the new parameter set.

NMB [109 ]
σz [µm]
∆ξ [µm]
σ E/h Ei [%]
Λ/Λ0
η [%]

Snowmass

New parameters

10
20
187
12
6.7 · 102
50

5
5
200
1.1
6
37.5

Figure 11. Initial electron number
density ne per unit initial plasma
density n0 and the total longitudinal electric field Ek (ξ) obtained
from a QuickPIC simulation with
the new parameters.

6. Conclusion
Even though several conceptual parameter sets for a PWFA-LC have been proposed, no PWFALC studies have so far considered the constraint of efficiency imposed by transverse instabilities.
In this paper, we described the transverse instabilities in PWFA using the wakefield

formalism and benchmarked the results against QuickPIC simulation results. Using the wakefield
formalism, a simplified quasi-static model was developed, and was combined with QuickPIC
simulations in order to model the evolution of the transverse oscillations of the main beam over
a 1.5 TeV PWFA accelerator.
We demonstrated that the Snowmass parameter set was unable to provide stable propagation
for a main beam consisting of electrons, and we performed a parameter scan over the main beam
charge, rms beam length and beam separation distance using the Snowmass parameter set as
a basis. The parameter scan provided a new set of parameters that improved the Snowmass
parameter set in terms of energy spread, stability and luminosity per power. This parameter
study for the main electron beam is however not exhaustive, and did not consider the effects of
beam induced ion motion, which has been shown to mitigate hosing [15]. Furthermore, tolerance
studies still remain to be performed, which will be included in future works.
References
[1] Blumenfeld I et al. 2007 Nature 445 741–4
[2] Aicheler M, Burrows P, Draper M, Garvey T, Lebrun P, Peach K, Phinney N, Schmickler H, Schulte D and
Toge N 2012 A Multi-TeV Linear Collider Based on CLIC Technology: CLIC Conceptual Design Report
CERN Yellow Reports: Monographs (Geneva: CERN)
[3] Balakin V E, Novokhatsky A V and Smirnov V P 1983 VLEPP: Transverse Beam Dynamics Proc., 12th
Int. Conf. on High-Energy Accelerators, HEACC 1983 vol C830811 Fermilab (Batavia, IL: Fermilab) pp
119–120
[4] Adli E, Delahaye J P, Gessner S J, Hogan M J, Raubenheimer T, An W, Joshi C and Mori W 2013
A Beam Driven Plasma-Wakefield Linear Collider: From Higgs Factory to Multi-TeV Proc., 2013
Community Summer Study on the Future of U.S. Particle Physics: Snowmass on the Mississippi (CSS2013)
(Minneapolis, MN)
[5] Lebedev V, Burov A and Nagaitsev S 2017 Phys. Rev. Accel. and Beams 20 ISSN 2469-9888
[6] Huang C et al. 2007 Phys. Rev. Lett. 99(25) 255001
[7] Mehrling T J, Fonseca R A, Martinez de la Ossa A and Vieira J 2017 Phys. Rev. Lett. 118(17) 174801
[8] Mehrling T J, Benedetti C, Schroeder C B, Martinez de la Ossa A, Osterhoff J, Esarey E and Leemans W P
2018 Physics of Plasmas 25 056703
[9] Wilson P B 1989 Introduction to Wake Fields and Wake Potentials Physics of particle accelerators Proc.,
Fermilab Summer School 1987, Cornell Summer School 1988 vol 184 (Fermilab: American Institute of
Physics) pp 525–564
[10] Chao A W 1993 Physics of Collective Beam Instabilities in High-Energy Accelerators (New York: Wiley)
[11] Schulte D 2016 Reviews of Accelerator Science and Technology 09 209–233
[12] Stupakov G 2018 Phys. Rev. Accel. Beams 21(4) 041301
[13] Huang C, Decyk V, Ren C, Zhou M, Lu W, Mori W, Cooley J, Antonsen T and Katsouleas T 2006 Journal
of Computational Physics 217 658 – 679
[14] Aksoy A, Schulte D and Yavas Ö 2011 Phys. Rev. Spec. Top. Accel. Beams 14 084402. 8 p
[15] Mehrling T J, Benedetti C, Schroeder C B, Esarey E and Leemans W P 2018 Phys. Rev. Lett. 121(26)
264802

reserved for figure

