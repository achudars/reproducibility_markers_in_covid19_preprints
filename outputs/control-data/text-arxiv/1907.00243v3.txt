On algebraic extensions and decomposition
of homomorphisms of free groups

arXiv:1907.00243v3 [math.GR] 27 Oct 2020

Noam Kolodner
Abstract
We give a counterexample to a conjecture by Miasnikov, Ventura and Weil, stating that an
extension of free groups is algebraic if and only if the corresponding morphism of their core
graphs is onto, for every basis of the ambient group. In the course of the proof we present a
partition of the set of homomorphisms between free groups which is of independent interest.

1

Introduction

The purpose of this paper is to develop new machinery for the study of morphisms between core
graphs associated with free groups (see definitions in §2). For this purpose, we construct a category
which enriches that of free groups and enables to study surjectivity with respect to arbitrary bases.
The main application we give is a counterexample to a conjecture by Miasnikov, Ventura, and Weil
[MVW07] which was revised by Parzanchevski and Puder [PP14].
Conjecture 1.1 ([MVW07]). Let FY be a free group on the set Y , and let H ≤ K ≤ FY be
subgroups. If the morphism between the associated core-graphs ΓX (H) → ΓX (K) is surjective for
every basis X of FY , then K is an algebraic extension of H.
The converse is indeed true: if H ≤ K is an algebraic extension, then ΓB (H) → ΓB (K) is
indeed onto for any basis B. In [PP14], Parzanchevski and Puder constructed a counterexample for
the conjecture in F2 , the free group on two generators. Their proof relies heavily on idiosyncrasies
of the automorphism group of F2 , and they conjectured that these are the only obstructions,
revising the conjecture in two ways:
Conjecture 1.2 ([PP14]). Let H ≤ K ≤ FY . If for every free extension F 0 of FY and for every
basis X of F 0 the morphism ΓX (H) → ΓX (K) is onto then K is algebraic over H.
Conjecture 1.3 ([PP14]). The original conjecture holds for H ≤ K ≤ FY such that |Y | > 2.
In this paper, we show that both revised forms of the conjecture are false. In fact, we prove a
stronger statement:
Theorem 1.4. The extension hbbaba−1 i < hb, aba−1 i is not algebraic, but for every morphism

ϕ : F{a,b} → FX with
X arbitrary and ϕ(a), ϕ(b) 6= 1, the graph morphism ΓX ϕ hbbaba−1 i →

ΓX ϕ(hb, aba−1 i) is surjective.
Our result naturally raises the question what is the algebraic interpretation (if one exists at all)
of the property of being “onto in all bases”, as the one suggested by the conjectures above turns
out to be false. In addition, the methods which we develop for the analysis of our counterexample
are of independent interest: The first idea is extending the scope of inspection from the category
of automorphisms to a larger category of homomorphisms called FGR (“Free Groups with Restrictions”), which is defined in §3. In the new category we present a recursive decomposition of
morphisms, which in turn enables ones to verify whether the desired property of graphs holds for
all FGR homomorphisms. A second point of interest is the observation of a property of the word
bbaba−1 which ensures that the recursive process ends. This property is defined in §6, and leads to
further questions and applications, for example to solving some forms of equations in free groups.
Acknowledgement. I am grateful to Ori Parzanchevski for his guidance and for carefully reading
and commenting on a draft of this paper. I would also like to thank the referee for the helpful
comments. This research was supported by ISF grant 1031/17 of Ori Parzanchevski.
1

2

Preliminaries

We present the definitions we use in the paper, merging the language of [KM02] and [Sta83].
Definition 2.1 (Graphs). We use graphs in the sense of Serre [Ser77]: A graph Γ is a set V (Γ) of
vertices and a set E (Γ) of edges with a function ι : E (Γ) → V (Γ) called the initial vertex map and
e
an involution : E (Γ) → E (Γ) with e 6= e and e = e. A graph morphism f : Γ → ∆ is a pair of set
E
functions f : E (Γ) → E (∆) and f V : V (Γ) → V (∆) that commute with the structure functions.
A path in Γ is a finite sequence e1 , . . . , en ∈ E (Γ) with ι (ek ) = ι (ek+1 ) for every 1 ≤ k < n. The
path is closed if ι (en ) = ι (e1 ), and reduced if ek+1 6= ek for all k. All the graphs in the paper are
assumed to be connected unless specified otherwise, namely, for every e, f ∈ E (Γ) there is a path
e, e1 , . . . , en , f .
Definition 2.2 (Labeled graphs). Let X be a set and let X −1 be the set of its formal inverses.
We define RX to be the graph with E (RX ) = X ∪ X −1 , V (RX ) = {∗}, x = x−1 and ι (x) = ∗.
An X-labeled graph is a graph Γ together with a graph morphism l : Γ → RX . A morphism of
X-labeled graphs Γ and ∆ is a graph morphism f : Γ → ∆ that commutes with the label functions.
Let P (Γ) be the set of all the paths in Γ, let FX be the free group on X and let P = e1 , . . . , en
be a path. The edge part of the label function lE : E (Γ) → E (RX ) can be extended to a function
l : P (Γ) → FX by the rule l (P ) = l (e1 ) . . . (en ).
A pointed X-labeled graph is an X-labeled graph that has a distinguished vertex called the
base point. A morphism of a pointed labeled graph sends the base point to the base point. This
constitutes a category called X-Grph. For a pointed X-labeled graph Γ we define π1 (Γ) to be
π1 (Γ) = {l (P ) ∈ FX | P is a closed path beginning at the base point} .
Definition 2.3. Let FX be the free group on the set X. We define a category Sub (FX ), whose
objects are subgroups H ≤ FX and there is a unique morphism in Hom (H, K) iff H ≤ K. It is
easy to verify that π1 is a functor from X-Grph to Sub (FX ).
Note: The functor π1 defined above is not the fundamental group of Γ as a topological space.
Rather, if one views Γ and RX as topological spaces and l as a continuous function, then π1 is the
image of the fundamental group of Γ in that of RX under the group homomorphism induced by l.
Definition 2.4 (Folding). A labeled graph Γ is folded if l (e) 6= l (f ) holds for every two edges
e, f ∈ E (Γ) with ι (f ) = ι (e). We notice that there is at most one morphism between two pointed
folded labeled graphs. If Γ is not folded, there exist e, f ∈ E (Γ) such that ι (e) = ι (f ) and
l (e) = l (f ); Let Γ0 be the graph obtained by identifying the vertex ι (e) with ι f , the edges e
with f and e with f . We say Γ0 is the result of folding e and f . The label function l factors through
Γ0 , yielding a label function l0 on Γ0 , and we notice that π1 (Γ) = π1 (Γ0 ).
Definition 2.5 (Core graph). A core graph Γ is a labeled, folded, pointed graph such that every
edge in Γ belongs in a closed reduced path around the base point. Is case of finite graphs this is
equivalent to every v ∈ V (Γ) having deg(v) := |ι−1 (v)| > 1 except the base point which can have
any degree.
Definition 2.6. Let X-CGrph be the category of connected, pointed, folded, X-labeled core
graphs. Define a functor ΓX : Sub (FX ) → X-CGrph that associates to the subgroup H ≤ FX a
graph ΓX (H) (which is unique up to a unique isomorphism) such that π1 (ΓX (H)) = H.
Fact 2.7 ([Sta83, KM02]). The functors π1 and Γ define an equivalence between the categories
X-CGrph and Sub (FX ).
The correspondence between the categories of X-CGrph and Sub (FX ) follows from the theory
of cover spaces. Let us sketch a proof. We regard RX as a topological space and look at the category
of connected pointed cover spaces of RX . This category is equivalent to Sub (FX ), following from
the fact that RX has a universal cover. Let Γ be a connected folded X-labeled core graph, viewed as
a topological space and l as a continuous function. There is a unique way up to cover isomorphism
to extend Γ to a cover of RX . There is also a unique way to associate a core graph to a cover
space of RX . This gives us an equivalence between the category of connected pointed cover spaces
of RX and pointed connected folded X-labeled core graphs.
2

Definition 2.8. By uniqueness of the core graph of a subgroup we can define a functor
Core : X-Grph → X-CGrph that associates to a graph Γ a core graph such that π1 (Core (Γ)) =
π1 (Γ).
Definition 2.9. Let Γ be a graph with a vertex v of degree one which is not the base-point. For
e = ι−1 (v), let Γ0 be the graph with V (Γ0 ) = V (Γ) \ {v} and E (Γ0 ) = E (Γ) \ {e, e}. We say that
Γ0 is the result of trimming e from Γ, and we notice that π1 (Γ) = π1 (Γ0 ).
Remark 2.10. For a finite graph Γ, after both trimming and folding |E (Γ0 )| < |E (Γ)|. If no
foldings or trimmings are possible then Γ is a core graph. This means that after preforming a finite
amount of trimmings and foldings we arrive at Core (Γ). It follows from the uniqueness of Core (Γ)
that the order in which one performs the trimmings and foldings does not matter.
Definition 2.11 (Algebraic extension). Let H ≤ K ≤ FX be subgroups. The subgroup K is said
to be an algebraic extension of H if there exists no proper free factor J of K with H ≤ J < K.
Conjecture 1.1 is the converse to the following:
Fact 2.12 ([MVW07]). If H ≤ K ≤ FX and H ≤ K is an algebraic extension then ΓY (H) →
ΓY (K) is onto for every basis Y of FX .
Another motivation for this conjecture is the fact that in a specific case it is true
Fact 2.13. Let Y be a finite set then FY is algebraic over H iff ΓX (H) → ΓX (FY ) is onto for
every basis X of FY (To see why this is true notice that ΓX (FY ) is a bouquet of circles for every
X).
When we combine Facts 2.12 and 2.13 we get a statement about intermediate subgroups which
is another motivation for the conjecture: Let H ≤ K ≤ FY then K is algebraic over H iff for every
L with K ≤ L ≤ FY and every basis X of L the morphism ΓX (H) → ΓX (K) is onto.

3

The category FGR

Definition 3.1 (Whitehead graph). A 2-path in a graph Γ is a pair (e, f ) ∈ E (Γ) × E (Γ) with
ι (f ) = ι (e) and f 6= e. If Γ is X-labeled, the set


W (Γ) = l (e) , l f | (e, f ) is a 2-path in Γ
forms the set of edges of a combinatorial (undirected) graph whose vertices are X ∪ X −1 , called the
Whitehead graph of Γ. If w ∈ FX is a cyclically reduced word, the Whitehead graph of w as defined
in [Whi36, Sta99] and the Whitehead graph of Γ (hwi) defined here coincide. Let WX = W (RX )
be the set of edges of the Whitehead graph of RX , which we call the full Whitehead graph. Let
x, y ∈ X ∪ X −1 and let {x, y} ∈ WX be an edge. We denote x.y = {x, y} (this is similar to the
notation in [LS01]).
Definition 3.2. A homomorphism ϕ : FY → FX is non-degenerate if ϕ (y) 6= 1 for every y ∈ Y .
Definition 3.3. Let w ∈ FX be a reduced word of length n. Define Γw to be the X-labeled graph
with V (Γw ) = {1, . . . , n + 1} forming a path P labeled by l (P ) = w. Notice that Γw ∼
= Γw−1 .
Definition 3.4. Let ϕ : FY → FX be a non-degenerate homomorphism. We define a functor
Fϕ from Y -labeled graphs to X-labeled graphs by sending y-labeled edges to ϕ (y)-labeled paths.
Formally, let ∆ be a Y -labeled graph and let E0 = {e ∈ E (∆) |l (e) ∈ Y } be an orientation of ∆,
namely, E (∆) = E0 t {e | e ∈ E0 }. For every e ∈ E (∆) let ne ∈ N be the length of the word
ϕ (l (e))F∈ FX plus one. We consider V (∆) as a graph without edges, take
 the disjoint union of
graphs e∈E0 Γϕ(l(e)) t V (∆) and for every e ∈ E0 glue 1 ∈ V Γϕ(l(e)) to ι (e) ∈ V (∆), and

ne ∈ V Γϕ(l(e)) to ι (e) ∈ V (∆). As for functoriality, if f : ∆ → Ξ is a morphism of Y -labeled
graphs, Fϕ f is defined as follows: every edge in Fϕ (∆) belongs to a path Fϕ (e) for some e ∈ E(∆),
and we define (Fϕ f ) (Fϕ (e)) = Fϕ (f (e)).

3

The motivation for Fϕ is topological: thinking of ∆, RY , RX as topological spaces and of
l : ∆ → RY , ϕ : RY → RX as continuous functions, we would like to think of ∆ as an X-labeled
graph with the label function ϕ ◦ l. The problem is that ϕ ◦ l does not send edges to edges, and
we mend this by splitting edges in ∆ to paths representing their images in RX .
Remark 3.5. For H ≤ FY we notice that Core(Fϕ ΓY (H)) = ΓX (ϕ (H)).
Definition 3.6 (Stencil). Let Γ be an Y -labeled graph, and ϕ : FY → FX a non-degenerate
homomorphism. We say that the pair (ϕ, Γ) is a stencil iff Fϕ (Γ) is a folded graph. Notice that
if Γ is not folded, then Fϕ (Γ) is not folded for any ϕ.
Definition 3.7. Let τ : FX \ {1} → X ∪ X −1 be the function returning the last letter of a reduced
word. For reduced words u, v in a free group, we write u · v to indicate that there is no cancellation
in their concatenation, namely τ (u) 6= τ (v −1 ).
We leave the proof of Lemmas 3.8 and 3.10 as easy exercises for the reader.
Lemma 3.8. Let Γ be an Y -labeled graph and ϕ : FY → FX a non-degenerate homomorphism.
−1
Then (ϕ, Γ) is a stencil iff Γ is folded and for every x.y ∈ W (Γ) we have ϕ (x) · ϕ (y)
(i.e.
τ (ϕ (x)) 6= τ (ϕ (y))).
Proposition 3.9. Let ϕ : FZ → FY and ψ : FY → FX be non-degenerate homomorphisms. The
equality Fψ◦ϕ = Fψ ◦ Fϕ holds iff (ψ, Γϕ(x) ) is a stencil for every x ∈ Z.
Proof. As Fϕ is defined by replacing edges by paths and gluing, it is enough to consider the graph
Γx with a single edge labeled x ∈ Z. Both Fψ◦ϕ (Γx ) and Fψ ◦Fϕ (Γx ) are paths whose labels equal
ψ (ϕ (x)), but Fψ◦ϕ (Γx ) is always folded whereas Fψ ◦Fϕ (Γx ) may not be. In fact, Fϕ (Γx ) = Γϕ(x)
and so by definition Fψ ◦ Fϕ (Γx ) is folded iff (ψ, Γϕ(x) ) is a stencil.
Lemma 3.10. Let ϕ and ψ be homomorphism as in Proposition 3.9 (such that Fψ◦ϕ = Fψ ◦ Fϕ )
and let x ∈ Z. Then τ ψ (ϕ (x)) = τ ψ (τ ϕ (x)).
Definition 3.11 (FGR). The objects of the category Free Groups with Restrictions (FGR) are
pairs (Y, N ) where Y is a set of “generators” and N ⊆ WX a set of “restrictions”. A morphism
ϕ ∈ Hom ((Y, N ) , (X, M )) is a group homomorphism ϕ : FY → FX with the following properties:
(i)
(ii)
(iii)
(iv)

For every x ∈ Y , ϕ (x) 6= 1 (ϕ is non-degenerate).
For every x ∈ Y , W (Γϕ(x) ) ⊆ M .
For every x.y ∈ N , ϕ(x) · ϕ(y)−1 (i.e. τ (ϕ (x)) 6= τ (ϕ (y))).
For every x.y ∈ N , τ (ϕ (x)) .τ (ϕ (y)) ∈ M .1

A main motivation for this definition is the second part of the next Proposition.
Proposition 3.12. 1. FGR is a category, i.e. composition of morphisms is a morphism.
2. Any two composable FGR morphisms ϕ, ψ satisfy Fψ◦ϕ = Fψ ◦ Fϕ .
ϕ

ψ

Proof. Let (X1 , N1 ) −→ (X2 , N2 ) −→ (X3 , N3 ). For any x ∈ X1 we have W (Γϕ(x) ) ⊆ N2 since ϕ
satisfies (ii). Since ψ satisfies (iii), (ψ, Γϕ(x) ) is a stencil, so that Fψ◦ϕ = Fψ ◦Fϕ by Proposition 3.9.
This also implies len ψ(ϕ (x)) ≥ len ϕ (x) ≥ 1, so that ψ ◦ϕ satisfies (i). As Γψ◦ϕ(x) = Fψ (Γϕ(x) ),
we have
i 
 h[
W Γψ◦ϕ(x) =
W (Γψ(z) ) ∪ τ ψ (z) .τ ψ (y) | z.y ∈ W (Γϕ(x) )
z.y∈W (Γϕ(x) )

The part in [ ] is contained in N3 since ψ satisfies (ii), and the rest is contained in N3 since ϕ
satisfies (ii) and ψ satisfies (iv), hence ψ◦ϕ satisfies (ii). Finally, whenever x.y ∈ N1 , it follows from
(iv) for ϕ that τ ϕ (x) .τ ϕ (y) ∈ N2 , and from (iv) for ψ that τ ψ(τ ϕ(x)).τ ψ(τ ϕ(y)) ∈ N3 . Using
Lemma 3.10 we see that τ ψ(ϕ(x)).τ ψ(ϕ(y)) ∈ N3 , hence ψ◦ϕ satisfies (iv), and thus also (iii).
Lemma 3.13. An FGR morphism ϕ : (Y, N ) → (X, M ) is an FGR-isomorphism iff ϕ|Y ∪Y −1 : Y ∪
Y −1 → X ∪ X −1 is a bijection that commutes with inversion and M = {ϕ(x).ϕ(y) | x.y ∈ N }.
1 Technically,

(iv) implies (iii), as M ⊆ WY and x.x ∈
/ WY .

4

Proof. We show that if ϕ : (Y, N ) → (X, M ) is an FGR-isomorphism then ϕ|Y ∪Y −1 : Y ∪ Y −1 →
X ∪ X −1 , and the rest is immediate. Let ϕ and ψ be composable FGR morphisms. As ψ, Γϕ(x)
is a stencil, for every x ∈ Y we have len (ψ ◦ ϕ (x)) ≥ len (ϕ (x)). Let x ∈ Y and let ϕ be an
isomorphism and ψ its inverse. So len (ϕ (x)) ≤ len (ψ ◦ ϕ (x)) = len (x) = 1, and on the other
hand ϕ (x) 6= 1 implies len (ϕ (x)) = 1, namely ϕ (x) ∈ X ∪ X −1 .

3.1

Partition of Hom in FGR

Let X be a countably infinite set, Y a finite set and (Y, NY ) an FGR object. We present a
recursive partition of Hom ((Y, NY ), (X, WX )). The ultimate goal of this partition is decomposing
free group morphisms FY → FX , and we notice that Hom ((Y, ∅) , (X, WX )) are all the nondegenerate homomorphisms in Hom (FY , FX ). In order to perform this recursive process we need
to consider morphisms with a general restriction set NY in the domain, but it is not necessary
to consider a general NX in place of WX (and in fact, the method presented does not work for a
general restriction set NX ).
Let ϕ ∈ Hom((Y, NY ), (X, WX )). If x.y ∈ NY then ϕ(x) · ϕ(y −1 ) by definition. Let x.y ∈
WY \NY . There are five possible types of cancellation in the product ϕ(x)ϕ(y −1 ). Denote u =
ϕ (x), v = ϕ (y), and let t be the maximal subword canceled in uv −1 , so that u = u0 · t, v = v0 · t,
and uv −1 = u0 · v0−1 . The five types of cancellation are:
1.
2.
3.
4.
5.

No cancellation, namely t = 1.
u and v −1 do not absorb one another, namely t, u0 , v0 6= 1 and uv −1 = u0 · v0−1 .
u absorbs v −1 , namely t 6= 1, v0 = 1, u0 6= 1 and uv −1 = u0 .
v −1 absorbs u, namely t 6= 1, v0 6= 1, u0 = 1 and uv −1 = v0−1 .
u and v −1 cancel each other out, namely u = v.

If y = x−1 then only the first two types can occur, and if x−1 .y −1 ∈ NY only the first
four. For ϕ ∈ Hom ((Y, NY ), (X, WX )) and x.y ∈ WY \NY such that ϕ(x)ϕ(y −1 ) is of cani
∈
cellation type i, we define an FGR object (Ui , NUi ) and a so-called folding morphism ψx.y
i
. Namely, there is an FGR morphism
Hom((Y, NY ), (Ui , NUi )), such that ϕ factors through ψx.y
i
i
ϕ0 ∈ Hom ((Ui , NUi ), (X, WX )) with ϕ = ϕ0 ◦ ψx.y
. We describe Ui , NUi , ψx.y
, ϕ0 for each type:
1
= Id, NU1 = NY ∪ {x.y}, and ϕ0 = ϕ.
1. U1 = Y , ψx.y
2. There are two cases here, depending on whether x = y −1 or not: 
2
2
x 6= y −1 : U2 = Y t {s} and NU2 = τ ψx.y
(r).τ ψx.y
(z)|r.z ∈ NY ∪ x.s−1 , y.s−1 , x.y where


z=x

u0

v
z=y
0
ϕ0 (z) =
t
z=s



ϕ (z) z ∈ U2 \{x±1 , y ±1 , s±1 }.



xs z = x
2
ψx.y (z) = ys z = y


z
z ∈ Y \{x±1 , y ±1 }

2
2
(z)|r.z ∈ NY } ∪ {x.s−1 , y.s−1 , x.y} where
x = y −1 : U2 = Y t {s} and NU2 ={τ ψx.y
(r).τ ψx.y

(

z=x
u0
s−1 xs z = x
2
0
ψx.y
(z) =
ϕ
(z)
=
t
z=s

z
z ∈ Y \{x±1 }

ϕ (z) z ∈ U2 \{x±1 , s±1 }.

 3

3
3. U3 = Y and NU3 = τ ψx.y
(r) .τ ψx.y
(z) |r.z ∈ NY ∪ x.y −1 where
(
(
xy z = x
u0
z=x
3
0
ψx.y (z) =
ϕ (z) =
z
z ∈ Y \{x±1 }
ϕ (z) z ∈ U3 \{x±1 }.
 4

4
4. U4 = Y and NU4 = τ ψx.y
(r) .τ ψx.y
(z) |r.z ∈ NY ∪ x−1 .y where
(
(
yx z = y
v0
z=y
4
0
ψx.y (z) =
ϕ (z) =
±1
z
z ∈ Y \{y }
ϕ (z) z ∈ U4 \{y ±1 }.
5

 5
5
5. U5 = Y − {y} and NU5 = τ ψx.y
(r) .τ ψx.y
(z) |r.z ∈ NY where
(
x z=y
5
ψx.y (z) =
ϕ0 (z) = ϕ (z) ∀z ∈ U5 .
z z ∈ Y \{y ±1 }
i∗
With x.y fixed, let ψx.y
: Hom ((Ui , NUi ) , (X, WX )) → Hom ((Y, NY ) , (X, WX )) be the induced
0
0
i
function ϕ 7→ ϕ ◦ ψx.y . We obtain that Hom ((Y, NY ) , (X, WX )) can be presented as a disjoint
union
G5
i∗
Hom ((Y, NY ) , (X, WX )) =
ψx.y
(Hom ((Ui , NUi ) , (X, WX ))) .
i=1

For every (Ui , NUi ), if NUi 6= WUi we continue recursively, choosing an edge x.y ∈ WUi \NUi and
partitioning Hom ((Ui , NUi ), (X, WX )) accordingly. We now show that no matter which edges are
chosen, this process terminates:
Theorem 3.14. Any ϕ ∈ Hom((Y, NY ), (X, WX )) decomposes as ϕ = ϕ0 ◦ ψk ◦ · · · ◦ ψ1 such that
1. The morphisms ψj : Uj−1 → Uj (1 ≤ j ≤ k, U0 = Y ) are folding morphisms.
2. NUk = WUk , and in particular ϕ0 (x) · ϕ0 (y)−1 for x 6= y ∈ Uk ∪ Uk−1 .
Proof. Let O be the collection of all FGR morphisms from
P some (Y, NY ) with Y finite into (X, WX ).
Define a height function h : O → N × N by h (ϕ) =
y∈Y len (ϕ (y)) , |WY \NY | , and consider
N × N with the lexicographic order. It is straightforward to verify that h (ϕ0 ) < h (ϕ) for every
i
i
. Thus, the decomposition process ends in a finite amount
and ϕ = ϕ0 ◦ ψx.y
folding morphism ψx.y
of steps.
Proposition 3.15 (The triangle rule). Let (Y, NY ) be an FGR object, and x.y ∈ NY and z ∈
Y ∪ Y −1 be such that z.y, z.x ∈ WY \NY . Then
1∗
1∗
Hom ((Y, NY ) , (X, WX )) = ψz.y
(Hom ((Y, NY1 ) , (X, WX ))) ∪ ψz.x
(Hom ((Y, NY2 ) , (X, WX )))

(not a disjoint union), where NY1 = NY ∪ {z.y} and NY2 = NY ∪ {z.x}.
Proof. Let ϕ : (Y, NY ) → (X, WX ). As τ (ϕ (x)) = τ (ϕ (z)) = τ (ϕ (y)) contradicts x.y ∈ NY , either
1
1
.
or ϕ = ϕ0 ◦ψz.x
τ (ϕ (x)) 6= τ (ϕ (z)) or τ (ϕ (y)) 6= τ (ϕ (z)), hence ϕ decomposes as ϕ = ϕ0 ◦ψz.y

3.2

The Core functor

The flowing easy claim leads to some very helpful observations.
Claim 3.16. Let Γ → ∆ be a surjective graph morphism. Let Γ0 be a graph resulting from folding
two edges in Γ, and ∆0 the pushout of Γ0 ← Γ → ∆ (which is obtained by folding the images of
these edges in ∆, if they are different from one another [Sta83]). Then Γ0 → ∆0 is surjective.
Let Γ be a finite Y -labeled graph. One obtains CoreΓ by a finite sequence of folding and
trimming, and one can perform foldings first and only then trimmings, as when a folded graph
is trimmed it remains folded. Following the claim, if Γ → ∆ is a surjective graph morphism and
CoreΓ is obtained from Γ without trimming then CoreΓ → Core∆ is also surjective.
Corollary 3.17. If Γ is a core graph and (ϕ, Γ) a stencil, then Fϕ (Γ) is a core graph, namely,
CoreFϕ (Γ) = Fϕ (Γ). If Γ, ∆ are core graphs, (ϕ, Γ) is a stencil and Γ → ∆ is onto, then
CoreFϕ (Γ) → CoreFϕ (∆) is onto.
We recall a Lemma from [PP14]:
Lemma 3.18 ([PP14]). Let Γ be a finite X-labeled graph such that for every vertex v, except for
possibly the base-point, there are e, e0 ∈ ι−1 (v) with l(e) 6= l(e0 ). Then CoreΓ is obtained from Γ
by foldings alone (i.e. without trimming).
Corollary 3.19. Let H ≤ K ≤ FY be subgroups such that there is a non-trivial
cyclically reduced

word in H. If the morphism ΓY (H) → ΓY (K) is onto then ΓY uHu−1 → ΓY uKu−1 is onto
for every u ∈ FY .
6

Proof. Let u ∈ FY be a reduced word. We construct the graph ΓuY (H) by taking the graph
ΓY (H) t Γu , gluing len(u) + 1 ∈ V (Γu ) to the base point of ΓY (H) and setting the new base point
to be 1 ∈ V (Γu ). We notice that π1 (ΓuY (H)) = uHu−1 and that ΓuY (H) → ΓuY (K) is onto. Since
H and K contain a cyclically reduce word the degrees of the base points of ΓY (H) and ΓY (K)
are at least two. From this we conclude that both ΓuY (H) and ΓuY (K) satisfy the conditions of
Lemma 3.18. Finally an inductive application of Claim 3.16 gives the result.

4

Basis-independent surjectivity

Returning to Conjectures 1.1-1.3, recall that for H ≤ K ≤ FY , we seek to show that for every free
extension FX of FY and every ϕ ∈ Aut (FX ) the graph morphism ΓX (ϕ (H)) → ΓX (ϕ (K)) is surjective. Without loss of generality we may take X, from now on, to be a fixed countably infinite set,
and assume Y ⊆ X. In Theorem 1.4 we even consider the set of non-degenerate homomorphisms
Hom ((Y, ∅) , (X, WX )): this includes all injective homomorphisms FY ,→ FX , which in turn include all the restrictions of automorphisms of FX . Using Remark 3.5 we translate the problem to
showing that all the graph morphisms {CoreFϕ (ΓY (H) → ΓY (K)) | ϕ ∈ Hom ((Y, ∅) , (X, WX ))}
are surjective. This is a special case of the following problem.
Problem 4.1. Given a morphism Γ → ∆ between two U -labeled core graphs, and an FGR object
(U, NU ), we call the pair (Γ → ∆, (U, NU )) a surjectivity problem. We say that the problem resolves
positively if all the morphisms in the set P = {CoreFϕ (Γ → ∆) | ϕ ∈ Hom ((U, NU ) , (X, WX ))}
are surjective. Note that taking (U, NU ) = (Y, ∅) we recover the problem of surjectivity w.r.t.
every non-degenerate ϕ : FU → FX , and taking (U, NU ) = (Y, W (Γ)) we obtain a trivial problem.
Let us give a simple criterion for showing that one instance of Problem 4.1 is contained in
another, or that the problems are equivalent. For U 0 -labeled core graphs Γ0 , ∆0 and ψ : (U, NU ) →
(U 0 , NU 0 ) an FGR morphism such that Fψ (Γ → ∆) = Γ0 → ∆0 ,
{CoreFϕ (Γ0 → ∆0 ) | ϕ ∈ Hom ((U 0 , NU 0 ) , (X, WX ))}
= {CoreFϕ ◦ Fψ (Γ → ∆) | ϕ ∈ Hom ((U 0 , NU 0 ) , (X, NX ))}
= {CoreFϕ◦ψ (Γ → ∆) | ϕ ∈ Hom ((U 0 , NU 0 ) , (X, NX ))}
⊆ {CoreFϕ (Γ → ∆) | ϕ ∈ Hom ((U, NU ) , (X, NX ))} ,
so that the problem (Γ0 → ∆0 , (U 0 , NU 0 )) is contained in (Γ → ∆, (U, NU )). If ψ is an FGRisomorphism, then the two problems are equivalent.
Remark 4.2. Following corollary 3.19 it is enough to consider surjectivity problems where π1 (Γ)
contains a cyclically reduced word: otherwise, one can examine the graph of a conjugate of π1 (Γ)
that contains a cyclically reduced word.
Definition 4.3. Let Γ be a Y -labeled folded graph. An FGR object (Y, NY ) is said to be a stencil
space of Γ if W (Γ) ⊆ NY . The reason for the name is that for any object (X, NX ) and morphism
ϕ ∈ Hom ((Y, NY ), (X, NX )), the pair (ϕ, Γ) is a stencil.
We show a method for determining whether all the morphisms in a problem (Γ → ∆, (U, NU ))
are surjective. We distinguish three cases:
1. Γ → ∆ is not surjective: clearly P resolves negatively.
2. Γ → ∆ is surjective and W (Γ) ⊆ NU , i.e. (U, NU ) is a stencil space of Γ: following Corollary
3.17, P resolves positively.
3. Γ → ∆ is surjective and W (Γ) \NU 6= ∅: in this case we cannot resolve P immediately. We
call this an ambiguous case.
When (Γ → ∆, (U, NU )) is an ambiguous case, we cover it by five new problems, according to the

7

partition of Hom presented in §3.1: For any x.y ∈ W (Γ) \NU we have
{CoreFϕ (Γ → ∆) | ϕ ∈ Hom ((U, NU ) , (X, NX ))}
[5
i
(Γ → ∆) | ϕ ∈ Hom ((Ui , NUi ) , (X, WX ))}
= i=1 {CoreFϕ◦ψx.y
[5
i
(Γ → ∆) | ϕ ∈ Hom ((Ui , NUi ) , (X, WX ))}
= i=1 {CoreFϕ ◦ Fψz.y
[5
i
(Γ → ∆)) | ϕ ∈ Hom ((Ui , NUi ) , (X, WX ))} ,
= i=1 {CoreFϕ (CoreFψz.y
where the last equality follows
 from Remark 3.5. Thus we obtain five different subproblems
i
(Γ → ∆) , (Ui , NUi ) , and P resolves positively iff all the five subproblems do so. If
CoreFψz.y
one of these five problems is of case 1 then (Γ → ∆, (U, NU )) resolves negatively, if all are of case
2 then (Γ → ∆, (U, NU )) resolves positively, and otherwise we continue recursively and split each
ambiguous case into five sub-subproblems. We now give a toy example to show how this process
may end.
Example 4.4. Let P be the surjectivity
problem with U = {x, y}, NU = {x.y −1 , x−1 .y,

−1 −1
−1
−1 −1
y .x , x.x }, Γ = ΓU xyx y
(the commutator) and ∆ = ΓU (hx, yi). The extension
−1 −1
xyx y
< hx, yi is algebraic so we know that this surjectivity problem resolves positively. We
will show how one can conclude this using the method presented above. We notice that Γ  ∆
and x.y ∈ W (Γ) \NU , so P is an ambiguous case. We split into five subproblems (some of the
calculations are explicit and some omitted and left to the reader):

1
1. P1 : ψx.y
= Id, U1 = U, NU1 = x.y −1 , x−1 .y, y −1 .x−1 , x.x−1 , x.y , Γ1 = Γ, ∆1 = ∆. The
problem P1 resolves positively as (U1 , NU1 ) is a stencil space of Γ1 and Γ1  ∆1 .
 −1 −1
xt
2
2. P2 : ψx.y
: x7y7→
t.y , x .t, y −1 .x−1 , x.t−1 , y.t−1 , x.y ,Γ2 =
U2 =
→yt , U2 = {x, y, t} , N

−1
−1
2
2
= ΓU2 xtyx−1 t−1 y −1 , ∆2 = ΓU2 (hxt, yti). Again
CoreFψx.y
(Γ) = ΓU2 ψx.y xyx y
P2 resolves positively as (U2 , NU2 ) is a stencil space of Γ2 and Γ2  ∆2 .
 −1 −1
→x
3
: x7y7→
, x .x, y −1 .x−1 , y.x−1 , Γ3 = Γ  ∆ = ∆3 , and
3. P3 : ψx.y
yx , U3 = U , NU3 = x.y
x.y ∈ W (Γ3 ) \NU3 , so this is an ambiguous case.
 −1 −1
→xy
4
: x7y7→
, x .y, y −1 .x−1 , x.y −1 , Γ4 = Γ  ∆ = ∆4 , and
4. P4 : ψx.y
y , U4 = U , NU4 = y.y
x.y ∈ W (Γ4 ) \NU4 so this is an ambiguous case.
5. This case does not occur because x−1 .y −1 ∈ NU .
We notice first that the FGR-isomorphism x ↔ y gives an equivalence between P4 and P3 , and
second, that P3 is identical to the original P! Now, it may seem that we are trapped in an
infinite self-referential loop: P resolves positively if P resolves positively. Thankfully, Theorem
3.14 rescues us from this nightmare. Let ϕ ∈ Hom ((U, NU ) , (X, WX )). We decompose ϕ by x.y
recursively, mirroring the splitting of the four subproblems. Because the decomposition of the
morphism via FGR is finite, it can loop through problems 3 and 4 only a finite number of times
until it arrives at a stencil space equivalent to P1 or P2 . Since P1 and P2 resolve positively, we
conclude that so does P.
Not all surjectivity problems end with equivalent ambiguous problems. In some cases this
process produces more and more different ambiguous problems and therefore the algorithm does
not end with a conclusive answer. In the case of the counterexample (§5), after a fair amount of
splitting we end up with ambiguous cases equivalent to or contained in problems we have previously
encountered. In Section §6 we discuss a property of the graph Γ in a problem P that is a necessary
condition for this process to end.

4.1

Change of coordinates

With X and (Y, NY ) as before, in P = {CoreFϕ (Γ → ∆) | ϕ ∈ Hom ((Y, NY ) , (X, WX ))} there
can be many repetitions, as different homomorphisms ϕ may give rise to the same graph morphism
CoreFϕ (Γ → ∆). We can exploit this in a way which shortens calculations significantly in §5.

8

Definition 4.5. A change of coordinates consists of
1. FGR objects (V, NV ), (U1 , N1 ), . . . , (Un , Nn ),
2. a group homomorphism σ : FV → FY (not necessarily an FGR
morphism),
3. an FGR morphism ψi : (V, NV ) → (Ui , Ni ) for every i,
4. an FGR morphism σi : (Y, NY ) → (Ui , Ni ) for every i,

>Y
V

>X

σi


Ui

ψi

such that
1.
2.
3.
4.

ϕ

σ

ϕ0

π1 (∆) ≤ Im σ,
σ ∗ : ϕ 7→ ϕ ◦ σ takes Hom ((Y, NY ) , (X, WX )) to Hom ((V, NV ) , (X, WX )),
σi ◦ σ = ψi for every i,
for every ϕ ∈ Hom ((Y, NY ), (X, WX )) there is an index i and a morphism ϕ0 ∈
Hom ((Ui , Ni ) , (X, WX )) such that ϕ ◦ σ = ϕ0 ◦ ψi .

Proposition 4.6. The problem (Γ → ∆, (Y, NY )) resolves
(CoreFσi (Γ → ∆) , (Ui , Ni )) resolves positively for every i.

positively

if

and

only

if

Note that not all FGR morphisms in Hom ((Y, NY ) , (X, WX )) necessarily factor through one
of the σi , meaning there could be ϕ ∈ Hom ((Y, NY ) , (X, WX )) (as is the case in §5) with no
decomposition as ϕ = ϕ0 ◦ σi – this is what makes the new set of problems potentially simpler.
Proof. Let π1 (Γ) = H and π1 (∆) = K.
The morphisms ψi induce functions
∗
ψ
:
Hom
((U
,
N
)
,
(X,
W
))
→
Hom
((V,
N
)
,
(X,
W
)),
and conditions 2, 3, 4 imply 5 : Im σ ∗ =
i
i
X
V
X
Si
∗
i Im ψi . As Γ → ∆ means that H ≤ K, for every homomorphism ϕ : FY → FX we have
ϕ (H) ≤ ϕ (K), hence there is a unique graph morphism ΓX (ϕ (H)) → ΓX (ϕ (K)). We notice
that:
P = {CoreFϕ (ΓY (H) → ΓY (K)) |ϕ ∈ Hom ((Y, NY ) , (X, WX ))}
= {ΓX (ϕ (H)) → ΓX (ϕ (K)) |ϕ ∈ Hom ((Y, NY ) , (X, WX ))}


1 
= ΓX ϕ ◦ σ σ −1 (H) → ΓX ϕ ◦ σ σ −1 (K) |ϕ ∈ Hom ((Y, NY ) (X, WX ))
[ 
5
=
ΓX (ϕ0 ◦ ψi (σ −1 (H))) → ΓX (ϕ0 ◦ ψi (σ −1 (K)))|ϕ0 ∈ Hom ((Ui , Ni ) , (X, WX ))
[i 

=
CoreFϕ0 ΓUi (ψi (σ −1 (H))) → ΓUi (ψi (σ −1 (K))) |ϕ0 ∈ Hom ((Ui , Ni ) , (X, WX ))
i
[ 

3
=
CoreFϕ0 ΓUi (σi ◦ σ(σ −1 (H))) → ΓUi (σi ◦ σ(σ −1 (K))) |ϕ0 ∈ Hom ((Ui , Ni ) , (X, WX ))
i
[
1
=
{CoreFϕ0 (ΓUi (σi (H)) → ΓUi (σi (K))) |ϕ0 ∈ Hom ((Ui , Ni ) , (X, WX ))}
i
[
=
{CoreFϕ0 (CoreFσi (Γ → ∆)) |ϕ0 ∈ Hom ((Ui , Ni ) , (X, WX ))} .
i

5

The counterexample

In this section we prove Theorem 1.4. showing that H = hbbaba−1 i and K = hb, aba−1 i constitute
a counterexample to Conjectures 1.1, 1.2, 1.3.
Theorem (1.4). The extension H ≤ K is not algebraic, but for every morphism ϕ : F{a,b} → FX
with X arbitrary and ϕ(a), ϕ(b) 6= 1, the graph morphism ΓX (ϕ (H)) → ΓX (ϕ(K)) is surjective.
First, H is a proper free factor of K, so in particular H ≤ K is not an algebraic extension.
Following Section §4, we need to show that the problem Γ{a,b} (H) → Γ{a,b} (K) , ({a, b} , ∅)
resolves positively. By a change of coordinate (Proposition 4.6) we replace this problem with eight
problems that are easier to analyze. Let (V, NV ) = ({α, β} , ∅), and
σ : F{α,β} → F{a,b} ,

σ (α) = b,

σ (β) = aba−1 .

We notice that
 H < K ≤ Im σ. For any non-degenerate ϕ : F{a,b} → FX , the words ϕ (b) = ϕ◦σ (α)
−1
and ϕ aba
= ϕ ◦ σ (β) are conjugate, hence there exist reduced words x, y, u, v ∈ FX such that
9

ϕ(b) = x · u · v · x−1 , ϕ(aba−1 ) = y · v · u · y −1 (in particular, vu and uv are cyclically reduced). By
non-degeneracy we can also assume u 6= 1, and if v = 1 then u is cyclically reduced. We perform
a change of coordinates according to the eight possible cases, with (Ui , Ni ), ψi and σi being:
# x
y
v
1 =1 =1 =1
2 6= 1 =1 =1
3 =1 6= 1 =1
4

6= 1 6= 1 =1

5
6
7

=1 =1 6= 1
6= 1 =1 =
6 1
=1 6= 1 =
6 1

8

6= 1 6= 1 6= 1

Ui
{u}
{y, u}
{x, u}

Ni
ψi (α), ψi (β)
σi (a), σi (b)
{u.u−1 }
u, u
u, u
{y.u−1 , u.y, u.u−1 }
u, yuy −1
y, u
−1
−1
−1
−1
xux , u
x , xux−1
{x.u−1 , u.x, u.u−1 }
x.u , u.x, u.u ,
{x, u, y}
xux−1 , yuy −1
yx−1 , xux−1
y.u−1 , u.y, y.x
{v, u}
{v.u−1 , u.v −1 }
uv, vu
u−1 , uv
−1
−1
−1
−1
{v, u, y} {v.u , u.v , y.v , u.y}
uv, yvuy
yv, uv
−1
−1
−1
−1
−1 −1
{v, u, x} {v.u
,
u.v
,
x.u
,
v.x}
xuvx
,
vu
u
x
, xuvx−1
 −1

−1
−1
v.u , u.v , x.u ,
{v, u, y, x}
xuvx−1 , yvuy −1 yu−1 x−1 , xuvx−1
v.x, y.v −1 , u.y

For every 1 ≤ i ≤ 8 we denote Γi = Γ (σi (H)) and ∆i = Γ (σi (K)). We obtain eight problems,
and we proceed to split them and identify all the stencil spaces. We index the cases in the following
manner: if Case i is not a stencil space it splits into five cases Case i.1, i.2, . . . i.5. For each case, the
morphism ψi.j is the folding morphism this subset of morphisms factors through. The co-domain
of ψi.j is the FGR object (Ui.j , Ni.j ), and the graphs are indexed by Γi.j = CoreFψi.j (Γi ) and
∆i.j = CoreFψi.j (∆i ), and the ∆ graphs are depicted in Figure 5.1. In each case either W (Γi )\Ni
is empty, hence (Ui , Ni ) is a stencil space of Γi and we can resolve the subproblem, or it is not
empty, and then we continue splitting. Remark 4.2 allows us to conjugate, or equivalently to
change the base points of the graphs.
Case 5. Here Γ5 = Γ(huvuvvui)  ∆5 and W (Γ5 ) \N5 = {u.u−1 , v.v −1 }. We split by u.u−1 .
1
−1
Case 5.1. ψ5.1 = ψu.u
, u.v −1 , u.u−1 }, Γ5.1 = Γ5 and ∆5.1 = ∆5 (hence Γ5.1 
−1 , N5.1 = {v.u
−1
∆5.1 ). W (Γ5.1 ) \NU5.1 = {v.v } (so we must split by v.v −1 ).
1
−1
Case 5.1.1. ψ5.1.1 = ψv.v
, u.v −1 , u.u−1 , v.v −1 }. Again Γ5 = Γ5.1.1 , ∆5.1.1 = ∆5
−1 , N5.1.1 = {v.u
and W (Γ5.1 ) \N5.1 = ∅, hence the subcase resolves positively.
2
−1
−1
−1
−1 −1 −1
−1
Case 5.1.2. ψ5.1.2 = ψv.v
 −1 , v 7→ t vt, N5.1.2 = {t.u , u.t, u.u , v.t , t .v , v.v }; Γ5.1.2 =
−1
−1
Γ ut vtut vvtu  ∆5.1.2 and W (Γ5.1.2 ) \N5.1.2 = ∅ hence the subcase resolves positively.
2
−1
−1
−1 −1 −1
Case 5.2. ψ5.2 = ψu.u
−1 ,
 u 7→ t ut, N5.2 = {v.t, u.t , u.u , t .u }; Γ5.2
−t
−1
−1
Γ t utvt utvvt ut
is not cyclically reduced so we conjugate and set Γ5.2
Γ utvt−1 utvvt−1 u  ∆5.2 and W (Γ5.2 ) \N5.2 = {v.v −1 }. We split by v.v −1 .

=
=

1
−1
Case 5.2.1. ψ5.1 = ψv.v
, u.u−1 , t−1 .u−1 , v.v −1 }; Γ5.2.1 = Γ5.2 , ∆5.2.1 = Γ5.2
−1 , NU5.2.1 = {v.t, u.t
and W (Γ5.2.1 ) \N5.2.1 = ∅, hence the subcase resolves positively.
−1
2
, N5.2.2 = {s.t, u.t−1 , u.u−1 , t−1 .u−1 , v.s−1 , s−1 .v −1 , v.v −1 };
Case 5.2.2. ψ5.2.2 = ψv.v
−1 , v 7→ svs
−1
−1
−1
−1
Γ5.2.2 = Γ uts vst uts vvst u  ∆5.2.2 and W (Γ5.2.2 ) \N5.2.2 , hence the subcase resolves positively.

Case 2. Here Γ2 = Γ uuyuy −1  ∆2 and W (Γ2 ) \N2 = {u−1 .y −1 , u.y −1 }. We notice that
u.u−1 ∈ N2 , so we can use the triangle rule (Proposition 3.15) to deduce that every morphism
1
factors through either ψu1 −1 .y−1 or ψu.y
−1 .

Case 2.1. We have two cases: ψ2.1 = ψu1 −1 .y−1 and N2.1 = {y.u−1 , u.y, u.u−1 , u−1 .y −1 }, or ψ2.10 =
1
−1
ψu.y
, u.y, u.u−1 , u.y −1 }. These cases are equivalent, as γ : (U2 , N2.1 ) →
−1 and N2.10 = {y.u
(U2 , N2.10 ) defined by u 7→ u−1 , y 7→ y satisfies Fγ (Γ2.1 → ∆2.1 ) = Γ2.10 → ∆2.10 . Finally,
Γ2.1 = Γ2 , ∆2.1 = ∆2 , and W (Γ2.1 ) \N2.1 = {u.y −1 }.
1
−1
Case 2.1.1. ψ2.1.1 = ψu.y
, u.y, u.u−1 , u−1 .y −1 , u.y −1 }; Γ2.1.1 = Γ2.1 , ∆2.1.1 =
−1 and N2.1.1 = {y.u
∆2.1 and W (Γ2.1.1 ) \N2.1.1 = ∅, hence the subcase resolves positively.

10

2
−1
Case 2.1.2. ψ2.1.2 = ψu.y
y and N2.1.2 = {t.u−1 , u−1 .y, t.y, t.u−1 , u.t−1 ,
−1 , u 7→ ut, y 7→ t

y −1 .t−1 , u.y −1 }; Γ2.1.2 = Γ utuyuty −1 t  ∆2.1.2 and W (Γ2.1.2 ) \N2.1.2 = ∅, hence the
subcase resolves positively.
3
−1
Case 2.1.3. ψ2.1.3 = ψu.y
, N2.1.3 = {y.u−1 , y −1 .y, y −1 .u−1 , u.y} and Γ2.1.3 =
−1 , u 7→ uy

Γ uy −1 uuy −1 y −1
 ∆2.1.3 . We notice that γ : (U5 , N5 ) → (U2.1.3 , N2.1.3 ) defined by
u 7→ u−1 , v 7→ y satisfies Fγ (Γ5 → ∆5 ) is conjugate to Γ2.1.3 → ∆2.1.3 , which implies that
this subproblem is contained in Case 5.
4
−1
Case 2.1.4. ψ2.1.4 = ψu.y
y and N2.1.4 = {y.u−1 , u.y, u.u−1 , u−1 .y −1 }; N2.1.4 = N2.1
−1 , y 7→ u
and Γ2.1.4 = Γ2.1 , ∆2.1.4 = ∆2.1 , so this is the same problem as Case 2.1.

Case 3. Here Γ3 = Γ xuux−1 u  ∆3 and W (Γ3 ) \N3 = {x−1 .u−1 , u.x−1 } We notice that
u.u−1 ∈ N2 so we can split using the triangle rule.

Case 3.1. We have two cases ψ3.1 = ψu1 −1 .x−1 , N3.1 = {x.u−1 , u.x, u.u−1 , u.x−1 } and ψ3.10 =
1
−1
ψu.x
, u.x, u.u−1 , u−1 .x−1 }. These cases are equivalent, as γ : (U3 , N3.1 ) →
−1 , N3.10 = {x.u
(U3 , N3.10 ) defined by u 7→ u−1 , x 7→ x satisfies Fγ (Γ3.1 → ∆3.1 ) = Γ3.10 → ∆3.10 . Finally
Γ3.1 = Γ3 , ∆3.1 = ∆3 and W (Γ3.1 ) \N3.1 = {u−1 .x−1 }. We split by u−1 .x−1 .
Case 3.1.1. ψ3.1.1 = ψu1 −1 .x−1 and N3.1.1 = {x.u−1 , u.x, u.u−1 , u.x−1 , x−1 .u−1 }; Γ3.1.1 =
Γ3.1 , ∆3.1.1 = ∆3.1 and W (Γ3.1.1 ) \N3.1.1 = ∅ hence the subcase resolves positively.
−1 −1
Case 3.1.2. ψ3.1.2 = ψu2 −1 .x−1 , x 7→ t−1 x, u 7→ t−1
 u and N3.1.2 = {x.t, u.x, u.t, t .x ,
−1 −1
−1 −1
−1 −1 −1
−1
t .u , x .u }; Γ3.1.2 = Γ t xt ut ux u  ∆3.1.2 and W (Γ3.1.2 ) \N3.1.2 = ∅,
hence the subcase resolves positively.

Case 3.1.3. ψ3.1.3 = ψu3 −1 .x−1 , x 7→ ux and N3.1.3 = {x.u−1 , u.x, u.u−1 , u.x−1 }; N3.1.3 = N3.1 and
Γ3.1.3 = Γ3.1 , ∆3.1.1 = ∆3.1 . This is the same problem as Case 3.1.
Case 3.1.4. ψ3.1.4 = ψu4 −1 .x−1 , u 7→ xu and N3.1.4 = {x.x−1 , u.x, u.x−1 , x.u−1 }; Γ3.1.4 =
Γ (hxxuxuui)  ∆3.1.4 . We notice that γ : (U5 , N5 ) → (U3.1.4 , N3.1.4 ) defined by u 7→ x, v 7→ u
satisfies that Fγ (Γ5 → ∆5 ) is conjugate to Γ3.1.4 → ∆3.1.4 , hence this is contained in Case 5.

Case 4. Here Γ4 = xuux−1 yuy −1  ∆4 and W (Γ4 ) \N4 = {x−1 .y −1 }. We split by x−1 .y −1 ∈
W (Γ4 ) \N4 .
1
−1
Case 4.1. ψ4.1 = ψv.v
, u.x, u.u−1 , y.u−1 , u.y, y.x, x−1 .y −1 }; Γ4.1 = Γ4 , ∆4.1 = ∆4
−1 , N4.1 = {x.u
and W (Γ4.1 ) \N4.1 = ∅, hence the subcase resolves positively.

Case 4.2. ψ4.2 = ψx2−1 .y−1 , x 7→ t−1 x, y 7→ t−1 y and N4.2 = {x.u−1 , u.x, u.u−1 , y.u−1 y.u, y.x,
x−1 .t−1 , y −1 .t−1 , y −1 .x−1 }; after conjugation Γ4.2 = Γ4 , ∆4.2 = ∆4 and W (Γ4.2 ) \N4.2 = ∅,
hence the subcase resolves positively.
Case 4.3. ψ4.3 = ψx3−1 .y−1 , x 7→ yx and N4.3 = {x.u−1 , u.x, u.u−1 , y.u−1 , u.y, y.x, y.x−1 }. We
notice that γ : (U3 , N3 ) → (U4.3 , N4.3 ) defined by u 7→ u, x 7→ x satisfies Fγ (Γ3 → ∆3 ) =
Γ4.3 → ∆4.3 , hence this problem is contained in Case 3.
Case 4.4. ψ4.4 = ψx4−1 .y−1 , y 7→ xy and N4.4 = {x.u−1 , u.x, u.u−1 , y.u−1 , u.y, y.x, x.y −1 }. We
notice that γ : (U2 , N2 ) → (U4.4 , N4.4 ) defined by u 7→ u, y 7→ y satisfies Fγ (Γ2 → ∆2 ) = Γ4.4 →
∆4.4 , hence this problem is contained in Case 2.

Case 6. Here Γ6 = uvuvyvuy −1  ∆6 and W (Γ6 ) \N6 = {y −1 .u−1 , v.y −1 }. We notice that
v.u−1 ∈ N2 so we can split using the triangle rule.
Case 6.1. We have two cases ψ6.1 = ψu1 −1 .y−1 , N6.1 = {v.u−1 , u.v −1 , y.v −1 , u.y, y −1 .u−1 } and
1
ψ6.10 = ψv.y
= {v.u−1 , u.v −1 , y.v −1 , u.y, v.y −1 }. These cases are equivalent, as
−1 , N6.10
γ : (U6 , N6.1 ) → (U6 , N6.10 ) defined by u 7→ v −1 , v 7→ u−1 satisfies Fγ (Γ6.1 → ∆6.1 ) = Γ6.10 →
∆6.10 . Γ6.1 = Γ6 , ∆6.1 = ∆6 and W (Γ6.1 ) \N6.1 = {v.y −1 }. We split by v.y −1 .
1
Case 6.1.1. ψ6.1.1 = ψv.y
= {v.u−1 , u.v −1 , y.v −1 , u.y, y −1 .u−1 , v.y −1 }; Γ6.1.1 =
−1 and N6.1.1
Γ6 , ∆6.1.1 = Γ6 and W (Γ6.1.1 ) \N6.1.1 = ∅, hence the subcase resolves positively.

11

2
−1
Case 6.1.2. ψ6.1.2 = ψv.y
y and N6.1.2 = {t.u−1 , u.v −1 , y.v −1 , u.y, v.t−1 ,
−1 , v 7→ vt, y 7→ t

t−1 .y −1 }; Γ6.1.2 = Γ uvtuvyvtuy −1 t  ∆6.1.2 and W (Γ6.1.2 ) \N6.1.2 = ∅, hence the subcase
resolves positively.
3
−1
Case 6.1.3. ψ6.1.3 = ψv.y
, N6.1.3 = {y −1 .u−1 , u.v −1 , y.v −1 , u.y, y −1 .u−1 , v.y} and
−1 , v 7→ vy

Γ6.1.3 = Γ y −1 uvy −1 uvvy −1 u . We notice that γ : (U5 , N5 ) → (U6.1.3 , N6.1.3 ) defined by
u 7→ y −1 u, v 7→ v satisfies Fγ (Γ5 → ∆5 ) is conjugate to Γ6.1.3 → ∆6.1.3 therefore this problem
is contained in Case 5.
4
Case 6.1.4. ψ6.1.4 = ψv.y
y 7→ v −1 y, N6.1.4 = {v.u−1 , u.v −1 , y.v −1 , u.y, v −1 .y −1 } and
−1 ,

Γ6.1.4 vuvuyvuy −1 . We notice that γ : (U2 , N2 ) → (U6.1.4 , N6.1.4 ) defined by u 7→ vu satisfies
Fγ (Γ2 → ∆2 ) = Γ6.1.4 → ∆6.1.4 , hence this problem is contained in Case 2.

Case 7. Here Γ7 = xuvuvx−1 vu  ∆7 and W (Γ7 ) \N7 = {x−1 .v −1 , u.x−1 }. We notice that
u.v −1 ∈ N2 so we can split using the triangle rule.
1
Case 7.1 We have two cases ψ7.1 = ψu.x
N7.1 = {v.u−1 , u.v −1 , x.u−1 , v.x, x−1 .u} and
−1 ,
1
−1
−1
−1
ψ7.10 = ψx−1 .v , , N7.10 = {v.u , u.v , x.u , v.x, x−1 .v −1 }. These cases are equivalent, as
γ : (U7 , N7.1 ) → (U7 , N7.10 ) defined by u 7→ v −1 , v 7→ u−1 satisfies Fγ (Γ7.1 → ∆7.1 ) = Γ7.10 →
∆7.10 ; Γ7.1 = Γ7 , ∆7.1 = Γ7 and W (Γ7.1 ) \N7.1 = {x−1 .v −1 }. We split by x−1 .v −1 .

Case 7.1.1. ψ7.1.1 = ψx1−1 .v−1 and N7.1.1 = {v.u−1 , u.v −1 , x.u−1 , v.x, x−1 .u, x−1 .v −1 }; Γ7.1.1 =
Γ7 , ∆7.1.1 = ∆7 and W (Γ7.1.1 ) \N7.1.1 = ∅, hence the subcase resolves positively.
Case 7.1.2. ψ7.1.2
=
ψx2−1 .v−1 ,
x
7→
t−1 x, v
7→
t−1 v and N7.1.2  =
−1
−1
−1 −1 −1 −1
−1 −1
−1
{v.u , u.t, x.u , v.x, t .x , t .v , x .v }; Γ7.1.2 = Γ ut vut−1 vx−1 vut−1 xu−1 
∆7.1.2 and W (Γ7.1.2 ) \N7.1.2 = ∅, hence the subcase resolves positively.
Case 7.1.3 ψ7.1.3 = ψx4−1 .v−1 , x 7→ vx, N7.1.3 = {v.u−1 , u.v −1 , x.u−1 , v.x, v.x−1 } and
Γ7.1.3 xuvuvx−1 uv . We notice that γ : (U3 , N3 ) → (U7.1.3 , N7.1.3 ) defined by u 7→ uv, x 7→ x
satisfies Fγ (Γ3 → ∆3 ) = Γ7.1.3 → ∆7.1.3 , hence this problem is contained in Case 3.
Case 7.1.4 ψ7.1.3 = ψx4−1 .v−1 , v 7→ xv, N7.1.4 = {v.u−1 , u.x−1 , x.u−1 , v.x, x.v −1 } Γ7.1.4 =
(huxvuxvvuxi). We notice that γ : (U5 , N5 ) → (U7.1.4 , N7.1.4 ) defined by u 7→ ux, v 7→ v satisfies
Fγ (Γ5 → ∆5 ) = Γ7.1.4 → ∆7.1.4 , hence this problem is contained in Case 5.

Case 8. Here Γ8 xuvuvx−1 yvuy −1  ∆8 andW (Γ8 ) \N8 = {x−1 .y −1 }. We split by x−1 .y −1 .
Case 8.1. ψ8.1 = ψx1−1 .y−1 , N8.1 = {v.u−1 , u.v −1 , x.u−1 , v.x, y.v −1 , u.y, x−1 .y −1 }; Γ8.1 =
Γ8 , ∆8.1 = ∆8 and W (Γ8.1 ) \N8.1 = ∅ hence the subcase resolves positively.
Case 8.2. ψ8.2 = ψx2−1 .y−1 , x 7→ t−1 x, y 7→ t−1 y and N8.2 = {v.u−1 , u.v −1 , x.u−1 , v.x, y.v −1 , u.y,
t−1 .y −1 , t−1 .x−1 , x−1 .y −1 }; Γ8.2 , ∆8.2 are conjugate to Γ8 , ∆8 and W (Γ8.2 ) \N8.2 = ∅ hence the
subcase resolves positively.
Case 8.3. ψ8.3 = ψx3−1 .y−1 , x 7→ yx and N8.3 = {v.u−1 , u.v −1 , x.u−1 , v.x, y.v −1 , u.y, y.x−1 }. We
notice that γ : (U7 , N7 ) → (U8.3 , N8.3 ) defined by u 7→ u, x 7→ x, v 7→ v satisfies Fγ (Γ7 → ∆7 ) =
Γ8.3 → ∆8.3 , hence this problem is contained in Case 7.
Case 8.4. ψ8.4 = ψx4−1 .y−1 , y 7→ xy and N8.4 = {v.u−1 , u.v −1 , x.u−1 , v.x, y.v −1 , u.y, x.y −1 }. We
notice that γ : (U6 , N6 ) → (U8.4 , N8.4 ) defined by u 7→ u, y 7→ y, v 7→ v satisfies Fγ (Γ6 → ∆6 ) =
Γ8.4 → ∆8.4 , hence this problem is contained in Case 6.
Case 8.5. ψ8.5 = ψx5−1 .y−1 , y 7→ x and N8.4 = {v.u−1 , u.v −1 , x.u−1 , v.x, x.v −1 , u.x}. We notice
that γ : (U5 , N5 ) → (U8.4 , N8.4 ) defined by u →
7 u, v 7→ v satisfies Fγ (Γ5 → ∆5 ) = Γ8.5 → ∆8.5 ,
hence this problem is contained in Case 5.
Case 1. We notice that Γ1  ∆1 and that W (Γ1 ) \N1 = ∅, hence the case resolves positively.

12

6

Stencil-finiteness

Let P = {Γ → ∆ | (U, NU )} be a surjectivity problem. In this section we define and
examine a property of the graph Γ, that is necessary for the recursive splitting of P (as
described in §4) to end in a finite set
cases.
Examining Ex of equivalent−1ambiguous

ample 4.4 we see that all the graphs CoreFϕ Γ xyx
y −1 |ϕ ∈ Hom ((U, NU ) , (X, WX ))
are
stencil spaces Fϕ Γ xyx−1 y −1 |ϕ ∈ Hom ((U1 , NU1 ) , (X, WX )) and
 contained−1in−1two

−1
Fϕ Γ xtyx t y
|ϕ ∈ Hom ((U2 , NU2 ) , (X, WX )) . This is a reformulation of a classic result of Wicks [Wic62] about the commutator, as we explain below. A closer examination of the computation in §5 shows that there are five stencil spaces (up to conjugation) that
 include all other
stencil spaces: Cases 1, 2.1, 5.1.1, 5.1.2, and 6.1. The set of
−1
graphs
CoreF
Γ
bbaba
|ϕ ∈ Hom (({a, b} , ∅) , (X, WX )) is the union of the stencil spaces
ϕ
S
{F
(Γ
)
|ϕ
∈
Hom
((U
,
N
ϕ
i
i
Ui ) , (X, WX ))} with I = {1, 2.1, 5.1.1, 5.1.2 , 6.1} the set of indices
i∈I
of stencil space cases. This fact, formulated differently, appears in [Mes72] (where Meskin attributes it to unpublished work by Newman). In fact, he shows more generally that this is true
for all Baumslag-Solitar relators bl abm a−1 (l, m ∈ Z). Technically this generalizes Wicks’ result,
as the commutator has l = 1, m = −1. This leads us to define the notion of stencil-finiteness
below. Even though Meskin and Wicks did not define this notion, each of them showed that some
word satisfies it. They were interested in words w with this property because it implies an easy
algorithm to determine whether there is a solution to the equation w (y1 , . . . , yn ) = a with a ∈ FX
and unknowns y1 , . . . , yn ∈ FY . First we define the following poset:
Definition 6.1. Let X be a countably infinite set, and define an equivalence relation between
folded X-labeled graphs: Γ ∼ ∆ iff there exists non-degenerate homomorphisms ϕ, ψ : FX → FX
such that (ϕ, Γ) and (ψ, ∆) are stencils and Fϕ (Γ) = ∆, Fψ (∆) = Γ. On the set of equivalence
classes we define [Γ] ≤ [∆] iff there exists a non-degenerate homomorphism ϕ : FX → FX such that
(ϕ, ∆) is a stencil and Fϕ (∆) = Γ.
Definition 6.2. We say that a folded Y -labeled graph ∆ has stencil-finiteness if the set
{[Core (Fϕ (∆))] |ϕ ∈ Hom ((Y, ∅) , (X, WX ))} has a finite number of maximal elements.
This property can be translated to a property of words, subgroups and homomorphisms of free
groups by taking the corresponding graphs. Not all words have this property: Using the methods
described in this paper one can show that the word x3 y 2 does not have this property. This is a
lengthy computation and not the subject matter of the paper, and is therefore omitted. Is stencil
finiteness a sufficient condition for the process ending? We do not know the answer. A priori, the
graph Γ may have stencil finiteness while ∆ doesn’t, and while the graphs CoreFϕ (Γ) could repeat
themselves, the graphs CoreFϕ (∆) can be distinct and thus lead to infinite distinct ambiguous
cases. We do not have an explicit example for this mainly because there aren’t many graphs known
to have stencil finiteness. The words known to have stencil finiteness are bl abm a−1 with l, m ∈ Z
(this includes the commutator), primitive words. One can show that powers of a word with this
property have it as well.
We end with some open questions:
1. Are there any other words with this property? Are there core graphs of subgroups with rank
≥ 2 that have this property?
2. Is a surjectivity problem P = {Γ → ∆| (U, NU )} such that Γ has stencil finiteness decidable?
3. Is stencil finiteness a decidable property?
4. Is there a purely algebraic interpretation of the property of an extension being onto on every
base?

References
[KM02] I. Kapovich and A. Myasnikov, Stallings foldings and subgroups of free groups, J. Algebra 248 (2002),
no. 2, 608–668.
[LS01] R. C. Lyndon and P. E. Schupp, Combinatorial group theory, Classics in Mathematics, Springer-Verlag,
Berlin, 2001. Reprint of the 1977 edition.

13

[Mes72] S. Meskin, Nonresidually finite one-relator groups, Trans. Amer. Math. Soc. 164 (1972), 105–114.
[MVW07] A. Miasnikov, E. Ventura, and P. Weil, Algebraic extensions in free groups, Geometric group theory,
2007, pp. 225–253.
[PP14] O. Parzanchevski and D. Puder, Stallings graphs, algebraic extensions and primitive elements in F2 ,
Math. Proc. Cambridge Philos. Soc. 157 (2014), no. 1, 1–11.
[Ser77] J.-P. Serre, Arbres, amalgames, SL2 , Société Mathématique de France, Paris, 1977. Avec un sommaire
anglais, Rédigé avec la collaboration de Hyman Bass, Astérisque, No. 46.
[Sta83] J. R. Stallings, Topology of finite graphs, Invent. Math. 71 (1983), no. 3, 551–565.
[Sta99] J. R. Stallings, Whitehead graphs on handlebodies, Geometric group theory down under (Canberra, 1996),
1999, pp. 317–330.
[Whi36] J. H. C. Whitehead, On Certain Sets of Elements in a Free Group, Proc. London Math. Soc. (2) 41
(1936), no. 1, 48–56.
[Wic62] N. J. Wicks, Commutators in free products, J. London Math. Soc. 37 (1962), 433–444.

14

u
u

v

u

t

u

t

u

u

v

y

y

x

u

u

t

x
v

t

u

t

v

v

t

u

v

u

v

Case 6.1.2
Case 3.1.2
v

u

t
u

v

y
u
u

t
u

v
u

x

x

t

v
x

y

Case 6.1.4
u
t

u

v

u

u

v

Case 7.1.3
x

u

v

t
x

u

t

y

u

u

Case 7.1.2

v

x

x

t

u

u

u

v

v

u

Case 3.1.4

t

x

u

v

x

v

y

u
u

v

u

v

Case 7.1.4

y

y

u

u

t

s

t

s

u

y

u

v

u

v
t

u

v

s

y

v

u

v
u
y

Case 6.1.3

Figure 5.1: The graphs ∆i.k.j = CoreFψi.k.j (∆i,k ) arising in the analysis of the counterexample.

15

