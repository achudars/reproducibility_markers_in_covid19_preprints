arXiv:1905.04008v1 [math.AP] 10 May 2019

An economic cross-diffusion mutualistic model for cities
emergence ∗
Gonzalo F. de-Córdoba

†

Gonzalo Galiano‡

Abstract
We study an evolution cross-diffusion problem with mutualistic Lotka-Volterra reaction
term to modelize the long-term spatial distribution of labor and capital. The mutualistic
behavior is deduced from the gradient flow associated to profits maximization. We perform
a linear and weakly nonlinear stability analysis and find conditions under which the uniform
optimum of profits becomes unstable, leading to pattern formation. The patterns alternate
regions of high and low concentrations of both labor and capital, which may be interpreted
as cities. Finally, numerical simulations based on the weakly nonlinear analysis, as well as
in a finite element approximation, are provided.
Keywords: Cross-diffusion, mutualism, Turing instability, weakly nonlinear analysis, labor,
capital, city.

1

Introduction

The first human settlements that can be regarded as cities had one element in common: the
presence of a natural formation that endowed the location with a characteristic making small
amounts of capital particularly productive. This is, for example, the case of the alluvial plains
of Lower Mesopotamia, where a natural levee made it very easy to irrigate large extensions of
land with little tools. In addition, the recent invention of the plow led to an extraordinary gain
in productivity.
In this article, we study a mathematical model to explore the type of relation between
labor and capital that leads to the formation of cities, understood as cumulus of labor and
capital. Unlike other models, where this interaction is assumed to take place in a discrete spatial
domain formed by patches of employment [1], we consider a continuous time-space model where
the relations between labor and capital driving to global growth or decay are derived solely
from a production function, and where the spatial relocation is induced by attraction-repulsion
mechanisms among the units of labor and capital and, secondarily, by random motion.
Current economic geography models like those introduced by Krugman [15] or by Tabuchi
and Thisse [18] are focused in modeling industry concentration or in explaining the emergence
of central places. These models are set in a discrete spatial domain, being the main forces
explaining concentration the decreasing transportation costs and the increasing returns to scale
∗

First author supported by the Spanish MEC Project ECO2016-76818. Second author supported by the
Spanish MEC Project MTM2017-87162-P. Submitted to the editors of CAMWA on March 16, 2019.
†
Dpto. de Teorı́a e Historia Económica, Universidad de Málaga, 29013-Málaga, Spain (gfdc@uma.es).
‡
Dpto. de Matemáticas, Universidad de Oviedo, 33007-Oviedo, Spain (galiano@uniovi.es).

1

G. F. de-Córdoba and G. Galiano

in the production of manufactured goods. A production function is said to have increasing
returns to scale when the increase of one unit of all the inputs, induce an increase of output
larger than one. See [16] for an extended discussion about returns to scale in a production
function similar to ours.
In the model we introduce, cities emergence is a possible outcome of the action of general
interacting forces that relocate labor and capital, and which is tidily connected to growth.
Thus, we do not need to specify the actual forces involved in the process, that can include
those of Krugman or Tabuchi and Thisse, nor we need more than assuming a world where a
unique homogeneous good is produced. Furthermore, we do not make use of the assumption of
increasing return to scale in the production of goods.

1.1

A historical example

Before moving into the description of the mathematical model, let us motivate it by examining
the economic events that happened five thousand years ago in the levees of Mesopotamia [7]
Previously to the arising of the first civilizations, the Humanity, for hundreds of thousands of
years, was nearly uniformly distributed in geographical areas where the environmental conditions
were favorable. This uniform state suffered a perturbation caused by the Neolithic revolution.
In the levees of Mesopotamia, people concentrated along the natural ridge because it was easy
to irrigate, and with the use of plows and animal force, people found their labor very productive.
There was growth.
Increase of productivity attracted more people who relocated in longer stretches of the ridge
producing more and more until the ridge was all crowded. Because, the ridge was on limited
supply, more workers and more capital faced decreasing returns to scale due to competence.
At some moment, the extra capital and the extra workers were repelled by the overcrowding,
finding themselves more productive somewhere else, and thus relocated, possibly to a place less
well endowed than the ridge.
This process continued along the time, with the formation of new capital and labor agglomerations that led to the distribution that we observe nowadays, far from the initial prehistorical
uniform equilibrium.

1.2

The mathematical model

After the work of Turing [19], it is well-known that the introduction of spatial mechanisms
through diffusion terms in reaction systems of differential equations may change the stability of
uniform equilibria, developing new ones with a non-uniform pattern-like spatial profile.
Diffusion terms allow to model random relocation as well as redistribution due to attractive
or repulsive pressures. An important instantiation of reaction-diffusion models is the chemotaxis
model, where bacteria relocates due to attraction forces caused by a chemical stimulus. Starting
with the works of Keller and Segel [14], this model received much attention due to its modeling
simplicity, this is, the easy identification of the biological mechanisms implied by each term of
the equations; its analytical and numerical tractability, which allows to prove key mathematical
properties like the existence, uniqueness and non-negativity of the solutions; and, importantly,
the ability of the model to capture essential aspects of the population behavior [13].
The chemotaxis model is a particular example of reaction cross-diffusion models [17, 2, 8, 5,
6, 9, 12]. Apart from the evolution terms, the equations have two other qualitatively different
2

Economic model for cities emergence

terms. The reaction term, which induces the global growth or decline of the substances, and the
diffusive terms, that redistribute them in space. Correspondingly, our model is constructed in
two steps.
1. For the reaction terms, we investigated which functional form should be considered for the
labor-capital relationship. As shown in the equations (1)-(2), we found that this relation
is mutualistic, in contrast with previous literature [3], where a predator-pray model was
used. We delay the justification of this assumption to Section 2, where a detailed study is
performed.
2. For the diffusion part of the system, we assume the following general qualitative laws:
(a) Labor and capital relocate randomly moving from higher to lower density regions.
(b) Labor is repelled by high labor density regions.
(c) Labor and capital are attracted by high capital density regions. However, the attraction felt by capital is limited, due to increasing costs of relocation to such regions.
With these laws operating, the mathematical problem is formulated as follows. Let L and
K denote the labor and capital concentrations. Find L, K : [0, T ] × Ω̄ ⊂ Rn → R+ , n ∈ N, such
that

∂t L − div (c1 + a11 L)∇L − a12 L∇K = L(α1 − β11 L + β12 K)
in QT ,
(1)



K
∂t K − div c2 − a22 2
∇K = K(α2 + β21 L − β22 K)
in QT ,
(2)
Ks + K 2
∇L · ν = ∇K · ν = 0
on ΓT ,
(3)
L(0, ·) = L0 ,

K(0, ·) = K0

in Ω,

(4)

where QT = (0, T ) × Ω, ΓT = (0, T ) × ∂Ω, and the coefficients are non-negative constants.
For the diffusion part of (1)-(2), we have adopted the simplest mathematical functional forms
for random diffusion (terms containing c1 , c2 ) and for the intra-repulsion and inter-attraction
experienced by labor (terms containing a11 and a12 ). However for the intra-attraction experienced by capital (term containing a22 ), we incorporate a saturation function which results on a
more complex nonlinear interaction. The reason is the following: high density capital regions
are attractive for both labor and capital due to work demand and capital synergies. However,
this trend has a limit, specially for the capital, given e.g. by prices of access to real estate
and labor, or even by taxes. In this limit, that we capture through the saturation constant
Ks , the attraction function reaches a global maximum at the given geographical region, and its
attractiveness declines if more capital is injected in the place.
In relation to the boundary conditions (3), we assume that labor and capital are isolated
within the spatial domain Ω, that is, there are no labor or capital flows through the boundary
of Ω. Concerning the initial data (4), we assume that L0 and K0 are smooth non-negative given
functions.
The rest of the paper is organized as follows. In Section 2, we investigate the kind of reaction
term which should be adopted in the model. Starting from a general production function, we
show that the gradient flow of the corresponding profits function may be approximated by a
Lotka-Volterra system. We show that standard economic assumptions imply that this system
3

G. F. de-Córdoba and G. Galiano

is of the mutualistic type, fact which is illustrated with the consideration of the specific CES
production function, see (9).
In Section 3, we perform a Turing stability analysis to find conditions under which the
uniform equilibrium becomes unstable and a new pattern-like equilibrium arises. In geographical
economy terms, we check that the spatially uniform coexistence equilibrium, which was prevalent
during the long early period of human development, becomes unstable and produce a new
non-uniform equilibrium in which geographical patterns arise. These geographical patterns,
accumulations of labor and capital, may be interpreted as cities.
Although the linear stability theory is a useful step for understanding pattern formation,
it only gives a rough indication of the patterns we should expect. Thus, in the Appendix, we
perform a weakly nonlinear analysis based on the method of multiple scales that, in addition
to the unstable wavenumbers provided by the linear theory, allows also to approximate the
amplitude of such instabilities.
Finally, in Section 4, we illustrate the theoretical results by performing several numerical
experiments in which the problem data imply the instability of the uniform equilibrium. We
approximate the full nonlinear system (1)-(4) with a finite elements scheme and, when possible,
compare this approximation with that provided by the weakly nonlinear analysis.

2

The reaction term: parameters of competence and mutualism

A production function, Y (K, L), is an abstraction that summarizes a technical relation between
the inputs of labor and capital used in a productive process and the resulting quantity of output.
Firms, in order to operate a production function, must pay the use of productive factors. As
a compensation, they obtain income through sales, but at the cost of remunerating the worker
hours used and the capital hired. The difference between the revenue sales and the factor costs,
constitutes the profits:
Π(K, L) = pY (K, L) − wL − rK,
where p, w, r are functions of time describing, respectively, the sale price of one unit of output,
the wages paid for a unit of work, and the rental rate of capital used in production. Function p
can be taken as numeraire, normalizing it to 1.
The optimal trajectory (K(t), L(t)) is determined by the maximization of profits. The first
optimality condition is
∂L Y (K, L) − w = 0,

∂K Y (K, L) − r = 0.

(5)

To compute the optimal trajectory, one must prescribe wages and rental rates or, otherwise, state
suitable relationships among L, K, w and r that close the system of equations. A simplifying
assumption consists on supposing that w and r are close to some stable constant values, say
w∗ , r∗ . Then, the profits optimum for these values, (L∗e , Ke∗ ), is obtained from the optimality
conditions (5).
A dynamics approximating this optimal value is given by the nonlinear problem corresponding to the gradient flow ∂t (K, L)t = ∇Π(K, L). In a further simplification, we may linearize
the gradient flow by performing the substitution ∇Π(K, L) ≈ 12 H(Π∗e )(L − L∗e , K − Ke∗ )t , where
H(Π∗e ) is the Hessian matrix of Π at (L∗e , Ke∗ ).
4

Economic model for cities emergence

In order to accommodate the gradient flow to the Lotka-Volterra terms, we use a modified
gradient flow, see Remark 1, that leads to the system


∂t L = L α̃1 + β̃11 L + β̃12 K ,
(6)


∂t K = K α̃2 + β̃21 L + β̃22 K ,
(7)
with
B̃ := (β̃ij ) = H(Π∗e ),

(α̃1 , α̃2 )t = −B̃(L∗e , Ke∗ )t .

(8)

In particular, notice that the profits optimum (L∗e , Ke∗ ) coincides with the non-trivial equilibrium
of the Lotka-Volterra system. In addition, β̃12 = β̃21 and the second optimality condition for
the profits maximization, i.e. that H(Π∗e ) is positive definite, imposes the necessary condition
det(B̃) > 0.
Since, by definition, H(Ye∗ ) = H(Π∗e ), the signs of β̃ij are determined by the production
function. In economic terms, the Law of decreasing marginal productivities states that the more
one factor is used, the smaller is the increase in output obtained. This is reflected as the second
derivatives ∂LL Y and ∂KK Y being negative. However, the crossed marginal productivities are
increasing, i.e., ∂LK Y = ∂KL Y > 0. The reason is that if, for instance, labor is abundant, an
increase in capital will increase the productivity of workers, and as a consequence it will improve
the output, as the farmer with naked hands is much less productive than the farmer with a plow.
Therefore, one expects the following signs for the quadratic coefficients of the Lotka-Volterra
term:
β̃11 < 0,

β̃22 < 0,

and

β̃12 = β̃21 > 0,

capturing a mutualistic model.
Remark 1. Suppose that the dynamical system ∂t u = F(u), for some differentiable function F :
R2 → R2 , has a nontrivial asymptotically stable equilibrium u∗ with non-negative components.
Let JF(u∗ ) denote its Jacobian matrix at u∗ , so that tr(JF(u∗ )) < 0 and det(JF(u∗ )) > 0.
Consider the system ∂t w = G(w), with Gi (w) = wi Fi (w), for i = 1, 2, having the equilibria
0 and u∗ . We have
tr(JG(w)) =

2
X

wi ∂i Fi (w),

det(JG(w)) = w1 w2 det(JF(w)),

i=1

and, consequently,

2.1

u∗

is its only stable equilibrium.

Example: The CES production function

The production function of constant elasticity of substitution (CES) [16] has the following functional form:

Y (K, L) = A (αK η + βLη ) η ,
(9)
where A is the total factor productivity, a non-negative function of time which is a scaling
parameter used to accommodate the measures of K and L in relation to Y , and where α, β are
the income share parameters. We assume the usual parameters range
α, β,  ∈ (0, 1),

η < 1,
5

η 6= 0,

and  ≥ η.

(10)

G. F. de-Córdoba and G. Galiano

For this choice of the production function, we have


∂L Y (K, L) = A[αK η + βLη ] η
η

η

∂K Y (K, L) = A[αK + βL ]

−1

βLη−1 ,


−1
η

αK

η−1

(11)
,

(12)

and
β( − η)Q−1 wLη − (1 − η)w

L
H(Π) = 


β( −

η)Q−1 rLη−1

α( −

η)Q−1 wK η−1




,
α( − η)Q−1 rK η − (1 − η)r 
K

(13)

where Q = αK η + βLη .
In the following theorem, we show that for a CES production function the signs of the
reaction part of the system (6)-(7) are those of a mutualistic Lotka-Volterra model. This gives
support to our assumption on the form of the reaction part of the system (1)-(2). We also check
that the equilibrium of this model coincides with the optimum of the profits function.
Theorem 1. Let w∗ , r∗ be positive numbers, and consider the CES production function (9)
with parameters satisfying (10). Then, the optimum of the profits function, Π, is (L∗e , Ke∗ ), with
−η

1 
ρ
ρ
w∗  η α  1−η
η
(L∗e )1−ε = ∗ β /η , (Ke∗ )1−ε = ∗ α/η , ρ = A 1 + ∗ 1−η
.
w
r
r
β
Moreover, (Ke∗ , L∗e ) is also the coexistence equilibrium of the Lotka-Volterra system (6)-(7) with
coefficients given by (8), which satisfy
α̃1 > 0,

α̃2 > 0,

β̃11 < 0,

β̃22 < 0,

β̃12 = β̃21 ≥ 0,

det(B̃) > 0.

In addition, if  > η then β̃12 = β̃21 > 0.
Proof. Dividing the first optimality condition by the second, see (5), and using the explicit
expressions (11)-(12) yields
 ∗  1
r β η−1 ∗
∗
Ke =
Le .
w∗ α
Replacing in (5) and rearranging terms we obtain the expression of (L∗e , Ke∗ ) stated in the
proposition. The optimum (L∗e , Ke∗ ) is also the coexistence equilibrium of (6)-(7) by construction,
see (8). From the definition of the Hessian, see (13), and the condition  ≥ η (resp.  > η) we
easily deduce that β12 = β21 ≥ 0 (resp. β12 = β21 > 0). Moreover, after some computations, we
obtain
w∗ r∗
det(B̃) = (1 − )(1 − η) ∗ ∗ > 0.
Le Ke
Therefore, necessarily β̃11 β̃22 > 0. Suppose that both numbers are positive. Then, using their
definition, we deduce
 1 − η 2
(L∗e )η (Ke∗ )η
αβ
>
.
(α(L∗e )η + β(Ke∗ )η )2
−η
Set x = α(L∗e )η , y = β(Ke∗ )η and δ = (1 − η)2 /( − η)2 . The above inequality translates to
δ(x2 + y 2 ) + (2δ − 1)xy < 0, which is not possible if 2δ > 1. And this is indeed the case, due
to the conditions ε < 1 and η < 1. The contradiction arises after the assumption β̃11 > 0 and
β̃22 > 0. Therefore, these quantities must be both negative, since their product is positive.
Finally, from the definition of α̃i , see (8), we get α̃1 = w∗ (1 − ) > 0, and α̃2 = r∗ (1 − ) > 0. 2
6

Economic model for cities emergence

3

Turing instability analysis

Before starting the stability analysis, we reduce slightly the profusion of parameters in our model
by introducing the assumption that the mutualistic coefficients β12 , β21 of the reaction terms are
positive. This is, for instance, the case for a CES production function with  > η, see Theorem 1.
Thus, we perform the following change of variables and parameters:
L̄ = β21 L, K̄ = β12 K, L̄0 = β21 L0 , K̄0 = β12 K0 , K̄s = β12 Ks ,
a11
a12
β11
β22
a1 =
, a2 = a22 β12 , b =
, β1 =
, β2 =
,
β21
β12
β21
β12
t
x
t̄ = , x̄ = √ ,
γ
γ
for some time-space re-scaling factor γ > 0. This change renders problem (1)-(4) to the following
form (omitting bars)

∂t L − ∂x (c1 + a1 L)∂x L − bL∂x K = γL(α1 − β1 L + K)
in QT ,
(14)



∂t K − ∂x c2 − a2 g(K) ∂x K = γK(α2 + L − β2 K)
in QT ,
(15)
∂x L · ν = ∂x K · ν = 0

on ΓT ,

(16)

L(0, ·) = L0 ,

in Ω,

(17)

K(0, ·) = K0

where (0, T ) and Ω are redefined according to the scaling factor γ. We collect here some assumptions and necessary conditions for the well-posedness of the problem:
1. The saturation function g ∈ C 2 (R+ ) is non-negative and reaches its maximum at Ks > 0.
2. The coefficients ci , b, and ai , for i = 1, 2, are non-negative. In particular, we assume the
ellipticity conditions
c1 + a1 > 0,

c2 > a2 g(Ks ).

3. In agreement with Theorem 1, the coefficients αi and βi , for i = 1, 2, are non-negative.
Moreover, dominance of competitiveness over mutualism, captured by β1 β2 > 1, is also
assumed.
Notice that after the change of unknowns leading to the system (14)-(17), the coexistence equilibrium is expressed as
(L∗ , K ∗ ) =

α + α β α + α β 
1
2 1
2
1 2
,
.
β1 β2 − 1 β1 β2 − 1

(18)

In the following theorem we establish that diffusion induced instability occurs when the
attraction felt by labor toward regions with a high density of capital is large enough.
Theorem 2. The coexistence equilibrium (18), which is stable for the reaction system associated
to (14)-(17), becomes unstable for the whole reaction-diffusion system (14)-(17) when b > bc ,
see (26). This instability leads to pattern formation if γ is large enough.
7

G. F. de-Córdoba and G. Galiano

Proof.
Let (L̃, K̃) be a small perturbation of this equilibrium satisfying (14)-(16) and set
(w1 , w2 ) = (L̃ − L∗ , K̃ − K ∗ ). The linearized problem for w = (w1 , w2 ) is given in matrix form
by
∂t w − Q∆w = γRw

in QT ,

(19)

∇u1 · ν = ∇u2 · ν = 0

on ΓT ,

(20)

in Ω,

(21)

u1 (0, ·) = L̃(0, ·) − L0 ,

u2 (0, ·) = K̃(0, ·) − K0

where

R=


−β1 L∗
L∗
,
K∗
−β2 K ∗



c1 + a1 L∗
−bL∗
Q=
.
0
c2 − a2 g(K ∗ )

(22)

Taking into account the boundary conditions, we search for particular solutions of (19)-(21) of
the form w(t, x) ∝ eλt+ik·x , where λ represents the linear growth rate and k is the wave number
of the perturbation. Introducing this expression of w in (19)-(21) we are led to the eigenvalue
problem
Ak w = λw,

for Ak = γR − k 2 Q and k = |k|.

The corresponding characteristic equation yields the eigenvalues

p
1
tr(Ak ) + (−1)j tr(Ak )2 − 4 det(Ak ) ,
λjk =
2

(23)

j = 1, 2,

so that, for Turing instability to occur, one or more of the eigenvalues λjk must have a positive
real part.
For k = 0 (no diffusion), we have tr(A0 ) = γ tr(R) < 0 and det(A0 ) = γ det(R) > 0, implying
Re(λj0 ) < 0 for j = 1, 2. This is, the mode corresponding to the wave number k = 0 is always
stable.
For k > 0 we have tr(Ak ) = γ tr(R) − k 2 tr(Q) < 0, and therefore, the only way which may
lead to a positive Re(λjk ) involves det(Ak ) being negative. We introduce the convex quadratic
polynomial
h(k 2 ) := det(Ak ) = det(Q)k 4 + γk 2 q + γ 2 det(R),
with q = m2 − bm1 , and m1 , m2 given by the positive constants
m1 = L∗ K ∗ ,

m2 = β1 L∗ (c2 − a2 g(K ∗ )) + β2 K ∗ (c1 + a1 L∗ ).

The minimum of h is attained at
2
km
=−

γq
,
2 det(Q)

(24)

which is a real root if q < 0. Hence, a necessary condition for instability is
b > m2 /m1 .

(25)

The corresponding minimum value is

2
min(h(km
)) = γ 2 det(R) −

8


q2
,
4 det(Q)

Economic model for cities emergence

1/2
which is negative for q < −2 det(R) det(Q)
, or, in terms of the bifurcation parameter b, if
b > bc , with the critical bifurcation value given by
1/2
m2 + 2 det(R) det(Q)
bc =
.
m1

(26)

Observe that, in particular, b > bc implies the necessary condition (25). The critical wavenumber
corresponding to the critical bifurcation values is found by replacing q c = m2 − bc m1 in (24),
yielding
kc2 = γ

 det(R) 1/2
det(Q)

=γ



1/2
(β1 β2 − 1)L∗ K ∗
.
(c1 + a1 L∗ )(c2 − a2 g(K ∗ ))

Thus, for b > bc the system has a range (k12 , k22 ) of unstable wavenumbers, where k12 , k22 are the
roots of h. Pattern formation will arise if the spatial spread of Ω is large enough so that at
least one of the modes admitted by the boundary conditions lies in the interval (k12 , k22 ). Since
the roots of h depend linearly on γ, the time-space scale parameter, pattern formation in the
original model will be observed if this parameter is large enough. 2
To gain some insight into the bifurcation condition, we replace the expressions of m1 , m2 , det(R)
and det(Q) in (26) to obtain that b > bc is equivalent to
L∗ K ∗ b > β1 L∗ X 2 + β2 K ∗ Y 2 + 2(L∗ K ∗ det(B))1/2 XY,
where X 2 = c2 − a2 g(K ∗ ) and Y 2 = c1 + a1 L∗ . Completing squares, and using the elementary
inequality (x + y)2 ≤ 2(x2 + y 2 ), we deduce the sufficient condition
L∗ K ∗ b + 2XY

√

L∗ K ∗

p
p

β1 β2 − det(B) > 2(β1 L∗ X 2 + β2 K ∗ Y 2 ).

Since det(B) = β1 β2 − 1, we obtain the following, more strict, sufficient condition, providing a
clear interpretation of the bifurcation condition in terms of the diffusion coefficients,
b
β1
β1
β2
+
a2 g(K ∗ ) > ∗ c2 + ∗ c1 + β2 a1 .
2 K∗
K
L

(27)

As expected, we see that the diffusion coefficients promoting stability are those representing
random relocation and labor intra-repulsion, while those promoting instability are the intraattraction coefficients of both labor and capital.
In which respect to the relationship between instability and the kinematic terms, let us
assume the simplification α1 = α2 =: α. Replacing these values in the expressions of the
equilibrium, and then in (27), we get the sufficient condition
det(B)
b det(B)
+
a2 g(K ∗ ) >
c1 + c2 ) + β2 a1 ,
2
α
α

(28)

from where we interpret that if there is a high increase of labor and capital, expressed by a small
intra-competitive behavior and a large intrinsic growth, instability will arise.
9

G. F. de-Córdoba and G. Galiano

4

Numerical simulations

We approximate the solutions of the nonlinear problem (14)-(17) by employing two methods:
the finite element method (FEM) and the weakly nonlinear approximation (WNL). The latter
is explained in detail in the Appendix, but we give here a short summary of the main ideas. See
also [10, 11].
Let ε be a small control parameter representing the dimensionless distance from the critical threshold ε2 = (b − bc )/bc . The idea of the weakly nonlinear analysis is to expand the
perturbation, w, the bifurcation parameter, b, and the time scale, t, in powers of ε,
b = bc + εb1 + ε2 b2 + ε3 b3 + · · · ,

(29)

w = εw1 + ε2 w2 + ε3 w3 + · · ·

(30)

3

2

∂t = ε∂T1 + ε ∂T2 + ε ∂T3 + · · ·

(31)

After substitution in the nonlinear system satisfied by w, see (35), and equating with respect to
the order of ε, we obtain a chain of linear problems for wi , for i = 1, 2, . . ., whose solutions are
of the form wi (T1 , T2 , . . . , x) = A(T1 , T2 , . . .)ui (x), with A denoting amplitude. In particular,
the third order approximation leads to the cubic Stuart-Landau equation for the amplitude,
∂T2 A = σA − `A3 ,
where the growth rate coefficient σ is positive. The dynamics of this equation is divided into
two different cases according to the sign of the Landau constant `: the supercritical case (` > 0),
and the subcritical case (` < 0).
p
In the supercritical case, the equilibrium solution A∞ = σ/` is stable, and represents
the asymptotic value of the amplitude A. The corresponding solution, corrected to satisfy the
Neumann boundary conditions, is given by
r

σ
σ
w = ερ
cos(k¯c x) + ε2 w20 + w22 cos(2k¯c x) + O(ε3 ),
(32)
`
`
where k¯c is the first integer or semi-integer to become unstable when b passes the critical value
bc .
In the subcritical case, the cubic Stuart-Landau equation does not give any valid information
for the amplitude, and a higher degree expansion on powers of ε must be considered, leading to
higher order Stuart-Landau equations.
For the FEM approximation, we used the open source software deal.II [4] to implement a
time semi-implicit scheme with a spatial linear-wise finite element discretization. For the time
discretization, we take in the experiments a uniform time partition of time step τ . For the
spatial discretization, we take a uniform partition of the interval Ω = [0, 2π].
Let, initially, t = t0 = 0 and set (L0 , K 0 ) = (L0 , K0 ). For n ≥ 1, the discrete problem is:
Find Ln , K n ∈ S h such that
h
1 n
L − Ln−1 , χ)h + (c1 + a1 Ln )∇Ln − bLn ∇K n , ∇χ
(33)
τ
= γLn (α1 − β1 Ln + K n ), χ)h ,
h
1
K n − K n−1 , χ)h + (c2 − a2 g(K n ))∇K n , ∇χ
(34)
τ
= γK n (α2 + Ln − β2 K n ), χ)h ,
10

Economic model for cities emergence

w∗ , r∗
α, β
, η
α1 , α2
β1 , β 2
c1 , c2
a1 , a2
(L∗ , K ∗ )
bc , kc
Ts , MSE

1
1, 0.3
0.3, 0.6
0.5, 0.2
0.5, 0.15
2.35, 2.47
0.01, 0.01
0.3, 3e-4
0.29, 0.18
1.56, 3.99
1557, 1.7e-2

Experiments
2
3
0.4, 0.3
0.95, 0.95
0.3, 0.6
0.29, 0.3
0.5, 0.2
0.75, 0.1
0.2, 0.15
0.24, 0.24
0.48, 8.38
0.66, 1.97
0.01, 0.01
0.1, 0.1
7e-3, 0.01
0.41, 2.4
0.6, 0.09
2.35, 1.31
0.42, 6
1.14, 4.02
1630, 1.4e-2 240, 4.7e-2

4
0.4, 0.5
0.3, 0.6
0.5, 0.2
0.05, 0.15
4.5e-2, 5.4
0.01, 0.01
3.72, 2.7e-5
1.96, 0.03
205.9, 3.51
5000

Table 1: Parameters of the CES production function, resulting (scaled) Lotka-Volterra coefficients, rescaled diffusion coefficients, equilibrium, critical bifurcation and wave numbers, time
to stationary state and mean square error between the FEM solution and the WNL solution.
for every χ ∈ S h , the finite element space of piecewise Q1 -elements. Here, (·, ·)h stands for a
discrete semi-inner product on C(Ω).
Since (33)-(34) is a nonlinear algebraic problem, we use a fixed point argument to approximate its solution, (Ln , K n ), at each time slice t = tn , from the previous approximation
(Ln−1 , K n−1 ). Let Ln,0 = Ln−1 and K n,0 = K n−1 . Then, for k ≥ 1 the linear problem to solve
is: Find (Ln,k , K n,k ) such that for for all χ ∈ S h
1 n,k
L − Ln−1 , χ)h +
τ
=
1
K n,k − K n−1 , χ)h +
τ
=

(c1 + a1 Ln,k−1 )∇Ln,k − bLn,k−1 ∇K n,k , ∇χ

h

γLn,k (α1 − β1 Ln,k−1 + K n,k−1 ), χ)h ,
h
(c2 − a2 g(K n,k−1 ))∇K n,k , ∇χ
γK n,k (α2 + Ln,k−1 − β2 K n,k−1 ), χ)h .

We use the stopping criteria

max kLn,k − Ln,k−1 k2 , kK n,k − K n,k−1 k2 < tolF P ,
for values of tolF P chosen empirically, and set (Ln , K n ) = (Ln,k , K n,k ). Finally, we integrate in
time until a numerical stationary solution, (LS , K S ), is achieved. This is determined by

max kLn,1 − Ln−1 k2 , kK n,1 − K n−1 k2 < tolS ,
where tolS is chosen empirically too.
We run four simulations with data leading to pattern formation. Unless otherwise stated,
the following parameters are fixed for all the experiments. The initial data is a perturbation of
the stable equilibrium given by L0 = L∗ (1 + 0.05 sin(10πx)) and K0 = K ∗ (1 + 0.05 cos(10πx)).
The time step is τ = 0.01, and the spatial domain is Ω = (0, 2π), with 256 spatial nodes. The
tolerances for the fixed point method and for the stationary state are taken as tolF P = 1.e − 6
and tolS = 1.e − 8. The total factor productivity is A = 1, the time-scale parameter is γ = 1, the
saturation constant is Ks = 10K ∗ , and the bifurcation parameter is b = 1.01bc . In Table 1, we
11

G. F. de-Córdoba and G. Galiano

Figure 1: Supercritical case. First row: Experiment 1. New equilibrium reached after the onset of
instabilities due to a small perturbation around the uniform equilibrium (L∗ , K ∗ ) ≈ (0.287, 0.176). Second
row: Experiment 2. Like previous, with (L∗ , K ∗ ) = (0.6, 0.09). Mind the different ordinate scales. Third
row: Experiment 3. Like previous, with (L∗ , K ∗ ) ≈ (2.35, 1.31).

show the parameters which vary in each experiment and additional information on the numerical
results. In Figures 1-3, we show the approximated solutions obtained in the experiments and
the determinant of the matrix Ak , see (23), showing the unstable wave numbers.
Remark 2. For developed economies, the values α ≈ 0.3 and β ≈ 0.6 are well established. The
values of  and β are more difficult to estimate. They can be obtained from the definition of the
CES production function (9), from setting the scaling variable A to a known value, and from
data indicating that the ratio K/Y ≈ 3.5 holds in a variety of situations. Of course, the choice
of these parameters is not unique. In any case, we found that their role in the stability analysis
is limited so, for the examples, we fixed them in order to obtain interesting visualizations.
In the first two experiments, the main reason because instability arises, see (27) and (28), is
that the diffusion parameters promoting stability, c1 , c2 , and a1 are small in comparison with
the ratios αi / det(B), determining the growth capacity of the system. In the Experiment 1, this
happens in a symmetric way for the competition coefficients, β1 ≈ β2 and in an asymmetric
12

Economic model for cities emergence

Figure 2: Subcritical case. Experiment 4: Evolution of the instability formation. Only the labor is
shown, the capital following a similar trend. For large times, uninhabited regions arise separating densely
populated areas.

way for the intrinsic growth coefficients, with α1  α2 . In the second experiment, the opposite
relation is considered. We see that the critical bifurcation parameter is, at least, one order higher
than the other diffusion coefficients, implying that, under these situations, instability arises if
the attraction felt by labor for capital is high in comparison with random or repulsion effects.
In the third experiment we set larger stability promoting diffusion coefficients and smaller
values of the growth and competition coefficients. However, it is clear that the important
relationship for instability is that of the size of αi / det(B) against the size of the diffusion
coefficients. Thus, instability emerges as well in this case. However, notice that here the critical
bifurcation parameter is of the same order as the other diffusion coefficients. This is, it is not
necessary a extreme difference between attraction and repulsion for instability to arise: growth
plays a fundamental role. In this experiment, we set A = 100 and γ = 5 for a better visualization.
In the Experiment 4 we set parameters leading to large amplitude instabilities containing
regions abandoned by labor and with few remaining of capital. Unlike the other experiments, in
this case we experimented with a subcritical bifurcation so that the third order Stuart-Landau
equation for the amplitude does not give any useful information. The stabilizing factor β2 a1 ,
see (27), is large, forcing a large bifurcation coefficient for instabilities to arise. Observe that β2
is the intra-competition coefficient for K, and a1 is the intra-repulsion coefficient for L. Thus,
even if these intra-population stabilizing mechanisms are intense, a large enough attraction of
labor for capital is still able to cause severe instabilities. In this experiment, we set γ = 10.
Finally, let us notice the good agreement between the FEM and the NWL approximations
in the Experiments 1 to 3, for which the bifurcation is supercritical and the third order StuartLandau equation provides an estimate for the steady state amplitude. In all of them, the mean
square error between the FEM and the NWL approximations is of the order MSE ≈ 1.e − 2.
13

G. F. de-Córdoba and G. Galiano

Figure 3: Experiments 1 to 4: Determinant of the eigenvalue matrix Ak , see (23), as a function of k, and
for two values of the bifurcation parameter: the critical value bc and the value used in the experiments,
b = 1.01bc .

Appendix: Weakly nonlinear analysis in 1D
Let w be the random perturbation around the coexistence equilibrium introduced in Section 3.
We recast the nonlinear system (14)-(15) as
∂t w = Lb w + N b w,

(35)

where Lb = γR + Qb ∂xx , and N b is a nonlinear operator. Here, we introduced in the notation
the superscript b to stress the dependence of these operators on the bifurcation parameter. We
consider the decomposition
Nb =


1
b
QR (w, w) + ∂xx QQ (w, w) + SQ
(w),
2

with the bilinear symmetric forms


−2β1 x1 y1 + (x1 y2 + x2 y1 )
QR (x, y) = γ
,
−2β2 x2 y2 + (x1 y2 + x2 y1 )


QQ (x, y) =


a1 x1 y1
,
a2 g 0 (K ∗ )x2 y2

and the nonlinear operator
b
SQ
(w)

=

−b∂x (w1 ∂x w2 )
P∞ g(j) (K ∗ )
a2 j=2 (j+1)! ∂xx w2j+1

!
.

Introducing the parameter ε2 = (b − bc )/bc , and the expansions (29)-(31), replacing them in the
system (35), and equating in terms of the order of ε, leads to the following systems of equations,
14

Economic model for cities emergence

that we set in (0, T ) × (0, 2π/kc ) and complement with non-flow boundary conditions:
O(ε) : Lbc w1 = 0,

(36)


1
QR (w1 , w1 ) + ∂xx QQ (w1 , w1 )
2
+ bc ∂x (w1,1 ∂x w1,2 )e1 =: F,

O(ε3 ) : Lbc w3 = ∂T1 w2 + ∂T2 w1 − B2 ∂xx w1 + B1 ∂xx w2

− QR (w1 , w2 ) + ∂xx QQ (w1 , w2 )

+ bc ∂x w1,1 ∂x w2,2 + w2,1 ∂x w1,2 e1

a2
3
+ b1 ∂x w1,1 ∂x w1,2 e1 + g 00 (K ∗ )∂xx w1,2
e2 := G,
6
O(ε2 ) : Lbc w2 = ∂T1 w1 − B1 ∂xx w1 −

(37)

(38)

where Lbc = γR + Qbc ∂xx , and the elements of the matrix Bj are zero, with the exception of
(Bj )12 = −bj L∗ . We compute the solutions of (36)-(38).
Order ε: The solution of the linear problem (36) is given by w1 = A(T1 , T2 )ρ cos(kc x), with
ρ ∈ ker(γR−kc2 Qbc ), where A is the amplitude of the pattern, unknown at the moment. Observe
that γR − kc2 Qbc = Akbcc , with Ak defined in (23), and with kc determined to yield det(Abkcc ) = 0.
Therefore, the vector ρ is defined up to a multiplicative constant, that we shall fix later, see
(41).
Order ε2 : We have B1 ∂xx w1 = −Akc2 cos(kc x)B1 ρ. On noting that QU (w1 , w1 ) = A2 QU (ρ, ρ) cos2 (kc x),
for U = R, Q, and using standard trigonometric identities, we find that
X
 1
1
QR (w1 , w1 ) + ∂xx QQ (w1 , w1 ) = A2
Mj (ρ, ρ) cos(jkc x),
2
4
j=0,2

with Mj = QR − j 2 kc2 QQ . Computing the other terms of (37) yields the problem
X

1
F = ρ∂T1 A + Akc2 B1 ρ cos(kc x) − A2
Mj (ρ, ρ) cos(jkc x)
4
j=0,2

−A

2

bc kc2 ρ1 ρ2 e1 cos(2kc x).

By Fredholm’s alternative, (37) admits a solution if and only if hF, ψiL2 = 0, where h·, ·iL2
denotes the scalar product in L2 (0, 2π/kc ), and ψ ∈ ker((Lbc )∗ ) is of the form
ψ = η cos(kc x),

with η ∈ ker((γR − kc2 Qbc )∗ ).

(39)

For similar reasons than ρ, η is defined up to a multiplicative constant. We fix η in (41), where
it is also shown that hρ, ηi =
6 0.
The compatibility condition implies that the terms in ε of the expansions of b and T are
secular terms, and thus we impose T1 ≡ 0 and b1 ≡ 0, implying A ≡ A(T2 ). With these
restrictions,
P the Fredholm’s alternative is satisfied, and we look for a solution of (37) of the form
w2 = A2 j=0,2 w2j cos(jkc x), for which
Lbc w2 = A2

X

Lj w2j cos(jkc x),

j=0,2

15

with Lj = γR − j 2 kc2 Qbc .

G. F. de-Córdoba and G. Galiano

Then, Lbc w2 = F if the vectors w2j are the solutions of the linear systems
1
1
L0 w20 = − M0 (ρ, ρ), L2 w22 = − Mj (ρ, ρ) − bc kc2 ρ1 ρ2 e1 .
4
4
3
Order ε : Replacing w1 , w2 in the terms of G, see (38), yields
B2 ∂xx w1 = −Akc2 B2 ρ cos(kc x).

∂T2 w1 = ρ cos(kc x)∂T2 A,

Using that QR and QQ are bilinear and recalling the definition of M, we get


1
QR (w1 , w2 ) + ∂xx QQ (w1 , w2 ) =A3 cos(kc x) M1 (ρ, w20 ) + M1 (ρ, w22 )
2

1
+ cos(3kc x)M3 (ρ, w22 ) .
2
Computing the other nonlinear terms and replacing them in the definition of G given in (38),
we obtain


1
G = ρ∂T2 A + Akc2 B2 ρ − A3 M1 (ρ, w20 ) + M1 (ρ, w22 )
2
1
(2)
(1)
(1) 
− A3 kc2 bc ρ1 w2,2 e1 − A3 kc2 bc ρ2 2w2,0 − w2,2 e1
2

1 3
00
∗ 2 3
+ A a2 g (K )kc ρ2 e2 cos(kc x)
8
1
3
(2)
(1)
− A3 M3 (ρ, w22 ) + 3kc2 bc ρ1 w2,2 e1 + kc2 bc ρ2 w2,2 e1
2
2

3
00
∗ 2 3
+ a2 g (K )kc ρ2 e2 cos(3kc x).
8
The solvability condition for problem (38) is hG, ψiL2 = 0, with ψ = η cos(kc x) given by (39).
This condition leads to the differential equation
hρ, ηi∂T2 A + hG1 , ηiA + hG3 , ηiA3 = 0,
where G1 = kc2 B2 ρ = −kc2 L∗ b2 ρ2 e1 , and

1
(2)
G3 = − M1 (ρ, w20 ) + M1 (ρ, w22 ) − kc2 bc ρ1 w2,2 e1
2
1
1
(1)
(1) 
− kc2 bc ρ2 2w2,0 − w2,2 e1 + a2 g 00 (K ∗ )kc2 ρ32 e2 .
2
8
Thus, we deduce the cubic Stuart-Landau equation for the amplitude
∂T2 A = σA − `A3 ,

(40)

with σ = −hG1 , ηi/hρ, ηi and ` = hG3 , ηi/hρ, ηi. We, finally, fix the vectors ρ ∈ ker(γR−kc2 Qbc )
, and η ∈ ker((γR − kc2 Qbc )∗ ). Since γR21 − kc2 Qb21c = γK ∗ > 0, see (22), we choose the forms
ρ = (M, 1)t , and η = (1, M ∗ )t , where
M=

−γR22 + kc2 Qb22c
γR21 − kc2 Qb21c

,

M∗ =

−γR11 + kc2 Qb11c
γR21 − kc2 Qb21c

.

(41)

With this election, we have hG1 , ηi = −kc2 b2 L∗ < 0, and hρ, ηi > 0, and therefore, the growth
rate coefficient σ is always positive. As mentioned at the beginning of Sectionp
4, the dynamics of
(40) in the supercritical case, ` > 0, has the stable equilibrium solution A∞ = σ/`, representing
the asymptotic value of the amplitude. The corresponding solution may be approximated by
(32).
16

Economic model for cities emergence

References
[1] Aly, S.: Spatial inhomogenity due to Turing instability in a capital-labour model. Applied
Mathematics, 3, 172-176 (2012)
[2] Amann, H.: Dynamic theory of quasilinear parabolic systems. III. Global existence, Math.
Z. 202, 219–250 (1989).
[3] Balazsi, L. and K. Kiss: Cross-diffusion modeling in macroeconomics. Differ. Equ. Dyn.
Syst. 23(2):147166 (April 2015)
[4] Bangerth, W., T. Heister, L. Heltai, G. Kanschat, M. Kronbichler, M. Maier and B. Turcksin: The deal.II Library, Version 8.3, Arch. Numer. Software 4(100) 1–11 (2016).
[5] Chen, L. and A. Jüngel: Analysis of a multidimensional parabolic population model with
strong cross-diffusion, SIAM J. Math. Anal. 36, 301–322 (2004).
[6] Desvillettes, L., T. Lepoutre and A. Moussa: Entropy, duality, and cross diffusion. SIAM
J. Math. Anal. 46, 820–853 (2014).
[7] Emberling, G. (2015). Mesopotamian cities and urban process, 35001600BCE. In N. Yoffee (Ed.), The Cambridge World History (The Cambridge World History, pp. 253-278).
Cambridge: Cambridge University Press.
[8] Galiano, G. and M. L. Garzón, A. Jüngel: Semi-discretization in time and numerical convergence of solutions of a nonlinear cross-diffusion population model. Numer. Math. 93,
655–673 (2003).
[9] Galiano, G. and V. Selgas: On a cross-diffusion segregation problem arising from a model
of interacting particles. Nonlinear Anal. Real World Appl. 18 34–49 (2014).
[10] Gambino, G., M. C. Lombardo and M. Sammartino: Turing instability and traveling
fronts for a nonlinear reactiondiffusion system with cross-diffusion. Original, Math. Comput.
Simul. 82 1112–1132 (2012).
[11] Gambino, G., M. C. Lombardo and M. Sammartino: Pattern formation driven by crossdiffusion in a 2D domain. Nonlinear Anal. Real World Appl. 14 1755–1779 (2013).
[12] Jüngel, A.: The boundedness-by-entropy method for cross-diffusion systems. Nonlinearity
28 1963 (2015).
[13] Hille, T. and K.J. Painter: A users guide to PDE models for chemotaxis. J. Math. Biol. 58,
183217 (2009)
[14] Keller, E.F. and L. A. Segel: Model for chemotaxis. J. theor. Biol. 30 225–234 (1971).
[15] Krugman, P.: Increasing returns and economic geography. Journal of Political Economy.
99 (3), 483-499 (1991)
[16] Layson, S.: The increasing returns to scale CES production function and the Law of diminishing marginal returns. Southern Economic Journal. (2014)
17

G. F. de-Córdoba and G. Galiano

[17] Shigesada, N., K. Kawasaki and E. Teramoto: Spatial segregation of interacting species. J.
Theoret. Biol. 79 83–99 (1979).
[18] Tabuchi, T. and J. F. Thisse: A new economic geography model of central places. Journal
of Urban Economics 69 240252 (2010)
[19] Turing, A.M.: The chemical basis of morphogenesis. Philos. Trans. R. Soc. Lond. B 641,
3772 (1952)

18

