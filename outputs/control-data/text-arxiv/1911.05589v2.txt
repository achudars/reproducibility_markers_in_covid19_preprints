MOTH- Mobility-induced Outages in THz:
A Beyond 5G (B5G) application
Rohit Singh 1 , Douglas Sicker
1

arXiv:1911.05589v2 [cs.NI] 19 Nov 2019

2

1,2

, Kazi Mohammed Saidul Huq

3

Engineering & Public Policy, Carnegie Mellon University, Pittsburgh, USA
School of Computer Science, Carnegie Mellon University, Pittsburgh, USA
3
Instituto de Telecomunicaes, Aveiro, Portugal
Email: rohits1@andrew.cmu.edu, sicker@cmu.edu,kazi.saidul@av.it.pt

ABSTRACT

I. I NTRODUCTION

5G will enable the growing demand for Internet of Things
(IoT), high-resolution video streaming, and low latency wireless services. Demand for such services is expected to growth
rapid, which will require a search for Beyond 5G technological
advancements in wireless communi- cations. Part of these
advancements is the need for additional spectrum, namely
moving toward the terahertz (THz) range. To compensate for
the high path loss in THz, narrow beamwidths are used to
improve antenna gains. However, with narrow beamwidths,
even minor fluctuations in device location (such as through
body movement) can cause frequent link failures due to beam
misalignment. In this paper, we provide a solution to these
small-scale indoor movement that result in mobility-induced
outages. Like a moth randomly flutters about, Mobilityinduced Outages in THz (MOTH) can be ephemeral in nature
and hard to avoid. To deal with MOTH we propose two
methods to predict these outage scenarios: (i) Align-AfterFailure (AAF), which predicts based on fixed time margins,
and (ii) Align-Before-Failure (ABF), which learns the time
margins through user mobility patterns. In this paper, two
different online classifiers were used to train the ABF model
to predicate if a mobility-induced outage is going to occur;
thereby, significantly reducing the time spent in outage scenarios. Simulation results demonstrate a relationship between
optimal beamwidth and human mobility patterns. Additionally,
to cater to a future with dense deployment of Wireless Personal
Area Network (WPAN), it is necessary that we have efficient
deployment of resources (e.g., THz-APs). One solution is to
maximize the user coverage for a single AP, which might be
dependent on multiple parameters. We identify these parameters and observe their tradeoffs for improving user coverage
through a single THz-AP.

Various reports predict that in the next 5 years, wireless
traffic will increase by 9-fold for on-demand and streaming
games and by 12-fold for Virtual Reality (VR) and Augmented
Reality (AR) services [1]. Given this trend, the demand for
data rates will only increase in the near future. One of the key
features of 5G is Ultra Reliable Low Latency Communications
(URLLC) to support high-speed gaming, multimedia (stored
and live), and yet-known killer applications [2]. The successful
deployment of 5G will promote the densification of devices
requiring an ultra-high-speed of 10Gbps, a demand that will be
hard for 5G technology to meet. We need fast and smart solutions to reduce latency, and support data rate demands Beyond
5G (B5G) [3]. Fast encoding schemes [4] and caching content
close to the edge through Content Delivery Networks (CDNs)
[5] help but will not be enough in the future. Compressing and
uncompressing videos results in unnecessary delays, which
could have been used for transmitting more data. To transmit
uncompressed video over-the-air requires more bandwidth;
thus, we need more spectrum. The lower radio frequency bands
(< 10GHz) are almost saturated and require co-existence
strategy [6] to be used for multimedia streaming. Moreover,
the available bandwidth in the lower bands is one-order of
magnitude less compared to the bandwidth available in higher
frequency, such as mmWave, THz, infrared, and visible light.
Finding additional bandwidth in the higher frequency is a
viable option to be considered for future B5G applications.
The Terahertz (THz) band (300GHz −10T Hz) is a promising area of additional bandwidth, possibly helping to push data
rates up to 1T bps. The THz band is optimally located in the
electromagnetic spectrum between the microwave and infrared
bands [7]. In the future, THz band applications could be useful
for VR, AR applications [2], tactile internet, video streaming,
healthcare, and public safety. Despite the tremendous potential,
it also comes up with new challenges, which were not seen
in the lower spectrum bands. Issues like molecular absorption,
fast spread, and low penetration power can be challenging to
deal with [3] [8] [9]. THz is quite sensitive to blockages, even
humans [14], resulting in outages. Thus, THz is envisioned to
be used for short-range ultra-high data rate communication in
an indoor environment, especially for Wireless Personal Area
Networks (WPANs) [15].

K EYWORDS
Beyond 5G (B5G), Terahertz (THz), Indoor Mobility, Beam
Alignment, Online Perceptron, Online Stochastic Gradient
Descent (SGD).
This
project
was
funded
by
CMU
Portugal
Program:
CMU/TMP/0013/2017- THz Communication for Beyond 5G Ultra-fast
Networks.

One of the promising solutions to gain higher throughput
in THz band is the use of narrow beams to increase the
antenna gain [10] [11]. Although narrower beamwidth results
in higher antenna gains, it demands beam alignment between
the access point (AP) and the user equipment (UE) [12]. Due
to lower penetration power and beam misalignments resulting
from the rapid mobility of the devices, it can cause connection
outages, i.e., mobility-induced outages in THz (MOTH). These
small-scale outages are ephemeral in nature, similar to the
random fluttering of a moth (an insect). Unlike an insect moth,
MOTH can be destructive for wireless mobile communication.
By modeling this small-scale user movement and device
orientation [12], we can avoid MOTH. An alternative solution
to avoid MOTH is to increase the number of APs with overlapping coverage areas that can aid in decreasing the probability
of these outages [13], but this increases power usage, handoff
issues, waste of resources, and can still maintain uncertainty.
Thus, it might be worth exploring methods that can improve
user-coverage through a single AP and at the same time, avoid
these mobility-induced outages.
Currently, there is little research aimed at managing or
mitigating these mobility-induced outages. Most of the existing research is focused on improving the average throughput through information-shower [16], identifying conservative
frequency windows with minimal path loss [17], distance,
and bandwidth adaptive methods [18], or improving video
streaming using local cache [19]. Analyzing mobility-induced
outages for indoor users specifically in the THz band is critical
to improving the quality of service (QoS) and throughput.
Definition of mobility management changes as we enter the
THz band. We are not only interested in the location and
velocity of the user equipment, but also interested in the smallscale mobility, as the orientation of the device and the sudden
oscillations on x, y or z axes. Some researchers have used user
mobility data to consider tradeoffs between throughput and
optimal beamwidths [20] [12], but it did not provide a solution
or a framework to deal with this problem. There is ample
research that proposes smart antennas to deal with interference
and throughput related issues [21] [22], but most of these
methods work on a batch model (i.e., train the model with
pre-fetched data). Here, we propose online training models
that learn the users’ mobility patterns on-demand and predict
outage scenarios. Although there is quite a bit of randomness
associated with the user's mobility when using AR and VR
applications, we try to model these on a scenario-wise basis. It
might be hard for machine learning algorithms to predict users’
actions based on random action on all degrees of freedom;
however, it is much easier when these movements are grouped
into scenarios. In this paper, we propose that form of grouping.
In this paper, we provide a solution to manage smallscale indoor mobility by reducing the time spent in the
mobility-induced outages in THz (MOTH) 1 . MOTH uses
state transition diagrams to model these small-scale mobility
1 Please note that physical blockages also result in outages. However,
through MOTH, we try to identify outages that can result from small-scale
mobility and narrow beamwidths in the THz, and provide solutions after that.

Fig. 1: Achievable data rate for different dj for a fixed relative
humidity ρ = 20% and beamwidth δ = 10°.
scenarios and propose a solution to mitigate these outages.
Every time there is an outage the antennas at the AP and UE
have to realign themselves, which is costly concerning time,
i.e., the outage time (OT) and the realignment time (RT). For a
single user scenario, it causes a decrease in throughput, while
for a multi-user scenario, it also decreases user coverage. One
solution is to make beam alignment as fast as possible [23],
which is critical, but it does not reduce the outage time, and
not what we are focusing on. Instead, we can try to predict
these outage scenarios and avoid these time-consuming events.
To do so, we explore two methods: Align-After-Failure (AAF)
and Align-Before-Failure (ABF), which seek to predict these
outages either through a hard margin specific to a system or
a margin that can be learned by the system through observing the mobility patterns. Furthermore, we observe that for
some fixed system parameters and mobility pattern, there are
optimal beamwidths that can minimize the misalignment rate
and maximize the user coverage. We show that beamwidths
narrower than body rotation (yaw, pitch, and roll) may suffer
from frequent misalignments if not appropriately monitored.
Although increasing the number of APs will aid in improving
the user coverage, to maximize the resource utilization, we
analyze the case for a single AP and explore solution space.
The rest of the paper is organized as follows. In section II,
we discuss the system parameters that can maximize throughput by antenna gains and adaptive-frequency window selection
and the mobility patterns associated with the human body in
an indoor setting. By identifying these mobility patterns, we
can reduce the need for beam alignments and outage time,
either through hard time margins or dynamically learning these
margins, as explained in section III. We evaluate our proposed
methods in section IV and conclude in section V.
II. M ODELS AND A SSUMPTIONS
In this section, we briefly discuss the system models and
assumptions that are applied in this paper.
A. Link Budget Model
One of the biggest challenges in THz communication is
high absorption loss LA and spreading loss LS , which are
dependent on parameters, like the operating frequency f , water

and UE can adaptively select a frequency-window, based on
the parameters mentioned.
B. Mobility Model

Fig. 2: Rate of change in yaw, pitch and roll for different
human action types.
vapor concentrations ρ [26] and the distance between the
transmitter (TX) and receiver (RX) pair dj (Note: we drop
the index for TX since we are analyzing only one AP for
efficiency). The total path loss LT can be represented through
Equation 1, where K is the medium absorption coefficient
dependent on the frequency range, relative humidity ρ, fc is
the center frequency, d is the seperation, and c is the speed
of light. For the rest of the paper, we have considered a
ρ of 5g/m3 (20% humidity at room temperature of 25°C).
To compensate for the high path loss, we need to increase
the transmit power, which is still a challenge for small THz
antennas. We keep transmit power fixed at 0dBm [17] and
explore other workarounds, like antenna gain and bandwidth.
LT = LA (f, d, ρ)LS (f, d) = eK(fc ,ρ)d ((4πdj fc )/c)2

(1)

The data rate Rj for the user j can be defined as Rj =
Bj log(1 + SN Rj ), where Bj is the bandwidth and SN Rj is
the signal-to-noise ratio 2 . We can further calculate SN R and
represent Rj as shown in Equation 2, where Pt is the transmit
power of the TX, Gt and Gr are gains at that TX and RX
respectively, and No is the noise power spectral density of
−193.85dB/Hz. For simplicity, we assume an antenna pattern
with perfect conical shaped main lobe [20], with the vertical
and the horizontal beamwidth equal, i.e., δh = δv = δ.
Pt ∗ Gt (δ) ∗ Gr (δ)
)
(2)
LA (fc , dj ) ∗ LS (fc , dj ) ∗ No ∗ Bj
Based on Equation 2 , we can estimate the achievable data
rate for different dj and center frequency fc as shown in Fig. 1.
Since the LT changes with every GHz of frequency, which
in turn changes the available bandwidth Bj 3 , we measure
the achievable data rate in Gbps/GHz. Although Rj scales
with δ, the sudden data rate dips become prominent as we
increase the separation dj . Thus, to obtain higher throughput,
it is necessary that we have larger bandwidth, in other words,
more continuous frequency-windows. We assume that an AP
Rj = Bj log(1 +

2 Please note that we did not consider signal-to-interference-noise ratio
(SNIR), since in THz due to low penetration power and directional antennae
interference is considered to be negligible.
3 The absorption loss in the THz spectrum is sensitive to multiple environmental factors, as shown in Fig. 1. Thus, the frequency-windows or the
available bandwidth will change based on the path-loss LT .

Despite the challenges associated with THz, using directional antennas with narrow beams can aid in communicating
at ultra-high data rates. For narrow beamwidths, we need
almost perfect alignment between the TX-RX antennas. These
devices are highly sensitive to the orientation of the device
and/or the object on which they are associated, i.e., fluctuations of hand, body, and head movement. Most of the THz
applications, like VR and AR, will require fast body and hand
movements; thus, compelling a user to move in all six degrees
of freedom (DoF), with occasional body movements, such as
stand, kick, duck, rotate, and dodge. Whether it is a highintensity game or even a constrained indoor mobility scenario,
such as walking or standing, narrow beam, THz communication links are susceptible to frequent misalignments. However,
most of this movement follows a pattern. For example, in
case of action games, particular movements are game-specific
and are repeated quite often, or in case of regular walking,
the body repeats a particular velocity and movement pattern.
These features of human body movement can be parameterized
for specific service types to provide the best QoS, namely High
Mobility (e.g., high intense games) and Constrained Mobility
(e.g., fast and slow walking).
Now that we have classified mobility patterns based on
service types, it will be interesting to explore how the choice
of beamwidths for each service type can affect the system
throughput. For beamwidths wider than the rotational parameters of a particular service type, the location parameters will
be prominent in identifying the occurrence of misalignments.
While for relatively narrower beamwidths, misalignments will
be sensitive to the rotation parameters. The yaw, pitch, and
roll rotation represent a sinusoidal wave, where the rate is
dependent on the user mobility type, as shown in Fig. 2 [24].
Fig. 2 implies that beamwidths narrower than body rotation
may suffer from frequent misalignments if not appropriately
monitored. A detailed mobility model is shown in [12].
Please note a Time Division Duplexing (TDD) spectrum
usage model is assumed, with a common channel for the users
to communicate control signals with the AP. In a TDD model,
a user can occupy the whole channel for a portion of the
time slot, which is called Channel Occupancy Time (COT).
We assume an adaptive COT value based on the user demand
and distribution [27], i.e., COTji = Tslot ∗ Rj∗ /Rji , where
Tslot is the time slot for users to contest for a channel (or
simulation time), Rj∗ is the requested data rate for user j, Rji
is the data rate available at time i. Since the system is blind
to the mobility parameters of a user, the AP uses the ACK
message to decide a successful communication and waits for
a time Tf ail . For a failed communication, the COT, along with
the Tf ail can be termed as the outage time (OT). While after
each failure, the time required to perfectly align the beams
between a TX-RX can be termed as Talign or the realignment
time (RT).

Fig. 3: Different Scenarios of Link Success and Failure.
III. B EAM A LIGNMENT S TRATEGY
In this section, we model the small-scale mobility scenarios
into state transitions. We identify the successful states and the
outage states, quantify the time spent in each state, and propose
methods to minimize the time spent in the outage states.
A. MOTH State Transitions
Due to different user mobility patterns discussed in Section
II-B, the average throughput will vary. To avoid throughput
drops in these scenarios, continuous beam alignment between
the TX-RX pair is required, which consist of beam steering
and beam training, i.e., the realignment time (RT). Time
for beam alignment can grow as high as 100ms depending
on the system and beam learning process. Let us assume a
fast alignment of Talign = 5ms [23] and explore methods
through which we can reduce this 100% need for perfect beam
alignment, as shown in part (a) of Fig. 3.
In a highly mobile scenario, the RT and OT will snowball as
the number of users increases. Even small-scale orientational
changes can cause outages. As shown in Fig 3, we identify
these small-scale mobile scenarios a TX-RX can encounter.
We group these movements based on the success/failure of a
link and the change in location/orientation of the UE relative
to a fixed AP. Case (a) of Fig. 3 represents a perfect-alignment
between the TX and RX beams, which falls under a successful
communication. However, in special scenarios, it might not
be necessary always to have a perfectly aligned beam for
successful communication, as shown in the case (b) of Fig.
3. For example, we can still communicate with a misaligned
link (named as partially-misaligned) as long it can provide the
requested data rate Rj∗ for a user j, as shown in part (b) of Fig.
3. On the other hand, links might fail when the location (X, Y ,
and Z coordinates) of a UE changes or if the orientation (yaw,
pitch, and roll) has changed, as shown in cases (c) and (d) of
Fig. 3 respectively. For example, for case (d) in Fig. 3 even
if the user is within the AP’s beam range, due to rotational
motion of a user, it is a failed link.
Based on our four-case analysis shown in Fig. 3, for a
small change in time, TX-RX pairs relative locations and
orientations can be bucketed into four states (a) to (d), resulting
in a state transition diagram, as shown in Fig. 4a. In Fig. 4a
state (a) is perfectly aligned beam between a TX-RX pair,

while states (b), (c) and (d) are beam misalignments. State
(b) is a partially-misaligned link subjected to the requested
data rate Rj∗ . Please note that for a heterogeneous data rate
distribution, the state transition will be unique for each TX-RX
pair, to be considered as a successful link. Similarly, from the
explanation mentioned above, states (c) and (d) are considered
as failure states. Thus, the transition between states (a) and (b)
are considered as successful links, which does not involve any
RT or OT, while states (c) and (d) are considered failed links,
which costs RT. The transition between (b) and failed link sates
are momentary based on relative orientation changes and costs
OT. A beam alignment can trigger the transition from the state
(b) to (a), which will cost RT.
The time spent in each state, τ s where s is the state is
different and can significantly affect the system throughput.
The users are provided with the best achievable data rate, Rji ,
based on the environmental factors. At each state, we assume
that the user occupies the channel, and some data is being
transmitted, which cost COTji time. For state (a), a perfect
alignment state will cost τ a = Talign +COTji . Comparatively,
state (b) can maintain connection without link failure (although
with a reduced data rate of the bare-minimum data rate), which
costs τ b = COTji and does not need any extra time of Talign .
On the other hand, states (c) and (d) are the mobility-induced
outages, which costs τ c/d = Tf ail + COTji . Since the users
are free to move in all six degrees of freedom, a TX-RX pair
can transition or loop around the state (b), (c) and (d), unless
a perfect alignment is triggered.
Our objective is to reduce the total time spent by a TXRX pair transiting through these sates. To do so, we propose
improvements over the normal transition diagram, i.e., AlignAfter-Failure (AAF) and Align-Before-Failure (ABF), shown
in Fig. 4b and 4c respectively. In AAF, as shown in Fig. 4a,
a perfect alignment (edge 2) is delayed until a link failure
occurs, i.e., a transition to states (c) and/or (d). AAF drops
edges 5 and 6, i.e., it does not allow transitions between
state (b) and states (c)/(d) and triggers a transition to state
(a) instead. AAF reduces significantly the oscillation between
successful and failure states, which ought to happen in a smallscale mobile scenario. However, AAF can still go to failure
state, causing unnecessary OT. A further improvement is to
dynamically learn the mobility pattern of the user and make
state transitions on-demand basis, as shown in Fig. 4c. In ABF,
we introduce a new learning state (e) that uses previous user
mobility patterns to predict if the next user action will lead to
a successful or failure link. The transition from the state (e)
to either a successful or a failure state depends on the choice
of the classifier, user mobility type, environmental factors, and
data availability. We assume an online model where the state
(e) receives user mobility data on-demand basis through a
common-channel communicated between the TX and RXs.
B. Align After Failure (AAF)
In AAF, the AP decides to perform a perfect beam alignment
after a pseudo-failure has occurred. A pseudo-failure is one
where the AP waits for Tf ail time for an ACK message to

(a) Normal State Transition.

(b) AAF State Transition.

(c) ABF State Transition.

Fig. 4: Link success-failure state diagram for a TX-RX pair (states shown in Fig. 3).
Algorithm 1: Method 1- Align After Failure (AAF) for
Single User j.
1
2
3
4
5
6
7
8

begin
Set φ0 = Align()
for i ∈ 1, 2, · · ·, M do
Transmit(φi )
if W aitF orACK() > Tf ail then
φi = Align()
else
φi = φi−1

arrive before it infers that the link has failed. It is possible
that in reality, the link has not failed, but this is a conservative
choice that the algorithm makes to reduce the total time. The
choice of Tf ail can affect the efficiency of the method and
can be computed based on the user service type and/or the
system objective. For the sake of analysis, let us assume that
the Tf ail = α∗Tslot , where α is a fraction and can be adjusted
based on the system sensitivity.
A detailed pseudo-code for Method 1 for a single user
is shown in Algorithm 1. Let us assume a method Align()
that performs perfect alignment between the TX-RX antennas,
i.e., the transition to state (a), as explained above in the
state diagrams. It returns a value of φ, which is the relative
transmission angle with the best achievable throughput. Let
us assume that at time step 0 the beams are perfectly aligned
at angle φ0 . For each time slot i ∈ M , where M is the
simulation time, Method 1 will check for a pseudo-failure.
In Line 5, the function W aitF orACK() is a timer to assure
that the transmission does not take more than time Tf ail . In
case of successful communication, the previous transmission
angle φi−1 is retained; otherwise, a new beam alignment is
triggered.
C. Align Before Failure (ABF)
Although Method 1 can reduce the number of outage scenarios by considering a hard margin of Tf ail , it still costs more
time and might make false predictions on link failures. Instead
of assuming a hard margin, a better method will be to learn
this margin dynamically based on user mobility patterns. This
form of learning, i.e., online learning, improves its prediction
with every new data set. Now, for the state (e), as shown in

Fig. 4c, we need a classifier algorithm that classifies between
a partially-misaligned, i.e., state (b), and a mobility-induced
outage scenario, i.e., states (c) and (d). We consider two
alternatives a single neuron online-perceptron model [28] and
an online stochastic gradient descent (SGD) [28] to learn the
classification threshold dynamically for each user individually.
Although online-perceptron is faster, it draws a liner decision
boundary which can often come up with the wrong prediction
when trained with outlier data points. An improvement over
this will be to uses online-SGD that draws a probabilistic
decision boundary, but it is slow to train. Let us name the
classifiers perceptron and SGD used in state (e) as Method 2
and Method 3, respectively. Please note that other state-of-theart binary classification algorithms could be used to gain better
results. In this paper, we merely are demonstrating the use
of these algorithms to improve performance. To understand
the relationship of user mobility, algorithm learning speed,
and algorithm accuracy to make predictions adaptively, we
consider these two forms of online classifiers.
As explained earlier, link failure can happen due to a change
in location or orientation. It can also occur due to an object
entering the path. Therefore, we need to train the classifier
using user mobility parameters. Gain at both TX and RX,
i.e., Gt and Gr , are directly related to the relative location.
Additionally, we are not interested in the exact gain value
or the exact location for a user at time instance i, but the
amount of change in gains and data rate, i.e., ∆Gt , ∆Gr , ∆R,
compared to time instance (i − 1) that will trigger a need for
beam alignment, i.e., a transition to state (a). Let us name these
three features collectively as Qij for a user j at time instance
i. The choice of features is such that they linearly separate the
data, one of the necessary conditions for a simple perceptron.
Moreover, the transition in or out of state (b) is dependent
on the requested data rate, which makes it necessary for the
classifier to consider the data rate as a feature.
The objective of ABF is to reduce (i) the number of
beam alignments required, and (ii) the time spent in failure
states. Thus, let us define two sets of classes: “1” need for
beam alignment (or a probable transition to failure states) and
“0” otherwise (or a probable transition to successful states),
represented by yji for a user j at time instance i. Intuitively, the

Algorithm 2: Method 2 & 3- Align Before Failure (ABF)
for Single User j.
1
2
3
4
5
6
7
8
9
10
11
12
13
14

begin
Set φ0 = Align(), net = LearnAlign(y 0 , Q0 )
for i ∈ 1, 2, · · ·, M do
ŷ = P redict(net, Qi )
if ŷ == 1 then
φi = Align()
Transmit(φi )
else
Transmit(φi−1 )
φi = φi−1
if W aitF orACK() > COT i then
net = LearnAlign(1, Qi )
else
net = LearnAlign(0, Qi )

predicted label ŷ 0 or 1 will result in edges 11 and 12, as shown
in Fig. 4c. A transition to state (b) means that beam alignment
is not required, and the TX-RX can maintain the previously
aligned angle φi−1 , or update it otherwise, i.e., φi = Align().
Every service type has a pattern (introduced in Fig.
2), and with each new data point (yji , Qij ) the classifier will try to draw a decision boundary that can separate the two classes 0 and 1. With every new data
point [(yj0 , Q0j ), (yj1 , Q1j ), (yj2 , Q2j ), · · ·, (yjN , QN
j )], the classifier will keep modifying the decision boundary by updating
the gradients ωki for every time instance i and feature k
in set Qj . We assume that a bias term is already present
in the set ω, which corresponds to a set of 1's appended
in the set Qj . In Method 2, the gradient update rule is
based on the sign activation function, while in Method 3
the update rule will be probabilistic, with sigmoid activation
function. Therefore, the predicted label ŷ for Method 2 will
be sign(ω T Q
Q) and for Method 3 will be argmaxω p(y | Q),
ωT Q
where p(y | Q ) = 1/(1 + exp(−(ω
Q)) is the conditional
probability. Let ω and Q denote vectors, and assume a learning
rate η = 0.01.
A generalized pseudo-code for both Methods 2 and 3 for
a single user is shown in Algorithm 2. Assume a method
LearnAlign(y i , Qi ) that learns the decision boundary measured by the feature parameters Qi and label y i . Let the
classifier used in the method LearnAlign() emulate an
online-perceptron and online SGD as explained above. At the
initialization phase, we assume that the beam is perfectlyaligned, thus the label y 0 = 1. For a time instance i, let us
consider a sample data point (ŷ, Qi ), where ŷ is the predicted
label shown in Line 4. Based on the prediction made by the
classifier ŷ, we decide if we need a perfect beam alignment
or if we can still transmit in a partially misaligned angle φi .
If ŷ == 1, then we align the beams and transmit at a new
transmit angle φi . Otherwise, for ŷ == 0, we assume that the
user is still partially-misaligned and transmit at angle φi−1 . In
the case of a no alignment prediction, we retrain our model
by checking for the true label based on the arrival of the ACK
message. We retrain the model at Lines 12, 14 with label 1
if the ACK message arrives after COT i and 0 otherwise, as
true labels for Qi .

TABLE I: User Mobility Parameters.
S1
S2

∆x,∆y
1 ± 0.5
0.9 ± 0.7

∆z
0.5 ± 0.05
0.094±0.02

Yaw
15.5°
4°

Pitch
13.8°
5°

Roll
15°
5°

Fig. 5: Accuracy analysis for 40 different user traces.
IV. E VALUATION
In this section, we evaluate the efficiency of our proposed
methods and the classifiers. We then analyze how effectively
MOTH is detected for a single and multi-user setting.
A. Environmental Setting
For the simulations, we considered a cube room of 6m with
N = 40 active users following a random waypoint model
coupled with the mean and standard division of the location
parameters mentioned in Table I [25] [24]. Each user can
belong to either of the two service types, S1 or S2, with
each UE requesting a minimum of 10Gbps speed per time
slot. The AP is placed at the middle of the ceiling, with
adaptive frequency and bandwidth selection. Let us consider
low transmit power devices of 0dBm idle for WPAN.
Please note that to calculate the resultant z coordinate
for UEs, we add the ∆z oscillation over average human
standing height of 1.5m. To calculate the rotational changes,
we use the peak values of the rotation parameters mentioned
in Table I to replicate a sinusoidal wave pattern shown in
Fig. 2. Please note that while a body is in motion, the pitch
and roll movements suffer through alternative deacceleration
and acceleration, which might not present when a body is
sedentary [24]. For a real emulation, we allow the rotational
movements to vary by a small amount of noise.
B. ABF Correctness Analysiss
Before we move on comparing Methods 1-3 for a single and
multi-user setting, let us analyze the accuracy of the prediction
algorithms used in Method 2 and 3. To quantify the correctness
of our model, we use the classical parameters such as accuracy,
precision, recall, and F1 score [28].
In our ABF model, true-positive (TP) is the correctly
predicted beam alignment required, true-negative (TN) is the
correctly predicted no-beam alignment required, false-positive
(FP) is the incorrectly predicted beam alignment required,

Fig. 6: Accuracy analysis for ABF.

Fig. 7: Precision analysis for ABF.

Fig. 8: Recall analysis for ABF.

Fig. 9: F-1 score analysis for ABF.

and false-negative (FN) is the incorrectly predicted no-beam
alignment required. Accuracy is the ratio between the correctly predicted observations to the total observations, i.e.,
T P +T N
T P +F P +F N +T N . We have considered N different random
human movement traces based on the parameters mentioned
in Table I. For these N different traces, the accuracy oscillates
between 40% to 80%, as shown in Fig. 5, and variance is
subjected to the method type and user movement pattern.
For service type S1, Method 2 has higher accuracy compared
to Method 3, while for service type S2 the accuracy almost
overlays for both the methods.
The result shown in Fig. 5 gives the impression that the
prediction efficiency is likely dependent on the user mobility
pattern. Furthermore, the antenna gain is subjected to the relative antenna angles and the antenna beamwidths δ. On average,
for all N users, the accuracy stabilizes as the beamwidth
increases, as shown in Fig. 6. However, the correctness of
the models changes with beamwidth for both service types.
For S1 users, which have high yaw, pitch and roll oscillations,
Method 2 works better than Method 3 for beamwidths ≤ 15°
and the opposite for beamwidths less than > 15°. A similar
effect is observed in S2, with a much lower pivot point. These
pivot points are influenced by: (i) the rate of change of device
orientation, and (ii) the chances of the user aligning with
the AP antenna beam. For example, with a narrow antenna
beamwidth and a higher rate of change of orientation, the user
is likely to suffer mobility-induced outage and will require

frequent beam alignments. A slow learning Method 3, which
uses SGD, will take more time to correctly predict a need
for beam alignment, while a quick learning perceptron will
accurately identify these scenarios.
Although accuracy is a good measure to check the correctness of a model, it is useful in case the cost of FP and
FN are almost the same. However, in our case a FP can cost
τ a and a FN can cost τ c/d . Thus, it might be beneficial to
look at precision, recall, and F1-score. Similar pivot points, as
explained above, are observed in Fig. 7-9. On average, both
methods show high recall and low precision. Low precision
results in high FP, while high recall results in low FN. Since
the user movements are quite random on all the 6-DoF planes,
both methods become conservative and realign the beams most
of the time, i.e., predict more FP over FN. In our simulation
τ c/d > τ a , so we are better off with high recall values and
low precision. To analyze the tradeoff between precision and
recall for varying antenna beamwidths, we use the F1-score.
The F1-score is the weighted average between precision and
recall. Fig. 9 shows a high F-1 score above 50% for service
type S1 for both models and a relatively lower score of 30%
for service type S2.
C. Single User Analysis
Now that we have analyzed the correctness of the models
let us analyze how the models allocate radio resources for
a single-user and multi-user setting. Before we move on to
a multi-user scenario, let us evaluate the average number of

beam alignments required for a single user. Please note that
a trivial case of perfect beam alignment will result in 100%
alignment irrespective of beamwidth and/or service type. It
can be observed from Fig. 10 that compared to Method 1
(with α = 0.25), both Methods 2 and 3 can reduce the
need for beam alignments significantly. Method 1 might not
seem to be beneficial for service type S1, but for service
type S2 (constrained mobility) all three methods show similar
misalignment rates. Thus, Method 1 can be used in scenarios
where the location is changing relatively linearly or if a user is
relatively sedentary. Although the misalignment rate for both
Methods 2 and 3 decreases with increase in beamwidth, there
are significant gaps between the results based on service type.

beamwidth, the probability of misalignment increases. Thus,
Fig. 12 shows peaks that are dependent on the service types.
For both S1 and S2, Methods 2 and 3 shows significant
improvement compared to Method 1 (shown in Fig.s 13 and
14). For S1 at very low δ, Method 2 performs much better
than Method 3 because of the slow training rate of SGD. In
Method 2, the online-perceptron quickly predicts the need for a
beam alignment before a failure can occur. Although Method 3
performs better after δ opt ≥ 18° the improvement is marginal.
For S2 on an average Method 3 performs better than Method
2 for δ opt ≥ 5°. Method 3 in S2 does show a dip in user count
for δ = 3°, which can be due to the very small yaw, pitch and
roll movements of the human body shown in Table I. Although
for higher δ values, one can be indifferent between Methods 2
and 3, the choice of method might be sensitive as the APs and
UEs scale up significantly. Please note that in our analysis,
we assume the AP satisfies all UEs with the same optimal
beamwidth; however, there can be user-specific beamwidths
that can eventually result in both higher throughput and higher
misalignment rate.
V. C ONCLUSION

Fig. 10: Percentage of beam alignment required for different
service types and antenna beamwidths.
D. Multi User Analysis
Fig. 11 - 14 shows the misalignment rates and user coverage
for a multi-user setting for Methods 1, 2, and 3. Since for
Method 1, the model is sensitive to the value α, i.e., Tf ail =
α ∗ Tslot we analyze the Method 1 separately. Although the
misalignment rate for each user decreases with increase in
beamwidths (shown in Fig. 10), for a multi-user setting, we
observe user coverage peaks for certain δ and service types. At
higher δ, the antenna gains decrease and the COTji increases,
thus reducing the user count. Despite higher gains at very low
δ, there are frequent misalignments due to yaw, pitch, and roll
motions of the human body resulting in lower user coverage.
Thus, we can observe that there are δtopt , t ∈ S1, S2 for all
three methods.
It is quite logical that misalignment rate for S1 (high
mobility) will be greater than the rate for S2 (constrained
mobility) due to the variability of the six DoF. As the δ
value increases from 1° to 40°, the average misalignment rate
decreases rapidly for Method 1, as shown in Fig. 11. The
choice of α shows a significant effect in the case of S1. As
the α value increase, the time occupied by a user j at each time
slot also increases, eventually decreasing the net user count.
However, Method 1 cannot outperform Methods 2 and 3 shown
in Fig. 12. It seems when the yaw, pitch, and roll motions of
the human body, as assumed in Table I, are comparable to the

In this paper, we have proposed methods through which
mobility-induced outages in THz (MOTH) can be reduced. It
was interesting to observe that there exist optimal beamwidth
values concerning the user service type and can be sensitive to
the yaw, roll, and pitch of the body. We used the user orientations and different service types as a measure to predict an
upcoming outage scenario. Both methods, Align-After-Failure
and Align-Before-Failure, can show a significant decrease
in outages; thus, increasing user coverage. Although ABF
outperforms AAF in most cases, AAF can be used for static
uses or constrained mobility scenarios. In ABF, the choice
of the classifier will depend on system objective (throughput
or user coverage), availability of resources (beamwidths),
and environment (user service types). Indeed, the proposed
methods can be deployed scenario-wise based on optimalbeamwidth values. In future work, we will study user coverage
and misalignment rates in a multi-user/service setting.
R EFERENCES
[1] “Cisco Visual Networking Index: Forecast and Trends, 2017-2022,”
Cisco, San Jose, CA, USA, Feb 2019.
[2] “Augmented and Virtual Reality: the First Wave of 5G Killer Apps,”
ABI research, Qualcomm, Jan 2017,
[3] R. Singh, D. Sicker, “Beyond 5G: THz Spectrum Futures and Implications for Wireless Communication,” in Proc. of 30th European Regional
International Telecommunications Society (ITS) Conference, 2019.
[4] G. Baig, J. He, M. A. Qureshi, L. Qiu, G. Chen, P. Chen, Y. Hu,
“Jigsaw: Robust Live 4K Video Streaming,” in Proc. of the 25th
Annual International Conference on Mobile Computing and Networking
(MobiCom), 2019.
[5] Y. Tang, X. Li, Y. Liu, C. Liu, Y. Xu, ”Review of content distribution
network architectures,” in Proc. of 3rd International Conference on
Computer Science and Network Technology, 2013.
[6] R. Singh, ”Spectrum Sharing Opportunity for LTE and Aircraft Radar
in the 4.2 - 4.4 GHz Band,” M.S. thesis, Dept. Comput. Sci., Illinois
Institute of Tech., Chicago, USA, 2017.
[7] R. Singh, W. Lehr, D. Sicker, K. M. S. Huq, “Beyond 5G: The
Role of THz Spectrum,” in Proc. of the 47th Research Conference on
Communication, Information and Internet Policy (TPRC), 2019

Fig. 11: AAF Misalignment.

Fig. 12: ABF Misalignment.

Fig. 13: AAF User Coverage.

Fig. 14: ABF User Coverage.

[8] S. A. Busari, K. M. S. Huq, S. Mumtaz, J. Rodriguez, “Terahertz
Massive MIMO for Beyond-5G Wireless Communication,” in Proc. of
IEEE International Conference on Communications (ICC), 2019.
[9] K. M. S. Huq, et.al.,“Terahertz-Enabled Wireless System for Beyond5G Ultra-Fast Networks: A Brief Survey,” IEEE Network, vol. 33, no.
4, pp. 89-95
[10] M. K. Haider, Y. Ghasempour, D. Koutsonikolas, E. W. Knightly, “LiSteer: mmWave Beam Acquisition and Steering by Tracking Indicator
LEDs on Wireless APs,” in Proc. of the 24th Annual International
Conference on Mobile Computing and Networking (MobiCom), Oct.
2018, pp. 273-288,
[11] Q. Z. Sai, H.T. Kung, Y. Gwon, “InferBeam: A Fast Beam Alignment
Protocol for Millimeter-wave Networking,” Feb 2018. Available: https:
//arxiv.org/pdf/1802.03373.pdf.
[12] R. Singh, D. Sicker, “Parameter Modeling for Small-Scale Mobility in
Indoor THz Communication,” in Proc. of IEEE Global Telecommunications Conference (GLOBECOM), 2019.
[13] A. Moldovan, P. Karunakaran, I. F. Akyildiz, W. H. Gerstacker, “Coverage and achievable rate analysis for indoor terahertz wireless networks,”
in Proc. of IEEE International Conference on Communications (ICC),
May 2017. DOI: 10.1109/ICC.2017.7996402
[14] B. A. Bilgin, H. Ramezani, O. B. Akan, “Human Blockage Model for
Indoor Terahertz Band Communication,” in Proc. of IEEE International
Conference on Communications Workshops (ICC Workshops), 2019.
[15] IEEE 802.15 WPAN™-Terahertz Interest Group (IGthz). Avialble:http:
//www.ieee802.org/15/pub/TG3d/index IGthz.html
[16] V. Petrov, D. Moltchanov, Y. Koucheryavy, “Applicability assessment of
terahertz information showers for next-generation wireless networks,” in
IEEE International Conference on Communications (ICC), May 2016.
[17] T. Schneider, et.al., “ Link Budget Analysis for Terahertz Fixed Wireless
Links,” IEEE Transactions on Terahertz Science and Technology, vol.
2, no. 2, pp. 250-256, 2012.
[18] A. A. Boulogeorgos ; E. N. Papasotiriou ; A. Alexiou, “A Distance
and Bandwidth Dependent Adaptive Modulation Scheme for THz Communications,” in Proc. of IEEE 19th International Workshop on Signal
Processing Advances in Wireless Communications (SPAWC), Jun. 2018.

[19] O. Semiari, W. Saad, M. Bennis; B. Maham, “Mobility Management
for Heterogeneous Networks: Leveraging Millimeter Wave for Seamless Handover,” in Proc. of IEEE Global Communications Conference
(GLOBECOM), Dec. 2017.
[20] V. Petrov, D. Moltchanov, Y. Koucheryavy, J. M. Jornet, “The effect
of small-scale mobility on terahertz band communications,” in Proc. of
the 5th ACM International Conference on Nanoscale Computing and
Communication (NANOCOM), no. 40, Sept. 2018.
[21] S. Priebe, M. Jacob, T. Krner, “Affection of THz indoor communication
links by antenna misalignment,” in Proc. of the 6th European Conference
on Antennas and Propagation (EUCAP), Mar. 2012.
[22] M. Hashemi, A. Sabharwal, C. E. Koksal, N. B. Shroff, “Efficient Beam
Alignment in Millimeter Wave Systems Using Contextual Bandits,” in
Proc. of the IEEE International Conference on Computer Communications (INFOCOM), Apr. 2018.
[23] H. Hassanieh, et.al., “Fast millimeter wave beam alignment,” in Proc. of
the ACM Special Interest Group on Data Communication (SIGCOMM),
Aug 2018, pp. 432-445,
[24] T. Imai, S. T. Moore, T. Raphan, B. Cohen, “Interaction of the body,
head, and eyes during walking and turning,” Exp. Brain Res., Springer,
vol. 136, no. 1, pp. 1-18, 2001.
[25] T. Otani, et.al, “Upper-Body Control and Mechanism of Humanoids to
Compensate for Angular Momentum in the Yaw Direction Based on
Human Running,” in Proc. IEEE International Conference on Robotics
and Automation (ICRA), 2017.
[26] Radiocommunication Sector of International Telecommunication Union
(ITU), “Recommendation ITU-R P.676-10: Attenuation by atmospheric
gases- P Series Radiowave propagation,” Tech. Rep. ITU-R P.676-10,
2013.
[27] R. Singh, D. Sicker, “Part 15++: An Enhanced ID-based Approach for
Etiquette and Enforcement Management in Unlicensed Band,” IEEE
Transactions on Cognitive Communications and Networking (TCCN),
2019. DOI: 10.1109/TCCN.2019.2915662
[28] T. M. Mitchell, Machine Learning. New York: McGraw-Hill, 1997.

