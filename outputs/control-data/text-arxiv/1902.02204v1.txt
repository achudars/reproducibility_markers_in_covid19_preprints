A NURBS-based Inverse Analysis for Reconstruction of Nonlinear
Deformations of Thin Shell Structures
N. Vu-Bacb , T.X. Duongc , T. Lahmerb , X. Zhuangd , R.A. Sauerc , H.S. Parke , T. Rabczuka,b,∗
a

Institute of Research and Development, Duy Tan University, Da Nang, Vietnam
Institute of Structural Mechanics, Bauhaus-Universität Weimar, Marienstr. 15, D-99423 Weimar, Germany
c
Aachen Institute for Advanced Study in Computational Engineering Science (AICES), RWTH Aachen University,
Templergraben 55, 52056 Aachen, Germany
d
Institut für Kontinuumsmechanik, Gottfried Wilhelm Leibniz Universität Hannover, Appelstraße 11, 30167
Hannover, Germany
e
Department of Mechanical Engineering, Boston University, Boston, MA 02215, USA

arXiv:1902.02204v1 [cs.CE] 5 Feb 2019

b

f
g
h

Published 1 in Computer Methods in Applied Mechanics and Engineering, DOI:10.1016/j.cma.2017.09.034
i
Submitted on 20 May 2017, Revised on 23 September 2017, Accepted on 27 September 2017

Abstract
This article presents original work combining a NURBS-based inverse analysis with both kinematic and constitutive nonlinearities to recover the applied loads and deformations of thin shell
structures. The inverse formulation is tackled by gradient-based optimization algorithms based on
computed and measured displacements at a number of discrete locations. The proposed method
allows accurately recovering the target shape of shell structures such that instabilities due to snapping and buckling are captured. The results obtained show good performance and applicability of
the proposed algorithms to computer-aided manufacturing of shell structures.
Keywords: Inverse analysis, Isogeometric analysis, Kirchhoff-Love shells, Nonlinear mechanics,
Instability shape change, Adjoint method.

1. Introduction
There exist many examples in the natural world of shape changes of slender structures driven
by external sources. For example, biological structures can change shape due to stimuli such
as nonuniform heating, local swelling and growth of thin sheets. These geometric modifications
formed by such morphological changes can have the benefit of enhancing biological functions[1,
2]. For instance, osmotic swelling leads to snap closing of the leaves of the Venus flytrap, with
the resultant configuration being crucial for its nutrition [3]. Since thin structures tend to bend to
1

This pdf is the personal version of an article whose final publication
https://www.sciencedirect.com/science/article/pii/S0045782517306849
∗
Corresponding Author. Tel.: +49 (0)3643 58 4511. Email: timon.rabczuk@uni-weimar.de

is

available

at

Preprint submitted to Elsevier

February 7, 2019

reduce their stretching energy when subjected to dramatic growth-induced deformations as occurs
in growing leaves [4], wrinkling skin [5] and the writhing of tendril-bearing climbers [6], they
often morph into nontrivial three dimensional (3D) shapes [7]. Furthermore, large deformations
occurring in a growing body result in an interesting shape-altering mechanism, i.e. if specific areas
within a thin material are deformed, the entire structure will morph into a new shape. Hence, understanding and controlling the shape changes that result in thin objects subject to external stimuli
such as external loads, swelling or temperature-induced thermal strain is crucial for biomimetic
engineering. Various studies have been performed to understand the shape change mechanism
from swelling or growing of thin, soft bodies [8, 9].
In order to obtain a target shape, the growth-like morphing of a 2D flat sheet into curved, 3D
shapes under external stimuli needs to be understood. In particular, the stimuli that is required to
produce a target shape needs to be determined and then the resultant configuration of the sheet
subject to these stimuli can be reconstructed. Inverse analysis is a widely used approach to determining the external stimuli and the reconstruction of the displacement vector at every material
point of the structure [10, 11, 12, 13]. For instance, an inverse method is presented in [14] to
determine the active strain needed to deform a bio-hybrid system to a desired curvature that is
obtained by appropriate experiments. Inverse techniques are also widely used in aerospace applications. For instance, control-surface morphing usually used in commercial aircraft, employs
piezo-electric actuators integrated with shape memory alloys [15]. The method enable identifying
a detailed state of structural deformations from a set of experimentally measured displacements.
Consequently, other fundamental response quantities such as stress, material and structural failure
can be estimated.
Various inverse problems and their applications have been discussed in literature, see [16, 17,
18, 19]. However, very few studies address the reconstruction of three-dimensional deformations
of bending structures [20, 21, 22]. Even fewer studies on inverse analysis deal with high-fidelity
plate or shell structures as indicated by Tessler et al. [23]. As studied by Jones et al. [24], an
inverse approach employing least-squares approach was used to reconstruct deformations of a
cantilever plate from a set of strain measurements. Later, Shkarayev [25] developed an inverse
approach employing finite element-based parametrization that uses measured surface strains to
determine the applied loads, stresses, which then leads to reconstructing structural deformations
in an aerospace vehicle. It should be noted that the existing inverse methods are limited to solving
small strain elasticity problems, and have not been utilized to account for nonlinear kinematics
and large deformations.
For the reconstruction of structural deformations, numerical methods require the solution of
inverse problems. Finite element (FE) analysis is commonly used to discretize the spatial domain
in combination with the methods of mathematical optimization. Inverse problems may be illposed, particularly when considering uniqueness of the solution. In order to obtain a solution,
iterative methods of nonlinear optimization are applied. The optimization problem can be solved
by using gradient-free or gradient-based methods [26, 27, 28]. In gradient-free methods, only
the relationship between an objective and any associated constraint functions and the structural
problem are required whereas the gradient-based optimizers request derivatives of the objective
and constraint functions. Those can be computed via analytical or semi-analytical sensitivities.
Since gradient-free optimization strategies, like genetic algorithms [29] or multilevel coordinate
2

search [30] are often computationally expensive in finding the optimal solution, particularly when
the number of parameters to be identified increases [31], gradient-based optimization algorithms
are employed in this study.
Kirchhoff-Love shell theory is suitable for thin shells. However, since C 1 -continuity within
the computational domain are required, it is rarely used in FE analysis. Meshfree [32, 33, 34]
and NURBS-based formulations [35, 36, 37, 38, 39] on the other hand fulfill the C 1 -continuity
requirement of Kirchhoff-Love shell theory and allow to avoid rotational degrees of freedom. Due
to the lower computational cost and the better opportunity to model complex geometries, we will
pursue the NURBS-based approach. NURBS have also been recently used in shape optimization
[40, 41] and topology optimization [42, 43]. In this article, we will present a NURBS-based
inverse analysis using analytical and semi-analytical sensitivities for shell structures.
To the best of our knowledge, this is the first time an inverse approach is presented for thin shell
structures that accounts for both geometric and material nonlinearities. The problem of interest
is the determination of the external applied loads and the reconstruction of structural deformations from given data where shape changes due to instabilities like snap-through, snap-back and
buckling are allowed.
The article is divided into three major sections. The next section presents a brief description of the theory of thin shells. The governing equation, weak form, and constitutive equations
are discussed. The FE formulation is also addressed in this section. The third section describes
the inverse analysis based on the gradient-based optimization using analytical and semi-analytical
sensitivity approaches. The proposed method is verified and illustrated by various numerical examples in section 4. In particular, elastic instabilities like snap-through, snap-back and buckling
will be taken into account.
2. A brief description of rotational-free thin shell theory
2.1. Thin shell kinematics
Consider a general surface S of the shell in Figure 1 on which a point x can be described by
the parametric mapping
x = x(ξα ),

α = 1, 2,

(1)

where ξα denotes coordinates in the parameter domain P. The deformation of S is described
by introducing the reference configuration S0 . It is characterized by the parametric description
∂x
∂X
X = X(ξα ). From these mappings, the covariant tangent vectors Aα = ∂ξ
α and aα = ∂ξ α can
be determined, respectively. The respective surface normal vectors of the reference and current
2
.
configurations are then defined by N = kAA11 ×× AA22 k and n = kaa11 ×a
×a2 k
Given the covariant tangent vectors, the components of the covariant metric tensor of the midsurface
Aαβ = Aα · Aβ ,
aαβ = aα · aβ ,
3

α, β = 1, 2

(2)

F=
ξ

G2

N
~

X X

∂x
∂X

A2
G1

n

A1

T

g1 a
2
g2
x~

S

x

a1

S0

t
ξ2
X = X(ξα)

x = x(ξα)

ξ1
P

Figure 1: Mapping between parameter domain P, reference surface S0 and current surface S. X̃ and x̃ are the respective reference and current position of a material point of the 3D continuum. Gα , G3 are covariant tangent and normal
vectors of a shell layer in reference configuration and gα , g3 are the corresponding ones in current configuration. The
figure is adopted from [44]

and the components of the contravariant metric tensors [Aαβ ] = [Aαβ ]−1 and [aαβ ] = [aαβ ]−1 can be
evaluated. From the contravariant metric tensors, the contravariant tangent vectors are defined as
Aα = Aαβ Aβ and aα = aαβ aβ . The covariant components of the curvature tensor are defined as
Bαβ = N · Aα,β ,
bαβ = n · aα,β .

(3)

The mean, Gaussian and principal curvatures of surface S are then given by
1
H = aαβ bαβ ,
2

κ=

det[bαβ ]
,
det[aαβ ]

κ1/2 = H ±

√

H2 − κ

(4)

The surface deformation gradient tensor F describing the mapping from S0 to S is defined as
F = aα ⊗ Aα . Given F, the right and left Cauchy-Green surface tensors are introduced by:
C = FT F = aαβ Aα ⊗ Aβ ,

B = FFT = Aαβ aα ⊗ aβ

(5)

The surface Green-Lagrange strain tensor and the curvature tensor can then be expressed as
follows [45]

1
aαβ − Aαβ Aα ⊗ Aβ ,
2

α
β
K = Kαβ A ⊗ A = bαβ − Bαβ Aα ⊗ Aβ .
E = Eαβ Aα ⊗ Aβ =

4

(6)

2.2. Balance laws
Given a surface S subjected to a prescribed body force f , the quasi-static equilibrium of the
thin shell is described by
α
T;α
+ f = 0.

(7)

Here, T;βα denotes the covariant derivative of T α defined by T;βα = T,βα + Γαβγ T γ , where Γαβγ are the
Christoffel symbols defined by Γγαβ = aγ · aα,β . T α denotes the traction defined on the surface
normal to aα , given by
T α = N αβ aβ + S α n.

(8)

Here the respective in plane and shear stress components of the distributed sectional force are
defined by
N αβ = σαβ + bαγ M γβ ,
S α = −M;ββα ,

(9)

where σαβ and M αβ are the respective membrane stress and bending moment components [46].
The boundary conditions at the boundary ∂S are expressed as
u = ū, on ∂u S
n = n̄, on ∂n S
t = t̄, on ∂t S
mτ = m̄τ , on ∂m S

(10)

with ū, n̄, t̄ = t¯α aα , and m̄τ being the respective prescribed displacement, rotation, boundary
traction and bending moment. mτ and mν are the bending moment components parallel and perpendicular to boundary ∂S, respectively.
2.3. Weak form
It can be shown that the weak form of Equation (7) is given by the statement [47]: Find x ∈ V
∀δx ∈ V0 such that
δΠ = δΠint − δΠext = 0 ∀δx ∈ V,

(11)

with the internal and external virtual work given by
δΠint
δΠext

Z
1
αβ
δaαβ σ da +
δbαβ M αβ da,
=
2
S
ZS
Z
Z
=
δx · f da +
δx · t ds +
δn · mτ ν ds + [δx · mν n],
Z

S

∂t S

∂m S

5

(12)
(13)

where the last term in Equation (13) refers to the virtual work of the point loads mν n applied at
corners on the boundary ∂m S (in case mν 6= 0). It can be shown that after linearization the external
and the internal virtual work are characterized by the increments
Z


∆δΠext =
mτ δaα · νβ n ⊗ aα + να aβ ⊗ n ∆aβ ds
(14)
∂S

∆δΠint =

Z
S0

1
1
1
1
1
cαβγδ δaαβ ∆aγδ + dαβγδ δaαβ ∆bγδ + ταβ ∆δaαβ + eαβγδ δbαβ ∆aγδ
2
2
2
2
2
(15)
!
αβ
+ f αβγδ δbαβ ∆bγδ + M0 ∆δbαβ dA

in which cαβγδ , dαβγδ , eαβγδ , and f αβγδ are defined by
cαβγδ := 2
e

αβγδ

∂ταβ
,
∂aγδ

dαβγδ :=

∂M0αβ
:= 2
,
∂aγδ

f

αβγδ

∂ταβ
,
∂bγδ

∂M0αβ
:=
,
∂bγδ

(16)

and where ταβ = Jσαβ , M0αβ = JM αβ , and da = J dA. The Newton-Raphson and the arc length
methods [48] are employed to solve the linearized system of equations.
2.4. Constitutive equations
A Neo-Hookean material model is used to describe nonlinear stress-strain relationship of the
materials under large deformations. This model is non-dissipative. For hyperelastic material models, constitutive equations for stretching and bending are derived from a strain energy function W,
i.e.
ταβ = 2

∂W
,
∂aαβ

M0αβ =

∂W
.
∂bαβ

(17)

2.5. Koiter shell material model
According to the Koiter material model [49, 50], the surface strain energy for initially curved
shells is defined as
W(E, K) =
in which C = ΛI I + 2µ (I ⊗ I) and F =
Equation (17) are

1
1
E : C : E + K : F : K,
2
2
T2
C.
12

(18)

Consequently, the Kirchhoff stress and moment in

ταβ = Λtr(E)Aαβ + 2µE αβ ,

T2 
M0αβ =
Λtr(K)Aαβ + 2µK αβ ,
12
6

(19)

where Λ and µ can be determined in different ways. As presented in [44], we can integrate analytically over the thickness of the 3D Saint Vernant-Kirchhoff material model to obtain
Λ := T

2Λ̃µ̃
,
Λ̃ + 2µ̃

µ := T µ̃,

(20)

with Λ̃ and µ̃ being the classical 3D Lamé constants in linear elasticity.
2.6. Shell constitutive model derived from 3D material model
In this section, a Kirchhoff-Love shell constitutive model is derived from a three-dimensional
continuum mechanics. The 3D model is projected onto the surface S to obtain the 2D surface shell
model as shown in Figure 1. The actual metric at an arbitrary material point P in the shell has to
be mapped onto the midsurface in the respective reference and deformed configuration [51] as
X̃(ξα , ξ) = x(ξα ) + ξN(ξα )
x̃(ξα , ξ) = X(ξα ) + ξd(ξα ),

(21)

where ξ ∈ [−T/2 T/2] is the coordinate along the shell thickness and d := λ3 n with λ3 being
the stretch in the normal direction for the Kirchhoff-Love shell model. The components of the
projected Kirchhoff stress and moment in Equation (17) can be expressed as
τ

αβ

M0αβ

=

Z

=−

T
2

τ̃αβ dξ,

− T2

Z

T
2

(22)
αβ

ξτ̃ dξ,

− T2

where τ̃αβ denote the 3D Kirchhoff stress components. The detailed projection procedure can be
found in [44].
2.7. Compressible Neo-Hookean materials
The 3D compressible Neo-Hookean strain energy per reference configuration is provided as
follows:
 µ̃ 

Λ̃  ˜2
J − 1 − 2ln J˜ +
I˜1 − 3 − 2ln J˜ ,
(23)
4
2
with I˜1 and J˜ being invariants of the 3D Cauchy-Green tensor C̃. The 3D Kirchhoff stress is then
given by [44] as
˜ =
W̃(I˜1 , J)

Λ̃ + 2µ̃ αβ
g .
(24)
Λ̃J ∗ 2 + 2µ̃
where the respective covariant and contravariant metric tensors are defined as gαβ := gα · gβ
and gαβ := gα · gβ , where r
g• and g• denote the covariant and contravariant tangent vectors at P,
g
respectively. Further J ∗ =
with G := det[Gαβ ] and g := det[gαβ ].
G
7
τ̃αβ = µ̃Gαβ − µ̃

By substituting the stress in Equation (24), the stress and moment shown in Equation (22) can
be evaluated. In this article, we will consider two constitutive material models: (1) the Koiter
material model based on Equation (19) and (2) the projected material model based on Equations
(22) and (24).
2.8. FE approximation
Because the Kirchoff-Love shell formulations involve second derivatives, C 1 -continuity of the
surface is required. Hence, NURBS-based shape functions proposed by [52] are used to discretize
the surface S and to solve Equation (11). The NURBS basis functions are defined by
ωA N̂eA (ξ, η)
NA (ξ, η) = Pn
,
e
A=1 ωA N̂A (ξ, η)

(25)

in which {N̂eA }nA=1 is the B-spline basis function written in terms of Bernstein polynomials as
N̂e (ξ, η) = Ceξ B(ξ) ⊗ Ceη B(η),

(26)

with N̂eA being entries of matrix N̂e . The geometry of the respective reference and deformed surfaces are approximated by interpolation of the control point coordinates Xe and xe using the FE
approach as follows:
X = NXe ,

x = Nxe ,

(27)

where N(ξ, η) := [N1 1, N2 1, ..., Nn 1] contains the nodal shape functions of element Ωe shown in
Equation (25). The covariant tangent vectors of the surface are then determined by
Aα =

∂X
≈ N,α Xe ,
∂ξα

aα =

∂x
≈ N,α xe .
∂ξα

(28)

Variation of x and aα are expressed as
δx ≈ NδXe ,

δaα ≈ N,α δxe .

(29)

Consequently, all kinematical quantities presented in section 2.1 and their variation can be determined, see [47, 44] for details.
2.9. Discretized weak form
The weak form in Equation (11) is discretized using the above interpolations. This leads to the
approximation
δΠ ≈

nel
X
e=1

δΠ =
e

nel
X


δΠeint − δΠeext .

(30)

e=1

with nel being the number of elements. The internal and external virtual work contributions of
element e are given by
8

e
e 
δΠeint = δxTe fintτ
+ fintM
,


e
e
e
e
δΠeext = δxTe fext0
+ fextp
+ fextt
+ fextm
,

(31)

in which the internal FE force vectors due to the membrane stress ταβ and the bending moment
M0αβ are defined by [44]
Z
e
fintτ :=
ταβ NT,α aβ dA,
e
Ω
Z 0
(32)
αβ T
e
fintM :=
M0 N;αβ n dA,
Ωe0

and the external force FE vectors due to a constant body force f0 , external pressure perpendicular
to the surface S, boundary traction t and boundary moment mτ are defined by [44]
Z
e
fext0 :=
NT f0 dA
e
Ω
Z 0
e
fextp
:=
NT pn dA
e
Ω
(33)
Z 0
e
T
fextt :=
N t ds
∂t Ωe
Z
e
fextm :=
NT,α να mτ n ds
∂m Ωe

The linearization of

δΠeint

and

δΠeext

is shown in Appendix A.

2.10. Lagrange multiplier method for rotational constraints
This section presents an approach used to enforce G1 -continuity between patches. The rotational constrains is introduced by adding the constraint potential, see [44]
Z
Πn =
p(ḡc + ḡ s ) dS ,
(34)
L0

to the shell formulation, with p being the Lagrange multiplier and
ḡc := 1 − cos(θ − θ0 ),
ḡ s := sin(θ − θ0 ),

(35)
(36)

where cos θ0 := N · N̄ and cos θ := n · n̄. Here N, N̄ are the two surface normals of neighboring
patches in the reference configuration, and n, n̄ are the corresponding normals in the deformed
configuration. Details of the variation, linearization and FE discretization of Πn can be found
in [44]. The particular patch boundary denoted as L0 in Equation (34) refers to the reference
configuration.
9

3. Inverse analysis
This section presents an inverse analysis procedure for the isogeometric rotation-free thin shell
considering hyperelastic material behavior. Nonlinear kinematics and material response are considered. The boundary conditions, i.e. prescribed boundary displacements, tractions and moments,
as well as surface loads like out-of-plane pressure, that are applied to produce a desired shape of
thin shell structures, can be identified. The considered technique is based on gradient-based strategies, where the required derivatives are determined either analytically, by the finite difference
method or by the adjoint approach. Inverse problems are often solved iteratively in form of the
optimization problem [53]
minimize
such that

J(s, u(s)), s ∈ Rn
g j (s, u(s)) ≤ 0, j = {1, ..., ng },
sl ≤ s ≤ su

(37)

in which s are the design variables; u are the state variables describing the structural response,
e.g. the displacements; J is the objective function; g j are inequality constraints imposed on these
variables to restrict quantities describing the shell response; sl and su are the respective side constraints which restrict the design variables. In this study, the Dirichlet boundary conditions - the
parameters s - can be determined based on the measured displacements of the surface. The forward
operator which maps those parameters to measurements is shown by [31] as follows:

F : X → Y,
s 7→ u

(38)
(39)

where X refers to the parameter space, i.e. the range of Neumann or Dirichlet boundary conditions
(external loads, prescribed displacements etc.) and Y refers to the measurement space. Given
the measurements with noise umeas , the inverse problem corresponds to determining s from the
following equation
F(s) = umeas
which is rewritten in terms of a least-squares functional form
Z
1
|umeas − u(s)|2 dΩ
J(s, u(s)) =
2 Ω

(40)

(41)

The inverse analysis will be employed to identify unknown applied loads and reconstruct nonlinear deformations of the shell structure where the shape changes due to instabilities (i.e. snapping
or buckling) are allowed. The above objective function in Equation (41) is expressed in terms of
the FE discretization as
1
J = kumeas − uk2 ,
2
10

(42)

where u is the vector of nodal displacements on the surface; umeas is the vector of the displacements
measured on the target shape. The design variables are chosen as the applied loads. The state
variables are the nodal displacements. The gradient based method of moving asymptotes (MMA)
[54] is employed together with analytically derived sensitivities. Thus, the differentiation of the
objective function J and constraint g with respect to (w.r.t.) design variables s is required. Using
the chain rule of differentiation, the total derivative of the objective in Equation (42) w.r.t. the
design variable si is expressed as
∂J
∂J ∂u
dJ
=
+
dsi ∂si ∂u ∂si

(43)

∂J
The partial derivative w.r.t. the design variable ∂s
is zero according to Equation (42). The
equilibrium equations for nonlinear FE analysis is given by

r(u, s) = fint (u, s) − fext (u, s) = 0,

(44)

where fint and fext denote the internal force and the external applied load, respectively. Differentiating Equation (44) w.r.t. the design variables s gives
!
∂ fext ∂ fext ∂u
dr ∂ fint ∂ fint ∂u
=
+
−
+
= 0.
(45)
dsi
∂si
∂u ∂si
∂si
∂u ∂si
Rewriting this equation gives the nonlinear state derivative w.r.t. the design variables
∂ f
∂ f
∂u
∂ fext −1  ∂ fint ∂ fext 
∂ fext 
int
int
=−
−
−
= −KT−1
−
,
∂si
∂si
∂si
∂s
∂s
i
i
|∂u {z ∂u}
|
{z
}
KT

∂u
∂s

as
(46)

∗
fnln

∗
where KT is the tangent stiffness matrix; fnln
is known as the nonlinear pseudo load vector [53].
∂u
are not computed explicitly.
In optimization algorithms, the derivatives of the displacement ∂s
i
Instead, they are obtained by using the adjoint method that defines an adjoint vector λ [55] which
is the solution of the equation

KT λ = z,

(47)

∂J
where z, with zi = ∂u
, is the vector of derivatives of the objective function w.r.t. the displacement.
i
The solution λ of Equation (47) is a FE solution for displacements and is obtained by solving the
governing equation (7) with Neumann boundary condition defined by

zi = umeas
− ui on Ω,
i

(48)

and the Dirichlet boundary conditions are the same as those of the actual problem shown in Equations (10.1). Then, Equation (43) is written as
!
dJ
∂J
∂ fext
T ∂ fint
=
−λ
−
.
(49)
dsi ∂si
∂si
∂si
11

As observed, the derivatives of fint and fext w.r.t. the design variables si in Equation (49) are
required in the adjoint method. While it is possible to use numerical sensitivities, it is more efficient to use analytical sensitivities. The analytical sensitivities will be presented in the following
section 3.1 whilst the semi-analytical sensitivities will be described in section 3.2.
3.1. Analytical sensitivities
In this section, the analytical sensitivities of the quantities in Equation (49) w.r.t. the respective
prescribed displacement (u), traction (t), point load ( f0 ), moment (mτ ) and lateral pressure (q) are
presented.
3.1.1. Prescribed displacement
Assume a vector of displacements is prescribed at XA along ei , the design variable is defined
∗
as s = uA such that uA = u δ(XA ) ei . The nonlinear pseudo load vector fnln
is given by
∂ fint
= KT,A .
(50)
∂s
where KT,A refers to all columns of the tangent stiffness matrix KT defined in Equation (46) that
correspond to the degrees of freedom (dofs) in the design vector s. Note that here δ is the DiracDelta distribution. Implementation should be done at the global level (i.e. after elemental assembly). By doing so, the sensitivity for Equation (49) is obtained.
∗
fnln
=

3.1.2. Traction
For an unknown edge traction along direction ei the design variable s is
s = t · ei .

(51)

∗
The nonlinear pseudo load vector fnln
is obtained by
e
∂ fext
,
∂s
e
where fext
is given by Equation (33.3). Since now t = sei , we find
Z
∗
fnln = −
NT ei ds.
∗
fnln
=−

(52)

(53)

∂ t Ωe

More general, if s = t, the pseudo load vector is
Z
∗
fnln = −

NT ds.

(54)

NT dS .

(55)

∂ t Ωe

ds
, we find
And if s = t 0 , where t 0 = t dS
∗
fnln

=−

Z
∂t Ωe0

12

3.1.3. Point load
Considering a shell structure under a point load F, at XA along ei , i.e. F = F δ(XA ) ei , the
∗
design variable s is equal to F. The nonlinear pseudo load vector fnln
is obtained by
e
∂ fext
,
(56)
∂s
e
is given by Equation (33.1). The only non-zero entry within Equation (33.1) is fextA =
where fext
NA F ei where A denotes the FE node at XA . Hence, Equation (56) becomes
∗
fnln
=−

∗
fnln
= −NA ei .

(57)

∗
More general, in case s = f0 , fnln
is given by
∗
fnln

=−

Z
NT dA.

(58)

Ωe0

3.1.4. Uniaxial load and bending moment
Let consider a shell structure subjected to uniaxial traction and bending moment as shown in
example 4.3. The two design variables are s1 = t · e1 and s2 = mτ . For the uniaxial traction, the
∂ fe
∗
e
derivative fnln1
= ∂sext1 is given in Equation (53). Taking the derivative of fext
w.r.t. s2 , we obtain
Z
e
e
∂ fext
∂ fext
∗
=−
=−
NT,α να n ds,
fnln2 = −
(59)
∂s2
∂mτ
∂ m Ωe
where mτ denotes the distributed moment per current length. R Assuming that mτ0 = distributed
e
moment per reference length is the design variable, then fext
= ∂ Ωe NT,α να mτ0 n dS and
m 0
Z
∗
fnln2
=−
NT,α να n dS
(60)
∂m Ωe0

3.1.5. Uniaxial load and lateral pressure
Let us consider a shell structure that is subjected to uniaxial traction and lateral pressure as
shown in example 4.4. In this case, the two design variables will be s1 = t · e1 and s2 = q. The
∂ fe
∂ fe
∗
∗
= ∂sext2 is given by
derivatives fnln1
= ∂sext1 is given in Equation (53) and fnln2
Z
e
∂ fext
∗
=−
NT n da.
(61)
fnln2 = −
∂p
e
Ω
3.2. Semi-analytical sensitivities
The semi-analytical sensitivities of the quantities in Equation (49) are approximated by the
finite difference method as follows:
∂ fint
fint (u, s + ∆si ) − fint (u, s)
≈
,
∂si
∆si
∂ fext
fext (u, s + ∆si ) − fext (u, s)
≈
∂si
∆si
13

(62)

where f• (u, s + ∆si ) refers to perturbed quantities in direction of variable si . The small step size
∆si = 0.001 × si is selected to reduce the truncation error to acceptable value [55]. The details of
the selection of the step size can be found in [56, 57].
4. Numerical examples
Since experimental measurements are not available for this study, the proposed approach is
validated using a two-step procedure. First, a FE model on the basis of the isogeometric approach
[58] is developed for a given shell structure under the applied loads. Both nonlinear kinematics
and nonlinear material constitutive laws are accounted for. Surface displacements uiga are then
computed at discrete locations. Random noise representing small disturbances is added to the
displacement vector uiga , giving umeas := uiga (1 + 0.01γ), with γ being a random number in the
interval [−1, 1]. Since this disturbed data could originate from an experiment we call it experimentlike. Secondly, using this experiment-like data, we apply gradient-based optimization methods on
Equation (42). The approximation of the applied loads are inversely solved and the structural
deformations are reconstructed. Solution of the inverse analysis is achieved when insignificant
changes occur in the configuration between iterations. Particularly, the algorithm is completed
I
I−1
|6 10−3 , is satisfied with I being the iteration
where the convergence criterion, ob j. f unc. = | J −J
J0
number and J 0 is the objective value computed at the initial input.
Four numerical examples on cantilevered and hinged cylindrical shells governed by geometrically nonlinear mechanics are presented. Hyperelastic constitutive laws which account for stretching and bending are considered. The first example is a cantilever shell subjected to prescribed end
displacement (also end shear traction), the second is the hinged cylindrical shell subjected to a
prescribed center displacement. In the two last examples, imperfections, which are essential for
instability shape changes are considered. The inverse analysis of nonlinear instabilities of shell
structures under compression using both the Koiter material model and the projected shell material model using the compressible Neo-Hookean formulation are examined. Note that hereafter
we use the Koiter model to refer to the former and the projected model for the latter.
4.1. Cantilever subjected to prescribed end displacement and end shear traction
In this example, the prescribed displacement wtip or the shear traction t applied to the free
end of a cantilever shell is identified using experiment-like data, see Figures 2(a) and 2(b). The
experiment-like data is generated by considering the large deflection of a cantilever shell, with
dimensions L × W × T = 1 × 10 × 0.1 mm, under the prescribed displacement and the end shear
traction as shown in Figure 2. The shell is discretized by 4 × 40 NURBS elements. The projected
model using the compressible Neo-Hookean formulation, according to sections 2.6 and 2.7 is used
with E = 1.2 × 106 N/mm2 and ν = 0. The force-displacement responses obtained from the
forward problem are compared to that reported by Sze et al. [59]. Convergence of the energy
norm error determined by Equation (63) is shown in Figure 3 to assess the FE results. The error
eE is calculated as
s
E num − E re f
(63)
eE =
E re f
14

where E num and E re f are the numerical and the reference strain energies, respectively. It should be
noted that since the analytical solution is not available, the reference strain energy obtained from
a fine mesh of 20 × 200 NURBS-based elements is used. The experiment-like data, i.e. the nodal
displacements, is obtained by using NURBS-based finite elements. The target configuration cormeas
responds to point A on the solid blue curve in Figure 2(c) where wmeas
= 1.5 N/mm.
tip = 4.0 or t

t

wtip

(a)

(b)

4

target shape
Force (N)

3

2

A

vtip

1

0
0

wtip
wref
vref

2

4
6
Displacement (mm)

8

(c)

(d)

Figure 2: Cantilever shell: (a) undeformed shape under the prescribed end displacement wtip , (b) undeformed shape
under the end shear traction t, (c) vertical tip forces versus vertical (wtip ) and horizontal (vtip ) tip displacements. The
force-displacement responses are in good agreement with the ones shown in [59], (d) deformed shape at displacement
wmeas
tip corresponding to point A in (c). This current shape is used as target shape and nodal displacements represent
the experiment-like data.

Inverse analysis based on the target configuration is then carried out corresponding to Neumann (traction t) and Dirichlet (prescribed displacement wtip ) boundary conditions (BCs). The
element derivatives in Equation(49) are obtained by using analytical and semi-analytical sensitivities. Detailed implementation for the analytical sensitivities when the cantilever shell subjected
15

−1

10

−2.627

Energy norm error

Strain energy (N.mm)

−2.626

−2.628
−2.629

−2

10

−2.63
Num. sol.
Ref. sol.
−2.631
0

200

400
600
800
Number of elements

−3

10

1000

(a)

1

10

2

10
Number of elements

3

10

(b)

Figure 3: Cantilever shell subjected to prescribed end displacement wtip : (a) strain energy, (b) convergence of the
energy norm error w.r.t. the number of elements.

to the displacement wtip or the end shear traction t can be found in sections 3.1.1 and 3.1.2, respectively. Accordingly, the convergence of the objective functions and L2 error norms in spaces
Y and X, see Equation (38), w.r.t. iterations is shown in Figures 4 and 5. The inverse solutions
tinverse = 1.4927 N/mm (for Neumann BCs) and winverse
= 4.0077 (for Dirichlet BCs) are obtained
tip
= 4.
respectively. It can be seen that they are in good agreement with tmeas = 1.5 N/mm winverse
tip
In addition, inverse approach using the semi-analytical sensitivity is performed to reconstruct
the target configuration of the cantilever shell. Figure 6 shows the excellent accuracy of the proposed inverse method. The convergence of the objective function and L2 error norm over iterations is illustrated in Figures 6(a+b), respectively. Very good agreement of the convergence of
the objective function w.r.t. the number of iterations is obtained between the analytical and semianalytical sensitivities, see Figure 6(c). The deformed configuration under the inverse solution
winverse
= 3.9696 shows excellent agreement with the target configuration in Figure 2(d). As obtip
served, the maximal error (errw = 4−3.9696
= 0.76%) between two configurations occurs at the
4
nodes along the free end.
In order to estimate the effect of the noise on accuracy of the algorithm, systematic noise
(γ is taken as deterministic numbers) is examined. As shown in Figure 7(a), the accuracy of the
algorithm decreases with an increase in systematic noise γ. The convexity of the objective function
w.r.t. the end displacement wtip can be seen in Figure 7(b).
Generally, inverse problems may be ill-posed, i.e., that one of the following conditions is violated: Existence, uniqueness and stable dependency on the data. As we do not aim to solve
the inverse problem directly (Equation (40)) but make use of a sum of least-squares approach
(Equation (41)) the existence is guaranteed, at least in the least-squares sense. Proving uniqueness analytically is challenging and most probable not possible for the complex nonlinear forward
problem. So consequently, we followed a numerical approach where values of the objective are
plotted over different values for the excitations, see Figure 7(b). As a clear minimal point is in16

2.5

150

kwmeas − winverse k

Obj. func. value

2
100

50

1.5
1
0.5

0
0

5

10
Iterations

15

0
0

20

5

(a)

10
Iterations

15

20

(b)

Figure 4: Cantilever shell subjected to the displacement wtip : (a) the objective function versus the number of iterations,
(b) convergence of L2 error norm in parameter space X versus the number of iterations. The analytical sensitivity
presented in Equation (50) is employed to compute the element derivatives in Equation (49).

0.7

80

0.6
ktmeas − tinverse k

Obj. func. value

60

40

20

0.5
0.4
0.3
0.2
0.1

0
0

5

10
Iterations

15

20

(a)

0
0

5

10
Iterations

15

20

(b)

Figure 5: Cantilever shell subjected to the end shear traction t: (a) the objective function versus the number of
iterations, (b) convergence of L2 error norm in parameter space X over the number of iterations. The analytical
sensitivity presented in Equation (53) is employed to compute the element derivatives in Equation (49).

17

2

kwmeas − winverse k

Obj. func. value

150

100

50

0
0

5

10
Iterations

15

20

(a)

1.5

1

0.5

0
0

5

10
Iterations

15

20

(b)

150

Obj. func. value

Semi−analyt. sensitivity
Analyt. sensitivity
100

50

0
0

5

10
Iterations

15

20

(c)

(d)

(e)

(f)

Figure 6: Cantilever shell subjected to the displacement wtip : (a) the objective function versus the number of iterations, (b) convergence of L2 error norm in parameter space X over the number of iterations, (c) convergence of the
objective function over the number of iterations using the analytical and semi-analytical sensitivities, (d) the reconstructed deformation at the second iteration, (e) the reconstructed deformation after 3 iterations, (f) the reconstructed
deformation after 20 iterations. The semi-analytical sensitivity is employed to compute the element derivatives in
Equation (49).

18

0.2
150

Obj. func. value

kw − winverse k

0.15

0.1

100

50

0.05

0
1

2

3
Systematic error

4

5

0
2

2.5

3

3.5
wtip (mm)

4

4.5

5

Figure 7: Cantilever shell subjected to the displacement wtip : (a) the effect of noise (with changing γ) on accuracy of
the algorithm, (b) the convexity of the objective function w.r.t. the end displacement wtip .

dicated, we can assume uniqueness at least for the simplified problems. For problems with more
degrees of freedom a generalization is unfortunately impossible.
To solve now the inverse problem, iterative methods are applied. Regarding error norms in X
and Y space we see good convergence and no strong tendency for divergence, even for higher error
amounts in the data (here the prescribed shape), see Figures 4, 5 and 7(a).
4.2. Hinged cylinderical shell subjected to prescribed center displacement and central point force
The second benchmark example consists of a cylindrical shell of dimensions R = 2540 mm,
L = B = 504 mm and thickness T = 12.7 mm. The longitudinal edges of the shell are pinned,
its curved edges are free and the shell is subjected to a prescribed center displacement wcen . Due
to the symmetry, a quarter of the shell is modeled using 8 × 10 quadratic NURBS elements as
shown in Figure 8(a). The symmetry boundary conditions are enforced by the Lagrange multiplier
method presented in section 2.10.
The forward problem is first solved based on the isogeometric analysis approach. The material is described by the Koiter model and the projected model with compressible Neo-Hookean
formulation using the Young’s modulus E = 3105 N/mm2 and the Poisson’s ratio ν = 0.3. The
force-displacement response is compared in Figure 8(c) to the one reported by Sze et al. [59],
which considered the Saint Venant-Kirchhoff formulation with the same material properties. Good
agreement between the response obtained by using the Koiter model with the reference result
demonstrates the accuracy of the model. The deformed configuration corresponding to point A on
the solid blue curve in Figure 8(c) is then taken as the target shape.
Next, the determination of the prescribed center displacement wcen using the target shape shown
in Figure 8(b) is performed in the framework of compressible Neo-Hookean hyperelasticity to
take nonlinear bending and stretching behaviors into account. Analytical and semi-analytical sensitivities are utilized to compute the derivatives in Equation(49). Computation of the analytical
sensitivities for prescribed displacement is provided in section 3.1.1. As shown in Figure 9, the
19

hinged
free

wcen

symm.

symm.

free

hinged

(a)
2500

wcen−Comp.
wcen−Koit.

2000

wref

Force (N)

target shape

1500

A

1000
500
0
0

(b)

5

10
15
Displacement (mm)

20

25

(c)

Figure 8: Hinged cylindrical shell subject to prescribed center displacement wcen : (a) undeformed shape, (b) deformed
shape at displacement wmeas
cen = −24.98 using the projected shell model. This shape corresponds to point A in (c), (c)
reaction forces versus vertical displacement (w) in z direction for the Koiter shell model (red dashed line) and the
projected shell model (blue solid line) using the compressible Neo-Hookean material. The force-displacement curve
obtained from the Koiter material model is in good agreement with the one, using isotropic Saint Venant-Kirchhoff
model, shown in [59].

20

objective function and the L2 norm converge after 20 iterations. The semi-analytical sensitivities
are also used to provide the derivatives in Equation (62) based on how the inverse problem is carried out. The accuracy of the inverse method is highlighted in Figures 10(a+b) where convergence
is gained after 20 iterations. The solution of the inverse problem over iterations is shown in Figures 10(c+d+e+f). The reconstructed deformation after 20 iterations shows good agreement with
inverse
the target shape: wmeas
= −24.90 at
cen = −24.98 compares well to the maximal displacement wcen
the central point. It should be noted that the reconstruction of the target shape is performed in the
presence of a snap-through instability.
2500

20

4

1.29 x 10

kwmeas − winverse k

Obj. func. value

2000
1500
1000
500
0
0

5

10
Iterations

15

20

(a)

15

10

5

0
0

5

10
Iterations

15

20

(b)

Figure 9: Hinged cylindrical shell subjected to the displacement wcen : (a) the objective function versus the number of
iterations, (b) convergence of L2 error norm in parameter space X over the number of iterations.

In order to take the uniqueness of the solution into consideration, the hinged shell problem with
smaller thickness (T = 6.35 mm) and snap-back behavior is also simulated. For this model, the
prescribed center displacement wcen in Figure 8 is replaced by a central point load F = 700 N. The
forward problem is implemented using the arc length method. The force-displacement responses
for the Koiter model and the projected model with compressible Neo-Hookean material are shown
in Figure 11. The target configuration corresponding to point A on the blue force-displacement
curve is obtained and used for the identification of the applied external load.
Inverse analysis using the analytical sensitivity presented in Equation (57) is then performed
based on the experiment-like data obtained from the forward problem. The projected model using the compressible Neo-Hookean material is employed. The solution to the inverse problem is
obtained after 20 iterations as depicted in Figure 12. The reconstructed configuration shown in
Figure 12(d) under the inverse solution F inverse = 678.3 N shows good agreement with the target configuration. It should be noted that this configuration is reconstructed under a snap-back
instability.

21

20

12000

kwmeas − winverse k

Obj. func. value

10000
8000
6000
4000

15

10

5

2000
0
0

5

10
Iterations

15

20

(a)

0
0

5

10
Iterations

15

20

(b)

(c)

(d)

(e)

(f)

Figure 10: Hinged cylindrical shell subjected to the displacement wcen : (a) the objective function versus the number of
iterations, (b) convergence of L2 error norm in parameter space X over the number of iterations, (c) the reconstructed
deformation after 3 iterations, (d) the reconstructed deformation after 4 iterations, (e) the reconstructed deformation
after 5 iterations, (f) the reconstructed deformation after 20 iterations.

22

800
A

600

target shape

Force (N)

400
200
0
−200
−400
0

(a)

wcen−Comp.
wcen−Koit.
wref
5

10
15
20
Displacement (mm)

25

30

(b)

Figure 11: Hinged cylindrical shell subject to central point load F: (a) deformed shape at external load F using the
projected shell model. This shape corresponds to point A in (b), (b) reaction forces versus vertical displacement
in z direction for the Koiter shell model (red dashed line) and the projected shell model (blue solid line) using the
compressible Neo-Hookean material. The force-displacement curves are in good agreement with the counterpart
(black ◦) shown in [59].

4.3. A flat strip subjected to compressive displacement and bending moment
In reality, a perfect structure with perfect loading does not exist. Inevitable imperfections
may be related to factors such as initial curvature, load eccentricity or small disturbing loads.
Small imperfections do not matter in linear analysis, however in nonlinear problems, they are
quite important. Hence, instabilities of shell structures that are sensitive to geometrical and loading
imperfections must be considered. The shape changes occurring due to nonlinear buckling will be
examined in the following examples.
We consider a pinned-end flat strip that it is perfectly straight before the displacement is prescribed. The strip is prescribed by compressive displacement and end distributed moment as
described in Figure 13. The moment m is applied first and we then apply the compressive displacement vright . A FE solution for of 8 × 24 quadratic NURBS elements is first determined for
the above structure with both the Koiter and projected shell models using the compressible NeoHookean formulation. The 3D Young’s modulus E = 3 × 106 N/mm2 and Poisson’s ratio ν = 0.3
are adopted. The FE force vector associated with the distributed moment is given by Equation (33)
and the corresponding tangent matrix is given by Equation (A.6.1). The effect of the distributed
moment on the force-displacement response for both models is indicated in Figures 13(b+c), remeas
3
spectively. The unstably buckled shape under vmeas
Koit,right = −0.5 and mKoit = 12 × 10 N.mm/mm is
illustrated in Figure 14 for the Koiter model. Furthermore, Figure 16 shows the unstably buckled
meas
3
shape under vmeas
pro j,right = −0.4 and m pro j = 10 × 10 N.mm/mm for the projected model. The nodal
displacements umeas corresponding to point A on the curves in Figures 14(b) and 16(b) are then
computed which are used as the experiment-like data.
In the second step, an inverse approach based on the nodal displacement of target configuration
23

200

120
4

1.82 x 10

100
kF meas − F inverse k

Obj. func. value

150

100

50

80
60
40
20

0
0

5

10
Iterations

15

20

(a)

0
0

5

10
Iterations

15

20

(b)

(c)

(d)

Figure 12: Hinged cylindrical shell subjected to the central point load F: (a) the objective function versus the number
of iterations, (b) convergence of L2 error norm in parameter space X over the number of iterations, (c) the reconstructed
deformation after 1 iterations, (d) the reconstructed deformation after 20 iterations.

24

(with additional noise) is employed to identify the applied displacement vright and moment m for the
two shell models: (1) the Koiter model and (2) the projected model with the compressible NeoHookean formulation. For the shell structure modeled by the Koiter model as shown in Figure
15(a), convergence is gained after 40 iterations and the optimal shape in Figure 15(e) recovered
inverse
= 9.06 ×
after 40 iterations, corresponding to the inverse solution vinverse
Koit,right = −0.5055 and mKoit
3
10 N.mm/mm, which is in excellent agreement with the target shape in Figure 14(a).
Similar observation can be made for the results obtained from the projected model. The convergence of the objective function over iterations and the reconstructed configurations with iterations
are depicted after 40 iterations Figures 17. The recovered shape in Figure 17(e), corresponding
inverse
= 11.13 × 103 N.mm/mm, is almost idento the inverse solution vinverse
pro j,right = −0.3989 and m pro j
tical with the measured shape in Figure 16(a). In summary, the proposed inverse method is able
to accurately determine the prescribed displacement vright and moment m and the specified final
shape can be reconstructed where the unstable deformation due to buckling are captured. Note that
nodal displacements in the z direction for both models are restricted to be larger than 0 to ensure
the convex shape of the measured shells in Figures 14(a) and 16(a), respectively.
4.4. A flat strip subjected to compressive displacement and disturbing pressure
The pinned-end flat strip, with dimensions L × W × T = 5 × 1 × 0.2 mm is considered again.
We assume its initial shape is perfectly straight but subjected to axially prescribed displacement
vright and lateral pressure q as depicted in Figure 18. First, NURBS-based finite elements are used
to solve the forward problem. This example was analyzed using 8 × 40 NURBS elements with
the material constants: E = 3 × 106 N/mm2 and ν = 0.3. The FE force vector due to lateral
e
pressure is given by Equation (33.2) and the corresponding stiffness matrix kextp
is determined
by (A.6.2). The Koiter model and the projected model using the compressible Neo-Hookean
formulation are considered. Figures 18(b+c) respectively show the influence of the disturbing
pressure on the force-displacement response for both models. The measured shapes and forcemeas
2
displacement response, corresponding to vmeas
Koit,right = −0.2, qKoit = 30 N/mm , are shown in Figure
meas
19 for the Koiter model and in Figure 21 for the projected model with v pro j,right = −0.2, qmeas
pro j =
2
30 N/mm , respectively.
Based on the nodal displacements umeas corresponding to point A on the curves obtained from
the forward problem, we conduct an inverse analysis for the strip modeled by (1) the Koiter model
and (2) the projected model with the compressible Neo-Hookean formulation. The convex shape
of the reconstructed deformations is ensured by restricting nodal displacements in the z direction
to be larger than 0. For the former model, convergence is reached after 40 iterations, see Figure
inverse
20(a) and the resultant shape under the identified vinverse
= 35.18 N/mm2 is
Koit,right = −0.1992, qKoit
accurately reconstructed after 40 iterations in Figure 20(e) compared to the one in Figure 19(a).
Similarly, the objective function versus iterations and the reconstructed configurations are illustrated in Figure 22 for the latter. By comparing Figure 22(e) to Figure 21(a), it can be seen that
the specified target shape under the identified vinverse
= −0.1999, qinverse
= 35.74 N/mm2 can
pro j
pro j
be recovered nearly exactly. Overall, the inverse formulation correctly recovers the prescribed
displacement vright , the lateral pressure q and the measured deformation due to buckling.

25

m

vright

(a)
2.5

x10

5

4

1.5
1

0.1

0.2
0.3
Displacement (mm)

0.4

2

1

D04−M10000
D04−M12000
D04−M14000

0.5
0
0

5

3
Force (N)

Force (N)

2

x10

0.5

(b)

0
0

D05−M10000
D05−M12000
D05−M14000
0.1

0.2
0.3
Displacement (mm)

0.4

(c)

Figure 13: Flat strip subjected to compressive displacement vright and bending moment m: (a) undeformed shape, (b)
axial force-displacement responses for different moments m modeled by the Koiter model, (c) axial force-displacement
responses for different moments m modeled by the projected shell model.

26

target shape

2.5

x10

5

A

Force (N)

2
1.5
1
0.5
0
0

(a)

D05−M12000
0.1

0.2
0.3
Displacement (mm)

0.4

0.5

(b)

Figure 14: Flat strip under the compressive displacement vright and the bending moment m is modeled by the Koiter
model: (a) deformed shape at displacement vmeas
Koit,right = −0.5, (b) reaction force versus displacement in y direction.

5. Conclusions
In this article, we have developed a new method to combine inverse analysis with material
and geometric nonlinearities to identify the unknown applied loads from given displacements and
reconstruct the deformations of thin shell structures. NURBS-based finite elements, which offer
geometrically exact discretization, are used to ensure C 1 -continuity of the 3D surface. Both a Koiter material model and a projected shell material model with compressible Neo-Hookean formulation are considered. Gradient-based optimization algorithms with analytical and semi-analytical
sensitivities were utilized to tackle the inverse problems for given experiment-like displacements
at specified locations. Various numerical simulations are performed to capture either the stable or
unstable (i.e. snap-through, snap-back and buckling) shape changes. The solution of the inverse
analysis demonstrates that the proposed method is able to recover target shapes with high accuracy. We believe this research will open a new path for computer-aided manufacturing of shell
structures.
6. Acknowledgments
We gratefully acknowledge the support by ERC COMBAT project (project number 615132).
We would like to thank Prof. Krister Svanberg from Royal Institute of Technology for providing
the MMA code.
Appendix A. FE tangent matrices
According to [44], the linearization of δΠeint and δΠeext is expressed as
27

14

Obj. func. value

12
10
8
6
4
2
0
0

10

20
Iterations

30

40

(a)

(b)

(c)

(d)

(e)
Figure 15: Flat strip under the compressive displacement vright and the bending moment m is modeled by the Koiter
model: (a) objective function versus the number of iterations, (b) the reconstructed deformation at the second iteration, (c) the reconstructed deformation after 5 iterations, (d) the reconstructed deformation after 6 iterations, (e) the
reconstructed deformation after 40 iterations.

28

4

target shape

x10

5

A

Force (N)

3

2

1
D04−M10000

0
0

0.1

0.2
0.3
Displacement (mm)

(a)

0.4

(b)

Figure 16: Flat strip under the compressive displacement vright and the bending moment m is modeled by the projected
model: (a) deformed shape at displacement vmeas
pro j,right = −0.4, (b) reaction force versus displacement in y direction


∆δΠeint = δxTe keττ + keτM + keMτ + keMM + keτ + keM ∆xe ,


∆δΠeext = δxTe keextp + keextm ∆xe ,
where the material stiffness matrices are defined by
Z


e
kττ :=
cαβγδ NT,α aβ ⊗ aγ N,δ dA,
ZΩ0


keτM :=
dαβγδ NT,α aβ ⊗ n Ñ;γδ dA,
ZΩ0


keMτ :=
eαβγδ ÑT;αβ n ⊗ aγ N,δ dA,
ZΩ0
keMM :=
f αβγδ ÑT;αβ (n ⊗ n) Ñ;γδ dA

(A.1)

(A.2)

Ω0

where N,α (ξ) := [N1,α 1, N2,α 1, ..., Nn,α 1] and
Ñ;αβ := N,αβ − Γγαβ N,γ ,

(A.3)

with N,αβ (ξ) := [N1,αβ 1, N2,αβ 1, ..., Nn,αβ 1]. The geometric stiffness matrices are shown as
keM = keM1 + keM2 + keM2
in which
29

T

,

(A.4)

6

Obj. func. value

5
4
3
2
1
0
0

10

20
Iterations

30

40

(a)

(b)

(c)

(d)

(e)
Figure 17: Flat strip under the compressive displacement vright and the bending moment m is modeled by the projected model: (a) objective function versus the number of iterations, (b) the reconstructed deformation at the second
iteration, (c) the reconstructed deformation after 4 iterations, (d) the reconstructed deformation after 6 iterations, (e)
the reconstructed deformation after 40 iterations.

30

vright
q

800

800

600

600
Force (N)

Force (N)

(a)

400

200

0
0

200

D02−P30
D02−P35
D02−P40
0.05

0.1
0.15
Displacement (mm)

400

0.2

(b)

0
0

D02−P30
D02−P35
D02−P40
0.05

0.1
0.15
Displacement (mm)

0.2

(c)

Figure 18: Flat strip subjected to compressive displacement vright and lateral disturbing pressure q: (a) undeformed
shape, (b) axial force-displacement responses for different pressures q modeled by the Koiter model, (c) axial forcedisplacement response for different pressures q modeled by the projected model.

31

800
A

target shape

Force (N)

600

400

200
D02−P30

0
0

0.05

0.1
0.15
Displacement (mm)

(a)

0.2

(b)

Figure 19: Pin-ended flat strip under the compressive displacement vright and the lateral disturbing pressure q modeled
by the Koiter model: (a) deformed shape at displacement vright = −0.2, (b) reaction force versus displacement in y
direction.

Z
keM1
keM2

:= −
Z
:=
Ω0

Ω0

bαβ M0αβ aγδ NT,γ (n ⊗ n) N,δ dA,

M0αβ NT,γ

(A.5)
γ

(n ⊗ a ) Ñ;αβ dA.

The external moment and surface pressure components of the tangent matrix are given by [44, 60]
kextm =

Z

Z


β
α
α β
ν n ⊗ a + ν a ⊗ n N,β ds −

Z∂m Ω
=
qNT (n ⊗ aα − aα ⊗ n) N,α da,
e

kextq

mτ NT,α

∂m Ωe

Ωe

where ξ refers the convective coordinate of the curve ∂m Ωe .

32



mτ να NT,α n ⊗ aξ N,ξ ds,
(A.6)

3

Obj. func. value

2.5
2
1.5
1
0.5
0
0

10

20
Iterations

30

40

(a)

(b)

(c)

(d)

(e)
Figure 20: Flat strip under the compressive displacement vright and the lateral disturbing pressure q modeled by the
Koiter model: (a) objective function versus the number of iterations, (b) the reconstructed deformation at the second
iteration, (c) the reconstructed deformation after 5 iterations, (d) the reconstructed deformation after 6 iterations, (e)
the reconstructed deformation after 40 iterations.

33

800

target shape

A

Force (N)

600

400

200

0
0

(a)

D02−P30
0.05

0.1
0.15
Displacement (mm)

0.2

(b)

Figure 21: Flat strip under the compressive displacement vright and the lateral disturbing pressure q modeled by
the projected model: (a) deformed shape at displacement vright = −0.2, (b) reaction force versus displacement in y
direction.

34

3

Obj. func. value

2.5
2
1.5
1
0.5
0
0

10

20
Iterations

30

40

(a)

(b)

(c)

(d)

(e)
Figure 22: Flat strip under the compressive displacement vright and the lateral disturbing pressure q modeled by the
projected model: (a) objective function versus the number of iterations, (b) the reconstructed deformation at the second
iteration, (c) the reconstructed deformation after 5 iterations, (d) the reconstructed deformation after 6 iterations, (e)
the reconstructed deformation after 40 iterations.

35

References
[1] Boudaoud, A. An introduction to the mechanics of morphogenesis for plant biologists. Trends in plant science,
15:353-360, 2010.
[2] Mirabet, V., Das, P., Boudaoud, A., and Hamant, O. The role of mechanical forces in plant morphogenesis.
Annu. Rev. Plant Biol., 62:365-385, 2011.
[3] Forterre, Y., Skotheim, J. M., Dumais, J., and Mahadevan, L. How the Venus flytrap snaps. Nature, 433:421-425,
2005.
[4] Marder, M., Sharon, E., Smith, S., and Roman, B. Theory of edges of leaves. Europhys. Lett., 62:498, 2003.
[5] Kücken, M., and Newell, A.C. Fingerprint formation. J. of Theor. Biol., 235:71-83, 2005.
[6] McMillen, T., and Goriely, A. Tendril perversion in intrinsically curved rods. J. Nonlinear Sci., 12:241-281,
2002.
[7] Klein, Y., Efrati, E., and Sharon, E. Shaping of elastic sheets by prescription of non-Euclidean metrics. Science,
315:1116-1120, 2007.
[8] Pezzulla, M., Shillig, S.A., Nardinocchi, P., and Holmes, D.P. Morphing of geometric composites via residual
swelling. Soft Matter, 11:5812-5820, 2015.
[9] Nardinocchi, P., Pezzulla, M., and Teresi, L. Anisotropic swelling of thin gel sheets. Soft Matter, 11:1492-1499,
2015.
[10] Constantinescu, A. On the identification of elastic moduli from displacement-force boundary measurements.
Inverse Problems in Engineering, 1:293-313, 1995.
[11] Marin, L., and Lesnic, D. Boundary element solution for the Cauchy problem in linear elasticity using singular
value decomposition. Comp. Meth. Appl. Mech. Engrg., 191:3257-3270, 2002.
[12] Geymonat, G., and Pagano, S. Identification of mechanical properties by displacement field measurement: a
variational approach. Meccanica, 38:535-545, 2003.
[13] Bonnet, M., and Constantinescu, A. Inverse problems in elasticity Inverse problems, 21:R1-R50, 2005.
[14] Lucantonio, A., Nardinocchi, P., Pezzulla, M., and Teresi, L. Multiphysics of bio-hybrid systems: shape control
and electro-induced motion. Smart Materials and Structures, 23:045043, 2014.
[15] Bogert, P.B., Haugse, E., and Gehrki, R.E. Structural shape identification from experimental strains using a
modal transformation technique. In Proceedings of 44th AIAA/ASME/ASCE/AHS Structures, Structural Dynamics and Materials Conference, Norfolk, Virginia, 2003.
[16] Maniatty, A., Zabaras, N., and Stelson, K. Finite element analysis of some inverse elasticity problems. Journal
of Engineering Mechanics, 115:1303-1317, 1989.
[17] Schnur, D.S., and Zabaras, N. Finite element solution of twodimensional inverse elastic problems using spatial
smoothing. Int. J. Numer. Meth. Engng., 30:57-75, 1990.
[18] Maniatty, A.M., and Zabaras, N.J. Investigation of regularization parameters and error estimating in inverse
elasticity problems. Int. J. Numer. Meth. Engng., 37:1039-1052, 1994.
[19] Liu, P.L., and Lin, H.T. Direct identification of non-uniform beams using static strains. Int. J. Solids Struct.,
33:2775-2787, 1996.
[20] Bletzinger, K.U., Wüchner, R., Daoud, F., and Camprubı́, N. Computational methods for form finding and
optimization of shells and membranes. Comp. Meth. Appl. Mech. Engrg., 194:3438-3452, 2005.
[21] Wüchner, R., and Bletzinger, K.U. Stressadapted numerical form finding of prestressed surfaces by the updated
reference strategy. Int. J. Numer. Meth. Engng., 64:143-166, 2005.
[22] Bletzinger, K.U., Firl, M., Linhard, J., and Wüchner, R. Optimal shapes of mechanically motivated surfaces.
Comp. Meth. Appl. Mech. Engrg., 199:324-333, 2010.
[23] Tessler, A., and Spangler, J.L. A variational principle for reconstruction of elastic deformations in shear deformable plates and shells. NASA/TM-2003-2 12445, 2003.
[24] Jones, R.T., Bellemore, D.G., Berkoff, T.A., Sirkis, J.S., Davis, M.A., Putnam, M.A., Friebele, E.J., and Kersey,
A.D. Determination of cantilever plate shapes using wavelength division multiplexed fiber Bragg grating sensors
and a least-squares strain-fitting algorithm. Smart materials and structures, 7:178, 1998.
[25] Shkarayev, S., Krashanitsa, R., and Tessler, A. An inverse interpolation method utilizing in-flight strain measurements for determining loads and structural response of aerospace vehicles Proceedings of Third International
Workshop on Structural Health Monitoring, Stanford, California, 336-343, 2001.

36

[26] Nanthakumar, S., Valizadeh, N., Park, H., and Rabczuk, T. Surface effects on shape and topology optimization
of nanostructures. Comp. Mech., 56:97-112, 2015.
[27] Nanthakumar, S., Lahmer, T., Zhuang, X., Park, H.S., and Rabczuk, T. Topology optimization of piezoelectric
nanostructures. Journal of the Mechanics and Physics of Solids, 94:316-335, 2016.
[28] Nanthakumar, S. S., Lahmer, T., Zhuang, X., Zi, G., and Rabczuk, T. Detection of material interfaces using a
regularized level set method in piezoelectric structures. Inverse Problems in Science and Engineering, 24:153176, 2016.
[29] Waisman, H., Chatzi, E., and Smyth, A.W. Detection and quantification of flaws in structures by the extended
finite element method and genetic algorithms. Int. J. Numer. Meth. Engng., 82:303-328, 2010.
[30] Nanthakumar, S. S., Lahmer, T., and Rabczuk, T. Detection of flaws in piezoelectric structures using extended
FEM. Int. J. Numer. Meth. Engng., 96:373-389, 2013.
[31] Nanthakumar, S.S., Lahmer, T., and Rabczuk, T. Detection of multiple flaws in piezoelectric structures using
XFEM and level sets. Comp. Meth. Appl. Mech. Engrg., 275:98-112, 2014.
[32] Rabczuk, T., and Areias, P.M.A. A meshfree thin shell for arbitrary evolving cracks based on an external enrichment. Comp. Model. Engrg. Sci., 16:115-130, 2006.
[33] Rabczuk, T., Areias, P.M.A., and Belytschko, T. A meshfree thin shell method for nonlinear dynamic fracture.
Int. J. Numer. Meth. Engng., 72:524-548, 2007.
[34] Rabczuk, T., Gracie, R., Song, J.H., and Belytschko, T. Immersed particle method for fluid-structure interaction.
Int. J. Numer. Meth. Engng., 81:48-71, 2010.
[35] Kiendl, J., Bletzinger, K. U., Linhard, J., and Wüchner, R. Isogeometric shell analysis with KirchhoffLove
elements. Comp. Meth. Appl. Mech. Engrg., 198:3902-3914, 2009.
[36] Benson, D.J., Bazilevs, Y., Hsu, M.C., and Hughes, T.J.R. Isogeometric shell analysis: the ReissnerMindlin
shell. Comp. Meth. Appl. Mech. Engrg., 199:276-289, 2010.
[37] Benson, D.J., Bazilevs, Y., Hsu, M.C., and Hughes, T.J.R. A large deformation, rotation-free, isogeometric shell.
Comp. Meth. Appl. Mech. Engrg., 200:1367-1378, 2011.
[38] Benson, D.J., Hartmann, S., Bazilevs, Y., Hsu, M.C., and Hughes, T.J.R. Blended isogeometric shells. Comp.
Meth. Appl. Mech. Engrg., 255:133-146, 2013.
[39] Nguyen-Thanh, N., Kiendl, J., Nguyen-Xuan, H., Wüchner, R., Bletzinger K.U., Bazilevs Y., and Rabczuk T.
Rotation free isogeometric thin shell analysis using PHT-splines. Comp. Meth. Appl. Mech. Engrg., 200:34103424, 2011.
[40] Wall, W.A., Frenzel, M.A., and Cyron, C. Isogeometric structural shape optimization. Comp. Meth. Appl. Mech.
Engrg., 197:2976-2988, 2008.
[41] Kiendl, J., Schmidt, R., Wüchner, R., and Bletzinger, K.U. Isogeometric shape optimization of shells using
semi-analytical sensitivity analysis and sensitivity weighting. Comp. Meth. Appl. Mech. Engrg., 274:148-167,
2014.
[42] Seo, Y.D., Kim, H.J., and Youn, S.K. Shape optimization and its extension to topological design based on
isogeometric analysis. Int. J. Solids Struct., 47:1618-1640, 2010.
[43] Ghasemi, H., Park, H. S., and Rabczuk, T. A level-set based IGA formulation for topology optimization of
flexoelectric materials. Comp. Meth. Appl. Mech. Engrg., 313:239-258, 2017.
[44] Duong, T.X., Roohbakhshan, F., and Sauer, R.A. A new rotation-free isogeometric thin shell formulation and a
corresponding continuity constraint for patch boundaries. Comp. Meth. Appl. Mech. Engrg., 316:43-83, 2017.
[45] Steigmann, D.J. On the relationship between the Cosserat and Kirchhoff-Love theories of elastic shells. Mathematics and Mechanics of Solids, 4:275-288, 1999.
[46] Sauer, R.A., Duong, T.X., Mandadapu, K.K., and Steigmann, D.J. A stabilized finite element formulation for
liquid shells and its application to lipid bilayers. J. Comp. Phys., 330:436-466, 2017.
[47] Sauer, R.A., and Duong, T.X. On the theoretical foundations of thin solid and liquid shells. Mathematics and
Mechanics of Solids, 22:343-371, 2017.
[48] Crisfield, M. A fast incremental/iterative solution procedure that handles ”snap-through”. Computers & Structures, 13:55-62, 1981.
[49] Ciarlet, P.G. An introduction to differential geometry with applications to elasticity. Journal of Elasticity, 78:1215, 2005.

37

[50] Steigmann, D.J. Koiter’s shell theory from the perspective of three-dimensional nonlinear elasticity. Journal of
Elasticity, 111:91-107, 2013.
[51] Wriggers, P. Nonlinear Finite Element Methods. Springer, Berlin, 2008.
[52] Borden, M.J., Scott, M.A., Evans, J.A., and Hughes, T.J.R. Isogeometric finite element data structures based on
Bezier extraction of NURBS. Int. J. Numer. Meth. Engng., 87:1547, 2011.
[53] Firl, M., and Bletzinger, K.U. Shape optimization of thin walled structures governed by geometrically nonlinear
mechanics. Comp. Meth. Appl. Mech. Engrg., 237:107-117, 2012.
[54] Svanberg, K. The method of moving asymptotes - a new method for structural optimization. Int. J. Numer. Meth.
Engng., 24:359-373, 1987.
[55] Haftka, R.T., and Gürdal, Z. Elements of structural optimization. Springer Science & Business Media, 2012.
[56] Gill, P.E., Murray, W., Saunders, M.A., and Wright, M.H. Computing forward-difference intervals for numerical
optimization. SIAM Journal on Scientific and Statistical Computing, 4:310-321, 1983.
[57] Iott, J., Haftka, R.T., and Adelman, H.M. Selecting step sizes in sensitivity analysis by finite differences. NASA
TM-86382, 1985.
[58] Hughes, T.J.R., Cottrell, J.A., and Bazilevs, Y. Isogeometric analysis: CAD, finite elements, NURBS, exact
geometry and mesh refinement. Comp. Meth. Appl. Mech. Engrg., 194:41354195, 2005.
[59] Sze, K.Y., Liu, X.H., and Lo, S.H. Popular benchmark problems for geometric nonlinear analysis of shells.
Finite Elem. Anal. Design, 40:1551-1569, 2004.
[60] Sauer, R.A., Duong, T.X., and Corbett, C.J. A computational formulation for constrained solid and liquid membranes considering isogeometric finite elements. Comp. Meth. Appl. Mech. Engrg., 271:48-68, 2014.

38

