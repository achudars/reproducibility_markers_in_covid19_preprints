Harnessing Fluctuations in Thermodynamic Computing
via
Time-Reversal Symmetries
One Sentence Summary:
Distinct distributions of thermodynamic work identify signatures of successful and failed information

arXiv:1906.11973v1 [cond-mat.stat-mech] 27 Jun 2019

processing in a microscale flux qubit

Gregory Wimsatt,1, ∗ Olli-Pentti Saira,2, † Alexander B. Boyd,1, ‡ Matthew H.
Matheny,2, § Siyuan Han,3, ¶ Michael L. Roukes,2, ∗∗ and James P. Crutchfield1, 2, ††
1
Complexity Sciences Center and Physics Department,
University of California at Davis, One Shields Avenue, Davis, CA 95616
2
Condensed Matter Physics and Kavli Nanoscience Institute,
California Institute of Technology, Pasadena, CA 91125
3
Department of Physics and Astronomy, University of Kansas, Lawrence, KS 66045
(Dated: July 1, 2019)

We experimentally demonstrate that highly structured distributions of work emerge
during even the simple task of erasing a single bit. These are signatures of a refined suite of time-reversal symmetries in distinct functional classes of microscopic
trajectories. As a consequence, we introduce a broad family of conditional fluctuation theorems that the component work distributions must satisfy. Since they identify
entropy production, the component work distributions encode both the frequency of
various mechanisms of success and failure during computing, as well giving improved
estimates of the total irreversibly-dissipated heat. This new diagnostic tool provides
strong evidence that thermodynamic computing at the nanoscale can be constructively
harnessed. We experimentally verify this functional decomposition and the new class of
fluctuation theorems by measuring transitions between flux states in a superconducting
circuit.
Keywords: Jarzynski integral fluctuation theorem, Crooks detailed fluctuation theorem, Landauer’s Principle,
thermodynamics of computation, information thermodynamics

Physics dictates that all computing is subject to spontaneous error. These days, this truism repeatedly reveals
itself: despite the once-predictable miniaturization of
nanoscale electronics, computing performance increases
have dramatically slowed in the last decade or so. In large
measure, this is due to the concomitant rapid decrease
in the number of information-bearing physical degrees of
freedom, rendering information storage and processing
increasingly susceptible to corruption by thermal fluctuations. All computing is thermodynamic. Controlling
the production of fluctuations and removing heat pose
key technological challenges to further progress. One
comparable setting that gives some optimism, though, is
the overtly functional behavior exhibited by biological
cells—presumably functional information processing by

∗
†
‡
§
¶
∗∗
††

gwwimsatt@ucdavis.edu
osaira@caltech.edu
abboyd@ucdavis.edu
matheny@caltech.edu
han@ku.edu
roukes@caltech.edu
chaos@ucdavis.edu; Corresponding author

small numbers of molecules subject to substantial thermal
fluctuations. Computing technologies are very far away
from this kind of robust information processing.
Only recently have tools appeared that precisely describe
what trade-offs exist between thermodynamic resources
and useful information processing—these are highly reminiscent of the centuries-old puzzle of how Maxwell’s “very
observant and neat-fingered” demon uses its “intelligence”
to convert disorganized heat energy to useful work [1]. In
our modern era, his demon has led to the realization that
information itself is physical [2–4]—or, most constructively, that information is a thermodynamic resource [5].
This has opened up the new paradigm of thermodynamic
computing in which fluctuations play a positive role in
efficient information processing on the nanoscale. We now
conceptualize this via information engines: physical systems that are driven by, manipulate, store, and dissipate
energy, but simultaneously generate, store, lose, communicate, and transform information. In short, information
engines combine traditional engines comprised of heat,
work, and other familiar reservoirs with, what we now
call, information reservoirs [6, 7].
Reliable thermodynamic computing requires detecting

2
and controlling fluctuations in informational and energetic
resources and in engine functioning. For this, one appeals
to fluctuation theorems that capture exact time-reversal
symmetries and predict entropy production leading to
irreversible dissipation [8–14]. We are now on the doorstep of the very far-from-equilibrium thermodynamics
needed to understand the physics of computing. And,
in turn, this has started to reveal the physical principles
of how nature processes information in the service of
biological functioning and survival.
Proof-of-concept experimental tests have been carried out
in several substrates: probing biomolecule free energies
[15–17], work expended during elementary computing
(bit erasure) [18–23], and Maxwellian demons [24]. That
said, the suite of contemporary principles (Supplementary
Materials (SM) I) far outstrips experimental validation
to date.
To close the gap, we show how to diagnose thermodynamic computing on the nanoscale by explaining the
signature structures in work distributions generated during information processing. These structures track the
mesoscale evolution of a system’s informational states and
reveal classes of functional and nonfunctional microscopic
trajectories. We show that the informational-state evolutions are identified by appropriate conditioning and that
they obey a suite of trajectory-class fluctuation theorems,
which give accurate bounds on work, entropy production,
and dissipation. The result is a new tool that employs
mesoscopic measurements to diagnose nanoscale thermodynamic computing. For simplicity and to make direct
contact with previous efforts, we demonstrate the tools
on Landauer erasure of a bit of information in a superconducting flux qubit.
As a reference, we first explore the thermodynamics of bit
erasure in a simple model: a particle with position and momentum in a double-well potential V (x, t) and in contact
with a heat reservoir at temperature T . (Refer to Fig. 1.)
An external controller adds or removes energy from a work
reservoir to change the form of the potential V (·, t) via a
predetermined erasure protocol {(β(t), δ(t)) : 0 ≤ t ≤ τ }.
β(t) and δ(t) change one at a time piecewise-linearly
through four protocol substages: (1) drop barrier, (2) tilt,
(3) raise barrier, and (4) untilt. (See SM VI.) The system
starts at time t = 0 in the equilibrium distribution for a
double-well V (x, 0) at temperature T . Being equiprobable, the informational states associated with each of the
two wells thus contain 1 bit of information [25].
The default potential, V (·, 0) = V (·, τ ), has two symmetric wells separated by a barrier. Following common
practice we call the two wells, from negative to positive
position, the Left (L) and Right (R) informational states,
respectively.

The erasure protocol is designed so that the particle ends
in the R state with high probability, regardless of its initial
state. Conducting our simulation 3.5 × 106 times, 96.2%
of the particles were successfully erased into the R state.
Thus, as measured by the Shannon entropy, the initial 1
bit of information was reduced to 0.231 bits. Note that we
chose the protocol to give partially inaccurate erasure in
order to illustrate our main results on diagnosing success
and failure.
At all other times t, V (·, t) has either one or two local
minima, naturally defining metastable regions for a particle to be constrained and gradually evolve towards local
equilibrium. We therefore define the informational states
at time 0 ≤ t ≤ τ to be the metastable regions, labeling
them R and, if two exist, L — from most positive to
negative in position.
Since the protocol is composed of four simple substages,
we coarse-grain the system’s response by its activity during each substage at the level of its informational state.
Specifically, for each substage, we assign one of three
substage trajectory classes: the system (i) was always in
the R state, (ii) was always in the L state, or (iii) spent
time in each. Sometimes there is only one informational
state and so the latter two classes are not achievable for
all substages.
We then focus on a single mesoscopic observable—the thermodynamic work expended during erasure. An individual
realization generates a trajectory of system microstates,
with W (t, t0 ) being the work done on the system between
times 0 ≤ t < t0 ≤ τ ; see SM VI. Let Ws = W (ts−1 , ts )
denote the work generated during substage s and Cs
the substage trajectory class. Figure 1 (Outer plot sequence) shows the corresponding substage work distributions Pr(Ws , Cs ) obtained from our simulations. (See SM
VII.)
The drop-barrier and tilt substage work distributions are
rather simple, being narrow and unimodal. The raisebarrier distributions have some asymmetry, but are also
similarly simple. However, the untilt work distributions
(farthest right in Fig. 1) exhibit unusual features that
are significant for understanding the intricacies of erasure.
Trajectories that spend all of the untilt substage in either
the R state or L state form peaks at the most positive (red)
and negative (orange) work values, respectively. This is
because the R-state well is always increasing in potential
energy while the L-state well is always decreasing during
untilt. In contrast, the other trajectories contribute a
log-linear ramp of work values (blue) dependent on the
time spent in each. The ramp’s positive slope signifies
that more time is typically spent in the R state.
Looking at the total work Wtotal = W (0, τ ) generated
for each trajectory over the course of the entire erasure

102

102

10

100

0

Pr(W3,C3)

Pr(W2,C2)

3

V(x,t2)

10-2

10-2

10-4
-6

0

W2

10-4

6

V(x,t1)

-6

Raise
Barrier

Tilt

0

6

W3

V(x,t3)
~4kBT

~6kBT

100
10-2

Untilt

V(x,t0)

10-4
-6

0

W1

6

Reset

V(x,t4)

x

100

10-2
10-4
-6

7kBT
Initial: Single bit

102
Pr(W4,C4)

Drop
Barrier

Pr(x)

Pr(W1,C1)

102

0

W4

6

Erased: ~Zero bits

FIG. 1. Inner plot sequence: Erasure protocol (Table S1) evolution of position distribution Pr(x). Potential V (x, ts ) at substage
boundary times ts , s = 0, 1, 2, 3, 4. Starting at t = t0 , the potential evolves clockwise, ending at t = t4 in the same configuration
as it starts: V (x, t0 ) = V (x, t4 ). However, the final position distribution Pr(x) predominantly indicates the R state. The original
one bit of information in the distribution at time t = t0 has been erased. Outer plot sequence: Substage work distributions
Pr(Ws , Cs ) during substages s: (1) Barrier Drop, (2) Tilt, (3) Barrier Raise, (4) Untilt. During each substage s, distributions
are given for up to three substage trajectory classes Cs : red are of trajectories always in the R state, orange are of trajectories
always in the L state, and blue are of the rest, spending some time in each state.

protocol, we observe the strikingly complex and structured
distribution Pr(Wtotal ) shown in Fig. 2(Rear). There
are two clear peaks at the most positive and negative
work values separated by a ramp. This highly structured
work distribution, generated by bit erasure, contrasts
sharply with the unimodal work distributions common
in previous studies; see, for example, Fig. 2(inset) for
the work distribution generated by a thermodynamicallydriven simple harmonic oscillator translated in space or
Fig. 2 in Ref. [12].
We can understand the mechanisms behind this structure
when decomposing Fig. 2 (Rear)’s total work distribution
under the untilt substage trajectory classes C4 . We label
trajectories that spend all of the untilting substage in
the R state Success since, via the previous substages,
they reach the intended R state by the untilting substage
and remain there until the protocol’s end. Similarly,
trajectories that spend all of the untilt substage in the
L state are labeled Fail. The remaining trajectories are
labeled Transitional, since they transition between the two
informational states during untilt, potentially succeeding

or failing to end in the R state. Figure 2 (Three front
plots) shows the work distribution for each of these three
trajectory classes. Together they recover the total work
distribution over all trajectories shown in Fig. 2(Rear).
Though, now the thermodynamic contributions to the
total from the functionally-distinct component trajectories
are made apparent.
Exploring the mesoscale dynamics of erasure revealed
signatures of a “thermodynamics” for each trajectory that
is closely associated with successful or failed information
processing. We now introduce the underlying fluctuation
theory from which the trajectory thermodynamics follow.
Key to this is comparing system behaviors in both forward
and reverse time [8–14]. (See SM III and IV.)
This suite of trajectory-class fluctuation theorems
(TCFTs) applies to arbitrary classes of system microstate
trajectories obtainable during a thermodynamic transformation. Importantly, they interpolate between Jarzynki’s
equality [10] and Crooks’ detailed fluctuation theorem
[12], as the trajectory class varies. This lower bounds the
average work hW iC over any measurable subset C of the

4
Pr(Wtotal)

100

changes:

Harmonic
oscillator



10

∆F = −kB T ln

-4

-4

W

0

Failure

Pr(Wtotal,C4)

100

Success

10-4

Transitional
-6

-4

-2

0

2

Wtotal (kBT)

4

FIG. 2. (Rear, purple) Total work distribution of all trajectories Pr(Wtotal ) during erasure: A histogram generated
from 3.5 × 106 trials for Wtotal ∈ [−6, 4] over 201 bins. (Inset, gray) Typical unimodal work distribution illustrated for
spatially-translated thermally-driven simple harmonic oscillator. (Three front plots) Work distributions Pr(Wtotal , C4 ) for
the trajectory classes C4 determined by the untilt trajectory
partition: The red work distribution (middle) is that of Success trajectories, the orange (rear) is that of Fail trajectories,
and the blue (front) is that of the remaining, Transitional
trajectories.

→
−
ensemble of system microstate trajectories Z , where W
is the total work for a trajectory:
hW iC ≥ ∆F + kB T ln
= hW imin
,
C


.

(2)

4

All

10-2

P(C) −W/kB T
he
iC
R(C R )

P(C)
R(C R )
(1)

with ∆F the change in equilibrium free energy over the
protocol, P(C) the probability of realizing the class C
during the protocol, and R(C R ) the probability of obtaining the time reverse of class C under the time-reverse
protocol. kB is Boltzmann’s constant.

The TCFTs lead to several consequences. First, wellformulated trajectory classes allow accurate estimates of
the works for their trajectories, even with limited knowledge of system response under the protocol and its time
reverse. Second, they strictly and more strongly bound
the average work over all trajectories compared to the
equilibrium free energy change ∆F . Third, they provide
a new expression for obtaining equilibrium free-energy

Remarkably, this only requires statistics for a particular
class C and its reverse C R to produce the system’s free
energy change. Since rare microstate trajectories may
generate sufficiently negative works that dominate the
average exponential work, this leads to a substantial statistical advantage over direct use of Jaryznski’s equality
− for estimating free energies
∆F = −kB T lnhe−W/kB T i→
Z
[26].
To explore these predictions, we selected a superconducting flux qubit composed of paired Josephson junctions
(Fig. 3(A)), resulting in a double-well nonlinear potential
that supports information storage and processing (Fig.
3(B)). SM VIII A explains the physics underlying their
nonlinear equations of motion, comparing the similarities and differences with our model’s idealized Langevin
dynamics.
Despite control protocols for double-well potentials that
perform accurate and efficient bit erasure [27], we run
the flux qubit in a mode that yields imperfect erasure
(Fig. 3(C)). As with the simulations, our intention is
to illustrate how trajectory classes and the TCFTs can
be used to diagnose and interpret success and failure in
microscopic information processing using only mesoscopic
measurements of work.
Interplay between the geometric, linear magnetic inductances and the nonlinear Josephson inductances gives rise
to a potential landscape that can be controlled with external bias fluxes. It is natural to call the φx and φxdc fluxes,
threading the differential mode and the small SQUID
loop, respectively, the tilt and barrier controls. (See (Fig.
3(A) caption.) SM VIII presents a derivation of the flux
qubit potential and details its calibration. All experiments presented here were carried out at a temperature
of 500 mK.
To execute an erasure protocol, we first choose an
information-storage state with a tall barrier and two equaldepth wells. The two-dimensional potential for this at
the calibrated device parameters is depicted in Fig. 3(B).
We implement the bit erasure protocol as a time-domain
deformation imposed by the two control fluxes that starts
and ends at the storage configuration. The amplitudes of
the control waveforms in reduced units are small; see Fig.
3(C). Hence, the microscopic energetics change linearly
as a function of the control fluxes.
We use a local dc-SQUID magnetometer to continuously
monitor the trapped flux state in the device—Readout
1 in Fig. 3(A). The digitized signal has a rise time of
100 µs, after which the two logical states are discriminated

Barrier control
Readout 1

0.01
0

Tilt control

-0.01
-2.56
-2.57
-2.58
2
1
0
-1
-2
-3
0

Barrier control

V(t)

Readout 2

φx,dc

C

A

φx-φx(0)

5

Tilt control

100 um

10

20
time (ms)

D

30

40

50

B
log f (φ, φdc )

1.0

All

0.5
Failure

0.0

Pr(Wtotal,C4)

100
Success

10-2

−2.4
φ dc

−2.7
−3.0

−2

0
φ

2

Transitional

-4

-2

0

2

Wtotal (kBT)

4

FIG. 3. Superconducting implementation of metastable memory and bit erasure driven by thermal fluctuations: (A) Optical
micrograph of a gradiometric flux qubit with control lines and local magnetometers for state readout. The flux φx , threading the
large U-shaped differential-mode loop, controls the potential’s tilt and flux φxdc , threading the small SQUID loop, controls the
potential barrier height. Currents in the barrier control and tilt control lines modulate those fluxes. (B) Calculated potential
energy landscape at the beginning of the erasure protocol; see Eqs. (S18) and (S19). (C top) Sequence of tilt and barrier
control waveforms implementing bit erasure and (C bottom) sample of resulting magnetometer traces tracking the system’s
internal state. (D) Work distributions Pr(Wtotal |C4 ) over trajectories conditioning on the Success, Fail, and Transitional classes.
Experimental distributions obtained from 105 protocol repetitions.

virtually without error. A typical magnetometer trace
V (t) acquired during the execution of the erasure protocol
is shown in Fig. 3(C). We operate the magnetometer with
a low-amplitude AC current bias at 10 MHz to avoid an
increase in the effective temperature during continuous
readout of the flux state due to wideband electromagnetic
interference.

find ULR (t) = A (φx (t) − φx (0)), with the coefficient
A = 210K × kB evaluated from the calibrated potential. The above work estimate based on the logical-state
transitions is an accurate estimate of the true microscopic
work assuming that the timescales for the state transitions and for changes in the control parameters are much
slower than the intra-well equilibration. (See SM VI.)

To collect work statistics, we repeat the erasure protocol
105 times. We identify the logical-state transitions from
the magnetometer traces as zero-crossings, recording the
direction δi —sign convention: +1 (−1) for a L-to-R (Rto-L) transition—and the time ti relative to the start of
the protocol. We evaluate a single-shot work estimate
P
W =
i δi ULR (ti ), where ULR (t) = UR (t) − UL (t) is
the biasing of the potential minima at time ti . Making use of the linearity of the system energetics and
the choice of offsets and compensation coefficients, we

The total work distribution estimated from the flux qubit
experiments is shown as the rear-most distribution in Fig.
3(D). Using the previous microstate trajectory partitioning into the Success, Fail, and Transitional trajectory
classes reveals a decomposition of the total work distribution given by Fig. 3(D)(Three front panels). The
close similarity with our simulations (Fig. 2) is notable.
Especially so, given the rather substantial differences
between the simulated system (idealized double-well potential and thermal noise, exactly one-dimension system,

6
...) and the experimental system (complex potential in
two dimensions, nonideal fluctuations, ...). A priori it is
not clear that the theoretical predictions of the informational classes should apply so directly and immediately
to the real-world qubit. In point of fact, these differences
serve to emphasize the descriptive power of the mesoscopic work fluctuation theorems: despite substantial
differences in system detail they successfully diagnose the
information-processing classes of microscopic trajectories.
This robustness will be especially helpful in monitoring
thermodynamic computing in biological systems, where,
in many cases, information-bearing degrees-of-freedom
cannot be precisely modeled.

a unified diagnostic probe of nonequilibrium thermodynamic transformations that support information processing.

We experimentally demonstrated that work fluctuations
generated by information engines are highly structured.
Nonetheless, they strictly obeyed a suite of time-reversal
symmetries—the trajectory-class fluctuation theorems introduced here. The latter are direct signatures of how
a system’s informational states evolve and they identify
functional and nonfunctional microscopic trajectory bundles. We showed that the trajectory-class fluctuation
theorems naturally interpolate between Jarzynski’s integral and Crooks’ detailed fluctuation theorems, providing

Using them we gave a detailed mechanistic analysis of the
thermodynamics of the now-common example of erasing a
bit of information as an external protocol manipulated a
stochastic particle in a double-well potential (simulation)
and the stochastic state of a flux qubit (experiment). To
give insight into the new level of mechanistic analysis
possible, we briefly discussed the untilt trajectory-class
partitioning. Though ignoring other protocol stages, this
was sufficient to capture the basic trajectory classes that
generate the overall work distribution’s features. Partitioning on informational-state occupation times during
barrier raising and untilting—an alternative used in followon studies—yields an even more incisive decomposition
of the work distributions and diagnosis of informational
functioning. The corresponding bounds on thermodynamic resources obtained via the TCFTs also improve
on current estimation methods. The net result is that
trajectory-class analysis can be readily applied to debug
thermodynamic computing by engineered or biological
systems.

[1] C. G. Knott. Life and Scientific Work of Peter Gurthrie
Tait. Cambridge University press, Cambridge, United
Kingdom, 1911. Letter from Maxwell to Tait, 11 December
1867, quoted herein pp. 213-214.
[2] R. Landauer. Irreversibility and heat generation in the
computing process. IBM J. Res. Develop., 5(3):183–191,
1961.
[3] C. H. Bennett. Thermodynamics of computation—A
review. Intl. J. Theo. Phys., 21:905, 1982.
[4] J. M. R. Parrondo, J. M. Horowitz, and T. Sagawa. Thermodynamics of information. Nature Physics, 11(2):131–
139, 2015.
[5] A. B. Boyd, D. Mandal, and J. P. Crutchfield. Leveraging environmental correlations: The thermodynamics of
requisite variety. J. Stat. Phys., 167(6):1555–1585, 2016.
[6] D. Mandal and C. Jarzynski. Work and information
processing in a solvable model of Maxwell’s demon. Proc.
Natl. Acad. Sci. USA, 109(29):11641–11645, 2012.
[7] A. B. Boyd and J. P. Crutchfield. Maxwell demon dynamics: Deterministic chaos, the Szilard map, and the
intelligence of thermodynamic systems. Phys. Rev. Lett.,
116:190601, 2016.
[8] G. N. Bochkov and Y. E. Kuzovlev. Nonlinear fluctuationdissipation relations and stochastic models in nonequilibrium thermodynamics: I. generalized fluctuationdissipation theorem. Physica A: Stat. Mech. App.,
106(3):443–479, 1981.
[9] D. J. Evans and D. J. Searles. Equilibrium microstates
which generate second law violating steady states. Phys.

Rev. E, 50(2):1645–1648, 1994.
[10] C. Jarzynski. Nonequilibrium equality for free energy
differences. Phys. Rev. Lett., 78(14):2690–2693, 1997.
[11] G. E. Crooks. Nonequilibrium measurements of free energy differences for microscopically reversible Markovian
systems. J. Stat. Phys., 90(5/6):1481–1487, 1998.
[12] G. E. Crooks. Entropy production fluctuation theorem
and the nonequilibrium work relation for free energy differences. Phys. Rev. E, 60:2721, 1999.
[13] U. Seifert. Stochastic thermodynamics, fluctuation
theorems and molecular machines. Rep. Prog. Phys.,
75:126001, 2012.
[14] R. Klages, W. Just, and C. Jarzynski, editors. Nonequilibrium Statistical Physics of Small Systems: Fluctuation
Relations and Beyond. Wiley, New York, 2013.
[15] P. Maragakis, M. Spichty, and M. Karplus. A differential
fluctuation theorem. J. Phys. Chem. B, 112(19):6168–
6174, 2008.
[16] I. Junier, A. Mossa, M. Manosas, and F. Ritort. Recovery
of free energy branches in single molecule experiments.
Phys. Rev. Lett., 102(7):070602, 2009.
[17] A. Alemany, A. Mossa, I. Junier, and F. Ritort. Experimental free-energy measurements of kinetic molecular
states using fluctuation theorems. Nature Physis, 8:688–
694, 2012.
[18] B. Lambson, D. Carlton, and J. Bokor. Exploring the
thermodynamic limits of computation in integrated systems: Magnetic memory, nanomagnetic logic, and the
Landauer limit. Phys. Rev. Lett., 107:010604, 2011.

7
[19] A. Berut, A. Petrosyan, and S. Ciliberto. Detailed Jarzynski equality applied to a logically irreversible procedure.
Euro. Phys. Let., 103:60002, 2013.
[20] M. Madami, M. d’YAquino, G. Gubbiotti, S. Tacchi,
C. Serpico, and G. Carlotti. Micromagnetic study of
minimum-energy dissipation during Landauer erasure of
either isolated or coupled nanomagnetic switches. Phys.
Rev. B, 90:104405, 2014.
[21] Y. Jun, M. Gavrilov, and J. Bechhoefer. High-precision
test of Landauer’s principle. Phys. Rev. Lett., 113:190601,
2014.
[22] A. Berut, A. Petrosyan, and S. Ciliberto. Information and
thermodynamics: Experimental verification of Landauer’s
erasure principle. J. Stat Mech: Theory and Experiment,
2015(6):P06015, 2015.
[23] J. Hong, B. Lambson, S. Dhuey, and J. Bokor. Experimental test of Landauer’s principle in single-bit operations on
nanomagnetic memory bits. Sci. Adv., 2:e1501492, 2016.
[24] J. V. Koski, A. Kutvonen, I. M. Khaymovich, T. AlaNissila, and J. P. Pekola. On-chip Maxwell’s demon as
an information-powered refrigerator. Phys. Rev. Lett.,
115:260602, 2015.
[25] T. M. Cover and J. A. Thomas. Elements of Information
Theory. Wiley-Interscience, New York, second edition,
2006.
[26] C. Jarzynski. Rare events and the convergence of exponentially averaged work values. Phys. Rev. E, 73(4):046105,
2006.
[27] A. B. Boyd, A. Patra, C. Jarzynski, and J. P. Crutchfield.
Shortcuts to thermodynamic computing: The cost of fast
and faithful erasure. arXiv:1812.11241.
[28] A. B. Boyd, D. Mandal, and J. P. Crutchfield. Identifying
functional thermodynamics in autonomous Maxwellian
ratchets. New J. Physics, 18:023049, 2016.
[29] S. Still, D. A. Sivak, A. J. Bell, and G. E. Crooks. Thermodynamics of prediction. Phys. Rev. Lett., 109:120604,
2012.
[30] A. B. Boyd, D. Mandal, P. M. Riechers, and J. P. Crutchfield. Transient dissipation and structural costs of physical
information transduction. Phys. Rev. Lett., 118:220602,
2017.
[31] A. B. Boyd, D. Mandal, and J. P. Crutchfield. Correlationpowered information engines and the thermodynamics of
self-correction. Phys. Rev. E, 95(1):012152, 2017.
[32] A. B. Boyd, D. Mandal, and J. P. Crutchfield. Thermodynamics of modularity: Structural costs beyond the
Landauer bound. Phys. Rev. X, 8(3):031036, 2018.
[33] P. M. Riechers and J. P. Crutchfield. Fluctuations when
driving between nonequilibrium steady states. J. Stat.
Phys., 168(4):873–918, 2017.
[34] C. Aghamohammdi and J. P. Crutchfield. Thermodynamics of random number generation. Phys. Rev. E,
95(6):062139, 2017.
[35] P. R. Zulkowski and M. R. DeWeese. Optimal control of
overdamped systems. Phys. Rev. E, 92(5):032117, 2015.

[36] T. R. Gingrich, G. M. Rotskoff, G. E. Crooks, and P. L.
Geissler. Near optimal protocols in complex nonequilibrium transformations. Proc. Natl. Acad. Sci. U.S.A.,
113(37):10263–10268, 2016.
[37] A. Patra and C. Jarzynski. Classical and quantum shortcuts to adiabaticity in a tilted piston. J. Phys. Chem. B,
121:3403–3411, 2017.
[38] A. Gomez-Marin, J. M. R. Parrondo, and C. Van den
Broeck. Lower bounds on dissipation upon coarse graining.
Phys. Rev. E, 78(1):011107, 2008.
[39] G.E. Crooks. Excursions in statistical dynamics. PhD
thesis, University of California, Berkeley, 1999.
[40] C. Jarzynski. Comparison of far-from-equilibrium work relations. Comptes Rendus Physique, 8(5-6):495–495, 2007.
[41] A. Berut, A. Arakelyan, A. Petrosyan, S. Ciliberto, R. Dillenschneider, and E. Lutz. Experimental verification of
Landauer’s principle linking information and thermodynamics. Nature, 483:187–190, 2012.
[42] S. Han, J. Lapointe, and J. E. Lukens. Effect of a twodimensional potential on the rate of thermally induced
escape over the potential barrier. Phys. Rev. B, 46:6338,
1992.

Acknowledgments: We thank C. Jarzynski, D. Mandal,
and P. Riechers for helpful discussions. As an External
Faculty member, JPC thanks the Santa Fe Institute and
the Telluride Science Research Center for their hospitality
during visits.
Funding: This material is based upon work supported by,
or in part by, the U. S. Army Research Laboratory and
the U. S. Army Research Office under contracts W911NF13-1-0390 and W911NF-18-1-0028.
Author Contributions Statement: JPC, OPS, MLR, and
GW conceived of the project. ABB, GW, and JPC developed the theory. SH provided the flux qubit and the
experimental and analytical methods for its calibration.
MHM, MLR, OPS, designed, implemented, and carried
out the experiments. GW and JPC performed the calculations. JPC, OPS, MLR, and GW drafted the manuscript.
JPC and MLR supervised the project.
Competing Financial Interests Statement: The authors
declare that they have no competing financial interests.
Data Availability: The data that support the findings of
this study are available from the corresponding author on
reasonable request.

Supplementary Materials

Materials and Methods: Derivation of trajectory-class
fluctuation theorems, further discussion and interpretation, and experiment implementation, calibration, and
work estimation methods.

1

Supplementary Materials
Harnessing Fluctuations in Thermodynamic Computing
via
Time-Reversal Symmetries
One Sentence Summary:
Distinct distributions of thermodynamic work identify signatures of successful and failed information processing in a microscale
flux qubit
Gregory Wimsatt, Olli-Pentti Saira, Alexander B. Boyd, Matthew H. Matheny,
Siyuan Han, Michael L. Roukes, and James P. Crutchfield

Materials and Methods
The following presents details, derivations, and explanations for the theoretical claims and experimental results. First,
we give a synopsis of recently developed principles of thermodynamic computing. Then, we introduce the model
microscopic stochastic thermodynamical system, including its equations of motion and its physical calibration. The
following sections explain how to use and interpret the trajectory-class fluctuation theorems and provide their derivation.
Their practical application to work estimation for trajectories and classes, in light of the alternative kinds of work
(inclusive and exclusive) and methods for experimental estimation, is laid out. A brief commentary on the substage
work distributions then follows. Finally, we turn to describe the flux qubit, its equations of motion, implementation,
calibration, and measurement.

I.

PRINCIPLES OF THERMODYNAMIC COMPUTING: A RECENT SYNOPSIS

A number of closely-related thermodynamic costs of computing have been identified, above and beyond the housekeeping heat that maintains a system’s overall nonequilibrium dynamical state. First, there is the information-processing
Second Law [28] that extends Landauer’s original bound on erasure [2] to dissipation in general computing and properly
highlights the central role of information generation measured via the physical substrate’s dynamical Kolmogorov-Sinai
entropy. It specifies the minimum amount of energy that must be supplied to drive a given amount of computation
forward. Second, when coupling thermodynamic systems together, even a single system and a complex environment,
there are transient costs as the system synchronizes to, predicts, and then adapts to errors in its environment [29–31].
Third, the very modularity of a system’s organization imposes thermodynamic costs [32]. Fourth, since computing is
necessarily far out of equilibrium and nonsteady state, there are costs due to driving transitions between informationstorage states [33]. Fifth, there are costs to generating randomness [34], which is itself a widely useful resource. Finally,
by way of harnessing these principles, new strategies for optimally controlling nonequilibrium transformations have
been introduced [27, 35–37].

II.

MICROSCOPIC STOCHASTIC THERMODYNAMICAL SYSTEM

For concreteness, we concentrate on a one-dimensional system: a particle with position and momentum in an
external potential V (x, t) and in contact with a heat reservoir at temperature T . An external controller adds or
removes energy from a work reservoir to change the form of the potential V (·, t) via a predetermined erasure protocol
{(β(t), δ(t)) : 0 ≤ t ≤ τ }. (See Supplementary Materials (SM) VI for details on the alternative definitions of work.)
The potential takes the form:
V (x, t) = ax4 − b0 β(t)x2 − c0 δ(t)x ,
with constants a, b0 , c0 > 0. During the erasure protocol, β(t) and δ(t) change one at a time piecewise-linearly through
four protocol substages: (1) drop barrier, (2) tilt, (3) raise barrier, and (4) untilt, as shown in Table S1. The system

2
starts at time t = 0 in the equilibrium distribution for a double-well V (x, 0) at temperature T . Being equiprobable,
the informational states associated with each of the two wells thus contain 1 bit of information [25]. The effect of the
control protocol on the system potential and system response is graphically displayed in Fig. 1.
Stage Drop Barrier Tilt Raise Barrier Untilt
ts
t0
t1
t2
t3
t4
β(t)

t1 −t
t1 −t0

0

t−t2
t3 −t2

1

δ(t)

0

t−t1
t2 −t1

1

t4 −t
t4 −t3

TABLE S1. Erasure protocol.

We model the erasure physical information processing with underdamped Langevin dynamics:
dx = vdt


p
√
∂
V (x, t) + γv dt ,
dv = 2kB T γ/m r(t) dt −
∂x

(S1)

where kB is Boltzmann’s constant, γ is the coupling between the heat reservoir and system, m is the particle’s mass,
and r(t) is a memoryless Gaussian random variable with hr(t)i = 0 and hr(t)r(t0 )i = δ(t − t0 ).
For comparison to experiment, we simulated erasure with the following parameters,
sufficient to fully specify the
p
dynamics: γτ /m = 500, 2kB T τ 2 a/(mb0 ) = 2.5 × 105 , b20 /(4akB T ) = 7, and 8a/b30 c0 = 0.4. The resulting potential,
snapshotted at times during the erasure substages, is shown in Fig. 1(Inner plot sequence).
Reliable information processing dictates that we set time scales so that the system temporarily, but stably, stores
information. To support metastable-quasistatic behavior at all times the relaxation rates of the informational states
are much faster than the rate of change of the potential, keeping the system near metastable equilibrium throughout.
The entropy production for such protocols tends to be minimized.

III.

TRAJECTORY-CLASS FLUCTUATION THEOREMS: USE AND INTERPRETATION

Here, we describe the trajectory-class fluctuation theorems, explaining several of their possible implications and
exploring their application to both the simulations and flux qubit experiment. Their derivations are given in the
section following.
→
−
First, consider a forward process distribution P, defined by the probabilities of the system microstate trajectories Z
due to an initial equilibrium microstate distribution evolving forward in time under a control protocol. Then, the
reverse process distribution R is determined by preparing the system in equilibrium in the final protocol configuration
and running the reverse protocol. The reverse protocol is the original protocol conducted in reverse order but
also with objects that are odd under time reversal, like magnetic fields, negated. The time-reversal of a trajectory
R
→
−
−
z = (z0 , z1 , . . . z` ) is →
z = (z`R , . . . , z1R , z0R ), where ziR = −zi if zi is odd under time-reversal (e.g., momentum or spin),
→
−
otherwise ziR = zi . For a measurable subset of trajectories C ⊂ Z , let h·iC denote an average over the ensemble of
forward process trajectories conditioned on the trajectory class C. Let P(C) and R(C R ) denote the probabilities of
R −
−
observing the class C in the forward process and the reverse class C R = {→
z |→
z ∈ C} in the reverse process, respectively.
We first introduce a trajectory-class fluctuation theorem (TCFT) for the class-averaged exponential work he−W/kB T iC :
he−W/kB T iC =

R(C R ) −∆F/kB T
e
,
P(C)

with ∆F the system equilibrium free energy change. We also introduce a class-averaged work TCFT:


h →
−
→
−R R i
P(C)
hW iC = ∆F + kB T DKL P( Z |C)||R( Z |C ) + ln
.
R(C R )

(S2)

(S3)

3
This employs the Kullback-Liebler divergence DKL [ · ] taken between forward and reverse process distributions over
−
z ∈ C, conditioned on the forward class C and reverse class C R , respectively. If we disregard this
all class trajectories →
divergence, which is nonnegative and would generally be difficult to obtain experimentally, we then find the lower
bound hW imin
on the class-averaged work of Eq. (1).
C
In the limit of class C possessing only a single trajectory, we recover detailed fluctuation theorems as in Ref. [12]. If,
→
−
however, we take C to be the entire set of trajectories Z , we recover integral fluctuation theorems as in Jarzynski’s
equality [10]. Thus, the TCFTs are a suite that spans the space of fluctuation theorems between the extreme of the
detailed theorems, that require very precise information about an individual trajectory, and the integral theorems,
that describe the system’s entire trajectory ensemble. SM IV below provides proofs for both TCFTs.
We can rearrange Eq. (S2) to obtain Eq. (2)—an expression for estimating equilibrium free energy changes:


P(C) −W/kB T
∆F = −kB T ln
he
i
.
C
R(C R )

(S4)

Thus, to estimate free energy one sees that statistics are needed for only one particular class and its reverse. Generally,
this gives a substantial statistical advantage over direct use of Jaryznski’s equality:
− ,
∆F = −kB T lnhe−W/kB T i→
Z

since rare microstate trajectories may generate negative work values that dominate the average exponential work [26].
The problem is clear in the case of erasure. Recall from Fig. 2(Three front panels) that Fail trajectories generate the
most-negative work values. In the limit of higher success-rate protocols that maintain low entropy production, failures
generate more and more negative works, leading them to dominate when estimating average exponential works.
In contrast, to efficiently determine the change in equilibrium free energy from Eq. (2), its form indicates that one
should choose a class that (i) is common in the forward process, (ii) has a reverse class that is common in the reverse
process, and (iii) generates a narrow work distribution. This maximizes the accuracy of statistical estimates for the
three factors on the RHS. For example, while the equilibrium free energy change in the case of our erasure protocol is
theoretically simple (zero); the Success class fits the criteria.
We can then monitor the class-averaged work in excess of its bound:
EC = hW iC − hW imin
C
h →
i
−
→
−R
= kB T DKL P( Z |C)||R( Z |C R )
≥0.
The inequality in Eq. (1) is a refinement of the equilibrium Second Law and therefore the bound hW imin
generally
C
provides a more accurate estimate of the average work of trajectories in a class compared to the equilibrium free
energy change ∆F . More precisely, as we will see below, an average of the excess EC over all classes C in a partition of
trajectories must be smaller than the dissipated work hW i − ∆F . For trajectory classes with narrow work distributions,
this can be a significant improvement. We can see this by Taylor expanding the LHS of Eq. (S2) about the mean
dimensionless work hW/kB T iC . This shows that Eq. (1) becomes an equality when the variance and higher moments
vanish. SM V below delves more into moment approximations. In any case, trajectory classes with narrow work
distributions have small excess works EC .
To estimate R(C R ), we ran 3.5 × 106 simulations of the reverse process. Table S2 shows that the Success and Fail classes
have small excesses and, as seen in Fig. 2(Three front panels), these classes indeed have narrow work distributions.
Elsewhere we explore these and additional partition schemes, finding that the Transitional trajectories can be further
partitioned to yield narrow work distributions so that all trajectory classes have small excesses EC . In short, this
demonstrates how well-formulated trajectory classes allow accurate estimates on the works for all trajectories.
To measure the efficacy of a given partition Q of trajectories into classes, we ask what the ensemble-average of

4
Simulation
Class C
→
−
All Z
Success
Fail
Transitional

hW iC
0.634
0.713
-3.885
-0.546

hW imin
C
0.0
0.683
-3.951
-1.650

EC
0.634
0.030
0.066
1.170

Partition
Q
n→
−o
Trivial Z

− hW imin EQ
hW i→
Q
Z

0.634

Untilt-Centric I 0.634
Untilt-Centric II 0.634

0.0

0.634

0.560 0.074
0.601 0.032

Experiment
Class C
→
−
All Z
Success
Fail
Transitional

hW iC
0.668
0.742
-3.132
-0.443

hW imin
C
0.0
0.643
-3.475
-1.215

EC
− hW imin EQ
Q
hW i→
0.668 Partition
Q
Z
n→
−o
Trivial
Z
0.668
0.0
0.668
0.099
0.343 Untilt-Centric I 0.668 0.554 0.115
0.772

TABLE S2. (Top Left) Comparison of simulated class-average works and bounds for different trajectory classes: All trajectories
−
→
Z , Success trajectories, Fail trajectories, and Transitional trajectories. These are identified in Fig. 2 (Four front panels).
From left to right, columns give the estimated class-average work hW iC , TCFT lower bound hW imin
C , and their difference EC .
3.5 × 106 simulations were run for each of the forward and reverse processes, with 96.2% trajectories successfully ending in
the R informational state under the forward process. (Top Right) Comparison of ensemble-average work and bounds due to
different partitions: Trivial partition; Untilt-Centric I partition, composed of Success, Fail, and Transitional; and Untilt-Centric
II partition, described in follow-on work. From left to right, columns give the estimated ensemble-average work, the partition
bound hW imin
Q , and their difference EQ . All values in units of kB T . (Bottom) Parallel results from the flux qubit experiment.
−
→
All trajectories Z , Success, Fail, and Transitional trajectories identified in Fig. 3(D). Data from 195, 050 trajectories from the
forward protocol and 250, 000 trajectories from the reverse protocol.

class-average excess works is:
EQ =

X

P(C)EC

C∈Q
− −
= hW i→
Z

X

P(C)hW imin
C

C∈Q
− − hW imin
= hW i→
,
Q
Z

with hW imin
Q =

P

C∈Q

P(C)hW imin
C .

From Eq. (1), we see that hW imin
is the coarse-grained lower bound on ensemble-average dissipation from Ref. [38]:
Q
R
hW imin
Q = ∆F + kB T DKL [P(Q)||R(Q )] ,

where DKL [ · ] is the Kullback-Liebler divergence between forward and reverse process distributions over the trajectory
classes C ∈ Q. Since Kullback-Liebler divergences are nonnegative, such a bound always provides an improvement
→
−
over the equilibrium Second Law. Table S2 shows both hW imin
and EQ for the trivial partition { Z }, our three-class
Q
partition, labeled Untilt-Centric I, and the improved partition described in follow-on work, labeled Untilt-Centric
II. In this case, the latter two also provide an improvement on the nonequilibrium Second Law which, assuming
metastable starting and ending distributions, provides a lower bound on the average work equal to 0.533, the change
in nonequilibrium free energy.
We can appeal to Landauer’s erasure bound—kB T ln 2 ≈ 0.693 kB T —to calibrate the excesses EC and EQ . We see for
the simulation data that our three-class partition Untilt-Centric I provides class-average work bounds that, on average,
are only about 11% of kB T ln 2 from the actual class-average works. The more refined Untilt-Centric II partition
reduces this excess to about 5% while the trivial partition fails by about 91% of kB T ln 2.

5
The experimental data matches these results, with the largest discrepancy occurring for the class-average excess for
the Fail class. This is not wholly coincidence, since we determined the parameters of the experimental protocol by
adjusting the parameters of a simple two-state Markov simulation to obtain a work distribution similar to that obtained
by our Langevin simulations of the Duffing potential system described in the main text. However, it is interesting that
this was sufficient to provide matches in both the clean decomposition of the total work distribution by trajectory
class and the quantities of Table S2.
We also recover the equality of Ref. [38] for the ensemble-average work by averaging Eq. (S3) over each class:
hW i =

X

P(C)hW iC

C

= ∆F + kB T

X


h →
−
→
−R R i
R
P(C)DKL P( Z |C)||R( Z |C ) + DKL [P(Q)||R(Q )] ,

C∈Q

which of course is lower bounded by hW imin
Q .
These results suggest the criterion for optimal trajectory partitions: Select a partition sufficiently refined to yield
tight bounds on class-average works, but no finer. Machine learning methods for model order selection will provide a
basis for a natural classification scheme for trajectories that captures all relevant thermodynamics and information
processing.
By changing our forward and reverse processes P and R to begin in system microstate distributions other than
equilibrium, a yet-broader class of TCFTs emerge. We can then find analogous results for heats and comparisons with
works and nonequilibrium free-energy changes. We explore these in depth elsewhere.

IV.

TCFT DERIVATIONS

We now present derivations for the two TCFTs introduced in Eqs. (S2) and (S3).
Assume that the system dynamics is described by a Hamiltonian specified in part by an external control protocol, as
well as by a weak coupling to a thermal environment that induces steady relaxation to canonical equilibrium.
Start the system in equilibrium distribution π0 for Hamiltonian H0 and run a protocol until time τ , causing the system
Hamiltonian to evolve to Hτ . If we then hold the Hamiltonian at Hτ for a long time, the system relaxes into the
equilibrium distribution πτ . The system’s ensemble entropy change from t = 0 to t = ∞ is then:
X
∆Ssys =
[−πτ (z) ln πτ (z) + π0 (z) ln π0 (z)] .
z

The trajectory-wise system entropy difference is defined to be:
π0 (z0 )
−
∆ssys (→
z ) = ln
,
πτ (zτ )
−
where z0 and zτ are the initial and final microstates of system microstate trajectory →
z , respectively. Averaged over all
→
−
→
−
trajectories z ∈ Z , this then becomes the ensemble entropy change.
−
−
Let p(→
z |z0 ) denote the probability of obtaining system microstate trajectory →
z via the protocol conditioned on
→
−
starting the system in state z0 = z (0).
Now, start the system Hamiltonian at Hτ and run the reverse protocol, ending the Hamiltonian at H0 . We then obtain
−
−
the trajectory →
z with a different conditional probability: r(→
z |z0 ).
−
Assuming microscopic reversibility and given a system trajectory →
z , the change in the heat bath’s entropy is:
−
p(→
z |z0 )
−
−
∆Sres (→
z ) = −βQ(→
z ) = ln →
,
R
−
r( z |zτR )

(S5)

−
−
where β = 1/kB T , Q(→
z ) is the net energy that flows out of the heat bath into the system given the trajectory →
z , and
R
(·) denotes time-reversal. This holds for systems with strictly finite energies and Markov dynamics that induce the

6
equilibrium distribution when control parameters are held fixed [39]. Both our simulated Duffing potential system and
flux qubit obey these requirements at sufficiently short time scales. Then we can express the total trajectory-wise
−
change in entropy production due to a trajectory →
z as the sum of system and heat reservoir entropy changes:
−
−
−
∆Stot (→
z ) = ∆ssys (→
z ) + ∆Sres (→
z).
Since πt (z) = e−β(Ht (z)−Ft ) , with Ft the system’s equilibrium free energy at time t, we can write:
−
−
∆Stot (→
z ) = − ln πτ (zτ ) + ln π0 (z0 ) − βQ(→
z)
−
= β (Hτ (zτ ) − Fτ ) − β (H0 (z0 ) − F0 ) − βQ(→
z)
→
−
→
−
= β (∆H( z ) − Q( z ) − ∆F )
−
= β (W (→
z ) − ∆F ) .
Using Eq. (S5), we also have:
−
−
−
∆Stot (→
z ) = ∆ssys (→
z ) + ∆Sres (→
z)
→
−
π0 (z0 ) p( z |z0 )
= ln
R
−
πτ (zτ ) r(→
z |zτR )
−
P(→
z)
= ln
R
→
−
R( z )
with:
−
−
P(→
z ) = π0 (z0 )p(→
z |z0 ) and
R
R
→
−
→
−
R( z ) = π (z )r( z |z R ) .
τ

τ

τ

Combining, we obtain a detailed fluctuation theorem:
→
−
R
−
−
R(→
z ) = P(→
z )e−β (W ( z )−∆F ) .

(S6)

−
From here, we derive our first TCFT by integrating each side of Eq. (S6) over all trajectories →
z in a measurable set
→
−
C ⊂ Z . Starting with the LHS and recalling the Iverson bracket [·], which is 1 when the interior expression is true
and 0 when false, we have:
Z
Z
R
R −
R
→
−
→
−
→
−
−
−
d z [ z ∈ C]R( z ) = d→
z [→
z ∈ C]R(→
z )
Z
R − R
R
−
−
= d→
z [→
z ∈ C R ]R(→
z )
Z
−
−
−
= d→
z [→
z ∈ C R ]R(→
z)
= R(C R ) .
R −
−
The first three steps used the unity of the Jacobian in reversing a microstate, the definition C R = {→
z |→
z ∈ C}, and
R
→
−
→
−
swapping all instances of z with z . Integrating the RHS of Eq. (S6) then gives:
Z
→
−
−
−
−
d→
z [→
z ∈ C]P(→
z )e−β (W ( z )−∆F )
Z
→
−
−
−
= eβ∆F d→
z P(→
z , C)e−βW ( z )
Z
→
−
−
−
β∆F
= P(C)e
d→
z P(→
z |C)e−βW ( z )

= P(C)eβ∆F he−βW iC .

7
Combining, we have our first TCFT, Eq. (S2).
To obtain the second TCFT, we first change the form of Eq. (S6):
R
−
R(→
z )
−
.
W (→
z ) = ∆F − β −1 ln
−
P(→
z)

Then we calculate the class-average. The equilibrium free energy change is unaffected while the rightmost term
becomes:
*
+
Z
R
R
−
−
R(→
z )
R(→
z )
−
−
−1
−1
−β
ln
= −β
d→
z P(→
z |C) ln
→
−
→
−
P( z )
P( z )
C
C
Z
R
−
R(→
z |C R )R(C R )
−
−
= −β −1
d→
z P(→
z |C) ln
−
P(→
z |C)P(C)
C
!
Z
R
→
−
R
R
R(C
)
R(
z
|C
)
−
−
+ ln
= −β −1
d→
z P(→
z |C) ln
−
P(C)
P(→
z |C)
C


h
i
P(C)
R
−
−
= β −1 DKL P(→
z |C)||R(→
z |C R ) + ln
,
R(C R )
which gives Eq. (S3)’s TCFT.

V.

CLASS-AVERAGED WORK APPROXIMATION FOR NARROW DISTRIBUTIONS

Here, we demonstrate that the class-averaged work hW iC approaches its bound hW imin
when the variance and higher
C
moments of the class’ distribution of works vanish. One concludes that hW imin
is
a
good
approximation for hW iC
C
when the class’ work distribution is narrow.
We first express the LHS of Eq. (S2) in terms of the unitless distance of work from its class-average:
he−βW iC = he−x iC e−βhW iC ,
with x = β(W − hW iC ). Then, we Taylor expand the exponential inside the class-average:
he−x iC =

∞
X
(−1)n n
hx iC
n!
n=0

=1+a ,
with a =

P∞

n=2

(−1)n
n
n! hx iC .

Equation (S2) then gives:
(1 + a)e−βhW iC =

R(C R ) −β∆F
e
.
P(C)

Since e−x is convex,
(1 + a) = he−x iC ≥ e−hxiC = 1 ,
so a ≥ 0. Then:
P(C)
+ β −1 ln(1 + a)
R(C R )
P(C)
≥ ∆F + β −1 ln
R(C R )

hW iC = ∆F + β −1 ln

= hW imin
.
C

8
The second line becomes an equality when a goes to zero, which occurs as the variance and higher moments vanish.

VI.

WORK DEFINITIONS AND EXPERIMENTAL ESTIMATION

Properly estimating the required works and devolved heats from experimental devices undergoing cyclic control
protocols requires explicitly and consistently accounting for energy and information flows between the system, its
environment, and the controlling laboratory apparatus. To this end, we construct a model Hamiltonian universe
for common processes involving small systems interacting with laboratory apparatus and a thermal environment.
After deriving key equalities for two definitions of work, the inclusive and exclusive works, we define a method of
approximating them in appropriate cyclic protocols.

A.

The Model Universe and Hamiltonian

To study a small system that exchanges energy with its environment in the forms of heat and work, we introduce
a model universe: a system of interest, a heat bath, and a lab (laboratory apparatus) that controls the system and
derives any needed energy from a work reservoir. The system directly interacts with both the heat bath and the lab,
but the heat bath and lab are not directly coupled.
We assume that a Hamiltonian H describes the universe’s evolution and that there is a set of generalized coordinates
which can be sensibly partitioned into those for the system, heat bath, and lab. Then, we decompose the universe
Hamiltonian into the following form:
H(s, b, l) = HB (b) + hS,B (s, b) + HS (s) + hS,L (s, l) + HL (l) ,
where s, b, and l denote both the generalized coordinates and conjugate momenta for the system, bath, and lab,
respectively. For any universe Hamiltonian H, there can be many choices for this decomposition.
We also define the system Hamiltonian H0 as the three components that depend on the system coordinates:
H0 (s; b, l) = hS,B (s, b) + HS (s) + hS,L (s, l) .
First, consider the subset of lab coordinates l for which hS,L has nontrivial dependence. These so-called protocol
parameters λ are often simple and much fewer than the entire set of l. We often assume that we have total control of
their evolution. More precisely, under an appropriate preparation for the lab at time t = 0, a specific trajectory for the
protocol parameters {λ(t)}t for 0 ≤ t ≤ τ is guaranteed for all preparations of the heat bath and system coordinates.
We refer to the parameter trajectory as the protocol.
Suppose the heat-bath degrees of freedom that interact with the system change much faster than the system’s. We can
assume that the system response to the bath resembles Brownian motion. On the time scale of changes in the system
coordinates, then, we ignore the system-bath interaction term hS,B in writing the system Hamiltonian H0 :
H0 (s; λ) = HS (s) + hS,L (s, λ)
= T (s) + V (s, λ) .
The latter decomposition into kinetic energy T and potential energy V can be used to write Langevin equations of
motion for the system. Furthermore, if the heat bath has a relaxation time sufficiently short that it is roughly in
equilibrium at all times with fixed temperature, then its influence on the system will be memoryless.

B.

Inclusive and Exclusive Works and Heats

The basic scenario for executing a protocol is as follows. The universe coordinates begin according to a given initial
distribution Pr(s) at time t = 0 and they evolve in isolation until t = τ . As above, we assume that a well-defined
protocol {λt }t emerges due to our preparation of the lab coordinates.

9
We label all energy exchanged between the system and lab as work and all energy exchanged between the system and
heat bath as heat. Since the lab is directly coupled only to the system, the work they exchange is given by the change
in energy of the lab’s work reservoir. Similarly, since the heat bath is directly coupled only to the system, the heat
exchanged is given by the change in the heat bath’s energy.
Note that this requires choices as to what constitute the energies of the three universe subsystems. While HB , HS , and
HL define energies for the heat bath, system, and work reservoir, respectively, what of hS,L and hS,B ? If all subsystems
were macroscopic, these interaction terms would be negligible. While it may be desirable to assume that the system is
only weakly coupled to the heat bath—so that hS,B can be ignored—hS,L can be significant in many important small
systems.
And so, in general, we define the system energy to be HS plus any portions of hS,L and hS,B . Then the work reservoir
energy is HL plus the rest of hS,L , while the heat bath energy is HB plus the rest of hS,B . To make these distinctions
clear we label two types of works, each corresponding to the two extremes for allocation of hS,L between the system
and work reservoir: the inclusive work W and the exclusive work W0 [40]. Specifically:
d
d
dW
= − (HL )
= (HB + hS,B + HS + hS,L )
dt
dt
dt
dW0
d
d
= − (hS,L + HL ) = (HB + hS,B + HS ) .
dt
dt
dt
We can similarly define the inclusive heat Q and exclusive heat Q0 depending on how we allocate hS,B between the
system and heat bath:
dQ
d
d
= − (HB )
= (hS,B + HS + hS,L + HL )
dt
dt
dt
dQ0
d
d
= − (HB + hS,B ) = (HS + hS,L + HL ) .
dt
dt
dt
The inclusive work corresponds to fully including hS,L in the system energy, while the exclusive work corresponds to
excluding it. Inclusive and exclusive heat correspond similarly with respect to hS,B .
There is a key relation between the inclusive and exclusive works:
dW0
dhS,L
dW
=
+
.
dt
dt
dt

(S7)

That is, the inclusive work for an interval of time equals the sum of the exclusive work and the change in the system-lab
interaction term hS,L .
In the above expressions, calculating the rate of change of a work or heat requires the time derivative of one or more of
HL and HB . This can be problematic. Fortunately, there are alternate forms that are amenable. One can show that
the inclusive work rate is given by:
dW
dHL
=−
dt
dt
∂hS,L dλ
=
.
∂λ dt

(S8)

This is a more common definition for the work rate in small-system nonequilibrium thermodynamics. And, it allows
the work to be calculated as:
W (t, t0 ) =

Z
t

t0

dt00

dλ ∂hS,L (s, λ)
|λ=λ(t00 ) .
dt00
∂λ

(S9)

The exclusive work W0 has a corresponding form:
dW0
d(hS,L + HL )
=−
dt
dt
∂hS,L ds
=−
,
∂s dt

(S10)

10
For the case where hS,L is a scalar potential for s, this is the product of the corresponding force with velocity. This
makes the exclusive work equal to a familiar mechanics definition of work as the integral of the dot product of force
and displacement:
0

Z

W0 (t, t ) = −
t

t0

dt00

ds ∂hS,L
|s=s(t00 ) .
dt00 ∂s

In this way, we write the inclusive and exclusive work rates in terms of the rates of change of the system and
work-reservoir interaction term hS,L with respect to either the system or work reservoir coordinates.

C.

Approximating Inclusive Work Experimentally

For the flux qubit experimental system investigated here, we assume the following:
HS (s) + hS,L (s, λ) = T (s) + V (s, λ) .
That is, as far as the flux qubit and work reservoir are concerned, the only relevant energies at least partially ascribable
to the flux qubit are its kinetic energy and the potential energy with the work reservoir. hS,L must then capture the
change in the potential V due to changes in the protocol parameters. We could simply define hS,L (s, λ) = V (s, λ) so
that HS (s) = T (s). However, it is more useful to allocate the initial potential energy to HS . That is:
HS (s) = T (s) + V (s, λ0 ) and
hS,L (s, λ) = V (s, λ) − V (s, λ0 ) .
For cyclic protocols where V (·, λ0 ) = V (·, λτ ), such as in our erasure operation, hS,L (s(t), λ(t)) vanishes for all
trajectories at t = 0, τ . By Eq. (S7) we then have the useful equality W = W0 between inclusive and exclusive works
taken over the entire protocol.
Estimating W for a system trajectory is then equivalent to estimating W0 for the cyclic protocols we consider. In the
flux qubit, the form of hS,L is known and the specific protocol {λt }t∈[0,τ ] is known. Unfortunately, we lack sufficient
information about its instantaneous state s at all times, since the device’s physics precludes precise measurements of
system flux φ—the relevant part of s for determining the potential hS,L . Instead, we do have reliable measurement of
large and stable changes in the flux φ. This specifically monitors when the system moves between wells in a double-well
potential V (·, λ(t)), if the rate of transition between wells is sufficiently slow.
And so, we can use information about the flux φ to approximate the exclusive work contribution at each moment in
time. Then, adding up these contributions yields an approximation to the total exclusive work W0 over the entire
protocol and therefore of the inclusive work W over the entire protocol. Note that the protocols used here maintain
two wells at all times for the system flux φ. We develop the approximation in two steps.

1.

First-Order Approximation

We first partition the potential in flux space into three segments. Two segments constitute the wells for the flux in
which that state spends all its time except for very brief transitions between wells. Then, the third segment connects
the two wells, capturing the dynamics arising from crossing the barrier that separates them.
We require that the partitioning allows the following two approximations. First, the particle spends negligible total
duration in between the two wells. Second, the wells do not change shape over the protocol, but instead simply raise
or lower in potential at different times, if they change at all. This means that the shape of the system-lab interaction
term hS,L (·, λ(t)) at any time t is very simple in the two wells—flat.
The result is that the exclusive work over any time duration is easily calculable from the experimental data. During
times when the flux remains in a well, the exclusive work must be zero, since hS,L does not change with s. During a

11
transition, the shape of hS,L does not change due to the first approximation. Then, the exclusive work is the difference
in heights of the two wells as measured by hS,L :
∆W0trans =

Z



∂hS,L
dφ −
∂φ

≈ hS,L (w0 , λ(t)) − hS,L (w1 , λ(t)) ,

(S11)

where λ(t) is the protocol parameter setting at any time during the transition and w0 and w1 are arbitrary flux values
in the starting and ending wells, respectively.
Thus, the total inclusive work W over the protocol for a trajectory is simply the sum of the jump contributions above
for each transition.

2.

Second-Order Approximation

In point of fact, the potential wells do change shape. Fortunately, our method for calculating the inclusive work over
the protocol remains valid under weaker constraints on the protocol.
We first require the protocol to maintain two metastable regions, the informational states, at all times; each possessing a
unique local potential minimum continuously in time. We denote the flux value at the potential minima of informational
state i at time t as φti . The protocol must also evolve slowly enough so that the potential landscape changes slowly
compared to the system’s relaxation rate in each metastable region. Both of these criteria are met by our erasure
protocol.
Consider a short duration ∆t during which the potential V (·, t) changes little but long enough compared to the
relaxation rates of the informational states. Consider two cases: either the system crosses the barrier between the two
informational states during this time or it remains in one informational state.
First, suppose that the system transitions from one informational state i to the other j. Denote the system flux at the
beginning of the transition as φt and at the end as φt+∆t . By Eq. (S7), the exclusive work contribution ∆W0trans is
the difference of the inclusive work contribution and the change in system-lab interaction term ∆hS,L . The change
∆hS,L can itself be broken down into two terms, one for the difference in hS,L between the informational-state minima
and the other for the change in hS,L local to the respective minima. In other words:
∆hS,L = hS,L (φt+∆t ) − hS,L (φt )


 


= hS,L (φt+∆t ) − hS,L (φt+∆t
) + hS,L (φt+∆t
) − hS,L (φt ) − hS,L (φti ) + hS,L (φti )
j
j

 


= hS,L (φt+∆t
) − hS,L (φti ) + hS,L (φt+∆t ) − hS,L (φt+∆t
) − hS,L (φt ) − hS,L (φti )
j
j
t

t

= ∆m + ∆l ,

(S12)
(S13)

where ∆mt , Eq. (S12)’s first term, is the change in hS,L at the informational-state minima and ∆lt , Eq. (S12)’s second
term is the change in hS,L of the system with respect to the informational-state minima. Our protocol ensures that
the total number of transitions is so small and the time durations so narrow that we can ignore the total contributions
of inclusive works ∆W trans due to these transition durations. Then, we approximate the exclusive work contribution
during a transition via:
∆W0trans = −∆hS,L
= −∆mt − ∆lt .
Suppose, now, that the system remains in one informational state i during a time interval ∆t. Since the relaxation rate
is fast compared to the duration ∆t, we assume that the system visits all microstates in the informational state roughly
in proportion to the local equilibrium distribution. Then, the inclusive work contribution ∆W stay is approximately
independent of the specific system trajectory during this time and, instead, is determined by the time duration and
the informational state i. If during this time we simultaneously shift the entire potential up by a given amount, we
add an inclusive work contribution equal to the potential shift but the system trajectory is unchanged. Thus, the

12
actual inclusive work contribution is equal to an amount due to the change in the system-lab interaction term at the
informational-state minimum plus an amount due solely to the change in potential shape at the informational state
with respect to its minimum. That is:
∆W stay = ∆Ws + ∆mt ,

(S14)

where ∆Ws is the inclusive work contribution due to the change in potential shape at the informational state. Equation
(S13) applies equally well here in describing the change in system-lab interaction term. Thus, the exclusive work
contribution ∆W0stay for this time interval is:
∆W0stay = ∆W stay − ∆hS,L
t

= ∆Ws − ∆l .

(S15)
(S16)

The result is that we have exclusive work contributions for both durations when the system transitions between
informational states and when it remains in one.
To find the total exclusive work over the protocol for a given trajectory we add up the contributions. The sum of
all local hS,L changes ∆lt over all durations is the net local change in hS,L . Recall, though, that the minima of the
informational states begin and end at the same values. And so, the total local change in hS,L reduces to the absolute
change in hS,L . However, since we chose hS,L (·, 0) = hS,L (·, λ(t)) = 0, this must vanish:
X

∆lt = 0 .

t

We can now specify our final approximation: At any time t, the inclusive work contribution ∆Ws due to the change
in potential shape is independent of the informational state. This is reasonable for our erasure protocol since the
asymmetric contribution to the change in potential—the tilt—is slight. While it clearly breaks the symmetry of the
double-well potential by changing the well heights, it has less effect on the well shapes and even less in making those
shapes distinct.
Then, we can assume that the sum of ∆Ws for a trajectory is the same as that staying in one informational state the
entire time. Since the protocol is very slow and cyclic, though, a particle that stays in one informational state the
entire time must receive approximately zero inclusive work W . Given that the sum over all ∆Ws must be equal to W
for such a trajectory, it must also be negligible.
Altogether, the total exclusive work is approximately given by the sum over all transitions between informational
states of the difference in potential at the informational-state minima:
X
W0 (0, τ ) = −
∆mt .
(S17)
trans

To reiterate, since ∆hS,L = 0, this is also the total inclusive work W (0, τ ) for a trajectory over the entire protocol.

VII.

SUBSTAGE WORK DISTRIBUTIONS COMMENTARY

Here, we briefly interpret several features of the substage work distributions observed in Fig. 1(Outer left plots).
The distributions for barrier dropping and tilting are narrow, symmetric peaks; see Fig. 1 (Outer left plots). Barrier
raising also has a rather narrow peak, composed primarily of trajectories always in the R state, but also exhibits a
bulge toward positive work; see Fig. 1 (Top right). Note that the L state is created mid-way through barrier raising,
allowing for trajectories that spend some time in either informational state, but disallowing trajectories that spend all
time in the L state. The former induce the positive work bulge toward less negative works, which while notable will
not be further explored here.
The substage work distributions for untilting presents the most striking picture; see Fig. 1 (Bottom right). Always-R
trajectories induce a large positive work peak (red), always-L trajectories induce a large negative work peak (orange),
and all other trajectories induce a ramp between them (blue).

13
These features can be directly interpreted by following the locations of the potential minima over time and noting
how the shifting potential adds or removes energy from a particle. During barrier dropping, to take one example, the
protocol raises both minima by over 7 kB T , resulting in a narrow, peaked work distribution with a mean near 7 kB T .
Most interesting is the untilt substage. Since most particles start and then stay in the R state for this substage, a
large positive work is probable, due to the rising R-state well. However, it is also possible for the system to start in
and then get stuck in the L-state well, resulting in a large negative work. The final possibility is transitioning between
states during untilting, resulting in an intermediate range of less-likely work values. For trajectories that do transition
between states during untilting, it is more likely to spend more time in the R state, since it is energetically favored,
resulting in the rising probability with increasing work in their work distribution—giving rise to the log-linear ramp in
the work distribution.
Note that there are small peaks on each end of this third class’ distributions that require a more nuanced explanation.
When a particle crosses a barrier—due to random thermal excitation—the surplus energy may quickly send the particle
back to the previous well before it can be dissipated. Such particles then spend almost all of the substage in this first
well, generating a work value accordingly. Statistics of the ramp proper are due to particles that have time to locally
equilibrate before crossing any barriers.
Follow-on work develops the theory underlying this detailed mechanistic analysis and analyzes similar behavior in all
metastable-quasistatic processes.

VIII.

FLUX QUBIT DEVICE, CALIBRATION, AND MEASUREMENT

The benefits of the flux qubit device are several-fold. First, their physics provide a genuine two-degree of freedom
dynamics, while other comparable experiments on Maxwellian demons and bit erasure are very high dimensional, only
indirectly providing an effectively few-degree of freedom dynamics [19, 21, 41]. Second, they operate at very high
frequency and so one readily captures the substantial amounts of data required to accurately estimate rare-fluctuation
statistics. Third, they leverage recent advances in manufacturing technology led by efforts in quantum computing.
Fourth, being constructed via modern integrated circuit technology they form the basis of a technology that will scale
to large, multicomponent circuit devices for more sophisticated thermodynamic computing. And, finally, in the near
future flux qubits will facilitate experiments that probe the thermodynamics of the transition to quantum information
processing.
At the microscopic level, a fraction of the electrons in a superconducting metal form bosonic Cooper pairs—a
quantum-coherent condensate. For designing superconducting electronic circuits, though, one can forgo the microscopic
description and work with higher-level phenomena, such as flux quantization and the Josephson relations for weak
links. Importantly, the circuit-level degrees of freedom are not coarse-grained quantities, but display a full range of
quantum behavior, including quantized excitations, coherent superpositions, and entangled states in such circuits. For
our purposes here, however, we run the device so that it exhibits only classical stochastic dynamics, reserving quantum
information thermodynamic explorations for the future.
This section lays out the basic physics of the flux qubit device and details of the experimental implementation.

A.

Flux qubit physics

Our experimental information processor is a special type of superconducting quantum interference device (SQUID)
with two degrees of freedom—a gradiometric flux qubit or the variable-Ic rf SQUID introduced by Ref. [42]. Notably,
the energies associated with the motion perpendicular to and along the escape direction differ substantially by about
a factor of 12. Practically, this asymmetry reduces the two-dimensional potential to one dimension. The net result
is a device with an effective double-well potential with barriers as low as ∆U ∼ kB T that operates at frequencies in
the GHz range. The potential shape is controlled by fluxes that are readily controlled by currents. SQUID device
parameters, used to determine the potential shape and energy scales, were all independently determined.
The variable-Ic rf SQUID replaces the single Josephson junction in a standard rf SQUID with a symmetric dc SQUID
with small inductance βdc = 2π`Ic0 /Φ0  1, where 2` is the loop inductance, Ic0 = ic1 + Ic2 is the sum of critical

14
currents of the two junctions, and Φ0 is the flux quantum h/2e. This architecture gives a device whose parameters can be
accurately measured and that can be selected to exhibit a range of phenomena including thermal activation, macroscopic
quantum tunneling, incoherent relaxation, photon-induced transitions, and macroscopic quantum coherence. It also
allows us to perform, as we demonstrate, nanoscale thermodynamic computing.
Its macroscopic dynamical variables are the magnetic flux Φ through the rf SQUID loop and Φdc through the dc
SQUID loop. Based on the resistively-capacitively-shunted junction model of Josephson junctions, in the classical limit
the variable-Ic rf SQUID’s deterministic equations of motion are [42]:
2C Φ̈ +

Φ̇
∂U (Φ, Φdc )
=−
and
R/2
∂Φ

Φ̇
C
∂U (Φ, Φdc )
Φ̈dc +
=−
.
2
2R
∂Φdc

(S18)

In units of Φ0 /2π, the 2D potential for the variable-Ic rf SQUID is U (φ, φdc ) = U0 f (φ, φdc ) with:
f (φ, φdc ) = 12 (φ − φx )2 + γ2 (φdc − φxdc )2 − β0 cos φ2dc cos φ + δβ sin φ2dc sin φ ,

(S19)

where U0 = Φ20 /(4π 2 L). Here, γ = L/(2`) is the ratio of rf and dc SQUID inductances; φx (φxdc ) is the external flux
applied to the rf (dc) SQUID loop; φ (φdc ) is the flux enclosed in the rf (dc) SQUID loop; β0 = 2πLIc0 /Φ0 ; and
δβ = 2πL(Ic2 − Ic1 )/Φ0 .
For large-amplitude tuning of the external controls, the system response to φx (φxdc ) is 2π (4π) periodic. We make
use of the global features to accurately determine the coefficients of the potential.
In the experiment, cross-coupling between the barrier and tilt controls was canceled by an affine transformation
(φx , φxdc ) → (φx + αφxdc , φxdc ), with the coefficient α chosen such that the equilibrium population of the left and right
wells was unaffected to first order by the barrier control φxdc .
Operating the magnetometer generates wide-band local electromagnetic interference that can affect the dynamics of
the flux qubit. A careful study of the back-action indicates that low-amplitude operation of the magnetometer can
induce transitions in a manner that corresponds to a shift in the effective tilt and flux controls. Importantly, the
effective temperature under magnetometer operations was not elevated from 500 mK.
The dynamical variable φ describes the in-phase motion of the two junctions that results in a current circulating in the
rf SQUID loop. The dynamical variable φdc describes the out-of-phase motion, resulting in a current circulating in the
dc SQUID loop. The shape of the effective potential is completely determined by the dimensionless function f (φ, φdc )
and the energy scale of the potential is determined by U0 . With suitable device parameters and applied fluxes (φx
and φxdc ) one obtains a double-well potential. The barrier height ∆U separating the two wells is readily adjusted by
varying φxdc . The effective potential is plotted in Fig. 3(B) with parameters: β0 = 6.2, γ = 12 and δb = 0.2.

B.

Experimental implementation

The junctions were 1 × 1µm2 Nb/Al2 O3 /Nb tunnel junctions of very low subgap leakage, typically having a quality
factor of Vm ≈ 70 mV at 4.2 K.
We followed a standard procedure (see, e.g., Ref. [42]) for calibrating the flux qubit parameters. An outline of the
steps is given below. A complete description of the measurements is presented elsewhere.
First, by executing wide-range sweeps of the coil currents Itilt and Ibarrier , parameter values corresponding to singlevalued and bistable potential landscapes are recorded. A linear transformation from Itilt and Ibarrier to (φx , φxdc ) is
established by matching the experimental periodicity with the theoretical one (2π, 4π). Linear cross-talk from Ibarrier
to Itilt is calibrated by orthogonalizing the global response. Cross-talk from Itilt to Ibarrier can be assumed to be small
due to the symmetry of the on-chip flux lines and is taken to be zero.
The parameter values β0 = 6.2, γ = 12 and δb = 0.2 are determined by equating the observed extent of hysteresis
at φxdc = 0 and the differential flux response d hφi /dφx at φxdc = 2π to theoretical predictions. The prefactor
U0 = 56.3 K is determined by equating the observed escape energy for inter-well transitions at high temperatures

15
√
with kB T . The plasma frequency ωp = 1/ LC = 2π × 13.7 GHz is determined from the observed low-temperature
cross-over temperature Tc r = 103 mK to macroscopic quantum tunneling (MQT) dominated dynamics. We obtain
an upper bound Q = ωp RC < 130 from the coupling to the passive shunt resistor of the magnetometer. Parameter
calibration measurements are performed in such a way that the effect of magnetometer back-action is nulled through
pulsing of the readout or otherwise minimized. The effective temperature under continuous magnetometer operation
was determined by repeating the measurement for escape energy for interwell transitions and comparing the result to
that obtained under pulsed magnetometer operation.

