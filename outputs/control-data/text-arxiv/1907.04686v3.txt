arXiv:1907.04686v3 [math.AG] 28 Feb 2021

INSEPARABLE MAPS ON Wn -VALUED LOCAL
COHOMOLOGY GROUPS OF NON-TAUT RATIONAL
DOUBLE POINT SINGULARITIES AND THE HEIGHT OF
K3 SURFACES
YUYA MATSUMOTO
Abstract. We consider rational double point singularities (RDPs) that
are non-taut, which means that the isomorphism class is not uniquely
determined from the dual graph of the minimal resolution. Such RDPs
exist in characteristic 2, 3, 5. We compute the actions of Frobenius, and
other inseparable morphisms, on Wn -valued local cohomology groups of
RDPs. Then we consider RDP K3 surfaces admitting non-taut RDPs.
We show that the height of the K3 surface, which is also defined in terms
of the Frobenius action on Wn -valued cohomology groups, is related to
the isomorphism class of the RDP.

1. Introduction
Rational double point singularities (RDPs for short) are the simplest singularities in dimension 2. The fundamental invariant of an RDP is the dual
graph of the exceptional divisor of the minimal resolution, which is a Dynkin
diagram. In most cases the dual graph determines the isomorphism class of
the singularity (in a fixed characteristic p ≥ 0). Such RDPs are called taut.
However in some special cases there are more than one isomorphism classes,
in which cases the RDPs are called non-taut.
To describe them we define, for each pair of a characteristic p ≥ 0 and
a Dynkin diagram S (which is AN , DN , or EN ), a non-negative integer
rmax = rmax (S) = rmax (p, S) as follows:


⌊N/2⌋ − 1 if (p, S) = (2, DN ),





1
if (p, S) = (2, E6 ),




3
if (p, S) = (2, E7 ),



4
if (p, S) = (2, E8 ),
rmax (p, S) =

1
if (p, S) = (3, E6 ), (3, E7 ),





2
if (p, S) = (3, E8 ),




1
if
(p, S) = (5, E8 ),



0
otherwise.

Theorem 1.1 (Artin [Art77]). Let p and S as above. Then there exist
exactly rmax + 1 isomorphism classes of RDPs in characteristic p whose

Date: 2021/02/28.
2010 Mathematics Subject Classification. 14J28 (Primary) 14L15, 14J17, 14B15, 13A35
(Secondary).
This work was supported by JSPS KAKENHI Grant Number 16K17560 and 20K14296.
1

2

YUYA MATSUMOTO

dual graph is a Dynkin diagram of type S. Explicit equations are given and,
when rmax > 0, the isomorphism classes are distinguished by the symbols S r
(0 ≤ r ≤ rmax ), see Table 1 in Section 4.

The isomorphism classes S r are ordered in the way that the coindex r is
lower semi-continuous in families of RDPs with the same dual graph S.
In this paper we consider Wn -valued local cohomology groups Hm2 A (Wn (A)),
and their I-torsion parts Hm2 A (Wn (A))[I] for ideals I ⊂ A, of (mainly nontaut) RDPs A for some n. We compute Frobenius actions, and more generally the pullback maps by purely inseparable morphisms Spec B → Spec A.
The behaviors of the maps depend heavily on the isomorphism classes of the
non-taut RDP. See Section 4 for precise results.
Suppose an RDP K3 surface (a proper surface with only RDP singularities
whose minimal resolution is a K3 surface in the usual sense) admits a nontaut RDP. From the local behaviors of the Frobenius maps studied above,
we can deduce a relation between the isomorphism class of the non-taut
RDP and the height of the K3 surface. Here the height is an invariant of K3
surfaces in positive characteristic which takes values in {1, 2, . . . , 10} ∪ {∞}
and is characterized by the Frobenius actions on Wn -valued cohomology
groups (see Theorem 5.3).
Theorem 1.2 (see Theorem 6.4 for a detailed statement). For each Dynkin
diagram S and characteristic p (with rmax (p, S) > 0), we give a subsequence
(r1 , r2 , . . . , rl ) of (rmax (p, S), . . . , 2, 1) with the following properties. Let Y
be an RDP K3 surface in characteristic p that admits an RDP of type S r .
• If r > 0, then ht(Y ) ≤ l and r = rht(Y ) .
• If r = 0, then ht(Y ) > l.
In short, ht(Y ) determines r, and if r > 0 then r determines ht(Y ).
If (p, S) is not (2, DN ) (N ≥ 8) nor (2, E8 ), then the subsequence is the
entire sequence (rmax (p, S), . . . , 2, 1).
In Section 7, we determine which non-taut RDPs are realizable on RDP
K3 surfaces (Theorem 7.1).
Now suppose π : X → Y is a G-quotient morphism between RDP K3
surfaces, where G = µp or G = αp . Then the “dual” map π ′ : Y (1/p) → X
is also a G′ -quotient with G′ = µp or G′ = αp . Again, we can use the local
behavior of the pullback maps by π and π ′ to relate the singularities of X
and Y to the height of X and Y .
Theorem 1.3 (see Theorem 6.7 for a detailed statement). Let π : X → Y
be as above. Then we have ht(X) = ht(Y ) =: h, we determine h in terms
of Sing(Y ) and Sing(X), and h is always finite.
As a consequence, we prove (Corollary 6.10) that G-quotient of an RDP
K3 surface X in characteristic p, with G = µp or G = αp , is an RDP K3
surface if and only if X is of finite height.
This paper is organized as follows. In Section 2 we recall the definition
and basic properties of the ring Wn (A) of Witt vectors. In Section 3 we
introduce morphisms between (Wn -valued) local cohomology groups and
interpret them in terms of Cech cohomology groups. In Section 4 we carry

NON-TAUT RDPS AND THE HEIGHT OF K3 SURFACES

3

out explicit computations for inseparable morphisms between RDPs. In
Section 5 we recall the definition and basic properties of the height of K3
surfaces. The main results, connecting the height of K3 surfaces and the
maps on Wn -valued local cohomology groups, will be proved in Section 6. In
Sections 7 and 8 we discuss which RDPs are realizable on RDP K3 surfaces,
and give examples for all possible non-taut RDPs.
2. Rings of truncated (p-typical) Witt vectors
Let p be a prime and A an Fp -algebra. The ring W (A) of p-typical Witt
vectors on A is the set AN equipped with the ring structure satisfying, for
each polynomial P ∈ Z[x, y],
P ((a0 , a1 , . . . ), (b0 , b1 , . . . )) = (P0 (a0 , b0 ), P1 (a0 , b0 , a1 , b1 ), . . . ),

where Pi ∈ Z[x0 , . . . , xi−1 , y0 , . . . , yi−1 ] is the unique collection of polynomials satisfying, for each N ∈ N,

wN (P0 (. . . ), P1 (. . . ), . . . , PN (. . . )) = P (wN (a0 , a1 , . . . , aN ), wN (b0 , b1 , . . . , bN )),
P
N−i
i p
where wN (t0 , t1 , . . . , tN ) := N
is the so-called N -th ghost compoi=0 p ti
nent.
For example, we clearly have (a0 )+(b0 ) = (a0 +b0 ) and (a0 )·(b0 ) = (a0 b0 )
on W1 (A) ∼
= A, and it follows from the equalities
(a0 + b0 )p − ap0 − bp0
),
p
(ap0 + pa1 ) · (bp0 + pb1 ) = (a0 b0 )p + p(a1 bp0 + ap0 b1 + pa1 b1 )

(ap0 + pa1 ) + (bp0 + pb1 ) = (a0 + b0 )p + p(a1 + b1 −
that

(a0 + b0 )p − ap0 − bp0
),
p
(a0 , a1 ) · (b0 , b1 ) = (a0 b0 , a1 bp0 + ap0 b1 + pa1 b1 )

(a0 , a1 ) + (b0 , b1 ) = (a0 + b0 , a1 + b1 −

on W2 (A).
It follows from [Haz12, 17.1.18] that, for P (x, y) = x + y, the i-th component Pi of P ((a0 , a1 , . . . ), (b0 , b1 , . . . )) is a homogeneous polynomial of
a0 , a1 , . . . , b0 , b1 , . . . of degree pi if we declare ai and bi to be homogeneous
of degree pi .
W is functorial: any homomorphism f : A → B of Fp -algebras induces a
morphism f : W (A) → W (B) of rings by f (a0 , a1 , . . . ) = (f (a0 ), f (a1 ), . . . )
that is compatible with V and R defined below. An example is the Frobenius
morphism F : W (A) → W (A) defined as F (a0 , a1 , . . . ) = (ap0 , ap1 , . . . ).
The shift morphism, or Verschiebung, V on W (A) is defined as V (a0 , a1 , . . . ) =
(0, a0 , a1 , . . . ).
The ring of Witt vectors of length n is the quotient Wn (A) = W (A)/V n W (A),
hence in Wn (A) only the first n components (a0 , a1 , . . . , an−1 ) are considered.
The Verschiebung induces V : Wn (A) → Wn+1 (A). The restriction morphism R : Wn (A) → Wn−1 (A) is defined as R(a0 , . . . , an−1 ) = (a0 , . . . , an−2 )
and is a ring homomorphism. We have an exact sequence
′

V n−n

′

Rn

0 → Wn′ (A) −−−−→ Wn (A) −−→ Wn−n′ (A) → 0

for each 0 ≤ n′ ≤ n.

4

YUYA MATSUMOTO

We use the following equalities in Section 4.
Lemma 2.1. If x ∈ Wn (A) and y ∈ Wn+m (A), then V m (x) · y = V m (x ·
F m (Rm (y)).
Lemma 2.2. Let A be a Fp -algebra.
(1) In Wn (A) with p = 2, write (t1 + t2 , 0, 0, . . . ) − (t2 , 0, 0, . . . ) =
(S0 (t1 , t2 ), S1 (t1 , t2 ), . . . ) with polynomials Si ∈ F2 [t1 , t2 ]. Then Si
i
is homogeneous of degree 2i and we have Si ≡ t1 t22 −1 (mod t21 ).
(2) In W3 (A) with p = 2, we have

   

a+c
b
a+b+c

 − bc = 
.
0
ab
3
3
2
2
2
0
0
(a + c) b + (a + c)b + (a + 3ac + c )b
(3) In W4 (A) with p = 2, we have

     

0
b
a
a+b

 0  0 0 
ab

− − = 

2
2

 0  0 0 
ab(a + ab + b )
0
ab(a6 + a5 b + a3 b3 + ab5 + b6 )
0
0
and

(c0 , c1 , c2 + d2 , c3 ) − (0, 0, d2 , 0) = (c0 , c1 , c2 , c3 + c2 d2 ).
(4) In W2 (A) with p = 3, we have
(a + b, 0) − (a, 0) − (b, 0) = (0, ab(a + b)).
(5) In W2 (A) with p = 5, we have
(a + b, 0) − (a, 0) − (b, 0) = (0, ab(a + b)(a2 + ab + b2 )).
Proof. Straightforward.



The closed immersion R∗ : Spec Wn−1 (A) → Spec Wn (A) is a homeomorphism if n ≥ 2. For an Fp -scheme Z and n ≥ 1, we define Wn (Z) to be the
scheme whose underlying topological space is Z and whose structure sheaf
is Wn (OZ ).
Lemma 2.3. If Z is a scheme projective (resp. quasi-projective) over an
algebraically closed field k, then Wn (Z) is projective (resp. quasi-projective)
over Wn (k).
Proof. Since Wn (−) preserves open immersions and closed immersions, it
suffices to show that Wn (PN ) is projective. We will show that Wn (k[x0 , . . . , xN ])
is a finitely generated Wn (k)-algebra. Indeed, it is generated by the elements
(xi , 0, . . . , 0) with 0 ≤ i ≤ N and the elements V j (xi00 . . . xiNN , 0, . . . , 0) with
0 < j < n and 0 ≤ ik < pj .

Lemma 2.4. Suppose (A, mA ) is a Cohen–Macaulay local ring. Then Wn (A)
is also Cohen–Macaulay. More precisely, the Teichmüller lift of a regular
sequence of A is a regular sequence of Wn (A).
In particular, ExtiWn (A) (M ′ , Wn (A)) = 0 if Supp M ′ ⊂ {mA } and i <
dim A.

NON-TAUT RDPS AND THE HEIGHT OF K3 SURFACES

5

Proof. The former assertion follows from [Bor11, Propositions 16.18, 16.19].
(One can also show more generally that b1 , . . . , bN in Wn (A) is a regular
sequence if Rn−1 (b1 ), . . . , Rn−1 (bN ) is a regular sequence in A.)
The latter assertion is a consequence of being Cohen–Macaulay.

1
], where [x] is the TeAlso note the equality Wn (A[ x1 ]) = Wn (A)[ [x]
ichmüller lift.

3. Wn -valued local cohomology groups
Suppose (A, mA ) is a Noetherian Cohen–Macaulay local k-algebra of dimension d. By [Har67, Theorems 2.8 and 3.8], we have isomorphisms
limI ExtiA (A/I, A) ∼
= Hmi A (A), where the limit is taken over mA -primary
−→
ideals (i.e. Supp(A/I) ⊂ {mA }), and we have Hmi A (A) = 0 for i < d and
Hmd A (A)

∼
= Coker

d
M
i=1


A[(x1 . . . x̂i . . . xd )−1 ] → A[(x1 . . . xd )−1 ]

for any regular sequence x1 , . . . , xd in mA .

Lemma 3.1. Let (A, mA ) be as above. Let n ≥ 1 be an integer and I ⊂ A
an mA -primary ideal. Let J := (Rn−1 )−1 (I) ⊂ Wn (A), so that Wn (A)/J ∼
=
A/I. Then the morphism
h = hI : ExtdWn (A) (A/I, Wn (A)) → Hmd Wn (A) (Wn (A))
is injective, and its image is precisely the submodule Hmd Wn (A) (Wn (A))[J] of
the classes annihilated by J. Moreover this morphism is compatible with the
inclusion of mA -primary ideals I ′ ⊂ I and with V .
Proof. Compatibility with V is clear.
By replacing A with Wn (A), we may assume n = 1 (hence J = I).
Note that ExtdA (−, A) is a contravariant left exact functor (on A-modules
of finite length). Hence, for an inclusion I ′ ⊂ I, ExtdA (A/I, A) → ExtdA (A/I ′ , A)
is injective, and this implies that hI is injective.
Suppose an element of Hmd A (A) has annihilator I and is of the form h(e)
for e ∈ ExtdA (A/I ′ , A). Then I ′ ⊂ I. We want to show that e comes
from ExtdA (A/I, A). Take a sequence b1 , . . . , bLN generating I. Applying
LN
i bi
′
′
ExtdA (−, A) to the exact sequence
i=1 A/I −−−→ A/I → A/I → 0, we
obtain an exact sequence
L
M
i bi
d
d
′
→
ExtdA (A/I ′ , A).
0 → ExtA (A/I, A) → ExtA (A/I , A) −−−
i

Since bi e = 0, it follows that e comes from

ExtdA (A/I, A).



Convention 3.2. For simplicity, we will write Hmd A (Wn (A))[I] instead of
Hmd Wn (A) (Wn (A))[(Rn−1 )−1 (I)].
We have morphisms
V : Hmd A (Wn (A)) → Hmd A (Wn+1 (A)),

R : Hmd A (Wn (A)) → Hmd A (Wn−1 (A)).

6

YUYA MATSUMOTO

Suppose B is another Noetherian Cohen–Macaulay local k-algebra of dimension d and f : A → B is a local morphism (an example is the Frobenius
morphism F : A → A). Then we have morphisms
f : Hmd A (Wn (A)) → Hmd B (Wn (B)),

Lemma 3.3. The morphisms f , V , and R induce morphisms
f : Hmd A (Wn (A))[I] → Hmd B (Wn (B))[IB],

V : Hmd A (Wn (A))[I] → Hmd A (Wn+1 (A))[I],
R : Hmd A (Wn (A))[I] → Hmd A (Wn−1 (A))[I].

Proof. Straightforward.



For example, the Frobenius morphism induces
F : Hmd A (Wn (A))[I] → Hmd A (Wn (A))[I (p) ].
Lemma 3.4. Let A be as above, and x1 , . . . , xd a regular sequence. Then
the identification
d

M
Wn (A[(x1 . . . x̂i . . . xd )−1 ]) → Wn (A[(x1 . . . xd )−1 ])
Hmd A (Wn (A)) ∼
= Coker
i=1

is compatible with the morphisms V and R.
If f : A → B is as above, and f (x1 ), . . . , f (xd ) is a regular sequence of B,
then the same assertion holds for f .
Proof. Clear.



4. Computing morphisms on Wn -valued local cohomology
groups on RDPs
4.1. Equations of RDPs.
Remark 4.1. For each non-taut RDP A, we often work under an isomorphism A ∼
= k[[x, y, z]]/(f ), where f is the polynomial as in Table 1. In the
0 we use two different equations. All equations are taken from
case of DN
0 .
[Art77], except for the equation with the term zxy m−r in the case of DN
Setting 4.2. Suppose a non-taut RDP A and an integer j ≥ 1 satisfy one
of the following, and define an ideal Ij ⊂ A accordingly.
• j = 1, and I1 = mA ⊂ A is the maximal ideal.
r in characteristic 2, and
• 1 ≤ j ≤ ⌊N/2⌋ − 1, A is an RDP of type DN
Ij ⊂ A consists of the elements whose vanishing order at the 2j-th
component of the exceptional divisor of the minimal resolution of A
is at least 2j.
• j = 2, A is an RDP of type E8r in characteristic 2, and Ij ⊂ A consists
of the elements whose vanishing order at the 4-th component of the
exceptional divisor of the minimal resolution of A is at least 8.
Here, in the case of DN or E8 , the components are ordered in a way that
the 1-st component is the end of the longest branch of the Dynkin diagram,
and the i-th component (i ≤ N − 2 or i ≤ 5 respectively) is the unique
component of distance i − 1 from the 1-st component. (In the case of D4

NON-TAUT RDPS AND THE HEIGHT OF K3 SURFACES

7

Table 1. Equations of non-taut RDPs
p
2
2
2
2
2
2
2
3
3
3
5

equation
r
D2m
0
D2m
r
D2m+1
0
D2m+1
E6r
E7r
E8r
E6r
E7r
E8r
E8r

0 ≤ r ≤ m − 1 z 2 + x2 y + xy m + zxy m−r
z 2 + x2 y + xy m
0 ≤ r ≤ m − 1 z 2 + x2 y + zy m + zxy m−r
z 2 + x2 y + zy m
r = 1, 0
z 2 + x3 + y 2 z + bxyz
b = 1, 0
2
3
3
r = 3, 2, 1, 0
z + x + xy + β
β = zxy, zy 3 , zx2 y, 0
2
3
5
r = 4, 3, 2, 1, 0 z + x + y + β
β = zxy, zy 3 , zxy 2 , zxy 3 , 0
r = 1, 0
r = 1, 0
r = 2, 1, 0

z 2 + x3 + y 4 + bx2 y 2
z 2 + x3 + xy 3 + bx2 y 2
z 2 + x3 + y 5 + λx2 y 2

b = 1, 0
b = 1, 0
λ = 1, y, 0

r = 1, 0

z 2 + x3 + y 5 + (b/2)xy 4

b = 2, 0

the longest branch is not unique, but still the 2j-th component, j = 1, is
well-defined.)
Lemma 4.3. Suppose A, j, Ij are as above. Fix an isomorphism A ∼
=
k[[x, y, z]]/(f ) with f is as in Table 1. Then,
(1) We have Ij = (x, y j , z),
(2) The class [ε] of ε := x−1 y −j z is a generator of the A-module Hm2 A (A)[Ij ]
with Ann([ε]) = Ij .
Proof. (1) Straightforward.
(2) Since A is Gorenstein, we have dimk Hm2 A (A)[Ij ] = dimk Ext2 (A/Ij , A) =
dimk A/Ij = j. Hence it suffices to check that, in Coker(A[x−1 ] ⊕ A[y −1 ] →
A[(xy)−1 ]), the classes [xε], [y j ε], [zε] are trivial and [y j−1 ε] is nontrivial.
Straightforward.

Lemma 4.4. Let A = k[[x, y, z]]/(f ) be a local ring such that x, y is a regular
sequence, and let j ≥ 1 an integer. Let ε = x−1 y −j z ∈ A[(xy)−1 ], I =
(x, y j , z) ⊂ A, and e = [(ε, 0, . . . , 0)] ∈ Hm2 A (Wn (A)). To show that e belongs
to Hm2 A (Wn (A))[I], it suffices to show that F (R(e)) = 0 (in Hm2 A (Wn−1 (A)))
and ze = 0.
Proof. It suffices to check (a0 , 0, . . . , 0) ∈ Ann(e) for a0 ∈ {x, y j , z} and
V (b) ∈ Ann(e) for b ∈ Wn−1 (A). The former assertion is obvious for a0 =
x, y j and is assumed for a0 = z. For the latter assertion we have V (b) · e =
V (b · F (R(e))) = 0 since F (R(e)) = 0.

4.2. Frobenius morphisms. Let A be a non-taut RDP. In this section we
compute the Frobenius maps on the local cohomology groups Hm2 A (Wnj (A))[Ij ],
where Ij ⊂ A are the mA -primary ideals introduced in Setting 4.2.
r in characteristic p = 2.
Proposition 4.5. Let A be an RDP of type DN
Let j ≥ 1 and n ≥ 1 be integers and assume
• ⌊N/2⌋ ≥ C1 (n, j) := 2j + (2n−1 − 1)(2j − 1) = 2n−1 (2j − 1) + 1, and
• either n = 1 or ⌊N/2⌋ − r ≥ C1 (n − 1, j).

8

YUYA MATSUMOTO

Let Ij be the ideal defined as in Setting 4.2. Then there is an element
e ∈ Hm2 A (Wn (A))[Ij ] satisfying the following two conditions:
• its restriction Rn−1 (e) ∈ Hm2 A (A)[Ij ] is a generator, and
• its image F (e) by the Frobenius map
F : Hm2 A (Wn (A))[Ij ] → Hm2 A (Wn (A))[Ij (p) ]
satisfies, letting a := ⌊N/2⌋ − r − C1 (n, j),
(
0
(if a ≥ 0),
F (e) =
n−1
′
V
(e ) (if a < 0)
for some generator e′ ∈ Hm2 A (A)[I−a ].
We will use this proposition (in the proof of Theorem 6.4) only in the
following cases.
• ⌊N/2⌋ − r > 2n−1 and j = 1. In this case a ≥ 0.
• ⌊N/2⌋ − r = 2n−1 (2j − 1) and r > 0. In this case a = −1.
Proof. Let ε = x−1 y −j z (with respect to the equation specified below),
and consider the class e = [(ε, 0, . . . , 0)] ∈ Hm2 A (Wn (A)). To show e ∈
Hm2 A (Wn (A))[Ij ], it suffices (by Lemma 4.4) to check that ze = 0 and
F (R(e)) = 0, and both follow from the computation of F (e) below (using
ze = xy j F (e)).
Let m = ⌊N/2⌋. We may assume A ∼
= k[[x, y, z]]/(f ),
(
r ),
z 2 + x2 y + xy m + zxy m−r (D2m
f=
r
),
z 2 + x2 y + zy m + zxy m−r (D2m+1
and then we have Ij = (x, y j , z). Let
1
z
, η := 2j−1 ,
j
xy
y
m−2j
y
z
r
r
(D2m
), ξ :=
(D2m+1
),
x2

λ := y m−r−j , ε :=
ξ :=

y m−2j
x

in A[(xy)−1 ]. Then we have ε2 + η + ξ + λε = 0.
As in Lemma 2.2(1), define polynomials Si ∈ k[t1 , t2 ] by
(t1 + t2 , 0, . . . ) − (t2 , 0, . . . ) = (S0 (t1 , t2 ), S1 (t1 , t2 ), . . . ),
and let Qi := Si (ξ + λε, η) (0 ≤ i ≤ n − 1). We claim that
(
0
(if i < n − 1),
Qi ≡
(mod A[x−1 ]).
n−1 −1
2
η
λε (if i = n − 1)
By Lemma 2.2(1), Qi is a linear combination of monomials ξ i1 (λε)i2 η i3 with
i1 + i2 + i3 = 2i and (i1 , i2 , i3 ) 6= (0, 0, 2i ). Let c(i1 , i2 , i3 ) := (m − 2j)i1 +
(m − r − 2j)i2 + (−(2j − 1))i3 , so that ξ i1 (λε)i2 η i3 ∈ y c(i1 ,i2 ,i3 ) A[x−1 ]. We
shall show that c(i1 , i2 , i3 ) ≥ 0 for all such (i1 , i2 , i3 ) except (0, 1, 2n−1 − 1).

NON-TAUT RDPS AND THE HEIGHT OF K3 SURFACES

9

• If i1 ≥ 1, then

c(i1 , i2 , i3 ) ≥ c(1, 0, 2i − 1)

= m − 2j − (2i − 1)(2j − 1)

= m − C1 (i + 1, j) ≥ m − C1 (n, j),

which is ≥ 0 by assumption.
• If i2 ≥ 1 and i < n − 1 (hence n ≥ 2), then
c(i1 , i2 , i3 ) ≥ c(0, 1, 2i − 1)

= m − r − j − (2i − 1)(2j − 1) − j

= m − r − C1 (i + 1, j) ≥ m − r − C1 (n − 1, j),

which is ≥ 0 by assumption.
• If i2 ≥ 2 and i = n − 1 ≥ 1 (hence n ≥ 2), then

c(i1 , i2 , i3 ) ≥ c(0, 2, 2n−1 − 2) = 2c(0, 1, 2n−2 − 1),

which is ≥ 0 by the previous case.
n−1 −1

For the remaining term η 2
1 by Lemma 2.2(1), we have
n−1 −1

η2

λε, which appears in Qn−1 with coefficient

n−1 −1)(2j−1)

λ = y m−r−j−(2

= y m−r−C1 (n,j)+j = y a+j ,

n−1 −1

where a as in the statement. Hence η 2

λε = x−1 y a z. Therefore we have

F (ε, 0, . . . , 0) = (ε2 , 0, . . . , 0)
= (ξ + λε + η, 0, . . . , 0)
≡ (ξ + λε + η, 0, . . . , 0) − (η, 0, . . . , 0)

(mod Wn (A[y −1 ]))

= (Q0 , . . . , Qn−1 )

≡ (0, . . . , 0, x−1 y a z)

(mod Wn (A[x−1 ])).

If a ≥ 0 then x−1 y a z ∈ A[x−1 ], and if a < 0 then x−1 y a z is a generator of

Hm2 A (A)[I−a ].
Proposition 4.6. Let A be an RDP of type E81 (resp. E80 ) in characteristic
/ Hm2 A (A)[mA ],
p = 2. Then there exists an element e ∈ Hm2 A (A)[I2 ], e ∈
where I2 is defined as in Setting 4.2, such that F (e) is a generator of
Hm2 A (A)[mA ] (resp. F (e) = 0).
Proof. We may assume A = k[[x, y, z]]/(z 2 + x3 + y 5 + λzxy 3 ), where λ = 1
(resp. λ = 0). Then I2 = (x, y 2 , z). Let e = [ε] with ε := x−1 y −2 z. Since
ε2 = y −4 x+x−2 y +λyε ≡ λyε (mod A[x−1 ]+A[y −1 ]), we have F (e) = λ[yε],

which is a generator of Hm2 A (A)[mA ] (resp. 0).
Proposition 4.7. Suppose a prime p, a Dynkin diagram S, and a positive
integer n satisfy one of the following.
(1) p = 2, S = E7 , E8 , n ≤ 3.
(2) p = 3, S = E8 , n ≤ 2.
(3) p = 2, S = E6 , n = 1.
(4) p = 3, S = E6 , E7 , n = 1.
(5) p = 5, S = E8 , n = 1.

10

YUYA MATSUMOTO

Let A be an RDP in characteristic p of type S r , 0 ≤ r ≤ rmax (p, S) + 1 − n.
Then there is an element e ∈ Hm2 A (Wn (A))[mA ] whose restriction Rn−1 (e)
is a generator of Hm2 A (A)[mA ] and satisfying
(
0
(if r < rmax (p, S) + 1 − n),
F (e) =
n−1
′
V
(e ) (if r = rmax (p, S) + 1 − n)
for some generator e′ ∈ Hm2 A (A)[mA ].
Proof. In each case we consider the class e = [(ε, 0, . . . , 0)], ε = x−1 y −1 z.
To show e ∈ Hm2 A (Wn (A))[mA ], it suffices (by Lemma 4.4) to check that
ze = 0 and F (R(e)) = 0. The former is clear if n = 1 (since z 2 ∈ (x, y)),
easy if p = 2 using the computation of F (e) (since ze = xyF (e)), and
straightforward in the remaining case (p = 3, S = E8 , n = 2). The latter
follows from the computation of F (e).
Case (1): E7r (resp. E8r ) in characteristic 2. We may assume A = k[[x, y, z]]/(f ),
f = z 2 + x3 + xy 3 + β (resp. f = z 2 + x3 + y 5 + β), with β as in Remark 4.1
(Table 1). Let
ε :=

z
y
y3
x
β
, ξ := (resp. ξ := 2 ), η := 2 , ω := 2 2 ,
xy
x
x
y
x y

so we have ε2 + η + ξ + ω = 0. We have
yz z
ω = ε, 2 , , 0 if A is E7r , r = 3, 2, 1, 0
x y
yz z yz
(resp. ω = ε, 2 , , , 0 if A is E8r , r = 4, 3, 2, 1, 0).
x x x
Suppose n = 1. Then F (ε) = ε2 = ξ + η + ω, all monomials of which
belong to A[x−1 ] ∪ A[y −1 ] except precisely for ω in the case r = rmax , which
is equal to ε.
Suppose n = 2 and r ≤ rmax − 1. We compute
F (ε, 0) = (ε2 , 0) = (ξ + η + ω, 0)

≡ (ξ + η + ω) − (ξ, 0) − (η, 0)

(mod W2 (A[x−1 ]) + W2 (A[y −1 ]))

= (ω, ξη + ξω + ηω).

Then the 0-th component belongs to A[x−1 ] or A[y −1 ], and all monomials
in the 1-st component belong to A[x−1 ] ∪ A[y −1 ] except precisely for ηω in
the case r = rmax − 1, which is equal to ε.
Suppose n = 3 and r ≤ rmax − 2. We compute, by using Lemma 2.2(2)
with (a, b, c) = (η, ξ, ω) (resp. (a, b, c) = (ξ, η, ω)),
F (ε, 0, 0) = (ε2 , 0, 0) = (η + ξ + ω, 0, 0)
≡ (η + ξ + ω, 0, 0) − (ξ, ξω, 0)

(mod W3 (A[x−1 ]))

= (η + ω, ηξ, (η + ω)3 ξ + (η + ω)ξ 3 + (η 2 + ηω + ω 2 )ξ 2 )
(resp. F (ε, 0, 0) = (ε2 , 0, 0) = (ξ + η + ω, 0, 0)
≡ (ξ + η + ω, 0, 0) − (η, ηω, 0)

(mod W3 (A[y −1 ]))

= (ξ + ω, ξη, (ξ + ω)3 η + (ξ + ω)η 3 + (ξ 2 + ξω + ω 2 )η 2 )).

NON-TAUT RDPS AND THE HEIGHT OF K3 SURFACES

11

Then the 0-th and 1-st component belong to A[y −1 ] (resp. A[x−1 ]), and all
monomials in the expansion of the 2-nd component belong to A[x−1 ]∪A[y −1 ]
except precisely for ηωξ 2 (resp. ξωη 2 ) in the case r = rmax −2, which is equal
to ε.
Case (2): E8r in characteristic 3. We may assume A = k[[x, y, z]]/(f ),
f = −z 2 + x3 + y 5 + λx2 y 2 , where λ = 1, y, 0 for r = 2, 1, 0 respectively. Let
3
z
, η := yx2 , ξ := xy 2 , so we have ε2 = ξ + η + λ.
ε := xy
Suppose n = 1. Then F (ε) = ε3 = ξε + ηε + λε, all monomials of which
belong to A[x−1 ] ∪ A[y −1 ] except precisely for λε in the case r = rmax , which
is equal to ε.
Suppose n = 2 and r ≤ rmax − 1 = 1. We compute, by using Lemma
2.2(4),
F (ε, 0) = (ε3 , 0) = ((ξ + λ)ε + ηε, 0)
≡ ((ξ + λ)ε + ηε, 0) − ((ξ + λ)ε, 0) − (ηε, 0)

(mod W2 (A[x−1 ]) + W2 (A[y −1 ]))

= (0, ηε · (ξ + λ)ε · (ξ + η + λ)ε)
= (0, εη(ξ + λ)(ξ + η + λ)2 ).

Write λ = by, where b = 1, 0 for r = 1, 0. For the 1-st component, we have
z
εη(ξ + λ)(η + ξ + λ)2 = 7 7 (x · (y 3 + bx2 y) · (x3 + y 5 + bx2 y 3 )2 )
x y
z
= 6 6 (y 2 + bx2 )(2x3 y 5 + 2bx5 y 3 + . . . )
x y
z
= 6 6 (4bx5 y 5 + . . . )
x y
≡ bε (mod A[x−1 ] + A[y −1 ]),

where (. . . ) ∈ (x6 , y 6 ) ⊂ k[[x, y]].

The remaining cases: We may assume A = k[[x, y, z]]/(f ) with
 2
z + x3 + y 2 z + bxyz
((p, S) = (2, E6 )),



−z 2 + x3 + y 4 + bx2 y 2
((p, S) = (3, E6 )),
f=
2
3
3
2
2

−z + x + xy + bx y ((p, S) = (3, E7 )),


 2
z + x3 + y 5 + (b/2)xy 4 ((p, S) = (5, E8 )),

for some b ∈ k with b = 0 if r = 0 and b 6= 0 if r = 1. Let ε := x−1 y −1 z. It
suffices to show that εp − bε = η + ξ for some η ∈ A[y −1 ] and ξ ∈ A[x−1 ].
We take
 −2
 −2
y x,
x z,






y −3 z,
x−3 yz,
η :=
ξ :=


y −3 z,
x−2 z,




 −5
 −5 5
y xz,
x (y + bxy 4 + (b2 /4)x2 y 3 + 2x3 )z.


Convention 4.8. We abuse the notation and say that an RDP of type S
is of type S 0 if rmax (p, S) = 0, so that the coindex r of an RDP is always
defined.

12

YUYA MATSUMOTO

Table 2. Partial resolutions of RDPs
p S

S′

rmax (S) rmax (S ′ ) equation of S r

2
2
2
2
2
2
2

D2m−1
D2m
E7
D7
D6
E6
D5

m−1
m−1
4
4
3
3
1

m−2
m−1
3
2
2
1
1

z 2 + x2 y + xy m + . . .
z 2 + x2 y + zy m + . . .
z 2 + x3 + y 5 + . . .
z 2 + x3 + y 5 + . . .
z 2 + x3 + xy 3 + . . .
z 2 + x3 + xy 3 + . . .
z 2 + x3 + y 2 z + . . .

z/y
z/y
x/y, z/y
z/x, y 2 /x
x/y, z/y
z/x
z/x

E7
E6

2
1

1
1

−z 2 + x3 + y 5 + . . .
−z 2 + x3 + xy 3 + . . .

x/y, z/y
z/x

D2m
D2m+1
E8
E8
E7
E7
E6

3 E8
3 E7

add:

Finally we note the following relation between RDPs connected by partial
resolutions (although we do not need it in this paper). If Z is an RDP surface
with an RDP z of type S and S ′ ⊂ S is a subdiagram, then the minimal
resolution ρ : Z̃ → Z of Z at z factors through the contraction ρ′ : Z̃ → ZS ′
of S ′ ⊂ S = Exc(ρ), and ZS ′ is an RDP surface. We say that ZS ′ → Z
is the partial resolution corresponding to S ′ → S. If S ′ is connected and
non-empty, then ZS ′ has a single RDP above z, which is of type S ′ .
Lemma 4.9. Let S ′ ⊂ S be a non-empty connected subdiagram of a Dynkin
diagram S. Let Z be an RDP of type S r and ZS ′ → Z be the partial reso′
lution corresponding to S ′ → S. Suppose z ′ is of type S ′r . Then we have
r ′ = max{0, r − (rmax (S) − rmax (S ′ ))}.
In other words, we have rmax (S ′ ) − r ′ = rmax (S) − r if this equality is
achieved by a non-negative integer r ′ , and r ′ = 0 otherwise.
Proof. We may assume that the number of components of S ′ is one less than
that of S. If rmax (S ′ ) = 0 then the assertion is trivial. So we may assume
rmax (S ′ ) > 0.
If (S, S ′ ) is (E8 , E7 ) or (E7 , D6 ), then the partial resolution is the blow-up
at the closed point. In the other cases, the partial resolution is the blow-up
at the ideals (x, y 2 , z), (y, z), or (x, z), as displayed in Table 2, with respect to
the equations given in Table 1. One can check that this blow-up is dominated
by the thrice blow-up Z3 , where Z0 := Z and Zi+1 := BlSing(Zi ) Zi , hence
it is indeed a partial resolution. A straightforward computation proves the
assertion in each case.

4.3. µp - and αp -quotient morphisms.
Proposition 4.10. Suppose a prime p, a group scheme G, a Dynkin diagram S, and a positive integer n satisfy one of the following.
(1) p is arbitrary, G = µp , S = Ap−1 , n = 1.
(2) p = 2, G = αp , S = D2n , n ≥ 2.
(3) p = 2, G = αp , S = E8 , n = 4.
(4) p = 3, G = αp , S = E6 , n = 2.
(5) p = 5, G = αp , S = E8 , n = 2.

NON-TAUT RDPS AND THE HEIGHT OF K3 SURFACES

13

Let π : Spec B → Spec A be a G-quotient map from a smooth point B to
an RDP A of type S 0 in characteristic p, with Fix(G) = {mB }. Then
there is an element e ∈ Hm2 A (Wn (A))[mA ] whose restriction Rn−1 (e) is a
generator of Hm2 A (A)[mA ] and satisfying π ∗ (e) = V n−1 (e′ ) for a generator
e′ ∈ Hm2 B (B)[mB ].
Proof. In each case the assumptions determine Spec B → Spec A up to
isomorphism by [Mat21, Theorem 3.3(1)]. In each case we consider the
class of the form e = [(ε, 0, . . . , 0)], ε = x−1 y −1 z j . We can check e ∈
Hm2 A (Wn (A))[mA ] as in the beginning of the proof of Proposition 4.7.
Case (1): Ap−1 in characteristic p. We may assume B = k[[X, Y ]] and
A = k[[x, y, z]]/(z p − xy) with x = X p , y = Y p , z = XY . Then it is
clear that [x−1 y −1 z p−1 ] and π ∗ ([x−1 y −1 z p−1 ]) = [X −1 Y −1 ] are generators
of Hm2 A (A)[mA ] and Hm2 B (B)[mB ] respectively.
Case (2): D20n in characteristic 2. We may assume B = k[[X, Y ]] and
n−1
n−1
A = k[[x, y, z]]/(z 2 +x2 y+xy 2 ) with x = X 2 , y = Y 2 , z = X 2 Y +XY 2 .
Let ε = x−1 y −1 z. We compute, by using Lemma 2.2(1) as in the proof of
Proposition 4.5,
n−1
 X 2 Y + XY 2n−1
 1

Y 2 −2
∗
π (ε, 0, . . . , 0) =
,
0,
.
.
.
,
0
=
+
,
0,
.
.
.
,
0
X 2Y 2
Y
X
n−1
 1

1
Y 2 −2
+
, 0, . . . , 0 −
, 0, . . . , 0
≡
Y
X
Y
n−1

Y 2 −2  1 2n−1 −1 
= ξ0 , . . . , ξn−2 , ξn−1 +
X
Y
 1 
≡ V n−1
(mod Wn (B[x−1 ]) + Wn (B[y −1 ])),
XY
for some ξi ∈ B[x−1 ]. Clearly [X −1 Y −1 ] is a generator of Hm2 B (B)[mB ].

Case (3): E80 in characteristic 2. We may assume B = k[[X, Y ]] and
A = k[[x, y, z]]/(z 2 + x3 + y 5 ) with x = X 2 , y = Y 2 , z = X 3 + Y 5 . Let
ε = x−1 y −1 z. We compute, by using Lemma 2.2(3),
 X3 + Y 5
 X

Y3
π ∗ (ε, 0, 0, 0) =
,
0,
0,
0
=
+
,
0,
0,
0
X 2Y 2
Y 2 X2
X


 Y 3

3
Y
X
≡
+
,
0,
0,
0
−
,
0,
0,
0
−
,
0,
0,
0
Y 2 X2
Y2
X2
 Y Y 7 + Y 2X 3
19
14
X Y + Y X 3 + Y 4X 9 X 2Y 5 + X 5 
= 0, ,
+
,
+
X
X5
Y3
X 13
Y 11


7
2
3
X
Y +Y X
+ 3 , ξ3 + η3
= 0, ξ1 ,
5
X
Y

 
Y 7 + Y 2X 3
X 
X
≡ 0, ξ1 ,
−
0,
0,
+
,
ξ
+
η
,0
3
3
X5
Y3
Y3

Y 7 + Y 2X 3 X 
= 0, ξ1 , ξ2 , ξ3 + η3 +
X5
Y3
 1 
(mod W4 (B[x−1 ]) + W4 (B[y −1 ])),
≡V3
XY
where ξi ∈ B[x−1 ] and ηi ∈ B[y −1 ].

14

YUYA MATSUMOTO

Case (4): E60 in characteristic 3. We may assume B = k[[Y, Z]] and
A = k[[x, y, z]]/(−z 2 + x3 + y 4 ) with x = Z 2 − Y 4 , y = Y 3 , z = Z 3 .
We interpret the local cohomology groups using the regular sequence x, y.
Let ε = x−1 y −1 z. We compute, by using Lemma 2.2(4) and the equality
Z 2 = x + Y 4,
 Z3   Z
ZY 
,
0
=
+
,0
π ∗ (ε, 0) =
xY 3
Y3
x
Z
ZY   Z   ZY 
≡
,0 −
,0
+
,0 −
Y3
x
Y3
x
 Z ZY Z 3   Z(x + Y 4 )2   Z · (−xY 4 + (. . . )) 
= 0, 3
= 0,
= 0,
Y x xY 3
x2 Y 5
x2 Y 5


Z
≡ 0, −
(mod W2 (B[x−1 ]) + W2 (B[y −1 ]))
xY
= V (β),
where (. . . ) ∈ (x2 , Y 8 ) and β := −x−1 Y −1 Z. Then e′ := [β] is a generator
of Hm2 B (B)[mB ] since Ann([β]) = (Y, Z) = mB .
Case (5): E80 in characteristic 5. We may assume B = k[[X, Z]] and A =
k[[x, y, z]]/(z 2 +x3 −y 5 ) with x = X 5 , y = Z 2 +X 3 , z = Z 5 . We interpret the
local cohomology groups using the regular sequence x, y. Let ε = x−1 y −1 z.
We compute, by using Lemma 2.2(5) and the equality Z 2 = y − X 3 ,
 Z 5   Z(y − 2X 3 ) ZX 
,0 =
+
,0
π ∗ (ε, 0) =
X 5y
X5
y
 Z(y − 2X 3 ) ZX   Z(y − 2X 3 )   ZX 
,0 −
,0
+
,0 −
≡
X5
y
X5
y
 Z 5 Z(y − 2X 3 ) ZX Z 2 (y 2 (y − 2X 3 )2 + X 6 y(y − 2X 3 ) + X 12 ) 
= 0, 5
X y
X5
y
X 10 y 2
 Z · (−X 18 y 3 + (. . . )) 
= · · · = 0,
X 19 y 4


Z
(mod W2 (B[x−1 ]) + W2 (B[y −1 ]))
≡ 0, −
Xy
= V (β),
where (. . . ) ∈ (X 21 , y 4 ) and β := −X −1 y −1 Z. Then e′ := [β] is a generator

of Hm2 B (B)[mB ] since Ann([β]) = (X, Z) = mB .
5. The height of K3 surfaces
In this section we recall the definition and properties of the height of K3
surfaces.
Theorem 5.1 (Artin–Mazur [AM77, Corollary II.4.2]). Let Y be a (smooth)
K3 surface. The functor Φ2 : {local Artinian k-algebras} → {abelian groups}
2 (Y × S, G ) → H 2 (Y, G )) is pro-represented by a
defined by S 7→ Ker(Hét
m
m
ét
1-dimensional formal group.
Definition 5.2. This formal group is called the formal Brauer group of Y
c ). Its height is called the (Artin–Mazur) height of Y and
and written Br(Y
written ht(Y ).

NON-TAUT RDPS AND THE HEIGHT OF K3 SURFACES

15

Here a 1-dimensional commutative formal group is said to be of height
h
h ∈ Z>0 if [p](t) = ctp + . . . for some c ∈ k∗ , and of height ∞ if [p](t) = 0,
where t is a uniformizer and [p] is the multiplication-by-p map. It follows
from Proposition 5.7 that ht(Y ) ∈ {1, 2, . . . , 10} ∪ {∞}.
As before, an RDP K3 surface is a proper surface with only RDP singularities whose minimal resolution is a K3 surface in the usual sense. We
define the height of an RDP K3 surface to be the height of its resolution.
To relate the height of a K3 surface with the properties of non-taut RDPs,
we need the following characterization of the height.
Theorem 5.3 (van der Geer–Katsura [vdGK00, Theorem 5.1]). Let Y be
an RDP K3 surface in positive characteristic and n ≥ 1 an integer. Then
ht(Y ) ≤ n if and only if the Frobenius map on H 2 (Y, Wn (OY )) is nonzero.
Proof. In [vdGK00] this is stated for smooth K3 surfaces. Suppose π : Ỹ →
Y is the minimal resolution of an RDP K3 surface. Then since Y has only
rational singularities we have Ri π∗ OỸ = 0 for i > 0, hence H 2 (Y, OY ) →
H 2 (Ỹ , OỸ ) is an isomorphism. It follows that H 2 (Y, Wn (OY )) → H 2 (Ỹ , Wn (OỸ ))
is also an isomorphism. Thus the assertion for RDP K3 surfaces is reduced
to that for smooth K3 surfaces.

We also recall several properties that can be used to determine or bound
the height of (RDP) K3 surfaces.
Proposition 5.4. Suppose P = P(n0 , n1 , n2 , n3 ) = Proj k[x0 , x1 , x2 , x3 ] is a
3-dimensional weighted projective space, and Y = (f
P = 0) ⊂ P is a hypersurface that is an RDP K3 surface. Then deg(f ) =
ni , and Y is ordinary
(i.e. ht(Y ) = 1) if and only if the coefficient of (x0 x1 x2 x3 )p−1 in f p−1 is
nonzero.
sm =
Proof. Let ωP and ωX be the canonical
sheaves. Since OX sm ∼
= ωXP
P
(ωP ⊗ O(deg(f )))|X sm = OX sm (− ni + deg(f )), we have deg(f ) =
ni .
This proves the first assertion.
The proof of the second assertion is standard and applicable to hypersurface Calabi–Yau varieties of arbitrary dimension, see for example [Har77,
Proposition IV.4.21] for the 1-dimensional case. We include the proof for
the reader’s convenience. Let d = deg(f ). We have canonical isomorphisms

∼

∼

H 2 (X, OX ) → H 3 (P, f OP (−d)) ← Ȟ 3 ({Ui }i∈I , f OP (−d))
M

= Coker
Γ(UJ , f O(−d)) → Γ(UI , f O(−d)) ,
|J|=3

where
{Ui }i∈I (I := {0, 1, 2, 3}) is the standard affine covering of P and UJ :=
T
U
i∈J i for J ⊂ I. This cokernel is 1-dimensional, generated by the class of
fp
f
x0 x1 x2 x3 . The Frobenius image of this class is the class of (x0 x1 x2 x3 )p = f ·
f p−1
(x0 x1 x2 x3 )p

∈ Γ(UI , f O(−d)), which is nontrivial if and only if the coefficient
of (x0 x1 x2 x3 )p−1 in f p−1 is nonzero. Apply Theorem 5.3.

Remark 5.5. In principle, it is possible to compute the Frobenius map on
H 2 (X, Wn (OX )) in terms of f .

16

YUYA MATSUMOTO

Theorem 5.6. Let Y be a (smooth) K3 surface. Consider the crystalline
2 (Y /W(k)), which is an F -crystal. If h = ht(Y ) < ∞,
cohomology group Hcrys
2
then Hcrys (Y /W(k)) has slopes 1 − 1/h, 1, and 1 + 1/h, with respective
multiplicity h, 22 − 2h, and h. If ht(Y ) = ∞, then it has slope 1 with
multiplicity 22.
c ) is
Proof. By [AM77, Corollary II.4.3], the Dieudonné module of Br(Y
2
isomorphic to H (Y, W OY ). The slope spectral sequence induces an iso2 (Y /W (k))
morphism H 2 (Y, W OY ) ⊗W (k) K0 ∼
= Hcrys
<1 ⊗W (k) K0 , where
K0 := Frac W (k) and −<1 denotes the slope < 1 part of an F -crystal.
The assertion follows from this (see [Ill79, Section II.7.2]).

Proposition 5.7 ([Ill79, Proposition II.5.12]). Suppose Y is a (smooth) K3
surface of height h with Picard number ρ = ρ(Y ) := rank Pic(Y ). If h < ∞,
then ρ ≤ 22 − 2h, and if h = ∞, then ρ ≤ 22.
Suppose Y is an RDP K3 surface
P of height h with RDPs zi of type ANi ,
D
,
or
E
.
If
h
<
∞,
then
Ni < 22 − 2h, and if h = ∞, then
Ni
PNi
Ni < 22.

2 (Y /W(k)) generated by
Proof. Suppose Y is smooth. The subspace of Hcrys
the Picard group is of slope 1 with multiplicity ρ, which should be at most
22 − 2h (resp. 22) if h < ∞ (resp. h = ∞) by Theorem 5.6.
Suppose Y is an RDP K3 surface. Then the exceptional curves on
P the
resolution Ỹ generate a negative-definite sublattice of Pic(Ỹ ) of rank
Ni .
P
Since Pic(Ỹ ) is of sign (+1, −(ρ − 1)), we have
Ni < ρ.


Proposition 5.8. Suppose Y is an RDP K3 surface defined over a finite
field Fq . Define a(m) ∈ Q by |Y (Fqm )| = 1 + (q m )2 + a(m)q m . Let s(j) be
the j-th elementary
symmetric polynomial of the indeterminates x1 , x2 , . . .
P
satisfying i xm
=
a(m).
Then ht(Y ) > n if and only if s(1), . . . , s(n) ∈ Z.
i
Note that s(j) can be expressed as a polynomial of a(1), . . . , a(j) with
coefficients in Q.

Proof. Comparing Y (Fqm ) and Ỹ (Fqm ), the assertion is reduced to the case
Y is smooth.
2 (Y /W (k)) ∼
By Theorem 5.6, it suffices to know the slopes of Hcrys
=
2
b
b
2
Hcrys (Y /W (Fq ))⊗W (Fq ) W (k). Write q = p . Then F ∈ End(Hcrys (Y /W (Fq )))
is linear (not only semilinear) and its eigenvalues coincide with the Frobenius
2 (Y, Q ) ([Ill75, 3.7.3]), which are encoded in the sequence
eigenvalues on Hét
l
a(m) by the Weil conjecture (more precisely, the Lefschetz trace formula).
Writing down the correspondence explicitly, we obtain the assertion.

Theorem 5.9 (Ito [Ito18, Theorem 1.1]). Let X be a K3 surface in characteristic 0, having complex multiplication (CM) by a CM-field E, and defined
over a number field K containing E. Suppose X has good reduction Xv at
a prime v of K. Let p, q, and p be respectively the primes of E, F , and Q
below v, where F is the maximal totally-real subfield of E.
• If q splits in E, then Xv is of height [Ep : Qp ] < ∞.
• If q does not split (in other words, if it ramifies or is inert) in E,
then Xv is supersingular (i.e. of height ∞).

NON-TAUT RDPS AND THE HEIGHT OF K3 SURFACES

17

In this paper, we use this theorem only in the following situations.
p
• If X has Picard number 20, then X has CM by E = Q( − disc T (X))
(see [Huy16, Remark 3.3.10]), where T (X) = Pic(XC )⊥ ⊂ H 2 (XC , Z)
is the transcendental lattice. In this case F = Q.
In this case Theorem 5.9 is proved by Shimada [Shi09, Theorem
1] for all but finitely many p not dividing 2 disc Pic(X) (for each X).
However we use Theorem 5.9 for p = 2.
• If X admits an automorphism acting on H 0 (X, Ω2 ) by a primitive
m-th root ζm of unity and if rank T (X) = φ(m), then X has CM by
−1 ).
the cyclotomic field E = Q(ζm ). In this case F = Q(ζm + ζm
Jang [Jan16, Corollary 4.3] proved the following related result.
Suppose Y is a K3 surface in characteristic p > 2 that admits an
automorphism acting on H 0 (Y, Ω2 ) by a primitive m-th root of unity,
and assume 22− φ(m) ≤ ρ(Y ). If pn ≡ −1 (mod m) for some n then
Y is supersingular, and otherwise ht(Y ) is equal to the order of p in
(Z/mZ)∗ . However we use Theorem 5.9 for p = 2.
6. Height of K3 surfaces and height of morphisms between
RDP K3 surfaces
6.1. Height of morphisms between RDP K3 surfaces.
Definition 6.1. Let π : X → Y be a dominant morphism between RDP
K3 surfaces. We define the height ht(π) of π to be the minimum positive
integer n such that the morphism π ∗ : H 2 (Y, Wn (OY )) → H 2 (X, Wn (OX ))
is nonzero if such n exists, and to be ∞ if there is no such n.
Clearly (Theorem 5.3), the height of the Frobenius map of an RDP K3
surface is equal to the height of the surface.
We have the following.
Lemma 6.2. Let π : X → Y be as above.
(1) The image of π ∗ : H 2 (Y, Wn (OY )) → H 2 (X, Wn (OX )) is equal to
V ht(π)−1 (H 2 (X, Wn−(ht(π)−1) (OX ))) if n ≥ ht(π) and to 0 if n <
ht(π).
(2) If π ′ : U → X is another morphism with the same assumption, then
ht(π ◦ π ′ ) = ht(π) + ht(π ′ ) − 1 (under the natural convention that
∞ ± n = ∞ + ∞ = ∞).
(3) If π is birational, then ht(π) = 1.
Proof. For each 0 ≤ n′ ≤ n, the exact sequence
′

Vn

′

Rn−n

0 → Wn−n′ (OY ) −−→ Wn (OY ) −−−−→ Wn′ (OY ) → 0

induces an exact sequence

′

Vn

′

Rn−n

0 → H 2 (Wn−n′ (OY )) −−→ H 2 (Wn (OY )) −−−−→ H 2 (Wn′ (OY )) → 0

since H 1 (OY ) = 0, and this is compatible with π ∗ .
(1) For n < ht(π), this follows from the definition of ht(π). Suppose n ≥
ht(π). We have Im(π ∗ ) ⊂ Ker(Rn−(ht(π)−1) ) = Im(V ht(π)−1 ) (in H 2 (Wn (OX ))).
Let us show Im(π ∗ ) = Im(V ht(π)−1 ) by induction on n ≥ ht(π). If n = ht(π),

18

YUYA MATSUMOTO

then this is true since Im(π ∗ ) 6= 0 and length(Im(V ht(π)−1 )) = length(H 2 (OX )) =
1. Suppose n > ht(π) and take x ∈ Im(V ht(π)−1 ). By induction hypothesis,
we have R(x) ∈ Im(V ht(π)−1 ) = Im(π ∗ ) = Im(π ∗ ◦ R), hence we may assume
R(x) = 0, and then x ∈ Im(V n ) ⊂ V (Im(V ht(π)−1 )) = V (Im(π ∗ )) ⊂ Im(π ∗ ).
(2) By (1), the image of π ′∗ ◦ π ∗ : H 2 (Y, Wn (OY )) → H 2 (U, Wn (OU )) is
(
0
(n ≤ (ht(π) − 1) + (ht(π ′ ) − 1)),
′
V (ht(π)−1)+(ht(π )−1) (H 2 (U, OU )) 6= 0 (n = (ht(π) − 1) + (ht(π ′ ) − 1) + 1).
(3) It suffices to consider the case where π is the minimal resolution
Ỹ → Y , and this is proved in the proof of Theorem 5.3.

In some cases we can bound ht(π) using local behaviors of π ∗ .

Proposition 6.3. Let π : X → Y be as above. Let x ∈ X be a point,
y = π(x), my ⊂ OY,y the maximal ideal, and I ( OY,y an my -primary ideal.
Let n ≥ 1 be an integer. Consider an element e ∈ Hy2 (Wn (OY,y ))[I] and its
image by the morphism
π ∗ : Hy2 (Wn (OY,y ))[I] → Hx2 (Wn (OX,x ))[IOX,x ].

(1) Suppose π ∗ (e) = V n−1 (e′ ) for some generator e′ ∈ Hx2 (OX,x )[mx ].
Then ht(π) ≤ n.
(2) Suppose I = my and Rn−1 (e) ∈ Hy2 (OY,y )[my ] is a generator. If
π ∗ (e) = 0, then ht(π) > n.
(3) Suppose I = my , Rn−1 (e) ∈ Hy2 (OY,y )[my ] is a generator, and π ∗ (e) =
V n−1 (e′ ) for some generator e′ ∈ Hx2 (OX,x )[mx ]. Then ht(π) = n.
Proof. Given I ( OY,y and n as in the statement, we consider the map
γ = γI,n : Hy2 (Wn (OY,y ))[I] → H 2 (Y, Wn (OY )) defined by
∼

Hy2 (Wn (OY,y ))[I] ← Ext2 (OY,y /I, Wn (OY,y ))
∼

← Ext2 (OY /I, Wn (OY )) → H 2 (Y, Wn (OY )),

∼
where I := Ker(OY → OY,y /I) ⊂ OY (so Supp OY /I = {y} and OY /I =
′
OY,y /I). This γ = γI,n commutes with inclusions of ideals I ⊂ I, with V ,
and with π ∗ (with π as in the statement).
If n = 1 and I = my , then γmy ,1 is an isomorphism, since the horizontal map in the diagram is, by Serre duality, the dual of the isomorphism
∼
H 0 (Y, OY ) → H 0 (Y, k(y)).
(1) Applying γ to π ∗ (e) = V n−1 (e′ ), we obtain π ∗ (γ(e)) = V n−1 (γ(e′ )).
As mentioned above, γmx ,1 is an isomorphism, hence V n−1 (γ(e′ )) is nonzero.
Hence ht(π) ≤ n.
(2) By applying the induction hypothesis to R(e) if n > 1, we obtain
ht(π) > n−1. Since γmy ,1 is an isomorphism, Rn−1 (γ(e)) ∈ H 2 (OY ) is a generator. Hence H 2 (Wn (OY )) is generated by γ(e) and V (H 2 (Wn−1 (OY ))),
and π ∗ annihilates both since π ∗ (e) = 0 and ht(π) > n − 1.
(3) Applying (2) to R(e) if n > 1, we obtain ht(π) > n − 1. Applying (1)
to e, we obtain ht(π) ≤ n.

From this proposition we deduce bounds, or moreover exact values, of
the height of RDP K3 surfaces with suitable singularities. It turns out,
surprisingly, that any non-taut RDP is suitable.

NON-TAUT RDPS AND THE HEIGHT OF K3 SURFACES

19

6.2. Height of Frobenius maps and non-taut RDPs. Combining Proposition 6.3 with the computation on Frobenius maps on local RDPs given in
Section 4.2, we prove the following relation between the isomorphism class
of a non-taut RDP on an RDP K3 surface and the height of the surface.
This is trivially true when rmax (p, S) = 0 (recall Convention 4.8).
Theorem 6.4 (Precise form of Theorem 1.2). Let S be a Dynkin diagram
and p ≥ 0 be a characteristic. Let rmax = rmax (p, S) be the integer defined
in Section 1. Define a subsequence (r1 , r2 , . . . , rl ) of (rmax (p, S), . . . , 2, 1) as
follows.
• (p, S) = (2, DN ), N ≥ 8 (rmax = ⌊N/2⌋ − 1):
– If 8 ≤ N ≤ 9: (r1 , r2 ) = (⌊N/2⌋ − 1, ⌊N/2⌋ − 2).
– If 10 ≤ N : (r1 , r2 , r3 ) = (⌊N/2⌋ − 1, ⌊N/2⌋ − 2, ⌊N/2⌋ − 4).
• (p, S) = (2, E8 ) (rmax = 4): (r1 , r2 , r3 ) = (4, 3, 2).
• all other cases: (r1 , . . . , rl ) is the entire sequence (rmax (p, S), . . . , 2, 1).
Then we have the following. Suppose an RDP K3 surface Y admits an RDP
of type S r .
• If r > 0, then ht(Y ) ≤ l and r = rht(Y ) .
• If r = 0, then ht(Y ) > l.

r (r > 0 and ⌊N/2⌋ −
Corollary 6.5. In characteristic 2, RDPs of type DN
r 6∈ {1, 2, 4}) and E81 do not occur.

Proof of Theorem 6.4. Suppose Y is an RDP K3 surface in characteristic p
r ), (2, E 1 ), then the
having a non-taut RDP of type S r . If (p, S r ) 6= (2, DN
8
assertion follows from Proposition 6.3 ((3) if r > 0 and (2) if r = 0) applied
to the elements e given in Proposition 4.7.
Suppose (p, S r ) = (2, E81 ). By Proposition 6.3 (1) and (2) applied to the
elements given in Propositions 4.6 and 4.7 respectively, we obtain ht(Y ) ≤ 1
and ht(Y ) > 3. Contradiction.
r ). We have r
Suppose (p, S r ) = (2, DN
max + 1 = ⌊N/2⌋. It suffices to show
that
• the inequality ⌊N/2⌋ − r ≤ 2ht(Y )−1 holds,
• this inequality is equality if r > 0, and
• ht(Y ) ≤ 3 if r > 0.
′
Let n′ be the (unique) non-negative integer satisfying 2n −1 < ⌊N/2⌋ − r ≤
′
2n . By applying Proposition 6.3(2) to the element given in Proposition 4.5
for (n, j) = (n′ , 1) (in which case a ≥ 0), we obtain ht(Y ) ≥ n′ + 1. Hence
′
⌊N/2⌋ − r ≤ 2n ≤ 2ht(Y )−1 .
Suppose moreover r > 0. Let (n, j) be the (unique) pair of positive
integers with ⌊N/2⌋ − r = 2n−1 (2j − 1). By applying Proposition 6.3(1) to
the element given in Proposition 4.5 for this (n, j) (in which case a = −1), we
obtain ht(Y ) ≤ n. Hence we have 2ht(Y )−1 ≤ 2n−1 ≤ 2n−1 (2j −1) = ⌊N/2⌋−
r, therefore ⌊N/2⌋ − r = 2ht(Y )−1 . Since N < 22 − 2 ht(Y ) (Proposition 5.7)
and N ≥ 2(⌊N/2⌋ − r) = 2ht(Y ) , we have ht(Y ) ≤ 3.

6.3. Height of µp - and αp -quotient morphisms. Suppose X and Y are
RDP K3 surfaces and π : X → Y is a G-quotient morphism with G ∈
{µp , αp }. The author proved [Mat21, Theorem 4.3] that the “dual” map
π ′ : Y (1/p) → X is also a G′ -quotient morphism with G′ ∈ {µp , αp }.

20

YUYA MATSUMOTO

Definition 6.6 ([Mat21, Definition 3.4]). We say that a G-quotient morphism π : X → Y between RDP K3 surfaces is maximal if there is no point
x ∈ X such that x and π(x) are both RDPs.
The author proved [Mat21, Corollary 3.5] that for any G-quotient morphism π : X → Y between RDP K3 surfaces there is a maximal G-quotient
morphism π1 : X1 → Y1 between RDP K3 surfaces with a birational and
G-equivariant morphism X1 → X. Then ht(π) = ht(π1 ) by Lemma 6.2(3).
Theorem 6.7 (Precise form of Theorem 1.3). Let π : X → Y be as above.
(1) If π is

1




2
ht(π) =

3



4

maximal (Definition 6.6), then we have
if
if
if
if

G = µp
G = αp
G = αp
G = αp

24
Ap−1 ),
(in which case p ≤ 7 and Sing(Y ) = p+1
0
0
and (p, Sing(Y )) = (2, 2D4 ), (3, 2E6 ), (5, 2E80 ),
and (p, Sing(Y )) = (2, 1D80 ),
and (p, Sing(Y )) = (2, 1E80 ).

This covers all possibilities for G, p, and Sing(Y ) in the maximal
case ([Mat21, Theorem 4.6]).
(2) We have ht(X) = ht(Y ) = ht(π) + ht(π ′ ) − 1. In particular, X and
Y are of finite height.

Proof. (1) Let y ∈ Y be a singular point. Since π is maximal, the inverse
image π −1 (y) of y is smooth, hence Spec OX,π−1 (y) → Spec OY,y is as in
Proposition 4.10. Hence we obtain ht(π) from Proposition 6.3(3).
(2) Since FrobY = π ◦π ′ and FrobX = π ′ ◦π (1/p) , the first assertion follows
from Lemma 6.2(2). For the second assertion, we may assume π is maximal,
and then π ′ is also maximal, and we can apply (1) to π and π ′ .

Corollary 6.8. Let π : X → Y be as above.
If p = 5, then (G, G′ ) 6= (α5 , α5 ).
If p = 2 and π is maximal, then (G, G′ , Sing(X), Sing(Y )) 6= (α2 , α2 , 1E80 , 1E80 ).
Proof. We may suppose π is maximal. (By above, this implies that if p =
5 and G = α5 then Sing(Y ) = 2E80 .) Then the height of Y asserted in
Theorem 6.7, which is 3 or 7 respectively, contradicts the latter inequality
of Proposition 5.7.

All other (G, G′ , Sing(X), Sing(Y )) is realizable (see [Mat21, Examples
10.2–10.5]). Hence we have the following.
Corollary 6.9. Suppose an RDP K3 surface X in characteristic p admits an action of µp or αp whose quotient is an RDP K3 surface. Then
ht(X) ≤ 6, 3, 2, 1 for p = 2, 3, 5, 7 respectively, and every such positive integer is realizable.
Furthermore we have the following criterion.
Corollary 6.10. Suppose X is an RDP K3 surface in characteristic p with
a nontrivial G-action, G ∈ {µp , αp }. Then X/G is an RDP K3 surface if
and only if ht(X) < ∞, and X/G is either an RDP Enriques surface or a
rational surface if and only if ht(X) = ∞.

NON-TAUT RDPS AND THE HEIGHT OF K3 SURFACES

21

Proof. It is known ([Mat21, Proposition 4.1]) that the quotient is either an
RDP K3 surface, an RDP Enriques surface, or a rational surface.
We saw in Theorem 6.7 that if X/G is an RDP K3 surface then X is of
finite height.
2 (X/G, Q )
If X/G is a rational surface or an RDP Enriques surface, then Hét
l
2 (X, Q ), hence X is superis generated by algebraic cycles, hence so is Hét
l
singular.

6.4. The case of Z/pZ-quotients. Suppose X is a (smooth) K3 surface
and π : X → Y is a G-quotient morphism with G = Z/pZ. Suppose Y is
an RDP K3 surface. The author determined all possible configurations of
singularities on Y [Mat21, Theorem 7.3(1)]. In each case, the configuration contains a non-taut RDP with r > 0, hence by Theorem 6.4 we can
determine the height of Y , and we can show it is equal to the height of X.
Theorem 6.11. Let π : X

1

ht(X) = ht(Y ) = 2


3

→ Y be as above. Then

if (p, Sing(Y )) = (2, 2D41 ), (3, 2E61 ), (5, 2E81 ),
if (p, Sing(Y )) = (2, 1D82 ),
if (p, Sing(Y )) = (2, 1E82 ).

This covers all possibilities for p and Sing(Y ) ([Mat21, Theorem 7.3(1)]).
In particular, X and Y are of finite height.
Proof. As explained above, it follows from Theorem 6.4 that ht(Y ) is equal to
2 (Y /W(k)) has slope
the asserted value. In particular, ht(Y ) < ∞, hence Hcrys
1
2
∗
2
1± ht(Y
) . The pullback π : Hcrys (Y /W(k))⊗W(k) K0 → Hcrys (X/W(k))⊗W(k)
K0 is a direct summand since π∗ ◦ π ∗ is a scalar. Here K0 = Frac(W(k)).
1
2 (X/W(k)) has slope 1 ±
Hence Hcrys

ht(Y ) . Hence ht(X) = ht(Y ).
Remark 6.12. In the case of Z/pZ-quotients, we do not have an equivalence
as in Corollary 6.10. There is an example of an Z/pZ-action on an ordinary
K3 surface X with rational or Enriques quotient Y , at least in characteristic
2.
7. RDPs realizable on K3 surfaces
We determine which RDPs can occur on K3 surfaces.
7.1. Non-taut RDPs. In the non-taut case, Theorem 6.4 (and Corollary
6.5) and Proposition 5.7 give necessary conditions. We will show in Propo8 in characteristic 2 is impossible. It turns out that all
sition 7.2 that D19
remaining RDPs are realizable on RDP K3 surfaces, as we will see in Section 8. Summarizing:
r or E r in characteristic p.
Theorem 7.1. Consider a non-taut RDP DN
N
Then it occurs on some RDP K3 surface Y in characteristic p if and only
if it satisfies the following conditions.
• It does not contradict Corollary 6.5 and Proposition 7.2 (i.e. if p = 2,
r with r > 0 and ⌊N/2⌋ − r ∈
8 , nor
then it is not DN
/ {1, 2, 4}, nor D19
E81 ).
• N < 22 − 2h if r > 0, where h is the height predicted in Theorem
6.4. N < 22 if r = 0.

22

YUYA MATSUMOTO

Proposition 7.2. An RDP K3 surface in characteristic 2 cannot have an
8 .
RDP of type D19
8 in charProof of Proposition 7.2. Suppose z ∈ Y is an RDP of type D19
acteristic 2 on an RDP K3 surface Y . By Theorem 6.4, ht(Y ) = 1. Let
Ỹ → Y be the minimal resolution. Since ht(Ỹ ) < ∞ there exists, by
[LM18, Corollary 4.2], a K3 surface X over Spec W (k) with X ⊗W (k) k ∼
= Ỹ
∼
and Pic(X ) → Pic(Ỹ ). Let XK := X ⊗W (k) K be the generic fiber of
X over K := Frac W (k) and let XC := XK ⊗K C for any embedding
K → C (which we may assume to exist by replacing k). Then we have
Pic(XC ) ∼
= Pic(X ) ∼
= Pic(Ỹ ).
Let L1 be the sublattice of Pic(Ỹ ) ∼
= Pic(XC ) generated by the exceptional
⊥
curves above z, and L2 := L1 be its orthogonal complement. Since L1
is negative definite, L2 is nonzero, and since ρ(Y ) ≤ 22 − 2 ht(Y ) = 20
(Proposition 5.7), we have rank L2 = 1. The transcendental lattice T =
T (XC ) = (Pic(XC ))⊥ in H 2 (XC , Z) of XC is a rank 2 positive definite lattice,
and then√XC has complex multiplication by the imaginary quadratic field
E := Q( −d), d := disc T (XC ). By Theorem 5.9, the reduction Ỹ of XC
at a prime above 2 being ordinary implies that 2 is split in E/Q. Writing
d = k2 d0 with d0 square-free, this means d0 ≡ −1 (mod 8). By Lemma 7.3,
this is impossible.


Lemma 7.3. Suppose L1 , L2 , and L3 are lattices with
• disc(L1 ) = −4x ,
• L2 is positive definite, rank(L2 ) = 1,
• L3 is positive definite, rank(L3 ) = 2, disc(L3 ) = k2 d0 with d0 squarefree and d0 ≡ −1 (mod 8).

Then L1 ⊕ L2 ⊕ L3 does not admit a unimodular overlattice of finite index.
A non-degenerate lattice L is called unimodular if the natural injection
L ֒→ L∗ := Hom(L, Z) is an isomorphism, equivalently if disc(L) = ±1.
Proof. Suppose L1 ⊕L2 ⊕L3 admits a finite index overlattice Λwith disc(Λ)
=

a b
±1. Take bases e2 of L2 and t1 , t2 of L3 , and let (m) and
be the
b c
Gram matrices (so m > 0, a > 0, and disc(L3 ) = k2 d0 = ac − b2 > 0).
Since L1 ⊕ L2 ⊕ L3 ⊂ Λ is finite index, its discriminant disc(L1 ⊕ L2 ⊕ L3 ) =
disc(L1 ) · disc(L2 ) · disc(L3 ) = −4x mk2 d0 coincides with disc(Λ) = ±1 up to
a square. Hence m = n2 d0 .
Let g = gcd{a, b, c}. Then the discriminant group of L3 is isomorphic
to Z/gZ × Z/ghZ, where h = g −2 disc(L3 ) ∈ Z. By lattice theory this is
isomorphic to the discriminant group of the primitive closure of L1 ⊕ L2 in
Λ, which is a subquotient of the discriminant group of L1 ⊕ L2 . Hence g is
a power of 2.
√
We claim that a is the norm of some ideal of OE , where E = Q( −d0 ).
It suffices to show that ordl (a) is even for any prime l that is inert in E/Q.
Suppose ordl (a) = 2j − 1 and l is inert (then l 6= 2 since −d0 ≡ 1 (mod 8)).
Then, since ac = b2 + k2 d0 and since l is inert, we have ordl (k2 d0 ) ≥ 2j and
ordl (b2 ) ≥ 2j, hence l | c, hence l | g, hence l = 2. Contradiction.

NON-TAUT RDPS AND THE HEIGHT OF K3 SURFACES

23

Since Λ is unimodular, there is an element v ∈ Λ with e2 · v = 1. Write
= v1 + v2 + v3 with vi ∈ Li ⊗ Q, then vi ∈ L∗i . We have v2 =
x
(2 n/m)e2 and hence v22 = (2x n/m)2 m P
= 4x /d0 . We have v12 ∈ Z (since
x
∗
vi2 = (2x n)2 v 2 ∈ Z. Hence we
[L1 : L1 ] = |disc(L1 )| = 4 ). We have
2
x
2
obtain v3 ≡ −4 /d0 (mod Z), hence d0 v3 ≡ −4x (mod d0√Z).
Write v3 = x1 t1 + x2 t2 (xi ∈ Q). Then d0 = NE/Q ( −d0 ) and av32 =
√
a(ax21 + 2bx1 x2 + cx22 ) = NE/Q (ax1 + (b + −k2 d0 )x2 ) are the norms of
elements of E. Hence d0 v32 = d0 · a−1 · av32 is the norm of a fractional ideal
of E. Therefore −4x and hence −1 are norm residues modulo d0 . But −1
cannot be a norm residue of an imaginary quadratic field. Contradiction. 

2x nv

7.2. Taut RDPs. For the taut case we have the following, which is almost
done by Shimada and Shimada–Zhang.
Theorem 7.4. Suppose p ≥ 0. Suppose S is a Dynkin diagram (AN , DN ,
EN ) for which RDPs of type S in characteristic p are taut. Then such an
RDP occurs on some RDP K3 surface Y in characteristic p if and only if p
satisfies the following respective conditions.
• If N ≤ 19: any p ≥ 0.
√
• If S is A20 : p > 0 and p is non-split in Q( 21). Equivalently, either
p | 21 or p ≡ ±2, ±8, ±10 (mod 21).
• If S is A21 : p = 11.
• If S is D20 or D21 , or N ≥ 22: no p.

Proof. Suppose N ≤ 19 and p 6= 2. It is known that there exists an elliptic
K3 surface with a section and a singular fiber of type I19 . For p = 0 this is
due to Shioda [Shi03, Theorem 1.1] (who used the equation given by Hall
[Hal71, equation 4.29 in page 185]). It is clear from the Shioda’s equation
that the same equation in characteristic p > 3 also gives an elliptic K3
surface with the same property. Moreover this holds for p = 3 using the
coordinate change given by Schütt–Top [ST06, Section 2]. Then the union
of a section and this singular fiber contains a configuration of type S.
Suppose N ≤ 20 and p = 2. Then S is a subset of D21 , which is realized
by Theorem 7.1 (Example 8.1).
Suppose S is A20 and p 6= 2. If p ∤ 2 disc(A20 ) = 2 · 3 · 7, then by
[SZ15, Table]1, this is possible if and only if ( 21
p ) = −1. If p = 7, then this
is possible by [Shi04, Table RDP]. It remains to show that it is possible if
p = 3. Let L be the Dynkin lattice oftype A
20 and T be the lattice of rank
2 5
2 with basis t1 , t2 and Gram matrix
. Let e1 , e2 , . . . , e20 be a basis
5 2
of A20 with ei · ej = −2, 1, 0 if |i − j| = 0, |i − j| = 1, |i − j| ≥ 2 respectively.
P20
We have L∗ /L ∼
= Z/21Z and T ∗ /T ∼
= Z/21Z. Let l = 71 ( i=1 iei ) ∈ L∗ and
t = 74 (t1 + t2 ) ∈ T ∗ . They generate the prime-to-3 parts of L∗ /L and T ∗ /T
respectively. We have l2 ≡ −t2 (mod 2Z) since l2 + t2 = ( 17 )2 · (−20 · (20 +
1)) + ( 74 )2 · 14 = −4 ∈ 2Z. We can apply Lemma 7.5 below.
Suppose S is A21 . Then Y is supersingular and, considering the Picard
lattice, we must have p | 22. By [Shi04, Table RDP], this is possible for
p = 11 and impossible for p = 2.
1The table is contained only in the preprint version available at Shimada’s website.

24

YUYA MATSUMOTO

Suppose S is D20 . Since disc(S) = 4 is a square, an RDP of type S can
be realized only in characteristic p dividing disc(S) by [DK09, Lemma 3.2],
that is, p = 2. In this case S is non-taut and is out of the scope of this
theorem.

For a finite abelian group A, we write its p-primary part (resp. prime-to-p
part) by Ap (resp. Ap′ ). For a non-degenerate even lattice L, we define a
quadratic map qL : L∗ /L → Q/2Z by qL (v̄) = v 2 mod 2Z, where the bar
denotes the projection L∗ → L∗ /L. The next lemma is a variant of [SZ15,
Proposition 2.6].
Lemma 7.5. Let
P p be an odd prime. Let R be a formal finite sum of AN ,
DN , EN , with
N = 20, and let L = L(R) be the corresponding lattice
(of rank 20). Suppose there are an even lattice T of sign (+1, −1) and
∼
a group isomorphism φ : (L∗ /L)p′ → (T ∗ /T )p′ satisfying φ∗ (qT |(T ∗ /T )p′ ) =
−qL |(L∗ /L)p′ and (L∗ /L)p ⊕ (T ∗ /T )p ∼
= (Z/pZ)2 . Then there exists an RDP
K3 surface Y (supersingular of Artin invariant 1) with Sing(Y ) = R.
Proof. Let Λ be the submodule of L∗ ⊕ T ∗ consisting of the elements (l, t)
with ¯l ∈ (L∗ /L)p′ , t̄ ∈ (T ∗ /T )p′ , and φ(¯l) = t̄. Then Λ is an even overlattice
of L ⊕ T of sign (+1, −21) with Λ∗ /Λ ∼
= (Z/pZ)2 . This means that Λ
is isomorphic to the Picard lattice of a supersingular K3 surface of Artin
invariant 1. By the argument of [SZ15, Theorem 2.1, (3) =⇒ (1)], we obtain
a supersingular RDP K3 surface Y of Artin invariant 1 with Sing(Y ) =
R.

8. Examples
Examples of maximal G-quotient morphisms X → Y between RDP K3
surfaces with all possible (G, G′ , Sing(X), Sing(Y )) are already given in [Mat21,
Examples 10.2–10.5].
The non-taut RDPs in Examples 8.1–8.3, together with their partial resolutions, prove the existence part of Theorem 7.1.
Example 8.1 (p = 2).
• Schütt [Sch06, Section 6.2] gave an example of an elliptic K3 surface
y 2 + txy + t6 y = x3 + (c2 t4 + ct3 + ã6 )x2 + ct8 x + t10 ã6 ,

where ã6 ∈ k[t] is of degree ≤ 2, with a section and a singular fiber
of type I∗13 . It is of height 1 since the coefficient of txy is nonzero
(Proposition 5.4 applied to P(6, 4, 1, 1)). The union of a section and
this singular fiber contains a configuration of type D18 and one of
type E8 . The respective contractions give RDP K3 surfaces with
r and E r ′ . By Theorem 6.4, we have r = r
D18
max (2, D18 ) = 8 and
8
′
r = rmax (2, E8 ) = 4.
• Let E1 and E2 be elliptic curves, ordinary and supersingular respectively. Let X = Km(E1 × E2 ), i.e. X is the minimal resolution of
(E1 × E2 )/{±1}. By [Shi74, Section 6(b)] and [Art75, Examples],
Sing(X) is 2D82 . Hence by Theorem 6.4, ht(X) = 2. Consider the
elliptic fibrations fj : X = Km(E1 × E2 ) → (E1 × E2 )/{±1} →
Ej /{±1} ∼
= P1 . They admit sections and, by [Shi74, Section 4],

NON-TAUT RDPS AND THE HEIGHT OF K3 SURFACES

25

the singular fibers of f1 and f2 are 2II∗ and 1I∗12 respectively. In
either case, the union of a section and the singular fiber(s) contains
a configuration of type D17 and one of type E8 .
• Let X be the elliptic RDP K3 surface y 2 + yxt2 + x3 + t5 = 0,
y 2 + yx + x3 + s7 = 0. The singular fibers of its resolution are II∗
and I7 , hence the union of a section and the singular fibers contains a
configuration of type D15 and one of type E8 . We have two proofs for
ht(X) = 3. (1) Counting #(X(F2n )) (before taking the resolution),
we obtain #X(F2 ) = 1 + 22 + 2 · 2, #X(F4 ) = 1 + 42 + 4 · 2, and
#X(F8 ) = 45 = 1 + 82 + 8 · (−5/2), hence ht(X) = 3 by Proposition
5.8. (2) Let X̃ be the (smooth) elliptic K3 surface in characteristic
0 defined by the same equation. Since X̃ admits an automorphism
((x, y, s) 7→ (x, y, ζ7 s)) acting on H 0 (X̃, Ω2 ) by a primitive 7-th root
of unity, X̃ has complex multiplication by Q(ζ7 ). Hence the mod 2
reduction X of X̃ has ht(X) = 3 by Theorem 5.9.
• The quasi-elliptic K3 surface y 2 = x3 +t2 x+t11 (given by Dolgachev–
Kondo [DK03, Theorem 1.1]) admits a fiber of type I∗16 at t = 0. The
union of a section and the singular fibers contains a configuration of
type D21 and one of type E8 . Since 21 6< 22 − 2h for any 1 ≤ h < ∞,
this K3 surface is supersingular.
Example 8.2 (p = 3).
(1) X : y 2 + x3 + t2 x2 + t5 + t6 + t7 = 0. Sing(X) = 2E82 + A2 .
(2) X : y 2 + x3 + t3 x2 + t5 = 0. Sing(X) = E81 + D8 .
(3) X : y 2 + x3 + t5 + t7 = 0. Sing(X) = 2E80 + 2A2 .
Example 8.3 (p = 5). As in [Mat21, Example 10.11], y 2 = x3 +at4 x+t+t11
is an RDP K3 surface with 2E81 (resp. 2E80 ) if a 6= 0 (resp. a = 0).

Acknowledgments. I thank Hiroyuki Ito, Kazuhiro Ito, Teruhisa Koshikawa,
Hisanori Ohashi, and Fuetaro Yobuko for helpful comments and discussions.
References
[Art75] M. Artin, Wildly ramified Z/2 actions in dimension two, Proc. Amer. Math.
Soc. 52 (1975), 60–64.
, Coverings of the rational double points in characteristic p, Complex
[Art77]
analysis and algebraic geometry, Iwanami Shoten, Tokyo, 1977, pp. 11–22.
[AM77] M. Artin and B. Mazur, Formal groups arising from algebraic varieties, Ann.
Sci. École Norm. Sup. (4) 10 (1977), no. 1, 87–131.
[Bor11] James Borger, The basic geometry of Witt vectors. II: Spaces, Math. Ann. 351
(2011), no. 4, 877–933.
[DK09] Igor V. Dolgachev and JongHae Keum, Finite groups of symplectic automorphisms of K3 surfaces in positive characteristic, Ann. of Math. (2) 169 (2009),
no. 1, 269–313.
[DK03] I. Dolgachev and S. Kondō, A supersingular K3 surface in characteristic 2 and
the Leech lattice, Int. Math. Res. Not. 1 (2003), 1–23.
[vdGK00] G. van der Geer and T. Katsura, On a stratification of the moduli of K3 surfaces, J. Eur. Math. Soc. (JEMS) 2 (2000), no. 3, 259–290.
[Hal71] Marshall Hall Jr., The Diophantine equation x3 −y 2 = k, Computers in number
theory (Proc. Sci. Res. Council Atlas Sympos. No. 2, Oxford, 1969), Academic
Press, London, 1971, pp. 173–198.
[Har67] Robin Hartshorne, Local cohomology, A seminar given by A. Grothendieck,
Harvard University, Fall, vol. 1961, Springer-Verlag, Berlin-New York, 1967.

26

YUYA MATSUMOTO

[Har77]
[Haz12]
[Huy16]
[Ill75]

[Ill79]
[Ito18]
[Jan16]

[LM18]
[Mat21]
[Sch06]
[ST06]
[Shi04]
[Shi09]
[SZ15]
[Shi74]
[Shi03]

, Algebraic geometry, Springer-Verlag, New York, 1977. Graduate Texts
in Mathematics, No. 52.
Michiel Hazewinkel, Formal groups and applications, AMS Chelsea Publishing,
Providence, RI, 2012. Corrected reprint of the 1978 original.
Daniel Huybrechts, Lectures on K3 Surfaces, Cambridge Studies in Advanced
Mathematics, vol. 158, Cambridge University Press, Cambridge, 2016.
Luc Illusie, Report on crystalline cohomology, Algebraic geometry (Proc. Sympos. Pure Math., Vol. 29, Humboldt State Univ., Arcata, Calif., 1974), Amer.
Math. Soc., Providence, R.I., 1975, pp. 459–478.
, Complexe de de Rham-Witt et cohomologie cristalline, Ann. Sci. École
Norm. Sup. (4) 12 (1979), no. 4, 501–661 (French).
Kazuhiro Ito, On the Supersingular Reduction of K3 Surfaces with Complex
Multiplication, International Mathematics Research Notices (2018).
Junmyeong Jang, The representations of the automorphism groups and the
Frobenius invariants of K3 surfaces, Michigan Math. J. 65 (2016), no. 1, 147–
163.
Max Lieblich and Davesh Maulik, A note on the cone conjecture for K3 surfaces
in positive characteristic, Math. Res. Lett. 25 (2018), no. 6, 1879–1891.
Yuya Matsumoto, µp - and αp -actions on K3 surfaces in characteristic p (2021),
available at http://arxiv.org/abs/1812.03466v5.
Matthias Schütt, The maximal singular fibres of elliptic K3 surfaces, Arch.
Math. (Basel) 87 (2006), no. 4, 309–319.
Matthias Schütt and Jaap Top, Arithmetic of the [19, 1, 1, 1, 1, 1] fibration, Comment. Math. Univ. St. Pauli 55 (2006), no. 1, 9–16.
Ichiro Shimada, Rational double points on supersingular K3 surfaces, Math.
Comp. 73 (2004), no. 248, 1989–2017.
, Transcendental lattices and supersingular reduction lattices of a singular K3 surface, Trans. Amer. Math. Soc. 361 (2009), no. 2, 909–949.
Ichiro Shimada and De-Qi Zhang, Dynkin diagrams of rank 20 on supersingular
K3 surfaces, Sci. China Math. 58 (2015), no. 3, 543–552.
Tetsuji Shioda, Kummer surfaces in characteristic 2, Proc. Japan Acad. 50
(1974), 718–722.
, The elliptic K3 surfaces with a maximal singular fibre, C. R. Math.
Acad. Sci. Paris 337 (2003), no. 7, 461–466 (English, with English and French
summaries).

Department of Mathematics, Faculty of Science and Technology, Tokyo
University of Science, 2641 Yamazaki, Noda, Chiba, 278-8510, Japan
Email address: matsumoto.yuya.m@gmail.com
Email address: matsumoto_yuya@ma.noda.tus.ac.jp

