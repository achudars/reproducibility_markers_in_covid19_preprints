VERTEX ALGEBRAS AND TEICHMÜLLER MODULAR FORMS

arXiv:1901.03079v2 [math.AG] 5 Feb 2020

GIULIO CODOGNI

Abstract. We associate to any holomorphic vertex algebra a collection of Teichmüller modular
forms, one in each genus. In genus one we obtain the character of the vertex algebra, and we thus
reprove Zhu’s modularity result. In higher genus, we prove that these forms have an expansion in
terms of the correlation functions of the vertex algebra. We propose applications to the Schottky
problem, to the study of the slope of the effective cone of the moduli space of curves, and to the
classification of holomorphic vertex algebras. In particular, we prove a uniqueness result for high
genera partition functions of the moonshine vertex algebra.

1. Introduction
The first goal of this paper, achieved in Section 4, is to prove the following theorem.
Theorem 1.1. Let V be a holomorphic vertex algebra of central charge c. Let Mg,n be the moduli
space of complex Deligne-Mumford stable curves of genus g with n marked points. Denote by λg,n
the Hodge line bundle over Mg,n . Then, for every g and n, we can associate a non-zero section
c
1 = 1g,n (V ) of λ⊗ 2 to V , called partition function. This section is preserved by all clutching and
projection morphisms between moduli spaces.
From a physical point of view, the forms constructed in Theorem 1.1 should be the partition
functions of the physical theory associated to the vertex algebra.; it is denoted by 1 because it is
associated to the vacuum vector of V , which is the replacement of the unit in the vertex algebras
set-up. The partition function encodes many information about the vertex algebra V .
The construction of the partition function goes roughly speaking as follows. For every curve C,
using the vertex operator, we define a map from V tensored by a convenient space of meromorphic
forms on C to End(V ). We then consider the covariant H of this action, namely H is the quotient
V by IV , where I is the ideal in End(V ) generated by the image of the above map. Varying C,
c
this construction gives a line bundle on the moduli space, which is canonically isomorphic to λ⊗ 2 ;
in the literature, H is usually called the bundles of covacua. The image of the vacuum vector 1 in
H gives the partition function.
The second goal of this paper is to study expansion of the partition function around the boundary
divisor δ0 of Mg (from now on, we take n = 0), and propose some applications. Before describing
briefly this expansion, let us assure the reader that all notations will be properly explained in the
main body of the paper. Given a point in δ0 representing a curve whose normalization is the
projective line, the Schottky coordinates provide a natural local chart around it, see Section 2.6.
2010 Mathematics Subject Classification. 14J15,17B69 (primary), 32G15,14H42,14H10 (secondary).
Key words and phrases. Moduli space of curves, conformal vertex algebras, Teichmüller modular forms, partition
functions, Schottky problem, theta series.
1

Given k vectors ui of V and k formal parameters xi , we can define their correlation function as
Z(u1 , . . . , uk ; x1 , . . . , xk ) := φ(Y (w1 , x1 ) · · · Y (wk , xk )1) ,

where Y is the vertex operator, 1 is the vacuum vector and φ is its dual (in the bra-ket notations
1 = |1i and φ = h1|).
Given a vector k ∈ Ng , let
X
(g) ig
(1) i1
; w1 , z1 , . . . , wg , zg ) ,
, . . . , vig , v(g)
Z(vi1 , v(1)
χk =
(i1 ,...,ig )

(j)

i
are hortonormal basis for Vkj , and the sum run over all values of (i1 , . . . ig ) in
where vi and v(j)
g
×j=1 {1, . . . , dim Vkj }. the function χk depends on the variables wi and zi . Then our expansion for
the partition function is
X
χk (w1 , . . . , wg , z1 , . . . , zg )q1k1 · · · qgkg
(1)
1g (V ) =
k∈Ng

where wi , zi and qi are the above mentioned Schottky coordinates1.
We also prove the following theorem

Corollary 1.2 (= Corollary 5.10). Let V be a holomorphic vertex algebra of central charge c. For
any g ≥ 1, the right hand side of Equation 1 defines a holomorphic function on the Schottky space
Sg ; up to multiplying it by a holomorphic function which does not depend on V , its pull-back to
the Teichmüller space Tg transforms under the action of the mapping class group as a Teichmüller
modular form of weight 21 c.
Specializing to the case g = 1, we obtain the following result, due in full generality to Zhu
[Zhu96]. Our proof is different from the original one, as we do not analyze the explicit action of
SL(2, Z).
Corollary 1.3 (= Corollary 5.11 ). Let V be a holomorphic vertex algebra of central charge c, and
V = ⊕n∈N Vn its conformal grading. Then, the formal power series

!c 
∞
Y
X
(1 − q n ) 
dim(Vn )q n 
n=1

n≥0

converges in the unit disc ∆ inside the complex plane, and it is a modular form of weight

1
2 c.

The following conjecture is very natural, especially from the point of view of physics, however
its proof seems out of reach at the moment.
Conjecture 1.4. If two holomorphic vertex algebras of the same central charge have the same
partition function in all genera, then they are isomorphic.
These results can be applied to the classification of vertex algebras; we illustrate our approach
with two examples.
The moonshine vertex algebra V ♮ is one of the most important examples of vertex algebras, it has
been used by Richard Borcherds to prove the Conway-Norton moonshine conjecture; it has central
1The moduli space has dimension 3g − 3, whereas this expansion depends on 3g − 2 variables; we will see that
this functions does not change if we scale the wi and zi by a common factor.
2

charge 24 and V1♮ = 0, and it is a long-standing open conjecture that it is the unique holomorphic
vertex algebras with these two properties.
Corollary 1.5 (=Corollary 6.5). Let V be a holomorphic vertex algebra of central charge 24 with
V1 = 0. Then the partition function of V is equal to the partition function of the moonshine vertex
algebra for all g ≤ 6.
If there exists an integer g0 such that the slope sg of the effective cone of the moduli space of
genus g curves is strictly greater than 6 for all g ≤ g0 , then the partition function of V is equal to
the partition function of the moonshine vertex algebra for all g ≤ g0
Let us recall that many experts believe, for reasons which are completely independent from
vertex algebras, that sg > 6 for all g. This fact, in conjunction with Conjecture 1.4, would prove
the uniqueness of the moonshine vertex algebra.
Another important problem in the theory of vertex algebra is to understand if there are only
finitely many holomorphic vertex algebra of a given central charge. In the following corollary, by
partition function we mean the full collection {1g (V )}g≥1 .
Corollary 1.6 (= Corollary 6.6). Fix a central charge c, then there are countably many possibilities
for the partition functions of holomorphic vertex algebras of central charge c.
⊗c
If there exists a constant C depending only on c such that h0 (Mg , λg 2 ) ≤ C for all g, then
there are at most C possibilities for the partition functions of holomorphic vertex algebras of central
charge c.
Our approach also gives a way to prove results about the moduli space of curves using the theory
of vertex algebras. In Section 6.2, we explain how our approach can be applied to the Schottky
problem. As an example, we give an alternative proof of the following result from [CSB14, GSM11].
Corollary 1.7 (= Corollary 6.3). The Siegel modular form ΘE8 ⊕E8 ,5 − ΘD+ ,5 defined on A5 is
16
not identically zero on M5 .
The first part of Theorem 6.1 explains how our approach could be used to bound the slope of the
effective cone of divisors of the moduli space of curves, but we do not give any concrete example.
We think that these topics deserve further investigations.
Remark 1.8 (Generalization to vector valued modular forms and non-holomorphic vertex algebras). The results of this paper could be extended to vertex algebras with more than one representation, i.e. to non-holomorphic vertex algebras. The key change should be the convenient
generalization of the factorization theorem 3.7, see also Remark 3.8 and the main result of [DGTb].
In this case, the partition function would become a section of a vector bundle whose rank depends
on g and n.
1.1. Relation with other works. This project started in 2013, trying to understand the relation
between the papers [GV09, GKV10] and the author’s Ph.D. thesis [Cod14]. Another important
source of inspiration was [HvH16].
Partition functions of lattice vertex algebras have been studied systematically by Mason and
Tuite, see [MT14, MT03, MT10]. However, their point of view is quite different from ours: they try
to define it out if its expansion around the boundary and then they try to prove the convergence,
rather than defining the partition function directly on the full moduli space and then studying its
3

expansion. After that the first version of this paper has appeared, Tuite and Welby published the
paper [MPT], which is now used in the present work.
Our definition of conformal blocks and covacua is a mix of the ones given in [FBZ04], and the
ones given in [Uen08, Uen95]; as explained in [FBZ04, Chapter 9.7], they all agree on smooth
curves, and on vertex algebras defined out of Kac-Moody groups. The main properties of these
objects, which are the naturality 3.5, the propagation of vacua 3.6, and the factorization 3.7 are
expected to hold for any sort of conformal field theory. Our proofs are inspired by the arguments
explained in [Uen08]. After the first version of this paper has appeared, Gibney, Damiolini and
Tarasca published the series of papers [DGTa, DGTb, DGTc] where they generalize the results of
our Section 3 to non-holomorphic vertex algebras. Their construction is similar in spirit to ours;
they do not consider partition functions at all.
There is another approach to these topic which relies on chiral algebras rather than on vertex
algebras, see [BD04, Gai99] and [FBZ04, Chapter 19]. Chiral algebras are already defined on
Riemann surfaces; on the other hand, vertex algebras are defined independently of Riemann surfaces
and, to make the connection, we need to interpret the parameter z appearing in the definition of
vertex algebra as formal co-ordinate on a curve. We decided to focus on vertex algebras mainly
because we wanted to translate some problems and features of the moduli space of curves into
concrete and explicit traces of operators over vertex algebras, hoping that this could lead to further
developments.
1.2. Acknowledgments. We gratefully thank Enrico Arbarello, Alessandro D’Andrea, Jethro van
Ekeren, Gabi Farkas, Sam Grushevsky, Reimundo Heluani, Marco Matone, Riccardo Salvati Manni,
Nick Shepherd-Barron, Michael Tuite, Filippo Viviani and Roberto Volpato for useful conversations
about the topics of this paper.
2. Preliminaries
2.1. Holomorphic vertex algebras. The notion of vertex operator arose first physics, and was
then formalized with the introduction of vertex operator algebras, or vertex algebras for short, by
Richard Borcherds. In this paper we are interested in conformal vertex operator algebras, and their
connection with Riemann surfaces. Let us recall the basic definition and establish some notations,
the reader can look at [FBZ04, MT10, FHL93] for a more comprehensive exposition.
Definition 2.1. A conformal vertex operator algebra with central charge c ∈ N, or vertex algebra
for short, consist of
• An N-graded complex vector space V = ⊕n Vn such that dim V0 = 1 and dim Vn < +∞ for
all n; this is sometime called space of states, and the grading is called conformal degree;
• a linear map, called vertex operator or states-fields correspondence,

Y : V → End(V )[[z ±1 ]] ;
P
for each element v in V , one writes Y (v, z) = n∈Z vn z −n−1 , so that vn = Res0 (z n Y (v, z)dz).
The endomorphisms vn are called modes of v;
• a non-zero vector 1 ∈ V0 , called vacuum vector, such that Y (1, z) = IdV and satisfying the
vacuum or creativity axiom:
Y (v, z)1|z=0 = v ,
Sometime we will write 1V rather than 1 if we want to specify the vertex algebra;
4

• a non-zeroPvector ω ∈ V2 called conformal vector, whose mode are usually denoted as
Y (ω, z) = n∈Z Ln z −n−2 rather than ωn+1 , such that
[Ln , Lm ] = (m − n)Lm+n + c

m3 − m
δm,−n IdV
12

d
Y (v, z)
dz
Vn = {v ∈ V | L0 v = nV }

[L−1 , Y (v, z)] =

the operator L0 is sometime called the grading operator, and L−1 is sometime denoted by
T and called the translation operator. The field Y (ω, z) is called the Virasoro field or the
stress-energy tensor.
Moreover one asks for the following property
Locality: For any two vectors v and w in V there exists an integer k such that
(z1 − z2 )k [Y (v, z1 ), Y (w, z2 )] = 0 ;
Cn cofiniteness: Let Cn (V ) = {v−n w | v, w ∈ V }, we say that V is Cn cofinite if V /Cn (V )
is finite dimensional; we will assume Cn cofiniteness for all n ≥ 2;
Rational: A vertex algebra is called rational if all modules are semisimple (see Definition
2.5). In this paper we will consider just rational vertex algebras.
Some comments are in order. Vertex algebras can be thought as a quantization of the notion of
algebra; indeed and algebra can be defined as a vector space A and a linear map m : A → End(A)
given by the multiplication, the vacuum vector replace the identity.
Locality is probably the most delicate axiom, in some sense replace associativity, we refer the
reader to the [FBZ04] or [MT10] for extensive discussions.
The modes Ln spans inside End(V ) a copy of the Virasoro algebra; V is thus a representation of
the Virasoro algebra of central charge c. In the application to Riemann surfaces, z will be a local
co-ordinates and the Virasoro algebra will be the Lie algebra of the group of change of co-ordinates;
we will give more details about this in Section 2.4.
The C2 cofineteness condition implies the Cn cofiniteness condition for all n ≥ 2, see [MT10,
Section 6.2] or [Buh02] and reference therein.
We will need also the following result, whose proof can be found in [Buh02, Li99, GN03].
Theorem 2.2 (Finite generation). There exist a countable collection of elements {v (i) } in V such
(j )
that the monomials Πℓi=1 vnii 1 span V .
The monomials appearing in Theorem 2.2 could be thought as a replacement of the PoincaréBirkhoff-Witt basis, see [FBZ04, Page 37 and Section 4.4]; let us stress that in this case the monomials are not meant to be linearly independent. It is convenient for us to give the following definition
Definition 2.3. A Poincaré-Birkhoff-Witt basis (PBW basis for short) is a basis of V obtained by
taking a subset of the monomials introduced in Theorem 2.2.
We finish this section by spelling out the following lemma for later uses.
Lemma 2.4. The vacuum vector is annihilated by the operators Ln for all n ≥ 0.
Proof. As 1 ∈ V0 , L0 1 = 0. The endomorphism Ln is homogeneus of degree −n, see e.g. [MT10,
Section 4.1], since Vn = {0} for all n < 0, we obtain the lemma.

5

We recall the notion of module for a vertex algebra. We give directly the strongest definition,
which is the one we are interested in.
Definition 2.5. A module M of conformal weight h ∈ N for a vertex algebra V is
• an N-graded vector space M = ⊕n Mn , with dim Mn < +∞; the subspace M0 is called top
level, or space of singular vectors; elements of M0 are called singular vectors;
• a linear map
YM : V → End(M )[[z ±1 ]]
P
which one writes out as YM (v, z) = vnM z −n−1 such that:
Vacuum axiom: YM (1, z) = IdM ;
Grading: we have
Mn = {m ∈ M | LM
0 m = (n + h)m}

P M −n−2
where LM
Ln z
;
0 is the operator appearing in the expansion YM (ω, z) =
Homogeneity: if v is in Vk , then vnM maps Mm to Mm+k−n−1 ;
Locality: For any two vectors v and w in V there exists an integer k such that
(z1 − z2 )k [YM (v, z1 ), YM (w, z2 )] = 0 ;

Associativity: For any v and w in V and m in M there exists an integer k such that
(z1 + z2 )k YM (v, z1 + z2 )YM (w, z2 )m = (z1 + z2 )k YM ((v, z1 )w, z2 )m .
The elementary categorical notions such as morphisms of modules, sub-modules and simple
modules are defined as expected, see for instance [FHL93, Section 4.3].
Every vertex algebra is a module over itself. The restricted dual space
V ∨ = ⊕n Vn∨

has also a structure of V -module, see for instance [FBZ04, Proposition 10.4.6] or [FHL93, Section
5.2]. In this paper, we will use the terms dual and restricted dual interchangeably. The module V ∨
is also called the controgradient module of V . A map ∇ of V -modules from V to V ∨ is equivalent
to a bilinear V -invariant form Q∇ on V ; the grading of V gives an orthogonal decomposition for
such a form, see [FHL93, Remark 5.3.3]. When ∇ is an isomorphism, this quadratic form has to
be symmetric, see [FHL93, Proposition 5.3.6]. If the vertex algebra V is simple, an isomorphism
between V and V ∨ , and hence the associated symmetric form, is necessarily unique up to a scalar;
this because we are working over the complex numbers, and one can run the standard argument.
We can normalize the quadratic form by requiring that the vacuum vector has norm one. If V and
V ∨ are isomorphic, V is said to be self-controgradient.
One of the main result about representation theory of vertex algebras is the following.
Theorem 2.6. There exists only finitely many simple representations up to isomorphism.
For every module M , one can take a countable collection of elements {v (i) } in V , a basis mi of
(j )
the top level M0 , such that the monomials Πℓi=1 vnii mj span M .
Moreover, for every n ≥ 2 let Sn (M ) = {v−n m|v ∈ V and m ∈ M0 }, then the quotient M/Sn (M )
is finite dimensional.
The letter S in the theorem stands for the initial of singular vectors. The proof relies on the C2
cofiniteness condition of V , the reader can look at [MT10, Theorem 6.13 and subsequent remark]
or [Buh02, Li99, GN03] and references therein. It is convenient for us to generalize Definition 2.3
as follows.
6

Definition 2.7. A Poincaré-Birkhoff-Witt basis (PBW basis for short) for a V module M is a
basis of M obtained by taking a subset of the monomials appearing in Theorem 2.6.
In this paper we are mainly interested in the following type of vertex algebras.
Definition 2.8 (Holomorphic vertex algebra). A vertex algebra is called holomorphic if it admits
a unique module up to isomorphism,
Remark that holomoprhic vertex algebras are in particular self-contragradient.
2.2. Lattice Vertex Algebras. Let (Λ, Q) be an even, unimodular, positive define lattice of rank
d. More explicitly, Λ is a group isomorphic to Zd , and Q is symmetric quadratic form on Λ which
is Z-valued, unimodular, even (i.e. Q(v, v) is even for all v ∈ Λ) and positive definite.
These quadratic forms are widely studied. To start with, their rank is divisible by 8. Fixed
the rank, there are finitely many quadratic form of that rank; this follow from the so called mass
formula.
In rank 8 we have just one quadratic form E8 . In rank 16 we have to quadratic forms, E8 ⊕ E8
+
and D16
. In rank 24 we have exactly 24 quadratic forms. In rank 32, the forms are already many
million, and there is no classifications, see [Kin03]
It is possible to attach a vertex algebra of central charge d to a rank d quadratic form; we
refer the reader to [Don93], [FBZ04, Section 5.4.1] or [MT10, Section 7.3] for their definition and
properties. These vertex algebras are called lattice vertex algebras, they are simple, and the number
of representation is equal to determinant of the quadratic form. In particular, the vertex algebra
associated to an unimodular quadratic form is holomorphic.
The vertex algebra associated to the lattice E8 is isomorphic to the vertex algebra associated to
the affine Kac-Moody group of E8 .
2.3. Stable curves. We work over the field of complex numbers and use the Euclidean topology.
We recall the relevant definition for our paper; we refer the reader to [ACG11] for a complete
discussion, and to [Uen08, Chapter 1] for a shorter introduction.
Definition 2.9. A genus g Deligne-Mumford stable curve over a base B with n marked points is a
variety X together with a projective flat morphism π : X → B and n sections x1 , . . . , xn of π such
that
• for every b ∈ B, the fibers of Xt = π −1 (b) has complex dimension one, genus g, at worst
nodal singularities and finite automorphism group;
• the images xi (b) lie in the smooth locus of Xb and do not intersect.
The sections xi are sometime denoted with letters a, b, . . . . Sometime we use the name of the section
also for its image. Smooth curves are called Riemann surfaces.
We denote by ωπ the relative canonical sheaf of the morphism π.
Sometime, a curve over B is called a family of curves over B, and co-ordinates on B are called
the moduli of the family.
Given
P a vector of positive integers
P k = (k1 , . . . , kn ), we can look at the line bundles OX (kx) :=
OX ( ki xi (B)) and ωπ (kx) = ωπ ( ki xi (B)) on X. Given two such vectors k and j, we say that
k ≥ j if ki ≥ ji for every i. If k ≥ j, we have a natural injective map from OX (jx) to OX (kx) and
from ωπ (jx) to ωπ (kx); this defines a direct system and we can let
π∗ OX (∗x) = lim π∗ OX (kx)
k

,
7

π∗ ωπ (∗x) = lim π∗ ωπ (kx) .
k

These are the sheaves of meromorphic functions and meromorphic forms with algebraic singularities
at the marked points xi . We will need the following lemma.
Lemma 2.10. Given a morphism f : T → B, let πT : XT → T be the fiber product, and denote
still by xi the pull-back of the sections. Then, the natural pull-back maps
f ∗ : π∗ OX (∗x) → (πT )∗ OXT (∗x) and f ∗ : π∗ ωπ (∗x) → (πT )∗ ωπT (∗x)

are surjective.

Proof. We prove the statement just for OX (∗x), the other proof being analogue. We have to show
that for k big enough the map
fk∗ : π∗ OX (kx) → (πT )∗ OXT (kx)

is P
surjective. If f is flat, fk is surjective for all k by the standard base change theorem. In general,
if
ki is bigger than the genus g, the cohomology groups appearing in the proof of the base change
theorem do vanish, hence fk is surjective.

2.4. Local co-ordinate on a curve. The formal variable z appearing in the definition of vertex
algebra will play the role of local co-ordinate on a Riemann surface; to make this precise, we need
first to recall a few facts about the formal definition of local co-ordinate and discuss change of
co-ordinates, we will follow [FBZ04, Chapter 6].
We recall the notion of standard disc, following mainly [FBZ04, Appendix A.1.1 and Section
6.2]. The standard disc D over the complex numbers is Spec O, where O = C[[z]]; it contains two
points, the closed point and the generic point. The maximal ideal of C[[z]] is zC[[z]], and z is his
preferred generator. A local co-ordinate on D is the choice of a generator of the maximal ideal of
O, or, equivalently, the choice of an isomorphism between O and C[[z]]. For a C-algebra R, one
can look at the disc Spec(O ⊗ R).
The group Aut(O) of automorphism of D is a group scheme whose Lie algebra is isomorphic to
d
d
zC[[z]] dz
. The identification Ln = −z n+1 dz
gives an isomorphism between this Lie algebra and
the subalgebra of the Virasoro algebra spanned by the modes {Ln }n≥0 . Let us stress for later uses
that, as noticed in Lemma 2.4, this Lie algebra annihilates the vacuum vector.
Given a vertex algebra V and a module M (possibly equal to V ), we would like to integrate the
action of the Virasoro algebra obtained out of the modes of the conformal vector ω to an action
of Aut(O). This is always possible because the action of L0 is diagonal with integer eigenvalues,
and, since dim Mn = 0 for n < 0, the action of L1 is locally nilpotent. We conclude that Aut(O)
acts naturally on both V and M . The equivariance of the action of V on M is proven in [FBZ04,
Lemma 6.5.6].
Let now (X, x) be a stable pointed curve over a smooth base B. A local co-ordinate at x is an
isomorphism between the completion of the local ring OX,x and OB [[z]]. The automorphism group
Aut(O) is a group scheme over B, and the sheaf on B of local co-ordinate at x is denoted by Cox
and it is a torsor under natural action of Aut(O). When marked points are denoted by xi , then we
use the notation Coi for Coxi , and Auti ∼
= Aut(O) for the automorphism group of Coi
We collect here some existence results that we will need later on.
Theorem 2.11. Let (X, x1 , . . . , xn ) be a curve; fix local co-ordinates zi at xi for every i.
Fix strictly positive integers M , t < n and mi < M for i = 1, . . . , t. Up to shrinking B, there
exists a relative meromorphic differential ω on X such that
(1) ω has poles along xi for i > t, and it is regular elsewhere;
8

(2) for i ≤ t < n, locally around xi , the expansion of ω in term of zi is
(zimi + z Mi gi (zi ))dzi

where Mi is a positive integer bigger than M and gi is a power series in zi .
Proof. Let Ti (M ) be the sheaf of Taylor expansion at xi of order up to M . For every positive
integer K, we have an exact sequence




M
X
X
X
Tj (M ) → 0
xj  →
xj − M
xj  → ωπ K
0 → ωπ K
j>t

j>t

j≤t

j≤t

  P

→
If K is big enough then R1 π∗ ωπ (K j>t xj −M j≤t xj ) = 0, so the map H 0 ωπ K j>t xj
L

m
j
H0
j≤t Tj (M ) is surjective. The requested form is any element in the preimage of ⊕j≤t zj .

P

P

2.5. Kuranishi families and Schottky co-ordinates. A Kuranishi family is a stable curve
X → B such that for every point b in B, and every other stable curve Y → S such that there exists
a point s in S with Yb isomorphic to Xb , there exists, up to shrinking X around b and Y around s,
a unique map f : S → B such that Y is isomorphic to the fiber product S ×B X. Here, we collect
some of their properties, the reader can look at [ACG11, Section XI.4] or [Uen08, Section 1.2] for
a more comprehensive introduction.
Given a point b on the base B of a Kuranishi family, there exists a canonical isomorphism,
called
P
Kodaira-Spencer map, between the tangent space of B at b and H 1 (X
,
T
(−
x
(b)),
where
xi
b
X
i
b
P
are the marked points. ByPbase change, we have that H 1 (Xb , TXb (− xi (b)) is isomorphic to the
fiber at b of P
R1 π∗ Tπ X(− xi (B)), and , more generally, the tangent space T B is isomorphic to
1
R π∗ Tπ X(− xi (B)).
We now discuss the variation of singularities in a Kuranishi family π : X → B, and their resolution. This should be compared with [ACG11, Chapter XI, Theorem 3.17] and [Uen08, Section
4.3.1].
Let b be a point of B such that the fiber Xb is singular; we work locally around b, and in to
perform the following construction one might have to shrink B. Let n be a node of Xb , and assume
for simplicity that it is the unique node. Then, there exist a local co-ordinate q on B such that
around n the curve X is isomorphic to {xy = q} × Z ⊂ C3 × Z, where Z = {q = 0} ⊂ B. The
locus Z parametrizes deformations which are trivial around n, so that the node is preserved, and
conversely, when q 6= 0, the node is smoothed out. We call q a smoothing co-ordinate, or smoothing
parameter, associated to n, and Z the locus of equisingular curves.
Let XZ be the base change of X to Z. Up to shrinking Z, we have a section, which by abuse of
notation we still denote by n, whose image is the singular locus of π around our original node n; in
particular, for every z in Z, n(z) is a node for Xz . We can now look at the blow-up ν : X̂Z → XZ
of n(Z); let a and b be the preimage of n, so a and b are section of X̂Z : → Z . In this way, we
obtained either a family of smooth curves of genus g − 1, with two extra marked points, a and b; or
two families of smooth curves of genus respectively h and g − h for some h, each one with an extra
marked point. Moreover, around a and b we have two distinguished local co-ordinates, which are
the the pull-back of x and y from the local description of X around n given above.
If Xb has more then one node, we can repeat the above construction enhancing the notation. So
denote the nodes by ni , the smoothing parameter by qi . The locus Z is given by {Πi qi = 0}, so
it is a a simple normal crossing divisor. If we base change to Z and shrink Z, we blow-up all the
9

ni (Z), and we obtain new marked points ai and bi with distinguished local co-oridnates zi and wi .
Recall that in this case X̂Z can be the disjoint union of many different families of curves.
If π : X → B is not a Kuranishi family, the above construction still make sense, we just have to
pull-back the qi from the Kuranishi family. However, it might be that a node n is not be smoothed
out on B, i.e. the pull-back of the corresponding smoothing co-ordinates is identically trivial; this
is tautologically true in the case where B is the locus Z constructed above. We call such a node a
horizontal node.
Let π : X → B be a Kuranishi family of nodal curves (with possibly one marked point), and
assume that there exists a point b0 in B such that the normalization of Xb0 is isomorphic to P1 ;
in particular Xb0 has g nodes. We call such a family a Schottky family. Let B ∗ be the locus
parametrizing smooth curves, and Z ⊂ B the equisingular locus of Xb0 . The locus Z parametrizes
the choice of g pairs of points on P1 (i.e. the preimages of the nodes via the normalization map),
this gives 2g co-ordinates zi and wi on Z. Due to the action of GL(2) on P1 , we can fix 3 points, so
we have 2g − 3 co-ordinates. We assume that 2 points are 0 and ∞, we still have a residual action
of Gm to mod out by. Normal co-ordinates to Z in B are g smoothing parameters qi , so that we
have 3g − 3 co-ordinates on B around b, as expected. In the presence of a marked point, we can
use the residual action of Gm to fix it at 1, so that the co-ordinates wi and zi are independent for
all i = 1, . . . , g − 1. We call these co-ordiantes Schottky co-ordinates
2.6. Schottky uniformization. In this subsection we follow mainly [Her15], see also [HS07, Section 5], [Kra90], [Ber75] and [GKV10, Appendix A2].
Let Fg be a free group on g generators s1 , . . . , sg . Given an embedding σ : Fg ֒→ P SL(2, C), let
γi := σ(si ) and Γ := σ(Fg ). An embedding σ is a genus g Schottky group if there exists disjoint
open discs Di and Di′ , for i = 1, . . . , g, in P1 such that γi (Di ) = Di′ , Γ acts properly discontinuously
on U := P1 \ ∪i (Di ∪ Di′ ), and the quotient U/Γ is a smooth genus g Riemann surface C. The
homology classes Ai of boundaries ai of Di depend just on σ, and they give a basis of a Lagrangian
subspace of H1 (C, Z).
Let S̃g be the set of genus g Schottky group, and Sg its quotient by the action of P SL(2, C) by
conjugation.
Let us first describe the g = 1 situation. For every [σ] in S1 , we can always find a representative
such that γ1 is of the form γ1 (z) = λz, with λ ∈ C and 0 < |λ| < 1. This shows that S1 is the
punctured unit disk in the complex plane ∆∗ . In this case, we can always assume that D1 and D1′
do not contain 1, so that the curve associated to γ has a marked point. Conversely any elliptic
curve can be obtained in this way, so that we get back the usual étale cover ∆∗ → M1,1 .
The following well-known result summarize the situation when g ≥ 2.
Theorem 2.12. Take g ≥ 2. The space Sg is an open subset of C3g−3 . There exists an open
subset Ωg of C3g−2 with a projection π : Ωg → Sg and a π-invariant action of Fg on Ωg such
that the quotient π : Ωg /Fg =: Cg → Sg is a family of smooth Riemann surfaces and the associated
moduli map to Mg is surjective with discrete infinite fibers. The universal cover of Sg is canonically
isomorphic to the Teichmüller space Tg .
Proof. We recall just the embedding of Sg in C3g−3 , because this defines meaningful co-ordinates
on Sg .
First, we can realize S̃g as an open subset of (P1 )×3g by taking the fixed points and the translation
length of each element γi (which can be shown to be hyperbolic). The quotient S̃g → Sg a natural
section obtained by choosing a representative s = (γ1 , . . . , γg ) of a point [s] ∈ Sg such that a1 has
10

an attractive fixed point at 0 and a repelling fixed point at ∞, and 1 is an attractive fixed point for
a2 . At first sight, this proves that Sg can be realized as an opens subset of (P1 )×3g−3 ); however,
the translation length of an hyperbolic element can never be ∞, and the fixed point can neither be
∞ because this is already taken by a1 , hence the embedding is in C3g−3 .

Taking the fiber product Cg ×Sg Cg over Cg , we obtain a family of curves with one marked point
(the section is the diagonal). This gives a surjection from Cg =: Sg,1 to Mg,1 .
The following result proven in [GH88] gives a compactification of the Schottky space called
extended Schottky space.
Theorem 2.13. There exists a 3g − 3 dimensional smooth complex manifold S g , called extended
Schottky space, with a family of DM-stable curves π : C g → S g , which contains π : Cg → Sg as an
open subset, and such that the associated moduli map towards Mg is surjective with infinite discrete
fibers. The complement of Sg in S g consists of divisors.
One can introduce the notion of Schottky structure for a family of Deligne-Mumford curves, and
both Sg and S g are fine moduli spaces for this structure.
Let π : C → B be a Schottky family. Fix a point b such that the normalization of Xb is P1 . Up
to shrinking B around b, fixing an ordering of the vanishing cycle, we obtain a Schottky structure,
hence a map B → S g . Restricting to the locus B ∗ parametrizing smooth curves, the Schottky
coordinates introduced at the end of Section 2.5 pull-back to the Schottky co-ordinates on B ∗ (see
also the proof of Theorem 2.12).
3. Conformal blocks and partition function
3.1. Definitions. Let π : X → B be a stable curve over a smooth base B with n marked points
x1 , . . . , xn , and V a vertex algebra. Let M1 , . . . Mn be V modules. The labeling of the modules
correspond to the labeling of the marked points, and we will say that Mi sits at xi ; if points are
labeled by letters a, b, . . . , then modules are labeled as Ma , Mb , . . . . When Mi is isomorphic to V
or V ∨ , we might write Vi or Vi∨ . The modules Mi do not need to be non-isomorphic, indeed we
will often take Mi = Vi ∼
= V for every i.
Using the notation of Section 2.4, we define a bundle Mi over B as (Mi × Coi )/ Auti . Up to
shrinking B, we can fix a global section of Coi and obtain an isomorphism between Mi and the
trivial sheaf Mi ⊗ OB . In particular, Mi is quasi-coherent, and locally it is a direct limit of locally
free coherent sheaves (⊕k<N Mk ) ⊗ OB . Let M = M1 ⊗ · · · ⊗ Mn , and V = V1 ⊗ · · · ⊗ Vn
Let f : T → B be a map, and XT the fiber product of X and T . The bundle Mi constructed on
T using the family XT is isomorphic to the pull-back of Mi via f .
For every T ֒→ B open, let UT the complement of {x1 (T ), . . . , xn (T )} in XT . Take T small
enough such that one has local co-ordinates around each xi We have a map of sheaves
!
n
M
Vi ⊗ ((πT )∗ ωπT (∗x)) → End(M)
Y:
i=1

which is defined as

Y

n
X
i=1

vi ⊗ ω

!

=

n
X

Resxi (f (zi )YMi (vi , zi )dzi )

i=1

where zi is a local co-ordinate at xi , and ω = fi dzi around xi (T ). This does not depend o the
choice of the local co-ordinate; see [FBZ04, Theorem 6.5.4 and Lemma 6.5.6], remark that the
quoted proof is given by a local argument. We will interchangeably use the notations Y(v, ω) and
11

Y(v ⊗ ω). Loosely speaking, the main difference between the operators Y and Y is that Y gives a
power series whose coefficients are endomorphisms, instead Y gives an actual endomorphism.
The image of Y is a sub sheaf of End(M) over B, which we denote by U (V ).
Definition 3.1 (Covacua and conformal blocks). The sheaf of covacua, or coinvariant, H(X, x1 , . . . , xn )
is the biggest quotient of M where the action of U (V ) is trivial. The sheaf of conformal blocks
C(X, x1 , . . . , xn ) is the sheaf of U (V )-invariant linear functional on M.
So far, these sheaves are quasi-coherent sheaves on B. The space of coinvariants can be also seen
as M/I(U (V )), where I(U (V )) is the ideal generated by U (V ) in End(M). Let us also stress that
these sheaves are dual sheaves.
Lemma 3.2. The quasi-coherent sheaves H(X, x1 , . . . , xn ) and C(X, x1 , . . . , xn ) are coherent.
Proof. Being dual to each other, it is enough to prove the claim for H = H(X, x1 , . . . , xn ). The
statement is local on B, so we can shrink B and fix local co-ordinates zi at xi ; the sheaf H is now a
quotient of M := OB ⊗B Mi ⊗ · · · ⊗ Mn . The argument is similar to the proof of [Uen08, Theorem
3.5], we sketch it.
We have a filtration Fp M = ⊕i1 +···in =p Mi1 ⊗ · · · ⊗ Min . This induces a filtration of H by
quasi-coherent sub-sheaves ; we are going to show that the associated graded object G is coherent.
By Riemann-Roch, the associated graded object is a quotient of q : OB ⊗B M/Sk (M ) → G, for
k big enough. The domain is a locally free sheaf of finite rank by Theorem 2.6. The kernel of q is
quasi-coherent (see for instance [Sta17, Tag 01Y1]), so G is coherent.

The vacuum vector 1 is annihilated by the Lie algebra of the group of change of co-ordinate, see
Lemma 2.4 and Section 2.4, hence it is invariant under the action of Aut(O). We conclude that the
vector 1 ⊗ · · · ⊗ 1, which by abuse of notations we still denote by 1, is a well defined section of V.
In the special case where M = V, we give the flowing definition.

Definition 3.3 (Partition Function). Let V be a vertex algebra, and take Mi ∼
= V for every i.
The partition function of the vertex algebra V on the stable curve π : X → B is the image of the
vacuum vector 1 in H(X, x1 , . . . , xn ). In other words, the partition function is a section of the sheaf
of coinvariants when M = V. Sometime we will denote it by 1g , 1V , 1g (V ) or 1(V ), if we want to
stress the genus or the vertex algebra.
The partition function does not have to be a constant section, it can vanish somewhere on B.
Remark 3.4 (Genus zero case). Take X = P1 × B, n = 1, and M1 = V . The space of covacua is
canonically isomorphic to the trivial bundle associated to the vector space V0 = C1, the partition
function is just 1. The space of conformal blocks is associated to Cφ, where φ(1) = 1 and Ker(φ) =
⊕n≥1 Vn . (In the bra-ket notation, φ is denoted by h1|.)
The following result is a consequence of Lemma 2.10.

Lemma 3.5 (Naturality). Let f : T → B be a morphism, then H(XT , x1 , . . . , xn ) ∼
= f ∗ H(X, x1 , . . . , xn ),
∗
∗
C(XT , x1 , . . . , xn ) ∼
= f C(X, x1 , . . . , xn ) and, if M = V, we have f 1 = 1.
3.2. Propagation of vacua. We keep the notations of the previous section. Taking the tensor
with 1, we have a natural map
ρ : M1 ⊗ · · · ⊗ Mn → M1 ⊗ · · · ⊗ Mn ⊗ V
12

As explained in Lemma 2.4 and Section 2.4, the vacuum vector 1 is fixed by the change of coordinates, hence this induces a map ρ : M → M ⊗ Vn+1 , where now V is sitting at the n + 1-th
marked point xn+1 = y. We have the following result:
Theorem 3.6 (Propagation of vacua). The morphism ρ defined above induces an isomorphism
ρ : H(X, x1 , . . . , xn ) → H(X, x1 , . . . , xn , y)

where y is the n + 1-th marked point on the curve. Moreover, when M = V, the morphism ρ
preserves the partition function.
Proof. The map ρ in the statement is defined as ρ([v]) = [ρ(v)], so we first we have to shows that
it is well defined. To this end, remark that regular differentials on U := X \ {x1 (B), . . . , xn (B)}
are in particular regular differentials on Uy := U \ y(B) = X \ {x1 (B), . . . , xn (B), y(B)}; for any
A ∈ V and any k > 0, we have that Ak 1 = 0, hence if a differential ω is regular at y we have that
Yn+1 (A, ω)v1 ⊗ · · · vn ⊗ 1 = 0 for any A in V . This shows that ρ is well-defined.
The statement about the partition function follows from the definition.
We now show that ρ is surjective. This can be proven locally on B, so we can fix local coordinates at xi and y. We have to show that any vector in H(X, x1 , . . . , xn , y) has a representative
v1 ⊗ · · · vn ⊗ w in M1 ⊗ · · · ⊗ Mn ⊗ Vn+1 which can be written as v1 ⊗ · · · vn ⊗ 1 + O(v1 ⊗ · · · vn ⊗ 1),
for some operator O in the ideal I(Uy (V )). We argue by induction on the conformal degree of w.
Write w = Ak w′ , where w′ has lower conformal degree, and A ∈ V . Let m0 be an integer such
that Am w′ = 0 for all m > m0 . By Theorem 2.11, we can take an abelian differential ω on U
such that in a local co-ordinate around y it looks like (z k + z m g(z))dz, where m > m0 and g is a
regular function on z (of course, we know nothing about the behavior of ω at xi ). We then have
Yn+1 (A ⊗ ω)w = Ak w. Now,
!
n
X
′
′
Yi (A, ω)v1 ⊗ · · · vn ⊗ w′
Y(A, ω) (v1 ⊗ · · · vn ⊗ w ) = v1 ⊗ · · · vn ⊗ (Ak w ) +
i=1

Pn
The right hand side is zero in H(X, x1 , . . . , xn , y), so it is enough to prove that ( i=1 Yi (A, ω)v1 ⊗ · · · vn )⊗
′
w is in the codomain of ρ. This holds by inductive hypothesis on the conformal degree of w′ .
To prove injectivity, we rather show the surjectivity of the dual map
ρ∨ : C(X, x1 , . . . , xn , y) → C(X, x1 , . . . , xn )

If the family is smooth, this is [FBZ04, Theorem 10.3.1], where an inverse of ρ∨ is exhibited. We now
prove surjectivity of ρ∨ in the general case using the PBW basis introduced in Definition 2.7 rather
than constructing an inverse; our argument is inspired by both the proofs of [FBZ04, Theorem
4.4.1] and [Uen08, Theorem 3.3.1]. Again, this is local on B, so we can fix local co-ordinates. Given
an element φ ∈ C(X, x1 , . . . , xn ), we want to define an element ψ ∈ C(X, x1 , . . . , xn , y) such that
ρ∨ (ψ) = φ. We let ψ(v1 ⊗ · · · ⊗ vn ⊗ 1) := φ(v1 ⊗ · · · ⊗ vn ). To define ψ(v1 ⊗ · · · ⊗ vn ⊗ w), we
choose a PBW basis, and by linearity we can assume that w is of the form
(t)

(1)

(j−1)

(1)

w = Akt · · · Ak1 1
where A(j) is an element of V . Let wj be Akj−1 · · · Ak1 1, so that wt = w. Take integers m0 such
(j)

that Am wj = 0 for all m > m0 and all j. Then, using Theorem 2.11, take abelian differentials ωj
on U such that in a local co-ordinate around y it looks like (z kj + z sj g(z))dz for some sj > mj ,
where g is a regular function on z. We let
ψ(v1 ⊗ · · · ⊗ vn ⊗ w) := (−1)t φ(Y(ω1 , A1 ) · · · Y(ωt , At )(v1 ⊗ · · · ⊗ vn ))
13

This does not depend on the choice of ω and gives the requested element. Invaraince can be checked
following the argument of the proof of [Uen08, Theorem 3.3.1].

We need to recall for later uses the expression of the inverse of ρ in the case where X is smooth
of genus zero. These results are proven in [FBZ04, Section 10.4]. We will also slightly twist the
notations for marked points, so that the statements are more suitable for later applications. Let
X be P1 × B, with 2g + 1 marked points a1 , . . . , ag , b1 , . . . , bg , and x. Let z be a co-ordinate on
P1 such that z(x) = 1, z(bg ) = 0 and z(ag ) = ∞; denote by zi and wi the value of z at ai and
bi . Let us put at the point ag the module V ∨ , for the others choose just V . The conformal block
C(X, ag , bg ) has a canonical element given by the pairing Φ0 between V and V ∨ ; moreover, thanks
to Theorem 3.6, if V ∼
= V ∨ , this is also isomorphic to the space C(X, x) discussed in Remark 3.4,
and the image of the pairing is a generator.
Under the isomorphism
(ρ∨ )−1 : C(P1 , ag , bg ) → C(P1 , a1 , . . . , ag , b1 , . . . bg , x)

given by Theorem 3.6, we have that
(2)
Φ0 (ψ⊗A1 ⊗· · · Ag−1 ⊗B1 ⊗· · ·⊗Bg ⊗1) = ψ(Y (A1 , z1 ) · · · Y (Ag−1 , zg−1 )Y (B1 , w1 ) · · · Y (Bg−1 , wg−1 )Bg )

where ψ ∈ V ∨ , 1 is the vacuum vector sitting at x, and Ai and Bi are element of V . This equation
is proven in [FBZ04, Subsection 10.4.10]; the terms appearing are rational function of the zi and wi
with poles along the diagonal. We used that Y (1, z) = Id, and Y (Bg , z)1|z=0 = Bg . In particular,
following [FBZ04, Equation 10.4.10], for n = 1, we get
(3)

Φ0 (ψ ⊗ B1 ⊗ 1) = ψ(B1 )

3.3. Factorization. We assume that the vertex algebra is holomorphic; in particular, it is selfcontrogradient and there exist a unique isomorphism ∇ : V → V ∨ of V module such that the norm
of the vacuum vector for the associated symmetric quadratic form Q = Q∇ is one.
Theorem 3.7 (Factorisation). Assume that V is holomorphic, and let π : X → B be a curve
with one marked point x and a horizontal node n as in Section 2.5, denote by ν : X̂ → X the
normalization of n. Let F be the morphism F : V → V ⊗ V ⊗ V ∼
= V ⊗ V ⊗ V ∨ , mapping v to
v ⊗ 1 ⊗ 1. If X̂ is irreducible, then F induces an isomorphism
F : H(X, x) → H(X̂, x, a, b)
and preserve the partition function. If X̂ has two connected components X1 and X2 , and say x and
a are on X1 and b is on X2 , then F induces an isomorphism
F : H(X, x) → H(X1 , x, a) ⊗ H(X2 , b)

and the partition function is mapped to the tensor product of the partition functions.
Proof. We discuss just the connected case, the other been analogue. The map F induces a welldefined map on the sheaf of vacua because we can pull-back forms via the normalization morphism
ν. It is also clear from the definition that F preserves the partition function.
First we show that F is surjective. Vectors of the form [v ⊗ 1 ⊗ 1] are of course in the image of
F . Take a homogeneous vector [v ⊗ wa ⊗ wb ], we prove that this is in the image of F by induction
on deg(wa ) + deg(wb ). Assume that deg(wa ) ≥ deg(wb ), and write wa = Ak w′ , for some A ∈ V .
Let m0 be an integer such that Am wa = Am wb = 0 for all m > m0 . Then, by Theorem 2.11,
take an abelian differential ω on X̃ \ {x, a, b} such that in a local co-ordinate around a it looks
14

like (z k + z m f (z))dz, and looks like z n g(z) around b, where f and g are regular functions and
m, n > m0 . Of course we can not control its principal part at x. Now,
Y(A, ω)v ⊗ w′ ⊗ wb = (Yx (A, ω)v)) ⊗ w′ ⊗ wb + v ⊗ wa ⊗ wb

Hence in H(X̂, x, a, b) we have that v ⊗ wa ⊗ wb is equal to − (Yx (A, ω)v)) ⊗ w′ ⊗ wb , and the
surjectivity follows by induction on the conformal degree.
To prove invectivity, we rather show the surjectivity of the dual map F ∨ : C(X̂, x, a, b) →
C(X, x). Given an element φ ∈ C(X, x), we want to define an element ψ ∈ C(X̂, x, a, b) such
that ρ∨ (ψ) = φ. Of course, we let ψ(v ⊗ 1 ⊗ 1) := φ(v). Arguing similarly to Theorem 3.6, we use a
PBW basis to define ψ given a vector v ⊗ wa ⊗ wb , we write out using a PBW basis, cf. Definition
(j)
(k)
(i)
(ℓ)
(1)
(1)
2.3, wa = Ai1 · · · Aik wa and wb = Bj1 · · · Bjk wb . Take an integer m0 such that Am v = Bm v = 0
for all i and j and all m > m0 . Using Theorem 2.11, we can find an m > m0 such that there exist
(t)
meromorphic differentials ωa , for t = 1, . . . , ℓ, on X̂ with a pole just at x such that, locally at
(t)
a, we have ωa = (zait + zamt f (za ))dza , where mt > m0 and f is some regular function of za , and
locally around b we have ωa = zbm f (zb )dzb , where m > m0 and f is some regular function of zb .
(t)
Analogously, we define differentials ωb for t = 1, . . . , k. We now let
(1)

(k)

ψ(v ⊗ wa ⊗ wb ) = φ(Y(A1 , ωa(1) ) · · · Y(Aℓ ωa(ℓ) )Y(B1 , ωb ) · · · Y(Bk , ωb )v)

Arguing as in the proof of [Uen08, Theorem 3.3.5], one shows that ψ is invariant, so it gives the
requested element.

Remark 3.8 (Factorization theorem in the general case). Dropping the hypothesis on V having a
single representation, the natural generalization of Theorem 3.7 is an isomorphism
M
F : H(X, x, M ) →
H(X̂, x, a, b, M, N, N ∨ )
N

where the sum run over all V module. The main twist in the proof of Theorem 3.7 is in the
surjectivity of F ∨ . This result has been proved in [DGTb], after the first version of this paper has
appeared.
3.4. Sheaf of differential operators. In this section, we will use the notions of Kuranishi family
and Kodaira-Spencer map introduced in Section 2.5; our first goal is to prove the following result;
Theorem 3.9. Let π : X → B be a smooth Kuranishi family of one pointed curves; let x be the
marked point and choose as V module for this point the vertex algebra V . Then, the sheaves of
covacua H(X, x) and of conformal blocks C(X, x) are locally free on B.
We will then compute the Chern class of H(X, x) in the line bundle case.

Proof. Being dual sheaves, it is enough to prove the claim for H(X, x). Up to shrinking B, we can
fix a vertical co-ordinate z at x(B). Denote with S the divisor on X given by x(B). We look at
the exact sequence of sheaves on X given by
d
0 → Tπ X(−S) → Tπ X(∗S) → OB [z −1 ]
→0
dz
where ∗S is defined in Section 2.3; the last map takes the principal part of the vector field along S.
The non-zero part of the associated long exact sequence in co-homology reads
d δ 1
−
→ R π∗ Tπ X(−S) → 0
0 → π∗ Tπ X(∗S) → OB [z −1 ]
dz
15

The Kodaira-Spencer map identifies R1 π∗ Tπ X(−S) with T B.
d
Denote by Λ the sheaf OB [z −1 ] dz
on B. On Λ we have a natural lie bracket say [ , ]0 , and we
d
d
need to introduce a new bracket [ℓ, m] := [ℓ, m]0 + δ(ℓ)(g) − δ(m)(f ) , where ℓ = f dz
, m = g dz
,f
−1
1
and g are in OB [z ], and hence, under the identification of R π∗ Tπ X(−S) with T B given by the
Kodaira-Spencer map, δ(ℓ) acts on g and δ(m) acts on f . With this new bracket, the above exact
sequence becomes a sequence of Lie algebras.
Following the notations established in Section 2.1, let ω be the conformal vector of the vertex
d
∈ Λ, we let
algebra and c the central charge. For every ℓ = f dz
ω[ℓ] = Resz=0 (Y (ω, z)f dz)
so that ω[ℓ] naturally act on V . The following formula can be found for instance in [Uen08, Lemma
2.13], and it is obtained by explicit computation

 3
c
d f
(4)
[ω[ℓ], ω[m]] = −ω[[ℓ, m]0 ] +
gdz
Res{z=0}
12
dz 3
The third derivative and the central charge appear because of the commutators of the modes Ln of
ω introduced in Section 2.1.
We now associate to an element ℓ of Λ a differential operator D(ℓ) acting on OB ⊗ V as
(5)

D(ℓ)(F ⊗ v) = ω[ℓ]v − δ(ℓ)(F )

Equation (4) implies the following cocycle relation
(6)

c
[D(ℓ), D(m)] = D([ℓ, m]) +
ResS
12




d3 f
gdz IdV
dz 3

d
d
where ℓ = f dz
and m = g dz
. So this exhibits a central extension Λ̂ of Λ as a sheaf of differential
operators of order at most one acting on OB ⊗ V . The symbol map σ : Λ̂ → T B ∼
= R1 π∗ Tπ X is
obtained by first projecting to Λ and then applying δ, thus it is surjective.
One has now to show that the action of Λ̂ preserve U (V )(OB ⊗ V ), hence Λ̂ acts on H(X, x),
one can argue as in [Uen08, Proposition 4.7]. Theorem 3.9 now follows from the following general
well-known proposition.

Proposition 3.10. Let F be a coherent sheaf on a smooth variety B, assume that P is a sheaf of
order at most one differential operator acting on F , and and the symbol map is surjective, then F
is locally free.

The above proof tells actually a bit more. We have a sequence
0 → OB → Λ̂ → T B → 0
which is far from being exact; Λ̂ act as a sheaf of differential operators of order at most one on
H(X, x), OB represents the identity and the last map is the symbol. If we mod out Λ̂ by the
operators which acts trivially, the sequence is still not exact. However, if H(X, x) is a line bundle,
then this quotient is exactly the Atiyah algebra of the line bundle and the sequence is exact.
Denote by A the sheaf of Lie algebras sitting in the exact sequence
0 → OB → A → T B → 0
16

define d by the cocycle
(v, w) =

1
Resx
12



d3 f
gdz
dz 3



d
d
and g dz
as lift in Λ =
where v and w are sections of T B ∼
= R1 π∗ Tπ X(−S), which admit f dz
−1 d
OB [z ] dz . This is an Atiyah algebra. We can also consider the algebras cA defined by scaling the
cocycle by c. We have the following result, which should be compared with and [Uen08, Theorem
5.6], see also [Tsu91] and [MOP15]

Proposition 3.11. Assume that H(X, x) is a line bundle. Then
(1) the Atiyah algebra of H(X, x) is cA;
(2) let H ′ (X, x) be the bundle of covacua associated to another vertex algebra V ′ with the
same central charge of V ; if Pic0 (B) is trivial then there is an isomorphism between H and
H ′ which is equivariant for the action of cA;
(3) the Chern class of H(X, x) equals c/2 times the Chern class of the Hodge line bundle.
∼ R1 π∗ Tπ X(−S), we can lift it to Λ =
Proof. First we prove item 1. Given a section of T B =
−1 d
OB [z ] dz , and let it act on OB ⊗ V using Equation 5. This action passes to the quotient H(X, x).
We conclude the proof observing that the cocycle described in Equation 6 matches up with the
cocycle defining cA.
For item 2, observe that the class of the extension defining the Atiyah algebra equals the first
Chern class of the line bundle, hence H(X, x) and H ′ (X, x) have the same Chern class. Being
Pic0 (B) trivial, the two line bundles are isomorphic. We can then choose an isomorphism which
preserves the Atiyah algebras.
For item 3, it is enough to show that 2A is the Atiyah algebra of the Hodge line bundle. This is
well-known. A (not that direct) way to see it, is to look at the bundle of covacua for Kac-Moody
groups. There, we both have an action of the Atiyah algebra of a convenient multiple of the Hodge
line bundle (this is the main result of [Tsu91]), and of cA, see e.g. [Tsu91] or [Uen08]. This allows
us to identify the two algebras.

The relation between the Virasoro algbra and the Atiyah algebra of the Hodge line bundle has
been also studied in [ADCKP88]
3.5. Local freeness at the boundary.
Theorem 3.12. Let π : X → B a Kuranishi family of Deligne-Mumford stable curves with one
marked point x, and assume that the vertex algebra is holomorphic; then, the sheaves of covacua
H(X, x) and conformal blocks C(X, x) are dual vector bundles.
Proof. It is enough to prove that C(X, x) is locally free. When the family is smooth, this theorem
is equivalent to Theorem 3.9. Fix now a point b in B, such that Xb is singular. The statement
being local, we can shrink B if necessary, so, to start with, we fix a local vertical co-ordinate z
around x(B) and identify V with V .
Lemma 3.13. Let Z be the locus of equisingular curves introduced in Section 2.5, then the restriction of C(X, x) to Z is locally free.
Proof. We can apply the naturality of conformal blocks 3.5 and the factorization theorem 3.7 to
translate the statement on the normalization X̂Z → Z; this is now a smooth family, so the result
follows from Theorem 3.9.

17

Let Z̃ be the formal completion of Z in B. To prove Theorem 3.12, by semi-continuity of the
rank of coherent sheave, cf. [Har77, Exercise 5.8], it is enough to show that
rk(C(X, x)|Z ) ≤ rk(C(X, x)|Z̃ )

To this end, we will construct a lifting map of OZ̃ modules

λ : C(X, x)|Z → C(X, x)|Z̃

This map will be the inverse of the natural restriction map ρ : C(X, x)|Z̃ → C(X, x)|Z , hence it will
be injective. Later, λ will also be used to compute the Taylor expansion of the partition function
at the boundary.
Let qi be the smoothing co-ordinates associated to the nodes, as in Section 2.5. For a multindex
k = (k1 , . . . , kt ) ∈ Nt , set q k = q1k1 · · · qtkt .
Now, it comes a keyP
construction. Take the identity Idn in Vn ⊗ Vn∗ = Hom(Vn , Vn ). (Recall that
Idn can be written as i bi ⊗ bi , where bi is a basis of Vn , and bi its dual). Let
ṽk := v ⊗ Idk1 ⊗ · · · ⊗ Idkt

This is an element of VZ := V ⊗i (Vai ⊗ Vbi ); as usual, Vai and Vbi are just copies of V which we
think sitting at ai and bi . Let now
X
ṽk q k
ṽ :=
k∈Nt

This belongs to VZ [[q1 , . . . , qt ]].
Let Φ be an element of C(X, x)|Z . Because of the Factorization Theorem 3.7, we can think at
it as a linear functional on (VZ )∨ . For every v in V , we can compute Φ on ṽ; more precisely, we
define
X
Φ(ṽk )q k .
λ(Φ)(v) :=
k∈Nt

We then extend λ(Φ) by OZ̃ -linearity to obtain a linear functional on V ⊗ OZ̃ .
If we interpret ṽ as a section of V ⊗ OZ̃ , its restriction to Z is again v, hence ρ(λ(Φ)) = Φ.
The following is the so called formal Gauge condition, proven in [Uen08, Lemmas 4.16 and 4.17]
by explicit computation.
Lemma 3.14. The linear functional λ(Φ) is invariant under the action of the meromorphic functions
on X with poles at x(B).
The above lemma implies that λ(Φ) is in C(X, x)|Ẑ , and we have thus concluded the proof of
Theorem 3.12.

3.6. Expansion of the partition function. We want now to use the lifting map λ appeared in
the proof of Theorem 3.12 to compute the Taylor expansion of the partition function in term of the
Schottky co-ordinates introduced in Section 2.5.
Let X → B a Schottky family with one marked point. Let b0 be a point such that the normalization of Xb0 is isomorphic to P1 . Assume we can fix a local co-ordinate z around the marked point.
The partition function 1 is a section of H(X, x), in order to compute its Taylor expansion in term
of the qi we need to trivialize H(X, x) around b0 . To this end, remark that C(X, x) ⊗ H(X, x) has
a natural trivialization given by the pairing, so we pair 1 with a non zero section of C(X, x). We
choose this section in a canonical way.
Recall that, thanks to the naturality 3.5, the propagation of vacua 3.6 and Remark 3.4, the
restriction of C(X, x) to Z is canonically isomorphic to (V0 )∨ = Cφ. We can now lift φ via λ to
18

a section of C(X, x) on the formal completion of Z in B, and pair it with 1. We state this as a
definition for further reference.
Definition 3.15. With the above notation, we denote by λ(φ) the section of C(X, x) defined on
the formal completion of Z in B obtained by applying the lifting map λ introduced in the proof of
Theorem 3.12 to φ.
Let us write out
(7)

X

λ(φ)(1) =

χk q k ,

k∈Ng

where the χk are function on Z. We have

χk (w1 , . . . , wg , z1 . . . , zg ) = φ(Idk ⊗1)

Let us stress our abuse of notations: φ is a linear functional on V , we are computing it on a vector
of V ⊗2g+1 , to make sense of this we have to apply the propagation of vacua 3.6. Let
For g = 1, k is just an integer k, and we have
χk = φ(IdVk ⊗1) =

dim
XVk

φ(Y (vi , w)Y (v i , z)1) =

dim
XVk
i=1

i=1

Q(vi , Y (1, z)v i ) =

dim
XVk

Q(vi , v i ) = dim Vk ,

i=1

where vi and v i are hortonormal basis for Vk ; Q is the invariant bilinear form on V , we have used
the propagation of vacua 3 (see also [FBZ04, Section 10.4.11] with A = 1), and Y (1, z) = IdV
To describe χk for general values of g, let us first recall the correlation function Z of k vectors
wi of V with formal parameters xi :
Z(w1 , . . . , wk ; x1 , . . . , xk ) := φ(Y (w1 , x1 ) · · · Y (wk , xk )1) ,

(recall that in the bra-ket notation one writes φ = h1| and 1 = |1i) we then have
X
(g) ig
(1) i1
; w1 , z1 , . . . wg , zg ) ,
, . . . , vig , v(g)
Z(vi1 , v(1)
(8)
χk =
(i1 ,...,ig )

(j)
vi

i
v(j)

and
are hortonormal basis for Vkj , and the sum run over all values of (i1 , . . . ig ) in
where
g
×j=1 {1, . . . , dim Vkj }.
The function χk is symmetric on the wi and zi ,, this follows both from our construction (indeed,
it has to be a holomorphic function on Z, and wi and zi are coordinates on Z), and, independently,
from the theory vertex algebra, see e.g. [FHL93, Proposition 3.5.1].
Fixing a value j0 , and normalizing zj0 = 0 ad wj0 = ∞, we obtain


g
X Y
(j)
i
χk = TrVkj 
, zi ) .
Y (vi , wj )Y (v(j)
0

i

j=1,j6=j0

Let us remark that the operator we are computing the trace of, does not preserves Vkj0 , so we are
implicitly composing it with the projection from V = ⊕Vk to Vkj0 .
The functions χk can be further Taylor expanded in the variables wj and zj if needed; in [GV09,
Section 3], some of these coefficients have been explicitly computed in the case of low rank lattice
vertex algebras.
The following lemma will be crucial for the application to the moonshine vertex algebra.
Lemma 3.16. If V1 is trivial and one of the entry of k is equal to 1, then χk = 0.
19

Proof. As V1 is trivial, the identity in End(V1 ) is equal to zero, hence also Idk = 0 and φ(Idk ⊗1) =
φ(0) = 0.

3.7. Differential equation near the boundary. In this section, we will show that the conformal
block introduced in Definition 3.15 is annihilated by some Fuchsian differential operators. An
analogue differential equation is given in [DGTb, Equation 38]
Notation 3.17. Let π : X → B be a Kuranishi family of stable curves with one marked point x,
with a point 0 ∈ B such that the normalization of X0 is P1 . We assume that X can be uniformized
in the following way. Let ai and bi , for i = 1, . . . , g, be the preimage of the nodes ni of X0 in
P1 . Choose a coordinate z on P1 such that none of them is ∞ and the marked point is 1. Let
Di (resp. Ei ) be a disc around ai (resp. bi ) of radius 1. Assume none of these disc intersect each
other and they do not contain 1. Let qi be a smoothing parameter for ni , and assume that it is a
coordinate defined on all B, and |qi | < 1. Let U be the open subset P1 × B obtained removing the
sets |z(p) − z(ai )| < |qi | and |z(p) − z(bi )| < |qi | for all i. Then, we assume that π : X → B is the
family obtained gluing the points (a, s) and (b, s) of U such that, for some i, p ∈ Di , b ∈ Ei and
z(a)z(b) = qi .The section x(s) = 1, for all s ∈ B, and z also gives a natural co-ordinate around 1.
Let B ∗ be the locus parametrizing smooth curves
The previous uniformaization is always possible either assuming that π is a family of curves with
Schottky structure, or up to shrinking B. We will need the following well-known lemma, whose
proof can be found in [Uen08, Lemma 5.15 and Corollary 5.17]
Lemma 3.18. In the notation 3.17, restrict π to the constructible subset Bi := {qi = 0 , qj 6=
0 for j 6= i}, let πi : Xi → Bi be the normalization of the node ni , then there exists a relative
meromorphic vector field ℓ̃i on Xi with poles just around x, which locally around ai and bi , for a
d
and 12 zi dzd i . Let ℓi be Laurent
convenient choice of coordinates wi and zi , is of the form 12 wi dw
i
expansion of ℓ̃i around x in term of the coordinate z.
Under the Kodaira-Spencer isomorphisms, ℓi equals qi ∂q∂ i .
Theorem 3.19. In the notation 3.17, let ℓi as in Lemma 3.18, and, for i = 1, . . . , g, define the
differential operator
d
Di := D[ℓi ] + ai (b) IdV −qi
dqi
where ai is a holomorphic function introduced during the proof which does not depend on the vertex
algebra V , and D[ℓi ] = Resz=0 (ℓi (z)Y (ω, z)dz). Assume one of the following two hypotheses
(1) the coordinates coming from lemma 3.18 are related to the coordinates from notation 3.17
via projective transformations ,
(2) we can choose a non-singular odd theta characteristic for the family .
Then, over the locus B ∗ parametrizing smooth curves, the section λ(φ) introduced in Definition
3.15 satisfies the differential equations
Di λ(φ) = 0

i = 1, . . . , g

In particular we have:
Convergence: the conformal block λ(φ) converges on all B;
Uniqueness: the section λ(φ) is the unique conformal block annihilated by the g differential
operators Di and equal to φ over the locus parametrizing curves whose normalization is P1 .
20

P
Proof. Let T (z) = Y (ω, z) =
Ln z −n−2 . Let g(z) be a change of coordinates; g(z) is also an
element of Aut(O), which acts on V , let R(g) be the action; we have the following well-known
transformation rule is obtained by direct computation, see e.g. [FBZ04, Section 8.2.2]:
c
T (z) = R(g)T (g(z))R(g)−1 (g ′ (z))2 + S(g) IdV ,
12
where S(g) is the Schwarzian derivative of g. Recall that projective transformation are exactly the
functions g such that S(g) = 0; a projective atlas for a Riemann surfaces is an atlas such that the
change of coordinates are projective transformation. If we are in the hypothesis 1, we can choose
a projective atlas and then, up to the convergence issue, T (z) is a quadratic vertical differential
valued in End(V ).
If we are in the hypothesis 2, we can assume that there exists a projective connection ρ(z) of
central charge c on X, i.e. ρ is a collection of holomorphic functions on X which transform as
c
ρ(z) = ρ(g(z))(g ′ (z))2 + S(g) ,
12
see [Uen08, pages 15-17 and Theorem 1.15] or [FBZ04, Section 8.2.5]. We can then look at T̃ (z) :=
T (z) − ρ(z) IdV . This, up to convergence issue, gives a two form valued in End(V ).
Let
Ω := λ(φ)T̃ (z) .
Since λ(φ) satisfies the formal Gauge condition, cf. 3.14, for all meromorphic functions on X with
poles just around x and all v ∈ V , we have
Ω Resz=1 (f (z)Y (z, v)dz) = 0 .
By the strong residue Theorem [FBZ04, Theorem 9.2.9] or [Uen08, Lemma 1.1.6], Ω is the a relative
two form on X valued in V ∨ ⊗ End(V ).
Let ℓ(z) be a meromorphic vertical vector field on X, or just the Laurent expansion of a vector
field around x. Pairing it with Ω we obtain a one form, let us compute its residue at x. Let γ be
small cylinder around x(0). We have
Z


ℓ(z)λ(φ)T̃ (z)dz 2 = λ(φ) Resz=0 ℓ(z)T̃ (z)dz 2 = D[ℓ]λ(φ) + ai (b)λ(φ) ,
γ

where

ai (b) =

Z

ℓ(z)ρ(z)(dz)2

γ

Fix all cordinates on B except qi at a generic values, and let ∆i be the resulting disc. Let X (i)
be the restriction of X to ∆i ; this is a family of smooth curves, except the curve over the origin
which has a single node. Locally around the node ni , the family is of the form wi zi = qi , where
wi , zi and qi are the coordinates from Lemma 3.18; outside the node ni , the family is trivial and
consists of a constant smooth open subset Ui . The vector field ℓ̃i from Lemma 3.18 is well defined
on Ui , and we can consider the differential form ℓ̃i Ω. Its only pole is at x, and we know its reside
is D[ℓi ]. On the other hand, let γa be the boundary of Ui around ai and γb the boundary around
bi , integrating ℓ̃i Ω over them we obtain
Z
Z
1
d
1 d
1
λ(φ)T (wi )dwi2 = λ(φ)L0 = qi
λ(φ)
wi
ℓ̃i Ω =
2
dw
2
2
dqi
i
γa
γa
We get no contribution from ρ(z) as it extends regularly over wi = 0.
21

A similar computation holds around bi , hence
(D[ℓi ] + ai (b)) λ(φ) = qi

d
λ(φ)
dqi

This shows that Di λ(φ) = 0 for all i. Both items 3.19 and 3.19 follows from the general theory
of Fuchsian differential equations.

Remark 3.20. The term ai can be computed explicitly. If we can guarantee that the change of
coordinate is projective, it vanishes. If the change of coordinates is the exponential exp(z) as in
qi
the Fuchsian uniformization, we have the familiar ai = c 24
.
Remark 3.21 (Analogy with the heat equation). Recall that the classical theta function satisfies
∂θ
∂2 θ
the heat equation, which reads ∂τ
|z=0 = 2πi (∂z)
2 |z=0 . In a fancy language, this equation relates the
τ -direction, which is the horizontal direction along the moduli sapce, with the z-direction, which is
the vertical direction along the universal family. This interpretation has been developed in [Wel83].
The equations appearing in Theorem 3.19 are similar in spirit, indeed the conformal block λ(φ) is a
d
sort of modular form, the term q dq
is in the horizontal direction, and the term D[ℓi ] in the vertical
one.
4. Vertex Algebras and the moduli space of curves
In this section we start working with the moduli space of genus g smooth curves Mg,n and its
Deligne-Mumford compactification Mg,n . The first space parametrizes smooth genus g curves with
n marked points; the second parametrizes all Deligne-Mumford stable curves, as in Definition 2.9.
They are both smooth Deligne-Mumford stacks; an atals is given by a disjoint union of finitely many
Kuranishi families; in other words, Kuranishi families are local charts for Mg,n . A comphrensive
description of these objects can be found in [ACG11].
Theorem 4.1. Let V be a holomorphic vertex algebra, then the sheaves of conformal blocks and
covacua define dual line bundles C = Cg,n and H = Hg,n on Mg,n for every g ≥ 0 and every n ≥ 1.
The partition function 1 = 1g,n is a non-zero regular section of H for every g and n.
Proof. These two sheaves defines vector bundles on every Kuranishi family thanks to Theorem 3.12.
The naturality 3.5 implies that these bundles glue to give vector bundles on Mg,n . to compute the
rank, it is enough to look at the dimension of the fiber over one point. We choose a point which
represent a curve C whose normalization is the projective line. Combining the naturality 3.5, the
factorization 3.7, the propagation of vacua 3.6 and Remark 3.4, we obtain that the rank is one.
The partition function defines a section of H on every Kuranishi family, it glues to a global
section thanks to the naturality 3.5. The above quoted results also show that the partition function
restrict to a non-zero vector in the fiber over the curve C described above.

We now consider a number of projections and clutching morphism between moduli spaces. For
every g, n and k, we have a projection morphisms
π : Mg,n+k → Mg,n
which forgets k sections. Moreover, by choosing a convenient gluing schemes, one has morphism
G : Πti=1 Mgi ,ni → Mg,n
22

where gi , ni , g and n are appropriate, see [ACG11, Section XII.10] for details. Let us denote again
by H and C the box products of line bundles on covacua and conformal blocks on Πti=1 Mgi ,ni , and
call partition function and denote by 1 the box product of the respective partition functions. The
following theorem is a formal consequence of the propagation of vacua 3.6, as far as the projection
morphisms are concerned, and of the factorization 3.7, as far as the cluthcings morphisms are
concerned.
Theorem 4.2. Let V be a holomorphic vertex algebra. The projections and clutchings morphisms
preserves the bundles of conformal blocks and covacua, and the partition functions. With the above
notations, π ∗ H = H, π ∗ C = C and π ∗ 1 = 1, and the identification are canonical; same statement
hold if we replace π with G.
The following result make these constructions descend to the moduli space of curves without
marked points, so with n = 0.
Theorem 4.3. Let π : Mg,1 → Mg be the projection morphism, then there exist line bundles
H = Hg and C = Cg on Mg which pull-back to the line bundles of covacua and of conformal
blocks; moreover, there exists a section 1 = 1g of H which pull-backs to the partition function. We
again call these line bundles the line bundles of covacua and of conformal blocks, and we call 1 the
partition function.
Proof. We have that Mg,1 ×π Mg,1 ∼
= Mg,2 , and the propagation of vacua 3.6 gives descend data
for Hg,1 , Cg,1 and 1g,1 . We can now conclude using standard descend theory.

The Hodge bundle Eg on Mg,n is the rank g vector bundle whose fiber at [C] is H 0 (C, ωC ). Its
determinant is called the lambda class λ = λg,n , it is semiample on Mg,n and generates the Picard
group of Mg . On Mg we also have the irreducible boundary divisors δi , with i = 0, 1, . . . , ⌊ g2 ⌋.
The generic point of δ0 is a curve with just one node such that its normalization is an irreducible
smooth curve of genus g − 1. The generic point of δi is a curve with just one node such that its
normalization is the disjoint union of two curves of genus respectively i and g − i. We denote by δi
also the line bundle associated to the boundary divisors.
The Picard group of Mg is freely by λ and the δi when g ≥ 3; moreover, the group of degree
zero line bundle is trivial, so a line bundle can be recovered out of its Chern class. More details can
be found in [ACG11] or [AC87].
Theorem 4.4. Let V be a holomorphic simple vertex algebra of central charge c, then the line
bundle Hg,n on Mg,n associated to V is isomorphic to 2c λg,n .
Moreover, when n = 0, the partition function does not vanish on any boundary divisor of Mg .
Proof. First, we take n = 0, and let H = Hg . P
The line bundle H has a regular section, namely the
partition function 1, so it is of the form aλ − bi δi .
To compute a, we restrict H to the open subset Mg . There, the Picard group is generated by λ
so H = aλ for some a. Recall that Pico (Mg ) = 0, so a is computed in Proposition 3.11.
We now focus on the bi . First, take i > 1. Fix a genus i curve A and a genus g − i curve B,
and a marked point b on B. We can embed A in δi mapping a point a to the curve A ∪ B/a ∼ b.
The intersection between A and H is bi . On the other hand, the restriction of H to A is trivial by
the naturality of conformal blocks 3.5, the factorization 3.7 and the propagation of vacua 3.6. We
conclude that bi = 0. The case i = 0 or 1 can be treated similarly.
To prove that 1 does not vanish along δi , let [Ci ] be point of δi parametrizing a curve whose
normalization is a disjoint union of copies P1 . Combining the naturally 3.5, with the factorization
23

3.7, the propagation of vacua 3.6, and the description of the covacua on a genus zero curve given
in Remark 3.4, we see that 1 is not zero at [Ci ].
For the case n > 0, look at the projection π : Mg,n → Mg . We have π ∗ Hg = Hg,n and
∗
π λg = λg,n (cf. [ACG11] and [Cor93, page 2]), so the conclusion.

Remark 4.5. Let V and V ′ be two holomorphic vertex algebras with the same central charge c;
take g ≥ 3 and let H and H ′ be the sheaves of covacua associated to V and V ′ . Theorem 4.4 shows
that H and H ′ are isomorphic. The isomorphism can be choosen in a canonical way. Indeed, the
automorphism group of Mg is trivial for g ≥ 3, see [Mas14], so the isomorphism is unique up to a
scalar. To fix this scalar, let Z ⊂ δ0 ⊂ Mg be the locus parametrizing curves whose normalization
is P1 . On Z, the line bundles H and H ′ are canonically isomorphic respectively to V0 ⊗ OZ and
V0′ ⊗ OZ . We can now normalize the isomorphism by requiring that it maps the vacuum vector to
the vacuum vector.
5. Vertex Algebras and Teichmüller modular form
5.1. Stable Siegel modular forms and theta series. Here, we recall some well known fact about
Siegel modular forms. Let Hg be the Siegel upper half space. The quotient stack Hg /Sp(2g, Z) is
the fine moduli space Ag of principally dimension abelian g-fold. Let Lg be the Hodge bundle on
Ag . Modular forms of weigh k and degree g are elements of H 0 (Ag , Lg⊗k ). They can be identified
with holomorphic functions f on Hg such that
f (gτ ) = ρ(τ, g)k f (τ )

for all τ ∈ Hg and all g ∈ Sp(2g, Z), where ρ is a convenient explicit cocycle.
There is a restriction morphism
⊗k
0
Φ : H 0 (Ag , L⊗k
g ) → H (Ag−1 , Lg−1 )

Definition 5.1 (Stable Siegel modular forms ). A weight k stable Siegel modular forms is a
collection (sg )g≥1 of weight k and degree g Siegel modular forms such that Φ(sg ) = sg−1 . Denote by H 0 (A∞ , L⊗k
∞ ) the space of weight k stable Siegel modular forms, and by R(A∞ , L∞ ) :=
⊕k≥0 H 0 (A∞ , L⊗k
)
∞ the ring of stable Siegel modular forms.
Let (Λ, Q) be a quadratic form of rank c, which is positive definite, unimodular and even. The
following function is the theta series associated to Q
X
√ X
ΘQ,g (τ ) =
exp(π −1
Q(vi , vj )τi,j )
i,j

v1 ,...,vg ∈Λ

1
2 c,

Moreover, in [Fre77] it is shown that if g is
This is well known to be modular form of weight
big enough with respect to the weight, the space of modular forms is spanned by theta series.
We have Φ(ΘQ,g ) = ΘQ,g−1 , we can thus define the stable Siegel modular form ΘQ := (ΘQ.g )g≥1 .
As explained in [Cod16], the ring R(A∞ , L∞ ) is the polynomial ring in the ΘQ with Q irreducible,
it carries a co-product (i.e. it is a Hopf algebra without the inverse), and the theta series are precisely
the characters.
We can consider the jacobian morphism
j : Mg → Ag ,

the pull-back of Lg is the lambda class λg introduced in Section 4. Let Jg be the pre image of Mg
in Hg , so the locus of matrices which are period matrices of a smooth curves.
24

5.2. Stable Teichmüller modular forms.
Definition 5.2 ( Teichmüller modular forms ). Teichmüller modular forms of weight k and degree
g ≥ 2 are the elements of H 0 (Mg , λ⊗k ). For g = 1, they are elements of H 0 (M1,1 , λ⊗k ).
The universal cover of Mg is the Teichmüller space Tg , and Mg is the quotient stack of Tg by
the mapping class group Γg . The Jacobian morphism lift to a map
j : T g → Jg .

The group Γg has a morphism χ : Γg → Sp(2g, Z) obtained taking the action of the diffeomeorphism on the homology of the surface. Teichmüller modular forms can be identified with holomorphic functions f on Tg such that
f (gp) = ρ(j(p), χ(g))k f (p)
for all p ∈ Tg , all g ∈ Γg , and where ρ is the same cocycle which defines Siegel modular forms; see
also [Ich94, Proposition 1.4].
Remark 5.3. It is shown in [OS80], that j induces an isomorphism between the coarse moduli
space Mg and the quotient variety Jg /Sp(2g, Z). However, the quotient stack [Jg /Sp(2g, Z)] is
not isomorphic to the fine moduli space Mg ; the problem is due to the hyperelliptic involution.
This implies that Teichmüller modular forms can not be identified with holomorphic function on
Jg which transform appropriately under the action of Sp(2g, Z). On the other hand, if we take
convenient finite index subgroups G ⊂ Sp(2g, Z), the quotient variety Jg /G is a fine moduli space
for smooth curves with level structure, and forgetting the level structure one obtains a finite étale
map Jg /G → Mg . This shows that Teichmüller modular forms are a subspace of the holomorphic
function on Jg which transforms appropriately under the action of G.
There is a restriction map
(9)

Φ : H 0 (Mg , λ⊗k ) → H 0 (Mg−1 , λ⊗k )

as explained for instance in [Ich94]. A way to define it, is to recall that the cluctching morphism
gives a surjective finite map c : Mg−1,2 → δ0 ⊂ Mg , and the pull-back of degree g Teichmüller
modular forms via this map descends to degree g − 1 Teichmüller modular forms via the forgetful
morphism f : Mg−1,2 → Mg−1 .
Definition 5.4 (Stable Teichmüller modular forms ). A weight k stable Teichmüller modular
forms is a collection (sg )g≥1 of weight k and degree g Teichmüller modular forms such that Φ(sg ) =
sg−1 . Denote by H 0 (M∞ , λ⊗k
∞ ) the space of weight k stable Teichmüller modular forms, and by
R(M∞ , λ∞ ) := ⊕k≥0 H 0 (M∞ , λ⊗k
∞ ) the ring of stable Teichmüller modular forms.
Stable Siegel modular forms restrict to stable Teichmüller modular forms. The ring of stable
Teichmüller modular forms carries the following co-product. Given a stable Teichmüller modular
⊗k
0
form s of weight k, its co-product is a collection of elements sg ⊗ sh in H 0 (Mg , λ⊗k
g )⊗ H (Mh , λh )
for all possible values of g and h; fix a pair (g, h), restrict sg+h to the boundary divisor δg , this
divisor is isomorphic to Mg,1 × Mh,1 ; the restriction of λg+h to Mg,1 × Mh,1 equals λg ⊠ λh , hence
we can descends the restriction of sg+h to an element sg ⊗ sh .
Theorems 4.2 and 3.7 allow us to give the following key theorem.
Theorem 5.5. Given a holomorphic vertex algebra V of central charge c, the partition function
1(V ) := {1g (V )}g≥0 is a weight 21 c stable Teichmüller modular form; moreover it is a character for
the co-product described above.
25

5.3. Satake compactification. Given a partition function 1g (V ) in H 0 (M, g, λkg ) it is natural to
ask if it is the restriction of a Siegel modular form. In Section 5.4, we will see that this is always
the case for lattice vertex algebra. In general, we think that this question should be related to the
normality of the Satake compactification, as explained below.
The Satake compactification of ASg of Ag is a normal projective variety, which can be defined
as the proj of the ring of modular form. The boundary ASg \ Ag is isomorphic to ASg−1 , and Lg
restricts to Lg−1 . The jacobian map can be extended to a morphism
j : Mg → ASg

mapping a curve to the Jacobian of its normalization, and again j ∗ Lg = λg . We define the Satake
compactification MgS of Mg to be the schematic image of Mg via j, or, equivalently, the schematic
closure of j(Mg ) in ASg . This is a variety smooth in codimension one; we do not know if it is
normal.
The line bundle λg is semiample on Mg , and it gives a morphism f towards a variety Σg ; the
variety Σg is normal just because Mg is normal and λ is semiample. The jacobian map factors as
the composition of f and of a morphism
ν : Σg → MgS
This second map is a homeomorphism, see [ACG11, Pages 436-437] (in [ACG11], Σg rather than
MSg is called the Satake compactification). Because of Zariski main theorem, ν has to be the
normalization of MSg . In particular, MSg is normal if and only if ν is an isomorphism, if and only
if the map
j ∗ : H 0 (ASg , Lkg ) → H 0 (Mg , λk )
is surjective for k big and divisible enough.

Remark 5.6. The morphism j ∗ is not surjective for all k. For instance, the square root of the
product of theta constant is not in its image, as shown in [Tsu91]. In [MV13, Section 3], it is shown
that this modular form, when g = 4, cuts out the locus of curves in M4 whose canonical model lies
on a singular quadric. We could imagine that the cokernel of j ∗ consists of modular forms which
detect the projective geometry of the canonical curve.
5.4. Theta series and lattice vertex algebras. Let Q be an even, unimodular, positive definite
quadratic form of rank c, and V (Q) the associated vertex algebra, as in Section 2.2. Let also
F1 (q) :=

+∞
Y

(1 − q n ) .

n=1
1
24

This function is equal, up to the factor q to the Dedekin eta function, so it is convergent; it is
equal to the inverse of the graded dimension of the Heisenberg vertex algebra (also known as free
boson). The following formula is well-known, see e.g. [MT10, Section 7.3]
X
dim Vn(Q) q n = F1−c (q)ΘQ,1 (q)
n≥0

In the recent paper [MPT, Section 6.5], the following formula has been proven
X
(10)
χk q k = Fg−c ΘQ,g ,
k∈Ng

26

where the left hand side is as in Equation 7, the function Fg is a holomorphic function on the
Schottky space independent of V , and actually defined using the Heisenberg vertex algebra, and
the identity is an identity of function on the Schottky space. (The theta series is defined on the
Siegel space, but it is possible to pull-it back on the Schottky space.)
Remark 5.7 (Eichler’s trick). There is another approach which generalize the so called Eichler’s
trick. Let A be the universal ppav over the Siegel upper half space, and Ac the cartesian product
of c copies of A over Hg . We can use Q to define a principal polarization on Ac . The Eichler’s
trick is to notice that the classical theta function of Ac evaluated at the identity is the theta series
of Q. This can be used to reduce the modulariity of ΘQ,g to the modularity of the classical theta
function. We can generalize the Eichler trick as follows. Let A → Mg be the d fold product of the
universal jacobian. We can use Q to define a line bundle on A, whihc gives a principal polarization
on each fibre. As shown [Gai99] and [Uen95], the space of covacua of V (Q) is just the push-forward
of this line bundle to Mg . Now, the claimed result follows from the standard Eichler’s trick and a
careful analysis of the trivialization λ(φ), as explained in Remark 5.12.
5.5. Expansion of the partition functions on the Teichmüller and Schottky spaces. We
are going to use the Schottky space introduced in Section 2.6.
Lemma 5.8. The section λ(φ) of C = Hom(H, OS g,1 ), introduced in Definition 3.15 on the formal
completion of an irreducible component Z of the locus parametrizing curve whose normalization is a
projective line, converges on all the Schottky space Sg,1 . Moreover, it descends along the projection
S g,1 → S g .

Proof. Consider the universal family π : X → S g,1 . Fix a point p ∈ Sg,1 . The key remark is that,
as this is a family of curves with Schottky structure, we can always find an open subset B of S g,1
containing p where the uniformization described in Notation 3.17 holds and we can apply Theorem
3.19.
The descends follows from the propagation of vacua 3.6.


Let Fg be the holomorphic function on the Schottky space introduced in Section 5.4. Abusing
notation, denote always by λ(φ) the descended section from Lemma 5.8.
Proposition 5.9. Let π : Tg → Mg be the canonical projection. Then the image of π ∗ H 0 (Mg , H)
via Fgc λ(φ) in H 0 (Tg , OTg ) is the space of weight c/2 Teichmüller modular forms.

Proof. As Mg is the stack theoretic quotient of Tg by Γg , the line bundle π ∗ H carries a Γg -action,
and the sections π ∗ H 0 (Mg , H) are Γg -invariant. In particular, for every s in H 0 (Mg , H), p ∈ Tg
and g ∈ Γg , we have
λ(φ)(π ∗ s)(gp) = ρV (g, p)λ(φ)(π ∗ s)(p)
for some cocycle ρV independent of s.
For lattice vertex algebra, as λ(φ)(1V ) is explictely computed in Equation 10, the cocycle Fgc ρV (Q)
is the cocycle ρc/2 defining Teichmüller modular forms of weight 2c .
For any other vertex algebra V , fix V (Q) a lattice vertex algebra of the same central charge. We
have an isomorphism of the line bundles HV and HV (Q) which is equivariant for the action of the
extension of the Virasoro algebra, see Proposition 3.11. This isomorphism preserves the first order
differential operator introduced in Section 3.4. By Theorem 3.19, the isomorphism also preserve
λ(φ). This means that the cocycle ρ is independent of the vertex algebra.

27

Corollary 5.10. Let V be a holomorphic vertex algebra of central charge c. For any g ≥ 2, the
expression appearing in Equations 7 and 8 define a holomorphic function on the Schottky space
Sg ; its pull-back to the Teichmüller space Tg multiplied by the function Fgc discussed above is a
Teichmüller modular form of weight 12 c.
Let us also spell out the case (g, n) = (1, 1). Let ∆ be the unit disc inside the complex plane, with
coordinate q. Recall that ∆ is the basis of a universal family of elliptic curves, and the associated
map π : ∆ → M1,1 is a Galois cover with group of deck transformation SL(2, Z).
Corollary 5.11. Let V be a holomorphic vertex algebra of central charge c. The formal power
series

c 

Y
X
fV (q) := 
(1 − q n ) 
dim(Vn )q n 
n≥0

n≥0

converges on all ∆ and it is a modular form of weight

1
2 c.

Remark 5.12. We conjecture that the function Fg is equal to the function F appearing in [MT06,
Theorem 1], see also [ZT87, Zog89]. The idea is that if we take the Fuchsian uniformization of the
moduli space of curves, the natural trivialization of the Hodge bundle gives Teichmüller modular
form, if we take the Schottky uniformization the natural trivialization differs from the previouse
one by the factor Fg . The expansion of a Teichmüller modular forms in term of the Schottky
co-ordinates is also studied in [Ich94], where Schottky co-ordinates are called Koebe coordiantes.
Our λ(φ) should correspond to the Schottky trivialization of the Hodge line bundle. This is
hinted also in [GKV10, Equation B.3].
6. Classification of vertex algebras, the slope of the effective con of the moduli
space of curves and the Schottky problem
6.1. The slope of the effective cone of the moduli space of curves. Let Π be the plane in
Pic(Mg ) ⊗ Q spanned by λ and δ0 . In this plane, we can look at the cone of effective line bundles.
One ray of the cone is given by λ. To determine the other ray is one of the main open problem
in the theory of the moduli space of curves. The slope of this cone, computed using as Cartesian
co-ordinates on Π the line bundles λ and −δ0 , is usually called the slope of Mg , and we will denote
it by sg . More explicitly
a
sg := inf{ such that aλ − bδ0 is effective}
b
The value of sg is known for low values of g; known lower and upper bounds for sg are asymptotically
respectively of the form O( g1 ) and 6 + O( 1g ). It is conjectured that the sequence sg is decreasing,
or at least convergent, and the two main guesses for its
P limit are 0 and 6. Let us mention that
sometime one consider the plane spanned by λ and δ = δi rather than δ0 , and the resulting slope
is closely related to the one we are considering here. We refer to [FP05, Far09] for a comprehensive
discussion and bibliography about this problem.
In this section, we denote by 1g (V ) the partition function associated to a holomorphic vertex
c
algebra V of central charge c. This can be seen both as an element of H 0 (Mg , λ⊗ 2 ) (cf. Theorems
4.3 , 4.4), or as a holomorphic function on the Schottky space g whose pull-back to the Teichmüller
space transform appropriately under the action of the mapping class group (cf. Proposition 5.9 and
Corollary 5.10). We will use the functions χk introduced in Equation (8); we will write χk (V ) if we
want to stress the vertex algebra used to define χk .
28

Ideally, the two statements of the following theorem should be used in combination, to bootstrap
information from low to high values of g.
Theorem 6.1. Fix a central charge c. Let Vi be a finite collection of P
holomorphic vertex algebras
of central charge c, and ai a collection of complex numbers; let Pg :=
ai 1g (Vi ) be the associated
genus g Teichmüller modular form..
Given a constant b, let Bb := {k ∈ Ng | ki ≤ b i = 1, . . . , g} be the box of size b in Ng .
If
(1) there exist a g0 such that Pg vanishes identically on Mg for all g < g0 ;
(2) there exists a constant b such that
X
(g )
ai χk 0 (Vi ) = 0 ∀k ∈ Bb ;
i

(3) there exist at least a value of k such that
X
(g )
ai χk 0 (Vi ) 6= 0 ;
i

then

sg0 ≤

c
2b

On the other hand, if
(1) there exists a g0 such that Pg vanishes identically on Mg for all g < g0 ;
(2) there exists a constant b such that
X
(g )
ai χk 0 (Vi ) = 0 ∀k ∈ Bb ;
i

(3) we know that

sg0 >

c
2b

then Pg0 vanishes identically on Mg0 .
Proof. Using the trivialization introduced in Proposition 5.9, we can identify Pg with an holomorphic function on the Schottky space; with this trivialization, its expansion in Schottky coordinates
P
(g)
is the one given in Equations 7 and 8; in particular the coefficient of q k is i ai χk (Vi ). The
equation q1 · · · qg = 0 defines the preimage of the boundary divisor δ0 inside the extended Schottky
P
(g )
space. This shows that Pg is a section of 12 cλ − bδ0 if and only if i ai χk 0 (Vi ) = 0 for all k ∈ Bb .
The statement now follows from the definition of the slope sg .

The following example should be thought as a baby case of the second part of Theorem 6.1.
Example 6.2. Let V and V ′ two vertex algebras of central charge c = 2k. The slope of the effective
cone of M1,1 is well-known; more concretely, it is well-known that if a modular form of weight k on
k
+ 1 at the boundary, then it is identically zero. Applying this
M1,1 vanishes with order at least 12
to the difference of the partition functions of V and V ′ on M1,1 , and using the expansion given in
Corollary 5.11, we get that if
dim Vn = dim Vn′
29

∀n ≤

k
+1
12

then the two partition functions are equal, and we can deduce that
dim Vn = dim Vn′

∀n ≥ 0 .

6.2. Application to the Schottky problem. The Schottky problem asks for a characterization
of Mg inside Ag , a classical approach is to look for Siegel modular forms vanishing on Ag . We
+
can prove the following negative result. Recall that E8 ⊕ E8 and D16
are the unique unimodular,
positivie definite, even lattices of rank 16.
Corollary 6.3. The modular form ΘE8 ⊕E8 ,5 − ΘD+ ,5 is not identically zero on M5 .
16

+
Proof. Let V be the lattice vertex algebra associated to E8 ⊕ E8 , and V ′ the one associated to D16
.
(5)
(5)
′
In [GV09, Section 3.1] it is shown that some of the functions χk (V ) − χk (V ) is not zero for
Q4
k = (1, 1, 1, 1, 1). (More specifically, using residues, they compute the coefficient of i=1 (zi wi )−1
in χk as eigenvalue of a convenient Casimir operator. ) The result follows from Equations 7, 8 and
10.


Let us recall that the above corollary was proven in a completely different way in [CSB14] and
[GSM11]. The modular form under analysis is the so called Schottky form, it is well-known to
vanish on Ag for g ≤ 3, and to be the equation of M4 in A4 .
More generally, Theorem 6.1 can be applied to the Schottky problem in the following way. Take
a non-zero Siegel modular form of degree g which can be written as linear combination of the theta
series introduced in Section 5.4; then Equation 10 and Proposition 5.9 combined with the second
part of Theorem 6.1 can be used to determine if it is zero on Mg .
6.3. Application to the classification of vertex algebra. First, we prove the following corollary, likely well-know to expert in vertex algebras.
Corollary 6.4. Let P and Q two different quadratic forms of the same rank. Then, the two
associated vertex algebras are not isomorphic.
Proof. It is enough to show that the partition functions of the associated vertex algebras are not
equal on Mg for g big enough. These partition functions are the theta series associated the quadratic
forms by Equations 7, 8 and 10. The requested result is proved in [CSB14].

Using instead the slope of the effective cone of the moduli space of curves, we can prove the
following result about the moonshine vertex algebra. Recall that the moonshine vertex algebra V ♮
has central charge 24 and V1♮ = 0, it is an open conjecture if it is the unique vertex algebra with
these two properties.
Corollary 6.5. Let V be a holomorphic vertex algebra of central charge 24 with V1 = 0. Then the
partition function of V is equal to the partition function of the moonshine vertex algebra for g ≤ 6.
If there exists an integer g0 such that the slope sg of the effective cone of moduli space of genus
g curves is strictly greater than 6 for all g ≤ g0 , then the partition function of V is equal to the
partition function of the moonshine vertex algebra for all g ≤ g0
Proof. It is well-known that sg > 6 for g ≤ 6, see e.g. [Far09, Theorem 4.9], so the second claim
implies the first. The second claim is a combination of the second part of Theorem 6.1 and Lemma
3.16.

30

Another important question about the classification of vertex algebra is if, in analogy with
the case of positive definite, unimodular even quadratic forms of a given rank, the number of
holomorphic vertex algebras with a fixed central charge is finite. In the following result, by partition
function we mean the stable Teichmüller modular forms {1g (V )}g≥1 .
Corollary 6.6. Fix a central charge c, then there are countably many possibilities for the partition
functions of holomorphic vertex algebras of central charge c.
⊗c
If there exists a constant C depending only on c such that h0 (Mg , λg 2 ) ≤ C for all g, then
there are at most C possibilities for the partition functions of holomorphic vertex algebras of central
charge c.
Proof. The statement follows from Theorem 5.5 and the independence of characters [Cod16, Lemma
2.3].

6.4. Reconstruction of the vertex algebra from its partition function. The following conjecture is very natural, especially from the point of view of physics.
Conjecture 6.7. Let V and V ′ be two vertex algebra of the same central charge. If their partition
functions are equal in all genera, then they are isomorphic.
Let us make the following comments
(1) Conjecture 6.7 is true if one restricts the attention to lattice vertex algebras, see Corollary
6.4;
(2) Conjecture 6.7 is false if one restricts the partition functions to the moduli space of hyperlliptic curves, as in [Poo96] and [Cod16] it is shown that theta series associated to
non-isomorphic quadratic forms can become equal in all genera after restriction to the
hyperelliptic locus;
(3) in[SB13] it is shown that on the locus of n-gonal curves, for n ≥ 3, theta series are distinct
if the genus is big enough. One could ask Conjecture 6.7 after restricting the partition
functions to the locus of n-gonal curves for n ≥ 3, or other geometrically meaningful loci.
We can propose the following effective version of Conjecture 6.7.
Conjecture 6.8. Fix a central charge c, then there exists an integer g(c) such that two holomorphic
vertex algebras of central charge c are isomorphic if and only if they have the same partition function
in genus g(c).
Both conjectures seems out of reach at the moment. A proof of these conjectures would be useful
for the classification of vertex algebras, for instance applied in combination with our results 6.5 and
6.6.
References
[AC87]

Enrico Arbarello and Maurizio Cornalba, The Picard groups of the moduli spaces of curves, Topology
26 (1987), no. 2, 153–171. MR 895568
[ACG11]
E. Arbarello, M. Cornalba, and P. A. Griffiths, Geometry of algebraic curves. Volume II, Grundlehren
der Mathematischen Wissenschaften, vol. 268, Springer, Heidelberg, 2011, With a contribution by J. D.
Harris.
[ADCKP88] E. Arbarello, C. De Concini, V. G. Kac, and C. Procesi, Moduli spaces of curves and representation
theory, Comm. Math. Phys. 117 (1988), no. 1, 1–36. MR 946992
[BD04]
Alexander Beilinson and Vladimir Drinfeld, Chiral algebras, American Mathematical Society Colloquium Publications, vol. 51, American Mathematical Society, Providence, RI, 2004. MR 2058353
[Ber75]
L. Bers, Automorphic forms for Schottky groups, Advances in Math. 16 (1975), 332–361. MR 0377044
31

[Buh02]
[Cod14]
[Cod16]
[Cor93]
[CSB14]
[DGTa]
[DGTb]
[DGTc]
[Don93]
[Far09]

[FBZ04]
[FHL93]
[FP05]
[Fre77]
[Gai99]

[GH88]
[GKV10]
[GN03]
[GSM11]
[GV09]
[Har77]
[Her15]
[HS07]

[HvH16]
[Ich94]
[Kin03]
[Kra90]
[Li99]
[Mas14]

Geoffrey Buhl, A spanning set for VOA modules, J. Algebra 254 (2002), no. 1, 125–151. MR 1927435
G. Codogni, Satake compactifications, lattices and schottky problem, Ph.D. thesis, University of Cambridge, 2014.
Giulio Codogni, Hyperelliptic Schottky problem and stable modular forms, Doc. Math. 21 (2016), 445–
466. MR 3505129
M. D. T. Cornalba, On the projectivity of the moduli spaces of curves, J. Reine Angew. Math. 443
(1993), 11–20. MR 1241126
G. Codogni and N. I. Shepherd-Barron, The non-existence of stable Schottky forms, Compos. Math.
150 (2014), no. 4, 679–690.
C Damiolini, A Gibney, and N. Tarasca, Conformal blocks from vertex algebras and their connections
on Mg,n , Arxiv preprint.
, On factorization and vector bundles of conformal blocks from vertex algebras, Arxiv preprint.
, Vertex algebras of cohft-type, Arxiv preprint.
Chongying Dong, Vertex algebras associated with even lattices, J. Algebra 161 (1993), no. 1, 245–265.
MR 1245855
Gavril Farkas, Birational aspects of the geometry of Mg , Surveys in differential geometry. Vol. XIV. Geometry of Riemann surfaces and their moduli spaces, Surv. Differ. Geom., vol. 14, Int. Press, Somerville,
MA, 2009, pp. 57–110. MR 2655323
Edward Frenkel and David Ben-Zvi, Vertex algebras and algebraic curves, second ed., Mathematical
Surveys and Monographs, vol. 88, American Mathematical Society, Providence, RI, 2004. MR 2082709
Igor B. Frenkel, Yi-Zhi Huang, and James Lepowsky, On axiomatic approaches to vertex operator
algebras and modules, Mem. Amer. Math. Soc. 104 (1993), no. 494, viii+64. MR 1142494
G. Farkas and M. Popa, Effective divisors on Mg , curves on K3 surfaces, and the slope conjecture,
Journal of Algebraic Geometry 14 (2005), no. 2, 241–267.
E. Freitag, Stabile Modulformen, Math. Ann. 230 (1977), no. 3, 197–211.
Dennis Gaitsgory, Notes on 2D conformal field theory and string theory, Quantum fields and strings:
a course for mathematicians, Vol. 1, 2 (Princeton, NJ, 1996/1997), Amer. Math. Soc., Providence, RI,
1999, pp. 1017–1089. MR 1701613
L. Gerritzen and F. Herrlich, The extended Schottky space, J. Reine Angew. Math. 389 (1988), 190–208.
MR 953671
M. R. Gaberdiel, C. A. Keller, and R. Volpato, Genus two partition functions of chiral conformal field
theories, Commun.Num.Theor.Phys (2010), no. 4, 295–364.
Matthias R. Gaberdiel and Andrew Neitzke, Rationality, quasirationality and finite W -algebras, Comm.
Math. Phys. 238 (2003), no. 1-2, 305–331. MR 1990879
Samuel Grushevsky and Riccardo Salvati Manni, The superstring cosmological constant and the Schottky
form in genus 5, Amer. J. Math. 133 (2011), no. 4, 1007–1027. MR 2823869
M. R. Gaberdiel and R. Volpato, Higher genus partition functions of meromorphic conformal field
theories, J. High Energy Phys. (2009), no. 6, 048, 43.
Robin Hartshorne, Algebraic geometry, Springer-Verlag, New York-Heidelberg, 1977, Graduate Texts
in Mathematics, No. 52. MR 0463157
F. Herrlich, Schottky space and Teichmüller disks, 289–308. MR 3380335
F. Herrlich and G. Schmithüsen, On the boundary of Teichmüller disks in Teichmüller and in Schottky
space, Handbook of Teichmüller theory. Vol. I, IRMA Lect. Math. Theor. Phys., vol. 11, Eur. Math.
Soc., Zürich, 2007, pp. 293–349. MR 2349673
R. Heluani and J. van Hereken, Characters of n=2 topological vertex algebras are jacobi modular forms
in the moduli space of elliptic supercurves, Advances in Mathematics 302 (2016), 551–627.
T. Ichikawa, On Teichmüller modular forms, Math. Ann. 299 (1994), no. 4, 731–740. MR 1286895
O. D. King, A mass formula for unimodular lattices with no roots, Math. Comp. 72 (2003), no. 242,
839–863. MR 1954971
Irwin Kra, Horocyclic coordinates for Riemann surfaces and moduli spaces. I. Teichmüller and Riemann
spaces of Kleinian groups, J. Amer. Math. Soc. 3 (1990), no. 3, 499–578. MR 1049503
Haisheng Li, Some finiteness properties of regular vertex operator algebras, J. Algebra 212 (1999),
no. 2, 495–514. MR 1676852
Alex Massarenti, The automorphism group of M g ,n , J. Lond. Math. Soc. (2) 89 (2014), no. 1, 131–150.
MR 3174737
32

[MOP15]

[MPT]
[MT03]
[MT06]

[MT10]

[MT14]

[MV13]

[OS80]

[Poo96]
[SB13]
[Sta17]
[Tsu91]
[Uen95]

[Uen08]

[Wel83]
[Zhu96]
[Zog89]
[ZT87]

Alina Marian, Dragos Oprea, and Rahul Pandharipande, The first Chern class of the Verlinde bundles,
String-Math 2012, Proc. Sympos. Pure Math., vol. 90, Amer. Math. Soc., Providence, RI, 2015, pp. 87–
111. MR 3409789
Michael Welby Michael P. Tuite, General genus zhu recursion for vertex operator algebras, Arxiv
preprint.
Geoffrey Mason and Michael P. Tuite, Torus chiral n-point functions for free boson and lattice vertex
operator algebras, Comm. Math. Phys. 235 (2003), no. 1, 47–68. MR 1969720
A. McIntyre and L. A. Takhtajan, Holomorphic factorization of determinants of Laplacians on Riemann
surfaces and a higher genus generalization of Kronecker’s first limit formula, Geom. Funct. Anal. 16
(2006), no. 6, 1291–1323.
Geoffrey Mason and Michael Tuite, Vertex operators and modular forms, A window into zeta and
modular physics, Math. Sci. Res. Inst. Publ., vol. 57, Cambridge Univ. Press, Cambridge, 2010, pp. 183–
278. MR 2648364
Geoffrey Mason and Michael P. Tuite, Free bosonic vertex operator algebras on genus two Riemann
surfaces II, Conformal field theory, automorphic forms and related topics, Contrib. Math. Comput.
Sci., vol. 8, Springer, Heidelberg, 2014, pp. 183–225. MR 3559205
Marco Matone and Roberto Volpato, Vector-valued modular forms from the Mumford forms, SchottkyIgusa form, product of Thetanullwerte and the amazing Klein formula, Proc. Amer. Math. Soc. 141
(2013), no. 8, 2575–2587. MR 3056547
Frans Oort and Joseph Steenbrink, The local Torelli problem for algebraic curves, Journées de Géometrie
Algébrique d’Angers, Juillet 1979/Algebraic Geometry, Angers, 1979, Sijthoff & Noordhoff, Alphen aan
den Rijn—Germantown, Md., 1980, pp. 157–204. MR 605341
C. Poor, Schottky’s form and the hyperelliptic locus, Proc. Amer. Math. Soc. 124 (1996), no. 7, 1987–
1991.
N. Shepherd-Barron, Siegel modular forms and the gonoality of curves, arXiv:1306.6253 (2013).
The Stacks Project Authors, Stacks Project, 2017, http://stacks.math.columbia.edu.
S. Tsuyumine, Thetanullwerte on a moduli space of curves and hyperelliptic loci, Mathematische
Zeltschirift 207 (1991), 539–568.
Kenji Ueno, On conformal field theory, Vector bundles in algebraic geometry (Durham, 1993), London Math. Soc. Lecture Note Ser., vol. 208, Cambridge Univ. Press, Cambridge, 1995, pp. 283–345.
MR 1338420
, Conformal field theory with gauge symmetry, Fields Institute Monographs, vol. 24, American
Mathematical Society, Providence, RI; Fields Institute for Research in Mathematical Sciences, Toronto,
ON, 2008. MR 2433154
Gerald E. Welters, Polarized abelian varieties and the heat equations, Compositio Mathematica 49
(1983), no. 2, 173–194 (eng).
Yongchang Zhu, Modular invariance of characters of vertex operator algebras, J. Amer. Math. Soc. 9
(1996), no. 1, 237–302. MR 1317233
P. G. Zograf, Liouville action on moduli spaces and uniformization of degenerate Riemann surfaces,
Algebra i Analiz 1 (1989), no. 4, 136–160.
P. G. Zograf and L. A. Takhtadzhyan, On the uniformization of Riemann surfaces and on the WeilPetersson metric on the Teichmüller and Schottky spaces, Mat. Sb. (N.S.) 132(174) (1987), no. 3,
304–321, 444.

Giulio Codogni, Dipartimento di Matematica, Università degli Studi di Roma “Tor Vergata” , Via
della ricerca scientifica, 00133 Roma, Italy.
E-mail address: codogni@mat.uniroma2.it

33

