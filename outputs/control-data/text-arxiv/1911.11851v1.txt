JOURNAL OF LIGHTWAVE TECHNOLOGY, VOL. XX, NO. XX, MONTH 2019

1

Space-Ground Coherent Optical Links: Ground
Receiver Performance With Adaptive Optics and
Digital Phase-Locked Loop

arXiv:1911.11851v1 [eess.SP] 25 Nov 2019

Laurie Paillier, Raphaël Le Bidan, Member, IEEE, Jean-Marc Conan, Géraldine Artaud,
Nicolas Védrenne and Yves Jaouën

Abstract—In the framework of optical high data rate satelliteto-ground links, we investigate the performance of a coherent
receiver which combines an adaptive optics system and a digital
carrier synchronization technique. We propose a digital carrier
synchronization system based on a phase-locked loop and use
end-to-end simulations to characterize the impact of the atmospheric turbulence in the case of a representative low Earth
orbit satellite-to-ground transmission link. The results show that
classical digital phase-locked loop techniques can be a reliable
solution to accurately compensate for the Doppler frequency
shift between the incoming signal and the local oscillator at the
ground station, in the presence of a preliminary coarse frequency
estimation. Adaptive optics compensation enables the loop to
lock after a few milliseconds and to accurately track the phase
fluctuations. The bit-error-rate performance is not degraded by
the digital loop but suffers from the residual signal amplitude
fluctuations.
Index Terms—Coherent receiver, digital phase-locked loop,
adaptive optics, carrier synchronization, LEO, downlink.

I. I NTRODUCTION

I

N terrestrial fiber-optic communication networks, coherent optical transmissions are nowadays a key solution to
reach high data rates [1]. The coupling of phase modulation
and coherent detection indeed facilitates wavelength division
multiplexing (WDM) and offers higher sensitivity as well as
the possibility of high-order modulation compared to direct
detection. Free-space inter-satellite communications links already benefit from the numerous advantages of using optical
transmission rather than or in addition to radio-frequency
communications, such as lower power consumption or higher
bandwidth [2], particularly with coherent methods [3]. Furthermore, recent analytical [4] [5] and experimental [6] [7] studies
have contributed to demonstrate the high potential of coherent
receiver for high data rate satellite-to-ground communications.
Uplink, downlink and bilateral communications experiments
between a ground station and low Earth orbit (LEO) and
geostationary (GEO) satellites based on coherent receiver
technology have even been established [8].
Both satellite-to-ground links and inter-satellite transmissions undergo Doppler effects due to the relative motion
L. Paillier, J-M. Conan and N. Védrenne are with ONERA, DOTA, Paris
Saclay University, F-92320 Châtillon, France e-mail: laurie.paillier@onera.fr
R. Le Bidan is with IMT Atlantique, Lab-STICC, UBL, 29238 Brest, France
G. Artaud is with CNES, 31400 Toulouse, France
Y. Jaouën is with LTCI, Télécom Paris, Institut Polytechnique de Paris,
75013 Paris, France
Manuscript received Month Day, Year; revised Month Day, Year.

between the emitter and the receiver [9][10]. This results in
a frequency shift of the incoming signal with respect to the
local oscillator (LO) frequency amplified by the frequency instability of both lasers, which disturbs carrier synchronization.
In this context, optical phase-locked loops (OPLL) naturally
appear as a solution to overcome this frequency mismatch and
perform carrier recovery in inter-satellite links [11][12].
However, the space-ground channel presents specific characteristics that need to be accounted for. The propagation through
atmospheric turbulence significantly and randomly impairs the
amplitude and phase of the optical wave [13]. As a result the
mixing efficiency between the incoming signal and the LO
oscillator collapses dramatically which ultimately reduces the
down-converted power. A state-of-the-art solution to mitigate
turbulence-induced phase distortions is the use an adaptive
optics (AO) system which improves the spatial phase matching
between the signals [8]. However the AO correction is not
perfect and residual phase aberrations remain. Moreover, the
random amplitude variations, called scintillation, also impair
the received signal without being compensated by the AO
system. To design an effective carrier recovery strategy, a fine
modelling of these turbulent effects is thus crucial. Previous
works have studied the performance of ground-space coherent
receivers based on statistical models of the turbulence effects
[4][14]. Their conclusions clearly show the interest in using
coherent modulation schemes. Open questions still remain
concerning the feasibility of phase locking in the presence
of realistic free-space optical (FSO) channel impairments.
In [7] the authors describe a digital coherent receiver based
on digital signal processing (DSP) techniques developed for
fiber-optic networks, with application to a 10.45 km FSO
horizontal link. Frequency offset compensation is done by
performing a Fourier transform of the signal. Then the DSP
system applies a Mth-power phase estimation to the signal
similar to those used in fiber-optic networks. A similar approach to phase recovery is presented in [14]. Neither of these
studies however does focus on the performance of the carrier
synchronization components. An analog solution combining an
OPLL and an optical injection loop is presented in [9] to deal
with Doppler frequency shifts up to 10 GHz for 10 Gb/s binary
phase-shift keying (BPSK) transmission. However the study
does not take into account the random amplitude fluctuations
induced by atmospheric turbulence.
In this article, we use an accurate numerical modeling of
the optical wave undergoing atmospheric turbulence and AO

JOURNAL OF LIGHTWAVE TECHNOLOGY, VOL. XX, NO. XX, MONTH 2019

correction to obtain realistic temporal series of the mixing
efficiency. We then present a digital closed-loop receiver
architecture for carrier synchronization combining a digital
automatic gain control (AGC) with a digital phase-locked loop
(DPLL), and characterize its performance in the presence of
realistic turbulence perturbation. PLLs have long been used for
coherent demodulation of wireless signals. One finds them in
particular at the heart of the robust carrier tracking techniques
used in global positioning satellite systems (GNSS) [15] for
their ability to track both a frequency offset and the phase
fluctuations of the signal induced by the channel. However,
as with any feedback system, the stability domain of the PLL
has to be carefully assessed. Compared to optical PLL, DPLL
have the advantage of flexibility and ease of reconfigurability.
As the initial frequency mismatch in space-ground FSO links
may be of the order of several GHz [9], we assume hereafter
that the major part of this offset is pre-compensated with a
coarse frequency estimator, based for example on ephemerides,
which is out of the scope of the present study. Our system
then acquires and tracks the residual shift with the objective
of maintaining accurate frequency and phase synchronization
during the pass of the satellite.
The overall architecture of a LEO satellite downlink using
AO compensation and the description of the parameters are
presented in Part II. The design of the digital carrier synchronization system is presented in Part III with a detailed focus
on the design of the DPLL. The system performance in the
presence of realistic propagation impairments is investigated
in Part IV. Conclusion follow in Section V.
II. M ODELING OF A COHERENT LEO- TO - GROUND LINK
A. Overall architecture

Fig. 1. General principle of a satellite-to-ground optical link with adaptive
optics correction

We consider a LEO-to-ground link having the overall architecture illustrated in Fig. 1 and Fig. 2. The transmitter at the
LEO satellite is located several hundreds of km away from
the optical ground station (OGS) receiver. Binary data are
first differentially encoded, then transmitted with BPSK by

2

modulating the phase of a continuous wave (CW) laser with
the help of an electro-optic modulator (EOM) such as a MachZehnder modulator. Compared to higher order modulation,
the BPSK modulator is more convenient to integrate with
the additional advantage of requiring less on-board power.
The optical signal is then amplified by a booster amplifier
and emitted in the direction of the OGS. The impact of the
booster amplifier and of the on-board laser phase noise on
the optical phase [16][17][18] will not be discussed in this
paper. During free-space propagation through the atmosphere,
the optical wave is severely degraded both in amplitude and
in phase by the atmospheric turbulence.
On the ground, the incoming signal is mixed with the LO.
An AO system is used in order to maximize the mixing
efficiency and thus the down-converted coherent power by
improving the spatial matching between the incoming and LO
fields, respectively. In practice, the AO operates as follows
[13]. A wavefront sensor (WFS) returns local information
on the incoming wavefront. The WFS data are processed by
the real-time computer (RTC) which controls the deformable
mirror (DM) and adapts the surface of the latter so as to correct
for the wavefront deformation. The resulting optical signal is
then coherently detected by an intradyne receiver, sampled by
an analog-to-digital converter (ADC), and demodulated by a
digital baseband receiver composed of a digital AGC, a DPLL,
a symbol detector and a differential decoder.
B. Channel description and modeling
Variations of humidity and temperature in the atmosphere
induce spatial and temporal random fluctuations of the refractive index of air. This phenomenon called atmospheric
turbulence disturbs the amplitude and phase of the optical
incident beam. The refractive index structure constant Cn2 (h)
quantifies the local strength of the turbulence along the line
of sight at different altitudes h, from the ground level to the
maximum altitude hmax (here hmax = 20 km). The Cn2 (h)
profile used is derived from the Hufnagel-Valley profile [19]
taken from the recommendation ITU-RP.1621-1. This model is
parametrized by the value of the Cn2 at the ground level C0 and
the high-altitude root-mean-square (RMS) wind speed parameter vRM S . A Bufton wind profile [20] is considered here. The
profile is defined by the wind speeds at the ground level vG
and at the tropopause vT . The spatial coherence of the optical
beam can be characterized by the Fried parameter r0 . This
parameter gives information on the total turbulence strength
along the line of sight. The scintillation index σI2 quantifies
the variations of power on the receiver pupil. Besides, the simulation also assumes a given outer scale L0 corresponding to
the characteristic size of the larger eddies inducing the energy
transfers in the atmosphere. The parameters characterizing the
simulated turbulence are given in Table I. In the table, the
Fried parameter and the scintillation index are given on the
line-of-sight at the wavelength λ = 1550 nm.
The turbulent parameters are chosen to simulate a representative channel using data taken from the literature [21].
We consider that the communication with the LEO satellite
is established at an elevation of 20 degrees to maximize the

JOURNAL OF LIGHTWAVE TECHNOLOGY, VOL. XX, NO. XX, MONTH 2019

3

Fig. 2. Overall architecture of a LEO-to-ground communication link with coherent detection

the remainder of this section and for the ease of exposition,
the modulated phase and the frequency mismatch are for now
discarded when defining the complex signal amplitudes. The
residual phase φres corresponds to the residual phase perturbation due to the atmospheric turbulence φtur compensated
by the AO phase correction ϕAO :

TABLE I
L INK C HARACTERISTICS AND T URBULENT PARAMETERS FOR A
LEO- TO -G ROUND S CENARIO
Parameters

Values

Propagation wavelength λ
C0
RMS wind speed parameter vRM S
Wind speed at the ground level vG
Wind speed at the tropopause vT
Fried parameter r0
Outer scale L0
Scintillation index σI2
Elevation
Satellite transverse velocity
Rx aperture diameter DRX

1550 nm
10−13 m−2/3
20 m.s−1
10 m.s−1
20 m.s−1
0,039 m
5m
0.684
20 deg
6.5 km.s−1
50 cm

φres (r, t) = ϕtur (r, t) − ϕAO (r, t)

(2)

The LO is represented by a Gaussian mode in the aperture
plane [25] :
ELO (r, t) = ALO exp(−r2 /w02 )

duration of the data transmission. Realistic temporal series of
the propagated complex field are obtained using the end-toend propagation code TURANDOT developed by ONERA in
cooperation with CNES [22]. In this method, the turbulent
volume is sampled in discrete layers (here 35 layers) and
a split-step algorithm performs Fresnel propagation between
each discrete phase screen. The field entering the atmosphere
at the altitude hmax is approximated by a plane wave considering the very large propagation distance from the satellite.
The complex field received within the telescope pupil plane
is then sent to an end-to-end adaptive optics simulation. We
assume that the correction modes are the Zernike polynomials
(here up to mode 91, that is 12 radial orders) [23]. The AO
simulation models a closed loop at a given sampling frequency
(here 5kHz) with a 2 frame loop delay. The chosen AO design
parameters are inspired from [24] and lead to an average flux
penalty of -4.5 dB in the turbulent conditions described above.
The WFS noise is neglected since requirements imposed by
the data transmission lead to a high flux regime from the WFS
point of view.
The electromagnetic field’s complex amplitude of the incident beam after propagation through turbulence and correction
with AO is characterized by :

(3)

where ALO is the constant amplitude of the LO and w0 is
D
to maxthe mode radius. The mode radius is set to w0 = 2.2
imize the efficiency while neglecting the central obscuration
|2
influence [26]. The LO power is denoted by PLO = |ALO
.
2
Bi-dimensional scintillation and phase maps are illustrated in
Fig. 3a and 3b. Turbulent phase residuals after AO correction is
illustrated on Fig. 3c. Fig. 3d shows the Gaussian distribution
of the LO mode projected in the aperture plane. The mixing
efficiency between the incoming signal and the Gaussian mode
of the LO is affected by the residual turbulence effect after the
AO compensation. The instantaneous mixing efficiency can
be derived from the complex coupling defined for instance in
[27]. The complex coupling is an overlap integral expressed
in the aperture plane, and reads:
Z
∗
C(t) =
ELO
(r, t)ERX (r, t)dr
(4)
P

where the pupil transmittance P is defined by

1 if 0 6 2|r| 6 DRX
P (r) =
0 otherwise

(5)

The instantaneous coupling efficiency ρ(t) and the phase
noise φ(t) coming from the propagation are denoted as:
ρ(t) = |C(t)|2

(6)

φ(t) = arg(C(t))

(7)

C. Impact of the turbulence on the complex coupling
ERX (r, t) = AT X exp(χ(r, t) + i(φres (r, t))

(1)

The factor AT X is a function of the emitted power. χ represents the log-amplitude fluctuation induced by scintillation
and r is the transverse two-dimensional spatial coordinate. In

The simulation tool provides correlated time series of both
the coupling efficiency and the phase noise in the considered
turbulent conditions. The 2-seconds duration time series presented in this paragraph are those that will be used later in

JOURNAL OF LIGHTWAVE TECHNOLOGY, VOL. XX, NO. XX, MONTH 2019

(a)

(b)

4

(c)

(d)

Fig. 3. a. Pupil amplitude map due to scintillation b. Turbulent phase in the pupil c. Residual phase after AO correction d. Amplitude of a Gaussian mode
D
at w0 = 2.2
. The phase maps are illustrated modulo 2π.

the end-to-end system simulation and performance evaluation
described in part IV.
Fig. 4 presents the coupling efficiency ρ of the optical
flux with and without AO compensation using the parameters
described in the section II-B. Fig. 4 shows that the average flux
penalty due to the turbulence is reduced from -23 dB to -4.5
dB thanks to the AO correction. Besides the cumulative density
(a)

(b)

Fig. 5. Statistics of the coupled efficiency. a. Cumulative probabilities with
and without AO correction b. Histogram of simulated coupling efficiency with
and without AO correction (arbitrary unit).

Fig. 4. Downlink 2s duration time series of coupling efficiency. Comparison
between a time series without correction and with an AO correction of 12
radial orders at the frequency of 5 kHz.

function and the probability density function (PDF) presented
in Fig. 5 provide a quantification of the fading probability
of occurrence and also prove that the system reduces the
amplitude of the signal fluctuations.
Fig. 6 presents the turbulent phase noise φ. Most of the
residual phase noise can be attributed to the turbulent piston
mode which is not corrected by traditional adaptive optics
systems [28]. As shown on Fig. 6 the coherence time of the
fluctuations are of the order of 1 ms. It is slower than the
phase noise fluctuations of the laser sources currently in use
in terrestrial fiber networks. This phase noise is also much
slower than the symbol rate of 10 Gbaud. We still quantify
the effect of the turbulent phase noise in section IV-C.

Fig. 6. Downlink 2s duration time series of phase noise with an AO correction
of 12 radial orders.

III. C OHERENT DETECTION AND BASEBAND DIGITAL
SIGNAL PROCESSING DESIGN

The signal after coherent detection and digitization is described in part III-A. Then, the overall digital carrier synchronization architecture is presented in part III-B and is followed
by a description of the digital AGC loop (see part III-C) and
PLL (see part III-D). The design and characterization of the
DPLL are presented in part III-D and III-E, respectively, for
a constant amplitude signal with BPSK modulation. Results
in the presence of turbulent amplitude fluctuations and phase

JOURNAL OF LIGHTWAVE TECHNOLOGY, VOL. XX, NO. XX, MONTH 2019

5

noise will be presented in part IV.
A. Coherent intradyne detection and digitization
During the pass of the satellite, the data signal experiences
a frequency shift because of the Doppler effect and because
of the natural frequency drift of the satellite laser source
due to temperature variations for instance. The Doppler shift
due to the relative speed of a LEO satellite with respect
to the ground has been estimated in [9] to cover a total
range of approximately 9 GHz (from -4.5 GHz to 4.5 GHz).
This frequency shift is critical for the carrier synchronization
between the incoming signal and the local oscillator. In the
following, this intermediate frequency is denoted ∆f =
ωRX −ωLO
0
= ∆ω
2π
2π . We consider that the major part of the
frequency mismatch induced by the Doppler effect is precompensated by a preliminary coarse frequency estimation
stage based for instance on the knowledge of the satellite
trajectories. Similarly to inter-satellites communications, a
residual frequency shift still remains, due among other things
to the instability of the frequency of the emitter laser and of the
LO. We further assume that this residual shift is of the same
order as those encountered in inter-satellite communication
[11] [29]. Hereafter a maximum constant frequency offset of
100 MHz is considered.
After AO correction, the optical signal is sent to the coherent
receiver and mixed with the LO signal for frequency downconversion. After the balanced detection the signal is sampled
and digitized in the form of the real part sRX,I and imaginary part sRX,Q of the down-converted complex amplitude,
respectively, where
p
sRX,I (k) ∝ ρ(k) cos(∆ωkT + ϕm (k) + φ(k)) (8)
p
sRX,Q (k) ∝ ρ(k) sin(∆ωkT + ϕm (k) + φ(k)) (9)
Eq. (8) and Eq. (9) are relative to the discrete-time sample
collected in the time-interval [kT ; (k + 1)T [ where T denotes
the symbol time. Ideal symbol synchronization is assumed.
BPSK modulation is included here in the modulated phase
term ϕm (k) ∈ {0, π}. These equations can be derived from
Eq. (6) and Eq. (7) by further accounting for the sampling
process, frequency
mismatch and BPSK phase
p
√ modulation.
Note that ρ(k) corresponds to the usual PRX PLO term
related to the received power and LO power. Hereafter the
LO power is assumed to be larger than the signal power so
that the dominant noise source is shot noise, modeled as an
additive white Gaussian noise process [30].
In the following we consider that the coupling efficiency
ρ and phase noise φ induced by the propagation through the
atmosphere, described in Fig. 4 and Fig. 6, remain constant
during a symbol time.
B. Digital receiver architecture
In this part, we describe a baseband digital receiver for data
demodulation and detection which operates at the symbol rate
and consists of a PLL assisted by an AGC loop, followed by
the symbol detector. Fig. 7 depicts the overall architecture.

Fig. 7. Digital receiver architecture under consideration.

First the signal coming from the ADC is sent to an AGC
loop described in part III-C. The role of the AGC system
is to maintain the received signal power at a constant target
value, thereby reinforcing the robustness of the PLL against
amplitude fluctuations.
The signal is then sent to the DPLL which first locks onto
the frequency shift, then tracks the phase and frequency small
variations of the signal. The design of the DPLL is described
and discussed in part III-D. A BPSK symbol detector and a
differential decoder follow in order to recover the transmitted
bits from the symbol-rate discrete-time sample at the DPLL
output. These two operations are standard practice in digital
communication systems and will not be further detailed here.
C. Digital Automatic Gain Control
The role of the digital AGC is to maintain the signal power
at a constant value. The block diagram of the digital AGC
architecture retained in this work is presented in Fig. 8.

Fig. 8. Block diagram of the digital automatic gain control loop.

The signal power is first compared to a target reference
power PRef which controls the desired AGC output amplitude,
to form the error signal
e(k) = |sagc (k)|2 − PRef

(10)

Hereafter a unit power PRef = 1 is chosen as reference. The
error signal e(k) is then multiplied by a constant gain factor
G0 and passed through a numerically controlled oscillator
(NCO), here in the form of a first-order integrator with transfer
function 1/(z − 1). The AGC gain was set to G0 = 0.1 as a
trade-off between stability and convergence speed of the loop.
Based on the control signal delivered by the NCO, the AGC
adjusts the amplitude of the incoming signal sRX through the
variable gain function g(k). An exponential characteristic was
chosen to ensure that the acquisition time only depends on the
AGC parameters and not on the dynamics input signal [31] :


v(k)
(11)
g(k) = exp −
2
v(k) corresponding to the output signal of the NCO.

JOURNAL OF LIGHTWAVE TECHNOLOGY, VOL. XX, NO. XX, MONTH 2019

D. Digital Phase locked loop
The purpose of the DPLL is to synchronize accurately the
phase and frequency of the local oscillator with the received
signal so as to minimize the residual phase error between
the two signals. Fig. 9 shows the block diagram of the PLL
under consideration. The loop consists of 3 main components:
a phase detector, a loop filter and an NCO.

Fig. 9. Block diagram of the digital phase locked loop.

In the remainder of this section, the incoming signal amplitude is assumed to be constant. Performance in the presence
of turbulence, amplitude fluctuations and phase noise will be
investigated later in Part IV. From standard detection theory
results, the optimal MAP phase detector for estimating an
unknown carrier phase offset affecting a BPSK modulated
signal without prior knowledge on the transmitted data is [32]:
(k) = spll,Q (k) tanh (spll,I (k))

(12)

where spll,I and spll,Q are respectively the real and the
imaginary parts of the signal. At low signal-to-noise ratio
(SNR) this error signal is well-approximated by [33] :
(k) = spll,I (k) spll,Q (k)

(13)

The corresponding phase detector has a semi-sinusoidal response in the absence of noise:
Kd
sin(2ϕ(k))
(14)
2
where Kd is the average signal power and ϕ(k) = ∆ω k is
the discrete-time phase offset to be estimated. Note that the
estimation of the phase error depends on the amplitude of
the incoming signal through the factor Kd . Knowledge of the
latter is required in the PLL design.
The phase error signal delivered by the phase detector is
smoothed by a second-order loop filter having gains K1 and
K2 and discrete-time transfer function:


K2
(15)
F (z) = K1 1 +
z−1
(k) =

The result is sent to the NCO which is implemented as a firstorder integrator with transfer function K0 /(z − 1) and unit
gain K0 = 1. The phase error estimate is finally removed
from the incoming signal phase of the next sample, thereby
closing the loop.
Designing the PLL requires choosing the gain coefficients
Kd , K1 and K2 . To this end and following common practice
in the field, we chose to work with three intermediate variables
having more physical relevance, namely the damping factor ξ,
the loop bandwidth BL and the natural frequency ωn . Those

6

parameters are defined in the literature [34] for analog loops
from the linearized system transfer function assuming that the
phase error is small. By applying this method to the digital
case, Eq. (14) is linearized as (k) = Kd ϕ(k), and we obtain
the following discrete-time equivalent formulas for our three
parameters of interest
1
(K + K2 )
4
r
1 K
ξ=
2 K2
p
ωn T = KK2

BL T =

(16)
(17)
(18)

where K = Kd K1 K0 denotes the global loop gain. It is noted
in [34] that the analog formulas are good approximations for
the DPLL parameters as long as ωn is small compared to the
sampling rate, here equal to the symbol rate 10 GBaud. For our
design and based on Eq. (18), we obtain that ωn = 9.3 M Hz.
This condition is thus fulfilled. The design parameters adopted
here have the additional advantage that they can be easily
related to the pull-in time which measures the time required by
the loop to establish the lock. Adopting the same approach as
before, based on the pull-in time definition for analog loops
[34], we obtain the following formula for a signal without
amplitude fluctuation and a target frequency offset ∆ω:
Tp =

2∆ω 2
ξωn3

(19)

It is common practice in the field to give the damping factor
the value ξ = √12 as a trade-off between stability of the
loop and speed of convergence [34]. The duration of a LEO
satellite pass is only of a few minutes so the pull-in time of
the loop needs to be much shorter to maximize the duration of
the data transmission. The normalized loop bandwidth BL T
characterizes the sensitivity of the loop to cycle slips due to
noise but also directly affects the acquisition range as well as
the convergence speed of the loop. Consequently and given our
target frequency mismatch of 100 MHz, we set BL T = 0.0005
to ensure that such an offset falls within the loop acquisition
capabilities with a reasonably small pull-in time compared
to the satellite pass duration and to minimize at the same
time the probability of cycle slips occurrence during the pass.
Knowledge of the damping factor ξ and of the normalized
loop bandwidth BL T is enough to set the remaining loop gain
factors K1 and K2 provided the average signal power Kd is
known. Our design assumes unit incoming power Kd = 1 (an
hypothesis reinforced by the AGC). The main parameters of
the resulting DPLL are summarized in Table II.
E. PLL characterization without turbulence
Fig. 10 shows the acquisition phase of the presented system.
Here, the loop locks after 1.4 ms for an initial frequency offset
∆f = 100 MHz. The DPLL is thus able to acquire the target
frequency shift in a reasonable time compared to the duration
of a satellite pass. Furthermore and as expected, the measured
acquisition time is in accordance with the value obtained from
Eq. (19), which predicts Tp ≈ 1.4 ms.

JOURNAL OF LIGHTWAVE TECHNOLOGY, VOL. XX, NO. XX, MONTH 2019

further increases and the squaring-loss becomes asymptotically
negligible. This validates our design. At SNR values lower
than the critical SNR, the previous design assumptions and
formulas no longer apply since the DPLL operates in a highly
non-linear regime and proves to be unable to reach a stable
state. However we do not expect the system to operate in such
conditions.

TABLE II
P HASE -L OCKED L OOP M AIN PARAMETERS
Parameters

Values

T
Damping factor

0.1 ns

Loop bandwidth BL
K1
K2
Loop frequency

5 MHz
1.3.10−3
6.7.10−4
10 GHz

7

√1
2

Fig. 11. Variance of the phase error at the DPLL output as a function of the
SNR and comparison with the theoretical bounds
Fig. 10. Frequency offset evolution during lock-in at SNR Es /N0 = 8 dB

In the presence of noise, the error signal (k) consists
of the signal term K2d sin(2ϕ(k)) plus terms involving the
products signal × noise and noise × noise. As for any other
estimator, the loop performance in the presence of noise is
lower-bounded by the Cramer-Rao bound (CRB) which, for
an analog loop operating on a constant amplitude sinusoidal
signal without phase modulation, reads
2
σCRB
=

BL T

(20)

Es
N0

In addition, the variance of a linear-operating PLL is known to
meet this bound [34]. In the case of a BPSK modulated signal,
the modulation induces a penalty on the previous bound, the
so-called squaring-loss penalty [32]. The variance of the error
Es
is then well-approximated by
signal at high-enough SNR N
0
2
σBP
SK =

BL T
ES
N0

×

S
2E
N0
S
2E
N0

+1

(21)

To validate the behavior of the DPLL in the presence of
additive white gaussian noise (AWGN), we have plotted in
Fig. 11 the phase error variance as a function of SNR in
steady-state performance (transients occurring during the acquisition period have been excluded from the calculation). We
first note the existence of a minimum SNR value, here around
-9 dB, under which the DPLL is unable to lock and becomes
unstable. Above this critical SNR value, the measured phase
error variance quickly converges towards the theoretical bound
given by Eq. (21). The latter reaches the CRB as the SNR

IV. S YSTEM PERFORMANCE WITH ADAPTIVE OPTICS
Having validated the proposed digital carrier recovery system in the ideal case of a BPSK modulated signal impaired
by AWGN only, we now investigate its robustness in more
realistic propagation conditions based on the FSO link model
described in Section II, more precisely on the simulated time
series obtained after AO correction and presented in Fig. 4
and 6, respectively. First the role of the AGC loop in such an
uncertain environment is highlighted. Then we characterize
the convergence and tracking performance of the DPLL in the
presence of amplitude fluctuations and turbulent phase noise.
We finally evaluate the numerically estimated bit-error rate
(BER) performance of the overall transmission system.

A. Fluctuations mitigation with automatic gain control
The main purpose of the digital AGC is to compensate for
the slow residual amplitude fluctuations caused by atmospheric
turbulence that remain after AO correction. A unit target
reference power PRef = 1 is used in the loop so as to match
the assumption of unit signal gain Kd = 1 used in our DPLL
design (see Section III-D.D), thereby ensuring that the loop
will run in nominal operating conditions. Fig. 12 shows the
impact of the AGC on the received signal power variations.
Note that the multiplicative gain of the AGC loop impacts
equally the signal and the noise. In particular, in deep fades,
both the signal and the noise are amplified.

JOURNAL OF LIGHTWAVE TECHNOLOGY, VOL. XX, NO. XX, MONTH 2019

8

to the case without amplitude fluctuation, as can be seen by
comparing Fig. 14 and Fig. 11.

(a)

(b)

Fig. 12. 10ms duration time series of the AGC (a) input and (b) output power
at an average SNR of 30dB (value chosen for illustration purpose only).

B. Digital frequency shift compensation
After the AGC loop the signal is sent to the PLL. Fig. 13
presents the acquisition step of the PLL at an average SNR of
8dB. The initial frequency offset between the incoming signal
and the LO was again set to 100 MHz. It is interesting to note
that despite the residual amplitude fluctuations, the theoretical
prediction still applies since the DPLL requires again 1.4 ms
only to converge. This confirms that with proper prior AO
correction and AGC compensation, the proposed digital carrier
synchronization solution can maintain very short lock-in time
compared to the duration of the satellite pass even in turbulent
conditions.

Fig. 14. Phase error variance as a function of the mean SNR of the 2sduration time series with and without turbulent phase noise after the DPLL
compared to the theoretical expressions.

Fig. 13. Frequency error during the lock-in process. Temporal series with a
mean SNR of 8 dB

D. BER performance
Once the amplitude variations and the frequency offset have
been corrected, BPSK symbol detection is performed, followed
by differential decoding in order to remove the phase ambiguity which may subsist when the PLL locks onto an incorrect
phase due to the rotational symmetry of the PSK constellation.
Fig. 15 shows the BER performance of the simulated system
evaluated on the 2s-duration time series presented in Fig. 4
as a function of the average SNR. The BER is calculated
once convergence is acquired. We first note that the BER
performance is virtually the same with and without frequency
offset (set to 100 MHz in the simulation). This demonstrates
the capability of the proposed digital carrier recovery solution
to correct the target frequency offset without BER penalty.
For reference purpose, the theoretical BER performance for
differentially-encoded BPSK with coherent detection and differential decoding over AWGN is also shown. By comparing
the two curves, the fadings caused by atmospheric turbulence
are seen to result in a 2.3 dB power penalty at a BER=10−4 .

Fig. 14 shows the evolution of the variance of the phase
error at the DPLL output (excluding the acquisition period)
as a function of the average SNR on the overall time series.
The results are compared to the theoretical expression given
in Eq. (21) and derived for a constant amplitude signal and an
analog loop. The results closely match the bound prediction
at average SNRs of 8 dB and higher. This proves that the
DPLL is able to maintain the lock and accurately track the
residual phase fluctuations even in the presence of turbulence.
Interestingly, in the present case, the main impact of fading is
to increase the minimal critical SNR value under which the
DPLL becomes unstable by approximately 5 dB compared

C. Impact of turbulent phase noise with adaptive optics correction
To confirm that the turbulent phase noise φ has no impact
on the proposed carrier synchronization system performance,
the same simulation is done with an initial frequency offset
∆f = 100 M Hz and the turbulent phase noise shown in
Fig. 6. The variance of the residual phase error measured at
the DPLL output has been superimposed on the other results
in Fig. 14. Negligible differences are observed with respect to
the performance without turbulent phase noise.

V. C ONCLUSION
Coherent receivers are gradually emerging as a key enabler
for high-data-rate communications not only in fiber-optics

JOURNAL OF LIGHTWAVE TECHNOLOGY, VOL. XX, NO. XX, MONTH 2019

9

within the loop. Finally, all the present work assumed ideal
timing recovery. In practice the latter will also be impaired
by the Doppler effect and by the signal fadings prompting the
need for robust digital symbol synchronization algorithms.
ACKNOWLEDGMENT
This work was conducted in the framework of a PhD thesis
co-funded by ONERA and CNES.
R EFERENCES

Fig. 15. BER performance as a function of the average SNR

networks but also in free-space optical communications. In
this paper, we have investigated end-to-end link modeling and
receiver architecture design for a coherent 10 Gb/s BPSK
LEO satellite-to-ground FSO transmission in the presence of
realistic atmospheric turbulence. At the ground station, AO
correction is used to improve the mixing efficiency of the
incoming signal with the LO and achieve an average flux
penalty of -4.5 dB. The impact of the propagation and AO
correction on the phase noise has also been characterized.
After intradyne detection, a digital receiver architecture has
been proposed that combines an AGC with a PLL in order
to recover from Doppler frequency offsets and track residual
phase variations in the presence of atmospheric turbulence.
The overall performance of this system has been characterized
based on realistic time series of a representative LEO-toground link with AO correction obtained from end-to-end
simulations. The AO correction enables the system to operate
and limits the effect of turbulent amplitude fluctuations of the
coupled flux. The digital receiver is able to acquire and track
frequency offsets up to 100 MHz in a few ms, a reasonable
amount of time compared to the pass duration of a LEO
satellite, and without BER penalty with respect to the ideal
case of a LO perfectly synchronized in phase and frequency
with the received signal. We however show that amplitude
fluctuations degrade the BER performance and we quantify
this effect. We also demonstrate that the turbulent phase noise
has negligible impact on the carrier synchronization process.
In this paper, the DPLL was shown to be a simple and
robust solution to the problem of Doppler frequency offset
correction and phase tracking in coherent satellite-to-ground
FSO links. Other solutions may however be considered. In
particular, the performance and robustness of open-loop carrier
synchronization algorithms such as those used in fiber-optics
networks should also be investigated in similar conditions.
Also, the DPLL was specifically designed for BPSK modulation in this work. The same methodology can however be
extended in a straightforward manner to higher-modulation
formats by modifying accordingly the phase detector function

[1] P. J. Winzer, D. T. Neilson, and A. R. Chraplyvy, “Fiber-optic transmission and networking: the previous 20 and the next 20 years,” Optics
express, vol. 26, no. 18, pp. 24 190–24 239, 2018.
[2] H. Kaushal and G. Kaddoum, “Optical communication in space: challenges and mitigation techniques,” IEEE communications surveys &
tutorials, vol. 19, no. 1, pp. 57–96, 2016.
[3] F. Heine, G. Mühlnikel, H. Zech, S. Philipp-May, and R. Meyer, “The
european data relay system, high speed laser based data links,” in 2014
7th Advanced Satellite Multimedia Systems Conference and the 13th
Signal Processing for Space Communications Workshop (ASMS/SPSC).
IEEE, 2014, pp. 284–286.
[4] A. Belmonte and J. M. Kahn, “Capacity of coherent free-space optical links using atmospheric compensation techniques,” Optics express,
vol. 17, no. 4, pp. 2763–2773, 2009.
[5] ——, “Satellite downlink coherent laser communications,” in Optical
Wireless Communications. Springer, 2016, pp. 325–343.
[6] R. Mata-Calvo, J. Poliak, J. Surof, A. Reeves, M. Richerzhagen, H. F.
Kelemu, R. Barrios, C. Carrizo, R. Wolf, F. Rein et al., “Optical
technologies for very high throughput satellite communications,” in
Free-Space Laser Communications XXXI, vol. 10910. International
Society for Optics and Photonics, 2019, p. 109100W.
[7] P. Conroy, J. Surof, J. Poliak, and R. Mata-Calvo, “Demonstration of 40
gbaud intradyne transmission through worst-case atmospheric turbulence
conditions for geostationary satellite uplink,” Applied optics, vol. 57,
no. 18, pp. 5095–5101, 2018.
[8] K. Saucke, C. Seiter, F. Heine, M. Gregory, D. Tröndle, E. Fischer,
T. Berkefeld, M. Feriencik, M. Feriencik, I. Richter et al., “The tesat
transportable adaptive optical ground station,” in Free-Space Laser
Communication and Atmospheric Propagation XXVIII, vol. 9739. International Society for Optics and Photonics, 2016, p. 973906.
[9] Y. Shoji, M. J. Fice, Y. Takayama, and A. J. Seeds, “A pilot-carrier
coherent leo-to-ground downlink system using an optical injection phase
lock loop (oipll) technique,” Journal of Lightwave Technology, vol. 30,
no. 16, pp. 2696–2706, Aug 2012.
[10] W. Rosenkranz and S. Schaefer, “Receiver design for optical intersatellite links based on digital signal processing,” in 2016 18th International Conference on Transparent Optical Networks (ICTON). IEEE,
2016, pp. 1–4.
[11] T. Ando, E. Haraguchi, K. Tajima, Y. Hirano, T. Hanada, and S. Yamakawa, “Coherent homodyne receiver with a compensator of doppler
shifts for inter orbit optical communication,” in Free-Space Laser
Communication Technologies XXIII, vol. 7923. International Society
for Optics and Photonics, 2011, p. 79230J.
[12] S. Schaefer, M. Gregory, and W. Rosenkranz, “Numerical investigation
of a free-space optical coherent communication system based on optical
phase-locked loop techniques for highspeed,” in Photonic Networks; 16.
ITG Symposium. VDE, 2015, pp. 1–6.
[13] F. Roddier, Adaptive optics in astronomy. Cambridge university press,
1999.
[14] E. A. Valencia, “Atmospheric compensation experiments on free-space
optical coherent communication systems,” Ph.D. dissertation, University
of Barcelona, 2015.
[15] J. A. López-Salcedo, J. A. Del Peral-Rosado, and G. Seco-Granados,
“Survey on robust carrier tracking techniques,” IEEE Communications
Surveys & Tutorials, vol. 16, no. 2, pp. 670–688, 2013.
[16] L. Moller, “Novel aspects of spectral broadening due to fiber amplifier
phase noise,” IEEE journal of quantum electronics, vol. 34, no. 9, pp.
1554–1558, 1998.
[17] E. Rochat and R. Dandliker, “New investigations on the effect of fiber
amplifier phase noise,” IEEE Journal of Selected Topics in Quantum
Electronics, vol. 7, no. 1, pp. 49–54, 2001.

JOURNAL OF LIGHTWAVE TECHNOLOGY, VOL. XX, NO. XX, MONTH 2019

[18] I. Ricciardi, S. Mosca, P. Maddaloni, L. Santamaria, M. De Rosa, and
P. De Natale, “Phase noise analysis of a 10 watt yb-doped fibre amplifier
seeded by a 1-hz-linewidth laser,” Optics express, vol. 21, no. 12, pp.
14 618–14 626, 2013.
[19] G. C. Valley, “Isoplanatic degradation of tilt correction and short-term
imaging systems,” Appl. Opt., vol. 19, no. 4, pp. 574–577, Feb 1980.
[Online]. Available: http://ao.osa.org/abstract.cfm?URI=ao-19-4-574
[20] J. L. Bufton, “Comparison of vertical profile turbulence structure with
stellar observations,” Applied optics, vol. 12, no. 8, pp. 1785–1793, 1973.
[21] T. D. K. Kudielka, E. Fischer, “Numerical prediction and experimental
validation of irradiance fluctuations in a pre-compensated optical feeder
link,” vol. 11180, 2019. [Online]. Available: https://doi.org/10.1117/12.
2536122
[22] N. Védrenne, J.-M. Conan, M.-T. Velluet, M. Séchaud, M. Toyoshima,
H. Takenaka, A. Guérin, and F. Lacoste, “Turbulence effects on bidirectional ground-to-satellite laser communication systems,” in International Conference on Space Optical Systems and Applications, 2012.
[23] R. J. Noll, “Zernike polynomials and atmospheric turbulence∗,” J. Opt.
Soc. Am., vol. 66, no. 3, pp. 207–211, Mar 1976. [Online]. Available:
http://www.osapublishing.org/abstract.cfm?URI=josa-66-3-207
[24] N. Védrenne, J.-M. Conan, C. Petit, and V. Michau, “Adaptive optics
for high data rate satellite to ground laser link,” vol. 9739, 2016.
[Online]. Available: https://doi.org/10.1117/12.2218213
[25] S. Shaklan and F. Roddier, “Coupling starlight into single-mode fiber
optics,” Applied Optics, vol. 27, no. 11, pp. 2334–2338, 1988.
[26] B. J. Klein and J. J. Degnan, “Optical antenna gain. 1: Transmitting
antennas,” Applied optics, vol. 13, no. 9, pp. 2134–2141, 1974.
[27] K. A. Winick, “Atmospheric turbulence-induced signal fades on
optical heterodyne communication links,” Appl. Opt., vol. 25,
no. 11, pp. 1817–1825, Jun 1986. [Online]. Available: http:
//ao.osa.org/abstract.cfm?URI=ao-25-11-1817
[28] C. Robert, J.-M. Conan, and P. Wolf, “Impact of turbulence on highprecision ground-satellite frequency transfer with two-way coherent
optical links,” Phys. Rev. A, vol. 93, p. 033860, Mar 2016. [Online].
Available: https://link.aps.org/doi/10.1103/PhysRevA.93.033860
[29] S. Schaefer, M. Gregory, and W. Rosenkranz, “Coherent receiver design
based on digital signal processing in optical high-speed intersatellite
links with m-phase-shift keying,” Optical Engineering, vol. 55, no. 11,
p. 111614, 2016.
[30] J. R. Barry and E. A. Lee, “Performance of coherent optical receivers,”
Proceedings of the IEEE, vol. 78, no. 8, pp. 1369–1394, 1990.
[31] J. Ohlson, “Exact dynamics of automatic gain control,” IEEE Transactions on Communications, vol. 22, no. 1, pp. 72–75, January 1974.
[32] M. K. Simon and J. Hamkins, “Carrier synchronization,” Autonomous
Software-Defined Radio Receivers for Deep Space Applications, p. 227,
2006.
[33] M. Simon, “On the optimality of the map estimation loop for carrier
phase tracking bpsk and qpsk signals,” IEEE Transactions on Communications, vol. 27, no. 1, pp. 158–165, January 1979.
[34] F. M. Gardner, Phaselock techniques. John Wiley & Sons, 2005.

Laurie Paillier received her Master of Science in Optics Engineering at the
Télécom Saint-Etienne Engineering School, Saint-Etienne, France, in 2017.
She is currently pursuing her PhD in Optical Telecommunication at ONERA,
the French Aerospace Lab, and the Institut Polytechnique de Paris, France, in
collaboration with Télécom Paris, IMT-Atlantique and CNES. Her research
focuses on optical coherent links from space to ground using adaptive optics
systems.

Raphael Le Bidan (M’03) received the Eng. Degree in Telecommunications
and the M. Sc. Degree in Electrical Eng. from the Institut National des
Sciences Appliques (INSA), Rennes, France, in June 2000, and the Ph. D.
degree in Electrical Eng. from the INSA, Rennes, in November 2003. Since
December 2003, he is working as an associate professor at IMT Atlantique
(formerly ENST Bretagne), in the Signal & Communications dept. Much
of his research interests currently focus on forward error codes and digital
receiver design for coherent high-throughput fiber and free-space optical
transmission systems.

10

Jean-Marc Conan received the Ph.D. degree from Institut d’Optique Graduate School, France, in 1994. He has been working for more than 20 years in
the High Angular Resolution unit of ONERA, the French Aerospace Lab.
His major publications focus on: modeling of turbulence optical effects,
optimal control for adaptive optics and wide field tomographic adaptive optics.
Originally working in the field of astronomical imaging, he now explores
other applications that benefit from this background: impact of turbulence
on ground-space optical links for either high capacity telecommunications or
high precision frequency transfer.

Géraldine Artaud has been working for CNES since 2006. She is working
on space to earth high data rate communications in RF and optics. She is
involved in the study of future systems using optical data transmissions for
space. She is the responsible at CNES of the DOMINO demonstrator.

Nicolas Védrenne received the Ph.D degree from Nice-Sophia Antipolis
University, France, in 2008. He is the manager of the High Angular Resolution
unit of ONERA, the French Aerospace Lab. The research unit has a long
term experience in optical wave propagation through the atmosphere and
its correction by adaptive optics. The team has developed TURANDOT, the
wave optics code dedicated to the simulation of atmospheric turbulence on
ground-satellite laser links. It participates to the development of turbulence
mitigation techniques, including definition of interleaving and error correcting
codes. It is involved in the DOMINO project, CNES demonstrator for laser
communications, and leads the FEEDELIO project for ESA aiming at the
experimental demonstration of the pre-compensation by adaptive optics for
GEO feeder links.

Yves Jaouën received the Ph.D degree in Physics from Ecole Nationale
Supérieure des Télécommunications (ENST), Paris, France in 1993, then
his HDR (Research management certificate) in 2003. He had joined ENST
(now called Télécom Paris) in the Communications and Electronic department
in 1982 where he is currently professor. He is lecturing in the domain
of electromagnetic fields, optics and optical communications systems. His
present researches include high bit rate coherent optical communication
systems including digital signal processing aspects, new characterization
techniques for advanced photonic devices, high power fiber lasers, fiber optics
and remote sensing. He is author or co-author of more 230 papers in journals
and communications.

