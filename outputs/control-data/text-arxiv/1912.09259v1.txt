Indistinguishable photons from a trapped-ion quantum network node
V. Krcmarsky,

1, 2

1, 2

J. Schupp,

M. Meraner† ,1, 2 A. Mazloom† ,3 V. Krutyanskiy† ,1
D. Fioretto,2 P. Sekatski,3 T. E. Northup,2 N. Sangouard,4, 3 and B. P. Lanyon1, 2, ∗

arXiv:1912.09259v1 [quant-ph] 19 Dec 2019

1
Institut für Quantenoptik und Quanteninformation,
Österreichische Akademie der Wissenschaften, Technikerstr. 21A, 6020 Innsbruck, Austria
2
Institut für Experimentalphysik, Universität Innsbruck, Technikerstr. 25, 6020 Innsbruck, Austria
3
Departement Physik, Universität Basel, Klingelbergstrasse 82, CH-4056 Basel, Switzerland
4
Institut de physique théorique, Université Paris Saclay, CEA, CNRS, F-91191 Gif-sur-Yvette, France

Trapped atomic ions embedded in optical cavities are a promising platform to enable long-distance
quantum networks and their most far-reaching applications. Here we achieve and analyze photon indistinguishability in a telecom-converted ion-cavity system. First, two-photon interference of cavity
photons at their ion-resonant wavelength is observed and found to reach the limits set by spontaneous emission. Second, this limit is shown to be preserved after a two-step frequency conversion
replicating a distributed scenario, in which the cavity photons are converted to the telecom C band
and then back to the original wavelength. The achieved interference visibility and photon efficiency would allow for the distribution and practical verification of entanglement between ion-qubit
registers separated by several tens of kilometers.

Envisioned quantum networks, consisting of remote
quantum matter linked up with light [1, 2], offer a fundamentally new communication paradigm [3] as well as a
practical path to large-scale quantum computation and
simulation [4] and to precision measurements in new
regimes [5–7]. Trapped atomic ions are expected to enable the most promising applications of large-scale quantum networks [8–10] given their demonstrated capabilities for quantum logic [11], multi-qubit registers [12], and
optical clocks [13]. Ion qubits have been entangled with
propagating photons [14] and those photons have been
used to entangle ions in traps a few meters apart [15–17].
Integrating ion traps with optical cavities offers the possibility of a near-deterministic and coherent light-matter
interface for quantum networking [9, 10], and both ionphoton entanglement [18] and state transfer [19] have
been achieved in this setting.
Recently, photons from trapped ions have been converted to the optimal telecom wavelengths for longdistance quantum networking via single-photon frequency conversion [20–22]. In [22] it was shown that
the combination of an ion trap with an integrated optical cavity and telecom conversion could enable entanglement distribution between trapped ions spaced by tens
of kilometres at practical rates for verification. However,
it has not previously been verified that the photons from
such a system can be sufficiently indistinguishable to allow for the establishment of remote entanglement. Here
we present experimental and theoretical results of photon distinguishability in a telecom-converted ion-cavity
setting, based on interference between two photons produced sequentially from an ion in a cavity. We conclude
that the achieved interference visibilities and overall detection efficiencies would already allow for entanglement
of ions tens of kilometers apart (orders of magnitude fur-

∗

ben.lanyon@uibk.ac.at,

†

These authors contributed equally

ther than the state of the art [15–17]).
The extent to which photons are in identical pure
states, and therefore indistinguishable, is a key parameter that can be quantified by the visibility in a twophoton interference experiment [23]. For a comprehensive theoretical analysis of two-photon interference from
quantum emitters without conversion see, e.g., [24, 25].
While direct two-photon interference has been achieved
using neutral atoms in cavities [26, 27], it has not previously been reported for ions in cavities. As will be
shown, the limiting factor on the interference visibility in
our ion-cavity system is unwanted spontaneous emission
from the ion during the cavity-mediated photon generation process. Such spontaneous emission is particularly
relevant for ion-cavity systems demonstrated to date in
which the ion-cavity coupling rate does not overwhelm
the spontaneous scattering rate. Furthermore, photon
conversion stages can easily introduce additional distinguishability, e.g., by directly adding noise photons at a
rate that depends strongly on the particular photon and
pump laser wavelengths and filtering bandwidth [28], and
must be assessed on a system-dependent basis.
In this Letter, first we introduce the experimental system and a simple theoretical model of the effect of spontaneous emission on the emitted cavity photon. Second, two-photon interference results of cavity photons at
the ion-resonant wavelength are presented, showing that
spontaneous emission is the dominant limiting factor.
Third, two-photon interference results are presented after a two-step frequency conversion, converting the wavelength of one cavity photon to the telecom band and back
to the ion-resonant wavelength, showing that the photon
indistinguishability is essentially preserved.
Experiments employ a single 40 Ca+ atom in the center
of a linear Paul trap and in the focus of a near-concentric
optical cavity near-resonant with the 854 nm electronic
dipole transition (Figure 1) [22]. We begin by Doppler
cooling the ion’s motional state and optical pumping into
an electronic ground state |Si = 42 SJ=1/2 , mj =1/2

2
a) Ion cavity node

Raman
laser
lH>

Cavity
mirror

lV>

854 nm
photons

b) Level scheme

Ca+

40

l P>
Δ

l 42P3/2,-3/2>
γpd
g

ph
ot
on

(Figure 1). Each photon is generated via a Raman
laser pulse at 393 nm which triggers emission, by the
ion, of a polarized 854 nm photon into a vacuum cavity
mode, via a cavity-mediated Raman transition [30]. Two
photons are generated sequentially with a time gap between the beginning of their respective Raman pulses of
13.35 µs, such that after delay of the first (the vertical
‘long-path’ photon, |V i) in a 3 km optical fibre spool,
both photon wavepackets (the second being the horizontal ‘short-path’ photon, |Hi) arrive simultaneously
and with their polarizations rotated to be parallel, at
different input ports of a 50:50 beamsplitter. Different
photon polarizations are generated and modelled by 3level Raman transitions that differ in the final Zeeman
state of the 32 DJ=5/2 manifold (Figure 1 and [29]).
Specifically, after the generation of a |V i (an |Hi) photon the ion is in the final state 32 DJ=5/2 , mj = − 5/2
( 32 DJ=5/2 , mj = − 3/2 ) [29]. In every experiment we
use a Raman laser Rabi frequency of Ω = 2π×64(1) MHz.
The arrival times of photons at the beamsplitter output ports are recorded with single-photon detectors. In
each experimental cycle, we generate two pairs of photons: while the temporal wavepackets of the first pair
(synchronous) arrive simultaneously at the beamsplitter,
a time gap is introduced between the wavepackets of the
second pair (asynchronous) that provides complete temporal distinguishability. Each full experiment consists
of many repeated cycles as described in [29]. The coincidence rates of detection events from the synchronous
and asynchronous photon pairs are denoted as C || and
C ⊥ , respectively. The two-photon interference visibility
is given by V (T )=1−C || (T )/C ⊥ (T ), where T is the coincidence window: the maximum time difference between
photon clicks that is counted as a coincidence.
In the first full experiment, the |V i photon is sent
directly to the fiber spool. In the second experiment,
the |V i photon is first converted to 1550 nm (telecom
C band) via difference frequency generation (DFG) in a
ridge-waveguide-integrated PPLN crystal with a 1902 nm
pump laser. This first ‘down-conversion’ stage is described in [22, 31]. After the spool, an ‘up-conversion’
stage (not previously reported) converts the photon back
to 854 nm via the reverse process: sum frequency generation (SFG). Approximately 0.2 W of pump laser power
is used for each stage.
In the case of perfectly indistinguishable photons entering separate ports of a symmetric beamsplitter, the
well known photon bunching effect occurs: two perfect
detectors placed at the output ports of the beamsplitter
never fire simultaneously. Yet in practice, perfect bunching is never observed, and it is important to understand
the source of the imperfections. During the photon generation process (Figure 1), spontaneous decay events from
the short-lived excited state (|P i) onto the final state
manifold (|Di) act only as losses – no cavity photon is
emitted through the Raman process if such an event occurs. In contrast, following any number of spontaneous
decay events from |P i back to the initial state (|Si) dur-

l32D5/2,mj>

lD>

l 42S1/2,-1/2>

γps

c) Delay
line

13.4 μs
travel
time

lH>

lV>

QFC
854 to 1550
3 km
fiber
spool

1902 nm
fibre laser

QFC-1
1550 to 854

Ω
lS>

PBS

FC

Wave plates

MS

d) Photon
interference
D1

50:50
BS

D2

FIG. 1. Experiment schematic: a. An atomic ion (red
sphere) in a linear Paul trap (gold electrodes) and coupled
to a vacuum anti-node of an optical cavity (coupling strength
g). Raman laser (Rabi frequency Ω) pulses generate sequential orthogonally-polarized photons, first vertical (|V i) then
horizontal (|Hi) that are split into two paths, with a time
separation equal to the delay line (panel c.), such that their
wavepackets arrive simultaneously at the beam splitter (panel
d.). b. Three-level model: ground state |Si; metastable state
|Di (1.17 s lifetime) and excited state |P i (6.9 ns lifetime).
Spectroscopic notation shown. For |Hi and |V i photons the
mj = −5/2 and mj = −3/2 Zeeman states of |Di are used
[29]. The coherent cavity-photon generation process competes
with spontaneous emission from the short-lived P state (decay
rates γps and γpd ). c. Single photon quantum frequency conversion (QFC) and inverse process (QFC−1 ) with wavelength
changes shown. A 3 km spool of telecom SMF28-Ultra fibre.
d. Beamsplitter (BS). Superconducting nanowire photon detector D1 (D2) with efficiency 0.88 (0.89) and free-running
dark counts 0.3 (0.4) per second. Fiber coupler (FC), mating
sleeves (MS).

ing the Raman laser pulse, a cavity photon can still be
subsequently generated while the Raman laser remains
on. Every spontaneously scattered photon carries away
the information that the cavity photon has not yet been
emitted. Consequently, the cavity photons impinging on
the beamsplitter are each in a (temporally-) mixed state
and therefore they do not bunch perfectly.
The effect of spontaneous scattering on the visibility is
precisely quantified through a theoretical model describing the evolution of a three-level atom embedded in a
cavity using a master equation [29]. In the model, an expression for the mixed state of photons emitted from the
cavity is obtained in two steps. First, we calculate the
wave function of photons emitted from the cavity conditioned on the ion being in the initial state |Si at time
s and no spontaneous decay events happening for later
times. Second, we compute the rate of spontaneous de-

3
cay events from |P i to |Si as a function of time. The
state of the emitted cavity photon is then expressed as a
mixture over all the possibilities where the last |P i → |Si
decay happens at time s or no decay events occur and a
pure state photon is emitted afterwards, plus the vacuum
component collecting all the possibilities where no cavity
photon is emitted. With the emitted photon states in
hand, it is then straightforward to calculate the visibility
of pairs of photons [29]. We refer to this model that includes only imperfections due to spontaneous scattering
as the basic model. As an alternative from our model,
the visibility could be computed from the master equation via the quantum regression theorem [24].
Results are now presented for the case without photon conversion. The temporal profiles of the short-path
and long-path single photon detection events from the
second (asynchronous) photon pair are shown in Figure
2a. These single-photon wavepackets are presented as
a probability density ρd (t) = Nd /(k · ∆t ), where Nd is
the number of detection events registered in a time bin
∆t = 125 ns and k is the number of trials. Integration
of the wavepackets gives the probability of detecting a
short- (long-) path photon as 12.4% (2.7%). Differences
in the single-photon wave packet shapes are due to slight
differences in the corresponding transition strengths [29].
The temporal profile of the coincidence detection
events (cross-correlation function) for the synchronous
and asynchronous photon pairs are compared in Figure
2b. Here the coincidence probability density ρc (τ )k,⊥ =
k,⊥
k,⊥
Nc /(k · ∆τ ) is used, where Nc are the number of coincident detection events per time bin for the first and
second pair of photons respectively, τ is the difference
in detection times. Figure 2c shows the visibility V (T )
and integrated coincidence rate of the asynchronous phoRT
tons C ⊥ (T ) = −T ρ⊥
c (τ )dτ . For the smallest coincidence
window presented, the interference visibility V (125 ns)
is 0.986 ± 0.006 (0.987 ± 0.005 after subtracting detector dark counts). When considering a coincidence window containing the whole photon wavepacket, the visibility V (9 µs) is 0.472 ± 0.008. From the theory, we
calculate that the expectation value of the number of
spontaneously-emitted photons on the |P i → |Si transition, given generation of a cavity-photon, was 3.5.
The differences between the basic model and data in
Figure 2 are consistent with an extension to the model
that, in addition to spontaneous emission, includes a
combination of an overall time-independent distinguishability factor of 1% and a centre frequency difference of the
two photons of 40 kHz [29]. This small photon frequency
difference could be caused by several reasons, e.g., cavity
length instability, acoustic noise in the 3 km delay line
fibre and cavity birefringence. The 1% time-independent
distinguishability can arise from slight polarization mode
mismatch at the beamsplitter or imbalance of the 50:50
beamsplitter itself. The agreement between data and the
basic model shows that we are close to the fundamental
limit of photon indistinguishability set by spontaneous
scattering in our system.

FIG. 2. Two-photon interference without photon conversion: Solid (dashed) lines show basic theory (extended
theory) model and shapes show data in all the panels. Probability densities are obtained by dividing the probability of
detection (coincidence) per time bin by the bin size, see [29]
sec. IV, V for details. (a) Single photon wavepackets for short
path (red circles) and long path (black diamonds, rescaled by
multiplication factor 4.6 to correct delay line losses). Vertical
dotted line shows the end of the Raman laser pulse. (b) Pho||
ton coincidences for temporally synchronous (ρc , blue circles)
⊥
and asynchronous (ρc , green diamonds) cases. (c) Interference visibility V (left axis, blue diamonds) and integrated
asynchronous coincidence probability C ⊥ (green circles, right
axis). Error bars represent ± one standard deviation due
to Poissonian photon counting statistics, not shown when
smaller than shapes.

Figure 3 presents results for the case with photon conversion and is constructed in the same way as Figure 2.
The probability of detecting a short- (long-) path photon
across the entire wavepacket is 10 % (0.5 %). The visibility is 0.96±0.04 for the minimum coincidence window
of 250 ns and 0.37±0.04 for the full wave packet window
of 9 µs. The differences between the basic model and
frequency-converted data (Figure 3) are consistent with
an extended model that includes a frequency drift of the
unstabilized photon conversion pump laser at the level of
50 kHz on a 10 µs timescale (consistent with independent
measurements) and background coincidences, see section

4
V.C [29]. We anticipate no significant challenges to frequency stabilising the pump laser to the few kilohertz
level in future work. Remote photon conversion stages in
distributed networks will need independent pump lasers
with absolute long-term frequency stability to within a
fraction of the networking photon bandwidth.
The achieved visibilities and coincidence rates in our
experiments would already allow for remote ion entanglement over tens of kilometers. Consider the entanglement
swapping protocol of [8], which leads to maximal entanglement of two remote (ion) qubits with state fidelity
F (T )=(1 + V (T ))/2 [32] at a heralded rate Rswap (T ) ∝
Rgen × C ⊥ (T ), where Rgen is the photon-generation attempt rate at each ion-trap network node. Using Rgen =
30 kHz, the achieved values without photon conversion
(Figure 2) would allow for 3 km ion-ion entanglement
distribution with F (T = 9µs) = 0.736 ± 0.004 at a rate
of Rswap (9µs) = 30 Hz. Using 0.18 dB/km for telecom
fiber losses, the achieved performance with photon conversion (Figure 3) would allow for 50 km distant ion-ion
entanglement generation with F (T = 9µs) = 0.69 ± 0.02
at rates on the order of 1 Hz (assuming photon detector dark count rates of 1 Hz). In all cases, time filtering of the coincidences (T < 9µs) would allow for an
increased remote entangled-state fidelity at the cost of
reduced heralding rate. Such long-distance experiments
must tackle environmental noise in deployed optical fibres, absolute frequency stabilisation of remote laser systems and matching photons from remote network nodes.
Methods to improve visibility without reducing the photon generation rate are those that can significantly increase the coherent ion-cavity coupling rate g, such as
coupling multiple ions in entangled (superradient) states
to the cavity [33, 34] and pursuing small mode-volume
fibre cavities [35].
Our model reveals that there is an optimal drive-laser
Rabi frequency (Ω, Figure 1) that achieves the highest
photon generation probability (and therefore C ⊥ ) for
a given threshold visibility, highlighting the important
role such models will play in enabling the upcoming next
generation of long-distance networking experiments [29].
Our results present a path to distributing entanglement
between trapped-ion registers spaced by several tens of
kilometres at practical rates for verification: significantly
further than state-of-the-art experiments involving spacings of a few meters [15–17] and a practical distance
to start building large-scale quantum-logic-capable
quantum networks.

Note: During the preparation of this manuscript, we became aware of complementary work in which sequential
interference of photons from an ion in a cavity is achieved
and studied [36].

FIG. 3. Two-photon interference with photon conversion: Solid (dotted) lines show basic theory (extended theory) model and shapes show data in all the panels. Probability densities are obtained by dividing the probability of
detection (coincidence) per time bin by the bin size [29]. (a)
Single photon wavepackets for short path (red circles) and
long path (black diamonds, rescaled by multiplication factor
19 to correct delay line losses). Vertical dotted line shows the
end of the Raman laser pulse. (b) Photon coincidences for
||
temporally synchronous (ρc , blue circles) and asynchronous
⊥
(ρc , green diamonds) cases. (c) Interference visibility V (left
axis, blue diamonds) and integrated probability C ⊥ (green
circles, right axis). Error bars represent ± one standard deviation due to Poissonian photon counting statistics.

ACKNOWLEDGMENTS

This work was supported by the START prize of the
Austrian FWF project Y 849-N20, by the US Army Research Laboratory under Cooperative Agreement Number W911NF-15-2-0060 (project SciNet), by the Institute
for Quantum Optics and Quantum Information (IQOQI)
of the Austrian Academy Of Sciences (OEAW), by the
European Union’s Horizon 2020 research and innovation programme under grant agreement No 820445 and
project name ‘Quantum Internet Alliance’ and by the
Swiss National Science Foundation (SNSF) through the
Grant PP00P2-179109, and by the Austrian Science Fund
(FWF) through Project F 7109. The European Commis-

5
sion is not responsible for any use that may be made of
the information this paper contains.

AUTHOR CONTRIBUTIONS

JS and BPL contributed to the experimental setup and
design. AM, VKrut., PS, BPL, MM, DF, TN and NS
performed theoretical modelling. BPL, VKrut, MM, PS,
TN and NS wrote the majority of the paper, with contributions from all authors. The project was conceived and
supervised by BPL.

VKrut., MM, and VKrc. took the data. VKrut, AM,
BPL, PS and MM analysed the data. VKrut, MM, VKrc,

[1] H. J. Kimble, Nature 453, 1023 (2008).
[2] S. Wehner, D. Elkouss, and R. Hanson, Science 362
(2018).
[3] L.-M. Duan, M. D. Lukin, J. I. Cirac, and P. Zoller,
Nature 414, 413 (2001).
[4] C. Monroe, R. Raussendorf, A. Ruthven, K. R. Brown,
P. Maunz, L.-M. Duan, and J. Kim, Phys. Rev. A 89,
022317 (2014).
[5] P. Kómár, E. M. Kessler, M. Bishof, L. Jiang, A. S.
Sørensen, J. Ye, and M. D. Lukin, Nature Physics 10,
582 (2014).
[6] E. T. Khabiboulline, J. Borregaard, K. De Greve, and
M. D. Lukin, Phys. Rev. Lett. 123, 070504 (2019).
[7] P. Sekatski, S. Wölk, and W. Dür, “Optimal distributed sensing in noisy environments,”
(2019),
arXiv:1905.06765 [quant-ph].
[8] L.-M. Duan and C. Monroe, Rev. Mod. Phys. 82, 1209
(2010).
[9] N. Sangouard, R. Dubessy, and C. Simon, Phys. Rev. A
79, 042340 (2009).
[10] A. Reiserer and G. Rempe, Rev. Mod. Phys. 87, 1379
(2015).
[11] C. D. Bruzewicz, J. Chiaverini, R. McConnell, and J. M.
Sage, Applied Physics Reviews 6, 021314 (2019).
[12] N. Friis, O. Marty, C. Maier, C. Hempel, M. Holzäpfel,
P. Jurcevic, M. B. Plenio, M. Huber, C. Roos, R. Blatt,
and B. Lanyon, Phys. Rev. X 8, 021012 (2018).
[13] S. M. Brewer, J.-S. Chen, A. M. Hankin, E. R. Clements,
C. W. Chou, D. J. Wineland, D. B. Hume, and D. R.
Leibrandt, Phys. Rev. Lett. 123, 033201 (2019).
[14] B. B. Blinov, D. L. Moehring, L.-M. Duan, and C. Monroe, Nature 428, 153 (2004).
[15] D. L. Moehring, P. Maunz, S. Olmschenk, K. C. Younge,
D. N. Matsukevich, L.-M. Duan, and C. Monroe, Nature
449, 68 (2007).
[16] D. Hucul, I. V. Inlek, G. Vittorini, C. Crocker, S. Debnath, S. M. Clark, and C. Monroe, Nature Physics 11,
37 (2015).
[17] L. J. Stephenson, D. P. Nadlinger, B. C. Nichol, S. An,
P. Drmota, T. G. Ballance, K. Thirumalai, J. F. Goodwin, D. M. Lucas, and C. J. Ballance, arXiv preprint
arXiv:1911.10841 (2019).
[18] A. Stute, B. Casabone, P. Schindler, T. Monz, P. O.
Schmidt, B. Brandstätter, T. E. Northup, and R. Blatt,
Nature 485, 482 (2012).
[19] A. Stute, B. Casabone, B. Brandstätter, K. Friebe, T. E.
Northup, and R. Blatt, Nature Photonics 7, 219 (2013).
[20] M. Bock, P. Eich, S. Kucera, M. Kreis, A. Lenhard,
C. Becher, and J. Eschner, Nature Communications 9,
1998 (2018).
[21] T. Walker, K. Miyanishi, R. Ikuta, H. Takahashi,

[22]

[23]
[24]
[25]
[26]
[27]
[28]

[29]
[30]
[31]
[32]

[33]

[34]

[35]
[36]

[37]

[38]

[39]

[40]

S. Vartabi Kashanian, Y. Tsujimoto, K. Hayasaka,
T. Yamamoto, N. Imoto, and M. Keller, Phys. Rev.
Lett. 120, 203601 (2018).
V. Krutyanskiy, M. Meraner, J. Schupp, V. Krcmarsky,
H. Hainzer, and B. P. Lanyon, npj Quantum Information
5, 72 (2019).
C. K. Hong, Z. Y. Ou, and L. Mandel, Phys. Rev. Lett.
59, 2044 (1987).
K. A. Fischer, K. Müller, K. G. Lagoudakis, and
J. Vučković, New Journal of Physics 18, 113053 (2016).
P. Müller, T. Tentrup, M. Bienert, G. Morigi, and J. Eschner, Phys. Rev. A 96, 023861 (2017).
T. Legero, T. Wilk, M. Hennrich, G. Rempe, and
A. Kuhn, Phys. Rev. Lett. 93, 070503 (2004).
T. Wilk, S. C. Webster, H. P. Specht, G. Rempe, and
A. Kuhn, Phys. Rev. Lett. 98, 063601 (2007).
J. S. Pelc, L. Ma, C. R. Phillips, Q. Zhang, C. Langrock,
O. Slattery, X. Tang, and M. M. Fejer, Opt. Express 19,
21445 (2011).
“Supplementary material of this paper,”.
M. Keller, B. Lange, K. Hayasaka, W. Lange, and
H. Walther, Nature 431, 1075 (2004).
V. Krutyanskiy, M. Meraner, J. Schupp, and B. P.
Lanyon, Applied Physics B 123, 228 (2017).
A. N. Craddock, J. Hannegan, D. P. Ornelas-Huerta,
J. D. Siverns, A. J. Hachtel, E. A. Goldschmidt, J. V.
Porto, Q. Quraishi, and S. L. Rolston, Phys. Rev. Lett.
123, 213601 (2019).
L. Lamata, D. R. Leibrandt, I. L. Chuang, J. I. Cirac,
M. D. Lukin, V. Vuletić, and S. F. Yelin, Phys. Rev.
Lett. 107, 030501 (2011).
B. Casabone, K. Friebe, B. Brandstätter, K. Schüppert,
R. Blatt, and T. E. Northup, Phys. Rev. Lett. 114,
023602 (2015).
M. Steiner, H. M. Meyer, C. Deutsch, J. Reichel, and
M. Köhl, Phys. Rev. Lett. 110, 043003 (2013).
T. Walker, S. V. Kashanian, T. Ward, and M. Keller,
“Improving the indistinguishability of single photons
from an ion-cavity system,” (2019), arXiv:1911.08442
[quant-ph].
F. Kaiser, A. Issautier, L. A. Ngah, D. Aktas, T. Delord, and S. Tanzilli, IEEE Journal of Selected Topics
in Quantum Electronics 21, 69 (2015).
N. Maring, P. Farrera, K. Kutluer, M. Mazzera,
G. Heinze, and H. de Riedmatten, Nature 551, 485
(2017).
F. Kaiser, P. Vergyris, A. Martin, D. Aktas, M. P. D.
Micheli, O. Alibart, and S. Tanzilli, Opt. Express 27,
25603 (2019).
H. G. Barros, A. Stute, T. E. Northup, C. Russo, P. O.
Schmidt, and R. Blatt, New Journal of Physics 11,

6
103004 (2009).
[41] D. N. Matsukevich, P. Maunz, D. L. Moehring, S. Olmschenk, and C. Monroe, Phys. Rev. Lett. 100, 150404
(2008).
[42] C. M. da Silva Baptista Russo, Photon statistics of a
single ion coupled to a high-finesse cavity, Ph.D. thesis
(2008).
[43] C. Roos, Controlling the quantum state of trapped ions,
Ph.D. thesis (2000)

SUPPLEMENTARY MATERIAL
CONTENTS

Acknowledgments

4

Author Contributions

5

References

5

Supplementary Material

6

I. Experimental setup
II. Photon conversion performance

7
7

III. Photon generation sequence

9

IV. Data analysis

9

V. Theory model
A. The Master Equation
B. The photon state
1. Conditional pure photon wave-function
2. Scattering probability
3. The photon state
4. Expected number of scattering events
C. Photon statistics
1. Single click rates
2. Coincidence rates
3. Visibility of the Hong-Ou-Mandel pattern
D. Predictions
E. Extended models: imperfections beyond
scattering
1. Detection efficiency
2. Mode mismatch
3. Photon frequency mismatch
VI. Data modelling
A. General principles:
1. Spontaneous scattering rates
2. g factors, Clebsch-Gordan factors and
finite temperature effects
3. Calibration of experimental parameters
B. Modelling in figure 2
1. Ideal model
2. Extended model
C. Modelling in figure 3: frequency converted
case
1. Ideal model
2. Extended model

10
10
11
11
12
12
12
12
12
13
13
13
14
14
14
14
15
15
15
15
15
16
16
16
16
16
16

7
Appendix I: Experimental setup

A detailed experimental diagram is presented in Fig. A.4.
For details on the ion trap and cavity system please see
our recent paper in [22]: the same ion trapping frequencies, geometry of laser beams and optical cavity were
employed. A few key parameters are now recapped.
The optical cavity around the ion is near-concentric
with a cavity waist of ω0 = 12.31 ± 0.07 µm and a maximum ion-cavity coupling rate of g0 = 2π · 1.53 ± 0.01
MHz. The finesse of the cavity (at 854 nm) is F =
2π
L = 54000 ± 1000, with the total cavity losses L =
T1 + T2 + L1+2 = 116 ± 2 ppm, determined from measurements of the cavity ringdown time. This gives the
cavity linewidth 2κ = 2π · 140 ± 3 kHz, κ being the halfwidth at half maximum.
As explained in the main text, in the second experiment the delayed photon undergoes a two stage frequency conversion. Each frequency conversion uses a single 48 mm-long ridge-waveguide-integrated PPLN crystal (NTT electronics, reported in [22, 31]) where the
input single photon is overlapped with the pump laser
at 1902 nm. The first (‘down-conversion’) stage brings
the 854 nm (V) photon to the 1550 nm telecom C-Band
((854 nm)−1 − (1902 nm)−1 ≈ (1550 nm)−1 ) as detailed
in the first experiment in [31]. This photon is separated
from the pump field with a dichroic plate, injected into
the 3 km spool and recombined with the pump before the
second stage. The second (‘up-conversion’) stage brings
the 1550 nm photon back to the original 854 nm wavelength via sum frequency generation (SFG). The total
pump laser power of correct polarization for conversion
in-coupled into each crystal is 0.2 W, control by the waveplate angles before and after the first stage.
While in the ideal case the second stage is the reverse
process of the first, there are two differences which are
now summarized. In the downconversion process, unwanted photons at the telecom output wavelength are
generated directly from Anti-Stokes Raman scattering
(ASR) of the pump laser from 1902 nm to 1550 nm.
In the upconversion process, unwanted photons at the
854 nm output wavelength are generated by a two stage
process. First, as before ASR scattering of the pump
laser generates telecom photons. Second, these photons
are up-converted back to 854nm via SFG [28, 37]. A
second difference is the fundamental waveguide mode at
1550 nm has a higher overlap with the free-space Gaussian mode of the in-coupling laser field, than the waveguide mode at 854 nm. As such, we achieve a higher incoupling efficiently into the fundamental waveguide mode
at 1550 nm and subsequently a higher conversion efficiency for the up-conversion (presented in the next section).

Appendix II: Photon conversion performance

A set of characterisation measurements of the two-stage
conversion process was carried out using classical laser
light and the results are now described. The total efficiency from the start of the converted delay line (Point
A in figure A.1), to the end of the delay line (point B in
figure A.1) was measured to be 0.098 ± 0.005 at the last
calibration before the two-photon experiments (the error
stands for the last digit of the powermeter reading).
The efficiencies of separate parts were characterized independently. The values below stand for the final characterisation after alignment-optimisation before the twophoton experiment reported in the main text. The intervals are derived from the calibration measurements after
optimisation on other days, representing maximum and
minimum values observed. The laser powers and setup
stability on the timescale of performing the characterisation is also taken into account. The down-conversion
stage efficiency from the point A to the in-coupling of
the delay fiber was 0.50 ± 0.03 (we refer it as downconversion external efficiency). The delay fiber transmis+0.01
sion was measured to be 0.6−0.05
, including in-coupling
+0.005
(0.75 −0.05 ) and two mating sleeves (0.95±0.02). The upconversion external efficiency (from the delay fiber outcoupler to the etalon) was measured to be 0.53 ± 0.03.
The etalon transmission was 0.84+0.005
−0.04 and the coupling
+0.05
.
to the fiber that goes to the HOM board was 0.73−0.03
The provided value above of external up-conversion efficiency of 0.53 ± 0.03 includes the wavegide in- and outcoupling losses and transmission of the filter that blocks
the pump field (see fig. A.4).
We define the internal conversion efficiency as conversion efficiency without coupling and transmission losses,
calculated as the fraction of converted signal-photonnumber to unconverted signal-photon-number (without
pump light) at the output of the converter. We observe at
best alignment 89(0.5)% internal efficiency for the upconversion and estimate a waveguide coupling/propagation
efficiency of 70(5)%, limited by the mismatch of the outcoupler of the delay fiber and the in-coupler of the conversion waveguide. For the down-conversion, the performance was reported in [31] and yields 66(6)% internal efficiency if the waveguide in-coupling/propagation
losses are taken into account according to the definition above. This efficiency was shown to be limited
by the unintentional excitation of higher-order waveguide modes. In order to prove that the up-conversion
coupling/propagation efficiency of 70(5)% is dominated
by coupling, we performed a separate measurement with
adjusted 1550 beam diameter before the wavguide incoupler and achieved 82(3)% efficiency calculated as the
ratio of the number of photons at 854 nm wavelength
right after the waveguide to the number of 1550 nm photons right before the waveguide. Note, that the external
and internal up-conversion efficiencies reported here are
higher than the ones achieved in similar systems before
[38, 39].

8
393 nm Raman laser
B-field

a) Ion cavity node
fixed
beam
expander

1902 nm
fiber laser

optical
isolator
z

T2

x

806
VP filters

DM1

854 nm
photon

lV>
lH>

A
PMF

PPLN2

DM2
PPLN1
AS vertical

AS

854 nm
photon EF

1550 nm
photon

B

D2

PC

BP 854

SP 1600

B'
1900 nm

iris
FM

cavity
mirror

z

LP 1600

C

parabolic
mirror

DM3

PM

telescope

397 nm pi
866 nm, 854 nm

PC

horizontal

y397 nm sigma

806 nm
locking T1
laser

D1

b) Delay line

3 km
fiber
spool

A'

parabolic SP 1610 +
LP 1400
mirror

c) Photon
interference
Key:
λ/2, λ/4

PBS
50:50 BS
MS, FC

FIG. A.4. Detailed experimental diagram. a) Ion cavity node. A single atomic ion (red sphere) in the centre of both
a 3D radio-frequency (RF) linear Paul trap (gold electrodes) and an optical cavity. The two smaller electrodes are held at DC
voltage. The 4 larger electrodes (two shown in figure projection) are driven with RF. Two cross sections are depicted: Along the
cavity axis (top), showing: the ≈ 4 Gauss DC magnetic field (quantisation axis) generated by rings of permanent magnets and
the circularly-polarized Raman laser for generating 854 nm cavity photons. Following a Raman pulse, an 854 nm cavity photon
exits the cavity via the right mirror (transmission T2). The photon then passes the following elements: in-vacuum collimating
lens (C); vacuum chamber viewport (VP); waveplates; 3 filters to remove the 806 nm laser light to which cavity length is
continuously and actively stabilised; polarizing beam splitter (PBS) for directing the vertical photons into a single mode fiber,
and the horizontal photons into a polarization maintaining fiber (PMF), b) Delay line. For the experiment without photon
conversion, point A and A’, as well as the points B’ and B directly are fiber connected , such that the vertical photon only
has to pass the 3 km fiber spool (Corning SMF-28 Ultra). For the experiment with the conversion, the setup is as shown here.
The injected 854 nm photon passes waveplates (used for system optimization with classical light) and is overlapped with 800
mW of 1902 nm laser light (Tm-doped fiber laser, AdValue Photonics AP-SF1-1901.4-01-LP, measured at PM) on a dichroic
mirror (DM1) and free-space coupled into one of the ridge waveguides of temperature-stabilised PPLN1 using an asphere (AS,
11 mm, positioned by an XYZ translation stage). The 1902 nm input path is described in [22]. A gold parabolic mirror (f
= 15 mm) is used to collimate all fields at the output of PPLN1. A dichroic mirror (DM2; Thorlabs DMLP1800) splits the
converted 1550 nm photons from the 1902 nm pump laser. A combination of a shortpass (SP 1610) and longpass (LP 1400)
filter reduces unwanted pump laser and other noise light fields. The 1550 nm photon couples into the 3 km SMF-28 fiber spool,
which is used as an optical delay line. The output of the fiber spool passes waveplates, to correct for polarization rotations
through the fiber and is overlapped (with a dichroic mirror DM3; Thorlabs DMLP1800) back with the 1900 nm pump light,
which passes waveplates to set correct pump power for the second crystal (PPLN2). Via a second gold parabolic mirror (f =
15 mm) all fields are coupled into the second temperature controlled chip PPLN2, where the 1550 nm photon is converted back
to the initial 854 nm via the reverse (upconversion) process. An Asphere (AS) collimates the output field, before a shortpass
(SP 1600; OD5 at 1902) filters the 1902 nm pump laser from the 854 nm single photons. After passing an etalon filter (EF;
LightMachinery, Bandwidth ≈ 870 MHz) a combination a waveplate and PBS is used to filter unpolarized noise photons before
coupling the 854 nm photon into a single mode fiber, which goes to the interference board. c) Photon interference. Both
inputs pass waveplates and PBSs (cleaning polarization) and overlap on a 50:50 beamsplitter (50:50 BS). Both outputs of the
beamsplitter are filtered with an 854 nm bandpass filter (BP 854); coupled to single mode fibers; polarization control paddles
(PC) correct to most efficient polarization for followed single photon detector (D1(D2): Scontel, efficiency 88%(87%), dark
count rate 0.5 s-1 (0.3 s-1 ). The electronic pulses produced by the detectors are detected with a time tagging module (Swabian
Instruments Time Tagger 20). Mating sleeves (MS), Fiber coupler (FC).

On the day of the two-photon interference experiment
using photon conversion (Figure 3, main text), the total
efficiency of the delay line was measured to be approximately 5%. This lower efficiency, compared to the aforementioned values achieved with classical light is caused
by the combination of the following: an additional fiber
joiner between the ion node and delay line (panels a
and b in Figure A.4) when working with single photons
(compared to classical light); imperfectly optimised fiber
couplers throughout the delay line; and potential slight
mismatch between the photon polarization and the nonlinear crystal axis.

The noise, at the single photon level, introduced by
the conversion process is now presented. These values
are extracted from the photon detector click rate outside
of the known ion-photon arrival times recorded in the
experiment presented in Figure 3 of the main text. Recall that final narrowband filtering is performed at 854
nm via a temperature-controlled etalon (Bandwidth 870
MHz, free spectral range 30 GHz) that has a maximum
transmission of 84%. From the measured photon noise
rate of 11 ± 3 cps at the detectors (after removing detector dark counts and other known background noise, like
room light) we estimated from the known losses in the

9

P

mj=-3/2

mj=1/2

mj=3/2

42P3/2

Δ

δ
854 nm

V

mj=-1/2

H

393 nm

δ

729 nm

D
D'
mj=-3/2
mj=-5/2

mj=-1/2

mj=1/2

mj=3/2

mj=5/2

32D5/2

Ω
Raman
laser

S
mj=-1/2

mj=1/2

42S1/2

FIG. A.5. Relevant energy level scheme of 40 Ca+ . Following optical pumping, the ion (single outer valence electron)
begins in the state 42 S1/2,mj =−1/2 . Photons are generated via a cavity-mediated Raman transitions (CMRT) [18, 22, 30, 40].
In case of detuning δ = 0, a 393 nm Raman laser pulse leads to the generation of a horizontally-polarized |Hi photon in
the optical cavity and the electron ends up in the state 32 D5/2,mj =−3/2 . In the case of a different appropriate detuning δ to
match the D-state Zeeman splitting (achieved by change of frequency of the Raman laser) a vertically-polarized |V i photon in
generated in the optical cavity. Here H stands for the linear polarization along the B-field quantisation axis (π-photons). The V
polarization stands for the orthogonal linear polarization, produced by the projection of the σ-polarized photons into the plane
perpendicular to the cavity direction (and perpendicular to the B-field quantisation axis). The overall detuning ∆ = 403 ± 5
MHz.

optical path between the etalon and the detectors a noise
level of 50 ± 10 s−1 right after the final etalon filtering
stage.

Appendix III: Photon generation sequence

We sequentially generate photons of orthogonal polarizations using a cavity-mediated Raman transition (see
fig. A.5) with ion state reinitialisation in between. The
full experimental sequence is shown in fig. A.6. First, a
40 µs ‘initialisation’ laser-pulse at 393 nm is measured by
a photodiode in transmission of the ion-trap chamber and
used for intensity stabilisation of the subsequent 393 nm
photon-generation Raman pulses with a sample-and-hold
system. The initialisation pulse is followed by 2000 µs of
Doppler cooling, involving three laser fields as indicated.
Next, a cycle starts in which the photon-pair generation
attempt takes place. This cycle is repeated (looped) 40
times before the whole sequence starts again.
In summary, each cycle contains four Raman pulses —
V1 , H1 and V2 , H2 — which attempt to generate the
two pairs photons that are refereed to as ‘synchronous’
and ‘asynchronous’ in the main text. The first synchronous pulse pair (V1 , H1 ) has a time difference of
13.35 µs, corresponding to the length of the delay line,
such that the generated photon wavepackets arrive at the
interference beamsplitter simultaneously (the delay was
measured with < 50 ns accuracy by recording the photon arrival times). The second asynchronous pulse pair
(V2 , H2 ) has an additional delay twait and generates a

fully temporally distinguishable photon pair as a reference (twait = 30µs). Before the V1 pulse in each loop
we produce an electronic trigger-pulse that is recorded
on a separate channel of the time-tagger, along with the
photon detection events, to provide exact Raman pulses
timing information.
In detail, each cycle starts with an additional Doppler
cooling pulse (20 µs) and optical pumping to the
SJ=1/2,mj =−1/2 (see fig. A.5) state via circularly polarized 397 nm laser light (46 µs). The photon-generation
Raman pulse V1 (9.4 µs) creates the vertical polarized
photon that is directed to the delay line by a PBS. This
is followed by a 4 µs long, 854 nm repump pulse which
pumps the ion back to the initial ground state. A second photon-generation Raman pulse H1 (9.4 µs) creates
a horizontal photon that is directed directly to the interference region. After a Doppler cooling pulse of 20 µs
and optical pumping of 46 µs, the second pair of photons
is produced.

Appendix IV: Data analysis

During the experimental run we record the absolute
time stamps of two detector events D1 and D2 , and of
an electronic trigger pulse generated simultaneously with
V1 at time t1 in each cycle (see fig. A.6). We then work
in a time frame referenced to the trigger pulse. In this
frame the photon arrival times are grouped into three
time windows: the first group contains the overlapped
synchronous photons (generated by V1 and H1 ), the sec-

10

FIG. A.6. Sequence of the laser pulses during the experiment. Wavelengths and duration of pulses are labeled. Each
cycle (what is shown within the loop) contains four Raman laser pulses, which attempt to generated four photons. The first
two are referred to as the synchronous pair and the second pair as the asynchronous pair. Each cycle is looped 40 times and
this sequence is repeated thousands of times to produce the data presented in the main text.

ond group contains the first of the time-displaced ‘asynchronous’ photons (V2 , through the delay line) and the
third group contains the later asynchronous photon (H2 ,
direct path). In the main text Figure 2a we sum up
the data for two detectors and plot separately the probabilities of events corresponding to (windows containing)
V2 and H2 . This is done by shifting the distributions in
time by a fixed offset t (t+twait ) for V2 (H2 ), with t being
the delay between the trigger pulse and the expected V2 photons’ front-slope; twait is the known additional wait
time (30 or 40 µs in different realisations). We plot the
detection-probability-density (see main text), defined as
the number of events detected in a certain time bin during the experiment divided by the number of trials and
bin duration. The error bars represent ±1 standard deviation of Poissonian photon counting statistics. The
subtraction of background counts was performed for a
correct efficiency comparison of the two paths.
To plot the coincidence distribution (Figures 2b, 3b
of the main text) we first choose a time window (software gate) where the corresponding photons are expected
to arrive based on sequence timing and the histogram
of all recorded events. Then we calculate the probability density ρc (D1 (t1 ), D2 (t2 )) of observing a twophoton detection event in a given trial as a function
of the detections time difference τ = t2 − t1 . The
plotted values in the figure are calculated as ρc (τ ) =
R
R t1 +τ +∆t
1
dt2 N (t1 , t2 ) where N (t1 , t2 ) is the
∆t k gate dt1 t1 +τ
number of two-photon clicks with given times, ∆t is the
bin size in the figure and k is the total number of attempts. The errorbars for each point in the figure are calculated from the total number of events detected for this
bin assuming Poissonian statistics. The coincidence distribution for the distinguishable photons (from V2 , H2 ),
originally peaking at the τ = ±twait , is shifted to τ = 0
and summed over positive and negative branches to represent the expected coincidence distribution for the fully
distinguishable but synchronized photons.
Given the coincidences distribution in time we define
the visibility (plotted in fig. 2c, 3c of the main text) as:
V (T ) =

C ⊥ (T ) − C k (T )
,
C ⊥ (T )

(IV.1)

where C ⊥ (T ) (C k (T )) are the coincidence probabilities
for the distinguishable (overlapped) pair of photons plotted in Figures 2b,3b of the main text integrated over the

delay range τ ∈ [−T ; T ]: C(T ) =

RT
−T

ρc (τ )dτ .

For the passive delay-line experiment (without conversion) we perform in total 7.5 million cycles, where
each cycle corresponds to one loop (cycle) in fig A.6 (attempt to generate four photons). The experiment with
frequency conversion consists of a total of 2.5 million cycles.

Appendix V: Theory model
A.

The Master Equation

We start by writing down a master equation for a single 40 Ca+ ion trapped inside a cavity and driven by a
pump laser. We restrict the atomic model to a Λ-system
formed by three levels |si , |pi and |di (see Fig. A.7) corresponding to sublevels of SJ=1/2,mj −1/2 , PJ=3/2,mj =−3/2
and DJ=5/2,mj =−5/2 (or DJ=5/2,mj =−3/2 ) that are of direct importance for the experiment, see Fig. A.2 for details. The ion is initially prepared in the state |si. The
laser is driving off-resonantly the p − s transition with
a frequency ωL = ωps + ∆ − δS , where both ∆ and δs
are negative. We denote a, a† the bosonic operators associated to the cavity field whose frequency is given by
ωC = ωpd + ∆. In the experiment, the laser Rabi frequency Ωt is much lower than the detuning |∆| and the
state |si undergoes a Stark-shift Ω2t /4∆. The additional
laser detuning δS = Ω2t /4∆ is chosen to preserve the twophoton resonance between s − d. The Hamiltonian of the
atom-cavity system is given by
H = ωC a† a + ωps |pihp| + ωds |dihd|
1
+ (eiωL t + e−iωL t )(Ωt |sihp| + Ωt |pihs|)
2
+ g(|dihp| + |pihd|)(a† + a),

(V.1)

where we have set ~ to one. The Hamiltonian can be simplified by noting that the cavity mode is initially empty
|0i . Therefore, without additional coupling terms the
atom-cavity system remains in the three level manifold
{|s, 0i , |d, 1i , |p, 0i}. Under the rotating wave approximation, the Hamiltonian in this subspace is thus given

11
by



0
0
Ωt /2
,
g
Ht =  0 δS
Ωt /2 g −∆ + δS

|𝑝⟩

(V.2)

in the rotating frame with a†
→
e−iωC t a† ,
−iωL t
−i(ωL −ωC )t
|pi → e
|pi, |di → e
|di, and |si → |si.
Let us now introduce the non-unitary terms which will
appear in the master equation. First, the photon can
escape the cavity mode with rate κ. This decay channel is precisely the one in which the photons are collected into a fiber and sent to the detectors. Yet, for
the atom-cavity system,
this process corresponds to a
√
loss term L1 = 2κ |d, 0ihd, 1| . Note that in practice,
photons can leave the cavity through channels that are
not the detected channel. This additional cavity loss
is taking into account by adjusting the photon detection efficiency.
Finally, there are
p
ptwo scattering terms
L2 = 2γsp |s, 0ihp, 0| and L3 = 2γdp |d, 0ihp, 0|. With
this in hand, we can write down the master equation for
the atom-cavity system
%̇t = −i [Ht , %t ] +

3 
X
i=1

Li %t L†i


1 †
− {Li Li , %t } , (V.3)
2

where %t has to be defined on a four level manifold
including |d, 0i . Ht is extended trivially on the added
level via Ht |d, 0i = δs |d, 0i , that is, |d, 0i is not coupled
to the other three levels. Hence, the atom-cavity system
evolves in the {|s, 0i , |d, 1i , |p, 0i}-manifold until it is
brought to the state |d, 0i either by the scattering term
L3 or by emitting a photon towards the detector via L1 .

B.

The photon state

We can now address the question of interest: What is
the state of the photon emitted from the cavity to the
detected mode? The photon state is computed in two
steps. First, we obtain the sub-normalized wave-function
of a photon in the pure state conditioned on the atomcavity system being in the state |s, 0i at time s and no
scattering events L2 and L3 happening at later times.
Second, we solve the full master equation to compute
the probability of a scattering via L2 happening at time
s. Such a scattering event projects the system back onto
|s, 0i.

1.

Conditional pure photon wave-function

Let us start by addressing the wave-function of a photon in a pure state (pure photon) conditioned on the
atom-cavity system being in the state |s, 0i at time s and
no scattering events L2 and L3 happening at later times.

∆

|𝛿$ |
𝜔+

𝜔*
|𝑑 ⟩

|𝑠⟩

FIG. A.7. Scheme of the Λ-system relevant for the experiment. The transition between |si and |pi is off-resonantly
driven by a pump laser with frequency ωL while the states
|pi and |di are coupled by the field of a cavity with frequency
ωC . The explicit expressions of each detunings are given in
the text.

To do so, we need to solve the evolution of the atomcavity system conditioned to the case with no scattering.
The Lindbladian part of the master equation (V.3) describes random noise processes affecting the system. In
particular, the terms Li %t L†i dt corresponds to a scattering happening during an infinitesimal time interval dt.
In contrast, the conjugate term − 12 {L†i Li , %t }dt corresponds to no scattering happening during dt. Its role can
be thought of as reducing the probability to find the system in the pre-scattered state %t+dt → %t − 12 {L†i Li , %t }dt.
Hence, to describe the evolution of the system conditioned on no scattering, we drop all the terms Li %t L†i
but keep their conjugate terms − 12 {L†i Li , %t } in the master equantion (V.3). It is straightforward to see that such
an evolution preserves the purity of a state, and can be
written in the form of the Schrödinger equation with a
non-Hermitian Hamiltonian
!
X †
1
|Φ˙t i = −iHt −
L Li |Φt i .
(V.4)
2 i i
With the initial condition |Φs i = |s, 0i , this equation can
be solved to give the system state Φt|s conditioned on
the event corresponding to no scattering at time t ≥ s. In
particular, for a (piece-wise) constant Rabi frequency, the

12
†
1
solution reads Φt|s = e(−iH− 2 i Li Li )(t−s) |s, 0i which
can be computed numerically. To obtain the amplitude of
the emitted photon at a given
√ time we project the atomcavity state at this time into 2κ hd, 1|. In the laboratory
frame, this gives
Z ∞
|ψs i =
ψs (t) a†t |0i dt,
(V.5)
√s
ψs (t) = 2κ e−iωC t hd, 1|Φt|s i.

P

The photonic state |ψs i is sub-normalized. Its norm
ppure (s) = hψs |ψs i

(V.6)

is precisely the probability that no scattering event happens after time s (given the initial
p condition). The conditional state thus reads |ψs i / ppure (s). One notes that
ppure (0) is the probability that a photon is emitted without a single scattering during the evolution.

2.

Scattering probability

We now solve the full master equation (V.3) and obtain
the atom-cavity state %t for all times. Note that for a
(piecewise) constant Rabi frequency, the solution can be
obtained analytically by vectorizing the master equation
and the density matrix. From this state, we compute the
probability of scattering back to |s, 0i at time s


P (s) = Tr %s L†2 L2 .
(V.7)

3.

The photon state

The state of the emitted photon is given by
Z ∞
ρ = |ψ0 ihψ0 | +
P (s) |ψs ihψs | ds + P0 |0ih0| ,

(V.8)

0

where |ψs i is given in Eq. (V.5) and P (s) in Eq. (V.7).
Let us comment on each contribution separately. The
first term |ψ0 ihψ0 | describes a pure photon emitted without a single scattering (L2 , L3 ). This happens with probability ppure (0). The integral collects all the possibilities
where the last p − s-scattering happens at time s and no
scattering events happen at later times. Any such history happens with probability Pp
(s)ppure (s) and yields a
pure photon in the state |ψs i / ppure (s). Finally, the
last terms P0 |0ih0| with

R∞
P0 = 1 − Tr |ψ0 ihψ0 | + 0 P (s) |ψs ihψs | ds
Z
(V.9)
= 1 − ppure (0) − P (s)ppure (s)ds
collects the cases where no photon is emitted from the
cavity. If the laser pulse is not turned off, this term can

be alternatively computed as the overall probability of
the p − d scattering
Z ∞
(V.10)
P0 =
tr(L†3 L3 ρt ).
0

To shorten the equations we will combine the first two
contributions of Eq. (V.8) together by defining
P̄ (s) = P (s) + 2δ(s),
(V.11)
R
where δ(s) is the delta-function with 2 0 δ(s)ds = 1. The
photon state ρ in Eq.(V.8) then simply reads
Z ∞
ρ=
P̄ (s) |ψs ihψs | ds + P0 |0ih0| .
(V.12)
0

4.

Expected number of scattering events

Note that the average number of L2 scattering events
per experimental run is simply given by the time integral
of the scattering rate
Z ∞
P (s)ds,
(V.13)
0

and equals the expected number of laser photons scattered on the p − s transition.

C.

Photon statistics

Now that we have computed the photonic state ρ emitted from the cavity, let us consider the Hong-Ou-Mandel
(HOM) interference of two such photons, as depicted in
Fig. 1 of the main text. More precisely, we consider two
photons described by Eq (V.12) that enter the two ports
of a 50/50 beamsplitter followed by two photon detectors
D1 and D2. We assume detection with unit efficiency
here, and discuss the general case in the next section.

1.

Single click rates

The probability density that a photon in the state ρ
given in Eq. (V.12) triggers a click on the detector D1
(the same result is obtained
D2) at time
 for the detector

t is given by ps (t) =

1
2 Tr

ρ a†t |0ih0| at . Here, the 1/2

factor comes from 50/50 beamsplitter. Direct application
of Eqs. (V.12) and (V.5) gives
Z
1 ∞
ps (t) =
P̄ (s)|ψs (t)|2 ds,
(V.14)
2 0
where we formally set ψs (t) = 0 for s > t here and in the
following.

13
2.

Coincidence rates

We can now compute the twofold coincidence rate
when one photon is sent at each input of the beamsplitter. For two photons with orthogonal polarizations corresponding to states ρa and ρb⊥ , the probability to get a
click at time t1 in the detector D1 and a click at time t2
in the detector D2 is given by
(a)

(b )

(a)

We define the coincidence rate as a function of this delay
between the clicks
Z
pCk(⊥) (τ ) = pCk(⊥) (t2 + τ, t2 ) dt2 .
(V.20)
Furthermore, we define detection window T , by accepting
only the coincidence events with a delay |τ | ≤ T falling
inside this window. For a fixed window T the HOM visibitity is defined as

(b )

pC⊥ (t1 , t2 ) = pS (t1 )pS ⊥ (t2 ) + pS (t2 )pS ⊥ (t1 ) (V.15)
simply because there is no interference.
Next, we consider two photons with the same polarization ρa and ρb . They are respectively characterized
(a)
(b)
by P̄a (sa ) with ψsa and P̄b (sb ) with ψsb accordingly to
Eq. (V.12). The twofold coincidence probability with the
detector D1 clicking at time t1 and the detector D2 clicking at t2 is computed as pc (t1 , t2 ) = Tr (ρa ⊗ ρb Πt1 ,t2 )
where Πt1 ,t2 is the projector onto
1 †
(a + b†t1 )(a†t2 − b†t2 ) |00i
2 t1

(V.16)

V (T ) = 1 − R(T )

where R(T ) is the ratio between the coincidence probabilities for parallel and orthogonal polarizations with a
bounded delay |τ | < T
RT
R(T ) = R −T
T
−T

|ψs(a)
(t1 )ψs(b)
(t2 ) − ψs(a)
(t2 )ψs(b)
(t1 )|2 dsa dsb .
a
a
b
b
(V.17)

pCk (τ )dτ

.

(V.22)

pC⊥ (τ )dτ

As mentioned after Eq. (V.18), the effect of the photon
bunching on the visibility is captured by
Z

T

Z
dτ

where a†t1 for example is the bosonic creation operator
for the input mode a at time t1 , as in Eq.(V.5). From
Eqs. (V.12) and (V.5) we find
Z
1 ∞
pCk (t1 , t2 ) =
P̄a (sa )P̄b (sb )×
4 0

(V.21)

−T

dt2 ψs(a)
(t2 + τ )ψs(a)∗
(t2 ) ψs(b)∗
(t2 + τ )ψs(b)
(t2 )
a
a
b
b
+ h.c.

From this equation, we see that pCk (0) = 0. The visibility thus increases when the detection window T is
shortened. This can be intuitively understood from the
fact that narrowing the detection window removes some
of the temporal mixedness of the photons and effectively
purifies them. The price to pay for decreasing T is that
the probability

The integrand in the last equation reads
Z
|ψs(a)
(t1 )ψs(b)
(t2 ) − ψs(a)
(t2 )ψs(b)
(t1 )|2 =
a
a
b
b
|ψs(a)
(t1 )|2 |ψs(b)
(t2 )|2 + |ψs(a)
(t2 )|2 |ψs(b)
(t1 )|2
a
a
b
b
− ψs(a)
(t1 )ψs(a)∗
(t2 ) ψs(b)∗
(t1 )ψs(b)
(t2 )
a
a
b
b

T

Psucc (T ) =

pC⊥ (τ )dτ.

(V.23)

−T

(V.18)

to observe a coincidence within the detection window decreases with T for orthogonally polarized photons.

− ψs(a)∗
(t1 )ψs(a)
(t2 ) ψs(b)
(t1 )ψs(b)∗
(t2 ).
a
a
b
b
The last two terms are responsible for a destructive interference and bunching of the incident photons, which
reduces the coincidence rate as compared to the orthogonal case.

3.

Visibility of the Hong-Ou-Mandel pattern

The absolute detection times t1 and t2 are not relevant for computing the visibility of the Hong-Ou-Mandel
(HOM) interference pattern. What matters is the difference between the detection times
τ = t1 − t2 .

(V.19)

D.

Predictions

With such a theoretical model for the state of emitted
photons and the HOM interference pattern, we can find
experimental parameters facilitating the implementation
of certain tasks that are relevant for quantum networking. An interesting experiment in this framework
aims to entangle two ions remotely by first creating
locally ion-photon entanglement and then performing
a photonic Bell state measurement at a central station
[15, 41]. Ion-photon entanglement is created by modifying our experiment to enable the transitions from the
excited state |pi to two states |di and |d0 i leading to
cavity photons with orthogonal polarizations, as we have
previously shown [18, 22]. Two such photons emitted
from cavities located at different locations are then sent

14

V(T)

1.

Detection efficiency

The non-unit detection efficiency is modelled by a loss
channel acting on the photon state prior to detection.
Since the photonic state ρ in Eq. (V.12) is a mixture
of a single photon distributed across difference temporal modes and a vacuum component, the effect of loss
is particularly simple to describe. A loss channel with
transmission rate η simply maps
P̄ (s) 7→ η P̄ (s) P0 7→ 1 − η(1 − P0 ).

Psucc(T)
FIG. A.8. A parametric plot of the Hong-Ou-Mandel visibility V (T ) versus the success probability Psucc (T ) for different
values of the Rabi frequency Ω. For each curve T ∈ [0, ∞) is
increasing from left to right. All the feagures are computed
for ∆ = −2π × 400 MHz, κ = 2π × 0.07 MHz,p
γsp = 2π × 10.7
MHz, γdp = 2π × 0.7 MHz, and g = 2π × 1.2 4/15 MHz.

The loss of cavity photons outside of the detected mode
is also equivalent to a lack of detection efficiency. In such
a case, the total cavity decay rate entering in the master
equation is the sum of the loss rate towards the detector
κdet and in modes that are not measured κloss , that is
κ = κdet + κloss . The detection efficiency is reduced by
an additional factor ηκ = κdet
κ .
2.

into a beamsplitter which is followed by two detectors.
A twofold coincidence projects the two ions into an
entangled state. In such an entanglement swapping
experiment, the fidelity F (with respect to a maximally
entangled two qubit state) of the two ion state can be
shown to be proportional to the HOM visibility V [32].
Furthermore, the rate at which the entangled states
are created is related to the success probability Psucc
defined in Eq. (V.23). Hence, both the visibility V and
the success rate Psucc play an important role for the
entanglement swapping experiment. We thus wish to
find experimental parameters maximizing the success
rate given that the visibility stays above a threshold
value (or vice versa). In particular, we focus on the
impact of the Rabi frequency Ω on the visibility V
and the success rate Psucc . In Figure A.8, we give a
parametric plot of V and Psucc for various detection
window T . Different curves correspond to different
values of the Rabi frequency Ωt = Ω for t ≥ 0. We see
that in the range of small Psucc where V remains high,
there is a globally optimal Rabi frequency Ωopt ≈ 2π ×40
MHz which maximizes V for all values of Psucc .

(V.24)

Mode mismatch

In practice, the two modes entering the beamsplitter preceding the two detectors do not perfectly overlap,
which reduces the visibility of their interference pattern.
An imperfect overlap of ε means that with probability
ε the two photons entering the interference will not see
each other. The coincidence rate for two photons with
the same polarization becomes
pCk → (1 − ε) pCk + ε pC⊥ .

(V.25)

This is how we model a fixed nonzero distinguishability
of the interfering photons in order to reproduce experimental date, see Figs. 2 and 3 in the main text.
3.

Photon frequency mismatch

We here model the effect of the frequency distinguishability of the two photons arriving at the beamsplitter on
the HOM-type interference experiment. We restrict ourselves to a simple approximation where the photons have
a constant offset and a linear drift of the frequency in
time
ω(t) = ω0 + ωs + ωd t

(V.26)

where ωs and ωd can be random variables over the experimental attempts. We will come to their distributions
later.
E.

Extended models: imperfections beyond
scattering

In this section we discuss various imperfections that
are detrimental for the photon counting statistics, and
show how to describe them within our model.

In the two photon experiment, the frequency uncertainty affects the phase of the photonic wave-function. In
particular, for the computation of the coincidence rate,
we are interested in the factor
f = hei(φ1 (t1 )−φ1 (t2 )−φ2 (t1 )+φ2 (t2 )) i,

(V.27)

15
where φ1 and φ2 is the phase of photons emitted at times
t1 and t2 , and h•i denotes the statistical average over
the phases. The photon phase is the time integral of its
instantaneous frequency
Z t
t2
(V.28)
φ(t) =
ω(s)ds = ωs t + ωd .
2
0
Given that the second photon is delayed from the first
one by a time τ, we get
(φ1 (t1 ) − φ1 (t2 ) − φ2 (t1 ) + φ2 (t2 ))
= (φ(t1 ) − φ(t2 ) − φ(t1 + τ ) + φ(t2 + τ ))
= ωd τ (t2 − t1 ).

Z

eiωd τ (t2 −t1 ) p(ωd )dωd

(V.29)

(V.30)

= p̃(τ (t2 − t1 )),
where p̃ is the Fourier transform of p(ωd ). Let us assume
that the distribution of the drift is a Gaussian with a zero
mean and an unknown variance σ 2
p(ωd ) = √

2
ωd
1
e− 2σ2 .
2πσ

(V.31)

In this case,
1

f = e− 2 τ

2

(t2 −t1 )2 σ 2

.

(V.32)

It remains to relate σ to experimentally measured parameters. In the experiment, we measure v(T̄ ) – the average
squared deviation of the cavity frequency over a time T̄ .
Under our assumption, this quantity reads
2
v(T̄ ) = h ω(0) − ω(T̄ ) i = T̄ 2 σ 2 .

(V.33)

We obtain
1

f (|t2 − t1 |, τ ) = e− 2 τ
≈1−

2

(t2 −t1 )2

v(T̄ )
T̄ 2

τ 2 (t2 − t1 )2 v(T̄ )
.
2T̄ 2

1.

General principles:

Spontaneous scattering rates

For all modelling, the scattering rates are γpd = 2π ×
0.68 MHz and γps = 2π×10.7 MHz (Figure 1, main text).

g factors, Clebsch-Gordan factors and finite temperature
effects

Following [42], by adiabatically eliminating the P -state
population, the coherent part of the cavity-mediated Raman transition (CMRT) can be described as an effective
0
βg0
. Here, Ω0 is
two-level system driven with Ωef f = Ω∆+δ
the drive strength of the CMRT (defined later), β is the
product of the Clebsch-Gordan-coefficient of the 854 nm
atomic transition and the projection of the polarization
plane of the cavity mode onto the atomic dipole moment,
∆ + δ is the detuning (fig. A.5) and g0 is the maximum
ion-cavity coupling strength. The finite temperature of
the ion after Doppler cooling leads to the Raman laser
coupling to the ion motional sidebands and thus a reduced coupling strength on the desired carrier transition
Ω0 = αΩ. Here, α (a real number, less than 1) is the reduction factor of the carrier drive-strength and Ω is the
Raman-laser Rabi frequency used for the theory calculations (eq. V.1) and throughout the manuscript. We
calculate α using eq. 3.11 of [43] for the known (independently measured) motional state of the ion in all
directions. We define the effective ion-cavity coupling
g = αβg0 , which is used for the theoretical calculations
(eq. V.1). For the transition to the Dmj =−5/2 state (V
p
photon, long path) β = 10/15 · 1/2 , where 1/2 stands
for the projection of the polarization plane of the cavity
mode to the atomic dipole moment. For the transition
to
p
the Dmj =−3/2 state (H photon, short path) β = 4/15.

(V.34)
3.

Finally, let us note that we do not need to assume the
exact form of the distribution p(ωd ). As long as the distribution is symmetric p(ωd ) = p(−ωd ), and the dephasing
effect is small, we can develop the Fourier transform of
the distribution p(ωd ) to the second order to get
p̃(τ (t2 − t1 )) ≈ 1 − τ 2 (t2 − t1 )2 σ 2

A.

2.

and thus
f=

Appendix VI: Data modelling

(V.35)

as a function of a single parameter σ 2 , which is expressed
in the same way as v(T̄ )/T̄ 2 .

Calibration of experimental parameters

The maximum ion-cavity coupling strength g0 is calculated using the known cavity length and waist, and
indirectly measured by comparing photon wave-packet
and generation efficiency (measured at negligible temperature, with additional side-band cooling) to numerical simulations [42]. Both approaches give a value of
g0 /2π = 1.53 ± 0.01 MHz. We calculate that the ion’s
wavepacket delocalisation after Doppler cooling introduces no significant (compared to α) decrease of the ioncavity coupling strength (the delocalisation is predominantly in a direction perpendicular to the vacuum cavity
standing waves). We determine Ω by performing 393 nm
spectroscopy of the Raman resonance for different intensities of the Raman beam and extracting the induced

16
AC-Stark shift. The cavity detuning (∆ = 403±5 MHz),
measured with a wavemeter, is the frequency difference
of the 393 laser when tuned on resonance with the S-P
transition and when tuned to the Raman resonance condition. The lifetime of the P state limits the precision of
this measurement.
We determine the mean phonon number of each motional modes of the ion by performing Rabi flops on the
729 (S1/2 → D5/2 ) transition and fitting the observed dependence of the excitation probability on the pulse length
with a model that takes into account the ion temperature
(for details see [43]). Flops are taken with two different
729 nm laser beam directions, allowing the temperature
in different motional modes to be distinguished.

C.

Modelling in figure 3: frequency converted case
1.

For the theory curves presented in Figure 3 (main
text) we determine Ω/2π = 64.3(5) MHz, ∆/2π =
403(5) MHz. The coupling reducing factor α = 0.69(2)
(g/(2πβ) = 1.05 MHz) was determined from the best
fit of the simulated photon wavepacket. This value is
lower than the value expected from the temperature calibration measurement before the experiment (g/(2πβ) =
1.15 MHz) which could be caused by slight drift of the
Doppler laser cooling parameters.

2.
B.

Modelling in figure 2
1.

Ideal model

For the theory curves presented in Figure 2 of the main
text, we experimentally determine Ω/2π = 63.5(5) MHz,
∆/2π = 403(5) MHz. The coupling-reducing factor α =
0.75(2) (g/(2πβ) = 1.15 MHz) was calculated from a
mean-phonon-number of 14 on the axial mode (ωax =
0.9 MHz) and a mean-phonon-number of 6 on the radial
mode (ωrad = 2.4 MHz).

2.

Extended model

For the extended-model curves in Figure 2 we model
the frequency mismatch as a constant frequency offset
according to eq. V.26, with ωs /2π = 40 kHz, ωd = 0
(from best match to the experimental data).
Due to the excess of distinguishability in the experiment compared to theory even for the smallest coincidence window T , an additional constant distinguishability of  = 0.01 was introduced into the model, according to V.25. This could be caused by any mode
mismatch, e.g. imperfect photon polarizations at the final beam-splitter due to an imperfectly aligned PBS and
slight imperfections in the beam splitter itself. The effect
of background coincidences (due to dark counts, background light, imperfect g (2) (0)) was measured to be at
the 5 × 10−4 level and was neither subtracted from the
experiment data nor taken into account in the model.

Ideal model

Extended model

As in the case of the experiment without conversion,
the discrepancy of theoretical and experimental visibilities, which depends on the coincidence window size, is
attributed to the photons’ frequency mismatch. When
implementing photon frequency conversion before and after the delay line, the effect of the frequency instability of
the unstablized conversion pump laser (1902 nm) has to
be taken into account and is the dominant effect. In our
implementation there is a significant optical path length
difference of ∼ 15µs (the whole delay line) between the
pump laser field and the photon (see fig. A.4). In that
case any laser frequency drift on this time scale will result in a frequency mismatch of the short and long path
photons at the interference beamsplitter. Note, however,
that the constant (in time) part of the pump-laser frequency is expected to cancel out since the down and up
conversion processes are symmetric. Based on the laser
specification we expect ∼ 50 kHz instability on a 10µs
timescale, making it the dominant source of frequency
mismatch.
To plot the extended-model curves in Figure 3 (main
text) we use V.33 with v(10µs) = 2π · 50 kHz and take
into account the measured background-coincidence-rate
by adding a constant coincidence-probability-density of
0.8 · 10−6 µs−1 (Figure 3b). The extended theory lines
of Figure 3c are calculated by integrating the coincidence distributions including this background floor. The
background coincidences are significant in the experiment
with conversion because the signal level is 5 times lower.
Also, the observed free-running noise counts were 13(2)
cps compared to 2(2) cps per detector for the experiment
without conversion due to the photon noise introduced by
the frequency conversion process.

