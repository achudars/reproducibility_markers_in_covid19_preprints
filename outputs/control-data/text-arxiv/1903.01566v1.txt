ON ADDITIVE DIVISOR SUMS AND PARTIAL DIVISOR FUNCTIONS

arXiv:1903.01566v1 [math.NT] 4 Mar 2019

J.C. ANDRADE AND K. SMITH

Abstract. We establish asymptotic formulae for various correlations
involving general
P
divisor functions dk (n) and partial divisor functions dl (n, A) = q|n:q≤nA dl−1 (q), where
A ∈ [0, 1] is a parameter and k, l ∈ N are fixed. Our results relate the parameter A to the
lengths of arithmetic progressions in which dk (n) is uniformly distributed. As applications
to additive divisor sums, we establish new lower bounds and a new equivalent condition
for the conjectured asymptotic. We also prove a Tauberian theorem for general additive
divisor sums.

Contents
1. Introduction
1.1. Additive divisor sums
1.2. Exponents of distribution
1.3. Partial divisor functions
2. Results
2.1. On partial divisor functions
2.2. On additive divisor sums
3. Definitions
4. Proofs
4.1. Theorem 2.3
4.2. Theorems 2.1 and 2.2
4.3. Theorem 2.4
4.4. The coefficients in the case k = l = 2
References

2
2
4
5
7
7
8
9
10
10
19
22
24
26

Date: March 6, 2019.
2010 Mathematics Subject Classification. Primary 11N37; Secondary 11M06.
Key words and phrases. divisor function, additive divisor sum, arithmetic progression, uniform distribution, exponent of distribution.
1

2

J.C. ANDRADE AND K. SMITH

1. Introduction
The focus of this paper is the problem of finding asymptotic formulae for ‘additive divisor
sums’. That is, correlations
(1.1)

Dh,k,l (x) =

X

dk (n + h)dl (n),

n≤x

where h, k, l ∈ N are fixed and dk (n) denotes the number of ordered ways of writing n as a
product of k factors. In other words, this is the problem of counting the number of ordered
solutions of the Diophantine equation
h = n 1 · · · n k − m1 · · · ml
where (m1 , ..., ml ) ∈ Nl , (n1 , ..., nk ) ∈ Nk and n1 · · · nk ≤ x.
Our results on the correlations in (1.1) are given in Section 2.2. These results are immediate
corollaries of the results given in Section 2.1, which deal with correlations involving dk (n)
and partial divisor functions
X
dl (n, A) =
(1.2)
dl−1 (q)
A ∈ (0, 1].
q|n:q≤nA

As such, we emphasise the results given in Section 2.1.
1.1. Additive divisor sums. When k = l, the correlations in (1.1) arise in connection
with the problem of finding asymptotic formulae for the 2kth moments of the Riemann
zeta function on the critical line. This connection was first exploited by Ingham [20] in
the course of proving his asymptotic formula for the fourth moment of the Riemann zeta
function. Ingham proved that
6
σ−1 (h) log 2 x
π2
P
where σz (n) = d|n dz , and subsequently Estermann [11] established the asymptotic expansion
Dh,2,2 (x) ∼

(1.3)



Dh,2,2 (x) = xPh,2,2 (log x) + O x11/12+ǫ

where Ph,2,2 is a polynomial of degree 2. Estermann demonstrated that Dh,2,2 (x) is related
to the spectral theory of modular forms - his result made crucial use of a non-trivial bound
for Kloosterman sums. Heath-Brown [16] subsequentlyused Weil’s improved bound [38] for
Kloosterman sums to obtain the error term O x5/6+ǫ in (1.3), which was later improved

by Motohashi [28] to O x2/3+ǫ uniformly for h ≤ x20/27 . Each of these improvements
lead to corresponding improvements of the error term in the asymptotic expansion for the

ON ADDITIVE DIVISOR SUMS AND PARTIAL DIVISOR FUNCTIONS

3

fourth moment of the Riemann zeta function.
Due to the work of Hooley [19], Linnik [25], Fouvry and Tenenbaum [13], Heath-Brown
[17], Drappeau [9], Motohashi [27], Deshouillers and Iwaniec [8], Bykovski and Vinogradov
[3] and Topacogullari [34, 35, 36], it is now also known that for any fixed k there is a δ > 0
and a polynomial Ph,k,2 of degree k such that
Dh,k,2 (x) = xPh,k,2 (log x) + Oh,k (x1−δ ).

(1.4)

Despite these significant advances, asymptotic formulae for Dh,k,l (x) remain elusive when
both k, l ≥ 3. The central conjecture—formulated by Conrey and Gonek [5] and Ivić
[21, 22] via the ‘δ-method’ of Duke, Friedlander and Iwaniec [10], and recently refined by
Ng and Thom [30] and Tao [31]—is as follows.
Conjecture 1.1. If h, k, l ∈ N with k, l fixed and h = O(x1−ǫ ) for each fixed ǫ > 0, then
there is a δ > 0 and a polynomial Ph,k,l of degree k + l − 2 such that
Dh,k,l (x) = xPh,k,l (log x) + Oǫ,k,l (x1−δ ).
The asymptotic is conjectured to be
Ck,l fk,l (h)
Dh,k,l (x)
∼
(1.5)
k+l−2
(k − 1)!(l − 1)!
x log
x
as x → ∞, where
Y
l−1
k−1
k+l−2
(1.6)
1 − p−1
+ 1 − p−1
− 1 − p−1
Ck,l =
p

and

fk,l (h) =

Y (1 − p−1 )
p|h

(1.7)
where h =

Q

Pγ
0

dl−1 (pα )
(1 −

P∞

β −β + d (pγ )
k
α dk (p )p
−1
1−k
−1
p )
+ (1 − p )1−l −

P∞

γ+1 dl−1 (p

α )p−α

1

pγ .

The general form of the coefficients Ck,l and fk,l (h) appearing in (1.5) were calculated by
Ng and Thom [30] based on the techniques introduced by Conrey and Gonek [5], and the
same prediction was made by Tao [31] based on pseudorandomness heuristics.
The asymptotic order of Dh,k,l (x) is fairly well understood. Regarding upper bounds, it
follows from the general theorem of Nair and Tenenbaum [29] that
(1.8)

Dh,k,l (x) = Oh,k,l (x logk+l−2 x),

with uniformity in the h aspect following from the work of Henriot [18]—the paper of Ng
and Thom [30] discusses these matters in detail. However, when k, l ≥ 3, it is notable that

4

J.C. ANDRADE AND K. SMITH

explicit bounds on the size of the constant implied in (1.8) have not yet appeared in the
literature. Regarding lower bounds, the best general result in the literature is due to Ng
and Thom [30], who showed that for k, l ≥ 3 there is a Bk,l > 0 such that for


h ≤ exp Bk,l (log x log log x)(min(k,l)−1)/(min(k,l)−1.99)
we have

Dh,k,l (x)
≥
x logk+l−2 x

(1.9)



1 + Ok,l



log log h
log x



22−k−l Ck,l fk,l (h)
.
(k − 1)!(j − 1)!

Regarding averages over h, Matomaki, Radziwill and Tao [26] have recently shown that
the conjectured asymptotic (1.5) holds for k, l ≥ 2 and almost all h ≤ H, provided that
x8/33+ǫ ≤ H ≤ x1−ǫ , improving on previous work of Baier, Browning, Marasingha and
Zhao [1] on the case k = l = 3.
1.2. Exponents of distribution. The problem of the asymptotic behaviour of additive
divisor sums is closely related to the problem of improving the ‘exponent of distribution’
for the generalised divisor problem in arithmetic progressions. An exponent of distribution
is a lower bound on the lengths of arithmetic progressions n ≡ h (mod q), (h, q) = g, in
which dk (n) is uniformly distributed.
Definition 1.1. A real number 0 < θg,k ≤ 1 is an exponent of distribution for dk (n) if for
every q ≤ xθg,k −ǫ and each residue class h 6≡ 0 (mod q), we have


 1−δ 
s
X
X
x
x
dk (n)
1


Res
, s = 1 + Oǫ,δ,k
(1.10)
dk (n) =
s
φ (q/g)
s
n
φ (q/g)
n≡h

n≤x
(mod q)

(n,q)=g

for some fixed δ > 0 and ǫ > 0.
An alternative way of writing (1.10) is
(1.11)
n≡h

X

n≤x
(mod q)

 1−δ 
X
1
x
dk (n) =
χ0 (n)dk (gn) + Oǫ,δ,k
φ (q/g)
φ (q/g)
n≤x/g

where χ0 is the principal Dirichlet character to the modulus q/g. Definition 1.1 is motivated by the fact that we expect dk (n) to be uniformly distributed even in short arithmetic
progressions (i.e. with q ≤ x1−ǫ for every fixed ǫ > 0). In other words, we expect that
θg,k = 1 for all k provided that g is not large, say g ≤ x1−ǫ .

ON ADDITIVE DIVISOR SUMS AND PARTIAL DIVISOR FUNCTIONS

5

Currently however, we can only prove uniform distribution in sufficiently long arithmetic
progressions. The best results in the literature are as follows. For k = 2, Hooley [19] established that we may take θ1,2 = 2/3. We have θg,3 = 21/41 for all g due to Heath-Brown
[17], θ1,4 = 1/2 due to Lavrik [24], and θ1,5 = 9/20, θ1,6 = 5/12 and θ1,k = 8/3k for k ≥ 7
due to Friedlander and Iwaniec [14]. For k > 2, the only known k for which an exponent
of distribution greater than 1/2 is known is k = 3, and both proofs (including the inferior exponent 58/115 due to Friedlander and Iwaniec [14]) depend on Deligne’s Riemann
hypothesis for algebraic varieties over finite fields. For specific moduli, further increments
have also been achieved. For instance, via general estimates for sums of trace functions
over finite fields twisted by Fourier coefficients of Eisenstein series, Fouvry, Kowalski and
Michel [12] have shown that (1.10) holds for k = 3 for all primes q ≤ x12/23 (albeit with
x−δ in the error term replaced with log−C x for every C > 0). The error term can be given
explicitly in specific cases, although we will not be concerned with these details here.
With the exception of Heath-Brown’s result for k = 3, the above results on exponents of
distribution are stated only for g = 1. This is usually because g = 1 is the only value
that is required in applications to primes in arithmetic progressions. Yet, for applications
to additive divisor sums, we require exponents of distribution for all g in some range as
x → ∞. In this regard, by generalising Heath-Brown’s argument, Chace [4] has shown that


log g
1
, θ1,k + (1 − kθ1,k ) lim sup
(1.12)
θk = max
k
x→∞ log x
is an exponent of distribution for dk (n) for all g.

1.3. Partial divisor functions. A central principle in this paper is that partial divisor
functions
(1.13)

dk (n, A) =

X

dk−1 (d)

A ∈ (0, 1]

d|n
d≤nA

provide robust approximations to dk (n) in arithmetic progressions. This property is essential in applications to correlation problems such as (1.1). We return to this in due course.
The pointwise relationship between dk (n) and dk (n, A) is generally unpredictable. In this
regard, Tenenbaum [32] showed that
(1.14)

lim

n→∞
n∈S

d2 (n, A)
d2 (n)

does not exist for any fixed A ∈ (0, 1) when S ⊆ N has positive measure. Furthermore,
Tenenbaum [33] showed that for every pair A, B ∈ (0, 1) there is an S of positive measure
in which d2 (n, A) = d2 (n, B) for every n ∈ S. Presumably, the same conclusions hold for
every k ≥ 2.

6

J.C. ANDRADE AND K. SMITH

On the other hand, the limit in (1.14) exists on particular sets S of zero measure. For
example, if p is prime then we have
dk (pα , A)
= Ak−1
α→∞ dk (pα )

(1.15)

lim

and so, by partial summation and (1.15), it follows that
X
X
(1.16)
aα dk (pα )
aα dk (pα , A) ∼ Ak−1
α≤X

α≤X

whenever (aα ) is a sequence of non-negative real numbers such that

P

α≤X

aα → ∞.

On average, the relationship between dk (n, A) and dk (n) is predictable. In this direction,
Deshoulliers, Dress and Tenenbaum [7] proved that the mean value of d2 (n, A)/d2 (n) converges to an arcsine distribution. This has been generalised by Bareikis [2], giving a beta
distribution
R A −1/k
u
(1 − u)1/k−1 du
1 X dk (n, A)
(1.17)
∼ 0
x
dk (n)
Γ(1/k)Γ(1 − 1/k)
n≤x

uniformly for 0 ≤ A ≤ 1 as x → ∞, for any fixed k ≥ 2.
Roughly speaking, the mean of a partial divisor sum corresponds to the logarithmic mean
over the partial range. That is, if f : N → C, then





X
X
X
X
|f (n)| 
f (n)


A ∈ (0, 1],
+O
f (d) = x

1−1/A
n


n
A
A
n≤x
d|n
d≤nA

n≤x

n≤x

(1.18)

uniformly for A ≥ A0 > 0. Taking f (n) = dk−1 (n) in (1.18) and using Perron’s formula
to evaluate the r.h.s, it is easily seen that dk (n, A) approximates Ak−1 dk (n) in the mean,
that is


X
X
(1.19)
dk (n) + OA x logk−2 x .
dk (n, A) = Ak−1
n≤x

n≤x

Here, it is notable that the non-multiplicativity of dk (n, A) is crucial to the quality of
the
in (1.19). Indeed, since dk (pα , A) = dk (p⌊αA⌋ ), the mean value of
Q approximation
α
p|n dk (p , A) exists for every A < 1 and k ∈ N, whereas the mean of dk (n) is ∼
logk−1 x/(k − 1)!.

ON ADDITIVE DIVISOR SUMS AND PARTIAL DIVISOR FUNCTIONS

7

An elementary refinement of (1.18) is that


(1.20)

n≡h

X

n≤x
(mod q)



 x X (n, q)f (n)
X
X
|f (n)| 


,
+O
f (d) =

 q
n

n1−1/A
A
A
d|n
d≤nA

n≤x

n≤x
(n,q)|h

which may be proved by interchanging the order of summation and trivially estimating
the length of the resulting arithmetic progression. However, in applications to correlation
problems, the error term in (1.20) is not strong enough. Typically we require an additional
factor of 1/q, uniformly for q ≤ xC as x → ∞ for some C > 1 − A. Our first theorem
(Theorem 2.1) establishes the requisite refinement of (1.20) in the case f (n) = dk−1 (n), with
a fairly strong value of C. Our second theorem (Theorem 2.2) is deduced from Theorem
2.1.
2. Results
2.1. On partial divisor functions. The theorems in this section do all the work in proving the corollaries on additive divisor sums in Section 2.2. Theorems 2.1 and 2.2 are proved
in Section 4.2 and Theorem 2.3 is proved in Section 4.1. In light of the structural connection to additive divisor sums, theorems of this type are potentially of further use in such
applications. Moreover, in accordance with the conjecture that θk = 1, we expect that the
ranges of A, B and q for which these formulae hold may be improved significantly.
Theorem 2.1 shows that dk (n, A) provides a robust approximation to Ak−1 dk (n) in arithmetic progressions.
Theorem 2.1. If h, k ∈ N are fixed and q ≤ xmin(θk ,Aθk−1 )−ǫ , then
(2.1)

X

dk (n, A) = Ak−1

n≤x
n≡h (mod q)

In other words
X
(2.2)

n≤x
n≡h (mod q)

X

dk (n) + OA,ǫ,h,k

n≤x
n≡h (mod q)

x X (n, q)dk−1 (n)
dk (n, A) =
+ OA,h,k
q
n
A
n≤x
(n,q)|h

x logk−2 x
q

x logk−2 x
q

!

!

.

.

Theorem 2.2 gives an asymptotic formula for the correlation of dk (n, A) with dl (n, B).
Theorem 2.2. If A ≤ 1, B < min(θk , Aθk−1 ) and h, k, l ∈ N are fixed, then
X

n≤x

(2.3)

Ak−1 B l−1 Ck,l fk,l (h)
x logk+l−2 x
(k − 1)!(l − 1)!


+ OA,B,h,k,l x logk+l−3 ,

dk (n + h, A)dl (n, B) =

8

J.C. ANDRADE AND K. SMITH

where Ck,l and fk,l (h) are defined in (1.6) and (1.7).
Theorem 2.3 gives an asymptotic expansion with power saving error term for the correlation
of dk (n) and dl (n, A).
Theorem 2.3. If A < θk and h, k, l ∈ N are fixed, then there is a δ > 0 and a polynomial
PA,h,k,l of degree k + l − 2 such that
(2.4)

X

n≤x



dk (n + h)dl (n, A) = xPA,h,k,l (log x) + OA,δ,h,k,l x1−δ .

An explicit formula for PA,h,k,l is given in (4.20). In particular, the coefficient of the
leading term is Al−1 Ck,l fk,l (h)/(k − 1)!(l − 1)!.
We note that if θk > 1/2 and l = 2, then A = 1/2 is admissible in Theorem 2.3, which
thus yields an alternative proof of (1.4) in such cases. For example, in Section 4.4 we carry
out this calculation in the case k = l = 2 to reproduce Estermann’s asymptotic expansion
(1.3) explicitly.
2.2. On additive divisor sums. Corollaries I, II and III follow immediately from the
theorems of Section 2.1.
Corollary I sharpens the lower bound (1.9) given by Ng and Thom in [30] when h is fixed
and k is sufficiently large in comparison with l.
Corollary I. For fixed h, k, l ∈ N we have
(2.5)

lim inf
x→∞

Ck,l fk,l (h)
Dh,k,l (x)
.
≥ θkl−1
k+l−2
(k
− 1)!(j − 1)!
x log
x

Proof. Note that dl (n) ≥ dl (n, A), and use Theorem 2.3.



For instance, given Heath-Brown’s exponent θ3 = 21/41, it follows from Corollary I that
lim inf
x→∞

Dh,3,3 (x)
C3,3 f3,3 (h)
≥ 0.262
.
4
4
x log x

Corollary II gives an equivalent condition for the conjectured asymptotic (1.5).
Corollary II. For fixed h, k, l ∈ N, the asymptotic (1.5) holds if and only if
(2.6)

X

n≤x





dk (n + h) dl (n) − B 1−l dl (n, B) = o x logk+l−2 x

for some (and hence every) B < θk .
Proof. Compare (1.5) with Theorem 2.3 or Theorem 2.2 with A = 1.



ON ADDITIVE DIVISOR SUMS AND PARTIAL DIVISOR FUNCTIONS

9

In support of the plausibility of (2.6), we note that
Corollary III. If A < θl , B < min(θk , Aθk−1 ) and h, k, l ∈ N are fixed, then




X
(2.7)
dk (n + h, A) dl (n) − B 1−l dl (n, B) = OA,B,h,k,l x logk+l−3 x .
n≤x

Proof. This follows from Theorem 2.2 by swapping variables A, B and k, l.



The last result of this section is Theorem 2.4. This is a Tauberian theorem and may be
viewed as an analogue of the relationship between the Prime Number Theorem and the
non-vanishing of ζ(1 + it), in which we view Dh,k,l (x) analogously to π(x). Theorem 2.4 is
proved in Section 4.3.
Theorem 2.4. Let h, k, l ∈ N and 0 ≤ y < ∞ be fixed, then the function


∞ d (n + h)d n, y
X
k
l
log n
Dh,k,l (s, y) =
(σ > 1)
s
(n + h)
1

has an analytic continuation to the complex plane except for a pole of order k − 1 at s = 1
and, if the limit
lim Dh,k,l (1 + it, y)

y→∞

is continuous for t 6= 0, then we have
Ck,l fk,l (h)
Dh,k,l (x)
∼
k+l−2
(k − 1)!(l − 1)!
x log
x
as x → ∞.
3. Definitions
Definitions 3.1—3.4 arise in the course of the proofs.
Definition 3.1. For j ∈ N and s ∈ C, we define
(s − 1)j ζ j (s) =

∞
X
ar (j)
r=0

and
1 dn (s − 1)j ζ j (s)
n! dsn
s
Definition 3.2. For h, k, l ∈ N, h =
Ck,l (s, w) =

=
s=1

Q

r!

(s − 1)r

n
X
(−1)n−r ar (j)
r=0

r!

pγ , ℜw > −1 −

σ−1
l−1

= cn (j).
and σ > −ℜw, we also define

Y
(1 − p−s )k
(1 − p−s )k (1 − p−w−1 )l−1
(1 − p−w−1 )l−1 +
−
,
1 − p−1
1 − p−1
p

10

J.C. ANDRADE AND K. SMITH

fh,k,l (s, w) =

Y (1 − p−1 )
p|h

Pγ
0

dl−1 (pα )

P∞
α

dk (pβ )p−βs−αw + dk (pγ )

(1 − p−1 )(1 − p−s )−k + (1 −

P∞

γ+1 dl−1 (p
−w−1
1−l
p
)
−1

α )p−α(w+1)

and
(3.1)

∞
X
ϕh,k,l (q, s)

Ck,l (s, w)fh,k,l (s, w) =

1

qw

.

Definition 3.3. For m < k and n < l we define
bh,k,l,m,n =

k−1−m
X
X l−1−n
j=0

i=0

(3.2)

∞
al−1−n−j (l − 1)ck−1−m−i (k) ∂ i
∂ j X ϕh,k,l (q, s)
(l − 1 − n − j)!
i!∂si j!∂wj
qw
1

w=0,s=1

and note that the Dirichlet series in (3.2) converge absolutely. In particular, we have
bh,k,l,k−1,l−1 = Ck,l fk,l (h) where Ck,l and fk,l (h) are defined in (1.6) and (1.7).
Definition 3.4. Lastly, for m < k + l − 2 and 0 < A ≤ 1 we define
  X
j
r−m+l−2
k−1
X (−A)r−j−v+l−1 av (l − 1)(v − l + 1)r
X
i
m
aA,h,k,l,m = (−1)
j
v!
(3.3)

×

v=0

r=m−l+2

j=m−l+2



 k−1
∞
l − v − 2 X ck−1−i (k) ∂ i−j ∂ j+l−r−2 X ϕh,k,l (d, s)
i!
∂si−j ∂wj+l−r−2 1
dw
j−r
i=j

.
w=0,s=1

4. Proofs
4.1. Theorem 2.3.
Proof. We have
X

dk (n + h)dl (n, A) =

n≤x

X

dk (n + h)

n≤x

(4.1)

=

X

q≤xA

X

dl−1 (q)

q|n
q≤nA

dl−1 (q)

X

dk (n).

q 1/A +h≤n≤x+h
n≡h (mod q)

Using Definition 1.1 to evaluate the inner summations on the r.h.s of (4.1), for 0 < A < θk
we see that (4.1) is


s
X
X dl−1 (q)
X
d
(n)
(x
+
h)
k
 Res 

dk (n + h)dl (n, A) =
, s = 1
q
s
ns
A φ
n≤x

q≤x

(h,q)

(n,q)=(h,q)

,

ON ADDITIVE DIVISOR SUMS AND PARTIAL DIVISOR FUNCTIONS



11



X dl−1 (q)
X
(q 1/A + h − δA (q))s
dk (n)

 Res 
, s = 1
s
q
s
n
(n,q)=(h,q)
q≤xA φ (h,q)


X dl−1 (q)


+ OA,δ,k x1−δ
q
φ
A
q≤x
(h,q)


X dl−1 (q)(q 1/A + h − δA (q))1−δ



+ OA,δ,k x1−δ
q
φ
A
q≤x
(h,q)
−

(4.2)

where δA (q) = 0 or 1 depending on whether q 1/A is an integer or not. The summations in
the error terms in the third and fourth lines of (4.2) are OA,h (logl−1 x), so it remains to
evaluate the first two terms.
4.1.1. Evaluation of the primary term. We begin by evaluating the first term
Qonαthe r.h.s
Q ofγ
(4.2). Let χ0 denote
the
principal
character
to
the
modulus
q/g,
where
q
=
p
,
h
=
p
Q δ
and g = (h, q) = p so δ = min(α, γ). We have
∞
X dk (n) X
χ0 (n)dk (gn)
=
s
n
(gn)s
1

∞
YX

=

p

(n,q)=g

dk (pβ+δ )χ0 (pβ )p−(β+δ)s

0

k

= L (s, χ0 )bh,k (s, q)
where
∞
X
Y
−s k
bh,k (s, q) =
(1 − χ0 (p)p )
dk (pβ )χ0 (pβ−δ )p−βs
p|g

δ

is a multiplicative function of g for all k, s. By Cauchy’s theorem, the first term on the
r.h.s of (4.2) is

=
(4.3) =


∂ k−1 (s − 1)k ζ k (s)Zh,k,l s, xA (x + h)s
1
(k − 1)! ∂sk−1
s
s=1


k−1
X k − 1 ∂i

1
∂ k−1−i (s − 1)k ζ k (s)(x + h)s
A
s,
x
Z
h,k,l
k−1−i
(k − 1)!
∂si
s
i
s=1 ∂s
i=0

where
(4.4)

X dl−1 (q) Y



Zh,k,l s, xA =
q
q≤xA φ (h,q) p| q

(h,q)

1 − p−s

k

bh,k (s, q),

s=1

12

J.C. ANDRADE AND K. SMITH

and so our first task is to find asymptotic formulae for
To proceed, we note that the factor
dl−1 (q) Y


q
φ (q,h)
p| q

1 − p−s

(q,h)

∂i
Z
(s, Q)
∂si h,k,l

at s = 1 as Q → ∞.

k

of the summand in (4.4) is a multiplicative function of q for all h, k, s, and we shall now
show that bh,k (s, q) is also. From (4.3) we have
(4.5)

∞
X
Y dk (pδ(q) ) Y
−s k
dk (pβ )p−βs .
(1
−
p
)
pδ(q)s

bh,k (s, q) =

p|(q,h)
q
p| (q,h)

δ(q)

p|(q,h)
q
p∤ (q,h)

If q = rt with (r, t) = 1, we have (rt, h) = (r, h)(t, h) and δ(rt) = δ(r) + δ(t) for every p so
the inclusion p|(rt, h) in (4.5) is multiplicative, that is
Y

bh,k (s, rt) =

p|(r,h)
r
t
p| (r,h)
(t,h)

(4.6)

Y

×

p|(t,h)
t
r
p| (r,h)
(t,h)

dk (pδ(r) )
pδ(r)s
dk (pδ(t) )
pδ(t)s

Y

(1 − p−s )k

Y

−s k

∞
X

dk (pβ )p−βs

δ(r)

p|(r,h)
t
r
p∤ (r,h)
(t,h)

(1 − p

)

∞
X

dk (pβ )p−βs .

δ(t)

p|(t,h)
t
r
p∤ (r,h)
(t,h)

Since p|r implies p ∤ t, the intersection of the sets p|(r, h) and p|t/(t, h) in (4.6) is already
empty. It follows that if p|(r, h) then the inclusion p|t/(t, h) and exclusion p ∤ t/(t, h) is
superfluous, and vice-versa. Therefore
bh,k (s, rt) =

∞
X
Y dk (pδ(r) ) Y
−s k
dk (pβ )p−βs
(1 − p )
pδ(r)s

p|(r,h)
r
p| (r,h)

×

p|(r,h)
r
p∤ (r,h)

δ(r)

∞
Y dk (pδ(t) ) Y
X
−s k
dk (pβ )p−βs
(1 − p )
pδ(rt)s

p|(t,h)
t
p| (t,h)

p|(t,h)
t
p∤ (t,h)

= bh,k (s, r)bh,k (s, t).
Thus
X

Zh,k,l s, xA =
φh,k,l (s, q)
q≤xA

δ(t)

ON ADDITIVE DIVISOR SUMS AND PARTIAL DIVISOR FUNCTIONS

13

where the summand
φh,k,l (s, q) =

dl−1 (q) Y


q
φ (q,h)
p| q

1 − p−s

∞
X
k Y dk (pδ(q) ) Y
−s k
dk (pβ )p−βs
(1
−
p
)
pδ(q)s
p|(q,h)
q
p| (q,h)

(q,h)

p|(q,h)
q
p∤ (q,h)

δ(q)

is a multiplicative function of q for all h, k, l, s.
Since φh,k,l (s, q) is multiplicative, we define the Euler product

Φh,k,l (s, w) =

∞
YX
p

φh,k,l (s, pα )p−αw

0

for values of w ∈ C for which the r.h.s converges absolutely. If p ∤ h then φh,k,l (s, pα ) =
φ1,k,l (s, pα ) which, after some routine algebra, gives
(4.7)

Φh,k,l (s, w) = Ck,l (s, w)fh,k,l (s, w)ζ l−1 (w + 1),

where fh,k,l (s, w) is defined in (3.1) and the Euler product

(4.8)

Ck,l (s, w) =

Y
p

1−p


−w−1 l−1

(1 − p−s )k 1 − (1 − p−w−1 )l−1
+
1 − p−1



converges absolutely for ℜw > −1 − σ−1
l−1 and σ > −ℜw (this follows from the fact that the
largest power of p appearing in each factor of the Euler product has real part strictly less
than −1 when s, w are in this range). Consequently, Ck,l (s, w) is analytic and bounded on
compact subsets of the half planes ℜw > −1 − σ−1
l−1 and σ > −ℜw. It follows that for fixed
h, i, k, l the Dirichlet series
∞

X ∂ i ϕh,k,l (q, s)
∂i
C
(s,
w)f
(s,
w)
=
k,l
h,k,l
∂si
∂si
qw
1

is absolutely convergent and bounded for such values of s, w. Thus, using the relation
(4.9)

φh,k,l (s, q) =

X
d|q

ϕh,k,l (d, s)

dl−1 (q/d)
,
q/d

14

J.C. ANDRADE AND K. SMITH

we have
∂i
Zh,k,l (s, Q) =
∂si
=

(4.10)

=

+

dl−1 (q/d)
∂i X X
ϕh,k,l (d, s)
∂si
q/d
q≤Q d|q

∂i

∂si

X

ϕh,k,l (d, s)

d≤Q

X dl−1 (q)
q

q≤Q/d

l−1
X
al−1−j (l − 1) logj (Q/d)
∂i X
ϕ
(d,
s)
h,k,l
∂si
(l − 1 − j)!j!
j=0
d≤Q
!
Z
w
1
(Q/d)
dw
ζ l−1 (w + 1)
2πi (ǫ−2/l)
w

l−1
X
al−1−j (l − 1) ∂ i X
ϕh,k,l (d, s) log j (Q/d)
=
j!(l − 1 − j)! ∂si
0
d≤Q


X ∂i
ϕh,k,l (d, s) d2/l−ǫ 
+ O Qǫ−2/l
∂si
d≤Q

where the notation

R

in the fourth line of (4.10) denotes integration along a vertical line

from c − i∞ to c + i∞. That this integral is O (Q/d)ǫ−2/l follows from classical results
on the error term in the generalised Dirichlet divisor problem (see Titchmarsh [37], for
instance). Expanding logj (Q/d) as a polynomial in log Q, (4.10) is

=

j  
l−1
X
al−1−j (l − 1) X j
j=0

=

l−1
X

n=0

(4.11)

(c)

We also have

j!(l − 1 − j)!
logn Q
n!

l−1−n
X
j=0

n=0

n

logn Q



∂i X
j−n
ǫ−2/l
ϕ
(d,
s)(−
log
d)
+
O
Q
h,k,l
∂si
d≤Q

al−1−n−j (l − 1) ∂ i ∂ j X ϕh,k,l (d, s)
j!(l − 1 − n − j)! ∂si ∂wj
dw
d≤Q

w=0



+ O Qǫ−2/l .

ON ADDITIVE DIVISOR SUMS AND PARTIAL DIVISOR FUNCTIONS

∂ k−1−i (s − 1)k ζ k (s)(x + h)s
∂sk−1−i
s
= (x + h)(k − 1 − i)!

= (x + h)(k − 1 − i)!

(4.12)

k−1−i
X

r=0
k−1−i
X
m=0

ar (k)
r!

s=1
k−1−i−r
X
m=0

15

(−1)k−1−i−r−m logm (x + h)
m!

logk−1−i−m (x + h)
cm (k)
(k − 1 − i − m)!

Setting Q = xA in (4.11) and using (4.12), we conlude that (4.3) is

= (x + h)

k−1 X
l−1
X
An bh,k,l,m,n

m!n!

m=0 n=0



logm (x + h) log n x

k−1
k−1 X
X
logk−1−m (x + h)|cm−i (k)| X ∂ i
ǫ−2A/l

ϕh,k,l (d, s)
+ O (x + h)x
(k − 1 − m)!
∂si
A

= x

i=0 m=i

k−1 X
l−1
X
An bh,k,l,m,n

m=0 n=0

(4.13)

m!n!

d≤x

s=1



logm+n x + Oh,k,l x1−2A/l+ǫ ,



d2/l−ǫ  ,

where the coefficients bh,k,l,m,n are defined in Section 3.
4.1.2. Evaluation of the secondary term. We now evaluate the second term on the r.h.s of
(4.2). By Cauchy’s theorem, this is

=
=


∂ k−1 (s − 1)k ζ k (s)Wh,k,l s, xA
1
(k − 1)! ∂sk−1
s
s=1


k−1
i
X

1
∂ k−1−i (s − 1)k ζ k (s)
k−1 ∂
A
s,
x
W
h,k,l
k−1−i
(k − 1)!
∂si
s
i
s=1 ∂s
i=0

(4.14)

=

k−1
X

1 ∂i
A
s,
x
W
h,k,l
i! ∂si
i=0

where

WA,h,k,l (s, Q) =

ck−1−i (k),
s=1

X

q≤Q

By (4.9) we have

φh,k,l (s, q)(q 1/A + h − δA (q))s .

s=1

16

J.C. ANDRADE AND K. SMITH

∂i
WA,h,k,l (s, Q)
∂si

=
s=1

(4.15)

X dl−1 (q)((qd)1/A + h − δA (q))s
∂i X
ϕ
(d,
s)
h,k,l
∂si
q
d≤Q

=

q≤Q/d

i  X
X
∂j
i
∂ i−j
ϕ
(d,
s)
VA,h,l,Q(d, s)
h,k,l
∂si−j
∂sj
j
j=0

d≤Q

s=1

,
s=1

where
VA,h,l,Q(d, s) =

X dl−1 (q)((qd)1/A + h − δA (q))s
q

q≤Q/d

and
∂j
VA,h,l,Q(d, s)
∂sj

= (−1)j
s=1

X dl−1 (q)((qd)1/A + h − δA (q)) logj ((qd)1/A + h − δA (q))
q

q≤Q/d

= (−A)−j d1/A

X dl−1 (q) logj (qd)
+ OA,h,j,l ((Q/d)ǫ )
1−1/A
q

q≤Q/d

(4.16)

−j 1/A

= (−A)

d

j  
X
j
0

m

logj−m d

X dl−1 (q) logm q
+ OA,h,j,l ((Q/d)ǫ ) .
q 1−1/A

q≤Q/d

The inner summation on the r.h.s of (4.16) may be written as
Z
X dl−1 (q) logm q
dm l−1
(Q/d)w+1/A dw
(−1)m
ζ
(w
+
1)
,
=
m
2πi
w + 1/A
q 1−1/A
(ǫ) dw

q≤Q/d

which may be evaluated using Cauchy’s Theorem and classical results on the error term
in the generalised Dirichlet
divisor problem (see Titchmarsh [37]). The error term is

OA,h,l (Q/d)1/A−2/l+ǫ , and the residue at the pole at w = 0 is
=

m+l−2
m
X m + l − 2 ∂ v
(−1)m
m+l−1 ∂
w
ζ l−1 (w + 1)
(m + l − 2)!
∂wv
∂wm
v
v=0

= (−1)m−1 (Q/d)1/A

l+m−2
X
v=0

= (−1)m−1 (Q/d)1/A

l+m−2
X
r=0

av (l − 1)(v − l + 1)m
v!
r

log (Q/d)
r!

l+m−2−r
X
v=0

l+m−2−v
X
r=0

∂ m+l−2−v (Q/d)w+1/A
m+l−2−v w + 1/A
w=0 ∂w

(−A)l+m−1−v−r logr (Q/d)
r!

(−A)l+m−1−v−r av (l − 1)(v − l + 1)m
.
v!

w=0

ON ADDITIVE DIVISOR SUMS AND PARTIAL DIVISOR FUNCTIONS

17

As such, (4.16) is

−j

= (−A)

Q

1/A

j  
X
j
0

l+m−2−r
X

m

(−1)m−1 logj−m d

l+m−2
X
r=0

logr (Q/d)
r!

(−A)l+m−1−v−r av (l − 1)(v − l + 1)m
v!
v=0


+ OA,h,j,l Q1/A−2/l+ǫ d2/l−ǫ
×

(4.17)

and so, expanding logj (Q/d) as a polynomial in log Q on the r.h.s of (4.17), it follows that
(4.15) is

= −Q

1/A

j   l+m−2
r
l+m−2−r
X
X X
X
j
logu Q
(−1)
j
m
u!(r − u)!

i  
X
i
j=0

j

m=0

r=0

×



+ O Q1/A+ǫ−2/l

= −Q

1/A

u=0

∂ i−j

(−A)l+m−1−j−v−r a

v (l − 1)(v − l + 1)m
v!
∂si−j



v=0

X

ϕh,k,l (d, s)(− log d)j−m+r−u
s=1

d≤Q

j   m−u
i
i  
r
X
X
logl+u−2 Q X i
j XX
j
(−1)
(l + u − 2)!
j
m
m=u
j=u

u=2−l

r=0 v=0

(−A)r−j−v+1 av (l − 1)(v − l + 1)m ∂ i−j ∂ j+l−r−u−2 X ϕh,k,l (d, s)
(m − r − u)!v!
∂si−j ∂wj+l−r−u−2
dw
d≤Q


+ O Q1/A+ǫ−2/l

×

= −Q

1/A

j  X
i  
i
r−u
m X
X
X
logl+u−2 Q X i
j
j
(−1)
(l + u − 2)!
j
m r=u v=0
m=u
j=u

u=2−l

×

s=1,v=0

− 1)(v − l + 1)m ∂ i−j ∂ j+l−r−2 X ϕh,k,l (d, s)
(m − r)!v!
∂si−j ∂wj+l−r−2
dw
d≤Q


(−A)r−j−u−v+1 av (l


+ O Q1/A+ǫ−2/l

s=1,v=0

18

J.C. ANDRADE AND K. SMITH

j X
r−u
i  
i
X
X
(−A)r−j−u−v+1 av (l − 1)
logl+u−2 Q X i
j
(−1)
= −Q
j
(l + u − 2)!
v!
r=u v=0
j=u
u=2−l
!
j  


X
j (v − l + 1)m ∂ i−j ∂ j+l−r−2 X ϕh,k,l (d, s)
1/A+ǫ−2/l
+
O
Q
×
(m − r)!
∂si−j ∂wj+l−r−2
dw
m
s=1,v=0
m=r
1/A

d≤Q

i
i   j r−u
X
logl+u−2 Q X i X X (−A)r−j−u−v+1 av (l − 1)(v − l + 1)r
1/A
= −Q
(l + u − 2)!
v!
j r=u v=0
j=u
u=2−l




l − v − 2 ∂ i−j ∂ j+l−r−2 X ϕh,k,l (d, s)
1/A+ǫ−2/l
+
O
Q
×
∂si−j ∂wj+l−r−2
dw
j−r
s=1,v=0
d≤Q

so (4.14) is

= −Q

1/A

k−1   j r−u
k−1
X
logl+u−2 Q X i X X (−A)r−j−u−v+1 av (l − 1)(v − l + 1)r
j r=u
(l + u − 2)!
v!

×

l−v−2
j−r

= −Q1/A

X
k−1
i=j

k+l−3
X
u=0



×

l−v−2
j−r

(4.18)

v=0

j=u

u=2−l



ck−1−i (k) ∂ i−j ∂ j+l−r−2 X ϕh,k,l (d, s)
i!
∂si−j ∂wj+l−r−2
dw
d≤Q

logu Q
u!

X
k−1
i=j

k−1
X

j=u−l+2

 
i
j

j
X

r=u−l+2

r−u+l−2
X
v=0

s=1,v=0



+ O Q1/A+ǫ−2/l

(−A)r−j−u−v+l−1 av (l − 1)(v − l + 1)r
v!

ck−1−i (k) ∂ i−j ∂ j+l−r−2 X ϕh,k,l (d, s)
i!
∂si−j ∂wj+l−r−2
dw
d≤Q

s=1,v=0



+ O Q1/A+ǫ−2/l .

Taking Q = xA in (4.18) yields
1
∂ k−1 (s − 1)k ζ k (s)Wh,k,l s, xA
(k − 1)! ∂sk−1
s



= −x
s=1

(4.19)

k+l−3
X
u=0



aA,h,k,l,u logu x
+ O x1+ǫ−2A/l .
u!

From (4.2), (4.13) and (4.19), for A < θk we have
X

n≤x

(4.20)

dk (n + h)dl (n, A) = x

k−1 X
l−1
X
An bh,k,l,m,n

logm+n x + x

k+l−3
X

m!n!
m=0




+ OA,h,k,l x1+ǫ−2A/l + OA,δ,k x1−δ ,
m=0 n=0

aA,h,k,l,m logm x
m!

ON ADDITIVE DIVISOR SUMS AND PARTIAL DIVISOR FUNCTIONS

19

where the coefficients bh,k,l,m,n and aA,h,k,l,u are defined in Section 3. This concludes the
proof of Theorem 2.3.

4.2. Theorems 2.1 and 2.2.
Proof of Theorem 2.1. We begin by writing
n
X
(4.21)
+
dk−1
dk (n, A) = dk (n) −
d
d|n
d<x1−A

X

dk−1 (d),

d|n
nxA−1 <d≤nA

so that

n≡h

X

dk (n, A) =

(mod q)
n≤x

n≡h

X

+

(4.22)

X

dk (n) −

d<x1−A

(mod q)
n≤x

dk−1 (d)

d≤xA

X

dn≡h
d

X

X

dk−1 (n)

dn≡h (mod q)
n≤x/d

1.

(mod q)

1−A
A ≤n<x1−A

Firstly, using Definition 1.1 in the form (1.11), the first term on the r.h.s of (4.22) is


X
x1−δ
1
χ0 (n)dk ((h, q)n) + Oǫ,δ,k
(4.23)
φ (q/(h, q))
φ (q/(h, q))
n≤x/(h,q)

for q ≤ xθk −ǫ , where χ0 is the principal character to the modulus q/(q, h). Secondly, the
third term on the r.h.s of (4.22) is
X
X
≤
dk−1 (d)
n<x1−A dn≡h (mod q)
d≤xA

(4.24)

≤

X

n<x1−A
(n,q)|h

X

dk−1 (d).

d≡(n/(n,q))(h/(n,q)) (mod q/(n,q))
d≤xA

Using Definition 1.1 with q ≤ xAθk−1 −ǫ and the fact that ((n/(n, q))(h/(h, q)), q/(n, q)) =
(h/(n, q), q/(n, q)) = (h, q)/(n, q) when (n, q)|h, (4.24) is


!
k−2
 φk−2 (q/(h, q)) xA logk−2 x X 
x
log
x
= OA,ǫ,k 
.
1

 = OA,ǫ,h,k
(q/(h, q))k−1
q
1−A
n<x
(n,q)|h

(4.25)

20

J.C. ANDRADE AND K. SMITH

As such, (4.22) is

=

−

1
φ (q/(h, q))
X

d<x1−A

=

−

X

χ0 (n)dk ((h, q)n)

n≤x/(h,q)

X

dk−1 (n) + OA,ǫ,h,k

dn≡h (mod q)
n≤x/d

1
φ (q/(h, q))

X

x logk−2 x
q

!

χ0 (n)dk ((h, q)n)

n≤x/(h,q)

X
1
φ (q/(h, q))
1−A

X

χ0 (n)dk−1

n≤(x/(h,q))/(d/(d,q))
d<x
(d,q)|h



(h, q)n
(d, q)



+ OA,ǫ,h,k

x logk−2 x
q

!

(4.26)
for q ≤ xmin(θk ,Aθk−1 )−ǫ , where we have used Definition 1.1 again to write the second term
on the r.h.s of (4.26) as a character sum. We now write the second term as

X

−

X

χ0

m≤x/(h,q) d<x1−A
(d,q)|h
d/(d,q)|m

(4.27)

= −

X

X



(d, q)m
d

χ0

d<x1−A

m≤x/(h,q)

(r,q/(d,q))=1
r|m



m
r

dk−1

dk−1





(h, q)m
d

(h, q)m
(d, q)r





where r = d/(d, q). Since (d, q)|h we have (d, q)|(h, q) so q/(h, q)|q/(d, q), therefore the
condition (r, q/(d, q)) = 1 may be replaced with (r, q/(h, q)) = 1 and so (4.27) is

−

X

m≤x/(h,q)

= −

X

X

χ0 (r) χ0

d<x1−A

m≤x/(h,q)

r|m

χ0 (m)

X

d<x1−A
r|m

m
r

dk−1

dk−1





(h, q)m
(d, q)r

(h, q)m
(d, q)r





ON ADDITIVE DIVISOR SUMS AND PARTIAL DIVISOR FUNCTIONS

X

= −

m≤x/(h,q)

d<x1−A
d/(d,q)|m
(d,q)|h

X

X

= −

χ0 (m)

m≤x/(h,q)

X

+

dk−1

(h, q)m
d



dk−1



(h, q)m
d



d/(d,q)|m
(d,q)|h

X

χ0 (m)

dk−1

x1−A ≤d≤x/(h,q)

m≤x/(h,q)

= −

X

χ0 (m)





(h, q)m
d





(h, q)m
d



21

d/(d,q)|m
(d,q)|h

X

χ0 (m) dk−1 ((h, q)m)

m≤x/(h,q)

(4.28)

X

+

X

χ0 (m)

dk−1

x1−A ≤d≤x/(h,q)

m≤x/(h,q)

,

d/(d,q)|m
(d,q)|h

where in the fourth line of (4.28) we have used the identity


X
(h, q)m
(4.29)
.
dk ((h, q)m) =
dk−1
d
d/(d,q)|m
(d,q)|h

Therefore, by (4.26) and (4.28), the main term in (4.22) is
=

(4.30)

1
φ (q/(h, q))

X

X

χ0 (m)

m≤x/(h,q)

dk−1

x1−A ≤d≤x/(h,q)
d/(d,q)|m
(d,q)|h



(h, q)m
d



and the error term is OA,ǫ,h,k (x logk−2 x/q). To evaluate the main term, we note that (4.30)
is




X
X
dm
(h, q)m
1
χ0
=
dk−1
φ (q/(h, q)) 1−A
(d, q)
(d, q)
x

=

1
φ (q/(h, q))

≤d≤x/(h,q) m≤(x/(h,q))/(d/(d,q))
(d,q)|h

X

x1−A ≤d≤x/(h,q)
(d,q)|h

χ0 (d)

X

n≤x/d
(h,q)|n

χ0



n
(h, q)



dk−1 (n)

22

J.C. ANDRADE AND K. SMITH

=



X
n
1
χ0
dk−1 (n)
φ (q/(h, q))
(h, q)
n≤x
(h,q)|n

X

χ0 (d),

x1−A ≤d≤x/(h,q)
d≤x/n

(4.31)
where the condition (d, q)|h is removed because χ0 (d) = 0 if (d, q) > 1. This is
X
X
1
χ0 (n) dk−1 ((h, q)n)
χ0 (d),
=
φ (q/(h, q))
A
1−A
n≤x

=

x

X
1
χ0 (n) dk−1 ((h, q)n)
φ (q/(h, q))
A
n≤x

=

X

x logk−2 x
q

χ0 (d) + OA,h,k

d≤x/n(h,q)

x X χ0 (n) dk−1 ((h, q)n)
+ OA,h,k
q
n
A
n≤x

(4.32)

≤d≤x/n(h,q)

x logk−2 x
q

!

!

.

Since (n/(h, q), q/(h, q)) = 1 is equivalent to (n, q) = (h, q) which implies that (n, q)|h, we
conclude that (4.22) is
!
x X (n, q)dk−1 (n)
x logk−2 x
(4.33)
.
+ OA,h,k
q
n
q
A
n≤x
(n,q)|h

By partial summation or otherwise, the remainder of the proof is trivial.



Proof of Theorem 2.2. This is a straightforward consequence of Theorem 2.1 and the method
of proof of Theorem 2.3. We have
X
X
X
dk (n + h, A)dl (n, B) =
dl−1 (q)
dk (n, A)
n≤x

q≤xB

= Ak−1

n≡h (mod q)
q 1/B ≤n≤x+h

X

dl−1 (q)

q≤xB

(4.34)

X

dk (n)

n≡h (mod q)
q 1/B ≤n≤x+h


X dl−1 (q)

+ OA,B,h,k x logk−2 x
q
B


q≤x

provided that B < min(θk , Aθk−1 ), by Theorem 2.1. The first term on the r.h.s. of (4.34)
is identical to (4.1), and the summation in the error term is O(logl−1 x).

4.3. Theorem 2.4.
Proof. We begin by establishing the analytic continuation of Dh,k,l (s, Q). We have

ON ADDITIVE DIVISOR SUMS AND PARTIAL DIVISOR FUNCTIONS

Dh,k,l (s, Q) =
=



∞ d (n + h)d n, Q
X
k
l
log n
1
∞
X
1

=

(n + h)s

dk (n + h) X
dl−1 (q)
(n + h)s
q≤Q
q|n

X

dl−1 (q)

X

dl−1 (q)

q≤Q

=

23

n≡h

q≤Q

n≡h

X

dk (n)
ns

X

dk (n) dk (h) X
−
dl−1 (q).
ns
hs

(mod q)
n>h

(mod q)

q≤Q

We have

n≡h

where

dk (n)
1
=  
s
n
φ gq
(mod q)

X

∞
X
χ(n)dk (gn)
1

(4.35)


χ mod

q
g

∞
YX

=

(gn)s

X

p

 X
∞
h
χ(n)dk (gn)
χ
g
(gn)s

1

dk (pβ+δ )χ(pβ )p−(β+δ)s

0

k

= L (s, χ)bk (s, χ, g)

is a meromorphic function of s for all h, k, l.
This shows that Dh,k,l (s, Q) is a meromorphic function of s for all h, k, l, Q, and we observe
that
(4.36)

Dh,k,l (s, Q) = ζ k (s)Zh,k,l (s, Q) + Bh,k,l (s, Q)

say, where Zh,k,l (s, Q) is defined in (4.4) and Bh,k,l (s, Q) is an analytic function of s for all
fixed h, k, l, Q. Writing
Dh,k,l (x, Q) =

X

dk (n + h)dl

n≤x



Q
n,
log n



,

we have
Dh,k,l (s, Q) = s

Z

1

and, by (4.36), we have

∞

Dh,k,l (x, Q)

dx
(x + h)s+1

24

J.C. ANDRADE AND K. SMITH

(4.37)

Dh,k,l (s, Q) =

Zh,k,l (s, Q)
+ Ch,k,l (s, Q)
(s − 1)k

for σ > 1, where Ch,k,l (s, Q) = Oh,k,l,Q((s − 1)1−k ) as s → 1. By (4.36) we know that
Dh,k,l (1 + it, Q) is continuous for t 6= 0 (in fact it is analytic in a neighbourhood of the
line). As such, the Delange-Ikehara Tauberian theorem [6] applies, i.e.
Dh,k,l (x, Q)
= Zh,k,l (1, Q).
x→∞ x log k−1 x
Arguing in the same way as in the proof of Theorem 2.3, we have
lim

Zh,k,l (1, Q)
Ck,l fk,l (h)
=
+ Oh,k,l
l−1
(k − 1)!(l − 1)!
log Q



1
log Q



.

Now, if limQ→∞ Dh,k,l (1 + it, Q) is continuous when t 6= 0, then the restriction that Q is
fixed in (4.37) can be removed and the Delange-Ikehara Tauberian theorem still applies.
Taking Q = x we have Dh,k,l (x, Q) = Dh,k,l (x), which completes the proof.

4.4. The coefficients in the case k = l = 2. We conclude this paper with a demonstration that Theorem 2.3 recovers Estermann’s asymptotic expansion for Dh,2,2 (x) precisely.
We take k = l = 2 in (4.20), so that
X

d2 (n + h)d2 (n, A) = x

1 X
1
X
An bh,2,2,m,n

m=0 n=0

n≤x

m!n!

logm+n x + x

m=0

2

(4.38)

1


X
aA,h,2,2,m logm x
+ OA,h x1−δ
m!

= Abh,2,2,1,1 x log x + (bh,2,2,1,0 + Abh,2,2,0,1 + aA,h,2,2,1 ) x log x


+ (bh,2,2,0,0 + aA,h,2,2,0 ) x + OA,h x1−δ .

Thus, putting A = 1/2 and using the symmetry of the divisors of n about n1/2 in (4.38),
we obtain

Dh,2,2 (x) = bh,2,2,1,1 x log2 x + 2bh,2,2,1,0 + bh,2,2,0,1 + 2a1/2,h,2,2,1 x log x



+ 2 bh,2,2,0,0 + a1/2,h,2,2,0 x + Oh x1−δ .
(4.39)

We now use Definitions 3.3 and 3.4 to calculate the coefficients in (4.39). We use Estermann’s [11] notation
X log d
X log2 d
′
′′
σ−1
(h) =
(4.40)
,
σ−1
(h) =
d
d
d|h

d|h

and
(4.41)

a′ = −

∞
X
µ(n) log n
2

n2

,

a′′ =

∞
X
µ(n) log2 n
2

n2

.

ON ADDITIVE DIVISOR SUMS AND PARTIAL DIVISOR FUNCTIONS

25

Firstly, for the coefficient of x log2 x we have
bh,2,2,1,1 = C2,2 (1, 0)fh,2,2 (1, 0) =

6
σ−1 (h).
π2

Secondly, for the coefficient of x log x, we have
2bh,2,2,1,0 + bh,2,2,0,1 + 2a1/2,h,2,2,1
= 2a1 (1)c0 (2)C2,2 (1, 0)fh,2,2 (1, 0) + 2a0 (1)c0 (2)

∂
C2,2 (1, w)fh,2,2 (1, w)
∂w

∂
+ a0 (1)c1 (2)C2,2 (1, 0)fh,2,2 (1, 0) + a0 (1)c0 (2) C2,2 (s, 0)fh,2,2 (s, 0)
∂s
− a0 (1)c0 (2)C2,2 (1, 0)fh,2,2 (1, 0)

w=0

s=0

∂
C2,2 (1, w)fh,2,2 (1, w)
∂w
w=0
∂
(2γ − 1)C2,2 (1, 0)fh,2,2 (1, 0) +
C2,2 (s, 0)fh,2,2 (s, 0)
∂s
s=0
C2,2 (1, 0)fh,2,2 (1, 0)
∂
12
C2,2 (1, w)fh,2,2 (1, w)
(2γ − 1)σ−1 (h) + 2
2
π
∂w
w=0
∂
C2,2 (s, 0)fh,2,2 (s, 0)
∂s
s=0


12
∂
∂
(2γ − 1) + 2
C2,2 (1, w)
+ C2,2 (s, 0)
σ−1 (h)
π2
∂w
∂s
w=0
s=0


∂
∂
6
fh,2,2 (1, w)
2
+ fh,2,2 (s, 0)
π2
∂w
∂s
w=0
s=0


12
24 ′
′
(2γ − 1) + 4a σ−1 (h) − 2 σ−1 (h).
π2
π

= 2γC2,2 (1, 0)fh,2,2 (1, 0) + 2
+
−
=
+
=
+
=

Lastly, for the coefficient of x we have
2bh,2,2,0,0 + 2a1/2,h,2,2,0

∂
fh,2,2 (s, 0)
∂s
s=1
∂
∂
fh,2,2 (1, w)
+ 2a0 (1)c1 (2)C2,2 (1, 0)
+ 2a1 (1)fh,2,2 (1, 0) C2,2 (s, 0)
∂s
∂w
s=1
w=0
∂
∂ ∂
+ 2c1 (2)fh,2,2 (1, 0)
C2,2 (1, w)
fh,2,2 (s, w)
+ 2C2,2 (1, 0)
∂w
∂s ∂w
w=0
w=0,s=1
= 2a1 (1)c1 (2)C2,2 (1, 0)fh,2,2 (1, 0) + 2a1 (1)C2,2 (1, 0)

+ 2

∂
C2,2 (s, w)
∂w

∂
fh,2,2 (s, w)
w=0 ∂s

+2
s=1

∂
C2,2 (s, w)
∂s

∂
fh,2,2 (s, w)
s=1 ∂w

w=0

26

J.C. ANDRADE AND K. SMITH

+ 2fh,2,2 (1, 0)

∂ ∂
C2,2 (s, w)
∂w ∂s

w=0,s=1

− c1 (2)C2,2 (1, 0)fh,2,2 (1, 0) − fh,2,2 (1, 0)

∂
C2,2 (s, 0)
∂s

− C2,2 (1, 0)
s=1

∂
fh,2,2 (s, 0)
∂s

s=1

+ C2,2 (1, 0)fh,2,2 (1, 0)
24γ ′
12
12γ
′
(2γ − 1)σ−1 (h) − 2 σ−1
(h) + 4γa′ σ−1 (h) − 2 (2γ − 1)σ−1
(h) + 2(2γ − 1)a′ σ−1 (h)
π2
π
π
24 ′′
6
12 ′
6
′
+
σ−1 (h) − 8a′ σ−1
(h) + 4a′′ σ−1 (h) − 2 (2γ − 1)σ−1 (h) + 2 σ−1
(h) − 2a′ σ−1 (h) + 2 σ−1 (h)
2
π
π
π
π



24
6
24
6
′′
′
(2γ − 1)2 + 2 + 4a′ (2γ − 1) + 4a′′ σ−1 (h) −
(2γ − 1) + 8a′ σ−1
(h).
(h) + 2 σ−1
=
π2
π
π2
π
=

Acknowledgment: We would like to thank Professor Aleksandar Ivić, Professor Steve
Gonek, Professor Zeev Rudnick and Professor Terence Tao for their suggestions on a previous version of this paper. The first author is also grateful to the Leverhulme Trust (RPG2017-320) for the support through the research project grant “Moments of L-functions in
Function Fields and Random Matrix Theory”. The second author is grateful for a PhD
studentship supported by the College of Engineering, Mathematics and Physical Sciences
at the University of Exeter.

References
[1] S. Baier, T. D. Browning, G. Marasingha, L. Zhao, Averages of shifted convolutions of d3 (n), Proc.
Edinb. Math. Soc. (2) 55 (2012), no. 3, 551?576.
[2] G. Bareikis. On the DDT theorem, Acta Arith. 126 (2) 155–168 (2007).
[3] A. Bykovski, A. I. Vinogradov. Inhomogeneous convolutions Zap. Nauchn. Sem. Leningrad. Otdel. Mat.
Inst. Steklov. (LOMI) 160 (1987), no. Anal. Teor. Chisel i Teor.Funktsii. 8, 16 30, 296; translation in
J. Soviet Math. 52 (1990), no. 3, 3004–3016.
[4] C. E. Chace. The divisor problem for arithmetic progressions with small modulus, Acta Arithmetica
61.1 (1992) 35–50.
[5] J.B. Conrey, S.M. Gonek. High moments of the Riemann zeta-function, Duke Math. J. 107 (2001),
577–604.
[6] H. Delange. Généralisation du théoréme de Ikehara, Ann. Sci. Ec. Norm. Sup,er., 71 (1954), 213–242.
[7] J.-M. Deshouilliers, F. Dress, G. Tenenbaum. Lois de répartition des diviseurs, 1, Acta Arith. 2, 147-51
(1979).
[8] J.-M. Deshouillers, H. Iwaniec. An additive divisor problem, J. London Math. Soc. 26 (1982), 1–14.
[9] S. Drappeau. Sums of Kloosterman sums in arithmetic progressions, and the error term in the dispersion method, arxiv.org/abs/1504.05549.
[10] W. Duke, J.B. Friedlander, and H. Iwaniec. A quadratic divisor problem, Invent. Math. 115 (1994), no.
2, 209–217.

ON ADDITIVE DIVISOR SUMS AND PARTIAL DIVISOR FUNCTIONS

27

[11] T. Estermann. Uber die Darstellung einer Zahl als Differenz von zwei Produkten, J. Reine Angew.
Math. 164 (1931), 173–182.
[12] É. Fouvry, E. Kowalski, P. Michel. On the exponent of distribution of the Ternary divisor function.
Mathematika, 61(1), 121–144 (2015).
[13] É. Fouvry and G. Tenenbaum. Sur la corrélation des fonctions de Piltz, Rev. Mat. Iberoamericana 1
(1985), no. 3, 43–54.
[14] J. B. Friedlander and H. Iwaniec. The divisor problem for arithmetic progressions, Acta Arith. 45
(1985), 273–277.
[15] D. A. Goldston and S. M. Gonek. Mean value theorems for long Dirichlet polynomials and tails of
Dirichlet series, Acta Arith. 84 (1998), 155–192.
[16] D.R. Heath-Brown. The fourth power moment of the Riemann zeta function, Proc. London Math. Soc.
(3) 38 (1979), no. 3, 385–422.
[17] D. R. Heath-Brown. The divisor function d3 (n) in arithmetic progressions, Acta Arith. 47(1) (1986)
29–56.
[18] K. Henriot. Nair-Tenenbaum bounds uniform with respect to the discriminant, Mathematical Proceedings of the Cambridge Philosophical Society (2012), 152(3), 405–424.
[19] C. Hooley. An asymptotic formula in the theory of numbers, Proc. London Math. Soc. (3), 7: 396–413,
(1957).
[20] A. Ingham. Some asymptotic formulae in the theory of numbers, J. London Math. Soc. 2 (1927),
202–208.
[21] A. Ivić. The general additive divisor problem and moments of the zeta-function, New trends in probability and statistics, Vol. 4 (Palanga, 1996), 69-89, VSP, Utrecht, 1997.
[22] A. Ivić. On the ternary additive divisor problem and the sixth moment of the zeta-function, Sieve
methods, exponential sums, and their applications in number theory (Cardiff, 1995), 205–243, London
Math. Soc. Lecture Note Ser., 237, Cambridge Univ. Press, Cambridge, 1997.
[23] N.V. Kuznetsov. Petersson’s conjecture for forms of weight zero and Linnik’s conjecture, Sums of
Kloosterman sums, Mathematics of the USSR-Sbornik 39(3), (1981).
[24] A. F. Lavrik. On the principal term in the divisor problem and the power series of the Riemann zetafunction in a neighborhood of its pole, English transl. in Proc. Steklov Inst. Math. 1979, no. 3, 175–183.
[25] Y. Linnik. The dispersion method in binary additive problems, American Math. Soc., Providence, Rhode
Island (1963).
[26] K. Matomäki, M. Radziwill, T. Tao. Correlations of the von Mangoldt and higher divisor functions I.
Long shift ranges, arXiv:1707.01315 (2017).
[27] Y. Motohashi. On some additive divisor problems, J. Math. Soc. Japan 28 (1976), 772–784.
[28] Y. Motohashi. The binary additive divisor problem, Ann. Sci École Norm. Sup. (4)27 (1994) 529–572.
[29] M. Nair, G. Tenenbaum. Short sums of certain arithmetic functions, Acta Math. 180 (1998), no. 1,
119–144.
[30] N. Ng, M. Thom. Bounds and conjectures for additive divisor sums, arXiv:1609.01411v1 (2016).
[31] T. Tao. Heuristic computation of correlations of higher order divisor functions, https: //terrytao.wordpress.com (2016).
[32] G. Tenenbaum. Lois de répartation des diviseurs, 4, Ann. Inst. Fourier 29, 1–15 (1979).
[33] G. Tenenbaum. Lois de répartition des diviseurs, 2, Acta Arith. 38, 1-36 (1980).
[34] B. Topacogullari. Shifted convolution of divisor sums, arxiv.org/abs/1506.02608 (2015).
[35] B. Topacogullari. On a certain additive divisor sum, arxiv.org/abs/1512.05770 (2015).
[36] B.
Topacogullari.
The
shifted
convolution
of
generalized
divisor
functions,
http://arxiv.org/abs/1605.02364 (2016).
[37] E.C. Titchmarsh. The theory of the Riemann zeta-function, 2nd ed. Oxford Univ. Press, New York,
(1986).
[38] A. Weil. On some exponential sums, Proc. Nat. Acad. Sci. U. S. A. 34 (1948), 204–207.

28

J.C. ANDRADE AND K. SMITH

Department of Mathematics, University of Exeter, Exeter, EX4 4QF, UK
E-mail address: j.c.andrade@exeter.ac.uk
E-mail address: ks614@exeter.ac.uk

