arXiv:1905.00506v3 [math.NT] 21 Jan 2020

AN EQUIVARIANT ISOMORPHISM THEOREM FOR MOD p
REDUCTIONS OF ARBOREAL GALOIS REPRESENTATIONS
ANDREA FERRAGUTI AND GIACOMO MICHELI
Abstract. Let φ be a quadratic, monic polynomial with coefficients in OF,D [t],
where OF,D is a localization of a number ring OF . In this paper, we first prove
that if φ is non-square and non-isotrivial, then there exists an absolute, effective
constant Nφ with the following property: for all primes p ⊆ OF,D such that
the reduced polynomial φp ∈ (OF,D /p)[t][x] is non-square and non-isotrivial, the
squarefree Zsigmondy set of φp is bounded by Nφ . Using this result, we prove
that if φ is non-isotrivial and geometrically stable then outside a finite, effective
set of primes of OF,D the geometric part of the arboreal representation of φp
is isomorphic to that of φ. As an application of our results we prove R. Jones’
conjecture on the arboreal Galois representation attached to the polynomial x2 +t.

1. Introduction
Let k be a field, let t be transcendental over k and let φ ∈ k(t)(x) be a rational
function of degree d. Suppose that φ(n) is separable for every n, where φ(n) is the
n-th iterate. We fix separable closures ksep of k and k(t)sep of k(t), and we let
Gk(t) := Gal(k(t)sep /k(t)). One can associate to φ an infinite, regular, d-ary tree
T∞ (φ) rooted in 0: the nodes at distance n from the root are labeled by the roots
of φ(n) and a node α at level n + 1 is connected to a node β at level n if and only if
φ(α) = β. An automorphism of T∞ (φ) is a bijection σ of the set of nodes such that
α is connected to β if and only if σ(α) is connected to σ(β); the full automorphism
group Aut(T∞ (φ)) coincides with limn Aut(Tn (φ)), where Tn (φ) is the set of nodes
←−
at distance ≤ n from the root. It follows that Aut(T∞ (φ)) carries a natural profinite
topology.
The group Gk(t) acts on T∞ (φ) through tree automorphisms; the corresponding
continuous group homomorphism ρφ : Gk(t) → Aut(T∞ (φ)) is called the arboreal
Galois representation attached to φ. The study of such maps over various ground
fields is a central topic in modern arithmetic dynamics, as witnessed by the many
papers on the topic such as [3, 4, 8, 9, 10, 11, 12, 13, 15, 17]. In particular, in the
setting described above the coefficients of φ belong to the rational function field over
k, and it is therefore important to distinguish the image of ρφ from its geometric
2010 Mathematics Subject Classification. Primary: 37P05, 37P15; Secondary: 11G05, 20E08.
Key words and phrases. Arithmetic dynamics, arboreal Galois representations, Zsigmondy set.
The first author is grateful to the Max Planck Institute for Mathematics in Bonn for its hospitality
and financial support. The second author was supported by the Swiss National Science Foundation
grant number 171249. The first author would also like to thank the EPFL, where most of the ideas
of this paper have been generated, for the hospitality and financial support.
1

2

A. FERRAGUTI AND G. MICHELI

part, as explained below. Boston and Jones [4] and Hindes [10] studied in detail
some of the features of this framework.
Definition 1.1. Let k and φ be as above.
(1) The geometric part of ρφ is the image of the subgroup Gal(k(t)sep /ksep (t)) ⊆
Gk(t) via ρφ . We denote it by Ggeo
∞ (φ), and it is identified, via ρφ , with
(n)
sep
limn Gal(φ /k (t)).
←−
(2) We say that ρφ has geometrically finite index if [Aut(T∞ (φ)) : Ggeo
∞ (φ)] <
∞. In particular, we say that ρφ is geometrically surjective if Ggeo
∞ (φ) =
Aut(T∞ (φ)).
In this paper, we will focus on monic, quadratic polynomials φ = (x − γ)2 − c
with coefficients γ, c in the polynomial ring k[t], where k is a field of characteristic
different from 2. The arithmetic of the arboreal representations attached to such
polynomials is deeply related to that of their adjusted post-critical orbit, which is
the sequence defined by: c1 = −φ(γ), cn = φ(n) (γ) for n ≥ 2. In particular, linear
2
dependence relations among the cn ’s in the F2 -vector space k(t)× /k(t)× are of
crucial importance, as shown for example in [10, 17, 23]. For this reason, one is
interested in studying primitive prime divisors for cn , namely irreducible elements
g ∈ k[t] such that g | cn and g ∤ ci for every i < n such that ci 6= 0. We call a
primitive prime divisor squarefree if, in addition, vg (cn ) ≡ 1 mod 2. The Zsigmondy
set of φ is the set Z(φ) := {n ∈ N : cn has no primitive prime divisors}, see for
example [11, 21] for more on the topic.
Definition 1.2. The squarefree Zsigmondy set of φ is defined by:
Zs (φ) := {n ∈ N : cn has no squarefree primitive prime divisors}.
Notice that if φ ∈ k[t][x], then Zs (φ) = Zsgeo (φ), where Zsgeo (φ) is the squarefree
Zsigmondy set of φ ∈ ksep [t][x]. For this reason, there is no ambiguity when talking
about the Zsigmondy set of a quadratic polynomial in k[t][x], when seen as an
element of the bigger ring ksep [t][x].
From now on, we let F be a number field with number ring OF . Let D be a
finite set of primes of OF containing all primes dividing 2, and denote by OF,D the
localization of OF at D (i.e. we allow denominators which belong to some p ∈ D).
Let φ = (x − γ)2 − c1 , where γ, c1 ∈ OF,D [t]. For every p ∈
/ D the reduction φp of φ
modulo p yields a monic quadratic polynomial in Fp [t][x], where Fp = OF /p. Recall
that a polynomial φ = (x−γ)2 −c1 ∈ k[t][x] is called isotrivial if there exists m ∈ k[t]
such that φ(x − m) + m ∈ k[x]. Equivalently, φ is isotrivial if deg(γ + c1 ) = 0.
In [15, Conjecture 6.7] Jones conjectured that the arboreal Galois representation
of x2 + t ∈ k[t][x] is surjective for any field k of characteristic different from 2. When
k has characteristic 0 or 3 modulo 4, this conjecture was proven by Jones in [14,
Section 3.5] by adapting an argument of Stoll [23, §2] that was used by the author to
show that the arboreal Galois representation attached to certain polynomials of the
form x2 + a, with a ∈ Z, is surjective. However, this is a highly “ad hoc” argument,
and it fails in a fundamental way when the characteristic is 1 modulo 4.

EQUIVARIANT ISOMORPHISMS FOR ARBOREAL GALOIS REPRESENTATIONS

3

In this paper we show that the aforementioned conjecture is an instance of a
much more general fact, of arithmetic and geometric nature, concerning the squarefree Zsigmondy set attached to a quadratic polynomial φ ∈ OF,D [t][x] satisfying
suitable hypotheses. More specifically, we will show how it is possible to compare
the geometric part of the arboreal Galois representation attached to φ and the geometric part of the arboreal Galois representation attached to the reduced polynomial
φp . This can be viewed as an instance of “arithmetic specialization” of the representation. The key idea is to provide, given a non-isotrivial, non-square φ, a uniform
and effective bound on the squarefree Zsigmondy set of φp , for all but finitely many
p’s. This will allow to show that the geometric part of the arboreal representation
attached to φ does not change (in a suitable sense, cf. Definition 1.4) after reducing
φ modulo p, for all primes outside an effective, finite set. In turn, an application of
our results yields a complete proof of Jones’ conjecture (cf. Theorem 4.1).
The first main result of the paper is the following theorem.
Theorem 1.3. Suppose that φ = (x − γ)2 − c1 ∈ OF,D [t][x] is not isotrivial and
c1 6= 0. Then there exists an effective constant Nφ ∈ N with the following property:
let p be a prime of OF,D such that φp ∈ Fp [t][x] is not isotrivial and c1 6≡ 0 mod p,
and suppose that n ∈ Zs (φp ). Then n ≤ Nφ .
One of the key ingredients of the proof is the notion of dynamical inseparability
degree of a quadratic polynomial in positive characteristic (which we introduce with
Definition 2.4) that allows to transfer methods for height bounds in characteristic
zero to positive characteristic via a version of the ABC theorem for function fields.
The dynamical inseparability degree of a non-isotrivial quadratic map is a way of
measuring the degeneracy of the problem in positive characteristic by a non-negative
integer, which is then used in the height bounds.
The constant Nφ mentioned in Theorem 1.3 can be easily made completely explicit: it just depends on the reduction of φ modulo a finite, effectively computable
set of primes of OF,D . Notice that if φ is not isotrivial and c1 6= 0, then φp is not
isotrivial and c1 6≡ 0 mod p for all but finitely many primes p. Finally, observe that
the hypotheses of Theorem 1.3 are sharp: if φ is isotrivial then it is post-critically
finite modulo p for every p, and therefore Zs (φp ) is infinite. If c1 = 0, then φp is a
square for every p, and Zs (φp ) = N.
Next, we will use Theorem 1.3 in order to compare the geometric part of the
arboreal representation attached to φ and the geometric part of the representation
attached to the reduced polynomial φp . In doing so, we must take care of the
following subtlety: the tree T∞ (φ) on which Ggeo
∞ (φ) acts and the tree T∞ (φp ) on
geo
which G∞ (φp ) acts are isomorphic as trees, but they are not the same object.
Therefore, in order to compare the two representations one needs to choose an
identification between the trees. This motivates the following definition.
′ be infinite, regular, rooted d-ary trees.
Definition 1.4. Let d ∈ N and let T∞ , T∞
′
Let n ∈ N ∪ {∞} and let Tn , Tn be the trees truncated at level n. Let G, G′ be
topological groups acting continuously on Tn , Tn′ , respectively. An equivariant isomorphism (G, Tn ) → (G′ , Tn′ ) is a pair (ϕ, ι), where ϕ : G → G′ is an isomorphism of
topological groups and ι : Tn → Tn′ is a tree isomorphism such that for every g ∈ G

4

A. FERRAGUTI AND G. MICHELI

and every t ∈ Tn one has ι(g t) = ϕ(g) ι(t). If there exists an equivariant isomorphism
between the two pairs, we write (G, Tn ) ∼
=eq (G′ , Tn′ ).
Definition 1.4 aims to encapture the structure of the tree as a G-set. For example,
the group C2 × C2 can act on the binary tree truncated at level 2 in two different
ways: transitively or non-transitively. Of course in our analysis we want to consider
these as two distinct objects.
We will make use of Theorem 1.3 to prove the following result. Recall that
φ ∈ k[t][x] is called geometrically stable if φ(n) is irreducible in ksep [t][x] for every n.
Theorem 1.5. Let φ ∈ OF,D [t][x] be a quadratic, monic, geometrically stable and
non-isotrivial polynomial. Then there exists a finite, effective set Sφ of primes of
geo
∼
OF,D such that (Ggeo
/ Sφ .
∞ (φp ), T∞ (φp )) =eq (G∞ (φ), T∞ (φ)) if and only if p ∈
Moreover, the arboreal representation attached to a polynomial φ satisfying the
hypotheses of Theorem 1.5 has geometrically finite index, as shown in [10]. We will
re-obtain this result in the course of our proof.
Notice that non-isotriviality is a necessary condition for the statement of Theorem
1.5 to hold: if for example φ = (x−t)2 +t+1, it is immediate to check that ρφ is geometrically surjective (cf. Theorem 4.2); however, φp is post-critically finite for every
prime p, and therefore the geometric part of ρφp has infinite index in Aut(T∞ (φp ))
(see [17, Theorem 3.1]). Moreover, it is crucial to consider the geometric part, and
not the whole image of the representation. In fact, for instance one can show that
φ = (x + t)2 + 1 ∈ Z[t][x] has surjective arboreal representation, but ρφp is certainly
not surjective for every p ≡ 1 mod 4.
Finally, we will show how to use Theorem 1.5 to prove the following theorem,
which resolves [15, Conjecture 6.7].
Theorem 1.6. Let k be a field of characteristic 6= 2, and let t be transcendental over
k. Then the polynomial φ = x2 + t ∈ k(t)[x] has surjective arboreal representation.
As explained in [15, Section 6], Theorem 1.6 has deep consequences in the study
of the arithmetic of the map x2 + c with c ∈ Fp , which is related to the p-adic
Mandelbrot set.
Here is a brief outline of the paper: in Section 2 we will prove Theorem 1.3, by
providing (cf. Theorems 2.6 and 2.8) a suitable completely effective height bound for
certain integral points on elliptic curves over function fields in positive characteristic
associated to quadratic polynomials. In Section 3 we will prove Theorem 1.5, using
Theorem 1.3 and the relation between the squarefree Zsigmondy set and the image
of an arboreal Galois representation (cf. Corollary 3.4). Finally, in Section 4 we will
prove Theorem 1.6.
Notation and conventions. When K/Fp (t) is a finite extension, we will denote
by MK a complete set of valuations of K. All valuations in MK are normalized,
and all residue fields have degree 1, since the base field is algebraically closed. We
0 the set of finite valuations, i.e. the set of valuations of K not
will denote by MK
∞ the set of infinite valuations,
extending the infinite valuation of Fp (t), and by MK
0 ⊔ M ∞.
so that MK = MK
K

EQUIVARIANT ISOMORPHISMS FOR ARBOREAL GALOIS REPRESENTATIONS

5

For an element f ∈ K, the logarithmic height of f , with respect to K, is defined
by:
X
hK (f ) =
max{v(f ), 0}.
v∈MK

When K = Fp (t), we will omit K from the notation for height, i.e. we will write
h(f ) for hFp (t) (f ).
If f ∈ Fp [t], the degree of f coincides with h(f ). We denote by rad f the radical
of f , namely the product of its distinct irreducible factors.
If L/K is a finite, separable field extension, we will denote by NL/K : L× → K ×
the norm map.
If G is a group acting on a set S, the action of σ ∈ G on x ∈ S will be denote in
the upper left corner, as in σ x.
In the rest of the paper whenever we take a square root of an element r we are
implicitly chosing one of the roots r1 and −r1 of x2 − r. Whenever we do that, such
choice is fixed for the rest of the paper.
2. Bounding Zs (φp )
The goal of this section is to prove Theorem 1.3. We will start with some auxiliary
lemmas. Throughout the whole section, p will be an odd prime and Fp will be a
fixed algebraic closure of Fp .
Lemma 2.1 (ABC in positive characteristic). Let K/Fp (t) be a finite, separable
extension, and let γ1 , γ2 , γ3 ∈ K be non-zero elements such that γ1 + γ2 + γ3 = 0.
Let V ⊂ MK be a finite set such that v(γ1 ) = v(γ2 ) = v(γ3 ) for all v ∈
/ V and let g
e+1
e
for some e ≥ 0. Then:
be the genus of K. Suppose γ2 /γ3 ∈ K p \ K p
e

hK (γ2 /γ3 ) ≤ pe (2g − 2 + |V |).

e

Proof. Let γ2 /γ3 = f p , for some f ∈ K \ K p . Then γ1 /γ3 = (−f − 1)p . Now apply
[20, Lemma 10] to the triple (−f − 1, f, 1): this yields hK (f ) ≤ 2g − 2 + |V |. It is
immediate to conclude by noticing that hK (γ2 /γ3 ) = pe hK (f ).

From now on, we let γ, c1 ∈ Fp [t] and φ = (x − γ)2 − c1 ∈ Fp [t][x]. We assume
throughout the section that c1 6= 0 and deg(γ + c1 ) > 0, so that φ is non-square and
non-isotrivial. Let {cn }n≥1 be the adjusted post-critical orbit of φ. Following [10],
we let h(φ) := max{h(γ), h(c1 )}.
Lemma 2.2 ([10, Lemma 2]). The following height bounds hold.
(1) Suppose that h(γ) 6= h(c1 ). Then:
a) h(cn ) = 2n−1 · h(φ) for all n ≥ 2, and h(c1 ) ≤ h(φ);
b) h(φ(n) (0)) ≤ 2n · h(φ) for all n ≥ 1.


h(γ)
+ 1. Then:
(2) Suppose that h(γ) = h(c1 ) and let κφ := log2 h(γ+c
1)
a) h(cn ) ≤ h(γ) for all n ≤ κφ ;
b) h(cn ) = 2n−1 · h(γ + c1 ) for all n > κφ ;
c) h(φ(n) (0)) = 2n h(γ) for all n ≥ 1.

6

A. FERRAGUTI AND G. MICHELI

The following lemma shows that for a large enough n and a fixed D ∈ Fp [t], the
polynomial cn − D cannot be a square.
Lemma 2.3. Let D ∈ Fp [t] be such that c1 + D 6= 0 and let n ∈ N be such that
h(γ + c1 ) · 2n−2 > h(c1 + D). Then cn − D is not a square in Fp (t).
Proof. Suppose by contradiction that cn − D is a square. Then for some g ∈ Fp [t]
we have
(cn−1 − γ)2 − c1 − D = g2 ,
yielding:
(cn−1 − γ − g)(cn−1 − γ + g) = c1 + D.
If we can show that h(cn−1 − γ) > h(c1 + D) we are done, as the leading coefficient
of cn−1 − γ cannot be deleted by the leading coefficient of g both with + and − (and
also none of the two factors can obviously be zero, as c1 + D 6= 0). Observe now
that cn−1 − γ can be seen as the evaluation of the polynomial
F := (· · · (Y 2 + Y )2 + Y )2 + Y )...)2 + Y ∈ Fp [Y ]
at −c1 − γ. So h(cn−1 − γ) = h(F (−c1 − γ)) = h(γ + c1 )2n−2 . But this is greater
than h(c1 + D) by assumption, so we are done.

In order to state and prove the key result, we need to introduce the following
definition.
Definition 2.4. The dynamical inseparability degree of φ is the non-negative integer
e defined in the following way:

pi
if c1 ∈
/ Fp [t]2

max{i ∈ N : c2 /c1 ∈√Fp (t) } i
√
γ
γ
/ Fp .
e := max{i ∈ N : √c1 + c1 ∈ Fp (t)p } if c1 ∈ Fp [t]2 and √c1 + c1 ∈

√
i

γ
p
2
if c1 ∈ Fp [t] and √c1 + c1 ∈ Fp
max{i ∈ N : c1 ∈ Fp (t) }

Notice that the dynamical inseparability degree is well-defined: if c1 is not a
√
square, then c2 /c1 cannot be constant. If c1 is a square and √γc1 + c1 is constant,
then c1 cannot be constant because otherwise φ would be isotrivial. Notice also that
the definition does not depend on the choice of a square root of c1 .
Definition 2.4 and Lemmas 2.5 and 2.7 constitute the technical heart of the argument in this paper. In fact, they allow to transfer a technique to obtain height
bounds for integral points on hyperelliptic curves in characteristic zero due to Baker
[2] and Mason [19] to heights bounds for elements in the adjusted post-critical orbit
of φ in positive characteristic. This will be described in Theorems 2.6 and 2.8.
√
Now we need to distinguish two cases, according to whether γ + c1 ± c1 = 0
or not. Although the arguments in the two cases are essentially the same, certain
crucial elements constructed starting from φ are different. Hence, in order not to
confuse the reader, we will split the two cases in two different subsections.

EQUIVARIANT ISOMORPHISMS FOR ARBOREAL GALOIS REPRESENTATIONS

7

√
2.1. The case γ + c1 ± c1 6= 0. Let φ = (x − γ)2 − c1 ∈ Fp [t] be non-isotrivial,
√
with c1 6= 0 and such that γ + c1 ± c1 6= 0. Let us fix n ≥ 2 and define the following
quantities, which we will use in the rest of the subsection:
√
√
√
(1) α1 := γ − c1 , α2 := γ + c1 , α3 := −c1 , ξi := cn−1 − αi for i ∈ {1, 2, 3},
(2)

β1 = ξ2 − ξ3 ,

β2 = ξ3 − ξ1 ,

β3 = ξ1 − ξ2 ,

βb1 = ξ2 + ξ3 ,

βb2 = ξ3 + ξ1 ,

βb3 = ξ1 + ξ2 .

and
(3)

Notice that αi 6= αj whenever i 6= j and that consequently βi , βbi 6= 0 for every
√
i ∈ {1, 2, 3}. Notice also that by construction, ξ3 = cn−1 + c1 = cn−2 − γ ∈ Fp [t].
Finally, let K := Fp (t, α1 , α2 , α3 ) = Fp (t, α1 ) and Ln := K(ξ1 , ξ2 , ξ3 ) = K(ξ1 , ξ2 ).
(
)
b
b
β
β
β
β
2
2
2
2
, , ,
Lemma 2.5. Let n ≥ 3 be such that h(γ+c1 )2n−3 > h(φ). Let y ∈
,
β3 β3 βb3 βb3
i

let e be the dynamical inseparability degree of φ and assume that y ∈ Lpn for some
i ∈ N. Then i ≤ e.

Proof. First of all, notice that:
β1 βb1 = α3 − α2 ,

β2 βb2 = α1 − α3 ,

β3 βb3 = α2 − α1 .

This immediately shows that, since [Ln : K] = 2k for some k ∈ N, then:

!  1  c 2k
 k 2
b
if c1 ∈
/ Fp [t]2
β2 β2
c
2
.
= 4  1
(4)
NLn /Fp (t)
k

2

β3 βb3
2
 1k √γ + √c1 − 1
if
c
∈
F
[t]
1
p
2
c1
2

Next, we claim that:
 
β2
(5)
NLn /Fp (t)
= NLn /Fp (t)
β3

βb2
β3

!

= NLn /Fp (t)



β2
βb3



= NLn /Fp (t)

βb2
βb3

!

.

Relations (4) and (5) immediately prove that if c1 ∈
/ Fp [t]2 or c1 ∈ Fp [t]2 but
√
γ
√ + c1 is not constant, then the statement of the lemma holds true.
c1
We will prove (5) by examining separately the cases c1 ∈ Fp [t]2 (i.e. K = Fp (t))
and c1 ∈
/ Fp [t]2 (i.e. [K : Fp (t)] = 2).
√
Case 1): c1 ∈
/ Fp [t]2 . We prove first that ξ1 , ξ2 ∈
/ K = Fp (t, c1 ). In fact,
suppose by contradiction that ξi ∈ K, where i ∈ {1, 2}. Then ξ12 = v 2 and ξ22 = σ v 2
for some v ∈ K, where σ is the generator of Gal(K/Fp (t)). It follows that (v σ v)2 =
(cn−1 − γ)2 − c1 = cn , which implies in particular that cn ∈ Fp [t]2 . By Lemma 2.3,
this cannot happen. We now have to distinguish two subcases.
Subcase 1a): ξ1 ∈
/ K(ξ2 ). In this case, Ln /K is a Galois extension with Galois
group C2 × C2 . It follows immediately that there exists τ in Gal(Ln /K) such that
τ ξ = −ξ and τ ξ = ξ . Therefore, τ β = β
b2 and τ β3 = −βb3 , proving (5).
1
1
2
2
2

8

A. FERRAGUTI AND G. MICHELI

Subcase 1b): ξ1 ∈ K(ξ2 ). Suppose (ξ1 · ξ2 )2 = u2 for some u ∈ K. Writing
√
u = A + B c1 for some A, B ∈ Fp (t), one sees immediately, again by Lemma 2.3,
that A = 0 must hold, so that (ξ1 · ξ2 )2 = cn = B 2 · c1 . It is then a well-known
Galois theoretic fact that Ln /Fp (t) is a Galois extension with cyclic Galois group of
order 4. Since ξ1 generates Ln over Fp (t), then there exists a generator ν of such
group with the property that ν ξ1 = ξ2 while ν ξ2 = −ξ1 . It follows immediately that
ν 2 ξ = −ξ , and hence ν β = β
b3 and ν 2 β2 = βb2 , proving (5) again.
1
1
3
Case 2): c1 ∈ Fp [t]2 . Notice that if ξi ∈ K for some i ∈ {1, 2}, then cn−1 − αi ∈
K 2 , which is impossible by Lemma 2.3. Moreover, if ξ1 ξ2 ∈ K then cn = ξ12 ξ22 ∈
K 2 , which is impossible by Lemma 2.3 again. Hence, Ln /K is Galois with Galois
group C2 × C2 . It is immediate to see that β2 /β3 , βb2 /β3 , β2 /βb3 , βb2 /βb3 are all Galois
conjugates up to sign, and (5) follows.
√
It only remains to prove the lemma in the case where c1 ∈ Fp [t]2 and √γc1 + c1
√
×
is a non-zero constant. This forces γ = −c1 − u c1 for some u ∈ Fp . Since,
as we showed in Case 2), β2 /β3 , βb2 /β3 , β2 /βb3 , βb2 /βb3 are all Galois conjugate up to
i
sign, it is enough to assume y = β2 /β3 . By hypothesis, y ∈ Lpn for some i. Write
i
β2 /β3 = (A + Bξ1 + Cξ2 + Dξ1 ξ2 )p for some A, B, C, D ∈ Fp (t). Then:
−ξ12 + (cn−2 − γ)ξ1 + (cn−2 − γ)ξ2 − ξ1 ξ2
β2 βb3
β2
.
=
=
√
β3
2 c1
β3 βb3

Simple algebraic manipulations, together with the fact that {1, ξ1 , ξ2 , ξ1 ξ2 } is a Ki
basis of Ln , show that one must have (D 2 cn )p = cn /(4c1 ), implying that cn /c1 ∈
√
√
i
Fp (t)p . An easy induction shows that for n ≥ 3, cn /c1 = c1 · ( c1 · gn + 2u3 ) +
u2 − 1 for some gn ∈ Fp [t]. Now observe that cn /c1 is a pi -th power if and only if
√
√
cn /c1 − (u2 − 1) is, and that c1 is coprime with c1 · gn + 2u3 . This forces c1 to
i
lie in Fp (t)p , and therefore i ≤ e.

Motivated by an idea of Hindes, we will use height bounds to study the Zsigmondy
set of φ (see for example [10, 13]). From now on, for any n ≥ 1 we write cn = dn yn2 ,
where yn , dn ∈ Fp [t] and dn is squarefree. Let us define the following elliptic curve
over Fp (t):
!
3
Y
2
2
(x − αi ) .
Eφ : y = (x + c1 )((x − γ) − c1 )
=
√

i=1

The point (Xn , Yn ) := (cn−1 , dn yn (cn−2 − γ)) lies on Eφ .

Theorem 2.6. Let φ = (x − γ)2 − c1 ∈ Fp (t)[x] be non-isotrivial, non-square and
√
having dynamical inseparability degree e. Suppose that c1 + γ ± c1 6= 0 and let
n ≥ 3 be such that deg(γ + c1 )2n−3 > h(φ). Then we have:
h(cn−1 ) ≤ A · h(dn ) + B,

where
A = 8pe

and

B = 8pe (h(d1 ) + 4 + 4h(rad c1 ) + 4h(rad c2 )) + 4h(γ) + 8h(c1 ).

EQUIVARIANT ISOMORPHISMS FOR ARBOREAL GALOIS REPRESENTATIONS

9

Proof. Let αi , ξi , βi , βbi be as in equations (1), (2),
recall that K =
√ (3). Moreover, √
Fp (t, α1 ) and Ln = K(ξ1 , ξ2 ). Let Kn := K( dn ). Notice that dn ∈ Ln , and
therefore Kn ⊆ Ln . Set 2δ = [Ln : Kn ]. Define
2(2cn−1 − α1 − α3 )
.
α2 − α1
The idea of the proof is to start by observing the following identity:
X n :=

β2
βb22
+ 2 .
β3 βb3 β3 βb3
Now the fact that if a, b ∈ Ln then max{hLn (ab), hLn (a + b)} ≤ hLn (a) + hLn (b)
immediately shows that:
hL (X n ) ≤ hL (βb2 /β3 ) + hL (βb2 /βb3 ) + hL (β2 /β3 ) + hL (β2 /βb3 ).
Xn =

n

n

n

n

n

Since we have, by construction, that:
β1 + β2 + β3 = β1 + βb2 − βb3 = −βb1 + β2 + βb3 = βb1 − βb2 + β3 = 0,
setting V = MLn \ {v ∈ MLn : v(βi ) = v(βbi ) = 0 ∀i ∈ {1, 2, 3}} we obtain, by
Lemmas 2.1 and 2.5, that
(6)

2δ hKn (X n ) = hLn (X n ) ≤ 4pe (2gLn − 2 + |V |),

where gLn is the genus of Ln . Now the rest of the proof will consist of obtaining
suitable bounds on the terms of inequality (6).
We start by finding an upper bound on the right hand side of (6). In order to do
so, first let µ := (α3 − α2 )(α1 − α3 )(α2 − α1 ) ∈ Kn \ {0}. We claim that:

(7)

V ⊆ ML∞n ∪ {v ∈ ML0 n : v(µ) > 0}.

In fact, since the βi ’s and the βbj ’s lie in the integral closure of Fp [t] inside Ln ,
then for every v ∈ ML0 n we have v(βi ), v(βbj ) ≥ 0 for all i, j ∈ {1, 2, 3}. Thus if v ∈ V
is finite, we have v(βi ) > 0 or v(βbi ) > 0 for some i ∈ {1, 2, 3}. Now observe that
µ = β1 βb1 β2 βb2 β3 βb3 ; it follows that v(µ) > 0.
Therefore, if
∞
0
W := MK
∪ {w ∈ MK
: w(µ) > 0},
n
n
relation (7) immediately shows that:
(8)

|V | ≤ 2δ |W |.

Next, we are going to deal with the term 2gLn − 2 of (6). Since Ln /Kn is a Galois
extension, Hurwitz formula shows that:
X ev − 1
≤ 2δ (gKn − 2) + 2δ |R|,
(9)
2gLn − 2 = 2δ (2gKn − 2) + 2δ
ev
v∈MKn

where gKn is the genus of Kn , ev is the ramification index at v, and R is the set of
valuations of Kn that ramify in Ln . We now claim that R ⊆ W . To show that, let
0 be such that v(µ) = 0. We will show that v ∈
/ R. Notice that if v(µ) = 0
v ∈ MK
n
then there cannot be i, j ∈ {1, 2, 3} with i 6= j such that v(Xn − αi ), v(Xn − αj ) > 0,
as otherwise we would have v(αi − αj ) ≥ min{v(Xn − αi ), v(Xn − αj )} > 0, yielding

10

A. FERRAGUTI AND G. MICHELI

0 , because α , α belong
a contradiction (notice that v(αi − αj ) ≥ 0 for any v ∈ MK
i
j
n
to the integral closure of Fp [t] inside Kn ). Therefore, either v(Xn −αi ) = 0 for all i ∈
Q3
2
{1, 2, 3}, or v(Xn −αi ) = 2v(Yn ) for√exactly one
√i ∈ {1, 2, 3}, as Yn = i=1 (Xn −αi ).
Now simply recall that Ln = Kn ( Xn − α1 , Xn − α2 ): if v(Xn − αi ) is even for
all i ∈ {1, 2}, then v does not ramify in Ln (see for example [22, Proposition 3.7.3]).
The fact that R ⊆ W , together with (6), (8) and (9), shows that:

(10)

hKn (X n ) ≤ 4pe (2gKn − 2 + 2|W |).

The genus of K√n can be bounded in the following way: since Kn is the compositum
of K and Fp (t, dn ), one can use Castelnuovo’s Inequality (see [22, Theorem 3.11.3])
to get
2gKn − 2 ≤ 4gn + 4gK ,
√
where gn is the genus of Fp (t, dn ) and gK is the genus of K. On the other hand,
[22, Proposition 6.2.3] shows that gn ≤ h(d2n ) , and (10) becomes
hKn (X n ) ≤ 8pe (h(dn ) + 2gK + |W |).

To deal with the left hand side of the above inequality, just notice that by standard
properties of the height we have:
hKn (X n ) ≥ hKn (cn−1 ) − hKn (α1 + α3 ) − hKn (α2 − α1 ),
yielding:
(11)

hKn (cn−1 ) ≤ 8pe (h(dn ) + 2gK + |W |) + hKn (α1 + α3 ) + hKn (α2 − α1 ).

To conclude the proof, it is now enough to find explicit bounds on the terms of the
above inequality.
The genus of K is simply bounded by h(d2 1 ) , where d1 is the squarefree part of c1
(see [22, Proposition 6.2.3]).
√
Next, we have µ = −2 c1 · c2 , and therefore if w ∈ W is a finite valuation then
the valuation v of Fp (t) lying below w is such that v(c1 c2 ) > 0. Clearly there are
at most h(rad c1 ) + h(rad c2 ) finite valuations v of Fp (t) such that v(c1 c2 ) > 0, and
∞ | + 4h(rad c ) + 4h(rad c ) ≤ 4 + 4h(rad c ) + 4h(rad c ).
therefore |W | ≤ |MK
1
2
2
n
√
√ 1
Finally, notice that α2 − α1 = 2 c1 , and hence hK ( c1 ) ≤ h(c1 ), yielding
√
hKn (α2 − α1 ) ≤ 2h(c1 ). On the other hand α1 + α3 = γ − c1 − c1 , so that
hKn (α1 + α3 ) ≤ 4h(γ) + 6h(c1 ).

√
2.2. The case γ + c1 ± c1 = 0. When c1 ∈ Fp [t]2 is not constant and φ =
√ 2
(x + c1 ± c1 ) − c1 , the curve Eφ we used for proving Theorem 2.6 is singular and
the arguments used in the proof fail, because µ = (α3 − α2 )(α1 − α3 )(α2 − α1 ) = 0.
The goal of this subsection is to explain how to modify the curve and the arguments
in order to obtain, also in this case, a bound analogous to the one of Theorem 2.6.
√
From now on, fix η ∈ {±1} and let γ := −c1 − η c1 and φ = (x − γ)2 − c1 . Let
{cn } be the adjusted post-critical orbit of φ.
First, we need a version of Lemma 2.5. This time we let
q
q
√
√
√
√
α1 := −c1 − η c1 − −2 c1 , α2 := −c1 − η c1 + −2 c1 , α3 := −c1 ,

EQUIVARIANT ISOMORPHISMS FOR ARBOREAL GALOIS REPRESENTATIONS

11

√
and ξi := cn−2 − αi , for i ∈ {1, 2, 3}. Notice that ξ3 ∈ Fp [t] once again. The
fields K and Ln and the βj ’s are defined in the same way as above Lemma 2.5, so
√
in particular we will have K = Fp (t, α1 , α2 , α3 ) = Fp (t, 4 c1 ) and Ln = K(ξ1 , ξ2 ).
Notice that αi 6= αj whenever i 6= j. According to Definition 2.4, the dynamical
inseparability degree of φ in this case is given by:
i

e := max{i ∈ N : c1 ∈ Fp (t)p }.
(
)
i
β2 βb2 β2 βb2
Lemma 2.7. Let n ≥ 4 and let y ∈
, , ,
. If y ∈ Lpn , then i ≤ e.
β3 β3 βb3 βb3

Proof. One starts by computing:
f := NLn /Fp (t)

β2 βb2
β3 βb3

!


k
 − 1 √c1 − 1 2
8
4
2k
= 
1 √
 − √
4 c − 1
1
2
2 2

if

√

if

√

c1 ∈
/ Fp [t]2
c1 ∈ Fp [t]2

,

i

where 2k = [Ln : K]. Notice that f is not constant, and if f ∈ Fp (t)p then clearly
i ≤ e. Now the proof is essentially the same as that of Lemma 2.5, even slightly
easier since f cannot be constant. Therefore, in order to conclude it is sufficient to
show that:
!
!
 
 
β2
β2
βb2
βb2
= NLn /Fp (t)
= NLn /Fp (t)
,
NLn /Fp (t)
= NLn /Fp (t)
β3
β3
βb3
βb3

and this works precisely as in Lemma 2.5: one shows that Ln /K is either a C2 × C2 extension or a C2 -extension which is Galois over Fp (t) with Galois group C4 . This
implies once again that the elements we are looking at are all Galois conjugate up to
sign. Notice that given the particular shape of γ and the fact that c1 is not constant,
the hypothesis n ≥ 4 is enough to conclude.

√
Next, observe that φ = φ1 φ2 , where φ1 = x + c1 + 2η c1 and φ2 = x + c1 .
Notice that φ2 ◦ φ(n) is a square polynomial for every n. For every n ≥ 2 write
φ1 (cn−1 ) = dn yn2 , where dn , yn ∈ Fp [t] and dn is squarefree. It follows that:
cn = φ(cn−1 ) = φ1 (cn−1 )φ2 (cn−1 ) = dn zn2 for some zn ∈ Fp [t],

so that dn coincides withQthe squarefree part of cn .
Now define Eφ : y 2 = 3i=1 (x − αi ), which is again an elliptic curve. The point
p
(Xn , Yn ) := (cn−2 , dn yn (cn−3 − γ))

lies on Eφ .
The analogue of Theorem 2.6 is the following.
√
Theorem 2.8. Let φ = (x + c1 + η c1 )2 − c1 be non-isotrivial, having dynamical
√
inseparability degree e. Suppose that n ≥ 4 and let de1 be the squarefree part of c1 .
Then we have:
h(cn−2 ) ≤ A · h(dn ) + B,
where
√
A = 8pe and B = 8pe (h(de1 ) + 4 + 4h(rad(c1 )) + 4h(rad( c1 + 2))) + 10h(c1 ).

12

A. FERRAGUTI AND G. MICHELI

Proof. The proof follows verbatim the one of Theorem 2.6 up until equation (11),
with the sole difference that cn−1 is replaced by cn−2 . Of course, in the course of
the proof we have to use Lemma 2.7 instead of Lemma 2.5, obtaining nevertheless
the very same conclusion. Recall that inequality (11) now reads:
hKn (cn−2 ) ≤ 8pe (h(dn ) + 2gK + |W |) + hKn (α1 + α3 ) + hKn (α2 − α1 ),

where gK is the genus of K and W is the set of valuations w of Kn such that w is
infinite or w(µ) > 0, where µ = (α3 − α2 )(α1 − α3 )(α2 − α1 ).
The genus of K can be bounded again by [22, Proposition 6.2.3], yielding gK ≤
h(de1 )
2 .

√ √
√
Next, in this case µ = −2 −2 4 c1 (c1 +2 c1 ). Thus, if w ∈ W is a finite valuation
√
with w(µ) > 0, the valuation v of Fp (t) lying below µ is such that v( c1 (c1 +
√
√
2 c1 )) > 0. Clearly there are at most deg rad(c1 ) + deg rad( c1 + 2) such finite
√
valuations of Fp (t), and
that |W | ≤ 4 + 4 deg rad(c1 )p
+ 4 deg rad( c1 + 2).
pit follows
√
√
√
Finally, α2 − α1 = 2 −2 c1 and α1 + α3 = −2c1 − η c1 − −2 c1 . Notice that
√
hK ( 4 c1 ) ≤ h(c1 ), so that hKn (α2 − α1 ) ≤ 2h(c1 ) and hKn (α1 + α3 ) ≤ 8h(c1 ).

2.3. The proof of Theorem 1.3. Let us start by explaining how Theorems 2.6
and 2.8 yield a bound on the squarefree Zsigmondy set, adapting a beautiful trick
due to Hindes [10].
Corollary 2.9. There exists an effective constant N ∈ N, depending only on h(φ)
and pe , such that if n ∈ Zs (φ), then n ≤ N . In particular, if e = 0 then N does not
depend on p.
Proof. Write cn = dn yn2 , where dn , yn ∈ Fp [t] and dn is squarefree. Assume that
n ∈ Zs (φ). Then every irreducible factor of dn divides a non-zero cm for some
m < n. Let r be such an irreducible factor. If m > n/2, then r also divides
φ(n−m) (0), as the following computation shows:
φ(n−m) (0) ≡ φ(n−m) (φ(m) (γ)) ≡ φ(n) (γ) = cn ≡ 0 mod r.
Q
It follows that dn = i ri , where ri | cmi or ri | φ(mi ) (0) for some 1 ≤ mi ≤ ⌊n/2⌋
⌊n/2⌋
⌊n/2⌋
Y
Y
with cmi 6= 0. Therefore we necessarily have that dn divides
ci
φ(i) (0).
i=1
ci 6=0

In turn, we have the bound:
h(dn ) ≤

i=1
φ(i) (0)6=0

⌊n/2⌋

X

(h(ci ) + h(φ(i) (0))),

i=1

while clearly if γ = 0 then we have the better bound:
h(dn ) ≤

⌊n/2⌋

X

h(ci ).

i=1

Now just use Theorems 2.6 and 2.8, together with Lemma 2.2, to get an inequality
of the type 2n ≤ C2⌊n/2⌋ + D, for some constants C, D depending only on pe and

EQUIVARIANT ISOMORPHISMS FOR ARBOREAL GALOIS REPRESENTATIONS

13

on constants which can be upper bounded by a function of h(φ), and deduce the
claim.

Remark 2.10. Following the arguments in the proof of Corollary 2.9 and using
Lemma 2.2, one can make the constant N mentioned in Corollary 2.9 completely
explicit. We will compute it for the polynomial x2 + t in Section 4.
In general if, h(γ) 6= h(c1 ) then the bound on n found in Corollary 2.9 actually
depends only on pe . In fact, in this case Lemma 2.2 and Theorem 2.6 imply that if
n ≥ 3 then:
2n−2 h(φ) ≤ 8pe (h(dn )) + 8pe (4 + 13h(φ)) + 12h(φ),

and the arguments of Corollary 2.9 show that if n ∈ Zs (φ) then:
(12)

2n−2 ≤ 8pe (3 · 2⌊n/2⌋ − 3) + 136pe + 12.

Combined with the arguments in Section 3, this yields a version of [10, Theorem 1.1]
in positive characteristic. Notice how the bound on the index of the representation is
not absolute anymore, but depends on the dynamical inseparability degree of φ. In
particular, when e = 0 one gets from (12) that n ≤ 12. Since for any φ ∈ OF,D [t][x]
there exist infinitely many primes p such that φp has dynamical inseparability degree
0, observing that Zs (φ) ⊆ Zs (φp ) for every p one can deduce that if φ is non-isotrivial
and stable, then | log2 ([Aut(T∞ (φ)) : G∞ (φ)])| ≤ 212 − 13, improving [10, Theorem
1.1] in the case where the ground field is a number field.
Proof of Theorem 1.3. Let φ = (x − γ)2 − c1 ∈ OF,D [t][x] be non-isotrivial and with
c1 6= 0. Since φ is isotrivial if and only if h(c1 + γ) = 0, the set T of primes p
of OF,D such that φp ∈ Fp [t][x] is isotrivial or c1 ≡ 0 mod p is finite. Moreover, it
is clear from the definition that there exists a finite set S ⊇ T of primes of OF,D
such that for all primes p ∈
/ S, the dynamical inseparability degree of φp is zero
and h(φp ) = h(φ). It follows from Corollary 2.9 that there exists a constant N such
that, if p ∈
/ S, then max{n ∈ Zs (φp )} ≤ N . This leaves out the finitely many primes
q ∈ S \ T . For each of them, Corollary 2.9 yields a bound Nq on max{n ∈ Zs (φq )}.
Now clearly Nφ := max{N, Nq : q ∈ S \ T } is a bound on max{n ∈ Zs (φp )} for every
prime p ∈
/ T.

3. Reducing arboreal representations modulo primes
This section is dedicated to proving Theorem 1.5, using Theorem 1.3. In order to
do so, we first need to recall some preliminary results.
Let k be a field of characteristic 6= 2 and let φ ∈ k[t][x] be a monic, quadratic
polynomial. Assume that φ(n) is separable for every n. For every n ≥ 1, denote by
sep (t)); recall
Kn the splitting field of φ(n) over ksep (t). Let Ggeo
n (φ) := Gal(Kn /k
geo
geo
that G∞ (φ) = limn Gn (φ).
←−
It is easy to see that [Aut(T∞ (φ)) : Ggeo
∞ (φ)] < ∞ if and only if there exists N ∈ N
geo
such that for every n > N one has [Aut(Tn (φ)) : Ggeo
n (φ)] = [Aut(TN (φ)) : GN (φ)].
For every n ∈ N, we let Vn (φ) be the set of roots of φ(n) , i.e. the set of nodes of
T∞ (φ) at distance n from the root.
Finally, we denote by S2 the symmetric group on two symbols {1, 2}.

14

A. FERRAGUTI AND G. MICHELI

Lemma 3.1 ([16, Lemma 2.6]). For every n ≥ 1, let ∆n be the discriminant of φ(n) .
Then we have:
n+1
∆n = ±22
· ∆2n−1 · cn .
Lemma 3.2 ([16, Lemma 3.2]). Let n ∈ N be such that φ(n) is geometrically irreducible. Then the following three conditions are equivalent:
geo
i) [Aut(Tn+1 (φ)) : Ggeo
n+1 (φ)] = [Aut(Tn (φ)) : Gn (φ)];
geo
geo
ii) Gn+1 (φ) ∼
= Gn (φ) ≀ S2 ;
iii) cn+1 is not a square in Kn .
The wreath product mentioned in point ii) of Lemma
Q 3.2 is constructed in the
following way: since Ggeo
(φ)
acts
on
V
(φ),
it
acts
on
the
n
n
v∈Vn(φ) S2 by permuting

Q
indices. This induces a homomorphism f : Ggeo
n (φ) → Aut
v∈Vn (φ) S2 ; we have
Q
geo
geo
Gn (φ) ≀ S2 := Gn (φ) ⋉f v∈Vn (φ) S2 .

Remark 3.3. Notice that if n ≥ 1 is such that φ(n) is geometrically irreducible
and one of the three conditions of Lemma 3.2 holds, then φ(n+1) is geometrically
geo
∼
irreducible as well. In fact, if Ggeo
n (φ) acts transitively on Vn (φ), then Gn+1 (φ) =
geo
(n+1)
Gn (φ) ≀ S2 acts transitively on Vn+1 (φ), and hence φ
is geometrically irreducible.
Corollary 3.4. Let N ∈ N be such that φ(N ) is geometrically irreducible. Suppose
that max{n ∈ Zs (φ)} ≤ N . Then the following hold.
geo
(1) For every m > N , [Aut(Tm (φ)) : Ggeo
m (φ)] = [Aut(TN (φ)) : GN (φ)].
(2) Let k′ be a field and ψ ∈ k′ [t][x] be a monic, quadratic polynomial such that:
geo
∼
(a) (Ggeo
N (ψ), TN (ψ)) =eq (GN (φ), TN (φ));
geo
(b) for every m > N , [Aut(Tm (ψ)) : Ggeo
m (ψ)] = [Aut(TN (ψ)) : GN (ψ)].
geo
geo
Then (G∞ (ψ), T∞ (ψ)) ∼
=eq (G∞ (φ), T∞ (φ)).
Proof. (1) First, we claim that if n ∈ N is such that φ(n) is geometrically irreducible and n + 1 ∈
/ Zs (φ) (so that cn+1 has a primitive squarefree divisor) then
geo
[Aut(Tn+1 (φ)) : Ggeo
n+1 (φ)] = [Aut(Tn (φ)) : Gn (φ)]. By Lemma 3.2, to prove this it
is enough to show that cn+1 ∈
/ Kn2 . Suppose by contradiction that cn+1 ∈ Kn2 . Let
sep
f ∈ k [t] be a primitive, squarefree prime divisor of cn+1 , so that cn+1 = f 2r+1 · g,
where f, g ∈ ksep [t] are coprime and r ≥ 0. Since cn+1 ∈ Kn2 , in particular cn+1 is
a square in the integral closure R of ksep [t] in Kn . It follows that the ideal gener2es
1
ated by cn+1 equals p2e
1 · . . . · ps , where p1 , . . . , pr are pairwise distinct primes of
R and ei ≥ 1 for every i. On the other hand, since f 2r+1 and g are coprime, the
ideals they generate are coprime, and thus, up to rearranging the pi ’s, we can write
2es′
1
(f )2r+1 = (f 2r+1 ) = p2e
for some s′ ≤ s. This of course implies that
1 · . . . · ps′
the ideal generated by f is a square. But then f ramifies in R, and now we have
a contradiction: if f ramifies in R then f should divide the discriminant of φ(n) by
Lemma 3.1, but this cannot happen because f is a primitive divisor of cn+1 .
Now an easy induction using Remark 3.3 concludes the proof of part (1).
(2) In order to prove the claim, we will show that if for some n ∈ N the following
three conditions hold:

EQUIVARIANT ISOMORPHISMS FOR ARBOREAL GALOIS REPRESENTATIONS

15

• there exists an equivariant isomorphism

geo
(ϕn , ιn ) : (Ggeo
n (ψ), Tn (ψ)) → (Gn (φ), Tn (φ)),

∼ geo
• Ggeo
n+1 (ψ) = Gn (ψ) ≀ S2 ,
∼ geo
• Ggeo
n+1 (φ) = Gn (φ) ≀ S2 ,
then there exists an equivariant isomorphism

geo
(ϕn+1 , ιn+1 ) : (Ggeo
n+1 (ψ), Tn+1 (ψ)) → (Gn+1 (φ), Tn+1 (φ))

that extends (ϕn , ιn ). This fact, together with part (1), allows to construct inductively an equivariant isomorphism:
geo
(ϕ∞ , ι∞ ) : (Ggeo
∞ (ψ), T∞ (ψ)) → (G∞ (φ), T∞ (φ))

in the obvious way: if g = (g1 , . . . , gn , . . .) ∈ Ggeo
∞ (ψ) and v ∈ Vm (ψ) for some m ∈ N,
then (ϕ∞ , ι∞ )(g, v) = ((ϕ1 (g1 ), . . . , ϕn (gn ), . . .), ιm (v)), concluding the proof of part
(2).
geo
So let (ϕn , ιn ) : (Ggeo
n (ψ), Tn (ψ)) → (Gn (φ), Tn (φ)) be an equivariant isomor∼ geo
phism. Let (g, (εv )v∈Vn (ψ) ) be an element of Ggeo
n+1 (ψ) = Gn (ψ) ≀ S2 . Here g ∈
Ggeo
n (ψ), while εv ∈ S2 for every v ∈ Vn (ψ). Now define the following map:
geo
ϕn+1 : Ggeo
n+1 (ψ) → Gn+1 (φ)

(g, (εv )v∈Vn (ψ) ) 7→ (ϕn (g), (ει−1
)
);
n (w) w∈Vn (φ)

one readily checks that this is a group isomorphism extending ϕn . In order to
extend ιn , first notice that every element of Vn+1 (ψ) can be represented in a unique
way as a pair (v, sv ), where v ∈ Vn (ψ) and sv is a map {v} → {1, 2}. With this
h
notation, if h = (g, (εv )v∈Vn (ψ) ) ∈ Ggeo
n+1 (ψ) and (w, sw ) ∈ Vn+1 (ψ), then (w, sw ) =
g
( w, εg w ◦ sw ). Now define
ιn+1 : Vn+1 (ψ) → Vn+1 (φ)
(v, sv ) 7→ (ιn (v), tιn (v) ),

where tιn (v) is the composition of the maps sv and ι−1
n : {ιn (v)} → {v}. It is now just
a matter of checking that the pair (ϕn+1 , ιn+1 ) is an equivariant isomorphism. 
Lemma 3.5. Let f ∈ OF,D [t][x] and let G := Gal(f /F (t)). For every prime p of
OF,D let fp ∈ Fp [t][x] be the reduced polynomial, and let Gp := Gal(fp /Fp (t)). Let
Rf be the set of roots of f in F (t) and Rfp the set of roots of fp in Fp (t). Then
there exists a finite, effective set Tf of primes of OF,D with the following property:
/ Tf .
there exists an equivariant isomorphism (Gp , Rfp ) → (G, Rf ) if and only if p ∈
Proof. This is a well-known fact, let us sketch a proof for the sake of completeness.
Start by fixing a bijection ι : Rf → {1, . . . , n}. This realizes G as a subgroup
of the symmetric group Sn . If p is a prime of OF,D for which fp has n roots over
Fp (t) (and this happens for all primes but at most finitely many), then [6, Theorem 5.8.5] ensures the existence of a bijection ιp : Rfp → {1, . . . , n} that induces a
monomorphism ϕp : Gp ֒→ G with the property that (ι−1 ◦ ιp )(g α) = ϕp (g) (ι−1 ◦ ι)(α)
for every g ∈ Gp and every α ∈ Rfp . It remains to show that for all but finitely
many p, ϕp is an isomorphism. To see this, for every subgroup H ⊆ G ⊆ Sn write
a squarefree resolvent rf,H (y, X1 , . . . , Xn ) ∈ OF,D [y, X1 , . . . , Xn ] for the pair (f, H)

16

A. FERRAGUTI AND G. MICHELI

(possibly enlarging D by a finite set of primes of OF ). This is a polynomial with
the following properties:
• the coefficients of rf,H , when the latter is thought as a polynomial in y with
coefficients in OF,D [X1 , . . . , Xn ], are symmetric functions in the Xi ’s;
• if {α1 , . . . , αn } are the roots of f then the discriminant of rf,H (y, α1 , . . . , αn )
is a non-zero element of OF,D [t];
• the Galois group of f is contained in a conjugate of H in G if and only if
rf,H (y, α1 , . . . , αn ) has a root in F (t).
See [1, 5, 7] for more on the theory of resolvents. Note that since the coefficients of g
are symmetric functions in the Xi ’s, then the coefficients of rf,H (y, α1 , . . . , αn ) can
be written as polynomials in the coefficients of f . It is then clear that for all but
finitely many primes p the reduction of rf,H modulo p is a squarefree resolvent for the
pair (fp , H). Now, since of course G 6⊆ H for every proper subgroup H, this means
that the resolvent rf,H has no roots in F (t) for every H ( G. To conclude the proof,
it is then enough to invoke Bertini-Noether Theorem (see [18, Proposition 8.5.7]): a
polynomial in OF,D [t, x] that is irreducible in F [t, x] is irreducible in Fp [t, x] for all
but finitely many primes p. In our setting, this implies that for all but finitely many
p, the resolvent rfp ,H has no roots in Fp , and hence ϕp (Gp ) 6⊆ H for all H, i.e. ϕp is
an isomorphism.

With all the information above, we can now prove Theorem 1.5.
Proof of Theorem 1.5. Recall that here φ = (x−γ)2 −c1 ∈ OF,D [t][x] is non-isotrivial
and geometrically stable. Notice that this implies, in particular, that c1 6= 0 and
therefore we can apply Theorem 1.3 to φ. Let Nφ be the constant determined by
Theorem 1.3. Now let Tφ be the finite set of primes determined by Lemma 3.5 for
f = φ(Nφ ) and let Sφ be the finite set of primes p of OF,D such that φp is isotrivial
∼
or p ∈ Tφ . Clearly, if p ∈ Sφ , then (Ggeo
6 eq (Ggeo
∞ (φp ), T∞ (φp )) =
∞ (φ), T∞ (φ)): if
geo
(φ),
TNφ (φ)); if φp is
6 eq (Ggeo
p ∈ Tφ this is obvious, because (GNφ (φp ), TNφ (φp )) ∼
=
Nφ
geo
isotrivial then [Aut(T∞ (φp )) : G∞ (φp )] = ∞, because φp is post-critically finite (see
[17, Theorem 3.1]), while [Aut(T∞ (φ)) : Ggeo
∞ (φ)] < ∞ by [10, Theorem 1].
geo
∼
Conversely, suppose that p ∈
/ Sφ . Since (Ggeo
Nφ (φp ), TNφ (φp )) =eq (GNφ (φ), TNφ (φ))
(N )

and φ(Nφ ) is geometrically irreducible, then φp φ is geometrically irreducible as
well. This implies in particular that c1 6= 0 mod p, and therefore we have that
max{n ∈ Zs (φp )} ≤ Nφ by Theorem 1.3. Now simply observe that for every prime
p∈
/ Sφ we have that Zs (φ) ⊆ Zs (φp ), and therefore max{n ∈ Zs (φ)} ≤ Nφ . Hence,
we are in the exact position to apply Corollary 3.4 and conclude the proof.

4. Theorem 1.5 at work: a conjecture of Jones
The goal of this section is to show how Theorem 1.5 can be applied to the polynomial φ = x2 + t to prove Theorem 1.6. In fact, we will prove the following theorem.
Theorem 4.1. Let φ = x2 + t ∈ Z[t][x]. Then the arboreal representation ρφp is
geometrically surjective for all odd primes p.
Before proving Theorem 4.1, let us recall the following criterion for surjectivity,
whose idea is due to Stoll.

EQUIVARIANT ISOMORPHISMS FOR ARBOREAL GALOIS REPRESENTATIONS

17

Theorem 4.2 ([12, 23]). Assume that char k 6= 2 and let φ ∈ k[x] be a monic,
quadratic polynomial such that all iterates are separable. Let {cn } be its adjusted
post-critical orbit. Then ρφ is surjective if and only if for every n ≥ 1 the F2 -vector
2
space generated by c1 , . . . , cn in k× /k× has dimension n.
Next, let us remark that Theorem 4.1 implies Theorem 1.6. In fact, as noticed by
Jones in [15, p. 1125], if char k = 0 then ρφ is geometrically surjective. On the other
hand, let char k = p. By Theorem 4.2 the arboreal representation ρφ is surjective if
and only if there is no product of the ci ’s that is a square in k(t). But an algebraic
closure of k contains an algebraic closure of Fp , and therefore, since cn ∈ Fp [t] for
all n, if no product of the ci ’s is a square in Fp (t), then no product of the ci ’s can
be a square in k(t).
Proof of Theorem 4.1. Clearly, for every odd prime p, we have that φp is nonisotrivial, c1 6≡ 0 mod p and the dynamical inseparability degree of φp is 0. From
Theorem 2.6 it follows immediately that if n ≥ 3 then:
(13)

deg cn−1,p ≤ 8 deg dn,p + 144,

where the subscript p denotes the reduction modulo p. Clearly we have that
deg cn−1,p = 2n−2 for every n ≥ 2 and, as explained in the proof of Corollary
P⌊n/2⌋
2.9, if n ∈ Zs (φp ) then deg dn,p ≤ i=1 2i−1 = 2⌊n/2⌋ − 1, which in turn implies,
together with (13), that the constant Nφ given by Theorem 1.3 is 11.
As we mentioned above, it is well-known that ρφ is geometrically surjective in
characteristic zero, and so in particular over Q. This implies that φ is geometrically
stable, and hence we can apply Theorem 1.5 to φ. As explained in the proof of
∼ geo
∼
the theorem, we have that Ggeo
∞ (φp ) = G∞ (φ) = Aut(T∞ (φ)) for all primes p but
geo
possibily the finitely many ones such that (G11 (φp ), T11 (φp )) ∼
6 eq (Ggeo
=
11 (φ), T11 (φ)).
geo
Since G11 (φ) = Aut(T11 (φ)), it is easy to see, using the argument in Corollary 3.4,
geo
that the two pairs are equivariantly isomorphic if and only if Ggeo
11 (φp ) and G11 (φ)
are isomorphic as groups.
Thus, it is enough to find the finitely many primes for which, possibly, one has
that Ggeo
11 (φp ) 6= Aut(T11 (φp )). In order to find them, we use Theorem 4.2. This
than Aut(T11 (φp )) then there exists a non-empty
tells us that if Ggeo
11 (φp ) is smaller
Q
Q
subset I ⊆ {1, . . . , 11} such that i∈I ci,p is a square in Fp [t]. Since i∈I ci ∈ Z[t] is
notQa square in Q[t], its squarefree part dI has positive degree. On
Q the other hand,
if i∈I ci,p is a square in Fp [t] then one of the following holds: i∈I cQ
i,p = 0 or dI
is a square modulo p, and hence p | disc(dI ). Clearly we cannot have i∈I ci,p = 0
since all ci ’s are monic. Thus, to conclude the proof it is enough to check that
for all plausible non-empty subsets I ⊆
Q {1, . . . , 11} and all the finitely many odd
primes dividing disc(dI ), the product i∈I ci,p is not a square in Fp [t]. This has
been verified1 with SAGE [24].

References
[1] Jean-Marie Arnaudiès and Annick Valibouze. Lagrange resolvents. J. Pure
Appl. Algebra, 117/118:23–40, 1997. Algorithms for algebra (Eindhoven, 1996).
1The code is available upon request.

18

A. FERRAGUTI AND G. MICHELI

[2] Alan Baker. Bounds for the solutions of the hyperelliptic equation. In Mathematical Proceedings of the Cambridge Philosophical Society, volume 65, pages
439–444. Cambridge University Press, 1969.
[3] Robert Benedetto, Patrick Ingram, Rafe Jones, Michelle Manes, Joseph H. Silverman, and Thomas J. Tucker. Current trends and open problems in arithmetic
dynamics. Bull. Amer. Math. Soc. (N.S.), to appear, 2019.
[4] Nigel Boston and Rafe Jones. The image of an arboreal Galois representation.
Pure Appl. Math. Q., 5(1):213–225, 2009.
[5] Leonardo Cangelmi. Resolvents and Galois groups. Rend. Sem. Mat. Univ.
Politec. Torino, 53(3):207–222, 1995. Number theory, I (Rome, 1995).
[6] Antoine Chambert-Loir. A field guide to algebra. Undergraduate Texts in
Mathematics. Springer-Verlag, New York, 2005.
[7] Henri Cohen. A course in computational algebraic number theory, volume 138
of Graduate Texts in Mathematics. Springer-Verlag, Berlin, 1993.
[8] Andrea Ferraguti. The set of stable primes for polynomial sequences with large
Galois group. Proc. Amer. Math. Soc., 146(7):2773–2784, 2018.
[9] Andrea Ferraguti, Giacomo Micheli, and Reto Schnyder. Irreducible compositions of degree two polynomials over finite fields have regular structure. Q. J.
Math., 69(3):1089–1099, 2018.
[10] Wade Hindes. Galois uniformity in quadratic dynamics over k(t). J. Number
Theory, 148:372–383, 2015.
[11] Wade Hindes. Average Zsigmondy sets, dynamical Galois groups, and the
Kodaira-Spencer map. Trans. Amer. Math. Soc., 370(9):6391–6410, 2018.
[12] Wade Hindes. Classifying Galois groups of small iterates via rational points.
Int. J. Number Theory, 14(5):1403–1426, 2018.
[13] Wade Hindes and Rafe Jones. Ricatti equations and polynomial dynamics over
function fields. Trans. Amer. Math. Soc. (to appear), 2019.
[14] Rafe Jones. Galois martingales and the hyperbolic subset of the p-adic Mandelbrot set. PhD thesis, Citeseer, 2005.
[15] Rafe Jones. Iterated Galois towers, their associated martingales, and the p-adic
Mandelbrot set. Compos. Math., 143(5):1108–1126, 2007.
[16] Rafe Jones. The density of prime divisors in the arithmetic dynamics of quadratic polynomials. J. Lond. Math. Soc. (2), 78(2):523–544, 2008.
[17] Rafe Jones. Galois representations from pre-image trees: an arboreal survey.
In Actes de la Conférence “Théorie des Nombres et Applications”, volume 2013
of Publ. Math. Besançon Algèbre Théorie Nr., pages 107–136. Presses Univ.
Franche-Comté, Besançon, 2013.
[18] Serge Lang. Diophantine geometry. Interscience Tracts in Pure and Applied
Mathematics, No. 11. Interscience Publishers (a division of John Wiley & Sons),
New York-London, 1962.
[19] R. C. Mason. The hyperelliptic equation over function fields. In Mathematical
Proceedings of the Cambridge Philosophical Society, volume 93, pages 219–230.
Cambridge University Press, 1983.
[20] R. C. Mason. Diophantine equations over function fields, volume 96 of London Mathematical Society Lecture Note Series. Cambridge University Press,
Cambridge, 1984.

EQUIVARIANT ISOMORPHISMS FOR ARBOREAL GALOIS REPRESENTATIONS

19

[21] Joseph H. Silverman. Primitive divisors, dynamical Zsigmondy sets, and Vojta’s
conjecture. J. Number Theory, 133(9):2948–2963, 2013.
[22] Henning Stichtenoth. Algebraic function fields and codes, volume 254 of Graduate Texts in Mathematics. Springer-Verlag, Berlin, second edition, 2009.
[23] Michael Stoll. Galois groups over Q of some iterated polynomials. Arch. Math.
(Basel), 59(3):239–244, 1992.
[24] The Sage Developers. SageMath, the Sage Mathematics Software System (Version 7.4), 2016. https://www.sagemath.org.
Max Planck Institute for Mathematics, Vivatsgasse 7, 53111 Bonn, Germany
E-mail address: ferra@mpim-bonn.mpg.de
Mathematical Institute, EPFL, Station 8, Lausanne 1015, Switzerland
E-mail address: giacomo.micheli@epfl.ch

