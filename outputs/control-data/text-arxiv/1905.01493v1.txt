EFFECTIVE COUNTING FOR DISCRETE LATTICE ORBITS IN THE
PLANE VIA EISENSTEIN SERIES

arXiv:1905.01493v1 [math.DS] 4 May 2019

CLAIRE BURRIN, AMOS NEVO, RENE RÜHR, AND BARAK WEISS
Abstract. In 1989 Veech showed that for the flat surface formed by gluing opposite
sides of two regular n-gons, the set Y ⊂ R2 of saddle connection holonomy vectors
satisfies a quadratic growth estimate |{y ∈ Y : kyk ≤ R}| ∼ cY R2 , and computed the
constant cY . In 1992 he recorded an observation
of Sarnak that gives an error estimate

4
|{y ∈ Y : kyk ≤ R}| = cY R2 + O R 3 in the asymptotics. Both Veech’s proof of
quadratic growth, and Sarnak’s error estimate, rely on the theory of Eisenstein series, and
are valid in the wider context of counting points in discrete orbits for the linear action of a
lattice in SL2 (R) on the plane. In this paper we expose this technique and use it to obtain
the following
For lattices Γ with trivial residual spectrum, we recover the error
 results.

4
estimate O R 3 , with a simpler proof. Extending this argument to more general shapes,
and using twisted Eisenstein series, for sectors Sα,β = {reiθ : r > 0, α ≤ θ ≤ α + β} we
prove an error estimate
 8
β 2
R + Oε R 5 .
|{y ∈ Y : y ∈ Sα,β , kyk ≤ R}| = cY
2π
For dilations of smooth star bodies R · Bψ = {reiθ : 0 ≤ r ≤ Rψ(θ)}, where R > 0 and
ψ is smooth, we prove an estimate
 12 
|{y ∈ Y : y ∈ R · Bψ }| = cY,ψ R2 + Oψ,ε R 7 .

Dedicated with admiration to the memory of Bill Veech
1. Introduction
We recall the Gauss circle problem, which aims to provide an estimate for the cardinality
B ∩ Z2 of the intersection of a large ball B in the plane with the integer lattice. The
estimate
B(0, R) ∩ Z2 = πR2 + O(R)

is easy to prove and is attributed to Gauss (here B(x, r) ⊂ R2 is the Euclidean ball of radius
r around x). There have been several improvements to the error term and this is still the
topic of intense investigation (see [IKKN06] for a recent survey). A more general problem in
the same vein aims to replace the set Z2 with another discrete set Y , and replace large balls
B with more general sets. For more general sets Y , the first step is establishing quadratic
growth, i.e. showing |B(0, R) ∩ Y | = cY R2 + o(R2 ) for some cY > 0, and this can already be
very challenging. In cases where quadratic growth has been established, the natural next
questions are to evaluate the quadratic growth constant cY , and to obtain error estimates. A
well-studied example is when Y is the set of primitive points in Z2 , which is a discrete orbit
under the group SL2 (Z). This paper is concerned with the case in which Y is a discrete
orbit for a lattice in G = SL2 (R) acting on the plane. An important contribution to the
study of these discrete orbits was made by Veech in a celebrated 1989 paper [Vee89], and in
the subsequent papers [Vee92, Vee98]. We begin by recalling the context of Veech’s work.
A translation surface is a compact oriented surface equipped with a translation structure.
Since the main results of this paper will not involve translation surfaces, we omit the precise
definitions, referring the interested reader to the surveys [Vor96, MT02, Z06]. For any
translation surface M , the collection of holonomy vectors of saddle connections is a discrete
set YM in R2 , consisting of planar holonomies of certain straightline paths on M . The
Date: May 7, 2019.
1

2

CLAIRE BURRIN, AMOS NEVO, RENE RÜHR, AND BARAK WEISS

group G acts on a moduli space of translation surfaces, as well as on the plane by linear
transformations, satisfying an equivariance property YgM = gYM . For any M , its stabilizer
group (or Veech group) is
ΓM = {g ∈ G : gM = M }.
If ΓM is a lattice in G, i.e. is discrete and of finite covolume, then M is called a lattice
surface (or Veech surface). These lattices are non-uniform and thus have discrete orbits in
the plane. Here is a summary of the results of [Vee89] which are relevant to this paper.
Theorem 1.1 (Veech 1989).
(a) The surfaces Mn obtained by gluing sides in two copies
of a regular n-gon are lattice surfaces, and the corresponding lattice is non-arithmetic
unless n ∈ {3, 4, 6}.
(b) For lattice surfaces, YM is a finite union of ΓM -orbits.
(c) Discrete orbits of lattices in G acting on the plane, satisfy quadratic growth. In
particular, the sets YM satisfy quadratic growth when M is a lattice surface.
(d) The quadratic growth constants for the surfaces Mn in (a) are computed.
Veech proved statement (c) by reducing the problem to previous work in analytic number
theory. We will review this below in §3. He also computed quadratic growth constants for
the examples in statement (a), and in [Vee92], computed quadratic growth constants for
more examples. Veech revisited statement (c) in [Vee98], where he introduced a number
of techniques which make it possible to establish quadratic growth in more general situations, and compute quadratic growth constants. Among other things he also reproved (c)
by ergodic methods, in particular using an ergodic-theoretic tool of Eskin and McMullen
[EMc93]. Another ergodic-theoretic proof of (c) was given by Gutkin and Judge in [GJ00],
also using ideas of [EMc93]. In subsequent work, Eskin and Masur [EM01] improved on
Veech [Vee98] and proved that almost every translation M (with respect to the natural
measures on the moduli spaces of translation surfaces) satisfies quadratic growth. Their
arguments are also ergodic-theoretic and rely on an ergodic theorem appearing in [Ne17].
In the presence of some spectral estimates, it is possible to improve on quadratic growth
by establishing effective quadratic growth, by which we mean proving an error term of the
form

(1.1)
|B(0, R) ∩ Y | = cY R2 + O R2−δ

for some δ > 0. In [NRW17], relying on spectral estimates established in [AGY06, AG13],
such an error bound was given for almost every translation surface. In particular, the results
of [NRW17] imply effective quadratic growth for Veech surfaces. However the constant δ
appearing in [NRW17] is far from optimal, and a much better error estimate for the case of
lattice surfaces has long been known to experts. In fact, already in [Vee92, Remark 1.12],
Veech included the remark (which he attributed to Sarnak) that work of Selberg and Good
can be used to prove to an estimate of the form
 4
(1.2)
|B(0, R) ∩ Y | = cY R2 + O R 3 ,

where Y is the orbit of tempered lattice in G (see §2).
An initial goal of this paper was to provide an exposition of the method sketched in
[Vee92, Remark 1.12], specifically for the benefit of those who might be familiar with ergodictheoretic counting techniques but not with the techniques used in analytic number theory.
While studying this topic, the authors obtained several extensions and improvements. Thus
the paper acquired an additional goal of proving these new results; however we believe that
a survey on these matters has not lost its relevance, and we chose to write our paper on the
level of a tutorial.
The structure of the paper is as follows. In §2 we define the objects which will be the
focus of our discussion and state our results, comparing our new results with those which
were obtained by previous authors (or could be easily deduced from their work). Specifically
we define the class of tempered lattices and the larger class of lattices with trivial residual
spectrum, which are the subgroups for which the relevant spectral estimates are as strong
as one could hope for. As we will explain, our improvements concern counting points in

EFFECTIVE COUNTING FOR LATTICE ORBITS

3

more general shapes than Euclidean balls; e.g. sectors or dilates of star-shaped bodies. In
§3 we define Eisenstein series and collect some results about them. We also explain how
Veech obtained statement (c) of Theorem 1.1. In §4 we prove the bound (1.2) (see Theorem
2.4) for counting in balls, and for lattices with trivial residual spectrum. Our work bypasses
difficult work of Good [Go83] by taking advantage of the fact that in our particular setting,
counting can be achieved by making a contour shift of a truncated Eisenstein series to the
critical line, for a general lattice. This strategy is classical in analytical number theory (see
e.g. [Dav80]), and indeed goes back to the proof of the Prime Number Theorem, but in our
situation requires an extra averaging argument, see Proposition 4.2. In §5 we use this idea to
prove our improvements. Although §5 is the one containing the proof of the new results, its
proof uses the ideas involved in proving earlier results, and so we do not recommend starting
with §5. The results of §4 and §5 both rely on reducing counting problems to fundamental
estimates about Eisenstein series, which are collected in §3, and whose proofs we do not
explain.
Acknowledgements. The authors gratefully acknowledge the support of ISF grant
2095/15, BSF grant 2016256, SNF grant 168823, and ERC starter grant HD-APP 754475.
CB thanks Ze’ev Rudnick for making possible a visit to Tel Aviv University in January 2017. The authors thank Avner Kiro, Morten Risager, Ze’ev Rudnick and Andreas
Strömbergsson for very helpful discussions.
2. Definitions and statement of results
In this section we set our notation, recall certain preliminary results, and state our results.
2.1. Some actions and subgroups of G = SL2 (R). Recall that G acts on the left on the
upper half-plane H = {z ∈ C : Im(z) > 0} and on the plane R2 respectively, by the rules

  



az + b
a b
x
ax + by
a b
and
=
.
z=
c d
y
cx + dy
c d
cz + d
The G-action on H preserves the hyperbolic metric ds2 =
area form

dxdy
y2 .

dx2 +dy 2
y2

and hence the hyperbolic

Let


cos θ
K = SO2 (R) = {rθ : θ ∈ [0, 2π]} , where rθ =
sin θ


− sin θ
.
cos θ

√
Let i = −1 so that K is the stabilizer of i. Also let k · k be the Euclidean norm on R2 ; it
is also preserved by K. Let e1 = (1, 0) so that the stabilizer of e1 is


1 s
N = {us : s ∈ R}, where us =
.
0 1

Let Γ ⊂ G be a discrete subgroup. It then acts properly discontinuously on H. We call
Γ a lattice if there is a finite G-invariant measure on G/Γ or equivalently, a fundamental
domain for the Γ-action on H of finite hyperbolic area. If there is a compact fundamental
domain then Γ is called cocompact or uniform. If Γ is a lattice we write XΓ = H/Γ,
denote the G-invariant measure on XΓ induced by the hyperbolic area form by µΓ and write
covol(Γ) = µΓ (XΓ ).
A subgroup of Γ is called maximal unipotent if it is conjugate (in G) to the group
N0 = {un : n ∈ Z}

and is not properly contained in a subgroup conjugate to N0 . For a lattice Γ ⊂ G, the
quotient H/Γ has a finite number of topological ends called cusps. The number of cusps
is zero if and only if Γ is cocompact, and in the non-uniform case, there is a bijection
between cusps and conjugacy classes (in Γ) of maximal unipotent subgroups. For a lattice
Γ and v ∈ R2 r {0}, the orbit Γv is discrete if and only if the stabilizer of v in Γ is a
maximal unipotent group, and we refer to the conjugacy class of the stabilizer of v as the
cusp corresponding to Γv. In particular a cocompact lattice has no discrete orbits in its
action on R2 . Clearly Γv is discrete if and only if Γ(tv) = tΓv is discrete for all t 6= 0, and

4

CLAIRE BURRIN, AMOS NEVO, RENE RÜHR, AND BARAK WEISS

hence the number of discrete orbits, considered up to dilation, is the same as the number of
cusps. We are interested in counting points in discrete orbits for the Γ-action on R2 .
Warning: In the literature, one often works with PSL2 (R) = G/{±Id}, the group of
orientation-preserving isometries of H. Since we are interested in point sets in the plane,
which need not be invariant under the action of −Id, it will be more natural for us to work
with G. This discrepancy may result in minor deviations with other texts; there will be no
discrepancy whenever Γ contains −Id, and for many counting problems we can reduce to
this situation as follows:
Proposition 2.1. Let π : G → PSL2 (R) be the natural projection, and suppose Γ is a lattice
in G, which does not contain −Id. Let Γ(±) = π −1 (π(Γ)), so that Γ(±) is a degree 2 central
extension of Γ. Then either Γ(±) v = Γv or Γ(±) v = Γv ⊔ −Γv (a disjoint union).
Proof. Since −Id and Γ generate Γ(±) , we have Γ(±) v = Γv ∪ −Γv. If this is not a disjoint
union then there is u ∈ Γv for which −u ∈ Γv, say u = γ1 v and −u = γ2 v. Then
−v = −γ1−1 (u) = γ1−1 (−u) = γ1−1 γ2 v

so that Γv = −Γv.



Let ∆ be the Laplace-Beltrami differential operator on H, which is expressed in coordinates as

 2
∂2f
∂ f
.
+
(2.1)
∆f (x + iy) = −y 2
∂x2
∂y 2
It is not hard to check that ∆ is G-invariant and hence descends to a well-defined differential
operator on XΓ which we continue to denote by ∆. The eigenvectors for ∆ which belong to
L2 (XΓ , µΓ ) are called Maass forms. The corresponding eigenvalues satisfy
0 = λ0 < λ1 ≤ λ2 ≤ · · · ,


and the nontrivial small eigenvalues are those satisfying λi ∈ 0, 14 .

Definition 2.2. We say that Γ is tempered if it has no nontrivial small eigenvalues.
Examples of tempered subgroups are the Veech groups of the surfaces Mn of Theorem
1.1(1): Veech showed that they are (2, n, ∞) Schwarz triangle groups, these triangle groups
were shown to be tempered by Sarnak [Sa80, §3], and all triangle groups were shown to be
tempered by Zograf [Z82]. All but finitely many non-uniform triangle groups arise as Veech
groups of lattice surfaces, see [BM10, Hoo13, Wr13].
Suppose Γ is a non-uniform lattice with k cusps, and for i = 1, . . . , k choose si ∈ G so
−1
that Γ′i = s−1
i Γsi contains N0 as a maximal unipotent subgroup, where the groups si N0 si
are mutually nonconjugate maximal unipotent subgroups of Γ. Let

±N0
Γ contains -Id
′
N0 =
,
N0
otherwise
and set
(2.2)

Ei (z, s) =

X

Im(γ ′ z)s , where γ ′ = γs−1
i ,

γ∈N0′ \Γ′i

where z ∈ H, s ∈ C and the sum ranges over any collection of coset representatives. Then
Ei is the Eisenstein series corresponding to the i-th cusp of Γ. It will play a major role in
our discussion and will be slowly introduced in §3. As we will see, for each fixed i and z, the
sum (2.2), considered as a map s 7→ Ei (z, s), converges for Re(s) > 1 and has a meromorphic
continuation to the complex plane. We use this fact for the following important definition:
Definition 2.3. Let Γ, k, i be as above. The residual spectrum of Ei (z, s) is the set of
s ∈ (1/2, 1) for which s 7→ Ei (z, s) has a pole at s. If there are no such poles we say that
the residual spectrum of Ei (z, s) is trivial.

EFFECTIVE COUNTING FOR LATTICE ORBITS

5

We remark that the choice of z in the above definition is unimportant as all functions
Ei (z, ·) have poles at the same values of s.
If Ei (z, ·) has a pole at s ∈ (1/2, 1) then ∆ has an eigenvalue λ = s(1 − s) ∈ (0, 1/4).
Thus, if Γ is tempered then all of its cusps have trivial residual spectrum. With regard to
the converse, consider for instance principal congruence groups (the principal congruence
group of level n is the group of all matrices in SL2 (Z) congruent to Id mod n). In this
case it is known that any cusp for any congruence group has trivial residual spectrum (see
[Iwa95, Thm. 11.3]), but the question of whether all of these group are tempered is a famous
longstanding open question posed by Selberg.
With this terminology we will prove:
Theorem 2.4. Suppose Γ is a nonuniform lattice in G, Y = Γv is a discrete orbit for which
the corresponding Eisenstein series has trivial residual spectrum. Then there is cY > 0 such
that
 4
(2.3)
|B(0, R) ∩ Y | = cY R2 + O R 3 .
Moreover, the asymptotic (2.3) holds when one replaces B(0, R) with the dilate R · E of
any centered ellipse E (with the constant cY and the implicit constant in the O-notation
depending on E).

In this result one also obtains a precise formula for the quadratic growth constant cY ,
and an asymptotic expansion for the error in case the residual spectrum is not trivial, with
one term for every pole at s ∈ 21 , 1 . See Theorem 4.1. This error estimate in (2.3) is not
new. In fact, as we saw in (1.2), Sarnak and Veech could prove it already in 1993. However
the proof we will give below will be simpler than the proof outlined in [Vee92], which relies
on difficult work of Good concerning counting results in both R2 and in H. See §2.3 for a
more detailed comparison with Good’s work.
An interesting open question is whether the error term in Theorem 2.4 is optimal. In
this regard, note that for Γ = SL2 (Z), the error term in (1.2) can be improved to o(R)
(see [HN96]); the same is true for congruence groups. However we are not aware of any
non-arithmetic non-uniform lattices for which a bound better than that of (1.2) is known.
2.2. Counting in more general domains. We turn to new results. In these results we
strive to take sets more general than Euclidean balls in the counting problem, while still
obtaining a good bound for the error. We will need 
a further
 definition.
a b
For each γ ∈ G, we set cγ = c, dγ = d where γ =
. Note that cγ , dγ only depend
c d
on the coset N γ. For each n ∈ Z, and for Γ, Γi , si , N0′ as in the discussion preceding (2.2),
define a twisted Eisenstein series
2n

X
cγ ′ z + dγ ′
where γ ′ = γs−1
(2.4)
Ei (z, s)2n =
Im(γ ′ z)s
i
′ z + dγ ′ |
|c
γ
′
′
γ∈N0 \Γi

(note that this definition makes sense for any m in place of 2n but we are only interested in
the even values). Once again it is true that s 7→ Ei (z, s)2n has a meromorphic continuation
to the entire complex plane, whose poles do not depend on z, and we generalize Definition
2.3 as follows:
Definition 2.5. For i, n as above, the residual spectrum are those s ∈ (1/2, 1) for which
Ei (z, ·)2n has a pole at s. If there are no such s we say the residual spectrum of Ei (z, s)2n
is trivial.
Once again it is true that Ei (z, s)2n has finitely many poles and a tempered group Γ has
trivial residual spectrum for each i and n.
Let S ⊂ R2 be a bounded closed set. We say that S is star shaped at 0 if it can be written
as
S = {r(cos θ, sin θ) : θ ∈ [0, 2π], r ∈ [0, ρ(θ)]}
for θ 7→ ρ(θ) a non-negative bounded 2π-periodic function of compact support.

6

CLAIRE BURRIN, AMOS NEVO, RENE RÜHR, AND BARAK WEISS

We say that S is a sector if it is of the above form with the function ρ the indicator of a
nondegenerate subinterval. We say S is a smooth star shape if it is of the above form and ρ
is smooth and everywhere positive. We write R · S for the dilated set {Rx : x ∈ S}.
With these notations we have:
Theorem 2.6. Suppose Γ is a non-uniform lattice in G containing −Id, Y = Γv is a
discrete orbit corresponding to the i-th cusp, and suppose that for each n, Ei (z, s)2n has
trivial residual spectrum. Then:
• If S is a smooth star shape then there is cY,S > 0 such that for every ε > 0,
 12 
|Y ∩ R · S| = cY,S R2 + O R 7 +ε .
• If S is a sector then there is cY,S > 0 such that
 8
(2.5)
|Y ∩ R · S| = cY,S R2 + O R 5 ;

moreover, the asymptotic (2.5) is also valid if one replaces S with a sector in a
centered ellipse (i.e. the image of a sector under an invertible linear map), with
implicit constants depending also on the ellipse.

In the above results, the quadratic growth constants can be written down explicitly and
the implicit constants depend on the sets S.
2.3. Relation to the work of Good. Let G = KAN be the Iwasawa decomposition of G,
that is K, A, N are respectively the subgroup of orthogonal, diagonal, and unipotent upper
triangular matrices, and let Γ be a non-uniform lattice normalized so that it contains N0 as
a maximal unipotent subgroup. The counting problem considered in Theorem 2.4 can be
thought of as a counting problem in the double coset space
S = (Γ ∩ K)\ Γ /(Γ ∩ N ).
In fact, one can easily verify that
|Γe1 ∩ B(0, R)| = |{[γ] ∈ S : kγe1 k ≤ R}|

= [γ] ∈ S : Im(γ −1 i) ≥ R−2

= (θ mod 2π, y, x mod 1) : [rθ ay ux ] ∈ S, y ≥ R−2

,

where ay = diag(y, y −1 ) and the last identification relies on the Iwasawa decomposition of
G. Fix y > 0, and set
Ky = {(θ

mod 2π, x mod 1) : [rθ ay nx ] ∈ S}.

The character sums, for m, n ∈ Z, y > 0,
S(m, n, y) =

X

eimθ e2πinx

(θ,x)∈Ky

indexed over the above Iwasawa double coset decomposition are a natural generalization of
the classical Kloosterman sums from number theory (which appeared already in work of
Poincaré about Fourier expansions of Eisenstein series, see [P11]). Note in particular that
X
|Γe1 ∩ B(0, R)| =
S(0, 0, y).
y≥R−2

In [Go83, Thm. 4], Good proved bounds on the asymptotic growth of sums of various generalizations of Kloosterman sums as above, meaning over various double coset decompositions
of Γ in G. This corresponds to the problem we have discussed above (counting for Γ-orbits
in the plane) as well as other counting problems such as Γ-orbits in H and in the space of
geodesics. For the case of the linear action on the plane, which is the one of interest here,
Good obtains
 4
X
X
eimθ e2πinx = cm,n R2 + Om,n R 3 ,
y≥R−2 (θ,x)∈Ky

EFFECTIVE COUNTING FOR LATTICE ORBITS

7

where cm,n > 0 if and only if m = n = 0. The dependence of implicit constants in the
remainder term on m, n is however not worked out explicitly (and difficult to trace over the
100 pages of build-up Good relies on to prove this asymptotic). If it were, one would be
able to deduce results similar to Theorem 2.6 from [Go83].
2.4. Counting in still more general (well-rounded) domains. A common assumption
in the theory of counting lattice points in a family of domains in a Lie group is that of wellroundedness, introduced in [DRS93] and [EMc93]. In [GN12] this assumption was combined
with an estimate of the spectral gap that arises in the automorphic representation of G on
L20 (G/Γ) to prove an effective estimate for the lattice point count. We will show that the
problem we consider, namely counting points in discrete orbits for the linear action of a
lattice on the plane, can be reduced to the lattice point counting problem for domains in
SL2 (R). This will allow us to count orbit points in more general sets in the plane using
just the existence of a spectral gap, but this additional generality compromises the error
estimate, leading to bounds which are inferior to the ones stated above. Thus the techniques
we describe in this subsection are applicable in more general situations, but lead to weaker
bounds.
We will show:
Theorem 2.7. Let Γ be any non-uniform lattice in SL2 (R), and Y = Γv any discrete orbit
of Γ in R2 \ {0}. Let S ⊂ R2 be a star-shaped domain at 0 with ρ(θ) a non-negative piecewise
Lipschitz function, and let R · S be the dilation of S by a factor of R. Then, for all ε > 0

|Y ∩ R · S| = CY,S R2 + O RqΓ +ε ,

where the implicit constants in the O-notation depend on Γ, Y, S and ε, and with qΓ depending only on the spectral gap of the automorphic representation of G on L20 (G/Γ). In
particular, if the lattice Γ is tempered, then we can set qΓ = 74 .
Note that Theorem 2.7 applies, in particular, to all convex sets with piecewise Lipchitz
boundary (containing the origin in their interior), and in particular, to all convex polygons.
3. A bit of Eisenstein series

In this section we go into more details about our main actor, the Eisenstein series introduced in (2.2). We refer the reader to [Kub73, Hej83, Ter85, Sa81] for more information.
3.1. Some sums and their relation to the counting function. For a non-uniform
lattice Γ, a discrete orbit Y = Γv in the plane, g ∈ G and s ∈ C, we set
X
(3.1)
E(g, s) = E (Γ,v) (g, s) =
kuk−2s .
u∈gΓv

Note that in (2.2), (3.1) we introduce the notation E and E (Γ,v) to denote two different
functions, one of which has an argument z ∈ C and the other, g ∈ G. This ambiguity is
common in the literature and is explained below, see (3.6). Our first task will be to motivate
this new definition, in the context of the counting problem for points in Γv. For the moment
we consider (3.1) as a formal sum, postponing the discussion of convergence issues.
Warning (continued). In the literature, there are two conflicting conventions regarding
the definition of E(g, s). What is denoted E(g, s) in [Vee89] is denoted E(g −1 , s) in [Kub73].
We will follow Veech’s convention, and we say more about the source of this discrepancy
below.
P
Let N(g, R) = |B(0, R) ∩ gY |. Considering the measure ν (g) = u∈gΓv δu , which is a
Radon measure on R2 (since Γv is discrete), and considering the radial function f (s) (w) =
kwk−2s , we have
ˆ ∞
ˆ
dN(g, R)
(s)
(g)
,
f dν =
E(g, s) =
R2s
0
R2

8

CLAIRE BURRIN, AMOS NEVO, RENE RÜHR, AND BARAK WEISS

where in the last equality we have written a Lebesgue-Stieltjes integral. Using integration
by parts (and recalling that convergence issues will be addressed further below), we have
ˆ ∞
N(g, R) 1−2s
R
dR.
(3.2)
E(g, s) = 2s
R2
0
We now recall the definition of the Mellin transform and Mellin inversion, which are multiplicative analogues of the Fourier transform and Fourier inversion. Recall that a Schwartz
function is a function R → R which is infinitely differentiable and for which all derivatives
decay to zero at infinity faster than any power. We will say that ψ : R+ → R is a Schwartz
function on R+ = (0, ∞) if f (x) = ψ(ex ) is a Schwartz function. The Mellin transform of a
Schwartz function ψ : R+ → R is given by
ˆ ∞
(3.3)
Mψ : C → C, Mψ(s) =
ψ(y)y s−1 dy,
0

and Mellin inversion says that for σ ∈ R we have
ˆ
1
(3.4)
ψ(y) =
Mψ(s) y −s ds.
2πi Re(s)=σ
The above formulae follow immediately from the Fourier transform and Fourier inversion
formula, from which they are obtained by a change of variables y = ex . As we will explain
below, under suitable conditions the formulae extend to functions which are not Schwartz
functions. For the moment we proceed considering them as formal identities.
Comparing equations (3.2) and (3.3), and making a change of variables y = R−1 , we see
that E(g,s)
is the Mellin transform of the function y 7→ N(g, y −1 ) evaluated at 2s. Applying
2s
Mellin inversion we recover the counting function N as
ˆ
1
E(g, s) 2s
R ds
(3.5)
N(g, R) =
2πi Re(s)=σ
s
(this formal manipulation is given a precise meaning and justified in Corollary 3.3 below).
The upshot of this discussion is that, at least formally, the counting function which we are
interested in has an integral representation in terms of the function E(g, s). Furthermore, if
we know (as will turn out to be the case) that s 7→ E(g, s) is holomorphic or meromorphic,
then the integral of (3.5) can be evaluated using standard tools of complex analysis like contour shifts, residue computations, etc. Using this, after justifying our manipulations we will
indeed be able to obtain a detailed understanding of R 7→ N(g, R) from an understanding
of E(g, s). Note also that up to this point no use has been made of the dependence of all
quantities on the variable g. This dependence will not play much of a role in our discussion,
but it is crucial when one wants to say something about E.
For the benefit of readers not satisfied with this non-rigorous derivation of (3.5), we
include another non-rigorous derivation. Let u ∈ gΓv and consider its contribution to both
sides of (3.5). Assume for simplicity that gΓv does not contain vectors of length precisely R,
and set y = R/kuk, so that u contributes 1 to N(g, R) when y > 1 and contributes 0 when
y < 1. Recalling (3.1), and exchanging the order of summation and integration in the right
´
y 2s
1
ds. This integral is the
hand side of (3.5), we see that each u contributes 2πi
Re(s)=σ s
limit as T → ∞ of line integrals along the vertical lines Lσ,T = {σ + it : −T ≤ t ≤ T }. For
each fixed T we can evaluate this line integral by Cauchy’s integral formula, replacing Lσ,T
with Lζ,T (the total contribution along the horizontal lines Im(s) = ±T becomes negligible
as T → ∞), where in case y > 1, we let ζ → −∞, and get a contribution of 1 due to the
pole at the origin, and in case y < 1 we let ζ → +∞ and get a contribution of 0.
3.2. Simple properties and the relation to Eisenstein series. Having motivated our
interest in the function defined by (3.1), we now make the link with the functions defined
by (2.2). Let Γv = {γ ∈ Γ : γv = v}. Note that if g = rθ diag y, y −1 us , where y > 0 and
rθ ∈ K, us ∈ N (Iwasawa decomposition), then y can be detected in both the linear action
1
as kge1 k and in the action on the upper half plane as Im(g −1 i)− 2 . Using this observation,

EFFECTIVE COUNTING FOR LATTICE ORBITS

9

the following properties follow readily from the definition (3.1) and from the fact that the
Euclidean norm is K-invariant.
Proposition 3.1.
(1) For rθ ∈ K and γ ∈ Γv we have E(rθ gγ, s) = E(g, s).
s −1
(2) For g, s ∈ G, if Γs = s−1 Γs then E (Γ ,s v) (gs, s) = E (Γ,v) (g, s).
(3) Suppose Γ contains N0 P
as a maximal unipotent subgroup. If Γ does not contain
-Id then E (Γ,e1 ) (g, s) = γ∈N ′ \Γ Im(γg −1 i)s ; if Γ contains -Id then E (Γ,e1 ) (g, s) =
0
P
2 γ∈N ′ \Γ Im(γg −1 i)s .
0

(4) If v1 , v2 ∈ R2 r {0} satisfy v2 = tv1 for t > 0, then E (Γ,v1 ) (g, s) = t−2s E (Γ,v2 ) (g, s).

By property (1), the dependence of (3.1) on g is actually only a dependence on the coset
Kg, and we can identify these cosets with H via Kg ↔ z = g −1 i to replace g with z. And
with the normalization that the stabilizer of v is N0 , we see by rescaling and using properties
(2) and (3) that

Ei (z, s) Γ does not contain -Id
(3.6)
z = g −1 i =⇒ Ei (g, s) =
.
2Ei (z, s)
otherwise

Thus for each non-uniform lattice Γ with k cusps, up to the trivial transformations recorded
above, there are k essentially different functions of this form. They are normalized by
conjugating so that Γv = N0 and rescaling so that v = e1 . It will become clearer later
why this normalization is convenient. It will also develop that in order to understand these
functions in detail, it is best not to focus on one of them, but to consider their properties
as a vector valued function (z, s) 7→ (E1 (z, s), . . . , Ek (z, s)).
The discrepancy between the notation used in [Vee89] and that used in [Kub73] is related
to the substitution z = g −1 i above. If one followed the convention of Kubota one would
make the substitution z = gi instead. The convention of Veech, which we follow, gives
simpler formulae involving discrete orbits in R2 and is consistent with working with the
space of left cosets G/Γ. The convention of Kubota gives simpler formulae when discussing
the action of G on H by Möbius transformations, and is consistent with working with right
cosets Γ\G. Thus the discrepancy between these notations is collateral damage in a larger
battle.
We now explain our interest in the twisted Eisenstein series (2.4). Above we motivated
Eisenstein series by explaining its relation to the counting problem in the plane, where each
orbit point is assigned the same mass 1. In this application the counting function is Kinvariant, and so we can equivalently view the first parameter of the Eisenstein series as
ranging in g ∈ G or in z ∈ H (as in the preceding paragraph). In more general situations it
is desirable to assign different masses to different points, and in particular allow functions
which depend on g rather than on the coset Kg. This will arise when we deal with more
refined counting problems as in Theorem 2.6, and also arises in many other problems of
geometric origin.
For a vector u ∈ R2 r {0} ∼
= C r {0} we define polar coordinates u = kukeiθu , where
θu ∈ R/2πZ. Let Γv be a discrete orbit corresponding to the i-th cusp Γ, normalized so
that v = si e1 , and set
X
(3.7)
Ei (g, s)n =
kuk−2s e−inθu .
u∈gΓv

Note that these functions vanish for n odd when Γ contains −Id. It is not hard to formulate
an analogue of Proposition 3.1 and, by comparing (2.4) and (3.7), to verify that
 −1/2

y
−xy −1/2
(3.8)
Ei (z, s)2n = Ei (g, s)2n when z = x + iy and g =
.
0
y 1/2

Note that the choice of g in (3.8) ensures z = g −1 i, and if we choose another g with this
property, this will only affect Ei (g, s)2n by multiplication with a complex number of modulus
1.

Warning (continued): In (3.7), it would have been more natural, and consistent with the
Veech convention mentioned after Proposition 3.1, to define the Eisenstein series using einθu

10

CLAIRE BURRIN, AMOS NEVO, RENE RÜHR, AND BARAK WEISS

instead of e−inθu . However this would have made it necessary to introduce a change of signs
in (2.4) and would have caused a discrepancy between our notation and that of [Se89, Sa81].
Treating more general weights of points on the plane also leads to the Θ-transform which
we will discuss in §3.6.
3.3. Convergence properties. We now begin our discussion of convergence properties of
the various series introduced so far, and give a more rigorous justification of (3.5). Convergence rests on the following weak (and standard) counting estimate.
Proposition 3.2. For each g ∈ G we have N(g, R) = O(R2 ). Moreover the implicit
constant can be taken to be independent of g.
Proof. We will give a simple proof in which the implicit constant will appear to depend on g.
For a similar but more careful proof, which explains how to take the constant independent
of g, see [Vee98, Lemma 16.10].
Make a change of variables so that v = e1 and Γv = N0 , and compare the actions on R2
and H. Let γv ∈ Γv, and using Iwasawa decomposition, write
γ = rθ aγ us .
We can choose γ mod N0 so that us is bounded, and the condition kγvk ≤ R is equivalent
1
to yγ ≤ R, where aγ = diag yγ , yγ−1 . Now apply γ −1 to i. Since rθ preserves i, a−1
γ i = y 2 i,
γ

and us is bounded,
we see that γ −1 i is contained in a set AR which is an r-neighborhood

of the ray ti : t ≥ R−2 , for some r > 0 independent of R. The hyperbolic area of AR is
O(R2 ). On the other hand, since Γi ⊂ H is discrete and since G acts on H by isometries,
there is r > 0 small enough so that the balls of radius r around points of Γi are disjoint. So
the intersection of AR with Γi contains O(R2 ) points.

Corollary 3.3. The quantities in (2.2), (3.1) and (3.2) converge absolutely on {Re(s) > 1}
and converge uniformly on compact subsets of {Re(s) > 1}. For any ζ > 1, (2.2) and (3.1)
are bounded on {Re(s) ≥ ζ} by a bound which can be taken to be uniform as z and g vary
in a compact set. For fixed g, and for σ > 1,
ˆ T
1
E(g, σ + it) 2(σ+it)
N(g, R+ ) + N(g, R− )
=
lim
R
dt,
(3.9)
2
2π T →∞ −T
σ + it
where N(g, R+ ), N(g, R− ) denote the one-sided limits of N(g, R) as x → R.
Proof. The claim regarding (2.2), (3.1) and (3.2) follows easily from Proposition 3.2. For
instance, for (3.1), split the sum into sums over the ‘rings’



w ∈ Γv : kwk ∈ 2n , 2n+1

for n ∈ N.
For (3.9), fix g ∈ G and σ0 > 2, and define the function ψσ0 (τ ) = N(g, eτ )e−σ0 τ .
Then ψσ0 (τ ) has finitely many discontinuities on every bounded interval, with well-defined
one-sided limits, and vanishes when we take τ → −∞ (by discreteness of Y ). Also, by
Proposition 3.2, we have ψσ0 (τ ) = O(e(2−σ0 )τ ) as τ → ∞, and hence ψσ0 ∈ L2 (R) ∩ L1 (R).
Write
ˆ ∞
d
ψσ (τ )e−2πiuτ dτ
(u)
=
ψ
σ
0

0

−∞

for the Fourier transform of ψσ0 . Using (3.2) and making changes of variables R = eτ , 2s =
σ0 + 2πiu we have
E(g, s)
d
ψ
, where Re(s) > 1.
σ0 (u) =
2s
Then by Fourier inversion (see e.g. [Ter85, Ex. 1.2.7]), for all τ ∈ R we have
ˆ T
ψσ+0 (τ ) + ψσ−0 (τ )
2πiuτ
d
= lim
du,
ψ
σ0 (u)e
T →∞ −T
2

EFFECTIVE COUNTING FOR LATTICE ORBITS

11

and hence (with the changes of variables σ = σ0 /2, t = πu, R = eτ , s = σ + it)
ψ + (log R) + ψσ−0 (log R)
N(g, R+ ) + N(g, R− )
= Rσ0 σ0
2
2
ˆ T
ˆ T
E(g, σ + πiu) 2πiu
1
E(g, σ + it) 2(σ+it)
= lim
Rσ0
R
du =
lim
R
dt.
T →∞ −T
σ0 + 2πiu
2π T →∞ −T
σ + it

3.4. Selberg’s results: meromorphic continuation and functional equation. We
now move beyond elementary results and come to much deeper results about Eisenstein
series. Most of these results are due to celebrated work of Selberg, see [Se56, Se89, Hej83,
Kub73] (the introduction to [Se89] contains some historical notes). The proofs exploit the
dependence of E(z, s) on the variable z, and we content ourselves with two comments, in
order to clarify the connection with objects appearing in the preceding sections.
For s ∈ C, the functions f (x + iy) = y s clearly satisfy ∆f = s(1 − s)f , i.e. are eigenfunctions for the Laplace-Beltrami operator. Since ∆ is G-invariant, formula (3.1) shows
that for fixed s, the Eisenstein series also gives rise (at least formally) to a Laplace-Beltrami
eigenvector z 7→ Ei (z, s), thus furnishing a connection between the Eisenstein series and
the representation theory of G. Similarly, the functions g 7→ Ei (g, s)n defined in (3.7) are
eigenfunctions for the Casimir operator on G.
Also recall our normalization sending a cusp of Γ to ∞ so that the stabilizer group
becomes N0 . If Γ has one cusp then this means that z 7→ E(z, s) has a periodicity property
E(z, s) = E(u1 z, s) = E(z + 1, s).
P We can exploit this periodicity by developing E(z, s) =
E(x + iy, s) in a Fourier series m am (y, s)e2πimx . Furthermore,
P if Γ has more than one
cusp and i, j represent two of them, then z 7→ Ei (sj z, s) = m ai,j,m (y, s)e2πimx is also
1-periodic, and this leads to interesting relations between the functions ai,j,m .
We now turn to Selberg’s results. By Corollary 3.3, as an absolutely convergent series
of holomorphic functions, the functions s 7→ Ei (g, s) are holomorphic on {Re(s) > 1}. A
fundamental issue is to extend the functions to the entire plane, and here we have:
Theorem 3.4 (Selberg c. 1953). The functions s 7→ Ei (z, s) have a meromorphic contin1
, and all other
uation to the complex plane. There is a pole at s = 1 with residue covol(Γ)

1
1
poles with Re(s) ≥ 2 are contained in 2 , 1 (in particular there are no poles at s = 1/2).
All poles are simple.
The second basic result is an analytic continuation according to which one may recover the
values of Ei (g, ·) at s from the values at 1 − s. To state this we use the notation introduced
after Definition 2.2, and let Γ denote the classical Γ-function. For each 1 ≤ i, j ≤ k let

√ Γ s − 21 X −2s
(3.10)
ϕij (s) = π
|c| , Φ(s) = (ϕij (s))ki,j=1
Γ(s)


a b
where the sum ranges over distinct representatives
of double cosets in N0′ \si−1 Γsj /N0′
c d
with c 6= 0. The function ϕij has another definition in terms of the constant term in the
Fourier expansion of z 7→ Ei (sj z, s), see [Kub73, §2.2]. The matrix Φ(s) is sometimes called
the constant term matrix corresponding to Γ, and sometimes called the scattering matrix.
The poles of s 7→ Ei (z, s) with Re(s) ≥ 1/2 are also poles of Φ.
Theorem 3.5 (Selberg c. 1953). The matrix valued function Φ satisfies
Φ(s)Φ(1 − s) = Id,
and the column vector E(z, s) = (E1 , . . . , Ek ) satisfies
E(z, s) = Φ(s)E(z, 1 − s).

12

CLAIRE BURRIN, AMOS NEVO, RENE RÜHR, AND BARAK WEISS

3.5. Main term asymptotics and quadratic constant. As Veech noted, it is well-known
to number-theorists that the existence of a meromorphic continuation with a simple pole
at s = 1, already implies Theorem 1.1, part (c). To see this, recall the Wiener-Ikehara
Tauberian theorem (see e.g. [W46, Theorem 17]), which was developed in order to simplify
proofs of the prime number theorem, and states:
ψ : R+ → R+ is monotone non-decreasing, A ∈ R, and suppose the integral
´ ∞Suppose
−st
e
ψ(t)dt,
0
 where s =σ + iτ , converges for σ > 1 to a function f (s) which satisfies
A
exists, converges uniformly, and defines a uniformly bounded
that limσ→1+ f (s) − s−1
function in every interval τ ∈ [−a, a], for all a > 0. Then

ψ(t)
et

→t→∞ A.

To obtain part (c) of Theorem 1.1, suppose Γv is a discrete orbit for a nonuniform lattice
Γ corresponding the i-th cusp of Γ, and apply the Wiener-Ikehara theorem with A the
residue of Ei (g, s) at s = 1, and ψ(t) = N(g, et/2 ). The hypotheses of the Wiener Ikehara
theorem are justified by (3.2), a change of variables R = et/2 , and Theorem 3.4. Here
(
1
Γ does not contain -Id
(3.11)
A = covol(Γ)
2
otherwise
covol(Γ)
will be the quadratic growth constant cΓv provided v satisfies v = si e1 .
1
, but
Warning (continued): In [Vee89] the quadratic growth constant is given as covol(Γ)
the groups he considers do contain -Id. The discrepancy is due to the fact that Veech only
counts closed cylinders and saddle connections on surfaces, and each of these gives rise to
two holonomy vectors, depending on orientation.

Veech was not content with deriving Theorem 1.1(c) from known results about Eisenstein
series. In 1998 he reversed the logic, reproving the result using ergodic-theoretic ideas
introduced in [EMc93], and using this, obtained a continuation result for E(g, s). Namely
he showed that the limit lims→1 (s − 1)E(g, s) exists along any sequence approaching s = 1
nontangentially from {z ∈ C : Re(z) > 1}, and used this to provide an alternative derivation
of the formula (3.11) for the quadratic growth constant. See [Vee98, §16] for more details.
3.6. Θ-transform. Let Γ be a non-uniform lattice in G, and Γv a discrete orbit in the
plane. We will assume throughout this section that v corresponds to the i-th cusp of Γ and
is normalized so that v = si e1 . Putting different weights on different points on the plane
amounts to choosing f : R2 → C, and defining
X
Θf : G/Γ → C, Θf (gΓ) =
f (u).
u∈gΓv

We will refer to the map f 7→ Θf as the Θ-transform. Note that this definition extends
(3.1), in that g 7→ E (Γ,v) (g, s) = Θf (g) for f (u) = kuk−2s . As before we need to worry
about convergence issues, and we will assume for the moment that f has compact support
contained in R2 r {0}. Note that this is not satisfied for (3.1) and it will make the Θtransforms we consider easier to handle analytically. This will already be apparent in the
following proposition, in which we discuss the Θ-transform of smooth functions which have
a special form.

x
. With this notation we have the following extension of (3.5):
Write hR (x) = h R
Proposition 3.6. Let f : R2 r {0} → C be a smooth compactly supported function, let
ρ : R/2πZ → R+ be smooth, let ψ : R+ → C be smooth and compactly supported, and let
Ψ = Mψ be the Mellin transform of ψ as in (3.3). Let σ > 2 and denote by Θ the transform
associated with the orbit Γv corresponding to the i-th cusp of Γ, normalized so that v = si e1 .
Then:
(1) If f (u) = ψ(kuk) is purely radial, then
ˆ
 s
1
Rs ds.
Ψ(s)Ei g,
(3.12)
ΘfR (gΓ) =
2πi Re(s)=σ
2

EFFECTIVE COUNTING FOR LATTICE ORBITS

13




P
r
, and ρ(θ)s = n∈Z ρ̂n (s)einθ is the Fourier expansion
(2) Suppose f reiθ = ψ ρ(θ)
of ρs . Then
ˆ
 s
1 X
(3.13)
ΘfR (gΓ) =
Rs ds.
Ψ(s)ρ̂−n (s)Ei g,
2πi
2
n
n∈Z Re(s)=σ

(3) Suppose f splits into angular and radial parts as f reiθ = ψ(r)ρ(θ), and let ρ(θ) =
P
inθ
be the Fourier expansion of ρ. Then
n ρ̂n e
ˆ
 s
1 X
(3.14)
ΘfR (gΓ) =
Rs ds.
ρ̂−n
Ψ(s)Ei g,
2πi
2 n
Re(s)=σ
n∈Z

Proof. There is no need to prove (1) since
P it is the special
P case of (2) with ρ(θ) ≡ 1. We will
write the Fourier expansion ρ(θ)s = n ρ̂n (s)einθ as n ρ̂−n (s)e−inθ . The Fourier series
converges absolutely for each s since ρ is smooth, and the coefficients admit an upper bound
|ρ̂n (s)| ≤ 2π kρkσ∞ , where σ = Re(s).

(3.15)

More generally, applying integration by parts twice, we see that
(3.16)

|ρ̂n (s)| ≪

|s|2
,
n2

where the implicit constant depends on σ, kρk∞ , kρ′ k∞ , and kρ′′ k∞ . The Mellin transform
Mψ satisfies (MψR )(s) = Rs (Mψ)(s) and so by Mellin inversion
 
ˆ
1
y
=
ψR
Ψ(s)y −s Rs ρs ds.
ρ
2πi Re(s)=σ
Plugging this into the definition of ΘfR and writing each u as kukeiθu we obtain




ˆ
X
X
1
kuk
=
kuk−s ρ(θu )s  ds
Ψ(s)Rs 
ΘfR (gΓ) =
ψR
ρ(θu )
2πi Re(s)=σ
u∈gΓv
u∈gΓv


ˆ
X
X
1
=
Ψ(s)Rs
ρ̂−n (s) 
kuk−s e−inθu  ds
2πi Re(s)=σ
n∈Z
u∈gΓv


ˆ
X
1 X
Ψ(s)ρ̂−n (s)Rs 
kuk−s e−inθu  ds.
=
2πi
Re(s)=σ
n∈Z

u∈gΓv

To justify switching order of integration and summation in the first line use the quadratic
growth of the set gΓv (Proposition 3.2) and the assumption σ > 2. In the second line, use
also (3.15), and in the third line use Proposition 3.2, (3.16), and the fact that Ψ decays faster
than any polynomial along the line Re(s) = σ. Formula (3.13) now follows by plugging in
(3.7).
For (3), we have
X
ΘfR (gΓ) =
ρ(θu )ψR (kuk)
u∈gΓv

=

X

u∈gΓv

X

n∈Z

ρ̂−n e

−inθu

!

1
2πi

ˆ

Re(s)=σ

Ψ(s)Rs kuk−s ds



ˆ
X
X
1
ρ̂−n
Ψ(s)Rs 
kuk−s e−inθu  ds,
=
2πi
Re(s)=σ
n∈Z

u∈gΓv

and again we plug in (3.7), leaving it to the reader to justify changing the order of sums
and integrals.


14

CLAIRE BURRIN, AMOS NEVO, RENE RÜHR, AND BARAK WEISS

3.7. Additional properties. We will need the extensions of the results of §3.4 to twisted
Eisenstein series, and also some further properties. For convenience we collect all the results
we will need, including results already discussed above, in the following list.
Theorem 3.7. Let Γ be a nonuniform lattice in G with k cusps. Let si be the elements conjugating these cusps to ∞ as in the discussion preceding (2.2). Let Ei (z, s) (resp. Ei (z, s)2n )
denote the (twisted) Eisenstein series as in (2.2) (resp. (2.4)). Then there is a function
ω : R → R (see (A.1) for an explicit definition) such that the following hold:
(AC) The functions Ei (z, s)2n are absolutely convergent for Re(s) > 1, and for any ζ > 0,
they are uniformly bounded and uniformly convergent on sets of the form {Re(s) ≥
1 + ζ}.
(M) The functions s 7→ Ei (z, s)2n have a meromorphic continuation to all of C.
(P) The poles of s 7→ Ei (z, s)2n with Re(s) ≥ 1/2 are all simple, lie in (1/2, 1], and are
contained in the set (sℓ ) of poles of the constant term matrix Φ of (3.10).
(1) There is a pole at s = 1 if and only if n = 0, with residue covol(Γ)−1 .
(1/2) The functions Ei (z, s)2n have no poles on the line Re(s) = 1/2.
´T
(ω) For all t ∈ R, ω(t) ≥ 1, ω(−t) = ω(t) and for T ≥ 1, −T ω(t)dt ≪ T 2 , where
implicit constants depend on Γ.
p
(G1) If n ∈ Z, Re(s) ≥ 1/2 and |t| ≥ |n| + 1 then Ei (z, s)2n ≪ |t| ω(t), where t = Im(s)
(implicit constants depend on z and Γ but not on n or Re(s)).
´T
 2
(G1/2) For all n, −T Ei z, 12 + it 2n dt ≪ (T + |n|)2 (implicit constants depend on Γ).

Proof. For n = 0, all items are given in [Se89], see also [Hej83, Kub73]. The extension of the
first five properties to general n is given in [Kub73, Chapter 6] (see also [Sa81]). Property
(G1/2) is extended to arbitrary n by Marklof and Strömbergsson in [MS03] (in [MS03]
only the case of the integral over [0, T ] is discussed, but the proof extends verbatim to the
interval [−T, 0]). To the best of our knowledge, there is no presentation of property (G1)
for general n in the literature. We fill this gap in the appendix to this paper, see Theorem
A.1.

 4
4. A bound O R 3
The following is the main result of this section. It immediately implies Theorem 2.4.

Theorem 4.1. Suppose Γ is a lattice in G, Γv is a discrete orbit corresponding to the i-th
cusp of Γ, Ei (g, s) is the corresponding Eisenstein series, and s0 = 1 > s1 > · · · > sr > 1/2
are the poles of Ei (g, ·). Then there are c0 , . . . , cr such that
r
 4
X
2
N(g, R) = c0 R +
cℓ R2sℓ + O R 3 .
ℓ=1

at
Furthermore, if v is rescaled so that si e1 = v, then the cℓ are the residues of s 7→ Ei (g,s)
s
the poles sℓ . In particular, the quadratic growth constant c0 is given by formula (3.11).

The basic idea for the proof of Theorem 4.1 is a ‘contour shift’ argument, as follows.
We recall (3.5) and (3.9), which imply that for σ > 1, for a large parameter T , N(g, R) ≈
´T
1
R2(σ+it)
2π −T E(z, σ + it) σ+it dt. This is a path integral over the line segment Lσ,T = {σ + it :
t ∈ [−T, T ]} introduced in §3.1. Since s 7→ E(z, s) is meromorphic in all of C, the Cauchy
residue formula makes it possible to replace this path integral over Lσ,T with a path integral
over L1/2,T and the two horizontal segments H ± = {s ± iT : s ∈ [1/2, σ]}, taking into
account the residues in the rectangle bounded by these segments. We need to show that the
contribution of the integral over the segments H ± is negligible, compute the contribution
of the poles in the Cauchy formula, and evaluate the integral over L1/2,T . Each of these
steps presents difficulties as stated. To bypass them we recall that if χ = χ[0,1] denotes the
indicator function of [0, 1] and f (u) = χ(kuk) then N(g, R) = ΘfR (gΓ). We can justify the
contour shift argument if f is replaced by a smooth compactly supported approximation f (U)
(where U is an approximation parameter), and in this way, obtain bounds on the growth of

EFFECTIVE COUNTING FOR LATTICE ORBITS

15

Θf (U ) (gΓ) as R → ∞. To make use of this we bound the difference N(g, R) − Θf (U ) (gΓ)
R

R

as well as the differences in the residues of the sums for f and f (U) , and optimize the choice
of U as a function of R to make the combined error as small as possible.
In order to justify the contour shift we will need the following:
Proposition 4.2. Let E be a meromorphic function on C, let a < b, and let Ψ be a
holomorphic function defined in a neighborhood of {s ∈ C : a ≤ Re(s) ≤ b}, such that:
(i) E has finitely many poles (sℓ ) with Re(s) ∈ [a, b]. They are all simple poles, all on
the real line, and there are no poles at s = a and s = b.
(ii) There is a function ω : R → R satisfying
p the conclusions of Theorem 3.7 item (ω),
and such that for all |t| ≥ 1, |E(s)| ≪ ω(t) |t| (where t = Im(s)).
(iii) For any k > 0 there is C ′ such that for all σ ∈ [a, b],
C′
.
tk

|Ψ(σ + it)| ≤

(iv) For σ = a and σ = b, the integrals
ˆ ∞
(4.1)
E (σ + it) Ψ (σ + it) dt
−∞

converge absolutely.
Then
1
2πi

(4.2)

ˆ

E(s)Ψ(s)ds =

Re(s)=b

1
2πi

ˆ

E(s)Ψ(s)ds +

Re(s)=a

X

Ψ(sℓ )Res|s=sℓ (E)

ℓ

(where Res|s=s0 h(s) = lims→s0 (s − s0 )h(s)).

Proof. Let τ > 1, and consider the integral of E(s) Ψ(s) on the rectangle
We have
ˆ τ +1 ˆ
τ

a

Rτ = {s ∈ C : Re(s) ∈ [a, b], Im(s) ∈ [τ, τ + 1]}.
b

(iii)

E(σ + it)Ψ(σ + it) dσ dt ≪
(ii)

≪

1
τ3

ˆ

1
τ3

ˆ

τ

τ +1 ˆ b

τ +1

−(τ +1)

Cauchy-Schwarz

≪

a

|E(σ + iy)| dy dσ

p
ω(y) y dy

1
τ3

ˆ

τ +1

−(τ +1)

ω(y)dy

!1/2

τ 3/2

(ω)

≪ τ −1/2 −→τ →∞ 0.

Hence for each n ∈ N there is τn ∈ [n, n + 1] such that
ˆ b
(4.3)
E(σ + iτn )Ψ(σ + iτn ) dσ →n→∞ 0.
a

By the same argument, there are τ−n ∈ [−(n + 1), −n] such that (4.3) also holds with τ−n
instead of τn .
Since Ψ is holomorphic, and E holomorphic outside a set of finitely many poles, we
can now apply the Cauchy residue formula for the contour integral of E(s)Ψ(s) over the
boundary of the rectangle
{s ∈ C : Re(s) ∈ [a, b], Im(s) ∈ [τ−n , τn ]}.

The intergrals along the horizontal boundaries [a, b] × {τ±n } go to 0 as n → ∞, and the
integrals along the vertical boundaries {a, b} × [τ−n , τn ] tend to the integrals in (4.1). The
result follows.


16

CLAIRE BURRIN, AMOS NEVO, RENE RÜHR, AND BARAK WEISS

Proof of Theorem 4.1. Let β : R → [0, 1] be a smooth function satisfying

0 for x ≤ 0.1
β(x) =
1
for x ≥ 1

and for a parameter U > 2 let

β(U x)
x ≤ 1/2
−(U)
ψ
=
β(U (1 − x)) x ≥ 1/2

and ψ

+(U)

=



β(U x)
β(1 + U (1 − x))

x ≤ 1/2
.
x ≥ 1/2

Let χ denote the indicator function of [0, 1]. Our choices imply that ψ ±(U) are supported
on a compact subset of the positive real line and satisfy
1
x≥
=⇒ ψ −(U) (x) ≤ χ(x) ≤ ψ +(U) (x),
U
 


1
1
1
∪
1
−
=⇒ ψ −(U) (x) = χ(x) = ψ +(U) (x),
x
∈
/
0,
,
1
+
(4.4)
U
U
U

dℓ ψ ±(U)
=
O Uℓ .
sup
ℓ
dx
x∈R


±
. Then by (4.4) we have
We will define fR,U (u) = ψ ±(U) kuk
R


R
.
(4.5)
Θf − (gΓ) ≤ N(g, R) ≤ Θf + (gΓ) + N g,
R,U
R,U
U
We will obtain bounds for Θf ± (gΓ) using (3.12) and a contour shift argument, and then
R,U
combine this with (4.5) and optimize the choice of U = U (R) to obtain good bounds for
N(g, R). To simplify notation we omit the superscript ± from now, that is fR,U stands for
±
any one of fR,U
and Ψ(U) stands for the Mellin transform of any one of the ψ ±(U) .

Step 1. Dependence of the residues on the approximation parameter. Let c′ℓ be the residue
of s 7→ Ei (g, s) at s = sℓ , let cℓ be the residue of s 7→ Ei (g,s)
at s = sℓ and let cℓ (U ) be the
s

residue of s 7→ Ψ(U) (s)Ei g, 2s at s = 2sℓ . The c′ℓ are nonzero by (P) and the sℓ satisfy
c′ℓ
sℓ

and cℓ (U ) = 2c′ℓ Ψ(U) (2sℓ ). By (4.4), we have
ˆ 1
ˆ ∞
1
− Ψ(U) (2sℓ ) ≤
y 2sℓ −1 dy −
ψ (U) (y)y 2sℓ −1 dy
2sℓ
0
ˆ 0∞
(U)
≤
ψ (y) − χ(y) y 2sℓ −1 dy
0
!

ˆ
ˆ

sℓ > 1/2, and we have cℓ =

≤ 2

1+1/U

1/U

(4.4)

y

2sℓ −1

dy

1−1/U

0

and thus

y

dy +

2sℓ −1



=O

1
U



,


 
1
1
.
− Ψ(U) (2sℓ ) = O
2sℓ
U

´
Step 2. Bounding the integral over Re(s) = 1. We will bound Re(s)=1 Ψ(U) (s)Ei g, 2s Rs ds
in terms of R and U , and to this end we will bound


ˆ ∞
1 + it
(U)
R1+it dt.
Ψ (1 + it)Ei g,
I=
2
1

(4.6)

cℓ − cℓ (U ) = 2c′ℓ

We first prove that for all U ≥ 2,

(4.7)

|t| ≥ U =⇒ Ψ

(U)

(1 + it) = O

and
(4.8)

1 ≤ |t| ≤ U =⇒ Ψ

(U)



(1 + it) = O

U
|t|2




1
|t|



.

EFFECTIVE COUNTING FOR LATTICE ORBITS

17

Moreover we will establish such a bound for σ + it in place of 1 + it, where the implicit
constant is uniform as long as σ varies in a closed interval of positive reals. To see (4.7),
apply integration
by parts
twice, and use that ψ (U) and all its derivatives vanish for y ∈
/


1
1
1
0, U ∪ 1 − U , 1 + U , to obtain for s = σ + it:
ˆ ∞h
i′′
i′
h
y s+1
ys
dy
ψ (U) (y)
ψ (U) (y) dy =
s
s(s + 1)
0
0
ˆ 1+1/U h
ˆ 1/U h
i′′
i′′
y s+1
y s+1
=
ψ (U) (y)
ψ (U) (y)
dy +
dy
s(s + 1)
s(s + 1)
1−1/U
0





1
U
σ+1
2
=2
O U O
=O
,
U |t(t + 1)|
|t|2
ˆ

Ψ(U) (σ + it) =

∞

proving (4.7).
Now if 1 ≤ t ≤ U and U ≥ 2 then
Ψ

(U)

i′
h
ys
ψ (U) (y) dy
s
0
ˆ 1/U h
ˆ 1+1/U h
i′
i′
ys
ys
=
ψ (U) (y) dy +
ψ (U) (y) dy
s
s
0
1−1/U

 
  
1
1
1
=O
= 2σ+1 O(U ) O
O √
,
2
2
U
t
σ +t

(σ + it) =

(4.9)

ˆ

∞

proving (4.8).

and Ψ(t) for Ψ(U) (1 + it), this leads to
Writing E(t) for Ei g, 1+it
2
(4.10)

|I| ≤

ˆ

∞

1

"ˆ

Ψ(t)E(t)R1+it dt ≪ R

U

|Ψ(t)E(t)| dt +

1

ˆ

∞
U

|Ψ(t)E(t)| dt

#

and we bound each of these integrals separately. By assumption (G1/2) and CauchySchwarz, for 1 ≤ A ≤ B,
ˆ

(4.11)

B

A

|E(t)|dt ≤

s
ˆ

B

|E(t)|2 dt

A

s
ˆ

B

3

1 dt ≪ B 2 .

A

Hence, by a dyadic decomposition,
ˆ

U
1

(4.8)

|E(t)| |Ψ(t)| dt ≪
≤

ˆ

U

|E(t)|
dt
t

1

X

0≤k≪log U

(4.11)

≪

≪U

X

1
U/2k+1

0≤k≪log U
1
2

X

k≥0

k

ˆ

U/2k

U/2k+1

1
U/2k
1



2− 2 ≪ U 2 .

U
2k

 32

|E(t)|dt

18

CLAIRE BURRIN, AMOS NEVO, RENE RÜHR, AND BARAK WEISS

Similarly, in the range t ≥ U we have
ˆ ∞
ˆ
(4.7)
|E(t)| |Ψ(t)| dt ≪
U

∞

|E(t)|

U

≪U
(4.11)

X

k≥0

≪ U

≪U

1
2

U
dt
t2
ˆ 2k+1 U

1
(2k U )2

X

k≥0

X

k≥0

2k U

1
(2k U )2
k

|E(t)|dt

2k+1 U
1

2− 2 ≪ U 2 .

 32

Putting these estimates together we obtain


1
I = O RU 2 .

The bound on the ray {1 + it : t ≤ −1} is similar, and on the finite interval {1 + it : −1 ≤
t ≤ 1} the functions Ei and Ψ(U) are bounded independently of U . For the last claim, note
that the calculation in (4.9) holds also for 0 ≤ t ≤ 1, and the second to last equality there
implies boundedness. In total we find
ˆ
 s


1
Rs ds = O R U 2 .
Ψ(U) (s)Ei g,
(4.12)
2
Re(s)=1
Step 3. Justifying the contour shift. We want to show that for any R, U ,
(4.13)
ˆ
ˆ
 s
 s
X
Rs ds =
Ψ(U) (s)Ei g,
Rs ds,
cℓ (U )R2sℓ +
Ψ(U) (s)Ei g,
2
2
Re(s)=1
Re(s)=σ>2
ℓ

(U)

(U)

where Ψ
is the Mellin transform of ψ , the sum ranges over the poles (sℓ ) of Ei (g, ·),
and cℓ (U ) are the corresponding
residues. This follows from Proposition 4.2, with a = 1, b =

σ > 2, E(s) = Ei g, 2s , and Ψ(s) = Rs Ψ(U) (s). Note that by (3.8), for upper bounds as
needed for Proposition 4.2, it makes no difference if one works with the twisted Eisenstein
series in (2.4) or in (3.7). Hypotheses (i) and (ii) of Proposition 4.2 hold by Theorem 3.7,
(iii) follows by repeated integration by parts as in the proof of (4.7), and so we need to show
(iv). The case b = σ is trivial because t 7→ E(b + it) is bounded, and the case σ = 1 was
proved in Step 2. Thus (iv) holds.
P
Step 4. Combining bounds. Using (4.13) with a main term ℓ cℓ R2sℓ , and matching the
errors incurred in (4.6) and (4.12) gives an error estimate
max
ℓ

1
R2
R2sℓ
=
= RU2.
U
U

 4
This leads to a choice U = R and the combined error becomes O R 3 . This error is valid
2
3

−
+
when using either one of fR,U
and fR,U
. Proposition 3.2 implies that


 2
2
R
R
N g,
=O
= R3.
2
U
U

Thus appealing to (3.12) and (4.5) completes the proof.



Remark 4.3. We
 Ze’ev
 Rudnick for explaining to us how to replace our
 4aregrateful to
4
+ε
3
3
with O R . Specifically, Rudnick suggested the use of dyadic
earlier result O R
decomposition in Step 2.
Remark 4.4. Any improvement in the bound (G1/2) gives a corresponding improvement
in the error term. In fact, for the case Γ = SL2 (Z), or its principal congruence subgroups,
and n = 0, one can replace the term T 2 appearing
 right hand side of (G1/2) by
 in the

T . Using this, and modifying (4.7) to a bound O

1
|t|1+ε

in Step 2, yields an error term

EFFECTIVE COUNTING FOR LATTICE ORBITS

19

 4

O R1+ε for any ε > 0, in place of O R 3 . The recent papers [HX16] and [Nor19] contain
sup norm bounds for Eisenstein series for some arithmetic groups Γ which are not principal
congruence subgroups. These bounds lead to improvements for (G1/2), and using them,
4
one obtains a better estimate than R 3 in (1.2) for the discrete orbits arising in these cases.
5. More general shapes
5.1. Counting in smooth star shaped domains. We first state a more detailed version
of the first part of Theorem 2.6, for counting in a smooth star shape.
Theorem 5.1. Suppose Γ is a non-uniform lattice in G containing −Id, Y = Γv is a discrete
orbit corresponding to the i-th cusp, and suppose that for each n, Ei (z, s)n has trivial residual
spectrum. Let ρ : R → R+ be a smooth 2π-periodic function, S = {reiθ : 0 ≤ r ≤ ρ(θ)}, and
vol(S)
. Then for every ε > 0,
let cY,S = π covol(Γ)
 12 
|Y ∩ RS| = cY,S R2 + O R 7 +ε ,
where the implicit constant depends on ε and ρ.

Proof. The proof follows the same steps as in the proof of Theorem 4.1. We define the same

x
approximants ψ ±(U) of the indicator function of the unit interval, so that x 7→ ψ ±(U) ρ(θ)
are approximations of the indicator function of the interval [0, ρ(θ)], in the sense of (4.4).
Then we set


r
±
iθ
±(U)
,
fR,U (re ) = ψ
ρ(θ) R
so that in analogy with (4.5), we have
(5.1)

 2

R
maxθ ρ(θ)
≤ Θf + (gΓ) + O
.
Θf − (gΓ) ≤ |Y ∩ RS| ≤ Θf + (gΓ) + N g, R
R,U
R,U
R,U
U
U2
±
As before we continue with fR,U standing for one of the fR,U
and Ψ(U) standing for the
Mellin transform of one of the ψ ±(U) . Using (3.13) we have
ˆ
 s
1 X
(5.2)
ΘfR,U (gΓ) =
Ψ(U) (s)ρ̂−n (s)Ei g,
Rs ds (where σ > 2).
2πi
2 n
Re(s)=σ
n∈Z

Since we have assumed that −Id ∈ Γ, the terms corresponding to odd n all vanish. For each
n 6= 0, the functions s 7→ Ψ(U) (s)ρ̂−n (s)Ei g, 2s 2n are holomorphic on {s ∈ C : Re(s) ≥ 1}
by our assumption that all of the Ei (g, s)2n have trivial
residual spectrum and by (P) and

(1). For n = 0, the function s 7→ Ψ(U) (s)Ei g, 2s has a simple pole at s = 2, and by a
computation as in the proof of (4.6), the residue c0 (U ) satisfies
 
1
.
(5.3)
c0 − c0 (U ) = O
U
´ 2π
1
Here c0 = ρ̂0 (2) covol(Γ)−1 , and since ρ̂0 (s) = 2π
ρ(θ)2 dθ, computing the area of S in
0
Vol(S)
polar coordinates we obtain c0 = π covol(Γ) .
We now bound the integral of
 s
s 7→ h(U) (s)Ei g,
, where h(U) (s) = Ψ(U) (s)ρ̂−n (s),
2 n
along the critical line {Re(s) = 1}, by a bound depending on both U and n. Thus from now
on implicit constants may depend on ρ but not on n and U . We will use parameters k, λ, ε
which we will optimize further below.
For each k ≥ 0 we have
(5.4)

Ψ(U) (1 + it) ≪

Uk
,
|t|k+1

20

CLAIRE BURRIN, AMOS NEVO, RENE RÜHR, AND BARAK WEISS

and for each λ ≥ 0 and n 6= 0, we have
(5.5)

|ρ̂n (s)| ≪

|t|λ
, where s = 1 + it.
|n|λ

Indeed, we get (5.4) for |t| ≥ U by performing integration by parts ⌊k⌋ + 1 times (see (4.7)),
and for |t| ≤ U by applying integration by parts ⌊k⌋ times. The proof of (5.5) is similar.
Using this we have
ˆ

h(U) (s)Ei g, 2s n ds
(5.6)

Re(s)=1
ˆ ∞


U k tλ
dt
Ei g, 1+it
2
n
k+1
λ
t
|n|
1
2 !1/2
ˆ ∞
λ
Uk
t
≪
t1+ε/2 k+1
dt
|n|λ
t
1

≪

ˆ

∞
1

2
|Ei (g, 1+it
2 )n |
dt
t2+ε

!1/2

.

To ensure finiteness of the first integral we will assume that
(5.7)

2k > 2λ + 1 + ε.
´T
 2
dt, so that (G1/2) gives
For the second integral, we define H(T ) = 1 Ei g, 1+it
2
n
H(T ) ≪ (T + n)2 . Then integration by parts gives
 2
ˆ ∞
|
|E g, 1+it
2
n
dt ≪ |n|2 .
2+ε
t
1

Using these estimates in (5.6) gives
ˆ
 s
(5.8)
Ψ(U) (s)Ei g,
Rs ρ̂−n (s) ds ≪ |n|1−λ RU k ,
2 n
Re(s)=1

and the implicit constant depends on ε.
For each fixed n, the contour shift replacing the integral along Re(s) = σ with the integral
along the line Re(s) = 1 is justified by Proposition 4.2 (note that in condition (ii) of the
Proposition, the implicit constants are allowed to depend on E). We only pick up one
residue, corresponding to n = 0 and s = 2. Thus collecting estimates we get:
(5.9)
!
 2
 2
X


R
R
1−λ
2
O RU k = c0 R2 + O
+
+ O RU k ,
|n|
ΘfR,U (gΓ) = c0 R + O
U
U
n∈Z

where we set λ = 2 + ε to ensure convergence of the sum. Setting k = 52 + 2ε ensures (5.7),
1
and setting the two error terms equal to each other gives U = R k+1 , which also ensures that
that last term in (5.1) is negligible. Thus (5.9) becomes


7
ΘfR,U (gΓ) = c0 R2 + O R2−1/( 2 +2ε) ,
completing the proof.



Remark 5.2. 1. As before, any improvement in the dependence on n, of the bound (G1/2),
would lead to a corresponding improvement in the error estimate. For Γ = SL
and
 2 (Z)
5
principal congruence subgroups, this improvement leads to an error estimate O R 3 +ε .
2. We do not prove a version of Theorem 5.1 for lattices for which the twisted Eisenstein
series has nontrivial poles. If such poles
the contour shift argument,

P sℓ existed, in performing
one would need to analyze the sum n∈Z Res|s=sℓ Ei g, 2s 2n . As far as we are aware, this
series is only known to be summable in the sense of distributions, and thus analyzing it
leads to technical issues we prefer not to enter into.
3. The assumption −Id ∈ Γ ensured that we only need G(1/2) for n even, which is the
context in which it was proved in [MS03]. We are not aware of a proof of (G1/2) in the
literature for n odd.

EFFECTIVE COUNTING FOR LATTICE ORBITS

21

For the proof of Theorem 2.6 we will need another construction which interestingly is
also due to Selberg, see [M94, Chap. 1, §2].

Proposition 5.3. For each interval J ⊂ R and each V ∈ N there are trigonometric poly±
nomials P ± = PJ,V
such that
(1) For all x ∈ R,
P − (x) ≤ χJ (x) ≤ P + (x)
(where χJ is the indicator function of J);
(2) The degree of P ± is at most V ;
1
d
±
(3) for
 each
 0 < |k| ≤ V , the k-th Fourier coefficient satisfies |P k | ≪ k ; and
d
±
(4) P
− (c
χj ) ≪ 1 .
0

0

V

We now state a more detailed version of the second part of Theorem 2.6, for counting in
a sector.
Theorem 5.4. Suppose Γ is a non-uniform lattice in G, Y = Γv is a discrete orbit corresponding to the i-th cusp, and suppose that for each n, Ei (z, s)n has trivial residual spectrum.
. Let J ⊂ R be an interval of length |J| ≤ 2π, let S = {reiθ : 0 ≤ r ≤ 1, θ ∈ J}, and let
|J|
. Then
cY,S = 2π covol(Γ)
 8
(5.10)
|Y ∩ RS| = cY,S R2 + O R 5 ,
where the implicit constant depends on J.

Proof. We follow the same steps with the same notations, but now we introduce an additional
approximation parameter V , and let ρ±(V ) (θ) be approximations of the indicator function
χJ of J, namely they will satisfy
(5.11)

∀s ∈ R/2πZ, ρ−(V ) (θ) ≤ χJ (θ) ≤ ρ+(V ) (θ),

so that reiθ 7→ ρ±(V ) (θ)ψ ±(U) (r) are approximations of the indicator function of S. Then
we set
r
±
,
fR,U,V
(reiθ ) = ρ±(V ) (θ) ψ ±(U)
R
so that
 2
R
(5.12)
Θf − (gΓ) ≤ |Y ∩ RS| ≤ Θf + (gΓ) + O
.
R,U,V
R,U,V
U2
As before to lighten notation we omit the superscripts for upper and lower bounds. Using
(3.14) we have
ˆ
 s
1 X
ΘfR,U,V (gΓ) =
Rs ds,
ρ̂−n,V
Ψ(U) (s)Ei g,
2πi
2
n
Re(s)=σ
n∈Z

where ρ̂n,V is the nth Fourier coefficient of ρ(V ) and σ > 2.
For each n we perform a contour shift to shift the integral to the line {Re(s) = 1},
justifying it with Proposition 4.2. By our assumption on Γ, the only residue c0 (U, V ) that
|J|
, the residue
we need to take into account occurs for n = 0 at s = 2. Setting c0 = 2πcovol(Γ)
satisfies


1
|J|
(5.13)
c0 − c0 (U, V ) = O
+ ρ̂0,V −
.
U
2π
±
Motivated by this, for the functions ρ±(V ) we use the polynomials PJ,V
of Proposition 5.3
with U = V . With this choice (5.13) becomes
 
1
c0 − c0 (U, V ) = O
,
U
and we get a bound
X
X
1
1
|n|
+
≪ U.
|n||ρ̂n,V | ≪
U
n
n∈Z

0<|n|≤U

22

CLAIRE BURRIN, AMOS NEVO, RENE RÜHR, AND BARAK WEISS

We now repeat the arguments in Step 2 of the proof of Theorem 4.1 to obtain
ˆ
 s
1
Ψ(U) (s)Ei g,
Rs ds ≪ |n|RU 2 .
2 n
Re(s)=1

Note the explicit dependence on n which arises by using (G1/2) in (4.11).
Collecting estimates we get
 2


3
R
+ O RU 2 ,
ΘfR,U (gΓ) = c0 R2 + O
U

and equating the two error terms and plugging into (5.12) leads easily to (5.10).



5.2. Counting in well-rounded sets. In the present section we will prove Theorem 2.7,
using an argument based on a general lattice point counting result. In order to state it, we
recall the following:
Definition 5.5. ([GN12]) Let G be a connected Lie group with Haar measure mG . Assume
{Gt } ⊂ G is a family of bounded Borel sets of positive measure such that mG (Gt ) → ∞ as
t → ∞. Let Oη ⊂ G be the image of a ball of radius η (with respect to the Cartan-Killing
norm) in the Lie algebra under the exponential map. Denote
[
\
G+
u Gt v, G−
u Gt v.
t (η) = Oη Gt Oη =
t (η) =
u,v∈Oη

u,v∈Oη

The family {Gt } is Lipschitz well-rounded if there exist positive c, η0 , t0 such that for every
0 < η ≤ η0 and t ≥ t0 ,


−
mG G+
t (η) ≤ (1 + cη) mG Gt (η) .

Theorem 5.6. [GN12] Let G be any connected almost simple non-compact Lie group (e.g.
SL2 (R)), and let {Gt } be a Lipschitz well-rounded family of subsets of G. Let Γ be a lattice
in G, and let mG be Haar measure on G, normalized so that covol(Γ) = 1. Define the
corresponding averaging operators
ˆ
1
f (g −1 x)dmG (g), f ∈ L20 (G/Γ).
βt (f )(x) =
mG (Gt ) Gt
Suppose the βt satisfy the following (operator-norm) bound:
kβt kL2 (G/Γ) ≤ CmG (Gt )−κ .
0

Then the lattice point counting problem in Gt has the effective solution

κ
|Γ ∩ Gt |
= 1 + O mG (Gt )− dim G+1 .
mG (Gt )

The proof of Theorem 2.7 proceeds by reducing the problem of counting points in the
orbit Γv lying in bounded subsets of the plane, to counting lattice points in suitable bounded
domains in the group G = SL2 (R). The domains constructed in SL2 (R) bijectively cover
the domains in the plane, under the orbit map g 7→ gv, and will depend non-trivially on the
orbit under consideration, and not just on Γ.
In this section we write
 t/2

e
0
at =
.
0
e−t/2
Let v ∈ R2 r {0} and use polar coordinates in the plane to write g = rθv atv where v =
ge1 = rθv atv e1 = etv /2 rθv e1 . The stability group of v is N g = gN g −1 , and for any t, x and
θ,
(5.14)

1

rθ (gat g −1 )(gnx g −1 )(v) = rθ gat e1 = et/2 rθ v = e 2 (t+tv ) rθ+θv e1 .

This gives a bijective parameterization of R2 r {0} by R × [0, 2π), with each pair (t, θ) ∈ R ×
[0, 2π) determining a unique vector rθ gat e1 = et/2 rθ v in R2 r {0}. Since R2 r {0} = G/N g ,
we conclude that G = KAg N g , and this decomposition gives unique coordinates to each
point in G. Note however that this is not an Iwasawa decomposition, the latter being given
by G = K g Ag N g .

EFFECTIVE COUNTING FOR LATTICE ORBITS

23

Let us denote
At1 ,t2 = {at : t1 ≤ t ≤ t2 } , Nx1 ,x2 = {nx : x1 ≤ x ≤ x2 } and Kθ1 ,θ2 = {rθ : θ1 ≤ θ ≤ θ2 } .
Let D ⊂ R2 be a compact set in the Euclidean plane given in polar coordinates by
D = {ρ(cos θ, sin θ) : θ ∈ I , 0 ≤ ρ ≤ ρ(θ)}

where I = [θ1 , θ2 ] ⊂ [0, 2π] is an interval of angles contained in the unit circle, and ρ(θ) is
a positive Lipschitz continuous function on the interval I. The set D can also be written in
the form
D = {rθ at e1 : θ ∈ I , t ≤ 2 log ρ(θ)} ∪ {0}.
Let b′ > 0 be such that Γv contains no points of norm less than b′ . For any T ≥ 1 consider
as before the dilated set T · D = {T x : x ∈ D}, and also the set
DT = {rθ at e1 : θ ∈ I , 2 log b′ ≤ t ≤ 2 log(T ρ(θ))} .

Then DT = T · D r B(0, b′ ), and hence |Γv ∩ DT | = |Γv ∩ T · D|.
e T ⊂ G which bijectively cover DT . Fix a positive
We will now define bounded domains D

g
number x0 = x0 (g) so that the set N (x0 ) = gnx g −1 : 0 ≤ x < x0 is a fundamental
domain for the subgroup Γ ∩ N g ∼
= R. For each θ ∈ I define
= Z in the group N g ∼


T ρ(θ)
b′
= [t1 , t2 (T, θ)]
≤ t ≤ 2 log
J(T, θ) = t ∈ R : 2 log
kvk
kvk
and with respect to the decomposition G = KAg N g , define

e T = rθ−θv gat g −1 : θ ∈ I, t ∈ J(T, θ) · N g (x0 ) .
D

Then, as the reader may verify using (5.14), the orbit map G → R2 , g 7→ gv, restricted
e T , is a bijection with its image Γv ∩ DT , and as a consequence we obtain:
to Γ ∩ D

e T |.
Lemma 5.7. |Γv ∩ T · D| = |Γ ∩ D

e T } is
To complete the proof of Theorem 2.7, it remains to prove that the family {D
Lipschitz well-rounded. It will be convenient to use the following two facts.
We will need the following result:

Lemma 5.8. (see [GN12]) If {Gt } is a Lipschitz well-rounded family of subsets of G,
then for each g, h ∈ G, so are the families {gGt }, {Gt g} and {gGt h}. Furthermore the
corresponding constants c, t0 , η0 are bounded above and away from zero, as g varies on a
compact set Q in G.
It therefore suffices to prove that the sets
e T g = {rθ−θv gat nx : θ ∈ I, t ∈ J(T, θ), 0 ≤ x < x0 }
D

are Lipschitz well-rounded. Recalling that g = rθv atv and setting T = eτ , we have
e T g = Cτ = {rθ at+tv nx : θ ∈ I, t ∈ J(eτ , θ), 0 ≤ x < x0 } .
D

The Iwasawa coordinates K × A × N → G given by (k, a, n) 7→ kan satisfy the following
Lipschitz property, established in [HoN17, Prop. 4.4]. For every fixed S0 ∈ R, there exist
C1 = C1 (S0 ) > 0 and η1 = η1 (S0 ) > 0, such that for all θ, all x with 0 ≤ x ≤ x0 , and all
t ≥ S0 , 0 < η < η1 :
(5.15)

Oη rθ at nx Oη ⊂ Kθ−C1η,θ+C1 η At−C1 η,t+C1 η Nx−C1 η,x+C1 η .

Let S0 = 2 log b′ , let C1 = C1 (S0 ), and let C = C1 L, where L is Lipschitz constant of the
function ρ. Finally for


η1 θ2 − θ1 x0
,
,
,
η < min
4C
4C
4C
let

W − (τ, η) = kan : k ∈ Kθ1 +Cη,θ2 −Cη , a ∈ At1 +Cη,t2 (eτ ,θ)−Cη , n ∈ NCη,x0 −Cη .

Applying (5.15) to g ∈ W − (τ, η) it follows readily that W − (τ, η) ⊂ Cτ− (η). A straightforward
verification, using the explicit form of Haar measure in Iwasawa coordinates and the fact

24

CLAIRE BURRIN, AMOS NEVO, RENE RÜHR, AND BARAK WEISS

that ρ is Lipschitz, shows that mG (W − (τ, η)) ≥ (1 − c1 η) · mG (Cτ ), for a suitable c1 > 0.
In the other direction, note that Ct+ (η) = Oη Ct Oη is contained in

W + (τ, η) = kan : k ∈ Kθ1 −Cη,θ2 +Cη , a ∈ At1 −Cη,t2 (eτ ,θ)+Cη , n ∈ N−Cη,x0 +Cη ,

where for θ ∈ [θ1 −Cη, θ1 ]∪[θ2 , θ2 +Cη] we define t2 (eτ , θ) = max(t2 (et , θ1 ), t2 (et , θ2 )). Again
a similar direct verification shows that mG (W + (τ, η)) ≤ (1 + c2 η) · mG (Cτ ). The Lipschitz
well-roundedness of the family Cτ follows, and this completes the proof of Theorem 2.7. 
Remark 5.9.
(1) Let us note that an error estimate established for the count in the
dilates R · S of any given figure (in the plane, say), immediately implies an error estimate for the count in shells of shrinking width, namely with the sets R ·
S r (R − R−α ) · S for a suitable range of positive parameters α. Similarly it is
also
possible to intersect shells with sectors of shrinking angle, namely with sets

r(cos θ, sin θ) : θ ∈ [θ0 − R−β , θ0 ], r ∈ R+ , for a suitable range of positive parameters β, and obtain an effective estimate. This follows from the fact that Theorem 5.6
allows counting in a variable family of domains, provided that their Lipschitz wellroundedness parameters are controlled.
(2) A straightforward modification of the proof of Theorem 2.7 applies to counting in
discrete orbits of non-uniform lattices in SL2 (C) acting linearly on C2 , as well as
discrete orbits of non-uniform lattices in SO0d (n, 1) acting linearly on Rn+1 . This
is based on Theorem 5.6 and the Lipchitz property of the Iwasawa decomposition,
established in [HoN17] for any non-exceptional group of real rank one.
Appendix A. The growth estimate (G1) for general n, and the function ω(t)
An important input to our argument is the estimate (G1) which is used to bound the
average growth of the Eisenstein series along vertical lines Re(s) = σ, for σ ∈ [1/2, 1]. This
is a crucial input to our method, see condition (ii) of Proposition 4.2. This growth estimate
was proved by Selberg for n = 0 but as far as we are aware, does not appear in the literature
for the twisted Eisenstein series for general n. In this appendix we close this gap in the
literature, and also provide estimates of the dependence of the implicit constant on n. Many
of our arguments are based on ideas in [CS80, Sa81].
We first introduce standard notation. Let Φ(s) = (ϕij (s))ij be the constant term matrix
as in (3.10), let (sℓ ) denote all the poles of the functions ϕij in the interval [1/2, 1], let
q = qΓ > 0 be a real number specified by Selberg (see [Se89, p. 655]) and set

′ 
Y s − sℓ
Ψ∗ 1
Ψ0 (s), ω(t) = 1 − ∗
+ it .
(A.1) Ψ0 (s) = det Φ(s), Ψ∗ (s) = q 2s−1
s − 1 + sℓ
Ψ
2
ℓ

The function ω : R → R thus defined is the function appearing in Theorem 3.7. It satisfies
ω(t) > 1 for all t (see [Se89, p. 656]).
Theorem A.1. For any non-uniform lattice Γ in G, the twisted Eisenstein series Ei (·)n
corresponding to the i-th cusp as in (3.7) satisfies
p
1
(A.2)
Res ≥ , |t| ≥ |n| + 1 =⇒ Ei (z, s)2n ≪ |t| ω(t) (where t = Im(s)),
2
where implicit constants depend on Γ and z (but not on n).

Proof. We will divide the proof into a series of steps. Throughout the proof we will write
1
σ = Re(s), t = Im(s), and ε = σ − ,
2


and will assume
σ ∈ 21 , 23 , which entails no loss of generality as Ei (z, ·)2n is uniformly

bounded on s : Re(s) ≥ 23 . Implicit constants in the ≪ and O notation depend on Γ and
z (and not on n or σ). Since some of our arguments will depend on the dependence of the
Eisenstein series on the variable z, from now on we will write z0 instead of z and consider
it as a fixed element of H.

EFFECTIVE COUNTING FOR LATTICE ORBITS

25

Step 1. Bounding Φ and the Γ-factor. Let Φ(s) = (ϕij (s))i,j be the constant term matrix
as in (3.10). By [Se89, p. 655], Φ is uniformly bounded as long as 21 ≤ σ ≤ 23 and |t| ≥ 1.
Following [Kub73, Chapter 6], define
Φ2n (s) = (ϕij (s)2n )i,j

Φ2n (s) = (−1)n BN (s)Φ(s),

by

where
Bn (s) =
Then
(A.3)

Γ(s)2
.
Γ(s − n)Γ(s + n)

|t| ≥ 1, σ ≤ 1 =⇒ |Bn (s)| ≤ 1,

with equality for σ =

1
2,

and

(A.4)

|t| ≥ |n|

1 − |Bn (s)|2 ≪ ε.

=⇒

To see this, since Bn (s) = B−n (s) we can assume that n > 0. Using the recurrence
formula Γ(z + 1) = zΓ(z) one obtains
(A.5)

Bn (s) =

n
2
Y
Γ(s − n)2 ((s − 1) . . . (s − n))
s−k
=
.
2
(s − n) . . . (s + n − 1)Γ(s − n)
s+k−1
k=1

1
2.

1
2,

|s − k| ≤ |s + k − 1| with equality when σ =
This implies (A.3).
Since σ ≥
For (A.4), set zs,k = s + k − 1 = k − 12 + ε + it. Plugging into (A.5) gives

n 
n
2
Y
Y
|zs,k |2 − 4εRe(zs,k ) + 4ε2
−zs,k + 2ε
=
|Bn (s)|2 =
zs,k
|zs,k |2
k=1
k=1
 Y

N 
n 
Y
2k − 1
Re(zs,k ) − ε
1
−
2ε
=
.
1 − 4ε
=
|zs,k |2
|zs,k |2
k=1

k=1

Write
n

f (k) =

X

2k − 1
, so that F (n) =
log(1 − 2εf (k)) = log |Bn (s)|2 .
2
|zs,k |
k=1

Let k ≤ n and |t| ≥ n, then f (k) ≤
x 7→ log(1 − x) we have
and hence

k
n2 .

Taking a second order Taylor approximation for


− log(1 − 2εf (k)) = 2εf (k) + O ε2 f (k)2 ,

−F (n) ≪

n
X

k=1

εf (k) + ε2 f (k)2 ≪ ε

n
X
k
≪ ε.
n2
k=1
x

Now by second order Taylor approximation for x 7→ 1 − e we get
1 − |Bn (s)|2 = 1 − eF (n) ≪ −F (n) ≪ ε,
and we have shown (A.4).

Step 2. Regularized Eisenstein Series. We choose a parameter Y depending on z0 by
(A.6)

Y = 1 + max Im(s−1
j z0 ),
j

and define a regularized Eisenstein series
(A.7)

Ei (z, s)2n − δij yjs − ϕij (s)2n yj1−s
Y
Ei (z, s)2n =
Ei (z, s)2n

if yj = Im(s−1
j z) ≥ Y for some j
otherwise

26

CLAIRE BURRIN, AMOS NEVO, RENE RÜHR, AND BARAK WEISS

(note that the condition yj ≥ Y can occur for at most one index j). Let E Y (z, s)2n =
tr
E1Y (z, s)2n , . . . , EkY (z, s)2n . Then (see e.g. [Sa81, p. 727]) for σ > 21 , t 6= 0 we have the
following inner product formula:
ˆ
tr
E Y (z, s)2n E Y (z, s)2n dµΓ (z)
XΓ

tr

=

 Φ (s) Y 2it − Φ (s)Y −2it
tr
1  2ε
2n
2n
Y Idk×k −Φ2n (s)Φ2n (s) Y −2ε +
.
2ε
2it

´
2
2
Step 3. Trace of Maass-Selberg Relations. Let EjY (·, s)2n 2 = XΓ EjY (z, s)2n dµΓ (z),
P
kΦ2n (s)k2 = ij |ϕij (s)2n |2 , and set Ψ2n (s) = det Φ2n (s). Then for σ > 12 , t 6= 0 we have
(A.8)

k
X

EjY (·, s)2n

2
2

j=1


1
1
kY 2ε − kΦ2n (s)k2 Y −2ε +
=
2ε
2it

Y

2it

k
X
i=1

ϕii (s)2n − Y

−2it

k
X

ϕii (s)2n

i=1

!

.

Indeed, this is a matrix computation that involves taking the trace of the inner product
formula. See [Iwa95, p. 140] for the computation in case n = 0.
Step 4. Bounds on traces and norms. For n = 0 and |t| ≥ 1 we have
(A.9)
and for n ∈ N, σ ∈
(A.10)

1

3
2, 2



k − kΦ(s)k2 ≪ ε ω(t),
and |t| ≥ n we also have
k − kΦ2n (s)k2 ≪ ε ω(t).

Indeed, (A.9) is proved in [Se89, p. 657], and since
kΦ2n (s)k2 = |Bn (s)|2 kΦ(s)k2 ,
(A.10) follows from (A.9), the boundedness
of
 Φ, and (A.4).

As to L2 bounds, for n ∈ Z and σ ∈ 12 , 32 we have
(A.11)

EjY (·, s)2n

2
2

≪ ω(t),

±2ε
where the implicit constant depends also on Y , and hence on z0 . . For this
=
 1 we
use Y
3
1 + OY (ε). Using (A.3) we have that Φ2n (s) is uniformly bounded for σ ∈ 2 , 2 , and hence
the right hand summand in (A.8) is bounded. For the left hand summand, we have by
(A.10)



1
1
kY 2ε − Y −2ε kΦ2n (s)k2 =
k − kΦ2n (s)k2 + OY (ε) = OY (ω(t) + 1).
2ε
2ε

Combining bounds and recalling ω(t) > 1 gives (A.11) for σ >
in (A.11) is independent of σ we can take a limit and get the

a
Step 5. Convolution and point-pair invariant. For γ =
c
let
(cz + d)2n
εγ (z)2n =
.
|cz + d|2n

1
2.

Since the implicit constant
same bound for σ = 21 .

b
∈ Γ, n ∈ Z≥0 and z ∈ H,
d

Say a function f on H is of weight 2n if it transforms like f (γz) = εγ (z)2n f (z), and denote
the automorphic functions, whose restriction to a Dirichlet fundamental domain for Γ on H

EFFECTIVE COUNTING FOR LATTICE ORBITS

27

is in L2 (XΓ , µΓ ), by L2 (Γ, 2n). For δ ∈ (0, 1), let χδ be the indicator function of [0, δ] , and
for z, w ∈ H define
|z − w|2
4 Imz Imw
(w − z)2n
H(z, w) =(−1)n
|w − z|2n
k(z, w) = kδ (z, w) =H(z, w)χδ (u(z, w))
X
K(z, w) = Kδ (z, w) =
kδ (z, γw)εγ (z)2n .
u(z, w) =

γ∈Γ

Functions such as k are called point pair invariants of weight 2n. They satisfy (see [Hej83,
Vol. 1, Prop. 2.11]) the following transformation rules:
H(γz, γw) = εγ (z)2n H(z, w)εγ (w)−2n
k(γz, γw) = εγ (z)2n k(z, w)εγ (w)−2n .
The operator Lk defined by
(A.12)

Lk f (z) =

ˆ

k(z, w)f (w)dw =

ˆ

K(z, w)f (w)dw,

H/Γ

H

is a bounded self-adjoint operator on L2 (Γ, 2n), see [Hej83, Vol. 1, Prop 2.13]. Let ∆ be as
in (2.1), and let
∂u
∆n u(z) = ∆u(z) + iny (z) (where z = x + iy)
∂x
be the weighted Laplacian. Then the Eisenstein series z 7→ Ei (z, s)2n is a ∆2n -eigenfunction
and therefore (see [Hej83, Vol. 1, Prop. 2.14]) is an eigenfunction for Lk , that is there is
hi,n,δ (s) such that for all z ∈ H, Lk Ei (z, s)2n = hi,n,δ (s)Ei (z, s)2n .
Step 6. Bounding the eigenvalue. The eigenvalue hi,n,δ (s) satisfies a bound


1
1 3
1
(A.13)
σ∈
, |t| ≥ |n| + 1, δ =
=⇒ |hi,n,δ (s)| ≫ 2 .
,
2
2 2
100|t|
|t|
Indeed, the bound (A.13)
 is proved in [MS03, Lemma 2.1] for σ =
through for general σ ∈ 12 , 32 .

1
2,

and the proof goes

Step 7. Pointwise bounds. We now note that our choice (A.6) implies that
Lk EiY (z0 , s)2n = Lk Ei (z0 , s)2n .

(A.14)

Indeed, considering (A.7) and the definitions of δ and u we see that EiY (w, s)2n and
Ei (w, s)2n coincide for all w in the neighborhood of z0 consisting of the points for which the
integrand in (A.12) is nonzero.
To conclude the proof of (A.2), we apply Cauchy-Schwartz to find
1
1
(A.14)
Lk EiY (z0 , s)2n
|Lk Ei (z0 , s)2n | =
|hi,n,δ (s)|
|hi,n,δ (s)|
ˆ
(A.13)
≪ |t|2
Kδ (z0 , w)EiY (w, s)2n dw

|Ei (z0 , s)2n | =

H/Γ

p
ω(t)
≪ |t|

(A.11)

2

sˆ

H/Γ

2

|Kδ (z0 , w)| dw ≪ |t|2

√
p
p
ω(t) δ ≪ |t| ω(t).


28

CLAIRE BURRIN, AMOS NEVO, RENE RÜHR, AND BARAK WEISS

References
[AG13] A. Avila and S. Gouëzel, Small eigenvalues of the Laplacian for algebraic measures in moduli space,
and mixing properties of the Teichmüller flow, Ann. Math. 178 (2013) 385–442.
[AGY06] A. Avila, S. Gouëzel, and J-C. Yoccoz, Exponential mixing for the Teichmüller flow, Publ. Math.
Inst. Hautes Études Sci., (104):143–211, 2006.
[Be11] N. Bergeron, The spectrum of hyperbolic surfaces, Universitext, Springer (2011).
[BM10] I. Bouw and M. Möller, Teichmüller curves, triangle groups, and Lyapunov exponents, Ann. of
Math. (2) 172 (2010), no. 1, 139–185.
[CS80] P. Cohen and P. Sarnak, Notes on the Selberg trace formula, unpublished notes (1980), available at
https://publications.ias.edu/sarnak/paper/496
[Dav80] H. Davenport, Multiplicative number theory, second edition, Springer (1980).
[DRS93] W. Duke, Z. Rudnick, and P. Sarnak. Density of integer points on affine homogeneous varieties.
Duke Math. J., 71(1):143–179, 1993.
[EM01] A. Eskin and H. Masur, Asymptotic formulas on flat surfaces, Ergodic Theory Dynam. Systems
21(2) 443–478 (2001).
[EMc93] A. Eskin and C. T. McMullen, Mixing, counting and equidistribution in Lie groups, Duke Math.
J. 71 (1993), no. 1, 181–209.
[Go83] A. Good, Local analysis of Selberg’s trace formula, Springer Lecture Notes 1040 (1983).
[GN12] A. Gorodnik and A. Nevo, Counting lattice points. Journal für die reine und angewandte Mathematik, 663:127-176, 2012.
[GJ00] E. Gutkin and C. Judge, Affine mappings of translation surfaces: geometry and arithmetic, Duke
Math. J. 103 (2000), no. 2, 191–213.
[Hej83] D. Hejhal, The Selberg trace formula, Volume 1, 2. Springer Lecture Notes, 1983.
[Hoo13] W. P. Hooper, Grid graphs and lattice surfaces, IMRN 12 (2013) 2657–2698.
[HoN17] T. Horesh and A. Nevo, Horospherical coordinates of lattice points in hyperbolic spaces: effective
counting and equidistribution, preprint (2016) https://arxiv.org/abs/1612.08215
[HX16] B. Huang and Z. Xu, Sup norm bounds for Eisenstein series, preprint (2016)
https://export.arxiv.org/pdf/1508.02799v3
[HN96] M. N. Huxley and W. G. Nowak, Primitive lattice points in convex planar domains, Acta Arith.
LXXVI (1996) 271–283.
[IKKN06] A. Ivić, E. Krätzel, M. Kühleitner and W. G. Nowak, Lattice points in large regions and related
arithmetic functions: Recent developments in a very classic topic, Elementare und analytische Zahlentheorie, Schr. Wiss. Ges. Johann Wolfgang Goethe Univ., Frankfurt am Main, 20 (2006), 89–128.
[Iwa95] H. Iwaniec, Introduction to the spectral theory of automorphic forms. Biblioteca de la
Revista Matematica Iberoamericana, Madrid, 1995.
[Kub73] T. Kubota, Elementary theory of Eisenstein series. Wiley & Sons, New York (1973).
[MS03] J Marklof and A. Strömbergsson, Equidistribution of Kronecker sequences along closed horocycles,
Geom. and Func. Ana. 13 (2003) 1239–1280.
[MT02] H. Masur and S. Tabachnikov, Rational billiards and flat structures, in Handbook of dynamical
systems, Vol. 1A, 1015–1089. North-Holland, Amsterdam, 2002
[M94] H. L. Montgomery, Ten lectures on the interface between analytic number theory and
harmonic analysis, AMS CBMS Lecture series 84 (1994).
[Ne17] A. Nevo Equidistribution in measure-preserving actions of semisimple groups: case of SL2 (R)
preprint (2017), Math. arXiv:1708.03886
[NRW17] A. Nevo, R. Rühr and B. Weiss, Effective counting on translation surfaces, preprint (2017).
[Nor19] A. C. Nordentoft, Hybrid subconvexity for class group L-functions and uniform sup norm bounds
of Eisenstein series, preprint (2019) https://arxiv.org/pdf/1903.03932.pdf
[P11] H. Poincaré, Fonctions modulaires et fonctions fuchsiennes, Ann. Fac. Sc. Toulouse (1911), 125–149.
[Sa80] P. Sarnak, Prime geodesic theorems, Stanford University Ph.D. dissertation (1980).
[Sa81] P. Sarnak, Asymptotic behavior of periodic orbits of the horocycle flow and Eisenstein series. Comm.
Math. Phys. (1981), 719–739.
[Sa03] P. Sarnak, Spectra of hyperbolic surfaces, Bull. Amer. Math. Soc. 40 Number 4 (2003) 441–478.
[Se56] A. Selberg, Harmonic analysis and discontinuous groups in weakly symmetric Riemannian spaces
with applications to Dirichlet series, J. Indian Math. Soc 20 (1956) 47–87.
[Se89] A. Selberg, Harmonic analysis: Göttingen lecture notes in Collected works, Springer (1989).
[Ter85] A. Terras, Harmonic analysis on symmetric spaces and applications, Vol. 1 (1985) Springer
Verlag.
[Vee89] W. A. Veech, Teichmüller curves in moduli space, Eisenstein series and an application to triangular
billiards, Invent. Math. 97 (1989), 553–583.
[Vee92] W. A. Veech, The billiards in a regular polygon, Geom. Funct. Anal. 2 (1992) 341–379.
[Vee98] W. A. Veech, Siegel measures, Ann. of Math.(2), 148(3): 895–944, 1998.
[Vor96] Y. B. Vorobets, Planar structures and billiards in rational polygons: the Veech alternative, (Russian) Uspekhi Mat. Nauk. 51 (1996) 3–42; translation in Russian Math. Surveys 51 (1996) 779–817.
[W46] D. V. Widder, The Laplace transform, Princeton Univ. Press (1946).

EFFECTIVE COUNTING FOR LATTICE ORBITS

29

[Wr13] A. Wright, Schwarz triangle mappings and Teichmüller curves: the Veech-Ward-Bouw-Möller
curves, Geom. Func. Anal. 23 (2013) 2, 776-–809.
[Z82] P. Zograf, Fuchsian groups and small eigenvalues of the Laplace operator, translated from Zap. Nauch.
Sem. Leningrad. Otdel. Mat. Ins. Steklova 122 24–29 (1982).
[Z06] A. Zorich, Flat surfaces, In Frontiers in number theory, physics, and geometry. Vol. I, pages
437–583. Springer, Berlin, 2006.
put address here
E-mail address: put email here
Department of Mathematics, Technion
E-mail address: put email here
Department of Mathematics, Tel Aviv University, Tel Aviv, Israel
E-mail address: put email here
Department of Mathematics, Tel Aviv University, Tel Aviv, Israel
E-mail address: barakw@post.tau.ac.il

