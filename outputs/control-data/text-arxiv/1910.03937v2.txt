arXiv:1910.03937v2 [stat.ML] 12 Nov 2020

New and Explicit Constructions of Unbalanced Ramanujan
Bipartite Graphs
Shantanu Prasad Burnwal and Kaneenika Sinha and M. Vidyasagar

∗

November 13, 2020

Abstract
The objectives of this article are three-fold. Firstly, we present for the first time explicit
constructions of an infinite family of unbalanced Ramanujan bigraphs. Secondly, we revisit some
of the known methods for constructing Ramanujan graphs and discuss the computational work
required in actually implementing the various construction methods. The third goal of this
article is to address the following question: can we construct a bipartite Ramanujan graph with
specified degrees, but with the restriction that the edge set of this graph must be distinct from
a given set of “prohibited” edges? We provide an affirmative answer in many cases, as long as
the set of prohibited edges is not too large.

MSC Codes: Primary 05C50, 05C75; Secondary 05C31, 68R10

1

Introduction

A fundamental theme in graph theory is the study of the spectral gap of a regular (undirected)
graph, that is, the difference between the two largest eigenvalues of the adjacency matrix of such a
graph. Analogously, the spectral gap of a bipartite, biregular graph is the difference between the
two largest singular values of its biadjacency matrix (please see Section 2 for detailed definitions).
Ramanujan graphs (respectively Ramanujan bigraphs) are graphs with an optimal spectral gap.
Explicit constructions of such graphs have multifaceted applications in areas such as computer
science, coding theory and compressed sensing. In particular, in [1] the first and third authors
show that Ramanujan graphs can provide the first deterministic solution to the so-called matrix
completion problem. Prior to the publication of [1], the matrix completion problem had only a
probabilistic solution. The explicit construction of Ramanujan graphs has been classically well
studied. Some explicit methods are known, for example, by the work of Lubotzky, Phillips and
Sarnak [2], Li [3], Morgenstern [4], Gunnells [5], Bibak, Kapron and Srinivasan [6]. These methods draw from concepts in linear algebra, number theory, representation theory and the theory
SPB is pursuing his Ph.D. in Electrical Engineering at the Indian Institute of Technology Hyderabad; email:
ee16resch11019@iith.ac.in. KS is with the Department of Mathematics, Indian Institute of Science, Education, and
Research (IISER), Pune; email: kaneenika@iiserpune.ac.in. MV is with the Department of Electrical Engineering at
the Indian Institute of Technology Hyderabad; email: M.Vidyasagar@iith.ac.in. The first author was supported by a
Ministry of Human Reseource Development (MHRD), Government of India. The second author was supported by a
MATRICS grant from the Science and Engineering Research Board (SERB), Department of Science and Technology,
Government of India. The third author was supported by a SERB National Science Chair, Government of India.
∗

1

of automorphic forms. In contrast, however, no explicit methods for constructing unbalanced Ramanujan bigraphs are known. There are a couple of abstract constructions in [7, 8], but these are
not explicit.1
This article has three goals.
1. [Explicit construction of unbalanced Ramanujan bigraphs] First and foremost, we
present for the first time explicit constructions of an infinite family of unbalanced Ramanujan bigraphs. Our construction, presented in Section 3, is based on “array code” matrices
from LDPC (low density parity check) coding theory. Apart from being the first explicit
constructions, they also have an important computational feature: the biadjacency matrices
are obtained immediately upon specifying two parameters, a prime number q and an integer
l ≥ 2.
2. [Comparison of computational aspects of known constructions] The second goal of
this article is to revisit some of the earlier known constructions of Ramanujan graphs and
(balanced) bigraphs and compare the amount of work involved in constructing the various
classes of graphs and obtaining their adjacency or biadjacency matrices. We also focus on
the two earlier-known constructions of Ramanujan bipartite graphs due to Lubotzky-PhillipsSarnak [2] and Gunnells [5] and show that each can be converted into a non-bipartite graph.
Note that every graph can be associated with a bipartite graph, but the converse is not true
in general. Also, the research community prefers non-bipartite graphs over bipartite graphs.
Thus, our proof that the LPS and Gunnells constructions can be converted to non-bipartite
graphs is of some interest. All of this is addressed in Section 4.
3. [Construction of Ramanujan graphs with prohibited edges] The third goal of this
article is to address the following question: can we construct a bipartite Ramanujan graph
with specified degrees, but with the restriction that the edge set of this graph must be distinct
from a given set of “prohibited” edges? The approach that we follow to answer this question
is to start with an existing Ramanujan bigraph, and then to perturb its edge set so as to
eliminate the prohibited edges and replace them by other edges that are non prohibited.
This procedure retains the biregularity of the graph. We then show that our replacement
procedure also retains the Ramanujan nature of the bigraph, provided the gap between the
second largest singular value of the biadjacency matrix and the “Ramanujan bound” is larger
than twice the maximum number of prohibited edges at each vertex. These questions are
studied in Section 7.

1.1

Organization of paper

This article is organized as follows. In Section 2, we present a brief review of Ramanujan graphs
and bigraphs.
In Section 3, we address the first goal of this article, and present the first explicit construction
of an infinite family of unbalanced Ramanujan bigraphs.
In Sections 4 (Sections 4.1 - 4.4), we address the second goal of this article. We review many
of the known methods for constructing Ramanujan graphs, based on the original publications.
In Section 5, we shed further light on the two constructions of Ramanujan bipartite graphs
due to Lubotzky-Phillips-Sarnak [2] and Gunnells [5] and show how each can be converted into a
non-bipartite graph.
1

There is however a paper under preparation by C. Ballantine, S. Evra, B. Feigon, K. Maurischat, and O.
Parzanchevski that will present an explicit constrution.

2

In Section 6, we analyze the computational effort required in actually implementing the various
construction methods reviewed in Section 4. A pertinent issue that is addressed here is whether
one can give a polynomial-time algorithm for implementing the known constructions. In Section 7
(Sections 7.1 and 7.2), we accomplish the third goal of this article, namely to construct a bipartite
Ramanujan graph with specified degrees, but with the restriction that the edge set of this graph
must be disjoint from a given set of “prohibited” edges. In Section 7.3, we analyze our new
construction of Ramanujan bigraphs from Section 3 as well as the previously known constructions
of Ramanujan graphs and bigraphs, in terms of how many edges can be relocated while retaining
the Ramanujan property.

2

Review of Ramanujan Graphs and Bigraphs

In this subsection we review the basics of Ramanujan graphs and Ramanujan bigraphs. Further
details about Ramanujan graphs can be found in [9, 10].
Recall that a graph consists of a vertex set V and an edge set E ⊆ V × V. If (vi , vj ) ∈ E implies
that (vj , vi ) ∈ E, then the graph is said to be undirected. A graph is said to be bipartite if V
can be partitioned into two sets Vr , Vc such that E ∩ (Vr × Vr ) = ∅, E ∩ (Vc × Vc ) = ∅. Thus, in a
bipartite graph, all edges connect one vertex in Vr with another vertex in Vc . A bipartite graph is
said to be balanced if |Vr | = |Vc |, and unbalanced otherwise.
A graph is said to be d-regular if every vertex has the same degree d. A bipartite graph is said
to be (dr , dc )-biregular if every vertex in Vr has degree dr , and every vertex in Vc has degree dc .
Clearly this implies that dc |Vc | = dr |Vr |.
Suppose (V, E) is a graph. Then its adjacency matrix A ∈ {0, 1}|V|×|V| is defined by setting
Aij = 1 if there is an edge (vi , vj ) ∈ E, and Aij = 0 otherwise. In an undirected graph (which are
the only kind we deal with in the paper), A is symmetric and therefore has only real eigenvalues. If
the graph is d-regular, then d is an eigenvalue of A and is also its spectral radius. The multiplicity
of d as an eigenvalue of A equals the number of connected components of the graph. Thus the
graph is connected if and only if d is a simple eigenvalue of A. The graph is bipartite if and only
if −d is an eigenvalue of A. If the graph is bipartite, then its adjacency matrix A looks like


0 B
A=
,
B⊤ 0
where B ∈ {0, 1}|Vr |×|Vc | is called the biadjacency matrix. The eigenvalues of A equal ±σ1 , . . . , ±σl
together with a suitable number of zeros, where l = min{|V
√ r |, |Vc |}, and σ1 , . . . , σl are the singular
values of B. In particular, in a (dr , dc )-biregular graph, dr dc is the largest singular value of B.
These and other elementary facts about graphs can be found in [9].
Definition 1. A d-regular graph is said to be a Ramanujan graph if the second largest eigenvalue
by magnitude of its adjacency matrix, call it λ2 , satisfies
√
(1)
|λ2 | ≤ 2 d − 1.
A d-regular bipartite graph2 is said to be a bipartite Ramanujan graph if the second largest
singular value of its biadjacency matrix, call it σ2 , satisfies
√
σ2 ≤ 2 d − 1.
(2)
2

Note that such a bipartite graph must perforce be balanced with |Vr | = |Vc | and dr = dc = d.

3

Note the distinction being made between the two cases. If a graph is d-regular and bipartite,
then it cannot be a Ramanujan graph, because in that case λ2 = −d, which violates (1). On the
other hand, if it satisfies (2), then it is called a bipartite Ramanujan graph. Observe too that not
all authors make this distinction.
Definition 2. A (dr , dc )-biregular bipartite graph is said to be a Ramanujan bigraph if the second
largest singular value of its biadjacency matrix, call it σ2 , satisfies
p
p
(3)
σ2 ≤ dr − 1 + dc − 1.
It is easy to see that Definition 2 contains the second case of Definition 1 as a special case when
dr = dc = d. A Ramanujan bigraph with dr 6= dc is called an unbalanced Ramanujan bigraph.
The rationale behind the bounds in these definitions is given the following results. In the
interests of brevity, the results are paraphrased and the reader should consult the original sources
for precise statements.
Theorem 1. (Alon-Boppana bound; see [11].) Fix d and let n → ∞ in a d-regular graph with n
vertices. Then
√
lim inf |λ2 | ≥ 2 d − 1.
(4)
n→∞

Theorem 2. (See [12].) Fix dr , dc and let nr , nc approach infinity subject to dr nr = dc nc . Then
p
p
lim inf σ2 ≥ dr − 1 + dc − 1.
(5)
nr →∞,nc →∞

Given that a d-regular graph has d as its largest eigenvalue λ1 , a Ramanujan graph is one for
which the ratio λ2 /λ1 is as small as possible, in view of the Alon-Boppana
bound of Theorem 1.
√
Similarly, given that a (dr , dc )-regular bipartite graph has σ1 = dr dc , a Ramanujan bigraph is
one for which the ratio σ2 /σ1 is as small as possible, in view of Theorem 2.
In a certain sense, Ramanjuan graphs and Ramanujan bigraphs are pervasive. To be precise,
if d is kept fixed and n → ∞, then the fraction of d-regular, n-vertex graphs that satisfy the
Ramanujan property approaches one; see [13, 14]. Similarly, if dr , dc are kept fixed and nr , nc → ∞
(subject of course to the condition that dr nr = dc nc , then the fraction of (dr , dc )-biregular graphs
that are Ramanujan bigraphs approaches one; see [15]. However, despite their prevalence, there are
relatively few explicit methods for constructing Ramanujan graphs. Many of the currently known
techniques are reprised in Section 4.

3

Two New Families of Unbalanced Ramanujan Bigraphs

At the moment, there is not a single explicitly constructible family of unbalanced Ramanujan
bigraph, that is, an unbalanced biregular bipartite graph that satisfies the inequality (3). The
objective of this section is to present what the authors believe is the first such explicit construction.
According to a recent result [15], randomly generated (dr , dc )-biregular bipartite graphs with
(nr , nc ) vertices satisfy the Ramanujan property with probability approaching one as nr , nc simultaneously approach infinity (of course, while satisfying the constraint that dr nr = dc nc ). This
result generalizes an earlier result due to [13, 14] which states that randomly generated d-regular,
n-vertex graph satisfies the Ramanujan property as n → ∞ with probability approaching one. A
“road map” for constructing Ramanujan bigraphs is given in [16], and some abstract constructions
of Ramanujan bigraphs are given in [7, 8]. These bigraphs have degrees (p + 1, p3 + 1) for various
4

values of p, such as p ≡ 5 mod 12, p ≡ 11 mod 12 [7], and p ≡ 3 mod 4 [8].3 For each suitable choice
of p, these papers lead to an infinite family of Ramanujan bigraphs. At present, these constructions
are not explicit in terms of resulting in a biadjacency matrix of 0s and 1s. There is a paper under
preparation by the authors of these papers to make these constructions explicit.
In contrast, in this section, we state and prove two such explicit constructions, namely (lq, q 2 )biregular graphs where q is any prime and l is any integer that satisfies 2 ≤ l ≤ q, and (q 2 , lq)biregular graphs where q is any prime and l is any integer greater than q. Thus we can constuct
Ramanujan bigraphs for a broader range of degree-pairs compared to [7, 8]. In particular, for l = q
we generate a new class of Ramanujan graphs. However, for a given pair of integers l, q, we can
construct only one Ramanujan bigraph.
Our construction is based on so-called “array code” matrices from LDPC (low density parity
check) coding theory, first introduced in [17, 18]. Suppose q is a prime number, and let P ∈ {0, 1}q×q
be a cyclic shift permutation matrix on q numbers. Then the entries of P can be expressed as

1, j = i − 1 mod q
Pij =
0, otherwise.
Now let q be a prime number, and define

Iq
Iq
 Iq
P

2
 Iq
P

B(q, l) =  I
P3
 q
 .
..
 ..
.

Iq
P2
P4
P6
..
.

···
···
···
···
..
.

Iq P (q−1) P 2(q−1) · · ·

Iq
P (l−1)
P 2(l−1)
P 3(l−1)
..
.
P (l−1)(q−1)











(6)

where P j represents P raised to the power j. Now B = B(q, l) is binary with q 2 rows and lq
⊤
columns, row degree of l and column degree of q. If l < q, we study the
√ matrix B , whereas if
l ≥ q, we study B. In either case, the largest singular value of B is ql. The fact that these
bipartite graphs satisfy the Ramanujan property is now established.
√
Theorem 3.
1. Suppose 2 ≤ l ≤ q. Then the matrix B ⊤ has a simple singular value of ql,
√
l(q − 1) singular values of q, and l − 1 singular values of zero. Therefore B ⊤ represents a
Ramanujan bigraph.
√
2. Suppose l ≥ q. The matrix B has a simple singular value of ql. Now two subcases need to
be considered:
√
(a) When l mod q = 0, in addition B has (q − 1)q singular values of l and q − 1 singular
values of 0.
(b) When
√ in addition, (q − 1)k singular values
√ l mod q 6= 0, let k = l mod q. Then B has,
of l + q − k, (q − 1)(q − k) singular values of l − k, and q − 1 singular values of 0.
Therefore, whenever l ≥ q, B(q, l) represents a Ramanujan bigraph.
Corollary 1. For every prime number q, the matrix B(q, q) defined in (6) is square, and is the
√
adjacency matrix of a Ramanujan graph with d = q and n = q 2 . In this case λ1 = q, and λ2 = q
with a multiplicity of q(q − 1). The remaining q − 1 eigenvalues of B(q, q) are zero.
3

The authors thank Prof. Cristina Ballantine for aiding us in interpreting these papers.

5

Proof. Let B be a shorthand for B(q, l). Note that P is a cyclic shift permutation; therefore P ⊤ =
P −1 . The proof consists of computing BB ⊤ , B ⊤ B and determining its eigenvalues. Throughout
we make use of the fact that P ⊤ = P −1 .
We begin with the case l ≤ q. Use block-partition notation to divide BB ⊤ into l blocks of size
q × q. Then
⊤

(BB )ij

=

=

q
X

s=1
q
X

P (i−1)(s−1) (P ⊤ )(s−1)(j−1)
P (i−j)(s−1) =

q−1
X

P (i−j)s .

s=0

s=1

It readily follows that
(BB ⊤ )ii = qIq , i = 1, . . . , q.
Now observe that, for any nonzero integer k, the set of numbers ks mod q as s varies over {0, . . . , q −
1} equals {0, . . . , q − 1}. (This is where we use the fact that q is a prime number.) Therefore,
whenever i 6= j, we have that
q−1
X
P s = 1q×q ,
(BB ⊤ )ij =
s=0

where 1q×q denotes the q × q matrix whose entries are all √
equal to one. Observe that the largest
⊤
eigenvalue of BB is ql, with normalized eigenvector (1/ ql)1ql . Therefore if we define Ml =
BB ⊤ − 1ql×ql and partition it commensurately with B, we see that the off-diagonal blocks of Ml
are all equal to zero, while the diagonal blocks are all identical and equal to qIq − 1q×q . This is
the Laplacian matrix of a fully connected graph with q vertices, and thus has q − 1 eigenvalues
of q and one eigenvalue of 0. Therefore Ml = BB ⊤ − 1ql×ql has l(q − 1) eigenvalues of q and
l eigenvalues of 0. Moreover, 1ql is an eigenvector of M corresponding to the eigenvalue zero.
Therefore BB ⊤ = Ml + 1ql 1⊤
ql has a single eigenvalue of ql, l(q − 1) eigenvalues of q, and l − 1
eigenvalues of 0. This is equivalent to the claim about singular values of B ⊤ .
2
2
Now we study the case where l ≥ q. Let Mq ∈ {0, 1}q ×q denote the matrix in the previous
case with l = q. This matrix can be block-partitioned into q × q blocks, with

qIq − 1q×q , if j − i ≡ 0 mod q,
(Mq )ij =
0,
otherwise.
Now consider the subcase that l ≡ 0 mod q. Then B ⊤ B consists of l/q repetitions of Mq on each
block row and block column of size q 2 ×q 2 . Therefore each such row and column block gives (q −1)q
eigenvalues of magnitude l and rest of the eigenvalues of will be zero. Next, if l mod q =: k 6= 0,
then B ⊤ B consists of (l − k)/q repititions of Mq on each block row and column of size q 2 × q 2 .
In addition it contains first k column blocks of Mq concatenated l times column-wise as the last
column blocks. It contains first k row blocks of Mq concatenated l − k times row-wise as the
last block of rows. The extra k rows and colums of B ⊤ B give (q − 1)k eigenvalues of magnitude
l + (q − k). Another set of row and column blocks give (q − 1)(q − k) eigenvalues of magnitude
l − k. The remaining eigenvalues are 0.
Note that, when l = q, the construction in (6) leads to a new class of Ramanujan graphs of
degree q and q 2 vertices. In our terminology, it is a “one-parameter” family. So far as we are able
to determine, this family is new and is not contained any other known family.
6

4

Some Constructions of Ramanujan Graphs

At present there are not too many methods for explicitly constructing Ramanujan graphs. In this
section we reprise most of the known methods. Note that the authors have written Matlab codes
for all of the constructions in this section, except the Winnie Li construction in Section 4.3; these
codes are available upon request.
The available construction methods can be divided into two categories, which for want of a
better terminology we call “one-parameter” and “two-parameter” constructions. One-parameter
constructions are those for which, once the degree d of the graph is specified, the number n of
vertices is also fixed by the procedure. In contrast, two-parameter constructions are those in which
it is possible to specify d and n independently. The methods of Lubotzky-Phillips-Sarnak (LPS)
and of Gunnells are two-parameter, while those of Winnie Li and Bibak et al. are one-parameter.
Of course, not all combinations of d and n are permissible.
In this connection it is worth mentioning the results of [19, 20, 21], which show that there
exist bipartite Ramanujan graphs of all degrees and all sizes. However these results do not imply
the existence of Ramanujan graphs of all sizes and degrees. Moreover, the ideas in [19, 20, 21]
do not lead to an explicit construction. There is a preprint [22] that claims to give a polynomial
time algorithm for implementing the construction of [19, 20]. However, no code for the claimed
implementation is available. Some of the methods discussed here lead to bipartite Ramanujan
graphs. It is presumably of interest to show that these constructions in fact lead to non-bipartite
Ramanujan graphs. This is done below.
All but one of the constructions described below are Cayley graphs. So we begin by describing
that concept. Suppose G is a group, and that S ⊆ G is “symmetric” in that a ∈ S implies that
a−1 ∈ S. Then the Cayley graph C(G, S) has the elements of G as the vertex set, and the edge set
is of the form (x, xa), x ∈ G, a ∈ S. Due to the symmetry of S, the graph is undirected even if G
is noncommutative.

4.1

Lubotzky-Phillips-Sarnak Construction

The Lubotzky-Phillips-Sarnak (referred to as LPS hereafter) construction [2] makes use of two
unequal primes p, q, each of which is ≡ 1 mod 4. As is customary, let Fq denote the finite field
with q elements, and let F∗q denote the set of nonzero elements in Fq . The general linear group
GL(2, Fq ) consists of all 2 × 2 matrices with elements in Fq whose determinant is nonzero. If we
define an equivalence relation ∼ on GL(2, Fq ) via A ∼ B whenever A = αB for some α ∈ F∗q , then
the resulting set of equivalence classes GL(2, Fq )/ ∼ is the projective general linear group
P GL(2, Fq ). Next, it is shown in [2] that there are exactly p + 1 solutions of the equation
p = a20 + a21 + a22 + a23 ,

(7)

where a0 is odd and positive, and a1 , a2 , a3 are√even (positive or negative). Choose an integer i
such that i2 ≡ −1 mod q. Thus i is a proxy for −1 in the field Fq . Such an integer always exists.
The LPS construction is a Cayley graph where the group G is the projective general linear
group P GL(2, Fq ). The generator set S consists of the p + 1 matrices


a0j + ia1j a2j + ia3j
mod q,
(8)
Mj =
−a2j + ia3j a0j − ia1j
as (a0j , a1j , a2j , a3j ) range over all solutions of (7). Note that each matrix Mj has determinant
p mod q. It is clear that the LPS graph is (p + 1)-regular, and the number of vertices equals the
cardinality of P GL(2, Fq ), which is q(q 2 − 1).
7

To proceed further, it is necessary to introduce the Legendre symbol. If q is an odd prime
and a is not a multiple of q, define
  
a
1
if ∃x ∈ Z s.t. x2 ≡ a mod q,
=
−1 otherwise
q
Partition [q − 1] := {1, · · · , q − 1} into two subsets, according to


 
a
=1 ,
S1,q := a ∈ [q − 1] :
q

 

a
S−1,q := a ∈ [q − 1] :
= −1 .
q

(9)
(10)

Then it can be shown that each set S1,q and S−1,q consists of (q − 1)/2 elements of [q − 1]. One of
the many useful properties of the Legendre symbol is that, for integers a, b ∈ Z, neither of which is
a multiple of q, we have
    
ab
a
b
=
.
q
q
q
Consequently, for a fixed odd prime number q, the map
 
a
: Z \ qZ → {−1, 1}
a 7→
q
is multiplicative. Further details about the Legendre symbol can be found in any elementary text
on number theory; see for example [23, Section 6.2], or [24, Section 5.2.3].
 
The LPS construction gives two distinct kinds of graphs, depending on whether pq = 1 or
−1. To describe the situation, let us partition P GL(2, Fq ) into two disjoint sets P SL(2, Fq ) and
P SLc (2, Fq ), that are defined next. Partition GL(2, Fq ) into two sets GL1(2, Fq ) and GL2(2, Fq )
as follows:
GL1(2, Fq ) = {A ∈ GL(2, Fq ) : det(A) ∈ S1,q },
GL2(2, Fq ) = {A ∈ GL(2, Fq ) : det(A) ∈ S−1,q },

Because of the multiplicativity of the Legendre symbol, it follows that GL1(2, Fq ) is a subgroup of
GL(2, Fq ). Next, define
P SL(2, Fq ) := GL1(2, Fq )/ ∼,
P SLc (2, Fq ) := GL2(2, Fq )/ ∼ .

Then P SL(2, Fq ) and P SLc (2, Fq ) form a partition of P GL(2, Fq ), and each set contains (q(q 2 −
1))/2 elements.
Now we come to the nature of the Cayley graph that is generated by the LPS construction.
 
• If pq = 1, then each Mj maps P SL(2, Fq ) onto itself, and P SLc (2, Fq ) into itself. Thus the
Cayley graph consists of two disconnected components, each with (q(q 2 − 1))/2 elements. It
is shown in [2] that each component is a Ramanujan graph. It is shown below that the two
graphs are actually isomorphic.
 
• If pq = −1, then each Mj maps P SL(2, Fq ) onto P SLc (2, Fq ), and vice versa. In this case

the Cayley graph of the LPS construction is a balanced bipartite graph, with (q(q 2 − 1))/2
elements in each component. It is shown in [2] that the graph is a bipartite Ramanujan graph.
It is shown below that the bipartite graph can be converted to a non-bipartite graph.
8

4.2

Gunnells’ Construction

Next we review the construction in [5]. Suppose q is a prime or a prime power, and as usual, let Fq
denote the finite field with q elements. Let l be any integer, and view Fql as a linear vector space
over the base field Fq . Then the number of one-dimensional subspaces of Fql equals
l−1

ql − 1 X i
q.
=
ν(l, q) :=
q−1
i=0

Let us denote the set of one-dimensional subspaces by V1 . Correspondingly, the number of subpaces
of Fql of codimension one also equals ν(l, q). Let us denote this set by Vl−1 because (obviously)
every subspace of codimension one has dimension l − 1. The Gunnells construction is a bipartite
graph with V1 and Vl−1 as the two sets of vertices. In this construction, there is an edge between
Sa ∈ V1 and Tb ∈ Vl−1 if and only if Sa is a subspace of Tb . The Gunnells construction is a balanced
bipartite graph with
l−1
X
qi,
n = |V1 | = |Vl−1 | = ν(l, q) =
i=0

vertices and is biregular with degree
d = ν(l − 1, q) =

l−2
X

qi.

i=0

For ease of reference, we state properties of the Gunnells construction as a theorem.
Theorem 4. (See [5, Theorem 3.2].) The Gunnells graph is a balanced bipartite Ramanujan
graph
p
with σ1 = ν(l − 1, q). Moreover all other singular values of B(l, q) have magnitude q l−2 .
It is shown below that the bipartite graph can be converted to a non-bipartite graph.

4.3

Winnie Li’s Construction

Suppose G is an Abelian group and let n denote |G|. Then a character χ on G is a homomorphism
χ : G → S 1 , where S 1 is the set of complex numbers of magnitude one. Thus χ(ab) = χ(a)χ(b) for
all a, b ∈ G. There are precisely n characters on G, and it can be shown that [χ(a)]n = 1 for each
character χ and each a ∈ G. Therefore each character maps an element of G into an n-th root
of one. The character defined by χ0 (a) = 1 for all a ∈ G is called the trivial character. Let us
number the remaining characters on G as χi , i ∈ [n − 1] in some manner.
Suppose that S is a symmetric subset of G, and consider the associated Cayley graph. Thus
the vertices of the graph are the elements of G, and the edges are (x, xa), x ∈ G, a ∈ S. Clearly
the Cayley graph has n vertices and is d-regular where d = |S|. Now a key result [3, Proposition
1.(1)] states that the eigenvalues of the adjacency matrix are
X
λi =
χi (s), i = 0, 1, . . . , n − 1.
s∈S

If i = 0, then λ0 = d, which we know (due to regularity). Therefore, if the set S can somehow be
chosen in a manner that
X
√
χi (s) ≤ 2 d − 1, i ∈ [n − 1],
s∈S

9

then the Cayley graph would have the Ramanujan property. Several Ramanujan graphs can be
constructed using the above approach. In particular, the following construction is described in [3,
Section 2].
Let Fq be a finite field, so that q is a prime or prime power. Let Fq2 be a degree 2 extension
of Fq and choose S to be the set of all primitive elements of Fq2 , that is, the set of elements of
multiplicative norm 1. Here, the multiplicative norm of α ∈ Fq2 is defined as
N (α) := α · αq = αq+1 .
Note that S is symmetric and contains q + 1 elements. A deep and classical theorem due to
Deligne [25] states that for every nontrivial character χi , i ≥ 1 on the additive group of Fq2 , we
have
X
√
χi (s) ≤ 2 q, i ∈ [q 2 − 1].
s∈S

Therefore the Cayley graph with Fq2 as the group and S as the generator set has the Ramanujan
property.

4.4

Bibak et al. Construction

The next construction is found in [6]. Suppose q is a prime ≡ 3 mod 4. Let G be the additive group
Fq2 , consisting of pairs z = (x, y) where x, y ∈ Fq . Clearly n = |G| = q 2 . The “norm” of an element
z is defined as (x2 + y 2 ) mod q, and the set S consists of all z such that the norm equals one. It can
be shown that |S| = q + 1 and that S is symmetric. It is shown in [6] that the associated Cayley
graph has the Ramanujan property.

5

Further Analysis of Earlier Constructions

 
It is seen from Section 4 that if pq = 1, then the LPS construction leads to a disconnected graph,
consisting of two components with an equal number of vertices (and edges). It would be of interest
to know whether the two connected components are isomorphic to each other, that is, whether LPS
construction leads to two distinct Ramanujan graphs, or just one. In general, determining whether
two graphs are isomorphic is in the class NP, (so that it is easy to determie whether a candidate
solution is in fact a solution). The best available algorithm [26] provides a “quasi-polynomial time”
algorithm to solve this problem. Therefore the problem is not trivial. However, in the case of the
two components of an LPS construction, it is
 to demonstrate that the two graphs are indeed
 easy
p
isomorphic. Next, if the Legendre symbol q = −1, the LPS construction leads to a bipartite
Ramanujan graph. The Gunnells construction always leads to a bipartite Ramanujan graph. Graph
theorists prefer non-bipartite (or “real”) Ramanujan graphs to bipartite Ramanujan graphs. It is
easy to show that every Ramanujan graph leads to a bipartite Ramanujan graph. Specifically,
suppose (V, E) is a Ramanujan graph with adjacency matrix A. Define two sets Vr , Vc to be copies
of V, and define an edge (vri , vcj ) in the bipartite graph if and only if there is an edge (vi , vj ) in
the original graph. Then it is obvious that the biadjacency matrix of this bipartite graph is also
A. Hence the bipartite graph is a bipartite Ramanujan graph if and only if the original graph also
has the Ramanujan property. However, the converse is not necessarily true. Indeed, it is not yet
known whether the bipartite graphs constructed in [21] can be turned into non-bipartite graphs.

10

Therefore it is of some interest to show that the bipartite constructions of LPS and Gunnels can
indeed be turned into non-bipartite graphs.
Suppose that there is a balanced bipartite graph with vertex sets Vr and Vc and edge set
E ⊆ Vr × Vc . In order to convert this bipartite graph into a nonbipartite graph, it is necessary and
sufficient to find a one-to-one and onto map π : Vc → Vr (which is basically a permutation), such
that whenever there is an edge (vi , vj ) in the bipartite graph, there is also an edge (π −1 (vj ), π(vi )).
In this way, the “right” vertex set can be identified with its image under π and the result would be
an undirected nonbipartite graph. Moreover, it is easy to show that, if B is the biadjacency matrix
of the original graph, and A is the adjacency matrix of the nonbipartite graph, then A = BΠ where
Π is the matrix representation of π. Thus the eigenvalues of A are the singular values of B, which
implies that if the bipartite graph has the Ramanujan property, so does the nonbipartite
graph.
 
p
With this background, in the present section we first remark that, when q = 1, the two
connected components of the LPS construction are isomorphic. Indeed, choose any A ∈ P GL(2, Fq )
such that det(A) ∈ S−1,q , and define the map π : P SL(2, Fq ) → P SLc (2, Fq ) via X 7→ AX. Then
the edge incidence is preserved.
 
Next we show that, when pq = −1, the resulting LPS bipartite graph can be mapped into a
(non-bipartite) Ramanujan graph. For this purpose we establish a preliminary result.
Lemma 1. There exists a matrix A ∈ GL2(2, Fq ) such that A2 ∼ I2×2 .
Proof. Choose elements α, β, γ ∈ Fq such that −(α2 + βγ) ∈ S−1,q . This is easy: Choose an
arbitrary δ ∈ S−1,q , arbitrary α ∈ Fq , γ = −1, and β = α2 + δ. Now define


α β
A=
.
(11)
γ −α
Then
2

A =



α β
γ −α



α β
γ −α



=



α2 + βγ
0
0
α2 + βγ



.

Hence A2 ∼ I. Clearly det(A) = −(α2 + βγ) ∈ S−1,q .
 
Theorem 5. Suppose pq = −1, and consider the bipartite Ramanujan graph C(P GL(2, Fq ), S).
Then there exists a map π : P SL(2, Fq ) → P SLc (2, Fq ) that is one-to-one and onto such that,
whenever there is an edge (X, Z) with X ∈ P SL(2, Fq ) and Z ∈ P SLc (2, Fq ), there is also an edge
(π −1 (Z), π(X)).
Proof. For a matrix X̄ ∈ GL(2, Fq ), let [X̄] ∈ P GL(2, Fq ) denote its equivalence class under ∼.
Construct the matrix as in Lemma 1. Suppose there exists an edge (X, Z) with X ∈ P SL(2, Fq )
and Z ∈ P SLc (2, Fq ). Thus there exist representatives X̄ ∈ GL1(2, Fq ), Z̄ ∈ GL2(2, Fq ) and
an index i ∈ [p + 1] such that Z̄ ∼ X̄Mi . Now observe that if (a0 , a1 , a2 , a3 ) solves (7), then
(a0 , −a1 , −a2 , −a3 ) also solves (7). By examining the definition of the matrices Mj in (8), it is
clear that for every index i ∈ [p + 1], there exists another index j ∈ [p + 1] such that Mi Mj ∼ I.
Now define Ȳ = AZ̄ and note that Ȳ ∼ A−1 Z̄ because A2 ∼ I. Also, Ȳ ∈ GL1(2, Fq ) because
Z̄ ∈ GL2(2, Fq ) and det(A) ∈ S−1,q . By assumption Z̄ ∼ X̄Mi . So AZ̄ ∼ AX̄Mi . Now choose the
index j ∈ [p + 1] such that Mi Mj ∼ I. Then
Ȳ Mj = AZ̄Mj ∼ AX̄Mi Mj ∼ AX̄.
Hence there is an edge from [Ȳ ] = A−1 (Z) to [AX̄] = A(X).
11

Theorem 6. The Gunnells construction can be converted into a nonbipartite Ramanujan graph of
degree d = ν(l − 1, q) and n = ν(l, q) vertices.
Proof. As before, it suffices to find a one-to-one and onto map π from Vl−1 to V1 such that, if there is
an edge (S, T ) where S ∈ V1 and T ∈ Vl−1 , then there is also an edge (π(T ), π −1 (S)). Accordingly,
if T ∈ Vl−1 , so that T is a subspace of codimension one, define π(T ) to be an “annihilator” T ⊥ of
T , consisting of all vectors v ∈ Flq such that v ⊤ u = 0 for every u ∈ T . Then T ⊥ is a one-dimensional
subspace of Flq and thus belongs to V1 . Moreover, for S ∈ V1 , we have that π −1 (S) = S ⊥ . It is
obvious that this map is one-to-one and onto. Now suppose there is an edge (S, T ) where S ∈ V1
and T ∈ Vl−1 . This is the case if and only if S ⊆ T . But this implies that T ⊥ ⊆ S ⊥ . Hence there
is an edge from π(T ) to π −1 (S).

6

Computational Aspects of Various Constructions

In this section we discuss some of the implementation details of constructing Ramanujan graphs
using the various methods discussed in Section 4. The authors have written Matlab codes for all
of these implementations except the Winnie Li construction, which can be made available upon
request. One of the objectives of this discussion is to compare and contrast the amount of work
involved in actually constructing the various classes of graphs.
Our New Construction: We begin by noting that the biadjacency matrix of the Ramanujan
bigraphs presented in Section 3 is quite explicit, and does not require any work: One simply specifies
a prime number q and an integer l ≥ 2, and the biadjacency matrix is obtained at once from (6).
We now discuss the remaining constructions, in order of increasing complexity of implementation.
For the Bibak construction, we simply enumerate all vectors in Z2q , compute all of their norms,
and identify the elements of norm one. Again, for q ≤ 103, this works quite well.
Gunnells Construction: For the Gunnells construction, the vertex set is the set of onedimensional subspaces of Fql . For this purpose we identify Fql with Flq , the set of l-dimensional
vectors over Fq . To enumerate these, observe that there are q l − 1 nonzero vectors in Flq . For any
nonzero vector, there are q − 1 nonzero multiples of it, but all these multiples generate the same
subspace. Therefore the number of one-dimensional subspaces is
l−1

ql − 1 X i
q.
=
q−1
i=0

To enumerate these subspaces without duplications, we proceed as follows: In step 1, fix the first
element of a vector x ∈ Flq to 1, and let the elements x2 through xl be arbitrary. This generates
q l−1 nonzero vectors that generate distinct subspaces. In step 2, fix x1 = 0, x2 = 1 and x3 through
xl be arbitrary. This generates q l−2 nonzero vectors that generate distinct subspaces. And so
on. To construct the edge set, suppose x, y are two nonzero generating vectors defined as above
(which could be equal). Then the one-dimensional subspace generated by x is contained in the
one-dimensional subspace annihilated by y if and only if y ⊤ x ≡ 0 mod q.
LPS Contruction: In order to implement this construction, it is desirable to have systematic
enumerations of the projective groups P GL(2, Fq ), P SL(2, Fq ), and P SLc (2, Fq ). The approach
used by us is given next. Define



0 1
∗
M1 =
: g ∈ Fq , h ∈ Fq ,
g h
12

M2 =



1 f
g h



: f, g ∈

F∗q , h

− fg ∈

F∗q



.

Then every matrix in GL(2, Fq ) is equivalent under ∼ to exactly one element of P GL(2, Fq ).
Specifically, let A ∈ GL(2, Fq ) be arbitrary. If a11 = 0, then A ∼ (a12 )−1 A ∈ M1 , whereas if
a11 6= 0, then A ∼ (a11 )−1 A ∈ M2 . The rest of the details are easy and left to the reader. This
provides an enumeration of P GL(2, Fq ). To provide an enumeration of P SL(2, Fq ), we modify the
sets as follows:



0 1
: g ∈ S1,q , h ∈ Fq ,
M1,1 =
g h



1 f
∗
M2,1 =
: f, g ∈ Fq , h − f g ∈ S1,q ,
g h



0 1
M1,−1 =
: g ∈ S−1,q , h ∈ Fq ,
g h



1 f
M2,−1 =
: f, g ∈ F∗q , h − f g ∈ S−1,q .
g h
Then the set of matrices M1,1 ∪ M2,1 provides an enumeration of P SL(2, Fq ), while the set of
matrices M1,−1 ∪ M2,−1 provides an enumeration of P SLc (2, Fq ). Once the vertex sets are enumerated, each representative matrix of an element in P GL(2, Fq ) is multiplied by each generator
matrix M1 through Mp+1 , and then converted to one of the above representations, depending on
whether the (1, 1)-element is zero or nonzero.
In the original LPS construction, it is assumed that p < q. However, the LPS construction can
still be used with p > q,4 provided that the p + 1 generating matrices M1 through Mp+1 are distinct
elements of F2×2
q . In our implementation, we handle the case p > q by verifying whether this is
indeed the case.
Winnie Li Construction: As mentioned earlier, the fact that the Winnie Li construction
leads to a Ramanujan graph is based on a deep result of [25]. However, it is still a challenge
to construct this graph explicitly. The main difficulty is that as yet there is no polynomial-time
algorithm to find all elements of the generator set S of a finite field Fq . Suppose that q = pr
where p is a prime number and r is an integer. Then the best available algorithm [27] returns
one primitive element of the field Fq in time O(p(r/4)+ǫ ) for arbitrarily small ǫ. Recall that, for
an algorithm for integer computations to be considered as “polynomial-time,” its running time
has to be O(⌈log2 q⌉). Thus, for the moment there are no efficient algorithms for implementing
the Winnie Li construction. However, for relatively small values of q (say 101 or less), it is still
feasible to execute “nonpolynomial” algorithms, basically just enumeration of all possibilities. The
approach adopted by us to implement this construction is described next.
This construction requires more elaborate computation. The main source of difficulty is that
as of now there is no polynomial-time algorithm for finding a primitive element in a finite field.
The best known algorithm to date is due to [27], which finds a primitive element of Fpl in time
O(p(l/4)+ǫ ). Thus, for really large primes q, the Li construction would be difficult to implement. At
present, “realistic” matrix completion problems such as the Netflix problem could potentially have
millions of columns. However, many if not most practical examples are of size 104 × 104 . Since
the graphs in the Li construction have q 2 vertices, it is reasonable to focus on the much narrower
problem of finding a primitive element in the field Fq when q is a prime ≤ 101. For this purpose
we follow a simple enumeration procedure.
4

We are grateful to Prof. Alex Lubotzky for clarifying this point.

13

1. We identify an irreducible polynomial φ(x) of degree 2 in Fq [x]. For instance, if q ≡ 5 mod 8,
then x2 + 2 is irreducible. In particular, x2 + 2 is an irreducible polynomial in F13 [x]. Other
irreducible polynomials are known for other classes of prime numbers. In the worst case,
an irreducible polynomial can be found by enumerating all polynomials of degree 2 in Fq [x],
and then deleting all products of the form (x − a)(x − b) where a, b ∈ Fq . This would leave
(q(q−1))/2 irreducible polynomials, but we can use any one of them. Note that the worst-case
complexity of this approach is O(q 2 ).
2. Once this is done, Fq2 is isomorphic to the quotient field Fq [x]/(φ(x)). Let us denote x =
x + (φ(x)). Then the elements of Fq2 can be expressed as
ax + b, a, b ∈ Fq .
3. To determine the set of units S in the field Fq2 , we have to find all elements α in F∗q2 such
that αq+1 = 1. Now, if β is a primitive element of the F∗q2 , then
F∗q2 = {β m , 1 ≤ m ≤ q 2 − 1}.
Among the elements of F∗q2 , the units are precisely the roots of αq+1 = 1. With the above
enumeration, we get
S = {β k(q−1) , 1 ≤ k ≤ q + 1}.
4. We now enumerate all elements in the multiplicative group Fq2 and test each element to see
if it is a primitive element. To ensure that g ∈ F∗q2 is a primitive element, it is sufficient to
q 2 −1

check that g l 6= 1 for any prime divisor l of q 2 − 1. Because q 2 − 1 = (q − 1)(q + 1),
the prime divisors of q 2 − 1 are 2 and the other prime divisors of q − 1 and q + 1. For
example, with q = 13, the prime divisors of q 2 − 1 are l = 2, 3, 7, with the corresponding
values k = (q 2 − 1)/l = 84, 56, 24. Therefore if g k 6= 1 for these values of k, then g is a
primitive element. There are also efficient ways to raise a field element to large powers, for
example, by expanding the power to the base 2. One can check that g = x + 1 is a primitive
element of the field F132 .
5. Once a primitive element g ∈ Fq2 is determined, the generator set S equals {g (q−1)k , k ∈
[q + 1]}. Thus we can construct the Cayley graph C(Fq2 , S) as follows: Each vertex ax + b is
connected to the vertices
{ax + b + g(q−1)k , k ∈ [q + 1]}.
In this way we can construct a (q + 1)-regular Ramanujan graph with q 2 vertices.

Note that, in the worst case, the Winnie Li construction cannot be implemented by any poly-time
algoritheorem. The above are just some shortcuts that may or may not work for specific values of
q.

7
7.1

Construction of Ramanujan Graphs with “Prohibited” Edges
Problem Statement and Motivation

Suppose we are given vertex sets Vr , Vc , where |Vr | need not equal |Vc |. Denote |Vr | = nr , |Vc | = nc .
We are also given degrees dr , dc , as well as a set M ⊆ Vr × Vc , known as the set of prohibited
14

edges. The objective is to construct a bipartite Ramanujan graph of degrees (dr , dc ), but with the
added restriction that the edge set E must be disjoint from M.
The motivation for this problem arises from an engineering application known as “‘matrix
completion with missing measurements.” The conventional matrix completion problem can be
stated as follows: Suppose X ∈ Rnr ×nc is a matrix that is unknown other than a known upper
bound r on its rank. The learner is able to choose a “sample set” Ω ⊆ [nr ] × [nc ], and can measure
Xij for all (i, j) ∈ Ω. From these measurements, and the information that rank(X) ≤ r, the learner
aspires to determine the unknown matrix X exactly. The most widely used approach, introduced
in [28, 29], is the following: Let kXkN denote the nuclear norm of a matrix, namely the sum of
its singular values. Given the measurement set Xij , (i, j) ∈ Ω, define
X̂ := argmin kZkN s.t. Zij = Xij ∀(i, j) ∈ Ω.

(12)

Z∈Rnr ×nc

Thus one finds the matrix X̂ that has minimum nuclear norm while being consistent with the
measurements. The problem (12) is a convex optimization problem subject to linear constraints;
so it can be solved efficiently even for relatively large-sized matrices. However, the key question is:
Is the solution X̂ of (12) equal to the unknown matrix X? To put it another way, can an unknown
matrix of low rank be recovered by sampling a few entries and then carrying out nuclear norm
minimization?
It is clear that the choice of the sample set Ω plays a crucial role in any analysis of the matrix
completion problem. In almost all papers, starting with [28], it is assumed that Ω is determined
by sampling the elements of X uniformly and at random. Then it is shown that, if the number of
samples |Ω| is sufficiently large, then with high probability X̂ does indeed equal X. A significant
departure is made in a recent paper by a subset of the present authors [1], where the sample set
Ω is chosen in a deterministic fashion, as the edge set of a Ramanujan bigraph. In [1] a sufficient
condition is derived for the solution of (12) to equal X.
While [1] gives the first deterministic solution to the matrix completion problem, it does not
address the issue of “missing measurements.” In any real-life application of matrix completion, it
is a fact that a few elements of the matrix X are “missing” and thus cannot be measured. This
is the set M ⊆ [nr ] × [nc ]. Therefore, in applying nuclear norm minimization, it is essential to
ensure that the “sample set” Ω is disjoint from the missing measurements, that is, the set M of
prohibited edges. If the elements of X are sampled at random, as suggested in [28, 29], then one
can simply omit the elements of M while sampling. However, if a Ramanujan graph is constructed
using one of the methods outlined in earlier sections, it is not possible to guarantee a priori that
the resulting edge set Ω and the prohibited edge set M will be disjoint.
This now brings us to a formal statement of the missing measurement problem in Ramanujan
bigraphs. Suppose that we have constructed a (dr , dc )-biregular Ramanujan bigraph with nr , nc
verticies. This graph can be described in one of two equivalent ways: First, its biadjacency matrix
E ∈ {0, 1}nr ×nc , and second, its edge set Ω which consists of all (i, j) such that Eij = 1. It is tacitly
understood that the construction might impose some constraints on the four numbers dr , dc , nr , nc .
Next, suppose that the set of prohibited edges M ⊆ [nr ] × [nc ] is also specified. In applications,
the set M has quite small cardinality. If Ω and M are disjoint sets, then there is nothing to
be done. On the other hand, if Ω and M have some overlap, the question is: Is it possible to
“perturb” the biadjacency matrix E in such a manner that the corresponding graph has no edges
in the set M, and is still a (dr , dc )-biregular Ramanujan bigraph? Note that we could have phrased
the problem differently: Suppose integers dr , dc , nr , nc and a set M ⊆ [nr ] × [nc ] are specified.
Is it possible to construct a (dr , dc )-biregular Ramanujan graph such that no element of M is an
15

edge? Our method of framing the question suggests our proposed approach: We first construct a
Ramanujan bigraph without worrying about the set M, and afterwards worry about “perturbing”
the Ramanujan bigraph so as to eliminate the edges in M (if any) and replace them by others,
while still retaining biregularity and the Ramanujan property. Since the underlying assumption
(motivated by real-life applications) is that the set M is quite small, this approach makes sense.

7.2

Perturbations of Ramanujan Graphs

Let
M = {(i1 , j1 ), (i2 , j2 ), . . . (is , js )} ⊆ [nr ] × [nc ]
denote the set of prohibited edges. Now suppose we have constructed a (dr , dc )-biregular Ramanujan
graph with biadjacency matrix E and edge set Ω. If Ω ∩ M = ∅, then there is nothing for us to
do. If on the other hand the intersection is nonempty, then we modify E to another matrix
Ep = E + ∆+ − ∆− where ∆− , ∆+ ∈ {0, 1}nr ×nc such that Ep ∈ {0, 1}nr ×nc , and also corresponds
to a (dr , dc )-biregular Ramanujan graph. There are two distinct issues here: Ensuring that Ep ∈
{0, 1}nr ×nc and is (dr , dc )-biregular, and ensuring that Ep represents a Ramanujan graph. The
two questions are treated sequentially. We begin with perturbing the graph to ensure (dr , dc )biregularity while avoiding prohibited edges.
To recapitulate, given a matrix E and corresponding edge set Ω, the problem is to choose
∆− , ∆+ ∈ {0, 1}nr ×nc such that EP := E + ∆+ − ∆− is also (dr , dc )-biregular while avoiding
prohibited edges. This requires, among other things, that
supp(∆− ) ⊆ Ω, and Ω ∩ M ⊆ supp(∆− ),

(13)

supp(∆+ ) ∩ Ω = ∅, and supp(∆+ ) ∩ M = ∅.

(14)

and
Here, (13) ensures that ∆− is a submatrix of E, and that by subtracting the edges in supp(∆− )
from Ω, we eliminate all prohibited edges. Note that we do not insist that Ω ∩ M = supp(∆− ).
In other words, in the process of eliminating some prohibited edges, we may perhaps also remove
other edges that are not prohibited. Clearly this does not matter. Along similar lines, (14) ensures
that only new edges are added, and that these edges are not prohibited.
Lemma 2 presented next gives a very simple sufficient condition and a recipe for choosing
∆− , ∆+ provided that M satisfies certain conditions. It can definitely be improved, but in the case
of matrix completion with missing measurements, it is good enough.
Lemma 2. Suppose that, for each index i ∈ [nr ], the set {j ∈ [nc ] : (i, j) ∈ M} has cardinality no
more than p, and similarly, for each index j ∈ [nc ], the set {i ∈ [nr ] : (i, j) ∈ M} has cardinality
no more than p. Let θc denote the maximum inner product between any two distinct columns of E.
Suppose it is the case that
2p ≤ nc − dr ,
(15)
2p − 1 ≤ dc − θc .

(16)

Then we can choose ∆− , ∆+ ∈ {0, 1}nr ×nc such that (13) and (14) hold.
Proof. We introduce a few symbols to streamline the presentation. In analogy with the notation
introduced earlier, define
supp(i) := {j ∈ [nc ] : Eij = 1},
16

supp(j) := {i ∈ [nr ] : Eij = 1},
Nr (i) := {j ∈ [nc ] : (i, j) ∈ Ω ∩ M}, ∀i ∈ [nr ].

(17)

Nc (j) := {i ∈ [nr ] : (i, j) ∈ Ω ∩ M}, ∀j ∈ [nc ].

(18)

Order the elements of [nr ], [nc ] in some fashion. Ascending order is as good as any, and it will
play no role in the proof other than simplifying notation. So we use that. Apply the procedure
below for each i ∈ [nr ], in sequential order. If the set Nr (i) is empty, move to the next row. Suppose
Nr (i) is nonempty, and define pi = |Nr (i)|. Since pi ≤ p for each i, we simplify notation by using
p instead of pi .
Recall the definition of the set Nr (i). Enumerate the set as {(i, j1 ), · · · , (i, jp )}. and observe
that Ei,jl = 1 for all l. Note that row i contains precisely dr columns with a 1 (including of course
Eij1 ), and therefore nc − dr columns with zeros. Among these, a maximum of p can be such that
(i, j) ∈ M. Therefore, if nc − dr ≥ 2p, then we can find indices j̄l , 1 ≤ l ≤ p such that
Ei,j̄l = 0, and (i, j̄l ) 6∈ M, 1 ≤ l ≤ p.
Next, fix a specific index j̄l , and compare the columns Ejl , and Ej̄l . It is now shown that it is
possible to find a subset Ij̄l = {ī1 = i, ī2 , · · · , ip } ⊆ [nr ] such that
Eīk j̄l = 1, k = 1, · · · , p,

(19)

Eīk jl = 0, k = 1, · · · , p.

(20)

|Ij̄l | = p,

(21)

(īk , jl ) 6∈ M, 1 ≤ k ≤ p.

(22)

To establish this, we observe that, by assumption, we have that hEjl , Ej̄l i ≤ θc . So, as a first cut,
define I1 (j̄l ) = supp(j̄l ). This set consists of dc elements (and does not include i). Now examine
the values Eik j̄l . By the inner product constraint, out of the dc nonzero elements of I1 (j̄l ), no more
than θc can be nonzero (in column j1 ). Hence there are at least dc − θc elements in column jl such
that Eik jl = 0 and Eik j̄l = 1. Out of these, at most p − 1 elements can have the property that
(ik , jl ) ∈ M. Note that Eij1 = 0, but i is not on this list. Therefore, if dc − θc − (p − 1) ≥ p, that
is, dc − θc ≥ 2p − 1, then we can choose any p elements from whatever remains of the set I1 (j̄l ) and
call it the set I(j̄l ). Now the above-claimed properties follow by inspection.
To complete the proof, we remove each prohibited edge Eijl as follows: We choose any one
element from I(j̄l ), call it īl and simply “flip” the zeros and ones. Thus we set
(Ep )ijl = 0, (Ep )īl jl = 1,

(23)

(Ep )īl jl = 0, (Ep )ij̄l = 0.

(24)

Since the set I(j̄l ) has p elements for each l, we can ensure that the the vertices īl chosen for each
l are distinct. If we now write Ep as E − ∆− + ∆+ , it is evident that the three claims in the lemma
follow upon observation. The process can be repeated for each row i.
Now we present our result on perturbing a Ramanujan bigraph while retaining the Ramanujan
property.

17

Theorem 7. Suppose E is the biadjacency matrix of a (dr , dc )-biregular Ramanujan bigraph, and
define
p
p
(25)
µ(dr , dc ) := dr − 1 + dc − 1.

Let σ2 denote the second largest singular value of E. Next, suppose the set M of prohibited edges
does not contain more than p values of j for each fixed i, and more than p values of i for each fixed
j. Finally, suppose that
2p ≤ µ(dr , dc ) − σ2 .
(26)

Then the construction in Lemma 2 results in a (dr , dc )-biregular Ramanujan graph whose edge set
is disjoint from the set of prohibited edges M.
The proof of Theorem 7 makes of the following alternate characterization of a Ramanujan
bigraph. Note that k · kS denotes the spectral norm of a matrix, that is, its largest singular value.
Lemma 3. Suppose E ∈ {0, 1}nr ×nc . Then
1. The corresponding graph is (dr , dc )-biregular if and only if
⊤
E1nc = dr 1nr , 1⊤
nr E = dc 1nc ,

(27)

where 1k denotes the column vector of k ones.
2. Define the constant
dc
dr
=
=
α=
nc
nr

r

dr dc
.
nr nc

(28)

Suppose that (27) holds, so that the graph is (dr , dc )-biregular. Then the graph has the Ramanujan property if and only if
p
p
(29)
kE − α1nr ×nc kS ≤ dr − 1 + dc − 1 =: µ(dr , dc ).
where 1k×l denotes the k × l matrix of all ones.
Proof. The first statement is obvious. To √
prove the second, observe that due to biregularity,
the largest singular value of E is σ1 (E) = dr dc , with associated (normalized) singular vectors
√
√
(1/ nr )1nr and (1/ nc )1nc . Thus, the singular value decomposition (SVD) of E looks like
r
dr dc
E=
1n 1⊤ + M = α1nr ×nc + M,
n r n c r nc
where kM kS = σ2 (E), the second largest singular value of E. Now (29) follows from the definition
of a Ramanujan bigraph.
Proof. (Of Theorem 7.) The perturbed matrix Ep can be written as E − ∆− + ∆+ . Note that since
E and Ep are both (dr , dc )-biregular, the quantity α defined in (28) is the same for both E and
Ep = E − ∆− + ∆+ . Moreover, by construction, both ∆− and ∆+ have no more than p entries of
one in each row and each column. Therefore, by Lemma 3, it follows that E − ∆− + ∆+ represents
a (dr , dc )-biregular Ramanujan bigraph if
k(E − ∆− + ∆+ ) − α1nr ×nc kS ≤ µ(dr , dc ).

18

We already know from Lemma 3 that
kE − α1nr ×nc kS = σ2 (E).
Therefore the result follows if it can be established that
k∆− kS , k∆+ kS ≤ p.
Note that each of ∆+ and ∆− can be viewed as biadjacency matrices of bipartite graphs of maximum
degree p. Let σ be a singular value of ∆+ and let
v = [v1 v2 . . . vnc ]⊤
2
be an eigenvector of ∆⊤
+ ∆+ corresponding to the eigenvalue σ . That is,
2
(∆⊤
+ ∆+ )v = σ v.

We assume without loss of generality that
|v1 | = max |vi |.
1≤i≤nc

We now have,
σ 2 v1 = R1 (∆⊤
+ ∆+ )v,
where Ri (A) denotes the i-th row of a matrix A.
We also observe that
∆⊤
+ ∆+ = [aij ]1≤i,j≤nc ,
where aij equals the dot product hCi , Cj i of Ci and Cj , the i-th and j-th columns of ∆+ respectively.
This gives us
nc
X
2
hC1 , Cj ivj .
σ v1 =
j=1

That is,

nc
nc
X
X
hC1 , Cj i.
hC1 , Cj i|vj | ≤ |v1 |
σ |v1 | ≤
2

j=1

j=1

Pn c

We observe that each element of the vector j=1 Cj is at most p. Also, the vector C1 has at most
p number of 1’s. In other words, the dot product
hC1 ,

nc
X
j=1

Cj i ≤ p 2 .

Thus, σ 2 |v1 | ≤ p2 |v1 | and therefore, σ ≤ p for any singular value σ of ∆+ . We have used here,
a technique from the proof of [9, Theorem 1]. A similar analysis works for ∆− . Thus, it follows
that k∆+ kS ≤ p, k∆− kS ≤ p and therefore,
k∆+ − ∆− kS ≤ 2p.
This completes the proof.
19

7.3

Analysis of the Spectra of Ramanujan Graphs and Bigraphs

Lemma 3 shows that the greater the gap between σ2 (E) and the bound µ(dr , dc ), the more perturbation the Ramanujan graph can withstand while still remaining a Ramanujan graph. At first
glance this may appear to be a vacuous result, because the Alon-Boppana bound for graphs and
the Feng-Li bound for bigraphs shows that, as the graphs grow in size, the gap approaches zero.
Indeed, one of the major contributions of [2] is to construct infinitely many families of Ramanujan
graphs, with size approaching infinity, but fixed degree. However, in applications such as the matrix completion problem, the Alon-Boppana and Feng-Li bounds are not germane. As shown in [1,
Section 7], as the size of the unknown matrix (which is the size of the graph) grows, so must the
degree.
Both our new construction of the Ramanujan bigraphs and the Gunnells construction of Ramanujan graphs achieve a substantial gap between the degree d and the second largest singular
value σ2 . In the Gunnells construction, we get
v
u l−2
l−2
uX
p
p
X
√
i
l−2
q i ≈ 2 q l−2 , σ2 = q l−2 ,
q ≈ q , µ(d, d) = 2 d − 1 = 2t
d=
i=1

i=0

because, when q is large, the last term in various summations dominates the rest. Therefore
√
µ(d, d) − σ2 ≈ d − 1.
Similarly, for our construction in Theorem 3, with l = q, we have that
√
√
√
d = q, σ2 = q, µ(d, d) = 2 d − 1, µ(d, d) − σ2 ≈ d − 1.
It is also worth mentioning that if a bipartite graph has girth six or more, then the maximum inner
product θc = 1. Therefore (15) and (16) can be combined into the single bound
2p ≤ min{nc − dr , dc }.
It is clear that the operative bound is the second term dc . To illustrate these bounds, suppose we
construct a Ramanujan graph of size n = q 2 = 1012 and degree d = q = 101. Then we can avoid
any set of prohibited edges provided there are fewer than 50 edges in each row and each column,
and still preserve (q, q)-biregularity. Moreover, since µ(q, q) − σ2 ≥ 10, we can avoid any arbitrary
set of prohibited edges, provided that there are not more than ten such edges in each row and each
column.
One noteworthy feature of both our new construction and the Gunnells construction is the high
multiplicity of the second largest singular value. In our construction, other than the largest singular
value and zero (due to rank deficiency), all other singular values have the same value. In the case
of the Gunnells construction, other than the largest singular value, all other singular values have
the same magnitude, though some could be negative. This prompted us to analyze whether the
LPS and Bibak-et-al. constructions have a similar feature. It appears that, even in the case of the
LPS construction, the second largest singular value is repeated multiple times. Table 1 shows the
results for q = 13 and q = 17, for various values of p. The upper limit p = 157 was chosen because
every prime p ≡ 1 mod 4 leads to a simple graph (and not a multigraph), for both values of q.
We have thus far not found any pattern in the multiplicity of σ2 as a function of p and q; perhaps
this can be a topic for √
future research. Another noteworthy aspect is that σ2 is very close to the
Ramanujan bound of 2 d − 1 in all cases. In contrast, the Bibak-et-al. construction did not show
that σ2 had multiplicity more than one, for any p ≡ 3 mod 4, for p up to 103. We did not test the
Winnie Li construction due to the complexity of actually computing the constructions.
20

p
5
17
29
37
41
53
61
73
89
97
101
109
113
149
157

d
6
18
30
38
42
54
62
74
90
98
102
110
114
150
158

q=
√13, n = 1092
2 d−1
σ2
4.4721
4.2497
8.2462
7.8509
10.7703
9.9323
12.1655 11.3081
12.8062 11.4940
14.5602 12.2462
15.6205 13.9758
17.0880 15.3693
18.8680 17.8215
19.6977 17.8078
20.0998 19.0000
20.8806 19.0000
21.2603 20.6504
24.4131 21.6746
25.0599 22.4924

Mult.
36
24
36
42
24
42
12
42
42
42
28
13
12
24
39

p
5
13
29
37
41
53
61
73
89
97
101
109
113
149
157

d
6
14
30
38
42
54
62
74
90
98
102
110
114
150
158

q=
√17, n = 2448
2 d−1
σ2
4.4721
4.3089
7.2111
7.0902
10.7703 10.0000
12.1655 11.9855
12.8062 11.5321
14.5602 13.8995
15.6205 14.5826
17.0880 16.0192
18.8680 16.4721
19.6977 18.3848
20.0998 18.9750
20.8806 20.2648
21.2603 20.5253
24.4131 23.6574
25.0599 23.8885

Mult.
48
48
51
16
48
36
32
48
51
54
48
48
16
48
51

Table 1: The second largest singular value of the LPS graph (bipartite or otherwise), and its
multiplicity

8

Conclusions

As described in Section 7.1, a significant motivation for the study of explicit constructions of
Ramanujan graphs comes from the matrix completion problem. This theme was explored in detail
in [1] where it was shown that it is possible to guarantee exact completion of an unknown low rank
matrix, if the sampling set corresponds to the edge set of a Ramanujan bigraph. While that set of
results is interesting in itself, it has left open the question of just how Ramanujan bigraphs are to be
constructed. In the literature to date, there are relatively few explicit constructions of Ramanujan
graphs and balanced bigraphs, and no explicit constructions of an unbalanced Ramanujan bigraph.
In this paper, we presented for the first time an infinite family of unbalanced Ramanujan bigraphs
with explicitly constructed biadjacency matrices. In addition, we have also shown how to construct
the adjacency matrices for the currently available families of Ramanujan graphs. These explicit
constructions, as well as forthcoming ones based on [7, 8], are available for only a few combinations
of degree and size. In contrast, it is known from [20] and [21] that Ramanujan graphs are known to
exist for all degrees and all sizes. The main limiting factor is that these are only existence proofs
and do not lead to explicit constructions. A supposedly polynomial-time algorithm for constructing
Ramanujan graphs of all degrees and sizes is proposed in [22]. But it is still a conceptual algorithm
and no code has been made available. Therefore it is imperative to develop efficient implementations
of the ideas proposed in [21], and/or to develop other methods to construct Ramanujan graphs of
most degrees and sizes. We should also note that the work of [20] and [21] shows the existence
of balanced, bipartite graphs of all degrees and sizes. Therefore, in Section 5 of this article, we
have also looked at how the constructions of [2] and Gunnells [5] can be further analysed to derive
non-bipartite Ramanujan graphs.
It is worth pointing out that efficient solutions of the matrix completion problem do not really
require the existence of Ramanujan graphs of all sizes and degrees. It is enough if the “gaps” in
21

the permissible values for the degrees and the sizes are very small. If this extra freedom leads to
substantial simplification in the construction procedures, then it would be a worthwhile tradeoff.
However, research on this problem is still at a nascent stage.
Finally, in Section 7, we address another issue in the matrix completion problem, namely the
“missing measurements” problem. This leads to the problem of the construction of a Ramanujan
bigraph (not necessarily balanced) in which a certain set of edges is prohibited. In a typical real-life
application, the size of this set is small. In Section 7.2, we initiate the study of how a Ramanujan
bigraph can be perturbed so as to remove a set of prohibited edges while still retaining biregularity
and the Ramanujan condition. The set of prohibited edges considered is relatively small in size and
has some additional constraints. Nonetheless, this study is at an initial stage and “perturbing” a
Ramanujan bigraph by the set M with weaker conditions than we currently require would be an
interesting topic for future research.

Acknowledgements
The authors thank Professors Cristina Ballantine and Alex Lubotzky for helpful discussions during
the preparation of this article.

Declarations
S.P.B. was supported through a Senior Research Fellowship from the Ministry of Human Resource
Development, Government of India. K.S. was supported by a MATRICS grant from the Science
and Engineering Research Board (SERB), Department of Science and Technology, Government of
India. M.V. was supported by a SERB National Science Chair, Government of India. The authors
have not declared any conflicts of interest.
There is no data associated with this manuscript.

References
[1] S. P. Burnwal and M. Vidyasagar, “Deterministic completion of rectangular matrices using
asymmetric Ramanujan graphs: Exact and stable recovery,” IEEE Transactions on Signal
Processing, vol. 68, pp. 3834–3848, 2020.
[2] A. Lubotzky, R. Phillips, and P. Sarnak, “Ramanujan graphs,” Combinatorica, vol. 8, no. 3,
pp. 261–277, 1988.
[3] W. C. W. Li, “Character sums and Abelian Ramanujan graphs,” Journal of Number Theory,
vol. 41, pp. 199–217, 1992.
[4] M. Morgenstern, “Existence and explicit constructions of q + 1 regular Ramanujan graphs for
every prime power q,” Journal of Combinatorial Theory, Series B, vol. 62, no. 1, pp. 44–62,
1994.
[5] P. Gunnells, “Some elementary Ramanujan graphs,” Geometriae Dedicata, vol. 112, pp. 51–63,
2005.

22

[6] K. Bibak, B. M. Kapron, and V. Srinivasan, “The cayley graphs associated with some quasiperfect lee codes are ramanujan graphs,” IEEE Transactions on Information Theory, vol. 62,
no. 11, pp. 6355–6358, November 2016.
[7] C. Ballantine, B. Feigon, R. Ganapathy, J. Kool, K. Maurischat, and A. Wooding, “Explicit
construction of Ramanujan bigraphs,” in Women in Numbers in Europe. Springer Verlag,
2015, pp. 1–16.
[8] S. Evra and O. Parzanchevski, “Ramanujan complexes and golden gates in pu(3),”
arxiv:1810:04710v1, October 2018.
[9] M. R. Murty, “Ramanjuan graphs,” Journal of the Ramanujan Mathematical Society, vol. 18,
no. 1, pp. 1–20, 2003.
[10] G. Davidoff, P. Sarnak, and A. Valette, Elementary Number Theory, Group Theory, and
Ramanujan Graphs. Cambridge University Press, 2003.
[11] N. Alon, “Eigenvalues and expanders,” Combinatorica, vol. 8, no. 2, pp. 83–96, 1986.
[12] K. Feng and W.-C. W. Li, “Spectra of hypergraphs and applications,” Journal of number
theory, vol. 60, no. 1, pp. 1–22, 1996.
[13] J. Friedman, “A proof of Alon’s second eigenvalue conjecture,” in Proceedings of the thirty-fifth
annual ACM symposium on Theory of computing, 2003, pp. 720–724.
[14] ——, “A proof of Alon’s second eigenvalue conjecture and related problems,” Memoirs of the
American Mathematical Society, vol. 195, no. 910, 2008.
[15] G. Brito, I. Dumitriu, and K. D. Harris, “Spectral gap in random bipartite biregular graphs
and applications,” arxiv:1804.07808, 2018.
[16] C. Ballantine and D. Ciubotaru, “Ramanujan bigraphs associated with SU (3) over a p-adic
field,” Proceedings of the Amererican Mathematical Society, vol. 139, no. 6, pp. 1939–1953,
2011.
[17] J. L. Fan, “Array codes as ldpc codes,” in Proceedings of 2nd International Symposium on
turbo Codes, 2000, pp. 543–546.
[18] K. Yang and T. Helleseth, “On the minimum distance of array codes as LDPC codes,” IEEE
Transactions on Information Theory, vol. 49, no. 12, pp. 3268–3271, December 2003.
[19] A. Marcus, D. A. Spielman, and N. Srivastava, “Interlacing families i: Bipartite Ramanujan
graphs of all degrees,” in 2013 IEEE 54th Annual Symposium on Foundations of Computer
Science, October 2013, pp. 529–537.
[20] ——, “Interlacing families i: Bipartite Ramanujan graphs of all degrees,” Annals of Mathematics, vol. 182, no. 1, pp. 307–325, 2015.
[21] ——, “Interlacing families iv: Bipartite Ramanujan graphs of all sizes,” in 2015 IEEE 54th
Annual Symposium on Foundations of Computer Science, 2015, pp. 1358–1367.
[22] M. B. Cohen, “Ramanujan graphs in polynomial time,” arXiv:1604.03544v1.

23

[23] J. Tattersall, Elementary Number Theory in Nine Chapters.
1999.

Cambridge University Press,

[24] M. W. Baldoni, C. Ciliberto, and G. M. P. Cattaneo, Elementary Number Theory, Cryptography and Codes. Springer-Verlag, 2009.
[25] P. Deligne, “La conjecture de Weil. I. (French),” Institut des Hautes Études Scientifiques.
Publications Mathématiques, no. 43, pp. 273–307, 1974.
[26] L. Babai, “Group, graphs, algorithms: The graph isomorphism problem,” in Proceedings of
the International Congress of Mathematicians, 2018, pp. 3303–3320.
[27] I. Shparlinski, “On finding primitive roots in finite fields,” Theoretical Computer Science, vol.
157, no. 2, pp. 273–275, 1996.
[28] E. Candès and B. Recht, “Exact matrix completion via convex optimization,” Foundations of
of Computational Mathematics, vol. 9, pp. 717–772, 2008.
[29] B. Recht, M. Fazel, and P. Parrilo, “Guaranteed minimum rank solutions to linear matrix
equations via nuclear norm minimization,” SIAM Review, vol. 52(3), pp. 471–501, 2010.

24

