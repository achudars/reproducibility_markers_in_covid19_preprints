arXiv:1903.08405v1 [physics.med-ph] 20 Mar 2019

A C ALDERON R EGULARIZED S YMMETRIC F ORMULATION FOR
THE E LECTROENCEPHALOGRAPHY F ORWARD P ROBLEM

John E. Ortiz G. a,b
john.ortizguzman@polito.it

Axelle Pillain a
axelle.pillain@imt-atlantique.fr

Lyes Rahmouni a,b
lyes.rahmouni@polito.it

Francesco P. Andriulli b
francesco.andriulli@polito.it

30 October 2017
a
b

Computational Electromagnetics Research Laboratory, IMT Atlantique, Brest, France
Politecnico di Torino, Turin, Italy

A BSTRACT
The symmetric formulation of the electroencephalography (EEG) forward problem is a well-known
and widespread equation thanks to the high level of accuracy that it delivers. However, this equation
is first kind in nature and gives rise to ill-conditioned problems when the discretization density or
the brain conductivity contrast increases, resulting in numerical instabilities and increasingly slow
solutions. This work addresses and solves this problem by proposing a new regularized symmetric
formulation. The new scheme is obtained by leveraging on Calderon identities which allow to introduce a dual symmetric equation that, combined with the standard one, results in a second kind
operator which is both stable and well-conditioned under all the above mentioned conditions. The
new formulation presented here can be easily integrated into existing EEG imaging packages since it
can be obtained with the same computational technology required by the standard symmetric formulation. The performance of the new scheme is substantiated by both theoretical developments and
numerical results which corroborate the theory and show the practical impact of the new technique.
Keywords EEG · BEM · Calderon Solvers

1

Introduction

Functional brain imaging based on high-resolution scalp Electroencephalographies (EEGs) is characterized by a high
temporal resolution and, as such, it provides an unmatched overview on the underlying brain activity [1, 2, 3, 4]. This
technique relies on the key task, referred to as the EEG inverse problem, of recovering the brain electric current sources
responsible for a measured potential at the EEG scalp electrodes [5, 6]. The EEG inverse problem requires multiple
solutions of the EEG forward problem, i.e. the computation of the scalp potential starting from the source currents
[7, 8]. It has been widely studied and reported that the accuracy of EEG forward problem solvers has a direct impact
on EEG inverse solution procedures [9, 10, 11, 12]. For this reason, any advancement of the state of the art in EEG
forward solution technologies will have a direct impact on the overall high-resolution EEG imaging process.
When realistic head models are used [11, 13, 14, 15, 16, 17], the solution of the EEG forward problem can only be
obtained numerically. Classical strategies to obtain this numerical solution are the Finite Element Method (FEM), the
Finite Difference Method (FDM) or the Boundary Element Method (BEM) [18]. Both FDM and FEM leverage on
a volume discretization of the considered head model. This allows these methods to account for the inhomogeneity
and anisotropy of the head’s conductivity at the cost, however, of a higher computational demand. Previous works
have shown that by using transfer matrices the computation time of the FEM formulations can be reduced [19, 20].
The use of these transfer matrices in FEM formulations yield similar computational times as BEM formulations for
comparable accuracies. [21].

When the conductivity of the head is modelled as piecewise homogeneous, BEM can be easily used to compute the
solution of the EEG forward problem. In other words, the main limitation of the BEM formulation resides in its
inability to model anisotropies. However, this method has the advantage that it requires only the discretization of the
interface between regions with different conductivities [18, 22]. Several studies (for example [12, 23, 24]) focused
on the impact of the head model simplifications in recovering the electric brain sources from the measurement of
scalp potential. In particular, when computing the EEG forward problem, [25, 26, 27] have shown the importance of
modelling correctly the skull anisotropy. However, when the anisotropic conductivity values are not known, it can be
preferable to model this region as isotropic, as explained in [25]. Moreover, the anisotropic conductivity of the skull
is due to its layered structure, a cancellous bone between two compact bones. This means that when those three layers
are available, the skull can accurately be modelled with three isotropic layers instead of one anisotropic layer as [28]
shows.
The relevant computational savings which the use of BEM strategies can lead to, explain the attention the technique
has received by the community, resulting in a continuous series of advances [18, 29, 30, 31, 32, 33]. Among them a
method, published in [34] and referred to as the “symmetric formulation”, became quite popular and impacted several
EEG based imaging tools [35, 36, 37, 38]. The peculiarity of the BEM method proposed in [34] is the quite higher level
of accuracy that it can achieve when compared to previously existing schemes. However these beneficial properties
are obtained at the cost of using a first kind formulation (while the majority of standard strategies relies on second kind
formulations). The computational consequence of this fact is that, when the “symmetric formulation” is discretized
to be solved numerically, the condition number of the resulting BEM matrix (the ratio of the largest over the smallest
singular value of the matrix) will grow as a function of the discretization density (the number of boundary elements
used to discretize the structure) [39]. Similarly, a condition number growth is observed in the symmetric formulation
also when the conductivity contrast between two regions of the head is increased (a case of practical interest given that
the conductivity of the skull is often modeled with a much smaller value with respect to the conductivity of the brain
[11, 40, 41, 42]). In several cases, especially when handling models issued of high resolution Magnetic Resonance
Imaging (MRI) [43], the solution of the EEG forward problem is obtained iteratively [18, 44]. A low and stable
condition number is desirable since, on the one hand, the number of iterations of an iterative solver is growing with
the condition numbers [45] and, on the other hand, the condition number controls the amplification in the solution of
any initial error in the sources [45]. In other words, the higher the condition number, the longer the time needed to
compute the solution, and the less correct the solution will be.
The purpose of this work is to address the ill-conditioning problems of the symmetric formulation. Given the favor
that the formulation has found in the community and the fact that it is already implemented in several neuroimaging
packages, a particular attention will be devoted to develop a solution strategy that will be conservative, in the sense
that will not require the change of previous implementations of the symmetric formulation but will just require the
addition of some extra steps to it. This will be achieved by developing a purely multiplicative preconditioner based
on Calderon formulas, i.e. we will design a preconditioning matrix that is spectrally equivalent to the inverse of the
symmetric formulation. After left multiplication of this matrix with the symmetric formulation matrix, the resulting
linear system will, on the one hand, keep the accuracy the symmetric formulation is well known for and, on the other
hand, will provide a stable condition number both when the mesh is refined and when the conductivity contrast between
two adjacent domains increases. The reader should notice that Calderón strategies have been successfully applied to
the regularization of other integral operators in the context of full-wave vector electromagnetic problems scattered by
metallic [46, 47, 48, 49, 50, 51, 52, 53] and penetrable [54, 55, 56, 57] objects. The regularization presented here,
however, does not automatically follow from none of the strategies above due to the peculiar nature, both in terms of
frequency and operator structure/properties, of the symmetric formulation under consideration in this work. It should
also be noted that the problem of simulating high contrast dielectric materials has been addressed for high frequency
formulations with Calderon strategies both in [55] and [57]. Both of these two clever approaches, designed for the
vector case, are not applicable in our scalar scenario where the spectral high-contrast scaling expresses itself as a
block scaling issue due to the decoupling of electric and magnetic quantities characterizing a static problem. This
paper is organized as follows: Section 2 provides the reader with some necessary background material and notation
used in the following developments. Section 3 presents the new Calderon preconditioner proposed in this work,
while Section 4 focuses on its discretization and on the solution of the preconditioned symmetric formulation system.
Section 5 complements the paper’s theoretical developments with numerical results which will show the efficiency and
effectiveness of the new approach. Partial results from this work has been presented in the conference contribution
[58].

2

2

Background on the EEG Forward Problem

This section will briefly review the relevant formulations, currently available in literature, used to solve the EEG
forward problem. The treatment will be synthetic and for the sole purpose of setting up the notation. The reader
interested in a more profuse treatment should refer, for example to [34, 59] and to references therein.
2.1

The EEG Problem

SN
T S
T
Let Ω = i=1 Ωi be a nested domain with Lipchitz boundaries ∂Ωi = Ω̄i−1 Ω̄i
Ω̄i Ω̄i+1 as in Fig. 1. We
T
denote with ni the outward going normal to the surface Γi , where Γi = Ω̄i Ω̄i+1 .

Figure 1: Geometry under consideration.
Solving the EEG forward problem amounts to computing the potential V at given electrodes’ positions when the active
brain current sources are known. Under quasi-static assumptions and isotropic conductivity, the EEG forward problem
reads [60]:
σ∆V = ∇ · j in each Ωi
(1)
where ∆ = ∇ · ∇ is the Laplace operator, σ is the conductivity and j the current sources. The conductivity is assumed
to be piecewise isotropic and homogeneous: in Ωi , σ = σi . In the exterior domain, the conductivity is assumed to be
0. The current sources, as it is customary in literature [61], are assumed to be dipolar in nature. Hence, denoting with
fi = ∇ · j the electric source in Ωi , we have fi = qi · ∇δri with qi the electric dipole moment and r i its position.
Furthermore, the symbol [g]i = g − − g + , will refer to the jump of the function g at the interface Γi , with g ∓ the inner
and outer trace of g at Γi respectively. Then, the solvability of (1) is assured under the following boundary conditions
[60]:
[V ]i = 0 ∀i ≤ N
(2a)
[σn · ∇V ]i = 0 ∀i ≤ N
(2b)
that enforce the continuity of the potential and the current between the different layers of the domain Ω.
The Green’s function associated with (1) reads [39]
1
4π|r − r 0 |
for which we can derive Green’s representation theorem using the integral operators [39]
Z
SΨ(r) =
G(r, r0 )Ψ(r0 )dr0
∂Ω
Z
DΦ(r) = p.v.
∂n0 G(r, r0 )Φ(r0 )dr0
∂Ω
Z
D∗ Ψ(r) = p.v.
∂n G(r, r0 )Ψ(r0 )dr0 .
∂Ω
Z
N Φ(r) = f.p.
∂n ∂n0 G(r, r0 )Φ(r0 )dr0
G(r, r 0 ) =

∂Ω

3

(3)

(4a)
(4b)
(4c)
(4d)

In the above equation and p.v. and f.p stand for Cauchy principal value and Hadamard finite part respectively. In the
following, we will denote with Lij the operator L when r ∈ Γi and r0 ∈ Γj with L = D, S, N or D∗ .
2.2

The Symmetric Formulation for the EEG Forward Problem

Several BEM formulations have been proposed to solve the EEG forward problem [18, 34]. Among them, the symmetric formulation [34] is quite popular and known for providing high levels of accuracy [36]. In solving the EEG forward
problem, an efficient strategy is to build the unknown potential V starting from two functions, a function u harmonic
in R3 and a function v that takes into account the source term. The starting point of the symmetric formulation is to
build ui in each domain such that uRi = V − vi /σi in Ωi and u = −vi /σi in R3 \ Ωi , with vi the solution of (1)
in an unbounded medium: vi (r) = Ωi fi (r0 )G(r, r0 )dr0 . In this fashion, ui is harmonic in R3 \ ∂ Ω̄i = Γi−1 ∪ Γi .
Using the boundary conditions (2a) and (2b) as well as the representation theorem [39], two integral equations for the
potential and its derivative can be obtained [34]. They read:
−1
σi+1
(vi+1 )Γi − σi−1 (vi )Γi =


−1
−1
Di,i−1 Vi−1 − 2Dii Vi + Di,i+1 Vi+1 − σi−1 Si,i−1 pi−1 + σi−1 + σi+1
Sii pi − σi+1
Si,i+1 pi+1

(5)

(∂n vi+1 )Γi − (∂n vi )Γi =
∗
∗
∗
σi Ni,i−1 Vi−1 − (σi + σi+1 ) Nii Vi + σi+1 Ni,i+1 Vi+1 − Di,i−1
pi−1 + 2Dii
pi − Di,i+1
pi+1

(6)

with Vi the potential on the surface Γi and pi = σi [n · ∇V ]i . Equations (5) and (6) are obtained by applying the
boundary conditions on the surface Γi . In a nested domain, it only involves the computation of the operators with
functions defined in the surrounding surfaces Γi−1 , Γi and Γi+1 .To clarify the ideas, equations (5) and (6) have been
rewritten in matrix form in equation (7). For a more detailed explanation on the symmetric formulation, the reader is
referred to [34].


















∗
∗
(σ1 + σ2 ) N11 
−2D11
−σ2 N12
D12

−1
−1
−1
−2D11
σ1
+ σ2
S11
D12
−σ2
S12
∗
∗
···
(σ2 + σ3 ) N22 
−2D22
−σ2 N21
D21

−1
−1
−1
D21
−σ2
S21
−2D22
σ2
+ σ3
S22 · · ·

.
.
.

.
.
.

|












.

.

.



σN −1 + σN NN −1,N −1 
−2D∗ N −1,N
−σ
N
−1
N N −1,N 


−1
−1

−2DN −1,N −1
σN
+
σ
S
D
N −1,N −1
N −1,N
−1
N
−σN NN,N −1
DN,N −1
σN NN,N
{z
}
Z



(∂n v1 )Γ

1

− (∂n v2 )Γ

1




 V
−1
−1


1
σ2
(v2 )Γ − σ1
(v1 )Γ


1
1

 p1 

(∂n v2 )Γ − (∂n v3 )Γ


 V

2
2
2 



−1
−1


 p

σ
(v
)
−
σ
(v
)
2 
3 Γ2
2 Γ2



3
2

=

 . 


.
 . 


.
 . 


.





 −1

pN −1
−1
σN (vN )Γ −1 − σN −1 vN −1 Γ −1 
N
VN
N
(∂
v
)
| {z }
n N Γ
N
x
{z
}
|
b

(7)
2.3

Discretization of the Operators

The numerical solution of an integral equation is often obtained by using a Boundary Element Method (BEM). Following a well-established strategy, the surface Γ is tessellated into Nt triangular cells tk of area Ak and average length
v
h. The set of vertices of the tessellation will be denoted by {vk }N
k=1 . Cells and vertices will form a mesh denoted by
MΓ . The number of triangles (respectively, vertices) of the surface Γi will be denoted Nti (respectively, Nvi ). To
discretize the unknowns and to test the equations the following standard basis functions will be used. The piecewise
constant functions in P0 are defined such that, P0k = 1/Ak in tk and 0 elsewhere. The piecewise linear functions are
v
the set P1 = span{P1k }N
k=1 . The support of P1k , denoted by µP1k , is the set of triangles around vk such that P1k = 1
in vk and 0 on all other vertices. P0 and P1 functions are shown Fig. 3a and 3b respectively.
Following [34], on the surface Γi we respectively discretize the two unknowns Vi and pi with P1 and P0 basis functions
PN
PN
such that Vi = l v ak P1l and pi = l t bl P0l . In order to obtain the system matrix, the integral equations (5) and
4

(6) are tested with P0 and P1 basis functions respectively. The operator matrices arising are then given by
Z
[Dij ]kl =
Dij (P1l ) P0k (r)dr
tk
Z
[Sij ]kl =
Sij (P0l ) P0k (r)dr
tk
Z
[Nij ]kl =
Nij (P1l ) P1k (r)dr

(8a)
(8b)
(8c)

µP1i

[D∗ ij ]kl =

Z

∗
Dij
(P0l ) P1k (r)dr.

(8d)

µP1i

Consequently, the system to be solved reads Zx = b with Z given by
Z=

(σ1 + σ2 ) N11 
−2D∗ 11
−σ2 N12
D∗ 12
−1
−1
−1

S
D
−σ
σ
+
σ
−2D
11
12
11

2 S12
1
2


···
(σ2 + σ3 ) N22 
−2D∗ 22
−σ2 N21
D∗ 21

−1
−1
−1

σ2
+ σ3
S22 · · ·
D21
−σ2
S21
−2D22



.
.
.

.
.
..

.
.




















∗

−σ
N
σN −1 + σN NN −1,N −1 
−2D N −1,N

−1
N
N
−1,N


−1
−1

−2DN −1,N −1
σN
+
σ
S
D
N −1,N −1
N −1,N
−1
N
−σN NN,N −1
DN,N −1
σN NN,N

(9)
where
[x]2l−1 = al
[x]2l = bl

(10a)
(10b)


−1
σk+1
vk+1 − σk−1 vk P0k dr

(11a)

(∂n vk+1 − ∂n vk ) P1k dr.

(11b)

and where
Z
[b]2k =
µk

Z
[b]2k−1 =
tk

In the following, the operator associated with the matrix Z (obtained by replacing in (9) D, S, N, and D∗ with D, S,
N , and D∗ ) will be denoted by Z.

3

A Calderon Preconditioner for the Symmetric Formulation

The high accuracy of the symmetric BEM formulation [34] has made of it a very popular tool for solving the EEG
forward problem. However its system matrix suffers from ill-conditioning that can lead to the non-convergence of the
employed iterative solver used to compute the solution [45], which has to be used for high refined meshes where the
direct methods are impractical. Indeed, the operator S is compact [39]. This means that its spectrum will accumulate
at zero when the mesh is refined and it will therefore have a condition number increasing inversely proportional to the
average mesh length h. Moreover, the hypersingular operator N is an unbounded operator [39]. This implies that its
condition number will also grow with 1/h. Since these operators are the diagonal blocks of the matrix Z in (9) and the
off-diagonal blocks of the matrix are smoothers [62], it follows that the overall conditioning of Z will increase when
the mesh discretization will increase (h → 0).
By leveraging on the Calderon identities, it is possible to build a preconditioner for the system matrix Z. The rationale
behind our strategy can be understood by considering the continuous operators first. The Calderon identities that for
our approach read [63]
1
2
Sii Nii = I − Dii
(12a)
4
1
∗2
Nii Sii = I − Dii
(12b)
4
∗
Dii Sii = Dii Sii
(12c)
∗
∗
Dii Nii = Nii Dii
(12d)
5

where the symbol I stands for the identity operator. The spectral analysis of (12a) and (12b) shows that the operators
2
∗2
Sii Nii and Nii Sii are well conditioned. Indeed, given that D and D∗ are compact operators, then Dii
and Dii
are also
2
∗2
compact operators as a product of two compact operators. Then the spectrum of Dii
and Dii
is bounded above and
accumulates at zero. However, the presence of the identity operator in (12a) and (12b) guarantees that the spectrum of
the operators Sii Nii and Nii Sii will be approaching 1/4. In other words, Sii Nii and Nii Sii are second kind operators
whose spectrum accumulates at 1/4. This property can be exploited to build a left preconditioner for the symmetric
operator Z.
Before introducing the Calderon preconditioner, we present a regularization matrix for the coefficients of the symmetric operator, which is necessary for the stability of the matrix condition number with respect to the conductivity ratio
and for the correct behaviour of the subsequent mesh refinement preconditioner. Indeed, the symmetric operator is
unstable when there is a high conductivity contrast between two adjacent domains ,Ωi and Ωj , due to the conductivity
factors in the diagonal blocks of the matrix. These conductivity factors are given by a2l−1,2l−1 = σl + σl+1 and
−1
a2l,2l = σl−1 + σl+1
. As a consequence, in the case of high conductivity contrast between two adjacent domains, i.e.

asymptotically, when σσji → ∞, that is (σi + σj ) → ∞ when σi → ∞ or σi−1 + σj−1 → ∞ when σj → 0, the
max(σ ,σ )

condition number of the system matrix will grow as a function of the conductivity ratio CRij = min(σii,σjj) . Because
of high conductivity contrast between the brain and the skull [40, 41], this undesirable situation is likely to appear
when solving the EEG forward problem. To solve this problem, we will rescale with respect to the conductivity the
symmetric operator Z using a diagonal operator Q given by






Q= 





√

1
max(σ1 ,σ2 )

0
0

0
p

min(σ1 , σ2 )
0

√

0

0

···

0

0
0

···
···

1
max(σ2 ,σ3 )

0
..
.

0
..
.

0
..
.

0

0

0

p

min(σ2 , σ3 ) · · ·
..
..
.
.
0

0

0









0 


··· 
0
0

(13)

√1
σN

We then define a rescaled symmetric operator Zq as
Zq = QZQ =
√
√
(1 + R )N

∗
∗
−P2 N12
R21 D12
11 −2 R11 D11
√ 11
√
∗
+ R11 )S11
R12 D12
−P
 −2 R11 D11 (1√

√ 2 S12 ∗
 −P N

∗
R12 D21 (1 +
 √ 2 21

√R22 )N22 −2 R22 D22 · · ·


∗
R21 D21
−P2 S21
−2 R22 D22 (1 + R22 )S22 · · ·






.
.
.


.
.
.


.
.
.


p
∗


(1 + RN −1,N −1 )NN −1,N −1 −2 RN −1,N −1 DN −1,N −1
−PN NN −1,N


p
p

−2 RN −1,N −1 DN −1,N −1 (1 + p
RN −1,N −1 )SN −1,N −1
RN −1,N DN −1,N 
∗
RN −1,N DN,N
N
−PN NN,N −1
N,N
−1

(14)
with
min(σi , σi+1 )
σi
Rij =
, Pi = p
, Pi∗ =
max(σj , σj+1 )
max(σi−1 , σi ) max(σi , σi+1 )

p

min(σi−1 , σi ) min(σi , σi+1 )
σi

(15)

and Rij , Pi , Pi∗ ≤ 1. The asymptotic behaviour of those coefficients is presented in table 1 , from which we can
see that when CRij → ∞, none of the blocks of Zq tends to infinity. Furthermore, the diagonal blocks are bounded
between 1 and 2. Therefore the instability with respect to high conductivity ratio of the symmetric operator have been
solved.
Coefficient
Rij
Pi
Pi∗

σi → ∞
0
1
0

σi → 0
0
0
1

Table 1: Asymptotic behaviour of the different coefficients of Zq .

6

In order to simplify the notation for the following part, we write the regularized symmetric operator as
c N c D ∗ c N c D ∗
11

11

12

11

13

12

14

12

c23 D12 c24 S12
c21 D11 c22 S11
∗
∗
c31 N21 c32 D21
c33 N22 c34 D22

c41 D21 c42 S21 c43 D22 c44 S22
Zq = 
..
..

.
.










 (16)


c2N −3,2N −1 NN −1,N 


···
···
..
.

∗
c2N −3,2N −3 NN −1,N −1 c2N −3,2N −2 DN
−1,N −1
c2N −2,2N −3 DN −1,N −1 c2N −2,2N −2 SN −1,N −1 c2N −2,2N −1 DN −1,N
c2N −1,2N −3 NN,N −1 c2N −1,2N −2 DN,N −1 c2N −1,2N −1 NN,N

where the coefficients cij have the properties
cij = cji , c2i−1,2i−1 = c2i,2i

(17)

Now we present the Calderon preconditioner for the regularized symmetric operator Zq which is based on the Calderon
identities (12). We denote such preconditioning operator by Cq . Its definition is given in (18), where the constant
coefficients cij are the same as in (16).

 c S
−c D
c S
c D
11

11

12

11

13

12

14

12

∗
∗
−c21 D11 c22 N11 c23 D12 c24 N12
 c31 S21 c32 D21 c33 S22 −c34 D22

∗
∗
c42 N21 −c43 D22
c44 N22
 c41 D21
Cq = 
.
..

..
.











cN −2,N SN −1,N 

∗

···
···
..
.

cN −2,N −2 SN −1,N −1 −cN −2,N −1 DN −1,N −1
∗
−cN −1,N −2 DN
−1,N −1 cN −1,N −1 NN −1,N −1 cN −1,N DN −1,N
cN,N −2 SN,N −1
cN,N −1 DN,N −1
cN,N SN,N

(18)
∗
We highlight the minus signs present in the blocks Dii
, which are necessary for the compactness of the off diagonal
blocks when the preconditioner is applied. A minus sign is added in the Dii blocks as well for symmetry.
Then, as desired, Cq Zq is a block operator exhibiting the Calderon identities (12a) and (12b) in its diagonal up to the
multiplicative factor c2ii as can be seen in (19).
 2

c11 S11 N11 + K11
K12
K13
···
2
K21
c22 N11 S11 + K22
K23
· · ·

Cq Zq = 
(19)
K31
K32
c233 S22 N22 + K33 · · ·


..
..
..
..
.
.
.
.
∗
The terms denoted with Kij , contain linear combinations of the compact operators Dij Djk , Sij Njk , Sij Djk
, Dij Sjk ,
∗
∗
∗
Dij Njk , Nij Djk , Nij Sjk and Dij Djk . They read
n+1
X

K2n−1,2m−1 =

χm (i)(c2n−1,2i−1 c2i−1,2m−1 Sni Nim + (−1)δni χi c2n−1,2i c2i,2m−1 Dni Dim )

i=n−1

(20a)

− c2n−1,2m−1 Snm Nnm δnm
K2n,2m =

n+1
X

∗
∗
χm (i)((−1)δni c2n,2i−1 c2i−1,2m Dni
Dim
+ χi c2n,2i c2i,2m Nni Sim )

i=n−1

(20b)

− c2n,2m Nnm Snm δnm
K2n−1,2m =

n+1
X

∗
χm (i)(c2n−1,2i−1 c2i−1,2m Sni Dim
+ (−1)δni χi c2n−1,2i c2i,2m Dni Sim )

(20c)

∗
χm (i)((−1)δni c2n,2i−1 c2i−1,2m−1 Dni
Nim + χi c2n,2i c2i,2m−1 Nni Dim )

(20d)

i=n−1

K2n,2m−1 =

n+1
X
i=n−1

where the symbols χi , χm (i) are given by

χm (i) =

1
0

if |i − m| < 2
,
otherwise
7

(21)


χi =
and where δnm is the Kronecker’s delta


δij =

1
0
1
0

if i < N
,
otherwise

(22)

if i = j
.
otherwise

(23)

As shown previously, the terms Sii Nii and Nii Sii are well conditioned second kind operator matrices, as a consequence the terms cii Sii Nii cii Nii Sii will also be well conditioned with respect to the mesh parameter h since
1 < cii < 2. In order to show the compactness of the operators Kij , we analyze each operator product in them.
∗
∗
First, in the diagonal blocks K2n−1,2n−1 and K2n,2n we have the following products: Sni Nin , Nni Sin , Dni
Din
,
∗
∗
∗
Dni Din . The operators D and D are compact, therefore the products Dni Din and Dni Din are compact as well
[63]. The products Sni Nin , Nni Sin are present when i 6= n, then the operators Nin and Nni have a regular kernel
due to the lack of singularity. Hence, the products with the compact operators Sni and Sin are also compact operators [39, 64, 65]. Overall, in the diagonal block we have the sum of compact operators. In the off diagonal blocks
∗
∗
K2n−1,2m−1 , K2n,2m , when n 6= m, we have the products Sni Nim , Dni Dim , Dni
Dim
, Nni Sim . As stated before,
the product of the D∗ and D are compact. Moreover, in the products Sni Nim and Nni Sim at least one of the operators
has a regular kernel, since n 6= m. Hence, these products yield compact operators [64, 65]. Finally, for the off diagonal
∗
∗
blocks K2n−1,2m , K2n,2m−1 we have the following products: Sni Dim
, Dni Sim , Dni
Nim , Nni Dim . The products
∗
Sni Dim and Dni Sim are clearly compact, since all the operators involved are compact. The only not-compact terms
∗
are present in the products Dni
Nim and Nni Dim when n = i = m. However, recalling the Calderon identity (12d)
and the properties (17), we have
∗
∗
− c2n,2n−1 c2n−1,2n−1 Dnn
Nnn + c2n,2n c2n,2n−1 Nnn Dnn
=0

(24)

which is true for the continues operators. When the operators are discretized, this cancellation is not exact, however
the residue tends to zero.
Then, we can write
C q Zq = A + B
with



 [A]2l−1,2l−1
[A]2l,2l


[A]ij

=c22l−1,2l−1 Sll Nll
=c22l,2l Nll Sll
=0 if i 6= j

and B such that [B]ij = Kij , Cq Zq can be seen as the sum of the well conditioned matrix A and a compact perturbation
B (as the operators Kij are compact operators). We can therefore expect the operator Cq Zq to be well conditioned
with respect to the mesh parameter.
For now on, we will refer to the product
Zc = Cq Zq ,
(25)
as the Calderon-Symmetric operator, which is well conditioned for both mesh refinement and conductivity ratio between adjacent surfaces.

4

Discretization of the Calderon Preconditioner and Solution of the Preconditioned
Symmetric Formulation

In order to solve the preconditioned symmetric integral equation, the proposed multiplicative preconditioner Cq has
to be discretized. This discretization should be carried out with care. In fact, the preconditioned operator in (25) will
contain operator products which will not directly translate into matrix products in the general case. A suitable choice
of basis functions should be made to guarantee that this could instead be the case here. To fix the ideas, we could
consider the discretization of the operator product N11 S11 appearing in the top-left block of Zc . The matrix S11 is
obtained by using test and trial functions in P0 while the matrix N11 is obtained by using test and trial functions in P1 .
Yet the number of vertices Nt and the number of cells that defines the dimensions of the space P1 and P0 are different.
As a consequence, the blocks N11 and S11 do not have compatible shapes and cannot be multiplied. Furthermore,
the basis functions used for discretizing N11 and S11 must satisfy appropriate inf-sup conditions with respect to the
duality pairing hv, wi : H 1/2 (Γ1 ) × H −1/2 (Γ1 ) → R (the reader should refer to [66] for further technical details
on this topic). This condition enables to get a stable condition number for the Gram matrices, necessarily present in
the discretized system as they orthonormalize the two chosen basis and testing functions sets. To properly take care
8

of this fact, we propose to discretize the preconditioner Cq on the dual mesh MΩ∗ of the standard mesh MΩ and to
leverage on the dual basis functions introduced in [67] on such a mesh. In the dual mesh, each vertex corresponds to
a cell of the standard mesh and vice-versa. This means that in MΩ∗ we can build a discrete space in H 1/2 (Γ) which
has the same dimension as the discrete space associated with H −1/2 (Γ) in MΩ and vice-versa. Moreover, the dual
basis functions introduced by [67] abide by the inf-sup conditions required to obtain stable discrete products [66]. As a
consequence, the discretization of the preconditioner operator Cq by using these basis functions enables to perform the
matrix multiplication associated with the operator multiplication Cq Zq in such a way that the spectral bounds holding
for the continuous operator products will translate in well-conditioned matrix products.
The dual mesh MΩ∗ can be obtained by barycentric refinement of the standard mesh MΩ by dividing the triangles
tk into six smaller triangles tbk whose edges are built by tracing the medians of the standard triangles tk [67]. The
cells ck of MΩ∗ are defined as the set of triangle tbk sharing a common vertex vk of MΩ . The vertices of MΩ∗ are the
barycenters bk of the triangles tk in MΩ . The reader should refer to Fig. 2 for an example of such a refinement.

Figure 2: Standard Mesh in bold lines, its barycentric refinement in thin lines. Three cells of the dual mesh are
evidenced. The coefficients κ are the coefficients used in the linear combination of primal P1 functions to build the
dual P̃1 functions: κ1 = 1, κi = 1/2 if i ∈ 2, 3, 4 and κi = 1/t if i ∈ 5, 6, 7, with t the number of triangles in MΩ
sharing the corresponding node.

t
In MΩ∗ , we define the dual piecewise linear functions P˜1 = span{P̃1k }N
k=1 obtained with a linear combination of
P1 functions built on the barycentric refined mesh [67]. A dual piecewise linear function is shown Fig. 3d. The
coefficients of the linear combination are shown Fig. 2. The support of P̃1i is denoted µP̃1 . The dual piecewise
i
constant functions in P˜0 , denoted P̃0k , are the constant functions equal to 1/Ack on the cell ck , whose area is Ack , of
MΩ∗ and equal to zero elsewhere. A dual piecewise constant function is shown in Fig. 3c. An extended explanation of
the dual mesh and dual basis functions is given by [67].

Then the operators matrices used to build Cq are given by:
Z
[D̃ij ]kl =

Dij (P̃1l ) P̃0k (r)dr

(26a)

Sij (P̃0l )P̃0k (r)dr

(26b)

ck

Z
[S̃ij ]kl =
c

Zk
[Ñij ]kl =

Nij (P̃1l )P̃1k (r)dr

(26c)

∗
Dij
(P̃0l )P̃1k (r)dr.

(26d)

µP̃

1k

[D̃∗ij ]kl =

Z
µP̃

1k

9

(a) P0 function

(b) P1 function

(c) P̃0 function

(d) P̃1 function

Figure 3: Basis and testing functions, in the standard mesh (3a, 3b) and in the dual mesh (3c, 3d)
and the discretized preconditioner C̃q is made explicit as

c11 S̃11
c21 D̃∗11

 c31 S̃21

c41 D̃∗21
C̃q = 






c12 D̃11
c22 Ñ11
c32 D̃21
c42 Ñ21

c13 S̃12
c23 D̃∗12
c33 S̃22
c43 D̃∗22
..
.

c14 D̃12
c24 Ñ12
c34 D̃22
c44 Ñ22
..
.



···
···
..
.
cN −1,N −2 D̃∗N−1,N−1 cN −1,N −1 ÑN−1,N−1 cN −1,N D̃∗N−1,N
cN,N −2 S̃N,N−1
cN,N −1 D̃N,N−1
cN,N ÑN,N











(27)

The final preconditioner is then obtained by introducing the necessary rescaling to obtain a uniform conditioning with
respect to the conductivity profiles (according to the analysis of the previous section).
In order to perform the multiplication of matrices with two different discretizations, a Gram matrix G to link them is
necessary. This Gram matrix is computed by taking the scalar product between the trial functions of one operator and
the test functions of the other operator. Hence, the computation of the Gram matrix does not require the evaluation of
any operator. Additionally, it is almost diagonal, therefore the computational cost is very low. This matrix is obtained
as
Z
(P˜0l ) P1k (r)dr
(28a)
[G2i−1 ]kl =
µP̃

1k

Z
[G2i ]kl =

(P˜1l ) P0k (r)dr.

(28b)

tk

Finally, the discretization of the Calderon symmetric operator is given by
Zc = C̃q G−1 Zq

(29)

where Zq = QZq Q. The solution of the preconditioned symmetric formulation is then obtained by solving the
following system Zc y = Cq G−1 Qb and x is obtained with x = Qy.
Summarizing, the Calderon preconditioning strategy is multiplicative in nature. Its aim is to build a preconditioning
operator spectrally equivalent to the inverse of the original operator. Thus, once this operator is built, multiplying the
ill-conditioned operator with it yields an operator spectrally equivalent to an identity. The preconditioning operator is
built on a dual mesh in order to allow matrix multiplication and stability. Moreover, regularization matrices are added
in order to get a condition number independent of the conductivity ratio. In a nutshell, the steps are:
10

1. Compute the standard symmetric system matrix Z;
2. Compute the Calderon preconditioning matrix C̃q on the dual mesh;
3. Compute the Gram matrices linking the dual and standard discretization, known as Gram matrices G;
4. Normalize the operator Z with the regularization matrices Q;
5. Perform the multiplication Zc = C̃q G−1 Zq ;
6. The right hand side b must be modified accordingly : compute bc = C̃q G−1 Qb;
7. Solve the system Zc y = bc ;
8. Get the solution using x = Qy.

5

Numerical Results

(a) Three spheres model

(b) MRI-obtained model

Figure 4: Head models used for testing the Calderon-Symmetric formulation
The new Calderon regularized symmetric formulation proposed in this work has been first tested on the canonical
scenario of three homogeneous and concentric spheres of radii 0.8, 0.9, and 1 in normalized units respectively. Such
model is shown in Fig. 4a. Indeed, in the case of homogeneous nested spheres, an analytical solution is available as a
reference [68, 69], this solution will be denoted with Vref . In these simulations, a single dipole source is placed in (0,
0, 0.5) with a dipole moment of (0, 0, 1) and the normalized conductivity of the layers is chosen to be 1, 0.0125 and 1
starting from the inner domain, which are the conductivity values used in the standard symmetric formulation in [34].
As a complement to these results, and to validate the new formulation on a real case scenario, the new formulation has
been tested also on a realistic head model obtained from MRI data , which is presented in Fig. 4b.
5.1

Assessments on accuracy and condition number

The first test conducted aimed at verifying that applying the proposed preconditioner to the symmetric formulation
||V
−Vref ||
does not modify its accuracy. The assessment parameter is the relative error computed as RE = num
where
||Vref ||
Vnum refers to the numerical solution. In Fig. 5a and Fig. 5b it is shown that the Calderon preconditioned symmetric
formulation and the non preconditioned symmetric formulation provide exactly the same accuracy for different mesh
refinement levels and different conductivity ratios respectively. This means that the proposed preconditioner does
not alter the accuracy of the initial formulation. These figures also confirm the higher level of accuracy that the
symmetric formulation can reach with respect to two others existing BEM formulations, namely the adjoint double
layer formulation and the double layer formulation.
In the second test we compared the condition numbers of the preconditioned and the non preconditioned symmetric
formulation system matrices . The variation of the condition number with respect to the mesh refinement is shown
11

101

Adjoint Double Layer
Double Layer
Symmetric
Calderon Symmetric

100

Relative Error

Relative Error

101

10-1

Adjoint Double Layer
Double Layer
Symmetric
Calderon Symmetric

100

10-1

10-2
1

2

3

4

5

6

10-2

7

0

50

1/h

100

150

200

Conductivity Ratio

(a) Accuracy vs Edge

(b) Accuracy vs Conductivity Ratio

Figure 5: Accuracy of different boundary integral formulations of the EEG forward problem

in Fig. 6a. We see that the condition number of the symmetric formulation grows rapidly with the mesh refinement
parameter 1/h while the condition number of the proposed formulation stays constant as expected by the theory.
In Fig. 6b is presented the condition number when the conductivity ratio increases. Here, we can see that the new
formulation has a condition number independent of the conductivity contrast.

5000

2500
Symmetric
Calderon Symmetric

4000

Condition Number

Condition Number

Symmetric
Calderon Symmetric

3000
2000
1000
0

1

2

3

4

5

6

7

8

9

2000
1500
1000
500
0

10

1/h

0

50

100

150

200

250

300

Conductivity Ratio

(a) Condition number vs Edge

(b) Condition number vs Conductivity Ratio

Figure 6: Condition number of the Symmetric Formulation and Calderon-Symmetric formulation.
The third test aimed at showing the efficiency in terms of number of iterations of the proposed preconditioner. For
different spectral indices 1/h, we present in Fig. 7a the number of iterations needed for a Conjugate Gradient Square
(CGS) solver to reach a relative residual error of 10−6 . In this figure, it is clear that only with the proposed Calderon
preconditioner this number of iterations stays constant with the mesh refinement. The number of iterations for increasing conductivity ratio is shown in Fig. 7b. In this case, all the preconditioners lead to a constant number of iterations.
Still, the best performance is given by the Calderon preconditioner.
5.2

Assessments on time

Since for small number of unknowns direct solvers can be used to solve the obtained system of equations, a preconditioner is only useful when the number of unknowns becomes too high for direct inversion, that is when it is necessary
to use iterative solvers. Indeed, if N denotes the number of unknowns, then the complexity of a direct solver is O(N 3 )
while the complexity of an iterative solver is O(kN 2 ), where k is the number of iterations needed to reach a desired
accuracy. However, for high number of unknowns, given that BEM matrices are dense, the time needed to compute the
system matrix is also increasing. To deal with this issue and to show the benefits of the proposed Calderon preconditioner in a high number of unknowns context we coupled it with an Adaptive Cross Approximation (ACA) algorithm
[70], that provides a compressed version of the system matrix.
The time necessary to compute the solution for different numbers of unknown is shown Fig.8. In this test, we compare
the performance of direct and iterative solutions with or without the proposed Calderon preconditioner. It is clear
12

600
Symmetric Formulation
Diagonal Preconditioner
ILU Preconditioner
Calderon Preconditioner

103

Symmetric Formulation
Diagonal Preconditioner
ILU Preconditioner
Calderon Preconditioner

500

Iterations

Iterations

104

102

400
300
200
100

10

1

0

5

10

15

20

0

25

0

50

100

150

200

Conductivity Ratio

1/h

(a) Number of iterations vs Edge

(b) Number of iterations vs Conductivity Ratio

Figure 7: Number of iterations for an accuracy of 1e-6 for different preconditioners.
that direct inversion (DI) has, as expected, a time complexity that increases rapidly with N . This prevents the use of
this solver for very detailed models. The iterative solver used is the CGS algorithm. We see that without using any
preconditioner the time necessary to obtain the solution with this iterative solver is also increasing with the number
of unknowns even if this choice of solver is faster than DI. This is due to the fact the number of iterations increases
with the mesh refinement parameter (due to the ill-conditioning of the matrices). However, employing the proposed
Calderon preconditioner solves this issue.
The time for computing the dense and compressed Calderon-Symmetric operator is presented in Fig. 9. It can be seen
that the use of the ACA yields in a linear time complexity
105

Time (s)

DI - of dSO
CGS - of dSO
CGS - of cSO
CGS - of cCSO

100

0

1

2

3

Number of Unknowns

4

5
104

Figure 8: Time for solving one equation with respect to the mesh refinement. DI - Direct Inversion (DI), CGS
- Conjugate Gradient Square, dSO - dense Symmetric Operator, cSO - compressed Symmetric Operator, cCSO compressed Calderon-Symmetric Operator
5.3

Assessments on a MRI-obtained head model

Finally, we seek to assess the performance of the proposed preconditioner in a realistic scenario that consists in
computing a leadfield matrix using a head model obtained from MRI data. This matrix that provides the propagation
model between known brain electric current sources and electrodes situated at the surface of the head of a patient is
a key element in distributed inverse solution. For this purpose, we constructed a three layer mesh using [35]. These
layers model the brain, the skull, and the scalp. They contain 11850, 11616 and 22948 triangular cells respectively.
The potential generated on the scalp by a single dipole situated in the brain is presented Fig. 10a. This figure also
shows the position of the 21 electrodes for which we computed the leadfield matrix. The error when the CalderonSymmetric formulation is solved with the ACA compared with the original Symmetric formulation solved with direct
inversion is displayed Fig. 10b. It can be seen that the error is never greater than 0.05%. To fill-in the leadfield matrix,
we placed 1500 unitary dipole source in the brain layer, each having an orientation orthogonal to the brain surface.
Using reciprocity [71], the forward model is then solved at each electrode position. We compared in Table 2, for four
different cases, the time needed to compute the operator, the time needed to solve the forward system once, and the
13

× 104

Time (s)

15

DSO
cCSO

10

5

0

0

0.5

1

1.5

2
× 105

Number of Unknowns

Figure 9: Time for computing the different Operators with respect to the mesh refinement. DSO - Dense Symmetric
Operator, cCSO - compressed Calderon-Symmetric Operator
Method
DI Dense Symmetric
CGS Dense Symmetric
CGS Compressed Symmetric
CGS Compressed Calderon-Symmetric

Memory (GB)
16.234
16.234
1.254
2.542

Operator Time (s)
10845.67
10845.67
1436.63
7888.86

Solution Time (s)
54609.99
7294.61
2322.89
62.40

Lead Field Time (h)
18.19
45.56
13.95
2.56

Table 2: Memory and computation time information for computing a lead field matrix using the reciprocity method

time needed to compute the full leadfield matrix. Hence, the total time needed to get the leadfield matrix is given
by the sum of the computation for obtaining the operator and the leadfield matrix. It can be seen that even if the
time necessary to compute the compressed Calderon-Symmetric operator is greater than the compressed Symmetric
operator, the fast convergence of the new method allows to compute the complete leadfield matrix in 2.56 hours, that is
almost 10 times faster than without the proposed preconditioner. This compensates largely the computation overload
in computing the preconditioning operator.

(a) Computed potential with a realistic mesh

(b) Error of the cCSO compared with DSO

Figure 10: MRI-obtained head model

14

6

Conclusion

In this work, leveraging on Calderon identities, we have proposed a Calderon preconditioned symmetric formulation
for the EEG forward problem. When compared to the standard symmetric equation, the proposed formulation has the
advantage of showing constant condition numbers both as a function of the mesh refinement and of the conductivity
contrast. Employing this preconditioner does not degrade the accuracy of the symmetric formulation. This means that,
for a given relative accuracy of the solution, the proposed formulation converges substantially faster than the standard
one. Moreover, the integration of the proposed approach into existing symmetric formulation implementations is
achieved only at the cost of computing, on a barycentric refined mesh, the preconditioning operators with already
existing tools. Numerical results have substantiated the theoretical claims and have shown the practical impact of the
newly proposed scheme.

Acknowledgement
This work was supported in part by CominLabs project SABRE under the reference ANR-10-LABX-07-01, in part
by the ANSES project ECLAIR under the grant EST-2016-2 RF-23, and in part by the European Research Council
(ERC) under the European Union’s Horizon 2020 research and innovation programme (grant agreement No 724846,
project 321).

References
[1] M Gavaret, L Maillard, and J Jung. High-resolution EEG (HR-EEG) and magnetoencephalography (MEG).
Neurophysiologie Clinique/Clinical Neurophysiology, 45(1):105–111, 2015.
[2] Christoph M Michel and Micah M Murray. Towards the utilization of EEG as a brain imaging tool. Neuroimage,
61(2):371–385, 2012.
[3] Uwe Schmitt, Alfred K Louis, Felix Darvas, Helmut Buchner, and Manfred Fuchs. Numerical aspects of spatiotemporal current density reconstruction from EEG-/MEG-data. IEEE Trans. Med. Imaging, 20(4):314–324,
2001.
[4] James W Phillips, Richard M Leahy, and John C Mosher. MEG-based imaging of focal neuronal current sources.
Medical Imaging, IEEE Transactions on, 16(3):338–348, 1997.
[5] Chris Plummer, A Simon Harvey, and Mark Cook. EEG source localization in focal epilepsy: where are we
now? Epilepsia, 49(2):201–218, 2008.
[6] Jasmine Song, Colin Davey, Catherine Poulsen, Phan Luu, Sergei Turovets, Erik Anderson, Kai Li, and Don
Tucker. EEG source localization: Sensor density and head surface coverage. 256:9–21.
[7] Roberta Grech, Tracey Cassar, Joseph Muscat, Kenneth P Camilleri, Simon G Fabri, Michalis Zervakis, Petros
Xanthopoulos, Vangelis Sakkalis, and Bart Vanrumste. Review on solving the inverse problem in EEG source
analysis. Journal of neuroengineering and rehabilitation, 5(1):25, 2008.
[8] David K Hammond, Benoit Scherrer, and Simon K Warfield. Cortical graph smoothing: a novel method for
exploiting DWI-derived anatomical brain connectivity to improve EEG source estimation. Medical Imaging,
IEEE Transactions on, 32(10):1952–1963, 2013.
[9] Manfred Fuchs, Michael Wagner, and Jörn Kastner. Boundary element method volume conductor models for
EEG source reconstruction. Clinical neurophysiology, 112(8):1400–1407, 2001.
[10] Robert Oostenveld and Thom F Oostendorp. Validating the boundary element method for forward and inverse
EEG computations in the presence of a hole in the skull. Human brain mapping, 17(3):179–192, 2002.
[11] Zeynep Akalin Acar and Scott Makeig. Effects of forward model errors on EEG source localization. Brain
topography, 26(3):378–396, 2013.
[12] Jae-Hyun Cho, Johannes Vorwerk, Carsten H Wolters, and Thomas R Knösche. Influence of the head model on
EEG and MEG source connectivity analyses. Neuroimage, 110:60–77, 2015.
[13] B Yvert, O Bertrand, M Thevenet, JF Echallier, and J Pernier. A systematic evaluation of the spherical model
accuracy in EEG dipole localization. Electroencephalography and clinical neurophysiology, 102(5):452–459,
1997.
[14] B Neil Cuffin. EEG localization accuracy improvements using realistically shaped head models. Biomedical
Engineering, IEEE Transactions on, 43(3):299–303, 1996.
15

[15] Federica Vatta, Fabio Meneghini, Fabrizio Esposito, Stefano Mininel, and Francesco Di Salle. Realistic and
spherical head modeling for EEG forward problem solution: a comparative cortex-based analysis. Computational
intelligence and neuroscience, 2010:13, 2010.
[16] Michael Rullmann, Alfred Anwander, Moritz Dannhauer, Simon K Warfield, Frank H Duffy, and Carsten H
Wolters. EEG source analysis of epileptiform activity using a 1 mm anisotropic hexahedra finite element head
model. NeuroImage, 44(2):399–410, 2009.
[17] Ümit Aydin, Johannes Vorwerk, Philipp Küpper, Marcel Heers, Harald Kugel, Andreas Galka, Laith Hamid,
Jörg Wellmer, Christoph Kellinghaus, Stefan Rampp, et al. Combining EEG and MEG for the reconstruction of
epileptic activity using a calibrated realistic volume conductor model. PloS one, 9(3):e93154, 2014.
[18] Hans Hallez, Bart Vanrumste, Roberta Grech, Joseph Muscat, Wim De Clercq, Anneleen Vergult, Yves
D’Asseler, Kenneth P Camilleri, Simon G Fabri, Sabine Van Huffel, et al. Review on solving the forward
problem in EEG source analysis. Journal of neuroengineering and rehabilitation, 4(1):46, 2007.
[19] Florian Drechsler, Carsten H Wolters, Thomas Dierkes, Hang Si, and Lars Grasedyck. A full subtraction approach for finite element method based source analysis using constrained delaunay tetrahedralisation. NeuroImage, 46(4):1055–1065, 2009.
[20] Nevzat G Gençer and Can E Acar. Sensitivity of EEG and MEG measurements to tissue conductivity. Physics
in medicine and biology, 49(5):701, 2004.
[21] J Vorwerk1 , M Clerc, M Burger, and CH Wolters1 . Comparison of boundary element and finite element approaches to the EEG forward problem. Biomed Tech, 57:1, 2012.
[22] Matti Stenroos, Alexander Hunold, and Jens Haueisen. Comparison of three-shell and simplified volume conductor models in magnetoencephalography. Neuroimage, 94:337–348, 2014.
[23] Jens Haueisen, Ceon Ramon, Michael Eiselt, Hartmut Brauer, and Hannes Nowak. Influence of tissue resistivities on neuromagnetic fields and electric potentials studied with a finite element model of the head. IEEE
Transactions on Biomedical Engineering, 44(8):727–735, 1997.
[24] Ceon Ramon, P Schimpf, J Haueisen, M Holmes, and A Ishimaru. Role of soft bone, CSF and gray matter in
EEG simulations. Brain topography, 16(4):245–248, 2004.
[25] Johannes Vorwerk, Jae-Hyun Cho, Stefan Rampp, Hajo Hamer, Thomas R Knösche, and Carsten H Wolters. A
guideline for head volume conductor modeling in EEG and MEG. NeuroImage, 100:590–607, 2014.
[26] Carsten Hermann Wolters, Alfred Anwander, X Tricoche, D Weinstein, Martin A Koch, and Robert S Macleod.
Influence of tissue conductivity anisotropy on EEG/MEG field and return current computation in a realistic
head model: a simulation and visualization study using high-resolution finite element modeling. NeuroImage,
30(3):813–826, 2006.
[27] Gildas Marin, Christophe Guerin, Sylvain Baillet, Line Garnero, and Gérard Meunier. Influence of skull
anisotropy for the forward and inverse problem in EEG: simulation studies using fem on realistic head models. Human brain mapping, 6(4):250–269, 1998.
[28] Moritz Dannhauer, Benjamin Lanfer, Carsten H Wolters, and Thomas R Knösche. Modeling of the human skull
in EEG source analysis. Human brain mapping, 32(9):1383–1399, 2011.
[29] Matti S Hamalainen and Jukka Sarvas. Realistic conductivity geometry model of the human head for interpretation of neuromagnetic data. Biomedical Engineering, IEEE Transactions on, 36(2):165–171, 1989.
[30] Manfred Fuchs, Ralf Drenckhahn, Hans-Aloys Wischmann, and Michael Wagner. An improved boundary
element method for realistic volume-conductor modeling. Biomedical Engineering, IEEE Transactions on,
45(8):980–997, 1998.
[31] Johan HM Frijns, Sander L De Snoo, and Ruurd Schoonhoven. Improving the accuracy of the boundary element
method by the use of second-order interpolation functions [EEG modeling application]. Biomedical Engineering,
IEEE Transactions on, 47(10):1336–1346, 2000.
[32] Seppo P Ahlfors, Jooman Han, John W Belliveau, and Matti S Hämäläinen. Sensitivity of MEG and EEG to
source orientation. Brain topography, 23(3):227–232, 2010.
[33] CJ Chu, N Tanaka, J Diaz, BL Edlow, O Wu, M Hämäläinen, S Stufflebeam, SS Cash, and MA Kramer. EEG
functional connectivity is partially predicted by underlying white matter connectivity. NeuroImage, 108:23–33,
2015.
[34] Jan Kybic, Maureen Clerc, Toufic Abboud, Olivier Faugeras, Renaud Keriven, and Théo Papadopoulo. A common formalism for the integral formulations of the forward EEG problem. Medical Imaging, IEEE Transactions
on, 24(1):12–28, 2005.
16

[35] Robert Oostenveld, Pascal Fries, Eric Maris, and Jan-Mathijs Schoffelen. FieldTrip: open source software
for advanced analysis of MEG, EEG, and invasive electrophysiological data. Computational intelligence and
neuroscience, 2011, 2010.
[36] Alexandre Gramfort, Théodore Papadopoulo, Emmanuel Olivi, Maureen Clerc, et al. OpenMEEG: opensource
software for quasistatic bioelectromagnetics. Biomed. Eng. Online, 9(1):45, 2010.
[37] François Tadel, Sylvain Baillet, John C Mosher, Dimitrios Pantazis, and Richard M Leahy. Brainstorm: a userfriendly application for MEG/EEG analysis. Computational intelligence and neuroscience, 2011:8, 2011.
[38] Sarang S Dalal, Johanna M Zumer, Adrian G Guggisberg, Michael Trumpis, Daniel DE Wong, Kensuke Sekihara, and Srikantan S Nagarajan. MEG/EEG source reconstruction, statistical evaluation, and visualization with
NUTMEG. Computational intelligence and neuroscience, 2011, 2011.
[39] Olaf Steinbach. Numerical approximation methods for elliptic boundary value problems: finite and boundary
elements. Springer Science & Business Media, 2007.
[40] Y Lai, W Van Drongelen, L Ding, KE Hecox, VL Towle, DM Frim, and B He. Estimation of in vivo human brainto-skull conductivity ratio from simultaneous extra-and intra-cranial electrical potential recordings. Clinical
neurophysiology, 116(2):456–465, 2005.
[41] Yingchun Zhang, Wim van Drongelen, and Bin He. Estimation of in vivo brain-to-skull conductivity ratio in
humans. Applied physics letters, 89(22):223903, 2006.
[42] Seok Lew, Carsten H. Wolters, Alfred Anwander, Scott Makeig, and Rob S. MacLeod. Improved EEG source
analysis using low-resolution conductivity estimation in a four-compartment finite element head model. Human
Brain Mapping, 30, 2009.
[43] Viktor K Jirsa, Kelly J Jantzen, Armin Fuchs, and J Kelso. Spatiotemporal forward solution of the EEG and
MEG using network modeling. Medical Imaging, IEEE Transactions on, 21(5):493–504, 2002.
[44] Jan Kybic, Maureen Clerc, Olivier Faugeras, Renaud Keriven, and Théo Papadopoulo. Fast multipole acceleration of the meg/eeg boundary element method. Physics in Medicine and Biology, 50(19):4695, 2005.
[45] Owe Axelsson. Iterative solution methods. Cambridge university press, 1996.
[46] Snorre H. Christiansen and Jean-Claude Nedelec. A Preconditioner for the Electric Field Integral Equation Based
on Calderon Formulas. 40(3):1100–1135.
[47] H. Contopanagos, B. Dembart, M. Epton, J.J. Ottusch, V. Rokhlin, J.L. Visher, and S.M. Wandzura. Wellconditioned boundary integral equations for three-dimensional electromagnetic scattering. IEEE Transactions
on Antennas and Propagation, 50(12):1824–1830, December 2002.
[48] R.J. Adams and N.J. Champagne. A Numerical Implementation of a Modified Form of the Electric Field Integral
Equation. 52(9):2262–2266.
[49] Francesco P. Andriulli, Kristof Cools, Hakan Bagci, Femke Olyslager, Annalisa Buffa, Snorre Christiansen, and
Eric Michielssen. A Multiplicative Calderon Preconditioner for the Electric Field Integral Equation. 56(8):2398–
2412.
[50] Matthew B. Stephanson and Jin-Fa Lee. Preconditioned Electric Field Integral Equation Using Calderon Identities and Dual Loop/Star Basis Functions. 57(4):1274–1279.
[51] Felipe Valdes, Francesco P Andriulli, Kristof Cools, and Eric Michielssen. High-order div-and quasi curlconforming basis functions for calderón multiplicative preconditioning of the efie. IEEE Transactions on Antennas and Propagation, 59(4):1321–1337, 2011.
[52] J. Zhu, Y.Q. Hu, R.S. Chen, and H.B. Zhu. Calderon multiplicative preconditioner based on curvilinear elements
for fast analysis of electromagnetic scattering. IET Microwaves, Antennas & Propagation, 5(1):102, 2011.
[53] Francesco P. Andriulli, Kristof Cools, Ignace Bogaert, and Eric Michielssen. On a Well-Conditioned Electric
Field Integral Operator for Multiply Connected Geometries. IEEE Transactions on Antennas and Propagation,
61(4):2077–2087, April 2013.
[54] K. Cools, F.P. Andriulli, and E. Michielssen. A Calderon Multiplicative Preconditioner for the PMCHWT Integral
Equation. 59(12):4579–4587.
[55] K. Niino and N. Nishimura. Calderón preconditioning approaches for PMCHWT formulations for Maxwell’s
equations: CALDERÓN PRECONDITIONING FOR PMCHWT FORMULATIONS. International Journal of
Numerical Modelling: Electronic Networks, Devices and Fields, 25(5-6):558–572, September 2012.
17

[56] D. Dobbelaere, D. De Zutter, J. Van Hese, J. Sercu, T. Boonen, and H. Rogier. A Calderón multiplicative
preconditioner for the electromagnetic Poincaré–Steklov operator of a heterogeneous domain with scattering
applications. 303:355–371.
[57] Michiel Gossye, Martijn Huynen, Dries Vande Ginste, Daniël De Zutter, and Hendrik Rogier. A calderón preconditioner for high dielectric contrast media. IEEE Transactions on Antennas and Propagation, 2017.
[58] JE Ortiz Guzman, Axelle Pillain, Lyes Rahmouni, and Francesco P Andriulli. On the preconditioning of the symmetric formulation for the EEG forward problem by leveraging on Calderon formulas. In Biomedical Imaging
(ISBI), 2016 IEEE 13th International Symposium on, pages 755–758. IEEE, 2016.
[59] Victoria Montes-Restrepo, Pieter van Mierlo, Gregor Strobbe, Steven Staelens, Stefaan Vandenberghe, and Hans
Hallez. Influence of skull modeling approaches on EEG source localization. Brain topography, 27(1):95–111,
2014.
[60] Jukka Sarvas. Basic mathematical and electromagnetic concepts of the biomagnetic inverse problem. Physics in
medicine and biology, 32(1):11, 1987.
[61] P.L. Nunez and R. Srinivasan. Electric Fields of the Brain: The Neurophysics of EEG. Oxford University Press,
2006.
[62] Axelle Pillain. Line, Surface, and Volume Integral Equations for the Electromagnetic Modelling of the Electroencephalography Forward Problem. PhD thesis, Ecole Nationale Supérieure des Télécommunications de
Bretagne-ENSTB, 2016.
[63] Stefan A Sauter and Christoph Schwab. Boundary element methods. Springer, 2011.
[64] Israel Gohberg, Seymour Goldberg, and Marinus Kaashoek. Basic classes of linear operators. Birkhäuser, 2012.
[65] Yuri A Abramovich and Charalambos D Aliprantis. An invitation to operator theory, volume 1. American
Mathematical Soc., 2002.
[66] Ralf Hiptmair. Operator preconditioning. Computers and mathematics with Applications, 52(5):699–706, 2006.
[67] Annalisa Buffa and Snorre Christiansen. A dual finite element complex on the barycentric refinement. Mathematics of Computation, 76(260):1743–1769, 2007.
[68] JC De Munck. The potential distribution in a layered anisotropic spheroidal volume conductor. Journal of
applied Physics, 64(2):464–470, 1988.
[69] Zhi Zhang. A fast method to compute surface potentials generated by dipoles within multilayer anisotropic
spheres. Physics in medicine and biology, 40(3):335, 1995.
[70] Kezhong Zhao, Marinos N Vouvakis, and Jin-Fa Lee. The adaptive cross approximation algorithm for accelerated method of moments computations of EMC problems. IEEE transactions on electromagnetic compatibility,
47(4):763–773, 2005.
[71] David Weinstein, Leonid Zhukov, and Chris Johnson. Lead-field bases for electroencephalography source imaging. Annals of biomedical engineering, 28(9):1059–1065, 2000.

18

