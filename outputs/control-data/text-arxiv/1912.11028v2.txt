arXiv:1912.11028v2 [stat.AP] 28 May 2021

Simultaneous Inference for Empirical Best
Predictors with a Poverty Study in Small Areas
Katarzyna Reluga∗, María-José Lombardía† and Stefan Sperlich‡

Abstract
Today, generalized linear mixed models are broadly used in many fields. However,
the development of tools for performing simultaneous inference has been largely neglected in this domain. A framework for joint inference is indispensable to carry out
statistically valid multiple comparisons of parameters of interest between all or several clusters. We therefore develop simultaneous confidence intervals and multiple
testing procedures for empirical best predictors under generalized linear mixed models. In addition, we implement our methodology to study widely employed examples
of mixed models, that is, the unit-level binomial, the area-level Poisson-gamma and
the area-level Poisson-lognormal mixed models. The asymptotic results are accompanied by extensive simulations. A case study on predicting poverty rates illustrates
applicability and advantages of our simultaneous inference tools.

Keywords: EBP, generalized mixed models, mixed parameters, small area estimation, uniform inference

∗
Katarzyna Reluga is a Research Associate at the University of Cambridge, DPMMS, United Kingdom.
E-mail: katarzyna.reluga@dpmms.cam.ac.uk.
†
María-José Lombardía is a Professor at the University of A Coruña, CITIC, Spain. E-mail:
maria.jose.lombardia@udc.es.
‡
Stefan Sperlich is a Professor at the University of Geneva, GSEM, Switzerland. E-mail: stefan.sperlich@unige.ch.
The authors gratefully acknowledge support from the MINECO grants MTM2017-82724-R and MTM201452876-R, the Xunta de Galicia (Grupos de Referencia Competitiva ED431C-2016-015 and Centro Singular
de Investigación de Galicia ED431G/01), all of them through the ERDF.
The computations were performed at University of Geneva on the Baobab cluster.

1

1

Introduction

Generalized linear mixed models (GLMM) are suitable for modeling clustered and correlated data with categorical or count outcomes. They are ubiquitous in applied statistics,
e.g., in biometrics or small area estimation (SAE). In the latter, they serve to analyze
surveys on a disaggregated level. Despite an increasing interest, e.g., to guide resource allocation, the development of methods for simultaneous inference for predictors is missing.
It is surprising as only those would make joint considerations of clusters valid. Available
(1 − α)-confidence intervals (CI) for mixed parameters (except the credibility intervals of
Ganesh, 2009) are constructed such that for each study at least α100% of them do not
contain the true value. Undoubtedly, practitioners do compare, but so far without valid
statistical tools. We aim to close this distressing gap, not to improve any existing method.
Specifically, we introduce simultaneous confidence interval (SCI) and multiple test procedure (MTP) for the empirical best predictor (EBP) of Jiang (2003). They are based on
max-type statistics combined with extreme value theory. We prove asymptotic convergence
of SCI and MTP for nested (or hierarchical) GLMM within the exponential family. We
study the numerical performance of our SCI and MTP for two area-level and one unit-level
mixed models that are widely used, e.g., for studying local poverty rates (Pratesi, 2016).
All introduced methods show a satisfactory performance within considered modeling frameworks. Even though our estimates under the area-level models appear to be less volatile,
one can argue that EBPs are not directly comparable because different methods and model
classes are used. Finally, under area-level Poisson-gamma model, we derive a new mean
squared error (MSE) estimator which is of crucial interest in SAE.
The amount of literature on estimation and testing under GLMM is considerable, see,
i.a., the review of Tuerlinckx et al. (2006), the monograph of Jiang (2007), and the article
of Ghosh et al. (1998) which is particularly interesting within the context of SAE. Furthermore, researchers put forward several methodologies broadly used in the analysis of count
data. Molina et al. (2007) and Scealy (2010) study the estimation of labor force status using multinomial logistic models, whereas Saei and Taylor (2012) focus on the same target
parameter, and examine the performance of a bivariate random components model. Chandra et al. (2012) and Franco and Bell (2015) provide extensions for modeling proportions
using logistic unit- and area-level models. Hobza and Morales (2016) implement the EBP
for unit-level, and Boubeta et al. (2016) for area-level GLMM to study poverty in small
areas. Chambers et al. (2012) and Tzavidis et al. (2015) extend the M-quantile inference for
robust estimation and prediction of count data. Yet, to the best of our knowledge, no one
addresses the issue of simultaneous inference for clusters-level parameters when applying
GLMM. Likewise, little research has been carried out on simultaneous inference for cluster
level parameters in linear mixed effects models (LMM). Ganesh (2009) develops credibility
2

intervals for a mixed parameter in a particular area-level model. Reluga et al. (2019) propose bootstrap SCI and MTP for mixed parameter under LMM, whereas Kramlinger et al.
(2018) develop a framework for marginal and conditional inference with quadratic forms.
After an introduction of model and estimators in Section 2, we propose the construction
of SCI and MTP for a general EBP, followed by the theoretical justifications in Section 3.
Sections 4 and 5 present simulations and a case study. Conclusions are drawn in Section
6. More details are deferred to Appendix and our supplementary material (SM).

2

Best Prediction For Generalized Linear Mixed Models

Let D be the number of clusters
in
PD or areas with d ∈ [D], nd the number of sampledPunits
D
each area j ∈ [nd ] with n = d=1 nd , Nd the known population sizes with N = d=1 Nd ,
[A] = {1, . . . , A}. Since in our context the notion of cluster and area can be used synonymously, we proceed with the latter. Suppose that {vd : d = 1, . . . , D} is a set of independent
and identically distributed (i.i.d.) random effects with unknown variance δ 2 , δ > 0, which
is often parametrized as vd = δud with ud ∼ N (0, 1). The target variable ydj represents the
j th sample observation from the dth area. Furthermore, we consider nested data structures
such that ydj 6= yd0 j for d 6= d0 . In full generalization, we assume that random variables Ydj ,
conditionally on a random effect ud , are independent with a probability density function
(p.d.f.) from the exponential family ydj |ud ∼ Exp.F amily(θ)
ydj |ud ∼ indep. gYdj |ud (ydj |ud ),

gdj (ydj |ud , θ) = exp{ϕ−1 [ydj γdj − b(γdj )] + c(ydj , ϕ)},

where θ = (β t , δ, ϕ)t with δ the variability parameter, β = (β1 , . . . , βp )t regression parameters of auxiliary variables xdj = (xdj1 , . . . , xdjp )t for which typically xdj1 = 1, ∀j ∈ [nd ]
∀d ∈ [D], and γdj , ϕ are canonical and scale parameters respectively. Link function M
relates E(Ydj |ud ) to a linear mixed model such that γdj = M (E[Ydj |ud ]) = xtdj β + δud .

2.1

Estimation and computation

t t
Let yd = (yd1 , . . . , ydnd )t for all d ∈ [D] be the vector of outcomes, and y = (y1t , . . . , yD
).
A conditional p.d.f. of y and the likelihood contribution from each area d are given by
Z
Z Y
nd
Ld (θ) := fd (yd |θ) = gd (yd |ud , θ)h(ud )dud =
gdj (ydj |ud , θ)h(ud )dud ,
(1)
j=1

Q
QD R Qn d
where θ can be derived from L(θ) := D
L
(θ)
=
d
d=1
d=1
j=1 gdj (ydj |ud , θ)h(ud )dud . In
case of area-level models, nd = 1, and (1) simplifies accordingly. For a concise presentation,
3

we assume that there is a single random effect for each area such that the integral in (1) is
one-dimensional. Extensions to multidimensional random effects follow immediately with
some changes of notations and more complicated computation. Finding an analytical solution to (1) is difficult unless the integral can be simplified. Often one evaluates the integral
numerically by Laplace approximation (LA) (De Bruijn, 1981), Gaussian quadrature (GQ)
(Naylor and Smith, 1982) or adaptive GQ (AGQ) (Pinheiro and Bates, 1995). In what
follows, we proceed with AGQ as it is a higher order version of LA, i.e., it gives smaller
approximation errors (Bianconcini, 2014). An alternative is the quasi-likelihood (Breslow
and Clayton, 1993) which suffers from a non-decreasing bias (Tuerlinckx et al., 2006), and
the method of moments (Jiang, 1998b). In addition, researchers considerably advanced in
developing methods to compute maximum likelihood (ML) estimators under GLMM. Jiang
(2007), Section 4.1, proposes an expectation-maximization algorithm, whereas Lele et al.
(2010) develop a so-called data cloning subsequently implemented by Torabi (2012).
Since we consider a prediction problem of possibly non-linear mixed effects ζd = ζd (β, ud ),
we use the best predictor (BP) ζ˜d in the sense of minimizing the area-specific MSE in (3)
which is actually the area-specific mean squared prediction error:
R
ζd (β, ud )gd (yd |ud , θ)h(ud )dud
R
. (2)
ζ̃d = ζ˜d (θ) := E{ζd (β, ud )|y} = E{ζd (β, ud )|yd } =
gd (yd |ud , θ)h(ud )dud
Simplification of (2) is possible by choosing the p.d.f. of ud accordingly. If we replace θ by
a consistent estimator, we obtain the empirical best predictor (EBP) ζ̂d := ζ̃d (θ̂). Note that
in order to obtain the consistency for random effects, one needs to assume that nd → ∞
for each ζ̂d , d = 1, . . . , D (Jiang and Lahiri, 2001).
Regarding the estimation of the variability of the EBP ζ̂d , MSE is by far the most
popular measure. Well known techniques are the analytical approximation based on a
Taylor expansion (Jiang, 2003), and parametric bootstrap approaches (Boubeta et al.,
2016; Hobza and Morales, 2016). Consider the following MSE decomposition
MSE(ζ̂d ) = E[{ζ̃d (θ̂) − ζd }2 ] = E[{ζ̃d (θ̂) − ζ̃d (θ)}2 ] + E[{ζ̃d (θ) − ζd }2 ] =: g2d + g1d ,

(3)

which can be derived applying the law of iterated expectations (for details, see Jiang,
2003, and our SM). The analytical formulas of MSE estimators are model dependent.
Bootstrapping permits to obtain estimators that do not vary with the model assumed. In
what follows, we denote with E∗ , Var∗ and MSE∗ , the corresponding bootstrap operators
for expected value, variance and mean squared error and define
MSE∗B (ζ̂d )

∗

=E

{(ζ̂d∗

−

ζd∗ )2 }

≈

B1−1

B1 
2
X
∗(b1 )
∗(b1 )
ζ̂d
− ζd
=: mseB (ζ̂d ),
b1 =1

4

(4)

which is a bootstrap equivalent of (3). In their paper, Hall and Maiti (2006) point out that
(4) tends to underestimate the MSE, and propose a double-bootstrap bias-correction
MSE∗BC (ζ̂d ) = 2MSE∗B (ζ̂d ) − MSE∗B2 (ζ̂d ) ≈ 2mseB (ζ̂d ) − mseB2 (ζ̂d ),

(5)

where MSE∗B2 (ζ̂d ) is a second-stage bootstrap MSE estimator, that is
MSE∗B2 (ζ̂d ) = E∗∗ {(ζ̂d∗∗ − ζd∗∗ )2 } ≈ B1−1 B2−1

B1 X
B2 
X

∗∗(b1 b2 )

ζ̂d

∗∗(b1 b2 )

− ζd

2

=: mseB2 (ζ̂d ) .

b1 =1 b2 =1

The computation of MSE∗B2 (ζ̂d ) involves selecting B2 bootstrap replicates from each firststage bootstrap. In this article we do not aim for a precise estimation of the variability of
EBP, but the construction of narrow SCIs and reliable MTPs. It turns out that for doing
this, the use of an estimate of g1d as in (3) yields better results than using an estimate of
the entire MSE (see Section 4), similarly as in Chatterjee et al. (2008) under LMMs.

2.2
2.2.1

Popular Examples of GLMM and their properties
Poisson-gamma area-level model

The Poisson-gamma model is widely applied for modeling counts in the presence of overdispersion (see Cameron and Trivedi, 2013, Section 4.2.2). Within the SAE context, Chen
et al. (2015) investigate observed best prediction and bootstrap MSE estimation for small
area mean counts. Among others, they also consider a Poisson-gamma specification. We
propose a different model formulation, focus on the EBP of ζd := µPd G and develop a plug-in
MSE estimator. Let yd |ud ∼ P oiss(µPd G ), d = 1, . . . , D, where µPd G > 0, nd = 1 ∀d ∈ [D],
with canonical parameter log µPd G = xtd β +ud , and wd := exp(ud ) ∼ Gamma(δ, δ) such that
E(yd |ud ) = µPd G = λd wd = exp(xtd β)wd = exp(xtd β + ud ). Since Gamma p.d.f. is conjugate
to the Poisson, their mixture yields a negative binomial yd ∼ N B(λd , δ −1 ) with likelihood

δ 
yd
D
Y
δ
λd
Γ(yd + δ)
PG
PG
,
(6)
L (θ) := f (y|θ) =
Γ(y
δ
+
λ
δ
+
λ
d + 1)Γ(δ)
d
d
d=1
where E(yd ) = λd and Var(yd ) = λd + δ −1 λ2d . The marginal mean of yd is the same as in the
Poisson case, but the random effect increases the variance. Suppose that this model holds
for all areas of population P of size N partitioned into subpopulations P1 , P2 , . . . , PD of
sizes N1 , N2 , . . . , ND . We can show that the BP for counts µ̃Pd G (θ) := E(µPd G |yd ) is
R∞
λd wd g(yd |wd )h(wd )dwd
AP G (yd , θ)
λd (yd + δ)
PG
E(µd |yd ) = 0 R ∞
= dP G
=
=: ψdP G (yd , θ) . (7)
(λd + δ)
Cd (yd , θ)
g(yd |wd )h(wd )dwd
0
5

Equation (7) follows from the conjugation of the Gamma p.d.f. to Poisson p.d.f., while
Z ∞
exp(−λd wd )λydd wdyd δ δ wdδ−1 exp(−wd δ)
λyd +1 δ δ Γ(yd + 1 + δ)
PG
Ad =
λd w d
dwd = d
.
yd !Γ(δ)
Γ(δ)yd !(λd + δ)yd +1+δ
0
The EBP µ̂Pd G is obtained by replacing the vector of unknown parameters θ in (7) with a
consistent estimator θ̂. Under the Poisson-gamma model ϕ = 1 and θ = (β, δ). We derive
an analytical plug-in MSE estimator to measure the variability of our EBP.
Proposition 1. Let Vard (θ) = D E{(θ̂ − θ)(θ̂ − θ)t }. An analytical MSE decomposition
with its corresponding practical plug-in estimator are given by
1
1
cd (θ) + o(1/D) and mseP G (µ̂Pd G ) = ĝP G1d + ĉd (θ̂),(8)
D
D
:= κ1d (θ) − κ2d (θ) ĝP G1d = κ1d (θ̂) − κ̂2d (θ̂), d ∈ [D],
(9)
∞
2
2
2
X λ (j + δ)
λ (δ + 1)
d
and κ2d (θ) =
P (yd = j),
κ1d (θ) = d
δ
(λd + δ)2
j=0
t


∞ 
X
∂ PG
∂ PG
ψ (yd , θ) Vard (θ)
ψ (yd , θ) P (yd = j).
cd (θ) =
∂θ d
∂θ d
j=1

MSEP G (µ̃Pd G ) = gP G1d +
gP G1d
with
as well as

ĉd (θ) is a Monte Carlo approximation of cd (θ), κ̂2d refers to κ2d with an infinite series
truncated at a large term and θ replaced by θ̂. To estimate κ1d we need only the latter.
One can estimate Vard (θ) using any reasonable method. In Section 4 we use bootstrap
estimators defined in (24). Details on the derivation of (6) and (8) are deferred to the SM.
2.2.2

Poisson-lognormal area-level Model

The Poisson-lognormal model has been thoroughly examined by, among others, Cameron
and Trivedi (2013), Section 4.2.4, Franco and Bell (2015) and Boubeta et al. (2016). For
ud ∼ N (0, 1), let yd |ud ∼ P oiss(µPd L ), d = 1, . . . , D, where µPd L > 0, nd = 1 ∀d ∈ [D],
with µPd L = νd ρd , where νd is a known size variable, and ρd a binomial probability. The
canonical parameter is log µPd L = log νd + xd β + δud , for all d = 1, . . . , D. Typically ζd := ρd
for which we have ρd = exp(xd β + δud ) with θ = (β t , δ). The likelihood is
L

PL

(θ) := f

PL

(y|θ) = (2π)

−D/2

 2
D Z
Y
−ud
exp(−νd ρd )νdyd exp{yd (xd β + δud )}
exp
du.
yd !
2
d=1 R

Once θ is estimated, we obtain for BPs µ̃Pd L and ρ̃d the EBPs µ̂Pd L and ρ̂d , using the formulas
from Boubeta et al. (2016). In Section 4.1 we estimate its MSE by bootstrap.
6

2.2.3

Logit unit-level model

A unit-level logit model is a popular choice for binary responses, comprehensively discussed
by Hobza and Morales (2016). Under this setting, ydj |ud ∼ Bin(mdj , pdj ), ud ∼ N (0, 1)
with mdj a known size parameter for a logistic regression. The natural parameter is
pdj /(1 − pdj ) = xtdj β +δud , d = 1, . . . , D, j = 1, . . . , nd , where pdj = {exp(xtdj β +δud )}/{1+
exp(xtdj β + δud )}. We assume that logit unit-level model holds for all units of population P of size
, partitioned into D subpopulations Pd of sizes Nd , d = 1, . . . , D. Let
PNN
d
U
ζd := µd = j=1 pdj . As for the Poisson models, we have ϕ = 1, and therefore θ = (β t , δ).
The likelihood is given by
"n

 X
nd
D Z
d
Y
X
mdj
U
U
−D/2
ydj (xtdj β + δud )
log
+
L (θ) := f (y|β, δ) = (2π)
exp
y
dj
j=1
j=1
d=1 R
#
n
d


u2 X
− d−
mdj log 1 + exp xtdj β + δud
dud .
(10)
2
j=1
P d
We can proceed with the estimation of the BP p̃dj (θ) and µ̃Ud = N
j=1 p̃dj only if we
have access to the information on each population unit. In practice, however, the auxiliary
information is often available only for the sample units. Then we can still estimate the
population quantity of interest by using only categorical covariates following the suggestion
of Hobza and Morales (2016). Suppose that they take a finite number of values, say
xdj ∈ {z1 , . . . , zL } ∀d, ∀j with zl denoting the resulting classes. For these we obtain
µ̄Ud =

µUd
,
Nd

µUd =

Nd
X

pdj =

j=1

L
X

Ndl rdl ,

with rdl =

l=1

exp(zl β + δud )
,
1 + exp(zl β + δud )

(11)

where the Ndl = #{l ∈ Pd : xdj = zl } are known. Hobza and Morales (2016) derive
BP µ̃Ud (θ) and EBP µ̂Ud (θ̂) for µUd as well as for other quantities in (11). Due to the
computational burden of the analytical estimator, we use bootstrap for obtaining the MSE.

3

Simultaneous Intervals and Multiple Testing

To construct confidence intervals for ζd that account for the effect of estimates from other
areas, we need to find a region I1−α such that P (ζd ∈ I1−α ∀d ∈ [D]) = 1 − α. Define
S0 = max |S0d | ,
d=1,...,D

with S0d =
7

ζ̂d − ζd
σ̂(ζ̂d )

,

∀d ∈ [D],

(12)

(1−α)

and qS0

:= inf{t ∈ R : P (S0 6 t) > 1 − α},

(13)

with σ̂(ζ̂d ) being an estimate of the variability of EBP. We then consider
α=P



ζ̂d − ζd >

(1−α)
qS0 σ̂(ζ̂d )


for some d ∈ [D] = P

max

D

S
I1−α

=

×

S
,
Id,1−α

with

S
Id,1−α

σ̂(ζ̂d )

d=1,...,D

(1−α)

Constructing SCI boils down to the estimation of qS0

ζ̂d − ζd

!
>

(1−α)
qS0

. (14)

, as one can define then

n
o
(1−α)
= ζ̂d ± qS0 × σ̂(ζ̂d ) ,

(15)

d=1

×

S
covers all ζd with probability 1−α,
where denotes a generalized Cartesian product. I1−α
(1−α)
i.e., its joint confidence level is 1 − α. In contrast, for each qS0d defined analogously to
(1−α)
qS0 , with S0 replaced by |S0d |, individual area CI (iCI) are given by
o
n
(1−α)
iCI
∀d ∈ [D].
(16)
Id,1−α
= ζ̂d ± qS0d × σ̂(ζ̂d )

By construction, iCI does not contain ζd for at least 100α% of all areas.
iCI
Remark 1. Id,1−α
is designed to cover ζd at individual confidence level. Consequently,
the joint coverage probability of iCIs decreases in a cumulative way for increasing D.
This highlights the need to construct SCI. Nevertheless, maintaining 1 − α simultaneous
S
S
confidence level of SCI I1−α
makes its constituents Id,1−α
wider than corresponding iCIs
S
iCI
iCI
Id,1−α . This is not surprising because Id,1−α and Id,1−α were constructed to cover different
sets which serve distinct inferential purposes. It is worth mentioning that the length of
S
Id,1−α
stabilizes as for growing D we observe two opposite trends: the increase of area
parameters to cover and the decrease of MSE (cf., Table 1 and Table 3).

The SCI defined in equation (15) is not operational as the distribution of S0 is unknown.
The problem can be circumvented by bootstrap approximation: for b1 = 1, . . . , B1 set
∗(b1 )

(b )
SB 1

= max

d=1,...,D

(b )
SBd1

(b )
SBd1

,

=

ζ̂d

∗(b1 )

− ζd

σ̂ ∗(b1 ) (ζ̂d∗ )

,

(17)

(1−α)

and approximate the critical value qSB := inf{t ∈ R : P (SB 6 t|(y, X)) > 1 − α}, by a
(b )
[(1 − α)B1 + 1]th order statistic of the SB 1 . Then the bootstrap equivalent of (15) is
D

B
I1−α
=

×

B
,
Id,1−α

n
o
(1−α)
B
where Id,1−α
= ζ̂d ± qSB × σ̂(ζ̂d ) .

d=1

8

(18)

An alternative approach to (12) could be to take computationally simpler non-studentized
statistics. Yet, already DiCiccio and Efron (1996) pointed out that the lack of studentization results in slower convergence rates. Since the application of non-studentized SCI did
not yield satisfactory results, we decided not to include them.
Our methodology is also applicable for hypothesis testing. Consider the test problem
H0 : Bζ = b vs. H1 : Bζ 6= b,
0

(19)

0

where B ∈ RD ×D , D0 6 D, b ∈ RD . We are interested in max-type statistic tH such that
tH := max 0 |tHd | , tHd =
d=1,...,D

ζ̂dH − bd
σ̂(ζ̂dH )

, SH0 := max 0 |SH0 d | , SH0 d =
d=1,...,D

ζ̂dH − ζdH
σ̂(ζ̂dH )

,

(20)

0

H t :=
Bζ ∈ RD with ζ̂ H being its estimator. One rejects H0 at the
where ζ H = (ζ1H , . . . , ζD
0)
(1−α)
(1−α)
α-level if tH > qH0 with qH0 := inf{t ∈ R : P (SH0 6 t) > 1 − α}. In practice we might
use such a test to examine differences between area characteristics. Similarly as for SCI,
(1−α)
we approximate qH0 applying bootstrap to a modified version of statistic SB , namely
(1−α)
qBH0 := inf{t ∈ R : P (SBH0 6 t|(y, X)) > 1 − α}

(21)

where SBH0 in the bth
1 bootstrap sample is
∗H(b1 )

(b1 )
SBH
0

= max

∗H(b )

d=1,...,D0

(b1 )
SBH
0d

,

(b1 )
SBH
0d

0∗H(b )

=

ζ̂d

∗H(b1 )

− ζd

∗H(b1 )

σ̂ ∗ (ζ̂d

0

,

(22)

)
∗H(b )

0∗H(b )

with ζ ∗H(b1 ) = (ζ1 1 , . . . , ζD 1 ) := Bζ ∗(b1 ) ∈ RD and ζ̂ ∗H(b1 ) = (ζ̂1 1 , . . . , ζ̂D 1 ) its
corresponding estimated version.
We provide the consistency of our bootstrap based confidence intervals and tests, as
well as asymptotic convergence and coverage probability. Proofs are deferred to Appendix
A.2 and A.3. Suppose that θ̂ is consistent such that ||θ̂ − θ|| = OP (n−c ), c > 0. Since for
the GLMM with clustered random effects the log-likelihood can be expressed as the sum of
independent random components, the consistency of θ̂ estimated by ML follows assuming
a classical theory. The consistency under a general GLMM had been an open problem for
many years until it was solved by Jiang (2013). Bianconcini (2014) and Huber et al. (2004)
investigated the consistency of ML once we compute it using AGQ and LA respectively.
For our purpose we need to prove the bootstrap consistency:
Proposition 2. Under Assumptions 1-5 from Appendix A.1 it holds that:
∗
) − E(ydj ) = oP ∗ (1),
E∗ (ydj

Var∗ (yd∗ ) − Var(yd ) = [oP ∗ (1)]nd ×nd ,
9

||θ̂ ∗ − θ̂|| = OP ∗ (n−c ).

B
based on results from extreme
Given Proposition 2, we can derive the consistency of I1−α
value theory and asymptotic expansions of the standardized
statistics using ideas from
q

ĝ1d (ζ̂d ), though similar results are
Chatterjee et al. (2008). Let us assume σ̂(ζ̂d ) =
q
(·)
immediate for σ̂(ζ̂d ) = mse(·) (µ̂d ) where (·) stands for different types of estimators. We
(1−α)
use q := qS0
where unambiguous, and denote the cumulative distribution function (c.d.f.)
of S0d and SBd by Gd (w) = P (S0d 6 w) and GBd (w) = P (SBd 6 w). In Appendix A.3 we
provide asymptotic expansions for both. Define (S0(d+1) . . . , S0(2D) ) = (−S01 , . . . , −S0D ),
and observe that max |S0d | = max (S01 , . . . , S0D , −S01 , . . . , −S0D ). From (14) we get
d=1,...,D

d=1,...,2D

TD (q) = P (S0 6 q) = P (S01 6 q, . . . , S0D 6 q, −S01 6 q, . . . , −S0D 6 q) =

2D
Y

Gd (q). (23)

d=1

As D → ∞, unless standardized, the distribution in (23) converges to 0 or 1. In Appendix
A.3 we show that Gd (w) is asymptotically normal, such that P (S0 6 q) ≈ Φ2D (q). As the
standard normal distribution is in the domain of attraction of the Gumbel law, it follows
that lim Φ2D (q/bD + bD ) = exp(exp(−q)) = T0 (q), for all q ∈ R where bD is a sequence of
D→∞

constants (see Theorem 1.5.3 in Leadbetter et al., 2012). Unfortunately, this approximation
has a poor convergence rate, but bootstrap is again a remedy. Notice that a similar representation holds for SB , substituting P with P ∗ and replacing the true parameters by their
estimates. Application of Poyla’s theorem that combines the convergence in distribution
with a convergence in sup norm results in our next proposition.
Proposition 3. Define TD∗ (w) = P ∗ (SB 6 q) which is a bootstrap analogue of TD (w) in
(23). Under Assumptions 1-5 from Appendix A.1 it holds that
sup |TD (w) − TD∗ (w)| = oP (1) .

w∈R

Corollary 1. Proposition 3 implies that under the same assumptions,
B
P (ζd ∈ I1−α
∀d ∈ [D]) →
− 1−α .

Since we use almost identical max-type statistics in equations (20) and (15), the construction of MTP follows almost immediately from the correspondence between tests and
D
H0
H0
confidence intervals. In fact, the acceptance region of our test is I1−α
= d=1 Id,1−α
, where
n
o
(1−α)
(1−α)
H0
H0
/ I1−α
.
Id,1−α
= ζ̂d − qS0 × σ̂(ζ̂d ) 6 bd 6 ζ̂d + qS0 × σ̂(ζ̂d ) , i.e., we reject H0 if b ∈

×

H0
We can write P (hd ∈ I1−α
∀d ∈ [D]) = 1 − α. Since this probability statement is true for
any hd = ζd , we obtain the confidence intervals defined in (15) by inverting the test.

10

Corollary 2. Let H0 be the null hypothesis defined in (19) and α ∈ (0, 1). Under Proposition 3, we have
P (tH > qBH0 ) 6 α + o(1) .
Remark 2. Our single-step testing procedure in (19) with a bootstrap critical value in (21)
controls weakly for the family-wise error rate (FWER), and might be limited in detecting
false null hypotheses once we deal with a large D0 . Yet, we can readily extend our test to
a bootstrap based step-down procedure of Romano et al. (2008) which controls the false
discovery rate with a better power to detect false H0d than FWER.

4

Empirical Reliability Study

We performed intensive simulation studies to assess the reliability of our methods. SCI and
MTP for EBP were constructed with different estimators of variability under the models
presented in Sections 2.2.1-2.2.3. First, we examined the relative bias and relative rootMSE of fixed effects β̂ and variability parameter δ̂. Then, the performance of EBP was
evaluated comparing bias, average absolute bias and MSE for D = 26, 52, 78. Since they
did not show any atypical pattern, the results under Poisson area-level models and logistic
unit-level model were deferred to the SM. Regarding SCIs, we calculated empirical coverage
probability (ECP), average interval width (AIW) and the AIW variation (AIWV):
K
1 X
S
1{ζd(k) ∈ I1−α
∀d ∈ [D]},
ECP =
K k=1
D
K
1 X X (k)
AIW =
ω ,
DK d=1 k=1 d
D

AIWV =

(1−α) (k) (k)

(k)

ωd = 2q(·)

σ̂

(ζ̂d ),

K

2
X X  (k)
1
ωd − ω̄d ,
D(K − 1) d=1 k=1

ω̄d =

K
1 X (k)
ω ,
K k=1 d

d = 1 . . . , D.

For each simulation run k we record the widths of the SCI and check whether they cover
all EBPs. ECP is then computed by averaging over K simulation runs and is aimed to be
close to 1 − α. AIW is obtained by averaging over the simulation runs and areas. Narrower
intervals are preferable if its ECP is close to the nominal level. These are standard measures
to assess the quality of interval estimators (Chatterjee et al., 2008; Ganesh, 2009). Lower
AIWV values indicate that the length is stable and does not depend on the simulation run.

11

4.1

Finite sample performance under area-level models

Under the Poisson-gamma model we set yd ∼ P oiss(µPd L ), µPd L = λd wd . Covariates,
parameters and sample sizes are taken from our case study in Section 5, i.e., we set
θ = (β t , δ) = (10.038, 7.747, −3.136, 11.317, −2.466, 2.480)t , and D = {26, 52, 78}, nd = 1,
∀d ∈ [D], n = D. For D = 52 we take covariates from the original sample, for D = 26
we randomly select the areas using simple random sampling without replacement, and for
D = 78, we take the original sample plus 26 randomly selected areas, i.e., these areas enter
at most twice. Parameter of interest is the area proportion of individuals below the poverty
line, µ̄Pd L = µPd L /Nd . The EBP for µPd L is given in (7). Since Nd is usually unknown, in
practice it is replaced by its estimate, see equation (25) in Section 5. We apply double
bootstrap with B1 = 1000 first-stage and B2 = 1 second-stage bootstrap replicates (the
choice of the latter is motivated by Erciulescu and Fuller, 2014). We generate K = 1000
samples with the same areas and fixed covariates, but randomly drawn wd and yd . SCIs
and iCIs are constructed as follows:
1. Fit the model to the data and obtain estimates θ̂ = (β̂, δ̂).
∗(b1 )

2. For b1 = 1, . . . , B1 bootstrap samples, generate wd
P G∗(b1 )

µd

∗(b1 )

= λ̂d wd

∗(b1 )

and yd

P G∗(b1 )

∼ P oisson(µd

P G∗(b1 )

3. For each bootstrap sample calculate θ̂ ∗(b1 ) , µ̂d

P G∗∗(b1 ,b2 )

∗(b1 )

= λ̂d

∗∗(b1 ,b2 )

wd

(b )

P G∗(b1 )

P G∗(b1 )

− µd

.

∼ Gamma(δ̂ ∗(b1 ) , δ̂ ∗(b1 ) ) i.i.d. and

∗∗(b1 ,b2 )

and yd

).

1
(θ̂ ∗(b1 ) ), ADP G,d
= µ̂d

∗∗(b1 ,b2 )

(a) For b2 = 1, . . . , B2 generate samples wd
µd

∼ Gamma(δ̂, δ̂) i.i.d. and set

P G∗∗(b1 ,b2 )

∼ P oisson(µd
P G∗∗(b1 ,b2 )

(b) For each bootstrap sample calculate θ̂ ∗∗(b1 ,b2 ) and µ̂d
2
P 2  P G∗∗(b1 ,b2 )
(b )
P G∗∗(b1 ,b2 )
(c) Set msed 1 = B12 B
µ̂
−
µ
.
d
d
b2 =1

).

(θ̂ ∗∗(b1 ,b2 ) ).

4. Calculate bootstrap estimates ĝP G1d (θ̂ ∗(b1 ) ) as in (9) as well as
mseB (µ̂Pd G )

B1 
B1
2
1 X
1 X
(b )
P G∗(b1 )
P G∗(b1 )
PG
PG
=
µ̂d
− µd
, mseBC (µ̂d ) = 2mseB (µ̂d )−
msed 1 .
B1 b =1
B1 b =1
1

1

12

(1−α)

5. Calculate statistic SP G,B with the critical value qP G,SB obtained from the bootstrap
(1)
(B1 ) t
sample SP G,B = (SP G,B , . . . SP G,B
) , where


(b1 )
∗(b1 )
P G∗(b1)
(1−α)
SP G,B
= max ADP G,d
/σ̂ ∗(b1) µ̂d
and qP G,SB = Q1−α (SP G,B )
d=1,...,D

as well as a variance estimate for θ̂:
vd
ar(θ̂) =

B1
B1
1 X ∗(b1 )
1 X
θ̂
.
(θ̂ ∗(b1 ) − θ̄)(θ̂ ∗(b1 ) − θ̄)t with θ̄ =
B1 b =1
B1 b =1
1

(24)

1

We compare the performance of SCI and MTP for different variability
estimates σ̂(µ̂Pd G )
√
G
and their bootstrap equivalents σ̂ ∗ (µ̂∗P
), namely for σ̂(µ̂Pd G ) = ĝP G1d and σ̂(µ̂Pd G ) =
d
q

mse(·) (µ̂Pd G ). Here, mse(·) refers to either the plug-in mseP , the mseB or the mseBC ,
defined in (8), (4) and (5). Steps 3(a)-(c) refer to the second-stage bootstrap which is
only necessary to obtain bias corrected mseBC . Under the Poisson-gamma model, we are
ˆPd G = µ̂Pd G /Nd , ḡˆP G1d =
interested in the estimation of poverty rates. We thus consider µ̄
ˆPd G ) = mse(·) (µ̄
ˆPd G )/Nd2 .
ĝP G1d /Nd2 and mse(·) (µ̄
For the Poisson-lognormal model with yd ∼ P oisson(µPd L ), µPd L = νd ρd , the parameter
of interest is ρ with Nd = νd , estimated by EBP (Boubeta et al., 2016). We take the
fixed parameters from Section 5, i.e., (β t , δ) = (−2.264, 3.480, −0.870, 4.842, 0.125, 0.322)t .
Covariates, sample sizes, number of simulation runs and bootstrap replicates are the same
as in case of the Poisson-gamma model. The variability of the ρ̂d was estimated using
bootstrap MSEs, that is mseB and mseBC . To obtain estimates of SCI and iCI one can
∗(b )
use almost the same algorithm as above by changing the way we generate yd 1 .
B
D = 26
D = 52
D = 78

95.7
94.7
94.7

D = 26
D = 52
D = 78

24.4 (0.025)
30.3 (0.030)
33.4 (0.027)

Poisson-gamma
BC
P
ECP (in %)
95.9
95.8
93.7
94.9
94.8
94.9
3
AIW ×10 (AIWV ×103 )
24.5 (0.028) 24.5 (0.024)
30.3 (0.034) 30.4 (0.029)
33.4 (0.032) 33.5 (0.025)

G
95.3
94.6
94.4
23.9 (0.023)
29.8 (0.028)
33.0 (0.024)

Poisson-lognormal
B
BC
ECP (in %)
95.0
94.6
94.9
94.8
94.9
94.6
3
AIW ×10 (AIWV ×103 )
18.0 (0.003) 18.0 (0.004)
20.7 (0.003) 20.8 (0.004)
21.9 (0.002) 22.0 (0.004)

Table 1: ECP, AIW and AIWV of SCI under area-level models. Nominal coverage: 95%.

13

ˆPd G constructed with mseB (B),
Table 1 summarizes the performance of 95% SCI for µ̄
mseBC (BC), plug-in mseP (P) and ĝP G1d (G). For ρ̂d , they were constructed using mseB
(B) and mseBC (BC). All methods perform very well regarding the coverage ECP, even for
D = 26. In contrast, SCIs constructed using a Bonferroni procedure yield unacceptably
low ECP. For instance, for D = 52 and mseB it equals 78% for the Poisson-gamma, and
88% for the Poisson-lognormal model. Therefore we do not further report them.

Number of Units in the Area

0.1

0.2

Interval Estimation
0.3
0.4

0.5

0.6

0.7

1
2
3
4
SCI iCI

5

Figure 1: 95% iCI and SCI for proportions with D = 52. Red dots indicate true parameters
outside iCI, whereas black dots indicate true parameters inside their iCI.
Figure 1 presents 95% SCI and iCI estimates for a randomly selected simulation under
the Poisson-gamma model. The plot is divided into 5 panels according to the number of
units N̂ddir defined in (25) with the first presenting the results for the areas with the fewest
observations. The black and red dots represent the true proportions known in a simulation.
The color red indicates true parameters not covered by theirs iCIs. In Figure 1, that holds
for four of the true values (≈ 7.7%). This illustrates well the difference between individual
and simultaneous inference as well as a particular relevance of the latter. We obtain similar
figures for the other simulations (see our SM).
Finally we studied the performance of our test (19) under Poisson-gamma and Poissonlognormal models. Results for the latter are in our SM as they reveal the same features.
Consider H0 : µ̄P G = b vs. H1 : µ̄P G = b+1D ∆, where b := µ̄ for the same data generating
processes as before. Critical values are obtained from the bootstrap analogues of SH0
calculated similarly as in Step 5 of the algorithm above. Figure 2 shows the power functions
of our test based on different variability estimates. They are visibly indistinguishable, which
is not surprising given the similar ECPs and AIWs in Table 1. For D = 52, i.e., the sample
size of the real data, the nominal level of 5% is attained almost exactly under H0 .

14

D=52

D=78
1.00

0.75

0.75

0.75

0.50
B
BC
G
P

0.25
0.05
−0.15 −0.10 −0.05 0.00

∆

0.05

0.10

0.15

Power

1.00

Power

Power

D=26
1.00

0.50
B
BC
G
P

0.25
0.05
−0.15 −0.10 −0.05 0.00

∆

0.05

0.10

0.15

0.50
B
BC
G
P

0.25
0.05
−0.15 −0.10 −0.05 0.00

∆

0.05

0.10

0.15

Figure 2: Simulated powers for multiple test H0 : µ̄P G = h versus H1 : µ̄P G = h + 1D ∆
under the area-level Poisson-gamma model; (left) D = 26, (middle) D = 52, (right) D = 78.

4.2

Finite sample performance of SCI under the unit-level model

Under the unit-level model we assume ydj ∼ Bin(mdj , pdj ) with pdj = {exp(xtdj β+δud )}/{1+
exp(xtdj β + δud )}, mdj = 1, ud ∼ N (0, 1). In our context, ydj is binary and value 1 indicates
an individual below the poverty threshold defined in Section 5. The regression parameters
are taken from our case study: θ = (β t , δ) = (−2.048, 0.989, 0.172, 0.760, 0.100, 0.348)t .
Four categorical covariates result in 16 covariate classes xdj ∈ {z1 , . . . , z16 } for which we
need to estimate Ndl using equation (25), l = 1, . . . , 16. We considered D = {26, 52, 78}
containing unit-level information with n = {11423, 23628, 35818}, respectively. Summary
statistics for all samples are presented in Table 2. Furthermore, for D = 52, nd , Nd , xdj ,
zl are the same as in our case study. The areas for D = {26, 78} were selected as in
Section 4.1. In addition, for the latter, within each of the additional area we sampled with
replacement nd units (i.e., 26 newly sampled areas contained different units in comparison
to the original sample). The parameter of interest is the area poverty proportion µ̄Ud defined
in (11). Given the original sample size was n = 23628, under the unit-level model we restrict
our simulations to K = 200, B1 = 500 and B2 = 1. As far as the algorithm for constructing
SCI and iCI is concerned, it follows almost the same steps as in Section 4.1. The exact
algorithm can be found in the SM.
Min.
47

Q1
139

D = 26
Q2 Mean Q3
260 439 454

Max.
1714

Min. Q1
34
108

D = 52
Q2 Mean
260 454

Q3 Max.
479 2631

Min. Q1
34
114

D = 78
Q2 Mean
289 459

Q3 Max.
482 2631

Table 2: Summary statistics of nd under different scenarios in the simulation study.
Table 3 presents the performance of SCI constructed using mseB (B) and mseBC (BC).
The coverage probability is somewhat lower than the nominal level. In addition, it slightly
decreases with increasing D, whereas the AIW increase stabilizes as expected (see Remark
1). The undercoverage might be related to the simulation design. Even tough the latter
15

D
26
52
78

ECP (in %)
B
BC
94.0 93.0
93.5 93.0
92.0 91.5

AIW×103 (AIWV×103 )
B
BC
134.0 (0.193) 135.0 (0.268)
150.3 (0.139) 150.9 (0.189)
153.9 (0.125) 155.1 (0.234)

Table 3: ECP, AIW and AIWV of 95% SCI under the unit-level model.
is popular in SAE, it is suboptimal for random effects from the asymptotic point of view
(nd 9 ∞, d ∈ [D], recall Section 2.1). The results in Table 3 do not demonstrate any
inconsistencies with respect to the theoretical developments, nor they exhibit unexpected
findings. Due to their limited impact, the equivalents of Figures 1 and 2 for this simulation
are deferred to our SM. In comparison to the area-level models, the coverage probability is
worse and the average width of SCIs is much larger (it is also the case for the iCI, see our
SM). Moreover, fitting unit-level models is computationally more expensive. In our case
the estimation of MSE and construction of intervals took about 900 to 1000 times longer.
Since the data generation processes are different, the numerical results in our simulations
are not directly comparable. However, our empirical studies suggest to give some preference
to the area-level modeling in the considered GLMM settings.
Our simulations lead us to following conclusions. First, for a given sample size and data,
our SCI attains the nominal coverage probability, almost independently from the choice of
the estimator of variability. In particular, the area-level models yield very accurate results
even for small samples. Second, the distinction between SCI and iCI is crucial, and the
latter should not be employed in comparative studies. Third, the numerical performance of
our√test for comparative studies is satisfying. Given the simplicity of SCI and tests based
on ĝ1d , we restrict further presentations to them.
Remark 3. In our simulation study we do not analyze the performance of direct estimators
for proportions, because our goal is to study the numerical performance of our MTP and
SCIs, and to compare them to existing iCIs. Since MTP and SCIs are the first tools
for simultaneous inference with GLMM-based mixed parameter, we concentrate on their
implementation and application to the well-known model-based estimators. These have
been thoroughly examined in comparative analyses which included direct estimators (see
for instance Boubeta et al., 2016; Hobza and Morales, 2016). In our case study in Section
5, we include direct estimators in order to have an almost model-free benchmark.

16

5

Predicting Poverty Rates in Galicia

Poverty prediction is of great interest for statistical offices. It provides a basis on which
local or central authorities can decide about resource allocation and related polices. The
interest is not in individual, randomly chosen small areas but in the total picture. Resource
distribution requires comparative statistics, and one would thus provide SCI instead of iCI.
We illustrate our methodology calculating point estimates, iCIs and SCIs for the poverty
rates in each county of Galicia, i.e., the proportions of inhabitants who live under a poverty
line. We make use of a general part of the Structural Survey for Homes (SSH) in Galicia in
2015 with 23628 individuals within 9203 households located in 52 counties (small areas).
The survey does not produce official estimates at the area level, but we managed to recover
the direct estimates of the totals of people below the poverty line (Yd ), as well as the number
of inhabitants (Nd ) for each county. For the area-level models, we need to calculate the
number of units which fall into a particular category (Xdi ), e.g., number of employees
or of graduates in each county of Galicia, i = 1, . . . , p. The latter are used to obtain
the proportions of individuals in each category X̄di = Xdi /Nd . For the unit-level model,
we need to obtain the number of units Ndl falling into artificially created categories zdl ,
d = 1, . . . , D, l = 1, . . . , L, see Section 2.2.3. The explicit formulas are
X
X
X
wdj xdj 1{xdj =zl } ,
wdj , N̂dldir =
wdj ydj , N̂ddir =
Ŷddir =
j∈Rd

j∈Rd
dir
X̂di
=

X

wdj xdji ,

ˆ dir = X̂ dir /N̂ dir ,
and X̄
di
di
d

j∈Rd

(25)

j∈Rd

where Rd ∈ Pd are the sample elements belonging to area d, d ∈ [D], wdj sampling weights,
and ydj binary variables with 1 indicating that an individual is below the poverty line. The
poverty threshold is calculated from the survey. It is set to 0.6 of the median household
income per capita in Galicia, i.e., we do not use county specific poverty lines. This income is
calculated in each household according to scale developed by the Organisation for Economic
Co-operation and Development (the same technique is used by Eurostat). The model based
approach of this paper assumes that the estimates in equation (25) are considered to be
known, non-random quantities, following López-Vizcaíno et al. (2015). SSH provides many
categorical, auxiliary variables. Under the unit-level model these are binary variables with
1 indicating that a person belongs to a particular category, whereas under area-level models
we use the county proportions. We considered four variables for labour status: children
(ls0), employed (ls1), unemployed (ls2), inactive (ls3), and four covariates for education: less
than primary (ed0), primary (ed1), first and second level secondary (ed2), higher education
(ed3). Furthermore, we analyzed three variables for the size of municipality: less than 10
17

000 (sm1), 10 000-50 000 (sm2), more than 50 000 (sm3). We have also investigated the
effect of two variables indicating the nationality, that is, Spanish (n1), not Spanish (n2).
Finally, we examined five age variables: < 15 (age1), 15 − 24 (age2), 25 − 49 (age3), 50 − 64
(·)
(·)
(age4), >= 65 (age5). We are interested in µ̄d := µd /Nd with (·) standing for P G or
U in case of Poisson-gamma and binomial model, respectively, and in ρd in case of the
Poisson-lognormal model. We first compute estimates of proportions and their variances
using the same formulas as Boubeta et al. (2016):
dir
ˆ dir = Ȳd ,
p̂dir
d = Ȳd
N̂ddir

var(p̂
ˆ dir
d ) =

1

X

(N̂ddir )2

j∈Rd

wdj (1 − wdj ) ydj − p̂dir
d

2

.

(26)

We used estimates in (26) to construct design-based iCI intervals (Dir) displayed in Figure
3. Following López-Vizcaíno et al. (2015), we then proceed with a variable selection inspired
by the simulation results. More specifically, under the Poisson-gamma model we check if
any of the levels of categorical variables for labor status, education and age are significant at
the α = 0.05 level. We examined these covariates in the first place, because they turned out
to be important in earlier studies on poverty rates (see, for instance, Boubeta et al., 2016).
In this way we selected ls2, ed2 and age2. Afterwards, we tested the levels of variables
nationality and the size of the municipality and we additionally retained sm1 which was
significant after the selection of ls2, ed2 and age2. The same categories were then used to
other models, see Table 4. As we do not carry out a causality analysis, we refrain ourselves
from a discussion of the magnitude or signs of estimates. We only notice that under the
Poisson-gamma model, the signs are consistent with our expectations; unemployment and
young age are associated with higher poverty rates, whereas higher level of studies or living
in a small municipality is associated with lower poverty rates.

Int
ls2
ed2
age2
sm1

Poisson-gamma
β̂
SE
z-value P (> |z|)
10.038 0.669 15.005
0.000
7.747 3.091 2.506
0.012
-3.136 1.201 -2.611
0.009
11.317 4.023 2.813
0.005
-2.466 0.267 -9.224
0.000

β̂
-2.264
3.480
-0.8703
4.842
0.125

Poisson-lognormal
SE
z value Pr(>|z|)
0.341 -6.633
0.000
1.577 2.207
0.027
0.612 -1.422
0.155
2.057 2.354
0.019
0.136 0.918
0.358

Unit-level model
β̂
SE
z-value P (> |z|)
-2.048 0.067 -30.415
0.000
0.989 0.052 19.160
0.000
0.172 0.039 4.442
0.000
0.760 0.058 13.033
0.000
0.100 0.050 1.993
0.046

Table 4: Estimates of regression parameters under the area- and the unit-level models with
δ̂ P G = 2.48, δ̂ P L = 0.32 and δ̂ U = 0.35, respectively.
Figure 3 shows point and iCI estimates of proportions under Poisson-gamma (PG),
Poisson-lognormal (PL) and binomial (Unit) models together with direct estimates (Dir).
In this plot we compare point estimates within four modeling frameworks; we do not
compare them across different areas within the same model. First, the variability reflected
18

0.6
Dir
Unit
Area PG
Area PL

0.5

iCI

0.4
0.3
0.2
0.1
0.0

2070−11918

12095−18096 18374−28442 29388−70678
Number of Units in the Area

74941−414909

Figure 3: Design and model-based 95% iCIs.

Interval Estimation

by the width of iCIs decreases with the number of units in each area N̂ddir defined in (25).
Second, even though the area sample sizes nd , d ∈ [D] are not that small, the iCI of direct
estimates are wider than model based estimates, which is in accordance with the literature.
The width difference is especially pronounced when comparing area-level-based with designbased direct estimates – the latter entirely cover the former. Unit-level model-based point
and interval estimates are different with much wider iCIs than under area-level models, but
still overlapping with the direct estimates. Only in one case (6th area in the third panel),
the iCIs under area-level models do not overlap with the iCI under the unit-level model
which indicates a possible bias in one of the approaches. In contrast, both area-level models
produce almost identical estimates.
iCI
SCI

0.3
0.2
0.1
0.0
2070−11918

12095−18096

18374−28442

29388−70678 74941−414909

Number of Units in the Area

Figure 4: 95% iCI and bootstrap SCI estimates for EBP poverty rates in counties of Galicia.
ˆP G
√ Figure 4 presents bootstrap iCI and SCI for µ̄d , d = 1, . . . , D constructed with σ̂(ζ̂d ) =
ĝP G1d as defined in (9). The plot is divided into five panels according to the numbers of
units in each area obtained by direct estimates of county inhabitants N̂ddir in (25). Figure
4 serves as an illustration of the differences between individual and simultaneous inference.
When comparing iCIs and SCIs, in many cases (e.g., first and second county of the first
19

panel in Figure 4) iCI would insinuate statistically different poverty rates, whereas SCI
does not confirm this claim. Such multiple comparisons are valid only if we use SCIs. In
addition, at least 5% of the true poverty rates are not contained in their iCIs. Analogous
figures under the Poisson-lognormal and binomial models lead to the same conclusions.
They are thus deferred to the SM. Further model selection and specification testing might
be interesting but they are beyond the scope of this article. Since we do not know which
model is closer to the real data generating process, we proceed with the Poisson-gamma
area-level model, as it is reliable and the least computer intensive. Left and middle panel of
Figure 5 depict the resulting maps of the counties with the corresponding lower and upper
bounds of our SCI. We observe a higher rate of poverty in the interior and a south-western
part of the region whereas a lower level is typical for the northern part. These conclusions
are similar to those drawn by Boubeta et al. (2017).

Figure 5: SCIs of EBP poverty proportions: (left) lower boundary, (middle) upper boundary; (right) significant differences in poverty rates between women (F) and men (M).
Finally, we investigate whether men and women are equally affected by poverty. We wish
to test for equality on the county level across Galicia. Testing for each county individually
at α = 5% error level results in rejection of at least 5% of the hypotheses of no significant
difference. We thus use our MPT and consider clusters created from the cross-section of
sex and county such that ζ ∈ R104 . We test H0 : Bζ = 052 versus H1 : Bζ 6= 052 where
B ∈ R52×104 with rows being vectors with 1 on the 2d − 1 place, −1 on 2d place, and
ζ̂|
≈ 20.489 while the
0 elsewhere. The max-type test statistic yields tH = maxd=1,...,D |B
σ̂(ζ̂)
(1−α)

bootstrap critical value under H0 is qBH0 ≈ 2.999. Thus, we strongly reject H0 . However,
our test does not support the hypothesis that women are more affected than men, or vice
versa, see the right panel of Figure 5. Additional results are deferred to our SM.
Remark 4. Imagine that Galician counties were considered as part of a macro region, e.g.,
Spain with DS counties, and consider two inferential problems: (a) the calculation of SCIs
20

for the poverty rates in all DS Spanish counties, (b) the calculation of SCIs only for D
Galician counties, but using all data. Following Remark 1, we expect that the widths of
our SCIs in Figure 4 would increase in case (a) to maintain the joint coverage probability
of 95% for all DS > D counties. In contrast, they would most likely slightly decrease in
case (b). In fact, the simultaneous coverage probability of 95% would be requested for the
set of D counties, but SCI would be constructed using a more precise estimate of MSE
computed using a larger data set with DS counties.

6

Conclusions

We developed a methodology that allows for statistically valid simultaneous inference for
EBP under GLMM. We constructed SCI and MTP applying a combination of max-type
statistics and consistent bootstrap estimation of its distribution. These tools enable practitioners to make comparisons between areas. In contrast, the iCIs are not suitable for
such comparative analyses because they are constructed at individual confidence level and
disregard an additional variation which arises in joint studies. We do not claim that SCIs
and MTP are better than iCIs or t-tests. The former simply complete the toolbox for statistical inference for mixed parameter ζd . Similarly, the simultaneous inference completes
the individual inference for fixed parameters. We introduced various versions of statistics to
construct SCI and MTP. Within our framework, all of them exhibited similar performances
without indicating a clear winner.
Our methodology can be extended to more complicated data structures such as GLMM
with spatial or temporal correlation (see, e.g., Hobza et al., 2018; Chandra et al., 2019).
One could also consider spatio-temporal or nonparametric models to build SCI by adjusting the statistic S0 and choosing a bootstrap procedure accordingly. Apart from a
mathematical challenge to develop a valid asymptotic theory, these extensions would require a construction of an appropriate bootstrap scheme and its computationally efficient
implementation.

A

Appendix

A.1

Regularity conditions

In this section we state the regularity conditions used in our derivations.
1. ûd = arg maxud ∈R {log gd (yd |ud , θ) + log h(ud )}.

21

2. l(θ) exists and is well-defined if: (a) l(θ) is continuous, uniquely maximized and
θ0 ∈ Θ, where θ0 is a true parameter value; (b) l(θ) and ˆl(θ) are concave; (c) θ0 is
an interior point of the parameter space and the estimator θ̂ is an interior point of
the neighborhood of θ0 ; (d) ˆl(θ) converges uniformly in probability to l(θ).
m
) < ∞ for all d ∈ [D], j ∈ [nd ], where m is suitable large.
3. xdj are bounded and E(ydj

4. For each fixed y, a score equation is continuously differentiable and E{R(θ0 )} = 0.
5. lim inf λ[n−1 Var{R(θ)}] > 0 and lim inf λ[−n−1 E{∇R(θ)}] > 0 where ∇R(θ) =
n
∂R(θ)
∂θ

n

and λ[A] indicates the smallest eigenvalue of matrix A.

The first two conditions refer to the log-likelihood function (see, for example, Bianconcini,
2014), whereas conditions 3-5 are needed for the derivation of the MSE estimators.

A.2

Proof of Proposition 2

∗
∗
Let ydj
∼ Exp.F amily(θ). If u∗d is sampled from a suitable distribution, then we have γdj
=
∗
∗
∗
∗
∗
∗ ∗
∗
∗
∗ ∗
∗
t
M (E(ydj |ud )) = xdj β̂ + ud . Furthermore, Var (yd ) = Var (E (yd |ud )) + E (Var (yd |ud )).
The first part of the Proposition follows from the way we generate the random effects as
well as results on the consistency of θ̂. To show the second part we consider a general score
P
∗
∂ log fd (yd∗ |θ̂)
= 0.
equation. Replace y by y ∗ and set θ = θ̂, i.e., R∗ (θ) = ∂l∂ θ̂(θ̂) = D
d=1
∂ θ̂
∗
∗
∗
Then E {R (θ)} = 0 at θ = θ̂ which yields consistency of θ̂ .


A.3

Proof of Proposition 3

Let ζd be a general EBP, gd := gd (θ) and ĝd := ĝd (θ̂). Assume that ||ĝd − gd || = OP (n−c ).
The proof uses ideas of Chatterjee et al. (2008). We investigate the properties of Gd (a).
!
"
( √
)# !
√
a( ĝ d − g d ) + ζ̃d − ζˆd
ζ̂d − ζd
ζ̃d − ζd
√
6a =E P
6a+
yd
Gd (a) = P
√
√
gd
gd
ĝ d

= E [Φ{a + Q(a, yd )}] = Φ(a) + φ(a)E {Q(a, yd )} − 2−1 aφ(a)E Q2 (a, yd )
"Z
#
a+Q(a,yd )
+2−1 E
{a + Q(a, yd ) − x}2 (x2 − 1)φ(x)dx .
a

Applying some classical results and a triangle inequality, it follows that the last term is
bounded by E|Q|3 , and is of smaller order than the first three terms. Therefore, the first
22

step towards consistency of SCIs is to quantify the asymptotic expansions of E{Q(a, yd )}
and E{Q2 (a, yd )}. We decompose Q(a, yd ) into
−1/2

Q(a, yd ) = gd

−1/2 1/2
1/2
(ζ̃d − ζˆd ) + agd (ĝd − gd ) = Q1 + Q2 .

Let ψ be a twice differentiable function with respect to θ, yd. = yd1 + · · · + ydnd , ∀d ∈ [D].
Observe that yd. = yd under an area-level model. The specific form of ψ depends on
the choice of the GLMM (for instance, under the Poisson-gamma model we spelled it out
in (7)). Function ψ satisfies the decomposition
t 


∂
ψd (yd. , θ)
θ̂ − θ
ζ̂d − ζ̃d = ψd (yd. , θ̂) − ψd (yd. , θ) =
∂θ
(27)
 2




t
∂
1
2
θ̂ − θ
ψd (yd. , θ)
θ̂ − θ + oP (||θ̂ − θ|| ).
+
2
∂ 2θ
Let C = 2c where c > 0. Since we assume ||θ̂ − θ|| = OP (n−c ), we have
"
#2 

t 
h
i

1
∂
 + o(n−C ).
E {ζ̂d (θ̂) − ζ̃d (θ)}2 = C E 
ψd (yd. , θ) nc θ̂ − θ
n
∂θ

(28)

As for Q1 , it has been found in equation (27) that
#
"
t 


∂
1
c
ψd (yd. , θ) n θ̂ − θ + o n−c ,
E(ζ̂d − ζ̃d ) = c E
n
∂θ
n
o
and E (ζ̂d − ζ̃d )2 = O(n−C ), thanks to the result in equation (28). Furthermore, observe
that gd is of order O(1) which leads to E(Q1 ) = O(D−c ) as well as E(Q21 ) = O(D−C ).
−1/2 1/2
1/2
When
we turn to Q2 , we have an immediate simplification Q2 = agd (ĝd − gd ) =

a (ĝd /gd )1/2 − 1 . Let gd be twice differentiable with respect to θ. Similarly to the computations above, we have the expansion
t 


 1
t  ∂ 2

∂
gd (θ)
θ̂ − θ +
θ̂ − θ
g
(θ)
θ̂
−
θ
+ oP (||θ̂ − θ||2 ).
ĝd (θ̂) = gd (θ) +
d
2
∂θ
2
∂ θ
Therefore we obtain
#
"
t


1
∂
E{ĝd (θ̂)} = gd (θ) + C E
gd (θ) nC θ̂ − θ + O(n−C ).
n
∂θ

It follows that E (ĝ/g)1/2 = O(n−c ), E(Q2 ) = O(n−C ) and E(Q22 ) = O(n−C ). We can
deduce that Gd (a) attains the asymptotic expansion Gd (a) = Φ(a) + n−c γ(a, θ) + O(n−C ).
A similar expansion can be established for G∗d (a) if we replace θ with θ̂ and P with P ∗ .
23

B
B.1

Supplementary material
Introduction

This document contains additional information to the paper Simultaneous Inference for
Empirical Best Predictors with a Poverty Study in Small Areas which introduces uniform
inference for mixed parameters in Generalized Linear Mixed Models (GLMM). Specifically,
we consider empirical best predictor (EBP) and construct simultaneous confidence interval
(SCI) and multiple testing procedure (MTP). Our main motivation stems from the gap in
the statsitical literature – existing methods for mixed parameter do not allow for valid comparative analyses. For example, in a great majority of literature on small area estimation
(SAE) only individual confidence intervals (iCI) are considered.
The rest of this document is organized as follows. In Section B.2 we provide a decomposition of the Mean Squared Error (MSE) of the EBP which was used in the main article.
Sections B.3, B.4 and B.5 present more details on the estimation assuming the area-level
Poisson-gamma, the area-level Poisson-lognormal and the unit-level binomial models, respectively. In particular, Section B.3.2 contains the derivation of a new MSE estimator,
whereas in other sections we present results of various simulation studies assessing and
comparing the finite sample performances of estimators for fixed effects, EBPs and their
variability. Finally, in Section B.6, we provide additional information on the case study of
poverty across counties in Galicia, Spain. This includes comparisons of confidence intervals
and diagnostic residual plots.

B.2

MSE of EBP under GLMM

We start with a decomposition of MSE of EBP under GLMM. Consider a general EBP ζ̂d
MSE(ζ̂d ) = E[(ζ̂d − ζd )2 ] = E[(ζ̂d − ζ̃d + ζ̃d − ζd )2 ]
= E[(ζ̂d − ζ̃d )2 + (ζ̃d − ζd )2 + 2{(ζ̂d − ζ̃d )(ζ̃d − ζd )}]

(29)

= E[(ζ̂d − ζ̃d )2 ] + E[(ζ̃d − ζd )2 ] =: g2d + g1d ,
where the fourth equality follows by the law of iterated expectation, that is
E[(ζ̂d − ζ̃d )(ζ̃d − ζd )] = E{(ζ̂d − ζ̃d )E[(ζ̃d − ζd )|yd ]} = 0,
by the definition of ζ̃d (θ) = E[ζd |yd ]. Furthermore, we can decompose g1d to obtain
g1d = E[(ζ̃d − ζd )2 ] = E(ζ̃d2 ) + E(ζd2 ) − 2E[ζ̃d E(ζd |yd )] = E(ζd2 ) − E(ζ̃d2 )
once again by the definition of ζ̃d .
24

(30)

B.3
B.3.1

Additional details on the area-level Poisson-gamma model
Estimation of parameters

The derivation of the likelihood for the Poisson-gamma model proceeds as follows:

D Z ∞
Y
exp −µPd G µPd Gyd
PG
PG
L (θ) := f (y|θ) =
f (wd )dwd
y
d!
0
d=1
D
y
δ
d
Y λ δ Γ(yd + δ) Z ∞ (δ + λd )yd +δ exp(−(δ + λd )wd )wyd +δ−1
d
d
dwd
=
y
+δ
d
yd !Γ(δ)(δ + λd )
Γ(yd + δ)
0
d=1

δ 
yd
D
Y
Γ(yd + δ)
δ
λd
=
.
Γ(yd + 1)Γ(δ) δ + λd
δ + λd
d=1

(31)

The log-likelihood is proportional to
lP G (θ) =

D
X

yd −1

d=1

j=1

X

!
log(1 + δ −1 j) + yd log λd − (yd + δ) log(1 + δ −1 λd ) ,

(32)

P d −1
log(1 + δ −1 j) = 0 if
where Γ(b + c)/Γ(c) = c(c + 1) . . . (c + b − 1) if b > 1 and yj=1
yd − 1 < 0. A similar expression as in (32) has been used by Lawless (1987) who derived
the estimating equations, and implemented a scoring algorithm to obtain an estimator for
θ.
As far as the estimation method of θ is concerned, we followed the suggestions of Lawless
(1987) and implemented Newton-Raphson and Fisher scoring algorithms. Application of
both methods leads to a following iterative scheme
θ (i+1) = θ (i) − HP−1G (θ (i) )RP G (θ (i) ),

(33)

where RP G (θ) is a score vector composed of the first derivative of the likelihood. Furthermore, HP G (θ) stands for the observed information matrix JP G (θ) = −HP G (θ) under
a Newton-Raphson algorithm, and the information matrix IP G (θ) = E{JP G (θ)} under
Fisher scoring. Let the score vector RP G (θ) be defined as
RP G (θ) = (RP G1 (θ), RP G2 (θ), . . . , RP Gp+1 (θ))t .
Its components are given as follows
D

RP Gk

∂lP G X xdk (yd − λd )
=
,
=
∂βk
1
+
αλ
d
d=1
25

k = 1, 2, . . . , p,

RP Gk+1

"y −1 
#

D
d
−1
∂lP G X X
j
(y
+
α
)λ
d
d
=
=
+ α−2 log(1 + αλd ) −
,
∂α
1
+
αj
1
+
αλ
d
j=1
d=1

with α = δ −1 . The observed information matrix is composed of the negative second derivatives of the likelihood, that is
D

JP Gkr = −

X (1 + αyd )λd xdr xdk
∂ 2 lP G
=
,
∂βk ∂βr
(1 + αλd )2
d=1

k, r = 1, . . . , p,

D

X λd (yd − λd )xdr
∂ 2 lP G
=
, k = 1, . . . , p,
2
∂βk ∂α
(1
+
αλ
d)
d=1
"y −1 
#
2
D
d
2α−2 λd
(yd + α−1 )λ2d
∂ 2 lP G X X
j
2 log(1 + αλd )
−
−
=− 2 =
+
.
3
2
∂ α
1
+
αj
α
1
+
αλ
(1
+
αλ
)
d
d
j=1
d=1
JP Gk(r+1) = −

JP G(k+1)(r+1)

On the other hand, the Fisher information matrix, which is assured to be positive definite,
is composed of
D
X
λd xdr xdk
, k, r = 1, . . . , p,
IP Gkr =
(1 + αλd )
d=1

IP G(k+1)(r+1)

IP Gk(r+1) = 0, k = 1, . . . , p,
" y −1
D
d
X
X
−2
= α−4
E
−
α−1 + j
d=1

j=1

#
αλd
.
λd + α−1

The details of this derivation and some suggestions regarding the calculation are in Lawless
(1987). It is necessary to point out that we followed one of them and first we maximized
l(θ) with respect to fixed parameters for selected values of α using Newton-Raphson or
Fisher scoring algorithms. In this way one obtains a profile likelihood l(θ̃(α), α). Since
the Fisher scoring algorithm turned out to be numerically more stable, Section B.3.3 and
Section 4 and 5 of the main article contain the results obtained using this scheme. We follow
the suggestion of Boubeta et al. (2016) when it comes to the choice of the starting values,
namely we set β (0) = β̃, where β̃ is the maximum likelihood estimator under the model
without the random effects. When it comes to α, we use the properties of a random variable
which is distributed according to negative binomial, that is σd2 := Var(yd ) = λd + αλ2d .
Therefore σd2 can be estimated applying
D

σ̃d2

1 X
{yd − exp(xtd β̃)}2
=
D d=1

setting
26

α(0) =

σ̃d2 − exp(xtd β̃)
.
exp(2xtd β̃)

B.3.2

Estimation of the MSE of the EBP

Let us turn to the derivation of the MSE for EBP µ̂P G for which the best predictor (BP)
is defined by
R∞
λd wd g(yd |wd )h(wd )dwd
λd (yd + δ)
AP G (yd , θ)
=
=: ψdP G (yd , θ). (34)
E(µPd G |yd ) = 0 R ∞
= dP G
(λ
+
δ)
C
(y
,
θ)
g(y
|w
)h(w
)dw
d
d
d
d
d
d
d
0
Firstly, we focus on E(ζd2 ) from (30):
Z ∞
Z ∞
δ δ exp(−wd δ)wdδ−1
2 2
P G2
λ2d wd2
λd wd f (wd )dwd =
κ1d := E(µd ) =
dwd
Γ(δ)
0
0
Z
λ2d δ δ Γ(δ + 2) ∞ δ δ+2 exp(−wd δ)wdδ+2−1
λ2d (δ + 1)
=
dw
=
.
d
Γ(δ)δ δ+2
Γ(δ + 2)
δ
0
Then, the E(ζ̃d2 ) under Poisson-gamma area-level model is
κ2d := E(µ̃Pd G2 ) = E{E2 (µPd G |yd )} = E{ψdP G2 (yd , θ)}
 2
 X
∞
λ2d (j + δ)2
λd (yd + δ)2
=
P (yd = j),
=E
(λd + δ)2
(λd + δ)2
j=0
where we used (34) to obtain the final expression. When it comes to the estimation of g2d
in (29) under our Poisson-gamma area-level model, we used the Taylor expansion applied
in the main document in equation (28) and the result from equation (29). This gives
"
#2 

t
h
i


√
1
∂ PG
 + o(1/D). (35)
E {µ̂Pd G (θ̂) − µ̃Pd G (θ)}2 = E 
ψd (yd , θ)
D θ̂ − θ
D
∂θ
Afterwards, we employed the construction of Jiang and Lahiri (2001) to ML estimators. We
define an estimator θ̂d− based on yd− = (y1 , . . . yd−1 , yd , . . . yD ) and µ̂Pd−G = ψdP G (yd , θ̂d− ),
and we replace θ̂ (35) with θ̂d− . As a result,
"
#2 

t


√
∂ PG

c−d (θ) = E 
ψd (yd , θ)
D θ̂d− − θ
∂θ

"
#2

t
∞


X
√
∂ PG
(36)
=
E
ψd (yd , θ)
D θ̂d− − θ
|yd =j  P (yd = j)
∂θ
j=1
t


∞ 
X
∂ PG
∂ PG
=
ψ (yd , θ) Var−d (θ)
ψ (yd , θ) P (yd = j),
∂θ d
∂θ d
j=1
27

where Var−d (θ) = DE




t 
θ̂d− − θ θ̂d− − θ
which does not depend on the value of yd .

Therefore

1
c−d (θ) + o(1/D).
D
Furthermore, if we suppose that conditions 1-2 from Appendix of the main document hold,
the plug-in MSE is given by
MSE(µ̂P−dG ) = g1d (θ) +

MSE(µ̂Pd G ) = κ1d (θ) − κ2d (θ) +

1
cd (θ) + o(1/D),
D

(37)

with cd defined as above replacing θ̂d− and Var−d by θ̂d and Vard .
B.3.3

Finite sample performance

As we have mentioned in the main document, for the performance study of fixed effects β
and variability parameter δ we used the relative bias (RBIAS) and the relative root MSE
(RRMSE) which are defined as follows
v

u
K
K
u
X
X
1
1
(k)
(k)
RBIAS(θ̂j ) =
(θ̂j − θj )/|θj |, RRM SE(θ̂j ) = t
(θ̂ − θj )2  /|θj |,
K k=1
K k=1 j
where K stands for the number of simulations and θj ∈ θ = (β, δ), j = 1, . . . , 6.
In our simulation study, we used EBP to estimate proportions, in preparation for the
case study where we estimate poverty rates for different small areas. Under the arealevel Poisson-gamma model we thus considered ζd := µ̄Pd G = µPd G /Nd . The empirical
performance of the EBP ζ̂d is evaluated using bias (Bd ), average absolute bias (B), MSE
(Ed ) and average MSE (E), calculated as follows:
K
1 X (k)
(k)
(ζ̂d − ζd ),
Bd =
K k=1

B=

D
X

K
1 X (k)
(k)
Ed =
(ζ̂d − ζd )2 ,
K k=1

|Bd |/D,

d=1

E=

D
X

|Ed |/D.

d=1

We also calculated relative root MSE and the relative bias of the EBP using slightly modified formulas (compared to the fixed parameters), namely
(k)
RBIAS(ζ̂d )

=

(k)
Bd /ζ̄d ,

(k)
RRM SE(ζ̂d )

=

28

p

(k)
Ed /ζ̄d

, where

(k)
ζ̄d

K
1 X (k)
=
ζ .
K k=1 d

D
26
52
78

β̂0
β̂1
β̂2
β̂3
β̂4
0.0018 (0.1007) -0.1006 (0.7333) -0.0235 (0.5965) -0.0519 (0.5710) -0.0187 (0.1596) 0.5364
-0.0026 (0.0691) -0.0201 (0.4043) -0.0339 (0.4110) -0.0337 (0.3561) 0.0001 (0.1053) 0.1540
-0.0043 (0.0551) -0.0004 (0.3330) -0.0193 (0.3440) 0.0035 (0.2897) 0.0018 (0.0902) 0.0887

δ̂
(0.6934)
(0.2758)
(0.2043)

Table 5: RBIAS and RRMSE (in parenthesis) for ML estimators under area-level Poissongamma model.
A detailed setting of the simulation study under the area-level Poisson-gamma model is
given in the main document. Table 5 outlines RBIAS and RRMSE of θ̂. It is apparent
that both criteria decrease with an increasing number of areas.
ˆPd G , d = 1, . . . , D for quantiles
Furthermore, Table 6 summarizes bias and MSE of EBP µ̄
of set {1, . . . , D} where the domains are sorted by the sample size. The first column
shows the average absolute biases and the average MSE. The results confirm a very good
performance of this estimator.
D
26

B(E)

d
6
11
16
21

Bd (Ed )
D
d
Bd (Ed )
D
-0.0001 (0.0000)
52
11 -0.0002 (0.0000)
78
-0.0001 (0.0000)
21 -0.0001 (0.0000)
0.0001 (0.0000)
32 0.0000 (0.0001)
0.0001 (0.0001)
42 0.0002 (0.0002)
0.0002 (0.0001) B(E)
0.0003 (0.0001) B(E)

d
Bd (Ed )
16 -0.0003 (0.0000)
32 -0.0001 (0.0001)
47 0.0000 (0.0001)
63 0.0002 (0.0003)
0.0003 (0.0002)

Table 6: Bd , Ed and their averages B and E for the estimators of µ̄Pd G under the area-level
Poisson-gamma model.
(k)

On the other hand, Figure 6 depicts RBIAS and RRMSE of ζ̂d under different sample
sizes. The most striking feature, already mentioned in the main document, is an outstanding performance for D = 26 and poorer results for D = 52 and D = 78. Recall that the
smallest sample was obtained by a simple random sampling from the pool of true areas.
Relatively better performance can be thus explained by the fact that a couple of problematic areas were not selected. Extreme values are the most challenging to estimate – we
found out that a sample with D = 26 was randomly truncated, because it did not include
3 lowest and 2 highest counts of people below poverty level (see histograms and box plot
in Figure 7). As a consequence, the model was easier to fit and the EBP was estimated
more accurately. Regarding D = 52 and D = 72, their performances are similar with lower
median, yet more outliers.
Figure 8 and Figure 9 illustrate the performance of MSE and ĝ1d respectively for each
area d = 1, . . . , D. They are sorted in decreasing order. As far as MSE estimation is
29

x10−2

−3

1

−2

2

−1

3

0

4

1

2

5

3

6

x10−3

D=26

D=52

D=78

D=26

D=52
(k)

Figure 6: Box plots with RBIAS (left) and RRMSE (right) for ζ̂d
Poisson-gamma model.

D=78

under the area-level

concerned, the estimators approximate well empirical MSE (Ed ). The results are similar
for bootstrap, bias corrected bootstrap and plug-in estimators. For D = 26, they are almost
identical with the true value of MSE while for D = 52 and D = 78 they deviate slightly
from truth for the highest values and become almost indistinguishable for the lowest values
which is motivated by the same reasoning as results in Figure 6. The results for estimating
g1d in Figure 9 are even more accurate.

B.4

Additional details on the area-level Poisson-lognormal model

We provide more detailed information about the finite sample performance of EBP estimators and SCI under the Poisson-lognormal area-level model. We can, however, keep
this section much shorter than the above because this model was examined thoroughly in
the literature, see for example, Cameron and Trivedi (2013), Franco and Bell (2015) and
Boubeta et al. (2016). The detailed simulation setting for the Poisson-lognormal model is
provided in the main document.
We study first the estimators of the fixed parameters and the variance parameters.
Table 7 displays RBIAS and RRMSE of θ. Similarly to the results in Section B.3.3,
they are decreasing with a growing number of areas. Recall that in the main document we
examined the estimation of proportion for each area. Assuming the Poisson-lognormal arealevel model we considered ζd = ρd with νd = Nd . Table 8 confirms a very good performance
of the EBP ρ̂d . In Figure 10 we can observe that also the MSE bootstrap estimators for
30

8

70000

2

4

Frequency

6

50000
30000

0

0 10000

D=26

D=52

D=78

0

5000

10000

15000

20000

25000

30
20

Frequency

0

0

5

10

10

15

Frequency

20

25

40

30

pov26

0

10000 20000 30000 40000 50000 60000 70000

0

10000 20000 30000 40000 50000 60000 70000

pov52

pov78

Figure 7: Box plot and histograms of response variable for D = 26, D = 52 and D = 78.

4

7

10

13

16

19

22

26

7

mseBd
mseBC
d
msePd

4
0

1

2

3

4
3
2
1
1

Ed

6

6

mseBd
mseBC
d
msePd

5

7

Ed

0

0

1

2

3

4

5

6

mseBd
mseBC
d
msePd

5

7

Ed

1

6

12

18

24

30

36

42

48 52

1

10

20

30

40

50

60

70 78

Figure 8: MSE estimators (×104 ): (left) D = 26, (middle) D = 52 and (right) D = 78
under the area-level Poisson-gamma model.
the EBP perform well (under this model, we did not implement an analytical MSE nor an
estimator for g1d ).
31

2.5

1

4

7

10

13

16

19

22

26

gd
^
g

0.5

1

1.5

2

d

0

0.5

1

1.5

2

d

3

gd
^
g

0

0

0.5

1

1.5

2

d

2.5

3

3
2.5

gd
^
g

1

6

12

18

24

30

36

42

48 52

1

10

20

30

40

50

60

70 78

Figure 9: g1d estimators (×104 ): (left) D = 26, (middle) D = 52 and (right) D = 78 under
area-level Poisson-gamma model.
β̂0
β̂1
β̂2
D = 26 0.009 (0.219) 0.010 (0.764) -0.009 (0.986)
D = 52 0.001 (0.150) -0.006 (0.451) -0.012 (0.705)
D = 78 0.000 (0.122) -0.009 (0.349) -0.009 (0.613)

β̂3
0.028 (0.656)
-0.005 (0.410)
-0.002 (0.343)

β̂4
δ̂
-0.032 (1.582) -0.111 (0.179)
-0.026 (1.079) -0.052 (0.111)
-0.017 (0.875) -0.030 (0.083)

Table 7: RBIAS and RRMSE (in parenthesis) for ML estimators under area-level Poissonlognormal model.
Figure 11 presents iCI and our SCI for proportions constructed under the area-level
Poisson-lognormal model. Their behavior is similar to the figures for the Poisson-gamma
model in the main article. Observe that four out of true parameters (i.e., 7.7%) are not
contained in their iCIs whereas our SCIs cover all of them.
Finally, Figure 12 shows simulated powers for our simultaneous testing procedure. Their
behaviour is similar to the analogous figures assuming the Poisson-gamma model in the
main article.
D
26

d
Bd (Ed )
D
d
Bd (Ed )
D
d
Bd (Ed )
6 -0.00005 (0.00000)
52
11 -0.00008 (0.00000)
78
16 -0.00006 (0.00000)
11 -0.00001 (0.00001)
21 -0.00002 (0.00001)
32 -0.00001 (0.00001)
16 0.00002 (0.00001)
32 0.00002 (0.00001)
47 0.00002 (0.00001)
21 0.00003 (0.00001)
42 0.00007 (0.00001)
63 0.00005 (0.00001)
B(E)
0.00007 (0.00001) B(E)
0.00008 (0.00001) B(E)
0.00008 (0.00001)

Table 8: Bd , Ed and their averages B and E for the estimators of ρd under area-level
Poisson-lognormal model.

32

mseBC
d

4

7

10

13

16

19

22

26

7

mseBd
mseBC
d

4
0

1

2

3

4
3
2
1
1

Ed

6

mseBd

5

7

Ed

0

0

1

2

3

4

5

mseBC
d

6

6

mseBd

5

7

Ed

1

6

12

18

24

30

36

42

48 52

1

10

20

30

40

50

60

70 78

Figure 10: MSE estimators (×104 ): (left) D = 26, (middle) D = 52 and (right) D = 78
under area-level Poisson-lognormal model.

Number of Units in the Area

0.05

0.10

Interval Estimation
0.15
0.20

0.25

0.30

0.35

1
2
3
4
SCI iCI

5

Figure 11: iCI and bootstrap SCI for proportions under the area-level Poisson-lognormal
model, D = 52. Red dots indicate true parameters outside iCI, whereas black dots indicate
true parameters inside their iCI.

B.5
B.5.1

Additional details on the unit-level logit model
Estimation of the parameters

The unit-level binomial model is widely applied for counts or binary responses, and it
has been comprehensively discussed by, e.g., Hobza and Morales (2016). We propose a
different estimation method. However, since almost all theoretical assumptions are more
or less identical to those proposed by the authors we are going to try to be as concise as
possible not to hamper the presentation of the results.
There exist many methods to estimate the vector of model parameters θ. A direct
maximization of the log-likelihood cannot be easily performed due to the presence of an
33

D=52

D=78
1.00

0.75

0.75

0.75

0.50
0.25

B
BC

0.05
−0.15 −0.10 −0.05 0.00

∆

0.05

0.10

Power

1.00

Power

Power

D=26
1.00

0.50
0.25

0.15

0.25

B
BC

0.05
−0.15 −0.10 −0.05 0.00

∆

0.05

0.10

0.50

B
BC

0.05

0.15

−0.15 −0.10 −0.05 0.00

∆

0.05

0.10

0.15

Figure 12: Simulated power for testing H0 : µ̄ = b versus H1 : µ̄ = b + 1D ∆ under the
area-level Poisson-lognormal model; (left) D = 26, (middle) D = 52, (right) D = 78.
integral in the log-likelihood function. Nevertheless, one can approximate the integral
using adaptive Gaussian quadrature (AGQ) or approximate the integrand applying Laplace
approximation. We proceed with the former as it can be seen as a higher order version
of the latter, i.e., it provides smaller approximation error (Bianconcini, 2014). AGQ is
popular and has been implemented by, e.g., Rabe-Hesketh et al. (2005) and Joe (2008).
Another idea is to use the method of simulated moments suggested by Jiang (1998b) which
was employed explicitly to estimate model parameters under unit-level logit and arealevel Poisson-lognormal models by Hobza and Morales (2016) and Boubeta et al. (2016)
respectively. In what follows, we proceed with the likelihood based methods which might
be considered as a comparative study to the two aforementioned. Since our derivation
follows tightly the theory developed by Bianconcini (2014) under generalized linear latent
variable model (GLLVM), with some notational changes, but otherwise almost identical,
we provide only the most important points.
Consider a GLMM with one dimensional normally distributed random effect. In this
case, the structure of the exponential family allows us to write the likelihood contribution
from each area d in a simplified form defining functions id

nd 
X
1
ydj γdj − b(γdj )
+ c(ydj , ϕ) − u2d .
id (θ, ud ) =
ϕ
2
j=1
Contributions from each area are conditionally independent. Therefore, the marginal distribution of the whole data vector under the exponential family is given by
G

G

L (θ) := f (y|θ) =

D
Y

fdG (yd |θ)

−D/2

= (2π)

d=1

D Z
Y
d=1

34

R

exp {id (θ, ud )} dud .

The log-likelihood is then
D

Z

X
D
l (θ) = − log(2π) +
log
2
d=1
G

exp {id (θ, ud )} dud .

(38)

R

The asymptotic properties of AGQ were studied by Bianconcini (2014) under GLLVM.
Due to the close similarity between both models, we can use their results with a slightly
different notation. Under GLMM a score equation is given by
G

R (θ) =

=

D
X
∂ log f G (yd |θ)
d

∂θ

d=1
D Z
X
d=1

=

D
X
d=1

1
G
fd (yd |θ)

RdG (θ; ud )h(ud |yd ; θ)dud =

R

Z
R

D
X

∂
{gd (yd |ud , θ)h(ud )} dud
∂θ
(39)

Eu|y RdG (θ; ud ) ,

d=1

where RdG (θ; ud ) denotes ∂ log fdG (yd |θ)/∂θ = ∂{log gd (yd |ud , θ) + log h(ud )}/∂θ. The application of the AGQ requires rewriting the equation for a conditional likelihood under a
specific form, namely
Z
gd (yd |ud , θ)h(ud )h1 (ud |ûd , δ̂)
G
fd (yd |θ) =
dud ,
(40)
h1 (ud |ûd , δ̂)
R
where h1 (·|ûd , δ̂) is a normal p.d.f. with the following first and second moments
ûd = arg max {log gd (yd |ud , θ) + log h(ud )} ,
ud ∈R

−∂ 2 {log gd (yd |ud , θ) + log h(ud )}
δ̂ =
∂ 2 ud
2





−1

.
ud =ûd

For multidimensional random area effects, one would need to find a Cholesky decomposition
of the variance covariance matrix (see Tuerlinckx et al., 2006; Bianconcini, 2014). In case of
one dimensional random effect we can just take a square root of δ̂ 2 . Furthermore, equation
(40) can be approximated by
fdG (yd |θ, ϕ) ≈ fˆdG (yd |θ, ϕ) = 21/2 δ̂

m
X

e
A
A
gd (yd |tA
dr , θ )hd (tdr )wr ,

(41)

r=1

√

A
2
where tA
dr = ûd + δ̂ 2tr and wr = exp(tr )wr denote AGQ nodes and weights, with tdr and
wr being the classical Gaussian quadrature nodes and weights respectively (Abramowitz

35

and Stegun, 1966). Using (41) we can obtain the approximation of the whole likelihood
(38)
(
) #
"
D
m
A
A
A2
X
X
)
−
b(γ
y
γ
t
D
dj dj
dj
ˆlG (θ) = − log(2π) +
exp
+ c(ydj , ϕ) − dr wrA .
log 21/2 δ̂
2
ϕ
2
r=1
d=1
(42)
To estimate the model parameters, we use the score equation based on (42)
D

∂ ˆlG (θ) X
R̂ (θ) =
=
∂θ
d=1
G

Pm

A
A
A
RdG (θ, tA
dr )g(yd |θ, tdr )h(tdr )wr
r=1P
m
A
A
A
r=1 g(yd |θ, tdr )h(tdr )wr

=

D
X

Êu|y {Sd (θ, ud )}. (43)

d=1

Further details for the general derivatives under GLVMM are given by Bianconcini (2014).
As far as the statistical properties of AGQ based estimators are taken into account,
Bianconcini (2014) proved their consistency which follows from the relation to the Laplace
approximation. Moreover, the estimators are asymptotically normally distributed since
they belong to the class of P
M-estimators (Huber, 1964) which are implicitly defined by a
function Ψ using equation D
d=1 Ψ(yd , θ) = 0. Note that the AGQ Ψ function is given in
equation (43). As pointed out by Huber et al. (2004), one needs to verify if the regularity
conditions on the log-likelihood function for the consistency and the asymptotic normality
(see condition 2 in Appendix A.1 of the main article) are satisfied for each p.d.f. of ydj .
In case of the binomial model these were already checked by Bianconcini (2014) under
GLVMM and the proof for GLMM would be identical with a slight change of notation. As
far the unit-level model is considered, we can use equation (42) to obtain the approximated
likelihood
" m
(n

 X
nd
D
d
X
X
X
m
1
dj
G
ˆl (θ) =
exp
log
+
ydj (xtdj β + δtA
− log π + log σ̂ + log
dk )
y
2
dj
r=1
j=1
j=1
d=1
)
#!
n
d
X
tA2
dk
A
wdk
,
−
mdj log[1 + exp{xtdj β + δtA
}]
−
dk
2
j=1
and the resulting score equations for each parameter

nd 
X
mdj exp(xdji βi − δtA
dk )xdji
A
,
R̂d (βi ; tdk ) =
ydj xdji +
1 + exp(xdji βi + δtA
dk )
j=1

nd 
A
X
mdj exp(xdji βi − δtA
dk )tdk
A
A
ydj tdk +
R̂d (δ; tdk ) =
.
1 + exp(xdji βi + δtA
dk )
j=1
36

i = 1, . . . , p

The equations might be solved using, for example, quasi Newton-Raphson (Bianconcini,
2014) or a different numerical method suitable to solve nonlinear equations. Notice that
under this class of models fast implementations of AGQ are available in some packages of
the statistical software language R.
Remark 5. AGQ might be inappropriate for the area-level model due to a potential lack
of consistency, which can be seen from the rate of convergence in Bianconcini (2014). To
circumvent this problem, Jiang (1998a) suggests using the method of simulated moments
which exhibits an asymptotic order O(D−1 ) and does not depend on nd . This approach
was applied, e.g., in Hobza and Morales (2016).
Remark 6. The numerical results for our different simulation settings are not directly comparable, because the data generation processes are different to guarantee that each method
is studied with reference to the assumed model. A comparative study based on a common
model-design would be interesting but has a different focus and it might be a topic for
future research; Namazi-Rad and Steel (2015) and Hidiroglou and You (2016) have conducted interesting studies in this direction. Nevertheless, our findings are consistent with
a general statistical theory: a more complex modeling with random effects and artificially
created covariate classes inflates the variability and leads to noisier estimators. Moreover,
fitting unit-level models is computationally more expensive. For our sample sizes the estimation of MSE and construction of intervals took about 900 to 1000 times longer. To
be more specific, the computation performed using a laptop with 32 GB RAM and an
®
Intel CoreTM i9-9980HK processor with CPU 2.40 GHz, takes up to 2 days, whereas for
the area-level model just about 3 minutes. In addition, EBP under the unit-level model
is estimated using 16 different covariate classes, which requires the estimation of the size
of 16 times more artificially created clusters. Moreover, GLMM with random effects and
numerical approximations inflates the variance.
B.5.2

Estimation of EBP

˜Ud of µ̄Ud defined in the main article can be
Under the unit-level binomial model, BP µ̄
obtained using similar derivations as in Hobza and Morales (2016), that is
R
r̃dl (θ) := E(rdl |yd ) =

exp(zlt β+δud )
g U (yd |ud , θ)h(ud )dud
R 1+exp (zlt β+δud )

R
R

µ̃Ud (θ)

:=

E(µUd |yd )

=

L
X

g U (yd |ud , θ)h(ud )dud

=

AUdl (ydj , θ)
,
CdU (yd , θ)

˜Ud (θ) =
Ndl r̃dl (θ) =: ψdU (d, θ) and µ̄

l=1

37

µ̃Ud
,
Nd

R
ũd (θ) := E(ud |yd ) = RR

ud g U (yd |ud , θ)h(ud )dud
AuU
d (yd , θ)
=
,
U
U (y |u , θ)h(u )du
(y
,
θ)
C
g
d
d
d
d
d
d
R

where
#
"
nd
X
exp(zlt β + δud )
mdj log{1 + exp(xtdj β + δud )} h(ud )dud ,
=
exp δyd· ud −
t
1
+
exp(z
β
+
δu
)
d
R
l
j=1
#
"
Z
n
d
X
t
=
ud exp δyd· ud −
mdj log{1 + exp(xdj β + δud )} h(ud )dud ,
Z

AUdl
AuU
d

R

CdU =

Z

j=1

"
exp δyd· ud −

R

nd
X

#
mdj log{1 + exp(xtdj β + δud )} h(ud )dud .

j=1

˜Ud and ũd are p̂cdl = p̃cdl (θ̂), µ̂Ud = µ̃Ud (θ̂), µ̄
ˆUd = µ̄
˜Ud (θ̂) and
The EBP equivalents of r̃dl , µ̃Ud , µ̄
ûd = ũd (θ̂), where θ̂ denotes a consistent estimator of θ. They can be calculated using a
Monte Carlo simulation, as described in Hobza and Morales (2016).
B.5.3

Finite sample performance

A detailed setting of the simulation under the unit-level model is described in the main
document. Employing the simulation steps of Hobza and Morales (2016), p.671, we provide
below a shortened version of the algorithm to obtain SCIs under unit-level model.
1. Follow the steps of the parametric bootstrap procedure from Hobza and Morales
(2016), p.671.
(b )
ˆUd ∗(b1 ) − µ̄dU ∗(b1 ) .
2. Calculate ADU,d1 = µ̄
(1−α)

3. Compute statistic SU,B and the critical value qU,SB
∗(b )

(b1 )
SU,B

ADU,d1
= max
d=1,...,D
σ̂ ∗

(1−α)

(1)

(B )

and qU,SU = Q1−α (SU,B ) where SU,B = (SU,B , . . . SU,B1 )t ,

as well as the variance of θ, setting θ̄ =

1
B1

PB1

b1 =1

θ̂ ∗(b1 ) , and

B1
1 X
vd
ar(θ̂) =
(θ̂ ∗(b1 ) − θ̄)(θ̂ ∗(b1 ) − θ̄)t .
B1 b =1
1

38

D
26
52
78

β̂0
β̂1
β̂2
0.0027 (0.0451) -0.0050 (0.0682) 0.0058 (0.2990)
-0.0042 (0.0360) -0.0013 (0.0537 ) 0.0176 (0.2415)
-0.0027 (0.0263) 0.0037 (0.0418) -0.0046 (0.1773)

β̂3
β̂4
δ̂
-0.0083 (0.1017) -0.0485 (0.6725) -0.0572 (0.1903)
0.0088 (0.0726) 0.0118 (0.4895) -0.0022 (0.1367)
0.0043 (0.0645) -0.0081 (0.4163) -0.0170 (0.1035)

Table 9: RBIAS and RRMSE (in parenthesis) for AGQ estimates under unit-level model.
D
26

B(E)

d
Bd (Ed )
D
6 -0.0008 (0.0002)
52
11 -0.0004 (0.0003)
16 -0.0002 (0.0005)
21 0.0002 (0.0008)
0.0007 (0.0005) B(E)

d
Bd (Ed )
11 -0.0007 (0.0002)
21 -0.0001 (0.0003)
32 0.0005 (0.0005)
42 0.0015 (0.0008)
0.0010 (0.0005)

d
Bd (Ed )
16 -0.0013 (0.0002)
32 -0.0003 (0.0003)
47 0.0003 (0.0005)
63 0.0013 (0.0008)
B(E)
0.0012 (0.0005)
D
78

ˆUd under unit-level binomial model.
Table 10: Bd , Ed and their averages B and E for µ̄

x10−2
25

x10−3

5

−30

10

−10

0

15

10

20

20

30

40

Table 9 outlines RBIAS and RRMSE of θ. Similarly to the area-level Poisson model,
the quality of estimates improves with a growing sample size. On the other hand, a very
ˆUd is shown in Table 10. When it comes to the relative bias
good performance of EBP µ̄
and the relative root MSE in Figure 13, their behaviour is similar to the equivalents under
the area-level model, nevertheless with a higher magnitude. The estimates of MSE behave
similarly as in Hobza and Morales (2016) as can be seen in Figure 14.
Figure 15 displays iCI and SCI under the unit-level binomial model for a randomly

D=26

D=52

D=78

D=26

D=52

D=78

ˆUd under the unit-level
Figure 13: Box plots with (left) RBIAS and (right) RRMSE for µ̄
binomial model.

39

16

16

16

mseBC
d

1

4

7

10

13

16

19

22

26

13

Ed
mseBd
mseBC
d

7
1

4

7
4
1

1

4

7

10

mseBC
d

mseBd

10

13

Ed

mseBd

10

13

Ed

1

6

12

18

24

30

36

42

48 52

1

10

20

30

40

50

60

70 78

Figure 14: MSE estimators (×104 ): (left) D = 26, (centre) D = 52 and (right) D = 78
under unit-level binomial model.

Number of Units in the Area

0.05

0.10

Interval Estimation
0.15
0.20
0.25

0.30

0.35

1
2
3
4
SCI iCI

5

Figure 15: iCI and bootstrap SCI for proportions under the unit-level binomial model,
D = 52. Red dots indicate true parameters outside iCI, whereas black dots indicate true
parameters inside their iCI.
selected simulation. Red dots indicate true parameters outside iCI, whereas black dots
indicate true parameters inside their iCI. We can draw the same conclusions as under the
area-level models. Finally, Figure 16 presents results of our multiple testing procedure.
Notice that already for D = 26, the power of our test attains the nominal level of α = 0.05.

B.6

Additional details on Predicting Poverty Rates in Galicia

In this section we provide some additional results to complete the case study on the predictions of poverty rates in Galicia in the northern part of Spain. We start with diagnostic
plots that are commonly used in small area estimation.
40

D=52

D=78
1.00

0.75

0.75

0.75

0.50
0.25

B
BC

0.05
−0.15 −0.10 −0.05 0.00

0.05

∆

0.10

Power

1.00

Power

Power

D=26
1.00

0.50
0.25

0.15

0.25

B
BC

0.05
−0.15 −0.10 −0.05 0.00

0.05

∆

0.10

0.50

B
BC

0.05

0.15

−0.15 −0.10 −0.05 0.00

∆

0.05

0.10

0.15

Figure 16: Simulated power for testing H0 : µ̄ = h versus H1 : µ̄ = h + 1D ∆ under the
unit-level binomial model; (left) D = 26, (middle) D = 52, (right) D = 78.
Binomial model Pearson residuals
4
2
0
−2
−4
−6

−6

−4

−2

0

2

4

6

PL Pearson residuals

6

PG Pearson residuals

1

5

10

15

20

25

d

30

35

40

45

50

1

5

10

15

20

25

30

d

35

40

45

50

1

50

100 150 200 250 300 350 400 450

dl

Figure 17: Diagnostic plots with Pearson residuals: (left) Poisson-gamma model, (middle)
Poisson-lognormal model, (right) unit-level model.
Figure 17 illustrates diagnostic plots with Pearson residuals for the Poisson-gamma
model in the left panel, Poisson-lognormal model in the middle panel, and the binomial unitlevel in the right panel. In the left and middle panel, conditionally on the random effects,
yd is supposed to be distributed according to the Poisson distribution (see main document)
and the Pearson residuals were calculated for each county d. In contrast, under the unitlevel model we obtained Pearson residuals for each domain d and covariate class l. The
conditional distribution of ydl in the right panel is supposed to be binomial with parameters
(ndl , pdl ). The plots do not demonstrate any any serious departures from normality that
could indicate a model misspecification.
The estimates of the fixed effects are given in the main document. As we have already
mentioned, since we do not conduct a causality analysis, they should be interpreted with
caution. Assuming area-level Poisson-gamma model, unemployment and young age are
associated with higher poverty rates, whereas higher level of studies or living in a small
municipality is associated with lower poverty rates. The variance parameter estimate is
δ̂ P = 2.48. Under the area-level Poisson-lognormal model the sign of education is negative,
41

Interval Estimation

but this covariate together with living in a small municipality are not significant. In
addition, an estimated value of varaince parameter is δ̂ B = 0.32. On the other hand, under
the unit-level binomial model, the signs of all covariates are positive, and the variance
parameter estimate is δ̂ B = 0.35. Even though the focus of this analysis is to provide a
good prediction for poverty rates, and the changes of sings are less important for us, one
would tend to favour the area-level Poisson-gamma model following the intuition about
positive and negative associations in this context. The choice of this model specification is
also supported by the plot with Pearson residuals which does not exhibit any issues related
to model misspecification.
iCI
SCI

0.3
0.2
0.1
0.0
2070−11918

12095−18096

18374−28442

29388−70678 74941−414909

Interval Estimation

Number of Units in the Area
Figure 18: 95% iCI and bootstrap SCI for EBP poverty rates in counties of Galicia under
the area-level Poisson-lognormal model.

iCI
SCI

0.3
0.2
0.1
0.0
2070−11918

12095−18096

18374−28442

29388−70678 74941−414909

Number of Units in the Area
Figure 19: 95% iCI and bootstrap SCI for EBP poverty rates in counties of Galicia under
the unit-level logit model.

Figures 18 and 19 present bootstrap iCI and SCI constructed using σ̂(ζ̂d ) = mseB under
the area-level Poisson-lognormal model and unit-level logit respectively. We can draw the
42

same conclusions as in case of the analogous plot under the area-level Poisson-gamma model
in Section 5 of the main article.
0.4

Unit
Area PG
Area PL

SCI

0.3

0.2

0.1

2070−11918

12095−18096

18374−28442
29388−70678
Number of Units in the Area

74941−414909

Figure 20: 95% bootstrap SCI under area- and unit-level models.
Figure 20 presents SCI bootstrap estimates for poverty rates under area-level Poissongamma (PG), Poisson-lognormal (PL) and unit-level binomial (Unit) model. Similarly as
for the simulations in the main document, the intervals under the unit-level model are much
wider due to much larger variability.

References
Abramowitz, M. and Stegun, I. (1966). Handbook of mathematical functions. Am. J.
Phys., 34(2):177–177.
Bianconcini, S. (2014). Asymptotic properties of adaptive maximum likelihood estimators
in latent variable models. Bernoulli, 20(3):1507–1531.
Boubeta, M., Lombardía, M. J., and Morales, D. (2016). Empirical best prediction under
area-level Poisson mixed models. Test, 25(3):548–569.
Boubeta, M., Lombardía, M. J., and Morales, D. (2017). Poisson mixed models for studying
the poverty in small areas. Comput. Statist. Data Anal., 107(1):32–47.
Breslow, N. E. and Clayton, D. G. (1993). Approximate inference in generalized linear
mixed models. J. Am. Stat. Assoc., 88(421):9–25.
Cameron, A. C. and Trivedi, P. K. (2013). Regression analysis of count data. CUP.

43

Chambers, R., Salvati, N., and Tzavidis, N. (2012). M-quantile regression for binary data
with application to small area estimation. Centre for Statistical and Survey Methodology,
University of Wollongong, Working Paper, (12):1–24.
Chandra, H., Chambers, R., and Salvati, N. (2012). Small area estimation of proportions
in business surveys. J. Stat. Comput. Simul., 82(6):783–795.
Chandra, H., Chambers, R., and Salvati, N. (2019). Small area estimation of survey
weighted counts under aggregated level spatial model. Surv. Methodol., 45(1):31–59.
Chatterjee, S., Lahiri, P., and Li, H. (2008). Parametric bootstrap approximation to the
distribution of EBLUP and related prediction intervals in linear mixed models. Ann.
Statist., 36(3):1221–1245.
Chen, S., Jiang, J., and Nguyen, T. (2015). Observed Best Prediction for Small Area
Counts. J. Surv. Stat. Methodol., 3(2):136–161.
De Bruijn, N. G. (1981). Asymptotic methods in analysis. Courier Corporation.
DiCiccio, T. J. and Efron, B. (1996). Bootstrap confidence intervals. Statist. Sci., 11(3):189–
228.
Erciulescu, A. L. and Fuller, W. A. (2014). Parametric bootstrap procedures for small area
prediction variance. In Proceedings of the Survey Research Methods Section.
Franco, C. and Bell, W. R. (2015). Borrowing information over time in binomial/logit
normal models for small area estimation. Stat. Trans., 16(4):563–584.
Ganesh, N. (2009). Simultaneous credible intervals for small area estimation problems. J.
Multivariate Anal., 100(8):1610–1621.
Ghosh, M., Natarajan, K., Stroud, T. W. F., and Carlin, B. P. (1998). Generalized linear
models for small-area estimation. J. Am. Stat. Assoc., 93(441):273–282.
Hall, P. and Maiti, T. (2006). On parametric bootstrap methods for small area prediction.
J. R. Statist. Soc. B, 68(2):221–238.
Hidiroglou, M. A. and You, Y. (2016). Comparison of unit level and area level small area
estimators. Surv. Methodol., 42(42):41–61.
Hobza, T. and Morales, D. (2016). Empirical best prediction under unit-level logit mixed
models. J. Off. Stat., 32(3):661–692.
44

Hobza, T., Morales, D., and Santamaría, L. (2018). Small area estimation of poverty
proportions under unit-level temporal binomial-logit mixed models. Test, 27(2):270–294.
Huber, P., Ronchetti, E., and Victoria-Feser, M.-P. (2004). Estimation of generalized linear
latent variable models. J. R. Statist. Soc. B, 66(4):893–908.
Huber, P. J. (1964). Robust estimation of a location parameter. Ann. Math. Statist.,
35(1):73–101.
Jiang, J. (1998a). Asymptotic properties of the empirical BLUP and BLUE in mixed linear
models. Stat. Sin., 8(1):861–885.
Jiang, J. (1998b). Consistent estimators in generalized linear mixed models. J. Am. Stat.
Assoc., 93(442):720–729.
Jiang, J. (2003). Empirical best prediction for small-area inference based on generalized
linear mixed models. J. Stat. Plan. Inference, 111(1-2):117–127.
Jiang, J. (2007). Linear and generalized linear mixed models and their applications. Springer
Science & Business Media.
Jiang, J. (2013). The subset argument and consistency of MLE in GLMM: Answer to an
open problem and beyond. Ann. Statist., 41(1):177–195.
Jiang, J. and Lahiri, P. (2001). Empirical best prediction for small area inference with
binary data. Ann. Inst. Stat. Math., 53(2):217–243.
Joe, H. (2008). Accuracy of Laplace approximation for discrete response mixed models.
Comput. Statist. Data Anal., 52(12):5066–5074.
Kramlinger, P., Krivobokova, T., and Sperlich, S. (2018). Marginal and conditional multiple
inference in linear mixed models. arXiv:1812.09250.
Lawless, J. F. (1987). Negative binomial and mixed Poisson regression. Can. J. Stat.,
15(3):209–225.
Leadbetter, M. R., Lindgren, G., and Rootzén, H. (2012). Extremes and related properties
of random sequences and processes. Springer Science & Business Media.
Lele, S. R., Nadeem, K., and Schmuland, B. (2010). Estimability and likelihood inference for
generalized linear mixed models using data cloning. J. Am. Stat. Assoc., 105(492):1617–
1625.
45

López-Vizcaíno, E., Lombardía, M. J., and Morales, D. (2015). Small area estimation of
labour force indicators under a multinomial model with correlated time and area effects.
J. R. Statist. Soc. A, 178(3):535–565.
Molina, I., Saei, A., and Lombardía, M. J. (2007). Small area estimates of labour force
participation under a multinomial logit mixed model. J. R. Statist. Soc. A, 170(4):975–
1000.
Namazi-Rad, M.-R. and Steel, D. (2015). What level of statistical model should we use in
small area estimation? Aust NZ J. Stat., 57(2):275–298.
Naylor, J. C. and Smith, A. F. (1982). Applications of a method for the efficient computation of posterior distributions. J. R. Statist. Soc. C, 31(3):214–225.
Pinheiro, J. C. and Bates, D. M. (1995). Approximations to the log-likelihood function in
the nonlinear mixed-effects model. J. Comput. Graph. Stat., 4(1):12–35.
Pratesi, M. (2016). Analysis of poverty data by small area estimation. John Wiley & Sons.
Rabe-Hesketh, S., Skrondal, A., and Pickles, A. (2005). Maximum likelihood estimation of
limited and discrete dependent variable models with nested random effects. J. Econom.,
128(2):301–323.
Reluga, K., Lombardía, M. J., and Sperlich, S. A. (2019). Simultaneous inference for mixed
and small area parameters. arXiv:1903.02774.
Romano, J. P., Shaikh, A. M., and Wolf, M. (2008). Control of the false discovery rate
under dependence using the bootstrap and subsampling. Test, 17(3):417–442.
Saei, A. and Taylor, A. (2012). Labour force status estimates under a bivariate random
components model. J. Indian. Soc. Agric. Stat., 66(1):187–201.
Scealy, J. (2010). Small area estimation using a multinomial logit mixed model with category specific random effects. Research paper, Australian Bureau of Statistics.
Torabi, M. (2012). Likelihood inference in generalized linear mixed models with two components of dispersion using data cloning. Comput. Statist. Data Anal., 56(1):4259–4265.
Tuerlinckx, F., Rijmen, F., Verbeke, G., and De Boeck, P. (2006). Statistical inference in
generalized linear mixed models: A review. Br. J. Math. Stat. Psychol., 59(2):225–255.
Tzavidis, N., Ranalli, M. G., Salvati, N., Dreassi, E., and Chambers, R. (2015). Robust
small area prediction for counts. Stat. Methods. Med. Res., 24(3):373–395.
46

