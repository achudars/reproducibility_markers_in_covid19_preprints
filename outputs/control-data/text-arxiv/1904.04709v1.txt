DYNAMICAL AND ARITHMETIC DEGREES FOR RANDOM
ITERATIONS OF MAPS ON PROJECTIVE SPACE

arXiv:1904.04709v1 [math.NT] 9 Apr 2019

WADE HINDES

Abstract. We show that the dynamical degree of an (i.i.d) random sequence of dominant,
rational self-maps on projective space is almost surely constant. We then apply this result
to height growth and height counting problems in random orbits.

1. Introduction
Let K be a number field and let X be a projective variety defined over K. Given a
collection S of self maps on X, we are interested in the arithmetic properties of dynamical
orbits generated by S. To define the orbits we consider, let γ = (θ1 , θ2 . . . ) be an infinite
sequence of elements of S and let γn = θn ◦ θn−1 ◦ · · · ◦ θ1 for n ≥ 1. Then given a point
P ∈ X, we define the orbit of the pair (γ, P ) to be the set
(1)

Orbγ (P ) = {P, γ1(P ), γ2(P ), . . . }.

In particular, if X is equipped with a height function h : X(K) → R, then we are interested
in the growth rate of h(γn (P )) as we move within an orbit. This problem is (somewhat)
understood when S ⊆ End(X) is a set of morphisms, as the height growth rate in orbits can
be described by an associated canonical height function; see the seminal work of Call and
Silverman [1] for the case when S = {φ} is a single map and see work of Kawaguchi [5] for a
generalization to collections of maps. However, this problem is much less understood in the
case of dominant rational maps, even for singletons S; see [6] for results along these lines.
One obstruction that arises when the maps in S fail to be morphisms is that the growth rate
of the degree (say for maps on PN ) is mysterious in general. Further still, when S contains
at least two maps (even morphisms), there exist some sequences of functions whose degree
growth can be quite complicated, as well will see.
To begin our study of dynamical and arithmetic degrees, we fix some notation. Let X = PN
and let S ⊆ Dom(PN ) be a set of dominant rational maps on PN . Then (by analogy with
the singleton case [14]) we define the dynamical degree of infinite sequences:
Definition. Let γ be a sequence of elements of S. Then the dynamical degree of γ is
(2)

δγ = lim deg(γn )1/n ,
n→∞

provided that the limit exists.
However, as was indicated above, the dynamical degree is more subtle in the case of
multiple maps. In particular, the limit in (2) need not exist in general, even for sets of
morphisms. The following example was shown to the author by J. Silverman.
2010 Mathematics Subject Classification: Primary: 37P15, 37A50. Secondary: 11G50.
1

2

WADE HINDES

Example 1.1. Let φ1 , φ2 : PN → PN be morphisms of degree d1 and d2 respectively. Consider
the set S = {φ1 , φ2 } and the sequence γ corresponding to
γ ↔ (1, 2, 2, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, . . . );

here we alternately repeat 1’s and 2’s, each time doubling the number of occurrences. Then
it is easy to see that
 2 2k − 1 1 2k − 2
d13 3 d23 3 if k is odd,
deg(γ2k −1 ) =
 31 2k − 23 32 2k − 31
d2
if k is even.
d1
Hence, it follows that

k −1)

lim deg(γ2k −1 )1/(2

k→∞
k odd

2/3 1/3

= d1 d2

and

k −1)

lim deg(γ2k −1 )1/(2

k→∞
k even

1/3 2/3

= d1 d2 .

In particular, the limit defining δγ in (2) does not exist (unless d1 = d2 ).
On the other hand, one expects that the limit defining the dynamical degree exists for
“most” sequences. To make this precise we define a probability measure on the set of infinite
sequences of elements of S. There are several ways to do this, but the most natural (from
our perspective), is to fix a probability measure ν on the set S and then extend this to the
product space ΦS = Π∞
i=1 S via the product measure ν̄; see [10, §10.4] for details. Probabilists
refer to the corresponding probability space (ΦS , ν̄) as the space of independent, identically
distributed (or i.i.d) sequences of elements of S (distributed according to ν). In particular,
the measure ν̄ is an extension of the natural measure νn on Rthe finite product ΦS,n = S n , and
we may therefore talk about the expected value En [fn ] = ΦS,n fn dνn of a random variable
fn : ΦS,n → R on n-term sequences.
Remark 1.2. Since the sets S we consider are always finite or countably infinite, we assume
that all subsets of S are ν-measurable.
We are ready to state our first result. That is, for suitable subsets S ⊆ Dom(PN ) we
show that the dynamical degree exists and is constant outside of a ν̄-measure zero set of
sequences. This may be viewed as a sort of law of large numbers for random degree growth.
In particular, the result below holds whenever S is a finite set of dominant rational maps.
Theorem 1.3. Let S ⊆ Dom(PN ) be a set of dominant rational self-maps on PN , let ν be
a probability measure on S, and let (ΦS , ν̄) be the space of i.i.d sequences of elements of S
distributed according to ν. If E1 [log deg(φ)] exists, then there is a constant δS,ν , given by

!
En log deg(γn )
δS,ν := exp inf
,
n≥1
n
such that
δS,ν = lim deg(γn )1/n := δγ
n→∞

for ν̄-almost every sequence γ ∈ ΦS .
In particular, Theorem 1.3 motivates the following definition of the dynamical degree
associated to a set of maps with a probability measure.

DYNAMICAL DEGREES OF RANDOM MAPS

3

Definition. If (S, ν) satisfy the hypothesis of Theorem 1.3, then we call the constant δS,ν
the dynamical degree of (S, ν).
Remark 1.4. See [11] for an alternative definition of the dynamical degree of S for finite
sets. In particular, this definition uses the maximum degree of a map in ΦS,n to define a
corresponding lim sup (not a full limit). However, we note that if S = {φ2 , φ2 } are maps
of degree d1 and d2 (with d1 < d2 ) then the only sequence γ that obtains this maximum is
the constant sequence associated to φ2 . For this reason, we believe that the constant δS,ν
from Theorem 1.3, subject to some weighting of sequences, is a more reflective measure of
the collective degree growth of arbitrary compositions of maps in S.
On the other hand, in the case of morphisms, we are able to calculate explicitly the
dynamical degree of a pair (S, ν), especially in the case of finite sets of morphisms.
Theorem 1.5. Let S ⊆ End(PN ) be a set of non-constant endomorphisms on PN , let ν be
a probability measure on S, and let (ΦS , ν̄) be the space of i.i.d sequences of elements of S
distributed according to ν. Then the dynamical degree δS,ν from Theorem 1.3 is given by
 

δS,ν = exp E1 log deg(φ) .
In particular, if S is finite, then

δS,ν =

Y

deg(φ)ν(φ) ,

φ∈S

i.e., δν,S is a weighted geometric mean of the degrees of the maps in S.
Remark 1.6. Likewise in the case of morphisms (of unequal degrees), one may formulate
a central limit theorem for degree growth. To formulate such a statement, define the i.i.d
random variables Xi : ΦS → R given by Xi (γ) = log deg(θi ) for γ = (θn )n≥1 . Moreover,
assume that the variance σ 2 of the Xi is non-zero. Then when S is a set of morphisms,
! √
√

n X1 (γ) + · · · + Xn (γ)
n
1/n
Zn (γ) =
log deg(γn ) − log δS,ν .
− log δS,ν =
σ
n
σ
Moreover, the Central Limit Theorem [3, Theorem 3.4.1] implies that Zn converges in distribution to the standard normal distribution; see also [10, Theorem 21.4] for an explicit
convergence rate estimate for the Central Limit Theorem.

Equipped with some understanding of dynamical degrees, we now turn our attention to
the study of height growth rates in orbits. However, for rational maps (with non-trivial
indeterminacy locus) we must take some care to make sure that the orbits we consider are
well-defined. Given a dominant rational map φ : PN (Q) 99K PN (Q) in S, we let Iφ be the
indeterminacy locus of φ (i.e., Iφ is the set of points where φ is not defined). Similarly, let
IS = ∪φ∈S Iφ . Then, we restrict ourselves to initial points in
PN (Q)S := {P ∈ PN (Q) : Orbγ (P ) ∩ IS = ∅ for all γ ∈ ΦS }.

Moreover, in order to control certain height estimates in orbits (which become unruly when
maps of degree 1 appear), we need the following condition on S.
Definition. A set of dominant rational maps S on PN is called degree independent if
deg(γk ) ≥ 2 for all γk ∈ ΦS,k and all k ≥ 1.

4

WADE HINDES

Remark 1.7. If S is a set of morphisms of degree at least 2, then S is degree independent.
Therefore, the notion of degree independence is only necessary for non-morphisms.
With the above definitions in place, we are able to bound the height growth rate of orbits
(almost surely) by the dynamical degree; compare to the case when S is a single rational
map in [6, 14].
Theorem 1.8. Let S be a finite set of degree independent rational maps on PN , let ν be
a probability measure on S, and let (ΦS , ν̄) be the space of i.i.d sequences of elements of S
distributed according to ν. Then for all P ∈ PN (Q)S , we have that
lim sup h(γn (P ))1/n ≤ δS,ν
n→∞

for almost every γ ∈ ΦS .

Of course, one would like to replace the lim sup in Theorem 1.8 with a limit and the upper
bound with an equality. Likewise, one would like to obtain results for (suitable) infinite sets
S, as we did for dynamical degrees. To do this, we restrict our attention to sets of morphisms.
However, as we hope to illustrate below, this remains a subtle problem even for morphisms;
see Example 1.10. Moreover, to alleviate some of the difficulty that the aforementioned
example presents, we assume further that our initial point P ∈ PN is well-behaved in the
following sense.
Definition. For P ∈ PN (Q)S , we say that P is almost surely wandering for (S, ν) if the set
of sequences
{γ ∈ ΦS : Orbγ (P ) is finite}
has ν̄-measure 0.
Remark 1.9. If S is a set of morphisms of degree at least 2, then the set of points that fail
to be almost surely wandering has bounded height; see [5, Theorem 1.1]. In particular over
a fixed number field, there are at most finitely many points that can fail to be almost surely
wandering.
We illustrate the difficulty of tracking the height growth rate in orbits when the initial
point fails to be almost surely wandering.
Example 1.10. Let S = {φ1 , φ2 } = {2x2 , x2 + x}, let ν(2x2 ) = 1/2 = ν(x2 + x), and let
P = −1. Then it is straightforward to check that

ν̄ {γ ∈ ΦS : Orbγ (P ) is finite} = 1/2.

Hence, P is not almost surely wandering for (S, ν). Moreover, only “half” of all orbits have a
chance to reach the upper bound in Theorem 1.8. The obstruction here is that φ2 (P ) = 0 has
finite orbit for every γ ∈ ΦS . In Theorem 1.18 below, we show that this type of obstruction
completely characterizes how an initial point can fail to be almost surely wandering.
With these notions in place, we are ready to define the arithmetic degree of an orbit;
c.f. [6, 14]. Specifically, since one expects (generically) that h(γn (P )) exhibits exponential
growth, we make the following definition.
Definition. Let γ ∈ ΦS and let P ∈ PN (Q)S . Then we define the arithmetic degree of the
pair (γ, P ) to be the limit,
αγ (P ) := lim h(γn (P ))1/n ,
n→∞

DYNAMICAL DEGREES OF RANDOM MAPS

5

provided that the limit exists; here h : PN (Q) → R is the (absolute) Weil height [13, §3.1].

By analogy with the well-known case of a single morphism, we will prove that the arithmetic degree of a pair (γ, P ) equals the dynamical degree δS,ν defined in Theorem 1.3 with
ν̄-probability one. The proof of this result uses the notion of canonical heights constructed in
[5] and revisited in [4]. However, in order to define these canonical heights we must stipulate
that S have further properties, which we now discuss.
Remark 1.11. In Section 3, we use canonical heights for infinite sequences of endomorphisms
on PN . However, it is worth mentioning that the constructions in [4, 5] that we use in Section
3 work for polarizable sets of endomorphisms on more general projective varieties.
It is well known that if φ : PN (Q) → PN (Q) is a morphism of degree dφ , then

(3)

h(φ(P )) = dφ h(P ) + Oφ (1) for all P ∈ PN (Q);

see, for instance, [13, Theorem 3.11]. With this in mind, we let
(4)

C(φ) :=

sup
P ∈PN (Q̄)

h(φ(P )) − dφ h(P )

be the smallest constant needed for the bound in (3). Then, in order to generalize the
construction of canonical heights for a single map to a collection of maps (equivalently, from
constant sequences to arbitrary sequences), we define the following fundamental notion.
Definition. A set of endomorphisms S on PN is called height controlled if the following
properties hold:
(1) dφ ≥ 2 for all φ ∈ S.
(2) supφ∈S C(φ) is finite.
Example 1.12 (Finite collections). Let S = {φ1 , φ2 , . . . , φs } be any finite collection of endomorphisms on PN of degree at least two. Then S is height controlled.
Example 1.13 (Twisted power maps). For any non-constant, finite set of rational maps S on
P1 , the set S̄ = {φ ◦ xd : φ ∈ S, d ≥ 2} is height controlled (and infinite).
Example 1.14. Let U be the set of roots of unity in Q. Then the set S = {x2 + u : u ∈ U} is
a height controlled collection of maps on P1 . Moreover, it is worth pointing out that S has a
corresponding probability measure given by embedding U in the unit circle (in C) and then
taking the Haar measure on the circle.

We are now ready to relate arithmetic and dynamical degrees for height controlled sets of
morphisms.
Theorem 1.15. Let S ⊆ End(PN ) be a set of endomorphisms on PN , let ν be a probability
measure on S, and let (ΦS , ν̄) be the space of i.i.d sequences of elements of S distributed
according to ν. Moreover, assume that S has the following properties:
(1) S is height controlled.
(2) E1 [log deg(φ)] exists.
Then if P ∈ PN (Q) is an almost surely wandering point for (S, ν), we have that
αγ (P ) = δS,ν

for ν̄-almost every γ ∈ ΦS .

6

WADE HINDES

Tying together Theorems 1.5 and 1.15 above, we prove that if (S, ν) is a height-controlled
collection of morphisms (a sufficient condition to define suitable canonical heights) and P
is an almost surely wandering point for (S, ν), then the height of most points in almost all
orbits grow in a uniform way depending on the dynamical degree. The result below may be
viewed as a generalization of [6, Proposition 3].
Corollary 1.16. Let S ⊆ End(PN ) be a set of endomorphisms on PN , let ν be a probability
measure on S, and let (ΦS , ν̄) be the space of i.i.d sequences of elements of S distributed
according to ν. Moreover, assume that S has the following properties:
(1) S is height controlled.
(2) E1 [log deg(φ)] exists.
Then if P ∈ PN (Q) is an almost surely wandering point for (S, ν), we have that
1
#{n : h(γn (P )) ≤ B}
=
B→∞
log(B)
δS,ν
for ν̄-almost every γ ∈ ΦS . In particular, if S is finite, then
#{n : h(γn (P )) ≤ B} Y
lim
=
deg(φ)−ν(φ) ,
B→∞
log(B)
lim

φ∈S

for ν̄-almost every γ ∈ ΦS .


Example 1.17. Let c ∈ Q be any fixed constant, let S = xd + c : d ≥ 2 , and let ν be
1
the probability measure on S induced by ν(xd + c) = e(d−2)!
. Then S is a height controlled
1
collection of morphisms on P and
∞
X
log d
E1 [log deg(φ)] =
e(d − 2)!
d=2

is a convergent series. Therefore, the dynamical degree of (S, ν) exists; in fact, δS,ν ≈ 2.85052.
In particular, Corollary 1.16 implies that for all but finitely many points P ∈ P1 (Q(c)) and
ν̄-almost every sequence γ ∈ ΦS , the following estimate holds:
#{n : h(γn (P )) ≤ B}
1
lim
≈
B→∞
log B
2.85052
Finally, we give an alternative characterization of almost surely wandering points using
the expected canonical height function Eν̄ [ĥ] : PN → R≥0 constructed in [4, Theorem 1.2]
and a characterization of its kernel [4, Corllary 1.4]); see [4] or Section 4 for more details.
To state this recharacterization, we define the (total) S-orbit of a point Q ∈ PN (Q)S to be
the union of all possible orbits defined in (1), namely
[
Orbγ (Q).
(5)
OrbS (Q) :=
γ∈ΦS

In particular, we say that Q has finite S-orbit if OrbS (Q) is a finite set.

Theorem 1.18. Let S be a finite set of endomorphisms on PN all of degree at least 2, let ν
be a probability measure on S, and let (ΦS , ν̄) be the space of i.i.d sequences of elements of
S distributed according to ν. Then P ∈ PN (Q) is almost surely wandering for (S, ν) if and
only if Eν̄ [ĥ](Q) > 0 for all Q ∈ OrbS (P ).

DYNAMICAL DEGREES OF RANDOM MAPS

7

Remark 1.19. Equivalently, Theorem 1.18 states: P ∈ PN (Q) is not almost surely wandering
for (S, ν) if and only if there exists Q ∈ OrbS (P ) such that Q has finite S-orbit.
Remark 1.20. It is possible that some of the results in this paper hold for more general
projective varieties, perhaps by using the submultiplicativity of degrees (up to a constant)
recently established in [2], Kingman’s Ergodic Theorem [7], and techniques for estimating
heights developed in [6]. This is the subject of current work by the author.
Acknowledgements: We thank Vivian Olsiewski Healey, Shu Kawaguchi, and Joseph
Silverman for discussions related to the work in this paper.
2. Dynamical Degrees
When S = {φ} is a single map, a crucial tool for establishing the convergence of the
limit defining the dynamical degree is Fekete’s lemma (see the proof of [14, Proposition 7]),
which states that if an is a subadditive sequence of non-negative real numbers, then lim an /n
exists. In particular, the following landmark theorem due to Kingman [7] may be viewed
as a random version of Fekete’s lemma. In what Rfollows, the expected value of a random
variable f on a probability space Ω is the integral Ω f .

Theorem 2.1 (Kingman’s Subadditive Ergodic Theorem). Let T be a measure preserving
transformation on a probability space (Ω, Σ, µ), and let (gn )n≥1 be a sequence of L1 random
variables that satisfy the subadditivity relation
(6)

gm+n ≤ gn + gm ◦ Tn

for all n, m ≥ 1. Then there exists a T -invariant function g such that

gn (x)
= g(x)
n→∞
n
for µ-almost every x ∈ Ω. Moreover, if T is ergodic, then g is constant and
lim

E[gn ]
E[gn ]
gn (x)
= lim
= inf
.
n→∞
n→∞
n≥1
n
n
n
lim

for µ-almost every x ∈ Ω
Remark 2.2. See [7] for Kingman’s original statement, see [3, §7.4] for an exposition and a
discussion of later improvements, and see [8, 12] for the version of Kingman’s theorem that
we use here.
To apply Kingman’s Subadditive Ergodic Theorem to dynamical degrees, we use the following well known example of an ergodic, measure preserving transformation. In particular,
the lemma below is a simple consequence of Kolmogorov’s 0 -1 law [10, Theorem 10.6]; for a
further discussion, see [3, Example 7.1.6] or [9, Example 5.5] and [9, Exercise 5.11].
Lemma 2.3. Let S be a set with probability measure ν, and let (ΦS , ν̄) be the probability
space of i.i.d sequences of elements of S distributed according to ν. Then the shift map,

T (θj )j≥1 = (θj )j≥2 ,
is an ergodic, measure preserving transformation.

8

WADE HINDES

(Proof of Theorem 1.3). For n ≥ 1, consider the random variables gn : ΦS → R≥0 given by
gn (γ) := log deg(γn );

note that gn is non-negative since S is a collection of dominant maps. We will show that
the sequence (gn )n≥1 satisfies the hypothesis of Kingman’s Subadditive Ergodic Theorem.
First note that each gn is ν̄-measurable since gn factors through the finite product ΦS,n , and
every function on ΦS,n := S n , a countable set, is measurable; see Remark 1.2 above and
[10, Theorem 10.4] for standard facts about product measures. On the
Pnother hand, define
∞
fi : ΦS → R≥0 given by fi (γ) = log deg(θi ) for γ = (θs )s=1 . Then gn ≤ i=1 fi , since
(7)

In particular,

deg(F ◦ G) ≤ deg(F ) deg(G)
E[gn ] ≤

n
X

for any F, G ∈ Dom(PN ).

E[fi ] = n E[f1 ] := n E1 [log deg(φ)];

i=1

here we use that ΦS consists of i.i.d sequences. In particular, each gn is an L1 function since
E1 [log deg(φ)] is bounded by assumption. Now we check the subadditivity relation in (6), a
simple consequence of (7). Let n, m > 0, let γ = (θs )∞
s=1 , and let T be the shift map on ΦS .
Then we compute that
gn+m (γ) = log deg(θm+n ◦ · · · ◦ θ1 ) ≤ log deg(θm+n ◦ · · · ◦ θn+1 ) + log deg(θn ◦ · · · ◦ θ1 )
= gm (T n (γ)) + gn (γ),

by (7). In particular, Theorem 2.1 and Lemma 2.3 together imply that
(8)

E[gn ]
En [log deg(γn )]
gn (γ)
E[gn ]
= lim
= inf
= inf
n→∞
n→∞
n≥1
n≥1
n
n
n
n

lim log deg(γn )1/n = lim

n→∞

for ν̄-almost every γ ∈ ΦS . Moreover, applying the exponential map to this equality and
exchanging exp with the limit (justified, by continuity) gives the desire expression for δS,ν . 
It is worth mentioning that the case of morphisms in Theorem 1.5 follows from an older
ergodic theorem due to Birkhoff; see, for instance, [3, Theorem 7.2.1] or [9, Theorem 5.12].
Theorem 2.4 (Birkhoff’s Ergodic Theorem). If T is an ergodic, measure preserving transformation on a probability space (Ω, Σ, µ), then for every random variable f ∈ L1 (Ω),
n−1

(9)
for µ-almost every x ∈ Ω.

1X
f ◦ T j (x) = E[f ].
lim
n→∞ n
j=0

(Proof of Theorem 1.5). Let T be the shift map on ΦS and let f : ΦS → R≥0 be given by
f (γ) = log deg(θ1 ) for γ = (θs )s≥1 . Then Lemma 2.3 and Birkhoff’s Ergodic Theorem imply
that

Qn
n
deg(θ
)
log
1X
j
j=1
1/n
log deg(θj )
= lim
lim log deg(γn ) = lim
n→∞ n
n→∞
n→∞
n
j=1
n−1

1X
f ◦ T j (γ) = E[f ] = E1 [log deg(φ)]
n→∞ n
j=0

= lim

DYNAMICAL DEGREES OF RANDOM MAPS

9

for ν̄-almost every γ ∈ ΦS ; here we use that the degree of the composition of morphisms is
the product of their corresponding degrees.

Remark 2.5. An alternate proof of Theorem 1.5 can be given using the strong law of large
numbers [3, Theorem 2.5.6]. To see this, define the i.i.d random variables Xi (γ) = log deg(θi )
for γ = (θn )n≥1 , and note that Sn /n(γ) := (X1 (γ) + · · · + Xn (γ))/n = log deg(γn )1/n . Here
we use that S is a set of morphisms, ensuring that the degree of γn is the product of
its corresponding component degrees. However, we have instead used Birkhoff’s Ergodic
Theorem since it more closely resembles Kingman’s Theorem, our tool for rational maps.
3. Arithmetic Degrees
We begin this section with a proof that the dynamical degree bounds (a suitable notion)
of the arithmetic growth rate of most orbits.
(Proof of Theorem 1.8). Let k ≥ 1 be an integer and let Q ∈ PN (Q)S . Then a standard
triangle inequality estimate (see, for instance, the proof of [13, Theorem 3.11]) implies that
(10)

h(f (Q)) ≤ deg(f ) h(Q) + C(k, S)

for all f ∈ ΦS,k .

To see this, note that there is such a constant for each f and only finitely many f ’s, since S
is a finite set. In particular, if P ∈ PN (Q)S , if n ≥ 1, and if γnk = fn ◦ fn−1 ◦ . . . f1 for some
fi ∈ ΦS,k , then repeated application of the bound in (10) implies that


C(k,S)
C(k,S)
C(k,S)
+
+
·
·
·
+
h(γnk (P )) ≤ deg(fn ) deg(fn−1 ) . . . deg(f1 ) h(P ) + deg(f
deg(f1 ) deg(f2 )
deg(f1 )... deg(fn )
1)


≤ deg(fn ) deg(fn−1 ) . . . deg(f1 ) h(P ) + C(k, S) .
Here we use our assumption that S is degree independent, so that deg(fi ) ≥ 2 for all
1 ≤ i ≤ n. In particular,
(11)

h(γnk (P )) ≤ deg(fn ) deg(fn−1 ) . . . deg(f1 ) C(k, S, P )

for all n, k ≥ 1, all γnk ∈ ΦS,nk and all P ∈ PN (Q)S . From here we use Birkhoff’s Ergodic
Theorem to control the right hand side of (11) above. Namely, let T(k) : ΦS → ΦS denote
the k-shift map, T(k) := T k = T ◦ T ◦ · · · ◦ T . In particular, since the shift map T is ergodic
and measure preserving by Lemma 2.3, so is T(k) . Likewise, consider the random variable
F(k) : ΦS → R≥0 given by
log deg(γk )
for γ ∈ ΦS .
k
Then, rewriting the bound in (11) and taking nk-th roots, we see that


n−1

1X
1/nk
i
(12)
h(γnk (P ))
≤ exp
F(k) T(k) (γ) C(k, S, P )1/nk .
n i=0
F(k) (γ) =

In particular, (12) implies that
(13)

lim sup h(γnk (P ))
n→∞

1/nk

≤ lim sup
n→∞




n−1

1X
i
F(k) T(k) (γ) .
exp
n i=0

10

WADE HINDES

However, Birkhoff’s Ergodic Theorem 2.4 implies that
n−1


1X
i
F(k) T(k)
(γ) = E[F(k) ]
n→∞ n
i=0

(14)

lim

for almost every γ ∈ ΦS . Moreover, since a countable union of measure zero sets has measure
zero, we see that the limit in (14) is true for all k, for almost every γ ∈ ΦS . Therefore,
(13), (14), and the fact that the exponential function is continuous together imply that
 h

log deg(γk ) i
1/nk
(15)
lim sup h(γnk (P ))
≤ exp E
k
n→∞
holds for all k, for almost every γ ∈ ΦS .
We next show that the overall limit supremum in Theorem 1.8 can be computed using the
subsequence of multiples of k (for any k ≥ 1). To do this, define constants
dS,k := max deg(f ) and

(16)

f ∈ΦS,r
0≤r<k

BS,k := max C(r, S);
0≤r<k

here, we remind the reader that C(r, S) is the height bound constant given by
(17)

C(r, S) = max

f ∈ΦS,r

sup {h(f (Q)) − deg(f )h(Q)}.

Q∈PN (Q)

In particular, both dS,k and BS,k are finite since S is a finite set. From here we proceed as
in the proof of [14, Proposition 12]. Namely, for any k ≥ 1 we have that:
lim sup h(γm (P ))1/m = lim sup max h(γr+nk (P ))1/(r+nk)
m→∞

n→∞

0≤r<k


1/nk
≤ lim sup dS,k h(γnk (P )) + BS,k

(18)

by (10), (16), and (17)

n→∞

= lim sup h(γnk (P ))1/nk
n→∞

Hence, combining the bound in (15) with (18), we see that
(19)

lim sup h(γm (P ))
m→∞

1/m

 h



log deg(γk ) i
E[log deg(γk )]
≤ exp E
= exp
k
k

holds for all k ≥ 1, for almost every γ ∈ ΦS . In particular, letting k → ∞, we deduce from
(8) and (19) that
lim sup h(γm (P ))1/m ≤ δS,ν
m→∞

as desired.



We now prove that for sets of morphisms, if P ∈ PN (Q) is an almost surely wandering
point, then the arithmetic degree of a P -orbit exists and is equal to the dynamical degree
almost surely. To do this, we use the notion of canonical heights associated to infinite

DYNAMICAL DEGREES OF RANDOM MAPS

11

sequences γ ∈ ΦS defined in [5] and revisited in [4]. In particular, if S is height controlled,
then for all points P ∈ PN (Q) and all sequences γ ∈ ΦS , the limit
h(γn (P ))
n→∞ deg(γn )

(20)

ĥγ (P ) = lim

exists; see [5, Theorem 1.1] or [4, Theorem 1.2]. Moreover, we call ĥγ (P ) the canonical
height of the pair (γ, P ). With this tool in place, we are ready to relate the dynamical and
arithmetic degrees for most sequences of elements of S.
(Proof of Theorem 1.15). If P ∈ PN (Q) is almost surely wandering for a set or morphisms
S, then ĥγ (P ) > 0 for almost every γ ∈ ΦS ; see [4, Remark 2.3]. In particular, for each such
γ we can choose ǫγ > 0 and mγ so that
ĥγ (P ) − ǫγ ≤

h((γn (P ))
≤ ĥγ (P ) + ǫγ
deg(γn )

and

ĥγ (P ) − ǫ > 0

for all n > mγ . In particular, it follows that
(21)

(ĥγ (P ) − ǫγ )1/n deg(γn )1/n ≤ h(γn (P ))1/n ≤ (ĥγ (P ) + ǫγ )1/n deg(γn )1/n

for all n > mγ . On the other hand, Theorem 1.3 implies that lim deg(γn )1/n = δS,ν for almost
every γ ∈ ΦS . Hence, Theorem 1.3 and (21) together imply that
δS,ν = 1 · lim deg(γn )1/n = lim (ĥγ (P ) − ǫγ )1/n deg(γn )1/n ≤ αγ (P )
n→∞

n→∞

and
αγ (P ) ≤ lim (ĥγ (P ) + ǫγ )1/n deg(γn )1/n ≤ 1 · lim deg(γn )1/n = δS,ν
n→∞

n→∞

for almost every γ ∈ ΦS . In particular, we see that δS,ν = αγ (P ) for such γ ∈ ΦS .



Combining our knowledge of dynamical and arithmetic degrees for sets of morphisms, we
prove an asymptotic orbit counting result.
(Proof of Corollary 1.16). We follow the proof of [6, Proposition 3], which we include for
completeness. Let γ ∈ ΦS be such that αγ (P ) = δS,ν , true of almost every γ by Theorem
1.15. Then for every ǫ > 0 there is an integer n0 = n0 (ǫ, γ) so that
(1 − ǫ)δS,ν ≤ h(γn (P ))1/n ≤ (1 + ǫ)δS,ν
for all n ≥ n0 . In particular, it follows that
{n ≥ n0 : (1 + ǫ)δS,ν ≤ B 1/n } ⊂ {n ≥ n0 : h(γn (P )) ≤ B}
and

{n ≥ n0 : h(γn (P )) ≤ B} ⊂ {n ≥ n0 : (1 − ǫ)δS,ν ≤ B 1/n }.

12

WADE HINDES

Therefore, after counting the number elements in the sets above, we see that
log(B)
− 1 ≤ #{n ≥ 0 : h(γn (P )) ≤ B}
log((1 + ǫ)δS,ν )
and
#{n ≥ 0 : h(γn (P )) ≤ B} ≤

log(B)
+ n0 + 1.
log((1 − ǫ)δS,ν )

Hence, dividing by log(B) and letting B tend to infinity gives
#{n ≥ 0 : h(γn (P )) ≤ B}
1
≤ lim inf
B→∞
log((1 + ǫ)δS,ν )
log(B)
and
lim sup
B→∞

#{n ≥ 0 : h(γn (P )) ≤ B}
1
≤
.
log(B)
log((1 − ǫ)δS,ν )

In particular, since ǫ was arbitrary, we deduce that
#{n ≥ 0 : h(γn (P )) ≤ B}
1
=
B→∞
log(B)
log(δS,ν )
lim

for almost every γ ∈ ΦS as claimed.



Remark 3.1. For rational maps, one can use Theorem 1.8 to give an asymptotic upper bound
on the cardinality of the set {n : h(γn (P )) ≤ B} for initial points P ∈ PN (Q)S .
4. Almost Surely Wandering Points
Let S be a height controlled set of endomorphisms on PN . Given the (nearly) uniform
control over height growth rates that is possible when P is an almost surely wandering
point for S (see Theorem 1.15 and Corollary 1.16 above), it is useful to have an alternative
characterization of this property, which we now establish. To do this, we use the expected
canonical height function Eν̄ [ĥ] : PN → R attached to pairs (S, ν) defined in [4, Theorem
1.2]. As we will see, this height function is a useful tool for analyzing the collective action
of the maps in S on points in PN ; see, for instance, [4, Corollary 1.4].
To define Eν̄ [ĥ], note first that to any (fixed) point Q ∈ PN (Q), we can define a function
ĥQ : ΦS → R given by ĥQ (γ) = ĥγ (Q); see (20) above. In particular, since ΦS is a probability
space, we may view ĥQ as a random variable and ask about its expected (or average) value:
Z
(22)
Eν̄ [ĥ](Q) := E[ĥQ ] =
ĥQ (γ)dν
ΦS

In particular, the expected canonical height function Eν̄ [ĥ] satisfies analogs of the usual
properties of canonical heights (when S = {φ}) due to Call-Silverman; see [4, Theorem 1.2].
For example, the kernel of Eν̄ [ĥ] is exactly the set of points with finite S-orbit, independent
of the choice of ν. To state this result formally, we say that (S, ν) is strictly positive if
ν(φ) > 0 for all φ ∈ S.

DYNAMICAL DEGREES OF RANDOM MAPS

13

Corollary 4.1. Let (S, ν) be a strictly positive, height controlled collection of endomorphisms
on PN . Then for all Q ∈ PN (Q), the following are equivalent:
(1) Q has finite S-orbit.


(2) ν̄ {γ ∈ ΦS : Orbγ (Q) is finite} = 1.
(3) Eν̄ [ĥ](Q) = 0.

Remark 4.2. See [4, Corollary 1.4] for a more general version of this result.
We are now ready to prove our alternative characterization of almost surely wandering
points from the introduction. Namely, P is not almost surely wandering if and only if there
exists some point Q ∈ OrbS (P ) such that Eν̄ [ĥ](Q) = 0; equivalently, by Corollary 4.1, P is
not almost surely wandering if and only if some point in the S-orbit of P has finite S-orbit;
see Example 1.10 above for an illustration of this phenomenon.
(Proof of Theorem 1.18). Suppose that there exists Q ∈ OrbS (P ) such that Eν̄ [ĥQ ] = 0.
Then Q = γm (P ) for some γm ∈ ΦS,m and some m ≥ 0. Now consider the set
U(γm ) = {ρ ∈ ΦS : ρm = γm }.

Then, since (ΦS , ν̄) is the space of i.i.d sequences of elements of S (i.e., we endow ΦS =
with the natural product measure induced by ν), we see that




ν̄ U(γm ) = νm {ρm ∈ ΦS,m : ρm = γm } =

m
Y

ν(θi ),

i=1

Q∞

i=1

S

where γm = θm ◦ θm−1 ◦ · · · ◦ θ1 .

Therefore, ν̄(U(γm )) > 0; here we use that ν is strictly positive. On the other hand, if
γ ∈ U(γm ), then Orbγ (P ) is finite. To see this, note that
Orbγ (P ) = {P, γ1(P ), γ2(P ), . . . , γm−1 (P )} ∪ Orb T m (γ) (Q)
⊆ {P, γ1(P ), γ2(P ), . . . , γm−1 (P )} ∪ OrbS (Q).
But OrbS (Q) is finite, since Eν̄ [ĥQ ] = 0; see Corollary 4.1 above. Therefore,
U(γm ) ⊆ {γ ∈ ΦS : Orbγ (P ) is finite};
hence, the latter set has positive measure. In particular, the point P is not almost surely
wandering for (S, ν) as claimed.
We now show that if Eν̄ [ĥQ ] > 0 for all Q ∈ OrbS (P ), then P is almost surely wandering.
To do this, we need a few elementary lemmas. However, in order to make clean statements
of these auxiliary results, we introduce some additional notation. Let MS be the monoid of
all functions obtained by composing finitely many elements of S (together with the identity
function id on P1 ):
n
o
MS = ρ ∈ K(x) : ρ = id or ρ = (φn ◦ φn−1 ◦ · · · ◦ φ1 ) for φi ∈ S, n ≥ 1 .
In particular, given a initial point P ∈ PN (Q), we may redefine the S-orbit of P to be

(23)
OrbS (P ) := ρ(P ) : for ρ ∈ MS ;
compare to the definition given in the introduction.

14

WADE HINDES

Lemma 4.3 (The Escape Lemma). Let X be a set and let S be any collection of self maps on
X. Suppose that F = {Q1 , Q2 , . . . , Qn } is a finite subset of X with the following properties:
(1) φ(X K F ) ⊆ X K F for all φ ∈ S,

(2) For each Qi ∈ F , there exists fi ∈ MS such that fi (Qi ) 6∈ F .

Then there exists g ∈ MS such that g(Qi ) 6∈ F for all Qi ∈ F .

Remark 4.4. We call a function g as in Lemma 4.3 an escape function for the subset F .
(Proof of Lemma 4.3). Let g1 = f1 , and for m > 1 define
(
gm = gm−1
if gm−1 (Qm ) 6∈ F ,
gm = fjm ◦ gm−1

if gm−1 (Qm ) ∈ F , where gm−1 (Qm ) = Qjm .

Then it is easy to check that g = gn is an escape function for F .



In order to apply the escape lemma above to prove the final direction of Theorem 1.18, we
need a few facts pertaining to heights. To state these facts, let CS := max supφ∈S C(φ), 1 ;
for a definition of C(φ) see (4) above. Note that CS is well defined, since S is finite.
Lemma 4.5. Let K/Q be a finite extension over which every map in S is defined, let
P ∈ PN (K), and let
FP,S := {Q ∈ OrbS (P ) : h(Q) ≤ 2CS }.
Then

φ OrbS (P ) K FP,S ⊆ OrbS (P ) K FP,S ,
for all φ ∈ S. Equivalently, the complement of FP,S in OrbS (P ) is S-stable.

(Proof of Lemma 4.5). If Q ∈ OrbS (P ) K FP,S , then h(Q) > 2CS . On the other hand, since
h(φ(Q)) ≥ dφ h(Q) − CS for all φ ∈ S (by definition of CS ) and dφ ≥ 2 by assumption, we
see that
h(φ(Q)) ≥ 2h(Q) − CS > 3CS > 2CS
for all φ ∈ S. In particular, the complement of FP,S in OrbS (P ) is S-stable as claimed; here
we use also that OrbP (S) is S-stable by the definition in (23) above.

As a final preliminary step, we note the following fact.
Lemma 4.6. If ĥγ (P ) = 0, then Orbγ (P ) ⊆ FP,S .

(Proof of Lemma 4.6). We prove the contrapositive. Write γ = (θi )∞
i=1 for some θi ∈ S and
suppose that Orbγ (P ) 6⊆ FP,S , i.e., there exists an integer m ≥ 0 and Q = γm (P ) such that
h(Q) > 2CS . Now let d = minφ∈S dφ so that d ≥ 2 by assumption. Then an adaptation of
Tate’s telescoping argument implies that for any Q ∈ PN (Q) and any map ρr ∈ MS of length
r, we have that

CS 
≥ deg(ρr )(h(Q) − CS );
h(ρr (Q)) ≥ deg(ρr ) h(Q) −
(d − 1)
see [4, Lemma 2.1]. Here we use that d ≥ 2. In particular, applying the bound above to the
map ρn−m = θn ◦ θn−1 . . . θm+1 and the point Q = γm (P ), we see that
h(γn (P )) ≥ deg(ρn−m )(h(Q) − CS ) ≥ deg(ρn−m )CS .

DYNAMICAL DEGREES OF RANDOM MAPS

15

Therefore, dividing both sides by deg(γn ) we see that
h(γn (P ))
1
≥
CS .
deg(γn )
deg(γm )
In particular, letting n tend to infinity (note that the right-hand-side of the bound above
does not depend on m), we see that ĥγ (P ) > 0 as claimed.

We now return to the proof of Theorem 1.18. Assume that Eν̄ [ĥ](Q) > 0 for all points Q
in the S-orbit of P , and choose a finite extension K/Q such that the initial point P ∈ P1 (K)
and the maps in S are all defined over K. Note that X = OrbS (P ) and F = FP,S (a finite
set by Northcott’s Theorem) satisfy condition (1) of Lemma 4.3 by Lemma 4.5. Moreover,
condition (2) of Lemma 4.3 is also satisfied. For if (2) fails, then there exists Q ∈ FP,S such
that OrbS (Q) ⊆ FP,S ; hence Eν̄ [ĥ](Q) = 0 by [4, Corollary 1.4], contradiction. In particular,
Lemma 4.3 implies that there exists an escape function g = gS,P for F . Now consider the set
n
o
IS,P = (θi )∞
∈
Φ
:
θ
◦
θ
·
·
·
◦
θ
=
g
for
some
n
>
m
;
S
n
n−1
m
i=1

in words, IS,P is the set of sequences where the finite string g appears at some point. In
particular, it follows from the well known “Infinite Monkey Theorem” that ν̄(IS,P ) = 1; in
fact, the (smaller) set of sequences where g appears infinitely often already has full measure
by Kolmogorov zero-one law; see [10, Theorem 10.6].
Finally, we will show that if γ ∈ IS,P then ĥγ (P ) > 0. To see this, write γn = g ◦ γm
for some n > m. If γm (P ) 6∈ FS,P , then Lemma 4.6 implies that ĥγ (P ) > 0. On the other
hand, if γm (P ) ∈ FS,P , then g(γm(P )) 6∈ FP,S by definition of g; see Lemma 4.3. Therefore,
γn (P ) = g(γm(P )) 6∈ FS,P , and ĥγ (P ) > 0 as well. In particular,
(24)

ν̄({γ ∈ ΦS : ĥγ (P ) = 0}) = 0.

However, [5, Theorem 1.1] implies that ĥγ (P ) = 0 if and only if Orbγ (P ) is finite. Therefore,
(24) implies that

ν̄ {γ ∈ ΦS : Orbγ (P ) is finite} = 0.
Hence, P is almost surely wandering for (S, ν) as claimed.

References
[1] G. Call and J. Silverman, Canonical heights on varieties with morphisms, Compositio Mathematica 89.2
(1993): 163-205.
[2] N-B Dang, Degrees of Iterates of Rational Maps on Normal Projective Varieties, preprint at
arXiv:1701.07760.
[3] R. Durrett, Probability theory and examples, Cambridge University Press, 4th edition, 2010.
[4] V. Healey and W. Hindes, Stochastic canonical heights, J. Number Theory, to appear, preprint at
arXiv:1805.10897.
[5] S. Kawaguchi, Canonical heights for random iterations in certain varieties, Int. Math. Res. Not., Article
ID rnm023, 2007.
[6] S. Kawaguchi and Joseph H. Silverman, On the dynamical and arithmetic degrees of rational self-maps
of algebraic varieties, Journal für die reine und angewandte Mathematik (Crelles Journal) 2016.713
(2016): 21-48.
[7] J. F. C. Kingman, Subadditive ergodic theory, Annals of Probability, 1.6 (1973): 883-899.
[8] S. Lalley, Kingman’s subadditive ergodic theorem, lecture notes,
http://galton.uchicago.edu/ lalley/Courses/Graz/Kingman.pdf

16

WADE HINDES

[9] S. Lalley, Birkhoff’s ergodic theorem, lecture notes,
http://galton.uchicago.edu/ lalley/Courses/381/Birkhoff.pdf
[10] J. Jacod and P. Protter, Probability Essentials, second edition. Springer-Verlag, Berlin Heidelberg, 2004.
[11] J. Mello, The dynamical and arithmetic degrees for eigensystems or rational self-maps, preprint at
arXiv:1707.03943.
[12] J. Steele, Kingman’s subadditive ergodic theorem, Ann. Inst. H. Poincaré Probab. Statist. 25.1 (1989):
93-98.
[13] J. Silverman, The Arithmetic of Dynamical Systems, Vol. 241, Springer GTM, 2007.
[14] J. Silverman, Dynamical degree, arithmetic entropy, and canonical heights for dominant rational selfmaps of projective space, Ergodic Theory and Dynamical Systems 34.2 (2012): 647-678.
Department of Mathematics, Texas State University, 601 University Dr., San Marcos,
TX 78666.
E-mail address: wmh33@txstate.edu

