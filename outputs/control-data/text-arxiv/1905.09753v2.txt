An embedded–hybridized discontinuous Galerkin method for the
coupled Stokes–Darcy system
Aycil Cesmelioglua,1 , Sander Rhebergenb,2,, Garth N. Wellsc,3
a Department

of Mathematics and Statistics, Oakland University, Michigan, USA
of Applied Mathematics, University of Waterloo, Canada
c Department of Engineering, University of Cambridge, United Kingdom

arXiv:1905.09753v2 [math.NA] 18 Sep 2019

b Department

Abstract
We introduce an embedded–hybridized discontinuous Galerkin (EDG–HDG) method for the
coupled Stokes–Darcy system. This EDG–HDG method is a pointwise mass-conserving discretization resulting in a divergence-conforming velocity field on the whole domain. In the proposed scheme, coupling between the Stokes and Darcy domains is achieved naturally through the
EDG–HDG facet variables. A priori error analysis shows optimal convergence rates, and that the
velocity error does not depend on the pressure. The error analysis is verified through numerical
examples on unstructured grids for different orders of polynomial approximation.
Keywords: Stokes–Darcy flow, Beavers–Joseph–Saffman, hybridized methods, discontinuous
Galerkin, multiphysics.
2010 MSC: 65N12, 65N15, 65N30, 76D07, 76S99.

1. Introduction
Modelling adjacent free flow and porous media flow is important for a range of applications,
e.g., transport of drugs via blood flow in vessels in biomedical engineering, and transport of
pollutants via surface/groundwater flow in environmental engineering. The problem can be stated
as a system of partial differential equations, with free flow governed by the Stokes equations and
porous media flow governed by Darcy’s equations. The interactions at the boundary between
the free flow and porous media flow regions were specified by [1, 2], and were mathematically
justified in [3]. We refer to [4] for an overview of the model.
Well-posedness of the weak formulation of the Stokes–Darcy problem can be found in [5]
for the primal form, and in [6] for the primal–mixed form. Many different finite element and
mixed finite element methods have been proposed to discretize the Stokes–Darcy problem for
both formulations, e.g. [5, 6, 7, 8, 9, 10, 11]. Other devised finite element methods include discontinuous Galerkin (DG) methods [12, 13, 14, 15, 16, 17], hybridizable discontinuous Galerkin

Email addresses: cesmelio@oakland.edu (Aycil Cesmelioglu), srheberg@uwaterloo.ca (Sander
Rhebergen), gnw20@cam.ac.uk (Garth N. Wells)
1 https://orcid.org/0000-0001-8057-6349
2 https://orcid.org/0000-0001-6036-0356
3 https://orcid.org/0000-0001-5291-7951
Preprint submitted to Journal of Computational and Applied Mathematics

September 19, 2019

(HDG) methods [18, 19, 20, 21], weak Galerkin methods (WG) [22], and weak virtual element
methods (WVEM) [23].
We develop a numerical scheme for which the velocity field is divergence-conforming on the
whole domain and for which mass is conserved pointwise. Finite element methods that satisfy
these properties were proposed in [14, 24] where they are referred to as ‘strongly conservative’.
For the Stokes region [14, 24] used a divergence-conforming DG space for the velocity and
a standard DG space for the pressure. In the Darcy region they used a mixed finite element
method. It is well-known, however, that DG methods can be expensive due to the large number
of degrees-of-freedom on a given mesh compared to other methods. To reduce the number of
globally coupled degrees-of-freedom, [19] proposed an HDG method for the Stokes region using a divergence-conforming finite element space for the velocity. Their method results in less
globally coupled degrees-of-freedom compared to standard HDG methods as they only enforce
continuity of the tangential direction of the facet velocity. Additionally, to reduce the problem
size even further, they applied the ‘projected jumps’ method in which the polynomial degree of
the tangential facet velocity is reduced by one compared to the cell velocity approximation (see
also [25]).
In this paper we propose an embedded–hybridized discontinuous Galerkin (EDG–HDG) finite element method of the primal–mixed formulation of the Stokes–Darcy problem on the whole
domain. The EDG–HDG method uses a continuous trace velocity approximation and a discontinuous trace pressure approximation. Due to the continuous trace velocity approximation, the
number of globally coupled degrees-of-freedom of the EDG–HDG method is fewer than for a
traditional HDG method. However, the main motivation for an EDG–HDG discretization is not
that the problem size is smaller, but that ‘continuous’ discretizations are generally better suited to
fast iterative solvers. This was demonstrated for the Stokes problem in [26], where CPU time and
iteration count to convergence was reduced significantly compared to a hybridized method using
only discontinuous facet approximations. We will show that the EDG–HDG method proposed
in this paper is pointwise mass-conserving and that the resulting velocity field is divergenceconforming. We present furthermore an analysis of the proposed EDG–HDG method for the
Stokes–Darcy problem, proving well-posedness, and optimal a priori error estimates.
The remainder of this paper is organized as follows. In section 2 we briefly introduce the
coupled Stokes–Darcy problem. The EDG–HDG method to this problem is presented in section 3. Consistency, continuity and well-posedness are shown in section 4 while the main results
of this paper, an a priori error analysis, is presented in section 5. Numerical simulations support
our theoretical results in section 6, and conclusions are drawn in section 7.
2. The Stokes–Darcy system
Let Ω ⊂ Rdim be a bounded polygonal domain with dim = 2, 3, boundary ∂Ω and boundary
outward unit normal n. We assume that Ω is divided into two non-overlapping regions, Ω s and
Ωd , such that Ω = Ω s ∪ Ωd and Ω s and Ωd are a union of polygonal subdomains. We denote the
polygonal interface between Ω s and Ωd by ΓI . Furthermore, we define the external boundary of
Ω s by Γ s := ∂Ω ∩ ∂Ω s , and the external boundary of Ωd by Γd := ∂Ω ∩ ∂Ωd . See fig. 1.
Given the kinematic viscosity µ ∈ R+ , forcing term f s : Ω s → Rdim , permeability constant
κ ∈ R+ and the source/sink term f d : Ωd → R, the Stokes–Darcy system for the velocity field

2

Figure 1: A depiction of the Stokes–Darcy region.

u : Ω → Rdim and pressure p : Ω → R is given by
−∇ · 2µε(u) + ∇p = f s
κ u + ∇p = 0
−1

in Ω s ,

(1a)

in Ω ,

(1b)

d

−∇ · u = χd f d

in Ω,

(1c)

u=0

on Γ s ,

(1d)

u·n=0

on Γd ,

(1e)



where ε(u) := ∇u + (∇u)T /2 is the strain rate tensor and χd is the characteristic function that
has the value 1 in Ωd and 0 in Ω s . We will also frequently denote the velocity and pressure in Ω j
by u j and p j , respectively, for j = s, d.
Let n denote the unit normal vector on the interface between the two domains, ΓI , pointing
outwards from Ω s . On the interface ΓI we prescribe
u s · n = ud · n
p − 2µε(u )n · n = p

−2µ ε(u s )n t = ακ−1/2 (u s )t
s

s

d

on ΓI ,

(2a)

on Γ ,

(2b)

on Γ ,

(2c)

I

I

where the tangential component of a vector w is denoted by (w)t := w − (w · n)n. Equation (2c) is
the Beavers–Joseph–Saffman law [1, 2], where α > 0 is an experimentally determined parameter.
3. The embedded–hybridized discontinuous Galerkin method
We present now an embedded–hybridized discontinuous Galerkin (EDG–HDG) method for
the Stokes–Darcy system eqs. (1) and (2), and establish some of its key properties.
3.1. Preliminaries
For j = s, d, let T j := {K} be a triangulation of Ω j into non-overlapping cells K. For brevity,
we consider the case of matching meshes at the interface ΓI . Furthermore, let T := T s ∪ T d .
3

The diameter of a cell K is denoted by hK and h denotes the maximum diameter over all cells.
The outward unit normal vector on the boundary of a cell, ∂K, is denoted by n. An interior facet
F is shared by adjacent cells, K + and K − , while a boundary facet is part of ∂K that lies on ∂Ω.
The set and union of all facets are denoted by F := {F} and Γ0 , respectively. By F I we denote
j
the set of all facets that lie on ΓI . For j = s, d, we denote by F j the set of all facets that lie in Ω .
j
Finally, for j = s, d, we denote the union of all facets in Ω by Γ0j .
We consider the following discontinuous Galerkin finite element function spaces on Ω,
n
o
dim
Vh := vh ∈ [L2 (Ω)] : vh ∈ [Pk (K)]dim ∀ K ∈ T ,
n
o
(3)
Qh := qh ∈ L2 (Ω) : qh ∈ Pk−1 (K) ∀ K ∈ T ∩ L02 (Ω),
n
o
j
Qh := qh ∈ L2 (Ω j ) : qh ∈ Pk−1 (K) ∀ K ∈ T j , j = s, d,
where PRk (D) denotes the space of polynomials of degree k on domain D and L02 (Ω) := {q ∈
L2 (Ω) : Ω q dx = 0}. On Γ0s and Γd0 , we consider the finite element spaces:
n
o h
idim
dim
V̄h := v̄h ∈ [L2 (Γ0s )] : v̄h ∈ [Pk (F)]dim ∀ F ∈ F s , v̄h = 0 on Γ s ∩ C 0 (Γ0s )
,
n j
o
j
j
2 j
j
Q̄h := q̄h ∈ L (Γ0 ) : q̄h ∈ Pk (F) ∀ F ∈ F , j = s, d.

(4)

Note that q̄hs ∈ Q̄hs and q̄dh ∈ Q̄dh do not necessarily coincide on the interface ΓI . Note also that
functions in V̄h are continuous on Γ0s , while functions in Q̄hj are discontinuous on Γ0j , for j = s, d.
For notational purposes, we introduce the spaces V h := Vh × V̄h , Qh := Qh × Q̄hs × Q̄dh and
j
Qh := Qhj × Q̄hj for j = s, d. Function pairs in V h , Qh and Qhj , for j = s, d, will be denoted
by vh := (vh , v̄h ) ∈ V h , qh := (qh , q̄hs , q̄dh ) ∈ Qh and qhj := (qh , q̄hj ) ∈ Qhj . Furthermore, we set
Xh := V h × Qh .
3.2. Method
The discrete form for the Stokes–Darcy system in eqs. (1) and (2) reads: given the forcing
dim
term f s ∈ [L2 (Ω s )] , the source/sink term f d ∈ L2 (Ωd ), the kinematic viscosity µ ∈ R+ and the
permeability κ ∈ R+ , find (uh , ph ) ∈ Xh such that
Z
Z
s
Bh ((uh , ph ), (vh , qh )) =
f · vh dx +
f d qh dx ∀(vh , qh ) ∈ Xh ,
(5)
Ωs

Ωd

where
Bh ((uh , ph ), (vh , qh )) := ah (uh , vh ) +

X

bhj ( phj , vh ) + bhI, j ( p̄hj , v̄h )
j=s,d

+

X

bhj (qhj , uh ) + bhI, j (q̄hj , ūh ) . (6)
j=s,d

The bilinear form ah (·, ·) is defined as
ah (uh , vh ) := ahs (uh , vh ) + adh (uh , vh ) + ahI (ūh , v̄h ),
4

(7)

where
ahs (u, v) :=

XZ
K

K∈T s

−

XZ
K∈T s

Z
adh (u, v) :=

Ωd

Z
ahI (ū, v̄) :=

ΓI

∂K

XZ

2βµ
(u − ū) · (v − v̄) ds
hK
K∈T s ∂K
XZ
2µε(u)n s · (v − v̄) ds −
2µε(v)n s · (u − ū) ds,

2µε(u) : ε(v) dx +

K∈T s

(8a)

∂K

κ−1 u · v dx,

(8b)

ακ−1/2 ūt · v̄t ds,

(8c)

and where β > 0 is a penalty parameter. The bilinear forms bhj (·, ·) and bhI, j (·, ·) are defined as:
XZ
XZ
bhj ( p j , v) := −
p∇ · v dx +
p̄ j v · n j ds,
(9a)
K∈T j

bhI, j ( p̄ j , v̄) := −

K

K∈T j

∂K

Z
ΓI

p̄ j v̄ · n j ds.

(9b)

3.3. Properties of the numerical scheme
Setting v̄h = 0 and qh = 0 in eq. (5) demonstrates cell-wise momentum balance eq. (1a)
subject to weak satisfaction of the boundary condition provided by ūh , and a cell-wise statement
of Darcy’s law eq. (1b) subject to weak satisfaction of the boundary condition provided by p̄dh
and a Neumann boundary condition on ΓI . Setting vh = 0 and qh = 0 in eq. (5) shows that
the formulation imposes normal continuity weakly across facets of the ‘numerical’ Stokes stress
tensor:
2βµ s
(10)
(u − ūhs ) ⊗ n,
σ̂hs := 2µε(uhs ) − p̄hs I −
hK h
where I is the identity tensor. Setting vh = 0 and q̄hs = q̄dh = 0 in eq. (5) and noting that
∇ · uh ∈ Pk−1 (K), the numerical scheme imposes pointwise mass conservation, i.e.,
− ∇ · uh = χd ΠQ f d

∀x ∈ K, ∀K ∈ T ,

(11)

where ΠQ is the standard L2 -projection operator onto Qh . Finally, setting vh = 0, qh = 0 and
q̄lh = 0 with l , j in eq. (5) and noting that Juh · nK, uh · n, (uh − ūh ) · n ∈ Pk (F) on each F ∈ F ,
we find that uh is H(div)-conforming, i.e.,
Juh · nK = 0

uh · n = ūh · n

∀x ∈ F, ∀F ∈ F \F I ,

(12a)

∀x ∈ F, ∀F ∈ F ,

(12b)

I

where J·K is the usual jump operator and n the unit normal vector on F.

5

4. Consistency, continuity and well-posedness for Stokes–Darcy
4.1. Preliminaries
To prove consistency, continuity and stability we require extended function spaces and appropriate norms. We introduce
n
o
dim
dim
V := v : v s ∈ [H 2 (Ω s )] , vd ∈ [H 1 (Ωd )] , v = 0 on Γ s , v · n = 0 on Γd , v s · n = vd · n on ΓI ,
n
o
Q := q ∈ L02 (Ω) : q s ∈ H 1 (Ω s ), qd ∈ H 2 (Ωd ) ,
(13)
and X := V × Q. We let V̄ be the trace space of V restricted to Γ0s and Q̄ be the trace space
of Q restricted to Γ0 . We introduce the trace operator γV : V → V̄ to restrict functions in V
to Γ0s , and the trace operators γQ j : Q j → Q̄ j to restrict functions in Q j to Γ0j . We remark that
γQs (p s ) , γQd (pd ) on the interface ΓI . Where no ambiguity arises we omit the subscript when
using the trace operator. For notational purposes we also introduce V := V × V̄, Q := Q × Q̄ and
V(h) := V h + V,

Q(h) := Qh + Q,

X(h) := V(h) × Q(h).

(14)

For j = s, d we denote by V j (h) and Q j (h) the restriction of, respectively, V(h) and Q(h) to Ω j .
We use various norms throughout, which are defined now. On V s (h) we define
X

2
|||v|||2v,s :=
k∇vk2K + h−1
K kv − v̄k∂K ,
K∈T s

wherek·kD denotes the standard L2 -norm on domain D, and
X
h2K |v|2H 2 (K) .
|||v|||2v0 ,s := |||v|||2v,s +
K∈T s

On V(h) we introduce

2
|||v|||2v := |||v|||2v,s +kvk2Ωd + kv̄t kΓI ,

and
|||v|||2v0 := |||v|||2v +

X

2

h2K |v|2H 2 (K) = |||v|||2v0 ,s +kvk2Ωd + kv̄t kΓI .

K∈T s

Note that the norms |||·|||v and |||·|||v0 are equivalent on V h , see [27, eq. (5.5)].
Finally, for q j ∈ Q j (h) with j = s, d and q ∈ Q(h), we define
X
X
2
2
|||q|||2p :=
|||q j |||2p, j .
|||q j |||2p, j := q Ω j +
hK kq̄ j k∂K ,
K∈T j

j=s,d

We will make use of various standard estimates. In particular, use will be made of the trace
inequalities for K ∈ T , [28, Lemma 1.46, Remark 1.47]
kvk∂K ≤ CT,1 h−1/2
K kvkK

∀v ∈ Pk (K),

(15)

and the following straightforward extensions of the continuous trace inequality [29, Theorem 1.6.6]


2
2
∀v ∈ H 1 (K),
(16)
kvk2∂K ≤ CT,2 h−1
K kvkK + hK kvk1,K
and
kvkΓI ≤ Cc,T k∇vkΩs

n
o
∀v ∈ v ∈ H 1 (Ω s ) : v = 0 on Γ s ,

where CT,1 , CT,2 , Cc,T > 0 are independent of hK .
6

(17)

4.2. Consistency
We now prove that the scheme in eq. (5) is consistent with the Stokes–Darcy system in
eqs. (1) and (2).
Lemma 1 (Consistency). If (u, p) ∈ X solves the Stokes–Darcy system eqs. (1) and (2), then
letting u = (u, γ(u)) and p = (p, γ(p s ), γ(pd )),
Z
Z
s
Bh ((u, p), (v, q)) =
f · v dx +
f d q dx ∀(v, q) ∈ X(h).
(18)
Ωs

Ωd

Proof. We consider each form in the definition of Bh separately. Since u = γ(u) on cell bounds
aries in Ω , and integration by parts,
XZ
XZ
s
ah (u, v) =
2µε(u) : ε(v) dx −
2µε(u)n s · (v − v̄) ds
K∈T s

=−

K

2µ(∇ · ε(u)) · v dx +
K

K∈T s

∂K

K∈T s

XZ

(19)

XZ
∂K

K∈T s

2µε(u)n s · v̄ ds.

Using smoothness of u, single-valuedness of v̄, and eq. (2c), we note that
Z
XZ
2µε(u)n s · v̄ ds =
2µε(u)n s · v̄ ds
K∈T s

∂K

ΓI

=−

Z
ΓI

ακ−1/2 (u s )t · v̄t ds +

Z 
ΓI

(20)
 
2µ n s · ε(u)n s n s · v̄ ds.

Combining with eq. (19),
Z
XZ
s
ah (u, v) = −
2µ(∇ · ε(u)) · v dx −
ακ−1/2 (u s )t · v̄t ds
K∈T s

ΓI

K

+

Z 
 
2µ n s · ε(u)n s n s · v̄ ds. (21)
ΓI

j

Applying integration by parts, noting that γ(p j ) = p j on cell boundaries in Ω , with j = s, d, and
nd = −n s on ΓI , results in
X
X Z
 XZ
j
I, j
j
j
bh ( p , v) + bh (γ(p ), v̄) =
∇p · v dx +
∇p · v dx
K∈T s

j=s,d

K

K∈T d

K

+
Next,
X

XZ
XZ

bhj (q j , u) + bhI, j (q̄ j , γ(u s )) = −
q∇ · u dx +
K∈T s

j=s,d

−

X Z
K∈T d

=

K

K∈T s

q∇ · u dx +
K

ΓI

(pd − p s )v̄ · n s ds.

(22)

Z

∂K

X Z
K∈T d

Z

∂K

q̄ s u · n s ds −

ΓI

q̄ s u s · n s ds

Z
d

d

q̄ u · n ds −

ΓI

q̄d ud · nd ds

Z
Ωd

q f d dx,
(23)
7

where for the second equality we used eq. (1c)-eq. (1e), and that q̄ s , q̄d , u s · n s and ud · nd are
single-valued on interior facets. Furthermore, note that
Z
Z
ahI (γ(u s ), v̄) =
ακ−1/2 v̄t · (u s )t ds and adh (u, v) =
κ−1 u · v dx,
(24)
ΓI

Ωd

hence summing eqs. (21) to (24) results in
Bh ((u, p), (v, q)) =

XZ
K∈T s

X Z 


−2µ(∇ · ε(u)) + ∇p · v dx +
κ−1 u + ∇p · v dx
K

K∈T d

K

Z 
Z
Z

d
s s
s
s s
+
(p − p )n · v̄ ds +
2µ n · ε(u)n n · v̄ ds +
ΓI

ΓI

The result follows after using eqs. (1a), (1b) and (2b).

Ωd

q f d dx.

(25)


4.3. Coercivity and continuity of ahs (·, ·) and ah (·, ·)
In this section we show that ah (·, ·) is coercive on V h for sufficiently large penalty parameter
β. We furthermore prove continuity of ahs (·, ·) and ah (·, ·).
Lemma 2 (Coercivity). There exists a constant C > 0, independent of h, and a constant β0 > 0
such that for β > β0 and for all vh ∈ V h ,
ah (vh , vh ) ≥ C|||vh |||2v .

(26)

Proof. Using identical steps as in [30, Lemma 4.2] and applying Korn’s inequality [31] it can be
shown that
X

2
2
kε(vh )k2K + h−1
(27)
ahs (vh , vh ) ≥ C
K kvh − v̄h k∂K ≥ C|||vh |||v,s ,
K∈T s



The result follows by definition of ah .

Lemma 3 (Continuity). There exists a generic constant C > 0, independent of h, such that for
all u, v ∈ V(h),
ahs (u, v) ≤ C|||u|||v0 ,s |||v|||v0 ,s ,

(28a)

ah (u, v) ≤ C|||u|||v0 |||v|||v0 .

(28b)

Proof. Equation (28a) follows by definition of ahs eq. (8a), the Cauchy-Schwarz inequality, the
trace inequality eq. (16), Hölder’s inequality for sums and since |ε(u)|H ` (K) ≤ C|u|H `+1 (K) , ` =
0, 1. Equation (28b) follows by definition of ah eq. (7), using the Cauchy–Schwarz inequality,
eq. (28a) and Hölder’s inequality for sums.


8

4.4. The inf-sup condition
To present the inf-sup condition it will be convenient to split the velocity-pressure coupling
term bhj (qhj , vh ) in eq. (9a) as follows
bhj (qhj , vh ) = bhj,1 (qh , vh ) + bhj,2 (q̄hj , vh ),

(29)

where
bhj,1 (qh , vh ) = −

XZ
K∈T j

qh ∇ · vh dx
K

and bhj,2 (q̄hj , vh ) =

XZ
K∈T j

∂K

q̄hj vh · n j ds,

for j = s, d.
The main result of this section is the following theorem.
Theorem 1 (inf-sup condition). There exists a constant c?inf > 0, independent of h, such that for
any qh ∈ Qh ,
 j j

P
I, j j
j=s,d bh (qh , vh ) + bh (q̄h , v̄h )
?
.
(30)
cinf |||qh ||| p ≤ sup
|||vh |||v
vh ∈V h
vh ,0

To prove this result we require the definition of two interpolation operators. For the velocity we
require the following BDM interpolation operator [32, Lemma 7].
Lemma 4 (BDM interpolation operator). If the mesh consists of triangles (dim = 2) or tetradim
hedra (dim = 3) there is an interpolation operator ΠV : [H 1 (Ω j )]
→ Vhj , where Vhj is the
dim
space of functions in Vh restricted to cells in T j , such that for all u ∈ [H k+1 (K)] ,
Z
i.
q(∇ · (u − ΠV u)) dx = 0 for all q ∈ Pk−1 (K).
K

Z

q̄(u − ΠV u) · n ds = 0 for all q̄ ∈ Pk (F), where F is an edge (dim = 2) or face (dim = 3)

ii.
F

of ∂K.
iii. Jn · ΠV uK = 0, where J·K is the usual jump operator.

iv. ku − ΠV ukm,K ≤ Ch`−m
K kukH ` (K) with m = 0, 1, 2 and m ≤ ` ≤ k + 1.
dim

dim

We also require an interpolation operator Π̄V : [H 1 (Ω)]
→ Vh ∩ [C 0 (Ω̄)] , for example
dim
the Scott–Zhang interpolant [29, Theorem 4.8.12], with the property that for v ∈ [H ` (K)] ,
1 ≤ ` ≤ k + 1,
kv − Π̄V vk∂K ≤ Ch`−1/2
kvkH ` (K) ,
K
kΠV v − Π̄V vk∂K ≤

Ch`−1/2
K

kvkH ` (K) ,

(31a)
(31b)

where C is a generic constant independent of h.
Additionally, we require the following two auxiliary results.
Lemma 5. There exists a constant cinf > 0, independent of h, such that for any qh ∈ Qh ,
P
j,1
j=s,d bh (qh , vh )
.
cinf kqh kΩ ≤ sup
|||vh |||v
vh ∈V h
vh ,0

9

(32)

Proof. Let qh ∈ Qh . It is well known, e.g., [28, Theorem 6.5], that since qh ∈ L02 (Ω) there exists
a v ∈ [H01 (Ω)]dim such that
− ∇ · v = qh

and

cinf kvkH 1 (Ω) ≤ kqh kΩ .

Then, by lemma 4 (i.), since qh ∈ Pk−1 (K) for all K ∈ T ,
Z
Z
kqh k2Ω = −
qh ∇ · v dx = −
qh ∇ · ΠV v dx.
Ω

Ω

(33)

(34)

By lemma 4 (iv.) and eq. (31b),
X
X

2
|||(ΠV v, Π̄V v)|||2v,s =
k∇(ΠV v)k2K + h−1
kvk2H 1 (K) = C kvk2H 1 (Ωs ) .
K kΠV v − Π̄V vk∂K ≤ C
K∈T s

K∈T s

(35)
1

d

dim

On the other hand, since v ∈ [H (Ω )]

such that v = 0 on Γ , using lemma 4 (iv.),
d

kΠV vkΩd ≤ kΠV v − vkΩd +kvkΩd ≤ C kvkH 1 (Ωd ) .

(36)

Next, by eqs. (17) and (31a),


2
2
2
k(Π̄V v)t kΓI ≤ kΠ̄V vkΓI ≤ 2 kΠ̄V v − vkΓI +kvk2ΓI

X

X
2
ChK kvk2H 1 (K) +kvk2ΓI ≤ Ckvk2H 1 (Ωs ) . (37)
≤2
kΠ̄V v − vk∂K + 2kvk2ΓI ≤
K∈T s

K∈T s

Combining eqs. (35) to (37), we obtain
|||(ΠV v, Π̄V v)|||v ≤ C kvkH 1 (Ω) .
Therefore, by eqs. (34) and (38),
R
R
− Ω qh ∇ · vh dx − Ω qh ∇ · ΠV v dx
kqh k2Ω
cinf
≥
≥
≥
kqh kΩ ,
sup
1
|||v
|||
C
kvk
C
|||(Π
v,
Π̄
v)|||
h
vh ∈V h
v
H (Ω)
V
V
v

(38)

(39)

vh ,0



where we used eq. (33) for the last inequality.

To prove the next auxiliary result, we introduce an operator to lift q̄hs ∈ Q̄hs and q̄dh ∈ Q̄dh to Ω s
and Ωd , respectively. Let Rk (∂K) := {q̄ ∈ L2 (∂K), q̄ ∈ Pk (F), ∀F ∈ ∂K} and let L : Rk (∂K) →
[Pk (K)]dim be the BDM local lifting operator which satisfies for all q̄h ∈ Rk (∂K) the following:
(Lq̄h ) · n = q̄h

kLq̄h kK ≤ Ch1/2
K kq̄h k∂K .

and

(40)

Furthermore, it holds that
2
k∇(Lq̄h )k2K ≤ Ch−1
K kq̄h k∂K

and

kLq̄h k2∂K ≤ C kq̄h k2∂K .

(41)

See [33, Example 2.5.1].
Lemma 6. There exists a constant c̄inf > 0, independent of h, such that for any (q̄hs , q̄dh ) ∈ Q̄hs × Q̄dh ,
 j,2 j

P
I, j j

1/2
X X
j=s,d bh (q̄h , vh ) + bh (q̄h , v̄h )
j 2
c̄inf
hK kq̄h k∂K
≤ sup
.
(42)
|||vh |||v
vh ∈V h
j
j=s,d
K∈T

vh ,0

10

Proof. Let q̄hj ∈ Q̄hj and set whj := Lq̄hj for j = s, d. Since whj ∈ [Pk (K)]dim for all K ∈ T j ,
j = s, d, then wh = whs + wdh ∈ [Pk (K)]dim for all K ∈ T . Furthermore, by eq. (41),
|||(wh , 0)|||2v,s =

X


X
s 2
s 2
k∇(Lq̄hs )k2K + h−1
kL
q̄
k
h−1
K
K kq̄h k∂K .
h ∂K ≤ C

K∈T s

(43)

K∈T s

Next, using eq. (40),
2

X

kwh k2Ωd = kwdh kΩd =

2

kLq̄dh kK ≤ C

X

2

hK kq̄dh k∂K ≤ C

2

d
h−1
K kq̄h k∂K ,

(44)

K∈T d

K∈T d

K∈T d

X

where we used hK < 1 < h−1
K . Then, combining eqs. (43) and (44),

X X
j 2
|||(wh , 0)|||2v ≤ C
h−1
K kq̄h k∂K .

(45)

j=s,d K∈T j

Noting that whj · n = q̄hj , j = s, d we find
P
sup

 j,2 j

I, j j
j=s,d bh (q̄h , vh ) + bh (q̄h , v̄h )
|||vh |||v

vh ∈V h
vh ,0

P
≥

j=s,d

P

2

K∈T j

kq̄hj k∂K



|||(wh , 0)|||v
P

j=s,d

P

2

K∈T

j

kq̄hj k∂K



≥
P
1/2
P
j 2
C j=s,d K∈T j h−1
k
q̄
k
K
h ∂K
X X


2 1/2
min
hK kq̄hj k∂K
.
≥ C hhmax
j=s,d K∈T j

The result follows with c̄inf = C



hmin
hmax


.



Using lemma 5 and lemma 6, the proof to theorem 1 then follows the steps as [34, Lemma 1]
and is therefore omitted.
An immediate consequence of lemma 2 and theorem 1 is existence and uniqueness of a
solution to eq. (5), as shown by the following proposition.
Proposition 1 (Existence and uniqueness). If β > β0 , there exists a unique solution (uh , ph ) ∈
Xh to eq. (5).
Proof. Since eq. (5) is linear, it is sufficient to show uniqueness. Let f s = f d = 0. Let us take
vh = uh and qh = − ph in eq. (5). Then ah (uh , uh ) = 0 which, together with the coercivity result
eq. (26), implies that |||uh |||v = 0, that is, uh = 0. Inserting this into eq. (5) with f s = f d = 0, we
find
X

bhj ( phj , vh ) + bhI, j ( p̄hj , v̄h ) = 0 ∀vh ∈ V h .
(46)
j=s,d

By the inf-sup condition in theorem 1 this implies that ph = 0.
11



5. Error analysis of the Stokes–Darcy system
In this section we present a priori error analysis of the method in eq. (5). For this we require
the standard L2 -projection operators onto Qh and Q̄hj , j = s, d which we denote, respectively, by
ΠQ and Π̄Qj . It can be shown, e.g. [28], that for k ≥ 0 and 0 ≤ ` ≤ k,
kq − ΠQ qkK ≤ Ch`K kqkH ` (K)
kq −

Π̄Qj qk∂K

≤

Ch`+1/2
K

∀q ∈ H ` (K),

kqkH `+1 (K)

∀q ∈ H

`+1

(47a)

(K),

(47b)

where C is a generic constant independent of h.
It will be convenient to split the error into approximation and interpolation errors:
u − uh = ξu − ζu ,

γ(u) − ūh = ξ̄u − ζ̄u ,

p − ph =ξ p − ζ p ,

γ(p j ) − p̄hj = ξ̄ pj − ζ̄ pj ,

ξu := u − ΠV u,

ζu := uh − ΠV u,

ξ̄u := γ(u s ) − Π̄V u s ,

ζ̄u := ūh − Π̄V u s ,

ξ p :=p − ΠQ p,

ζ p :=ph − ΠQ p,

ξ̄ pj :=γ(p j ) − Π̄Qj p j ,

ζ̄ pj := p̄hj − Π̄Qj p j ,

j = s, d,

where

j = s, d.

To be consistent with our notation, we use ξu := (ξu , ξ̄u ), ξ p := (ξ p , ξ̄ ps , ξ̄dp ) and ξ pj := (ξ p , ξ̄ pj ),
j = s, d. Expressions ζ u , ζ p and ζ pj are defined similarly. We first present three results that will
be useful in following sections.
Lemma 7 (|||·|||v,s and |||·|||v -norm interpolation error estimates). Suppose that u is such that u s ∈
dim
dim
[H ` (Ω s )] , and ud ∈ [H `−1 (Ωd )] , 2 ≤ ` ≤ k + 1. Then
|||ξu |||v0 ,s ≤ Ch`−1 kukH ` (Ωs ) ,


|||ξu |||v0 ≤ Ch`−1 kukH ` (Ωs ) + kukH `−1 (Ωd ) .

(48a)
(48b)

Proof. Recall that
|||ξu |||2v0 ,s =

X

 X
2
k∇ξu k2K + h−1
kξ
−
ξ̄
k
h2K |ξu |22,K .
u
u
∂K +
K

K∈T s

(49)

K∈T s

Then, since ΠV u ∈ [Pk (F)]dim for any F ∈ F s we find by eq. (31b)
2

2

kξu − ξ̄u k∂K = kΠV u − Π̄V uk∂K ≤ Ch2`−1
kuk2H ` (K) ,
K

(50)

Equation (48a) follows by combining eq. (49) and eq. (50) and using once again lemma 4 (iv.).
Equation (48b) follows from this and lemma 4 (iv.).

Lemma 8 (|||·||| p, j -norm interpolation error). For j = s, d, let p j ∈ H ` (Ω j ), 0 ≤ ` ≤ k. Then
|||ξ pj ||| p, j ≤ Ch` kpkH ` (Ω j ) .

12

Proof. By definition of |||·||| p, j and the properties of the L2 -projections ΠQ and Π̄Qj given in
eq. (47),
X
2
|||ξ pj |||2p, j = kξ p k2Ω j +
hK kξ̄ pj k∂K ≤ Ch2` kpk2H ` (Ω j ) .
K∈T j


Lemma 9 (Error equation). There holds
Bh ((ζ u , ζ p ), (vh , qh )) = Bh ((ξu , ξ p ), (vh , qh )) ∀(vh , qh ) ∈ Xh .

(51)

Proof. Subtracting eq. (5) from the consistency equation in lemma 1 we obtain
Bh ((u − uh , γ(u s ) − ūh , p − ph , γ(p s ) − p̄hs , γ(pd ) − p̄dh ), (vh , qh )) = 0,
for all (vh , qh ) ∈ Xh . The result follows simply by splitting the errors.

(52)


5.1. Energy-norm error estimates
In this section we determine error estimates for the velocity and pressure in the energy-norm.
Theorem 2 (Energy-norm error estimates). Let (u, p) ∈ X be the solution of the Stokes–Darcy
dim
dim
system eqs. (1) and (2) such that u s ∈ [H k+1 (Ω s )] and ud ∈ [H k (Ωd )] for k ≥ 1 and let
(uh , ph ) ∈ Xh solve eq. (5). Then


|||u − uh |||v ≤ Chk kukH k+1 (Ωs ) +kukH k (Ωd ) .
(53a)
In addition, if p ∈ H k (Ω j ), j = s, d, then


||| p − ph ||| p ≤ Chk kukH k+1 (Ωs ) +kukH k (Ωd ) + kpkH k (Ωs ) + kpkH k (Ωd ) .

(53b)

Proof. We will first prove


|||ζ u |||2v ≤ c1 |||ζ u |||v + |||ζ p ||| p |||ξu |||v0 ,

(54)

where c1 > 0 is a constant independent of h. Setting (vh , qh ) = (ζ u , −ζ p ) in lemma 9, and using
coercivity of ah eq. (26),
Bh ((ξu , ξ p ), (ζ u , −ζ p )) = Bh ((ζ u , ζ p ), (ζ u , −ζ p )) = ah (ζ u , ζ u ) ≥ C|||ζ u |||2v .

(55)

We proceed by bounding
Bh ((ξu , ξ p ), (ζ u , −ζ p )) =ah (ξu , ζ u ) +

X
 X j j

bhj (ξ pj , ζu ) + bhI, j (ξ̄ pj , ζ̄u ) −
bh (ζ p , ξu ) + bhI, j (ζ̄ pj , ξ̄u )
j=s,d

j=s,d

=I1 + I2 + I3 .
(56)
Observe first that I2 disappears by the properties of ΠQ , Π̄Qj and lemma 4 (i.)-(ii.). Consider now
I1 . By lemma 3 and equivalence of the norms |||·|||v and |||·|||v0 on V h
I1 = ah (ξu , ζ u ) ≤ C|||ζ u |||v |||ξu |||v0 .
13

(57)

We next consider I3 and note that by lemma 4 (i.) and (ii.)
I3 = −bhs (ζ sp , ξu ) − bhI,s (ζ̄ ps , ξ̄u ) − bdh (ζ dp , ξu ) − bhI,d (ζ̄ pd , ξ̄u )
Z
Z
( p̄dh − Π̄dQ pd )(u s − Π̄V u s ) · n s ds.
=−
( p̄hs − Π̄Qs p s )(u s − Π̄V u s ) · n s ds −
ΓI

ΓI

Since ( p̄hj − Π̄Qj p j ) ∈ Pk (F) for j = s, d, we have by lemma 4 (ii.) that
Z
Z
( p̄dh − Π̄dQ pd )(ΠV u s − Π̄V u s ) · n s ds
I3 = −
( p̄hs − Π̄Qs p s )(ΠV u s − Π̄V u s ) · n s ds −
ΓI
ΓI
Z
Z
s
s
=−
ζ̄ p (ξ̄u − ξu ) · n ds −
ζ̄ pd (ξ̄u − ξu ) · nd ds
ΓI

ΓI

1/2

1/2


 X

 X
2 
2



d
s
hk kζ̄ p k∂K  |||ξu |||v,s
hk kζ̄ p k∂K  |||ξu |||v,s + 
≤ 
K∈T s
K∈T d


s
d
≤ C |||ζ p ||| p,s + |||ζ p ||| p,d |||ξu |||v,s ≤ C|||ζ p ||| p |||ξu |||v0 .
Equation (54) follows by combining eqs. (55) and (58).
We next prove that


|||ζ p |||2p ≤ c2 |||ζ u |||2v + |||ξu |||2v0 ,

(58)

(59)

where c2 > 0 is a constant independent of h. Setting qh = 0 in the error equation lemma 9,
using the projection properties of ΠQ and Π̄Q , applying eq. (28b) and using the equivalence of
the norms |||·|||v and |||·|||v0 on V h ,
X

bhj (ζ pj , vh ) + bhI, j (ζ̄ pj , vh ) = −ah (ζ u , vh ) + ah (ξu , vh ) ≤ C|||ζ u |||v |||vh |||v + C|||ξu |||v0 |||vh |||v .
j=s,d

Equation (59) follows by theorem 1.
We will now combine eqs. (54) and (59). First note, that by Young’s inequality, we may
bound eq. (54) as
|||ζ u |||2v ≤


c1 ε
c1 δ
c1  −1
|||ζ u |||2v +
|||ζ p |||2p +
ε + δ−1 |||ξu |||2v0 ,
2
2
2

(60)

for any ε > 0 and δ > 0. Multiplying eq. (60) by a constant β > 0 and adding to eq. (59),
!
!
βc1 ε
βc1  −1
βc1 δ
|||ζ p |||2p + β|||ζ u |||2v ≤
|||ζ p |||2p + c2 +
|||ζ u |||2v + c2 +
ε + δ−1 |||ξu |||2v0 .
2
2
2
Choosing ε < 2/c1 , setting β > c2 /(1 − c1 ε/2) and choosing δ < 2/(βc1 ) we may write
!
!
!
βc1 δ
βc1 ε
βc1  −1
2
2
−1
1−
|||ζ p ||| p + β − c2 −
|||ζ u |||v ≤ c2 +
ε +δ
|||ξu |||2v0 ,
2
2
2
resulting in
|||ζ p ||| p ≤ C|||ξu |||v0

and |||ζ u |||v ≤ C|||ξu |||v0 .

(61)

The energy-norm error estimates eq. (53) now follow by the triangle inequality, the bounds
in eq. (61), and the interpolation error estimates from lemmas 7 and 8.

14

5.2. L2 -norm error estimate for the velocity
We will now determine L2 -norm error estimates for the velocity in the Stokes and Darcy
regions separately. To obtain these estimates we consider the dual problem where (U, P) is the
dim
solution to eqs. (1) and (2) with f s = Ψ ∈ [L2 (Ω s )] and f d = 0 [14, eq. (13)]. We will assume
that this solution to the dual problem satisfies the following regularity estimates
kUkH 2 (Ωs ) ≤ CkΨkΩs ,

kPkH 1 (Ωs ) ≤ CkΨkΩs ,

(62a)

kUkH 1 (Ωd ) ≤ CkΨkΩs ,

kPkH 2 (Ωd ) ≤ CkΨkΩs ,

(62b)

which will allow us to prove the following result.
Theorem 3 (L2 -norm error estimate for the velocity). Let (u, p) ∈ X be the solution of eqs. (1)
dim
dim
and (2) such that u s ∈ [H k+1 (Ω s )] and ud ∈ [H k+1 (Ωd )] for k ≥ 1 and let (uh , ph ) ∈ Xh solve
eq. (5). Then


(63a)
ku − uh kΩs ≤ Chk+1 kukH k+1 (Ωs ) + kukH k (Ωd ) + k f d kH k (Ωd ) ,


(63b)
ku − uh kΩd ≤ Chk+1 kukH k+1 (Ωs ) + kukH k+1 (Ωd ) + k f d kH k (Ωd ) .
Different arguments will be used to prove the L2 -norm error estimates for the velocity in the
Stokes region eq. (63a) and in the Darcy region eq. (63b). We therefore consider the proofs of
these two inequalities separately.
Proof (of Stokes error estimate in eq. (63a)). Let (U, P) ∈ X be the solution of the dual problem where Ψ := u − uh . Setting U := (U, γ(U s )), P := (P, γ(P s ), γ(Pd )), lemma 1 implies
Z
Bh ((U, P), (v, q)) =
(u − uh ) · v dx, ∀(v, q) ∈ X(h).
Ωs

Setting v = (u − uh , γ(u s ) − ūh ), q = (p − ph , γ(p s ) − p̄hs , γ(pd ) − p̄dh ) in this equation,


ku − uh k2Ωs = Bh (U, P) , ((u − uh , γ(u s ) − ūh ) , (p − ph , γ(p s ) − p̄hs , γ(pd ) − p̄dh )) .

(64)

Next, setting vh = (ΠV U, Π̄V U), qh = (ΠQ P, Π̄Qs P, Π̄dQ P) in eq. (52), we obtain


Bh ((u − uh , γ(u s ) − ūh ) , (p − ph , γ(p s ) − p̄hs , γ(pd ) − p̄dh )) , ((ΠV U, Π̄V U) , (ΠQ P, Π̄Qs P, Π̄dQ P))
= 0.

(65)

Combining eqs. (64) and (65) leads to


ku − uh k2Ωs =Bh (ξU , ξ P ) , ((u − uh , γ(u s ) − ūh ) , (p − ph , γ(p s ) − p̄hs , γ(pd ) − p̄dh ))
=ah (ξU , (u − uh , γ(u s ) − ūh ))
+ bhs (ξ Ps , u − uh ) + bhI,s (ξ̄Ps , γ(u s ) − ūh )
+ bdh (ξdP , u − uh ) + bhI,d (ξ̄Pd , γ(u s ) − ūh )
+
+

bhs ((p −
bdh ((p −

ph , γ(p ) −
s

ph , γ(pd ) −

p̄hs ), ξU ) + bhI,s (γ(p s ) − p̄hs , ξ̄U )
p̄dh ), ξU ) + bhI,d (γ(pd ) − p̄dh , ξ̄U )

=J1 + . . . + J5 .
15

(66)

First, observe that J2 vanishes due to eqs. (1c) and (1d), single-valuedness of u and eqs. (11)
and (12). We will bound the remaining terms starting with J1 . Using eq. (28b),
J1 ≤ C|||ξU |||v0 |||(u − uh , γ(u s ) − ūh )|||v0 .
By eqs. (31a) and (48a) and lemma 4 (iv.),
X
X


2
kξU k2K +
kξ̄Ut kF ≤ Ch2 kUk2H 2 (Ωs ) + kUk2H 1 (Ωd )
|||ξU |||2v0 = |||ξU |||2v0 ,s +
F∈F I

K∈T d

≤ Ch2 ku − uh k2Ωs ,

(67)

where in the last step we used the regularity assumption eq. (62). We find
J1 ≤ Ch|||(u − uh , γ(u s ) − ūh )|||v0 ku − uh kΩs .
We next bound J3 . Recalling eqs. (1c), (11) and (12), smoothness of u and eq. (1e), we have
X Z
J3 =
ξP ( f d − ΠQ f d ) dx ≤ kξP kΩd k f d − ΠQ f d kΩd ≤ |||ξdP ||| p,d k f d − ΠQ f d kΩd
K∈T d

K

≤ Chk+1 kPkH 1 (Ωd ) k f d kH k (Ωd ) ≤ Chk+1 ku − uh kΩs k f d kH k (Ωd ) ,
where we used lemma 8 and eq. (62).
For J4 , observe that since ∇ · U = 0 and ∇ · ΠV U ∈ Pk−1 (K),
Z
Z
Z
(p − ph )∇ · ξU dx = (p − ph )∇ · ΠV U dx = (ΠQ p − ph )∇ · ΠV U dx
K
K
ZK
= (ΠQ p − ph )∇ · (U − ΠV U) dx = 0, (68)
K

where we used ΠQ p − ph ∈ Pk−1 (K) and lemma 4 (i.) in the last step. Using eq. (68) and noting
that U is smooth, eq. (12a) holds, Π̄V U is single-valued and U = 0 (and so Π̄V U = 0) on Γ s , we
have
XZ
XZ
s
s
s
ζ̄ ps (ξU − ξ̄U ) · n s ds
J4 =
(γ(p ) − p̄h )(ξU − ξ̄U ) · n ds =
K∈T s

∂K

K∈T s

≤

X

∂K
2

hK kζ̄ ps k∂K

1/2

|||ξU |||v,s ≤ Ch2 |||ζ sp ||| p,s ku − uh kΩs ,

K∈T s

where we applied eq. (67).
Finally we bound J5 . Using eq. (68) and recalling that U is smooth, eq. (12a) holds, Π̄V U is
single-valued and U · n = 0 (and so ΠV U · n = 0) on Γd ,
Z
Z
d
d
d
J5 =
(γ(p ) − p̄h )(ξU − ξ̄U ) · n ds =
ζ̄ pd (ξU − ξ̄U ) · nd ds
ΓI

≤

X

ΓI

2

hK kζ̄ pd k∂K

1/2

|||ξU |||v,s ≤ Ch2 |||ζ dp ||| p,d ku − uh kΩs ,

K∈T d

where we used eq. (67). The result follows by combining the bounds for J1 , . . . , J5 , cancelling a
factor ofku − uh kΩs , using theorem 2 and the equivalence of |||·|||v and |||·|||v0 on V h .

16

To prove eq. (63b) we will treat the problem in the Darcy region as a separate problem where
the interface conditions are treated as boundary conditions. We will first state a result which
constructs a vector function in
H div (Ωd ) = {v ∈ L2 (Ωd ) : ∇ · v ∈ L2 (Ωd )},
such that its normal component on the interface matches the normal component of the error u−uh
on the interface.
dim

dim

Lemma 10. Assume that u s ∈ [H k+1 (Ω s )] and ud ∈ [H k (Ωd )] with k ≥ 1. Then there exists
a function w ∈ H div (Ωd ) that satisfies ∇ · w = 0 in Ωd , w · n = 0 on Γd and w · n = (u s − uhs ) · n on
ΓI such that
(69)
kwkΩd ≤ Chk+1 (kukH k+1 (Ωs ) + kukH k (Ωd ) + k f d kH k (Ωd ) ),
where C > 0 is a constant independent of h.
We point out that the proof of lemma 10 relies on pointwise mass conservation eq. (11), H(div)conformity eq. (12) and eq. (63a), and can be found in [14, Lemma 3.1, Lemma 3.2]. We now
prove eq. (63b).
Proof (of the Darcy error estimate in eq. (63b)). In eq. (52) set vh = 0 in Ω s , v̄h = 0 and qh =
0. Then
adh (u − uh , vh ) = −bdh ((p − ph , γ(p) − p̄dh ), vh ) = −bdh ((ΠQ p − ph , Π̄Q p − p̄h ), vh )

(70)

by the projection properties of ΠQ and Π̄Q .
We will first determine a vh so that adh ((u − uh , vh )) = 0. Setting qh = 0 in Ω s , q̄hs = 0 and
vh = 0 in eq. (52), using lemma 4 (i.) and (ii.), we find
Z


d
d
d d
(71)
q̄dh γ(ud ) − udh · nd ds,
bh (qh , ΠV u − uh ) = bh ((qh , q̄h ), u − uh ) =
ΓI

where the second equality is by eqs. (1c) and (11). Next, let w ∈ H div (Ωd ) such that ∇ · w = 0 in
Ωd , w · n = 0 on Γd , w · nd = (γ(u s ) − uhs ) · nd on ΓI as defined in lemma 10. Then, by lemma 4 (i.)
and (ii.)
Z
(72)
q̄dh (γ(u s ) − uhs ) · nd ds,
bdh (qdh , ΠV w) = bdh (qdh , w) =
ΓI

where the second equality is by eqs. (1e) and (12a). Combining eq. (71) and eq. (72), and using
eqs. (2a) and (12b), we find that
bdh (qdh , ΠV u − uh − ΠV w) = 0

∀qdh ∈ Qdh .

(73)

Therefore, setting vh = ΠV u − uh − ΠV w in eq. (70), we find
0 = adh (u − uh , ΠV u − uh − ΠV w) = adh (u − uh , (ΠV u − u) + (u − uh ) − ΠV w).
Next, by definition of adh (·, ·) and using eq. (74), we find that
κ−1 ku − uh k2Ωd = adh (u − uh , u − uh ) = adh (u − uh , u − ΠV u + ΠV w)
≤ κ−1 ku − uh kΩd ku − ΠV u + ΠV wkΩd .
17

(74)

Hence, cancelling a factor of κ−1 ku − uh kΩd above and using lemma 4 (iv.) and eq. (69),
ku − uh kΩd ≤ ku − ΠV ukΩd +kΠV wkΩd ≤ ku − ΠV ukΩd + CkwkΩd


≤ Chk+1 kukH k+1 (Ωd ) + Chk+1 kukH k+1 (Ωs ) +kukH k (Ωd ) + k f d kH k (Ωd )


≤ Chk+1 kukH k+1 (Ωs ) +kukH k+1 (Ωd ) + k f d kH k (Ωd ) .


The result follows.

We note that the error estimates for the velocity in theorem 2 and theorem 3 do not depend
on the approximation error of the pressure. The EDG–HDG method eq. (5) for the Stokes–Darcy
system is therefore pressure-robust [35]. We furthermore remark that the analysis in this paper
is easily extended to spatially dependent permeability that varies continuously over Ωd under the
condition that 0 < κmin ≤ κ ≤ κmax < ∞.
6. Numerical examples
The examples in this section have been implemented using the NGSolve finite element library [36]. Both examples are posed on the domain Ω = [0, 1]2 with Ωd = [0, 1] × [0, 0.5] and
Ω s = [0, 1] × [0.5, 1]. The domain is discretized by an unstructured simplicial mesh. The mesh
is such that T s is an exact triangulation of Ω s , T d is an exact triangulation of Ωd , and cell facets
match on the interface ΓI . We set k = 3 in eq. (3) and eq. (4) and set the penalty parameter to be
β = 10k2 .
6.1. Rates of convergence
We solve the Stokes–Darcy system eqs. (1) and (2) with the source terms and boundary
conditions chosen such that the exact solution is given by
"
#
κµ − 2
− sin(πx1 ) exp(x2 /2)/(2π2 )
cos(πx1 ) exp(x2 /2),
(75a)
u|Ωs =
,
p|Ωs =
cos(πx1 ) exp(x2 /2)/π
κπ
"
#
2
−2 sin(πx1 ) exp(x2 /2)
(75b)
u|Ωd =
,
p|Ωd = − cos(πx1 ) exp(x2 /2),
cos(πx1 ) exp(x2 /2)/π
κπ
with α = µκ1/2 (1 + 4π2 )/2. For µ = 1 and κ = 1 we recover the test case introduced in [37]. We
introduce this extended version to investigate the effect of µ and κ on the solution.
Table 1 presents computed errors in the velocity and the pressure on Ω s and on Ωd for different values of µ and κ. We observe optimal rates of convergence for all unknowns, independent
of the value of the viscosity and permeability. We observe also that, although the error in the
pressure changes when viscosity and permeability changes, the error in the velocity remains the
same, as predicted by the analysis. Furthermore, pointwise satisfaction of the mass equation is
obtained in both regions. Although not shown here, these observations hold also for other values
of k in eq. (3) and eq. (4).
6.2. Coupled surface and subsurface flow
In this section we consider a test case similar to that proposed in [38, Example 7.2]. This test
case is representative of surface flow coupled to subsurface flow.
18

Cells

kuh − ukΩs

µ = 1, κ = 1
152
1.7e-6
578
8.4e-8
2416
4.4e-9
9580
2.3e-10
µ = 10−6 , κ = 1
152
9.0e-6
578
1.2e-7
2416
4.5e-9
9580
2.3e-10
µ = 1, κ = 103
152
1.7e-6
578
8.4e-8
2416
4.4e-9
9580
2.3e-10
µ = 10−6 , κ = 103
152
1.6e-6
578
8.3e-8
2416
4.4e-9
9580
2.3e-10
Cells

kuh − ukΩd

µ = 1, κ = 1
152
3.1e-6
578
2.0e-7
2416
1.2e-8
9580
7.5e-10
µ = 10−6 , κ = 1
152
3.0e-6
578
2.0e-7
2416
1.2e-8
9580
7.5e-10
µ = 1, κ = 103
152
3.1e-6
578
2.0e-7
2416
1.2e-8
9580
7.5e-10
µ = 10−6 , κ = 103
152
3.1e-6
578
2.0e-7
2416
1.2e-8
9580
7.5e-10

Stokes solution (Ω s )
Rate
ph − p Ωs Rate

∇ · uh

4.8
4.3
4.3
4.3

2.9e-4
3.6e-5
4.5e-6
5.6e-7

3.6
3.0
3.0
3.0

2.3e-14
4.8e-14
9.3e-14
1.9e-13

7.6
6.3
4.7
4.3

5.1e-5
6.1e-6
7.4e-7
9.0e-8

3.2
3.1
3.0
3.0

7.5e-12
7.0e-12
7.0e-12
6.9e-12

4.8
4.3
4.3
4.3

2.9e-4
3.6e-5
4.5e-6
5.6e-7

3.6
3.0
3.0
3.0

2.3e-14
4.8e-14
9.3e-14
1.9e-13

4.8
4.3
4.3
4.3

5.1e-8
6.1e-9
7.4e-10
9.0e-11

3.2
3.1
3.0
3.0

1.3e-14
1.4e-14
5.6e-14
4.9e-14

Darcy solution (Ωd )
Rate
ph − p Ωd Rate

Ωs

∇ · uh + ΠQ f d

4.7
4.0
4.1
4.0

3.5e-5
4.7e-6
5.8e-7
7.3e-8

3.4
2.9
3.0
3.0

1.2e-12
3.7e-12
1.5e-11
6.0e-11

4.7
3.9
4.1
4.0

3.5e-5
4.7e-6
5.8e-7
7.3e-8

3.4
2.9
3.0
3.0

9.4e-13
3.6e-12
1.5e-11
5.9e-11

4.7
4.0
4.1
4.0

3.5e-8
4.7e-9
5.8e-10
7.3e-11

3.4
2.9
3.0
3.0

2.1e-12
3.6e-12
1.0e-10
6.2e-11

4.7
3.9
4.1
4.0

3.5e-8
4.7e-9
5.8e-10
7.3e-11

3.4
2.9
3.0
3.0

1.9e-12
3.6e-12
1.4e-10
6.3e-11

Ωd

Table 1: Errors and rates of convergence in Ω s (top half) and Ωd (bottom half) for the velocity and pressure fields using
polynomial degree k = 3 for the test case described in section 6.1.

19

Let the boundary of the Stokes region be partitioned as Γ s = Γ1s ∪ Γ2s ∪ Γ3s where Γ1s :=
{x ∈ Γ s : x1 = 0}, Γ2s := {x ∈ Γ s : x1 = 1} and Γ3s := {x ∈ Γ s : x2 = 1}. Similarly, let Γd =
n
o
n
o
Γd1 ∪ Γd2 where Γd1 := x ∈ Γd : x1 = 0 or x1 = 1 and Γd2 := x ∈ Γd : x2 = 0 . We impose the
following boundary conditions:
u = (x2 (3/2 − x2 )/5, 0)

−2µε(u) + pI n = 0

on Γ1s ,
on Γ2s ,


u · n = 0 and −2µε(u) + pI t = 0

on Γ3s ,

u·n=0

on Γd1 ,
on Γd2 .

p = −0.05

Note that due to the boundary condition on the pressure on Γd2 the pressure solution need not be
in L02 (Ω) as imposed in eq. (3). We set the permeability to
κ = 700(1 + 0.5(sin(10πx1 ) cos(20πx22 ) + cos2 (6.4πx1 ) sin(9.2πx2 ))) + 100.
Other parameters in eqs. (1) and (2) are set as µ = 0.1, α = 0.5, f s = 0 and f d = 0. We consider
the solution on a mesh with 5754 simplicial cells.
Figure 2 shows the permeability, computed velocity field, and computed pressure field. We
observe a similar flow field as presented in [38, Example 7.2]. In the Darcy region Ωd the flow
field avoids areas of low permeability, free-flow is present in the Stokes region Ω s , while the
tangential velocity is discontinuous along the interface. To plot the pressure we used two colour
scales to illustrate the pressure differences in the Darcy and the Stokes region. We note that the
pressure is discontinuous across the interface. Furthermore, the pressure in the Darcy region
follows a similar pattern as the permeability while in the Stokes region pressure is highest at the
inlet.
7. Conclusions
We have formulated a pointwise mass-conserving and divergence-conforming embedded–
hybridized discontinuous Galerkin method for the Stokes–Darcy system. The Stokes equations
are coupled to the Darcy equations at an interface by the Beavers–Joseph–Saffman condition.
This coupling is handled naturally by the facet variables that occur in the EDG–HDG method
and act as Lagrange multipliers enforcing divergence-conformity of the scheme. We analyzed
the embedded–hybridized method and proved existence and uniqueness of the solution to the discretization. Additionally, we presented a priori error analysis showing optimal rates of convergence and demonstrated that the error in the velocity is independent of the pressure. Numerical
examples support the analysis of the scheme.
Acknowledgements
SR gratefully acknowledges support from the Natural Sciences and Engineering Research
Council of Canada through the Discovery Grant program (RGPIN-05606-2015) and the Discovery Accelerator Supplement (RGPAS-478018-2015). Part of this research was done while AC
was on sabbatical at the University of Waterloo, Department of Applied Mathematics.
20

(a) The permeability.

(b) The velocity field.

(c) The pressure field.
Figure 2: The permeability, computed velocity field, and computed pressure field for the test case described in section 6.2.

21

References
[1] G. S. Beavers, D. D. Joseph, Boundary conditions at a naturally impermeable wall, J. Fluid. Mech 30 (1967)
197–207. doi:10.1017/S0022112067001375.
[2] P. Saffman, On the boundary condition at the surface of a porous media, Stud. Appl. Math. 50 (1971) 292–315.
[3] A. Mikelic, W. Jäger, On the interface boundary condition of Beavers, Joseph, and Saffman, SIAM J. Appl. Math.
60 (2000) 1111–1127. doi:10.1137/S003613999833678X.
[4] M. Discacciati, A. Quarteroni, Navier–Stokes/Darcy coupling: modeling, analysis, and numerical approximation,
Rev. Mat. Compplut. 22 (2009) 315–426. doi:10.5209/rev_REMA.2009.v22.n2.16263.
[5] M. Discacciati, E. Miglio, A. Quarteroni, Mathematical and numerical models for coupling surface and groundwater flows, Appl. Numer. Math. 43 (2002) 57 – 74. doi:10.1016/S0168-9274(02)00125-3, 19th Dundee
Biennial Conference on Numerical Analysis.
[6] W. Layton, F. Schieweck, I. Yotov, Coupling fluid flow with porous media flow, SIAM J. Numer. Anal. 40 (2002)
2195–2218. doi:10.1137/S0036142901392766.
[7] E. Burman, P. Hansbo, Stabilized Crouzeix–Raviart element for the Darcy–Stokes problem, Numer. Meth. Part. D.
E. 21 (2005) 986–97. doi:10.1002/num.20076.
[8] Y. Cao, M. Gunzburger, X. Hu, F. Hua, X. Wang, W. Zhao, Finite element approximations for Stokes–Darcy
flow with Beavers–Joseph interface conditions, SIAM J. Numer. Anal. 47 (2010) 4239–4256. doi:10.1137/
080731542.
[9] G. N. Gatica, S. Meddahi, R. Oyarzúa, A conforming mixed finite-element method for the coupling of fluid flow
with porous media flow, IMA J. Numer. Anal. 29 (2009) 86–108. doi:10.1093/imanum/drm049.
[10] J. Camaño, G. N. Gatica, R. Oyarzúa, R. Ruiz-Baier, P. Venegas, New fully-mixed finite element methods for the
Stokes–Darcy coupling, Comput. Method. Appl. M. 295 (2015) 362 – 395. doi:10.1016/j.cma.2015.07.007.
[11] A. Márquez, S. Meddahi, F. J. Sayas, Strong coupling of finite element methods for the Stokes–Darcy problem,
IMA J. Numer. Anal. 35 (2015) 969–988. doi:10.1093/imanum/dru023.
[12] A. Çeşmelioğlu, B. Rivière, Primal discontinuous Galerkin methods for time-dependent coupled surface and subsurface flow, J. Sci. Comput. 40 (2009) 115–140. doi:10.1007/s10915-009-9274-4.
[13] V. Girault, B. Rivière, DG approximation of coupled Navier–Stokes and Darcy equations by Beaver–Joseph–
Saffman interface condition, SIAM J. Numer. Anal. 47 (2009) 2052–2089. doi:10.1137/070686081.
[14] V. Girault, G. Kanschat, B. Rivière, Error analysis for a monolithic discretization of coupled Darcy and Stokes
problems, J. Numer. Math. 22 (2014) 109–142. doi:10.1515/jnma-2014-0005.
[15] K. Lipnikov, D. Vassilev, I. Yotov, Discontinuous Galerkin and mimetic finite difference methods for coupled
Stokes–Darcy flows on polygonal and polyhedral grids, Numer. Math. 126 (2014) 321–360. doi:10.1007/
s00211-013-0563-3.
[16] B. Rivière, Analysis of a discontinuous finite element method for the coupled Stokes and Darcy problems, J. Sci.
Comput. 22 (2005) 479–500. doi:10.1007/s10915-004-4147-3.
[17] B. Rivière, I. Yotov, Locally conservative coupling of Stokes and Darcy flows, SIAM J. Numer. Anal. 42 (2005)
1959–1977. doi:10.1137/S0036142903427640.
[18] H. Egger, C. Waluga, A hybrid discontinuous Galerkin method for Darcy–Stokes problems, in: R. Bank, M. Holst,
O. Widlund, J. Xu (Eds.), Domain Decomposition Methods in Science and Engineering XX, Springer Berlin Heidelberg, 2013, pp. 663–670. doi:10.1007/978-3-642-35275-1_79.
[19] G. Fu, C. Lehrenfeld, A strongly conservative hybrid DG/mixed FEM for the coupling of Stokes and Darcy flow,
J. Sci. Comput. (2018). doi:10.1007/s10915-018-0691-0.
[20] G. N. Gatica, F. A. Sequeira, Analysis of the HDG method for the Stokes–Darcy coupling, Numer. Meth. Part. D.
E. 33 (2017) 885–917. doi:10.1002/num.22128.
[21] I. Igreja, A. F. D. Loula, A stabilized hybrid mixed DGFEM naturally coupling Stokes–Darcy flows, Comput.
Methods Appl. Mech. and Engrg. 339 (2018) 739–768. doi:10.1016/j.cma.2018.05.026.
[22] W. Chen, F. Wang, Y. Wang, Weak Galerkin method for the coupled Darcy–Stokes flow, IMA J. Numer. Anal. 36
(2016) 897–921. doi:10.1093/imanum/drv012.
[23] G. Wang, F. Wang, L., Y. He, A divergence free weak virtual element method for the Stokes–Darcy problem on
general meshes, Comput. Method. Appl. M. 344 (2019) 998–1020. doi:10.1016/j.cma.2018.10.022.
[24] G. Kanschat, B. Rivière, A strongly conservative finite element method for the coupling of Stokes and Darcy flow,
J. Comput. Phys. 229 (2010) 5933–5943. doi:10.1016/j.jcp.2010.04.021.
[25] C. Lehrenfeld, J. Schöberl, High order exactly divergence-free hybrid discontinuous Galerkin methods for unsteady
incompressible flows, Comput. Methods Appl. Mech. Engrg. 307 (2016) 339–361. doi:10.1016/j.cma.2016.
04.025.
[26] S. Rhebergen, G. N. Wells, An embedded–hybridized discontinuous Galerkin finite element method for the Stokes
equations, Comput. Methods Appl. Mech. Engrg. (2019). To appear.

22

[27] G. N. Wells, Analysis of an interface stabilized finite element method: the advection-diffusion-reaction equation,
SIAM J. Numer. Anal. 49 (2011) 87–109. doi:10.1137/090775464.
[28] D. A. Di Pietro, A. Ern, Mathematical aspects of discontinuous Galerkin methods, volume 69 of Mathématiques et
Applications, Springer–Verlag Berlin Heidelberg, 2012.
[29] S. C. Brenner, L. R. Scott, The Mathematical Theory of Finite Element Methods, 3rd ed., Springer, 2010.
[30] S. Rhebergen, G. N. Wells, Analysis of a hybridized/interface stabilized finite element method for the Stokes
equations, SIAM J. Numer. Anal. 55 (2017) 1982–2003. doi:10.1137/16M1083839.
[31] S. C. Brenner, Korn’s inequalities for piecewise H 1 vector fields, Math. Comp. 73 (2004) 1067–1087.
[32] P. Hansbo, M. G. Larson, Discontinuous Galerkin methods for incompressible and nearly incompressible elasticity by Nitsche’s method, Comput. Methods Appl. Mech. Engrg. 191 (2002) 1895–1908. doi:10.1016/
S0045-7825(01)00358-9.
[33] D. Boffi, F. Brezzi, M. Fortin, Mixed Finite Element Methods and Applications, volume 44 of Springer Series in
Computational Mathematics, Springer–Verlag Berlin Heidelberg, 2013.
[34] S. Rhebergen, G. N. Wells, Preconditioning of a hybridized discontinuous Galerkin finite element method for the
Stokes equations, J. Sci. Comput. 77 (2018) 1936–1952. doi:10.1007/s10915-018-0760-4.
[35] V. John, A. Linke, C. Merdon, M. Neilan, L. G. Rebholz, On the divergence constraint in mixed finite element
methods for incompressible flows, SIAM Rev. 59 (2017) 492–544. doi:10.1137/15M1047696.
[36] J. Schöberl, C++11 Implementation of Finite Elements in NGSolve, Technical Report ASC Report 30/2014, Institute for Analysis and Scientific Computing, Vienna University of Technology, 2014. URL: http://www.asc.
tuwien.ac.at/~schoeberl/wiki/publications/ngs-cpp11.pdf.
[37] M. R. Correa, A. F. D. Loula, A unified mixed formulation naturally coupling Stokes and Darcy flows, Comput.
Methods Appl. Mech. Engrg. 198 (2009) 2710–2722. doi:10.1016/j.cma.2009.03.016.
[38] D. Vassilev, I. Yotov, Coupling Stokes–Darcy flow with transport, SIAM J. Sci. Comput. 31 (2009) 3661–3684.
doi:10.1137/080732146.

23

