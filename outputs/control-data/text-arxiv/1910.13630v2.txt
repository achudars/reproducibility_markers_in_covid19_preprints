1

NOMA Enabled UAV Data Collection with Double
Energy Limitations

arXiv:1910.13630v2 [cs.IT] 3 Jan 2021

Xidong Mu, Student Member, IEEE, Yuanwei Liu, Senior Member, IEEE, Li Guo, Member, IEEE,
Jiaru Lin, Member, IEEE, and Zhiguo Ding, Fellow, IEEE

Abstract—This paper investigates unmanned aerial vehicle
(UAV) data collection systems with different multiple access
schemes, where a rotary-wing UAV is dispatched to collect data
from multiple ground nodes (GNs). Our goal is to maximize the
minimum UAV data collection throughput from GNs for both
orthogonal multiple access (OMA) and non-orthogonal multiple
access (NOMA) transmission, subject to the energy budgets at
both the UAV and GNs, namely double energy limitations. 1) For
OMA, we propose an efficient algorithm by invoking alternating
optimization (AO) method, where each subproblem is alternately
solved by applying successive convex approximation (SCA) technique. 2) For NOMA, we first handle subproblems with fixed
decoding order using SCA technique. Then, we develop a penaltybased algorithm to solve the decoding order design subproblem.
Numerical results show that: i) The proposed algorithms are
capable of improving the max-min throughput performance
compared with other benchmark schemes; ii) NOMA yields a
higher performance gain than OMA when GNs have sufficient
energy.

I. I NTRODUCTION
Recently, unmanned aerial vehicles (UAVs) or drones have
received extensive attention in civil applications with the advantages of low cost, high maneuverability, and high mobility.
Equipped with communication devices, UAVs can act as aerial
base stations (BSs) or users for accomplishing variant tasks,
such as communication enhancement and offloading, cargo
delivery, and security surveillance [1–3]. Among others, UAV
data collection has been envisioned as a promising application,
where UAVs equipped with sensing devices are deployed to
collect data from ground nodes (GNs) [4]. Compared with
terrestrial data collection systems, on the one hand, GNs are
able to upload data to UAVs directly through the line-of-sight
(LoS) dominated UAV-ground channels [5], thus reducing
energy consumptions of GNs and improving the transmission
efficiency. One the other hand, thanks to the low cost and high
flexibility features of UAVs, UAV data collection systems are
more suitable to be used in inaccessible regions, such as forest
or marine monitoring, where deploying conventional terrestrial
infrastructure to collect data is costly and inefficient.
X. Mu, L. Guo, and J. Lin are with the School of Artificial Intelligence
and the Key Laboratory of Universal Wireless Communications, Ministry
of Education, Beijing University of Posts and Telecommunications, Beijing,
China. (email:{muxidong, guoli, jrlin}@bupt.edu.cn).
Y. Liu is with the School of Electronic Engineering and Computer Science, Queen Mary University of London, London, UK.
(email:yuanwei.liu@qmul.ac.uk).
Z. Ding is with the School of Electrical and Electronic Engineering, The University of Manchester, Manchester, UK (e-mail:
zhiguo.ding@manchester.ac.uk).

Multiple access (MA) technique is one of the most fundamental enablers for facilitating UAV data collection systems since the number of GNs is usually large. The existing MA techniques can be loosely classified into two categories, namely, orthogonal multiple access (OMA) and nonorthogonal multiple access (NOMA). Different from OMA
where one resource block (in time, frequency, or code) is
occupied with at most one user, the key idea of NOMA1
is to allow different users to share the same time/frequency
resources and to be multiplexed in different power levels
by invoking superposition coding and successive interference
cancellation (SIC) techniques [6, 7]. Owing to flexible resource allocations, NOMA is capable of improving spectrum
efficiency, supporting massive connectivity, and guaranteing
user fairness [6]. Recall that the diversified communication
demands and massive connectivity requirements of UAV data
collection systems, it is natural to investigate the employment
of NOMA in UAV data collection systems and explore the
potential performance gain.
A. Related Works
1) Studies on UAV Communication Systems: UAV communication systems have drawn significant attention of researchers in the past few years. In existing literature, UAVs
are deployed as aerial BSs, relays, and users to boost the
performance of communication systems, such as coverage
and capacity. In terms of UAVs’ state in the sky, research
contributions can be divided into two categories: static UAV
and mobile UAV communication systems. For static UAV
communication systems, researchers mainly focused on the
optimal deployment/placement of UAVs due to the unique airto-ground (A2G) channel characteristics. The authors of [8]
studied the optimal UAV altitude to maximize the coverage
based on the probability A2G channel model. The authors
of [9] further investigated optimal three-dimensional (3D)
deployment of multiple UAVs, where an efficient method was
proposed to achieve the maximum coverage while considering
the inter-cell interference caused by different UAVs. The
authors of [10] proposed a spiral-based algorithm with the
aime of using the minimum number of UAVs to ensure that all
ground users can be served. UAVs in coexistence with deviceto-device (D2D) communications were studied by the authors
of [11], where the user outage probability was analyzed
in both static and mobile UAV scenarios. For mobile UAV
1 In this article, we use “NOMA” to refer to “power-domain NOMA” for
simplicity.

2

communication systems, the mobility of UAVs was exploited
to further improve the system performance, such as average
throughput and secrecy rate. A multiple UAV BSs network was
considered by the authors of [12], where the minimum average
rate of ground users were maximized by optimizing UAVs’
trajectories, transmit power, and user scheduling. The authors
of [13] maximized the system secrecy rate by designing
UAVs’ trajectory and scheduling, where two UAVs were used
for information transmission and jamming, respectively. The
authors of [14] optimized 3D UAV trajectory in UAV-enabled
data harvesting system with Rician fading channel model.
Furthermore, a propulsion energy consumption model for
rotary-wing UAVs were derived by the authors of [15], where
a novel path discretization method was proposed to minimize
the energy consumed by the UAV for accomplishing missions.
The authors of [16] studied a UAV flight time minimization
problem in UAV data collection wireless sensor networks. The
authors of [17] minimized the energy consumption of Internetof-Things (IoT) devices in a UAV-enabled IoT network, subject to the UAV energy constraint. The authors of [18] further
studied solar-powered UAV communication systems, where
the optimal UAV trajectory and resource allocations were
obatined via monotonic optimization.
2) Studies on UAV-NOMA Systems: In contrast to the
aforementioned research contributions on UAV communication systems considering OMA transmission scheme, some
initial studies have focused on UAV-NOMA systems [19–
26]. For example, The authors of [20] optimized the UAV
attitude as well as power allocation to achieve maximum
sum rate when UAV BSs serve ground users employing
NOMA. The authors of [21] investigated multiple antennas
technique in UAV NOMA communications, where the system
performance was analyzed with stochastic geometry approach
in both LOS and non-LoS scenarios. The authors of [22]
proposed a novel uplink cooperative NOMA framework to
tackle the interference introduced by the UAV user. A resource
allocation problem was formulated by the authors of [23] in
uplink NOMA multi-UAV IoT systems, where the system sum
rate was maximized by optimizing subchannel allocation, IoT
devices’ transmit power, and UAVs’ attitude. Furthermore, The
authors of [24] maximized the minimum achievable rate of
ground users by jointly optimizing the UAV trajectory, transmit
power, and user association in the downlink NOMA scenario.
A UAV-assisted NOMA network was proposed by The authors
of [25], where the UAV trajectory and precoding of the ground
base station were jointly designed to maximize the system sum
rate. The authors of [26] investigated uplink NOMA with the
cellular-connected UAV, where the mission completion time
was minimized by designing the UAV trajectory and UAV-BS
association order.
B. Motivation and Contributions
Despite the aforementioned advantages of UAV data collection systems, one critical issue is that both the on-board energy
of UAVs and storage energy of GNs are limited, namely double
energy limitations. Therefore, the double energy limitations
need to be carefully considered in practical designs to fully

reap the benefits of UAV data collection systems. Although
some prior works have studied the UAV data collection design
[14–17], the energy constraints at either UAV or GNs are often
absent and only OMA transmission scheme was employed.
To the best of our knowledge, the joint UAV trajectory and
resource allocation design under different MA schemes has
not been well investigated in the energy-constrained UAV data
collection system, especially for NOMA. In contrast to OMA
allocating orthogonal resources to different GNs, NOMA
introduces additional decoding order design by multiplexing
GNs in the same time/frequency resources, which makes the
achievable data collection rate from GNs to the UAV more
complicated and leads to a more challenging problem than
OMA.
Against the above discussion, in this article, we investigate
energy-constrained UAV data collection systems with two
MA schemes, namely OMA and NOMA. Specifically, the
UAV flies from the predefined initial location to the final
location to harvest data from GNs, under the constraints on the
UAV’s and GNs’ energy limitations. The main contributions
are summarized as follows:
• We propose a energy-constrained UAV data collection
framework where both OMA and NOMA are employed at
the UAV when collecting data from GNs. Based on the
proposed framework, we jointly optimize the UAV trajectory, the GNs’ transmit power, and the GN scheduling
for maximization of the minimum UAV data collection
throughput from all GNs, subject to the energy constraints
at both the UAV and GNs.
• For OMA, we develop an efficient algorithm by employing alternating optimization (AO) method, where each
non-convex subproblem is iteratively solved by applying
successive convex approximation (SCA) technique. We
demonstrate that the proposed algorithm is guaranteed to
converge.
• For NOMA, we propose a penalty-based algorithm for
solving the additional mixed integer non-convex decoding
order design subproblem, where the relaxed continuous
variables are forced to be binaries through iterations.
• Numerical results demonstrate that the max-min throughput obtained by the proposed algorithm significantly
outperforms other benchmark schemes. It also shows that
NOMA always achieves no worse performance than that
of OMA, and the performance gain of NOMA over OMA
is noticeable when GNs have sufficient energy.
C. Organization and Notation
The rest of the paper is organized as follows. Section II
presents the system model and problem formulation for both
OMA and NOMA. In Section III and Section IV, two efficient
AO-based algorithms are developed for OMA and NOMA,
respectively. Section V provides numerical results to validate
the effectiveness of the proposed designs. Finally, Section VI
concludes the paper.
Notation: Scalars are denoted by lower-case letters, vectors
are denoted by bold-face lower-case letters. RM×1 denotes the
space of M -dimensional real-valued vector. For a vector a, aT
denotes its transpose, and kak denotes its Euclidean norm.

3

for rural or suburban environment2, which is also the typical
scenario for UAV data collection systems. Therefore, in this
paper, we assume that e
hk [n] , 13 and the channel coefficient
follows from the free-space path loss model, which can be
expressed as
ρ0
2
,
(3)
|hk [n]| =
2
ku [n] − wk k + H 2

II. S YSTEM M ODEL AND P ROBLEM F ORMULATION
A. System Model

UAV on-board energy
GN storage energy
UAV trajectory
Final location

Initial location

Data collection

Ă

Ă

GNs

Fig. 1: Illustration of the energy-constrained UAV data collection
system.

As shown in Fig. 1, we consider a UAV data collection system, which consists of a rotary-wing single-antenna UAV data
collector and K single-antenna GNs. The GNs are indexed
by the set K = {1, · · · , K}. The UAV is dispatched to fly
from the predefined initial location to the final location with
a constant height H. During the flight, the UAV collects data
from each GN. Without loss of generality, a 3D Cartesian
coordinate
The kth GN is fixed at
T system is considered.
T
T
wk , 0 , where wk = (xk , yk ) denotes the corresponding
T
T
horizontal coordinate. Similarly, uTI , H and uTF , H are
the UAV’s predefined initial and finial coordinates, where
uI = (xI , yI )T and uF = (xF , yF )T . Let EU and Ek denoted
the UAV total on-board energy and the total storage energy of
the kth GN, respectively. Let TU denote the corresponding
UAV
 total flight
 time, the instant UAV trajectory is denoted
T

T

by u(t) , H , 0 ≤ t ≤ TU , where u (t) ∈ R2×1 is the UAV
horizontal location. Different from the existing UAV trajectory
design works using the time discretization method [12–14],
TU is unknown and needs to be optimized in our work. To
facilitate the design of UAV trajectory, we invoke the path
discretization method [15] and divide the UAV path into N
line segments with N + 1 waypoints, where u [1] = uI ,
u [N + 1] = uF . In order to achieve good approximation,
we have the following constraints:
ku [n + 1] − u [n]k ≤ δ, n = 1, · · · , N,

(1)

where δ is chosen sufficiently small compared with the UAV
height such that the distance between the UAV and each GN is
approximately unchanged and the UAV’s speed can be regard
as a constant within each line segment. The
duration of
Ptime
N
nth line segment is denoted by T [n] and n=1 T [n] = TU .
The constraints introduced by the UAV mobility is given by
ku [n + 1] − u [n]k ≤ Vmax T [n], n = 1, · · · , N,

(2)

where Vmax denotes the maximum speed of the UAV.
The channel coefficient between the UAV and the kth
devices
at the nth line segment can be modeled as hk [n] =
p
ρk [n]e
hk [n], where ρk [n] represents the distance-dependent
large-scale channel attenuation and e
hk [n] represents the smallscale fading coefficient. Recent A2G channel modeling literatures [27, 28] have shown that there is a high probability
for A2G channel to be dominated by the LoS link, especially

where ρ0 is the channel power gain at the reference distance of 1 meter. It is also assumed that the Doppler effect
caused by the UAV mobility is perfectly compensated at the
receivers [29].
The energy consumption of UAV involves two parts: the
communication related energy and the propulsion energy.
Compared with the propulsion energy, the communication
related energy is much smaller, and is thus ignored in this
paper. Furthermore, we adopt the propulsion power consumption model of rotary-wing UAVs in [15], which is modeled
as a function of the UAV’s speed and ignores the UAV
acceleration/deceleration energy consumption. This model is
reasonable when the acceleration/deceleration duration only
takes a small portion of the total UAV flight time. Suppose that
a rotary-wing UAV flying at the speed of V , the corresponding
propulsion power consumption can be calculated as [15]
s
!1/2
!
V4 V2
3V 2
1
+ d0 ρsAV 3 ,
P (V )=P0 1+ 2 +Pi
1+ 4 − 2
Utip
4v0 2v0
2
(4)
where P0 and Pi are two constants representing the blade profile power and induced power in hovering status, respectively.
Utip represents the tip speed of the rotor blade and v0 represents the mean rotor induced velocity in hover. d0 and s are the
fuselage drag ratio and rotor solidity, respectively. In addition,
ρ and A denote the air density and rotor disc area, respectively.
During the nth line segment, the UAV speed can be calculated
as V [n] = Ts[n]
[n] , where s [n] = ku [n + 1] − u [n]k. Thus, the
UAV energy consumption at the nth line segment is given by


s [n]
E [n] = T [n] P
T [n]
!
2
3s[n]
= P0 T [n] + 2
Utip T [n]
(5)
 21
s
2
3
4
s[n] 
s[n]
s[n]
1
4
−
d
ρsA
+Pi  T [n] +
+
0
2.
4v04
2v02
2
T [n]

Then,
PN the total UAV energy constraint can be expressed as
n=1 E [n] ≤ EU .
The sleep-wake protocol is considered when the UAV
collects data from GNs, as assumed in [14, 17]. GNs upload
information only when being waken up by the UAV, otherwise
2 As reported in [27], a 100% LoS probability A2G channel can be achieved
when the height of UAV is larger than 40 m in the rural macro (RMa) scenario.
3 In practice, the A2G channel might involve some random parameters,
which make the associated optimization problems are complicated to solve.
The results in this paper with the deterministic LoS channel model serve
as a valuable performance indicator for the considered system, and provide
guidelines for practical implementation.

4

they keep in silence. Specifically, the UAV first determines
its trajectory and the wake-up time allocation with the prior
knowledge of GNs’ locations. During the flight, the UAV
wakes up the corresponding GN4 at the predefined time instant
using the wake-up signal [30] and informs them to upload
data through the downlink reliable control links. We ignore
the energy consumed by the UAV for sending wake-up signal,
since it belongs to the communication related energy. In the
next subsection, we formulate the optimization problem with
two MA schemes, i.e., OMA and NOMA.

For OMA, the UAV receives the information bits from different GNs by allocating unique time resources5 at each time
duration T [n]. Let τk [n] denote the allocatedP
time resources
K
for the kth GN during T [n] and we have
k=1 τk [n] ≤
T [n] , ∀n. Recall that the distance between the UAV and each
GN is approximately unchanged within each line segment
by employing the path discretization method. Therefore, the
achievable data collection throughput (bits/Hz) from the kth
GN during the nth line segment for OMA is approximate to
a constant, which is given by
!
γ0 pk [n]
O
rk [n] = τk [n] log2 1 +
,
(6)
ku [n] − wk k2 + H 2
where γ0 = σρ02 and pk [n] denotes the transmit power of the
kth GN. Therefore, the total achievable P
throughput from the
N
O
kth GN during the UAV flight is QO
k =
n=1 rk [n]. In our
work, the circuit power consumptions of GNs are ignored, the
totalPstorage energy constraint of the kth GN for OMA is given
by N
n=1 τk [n] pk [n] ≤ Ek , ∀k.
In order to achieve a fair data collection from all GNs, we
aim to maximize the minimum UAV data collection throughput
by jointly optimizing the UAV trajectory, {u [n] , T [n]}, the
GN scheduling, {τk [n]}, and the GN transmit power, {pk [n]},
while taking the energy constraints of both the UAV and GNs
into account. Then, the optimization problem for OMA can be
formulated as
max

{u[n],T [n],τk [n],pk [n]}

s.t. u [1] = uI , u [N ] = uF ,
ku [n + 1] − u [n]k ≤ min (δ, Vmax T [n]) , ∀n,
XN
E [n] ≤ EU ,
n=1
XN
τk [n] pk [n] ≤ Ek , ∀k,
n=1
XK
τk [n] ≤ T [n] , ∀n,
k=1

τk [n] ≥ 0, ∀k, n,
0 ≤ pk [n] ≤ Pmax , ∀n, k,
4 In

Remark 1. In Problem (7), time resources are allocated in
an adaptive manner. We refer to this type of OMA as OMAII scheme. However, in conventional OMA, time resources
are equally allocated to each GN, which is referred to OMAI scheme [31]. For OMA-I, Problem (7) needs to consider
additional constraints, τk [n] = τj [n] , ∀k 6= j.
C. Problem Formulation for NOMA

B. Problem Formulation for OMA

min QO
k
∀k

where Pmax represents the maximum transmit power of GNs.
(7b) and (7c) represent the UAV mobility constraints. (7d) and
(7e) are energy constraints of the UAV and GNs, respectively.

(7a)
(7b)
(7c)
(7d)
(7e)
(7f)
(7g)
(7h)

terms of the wake-up protocol [30], GNs remain in power save state
instead of completely off state. As a result, the start time is relatively short
and can be ignored as compared with the data uploading duration.
5 We adopt time division multiple access (TDMA) instead of frequency
division multiple access (FDMA) for OMA, since TDMA is more energysaving and easier for implementation than FDMA in the considered network
of this paper.

For NOMA, the UAV receives all GNs’ signals through
the same time resources. Different from the downlink NOMA
communication [24], where the SIC decoding order is determined by the channel gains. In uplink NOMA, the UAV
can perform SIC in any arbitrary order since all received
signals at the UAV are desired signals. Let πn (k) denote
the decoding order of GN k at the nth line segment. If
πn (k) = i, then GN k is the ith signal to be decoded at
the nth line segment. Therefore, a set of binary indicators
αk,m [n] ∈ {0, 1} , ∀k 6= m ∈ K are defined as
αk,m [n] = 1, πn (k) > πn (m) ,
αk,m [n] + αm,k [n] = 1.

(8)
(9)

Equation (9) ensures that there is only one GN at each
decoding order.
Similarly, the UAV received signal-to-interference-plusnoise (SINR) from the kth GN during the nth line segment
can be approximate to a constant, which is given by
γkN [n] = P

γ0 pk [n] |hk [n]|

2
2

αm,k [n] γ0 pm [n] |hm [n]| + 1
.

2
γ0 pk [n] ku [n]−wk k +H 2

.
.
=P
2
2 +1
α
[n]
γ
p
[n]
ku
[n]−w
k
+H
m,k
0
m
m
m∈K,m6=k
(10)
m∈K,m6=k

Let τ [n] denote the UAV allocated time resources for all GNs
at the nth line segment, where τ [n] ≤ T [n] , ∀n. Similarly,
the total data collection throughput from the kth GN during
the UAV flight for NOMA is given by
XN
XN

τ [n] log2 1+γkN [n] . (11)
rkN [n] =
QN
k =
n=1

n=1

Moreover,
the GNs’ energy constraints for NOMA are given
P
by N
τ
n=1 [n] pk [n] ≤ Ek , ∀k.
By jointly optimizing the UAV trajectory, {u [n] , T [n]},
the communication time allocation, {τ [n]}, the GN transmit
power, {pk [n]}, and the decoding order, {αk,m [n]}, the maxmin collection throughput optimization problem for NOMA
can be formulated as
max

{u[n],T [n],τ [n],pk [n],αk,m [n]}

min QN
k
∀k

s.t. u [1] = uI , u [N ] = uF ,
ku [n + 1] − u [n]k ≤ min (δ, Vmax T [n]) , ∀n,
XN
E [n] ≤ EU ,
n=1

(12a)
(12b)
(12c)
(12d)

5

XN

n=1

τ [n] pk [n] ≤ Ek , ∀k,

(12e)

0 ≤ τ [n] ≤ T [n] , ∀n,

(12f)

0 ≤ pk [n] ≤ Pmax , ∀n, k,
αk,m [n] + αm,k [n] = 1, ∀k 6= m ∈ K,

(12g)
(12h)

αk,m [n] ∈ {0, 1} , ∀k, m ∈ K,

(12i)

Both Problem (7) and (12) are non-convex problems due
to the non-convex objective function and constraints, where
optimization variables are highly-coupled. Moreover, the introduced binary variables for NOMA decoding orders make (12)
become a mixed integer non-convex optimization problem,
which is more challenging to solve. Note that there is no
standard method to efficiently obtain the globally optimal
solution for such problems. In the following, we develop
efficient algorithms to find a high quality suboptimal solution
with a polynomial time complexity, by employing AO method
and SCA technique.
III. P ROPOSED S OLUTION FOR OMA
To make Problem (7) tractable, we first introduce auxiliary
variables {θk [n], ∀n, k} and {ω [n] ≥ 0, ∀n} such that
!
γ0 pk [n]
2
, (13)
θk [n] = τk [n] Blog2 1 +
2
ku [n] − wk k + H 2
s
 21
2
4
s[n]
s[n]
4
 .
ω [n] =  T [n] +
−
(14)
4v04
2v02

Moreover, equation (14) is equivalent to
T [n]4
ω[n]

2

= ω[n]2 +

s[n]2
.
v02

(15)
O

min QO
k,
∀k

With the above introduced variables and define η =
Problem (7) can be rewritten as the following problem:
max

η O ,{u[n],T [n],τk [n],pk [n],θk [n],ω[n]}

s.t.

XN

n=1
2

P0

n=1

T [n]

4

2

(16a)

θk [n]2 ≥ η O , ∀k,

θk [n]
≤ log2
τk [n]
XN

ηO

1+

γ0 pk [n]
2

ku [n] − wk k + H 2
2

T [n] +

3s[n]
2 T [n]
Utip

!

!

(16b)
, ∀n, k,
(16c)

+ Pi
3

XN

n=1

ω [n]

XN s[n]
1
+ d0 ρsA
≤ EU ,
n=1 t[n]2
2
2

≤ ω[n] +

(16d)

2

ku [n + 1] − u [n]k
, ∀n,
v02

ω[n]
(7b), (7c), (7e) − (7h).

(16e)
(16f)

Proposition 1. Problems (16) and (7) are equivalent.
Proof. Without loss of optimality to Problem (16), constraints
(16c) and (16e) can be met with equality. Specifically, assume

that if any of constraints in (16c) is satisfied with strict inequality, then we can always increase the corresponding value
2
of θk [n] to make the constraint (16c) satisfied with equality
without decreasing the objective value. Furthermore, suppose
that (16e) are satisfied with strict inequality, we can always
reduce the corresponding value of ω [n] to make the constraint
(16e) satisfied with equality with other variables fixed, and at
the same time make the constraint (16d) still satisfied without
changing the objective value of (16). Therefore, Problems (16)
and (7) are equivalent.
Based on Proposition 1, we only need to focus on how
to solve Problem (16). As the first and third terms in (16d)
are the perspective of the convex quadratic function and the
convex cubic function on the set of real numbers, they are also
joint convex functions with respect to s [n] and T [n] since
the perspective operation preserves convexity [32, Page 89].
As a result, (16d) is a convex constraint. However, constraints
(7e), (16b), (16c), and (16e) are still non-convex, where the
optimization variables are high-coupled. In order to tackle
these highly-coupled non-convex constraints, by employing
the alternating optimization method, we decompose the original problem (16) into two subproblems in the following two
subsections.
A. Optimization with Fixed Transmit Power
For any given feasible GN transmit power, {pk [n]}, the
optimization problem can be written as
max

η O ,{u[n],T [n],τk [n],θk [n],ω[n]}

ηO

s.t. (7b), (7c), (7e) − (7f), (16b) − (16e).

(17a)
(17b)

Problem (17) is still a non-convex problem due to the nonconvex constraints (16b), (16c), and (16e). Fortunately, those
non-convex constraints can be handled by utilizing SCA technique. Specifically, to tackle the non-convex constraint (16b),
the left hand side (LHS) is a convex function with respect to
θk [n]. Since any convex functions are lower bounded by their
2
first-order Taylor expansion, the lower bound of θk [n] at a
l
given local point θk [n] can be expressed as

θk [n]2 ≥ θkl [n]2 + 2θkl [n] θk [n] − θkl [n] .
(18)

For the non-convex constraint (16c), the LHS is jointly
convex with respect to θk [n] and τk [n]. Though the right
hand side (RHS) is not concave with respect to u [n], it is
2
a convex function
 l with respect to ku [n] − wk k . With given
local points u [n] , the lower bound for the RHS of (16c)
can be expressed as
!
γ0 pk [n]
≥ Rklb [n]
log2 1 +
2
ku [n] − wk k + H 2
!
γ0 pk [n]
(19)
= log2 1 +
2
l
2
ku [n] − wk k + H


2
,
−ϕlk [n] ku [n] − wk k2 − ul [n] − wk

2 e)γ0 pk [n]
where ϕlk [n] = kul [n]−w k2 +H(log
.
2
(
)(kul [n]−wk k2 +H 2 +γ0 pk [n])
k
Similarly, to deal with the non-convex constraint (16e), the

6

RHS is the sum of two convex functions and the lower bound
is given by
2

2

ω[n] +

ku [n + 1] − u [n]k
≥ β lb [n] ,
v02

(20)

where
2


ul [n+1]−ul [n]
β [n] = ω [n] +ω [n] ω [n]−ω [n] −
v02
T
2
+ 2 ul [n+1]−ul [n] (u [n+1]−u [n]) .
v0
lb

l

2

l

l

By applying (18)-(20), Problem (17) is approximated as the
following optimization problem:
max

s.t.

η O ,{u[n],T [n],τk [n],θk [n],ω[n]}
XN 
2
θkl [n] + 2θkl [n] θk
n=1

ηO
[n] − θkl [n]

θk [n]2
≤ Rklb [n] , ∀k, n,
τk [n]
T [n]

(21a)


≥ η O , ∀k,
(21b)

By replacing these non-convex constraints with their lower
bounds, Problem (25) can be written as the following approximate optimization problem:
max

η O ,{T [n],τk [n],pk [n],θk [n],ω[n],εk [n]}

s.t.

lb
2 ≤ β [n] , ∀n,
ω[n]
(7b), (7c), (7e) − (7f), (16d).

(21d)
(21e)

Now, (21b) is a linear constraint, and (21c) and (21d) are
all convex constraints. Therefore, Problem (21) is a convex
problem, which can be efficiently solved by standard convex
optimization solvers such as CVX [33]. Due to the adoption of
the lower bounds in (18)-(20), any feasible solution of Problem
(21) must be also feasible for Problem (17), but the reverse
does not hold in general. This means the feasible set of problem (21) is a smaller convex set reduced from the original nonconvex feasible set of problem (17). Therefore, the obtained
objective value of Problem (21) in general provides a lower
bound of that of Problem (17).

Before solving this subproblem, we introduce additional
auxiliary variables {εk [n], ∀n, k} such that
εk [n]2 = τk [n] pk [n] , ∀n, k.

(22)

Thus, constraint (7e) can be equivalently expressed as the
following two constraints:
XN
2
εk [n] ≤ Ek , ∀k,
(23)
n=1

2

εk [n]
, ∀n, k.
τk [n]

(24)

For any given feasible UAV location, {u [n]}, Problem (16)
can be written as the following optimization problem:
η O ,{T [n],τk [n],pk [n],θk [n],ω[n],εk [n]}

XN

n=1



2

ηO

θkl [n] + 2θkl [n] θk [n] − θkl [n]

pk [n] ≤ χlb
k [n] , ∀n, k,
4

(27a)


≥ η O , ∀k,
(27b)
(27c)
2

 s[n]
2
≤ ω l [n] +2ω l [n] ω [n]−ω l [n] + 2 , ∀n,
v0
ω[n]
(27d)

T [n]

2

(7f) − (7h), (16c), (16d), (23).

(27e)

It can be verified that Problem (27) is a convex problem, which
can be efficiently solved by standard convex optimization
solvers such as CVX [33]. Similarly, the obtained objective
value obtained from Problem (27) serves a lower bound of
that of Problem (25) owing to the replacement of non-convex
terms with their lower bounds.
C. Overall Algorithm, Complexity, and Convergence

B. Optimization with Fixed UAV Locations

max


εlk [n]2
2εl [n]
εk [n]2
≥ χlb
+ lk
εk [n] − εlk [n]
k [n] =
l
τk [n]
τk [n]
τk [n]
(26)
2
l

εk [n]
l
− l 2 τk [n] − τk [n] , ∀n, k,
τk [n]

(21c)

4

pk [n] ≤

(16b), (16e), and (24). As described in the previous subsection,
we have already introduced how to deal with non-convex
constraints (16b) and (16e) with their lower bounds based on
the first-order Taylor expansion. Therefore, we only need to
concentrate on how to deal with the non-convex constraint
(24). Similarly, the RHS of (24) is jointly convex with respect
to
τk [n]. The lower bound with given local points
 lεk [n] and
εk [n] , τkl [n] can be expressed as

ηO

s.t. (7f) − (7h), (16b) − (16e), (23), (24).

(25a)
(25b)

Now, constraint (16c) is convex since the RHS is a concave
function with respect to pk [n]. However, Problem (25) is
still a non-convex problem due to the non-convex constraints

Based on the two subproblems in the previous subsections,
we propose an efficient algorithm to solve Problem (16) by
invoking AO method. Specifically, Problem (21) and (27) are
alternately solved. The obtained solutions in each iteration
are used as the input local points for the next iteration.
The details of the proposed algorithm for OMA are summarized in Algorithm 1. The complexity
of each subprob

lem with interior-point method are O (3N + 2N K)3.5 and


3.5
). Then, the total complexity for OMA
O (2N + 4N K)



O
O
denotes the num(5N + 6N K)3.5 , where Nite
is O Nite
ber of iterations needed for the convergence of Algorithm
1 [32].
Remark 2. Although Algorithm 1 is designed for solving
the optimization problem with OMA-II, it is also applied for
OMA-I with linear constraints: τk [n] = τj [n] , ∀k 6= j.
Next, we demonstrate the convergence of Algorithm 1.
The objective value
of Problem
(16)
is


 in thelth iteration

defined as η O ul [n] , T l [n] , τkl [n] , plk [n] . First,

7

Algorithm 1 Proposed AO-based Algorithm for Solving Problem (16)

Initialize feasible solutions u0 [n] , T 0 [n] , τk0 [n] , p0k [n]
to (16), l = 0.
1: repeat

2: Solve Problem (21) for given plk [n] , and denote the
 l+1
optimal solutions as u [n], T l+0.5 [n] , τkl+0.5 [n] .
3: Solve Problem (27) for given ul+1 [n] , and denote the

optimal solutions as pl+1
[n] , T l+1 [n] , τkl+1 [n] .
k
4: l = l + 1.
5: until the fractional increase of the objective value is below
a threshold ξ > 0.
for Problem (21) with given transmit power in step 2 of
Algorithm 1, we have





η O ul [n] , T l [n] , τkl [n] , plk [n]




(a) lb  l
= ηp u [n] , T l [n] , τkl [n] , plk [n]
(b)





≤ ηplb ul+1 [n] , T l+0.5 [n] , τkl+0.5 [n] , plk [n]
(c)





≤ η O ul+1 [n] , T l+0.5 [n] , τkl+0.5 [n] , plk [n] ,
(28)

where ηplb represents the objective value of Problem (21) with
fixed transmit power. (a) follows the fact that the first-order
Taylor expansions are tight at the given local points in Problem
(21); (b) holds since Problem (21) is solved optimally; (c)
holds due to the fact that the objective value of Problem (21)
serves the lower bound of that of (17). The inequality in (28)
suggests that the objective value of the original Problem (17) is
still non-decreasing after each iteration even if we only solve
the approximate Problem (21).
Similarly, for Problem (27) with given UAV location in step
3 of Algorithm 1, we have





[n] , plk [n]
η O ul+1 [n] , T l+0.5 [n] , tl+0.5
k





[n] , plk [n]
= ηulb ul+1 [n] , T l+0.5 [n] , tl+0.5
k





[n] , pl+1
[n]
≤ ηulb ul+1 [n] , T l+1 [n] , tl+1
k
k





[n] , pl+1
[n] ,
≤ η O ul+1 [n] , T l+1 [n] , tl+1
k
k
(29)
where ηulb represents the objective value of Problem (27) with
fixed UAV location.
As a result, based on (28) and (29), we obtain that





η O ul [n] , T l [n] , tlk [n] , plk [n]





[n] , pl+1
[n] .
≤ η O ul+1 [n] , T l+1 [n] , tl+1
k
k
(30)

Equation (30) means the objective value of Problem (16) is
non-decreasing after each iteration. Since the max-min UAV
data collection throughput is upper bounded by a finite value
due to the limited energy at the UAV and GNs, the proposed
algorithm is guaranteed to converge.

as described in the previous section. To deal with other
non-convexities of Problem (12), we first introduce auxiliary
variables {Sk [n]}, {Ik [n]}, {dk [n]}, and {θk [n]} such that
2

ku [n] − wk k + H 2
, ∀k, n,
(31)
γ0 pk [n]
X
−1
Ik [n] =
γ0 αm,k [n] pm [n] dm [n] + 1, ∀k, n,
Sk [n] =

m∈K,m6=k

(32)

2

dk [n] = ku [n] − wk k + H , ∀k, n,


1
2
, ∀k, n.
θk [n] = τ [n] Blog2 1 +
Sk [n] Ik [n]

(33)
(34)

Define η N = min QN
k , Problem (12) can be equivalently
∀k
rewritten as
ηN ,

s.t.

max

η
u[n],T [n],τ [n],pk [n],αk,m [n]
Sk [n],Ik [n],θk [n],ω[n],dk [n]

N

(35a)

XN

θk [n]2 ≥ η N , ∀k,


1
θk [n]
, ∀k, n,
≤ log2 1 +
τ [n]
Sk [n] Ik [n]

(35b)

Sk [n] ≥

ku [n] − wk k2 + H 2
, ∀k, n,
γ0 pk [n]

(35d)

Ik [n] ≥
X

γ0 αm,k [n] pm [n] dm [n]

n=1
2

m∈K,m6=k

−1

(35c)

+1, ∀k, n,
(35e)

2

2

dk [n] ≤ ku [n] − wk k + H , ∀k, n,
(35f)
!
2
X
XN
N
3s[n]
ω [n]
+ Pi
T [n] + 2
P0
n=1
n=1
Utip T [n]
3

XN s[n]
1
+ d0 ρsA
≤ EU ,
n=1 t[n]2
2

T [n]

4

2

2

≤ ω[n] +

(35g)

2

ku [n + 1] − u [n]k
, ∀n,
v02

ω[n]
(12b), (12c), (12e) − (12i).

(35h)
(35i)

The equivalence between (12) and (35) can be shown similarly
as Proposition 1. It is observed that Problem (35) has a
similar structure with Problem (16) except integer constraints.
Therefore, we still decompose (35) into several subproblems,
which are ease to handle.
A. Optimization with Fixed Transmit Power and Decoding
Order
For any given feasible GN transmit power, {pk [n]}, and
decoding orders, {ak,m [n]}, the optimization problem can be
written as
ηN ,

IV. P ROPOSED S OLUTION FOR NOMA
To solve the formulated optimization problem for NOMA,
we can use the same method to tackle the non-convex UAV energy constraint by introducing auxiliary variables {ω [n] ≥ 0},

2

max

η
u[n],T [n],τ [n],Sk [n]
Ik [n],θk [n],ω[n],dk [n]

N

s.t. (12b), (12c), (12e), (12f), (35b) − (35h).

(36a)
(36b)

Problem (36) is still non-convex owing to the non-convex
constraints (35b), (35c), (35f), and (35h). Specifically, (35b)

8

and (35h) can be handled as introduced in the previous section.
Before handling the non-convex constraint (35c), we first have
the following lemma.


1
Lemma 1. For x > 0 and y > 0, f (x, y) = log2 1 + xy
is a joint convex function with respect to x and y
Proof. Lemma 1 can be proved by showing the Hessian matrix
of function f (x, y) is positive semidefinite when x > 0 and
y > 0. As a result, f (x, y) is a convex function.
Based on Lemma 1, the RHS of (35c) is jointly convex
with respect to Sk [n] and Ik [n]. Thus, by applying the firstorder
explanation, the lower bound at given local points
 l Taylor
Sk [n] , Ikl [n] can be expressed as




1
1
log2 1+
≥ Rklb [n] = log2 1+ l
Sk [n] Ik [n]
Sk [n] Ikl [n]


(log2 e) Sk [n] − Skl [n]
(log2 e) Ik [n] − Ikl [n]
−
−
.
2
2
Skl [n] + Skl [n] Ikl [n]
Ikl [n] + Ikl [n] Skl [n]
(37)

s.t.

2

+2 ul [n] − wk

T

 (38)
u [n] − ul [n] .

Therefore, Problem (36) is approximated as the following
optimization problem:
max

η
u[n],T [n],τ [n],Sk [n]
ηN ,
Ik [n],θk [n],ω[n],dk [n]
s.t.

XN

n=1



N

θkl [n]2 + 2θkl [n] θk [n] − θkl [n]

2



(40b)

2

εk [n]
, ∀n, k,
τ [n]
(12f), (12g), (35b) − (35h).

(40c)
(40d)

By replacing those non-convex terms involved in Problem (40)
with their lower bounds, (40) is approximated as the following
problem
max

η
T [n],τ [n],pk [n],Sk [n]
ηN ,
Ik [n],θk [n],ω[n],ε[n],dk [n]
s.t.

XN

n=1



N

(41a)

θkl [n]2 + 2θkl [n] θk [n] − θkl [n]

2



≥ η N , ∀k,
(41b)

θk [n]
≤ Rklb [n] , ∀k, n,
τ [n]
pk [n] ≤ χlb
k [n] , ∀n, k,
T [n]
ω[n]

4

2

(41c)
(41d)


2

≤ ω l [n] +2ω l [n] ω [n]−ω l [n] +

2

s[n]
, ∀n,
v02
(41e)

(12f), (12g), (35d) − (35g).

(41f)

Here, the expression of χlb
k [n] is obtained by dropping the
index k of τkl [n] and τk [n] in (26). Then, Problem (41) is
a convex problem that can be efficiently solved by standard
convex optimization solvers such as CVX [33], and the optimal
objective value obtained from Problem (41) serves a lower
bound of that of Problem (40).
C. Decoding Order Design with Other Variables Fixed

≥ η N , ∀k,
(39b)

For any given feasible UAV trajectory, {u [n] , T [n]}, the
time allocation, {τ [n]}, and the GN transmit power, {pk [n]},
the optimization problem (35) is reduced to

(39c)
2

(39d)

(42a)

lb

2 ≤ β [n] , ∀n,
ω[n]
(12b), (12c), (12e), (12f), (35d), (35e), (35g).

(39e)
(39f)

Problem (39) is a convex problem that can be efficiently solved
by standard convex optimization solvers such as CVX [33].
The optimal objective value obtained from Problem (39)
provides a lower bound to that of Problem (36).
B. Optimization with Fixed UAV Locations and Decoding
Order
For any given feasible UAV location {u [n]} and decoding orders {ak,m [n]}, Problem (35) with auxiliary variables
{ε [n]} can be written as the following optimization problem
N

s.t.

XN

n=1

1
Sk [n] Ik [n]

(12h), (12i), (35e).

4

max
η

T [n],τ [n],pk [n],Sk [n]
Ik [n],θk [n],ω[n],ε[n],dk [n]

ηN

τ [n] log2 1 +

max

η N ,{ak,m [n],Ik [n]}

dk [n] ≤ H 2 + ul [n] − wk
T

u [n] − ul [n] ,
+2 ul [n] − wk

ηN ,

2

εk [n] ≤ Ek , ∀k,

(39a)

θk [n]
≤ Rklb [n] , ∀k, n,
τk [n]

T [n]

n=1

pk [n] ≤

Furthermore, for the non-convex constraints (35f), the RHS
is a convex function with respect to u [n]. The corresponding
lower bound at given local points ul [n] is expressed as
ku [n] − wk k2 ≥ ul [n] − wk

XN

(40a)



≥ η N , ∀k, (42b)
(42c)

Involving integer constraints (12i) and non-convex constraint
(42b), Problem (42) is a mixed integer non-convex optimization problem. The integer constraint (12i) can be equivalently
transformed into the following two constraints:

XK XK 
αk,m [n]2 − αk,m [n] ≥ 0,
(43)
k=1

m6=k

0 ≤ αk,m [n] ≤ 1, ∀k 6= m ∈ K.

(44)

Consequently, Problem (42) can be reformulated with continuous variables {αk,m [n]} as
max

η N ,{ak,m [n],Ik [n]}

ηN

s.t. (12h), (35e), (42b), (43), (44).

(45a)
(45b)

Though removing integer constraints, Problem (45) is still a
non-convex problem with non-convex constraints (42b) and

9

(43). Before handling Problem (45), we first have the following
theorem.
Theorem 1. For a sufficiently large constant value λ ≫ 1,
Problem (45) is equivalent to the following problem

XK XK 
2
αk,m [n] −αk,m [n]
max
η N+λ
k=1

η N ,{ak,m [n],Ik [n]}

m6=k

s.t. (12h), (35e), (42b), (44).

(46a)
(46b)

where λ represents a penalty factor to penalize the objective
function for any αk,m [n] that is not equal to 0 or 1.
Proof. See Appendix A.
To handle Problem (46), we only need to deal with the nonconvex objective function (46) and the non-convex constraint
(42b). The second term of (46) is a convex function with respect to αk,m [n]. By utilizing the first-order Taylor expansion
at a given local point αlk,m [n], the lower bound is expressed
as

2
2
αk,m[n] ≥ξk,m [n]=αlk,m[n] +2αlk,m [n] αk,m [n]−αlk,m [n] .
(47)
For the non-convex constraint (42b), the LHS is a convex
function with respect
 to Ik [n]. Similarly, the lower bound at
given local points Ikl [n] is expressed as


1
≥ µlb
log2 1 +
k [n]
Sk [n] Ik [n]



(log2 e) Ik [n] − Ikl [n]
1
= log2 1 +
− l
2 .
Sk [n] Ikl [n]
Ik [n] + Sk [n] Ikl [n]
(48)
Based on (47) and (48), Problem (46) can be approximated as
the following problem:
XK XK
(ξk,m [n]−αk,m [n])
max
η N +λ
k=1

η N ,{ak,m [n],Ik [n]}

m6=k

(49a)

s.t.

XN

n=1

N
τ [n]µlb
k [n] ≥ η , ∀k,

(12h), (35e), (42b), (44).

(49b)
(49c)

Problem (49) is a convex problem that can be solved efficiently
by standard convex program solvers such as CVX [33].
Specifically, we develop an iterative algorithm to optimize
the decoding orders for given UAV trajectory, time allocation,
and transmit power as summarized in Algorithm 2. Since the
application of lower bounds approximation, the obtained result
serves a lower bound of that of Problem (46).
D. Overall Algorithm, Complexity, and Convergence
Based on subproblems in the previous three subsections,
we propose an efficient iterative algorithm to solve Problem
(12) by invoking AO method. The details of the designed
algorithm for NOMA are summarized in Algorithm 3.
The complexity of each subproblem


with interior-point
3.5
3.5
,
, O (4N + 5N K)
method are O (4N + 4N K)



3.5
2
2
and O Nite
N K2 + N K
, respectively, where Nite

Algorithm 2 Proposed Penalty-based Algorithm for Solving
Problem (49)
n Initialize
o the penalty factor λ and feasible solutions
l
αk,m [n] to (46) with given {u [n] , T [n] , τ [n] , pk [n]},
l = 0.
1: repeat
n
o
2: Solve Problem (49) with αlk,m [n] , and denote optimal
n
o
solutions as αl+1
k,m [n] .
3: l = l + 1.
4: until the fractional increase of the objective value is below
a threshold ξ > 0.
Algorithm 3 Proposed AO-based Algorithm for Solving Problem (12)
n Initialize feasible solutions to (7) o
u0 [n] , T 0 [n] , τ 0 [n] , p0k [n] , α0k,m [n] . l = 0.
1: repeat
n
o
2: Solve Problem (39) for given
plk [n] , alk,m [n] ,
and
the
optimal
solutions
by
 l+1 denote
u [n] , T l+0.5 [n] , τ l+0.5 [n] . n
o
3:

4:

5:
6:

Solve Problem (41) for given ul+1 [n] , alk,m [n] ,
and
the
optimal
solutions
by
 l+1 denote
pk [n] , T l+1 [n] , τ l+1 [n] .
Solve
Problem
(49)
for
given
 l+1
u [n] , T l+1 [n] , τ l+1 [n] , pl+1
k n [n] via oAlgorithm 2.
Denote the optimal solutions by αl+1
k,m [n] .
l = l + 1.
until the fractional increase of the objective value is below
a threshold ξ > 0.

is the number of iterations required for the convergence of
Algorithm
 2. Therefore, the total complexity for NOMA
3.5 
3.5
2
N
,
N K2 + N K
(8N + 9N K) + Nite
is
O Nite
N
where Nite
is the iteration number of Algorithm 3 for
NOMA [32]. It can be seen that complexity of NOMA is
larger than that of OMA. The convergency of Algorithm 3
can be shown similarly as that of Algorithm 1. The details
are omitted for brevity.
V. N UMERICAL E XAMPLES
In this section, numerical examples are provided to evaluate
the performances of the proposed algorithms. In the simulations, we consider a UAV data collection system with K = 5
GNs, which are randomly and uniformly distributed in a square
area of 500 × 500 m2 . As the maximum allowed UAV height
in federal aviation authority (FAA) regulations is 122m, the
height of the UAV is fixed at H = 100 m to make the
A2G channel can be well approximated by the LoS channel
model. The UAV is assumed to fly from the initial location
T
T
(0, 0, 100) m to the final location (500, 500, 100) m. The
maximum UAV speed is Vmax = 30 m/s. For the rotary-wing
UAV propulsion power consumption model in (4), we set the
parameters as follows [15]: P0 = 79.86 W, Pi = 88.63 W,
Utip = 120 m/s, v0 = 4.03 m/s, d0 = 0.6, ρ = 1.225 kg/m3 ,
s = 0.05, A = 0.503 m2 . The received SNR at a reference
distance of 1 m is γ0 = 50 dB. The maximum transmit power

10

60

500

proposed OMA-I
proposed OMA-II
proposed NOMA

proposed OMA-I
proposed OMA-II
proposed NOMA

450

51.39s

50

GN 4

40.90s

350

40

GN 5
GN 2

300
30

y (m)

max-min throughput (bits/Hz)

400

EU = 30 KJ

30.95s
GN 3

250
200

19.70s

20

150

6.73s

100

10

EU =10 KJ

GN 1

50
0
0

5

10

15

20

25

0

30

0

50

100

150

200

iteration number

Fig. 2: Convergence of the proposed algorithms.

300

350

400

450

500

(a) EU = 8 KJ.
500

proposed OMA-I
proposed OMA-II
proposed NOMA

450

GN 4

144.11s

400
60.27s

350

GN 2

GN 5

300

y (m)

of GNs is set to Pmax = 0.1 W. We assume that all GNs have
identical storage energy, i.e., Ek = Es , ∀k. The algorithm
threshold ξ is set to 10−2 . The following results are obtained
based on one random GN deployment as illustrated in Fig. 3
via changing different parameters (e.g., UAV on-board energy
and GN storage energy).
In Fig. 2, we first study the convergence of Algorithm 1
and Algorithm 3 for OMA and NOMA
 cases with Es = 10
Joule (J). The initial UAV trajectory, u0 [n] , T 0 [n] , is set
to the straight flight from the initial location to the final
location with the maximum-range
 (MR) speed in [15]. For
OMA, the initial time allocation, τk0 [n] , and initial transmit

T 0 [n]
0
power, p0k [n] , are obtained
.P by letting
 τk [n] = K and
N
τ 0 [n] , ∀k, n. For NOMA,
p0k [n] = min Pmax , Es
 0n=1 k
the
transmit power,
 0initial time allocation, τ [n] ,0 and initial
0
pk [n]
,
are
obtained
by
letting
τ
[n]
=
T
[n]
and p0k [n] =
.P


N
0
min Pmax , Es
n=1 τ [n] , ∀k, n. We consider two cases
with EU = 10 KJ and EU = 30 KJ. From the figure, it
is observed that the max-min achievable throughput of three
schemes increase as the number of iterations increases. When
EU = 10 KJ, the proposed algorithm for three schemes
converges with around 10 iterations. When EU = 30 KJ, the
proposed algorithm converges with around 25 iterations.
In Fig. 3, we provide the optimized UAV trajectory for
different MA schemes with Es = 10 J and different EU . In
order to illustrate the variety of the instant UAV speed and
GNs’ transmit power shown in Fig. 4, Fig. 3 also presents
the time instant when the UAV is closest to each GN in the
OMA-II scheme. It is first observed from Fig. 3 that the
UAV tries to successively fly as close as possible to each
GN in both three schemes even with different EU . This is
expected since the considered max-min throughput objective
function makes the UAV need to collect data from each GN
in a fair manner. When the UAV on-board energy is small,
e.g., EU = 8 KJ, the obtained UAV paths and speeds for
three schemes are similar, as shown in Fig. 3(a) and Fig. 4(a).
Regarding GNs’ transmit power, GNs in all schemes tend to
transmit at Pmax as long as being waken up by the UAV.
This is because, in this case, Es is large enough compared
with the total available communication time. Note that GNs
transmit in a successive manner for OMA-II. This is because
the optimization of time resources allocation in OMA-II allows
the UAV to allocate all the communication time resources

250

x (m)

186.93s
GN 3

250
200

103.27s

150
100
19.91s
GN 1

50
0
0

50

100

150

200

250

300

350

400

450

500

x (m)

(b) EU = 30 KJ.

Fig. 3: The optimized UAV trajectories for differen MA schemes and
Es = 10 J.

to its nearest GN along the trajectory, thus collecting more
information bits. This phenomena can be also verified by
the time instant in Fig. 3 and the corresponding GN awake
state in Fig. 4. Though all GNs transmit at Pmax through the
whole UAV flight time in NOMA and OMA-I, the reasons
are different. For NOMA, all GNs are multiplexed in power
levels within the same time/frequency resources. As a result,
the UAV can not only wake up its nearest GNs but also other
GNs to collect more data. However, for OMA-I, as the time
resources are always equally allocated to GNs, GNs need to
stay awake throughout the whole time to upload more data to
the UAV.
In Fig. 3(b) and Fig. 4(b) for EU = 30 KJ, the UAV
in general successively flies to the top of each GN in both
schemes. It is observed that the UAV keeps flying around at
the top of GNs other than remaining static. The reason is that
the UAV will consume much higher energy to hover in the
air than flying around with a certain speed. Therefore, the
saved energy by flying around instead of hovering can prolong
the communication time and increase the achieved throughput.
Moreover, GNs in NOMA do not always keep awake when
EU = 30 KJ. This is expected since the UAV flight time for
EU = 30 KJ is rather large, the storage energy Es is not
enough to allow GNs to keep transmitting. As a result, the
UAV tends to wake up some of GNs to get full use of the
limited energy stored at each GN. For OMA-I with EU = 30
KJ, GNs still keep awake during the UAV flight time due to
the equal time allocation. It also causes the UAV for NOMA
and OMA-I in Fig. 3(b) flies a curve between two GNs instead

30

OMA-I

20

power (W)

40

NOMA

0
0

10
OMA-I GN 1

20

30

GN 2

GN 3

40

50

GN 4

GN 5

0.1
0.05
0
0

10

20

OMA-II GN 1

GN 2

30

40

GN 3

50

GN 4

GN 5

0.1
0.05
0
0

power (W)

OMA-II

10

Achievable max-min throughput (bits/Hz)

power (W)

speed (m/s)

11

10

20

NOMA GN 1

GN 2

30

40

GN 3

50

GN 4

GN 5

0.1

proposed OMA-I
proposed OMA-II
proposed NOMA
straight OMA-I
straight OMA-II
straight NOMA
FHC OMA-I
FHC OMA-II
FHC NOMA

35
30
25
20
15
10
5

OMA

0.05
0

0

0

10

20

30

40

8

50

10

12

40

0

power (W)

20

40

60

OMA-I GN 1

80
GN 2

100

120

GN 3

140

160

GN 4

180
GN 5

0.1

40

60

OMA-II GN 1

80
GN 2

100

120

GN 3

140

160

GN 4

180

200

GN 5

0.1
0.05
0
0

20

40

60

NOMA GN 1

80
GN 2

100

120

GN 3

140

160

GN 4

180

200

GN 5

0.1
0.05
0
0

20

40

60

80

100

120

140

160

180

35

30

25

20

15

10

200

time (s)

5
2

(b) EU = 30 KJ.

Fig. 4: The optimized speed of the UAV and transmit power of GNs
for differen MA schemes and Es = 10 J.

of a straight line for OMA-II since the UAV tends to maximize
the rate of all awake GNs while flying.
In Fig. 5, we provide the max-min throughput versus the
UAV on-board energy EU with Es = 10 J for different
MA schemes. For comparison, we consider the following
benchmark schemes:

•

20

proposed OMA-I
proposed OMA-II
proposed NOMA

200

0.05
0
20

18

NOMA

0

0

power (W)

OMA-II

10

Achievable max-min throughput (bits/Hz)

speed (m/s)
power (W)

OMA-I

20

16

Fig. 5: Max-min throughput versus the UAV on-board energy of
different schemes with Es = 10 J.

(a) EU = 8 KJ.
30

14

UAV on-board energy, E U (KJ)

time (s)

•

NOMA

Straight X: In this case, the UAV flies from uI to uF
in a straight line. The corresponding max-min achievable
throughput is obtained by solving Problem (16) and (35)
with additional linear constraints u (1, n) = u (2, n) , ∀n.
Meanwhile, X represents different MA schemes, such as
OMA-I, OMA-II, and NOMA.
FHC X: In this case, the UAV collects data from GNs
following from the fly-hover-communicate (FHC) protocol as did in [15]. The optimization problem becomes to
find the optimal hovering locations and the corresponding
resource allocations.

As illustrated, it is first observed that the max-min throughput
of all considered schemes increases with the increase of EU
since the UAV is able to collect more information bits from
GNs with a longer flight time. In particular, the performance
gain of the proposed scheme or the FHC scheme over the
scheme with a straight trajectory becomes more pronounced
as EU increases. This is because a larger value of EU allows
the UAV to fly closer to collect data from GNs, which also
validates the benefits of UAV trajectory design. It is also
observed that the proposed scheme outperforms the FHC
scheme. This is expected since the UAV would consumes

4

6

8

10

12

14

16

18

20

GN storage energy E s (J)

Fig. 6: Max-min throughput versus the GN storage energy with EU =
20 KJ.

more energy to hover in the air, which reduces the total UAV
flight time. Moreover, NOMA achieves a better performance
than OMA. The performance gain achieved by NOMA comes
from the multiplex of all GNs in power domain. Note that
OMA-I achieves the worst performance since the UAV needs
to allocate time resources equally to all GNs, which reduces
the throughput of GNs which have good channel conditions
(i.e., near from the UAV).
Fig. 6 presents the max-min throughput versus the GN
storage energy Es for different schemes with EU = 20 KJ.
From the figure, the max-min throughput of all schemes
improves with the increase of Es at first and remains
unchanged. This is because, for a given EU , the UAV can
allocate more time to GNs for uploading information when
Es is limited. The max-min throughput remains unchanged
until all the UAV flight time is occupied for GNs uploading
data with Pmax . In this case, the increase of Es has no
effect on the obtained max-min throughput since the total
energy consumption of GNs is fixed. It is also shown that
NOMA always achieves equal or higher max-min throughput
than OMA-II. The performance gain of NOMA over OMA
becomes more pronounced as Es increases.

VI. C ONCLUSIONS
In this paper, energy-constrained UAV data collection systems have been investigated with the employment of both
OMA and NOMA transmission. The optimization problems

12

for maximization the minimum UAV data collection throughput from all GNs were formulated for the two MA schemes.
To solve the resulting non-convex problems, two efficient
AO-based algorithms were proposed. For OMA, the original problem was decomposed into two subproblems, which
were alternatively solved by applying SCA technique. For
NOMA, a penalty-based algorithm was developed to solve the
decoding order design subproblem, while other subproblems
were solved using SCA technique. Numerical results verified
the effectiveness of the proposed designs compared with
other benchmark schemes, and demonstrated that the max-min
throughput obtained by NOMA is always larger than or equal
to OMA. Note that only one UAV with fixed flying altitude
was assumed in this paper, some promising future research
directions are to consider the case of multiple UAVs and the
optimization of 3D UAV trajectory.
A PPENDIX A: P ROOF

OF

T HEOREM 1

First, the partial Lagrange function of Problem (45) can be
expressed as
X


 N
K XK
2
N
αk,m [n] −αk,m [n] ,
L η , A, I, λ = η +λ
k=1

m6=k

(50)

where A = {αk,m [n] , ∀k 6= m ∈ K, n ∈ N }, I =
{Ik [n] , ∀k ∈ K, n ∈ N } and λ is the non-negative Lagrange
multiplier associated with the constraint (43). Therefore, the
dual problem of Problem (45) is

min
max
L η N , A, I, λ = min ψ (λ) ,
(51)
λ≥0 (η N ,A,I)∈D

λ≥0

where D is the feasible set spanned by constraints (12h),
 (35e),
(42b) and (44) and ψ (λ) = max
L η N , A, I, λ .
(η N ,A,I)∈D

Moreover, the primal optimization problem (45) can be
equivalently expressed as

p∗ = max
min L η N , A, I, λ .
(52)
(η N ,A,I)∈D λ≥0

Due to the weak duality [32], we have the following inequalities:

min ψ (λ) = min
max
L η N , A, I, λ
N
λ≥0
λ≥0 (η ,A,I)∈D

(53)
≥ max
min L η N , A, I, λ = p∗ .
(η N ,A,I)∈D λ≥0


PK PK 
2
It is noted that k=1 m6=k αk,m [n] − αk,m [n] ≤ 0 for

any A ∈ D. Thus, L η N , A, I,
λ is a decreasing function

with respect to λ for η N , A, I ∈ D, which means ψ (λ) is
bounded from below by the optimal value of Problem (45).
Assume that the optimalsolutions to the dual problem (51)
are λ∗ and η N ∗ , A∗ , I∗ . In the following, we discuss the
optimal value of the dual problem (51) and the equivalent
primal problem (52) in two cases. 

P
PK
2
∗
∗
First, suppose that K
k=1
m6=k αk,m [n] − αk,m [n] =

0. Since η N ∗ , A∗ , I∗ are also feasible to Problem (52), we
have the following inequalities:

(54)
p∗ ≥ η N ∗ = L η N ∗ , A∗ , I∗ , λ∗ = ψ (λ∗ ) .

Based on (53) and (54), we have
max

(η N ,A,I)∈D

min L η N , A, I, λ
λ≥0

= min

max

λ≥0 (η N ,A,I)∈D




L η N , A, I, λ ,

(55)

which implies the strong duality between the equivalent primal problem (52) and the dual problem
(51) holds when

PK PK
2
= 0. Recall from that
m6=k αk,m [n] − αk,m [n]
k=1

L η N , A, I, λ is a decreasing function with respect to λ, we
have
ψ (λ) = p∗ , ∀λ ≥ λ∗ .
(56)


PK PK
2
∗
∗
Second, when
< 0,
k=1
m6=k αk,m [n] − αk,m [n]
∗
ψ (λ ) = min ψ (λ) → −∞ due to the monotone decreasing
λ≥0

of ψ (λ) with respect to λ. This contradicts the inequality in
(53) since p∗ is a finite value.

PK PK 
2
Above all, k=1 m6=k α∗k,m [n] − α∗k,m [n] = 0 must
hold at the optimal solution and the proof of Theorem 1 is
completed.
R EFERENCES
[1] Y. Zeng, R. Zhang, and T. J. Lim, “Wireless communications with
unmanned aerial vehicles: opportunities and challenges,” IEEE Commun.
Mag., vol. 54, no. 5, pp. 36–42, 2016.
[2] M. Mozaffari, W. Saad, M. Bennis, Y. Nam, and M. Debbah, “A tutorial
on UAVs for wireless networks: Applications, challenges, and open
problems,” IEEE Commun. Surv. Tut., vol. 21, no. 3, p. 2334–2360,
2019.
[3] Y. Zeng, Q. Wu, and R. Zhang, “Accessing from the sky: A tutorial on
uav communications for 5G and beyond,” Proc. IEEE, vol. 107, no. 12,
pp. 2327–2375, 2019.
[4] N. H. Motlagh, M. Bagaa, and T. Taleb, “UAV-based IoT platform: A
crowd surveillance use case,” IEEE Commun. Mag., vol. 55, no. 2, pp.
128–134, 2017.
[5] A. Al-Hourani, S. Kandeepan, and A. Jamalipour, “Modeling air-toground path loss for low altitude platforms in urban environments,” in
Proc. IEEE Global Commun. Conf. (GLOBECOM), 2014, pp. 2898–
2904.
[6] Y. Liu, Z. Qin, M. Elkashlan, Z. Ding, A. Nallanathan, and L. Hanzo,
“Nonorthogonal multiple access for 5G and beyond,” Proc. IEEE, vol.
105, no. 12, pp. 2347–2381, 2017.
[7] Y. Cai, Z. Qin, F. Cui, G. Y. Li, and J. A. McCann, “Modulation and
multiple access for 5G networks,” IEEE Commun. Surv. Tut., vol. 20,
no. 1, pp. 629–646, 2018.
[8] A. Al-Hourani, S. Kandeepan, and S. Lardner, “Optimal LAP altitude
for maximum coverage,” IEEE Wireless Commun. Lett., vol. 3, no. 6,
pp. 569–572, 2014.
[9] M. Mozaffari, W. Saad, M. Bennis, and M. Debbah, “Efficient deployment of multiple unmanned aerial vehicles for optimal wireless
coverage,” IEEE Wireless Commun. Lett., vol. 20, no. 8, pp. 1647–1650,
2016.
[10] J. Lyu, Y. Zeng, R. Zhang, and T. J. Lim, “Placement optimization
of UAV-mounted mobile base stations,” IEEE Wireless Commun. Lett.,
vol. 21, no. 3, pp. 604–607, 2017.
[11] M. Mozaffari, W. Saad, M. Bennis, and M. Debbah, “Unmanned aerial
vehicle with underlaid device-to-device communications: Performance
and tradeoffs,” IEEE Trans. Wireless Commun., vol. 15, no. 6, pp. 3949–
3963, 2016.
[12] Q. Wu, Y. Zeng, and R. Zhang, “Joint trajectory and communication
design for multi-UAV enabled wireless networks,” IEEE Trans. Wireless
Commun., vol. 17, no. 3, pp. 2109–2121, 2018.
[13] Y. Cai, F. Cui, Q. Shi, M. Zhao, and G. Y. Li, “Dual-UAV-enabled secure
communications: Joint trajectory design and user scheduling,” IEEE J.
Sel. Areas Commun., vol. 36, no. 9, pp. 1972–1985, 2018.
[14] C. You and R. Zhang, “3D trajectory optimization in rician fading for
UAV-enabled data harvesting,” IEEE Trans. Wireless Commun., vol. 18,
no. 6, pp. 3192–3207, 2019.

13

[15] Y. Zeng, J. Xu, and R. Zhang, “Energy minimization for wireless
communication with rotary-wing UAV,” IEEE Trans. Wireless Commun.,
vol. 18, no. 4, pp. 2329–2345, 2019.
[16] J. Gong, T. Chang, C. Shen, and X. Chen, “Flight time minimization
of UAV for data collection over wireless sensor networks,” IEEE J. Sel.
Areas Commun., vol. 36, no. 9, pp. 1942–1954, 2018.
[17] C. Zhan and H. Lai, “Energy minimization in Internet-of-Things system
based on rotary-wing UAV,” IEEE Wireless Commun. Lett., vol. 8, no. 5,
pp. 1341–1344, 2019.
[18] Y. Sun, D. Xu, D. W. K. Ng, L. Dai, and R. Schober, “Optimal
3D-trajectory design and resource allocation for solar-powered UAV
communication systems,” IEEE Trans. Commun., vol. 67, no. 6, pp.
4281–4298, 2019.
[19] Y. Liu, Z. Qin, Y. Cai, Y. Gao, G. Y. Li, and A. Nallanathan, “UAV communications based on non-orthogonal multiple access,” IEEE Wireless
Commun., vol. 26, no. 1, pp. 52–57, 2019.
[20] M. F. Sohail, C. Y. Leow, and S. Won, “Non-orthogonal multiple access
for unmanned aerial vehicle assisted communication,” IEEE Access,
vol. 6, pp. 22 716–22 727, 2018.
[21] T. Hou, Y. Liu, Z. Song, X. Sun, and Y. Chen, “Multiple antenna
aided NOMA in UAV networks: A stochastic geometry approach,” IEEE
Trans. Commun., vol. 67, no. 2, pp. 1031–1044, 2019.
[22] W. Mei and R. Zhang, “Uplink cooperative NOMA for cellularconnected UAV,” IEEE J. Sel. Topics Signal Process., vol. 13, no. 3,
pp. 644–656, 2019.
[23] R. Duan, J. Wang, C. Jiang, H. Yao, Y. Ren, and Y. Qian, “Resource allocation for multi-UAV aided IoT NOMA uplink transmission systems,”
IEEE Internet Things J., vol. 6, no. 4, pp. 7025–7037, 2019.
[24] F. Cui, Y. Cai, Z. Qin, M. Zhao, and G. Y. Li, “Multiple access for
mobile-UAV enabled networks: Joint trajectory design and resource
allocation,” IEEE Trans. Commun., vol. 67, no. 7, pp. 4980–4994, 2019.
[25] N. Zhao, X. Pang, Z. Li, Y. Chen, F. Li, Z. Ding, and M. Alouini,
“Joint trajectory and precoding optimization for UAV-assisted NOMA
networks,” IEEE Trans. Commun., vol. 67, no. 5, pp. 3723–3735, 2019.
[26] X. Mu, Y. Liu, L. Guo, and J. Lin, “Non-orthogonal multiple access for
air-to-ground communication,” IEEE Trans. Commun., vol. 68, no. 5,
pp. 2934–2949, 2020.
[27] 3GPP-TR-36.777, “Study on enhanced LTE support for aerial vehicles,” 2017, 3GPP technical report.[Online]. Available:www.3gpp.org/
dynareport/36777.htm.
[28] D. W. Matolak and R. Sun, “Air–ground channel characterization for
unmanned aircraft systems-part III: The suburban and near-urban environments,” IEEE Trans. Veh. Technol., vol. 66, no. 8, pp. 6607–6618,
2017.
[29] U. Mengali and A. N. D’Andrea, Synchronization Techniques for Digital
Receivers. New York, NY, USA: Springer, 1997.
[30] R. Ratasuk, N. Mangalvedhe, Z. Xiong, M. Robert, and D. Bhatoolaul,
“Enhancements of narrowband IoT in 3GPP Rel-14 and Rel-15,” in Proc.
IEEE Conf. Stand. Commun. Netw. (CSCN), 2017, pp. 60–65.
[31] Z. Chen, Z. Ding, X. Dai, and R. Zhang, “An optimization perspective
of the superiority of NOMA compared to conventional OMA,” IEEE
Trans. Signal Process, vol. 65, no. 19, pp. 5191–5202, 2017.
[32] S. Boyd and L. Vandenberghe, Convex Optimization. Cambridge, U.K.:
Cambridge Univ. Press, 2004.
[33] M. Grant and S. Boyd, “CVX: Matlab software for disciplined convex
programming, version 2.1,” [Online]. Available:http://cvxr.com/cvx, Mar
2014.

