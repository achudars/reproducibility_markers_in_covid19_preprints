UNCONDITIONAL POSITIVITY-PRESERVING AND ENERGY STABLE
SCHEMES FOR A REDUCED POISSON-NERNST-PLANCK SYSTEM

arXiv:1909.13161v1 [math.NA] 28 Sep 2019

HAILIANG LIU AND WUMAIER MAIMAITIYIMING
Abstract. The Poisson-Nernst-Planck (PNP) system is a widely accepted model for simulation of
ionic channels. In this paper, we design, analyze, and numerically validate a second order unconditional positivity-preserving scheme for solving a reduced PNP system, which can well approximate
the three dimensional ion channel problem. Positivity of numerical solutions is proven to hold true
independent of the size of time steps and the choice of the Poisson solver. The scheme is easy to
implement without resorting to any iteration method. Several numerical examples further confirm
the positivity-preserving property, and demonstrate the accuracy, efficiency, and robustness of the
proposed scheme, as well as the fast approach to steady states.

1. Introduction
Biological cells exchange chemicals and electric charge with their environments through ionic
channels in the cell membrane walls. Examples include signaling in the nervous system and coordination of muscle contraction, see [6] for a comprehensive introduction. Mathematically the
flow of ions can be modeled by drift-diffusion equations such as the Poisson-Nernst-Planck (PNP)
system, see e.g. [5, 7, 8, 12].
In this investigation we design, analyze and numerically validate positivity-preserving algorithms
to solve time-dependent drift-diffusion equations. As a first step, in this paper we focus on a reduced
model derived by Gardner et al [12] as an approximation to the full three dimensional (3D) PNP
system. Let us first recall the full model and its reduction.
1.1. Mathematical models. The general setup in [12] is a flow of positive and negative ions in
water in a channel plus surrounding baths in an electric field against a background of charged
atoms on the channel protein. The distribution of charges is described by continuum particle
densities ci (x, t) for the mobile ions (such as K + , Na+ , Ca++ , ¬∑ ¬∑ ¬∑ ). The flow of ions can be modeled
by the PNP system of m equations
‚àÇt ci = ‚àí‚àá ¬∑ Ji ,

i = 1, ¬∑ ¬∑ ¬∑ , m; x ‚àà ‚Ñ¶ ‚äÇ R3 , t > 0,

Ji = ‚àí(Di ‚àáci + zi ¬µi ci ‚àáœà),
‚àí‚àá ¬∑ (‚àáœà) =

m
X

(1.1)

qi ci ‚àí eœÅ,

i=1

where Ji is the flux density, in which Di is the diffusion coefficient, ¬µi the mobility coefficient
which is related to the diffusion coefficient via Einstein‚Äôs relation ¬µi = kBDTi 0 , where kB is the
1991 Mathematics Subject Classification. 65N08, 65N12, 92C35.
Key words and phrases. Biological channels, diffusion models, ion transport, positivity.
1

2

HAILIANG LIU AND WUMAIER MAIMAITIYIMING

Boltzmann constant and T0 is the absolute temperature [6]. In the Poisson equation,  is the
dielectric coefficient, qi the ionic charge for each ion species i, œÅ = œÅ(x) the permanent fixed charge
density, and e the proton charge. The coupling parameter zi = qi /e. In general, the physical
parameters , ¬µi and Di are functions of x. Let us mention that the case of no permanent charge
does not pertain to biological channels. Even channels without permanent charge (in the form
of so called acid and base side chains) have large amounts of fixed charge in their (for example)
carbonyl bonds( see, e.g., [17] and references therein).
The derivation of the Nernst-Planck equation typically follows two steps, namely, using the
energy variation to obtain the chemical potential and then using Fick‚Äôs laws of diffusion to attain
the Nernst-Planck equation (see e.g. [2]). In the charge dynamics modeled by the traditional
NP equation, mobile ions are treated as volume-less point charges. In order to incorporate more
complex effects such as short-range steric effect and long range Coulomb correlation, modifications
of the PNP equations were derived ( see, e.g., [24] and references therein). Nonetheless, the scheme
methodology proposed in this paper can well be adapted to solve such modified PNP systems.
The 3D geometry of the ion channel can be approximated by a reduced problem along the axial
direction x, with a cross-sectional area A(x) [30, 31]. Subject to a further rescaling as in [13], the
corresponding PNP system (1.1) reduces to the following equations
1
‚àÇx (A(x)Di (‚àÇx ci + zi ci ‚àÇx œà)),
A(x)
m
X
1
‚àí
‚àÇx (A(x)‚àÇx œà) =
zi ci ‚àí œÅ(x), x ‚àà ‚Ñ¶, t > 0.
A(x)
i=1
‚àÇt ci =

x ‚àà ‚Ñ¶ = [0, 1],

t > 0,
(1.2)

For ionic channels, an important characteristic is the so-called current-voltage relation, which can
characterize permeation and selectivity properties of ionic channels (see [1] and references therein).
P
For (1.1), the electric current density (charge flux) is J = m
i=1 qi Ji . Such quantity for (1.2) reduces
to
m
X
J =‚àí
zi Di A(x)(‚àÇx ci + zi ci ‚àÇx œà).
(1.3)
i=1

System (1.2) is a parabolic/elliptic system of partial differential equations, boundary conditions
for both ci and œà can be Dirichlet or Neumann.
In order to solve the above reduced system, we consider initial data
ci (x, 0) = cin
i (x) ‚â• 0,

x ‚àà ‚Ñ¶.

1.2. Boundary conditions and model properties. We consider two types of boundary conditions. The first is the Dirichlet boundary condition,
ci (0, t) = ci,l ,

ci (1, t) = ci,r ;

œà(0, t) = 0, œà(1, t) = V,

t > 0,

(1.4)

where ci,l , ci,r are non-negative constants, and V is a given constant. This is the setting adopted
in [12]. One important solution property is
ci (x, t) ‚â• 0,

x ‚àà ‚Ñ¶, t > 0.

(1.5)

POSITIVITY-PRESERVING SCHEMES FOR REDUCED PNP SYSTEM

3

Another set of boundary conditions is as follows:
‚àÇx ci + zi ci ‚àÇx œà = 0,

x = 0, 1,

(‚àíŒ∑‚àÇx œà + œà)|x=0 = œà‚àí ,

t > 0,

(Œ∑‚àÇx œà + œà)|x=1 = œà+ ,

t > 0,

(1.6)

where œà‚àí , œà+ are given constants, the size of parameter Œ∑ depends on the properties of the surrounding membrane [10]. Here the first one is the zero-flux boundary condition for the transport
equation, and the second is the Robin boundary condition for the Poisson equation. Such boundary condition is adopted in [10] to model the effects of partially removing the potential from the
ends of the channel. For system (1.2) with this boundary condition, solutions have non-negativity,
mass conservation, and free energy dissipation properties, i.e., (1.5),
Z
Z
A(x)ci (x, t)dx =
A(x)cin
t > 0, i = 1, ¬∑ ¬∑ ¬∑ , m, and
(1.7)
i (x)dx,
‚Ñ¶

‚Ñ¶

dE
=‚àí
dt

Z X
m

A(x)Di ci |‚àÇx (log ci + zi œà)|2 dx ‚â§ 0,

(1.8)

‚Ñ¶ i=1

where the total energy E associated to (1.2) is defined (see [10]) by
X

Z
m
m
1 X

E=
A(x)
ci log ci + (
zi ci ‚àí œÅ)œà dx + (œà+ A(1)œà(1) + œà‚àí A(0)œà(0)).
2 i=1
2Œ∑
‚Ñ¶
i=1

(1.9)

The positivity-preserving property is of special importance, since negative values in density would
violate the physical meaning of the solution and may destroy the energy dissipation law (1.8). Numerical techniques addressing the positivity preserving property have been introduced in various
application problems, see e.g. [18, 26]. In this paper, we construct second order accurate unconditional positivity-preserving schemes for solving (1.2) subject to two types of boundary conditions.
For the zero-flux boundary condition, the schemes will be shown to satisfy mass conservation and
a discrete energy dissipation law.
1.3. Related works. Numerical methods for solving the PNP system of equations have been
studied extensively; see e.g., [12, 14, 16, 19, 33]. We also refer to [4] for a review on the PNP
model and its generalizations for ion channel charge transport.
For the reduced PNP system (1.2), the finite difference scheme with TR‚ÄìBDF2 time integration
was first pursued in [12] to simulate an ionic channel. For the one dimensional PNP system, the
second order implicit finite difference scheme proposed in [10] can preserve total concentration of
ions with the aid of a special boundary discretization, but numerical solutions may not be positive
or energy dissipating. An improved scheme, further introduced in [11], can preserve a discrete
form of energy dissipation law up to O(œÑ 2 + h2 ), where œÑ is the time step, and h is the spatial
mesh size. In [3] the authors proposed an adaptive conservative finite volume method on a moving
mesh that maintains solution positivity. The second oder finite difference scheme in [22] is explicit
and shown to preserve positivity, mass conservation, and energy dissipation, while the positivitypreserving property is ensured if œÑ = O(h2 ). Further extension in [23] is a free energy satisfying
discontinuous Galerkin scheme of any high order, where positivity-preserving property is realized
by limiting techniques. The finite element scheme obtained by the method of lines approach in

4

HAILIANG LIU AND WUMAIER MAIMAITIYIMING

[27] preserves positivity of the solutions and a discrete energy dissipation law. Recently in [15]
the authors presented a fully implicit finite difference method where both positivity and energy
decay are preserved. In their scheme a fixed point iteration is needed for solving the resulting
nonlinear system. These schemes are either explicit or fully implicit in time, the former require a
time step restriction for preserving the desired properties while the later preserve desired properties
unconditionally but they had to be solved by some iterative solvers.
In this paper we design schemes to preserve all three desired properties of solution: positivity,
mass conservation, and energy dissipation, by following [20], in which a second order finite-volume
method was constructed for the class of nonlinear nonlocal equations
‚àÇt c = ‚àá ¬∑ (‚àác + c‚àá(V (x) + W ‚àó c)).

(1.10)

The key ingredients include a reformulation of the equation in its non-logarithmic Landau form and
the use of the implicit-explicit time discretization, these together ensure the positivity-preserving
property without any restriction on the size of time steps (unconditional!) and do not require
iterative solvers.
1.4. Contributions and organization of the paper. Our scheme construction is based on the
reformulation
A(x)‚àÇt ci (x, t) = ‚àÇx (A(x)Di e‚àízi œà(x,t) ‚àÇx (ci (x, t)ezi œà(x,t) )),

(1.11)

of the transport equation in (1.2). Similar formulation has been used in [20] and in earlier works
[21, 22]. Following [20], we adopt a semi-implicit time discretization of (1.11):

cn+1
(x) ‚àí cni (x)
n
n
i
A(x)
= ‚àÇx A(x)Di e‚àízi œà (x) ‚àÇx (cn+1
(x)ezi œà (x) ) .
i
œÑ

(1.12)

The feature of such discretization is that it is a linear equation in cn+1
(x), and easy to solve
i
numerically. For spatial discretization, we use the central finite volume approach. The coefficient
matrix of the resulting linear system is an M-matrix and right hand side is a nonnegative vector,
thus positivity of the solution is ensured without any time step restriction.
The main contribution in this paper includes the model reformulation, proofs of unconditional
positivity-preserving properties for two types of boundary conditions, and of mass conservation and
energy dissipation properties for zero flux boundary conditions (1.6). In addition, the positivitypreserving property is shown to be independent of the choice of Poisson solvers. Our implicitexplicit scheme is easy to implement and efficient in computing numerical solutions over long
time.
The paper is organized as follows. In section 2, we derive our numerical scheme for a model
equation. Theoretical analysis of unconditional positivity is provided. In section 3, we formulate
our scheme to the PNP system and prove positivity, mass conservation and energy dissipation
properties of the scheme. Numerical examples are presented in section 4. Finally, concluding
remarks are given in section 5.

POSITIVITY-PRESERVING SCHEMES FOR REDUCED PNP SYSTEM

5

2. Numerical methods for a model equation
In this section, we first demonstrate the key ideas through a model problem. Let u(x, t) be an
unknown density, satisfying
A(x)‚àÇt u(x, t) = ‚àÇx (B(x)(‚àÇx u(x, t) ‚àí u(x, t)‚àÇx œÜ(x, t))),
u(x, 0) = uin (x),

x ‚àà ‚Ñ¶ = [0, 1],

t > 0,
(2.1)

x ‚àà ‚Ñ¶,

where A(x) > 0, B(x) > 0 are given functions, and œÜ(x, t) is either known or can be obtained from
solving another coupled equation. For this model problem, we consider two types of boundary
conditions:
(i) the Dirichlet boundary condition
u(0, t) = ul ,

u(1, t) = ur ,

t > 0,

(2.2)

and (ii) the zero flux boundary condition
‚àÇx u(x, t) ‚àí u(x, t)‚àÇx œÜ(x, t) = 0,

x = 0, 1,

t > 0.

(2.3)

2.1. Scheme formulation. Let N be an integer, and the domain ‚Ñ¶ = [0, 1] be partitioned into
computational cells Ij = [xj‚àí1/2 , xj+1/2 ] with cell center xj = xj‚àí1/2 + 21 h, for j ‚àà {1, 2, ¬∑ ¬∑ ¬∑ , N },
x1/2 = 0 and xN +1/2 = 1. For simplicity, uniform mesh size h = N1 is adopted. Discretize t
uniformly as tn = œÑ n, where œÑ is time step.
From the reformulation
A(x)‚àÇt u(x, t) = ‚àÇx (B(x)eœÜ(x,t) ‚àÇx (u(x, t)e‚àíœÜ(x,t) ))

(2.4)

of (2.1), we consider a semi-implicit time discretization as follows:

un+1 (x) ‚àí un (x)
n
n
= ‚àÇx B(x)eœÜ (x) ‚àÇx (un+1 (x)e‚àíœÜ (x) ) ,
(2.5)
œÑ
R
R
where un (x) ‚âà u(x, tn ), œÜn (x) ‚âà œÜ(x, tn ). Let unj ‚âà h1 Ij un (x)dx, and Aj = h1 Ij A(x)dx, then a
fully-discrete scheme of (2.5) can be given by
A(x)

Aj

un+1
‚àí unj
Uj+1/2 ‚àí Uj‚àí1/2
j
=
,
œÑ
h

(2.6)

where the flux on interior interfaces are defined by
n+1 ‚àíœÜn
e j+1
uj+1
œÜn
j+1/2

Uj+1/2 = Bj+1/2 e

n

‚àí un+1
e‚àíœÜj
j
,
h

j = 1, 2, ¬∑ ¬∑ ¬∑ , N ‚àí 1.

Here Bj+1/2 = B(xj+1/2 ); For œÜnj+1/2 we either use œÜ(xj+1/2 , tn ) if œÜ(x, t) is given, or
œÜnj+1/2 =

œÜnj + œÜnj+1
,
2

where œÜnj is a numerical approximation of œÜ(xj , tn ).

(2.7)

6

HAILIANG LIU AND WUMAIER MAIMAITIYIMING

The boundary fluxes are given as follows:
(i) for the Dirichlet boundary condition (2.2)
U1/2
UN +1/2

n

‚àí ul e‚àíœÜ1/2 )
= B1/2 e
,
h
n
‚àíœÜn
N +1/2 ‚àí un+1 e‚àíœÜN )
2(u
e
r
œÜn
N
N
+1/2
= BN +1/2 e
;
h
n
2(un+1
e‚àíœÜ1
œÜn
1
1/2

(2.8)

(ii) for the zero flux boundary condition (2.3),
U1/2 = UN +1/2 = 0.
In either case, the initial data are determined by
Z
1
0
uj =
uin (x)dx,
h Ij

(2.9)

j = 1, ¬∑ ¬∑ ¬∑ , N.

Before turning to the analysis of solution properties, we comment on these boundary fluxes.
Remark 2.1. The factor 2 in the boundary flux (2.8) suffices to ensure the first order accuracy in
the approximation of
B(x)eœÜ(x,t) ‚àÇx (u(x, t)e‚àíœÜ(x,t) )
at the boundary; see [9]. However, the following flux without the factor 2, i.e.
U1/2
UN +1/2

n

‚àí ul e‚àíœÜ1/2 )
= B1/2 e
,
h
n
‚àíœÜn
N +1/2 ‚àí un+1 e‚àíœÜN )
(u
e
r
œÜn
N
N
+1/2
= BN +1/2 e
,
h
n
(un+1
e‚àíœÜ1
œÜn
1
1/2

(2.10)

can produce only a zeroth order approximation at the boundary. Order loss of accuracy has been
observed in our numerical tests when (2.10) is used.
An alternative boundary flux for (i) is a second order approximation of the form
U1/2
UN +1/2

n

+ 3un+1
e‚àíœÜ1 ‚àí 38 ul e‚àíœÜ1/2
1
,
= B1/2 e
h
n
1 n+1 ‚àíœÜn
8
‚àíœÜn
N +
u
e N ‚àí1 ‚àí 3un+1
u e‚àíœÜN +1/2
œÜn
N e
3 N ‚àí1
3 r
N
+1/2
= BN +1/2 e
.
h
n
e‚àíœÜ2
‚àí 13 un+1
œÜn
2
1/2

n

(2.11)

However, it is known that the first order boundary flux does not destroy the second order accuracy
of the scheme, we refer to [32] for a such result regarding the Shortley-Weller method. Hence
throughout the paper, we will not discuss high order boundary fluxes such as (2.11).
2.2. Positivity. It turns out that both schemes, (2.6)-(2.7)-(2.8) and (2.6)-(2.7)-(2.9), preserve
positivity of numerical solutions without any time step restriction.
Theorem 2.1. Scheme (2.6)-(2.7) with either (i) (2.8) and ul ‚â• 0, ur ‚â• 0, or (ii) (2.9), is positivitypreserving, in the sense that if unj ‚â• 0 for all j = 1, ¬∑ ¬∑ ¬∑ , N , then
un+1
‚â• 0 for all j = 1, ¬∑ ¬∑ ¬∑ , N.
j

POSITIVITY-PRESERVING SCHEMES FOR REDUCED PNP SYSTEM

7

n

Proof. Set mesh ratio Œª = hœÑ2 and introduce Gj = un+1
e‚àíœÜj , so that
j
(i) scheme (2.6), (2.7) and (2.8) can be rewritten as
n

n

n

n

(A1 eœÜ1 + ŒªB3/2 eœÜ3/2 + 2ŒªB1/2 eœÜ1/2 )G1 ‚àí ŒªB3/2 eœÜ3/2 G2 = A1 un1 + 2ŒªB1/2 ul ,
n

n

n

n

n

‚àí ŒªBj‚àí1/2 eœÜj‚àí1/2 Gj‚àí1 + (Aj eœÜj + ŒªBj+1/2 eœÜj+1/2 + ŒªBj‚àí1/2 eœÜj‚àí1/2 )Gj ‚àí ŒªBj+1/2 eœÜj+1/2 Gj+1 = Aj unj ,
n

n

n

n

‚àí ŒªBN ‚àí1/2 eœÜN ‚àí1/2 GN ‚àí1 + (AN eœÜN + ŒªBN ‚àí1/2 eœÜN ‚àí1/2 + 2ŒªBN +1/2 eœÜN +1/2 )GN = aN unN + 2ŒªBN +1/2 ur .
(2.12)
This linear system of {Gj } admits a unique solution since its coefficient matrix is strictly diagonally
n
n
dominant. Since un+1
= eœÜj Gj ‚â• eœÜj Gk , where
j
Gk = min {Gj },
1‚â§j‚â§N

it suffices to prove Gk ‚â• 0. We discuss in cases: if 1 < k < N, then from the k-th equation of
(2.12) with Ak > 0 it follows
n

n

n

n

Ak unk ‚â§ ‚àí ŒªBk‚àí1/2 eœÜk‚àí1/2 Gk + (Ak eœÜk + ŒªBk+1/2 eœÜk+1/2 + ŒªBk‚àí1/2 eœÜk‚àí1/2 )Gk
n

n

‚àí ŒªBk+1/2 eœÜk+1/2 Gk = Ak eœÜk Gk .
n

Hence Gk ‚â• unk e‚àíœÜk ‚â• 0; if k = 1, from the first equation of (2.12) we have
n

n

n

n

A1 un1 + 2ŒªB1/2 ul ‚â§(A1 eœÜ1 + ŒªB3/2 eœÜ3/2 + 2ŒªB1/2 eœÜ1/2 )G1 ‚àí ŒªB3/2 eœÜ3/2 G1 = (A1 eœÜ1 + 2ŒªB1/2 eœÜl )G1 .
This implies G1 ‚â• 0; so does the case if k = N .
(ii) Likewise, scheme (2.6), (2.7) and (2.9) can be rewritten as
n

n

n

(A1 eœÜ1 + ŒªB3/2 eœÜ3/2 )G1 ‚àí ŒªB3/2 eœÜ3/2 G2 = A1 un1 ,
n

n

n

n

n

‚àí ŒªBj‚àí1/2 eœÜj‚àí1/2 Gj‚àí1 + (Aj eœÜj + ŒªBj+1/2 eœÜj+1/2 + ŒªBj‚àí1/2 eœÜj‚àí1/2 )Gj ‚àí ŒªBj+1/2 eœÜj+1/2 Gj+1 = Aj unj ,
n

n

n

‚àí ŒªBN ‚àí1/2 eœÜN ‚àí1/2 GN ‚àí1 + (AN eœÜN + ŒªBN ‚àí1/2 eœÜN ‚àí1/2 )GN = AN unN .
Using an entirely same argument, we can show Gj ‚â• 0, hence un+1
‚â• 0 for all j involved.
j



Remark 2.2. The specific values or choices of {œÜnj } and {œÜnj+1/2 } do not affect the unconditional
positivity property of the scheme for {unj }. This result thus can be applied to the case when œÜ(x, t)
is solved by the Poisson equation, see the next section.
3. Positive schemes for the reduced PNP-system
The reduced PNP system (1.2) is reformulated as
A(x)‚àÇt ci = ‚àÇx (A(x)Di e‚àízi œà ‚àÇx (ci ezi œà )),
!
m
X
‚àí‚àÇx (A(x)‚àÇx œà) = A(x)
zi ci ‚àí œÅ(x) .

(3.1)

i=1

R
1
c
(x,
t
)dx
and
œà(x, tn ) respectively, then
Let
and
approximate the cell average
i
n
h Ij
Ij
from the discretization strategy in section 2 the fully discrete scheme for system (3.1) follows
cni,j

1
h

œàjn

Aj

R

n
cn+1
Ci,j+1/2 ‚àí Ci,j‚àí1/2
i,j ‚àí ci,j
=
,
œÑ
h

(3.2)

8

HAILIANG LIU AND WUMAIER MAIMAITIYIMING

‚àí

Œ®nj+1/2 ‚àí Œ®nj‚àí1/2
h

= Aj

X
m

zi cni,j


‚àí œÅj ,

(3.3)

i=1

where numerical fluxes on interior interfaces are defined by
n
‚àízi œàj+1/2

Ci,j+1/2 = Aj+1/2 Di e
Œ®nj+1/2

n
‚àí œàjn
œàj+1
,
= Aj+1/2
h


n
zi œàj+1
zi œàjn
cn+1
‚àí cn+1
i,j+1 e
i,j e
, j = 1, ¬∑ ¬∑ ¬∑ , N ‚àí 1.
h
j = 1, ¬∑ ¬∑ ¬∑ , N ‚àí 1,

where relevant terms are determined by
Z
1
Aj =
A(x)dx,
h Ij

1
œÅj =
h

(3.4)
(3.5)

Z
œÅ(x)dx
Ij

n
n
Aj+1/2 = A(xj+1/2 ), œàj+1/2
= (œàjn + œàj+1
)/2.

For non-trivial A(x), œÅ(x), numerical integration of high accuracy is used to evaluate Aj and œÅj .
The boundary fluxes are defined as follows:
(i) for Dirichlet boundary condition (1.4),
n

Ci,1/2
Ci,N +1/2
Œ®n1/2
Œ®nN +1/2

zi œà1
2(cn+1
‚àí ci,l )
i,1 e
= A1/2 Di
,
h
n
zi œàN
2(ci,r ezi V ‚àí cn+1
)
i,N e
‚àízi V
= AN +1/2 Di e
,
h
2œà n
= A1/2 1 ,
h
n
)
2(V ‚àí œàN
= AN +1/2
,
h

(3.6)

(ii) for boundary condition (1.6):
Ci,1/2 = 0, Ci,N +1/2 = 0,


n
Œ®n1/2 = A1/2 (œà1n ‚àí œà‚àí ), Œ®nN +1/2 = AN +1/2 (œà+ ‚àí œàN
).
Œ∑
Œ∑

(3.7)

3.1. Scheme properties. Scheme (3.2)-(3.5) with (3.6) turns out to be unconditionally positivitypreserving.
Theorem 3.1. Let œàjn and cn+1
for i = 1, ¬∑ ¬∑ ¬∑ , m, j = 1, ¬∑ ¬∑ ¬∑ , N be obtained from (3.2)-(3.5) with
i,j
n
(3.6). If ci,j ‚â• 0 and ci,l ‚â• 0, ci,r ‚â• 0 for i = 1, ¬∑ ¬∑ ¬∑ , m, j = 1, ¬∑ ¬∑ ¬∑ , N , then cn+1
‚â• 0 for all
i,j
i = 1, ¬∑ ¬∑ ¬∑ , m, j = 1, ¬∑ ¬∑ ¬∑ , N .
Proof. For fixed i = 1, ¬∑ ¬∑ ¬∑ , m, the scheme (3.2), (3.4) and (3.6) is of the same form as (2.6), (2.7)
n
and (2.8) with unj = cni,j , Bj+1/2 = Aj+1/2 Di , œÜnj = ‚àízi œàjn and œÜnj+1/2 = ‚àízi œàj+1/2
. From (i) in
n+1
n+1

Theorem 2.2, we can conclude ci,j = uj ‚â• 0.
Remark 3.1. From the above analysis we see that positivity of cni,j remains true even when another
Poisson solver is used.

POSITIVITY-PRESERVING SCHEMES FOR REDUCED PNP SYSTEM

9

For scheme (3.2)-(3.5) with (3.7), it turns out that the solution cni,j is conservative, non-negative,
and energy dissipating. In order to state the energy dissipation result, we define a discrete version
of the free energy (1.9) as

X
N
m
X
1 n n

n
n
n
n
(3.8)
Eh =
hAj
+ œà‚àí A1/2 œà1n ),
ci,j log ci,j + Sj œàj + (œà+ AN +1/2 œàN
2
2Œ∑
j=1
i=1
where
Sjn

=

m
X

zi cni,j ‚àí œÅj .

i=1

Theorem 3.2. Let œàjn and cni,j be obtained from (3.2)-(3.5) and (3.7), then we have:
(1) Conservation of mass:
N
X

hAj cn+1
i,j

j=1

=

N
X

hAj cni,j

for n ‚â• 0, i = 1, ¬∑ ¬∑ ¬∑ , m;

(3.9)

j=1

(2) Propagation of positivity: if cni,j ‚â• 0 for all j = 1, ¬∑ ¬∑ ¬∑ , N, and i = 1, ¬∑ ¬∑ ¬∑ , m, then
cn+1
i,j ‚â• 0,

j = 1, ¬∑ ¬∑ ¬∑ , N, i = 1, ¬∑ ¬∑ ¬∑ , m;

(3) Energy dissipation: there exists C ‚àó > 0 depending on numerical solutions but independent on
œÑ and h, such that if œÑ ‚â§ C ‚àó /Œ∑, then
œÑ
(3.10)
Ehn+1 ‚àí Ehn ‚â§ ‚àí Ihn ,
2
where
m N
‚àí1
X
X
1
n
n
zi œàj+1
zi œàjn
zi œàj+1
zi œàjn
)(log cn+1
‚àí log cn+1
) ‚â• 0.
Ihn =
Aj+1/2 Di (cn+1
‚àí cn+1
i,j+1 e
i,j e
i,j+1 e
i,j e
h
i=1 j=1
Proof. (1) Mass conservation follows from summing (3.2) over j = 1, ¬∑ ¬∑ ¬∑ , N and using (3.7).
(2) For each fixed i = 1, ¬∑ ¬∑ ¬∑ m, this follows from (ii) in Theorem 2.2, by taking unj = cni,j ,
n
.
Bj+1/2 = Aj+1/2 Di , œÜnj = ‚àízi œàjn and œÜnj+1/2 = ‚àízi œàj+1/2
(3) Using (3.8) we find that
X
N
m
m
m
X
X
X
n+1
n+1
n+1
n
n
n
n
Eh ‚àí Eh =
hAj
(cn+1
‚àí
c
)(log
c
+
z
œà
)
+
c
log
c
‚àí
cni,j log cni,j
i j
i,j
i,j
i,j
i,j
i,j
j=1

i=1

i=1
m
X

i=1



1
1
n
n
+ Sjn+1 œàjn+1 ‚àí Sjn œàjn ‚àí
zi (cn+1
i,j ‚àí ci,j )œàj
2
2
i=1


n+1
n
+ (AN +1/2 œà+ œàN
+ A1/2 œà‚àí œà1n+1 ) ‚àí (AN +1/2 œà+ œàN
+ A1/2 œà‚àí œà1n )
2Œ∑
2Œ∑
=:I + II + III.
We proceed to estimate term by term. For I, we use scheme (3.2)-(3.4) and (3.7) and summation
by parts to obtain
I=

N
X
j=1

m
X
n+1
n
n
hAj
(cn+1
i,j ‚àí ci,j )(log ci,j + zi œàj )
i=1

10

HAILIANG LIU AND WUMAIER MAIMAITIYIMING

=œÑ

m X
N
X

n

zi œàj
(Ci,j+1/2 ‚àí Ci,j‚àí1/2 ) log(cn+1
)
i,j e

i=1 j=1

=‚àíœÑ

m N
‚àí1
X
X

n

n

zi œàj+1
zi œàj
Ci,j+1/2 (log cn+1
‚àí log cn+1
)
i,j+1 e
i,j e

i=1 j=1
m N
‚àí1
X
X
1
n
n
zi œàj+1
zi œàjn
zi œàjn
zi œàj+1
‚àí log cn+1
)
)(log cn+1
‚àí cn+1
Aj+1/2 Di (cn+1
=‚àíœÑ
i,j e
i,j+1 e
i,j+1 e
i,j e
h
i=1 j=1

= ‚àí œÑ Ihn ‚â§ 0.
For II, we use log(X) ‚â§ X ‚àí 1 for X > 0, to obtain
II =

N
X

m
m
X
X
n+1
n
hAj (
ci,j log ci,j ‚àí
cni,j log cni,j )

j=1

=

N
X

i=1
m
X

hAj

j=1

‚â§

cni,j log

i=1

m X
N
X

hAj cni,j (

i=1 j=1

=

i=1

m X
N
X

cn+1
i,j
cni,j

cn+1
i,j
‚àí 1)
cni,j

n
hAj (cn+1
i,j ‚àí ci,j ) = 0,

i=1 j=1

where in the last equality we have used conservation of mass.
Rearranging terms in III, we find that
III =

N
X


hAj

j=1

1 n+1 n+1 1 n n
S œàj + Sj œàj ‚àí Sjn+1 œàjn
2 j
2





n+1
n
(AN +1/2 œà+ œàN
+ A1/2 œà‚àí œà1n )
+ A1/2 œà‚àí œà1n+1 ) ‚àí (AN +1/2 œà+ œàN
2Œ∑
2Œ∑
N
1X
hAj (Sjn+1 ‚àí Sjn )(œàjn+1 ‚àí œàjn ) + F,
=
2 j=1

+

where
N


1X
n+1
F=
hAj (Sjn œàjn+1 ‚àí Sjn+1 œàjn ) + (AN +1/2 œà+ œàN
+ A1/2 œà‚àí œà1n+1 )
2 j=1
2Œ∑
‚àí


n
+ A1/2 œà‚àí œà1n ).
(AN +1/2 œà+ œàN
2Œ∑

Tedious but elementary calculations show that F ‚â° 0. Thus
N

1X
III =
hAj (Sjn+1 ‚àí Sjn )(œàjn+1 ‚àí œàjn ).
2 j=1

(3.11)

POSITIVITY-PRESERVING SCHEMES FOR REDUCED PNP SYSTEM

11

Scheme (3.3)-(3.5) and (3.7) can be written in matrix form
~ n = ~b,
Mœà
where
Ô£π

Ô£Æh

A + A3/2
‚àíA3/2
Œ∑ 1/2
Ô£Ø
A3/2 + A5/2 ‚àíA5/2
Ô£Ø ‚àíA3/2
Ô£Ø
..
..
..
M =Ô£Ø
.
.
.
Ô£Ø
Ô£Ø
‚àíAN ‚àí3/2 AN ‚àí3/2 + AN ‚àí1/2
Ô£∞
‚àíAN ‚àí1/2

‚àíAN ‚àí1/2
h
A
+ AN ‚àí1/2
Œ∑ N +1/2

Ô£∫
Ô£∫
Ô£∫
Ô£∫,
Ô£∫
Ô£∫
Ô£ª

(3.12)

>

2


h
n
n
n
~b =
A1 S1 +
A1/2 œà‚àí , A2 S2 , ¬∑ ¬∑ ¬∑ , AN SN +
AN +1/2 œà+ .

hŒ∑
hŒ∑
Hence we have
œàjn+1

‚àí

œàjn

N
œÑ h2 X ‚àí1
(M )j,k Ak Dt Skn ,
=
 k=1

œÑ Dt Sjn := Sjn+1 ‚àí Sjn ,

thus (3.11) can be simplified as
III =

N
N
X
h3 œÑ 2 X
Aj Dt Sjn
(M ‚àí1 )j,k Ak Dt Skn .
2 j=1
k=1

We claim that for any Œ∂ ‚àà RN
Œ∂ ¬∑ M ‚àí1 Œ∂ ‚â§

N 2Œ∑
kŒ∂k2 ,
(A1/2 + AN +1/2 )

(3.13)

with which we can bound III as
III =

N
N
X
h3 œÑ 2 X
Aj Dt Sjn
(M ‚àí1 )j,k Ak Dt Skn
2 j=1
k=1

N
Œ±Œ∑N 2 h3 œÑ 2 X 2
Aj |Dt Sjn |2 ,
‚â§
2
j=1

where Œ±‚àí1 = A1/2 + AN +1/2 . Note that hN = 1 and
|Dt Sjn |2

‚â§m

m
X

zi2 (Dt cni,j )2 ,

i=1

we thus have
III ‚â§

m
N
X
Œ±Œ∑z 2 mœÑ 2 X
i

i=1

2

hA2j (Dt cni,j )2 .

j=1

Collecting estimates on I, II and III we arrive at
Ehn+1 ‚àí Ehn ‚â§

m
X
i=1

!
N
2
2 X
Œ±Œ∑z
mœÑ
i
n
œÑ
hAj (Dt cni,j )(log cn+1
hA2j (Dt cni,j )2 .
i,j + zi œàj ) +
2
j=1
j=1
N
X

(3.14)

12

HAILIANG LIU AND WUMAIER MAIMAITIYIMING

For (3.10) to hold, it remains to find a sufficient condition on time step œÑ so that for all i = 1, ¬∑ ¬∑ ¬∑ , m,
N
N
Œ±Œ∑zi2 mœÑ 2 X 2
œÑX
n 2
n
hAj (Dt ci,j ) ‚â§ ‚àí
hAj (Dt cni,j )(log cn+1
i,j + zi œàj ).
2
2
j=1
j=1

(3.15)

This is nothing but
Œ±Œ∑zi2 mœÑ 2 ~ 2
kŒæk +
2
where
Œæ~j =

‚àö

hAj Dt cni,j , ~¬µj =

œÑ~
Œæ¬∑¬µ
~ ‚â§ 0,
2

‚àö
n
h(log cn+1
i,j ) + zi œàj ).

Note that I = œÑ Œæ~ ¬∑ ¬µ
~ ‚â§ 0. One can verify using (3.4) and flux (3.2) that Œæ~ ¬∑ ¬µ
~ = 0 if and only if
~
Œæ = 0. Therefore
‚àíŒæ~ ¬∑ ¬µ
~
k~¬µk
0 < c0 ‚â§
‚â§
for Œæ~ 6= 0,
2
~
~
kŒæk
kŒæk
where c0 depends on the numerical solution at tn and tn+1 . We thus obtain (3.15) by taking

œÑ ‚â§ C‚àó ,
Œ∑

where C ‚àó = min

1‚â§i‚â§m

c0
> 0.
Œ±zi2 m

Finally, we return to the proof of claim (3.13): For any y ‚àà RN with kyk = 1, we have the following
N ‚àí1

y ¬∑ My =

X
h
h
2
A1/2 y12 +
Aj+1/2 (yj+1 ‚àí yj )2 + AN +1/2 yN
Œ∑
Œ∑
j=1
N ‚àí1

X
h
h
2
‚â• min { A1/2 y12 +
Aj+1/2 (yj+1 ‚àí yj )2 + AN +1/2 yN
}
kyk=1 Œ∑
Œ∑
j=1
=

h
(A1/2 + AN +1/2 ),
NŒ∑

‚àö
where the minimum is achieved at y = (1, ¬∑ ¬∑ ¬∑ , 1)/ N . Replacing y by y/kyk and then further set

y = M ‚àí1/2 Œ∂ leads to (3.13).
Remark 3.2. Though C ‚àó is not explicitly given, it is about O(1) as can be seen from a formal limit
‚àÜt ‚Üí 0. The sufficient condition œÑ ‚â§ C ‚àó /Œ∑ suggests that for smaller /Œ∑, one should consider a
smaller time step to ensure the scheme stability. This is consistent with our numerical results.
4. Numerical tests
In this section, we implement the fully discrete scheme (3.2)-(3.5) with different boundary conditions. Errors are measured in the following discrete l‚àû norm:
ef = max |fj ‚àí f¬Øj |.
1‚â§j‚â§N

Here f¬Øj denotes the average of f on cell Ij . In what follows we take fj = cni,j or œàjn at time t = nœÑ.

POSITIVITY-PRESERVING SCHEMES FOR REDUCED PNP SYSTEM

13

4.1. Accuracy test. In this example we numerically verify the accuracy and order of schemes
(3.2)-(3.5) with first order boundary flux (3.6) and second order boundary flux of form (2.11).
Example 4.1. Consider the initial value problem with source term
Ô£±
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£≤
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£≥

‚àÇt c1 =
‚àÇt c2 =
1
‚àí A(x)
c1 (x, 0) =
c2 (x, 0) =
œà(0, t) =

1
‚àÇ (A(x)D1 (‚àÇx c1
A(x) x
1
‚àÇ (A(x)D2 (‚àÇx c2
A(x) x

+ z1 c1 ‚àÇx œà) + f1 (x, t),
+ z2 c2 ‚àÇx œà) + f2 (x, t),
‚àÇx (A(x)‚àÇx œà) = z1 c1 + z2 c2 ‚àí œÅ(x) + f3 (x, t),
x2 (1 ‚àí x), c1 (0, t) = c1 (1, t) = 0,
x2 (1 ‚àí x)2 , c2 (0, t) = c2 (1, t) = 0,
1 ‚àít
0, œà(1, t) = ‚àí 60
e .

x ‚àà [0, 1], t > 0,
x ‚àà [0, 1], t > 0,
x ‚àà [0, 1], t > 0,

(4.1)

Here we take A(x) = (5 ‚àí 4x)2 , D1 = D2 = 1, z1 = ‚àíz2 = 1,  = 1 and œÅ(x) = 0, source terms are
4x4 ‚àí 9x3 + 53x2 ‚àí 54x + 10 ‚àít 40x7 ‚àí 71x6 + 30x5 ‚àí2t
e +
e ,
4x ‚àí 5
20
4x5 ‚àí 13x4 + 94x3 ‚àí 161x2 + 84x ‚àí 10 ‚àít 22x8 ‚àí 60x7 + 53x6 ‚àí 15x5 ‚àí2t
f2 (x, t) =
e +
e ,
5 ‚àí 4x
10
2x4 ‚àít
f3 (x, t) = ‚àí
e .
5
f1 (x, t) =

The exact solution to (4.1) is
c1 (x, t) = x2 (1 ‚àí x)e‚àít ,

c2 (x, t) = x2 (1 ‚àí x)2 e‚àít ,

and œà(x, t) = ‚àí

x5 (3 ‚àí 2x) ‚àít
e .
60

We use the time step œÑ = h2 to compute numerical solutions. The errors and orders at t = 1 are
listed in Table 1 and Table 2.
Table 1.
N
40
80
160
320

c1 error

40
80
160
320

order

c2 error

order

0.11184E-03
0.57759E-04
0.28354E-04 1.9798 0.14407E-04 2.0033
0.71370E-05 1.9902 0.36019E-05 1.9999
0.17903E-05 1.9951 0.90047E-06 2.0000

Table 2.
N

Accuracy for Example 4.1 with first order boundary approximations (3.6)

œà error

order

0.83275E-05
0.20810E-05 2.0006
0.52013E-06 2.0003
0.13002E-06 2.0001

Accuracy for Example 4.1 with second order boundary approximations (2.11)

c1 error

order

c2 error

order

0.10014E-03
0.69633E-04
0.25204E-04 1.9903 0.18005E-04 1.9514
0.63218E-05 1.9952 0.45767E-05 1.9760
0.15830E-05 1.9977 0.11536E-05 1.9882

œà error

order

0.37021E-05
0.93954E-06 1.9783
0.23755E-06 1.9837
0.59655E-07 1.9935

14

HAILIANG LIU AND WUMAIER MAIMAITIYIMING

We see from Table 1 and Table 2 that both first and second order boundary fluxes yield second
order convergent solutions. The numerical errors with both fluxes are comparable.
In the remaining numerical tests we only use first order boundary flux (3.6) for the Dirichlet
boundary value problem.
4.2. Effects of permanent charge and channel geometry. The key structure of an ion channel includes both the channel shape and the permanent charge (see e.g. [17]). We present numerical
examples to illustrate the effects from the channel geometry or the permanent change. While we
also examine dependence of the total current (1.3) on voltage V , which is known as the currentvoltage (I-V) relation in [17]. Note that (1.3) can be reformulated as
J =‚àí

m
X

zi Di A(x)e‚àízi œà ‚àÇx (ci ezi œà ).

i=1
n
n
be an approximation of J(xj+1/2 , tn ), then Jj+1/2
can be computed by
Let Jj+1/2

n
Jj+1/2

=‚àí

m
X

zi Ci,j+1/2 ,

i=1
n
where Ci,j+1/2 is defined in (3.4) with cn+1
i,j replaced by ci,j , that is,
n
n
cni,j+1 ezi œàj+1 ‚àí cni,j ezi œàj
n
‚àízi œàj+1/2
Ci,j+1/2 = Aj+1/2 Di e
, j = 1, ¬∑ ¬∑ ¬∑ , N ‚àí 1.
h

Example 4.2. (Effects of channel geometry with permanent charge) We consider the system
A(x)‚àÇt c1 = ‚àÇx (A(x)(‚àÇx c1 + c1 ‚àÇx œà)),

x ‚àà [0, 1], t > 0,

A(x)‚àÇt c2 = ‚àÇx (A(x)(‚àÇx c2 ‚àí c2 ‚àÇx œà)),

x ‚àà [0, 1], t > 0,

1
‚àÇx (A(x)‚àÇx œà) = c1 ‚àí c2 ‚àí œÅ(x),
‚àí
A(x)

(4.2)

x ‚àà [0, 1], t > 0,

where  = 5 √ó 10‚àí5 , subject to initial and boundary conditions
c1 (x, 0) = c2 (x, 0) = 0.5 ‚àí 0.1x,
ci (0, t) = 0.5,

x ‚àà [0, 1],

ci (1, t) = 0.4; œà(0, t) = 0, œà(1, t) = 0.5,

t > 0.

(4.3)

This corresponds to problem (1.2) with D1 = D2 = 1, z1 = ‚àíz2 = 1, with ci,l = 0.5, ci,r = 0.4,
and V = 0.5.
The computational domain diagram is given in Figure 1, while the cross sectional area A(x) is
defined as:
Ô£±
r ‚àír
Ô£¥
2(rf + c lb f x),
x ‚àà [0, lb ],
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£≤
A(x) =
(4.4)
2rc ,
x ‚àà (lb , lb + lc ),
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£≥ 2(r + rf ‚àírc (x ‚àí l ‚àí l )), x ‚àà [l + l , 1],
c

lb

b

c

b

c

POSITIVITY-PRESERVING SCHEMES FOR REDUCED PNP SYSTEM

15

Figure 1. Diagram of 1D computational region for the channel and bath funnels [12]

where the shape parameters are allowed to vary in our numerical tests. The permanent charge
œÅ(x) is taken as
Ô£±
0,
x ‚àà [0, lb ],
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£≤
œÅ(x) =
(4.5)
2Q0
x ‚àà (lb , lb + lc ),
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£≥
0,
x ‚àà [lb + lc , 1],
with Q0 a fixed constant.
Robert Eisenberg made clear to us the great importance of the tapered representation of the
baths in one dimensional versions of PNP models of channels, that became clear in his early work
with Wolfgang Nonner [28, 29], followed by many other more formal treatments such as in [12].
In this numerical test, we take h = 0.01, œÑ = 5 √ó 10‚àí5 . The solutions are understood to have
reached steady states if ||œà n ‚àí œà n‚àí1 ||‚àû ‚â§ 10‚àí6 . Table 3 shows times ts needed for reaching each
steady state, number of iterations, and CPU times.
Table 3. Times needed for reaching each steady state in Example 4.2 when Q0 = 0.2, rf = 20 with different
channel geometry
channel parameters ||œà n ‚àí œà n‚àí1 ||‚àû time ts iterations n = ts /œÑ CPU time (sec)
rc = lc = 31
rc = lc = 51
1
rc = lc = 11

9.9822E-07
9.9879E-07
9.9920E-07

0.0744
0.0992
0.1116

1488
1984
2232

0.5244
0.6534
0.7035

From Table 3 we see that ts = 0.1116 is the longest time needed for reaching the steady state,
so we run the simulation up to t = 0.2.
In Figure 2 we take Q0 = 0.2, rf = 20, varying lc and rc inside the channel, to obtain a series of
snapshots. We see that both c1 and c2 coincide outside the channel, but split inside the channel
with the shape evolving in terms of the channel geometry. The profile of œà looks similar.

16

HAILIANG LIU AND WUMAIER MAIMAITIYIMING

Figure 2. Effects of channel geometry on steady state densities and potential with
1
, (d)-(f) potential
Q0 = 0.2: (a)-(c) densities at t = 0.2, for lc = rc = 31 , 15 and 11
1 1
1
profiles at t = 0.2 for lc = rc = 3 , 5 and 11 .
lc =1/3, r c =1/3

lc =1/5, r c =1/5

0.75

lc =1/11, r c =1/11

0.75

0.75

c1

c1

c2

0.7

0.65

0.6

0.6

0.55

0.55

0.5

(c)

0.6

0.55

0.45

0.5

0.45

0.5

0.45

0.4

0.4

0.4

0.35

0.35

0.35

0.3

0.3

0.25

0.3

0.25
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

0.25
0

0.1

0.2

0.3

lc =1/3, r c =1/3

0.4

0.5

0.6

0.7

0.8

0.9

1

0

0.3

0.3

0.2

0.2

0.2

0.1

0.1

0.1

0

0

0

-0.1

-0.1

-0.1

-0.2

-0.2

-0.2

-0.3

-0.3

-0.3

-0.4

-0.4
0.6

0.7

0.8

0.9

0.6

0.7

0.8

1

0.9

1

(f)

(d)

(e)

0.3

0.5

0.5

potential
0.4

0.4

0.4

lc =1/11, r c =1/11

0.4

0.3

0.3

potential

0.4

0.2

0.2

0.5

0.5

potential

0.1

0.1

lc =1/5,r c =1/5

0.5

0

c2

0.7

0.65

(b)

(a)

0.65

c1

c2

0.7

-0.4
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

0

1

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

In Figure 3 we fix the channel shape with rf = 20, rc = 1/5, lc = 1/5, varying Q0 , we observe
that the difference between c1 and c2 inside the channel increases in terms of Q0 , roughly we have
c1 ‚àí c2 ‚âà 2Q0 inside the channel. We can also observe the effects on œà.
In Figure 4 is the I-V relation for the PNP system with channel shape parameters lc = 1/5,
rc = 1/5, rf = 20, and Q0 = 0.1. We see from the figure that the current is linear in the voltage.
Example 4.3. (No permanent charge in the channel œÅ = 0) We still use problem with (4.2), (4.3),
(4.4) and (4.5) to test the effects of the channel geometry, by taking œÅ = 0, rf = 20 and varying lc
and rc . In the simulation we take h = 0.01, œÑ = 5 √ó 10‚àí5 .
Table 4.

Times needed for reaching each steady state on Example 4.3 when œÅ = 0, rf = 20 with different channel geometry

channel parameters ||œà n ‚àí œà n‚àí1 ||‚àû time ts iterations n = ts /œÑ CPU time (sec)
rc = lc = 31
rc = lc = 51
1
rc = lc = 11

9.9876E-07
9.9928E-07
9.9873E-07

0.0589
0.0747
0.0888

1178
1494
1776

0.4647
0.5529
0.6116

From Table 4 we see that ts = 0.0888 is the longest time needed for reaching the steady state,
so simulation runs up to t = 0.1.
In Figure 5 are snap shots of solutions for different channel geometry. In the case of no permanent
charge, there does not seem to be any layering phenomenon on c1 and c2 : c1 and c2 are rather

POSITIVITY-PRESERVING SCHEMES FOR REDUCED PNP SYSTEM

17

Figure 3. Effects of permanent charge on steady state densities and potential with
lc = rc = 15 : (a)-(c) are computed densities at t = 0.2, for Q0 = 0.05, 0.1, 0.15,
(d)-(f) are potential profiles at t = 0.2 for Q0 = 0.05, 0.1, 0.15.
Q0=0.05

Q0=0.1

0.75

Q0=0.15

0.75

0.75

c1

c1

c2

0.7

0.65

0.6

0.6

0.55

0.55

0.5

(c)

0.6

0.55

0.45

0.5

0.45

0.5

0.45

0.4

0.4

0.4

0.35

0.35

0.35

0.3

0.3

0.25

0.3

0.25
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

0.25

0

0.1

0.2

0.3

0.4

Q0=0.05

0.5

0.6

0.7

0.8

0.9

0

1

0.3

0.3

0.2

0.2

0.2

0.1

0.1

0.1

0

0

0

-0.1

-0.1

-0.1

-0.2

-0.2

-0.2

-0.3

-0.3

-0.3

-0.4

-0.4
0.6

0.7

0.8

0.9

0.6

0.7

0.8

1

0.9

1

(f)

(d)

(e)

0.3

0.5

0.5

potential
0.4

0.4

0.4

Q0=0.15

0.4

0.3

0.3

potential

0.4

0.2

0.2

0.5

0.5

potential

0.1

0.1

Q0=0.1

0.5

0

c2

0.7

0.65

(b)

(a)

0.65

c1

c2

0.7

-0.4

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

0

1

0.1

0.2

0.3

0.4

0.5

0.6

0.7

Figure 4. I-V relation: (a) voltage for V = 0.5, 1, 3, 5, with lc = rc =
Q0 = 0.1 at time t = 0.2, (b) current voltage relation.

0.8

1
5

0.9

1

and

current for different voltage
0

0

-1

-1

-2

-3

-3

Current

-2

-4

-4

(b)

(a)

Current

V=0.5
V=1
V=3
V=5

-5

-5

-6

-6

-7

-7

-8
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

-8
0.5

1

1.5

2

2.5

3

Voltage

3.5

4

4.5

5

18

HAILIANG LIU AND WUMAIER MAIMAITIYIMING

Figure 5. Effects of channel geometry on steady state densities and potential with
1
, (b) potential profiles at
œÅ = 0: (a) densities at t = 0.1, for lc = rc = 31 , 15 and 11
1 1
1
t = 0.1 for lc = rc = 3 , 5 and 11 .
c 1 and c 2 for different lc and rc

effects of geometry on potential

0.5

0.5

0.49

c , l =r =1/3

0.45

0.48

c 2 , l c =rc =1/3

0.4

0.47

c 1 , l c =rc =1/5

0.35

0.46

c , l =r =1/5

0.3

0.45

c 1 , l c =rc =1/11

0.44

c 2 , l c =rc =1/11

1

c

c

l =r =1/3

2

c

c

(b)

(a)

c

c

lc =rc =1/5
lc =rc =1/11

0.25

0.2

0.43

0.15

0.42

0.1

0.41

0.05

0.4

0
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

close both inside the channel (linear) and inside the bath (constant). The profile for œà is quite
similar. This is consistent with the analysis in [17], in which the authors showed that the density
in the channel gets steeper as the channel gets narrower. We refer to [25] for a study of steady
state solutions to (4.2) in the case of œÅ = 0. They proved that for  > 0 small, there is a unique
nonnegative steady state to problem (4.2) and (4.3).
Example 4.4. (Variable diffusion coefficient and quadratic area function) We consider the system

A(x)‚àÇt c1 = ‚àÇx (A(x)D1 (x)(‚àÇx c1 + 2c1 ‚àÇx œà),

x ‚àà [‚àí10, 10], t > 0

A(x)‚àÇt c2 = ‚àÇx (A(x)D2 (x)(‚àÇx c2 ‚àí 3c2 ‚àÇx œà),

x ‚àà [‚àí10, 10], t > 0

A(x)‚àÇt c3 = ‚àÇx (A(x)D3 (x)(‚àÇx c3 + c3 ‚àÇx œà),
‚àí

1
‚àÇx (A(x)‚àÇx œà) = 2c1 ‚àí 3c2 + c3 ‚àí œÅ(x),
A(x)

x ‚àà [‚àí10, 10], t > 0

(4.6)

x ‚àà [‚àí10, 10], t > 0,

where  = 0.1, subject to boundary conditions
ci (¬±10, t) = 0.5,

œà(¬±10, t) = 0,
4

t > 0.

(4.7)
4

As in [13], we choose A(x) = 1 + x2 , Di (x) = 20(1 ‚àí 0.9e‚àíx ) and œÅ = Ce‚àíx . This corresponds to
problem (1.2) with z1 = 2, z2 = ‚àí3, z3 = 1, and ci,l = ci,r = 0.5, V = 0. In this numerical test we
take h = 0.1, œÑ = 10‚àí3 .

POSITIVITY-PRESERVING SCHEMES FOR REDUCED PNP SYSTEM

19

We take two different sets of initial data, first set is given as
4

‚àí(x+4)
cin
,
1 (x) = 0.5 ‚àí 0.5e
4

‚àíx
cin
,
2 (x) = 0.5 + 2e

(4.8)
4

‚àí(x‚àí4)
.
cin
3 (x) = 0.5 + e

For the second set of initial data we take uniformly distributed random initial data c0i,j ‚àà (0, 1).
From Table 5 we see that ts = 2.7410 is the longest time needed for reaching the steady state, so
simulation runs up to t = 3. We vary the parameter C to observe effects of the permanent charge.
Table 5.

Time needed for reaching steady state on Example 4.4 when C = 1 with different initial data

initial data
data (4.8)
random data

||œà n ‚àí œà n‚àí1 ||‚àû time ts iterations n = ts /œÑ CPU time (sec)
9.9999E-08
9.9864E-08

2.7410
2.0440

2741
2044

0.3874
0.3167

In Figure 6 (top three) are snap shots of solutions for initial data (4.8). Varying C, we can see
that max c1 ‚àí min c2 (or max c3 ‚àí min c2 ) increases in terms of C.
In Figure 6 (bottom three) are snap shots of solutions for random initial data, we see that the
choice of initial data does not affect the steady state densities.
4.3. Mass conservation and free energy dissipation. In this numerical test we demonstrate
mass conservation and free energy dissipation properties.
Example 4.5. (Zero flux + Robin boundary conditions) In this example we consider (4.6) with
initial condition (4.8) and boundary condition
‚àÇx ci + zi ci ‚àÇx œà = 0,

x = ‚àí10, 10,

(‚àíŒ∑‚àÇx œà + œà)|x=‚àí10 = ‚àí0.1,

t > 0,

(Œ∑‚àÇx œà + œà)|x=10 = 0.1,

t > 0.

(4.9)

We choose same A(x), Di (x), œÅ(x) and zi as in Example 4.4 and choose Œ∑ = 0.1,  = 0.1. In this
numerical test we use scheme (3.2)-(3.5) and (3.7), with h = 0.1, œÑ = 10‚àí3 .
In Figure 7 (left) are snap shots of solutions for initial data (4.8), (right) is free energy for the
system and total mass for each species, which confirms energy dissipation and mass conservation
properties as proved in Theorem 3.2.
5. Concluding Remarks
In this paper, we have developed an unconditional positivity-preserving finite-volume method
for solving initial boundary value problems for the reduced Poisson-Nernst-Planck system. Such a
reduced system has been used as a good approximation to the 3D ion channel problem. By writing
the underling system in non-logarithmic Landau form and using a semi-implicit time discretization,
we constructed a simple, easy-to-implement numerical scheme which proved to satisfy positivity
independent of time steps and the choice of Poisson solvers. Our scheme also preserves total
mass and satisfies a free energy dissipation property for zero flux boundary conditions. Extensive
numerical tests have been presented to simulate ionic channels in different settings.

20

HAILIANG LIU AND WUMAIER MAIMAITIYIMING

Figure 6. Effects of permanent charge and initial data on steady state densities:
(a) is initial data profile (4.8), (b)-(c) are density profile at t = 3 for C = 1 and
C = 2 respectively, (d) is random initial data profile, (e)-(f) are density profile for
C = 1 and C = 2.
densities for C=1 at time t=3

Initial density distributions (4.8)

densities for C=2 at time t=3

1

2.5

1
c1

c1
c2

c

2

c1

c2

0.9

c3

c2

0.9

c

3

0.8

0.8

0.7

0.7

0.6

0.6

3

(c)

(a)

(b)

1.5

0.5

0.5

0.4

0.4

0.3

0.3

0.2

0.2

1

0.5

0
-10

-8

-6

-4

-2

0

2

4

6

8

0.1
-10

10

-5

randomly (standard uniform distribution) distributed initial data

0

5

0.1
-10

10

densities for C=1 at time t=3

5

10

1
c1

c1

c1

c2

0.9

c2

c

0.9

0.8

0.8

0.7

0.7

0.6

0.6

2

c3

c3

c3

0.8

0

densities for C=2 at time t=3

1

1

0.9

-5

0.7

0.5

(f)

(e)

(d)

0.6

0.5

0.5

0.4

0.4

0.3

0.3

0.2

0.2

0.4

0.3

0.2

0.1

0
-10

-8

-6

-4

-2

0

2

4

6

8

0.1
-10

10

-5

0

5

0.1
-10

10

-5

0

5

10

Figure 7. Energy dissipation and mass conservation: (a) density profiles at t = 15
for C = 1, (b) energy dissipation and mass conservation.
-665

free energy dissipation and mass conservation
free energy
mass for c 1

c1

mass for c 2

c2

0.7

c

-670

3

0.65

370

-675

(b)
free enargy

0.6

(a)

0.55
0.5

380

mass for c 3

-680

360

-685

350

-690
340

0.45
-695

0.4

330
-700

0.35
0.3
-10

-5

0

5

10

-705

320
2

4

6

8

10

time

12

14

16

totl mass

densities for C=1 at time t=15
0.75

POSITIVITY-PRESERVING SCHEMES FOR REDUCED PNP SYSTEM

21

Acknowledgments
The authors would like to thank Robert Eisenberg for stimulating discussions on PNP systems
and their role in modeling ion channels. This research was supported by the National Science
Foundation under Grant DMS1812666 and by NSF Grant RNMS (KI-Net) 1107291.

References
[1] N. Abaid, R. S. Eisenberg, and W.S. Liu. Asymptotic expansions of I-V relations via a Poisson-Nernst-Planck
system. SIAM J. Applied dynamical systems., 7(4): 1507‚Äì1526, 2008.
[2] F. Fogolari and J.M. Briggs. On the variational approach to Poisson-Boltzmann free energies. Chemical Physics
Letters., 281:135‚Äì139, 1997.
[3] X.L. Cao and H.X. Huang. An adaptive conservative finite volume method for Poisson-Nernst-Planck equations
on a moving mesh. Commun. Comput. Phys., 26:389‚Äì412, 2019.
[4] D. Chen and G. Wei. A review of mathematical modeling, simulation and analysis of membrane channel charge
transport. arXiv:1611.04573v1, 2016.
[5] R.D. Coalson and M. G. Kurnikova. Poisson-Nernst-Planck theory approach to the calculation of current
through biological ion channels. IEEE Transactions on Nanobioscience., 4:81‚Äì93, 2005.
[6] E.L. Cussler. Diffusion: Mass Transfer in Fluid Systems. 3rd edition, Cambridge University Press, 2009.
[7] R. Eisenberg. Computing the field in proteins and channels. J. Membrane Biol., 150: 1‚Äì25, 1996.
[8] B. Eisenberg and W. Liu. Poisson-Nernst-Planck systems for ion channels with permanent charges. SIAM J.
Math. Anal., 38(6):1932‚Äì1966, 2007.
[9] R. Eymard, T. GallouÃàet, and R. Herbin. Finite volume methods. In Handbook of numerical analysis. Vol. VII,
Handb. Numer. Anal., VII, NorthHolland, Amsterdam., 713‚Äì1020, 2000.
[10] A. Flavell, M. Machen, R. Eisenberg, J. Kabre, C. Liu, and X. Li. A conservative finite difference scheme for
Poisson-Nernst-Planck equations. J. Comput. Electron., 15:1‚Äì15, 2013.
[11] A. Flavell, J. Kabre, and X. Li. An energy-preserving discretization for the Poisson-NernstPlanck equations.
J. Comput. Electron., 16:431‚Äì441, 2017.
[12] C. Gardner, W. Nonner, and R. S. Eisenberg. Electrodiffusion model simulation of ionic channels: 1D simulation. J. Comput. Electron., 3:25‚Äì31, 2004.
[13] N. Gavish, C. Liu, and R. S. Eisenberg. Do bistable steric Poisson-Nernst-Planck models describe single-channel
gating? Journal of Physical Chemistry B., 122(20): 5183‚Äì5192, 2018.
[14] D. He and K. Pan. An energy preserving finite difference scheme for the Poisson-Nernst-Planck system. Appl.
Math. Comput., 287‚Äì288: 214‚Äì223, 2016.
[15] J.W. Hu and X.D. Huang. A fully discrete positivity-preserving and energy-dissipative finite difference scheme
for Poisson-Nernst-Planck equations Preprint (2019).
[16] Y. Hyon, B. Eisenberg, and C. Liu. A mathematical model for the hard sphere repulsion in ionic solutions.
Commun. Math. Sci., 9(2):459‚Äì475, 2011.
[17] S.G. Ji, W.S. Liu, and M.J. Zhang. Effects of (small) permanent charge and channel geometry on ionic flows
via classical Poisson-Nernst-Planck models. SIAM Journal on Applied Mathematics., 75(1):114‚Äì135, 2015.
[18] D.X. Jia, Z.Q. Sheng, and G.W. Yuan An extremum-preserving iterative procedure for the imperfect interface
problem. Commun. Comput. Phys., 25: 853‚Äì870, 2019.
[19] B. Lu, M. J. Holst, J. A. McCammon, and Y. Zhou. Poisson-Nernst-Planck equations for simulating biomolecular diffusion-reaction processes I: finite element solutions. Journal of Computational Physics., 229: 6979‚Äì6994,
2010.
[20] H. Liu and W. Maimaitiyiming. Positive and free energy satisfying schemes for diffusion with interaction
potentials. Preprint (2018).

22

HAILIANG LIU AND WUMAIER MAIMAITIYIMING

[21] H. Liu and H. Yu. An entropy satisfying conservative method for the Fokker-Planck equation of the finitely
extensible nonlinear elastic dumbbell model. SIAM J. Numer. Anal., 50(3): 1207‚Äì1239, 2012.
[22] H. Liu and Z. Wang. A free energy satisfying finite difference method for Poisson-Nernst-Planck equations. J.
Comput. Phys., 268: 363‚Äì376, 2014.
[23] H. Liu and Z. Wang. A free energy satisfying discontinues Galerkin method for one-dimensional Poisson-NernstPlanck systems. J. Comput. Phys., 328: 413‚Äì437, 2017.
[24] P. Liu, X. Ji, and Z. Xu. Modified Poisson‚ÄìNernst‚ÄìPlanck model with accurate coulomb correlation in variable
media. SIAM J. Appl. Math. , 78:226‚Äì245, 2018.
[25] W.S. Liu and H. G. Xu. A complete analysis of a classical Poisson-Nernst-Planck model for ionic flow. J. Diff.
Equ., 258: 1192‚Äì1228, 2015.
[26] J.L. Lv, G.W. Yuan, and J.Y. Yue. Nonnegativity-preserving repair techniques for the finite element solutions
of degenerate nonlinear parabolic problems. Numer. Math. Theor. Meth. Appl., 11: 413‚Äì436, 2018.
[27] M.S. Metti, J. Xu, and C. Liu. Energetically stable discretizations for charge transport and electrokinetic
models. J. Comput. Phys., 306:1‚Äì18, 2016 .
[28] W. Nonner and B. Eisenberg. Ion permeation and glutamate residues linked by Poisson-Nernst-Planck theory
in L-type calcium channels. Biophysical Journal., 75: 1287‚Äì1305, 1998.
[29] W. Nonner, D.P. Chen, and B. Eisenberg. Anomalous mole fraction effect, electrostatics, and binding in ionic
channels. Biophysical Journal., 74: 2327‚Äì2334, 1998.
[30] A. Singer and J. Norbury. A Poisson‚ÄìNernst‚ÄìPlanck model for biological ion channels ‚Äì an asymptotic analysis
in a three-dimensional narrow funnel. SIAM J. Appl. Math., 70(3): 949‚Äì968, 2009.
[31] A. Singer, D. Gillespie, J. Norbury, and R. S. Eisenberg. Singular perturbation analysis of the steady-state
Poisson‚ÄìNernst‚ÄìPlanck system: Applications to ion channels. European Journal of applied mathematics., 19(5):
541‚Äì560, 2008.
[32] L.Weynans. Super-convergence in maximum norm of the gradient for the Shortley-Weller method. J. Sci.
Comput., 75: 625‚Äì637, 2018.
[33] Q. Zheng, D.Chen, and G.-W. Wei. Second‚Äìorder Poisson-Nernst-Planck solver for ion transport. J. Comput.
Phys., 230: 5239‚Äì5262, 2011.
Iowa State University, Mathematics Department, Ames, IA 50011
E-mail address: hliu@iastate.edu
E-mail address: wumaierm@iastate.edu

