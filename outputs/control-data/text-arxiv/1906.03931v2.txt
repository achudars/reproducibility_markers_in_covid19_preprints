Families of Toric Chemical Reaction Networks
arXiv:1906.03931v2 [q-bio.MN] 16 Dec 2019

Michael F. Adamer and Martin Helmer
Abstract
We study families of chemical reaction networks whose positive steady states are
toric, and therefore can be parameterized by monomials. Families are constructed algorithmically from a core network; we show that if a family member is multistationary,
then so are all subsequent networks in the family. Further, we address the questions
of model selection and experimental design for families by investigating the algebraic
dependencies of the chemical concentrations using matroids. Given a family with toric
steady states and a constant number of conservation relations, we construct a matroid
that encodes important information regarding the steady state behaviour of the entire
family. Among other things, this gives necessary conditions for the distinguishability of families of reaction networks with respect to a data set of measured chemical
concentrations. We illustrate our results using multi-site phosphorylation networks.

1

Introduction

Many of the fundamental processes in biological cells can be described by a set of interlinked
chemical reactions. Prominent examples of cellular processes regulated via biochemical interactions include immune response [1], cell signalling [2], cell death [3, 4], and toxin formation
[5]. For this reason the study of chemical reaction networks forms a central part of algebraic
systems biology [6, 7, 8, 9, 10]. One approach focuses on the long term behaviour of networks
by investigating their steady states and the relation of the number and stability of steady
states to the network structure [10, 11, 13]. In this paper we investigate the positive steady
states for algorithmically constructed reaction networks, which we call families, for which the
positive steady states may be parameterized by monomials (i.e. polynomials with a single
term). Further, we use the algebraic dependencies of the variables representing the chemical
concentrations to investigate experimental design and model identification for entire families.
Families of networks are formally defined in Definition 3.2. To obtain an intuition for
what could be described as a family, we introduce phosphorylation networks [13, 19]. Phosphorylation is a vital signalling process in biochemistry and it is one of the most widely
studied protein modifications. During phosphorylation a phosphoryl group (P O3− ) is added
to an organic molecule which acts as a substrate. The chemical reaction is catalysed by
enzymes and often many phosphoryl groups can be added to the same substrate. This
process is known as multisite phosphorylation. There are two limiting mechanisms which
have been investigated in the literature and which will serve as the running examples in
1

this paper, namely, distributive phosphorylation and processive phosphorylation. In the distributive system the enzyme unbinds from the substrate after every time a P O3− is added
and in the processive mechanism the enzyme stays bound until the substrate is fully phosphorylated. The desphosphorylation mechanisms work analogously. The distributive and
processive mechanisms for one site substrates follow the same reaction scheme
E + S0
F + S1

ES0 → E + S1 ,
F S1 → F + S0 .

(1)

However, on a two-site substrate the mechanisms differ, namely, the distributive mechanism
is given by
E + S0

ES0 → E + S1

ES1 → E + S2 ,
F + S2
F S2 →F + S1

F S1 → F + S0 ,

(2)

and the processive system is
E + S0

ES0
F + S2

ES1 →E + S2 ,
F S2 → F S1 → F + S0 .

(3)

It is clear that the constructions for both the distributive and the processive system can
be extended to an N -site substrate and that two different procedures are needed to do so.
Hence, we can consider these two mechanisms to be in two distinct families of networks.
In this paper we study graph theoretic constructions which allows us to rigorously identify
families of networks and also construct them from a base graph. Most importantly, though,
we investigate which steady state properties are conserved throughout a family.
One of the central goals of this paper is to develop criteria to establish which families have
members with multiple positive steady states, so-called multistationary networks. Confirming that a network is multistationary and finding the associated parameter regions is highly
nontrivial; a range of different approaches have been applied previously (see [20] for a survey). In particular, monomial positive steady state parameterizations have proved fruitful
due to their relations to toric varieties which are well understood in algebraic geometry [18].
Previous work relating to the concept of families in this paper considers so-called atoms
of multistationarity, which are the smallest multistationary subnetworks which can induce
multistationarity in their parent networks [25]. Network properties resulting from the gluing
of networks are investigated in [26]. Other network modifications which preserve or destroy
multistationarity are studied in [27]. Recent results extend the techniques for identifying
multistationarity to highly structured networks [23] and networks with intermediate species
[24, 42]. In this paper we develop a concept of families of networks which unifies the notions
of highly structured networks, embedded subnetworks as defined in [25] (i.e. distributive
systems), and networks with intermediate species [42] (i.e. processive systems). We show in
Theorem 5.2 that if a member of a family is multistationary then so are all larger networks
obtained by the recursive construction of Definition 3.2.
Going beyond multistationarity, we also investigate the necessary conditions for model
rejection among members of a family if only limited steady state data is available. In
2

particular, in Section 4, we encode algebraic dependencies between the variables using a
combinatorial object called an algebraic matroid [29, 30]. From the algebraic matroid we
find binomial relations which have to be satisfied by the chemical concentrations at any
positive steady state, so-called steady state invariants. The results in Section 4.1 extend
the previous research of [33, 34, 32] and the application of matroids for experimental design
presented in [6, 34]. Using these previous results, we give novel necessary conditions for the
distinguishability of two members of a family of reaction networks with respect to a data set
of measured chemical concentrations. Consequently, we can also prescribe which species to
measure to be able to reject a family member.
In summary, the biochemical questions we would like to address are:
1. What conditions are needed to define families of chemical reaction networks and what
is the relation between their steady states? (Section 3)
2. Can we use the family construction in model selection or parameter estimation for the
entire family? (Section 4)
3. Can we find conditions such that multistationarity of one family member implies multistationarity for all subsequent members? (Section 5)
These motivating questions from chemistry translate into the following algebraic questions
which we answer using techniques from toric geometry and matroid theory:
1. What are the relations between the toric varieties defined by recursively constructed
reaction graphs?
2. What is the connection between the circuit polynomials of matroids associated to
different family members?
3. What is the relation between the positive parts of the steady state varieties of subsequent family members?
This paper is organised as follows. Section 2 introduces chemical reaction networks and
relevant definitions from toric geometry and matroid theory. In Section 3 we give a rigorous
definition of a family of reaction network graphs and some preliminary results. In Section 4
we focus on biochemical and algebraic question 2 using matroid theory. We also introduce
some new terminology which simplifies the proofs in the remainder of the paper. In Section
5 we prove the main result on multistationarity using the matroidal language developed in
the previous section. We discuss our results and suggest further directions in Section 6.

2

Background

In this section we briefly introduce aspects of chemical reaction network theory and discuss
essential notions of algebraic geometry and matroid theory.

3

2.1

Chemical Reaction Network Theory

Informally a chemical reaction network (CRN) can be described by a multiset N = {S, C, R},
where S is the set of species, C is the set of linear combinations of species (complexes) and
R is the set of reactions.
Example 2.1 (Michaelis-Menten). The set S of chemical species present in the network
E+S

ES → E + P

is defined by S = {E, S, ES, P }. The complexes, which are linear combinations of species, are
C = {E +S, ES, E +P }. The reaction set is R = {E +S → ES, ES → E +S, ES → E +P }.
The multiset N defines a directed graph (digraph) G whose vertex set is C and whose
edge set is defined by the reaction set R. The reaction from complex Ci to Cj is an element
of the reaction set R if and only if there is aPdirected edge CiP
→ Cj in G. Let Xl ∈ S and
{αil } ∈ Z≥0 . A reaction from complex Ci = l αil Xl to Cj = l αjl Xn , with rate constant
κ is written as
X
X
κ
αjl Xl ;
(4)
−
αil Xl →
l

l

the constants αil are called the stoichiometric coefficients of the complex Ci . Let the reaction
vector for the `th reaction Ci → Cj be r` = αj − αi where αi , αj are the column vectors of
the stoichiometric coefficients of the complexes Ci and Cj . The n × m matrix of all reaction
vectors Γ = (r1 , . . . , rm ) is called the stoichiometric matrix. The rate constant κ assigns a
weight to each edge of the digraph G, making G a weighted digraph. Definition 2.2 gives the
description of a CRN which we are going to adopt for the remainder of this paper. While
this is not the standard definition of a CRN, but equivalent to it, it allows us to focus more
on the graphical structure of CRNs.
Definition 2.2. A chemical reaction network is a weighted directed graph G = (C, R) with
vertex set C, edge set R and edge weights κ = (κ1 , . . . , κm )T .
To connect the graphical structure of a CRN to its dynamical properties a description of
reaction kinetics is needed. Previous work introduced a number of reaction laws such as mass
action, rational function kinetics, Michaelis-Menten kinetics or Hill function kinetics [14]. In
this paper we use mass action kinetics which assigns a monomial to each complex in the
network. Let the chemical concentration of chemical species Xn be xn , then the monomial
for complex Ci is obtained by
xαi = xα1 i1 · · · xαnin .
(5)
Hence, using the representation of complexes as monomials we represent C as a vector of
monomials xα = (xα1 , . . . , xαm )T .
Example 2.3. Revisiting the one site phosphorylation network (1), we map each species to
its concentration E → x1 , F → x2 , S0 → x3 , S1 → x4 , ES0 → x5 , F S1 → x6 and introduce

4

a vector of rate constants κ = (κ1 , . . . , κ6 )T . Then, the reaction network is represented by
the weighted digraph
κ

κ3
1
*
x1 x3 −
)
− x5 −→ x1 x4 ,
κ2
κ4

κ6
*
x2 x4 −
)
− x6 −→ x2 x3 .
κ5

The dynamics of the network can be expressed in terms of the network structure and the
stoichiometric coefficients as a set of ordinary differential equations
dx
= αT Aκ xα
dt

(6)

where Aκ is the negative weighted graph Laplacian of G, αT is the matrix of stoichiometric
coefficients and xα is a vector of monomials. An alternative representation of equation
(6) assigns a monomial κ` xα` to the `th reaction in the network to build a vector R(x) =
(κ1 xα1 , . . . , κm xαm )T . Then, the dynamical system (6) is given by dx/dt = ΓR(x), where Γ
is the stoichiometric matrix as above.
The left kernel of the stoichiometric matrix, Γ, is of biochemical importance as it describes
conservation relations. Conservation relations induce linear relations between the variables.
Informally we say that a set of species
 is conserved if their total concentration, c, is constant.
In particular, suppose z ∈ ker ΓT , then z T (dx/dt) = 0 which implies z T x = c ∈ R>0 ; this
latter equation is then a conservation relation.
Remark 2.4. Given a CRN, N, with a maximum of d independent conservation relations,
the linear subspace defined by the conservation relations, often referred to as compatibility
class, may be compactly written as Zx − c = 0, where c ∈ Rd≥0 . The rows of Zx − c define
the subspace and the matrix Z = (z1 , . . . , zd )T represents the conservation relations.
Example 2.5. In the one site phosphorylation system (1) (also Example 2.3), the enzyme E
is conserved, but can exist in two states, the free state E and the bound state ES1 . Thus, the
total concentration c1 = x1 +x3 is conserved. In total there are three independent conservation
relations as the total mass of E, F , and the substrate is conserved respectively.
We now proceed to defining the steady states of a chemical reaction network [19].
Definition 2.6. A vector x∗ ∈ Cn is called a steady state of a CRN if αT Aκ (x∗ )α = 0. A
positive steady state is a steady state such that x∗ ∈ Rn>0 and αT Aκ (x∗ )α = 0.
Often one is interested in whether a chemical reaction network can have multiple positive
steady states for a given set of rate constants κ and total concentrations c.
Definition 2.7. A chemical reaction network is multistationary if there exists a set of parameters {κ1 , . . . , κm } such that αT Aκ (x∗ )α = αT Aκ (y ∗ )α = 0 and x∗ − y ∗ ∈ ker(Z) for two
distinct positive steady states x∗ and y ∗ .

5

2.2

Algebraic Geometry and Toric Steady States

In this subsection we briefly introduce the notion of toric varieties from algebraic geometry,
and their connections to chemical reaction networks. For an introduction to toric varieties
we refer the reader to [18, 38].
Given polynomial equations f1 (x1 , . . . , xn ), . . . , fr (x1 , . . . , xn ) in the polynomial ring
C[x1 , . . . , xn ] we define the algebraic variety
V (f1 , . . . , fr ) = {x ∈ Cn | f1 (x) = · · · = fr (x) = 0}.

(7)

Note that, by definition,
g(x) = 0 for any x ∈ V (f1 , . . . , fr ) and any polynomial g in the ideal
P
hf1 , . . . , fr i = { i hi fi | hi ∈ C[x1 , . . . , xn ]} ⊂ C[x1 , . . . , xn ]; hence we may also associate a
variety V (I) = V (f1 , . . . , fr ) to an ideal I = hf1 , . . . , fr i.
As in §2.1 we will consider a chemical reaction network G = (C, R) defining a ODE model
dx
= αT Aκ xα
dt
as in (6). The set of all steady states of this system of ODEs (in an affine space Cn ) defines
an algebraic variety generated by the steady state ideal I = hαT Aκ xα i ⊆ R = C[x1 , . . . , xn ].
The ring R is generated by the chemical concentrations and defined over the field C.
A toric variety is an algebraic variety which can be described as the image of a monomial
map. Work over the field C and fix an integer d × n-matrix A, with columns a1 , a2 , . . . , an ,
and rank d. A given column vector ai defines a (Laurent) monomial tai = ta11i ta22i · · · taddi where
t ∈ (C∗ )d , and C∗ = C\{0} denotes the non-zero elements of the field (this is sometimes
called the complex torus). The affine toric variety over C defined by A is
XA = {(ta1 , . . . , tan ) : t ∈ (C∗ )d } ⊂ Cn .
In words, the variety XA is the (Zariski) closure in Cn of the image of the monomial map
defined by A. The defining implicit equations for XA can always be chosen to be binomials,
that is XA = V (I) where I is an ideal defined by binomial equations. Specifically by [12,
Corrollary 4.3] we have that
D +
E
−
I = xc − xc | c ∈ ker(A) ,
(8)
−
where c+
i is equal to ci if ci > 0 and 0 otherwise, and where ci is equal to |ci | if ci < 0 and 0
otherwise. The ideal I above is, additionally, a prime ideal; we say an ideal I ⊂ C[x1 , . . . , xn ]
is prime if whenever f ·g ∈ I then either f ∈ I or g ∈ I (or both are in I). Geometrically this
means the associated variety is irreducible (i.e. it cannot be written as a non-trivial union
of other varieties) and reduced (meaning a generic point has multiplicity one, e.g. the roots
of x2 = 0 have multiplicity two).
Conversely, any prime polynomial ideal hf1 , . . . , fm i in C[x1 , . . . , xn ], where each fi is a
binomial, defines a toric variety XA in Cn . Chemical reaction networks whose steady state
ideal is generated by such prime ideals have been studied in the literature e.g. [19]. To
simplify notation we make the following definition.

6

Definition 2.8. A chemical reaction network whose steady state ideal has an associated
prime that is binomial is a toric chemical reaction network.
The fact that toric varieties can be parameterized by monomials over C∗ also yields a
parametric representation of the positive part of the toric variety, i.e. of the positive steady
states of the associated reaction network. For this reason we restrict our analysis to toric
networks. We will also wish to explicitly incorporate the reaction rates in our analysis,
hence our starting point will be a binomial ideal with coefficients in R(κ) := R(κ1 , . . . , κm ),
the field of rational functions of the reaction rates with real coefficients. More precisely we
consider a prime binomial steady state ideal defined by ν equations,
+

−

I = hci xbi − ki xbi | i = {1, . . . , ν}, ci , ki ∈ R(κ)i ⊆ R(κ)[x1 , . . . , xn ].
−
The vectors b+
i and bi are positive column vectors with disjoint support and let B =
−
(b1 , . . . , bν ) be the matrix with columns bi = b+
i − bi , called the exponent matrix of I.
Then there exists a matrix A such that bi ∈ ker(A), for i = 1, . . . , ν. The matrix A is a
d × n integer matrix where d is the dimension of the toric variety and n is the dimension
of the ambient affine space. Note that, since the dimension of a variety cannot exceed the
dimension of its ambient space, rank(A) ≤ d ≤ n.

Remark 2.9. Note that there is some freedom in the choice of the matrix A, as integer row
operations on rows of A will not change its kernel and, hence, the variety it parameterizes is
left unaltered. Therefore, we informally refer to any matrix A as the A-matrix (associated
to a toric variety XA = V (I)).
To explicitly incorporate the reaction rates in the monomial parameterization we will
now define the scaled toric variety of a matrix A and a vector x∗ ∈ Cn . The value x∗ can
be thought of a particular steady state which in turn depends on the reaction rates, see
Remark 2.13.
Definition 2.10 (Scaled Toric Variety). Given an x∗ = (x∗1 , . . . , x∗n ) ∈ Cn define a (Laurent)
(x∗ )
monomial map ψA := ψA with
ψA : (C∗ )d → Cn where t 7→ (x∗1 ta1 , . . . , x∗n tan )
for ai a column of A. The (Zariski) closure of the image of this monomial map defines a
scaled toric variety, XA,x∗ = ψA ((C∗ )d ).
The monomial map ψA also induces a parameterization map.
Definition 2.11. The parameterization map defined by the A-matrix is the C-algebra homomorphism
±
φA : C[x1 , . . . , xn ] → C[t±
1 , . . . , td ]
a

ai

φA (xi ) = x∗i tai = x∗i t1i1 · · · td d .
Note, as above, the map φA depends on x∗ ∈ Cn .
7

Example 2.12. The steady state ideal of (1) is
I = h − κ1 x1 x3 + (κ2 + κ3 )x5 , −κ4 x2 x4 + (κ5 + κ6 )x6 ,
− κ1 x1 x3 + κ2 x5 + κ6 x3 , κ3 x5 − κ4 x2 x4 + κ5 x6 ,
κ1 x1 x3 − (κ2 + κ3 )x5 , κ4 x2 x4 − (κ5 + κ6 )x6 i,
= hκ2 x5 − κ5 x6 , κ4 x2 x4 − (κ5 + κ6 )x6 , κ1 x1 x3 − (κ2 + κ3 )x5 i,
which is a (prime) binomial ideal in the ring R(κ1 , . . . , κ6 )[x1 , . . . , x6 ]. Hence, we can find a
−1
∗ −1 −1
∗ −1
∗ −1
parameterization x1 = x∗1 t1 , x2 = x∗2 t2 , x3 = x∗3 t−1
1 t3 , x4 = x4 t2 t3 , x5 = x5 t3 , x6 = x6 t3
corresponding to the A-matrix


1 0 −1 0
0
0
0 .
A = 0 1 0 −1 0
0 0 −1 −1 −1 −1
Remark 2.13. As shown in [19] the entries of x∗ are algebraic functions in κ. In practice
we wish to restrict our choices of κ to those such that when we evaluate x∗ at some fixed
∗
n
(κ1 , . . . , κm ) ∈ Rm
>0 we have that x ∈ R>0 .
The proposition below connects the number of conserved quantities to the dimension of
the toric variety and is straightforward, however, we include a proof as we were unable to
locate one in the literature.
Proposition 2.14. Consider a chemical reaction network with steady state ideal I =
hαT Ak xα i in the polynomial ring R[x1 , . . . , xn ]. Let V = V (I) ∩ (R∗ )n be the real steady
state variety and denote the dimension of V by dim(V ). Let the linear equations `1 , . . . , `d
be the corresponding conservation relations. Suppose that dim(V ∩ V (`1 , . . . `d )) = d0 . Then
dim(V ) = d + d0 . Further if V is a toric variety we have that dim(V ∩ (R>0 )n ) = d + d0 .
Proof. Each linear form `j contains a constant term cj ∈ R which can be chosen freely. For a
sufficiently general choice of c1 , . . . , cd the intersection V ∩V (`1 , . . . `d ) is transverse, it follows
that d0 = dim(V ∩ V (`1 , . . . `d )) = dim(V ) − dim(V (`1 , . . . `d )) = dim(V ) − d. Because V is
toric it is parameterized by monomials, and hence its dimension in the positive orthant is
the same as its dimension over Rn .
Remark 2.15. In the notation of Proposition 2.14 any d0 > 0 implies that there is an infinite
number of steady states for each general choice of c1 , . . . , cd . Hence, the case d0 > 0 renders
the discussion of multistationarity irrelevant. Therefore for the remainder of this paper we
assume that d0 = 0 meaning that the dimension of the toric variety is equal to the number of
conservation relations.
Example 2.16 (Example 2.12 cont.). The network of Example 2.12 it is known to have a
finite number of positive steady states for each set of initial conditions (d0 = 0) and there are
three independent conservation relations x1 + x5 = c1 , x2 + x6 = c2 and x3 + x4 + x5 + x6 = c3 .
This implies that the dimension of the (toric) steady state variety, V (I), is dim(V (I)) = 3
which is indeed the case.
8

2.3

Matroids

One of the focuses of this paper is to find and study independent subsets of chemical species.
Independent subsets can give valuable information about which species concentrations have
to be measured and which concentrations can be determined from measurements [6]. A simple example of linear independence is the set of three vectors v1 = (1, 0)T , v2 = (0, 1)T , v3 =
(2, 1)T . The set of vectors {v1 , v2 } is linearly independent as there exists no λ ∈ R such
that λv1 = v2 , whereas v3 can be obtained by v1 + v2 and {v1 , v2 , v3 } is therefore dependent.
The vectors v1 and v2 are said to from a basis of the set {v1 , v2 , v3 } which is a familiar
notion of linear algebra. The set {v1 , v2 , v3 } is minimally dependent as it contains only
a single element other than a basis and is a circuit. Matroid theory extends the notion of
independence to polynomials rings [29]. First, we define a matroid.
Definition 2.17 (Matroid). A matroid M(E, I) is a pair of two finite sets (E, I) where
E is the ground set and I is a set of subsets of E, called independent sets, satisfying the
following conditions.
1. The empty set, ∅, is independent such that ∅ ∈ I and, hence, I =
6 ∅.
2. If i ∈ I and i0 ⊆ i then i0 ∈ I. This is called the hereditary property.
3. If i1 , i2 ∈ I and |i1 | < |i2 | then there exists an element x ∈ i2 − i1 such that i1 ∪ x ∈ I.
This is the exchange property.
The notions of matroid basis, rank and circuit will also be useful.
Definition 2.18. Matroid bases, rank and circuits are defined as follows:
• A basis S of a matroid M is a maximally independent subset, i.e. a subset S ∈ I such
that S ∪ k is a dependent set for all k ∈ E − S. Define the set of all bases to be B.
• The rank ρ is a function on a subset of E which takes a set e ⊆ E, and returns the
cardinality of the largest subset i ⊆ e which also satisfies i ∈ I.
• The circuits C are minimally dependent sets, i.e. subsets of E which satisfy C 6∈ I and
(C − z) ∈ I for any z ∈ C.
In particular for a matroid M it holds that all bases of M are equicardinal. An important
notion in matroid theory is also the rank of a matroid.
Definition 2.19. The rank of a matroid M, ρ(M), is the cardinality of a basis.
Due to the general definition of a matroid many mathematical objects have a matroid
structure such as sets of vectors in a vector space or graphs. One class of matroids relevant for
chemical reaction networks are algebraic matroids. Algebraic matroids encode the algebraic
dependencies between the variables of a polynomial ring C[x1 , . . . , xn ] in a prime ideal P .
A more detailed discussion of these ideas in given in Section 4. For information on how to
compute algebraic matroids we refer the reader to [29, 39]. Since we are interested in the
relation between the matroids of families of reaction networks we introduce the notion of a
submatroid.
9

Definition 2.20 (Submatroid). Given a subset E 0 ⊂ E, a matroid M0 (E 0 , I 0 ) is a submatroid of M(E, I) if I 0 = I ∩ P(E 0 ), where P(E 0 ) is the power set of E 0 . The rank function
of M0 is the restriction ρM0 (S) = ρM (S) for S ⊆ E 0 .
Submatroids of algebraic matroids contain a subset of the polynomial relations between
the variables of circuits of the original matroid. The relations between the variables of
circuits are referred to as circuit polynomials. Below we will consider algebraic matroids of
toric networks and the relations of matroids within a family of networks.
Example 2.21. The algebraic matroid of 2.12 can be calculated using the computer algebra
system Macaulay2 [31]. It is a matroid on the ground set E = {x1 , . . . , x6 } of rank 3 with
12 bases. Hence, as we will show in later sections, measuring only four species will suffice
to reject the one site model, any three species in a basis and one extra species. Further, the
matroid of the two site distributive system is a rank 3 matroid with 61 bases and the matroid
of the two site processive network is a rank 3 matroid with 19 bases. Both two-site model
matroids contain the one site matroid as a submatroid.

3

Families of Reaction Networks

In this paper we obtain results which hold for a range of networks rather than a single network. When the properties studied (i.e. multistationarity) are present in a “small network”,
these properties lift to all larger networks constructed by the procedure outlined below. We
call the collection of all such networks a family N with members Ni . In this section we
rigorously define families of networks and give examples of chemical systems fulfilling the
family property. Furthermore, we prove some results on families which have toric steady
states.

3.1

Family Definition and Properties

Families of networks can be found in a wide range of biochemical settings such as multisite phosphorylation [13] (e.g. cellular signalling, DNA transcription, cell death), kinetic
proofreading [1] (immune response) or compartmentalised diffusion [40] (spatial models).
We identify a family by properties of its reaction graphs. If we can construct the graph
of another network from a given network by a fixed set of procedures, the networks are in
the same family; an example of such a construction is given in Figure 1.
Remark 3.1 (Informal Construction of Families of Graphs). Fix a labelled digraph Gn and
an unlabelled digraph M ; from these build new family members step-by-step. At each step
assign a new set of labels to M , rendering M a labelled digraph. The vertices of Gn+1 are the
union of those of Gn and of M . The edges of the graph Gn+1 are obtained from Gn as follows:
1. Add a set E of edges adjacent to both some vertices of M and some vertices of Gn ; the
resulting graph Gnint is referred to as the intermediate graph (see also Definition 3.8).
2. Delete some subset of the edges of Gn from the graph Gnint to form Gn+1 .
10

A

A

𝜅C

𝜅B

A

A

𝜅C

𝜅1

Y 𝜅1
A 1

𝜅C
C

(a) The graph G0 .

𝜅B

𝜅B

B

B

𝜅C C

C

B

𝜅B
𝜅2

B

𝜅2

Y1

𝜅3

𝜅C C

B

A

𝜅3

C
(b) Adding a species Y1 to
form the intermediate network

𝜅1

Y 𝜅1
A 1

𝜅2

B

𝜅2

Y1

𝜅3

𝜅3

C
(c) Deleting edges to form
the graph G1
B

𝜅2
Figure 1:𝜅 Starting from
the graph in 1a, first new vertices 𝜅and edges are added in 1b and,
1
2
𝜅1
A some edges
Y1
second,
of the original graph are deleted
in 1c. Note, that Figures 1a and 1c can
A
Y1
be obtained from the𝜅intermediate network 1b by setting
the edge weights {κ1 , κ2 , κ3 } or,
3
𝜅3
respectively, {κ
𝜅 A , κB } to zero.
C

C

C

We formalise this construction using a definition from graph theory [41]. Graphs constructed as in Remark 3.1 form a family if they satisfy the conditions of Definition 3.2 below.
Definition 3.2 (See also Section 2 of [41]). For a reaction graph G = (C, R) and for U ⊆ C
let G[U ] be the subgraph induced by U and NG (U ) the set of vertices adjacent to some vertex
in U . Consider a set of graphs {Gi }i≥0 where Gi = (Ci , Ri ). Set W0 = C0 and E0 = R0 ;
additionally let Wi+1 = Ci+1 − Ci , and Ei+1 = Ri+1 − Ri for i ≥ 0. Further, there exists a
positive integer n, a labelled graph M and a set of reactions Y , such that the set {Gi }i≥0 is
called a family of graphs if the following properties hold:
S
1. NGn (Wn ) ⊆ W0 ∪ ( ri=0 Wn−i ) for n > r,
S
2. Rn = (Rn−1 − Y ) ∪ En , where Y ⊆ ri=1 En−i ,
S
3. the graph Gn [W0 ∪ ( ri=0 Wn−i )] is equal to M for n > r. In addition, Gn [Wn ] is always
the same graph.
Put simply the last condition says that the graph “added” to the previous graph must
be the same for each step throughout the family; this is illustrated in Figure 2 and further
elucidated in [41]. In the context of chemical reaction networks we add another condition,
namely, that in every subsequent family member there appears at least one new chemical
species:
4. SM ( SN for M < N .
We assume that in a network with a given set of chemical species every complex which is
chemically possible and that can be formed with this set of species is already present in the
network; i. e. if in a network with species H2 and O2 chemistry dictates that the only possible
reaction is 2 H2 + O2 → 2 H2 O then only the complexes 2 H2 + O2 and 2 H2 O exist for this
species set. Therefore, to give rise to a larger network new species have to be added.
11

C

0

0

1

2

0

0

1

2

0

0

1

2

0

0

1

2

Figure 2: An illustration of building a two-site ladder graph. The vertices are labelled
according to the sets Wi and the edge colours highlight the sets Ei . It can be seen that the
labelled graph M added to Gi is always the same.
Remark 3.3. Note that not every infinite sequence of networks is a family as defined in
Definition 3.2. For a non-example see Example 3.7.
Remark 3.4. For ease of notation, the unlabelled graph M is drawn in a “dot and arrow”
representation; e.g. the graph M = {·, · → ·} corresponds to a graph with two connected
components, an isolated vertex and a component with two unlabelled vertices and a directed
edge between them.
Example 3.5 (Distributive Phosphorylation). Distributive phosphorylation with N = 1
phosphorylation sites follows the reaction scheme
E + S0
F + S1

ES0 → E + S1 ,
F S1 → F + S0 .

The reaction scheme is a digraph G1 = (W1 , E1 ) with W1 = {E + S0 , ES0 , E
S1 , F + S1 , F S1 , F + S0 } and E1 = {(E + S0 , ES0 ), (ES0 , E + S0 ), (ES0 , E + S1 ), (F
S1 , F S1 ), (F S1 , F + S1 ), (F S1 , F + S0 )}. To construct G2 we use W2 = {ES1 , E + S2 , F
S2 , F S2 } and E2 = {(E + S1 , ES1 ), (ES1 , E + S1 ), (ES1 , E + S2 ), (F + S2 , F S2 ), (F S2 , F
S2 ), (F S2 , F + S1 )}. Defining G2 = (W1 ∪ W2 , E1 ∪ E2 ) gives
F + S2

E + S0
F S2 →F + S1

ES0 → E + S1
F S1 → F + S0 .

+
+
+
+

ES1 → E + S2 ,

Hence (in the notation of Definition 3.2) , M = {· → ·, ·
·} and r = 1. The digraphs G1
and G2 define the family members N1 and N2 . Inductively, this procedure can be continued
to member NN . By inspection of the green subgraph we can see that condition 3 of Definition
3.2 is fulfilled for any N > 0 and, therefore, the distributive phosphorylation networks form
a family. Further, N1 is a subnetwork of N2 as defined in [25, Definition 2.2].
Example 3.6 (Processive Phosphorylation). Processive phosphorylation of a substrate with
N = 1 phosphorylation sites follows the reaction scheme
E + S0
F +P

ES0 → E + P,
F S1 → F + S0 .
12

For N = 1 this is the same reaction scheme as for distributive phosphorylation, except for the relabelling of the fully phosphorylated substrate as product P . However, to
construct the next family member from the digraph G1 we use W2 = {ES1 , F S2 } and
E2 = {(ES0 , ES1 ), (ES1 , E + P ), (F + P, F S2 ), (F S2 , F + P ), (F S2 , F S1 )}. Next, delete
edges Y1 = {(ES0 , E + P ), (F + P, F S1 ), (F S1 , F + P )} which results in the graph G2 =
(W1 ∪ W2 , (E1 ∪ E2 ) − Y1 ) to give
E + S0

ES0 → ES1 →E + P,
F + P F S2 →F S1 → F + S0 .

Where the vertices M = {·, ·} were added and r = 1 as in Definition 3.2. Again, the digraphs
G1 and G2 define the family members N1 and N2 . Condition 3 of Definition 3.2 is fulfilled
for any N > 1 and, therefore, the processive phosphorylation networks form a family.
Example 3.7 (Non-example). As mentioned in Remark 3.3 not every infinite sequence of
graphs forms a family. Consider the autocatalytic networks
Xi + Xi+1 → 2Xi+1 ,
Xi
∅
for i = 1, . . . , N and setting XN +1 = X1 .
In the reaction above ∅ represents production and degradation of a molecule by a mechanism
not further studied. Without loss of generality consider N7 and N8 ; we see that C8 is not a
union of C7 and another graph as X7 + X1 ∈ C7 6⊆ C8 .
We conclude this subsection by considering the polynomial equations arising from the
reaction graphs of successive members of a family. First, we see from Section 2.1 that
every reaction has a unique rate constant, κi , which is the edge weight of the reaction
digraph. Further, in the dynamical system given by the equations (6) every monomial,
which represents a reactant complex, is multiplied by a constant κi . Note that isolated
vertices in the reaction graph do not contribute to the dynamics of the network. Hence, for
families of networks which satisfy Definition 3.2 with Y = ∅, we can derive the equations of
the N th member of a family from the (N + 1)th member by setting all the edge weights of
the edges added to the reaction graph to zero. Formally, we define the evaluation map
π : R[κ1 , . . . , κm+m0 ][x1 , . . . , xn ] → R[κ1 , . . . , κm ][x1 , . . . , xn ]
(
κi if i ≤ m,
π(κi ) =
0 otherwise.

(9)

For networks which require the deletion of a set of edges, Y , we need the concept of an
intermediate network.
Definition 3.8 (Intermediate Network). The intermediate network Gnint is the network constructed by only adding reactions to join the newly labelled graph M to Gn and before any
edges are deleted from the reaction graph. See step 1 of Remark 3.1.
13

Remark 3.9. The next member of a family is a subnetwork of the intermediate network.
Hence, for families in which the next family member coincides with the intermediate network
(i.e. when Y = ∅ in Definition 3.2) this terminology is not required.
The dynamical equations of the N th and (N + 1)th member can be constructed from their
intermediate network by defining the appropriate evaluation maps. As can be seen from
condition 2 of Definition 3.2 the reaction (edge) set of the (N + 1)th member of a family is
given by RN +1 = (RN − Y ) ∪ EN . The edge sets for the N th and intermediate network are
given by RN and RN ∪ EN respectively. Define a function µ which associates a unique edge
weight, κi,j , to every edge of the reaction graph,
µ : C × C → R[κ],
µ ((Ci , Cj )) = κi,j .

(10)

This gives the rate constants µ (RN ) = {κ1 , . . . , κm }, µ (EN ) = {κm+1 , . . . , κm+m0 } and
µ (Y ) = {κ1 , . . . , κm00 } (where we relabel rate constants produced by (10) as required). By
construction, an edge is not present in the reaction graph if it has an edge weight of 0. Hence,
two evaluation maps can be defined to map the edge sets of the intermediate network to the
(N + 1)th and N th network respectively,
π + : R[κ1 , . . . , κm+m0 ][x1 , . . . , xn ] → R[κm00 +1 , . . . , κm+m0 ][x1 , . . . , xn ]
(
κi if i > m00 ,
π(κi ) =
0 otherwise,

(11)

and
π − : R[κ1 , . . . , κm+m0 ][x1 , . . . , xn ] → R[κ1 , . . . , κm ][x1 , . . . , xn ]
(
κi if i ≤ m,
π(κi ) =
0 otherwise.

(12)

This results in the edge weights π + (µ (RN ∪ EN )) = {κm00 +1 , . . . , κm+m0 } =
µ ((RN − Y ) ∪ EN ) and π − (µ (RN ∪ EN )) = {κ1 , . . . , κm } = µ (RN ), which, after taking
the inverse of µ, can be associated to the reaction sets of the (N + 1)th and N th network
int
respectively. In particular, if GN
is the intermediate graph associated to GN then applying
int
int
π − to (the edge set of) GN
will yield GN and applying π + to (the edge set of) GN
will yield
GN +1 .
Example 3.10 (Processive Phosphorylation).
ES1
κ

7

κ8

ES0
F S1

κ9 0
κ1

1

F +P

κ4
κ5
κ1
κ2

κ1

E + S0

F S2
14

κ3
κ6

E+P
F + S0

(13)

The reaction scheme for the first intermediate network of the processive phosphorylation
family. If κ1 = κ2 = κ3 = 0 then the N = 2 site network is obtained. Equivalently, if
we let κ7 = κ8 = κ9 = κ10 = κ11 = 0, then we obtain the N = 1 site network. The
corresponding steady state ideals can be obtained in this manner from the ideal from the
intermediate network.

3.2

Toric Families

As described in Definition 2.8, a reaction network is called toric if it has toric steady states.
Showing whether a chemical reaction network is toric is a non-trivial task; previous results
have used deficiency theory [11], network structure based methods [19] or methods based
on detecting binomiality [44]. Formally, one needs to find the associated primes of a steady
state ideal and compute a Gröbner basis of each. If the reduced Gröbner basis is binomial,
then the ideal is a prime binomial ideal [43]. However, as every toric variety has nonzero components, removing any components of the steady state variety contained in the
coordinate axes is often a first step towards identifying the toric components. Algebraically
this removal is accomplished by computing the saturation I ∞ = I : (x1 · · · xn )∞ , [45]. In this
subsection we prove a series of small results regarding the steady state ideals of families of
toric networks. First, we define a toric family.
Definition 3.11 (Toric family). If every member of a family of networks is a toric chemical
reaction network, the family is called a toric family.
Remark 3.12. Prominent examples of toric families are multisite phosphorylation networks
or compartmentalised diffusion networks.
Lemma 3.13 states that saturation and the evaluation map, π, commute. Therefore, the
network operation of deleting edges in the reaction graph can be carried out before, or after,
finding the prime binomial ideal in the steady state ideal.
Lemma 3.13. Let π − be the evaluation map (12) and let IN +1 ,
IN
⊆
R[κ1 , . . . , κm+m0 , x1 , . . . , xn+n0 ] be the steady state ideals of the (N + 1)th and N th family
member respectively. Then it holds that
(i) π − (IN +1 ) : (x1 , . . . , xn+n0 )∞ = π − (IN +1 : (x1 , . . . , xn+n0 )∞ ),
(ii) π − (IN +1 : (x1 , . . . , xn+n0 )∞ ) = IN : (x1 , . . . , xn )∞
The proof of this lemma uses the the geometric interpretation of the statements of the
lemma and can be found in Appendix A. Suppose that N is a toric family of reaction networks
with the (N + 1)th member of the family having toric steady states specified by the binomial
ideal IN +1 . Lemma 3.13 establishes a useful connection between species (corresponding
to variables x), and reactions (corresponding to κ), or, equivalently, between vertices and
edges of a reaction graph. By the extra Condition 4 of Definition 3.2 every new edge must
either originate or end on a complex containing a new species. Hence, by applying the
15

evaluation map π − an ideal of an intermediate network INint (= IN +1 for nested subnetworks)
is automatically mapped from R[x1 , . . . , xn+n0 ] (corresponding to a network with n + n0
chemical species) to an ideal in the ring R[x1 , . . . , xn ] (corresponding to a network with n
species).
Example 3.14 (Processive Phosphorylation (cont.)). The steady state ideal corresponding
the network of Example 3.10 is
I = h − κ4 x1 x3 + (κ5 + κ3 )x5 + κ8 x7 ,
− (κ1 + κ9 )x2 x4 + (κ2 + κ6 )x6 + κ10 x8 ,
− κ4 x1 x3 + κ5 x5 + κ6 x6 ,
κ3 x5 + κ8 x7 − κ1 x2 x4 + κ2 x6 − κ9 x2 x4 + κ10 x8 ,
κ4 x1 x3 − (κ5 + κ7 + κ3 )x5 ,
κ1 x2 x4 + κ11 x8 − (κ2 + κ6 )x6 ,
κ7 x5 − κ8 x7 ,
κ9 x2 x4 − (κ10 + κ11 )x8 i ⊆ R(κ1 , . . . , κ11 )[x1 , . . . , x8 ].

(14)

As can be seen using the evaluation map π − , which sets κ7 = · · · = κ11 = 0, the variables
x7 and x8 disappear from the ideal. Further, computing the saturation I : (x1 · · · x8 )∞ and
the appropriate evaluation maps we can show that the relations of Lemma 3.13 hold using
Macaulay2 [31].
Proposition 3.15 below shows that the image of a binomial ideal under the evaluation
map π is either the constant ideal (corresponding to an empty variety) or another binomial
ideal. The proof can be found in Appendix A.
Proposition 3.15. Let R = R(κ1 , . . . , κm+m0 )[x1 , . . . , xn+n0 ] and define the partial evaluation map π : R → R(κ1 , . . . , κm )[x1 , . . . , xn+n0 ]. Suppose that IN +1 : (x1 · · · xn+n0 )∞ ⊂ R
is a binomial ideal. Then IN = π(IN +1 ) : (x1 · · · xn )∞ ⊂ R(κ1 , . . . , κm )[x1 , . . . , xn ] is
either a binomial ideal or the ideal (1). Further, for a fixed choice of rate constants
IN +1 : (x1 · · · xn+n0 )∞ ⊂ R[x1 , . . . , xn+n0 ]. Then if V (IN +1 : (x1 · · · xn+n0 )∞ ) ⊂ Rn is a
toric variety and if V (IN : (x1 · · · xn )∞ ) ∩ Rn>0 6= ∅ then V (IN ) ∩ Rn>0 is a toric variety.
Hence, by Proposition 3.15 if the intermediate network of the (N + 1)th and the N th
member of a family is toric then both, the N th and (N + 1)th members are either toric or
have empty positive steady state varieties.
Example 3.16 (Example 3.14 cont.). Explicit computations is Macaulay2 show that the
ideal I : (x1 · · · x8 )∞ is toric. We also know that the processive phosphorylation network has
positive steady states. Hence, the positive steady states of the N = 1 and N = 2 networks
are cut out by toric varieties.
A relationship between the A-matrices of successive members of toric families is now
found by considering the exponent matrices of the binomial ideals and their corresponding
A-matrices.
16

Theorem 3.17. Let IN +1 : (x1 · · · xn+n0 )∞ ⊂ R(κ1 , . . . , κm+m0 )[x1 , . . . , xn+n0 ] be a binomial
ideal defining the positive steady states of the (N + 1)th member of a family of reaction
networks. Also let π be the evaluation map which sends κm+1 = · · · = κm+m0 = 0 and assume
that IN = π(IN +1 ) ⊂ R(κ1 , . . . , κm )[x1 , . . . , xn ]. Then IN : (x1 · · · xn )∞ is binomial. Further,
for a choice of generators, let BN +1 , BN be the matrices associated to the exponents of the
binomial ideals IN +1 and IN . Similarly let AN +1 and AN be the A-matrices corresponding to
BN +1 and BN . Then:
(i) BN is a submatrix of BN +1 and,
(ii) AN is a submatrix of AN +1 , if the submatrix of BN +1 formed by the columns which
have at least one non-zero entry in the last n0 rows has rank at most n0 .
The proof can be found in Appendix A. An interesting Corollary of the above Theorem
occurs if the number of conservation relations is constant.
Corollary 3.18. Suppose the assumption of Remark 2.15 holds and that the number of
conservation relations remains constant. Then, the matrix AN is obtained from AN +1 by
deleting the last n0 of its columns.
Proof. When the dimensions of the varieties of the networks NN +1 and NN are the same,
then so do the dimensions of the left kernels of their B-matrices. Hence, by Theorem 3.17
this is the case if and only if rank(B̃) = n0 and the result follows by the Rouché-Capelli
theorem.
This section is concluded by relating the mathematical insights of the above theorems to
families of toric chemical reaction networks.
Theorem 3.19. The A-matrices of members of a family of chemical reaction networks are
submatrices of each other when the assumption of Remark 2.15 is valid, all networks considered have the same number of conservation relations and one of the following conditions
hold:
(i) The family consists of a sequence of subnetworks with toric steady states.
(ii) The family is toric with toric intermediates.
The proof can be found in Appendix A.
Example 3.20 (Processive Phosphorylation (cont.)). The processive network is toric with
toric intermediates, every family member has a finite number of positive steady states for
each set of initial conditions and the number of conservation relations is constant. The
A-matrix of the intermediate network of Example 3.10 is given by


−1 0 1 0 0 0 0 0
A =  0 −1 0 1 0 0 0 0 ,
1
1 0 0 1 1 1 1
which is identical to the A-matrix of the N = 2 network. The A-matrix of the N = 1 member
is obtained by deleting the last two columns (marked in red) of the A-matrix associated to
the intermediate network.
17

4

Matroid Theory for Toric Chemical Reaction Networks

In this section we study biochemical and algebraic question 2 regarding parameter estimation
and model rejection. We start by showing the equivalence of two matroids, an algebraic
matroid and a much simpler linear matroid. We then decorate the linear matroid with
binomials and finally apply these results to model rejection. First, we prove the that following
is a matroid.
Proposition 4.1. Let E = {x1 , . . . , xn }, S = {xi1 , . . . , xij } ⊆ E and define φA (S) by
φA (S) = {φA (xi1 ), . . . , φA (xij )}, where φA is the parameterization map of Definition 2.11.
The ground set E with the set
I = {S ⊆ E : the monomials in φA (S)are algebraically independent}
is a matroid M(E, I). Further, this matroid is isomorphic to the matroid defined by the
column vectors of the A-matrix.
Proof. Consider the image of E under φA ; this is a set of monomials. A set S of monomials
±
is algebraically independent if and only if there exists no polynomial p ∈ k[t±
1 , . . . , td ] such
that p(S) = 0. This is exactly the condition to give an independent set i ∈ I. Further, by
[48, Lemma 4.2.10], a set of monomials is independent if and only if their exponent vectors
are linearly independent. Hence, algebraic independence of φA (S) is equivalent to linear
independence of the columns of the matrix A corresponding to S.
Definition 4.2. The matroid M(A) defined by the column vectors, ai , of a full rank integer
matrix A encodes the algebraic dependencies of the concentrations at a non-zero (usually
positive) steady state of a chemical reaction network and is therefore is called the positive
steady state (PSS) matroid.
The next theorem shows that the PSS matroid and the algebraic matroid defined by the
binomial ideal are identical. Therefore, the algebraic matroid can be studied directly using
linear algebra operations on the columns of the A-matrix defining the PSS matroid. This
way bases, circuits and even circuit polynomials can be inferred trivially.
Theorem 4.3. Let Ib ⊆ R = C[x1 , . . . , xn ] be a prime binomial ideal defining a toric variety
XA,x∗ = V (Ib ) where A ∈ Zd×n is the exponent matrix of the corresponding monomial parameterization. Denote the algebraic matroid defined by Ib as M(Ib ) and the matroid defined
by the linear independence of the columns of A by M(A). Then M(Ib ) = M(A).
The proof can be found in Appendix A. We now proceed to find decorations of the PSS
matroid’s circuits which reveal the full power of the PPS matroid formulation.
Definition 4.4 (Laurent Binomial Associated to a PSS matroid circuit). Let XA,x∗ be
the toric variety defined by a full rank matrix A and a positive vector x∗ as in Definition 2.10. Let M(A) be the associated PSS matroid (Definition 4.2). Consider a circuit
18

C = {ai1 , . . . , aij−1 } ∪ {aij } ⊆ E of the matroid M(A), where {ai1 , . . . , aij−1 } ∈ I. We define
the Laurent polynomial
! j−1
j−1
 λij Y
Y λi

λi j
−λ
il
±1
Φ(C) = xij − x∗ij
x∗il
xil l ∈ R(κ1 , . . . , κm )[x±1
1 , . . . , xn ]
l=1

l=1

Pj−1

with λil ∈ Z chosen such that l=1 λil ail = λij aij and λij is positive (this is possible since
C is a circuit). The expression Φ(C) is called the Laurent binomial associated to C.
Definition 4.5 (Binomial Associated to a PSS matroid circuit). Let Φ(C) be a Laurent
binomial of a circuit C of a PSS matroid as in Definition 4.4. The binomial associated to C
is Φ(C) which is Φ(C) with the denominator cleared, i.e.
!
j−1
 λij Y

λi j λ−
+
−λ
il
xλ ∈ R(κ1 , . . . , κm )[x1 , . . . , xn ],
Φ(C) = xij x − x∗ij
x∗il
l=1

where

λ+
j

= λj if λj > 0 and zero otherwise and where λ−
j = |λj | if λj < 0 and zero otherwise.

Example 4.6. For the N = 1 site processive phosphorylation network the columns C =
{a1 , a2 , a3 } ∪ {a4 } form a circuit with a linear relation a1 − a2 + a3 = a4 . The Laurent
binomial associated to this circuit is
x∗ x∗
Φ(C) = x4 − 4∗ 2∗ x1 x3 x−1
2 ,
x 1 x3
and clearing the denominator gives the binomial
Φ(C) = x4 x2 −

x∗4 x∗2
x1 x3 .
x∗1 x∗3

By the following lemma the (Laurent) binomials associated to a PSS matroid are zero on
the steady state variety. Hence, they form a model invariant.
Lemma 4.7. Let XA,x∗ be the toric variety defined by a full rank matrix A and a positive
vector x∗ as in Definition 2.10 and let M(A) be the associated PSS matroid. If C is a circuit
in M(A) then Φ(C)(x) = 0 if x ∈ (C∗ )n ∩ XA,x∗ .
Proof.
Pj−1 Given a linearly dependent set of vectors it holds that, without loss of generality,
l=1 λil ail = λij aij for some integers λil ∈ Z and λij ∈ Z>0 . It follows that
Pj−1

t

i

λil ail

= tλij aij .

Taking the preimage under φA this can be rewritten as
(x∗ij )λij

j−1
j−1
Y
Y
λi
(xil )λil
(x∗il )−λil = xij j .
l=1

l=1

19

The following theorem states that a set of suitably chosen binomials contains only all
positive steady states as our original ideal.
Theorem 4.8. Let M(A) be the matroid associated to
T a toric chemical reaction network N
and choose a basis S and n − d circuits Ci such that i Ci = S. Then, the following holds
V (Φ(C1 ), . . . , Φ(Cn−d )) ∩ Rn>0 = V (IN ) ∩ Rn>0 .
Hence, proving that the variety V (hΦ(C1 ), . . . , Φ(Cn−d )i), when intersected with the subspace
spanned by the conservation relations, contains at least two positive points is necessary for
proving multistationarity of the original toric network given by IN .
Proof. Let Fk (x1 , . . . , xn ) = Φ(Ck ) to give W = V (F1 , . . . , Fn−d ) and also let
XA,x∗ = {(x∗1 ta1 , . . . , x∗n tan ) | t ∈ (C∗ )d }.
The containment XA,x∗ ∩ Rn>0 ⊆ W ∩ Rn>0 follows from Lemma 4.7. Now prove the other
containment. For a positive real point w ∈ W ∩ Rn>0 we must have for each k = 1, . . . , n − d
that Fk (w) = 0. Hence, by Definition 4.5,
!
j−1
 λij Y

λij λ −λ
−λil
wij w − + = x∗ij
x∗il
.
l=1

For each circuit define the vector λ̃ ∈ Zn as the
vector with non-zero entries i` corresponding
Pj−1
to the values of the coefficients of λij aij − y=1 λiy aiy = 0. and let Λ be the matrix with
rows λ̃k ; note that the rows of Λ form a basis of ker(A). Set w̃ = (wi1 , . . . , wij ) and set
x˜∗ = (x∗i1 , . . . , x∗ij ); then


w̃
x˜∗

λ̃k

= 1, which gives, λ̃k · log(w̃/x˜∗ ) = 0.

Further, log(w̃/x˜∗ ) ∈ ker(Λ) and, hence, w̃/x˜∗ is in the image of x∗ tA .
As a result of Theorem 4.8 we can restrict the study of positive steady states to the
study of the PSS matroid. The next proposition establishes a connection between the PSS
matroids of all members of a family.
Proposition 4.9. Fix a family of toric reaction networks N and let NM , NN ∈ N with
M < N . If both members of the family have the same number of conservation relations then
M(AM ) is a submatroid of M(AN ).
Proof. If the dimensions of the varieties are the same, then by Theorem 4.3 the A-matrix
of NM is a submatrix of the A-matrix of NN . Therefore, EM ⊂ EN and, trivially, any set
of linearly independent columns of any matrix is also linearly independent set of columns in
any submatrix containing these. Hence, IM = IN ∩ P(EM ).
20

4.1

Experimental Design and Compatibility

We now study how steady state matroids and submatroids can be employed in experimental
design and model rejection. For the remainder of this subsection we assume that the number
of conservation relations within a family is fixed. Hence, by Proposition 4.9 the matroids of
smaller family members are submatroids of the matroids of larger family members.
Previous related work includes the study of “complex-linear steady state invariants” [32]
and data coplanarity [33]. A study using the language of algebraic matroids explicitly can
be found in [6]. In this section we obtain results similar to [33, 34] using the PSS matroid
and the binomials of Definition 4.5 and show how they can be used in model rejection and
experimental design for entire toric families. In particular, we focus on two extreme cases,
the one of all parameters being known and the other of perfect, noise-free measurements.
Statistical version of our results could form part of a future work.
First, we determine which species need to be measured to be able to construct the steady
state locus for an entire family (if the rate constants are known).
Proposition 4.10. Fix a family of chemical reaction networks N for which the rate constants
κ associated to every family member are known. There exists a subset of species of the
smallest family member which is sufficient to measure at steady state in order to construct
a corresponding positive steady state for every subsequent family member.
Proof. Recall that x∗ is a positive vector for known constants. Choose a basis S of the PSS
matroid of the smallest family member N1 . Hence, by Definition 4.5 binomial relations can
be constructed to determine the steady state concentrations of the chemical species not in
the basis. By Proposition 4.9 any basis of N1 is a basis of the subsequent family members
and, hence, Definition 4.5 applies.
Hence, by Proposition 4.10, measuring the concentrations of all species in a basis of the
smallest network in a family is sufficient to determine the expected values of the chemical
concentrations at steady state of the entire family.
Example 4.11. A detailed study of positive steady state parameterizations for the processive
system has been carried out in [13]. Suppose we know all 11 rate constants of the one
and two site processive phosphorylation networks of the running example. In this case the
functions x∗i (κ) can be found and evaluated explicitly (e.g. see [13]). Further, the columns
a1 , a2 , a3 form a basis of R3 and hence the column space of the A matrix. Therefore, given
measurements of x1 , x2 , x3 , the expected steady state concentrations of any species xj with
j > 3 can be found as a zero of the Laurent binomial
−λj λj
Φ(C)(x) = xλ1 1 xλ2 2 xλ3 3 − (x∗1 )λ1 (x∗2 )λ2 (x∗3 )λ3 x∗j
xj .
Next, we use the PSS matroids for model selection or model rejection for perfect, that is
noise-free, data. However, the result of Lemma 4.12 could also be applied to noisy data by
following the construction in [34]. To determine whether a model is compatible with observed
data it is necessary to determine whether there exists a set of parameters {κ1 , . . . , κm } > 0
such that a measured data point {ξi1 , . . . , ξij } is an element of the steady state variety. We
proceed by formulating a parameter-free condition for model compatibility.
21

Lemma 4.12. Let N be a reaction network with PSS matroid M(A). Assume that the
rate constants are fixed but unknown, but the initial conditions are
P varied. Fix a circuit C
corresponding to the linear relations among the columns of A via j−1
l=1 λil ail = λij aij . Given
a pair of steady state measurements {ξi1 , . . . , ξij } and {ζi1 , . . . , ζij } of the concentrations of
C, the corresponding model is compatible only if
λi

ξij j

j−1
Y

−λil

ξil

λi

= ζij j

l=1

j−1
Y

−λil

ζil

.

l=1

∗
n
Proof. As in Remark 2.13 we fix rate constants κ = (κ1 , . . . , κm )T ∈ Rm
>0 such that x ∈ R>0 .
Rearrange Φ(C) of Definition 4.4 to give
!
j−1
j−1
 λij Y

λij Y −λi
−λ
il
xil l = x∗ij
x∗il
= θ ∈ R>0 .
xi j
l=1

l=1

For the measurements to be compatible we must have that when we evaluate the expression
above at xil = ξil and at xil = ζil we obtain the same value, θ. The conclusion follows.
Example 4.13. Suppose we wanted to test whether some data we obtained could originate
from a processive phosphorylation system. We set up the experiment using two different initial conditions and measured the concentrations of the elements of the circuit {x1 , x2 , x3 , x4 }
and based on the results of the previous section we know that (x1 x3 )/(x2 x4 ) = const. Let the
two ideal data points be ξ = {5/2, 3/10, 10/8, 875/96} and ζ = {1/2, 3/5, 1/8, 35/384}. A
priori these data seem unrelated, however, by using the circuit information we find that
ζ1 ζ3
ξ1 ξ3
=
.
ξ2 ξ4
ζ2 ζ4
Therefore, the data are compatible with the processive model. Note that the relation holds
equally for the one-site and two-site model and we can conclude that the entire family is
compatible.
Due to the additional structure provided by the PSS matroid the condition of Lemma
4.12 is much simpler than the linear algebra condition of [33]. By Proposition 4.9 it is easy
to see that if Lemma 4.12 holds for a given PSS matroid it holds for all of its submatroids.
Hence, measuring only a subset of species which belongs to a small member of the family tells
us that the measurements of this subset of species is compatible for all subsequent family
members. This allows us to determine that a given data set is compatible with a family of
networks, but we cannot specify which network in the family is ‘most’ compatible with the
data.
Identifying model parameters for perfect data has been studied extensively in previous
work [49, 50, 51] and, therefore, the discussion in this chapter is restricted to the novel
methods obtained by using the PSS matroid of a family of networks. In particular, the
PSS matroid allows for straightforward conversion of a variety in the space of species to a
22

variety in the space of parameters. We first show that, in the case of toric steady states the
biochemically viable parameter sets, κ = (κ1 , . . . , κm )T ∈ Rm
>0 , are the positive part of an
algebraic variety and then generalise this result to the entire family.
Proposition 4.14. Let A be a full rank d × n integer matrix and let C1 , . . . , Cn−d be a collection of circuits of the matroid M(A), each containing the same basis S. Using Definition
4.4 to obtain the ideal J = hΦ(C1 ), . . . , Φ(Cn−d )i ⊆ R = R(κ1 , . . . , κm )[x1 , . . . , xn ] and denoting the variables present in a circuit as x(C1 ) ⊆ {x1 , . . . , xn }, then the intersection ideal
JCi = J ∩ R(κ1 , . . . , κm )[x(Ci )] is principal (generated by one element) with generator Φ(Ci ).
Proof. By construction both, the numerator and the denominator of Φ(Ci ) contain only
variables in Ci and, hence, after clearing the denominator the resulting polynomial Φ(Ci )
also only contains variables in Ci . Since Ci is a circuit, the ideal JCi has codimension 1 in
R ∩ R(κ1 , . . . , κm )[x(Ci )] and, hence, by [52, I.,§7, Proposition 4] it is principal. Further,
J ∩ R(κ1 , . . . , κm )[x(Ci )] = hΦ(Ci )i and, therefore, JCi = hΦ(Ci )i.
Proposition 4.14 shows that the positive part of the steady state variety can easily
be projected onto coordinate subspaces by dropping circuits. Hence, the PSS matroid
allows for some freedom to “pick and mix” variables according to measurements. The
picking and mixing corresponds to the geometric operation of projection of the variety
X = V (hΦ(C1 ), . . . , Φ(Cn−d )i) ⊆ R(κ1 , . . . , κm )n . Next, suppose there exists a measurement ξ = {ξi1 , . . . , ξi` +d } containing measurements for the species in a basis S of the PSS
and the species in the circuits C1 , . . . , C` , all containing S. Combining the idea of projection
and measurement (evaluation) leads to the definition of a parameter variety.
Definition 4.15. Keeping the same notation as above and, by choosing an appropriate set of generators, i.e. “clearing the denominators”, let J = hΦ(C1 ), . . . , Φ(C` )i ⊆
R[κ1 , . . . , κm , x1 , . . . , xn ]. Hence, V (J) ⊂ Rm × Rn . The parameter variety, Xm , is obtained
from V (J) by the evaluation
Xm = V (J) ∩ V (hxi1 − ξi1 , . . . , xi`+d − ξi`+d i) ⊆ Rm .
The parameter variety is obtained by the selective projection and evaluation of the binomials obtained from Definition 4.5 and is a variety in the space of parameters only. Every
parameter vector compatible with the measurement ξ is on the parameter variety. Every
set of measurements gives rise to a parameter variety and, in order to be compatible with
a model, their intersection needs to be non empty, in fact, their intersection needs to be
non empty in the positive orthant. In order to uniquely identify a model based on a given
measurement the positive orthant of Xm needs to consist of a single point only. Various
algebraic techniques can be applied to show when this is the case, e.g. [45, 53].
The parameter varieties of families of toric networks can be related by applications of
projections (selective application of Definition 4.5) and the partial evaluation map π. Suppose JN and Jint are the ideals of the N th member of a family and the intermediate model
between the N th and (N + 1)th member, respectively. Let both ideals (or a projection of
them) contain the same circuits C1 , . . . , C` . Then, by Proposition 3.15, JN = π(Jint ).
23

5

Inheritance of Multistationarity for Toric Families

In this section we investigate the inheritance of multistationarity among members of families
of toric chemical reaction networks. Our main result is Theorem 5.2, where we apply results
of [24, 53] to show that if we can find a multistationary member of a family (satisfying
certain conditions), then every larger member of the same family is multistationary for some
parameter values. We begin by introducing some notation.
Definition 5.1. Let IB ⊂ R[x1 , . . . , xn ] be a prime binomial ideal defining a complete intersection of codimension n − d and let the matrix B be an exponent matrix of a minimal
generating set of IB . Define
 
Z
J=
BT
where Z is an integer matrix. Further, let
λ

J =




Z
λ ,
BT

λ
where B T = (b1 λ1 , . . . , bn λn ) for the columns bi of B T . We call J λ regular if det(J λ ) 6= 0
for some values of (λ1 , . . . , λn ).
We now state the main theorem of this section.
Theorem 5.2. Fix a family of toric chemical reaction networks. Suppose that the family
obeys the following conditions.
(C1) The family has toric intermediates.
(C2) The number of conservation relations stays constant.
(C3) The matrix J λ for the N th network is regular.
Then, if the N th member of the family is capable of multistationarity, every member of the
family for which M ≥ N is also capable of multistationarity.
Before proving the theorem above we prove the following lemma.
Lemma 5.3. Fix a family of reaction networks, where each member of the family and each
intermediate network have the same number of conservation relations. Let ZN be a conservation relation matrix of the N th network. Then, ZN +1 is obtained by adding columns to ZN ,
i.e. ZN is a submatrix of ZN +1 .
Proof. First, build the stoichiometric matrix of the intermediate network by adding n0 species
and m0 reactions to the N th network. Hence, the stoichiometric matrix of the intermediate
network, Γint
N , has the form


ΓN
int
Γ̃N ,
ΓN =
0n0 ×m
24

where ΓN = (r1 , . . . , rm ) is the n × m stoichiometric matrix of the N th network and, Γ̃N =
(rm+1 , . . . , rm+m0 ) is the (n + n0 ) × m0 matrix of new reactions. Hence, any basis of the
0
left kernel of Γint
N can be written as z̃i = (zi , zi ), where zi is an element of a basis of the
left kernel of ΓN or zero and zi0 is a vector to be determined by Γ̃N . The assumption of
0
equidimensionality of the left kernels of ΓN and Γint
N can be satisfied only if rank(Γ̃N ) = n
and, in the same fashion as Corollary 3.18, it follows, that ZN is a submatrix of ZNint . Now,
delete m00 of the first m columns of Γint
N to form ΓN +1 . By the equidimensionality assumption
it follows, that the rows of ZNint form a basis of the left kernel of ΓN +1 . Hence, ZNint = ZN +1
and ZN is a submatrix of ZN +1 .
From Lemma 5.3 and Theorem 4.8 it becomes apparent why (C2) and toric steady states
are required. Namely, toric steady states are needed to construct a matrix B and, hence, JNλ
and (C2) is required to ensure that the conservation relation matrices are submatrices. The
proof of Theorem 5.2 is now stated.
Proof. Fix a vector x∗ ∈ Rn>0 as in Definition 4.4 and choose a basis S and n − d circuits
th
{C
T 1 , . . . , Cn−d } of the PSS matroid associated to the N member of a family such that
i Ci = S. Consider the polynomial system
Φ(C1 )(x) = · · · = Φ(Cn−d )(x) = ZN · x − c = 0.

(15)

Further, let BN denote the exponent matrix of the binomials Φ(C1 ), . . . , Φ(Cn−d ). Hence,
following the construction of Definition 5.1 we obtain the square matrix


ZN
λ
 .
JN =
T λ
BN
By construction (see Theorem 4.8), V (Φ(C1 )(x), · · · , Φ(Cn−d )(x)) ∩ Rn>0 6= ∅. By [24, Theorem 2.7] the system (15) is multistationary if and only if either det(JNλ ) = 0 or det(JNλ ) 6= 0
and the polynomial det(JNλ ) in λ1 , . . . , λn has a positive and a negative term. Suppose
the N th network is multistationary and, by condition (C3), det(JNλ ) 6= 0. Next, build the
(N + 1)th network by adding n0 new species and consider its matrix JNλ +1 . To obtain this
matrix consider the new circuit binomials Φ(Cn−d+1 )(x) = · · · = Φ(Cn+n0 −d )(x) = 0, where
each circuit contains the basis S and one new variable xn+i with its corresponding positive
exponent bn+i , where i = 1, . . . , n0 . The exponent vectors will therefore have exactly one
non-zero element (namely the positive integer bn+i ) in the last n0 rows. Therefore, the matrix
JNλ +1 has the block form


ZN +1 |[(1...d)×(n+1...n+n0 )]
λ
JN

0(n−d)×l
JNλ +1 = 

λ
T
BN
|[(n−d+1...n+n0 −d)×(1...n)]
diag(bn+1 λn+1 , . . . , bn+n0 λn+n0 )
+1
where A|[y1 ...ym ×a1 ...an ] denotes the restriction of a matrix A to the rows y1 . . . ym and columns
a1 . . . an . The matrix diag(bn+1 λn+1 , . . . , bn+n0 λn+n0 ) is a diagonal
Q matrix
 with diagonal elen+n0
λ
ments bn+1 λn+1 , . . . , bn+n0 λn+n0 . Hence, the expression T =
i=n+1 bi λi det(JN ) 6= 0 must
25

appear in det(JNλ +1 ) and, in particular, no term in T can be cancelled by any other term
appearing in det(JNλ +1 ). Hence, if det(JNλ ) has coefficients of opposite sign so does det(JNλ +1 )
and, therefore the network is multistationary. The proof is completed by induction.
Remark 5.4. Note that, since we are allowed to choose different bases of the PSS matroid,
and hence, different binomial systems it may be possible to satisfy condition (C3) of Theorem
5.2 for one particular choice of basis but not for a different choice of basis.
We illustrate our results using the two and three site distributive phosphorylation networks.
Example 5.5. The PSS matroid of the one-site and two-site
networks are represented by the A-matrices



1 0 0 1 1 1
1 0 0 1



A1 = 1 1 0 0 1 1 and A2 = 1 1 0 0
0 0 1 1 1 1
0 0 1 1

distributive phosphorylation

1 1 2 2 2
1 1 0 1 1 ,
1 1 1 1 1

respectively. Hence, choosing a basis of a1 = (1, 1, 0)T , a2 = (0, 1, 0)T and a3 = (0, 0, 1)T we
find a parameterization for the one-site network as
x2 x4 − x∗2 x∗4 (x∗1 x∗3 )−1 x1 x3 = 0,
x5 − (x∗1 x∗3 )−1 x∗5 x1 x3 = 0,
x6 − (x∗1 x∗3 )−1 x∗6 x1 x3 = 0.
The two-site model has three additional equations, namely
x22 x7 − (x∗1 )−2 (x∗3 )−1 (x∗2 )2 x∗7 x21 x3 = 0,
x2 x8 − (x∗1 )−2 (x∗3 )−1 x∗2 x∗8 x21 x3 = 0,
x2 x9 − (x∗1 )−2 (x∗3 )−1 x∗2 x∗9 x21 x3 = 0.
Hence, we get the B-matrices

−1
−1



−1 1 −1 1 0 0
−1
T
T


B1 = −1 0 −1 0 1 0 and B2 = 
−2

−1 0 −1 0 0 1
−2
−2
The conservation relations

−1 −1 1

1
0 0
Z1 =
0
1 0

1
0
0
2
1
1

−1
−1
−1
−1
−1
−1

1
0
0
0
0
0

0
1
0
0
0
0

0
0
1
0
0
0

0
0
0
1
0
0

0
0
0
0
1
0


0
0

0
.
0

0
1

can be chosen as



1 0 0
−1 −1 1 1 0 0 1 0 0
0 1 0 and Z2 =  1
0 0 0 1 0 0 1 0 .
0 0 1
0
1 0 0 0 1 0 0 1
26

This leads to
det (J1λ ) = λ3 λ4 λ5 + λ1 λ4 λ6 + λ3 λ4 λ6 + λ3 λ5 λ6 + λ4 λ5 λ6 .
Note that this determinant is square-free and homogeneous as investigated in [23] and that it
has only coefficients equal to +1. Indeed, it is a well known fact the the one-site distributive
network is monostationary [54]. The determinant of J2λ is equal to
det(J2λ ) = − λ2 λ3 λ4 λ5 λ7 λ8 − λ1 λ2 λ3 λ6 λ7 λ8 − λ1 λ2 λ4 λ6 λ7 λ8 − λ1 λ3 λ4 λ6 λ7 λ8 − λ2 λ3 λ4 λ6 λ7 λ8
− λ2 λ4 λ5 λ6 λ7 λ8 + λ3 λ4 λ5 λ6 λ7 λ8 − λ1 λ2 λ3 λ4 λ5 λ9 − λ1 λ2 λ3 λ5 λ6 λ9 − 2λ1 λ2 λ4 λ5 λ6 λ9
− λ2 λ3 λ4 λ5 λ6 λ9 + λ1 λ3 λ4 λ5 λ7 λ9 + λ1 λ3 λ5 λ6 λ7 λ9 + 2λ1 λ4 λ5 λ6 λ7 λ9 + λ3 λ4 λ5 λ6 λ7 λ9
− 2λ2 λ3 λ4 λ5 λ8 λ9 − λ1 λ2 λ3 λ6 λ8 λ9 − 2λ1 λ2 λ4 λ6 λ8 λ9 − λ1 λ3 λ4 λ6 λ8 λ9 − 2λ2 λ3 λ4 λ6 λ8 λ9
− λ2 λ3 λ5 λ6 λ8 λ9 − 2λ2 λ4 λ5 λ6 λ8 λ9 + λ3 λ4 λ5 λ6 λ8 λ9 + λ7 λ8 λ9 det(J1λ ),
and, therefore, contains a term T = λ7 λ8 λ9 det(J1λ ). The determinant of the two-site network
has coefficients of opposite signs and, hence, the network is multistationary and so are all
larger networks in the family. In particular, it is known that the N -site distributive network
has a maximum of 2N − 1 positive steady states [54].

6

Conclusion

In this paper we studied families of chemical reaction networks with toric steady states,
which we called toric families. First, we investigated the dimensions and parameterizations
of toric steady state varieties and connected them to network properties whenever possible.
In particular, if there is a finite number of positive steady states for all choices of c1 , . . . , cd ,
then the number of conservation relations determines the dimension of the toric steady state
variety and, with certain restrictions, the monomial parameterization of a chemical species
Xi is preserved throughout the family.
We next studied the PSS matroid defined by the parameterization of the positive steady
states. In particular, we proved that the algebraic matroid defined by the binomial steady
state ideal is equivalent to the PSS matroid. We showed how the PSS matroid can be
decorated with binomials and how they can be used for model selection, experimental design
or even parameter identification.
The final section investigated the multistationarity structure of toric families. The main
result of the section showed that, under some mild restrictions, if a member of a family is
capable of multistationarity then all larger members are too. This result was proved using
the binomials constructed from the PSS matroids. We illustrated our results on the multisite
distributive phosphorylation network.
Further research could include applying the results of this paper to other meaningful
biochemical families such as different models for immune system reactions, e.g. [1, 55].
Another direction could be to study the parameter varieties defined in this paper in the
context of previous identifiability research and aim to include noisy data.
27

Acknowledgements
The authors would like to thank the American Institute of Mathematics (AIM) for initiating this collaboration, the Erwin Schödinger Institute, Vienna (ESI) and the Institute for
Computational and Experimental Research in Mathematics (ICERM) where part of the research was carried out. MFA would like to thank the EPSRC for supporting this research
through grant EP/G03706X/1 and Merton College Oxford. MH was partially supported by
the Independent Research Fund of Denmark. The authors would like to than Elisenda Feliu
and Heather Harrington for helpful comments on the manuscript.

7

Appendix A: Additional Proofs

7.1

Proof of Lemma 3.13

Proof. Note that V (L) − V (x1 · · · xn+n0 ) = V (L). Hence,
XN +1 ∩ V (L) − V (x1 · · · xn+n0 ) = (XN +1 − V (x1 · · · xn+n0 )) ∩ (V (L) − V (x1 · · · xn+n0 ))
= (XN +1 − V (x1 · · · xn+n0 )) ∩ (V (L) − V (x1 · · · xn+n0 ))
= (XN +1 − V (x1 · · · xn+n0 )) ∩ V (L),
which proves the first statement. For the second statement note that, by construction of the
n
n0
evaluation map, XN +1 ∩ V (L) = XN ⊂ Cm
κ × Cx × C . Hence,
XN +1 − V (x1 · · · xn+n0 ) ∩ V (L) = XN +1 ∩ V (L) − V (x1 · · · xn+n0 )
= XN − V (x1 · · · xn+n0 )
= XN − V (x1 · · · xn ).

7.2

Proof of Proposition 3.15

Proof. By assumption IN +1 : (x1 · · · xn+n0 )∞ is a binomial ideal, hence,
+

−

+

−

bν
b1
b1
+ bν
− Ξ−
IN +1 : (x1 · · · xn+n0 )∞ = (Ξ+
− Ξ−
1 x , . . . , Ξν x
ν x ),
1x
+

−

+ bj
− bj
where Ξ±
j are polynomial functions of the rate constants. For each term βj = Ξj x − Ξj x
+

−

bj
bj
it holds that π(βj ) = π(Ξ+
− π(Ξ−
j )x
j )x , hence either:
−
• π(βj ) = 0, this happens if π(Ξ+
j ) = π(Ξj ) = 0;
−
• π(βj ) is a monomial, this happens if one of π(Ξ+
j ) or π(Ξj ) evaluates to zero and the
other does not;
−
• π(βj ) = βj0 and still binomial, this happens when both π(Ξ+
j ) 6= 0 and π(Ξj ) 6= 0.

28

If π(βj ) is a monomial for any j then the ideal π(IN +1 ) : (x1 · · · xn+n0 )∞ = (1), otherwise,
it must be a binomial ideal generated by the βj such that π(βj ) = βj0 . By Lemma 3.13 this
ideal is the binomial ideal IN : (x1 · · · xn )∞ .
Since for a fixed choice of rate constants IN : (x1 · · · xn )∞ is a binomial ideal in
R[x1 , . . . , xn ] and it is assumed that V (IN ) has a nonempty intersection with the positive
orthant Rn>0 then the last statement follows by [46, Proposition 5.2]. This Proposition states
that if I is a binomial ideal with variety V (I) at most one of its irreducible components
intersects Rn>0 .

7.3

Proof of Proposition 3.17

Proof. First statement (i) is proved. By assumption IN +1 : (x1 · · · xn+n0 )∞ is a binomial
ideal, hence,
+

−

+

−

b1
b1
+ bν
bν
IN +1 : (x1 · · · xn+n0 )∞ = (Ξ+
− Ξ−
− Ξ−
1x
1 x , . . . , Ξν x
ν x ).

By Proposition 3.15 it follows that if IN : (x1 · · · xn )∞ is not empty, then it is also a binomial
− b−
b+
+ b+
− b−
ν
ν
1
1
ideal and its set of generators must appear in π(Ξ+
1 x − Ξ1 x , . . . , Ξν x − Ξν x ). Hence,
its matrix of exponents can be obtained by choosing a subset (of size µ ≤ ν) of the exponent
−
+ −
vector pairs (b+
1 , b1 ), . . . , (bν , bν ). By definition of the matrix B, it follows that BN is a
submatrix of BN +1 , proving (i).
Note that no variables in xn+1 , . . . , xn+n0 appear in IN and, hence, the subset of ex−
∞
ponent vectors bi = b+
have the general form bi =
i − bi defining IN : (x1 · · · xn )
T
(bi1 , . . . , bin , 0, . . . , 0) . Further, the entries of the remaining ν − µ exponent vectors have at
least one non-zero entry in the last n0 rows and these vectors can be collected into a matrix
B̃. Hence, BN +1 may be written in block form as


BN
B̃ .
BN +1 =
0n0 ×µ
It is clear that the first n entries of any basis vector of the left kernel of BN +1 must form
a vector in the left kernel of BN . Hence, the left kernel of BN +1 has a basis of the form
ãi = (ai , āi ), where ai is an element of a given basis of the left kernel of BN or the zero
0
vector and āi ∈ Zn is a vector of variables to be determined. From the rank condition it
is clear that the matrix B̃ has a rank of at most n0 and, for any given i, a system of linear
equations is obtained, ãi b̃ = 0, for all columns b̃ of B̃. Due to the rank condition, this system
has always at least one (rational) solution and, hence, the collection of all solutions form a
basis of the left kernel of BN +1 to give the matrix AN +1 (after clearing the denominators by
multiplications of rows with scalars). Therefore, AN can be chosen as a submatrix of AN +1 ,
proving (ii).

7.4

Proof of Theorem 3.19

Proof. Part (i) follows immediately from Theorem 3.17. To prove (ii), suppose IN and
IN +1 are the (binomial) steady state ideals of two members of a family and IN0 +1 is the
29

steady state ideal of their intermediate network. It follows from Theorem 3.17 that the Amatrices of IN and IN +1 are submatrices of the A-matrix of the intermediate. Each column
of the A-matrix corresponds to a variable xi . Since both IN0 +1 and IN +1 are ideals with
species {x1 , . . . , xn+n0 } then their associated A-matrices have the same number of columns.
Further, by assumption, the number of conservation relations stays constant. Therefore, by
Proposition 2.14 the A matrices associated to IN0 +1 and IN +1 are the same, since the ideals
have the same dimension, meaning the A-matrices must have the same number of rows.
Hence, the A-matrices associated to IN and IN +1 are submatrices; i.e. AN is a submatrix of
AN +1 .

7.5

Proof of Theorem 4.3

Proof. The variables of the ground set of M(A) have algebraic dependencies as defined in
Proposition 4.1. Hence, their algebraic dependencies can be found by solving the implicitization problem I = J ∩ R(κ1 , . . . , κm )[x1 , . . . , xn ] where J = hx1 − x∗1 ta1 , . . . , xn − x∗n tan i.
However, the same ideal defines the implicit equations of a toric variety defined by
ψA : t → (x∗1 ta1 , . . . , x∗n tan ). Hence, the algebraic relations between the monomials φA (x)
are identical to the algebraic relations defined by the binomial ideal Ib . This implies that
M(A) = M(Ib ).

References
[1] T.W. McKeithan, Kinetic proofreading in T-cell receptor signal transduction, PNAS 92
(1995),5042-5046.
[2] C. Salazar, T. Höfer, Multisite protein phosphorylation - from molecular mechanisms to kinetic
models, FEBS Jour., 276(12) (2009), 31773198.
[3] J. E. Ferrell, R. R. Bhatt, Mechanistic studies of the dual phosphorylation of mitogen-activated
protein kinase, Jour. Biol. Chem., 272(30) (1997), 1900816.
[4] W. R. Burack, T. W. Sturgill, The activating dual phosphorylation of MAPK by MEK is
nonprocessive, Biochem., 36(20) (1997), 59295933.
[5] A. A. Lee, M. J. Senior, M. I. Wallace, T. E. Woolley, I. M. Griffiths, Dissecting the selfassembly kinetics of multimeric pore-forming toxins, Jour. Roy. Soc. Int., 13(114) (2016).
[6] E. Gross, H. A. Harrington, Z. Rosen, B. Sturmfels, Algebraic systems biology: a case study
for the Wnt pathway, Bull. Math. Biol., 1;78(1) (2016), 21-51.
[7] J. Gunawardena, Chemical reaction network theory for in-silico biologists, http://vcp. med.
harvard. edu/papers/crnt. pdf. (2003).
[8] M. Thomson, J. Gunawardena,The rational parameterisation theorem for multisite posttranslational modification systems, Jour. Theor. Biol., 261(4) (2002), 626636.
[9] K. Holstein, D. Flockerzi, C. Conradi, Multistationarity in sequential distributed multisite
phosphorylation networks, Bull. Math. Biol. 75(11) (2013), 2028-2058.
[10] P. Y. Yu, G. Craciun, Mathematical Analysis of Chemical Reaction Systems, Israel Jour. of
Chem., (2018).

30

[11] G. Craciun, A. Dickenstein, A. Shiu, B. Sturmfels,Toric dynamical systems, Jour. Symb.
Comp., 44(11) (2009), 15511565.
[12] B. Sturmfels:Gröbner Bases and Convex Polytopes, University Lecture Series, Vol 8, American
Mathematical Society, Providence, RI, 1996.
[13] C. Conradi, and A. Shiu: A global convergence result for processive multisite phosphorylation
systems, Bull. Math. Biol., 77(1) (2015), 126-155.
[14] A. Cornish-Bowden A, Fundamentals of Enzyme Kinetics, John Wiley & Sons (2013).
[15] L. Michaelis, M. L. Menten, Die Kinetik der Invertinwirkung, Biochem. Z, 49 (1913), 333369.
[16] M. Feinberg, Chemical reaction network structure and the stability of complex isothermal
reactors-I. The deficiency zero and deficiency one theorems, Chem. Eng. Sci., 42(10) (1987),
22292268.
[17] M. Feinberg, Chemical reaction network structure and the stability of complex isothermal
reactors-II. Multiple steady states for networks of deficiency one, Chem. Eng. Sci., 43(1)
(1988), 1-25.
[18] W. Fulton: Introduction to Toric Varieties. Princeton University Press; 1993.
[19] M. P. Millán, A. Dickenstein, A. Shiu, C. Conradi, Chemical reaction systems with toric steady
states, Bull. Math. Biol., 74(5) (2012), 1027-1065.
[20] B. Joshi, A. Shiu, A survey of methods for deciding whether a reaction network is multistationary, Math. Model. Nat. Phenom., 10 (2015), 47-67.
[21] C. Conradi, E. Feliu, M. Mincheva, C. Wiuf, Identifying parameter regions for multistationarity, PLoS Comp. Biol., 13(10) (2017), e1005751.
[22] M. Mincheva, M. R. Roussel. Graph-theoretic methods for the analysis of chemical and biochemical networks. I. Multistability and oscillations in ordinary differential equation models,
Jour. Math. Biol., 55(1) (2007), 61-86.
[23] A. Dickenstein, M.P. Millan, A. Shiu, X. Tang, Multistationarity in Structured Reaction Networks. Bulletin of Mathematical Biology. May 2019, Volume 81, Issue 5, pp 15271581.
[24] A. Sadeghimanesh, E. Feliu, The multistationarity structure of networks with intermediates
and a binomial core network, arXiv preprint arXiv:1808.07548. (2018).
[25] B. Joshi, A. Shiu. Atoms of multistationarity in chemical reaction networks, Jour. Math.
Chem., 51(1) (2013), 153-78.
[26] E. Gross, H.A. Harrington, N. Meshkat, A. Shiu, Joining and decomposing reaction networks,
arXiv preprint arXiv:1810.05575. (2018).
[27] M. Banaji, C. Pantea, The inheritance of nondegenerate multistationarity in chemical reaction
networks, SIAM Jour. Appl. Math., 78(2) (2018), 1105-30.
[28] M. Pérez Millán, A. Dickenstein, The structure of MESSI biological systems, SIAM Jour. Appl.
Dyn. Sys., 7;17(2) (2018), 1650-82.
[29] J.G. Oxley, Matroid theory. Oxford University Press, USA; (2006).
[30] Z. R. Rosen, Algebraic Matroids in Applications, Doctoral dissertation, University of California,
Berkeley (2015).
[31] D. Grayson and M. Stillman:Macaulay2, a software system for research in algebraic geometry,
available at www.math.uiuc.edu/Macaulay2/.
[32] R.L. Karp, M.P. Millan, T. Dasgupta, A. Dickenstein, J. Gunawardena, Complex-linear invariants of biochemical networks, Jour. Theor. Biol., 311 (2012), 130-8.

31

[33] H.A. Harrington, K.L. Ho, T. Thorne, M.P. Stumpf, Parameter-free model discrimination
criterion based on steady-state coplanarity, PNAS, 109(39) (2012), 15746-51.
[34] A.L. MacLean, Z. Rosen, H.M. Byrne, H.A. Harrington, Parameter-free methods distinguish
Wnt pathway models and guide design of experiments, PNAS, 13 (2015), 201416655.
[35] F. Horn, R. Jackson, General mass action kinetics, Arch. Rat. Mech. Anal., 1;47(2) (1972),
81-116.
[36] J. Wei, On single interior spike solutions of the GiererMeinhardt system: uniqueness and
spectrum estimates, Europ. Jour. Appl. Math., 10(4) (1999),353-78.
[37] H. Kim, E. Gelenbe, Stochastic gene expression modelling with Hill function for switch-like
gene responses, IEEE/ACM TCBB. 1;9(4) (2012), 973-9.
[38] D. Cox, J.Little, H. Schenck. Toric varieties. American Mathematical Soc.; 2011.
[39] Z. Rosen, Computing algebraic matroids, arXiv preprint arXiv:1403.8148. (2014).
[40] T. E. Woolley, R. E. Baker, E. A. Gaffney, P. K. Maini, Power spectra methods for a stochastic
description of diffusion on deterministically growing domains, Phys. Rev. E, 84(8718) (2011),
219152.
[41] M. Noy, A. Ribó, Recursively constructible families of graphs, Adv. in Appl. Math., 32 (2004),
350-363.
[42] E. Feliu, C. Wiuf. Simplifying biochemical models with intermediate species, Jour. Roy. Soc.
Interface, 10(87) (2013), 20130484.
[43] D. Eisenbud, B. Sturmfels, Binomial ideals, Duke Math. Jour., 84(1) (1996), 1-45.
[44] C. Conradi, T. Kahle, Detecting binomiality, Adv. Appl. Math., 71 (2015), 52-67.
[45] D. Cox, J. Little, D. O’Shea, Ideals, Varieties, and Algorithms. New York: Springer (2007).
[46] C. Conradi, A. Iosif, T. Kahle, Multistationarity in the space of total concentrations for systems
that admit a monomial parametrization, arXiv preprint arXiv:1810.08152, (2018).
[47] IM. Gelfand, M. Kapranov and A. Zelevinsky, Discriminants, Resultants, and Multidimensional Determinants, Birkhäuser, Boston, 1994.
[48] Mittmann, J., Independence in Algebraic Complexity Theory, PhD Thesis, (2013).
[49] N. Meshkat, Z. Rosen, S. Sullivant, Algebraic tools for the analysis of state space models, The
50th Anniversary of Gröbner Bases: Mathematical Society of Japan, (2018), 171-205.
[50] O. T. Chis, J. R. Banga, E. Balsa-Canto, Structural identifiability of systems biology models:
a critical comparison of methods, PloS one, 6(11) (2011), e27755.
[51] E. Walter, Identifiability of Parametric Models, Elsevier (2014).
[52] D. Mumford D, The Red Book of Varieties and Schemes, Springer Science & Business Media
(1999).
[53] S. Müller, E. Feliu, G. Regensburger, C. Conradi, A. Shiu, A. Dickenstein, Sign conditions for
injectivity of generalized polynomial maps with applications to chemical reaction networks and
real algebraic geometry, Found. Comp. Math., 16(1) (2016), 69-97.
[54] D. Flockerzi, K. Holstein, C. Conradi, N-site phosphorylation systems with 2N-1 steady states,
Bull. Math. Biol., 76(8) (2014), 1892-916.
[55] O. Dushek, P. A. van der Merwe, An induced rebinding model of antigen discrimination, Trends
Immunol., 35(4) (2014), 153-8.

32

