MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

arXiv:1907.07900v1 [math.AP] 18 Jul 2019

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA
Abstract. In this paper we study theoretical properties of the entropy-transport functional
with repulsive cost functions. We provide sufficient conditions for the existence of a minimizer
in a class of metric spaces and prove the Œì-convergence of the entropy-transport functional
to a multi-marginal optimal transport problem with a repulsive cost. We also prove the
entropy-regularized version of the Kantorovich duality.

1. Introduction
We consider the following multi-marginal entropy-transport problem
IŒµ [œÅ] =

inf

(C0 [Œ≥] + ŒµE[Œ≥]),

Œ≥‚ààŒ†sym
N (œÅ)

(1.1)

R
where C0 [Œ≥] = X N c dŒ≥ is the transportation cost related to a cost function c, E[Œ≥] is the
entropy, and Œµ ‚â• 0 is a parameter, see Section 2 for details. We consider the setting where
(X, d, m) is a Polish measure space and œÅm ‚àà Pac (X) is an absolutely continuous probability
measure with respect to the reference measure m. An element Œ≥ ‚àà Œ†sym
N (œÅ) is called a
symmetric coupling (or transport plan), that is, a symmetric probability measure in X N
having all marginals equal to œÅm.
We are interested in a class of repulsive cost functions c : X N ‚Üí R ‚à™ {+‚àû} of the form
X
c(x1 , . . . , xN ) =
f (d(xi , xj )), for all (x1 , . . . , xN ) ‚àà X N .
1‚â§i<j‚â§N

We assume f : ]0, ‚àû[‚Üí R to be a continuous and decreasing function that approaches +‚àû
if d(xi , xj ) ‚Üí 0. Among the examples of such cost functions we have the Coulomb cost
f (z) = 1/|z|, the Riesz cost f (z) = 1/|z|s , n ‚â• s ‚â• max{n ‚àí 2, 0} (in Rn ) and the logarithmic
cost f (z) = ‚àí log(|z|). We observe that when Œµ = 0, this entropy-transport problem reduces
to the classical multi-marginal optimal transport problem with repulsive costs [5, 7, 8, 12].
The motivation of this paper comes from both theory and numerics. For repulsive cost
functions, the entropy term in (1.1) plays a role of a regularizer to compute numerically a
solution Œ≥ of the multi-marginal optimal transport problem I0 [œÅ], see [2]. Numerical experiments suggest that when the regularization parameter Œµ goes to 0, the minimizer Œ≥Œµ converges
to a minimizer of I0 [œÅ] having minimal entropy among the minimizer of I0 [œÅ].
From a theoretical viewpoint, this type of a functional has direct relevance in Density
Functional Theory. By choosing carefully the parameter Œµ, the functional (1.1) provides a
lower bound for the Hohenberg-Kohn functional in Density Functional Theory [23, 26]. This
is an immediate consequence of the Log-Sobolev Inequality.
Date: July 19, 2019.
The authors acknowledge the support of the Academy of Finland, projects no. 274372, 284511, 312488,
and 314789. A.G. also acknowledges funding by the European Research Council under H2020/MSCA-IF
‚ÄúOTmeetsDFT‚Äù [grant ID: 795942].
1

2

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA

The entropy-transport problem has appeared previously in the literature in the attractive
case, in particular when c(x1 , x2 ) = d(x1 , x2 )2 . We mention briefly below some of the connections of the entropy-transport with other fields and point out the relevance in the Coulomb
case.
Brief comments on some applications of the entropy-transport
Optimal Transport and Sinkhorn algorithm: The entropy-transport (1.1) was introduced by
M. Cuturi [9] in order to compute numerically the optimal transport plan for the distance
squared cost in the 2-marginals case via the Sinkorn algorithm. Due to its reasonable computational cost, it has been applied to a wide range of problems in various research areas,
including Information Theory, Computer Graphics, Statistical Inference, Machine Learning,
and Mean-Field Games. The entropic regularization method was also considered in the (attractive) multi-marginal case in the so-called barycenter problem introduced by M. Agueh and
G. Carlier [1] (see also [6]) and in numerical methods in the time discretization of Brenier‚Äôs
relaxed formulation of the incompressible Euler equation [3]. For a thorough presentation of
the computational aspects we refer to M. Cuturi and G. PeyreÃÅ‚Äôs book [24].
Second-order Calculus on RCD spaces: N. Gigli and L. Tamanini [16] studied the entropictransport problem on a class of metric spaces with (Riemannian) Ricci curvature bounded
from below (2-marginals case, c(x1 , x2 ) = d(x1 , x2 )2 ). The entropic regularization procedure
was crucial for establishing a second-order differential structure in that setting.
SchroÃàdinger Problem: In 1926, E. SchroÃàdinger introduced the (linear) SchroÃàdinger equations
describing the non-relativistic evolution of a single particle in an electric field with potential
energy and also established an equivalence between such equations and a system of diffusion
equations [25]. Roughly speaking, the variational problem (see (1.1) with X = C([0, 1], Rd )
and N = 2) arises in the SchroÃàdinger manuscript while studying the limit k ‚Üí ‚àû (N = 2)
of the empirical measures associated to the evolution of k i.i.d. Brownian motions. We refer
the reader to C. LeÃÅonard survey [20] for technical details and historical notes.
Lower bound on the Hohenberg-Kohn functional in Density Functional Theory: This is the
particular case where the entropy-transport problem with Coulomb cost comes into play. It
has been shown in [23, 26] that the functional (1.1) provides a lower bound for computing the
ground state energy of the Hohenberg-Kohn functional [5, 7, 8, 12, 21]. Below we give a brief
description of the result. Notice that in this context X = Rd and m is the Lebesgue measure
on Rd .
‚àö
Assume that Œ≥ ‚àà Œ†N (œÅ) such that Œ≥ ‚àà H 1 (RdN ). This is the case, for example, when
Œ≥(x1 , . . . , xN ) = |œà(x1 , . . . , xN )|2 , where œà ‚àà H 1 (RdN ) is a ground-state wave function solving
the N -electron SchroÃàdinger Equation (see [7, 8, 12, 26] for details). Then, we can define the
Hohenberg-Kohn functional by
 2Z

Z
X
~
1
‚àö 2
HK
FÃÉ~ [œÅ] =
inf
|‚àá Œ≥| dx1 . . . dxN +
dŒ≥ .
‚àö
2 RdN
|xi ‚àí xj |
Œ≥‚ààŒ†N (œÅ), Œ≥‚ààH 1 (RdN )
RdN
1‚â§i<j‚â§N

Now, as a consequence of the logarithmic Sobolev inequality for the Lebesgue measure [17],
‚àö
the following result holds: if œÅLd ‚àà P(Rd ) and Œ≥ ‚àà H 1 (RdN ) then
C0 [œÅ] ‚â§ CŒµ [œÅ] ‚â§ FÃÉ~HK [œÅ],

with Œµ = œÄ~2 /2.

MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

3

Example of optimal entropy couplings. Let us present some computational examples of
minimizers of IŒµ [œÅ] illustrating the role of the parameter Œµ. Before this, we recall a result on
the characterization of minimizers in the one-dimensional case [10]. In particular, according
to it the minimizer of I0 [œÅ] is concentrated on finitely many graphs and thus singular with
respect to the product reference measure.
Theorem 1.1 ([10]). Let ¬µ ‚àà P(R) be an absolutely continuous probability measure and
f : R ‚Üí R strictly convex, bounded from below and non-increasing function. Then there exists
a unique optimal symmetric plan Œ≥ ‚àà Œìsym (¬µ) that solves
Z
X
min
f (|xj ‚àí xi |) dŒ≥.
sym
Œ≥‚ààŒ†N (¬µ) RN
1‚â§i<j‚â§N

Moreover, this plan is induced by an optimal cyclical map T , that is, Œ≥sym = (Œ≥T )S , where
Œ≥T = (id, T, T (2) , . . . , T (N ‚àí1) )] ¬µ. An explicit optimal cyclical map is
(
F¬µ‚àí1 (F¬µ (x) + 1/N )
if F¬µ (x) ‚â§ (N ‚àí 1)/N
T (x) =
F¬µ‚àí1 (F¬µ (x) + 1 ‚àí 1/N )
otherwise.
Here F¬µ (x) = ¬µ(‚àí‚àû, x] is the distribution function of ¬µ, and F¬µ‚àí1 is its lower semicontinuous
left inverse.
One-dimensional Entropic-Transport with Coulomb cost and a Gaussian measure. Let œÅ be
the normal distribution on the real line with zero mean and standard deviation œÉ = 5. We
compute numerically the solution of the entropic-transport problem with Coulomb cost in
the real line using the Sinkorn algorithm [9]. Notice that by Theorem 1.1, we know that
the minimizer of I0 [œÅ] is concentrated on a graph. See Figure 1 for an illustration of the
computational results. Our code is based on the Python implementation available at POT
library [14].

Figure 1. The dependence of the minimizer of the entropic-transport problem
(1.1) on the entropic parameter Œµ for the one-dimensional Coulomb cost, N = 2
and œÅ ‚àº N (0, 5). The pictures show part of the support of the optimal coupling
Œ≥Œµ around the origin. From the left to right: Œµ = 104 , 10‚àí2 , 10‚àí3 , 10‚àí4 , 10‚àí5 .

Organization of the paper. In Section 2 we introduce the setting and study sufficient
conditions for the existence of minimizers for the entropy-transport problem (1.1). Section 3
is devoted to the Œì‚àíconvergence proof of the entropic-transport functional CŒµ [Œ≥] to the multimarginal optimal transport with repulsive costs C0 [Œ≥]. In Section 4, we study the Kantorovich
duality for the entropic-transport problem.

4

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA

Strategy of the main proof and some technical remarks. The main result of this paper
is Theorem 3.1, in which we prove the Œì-convergence of the entropic-regularized functional
CŒµ [Œ≥] to C0 [Œ≥]. The technical difficulty on dealing with the Œì-convergence comes from the fact
that while for the entropic part E[Œ≥] the minimizer Œ≥ tends to be as spread as possible with
respect to m, for the cost C0 [Œ≥] a minimizer can be very singular and have infinite entropy.
We divide the proof in two parts. The part (I), the lim inf ‚àíinequality, follows basically
from the lower-semicontinuity of the costs C0 [Œ≥] and CŒµ [Œ≥] - which are obtained from the
assumption œÅ log œÅ ‚àà L1m (X) on the marginal measure œÅm, giving a lower bound on the entropy.
The part (II), the lim sup ‚àíinequality, is more involved. In Section 3.2, we construct a block
approximation Œ≥n0 for a coupling Œ≥ with C0 [Œ≥] < +‚àû. Such a construction is done in several
steps, since we need to construct a competitor Œ≥n0 such that E[Œ≥n0 ] < ‚àû and Œ≥n0 ‚àà Œ†sym
N (œÅ).
The main idea and the rigorous construction is done at section 3.2.
Futhermore, we point out that our construction can deal with the case when the space X
is a domain in Rd , answering a question raised in [3]. There the Œì-convergence was proven
using convolutions; an approach that does not seem to be easy to implement for domains, or
in general metric spaces.
Related works: A proof of the Œì-convergence of (1.1) to the Monge-Kantorovich problem for
c(x, y) = d(x, y)p first appeared in [19, 22] via probabilistic methods. In [6], G. Carlier, V.
Duval, G. PeyreÃÅ and B. Schmitzer provided an alternative and more analytical proof carrying
out a similar block approximation procedure for the two-marginal squared distance cost in
the Euclidean space and the Wasserstein Barycenter.
2. The entropy-regularized repulsive costs
Let (X, d) be a Polish space and m be a reference measure on X. We denote by P(X) the
set of Borel probability measures on X, and Pac (X) the set of Borel probability measures on
X that are absolutely continuous with respect to m. We denote by mN the product measure
m ‚äó m ‚äó ¬∑ ¬∑ ¬∑ ‚äó m. This is the reference measure we use on the product space X N . On X N we
use the sup-metric, which we denote by dN .
The class of cost functions c : X N ‚Üí R ‚à™ {+‚àû} of our interest is given by functions of the
form
X
c(x1 , . . . , xN ) =
f (d(xi , xj )), for all (x1 , . . . , xN ) ‚àà X N ,
1‚â§i<j‚â§N

where f : [0, ‚àû[‚Üí R ‚à™ {+‚àû} satisfies the following conditions
f |]0,‚àû[ is continuous, decreasing ,and
lim f (t) = +‚àû .

t‚Üí0+

Above and from now on, we denote by (x1 , . . . , xN ) points in X N , so xi ‚àà X for each i.
We denote by

Œ†N (œÅ) = Œ≥ ‚àà P(X N ) | pri] Œ≥ = œÅm for all i ‚àà {1, . . . , N }
the set of couplings or transport plans, where pri is the projection
pri (x1 , . . . , xi , . . . , xN ) = xi for all (x1 , . . . , xi , . . . , xN ) ‚àà X N .

(F1)
(F2)

MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

5

For the definition of the set of symmetric couplings Œ†sym
N (œÅ), see Definition 2.7. We define
the functional C0 [Œ≥] to be the cost related to the coupling Œ≥
Z
C0 [Œ≥] =
c(x1 , . . . , xN ) dŒ≥(x1 , . . . , xN ) .
XN

Given Œµ ‚â• 0, we denote by CŒµ [Œ≥] the entropy-regularized cost
for all Œ≥ ‚àà Œ†sym
N (œÅ),

CŒµ [Œ≥] = C0 [Œ≥] + ŒµE[Œ≥],

(2.1)

where the entropy E[Œ≥] : P(X N ) ‚Üí R ‚à™ {‚àí‚àû, +‚àû} is defined as
(R
E[Œ≥] =

XN

œÅŒ≥ log œÅŒ≥ dmN

+‚àû

if Œ≥  mN
.
otherwise

(2.2)

The notation œÅŒ≥ stands for the Radon-Nikodym derivative of Œ≥ with respect to the reference
measure mN and Œ≥  mN means that Œ≥ is absolutely continuous with respect to the reference
measure mN . Let œÅm ‚àà Pac (X). In this paper we are interested in the following infimum
IŒµ [œÅm] :=

inf

Œ≥‚ààŒ†sym
N (œÅ)

CŒµ [Œ≥] .

(2.3)

In order to guarantee the lower semicontinuity for CŒµ , we will assume œÅ log œÅ ‚àà L1m (X).
This will take care of the entropy part E[¬∑] of the cost. In order to establish the lower
semicontinuity for the functional C0 [¬∑], we assume that the measure œÅ satisfies the following
two conditions:
1
and
(A)
lim sup œÅ(B(x, r)) <
r‚Üí0 x‚ààX
N (N ‚àí 1)2
Z
f (2d(x, o)) dœÅ(x) > ‚àí‚àû for some o ‚àà X .
(B)
X\B(o,r0 )

Above we have, by an abuse of notation, denoted the measure œÅm by only the density œÅ; we
will use the same abbreviation in the rest of the paper if there is no risk of confusion. The
Condition (B) is a similar assumption than requiring, in the case of the quadratic cost, that
the marginal measures have finite second moments. The Condition (A) guarantees that the
cost is finite.
If we endow the spaces P(X N ) and P(X) with w‚àó -topology then, by Prokhorov‚Äôs theorem,
any subset of P(X) (or P(X N )) is tight if and only if it is relatively compact.
Remark 2.1 (Entropy-transport seen as a Kullback-Leibler divergence). If ¬µ and ŒΩ are
measures on a set X, the Kullback-Leibler divergence of ¬µ with respect to ŒΩ is defined as
 
(R
d¬µ
log
if ¬µ  ŒΩ
dŒΩ d¬µ
X
KL(¬µ|ŒΩ) =
.
+‚àû
otherwise
Now, if both measures ¬µ and ŒΩ are absolutely continuous with respect to some reference measure R of the space X with densities œÅ¬µ and œÅŒΩ , respectively, we can write:
 
(R
œÅ¬µ
œÅ
log
if ¬µ  ŒΩ
¬µ
œÅŒΩ d¬µ
X
KL(¬µ|ŒΩ) =
.
+‚àû
otherwise

6

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA

Considering the entropy-regularized MOT problem, we see that the cost functional CŒµ [Œ≥] can
be alternatively written as the Kullback-Leibler divergence between Œ≥ and a kernel Œ∫ defined
below


Z
CŒµ [Œ≥] = Œµ KL(Œ≥|Œ∫) = Œµ

œÅŒ≥ ln
XN

œÅŒ≥
œÅŒ∫


dmN ,

where Œ∫ = e‚àíc/Œµ mN .
For the most part, in this paper we have chosen to consider as a reference measure the
measure mN . However, as the following lemma shows, we could also assume the reference
measure to be (œÅm)‚äóN since the minimizers of the entropy-regularized MOT problem (2.3)
do not depend on the choice of the reference measure, at least if there exists a minimizer with
finite cost. To state the lemma, let us introduce the notation of relative entropy: for each
reference measure R of a Polish space Y , and for each Œ≥ ‚àà P(Y ), we denote by E(Œ≥|R) the
relative entropy of Œ≥ with respect to R, defined as
 
(R
dŒ≥
if Œ≥  R
log
dR dŒ≥
Y
.
E(Œ≥|R) =
+‚àû
otherwise
Now we may consider two, a priori different, entropy-regularized MOT problems: the one
introduced in (2.3)
I (œÅm) =

inf

Œ≥‚ààŒ†sym
N (œÅ)

CŒµ [Œ≥] =: I (œÅm|m) ,

(2.4)

and the problem with the reference measure chosen to be (œÅm)‚äóN
I (œÅm|œÅm) :=

inf
sym

Œ≥‚ààŒ†N (œÅ)


C0 [Œ≥] + E(Œ≥|(œÅm)‚äóN ) .

(2.5)

The folowing Lemma 2.2 is used only to go from the compact to the general case in the duality
Theorem 4.2. The proof in [11] can be directly applied here to prove Lemma 2.2.
Lemma 2.2. Let (X, d, m) be a Polish measure space, œÅm ‚àà P(X) a measure satisfying (A)
and (B), and c a cost function satisfying (F1) and (F2). Now for all  > 0 we have
Z
I (œÅm|m) = I (œÅm|œÅm) + N  KL(œÅm|m) = I (œÅm|œÅm) + N 
œÅ log œÅdm .
(2.6)
X

Moreover, whenever at least one side of the equality above is finite, the problems (2.4) and
(2.5) have the same minimizers.
2.1. Some properties of the entropy functional. Let us start by noting that the minimum of the entropy is attained by the product measure and that its value is not ‚àí‚àû.
Proposition 2.3. Let (X, d, m) be a Polish metric measure space, and let œÅm ‚àà Pac (X) with
œÅ log œÅ ‚àà L1m (X) . Then




Z
Z
N
N
min
E[Œ≥]
=
‚äó
œÅ
log
‚äó
œÅ
dm
=
N
œÅ log œÅ dm > ‚àí‚àû.
N
i=1
i=1
sym
Œ≥‚ààŒ†N (œÅ)

XN

X

MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

7

Proof. As we will see, the minimality is an immediate consequence of Jensen‚Äôs inequality. Let
Œ≥ ‚àà Œ†(œÅ). Then
 


Z
Z

œÅŒ≥
œÅŒ≥
N
œÅŒ≥ log(œÅŒ≥ ) dmN =
E[Œ≥] =
log
+ log ‚äói=1 œÅ ‚äóN
i=1 œÅ dmN
N
‚äóN
œÅ
X N ‚äói=1 œÅ
XN
i=1
 Z

Z
Z

œÅŒ≥ log ‚äóN
œÅŒ≥ dmN +
‚â•
œÅŒ≥ dmN log
i=1 œÅ dmN
=0+

XN

XN

XN

E[‚äóN
i=1 œÅ].



Using Proposition 2.3 we immediately get the lower semicontinuity of the entropy functional
by representing the entropy as relative entropy against the probability measure ‚äóN
i=1 (œÅm). See
for instance [27, Lemma 4.1] for the lower semicontinuity of the entropy when the reference
measure is finite.
Corollary 2.4. Let (X, d, m) be a Polish metric measure space, and let œÅm ‚àà Pac (X) with
œÅ log œÅ ‚àà L1m (X). Then E[¬∑] is lower semicontinuous in the set Œ†sym
N (œÅ).
Now we are ready to prove the existence of the minimizers for entropy-regularized MOT:
Proposition 2.5. Let (X, d, m) be a Polish metric measure space. Assume that the measure
œÅm ‚àà Pac (X) satisfies œÅ log œÅ ‚àà L1m (X) along with Conditions (A) and (B). Assume that
c : X N ‚Üí R ‚à™ {+‚àû} satisfies the conditions (F 1) and (F 2). Then, for each Œµ ‚â• 0, there
exists a minimizer Œ≥ ‚àà Œ†sym
N (œÅ) for the entropic-regularized cost CŒµ [Œ≥].
‚àó
Proof. We notice that the set Œ†sym
N (œÅ) is compact in the w -topology [18]. The functional E
is lower semicontinuous by Corollary 2.4, and in our setting the lower semicontinuity of C0 is
proven as a part of the proof of [15, Proposition 3.1]. Since for each Œµ ‚â• 0 the functional CŒµ

is convex, we conclude that it has a minimizer in the set Œ†sym
N (œÅ)

2.2. Some properties of the coupling cost C0 [Œ≥]. Notice that in this section Œ†N (œÅ)
denotes the set of couplings in X N (not necessarily symmetric). Moreover, we need to assume
extra hypothesis on the probability measure œÅ in order to guaranteee that C0 [Œ≥] is bounded
from below for a Œ≥ ‚àà Œ†N (œÅ) (e.g. f (z) = ‚àí log(|z|)).
The next theorem from [4] (see also [15, Theorem 3.2]) states that for measures œÅ satisfying
the assumptions (A) and (B) there exists Œ± > 0 for which the support of any optimal plan is
concentrated away from the set
DŒ± := {(x1 , . . . , xN ) ‚àà X N | d(xi , xj ) < Œ± for some i 6= j} .
Theorem 2.6. [4, Theorem 3.2] Let (X, d), œÅ, f , c be such that the measure œÅ satisfies (A)
and (B) and the function f satisfies (F1) and (F2). Let Œ≥ be a minimizer of
Z
I0 [œÅ] = min
c(x1 , . . . , xN ) dŒ≥(x1 , . . . , xN ).
Œ≥‚ààŒ†N (œÅ) X N

Let us fix 0 < Œ≤ < 1 such that
sup œÅ(B(x, Œ≤)) <
x‚ààX

1
.
N (N ‚àí 1)2

Then, we have for all
Œ±<f

‚àí1



N 2 (N ‚àí 1)
f (Œ≤)
2


(2.7)

8

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA

the inclusion
where

f ‚àí1

spt(Œ≥) ‚äÇ X N \ DŒ± ,
stands for the left-inverse of f .

(2.8)

Next we observe that one can restrict the problem minŒ≥‚ààŒ†(œÅ) C0 [Œ≥] to the class of symmetric
couplings in X N having all the marginals equal to œÅ.
Definition 2.7 (Symmetric measures). A measure Œ≥ ‚àà P(X N ) is symmetric if
Z
Z
œÜ(œÉ(x1 , . . . , xN )) dŒ≥, for all œÜ ‚àà C(X N )
œÜ(x1 , . . . , xN ) dŒ≥ =
XN

XN

for all permutations œÉ of the N symbols (x1 , . . . , xN ). We denote by Psym (X N ) the set of
sym (X N ).
symmetric probability measures in X N , and notice that Œ†sym
N (œÅ) := Œ†N (œÅ) ‚à© P
Let us also introduce the notation for symmetrized measures. If Œ≥ is a Borel measure on
X N , we denote by Œ≥ S the symmetrized measure
1 X
œÉ] Œ≥ ,
Œ≥ S :=
N!
œÉ‚ààSN

where SN is the set of permutations of the {1, . . . , N } koordinates (x1 , . . . , xN ). The following
result follows immediately.
Proposition 2.8. Under the hypothesis of Proposition 2.6, we have that
Z
Z
c(x1 , . . . , xN ) dŒ≥.
min
c(x1 , . . . , xN ) dŒ≥ = min
sym
Œ≥‚ààŒ†N (œÅ) X N

(2.9)

Œ≥‚ààŒ†N (œÅ) X N

3. The Œì-convergence of Entropic-regularized cost
Now let us turn to the Œì-convergence. From now on, (œÑn )n‚ààN is any sequence of positive
real numbers decreasing to zero. Let us introduce the following functionals: for each n ‚àà N
(
CœÑn [Œ≥] if Œ≥ ‚àà Œ†N (œÅ)
Cn : Psym (X N ) ‚Üí R ‚à™ {+‚àû}, Cn [Œ≥] =
+‚àû
otherwise
and
C:P

sym

(
C[Œ≥]
(X ) ‚Üí R ‚à™ {+‚àû}, C[Œ≥] =
+‚àû
N

if Œ≥ ‚àà Œ†N (œÅ)
.
otherwise

The goal of this section is to prove that the sequence (Cn‚ààN ) Œì-converges to C in the space
Psym (X N ).
Theorem 3.1. Let (X, d, m) be a Polish metric measure space. Let œÅ ‚àà Pac (X) with œÅ log œÅ ‚àà
L1m (X) satisfying (A) and (B). Then the sequence (Cn ) Œì-converges to C in the space Psym (X N ).
Let us fix Œ≥ ‚àà Psym (X N ). We need to show that
For each sequence (Œ≥n )n‚ààN that converges to Œ≥
we have lim inf Cn [Œ≥n ] ‚â• C[Œ≥], and
n‚Üí‚àû

(I)

There exists a sequence (Œ≥n )n‚ààN that converges to Œ≥ and
lim sup Cn [Œ≥n ] ‚â§ C[Œ≥] .
n‚Üí‚àû

(II)

MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

9

The proof of Theorem 3.1 is divided into two parts. The proof of the first part, the liminfinequality (I), is short and is established in the next subsection. The remainder of this section
is then divided into subsections in which the second part, the limsup-inequality (II) is proven.
3.1. Proof of condition (I). We fix a sequence (Œ≥n )n‚ààN that converges to Œ≥. If Œ≥ ‚àà
/ Œ†N (œÅ),
then since the set Œ†N (œÅ) is compact, for large indices we also have Œ≥n ‚àà
/ Œ†N (œÅ), so both sides
of inequality (I) are +‚àû, and we are done. Hence we may assume that Œ≥ and Œ≥n ‚Äôs are elements
of the set
R Œ†N (œÅ). Since now Œ≥n ‚àà Œ†N (œÅ), the claim (I) follows from the lower-semicontinuity
of Œ≥ 7‚Üí c dŒ≥ and from the entropy lower bound shown in Proposition 2.3.
3.2. Constructing an approximation of the coupling Œ≥. First of all, we need to construct an approximation of Œ≥ only in the case where C0 [Œ≥] < ‚àû: if this is not the case then
any sequence (Œ≥n ) converging to Œ≥ can be used to prove Condition (II). The idea of the construction is to redefine a large part of Œ≥ to be a product measure on finitely many Borel sets
with small diameter. In order not to increase the cost by too much, the Borel sets we are
using have to be far away from the diagonal compared to the diameter of the sets. We call
the part of the measure defined in this way the core part of the approximation. For the rest
of the measure, we take another finite combination of product measures. However, this time
the sets do not need to have small (or even bounded) diameter, but just small measure. This
part will be called the remainder part of the approximation.
We start the construction by taking out a small part of Œ≥ that will later be used to deal
with the remainder part of the approximation. For this we take a sequence of radii defined
as rn = 1/n. Since C[Œ≥] < ‚àû, there exists a point x = (x1 , . . . , xN ) ‚àà spt(Œ≥) with
xi 6= xj

if 1 ‚â§ i < j ‚â§ N.

Moreover, since Œ≥ ‚àà Œ†N (œÅ) and œÅ satisfies (A), we have
Œ≥({(y1 , . . . ,yN ) ‚àà X N | yi 6= xj for all i, j})
X
‚â•1‚àí
Œ≥({(y1 , . . . , yN ) ‚àà X N | yi = xj })
i6=j

=1‚àí

X

œÅ(X \ {xj }) ‚â• 1 ‚àí N (N ‚àí 1)

i6=j

1
> 0.
N (N ‚àí 1)2

Thus, using again C[Œ≥] < ‚àû, there exists another point x0 = (xN +1 , . . . , x2N ) ‚àà spt(Œ≥), so
that
xi 6= xj if 1 ‚â§ i < j ‚â§ 2N.
0
From now on, we consider x, x fixed. Therefore, for n ‚àà N sufficiently large we have
d(xi , xj ) > rn

if 1 ‚â§ i < j ‚â§ 2N.

Let us denote by
Bn := B(x, r10n )

and Bn0 := B(x0 , r10n )

the balls around x and x0 with radii rn /10 in the sup-metric of the product space. So,
y = (y1 , . . . , yN ) ‚àà Bn
if and only if
d(xi , yi ) <
and analogously for

Bn0

rn
10

for all i ‚àà {1, . . . , N } ,

with the relevant index modifications.

(3.1)

10

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA

Let us now define
Œ≥Bn

S
 Œ≥
|Bn
=
Œ≥(Bn )

and Œ≥Bn0

 Œ≥

|Bn0 S
=
.
Œ≥(Bn0 )

Observe that Œ≥Bn and Œ≥Bn0 are symmetric probability measures. Since the marginals of a
symmetric measure are the same, we may denote by œÅBn the marginal of Œ≥Bn and similarly
by œÅBn0 the marginal of Œ≥Bn0 . Let us further denote BÃÉn := spt Œ≥Bn , BÃÉn0 := spt Œ≥Bn0 and


1
rn
Œµn :=
min Œ≥(BÃÉn ), Œ≥(BÃÉn0 ), rn ,
.
(3.2)
N
f (2rn /5)
We then define a measure
Œ≥0,n :=Œ≥ |

0 )
X n \(BÃÉn ‚à™BÃÉn

+

Œ≥(BÃÉn ) ‚àí Œµn
Œ≥(BÃÉn0 ) ‚àí Œµn
Œ≥| +
Œ≥| 0 .
BÃÉn
BÃÉn
Œ≥(BÃÉn )
Œ≥(BÃÉn0 )

The idea behind the measure Œ≥0,n is that we have chopped of a small part of the measure
around the points x and x0 (symmetrically) for later use. Since we are working with a singular
cost, we still need to take out a small neighbourhood of the diagonals before approximating
by product measures. We do this now.
We fix a compact Kn ‚äÇ X such that
Œµn
Œ≥0,n (X N \ KnN ) <
(3.3)
2
and take a small enough Œ¥n ‚àà (0, rn ) so that
Œµn
Œ≥0,n (DŒ¥n ) < .
(3.4)
2
Using Kn and Œ¥n we then define
Œ≥1,n := Œ≥0,n |KnN \DŒ¥n .

(3.5)

The measure Œ≥1,n is now the core part of the measure that we approximate. We denote by
œÅ1,n the marginals of the symmetric measure Œ≥1,n .
Let us then approximate the measure Œ≥1,n . We take Œªn ‚àà (0, Œ¥n /n) so that
|f (r) ‚àí f (s)| < Œµn

for all r, s ‚àà [Œ¥n /2, 2 diam(Kn )] with |r ‚àí s| ‚â§ 2Œªn .

(3.6)

Such Œªn exists by the uniform continuity of f on the compact set[Œ¥n /2, 2 diam(Kn )]. Since
n
the set Kn is compact, we may fix a finite Borel partition {Bni }M
i=1 of the set spt(œÅ1,n ) such
that
diam(Bni ) < Œªn

and

0 < œÅ1,n (Bni ) < Œµn for all i ‚àà {1, . . . , Mn } .

a as
We are now ready to define the core part approximants Œ≥1,n
a
Œ≥1,n
=

X
(k1 ,...,kN )‚ààMnN

Œ≥1,n (Bnk1 √ó ¬∑ ¬∑ ¬∑ √ó BnkN )
œÅ1,n (Bnk1 ) ¬∑ ¬∑ ¬∑ œÅ1,n (BnkN )

œÅ1,n |B k1 ‚äó ¬∑ ¬∑ ¬∑ ‚äó œÅ1,n |B kN .
n

(3.7)

n

Now let us handle the main part of the remainder of the measure, namely the measure
Œ≥2,n := Œ≥0,n |DŒ¥n ‚à™(X N \KnN ) .
Because Œ≥0,n and the set where we restrict it is symmetric, also Œ≥2,n is. We may thus denote
its marginals by œÅ2,n .

MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

11

In order to determine which part of the remaining marginal measure should be coupled
where, we define a partition {Ai,n }N
i=1 of the space X by setting, for all i ‚àà {1, . . . , N ‚àí 1}
rn
2 },

Ai,n := {y ‚àà X | d(xi , y) ‚â§
and
AN,n := X \

N[
‚àí1

Ai,n .

i=1

Condition (3.1) guarantees that the sets Ai,n are pairwise disjoint.
Now we approximate Œ≥2,n by the measure
!S
N
X
a
Œ≥2,n := N
,
Œ∑n,i
i=1

where for all i the measure Œ∑n,i is the product
!
i‚àí1
œÅBn |B(x ,r /10)
O
k n
‚äó œÅ2,n |A ‚äó
Œ∑n,i :=
i,n
œÅBn (B(xk , rn /10))

N
O
k=i+1

k=1

œÅBn |B(x

!
k ,rn /10)

œÅBn (B(xk , rn /10))

.

a ) we have for each i 6= j
By the definition of the sets Ai,n , for every (y1 , . . . , yN ) ‚àà spt(Œ≥2,n

rn
rn
2rn
‚àí
=
,
2
10
5

d(yi , yj ) ‚â• |d(yi , xj ) ‚àí d(xj , yj )| >

(3.8)

where we have assumed (which we can do without loss of generality) that yj ‚àà B(xj , rn /10).
a is that we have coupled the marginals of the
What we have done using the measure Œ≥2,n
measure Œ≥2,n with some suitable parts of the marginals of the reserved measure that was taken
out around the point x. In this way we have used unevenly the marginals of this reserved
part. To handle the rest of the reserved part of the measure around the point x, we now use
the reserved measure around the point x0 . So, we need to redefine the coupling for the part
of the marginal given by
Œµn
a
.
Œ≥ | + œÅ2,n ‚àí (pr1 )] Œ≥2,n
œÅ3,n := (pr1 )]
Œ≥(BÃÉn ) BÃÉn
We define it as
a
Œ≥3,n

:=

N
X

!S
œÜn,i

,

i=1

where each œÜn,i is defined as
œÜn,i :=

NO
+i‚àí1
k=N +1

œÅBn |B(x

!
k ,rn /10)

œÅBn (B(xk , rn /10))

‚äó œÅ3,n ‚äó

2N
O
k=N +i+1

œÅBn |B(x

!
k ,rn /10)

œÅBn (B(xk , rn /10))

.

a ) and each i 6= j
Since spt(œÅ3,n ) ‚äÇ spt(œÅBn ), we have that for every (y1 , . . . , yN ) ‚àà spt(Œ≥3,n

d(yi , yj ) ‚â• |d(xk(i) , xk(j) ) ‚àí d(yi , xk(i ) ‚àí d(xk(j) , yj )| > rn ‚àí

rn
4rn
rn
‚àí
=
,
10 10
5

(3.9)

where k(i) 6= k(j) are the indices for which yj ‚àà B(xk(j) , rn /10) and yi ‚àà B(xk(i) , rn /10).

12

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA

a . Since Œ≥ a
What remains is the part of the measure around x0 that was not used for Œ≥3,n
3,n
used the marginals from this part of the reserved measure evenly, we may simply couple the
rest by a measure
!S
2N
œÅBn |B(x ,r /10)
O
k n
a
Œ≥4,n := b
,
œÅBn (B(xk , rn /10))
k=N +1

with b being the correct scaling constant. Similarly as for the previous remainder part, we
a ) and each i 6= j the inequality (3.9) holds.
have that for every (y1 , . . . , yN ) ‚àà spt(Œ≥4,n
Now we are ready to define the full approximation as
a
a
a
a
Œ≥n0 = Œ≥1,n
+ Œ≥2,n
+ Œ≥3,n
+ Œ≥4,n
.

By construction Œ≥n0 ‚àà Œ†sym (œÅ).
3.3. Narrow convergence of the approximations. Let us now prove that the sequence
(Œ≥n0 )n narrowly converges to Œ≥. We could argue this by using the Wasserstein distance.
However, let us do it here directly using the definition of narrow convergence.
Lemma 3.2. The sequence (Œ≥n0 )n narrowly converges to Œ≥.
Proof. Let œï ‚àà Cb (X N ) and Œµ > 0. We need an index N0 ‚àà N such that
Z
Z
œïdŒ≥ ‚àí
œïdŒ≥n0 < Œµ for all n ‚â• N0 .
XN

(3.10)

XN

Let us denote M := supx‚ààX N |œï(x)|; we may assume that M > 0. Since œÅ is inner regular,
we can fix a compact set K ‚äÇ X such that
Œµ
.
œÅ(X \ K) <
12N M
Since Œ≥ ‚àà Œ†N (œÅ), we now have
Œµ
Œ≥(X N \ K N ) <
.
12M
The function œï, when restricted to K N , is uniformly continuous. Hence there exists Œ¥ > 0 so
that
Œµ
|œï(x) ‚àí œï(y)| <
for all x, y ‚àà K N for which dN (x, y) < Œ¥ .
(3.11)
12
Now let N0 ‚àà N be so large that
‚àö

Œµ
for all n ‚â• N0 .
6
Let us show that this choice of N0 fulfills Condition (3.10). First we note that for all
n ‚â• N0 we have
Z
Z
Z
Z
Z
Z
0
œï dŒ≥ ‚àí
œï dŒ≥1,n +
œï dŒ≥1,n ‚àí
œï dŒ≥n0
œï dŒ≥ ‚àí
œï dŒ≥n ‚â§
XN
XN
XN
XN
XN
XN
Z
Z
Z
Z
a
œï dŒ≥1,n ‚àí
‚â§
œï dŒ≥ ‚àí
œï dŒ≥1,n +
œï dŒ≥1,n
XN
XN
XN
XN
Z
a
a
a
+
œï d(Œ≥2,n
+ Œ≥3,n
+ Œ≥4,n
)
N
X
Z
Z
Œµ
a
<
œï dŒ≥1,n ‚àí
œï dŒ≥1,n
+ ,
(3.12)
6
XN
XN
N Œªn < Œ¥

and

6M Œµn <

MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

13

where in the last inequality we have used the following facts: Œ≥(X N ) ‚àí Œ≥1,n (X N ) < 3Œµn for
all n, and for the remainder part of the measure Œ≥n0 we have
a
a
a
(Œ≥2,n
+ Œ≥3,n
+ Œ≥4,n
)(X N ) < 3Œµn for all n ‚àà N.

It remains to show that for all n ‚â• N0 we have
Z
Z
5Œµ
a
œï dŒ≥1,n ‚àí
œï dŒ≥1,n
<
.
6
XN
XN

(3.13)

We first estimate the integrals in the set K N . Let us fix, for each (k1 , . . . , kN ) ‚àà MnN for
which the set
(Bnk1 √ó ¬∑ ¬∑ ¬∑ √ó BnkN ) ‚à© K N
is nonempty, an element
zk1 ,...,kN ‚àà (Bnk1 √ó ¬∑ ¬∑ ¬∑ √ó BnkN ) ‚à© K N .
Now we have, for a fixed (k1 , . . . , kN ), denoting for simplicity
a
,
z0 := zk1 ,...,kN , Q = Bnk1 √ó ¬∑ ¬∑ ¬∑ √ó BnkN , Œ≥ = Œ≥1,n , Œ≥a = Œ≥1,n

Z

Z
œï(z) dŒ≥ ‚àí
Q‚à©K N

œï(z) dŒ≥a
Q‚à©K N

Z

N

‚â§

N

Z

œï(z) dŒ≥ ‚àí œï(z0 )Œ≥(Q ‚à© K ) + œï(z0 )Œ≥a (Q ‚à© K ) ‚àí
Q‚à©K N

œï(z) dŒ≥a
Q‚à©K N

+ œï(z0 )Œ≥(Q ‚à© K N ) ‚àí œï(z0 )Œ≥a (Q ‚à© K N )
Z
Z
‚â§
|œï(z) ‚àí œï(z0 )| dŒ≥ +
|œï(z0 ) ‚àí œï(z)| dŒ≥a
Q‚à©K N
N

Q‚à©K N
N

+ M |Œ≥(Q ‚à© K ) ‚àí Œ≥a (Q ‚à© K )|

Œµ
Œµ
+ Œ≥a (Q ‚à© K N ) ¬∑
+ M |Œ≥(Q ‚à© K N ) ‚àí Œ≥a (Q ‚à© K N )|
12
12
Œµ
Œµ
+ Œ≥a (Q ‚à© K N ) ¬∑
= Œ≥(Q ‚à© K N ) ¬∑
12
12
+ M |Œ≥(Q ‚à© K N ) ‚àí Œ≥(Q) + Œ≥a (Q) ‚àí Œ≥a (Q ‚à© K N )|
Œµ
Œµ
‚â§ Œ≥(Q ‚à© K N ) ¬∑
+ Œ≥a (Q ‚à© K N ) ¬∑
+ M Œ≥(Q \ K N ) + M Œ≥a (Q \ K N ) ,
12
12
a)

< Œ≥(Q ‚à© K N ) ¬∑

where in a) we have used Condition (3.11), and in b) the fact that the measures Œ≥ and Œ≥a
coincide on ‚Äôcubes‚Äô Q. Summing the estimate above over all cubes Q = Bk1 √ó ¬∑ ¬∑ ¬∑ √ó BkN ,
(k1 , . . . , kN ) ‚àà MnN , gives
Z
Z
a
œï dŒ≥1,n ‚àí
œï dŒ≥1,n
KN

KN

Œµ
Œµ
+ Œ≥a (K N ) ¬∑
+ M Œ≥(X N \ K N ) + M Œ≥a (X N \ K N )
12
12
a) Œµ
Œµ
Œµ
Œµ
Œµ
<
+
+
+
= .
(3.14)
12 12 12 12
3
< Œ≥1,n (K N ) ¬∑

14

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA


In inequality a) we have used the fact that œÅ(X \ K) < 12M
N and, since the marginals of Œ≥1,n
a
N
a (X N \ K N ) by Œµ .
and Œ≥1,n are restrictions of œÅ, we can bound both Œ≥1,n (X \ K N ) and Œ≥1,n
12M
For the same reason, we have

Z

Z
œï dŒ≥1,n ‚àí

X N \K N

X N \K N

a
œï dŒ≥1,n
< 2M ¬∑

Œµ
Œµ
= .
12M
6

(3.15)

Combining estimates (3.14) and (3.15) gives
Z
Z
Œµ Œµ
3Œµ
5Œµ
a
œï dŒ≥1,n
< + =
œï dŒ≥1,n ‚àí
<
,
3 6
6
6
XN
XN
proving Condition (3.13).



3.4. Convergence of the cost functional. In order to prove the Œì-limsup inequality (II),
we need the cost C0 [¬∑] to converge along the approximating sequence Œ≥n . We prove this in
the following lemma.
Lemma 3.3. We have C0 [Œ≥n0 ] ‚Üí C0 [Œ≥] as n ‚Üí ‚àû.
Proof. Let us first consider the remainder part. Recall that for all n ‚àà N we have
a
a
a
a
(Œ≥n0 ‚àí Œ≥1,n
)(X N ) = (Œ≥2,n
+ Œ≥3,n
+ Œ≥4,n
)(X N ) < 3Œµn .

Thus, using the lower bounds (3.8) and (3.9) for distances in the support of the remainder
part, and the definition (3.2) of Œµn , we get


Z
2rn
3N (N ‚àí 1)
N (N ‚àí 1)
a
f
3Œµn ‚â§
rn ‚Üí 0
(3.16)
c d(Œ≥n0 ‚àí Œ≥1,n
)‚â§
2
5
2
N
X
as n ‚Üí ‚àû. By continuity of the integral, we get
Z
c d(Œ≥ ‚àí Œ≥1,n ) ‚Üí 0

(3.17)

XN

as n ‚Üí ‚àû.
a
Let us now estimate the core part of the approximation. By the construction (3.7) of Œ≥1,n
and the choice (3.6) of Œªn , we have
Z
Z
Z
N (N ‚àí 1)
N (N ‚àí 1)
a
c dŒ≥1,n ‚àí
c dŒ≥1,n ‚â§
Œµn dŒ≥1,n <
Œµn .
(3.18)
2
2
XN
XN
XN
Combining the above estimate with (3.16), (3.17) and (3.18) we get
Z
Z
Z
a
0
a
c dŒ≥1,n ‚àí
c dŒ≥1,n +
c d(Œ≥n0 ‚àí Œ≥1,n
)
C0 [Œ≥n ] ‚àí C0 [Œ≥] ‚â§
XN
XN
XN
Z
+
c d(Œ≥ ‚àí Œ≥1,n ) ‚Üí 0
XN

as n ‚Üí ‚àû.



MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

15

3.5. Finiteness of the entropy for the approximations. Next we show that the entropy
is finite for the approximating sequence. Notice that, in order to prove (II), we do not need
a better estimate on the entropy.
Lemma 3.4. For each n ‚àà N we have E[Œ≥n0 ] < ‚àû.
Proof. In order to see the finiteness of the entropy, it suffices to notice that each Œ≥n0 is a sum
k
k
n
of finitely many measures (Œ≥ÃÉn,k )N
k=1 each of which is of the form Œ≥ÃÉn,k = œÅÃÉ1 m ‚äó ¬∑ ¬∑ ¬∑ ‚äó œÅÃÉN m with
dœÅÃÉk

œÅÃÉki  œÅ and dœÅi ‚â§ 1. Indeed, by Proposition 2.3, the entropy is always bounded from below,
and so we can make a crude estimate:
!
!
Z
Nn
Nn
X
X
dŒ≥ÃÉn,k
0
d
Œ≥ÃÉn,k
log
E[Œ≥n ] =
dm
XN
k=1
k=1


Nn Z
X
dŒ≥ÃÉn,k
log
‚â§ log(Nn ) +
dŒ≥ÃÉn,k < ‚àû.

dm
XN
k=1

3.6. Proof of condition (II). We are now ready to prove the Œì-lim sup inequality (II). By
Lemma 3.2 we already know that (Œ≥n0 )n converges to Œ≥. However, Cn [Œ≥n0 ] need not converge
to C[Œ≥]. This can be solved by making the convergence of (Œ≥n0 )n slower by repeating always
the same measure for sufficiently (but finitely) many times before moving to the next one.
We define k(n) for every n ‚àà N as


‚àö
.
k(n) = min n, max 1, sup k ‚àà N | œÑn E[Œ≥j0 ] < 1 for all j ‚â§ k
By definition, 1 ‚â§ k(n) ‚â§ n. Moreover, since for every j ‚àà N we have E[Œ≥j0 ] < ‚àû by Lemma
0
3.4 and œÑn ‚Üí 0 by definition, we have that k(n) ‚Üí ‚àû as n ‚Üí ‚àû. Thus, defining Œ≥n = Œ≥k(n)
,
for large enough n ‚àà N we have
‚àö
0
0
0
Cn [Œ≥n ] = C0 [Œ≥k(n)
] + œÑn E[Œ≥k(n)
] < C0 [Œ≥k(n)
] + œÑn .
0
Recalling that by Lemma 3.3 we have C0 [Œ≥k(n)
] ‚Üí C0 [Œ≥], we conclude the proof.
In Proposition (2.5) the existence of a minimizer for the entropy-regularized cost was established. Now that we know that measures Œ≥ for which C0 (Œ≥) < ‚àû can be approximated by
measures with not only finite costs but also finite entropy, we can say more:

Corollary 3.5. Let (X, d, m) be a Polish metric measure space. Assume that œÅm ‚àà Pac (X)
satisfies œÅ log œÅ ‚àà L1m (X) and Conditions (A) and (B). Assume that c : X N ‚Üí R ‚à™ {+‚àû}
satisfies Conditions (F 1) and (F 2). Then, for each Œµ > 0, there exists a unique minimizer
Œ≥ ‚àà Œ†sym
N (œÅ) for the entropic-regularized cost CŒµ [Œ≥], and this minimizer has a finite cost.
Proof. Our marginal measure satisfies Conditions (A) and (B), so there exists a measure
Œ≥ ‚àà Œ†sym
N (œÅ) that minimizes C0 with C0 [Œ≥] < ‚àû. It must be noted that this measure can
have infinite entropy. However, because of the approximation result presented in the proof of
0
Condition (II) above, we get the existence of a measure Œ≥ 0 ‚àà Œ†sym
N (œÅ) such that C [Œ≥ ] < ‚àû.
The uniqueness claim now follows, since the functional Œ≥ 7‚Üí C [Œ≥] is strictly convex for
 > 0.


16

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA

4. Entropic-Kantorovich Duality for Coulomb-type costs
We start by recalling the classical Fenchel-Rockafellar Theorem and we refer to the I.
Ekeland and R. TeÃÅmam‚Äôs book [13, Theorem 4.2] for a more complete presentation and
references.
Theorem 4.1 (Fenchel-Rockafellar). Let X and Y be Banach spaces and A : X ‚Üí Y be linear
and continuous. Let F : X ‚Üí R ‚à™ {+‚àû} and G : Y ‚Üí R ‚à™ {+‚àû} be proper and convex
functions. Then


inf F [x] + G[Ax] x ‚àà X = sup ‚àí F ‚àó [‚àíA‚àó Œ≥] ‚àí G‚àó [Œ≥] Œ≥ ‚àà Y‚àó
where A‚àó : Y‚àó ‚Üí X‚àó denotes the adjoint operator of A.
Next we prove the Entropic-Kantorovich duality for the problem (2.3).
Theorem 4.2 (Entropic Duality for repulsive costs). Let (X, d, m) be a Polish measure space.
Suppose œÅm ‚àà P(X) such that (A) and (B) hold and œÅ log œÅ ‚àà L1m (X), and c : X N ‚Üí [0, ‚àû] is
a cost function
X
c(x1 , . . . , xN ) =
f (d(xi , xj )),
for all (x1 , . . . , xN ) ‚àà X N ,
1‚â§i<j‚â§N

where f : [0, +‚àû[‚Üí [0, ‚àû] is a function satisfying (F 1) and (F 2). Then, for Œµ > 0, the duality
holds
(N Z
)


Z
X
u1 ‚äï ¬∑ ¬∑ ¬∑ ‚äï uN ‚àí c
min CŒµ [Œ≥] = sup
ui dœÅm ‚àí Œµ
exp
dmN + Œµ
Œµ
Œ≥‚ààŒ†(œÅ)
XN
ui ‚ààCb (X) i=1 X
 Z



Z
u ‚äï ¬∑¬∑¬∑ ‚äï u ‚àí c
= sup
N
udœÅm ‚àí Œµ
exp
dmN + Œµ ,
Œµ
X
XN
u‚ààCb (X)
where v1 ‚äï ¬∑ ¬∑ ¬∑ ‚äï vN denotes the operator (v1 ‚äï ¬∑ ¬∑ ¬∑ ‚äï vN )(x1 , . . . , xN ) = v1 (x1 ) + ¬∑ ¬∑ ¬∑ + vN (xN ).
Proof. First let us assume that X is a compact space. We denote by X = (Cb (X))N and
Y = Cb (X N ), where Cb (X) is the space of continuous and bounded functions on X, and
similarly for X N . By Riesz representation theorem, the space Y is dual to the space M(X N )
of signed regular Borel measures on X N . Thus we may define the Legendre-Fenchel transform
G‚àó of a functional G : Y ‚Üí R ‚à™ {+‚àû} by
Z

‚àó
N
‚àó
G : M(X ) ‚Üí R ‚à™ {+‚àû}, G [œÄ] = sup
œà dœÄ ‚àí G[œà] .
XN

œà‚ààCb (X N )

We apply Fenchel-Rockafellar Theorem 4.1 to the functionals
F : (Cb (X))N ‚Üí R ‚à™ {+‚àû} , (u1 , . . . , uN ) 7‚Üí ‚àí

N Z
X
i=1

and
G : Cb (X N ) ‚Üí R ‚à™ {+‚àû} , œà 7‚Üí Œµ

Z

ui dœÅm

X

1

e Œµ (œà‚àíc) dmN ,

XN

and to the operator
A : (Cb (X))N ‚Üí Cb (X N ) , (u1 , . . . , uN ) 7‚Üí u1 ‚äï ¬∑ ¬∑ ¬∑ ‚äï uN .

MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

17

Now F and G are proper and convex functionals and A is a linear and continuous operator.
So we may apply Fenchel-Rockafellar duality to get
inf{F [x] + G[Ax] | x ‚àà X} = sup{‚àíG‚àó [Œ≥] ‚àí F ‚àó [‚àíA‚Ä† Œ≥] | Œ≥ ‚àà Y‚àó } .
This gives (since for every set S we have inf(S) = ‚àí sup(‚àíS) and sup S = ‚àí inf(‚àíS))
inf{G‚àó [Œ≥] + F ‚àó [‚àíA‚Ä† Œ≥] | Œ≥ ‚àà Y‚àó } = sup{‚àíF [x] ‚àí G[Ax] | x ‚àà X} .
It remains to show that the above expression has exactly the form of our duality claim. The
claim that the right-hand sides correspond to each other follows immediately from our choices
of X, F , and G. So it remains to show that
inf{G‚àó [Œ≥] + F ‚àó [‚àíA‚Ä† Œ≥] | Œ≥ ‚àà Y‚àó } = CŒµ [Œ≥] ‚àí Œµ .

(4.1)

To prove it, let Œ≥ ‚àà M(X N ). Now we have
Z

N
N Z
X
X
‚àó
‚àó
N
F [‚àíA Œ≥] = sup
ui (xi )dŒ≥ ‚àí
ui (xi ) dœÅm(xi ) (u1 , . . . , uN ) ‚àà Cb (X)
X N i=1

(
0
=
+‚àû

i=1

X

if Œ≥ ‚àà Œ†N (œÅ)
.
otherwise

Let us then compute G‚àó [Œ≥]:
Z

‚àó

G [Œ≥] =

Z

1
e Œµ (œà‚àíc) dmN

œà dŒ≥ ‚àí Œµ

sup
œà‚ààCb (X N )

XN


.

XN

If Œ≥ is not absolutely continuous with respect to mN we have G‚àó [Œ≥] = +‚àû. If Œ≥  mN , then
the supremum (that appears in the definition of G‚àó [Œ≥]) is realized at œà = Œµ log œÅŒ≥ + c; this
holds also if the function œÅŒ≥ is not continuous since it can be approximated by a sequence of
continuous functions. Thus we get for Œ≥  mN
Z


1
‚àó
G [Œ≥] =
œÅŒ≥ ¬∑ œà ‚àí Œµe Œµ (œà‚àíc) dmN
N
ZX
=
(ŒµœÅŒ≥ log œÅŒ≥ + cœÅŒ≥ ‚àí ŒµœÅŒ≥ ) dmN .
XN

Hence, if Œ≥ ‚àà Œ†N (œÅ), we have
G‚àó [Œ≥] = C0 [Œ≥] + ŒµE[Œ≥] ‚àí Œµ .
This concludes the duality proof when X is a compact space.
The noncompact case: Due to Lemma 2.2, it suffices to prove the claim in the case where
the reference measure is œÅm instead of m; the finiteness of the measure œÅm now gives access
to inner regularity and to the approximability by compact sets. We will for simplicity denote
œÅ := œÅm.
The claim is
min CŒµ [Œ≥] =

Œ≥‚ààŒ†N (œÅ)

 Z
Z
sup
N
udœÅ ‚àí Œµ
u‚ààCb (X)

X

XN


exp

u ‚äï ¬∑¬∑¬∑ ‚äï u ‚àí c
Œµ



‚äóN

dœÅ


+ Œµ.

18

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA

For simplicity, let us denote
 Z
Z
udœÅ ‚àí Œµ
DœÅ (u) := N


exp

XN

X

u ‚äï ¬∑¬∑¬∑ ‚äï u ‚àí c
Œµ



dœÅ‚äóN


+ Œµ for all u ‚àà Cb (X) .

We may assume that supu‚ààCb (X) DœÅ (u) > ‚àí‚àû; indeed, since we can test with the function
u ‚â° 0, this always holds for cost functions that are bounded from below.
Let us make, in the notation of the primal functional, the dependence on the reference
measure explicit by the notation Œ≥ 7‚Üí C (Œ≥|¬µ) when the reference measure on the space X is
¬µ. Thus the original notation Œ≥ 7‚Üí C [Œ≥] corresponds to Œ≥ 7‚Üí C (Œ≥|m).
Since the measures œÅ and Œ≥ are inner regular, there exists a sequence (Kn )n‚ààN of compact
subsets of X such that
œÅ(Kn ) ‚Üí œÅ(X)
Let us denote Œ≥n :=

1
N ) Œ≥| N
Œ≥(Kn
Kn

and

and œÅn :=

Œ≥(KnN ) ‚Üí Œ≥(X N ) .

1
œÅ(Kn ) œÅ|Kn .

Let us also denote by Œ≥nmin the minimizer

of the problem I (œÅn ). Since Œ≥ is the minimizer of the problem I (œÅ) and since (due to the
absolute continuity of the integral and the continuity of the function t 7‚Üí t log t)
lim |C (Œ≥n |œÅn ) ‚àí C (Œ≥|œÅ)| = 0 ,

(4.2)

lim |C (Œ≥n |œÅn ) ‚àí C (Œ≥nmin |œÅn )| = 0 .

(4.3)

n‚Üí‚àû

we have
n‚Üí‚àû

By the duality result proven above for compact spaces, we have for all n ‚àà N
DœÅn (u) = C (Œ≥nmin |œÅn ) .

sup
u‚ààCb (Kn )

Again, due to the absolute continuity of the integral, we have
lim

sup

n‚Üí‚àû u‚ààC (K )
n
b

DœÅn (u) ‚àí

sup DœÅ (u) = 0 .
u‚ààCb (X)

Putting these conditions together, we get for all n ‚àà N
C (Œ≥|œÅ) ‚àí

sup DœÅ (u)
u‚ààCb (X)

‚â§ |C (Œ≥|œÅ) ‚àí C (Œ≥n |œÅn )| + C (Œ≥n |œÅn ) ‚àí C (Œ≥nmin |œÅn )
+ C (Œ≥nmin |œÅn ) ‚àí

sup
u‚ààCb (Kn )

DœÅn (u) +

sup
u‚ààCb (Kn )

DœÅn (u) ‚àí

sup DœÅ (u) .
u‚ààCb (X)

The claim follows by letting n ‚Üí ‚àû.



Remark 4.3. Notice that we always have
(N Z
)


Z
X
u1 ‚äï ¬∑ ¬∑ ¬∑ ‚äï uN ‚àí c
dmN + Œµ
sup
ui dœÅ ‚àí Œµ
exp
Œµ
XN
ui ‚ààCb (X) i=1 X
 Z



Z
u ‚äï ¬∑¬∑¬∑ ‚äï u ‚àí c
‚â• sup
N
u dœÅ ‚àí Œµ
exp
dmN + Œµ.
Œµ
X
XN
u‚ààCb (X)
We show that the equality actually holds by simply choosing a potential u(x) = (u1 (x) +
u2 (x) + ¬∑ ¬∑ ¬∑ + uN (x))/N .

MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

19

References
[1] M. Agueh and G. Carlier, Barycenters in the Wasserstein space, SIAM J. on Mathematical Analysis,
43 (2011), pp. 904‚Äì924.
[2] J.-D. Benamou, G. Carlier, and L. Nenna, A numerical method to solve optimal transport problems
with Coulomb cost, to appear as a chapter in ‚ÄúSplitting Methods in Communication and Imaging, Science
and Engineering‚Äù, Springer, (2015).
[3]
, Generalized incompressible flows, multi-marginal transport and Sinkhorn algorithm, arXiv preprint
arXiv:1710.08234, (2017).
[4] G. Buttazzo, T. Champion, and L. De Pascale, Continuity and estimates for multimarginal optimal
transportation problems with singular costs, Applied Mathematics & Optimization, (2016), pp. 1‚Äì16.
[5] G. Buttazzo, L. De Pascale, and P. Gori-Giorgi, Optimal-transport formulation of electronic Density
Functional Theory, Physical Review A, 85 (2012), p. 062502.
[6] G. Carlier, V. Duval, G. PeyreÃÅ, and B. Schmitzer, Convergence of entropic schemes for optimal
transport and gradient flows, SIAM J. Math. Anal., 49 (2017), pp. 1385‚Äì1418.
[7] C. Cotar, G. Friesecke, and C. KluÃàppelberg, Density Functional Theory and optimal transportation
with Coulomb cost, Comm. Pure Appl. Math., 66 (2013), pp. 548‚Äì599.
[8]
, Smoothing of transport plans with fixed marginals and rigorous semiclassical limit of the HohenbergKohn functional, Archive for Rational Mechanics and Analysis, 228 (2018), pp. 891‚Äì922.
[9] M. Cuturi, Sinkhorn distances: Lightspeed computation of optimal transport, in Advances in neural
information processing systems, 2013, pp. 2292‚Äì2300.
[10] S. Di Marino, L. De Pascale, and M. Colombo, Multimarginal optimal transport maps for 1dimensional repulsive costs, Canadian Journal of Mathematics ‚Äì Journal Canadien des MatheÃÅmatiques,
67 (2015), pp. 350‚Äì368.
[11] S. Di Marino and A. Gerolin, An optimal transportation approach for the SchroÃàdinger Bridge problem
and convergence of the Sinkhorn algorithm, in preparation.
[12] S. Di Marino, A. Gerolin, and L. Nenna, Optimal transport theory for repulsive costs, Topological
Optimization and Optimal Transport: In the Applied Sciences, 17 (2017).
[13] I. Ekeland and R. Temam, Analyse convexe et problemes variationnelles, Dunod Gauthier-Villars, Paris,
(1974).
[14] R. Flamary and N. Courty, POT Python Optimal Transport library, 2017.
[15] A. Gerolin, A. Kausamo, and T. Rajala, Duality theory for multimarginal optimal transport with
repulsive costs in metric spaces, ESAIM Control Optim. Calc. Var., (to appear), (2018).
[16] N. Gigli and L. Tamanini, Second order differentiation formula on compact RCD‚àó (K, N ) spaces,
arXiv:1701.03932, (2017).
[17] N. Gozlan and C. LeÃÅonard, Transport inequalities. a survey, Markov Processes and Related Fields, 16
(2010), pp. 635‚Äì736.
[18] H. G. Kellerer, Duality theorems for marginal problems, Zeitschrift fuÃàr Wahrscheinlichkeitstheorie und
verwandte Gebiete, 67 (1984).
[19] C. LeÃÅonard, From the SchroÃàdinger problem to the Monge‚ÄìKantorovich problem, Journal of Functional
Analysis, 262 (2012), pp. 1879‚Äì1920.
, A survey of the SchroÃàdinger problem and some of its connections with optimal transport, Discrete
[20]
Contin. Dyn. Syst., (2014), pp. 1533‚Äì1574.
[21] E. H. Lieb, Density functionals for Coulomb systems, in Inequalities, Springer, 2002, pp. 269‚Äì303.
[22] T. Mikami, Monge‚Äôs problem with a quadratic cost by the zero-noise limit of h-path processes, Probability
theory and related fields, 129 (2004), pp. 245‚Äì260.
[23] L. Nenna, Numerical Methods for Multi-Marginal Opimal Transportation, PhD thesis, UniversiteÃÅ ParisDauphine, 2016.
[24] G. PeyreÃÅ and M. Cuturi, Computational Optimal Transport, vol. 11, Now Publishers, Inc., 2019.
[25] E. SchroÃàdinger, UÃàber die umkehrung der naturgesetze, Verlag Akademie der wissenschaften in kommission bei Walter de Gruyter u. Company, 1931.
[26] M. Seidl, S. Di Marino, A. Gerolin, K. Giesbertz, L. Nenna, and P. Gori-Giorgi, The StrictlyCorrelated Electron functional for spherically symmetric systems revisited, Accepted in Physical Review
A (available in arXiv:1702.05022), (2016).
[27] K.-T. Sturm, On the geometry of metric measure spaces, Acta Math., 196 (2006), pp. 65‚Äì131.

20

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA

Vrije Universiteit Amsterdam, Department of Theoretical Chemistry, FEW, De Boelelaan
1083, 1081HV Amsterdam, The Netherlands
E-mail address: augustogerolin@gmail.com
University of Jyvaskyla, Department of Mathematics and Statistics, P.O. Box 35 (MaD),
FI-40014 University of Jyvaskyla, Finland
E-mail address: anna.m.kausamo@jyu.fi
E-mail address: tapio.m.rajala@jyu.fi

