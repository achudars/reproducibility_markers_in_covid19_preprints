ECH CAPACITIES, EHRHART THEORY, AND TORIC VARIETIES

arXiv:1906.02237v2 [math.SG] 19 Jun 2019

BEN WORMLEIGHTON

Abstract. ECH capacities were developed by Hutchings to study embedding problems for symplectic 4manifolds with boundary. They have found especial success in the case of certain toric symplectic manifolds
where many of the computations resemble calculations found in cohomology of Q-line bundles on toric varieties, or in lattice point counts for rational polytopes. We formalise this observation in the case of convex
toric lattice domains XΩ by constructing a natural polarised toric variety pYΣpΩq , DΩ q containing the all the
information of the ECH capacities of XΩ in purely algebro-geometric terms. Applying the Ehrhart theory of
the polytopes involved in this construction gives some new results in the combinatorialisation and asymptotics
of ECH capacities for convex toric domains.

1. Introduction
Symplectic capacities measure obstructions to embedding one symplectic manifold into another. Perhaps the simplest such obstruction is the volume; a symplectic manifold pX1 , ω1 q can be embedded in
another symplectic manifold pX2 , ω2 q only if volpX1 , ω1 q ď volpX2 , ω2 q. A more sophisticated obstruction
is the Gromov width: the supremum of the radii of balls that can symplectically embed into the given
symplectic manifold. As Gromov’s nonsqueezing theorem [G85] illustrates, this is a nontrivial and interesting invariant even for simple submanifolds of R n .
There are many different capacities in past and current usage - see [CHLS] and the numerous references
therein for an overview - that were invented in order to answer more sophisticated embedding questions
about symplectic 4-manifolds. In this paper we will focus on Embedded Contact Homology or ECH capacities,
which were developed by Hutchings in [H11] and have since been studied by many authors in, for
example, [CCFHR], [CHR], [C15], [CS18]. To an exact symplectic 4-manifold X with contact-type boundary
they associate an increasing sequence of real numbers c k pXq for k P Zě0 . One of their early successes was
studying embeddings of ellipsoids where the ellipsoid with symplectic radii a, b
Epa, bq :“ tpx, yq P C2 : |x 2 |{πa ` |y 2 |{πb ď 1u
embeds into Epc, dq iff c k pEpa, bqq ď c k pEpc, dqq for all k. Moreover, c k pEpa, bqq was computed to be the
kth largest number of the form am ` bn for m, n P Zě0 .
A particular type of symplectic manifold that ECH capacities provide an attractive means of studying
is toric domains. Consider the moment map
µ : C2 Ñ R 2
for the 2-torus action on C2 . Given a region Ω Ă R2 , XΩ :“ µ´1 pΩq is a toric symplectic 4-manifold
potentially with boundary. If the domain Ω is a certain kind of convex polygon with two edges lying
on the coordinate axes, XΩ is called a convex toric domain. We omit mention of the symplectic form since
we will always take the induced form from C2 . Such symplectic manifolds are exact with contact-type
boundary. The work of Cristofano-Gardiner–Choi [C15] provides a somewhat combinatorial formula for
the ECH capacities of such spaces in terms of lattice paths and lattice point counts.
Define the cap function of a symplectic 4-manifold X with contact-type boundary to be
capX prq :“ #tk P Zě0 : c k pXq ď ru
“ 1 ` maxtk P Zě0 : c k pXq ď ru
2010 Mathematics Subject Classiﬁcation. 53D35 (Primary); 14M25, 52B20 (Secondary).
Key words and phrases. ECH capacities, Hilbert function, Ehrhart theory, toric geometry.
1

2

B. WORMLEIGHTON

for r P Zě0 . In certain situations - such as ellipsoids with integral symplectic radii - the cap function
recovers all of the ECH capacities. The main results of this paper apply to the capacities and cap functions
of convex toric domains where Ω is in addition a lattice polygon.
For a rational polygon Ω Ă R2 we consider the inner normal fan ΣpΩq, which is the complete fan whose
rays are the (primitive) inward-pointing normal vectors to the edges of Ω. This defines a toric variety
YΣpΩq . We will later define a divisor DΩ on YΣpΩq called the balance divisor. The key property of this divisor
is that its associated polytope is equal to Ω.
Recall that the function counting lattice points in dilates of a lattice polytope P Ă R n is given by
a polynomial ehrP , called the Ehrhart polynomial of P, such that #pnPq X Zn “ ehrP pnq for n P Zě0 .
Similarly, recall that the function counting global sections in integer multiples of a Cartier divisor D on a
variety X is eventually given by a polynomial hilbpX,D q , called the Hilbert polynomial of pX, Dq, such that
h 0 pX, nDq :“ dim H 0 pX, nDq “ hilbpX,D q pnq for all sufficiently large n P Zě0 .
When P is a rational polytope (or D is a Q-Cartier divisor), the Ehrhart function (resp. the Hilbert
function) is given (resp. eventually given) by a quasipolynomial: there exists a number π P Zě1 and
polynomials L0 , . . . , L π´1 such that
L P pnq “ L i pnq when n ” i mod π
Alternatively, one can think of such a function as a polynomial with coefficients that are periodic functions.
With the above setup, the main results of this paper are as follows. Let XΩ be a convex toric domain.
Choi–Cristofaro-Gardiner–Frenkel–Hutchings–Ramos [CCFHR] and Cristofaro-Gardiner [C15] associate
a sequence of numbers to Ω called the weight sequence wpΩq. We will later define in Definition 5.3 a class
of convex toric domains that are tightly constrained. We conjecture (Conjecture 5.7) that this is equivalent
to the gcd of the numbers in the weight sequence being equal to 1; it is shown below to hold when one of
the weights is equal to 1 in Lemma 5.6.
Theorem 1.1. (Corollary 5.10) Suppose XΩ is a tightly constrained convex toric lattice domain. Then there exists
some r0 P Zě0 such that capXΩ prq is given by a quasipolynomial of known period λ for all r ě r0 . More precisely,
for r “ 0, . . . , λ ´ 1
capXΩ pr ` λxq “ ehrΩ pxq ` rx ` γr
for some constant γr P Z dependent only on r, whenever r ` λx ě r0 .
Theorem 1.2. (Corollary 5.10) Suppose XΩ is a tightly constrained convex toric domain. Then, if DΩ is the balance
divisor on YΣpΩq associated to Ω, there is r0 P Zě0 such that for any r “ 0, . . . , λ ´ 1 and x P Zě0 with r ` λx ě r0
capXΩ pr ` λxq “ h 0 pYΣpΩq , xDΩ q ` rx ` γr
for some constant γr P Z dependent only on r.
Moreover, when at least one weight is equal to 1 one can choose r0 “ 0 and γr “ capXΩ prq ´ 1 in both
theorems. Letting the residue r mod λ be zero in the formulae above gives the following corollary.
Corollary 1.3. If XΩ is a tightly constrained convex toric lattice domain, then for suﬃciently large x P Zě0
capXΩ pλxq “ ehrΩ pxq ` γ0 “ h 0 pxDΩ , YΣpΩq q ` γ0
for some γ0 P Z.
When at least one weight is equal to 1 here we have γ0 “ 0. The explicit description of the linear coefficients above give precise examples of sub-leading asymptotics for ECH capacities as studied in [CS18];
for example, Prop. 16 there is an interesting comparison.
We conjecture that the following strengthening of the prior results holds.
Conjecture 1.4. Suppose that XΩ is a tightly constrained toric domain. Then:

ECH CAPACITIES, EHRHART THEORY, AND TORIC VARIETIES

3

‚ there exist convex lattice domains Ω0 , . . . , Ωλ´1 such that, for any r “ 0, . . . , λ ´ 1 and any suﬃciently
large x P Zě0 ,
capXΩ pr ` λxq “ |pΩr ` xΩq X Z2 |
‚ there exist divisors D0 , . . . , Dλ´1 on YΣpΩq such that, for any r “ 0, . . . , λ ´ 1 and any suﬃciently large
x P Z ě0 ,
capXΩ pr ` λxq “ h 0 pYΣpΩq , Dr ` xDΩ q
Moreover, we conjecture that Ω0 “ t0u so that γ0 “ 0, and that all of these claims actually hold for all x P Zě0 , not
just for all suﬃciently large x.
These conjectures state that capXΩ is (eventually) given by a ‘mixed Ehrhart quasipolynomial’ or a
‘mixed Hilbert quasipolynomial’ as studied in [HJST]. Cristofaro-Gardiner–Kleinman in [CK13] have
previously approached symplectic embeddings problems for ellipsoids via Ehrhart theory, and one can
view some aspects of the present paper as pursuing a related philosophy for convex toric lattice domains.
As the results above might suggest, there is a purely algebro-geometric framework that we will establish
in which one can recast ECH capacities with no conditions except rationality on the weights of Ω. This
also works for a different class of toric domains called free convex toric domains that are defined in §4.7.
Theorem 1.5. (Theorem 4.14 + Theorem 4.15 + Theorem 4.18) Let Ω be any rational convex lattice domain or a
free rational convex toric domain. Then
c k pXΩ q “ mintD ¨ DΩ : h 0 pYΣpΩq , Dq ě k ` 1u
capXΩ prq “ maxth 0 pYΣpΩq , Dq : D ¨ DΩ ď ru
where both extrema range over all nef Q- or R-divisors on YΣpΩq .
For the special case evaluating the cap function at rℓΩ pBΩq “: λr, we have
capXΩ pλrq “ maxth 0 pDq : pD ´ rDΩ q ¨ DΩ ď 0u
We can also state some of the results of this paper in purely combinatorial terms. We will later describe
a pseudonorm ℓΩ dependent on Ω called the Ω-length, which is central to the combinatorialisation of
ECH capacities. For a polygon Λ, define its Ω-perimeter ℓΩ pBΛq to be the sum of the Ω-lengths of the line
segments composing its boundary BΛ.
Theorem 1.6. (Corollary 5.8) Suppose Ω is a tightly constrained convex lattice domain with lower bound1 r0 “ 0
and let λ “ ℓΩ pBΩq. Then rΩ contains the most lattice points of any convex lattice domain of Ω-perimeter at most
rλ for all r P Zě0 .
All of these results are numerical in nature and so it is natural to wonder if there is some higher structure
behind them. In particular, both sides of the equality in Theorem 1.2 are defined to be dimensions of
vector spaces - of filtered embedded contact homology on the left, and of cohomology of divisors on YΣpΩq
on the right - and so it would be interesting to explore whether there is a correspondence on the level of
vector spaces, potentially accessed by mirror symmetry.
1.1. Acknowledgements. I am very grateful to Michael Hutchings for introducing me to ECH capacities
and for many fruitful discussions as the content of this paper developed. I would also like to thank Vivek
Shende for useful conversations at various points of this story, and Dan Cristofaro-Gardiner for comments
on a draft of this paper.
2. ECH capacities
ECH is formally defined in terms of contact geometry. It is constructed explicitly in [H11] however there
is a combinatorial rephrasing of ECH in the case of toric domains that is most applicable to the situation
at hand, which is how we will primarily present it here. This material comes from [H11], [CCFHR],
and [C15].
1For example, these assumptions are met if one of the weights of Ω is equal to 1, and we conjecture that they are met whenever
the gcd of the weights is 1.

4

B. WORMLEIGHTON

2.1. Combinatorial definitions. Suppose Ω Ă R2 is any polygon. Define the Ω-length of a vector v to be
ℓΩ pvq :“ v ˆ p v
where p v is a boundary point of Ω such that Ω is contained in the right halfplane bounded by the line
spanned by v translated to contain p v . Here ˆ means the cross product u ˆ v “ detpu | vq. Define the
Ω-length of a piecewise linear path Λ to be
ÿ
ℓΩ pΛq “
ℓΩ pv i q
where the sum ranges over the edge vectors v i of Λ. Notice that, from a local calculation, one has
ℓΩ pBΩq “ 2 VolpΩq
Definition 2.1. A convex domain is a convex region Ω Ă R2 whose boundary consists of
‚ a line segment between the origin and a point pa, 0q on the positive horizontal axis
‚ a line segment between the origin and a point p0, bq on the positive vertical axis
‚ the graph of a convex piecewise linear function f : r0, as Ñ r0, bs
We say that a convex domain is a convex lattice domain if the points pa, 0q and p0, bq are lattice points and if
the function f is piecewise linear such that each vertex is a lattice point. In other words, a convex lattice
domain is a convex domain that is also a lattice polygon. Convex rational domains are defined similarly.
We call the corresponding symplectic manifold XΩ “ µ´1 pΩq a convex toric domain if Ω is a convex
domain, or a convex toric lattice domain if Ω is a convex lattice domain. One can also repeat these definitions
with convex replaced by concave.
Following [C15] - which built on [CCFHR] and [M11] - the weight sequence associated to a convex lattice
domain Ω is a sequence wpΩq of numbers defined as follows. Let ∆a be the convex hull of the points
p0, 0q, pa, 0q, p0, aq. Let c be the smallest number such that Ω Ă ∆c . Equivalently, c is the radius of the
smallest ball in C2 containing XΩ . The two components of the complement ∆c zΩ are affine equivalent to
two concave domains Ω2 and Ω3 . There is a recursive definition weight sequences for concave domains
as follows. Consider the concave domain Ω2 . Let b1 be the largest real number such that ∆b1 Ă Ω2 . The
complement of ∆b1 in Ω2 consists of two (possibly empty) concave domains and so one can recurse to
obtain a multiset of numbers wpΩ2 q :“ tb1 , b2 , . . . u. We define
wpΩq :“ pc; wpΩ2 q; wpΩ3 qq
Example 2.2. Let Ω “ Convpp0, 0q, p0, 2aq, pa, aq, pa, 0qq for some a P Zą0 . Here c “ 2a, leaving a single
Figure 1. Example of weight sequence
‚

‚

‚

‚

‚

‚

‚

‚

‚

‚

‚

concave region Ω3 illustrated in the third figure, which is affine equivalent to ∆a . The weight sequence
for Ω is hence p2a; H; aq.
2.2. ECH capacities. Using the constructions above, we define ECH capacities combinatorially.
Definition 2.3. A convex lattice path is a piecewise linear path starting on the positive vertical axis and
ending on the positive horizontal axis such that its vertices are lattice points.
After adding the pieces along the coordinate axes, convex lattice paths are exactly boundaries of convex
lattice domains. For a polygon Λ we denote by LΛ the number of lattice points enclosed by Λ, including
on those its boundary. We state a result of Cristofaro-Gardiner but using the perspective of convex lattice
domains instead of convex lattice paths.

ECH CAPACITIES, EHRHART THEORY, AND TORIC VARIETIES

5

Theorem 2.4 ( [C15], Cor. 8.5). Let Ω be a convex domain. Then
c k pXΩ q “ mintℓΩ pBΛq : LΛ “ k ` 1u
where the minimum is taken over convex lattice domains Λ.
Corollary 2.5. If Ω is a convex domain, then
capXΩ prq “ maxtLΛ : ℓΩ pBΛq ď ru
where the maximum ranges over convex lattice domains Λ.
Proof. After including the zeroth capacity, one has
capXΩ prq “ #tk : DΛ with ℓΩ pΛq ď r and LΛ “ k ` 1u
“ 1 ` maxtk : DΛ with ℓΩ pΛq ď r and LΛ “ k ` 1u
“ maxtLΛ : ℓΩ pΛq ď ru
as required.



2.3. ECH capacities and weight sequences. The weight sequence wpΩq contains all the information
required to compute c k pXΩ q.
Lemma 2.6. Suppose wpΩq “ pc; a1 , . . . , a s ; b1 , . . . , b t q. Then
c k pXΩ q “ mintc k `k2 `k3 pBpcqq ´ c k2 p>si“1 Bpa i qq ´ c k3 p>tj “1 Bpb j qq : k2 , k3 P Zě0 u
This follows from [C15] Corollary A.5 combined with [CCFHR] Theorem 1.4.
2.4. Key properties of ECH capacities. ECH capacities have the following properties recorded in [CCFHR],
which we will use throughout the paper:
‚ Monotonicity: If pX, ωq embeds into pX 1 , ω 1 q then c k pX, ωq ď c k pX 1 , ω 1 q for all k
‚ Disjoint union: If pX, ωq “ >ni“1 pX i , ω i q then
c k pX, ωq “ řmax

k i “k

n
ÿ

c k i pX i , ω i q for all k

i “1

‚ Conformality: For each k and λ P R` , c k pX, λωq “ λc k pX, ωq
2.5. Asymptotics of ECH capacities. Asymptotically, capacities return the volume constraint on symplectic embeddings.
Theorem 2.7 ( [CHR], Theorem 1.1). Suppose Ω is a convex domain, then
c k pXq2
“ 4 VolpXΩ q “ 4 VolpΩq
k
k Ñ8
lim

This already allows us to calculate the constant
a λ in Theorems 1.1 and 1.2 assuming that it exists.
Theorem 2.7 implies that c k pXq is asymptotic to 2 k VolpΩq and so the cap function is asymptotic to
#tk : 2

b

k VolpΩq ď ru “ #tk : k ď

1
1
r2u “
r2 ` 1
4 VolpΩq
4 VolpΩq

The leading term of the Ehrhart polynomial in Theorem 1.1 and of the Hilbert polynomial in Theorem 1.2
is VolpΩqn 2 and so the constant should be
λ “ 2 VolpΩq “ ℓΩ pBΩq

6

B. WORMLEIGHTON

2.6. Examples. We present some suggestive examples of calculations of capacities and cap functions for
some basic convex toric domains.
Example 2.8. capEpa,b q prq “ ehrQ prq, the Ehrhart quasipolynomial of the rational triangle
Q “ Convpp0, 0q, p1{a, 0q, p0, 1{bqq
This is also equal to the Hilbert function of Op1q for the weighted projective plane Pp1, a, bq.
Example 2.9. The cap function for the polydisk Ppa, bq has
capP pa,b q p2abrq “ par ` 1qpbr ` 1q “ hilbpP1 ˆP1 ,Opa,b qq prq
Example 2.10. Let Ωpaq be the convex hull of the points p0, 0q, p0, 2aq, pa, aq, pa, 0q. One has
capXΩpaq p3arq “ h 0 pX, rDq
where X is the first Hirzebruch surface, or P2 blown up in one point, and where D “ 3C ` 2F with C the
p´1q-curve and F a fibre in the P1 -bundle structure on X.
These examples all suggest a tight relationship between computations of symplectic capacities for
convex toric domains and Hilbert functions of divisors on toric surfaces. Establishing and exploiting such
a relationship is the subject of the remainder of this paper.
3. Toric algebraic geometry
We begin by reviewing some basic toric algebraic geometry. A toric variety is a partial compactification
of an algebraic torus pCˆ qn . They are described combinatorially by cones, fans, and polytopes. This and
much more is detailed in [CLS].
3.1. Affine toric varieties arise from cones. Let N – Zn be a lattice and let NR :“ N bZ R be the associated
real vector space. A cone σ in NR is a subset of the form
ÿ
ConepSq :“ t λ v v : λ v ě 0, all but finitely many λ v are zerou
v PS

_

Let M “ N :“ HomZ pN, Zq be the dual lattice to N, and MR “ M bZ R the dual vector space to NR .
Define the dual cone to a cone σ Ă NR to be
σ_ :“ tv P MR : xu, vy ě 0 for all u P σu
where x¨, ¨y is the dual pairing NR ˆ MR Ñ R. Suppose now that σ is a rational polyhedral cone: that there
is a finite set of lattice points S Ă N such that σ “ ConepSq. Such a cone σ gives an affine toric variety U σ
as follows.
‚
‚
‚
‚
‚

Input: σ, a rational polyhedral cone
Dualise to σ_
Take lattice points σ_ X M to obtain a semigroup
Take the semigroup algebra Crσ_ X Ms; this is a finitely generated C-algebra
Output: U σ :“ Spec Crσ_ X Ms.

Notice that the dense open torus arises from Crσ_ X Ms Ă CrMs – CrZn s, which is the ring of Laurent
polynomials, or the ring of functions for the torus pCˆ qn . The cone σ (or rather σ_ ) is describing which
functions on the torus extend to global functions on U σ , which is equivalent to describing the variety. One
can describe the torus inside U σ intrinsically as
TN :“ N bZ Cˆ
In this presentation, a vector m P M gives a function χ m : TN Ñ C via
χ m pn b tq “ t xm,n y
Example 3.1. Take N “ Z2 and let σ “ Conepe1 , e2 q. The dual cone is σ_ “ Conepe 1 , e 2 q giving
σ_ X M “ Z2ě0 and Crσ_ X Ms – Crx, ys
Hence U σ – C2 . In this case, σ_ prescribes that the only Laurent polynomials extending to all of U σ are
the polynomials.

ECH CAPACITIES, EHRHART THEORY, AND TORIC VARIETIES

7

3.2. Toric varieties arise from fans. To construct non-affine (in particular, compact) toric varieties we
glue together affine toric varieties in an torus-equivariant way. The combinatorial avatar of this process is
collecting cones together in a fan. To start with, a face of a cone σ is a subset of σ of the form σ X pxm, ¨y “ 0q
for some m P σ_ . The cones forming the boundary of σ are examples of faces, as is the vertex of the cone
(the origin). A fan in NR is a collection of cones Σ “ tσu such that
‚ if τ Ă σ is a face, then τ P Σ
‚ for any two cones σ1 , σ2 P Σ, σ1 X σ2 is a face of each
A fan Σ produces a toric variety YΣ via gluing two affine pieces U σ1 , U σ2 according to the (potentially
zero-dimensional) face they have in common.
Example 3.2. Take N “ Z2 and Σ to be the fan containing the cones σ1 “ Conepe1 , e2 q, σ2 “ Conepe1 , ´e1 ´
e2 q, σ3 “ Conepe2 , ´e1 ´ e2 q and their faces. The two-dimensional cones give three copies of C2 and the
gluing prescribed by the faces makes this into P2 . For example, σ1 and σ3 share the face Conepe2 q that
corresponds to the toric variety Cˆ ˆ C. Gluing C2 to C2 along Cˆ ˆ C is familiar from the gluing
construction of projective space.
3.3. Compact toric varieties arise from polytopes. Suppose P Ă NR is a lattice polytope. One can
produce a fan ΣP from P via
ΣP :“ tConepSq : S Ă VertpPq such that all u P S share a faceu
This is called the face fan of P and defines a toric variety YP :“ YΣP that turns out to be compact.
A polytope Q Ă MR also defines a toric variety VQ . Let L Q “ #QXM and define a map φ Q : TN Ñ PLQ ´1
by x ÞÑ pχ m pxqqm PQ XM . The toric variety VQ is defined to be the closure of the image of φ Q in PLQ ´1 . If
we define the dual polytope
P _ :“ tv P MR : xu, vy ě ´1u
then the toric variety YP is also described abstractly as the variety VkP _ for large enough k, from which it
is readily apparent that it is compact.
Example 3.3. A polytope for P2 is the triangle with vertices e1 , e2 , ´e1 ´ e2 . The dual polytope is the
triangle with vertices 2e 1 ´ e2 , ´e1 ` 2e2 , ´e 1 ´ e 2 . This has 10 lattice points and describes the third
Veronese (or anticanonical) embedding of P2 in P9 .
In the VQ presentation, one can interpret Q as the moment polytope for the compact torus action on
VQ by composing the map φ Q with the moment map on PLQ ´1 .
This toric variety VQ as an abstract variety is equivariantly isomorphic to the variety XΣpQ q arising from
the inner normal fan of Q.
3.4. Polytopes arise from divisors. A (Weil) divisor on a normal variety is a formal Z-linear combination
of codimension one subvarieties. Divisors on a variety X up to an equivalence relation called rational
equivalence form a group called the class group of X. For a toric variety X containing dense open torus
T, the class group is generated by the components of the toric boundary XzT. If X “ YΣ is given by a
fan, these boundary components correspond to the rays of Σ. The set of rays is commonly denoted Σp1q.
Thus, every divisor on YΣ is rationally equivalent to one of the form
ÿ
a ρ Dρ
ρPΣp1q

One can associate a polytope PpDq to a divisor of this form as follows. Let u ρ be the primitive lattice point
lying on the ray ρ. Then set
PpDq :“ tv P MR : xu ρ , vy ě ´a ρ for all ρ P Σp1qu
The hyperplanes defining the facets of PpDq are given by xu ρ , ¨y “ ´a ρ and so this construction of PpDq
taking in the data pu ρ , a ρ qρPΣp1q is often referred to as a ‘facet presentation’ for PpDq. Denote by OpDq the
line bundle associated to a (Cartier) divisor D.

8

B. WORMLEIGHTON

Lemma 3.4 ( [CLS], Proposition 4.3.3). Let D “
points of PpDq. That is,

ř

ρ

a ρ Dρ . A basis of H 0 pOpDqq is in bĳection with lattice

#PpDq X M “ L P pD q “ h 0 pOpDqq
Notice that there can be multiple facet presentations corresponding to the same divisor if some of the
hyperplanes give redundant inequalities.
3.5. Divisors arise from support functions. Fix a fan Σ. The support |Σ| of Σ is the union of the cones
it contains. A support function on Σ is a function ϕ : |Σ| Ñ R such that ϕ|σ is linear for each σ P Σ. An
integral support function is a support function such that ϕp|Σ| X Nq Ă Z. An integral support function ϕ
produces a (Cartier) divisor D via
ÿ
ϕpu ρ qDρ
D“´
ρPΣp1q

and this process is actually reversible (so long as D is Cartier).
4. Reformulating capacities in toric algebraic geometry
4.1. Ω-stretching. Consider a convex domain Ω Ă R2 . For a polygon Λ define SΩ Λ to be the polygon
with edges parallel to the edges of Ω by placing an edge of slope v i at the point or points at which v i is
tangent to Λ, using corners if necessary. For example,

Figure 2. Example of Ω-stretching
Λ

SΩ Λ

Ω

We call the resulting polygon SΩ Λ the Ω-stretching of Λ. The following lemma is due to Michael
Hutchings.
Lemma 4.1. ℓΩ pBΛq “ ℓΩ pBSΩ Λq.
Proof. Let p1 , . . . , p k denote the vertices of Ω. Let q i be a point on BΛ such that a tangent vector to BΛ at
q i is parallel to the vector p i ´ p i ´1 . Then by definition, the Ω-length of BΛ is
ÿ
p i ˆ pq i `1 ´ q i q
i

Notice that the same points q i still satisfy the requirements for computing the Ω-length of BSΩ Λ, so that
the nothing changes in the expression of ℓΩ pBSΩ Λq from that for ℓΩ pBΛq.

The effect of Ω-stretching is to produce a polygon of the same Ω-length but with edges parallel to the
edges of Ω.
4.2. Slope polytopes. Let Ω be a rational convex domain. Denote its set of edges by EdgepΩq. An edgeorientation o of ∆ is an orientation of each of its edges in such a way that the boundary of ∆ is an oriented
cycle. A polygon with an edge-orientation is called edge-oriented. Given an edge-oriented convex lattice
domain Ω, define the slope v e of an edge e P EdgepΩq to be the primitive lattice vector in the direction of
the oriented edge. That is, of e has endpoints e´ and e` with orientation making e´ the tail and e` the
head, v e is the primitive ray generator of the ray Rě0 ¨ pe` ´ e´ q.
Definition 4.2. The slope polytope of an edge-oriented convex lattice domain Ω is the lattice polytope
SlpΩq :“ Convpv e : e P EdgepΩqq

ECH CAPACITIES, EHRHART THEORY, AND TORIC VARIETIES

9

This produces a compact toric variety YSlpΩq on which the algebraic geometry side of the story will take
rSlpΩq .
place. We will actually work with a blowup of this toric variety, which we will denote by Y

This blowup is obtained by creating a new fan by inserting rays through any slopes v e that are not
vertices of SlpΩq. For example, suppose that Ω has slopes ´e1 , e2 , e1 , e1 ´ e2 , e1 ´ 2e2 . The slope polytope
only has vertices ´e1 , e2 , e1 , e1 ´ 2e2 and so one extra ray has to be added for e1 ´ e2 . This is demonstrated
pictorally below.
Figure 3. Blowup of YSlpΩq
‚

‚
‚

‚

‚

‚

‚

‚

‚

‚

‚

‚

Fan for YSlpΩq

rSlpΩq
Fan for Y

r SlpΩq . Observe that this fan is in some sense a
We will denote the resulting fan for the blowup by Σ
rotation of the inner normal fan of Ω after picking bases, though they naturally live in dual lattices. At
the end of this section we will provide an alternative version of the content below phrased in terms of the
inner normal fan instead of the slope polytope. It can be favourable to use each of these perspectives at
different times.
4.3. Balance divisors. As above, let Ω be a rational convex domain oriented clockwise with slope polytope
SlpΩq. We will subsequently always assume that Ω has this orientation. Define the Ω-length of a vector
v P R2 to be
ℓΩ pvq :“ v ˆ p v
where p v is a boundary point of Ω such that the halfplane p v ` tu P R2 : u ˆ v ě 0u contains Ω. Recall
that the two-dimensional cross product u ˆ v of two vectors u and v is defined to be the determinant of
the matrix with u and v as first and second columns respectively.
Lemma 4.3. Suppose Ω is lattice (resp. rational). The Ω-length is an integral (resp. rational) support function for
r SlpΩq .
the fan Σ

Proof. Suppose v, v 1 are adjacent slopes in Ω. The Ω-length applied to any vector w P Conepv, v 1 q “ σ is
given by
ℓΩ pwq “ p ˆ w

where p is the vertex shared between the two edges of slopes v and v 1 respectively. This is linear on the
cone σ, which features in ΣSlpΩq by definition and describes all full-dimensional cones in ΣSlpΩq as v, v 1
range over adjacent slopes. ℓΩ is clearly integral on integral vectors when the vertices of Ω are lattice
points, and similarly for the rational case.

Definition 4.4. The balance divisor for Ω is the Q-Cartier divisor DΩ associated with the support function
´ℓΩ . Notice the change in sign.
Corollary 4.5. The coeﬃcients of DΩ as a Weil divisor are
a v “ ℓΩ pvq
for a (primitive) slope vector v of Ω.
Corollary 4.6. DΩ is ample.

10

B. WORMLEIGHTON

Proof. It is a straightforward check that ´ℓΩ is a strictly convex function, which corresponds to DΩ being
ample.

Lemma 4.7. The polytope for DΩ is the result of rotating Ω 90˝ anticlockwise around the origin.
Proof. Denote by ΩK the rotated version of Ω. The edges of Ω are by construction orthogonal to the rays
r SlpΩq and so there is a facet presentation of ΩK coming from this fan or, equivalently, a divisor D on
of Σ
r
YSlpΩq . Order the slopes v1 , . . . , v s with corresponding toric boundary divisors D1 , . . . , Ds . It suffices that

the coefficient a i of D along Di is the same as the corresponding coefficient in DΩ . We will now compute
this directly. The edge e i of P K with slope v i is carved out by the orthogonal hyperplanes to v i ´1 , v i , v i `1 .
Suppose that v i ´1 , v i `1 form a Z-basis for Z2 . They are independent over Q and the case when they are
not a Z-basis is similar. By a change of coordinates, suppose v i ´1 “ p1, 0q, v i `1 “ p0, ´1q and v i “ pα, βq.
Then the endpoints of the edge in ΩK corresponding to v i are
˙
ˆ
˙
ˆ
βa i `1 ` a i
αa i ´1 ´ a i
, a i `1
and ´
´a i ´1 ,
β
α

After rotating back, the Ω-length of v i is then

ˇ
ˇ α
ˇ
ℓΩ pv i q “ ˇ
ˇ a i `1

β
βa i `1 ` a i
α

which is the same as the corresponding coefficient in DΩ .
Corollary 4.8. L rΩ “ h 0 prDΩ q.

ˇ
ˇ
ˇ
ˇ “ ai
ˇ



Notice that there are many choices of Ω with the same slope polytope SlpΩq and so to reflect the choice
rSlpΩq is polarised
of Ω an extra choice has to be made in the geometry. This choice is a polarisation, where Y
by the ample divisor DΩ . The same proof actually shows:

Corollary 4.9. Let Λ be a polygon with all edges parallel to edges of Ω. Denote by ΛK the 90˝ anticlockwise rotation
rSlpΩq with polygon ΛK are
of Λ about the origin. The coeﬃcients of a divisor DΛ on Y
ÿ
DΛ “
ℓΛ pvqDv
with notation as above.

When Ω is lattice, DΩ is Cartier. Cartier divisors can also be characterised by their Cartier data, which
has a toric version found in §4.2 of [CLS]. To this end, let pa, bqK :“ p´b, aq. This has the property that
´u ¨ v K “ u ˆ v.
Corollary 4.10. The Cartier data for DΛ is m σi “ q K
, where q i is the vertex in common between the edges of slopes
i
v i , v i `1 , the vertices in ΣpΩq bounding σi .
Proof. As seen, v i ˆ q i “ a i and so v i ¨ q K
“ ´a i .
i



The balance divisor also captures the Ω-length by how it intersects other divisors. We will prove the
following lemma in toric geometry to progress towards this.
Lemma 4.11. Let XΣ be a projective toric surface. An R-divisor D on XΣ is nef iﬀ D ¨ Dρ equals the lattice length
of the edge of PpDq corresponding to ρ for each ray ρ P Σp1q.
Proof. The if part is clear by the toric Kleiman condition. For the converse, observe that if D is ample then
there is a unique facet presentation of ΛK :“ PpDq as every slope is represented by an edge in PpDq. This
means that D must be equal to
ÿ
ℓΛ pu ρ qDρ

adapting notation from Corollary 4.9 and the result follows from the proof of that corollary. If D is nef,
then it must be the case that some of the inequalities in the facet presentation are only just redundant:
that is, none of the hyperplanes have empty intersection with PpDq, but some might only intersect at a
vertex. This follows as the interior of the nef cone is the ample cone, or from the description of nef and
ample divisors in [B91] Theorem 2.15 or [CLS] Theorem 6.4.9. It suffices to show that D ¨ Dρ “ 0 for any
ρ giving a redundant hyperplane (that is, an edge of length 0) but this follows from a direct calculation
using [CLS] Prop. 6.4.4.


ECH CAPACITIES, EHRHART THEORY, AND TORIC VARIETIES

11

Suppose that Λ is a polygon with edges parallel to the edges of Ω. As discussed above, there is a facet
rSlpΩq with this as its polygon.
presentation of ΛK and so there is a nef divisor DΛ on Y

Lemma 4.12. ℓΩ pBΛq “ DΛ ¨ DΩ .

Proof. From Lemma 4.11, the lattice length of the edge of slope v i in Λ is DΛ ¨ Di . The Ω-length of the
edge is thus pDΩ ¨ Di q ¨ ℓΩ pv i q. Summing all these up gives the Ω-perimeter as
ÿ
ÿ
ℓΩ pBΛq “ pDΛ ¨ Di q ¨ ℓΩ pv i q “ DΛ ¨
ℓΩ pv i qDi “ DΛ ¨ DΩ
as required.



Corollary 4.13. ℓΩ pBΛq “ ℓΛ pBΩq.
4.4. Proof of Theorem 1.5. We are now in a position to convert the definition of ECH capacities and cap
functions into purely algebro-geometric language.
Theorem 4.14. Suppose Ω is a rational convex domain. Then
rSlpΩq , Dq ě k ` 1u
c k pXΩ q “ mintD ¨ DΩ : h 0 pY
D

rSlpΩq , Dq : D ¨ DΩ ď ru
capXΩ prq “ maxth 0 pY
D

rSlpΩq .
where both extrema range over all nef Q- or R-divisors D on Y

Proof. Since intersection with DΩ describes the Ω-length and the number of lattice points enclosed equals
h 0 , the only thing to check is that the extrema ranging over nef Q- or R-divisors is equivalent to ranging
over convex lattice paths. We will focus on the real case from which it will be clear why the minima
are achieved by rational nef divisors. We use nef divisors to ensure that each ‘edge length’ D ¨ Di is
nonnegative. Note that the two equalities in the theorem are equivalent and so we will focus only on the
first. For convenience denote
alg r
0 r
c k pY
SlpΩq q “ inftD ¨ DΩ : h pYSlpΩq , Dq ě k ` 1u

Note that a minimum really is attained. Indeed, pick a nef R-divisor D‹ with at least k ` 1 global secalg r
tions. Then c k pY
SlpΩq q ď D‹ ¨ DΩ and the infimum is the same if we take it over all nef R-divisors
0 r
with h pYSlpΩq , Dq ě k ` 1 and D ¨ DΩ ď D‹ ¨ DΩ . Observe that this extra condition places an upper

bound on each of the (nonnegative) lattice lengths of edges of the polygon PpDq for such D. This infimum
thus takes place over a compact region inside the (closed) nef cone and is therefore realised by some divisor.
Suppose that D “ DΛ realises this minimum. Its (rotated) polygon Λ must have a lattice point on
every edge as otherwise one could perturb the coefficient in the facet presentation for an edge with no
lattice point to obtain a divisor with the same number of global sections but smaller intersection with DΩ .
Notice that this implies that D is a Q-divisor. Let Λ1 be the convex hull of all lattice points in Λ. Note that
k 1 `1 “ LΛ “ LΛ1 for some k 1 ě k. Then SΩ Λ1 “ Λ by construction (as we assumed that Λ has a lattice point
on each edge) and so by Lemma 4.1 and Lemma 4.12 we have ℓΩ pBΛ1 q “ ℓΩ pBSΩ Λq “ ℓΩ pBΛq “ D ¨ DΩ .
Now we will show that, potentially after translation, BΛ1 is a convex lattice path in the sense of Definition
2.3.
Λ has two distinguished (possible length 0) edges of slopes ´e1 and e2 by construction of SlpΩq that
meet at a point p0 . For these edges to each contain a lattice point, they must each be subsets of affine lines
of the form py “ βq and px “ αq respectively for some α, β P Z. Hence p 0 “ pα, βq P Z2 is a lattice point.
We can thus use this lattice point to translate Λ back to the origin without changing the pairing with DΩ
(the Ω-length) or the dimension of global sections. By convexity Λ1 thus also contains two adjacent edges
with slopes ´e1 and e2 . Since Λ has slopes parallel to the slopes of Ω and is convex, the boundary of Λ
forms a convex rational path in the sense of Definition 2.3. It follows that the boundary of Λ1 forms a
convex lattice path and hence features in the minimum of Theorem 2.4 giving the combinatorial formula
for c k 1 pXΩ q. Consequently,
alg

rSlpΩq q
c k pXΩ q ď c k 1 pXΩ q ď ℓΩ pBΛ1 q “ ℓΩ pBΛq “ D ¨ DΩ “ c k pY

12

B. WORMLEIGHTON

For the converse inequality, suppose that Λ is a lattice polygon whose boundary BΛ is a convex lattice
path realising the minimum of Theorem 2.4. That is, c k pXΩ q “ ℓΩ pBΛq and LΛ “ k ` 1. Then Ξ “ SΩ Λ
is a rational polygon with edges parallel to the edges of Ω, which hence defines a nef Q-divisor DΞ on
rSlpΩq . Now, using Lemma 4.1 and Lemma 4.12,
Y
c k pXΩ q “ ℓΩ pBΛq “ ℓΩ pBSΩ Λq “ DΞ ¨ DΩ

rSlpΩq , DΞ q ě k ` 1 giving
Notice that SΩ Λ contains at least as many lattice points as Λ and so h 0 pY
alg

rSlpΩq q ď DΞ ¨ DΩ “ c k pXΩ q
c k pY

which supplies the converse inequality.



alg

rSlpΩq q uses h 0 ě k ` 1 instead of equality (as in the original optimisation problem
Notice that c k pY
rSlpΩq with k ` 1 sections; for
for ECH capacities in Theorem 2.4) because there might not be divisors on Y

example, there are no divisors D on P2 with h 0 pP2 , Dq “ 2. Combinatorially, this comes from the fact that
the lattice paths in Definition 2.3 are allowed any rational slopes whereas the paths coming from divisors
in Theorem 4.14 must have edges parallel to edges of Ω.
4.5. A speculative digression. Observe that one can try to define for any pair of a projective surface Y
and an ample divisor A on Y
alg

c k pY, Aq :“

inf tD ¨ A : h 0 pY, Dq ě k ` 1u

NefpY qR

taking the infimum again over the nef cone. It would be interesting to explore whether some of these
sequences interact with symplectic capacities for other kinds of symplectic 4-manifold, or to study the
structure of their associated cap functions. We speculate that these cap functions are eventually quasipolynomial when Y is an orbifold.
4.6. Reformulation in terms of the inner normal fan. There is another fan one can associate to a polytope P now living in MR called the inner normal fan ΣpPq, which consists of cones in NR . For a polygon
P Ă R2 , this is the fan with rays generated by inward-pointing normals to each of the faces and with all
two-dimensional cones between them included. Observe that, after picking a basis as we implicitly did
rSlpΩq of YSlpΩq is the 90˝ anticlockwise rotation of ΣpΩq: taking slopes
r SlpΩq for the blowup Y
above, the fan Σ
is dual to taking normals.
Completely analogously, we obtain a toric variety YΣpQ q that is isomorphic to the previous toric variety
r
YSlpΩq with an ample divisor DΩ whose coefficient along the divisor Dρ is ℓΩ pvq, where ρ is the ray
generated by a normal to the edge of slope v. pYΣpΩq , DΩ q has the same intersection theoretic and
rSlpΩq , DΩ q and so the results of the previous subsections exactly
cohomological properties as the pair pY
cross over to this setting.
Theorem 4.15. Suppose XΩ is a rational convex toric domain. Then
c k pXΩ q “ mintD ¨ DΩ : h 0 pYΣpΩq , Dq ě k ` 1u
capXΩ prq “ maxth 0 pYΣpΩq , Dq : D ¨ DΩ ď ru
where both extrema range over all nef Q- or R-divisors on YΣpΩq .
We remark that the advantage of the inner normal fan in this context is its familiarity as a standard
object of toric algebraic geometry, however the approach via slope polytopes is quite pleasing and may
have better duality properties if a general explanation for this phenomenology via mirror symmetry exists.
For the sake of familiarity and consistency with the introduction, we will continue to use ΣpΩq instead of
r SlpΩq for the remainder of the paper.
Σ

ECH CAPACITIES, EHRHART THEORY, AND TORIC VARIETIES

13

4.7. Free convex toric domains. One can also consider the situation when Ω Ă R2 is a convex body that
doesn’t intersect the coordinate axes, which is where fibres of the moment map decrease in dimension
and pick up nontrivial isotropy. We call such XΩ free convex toric domains. This was one of the situations
originally considered in [H11]. There is an analogous theorem there to Theorem 2.4. To state it, we define
v‹
for such Ω a new pseudonorm ℓΩ
depending on a vector v‹ P Ω˝ as follows. Consider Ω1 “ Ω ´ v‹ . This
is now a polygon with the origin in its interior. We consider the norm || ¨ ||Ω1 whose unit ball is Ω1 and its
dual norm on pR2 q˚
||φ||˚Ω1 :“ maxtφpvq : v P Ω1 u
We identify pR2 q˚ with R2 via the dot product, giving
||u||˚Ω1 :“ maxtu ¨ v : v P Ω1 u
Define the length in this pseudonorm of a polygonal path ψ consisting of line segments v1 , . . . , v r to be
v‹
ℓΩ
pψq :“

r
ÿ

||v i ||˚Ω1

i “1
v‹
Lemma 4.16 ( [H14], Exercise 4.13). The length of closed polygonal paths measured in ℓΩ
is independent of v‹ .
v‹
1
We denote the restriction of ℓΩ
to closed polygonal paths by ℓΩ
to indicate its independence of v‹ .

Theorem 4.17 ( [H11], Theorem 1.11). Suppose Ω Ă R2 is a polygon that does not intersect either coordinate
axis so that XΩ is a free convex toric domain. Then
1
c k pXΩ q “ mintℓΩ
pBΛq : LΛ “ k ` 1u

where the minimum ranges over lattice polygons Λ.
As discussed in [H14] Exercise 4.16 it is equivalent to take the minimum over all polygons with edges
parallel to edges of Ω and with no constraints on their vertices with the modification that LΛ ě k ` 1.
Theorem 4.18. Suppose XΩ is a free rational convex toric domain. Then,
c k pXΩ q “ mintD ¨ DΩ : h 0 pYΣpΩq , Dq ě k ` 1u
capXΩ prq “ maxth 0 pYΣpΩq , Dq : D ¨ DΩ ď ru
where DΩ is the balance divisor from Deﬁnition 4.4 and where both extrema range over all nef Q- or R-divisors on
YΣpΩq .
Proof. As before, the two equalities are equivalent and so we will only show the first. Let v‹ P Ω˝ and set
Ω1 “ Ω ´ v‹ . Suppose that u1 , u2 are outward normals to adjacent faces of Ω. The dual norm || ¨ ||˚Ω1 is
linear on Conepu1 , u2 q, since the maximum of v ¨ ´ will be achieved (possibly non-uniquely) at the vertex
shared between the two adjacent edges for any v P Conepu1 , u2 q. It is hence a support function on the outer
normal fan Σ´ pΩq, which is just the negative of the inner normal fan. Notice that for v P Conepu1 , u2 q, the
dual norm ||v||˚Ω1 “ v ¨ p where p is the vertex described above, but this is equal to ´v K ˆ p by definition.
Note that p is exactly the point of BΩ1 at which ´v K is tangent to BΩ1 so that p “ p v as in the definition of
Ω1 -length in §2.1. Hence,
||v||˚Ω1 “ ℓΩ1 p´v K q
It follows that
1
pBΛq : LΛ “ k ` 1u
c k pXΩ q “ mintℓΩ

“ mintℓΩ1 pBΞq : LΞ “ k ` 1u
via the correspondence Λ ÞÑ ´ΛK , where both minima range over all lattice polygons Λ or Ξ respectively.
But by a similar (actually simpler) argument to the proof of Theorem 4.14, this second minimum can
be seen to be equal to mintD ¨ DΩ1 : h 0 pYΣpΩq , Dq ě k ` 1u. Now Ω1 is just a translate of Ω and so
D ¨ DΩ “ D ¨ DΩ1 for all divisors D, which gives the result.

We finally observe that all of the machinery developed above works equally well when Ω is an irrational
polygon with rational slopes, since rationality is only required on the level of edges to define a fan that
will produce a toric variety. The only difference is that DΩ will no longer be a Q-divisor.

14

B. WORMLEIGHTON

5. Computing cap functions
The aim of this section is to define ‘tightly constrained’ convex domain and to prove the following
theorem.
Theorem 5.1. Suppose Ω is a tightly constrained convex lattice domain. Then, there exists x 0 P Zě0 such that for
all x ě x0 and for each r “ 0, . . . , λ ´ 1,
capXΩ pr ` λxq “ ehrΩ pxq ` rx ` γr
for some constant γr P Z depending only on r. If Ω has a weight equal to 1 then Ω is tightly constrained and
moreover one can choose x0 “ 0.
In order to do so, we will study the combinatorics of Ω in terms of its weight sequence, and then use
this data to compute the cap function recursively. We will discuss the tightly constrained assumption on
Ω and how every convex toric lattice domain conjecturally reduces to this case.
5.1. Combinatorics of weight sequences. Recall that the weight sequence associated to a convex domain
Ω consists of a number and two lists that we will write as pc; a i ; b i q. We will assume that the lists are finite
sets of integers, which implies that Ω is rational. From the asymptotics of capacities of convex domains,
1ÿ 2
ai
VolpΩ2 q “ Volp>i Bpa i qq “
2
and so
ÿ
ÿ
b 2i
ℓΩ pBΩq “ 2 VolpΩq “ VolpBpcqq ´ Volp>i Bpa i qq ´ Volp>i Bpb i qq “ c 2 ´
a 2i ´

Consider now the number of lattice points enclosed by a concave domain, excluding those on the upper
boundary. Each ball Bpb i q contributes 21 b i pb i ` 1q lattice points; note that the transformation realising the
inductive description of the weight sequence is a special affine linear map and so preserves lattice point
counts. Hence the number of lower lattice points (i.e. excluding the upper boundary) in Ω3 is
ÿ1
b i pb i ` 1q
2
and thus the number of lattice points enclosed by Ω is
ÿ1
ÿ1
1
pc ` 1qpc ` 2q ´
α i pα i ` 1q ´
b j pb j ` 1q
2
2
2
For future reference will note that this is equal to
ÿ1
ÿ1
1
1 ` cpc ` 3q ´
α i pα i ` 1q ´
b j pb j ` 1q
2
2
2

5.2. Reducing the problem. For a convex domain Ω with weight sequence wpΩq “ pc; a i ; b j q, Lemma 2.6
gives that the ECH capacities of XΩ are given by
c k pXΩ q “ mintc k `k2 `k3 pBpcqq ´ c k2 p>i Bpa i qq ´ c k3 p> j Bpb j qq : k2 , k3 P Zě0 u
By the disjoint union property of capacities, this is equal to
ÿ
ÿ
c k pXΩ q “ mintc k `ři k i `ř j m j pBpcqq ´
c k i pBpa i qq ´
c m j pBpb j qq : k i , m j P Zě0 u
i

It follows that the cap function of XΩ is given by
capXΩ prq “ 1 ` maxtk : Dk i , m j with c k `ři k i `ř j m j pBpcqq ´

j

ÿ

c k i pBpa i qq ´

i

ÿ

c m j pBpb j qq ď ru

j

The capacities of a ball Bpqq take the form
c k pBpqqq “ dq when

1
1
dpd ` 1q ď k ď δpδ ` 3q
2
2

Hence, to maximise k, one may assume that k i “ 21 α i pα i ` 1q, m j “ 21 β j pβ j ` 1q, and k `
1
2 δpδ ` 3q for some α i , β j , δ. Therefore capXΩ prq is 1 plus the maximum of
ÿ1
ÿ1
1
α i pα i ` 1q ´
β j pβ j ` 1q
Cpδ, α i , β j q :“ δpδ ` 3q ´
2
2
2
i
j

ř

i

ki `

ř

j

mj “

ECH CAPACITIES, EHRHART THEORY, AND TORIC VARIETIES

subject to
δc ´

ÿ

αi ai ´

i

ÿ

15

βi bi ď r

j

where α i , β j , δ range over nonnegative integers.
5.3. Final calculations.

Lemma 5.2. Fix a weight sequence pc; a1 , . . . , a s ; b1 , . . . , b t q and let λ “ c 2 ´
maximises Cpδ, α i , β j q subject to
ÿ
ÿ
δc ´
αi ai ´
βj bj “ r
i

ř

a 2i ´

ř

b 2i . Suppose pδ, α i , β i q

j

1

Then the sequence pδ ` c, α i ` a i , β i ` b i q maximises Cpδ , α1i , β1i q subject to
ÿ
ÿ
β1j b j “ r ` λ
δ1 c ´
α1i b i ´
j

i

Proof. Suppose there exists pδ1 , α1i , β1j q with Cpδ1 , α1i , β1j q ą Cpδ ` c, α ` a i , β j ` b j q. We will show that
Cpδ1 ´ c, α1i ´ a i , β1j ´ b j q ą Cpδ, α i , β j q, contradicting maximality since
ÿ
ÿ
pδ1 ´ cqc ´ pα1i ´ a i qa i ´ pβ1j ´ b j qb j “ r

For convenience, relabel the b j as a s ` j and β j as α s ` j and write Cpδ, α i q “ Cpδ, α i , β j q. Compute
2Cpδ1 ´ c, α1i ´ a i q to be
ÿ
pδ1 ´ cqpδ1 ´ c ` 3q ´ pα1i ´ a i qpα1i ´ a i ` 1q
ÿ
ÿ
ÿ
ÿ
a 2i
α1i a i ´ cpδ1 ` 3q ` pα1i ` 1qa i ` c 2 ´
“ δ1 pδ1 ` 3q ´
α1i pα1i ` 1q ´ cδ1 `
ÿ
ÿ
ai ` λ
“ δ1 pδ1 ` 3q ´
α1i pα1i ` 1q ´ pr ` λq ´ pr ` λq ´ 3c `
ÿ
ÿ
ą pδ ` cqpδ ` c ` 3q ´ pα i ` a i qpα i ` a i ` 1q ´ 2r ´ λ ´ 3c `
ai
ÿ
ÿ
ÿ
ÿ
ÿ
“ δpδ ` 3q ´
α i pα i ` 1q ` cδ ´
α i a i ` cpδ ` 3q ´ pα i ` 1qa i ` c 2 ´
a 2i ´ 2r ´ λ ´ 3c `
ai
ÿ
ÿ
“ Cpδ, α i , β j q ` r ` r ` 3c ´
a i ` λ ´ 2r ´ λ ´ 3c `
ai
“ Cpδ, α i , β j q

as desired.



Definition 5.3. Say that a convex lattice domain Ω (or a convex lattice toric domain XΩ ) with weight
sequence pc; a i ; b i q is tightly constrained with lower bound r0 if for all r ě r0 the maximum of Cpδ, α i , β j q
subject to
ÿ
ÿ
δc ´
αi ai ´
βi bi ď r
i

is attained by some pδ, α i , β j q with

δc ´

ÿ
i

j

αi ai ´

ÿ

βi bi “ r

j

Say that Ω is tightly constrained if it is tightly constrained with some lower bound r0 .
Lemma 5.4. Ω being tightly constrained with lower bound r0 is equivalent to the statement that for every positive
integer r ě r0 there is some k P Zě0 such that c k pXΩ q “ r.
Proof. By definition the cap function of XΩ is 1 plus the largest value of k such that c k pXΩ q ď r. If there
is some k with c k pXΩ q “ r then this largest value of k will be achieved by some k with c k pXΩ q “ r by
monotonicity. The largest value of k corresponds to a value of Cpδ, α i , β j q from the reasoning above, for
ř
ř
which the corresponding capacity takes the value δc ´ α i a i ´ β j b j “ r.

Equivalently, capXΩ pr ` 1q ą capXΩ prq for all r ě r0 , so that capXΩ is eventually strictly increasing.

Example 5.5. Suppose XΩ “ Epa, bq is an ellipsoid with a prime, a ă b, and gcdpa, bq “ 1. Then XΩ is
tightly constrained with lower bound pa ´ 1qb to cover all residues mod a.
Lemma 5.6. Suppose Ω has at least one weight equal to 1. Then Ω is tightly constrained with lower bound r0 “ 0.

16

B. WORMLEIGHTON

Proof. Suppose pc; a i ; b j q is a weight sequence with a1 “ 1. Let pδ, α i , β j q maximise Cpδ, α i , β j q subject to
ř
ř
ř
ř
δc ´ i α i a i ´ j β j b j ď r. Suppose δc ´ i α i a i ´ j β j b j ă r. Modify pδ, α i , β j q to pδ, α1i , β j q where
ř
α11 “ α1 ´ 1 and α1i “ α i for i ě 2. This sequence has Cpδ, α1i , β j q “ 12 δpδ ` 3q ´ 21 pα1 ´ 1qα1 ´ 21 α i pα i `
ř
ř
ř
ř
ř1
1q ´ 2 β j pβ j ` 1q ą Cpδ, α i , β j q and δc ´ pα1 ´ 1qa1 ´ α i a i ´ β j b j “ δc ´ i α i a i ´ j β j b j ` b1 ď r.
This contradicts the fact that pδ, α i , β j q was maximal.

Conjecture 5.7. Suppose that gcdtc, a1 , . . . , a s , b1 , . . . , b t u “ 1. Then Ω is tightly constrained.
Notice that the conjecture will certainly fail for weight sequences without the coprimality assumption.
For example, the ball Bp2q has capacities that are all even numbers and so there can be no odd values of
the constraint. We will henceforth make the assumption that Ω is tightly constrained.
Corollary 5.8. For a tightly constrained convex lattice domain Ω with lower bound r0 “ 0, BΩ is an optimal path
among lattice paths of length at most ℓΩ pBΩq.
Proof. Clearly capXΩ p0q “ 1 ` 0 is attained by pδ, α i , β j q “ p0, 0, . . . , 0q. Hence,
ÿ
ÿ
1
capXΩ pλq “ 1 ` Cpc, a i , b j q “ pc ` 1qpc ` 2q ´
a i pa i ` 1q ´
b j pb j ` 1q “ LΩ
2
as required.



Lemma 5.9. Let Ω be a tightly constrained convex lattice domain. Denote the Ω-perimeter of Ω by λ. Then there
exists x0 P Zě0 such that for all x ě x0 and for each r “ 0, . . . , λ ´ 1,

for some γr P Z, where LBΩ

1
capXΩ pλx ` rq “ VolpΩqx 2 ` p LBΩ ` rqx ` γr
2
is the number of lattice points on the boundary of Ω.

Proof. From Lemma 5.6 and the assumption that Ω is tightly constrained one has that the maximum value
ř
ř
of Cpδ, α i , β j q subject to δc ´ i α i a i ´ j β j b j ď r ` λ is
ÿ1
1
b i pb i ` 1q “ Cpδ1 , α1i , β1j q ` r ` LΩ ´ 1
Cpδ1 , α1i , β1j q ` r ` cpc ` 3q ´
2
2
ř
ř
when pδ1 , α1i , β1j q is maximal subject to δ1 c ´ i α1i a i ´ j β1j b j ď r, at least for large enough r. It follows
that, for r ` λx large enough,
(˚)

capXΩ pr ` λpx ` 1qq “ capXΩ pr ` λxq ` r ` λx ` LΩ ´ 1

This implies that capXΩ pr ` λxq is eventually a quadratic polynomial. Solving the difference equation (˚)
gives the leading term as λ{2 and gives the linear coefficient as LΩ ´ VolpΩq ´ 1 ` r. By Pick’s formula
the linear term is equal to 21 LBΩ ` r, and we have seen that λ{2 “ ℓΩ pBΛq{2 “ VolpΩq.

This is the desired quasipolynomial representation of capXΩ . However, we would also like this to have
an algebro-geometric interpretation. The Ehrhart polynomial of Ω, as a lattice polygon, is
1
ehrΩ pxq “ VolpΩqx 2 ` LBΩ x ` 1
2
Corollary 5.10. Let Ω be a tightly constrained convex lattice domain of Ω-perimeter λ. Then, for any r P
t0, 1, . . . , λ ´ 1u and suﬃciently large x P Zě0
capXΩ pr ` λxq “ ehrΩ pxq ` rx ` γr
“ hilbpYΣpΩq ,DΩ q pxq ` rx ` γr
for some γr P Z. In particular, for all suﬃciently large x P Zě0
capXΩ pλxq “ ehrΩ pxq ` γ0 “ hilbpYΣpΩq ,DΩ q pxq ` γ0
We believe that always γr “ capXΩ prq ´ 1, which is what one would obtain from the difference equation
(˚) holding for all x P Z, not just all sufficiently large x. This would in particular imply that γ0 “ 0.
Suppose XΩ is not tightly constrained. Assuming Conjecture 5.7, one can scale Ω to obtain a convex lattice
domain Ω1 that is tightly constrained. Let qΩ1 “ Ω. Then, using the scaling axiom from §2.4, for any
r “ 0, . . . , q ´ 1 one has
capXΩ pr ` qxq “ capXΩ pqxq “ capXΩ1 pxq

ECH CAPACITIES, EHRHART THEORY, AND TORIC VARIETIES

17

Thus, knowing Theorem 5.1 for tightly constrained convex toric lattice domains is sufficient to completely
describe the long term behaviour of the cap function for all convex toric lattice domains.
Example 5.11. For XΩ “ Bp2q, one has
#
capB p1q p 2r q
capXΩ prq “
capB p1q p r ´2 1 q

r ” 0 mod 2
r ” 1 mod 2

“

#

1
8 pr
1
8 pr

` 2qpr ` 4q

r ” 0 mod 2

` 1qpr ` 3q

r ” 1 mod 2

We conjecture that the word ‘eventually’ may be dropped in all the above results, and that in fact the
cap function of a tightly constrained convex toric lattice domain is given entirely by the quasipolynomial
in Theorem 5.1. Of course, this is already proven if one of the weights of Ω is equal to 1.
References
[B91] Batyrev, V. V. (1991). On the classiﬁcation of smooth projective toric varieties. Tohoku Mathematical Journal, Second Series, 43(4),
569-585.
[CCFHR] Choi, K., Cristofaro-Gardiner, D., Frenkel, D., Hutchings, M., & Ramos, V. G. B. (2014). Symplectic embeddings into fourdimensional concave toric domains. Journal of Topology, 7(4), 1054-1076.
[CHLS] Cieliebak, K., Hofer, H., Latschev, J., & Schlenk, F. (2005). Quantitative symplectic geometry. arXiv preprint math/0506191.
[C15] Cristofaro-Gardiner, D. (2014). Symplectic embeddings from concave toric domains into convex ones. arXiv preprint arXiv:1409.4378.
[CHR] Cristofaro-Gardiner, D., Hutchings, M., & Ramos, V. G. B. (2015). The asymptotics of ECH capacities. Inventiones mathematicae,
199(1), 187-214.
[CK13] Cristofaro-Gardiner, D., & Kleinman, A. (2013). Ehrhart polynomials and symplectic embeddings of ellipsoids. arXiv preprint
arXiv:1307.5493.
[CS18] Cristofaro-Gardiner, D., & Savale, N. (2018). Sub-leading asymptotics of ECH capacities. arXiv preprint arXiv:1811.00485.
[CLS] Cox, D. A., Little, J. B., & Schenck, H. K. (2011). Toric varieties. American Mathematical Soc..
[G85] Gromov, M. (1985). Pseudo holomorphic curves in symplectic manifolds. Inventiones mathematicae, 82(2), 307-347.
[HJST] Haase, C., Juhnke-Kubitzke, M., Sanyal, R., & Theobald, T. (2015). Mixed Ehrhart polynomials. arXiv preprint arXiv:1509.02254.
[H11] Hutchings, M. (2011). Quantitative embedded contact homology. Journal of Differential Geometry, 88(2), 231-266.
[H14] Hutchings, M. (2014). Lecture notes on embedded contact homology. In Contact and symplectic topology (pp. 389-484). Springer,
Cham.
[M11] McDuff, D. (2011). The Hofer conjecture on embedding symplectic ellipsoids. Journal of Differential Geometry, 88(3), 519-532.
Department of Mathematics, University of California at Berkeley, Berkeley, CA, 94720, USA
E-mail address: b.wormleighton@berkeley.edu

