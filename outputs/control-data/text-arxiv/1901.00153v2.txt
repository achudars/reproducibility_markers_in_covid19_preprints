Occupation time statistics of a gas of interacting diffusing particles
Tal Agranov,1, ∗ P. L. Krapivsky,2, † and Baruch Meerson1, ‡

arXiv:1901.00153v2 [cond-mat.stat-mech] 7 Apr 2019

1

Racah Institute of Physics, Hebrew University of Jerusalem, Jerusalem 91904, Israel
2
Department of Physics, Boston University, Boston, Massachusetts 02215, USA

The time which a diffusing particle spends in a certain region of space is known as the occupation time, or the residence time. Recently the joint occupation time statistics of an ensemble
of non-interacting particles was addressed using the single-particle statistics. Here we employ the
Macroscopic Fluctuation Theory (MFT) to study the occupation time statistics of many interacting
particles. We find that interactions can significantly change the statistics and, in some models, even
cause a singularity of the large-deviation function describing these statistics. This singularity can
be interpreted as a dynamical phase transition. We also point out to a close relation between the
MFT description of the occupation-time statistics of non-interacting particles and the level 2 large
deviation formalism which describes the occupation-time statistics of a single particle.

I.

INTRODUCTION

The amount of time a Brownian particle spends in
some region of space, known as the occupation time, or
a residence time, is a key quantity in the description of
Brownian motion. This quantity was extensively studied
[1–28], and it has many applications in different fields.
The occupation time statistics displays interesting and
often surprising properties. One well-known example is
the arcsine law [1] for the occupation of the half line.
More recent results include the non-monotonicity of the
occupation time as a function of the diffusion coefficient
[17], non-ergodicity [11, 15], and non-analyticity of the
large deviation function, characterizing the occupation
time of a driven Brownian particle [26, 27]. One important application of the occupation-time statistics deals
with diffusion-controlled chemical reactions. Consider a
receptor, whose activity is proportional to the time during which signaling molecules stay in its vicinity. Then
the occupation time can be used to evaluate the reaction rate [9, 10, 12–14]. There can be many signaling
molecules and the activity is proportional both to time
and to the number of molecules in the vicinity of the
receptor [12, 13]. The ensuing many-body problem has
been addressed for non-interacting Brownian molecules,
where the calculations are based on the single-particle
statistics [12, 13].
In many biologically relevant situations such as in
crowded living cell, inter-particle interactions can be
significant [29], and the single-particle approach breaks
down. In this work we continue a previous line of research
[30–34] and address this many-body problem by employing the Macroscopic Fluctuation Theory (MFT) [35].
The MFT proves to be useful also for non-interacting particles. The formalism is versatile and can be applied to
systems of different geometries and dimensions. For simplicity, we focus on one-dimensional systems. We show

∗
†
‡

tal.agranov@mail.huji.ac.il
pkrapivsky@gmail.com
meerson@mail.huji.ac.il

that interactions between diffusing particles strongly affect the occupation time statistics. They introduce a
nontrivial dependence of the statistics on the number of
particles. Remarkably, they lead, for some diffusive lattice gas models, to non-analyticity in the large deviation
function which characterizes the occupation time statistics. Non-analyticities of this type are usually classified
as dynamical phase transitions. Other examples of dynamical phase transitions in diffusive lattice gases can be
found in Refs. [36–40].
Here is a plan of the remainder of the paper. In Sec. II
we briefly discuss the single-particle occupation statistics
and two existing formalisms for addressing them. We
then define the occupation fraction of an ensemble of
diffusing particles and show how to calculate this quantity for non-interacting particles, using the single-particle
statistics. In Sec. III we formulate the MFT of the occupation time statistics. In Sec. IV we test our theory
for non-interacting random walkers (RWs) and reproduce
the single-particle theory [26, 27]. We also point out,
for the non-interacting particles, to a close relation between the MFT of RWs and the level 2 single-particle
large deviation formalism. In Secs. V and VI, we apply
the MFT to two models of interacting lattice gases: the
simple symmetric exclusion process (SSEP) and the zerorange process (ZRP). In Sec. VII we study the occupation statistics in finite systems and uncover a dynamical
phase transition for a class of interacting lattice gases. In
Appendix B we consider the role of finite-size effects in
the occupation statistics of non-interacting particles. To
our knowledge, previous studies of the finite-size effects
dealt only with a single particle and were limited to the
evaluation of the variance of the occupation fraction [20].
Our main findings are summarized in Sec. VIII.
II.

OCCUPATION FRACTION: FROM A
SINGLE PARTICLE TO MANY

Let us consider a Brownian particle on the infinite line
and denote by X(t) its position at time t. The occupation
fraction of the interval |x| < l is the fraction of time ν
that the particle spends inside this interval during the

2
time interval (0, T ). This quantity is also known as the
empirical measure of the particle inside the interval:
ν=

1
T

Z

T

Z

l

dx δ [x − X(t)] ,

dt

(1)

−l

0

where δ (. . . ) is the Dirac delta function. As the particle wanders along the line, it becomes exceedingly improbable for it to spend a finite fraction of time inside
the interval, so that the expected value ν̄ tends to 0 as
T → ∞. The probability P1 (ν, T → ∞) of observing any
finite value of ν has the large deviation form [41]:
P1 (ν, T → ∞) ∼ e−T s1 (ν) ,

(2)

where the decay rate s1 (ν) plays the role of the large
deviation function. As an extreme, P1 (ν = 1, T → ∞)
describes the probability that the Brownian particle remains inside the interval during the entire time T . This
probability is known as the survival probability, and it
was calculated long ago [3, 42]:
s1 (ν = 1) =

π 2 D0
,
4l2

(3)

where D0 is the diffusion coefficient of the Brownian
particle. The calculation involves solving the diffusion
equation with absorbing boundary conditions at |x| = l.
In the long-time limit the solution is dominated by the
smallest eigenvalue π 2 /4l2 of the Laplace operator with
Dirichlet boundary conditions, which determines the decay rate (3).
The problem of computing the rate function s1 (ν) over
its entire range 0 ≤ ν ≤ 1 is more involved, and it was
addressed only recently [25–27, 43]. Within the DonskerVaradhan (DV) large-deviation formalism [44], s1 can be
extracted from the cumulant generating function (the latter is the Legendre-Fenchel transform of the former). The
generating function is obtained by solving a parameterdependent eigenvalue problem for the so-called tilted generator [25]. Here we will reproduce the single-particle solution of Refs. [25–27] and provide an analytic expression
for the rate function (2) in a parametric form. We will
do it, however, by specializing the MFT formalism to a
system of many non-interacting particles. These calculations will demonstrate a close connection between the
MFT and two other methods: the DV formalism and
the level 2 large deviations formalism [25, 27, 45]. The
level 2 formalism was originally developed for equilibrium
steady states, but it can be extended to non-stationary
processes [45]. The level 2 formalism deals with the rate
functional I[ρ1 (x)] which characterizes the distribution
of the fluctuating empirical density of the particle:
ρ1 (x) =

1
T

Z

T

dt δ[x − X(t)].

(4)

0

The quantity ρ1 (x) can be interpreted as a single-particle
analog of a (time averaged) number density of a “gas”

composed of only one particle. At long times the distribution of ρ1 (x) obeys a large-deviation form
P1 [ρ1 (x)] ∼ e−T I[ρ1 (x)] .

(5)

The decay rate s1 (ν), entering Eq. (2), is given by the
minimum value of the rate functional I when minimized over all gas density profiles ρ1 (x) which satisfy
the occupation-fraction constraint
Z

l

dx ρ1 (x) = ν

(6)

−l

and the normalization constraint which ensures that the
entire gas is composed of exactly one particle:
Z ∞
dx ρ1 (x) = 1.
(7)
−∞

The optimal profile ρ1 (x) plays an important role in the
context of the conditioned process: the diffusion process,
conditioned on realizing the specified occupation fraction
ν. In the long time limit, ρ1 (x) is the position distribution of the particle conditioned on ν [25, 27, 46, 47]. We
will return to this property in Sec. IV.
What happens when there are many diffusing particles
on the line? It is natural to define the occupation fraction
of N identical particles as the one-particle occupation
fraction (1), averaged over all particles:
ν=

N
1 X
νi ,
N i=1

(8)

where ν1 , ν2 , . . . νN are the individual occupation fractions of the particles. This is also the time averaged
mass of particles inside the interval, normalized by their
total mass. One reason to choose this definition is its relation to diffusion-limited reactions, as explained in the
Introduction. Another reason has to do with experiment
as we shall discuss in Sec. VIII.
Let us first assume that the system is composed of
non-interacting Brownian particles. It is clear that the
expected occupation fraction ν̄ converges to 0 at long
times T , meaning that the interval is almost empty during most of the time T . The extreme case ν = 1 corresponds to the so called survival problem, where all the
particles are conditioned to stay inside the interval for the
entire time T . This case has already been considered for a
system of many non-interacting and interacting particles
[31, 33]. A natural next question concerns the complete
distribution of the occupation fraction, 0 ≤ ν ≤ 1. For
the non-interacting particles, this quantity can be obtained from the single-particle distribution, see Eq. (2),
recently derived in Ref. [26, 27]. The joint distribution
of the set of individual occupation fractions {νi } is the
product of the single-particle probabilities (2)
P({νi }) ∼ e−T

PN

i=1

s1 (νi )

.

(9)

3
The probability of an occupation fraction ν can be obtained by integrating (9) over the individual occupation
fraction sets {νi } in the hyperplane defined by the constraint (8). The integral can be evaluated using Laplace’s
method, and the resulting probability decays exponentially in time,
P(ν, N ) ∼ e−T s(ν,N ) ,

(10)

PN
with s given by the minimum of the sum i=1 s1 (νi ) under the constraint (8). Since s1 (νi ) is a convex function
[26, 27], this minimum is unique and it is given by equal
individual occupation fractions νi = ν for all i. Therefore
s(ν, N ) = N s1 (ν)

(11)

showing that the probability of a specified occupation
fraction (8) of a system of non-interacting particles comes
from equal contributions of all particles.
The main goal of this paper is to address the occupation statistics of interacting particles. In this case the
single-particle picture breaks down, and a different approach is required. Assuming that there are many particles in relevant regions of space, we employ a coarsegrained description given by fluctuating hydrodynamics
of diffusive lattice gases [48] and a corresponding large
deviation theory known as the Macroscopic Fluctuation
Theory (MFT) [35]. We determine the distribution of
the occupation fraction of the ensemble of particles and
show that the exponential-in-time decay of the probability (10) holds for a whole class of interacting particle
systems. However, due to the interactions, the decay rate
s depends on the total particle number N in a nontrivial
way. Further, we identify a class of interacting particles for which the decay rate s(ν, N ) is a non-analytic
function of ν. Such non-analyticities can be interpreted
as dynamical phase transitions. Our formalism is also
useful for non-interacting particles where it reproduces
Eq. (11) and recent results of Refs. [26, 27].

III.

MACROSCOPIC FLUCTUATION THEORY
OF OCCUPATION STATISTICS

The starting point for the MFT (see the review [35]
for details) is the fluctuating hydrodynamics: a coarsegrained, in space and in time, description of a system
composed of many diffusing particles in terms of the
fluctuating particle number density ρ(x, t), which obeys,
in one dimension, the conservative Langevin equation
[48, 49]:
∂t ρ = −∂x J,

p
J = −D(ρ)∂x ρ − σ(ρ)η (x, t) ,

(12)

where D(ρ) and σ(ρ) are the diffusivity and mobility of
the ensemble of particles, respectively, and η(x, t) is a
zero-mean Gaussian noise, delta-correlated in space and
time.

Equation (12) is a stochastic partial differential equation. It provides a coarse-grained description for various transport models [39, 50–53]. Here we will consider
diffusive lattice gases [48, 54]: a family of models of
particles hopping on a lattice. The simplest model of
this type is the non-interacting random walkers (RWs)
where each particle hops to neighboring sites with equal
rates. For this model D(ρ) = D0 and σ(ρ) = 2D0 ρ. The
coarse-grained behavior of the RWs coincides with that
of non-interacting Brownian particles [42]. Two interacting lattice gases, which we will focus on, are the simple
symmetric exclusion process (SSEP) and the Zero Range
Process (ZRP). For the SSEP, only hops to empty neighboring sites are allowed, and the transport coefficients
are D(ρ) = D0 and σ(ρ) = 2D0 ρ(1 − aρ) [48, 49]. We
will set the lattice constant a to unity, so that 0 ≤ ρ ≤ 1.
The SSEP mimics transport of hard particles in zeolites
and biological channels [55], water transport inside carbon nanotubes [56], various cellular processes [29, 57, 58],
and it has also been used to describe the transport of
noninteracting electrons in mesoscopic materials at zero
temperature [51]. The ZRP describes interacting particles without exclusion and with a vanishing interaction
range, as here the hopping rate w(ni ) depends only on
the current occupation ni of the departure site. The
ZRP also mimics different phenomena, such as shaken
granular materials and growing networks, see e.g. [59]
and references therein. For the ZRP the mobility is
given by σ(ρ) = 2w (ρ), and the diffusivity is given by
D(ρ) = dw (ρ) /dρ [48, 60]. Formally, the RWs can be
viewed as a particular case of the ZRP, where the hopping rate is proportional to the number of particles in the
departure site.
We will introduce the MFT formalism for a large but
finite number of particles
Z ∞
dxρ = N,
(13)
−∞

on the whole line, and later on modify it to account for
systems of finite size. The Langevin equation (12) defines
a path integral representation for the probability P of
observing a joint density and flux histories ρ(x, t), J(x, t),
constrained by the conservation law (12)
Z
Y
P = DρDJ
δ(∂t ρ + ∂x J) e−S ,
(14a)
x,t

Z
S [ρ, J] =

T

Z

0

2

∞

dt

dx
−∞

[J + D(ρ)∂x ρ]
.
2σ(ρ)

(14b)

The path integration measure DρDJ accounts for the
Jacobian of the transformation from η to ρ and J. We
do not discuss its explicit form, as its account would only
give a sub-leading contribution which is not captured by
the MFT.
The probability P(ν) of observing an occupation fraction ν is given by the path integral (14a) and (14b) evaluated over those histories which result in the specified

4
value of ν ∈ [0, 1]. The latter can be expressed in terms
of the particle number density ρ(x, t):
Z T Z l
1
dt
dxρ(x, t).
(15)
ν=
TN 0
−l
Employing the number of particles in the relevant regions
of space as a large parameter [61], the MFT performs a
saddle point evaluation of the path integral. The desired
probability is mostly contributed to by the optimal history of the system – the most probable density and flux
histories, leading to the specified value of ν. The minimum action S, evaluated over these, yields the probability P (ν, N ) up to a pre-exponential factor:
− ln P ' S ≡ min S [ρ(x, t), J(x, t)] .
ρ,J

(16)

If the averaging time T is much longer than the characteristic diffusion time through the interval of length 2l,
the optimal profiles of ρ(x, t) and J(x, t) become stationary. In the context of fluctuations of current in lattice
gases, driven by density reservoirs at the boundaries, this
simple property is known as the additivity principle [62].
The additivity principle was verified in the survival limit
ν = 1 [31]. Here we assume that it also holds for all
0 < ν < 1, and discuss the validity of this assumption in
Sec. VIII.
In an infinite system with zero current at infinity, like
our system, stationarity implies a zero stationary optimal
current J. This means that the fluctuational contribution to the optimal flux exactly counterbalances the deterministic contribution and maintains a stationary density profile. Setting J = 0 and ρ = ρ(x) in Eq. (14b), we
see that the action (16) is proportional to time, S = T s,
reproducing and generalizing Eq. (10). The action rate s
is obtained by minimizing the action rate functional
Z ∞
2
[D(ρ)∂x ρ]
s [ρ (x)] =
dx
(17)
2σ(ρ)
−∞
subject to the occupation fraction constraint
Z l
dxρ(x) = N ν,

(18)

−l

which follows from Eq. (15). An additional constraint
comes from mass conservation: the total number of particles on the line must be equal to the initial number N .
This means that the total number of particles, composing
the stationary density profile, cannot exceed the initial
number of particles N . One could hypothesize that, at a
given ν < 1, some of the excess particles can diffuse away
to infinity. As we will show, such a scenario is impossible for the lattice gas models considered here [63]. That
is, the optimal stationary density profile includes all N
particles, as described by Eq. (13).
Finally, the density profile ρ must be everywhere nonnegative:
ρ (x) ≥ 0.

(19)

As we will see in Sec. VII, this obvious constraint leads,
for a class of interacting lattice gas models, to a dynamical phase transition.
Upon rescaling the spatial coordinate x/l → x, the
occupation fraction constraint (18) becomes
Z

1

dxρ(x) = 2nν,

(20)

−1

where n = N/2l. The rescaled mass constraint (13) is
Z ∞
dxρ(x) = 2n.
(21)
−∞

Then Eq. (17) predicts the 1/l scaling of the action rate
with the interval length l:
s (ν, N ; l) =

1
s̃ (ν, n) .
l

(22)

The minimization problem for the functional (17), subject to the integral constraints (20) and (21), look simpler
in the new variable u(x) = f [ρ (x)], where [30, 31, 64]
Z ρ
D(z)
.
(23)
f (ρ) =
dz p
σ(z)
0
As D(z) and σ(z) are non-negative, f (ρ) monotonically
increases with ρ. As a result, the inverse function f −1 ,
which we denote by F (u), monotonically increases with
u in the relevant region of u. In terms of u(x), the action
rate (17) has the form of effective electrostatic energy
s [u (x)] =

1
2

Z

∞


dx

−∞

du
dx

2
,

(24)

which is universal for all interacting particle models, described by Eq. (12). The constraints (20) and (21) are
enforced via two Lagrange multipliers, which results in
the Euler-Lagrange equation

dF (u)

 −Λ21
,
|x| ≤ 1,
(25)
du
uxx =

 Λ2 dF (u) ,
|x| ≥ 1.
(26)
2
du
This choice of the signs of the interior and exterior Lagrangian multipliers turns out to be correct in all examples we will be dealing with. We must also demand
continuity of u and ux at x = 1. Finally, if there are multiple solutions, the one with the least action (24) must
be selected.
For some functions F (u), Eq. (26) can have a solution with compact support, 1 < |x| < x0 , where the
first derivative u0 (x) vanishes at the edges of support,
|x| = x0 , and the Lagrange multipliers Λ21 and Λ22 can
be chosen to obey the constraints (20) and (21). In this
case we simply set u = 0 at |x| > x0 , which costs a
zero action, see Eq. (24). The resulting optimal solution
u(x) obeys the tangent construction (the continuity of

5
the first derivatives) at |x| = x0 . It can be considered as
a solution of a one-sided variational problem [65], which
results from the non-negativity constraint u(x) ≥ 0, directly following from Eq. (19). As we will see below,
the presence of optimal solutions with compact support
gives rise to a dynamical phase transition in finite systems. It is important, therefore, to find out whether or
not, for a specified transport coefficients D(ρ) and σ(ρ),
the solution has compact support and obeys the tangent
construction. Equation (26) has the “energy” integral:
1
2
(ux ) − Λ22 F (u) = E,
2

|x| > 1.

(27)

As u and ux must vanish at infinity [68], so that the
total mass (21) is finite, the energy E must be set to
zero. Integrating Eq. (27) over x from x = 1 up to x0
where the solution vanishes, we arrive at
Z u1
1
dz
p
x0 = 1 + p 2
,
(28)
F (z)
2Λ2 0
where u1 = u(x = 1). Compact support, x0 < ∞, demands that the integral in Eq. (28) converge. The convergence is determined by the behavior of F (u) in the vicinity of u = 0 where F (u) vanishes, see Eq. (23). Suppose
that D(ρ → 0) ∼ ρα and σ(ρ → 0) ∼ ρβ . Then for small
u one has F (u) ∼ u2/(2α−β+2) , and the integral converges
at u → 0 if and only if 2α − β + 1 > 0. This condition
[which is stricter than the condition 2α − β + 2 > 0 that
guarantees the existence of the function F (u) at small u]
is violated for the RWs and the SSEP, where α = 0 and
β = 1. For these two models, therefore, compact support
of the optimal solution is impossible. For the ZRP, however, one has D(ρ) ∼ dσ(ρ)/dρ, so that α = β − 1. As
a result, the integral in Eq. (28) converges for any hopping rate which grows with ρ faster than linear (β > 1,
or equivalently α > 0). In this case the optimal profile
has compact support. Note that, as F (u = 0) = 0 and
E = 0, the first derivative ux vanishes together with u
at |x| = x0 [see Eq. (27)], so the tangent construction is
satisfied. Now we will consider the non-interacting RWs,
where the support of the optimal solution is infinite.
IV.

NON-INTERACTING RANDOM WALKERS

For the RWs, the MFT minimization problem, defined
by Eq. (17), (20) and (21), coincides with the minimization problem defined by the single-particle level 2 large
deviation formalism. This is because the empirical density functional I [ρ1 (x)] of the single-particle theory coincides with the action rate functional of the RWs, i.e. with
s [ρ(x)] given by Eq. (17), see also [45]. Furthermore,
the two constraints of the single-particle minimization,
Eqs. (6) and (7), can be viewed as the gas constraints
(20) and (21) applied to a gas composed of a single particle. This, together with the fact that, for the RWs, s is
proportional to N , immediately leads to Eq. (11). Importantly, this also implies that the optimal particle number

density ρ (x), conditioned on an occupation fraction ν,
and the single particle’s position distribution ρ1 (x), conditioned on the same ν, coincide up to factor N . This
property generalizes a similar relation which holds at the
level of the average behavior: The unconstrained average particle number density of the RWs coincides with
the unconstrained position density distribution of a single particle up to the factor N .
The single-particle occupation statistics have been recently addressed in [26, 27] within the DV formalism.
Before we turn to interacting particle systems, we will
re-derive the results of Refs. [26, 27] by using the MFT
formalism. For the RWs, Eq. (23) yields F (u) = u2 /2D0 ,
and Eqs. (25) and (26) turn into the Helmholtz equations
uxx

(
−λ21 u |x| < 1,
=
λ22 u
|x| > 1,

(29)

where λ2 = Λ2 /D0 . Remarkably, Eq. (29) coincides, up
to relabeling of parameters, with the eigenvalue problem for the tilted operator of the DV formalism for a
single particle [26, 27]. In particular, the field u(x) coincides with each of the left and right eigenfunctions of the
tilted operator. (The left and right eigenfunctions coincide in this case due to the hermiticity of the tilted operator.) Previously, equivalence was established between
the tilted-generator formalism and the level 2 formalism
[27, 47]. We thus conclude that for the RWs, the three
formalisms are mathematically equivalent. As Eq. (29)
is linear, the optimal profile (33) scales linearly with N ,
and so does the action, as it should, see Eq. (11).
Up to relabeling of parameters, Eq. (29) is the
Schrödinger equation for a finite square well potential,
whose solution can be found in textbooks, see e.g. Ref.
[66]. The optimal (least-action) profile u that we are after
corresponds to the ground state of the quantum problem.
This state is symmetric [66, 67], and we obtain
u
√
=
2nD0

(

A cos(λ1 x) |x| < 1,
B e−λ2 |x|
|x| > 1,

(30)

√
where we have introduced a dimensional factor 2nD0 ,
so that the constants A and B are dimensionless. What is
left is to determine A, B and the Lagrange multipliers λ1
and λ2 . The continuity of the solution and its derivative
at |x| = 1 yields
A cos (λ1 ) = Be−λ2 ,

Aλ1 sin (λ1 ) = Bλ2 e−λ2 .

(31)

The constraints (20) and (21) provide two more relations:
A

2




sin (2λ1 )
+ 1 = 2ν,
2λ1

Be−λ2

2

= 2λ2 (1−ν). (32)

The four algebraic equations (31) and (32) can be solved
in a parametric form. It is convenient to use a single
parameter 0 ≤ λ1 ≤ π/2 which corresponds to the whole

6

(a)

0.8
0.6
0.4
0.2

where
(34a)
(34b)

with λ1 (ν) implicitly determined by Eq. (37) below. An
example of the optimal profile is shown in Fig. 1a. Plugging Eq. (30) into Eq. (24) [or Eq. (33) into Eq. (17)],
and using Eq. (16), we obtain
D0 T N
g(ν)
(35)
2l2
where the function g(ν) is given in a parametric form:
− ln P(ν, N ) '

2λ31
,
cot λ1 + λ1
sin λ1 cos λ1 + λ1
.
ν(λ1 ) =
cot λ1 + λ1
g(λ1 ) =

-4

0
x

-2

2

4

FIG. 1. (a): The optimal profile ρ(x)/n (33) for independent RWs at ν = 0.8, which corresponds to λ1 = 0.875 . . .
as follows from Eq. (37). The two fat dots mark the interval
boundaries |x| = 1. (b): The rescaled action g(ν), defined
by (36) and (37), together with its asymptotics (38) at small
and large occupation fraction (the dashed and dotted lines,
respectively). The maximum value g(ν = 1) = π 2 /2 corresponding to the survival limit (3) is marked by the fat dot.
4

(36)
3

(37)

The latter asymptotic agrees with the corresponding result of Ref. [27].
Now we are in a position to justify our choice of mass
normalization (13). The final total number of particles,
conditioned on a specified ν, is set by the minimum of
the action (35) with respect to the total number of particles N . This corresponds to minimizing N g (m/N ) with
respect to N at fixed m. By virtue of the convexity of g,
the minimum is achieved for the maximal possible total
number of particles, which is equal to N .
SIMPLE SYMMETRIC EXCLUSION
PROCESS
General

The inter-particle interactions in the SSEP introduce
a nontrivial dependence of the occupation statistics on

close packing

2

1

0

survival

The graph of function g(ν), shown in Fig. 1b, agrees
with the graph presented, without an analytic formula,
in Refs. [26, 27]. The maximum value of the action (the minimum probability) is obtained in the survival case ν = 1, or λ1 = π/2. The maximum value
g(ν = 1) = π 2 /2 is in agreement with Eq. (3). By expanding Eq. (37) near λ1 = π/2, one can obtain the
asymptotic near the survival limit ν = 1. The opposite asymptotic of small ν can be obtained by expanding
around λ1 = 0. These lead to the explicit expressions
( 2
ν
ν  1,
g(ν) ' π22
(38)
1/3
3π 4/3
(1
−
ν)
0 < 1 − ν  1.
−
2
21/3

A.

0.0

n

2λ1
,
cot λ1 + λ1
2λ1 cos2 λ1 e2λ1 tan λ1
B 2 (λ1 ) =
,
cot λ1 + λ1
A2 (λ1 ) =

V.

1.0

ρ(x)/n

occupation fraction range, 0 ≤ ν ≤ 1 [69]. The optimal profile ρ(x) = u2 (x)/2D0 for a given value ν can be
expressed in terms of the parameter λ1 :
(
ρ(x)
A2 (λ1 ) cos2 (λ1 x)
|x| < 1,
=
(33)
n
B 2 (λ1 ) e−2|x|λ1 tan λ1 |x| > 1,

dilute limit
0.0

0.2

0.4

0.6
ν

0.8

1.0

1.2

FIG. 2. The parameter plane of the occupation statistics of
the SSEP is bound by the close-packing hyperbola νn = 1,
the particle survival line ν = 1 and the axes ν and n. The
circle marks the particle survival at the close packing point
(ν = 1, n = 1).

the total number of particles. To begin with, the particle
exclusion defines the boundaries of the parameter plane
(ν, n), see Fig. 2. The number of particles, that can
occupy the interval |x| < 1, is bounded from above, as
the particle density cannot exceed the close packing value
ρ = 1. This yields the inequality νn ≤ 1. We can still
consider an arbitrary total number of particles in the
system, assuming that not all of them were necessarily
released inside the interval |x| < 1. Finally, in the lowdensity limit νn → 0 the inter-particle interactions are
negligible, and we should expect to reproduce our results
for the RWs, Eqs. (33) and (37).

√
For the SSEP, Eq. (23) yields F (u) = sin2 u/ 2D0 .
p
Then, upon rescaling U = 2/D0 u and λ2 = Λ2 /D0 ,
Eqs. (25) and (26) turn into the stationary sine-Gordon

7
correspond to the whole range 0 ≤ ν ≤ 1 and n > 0. The
optimal profile (40) is given by

equations [31]
−λ21 sin U
λ22 sin U

|x| < 1,
|x| > 1.

(39)

Once U (x) is determined, one can find


U (x)
.
ρ(x) = F [u(x)] = sin2
2

(40)

Equations (39) are nonlinear, and the convenient
Schrödinger analogy is lost. Still, it is not difficult to
solve them. The symmetric solution of (39), vanishing as
|x| → ∞ reads
(
2 arcsin {k sn [λ1 x + K(k), k]} |x| < 1,

U=
(41)
4 arctan e−λ2 |x|+A
|x| > 1,

(
k 2 sn2 [λ1 x + K(k), k] |x| < 1,
ρ(x) =
cosh−2 (λ2 |x| − A)
|x| > 1,

(46)

together with Eq. (42) and (43), where the relations
k(ν, n) and λ1 (ν, n) are given implicitly by Eqs. (45). An
example of the optimal profile for ν = 0.9 and n = 1.1 is
shown in Fig. 3a.
1.5

8

(b)

(a)
6

1.0
g/n

Uxx =

ρ(x)

(

4

0.5

where sn(. . . ) is the Jacobi elliptic function [70], and
K(. . . ) is the complete elliptic integral of the first kind
[71]. As for the RWs, we have to determine the integration constants, k and A and the Lagrange multipliers λ1
and λ2 . Imposing the continuity of U 0 (x) at |x| = 1, we
can express λ2 through λ1 and k:
λ2 = λ1

p

1 − k2

sn (λ1 , k)
.
cn (λ1 , k)

(42)

Using this relation and the continuity U (x) at |x| = 1 we
express A in terms of λ1 and k:
p
sn (λ1 , k)
A = λ1 1 − k 2
cn (λ1 , k)
1 + dn [λ1 + K(k), k]
− ln
,
(43)
k sn [λ1 + K(k), k]
where cn(. . . ) and dn(. . . ) in Eqs.(42) and (43) are Jacobi
elliptic functions [70]. The constants λ1 and k can be
determined by using Eqs. (20) and (21). It is convenient
to define two auxiliary expressions which involve λ1 and
k:
q1 = 1 −

E [am (λ1 , k) , k] −

0.0
-3 -2 -1

0
x

1

2

3

0
0.0

0.2

0.4

0.6

0.8

1.0

ν

FIG. 3. (a): The stationary optimal profile ρ(x) from Eq. (46)
for ν = 0.82 and n = 1.2 (solid line). For comparison, also
shown in dashed line is the profile (33) for the RWs with
the same parameter values. The circles mark the boundaries
between the interior |x| < 1 and the exterior |x| > 1 parts of
these solutions. For these parameters the maximum density of
the SSEP is close (but still lower) than the close-packing value
ρ = 1. (b): The function g(ν, n)/n, see Eq. (48), computed
along the curve n = 1.2 (solid line). The fat dot marks the
close packing value (54) g(ν = 1/n, n)/n = 8.33 . . . . For
comparison, the dashed line depicts the RWs result g(ν), see
Eq. (36).

Inserting Eq. (41) into Eq. (24) and using Eq. (16), we
obtain after some algebra [72]:
− ln P(ν, N, T ) '

D0 T
g (n, ν) ,
l

(47)

2

k cn(λ1 ,k) sn(λ1 ,k)
dn(λ1 ,k)

λ1
1 − dn [λ1 + K(k), k] cn (λ1 , k)
√
q2 =
,
sn (λ1 , k)
λ1 1 − k 2

,

(44a)

where the function g is given in a double parametric form:

(44b)




g (n, ν) = 2 λ21 k 2 − q1 + λ22 q2 ,

where E(. . . , . . . ) is the incomplete elliptic integral of the
second kind and am(. . . , . . . ) is the Jacoby amplitude
[70, 71]. In terms of q1 and q2 , the constraints (20) and
(21) read:
n = q1 + q2

2

and ν =

q1
.
q1 + q2

(45)

As for the RWs, one cannot express λ1 and k through ν
and n in an explicit form. Moreover, even a parametric
solution here demands two, rather than one, parameters.
These two parameters, 0 ≤ k ≤ 1 and 0 ≤ λ1 ≤ K(k),

(48)

together with Eqs. (42), (44a) and (44b) [where, again,
the functions k(ν, n) and λ1 (ν, n) are given implicitly by
Eq. (45)]. As an example, Fig. 3 shows the rescaled action g(n, ν))/n versus ν at n = 1.2. For any ν and n,
the action (47) for the SSEP is larger than that for the
RWs (35). This is to be expected in view of the mutual
exclusion of the SSEP particles. As one can check [by examining the action (47) in the same way as it was done
in the end of Sec. IV for the RW], the normalization
condition (13) holds for the SSEP.
Now we consider three different asymptotic behaviors
of the action (48).

8
B.

D.

Survival, ν = 1

The survival limit ν = 1 was previously solved in Ref.
[31]. Here ρ(x) must vanish at |x| ≥ 1. This demand sets
λ1 = K (k) [31]. Plugging this λ1 into Eqs. (42) and (43),
we find that λ2 → ∞ and A → ∞ and obtain
(
k 2 sn2 [K(k) (x + 1) , k] |x| < 1,
ρ(x) =
(49)
0
|x| > 1.

In the dilute limit, νn  1, the exclusion effects of
the SSEP are negligible, and one expects to arrive at
Eqs. (33)-(37) for the independent RWs. This is indeed
what happens (see Appendix A) when we take the limit
k → 0 in Eqs. (46) and (48). In particular, the rescaled
action g becomes
gSSEP (ν, n) ' ngRWs (ν) .

Plugging λ1 = K (k) into Eqs. (45) we see that ν = 1 and
n=1−

E (k)
,
K (k)

(50)

where E(. . . ) is the complete elliptic integral of the second kind [71]. Using Eq. (50) in Eq. (48), we obtain the
action parametrized by a single parameter:


E (k)
g (ν = 1, n) = 2K2 (k)
+ k2 − 1 ,
(51)
K (k)
where the function k (n) is given by Eq. (50). The action
diverges at the special point (ν = 1, n = 1) of the parameter plane corresponds to survival at close packing, see
Fig. 2. When approaching this point along the survival
line ν = 1, the asymptotic of the action can be obtained
from Eq. (51) by expanding (50) near k = 1. This leads
to
2
.
(52)
g (ν = 1, n → 1) '
1−n
The results of this subsection agree with results of [31].
C.

Close packing, νn = 1

Here the interval |x| < 1 is occupied to its maximum
capacity, and we have n ≥ 1. Survival at close packing
point, where the MFT action diverges, can be reached
along the close packing hyperbola νn = 1 by taking the
limit n → 1. When n > 1, that is whenever there are additional particles outside the interval, the action is finite.
This regime is described by the limit of k → 1 of the
general expressions of subsection V A. It is more convenient, however, to directly solve Eq. (39) for |x| > 1 and
match the solution to the close-packed solution ρ = 1 for
|x| < 1. Then, using the mass constraint (21), we obtain
a simple expression for the optimal density profile:
(
1
h
i |x| < 1,
ρ(x) =
(53)
−2 2(|x|−1)
cosh
|x| > 1.
n−1
Plugging it in Eq. (17) and using the relation S = sT ,
we arrive at Eq. (47) with the rescaled action


1
2
g ν = ,n =
.
(54)
n
n−1
This action vanishes in the limit n → ∞, as here the
entire infinite line is closely packed, and so is the interval,
with probability 1.

Dilute limit, νn  1

VI.

(55)

ZERO RANGE PROCESS

As we showed in Sec. III, for the ZRP model the stationary optimal density profile, conditioned on a given
occupation fraction, has compact support when the hopping rate grows faster than linearly with ρ. For a powerlaw hopping rate the transport coefficients are
D(ρ) = Γρα ,

σ(ρ) =

2Γρα+1
,
α+1

(56)

where Γ = const. Here the only dimensional parameters of the problem are T , n, l and D(n). As we showed
in Sec.III, the action must be proportional to T and inversely proportional to l (22). A simple dimensional analysis immediately yields the scaling
− ln P(ν, N ) '

D (n) nT
ΓN α+1 T
g(ν) = α+1 α+2 g(ν), (57)
l
2
l

and we only need to determine the rescaled action g(ν).
(Notice that α = 0 corresponds to the RWs, where the
action is proportional to N , and the density profile does
not have compact support.) Dimensional analysis also
implies that the optimal profile must be proportional to
the density n.
Let us focus on the case α = 1, where the algebra is
especially simple. Here the change of variables (23) is an
identity, so we might as well solve for ρ(x). Furthermore,
Eqs. (25) and (26) simplify to
(
−2Λ21 |x| < 1,
(58)
ρxx =
2Λ22
1 < |x| < x0 ,
where ±x0 describe the edges of the compact support, see
Sec. III. Equations (58) are strikingly simple, and their
symmetric solution is

ρmax − λ21 x2
|x| < 1,
ρ(x)  2
= λ2 (|x| − x0 )2 1 < |x| < x0 ,
(59)

n
0
|x| > x0 ,
where λ = Λ/n. The continuity of ρ and ρx at |x| = 1
leads to
2

ρmax − λ21 = λ22 (1 − x0 ) ,
−λ21 = λ22 (1 − x0 ) ,

(60)
(61)

9
whereas Eqs. (20) and (21) yield


λ21
= ν,
(62)
2 ρmax −
3
2 2
3
λ (x0 − 1) = 1 − ν.
(63)
3 2
Solving Eqs. (60)–(63) we obtain
i
p
3h
λ21 (ν) =
9 − 5ν − 3 (9 − ν) (1 − ν) ,
8 "
#
r
3
9−ν
2
λ2 (ν) =
(9 − 7ν)
+ 9ν − 27 ,
16
1−ν
(64)

p
3
3 + ν − (9 − ν) (1 − ν) ,
ρmax (ν) =
8
p
3 − ν + (9 − ν) (1 − ν)
x0 (ν) =
.
2ν
The resulting profile of ρ(x)/n is shown in Fig. 4. Inserting ρ(x) given by (59) and (64) into Eq. (17), we
finally obtain
ΓN 2 T
g(ν),
(65a)
− ln P(ν, N ) '
4l3
h
i
√
3
3/2
g(ν) =
27 − 18ν − ν 2 − 1 − ν (9 − ν)
. (65b)
4
This function g(ν) is shown in Fig. 4. As to be expected,
g(ν = 0) = 0. The maximum value g(ν = 1) = 6 corresponds to survival of all the particles. It is in agreement
with Ref. [31], which derived an implicit expression for
the survival probability of a diffusive gas with arbitrary
D(ρ) and σ(ρ).
0.8

(a)

ρ/n

0.6

VII.

OCCUPATION STATISTICS ON A RING

Now suppose that N particles are released on a ring of
length 2L. We set |x| < L and study the time-averaged
occupation (15) of a subinterval |x| < l < L. At long
times the expected particle number density, governed by
a deterministic diffusion equation, approaches the constant value N/(2L). Thus the average occupation of the
subinterval is ν̄ = l/L = 1/L, where the rescaled ring
length L = L/l > 1 is an additional dimensionless parameter of the problem. Fluctuations can lead to overpopulation, ν̄ ≤ ν ≤ 1, or underpopulation, 0 ≤ ν ≤ ν̄.
The distribution of ν can be obtained by using the stationary MFT formalism of Sec. III with slight modifications. Now Eqs. (25) and (26) are to be solved on the
interval [−L, L] with periodic boundary conditions. Due
to the symmetry of our coordinate system, the derivative
u0 (x) must vanish at |x| = L. In addition, the integrals
in Eq. (21) and (24) should be from [−L, L]. Doing the
same rescaling as the one leading to (22), we obtain
s (ν, N, L; l) =

1
s̃ (ν, n, L) .
l

(66)

Since ν is the fraction of the particles occupying the interval of length 2l, the complementary 1 − ν fraction of the
particles occupies the complementary interval of length
2 (L − l). Hence the action satisfies a duality relation
s (ν, N, L; l) = s (1 − ν, N, L; L − l) .

(67)

The same argument leads to a duality relation for the
optimal density profile:


L−x
n
L
, 1 − ν,
,
. (68)
ρ (x, ν, n, L) = ρ
L−1
L−1 L−1
Because of the duality it suffices to solve the problem
only for overpopulation fluctuations with parameters

0.4

(1/L ≤ ν ≤ 1, n, L) .
0.2
0.0

-4 -x0-2

0
x

2 x0

4

FIG. 4. (a): The stationary optimal profile ρ(x) for the ZRP,
given by Eqs. (59) and (64) for ν = 0.7. The two fat dots
mark the interval boundaries |x| = 1. The edges of compact
support are at |x| = x0 (ν = 0.7) = 2.76998 . . . . (b): The
rescaled action g(ν), Eq. (65b). The survival limit ν = 1 is
marked by the fat dot.

A solution with compact support, like the one described by (59), is also a solution for a finite system,
as long as the former fits into the latter. If it does not,
the solution must adapt to the boundary conditions and
change. As we will show shortly, this leads to a dynamical
phase transition. But let us start with a brief discussion
of general aspects of the occupation statistics in finite
systems.

The solution for underpopulation fluctuations is then obtained from the overpopulation solution with the parameters (1/L0 ≤ ν, n0 , L0 ) for L0 = L/ (L − 1), and n0 =
n/ (L − 1) by using Eqs. (67) and (68). In the survival
limit ν = 1 the particles do not leave the subinterval, and
the solution coincides with that on the infinite line. Here
the duality gives the solution for the void limit, ν = 0.
Now let us consider the ZRP where the interparticle
interactions lead to a phase transition. For completeness,
we consider in Appendix B the non-interacting RWs on
a ring, where no phase transition occurs.
A.

ZRP on a ring: a dynamical phase transition

For the lattice gases, which admit stationary optimal
solutions with compact support, not only the survival
limit ν = 1, but a whole range of overpopulation fluctuations ν̄ ≤ νc ≤ ν (with a critical value νc we will soon

10

νc1 (L) =

3L − 1
.
L (L + 1)

(69)

When the occupation fraction is at the critical value ν =
νc1 (L) [or for a ring size at the critical value L = Lc (ν)],
the solution (59) vanishes at the ring’s boundary. Upon a
further decrease of the occupation fraction (alternatively
for a further decrease in the ring size), the solution with
compact support of Eq. (58) crosses over to a solution,
the support of which is the whole ring. This solution has
a positive minimal value ρmin at the boundary |x| = L:
(
ρ(x)
ρmax − λ21 x2
|x| < 1,
=
(70)
2
2
n
λ2 (|x| − L) + ρmin 1 < |x| < L.
The constants ρmax , ρmin , λ1 and λ2 are determined from
the continuity of ρ and ρx at |x| = 1 and the constraints
(20) and (21), and we obtain [73]:


1
3
2
2
ν−
,
λ1 = (L − 1) λ2 =
2 (L − 1)
L
2L − 1
ρmax =
(ν − νc2 ) ,
(71)
2 (L − 1)
L+1
(νc1 − ν) ,
ρmin =
2 (L − 1)
where we have denoted
νc2 (L) =

1
≤ ν̄.
L (2L − 1)

(72)

At ν = νc1 (L) we obtain ρmin = 0, and the extended
solution (70) coincides with the solution (59) with compact support. The duality relation (68) helps us obtain
the solution in the case of underpopulation, 0 ≤ ν ≤ ν̄.
Indeed, the extended solution (72) holds down to the critical occupation fraction ν = ν2 (L). At 0 ≤ ν ≤ νc2 (L)
the solution crosses over to a compact underpopulation
solution, which is dual to the one given by (59); the latter now fits into the ring). These solutions are shown
in Fig. 5 for overpopulation (a) and underpopulation (b)
fluctuations.
The transitions between the two types of solutions result in a non-analyticity of the action at νc1 and νc2 .
For ν̄ ≤ ν ≤ νc1 the action, evaluated over the extended
solution (70), yields a Gaussian distribution:
− ln P(ν, N, L) '

3ΓT N 2 L

2

2

2l2 (L − l)

(ν − ν̄) .

(73)

1.2

0.8

(a)

1.0

(b)

0.6
ρ/n

0.8
ρ/n

determine) is described by the infinite-system solution.
For simplicity, we again consider the ZRP with α = 1.
Here the solution (59) with compact support also applies
for a finite ring as long as the ring size L is larger than
the size of support x0 (ν) (64). This condition defines
a critical ring size, Lc (ν) = x0 (ν). By inverting the
relation (64) we see that, for a given ring size L, the Lindependent solution (59) with compact support solves
the ring problem when ν is equal to or larger than the
critical value ν̄ < νc1 < 1, which is given by

0.6

0.4

0.4
0.2

0.2
0.0
-2 -x0-1

0
x

1 x0

0.0

2

-1 -x 0 0 x 0 1
x

-2

2

FIG. 5. The stationary optimal profile ρ(x) for the ZRP on
a ring of the rescaled size L = 2.5 for the overpopulation
fluctuations (a) and underpopulation fluctuations (b), see the
main text for details. The solid lines describe the solutions
with compact support for ν = 0.95 > νc1 = 0.74 . . . (a) and
ν = 0.035 < νc2 = 0.1 (b). The boundaries of compact support are at x0 = 1.41 . . . (a) and x̃0 = 0.50 . . . (b). The dotted
line corresponds to the extended solution (70), obtained for
ν = 0.6 < νc1 (a) and ν = 0.2 > νc2 (b). The two fat dots
mark the boundaries between the interior, |x| < 1, and the
exterior, |x| > 1, regions of these solutions.

This result, alongside with Eq. (65a), yields the action
in the overpopulation region ν̄ ≤ ν ≤ 1. The underpopulation region 0 ≤ ν ≤ ν̄ is obtained from the duality
relation (67). Specializing it to the ZRP scaling
− ln P(ν, N, L) '

ΓT N 2 ring
g
(ν, L) ,
4l3

(74)

we see that g ring (ν, L) obeys the duality relation
g ring (ν, L) =

L
g ring (1 − ν, L−1
)

(L − 1)

and we obtain g ring over the entire
 line
(ν) ,

g



 6L (ν − ν̄)2

2 ,
g ring (ν, L) =
(L − 1)




g line (1 − ν)



3 ,
(L − 1)

3

(75)

parameter range:
νc1 ≤ ν ≤ 1,

(76)

νc2 ≤ ν ≤ νc1 ,

(77)

0 ≤ ν ≤ νc2 ,

(78)

where g line is the corresponding function for the infinite
line, Eq. (65b).
Figure 6 shows g ring (ν, L) as a function of ν for a
fixed L = 2.5 (a) and as function of L for a fixed
ν = 0.9. The latter dependence is non-monotonic. For
L > Lc1 (ν = 0.9) = 1.66 . . . the solution with compact support fits into the ring, and g is independent
of the ring size L. The corresponding critical ring size
L < Lc2 (ν = 0.9) = 1.03 . . . is obtained from the duality relation (67). Below Lc2 an underpopulation solution with compact support fits into the ring. In this
region of parameters the action depends on L, because
the size of the populated region depends on L. The

11

FIG. 6. The action g ring (ν, L) for the ZRP on a ring, described
by Eqs. (76)-(78). (a): g ring (ν, L = 2.5) as a function of the
occupation fraction ν for a ring of fixed size L = 2.5. (b):
g ring (ν = 0.9, L) as a function of the L for a fixed ν = 0.9. The
fat dots mark the points of the second-order phase transition
at νc1 = 0.74 . . . and νc2 = 0.1 (a), and Lc1 = 1.66 . . . and
Lc2 = 1.03 . . . (b).

[74]. Indeed, the origin of the second-order phase transition in the ZRP is the non-negativity constraint (19),
rather than a symmetry breaking of the optimal profile.
In the absence of the non-negativity constraint, the minimization problem always has a unique solution, given by
Eq. (70). Within the interval νc2 ≤ ν ≤ νc1 , where it
does not violate Eq. (19), this solution is also the solution to the constrained problem. Outside of this interval
of ν, this solution is forbidden, as it enters the forbidden zone of ρ < 0; the minimization procedure must
incorporate the non-negativity constraint, via a tangent
construction, leading to the solution (59) with compact
support. The transition between the unconstrained minimizing solution (70) and the one-sided solution (59) lies
at the origin of the second-order phase transition.
A similar dynamical phase transition should appear in
all diffusive lattice gas models, whose stationary optimal
solution on the infinite line has a compact support. In
particular, this property is shared by all ZRP models, see
Sec. III, with α > 0.

VIII.

FIG. 7. The minimum density ρmin as a function of the occupation fraction ν for overpopulation fluctuations ν̄ ≤ ν ≤ 1 in
a ring of size L = 2.5 (solid line). Note the sharp transition
at νc1 = 0.74 . . . . For comparison, the dashed line shows the
same quantity for the RWs (see Appendix B), where there is
no phase transition.

action diverges when L approaches the minimal size,
−3
g(ν, L → 1) ∼ (L − 1)
[see Eq. (78)], as the system
attempts to accommodate a finite number of particles
inside a segment of a vanishing length. Finally, for an
intermediate value L = 1/ν = 10/9, the action vanishes,
because in this case the occupation fraction ν = 0.9 is
achieved when the density profile is flat (and deterministic).
The transitions between the Gaussian region of the action (77) and the non-Gaussian parts (76) and (78) are
accompanied by discontinuities of the second derivative
of the action. Such discontinuities are called dynamical
phase transition. A natural choice for an order parameter to characterize this dynamical phase transition is the
minimum density value ρmin , which decreases linearly below the critical point νc1 and vanishes at and above the
critical point (Fig. 7). This behavior is in a stark contrast to the square-root behavior of the order parameter
in the usual Landau-type second order phase transition

SUMMARY AND DISCUSSION

Inter-particle interactions can strongly affect the longtime occupation statistics of an ensemble of diffusing particles. Here we employed the macroscopic fluctuation
theory (MFT) to uncover some of these effects. As we
have seen, the MFT is also very useful in the absence
of interactions, as it provides an insightful information
about the most likely history of the particle system, conditioned on a specified occupation fraction.
The occupation statistics of interacting particles depends in a non-trivial way on the total number of particles. A more surprising effect is the second-order dynamical phase transition, where the rate function s(ν, N ) (10)
is non-analytic with respect to the occupation fraction
ν. This transition appears, in finite systems, in a whole
class of interacting particle models for which the optimal
stationary density profile ρ(x) has compact support. A
simple example of such models is the zero range process
where the hopping rate to the neighboring sites increases
faster than linearly with the number of particles on the
departure site.
A dynamical phase transition of a very different nature
was recently uncovered for the occupation statistics of a
single Brownian particle, driven by external force [26, 27],
see also earlier work [75, 76]. The dynamical phase transition, that we found here, appears for an equilibrium
system without any external driving, and it is a consequence of interactions between the particles. It would be
interesting to find out whether different types of interactions, encoded in the density dependence of the system’s
diffusivity and mobility, bring about additional types of
singularities of the rate function [see e.g. the footnote
preceding Eq. (13)].
Our findings strongly rely on the stationarity assumption, that is, on the additivity principle, see Sec. III.

12
For non-interacting RWs, the additivity principle can be
verified both via the MFT approach (by solving the full
time-dependent MFT problem), and via the exact singleparticle approach. For the SSEP, the additivity principle
was established only in the survival limit ν = 1 [31]. If
for some D(ρ) and σ(ρ) the additivity principle breaks
down at a critical value of ν, one will observe a yet another type of dynamical phase transition [36–40]. This is
a very interesting direction to explore.
Our MFT formalism for the occupation statistics can
be extended to higher dimensions and to more complicated geometries. The limiting case of the survival,
ν = 1, in higher dimensions has already been studied
with the MFT [30, 31], where the long-time statistics
come from the additivity principle. Assuming that the
additivity principle holds for the entire range of occupation fraction 0 ≤ ν ≤ 1, we can immediately predict the
exponential law (10) in higher dimensions as well.
It would be very interesting to measure the occupation
statistics of ensembles of particles in experiment. One
possible method is fluorescence correlation spectroscopy
(FCS) [77]. In the basic FCS setup, a laser beam is focused into an observation region inside a suspension containing fluorescent Brownian particles. The particles are
at the focal volume fluoresce, and the emitted light is
registered. The emitted light power fluctuates due to
fluctuations in the instantaneous number of fluorescent
particles in the observation region, so the statistics of
the total emitted light over the entire measurement time
should be described by the occupation fraction statistics.
For sufficiently high densities of the fluorescent particles,
inter-particle interactions should lead to deviations from
the statistics (11) based on the single-particle calculations.
Finally, this work has established an explicit mathematical equivalence between the stationary MFT formalism for non-interacting particles and two large deviation theories: the level 2 formalism and the DonskerVaradhan formalism. In particular, this equivalence provides a simple relation between the optimal particle number density in the MFT formalism and the single-particle
probability distribution of the conditioned process, as
discussed in Sec. IV. To our knowledge, this equivalence
has not yet been addressed in detail. It would be interesting to understand it better, and find out whether it
can be extended beyond the long-time limit, or for other
large-deviation problems which do not necessarily involve
empirical measures.

ACKNOWLEDGMENTS

We thank Sidney Redner, Naftali Smith and Hugo
Touchette for useful discussions. TA and BM acknowledge support from the Israel Science Foundation (Grant
No. 807/16).

Appendix A: Dilute limit of the SSEP

In the limit k → 0 we can replace sn(..., k) → sin(...),
cn(..., k) → cos(...), and dn(..., k) → 1. Using these
asymptotics in Eqs. (42)–(45), we obtain, after some algebra, the following leading-order expressions at k  1:
λ2 ' λ1 tan λ1 ,

(A1)


A ' λ1 tan λ1 − ln

2
k cos λ1


,

cot λ1 + λ1
,
2λ1
sin λ1 cos λ1 + λ1
ν'
.
cot λ1 + λ1

n ' k2

The optimal profile (46) can be approximated as
(
k 2 cos2 (λ1 x)
|x| < 1,
ρ(x) =
2
2
2λ2 (1−|x|)
k cos λ1 × e
|x| > 1.

(A2)
(A3)
(A4)

(A5)

This optimal profile together with Eqs. (A1)–(A4) exactly reproduce our results (33)–(37) for the RWs. Finally, the action (48) in this limit becomes
g(ν, n) ' λ21 k 2 .

(A6)

This result, together with Eqs. (A3) and (A4), reproduces
Eqs. (36) and (37) leading to Eq. (55).
Appendix B: RWs on a ring
1.

General

We start by considering overpopulation fluctuations,
ν̄ ≤ ν, and solve the minimization problem (29) on the
ring. A symmetric periodic solution can be written as
(√
νA cos(λ1 x)
|x| < 1,
u
√
(B1)
= q 1−ν
1 < |x| < l,
2 nD0
L−1 B cosh X
where we have shortly written
X=

λ2 (L − |x|)
L−1

(B2)

and rescaled the Lagrange multiplier λ2 → (L − 1) λ2 .
Imposing the constraints (20) and (21), we can express
A and B in terms of λ1 and λ2 :


2 sin (2λ1 )
A
+ 1 = 1,
(B3)
2λ1


sinh (2λ2 )
B2
+ 1 = 1.
(B4)
2λ2
Imposing the matching conditions at |x| = 1 we obtain
s
A cos λ1
1−ν
=
,
(B5)
B cosh λ2
(L − 1)ν
λ1 tan λ1
1
=
.
λ2 tanh λ2
L−1

(B6)

13
The solution can be obtained in a double parametric
form, where the parameters 0 ≤ λ1 ≤ π/2 and λ2 ≥ 0
corresponds to 0 ≤ ν ≤ 1 and L ≥ 1. The optimal profile
ρ(x) = u2 (x)/2D0 reads
(
ρ (x)
a(λ1 , λ2 ) cos2 (λ1 x) |x| < 1,
=
(B7)
n
b(λ1 , λ2 ) cosh2 X
1 < |x| ≤ L,
where

The case of infinite ring can be obtained by taking
the λ2 → ∞ limit. In the leading order, the hyperbolic
cosine in Eq. (B7) turns into the exponent, and the optimal profile (B7) coincides with that for the infinite line
(33). Taking the λ2 → ∞ limit in (B10)–(B12), we obtain L(λ1 , λ2 → ∞) = ∞ and reproduce the infinite-line
results (36) and (37).

2.

2νλ1
a(λ1 , λ2 ) =
,
sin λ1 cos λ1 + λ1
2(1 − ν)λ2
b(λ1 , λ2 ) =
,
(L − 1) (sinh λ2 cosh λ2 + λ2 )

(B8)

and the parameters λ1 (ν, l) and λ2 (ν, l) are given implicitly by Eqs. (B11) and (B12). An example of the resulting
density profile is shown in Fig. 8.
Inserting (B7) into (17) yields the action (16):
D0 T N
− ln P(ν, N, L) '
g(ν, L),
2l2

(B9)

where g (ν, L) is given in a double parametric form by
2 (1 − ν) λ21 tan2 λ1
,
(B10)
tanh2 λ2
λ2 tanh λ2
L=1+
,
(B11)
λ1 tan λ1


−1
cos3 λ1 sinh λ2 (sinh 2λ2 + 2λ2 )
.(B12)
ν = 1+
cosh3 λ2 sin λ1 (sin 2λ1 + 2λ1 )
g(ν, L) = 2λ21 ν −

The underpopulation fluctuations follow from these expressions by employing the duality relations (67) and
(68). Figure 8 depicts the rescaled action g as a function of ν at L = 2.5. We now discuss several limiting
cases.
0.8

(a)

Gaussian fluctuations, ν − ν̄  ν̄

This limit corresponds to small deviations of the optimal profile (B7) from the flat equilibrium profile ρ̄ =
N/2L. Here λ1  1 and λ2  1. Linearizing Eq. (B11)
and (B12) with respect to λ1 and λ2 , we obtain:
δ'

2 2
λ ,
3 2


L'1+

λ2
λ1

2
,

(B13)

where δ ≡ νL−1 = ν/ν̄ −1  1. Solving these equations,
we obtain λ1 and λ2 in the leading order in δ  1:
λ21 '

3δ
,
2 (L − 1)

λ22 '

3
δ,
2

(B14)

which upon insertion in (B10) gives a quadratic approximation for the action, see Eq. (B18) below. This expression suffices for the evaluation of the variance of the
occupation fraction fluctuations [78], see Eq. (B21) below. The same result for the variance follows if one uses
(11) and the single-particle variance obtained in [20] for
a single particle on a segment with reflecting boundary
conditions. The close relation between the two settings is
obvious within the MFT formalism. Indeed, the optimal
density profile in the ring problem has zero derivatives at
x = 0 and x = L. As a result, the right half of our periodic solution is also the solution for the system studied
in Ref. [20]. The action evaluated for the latter system
is equal to one half of the action for the ring. The action
per particle, however, is the same for both systems.

ρ/n

0.6
0.4

3.

Close to survival, ν → 1

0.2
0.0

-2

-1

0
x

1

2

FIG. 8. (a): The stationary optimal profile ρ(x) for the RWs
inside a ring of length L = 2.5, given by Eqs. (B7) and (B8)
for ν = 0.7. The two fat dots mark the boundary between
the interior |x| < 1 and the exterior |x| > 1 regions. (b): The
rescaled action g(ν, L = 2.5), Eq. (B10). The extreme limits
of survival, g(ν = 1, L = 2.5) = π 2 /2, and void, g(ν = 0, L =
2.5) = π 2 /2 (L − 1)2 , are marked by fat dots. The dashed
line is the Gaussian asymptotic (B18), and the dotted lines
are the asymptotics of survival (B19) and void (B20).

The survival limit ν = 1 coincides with that of the
infinite system and corresponds to λ1 = π/2. The closeto-survival asymptotic of the rescaled action g is obtained
by expanding Eqs. (B10)–(B12) near λ1 = π/2. Writing
 = π2 − λ1 and keeping the leading terms in  we obtain


π2
2λ2
g'
− π 3 +
,
(B15)
2
sinh 2λ2
2
λ2 tanh λ2 ,
(B16)
L'1+
π


23
λ2
1−ν '
tanh λ2
+ tanh λ2 . (B17)
π
cosh2 λ2

14
Equations (B16) and (B17) show that λ2 diverges in this
1/3
limit as λ2 ∼ (L − 1) / (1 − ν) . Inserting this asymptotic into (B7) we see that the optimal density profile decays exponentially outside of the interval |x| < 1 over a
1/3
length scale proportional to (1 − ν) . For not too small
L, this decay length is much smaller than the length of
1/3
the complementary interval, (1 − ν)
 L − 1. Thus
3
when 1 − ν  (L − 1) , the optimal profile is exponentially localized, and we can expect that the sub-leading
expression for the action in this limit is independent of
the ring size. Indeed, using the above expression for λ2
and Eq. (B17) in Eq. (B15) we obtain the asymptotic
(B19) which coincides with the corresponding asymptotic
for the infinite line. Using the duality relation (68), we
obtain the void asymptotic (B20) as well.

average occupation fraction, |ν − ν̄|  ν̄, we get
2

g(ν, L) '

3 (ν − ν̄) L2
.
2 (L − 1)2

(B18)

h
i
3
When 1 − ν  min 1, (L − 1) , we obtain
π2
3π 4/3
1/3
− g(ν, L) ' 1/3 (1 − ν) .
2
2
h
i
−3
Finally in the ν  min 1, (L − 1)
range
g(ν, L) '



1
(L − 1)

2


π2
3π 4/3 1/3
.
− 1/3 ν
2
2

(B19)

(B20)

The variance is obtained by using Eqs. (B18) and (B9)
to yield, in agreement with [20],
4.

Three asymptotics

2

Var (ν) =
Finally we present three asymptotics of the occupation
statistics in terms of the function g(ν, L). Close to the

[1] P. Lévy, Comp. Math. 7, 238 (1939).
[2] P. Lévy, Processus Stochastiques et Mouvement Brownien
(Gauthier-Villars, Paris, 1948).
[3] M. Kac, Proc. Second Berkeley Sympos. on Math.
Statist. and Prob. (Univ. California Press, Berkeley,
1951).
[4] D. A. Darling and M. Kac, Trans. Amer. Math. Soc. 84,
444 (1957).
[5] D. Ray, Illinois J. Math. 7, 615 (1963).
[6] F. B. Knight, Trans. Am. Math. Soc. 109, 56 (1963).
[7] F. Spitzer, Principles of Random Walk (Van Nostrand,
Princeton, N.J., 1964).
[8] K. Itô and H. P. McKean, Diffusion Processes and Their
Sample Paths (New York, Springer, 1965).
[9] N. Agmon, J. Chem. Phys. 81, 3644 (1984).
[10] A. M. Berezhkovskii, V. Zaloj and N. Agmon, Phys. Rev.
E 57, 3937 (1998).
[11] S. N. Majumdar and A. Comtet, Phys. Rev. Lett. 89,
060601 (2002).
[12] O. Bénichou, M. Coppey, J. Klafter, M. Moreau and G.
Oshanin, J. Phys. A 36, 7225 (2003).
[13] O. Bénichou, M. Coppey, J. Klafter, M. Moreau and G.
Oshanin, J. Phys. A 38, 7205 (2005).
[14] O. Bénichou, M. Coppey and M. Moreau, J. Chem. Phys.
123, 194506 (2005).
[15] E. Barkai, J. Stat. Phys. 123, 883 (2006).
[16] D. S. Grebenkov, Phys. Rev. E. 76, 041139 (2007).
[17] O. Bénichou and R. Voituriez, J. Chem. Phys. 131,
181104 (2009).
[18] O. Bénichou and J. Desbois, J. Phys. A 42, 015004
(2009).
[19] P. Mörters and Y. Peres, Brownian Motion (Cambridge
University Press, Cambridge, 2010).
[20] A. M. Berezhkovskii, Chem. Phys. 370, 253 (2010).

2l2 (L − l)
,
3N L2 D0 T

(B21)

[21] N. Agmon, Chem. Phys. Lett. 497, 184 (2010).
[22] O. Bénichou and R. Voituriez, Phys. Rep. 539, 225
(2014).
[23] O. Bénichou and J. Desbois, J. Stat. Mech. (2015)
P03001.
[24] P. L. Krapivsky, K. Mallick and T. Sadhu, J. Stat. Mech.
(2015) P09007.
[25] F. Angeletti and H. Touchette, J. Math. Phys. 53, 023303
(2016).
[26] P. Tsobgni Nyawo and H. Touchette, Europhys. Lett.
116, 50009 (2016).
[27] P. Tsobgni Nyawo and H. Touchette, Phys. Rev. E 98,
052103 (2018).
[28] J. Randon-Furling and S. Redner, J. Stat. Mech. (2018)
P103205.
[29] P. C. Bressloff and J. M. Newby, Rev. Mod. Phys. 85,
135 (2013).
[30] B. Meerson, A. Vilenkin and P. L. Krapivsky, Phys. Rev.
E 90, 022120 (2014).
[31] T. Agranov, B. Meerson and A. Vilenkin, Phys. Rev. E
93, 012136 (2016).
[32] T. Agranov and B. Meerson, Phys. Rev. E 95, 062124
(2017).
[33] T. Agranov and B. Meerson, Phys. Rev. Lett. 120,
120601 (2018).
[34] T. Agranov and B. Meerson, in “Chemical Kinetics Beyond the Textbook”, edited by K. Lindenberg, R. Metzler and G. Oshanin (World Scientific, Singapore, 2018),
chapter 9; arXiv:1806.02114.
[35] L. Bertini, A. De Sole, D. Gabrielli, G. Jona Lasinio, C.
Landim. Rev. Mod. Phys. 87, 593 (2015).
[36] L. Bertini, A. De Sole, D. Gabrielli, J. Jona-Lasinio and
C. Landim, J. Stat. Phys. 123, 237 (2006).
[37] T. Bodineau and B. Derrida, C. R. Physique 8, 540

15
(2007).
[38] P. I. Hurtado, C. P. Espigares, J. J. del Pozo, and P. L.
Garrido, J. Stat. Phys. 154, 214 (2014).
[39] O. Shpielberg and E. Akkermans, Phys. Rev. Lett. 116,
240603 (2016).
[40] Y. Baek, Y. Kafri and V. Lecomte, Phys. Rev. Lett. 118,
030604 (2017).
[41] H. Touchette, Phys. Rep. 478, 1 (2009).
[42] P. L. Krapivsky, S. Redner and E. Ben-Naim, A Kinetic
View of Statistical Physics (Cambridge University Press,
Cambridge, 2010).
[43] Refs. [26, 27] also accounted for a constant driving force
and discovered a dynamical phase transition resulting
from it. See also earlier work [75, 76], where a constant
driving force causes a dynamical phase transition in a
different setting.
[44] M. D. Donsker and S. R. S. Varadhan, Comm. Pure Appl.
Math. 28, 1 (1975); 28, 279 (1975); 29, 389 (1976); 36,
183 (1983).
[45] J. Hoppenau, D. Nickelsen and A. Engel, New J. Phys.
18, 083010 (2016).
[46] R. Chetrite and H. Touchette, Phys. Rev. Lett. 111,
120601 (2013).
[47] R. Chetrite and H. Touchette, J. Stat. Mech. (2015)
P12001.
[48] H. Spohn, Large-Scale Dynamics of Interacting Particles
(Springer-Verlag, New York, 1991).
[49] C. Kipnis and C. Landim, Scaling Limits of Interacting
Particle Systems (Springer, New York, 1999).
[50] Ya. M. Blanter and M. Büttiker, Phys. Rep. 336, 1
(2000).
[51] A. N. Jordan, E. V. Sukhorukov, and S. Pilgram, J.
Math. Phys. 45, 4386 (2004).
[52] R. Pnini and B. Shapiro, Phys. Rev. B 39, 6986 (1989).
[53] R. Sarma, A. Yamilov, P. Neupane, B. Shapiro, and H.
Cao, Phys. Rev. B 90, 014203 (2014).
[54] T. M. Liggett, Stochastic Interacting Systems: Contact,
Voter, and Exclusion Processes (Springer, New York,
1999).
[55] T. Chou and D. Lohse, Phys. Rev. Lett. 82, 3552 (1999).
[56] A. Das, S. Jayanthi, H.S.M.V. Deepak, K. V. Ramanathan, A. Kumar, C. Dasgupta and A. K. Sood, ACS
Nano 4, 1687 (2010).
[57] O. Bénichou, P. Illien, G. Oshanin, A. Sarracino and R.
Voituriez, J. Phys.: Cond. Matter 30, 443001 (2018).
[58] T. Chou, K. Mallick, and R. K. P. Zia, Rep. Prog. Phys.
74, 116601 (2011).
[59] A. Schadschneider, D. Chowdhury and K. Nishinari
Stochastic Transport in Complex Systems (Elsevier Science, 2010).

[60] P. L. Krapivsky, B. Meerson and P. V. Sasorov, J. Stat.
Mech. P12014 (2012).
[61] In the occupation statistics problem one should demand
that the number of particles, which occupy the macroscopic interval of length 2l, be large: N ν  1.
[62] T. Bodineau and B. Derrida, Phys. Rev. Lett. 92, 180601
(2004).
[63] It would be interesting to find a lattice gas model, for
which this condition is violated. If this happens, the total number of particles, composing the stationary optimal
density profile, should come from an additional minimization procedure.
[64] Convergence of the integral (23) puts some limitations on
the behavior of D(ρ) and σ(ρ) at small densities. As an
example, let D(ρ → 0) ∼ ρα and σ(ρ → 0) ∼ ρβ . Then
the integral converges at ρ → 0 if and only if 2α−β +2 >
0. This condition holds for the models we consider here.
[65] L. Elsgolts, Differential Equations and the Calculus of
Variations (Mir Publishers, Moscow, 1977).
[66] S. Flügge, Practical Quantum Mechanics I (SpringerVerlag, Berlin, 1971).
[67] L.D. Landau and E.M. Lifshits, Quantum Mechanics,
Non-Relativistic theory (Pergamon, London, 1958).
[68] For solutions with compact support it vanishes for all
points past the support ends |x| > x0 .
[69] Equations (31) and (32) have infinitely many solutions,
where λ1 is on the intervals πm ≤ λ1 ≤ πm + π/2;
m = 0, 1, 2, . . . . The values m = 1, 2, . . . , correspond
to the excited states of the quantum problem and are
suboptimal.
[70] Wolfram Research, Inc.,
http://functions.wolfram.com/EllipticFunctions/.
[71] Wolfram Research, Inc.,
http://functions.wolfram.com/EllipticIntegrals/.
[72] Reintroducing the lattice constant a, we obtain
a dimensionally correct formula − ln P(ν, N, T ) '
[D0 T /(`a)] g (na, ν).
[73] For ν > νc1 (L) the solution (70) would violate the positivity constraint (19) and is therefore invalid, so the solution (59) is unique there.
[74] H. E. Stanley, Introduction to Phase Transitions and
Critical Phenomena (Oxford University Press, Oxford,
1971).
[75] Th. M. Nieuwenhuizen, Phys. Rev. Lett. 62, 357 (1989).
[76] V. Mehra and P. Grassberger, Physica D 168-169, 244
(2002).
[77] J.R. Lakowicz, Topics in Fluorescence Spectroscopy
(Springer, Boston, MA, 2002).
[78] P. L. Krapivsky and B. Meerson, Phys. Rev. E 86, 031106
(2012).

