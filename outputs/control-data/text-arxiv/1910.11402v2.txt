DEEP LEARNING-BASED BEAM ALIGNMENT IN MMWAVE VEHICULAR NETWORKS
Nitin Jonathan Myers, Yuyang Wang, Nuria González-Prelcic, and Robert W. Heath Jr.

arXiv:1910.11402v2 [eess.SP] 12 Nov 2019

Department of Electrical and Computer Engineering, The University of Texas at Austin.
Email :{nitinjmyers,yuywang,ngprelcic,rheath}@utexas.edu
ABSTRACT
Millimeter wave channels exhibit structure that allows beam alignment with fewer channel measurements than exhaustive beam
search. From a compressed sensing (CS) perspective, the received
channel measurements are usually obtained by multiplying a CS
matrix with a sparse representation of the channel matrix. Due to the
constraints imposed by analog processing, designing CS matrices
that efficiently exploit the channel structure is, however, challenging. In this paper, we propose an end-to-end deep learning technique
to design a structured CS matrix that is well suited to the underlying channel distribution, leveraging both sparsity and the particular
spatial structure that appears in vehicular channels. The channel
measurements acquired with the designed CS matrix are then used
to predict the best beam for link configuration. Simulation results for
vehicular communication channels indicate that our deep learningbased approach achieves better beam alignment than standard CS
techniques that use the random phase shift-based design.
Index Terms— Compressed sensing, mmWave, deep learning
1. INTRODUCTION
Beam alignment in millimeter wave (mmWave) radios is a challenging problem due to the use of large antenna arrays and fewer radio
frequency chains than antennas [1]. Exhaustive search-based beam
alignment results in a substantial overhead at mmWave [2]. A possible approach to reduce this overhead is to use compressed sensing
(CS)-based methods that acquire a lower dimensional channel representation [3]. The use of random compressive channel projections
together with algorithms that exploit sparsity of mmWave channels
can achieve fast and accurate beam alignment [4, 5]. Prior work has
shown that structured compressive channel projections may result in
better beam alignment than the use of random projections [6].
Convolutional compressed sensing (CCS) is a structured CS
technique in which the signal of interest is projected onto fewer
circulant shifts of a known signal [7]. We investigate 2D-CCS, i.e.,
CCS of 2D signals, as our focus is on planar antenna arrays. In
2D-CCS-based beam alignment, the transmitter (TX) applies fewer
2D-circulant shifts of a matrix to its antenna array for the receiver
(RX) to acquire compressed channel measurements. Then, the best
beam at the TX is estimated from the compressed measurements using optimization algorithms [6]. The matrix used in 2D-CCS, called
the base matrix, determines the success of channel sparsity-aware
beam alignment. In typical vehicular communication scenarios,
channels exhibit structure beyond sparsity in the space of beam directions. For example, some beam directions may be more likely to
be optimal than the others [8]. In such a case, the use of structured
This research was supported in part by the National Science Foundation
under Grant numbers NSF-CNS-1731658 and NSF-CNS-1702800.

random CS matrices can result in better beam alignment than standard designs [9]. In this paper, we use deep learning as a tool to find
a base matrix in 2D-CCS that is well suited to the channel prior.
Prior work in imaging [10] and beamforming [11] has considered deep learning-based CS matrix optimization. In this paper, we
propose a structured CS matrix optimization framework for the beam
alignment problem. Our contributions are as follows. First, we
show how 2D-CCS matrices with complex entries can be realized
with real valued convolutional layers. Second, we propose a deep
learning-based 2D-CCS matrix optimization procedure that accounts
for the hardware constraints associated with radio frequency (RF)
phase shifters. Last, we interpret the CS matrix optimized with deep
learning using properties of the Fourier transform. The structured
training in our 2D-CCS-based method results in fewer optimization
parameters than the CS matrix optimization approach in [11].
Notation: A is a matrix, a is a column vector and a, A denote
scalars. The real and imaginary parts of A are denoted by AR and
AI . A(k, `) denotes the entry of A in the kth row and the `th column. The `th column of A is denoted by A(:, `). |A| is a matrix that
contains the magnitude of the entries in A. The Frobenius norm of
A is kAkF . The
P inner product of two matrices A and B is defined
as hA, Bi = k,` A(k, `)B(k, `). The matrix [A; B] is obtained
by vertically stacking A and B. UN√is an N × N unitary discrete
Fourier transform (DFT) matrix. j = −1.
2. BEAM ALIGNMENT WITH CONVOLUTIONAL CS
We consider a narrowband system with an N × N uniform planar
array (UPA) at the TX and a single antenna at the RX. The single
antenna assumption at the RX is made for simplicity; an extension
of our approach to receivers with multiple antennas will be considered in our future work. The TX is equipped with a q-bit phased
antenna array that uses a single RF chain and is mounted on a road
side unit (RSU). The RSU serves an RX which is mounted on top of
a vehicle, as illustrated in Fig. 1. We use H ∈ CN ×N to denote the
channel matrix between the UPA at the TX and the single antenna
RX. Note that the (r, c)th entry of H represents the channel coefficient between the (r, c)th antenna at the TX and the RX antenna.
We consider both line-of-sight (LoS) and non-LoS channels in our
simulations. We use Qq to denote the set of possible phase shifts
q
in the analog beamforming network, i.e., Qq = {ej2πb/2 /N : b ∈
q
th
{1, 2, · · · 2 }}. In the m beam training slot, the TX applies the
phase shift matrix P[m] ∈ QqN ×N to its phased array. The channel
measurement received by the RX for a unit pilot symbol is then
y[m] = hH, P[m]i + v[m],

(1)

where v[m] ∈ C denotes additive white Gaussian noise (AWGN).
We define F as the standard 2D-DFT codebook for the UPA-based
TX. The transmit beam alignment problem is to estimate a beamformer PBF ∈ F that maximizes the inner product |hH, Pi|.

TX at a road side unit
with an "×" UPA

RX 1

RX 2

Fig. 1: An illustration of a vehicular communication scenario considered in this paper. The RSU serves vehicles on the two lanes.

16
14
12
10
8
6
4
2

1.0
1.5
2.0
2.5
3.0
3.5
4.0

Beamspace rows

Beamspace rows

A straightforward approach for beam alignment is to first estimate all the N 2 coefficients of H using scalar projections of the
form in (1). Then, beam alignment can be performed using the estimated channel. Estimating the N × N channel matrix, however,
can result in a significant overhead as the channel dimension is large
in typical mmWave settings. Due to the structure in mmWave vehicular channels, it may be possible to estimate the best beam without
explicit channel estimation. For example, prior work has shown that
beam alignment can be performed with just O(log N ) random phase
shift-based compressed measurements of a sparse channel [5]. Although random phase shift-based CS performs well, the question is
if it is possible to construct a CS matrix that is better matched to the
channel prior in vehicular settings.
16
14
12
10
8
6
4
2

0.14
0.12
0.10
0.08
0.06
0.04
0.02

1 2 4 6 8 10 12 14 16
Beamspace columns

1 2 4 6 8 10 12 14 16
Beamspace columns

(a) Beamspace prior (log scale)

(b) Beampattern of a random matrix

Fig. 2: For the vehicular communication scenario in our simulations, the beamspace prior is non-zero over a small set in the space
of 2D-DFT directions. Random phase shift-based CS uses quasiomnidirectional beams and does not exploit such an information.
We now discuss the additional channel structure present in a typical mmWave vehicular communication scenario, such as the one
shown in Fig. 1. For an ensemble of receivers within the coverage of an RSU, we show the probability distribution of the best
transmit beams in Fig. 2a. The (i, j)th entry of the beamspace
prior in Fig. 2a is the probability that the (i, j)th 2D-DFT beam,
i.e., UN (:, i)UTN (:, j), is optimal. In our simulation scenario, the
beamspace prior is concentrated over two strips on an N × N grid
of 2D-DFT angles. These two strips correspond to directional beams
that point along the vehicle moving trajectories associated with two
different lanes shown in Fig. 1. Compressed sensing using random phase shift matrices, however, does not exploit the fact that the
beamspace probability is concentrated in a small support set. This
is because the beam associated with a random phase shift matrix is
quasi-omnidirectional with a high probability; an example of such
a beam is shown in Fig. 2b. Sensing with a quasi-omnidirectional
pattern is inefficient in vehicular applications, since the vehicle locations are constrained to the road lanes, and many angular directions
can be discarded apriori.
2.1. Motivation to use 2D-CCS over standard CS
We first describe the measurement model in 2D-CCS when the TX
×N
uses P ∈ QN
as the base matrix [6]. In 2D-CCS, the TX apq

plies M distinct 2D-circulant shifts of P to its phased array for the
RX to acquire channel measurements. To explain 2D-CCS, we consider a case where the TX applies all the N 2 possible 2D-circulant
shifts of P to its antenna array. In this case, M = N 2 and the
collection of measurements acquired by the RX is the 2D-circular
cross-correlation between H and P. We denote this circular crosscorrelation as
G = H ? P.
(2)
The (r, c)th entry of G can be expressed as
X
G(r, c) =
H(k, `)P ((k − r) mod N, (` − c) mod N ) . (3)
k,`

Acquiring all the N 2 entries of G, however, results in a training
overhead that is comparable to exhaustive search. In 2D-CCS, the
TX applies M  N 2 random 2D-circulant shifts of P to reduce
the overhead. We use Ω to denote an ordered set of M circulant
shifts used by the TX. With the circulant shift-based training, the
RX acquires a subsampled version of G at the ordered locations in
Ω. For example, Ω = {(0, 1), (1, 2), (2, 1)} is one possible set for
M = 3. In this case, the RX acquires G(0, 1), G(1, 2) and G(2, 1).
We define PΩ (G) as the vector containing the entries of G at the
locations in Ω. The compressed channel measurement vector in 2DCCS is then
y = PΩ (G) + v.
(4)
The measurements are called convolutional channel measurements
as the subsampled cross-correlation operation in (4) can be realized
using subsampled convolution. For a well designed base matrix P in
2D-CCS, optimization algorithms can estimate the best beamspace
direction from the compressed channel measurements in (4) even
when M  N 2 [6].
We explain the efficiency of 2D-CCS in exploiting the beamspace
prior with the Fourier transform. We define X as the 2D-DFT of the
channel H and Z[m] as the 2D-DFT of the phase shift matrix P[m].
The matrix X is called the beamspace and the prior associated with
the maximizer of |X| is shown in Fig. 2a. This prior is also the
probability distribution of the best beam within the 2D-DFT codebook. To explain the efficiency of 2D-CCS, we consider an example
where P[1] is set to a given base matrix, i.e., P[1] = P. The first
channel measurement is then hH, Pi. Due to the unitary nature
of the 2D-DFT, the inner product between H and P can also be
expressed as the inner product of their 2D-DFTs, i.e., hX, Z[1]i. It
can be observed from Fig. 2a that the information required for beam
alignment is encoded in fewer coefficients of X, i.e., the entries of
X along the two strips. To extract this information from hX, Z[1]i
in a way that is robust to noise, Z[1] must have a large amplitude at
the locations along the two strips. A base matrix P whose 2D-DFT
satisfies such a property can be used to efficiently acquire features
or measurements of the sparse channel.
An interesting property of 2D-CCS is that the matrices used to
obtain channel projections have the same 2D-DFT magnitude as the
base matrix, i.e., |Z[m]| = |Z[1]| ∀m. The observation follows from
the fact that 2D-circulant shifts over a matrix do not change the magnitude of its 2D-DFT [12]. Using this property, it can be observed
that a careful design of the base matrix ensures that all the matrices
{Z[m]}M
m=1 have a large amplitude at the desired locations. Designing a base matrix that is best suited to the channel prior, however, can
be challenging when M  N 2 . In Section 3, we discuss how deep
learning can be used to solve the base matrix design problem for efficient 2D-CCS. We assume that the subsampling set Ω is chosen at
random and is fixed throughout optimization. Optimizing the subsampling set is an interesting direction for future work.

3. BASE MATRIX DESIGN WITH DEEP LEARNING
We explain the proposed deep neural network architecture using Fig.
3. The first part of our deep neural network contains a convolutional
layer to emulate 2D-CCS-based compressed channel sensing in (4).
The weights of the filters in the convolutional layer model the real
and imaginary components of the base matrix P in 2D-CCS. The
second part of the network is a cascade of fully connected layers that
predicts the best beam from the compressed channel measurements.
Through end-to-end learning, our network learns a base matrix P
and the weights of the fully connected layers that maximize the beam
alignment probability. In this section, we describe the key components of our network and the training procedure; our implementation
is available online on GitHub [13].
3.1. 2D-CCS using real valued convolutional layers
We explain how to implement the circular cross-correlation in (2)
using the example of a real matrix HR ? PR . To realize a circulant structure in the correlation, we define a matrix AR,pad =
[AR , AR ; AR , AR ]. Note that HR,pad is a 2N × 2N matrix. Now,
applying the convolutional filter PR over HR,pad , in a valid-padding
mode with a stride of 1, results in an (N + 1) × (N + 1) matrix. The
circular cross-correlation HR ? PR is obtained by simply deleting
the last row and the last column of the convolved output.
Our network obtains the complex valued circular cross-correlation
by computing the real and imaginary components of G in (2). As
P = PR + jPI , the real and imaginary components of G are
GR = HR ? PR − HI ? PI , and
GI = HI ? PR + HR ? PI .

(5)
(6)

To realize (5) and (6), a 2N × 4N × 2 real valued tensor is first
constructed from the complex channel H. The first slice of this tensor is the 2N × 4N matrix [HR,pad , HI,pad ] and the second slice
is [−HI,pad , HR,pad ], as shown in Fig. 3. Then, an N × N × 2
convolutional filter with PR and PI as the filter weights, is applied
over the input channel tensor. The filtering is performed in a validpadding mode with a stride of 1 to result in an (N + 1) × (3N + 1)
matrix. Finally, GR and GI are N × N matrices which begin at the
(0, 0) and (2N, 0) coordinates of the (N + 1) × (3N + 1) matrix.
The channel measurements in (4) can be split into real and imaginary components as yR = PΩ (GR ) + vR and yI = PΩ (GI ) + vI .
It is important to note that the subsampling set in (4), i.e., Ω, is same
for both the real and the imaginary components of y. We implement
such a subsampling by using an identical dropout technique for both
GR and GI . Our dropout procedure discards N 2 − M entries of
GR and GI at the same locations which are chosen at random. The
subsampled features, i.e., PΩ (GR ) and PΩ (GI ), are perturbed by
AWGN to emulate the compressed sensing model in (4).
3.2. End-to-end learning for beam prediction
The subsampled channel feature vector of dimension 2M × 1 is fed
into a beam prediction network that is a cascade of fully connected
layers. ReLU activation is used at all the fully connected layers and
a softmax is used at the output layer. In this paper, beam alignment
is performed using a 2D-DFT codebook that has N 2 elements. Each
codebook element is modeled by a class and the output of the neural network is an N 2 × 1 vector that contains the predicted class
probabilities.
The network is trained using the restructured channels, i.e., a
collection of 2N × 4N × 2 tensors defined in Section 3.1, and the

best beam class indices corresponding to the channels. The deep
neural network is trained by minimizing the cross entropy between
the predicted class probabilities and the one-hot encoded vectors corresponding to the best beam index. It is important to note that the
convolutional filters PR and PI are part of the neural network and
are optimized during training. After successful training, the beam
prediction component of the neural network is expected to output
the best beam direction from the 2M × 1 feature vector which represents the compressed channel measurements.
3.3. Weight quantization and implementation in hardware
The filter weights PR and PI trained with end-to-end learning may
not be hardware compatible, i.e., the corresponding base matrix P =
PR + jPI may not belong to QqN ×N . To this end, we use an approach similar to weight quantization and retraining in [14]. We define phaseq (w) as a function that returns the phase of w rounded to a
nearest integer multiple of 2π/2q . The q-bit phase quantized version
of P is defined as Pquant = exp(j phaseq (P))/N . The optimized
filter weights PR and PI are replaced by the real and imaginary parts
of Pquant . Replacing the filter weights in the convolutional layer,
however, can reduce the accuracy of the trained neural network. To
compensate for the performance loss due to quantization, the fully
connected layers following the convolutional layers are retrained. It
is important to note that the convolutional layer containing Pquant
is not updated during retraining.
Now, we explain how the trained network can be used for beam
alignment in mmWave phased arrays. First, the TX applies M circulant shifts of Pquant to its phased array, according to the subsampling set Ω. For each phase shift matrix applied at the TX, the RX
acquires a channel measurement defined by (1). Therefore, the RX
obtains a subsampled version of G = H ? Pquant according to the
model in (4). The received measurements are then reshaped into a
vector [yR ; yI ] which is fed into the trained fully connected layers
for beam prediction. The RX feedbacks the index of this beam and
the TX applies the corresponding 2D-DFT codebook element.
4. SIMULATIONS
We consider a vehicular communication scenario in which the RSU
is placed at a height of 5 m. The TX at the RSU is equipped with a
16 × 16 UPA with 3-bit phase shifters, i.e., N = 16 and q = 3. The
carrier frequency is set as 28 GHz and the operating bandwidth is
100 MHz. In our simulation scenario, vehicles move along two lanes
that are at a distance of 4 m and 7 m from the foot of the RSU. We
use Wireless Insite [15], a ray tracing simulator, to obtain channel
matrices between the TX and the receivers which are mounted on top
of the vehicles. The beamspace prior corresponding to this scenario
is shown in Fig. 2a. Note that our dataset contains both LoS and
NLoS channels. The NLoS scenario occurs when the link between
the RSU and a vehicle is blocked by tall trucks.
The convolutional layer in our network consists of a single filter
of dimensions 16 × 16 × 2. This filter is used to optimize the base
matrix in 2D-CCS. To emulate M number of 2D-CCS-based channel
measurements, the convolved output is subsampled to a 2M × 1
feature vector. This vector is then fed into a cascade of four fully
connected layers with output dimensions of 80, 256, 512 and 256.
For the beam alignment problem, a reasonable network is one that is
invariant to the scaling of the channel. The bias at all the layers is
forced to zero to ensure that the network satisfies the scale invariance
property. We use about 20, 000 channels to train the network and
5, 000 other channels for testing. Every channel in the training set

2D-convolutional
layer of depth 2

Input features
Depth = 2
<latexit sha1_base64="3AviEU5AxIfeBBcJk9ww0wJsGGE=">AAACAXicbZDLSsNAFIYnXmu9Rd0IbgaL4MaSiKDLopu6q2Av0IYwmU7aoTOTMDMRSogbX8WNC0Xc+hbufBsnaRba+sPAx3/OYc75g5hRpR3n21paXlldW69sVDe3tnd27b39jooSiUkbRyySvQApwqggbU01I71YEsQDRrrB5Cavdx+IVDQS93oaE4+jkaAhxUgby7cPzwYc6XEQps3MTwuWPL3NMt+uOXWnEFwEt4QaKNXy7a/BMMIJJ0JjhpTqu06svRRJTTEjWXWQKBIjPEEj0jcoECfKS4sLMnhinCEMI2me0LBwf0+kiCs15YHpzFdU87Xc/K/WT3R45aVUxIkmAs8+ChMGdQTzOOCQSoI1mxpAWFKzK8RjJBHWJrSqCcGdP3kROud116m7dxe1xnUZRwUcgWNwClxwCRqgCVqgDTB4BM/gFbxZT9aL9W59zFqXrHLmAPyR9fkDIpiXUw==</latexit>
sha1_base64="hP+6LrUf2d3tZaldqaQQvEKMXyw=">AAAB2XicbZDNSgMxFIXv1L86Vq1rN8EiuCozbnQpuHFZwbZCO5RM5k4bmskMyR2hDH0BF25EfC93vo3pz0JbDwQ+zknIvSculLQUBN9ebWd3b/+gfugfNfzjk9Nmo2fz0gjsilzl5jnmFpXU2CVJCp8LgzyLFfbj6f0i77+gsTLXTzQrMMr4WMtUCk7O6oyaraAdLMW2IVxDC9YaNb+GSS7KDDUJxa0dhEFBUcUNSaFw7g9LiwUXUz7GgUPNM7RRtRxzzi6dk7A0N+5oYkv394uKZ9bOstjdzDhN7Ga2MP/LBiWlt1EldVESarH6KC0Vo5wtdmaJNChIzRxwYaSblYkJN1yQa8Z3HYSbG29D77odBu3wMYA6nMMFXEEIN3AHD9CBLghI4BXevYn35n2suqp569LO4I+8zx84xIo4</latexit>
sha1_base64="vT9ZTSw9RHjFjHia6uy3TjPIpPU=">AAAB9nicbZBPS8MwGMbf+nfOqdWT4CU4BC+O1oseBS/zNsH9ga2MNEu3sCQtSSqMUi9+FS8eFPGjePPbmHY76OYDgR/Pk5D3fcKEM20879tZW9/Y3Nqu7FR3a3v7B+5hraPjVBHaJjGPVS/EmnImadsww2kvURSLkNNuOL0t8u4jVZrF8sHMEhoIPJYsYgQbaw3d44uBwGYSRlkzH2YlK5Hd5fnQrXsNrxRaBX8BdVioNXS/BqOYpIJKQzjWuu97iQkyrAwjnObVQappgskUj2nfosSC6iArN8jRmXVGKIqVPdKg0v39IsNC65kI7c1iRL2cFeZ/WT810XWQMZmkhkoy/yhKOTIxKupAI6YoMXxmARPF7KyITLDCxNjSqrYEf3nlVehcNnyv4d97UIETOIVz8OEKbqAJLWgDgSd4gTd4d56dV+djXteas+jtCP7I+fwBoKSV5w==</latexit>
sha1_base64="nX/asqiXNvzpkieiK+cdEzlBtyg=">AAACAXicbZC7TsMwFIadcivlFmBBYrGokFioEhYYK1jKViR6kdooclyntWo7ke0gVVFYeBUWBhBi5S3YeBucNAO0/JKlT/85Rz7nD2JGlXacb6uysrq2vlHdrG1t7+zu2fsHXRUlEpMOjlgk+wFShFFBOppqRvqxJIgHjPSC6U1e7z0QqWgk7vUsJh5HY0FDipE2lm8fnQ850pMgTFuZnxYseXqbZb5ddxpOIbgMbgl1UKrt21/DUYQTToTGDCk1cJ1YeymSmmJGstowUSRGeIrGZGBQIE6UlxYXZPDUOCMYRtI8oWHh/p5IEVdqxgPTma+oFmu5+V9tkOjwykupiBNNBJ5/FCYM6gjmccARlQRrNjOAsKRmV4gnSCKsTWg1E4K7ePIydC8artNw75x687qMowqOwQk4Ay64BE3QAm3QARg8gmfwCt6sJ+vFerc+5q0Vq5w5BH9kff4AIViXTw==</latexit>

<latexit sha1_base64="3AviEU5AxIfeBBcJk9ww0wJsGGE=">AAACAXicbZDLSsNAFIYnXmu9Rd0IbgaL4MaSiKDLopu6q2Av0IYwmU7aoTOTMDMRSogbX8WNC0Xc+hbufBsnaRba+sPAx3/OYc75g5hRpR3n21paXlldW69sVDe3tnd27b39jooSiUkbRyySvQApwqggbU01I71YEsQDRrrB5Cavdx+IVDQS93oaE4+jkaAhxUgby7cPzwYc6XEQps3MTwuWPL3NMt+uOXWnEFwEt4QaKNXy7a/BMMIJJ0JjhpTqu06svRRJTTEjWXWQKBIjPEEj0jcoECfKS4sLMnhinCEMI2me0LBwf0+kiCs15YHpzFdU87Xc/K/WT3R45aVUxIkmAs8+ChMGdQTzOOCQSoI1mxpAWFKzK8RjJBHWJrSqCcGdP3kROud116m7dxe1xnUZRwUcgWNwClxwCRqgCVqgDTB4BM/gFbxZT9aL9W59zFqXrHLmAPyR9fkDIpiXUw==</latexit>
sha1_base64="hP+6LrUf2d3tZaldqaQQvEKMXyw=">AAAB2XicbZDNSgMxFIXv1L86Vq1rN8EiuCozbnQpuHFZwbZCO5RM5k4bmskMyR2hDH0BF25EfC93vo3pz0JbDwQ+zknIvSculLQUBN9ebWd3b/+gfugfNfzjk9Nmo2fz0gjsilzl5jnmFpXU2CVJCp8LgzyLFfbj6f0i77+gsTLXTzQrMMr4WMtUCk7O6oyaraAdLMW2IVxDC9YaNb+GSS7KDDUJxa0dhEFBUcUNSaFw7g9LiwUXUz7GgUPNM7RRtRxzzi6dk7A0N+5oYkv394uKZ9bOstjdzDhN7Ga2MP/LBiWlt1EldVESarH6KC0Vo5wtdmaJNChIzRxwYaSblYkJN1yQa8Z3HYSbG29D77odBu3wMYA6nMMFXEEIN3AHD9CBLghI4BXevYn35n2suqp569LO4I+8zx84xIo4</latexit>
sha1_base64="vT9ZTSw9RHjFjHia6uy3TjPIpPU=">AAAB9nicbZBPS8MwGMbf+nfOqdWT4CU4BC+O1oseBS/zNsH9ga2MNEu3sCQtSSqMUi9+FS8eFPGjePPbmHY76OYDgR/Pk5D3fcKEM20879tZW9/Y3Nqu7FR3a3v7B+5hraPjVBHaJjGPVS/EmnImadsww2kvURSLkNNuOL0t8u4jVZrF8sHMEhoIPJYsYgQbaw3d44uBwGYSRlkzH2YlK5Hd5fnQrXsNrxRaBX8BdVioNXS/BqOYpIJKQzjWuu97iQkyrAwjnObVQappgskUj2nfosSC6iArN8jRmXVGKIqVPdKg0v39IsNC65kI7c1iRL2cFeZ/WT810XWQMZmkhkoy/yhKOTIxKupAI6YoMXxmARPF7KyITLDCxNjSqrYEf3nlVehcNnyv4d97UIETOIVz8OEKbqAJLWgDgSd4gTd4d56dV+djXteas+jtCP7I+fwBoKSV5w==</latexit>
sha1_base64="nX/asqiXNvzpkieiK+cdEzlBtyg=">AAACAXicbZC7TsMwFIadcivlFmBBYrGokFioEhYYK1jKViR6kdooclyntWo7ke0gVVFYeBUWBhBi5S3YeBucNAO0/JKlT/85Rz7nD2JGlXacb6uysrq2vlHdrG1t7+zu2fsHXRUlEpMOjlgk+wFShFFBOppqRvqxJIgHjPSC6U1e7z0QqWgk7vUsJh5HY0FDipE2lm8fnQ850pMgTFuZnxYseXqbZb5ddxpOIbgMbgl1UKrt21/DUYQTToTGDCk1cJ1YeymSmmJGstowUSRGeIrGZGBQIE6UlxYXZPDUOCMYRtI8oWHh/p5IEVdqxgPTma+oFmu5+V9tkOjwykupiBNNBJ5/FCYM6gjmccARlQRrNjOAsKRmV4gnSCKsTWg1E4K7ePIydC8artNw75x687qMowqOwQk4Ay64BE3QAm3QARg8gmfwCt6sJ+vFerc+5q0Vq5w5BH9kff4AIViXTw==</latexit>

Subsamp ng
de ned by ⌦

Dense ayers
o owed by so max

G=H?P
HI

<latexit sha1_base64="3AviEU5AxIfeBBcJk9ww0wJsGGE=">AAACAXicbZDLSsNAFIYnXmu9Rd0IbgaL4MaSiKDLopu6q2Av0IYwmU7aoTOTMDMRSogbX8WNC0Xc+hbufBsnaRba+sPAx3/OYc75g5hRpR3n21paXlldW69sVDe3tnd27b39jooSiUkbRyySvQApwqggbU01I71YEsQDRrrB5Cavdx+IVDQS93oaE4+jkaAhxUgby7cPzwYc6XEQps3MTwuWPL3NMt+uOXWnEFwEt4QaKNXy7a/BMMIJJ0JjhpTqu06svRRJTTEjWXWQKBIjPEEj0jcoECfKS4sLMnhinCEMI2me0LBwf0+kiCs15YHpzFdU87Xc/K/WT3R45aVUxIkmAs8+ChMGdQTzOOCQSoI1mxpAWFKzK8RjJBHWJrSqCcGdP3kROud116m7dxe1xnUZRwUcgWNwClxwCRqgCVqgDTB4BM/gFbxZT9aL9W59zFqXrHLmAPyR9fkDIpiXUw==</latexit>
sha1_base64="hP+6LrUf2d3tZaldqaQQvEKMXyw=">AAAB2XicbZDNSgMxFIXv1L86Vq1rN8EiuCozbnQpuHFZwbZCO5RM5k4bmskMyR2hDH0BF25EfC93vo3pz0JbDwQ+zknIvSculLQUBN9ebWd3b/+gfugfNfzjk9Nmo2fz0gjsilzl5jnmFpXU2CVJCp8LgzyLFfbj6f0i77+gsTLXTzQrMMr4WMtUCk7O6oyaraAdLMW2IVxDC9YaNb+GSS7KDDUJxa0dhEFBUcUNSaFw7g9LiwUXUz7GgUPNM7RRtRxzzi6dk7A0N+5oYkv394uKZ9bOstjdzDhN7Ga2MP/LBiWlt1EldVESarH6KC0Vo5wtdmaJNChIzRxwYaSblYkJN1yQa8Z3HYSbG29D77odBu3wMYA6nMMFXEEIN3AHD9CBLghI4BXevYn35n2suqp569LO4I+8zx84xIo4</latexit>
sha1_base64="vT9ZTSw9RHjFjHia6uy3TjPIpPU=">AAAB9nicbZBPS8MwGMbf+nfOqdWT4CU4BC+O1oseBS/zNsH9ga2MNEu3sCQtSSqMUi9+FS8eFPGjePPbmHY76OYDgR/Pk5D3fcKEM20879tZW9/Y3Nqu7FR3a3v7B+5hraPjVBHaJjGPVS/EmnImadsww2kvURSLkNNuOL0t8u4jVZrF8sHMEhoIPJYsYgQbaw3d44uBwGYSRlkzH2YlK5Hd5fnQrXsNrxRaBX8BdVioNXS/BqOYpIJKQzjWuu97iQkyrAwjnObVQappgskUj2nfosSC6iArN8jRmXVGKIqVPdKg0v39IsNC65kI7c1iRL2cFeZ/WT810XWQMZmkhkoy/yhKOTIxKupAI6YoMXxmARPF7KyITLDCxNjSqrYEf3nlVehcNnyv4d97UIETOIVz8OEKbqAJLWgDgSd4gTd4d56dV+djXteas+jtCP7I+fwBoKSV5w==</latexit>
sha1_base64="nX/asqiXNvzpkieiK+cdEzlBtyg=">AAACAXicbZC7TsMwFIadcivlFmBBYrGokFioEhYYK1jKViR6kdooclyntWo7ke0gVVFYeBUWBhBi5S3YeBucNAO0/JKlT/85Rz7nD2JGlXacb6uysrq2vlHdrG1t7+zu2fsHXRUlEpMOjlgk+wFShFFBOppqRvqxJIgHjPSC6U1e7z0QqWgk7vUsJh5HY0FDipE2lm8fnQ850pMgTFuZnxYseXqbZb5ddxpOIbgMbgl1UKrt21/DUYQTToTGDCk1cJ1YeymSmmJGstowUSRGeIrGZGBQIE6UlxYXZPDUOCMYRtI8oWHh/p5IEVdqxgPTma+oFmu5+V9tkOjwykupiBNNBJ5/FCYM6gjmccARlQRrNjOAsKRmV4gnSCKsTWg1E4K7ePIydC8artNw75x687qMowqOwQk4Ay64BE3QAm3QARg8gmfwCt6sJ+vFerc+5q0Vq5w5BH9kff4AIViXTw==</latexit>

HI

<latexit sha1_base64="3AviEU5AxIfeBBcJk9ww0wJsGGE=">AAACAXicbZDLSsNAFIYnXmu9Rd0IbgaL4MaSiKDLopu6q2Av0IYwmU7aoTOTMDMRSogbX8WNC0Xc+hbufBsnaRba+sPAx3/OYc75g5hRpR3n21paXlldW69sVDe3tnd27b39jooSiUkbRyySvQApwqggbU01I71YEsQDRrrB5Cavdx+IVDQS93oaE4+jkaAhxUgby7cPzwYc6XEQps3MTwuWPL3NMt+uOXWnEFwEt4QaKNXy7a/BMMIJJ0JjhpTqu06svRRJTTEjWXWQKBIjPEEj0jcoECfKS4sLMnhinCEMI2me0LBwf0+kiCs15YHpzFdU87Xc/K/WT3R45aVUxIkmAs8+ChMGdQTzOOCQSoI1mxpAWFKzK8RjJBHWJrSqCcGdP3kROud116m7dxe1xnUZRwUcgWNwClxwCRqgCVqgDTB4BM/gFbxZT9aL9W59zFqXrHLmAPyR9fkDIpiXUw==</latexit>
sha1_base64="hP+6LrUf2d3tZaldqaQQvEKMXyw=">AAAB2XicbZDNSgMxFIXv1L86Vq1rN8EiuCozbnQpuHFZwbZCO5RM5k4bmskMyR2hDH0BF25EfC93vo3pz0JbDwQ+zknIvSculLQUBN9ebWd3b/+gfugfNfzjk9Nmo2fz0gjsilzl5jnmFpXU2CVJCp8LgzyLFfbj6f0i77+gsTLXTzQrMMr4WMtUCk7O6oyaraAdLMW2IVxDC9YaNb+GSS7KDDUJxa0dhEFBUcUNSaFw7g9LiwUXUz7GgUPNM7RRtRxzzi6dk7A0N+5oYkv394uKZ9bOstjdzDhN7Ga2MP/LBiWlt1EldVESarH6KC0Vo5wtdmaJNChIzRxwYaSblYkJN1yQa8Z3HYSbG29D77odBu3wMYA6nMMFXEEIN3AHD9CBLghI4BXevYn35n2suqp569LO4I+8zx84xIo4</latexit>
sha1_base64="vT9ZTSw9RHjFjHia6uy3TjPIpPU=">AAAB9nicbZBPS8MwGMbf+nfOqdWT4CU4BC+O1oseBS/zNsH9ga2MNEu3sCQtSSqMUi9+FS8eFPGjePPbmHY76OYDgR/Pk5D3fcKEM20879tZW9/Y3Nqu7FR3a3v7B+5hraPjVBHaJjGPVS/EmnImadsww2kvURSLkNNuOL0t8u4jVZrF8sHMEhoIPJYsYgQbaw3d44uBwGYSRlkzH2YlK5Hd5fnQrXsNrxRaBX8BdVioNXS/BqOYpIJKQzjWuu97iQkyrAwjnObVQappgskUj2nfosSC6iArN8jRmXVGKIqVPdKg0v39IsNC65kI7c1iRL2cFeZ/WT810XWQMZmkhkoy/yhKOTIxKupAI6YoMXxmARPF7KyITLDCxNjSqrYEf3nlVehcNnyv4d97UIETOIVz8OEKbqAJLWgDgSd4gTd4d56dV+djXteas+jtCP7I+fwBoKSV5w==</latexit>
sha1_base64="nX/asqiXNvzpkieiK+cdEzlBtyg=">AAACAXicbZC7TsMwFIadcivlFmBBYrGokFioEhYYK1jKViR6kdooclyntWo7ke0gVVFYeBUWBhBi5S3YeBucNAO0/JKlT/85Rz7nD2JGlXacb6uysrq2vlHdrG1t7+zu2fsHXRUlEpMOjlgk+wFShFFBOppqRvqxJIgHjPSC6U1e7z0QqWgk7vUsJh5HY0FDipE2lm8fnQ850pMgTFuZnxYseXqbZb5ddxpOIbgMbgl1UKrt21/DUYQTToTGDCk1cJ1YeymSmmJGstowUSRGeIrGZGBQIE6UlxYXZPDUOCMYRtI8oWHh/p5IEVdqxgPTma+oFmu5+V9tkOjwykupiBNNBJ5/FCYM6gjmccARlQRrNjOAsKRmV4gnSCKsTWg1E4K7ePIydC8artNw75x687qMowqOwQk4Ay64BE3QAm3QARg8gmfwCt6sJ+vFerc+5q0Vq5w5BH9kff4AIViXTw==</latexit>

HI

HR

HR

HI HR

HR

<latexit sha1_base64="/iLw1HnvJ/l+BEqnP98znn+iEjQ=">AAACAHicbZDLSsNAFIZPvNZ6i7pw4WawCK5KIoIui266rGIv0IYymU7aoTNJmJkIJWTjq7hxoYhbH8Odb+MkzUJbfxj4+M85zDm/H3OmtON8Wyura+sbm5Wt6vbO7t6+fXDYUVEiCW2TiEey52NFOQtpWzPNaS+WFAuf064/vc3r3UcqFYvCBz2LqSfwOGQBI1gba2gfDwTWEz9Im9kwLViK9D7LhnbNqTuF0DK4JdSgVGtofw1GEUkEDTXhWKm+68TaS7HUjHCaVQeJojEmUzymfYMhFlR5aXFAhs6MM0JBJM0LNSrc3xMpFkrNhG868xXVYi03/6v1Ex1ceykL40TTkMw/ChKOdITyNNCISUo0nxnARDKzKyITLDHRJrOqCcFdPHkZOhd116m7d5e1xk0ZRwVO4BTOwYUraEATWtAGAhk8wyu8WU/Wi/VufcxbV6xy5gj+yPr8AcLRlyU=</latexit>

<latexit sha1_base64="/iLw1HnvJ/l+BEqnP98znn+iEjQ=">AAACAHicbZDLSsNAFIZPvNZ6i7pw4WawCK5KIoIui266rGIv0IYymU7aoTNJmJkIJWTjq7hxoYhbH8Odb+MkzUJbfxj4+M85zDm/H3OmtON8Wyura+sbm5Wt6vbO7t6+fXDYUVEiCW2TiEey52NFOQtpWzPNaS+WFAuf064/vc3r3UcqFYvCBz2LqSfwOGQBI1gba2gfDwTWEz9Im9kwLViK9D7LhnbNqTuF0DK4JdSgVGtofw1GEUkEDTXhWKm+68TaS7HUjHCaVQeJojEmUzymfYMhFlR5aXFAhs6MM0JBJM0LNSrc3xMpFkrNhG868xXVYi03/6v1Ex1ceykL40TTkMw/ChKOdITyNNCISUo0nxnARDKzKyITLDHRJrOqCcFdPHkZOhd116m7d5e1xk0ZRwVO4BTOwYUraEATWtAGAhk8wyu8WU/Wi/VufcxbV6xy5gj+yPr8AcLRlyU=</latexit>

<latexit sha1_base64="/iLw1HnvJ/l+BEqnP98znn+iEjQ=">AAACAHicbZDLSsNAFIZPvNZ6i7pw4WawCK5KIoIui266rGIv0IYymU7aoTNJmJkIJWTjq7hxoYhbH8Odb+MkzUJbfxj4+M85zDm/H3OmtON8Wyura+sbm5Wt6vbO7t6+fXDYUVEiCW2TiEey52NFOQtpWzPNaS+WFAuf064/vc3r3UcqFYvCBz2LqSfwOGQBI1gba2gfDwTWEz9Im9kwLViK9D7LhnbNqTuF0DK4JdSgVGtofw1GEUkEDTXhWKm+68TaS7HUjHCaVQeJojEmUzymfYMhFlR5aXFAhs6MM0JBJM0LNSrc3xMpFkrNhG868xXVYi03/6v1Ex1ceykL40TTkMw/ChKOdITyNNCISUo0nxnARDKzKyITLDHRJrOqCcFdPHkZOhd116m7d5e1xk0ZRwVO4BTOwYUraEATWtAGAhk8wyu8WU/Wi/VufcxbV6xy5gj+yPr8AcLRlyU=</latexit>

HR

HI

H

HR

HR

H

H

<latexit sha1_base64="/iLw1HnvJ/l+BEqnP98znn+iEjQ=">AAACAHicbZDLSsNAFIZPvNZ6i7pw4WawCK5KIoIui266rGIv0IYymU7aoTNJmJkIJWTjq7hxoYhbH8Odb+MkzUJbfxj4+M85zDm/H3OmtON8Wyura+sbm5Wt6vbO7t6+fXDYUVEiCW2TiEey52NFOQtpWzPNaS+WFAuf064/vc3r3UcqFYvCBz2LqSfwOGQBI1gba2gfDwTWEz9Im9kwLViK9D7LhnbNqTuF0DK4JdSgVGtofw1GEUkEDTXhWKm+68TaS7HUjHCaVQeJojEmUzymfYMhFlR5aXFAhs6MM0JBJM0LNSrc3xMpFkrNhG868xXVYi03/6v1Ex1ceykL40TTkMw/ChKOdITyNNCISUo0nxnARDKzKyITLDHRJrOqCcFdPHkZOhd116m7d5e1xk0ZRwVO4BTOwYUraEATWtAGAhk8wyu8WU/Wi/VufcxbV6xy5gj+yPr8AcLRlyU=</latexit>

<latexit sha1_base64="/iLw1HnvJ/l+BEqnP98znn+iEjQ=">AAACAHicbZDLSsNAFIZPvNZ6i7pw4WawCK5KIoIui266rGIv0IYymU7aoTNJmJkIJWTjq7hxoYhbH8Odb+MkzUJbfxj4+M85zDm/H3OmtON8Wyura+sbm5Wt6vbO7t6+fXDYUVEiCW2TiEey52NFOQtpWzPNaS+WFAuf064/vc3r3UcqFYvCBz2LqSfwOGQBI1gba2gfDwTWEz9Im9kwLViK9D7LhnbNqTuF0DK4JdSgVGtofw1GEUkEDTXhWKm+68TaS7HUjHCaVQeJojEmUzymfYMhFlR5aXFAhs6MM0JBJM0LNSrc3xMpFkrNhG868xXVYi03/6v1Ex1ceykL40TTkMw/ChKOdITyNNCISUo0nxnARDKzKyITLDHRJrOqCcFdPHkZOhd116m7d5e1xk0ZRwVO4BTOwYUraEATWtAGAhk8wyu8WU/Wi/VufcxbV6xy5gj+yPr8AcLRlyU=</latexit>

<latexit sha1_base64="/iLw1HnvJ/l+BEqnP98znn+iEjQ=">AAACAHicbZDLSsNAFIZPvNZ6i7pw4WawCK5KIoIui266rGIv0IYymU7aoTNJmJkIJWTjq7hxoYhbH8Odb+MkzUJbfxj4+M85zDm/H3OmtON8Wyura+sbm5Wt6vbO7t6+fXDYUVEiCW2TiEey52NFOQtpWzPNaS+WFAuf064/vc3r3UcqFYvCBz2LqSfwOGQBI1gba2gfDwTWEz9Im9kwLViK9D7LhnbNqTuF0DK4JdSgVGtofw1GEUkEDTXhWKm+68TaS7HUjHCaVQeJojEmUzymfYMhFlR5aXFAhs6MM0JBJM0LNSrc3xMpFkrNhG868xXVYi03/6v1Ex1ceykL40TTkMw/ChKOdITyNNCISUo0nxnARDKzKyITLDHRJrOqCcFdPHkZOhd116m7d5e1xk0ZRwVO4BTOwYUraEATWtAGAhk8wyu8WU/Wi/VufcxbV6xy5gj+yPr8AcLRlyU=</latexit>

<latexit sha1_base64="/iLw1HnvJ/l+BEqnP98znn+iEjQ=">AAACAHicbZDLSsNAFIZPvNZ6i7pw4WawCK5KIoIui266rGIv0IYymU7aoTNJmJkIJWTjq7hxoYhbH8Odb+MkzUJbfxj4+M85zDm/H3OmtON8Wyura+sbm5Wt6vbO7t6+fXDYUVEiCW2TiEey52NFOQtpWzPNaS+WFAuf064/vc3r3UcqFYvCBz2LqSfwOGQBI1gba2gfDwTWEz9Im9kwLViK9D7LhnbNqTuF0DK4JdSgVGtofw1GEUkEDTXhWKm+68TaS7HUjHCaVQeJojEmUzymfYMhFlR5aXFAhs6MM0JBJM0LNSrc3xMpFkrNhG868xXVYi03/6v1Ex1ceykL40TTkMw/ChKOdITyNNCISUo0nxnARDKzKyITLDHRJrOqCcFdPHkZOhd116m7d5e1xk0ZRwVO4BTOwYUraEATWtAGAhk8wyu8WU/Wi/VufcxbV6xy5gj+yPr8AcLRlyU=</latexit>

Depth = 2
P

<latexit sha1_base64="/iLw1HnvJ/l+BEqnP98znn+iEjQ=">AAACAHicbZDLSsNAFIZPvNZ6i7pw4WawCK5KIoIui266rGIv0IYymU7aoTNJmJkIJWTjq7hxoYhbH8Odb+MkzUJbfxj4+M85zDm/H3OmtON8Wyura+sbm5Wt6vbO7t6+fXDYUVEiCW2TiEey52NFOQtpWzPNaS+WFAuf064/vc3r3UcqFYvCBz2LqSfwOGQBI1gba2gfDwTWEz9Im9kwLViK9D7LhnbNqTuF0DK4JdSgVGtofw1GEUkEDTXhWKm+68TaS7HUjHCaVQeJojEmUzymfYMhFlR5aXFAhs6MM0JBJM0LNSrc3xMpFkrNhG868xXVYi03/6v1Ex1ceykL40TTkMw/ChKOdITyNNCISUo0nxnARDKzKyITLDHRJrOqCcFdPHkZOhd116m7d5e1xk0ZRwVO4BTOwYUraEATWtAGAhk8wyu8WU/Wi/VufcxbV6xy5gj+yPr8AcLRlyU=</latexit>

HR

<latexit sha1_base64="wQ8uT5ovMygTQhGsvJv0/n8Iz7s=">AAACAHicbZDLSsNAFIZPvNZ6i7pw4WawCK5KIoIui27qroK9QBvKZDpph84kYWYilJCNr+LGhSJufQx3vo2TNAtt/WHg4z/nMOf8fsyZ0o7zba2srq1vbFa2qts7u3v79sFhR0WJJLRNIh7Jno8V5Sykbc00p71YUix8Trv+9Davdx+pVCwKH/Qspp7A45AFjGBtrKF9PBBYT/wgbWbDtGAp0rssG9o1p+4UQsvgllCDUq
sha1_base64="hP+6LrUf2d3tZaldqaQQvEKMXyw=">AAAB2XicbZDNSgMxFIXv1L86Vq1rN8EiuCozbnQpuHFZwbZCO5RM5k4bmskMyR2hDH0BF25EfC93vo3pz0JbDwQ+zknIvSculLQUBN9ebWd3b/+gfugfNfzjk9Nmo2fz0gjsilzl5jnmFpXU2CVJCp8LgzyLFfbj6f0i77+gsTLXTzQrMMr4WMtUCk7O6oyaraAdLMW2IVxDC9YaNb+GSS7KDDUJxa0dhEFBUcUNSaFw7g9LiwUXUz7GgUPNM7RRtRxzzi6dk7A0N+5oYkv394uKZ9bOstjdzDhN7Ga2MP/LBiWlt1EldVESarH6KC0Vo5wtdmaJNChIzRxwYaSblYkJN1yQa8Z3HYSbG29D77odBu3wMYA6nMMFXEEIN3AHD9CBLghI4BXevYn35n2suqp569LO4I+8zx84xIo4</latexit>
sha1_base64="6ks2VDEP4juoXx3msEOTzysJOPM=">AAAB9XicbZBPS8MwGMbf+nfOqdWLBy/BIXgarRc9Cl7mbYL7A1spaZZuYUlaklQYpRe/ihcPivhVvPltTLsddPOBwI/nScj7PlHKmTae9+1sbG5t7+zW9ur7jYPDI/e40dNJpgjtkoQnahBhTTmTtGuY4XSQKopFxGk/mt2Vef+JKs0S+WjmKQ0EnkgWM4KNtUL3dCSwmUZx3i7CvGIl8vuiCN2m1/IqoXXwl9CEpTqh+zUaJyQTVBrCsdZD30tNkGNlGOG0qI8yTVNMZnhChxYlFlQHebVAgS6sM0ZxouyRBlXu7xc5FlrPRWRvliPq1aw0/8uGmYlvgpzJNDNUksVHccaRSVDZBhozRYnhcwuYKGZnRWSKFSbGdla3JfirK69D76rley3/wYManME5XIIP13ALbehAFwgU8AJv8O48O6/Ox6KuDWfZ2wn8kfP5AzVllbE=</latexit>
sha1_base64="6W7rI9fsDJI6B5EZRw3rsBp4oUA=">AAACAHicbZC7TsMwFIZPyq2UW4GBgSWiQmKqEhYYK1jKViR6kdooclyntWo7ke0gVVEWXoWFAYRYeQw23gYnzQAtv2Tp03/Okc/5g5hRpR3n26qsrW9sblW3azu7e/sH9cOjnooSiUkXRyySgwApwqggXU01I4NYEsQDRvrB7Dav9x+JVDQSD3oeE4+jiaAhxUgby6+fjDjS0yBM25mfFix5epdlfr3hNJ1C9iq4JTSgVMevf43GEU44ERozpNTQdWLtpUhqihnJaqNEkRjhGZqQoUGBOFFeWhyQ2efGGdthJM0T2i7c3xMp4krNeWA68xXVci03/6sNEx1eeykVcaKJwIuPwoTZOrLzNOwxlQRrNjeAsKRmVxtPkURYm8xqJgR3+eRV6F02Xafp3juN1k0ZRxVO4QwuwIUraEEbOtAFDBk8wyu8WU/Wi/VufSxaK1Y5cwx/ZH3+ALPblxg=</latexit>
sha1_base64="wQ8uT5ovMygTQhGsvJv0/n8Iz7s=">AAACAHicbZDLSsNAFIZPvNZ6i7pw4WawCK5KIoIui27qroK9QBvKZDpph84kYWYilJCNr+LGhSJufQx3vo2TNAtt/WHg4z/nMOf8fsyZ0o7zba2srq1vbFa2qts7u3v79sFhR0WJJLRNIh7Jno8V5Sykbc00p71YUix8Trv+9Davdx+pVCwKH/Qspp7A45AFjGBtrKF9PBBYT/wgbWbDtGAp0rssG9o1p+4UQsvgllCDUq2h/TUYRSQRNNSEY6X6rhNrL8VSM8JpVh0kisaYTPGY9g2GWFDlpcUBGTozzggFkTQv1Khwf0+kWCg1E77pzFdUi7Xc/K/WT3Rw7aUsjBNNQzL/KEg40hHK00AjJinRfGYAE8nMrohMsMREm8yqJgR38eRl6FzUXafu3l/WGjdlHBU4gVM4BxeuoAFNaEEbCGTwDK/wZj1ZL9a79TFvXbHKmSP4I+vzB7Ublxw=</latexit>

PR

R

m

GR

G

Depth = 1

Depth = 1

U e
de = 1 and
padd ng = va d”

P ⌦ GR

+v

yR

P⌦ G

+v

y

Pred c ed
probab es
N ⇥ 1 vec or

2M ⇥ 1

No e aye

vec o

Emu a es 2D CCS based compressed channe sens ng

Beam pred c on

F g 3 Channe measu emen s n 2D CCS a e ea zed us ng convo u ona fi e s PR and P Us ng end o end ea n ng he base ma x n
2D CCS e P = PR + P s op m zed o max m ze he p obab y o beam a gnmen us ng he comp essed channe measu emen s

m

m

a Beam pa e n be o e quan za on

12
Ach evab e a e bps Hz

Beam pa e ow

Beam pa e ow

s sca ed so ha kHkF = N Fo he es se howeve we use
a common sca ng o a he channe s such ha E kHk2F = N 2
He e E deno es he ave age ac oss he es channe s The channe s
a e hen es uc u ed acco d ng o he p ocedu e n Sec on 3 1

10
8
6
4
2
0

m

m

b Beam pa e n a e quan za on

F g 4 The p o shows he 2D DFT magn ude o he base ma ces
op m zed w h ou p ocedu e o M = 10 We gh quan za on
s gh y pe u bs he beam pa e n The beams n op m zed 2D CCS
ad a e powe a ong he d ec ons ha a e mo e ke y o be op ma
We exp a n how ou ne wo k s a ned and p ov de ns gh s
n o he op m zed base ma x Fo M channe measu emen s ou
me hod fi s samp es M d s nc 2D n ege coo d na es om an N ×
N g d a andom and cons uc s he subsamp ng se Ω The N × N
n ege g d co esponds o he suppo o G n 2 Then he p o
posed deep neu a ne wo k s a ned o 30 epochs w h he es uc
u ed channe s and he assoc a ed c ass abe s om he a n ng se
A good base ma x s one whose beam pa e n has a a ge mag
n ude a ong he d ec ons ha a e mo e ke y o be op ma A
d sc e e ve s on o h s beam pa e n s he 2D DFT o he base ma
x Fo he scena o co espond ng o F g 2a he 2D DFT o he
op m zed base ma x de ved a e a n ng s shown n F g 4a A
3 b phase quan za on s pe o med ove he op m zed base ma
x o ob a n Pquan he 2D DFT o Pquan s shown n F g 4b
can be obse ved ha he beam pa e n co espond ng o Pquan s
we ma ched o he beamspace p o n F g 2a As quan za on can
owe he beam p ed c on accu acy o he a ned ne wo k he ou
u y connec ed aye s n ou ne wo k a e e a ned w h 30 epochs
We eva ua e he p oposed deep ea n ng based 2D CCS ech
n que n e ms o he ach evab e a e ove he es da ase The 2M ×
1 comp essed channe measu emen vec o a e subsamp ed convo
u on w h Pquan s pe u bed by AWGN o va ance σ 2 /2 The
SNR obse ved a he RX when he TX uses a quas omn d ec ona
pa e n s defined as 1/σ 2 As we ocus on beam a gnmen us ng he
2D DFT codebook he SNR a e beam o m ng can be exp essed n
e ms o he 2D DFT o he channe e X The SNR a he RX
when he TX app es he (i j) h e emen o he 2D DFT codebook s
SNRBF = X(i j) 2 /σ 2 The ach evab e a e co espond ng o h s
SNR s og2 (1+SNRBF ) Fo eve y channe he exhaus ve sea ch

Deep ea n ng M = 10
CS w h a andom ma x M = 10
CS w h a andom ma x M = 20
CS w h a andom ma x M = 40
Exhau ve beam ea h

20

15

10

5

0 5
SNR dB

10

15

20

F g 5 Deep ea n ng based beam a gnmen w h an op m zed base
ma x pe o ms be e han s anda d CS w h a andom phase sh
based des gn The p oposed app oach can educe he a n ng ove
head by 4× when compa ed o s anda d CS

based app oach finds he op ma beam ndex (iop jop ) whe e X
ach eves s max mum Fo he p oposed deep ea n ng based ap
p oach he ndex co espond ng o he p ed c ed beam s used o
compu e he a e We compa e ou a go hm w h CS based beam
a gnmen ha uses a andom phase sh based des gn
The ach evab e a e p o n F g 5 nd ca es ha ou deep
ea n ng based app oach esu s n easonab e beam a gnmen w h
us M = 10 channe measu emen s S anda d CS w h a andom
phase sh based des gn howeve equ es abou M = 40 channe
measu emen s o ach eve compa ab e pe o mance
can be ob
se ved om F g 4b ha he beams co espond ng o ou s uc u ed
CS a n ng ocus powe n a sma se o d ec ons ha a e mo e
ke y o be op ma Such beams esu n a h ghe SNR n he
comp essed channe measu emen s wh ch ans a es o be e beam
a gnmen pe o mance
5 CONCLUSIONS AND FUTURE WORK
n h s pape we deve oped a nove app oach o comp ess ve beam
a gnmen w h m me e wave phased a ays Ou me hod s
based on a s uc u ed comp essed sens ng echn que ca ed 2D
convo u ona comp essed sens ng Any CS ma x n 2D CCS
can be pa ame e zed by a base ma x and a subsamp ng se
We showed how deep ea n ng can be used as a oo o op m ze
he base ma x n 2D CCS The op m zed base ma x esu ed
n a phased a ay compa b e s uc u ed andom CS ma x wh ch
ach eved supe o beam a gnmen han he common andom phase
sh based des gn n ou u u e wo k we w deve op ow com
p ex y echn ques o beam p ed c on and a so ex end ou app oach
o w deband channe es ma on w h mmWave phased a ays

6. REFERENCES
[1] R. W. Heath, N. Gonzalez-Prelcic, S. Rangan, W. Roh, and
A. M. Sayeed, “An overview of signal processing techniques
for millimeter wave MIMO systems,” IEEE J. Sel. Topics Signal Process., vol. 10, no. 3, pp. 436–453, 2016.
[2] T. Nitsche, C. Cordeiro, A. B. Flores, E. W. Knightly, E. Perahia, and J. C. Widmer, “IEEE 802.11 ad: directional 60
GHz communication for multi-gigabit-per-second wi-fi,” IEEE
Commun. Mag., vol. 52, no. 12, pp. 132–141, 2014.
[3] E. J. Candès and M. B. Wakin, “An introduction to compressive
sampling,” IEEE Signal Process. Mag., vol. 25, no. 2, pp. 21–
30, 2008.
[4] Z. Marzi, D. Ramasamy, and U. Madhow, “Compressive channel estimation and tracking for large arrays in mm-wave picocells,” IEEE J. Sel. Topics Signal Process., vol. 10, no. 3, pp.
514–527, 2016.
[5] J. Rodrı́guez-Fernández, N. González-Prelcic, K. Venugopal,
and R. W. Heath, “Frequency-domain compressive channel estimation for frequency-selective hybrid millimeter wave
MIMO systems,” IEEE Trans. on Wireless Commun., vol. 17,
no. 5, pp. 2946–2960, 2018.
[6] N. J. Myers, A. Mezghani, and R. W. Heath Jr, “FALP:
fast beam alignment in mmWave systems with low-resolution
phase shifters,” IEEE Trans. Commun., 2019.
[7] K. Li, L. Gan, and C. Ling, “Convolutional compressed sensing
using deterministic sequences,” IEEE Trans. Signal Process.,
vol. 61, no. 3, pp. 740–752, 2013.

[8] Y. Wang, A. Klautau, M. Ribero, A. C. Soong, and R. W.
Heath, “MmWave vehicular beam selection with situational
awareness using machine learning,” IEEE Access, vol. 7, pp.
87 479–87 493, 2019.
[9] A. Ali, N. González-Prelcic, and R. W. Heath, “Millimeter
wave beam-selection using out-of-band spatial information,”
IEEE Trans. on Wireless Commun., vol. 17, no. 2, pp. 1038–
1052, 2017.
[10] X. Lu, W. Dong, P. Wang, G. Shi, and X. Xie, “Convcsnet: A
convolutional compressive sensing framework based on deep
learning,” arXiv preprint arXiv:1801.10342, 2018.
[11] X. Li and A. Alkhateeb, “Deep learning for direct hybrid precoding in millimeter wave massive MIMO systems,” arXiv
preprint arXiv:1905.13212, 2019.
[12] A. C. Kak and M. Slaney, Principles of computerized tomographic imaging. IEEE press, 1998.
[13] N. J. Myers and Y. Wang, “Deep learning-based beam alignment for structured channels,” https://github.com/nitinjmyers,
2019.
[14] S. Han, H. Mao, and W. J. Dally, “Deep compression: Compressing deep neural networks with pruning,
trained quantization and huffman coding,” arXiv preprint
arXiv:1510.00149, 2015.
[15] “Remcom wireless
wireless-insite.

insite,”

http://www.remcom.com/

