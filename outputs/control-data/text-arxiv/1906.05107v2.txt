arXiv:1906.05107v2 [math.AP] 19 Sep 2019

LONG TIME BEHAVIOR OF THE SOLUTIONS OF NLW
ON THE D-DIMENSIONAL TORUS
JOACKIM BERNIER, ERWAN FAOU, AND BENOÎT GRÉBERT
Abstract. We consider the non linear wave equation (NLW) on the
d-dimensional torus Td with a smooth nonlinearity of order at least two
at the origin. We prove that, for almost any mass, small and smooth solutions of high Sobolev indices are stable up to arbitrary long times with
respect to the size of the initial data. To prove this result we use a normal form transformation decomposing the dynamics into low and high
frequencies with weak interactions. While the low part of the dynamics
can be put under classical Birkhoff normal form, the high modes evolve
according to a time dependent linear Hamiltonian system. We then control the global dynamics by using polynomial growth estimates for high
modes and the preservation of Sobolev norms for the low modes. Our
general strategy applies to any semi-linear Hamiltonian PDEs whose
linear frequencies satisfy a very general non resonance condition. The
(NLW) equation on Td is a good example since the standard Birkhoff
normal form applies only when d = 1 while our strategy applies in any
dimension.

Contents
1. Introduction
Acknowledgement
2. Abstract statement
2.1. Hamiltonian formalism
2.2. Polynomial Hamiltonians
2.3. Non resonance condition
2.4. Statement
3. Application to (NLW) on Td .
4. Normal form
5. Proof of the main Theorem
References

2
5
6
6
7
9
9
11
12
16
22

2000 Mathematics Subject Classification. 35L05, 37K55, 35B40, 35Q55.
Key words and phrases. Wave equation, Birkhoff normal form, Resonances, Hamiltonian PDEs.
1

2

JOACKIM BERNIER, ERWAN FAOU, AND BENOÎT GRÉBERT

1. Introduction
Let us consider the nonlinear wave equation set on the d-dimensonal torus
Td = (R/2πZ)d with d ≥ 1,
utt − ∆u + mu + f (u) = 0,

x ∈ Td ,

(NLW)

satisfied by a real valued function u(t, x) with given initial data u(0) ≡ u(0, ·)
and u̇(0) ≡ u̇(0, ·) = ∂t u(0, ·). The function f ∈ C ∞ (R, R) is at least of order
2 at the origin, i.e. f (0) = f ′ (0) = 0. For small and smooth initial data
u(0) ∈ H s (Td ) and u̇(0) ∈ H s−1 (Td ) with large s, we are interested in a
description of the long time behavior of u(t) ≡ u(t, ·) solution of (NLW).
In dimension d = 1, it is known that if ε measures the size of the initial
data, the solution is controlled for arbitrary polynomial times with respect
to ε, and for almost all m away from zero. More precisely, it has been proved
(see for instance [BG06] and also [Bam03])
Theorem 1.1. ([BG06]) Let d = 1 and r ≥ 2. For almost any m > 0 there
exists s∗ (r) such that for s > s∗ (r) there exists ε0 (r, s) > 0 such that for all
ε < ε0
k(u(0), u̇(0))k H s ×H s−1 ≤ ε

=⇒ k(u(t), u̇(t))k H s ×H s−1 ≤ 2ε,

t ≤ ε−r .
(1)

The crucial tool to obtain this result
p is to show that for a large set of
parameters m, the frequencies ωj = |j|2 + m of the linear wave operator
satisfy a non-resonance condition of the following form:
Fix r ≥ 3, there exists γ > 0 such that for k = (k1 , · · · , kp ) ∈ (Zd )p ,
ℓ = (ℓ1 , · · · , ℓq ) ∈ (Zd )q with p + q ≤ r we have
γ
,
(µ3 )
|ωk1 + · · · + ωkp − ωℓ1 − · · · − ωℓq | ≥
µ3 (k, ℓ)α
unless (|k1 |, · · · , |kp |) and (|ℓ1 |, · · · , |ℓq |) are equal up to a permutation,
and where µ3 (k, ℓ) denotes the third largest number amongst the collection (|ki |, |ℓj |)i,j , and α depends on r.
This condition, introduced in [BG06], allows to eliminate (or normalize) all
the terms in the Hamiltonian of the perturbation (depending on F , a primitive of f in (NLW)) involving at most two high Fourier modes via a Birkhoff
normal form procedure. On the other hand, it is known since [Bam03] that
we can neglect all the monomials involving more than three high modes (see
for instance [Gre07] or [Bam07] for a simple presentation of these two facts).
So once we have (µ3 ) we can expect a control of the Sobolev norms similar
to (1).
Notice that (µ3 ) is close from the so-called second-order Melnikov nonresonance condition1 that says in a formulation allowing comparison with
1This terminology refers to the original papers [Mel65, Mel68] where similar conditions
where introduced for proving the stability of low-dimensional invariant tori in Hamiltonian
dynamics, and popularized in the KAM literature [Mos67, Eli88, Bou97, XY01] and later
while extending these results to Hamiltonian PDEs [Kuk93, Pös96].

LONG TIME BEHAVIOR OF NLW

3

(µ3 ):
Fix n ≥ 2, there exists γ > 0 such that for k = (k1 , · · · , kp ) ∈ (Zd )p ,
ℓ = (ℓ1 , · · · , ℓq ) ∈ (Zd )q with |ki |, |ℓi | ≤ n and for (j1 , j2 ) ∈ (Zd )2 with
|j1 |, |j2 | > n
γ
|ωk1 + · · · + ωkp − ωℓ1 − · · · − ωℓq + ωj1 − ωj2 | ≥ α ,
r
unless (|k1 |, · · · , |kp |) and (|ℓ1 |, · · · , |ℓq |) are equal up to a permutation,
where r = p + q.
We note that in the Melnikov case, the “length” of the resonance (r + 2) is
free but the number of “interior” modes (here (2n + 1)d ) is fixed while it is
exactly the converse in (µ3 ). So the two conditions are not equivalent but
similar.
The condition (µ3 ) applies to many situations, including the one dimensional wave equations, the one dimensional nonlinear Schrödinger equation
with an external potential [Bam03, Bam07, BG06], the d-dimensional nonlinear Schrödinger equation with a convolution potential [BG03, BG06],
plane waves stability for non-linear Schrödinger equation [FGL13], wave
equations on Zoll manifolds [BDGS07] or quantum harmonic oscillator on
Rd [GIP09].
The main difficulty of the higher dimensional case for (NLW) is that
the frequencies do not satisfy the second-order Melnikov condition for a
large set of parameters m, as already noted for instance in [Bou95, Del09].
In fact, in dimension d ≥ 2 (µ3 ) is not satisfied either: let for instance
|k1 | ≥ |ℓ1 | ≥ µ3 (k, ℓ) then in the left hand side of (µ3 ) the quantity ωk1 − ωℓ1
depends on indices that are not controlled by µ3 (k, ℓ). For d = 1, if k1 and ℓ1
are large, the difference ωk1 − ωℓ1 is close to be an integer and the parameter
m can be chosen in a large set so that (µ3 ) holds. However, in dimension
d ≥ 2, ωk1 − ωℓ1 describes a dense set at the scale |k1 | which prevents (µ3 )
to hold. Actually we can only prove that for a large set of parameters m,
the following condition (which is related to the so-called first-order Melnikov
condition) holds
γ
(µ2 )
|ωk1 + · · · + ωkp − ωℓ1 − · · · − ωℓq | ≥
µ2 (k, ℓ)α
unless (|k1 |, · · · , |kp |) are (|ℓ1 |, · · · , |ℓq |) equal up to a permutation where
µ2 (k, ℓ) is the second largest index in the multi-index (k, ℓ).
Despite this known problem, some results have been proved concerning
the existence of quasi-periodic solutions, where the loss of derivative is controlled by the use of KAM-Newton schemes, see [Bou95]. Concerning the
control of large open sets of solutions, some results can be found in [DS06]
and [Del09] but the time control depends on the shape on the nonlinearity inducing restriction on the index r (essentially driven by the annulation
degree of the nonlinearity in 0).
Another situation where (µ2 ) appears in a natural way is given by numerical discretization of Hamiltonian PDEs. For example standard splitting

4

JOACKIM BERNIER, ERWAN FAOU, AND BENOÎT GRÉBERT

methods applied to wave equations in dimension d = 1 induces numerical
resonances destroying the property (µ3 ) and degenerating to (µ2 ) even for
generic time discretization parameters2. In this case, it is however possible
to control the solution by playing with the time integrator or with the space
discretization, see [CHL08, FGP10a, FGP10b, Fao12, FGL14].
In this paper, we propose a new method to overcome this difficulty by
a careful examination of the normal form induced by (µ2 ) and a control
in mixed Sobolev norm inspired by some tools used in numerical analysis.
In particular it can be seen as a nonlinear extension of [DF07], here in a
continuous in time setting.
As byproduct of this method, we prove the following.
Theorem 1.2. Let d ≥ 2, r ≥ 2 and s > d/2. For almost any m > 0 there
exists s∗ = s∗ (r, s) and ε0 (r, s) > 0 such that for all ε < ε0 the solution to
(NLW) satisfies
k(u(0), u̇(0))k H s∗ ×H s∗ −1 ≤ ε

=⇒ k(u(t), u̇(t))k H s ×H s−1 ≤ 2ε,

t ≤ ε−r .
(2)

In other words, (1) holds up to a finite loss of derivative in the initial
condition3. Concretely we can prove that s∗ (r, s) is of order less than O(r 5 s5 )
but this is certainly not optimal.
The previous property (2) is in fact a corollary of a stronger abstract result
proved in Theorem 2.9. The main idea is to decompose the dynamics into
low and high frequencies according to some large threshold depending on ε,
and then to try to conjugate the system to a normal form whose dynamics
can be described and controlled.
When the (µ3 ) condition holds, this normal form approach allows to conjugate all the (NLW) flow to a flow preserving the H s norm up to terms that
are arbitrarily small. When only (µ2 ) is satisfied, this cannot be done, and
linear terms remains in the dynamics of high modes, coupled with the low
modes. Fortunately, these terms can be put under a symmetric Hamiltonian quadratic form. Hence, despite the linear nature of their dynamics, the
L2 norm of the high modes can be proved to be preserved over long times
in the normal form analysis. This crucial information allows to initiate an
effective decomposition between low and high modes. To prove the almost
preservation of higher Sobolev norms of the high modes we use a sort of
pseudo-differential argument (or commutator Lemma) that allows to gain
one derivative (see (49) and (50)). Then for given indices s and s0 with
s ≫ s0 > d/2, we can control the low modes in a Sobolev norm H s and
2The fundamental reason is that time discrete numerical schemes require the control of

small divisors of the form eihΩ(k,ℓ) − 1 instead of Ω(k, ℓ) as defined in (µ3 ), where h is the
time discretization parameter. Hence numerical resonances can occurs when for instance
h(ωk1 − ωℓ1 ) is close to an arbitrary large multiple of 2π (see for instance [Sha00, HLW06]
for a finite dimensional analysis of symplectic integrators).
3Historically, a similar result with loss of derivative was first given under the condition
(µ3 ) in [Bou96].

LONG TIME BEHAVIOR OF NLW

5

we show a polynomial growth in time of a Sobolev norm H s0 of the high
modes of order O(ts0 ). By choosing a smoother initial condition such that
k(u(0), u̇(0))k H 2s ×H 2s−1 ≤ ε we then obtain (see Theorem 3.2)
ku(t)≤Nε k H s ≤ 2ε

and ku(t)>Nε k H s0 ≤ εr ,

r
0 +1

−s

t≤ε

,

(3)

in a regime where s − s0 is large with respect to r. Here u(t)≤Nε and
u(t)>Nε denote the low and high modes parts, according to the threshold
− r
Nε = ε s−s0 . When s is large, we obtain (2) after a change of indices,
but Theorem 3.2 (see also Theorem 2.9) gives more precise informations. It
shows that the dynamics
preserves the super-actions4, i.e.
Pof the low modes
2
the quantities Jn (t) = |k|=n |uk (t)| , n ≤ Nε over very long times, where
uk (t), k ∈ Zd denote the Fourier coefficients of u(t). Such a result does not
hold for high modes since the interaction between two close large modes
cannot be eliminated but only controlled. Theorem 2.9 expresses the fact
that the condition (µ2 ) -much more general than (µ3 )- is enough to ensure
a decoupling of the dynamics of low and high modes for very long times.
In the previous estimate, s0 has only to satisfy the condition5 s0 > d/2.
It also typically corresponds to what is numerically observed for initial data
taken as trigonometric polynomials6 for which the dynamics does not exhibit energy exchanges over long times. Such two-stage norms with different
Sobolev scaling were previously used in the context of numerical analysis of
splitting methods for Schrödinger equations in the linear case, see [DF07]
and [DF09] where again the preservation of the L2 norm of the high-modes
was crucial to obtain a global control of the dynamics.
We also believe that results of the form (2) or (3) involving mixed Sobolev
norms provides a natural setting for numerical discretization, for which (µ2 )
is the generic control of non-resonance condition. It might for instance
allow to weaken the usual CFL conditions required, or to derive low-order
integrators following the analysis of [HS17, OS18].

Acknowledgement. During the preparation of this work the three authors
benefited from the support of the Centre Henri Lebesgue ANR-11-LABX0020-01 and B.G. was supported by ANR -15-CE40-0001-02 “BEKAM” and
ANR-16-CE40-0013 “ISDEEC” of the Agence Nationale de la Recherche.

4Already used in [BG06] for (NLW) in dimension d = 1 in a periodic setting.
5Condition that could probably be refined in the critical case using Galigardo-Nirenberg

inequality.
6Note that in the present result, all the constants depends on the Sobolev indices s and
s0 . An optimization of these constant could be done in an analytic context, following the
technics used in [FG13].

6

JOACKIM BERNIER, ERWAN FAOU, AND BENOÎT GRÉBERT

2. Abstract statement
2.1. Hamiltonian formalism. We recall in this subsection the formalism
used in [Gre07, FG13, BFG] to deal with infinite dimensional Hamiltonians and flows depending on a infinite set of symplectic variables (q, p) =
d
d
(qa , pa )a∈Zd ∈ RZ × RZ equipped with the usual ℓ2s (Zd , R2 ) norm defined7
as
X
2
k(q, p)k s =
hai2s (p2a + qa2 ), hai2 = 1 + |a|2 .
a∈Zd

As explained in [Gre07], for U an open set of ℓ2s , for a function H(q, p) such
that H ∈ C ∞ (U , R), with ℓ2 gradient ∇(q,p)H ∈ C ∞ (U , ℓ2s ), we can define the
flow of a Hamiltonian system
∂H
∂H
(q, p), ṗa = −
(q, p).
(4)
∀ a ∈ Zd , q̇a =
∂pa
∂qa
To easily deal with normal form transformations, it is convenient to use the
d
complex representation (ξa )a∈Zd = ( √12 (qa + ipa ))a∈Zd in CZ equipped with

the ℓ2s (Zd , C) norm. Then with the notations




1
∂
∂
1
∂
∂
∂
∂
=√
=√
−i
+i
and
,
∂ξa
∂pa
∂pa
∂ ξ̄a
2 ∂qa
2 ∂qa
the real Hamiltonian system is equivalent to the complex system,
∂H
¯ =: (XH (ξ, ξ))
¯ a
∀ a ∈ Zd , ξ˙a = −i
(ξ, ξ)
(5)
∂ ξ̄a
¯ ∈ R is a called a real Hamiltonian. The notation
where H(q, p) = H(ξ, ξ)
¯
¯
XH (ξ, ξ) = (XH (ξ, ξ))a∈Zd thus denote the Hamiltonian vector field associ¯ a complex function
ated with the Hamiltonian H. If we associate with (ξ, ξ)
d
ψ on T , through the formula
X
ψ(x) =
ξa eiax ,
(6)
a∈Zd

then the Sobolev norm kψk H s is equivalent to the norm
X
2
kξk s =
hai2s |ξa |2 .
a∈Zd

The symplectic structure is given by
X
X
dqa ∧ dpa = −i
dξa ∧ dξ̄a .
a∈Zd

(7)

a∈Zd

and the Poisson bracket in complex notation reads
X ∂F ∂G
∂F ∂G
.
−
{F, G} = −i
∂ξ
∂ ξ̄a ∂ξa
a ∂ ξ̄a
d
a∈Z

7with the usual notation |a|2 = a2 + · · · + a2 for a = (a , . . . , a ) ∈ Zd .
1
d
1
d

(8)

LONG TIME BEHAVIOR OF NLW

7

Definition 2.1. For a given s > d/2 and a domain U containing 0 in ℓ2s :=
¯ ∈R
ℓ2s (Zd , C), we denote by Hs (U ) the space of real Hamiltonians P (ξ, ξ)
satisfying
P ∈ C ∞ (U , R), and XP ∈ C ∞ (U , ℓ2s ),
where XP is defined in (5). We will use the shortcut F ∈ Hs to indicate
that there exists a domain U containing 0 in ℓ2s such that F ∈ Hs (U ).

Notice that for F and G in Hs the formula (8) is well defined in a neighborhood of 0. With a given Hamiltonian function H ∈ Hs , we associate the
Hamiltonian system (5), and we can naturally defines its flow.
Proposition 2.2. Let s > d/2. Any Hamiltonian in Hs defines a local flow
in ℓ2s which is a symplectic transformation.
2.2. Polynomial Hamiltonians. To algebraically deal with polynomials
¯ we identify CZd × CZd ≃ CU2 ×Zd where U2 = {±1} and
depending on (ξ, ξ),
U2 ×Zd where
¯ = z = (zj )
use the convenient notation (ξ, ξ)
j∈U2 ×Zd ∈ C
(
zj = ξa if δ = 1,
(9)
j = (δ, a) ∈ U2 × Zd =⇒
zj = ξ̄a if δ = −1.
¯ to be
We define the ℓ2s norm of an element z = (ξ, ξ)
X
X
2
2
kzk s :=
hji2s |zj |2 = 2
hai2s |ξa |2 = 2kξk s .
j∈U2 ×Zd

a∈Zd

where for j = (δ, a) ∈ U2 × Zd we set hji2 = hai2 . With this notation, the
Hamiltonian system (5) can be written
ż = XH (z),

¯ a,
where (XH (z))(δ,a) := −iδ(XH (ξ, ξ))

¯ .
z = (ξ, ξ)

¯ denote the vector field in (5). Another way to formulate this
Here XH (ξ, ξ)
¯
notation is to say that with the identification (9), the vector field XH (ξ, ξ)
∂H
is naturally extended as (XH (z))j = −iδ ∂z (z), for j = (δ, a) ∈ U2 × Zd ,
j

where j = (−δ, a).
d m
For k = (k1 , . . . , km ) = (δi , ai )m
i=1 ∈ (U2 × Z ) we denote the momentum
M(k) =

m
X

δi ai ,

i=1

d m
and we define the conjugate k = (−δi , ai )m
i=1 ∈ (U2 × Z ) . We set

Mm = {k ∈ (U2 × Zd )m | M(k) = 0}
the set of zero-momentum multi-indices.
For a given k ∈ Mm we write
zk = zk1 · · · zkm .

(10)

8

JOACKIM BERNIER, ERWAN FAOU, AND BENOÎT GRÉBERT

We also define
Rm = {(δj , aj )m
j=1 ∈ Mm | ∃σ ∈ Sm , ∀j = 1, . . . , m, δj = −δσj

and haj i = haσj i} (11)

the set of resonant multi-indices. Note that by construction if m is odd
then Rm is empty and that if k = (δj , aj )m
j=1 ∈ Rm is associated with a
permutation σ then we have
Y
(12)
ξaj ξ̄aσj .
zk =
1≤j≤m
δj =1

Definition 2.3. We say that P (z) is a homogeneous polynomial of order m
if it can be written
X
(13)
cj zj , with c = (cj )j∈Mm ∈ ℓ∞ (Mm ),
P (z) = P [c](z) =
j∈Mm

and such that the coefficients cj satisfy cj = cj .

Note that the last condition ensures that P is real valued, as the set of
indices are invariant by the application j 7→ j. Following [FG13, BFG] but
in a ℓ2s framework, we get the following Proposition. It turns out to be a
consequence of the more general Lemma 5.1 proved below.
Proposition 2.4. Let s > d/2.
(i) A homogeneous polynomial, P [c], of degree m ≥ 2 belongs to Hs (ℓ2s )
and we have
m−1
¯
kXP [c] (z)k s ≤ (Cs )m kck ℓ∞ kzk s
, z = (ξ, ξ),
(14)
for some constant Cs depending only on s.

(ii) For two homogeneous polynomials, P [c] and P [c′ ], of degree respectively m and n, the Poisson bracket is a homogeneous polynomial of
degree m + n − 2, {P [c], P [c′ ]} = P [c′′ ] and we have the estimate
kc′′ k ℓ∞ ≤ 2mnkck ℓ∞ kc′ k ℓ∞ .

(15)

We end this section with a result concerning Lie transformations. We
recall that to a Hamiltonian function F we associate, if it exists, the Lie
transformation Φ1F which is the time one flow generated by F . This transformation is automatically symplectic.
Lemma 2.5. Assume that s > d/2 and let P = P [c3 ] + · · · + P [cr ], cm ∈
Mm , be a polynomial of order at least 3 at the origin, then for all ν ≤
−1
, the Lie transformation τ = Φ1P is well
κr,s max(kc3 k ℓ∞ , . . . , kcr k ℓ∞ )
2
defined on a ball Bs (0, ν) of ℓs with values in Bs (0, 2ν) and we have
kτ (z) − zk s ≤ Cr,s max kcm k ℓ∞ ν 2 ,
m

∀ z ∈ Bs (0, ν),

(16)

where Cr,s and κr,s are some positive constants depending only on r and s.

LONG TIME BEHAVIOR OF NLW

9

Proof. In view of Proposition 2.4 assertion (i) we deduce from the CauchyLipschitz Theorem that the flow ΦtP is locally well defined on ℓ2s . Furthermore we have for z ∈ Bs (0, ν) and as long as z(t) = ΦtP (z) ∈ B(0, 2ν)
Z t
r
X
t
Cm,s kcm k ℓ∞ |t|(2ν)m−1
kΦP (z) − zk s ≤
kXP (z(w))k s dw ≤
0

m=3

≤ Cr,s |t| max kcm k ℓ∞ ν 2 .
m

Thus we conclude by a bootstrap argument that, taking ν small enough, the
flow is defined for all z ∈ B(0, ν) up to time t = 1 and that z(t) remains in
B(0, 2ν) for t ≤ 1 and satisfies (16).

2.3. Non resonance condition.
Definition 2.6. A family of frequencies ω = {ωa , a ∈ Zd } is non resonant,
if there exist (α(r))r≥1 ∈ (R∗+ )N and (γr )r≥1 ∈ (R∗+ )N , such that for all
r ≥ 1, all N ≥ 1 and all k = (δi , ai )ri=1 ∈ (U2 × Zd )r satisfying hai i ≤ N,
for i = 1, · · · , r, we have
|δ1 ωa1 + · · · + δr ωar | ≥ γr N −α(r) ,

when k ∈
/ Rr ,

(H1)

|δ1 ωa1 + · · · + δr ωar + ωb1 + ωb2 | ≥ γr+2 N −α(r+2) ,

∀hb1 i, hb2 i > N (H3)

|δ1 ωa1 + · · · + δr ωar + ωb | ≥ γr+1 N −α(r+1) , ∀hbi > N with M(k) + b = 0,
(H2)
with

M(k) + b1 + b2 = 0.

We notice that conditions (H1)-(H2) are equivalent to condition (µ2 ) introduced in the introduction while conditions (H1)-(H2)-(H3) are not equivalent to (µ3 ) since in (H3) we are not considering the case where the two
high frequencies have opposite sign.
Remark 2.7. Note that in (H2) using the zero momentum condition (see
(10)), hbi is in fact bounded by rN . Hence (H2) is a trivial consequence of
(H1). Similarly, as in many applications ωa ∼ |a|ν when a → ∞, for some
ν > 0, (H3) is also a consequence of (H1) as we can restrict (H3) to a set of
(b1 , b2 ) that are bounded by C(r)N .
2.4. Statement. Let us start with the following notation: For ξ ∈ ℓ2s and
a given number N , we decompose ξ = ξ≤N + ξ>N where for all j ∈ U2 × Zd ,
(
ξj for hji ≤ N,
and ξ>N = ξ − ξ≤N .
(ξ≤N )j =
0 for hji > N,

Given a function ψ ∈ H s (Td ) with Fourier coefficients ξa , a ∈ Zd , and a number N ≥ 1 the previous decomposition induces naturally the decomposition
ψ = ψ≤N + ψ>N with
X
X
ψ≤N (x) =
ξa eia·x and ψ>N (x) =
ξa eia·x .
hai≤N

hai>N

10

JOACKIM BERNIER, ERWAN FAOU, AND BENOÎT GRÉBERT

Similarly, we note z≥N and z>N the decomposition induced by the notation
(9).
We now make our hypothesis on the Hamiltonian H that we will consider.
Hypothesis 2.8. The Hamiltonian H can be written
X
H = H2 + P =
ωa |ξa |2 + P

(17)

a∈Zd

where ω = (ωa )a∈Zd is a non resonant family of real numbers in the sense of
Definition 2.6, P belongs to Hs for some s > d/2 and P is of order at least
3 at the origin (which means that P and its differentials up to the order 2
vanish at 0).
Note that in general the frequencies ωa will P
not be uniformly bounded with
respect to a, and hence the quadratic part a∈Z ωa |ξa |2 , does not belong
to Hs . Nevertheless it generates a continuous flow which maps ℓ2s into ℓ2s
explicitly given for all time t and for all indices a by ξa (t) = e−iωa t ξa (0).
Furthermore this flow has the group property. By standard arguments (see
for instance [Caz03] and [BFG] in a similar framework), this is enough to
define the local symplectic flow, ż = XH (z), in ℓ2s .
Theorem 2.9. Let H be a Hamiltonian satisfying Hypothesis 2.8. Then for
all r ≥ 2 and all s > s0 > d/2 satisfying
s − s0 ≥ s∗ (r) := 6r 2 α(3r) + 2dr

(18)

there exists ε0 (r, s, s0 , ω) > 0 such that for all ε < ε0 (r, s, s0 , ω) the solution
ξ(t), generated by the flow of H issued from an initial datum ξ(0) ∈ ℓ22s
− r
satisfying kξ(0)k 2s ≤ ε, exists for all time t ≤ ε s0 +1 and satisfies
r
− s−s

∀ hai ≤ Nε := ε
r
0 +1

−s

∀t ≤ ε

0

,

,

X

b∈Zd
hbi=hai

|ξb (t)|2 −

X

b∈Zd
hbi=hai

|ξb (0)|2 ≤ ε3 hai−2s
(19)

and
X

2
hai2s |ξa (t)|2 ≤ 4ε2
=
kξ(t)
k

≤N
ε

s

hai≤Nε
X
2

hai2s0 |ξa (t)|2 ≤ ε2r
=
kξ(t)
k

>N
ε s

0

for

r
0 +1

−s

t≤ε

.

hai>Nε

Note that by playing with the indices, we can obtain the following corollary (in the same vein as Theorem 1.2) which essentially proves that arbitrary high regularity small solutions to (5) are controlled over arbitrary long
times.
Corollary 2.10. Let H be a Hamiltonian satisfying Hypothesis 2.8. For all
r ≥ 2 and s > d/2, there exists s∗ (r, s) and ε0 (r, s, ω) > 0 such that for all

LONG TIME BEHAVIOR OF NLW

11

ε < ε0 (r, s, ω),
kξ(0)k s ≤ ε =⇒ kξ(t)k s ≤ 2ε
∗

for t ≤ ε−r .

Proof. It is a consequence of the previous Theorem by replacing r by r(s0 +
1), s0 by s and assuming that s∗ is large enough with respect to r and s. 
3. Application to (NLW) on Td .
Introducing v = ut ≡ u̇ we rewrite (NLW) as

u̇ = v,
v̇ = −Λ2 u − f (u) ,

(20)

where Λ = (−∆ + m)1/2 and f ∈ C ∞ having a zero of order at least two at
the origin. When m > 0, we can define
1
ψ = √ (Λ1/2 u + iΛ−1/2 v),
(21)
2
and we get that (u, v) ∈ H s (Td , R) × H s−1 (Td , R) is solution of (20) if and
only if ψ ∈ H s+1/2 (Td , C) is solution of



1 −1/2
−1/2 ψ + ψ̄
√
f Λ
.
(22)
iψ̇ = Λψ + √ Λ
2
2

Then, endowing the space L2 (Td , C) with the standard (real) symplectic
structure −idψ ∧ dψ̄ equation (22) reads as a Hamiltonian equation
iψ̇ =

∂H
∂ ψ̄

where H is the hamiltonian function



Z
Z
1
1
−1/2 ψ + ψ̄
√
(Λψ)ψ̄ dx +
F Λ
H(ψ, ψ̄) =
dx,
(2π)d Td
(2π)d Td
2

and F is a primitive of f with respect to the variable u, i.e. f = ∂u F .
The linear operator Λ is diagonal in the complex Fourier basis8 {eia·x }a∈Zd ,
with eigenvalues
p
(23)
ωa = |a|2 + m, a = (a1 , . . . , ad ) ∈ Zd , |a|2 = a21 + · · · a2d .

Decomposing ψ in Fourier variables with Fourier coefficients (ξa )a∈Zd as in
(6), (22) takes the form (5) where the Hamiltonian function H is given by
H = H2 + P with,
X
¯ =
H2 (ξ, ξ)
ωa |ξa |2 ,
a∈Zd

¯ =
P (ξ, ξ)

1
(2π)d


X ξa eia·x + ξ¯a e−ia·x
 dx.
√
F
2ω
a
Td
d

Z



a∈Z

8Here for a = (a , . . . , a ) ∈ Zd and x = (x , . . . x ) ∈ Td we set a·x = a x +· · ·+a x
1
1
1 1
d
d
d d

12

JOACKIM BERNIER, ERWAN FAOU, AND BENOÎT GRÉBERT

As F is smooth, the function P is in Hs and we can define its flow. Finally
(u, v) ∈ H s (Td , R)× H s−1 (Td , R) is a solution of (20) if and only if ξ ∈ ℓ2s−1/2
is a solution of the Hamiltonian system associated with the Hamiltonian H.
In order to apply Theorem 2.9, we need the following result
Proposition 3.1 ([Del09], Theorem 2.1.1). For almost all m ∈ (0, +∞) the
family of frequencies
p
ωa (m) = |a|2 + m, a ∈ Zd
associated with (NLW) is non resonant in the sense of Definition 2.6.

A direct proof of this proposition can also be done by using the arguments
given in [Bam03, EGK16] or [FGL13]. By following these proofs, one can
verify that α(r) is of order O(r 3 ).
As a consequence, Theorem 2.9 applies. By scaling back to the variable
(u, v), we obtain
Theorem 3.2. Let f be a C ∞ function with zero of order at least 2 at
the origin. Then for almost all m ∈ (0, +∞) and for all r ≥ 2, and all
s0 > (d + 1)/2, there exists s1 (r, s0 ) such that for all s ≥ s1 (r, s0 ), there
exists ε0 (r, s0 , s, m) and for all ε < ε0 (r, s0 , s, m), if (u(0), u̇(0)) ∈ H s ×
H s−1 (T) satisfies k(u(0), u̇(0))k H s ×H s−1 ≤ ε, then the system (NLW) admits
−

r

a solution over a time T ≥ ε s0 +1 , and we have

 ku(t)≤Nε k s ≤ 2ε
− r
for t ≤ ε s0 +1
 ku(t)>N k ≤ εr
ε s
0

r
− s−s

where Nε := ε

0

.

Using that α(r) = O(r 3 ) we can verify that s1 (r, s) ≃ (rs)5 . Then Theorem 1.2 is just a reformulation of Corollary 2.10.
4. Normal form
The strategy used to prove Theorem 2.9 is to put the original Hamiltonian
(17) into normal form eliminating most of interactions between the low and
high frequencies. By using Taylor expansion at the origin, the Hamiltonian
H can be written
r
X
X
Pm + Rr+1 , with H2 =
ωa |ξa |2 ,
(24)
H = H2 +
m=3

a∈Zd

where Pm is a homogeneous polynomial of degree m, and where Rr+1 ∈ Hs
is of order r + 1 which means that its differentials vanish up to the order r.
In particular, it is small in the sense that we have
r

kXRr+1 (z)k s ≤ (Cs )r kzk s

for some constant depending only on s and for z small enough in ℓ2s .

(25)

LONG TIME BEHAVIOR OF NLW

13

For j ∈ Mm let us denote by µn (j) the n-th largest number amongst the
collection hji im
i=1 :
µ1 (j) ≥ µ2 (j) ≥ · · · ≥ µm (j).

By convention, we will also set µ0 (j) = +∞.
Let N be a fixed number and let H be a Hamiltonian satisfying Hypothesis
2.8. For a given r we decompose the Hamiltonian H in (24) as follows:
H = H2 +

r
X

(◦)
(i)
(ii)
(iii)
(Pm
+ Pm
+ Pm
+ Pm
) + Rr+1 ,

m=3

where for all m,
(◦)

(◦)

• the polynomial Pm = P [cm ], depends only of low modes:
∀j ∈ Mm ,
(i)

(i)

(c(◦)
m )j 6= 0

=⇒

µ1 (j) ≤ N.

(26)

• Pm = P [cm ] contains only one high mode:
∀j ∈ Mm ,

(ii)

(ii)

(c(i)
m )j 6= 0

=⇒

µ1 (j) > N ≥ µ2 (j),

(27)

• Pm = P [cm ] contains only two high modes:
∀j ∈ Mm ,
(iii)

• and Pm

(c(ii)
m )j 6= 0

=⇒

(iii)

µ2 (j) > N ≥ µ3 (j),

(28)

= P [cm ] contains at least three high modes:

∀j ∈ Mm ,

(iii)
(cm
)j 6= 0

=⇒

µ3 (j) > N.

(29)
(iii)

Following [BG06], we know that polynomials of the form Pm
are already small in the sense that

(iii)

= P [cm ]

kXP (iii) k s ≤ CN −s kzkm−1
.
s
m

On the other hand, thanks to our non resonance condition, polynomials of
(i)
(i)
the form Pm = P [cm ] can be killed by a symplectic change of variables
since it cannot be resonant (only one high mode) and polynomials of the
(◦)
(◦)
form Pm = P [cm ] can be normalized by a standard Birkhoff normal form
procedure. In addition to these two known facts, the following Theorem
(ii)
(ii)
says that we can also symmetrize polynomials of the form Pm = P [cm ]:
Theorem 4.1. Assume that the frequencies ω = (ωa )a∈Zd are non resonant
in the sense of Definition 2.6, and let r ≥ 2 be given. There exists a constant C depending on r, such that for all N ≥ 1, there exists a polynomial
Hamiltonian
r
X
(i)
(ii)
(χ(◦)
(30)
χ=
m + χm + χm )
m=3

14

JOACKIM BERNIER, ERWAN FAOU, AND BENOÎT GRÉBERT
(◦)

(◦)

(i)

(i)

(ii)

(ii)

such that χm = P [am ], χm = P [am ], χm = P [am ], contain zero, one and
two high modes respectively (i.e. satisfy (26), (27) and (28) respectively),
with coefficients satisfying
(i)
(ii)
rα(r)
ka(◦)
,
m k ℓ∞ + kam k ℓ∞ + kam k ℓ∞ ≤ CN

(31)

and such that the Lie transformation Φ1χ , whose existence is guaranteed in
a neighborhood of the origin of ℓ2s for all s > d/2 by Lemma 2.5, puts H in
normal form:
H◦
(◦)

Φ1χ

r
X

= H2 +

(◦)
(ii)
(iii)
(Zm
+ Sm
+ P̃m
) + R̃r+1 ,

(32)

m=3
(◦)

(ii)

(ii)

(iii)

(iii)

where Zm = P [bm ], Sm = P [bm ], P̃m = P [bm ], contain zero, two
and at least three high modes respectively (i.e. satisfy (26), (28), (29)), with
coefficients satisfying
(ii)
(iii)
rα(r)
kb(◦)
.
m k ℓ∞ + kbm k ℓ∞ + kbm k ℓ∞ ≤ CN

Moreover
(◦)

• Zm contains only resonant monomials, which means that
∀ j ∈ Mm ,

j∈
/ Rm =⇒

(◦)
(bm
)j = 0.

(ii)

• Sm contains terms that are symmetric in the high modes which
(ii)
means that if bj 6= 0 for j ∈ Mm , the two highest modes are of
opposite signs: they are of the form (δ, a) and (−δ, b) for some a and
b ∈ Zd .
• The remainder term R̃r+1 is of the form
Z 1
1
(1 − s)r+1 P [br+1 ] ◦ Φsχ ds
(33)
R̃r+1 = Rr+1 ◦ Φχ +
0

where P [br+1 ] defines a homogeneous polynomial of order r + 1 with
coefficients bounded by kbr+1 k ℓ∞ ≤ CN rα(r) .
Proof. The proof is standard and use the non resonant Birkhoff normal form
procedure (see [BG06, BDGS07, Gre07]). We follow here the construction
P
made in [FG13]. By using the formal series expansions H = H2 + m≥3 Pm
P
and χ = m≥3 χm in homogeneous polynomials, the formal normal form
problem is to find χ and X (under normal form) such that
X
H ◦ Φ1χ =
adkχ (H2 + P ) = H2 + X.
k≥0

In the formal series algebra, this problem is equivalent to a sequence of
homological equation of the form
∀ m ≥ 3,

{H2 , χm } = Qm − Xm ,

LONG TIME BEHAVIOR OF NLW

15

where Qm depends on the function Pk , χk and Xk , k < m previously constructed. It is obtained by iterated Poisson brackets preserving the homogeneity of polynomial and boundedness of coefficients (see (15)). Formula
for Qm can be found in [FG13],
P Eq. (3.4).
Now assume that Qm = j∈Mm qj zj is given. For a given N we can
decompose it into terms containing zero, one, two and at least three high
(◦)
(i)
(ii)
(iii)
modes: Qm = Qm + Qm + Qm + Qm and a similar decomposition for the
coefficients qj . The normal form term Xm is then the sum of the resonant
(◦)
(◦)
(ii)
terms in Qm (contributing to the term Zm ), the symmetric part of Qm
(iii)
(ii)
(contributing to the term Sm ), and the term Qm (contributing to the
(iii)
term P̃m ). By noting that
{H2 , zk } = iΩ(k)zk

with Ω(k) = −

m
X

k = ((δi , ai ))m
i=1 ∈ Mm ,

δi ωai ,

i=1

we then solve the other terms by setting
(i)

(◦)

χm =

X

j∈Mm \Rm

qj

iΩ(j)

zj +

X

j∈Mm

qj

iΩ(j)

(ii)

zj +

X

j∈Mm \Sm

qj

iΩ(j)

zj ,

where Sm denote the set of indices with two symmetric high modes. Note
that when j ∈ Mm \Sm , the two highest modes (larger that N ) have the
same sign, and the denominator Ω(j) is controlled by (H3). Similarly, the
first term can be controlled using (H1) and the second using (H2). We then
observe that we loose a factor N α(m) after each solution of the homological
equation, yielding a bound of order N rα(r) after r iterations. Note also
that all the operations (solution of the Homological equation and Poisson
brackets) preserve homogeneity and the reality of the global Hamiltonians.
It is easy to see that for all s > s0 for z small enough (such that
Cr,s N rα(r) kzk s ≤ 1 for some constant Cr,s by using (14)) the flow Φ1χ (z) is
well defined and locally invertible in ℓ2s (its inverse being Φ−1
χ ), see Lemma
2.5.
Finally to obtain (32) we use a Taylor expansion of the term H ◦ Φtχ for
t ∈ (0, 1).

For ξ ∈ ℓ2s , we define the pseudo-actions:
¯ =
Ja (ξ, ξ)

X

b∈Zd
hai=hbi

|ξb |2

(and

Jj =

1
2

X

ℓ∈U2 ×Zd
hℓi=hji

|zℓ |2 ,

j ∈ U2 × Zd ). (34)

By definition of the resonant set Rm (see (11)) and the corresponding reso(◦)
nant monomials (see (12)) we see that for all m, the normal form terms Zm

16

JOACKIM BERNIER, ERWAN FAOU, AND BENOÎT GRÉBERT

can be written9
m

(◦)
¯ =
Zm
(ξ, ξ)

X

X

ck zk =

k∈Rm
∀i,hki i≤N

cab
m

a,b∈(Zd ) 2 ,
∀i,hai i=hbi i≤N

2
Y

ξai ξ̄bi ,

¯
z = (ξ, ξ).

i=1

We notice that a polynomials in normal form commutes with all the pseudoactions:
(◦)
{Zm
, Ja } = 0, ∀a ∈ Z,
(35)
(◦)

in such a way the flow generated by Zm will not modify the ℓ2s norms since
P
2
kzk s = (1 + a2 )2s Ja .
5. Proof of the main Theorem

To prove the main Theorem, we will need the following Lemma which
controls polynomial vector fields in mixed Sobolev norms, as high and low
modes are not controled at the same Sobolev scale.
Lemma 5.1. For all s ≥ s0 > d/2, there exists a constant C such that for
all m ≥ 3, for all N ≥ 1 and for all c ∈ ℓ∞ (Mm ), if the polynomials P [c]
contains at least n-th high modes, n = 0, 1, 2, 3 (i.e. cj 6= 0 =⇒ µn (j) > N )
¯ with z≤N ∈ ℓ2 and z>N ∈ ℓ2
then we have for z = (ξ, ξ)
s0
s

m−1
m
if n = 0
 C kck ℓ∞ kz≤N k s
kXP [c] (z)≤N k s ≤
 C m kck N n(s−s0 ) kz k m−n−1 kz k n if n ≥ 1,
>N s
≤N s
ℓ∞
0
(36)
and

0
if n = 0,





m−n−1
if n = 1,
C m kck ℓ∞ N s0 −s kz≤N k s
(37)
kXP [c] (z)>N k s ≤
0




 C m kck kz≤N k m−n kz>N k n−1 if n ≥ 2.
s
s
ℓ∞
0

¯ ∈
Proof. For z = (ξ, ξ)
we have
X
∂P [c]
2
kXP [c] (z)≤N k s ≤
hℓi2s
(z)
∂zℓ
ℓ2s ,

2

hℓi≤N

where
Pℓ (z) = hℓis−s0

X

M(j)=0
µn (j,ℓ)>N

2

≤ m2 kck ℓ∞

X

hℓi≤N

hℓi2s0 Pℓ (z)2 ,

|zj1 | · · · |zjm−1 |.

Let j = (j1 , . . . , jm ) be given such that M(j, ℓ) = 0. We have

hℓis−s0 ≤ (hj1 i + · · · + hjm−1 i)s−s0 ≤ ms−s0 hj1 is−s0 · · · hjm−1 is−s0 .

9Recall that Z (◦) = 0 when m is odd.
m

(38)

LONG TIME BEHAVIOR OF NLW

17

If P [c] contains no high modes, i.e. if n = 0 then we can define z̃j = hjis−s0 zj
and we obtain
X
Pℓ (z) ≤
|z̃j1 | · · · |z̃jm−1 |.
M(j,ℓ)=0
µ1 (j)≤N

R
For a function g on the torus, we will denote ĝb = (1/2π)d Td g(x)e−ib·x dx,
P
b ∈ Zd , the Fourier coefficients of g. Then denoting f (x) = hℓi≤N |z̃ℓ |eiδ a·x
we have
X
m−1 )
|z̃j1 | · · · |z̃jm−1 | = (f[
ℓ = (δ, a) ∈ U2 × Zd
−δa ,
M(j,ℓ)=0
µ1 (j)≤N

for some constant C depending on m. So we get for some generic constant
A depending on s and s0 but independent on m
2
2 X
kXP [c] (z)≤N k s ≤ Ams−s0 +2 kck ℓ∞
hai2s0 |(f m−1 )a |2
=

a∈Zd
2
Ams−s0 +2 kck ℓ∞ kf m−1 k2H s0

2

≤ AC m kck ℓ∞ kf k2m−2
H s0 ,

where kgk H s0 , s0 > d/2 is the usual Sobolev norm on Td equivalent to the
ℓ2s0 norm of the Fourier coefficients of g. Here C depends on s and s0 but not
on m. We then note that kf k H s0 = kz≤N k s which shows the first equation
in (36).
To prove the second in the case n ≥ 1, we simply bound hℓis−s0 by N s−s0
and we obtain
X
m−n g n )
Pℓ (y) ≤ N s−s0
|zj1 | · · · |zjm−1 | = (f \
−δa
M(j,ℓ)=0
µn (j)>N

for ℓ = −δa with the same notation as before, where
X
X
f (x) =
|zℓ |eiδ a·x and g(x) =
|zℓ |eiδ a·x ,
hℓi≤N

hℓi>N

and we conclude as in the previous case.
To show (37) we use
2

2

kXP [c] (z)>N k s ≤ m2 kck ℓ∞
0

X

hℓi>N

hℓi2s0 Pℓ (z)2 ,

where
Pℓ (z) =

X

M(j)=0
µn (j,ℓ)>N

|zj1 | · · · |zjm−1 |,

(39)

In the case n = 1, we have no high mode in the sum. However due to
the zero momentum condition, there exists one mode greater than N/(2m),

18

JOACKIM BERNIER, ERWAN FAOU, AND BENOÎT GRÉBERT

hence with the same notation as before, we have
X
|z̃j1 | · · · |z̃jm−1 |,
Pℓ (z) ≤ AN s0 −s
M(j)=0
µn (j,ℓ)>N

and we conclude as before. The proof of the last estimate in (37) is similar
as the proof of (36) for n ≥ 1 .

Proof of Theorem 2.9. Let ε > 0, s ≥ s0 > d/2 and r be given, and
z(0) ∈ ℓ22s such that kz(0)k 2s ≤ ε. We apply the normal form Theorem (4.1)
at the order 3r and set
− r
N = Nε = ε s−s0 .
Under the hypothesis (18), we have the bound
N 3rα(3r)+d ≤ ε−1/2 .

(40)

◦,
In particular, all the coefficients of the polynomials Hamiltonian χ, Zm
1
(ii)
(iii)
Sm and P̃m in (32) are bounded by CN 3rα(3r) ≤ Cε− 2 . Hence using
Lemma 2.5 we have for ε small enough (in a way depending on r and s) that
5
2
y(0) = Φ−1
χ (z(0)) is in ℓ2s and satisfies ky(0)k 2s ≤ 4 ε.
This implies in particular that ky(0)≤N k s ≤ 54 ε and
X
X
2
ky(0)>N k s =
hji2s0 |yj |2 ≤ N 2s0 −4s
hji4s |yj |2
0

hji>N

hji>N

≤ 4ε2 N 4(s0 −s) ≤ 4ε4r+2 .

Now we need to control the dynamics of y(t) the solution of the Hamiltonian
system associated with the Hamiltonian H ◦ Φ1χ given by (32). We define
T := sup{t > 0 | ky(t)≤N k s ≤ 23 ε

and ky(t)>N k s ≤ εr+1 }.

(41)

0

We notice that ky(0)k 2s ≤ 54 ε < 23 ε and ky(0)>N k s ≤ 2ε2r+1 < εr+1 .
0
Therefore by classical results for the definition of mild solutions of semilinear problems in Sobolev spaces with index greater than d/2, T is strictly
positive.
− r
Let us prove that if t ≤ min(T, ε s0 +1 ) then ky(t)≤N k s ≤ 11
8 ε and ky(t)>N k s ≤
1 r+1
.
2ε

r
0 +1

−s

We will then conclude by a continuity argument that T ≥ ε

.

Control of the transformation. In view of Lemma 5.1, under bootstrap hypothesis, the vector field Xχ (y(t)) satisfies the estimates
3

kXχ (y)≤N k s ≤ CN 3rα(3r) (ε2 + N s−s0 εr+1 ε) ≤ Cε 2

where we used N s−s0 = ε−r , and

3

kXχ (y)≤N k s ≤ CN 3rα(3r) (N s0 −s ε2 + εr+1 ε) ≤ Cεr+ 2 .
0

Hence this shows that as soon as y satisfies the bootstrap hypothesis, i.e.
ky(t)≤N k s ≤ 32 ε and

ky(t)>N k s ≤ εr+1 ,
0

(42)

LONG TIME BEHAVIOR OF NLW

19

we have for ε small enough and for all w ∈ (0, 1)
kΦw
χ (y)≤N k s ≤ 2ε

r+1
and kΦw
.
χ (y)>N k s ≤ 2ε

(43)

0

Now let us write the Hamiltonian (32) as H ◦ Φ1χ = H2 + Z (◦) + S (ii) +
+ R̃3r+1 by gathering together the terms with different homogeneity.

P̃ (iii)

Control of the low modes y(t)≤N . For j ∈ U2 × Zd , let Jj (t) = Jj (y(t)) with
the definition (34). As Z (◦) and H2 commute with Ja for all a ∈ Zd , we have
− r
for t ≤ min(T, ε s0 +1 ) and hji ≤ N ,
hji2s |J˙j | = hji2s |{Jj , H̃}| ≤

X

hℓi=hji

hℓis

∂(S (ii) + P̃ (iii) + R̃3r+1 )
(z) hℓis |yℓ |.
∂yℓ̄

By summing in hji ≤ N , and using Cauchy-Schwarz inequality, we obtain
X
hji2s |J˙j | ≤ kXS (ii) +P̃ (iii) +R̃2r+1 (y)≤N k s ky≤N k s
hji≤N

Now under bootstrap hypothesis (42), we conclude using Lemma 5.1
3

kXS (ii) +P̃ (iii) (y)≤N k s ≤ CN 3rα(3r) N s−s0 ε2r+2 ≤ Cεr+ 2 .
On the other hand since R3r+1 is a Hamiltonian in Hs of order at least
3r + 1, we have using (25), (33) and Lemma 2.5
kXR̃3r+1 (y)≤N k s ≤ CN 3rα(3r) ε3r .
Hence we obtain
X

hji≤N

5
hji2s |J˙j | ≤ C(ε3r+1 + εr+ 2 ).

Therefore for t ≤ min(T, ε−r+1 ) we conclude
X
7
hji2s |Jj (t) − Jj (0)| ≤ ε 2
hji≤N

for ε small enough which in turn implies that
ky(t)≤N k s ≤

11
8 ε.

(44)

Furthermore by using estimates on the vector field Xχ , we deduce that
z(t) = Φ1χ (y(t)) satisfies (19).
Control of the high modes. The Hamiltonian S (ii) can be written as
X
(ii)
¯
Sm
=
Bab (y≤N )ξa ξ̄b , y = (ξ, ξ).
a,b∈Zd
hai>N, hbi>N

20

JOACKIM BERNIER, ERWAN FAOU, AND BENOÎT GRÉBERT

As the Hamiltonian is real we have Bab (y≤N ) = Bba (y≤N ), i.e. the operator
A = (Bab (y≤N )hai,hbi>N acting on ℓ2s (Zd>N ) is Hermitian. Moreover, we have
Bab (y≤N ) =

2r−2
X
m=1

X

bab,j yj

(45)

j∈Mm
µ1 (j)≤N
M(j)=a−b

where the coefficients bab,j are uniformly bounded by CN 3rα(3r) . Hence for
s > d/2 and as soon as y satisfies the bootstrap assumption (42), we obtain
that
∀ hai, hbi > N |Bab (y≤N )| ≤ CN 3rα(3r) ky≤N k s .
(46)
¯ we get
When writing the dynamics of y = (ξ, ξ),
X
ξ˙a = −iωa ξa − i
Bab (y≤N )ξb − iQa (y),
hai > N
b∈Zd

where Qa =

∂
(P̃ (iii)
∂ ξ̄a

+ R̃3r+1 ). Using (37) we have

kQ(y)>N k s ≤ CN 3rα(3r) (ε2r+2 ε + ε3r ).
0

(47)

So using the fact that the operator A is hermitian, we get for t ≤ T (recall
that we assume that ky(0)>N k 0 ≤ ε2r+1 )
3

ky(t)>N k 0 = 2kξ(t)>N k 0 ≤ 2kξ(0)>N k 0 + tCε2r+ 2 ≤ C(1 + t)ε2r+1 . (48)
Let us define D s0 the diagonal operator from ℓ2s (Zd>N ) into ℓ2s−2s0 (Zd>N )
given by
D s0 = diag(hai2s0 , hai > N ).
P
With the notation (η, ξ)>N = hai>N η̄a ξa , we have
d
(ξ, D s0 ξ)>N = −i(ξ, [D s0 , A(t)]ξ)>N + Im(Q(y), D s0 ξ)>N
dt
where [A, B] denotes the commutator of A and B: [A, B] = AB − BA.
Hence by bootstrap hypothesis (and using (47))
5
d
(ξ, D s0 ξ)>N ≤ (ξ, [D s0 , A(t)]ξ)>N + Cε3r+ 2 .
dt

Then we note that using the zero momentum condition (45) we have Bab (t) =
0 when |a − b| > 3rN . Hence, since s0 > 1/2, we have
X
(ξ, [D s0 , A(t)]ξ)>N =
Bab (y)(hai2s0 − hbi2s0 )ξ̄a ξb
hai,hbi≥N
|a−b|≤3rN

≤

X

hai,hbi≥N
|a−b|≤3rN

2r|Bab (t)||hai − hbi|(hai2s0 −1 + hbi2s0 −1 )|ξ̄a ξb |.

LONG TIME BEHAVIOR OF NLW

21

Using the bound (46) and the fact that |hai − hbi| ≤ ha − bi ≤ CN , we get
X
(ξ, [D s0 , A]ξ) ≤ CN 3rα(3r) ε
hais0 −1 hbis0 |ξ̄a ξb |
(49)
hai,hbi≥N
|a−b|≤3rN

where we used that for |a − b| ≤ 3rN we have hai ≤ hbi + 3rN . Now we
apply the Cauchy-Schwarz inequality to get
X
hais0 −1 hbis0 |ξ̄a ξb | ≤
hai,hbi≥N
|a−b|≤3rN






1 

1

2

X

hai,hbi≥N
|a−b|≤3rN

 

hai2s0 −2 |ξ̄a |2 
 

2

X

hai,hbi≥N
|a−b|≤3rN


hbi2s0 |ξb |2 


≤ CN d ky>N k s

0 −1

ky>N k s

0

where we used again that for |a − b| ≤ 3rN we have hai ≤ hbi + 3rN with
a ∈ Zd . Thus, using (40), we obtain

5
d
2
ky(t)>N k s ≤ Cky(t)>N k s −1 ky(t)>N k s + Cε3r+ 2 .
0
0
0
dt
Then, since s0 > 1, applying the Hölder inequality in (50), we get
5
d
2
1/s
2(1−1/s0 )
ky(t)>N k s ≤ Cky(t)>N k 0 0 ky(t)>N k s
+ Cε3r+ 2 .
0
0
dt
Using, in (51), the bound on ky(t)>N k 0 obtained in (48), we get

2r+1
5
d
2
2(1− 1 )
ky(t)>N k s ≤ C(1 + t)1/s0 ε s0 ky(t)>N k s s0 + Cε3r+ 2 .
0
0
dt
We are going to apply the following elementary lemma

(50)

(51)

(52)

Lemma 5.2. Let α ∈ (0, 1), f : R → R+ a continuous function, and x :
R → R+ a differentiable function satisfying the inequality
∀ t ∈ R,
Then we have the estimate
∀ t ∈ R,

d
1
x(t) ≤
f (t)(x(t))α .
dt
1−α
1−α

x(t)

1−α

≤ x(0)

+

Z

t

f (s) ds.

0

Considering (52), we are going to apply Lemma 5.2 with α = 1 − 1/s0
2
1 −1
and x(t) = ky(t)>N k s + ει(s0 ,r) where ι(s0 , r) = (3r + 52 − 2r+1
s0 )(1 − s0 ) .
0
Indeed, x naturally satisfies the estimate
1
2r+1
d
1− 1
x(t) ≤ C(1 + t) s0 ε s0 x(t) s0 .
dt

22

JOACKIM BERNIER, ERWAN FAOU, AND BENOÎT GRÉBERT

Now applying Lemma (5.2), we get
x(t) ≤ Cx(0) + Cε2r+1 (1 + t)s0 +1 .

Since we have assumed that ky(0)>N k s ≤ ε2r+1 and since a straightforward
0
estimate proves that ι(s0 , r) ≥ 2r + 1, we deduce that
ky(t)>N k s ≤ Cε2r+1 (1 + t)s0 +1
0

− (s r+1)
0

and hence for t ≤ min(T, ε

) and ε small enough

1
ky(t)>N ks0 ≤ εr+1 .
(53)
2
Hence combining (44) and (53), we conclude by continuity argument that
− r
T ≥ ε (s0 +1) which finishes the proof.
References
[BFG] J. Bernier, E. Faou and B. Grébert, Rational normal forms and stability of small
solutions to nonlinear Schrödinger equations. arXiv:1812.11414
[Bam99a] D. Bambusi, On long time stability in Hamiltonian perturbations of nonresonant linear PDEs, Nonlinearity 12 (1999), 823–850.
[Bam03] D. Bambusi, Birkhoff normal form for some nonlinear PDEs, Comm. Math.
Physics 234 (2003), 253–283.
[Bam07] D. Bambusi, A Birkhoff normal form theorem for some semilinear PDEs, Hamiltonian Dynamical Systems and Applications, Springer, 2007, pp. 213–247.
[BDGS07] D. Bambusi, J.-M. Delort, B. Grébert, and J. Szeftel, Almost global existence
for Hamiltonian semilinear Klein-Gordon equations with small Cauchy data on Zoll
manifolds, Comm. Pure Appl. Math. 60 (2007), no. 11, 1665–1690.
[BG03] D. Bambusi and B. Grébert, Forme normale pour NLS en dimension quelconque.
C. R. Acad. Sci. Paris, Ser. I 337 (2003) 409–414.
[BG06] Birkhoff normal form for PDE’s with tame modulus. Duke Math. J. 135 no. 3
(2006), 507–567.
[Bou95] J. Bourgain, Construction of periodic solutions of nonlinear wave equations in
higher dimension Geom. Funct. Anal. 5 (1995) 629–639.
[Bou96] J. Bourgain, Construction of approximative and almost-periodic solutions of perturbed linear Schrödinger and wave equations. Geom. Funct. Anal. 6 (1996) 201–230.
[Bou97] J. Bourgain, On Melnikov’s persistency problem, Math. Res. Lett. 4 (1997) 445–
458.
[Caz03] T. Cazenave, Semilinear Schrödinger equations. Courant Lecture Notes in Mathematics, 10. New York University, Courant Institute of Mathematical Sciences, New
York; American Mathematical Society, Providence, RI, 2003.
[CHL08] D. Cohen, E. Hairer, C. Lubich, Conservation of energy, momentum and actions
in numerical discretizations of nonlinear wave equations, Numer. Math. 110 (2008),
113–143.
[DF09] E. Faou and A. Debussche Modified energy for split-step methods applied to the
linear Schrödinger equation. SIAM J. Numer. Anal. 47 (2009) 3705-3719
[Del09] J.-M. Delort On long time existence for small solutions of semi-linear KleinGordon equations on the torus. Journal d’Analyse Mathématiques 107 161–194.
[DS06] J.-M. Delort and J. Szeftel, Long-time existence for semi-linear Klein-Gordon equations with small Cauchy data on Zoll manifolds, Amer. J. Math. 128 (2006), no. 5,
1187–1218.

LONG TIME BEHAVIOR OF NLW

23

[DF07] G. Dujardin and E. Faou, Normal form and long time analysis of splitting schemes
for the linear Schrödinger equation with small potential. Numer. Math. 106 (2007)
223-262
[Eli88] L.H. Eliasson Perturbations of stable invariant tori for Hamimltonian systems,
AAnn. Scuola. Norm. Sup. Pisa Cl. Sci. 15 (1988) 115–147.
[EGK16] L.H. Eliasson, B. Grébert, S. B. Kuksin, KAM for non-linear beam equation,
Geometric And Functional Analysis 26 (2016), 1588–1715.
[Fao12] E Faou. Geometric numerical integration and Schrödinger equations. European
Math. Soc. 2012
[FG13] E. Faou and B. Grébert, A Nekhoroshev-type theorem for the nonlinear
Schrödinger equation on the torus. Analysis & PDE 6 (2013),1243–1262.
[FGP10a] E. Faou, B. Grébert and E. Paturel, Birkhoff normal form for splitting methods
applied to semi linear Hamiltonian PDEs. Part I: Finite dimensional discretization.
Numer. Math. 114 (2010) 429–458
[FGP10b] E. Faou, B. Grébert and E. Paturel Birkhoff normal form for splitting methods
applied to semi linear Hamiltonian PDEs. Part II: Abstract splitting. Numer. Math.
114 (2010) 459–490
[FGL13] E. Faou, L. Gauckler and C. Lubich Sobolev stability of plane wave solutions to
the cubic nonlinear Schrd̈inger equation on a torus, Comm. PDE 38 (2013) 1123-1140
[FGL14] E. Faou, L. Gauckler and C. Lubich Plane wave stability of the split-step Fourier
method for the nonlinear Schrödinger equation Forum of Math. Sigma 2 (2014)
[Gre07] B. Grébert, Birkhoff normal form and Hamiltonian PDEs. Séminaires et Congrès
15 (2007), 1–46.
[GIP09] B. Grébert, R. Imekraz and É. Paturel, Normal forms for semilinear quantum
harmonic oscillators. Commun. Math. Phys. 291 (2009) 763–798.
[Kuk93] S. B. Kuksin, Nearly Integrable Infinite Dimensional Hamiltonian Systems, Lecture Notes in Math., Vol. 1556, Springer, Berlin, 1993.
[HLW06] E. Hairer, C. Lubich and G. Wanner Geometric Numerical Integration,
Structure-Preserving Algorithms for Ordinary Differential Equations. Springer (2006).
[HS17] M. Hofmanová and K. Schratz, An exponential-type integrator for the KdV equation. Numer. Math. 136 (2017) 1117–1137.
[Mel65] V.K. Mel’nikov, On some cases of conservation of conditionally periodic motions
under a small change of the Hamiltonian function, Soviet Mathematics Doklady, 6
(1965) 1592–1596.
[Mel68] V.K. Mel’nikov, A family of conditionally periodic solutions of a Hamiltonian
system, Soviet Mathematics Doklady, 9 (1968), No. 4, 882-885.
[Mos67] J. Moser, Convergent series expansions for quasiperiodic motions, Mathematische
Annalen 169 (1967), 136–176.
[OS18] A. Ostermann and K. Schratz Low regularity exponential-type integrators for semilinear Schrödinger equations. Found. Comput. Math. 18 (2018) 731–755.
[Pös96] J. Pöschel, A KAM-theorem for some nonlinear partial differential equations, Ann.
Scuola. Norm. Sup. Pisa Cl. Sci. 23 (1996) 119–148.
[Sha00] Z. Shang, Resonant and Diophantine step sizes in computing invariant tori of
Hamiltonian systems, Nonlinearity 13 (2000) 299–308.
[XY01] Junxiang Xu and Jiangong You, Persistence of lower-dimensional tori under the
first Melnikov’s non-resonance condition, J. Math. Pures Appl 80 (2001) 1047-1067.

24

JOACKIM BERNIER, ERWAN FAOU, AND BENOÎT GRÉBERT

Univ Rennes, INRIA, CNRS, IRMAR - UMR 6625, F-35000 Rennes, France
E-mail address: Joackim.Bernier@ens-rennes.fr
Univ Rennes, INRIA, CNRS, IRMAR - UMR 6625, F-35000 Rennes, France
E-mail address: Erwan.Faou@inria.fr
Laboratoire de Mathématiques Jean Leray, Université de Nantes, UMR
CNRS 6629, 2, rue de la Houssinière, 44322 Nantes Cedex 03, France
E-mail address: benoit.grebert@univ-nantes.fr

