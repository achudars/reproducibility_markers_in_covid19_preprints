Multimode Fock states with large photon number: effective descriptions and applications in
quantum metrology
M. Perarnau-Llobet,1, 2, ∗ A. González-Tudela,3 and J. I. Cirac1, 2
1

arXiv:1910.03323v2 [quant-ph] 18 Feb 2020

2

Max-Planck-Institut für Quantenoptik, Hans-Kopfermann-Str. 1, D-85748 Garching, Germany
Munich Center for Quantum Science and Technology (MCQST), Schellingstr. 4, D-80799 München
3
Instituto de Fı́sica Fundamental IFF-CSIC, Calle Serrano 113b, Madrid 28006, Spain.
(Dated: February 19, 2020)

We develop general tools to characterise and efficiently compute relevant observables of multimode N -photon
states generated in non-linear decays in one-dimensional waveguides. We then consider optical interferometry in
a Mach-Zender interferometer where a d-mode photonic state enters in each arm of the interferometer. We derive
a simple expression for the Quantum Fisher Information in terms of the average photon number in each mode,
and show that it can be saturated by number-resolved photon measurements that do not distinguish between the
different d modes.
I.

INTRODUCTION

Photonic states with a large and fixed number N of photons
play a crucial role in quantum technologies but are extremely
challenging to prepare experimentally. The paradigmatic example are single-mode Fock states, |N i ∝ (a† )N |0i, where
all the photons share the same spatio-temporal mode (a† ), and
which are the basis of many quantum metrology protocols [1–
4]. Nowadays, the most widely used method to generate them
is based on combining with post-selection heralded single
photons emitted in spontaneous parametric down-conversion
processes [5–9]. This method, however, suffers from an exponential decrease of efficiency with N , hindering its application
for large photon numbers. Single-mode Fock states can also
be emitted naturally from entangled atomic states in ensembles with many more atoms than N [10]. However, exciting
such atomic states is highly non-trivial because of the linear
energy spectrum of such systems [11–14].
A way of circumventing these limitations is the use nonlinear systems for the generation of such photonic states.
These type of systems appear in many different contexts, such
as in cavities with Kerr-type non-linearities [15], in multilevel quantum dots due to biexciton binding-energies [16,
17], or even in atomic ensembles simply because an atom
can not be doubly excited or by exploiting Rydberg blockade [18, 19]. These mechanisms ultimately translate into
either non-harmonic energy splittings (Kerr cavity QED) or
non-harmonic decay rates (saturation), which can be harnessed for multiphoton emission. An illustration of that is
the proposal put forward by us in Ref. [20] to generate multiphoton states with quantum emitters coupled to photonic
waveguides [21–30]. There, N excited emitters interact with
the waveguide in the so-called mirror configuration [28, 31],
such that its dynamics is described by the well-known Dicke
model [32]. In that situation, the emitters experience a nonlinear decay process, known as superradiant decay, which enhances the probability of emitting the photons into the waveguide as compared to other decay channels. Beyond the collective enhancement, the non-linearity has another effect: the

∗

marti.perarnau@mpq.mpg.de

photons released into the waveguide have an inherent multimode structure [13]:
Z Z
dk1 ...dkN
(N )
|φA i = ...
A{k} a†k1 . . . a†kN |0i,
(1)
(2π)N N !
where a†ki is the creation operator of a waveguide photon of
momentum ki . The coefficient A{k} = Ak1 ,k2 ,···kn characterizes the multimodal structure√ of the wavepacket, and
will be non-factorizable (A{k} 6= N !Ak1 · · · Akn ) for photons emitted from any type of non-linear system (e.g., nonharmonic energies or non-linear decay rates). This non-trivial
multimode nature of the emitted wavepackets forces one to
revisit the results derived for single-mode Fock states as they
are not necessarily valid anymore. For example, the multimodal structure poses limits on the scalability as Fock state
sources from spontaneous parametric down conversion processes [33–35], is required to accurately predict the scattering of quantum pulses [36, 37], or, as we showed in our recent manuscript [20], renormalizes the results of single-mode
quantum metrology protocols.
Motivated by these observations, the goal of this article is
to develop general tools to deal with multimode states generated in non-linear decays, both from the point of view of
its characterisation as well as applications in quantum metrology. We start by considering a general N -dimensional emitter
decaying in a non-linear fashion with a waveguide. The wavefunction of the emitted photonic state (given by A{k} in (1))
can be obtained through the techniques of [38], and it involves
N ! terms due to bosonic symmetrisation. Given this highly
non-trivial state, the main contributions of this article are:
1. To develop a framework to compute relevant observables of multimode states generated in non-linear decays in an efficient manner, with the complexity scaling
polynomially with N .
2. To apply these general tools to the characterisation of
Dicke superradiant photonic states where we find that
most photons are contained in a few modes: a single
mode contains 91% of the photons, and two (three)
modes already contain 98.4% (99.6%) of them.
Having identified general properties of multimode states, and
in particular superradiant Dicke states, we then study their po-

2
tential for quantum metrology [1–4]. Building on our previous
work [20], our goal is to extend well known results in quantum optical interferometry [39, 40] to the presence of a nontrivial multimode structure within the input photonic states, as
in Eq. (1). For that, we consider phase estimation in a MachZender interferometer, where the input state of each arm of
the interferometer is a generic d-mode state with a fixed total
photon number. Then, our main contributions are:
1. We show that the quantum Fisher information [41]
(QFI) Q takes the particularly simple form
Q=2

d
X

nj (mj + 1) + mj (nj + 1).

(2)

j=1

where ni , mi are the average photon number in the ith
mode of the two incoming wavepackets.
2. We show that the QFI (2) can be saturated by numberresolved measurements which cannot distinguish between the different d modes.
3. Finally, we also discuss the effect of photon loss in the
interferometer and in the measurement devices given
the proposal of [20] for quantum-enhanced metrology
with twin Dicke superradiant states.
The paper is structured as follows: We start presenting
the general multimode structure of the photons emitted from
non-linear systems into waveguides in Section III, whereas
the tools to characterize such photonic states are developed
in Section III. These tools are applied to superradiant photonic states in Section IV. In Section V we consider quantum
metrology with multimode states, and finally we summarize
our findings in Section VI.

FIG. 1. A the non-linear system (in blue) with N levels with energy
ωn , couples to a 1D waveguide. The coupling with the waveguide
induce single-photon transitions n → n − 1 (in red arrows) at a rate
γn . Around the non-linear system, we depict the two example of
non-linear system that we consider along the manuscript, that are,
equally spaced atomic ensembles and anharmonic cavities.

where γj denotes the decay rate of the transition from the jth to the (j − 1)-th level. The global Hamiltonian describing
the emission process is then given by the sum of the three
terms: H = HS + HB + HSB . The whole physical set-up is
illustrated in Figure 1.
We consider that initially the waveguide B is in the ground
state, whereas the system S initially contains N excitations.
When the excitations decay into the waveguide, the photonic
state is described by the wavefunction (naturally extending the
considerations of [13]):
|φ(N ) i =

II.

NON-LINEAR SYSTEMS DECAYING IN 1D
WAVEGUIDES

N
X

ωj σj,j

Z

Z
...
0

∞

At1 ...tN

N
Y

dtj a†tj |0i

(6)

j=1

with

In the interest of generality, we consider the emission process coming from a N -level system (|0i, |1i, ..., |N i) with
energies ωj . Its free Hamiltonian is then given by (taking
~ ≡ 1):
HS =

1
N!

(3)

j=1

with σik = |iihk|. The system is coupled to a 1D waveguide,
described by a one-dimensional and chiral photon bath with a
linear dispersion (both the chirality and linearity assumptions
can be relaxed obtaining similar results) ωq = cq. Taking
c ≡ 1, its Hamiltonian read:
Z
HB = dq qa†q aq .
(4)
Finally, the system-bath interaction Hamiltonian is assumed
to be given by:
Z
N
X

dq †
√
γj
aq σj−1,j + aq σj,j−1 . (5)
HSB =
2π
j=1

At1 ...tN = T (hϕ0 |Ot1 ...OtN |ϕN i)

(7)

where T stands for time-ordering, and Ot satisfies
√ [i(ωj−1 −ωj )+ 21 (γj−1 −γj )]t
hϕj |. Furtherγj e
hϕj−1 |Ot =
more, the bosonic creation and annihilation operators as , a†s
satisfy the standard commutation relation
[as , a†t ] = δ(s − t).

(8)

The use of this general light-matter Hamiltonian H allows
to capture the physics of very different models, such as:
• Saturated atomic ensembles in the atomic mirror configuration. As explained in Refs. [13, 20], within the
Markov approximation the coupling of the ensemble
with the waveguide can be described by a single collective dipole operator. This can be effectively described as N -level system with equally spaced energy
levels, ωn = nω0 , but non-linear decay rates: γn =
Γ1d n(N − n + 1). In the text, we shall call these emitted states superradiant states, or superradiant photonic
states.

3
• Anharmonic cavities. In the case of a non-linear resonator, with a Kerr non-linearity of the form HB =
ωa a† a + U a† a(a† a − 1), but coupled to the waveguide in a linear fashion such that its reduced dynamics
is given by the standard Lindblad form Γ1d (2aρa† −
a† aρ − ρa† a)/2, the energy levels are now non-linear:
ωn = nωa + n(n − 1)U , while the decay rates are harmonic γn = nΓ1d .
Along this manuscript, we will focus on the characterization of the first ones, as they will be the most relevant for
quantum metrology. However, all the formalism developed is
valid for any combination of {ωn , γn }.
III.

TOWARDS EFFECTIVE CHARACTERISATIONS OF
MULTIMODE STATES

We start this section by developing techniques that enable
us to compute relevant observables of |φ(N ) i efficiently for
large N . This is motivated by noting that the analytical form
(6) contains N ! terms due to the time ordering in (7), making
such an expression challenging to handle beyond low N .
We first consider a single emitted photon (with γ ≡ γ1 − γ0
and ω ≡ ω1 − ω0 ):
Z ∞
(γ,ω) †
|φ(1) i =
dtBt
at |0i ≡ b†γ,ω |0i
(9)
0
γ
√
(γ,ω)
where we have defined Bt
≡ γe−t(iω+ 2 ) and b†γ,ω ≡
R∞
(γ,ω) †
at . Using (8), the commutation relation
dtBt
0
√
2 γγ 0
[bγ,ω , b†γ 0 ,ω0 ] =
(10)
γ + γ 0 + 2i(ω 0 − ω)

follows. Given such single-mode operators bγ,ω ’s, we have
developed techniques to compute efficiently observables of
the form
hφ(N ) |bx1 ,y1 ...bxn ,yn b†x̃1 ,ỹ1 ...b†x̃n ,ỹn |φ(N ) i.

(11)

The computational techniques for dealing with (11) are rather
involved and are developed in detail in the Appendix I. Here,
we instead explain the main ideas and implications:
1. The computation of (11) is developed by expressing it
as a recurrence relation, which is then transformed into
a matrix multiplication.
2. The solution is exact as the integrals in (6) are carried
out analytically. Yet, in practice it is convenient to perform the matrix multiplication numerically in order to
access large N .
3. The size of the involved matrices is at most (4n (N −
n + 1))2 , although usually this can be reduced if there
are some symmetries in the calculation (i.e. if some
of the xi ’s and yi ’s in (11) are the same). In practice,
this means that for n = 1 (corresponding to average
photon number), one can easily reach up to N ≈ 1000,

whereas for n = 2 (corresponding to the variance) one
can reach N ≈ 100. This should be contrasted to the
naive calculation of (11) from (6) which involves (N !)2
integrals.
4. Since the b†γ,ω ’s form an (overcomplete) basis of the
Fock space spanned by a†t ∀t, one can in principle compute arbitrary observables through this approach.
IV.

CHARACTERISATION OF SUPERRADIANT
PHOTONIC STATES

We now apply the machinery developed in the previous
section to the characterisation of superradiant photonic states
emitted when N excited atoms are placed next to the waveguide in the atomic mirror configuration, as previously proposed by us in [20]. This corresponds to taking |φ(N ) i in (11)
with γn = Γ1d n(N − n + 1) and ωn = nω0 .
Before proceeding to its characterisation, let us mention
that there are two main features that make this proposal particularly appealing [20]:
• In the absence of photon loss (i.e., when the atomwaveguide set-up is perfectly isolated) and assuming
perfect control on the system’s Hamiltonian, the protocol is deterministic and scalable. That is, simply by
placing more atoms next to the waveguide, one can generate a larger N -photon state.
• In the presence of photon loss in free space, the probability of success scales as ≈ 1−ln(N )(Γ∗ /Γ1d ), where
Γ1d is the decay rate into the waveguide and Γ∗ into
free space, for Γ∗ /Γ1d  1. This slow decrease with
ln N arises due to the enhanced collective decay and
should be contrasted with the standard success probability ≈ 1 − N (Γ∗ /Γ1d ) obtained for N independent
decay processes (see Ref. [20] for more details).
Hence, Dicke superradiant decays provide a natural framework to generate N -photonic states in a deterministic, scalable and robust-to-photon-loss manner. Furthermore, current
experimental nanophotonic platforms have already achieved
ratios Γ1d /Γ∗ ≈ 60 with Γ1d ∼ 1 GHz [26].
A.

Average photon number

We first consider the photon number
n(γ, ω) ≡ hφ(N ) |b†γ,ω bγ,ω |φ(N ) i.

(12)

We start by fixing the decay rate γ and varying ω around ω0 ,
corresponding to the frequency of the two-level emitters. Figure 2 shows how the average photon number is centred at ω0 ,
as one would have expected physically.
Next we consider n(γ, ω) for a fixed ω = ω0 and varying γ. The results are shown in Fig. 3, where we compute
n(γ, ω0 ) for N = 100, 200, 300. Interestingly, note that the
maximum of n(γ, ω) appears at x = N/ ln N . To understand

4

FIG. 2. Ratio of photons of a superradiant N -photon state |φ(N ) i in
a mode with frequency ω0 + ∆ω and inverse decay rate γ.

FIG. 4. Proportion of photons in d modes as quantified by (19) for
D = 10 as a function of the number of photons N in the superradiant
state.

are not orthogonal due to (10). A set of orthogonal modes can
be constructed by solving the generalised eigenvalue equation,
T ~v (k) = λk R~v (k)

(14)

where T and R are matrices of size D2 whose elements are
given by
Tkl = hφ(N ) |b†kx,ω0 blx,ω0 |φ(N ) i,
√
2 kl
†
.
Rkl = [bkx,ω0 , blx,ω0 ] =
k+l
FIG. 3. Ratio of photons of a superradiant N -photon state |φ(N ) i in
a mode with frequency ω0 and varying inverse decay rate γ. Note
that the maximal number of photons is found for γ ≈ N/ ln N .

This leads to a set of D bosonic modes
ck =

D
X

(k)

vj bjx,ω0

with

x=

j=1

this, note that the time scale τ of decay of the photons is proportional to γ −1 . In particular, for the superradiant decay, the
jth collective exitation decays with a time scale γj−1 , with
γj = Γj(N − j + 1), and the average decay time is given by
hτ i ∝

N
X

γj−1 = Γ−1

j=1

N
X
j=1

(15)

ln N
,
N

(16)

The usual commutation relations
[ci , c†j ] = δij ,

(17)

are guaranteed by (14) (plus appropriate normalisation).
Let us now define the number operators (for a given D),

1
N
≈ Γ−1
.
j(N − j + 1)
2 ln N

nd ≡

d
X

c†j cj ,

(18)

j=1

(13)

and the corresponding ratio of photons,
Hence, we realise from (6) that the choice γ = N/ ln N corresponds to single-mode photons decaying with the average
decay time of the superradiant photons. This provides an
heuristic explanation for the optimal choice of γ that maximises n(γ, ω0 ), i.e., the number of photons in the mode bγ,ω .

B.

Most relevant modes

The results of Figures 3 and 2 suggest that a rather large
proportions of photons (between 50% and 60% for N =
100, 200, 300) can be contained in a small set of modes centred around the frequency ω and with inverse decay rate γ =
N/ ln N . This motivates us to consider a set of D modes with
frequency ω0 and varying Γ = jN/ ln N , with j = 1, ..., D;
that is, {bjx,ω0 }D
j=1 with x = N/ ln N . Note that these modes

hφ(N ) |nd |φ(N ) i
.
(19)
N
In Figure 4, we show Cd as a function of N for D = 10 (i.e.
the modes ck ’s are a linear combination of 10 modes bkx,ω0 ’s).
Note that Cd quickly saturates with N . The values of Cd for
different D’s are shown in the following Table, which is evaluated at N = 100:
Cd =

D=2
D=4
D=6
D=8
D=10

C1

C2

C3

0.653
0.852
0.894
0.901
0.902

0.688
0.918
0.973
0.983
0.984

0.921
0.980
0.993
0.996

C4

C5

C6

C7

C8

0.921
0.981 0.981 0.981
0.995 0.995 0.995 0.995 0.995
0.998 0.999 0.999 0.999 0.999

5
These numbers can be slightly increased by considering larger
d’s or D’s. It is remarkable that with only 2 (3) modes we can
cover 98.4% (99.6%) of the photons, and that more than 90%
photons live in a single mode. Hence, although the superradiant state |φ(N ) i may naively appear as a highly multimode
state, it can be described by means of only a few modes. At the
same time, it is worth noticing that although we reached this
result by a rather heuristic method, these descriptions are almost optimal: since the small set of considered modes already
contains around 99.9% of the photons, it is not possible that
by considering a much larger (possibly infinite) set of modes
the effective descriptions can considerably change. In other
words, while a few modes seem to suffice to describe |φ(N ) i
with high accuracy, it is not possible to describe it by a single
one.

C.

the overlaps

Variance

Let us further characterise the fact that most photons are
contained in a few modes by studying the fluctuations of the
number operators nk ’s given in (18). In particular consider
the variance
q
2
σnd = hn2d i − (hnd i) ,
(20)
with h...i ≡ hφ(N ) |...|φ(N ) i. To compute such expressions,
first we expand them using the commutation relations (17) as
hn21 i =hc21 (c†1 )2 i − 3hn1 i − 2 − (hn1 i)

2

hn22 i =hc21 (c†1 )2 i + hc22 (c†2 )2 i + 2hc1 c2 c†1 c†2 i
− 5hn1 i − 5hn2 i − 6

(21)

and similarly for higher hn2j i. Each term can be evaluated by
using (16) and then computing hbi bj b†k b†l i (or hbi bj i) by the
appropriate recurrence relation derived in Appendix I. For numerical purposes, it is convenient to first compute hbi bj b†k b†l i
∀i, j, k, l where i = 1, ..., D and save the results. In the numerical simulations of this section, we take D = 8, for which
we already cover 99% of the photons as shown in Table IV B.
The results are shown in Figure 5 for d = 1, 2, 3 and D = 8.
As expected, σnd decreases as d increases, and for d = 3 and
D = 8 the variance is rather small: less than one photon for
N = 40. This confirms the previous results that a few modes
can cover most of the photons contained in the superradiant
state. Furthermore, we also observe that σnd grows linearly
with N , which is compatible with the proportion of photons
staying constant with N as shown in Figure 2.

D.

FIG. 5. Variance of the number operators n1 , n2 , and n3 defined in
(18) for D = 8.

h0|ck11 ck22 ...ckdd |φ(N ) i,

P
for all {cj }dj=1 such that d kd = N , and where d is the
number of considered modes. For that, we first express (22)
D
1
as a combination of h0|bkx,ω
bk2 ...bkDx,ω
|φ(N ) i through
0 2x,ω0
0
(16). Then, in Appendix I, we develop a recurrence relaD
1
tion method to compute h0|bkx,ω
bk2 ...bkDx,ω
|φ(N ) i which
0 2x,ω0
0
requires the multiplication of O(N ) matrices of dimension
D
dim, which satisfies N . dim . (N/D) . In order
to compute (22), it is convenient to first compute all possiD
1
|φ(N ) i for all {kj }N
ble h0|bkx,ω
bk2 ...bkDx,ω
j=1 such that
0 2x,ω0
0
P
D
j kj = N and save such coefficients. There are O(N )
such coefficients, which provides the necessary space to carry
out the computation. Overall, the whole computation is challenging, both in terms of the number of operations and the
complexity of each one, but becomes feasible for small N and
D ≤ 10, which is enough to capture most of the photons (see
Table IV B).
We consider the following unnormalised two and three
mode state:
(N )

|ψ2

i=

N
X

αj |j, N − ji

j=0
(N )

|ψ3

i=

−j
N N
X
X

αj,k |j, k, N − j − ki

(23)

j=0 k=0

p
with |j, N − ji = (c†1 )N −j (c†2 )j |0i/ (N − j)!j!, |j, k, N −
p
j −ki = (c†1 )j (c†2 )k (c†3 )N −j−k |0i/ (N − j − k)!k!j!, αj =
hφ(N ) |j, N − ji and αj,k = hφ(N ) |j, k, N − j − ki. The
normalisation (for two modes)

Effective descriptions

N =
The main insight of the previous sections is that 2 or 3
modes suffice to describe most of the photons of |φ(N ) i. We
can use this insight to build effective descriptions of |φ(N ) i
within these subspaces. This can be achieved by computing

(22)

N
X

|αj |2 ,

(24)

j=0

or N =
(N )

P

j,k

|αj,k |2 for three, indicates the overlap between

|ψ2,3 i and |φ(N ) i, i.e., how good the approximation in the

6

FIG. 6. Overlap for the two-mode (blue) and three-mode (orange)
approximations for D = 8.

FIG. 8. A multimode state (generated e.g. through a superradiant
decay) enters each arm of a MZ interferometer. Each arm of the
interferometer is described by the set of modes: {ak }, {bk }.

well as describing the set-up we consider here in detail.
We consider the estimation of a parameter ϕ by measuring
N photons which encode information about it. The (possibly
entangled) N -photon state is described by |ψϕ i. Let us assume that we apply a measurement M on |ψϕ i, the statistics
being described by a probability distribution P (sj |ϕ) where
{sj } are the possible outcomes of the measurement given the
value ϕ of the unknown parameter to be estimated. If this process is repeated ν times, in the limit ν  1 the Cramer-Rao
bound guarantees that the mean-squared error ∆2 ϕ̃ of any
unbiased and consistent estimator ϕ̃ of ϕ is lower bounded
by [42, 43]:
∆2 ϕ̃ ≥

FIG. 7. Coefficients of the two-mode state for N = 3, 5, 7, 9 and
D = 8.

two or three mode subspace is. In Figure 6, we show how N
is close to 1 for low N ≤ 10, especially for d = 3 where it
stays above 0.97. This implies that |φ(N ) i can indeed be well
described by two or three mode states as in (23). For d = 2,
the coefficients are given in Figure 7 and the coefficients for
d = 3 are provided in Appendix I. These approximate states
of the form (23) become handy in calculations for quantum information tasks, as we will later illustrate for quantum metrology, and importantly our techniques enable us to quantify how
close are our approximate states to the real |φ(N ) i. As a final
remark, we note that the linear decrease of N with N is also
compatible with our previous results where we observed that
the proportion of photons in a given mode stays constant.

V.

1
νC

(25)

where C is the classical Fisher Information (CFI),

2
X
∂P (sj |ϕ)
1
C=
.
P (sj |ϕ)
∂ϕ
j

(26)

The CFI quantifies the best resolution of a particular estimation scheme as defined through |ψϕ i and a measurement M .
In their seminal work, Braunstein and Caves optimised C over
all possible quantum measurements M [41]. The resulting
quantity is the Quantum Fisher Information Q (QFI) , which
satisfies,
∆2 ϕ̃ ≥

1
1
≥
νC
νQ

and, for pure states, is given by


Q = 4 hψ̇ϕ |ψ̇ϕ i − |hψ̇ϕ |ψϕ i|2

(27)

(28)

APPLICATIONS IN QUANTUM METROLOGY

We now apply the different insights and techniques developed in the last section to quantum optical interferometry,
in particular by considering phase estimation in a standard
Mach-Zender (MZ) interferometer. We consider that each
arm of the MZ inteferometer is described by a set of modes
{ak }dk=1 and {bk }dk=1 , respectively (see Figure 8). When
d = 1, we recover the standard two-mode optical interferometry [4], and our goal is precisely to extend well-known results
to the multimode regime where d > 1. We start this section
by introducing some basic concepts of quantum metrology, as

with ψ̇ϕ = ∂ϕ ψϕ . The QFI quantifies the potential of a particular state |ψϕ i for quantum metrology [41].
Let us now discuss how we encode ϕ in the standard MachZender (MZ) interferometer, but extended to the multimode
regime. We consider as an initial state |ψi = |φA , φB i, where
X
(A)
|φA i =
C{α} |{α}ia
{αi }d
i=1 ∈C(n)

|φB i =

X
{αi }d
i=1 ∈C(m)

(B)

C{α} |{α}ib

(29)

7
with

A.

(a† )α1 (a†d )αd
|{α}ia = √1
... √
|0i
α1 !
αd !
(b† )α1 (b†d )αd
... √
|0i,
(30)
|{α}ib = √1
α1 !
αd !
P
and where {αi } ∈ C(n) iff i αi = n, and with n + m = N .
That is, we consider that two independent (but generic) states
of m and n photons, each of them described by d modes, enter
the two arms of the interferometer. For d = 1, the states are
single-mode states and hence Fock states. We also assume
bosonic commutation relations,
[ai , a†j ] = δij ,

[bi , b†j ] = δij ,

(31)

which can always be satisfied by a proper choice of the initial modes through the generalised eigenvalue equation, as in
(14). The initial state |ψi = |φA , φB i goes through a balanced
beam splitter UBS , gains a relative phase ϕ when traveling
through the two arms of the interferometer, and finally enters
another beam splitter; the final state then reads
†
|ψϕ i = UBS
e−iϕH UBS |φA , φB i

tion





Pd
†
†
1
i=1 ai ai − bi bi , and where
2
†
UBS
e−iϕH UBS can be described by:

with H =

ãj
b̃j

!

1
=
2

(32)

the transforma-

!
!
!
!
aj
1 −i
eiϕ/2
0
1 i
−i 1
bj
0 e−iϕ/2
i 1
(33)

where ãj , b̃j are the output modes. Using this transformation
we easily obtain,
d

H̃ ≡

†
UBS
HUBS


i X †
=
bi ai − a†i bi .
2 i=1

(34)

On the other hand, |ψϕ i can be explicitly written as:
(B)

=

d
X

[nj (1 + mj ) + mj (1 + nj )]

(38)

j=1

where we defined the average photon numbers nj ≡
hφA |a†j aj |φA i and mj ≡ hφB |b†j bj |φB i. In the particular case
ni = mi , e.g. for twin states, we finally obtain
Q=2

d
X

nj (nj + 1).

(39)

j=1

From this expression one can immediately recover the QFI of
twin Fock states Q = N (1 + N/2) [39], which corresponds
to d = 1 and n1 = N/2. For twin superradiant states, from
our considerations of Sec. IV B we have that 2n1 ≈ 0.90N ,
2n2 ≈ 0.08N and 2n3 ≈ 0.02N , from which we obtain Q ≈
0.41N 2 + N , hence recovering our previous results [20].
More generally, (38) provides a simple and clear expression
for the potential of a particular multimode state for optical
interferometry, and from it we learn that
1. To obtain the QFI of a twin multimode state with N/2
photons in each arm, it is enough to compute the average photon number of the internal modes of each arm.
2. When the multimode state is generated through a nonlinear decay as described in Section II, then our techniques enable us to compute the QFI for large photon
number (N up to N ≈ 1000).
3. Heinseberg scaling (i.e. Q ∝ N 2 ) is possible when
the number of relevant modes is independent of N ,
and quantum-enhanced scaling (i.e. Q ∝ N 1+α with
α > 0) when the number of relevant modes grows sublinearly with N .

(36)

• Mode-Number-Resolved (MNR) measurements. That
is, photon measurements that are able to distinguish both the specific mode and the number of
(MNR)
photons.
In this case, defining Pαβ
(ϕ) ≡
d
d
P ({αj }j=1 , {βj }j=1 |ϕ) and with (30) we have

Finally, it will be useful to note that
ḃ†j (ϕ) =

1 †
a (ϕ).
2 j

Number resolved measurements and QFI

(35)

a†j (ϕ) = cos(ϕ/2)a†j + sin(ϕ/2)b†j
b†j (ϕ) = − sin(ϕ/2)a†j + cos(ϕ/2)b†j .

B.

Although the QFI provides the maximal sensitivity of |ψϕ i
to ϕ, it is equally important to understand how to achieve it in
practice. For that, in this section we consider number-resolved
measurements in both outputs of the interferometer. In particular, we consider two types of measurements

with

1 †
b (ϕ),
2 j

When |ψi
=
e−iϕH in (28), then we have
the convenient expression for
the QFI: Q
=

4 hψϕ |H 2 |ψϕ i − (hψϕ |H|ψϕ i)2 . Using (31) and (34),
we obtain

2
Q =hφA , φB |H̃ 2 |φA , φB i − hφA , φB |H̃|φA , φB i

(A)

C{β} C{α}
pQ
|ψϕ i =
i αi !βi !
{αi }∈C(n), {βi }∈C(m)
α1 
αD 
β1 
βD

... b†D (ϕ)
|0i
a†1 (ϕ)
... a†D (ϕ)
b†1 (ϕ)
X

ȧ†j (ϕ) =

Quantum Fisher Information for pure multimode states

(37)

(MNR)

Pαβ

2

(ϕ) = |hψϕ |(|{αj }ia ⊗ |{βj }ib )| .

(40)

8
• Number-Resolved (NR) measurements. We also consider standard photon counting measurements that are
not able to distinguish between the different modes. In
this case the corresponding probability distribution to
obtain n and m photons in each output of the interferometer reads
X
(MNR)
(NR)
Pnm
(ϕ) =
Pα,β (ϕ).
(41)
{α}∈C(n),{β}∈C(m)

In both cases, we assume that the detector frequencybandwidth is larger than the photonic wavepackets linewidth,
which in the superradiant case scale as γ ∝ N/ ln N (see Sec.
IV A and Fig. 3).
Let us now compute the CFI (26) for MNR and NR measurements when ϕ → 0 by extending the considerations
of [44] to multimode states. We first expand Pαβ (ϕ) around
ϕ = 0:
(MNR)

Pα,β

(MNR)

(ϕ) = Pα,β

(MNR)

(0) + Ṗαβ

1 (MNR)
(0)ϕ2
(0)ϕ + P̈αβ
2
(42)

3

up to order O(ϕ ). Let us now consider this expansion for
different cases:
1. n photons in one output and m photons in the other one,
(MNR)
i.e., Pαβ
(ϕ)’s such that {αj } ∈ C(n) and {βj } ∈
(MNR)

C(m). Then using (37) we obtain, Pαβ
(ϕ) = 1 +
O(ϕ2 ), which does not contribute to (26).
2. n ± 1 photons in one output and m ∓ 1 photons in the
(MNR)
other one. That is, Pαβ
(ϕ)’s such that {αj } ∈
C(n ± 1) and {βj } ∈ C(m ∓ 1). Then again using (37) we have Pαβ (ϕ)(MNR) = 12 P̈αβ (0)ϕ2 with
P̈αβ (0) = 2|hψ̇ϕ=0 |{αj }dj=1 , {βj }dj=1 i|2 . This case
does contribute to (26).
3. n ± m photons in one output and m ∓ m photons in
the other one, with m ≥ 2. Then we have, Pαβ (ϕ) =
O(ϕm+1 ), which again does not contribute to (26).
Putting together these considerations we obtain:
X
lim C = 2
P̈αβ (0)
ϕ→0

{αj }∈C(n±1),{βj }∈C(m∓1)

FIG. 9. Classical Fisher information for MNR measurements (in orange) and for NR measurements (in blue) when two copies of |ψ1 i in
(44) (case (a)) or two copies of |ψ2 i in (45) (case (b)) enter through a
MZ interferometer. The CFI for MNR measurements coincides with
the QFI for all ϕ.

other one, and in the fourth line we used hψϕ=0 |ψ̇ϕ=0 i = 0.
Hence, we conclude that C = Q around ϕ = 0 for MNR
measurements.
Crucially, the derivation (43) follows analogously for NR
measurements, i.e., for the coarse-grained distribution (41).
This has the very important consequence for practical implementations that experimentally one does not need to distinguish between the different modes to saturate the QFI. These
conclusions hold around ϕ = 0, but there is in principle no
reason why they should also hold for other ϕ. To address this
point, we consider two illustrative states:
|φ1 i =

n
X
1
√ |j, n − ji
n
j=0

1
|φ2 i = √ (|0, ni + |n, 0i) ,
2

(44)
(45)

and compute the CFI for the corresponding twin states (i.e.
|hψ̇ϕ=0 |{αj }dj=1 , {βj }dj=1 i|2 |ψ1 , ψ1 i or |ψ2 , ψ2 i are the input states of the MZ interferometer). In Figure 9 we plot the CFI for (44) and (45) with
{αj }∈C(n±1),{βj }∈C(m∓1)


n = 5 and given MNR and NR photon measurements. We
X
observe that C = Q for MNR measurements whereas for the
= 4hψ̇ϕ=0 |
|{αj }, {βj }ih{αj }, {βj }||ψ̇ϕ=0 i
NR measurement the equality is only saturated around ϕ = 0
{αj },{βj }
(or multiples of π/2). It is worth stressing that one can always add phase shifters to compensate for ϕ 6= 0 during the
= 4hψ̇ϕ=0 |ψ̇ϕ=0 i
estimation process in order to guarantee that C = Q for NR
= lim Q.
(43)
measurements. These are crucial considerations to take into
ϕ→0
account in implementations of quantum metrology with mulwhere in the third line we used that |ψ̇ϕ=0 i has only support
timode states. It is also worth noticing that the multimode
structure of the state leads to a non-trivial change of the CFI
in the subspace of n ± 1 photons in one arm and m ∓ 1 in the
=4

X

9
in the presence of photon loss can appear as a better prefactor in Q ∝ N [51–53] as classical schemes are limited by
the shot-noise limit Q ≤ N . This advantage however highly
depends on the state into consideration: for example, GHZ
states, which are optimal in ideal conditions, are known to
quickly lose any sensitivity to ϕ in the presence photon loss.
Twin Fock States (TFS), on the other hand, are known to be
a good candidate for quantum metrology even in the presence
of photon loss η (quantifying the probability of losing a photon in each arm of the interferometer), as in this case the QFI
becomes
FIG. 10. Classical Fisher information for MNR measurements (in
orange) and for NR measurements (in blue) for a twin superradiant
state with N = 10 (i.e. n = 5).

for NR measurements, as illustrated in Figure 9.
Finally, we also compare NR and MNR measurements for
twin-superradiant states as shown in Figure 10, which also illustrates the optimality of choosing ϕ ≈ 0. To obtain the
results of Figure 10, we have used the effective descriptions
obtained in Section IV D which enable us to describe superradiant states through effective descriptions using a low number
of modes (here we use two-mode descriptions, d = 2, for
simplicity).
While our techniques enable us to compute the metrological properties up to hundreds of photons, we note that current experimental implementations of photon-number detectors are limited to few photons resolution (N ≤ 10), see
e.g. [45, 46]. It is also worth mentioning that recent theoretical proposals show that atoms coupled to the waveguide
could also be used for photon detection up to considerably
larger photon numbers [47–49], which hints to the exciting
possibility that atoms suitably coupled to waveguides can be
both used to generate and detect photons. In the next section
we discuss a proposal for quantum metrology with superradiant states in the presence of photon loss for realistic photon
numbers, namely N ≤ 10.

QTFS =

N 1−η
,
2 η

for ηN  1,

(46)

which is half of the optimal one in the limit of large N [51,
54]. It is also important to stress that although these considerations (e.g. (46)) are derived in the asymptotic limit
(ηN  1), they provide valuable insights already for moderate N [51, 54]. To extend (46) and the general considerations of [50–53] to multimode states is certainly an interesting
but also challenging endeavour, as the multimode structure
of the state makes it difficult to diagonalise it to be able to
compute Q. In this Section, we instead pursue a more humble goal: We compare (twin) superradiant and Fock states for
some specific case-studies of MZ interferometery and find that
they perform similarly even in the presence of photon loss
(which is expected as superradiant states contain 0.9N photons in a single mode).
We consider photon loss by adding a beam splitter with
transmitivity η before each measurement apparatus (this is
equivalent to placing the beam splitters before the second
beam splitter of the MZ interferometer as the losses are
symmetric). This is implemented by adding orthogonal
D
modes {ej }D
j=1 , {fj }j=1 and implementing the transformations ŨBS :
!
!
!
√
√
aj ŨBS 1
aj
η
1−η
−−−→ √
(47)
√
√
ej
η
ej
2 − 1−η
and

C.

Photon loss in the interferometer and the measurement
device

Besides finding specific measurement schemes to saturate
Q, in practice it is also crucial to consider imperfections in
the interferometer and in the measurement devices. In fact,
quantum-enhancements in metrology are largely affected by
imperfections (either in the interferometer or due to imperfect measurements), as photon loss prevents Heisenberg scaling for sufficiently large N [50–53]. To intuitively understand
why Heisenberg scaling is lost, note that for obtaining C = Q
in (43) requires photon-measurement detectors that are capable of distinguishing a single photon (i.e. between N photons
and N ± 1 photons in the outcomes of the MZ interfereometer); yet, in the presence of any finite photon loss (see Fig.
8), this is no longer possible when ηN ' 1, where η is the
probability of losing a photon. Still, quantum enhancements

bj
fj

!

1
−−−→ √
2
ŨBS

!
!
√
√
η
1−η
bj
.
√
√
− 1−η
fj
η

(48)

We again characterise the input superradiant states through
the effective descriptions obtained in Section IV D with d = 2.
These effective descriptions enable us to easily account for
photon loss, which would be highly challenging through the
continuous descriptions (6). Still, our results are limited to
low N , both because we can only obtain the coefficients of
the state for N < 10 (see IV D), and also because the possible outcomes of the experiment (i.e. the size of the probabil(MNR)
ity distribution Pα,β (ϕ)) grows as O(N 4 ) when dealing
with two-mode states in each arm of the interferometer, hence
making it difficult to compute the analytical expression (26)
for high N .
In Fig. 11 we show C in the presence of photon loss in
the measurement devices for different configurations: twin

10

FIG. 11. Classical Fisher information in the presence of photon loss
(η = 0.9) for: NR measurements in twin Fock states of N = 8
(orange) and N = 10 (blue) photons, and twin superradiant states
with N = 10 and NR (green) and NMR (red) measurements. Finally,
the straight purple line shows the classical Shot Noise Limit (SNL)
corresponding to C = N .

Fock states of N = 8 (orange) and N = 10 (blue) photons and NR measurements, and twin superradiant states with
N = 10 and NR (green) and NMR (red) measurements. We
observe how twin superradiant states perform close to Fock
states, and how NR measurements for superradiant (and hence
multimode) states become optimal around ϕ = 0, as expected from our previous considerations. It is worth pointing
out that as η increases, the optimal value moves away from
ϕ = 0, which happens for NR and NMR measurements, and
for single-mode and multimode states. These observations are
confirmed by further numerical results for other values of N
and η, which are shown in Appendix II. From these results, we
conclude that twin-superradiant states behave fairly similar to
twin-Fock states in terms of their metrological performance
also in the presence of photon loss; this conclusion is indeed
expected given that superradiant states contain ≈ 0.9N photons in a single mode.

tive way of capturing the properties of these multimodal states
with few-mode descriptions. To illustrate the potential of
these tools, we have applied them to the case of superradiant
photonic states, showing, for example, their observables can
be captured efficiently already with two or three modes up to
a large number of photons. Finally, we applied these ideas to
a phase estimation proposal based on twin superradiant states
and number resolved measurements. Our results suggest that
twin superradiant states of N photons are a promising candidate for quantum metrology, as they perform approximately as
a twin Fock state with ≈ 0.9N photons, which are in fact the
number of photons contained in a single mode. The crucial
difference is that twin superradiant states can be generated in
a deterministic and scalable manner (assuming no photon loss
and perfect control on the system’s Hamiltonian to ensure the
collective decay), in contrast to standard probabilistic methods to create Fock states, whose success probability decays
exponentially with N even in ideal conditions. We hope these
ideas motivate its experimental implementation in nanophotonic waveguides coupled to atoms [21–23, 28–30], artificial
emitters [24, 26, 27], or molecules [25].
Our results in quantum optical interferometry are in fact
general and can be applied to arbitrary multimode states with
a fixed photon number. Indeed, we have considered phase estimation in a Mach-Zender interferometer and derived a simple expression for the quantum Fisher information obtained
when the input state of each arm of the interferometer is a
generic n-photon d-mode state, and shown that it can be saturated by number-resolved measurements that cannot distinguish between the different modes. This is a crucial observation for experiments, as it shows that single-mode proposals
for quantum metrology, e.g. [39, 40, 44, 51, 54–56], can be
naturally extended to the multimode regime without requiring
extra resources in terms of the measurement devices.

VII.

ACKNOWLEGDEMENTS

To sum up, we have developed the theoretical tools to characterize (i.e., compute observables) of a wide class of multimode photonic states coming from the emission of a general
non-linear level structure. Besides, we provide a construc-

We thank Jan Kołodyński for insightful discussions. We
acknowledge funding from ERC Advanced Grant QENOCOBA under the EU Horizon 2020 program (Grant Agreement No. 742102). AGT acknowledges funding from
project PGC2018-094792-B-I00 (MCIU/AEI/FEDER, UE),
CSIC Research Platform PTI-001, and CAM/FEDER Project
No. S2018/TCS-4342 (QUITEMAD-CM).

[1] Vittorio Giovannetti, Seth Lloyd, and Lorenzo Maccone, “Advances in quantum metrology,” Nature Photonics 5, 222–229
(2011).
[2] Géza Tóth and Iagoba Apellaniz, “Quantum metrology from a
quantum information science perspective,” Journal of Physics
A: Mathematical and Theoretical 47, 424006 (2014).
[3] Jonathan P. Dowling and Kaushik P. Seshadreesan, “Quantum optical technologies for metrology, sensing, and imaging,”
Journal of Lightwave Technology 33, 2359–2370 (2015).

[4] Rafal Demkowicz-Dobrzański, Marcin Jarzyna, and Jan
Kołodyński, “Quantum limits in optical interferometry,” in
Progress in Optics (Elsevier, 2015) pp. 345–435.
[5] M. Dakna, J. Clausen, L. Knöll, and D.-G. Welsch, “Generation
of arbitrary quantum states of traveling fields,” Phys. Rev. A 59,
1658–1661 (1999).
[6] Alexei Ourjoumtsev, Rosa Tualle-Brouri, Julien Laurat, and
Philippe Grangier, “Generating optical schrödinger kittens for
quantum information processing,” Science 312, 83–86 (2006).

VI.

CONCLUSIONS

11
[7] Edo Waks, Eleni Diamanti, and Yoshihisa Yamamoto, “Generation of photon number states,” New Journal of Physics 8, 4
(2006).
[8] Alessandro Zavatta, Valentina Parigi, and Marco Bellini, “Toward quantum frequency combs: Boosting the generation of
highly nonclassical light states by cavity-enhanced parametric down-conversion at high repetition rates,” Phys. Rev. A 78,
033809 (2008).
[9] Xi-Lin Wang, Luo-Kan Chen, W. Li, H.-L. Huang, C. Liu,
C. Chen, Y.-H. Luo, Z.-E. Su, D. Wu, Z.-D. Li, H. Lu, Y. Hu,
X. Jiang, C.-Z. Peng, L. Li, N.-L. Liu, Yu-Ao Chen, ChaoYang Lu, and Jian-Wei Pan, “Experimental ten-photon entanglement,” Phys. Rev. Lett. 117, 210502 (2016).
[10] D Porras and JI Cirac, “Collective generation of quantum states
of light by entangled atoms,” Physical Review A 78, 053816
(2008).
[11] Karel Lemr and Jaromı́r Fiurášek, “Conditional preparation of
arbitrary superpositions of atomic dicke states,” Phys. Rev. A
79, 043808 (2009).
[12] L.-M. Duan and H. J. Kimble, “Efficient engineering of multiatom entanglement through single-photon detections,” Phys.
Rev. Lett. 90, 253601 (2003).
[13] A. González-Tudela, V. Paulisch, D. E. Chang, H. J. Kimble,
and J. I. Cirac, “Deterministic generation of arbitrary photonic
states assisted by dissipation,” Phys. Rev. Lett. 115, 163603
(2015).
[14] A. González-Tudela, V. Paulisch, H. J. Kimble, and J. I. Cirac,
“Efficient multiphoton generation in waveguide quantum electrodynamics,” Phys. Rev. Lett. 118, 213601 (2017).
[15] Subhadeep Gupta, Kevin L. Moore, Kater W. Murch, and
Dan M. Stamper-Kurn, “Cavity nonlinear optics at low photon
numbers from collective atomic motion,” Phys. Rev. Lett. 99,
213601 (2007).
[16] A. Dousse, J. Suffczyński, A. Beveratos, O. Krebs, A. Lemaı̂tre,
I. Sagnes, J. Bloch, P. Voisin, and P. Senellart, “Ultrabright
source of entangled photon pairs,” Nature 466, 217 (2010).
[17] Yasutomo Ota, Satoshi Iwamoto, Naoto Kumagai, and Yasuhiko Arakawa, “Spontaneous two-photon emission from a
single quantum dot,” Phys. Rev. Lett. 107, 233602 (2011).
[18] M. D. Lukin and A. Imamoglu, “Controlling photons using
electromagnetically induced transparency,” Nature 413, 273
(2001).
[19] M. Saffman, T. G. Walker, and K. Mølmer, “Quantum information with rydberg atoms,” Rev. Mod. Phys. 82, 2313–2363
(2010).
[20] V. Paulisch, M. Perarnau-Llobet, A. González-Tudela, and J. I.
Cirac, “Quantum metrology with one-dimensional superradiant
photonic states,” Phys. Rev. A 99, 043807 (2019).
[21] E. Vetsch, D. Reitz, G. Sagué, R. Schmidt, S. T. Dawkins, and
A. Rauschenbeutel, “Optical interface created by laser-cooled
atoms trapped in the evanescent field surrounding an optical
nanofiber,” Phys. Rev. Lett. 104, 203603 (2010).
[22] J. D. Thompson, T. G. Tiecke, N. P. de Leon, J. Feist, A. V.
Akimov, M. Gullans, A. S. Zibrov, V. Vuletic, and M. D. Lukin,
“Coupling a single trapped atom to a nanoscale optical cavity,”
Science 340, 1202–1205 (2013).
[23] A. Goban, C.-L. Hung, S.-P Yu, J.D. Hood, J.A. Muniz, J.H.
Lee, M.J. Martin, A.C. McClung, K.S. Choi, D.E. Chang,
O. Painter, and H.J. Kimble, “Atom-light interactions in photonic crystals,” Nat. Commun. 5, 3808 (2014).
[24] A. Laucht, S. Pütz, T. Günthner, N. Hauke, R. Saive,
S. Frédérick, M. Bichler, M.-C. Amann, A. W. Holleitner,
M. Kaniber, and J. J. Finley, “A Waveguide-Coupled On-Chip
Single-Photon Source,” Phys. Rev. X 2, 011014 (2012).

[25] Sanli Faez, Pierre Türschmann, Harald R. Haakh, Stephan
Götzinger, and Vahid Sandoghdar, “Coherent interaction of
light and single molecules in a dielectric nanoguide,” Phys. Rev.
Lett. 113, 213601 (2014).
[26] Peter Lodahl, Sahand Mahmoodian, and Søren Stobbe, “Interfacing single photons and single quantum dots with photonic
nanostructures,” Rev. Mod. Phys. 87, 347–400 (2015).
[27] Alp Sipahigil, RE Evans, DD Sukachev, MJ Burek, J Borregaard, MK Bhaskar, CT Nguyen, JL Pacheco, HA Atikian,
C Meuwly, et al., “An integrated diamond nanophotonics platform for quantum optical networks,” Science , aah6875 (2016).
[28] Neil V. Corzo, Baptiste Gouraud, Aveek Chandra, Akihisa
Goban, Alexandra S. Sheremet, Dmitriy V. Kupriyanov, and
Julien Laurat, “Large bragg reflection from one-dimensional
chains of trapped atoms near a nanoscale waveguide,” Phys.
Rev. Lett. 117, 133603 (2016).
[29] H. L. Sørensen, J.-B. Béguin, K. W. Kluge, I. Iakoupov, A. S.
Sørensen, J. H. Müller, E. S. Polzik, and J. Appel, “Coherent backscattering of light off one-dimensional atomic strings,”
Phys. Rev. Lett. 117, 133604 (2016).
[30] P Solano, P Barberis-Blostein, FK Fatemi, LA Orozco, and
SL Rolston, “Super-radiance reveals infinite-range dipole interactions through a nanofiber,” Nature communications 8, 1857
(2017).
[31] H. L. Sørensen, J.-B. Béguin, K. W. Kluge, I. Iakoupov, A.
S. Sørensen, J. H. Mller, E. S. Polzik, and J. Appel, “Coherent backscattering of light off one-dimensional atomic strings,”
Phys. Rev. Lett. 117, 133604 (2016).
[32] R. H. Dicke, “Coherence in Spontaneous Radiation Processes,”
Phys. Rev. 93, 99 (1954).
[33] Andreas Christ and Christine Silberhorn, “Limits on the deterministic creation of pure single-photon states using parametric
down-conversion,” Phys. Rev. A 85, 023829 (2012).
[34] Johannes Tiedau, Tim J Bartley, Georg Harder, Adriana E Lita,
Sae Woo Nam, Thomas Gerrits, and Christine Silberhorn, “On
the scalability of parametric down-conversion for generating
higher-order fock states,” arXiv:1901.03237 (2019).
[35] N Quesada, LG Helt, J Izaac, JM Arrazola, R Shahrokhshahi,
CR Myers, and KK Sabapathy, “Simulating realistic nongaussian state preparation,” arXiv:1905.07011 (2019).
[36] Ben Q. Baragiola, Robert L. Cook, Agata M. Brańczyk, and
Joshua Combes, “n-photon wave packets interacting with an
arbitrary quantum system,” Phys. Rev. A 86, 013811 (2012).
[37] Alexander Holm Kiilerich and Klaus Mølmer, “Input-output
theory with quantum pulses,” Phys. Rev. Lett. 123, 123604
(2019).
[38] T. Shi, D.E. Chang, and J.I. Cirac, “Generalized master equation,” in preparation.
[39] M. J. Holland and K. Burnett, “Interferometric detection of optical phase shifts at the heisenberg limit,” Phys. Rev. Lett. 71,
1355–1358 (1993).
[40] R. A. Campos, Christopher C. Gerry, and A. Benmoussa, “Optical interferometry at the heisenberg limit with twin fock states
and parity measurements,” Phys. Rev. A 68, 023810 (2003).
[41] Samuel L. Braunstein and Carlton M. Caves, “Statistical distance and the geometry of quantum states,” Phys. Rev. Lett. 72,
3439–3443 (1994).
[42] C. W. Helstrom, Quantum Detection and Estimation Theory
(Elsevier Science, 1976).
[43] Alexander S. Holevo, Probabilistic and Statistical Aspects of
Quantum Theory (Statistics & Probability) (English and Russian Edition) (Elsevier Science, 1982).
[44] Luca Pezzé and Augusto Smerzi, “Ultrasensitive two-mode interferometry with single-mode number squeezing,” Phys. Rev.

12
Lett. 110, 163604 (2013).
[45] Robert H. Hadfield, “Single-photon detectors for optical quantum information applications,” Nature Photonics 3, 696–705
(2009).
[46] Mattias Jönsson and Gunnar Björk, “Evaluating the performance of photon-number-resolving detectors,” Phys. Rev. A 99,
043822 (2019).
[47] B. Peropadre, G. Romero, G. Johansson, C. M. Wilson,
E. Solano, and J. J. Garcı́a-Ripoll, “Approaching perfect
microwave photodetection in circuit qed,” Phys. Rev. A 84,
063834 (2011).
[48] G. Romero, J. J. Garcı́a-Ripoll, and E. Solano, “Microwave
photon detector in circuit qed,” Phys. Rev. Lett. 102, 173602
(2009).
[49] Daniel Malz and J Ignacio Cirac, “Number-resolving photon
detectors with atoms coupled to waveguides,” arXiv preprint
arXiv:1906.12296 (2019).
[50] Akio Fujiwara and Hiroshi Imai, “A fibre bundle over manifolds of quantum channels and its application to quantum statistics,” Journal of Physics A: Mathematical and Theoretical 41,

255304 (2008).
[51] Sergey Knysh, Vadim N. Smelyanskiy, and Gabriel A. Durkin,
“Scaling laws for precision in quantum interferometry and the
bifurcation landscape of the optimal state,” Phys. Rev. A 83,
021804 (2011).
[52] BM Escher, RL de Matos Filho, and L Davidovich, “General
framework for estimating the ultimate precision limit in noisy
quantum-enhanced metrology,” Nature Physics 7, 406 (2011).
[53] Rafał Demkowicz-Dobrzański, Jan Kołodyński, and Mădălin
Guţă, “The elusive heisenberg limit in quantum-enhanced
metrology,” Nature communications 3, 1063 (2012).
[54] Sergey I Knysh, Edward H Chen, and Gabriel A Durkin, “True
limits to precision via unique quantum probe,” arXiv preprint
arXiv:1402.0495 (2014).
[55] Holger F. Hofmann, “All path-symmetric pure states achieve
their maximal phase sensitivity in conventional two-path interferometry,” Phys. Rev. A 79, 033822 (2009).
[56] M. Oszmaniec, R. Augusiak, C. Gogolin, J. Kołodyński,
A. Acı́n, and M. Lewenstein, “Random bosonic states for robust quantum metrology,” Phys. Rev. X 6, 041044 (2016).

APPENDIX
I.

RECURRENCE RELATIONS

Here we build recurrence relations to compute
f ({xj , yj , x̃j , ỹj }nj=1 ) = hφ(N ) |bx1 ,y1 ...bxn ,yn b†x̃1 ,ỹ1 ...b†x̃1 ,ỹ1 |φ(N ) i.

(1)

As the derivation is rather non-trivial, for clarity we will start by computing simple but relevant cases where n = 0, 1, 2 before
deriving a general relation for (1).
Along the derivation we will use that from (8) it follows that
√
2 x1 x̃1
†
h0|bx1 ,y1 bx̃1 ,ỹ1 |0i =
(2)
x1 + x̃1 + 2i(ỹ1 − y1 )
and similarly
[bx1 ,y1 , b†x̃1 ,ỹ1 ] =

A.

√
2 x1 x̃1
.
x1 + x̃1 + 2i(ỹ1 − y1 )

(3)

Normalisation

It is instructive to first check that |φ(N ) i is normalised. We want to compute,


Z Z ∞
N
Y
1
hφ(N ) |φ(N ) i =
...
At1 ...tN A∗s1 ...sN 
dtj dsj  h0|as1 ...asN a†t1 ...a†tN |0i
(N !)2
0

(4)

j,k=1

Using the symmetry of At1 ...tN under permutations over {tj } and the commutation relation (8), we arrive at


Z Z ∞ Y
N
1

hφ(N ) |φ(N ) i =
...
dtj  |At1 ...tN |2 .
N!
0

(5)

j,k=1

In order to solve this integral, which includes a time-ordering operation T , we split the integral as a sum of integrals using
Z ∞Z ∞
Z ∞ Z ∞
Z ∞
Z ∞
dx dy T hOx Oy i =
dy
dx hOx Oy i +
dx
dy hOy Ox i.
(6)
0

0

0

y

0

x

13
There are N ! such integrals, and they are equivalent. Hence we have that
hφ

(N )

|φ

(N )

∞

Z
i=

Z

∞

dtN ...
t3

R∞
s

∞

dt2

0

This integral can be easily worked out using

Z

dt1
t2

N
Y

γj exp [(γj−1 − γj )tj ] .

(7)

j=1

dse−at = e−as /a, which leads to the desired result
hφ(N ) |φ(N ) i = 1.

B.

(8)

Average photon number

We first consider f (x1 , y1 , x̃1 , ỹ1 ). Before proceeding to its calculation, first note
√
2 x1 x̃1
+ hφ(N ) |b†x̃1 ,ỹ1 bx1 ,y1 |φ(N ) i.
f (x1 , y1 , x̃1 , ỹ1 ) =
x1 + x̃1 + 2i(ỹ1 − y1 )
Using (8) and (2) and the symmetry of At1 ...tN over permutations, we first have
√
2 x1 x̃1
(N )
+ N I1 (x1 , y1 , x2 , y2 )
f (x1 , y1 , x̃1 , ỹ1 ) =
x1 + x̃1 + 2i(ỹ1 − y1 )

(9)

(10)

with
(N )
I1 (x1 , y1 , x̃1 , ỹ1 )

1
=
N!

Z

∞

Z

...
0

0

N
∞Y

dtj du dv Aut2 ...tN A∗vt2 ...tN Bu(x1 ,y1 )∗ Bv(x̃1 ,ỹ1 ) .

(11)

j=2

This integral is challenging to compute because of the time-ordering T . We will compute the integral through a recurrence
relation. The rough idea is as follows: first one splits the integral as a sum of integrals using (6). Since the number of integrals
increases exponentially with N , it is crucial to use that when any of the tj ’s is integrated, the resulting integral is the same due
to the symmetry of A under permutations. This allows us to keep the computation efficient, as the number of integrals grows
linearly with N . Let us implement this idea by developing a recurrence relation where each step corresponds to an integration
through one of the variables of integration (u, v, t1 , t2 ...). Let us start by defining the integrals


Z ∞ Z ∞
N
Y
(N −j)
(N −j)

F1,1
=
...
dtk du dv e−c1,1 max{tj ,u,v} T hϕj |Ou Otj+1 ...OtN |ϕN i(hϕj |Ov Otj+1 ...OtN |ϕN i)∗ Bu(x1 ,y1 )∗ Bv(x̃1 ,y˜1 )
0

(N −j)

F1,0

Z
=

0
∞

(N −j)

Z
=

∞

(N −j)

Z

∞

=

Z

...
0



N
Y


0

∞

(N −j)

dtk du dv e−c1,0

max{tj ,u}

T hϕj |Ou Otj+1 ...OtN |ϕN i(hϕj |Otj+1 ...OtN |ϕN i)∗ Bu(x1 ,y1 )∗

max{tj ,v}

T hϕj |Otj+1 ...OtN |ϕN i(hϕj |Ov Otj+1 ...OtN |ϕN i)∗ Bv(x̃1 ,ỹ1 )


(N −j)

dtk du dv e−c0,1

k=j+1
∞



N
Y


0



k=j+1

...
Z

N
Y


0

0

F0,0

∞

...
0

F0,1

Z

k=j+1




(N −j)

dtk du dv e−c0,0

max{tj }

T hϕj |Otj+1 ...OtN |ϕN i(hϕj |Otj+1 ...OtN |ϕN i)∗

(12)

k=j+1

with
(N −j)

c1,1

(N −j)

c1,0

(N −j)

c0,1

(N −j)

c0,0

= γj−1
1
1
= x̃1 + (γj−1 + γj ) − i(ỹ1 − (ωj−1 − ωj ))
2
2
1
1
= x1 + (γj−1 + γj ) + i(y1 − (ωj−1 − ωj ))
2
2
1
= (x1 + x̃1 ) + γj + i(y1 − ỹ1 ),
2

(13)

14
with j = 1, ..., N . Note that
(N )

I1

(x1 , y1 , x̃1 , ỹ1 ) =

1 (N −1)
F
.
N ! 1,1

(14)

(N −1)

We can then compute F1,1

by noting the following recurrence relation (with j = 1, ..., N ):
p
√
x1 γj (N −j)
x̃1 γj (N −j)
(N − j)γj (N −j−1)
(N −j)
+ (N −j) F1,0
+ (N −j) F0,1
F1,1
= (N −j−1) F1,1
c1,1
c1,0
c0,1
√
√
x1 γj (N −j)
(N − j) γj γj+1 (N −j−1)
(N −j)
F1,0
=
F1,0
+ (N −j) F0,0
(N −j−1)
c0,1
c0,0
p
√
(N − j) γj γj+1 (N −j−1)
x̃1 γj (N −j)
(N −j)
F0,1
F0,1
=
+ (N −j) F0,0
(N −j−1)
c1,0
c0,0
(N −j)

F0,0

=

(N − j)γj+1
(N −j−1)

c0,0

(N −j−1)

F0,0

,

(15)

F0,0 = 1.

(16)

together with
(0)

Next, the idea is to express (15) as a matrix multiplication. In particular, let us define a matrix of size (4N )2 given by:


M11 M12 M13 M14


M M22 M23 M24 
M =  21

M31 M32 M33 M34 
M41 M42 M43 M44
where Mij are matrices of size N 2 with entries Mij [[k, l]] given by
γN −j+1

with j = 1, ...N − 1,
and 0 otherwise
(j−1)
c0,0
√
γN −j γN −j+1
M22 [[j + 1, j]] = j
with j = 1, ...N − 1,
and 0 otherwise
(j−1)
c1,0
√
γN −j γN −j+1
with j = 1, ...N − 1,
and 0 otherwise
M33 [[j + 1, j]] = j
(j−1)
c0,1
γN −j
M44 [[j + 1, j]] = j (j−1) with j = 1, ...N − 1,
and 0 otherwise
c1,1
√
γN −j x
with j = 1, ...N,
and 0 otherwise
M21 [[j, j]] =
(j)
c0,0
√
γN −j y
M31 [[j, j]] =
with j = 1, ...N,
and 0 otherwise
(j)
c0,0
√
γN −j y
M42 [[j, j]] =
with j = 1, ...N,
and 0 otherwise
(j)
c1,0
√
γN −j x
M43 [[j, j]] =
with j = 1, ...N,
and 0 otherwise
(j)
c0,1
M11 [[j + 1, j]] = j

(17)

and the remaining submatrices are zero. Defining the initial vector: ~v0 = {1, 0, ..., 0}, one finds that
~vf = M N +1 .~v0

(18)

where
(N −1)

~vf = {0, ..., 0, F1,1

},

(19)

15
which provides the desired result. When computing this numerically, it is convenient to compute instead


N
Y
M
.M.~v0
~vf = 
j
j=1
(N )

which directly provides I1

(20)

(x1 , y1 , x̃1 , ỹ1 ) in (14).

C.

Two-photon correlators

Let us now move to the computation of
f ({xj , yj , x̃j , ỹj }2j=1 ) = hφ(N ) |bx1 ,y1 bx2 ,y2 b†x̃1 ,ỹ1 b†x̃2 ,ỹ2 |φ(N ) i.

(21)

Using (8) and (2) and the symmetry of At1 ...tN over permutations, we arrive at
√
√
2 x1 x̃1 y1 ỹ1
2 x1 x̃1 y1 ỹ1
f ({xj , yj , x̃j , ỹj }2j=1 ) =
+
(x1 + x̃1 + 2i(ỹ1 − y1 )) (x2 + x̃2 + 2i(ỹ2 − y2 )) (x1 + x̃2 + 2i(ỹ2 − y1 )) (x2 + x̃1 + 2i(ỹ1 − y2 ))
√
√
2 x1 x̃1
2 x1 x̃2
(N )
(N )
+N
I1 (x2 , y2 , x̃2 , ỹ2 ) + N
I (x2 , y2 , x̃1 , ỹ1 )
x1 + x̃1 + 2i(ỹ1 − y1 )
x1 + x̃2 + 2i(ỹ2 − y1 ) 1
√
√
2 x2 x̃1
2 x2 x̃2
(N )
(N )
+N
I1 (x1 , y1 , x̃2 , ỹ2 ) + N
I (x1 , y1 , x̃1 , ỹ1 )
x2 + x̃1 + 2i(ỹ1 − y2 )
x2 + x̃2 + 2i(ỹ2 − y2 ) 1
(N )

+ N (N − 1)I2

(x1 , y1 , x2 , y2 , x̃1 , ỹ1 , x̃2 , ỹ2 )

(22)

where we have defined
(N )

I2

(x1 , y1 ,x2 , y2 , x̃1 , ỹ1 , x̃2 , ỹ2 ) =


Z ∞ Z ∞ Y
N
1

...
dtj  du1 du2 dv1 dv2 Au1 u2 t3 ...tN A∗v1 v2 t3 ...tN Bu(x11 ,y1 )∗ Bu(x22 ,y2 )∗ Bv(x̃1 1 ,ỹ1 ) Bv(x̃2 2 ,ỹ2 )
N! 0
0
j=3

(23)

in analogy with (11). Identifying
(N −2)

(N )
I2 (x1 , y1 ,x2 , y2 , x̃1 , ỹ1 , x̃2 , ỹ2 )

F1,1,1,1
=
N!

we find the following recurrence relation (a natural extension of (15)),
√
√
x1 γk+s2
x2 γk+s1
(N −1−k)
(N −1−k)
(N −1−k)
F1−s1 ,1−s2 ,1−t1 ,1−t2 =δs1 ,0 F0,1−s2 ,1−t1 ,1−t2 (N −1−k)
+ δs2 ,0 F1−s1 ,0,1−t1 ,1−t2 (N −1−k)
c0,1−s2 ,1−t1 ,1−t2
c0,1−s2 ,1−t1 ,1−t2
p
p
x̃1 γk+t2
x̃2 γk+t
(N −1−k)
(N −1−k)
+ δt1 ,0 F1−s1 ,1−s2 ,0,1−t2 (N −1−k)
+ δt2 ,0 F1−s1 ,1−s2 ,1−t1 ,0 (N −1−k) 1
c1−s1 ,1−s2 ,0,1−t2
c1−s1 ,1−s2 ,1−t1 ,0
√
γ
γ
k+s1 +s2 k+t1 +t2
(N −2−k)
+ (N − k − 1)F1−s1 ,1−s2 ,1−t1 ,1−t2 (N −2−k)
c1−s1 ,1−s2 ,1−t1 ,1−t2

(24)

(25)

with k = 1, ..., N − 2, and
(0)

F0,0,0,0 = 1,

(26)

and
(N −2−k)
c1−s1 ,1−s2 ,1−t1 ,1−t2

=

2
X
i=1

si

x

i

2



+ iyi + ti



x̃i
− iỹi
2


+

1
(γs1 +s2 +k + γt1 +t2 +k ) + i(ωk+t1 +t2 − ωk+s1 +s2 ).
2

(27)

16
In order to compute the recurrence relation (25) as a matrix multiplication, it convenient to define basis vectors: |k, s1 , s2 , t1 , t2 i
with k = {1, ..., N − 1}, and s1 , s2 , t1 , t2 ∈ {0, 1}. Then, the idea is to define a matrix M that satisfies,
M |k, s1 , s2 , t1 , t2 i = Ck−1,s1 ,s2 ,t1 ,t2 |k − 1, s1 , s2 , t1 , t2 i + Ck,s1 −1,s2 ,t1 ,t2 |k, s1 − 1, s2 , t1 , t2 i
+ Ck,s1 ,s2 −1,t1 ,t2 |k, s1 , s2 − 1, t1 , t2 i + Ck,s1 ,s2 ,t1 −1,t2 |k, s1 , s2 , t1 − 1, t2 i
+ Ck,s1 ,s2 ,t1 ,t2 −1 |k, s1 , s2 , t1 , t2 − 1i

(28)

with
√
Ck−1,s1 ,s2 ,t1 ,t2 = (N − k − 1)
√

Ck,s1 −1,s2 ,t1 ,t2 = δs1 ,0

γk+s1 +s2 γk+t1 +t2
(N −2−k)
c1−s1 ,1−s2 ,1−t1 ,1−t2

x1 γk+s2
(N −1−k)
c0,1−s2 ,1−t1 ,1−t2
√

Ck,s1 ,s2 −1,t1 ,t2 = δs2 ,0

x2 γk+s1
(N −1−k)
c0,1−s2 ,1−t1 ,1−t2
√

Ck,s1 ,s2 ,t1 −1,t2 = δt1 ,0

y1 γk+t2
(N −1−k)
c1−s1 ,1−s2 ,0,1−t2
√

Ck,s1 ,s2 ,t1 ,t2 −1 = δt2 ,0

y2 γk+t1
(N −1−k)
c1−s1 ,1−s2 ,1−t1 ,0

(29)

which provide the coefficients of M . Then, notice that from (25) one obtains,
(N −2)

M N +2 |N − 1, 1, 1, 1, 1i = F1,1,1,1 |1, 0, 0, 0, 0i,

(30)

which gives the desired result. Note that the matrices M are now of size (24 (N − 1))2 .

D.

Higher order terms

Given these previous considerations, it is in principle not difficult (but quite tedious) to extend these techniques to higher-order
correlators of the form hφ(N ) |bx1 ,y1 ...bxn ,yn b†x̃1 ,ỹ1 ...b†x̃n ,ỹn |φ(N ) i. Essentially, following the previous considerations we need to
compute integrals of the form

 

Z ∞ Z ∞
N
n
Y
Y
1

...
dtj  
duj dvj Bu(xj j ,yj )∗ Bv(x̃j j ,ỹj ) Au1 ...un tn+1 ...tN A∗v1 ...vn tn+1 ...tN
In(N ) ({xj , yj , x̃j , ỹj }nj=1 ) =
N! 0
0
j=n+1
j=1
(31)
In complete analogy with the previous considerations, we can define
(N −n)

In(N ) ({xj , yj , x̃j , ỹj }nj=1 ) =

F1,...,1
N!

(32)

and the following recurrence relation can be derived (a natural extension of (25)),
(N −n+1−k)
F{1−si }n ,{1−ti }n
i=1
i

1

=

n
X
j=1

+

p
xj γk+Pnj=1 sj

(N −n+1−k)
δsj ,0 F{1−s }j−1 ,0,{1−s }n
n
i i=1
i i=j+1 ,{1−ti }i

n
X
j=1

(N −n+1−k)
j
n
n
i }i=1 ,0,{1−si }i=j+1 ,{1−ti }i

c{1−s

1

1

q

x̃j γk+Pnj=1 tj

(N −n+1−k)
j−1
n
n
i }i=1 ,{1−ti }i=1 ,0,{1−ti }i=j+1 (N −n+1−k)
c{1−s }j ,0,{1−s }n
n
i i=1
i i=j+1 ,{1−ti }i

δtj ,0 F{1−s

√

+ (N − k − n +

(N −k−n)
1)F{1−si }n ,{1−ti }n
i=1
i

1

1

γk+s1 +s2 γk+t1 +t2

(N −k−n)

c{1−si }n

n
i=1 ,{1−ti }i

1

(33)

17

FIG. 12. Coefficients of the three-mode approximation of a superradiant state for N = 8 and D = 8.

with k = 1, ..., N − n and
(0)

F0,...,0 = 1,

(34)

and
(N −k−n+1)

c1−s1 ,1−s2 ,1−t1 ,1−t2 =

n
X

si

i=1





x̃i
1 P
+ iyi + ti
− iỹi +
γ ni=1 si +k + γPni=1 ti +k + i(ωk+Pni=1 ti − ωk+Pni=1 si ).
2
2
2
(35)

x

i

This recurrence relation (33) can be computed through a matrix multiplication of M O(N ) in analogy with the previous sections,
where M is now a matrix of size (22n (N − n + 1))2 . Hence we notice that the complexity of the calculation grows exponentially
with the order of the correlator.
E.

Overlap

Pd
Consider the computation of h0|ck11 ck22 ...ckdd |φ(N ) i with i=1 ki = N . This can expressed by a linear combination of products
of the form

 



Z ∞ Z ∞ Y
k1Y
+k2
k1
N
N
Y
Y
(x
)∗
(x
)∗
(x
)∗
 dtj  
Btj D  At1 ...tN (36)
h0|bkx11 bkx22 ...bkxD
|φ(N ) i =
...
Btj 2  ... 
Btj 1  
D
0

0

j=1

j=1

j=N −kD +1

j=k1 +1

where we used (16). As in the previous section, we can compute each integral by solving the following recurrence relation:
F{ki −si }D
=
i=1

D
X

√
θ[kj − sj ](kj − sj )F{ki −si }j−1 ,kj −sj −1,{ki −si }D
i=1

i=j+1

j=1

xj γPk sk

c{ki −si }j−1 ,kj −sj −1,{ki −si }D
i=1

(37)

i=j+1

where θ[x] is the step function (θ[−|x|] = 0 and θ[|x|] = 1), together with the initial condition
F{0}D
= 1,
j=1 =1

(38)



D
1 X
=
sj xj + γPj sj  .
2 j=1

(39)

and the coefficients
c{ki −si }D
i=1
This provides the desired solution as:
F{ki }D
= h0|bkx11 bkx22 ...bkxD
|φ(N ) i
D
i=1

(40)

18

FIG. 13. Classical Fisher information in the presence of photon loss (η = 0.95) for: NR measurements in twin Fock states of N = 8 (orange)
and N = 10 (blue) photons, and twin superradiant states with N = 10 and NR (green) and NMR (red) measurements. Finally, the straight
purple line shows the classical Shot Noise Limit (SNL) corresponding to C = N .

FIG. 14. Classical Fisher information in the presence of photon loss (η = 0.9) for: NR measurements in twin Fock states of N = 6 (orange)
and N = 8 (blue) photons, and twin superradiant states with N = 8 and NR (green) and NMR (red) measurements.

Following the same logic as in the following sections, this integral can be computed by a product of matrices in a space of
dimension
dim =

D
Y

kj ,

(41)

j=1

which is approximately bounded as
D

N . dim . (N/D) .

(42)

In Figure 12 we illustrate these ideas by computing all h0|ck11 ck22 ck33 |φ(N ) i with N = 8, D = 8 and d = 3.
II.

NUMERICAL RESULTS ON QUANTUM METROLOGY WITH PHOTON LOSS

This section shows more numerical results on the CFI with photon loss and considering as input states twin Fock states and
twin superradiant states, as shown in Figures 13 ,14 and 15.

19

FIG. 15. Classical Fisher information in the presence of photon loss (η = 0.95) for: NR measurements in twin Fock states of N = 8 (orange)
and N = 10 (blue) photons, and twin superradiant states with N = 8 and NR (green) and NMR (red) measurements.

